         TITLE 'HMASMTPL - TABLE SYSMOD SELECTION CANDIDATE LIST BUILD'
HMASMTPL CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMTPL  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   TPLRC=ZERO;                     /* CLEAR THE RETURN CODE         */
*                                                                  0153
         SLR   TPLRC,TPLRC                                         0153
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE LIST BUILD BY SETTING PROCESSING OPTIONS BASED ON  */
*   /* OPTIONS/VALUES ON THE FUNCTION                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0154
*   CALL BLDLINIT;                  /*                               */
         BAL   @14,BLDLINIT                                        0154
*   IF BLDSLCT=ON THEN              /* BUILD SELECT ENTRIES?         */
         TM    BLDSLCT,B'10000000'                                 0155
         BNO   @RF00155                                            0155
*     DO;                           /* YES,                          */
*                                                                  0156
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD LIST BASED ON SELECT/GROUP LIST                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0157
*       GTPFUNCT=GTPOPENN;          /* POSITION TO THE BEGINNING OF
*                                      THE GTA FILE                  */
         MVI   GTPFUNCT(BLDSLST@),X'01'                            0157
*       CALL HMASMGTA(HMASMGTP);    /* ...                           */
         ST    BLDSLST@,@AL00001                                   0158
         L     @15,@CV01230                                        0158
         LA    @01,@AL00001                                        0158
         BALR  @14,@15                                             0158
*       DO WHILE(BLDSEOF=OFF        /* LOOP UNTIL END OF GTA FILE    */
*             &TPLRC<STOPFUNC);     /* OR AN ERROR                   */
         B     @DE00159                                            0159
@DL00159 DS    0H                                                  0160
*         GTPFUNCT=GTPGETN;         /* GET THE NEXT RECORD           */
         MVI   GTPFUNCT(BLDSLST@),X'08'                            0160
*         CALL HMASMGTA(HMASMGTP);  /* ...                           */
         ST    BLDSLST@,@AL00001                                   0161
         L     @15,@CV01230                                        0161
         LA    @01,@AL00001                                        0161
         BALR  @14,@15                                             0161
*         IF GTPRETRN=GTPEOF THEN   /* END OF FILE?                  */
         CLI   GTPRETRN(BLDSLST@),4                                0162
         BNE   @RF00162                                            0162
*           DO;                     /* YES,                          */
*             BLDSEOF=ON;           /* END OF FILE                   */
         OI    BLDSEOF,B'10000000'                                 0164
*           END;                                                   0165
*         ELSE                      /* NO END OF FILE                */
*           DO;                                                    0166
*                                                                  0166
         B     @RC00162                                            0166
@RF00162 DS    0H                                                  0167
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS ONE SELECTED SYSMOD                         */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0167
*             CALL BLD1SLCT(HMASMIOP);/*                             */
         L     @07,CCAIOPTR(,CCAPTR)                               0167
         ST    @07,@AL00001                                        0167
         LA    @01,@AL00001                                        0167
         BAL   @14,BLD1SLCT                                        0167
*             RFY                                                  0168
*               RTNCODE RSTD;                                      0168
*             TPLRC=MAX(TPLRC,RTNCODE);/* SAVE RETURN CODE           */
         CR    TPLRC,RTNCODE                                       0169
         BNL   *+6
         LR    TPLRC,RTNCODE                                       0169
*             RFY                                                  0170
*               RTNCODE UNRSTD;                                    0170
*           END;                                                   0171
*       END;                        /*                               */
@RC00162 DS    0H                                                  0172
@DE00159 TM    BLDSEOF,B'10000000'                                 0172
         BNZ   @DC00159                                            0172
         CH    TPLRC,@CH00033                                      0172
         BL    @DL00159                                            0172
@DC00159 DS    0H                                                  0173
*     END;                          /* END OF LOOP TO PROCESS ALL  0173
*                                      SELECT SYSMODS                */
*   ELSE                                                           0174
*     ;                             /* NO SELECT PROCESSING          */
@RF00155 DS    0H                                                  0175
*   IF BLDMASS=ON THEN              /* BUILD MASS ENTRIES?           */
         TM    BLDMASS,B'01000000'                                 0175
         BNO   @RF00175                                            0175
*     DO;                           /* YES,                          */
*                                                                  0176
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD LIST BASED ON THE DATA SETS                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0177
*       CALL BLDMASSL(HMASMIOP);                                   0177
         L     @07,CCAIOPTR(,CCAPTR)                               0177
         ST    @07,@AL00001                                        0177
         LA    @01,@AL00001                                        0177
         BAL   @14,BLDMASSL                                        0177
*       RFY                                                        0178
*         RTNCODE RSTD;                                            0178
*       TPLRC=MAX(TPLRC,RTNCODE);   /* SAVE RETURN CODE              */
         CR    TPLRC,RTNCODE                                       0179
         BNL   *+6
         LR    TPLRC,RTNCODE                                       0179
*       RFY                                                        0180
*         RTNCODE UNRSTD;                                          0180
*     END;                          /*                               */
*   ELSE                                                           0182
*     ;                             /* DONT BUILD MASS ENTRIES       */
@RF00175 DS    0H                                                  0183
*   RETURN CODE(TPLRC);             /*                               */
         LR    @15,TPLRC                                           0183
         L     @13,4(,@13)                                         0183
         L     @14,12(,@13)                                        0183
         LM    @00,@12,20(@13)                                     0183
         BR    @14                                                 0183
*   RFY                                                            0184
*     HMASMIOP BASED;                                              0184
*   RFY                                                            0185
*     HMASMGTP BASED;                                              0185
*   RFY                                                            0186
*     HMASMSET BASED;                                              0186
*                                                                  0187
*   /*****************************************************************/
*   /*                                                               */
*   /* BLDLINIT -                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0187
*BLDLINIT:                                                         0187
*   PROC;                           /*                               */
BLDLINIT STM   @14,@05,12(@13)                                     0187
         STM   @07,@12,48(@13)                                     0187
*   BLDSLST@=ZERO;                  /* CLEAR SELECT LIST POINTER     */
         SLR   BLDSLST@,BLDSLST@                                   0188
*   BLDELST@=ZERO;                  /* CLEAR EXCLUDELIST POINTER     */
         SLR   BLDELST@,BLDELST@                                   0189
*   BLDFLAGS=''B;                   /* CLEAR CONTROL FLAGS           */
         XC    BLDFLAGS(3),BLDFLAGS                                0190
*   IF TBLSEL=ON                    /* SELECT ...                    */
*       ×TBLGROUP=ON THEN           /* OR GROUP?                     */
         L     @07,@PC00001                                        0191
         L     @15,TBLXTBL(,@07)                                   0191
         TM    TBLSEL(@15),B'10100000'                             0191
         BZ    @RF00191                                            0191
*     DO;                           /* YES,                          */
*       BLDSLCT=ON;                 /* BUILD ENTRIES FROM SELECT LIST*/
         OI    BLDSLCT,B'10000000'                                 0193
*       BLDSLST@=TBLXSEGT;          /* USE SELECT GROUP LIST         */
         L     BLDSLST@,TBLXSEGT(,@07)                             0194
*       IF TBLGROUP=ON THEN         /* GROUP MODE?                   */
         TM    TBLGROUP(@15),B'00100000'                           0195
         BNO   @RF00195                                            0195
*         DO;                       /* YES,                          */
*           BLDMASS=ON;             /* BUILD MASS                    */
*           BLDMCAND=OFF;           /* MASS SYSMODS ARE NOT        0198
*                                      CANDIDATES                    */
         OI    BLDMASS,B'01000000'                                 0198
         NI    BLDMCAND,B'11101111'                                0198
*         END;                                                     0199
*       ELSE                                                       0200
*         ;                         /* NOT GROUP MODE                */
@RF00195 DS    0H                                                  0201
*     END;                                                         0201
*   ELSE                            /* NOT SELECT OR GROUP           */
*     DO;                           /* EITHER MASS OR EXCLUDE        */
         B     @RC00191                                            0202
@RF00191 DS    0H                                                  0203
*       BLDMCAND=ON;                /* MASS ENTRIES ARE CANDIDATES   */
*       BLDMASS=ON;                 /* BUILD MASS ENTRIES            */
         OI    BLDMCAND,B'01010000'                                0204
*       IF TBLEXC=ON THEN           /* EXCLUDE MODE?                 */
         L     @07,@PC00001                                        0205
         L     @01,TBLXTBL(,@07)                                   0205
         TM    TBLEXC(@01),B'01000000'                             0205
         BNO   @RF00205                                            0205
*         DO;                       /* YES,                          */
*           BLDEXEC=ON;             /* EXCLUDE MODE FLAG             */
         OI    BLDEXEC,B'00100000'                                 0207
*           BLDELST@=TBLXSEGT;      /* EXCLUDE LIST                  */
         L     BLDELST@,TBLXSEGT(,@07)                             0208
*         END;                                                     0209
*       ELSE                                                       0210
*         ;                         /* NOT EXCLUDE                   */
@RF00205 DS    0H                                                  0211
*     END;                          /*                               */
*   IF CCAAPPLY=ON THEN             /* IS THE FUNCTION APPLY?        */
@RC00191 TM    CCAAPPLY(CCAPTR),B'01000000'                        0212
         BNO   @RF00212                                            0212
*     DO;                           /* YES,                          */
*       BLDDSIDS=IOPPTS;            /* SELECT DSID IS THE PTS        */
         MVI   BLDDSIDS,X'06'                                      0214
*       BLDDSID1=IOPPTS;            /* FOR MASS COMPARE PTS ...      */
         MVI   BLDDSID1,X'06'                                      0215
*       BLDDSID2=IOPCDS;            /* ... TO THE CDS                */
         MVI   BLDDSID2,X'02'                                      0216
*       BLDL1=ON;                   /* BUILD ENTRIES FOR 1ST LEVEL 0217
*                                      FUNCTION                      */
*       BLDL2=ON;                   /* BUILD ENTRIES FOR LOWER LEVEL
*                                      FUNCTION                      */
*       BLDL3=ON;                   /* BUILD ENTRIES FOR PTF'S       */
*       BLDL4=ON;                   /* BUILD ENTRIES FOR APAR'S      */
*       BLDL5=ON;                   /* BUILD ENTRIES FOR USERMODS    */
         OI    BLDL1,B'11111000'                                   0221
*     END;                                                         0222
*   ELSE                                                           0223
*     ;                             /* NOT APPLY                     */
@RF00212 DS    0H                                                  0224
*   IF CCAACCPT=ON THEN             /* IS THE FUNCTION ACCEPT?       */
         TM    CCAACCPT(CCAPTR),B'00100000'                        0224
         BNO   @RF00224                                            0224
*     DO;                           /* YES,                          */
*       BLDDSIDS=IOPPTS;            /* SELECT DSID IS THE PTS        */
         MVI   BLDDSIDS,X'06'                                      0226
*       BLDDSID1=IOPCDS;            /* FOR MASS COMPARE CDS ...      */
         MVI   BLDDSID1,X'02'                                      0227
*       BLDDSID2=IOPACDS;           /* ... TO THE ACDS               */
         MVI   BLDDSID2,X'0C'                                      0228
*       BLDL1=ON;                   /* BUILD ENTRIES FOR 1ST LEVEL 0229
*                                      FUNCTION                      */
*       BLDL2=ON;                   /* BUILD ENTRIES FOR LOWER LEVEL
*                                      FUNCTION                      */
*       BLDL3=ON;                   /* BUILD ENTRIES FOR PTF'S       */
         OI    BLDL1,B'11100000'                                   0231
*       IF TBLAPAR=ON THEN          /* ACCEPT APARS?                 */
         L     @07,@PC00001                                        0232
         L     @07,TBLXTBL(,@07)                                   0232
         TM    TBLAPAR(@07),B'00001000'                            0232
         BNO   @RF00232                                            0232
*         DO;                       /* YES,                          */
*           BLDL4=ON;               /* BUILD ENTRIES FOR APAR'S      */
         OI    BLDL4,B'00010000'                                   0234
*         END;                                                     0235
*       ELSE                                                       0236
*         ;                         /*                               */
@RF00232 DS    0H                                                  0237
*       IF TBLUSER=ON THEN          /* ACCEPT USER MODS?             */
         L     @07,@PC00001                                        0237
         L     @07,TBLXTBL(,@07)                                   0237
         TM    TBLUSER(@07),B'00000100'                            0237
         BNO   @RF00237                                            0237
*         DO;                       /* YES,                          */
*           BLDL5=ON;               /* BUILD ENTRIES FOR USERMODS    */
         OI    BLDL5,B'00001000'                                   0239
*         END;                                                     0240
*       ELSE                                                       0241
*         ;                                                        0241
@RF00237 DS    0H                                                  0242
*       IF TBLNOAPP=ON THEN         /* NOAPPLY?                      */
         L     @07,@PC00001                                        0242
         L     @07,TBLXTBL(,@07)                                   0242
         TM    TBLNOAPP(@07),B'10000000'                           0242
         BNO   @RF00242                                            0242
*         DO;                       /* YES                           */
*           BLDDSIDS=IOPPTS;        /* SELECT DSID IS THE PTS        */
         MVI   BLDDSIDS,X'06'                                      0244
*           BLDDSID1=IOPPTS;        /* FOR MASS COMPARE PTS ...      */
         MVI   BLDDSID1,X'06'                                      0245
*           BLDDSID2=IOPACDS;       /* ... TO THE ACDS               */
         MVI   BLDDSID2,X'0C'                                      0246
*         END;                                                     0247
*       ELSE                                                       0248
*         ;                         /* NOT NO APPLY                  */
@RF00242 DS    0H                                                  0249
*     END;                                                         0249
*   ELSE                                                           0250
*     ;                             /* NOT ACCEPT                    */
@RF00224 DS    0H                                                  0251
*   RETURN;                         /*                               */
@EL00002 DS    0H                                                  0251
@EF00002 DS    0H                                                  0251
@ER00002 LM    @14,@05,12(@13)                                     0251
         LM    @07,@12,48(@13)                                     0251
         BR    @14                                                 0251
*   END BLDLINIT;                   /*                               */
*BLD1SLCT:                                                         0253
*   PROC(BLD1IOP);                  /*                               */
BLD1SLCT STM   @14,@12,@SA00003                                    0253
         MVC   @PC00003(4),0(@01)                                  0253
*   DCL                                                            0254
*     BLD1IOP CHAR(*);              /*                               */
*   DCL                                                            0255
*     BLD1REDO CHAR(1);             /* RE-APPLICATION INDICATOR      */
*   DCL                                                            0256
*     BLD1RC FIXED(15);             /*                               */
*   DCL                                                            0257
*     1 BLD1FLGS,                   /*                               */
*      2 BLD1FND BIT(1),            /* SYSMOD FOUND FLAG             */
*      2 * BIT(7);                                                 0257
*   RFY                                                            0258
*     HMASMIOP BASED(ADDR(BLD1IOP));                               0258
*   RFY                                                            0259
*     HMASMGTP BASED(BLDSLST@);                                    0259
*   RFY                                                            0260
*     HMASMSET BASED(BLDSLST@->GTPBUFAD);                          0260
*   BLD1REDO=' ';                   /* CLEAR REDO INDICATOR          */
         MVI   BLD1REDO,C' '                                       0261
*   BLD1RC=ZERO;                    /* CLEAR THE RETURN COEDE        */
         SLR   BLD1RC,BLD1RC                                       0262
*   BLD1FLGS=''B;                   /* CLEAR THE RETURN COEDE        */
         MVI   BLD1FLGS,X'00'                                      0263
*   IOPDSID=BLDDSIDS;               /* DATA SET IS SELECT CHECK DATA
*                                      SET                           */
         L     @07,@PC00003                                        0264
         MVC   IOPDSID(1,@07),BLDDSIDS                             0264
*   IOPFUNCT=IOPLOC;                /* GET EXTENDED ENTRY ...        */
         MVI   IOPFUNCT(@07),X'03'                                 0265
*   IOPTYPE=IOPSMD;                 /* ... FOR THE SELECTED ...      */
         MVI   IOPTYPE(@07),X'0B'                                  0266
*   IOPNAM17=SESMDNO;               /* ... SYSMOD                    */
         L     @02,GTPBUFAD(,BLDSLST@)                             0267
         MVC   IOPNAM17(7,@07),SESMDNO(@02)                        0267
*   CALL HMASMIO(HMASMIOP);         /* ...                           */
         ST    @07,@AL00001                                        0268
         L     @15,@CV01228                                        0268
         LA    @01,@AL00001                                        0268
         BALR  @14,@15                                             0268
*   IF IOPRETRN=IOPNTFND THEN       /* SELECTED SYSMOD NOT FOUND?    */
         L     @07,@PC00003                                        0269
         CLI   IOPRETRN(@07),4                                     0269
         BNE   @RF00269                                            0269
*     DO;                           /* YES,                          */
*       BLD1RC=STOPSMD;             /* STOP SYSMOD RC                */
*                                                                  0271
         LA    BLD1RC,8                                            0271
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MESSAGE HMA401I XXXXXXXX XXXXXXX SELECTED FOR       */
*       /* XXXXXXXX NOT FOUND ON XXXXXXXX LIBRARY                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0272
*       DO;                         /* HMASMPMG M1(HMA401I)TYPE(ERR)V
*                                      AR(CCATYPEA(IOPTYPE),IOPNAM17,
*                                      TBLXFUNC,CCADSIDA(IOPDSID))TAR
*                                      GET(SYSOUT,LOG)               */
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */
         XC    HMASMMGP(28),HMASMMGP                               0273
*         MGPMGNO1=HMA401I;         /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01241                                0274
*         MGPTYPE=MGPERR;           /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0275
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0277
*         MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* SET VARIABLE PTR    */
         SLR   @02,@02                                             0278
         IC    @02,IOPTYPE(,@07)                                   0278
         SLA   @02,3                                               0278
         L     @01,CCATPAD(,CCAPTR)                                0278
         AL    @01,@CF01454                                        0278
         LA    @02,CCATYPEA(@02,@01)                               0278
         ST    @02,MGPVARPT                                        0278
*         MGPVARPT(2)=ADDR(IOPNAM17);/* SET VARIABLE PTR             */
         LA    @02,IOPNAM17(,@07)                                  0279
         ST    @02,MGPVARPT+4                                      0279
*         MGPVARPT(3)=ADDR(TBLXFUNC);/* SET VARIABLE PTR             */
         L     @02,@PC00001                                        0280
         LA    @02,TBLXFUNC(,@02)                                  0280
         ST    @02,MGPVARPT+8                                      0280
*         MGPVARPT(4)=ADDR(CCADSIDA(IOPDSID));/* SET VARIABLE PTR    */
         SLR   @02,@02                                             0281
         IC    @02,IOPDSID(,@07)                                   0281
         SLA   @02,3                                               0281
         L     @07,CCADSAD(,CCAPTR)                                0281
         AL    @07,@CF01454                                        0281
         LA    @07,CCADSIDA(@02,@07)                               0281
         ST    @07,MGPVARPT+12                                     0281
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */
         L     @15,@CV01229                                        0282
         LA    @01,@AL00282                                        0282
         BALR  @14,@15                                             0282
*       END;                                                       0283
*     END;                                                         0284
*   ELSE                                                           0285
*     DO;                                                          0285
         B     @RC00269                                            0285
@RF00269 DS    0H                                                  0286
*       BLD1RC=MAX(BLD1RC,IOPRETRN);/* SET RETURN CODE               */
         L     @07,@PC00003                                        0286
         SLR   @02,@02                                             0286
         IC    @02,IOPRETRN(,@07)                                  0286
         CR    BLD1RC,@02                                          0286
         BNL   *+6
         LR    BLD1RC,@02                                          0286
*     END;                                                         0287
*   IF BLD1RC=ZERO THEN             /* IO WAS OK                     */
@RC00269 LTR   BLD1RC,BLD1RC                                       0288
         BNZ   @RF00288                                            0288
*     DO;                           /*                               */
*       BLD1FND=ON;                 /* SYSMOD FOUND FLAG             */
         OI    BLD1FND,B'10000000'                                 0290
*       IF IOPERROR=ON THEN         /* SELECTED SYSMOD IN ERROR?     */
         L     @07,@PC00003                                        0291
         TM    IOPERROR(@07),B'00010000'                           0291
         BNO   @RF00291                                            0291
*         DO;                       /* YES,                          */
*           BLD1RC=STOPSMD;         /* STOP THE SYSMOD               */
*                                                                  0293
         LA    BLD1RC,8                                            0293
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE MESSAGE 'HMA380I SYSMOD XXXXXXX SELECTED FOR    */
*           /* XXXXXXXX IS IN ERROR ON THE XXXXXXXX'                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0294
*           DO;                     /* HMASMPMG M1(HMA380I)TYPE(ERR)V
*                                      AR(IOPNAM17,TBLXFUNC,CCADSIDA(
*                                      IOPDSID))TARGET(SYSOUT,LOG)   */
*             HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS      */
         XC    HMASMMGP(28),HMASMMGP                               0295
*             MGPMGNO1=HMA380I;     /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01239                                0296
*             MGPTYPE=MGPERR;       /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0297
*             MGPPRINT='1'B;        /* SET TARGET FLAG               */
*             MGPHLDS='1'B;         /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0299
*             MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR         */
         LA    @02,IOPNAM17(,@07)                                  0300
         ST    @02,MGPVARPT                                        0300
*             MGPVARPT(2)=ADDR(TBLXFUNC);/* SET VARIABLE PTR         */
         L     @02,@PC00001                                        0301
         LA    @02,TBLXFUNC(,@02)                                  0301
         ST    @02,MGPVARPT+4                                      0301
*             MGPVARPT(3)=ADDR(CCADSIDA(IOPDSID));/* SET VARIABLE PTR*/
         SLR   @02,@02                                             0302
         IC    @02,IOPDSID(,@07)                                   0302
         SLA   @02,3                                               0302
         L     @07,CCADSAD(,CCAPTR)                                0302
         AL    @07,@CF01454                                        0302
         LA    @07,CCADSIDA(@02,@07)                               0302
         ST    @07,MGPVARPT+8                                      0302
*             CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED         */
         L     @15,@CV01229                                        0303
         LA    @01,@AL00303                                        0303
         BALR  @14,@15                                             0303
*           END;                    /*                               */
*         END;                                                     0305
*     END;                                                         0306
*   ELSE                                                           0307
*     ;                             /* SYSMOD NOT IN ERROR           */
@RF00288 DS    0H                                                  0308
*   IF BLD1RC<STOPSMD THEN          /* SYSMOD STILL GO?              */
@RC00288 CH    BLD1RC,@CH00055                                     0308
         BNL   @RF00308                                            0308
*     DO;                           /* YES,                          */
*                                                                  0309
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF ON (A)CDS, ERROR, DEL, SUP                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0310
*       RFY                                                        0310
*         HMASMIOP BASED(ADDR(TPLIOPF));                           0310
*       IOPDSID=BLDDSID2;           /* DATA SET IS TARGET (A)CDS DATA
*                                      SET                           */
         LA    @07,TPLIOPF                                         0311
         MVC   IOPDSID(1,@07),BLDDSID2                             0311
*       IOPFUNCT=IOPBLDL;           /* GET DIRECTORY ENTRY ...       */
         MVI   IOPFUNCT(@07),X'04'                                 0312
*       IOPTYPE=IOPSMD;             /* ... FOR THE SELECTED ...      */
         MVI   IOPTYPE(@07),X'0B'                                  0313
*       IOPNAM17=SESMDNO;           /* ... SYSMOD                    */
         L     @02,GTPBUFAD(,BLDSLST@)                             0314
         MVC   IOPNAM17(7,@07),SESMDNO(@02)                        0314
*       CALL HMASMIO(HMASMIOP);     /* ...                           */
         ST    @07,@AL00001                                        0315
         L     @15,@CV01228                                        0315
         LA    @01,@AL00001                                        0315
         BALR  @14,@15                                             0315
*       IF IOPRETRN>IOPNTFND THEN   /* IO ERROR                      */
         LA    @07,TPLIOPF                                         0316
         CLI   IOPRETRN(@07),4                                     0316
         BNH   @RF00316                                            0316
*         DO;                       /* YES,                          */
*           BLD1RC=MAX(BLD1RC,IOPRETRN);/* SET RC                    */
         SLR   @02,@02                                             0318
         IC    @02,IOPRETRN(,@07)                                  0318
         CR    BLD1RC,@02                                          0318
         BNL   *+6
         LR    BLD1RC,@02                                          0318
*         END;                      /*                               */
*       ELSE                        /* NO IO ERROR EITHER FOUND OR 0320
*                                      NOT                           */
*         DO;                       /*                               */
         B     @RC00316                                            0320
@RF00316 DS    0H                                                  0321
*           IF IOPRETRN=IOPGOOD THEN/* SYSMOD FOUND?                 */
         LA    @07,TPLIOPF                                         0321
         CLI   IOPRETRN(@07),0                                     0321
         BNE   @RF00321                                            0321
*             DO;                   /* FOUND SYSMOD                  */
*               IF IOPDBYP=ON THEN  /* --- SYSMOD IS DELETED ? ---   */
         TM    IOPDBYP(@07),B'01000000'                            0323
         BNO   @RF00323                                            0323
*                 DO;               /* DELETED SYSMOD                */
*                   BLD1RC=STOPSMD; /* STOP SYSMOD RC                */
*                                                                  0325
         LA    BLD1RC,8                                            0325
*                   /*************************************************/
*                   /*                                               */
*                   /* ISSUE MESSAGE HMA379I SYSMOD XXXXXXXX SELECTED*/
*                   /* FOR XXXXXXXX IS DELETED                       */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0326
*                   DO;             /* HMASMPMG M1(HMA379I)M2(PART099
*                                      )TYPE(ERR)VAR(IOPNAM17,TBLXFUN
*                                      C)TARGET(SYSOUT,LOG)          */
*                     HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO  0327
*                                      ZEROS                         */
         XC    HMASMMGP(28),HMASMMGP                               0327
*                     MGPMGNO1=HMA379I;/* SET UP MSG 1 CODE          */
         MVC   MGPMGNO1(2),@CH01237                                0328
*                     MGPMGNO2=PART099;/* SET UP MSG 2 CODE          */
         MVC   MGPMGNO2(2),@CH01244                                0329
*                     MGPTYPE=MGPERR;/* SET MESSAGE TYPE             */
         MVI   MGPTYPE,X'03'                                       0330
*                     MGPPRINT='1'B;/* SET TARGET FLAG               */
*                     MGPHLDS='1'B; /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0332
*                     MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR */
         LA    @07,IOPNAM17(,@07)                                  0333
         ST    @07,MGPVARPT                                        0333
*                     MGPVARPT(2)=ADDR(TBLXFUNC);/* SET VARIABLE PTR */
         L     @07,@PC00001                                        0334
         LA    @07,TBLXFUNC(,@07)                                  0334
         ST    @07,MGPVARPT+4                                      0334
*                     CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED */
         L     @15,@CV01229                                        0335
         LA    @01,@AL00335                                        0335
         BALR  @14,@15                                             0335
*                   END;            /*                               */
*                 END;                                             0337
*               ELSE                                               0338
*                 DO;               /* NON-DELETED SYSMOD            */
         B     @RC00323                                            0338
@RF00323 DS    0H                                                  0339
*                   IF IOPSBYP=ON THEN/* --- SYSMOD SUPD ? ---       */
         LA    @07,TPLIOPF                                         0339
         TM    IOPSBYP(@07),B'10000000'                            0339
         BNO   @RF00339                                            0339
*                     DO;           /* SUP'D SYSMOD                  */
*                       BLD1RC=STOPSMD;/* STOP SYSMOD RC             */
*                                                                  0341
         LA    BLD1RC,8                                            0341
*                       /*********************************************/
*                       /*                                           */
*                       /* ISSUE MESSAGE HMA379I SYSMOD XXXXXXXX     */
*                       /* SELECTED FOR XXXXXXXX IS SUPERCEEDED      */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0342
*                       DO;         /* HMASMPMG M1(HMA379I)M2(PART100
*                                      )TYPE(ERR)VAR(IOPNAM17,TBLXFUN
*                                      C)TARGET(SYSOUT,LOG)          */
*                         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO
*                                      ZEROS                         */
         XC    HMASMMGP(28),HMASMMGP                               0343
*                         MGPMGNO1=HMA379I;/* SET UP MSG 1 CODE      */
         MVC   MGPMGNO1(2),@CH01237                                0344
*                         MGPMGNO2=PART100;/* SET UP MSG 2 CODE      */
         MVC   MGPMGNO2(2),@CH00348                                0345
*                         MGPTYPE=MGPERR;/* SET MESSAGE TYPE         */
         MVI   MGPTYPE,X'03'                                       0346
*                         MGPPRINT='1'B;/* SET TARGET FLAG           */
*                         MGPHLDS='1'B;/* SET TARGET FLAG            */
         OI    MGPPRINT,B'10010000'                                0348
*                         MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE
*                                      PTR                           */
         LA    @07,IOPNAM17(,@07)                                  0349
         ST    @07,MGPVARPT                                        0349
*                         MGPVARPT(2)=ADDR(TBLXFUNC);/* SET VARIABLE
*                                      PTR                           */
         L     @07,@PC00001                                        0350
         LA    @07,TBLXFUNC(,@07)                                  0350
         ST    @07,MGPVARPT+4                                      0350
*                         CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE  0351
*                                      ISSUED                        */
         L     @15,@CV01229                                        0351
         LA    @01,@AL00351                                        0351
         BALR  @14,@15                                             0351
*                       END;        /*                               */
*                     END;                                         0353
*                   ELSE                                           0354
*                     DO;           /* NON-SUP'D SYSMOD              */
         B     @RC00339                                            0354
@RF00339 DS    0H                                                  0355
*                       IF IOPERROR=ON/* --- IN ERROR ? ---          */
*                           &IOPRES=ON/* --- RESTORE ATTEMPTED ---   */
*                         THEN                                     0355
         LA    @07,TPLIOPF                                         0355
         TM    IOPERROR(@07),B'01010000'                           0355
         BNO   @RF00355                                            0355
*                         DO;       /* RESTORE OF "IN ERROR" SYSMOD  */
*                           BLD1RC=STOPSMD;/* STOP SYSMOD RC         */
*                                                                  0357
         LA    BLD1RC,8                                            0357
*                           /*****************************************/
*                           /*                                       */
*                           /* ISSUE MESSAGE HMA379I SYSMOD XXXXXXXX */
*                           /* SELECTED FOR XXXXXXXX HAS HAD RESTORE */
*                           /* ATTEMPTED                             */
*                           /*                                       */
*                           /*****************************************/
*                                                                  0358
*                           DO;     /* HMASMPMG M1(HMA379I)M2(PART066
*                                      )TYPE(ERR)VAR(IOPNAM17,TBLXFUN
*                                      C)TARGET(SYSOUT,LOG)          */
*                             HMASMMGP=HMASMMGP&&HMASMMGP;/* SET   0359
*                                      PARMS TO ZEROS                */
         XC    HMASMMGP(28),HMASMMGP                               0359
*                             MGPMGNO1=HMA379I;/* SET UP MSG 1 CODE  */
         MVC   MGPMGNO1(2),@CH01237                                0360
*                             MGPMGNO2=PART066;/* SET UP MSG 2 CODE  */
         MVC   MGPMGNO2(2),@CH00760                                0361
*                             MGPTYPE=MGPERR;/* SET MESSAGE TYPE     */
         MVI   MGPTYPE,X'03'                                       0362
*                             MGPPRINT='1'B;/* SET TARGET FLAG       */
*                             MGPHLDS='1'B;/* SET TARGET FLAG        */
         OI    MGPPRINT,B'10010000'                                0364
*                             MGPVARPT(1)=ADDR(IOPNAM17);/* SET    0365
*                                      VARIABLE PTR                  */
         LA    @07,IOPNAM17(,@07)                                  0365
         ST    @07,MGPVARPT                                        0365
*                             MGPVARPT(2)=ADDR(TBLXFUNC);/* SET    0366
*                                      VARIABLE PTR                  */
         L     @07,@PC00001                                        0366
         LA    @07,TBLXFUNC(,@07)                                  0366
         ST    @07,MGPVARPT+4                                      0366
*                             CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE
*                                      ISSUED                        */
         L     @15,@CV01229                                        0367
         LA    @01,@AL00367                                        0367
         BALR  @14,@15                                             0367
*                           END;    /*                               */
*                         END;      /* END - RESTORE OF "IN ERROR"   */
*                       ELSE                                       0370
*                         DO;       /* --- NONE OF ABOVE ---         */
         B     @RC00355                                            0370
@RF00355 DS    0H                                                  0371
*                           BLD1REDO=REDO;/* TREAT AS RE-INSTALL     */
         MVI   BLD1REDO,C'R'                                       0371
*                         END;                                     0372
*                     END;          /* END - NON-SUP'D SYSMOD        */
*                 END;              /* END - NON-DELETED SYSMOD      */
*             END;                  /* END - SYSMOD FOUND PROCESSING */
*           ELSE                                                   0376
*             ;                     /* ^ FOUND SO ALL IS WELL TO   0376
*                                      PROCESS IT                    */
@RF00321 DS    0H                                                  0377
*         END;                      /* END - NO I/O ERROR PROCESSING */
@RC00321 DS    0H                                                  0378
*       RFY                                                        0378
*         HMASMIOP BASED(ADDR(BLD1IOP));                           0378
@RC00316 DS    0H                                                  0379
*     END;                                                         0379
*                                                                  0380
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SYSMOD FAILED, SET A FLAG IN THE SELECT/GROUP LIST TO      */
*   /* PREVENT 'NO APPLICABLE VER' MESSAGE IN HMASMTPA               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0380
*   IF BLD1RC=STOPSMD THEN          /* SYSMOD FAILED?                */
@RF00308 CH    BLD1RC,@CH00055                                     0380
         BNE   @RF00380                                            0380
*     DO;                           /* YES,                          */
*       SEFLAG2A=ON;                /* INDICATE MESSAGE ISSUED       */
         L     @07,GTPBUFAD(,BLDSLST@)                             0382
         OI    SEFLAG2A(@07),B'10000000'                           0382
*       GTPFUNCT=GTPADD;            /* SET FLAG IN GTA RECORD        */
         MVI   GTPFUNCT(BLDSLST@),X'04'                            0383
*       CALL HMASMGTA(HMASMGTP);    /* ...                           */
         ST    BLDSLST@,@AL00001                                   0384
         L     @15,@CV01230                                        0384
         LA    @01,@AL00001                                        0384
         BALR  @14,@15                                             0384
*       BLD1RC=MAX(BLD1RC,GTPRETRN);/* SAVE MAX RETURN CODE          */
         SLR   @07,@07                                             0385
         IC    @07,GTPRETRN(,BLDSLST@)                             0385
         CR    BLD1RC,@07                                          0385
         BNL   *+6
         LR    BLD1RC,@07                                          0385
*     END;                                                         0386
*                                                                  0386
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD SCL RECORD(S) FOR CURRENT SYSMOD                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0387
*   IF BLD1RC<STOPSMD THEN          /* SYSMOD IS GO?                 */
@RF00380 CH    BLD1RC,@CH00055                                     0387
         BNL   @RF00387                                            0387
*     DO;                           /* YES,                          */
*       CALL BLD1ENT(HMASMIOP,SELECT,CANDIDTE,BLD1REDO);           0389
         MVC   @AL00001+4(12),@AL00389                             0389
         L     @07,@PC00003                                        0389
         ST    @07,@AL00001                                        0389
         LA    @01,@AL00001                                        0389
         BAL   @14,BLD1ENT                                         0389
*       RFY                                                        0390
*         RTNCODE RSTD;                                            0390
*       BLD1RC=MAX(BLD1RC,RTNCODE); /* SAVE RETURN CODE              */
         CR    BLD1RC,RTNCODE                                      0391
         BNL   *+6
         LR    BLD1RC,RTNCODE                                      0391
*       RFY                                                        0392
*         RTNCODE UNRSTD;                                          0392
*     END;                                                         0393
*   ELSE                                                           0394
*     ;                             /* SYSMOD FAILED                 */
@RF00387 DS    0H                                                  0395
*   IF BLD1FND=ON THEN              /* ENTRY FOUND?                  */
         TM    BLD1FND,B'10000000'                                 0395
         BNO   @RF00395                                            0395
*     DO;                           /* YES,                          */
*       IF BLD1RC=STOPSMD           /* SYSMOD FAILED ...             */
*           &IOPPTYPE=IOPPFUNC THEN /* ... AND IS AFUNCTION          */
         CH    BLD1RC,@CH00055                                     0397
         BNE   @RF00397                                            0397
         L     @07,@PC00003                                        0397
         CLI   IOPPTYPE(@07),4                                     0397
         BNE   @RF00397                                            0397
*         DO;                                                      0398
*           CALL FUNCFM(IOPNAM17);  /* ISSUE MESSAGE                 */
         LA    @07,IOPNAM17(,@07)                                  0399
         ST    @07,@AL00001                                        0399
         LA    @01,@AL00001                                        0399
         BAL   @14,FUNCFM                                          0399
*           BLD1RC=STOPFUNC;        /* STOP SMP FUNCTION             */
         LA    BLD1RC,12                                           0400
*         END;                                                     0401
*       ELSE                                                       0402
*         ;                         /* NOT A FUNCTION SYSMOD         */
@RF00397 DS    0H                                                  0403
*     END;                                                         0403
*   RETURN CODE(BLD1RC);                                           0404
@RF00395 LR    @15,BLD1RC                                          0404
         L     @14,@SA00003                                        0404
         LM    @00,@12,@SA00003+8                                  0404
         BR    @14                                                 0404
*   RFY                                                            0405
*     HMASMIOP BASED;                                              0405
*   RFY                                                            0406
*     HMASMSET BASED;                                              0406
*   RFY                                                            0407
*     HMASMGTP BASED;                                              0407
*   END BLD1SLCT;                   /*                               */
*                                                                  0409
*   /*****************************************************************/
*   /*                                                               */
*   /* BLD1ENT - BUILD SCL RECORD(S) FOR A SYSMOD                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0409
*BLD1ENT:                                                          0409
*   PROC(BL1EIOP,                   /* EXTENDED IOP TO WITH PTS    0409
*                                      SYSMOD ENTRY                  */
*       BL1MODE,                    /* MODE INDICATOR, EITHER 'S' FOR
*                                      SELECT OR 'M' FOR MASS        */
*       BL1CAND,                    /* CANDICDATE INDICATOR          */
*       BL1REDO);                   /* REDO INDICATOR                */
BLD1ENT  STM   @14,@12,@SA00004                                    0409
         MVC   @PC00004(16),0(@01)                                 0409
*   DCL                                                            0410
*     BL1EIOP CHAR(*);              /* IOP USED BY THIS ROUTINE      */
*   DCL                                                            0411
*     BL1MODE CHAR(1);              /* MODE INDICATOR                */
*   DCL                                                            0412
*     BL1CAND CHAR(1);              /* CANDIDATE INDICATOR           */
*   DCL                                                            0413
*     BL1REDO CHAR(1);              /* REDO INDICATOR                */
*   DCL                                                            0414
*     BL1RC FIXED(15);              /* RETURN CODE                   */
*   DCL                                                            0415
*     BL1VER# FIXED(8);             /* NUMBER OF THE ++VER STATEMENT */
*   DCL                                                            0416
*     BL1FMID@ PTR(31);             /* PTR TO FMID FOR CURRENT ++VER */
*   DCL                                                            0417
*     BL1NDX1 FIXED(15);            /* SUB-ENTRY SEARCH LOOP INDEX   */
*   DCL                                                            0418
*     1 BL1FLAGS,                   /* LOCAL CONTROL FLAGS           */
*      2 BL1SKIP BIT(1),            /* SKIP THIS ++VER FLAG          */
*      2 BL1IGNOR BIT(1),           /* SKIP THIS SYSMOD              */
*      2 * BIT(6);                                                 0418
*   DCL                                                            0419
*     BASEDSMD CHAR(7) BASED;       /* BASED SYSMOD NAME             */
*   RFY                                                            0420
*     HMASMIOP BASED(ADDR(BL1EIOP));                               0420
*   RFY                                                            0421
*     HMASMGTP BASED(TBLXSCGT);                                    0421
*   RFY                                                            0422
*     SCLMAP BASED(GTPBUFAD);                                      0422
*   RFY                                                            0423
*     TSLPARMS BASED(TBLXTSLP);                                    0423
*   BL1RC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   BL1RC,BL1RC                                         0424
*   BL1FLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         MVI   BL1FLAGS,X'00'                                      0425
*   SCLMAP=''B;                     /* CLEAR RECORD                  */
*                                                                  0426
         L     @07,@PC00001                                        0426
         L     @07,TBLXSCGT(,@07)                                  0426
         L     @07,GTPBUFAD(,@07)                                  0426
         XC    SCLMAP(17,@07),SCLMAP(@07)                          0426
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE LIST NUMBER BASED ON SYSMOD TYPE INFORMATION IN THE */
*   /* PTS SYSMOD ENTRY                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   IF IOPPTYPE=IOPPFUNC THEN       /* FUNCTION?                     */
         L     @02,@PC00004                                        0427
         CLI   IOPPTYPE(@02),4                                     0427
         BNE   @RF00427                                            0427
*     DO;                           /* YES,                          */
*       IF BLDL1=ON                 /*                               */
*           &IOPFLF=ON THEN         /* 1ST LEVEL FUNCTION?           */
         TM    BLDL1,B'10000000'                                   0429
         BNO   @RF00429                                            0429
         TM    IOPFLF(@02),B'00100000'                             0429
         BNO   @RF00429                                            0429
*         DO;                       /* YES,                          */
*           SCLISTNO=SCLL1;         /* SYSMOD IN LIST L1             */
         MVI   SCLISTNO(@07),C'1'                                  0431
*         END;                                                     0432
*       ELSE                        /* NO, LOWER LEVEL FUNCTION      */
*         DO;                                                      0433
         B     @RC00429                                            0433
@RF00429 DS    0H                                                  0434
*           IF BLDL2=ON THEN        /* BUILD LOWER LEVEL LIST?       */
         TM    BLDL2,B'01000000'                                   0434
         BNO   @RF00434                                            0434
*             DO;                   /* YES,                          */
*               SCLISTNO=SCLL2;     /* SYSMOD IN LIST L2             */
         L     @07,@PC00001                                        0436
         L     @07,TBLXSCGT(,@07)                                  0436
         L     @07,GTPBUFAD(,@07)                                  0436
         MVI   SCLISTNO(@07),C'2'                                  0436
*             END;                                                 0437
*         END;                                                     0438
*     END;                                                         0439
*   ELSE                                                           0440
*     ;                             /* NOT A FUNCTION                */
@RF00427 DS    0H                                                  0441
*   IF IOPPTYPE=IOPPPTF THEN        /* PTF?                          */
@RC00427 L     @07,@PC00004                                        0441
         CLI   IOPPTYPE(@07),3                                     0441
         BNE   @RF00441                                            0441
*     DO;                           /* YES,                          */
*       IF BLDL3=ON THEN            /* BUILD PTF LIST?               */
         TM    BLDL3,B'00100000'                                   0443
         BNO   @RF00443                                            0443
*         DO;                       /* YES,                          */
*           SCLISTNO=SCLL3;         /* SYSMOD IN LIST L3             */
         L     @07,@PC00001                                        0445
         L     @07,TBLXSCGT(,@07)                                  0445
         L     @07,GTPBUFAD(,@07)                                  0445
         MVI   SCLISTNO(@07),C'3'                                  0445
*         END;                                                     0446
*     END;                                                         0447
*   ELSE                                                           0448
*     ;                             /* NOT A PTF                     */
@RF00441 DS    0H                                                  0449
*   IF IOPPTYPE=IOPPAPAR THEN       /* APAR?                         */
@RC00441 L     @07,@PC00004                                        0449
         CLI   IOPPTYPE(@07),2                                     0449
         BNE   @RF00449                                            0449
*     DO;                           /* YES,                          */
*       IF BLDL4=ON THEN            /* BUILD APAR LIST?              */
         TM    BLDL4,B'00010000'                                   0451
         BNO   @RF00451                                            0451
*         DO;                       /* YES,                          */
*           SCLISTNO=SCLL4;         /* SYSMOD IN LIST L4             */
         L     @07,@PC00001                                        0453
         L     @07,TBLXSCGT(,@07)                                  0453
         L     @07,GTPBUFAD(,@07)                                  0453
         MVI   SCLISTNO(@07),C'4'                                  0453
*         END;                                                     0454
*     END;                                                         0455
*   ELSE                                                           0456
*     ;                             /* NOT A APAR                    */
@RF00449 DS    0H                                                  0457
*   IF IOPPTYPE=IOPPUSER THEN       /* USERMOD?                      */
@RC00449 L     @07,@PC00004                                        0457
         CLI   IOPPTYPE(@07),1                                     0457
         BNE   @RF00457                                            0457
*     DO;                           /* YES,                          */
*       IF BLDL5=ON THEN            /* BUILD USERMOD LIST?           */
         TM    BLDL5,B'00001000'                                   0459
         BNO   @RF00459                                            0459
*         DO;                       /* YES,                          */
*           SCLISTNO=SCLL5;         /* SYSMOD IN LIST L5             */
         L     @07,@PC00001                                        0461
         L     @07,TBLXSCGT(,@07)                                  0461
         L     @07,GTPBUFAD(,@07)                                  0461
         MVI   SCLISTNO(@07),C'5'                                  0461
*         END;                                                     0462
*     END;                                                         0463
*   ELSE                                                           0464
*     ;                             /* NOT A USER MOD                */
@RF00457 DS    0H                                                  0465
*   IF SCLISTNO=ZERO THEN           /* ELIGLE FOR LIST?              */
@RC00457 L     @07,@PC00001                                        0465
         L     @02,TBLXSCGT(,@07)                                  0465
         L     @02,GTPBUFAD(,@02)                                  0465
         CLI   SCLISTNO(@02),0                                     0465
         BNE   @RF00465                                            0465
*     DO;                           /* NO,                           */
*       BL1IGNOR=ON;                /* IGNORE THIS SYSMOD            */
         OI    BL1IGNOR,B'01000000'                                0467
*       IF BL1MODE=SELECT THEN      /* SELECT ENTRY ?                */
         L     @02,@PC00004+4                                      0468
         CLI   BL1MODE(@02),C'S'                                   0468
         BNE   @RF00468                                            0468
*         DO;                       /* YES,                          */
*           BL1RC=STOPSMD;          /* STOP THE SYSMOD               */
*                                                                  0470
         LA    BL1RC,8                                             0470
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE MESSAGE HMA365I SELECTED XXXXXXXX XXXXXXX CANNOT*/
*           /* BE XXXXXXXX UNLESS XXXXXXXX IS SPECIFIED              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0471
*           DO;                     /* HMASMPMG M1(HMA365I)TYPE(ERR)V
*                                      AR(TXTTYPEA(IOPPTYPE),IOPNAM17
*                                      ,TBLXFUND,TXTKWRDA(IOPPTYPE))T
*                                      ARGET(SYSOUT,LOG)             */
*             HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS      */
         XC    HMASMMGP(28),HMASMMGP                               0472
*             MGPMGNO1=HMA365I;     /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH00792                                0473
*             MGPTYPE=MGPERR;       /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0474
*             MGPPRINT='1'B;        /* SET TARGET FLAG               */
*             MGPHLDS='1'B;         /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0476
*             MGPVARPT(1)=ADDR(TXTTYPEA(IOPPTYPE));/* SET VARIABLE 0477
*                                      PTR                           */
         L     @02,@PC00004                                        0477
         SLR   @15,@15                                             0477
         IC    @15,IOPPTYPE(,@02)                                  0477
         SLA   @15,3                                               0477
         LA    @14,TXTTYPEA-8(@15)                                 0477
         ST    @14,MGPVARPT                                        0477
*             MGPVARPT(2)=ADDR(IOPNAM17);/* SET VARIABLE PTR         */
         LA    @02,IOPNAM17(,@02)                                  0478
         ST    @02,MGPVARPT+4                                      0478
*             MGPVARPT(3)=ADDR(TBLXFUND);/* SET VARIABLE PTR         */
         LA    @07,TBLXFUND(,@07)                                  0479
         ST    @07,MGPVARPT+8                                      0479
*             MGPVARPT(4)=ADDR(TXTKWRDA(IOPPTYPE));/* SET VARIABLE 0480
*                                      PTR                           */
         LA    @07,TXTKWRDA-8(@15)                                 0480
         ST    @07,MGPVARPT+12                                     0480
*             CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED         */
         L     @15,@CV01229                                        0481
         LA    @01,@AL00481                                        0481
         BALR  @14,@15                                             0481
*           END;                    /*                               */
*           IF BL1MODE=SELECT THEN  /* SELECT MODE?                  */
         L     @07,@PC00004+4                                      0483
         CLI   BL1MODE(@07),C'S'                                   0483
         BNE   @RF00483                                            0483
*             DO;                   /* YES,                          */
*               RFY                                                0485
*                 HMASMGTP BASED(BLDSLST@);                        0485
*               RFY                                                0486
*                 HMASMSET BASED(GTPBUFAD);                        0486
*               RFY                                                0487
*                 SCLMAP BASED;                                    0487
*               SEFLAG2A=ON;        /* INDICATE MESSAGE ISSUED       */
         L     @07,GTPBUFAD(,BLDSLST@)                             0488
         OI    SEFLAG2A(@07),B'10000000'                           0488
*               GTPFUNCT=GTPADD;    /* SET FLAG IN GTA RECORD        */
         MVI   GTPFUNCT(BLDSLST@),X'04'                            0489
*               CALL HMASMGTA(HMASMGTP);/* ...                       */
         ST    BLDSLST@,@AL00001                                   0490
         L     @15,@CV01230                                        0490
         LA    @01,@AL00001                                        0490
         BALR  @14,@15                                             0490
*               BL1RC=MAX(BL1RC,GTPRETRN);/* SAVE MAX RETURN CODE    */
         SLR   @07,@07                                             0491
         IC    @07,GTPRETRN(,BLDSLST@)                             0491
         CR    BL1RC,@07                                           0491
         BNL   *+6
         LR    BL1RC,@07                                           0491
*               RFY                                                0492
*                 HMASMGTP BASED(TBLXSCGT);                        0492
*               RFY                                                0493
*                 HMASMSET BASED;                                  0493
*               RFY                                                0494
*                 SCLMAP BASED(GTPBUFAD);                          0494
*             END;                                                 0495
*           ELSE                                                   0496
*             ;                     /* NOT SELECT                    */
@RF00483 DS    0H                                                  0497
*         END;                                                     0497
*       ELSE                                                       0498
*         ;                         /* GO NOT ISSUE MESSAGE          */
@RF00468 DS    0H                                                  0499
*     END;                                                         0499
*   ELSE                                                           0500
*     ;                             /* IN A VALID LIST               */
@RF00465 DS    0H                                                  0501
*   IF BL1RC=ZERO                   /* ALL IS WELL, AND              */
*       &BL1IGNOR=OFF THEN          /* DON'T IGNORE SYSMOD           */
         LTR   BL1RC,BL1RC                                         0501
         BNZ   @RF00501                                            0501
         TM    BL1IGNOR,B'01000000'                                0501
         BNZ   @RF00501                                            0501
*     DO;                           /* YES,                          */
*                                                                  0502
*       /*************************************************************/
*       /*                                                           */
*       /* SET SCL RECORD FIELD THAT ARE COMMON FOR ALL ++VER CARDS  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0503
*       SCLSMD=IOPNAM17;            /* SYSMOD IN SYSMOD GTA FILE     */
         L     @07,@PC00001                                        0503
         L     @07,TBLXSCGT(,@07)                                  0503
         L     @07,GTPBUFAD(,@07)                                  0503
         L     @02,@PC00004                                        0503
         MVC   SCLSMD(7,@07),IOPNAM17(@02)                         0503
*       SCLSTAT=''B;                /* CLEAR STATUS FLAGS            */
         MVI   SCLSTAT(@07),X'00'                                  0504
*       IF BL1MODE=SELECT THEN      /* SELECT MODE?                  */
         L     @02,@PC00004+4                                      0505
         CLI   BL1MODE(@02),C'S'                                   0505
         BNE   @RF00505                                            0505
*         DO;                       /* YES,                          */
*           SCLSELST=ON;            /* SELECT FLAG                   */
         OI    SCLSELST(@07),B'01000000'                           0507
*         END;                                                     0508
*       ELSE                                                       0509
*         ;                         /* NOT SELECT MODE               */
@RF00505 DS    0H                                                  0510
*       IF BL1REDO=REDO THEN        /* RE APPLICATION?               */
         L     @07,@PC00004+12                                     0510
         CLI   BL1REDO(@07),C'R'                                   0510
         BNE   @RF00510                                            0510
*         DO;                                                      0511
*           SCLREDO=ON;             /* FLAG AS REAPPLICATION SYSMOD  */
         L     @07,@PC00001                                        0512
         L     @07,TBLXSCGT(,@07)                                  0512
         L     @07,GTPBUFAD(,@07)                                  0512
         OI    SCLREDO(@07),B'00010000'                            0512
*         END;                                                     0513
*       ELSE                                                       0514
*         ;                         /* NOT RE APPLY                  */
@RF00510 DS    0H                                                  0515
*       IF BL1CAND=CANDIDTE THEN    /* SET CANDIDATE FLAG?           */
         L     @07,@PC00004+8                                      0515
         CLI   BL1CAND(@07),C'C'                                   0515
         BNE   @RF00515                                            0515
*         DO;                       /* YES,                          */
*           SCLCAND=ON;             /* SYSMOD IS A CANDIDATE         */
         L     @07,@PC00001                                        0517
         L     @07,TBLXSCGT(,@07)                                  0517
         L     @07,GTPBUFAD(,@07)                                  0517
         OI    SCLCAND(@07),B'00100000'                            0517
*         END;                                                     0518
*       ELSE                                                       0519
*         ;                         /* DO NOT SET CANDIDATE          */
@RF00515 DS    0H                                                  0520
*     END;                          /*                               */
*   ELSE                                                           0521
*     ;                             /* PREVIOUS ERROR                */
*                                                                  0521
@RF00501 DS    0H                                                  0522
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU SYSMOD IOP TO ADD A RECORD TO SCL FOR EACH ++VER    */
*   /* THAT HAS AN SREL THAT MATCHES THE SYSTEM SREL (TBLXSREL)      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0522
*   DO BL1NDX1=1 BY 1               /* LOOP THRU SUB ENTRIES         */
*         WHILE(IOPPTFND(BL1NDX1)^=IOPEOLST/*                        */
*         &BL1IGNOR=OFF             /* DON'T IGNORE SYSMOD           */
*         &BL1RC=ZERO);             /*                               */
         LA    BL1NDX1,1                                           0522
         B     @DE00522                                            0522
@DL00522 DS    0H                                                  0523
*     BL1SKIP=OFF;                  /* CLEAR SKIP VER FLAG           */
         NI    BL1SKIP,B'01111111'                                 0523
*     SCLDELP=OFF;                  /* CLEAR DELETE PRESENT ON THIS
*                                      ++VER FLAG                    */
         L     @07,@PC00001                                        0524
         L     @04,TBLXSCGT(,@07)                                  0524
         L     @04,GTPBUFAD(,@04)                                  0524
         NI    SCLDELP(@04),B'01111111'                            0524
*     IF IOPPIND(BL1NDX1)=IOPPSREL THEN/* SREL ENTRY?                */
         LR    @02,BL1NDX1                                         0525
         MH    @02,@CH00476                                        0525
         L     @15,@PC00004                                        0525
         SLR   @14,@14                                             0525
         IC    @14,IOPPIND-9(@02,@15)                              0525
         CH    @14,@CH00782                                        0525
         BNE   @RF00525                                            0525
*       DO;                         /* YES,                          */
*         IF TBLXSREL=IOPSRLNM(BL1NDX1) THEN/* DOES SREL MATCH SYSTEM
*                                      SREL                          */
         ST    @02,@TF00001                                        0527
         ALR   @02,@15                                             0527
         CLC   TBLXSREL(4,@07),IOPSRLNM-9(@02)                     0527
         BNE   @RF00527                                            0527
*           DO;                     /* YES,                          */
         ST    @04,@TF00002                                        0528
*             BL1VER#=IOPENTST(BL1NDX1);/* ++VER NUMBER OF MATCH   0529
*                                      MATCHING SREL NUMBER          */
         L     @07,@TF00001                                        0529
         SLR   BL1VER#,BL1VER#                                     0529
         IC    BL1VER#,IOPENTST-9(@07,@15)                         0529
*             IF SCLISTNO=SCLL1 THEN/* 1ST LEVEL ?                   */
         L     @07,@TF00002                                        0530
         CLI   SCLISTNO(@07),C'1'                                  0530
         BNE   @RF00530                                            0530
*               DO;                 /* YES, PUT RECORD IN GTA        */
*                 SCLVERNO=BL1VER#; /* SET VER NUMBER                */
         L     @07,@TF00002                                        0532
         STC   BL1VER#,SCLVERNO(,@07)                              0532
*               END;                                               0533
*             ELSE                  /* NOT 1ST LEVEL                 */
*               DO;                                                0534
         B     @RC00530                                            0534
@RF00530 DS    0H                                                  0535
*                                                                  0535
*                 /***************************************************/
*                 /*                                                 */
*                 /* FIND FMID SUB-ENTRY FOR THE CURRENT ++VER. IF IT*/
*                 /* IS NOT FOUND (I.E. NOT A RELEASE 4 VER), SKIP   */
*                 /* THE VER                                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0535
*                 TSLENTSR=''B;                                    0535
         L     @02,@PC00001                                        0535
         L     @02,TBLXTSLP(,@02)                                  0535
         L     @15,TSLPMLAD(,@02)                                  0535
         XC    TSLENTSR(16,@15),TSLENTSR(@15)                      0535
*                 TSLFUNCT=TSLFENSR;                               0536
         MVI   TSLFUNCT(@02),X'06'                                 0536
*                 TSLETYPE=IOPPFID; /* FIND FMID SUB-ENTRY           */
         MVI   TSLETYPE(@15),X'A7'                                 0537
*                 TSLEVER#=BL1VER#; /* ++VER NUMBER                  */
         STC   BL1VER#,TSLEVER#(,@15)                              0538
*                 TSLEBGNP=ADDR(IOPPTFVR);/* BEGINNING OF SEARCH     */
         L     @14,@PC00004                                        0539
         LA    @14,IOPPTFVR(,@14)                                  0539
         ST    @14,TSLEBGNP(,@15)                                  0539
*                 CALL HMASMTSB(TSLPARMS);                         0540
         ST    @02,@AL00001                                        0540
         L     @15,@CV01231                                        0540
         LA    @01,@AL00001                                        0540
         BALR  @14,@15                                             0540
*                 RFY                                              0541
*                   RTNCODE RSTD;                                  0541
*                 BL1FMID@=TSLEFNDP;/* SAVE PTR TO FMID              */
         L     @14,@PC00001                                        0542
         L     @02,TBLXTSLP(,@14)                                  0542
         L     @02,TSLPMLAD(,@02)                                  0542
         L     BL1FMID@,TSLEFNDP(,@02)                             0542
*                 IF RTNCODE^=ZERO THEN/* FMID NOT FOUND?            */
         LTR   RTNCODE,RTNCODE                                     0543
         BZ    @RF00543                                            0543
*                   DO;                                            0544
*                     IF CCAFMID^=BLNKFMID THEN/* NULL FMID SUPPLIED?*/
         CLC   CCAFMID(7,CCAPTR),@CC01259                          0545
         BE    @RF00545                                            0545
*                       DO;         /* YES,                          */
*                         SCLFMID=CCAFMID;/* SET SCL FMID TO THE CCA
*                                      NULL FMID                     */
         L     @14,TBLXSCGT(,@14)                                  0547
         L     @14,GTPBUFAD(,@14)                                  0547
         MVC   SCLFMID(7,@14),CCAFMID(CCAPTR)                      0547
*                         SCLVERNO=BL1VER#;/* SET THE ++VER NUMBER   */
         STC   BL1VER#,SCLVERNO(,@14)                              0548
*                       END;                                       0549
*                     ELSE          /* NO NULL FMID                  */
*                       DO;                                        0550
         B     @RC00545                                            0550
@RF00545 DS    0H                                                  0551
*                         BL1SKIP=ON;/* SKIP THIS ++VER STATEMENT  0551
*                                      SINCE IT IS NOT A RELEASE 4 0551
*                                      VER STATEMENT                 */
         OI    BL1SKIP,B'10000000'                                 0551
*                       END;                                       0552
*                   END;                                           0553
*                 ELSE              /* FMID FOUND                    */
*                   DO;                                            0554
         B     @RC00543                                            0554
@RF00543 DS    0H                                                  0555
*                     SCLFMID=BL1FMID@->BASEDSMD;/* SET THE FMID     */
         L     @14,@PC00001                                        0555
         L     @14,TBLXSCGT(,@14)                                  0555
         L     @14,GTPBUFAD(,@14)                                  0555
         MVC   SCLFMID(7,@14),BASEDSMD(BL1FMID@)                   0555
*                     SCLVERNO=BL1VER#;/* SET VER NUMBER             */
         STC   BL1VER#,SCLVERNO(,@14)                              0556
*                   END;                                           0557
*               END;                                               0558
@RC00543 DS    0H                                                  0559
*             IF BL1SKIP=OFF THEN   /* NOT SKIPPING VER?             */
@RC00530 TM    BL1SKIP,B'10000000'                                 0559
         BNZ   @RF00559                                            0559
*               DO;                                                0560
*                                                                  0560
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET DEL PRESENT FLAG IS THERE IS A DELETE       */
*                 /* SUB-ENTRY FOR THE CURRENT ++VER IN THE          */
*                 /* IOP-SUBENTRIES                                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0561
*                 TSLFUNCT=TSLFENSR;                               0561
         L     @14,@PC00001                                        0561
         L     @14,TBLXTSLP(,@14)                                  0561
         MVI   TSLFUNCT(@14),X'06'                                 0561
*                 TSLENTSR=''B;                                    0562
         L     @07,TSLPMLAD(,@14)                                  0562
         XC    TSLENTSR(16,@07),TSLENTSR(@07)                      0562
*                 TSLETYPE=IOPPDEL; /* FIND DELETE SUB-ENTRY         */
         MVI   TSLETYPE(@07),X'A8'                                 0563
*                 TSLEVER#=BL1VER#; /* ++VER NUMBER                  */
         STC   BL1VER#,TSLEVER#(,@07)                              0564
*                 TSLEBGNP=ADDR(IOPPTFVR);/* BEGINNING OF SEARCH     */
         L     @04,@PC00004                                        0565
         LA    @04,IOPPTFVR(,@04)                                  0565
         ST    @04,TSLEBGNP(,@07)                                  0565
*                 CALL HMASMTSB(TSLPARMS);                         0566
         ST    @14,@AL00001                                        0566
         L     @15,@CV01231                                        0566
         LA    @01,@AL00001                                        0566
         BALR  @14,@15                                             0566
*                 RFY                                              0567
*                   RTNCODE RSTD;   /*                               */
*                 IF RTNCODE=ZERO THEN/* DELETE ENTRY FOR VER?       */
         LTR   RTNCODE,RTNCODE                                     0568
         BNZ   @RF00568                                            0568
*                   DO;             /* YES,                          */
*                     RFY                                          0570
*                       RTNCODE UNRSTD;/*                            */
*                     SCLDELP=ON;   /* DELETE PRESENT FOR ++VER      */
         L     @07,@PC00001                                        0571
         L     @07,TBLXSCGT(,@07)                                  0571
         L     @07,GTPBUFAD(,@07)                                  0571
         OI    SCLDELP(@07),B'10000000'                            0571
*                   END;                                           0572
*                 ELSE                                             0573
*                   ;               /* NO DELETE                     */
*                                                                  0573
@RF00568 DS    0H                                                  0574
*                 /***************************************************/
*                 /*                                                 */
*                 /* PUT THE RECORD IN THE GTA FILE                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0574
*                 GTPFUNCT=GTPADD;  /* ADD RECORD TO SYSMOD CANDIDATE
*                                      LST                           */
         L     @07,@PC00001                                        0574
         L     @07,TBLXSCGT(,@07)                                  0574
         MVI   GTPFUNCT(@07),X'04'                                 0574
*                 CALL HMASMGTA(HMASMGTP);/*                         */
         ST    @07,@AL00001                                        0575
         L     @15,@CV01230                                        0575
         LA    @01,@AL00001                                        0575
         BALR  @14,@15                                             0575
*                 BL1RC=MAX(BL1RC,GTPRETRN);/*                       */
         L     @07,@PC00001                                        0576
         L     @07,TBLXSCGT(,@07)                                  0576
         SLR   @04,@04                                             0576
         IC    @04,GTPRETRN(,@07)                                  0576
         CR    BL1RC,@04                                           0576
         BNL   *+6
         LR    BL1RC,@04                                           0576
*               END;                                               0577
*             ELSE                                                 0578
*               ;                   /* SKIP THIS ++VER STATEMENT     */
@RF00559 DS    0H                                                  0579
*           END;                                                   0579
*         ELSE                                                     0580
*           ;                       /* IOP SREL DOES NOT MATCH       */
@RF00527 DS    0H                                                  0581
*       END;                                                       0581
*     ELSE                                                         0582
*       ;                           /* NOT AN SREL SUB-ENTRY         */
@RF00525 DS    0H                                                  0583
*   END;                            /* END OF SUB-ENTRY LOOP         */
         AH    BL1NDX1,@CH00063                                    0583
@DE00522 LR    @07,BL1NDX1                                         0583
         MH    @07,@CH00476                                        0583
         L     @04,@PC00004                                        0583
         SLR   @02,@02                                             0583
         IC    @02,IOPPTFND-9(@07,@04)                             0583
         CH    @02,@CH00609                                        0583
         BE    @DC00522                                            0583
         TM    BL1IGNOR,B'01000000'                                0583
         BNZ   @DC00522                                            0583
         LTR   BL1RC,BL1RC                                         0583
         BZ    @DL00522                                            0583
@DC00522 DS    0H                                                  0584
*   RETURN CODE(BL1RC);             /* RETURN WITH RETURN CODE       */
         LR    @15,BL1RC                                           0584
         L     @14,@SA00004                                        0584
         LM    @00,@12,@SA00004+8                                  0584
         BR    @14                                                 0584
*   RFY                                                            0585
*     HMASMIOP BASED;                                              0585
*   RFY                                                            0586
*     HMASMGTP BASED;                                              0586
*   RFY                                                            0587
*     SCLMAP BASED;                                                0587
*   RFY                                                            0588
*     TSLPARMS BASED;                                              0588
*   END BLD1ENT;                                                   0589
*                                                                  0590
*/*  BLDMASSL - BUILD SCL RECORDS FOR ALL ELEGIBLE 'MASS MODE' SYSMODS
*                                                                    */
*                                                                  0590
*BLDMASSL:                                                         0590
*   PROC(BLMIOP);                   /* EXTENDED IOP                  */
BLDMASSL STM   @14,@12,@SA00005                                    0590
         MVC   @PC00005(4),0(@01)                                  0590
*   DCL                                                            0591
*     BLMIOP CHAR(*);               /* EXTENDED IOP TO BE USED TO GET
*                                      SYSMOD ENTRY                  */
*   DCL                                                            0592
*     1 BLMFLAGS,                   /* LOCAL CONTROL FLAGS           */
*      2 BLM1SMD BIT(1),            /* 1ST SYSMOD DIRECTORY ENTRY  0592
*                                      FOUND ON DS1                  */
*      2 BLM2SMD BIT(1),            /* 1ST SYSMOD DIRECTORY ENTRY  0592
*                                      FOUND ON DS2                  */
*      2 BLM1EOF BIT(1),            /* EOF OR NEXT AFTER SYSMOD    0592
*                                      ENCOUNTERED                   */
*      2 BLM2EOF BIT(1),                                           0592
*      2 BLMGET1 BIT(1),            /* GET NEXT DIR ENTRY FROM DS1   */
*      2 BLMGET2 BIT(1),            /* GET NEXT DIR ENTRY FROM DS2   */
*      2 BLMENT1 BIT(1),            /* BUILD ENTRY FOR DS1 SYSMOD    */
*      2 BLMENT2 BIT(1),            /* BUILD ENTRY FOR DS2 SYSMOD  0592
*                                      (NOT USED)                    */
*      2 * BIT(8);                  /* UNUSED                        */
*   DCL                                                            0593
*     BLMRC FIXED(15);              /* RETURN CODE                   */
*   DCL                                                            0594
*     BLM1IOP@ PTR(31);             /* PTR TO IOP FOR DS1            */
*   DCL                                                            0595
*     BLM2IOP@ PTR(31);             /* PTR TO IOP FOR DS2            */
*   DCL                                                            0596
*     BLMSMD1 CHAR(LENGTH(IOPNAM17))/*                               */
*         BASED(ADDR(BLM1IOP@->IOPNAM17));/* DS1 DIRECTORY ENTRY   0596
*                                      SYSMOD NAME                   */
*   DCL                                                            0597
*     BLMSMD2 CHAR(LENGTH(IOPNAM17))/*                               */
*         BASED(ADDR(BLM2IOP@->IOPNAM17));/* DS2 DIRECTORY ENTRY   0597
*                                      SYSMOD NAME                   */
*   DCL                                                            0598
*     BLMCAND CHAR(1);              /* SYSMOD IS TO BE MARKED      0598
*                                      CANDIDATE INDICATOR           */
*   DCL                                                            0599
*     BLMREDO CHAR(1);              /* SYSMOD IS ON THE CDS/ACDS     */
*   RFY                                                            0600
*     HMASMGTP BASED(TBLXSEGT);                                    0600
*   RFY                                                            0601
*     HMASMSET BASED(GTPBUFAD);                                    0601
*   BLMFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         XC    BLMFLAGS(2),BLMFLAGS                                0602
*   BLMRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   BLMRC,BLMRC                                         0603
*   IF BLDMCAND=ON THEN             /* ARE MASS ENTRIES TO BE MARKED
*                                      AS CANDIDATES?                */
         TM    BLDMCAND,B'00010000'                                0604
         BNO   @RF00604                                            0604
*     DO;                           /* YES,                          */
*       BLMCAND=CANDIDTE;           /* MARK AS CANDIDATE             */
         MVI   BLMCAND,C'C'                                        0606
*     END;                                                         0607
*   ELSE                            /* MASS ENTRIES ARE NOT        0608
*                                      CANDIDATES                    */
*     DO;                                                          0608
         B     @RC00604                                            0608
@RF00604 DS    0H                                                  0609
*       BLMCAND=ZERO;               /* DO NOT MARK AS CANDIDATE      */
         MVI   BLMCAND,X'00'                                       0609
*     END;                                                         0610
*   BLM1IOP@=TBLXIOPF;              /* IOP FOR DIRECTORY READ OF DS1 */
@RC00604 L     @07,@PC00001                                        0611
         L     BLM1IOP@,TBLXIOPF(,@07)                             0611
*   BLM2IOP@=ADDR(TPLIOPF);         /* IOP FOR DIRECTORY READ OF DS2 */
         LA    BLM2IOP@,TPLIOPF                                    0612
*   BLM1IOP@->IOPDSID=BLDDSID1;     /* DSID OF DS1                   */
         MVC   IOPDSID(1,BLM1IOP@),BLDDSID1                        0613
*   BLM2IOP@->IOPDSID=BLDDSID2;     /* DSID OF DS2                   */
         MVC   IOPDSID(1,BLM2IOP@),BLDDSID2                        0614
*   BLM1IOP@->IOPFUNCT=IOPOPENN;    /* RESET TO THE BEGINNING OF DS1 */
         MVI   IOPFUNCT(BLM1IOP@),X'0C'                            0615
*   CALL HMASMIO(BLM1IOP@->HMASMIOP);/* ...                          */
         ST    BLM1IOP@,@AL00001                                   0616
         L     @15,@CV01228                                        0616
         LA    @01,@AL00001                                        0616
         BALR  @14,@15                                             0616
*   BLM2IOP@->IOPFUNCT=IOPOPENN;    /* RESET TO THE BEGINNING OF DS2 */
         MVI   IOPFUNCT(BLM2IOP@),X'0C'                            0617
*   CALL HMASMIO(BLM2IOP@->HMASMIOP);/* ...                          */
*                                                                  0618
         ST    BLM2IOP@,@AL00001                                   0618
         L     @15,@CV01228                                        0618
         LA    @01,@AL00001                                        0618
         BALR  @14,@15                                             0618
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ALL SYSMOD ENTRIES ON BOTH DS1 AND DS2                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0619
*   DO WHILE(BLMRC<STOPFUNC&(BLM1EOF=OFF×BLM2EOF=OFF));            0619
         B     @DE00619                                            0619
@DL00619 DS    0H                                                  0620
*     BLMREDO=' ';                  /* CLEAR REDO FLAG               */
         MVI   BLMREDO,C' '                                        0620
*     BLMENT1=OFF;                  /* CLEAR BUILD ENTRY FLAG        */
*     BLMENT2=OFF;                  /* CLEAR BUILD ENTRY FLAG        */
         NI    BLMENT1,B'11111100'                                 0622
*     CALL DS1READ;                 /*                               */
         BAL   @14,DS1READ                                         0623
*     RFY                                                          0624
*       RTNCODE RSTD;                                              0624
*     BLMRC=MAX(BLMRC,RTNCODE);     /* SET RETURN CODE               */
         CR    BLMRC,RTNCODE                                       0625
         BNL   *+6
         LR    BLMRC,RTNCODE                                       0625
*     RFY                                                          0626
*       RTNCODE UNRSTD;                                            0626
*     CALL DS2READ;                 /*                               */
         BAL   @14,DS2READ                                         0627
*     RFY                                                          0628
*       RTNCODE RSTD;                                              0628
*     BLMRC=MAX(BLMRC,RTNCODE);     /* SET RETURN CODE               */
         CR    BLMRC,RTNCODE                                       0629
         BNL   *+6
         LR    BLMRC,RTNCODE                                       0629
*     RFY                                                          0630
*       RTNCODE UNRSTD;                                            0630
*     BLMGET1=OFF;                  /* CLEAR READ FLAGS              */
*     BLMGET2=OFF;                  /* ...                           */
         NI    BLMGET1,B'11110011'                                 0632
*     IF(BLM1EOF=OFF                /* ENTRY FROM DS2                */
*         ×BLM2EOF=OFF)             /* NOT AT END OF BOTH DS1 AND    */
*         &BLMRC<STOPFUNC THEN      /* DS2?                          */
         TM    BLM1EOF,B'00110000'                                 0633
         BO    @RF00633                                            0633
         CH    BLMRC,@CH00033                                      0633
         BNL   @RF00633                                            0633
*       DO;                                                        0634
*         IF BLM1SMD=ON             /* WITHIN SYSMOD ENTRIES ON      */
*             &BLM1EOF=OFF THEN     /* DS1?                          */
         TM    BLM1SMD,B'10000000'                                 0635
         BNO   @RF00635                                            0635
         TM    BLM1EOF,B'00100000'                                 0635
         BNZ   @RF00635                                            0635
*           DO;                     /* YES,                          */
*             IF BLM2SMD=OFF        /* NO DS2 SYSMOD?                */
*                 ×BLM2EOF=ON THEN                                 0637
         TM    BLM2EOF,B'00010000'                                 0637
         BNZ   @RT00637                                            0637
         TM    BLM2SMD,B'01000000'                                 0637
         BO    @RF00637                                            0637
@RT00637 DS    0H                                                  0638
*               DO;                 /* YES,                          */
*                 BLMENT1=ON;       /* BUILD ICT ENTRY IF POSSIBLE   */
*                 BLMGET1=ON;       /* GET NEXT ENTRY FROM DS1       */
         OI    BLMENT1,B'00001010'                                 0640
*               END;                                               0641
*             ELSE                  /* ALSO WITHIN SYSMOD ENTRIES    */
*               DO;                 /* ON DS2                        */
         B     @RC00637                                            0642
@RF00637 DS    0H                                                  0643
*                 IF BLMSMD1=BLMSMD2 THEN/* DS1/DS2 SYSMODS EQUAL?   */
         LA    @07,4                                               0643
         LR    @02,BLM1IOP@                                        0643
         ALR   @02,@07                                             0643
         ALR   @07,BLM2IOP@                                        0643
         CLC   BLMSMD1(7,@02),BLMSMD2(@07)                         0643
         BNE   @RF00643                                            0643
*                   DO;             /* YES,                          */
*                     BLMGET1=ON;   /* SKIP BY GETTING RECORDS       */
*                     BLMGET2=ON;   /* FROM BOTH 1 AND 2             */
         OI    BLMGET1,B'00001100'                                 0646
*                     IF TBLGROUP=ON THEN/* GROUP?                   */
         L     @07,@PC00001                                        0647
         L     @07,TBLXTBL(,@07)                                   0647
         TM    TBLGROUP(@07),B'00100000'                           0647
         BNO   @RF00647                                            0647
*                       DO;         /* YES,                          */
*                         BLMENT1=ON;/* BUILD AN ENTRY               */
         OI    BLMENT1,B'00000010'                                 0649
*                         BLMREDO=REDO;/* INDICATE REPROCESSING      */
         MVI   BLMREDO,C'R'                                        0650
*                       END;                                       0651
*                   END;                                           0652
*                 ELSE                                             0653
*                   ;               /* NOT EQUAL?                    */
@RF00643 DS    0H                                                  0654
*                 IF BLMSMD1<BLMSMD2 THEN/* SYSMOD DS1 NOT ON DS2?   */
@RC00643 LA    @07,4                                               0654
         LR    @02,BLM1IOP@                                        0654
         ALR   @02,@07                                             0654
         ALR   @07,BLM2IOP@                                        0654
         CLC   BLMSMD1(7,@02),BLMSMD2(@07)                         0654
         BNL   @RF00654                                            0654
*                   DO;             /* YES,                          */
*                     BLMENT1=ON;   /* BUILD SCL ENTRY               */
*                     BLMGET1=ON;   /* GET NEXT DS1 ENTRY            */
         OI    BLMENT1,B'00001010'                                 0657
*                   END;                                           0658
*                 ELSE                                             0659
*                   ;                                              0659
@RF00654 DS    0H                                                  0660
*                 IF BLMSMD1>BLMSMD2 THEN/* DS2 SYSMOD NOT IN        */
         LA    @07,4                                               0660
         LR    @02,BLM1IOP@                                        0660
         ALR   @02,@07                                             0660
         ALR   @07,BLM2IOP@                                        0660
         CLC   BLMSMD1(7,@02),BLMSMD2(@07)                         0660
         BNH   @RF00660                                            0660
*                   DO;             /* DS1                           */
*                     BLMGET2=ON;   /* GET NEXT DS2 DIR. ENTRY       */
*                     BLMENT2=ON;                                  0663
         OI    BLMGET2,B'00000101'                                 0663
*                   END;                                           0664
*                 ELSE                                             0665
*                   ;                                              0665
@RF00660 DS    0H                                                  0666
*               END;                                               0666
*           END;                                                   0667
*         ELSE                      /* NOT WITHIN SYSMODS ON SYSMOD  */
*           DO;                     /* ENTRIES ON DS1                */
         B     @RC00635                                            0668
@RF00635 DS    0H                                                  0669
*             IF BLM2EOF=OFF THEN   /* WITHIN SYSMODS ON DS2?        */
         TM    BLM2EOF,B'00010000'                                 0669
         BNZ   @RF00669                                            0669
*               DO;                 /* YES,                          */
*                 BLMGET2=ON;       /* CONTINUE GETTING UNTIL EOF    */
         OI    BLMGET2,B'00000100'                                 0671
*                 IF BLM2SMD=ON THEN/* GOTTEN FIRST SYSMOD?          */
         TM    BLM2SMD,B'01000000'                                 0672
         BNO   @RF00672                                            0672
*                   DO;             /* YES,                          */
*                     BLMENT2=ON;   /* BUILD ENTRY FROM DS2          */
         OI    BLMENT2,B'00000001'                                 0674
*                   END;            /*                               */
*                 ELSE                                             0676
*                   ;               /* FIRST SYSMOD NOT FOUND        */
@RF00672 DS    0H                                                  0677
*               END;                                               0677
*             ELSE                                                 0678
*               ;                   /* EOF ON DS2                    */
@RF00669 DS    0H                                                  0679
*           END;                                                   0679
*       END;                                                       0680
*     ELSE                                                         0681
*       ;                           /* EOF ON BOTH DS1 AND DS2       */
*                                                                  0681
@RF00633 DS    0H                                                  0682
*     /***************************************************************/
*     /*                                                             */
*     /* BUILD SCL ENTRY IF SYSMOD IS NOT IN THE EXCLUDE LIST        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0682
*     IF BLMENT1=ON THEN            /* BUILD SCL ENTRIES             */
@RC00633 TM    BLMENT1,B'00000010'                                 0682
         BNO   @RF00682                                            0682
*       DO;                         /* YES,                          */
*                                                                  0683
*         /***********************************************************/
*         /*                                                         */
*         /* SEARCH FOR SYSMOD IN THE EXCLUDE OR GROUP LIST          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0684
*         IF BLDEXEC=ON             /* EXCLUDE ....                  */
*             ×TBLGROUP=ON THEN     /* OR GROUP SPECIFIED?           */
         TM    BLDEXEC,B'00100000'                                 0684
         BO    @RT00684                                            0684
         L     @07,@PC00001                                        0684
         L     @07,TBLXTBL(,@07)                                   0684
         TM    TBLGROUP(@07),B'00100000'                           0684
         BNO   @RF00684                                            0684
@RT00684 DS    0H                                                  0685
*           DO;                     /*                               */
*             SELSTFLG=''B;         /* CLEAR TYPE FLAGS              */
         L     @07,@PC00001                                        0686
         L     @07,TBLXSEGT(,@07)                                  0686
         L     @02,GTPBUFAD(,@07)                                  0686
         XC    SELSTFLG(2,@02),SELSTFLG(@02)                       0686
*             SENAME=' ';           /* BLANK THE NAME FIELD          */
         MVI   SENAME+1(@02),C' '                                  0687
         MVC   SENAME+2(6,@02),SENAME+1(@02)                       0687
         MVI   SENAME(@02),C' '                                    0687
*             SESMD=ON;             /* TYPE IS SYSMOD                */
         OI    SESMD(@02),B'00000001'                              0688
*             SESMDNO=BLMSMD1;      /* SYSMOD NAME                   */
         MVC   SESMDNO(7,@02),BLMSMD1+4(BLM1IOP@)                  0689
*             GTPFUNCT=GTPLOC;                                     0690
         MVI   GTPFUNCT(@07),X'03'                                 0690
*             CALL HMASMGTA(HMASMGTP);                             0691
         ST    @07,@AL00001                                        0691
         L     @15,@CV01230                                        0691
         LA    @01,@AL00001                                        0691
         BALR  @14,@15                                             0691
*             IF GTPRETRN^=GTPNTFND THEN/* IN EXCLUDE LIST?          */
         L     @07,@PC00001                                        0692
         L     @07,TBLXSEGT(,@07)                                  0692
         CLI   GTPRETRN(@07),4                                     0692
         BE    @RF00692                                            0692
*               DO;                 /*                               */
*                 BLMGET1=ON;       /* SKIP IT BY GETTING NEXT RECORD*/
*                 BLMENT1=OFF;      /* DO NOT BUILD SCL ENTRIES FOR
*                                      AN EXCLUDED SYSMOD            */
         OI    BLMGET1,B'00001000'                                 0695
         NI    BLMENT1,B'11111101'                                 0695
*               END;                /*                               */
*           END;                    /*                               */
@RF00692 DS    0H                                                  0698
*         IF BLMENT1=ON THEN        /* SYSMOD IS MASS ELIGIBLE?      */
@RF00684 TM    BLMENT1,B'00000010'                                 0698
         BNO   @RF00698                                            0698
*           DO;                     /* YES,                          */
*             RFY                                                  0700
*               HMASMIOP BASED(ADDR(BLMIOP));                      0700
*             IOPDSID=BLDDSIDS;     /* GET SYSMOD EXTENDED ENTRY     */
         L     @07,@PC00005                                        0701
         MVC   IOPDSID(1,@07),BLDDSIDS                             0701
*             IOPTYPE=IOPSMD;       /* ...                           */
         MVI   IOPTYPE(@07),X'0B'                                  0702
*             IOPFUNCT=IOPLOC;      /* ...                           */
         MVI   IOPFUNCT(@07),X'03'                                 0703
*             IOPNAM17=BLMSMD1;     /* ...                           */
         MVC   IOPNAM17(7,@07),BLMSMD1+4(BLM1IOP@)                 0704
*             CALL HMASMIO(HMASMIOP);                              0705
         ST    @07,@AL00001                                        0705
         L     @15,@CV01228                                        0705
         LA    @01,@AL00001                                        0705
         BALR  @14,@15                                             0705
*             IF IOPRETRN>ZERO THEN /* ALL IS WELL?                  */
         L     @07,@PC00005                                        0706
         CLI   IOPRETRN(@07),0                                     0706
         BNH   @RF00706                                            0706
*               DO;                 /* NO,                           */
*                 IF IOPRETRN=IOPNTFND THEN/* NOT FOUND?             */
         CLI   IOPRETRN(@07),4                                     0708
         BNE   @RF00708                                            0708
*                   DO;             /* YES,                          */
*                     IOPRETRN=ZERO;/* RESET RC TO ZERO      @Z67SP00*/
         MVI   IOPRETRN(@07),X'00'                                 0710
*                     IF BLDDSID1=BLDDSIDS THEN                    0711
         CLC   BLDDSID1(1),BLDDSIDS                                0711
         BNE   @RF00711                                            0711
*                       DO;         /* ??????                        */
*                                                                  0712
*                         /*******************************************/
*                         /*                                         */
*                         /* ??????                                  */
*                         /*                                         */
*                         /*******************************************/
*                                                                  0713
*                       END;                                       0713
*                     ELSE          /* NOT FOUND ON SELECT (I.E. PTS)
*                                      DATA SET                      */
*                       DO;                                        0714
         B     @RC00711                                            0714
@RF00711 DS    0H                                                  0715
*                       END;        /*                       @Z67SP00*/
*                   END;                                           0716
@RC00711 DS    0H                                                  0717
*                 BLMRC=MAX(BLMRC,IOPRETRN);/* SET RETURN CODE       */
@RF00708 L     @07,@PC00005                                        0717
         SLR   @02,@02                                             0717
         IC    @02,IOPRETRN(,@07)                                  0717
         CR    BLMRC,@02                                           0717
         BNL   *+6
         LR    BLMRC,@02                                           0717
*               END;                                               0718
*             ELSE                  /* IO WAS SUCCESSFUL     @Z67SP00*/
*               DO;                 /*                       @Z67SP00*/
         B     @RC00706                                            0719
@RF00706 DS    0H                                                  0720
*                 IF IOPRETRN=ZERO THEN/* NO ERROR?                  */
         L     @07,@PC00005                                        0720
         CLI   IOPRETRN(@07),0                                     0720
         BNE   @RF00720                                            0720
*                   DO;             /* YES,                          */
*                     CALL BLD1ENT(HMASMIOP,/* SCL ENTRIES FOR ++VERS*/
*                         MASS,BLMCAND,BLMREDO);                   0722
         MVC   @AL00001+4(12),@AL00722                             0722
         ST    @07,@AL00001                                        0722
         LA    @01,@AL00001                                        0722
         BAL   @14,BLD1ENT                                         0722
*                     RFY                                          0723
*                       RTNCODE RSTD;                              0723
*                     BLMRC=MAX(BLMRC,RTNCODE);/* SAVE BUILD RETURN
*                                      CODE                          */
         CR    BLMRC,RTNCODE                                       0724
         BNL   *+6
         LR    BLMRC,RTNCODE                                       0724
*                     RFY                                          0725
*                       RTNCODE UNRSTD;                            0725
*                   END;                                           0726
*               END;                                               0727
*           END;                                                   0728
*       END;                                                       0729
*     ELSE                                                         0730
*       ;                                                          0730
@RF00682 DS    0H                                                  0731
*   END;                            /* END OF PROCESS DIR. ENTRIES   */
@RC00682 DS    0H                                                  0731
@DE00619 CH    BLMRC,@CH00033                                      0731
         BNL   @DC00619                                            0731
         TM    BLM1EOF,B'00110000'                                 0731
         BNO   @DL00619                                            0731
@DC00619 DS    0H                                                  0732
*   RETURN CODE(BLMRC);             /*                               */
         LR    @15,BLMRC                                           0732
         L     @14,@SA00005                                        0732
         LM    @00,@12,@SA00005+8                                  0732
         BR    @14                                                 0732
*   RFY                                                            0733
*     HMASMIOP BASED;                                              0733
*                                                                  0734
*   /*****************************************************************/
*   /*                                                               */
*   /* BLMGET -                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0734
*BLMGET:                                                           0734
*   PROC(GLMGIOP);                                                 0734
BLMGET   STM   @14,@12,@SA00006                                    0734
         MVC   @PC00006(4),0(@01)                                  0734
*   DCL                                                            0735
*     GLMGIOP CHAR(*);              /* FIXED IOP FOR GET NEXT        */
*   DCL                                                            0736
*     BLMGETRC FIXED(15);           /* RETURN CODE                   */
*   RFY                                                            0737
*     HMASMIOP BASED(ADDR(GLMGIOP));                               0737
*   BLMGETRC=ZERO;                  /* CLEAR THE RETURN CODE         */
         SLR   BLMGETRC,BLMGETRC                                   0738
*   IOPFUNCT=IOPGETN;                                              0739
         L     @03,@PC00006                                        0739
         MVI   IOPFUNCT(@03),X'0A'                                 0739
*   IOPTYPE=IOPSMD;                                                0740
         MVI   IOPTYPE(@03),X'0B'                                  0740
*   CALL HMASMIO(HMASMIOP);                                        0741
         ST    @03,@AL00001                                        0741
         L     @15,@CV01228                                        0741
         LA    @01,@AL00001                                        0741
         BALR  @14,@15                                             0741
*   BLMGETRC=IOPRETRN;              /*                               */
         L     @15,@PC00006                                        0742
         SLR   BLMGETRC,BLMGETRC                                   0742
         IC    BLMGETRC,IOPRETRN(,@15)                             0742
*   RETURN CODE(BLMGETRC);          /* RETURN WITH THE RETURN CODE   */
         LR    @15,BLMGETRC                                        0743
         L     @14,@SA00006                                        0743
         LM    @00,@12,@SA00006+8                                  0743
         BR    @14                                                 0743
*   END BLMGET;                     /*                               */
*                                                                  0745
*/* FUNCTION       DS1   DS2   SELECT DS                             */
*/* APPLY          PTS   CDS   PTS                                   */
*/* ACCEPT         CDS   ACDS  PTS                                   */
*/* ACCEPT NOAPPLY PTS   CDS   PTS                                   */
*/* RESTORE        CDS   ACDS  CDS                                   */
*                                                                  0745
*   /*****************************************************************/
*   /*                                                               */
*   /* DS1READ - READ FROM DATA SET 1 TO GET A 'VALID' SYSMOD ENTRY  */
*   /* TO COMPARE WITH THE CONTENTS OF DS2                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0745
*DS1READ:                                                          0745
*   PROC;                           /*                               */
DS1READ  STM   @14,@12,@SA00007                                    0745
*   DCL                                                            0746
*     DS1RC FIXED(15);              /*                               */
*   DCL                                                            0747
*     1 DS1FLAGS,                   /* LOCAL CONTROL FLAGS           */
*      2 DS1VALID BIT(1),           /* SYSMOD IS VALID FOR PROCESSING*/
*      2 * BIT(7);                  /* UNUSED                        */
*   RFY                                                            0748
*     HMASMIOP BASED(BLM1IOP@);                                    0748
*   DS1RC=ZERO;                     /*                               */
         SLR   DS1RC,DS1RC                                         0749
*   DS1FLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         MVI   DS1FLAGS,X'00'                                      0750
*   IF(BLM1SMD=OFF                  /* SHOULD A RECORD BE GOTTEN     */
*       ×BLMGET1=ON) THEN           /* FROM DS1?                     */
         TM    BLMGET1,B'00001000'                                 0751
         BNZ   @RT00751                                            0751
         TM    BLM1SMD,B'10000000'                                 0751
         BO    @RF00751                                            0751
@RT00751 DS    0H                                                  0752
*     DO;                           /*                               */
*       DO WHILE DS1VALID=OFF       /*                               */
*             &BLM1EOF=OFF          /*                               */
*             &DS1RC<STOPFUNC;                                     0753
         B     @DE00753                                            0753
@DL00753 DS    0H                                                  0754
*         CALL BLMGET(HMASMIOP);    /* GET NEXT DIRECTORY ENTRY      */
         ST    BLM1IOP@,@AL00001                                   0754
         LA    @01,@AL00001                                        0754
         BAL   @14,BLMGET                                          0754
*         RFY                                                      0755
*           RTNCODE RSTD;           /* FROM DS1                      */
*         IF RTNCODE>IOPEOF THEN    /* IO ERROR?                     */
         CH    RTNCODE,@CH00037                                    0756
         BNH   @RF00756                                            0756
*           DO;                                                    0757
*             DS1RC=MAX(DS1RC,RTNCODE);/* SET RETURN CODE            */
         CR    DS1RC,RTNCODE                                       0758
         BNL   *+6
         LR    DS1RC,RTNCODE                                       0758
*           END;                    /*                               */
*         IF RTNCODE=IOPEOF THEN    /* END OF FILE?                  */
@RF00756 CH    RTNCODE,@CH00037                                    0760
         BNE   @RF00760                                            0760
*           DO;                                                    0761
*             BLM1EOF=ON;           /* EOF FLAGGED                   */
         OI    BLM1EOF,B'00100000'                                 0762
*           END;                                                   0763
*         IF RTNCODE=ZERO THEN      /* ALL IS WELL?                  */
@RF00760 LTR   RTNCODE,RTNCODE                                     0764
         BNZ   @RF00764                                            0764
*           DO;                     /* YES,                          */
*             RFY                                                  0766
*               RTNCODE UNRSTD;                                    0766
*             IF BLM1SMD=OFF THEN   /* 1ST SYSMOD NOT FOUND ON DS1?  */
         TM    BLM1SMD,B'10000000'                                 0767
         BNZ   @RF00767                                            0767
*               DO;                                                0768
*                 IF BLM1IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?*/
         CLI   IOPTYPE(BLM1IOP@),11                                0769
         BNE   @RF00769                                            0769
*                   DO;                                            0770
*                     BLM1SMD=ON;   /* 1ST DS1 SYSMOD FOUND          */
         OI    BLM1SMD,B'10000000'                                 0771
*                   END;                                           0772
*               END;                                               0773
*             ELSE                  /* 1ST SYSMOD ALREADY FOUND      */
*               DO;                                                0774
         B     @RC00767                                            0774
@RF00767 DS    0H                                                  0775
*                 IF BLM1IOP@->IOPTYPE^=IOPSMD THEN/* NOT A SYSMOD?  */
         CLI   IOPTYPE(BLM1IOP@),11                                0775
         BE    @RF00775                                            0775
*                   DO;                                            0776
*                     BLM1EOF=ON;   /* END OF SYSMODS                */
         OI    BLM1EOF,B'00100000'                                 0777
*                   END;                                           0778
*               END;                                               0779
@RF00775 DS    0H                                                  0780
*             IF BLM1IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?    */
@RC00767 CLI   IOPTYPE(BLM1IOP@),11                                0780
         BNE   @RF00780                                            0780
*               DO;                                                0781
*                 IF IOPERROR^=ON   /* NOT IN ERROR ....             */
*                     &IOPSBYP^=ON  /* ... NOT SUP'ED ...            */
*                     &IOPDBYP^=ON THEN/* ... AND NOT DELETED?       */
         TM    IOPERROR(BLM1IOP@),B'00010000'                      0782
         BO    @RF00782                                            0782
         TM    IOPSBYP(BLM1IOP@),B'11000000'                       0782
         BNZ   @RF00782                                            0782
*                   DO;                                            0783
*                                                                  0783
*                     /***********************************************/
*                     /*                                             */
*                     /* ???? RESTORE ????                   @Z67SP00*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0784
*                     DS1VALID=ON;  /* VALID DS1 SYSMOD FOUND        */
         OI    DS1VALID,B'10000000'                                0784
*                   END;                                           0785
*               END;                                               0786
@RF00782 DS    0H                                                  0787
*           END;                                                   0787
@RF00780 DS    0H                                                  0788
*       END;                                                       0788
@RF00764 DS    0H                                                  0788
@DE00753 TM    DS1VALID,B'10000000'                                0788
         BNZ   @DC00753                                            0788
         TM    BLM1EOF,B'00100000'                                 0788
         BNZ   @DC00753                                            0788
         CH    DS1RC,@CH00033                                      0788
         BL    @DL00753                                            0788
@DC00753 DS    0H                                                  0789
*     END;                          /*                               */
*   ELSE                                                           0790
*     ;                             /* DONT GET DIR. ENTRY FROM DS1  */
@RF00751 DS    0H                                                  0791
*   RETURN CODE(DS1RC);             /*                               */
         LR    @15,DS1RC                                           0791
         L     @14,@SA00007                                        0791
         LM    @00,@12,@SA00007+8                                  0791
         BR    @14                                                 0791
*   RFY                                                            0792
*     HMASMIOP BASED;                                              0792
*   END DS1READ;                    /*                               */
*                                                                  0794
*   /*****************************************************************/
*   /*                                                               */
*   /* DS2READ - GET NEXT DIRECTORY ENTRY FROM DS2                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0794
*DS2READ:                                                          0794
*   PROC;                           /*                               */
DS2READ  STM   @14,@12,@SA00008                                    0794
*   DCL                                                            0795
*     DS2RC FIXED(15);                                             0795
*   DCL                                                            0796
*     1 DS2FLAGS,                   /* LOCAL CONTROL FLAGS           */
*      2 DS2VALID BIT(1),           /* DS2 ENTRY IS VALID TO BE    0796
*                                      PROCESSED                     */
*      2 * BIT(7);                  /* UNUSED                        */
*   RFY                                                            0797
*     HMASMIOP BASED(BLM2IOP@);                                    0797
*   DS2RC=ZERO;                     /*                               */
         SLR   DS2RC,DS2RC                                         0798
*   DS2FLAGS=''B;                   /* CLEAR CONTROL FLAGS           */
         MVI   DS2FLAGS,X'00'                                      0799
*   IF(BLM2SMD=OFF                  /* SHOULD A RECORD BE GOTTEN     */
*       ×BLMGET2=ON) THEN           /* FROM DS2?                     */
         TM    BLMGET2,B'00000100'                                 0800
         BNZ   @RT00800                                            0800
         TM    BLM2SMD,B'01000000'                                 0800
         BO    @RF00800                                            0800
@RT00800 DS    0H                                                  0801
*     DO;                                                          0801
*       DO WHILE DS2VALID=OFF       /*                               */
*             &BLM2EOF=OFF          /*                               */
*             &DS2RC<STOPFUNC;      /*                               */
         B     @DE00802                                            0802
@DL00802 DS    0H                                                  0803
*         CALL BLMGET(HMASMIOP);    /* GET DIR. ENTRY FROM DS1       */
         ST    BLM2IOP@,@AL00001                                   0803
         LA    @01,@AL00001                                        0803
         BAL   @14,BLMGET                                          0803
*         RFY                                                      0804
*           RTNCODE RSTD;                                          0804
*         IF RTNCODE>IOPEOF THEN    /* IO ERROR?                     */
         CH    RTNCODE,@CH00037                                    0805
         BNH   @RF00805                                            0805
*           DO;                                                    0806
*             DS2RC=MAX(DS2RC,RTNCODE);/* SET RETURN CODE            */
         CR    DS2RC,RTNCODE                                       0807
         BNL   *+6
         LR    DS2RC,RTNCODE                                       0807
*           END;                    /*                               */
*         IF RTNCODE=IOPEOF THEN    /* END OF FILE?                  */
@RF00805 CH    RTNCODE,@CH00037                                    0809
         BNE   @RF00809                                            0809
*           DO;                                                    0810
*             BLM2EOF=ON;           /* END OF FILE FOUND             */
         OI    BLM2EOF,B'00010000'                                 0811
*           END;                                                   0812
*         IF RTNCODE=ZERO THEN      /* ALL IS WELL?                  */
@RF00809 LTR   RTNCODE,RTNCODE                                     0813
         BNZ   @RF00813                                            0813
*           DO;                     /* YES,                          */
*             RFY                                                  0815
*               RTNCODE UNRSTD;                                    0815
*             IF BLM2SMD=OFF THEN   /* 1ST SYSMOD NOT FOUND ON DS2?  */
         TM    BLM2SMD,B'01000000'                                 0816
         BNZ   @RF00816                                            0816
*               DO;                                                0817
*                 IF BLM2IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?*/
         CLI   IOPTYPE(BLM2IOP@),11                                0818
         BNE   @RF00818                                            0818
*                   DO;                                            0819
*                     BLM2SMD=ON;   /* 1ST DS2 SYSMOD FOUND          */
         OI    BLM2SMD,B'01000000'                                 0820
*                   END;                                           0821
*                 ELSE                                             0822
*                   ;               /* NOT A SYSMOD TYPE             */
@RF00818 DS    0H                                                  0823
*               END;                                               0823
*             ELSE                  /* 1ST SYSMOD ALREADY FOUND      */
*               DO;                                                0824
         B     @RC00816                                            0824
@RF00816 DS    0H                                                  0825
*                 IF BLM2IOP@->IOPTYPE^=IOPSMD THEN/* NOT A SYSMOD?  */
         CLI   IOPTYPE(BLM2IOP@),11                                0825
         BE    @RF00825                                            0825
*                   DO;                                            0826
*                     BLM2EOF=ON;   /* END OF SYSMODS                */
         OI    BLM2EOF,B'00010000'                                 0827
*                   END;                                           0828
*               END;                                               0829
@RF00825 DS    0H                                                  0830
*             IF BLM2IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?    */
@RC00816 CLI   IOPTYPE(BLM2IOP@),11                                0830
         BNE   @RF00830                                            0830
*               DO;                                                0831
*                 IF BLM2IOP@->IOPERROR=OFF THEN/* NOT IN ERROR      */
         TM    IOPERROR(BLM2IOP@),B'00010000'                      0832
         BNZ   @RF00832                                            0832
*                   DO;                                            0833
*                     DS2VALID=ON;  /* VALID ENTRY FOUND             */
         OI    DS2VALID,B'10000000'                                0834
*                   END;                                           0835
*               END;                                               0836
@RF00832 DS    0H                                                  0837
*           END;                                                   0837
@RF00830 DS    0H                                                  0838
*       END;                                                       0838
@RF00813 DS    0H                                                  0838
@DE00802 TM    DS2VALID,B'10000000'                                0838
         BNZ   @DC00802                                            0838
         TM    BLM2EOF,B'00010000'                                 0838
         BNZ   @DC00802                                            0838
         CH    DS2RC,@CH00033                                      0838
         BL    @DL00802                                            0838
@DC00802 DS    0H                                                  0839
*     END;                                                         0839
*   RETURN CODE(DS2RC);             /*                               */
@RF00800 LR    @15,DS2RC                                           0840
         L     @14,@SA00008                                        0840
         LM    @00,@12,@SA00008+8                                  0840
         BR    @14                                                 0840
*   RFY                                                            0841
*     HMASMIOP BASED;                                              0841
*   END DS2READ;                    /*                               */
*   END BLDMASSL;                   /*                               */
*                                                                  0844
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCFM - ISSUE SMP FUNCTION HALTED BECAUSE APPLICABLE FUNCTION*/
*   /* SYSMOD FAILED                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0844
*FUNCFM:                                                           0844
*   PROC(FFMSMD);                                                  0844
FUNCFM   STM   @14,@12,@SA00009                                    0844
         MVC   @PC00009(4),0(@01)                                  0844
*   DCL                                                            0845
*     FFMSMD CHAR(7);               /* FUNCTION NAME THAT FAILED     */
*                                                                  0845
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE MESSAGE 'HMA370I XXXXXXXX PROCESSING TERMINATED BECAUSE */
*   /* FUNCTION SYSMOD XXXXXXX FAILED'                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0846
*   DO;                             /* HMASMPMG M1(HMA370I)TYPE(SEV)V
*                                      AR(TBLXFUNC,FFMSMD)TARGET(SYSO
*                                      UT,LOG)                       */
*     HMASMMGP=HMASMMGP&&HMASMMGP;  /* SET PARMS TO ZEROS            */
         XC    HMASMMGP(28),HMASMMGP                               0847
*     MGPMGNO1=HMA370I;             /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01235                                0848
*     MGPTYPE=MGPSEV;               /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'04'                                       0849
*     MGPPRINT='1'B;                /* SET TARGET FLAG               */
*     MGPHLDS='1'B;                 /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0851
*     MGPVARPT(1)=ADDR(TBLXFUNC);   /* SET VARIABLE PTR              */
         L     @15,@PC00001                                        0852
         LA    @15,TBLXFUNC(,@15)                                  0852
         ST    @15,MGPVARPT                                        0852
*     MGPVARPT(2)=ADDR(FFMSMD);     /* SET VARIABLE PTR              */
         L     @15,@PC00009                                        0853
         ST    @15,MGPVARPT+4                                      0853
*     CALL HMASMMSG(HMASMMGP);      /* HAVE MESSAGE ISSUED           */
         L     @15,@CV01229                                        0854
         LA    @01,@AL00854                                        0854
         BALR  @14,@15                                             0854
*   END;                            /*                               */
*   RETURN CODE(ZERO);                                             0856
         SLR   @15,@15                                             0856
         L     @14,@SA00009                                        0856
         LM    @00,@12,@SA00009+8                                  0856
         BR    @14                                                 0856
*   END FUNCFM;                                                    0857
*   END HMASMTPL                    /*                               */
*                                                                  0858
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*                                                                  0858
*       ;                                                          0858
@DATA    DS    0H
@CH00063 DC    H'1'
@CH00037 DC    H'4'
@CH00055 DC    H'8'
@CH00476 DC    H'9'
@CH00033 DC    H'12'
@CH00760 DC    H'66'
@CH01244 DC    H'99'
@CH00348 DC    H'100'
@CH00782 DC    H'161'
@CH00792 DC    H'166'
@CH01235 DC    H'171'
@CH01237 DC    H'180'
@CH01239 DC    H'181'
@CH01241 DC    H'202'
@CH00609 DC    H'255'
         DS    0F
@AL00282 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00303 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00335 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00351 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00367 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00481 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00854 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
@AL00389 DC    A(@CC01261)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CC01265)
         DC    A(BLD1REDO)
@AL00722 DC    A(@CC01263)             LIST WITH   3 ARGUMENT(S)
         DC    A(BLMCAND)
         DC    A(BLMREDO)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    15F
@PC00003 DS    1F
@SA00005 DS    15F
@PC00005 DS    1F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00006 DS    0F
@PC00006 EQU   @SA00006+60
@SA00009 DS    0F
@PC00009 EQU   @SA00009+60
@SA00004 DS    0F
@PC00004 EQU   @SA00004+60
         DS    19F
@AL00001 DS    4A
@TF00001 DS    F
@TF00002 DS    F
         DS    0F
@CF01454 DC    F'-8'
@CV01228 DC    V(HMASMIO)
@CV01229 DC    V(HMASMMSG)
@CV01230 DC    V(HMASMGTA)
@CV01231 DC    V(HMASMTSB)
         DS    0D
BLDDSIDS DS    FL1
BLDDSID1 DS    FL1
BLDDSID2 DS    FL1
@CC01259 DC    C'       '
@CC01261 DC    C'S'
@CC01263 DC    C'M'
@CC01265 DC    C'C'
         DS    CL3
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL28
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00118 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00119 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL16
         ORG   MGPVAR
MGPVARPT DS    4A
         ORG   HMASMMGP+28
PATCHTPL DS    CL80
         ORG   PATCHTPL
@NM00142 DC    80X'FF'
         ORG   PATCHTPL+80
BLDFLAGS DS    CL3
         ORG   BLDFLAGS
BLDLFLGS DS    BL1
         ORG   BLDLFLGS
BLDL1    DS    BL1
BLDL2    EQU   BLDLFLGS+0
BLDL3    EQU   BLDLFLGS+0
BLDL4    EQU   BLDLFLGS+0
BLDL5    EQU   BLDLFLGS+0
@NM00143 EQU   BLDLFLGS+0
         ORG   BLDFLAGS+1
BLDOPTS  DS    BL1
         ORG   BLDOPTS
BLDSLCT  DS    BL1
BLDMASS  EQU   BLDOPTS+0
BLDEXEC  EQU   BLDOPTS+0
BLDMCAND EQU   BLDOPTS+0
@NM00144 EQU   BLDOPTS+0
         ORG   BLDFLAGS+2
BLDCNTLF DS    BL1
         ORG   BLDCNTLF
BLDSEOF  DS    BL1
@NM00145 EQU   BLDCNTLF+0
         ORG   BLDFLAGS+3
@NM00146 DS    0C
         ORG   BLDFLAGS+3
TPLIOPF  DS    CL105
BLD1REDO DS    CL1
BLD1FLGS DS    CL1
         ORG   BLD1FLGS
BLD1FND  DS    BL1
@NM00147 EQU   BLD1FLGS+0
         ORG   BLD1FLGS+1
BL1FLAGS DS    CL1
         ORG   BL1FLAGS
BL1SKIP  DS    BL1
BL1IGNOR EQU   BL1FLAGS+0
@NM00148 EQU   BL1FLAGS+0
         ORG   BL1FLAGS+1
BLMFLAGS DS    CL2
         ORG   BLMFLAGS
BLM1SMD  DS    BL1
BLM2SMD  EQU   BLMFLAGS+0
BLM1EOF  EQU   BLMFLAGS+0
BLM2EOF  EQU   BLMFLAGS+0
BLMGET1  EQU   BLMFLAGS+0
BLMGET2  EQU   BLMFLAGS+0
BLMENT1  EQU   BLMFLAGS+0
BLMENT2  EQU   BLMFLAGS+0
@NM00149 DS    BL1
         ORG   BLMFLAGS+2
BLMCAND  DS    CL1
BLMREDO  DS    CL1
DS1FLAGS DS    CL1
         ORG   DS1FLAGS
DS1VALID DS    BL1
@NM00150 EQU   DS1FLAGS+0
         ORG   DS1FLAGS+1
DS2FLAGS DS    CL1
         ORG   DS2FLAGS
DS2VALID DS    BL1
@NM00151 EQU   DS2FLAGS+0
         ORG   DS2FLAGS+1
TXTTYPEA DC    CL8'USERMOD'
         DC    CL8'APAR'
         DC    CL8'PTF'
         DC    CL8'FUNCTION'
TXTKWRDA DC    CL8'USERMODS'
         DC    CL8'APARS'
         DC    CL8'********'
         DC    CL8'********'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
DS2RC    EQU   @03
DS1RC    EQU   @03
BLMGETRC EQU   @02
BLM2IOP@ EQU   @05
BLM1IOP@ EQU   @04
BLMRC    EQU   @03
BL1NDX1  EQU   @05
BL1FMID@ EQU   @07
BL1VER#  EQU   @04
BL1RC    EQU   @03
BLD1RC   EQU   @03
BLDELST@ EQU   @02
BLDSLST@ EQU   @06
TPLRC    EQU   @03
CCAPTR   EQU   @11
RTNCODE  EQU   @15
RTNREG   EQU   @14
TBLXOPTS EQU   0
TBLFLAGS EQU   TBLXOPTS+8
TBLFLG1  EQU   TBLFLAGS
TBLNOAPP EQU   TBLFLG1
TBLAPAR  EQU   TBLFLG1
TBLUSER  EQU   TBLFLG1
TBLFLG2  EQU   TBLFLAGS+2
TBLSEL   EQU   TBLFLG2
TBLEXC   EQU   TBLFLG2
TBLGROUP EQU   TBLFLG2
TBLFLG3  EQU   TBLFLAGS+3
TBLFLG4  EQU   TBLFLAGS+5
TBLFLG5  EQU   TBLFLAGS+7
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00023 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAAPPLY EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFMID  EQU   HMASMCCA+291
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCADSIDA EQU   0
CCATYPEA EQU   0
CCABLDLA EQU   0
@NM00039 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00041 EQU   CCABLDLL
CCALKDRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00047+20
@NM00049 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00049+20
@NM00051 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00051+20
@NM00053 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00053+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00057 EQU   HMASMIOP+12
@NM00058 EQU   @NM00057
IOPDDNAM EQU   HMASMIOP+24
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
@NM00100 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
HMASMSET EQU   0
SELSTENT EQU   HMASMSET
SELSTFLG EQU   SELSTENT
SESMD    EQU   SELSTFLG
SENAME   EQU   SELSTENT+2
SESMDNO  EQU   SENAME
SEFLAGS  EQU   HMASMSET+10
SEFLAG2  EQU   HMASMSET+11
SEFLAG2A EQU   SEFLAG2
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
SCLMAP   EQU   0
SCLKEY   EQU   SCLMAP
SCLISTNO EQU   SCLKEY
SCLSMD   EQU   SCLKEY+1
SCLFMID  EQU   SCLKEY+8
SCLDATA  EQU   SCLMAP+15
SCLSTAT  EQU   SCLDATA
SCLDELP  EQU   SCLSTAT
SCLSELST EQU   SCLSTAT
SCLCAND  EQU   SCLSTAT
SCLREDO  EQU   SCLSTAT
SCLVERNO EQU   SCLDATA+1
TSLPARMS EQU   0
TSLPMLAD EQU   TSLPARMS+4
TSLFUNCT EQU   TSLPARMS+8
TSLICTSR EQU   0
TSLIOPTF EQU   TSLICTSR+7
TSLICTF  EQU   TSLICTSR+12
TSLLSTSR EQU   0
TSLLOPTF EQU   TSLLSTSR+7
TSLGET   EQU   0
TSLGOPTF EQU   TSLGET+7
TSLSICDS EQU   0
TSLSOPTF EQU   TSLSICDS+7
TSLSICTF EQU   TSLSICDS+16
TSLSCDSF EQU   TSLSICDS+18
TSLENTSR EQU   0
TSLETYPE EQU   TSLENTSR
TSLEVER# EQU   TSLENTSR+1
TSLEOPTF EQU   TSLENTSR+2
TSLEBGNP EQU   TSLENTSR+8
TSLEFNDP EQU   TSLENTSR+12
TSLMFUNC EQU   0
TSLRELM  EQU   0
BASEDSMD EQU   0
BLMSMD1  EQU   0
BLMSMD2  EQU   0
TBLXPARM EQU   0
TBLXINDX EQU   TBLXPARM+4
TBLXIOPF EQU   TBLXPARM+20
TBLXSEGT EQU   TBLXPARM+24
TBLXTBL  EQU   TBLXPARM+28
TBLXSREL EQU   TBLXPARM+48
TBLXSCGT EQU   TBLXPARM+52
TBLXFUNC EQU   TBLXPARM+64
TBLXFUND EQU   TBLXPARM+72
TBLXFLG1 EQU   TBLXPARM+80
TBLXTSLP EQU   TBLXPARM+84
TBLXRC   EQU   TBLXPARM+92
BLD1IOP  EQU   0
BL1EIOP  EQU   0
BL1MODE  EQU   0
BL1CAND  EQU   0
BL1REDO  EQU   0
BLMIOP   EQU   0
GLMGIOP  EQU   0
FFMSMD   EQU   0
IOPUDATA EQU   IOPEND
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPTYPE EQU   IOPPTFDR+1
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPRES   EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPSBYP  EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPPTFFX EQU   IOPPTFNT+24
@NM00072 EQU   IOPPTFFX
@NM00073 EQU   @NM00072
IOPPDTES EQU   IOPPTFFX+41
@NM00076 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPPTFND EQU   IOPPMODS
IOPPIND  EQU   IOPPNTRY+8
IOPENTNT EQU   IOPUDATA+104
IOPENTST EQU   IOPENTNT+7
IOPSRLNT EQU   IOPUDATA+104
IOPSRLNM EQU   IOPSRLNT
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
ICTENDIX EQU   ICTENDCH
ICTENDNT EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00089 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00088 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00087 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00086 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00085 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00084 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00083 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00082 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00081 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00080 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00079 EQU   IOPSRLNT+4
@NM00078 EQU   IOPENTNT+8
IOPENTNM EQU   IOPENTNT
IOPPFMID EQU   IOPPTFFX+73
@NM00077 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00076+3
IOPRECD  EQU   @NM00076
@NM00075 EQU   IOPPTFFX+8
@NM00074 EQU   @NM00072+7
IOPPRELN EQU   @NM00073
@NM00071 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00070 EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00069 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00068 EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
@NM00067 EQU   IOPPTFDR
IOPPTMAX EQU   IOPCDMAX
@NM00066 EQU   IOPSCMAP+11
@NM00065 EQU   IOPSCMAP+8
@NM00064 EQU   IOPSCMAP
TBLXEND0 EQU   TBLXPARM+124
@NM00007 EQU   TBLXPARM+108
TBLXIOP3 EQU   TBLXPARM+104
TBLXD2GT EQU   TBLXPARM+100
TBLXDLGT EQU   TBLXPARM+96
@NM00006 EQU   TBLXRC+3
TBLXIRC  EQU   TBLXRC+2
TBLXLRC  EQU   TBLXRC+1
TBLXTRC  EQU   TBLXRC
TBLXIBGN EQU   TBLXPARM+88
@NM00005 EQU   TBLXPARM+83
@NM00004 EQU   TBLXPARM+82
@NM00003 EQU   TBLXPARM+81
@NM00002 EQU   TBLXFLG1
TBLXTCRC EQU   TBLXFLG1
@NM00001 EQU   TBLXPARM+62
TBLXCRQI EQU   TBLXPARM+61
TBLXCDSI EQU   TBLXPARM+60
TBLXLMGT EQU   TBLXPARM+56
TBLXASGT EQU   TBLXPARM+44
TBLXIFGT EQU   TBLXPARM+40
TBLXNULL EQU   TBLXPARM+36
TBLXTOP  EQU   TBLXPARM+32
TBLXIOP2 EQU   TBLXPARM+16
TBLXEND  EQU   TBLXINDX+8
TBLXSTRT EQU   TBLXINDX+4
TBLXCUR  EQU   TBLXINDX
TBLXHDR  EQU   TBLXPARM
TSLRRTNP EQU   TSLRELM+12
TSLRAPTR EQU   TSLRELM+8
@NM00141 EQU   TSLRELM+7
TSLRSMD  EQU   TSLRELM
TSLMSMD  EQU   TSLMFUNC+1
TSLMTYPE EQU   TSLMFUNC
TSLENMEP EQU   TSLENTSR+4
@NM00140 EQU   TSLENTSR+3
@NM00139 EQU   TSLEOPTF
TSLEONXT EQU   TSLEOPTF
@NM00138 EQU   TSLSICDS+19
TSLSDUM  EQU   TSLSCDSF
TSLSCERR EQU   TSLSCDSF
@NM00137 EQU   TSLSCDSF
@NM00136 EQU   TSLSCDSF
TSLSCDEL EQU   TSLSCDSF
TSLSCSUP EQU   TSLSCDSF
TSLSCOK  EQU   TSLSCDSF
TSLSCFND EQU   TSLSCDSF
@NM00135 EQU   TSLSICDS+17
TSLSISLS EQU   TSLSICTF
TSLSINOG EQU   TSLSICTF
TSLSIDLI EQU   TSLSICTF
TSLSIDLE EQU   TSLSICTF
TSLSIDEL EQU   TSLSICTF
TSLSISUP EQU   TSLSICTF
TSLSIOK  EQU   TSLSICTF
TSLSIFND EQU   TSLSICTF
TSLSIOPP EQU   TSLSICDS+12
TSLSICTP EQU   TSLSICDS+8
@NM00134 EQU   TSLSOPTF
TSLSOXTD EQU   TSLSOPTF
TSLSOMSG EQU   TSLSOPTF
TSLSOALL EQU   TSLSOPTF
TSLSOCDS EQU   TSLSOPTF
TSLSOICT EQU   TSLSOPTF
TSLSSMD  EQU   TSLSICDS
TSLGDSID EQU   TSLGET+12
TSLGIOPP EQU   TSLGET+8
@NM00133 EQU   TSLGOPTF
TSLGOXTD EQU   TSLGOPTF
TSLGOMSG EQU   TSLGOPTF
@NM00132 EQU   TSLGOPTF
@NM00131 EQU   TSLGOPTF
@NM00130 EQU   TSLGOPTF
TSLGSMD  EQU   TSLGET
TSLLRTNP EQU   TSLLSTSR+12
TSLLOFST EQU   TSLLSTSR+8
@NM00129 EQU   TSLLOPTF
TSLLONXT EQU   TSLLOPTF
TSLLSMD  EQU   TSLLSTSR
@NM00128 EQU   TSLICTSR+13
@NM00127 EQU   TSLICTF
TSLINOG  EQU   TSLICTF
TSLIDLI  EQU   TSLICTF
TSLIDLE  EQU   TSLICTF
TSLIDEL  EQU   TSLICTF
TSLISUP  EQU   TSLICTF
TSLIOK   EQU   TSLICTF
TSLIFND  EQU   TSLICTF
TSLICTP  EQU   TSLICTSR+8
@NM00126 EQU   TSLIOPTF
TSLIONXT EQU   TSLIOPTF
TSLISMD  EQU   TSLICTSR
TSLRETRN EQU   TSLPARMS+9
TSLTBLXP EQU   TSLPARMS
SCLEND   EQU   SCLDATA+2
@NM00125 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00124 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPWKAD  EQU   HMASMGTP+8
GTPKEYLN EQU   HMASMGTP+6
GTPRCDLN EQU   HMASMGTP+4
@NM00123 EQU   HMASMGTP+2
SEFLAG2H EQU   SEFLAG2
SEFLAG2G EQU   SEFLAG2
SEFLAG2F EQU   SEFLAG2
SEFLAG2E EQU   SEFLAG2
SEFLAG2D EQU   SEFLAG2
SEFLAG2C EQU   SEFLAG2
SEFLAG2B EQU   SEFLAG2
SEFOUND  EQU   SEFLAGS
@NM00122 EQU   SEFLAGS
SEFMID   EQU   SEFLAGS
SENOJCL  EQU   SEFLAGS
SEEXCLUD EQU   SEFLAGS
SESELECT EQU   SEFLAGS
SEGROUP  EQU   SEFLAGS
@NM00121 EQU   SENAME+7
SEPTFNO  EQU   SESMDNO
SESYS    EQU   SELSTFLG+1
SEFMD    EQU   SELSTFLG+1
SEASM    EQU   SELSTFLG+1
SELMD    EQU   SELSTFLG+1
SEMAC    EQU   SELSTFLG+1
SEMOD    EQU   SELSTFLG+1
SEDLB    EQU   SELSTFLG+1
SESRC    EQU   SELSTFLG+1
SEMCS    EQU   SELSTFLG
@NM00120 EQU   SELSTFLG
@NM00117 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00116 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00115 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00114 EQU   ICTCSRST
@NM00113 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00112 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00111 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00110 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00109 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00108 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00107 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00106 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00105 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00104 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00103 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
ICTIXP   EQU   ICTIXPF
@NM00102 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPFMID EQU   ICTPTF+22
ICTPSUPN EQU   ICTPTF+20
ICTPONUM EQU   ICTPTF+18
ICTPTYPE EQU   ICTPTF+17
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00101 EQU   @NM00100
ICTPRQBY EQU   @NM00100
ICTPRQOK EQU   @NM00100
ICTPRQCK EQU   @NM00100
@NM00099 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00098 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00097 EQU   ICTPFLG4
@NM00096 EQU   ICTPFLG4
@NM00095 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00094 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00093 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00092 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00091 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00090 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTPEND  EQU   ICTPTFS
@NM00063 EQU   IOPUSERL
@NM00062 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
IOPBUFAD EQU   HMASMIOP+52
@NM00061 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00060 EQU   @NM00057+10
IOPSEQNO EQU   @NM00057+8
@NM00059 EQU   @NM00058+7
IOPPTFNM EQU   @NM00058
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00056 EQU   CCABLDLM+2
@NM00055 EQU   CCABLDLM
CCAUPDPM EQU   @NM00053+24
@NM00054 EQU   @NM00053+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00053+12
CCAUPDTE EQU   @NM00053+8
CCAUPDNM EQU   @NM00053
CCASUPPM EQU   @NM00051+24
@NM00052 EQU   @NM00051+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00051+12
CCAIOSUP EQU   @NM00051+8
CCASUPNM EQU   @NM00051
CCAZAPPM EQU   @NM00049+24
@NM00050 EQU   @NM00049+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00049+12
CCASPZAP EQU   @NM00049+8
CCAZAPNM EQU   @NM00049
CCACOMPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00047+12
CCACOMRS EQU   @NM00047+8
CCACOMNM EQU   @NM00047
CCACPYPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00045+12
CCACOPY  EQU   @NM00045+8
CCACPYNM EQU   @NM00045
CCAASMPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00043+12
CCAASM   EQU   @NM00043+8
CCAASMNM EQU   @NM00043
CCALKDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00041+12
CCALKED  EQU   @NM00041+8
CCALKDNM EQU   @NM00041
CCAPGMPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCABPGRC EQU   @NM00039+20
CCABPGSP EQU   @NM00039+12
CCABPGAD EQU   @NM00039+8
CCABPGNM EQU   @NM00039
CCAEND   EQU   HMASMCCA+371
@NM00038 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00037 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00036 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00035 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00034 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00033 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00032 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00031 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00030 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00029 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00028 EQU   @NM00023+18
@NM00027 EQU   @NM00023+16
CCATBLPA EQU   @NM00023+12
@NM00026 EQU   @NM00023+8
@NM00025 EQU   @NM00023+4
@NM00024 EQU   @NM00023
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00022 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00021 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00020 EQU   CCAFBUFR+122
@NM00019 EQU   CCAFBUFR+120
@NM00018 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00017 EQU   CCAFBUFR+88
@NM00016 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00015 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00014 EQU   TBLFLG5
TBLICTOK EQU   TBLFLG5
@NM00013 EQU   TBLFLG4
TBLBPFM  EQU   TBLFLG4
@NM00012 EQU   TBLFLG4
TBLBPIRQ EQU   TBLFLG4
TBLBPREQ EQU   TBLFLG4
TBLBPPRE EQU   TBLFLG4
TBLBPID  EQU   TBLFLG4
@NM00011 EQU   TBLFLG3+1
TBLSTS   EQU   TBLFLG3
TBLMTS   EQU   TBLFLG3
TBLPTS   EQU   TBLFLG3
TBLACRQ  EQU   TBLFLG3
TBLCRQ   EQU   TBLFLG3
TBLSCDS  EQU   TBLFLG3
TBLACDS  EQU   TBLFLG3
TBLCDS   EQU   TBLFLG3
TBLMASS  EQU   TBLFLG2
@NM00010 EQU   TBLFLG2
TBLFMID  EQU   TBLFLG2
@NM00009 EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
TBLDISR  EQU   TBLFLG1+1
TBLDISN  EQU   TBLFLG1+1
TBLNOJCL EQU   TBLFLG1
TBLFLUSH EQU   TBLFLG1
TBLCOMP  EQU   TBLFLG1
TBLASSEM EQU   TBLFLG1
TBLCHECK EQU   TBLFLG1
@NM00008 EQU   TBLXOPTS+5
TBLNUCID EQU   TBLXOPTS+4
TBLJCLGT EQU   TBLXOPTS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00291 EQU   @RC00288
@RC00323 EQU   @RC00321
@RC00339 EQU   @RC00321
@RC00355 EQU   @RC00321
@RC00429 EQU   @RC00427
@RF00434 EQU   @RC00427
@RF00443 EQU   @RC00441
@RF00451 EQU   @RC00449
@RF00459 EQU   @RC00457
@RC00545 EQU   @RC00543
@RF00647 EQU   @RC00643
@RC00635 EQU   @RC00633
@RF00698 EQU   @RC00682
@RC00706 EQU   @RC00682
@RF00720 EQU   @RC00682
@RF00769 EQU   @RC00767
@RC00637 EQU   @RC00635
@ENDDATA EQU   *
         END   HMASMTPL,(C'PLS2208',0802,78334)

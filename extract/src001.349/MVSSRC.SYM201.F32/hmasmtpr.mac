         TITLE 'HMASMTPR - TABLE SELECT SYSMODS FOR RESTORE'
HMASMTPR CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMTPR  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @09,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@09                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0144
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMTPR << MAINLINE                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0144
*   TPRRC=ZERO;                     /* CLEAR THE RETURN CODE         */
         SLR   TPRRC,TPRRC                                         0144
*   TPRFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
*                                                                  0145
         MVI   TPRFLAGS,X'00'                                      0145
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE FOR PROCESSING                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0146
*   CALL TPRINIT;                                                  0146
         BAL   @14,TPRINIT                                         0146
*   RFY                                                            0147
*     RTNCODE RSTD;                                                0147
*   TPRRC=MAX(TPRRC,RTNCODE);       /* SAVE THE RETURN CODE          */
         CR    TPRRC,RTNCODE                                       0148
         BNL   *+6
         LR    TPRRC,RTNCODE                                       0148
*   RFY                                                            0149
*     RTNCODE UNRSTD;                                              0149
*                                                                  0149
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD DELTA1 AND DELTA2 LISTS DELTA1 CONSISTS OF ALL SYSMODS  */
*   /* THAT CAN BE RESTORED AND DELTA2 CONSISTS OF ALL SYSMODS ON THE*/
*   /* ACDS THAT CANNOT BE REFERENCED BY ELEMENTS IN THE RESTORE     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0150
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */
         CH    TPRRC,@CH00033                                      0150
         BNL   @RF00150                                            0150
*     DO;                           /* YES,                          */
*       CALL LSTBLD;                                               0152
         BAL   @14,LSTBLD                                          0152
*       RFY                                                        0153
*         RTNCODE RSTD;                                            0153
*       TPRRC=MAX(TPRRC,RTNCODE);   /* SAVE THE RETURN CODE          */
         CR    TPRRC,RTNCODE                                       0154
         BNL   *+6
         LR    TPRRC,RTNCODE                                       0154
*       RFY                                                        0155
*         RTNCODE UNRSTD;                                          0155
*     END;                                                         0156
*   ELSE                                                           0157
*     ;                             /* PREVIOUS ERROR                */
*                                                                  0157
@RF00150 DS    0H                                                  0158
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK SELECT LIST AGAINST THE ICT. ISSUE ERROR MESSAGES FOR   */
*   /* SYSMODS IN SELECT ARE NOT IN ICT OR HAD A MESSAGE ISSUED      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0158
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */
         CH    TPRRC,@CH00033                                      0158
         BNL   @RF00158                                            0158
*     DO;                           /* YES,                          */
*       CALL SELCHK;                                               0160
         BAL   @14,SELCHK                                          0160
*       RFY                                                        0161
*         RTNCODE RSTD;                                            0161
*       TPRRC=MAX(TPRRC,RTNCODE);   /* SAVE THE RETURN CODE          */
         CR    TPRRC,RTNCODE                                       0162
         BNL   *+6
         LR    TPRRC,RTNCODE                                       0162
*       RFY                                                        0163
*         RTNCODE UNRSTD;                                          0163
*     END;                                                         0164
*   ELSE                                                           0165
*     ;                             /* PREVIOUS ERROR                */
*                                                                  0165
@RF00158 DS    0H                                                  0166
*   /*****************************************************************/
*   /*                                                               */
*   /* MARK GROUP'ED SYSMODS AS CANDIDTATES                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0166
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */
         CH    TPRRC,@CH00033                                      0166
         BNL   @RF00166                                            0166
*     DO;                           /* YES,                          */
*       IF TBLGROUP=ON THEN         /* WAS GROUP SPECIFIED?          */
         L     @10,@PC00001                                        0168
         L     @10,TBLXTBL(,@10)                                   0168
         TM    TBLGROUP(@10),B'00100000'                           0168
         BNO   @RF00168                                            0168
*         DO;                       /* YES,                          */
*           CALL GROUP;                                            0170
         BAL   @14,GROUP                                           0170
*           RFY                                                    0171
*             RTNCODE RSTD;                                        0171
*           TPRRC=MAX(TPRRC,RTNCODE);/* SAVE THE RETURN CODE         */
         CR    TPRRC,RTNCODE                                       0172
         BNL   *+6
         LR    TPRRC,RTNCODE                                       0172
*           RFY                                                    0173
*             RTNCODE UNRSTD;                                      0173
*         END;                                                     0174
*       ELSE                                                       0175
*         ;                         /* GROUP WAS NOT SPECIFIED       */
@RF00168 DS    0H                                                  0176
*     END;                                                         0176
*   ELSE                                                           0177
*     ;                             /* PREVIOUS ERROR                */
*                                                                  0177
@RF00166 DS    0H                                                  0178
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THAT ALL MEMBERS OF THE "RESTORE GROUP" ARE OK          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0178
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */
         CH    TPRRC,@CH00033                                      0178
         BNL   @RF00178                                            0178
*     DO;                           /* YES,                          */
*       CALL REQCHK;                                               0180
         BAL   @14,REQCHK                                          0180
*       RFY                                                        0181
*         RTNCODE RSTD;                                            0181
*       TPRRC=MAX(TPRRC,RTNCODE);   /* SAVE THE RETURN CODE          */
         CR    TPRRC,RTNCODE                                       0182
         BNL   *+6
         LR    TPRRC,RTNCODE                                       0182
*       RFY                                                        0183
*         RTNCODE UNRSTD;                                          0183
*     END;                                                         0184
*   ELSE                                                           0185
*     ;                             /*                               */
@RF00178 DS    0H                                                  0186
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */
         CH    TPRRC,@CH00033                                      0186
         BNL   @RF00186                                            0186
*     DO;                           /* YES,                          */
*                                                                  0187
*       /*************************************************************/
*       /*                                                           */
*       /* ELIMINATE UNUSED PTF ENTRIES                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0188
*       CALL COMPRESS;                                             0188
         BAL   @14,COMPRESS                                        0188
*       RFY                                                        0189
*         RTNCODE RSTD;                                            0189
*       TPRRC=MAX(TPRRC,RTNCODE);   /* SAVE THE RETURN CODE          */
         CR    TPRRC,RTNCODE                                       0190
         BNL   *+6
         LR    TPRRC,RTNCODE                                       0190
*       RFY                                                        0191
*         RTNCODE UNRSTD;                                          0191
*     END;                                                         0192
*   ELSE                                                           0193
*     ;                             /*                               */
*                                                                  0193
@RF00186 DS    0H                                                  0194
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEANUP                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0194
*   CALL TPRCLEAN;                                                 0194
         BAL   @14,TPRCLEAN                                        0194
*   RFY                                                            0195
*     RTNCODE RSTD;                                                0195
*   TPRRC=MAX(TPRRC,RTNCODE);       /* SAVE THE RETURN CODE          */
         CR    TPRRC,RTNCODE                                       0196
         BNL   *+6
         LR    TPRRC,RTNCODE                                       0196
*   RFY                                                            0197
*     RTNCODE UNRSTD;                                              0197
*   RETURN CODE(TPRRC);             /*                               */
         LR    @15,TPRRC                                           0198
         L     @13,4(,@13)                                         0198
         L     @14,12(,@13)                                        0198
         LM    @00,@12,20(@13)                                     0198
         BR    @14                                                 0198
*                                                                  0199
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION ROUTINE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0199
*TPRINIT:                                                          0199
*   PROC;                                                          0199
TPRINIT  STM   @14,@12,12(@13)                                     0199
*   DCL                                                            0200
*     TPRINTRC FIXED(15);           /* LOCAL RETURN CODE             */
*   TPRINTRC=ZERO;                  /* CLEAR RETURN CODE             */
         SLR   TPRINTRC,TPRINTRC                                   0201
*   RETURN CODE(TPRINTRC);          /* RETURN W/ RC                  */
         LR    @15,TPRINTRC                                        0202
         L     @14,12(,@13)                                        0202
         LM    @00,@12,20(@13)                                     0202
         BR    @14                                                 0202
*   END TPRINIT;                                                   0203
*                                                                  0204
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD DELTA1 AND DELTA2 LIST                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0204
*/********************************************************************/
*/*              × SELECT  × NOT IN ×                                */
*/*              × LIST    × SELECT ×                                */
*/*              ×         × LIST   ×                                */
*/*--------------×---------×--------×                                */
*/*  ON CDS      ×         ×        ×                                */
*/*    - OK      ×    C    ×   C    ×                                */
*/*    - IN ERROR×    C    ×   C    ×  ^C IN SPEC ????               */
*/*    - SUPED   ×    ?    ×   C    ×                                */
*/*    - SUP ONLY×   ^C    ×   C    ×                                */
*/*    - DELETED ×   ^C    ×  ^C    ×                                */
*/*    - DELETES ×   ^C    ×  ^C    ×  ^ IN CODE YET ????            */
*/*  ^ON CDS     ×   ^C    ×  ^C    ×                                */
*/*--------------×---------×--------×                                */
*/*                                                                  */
*/* SYSMOD IN ERROR BUT ONLY JCLIN PROCESSING DONE SEEMS OK ????     */
*/* IF A CANDIDATE ACCORDING TO THE ABOVE TABLE THEN:                */
*/*                                                                  */
*/*--------------×---------×                                         */
*/*  ^ON ACDS    ×    C    ×                                         */
*/*  ON ACDS     ×         ×                                         */
*/*    - OK      ×   ^C    ×                                         */
*/*    - IN ERROR×   ^C  2 ×                                         */
*/*    - SUPED   ×   ^C  2 ×                                         */
*/*    - SUP ONLY×   ^C  2 ×                                         */
*/*    - DELETED ×   ^C  2 ×                                         */
*/*--------------×---------×                                         */
*/* 2 - WILL BE IN "DELTA 2" LIST                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0204
*LSTBLD:                                                           0204
*   PROC(LSTIOP);                                                  0204
LSTBLD   STM   @14,@02,@SA00003                                    0204
         STM   @04,@12,@SA00003+20                                 0204
         MVC   @PC00003(4),0(@01)                                  0204
*   DCL                                                            0205
*     LSTBLDRC FIXED(15);           /* LOCAL RETURN CODE             */
*   DCL                                                            0206
*     LSTIOP CHAR(*);               /* EXTENDED IOP TO BE USED TO GET
*                                      SYSMOD ENTRY                  */
*   DCL                                                            0207
*     1 LSTFLAGS,                   /* LOCAL CONTROL FLAGS           */
*      2 LST1SMD BIT(1),            /* 1ST SYSMOD DIRECTORY ENTRY  0207
*                                      FOUND ON CDS                  */
*      2 LST2SMD BIT(1),            /* 1ST SYSMOD DIRECTORY ENTRY  0207
*                                      FOUND ON ACDS                 */
*      2 CDSEOF BIT(1),             /* EOF OR NEXT AFTER SYSMOD    0207
*                                      ENCOUNTERED                   */
*      2 ACDSEOF BIT(1),                                           0207
*      2 GETCDS BIT(1),             /* GET NEXT DIR ENTRY FROM CDS   */
*      2 ACDSGET BIT(1),            /* GET NEXT DIR ENTRY FROM ACDS  */
*      2 LSTENT1 BIT(1),            /* BUILD ENTRY FOR CDS SYSMOD    */
*      2 LSTENT2 BIT(1),            /* BUILD ENTRY FOR ACDS SYSMOD 0207
*                                      (NOT USED)                    */
*      2 * BIT(8);                  /* UNUSED                        */
*   DCL                                                            0208
*     LST1IOP@ PTR(31);             /* PTR TO IOP FOR CDS            */
*   DCL                                                            0209
*     LST2IOP@ PTR(31);             /* PTR TO IOP FOR ACDS           */
*   DCL                                                            0210
*     LSTSMD1 CHAR(LENGTH(IOPNAM17))/*                               */
*         BASED(ADDR(LST1IOP@->IOPNAM17));/* CDS DIRECTORY ENTRY   0210
*                                      SYSMOD NAME                   */
*   DCL                                                            0211
*     LSTSMD2 CHAR(LENGTH(IOPNAM17))/*                               */
*         BASED(ADDR(LST2IOP@->IOPNAM17));/* ACDS DIRECTORY ENTRY  0211
*                                      SYSMOD NAME                   */
*   LSTFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         XC    LSTFLAGS(2),LSTFLAGS                                0212
*   LSTBLDRC=ZERO;                  /* CLEAR RETURN CODE             */
         SLR   LSTBLDRC,LSTBLDRC                                   0213
*   LST1IOP@=CCAIOPTR;              /* IOP FOR DIRECTORY READ OF CDS */
         L     LST1IOP@,CCAIOPTR(,CCAPTR)                          0214
*   LST2IOP@=TBLXIOPF;              /* IOP FOR DIRECTORY READ OF ACDS*/
         L     @10,@PC00001                                        0215
         L     LST2IOP@,TBLXIOPF(,@10)                             0215
*   LST1IOP@->IOPDSID=IOPCDS;       /* DSID OF CDS                   */
         MVI   IOPDSID(LST1IOP@),X'02'                             0216
*   LST2IOP@->IOPDSID=IOPACDS;      /* DSID OF ACDS                  */
         MVI   IOPDSID(LST2IOP@),X'0C'                             0217
*   LST1IOP@->IOPFUNCT=IOPOPENN;    /* RESET TO THE BEGINNING OF CDS */
         MVI   IOPFUNCT(LST1IOP@),X'0C'                            0218
*   CALL HMASMIO(LST1IOP@->HMASMIOP);/* ...                          */
         ST    LST1IOP@,@AL00001                                   0219
         L     @15,@CV01228                                        0219
         LA    @01,@AL00001                                        0219
         BALR  @14,@15                                             0219
*   LST2IOP@->IOPFUNCT=IOPOPENN;    /* RESET TO THE BEGINNING OF ACDS*/
         MVI   IOPFUNCT(LST2IOP@),X'0C'                            0220
*   CALL HMASMIO(LST2IOP@->HMASMIOP);/* ...                          */
*                                                                  0221
         ST    LST2IOP@,@AL00001                                   0221
         L     @15,@CV01228                                        0221
         LA    @01,@AL00001                                        0221
         BALR  @14,@15                                             0221
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ALL SYSMOD ENTRIES ON BOTH CDS AND ACDS               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0222
*   DO WHILE(LSTBLDRC<STOPFUNC&(CDSEOF=OFF×ACDSEOF=OFF));          0222
         B     @DE00222                                            0222
@DL00222 DS    0H                                                  0223
*     LSTENT1=OFF;                  /* CLEAR BUILD ENTRY FLAG        */
*     LSTENT2=OFF;                  /* CLEAR BUILD ENTRY FLAG        */
         NI    LSTENT1,B'11111100'                                 0224
*     CALL CDSREAD;                 /*                               */
         BAL   @14,CDSREAD                                         0225
*     RFY                                                          0226
*       RTNCODE RSTD;                                              0226
*     LSTBLDRC=MAX(LSTBLDRC,RTNCODE);/* SET RETURN CODE              */
         CR    LSTBLDRC,RTNCODE                                    0227
         BNL   *+6
         LR    LSTBLDRC,RTNCODE                                    0227
*     RFY                                                          0228
*       RTNCODE UNRSTD;                                            0228
*     CALL ACDSREAD;                /*                               */
         BAL   @14,ACDSREAD                                        0229
*     RFY                                                          0230
*       RTNCODE RSTD;                                              0230
*     LSTBLDRC=MAX(LSTBLDRC,RTNCODE);/* SET RETURN CODE              */
         CR    LSTBLDRC,RTNCODE                                    0231
         BNL   *+6
         LR    LSTBLDRC,RTNCODE                                    0231
*     RFY                                                          0232
*       RTNCODE UNRSTD;                                            0232
*     GETCDS=OFF;                   /* CLEAR READ FLAGS              */
*     ACDSGET=OFF;                  /* ...                           */
         NI    GETCDS,B'11110011'                                  0234
*     IF(CDSEOF=OFF                 /* ENTRY FROM ACDS               */
*         ×ACDSEOF=OFF)             /* NOT AT END OF BOTH CDS AND    */
*         &LSTBLDRC<STOPFUNC THEN   /* ACDS?                         */
         TM    CDSEOF,B'00110000'                                  0235
         BO    @RF00235                                            0235
         CH    LSTBLDRC,@CH00033                                   0235
         BNL   @RF00235                                            0235
*       DO;                                                        0236
*         IF LST1SMD=ON             /* WITHIN SYSMOD ENTRIES ON      */
*             &CDSEOF=OFF THEN      /* CDS?                          */
         TM    LST1SMD,B'10000000'                                 0237
         BNO   @RF00237                                            0237
         TM    CDSEOF,B'00100000'                                  0237
         BNZ   @RF00237                                            0237
*           DO;                     /* YES,                          */
*             IF LST2SMD=OFF        /* NO ACDS SYSMOD?               */
*                 ×ACDSEOF=ON THEN                                 0239
         TM    ACDSEOF,B'00010000'                                 0239
         BNZ   @RT00239                                            0239
         TM    LST2SMD,B'01000000'                                 0239
         BO    @RF00239                                            0239
@RT00239 DS    0H                                                  0240
*               DO;                 /* YES,                          */
*                 LSTENT1=ON;       /* BUILD ICT ENTRY IF POSSIBLE   */
*                 GETCDS=ON;        /* GET NEXT ENTRY FROM CDS       */
         OI    LSTENT1,B'00001010'                                 0242
*               END;                                               0243
*             ELSE                  /* ALSO WITHIN SYSMOD ENTRIES    */
*               DO;                 /* ON ACDS                       */
         B     @RC00239                                            0244
@RF00239 DS    0H                                                  0245
*                 IF LSTSMD1=LSTSMD2 THEN/* CDS/ACDS SYSMODS EQUAL?  */
         LA    @10,4                                               0245
         LR    @08,LST1IOP@                                        0245
         ALR   @08,@10                                             0245
         ALR   @10,LST2IOP@                                        0245
         CLC   LSTSMD1(7,@08),LSTSMD2(@10)                         0245
         BNE   @RF00245                                            0245
*                   DO;             /* YES,                          */
*                     GETCDS=ON;    /* SKIP BY GETTING RECORDS       */
*                     ACDSGET=ON;   /* FROM BOTH 1 AND 2             */
         OI    GETCDS,B'00001100'                                  0248
*                     CALL LSTCHK;  /* CHECK WHEN BOTH ON CDS AND  0249
*                                      ACDS                          */
         BAL   @14,LSTCHK                                          0249
*                     RFY                                          0250
*                       RTNCODE RSTD;                              0250
*                     TPRRC=MAX(LSTBLDRC,RTNCODE);/* SAVE THE RETURN
*                                      CODE                          */
         LR    TPRRC,RTNCODE                                       0251
         CR    TPRRC,LSTBLDRC                                      0251
         BNL   *+6
         LR    TPRRC,LSTBLDRC                                      0251
*                     RFY                                          0252
*                       RTNCODE UNRSTD;                            0252
*                   END;                                           0253
*                 ELSE                                             0254
*                   ;               /* NOT EQUAL?                    */
@RF00245 DS    0H                                                  0255
*                 IF LSTSMD1<LSTSMD2 THEN/* SYSMOD CDS NOT ON ACDS?  */
         LA    @10,4                                               0255
         LR    @08,LST1IOP@                                        0255
         ALR   @08,@10                                             0255
         ALR   @10,LST2IOP@                                        0255
         CLC   LSTSMD1(7,@08),LSTSMD2(@10)                         0255
         BNL   @RF00255                                            0255
*                   DO;             /* YES,                          */
*                     LSTENT1=ON;   /* BUILD SCL ENTRY               */
*                     GETCDS=ON;    /* GET NEXT CDS ENTRY            */
         OI    LSTENT1,B'00001010'                                 0258
*                   END;                                           0259
*                 ELSE                                             0260
*                   ;                                              0260
@RF00255 DS    0H                                                  0261
*                 IF LSTSMD1>LSTSMD2 THEN/* ACDS SYSMOD NOT IN       */
         LA    @10,4                                               0261
         LR    @08,LST1IOP@                                        0261
         ALR   @08,@10                                             0261
         ALR   @10,LST2IOP@                                        0261
         CLC   LSTSMD1(7,@08),LSTSMD2(@10)                         0261
         BNH   @RF00261                                            0261
*                   DO;             /* CDS                           */
*                     ACDSGET=ON;   /* GET NEXT ACDS DIR. ENTRY      */
*                     LSTENT2=ON;   /* ADD TO DELTA 2 LIST           */
         OI    ACDSGET,B'00000101'                                 0264
*                   END;                                           0265
*                 ELSE                                             0266
*                   ;                                              0266
@RF00261 DS    0H                                                  0267
*               END;                                               0267
*           END;                                                   0268
*         ELSE                      /* NOT WITHIN SYSMODS ON SYSMOD  */
*           DO;                     /* ENTRIES ON CDS                */
         B     @RC00237                                            0269
@RF00237 DS    0H                                                  0270
*             IF ACDSEOF=OFF THEN   /* WITHIN SYSMODS ON ACDS?       */
         TM    ACDSEOF,B'00010000'                                 0270
         BNZ   @RF00270                                            0270
*               DO;                 /* YES,                          */
*                 ACDSGET=ON;       /* CONTINUE GETTING UNTIL EOF    */
         OI    ACDSGET,B'00000100'                                 0272
*                 IF LST2SMD=ON THEN/* GOTTEN FIRST SYSMOD?          */
         TM    LST2SMD,B'01000000'                                 0273
         BNO   @RF00273                                            0273
*                   DO;             /* YES,                          */
*                     LSTENT2=ON;   /* BUILD ENTRY FROM ACDS         */
         OI    LSTENT2,B'00000001'                                 0275
*                   END;            /*                               */
*                 ELSE                                             0277
*                   ;               /* FIRST SYSMOD NOT FOUND        */
@RF00273 DS    0H                                                  0278
*               END;                                               0278
*             ELSE                                                 0279
*               ;                   /* EOF ON ACDS                   */
@RF00270 DS    0H                                                  0280
*           END;                                                   0280
*       END;                                                       0281
*     ELSE                                                         0282
*       ;                           /* EOF ON BOTH CDS AND ACDS      */
*                                                                  0282
@RF00235 DS    0H                                                  0283
*     /***************************************************************/
*     /*                                                             */
*     /* BUILD ICT ENTRY FOR SYSMOD                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0283
*     IF LSTENT1=ON THEN            /* BUILD ICT ENTRIES             */
@RC00235 TM    LSTENT1,B'00000010'                                 0283
         BNO   @RF00283                                            0283
*       DO;                         /* YES,                          */
*         CALL SMDICT(LST1IOP@->HMASMIOP);/* ADD SYSMOD TO ICT       */
         ST    LST1IOP@,@AL00001                                   0285
         LA    @01,@AL00001                                        0285
         BAL   @14,SMDICT                                          0285
*         RFY                                                      0286
*           RTNCODE RSTD;                                          0286
*         TPRRC=MAX(LSTBLDRC,RTNCODE);/* SAVE THE RETURN CODE        */
         LR    TPRRC,RTNCODE                                       0287
         CR    TPRRC,LSTBLDRC                                      0287
         BNL   *+6
         LR    TPRRC,LSTBLDRC                                      0287
*         RFY                                                      0288
*           RTNCODE UNRSTD;                                        0288
*       END;                                                       0289
*     ELSE                                                         0290
*       ;                                                          0290
*                                                                  0290
@RF00283 DS    0H                                                  0291
*     /***************************************************************/
*     /*                                                             */
*     /* ADD ENTRY TO DELTA 2 LIST                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0291
*     IF LSTENT2=ON THEN            /* BUILD DELTA 2 LIST            */
         TM    LSTENT2,B'00000001'                                 0291
         BNO   @RF00291                                            0291
*       DO;                         /* YES,                          */
*         CALL DELTA2BL(LST2IOP@->HMASMIOP);/* BUILD DELTA 2 ENTRY 0293
*                                      FOR SYSMOD                    */
         ST    LST2IOP@,@AL00001                                   0293
         LA    @01,@AL00001                                        0293
         BAL   @14,DELTA2BL                                        0293
*         RFY                                                      0294
*           RTNCODE RSTD;                                          0294
*         TPRRC=MAX(LSTBLDRC,RTNCODE);/* SAVE THE RETURN CODE        */
         LR    TPRRC,RTNCODE                                       0295
         CR    TPRRC,LSTBLDRC                                      0295
         BNL   *+6
         LR    TPRRC,LSTBLDRC                                      0295
*         RFY                                                      0296
*           RTNCODE UNRSTD;                                        0296
*       END;                                                       0297
*     ELSE                                                         0298
*       ;                                                          0298
@RF00291 DS    0H                                                  0299
*   END;                            /* END OF PROCESS DIR. ENTRIES   */
@DE00222 CH    LSTBLDRC,@CH00033                                   0299
         BNL   @DC00222                                            0299
         TM    CDSEOF,B'00110000'                                  0299
         BNO   @DL00222                                            0299
@DC00222 DS    0H                                                  0300
*   RETURN CODE(LSTBLDRC);          /*                               */
         LR    @15,LSTBLDRC                                        0300
         L     @14,@SA00003                                        0300
         LM    @00,@02,@SA00003+8                                  0300
         LM    @04,@12,@SA00003+20                                 0300
         BR    @14                                                 0300
*   RFY                                                            0301
*     HMASMIOP BASED;                                              0301
*                                                                  0302
*   /*****************************************************************/
*   /*                                                               */
*   /* LSTGET -                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0302
*LSTGET:                                                           0302
*   PROC(GLMGIOP);                                                 0302
LSTGET   STM   @14,@12,@SA00004                                    0302
         MVC   @PC00004(4),0(@01)                                  0302
*   DCL                                                            0303
*     GLMGIOP CHAR(*);              /* FIXED IOP FOR GET NEXT        */
*   DCL                                                            0304
*     LSTGETRC FIXED(15);           /* RETURN CODE                   */
*   RFY                                                            0305
*     HMASMIOP BASED(ADDR(GLMGIOP));                               0305
*   LSTGETRC=ZERO;                  /* CLEAR THE RETURN CODE         */
         SLR   LSTGETRC,LSTGETRC                                   0306
*   IOPFUNCT=IOPGETN;                                              0307
         L     @10,@PC00004                                        0307
         MVI   IOPFUNCT(@10),X'0A'                                 0307
*   IOPTYPE=IOPSMD;                                                0308
         MVI   IOPTYPE(@10),X'0B'                                  0308
*   CALL HMASMIO(HMASMIOP);                                        0309
         ST    @10,@AL00001                                        0309
         L     @15,@CV01228                                        0309
         LA    @01,@AL00001                                        0309
         BALR  @14,@15                                             0309
*   LSTGETRC=IOPRETRN;              /*                               */
         L     @10,@PC00004                                        0310
         SLR   LSTGETRC,LSTGETRC                                   0310
         IC    LSTGETRC,IOPRETRN(,@10)                             0310
*   RETURN CODE(LSTGETRC);          /* RETURN WITH THE RETURN CODE   */
         LR    @15,LSTGETRC                                        0311
         L     @14,@SA00004                                        0311
         LM    @00,@12,@SA00004+8                                  0311
         BR    @14                                                 0311
*   RFY                                                            0312
*     HMASMIOP BASED;                                              0312
*   END LSTGET;                     /*                               */
*                                                                  0314
*   /*****************************************************************/
*   /*                                                               */
*   /* CDSREAD - READ FROM DATA SET 1 TO GET A 'VALID' SYSMOD ENTRY  */
*   /* TO COMPARE WITH THE CONTENTS OF ACDS                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0314
*CDSREAD:                                                          0314
*   PROC;                           /*                               */
CDSREAD  STM   @14,@12,@SA00005                                    0314
*   DCL                                                            0315
*     CDSRC FIXED(15);              /*                               */
*   DCL                                                            0316
*     1 CDSFLAGS,                   /* LOCAL CONTROL FLAGS           */
*      2 CDSVALID BIT(1),           /* SYSMOD IS VALID FOR PROCESSING*/
*      2 * BIT(7);                  /* UNUSED                        */
*   RFY                                                            0317
*     HMASMIOP BASED(LST1IOP@);                                    0317
*   RFY                                                            0318
*     TSLPARMS BASED(TBLXTSLP);                                    0318
*                                                                  0319
*   /*****************************************************************/
*   /*                                                               */
*   /* BYPASS ??????                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0319
*   CDSRC=ZERO;                     /*                               */
         SLR   CDSRC,CDSRC                                         0319
*   CDSFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         MVI   CDSFLAGS,X'00'                                      0320
*   IF(LST1SMD=OFF                  /* SHOULD A RECORD BE GOTTEN     */
*       ×GETCDS=ON) THEN            /* FROM CDS?                     */
         TM    GETCDS,B'00001000'                                  0321
         BNZ   @RT00321                                            0321
         TM    LST1SMD,B'10000000'                                 0321
         BO    @RF00321                                            0321
@RT00321 DS    0H                                                  0322
*     DO;                           /*                               */
*       DO WHILE CDSVALID=OFF       /*                               */
*             &CDSEOF=OFF           /*                               */
*             &CDSRC<STOPFUNC;                                     0323
         B     @DE00323                                            0323
@DL00323 DS    0H                                                  0324
*         CALL LSTGET(HMASMIOP);    /* GET NEXT DIRECTORY ENTRY      */
         ST    LST1IOP@,@AL00001                                   0324
         LA    @01,@AL00001                                        0324
         BAL   @14,LSTGET                                          0324
*         RFY                                                      0325
*           RTNCODE RSTD;           /* FROM CDS                      */
*         IF RTNCODE>IOPEOF THEN    /* IO ERROR?                     */
         CH    RTNCODE,@CH00037                                    0326
         BNH   @RF00326                                            0326
*           DO;                                                    0327
*             CDSRC=MAX(CDSRC,RTNCODE);/* SET RETURN CODE            */
         CR    CDSRC,RTNCODE                                       0328
         BNL   *+6
         LR    CDSRC,RTNCODE                                       0328
*           END;                    /*                               */
*         IF RTNCODE=IOPEOF THEN    /* END OF FILE?                  */
@RF00326 CH    RTNCODE,@CH00037                                    0330
         BNE   @RF00330                                            0330
*           DO;                                                    0331
*             CDSEOF=ON;            /* EOF FLAGGED                   */
         OI    CDSEOF,B'00100000'                                  0332
*           END;                                                   0333
*         IF RTNCODE=ZERO THEN      /* ALL IS WELL?                  */
@RF00330 LTR   RTNCODE,RTNCODE                                     0334
         BNZ   @RF00334                                            0334
*           DO;                     /* YES,                          */
*             RFY                                                  0336
*               RTNCODE UNRSTD;                                    0336
*             IF LST1SMD=OFF THEN   /* 1ST SYSMOD NOT FOUND ON CDS?  */
         TM    LST1SMD,B'10000000'                                 0337
         BNZ   @RF00337                                            0337
*               DO;                                                0338
*                 IF LST1IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?*/
         CLI   IOPTYPE(LST1IOP@),11                                0339
         BNE   @RF00339                                            0339
*                   DO;                                            0340
*                     LST1SMD=ON;   /* 1ST CDS SYSMOD FOUND          */
         OI    LST1SMD,B'10000000'                                 0341
*                   END;                                           0342
*               END;                                               0343
*             ELSE                  /* 1ST SYSMOD ALREADY FOUND      */
*               DO;                                                0344
         B     @RC00337                                            0344
@RF00337 DS    0H                                                  0345
*                 IF LST1IOP@->IOPTYPE^=IOPSMD THEN/* NOT A SYSMOD?  */
         CLI   IOPTYPE(LST1IOP@),11                                0345
         BE    @RF00345                                            0345
*                   DO;                                            0346
*                     CDSEOF=ON;    /* END OF SYSMODS                */
         OI    CDSEOF,B'00100000'                                  0347
*                   END;                                           0348
*               END;                                               0349
@RF00345 DS    0H                                                  0350
*             IF LST1IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?    */
@RC00337 CLI   IOPTYPE(LST1IOP@),11                                0350
         BNE   @RF00350                                            0350
*               DO;                                                0351
*                 IF IOPSBYP^=ON    /* NOT SUP'ED ...                */
*                     &IOPDBYP^=ON THEN/* ... AND NOT DELETED?       */
         TM    IOPSBYP(LST1IOP@),B'11000000'                       0352
         BNZ   @RF00352                                            0352
*                   DO;                                            0353
*                     CDSVALID=ON;  /* VALID CDS SYSMOD FOUND        */
         OI    CDSVALID,B'10000000'                                0354
*                     IF IOPDELP=ON THEN/* DOES SYSMOD DELETE OTHER
*                                      SYSMODS?                      */
         TM    IOPDELP(LST1IOP@),B'10000000'                       0355
         BNO   @RF00355                                            0355
*                       DO;         /* YES,                          */
*                         CALL SELFND(IOPNAM17);/* FIND IN SELECT  0357
*                                      LIST                          */
         LA    @10,IOPNAM17(,LST1IOP@)                             0357
         ST    @10,@AL00001                                        0357
         LA    @01,@AL00001                                        0357
         BAL   @14,SELFND                                          0357
*                         RFY                                      0358
*                           RTNCODE RSTD;                          0358
*                         IF RTNCODE=ZERO THEN/* FOUND?              */
         LTR   RTNCODE,RTNCODE                                     0359
         BNZ   @RF00359                                            0359
*                           DO;     /* YES,                          */
*                             CDSVALID=OFF;/* VALID CDS SYSMOD NOT 0361
*                                      FOUND                         */
         NI    CDSVALID,B'01111111'                                0361
*                             RFY                                  0362
*                               RTNCODE UNRSTD;                    0362
*                                                                  0362
*                             /***************************************/
*                             /*                                     */
*                             /* HMA245I SYSMOD XXXXXXX SELECTED FOR */
*                             /* RESTORE ... DELETES SYSMODS         */
*                             /*                                     */
*                             /***************************************/
*                                                                  0363
*                             CDSRC=STOPSMD;/* FAIL THE SYSMOD       */
         LA    CDSRC,8                                             0363
*                             DO;   /* HMASMPMG M1(HMA245I)M2(PART120
*                                      )TYPE(ERR)VAR(IOPNAM17)TARGET(
*                                      SYSOUT,LOG)                   */
*                               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET 0365
*                                      PARMS TO ZEROS                */
         XC    HMASMMGP(28),HMASMMGP                               0365
*                               MGPMGNO1=HMA245I;/* SET UP MSG 1 CODE*/
         MVC   MGPMGNO1(2),@CH01237                                0366
*                               MGPMGNO2=PART120;/* SET UP MSG 2 CODE*/
         MVC   MGPMGNO2(2),@CH01248                                0367
*                               MGPTYPE=MGPERR;/* SET MESSAGE TYPE   */
         MVI   MGPTYPE,X'03'                                       0368
*                               MGPPRINT='1'B;/* SET TARGET FLAG     */
*                               MGPHLDS='1'B;/* SET TARGET FLAG      */
         OI    MGPPRINT,B'10010000'                                0370
*                               MGPVARPT(1)=ADDR(IOPNAM17);/* SET  0371
*                                      VARIABLE PTR                  */
         LA    @10,IOPNAM17(,LST1IOP@)                             0371
         ST    @10,MGPVARPT                                        0371
*                               CALL HMASMMSG(HMASMMGP);/* HAVE    0372
*                                      MESSAGE ISSUED                */
         L     @15,@CV01229                                        0372
         LA    @01,@AL00372                                        0372
         BALR  @14,@15                                             0372
*                             END;  /*                               */
*                             TSLFUNCT=TSLFFUNC;/* CHECK FOR FUNCTION
*                                      FAILURE                       */
         L     @10,@PC00001                                        0374
         L     @10,TBLXTSLP(,@10)                                  0374
         MVI   TSLFUNCT(@10),X'07'                                 0374
*                             TSLMTYPE=IOPPTYPE;/* TYPE ...          */
         L     @08,TSLPMLAD(,@10)                                  0375
         MVC   TSLMTYPE(1,@08),IOPPTYPE(LST1IOP@)                  0375
*                             TSLMSMD=IOPNAM17;/* ... AND NAME       */
         MVC   TSLMSMD(7,@08),IOPNAM17(LST1IOP@)                   0376
*                             CALL HMASMTSB(TSLPARMS);/* ...         */
         ST    @10,@AL00001                                        0377
         L     @15,@CV01232                                        0377
         LA    @01,@AL00001                                        0377
         BALR  @14,@15                                             0377
*                             CDSRC=MAX(CDSRC,TSLRETRN);/* SET RETURN
*                                      CODE                          */
         L     @10,@PC00001                                        0378
         L     @10,TBLXTSLP(,@10)                                  0378
         SLR   @08,@08                                             0378
         IC    @08,TSLRETRN(,@10)                                  0378
         CR    CDSRC,@08                                           0378
         BNL   *+6
         LR    CDSRC,@08                                           0378
*                           END;                                   0379
*                         ELSE                                     0380
*                           ;       /* CONTINUE, SYSMOD IS ADDED TO
*                                      ICT BUT WILL BE MARKED NOGO 0380
*                                      LATER                         */
@RF00359 DS    0H                                                  0381
*                       END;                                       0381
*                     ELSE                                         0382
*                       ;           /* DOES NOT CAUSE DELETES        */
@RF00355 DS    0H                                                  0383
*                   END;                                           0383
*                 ELSE              /* SYSMOD OTHER THAN OK ON CDS   */
*                   DO;                                            0384
         B     @RC00352                                            0384
@RF00352 DS    0H                                                  0385
*                     CALL CDSRCHK(HMASMIOP);/* CHECK THE STATUS OF
*                                      SYSMOD                        */
         ST    LST1IOP@,@AL00001                                   0385
         LA    @01,@AL00001                                        0385
         BAL   @14,CDSRCHK                                         0385
*                     RFY                                          0386
*                       RTNCODE RSTD;/*                              */
*                     CDSRC=MAX(CDSRC,RTNCODE);/* SET RC             */
         CR    CDSRC,RTNCODE                                       0387
         BNL   *+6
         LR    CDSRC,RTNCODE                                       0387
*                     RFY                                          0388
*                       RTNCODE UNRSTD;/*                            */
*                   END;                                           0389
*               END;                                               0390
@RC00352 DS    0H                                                  0391
*           END;                                                   0391
@RF00350 DS    0H                                                  0392
*       END;                                                       0392
@RF00334 DS    0H                                                  0392
@DE00323 TM    CDSVALID,B'10000000'                                0392
         BNZ   @DC00323                                            0392
         TM    CDSEOF,B'00100000'                                  0392
         BNZ   @DC00323                                            0392
         CH    CDSRC,@CH00033                                      0392
         BL    @DL00323                                            0392
@DC00323 DS    0H                                                  0393
*     END;                          /*                               */
*   ELSE                                                           0394
*     ;                             /* DONT GET DIR. ENTRY FROM CDS  */
@RF00321 DS    0H                                                  0395
*   RETURN CODE(CDSRC);             /*                               */
         LR    @15,CDSRC                                           0395
         L     @14,@SA00005                                        0395
         LM    @00,@12,@SA00005+8                                  0395
         BR    @14                                                 0395
*   RFY                                                            0396
*     HMASMIOP BASED;                                              0396
*CDSRCHK:                           /*                               */
*   PROC(CDSRCIOP);                                                0397
CDSRCHK  STM   @14,@12,@SA00006                                    0397
         MVC   @PC00006(4),0(@01)                                  0397
*   DCL                                                            0398
*     CDSRCIOP CHAR(*);             /* IOP                           */
*   DCL                                                            0399
*     CDSRRC FIXED(15);             /* LOCAL RETURN CODE             */
*   RFY                                                            0400
*     HMASMIOP BASED(ADDR(CDSRCIOP));                              0400
*   CDSRRC=''B;                     /* CLEAR RETURN CODE             */
         SLR   CDSRRC,CDSRRC                                       0401
*                                                                  0402
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE SYSMOD IN SELECT/GROUP LIST                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0402
*   CALL SELFND(IOPNAM17);                                         0402
         L     @10,@PC00006                                        0402
         LA    @10,IOPNAM17(,@10)                                  0402
         ST    @10,@AL00001                                        0402
         LA    @01,@AL00001                                        0402
         BAL   @14,SELFND                                          0402
*   RFY                                                            0403
*     RTNCODE RSTD;                                                0403
*   IF RTNCODE>=STOPSMD THEN        /* ERROR RETURN?                 */
         CH    RTNCODE,@CH00055                                    0404
         BL    @RF00404                                            0404
*     DO;                           /* YES,                          */
*       CDSRRC=MAX(CDSRRC,RTNCODE); /* SAVE RETURN CODE              */
         CR    CDSRRC,RTNCODE                                      0406
         BNL   *+6
         LR    CDSRRC,RTNCODE                                      0406
*     END;                          /*                               */
*   IF RTNCODE=ZERO THEN            /* FOUND IN THE SELECT LIST?     */
@RF00404 LTR   RTNCODE,RTNCODE                                     0408
         BNZ   @RF00408                                            0408
*     DO;                           /* YES,                          */
*       RFY                                                        0410
*         RTNCODE UNRSTD;                                          0410
*       IF IOPDUMMP=ON THEN         /* DUMMY ONLY ?                  */
         L     @10,@PC00006                                        0411
         TM    IOPDUMMP(@10),B'00000100'                           0411
         BNO   @RF00411                                            0411
*         DO;                       /* YES,                          */
*           IF IOPSBYP=ON THEN      /* SUP ONLY ENTRY?               */
         TM    IOPSBYP(@10),B'10000000'                            0413
         BNO   @RF00413                                            0413
*             DO;                   /* YES,                          */
*               CDSRRC=MAX(CDSRRC,STOPSMD);/* SET THEN RETURN CODE   */
*                                                                  0415
         LA    @08,8                                               0415
         CR    CDSRRC,@08                                          0415
         BNL   *+6
         LR    CDSRRC,@08                                          0415
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE MESSAGE 'HMA245I SYSMOD XXXXXXX SELECTED FOR*/
*               /* RESTORE ... IS SUPERCEEDED                        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0416
*               DO;                 /* HMASMPMG M1(HMA245I)M2(PART100
*                                      )TYPE(ERR)VAR(IOPNAM17)TARGET(
*                                      SYSOUT,LOG)                   */
*                 HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS  */
         XC    HMASMMGP(28),HMASMMGP                               0417
*                 MGPMGNO1=HMA245I; /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01237                                0418
*                 MGPMGNO2=PART100; /* SET UP MSG 2 CODE             */
         MVC   MGPMGNO2(2),@CH00349                                0419
*                 MGPTYPE=MGPERR;   /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0420
*                 MGPPRINT='1'B;    /* SET TARGET FLAG               */
*                 MGPHLDS='1'B;     /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0422
*                 MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR     */
         LA    @10,IOPNAM17(,@10)                                  0423
         ST    @10,MGPVARPT                                        0423
*                 CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED     */
         L     @15,@CV01229                                        0424
         LA    @01,@AL00424                                        0424
         BALR  @14,@15                                             0424
*               END;                /*                               */
*               TSLFUNCT=TSLFFUNC;  /* CHECK FOR FUNCTION FAILURE    */
         L     @10,@PC00001                                        0426
         L     @10,TBLXTSLP(,@10)                                  0426
         MVI   TSLFUNCT(@10),X'07'                                 0426
*               TSLMTYPE=IOPPTYPE;  /* TYPE ...                      */
         L     @08,TSLPMLAD(,@10)                                  0427
         L     @02,@PC00006                                        0427
         MVC   TSLMTYPE(1,@08),IOPPTYPE(@02)                       0427
*               TSLMSMD=IOPNAM17;   /* ... AND NAME                  */
         MVC   TSLMSMD(7,@08),IOPNAM17(@02)                        0428
*               CALL HMASMTSB(TSLPARMS);/* ...                       */
         ST    @10,@AL00001                                        0429
         L     @15,@CV01232                                        0429
         LA    @01,@AL00001                                        0429
         BALR  @14,@15                                             0429
*               CDSRRC=MAX(CDSRRC,TSLRETRN);/* SET THE RETURN CODE   */
         L     @10,@PC00001                                        0430
         L     @10,TBLXTSLP(,@10)                                  0430
         SLR   @08,@08                                             0430
         IC    @08,TSLRETRN(,@10)                                  0430
         CR    CDSRRC,@08                                          0430
         BNL   *+6
         LR    CDSRRC,@08                                          0430
*             END;                                                 0431
*           ELSE                    /* NOT SUP                       */
*             DO;                                                  0432
         B     @RC00413                                            0432
@RF00413 DS    0H                                                  0433
*               IF IOPDBYP=ON THEN  /* DELETE ENTRY                  */
         L     @10,@PC00006                                        0433
         TM    IOPDBYP(@10),B'01000000'                            0433
         BNO   @RF00433                                            0433
*                 DO;               /* YES                           */
*                   CDSRRC=MAX(CDSRRC,STOPSMD);/* SET THE RETURN CODE*/
*                                                                  0435
         LA    @08,8                                               0435
         CR    CDSRRC,@08                                          0435
         BNL   *+6
         LR    CDSRRC,@08                                          0435
*                   /*************************************************/
*                   /*                                               */
*                   /* ISSUE MESSAGE 'HMA245I SYSMOD XXXXXXX SELECTED*/
*                   /* FOR RESTORE ... IS DELETED                    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0436
*                   DO;             /* HMASMPMG M1(HMA245I)M2(PART099
*                                      )TYPE(ERR)VAR(IOPNAM17)TARGET(
*                                      SYSOUT,LOG)                   */
*                     HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO  0437
*                                      ZEROS                         */
         XC    HMASMMGP(28),HMASMMGP                               0437
*                     MGPMGNO1=HMA245I;/* SET UP MSG 1 CODE          */
         MVC   MGPMGNO1(2),@CH01237                                0438
*                     MGPMGNO2=PART099;/* SET UP MSG 2 CODE          */
         MVC   MGPMGNO2(2),@CH01245                                0439
*                     MGPTYPE=MGPERR;/* SET MESSAGE TYPE             */
         MVI   MGPTYPE,X'03'                                       0440
*                     MGPPRINT='1'B;/* SET TARGET FLAG               */
*                     MGPHLDS='1'B; /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0442
*                     MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR */
         LA    @10,IOPNAM17(,@10)                                  0443
         ST    @10,MGPVARPT                                        0443
*                     CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED */
         L     @15,@CV01229                                        0444
         LA    @01,@AL00444                                        0444
         BALR  @14,@15                                             0444
*                   END;            /*                               */
*                   TSLFUNCT=TSLFFUNC;/* CHECK FOR FUNCTION FAILURE  */
         L     @10,@PC00001                                        0446
         L     @10,TBLXTSLP(,@10)                                  0446
         MVI   TSLFUNCT(@10),X'07'                                 0446
*                   TSLMTYPE=IOPPTYPE;/* TYPE ...                    */
         L     @08,TSLPMLAD(,@10)                                  0447
         L     @02,@PC00006                                        0447
         MVC   TSLMTYPE(1,@08),IOPPTYPE(@02)                       0447
*                   TSLMSMD=IOPNAM17;/* ... AND NAME                 */
         MVC   TSLMSMD(7,@08),IOPNAM17(@02)                        0448
*                   CALL HMASMTSB(TSLPARMS);/* ...                   */
         ST    @10,@AL00001                                        0449
         L     @15,@CV01232                                        0449
         LA    @01,@AL00001                                        0449
         BALR  @14,@15                                             0449
*                   CDSRRC=MAX(CDSRRC,TSLRETRN);/* SET THE RETURN  0450
*                                      CODE                          */
         L     @10,@PC00001                                        0450
         L     @10,TBLXTSLP(,@10)                                  0450
         SLR   @08,@08                                             0450
         IC    @08,TSLRETRN(,@10)                                  0450
         CR    CDSRRC,@08                                          0450
         BNL   *+6
         LR    CDSRRC,@08                                          0450
*                 END;                                             0451
*             END;                                                 0452
*         END;                                                     0453
*       ELSE                        /* SUP BUT NOT A SUP ONLY        */
*         DO;                                                      0454
         B     @RC00411                                            0454
@RF00411 DS    0H                                                  0455
*           CDSVALID=ON;            /* VALID SYSMOD FOR RESTORE      */
         OI    CDSVALID,B'10000000'                                0455
*         END;                                                     0456
*     END;                                                         0457
*   ELSE                            /* NOT IN THE SELECT LIST OR ERR */
*     DO;                                                          0458
*                                                                  0458
         B     @RC00408                                            0458
@RF00408 DS    0H                                                  0459
*       /*************************************************************/
*       /*                                                           */
*       /* IF DELETE THEN NOT VALID, IF SUP OK                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0459
*       IF IOPSBYP=ON THEN          /* SUP'ED SYSMOD?                */
         L     @10,@PC00006                                        0459
         TM    IOPSBYP(@10),B'10000000'                            0459
         BNO   @RF00459                                            0459
*         DO;                       /* YES,                          */
*           CDSVALID=ON;            /* VALID SYSMOD FOR RESTORE      */
         OI    CDSVALID,B'10000000'                                0461
*         END;                                                     0462
*       ELSE                                                       0463
*         ;                         /* NOT SUP, MUST BE DELETE, SO 0463
*                                      SKIP IT                       */
@RF00459 DS    0H                                                  0464
*     END;                                                         0464
*   RETURN CODE(CDSRRC);            /* RETURN W/ RC                  */
@RC00408 LR    @15,CDSRRC                                          0465
         L     @14,@SA00006                                        0465
         LM    @00,@12,@SA00006+8                                  0465
         BR    @14                                                 0465
*   RFY                                                            0466
*     HMASMIOP BASED;                                              0466
*   RFY                                                            0467
*     TSLPARMS BASED;                                              0467
*   END CDSRCHK;                    /*                               */
*   END CDSREAD;                    /*                               */
*                                                                  0470
*   /*****************************************************************/
*   /*                                                               */
*   /* ACDSREAD - GET NEXT DIRECTORY ENTRY FROM ACDS                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0470
*ACDSREAD:                                                         0470
*   PROC;                           /*                               */
ACDSREAD STM   @14,@12,@SA00007                                    0470
*   DCL                                                            0471
*     ACDSRC FIXED(15);                                            0471
*   DCL                                                            0472
*     1 ACDSFLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 ACDSVALD BIT(1),           /* ACDS ENTRY IS VALID TO BE   0472
*                                      PROCESSED                     */
*      2 * BIT(7);                  /* UNUSED                        */
*   RFY                                                            0473
*     HMASMIOP BASED(LST2IOP@);                                    0473
*   ACDSRC=ZERO;                    /*                               */
         SLR   ACDSRC,ACDSRC                                       0474
*   ACDSFLGS=''B;                   /* CLEAR CONTROL FLAGS           */
         MVI   ACDSFLGS,X'00'                                      0475
*   IF(LST2SMD=OFF                  /* SHOULD A RECORD BE GOTTEN     */
*       ×ACDSGET=ON) THEN           /* FROM ACDS?                    */
         TM    ACDSGET,B'00000100'                                 0476
         BNZ   @RT00476                                            0476
         TM    LST2SMD,B'01000000'                                 0476
         BO    @RF00476                                            0476
@RT00476 DS    0H                                                  0477
*     DO;                                                          0477
*       DO WHILE ACDSVALD=OFF       /*                               */
*             &ACDSEOF=OFF          /*                               */
*             &ACDSRC<STOPFUNC;     /*                               */
         B     @DE00478                                            0478
@DL00478 DS    0H                                                  0479
*         CALL LSTGET(HMASMIOP);    /* GET DIR. ENTRY FROM CDS       */
         ST    LST2IOP@,@AL00001                                   0479
         LA    @01,@AL00001                                        0479
         BAL   @14,LSTGET                                          0479
*         RFY                                                      0480
*           RTNCODE RSTD;                                          0480
*         IF RTNCODE>IOPEOF THEN    /* IO ERROR?                     */
         CH    RTNCODE,@CH00037                                    0481
         BNH   @RF00481                                            0481
*           DO;                                                    0482
*             ACDSRC=MAX(ACDSRC,RTNCODE);/* SET RETURN CODE          */
         CR    ACDSRC,RTNCODE                                      0483
         BNL   *+6
         LR    ACDSRC,RTNCODE                                      0483
*           END;                    /*                               */
*         IF RTNCODE=IOPEOF THEN    /* END OF FILE?                  */
@RF00481 CH    RTNCODE,@CH00037                                    0485
         BNE   @RF00485                                            0485
*           DO;                                                    0486
*             ACDSEOF=ON;           /* END OF FILE FOUND             */
         OI    ACDSEOF,B'00010000'                                 0487
*           END;                                                   0488
*         IF RTNCODE=ZERO THEN      /* ALL IS WELL?                  */
@RF00485 LTR   RTNCODE,RTNCODE                                     0489
         BNZ   @RF00489                                            0489
*           DO;                     /* YES,                          */
*             RFY                                                  0491
*               RTNCODE UNRSTD;                                    0491
*             IF LST2SMD=OFF THEN   /* 1ST SYSMOD NOT FOUND ON ACDS? */
         TM    LST2SMD,B'01000000'                                 0492
         BNZ   @RF00492                                            0492
*               DO;                                                0493
*                 IF LST2IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?*/
         CLI   IOPTYPE(LST2IOP@),11                                0494
         BNE   @RF00494                                            0494
*                   DO;                                            0495
*                     LST2SMD=ON;   /* 1ST ACDS SYSMOD FOUND         */
         OI    LST2SMD,B'01000000'                                 0496
*                   END;                                           0497
*                 ELSE                                             0498
*                   ;               /* NOT A SYSMOD TYPE             */
@RF00494 DS    0H                                                  0499
*               END;                                               0499
*             ELSE                  /* 1ST SYSMOD ALREADY FOUND      */
*               DO;                                                0500
         B     @RC00492                                            0500
@RF00492 DS    0H                                                  0501
*                 IF LST2IOP@->IOPTYPE^=IOPSMD THEN/* NOT A SYSMOD?  */
         CLI   IOPTYPE(LST2IOP@),11                                0501
         BE    @RF00501                                            0501
*                   DO;                                            0502
*                     ACDSEOF=ON;   /* END OF SYSMODS                */
         OI    ACDSEOF,B'00010000'                                 0503
*                   END;                                           0504
*               END;                                               0505
@RF00501 DS    0H                                                  0506
*             IF LST2IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?    */
@RC00492 CLI   IOPTYPE(LST2IOP@),11                                0506
         BNE   @RF00506                                            0506
*               DO;                                                0507
*                 ACDSVALD=ON;      /* VALID ENTRY FOUND             */
         OI    ACDSVALD,B'10000000'                                0508
*               END;                                               0509
*           END;                                                   0510
@RF00506 DS    0H                                                  0511
*       END;                                                       0511
@RF00489 DS    0H                                                  0511
@DE00478 TM    ACDSVALD,B'10000000'                                0511
         BNZ   @DC00478                                            0511
         TM    ACDSEOF,B'00010000'                                 0511
         BNZ   @DC00478                                            0511
         CH    ACDSRC,@CH00033                                     0511
         BL    @DL00478                                            0511
@DC00478 DS    0H                                                  0512
*     END;                                                         0512
*   RETURN CODE(ACDSRC);            /*                               */
@RF00476 LR    @15,ACDSRC                                          0513
         L     @14,@SA00007                                        0513
         LM    @00,@12,@SA00007+8                                  0513
         BR    @14                                                 0513
*   RFY                                                            0514
*     HMASMIOP BASED;                                              0514
*   END ACDSREAD;                   /*                               */
*LSTCHK:                                                           0516
*   PROC;                                                          0516
LSTCHK   STM   @14,@12,@SA00008                                    0516
*   DCL                                                            0517
*     LSTCRC FIXED(15);             /* LOCAL RETURN CODE             */
*   RFY                                                            0518
*     TSLPARMS BASED(TBLXTSLP);                                    0518
*   LSTCRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   LSTCRC,LSTCRC                                       0519
*                                                                  0520
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF DELTA 2 ENTRY IS NEEDED                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0520
*   RFY                                                            0520
*     HMASMIOP BASED(LST2IOP@);     /* ACDS IOP                      */
*   IF IOPERROR=ON                  /* IN ERROR ...                  */
*       ×IOPDBYP=ON THEN            /* ... OR IS DELETED?            */
         TM    IOPERROR(LST2IOP@),B'00010000'                      0521
         BO    @RT00521                                            0521
         TM    IOPDBYP(LST2IOP@),B'01000000'                       0521
         BNO   @RF00521                                            0521
@RT00521 DS    0H                                                  0522
*     DO;                           /* YES,                          */
*       LSTENT2=ON;                 /* ADD SYSMOD TO DELTA 2 LIST    */
         OI    LSTENT2,B'00000001'                                 0523
*     END;                                                         0524
*   CALL SELFND(LSTSMD1);           /* DETERMINE IF THE SYSMOD IS IN
*                                      THE SELECT LIST               */
@RF00521 LA    @10,LSTSMD1+4(,LST1IOP@)                            0525
         ST    @10,@AL00001                                        0525
         LA    @01,@AL00001                                        0525
         BAL   @14,SELFND                                          0525
*   RFY                                                            0526
*     RTNCODE RSTD;                                                0526
*   IF RTNCODE^=ZERO THEN           /* IN THE SELECT LIST?           */
         LTR   RTNCODE,RTNCODE                                     0527
         BZ    @RF00527                                            0527
*     DO;                           /* NO,                           */
*       IF RTNCODE>GTPNTFND THEN    /* RC OTHER THAN NOT FOUND?      */
         CH    RTNCODE,@CH00037                                    0529
         BNH   @RF00529                                            0529
*         DO;                       /* YES,                          */
*           LSTCRC=MAX(LSTCRC,RTNCODE);/*                            */
         CR    LSTCRC,RTNCODE                                      0531
         BNL   *+6
         LR    LSTCRC,RTNCODE                                      0531
*         END;                                                     0532
*       ELSE                                                       0533
*         ;                         /* NOT FOUND IN SELECT LIST      */
@RF00529 DS    0H                                                  0534
*     END;                                                         0534
*   ELSE                            /* NOT FOUND                     */
*     DO;                                                          0535
         B     @RC00527                                            0535
@RF00527 DS    0H                                                  0536
*       RFY                                                        0536
*         RTNCODE UNRSTD;                                          0536
*                                                                  0536
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MESSAGE 'HMA245I SYSMOD XXXXXXX SELECTED FOR RESTORE*/
*       /* HAS BEEN ACCEPTED                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0537
*       DO;                         /* HMASMPMG M1(HMA245I)M2(PART008
*                                      )TYPE(ERR)VAR(LSTSMD1)TARGET(S
*                                      YSOUT,LOG)                    */
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */
         XC    HMASMMGP(28),HMASMMGP                               0538
*         MGPMGNO1=HMA245I;         /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01237                                0539
*         MGPMGNO2=PART008;         /* SET UP MSG 2 CODE             */
         MVC   MGPMGNO2(2),@CH00055                                0540
*         MGPTYPE=MGPERR;           /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0541
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0543
*         MGPVARPT(1)=ADDR(LSTSMD1);/* SET VARIABLE PTR              */
         LA    @10,4                                               0544
         ALR   @10,LST1IOP@                                        0544
         ST    @10,MGPVARPT                                        0544
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */
         L     @15,@CV01229                                        0545
         LA    @01,@AL00545                                        0545
         BALR  @14,@15                                             0545
*       END;                        /*                               */
*       TSLFUNCT=TSLFFUNC;          /* CHECK FOR FUNCTION FAILURE    */
         L     @10,@PC00001                                        0547
         L     @10,TBLXTSLP(,@10)                                  0547
         MVI   TSLFUNCT(@10),X'07'                                 0547
*       TSLMTYPE=IOPPTYPE;          /* TYPE ...                      */
         L     @08,TSLPMLAD(,@10)                                  0548
         MVC   TSLMTYPE(1,@08),IOPPTYPE(LST2IOP@)                  0548
*       TSLMSMD=IOPNAM17;           /* ... AND NAME                  */
         MVC   TSLMSMD(7,@08),IOPNAM17(LST2IOP@)                   0549
*       CALL HMASMTSB(TSLPARMS);    /* ...                           */
         ST    @10,@AL00001                                        0550
         L     @15,@CV01232                                        0550
         LA    @01,@AL00001                                        0550
         BALR  @14,@15                                             0550
*       LSTCRC=MAX(LSTCRC,TSLRETRN);/* SET THE RETURN CODE           */
         L     @10,@PC00001                                        0551
         L     @10,TBLXTSLP(,@10)                                  0551
         SLR   @08,@08                                             0551
         IC    @08,TSLRETRN(,@10)                                  0551
         CR    LSTCRC,@08                                          0551
         BNL   *+6
         LR    LSTCRC,@08                                          0551
*     END;                                                         0552
*   RETURN CODE(LSTCRC);            /* RETURN W/ RC                  */
@RC00527 LR    @15,LSTCRC                                          0553
         L     @14,@SA00008                                        0553
         LM    @00,@12,@SA00008+8                                  0553
         BR    @14                                                 0553
*   RFY                                                            0554
*     HMASMIOP BASED;                                              0554
*   RFY                                                            0555
*     TSLPARMS BASED;                                              0555
*   END LSTCHK;                                                    0556
*   END LSTBLD;                                                    0557
*                                                                  0558
*/********************************************************************/
*/*                                                                  */
*/* SELCHK                                                           */
*/*                                                                  */
*/* INPUT - 1) SELECT/GROUP GTA FILE                                 */
*/*         2) PTF SECTION OF THE ICT                                */
*/*                                                                  */
*/* OUTPUT - 1) ERROR MESSAGE FOR EACH SYSMOD IN THE SELECT LIST AND */
*/*             NOT IN THE ICT FOR WHICH AN ERROR MESSAGE HAS NOT    */
*/*             ALREADY BEEN ISSUED                                  */
*/*          2) THE SELECT LIST AND THE RESTORE CANDIDATE FLAGS      */
*/*             WILL BE SET FOR EACH SYSMOD IN BOTH THE GTA FILE     */
*/*             AND THE ICT.                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0558
*SELCHK:                                                           0558
*   PROC;                                                          0558
SELCHK   STM   @14,@12,@SA00009                                    0558
*   DCL                                                            0559
*     SELCHKRC FIXED(15);           /* RETURN CODE                   */
*   DCL                                                            0560
*     1 SELCFLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 SELCEOF BIT(1),            /* END OF FILE ON SELEGCT/GROUP
*                                      GTA FILE                      */
*      2 * BIT(7);                  /* UNUSED                        */
*   RFY                                                            0561
*     HMASMGTP BASED(TBLXSEGT);                                    0561
*   RFY                                                            0562
*     HMASMSET BASED(GTPBUFAD);                                    0562
*   RFY                                                            0563
*     TSLPARMS BASED(TBLXTSLP);                                    0563
*   SELCHKRC=ZERO;                  /* CLEAR RETURN CODE             */
         SLR   SELCHKRC,SELCHKRC                                   0564
*   SELCFLGS=''B;                   /* CLEAR LOCAL FLAGS             */
         MVI   SELCFLGS,X'00'                                      0565
*   GTPFUNCT=GTPOPENN;              /* POSITION TO THE BEGINNING OF
*                                      THE SELECT/GROUP GTA FILE     */
         L     @10,@PC00001                                        0566
         L     @10,TBLXSEGT(,@10)                                  0566
         MVI   GTPFUNCT(@10),X'01'                                 0566
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */
         ST    @10,@AL00001                                        0567
         L     @15,@CV01233                                        0567
         LA    @01,@AL00001                                        0567
         BALR  @14,@15                                             0567
*   SELCEOF=OFF;                    /* CLEAR END OF FILE             */
         NI    SELCEOF,B'01111111'                                 0568
*   GTPFUNCT=GTPGETN;               /* FUNCTION IS GET NEXT          */
         L     @10,@PC00001                                        0569
         L     @10,TBLXSEGT(,@10)                                  0569
         MVI   GTPFUNCT(@10),X'08'                                 0569
*   DO WHILE(SELCEOF=OFF            /*                               */
*         &SELCHKRC<STOPFUNC);      /*                               */
         B     @DE00570                                            0570
@DL00570 DS    0H                                                  0571
*     CALL HMASMGTA(HMASMGTP);      /* GET NEXT LIST ENTRY           */
         L     @10,@PC00001                                        0571
         L     @10,TBLXSEGT(,@10)                                  0571
         ST    @10,@AL00001                                        0571
         L     @15,@CV01233                                        0571
         LA    @01,@AL00001                                        0571
         BALR  @14,@15                                             0571
*     IF GTPRETRN=GTPEOF THEN       /* END OF FILE?                  */
         L     @10,@PC00001                                        0572
         L     @10,TBLXSEGT(,@10)                                  0572
         CLI   GTPRETRN(@10),4                                     0572
         BNE   @RF00572                                            0572
*       DO;                         /* YES,                          */
*         SELCEOF=ON;               /* END OF FILE                   */
         OI    SELCEOF,B'10000000'                                 0574
*       END;                                                       0575
*     ELSE                          /* NOT END OF FILE               */
*       DO;                                                        0576
*                                                                  0576
         B     @RC00572                                            0576
@RF00572 DS    0H                                                  0577
*         /***********************************************************/
*         /*                                                         */
*         /* SEARCH FOR THE SELECTED SYSMOD IN THE ICT               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0577
*         TSLICTSR=''B;             /* CLEAR THE PARMLIST            */
         L     @10,@PC00001                                        0577
         L     @08,TBLXTSLP(,@10)                                  0577
         L     @03,TSLPMLAD(,@08)                                  0577
         XC    TSLICTSR(14,@03),TSLICTSR(@03)                      0577
*         TSLFUNCT=TSLFISRH;        /* SEARCH THE ICT                */
         MVI   TSLFUNCT(@08),X'01'                                 0578
*         TSLISMD=SESMDNO;          /* SEARCH FOR SELECT/GROUP LIST
*                                      SYSMOD                        */
         L     @10,TBLXSEGT(,@10)                                  0579
         L     @10,GTPBUFAD(,@10)                                  0579
         MVC   TSLISMD(7,@03),SESMDNO(@10)                         0579
*         CALL HMASMTSB(TSLPARMS);  /* ...                           */
         ST    @08,@AL00001                                        0580
         L     @15,@CV01232                                        0580
         LA    @01,@AL00001                                        0580
         BALR  @14,@15                                             0580
*         IF TSLIFND=ON THEN        /* FOUND IN THE ICT?             */
         L     @10,@PC00001                                        0581
         L     @10,TBLXTSLP(,@10)                                  0581
         L     @10,TSLPMLAD(,@10)                                  0581
         TM    TSLIFND(@10),B'10000000'                            0581
         BNO   @RF00581                                            0581
*           DO;                     /* YES,                          */
*             RFY                                                  0583
*               ICTPTF BASED(TSLICTP);                             0583
*             ICTPSLST(1)=ON;       /* SYSMOD IN SELECT/GROUP LIST   */
         L     @10,TSLICTP(,@10)                                   0584
         OI    ICTPSLST(@10),B'00000010'                           0584
*             ICTPRCND(1)=ON;       /* SYSMOD IS CANDIDATE           */
         OI    ICTPRCND(@10),B'00010000'                           0585
*             RFY                                                  0586
*               ICTPTF BASED;                                      0586
*           END;                                                   0587
*         ELSE                      /* NOT FOUND IN ICT THEN THERE IS
*                                      AN ERROR                      */
*           DO;                                                    0588
         B     @RC00581                                            0588
@RF00581 DS    0H                                                  0589
*             IF SEFLAG2A=OFF THEN  /* ERROR MESSAGE NOT ISSUED?     */
         L     @10,@PC00001                                        0589
         L     @08,TBLXSEGT(,@10)                                  0589
         L     @08,GTPBUFAD(,@08)                                  0589
         TM    SEFLAG2A(@08),B'10000000'                           0589
         BNZ   @RF00589                                            0589
*               DO;                 /* YES,                          */
*                                                                  0590
*                 /***************************************************/
*                 /*                                                 */
*                 /* ISSUE MESSAGE 'HMA245I SYSMOD XXXXXXX SELECTED  */
*                 /* FOR RESTORE IS NOT APPLIED                      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0591
*                 DO;               /* HMASMPMG M1(HMA245I)M2(PART007
*                                      )TYPE(ERR)VAR(SESMDNO,TBLXFUNC
*                                      ,CCADSIDA(IOPCDS))TARGET(SYSOU
*                                      T,LOG)                        */
*                   HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS*/
         XC    HMASMMGP(28),HMASMMGP                               0592
*                   MGPMGNO1=HMA245I;/* SET UP MSG 1 CODE            */
         MVC   MGPMGNO1(2),@CH01237                                0593
*                   MGPMGNO2=PART007;/* SET UP MSG 2 CODE            */
         MVC   MGPMGNO2(2),@CH00065                                0594
*                   MGPTYPE=MGPERR; /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0595
*                   MGPPRINT='1'B;  /* SET TARGET FLAG               */
*                   MGPHLDS='1'B;   /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0597
*                   MGPVARPT(1)=ADDR(SESMDNO);/* SET VARIABLE PTR    */
         LA    @08,SESMDNO(,@08)                                   0598
         ST    @08,MGPVARPT                                        0598
*                   MGPVARPT(2)=ADDR(TBLXFUNC);/* SET VARIABLE PTR   */
         LA    @10,TBLXFUNC(,@10)                                  0599
         ST    @10,MGPVARPT+4                                      0599
*                   MGPVARPT(3)=ADDR(CCADSIDA(IOPCDS));/* SET      0600
*                                      VARIABLE PTR                  */
         L     @10,CCADSAD(,CCAPTR)                                0600
         LA    @10,CCADSIDA+8(,@10)                                0600
         ST    @10,MGPVARPT+8                                      0600
*                   CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED   */
         L     @15,@CV01229                                        0601
         LA    @01,@AL00601                                        0601
         BALR  @14,@15                                             0601
*                 END;              /*                               */
*                 SELCHKRC=STOPSMD; /* SET THE RETURN CODE           */
         LA    SELCHKRC,8                                          0603
*               END;                                               0604
*             ELSE                                                 0605
*               ;                   /* ERROR MESSAGE ALREADY ISSUED  */
@RF00589 DS    0H                                                  0606
*           END;                                                   0606
*       END;                                                       0607
@RC00581 DS    0H                                                  0608
*   END;                            /* END OF SELECT LIST PROCESSING */
@RC00572 DS    0H                                                  0608
@DE00570 TM    SELCEOF,B'10000000'                                 0608
         BNZ   @DC00570                                            0608
         CH    SELCHKRC,@CH00033                                   0608
         BL    @DL00570                                            0608
@DC00570 DS    0H                                                  0609
*   RETURN CODE(SELCHKRC);          /* RETURN W/ RC                  */
         LR    @15,SELCHKRC                                        0609
         L     @14,@SA00009                                        0609
         LM    @00,@12,@SA00009+8                                  0609
         BR    @14                                                 0609
*   RFY                                                            0610
*     HMASMGTP BASED;                                              0610
*   RFY                                                            0611
*     HMASMSET BASED;                                              0611
*   RFY                                                            0612
*     TSLPARMS BASED;                                              0612
*   END SELCHK;                                                    0613
*                                                                  0614
*   /*****************************************************************/
*   /*                                                               */
*   /* SMDICT                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0614
*SMDICT:                                                           0614
*   PROC(SMDIIOP);                                                 0614
SMDICT   STM   @14,@12,@SA00010                                    0614
         MVC   @PC00010(4),0(@01)                                  0614
*   DCL                                                            0615
*     SMDIIOP CHAR(*);              /* EXTENDED IOP WITH DIR. ENTRY
*                                      FOR SYSMOD                    */
*   DCL                                                            0616
*     SMDICTRC FIXED(15);           /* RETURN CODE                   */
*   DCL                                                            0617
*     SMDICT@ PTR(31);              /* ADDRESS OF THE CURRENT ICT  0617
*                                      ENTRY                         */
*   DCL                                                            0618
*     1 SMDIFLGS,                   /* LOCAL FLAGS                   */
*      2 SRELFND BIT(1),            /* SREL IOP SUB-ENTRY FOUND      */
*      2 * BIT(7);                  /* UNUSED                        */
*   DCL                                                            0619
*     SMDTYPE CHAR(1) CONSTANT('P');/* ICT ENTRY TYPE IS SYSMOD      */
*   RFY                                                            0620
*     HMASMIOP BASED(ADDR(SMDIIOP));/* EXTENDED IOP                  */
*   SMDICTRC=ZERO;                  /* CLEAR RETURN CODE             */
*                                                                  0621
         SLR   SMDICTRC,SMDICTRC                                   0621
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE AN ICT ENTRY                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0622
*   SMDICT@=TBLXTOP;                /* PTR TO SYSMOD ENTRY TO BE   0622
*                                      CREATED                       */
         L     @10,@PC00001                                        0622
         MVC   SMDICT@(4),TBLXTOP(@10)                             0622
*   CALL HMASMTAD(TBLXPARM,SMDTYPE,IOPNAM17);                      0623
         ST    @10,@AL00001                                        0623
         LA    @10,@CC01388                                        0623
         ST    @10,@AL00001+4                                      0623
         L     @10,@PC00010                                        0623
         LA    @10,IOPNAM17(,@10)                                  0623
         ST    @10,@AL00001+8                                      0623
         L     @15,@CV01230                                        0623
         LA    @01,@AL00001                                        0623
         BALR  @14,@15                                             0623
*   ;                                                              0624
*                                                                  0624
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THE EXTENDED IOP ENTRY FROM THE CDS                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0625
*   IOPFUNCT=IOPXTND;               /* GET EXTENDED PORTION OF SYSMOD*/
         L     @10,@PC00010                                        0625
         MVI   IOPFUNCT(@10),X'07'                                 0625
*   CALL HMASMIO(HMASMIOP);                                        0626
         ST    @10,@AL00001                                        0626
         L     @15,@CV01228                                        0626
         LA    @01,@AL00001                                        0626
         BALR  @14,@15                                             0626
*   IF IOPRETRN>ZERO THEN           /* ALL IS WELL?                  */
         L     @10,@PC00010                                        0627
         CLI   IOPRETRN(@10),0                                     0627
         BNH   @RF00627                                            0627
*     DO;                           /* NO,                           */
*       SMDICTRC=MAX(SMDICTRC,IOPRETRN);/* SET RETURN CODE           */
         SLR   @08,@08                                             0629
         IC    @08,IOPRETRN(,@10)                                  0629
         CR    SMDICTRC,@08                                        0629
         BNL   *+6
         LR    SMDICTRC,@08                                        0629
*     END;                                                         0630
*   ELSE                            /* IO WAS SUCCESSFUL             */
*     DO;                           /*                               */
         B     @RC00627                                            0631
@RF00627 DS    0H                                                  0632
*       IF SMDICTRC=ZERO THEN       /* NO ERROR?                     */
         LTR   SMDICTRC,SMDICTRC                                   0632
         BNZ   @RF00632                                            0632
*         DO;                       /* YES,                          */
*                                                                  0633
*           /*********************************************************/
*           /*                                                       */
*           /* BUILD THE SYMOD ENTRY BY CALLING HMASMTEC             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0634
*           CALL HMASMTEC(TBLXPARM,SMDICT@,HMASMIOP,/*               */
*               ZERO);              /* NO ++VER NUMBER BEING SUPPLIED*/
         L     @10,@PC00001                                        0634
         ST    @10,@AL00001                                        0634
         LA    @10,SMDICT@                                         0634
         ST    @10,@AL00001+4                                      0634
         L     @10,@PC00010                                        0634
         ST    @10,@AL00001+8                                      0634
         LA    @10,@CF00081                                        0634
         ST    @10,@AL00001+12                                     0634
         L     @15,@CV01231                                        0634
         LA    @01,@AL00001                                        0634
         BALR  @14,@15                                             0634
*           RFY                                                    0635
*             RTNCODE RSTD;                                        0635
*           SMDICTRC=MAX(SMDICTRC,RTNCODE);/* SAVE BUILD RETURN CODE */
         CR    SMDICTRC,RTNCODE                                    0636
         BNL   *+6
         LR    SMDICTRC,RTNCODE                                    0636
*           RFY                                                    0637
*             RTNCODE UNRSTD;                                      0637
*         END;                                                     0638
*     END;                                                         0639
@RF00632 DS    0H                                                  0640
*   RETURN CODE(SMDICTRC);                                         0640
@RC00627 LR    @15,SMDICTRC                                        0640
         L     @14,@SA00010                                        0640
         LM    @00,@12,@SA00010+8                                  0640
         BR    @14                                                 0640
*   RFY                                                            0641
*     HMASMIOP BASED;                                              0641
*   END SMDICT;                                                    0642
*                                                                  0643
*/********************************************************************/
*/*                                                                  */
*/* A SYSMOD WILL APPEAR IN THE DELTA 2 LIST IF                      */
*/*   - THE SYSMOD APEARS IN THE ACDS BUT NOT THE CDS                */
*/*   - THE SYSMOD APEARS IN THE ACDS AND IN THE CDS AS DELETE ????  */
*/*   - THE SYSMOD APEARS IN THE ACDS AND IN THE CDS AS IN ERROR ????*/
*/*                                                                  */
*/* NOTE: IT IS ASSUMED THAT THE D2 GTP IS SETUP EXTERNALLY (HMASMTBL)
*                                                                    */
*/********************************************************************/
*                                                                  0643
*DELTA2BL:                                                         0643
*   PROC(DT2IOP);                   /* IOP CONTAINING ACDS DIRECTORY
*                                      ENTRY FOR SYSMOND             */
DELTA2BL STM   @14,@12,@SA00011                                    0643
         MVC   @PC00011(4),0(@01)                                  0643
*   DCL                                                            0644
*     DT2IOP CHAR(*);               /* FIXED IOP W/ ACDS SYSMOD    0644
*                                      DIRIRECTORY ENTRY             */
*   DCL                                                            0645
*     DT2RC FIXED(15);              /* RETURN CODE                   */
*   RFY                                                            0646
*     HMASMIOP BASED(ADDR(DT2IOP));                                0646
*   RFY                                                            0647
*     HMASMGTP BASED(TBLXD2GT);                                    0647
*   RFY                                                            0648
*     D2RCRD BASED(GTPBUFAD);                                      0648
*   DT2RC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   DT2RC,DT2RC                                         0649
*   D2RCRD=''B;                     /* CLEAR THE RECORD              */
         L     @10,@PC00001                                        0650
         L     @10,TBLXD2GT(,@10)                                  0650
         L     @10,GTPBUFAD(,@10)                                  0650
         XC    D2RCRD(8,@10),D2RCRD(@10)                           0650
*   D2RSMD=IOPNAM17;                /* SYSMOD NAME                   */
         L     @08,@PC00011                                        0651
         MVC   D2RSMD(7,@10),IOPNAM17(@08)                         0651
*   IF IOPERROR=ON THEN             /* SYSMOD IN ERROR?              */
         TM    IOPERROR(@08),B'00010000'                           0652
         BNO   @RF00652                                            0652
*     DO;                           /* YES,                          */
*       D2RFERR=ON;                 /* SET ERROR FLAG IN DELTA 2   0654
*                                      RECORD                        */
         OI    D2RFERR(@10),B'01000000'                            0654
*     END;                                                         0655
*   ELSE                            /* NOT IN ERROR                  */
*     DO;                                                          0656
         B     @RC00652                                            0656
@RF00652 DS    0H                                                  0657
*       IF IOPDBYP=ON THEN          /* SYSMOD DELETED                */
         L     @10,@PC00011                                        0657
         TM    IOPDBYP(@10),B'01000000'                            0657
         BNO   @RF00657                                            0657
*         DO;                       /* YES,                          */
*           D2RFDEL=ON;             /* SET DELETE FLAG IN DELTA 2  0659
*                                      RECORD                        */
         L     @10,@PC00001                                        0659
         L     @10,TBLXD2GT(,@10)                                  0659
         L     @10,GTPBUFAD(,@10)                                  0659
         OI    D2RFDEL(@10),B'00100000'                            0659
*         END;                                                     0660
*       ELSE                        /* NOT DELETED                   */
*         DO;                                                      0661
         B     @RC00657                                            0661
@RF00657 DS    0H                                                  0662
*           D2RFOK=ON;              /* SET OK FLAG IN DELTA 2 RECORD */
         L     @10,@PC00001                                        0662
         L     @10,TBLXD2GT(,@10)                                  0662
         L     @10,GTPBUFAD(,@10)                                  0662
         OI    D2RFOK(@10),B'10000000'                             0662
*         END;                                                     0663
*     END;                          /*                               */
@RC00657 DS    0H                                                  0665
*   GTPFUNCT=GTPADD;                /* ADD THE RECORD                */
@RC00652 L     @10,@PC00001                                        0665
         L     @10,TBLXD2GT(,@10)                                  0665
         MVI   GTPFUNCT(@10),X'04'                                 0665
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */
         ST    @10,@AL00001                                        0666
         L     @15,@CV01233                                        0666
         LA    @01,@AL00001                                        0666
         BALR  @14,@15                                             0666
*   DT2RC=MAX(DT2RC,GTPRETRN);      /* SAVE THE RETURN CODE          */
         L     @10,@PC00001                                        0667
         L     @10,TBLXD2GT(,@10)                                  0667
         SLR   @08,@08                                             0667
         IC    @08,GTPRETRN(,@10)                                  0667
         CR    DT2RC,@08                                           0667
         BNL   *+6
         LR    DT2RC,@08                                           0667
*   RETURN CODE(DT2RC);                                            0668
         LR    @15,DT2RC                                           0668
         L     @14,@SA00011                                        0668
         LM    @00,@12,@SA00011+8                                  0668
         BR    @14                                                 0668
*   RFY                                                            0669
*     HMASMIOP BASED;                                              0669
*   RFY                                                            0670
*     HMASMGTP BASED;                                              0670
*   RFY                                                            0671
*     D2RCRD BASED;                                                0671
*   END DELTA2BL;                                                  0672
*                                                                  0673
*/********************************************************************/
*/*                                                                  */
*/* GROUP - ADD CANDIDATES TO ICT FOR GROUP PROCESSING               */
*/*                                                                  */
*/* INPUT:                                                           */
*/*         - ICT PTF SECTION CONTAINING ALL SYSMODS THAT MAY BE     */
*/*           RESTORED.  IN ADDITION, SYSMODS IN THE CANDIDATE LIST  */
*/*           WILL BE MARKED AS CANDIDATES                           */
*/* OUTPUT:                                                          */
*/*         - ICT PTF SECTION SYSMOD CANDIDATE FLAG.  THE CANDIDATE  */
*/*           WILL BE SET FOR ANY SYSMOD THAT MEETS ONE OF THE       */
*/*           FOLLOWING:                                             */
*/*             1) FMID'S A CANDIDATE                                */
*/*             2) REQ'S                                             */
*/*                - IS A REQ OF A CANDIDATE SYSMOD                  */
*/*                - REQ'S A CANDIDATE SYSMOD                        */
*/*             3) IFREQ'S                                           */
*/*                - IS AN IFREQ OF A CANDIDATE SYSMOD               */
*/*                - IFREQ'S A CANDIDATE SYSMOD                      */
*/*             4) PRE'S A CANDIDATE SYSMOD                          */
*/*             5) SUP'S A CANDIDATE SYSMOD                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0673
*GROUP:                                                            0673
*   PROC;                                                          0673
GROUP    STM   @14,@12,@SA00012                                    0673
*   DCL                                                            0674
*     GRPRC FIXED(15);              /* LOCAL RETURN CODE             */
*   DCL                                                            0675
*     GRPPTFX FIXED(31);            /* ICT PTF ENTRY INDEX COUNTER   */
*   DCL                                                            0676
*     GRPX2 FIXED(31);              /* 2ND ICT PTF ENTRY INDEX     0676
*                                      COUNTER                       */
*   DCL                                                            0677
*     1 GRPFLAGS BIT(8),            /* LOCAL CONTROL FLAGS           */
*       3 GRPADD BIT(1),            /* ONE OR MORE CANDIDATES WAS  0677
*                                      ADDED TO THE ICT              */
*       3 * BIT(7);                 /* UNUSED                        */
*   RFY                                                            0678
*     ICTPTF BASED(CCAICPTF);                                      0678
*   GRPRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   GRPRC,GRPRC                                         0679
*   GRPFLAGS=''B;                   /* CLEAR LOCAL FLAGS             */
         MVI   GRPFLAGS,X'00'                                      0680
*                                                                  0681
*   /*****************************************************************/
*   /*                                                               */
*   /* ADD REQUISITS AS CANDIDATES ALL ENTRIES IN ICT ARE REPROCESSED*/
*   /* UNTIL NO CHANGE OCCURS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0681
*   GRPADD=ON;                      /* INIT SO THAT ATLEAS ONE PASS
*                                      IS MADE THRU ICT              */
         OI    GRPADD,B'10000000'                                  0681
*   DO WHILE(GRPADD=ON&             /* PROCESS UNTIL NO NEW ENTRY IS
*                                      ADDED                         */
*         GRPRC<STOPFUNC);                                         0682
         B     @DE00682                                            0682
@DL00682 DS    0H                                                  0683
*     GRPADD=OFF;                   /* ASSUME NONE ADDED             */
*                                                                  0683
         NI    GRPADD,B'01111111'                                  0683
*     /***************************************************************/
*     /*                                                             */
*     /* MARK SYSMODS WHICH FMID A SYSMOD IN THE SELECT LIST AS A    */
*     /* CANDIDATE                                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0684
*     DO GRPPTFX=1 BY 1             /*                               */
*           WHILE(ICTPEND(GRPPTFX)^=ICTENDNT/*                       */
*           &GRPRC<STOPFUNC);                                      0684
         LA    GRPPTFX,1                                           0684
         B     @DE00684                                            0684
@DL00684 DS    0H                                                  0685
*       IF ICTPTYPE(GRPPTFX)=IOPPFUNC/* FUNCTION SYSMOD ...          */
*           &ICTPRCND(GRPPTFX)=ON THEN/* ... AND A CANDIDATE?        */
         LR    @10,GRPPTFX                                         0685
         MH    @10,@CH01508                                        0685
         L     @08,CCAICPTF(,CCAPTR)                               0685
         LA    @05,0(@10,@08)                                      0685
         AL    @05,@CF01531                                        0685
         SLR   @02,@02                                             0685
         IC    @02,ICTPTYPE-17(,@05)                               0685
         CH    @02,@CH00037                                        0685
         BNE   @RF00685                                            0685
         ALR   @08,@10                                             0685
         AL    @08,@CF01532                                        0685
         TM    ICTPRCND-12(@08),B'00010000'                        0685
         BNO   @RF00685                                            0685
*         DO;                       /* YES,                          */
*           DO GRPX2=1 BY 1         /* CHECK ALL SYSMODS IN THE ICT  */
*                 WHILE(ICTPEND(GRPX2)^=ICTENDNT/*                   */
*                 &GRPRC<STOPFUNC);                                0687
         LA    GRPX2,1                                             0687
         B     @DE00687                                            0687
@DL00687 DS    0H                                                  0688
*             IF ICTPFMID(GRPX2)=ICTPTFS(GRPPTFX)/* FMID'S CURRENT 0688
*                                      FUNC                          */
*                 &GRPX2^=GRPPTFX THEN/* ... AND NOT SAME SYSMOD?    */
         LA    @10,116                                             0688
         LR    @01,GRPX2                                           0688
         MR    @00,@10                                             0688
         L     @08,CCAICPTF(,CCAPTR)                               0688
         LR    @07,@10                                             0688
         MR    @06,GRPPTFX                                         0688
         ST    @01,@TF00001                                        0688
         ALR   @01,@08                                             0688
         AL    @01,@CF01533                                        0688
         ALR   @07,@08                                             0688
         AL    @07,@CF01534                                        0688
         CLC   ICTPFMID-22(7,@01),ICTPTFS(@07)                     0688
         BNE   @RF00688                                            0688
         CR    GRPX2,GRPPTFX                                       0688
         BE    @RF00688                                            0688
*               DO;                 /* YES,                          */
*                 IF ICTPRCND(GRPX2)^=ON THEN/* NOT CANDIDATE?       */
         LR    @10,@08                                             0690
         AL    @10,@TF00001                                        0690
         AL    @10,@CF01532                                        0690
         TM    ICTPRCND-12(@10),B'00010000'                        0690
         BO    @RF00690                                            0690
*                   DO;             /* YES,                          */
*                     ICTPRCND(GRPX2)=ON;/* MARK AS CANDIDATE        */
         AL    @08,@TF00001                                        0692
         AL    @08,@CF01532                                        0692
         OI    ICTPRCND-12(@08),B'00010000'                        0692
*                     GRPADD=ON;    /* SYSMOD GROUP MEMBER ADDED     */
         OI    GRPADD,B'10000000'                                  0693
*                   END;                                           0694
*                 ELSE                                             0695
*                   ;               /* ALREADY A CANDIDATE           */
@RF00690 DS    0H                                                  0696
*               END;                                               0696
*           END;                                                   0697
@RF00688 AH    GRPX2,@CH00063                                      0697
@DE00687 LR    @10,GRPX2                                           0697
         MH    @10,@CH01508                                        0697
         L     @08,CCAICPTF(,CCAPTR)                               0697
         AL    @08,@CF01534                                        0697
         L     @10,ICTPEND(@10,@08)                                0697
         CL    @10,ICTENDNT                                        0697
         BE    @DC00687                                            0697
         CH    GRPRC,@CH00033                                      0697
         BL    @DL00687                                            0697
@DC00687 DS    0H                                                  0698
*         END;                                                     0698
*       ELSE                                                       0699
*         ;                         /* NOT A CANDIDATE FUNCTION    0699
*                                      SYSMOD                        */
@RF00685 DS    0H                                                  0700
*     END;                                                         0700
         AH    GRPPTFX,@CH00063                                    0700
@DE00684 LR    @10,GRPPTFX                                         0700
         MH    @10,@CH01508                                        0700
         L     @08,CCAICPTF(,CCAPTR)                               0700
         AL    @08,@CF01534                                        0700
         L     @10,ICTPEND(@10,@08)                                0700
         CL    @10,ICTENDNT                                        0700
         BE    @DC00684                                            0700
         CH    GRPRC,@CH00033                                      0700
         BL    @DL00684                                            0700
@DC00684 DS    0H                                                  0701
*     DO GRPPTFX=1 BY 1 WHILE(ICTPEND(GRPPTFX)^=ICTENDNT/*           */
*           &GRPRC<STOPFUNC);                                      0701
         LA    GRPPTFX,1                                           0701
         B     @DE00701                                            0701
@DL00701 DS    0H                                                  0702
*       IF ICTPRCND(GRPPTFX)=ON THEN/* ... AND A CANDIDATE?          */
         LR    @10,GRPPTFX                                         0702
         MH    @10,@CH01508                                        0702
         L     @08,CCAICPTF(,CCAPTR)                               0702
         ST    @10,@TF00001                                        0702
         ALR   @10,@08                                             0702
         AL    @10,@CF01532                                        0702
         TM    ICTPRCND-12(@10),B'00010000'                        0702
         BNO   @RF00702                                            0702
*         DO;                       /* YES,                          */
*                                                                  0703
*           /*********************************************************/
*           /*                                                       */
*           /* MARK REQ'ED SYSMODS AS CANDIDATES                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0704
*           CALL SETCAND(ICTPRCHN(GRPPTFX),TPRREQI);               0704
         L     @10,@TF00001                                        0704
         AL    @08,@CF01535                                        0704
         LA    @10,ICTPRCHN-68(@10,@08)                            0704
         ST    @10,@AL00001                                        0704
         LA    @10,@CF00063                                        0704
         ST    @10,@AL00001+4                                      0704
         LA    @01,@AL00001                                        0704
         BAL   @14,SETCAND                                         0704
*           RFY                                                    0705
*             RTNCODE RSTD;                                        0705
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */
         LTR   RTNCODE,RTNCODE                                     0706
         BNZ   @RF00706                                            0706
*             DO;                   /* YES,                          */
*               RFY                                                0708
*                 RTNCODE UNRSTD;                                  0708
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */
         OI    GRPADD,B'10000000'                                  0709
*             END;                                                 0710
*           CALL SETCAND2(ICTPTF(GRPPTFX),/*                         */
*               ADDR(ICTPRCHN(1))-ADDR(ICTPTF(1)));                0711
@RF00706 LR    @10,GRPPTFX                                         0711
         MH    @10,@CH01508                                        0711
         L     @08,CCAICPTF(,CCAPTR)                               0711
         AL    @10,@CF01534                                        0711
         LA    @10,ICTPTF(@10,@08)                                 0711
         ST    @10,@AL00001                                        0711
         LA    @10,ICTPRCHN(,@08)                                  0711
         SLR   @10,@08                                             0711
         ST    @10,@AFTEMPS                                        0711
         LA    @10,@AFTEMPS                                        0711
         ST    @10,@AL00001+4                                      0711
         LA    @01,@AL00001                                        0711
         BAL   @14,SETCAND2                                        0711
*           RFY                                                    0712
*             RTNCODE RSTD;                                        0712
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */
         LTR   RTNCODE,RTNCODE                                     0713
         BNZ   @RF00713                                            0713
*             DO;                   /* YES,                          */
*               RFY                                                0715
*                 RTNCODE UNRSTD;                                  0715
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */
         OI    GRPADD,B'10000000'                                  0716
*             END;                                                 0717
*                                                                  0717
*           /*********************************************************/
*           /*                                                       */
*           /* MARK IF REQ'ED SYSMODS AS CANDIDATES                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0718
*           CALL SETCAND(ICTPICHN(GRPPTFX),TPRIRQI);               0718
@RF00713 LR    @10,GRPPTFX                                         0718
         MH    @10,@CH01508                                        0718
         L     @08,CCAICPTF(,CCAPTR)                               0718
         AL    @08,@CF01536                                        0718
         LA    @10,ICTPICHN-80(@10,@08)                            0718
         ST    @10,@AL00001                                        0718
         LA    @10,@CF00273                                        0718
         ST    @10,@AL00001+4                                      0718
         LA    @01,@AL00001                                        0718
         BAL   @14,SETCAND                                         0718
*           RFY                                                    0719
*             RTNCODE RSTD;                                        0719
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */
         LTR   RTNCODE,RTNCODE                                     0720
         BNZ   @RF00720                                            0720
*             DO;                   /* YES,                          */
*               RFY                                                0722
*                 RTNCODE UNRSTD;                                  0722
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */
         OI    GRPADD,B'10000000'                                  0723
*             END;                                                 0724
*           CALL SETCAND2(ICTPTF(GRPPTFX),/*                         */
*               ADDR(ICTPICHN(1))-ADDR(ICTPTF(1)));                0725
@RF00720 LR    @10,GRPPTFX                                         0725
         MH    @10,@CH01508                                        0725
         L     @08,CCAICPTF(,CCAPTR)                               0725
         AL    @10,@CF01534                                        0725
         LA    @10,ICTPTF(@10,@08)                                 0725
         ST    @10,@AL00001                                        0725
         LA    @10,ICTPICHN(,@08)                                  0725
         SLR   @10,@08                                             0725
         ST    @10,@AFTEMPS                                        0725
         LA    @10,@AFTEMPS                                        0725
         ST    @10,@AL00001+4                                      0725
         LA    @01,@AL00001                                        0725
         BAL   @14,SETCAND2                                        0725
*           RFY                                                    0726
*             RTNCODE RSTD;                                        0726
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */
         LTR   RTNCODE,RTNCODE                                     0727
         BNZ   @RF00727                                            0727
*             DO;                   /* YES,                          */
*               RFY                                                0729
*                 RTNCODE UNRSTD;                                  0729
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */
         OI    GRPADD,B'10000000'                                  0730
*             END;                                                 0731
*                                                                  0731
*           /*********************************************************/
*           /*                                                       */
*           /* MARK PREBY SYSMODS AS CANDIDATES                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0732
*           CALL SETCAND2(ICTPTF(GRPPTFX),/*                         */
*               ADDR(ICTPPCHN(1))-ADDR(ICTPTF(1)));                0732
@RF00727 LR    @10,GRPPTFX                                         0732
         MH    @10,@CH01508                                        0732
         L     @08,CCAICPTF(,CCAPTR)                               0732
         AL    @10,@CF01534                                        0732
         LA    @10,ICTPTF(@10,@08)                                 0732
         ST    @10,@AL00001                                        0732
         LA    @10,ICTPPCHN(,@08)                                  0732
         SLR   @10,@08                                             0732
         ST    @10,@AFTEMPS                                        0732
         LA    @10,@AFTEMPS                                        0732
         ST    @10,@AL00001+4                                      0732
         LA    @01,@AL00001                                        0732
         BAL   @14,SETCAND2                                        0732
*           RFY                                                    0733
*             RTNCODE RSTD;                                        0733
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */
         LTR   RTNCODE,RTNCODE                                     0734
         BNZ   @RF00734                                            0734
*             DO;                   /* YES,                          */
*               RFY                                                0736
*                 RTNCODE UNRSTD;                                  0736
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */
         OI    GRPADD,B'10000000'                                  0737
*             END;                                                 0738
*                                                                  0738
*           /*********************************************************/
*           /*                                                       */
*           /* MARK SUP'ING SYSMODS AS CANDIDATES                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0739
*           CALL SETCAND2(ICTPTF(GRPPTFX),/*                         */
*               ADDR(ICTPSCHN(1))-ADDR(ICTPTF(1)));                0739
@RF00734 LR    @10,GRPPTFX                                         0739
         MH    @10,@CH01508                                        0739
         L     @08,CCAICPTF(,CCAPTR)                               0739
         AL    @10,@CF01534                                        0739
         LA    @10,ICTPTF(@10,@08)                                 0739
         ST    @10,@AL00001                                        0739
         LA    @10,ICTPSCHN(,@08)                                  0739
         SLR   @10,@08                                             0739
         ST    @10,@AFTEMPS                                        0739
         LA    @10,@AFTEMPS                                        0739
         ST    @10,@AL00001+4                                      0739
         LA    @01,@AL00001                                        0739
         BAL   @14,SETCAND2                                        0739
*           RFY                                                    0740
*             RTNCODE RSTD;                                        0740
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */
         LTR   RTNCODE,RTNCODE                                     0741
         BNZ   @RF00741                                            0741
*             DO;                   /* YES,                          */
*               RFY                                                0743
*                 RTNCODE UNRSTD;                                  0743
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */
         OI    GRPADD,B'10000000'                                  0744
*             END;                                                 0745
*         END;                                                     0746
*       ELSE                                                       0747
*         ;                         /* SYSMOD IS NOT A CANDIDATE,  0747
*                                      CONTINUE                      */
@RF00702 DS    0H                                                  0748
*     END;                          /* END OF PROCESS ALL SYSMODS  0748
*                                      LOOP                          */
@RC00702 AL    GRPPTFX,@CF00063                                    0748
@DE00701 LR    @10,GRPPTFX                                         0748
         MH    @10,@CH01508                                        0748
         L     @08,CCAICPTF(,CCAPTR)                               0748
         AL    @08,@CF01534                                        0748
         L     @10,ICTPEND(@10,@08)                                0748
         CL    @10,ICTENDNT                                        0748
         BE    @DC00701                                            0748
         CH    GRPRC,@CH00033                                      0748
         BL    @DL00701                                            0748
@DC00701 DS    0H                                                  0749
*   END;                            /* END OF ALL CHANGES            */
@DE00682 TM    GRPADD,B'10000000'                                  0749
         BNO   @DC00682                                            0749
         CH    GRPRC,@CH00033                                      0749
         BL    @DL00682                                            0749
@DC00682 DS    0H                                                  0750
*   RETURN CODE(GRPRC);             /* RETURN W/ RC                  */
         LR    @15,GRPRC                                           0750
         L     @14,@SA00012                                        0750
         LM    @00,@12,@SA00012+8                                  0750
         BR    @14                                                 0750
*   RFY                                                            0751
*     ICTPTF BASED(CCAICPTF);                                      0751
*                                                                  0752
*/********************************************************************/
*/* SETCAND - MARK SYSMODS IN AN INDEX LIST AS CANDIDATES            */
*/*                                                                  */
*/* INPUT - INDEX LIST POINTER                                       */
*/*                                                                  */
*/* OUTPUT - EACH SYSMOD IN THE INDEX LIST WILL BE MARKED AS RESTORE */
*/*       CANDIDATE IF IT IS FOUND IN THE ICT (ICTPRCND).            */
*/*                                                                  */
*/*       RC = 0 ONE OR MORE SYSMODS IN THE INDEX LIST WAS FOUND AND */
*/*              WAS NOT ALREADY A CANDIDATE                         */
*/*       RC = 4 NO SYSMOD IN THE INDEX LIST, OR                     */
*/*              NO SYSMOD WAS FOUND IN THE ICT THAT WAS NOT ALREADY */
*/*              A CANDIDATE                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0752
*SETCAND:                                                          0752
*   PROC(SETNDX@,                   /* PTR TO INDEX LIST TO BE     0752
*                                      PROCESSED                     */
*       SETINCR);                   /* GROUP INCREAMENT              */
SETCAND  STM   @14,@12,@SA00013                                    0752
         MVC   @PC00013(8),0(@01)                                  0752
*   DCL                                                            0753
*     SETNDX@ PTR(31);              /* CHAIN PTR FOR INDEX           */
*   DCL                                                            0754
*     SETINCR FIXED(31);            /* INCREAMENT FOR SEARCH COUNTER
*                                      - USED SO THAT 8 AND 16 BYTE
*                                      ENTRIES CAN BE PROCESSED      */
*   DCL                                                            0755
*     SETX FIXED(31);               /* ICT INDEX ENTRY INDEX         */
*   DCL                                                            0756
*     SETRC FIXED(15);              /* LOCAL RETURN CODE             */
*   DCL                                                            0757
*     SETNFND CONSTANT(4);          /* NOT ADDED RETURN CODE         */
*   RFY                                                            0758
*     ICTENTLS BASED(SETNDX@);                                     0758
*   RFY                                                            0759
*     TSLPARMS BASED(TBLXTSLP);                                    0759
*   SETRC=SETNFND;                  /* ASSUME NO CANDIDATE ADDED     */
         LA    SETRC,4                                             0760
*   DO SETX=1 BY SETINCR            /* PROCESS ALL INDEX LIST ENTRIES*/
*         WHILE(ICTENTND(SETX)^=ICTENDIX/*                           */
*         &SETRC<STOPFUNC);                                        0761
         LA    SETX,1                                              0761
         B     @DE00761                                            0761
@DL00761 DS    0H                                                  0762
*     TSLICTSR=''B;                 /* CLEAR TSB PARM LIST           */
         L     @10,@PC00001                                        0762
         L     @10,TBLXTSLP(,@10)                                  0762
         L     @08,TSLPMLAD(,@10)                                  0762
         XC    TSLICTSR(14,@08),TSLICTSR(@08)                      0762
*     TSLFUNCT=TSLFISRH;            /* SEARCH ICT FOR SYSMOD NAMED IN
*                                      INDEX LIST OF CURRENT SYSMOD  */
         MVI   TSLFUNCT(@10),X'01'                                 0763
*     TSLISMD=ICTENTNT(SETX);       /* ...                           */
         LR    @15,SETX                                            0764
         SLA   @15,3                                               0764
         L     @14,@PC00013                                        0764
         L     @01,SETNDX@(,@14)                                   0764
         ALR   @01,@15                                             0764
         AL    @01,@CF01537                                        0764
         MVC   TSLISMD(7,@08),ICTENTNT(@01)                        0764
*     CALL HMASMTSB(TSLPARMS);      /* ...                           */
         ST    @10,@AL00001                                        0765
         L     @15,@CV01232                                        0765
         LA    @01,@AL00001                                        0765
         BALR  @14,@15                                             0765
*     IF TSLRETRN=TSLGOOD THEN      /* SYSMOD FOUND?                 */
         L     @10,@PC00001                                        0766
         L     @10,TBLXTSLP(,@10)                                  0766
         CLI   TSLRETRN(@10),0                                     0766
         BNE   @RF00766                                            0766
*       DO;                         /* YES,                          */
*         IF TSLICTP->ICTPRCND(1)=ON THEN/* CANDIDATE ALREADY?       */
         L     @10,TSLPMLAD(,@10)                                  0768
         L     @10,TSLICTP(,@10)                                   0768
         TM    ICTPRCND(@10),B'00010000'                           0768
         BNO   @RF00768                                            0768
*           DO;                     /* YES,                          */
*             SETRC=MIN(SETRC,SETNFND);/*                            */
         LA    @10,4                                               0770
         CR    SETRC,@10                                           0770
         BNH   *+6
         LR    SETRC,@10                                           0770
*           END;                                                   0771
*         ELSE                      /* NOT A CANDIDATE YET           */
*           DO;                     /*                               */
         B     @RC00768                                            0772
@RF00768 DS    0H                                                  0773
*             TSLICTP->ICTPRCND(1)=ON;/* MARK AS CANDIDATE           */
         L     @10,@PC00001                                        0773
         L     @10,TBLXTSLP(,@10)                                  0773
         L     @10,TSLPMLAD(,@10)                                  0773
         L     @10,TSLICTP(,@10)                                   0773
         OI    ICTPRCND(@10),B'00010000'                           0773
*             SETRC=ZERO;           /* CANDIDATE ADDED RC            */
         SLR   SETRC,SETRC                                         0774
*           END;                                                   0775
*       END;                                                       0776
*     ELSE                          /* ENTRY NOT FOUND               */
*       DO;                         /*                               */
         B     @RC00766                                            0777
@RF00766 DS    0H                                                  0778
*         SETRC=MIN(SETRC,TSLRETRN);/* RC = 4 IF NO ENTRY EVER FOUND
*                                      OR 0 IF ONE OR MORE IS FOUND
*                                      IN ICT                        */
         L     @10,@PC00001                                        0778
         L     @10,TBLXTSLP(,@10)                                  0778
         SLR   @08,@08                                             0778
         IC    @08,TSLRETRN(,@10)                                  0778
         CR    SETRC,@08                                           0778
         BNH   *+6
         LR    SETRC,@08                                           0778
*       END;                                                       0779
*   END;                                                           0780
@RC00766 L     @10,@PC00013+4                                      0780
         AL    SETX,SETINCR(,@10)                                  0780
@DE00761 LR    @10,SETX                                            0780
         SLA   @10,3                                               0780
         L     @08,@PC00013                                        0780
         L     @08,SETNDX@(,@08)                                   0780
         AL    @08,@CF01537                                        0780
         L     @10,ICTENTND(@10,@08)                               0780
         CL    @10,ICTENDIX                                        0780
         BE    @DC00761                                            0780
         CH    SETRC,@CH00033                                      0780
         BL    @DL00761                                            0780
@DC00761 DS    0H                                                  0781
*   RETURN CODE(SETRC);             /* RETURN W/RC                   */
         LR    @15,SETRC                                           0781
         L     @14,@SA00013                                        0781
         LM    @00,@12,@SA00013+8                                  0781
         BR    @14                                                 0781
*   RFY                                                            0782
*     ICTENTLS BASED;                                              0782
*   RFY                                                            0783
*     TSLPARMS BASED;                                              0783
*   END SETCAND;                                                   0784
*                                                                  0785
*/********************************************************************/
*/* SETCAND2 - MARK SYSMOD THAT REFERENCE THE CURRENT SYSMOD IN THE  */
*/*            SPECIFIED INDEX LIST AS A CANDIDATE                   */
*/*                                                                  */
*/* INPUT - CURRENT SYSMOD ICT ENTRY                                 */
*/*       - INDEX LIST OFFSET                                        */
*/*                                                                  */
*/* OUTPUT - EACH SYSMOD IN THE INDEX LIST WILL BE MARKED AS RESTORE */
*/*       CANDIDATE IF IT IS FOUND IN THE ICT (ICTPRCND).            */
*/*                                                                  */
*/*       RC = 0 ONE OR MORE SYSMODS IN THE INDEX LIST WAS FOUND AND */
*/*              WAS NOT ALREADY A CANDIDATE                         */
*/*       RC = 4 NO SYSMOD IN THE INDEX LIST, OR                     */
*/*              NO SYSMOD WAS FOUND IN THE ICT THAT WAS NOT ALREADY */
*/*              A CANDIDATE                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0785
*SETCAND2:                                                         0785
*   PROC(SET2ENT,                   /* ICT PTF ENTRY FOR CURRENT   0785
*                                      SYSMOD                        */
*       SET2OFST);                  /* OFFSET OF PTF ENTRY INDEX LIST
*                                      TO BE SEARCHED                */
SETCAND2 STM   @14,@12,@SA00014                                    0785
         MVC   @PC00014(8),0(@01)                                  0785
*   DCL                                                            0786
*     SET2ENT CHAR(*);              /* ICT PTF ENTRY                 */
*   DCL                                                            0787
*     SET2OFST FIXED(31);           /* OFFSET OF THE LIST            */
*   DCL                                                            0788
*     SET2RC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0789
*     SET2NFND CONSTANT(4);         /* NOT ADDED RETURN CODE         */
*   DCL                                                            0790
*     1 SET2FLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 SET2END BIT(1),            /* END OF ICT SEARCH             */
*      2 * BIT(7);                  /* UNUSED                        */
*   RFY                                                            0791
*     ICTPTF BASED(ADDR(SET2ENT));                                 0791
*   RFY                                                            0792
*     TSLPARMS BASED(TBLXTSLP);                                    0792
*   SET2RC=SET2NFND;                /* ASSUME NO CANDIDATE ADDED     */
         LA    SET2RC,4                                            0793
*   TSLLSTSR=''B;                   /* CLEAR TSB PARM LIST           */
         L     @10,@PC00001                                        0794
         L     @10,TBLXTSLP(,@10)                                  0794
         L     @08,TSLPMLAD(,@10)                                  0794
         XC    TSLLSTSR(16,@08),TSLLSTSR(@08)                      0794
*   TSLLSMD=ICTPTFS(1);             /* SEARCH FOR SYSMOD IN INDEX  0795
*                                      LIST                          */
         L     @03,@PC00014                                        0795
         MVC   TSLLSMD(7,@08),ICTPTFS(@03)                         0795
*   TSLFUNCT=TSLFLSRH;              /* SEARCH ICT LIST FOR REFERENCES
*                                      TO THE CURRENT SYSMOD         */
         MVI   TSLFUNCT(@10),X'02'                                 0796
*   TSLLOFST=SET2OFST;              /* OFFSET OF THE LIST TO BE    0797
*                                      SEARCHED                      */
         L     @10,@PC00014+4                                      0797
         MVC   TSLLOFST(4,@08),SET2OFST(@10)                       0797
*   SET2END=OFF;                    /* CLEAR END OF SEARCH FLAG      */
         NI    SET2END,B'01111111'                                 0798
*   DO WHILE(SET2END=OFF            /* PROCESS ALL ENTRIES           */
*         &SET2RC<STOPSMD);                                        0799
         B     @DE00799                                            0799
@DL00799 DS    0H                                                  0800
*     CALL HMASMTSB(TSLPARMS);                                     0800
         L     @10,@PC00001                                        0800
         L     @10,TBLXTSLP(,@10)                                  0800
         ST    @10,@AL00001                                        0800
         L     @15,@CV01232                                        0800
         LA    @01,@AL00001                                        0800
         BALR  @14,@15                                             0800
*     TSLLONXT=ON;                  /* SEARCH FOR NEXT OCCURRENCE    */
         L     @10,@PC00001                                        0801
         L     @10,TBLXTSLP(,@10)                                  0801
         L     @08,TSLPMLAD(,@10)                                  0801
         OI    TSLLONXT(@08),B'10000000'                           0801
*     IF TSLRETRN=TSLFOUND THEN     /* SYSMOD FOUND?                 */
         CLI   TSLRETRN(@10),0                                     0802
         BNE   @RF00802                                            0802
*       DO;                         /* YES,                          */
*         IF TSLLRTNP->ICTPRCND(1)=ON THEN/* CANDIDATE ALREADY?      */
         L     @10,TSLLRTNP(,@08)                                  0804
         TM    ICTPRCND(@10),B'00010000'                           0804
         BNO   @RF00804                                            0804
*           DO;                     /* YES,                          */
*             SET2RC=MIN(SET2RC,SET2NFND);/*                         */
         LA    @10,4                                               0806
         CR    SET2RC,@10                                          0806
         BNH   *+6
         LR    SET2RC,@10                                          0806
*           END;                                                   0807
*         ELSE                      /* NOT A CANDIDATE YET           */
*           DO;                     /*                               */
         B     @RC00804                                            0808
@RF00804 DS    0H                                                  0809
*             TSLLRTNP->ICTPRCND(1)=ON;/* MARK AS CANDIDATE          */
         L     @10,@PC00001                                        0809
         L     @10,TBLXTSLP(,@10)                                  0809
         L     @10,TSLPMLAD(,@10)                                  0809
         L     @10,TSLLRTNP(,@10)                                  0809
         OI    ICTPRCND(@10),B'00010000'                           0809
*             SET2RC=ZERO;          /* CANDIDATE ADDED RC            */
         SLR   SET2RC,SET2RC                                       0810
*           END;                                                   0811
*       END;                                                       0812
*     ELSE                          /* ENTRY NOT FOUND               */
*       DO;                         /*                               */
         B     @RC00802                                            0813
@RF00802 DS    0H                                                  0814
*         SET2RC=MIN(SET2RC,TSLRETRN);/* RC = 4 IF NO ENTRY EVER   0814
*                                      FOUND OR 0 IF ONE OR MORE IS
*                                      FOUND IN ICT                  */
         L     @10,@PC00001                                        0814
         L     @10,TBLXTSLP(,@10)                                  0814
         SLR   @08,@08                                             0814
         IC    @08,TSLRETRN(,@10)                                  0814
         CR    SET2RC,@08                                          0814
         BNH   *+6
         LR    SET2RC,@08                                          0814
*         SET2END=ON;               /* STOP THE SEARCH               */
         OI    SET2END,B'10000000'                                 0815
*       END;                                                       0816
*   END;                            /* END OF PROCESS LOOP           */
@RC00802 DS    0H                                                  0817
@DE00799 TM    SET2END,B'10000000'                                 0817
         BNZ   @DC00799                                            0817
         CH    SET2RC,@CH00055                                     0817
         BL    @DL00799                                            0817
@DC00799 DS    0H                                                  0818
*   RETURN CODE(SET2RC);            /* RETURN W/RC                   */
         LR    @15,SET2RC                                          0818
         L     @14,@SA00014                                        0818
         LM    @00,@12,@SA00014+8                                  0818
         BR    @14                                                 0818
*   RFY                                                            0819
*     ICTPTF BASED;                                                0819
*   RFY                                                            0820
*     TSLPARMS BASED;                                              0820
*   END SETCAND2;                                                  0821
*   END GROUP;                                                     0822
*                                                                  0823
*/********************************************************************/
*/*                                                                  */
*/* ASSUMTION: IF SYSMOD IS PREREQ'ED BY OTHER SYSMODS THEY WILL ALL */
*/*     BE IN THE ICT.                                               */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/* SUP'ED SYSMODS:                                                  */
*/*     - ALL SYSMODS IN THE SUPBY LIST MUST BE IN THE ICT AND OK    */
*/*       (TPR)                                                      */
*/*     - IF ANY SUP'ING SYSMOD FAILS, FAIL ALL OTHER SYSMODS THAT   */
*/*       ALSO SUP SYSMODS IN THE FAILING SYSMOD'S SUP LIST.         */
*/*       ALSO FAIL THE SUP'ED SYSMOD                                */
*/*       (TCR,CPL)                                                  */
*/*                                                                  */
*/* PRE'ING SYSMODS:                                                 */
*/*     - IF A PRE'ED SYSMOD FAILS, ALL PRE'ING SYSMODS ARE FAILED   */
*/*       (TCR,CPL)                                                  */
*/*                                                                  */
*/* REQ SYSMODS:                                                     */
*/*     - ALL REQ'S OF A FAILING SYSMOD ARE FAILED.                  */
*/*     - ALL SYSMODS THAT REQ A FAILED SYSMOD ARE FAILED.           */
*/*       (TCR,CPL)                                                  */
*/*                                                                  */
*/* IF REQ SYSMODS:                                                  */
*/*     - ALL IREQ'S OF A FAILING SYSMOD ARE FAILED.                 */
*/*     - ALL SYSMODS THAT IREQ A FAILED SYSMOD ARE FAILED.          */
*/*       (TCR,CPL)                                                  */
*/*                                                                  */
*/* FMID SYSMODS:                                                    */
*/*     - ANY SYSMOD THAT FMID'S A SYSMOD THAT FAILS IS FAILED       */
*/*       (TCR,CPL)                                                  */
*/*                                                                  */
*/*                                                                  */
*/* NOTE: THERE SEEMS TO BE NO REASON TO RESTORE A SYSMOD IF THE     */
*/*       IREQ IS NOT IN THE ICT BUT IS ACCEPTED.  LIKEWISE, IF A    */
*/*       ONE WAY REQ IS BEING RESTORED BUT THE REQ'ED SYSMOD        */
*/*       IS ACCEPTED.  HOWEVER, THIS IS NOT DONE TO CONFORM TO THE  */
*/*       FPFS                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0823
*REQCHK:                                                           0823
*   PROC;                                                          0823
REQCHK   STM   @14,@12,@SA00015                                    0823
*   DCL                                                            0824
*     REQCHKRC FIXED(15);           /* LOCAL RETURN CODE             */
*   DCL                                                            0825
*     REQCSMDX FIXED(31);           /* PTF ENTRY INDEX COUNTER       */
*   RFY                                                            0826
*     ICTPTF BASED(CCAICPTF);                                      0826
*   RFY                                                            0827
*     TSLPARMS BASED(TBLXTSLP);                                    0827
*   REQCHKRC=ZERO;                  /* CLEAR RETURN CODE             */
         SLR   REQCHKRC,REQCHKRC                                   0828
*                                                                  0829
*   /*****************************************************************/
*   /*                                                               */
*   /* INSURE THAT ALL SYSMODS IN THE SUPBY LIST OF EACH SYSMOD IS IN*/
*   /* THE ICT. IF NOT ISSUE AN ERROR MESSAGE.                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0829
*   CALL SUPCHK;                                                   0829
         BAL   @14,SUPCHK                                          0829
*   RFY                                                            0830
*     RTNCODE RSTD;                 /*                               */
*   REQCHKRC=MAX(REQCHKRC,RTNCODE); /* SAVE RETURN CODE              */
         CR    REQCHKRC,RTNCODE                                    0831
         BNL   *+6
         LR    REQCHKRC,RTNCODE                                    0831
*   RFY                                                            0832
*     RTNCODE UNRSTD;               /*                               */
*                                                                  0832
*   /*****************************************************************/
*   /*                                                               */
*   /* MARK ALL SYSMODS THAT ARE NOT CANDIDATES AS NOGO. ALSO MARK   */
*   /* DELETING SYSMODS AS NOGO                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0833
*   DO REQCSMDX=1 BY 1              /* PROCESS ALL SYSMODS IN THE ICT*/
*         WHILE(ICTPEND(REQCSMDX)^=ICTENDNT);                      0833
         LA    REQCSMDX,1                                          0833
         B     @DE00833                                            0833
@DL00833 DS    0H                                                  0834
*     IF ICTPRCND(REQCSMDX)^=ON THEN/* SYSMOD IS RESTORE CANDIDATE?  */
         LR    @10,REQCSMDX                                        0834
         MH    @10,@CH01508                                        0834
         L     @08,CCAICPTF(,CCAPTR)                               0834
         ST    @10,@TF00001                                        0834
         ALR   @10,@08                                             0834
         AL    @10,@CF01532                                        0834
         TM    ICTPRCND-12(@10),B'00010000'                        0834
         BO    @RF00834                                            0834
*       DO;                         /* YES,                          */
*         ICTPNOGO(REQCSMDX)=ON;    /* MARK AS NOGO                  */
         AL    @08,@TF00001                                        0836
         AL    @08,@CF01538                                        0836
         OI    ICTPNOGO-8(@08),B'01000000'                         0836
*       END;                                                       0837
*     ELSE                          /* IS A RESTORE CANDIDATE        */
*       DO;                                                        0838
         B     @RC00834                                            0838
@RF00834 DS    0H                                                  0839
*         IF ICTPDELP(REQCSMDX)=ON THEN/* GROUPED IN DELETING SYSMOD?*/
         LR    @10,REQCSMDX                                        0839
         MH    @10,@CH01508                                        0839
         L     @08,CCAICPTF(,CCAPTR)                               0839
         ST    @10,@TF00001                                        0839
         ALR   @10,@08                                             0839
         AL    @10,@CF01539                                        0839
         TM    ICTPDELP-9(@10),B'10000000'                         0839
         BNO   @RF00839                                            0839
*           DO;                     /* YES,                          */
*             ICTPNOGO(REQCSMDX)=ON;/* MARK IT NOGO                  */
*                                                                  0841
         LR    @10,@08                                             0841
         AL    @10,@TF00001                                        0841
         AL    @10,@CF01538                                        0841
         OI    ICTPNOGO-8(@10),B'01000000'                         0841
*             /*******************************************************/
*             /*                                                     */
*             /* HMA428I RESTORE CANDIDATE XXXXXXX TERMINATED BECAUSE*/
*             /* IT ... DELETES SYSMODS                              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0842
*             DO;                   /* HMASMPMG M1(HMA428I)M2(PART120
*                                      )TYPE(ERR)VAR(ICTPTFS(REQCSMDX
*                                      ))TARGET(SYSOUT,LOG)          */
*               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS    */
         XC    HMASMMGP(28),HMASMMGP                               0843
*               MGPMGNO1=HMA428I;   /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01239                                0844
*               MGPMGNO2=PART120;   /* SET UP MSG 2 CODE             */
         MVC   MGPMGNO2(2),@CH01248                                0845
*               MGPTYPE=MGPERR;     /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0846
*               MGPPRINT='1'B;      /* SET TARGET FLAG               */
*               MGPHLDS='1'B;       /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0848
*               MGPVARPT(1)=ADDR(ICTPTFS(REQCSMDX));/* SET VARIABLE
*                                      PTR                           */
         L     @10,@TF00001                                        0849
         AL    @08,@CF01534                                        0849
         LA    @10,ICTPTFS(@10,@08)                                0849
         ST    @10,MGPVARPT                                        0849
*               CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED       */
         L     @15,@CV01229                                        0850
         LA    @01,@AL00850                                        0850
         BALR  @14,@15                                             0850
*             END;                  /*                               */
*             ICTPNOGO(REQCSMDX)=ON;/* MARK SYSMOD NOGO              */
*             ICTPCPL(REQCSMDX)=ON; /* ... COMPLETE                  */
*             ICTPMSG(REQCSMDX)=ON; /* ... AND MESSAGE ISSUE         */
         LR    @10,REQCSMDX                                        0854
         MH    @10,@CH01508                                        0854
         L     @08,CCAICPTF(,CCAPTR)                               0854
         ST    @10,@TF00001                                        0854
         ALR   @10,@08                                             0854
         AL    @10,@CF01538                                        0854
         OI    ICTPNOGO-8(@10),B'01110000'                         0854
*             TSLFUNCT=TSLFFUNC;    /* CHECK FOR FUNCTION FAILURE    */
         L     @10,@PC00001                                        0855
         L     @10,TBLXTSLP(,@10)                                  0855
         MVI   TSLFUNCT(@10),X'07'                                 0855
*             TSLMTYPE=ICTPTYPE(REQCSMDX);/* TYPE ...                */
         L     @15,TSLPMLAD(,@10)                                  0856
         L     @14,@TF00001                                        0856
         AL    @14,@CF01531                                        0856
         SLR   @07,@07                                             0856
         IC    @07,ICTPTYPE-17(@14,@08)                            0856
         STC   @07,TSLMTYPE(,@15)                                  0856
*             TSLMSMD=ICTPTFS(REQCSMDX);/* ... AND NAME              */
         AL    @08,@TF00001                                        0857
         AL    @08,@CF01534                                        0857
         MVC   TSLMSMD(7,@15),ICTPTFS(@08)                         0857
*             CALL HMASMTSB(TSLPARMS);/* ...                         */
         ST    @10,@AL00001                                        0858
         L     @15,@CV01232                                        0858
         LA    @01,@AL00001                                        0858
         BALR  @14,@15                                             0858
*             REQCHKRC=TSLRETRN;    /* SET THE RETURN CODE           */
         L     @10,@PC00001                                        0859
         L     @10,TBLXTSLP(,@10)                                  0859
         SLR   REQCHKRC,REQCHKRC                                   0859
         IC    REQCHKRC,TSLRETRN(,@10)                             0859
*           END;                                                   0860
*         ELSE                                                     0861
*           ;                       /* NOT A DELETOR SO SKIP IT      */
@RF00839 DS    0H                                                  0862
*       END;                                                       0862
*   END;                            /* END ALL SYSMOD LOOP           */
*                                                                  0863
@RC00834 AL    REQCSMDX,@CF00063                                   0863
@DE00833 LR    @10,REQCSMDX                                        0863
         MH    @10,@CH01508                                        0863
         L     @08,CCAICPTF(,CCAPTR)                               0863
         AL    @08,@CF01534                                        0863
         L     @10,ICTPEND(@10,@08)                                0863
         CL    @10,ICTENDNT                                        0863
         BNE   @DL00833                                            0863
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL TCR TO ELIMINATE NOTE: IT IS ASSUMED THAT TSB DOES NOT   */
*   /* USE PTF USR FLAGS                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0864
*   TSLFUNCT=TSLFRCKR;              /* CHECK FOR RESTORE REQ'S       */
         L     @10,@PC00001                                        0864
         L     @10,TBLXTSLP(,@10)                                  0864
         MVI   TSLFUNCT(@10),X'08'                                 0864
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */
         ST    @10,@AL00001                                        0865
         L     @15,@CV01232                                        0865
         LA    @01,@AL00001                                        0865
         BALR  @14,@15                                             0865
*   REQCHKRC=MAX(REQCHKRC,TSLRETRN);/* SET RETURN CODE               */
*                                                                  0866
         L     @10,@PC00001                                        0866
         L     @10,TBLXTSLP(,@10)                                  0866
         SLR   @08,@08                                             0866
         IC    @08,TSLRETRN(,@10)                                  0866
         CR    REQCHKRC,@08                                        0866
         BNL   *+6
         LR    REQCHKRC,@08                                        0866
*   /*****************************************************************/
*   /*                                                               */
*   /* SET PRE/REQ/IRQ STATUS FLAGS IN INDEX LIST ENTRIES            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0867
*   DO REQCSMDX=1 BY 1              /* PROCESS EACH SYSMOD ENTRY     */
*         WHILE(ICTPEND(REQCSMDX)^=ICTENDIX);/*                      */
         LA    REQCSMDX,1                                          0867
         B     @DE00867                                            0867
@DL00867 DS    0H                                                  0868
*     CALL REQSTAT(ICTPRCHN(REQCSMDX),/* SET REQ STATUS FLAGS        */
*         TPRREQI);                 /*                               */
         LR    @10,REQCSMDX                                        0868
         MH    @10,@CH01508                                        0868
         L     @08,CCAICPTF(,CCAPTR)                               0868
         AL    @08,@CF01535                                        0868
         LA    @10,ICTPRCHN-68(@10,@08)                            0868
         ST    @10,@AL00001                                        0868
         LA    @10,@CF00063                                        0868
         ST    @10,@AL00001+4                                      0868
         LA    @01,@AL00001                                        0868
         BAL   @14,REQSTAT                                         0868
*     CALL REQSTAT(ICTPPCHN(REQCSMDX),/* SET PRE STATUS FLAGS        */
*         TPRPREI);                 /*                               */
         LR    @10,REQCSMDX                                        0869
         MH    @10,@CH01508                                        0869
         L     @08,CCAICPTF(,CCAPTR)                               0869
         AL    @08,@CF01540                                        0869
         LA    @10,ICTPPCHN-76(@10,@08)                            0869
         ST    @10,@AL00001                                        0869
         LA    @10,@CF00063                                        0869
         ST    @10,@AL00001+4                                      0869
         LA    @01,@AL00001                                        0869
         BAL   @14,REQSTAT                                         0869
*     CALL REQSTAT(ICTPICHN(REQCSMDX),/* SET IRQ STATUS FLAGS        */
*         TPRIRQI);                 /*                               */
         LR    @10,REQCSMDX                                        0870
         MH    @10,@CH01508                                        0870
         L     @08,CCAICPTF(,CCAPTR)                               0870
         AL    @08,@CF01536                                        0870
         LA    @10,ICTPICHN-80(@10,@08)                            0870
         ST    @10,@AL00001                                        0870
         LA    @10,@CF00273                                        0870
         ST    @10,@AL00001+4                                      0870
         LA    @01,@AL00001                                        0870
         BAL   @14,REQSTAT                                         0870
*   END;                            /*                               */
         AL    REQCSMDX,@CF00063                                   0871
@DE00867 LR    @10,REQCSMDX                                        0871
         MH    @10,@CH01508                                        0871
         L     @08,CCAICPTF(,CCAPTR)                               0871
         AL    @08,@CF01534                                        0871
         L     @10,ICTPEND(@10,@08)                                0871
         CL    @10,ICTENDIX                                        0871
         BNE   @DL00867                                            0871
*   RETURN CODE(REQCHKRC);          /* RETURN W/ RC                  */
         LR    @15,REQCHKRC                                        0872
         L     @14,@SA00015                                        0872
         LM    @00,@12,@SA00015+8                                  0872
         BR    @14                                                 0872
*   RFY                                                            0873
*     ICTPTF BASED;                                                0873
*   RFY                                                            0874
*     TSLPARMS BASED;                                              0874
*SUPCHK:                                                           0875
*   PROC;                                                          0875
SUPCHK   STM   @14,@12,@SA00016                                    0875
*   DCL                                                            0876
*     SUPCHKRC FIXED(15);           /* LOCAL RETURN CODE             */
*   DCL                                                            0877
*     SUPCSMDX FIXED(31);           /* PTF ENTRY INDEX COUNTER       */
*   DCL                                                            0878
*     SUPCSUPX FIXED(31);           /* SUP INDEX LIST INDEX COUNTER  */
*   RFY                                                            0879
*     ICTPTF BASED(CCAICPTF);                                      0879
*   RFY                                                            0880
*     ICTSBYLS BASED(ICTPBCHN(SUPCSMDX));                          0880
*   RFY                                                            0881
*     TSLPARMS BASED(TBLXTSLP);                                    0881
*   SUPCHKRC=ZERO;                  /* CLEAR RETURN CODE             */
         SLR   SUPCHKRC,SUPCHKRC                                   0882
*   TSLICTSR=''B;                   /* CLEAR TSB PARM LIST           */
         L     @10,@PC00001                                        0883
         L     @10,TBLXTSLP(,@10)                                  0883
         L     @08,TSLPMLAD(,@10)                                  0883
         XC    TSLICTSR(14,@08),TSLICTSR(@08)                      0883
*   TSLFUNCT=TSLFISRH;              /* TSB FUNCTION IS SEARCH ICT FOR
*                                      PTF ENTRY                     */
         MVI   TSLFUNCT(@10),X'01'                                 0884
*   DO SUPCSMDX=1 BY 1              /* PROCESS ALL SYSMODS IN THE ICT*/
*         WHILE(ICTPEND(SUPCSMDX)^=ICTENDNT);                      0885
         LA    SUPCSMDX,1                                          0885
         B     @DE00885                                            0885
@DL00885 DS    0H                                                  0886
*     IF ICTPRCND(SUPCSMDX)=ON THEN /* SYSMOD IS RESTORE CANDIDATE?  */
         LR    @10,SUPCSMDX                                        0886
         MH    @10,@CH01508                                        0886
         L     @08,CCAICPTF(,CCAPTR)                               0886
         ALR   @08,@10                                             0886
         AL    @08,@CF01532                                        0886
         TM    ICTPRCND-12(@08),B'00010000'                        0886
         BNO   @RF00886                                            0886
*       DO;                         /* YES,                          */
*         DO SUPCSUPX=1 BY 1        /* PROCESS EACH SUP LIST SYSMOD
*                                      ENTRY                         */
*               WHILE(ICTSBYND(SUPCSUPX)^=ICTENDIX);               0888
         LA    SUPCSUPX,1                                          0888
         B     @DE00888                                            0888
@DL00888 DS    0H                                                  0889
*           TSLISMD=ICTSBYNM(SUPCSUPX);/* SEARCH ICT FOR SUP'ED SMD  */
         L     @10,@PC00001                                        0889
         L     @10,TBLXTSLP(,@10)                                  0889
         L     @08,TSLPMLAD(,@10)                                  0889
         LR    @05,SUPCSUPX                                        0889
         SLA   @05,3                                               0889
         LR    @15,SUPCSMDX                                        0889
         MH    @15,@CH01508                                        0889
         L     @01,CCAICPTF(,CCAPTR)                               0889
         AL    @01,@CF01541                                        0889
         L     @01,ICTPBCHN-96(@15,@01)                            0889
         ALR   @01,@05                                             0889
         AL    @01,@CF01537                                        0889
         MVC   TSLISMD(7,@08),ICTSBYNM(@01)                        0889
*           CALL HMASMTSB(TSLPARMS);/* ...                           */
         ST    @10,@AL00001                                        0890
         L     @15,@CV01232                                        0890
         LA    @01,@AL00001                                        0890
         BALR  @14,@15                                             0890
*           IF TSLRETRN=TSLNTFND THEN/* NOT FOUND IN ICT?            */
         L     @10,@PC00001                                        0891
         L     @10,TBLXTSLP(,@10)                                  0891
         CLI   TSLRETRN(@10),4                                     0891
         BNE   @RF00891                                            0891
*             DO;                   /* YES,                          */
*               ICTPNOGO(SUPCSMDX)=ON;/* MARK SYSMOD NOGO            */
*               ICTPCPL(SUPCSMDX)=ON;/* ... COMPLETE                 */
*               ICTPMSG(SUPCSMDX)=ON;/* ... AND MESSAGE ISSUE        */
*                                                                  0895
         LR    @10,SUPCSMDX                                        0895
         MH    @10,@CH01508                                        0895
         L     @08,CCAICPTF(,CCAPTR)                               0895
         ST    @10,@TF00001                                        0895
         ALR   @10,@08                                             0895
         AL    @10,@CF01538                                        0895
         OI    ICTPNOGO-8(@10),B'01110000'                         0895
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE MESSAGE 'HMASM433 SYSMOD XXXXXXX IS         */
*               /* SUPERSEDED BY XXXXXXX, WHICH IS NOT BEING         */
*               /* RESTORED'                                         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0896
*               DO;                 /* HMASMPMG M1(HMA433I)TYPE(ERR)V
*                                      AR(ICTPTFS(SUPCSMDX),ICTSBYNM(
*                                      SUPCSUPX))TARGET(SYSOUT,LOG)  */
*                 HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS  */
         XC    HMASMMGP(28),HMASMMGP                               0897
*                 MGPMGNO1=HMA433I; /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01241                                0898
*                 MGPTYPE=MGPERR;   /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0899
*                 MGPPRINT='1'B;    /* SET TARGET FLAG               */
*                 MGPHLDS='1'B;     /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0901
*                 MGPVARPT(1)=ADDR(ICTPTFS(SUPCSMDX));/* SET VARIABLE
*                                      PTR                           */
         L     @10,@TF00001                                        0902
         AL    @10,@CF01534                                        0902
         LA    @10,ICTPTFS(@10,@08)                                0902
         ST    @10,MGPVARPT                                        0902
*                 MGPVARPT(2)=ADDR(ICTSBYNM(SUPCSUPX));/* SET      0903
*                                      VARIABLE PTR                  */
         LR    @10,SUPCSUPX                                        0903
         SLA   @10,3                                               0903
         L     @05,@TF00001                                        0903
         AL    @08,@CF01541                                        0903
         L     @08,ICTPBCHN-96(@05,@08)                            0903
         AL    @08,@CF01537                                        0903
         LA    @10,ICTSBYNM(@10,@08)                               0903
         ST    @10,MGPVARPT+4                                      0903
*                 CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED     */
         L     @15,@CV01229                                        0904
         LA    @01,@AL00904                                        0904
         BALR  @14,@15                                             0904
*               END;                /*                               */
*               TSLFUNCT=TSLFFUNC;  /* FUNCTION IS ISSUE FUNCTION  0906
*                                      FAIL MESSAGE IF REQUIRED      */
         L     @10,@PC00001                                        0906
         L     @10,TBLXTSLP(,@10)                                  0906
         MVI   TSLFUNCT(@10),X'07'                                 0906
*               TSLMTYPE=ICTPTYPE(SUPCSMDX);/* TYPE ...              */
         L     @08,TSLPMLAD(,@10)                                  0907
         LR    @05,SUPCSMDX                                        0907
         MH    @05,@CH01508                                        0907
         L     @15,CCAICPTF(,CCAPTR)                               0907
         LA    @01,0(@05,@15)                                      0907
         AL    @01,@CF01531                                        0907
         SLR   @00,@00                                             0907
         IC    @00,ICTPTYPE-17(,@01)                               0907
         STC   @00,TSLMTYPE(,@08)                                  0907
*               TSLMSMD=ICTPTFS(SUPCSMDX);/* ... AND NAME            */
         ALR   @15,@05                                             0908
         AL    @15,@CF01534                                        0908
         MVC   TSLMSMD(7,@08),ICTPTFS(@15)                         0908
*               CALL HMASMTSB(TSLPARMS);/* ...                       */
         ST    @10,@AL00001                                        0909
         L     @15,@CV01232                                        0909
         LA    @01,@AL00001                                        0909
         BALR  @14,@15                                             0909
*               SUPCHKRC=TSLRETRN;  /* SET THE RETURN CODE           */
         L     @10,@PC00001                                        0910
         L     @10,TBLXTSLP(,@10)                                  0910
         SLR   SUPCHKRC,SUPCHKRC                                   0910
         IC    SUPCHKRC,TSLRETRN(,@10)                             0910
*             END;                                                 0911
*           ELSE                                                   0912
*             ;                     /* SUP'ED ENTRY IN ICT, ANY ERROR
*                                      WILL BE FOUND BY TCR          */
@RF00891 DS    0H                                                  0913
*         END;                                                     0913
         AL    SUPCSUPX,@CF00063                                   0913
@DE00888 LR    @10,SUPCSUPX                                        0913
         SLA   @10,3                                               0913
         LR    @08,SUPCSMDX                                        0913
         MH    @08,@CH01508                                        0913
         L     @05,CCAICPTF(,CCAPTR)                               0913
         AL    @05,@CF01541                                        0913
         L     @08,ICTPBCHN-96(@08,@05)                            0913
         AL    @08,@CF01537                                        0913
         L     @10,ICTSBYND(@10,@08)                               0913
         CL    @10,ICTENDIX                                        0913
         BNE   @DL00888                                            0913
*       END;                                                       0914
*     ELSE                                                         0915
*       ;                           /* NOT A RESTORE CANDIDATE, SO 0915
*                                      SKIP IT                       */
@RF00886 DS    0H                                                  0916
*   END;                            /* END ALL SYSMOD LOOP           */
         AL    SUPCSMDX,@CF00063                                   0916
@DE00885 LR    @10,SUPCSMDX                                        0916
         MH    @10,@CH01508                                        0916
         L     @08,CCAICPTF(,CCAPTR)                               0916
         AL    @08,@CF01534                                        0916
         L     @10,ICTPEND(@10,@08)                                0916
         CL    @10,ICTENDNT                                        0916
         BNE   @DL00885                                            0916
*   RETURN CODE(SUPCHKRC);          /* RETURN W/ RC                  */
         LR    @15,SUPCHKRC                                        0917
         L     @14,@SA00016                                        0917
         LM    @00,@12,@SA00016+8                                  0917
         BR    @14                                                 0917
*   RFY                                                            0918
*     ICTPTF BASED;                                                0918
*   RFY                                                            0919
*     ICTSUPLS BASED;                                              0919
*   RFY                                                            0920
*     TSLPARMS BASED;                                              0920
*   END SUPCHK;                                                    0921
*                                                                  0922
*   /*****************************************************************/
*   /*                                                               */
*   /* REQSTAT - SET STATUS FLAGS IN SPECIFIED INDEX ENTRIES         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0922
*REQSTAT:                                                          0922
*   PROC(REQSLST@,                  /* LIST ENTRY PTR                */
*       REQSINCR);                  /* LIST ENTRY SIZE IN DOUBLE   0922
*                                      WORDS                         */
REQSTAT  STM   @14,@12,@SA00017                                    0922
         MVC   @PC00017(8),0(@01)                                  0922
*   DCL                                                            0923
*     REQSLST@ PTR(31);             /*                               */
*   DCL                                                            0924
*     REQSINCR FIXED(31);           /*                               */
*   DCL                                                            0925
*     REQSRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0926
*     REQSX1 FIXED(31);             /* INDEX FOR INDEX LIST SEARCH   */
*   RFY                                                            0927
*     ICTENTLS BASED(REQSLST@);     /*                               */
*   RFY                                                            0928
*     TSLPARMS BASED(TBLXTSLP);     /*                               */
*   REQSRC=''B;                     /* CLEAR RETURN CODE             */
         SLR   REQSRC,REQSRC                                       0929
*   DO REQSX1=1 BY REQSINCR         /*                               */
*         WHILE(ICTENTND(REQSX1)^=ICTENDIX/*                         */
*         &REQSRC<STOPSMD);         /*                               */
         LA    REQSX1,1                                            0930
         B     @DE00930                                            0930
@DL00930 DS    0H                                                  0931
*     ICTEREQS(REQSX1)=ON;          /* SET EACH REQ AS SATISFIED TO
*                                      AVOID 'REQ NOT SATISIFIED' IN
*                                      THE SYSMOD REPORTS            */
         LR    @10,REQSX1                                          0931
         SLA   @10,3                                               0931
         L     @08,@PC00017                                        0931
         L     @08,REQSLST@(,@08)                                  0931
         ST    @10,@TF00001                                        0931
         ALR   @10,@08                                             0931
         BCTR  @10,0                                               0931
         OI    ICTEREQS-7(@10),B'00010000'                         0931
*     TSLICTSR=''B;                 /* CLEAR ICT SEARCH FLAG         */
         L     @10,@PC00001                                        0932
         L     @10,TBLXTSLP(,@10)                                  0932
         L     @15,TSLPMLAD(,@10)                                  0932
         XC    TSLICTSR(14,@15),TSLICTSR(@15)                      0932
*     TSLFUNCT=TSLFISRH;            /* TSB FUNCTION IS SEARCH ICT FOR
*                                      SMD ENTRY                     */
         MVI   TSLFUNCT(@10),X'01'                                 0933
*     TSLISMD=ICTENTNM(REQSX1);     /* SEARCH FOR REQ IN THE ICT     */
         AL    @08,@TF00001                                        0934
         AL    @08,@CF01537                                        0934
         MVC   TSLISMD(7,@15),ICTENTNM(@08)                        0934
*     CALL HMASMTSB(TSLPARMS);      /* ...                           */
         ST    @10,@AL00001                                        0935
         L     @15,@CV01232                                        0935
         LA    @01,@AL00001                                        0935
         BALR  @14,@15                                             0935
*     IF TSLRETRN=TSLNTFND THEN     /* NOT IN THE ICT?               */
         L     @10,@PC00001                                        0936
         L     @10,TBLXTSLP(,@10)                                  0936
         CLI   TSLRETRN(@10),4                                     0936
         BNE   @RF00936                                            0936
*       DO;                         /* YES,                          */
*         ICTEREQT(REQSX1)=ON;      /* MARK REQ AS SATIFIED ON THE 0938
*                                      TARGET SYSTEM SO THAT HMASMCPL
*                                      WILL NOT WAIT FOR THE REQ TO
*                                      COMPLETE                      */
         LR    @10,REQSX1                                          0938
         SLA   @10,3                                               0938
         L     @08,@PC00017                                        0938
         L     @08,REQSLST@(,@08)                                  0938
         ALR   @08,@10                                             0938
         BCTR  @08,0                                               0938
         OI    ICTEREQT-7(@08),B'00000010'                         0938
*       END;                        /*                               */
*     ELSE                                                         0940
*       ;                           /* REQ SYSMOD IS IN THE ICT      */
@RF00936 DS    0H                                                  0941
*   END;                                                           0941
         L     @10,@PC00017+4                                      0941
         AL    REQSX1,REQSINCR(,@10)                               0941
@DE00930 LR    @10,REQSX1                                          0941
         SLA   @10,3                                               0941
         L     @08,@PC00017                                        0941
         L     @08,REQSLST@(,@08)                                  0941
         AL    @08,@CF01537                                        0941
         L     @10,ICTENTND(@10,@08)                               0941
         CL    @10,ICTENDIX                                        0941
         BE    @DC00930                                            0941
         CH    REQSRC,@CH00055                                     0941
         BL    @DL00930                                            0941
@DC00930 DS    0H                                                  0942
*   RETURN CODE(REQSRC);            /* RETURN W/RETURN CODE          */
         LR    @15,REQSRC                                          0942
         L     @14,@SA00017                                        0942
         LM    @00,@12,@SA00017+8                                  0942
         BR    @14                                                 0942
*   RFY                                                            0943
*     ICTENTLS BASED;                                              0943
*   RFY                                                            0944
*     TSLPARMS BASED;               /*                               */
*   END REQSTAT;                                                   0945
*   END REQCHK;                                                    0946
*                                                                  0947
*   /*****************************************************************/
*   /*                                                               */
*   /* ELIMINATE UNPROCESSED SYSMODS                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0947
*COMPRESS:                                                         0947
*   PROC;                                                          0947
COMPRESS STM   @14,@12,12(@13)                                     0947
*   DCL                                                            0948
*     COMPRSRC FIXED(15);           /* LOCAL RETURN CODE             */
*   DCL                                                            0949
*     CURPTR PTR(31);               /* CURRENT ICT PTF ENTRY         */
*   DCL                                                            0950
*     NEWEND PTR(31);               /* NEW END OF ICT PTF SECTION    */
*   RFY                                                            0951
*     ICTPTF BASED;                 /* NO BASE IS USED : EXPLICIT PTR
*                                      NOTATION IS                   */
*   COMPRSRC=ZERO;                  /* CLEAR RETURN CODE             */
         SLR   COMPRSRC,COMPRSRC                                   0952
*   NEWEND=CCAICPTF;                /* INITIALIZE THE 'MOVE TO' PTR  */
         L     @10,CCAICPTF(,CCAPTR)                               0953
         LR    NEWEND,@10                                          0953
*   CURPTR=CCAICPTF;                /* INITIALIZE CURRENT SYSMOD   0954
*                                      ENTRY PTR                     */
         LR    CURPTR,@10                                          0954
*   DO WHILE(CURPTR->ICTPEND(1)^=ICTENDNT);/* PROCESS ALL SYSMOD   0955
*                                      ENTRIES                       */
         B     @DE00955                                            0955
@DL00955 DS    0H                                                  0956
*     IF CURPTR->ICTPRCND(1)=ON THEN/* IS SYSMOD A CANDIDATE?        */
         TM    ICTPRCND(CURPTR),B'00010000'                        0956
         BNO   @RF00956                                            0956
*       DO;                         /* YES,                          */
*         IF NEWEND^=CURPTR THEN    /* IS DATA MOVEMENT REQUIRED?    */
         CR    NEWEND,CURPTR                                       0958
         BE    @RF00958                                            0958
*           DO;                     /* YES,                          */
*             NEWEND->ICTPTF(1)=CURPTR->ICTPTF(1);/* MOVE ENTRY      */
         MVC   ICTPTF(116,NEWEND),ICTPTF(CURPTR)                   0960
*           END;                                                   0961
*         ELSE                                                     0962
*           ;                       /* NO ENTRIES TO MOVE SINCE NONE
*                                      DELETED                       */
@RF00958 DS    0H                                                  0963
*         NEWEND=NEWEND+LENGTH(ICTPTF(1));/* ADVANCE END POINTER     */
         AH    NEWEND,@CH01508                                     0963
*       END;                                                       0964
*     ELSE                                                         0965
*       ;                           /* IS NOT A CANDIDATE            */
@RF00956 DS    0H                                                  0966
*     CURPTR=CURPTR+LENGTH(ICTPTF(1));/* ADVANCE TO THE NEXT         */
         AH    CURPTR,@CH01508                                     0966
*   END;                            /* END OF SYSMOD LOOP            */
@DE00955 L     @10,ICTENDNT                                        0967
         CL    @10,ICTPEND(,CURPTR)                                0967
         BNE   @DL00955                                            0967
*   TBLXTOP=NEWEND;                 /* SET TOP OF FIXED PORTION      */
         L     @08,@PC00001                                        0968
         ST    NEWEND,TBLXTOP(,@08)                                0968
*   TBLXTOP->ICTPEND(1)=ICTENDNT;   /* SET END OF SECTION INDICATOR  */
         L     @08,@PC00001                                        0969
         L     @08,TBLXTOP(,@08)                                   0969
         ST    @10,ICTPEND(,@08)                                   0969
*   RETURN CODE(COMPRSRC);          /*                               */
         LR    @15,COMPRSRC                                        0970
         L     @14,12(,@13)                                        0970
         LM    @00,@12,20(@13)                                     0970
         BR    @14                                                 0970
*   END COMPRESS;                                                  0971
*                                                                  0972
*   /*****************************************************************/
*   /*                                                               */
*   /* TPRCLEAN - TERMINATION CLEANUP                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0972
*TPRCLEAN:                                                         0972
*   PROC;                                                          0972
TPRCLEAN STM   @14,@12,12(@13)                                     0972
*   DCL                                                            0973
*     CLEANRC FIXED(15);            /* LOCAL RETURN CODE             */
*   CLEANRC=ZERO;                   /* CLEAR RETURN CODE             */
         SLR   CLEANRC,CLEANRC                                     0974
*   RETURN CODE(CLEANRC);           /* RETURN W/ RC                  */
         LR    @15,CLEANRC                                         0975
         L     @14,12(,@13)                                        0975
         LM    @00,@12,20(@13)                                     0975
         BR    @14                                                 0975
*   END TPRCLEAN;                                                  0976
*                                                                  0977
*/********************************************************************/
*/*                                                                  */
*/* SELFND                                                           */
*/*                                                                  */
*/* INPUT  - SYSMOD TO BE LOCATED IN THE SELECT/GROUP GTA FILE       */
*/*                                                                  */
*/* OUTPUT - "SYSMOD FOUND" FLAG IN THE SELECT/GROUP GTA RECORD      */
*/*          FOR THE INPUT SYSMOD IF FOUND                           */
*/*        - RETURN CODE:                                            */
*/*           0 - FOUND IN THE GTA FILE                              */
*/*           4 - NOT FOUND IN THE GTA FILE                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0977
*SELFND:                                                           0977
*   PROC(SELFNAME);                 /* SYSMOD TO FIND                */
SELFND   STM   @14,@12,@SA00020                                    0977
         MVC   @PC00020(4),0(@01)                                  0977
*   DCL                                                            0978
*     SELFNAME CHAR(LENGTH(IOPNAM17));/* SYSMOD NAME TO SEARCH FOR   */
*   DCL                                                            0979
*     SELFNDRC FIXED(15);           /* RETURN CODE                   */
*   RFY                                                            0980
*     HMASMGTP BASED(TBLXSEGT);                                    0980
*   RFY                                                            0981
*     HMASMSET BASED(GTPBUFAD);                                    0981
*   SELFNDRC=ZERO;                  /* CLEAR RETURN CODE             */
         SLR   SELFNDRC,SELFNDRC                                   0982
*                                                                  0983
*   /*****************************************************************/
*   /*                                                               */
*   /* INTIALIZE FOR SEARCH OF SELECT/GROUP LIST                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0983
*   HMASMSET=''B;                   /* CLEAR BUFFER                  */
         L     @10,@PC00001                                        0983
         L     @10,TBLXSEGT(,@10)                                  0983
         L     @08,GTPBUFAD(,@10)                                  0983
         XC    HMASMSET(12,@08),HMASMSET(@08)                      0983
*   SESMD=ON;                       /* SELECT LIST TYPE IS SYSMOD    */
         OI    SESMD(@08),B'00000001'                              0984
*   SENAME=' ';                     /* BLANK SELECT NAME             */
         MVI   SENAME+1(@08),C' '                                  0985
         MVC   SENAME+2(6,@08),SENAME+1(@08)                       0985
         MVI   SENAME(@08),C' '                                    0985
*   GTPFUNCT=GTPLOC;                /* GTP FUNCTION IS LOCATE        */
         MVI   GTPFUNCT(@10),X'03'                                 0986
*   SESMDNO=SELFNAME;               /* SEARCH FOR GIVEN SYSMOD       */
         L     @03,@PC00020                                        0987
         MVC   SESMDNO(7,@08),SELFNAME(@03)                        0987
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */
         ST    @10,@AL00001                                        0988
         L     @15,@CV01233                                        0988
         LA    @01,@AL00001                                        0988
         BALR  @14,@15                                             0988
*   IF GTPRETRN^=GTPGOOD THEN       /* NOT FOUND?                    */
         L     @10,@PC00001                                        0989
         L     @10,TBLXSEGT(,@10)                                  0989
         CLI   GTPRETRN(@10),0                                     0989
         BE    @RF00989                                            0989
*     DO;                           /* YES,                          */
*       SELFNDRC=GTPNTFND;          /* NOT FOUND RETURN CODED        */
         LA    SELFNDRC,4                                          0991
*     END;                                                         0992
*   ELSE                            /* FOUND                         */
*     DO;                                                          0993
         B     @RC00989                                            0993
@RF00989 DS    0H                                                  0994
*       SEFLAG2A=ON;                /* MARK SELECT ENTRY AS FOUND ON
*                                      CDS                           */
         L     @10,@PC00001                                        0994
         L     @10,TBLXSEGT(,@10)                                  0994
         L     @08,GTPBUFAD(,@10)                                  0994
         OI    SEFLAG2A(@08),B'10000000'                           0994
*       GTPFUNCT=GTPADD;            /* ADD ENTRY BACK WITH FLAG SET  */
         MVI   GTPFUNCT(@10),X'04'                                 0995
*       CALL HMASMGTA(HMASMGTP);    /* ...                           */
         ST    @10,@AL00001                                        0996
         L     @15,@CV01233                                        0996
         LA    @01,@AL00001                                        0996
         BALR  @14,@15                                             0996
*       SELFNDRC=MAX(SELFNDRC,GTPRETRN);/* SAVE THE RETURN CODE      */
         L     @10,@PC00001                                        0997
         L     @10,TBLXSEGT(,@10)                                  0997
         SLR   @08,@08                                             0997
         IC    @08,GTPRETRN(,@10)                                  0997
         CR    SELFNDRC,@08                                        0997
         BNL   *+6
         LR    SELFNDRC,@08                                        0997
*     END;                                                         0998
*   RETURN CODE(SELFNDRC);          /* RETURN W/ RC                  */
@RC00989 LR    @15,SELFNDRC                                        0999
         L     @14,@SA00020                                        0999
         LM    @00,@12,@SA00020+8                                  0999
         BR    @14                                                 0999
*   RFY                                                            1000
*     HMASMGTP BASED;                                              1000
*   RFY                                                            1001
*     HMASMSET BASED;                                              1001
*   END SELFND;                                                    1002
*   END HMASMTPR                    /*                               */
*                                                                  1003
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*                                                                  1003
*       ;                                                          1003
@DATA    DS    0H
@CH00037 DC    H'4'
@CH00065 DC    H'7'
@CH00055 DC    H'8'
@CH00033 DC    H'12'
@CH01237 DC    H'46'
@CH01245 DC    H'99'
@CH00349 DC    H'100'
@CH01508 DC    H'116'
@CH01248 DC    H'120'
@CH01239 DC    H'229'
@CH01241 DC    H'234'
         DS    0F
@AL00372 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00424 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00444 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00545 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00601 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00850 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00904 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    14F
@PC00003 DS    1F
@SA00012 DS    15F
@SA00015 DS    15F
@SA00005 DS    15F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00006 DS    15F
@PC00006 DS    1F
@SA00017 DS    0F
@PC00017 EQU   @SA00017+60
@SA00016 DS    0F
@SA00014 DS    0F
@PC00014 EQU   @SA00014+60
@SA00013 DS    0F
@PC00013 EQU   @SA00013+60
@SA00020 DS    0F
@PC00020 EQU   @SA00020+60
@SA00004 DS    0F
@PC00004 EQU   @SA00004+60
@SA00011 DS    0F
@PC00011 EQU   @SA00011+60
@SA00010 DS    0F
@PC00010 EQU   @SA00010+60
@SA00009 DS    0F
         DS    17F
@AL00001 DS    4A
@TF00001 DS    F
@AFTEMPS DS    1F
         DS    0F
@CF00081 DC    F'0'
@CF00063 DC    F'1'
@CH00063 EQU   @CF00063+2
@CF00273 DC    F'2'
@CF01534 DC    F'-116'
@CF01538 DC    F'-108'
@CF01539 DC    F'-107'
@CF01532 DC    F'-104'
@CF01531 DC    F'-99'
@CF01533 DC    F'-94'
@CF01535 DC    F'-48'
@CF01540 DC    F'-40'
@CF01536 DC    F'-36'
@CF01541 DC    F'-20'
@CF01537 DC    F'-8'
@CV01228 DC    V(HMASMIO)
@CV01229 DC    V(HMASMMSG)
@CV01230 DC    V(HMASMTAD)
@CV01231 DC    V(HMASMTEC)
@CV01232 DC    V(HMASMTSB)
@CV01233 DC    V(HMASMGTA)
         DS    0D
SMDICT@  DS    A
@CC01388 DC    C'P'
         DS    CL3
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL28
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00140 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00141 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL16
         ORG   MGPVAR
MGPVARPT DS    4A
         ORG   HMASMMGP+28
PATCHTPR DS    CL80
         ORG   PATCHTPR
@NM00142 DC    80X'FF'
         ORG   PATCHTPR+80
TPRFLAGS DS    CL1
         ORG   TPRFLAGS
@NM00143 DS    BL1
         ORG   TPRFLAGS+1
LSTFLAGS DS    CL2
         ORG   LSTFLAGS
LST1SMD  DS    BL1
LST2SMD  EQU   LSTFLAGS+0
CDSEOF   EQU   LSTFLAGS+0
ACDSEOF  EQU   LSTFLAGS+0
GETCDS   EQU   LSTFLAGS+0
ACDSGET  EQU   LSTFLAGS+0
LSTENT1  EQU   LSTFLAGS+0
LSTENT2  EQU   LSTFLAGS+0
@NM00145 DS    BL1
         ORG   LSTFLAGS+2
CDSFLAGS DS    CL1
         ORG   CDSFLAGS
CDSVALID DS    BL1
@NM00146 EQU   CDSFLAGS+0
         ORG   CDSFLAGS+1
ACDSFLGS DS    CL1
         ORG   ACDSFLGS
ACDSVALD DS    BL1
@NM00147 EQU   ACDSFLGS+0
         ORG   ACDSFLGS+1
SELCFLGS DS    CL1
         ORG   SELCFLGS
SELCEOF  DS    BL1
@NM00148 EQU   SELCFLGS+0
         ORG   SELCFLGS+1
SMDIFLGS DS    CL1
         ORG   SMDIFLGS
SRELFND  DS    BL1
@NM00149 EQU   SMDIFLGS+0
         ORG   SMDIFLGS+1
GRPFLAGS DS    BL1
         ORG   GRPFLAGS
GRPADD   DS    BL1
@NM00150 EQU   GRPFLAGS+0
         ORG   GRPFLAGS+1
SET2FLGS DS    CL1
         ORG   SET2FLGS
SET2END  DS    BL1
@NM00151 EQU   SET2FLGS+0
         ORG   SET2FLGS+1
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SELFNDRC EQU   @02
CLEANRC  EQU   @02
NEWEND   EQU   @03
CURPTR   EQU   @02
COMPRSRC EQU   @04
REQSX1   EQU   @02
REQSRC   EQU   @03
SUPCSUPX EQU   @03
SUPCSMDX EQU   @02
SUPCHKRC EQU   @04
REQCSMDX EQU   @02
REQCHKRC EQU   @03
SET2RC   EQU   @02
SETRC    EQU   @02
SETX     EQU   @03
GRPX2    EQU   @02
GRPPTFX  EQU   @03
GRPRC    EQU   @04
DT2RC    EQU   @02
SMDICTRC EQU   @03
SELCHKRC EQU   @02
LSTCRC   EQU   @03
ACDSRC   EQU   @03
CDSRRC   EQU   @03
CDSRC    EQU   @03
LSTGETRC EQU   @02
LST2IOP@ EQU   @05
LST1IOP@ EQU   @04
LSTBLDRC EQU   @06
TPRINTRC EQU   @02
TPRRC    EQU   @03
CCAPTR   EQU   @11
RTNCODE  EQU   @15
RTNREG   EQU   @14
TBLXOPTS EQU   0
TBLFLAGS EQU   TBLXOPTS+8
TBLFLG1  EQU   TBLFLAGS
TBLFLG2  EQU   TBLFLAGS+2
TBLGROUP EQU   TBLFLG2
TBLFLG3  EQU   TBLFLAGS+3
TBLFLG4  EQU   TBLFLAGS+5
TBLFLG5  EQU   TBLFLAGS+7
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAICPTF EQU   CCAFICT+4
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00023 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCADSIDA EQU   0
CCABLDLA EQU   0
@NM00039 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00041 EQU   CCABLDLL
CCALKDRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00047+20
@NM00049 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00049+20
@NM00051 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00051+20
@NM00053 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00053+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00057 EQU   HMASMIOP+12
@NM00058 EQU   @NM00057
IOPDDNAM EQU   HMASMIOP+24
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPEND  EQU   ICTPTFS
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPDELP EQU   ICTPFLG5
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPRCND EQU   ICTPFLG2
ICTPFLG4 EQU   ICTPTF+13
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
@NM00100 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPTYPE EQU   ICTPTF+17
ICTPFMID EQU   ICTPTF+22
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTND EQU   ICTENTNM
ICTENTST EQU   ICTENTNT+7
ICTEREQS EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTSBYND EQU   ICTSBYNM
HMASMSET EQU   0
SELSTENT EQU   HMASMSET
SELSTFLG EQU   SELSTENT
SESMD    EQU   SELSTFLG
SENAME   EQU   SELSTENT+2
SESMDNO  EQU   SENAME
SEFLAGS  EQU   HMASMSET+10
SEFLAG2  EQU   HMASMSET+11
SEFLAG2A EQU   SEFLAG2
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
SCLMAP   EQU   0
SCLKEY   EQU   SCLMAP
SCLDATA  EQU   SCLMAP+15
SCLSTAT  EQU   SCLDATA
TSLPARMS EQU   0
TSLPMLAD EQU   TSLPARMS+4
TSLFUNCT EQU   TSLPARMS+8
TSLRETRN EQU   TSLPARMS+9
TSLICTSR EQU   0
TSLISMD  EQU   TSLICTSR
TSLIOPTF EQU   TSLICTSR+7
TSLICTP  EQU   TSLICTSR+8
TSLICTF  EQU   TSLICTSR+12
TSLIFND  EQU   TSLICTF
TSLLSTSR EQU   0
TSLLSMD  EQU   TSLLSTSR
TSLLOPTF EQU   TSLLSTSR+7
TSLLONXT EQU   TSLLOPTF
TSLLOFST EQU   TSLLSTSR+8
TSLLRTNP EQU   TSLLSTSR+12
TSLGET   EQU   0
TSLGOPTF EQU   TSLGET+7
TSLSICDS EQU   0
TSLSOPTF EQU   TSLSICDS+7
TSLSICTF EQU   TSLSICDS+16
TSLSCDSF EQU   TSLSICDS+18
TSLENTSR EQU   0
TSLEOPTF EQU   TSLENTSR+2
TSLMFUNC EQU   0
TSLMTYPE EQU   TSLMFUNC
TSLMSMD  EQU   TSLMFUNC+1
TSLRELM  EQU   0
D2RCRD   EQU   0
D2RKEY   EQU   D2RCRD
D2RSMD   EQU   D2RKEY
D2RDATA  EQU   D2RCRD+7
D2RFLAGS EQU   D2RDATA
D2RFOK   EQU   D2RFLAGS
D2RFERR  EQU   D2RFLAGS
D2RFDEL  EQU   D2RFLAGS
LSTSMD1  EQU   0
LSTSMD2  EQU   0
CCATYPEA EQU   0
TBLXPARM EQU   0
TBLXINDX EQU   TBLXPARM+4
TBLXIOPF EQU   TBLXPARM+20
TBLXSEGT EQU   TBLXPARM+24
TBLXTBL  EQU   TBLXPARM+28
TBLXTOP  EQU   TBLXPARM+32
TBLXFUNC EQU   TBLXPARM+64
TBLXFLG1 EQU   TBLXPARM+80
TBLXTSLP EQU   TBLXPARM+84
TBLXRC   EQU   TBLXPARM+92
TBLXD2GT EQU   TBLXPARM+100
LSTIOP   EQU   0
GLMGIOP  EQU   0
CDSRCIOP EQU   0
SMDIIOP  EQU   0
DT2IOP   EQU   0
SETNDX@  EQU   0
SETINCR  EQU   0
SET2ENT  EQU   0
SET2OFST EQU   0
REQSLST@ EQU   0
REQSINCR EQU   0
SELFNAME EQU   0
IOPUDATA EQU   IOPEND
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPTYPE EQU   IOPPTFDR+1
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPERROR EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPDELP  EQU   IOPPTFF2
IOPPTFF3 EQU   IOPPSTAT+3
IOPSBYP  EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPPTFFX EQU   IOPPTFNT+24
@NM00072 EQU   IOPPTFFX
@NM00073 EQU   @NM00072
IOPPDTES EQU   IOPPTFFX+41
@NM00076 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
ICTENDNT EQU   ICTENDCH
ICTENDIX EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00089 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00088 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00087 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00086 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00085 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00084 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00083 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00082 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00081 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00080 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00079 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00078 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00077 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00076+3
IOPRECD  EQU   @NM00076
@NM00075 EQU   IOPPTFFX+8
@NM00074 EQU   @NM00072+7
IOPPRELN EQU   @NM00073
@NM00071 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00070 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00069 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
@NM00068 EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
@NM00067 EQU   IOPPTFDR
IOPPTMAX EQU   IOPCDMAX
@NM00066 EQU   IOPSCMAP+11
@NM00065 EQU   IOPSCMAP+8
@NM00064 EQU   IOPSCMAP
TBLXEND0 EQU   TBLXPARM+124
@NM00007 EQU   TBLXPARM+108
TBLXIOP3 EQU   TBLXPARM+104
TBLXDLGT EQU   TBLXPARM+96
@NM00006 EQU   TBLXRC+3
TBLXIRC  EQU   TBLXRC+2
TBLXLRC  EQU   TBLXRC+1
TBLXTRC  EQU   TBLXRC
TBLXIBGN EQU   TBLXPARM+88
@NM00005 EQU   TBLXPARM+83
@NM00004 EQU   TBLXPARM+82
@NM00003 EQU   TBLXPARM+81
@NM00002 EQU   TBLXFLG1
TBLXTCRC EQU   TBLXFLG1
TBLXFUND EQU   TBLXPARM+72
@NM00001 EQU   TBLXPARM+62
TBLXCRQI EQU   TBLXPARM+61
TBLXCDSI EQU   TBLXPARM+60
TBLXLMGT EQU   TBLXPARM+56
TBLXSCGT EQU   TBLXPARM+52
TBLXSREL EQU   TBLXPARM+48
TBLXASGT EQU   TBLXPARM+44
TBLXIFGT EQU   TBLXPARM+40
TBLXNULL EQU   TBLXPARM+36
TBLXIOP2 EQU   TBLXPARM+16
TBLXEND  EQU   TBLXINDX+8
TBLXSTRT EQU   TBLXINDX+4
TBLXCUR  EQU   TBLXINDX
TBLXHDR  EQU   TBLXPARM
@NM00144 EQU   D2RFLAGS
TSLRRTNP EQU   TSLRELM+12
TSLRAPTR EQU   TSLRELM+8
@NM00139 EQU   TSLRELM+7
TSLRSMD  EQU   TSLRELM
TSLEFNDP EQU   TSLENTSR+12
TSLEBGNP EQU   TSLENTSR+8
TSLENMEP EQU   TSLENTSR+4
@NM00138 EQU   TSLENTSR+3
@NM00137 EQU   TSLEOPTF
TSLEONXT EQU   TSLEOPTF
TSLEVER# EQU   TSLENTSR+1
TSLETYPE EQU   TSLENTSR
@NM00136 EQU   TSLSICDS+19
TSLSDUM  EQU   TSLSCDSF
TSLSCERR EQU   TSLSCDSF
@NM00135 EQU   TSLSCDSF
@NM00134 EQU   TSLSCDSF
TSLSCDEL EQU   TSLSCDSF
TSLSCSUP EQU   TSLSCDSF
TSLSCOK  EQU   TSLSCDSF
TSLSCFND EQU   TSLSCDSF
@NM00133 EQU   TSLSICDS+17
TSLSISLS EQU   TSLSICTF
TSLSINOG EQU   TSLSICTF
TSLSIDLI EQU   TSLSICTF
TSLSIDLE EQU   TSLSICTF
TSLSIDEL EQU   TSLSICTF
TSLSISUP EQU   TSLSICTF
TSLSIOK  EQU   TSLSICTF
TSLSIFND EQU   TSLSICTF
TSLSIOPP EQU   TSLSICDS+12
TSLSICTP EQU   TSLSICDS+8
@NM00132 EQU   TSLSOPTF
TSLSOXTD EQU   TSLSOPTF
TSLSOMSG EQU   TSLSOPTF
TSLSOALL EQU   TSLSOPTF
TSLSOCDS EQU   TSLSOPTF
TSLSOICT EQU   TSLSOPTF
TSLSSMD  EQU   TSLSICDS
TSLGDSID EQU   TSLGET+12
TSLGIOPP EQU   TSLGET+8
@NM00131 EQU   TSLGOPTF
TSLGOXTD EQU   TSLGOPTF
TSLGOMSG EQU   TSLGOPTF
@NM00130 EQU   TSLGOPTF
@NM00129 EQU   TSLGOPTF
@NM00128 EQU   TSLGOPTF
TSLGSMD  EQU   TSLGET
@NM00127 EQU   TSLLOPTF
@NM00126 EQU   TSLICTSR+13
@NM00125 EQU   TSLICTF
TSLINOG  EQU   TSLICTF
TSLIDLI  EQU   TSLICTF
TSLIDLE  EQU   TSLICTF
TSLIDEL  EQU   TSLICTF
TSLISUP  EQU   TSLICTF
TSLIOK   EQU   TSLICTF
@NM00124 EQU   TSLIOPTF
TSLIONXT EQU   TSLIOPTF
TSLTBLXP EQU   TSLPARMS
SCLEND   EQU   SCLDATA+2
SCLVERNO EQU   SCLDATA+1
SCLREDO  EQU   SCLSTAT
SCLCAND  EQU   SCLSTAT
SCLSELST EQU   SCLSTAT
SCLDELP  EQU   SCLSTAT
SCLFMID  EQU   SCLKEY+8
SCLSMD   EQU   SCLKEY+1
SCLISTNO EQU   SCLKEY
@NM00123 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00122 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPWKAD  EQU   HMASMGTP+8
GTPKEYLN EQU   HMASMGTP+6
GTPRCDLN EQU   HMASMGTP+4
@NM00121 EQU   HMASMGTP+2
SEFLAG2H EQU   SEFLAG2
SEFLAG2G EQU   SEFLAG2
SEFLAG2F EQU   SEFLAG2
SEFLAG2E EQU   SEFLAG2
SEFLAG2D EQU   SEFLAG2
SEFLAG2C EQU   SEFLAG2
SEFLAG2B EQU   SEFLAG2
SEFOUND  EQU   SEFLAGS
@NM00120 EQU   SEFLAGS
SEFMID   EQU   SEFLAGS
SENOJCL  EQU   SEFLAGS
SEEXCLUD EQU   SEFLAGS
SESELECT EQU   SEFLAGS
SEGROUP  EQU   SEFLAGS
@NM00119 EQU   SENAME+7
SEPTFNO  EQU   SESMDNO
SESYS    EQU   SELSTFLG+1
SEFMD    EQU   SELSTFLG+1
SEASM    EQU   SELSTFLG+1
SELMD    EQU   SELSTFLG+1
SEMAC    EQU   SELSTFLG+1
SEMOD    EQU   SELSTFLG+1
SEDLB    EQU   SELSTFLG+1
SESRC    EQU   SELSTFLG+1
SEMCS    EQU   SELSTFLG
@NM00118 EQU   SELSTFLG
@NM00117 EQU   ICTSBYNT+7
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00116 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00115 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00114 EQU   ICTCSRST
@NM00113 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00112 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00111 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00110 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00109 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00108 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00107 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00106 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00105 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00104 EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
@NM00103 EQU   ICTENTST
ICTIXP   EQU   ICTIXPF
@NM00102 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPSUPN EQU   ICTPTF+20
ICTPONUM EQU   ICTPTF+18
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00101 EQU   @NM00100
ICTPRQBY EQU   @NM00100
ICTPRQOK EQU   @NM00100
ICTPRQCK EQU   @NM00100
@NM00099 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00098 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00097 EQU   ICTPFLG4
@NM00096 EQU   ICTPFLG4
@NM00095 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00094 EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00093 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00092 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
@NM00091 EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00090 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
@NM00063 EQU   IOPUSERL
@NM00062 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
IOPBUFAD EQU   HMASMIOP+52
@NM00061 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00060 EQU   @NM00057+10
IOPSEQNO EQU   @NM00057+8
@NM00059 EQU   @NM00058+7
IOPPTFNM EQU   @NM00058
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00056 EQU   CCABLDLM+2
@NM00055 EQU   CCABLDLM
CCAUPDPM EQU   @NM00053+24
@NM00054 EQU   @NM00053+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00053+12
CCAUPDTE EQU   @NM00053+8
CCAUPDNM EQU   @NM00053
CCASUPPM EQU   @NM00051+24
@NM00052 EQU   @NM00051+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00051+12
CCAIOSUP EQU   @NM00051+8
CCASUPNM EQU   @NM00051
CCAZAPPM EQU   @NM00049+24
@NM00050 EQU   @NM00049+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00049+12
CCASPZAP EQU   @NM00049+8
CCAZAPNM EQU   @NM00049
CCACOMPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00047+12
CCACOMRS EQU   @NM00047+8
CCACOMNM EQU   @NM00047
CCACPYPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00045+12
CCACOPY  EQU   @NM00045+8
CCACPYNM EQU   @NM00045
CCAASMPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00043+12
CCAASM   EQU   @NM00043+8
CCAASMNM EQU   @NM00043
CCALKDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00041+12
CCALKED  EQU   @NM00041+8
CCALKDNM EQU   @NM00041
CCAPGMPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCABPGRC EQU   @NM00039+20
CCABPGSP EQU   @NM00039+12
CCABPGAD EQU   @NM00039+8
CCABPGNM EQU   @NM00039
CCAEND   EQU   HMASMCCA+371
@NM00038 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00037 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00036 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00035 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00034 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00033 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00032 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00031 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00030 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00029 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00028 EQU   @NM00023+18
@NM00027 EQU   @NM00023+16
CCATBLPA EQU   @NM00023+12
@NM00026 EQU   @NM00023+8
@NM00025 EQU   @NM00023+4
@NM00024 EQU   @NM00023
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00022 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00021 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00020 EQU   CCAFBUFR+122
@NM00019 EQU   CCAFBUFR+120
@NM00018 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00017 EQU   CCAFBUFR+88
@NM00016 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00015 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00014 EQU   TBLFLG5
TBLICTOK EQU   TBLFLG5
@NM00013 EQU   TBLFLG4
TBLBPFM  EQU   TBLFLG4
@NM00012 EQU   TBLFLG4
TBLBPIRQ EQU   TBLFLG4
TBLBPREQ EQU   TBLFLG4
TBLBPPRE EQU   TBLFLG4
TBLBPID  EQU   TBLFLG4
@NM00011 EQU   TBLFLG3+1
TBLSTS   EQU   TBLFLG3
TBLMTS   EQU   TBLFLG3
TBLPTS   EQU   TBLFLG3
TBLACRQ  EQU   TBLFLG3
TBLCRQ   EQU   TBLFLG3
TBLSCDS  EQU   TBLFLG3
TBLACDS  EQU   TBLFLG3
TBLCDS   EQU   TBLFLG3
TBLMASS  EQU   TBLFLG2
@NM00010 EQU   TBLFLG2
TBLFMID  EQU   TBLFLG2
TBLEXC   EQU   TBLFLG2
TBLSEL   EQU   TBLFLG2
@NM00009 EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
TBLDISR  EQU   TBLFLG1+1
TBLDISN  EQU   TBLFLG1+1
TBLNOJCL EQU   TBLFLG1
TBLFLUSH EQU   TBLFLG1
TBLUSER  EQU   TBLFLG1
TBLAPAR  EQU   TBLFLG1
TBLCOMP  EQU   TBLFLG1
TBLASSEM EQU   TBLFLG1
TBLCHECK EQU   TBLFLG1
TBLNOAPP EQU   TBLFLG1
@NM00008 EQU   TBLXOPTS+5
TBLNUCID EQU   TBLXOPTS+4
TBLJCLGT EQU   TBLXOPTS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00237 EQU   @RC00235
@RF00339 EQU   @RC00337
@RC00411 EQU   @RC00408
@RF00741 EQU   @RC00702
@RC00768 EQU   @RC00766
@RC00804 EQU   @RC00802
@RC00239 EQU   @RC00237
@RC00413 EQU   @RC00411
@RF00433 EQU   @RC00411
@ENDDATA EQU   *
         END   HMASMTPR,(C'PLS2209',0802,78334)

         TITLE 'HMASMUPD - UPDATE CDS CONTROL DRIVER OF SMP'
HMASMUPD CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMUPD  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @08,@SA00001                                        0001
         ST    @08,8(,@13)                                         0001
         LR    @13,@08                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0203
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL FIELDS                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0203
*   UPDRTNCD=IOPGOOD;               /* INIT RC               @YA07506*/
         MVI   UPDRTNCD,X'00'                                      0203
*   NAMESAVE=BLANK;                 /* BLANK SAVE AREA FOR NAME      */
         MVI   NAMESAVE+1,C' '                                     0204
         MVC   NAMESAVE+2(6),NAMESAVE+1                            0204
         MVI   NAMESAVE,C' '                                       0204
*   STEPNAME=BLANK;                 /* INDICATE BLANK STEP           */
         MVI   STEPNAME+1,C' '                                     0205
         MVC   STEPNAME+2(6),STEPNAME+1                            0205
         MVI   STEPNAME,C' '                                       0205
*   JOBNAME=BLANK;                  /* INDICATE BLANK JOB            */
         MVI   JOBNAME+1,C' '                                      0206
         MVC   JOBNAME+2(6),JOBNAME+1                              0206
         MVI   JOBNAME,C' '                                        0206
*   IOPPTR=CCAIOPTR;                /* INITIALIZE PTR TO IOP         */
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0207
*   FLAGS=ZERO;                     /* ZERO INDICATOR FLAGS          */
         MVI   FLAGS,X'00'                                         0208
*   BUFRPTR=ADDR(JCLBUF);           /* INIT ADDR OF JCL BUFFER       */
         LA    @08,JCLBUF                                          0209
         ST    @08,BUFRPTR                                         0209
*   MAXJCL=INCR;                    /* SET MAX NUMBER OF JCL STMTS   */
*                                                                  0210
         MVC   MAXJCL(2),@CH00488                                  0210
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SCAN PARAMETER AND MESSAGE PARAMETER       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0211
*   HMASMSCP=''B;                   /* INIT SCAN PARM        @Z67SP00*/
         XC    HMASMSCP(26),HMASMSCP                               0211
*   HMASMMGP=HMASMMGP&&HMASMMGP;    /* INIT MSG PARM         @Z40SP00*/
         XC    HMASMMGP(24),HMASMMGP                               0212
*   MGPHLDS=ON;                     /* INDICATE MSG TO LOG   @XA06770*/
*   MGPPRINT=ON;                    /* INDICATE MESSAGES TO PRINTER  */
*                                                                  0214
         OI    MGPHLDS,B'10010000'                                 0214
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE PARAMETER TO HMASMBUE TO BACKUP ENTRIES    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0215
*   BUPPARM=''B;                    /* INIT TO ZERO          @Z67SP00*/
         XC    BUPPARM(20),BUPPARM                                 0215
*   BUPFUNCT=BUPABKUP;              /* FUNCT IS ADD          @Z67SP00*/
         MVI   BUPFUNCT,X'01'                                      0216
*   BUPIOPAD=ADDR(HMASMIOP);        /* CHIN TO IOP           @Z67SP00*/
         ST    IOPPTR,BUPIOPAD                                     0217
*   BUPSYSMD=UPDSYSMD;              /* SYSMOD NUMBER         @Z67SP00*/
         L     @08,@PC00001                                        0218
         MVC   BUPSYSMD(7),UPDSYSMD(@08)                           0218
*   BUPSTYPE=UPDSTYPE;              /*                       @Z67SP00*/
         IC    @07,UPDSTYPE(,@08)                                  0219
         STC   @07,BUPSTYPE                                        0219
*   BUPGTPAD=UPDGTPAD;              /* GTP FOR ASSEM FILE    @Z67SP00*/
         L     @07,UPDGTPAD(,@08)                                  0220
         ST    @07,BUPGTPAD                                        0220
*   IF UPDREDO=ON                   /* IF SYSMOD BEING       @Z67SP00*/
*     THEN                          /* REPROCESSED           @Z67SP00*/
         TM    UPDREDO(@08),B'00100000'                            0221
         BNO   @RF00221                                            0221
*     BUPREDO=ON;                   /* THEN PASS INFO TO BUE @Z67SP00*/
         OI    BUPREDO,B'10000000'                                 0222
         EJECT
*                                                                  0223
*   /*****************************************************************/
*   /*                                                               */
*   /* MODIFY ALTERNATE DSCAN WITH PARM LIST PASSED FROM DRV         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0223
*   RFY                                                            0223
*     DSCANMAP BASED(ALTADDR(I));   /*                               */
@RF00221 DS    0H                                                  0224
*   DO I=1 TO DIM(UPDPGMS);         /* SCAN ALL ENTRIES      @Z67SP00*/
         LA    @08,1                                               0224
         STH   @08,I                                               0224
@DL00224 DS    0H                                                  0225
*     IF UPDPGMLN(I)^=0             /* AND ALT PGM?          @Z67SP00*/
*       THEN                        /* YES                   @SA73847*/
         LR    @07,@08                                             0225
         MH    @07,@CH00467                                        0225
         L     @06,@PC00001                                        0225
         LA    @01,0(@07,@06)                                      0225
         AL    @01,@CF01597                                        0225
         SLR   @05,@05                                             0225
         IC    @05,UPDPGMLN(,@01)                                  0225
         LTR   @05,@05                                             0225
         BZ    @RF00225                                            0225
*       DO;                         /* CHANGE DSCAN          @SA73847*/
*         DSCKEY(1:UPDPGMLN(I))=UPDPGMNM(I,1:UPDPGMLN(I));/* MOVE PGM
*                                      NAME TO DSCAN KEY AREA      0227
*                                                            @Z67SP00*/
         SLA   @08,2                                               0227
         L     @08,ALTADDR-4(@08)                                  0227
         LR    @04,@05                                             0227
         BCTR  @04,0                                               0227
         ALR   @06,@07                                             0227
         AL    @06,@CF01598                                        0227
         EX    @04,@SM01599                                        0227
*         DSCKEYLN=UPDPGMLN(I);     /* SET UP DSCAN KEY LEN  @Z67SP00*/
         STC   @05,DSCKEYLN(,@08)                                  0228
*       END;                        /*                       @SA73847*/
*   END;                            /* END DSCAN SET UP      @SA73847*/
*                                                                  0230
@RF00225 LA    @08,1                                               0230
         AH    @08,I                                               0230
         STH   @08,I                                               0230
         C     @08,@CF00037                                        0230
         BNH   @DL00224                                            0230
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE PARAMETER FOR HMASMCRD. IF INPUT DATASET IS EITHER */
*   /* THE PTS OR SMPJCLIN THEN NO PROCESSING REQUIRED. SMPJCLIN WILL*/
*   /* BE OPENED AT FIRST GET AND PTS HAS ALREADY BEEN PREPARED BY   */
*   /* CALLER.                                               @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0231
*   HMASMCRP=''B;                   /* INIT TO ZERO          @Z67SP00*/
         XC    HMASMCRP(106),HMASMCRP                              0231
*   CRPINDS=UPDDSID;                /* MOVE INPUT DSID       @Z67SP00*/
         L     @08,@PC00001                                        0232
         IC    @07,UPDDSID(,@08)                                   0232
         STC   @07,CRPINDS                                         0232
*   CRPDDNAM=UPDDDNAM;              /* MOVE INPUT DDNAME     @Z67SP00*/
         MVC   CRPDDNAM(8),UPDDDNAM(@08)                           0233
*   IF CRPINDS=IOPLRF               /* IF RELFILE            @Z67SP00*/
*       ×CRPINDS=IOPANYDD           /* OR TXTLIB             @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CLI   CRPINDS,32                                          0234
         BE    @RT00234                                            0234
         CLI   CRPINDS,24                                          0234
         BNE   @RF00234                                            0234
@RT00234 DS    0H                                                  0235
*     DO;                           /*                       @Z67SP00*/
*       IOPRETRN=IOPGOOD;           /*                       @Z67SP00*/
         MVI   IOPRETRN(IOPPTR),X'00'                              0236
*       IOPDSID=CRPINDS;            /* SET UP IOP            @Z67SP00*/
         IC    @08,CRPINDS                                         0237
         STC   @08,IOPDSID(,IOPPTR)                                0237
*       IF CRPINDS=IOPLRF           /* IF RELFILE THEN       @Z67SP00*/
*         THEN                      /* MUST ALLOC IT         @Z67SP00*/
         CLI   CRPINDS,32                                          0238
         BNE   @RF00238                                            0238
*         DO;                       /*                       @Z67SP00*/
*           IOPDSN=UPDDSNAM;        /* PASS LRF DATASET NAME @Z67SP00*/
         L     @08,@PC00001                                        0240
         MVC   IOPDSN(44,IOPPTR),UPDDSNAM(@08)                     0240
*           IOPSPACE=''B;           /* ZERO SPACE(DS EXISTS) @Z67SP00*/
         XC    IOPSPACE(6,IOPPTR),IOPSPACE(IOPPTR)                 0241
*           IOPFUNCT=IOPALC;        /* ALLOC SMPTLIB         @Z67SP00*/
         MVI   IOPFUNCT(IOPPTR),X'0D'                              0242
*           CALL HMASMIO(HMASMIOP); /* ALLOC DATASET         @Z67SP00*/
         ST    IOPPTR,@AL00001                                     0243
         L     @15,@CV01377                                        0243
         LA    @01,@AL00001                                        0243
         BALR  @14,@15                                             0243
*           UPDRTNCD=MAX(UPDRTNCD,IOPRETRN);/* SAVE RC       @Z67SP00*/
         SLR   @08,@08                                             0244
         IC    @08,UPDRTNCD                                        0244
         SLR   @07,@07                                             0244
         IC    @07,IOPRETRN(,IOPPTR)                               0244
         CR    @08,@07                                             0244
         BNL   *+6
         LR    @08,@07                                             0244
         STC   @08,UPDRTNCD                                        0244
*           DDNAME=TXTLRF;          /* SET UP FOR MSG        @Z67SP00*/
         MVC   DDNAME(8),@CC01420                                  0245
*           IF IOPRETRN=IOPGOOD     /* IF ALC OK             @Z67SP00*/
*             THEN                  /* REMEMBER SO FREE      @Z67SP00*/
         CLI   IOPRETRN(IOPPTR),0                                  0246
         BNE   @RF00246                                            0246
*             ALCDONE=ON;           /* CAN BE DONE           @Z67SP00*/
         OI    ALCDONE,B'00010000'                                 0247
*         END;                      /* END RELFILE           @Z67SP00*/
*       ELSE                        /* MUST BE TXTLIB        @Z67SP00*/
*         DO;                       /*                       @Z67SP00*/
         B     @RC00238                                            0249
@RF00238 DS    0H                                                  0250
*           IOPDDNAM=UPDDDNAM;      /* TO CORRECT DDNAME     @Z67SP00*/
         L     @08,@PC00001                                        0250
         MVC   IOPDDNAM(8,IOPPTR),UPDDDNAM(@08)                    0250
*           DDNAME=UPDDDNAM;        /*                       @Z67SP00*/
         MVC   DDNAME(8),UPDDDNAM(@08)                             0251
*         END;                      /*                       @Z67SP00*/
*       IF IOPRETRN=IOPGOOD         /*                       @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
@RC00238 CLI   IOPRETRN(IOPPTR),0                                  0253
         BNE   @RF00253                                            0253
*         DO;                       /*                       @Z67SP00*/
*           IOPNAME=BUPSYSMD;       /*                               */
         MVI   IOPNAME+7(IOPPTR),C' '                              0255
         MVC   IOPNAME(7,IOPPTR),BUPSYSMD                          0255
*           IOPTYPE=IOPMEM;         /*                               */
         MVI   IOPTYPE(IOPPTR),X'11'                               0256
*           IOPFUNCT=IOPBLDL;       /* NOW FIND MEMBER ON    @Z67SP00*/
         MVI   IOPFUNCT(IOPPTR),X'04'                              0257
*           CALL HMASMIO(HMASMIOP); /* GET MEMBER            @Z67SP00*/
         ST    IOPPTR,@AL00001                                     0258
         L     @15,@CV01377                                        0258
         LA    @01,@AL00001                                        0258
         BALR  @14,@15                                             0258
*           IF IOPRETRN=IOPGOOD     /* IF DATASET OPENED OK  @Z67SP00*/
*             THEN                  /* AND MEMBER FOUND      @Z67SP00*/
         CLI   IOPRETRN(IOPPTR),0                                  0259
         BNE   @RF00259                                            0259
*             DO;                   /* THEN POSITION TO READ @Z67SP00*/
*               IOPFUNCT=IOPPOSI;   /* DATA                  @Z67SP00*/
         MVI   IOPFUNCT(IOPPTR),X'02'                              0261
*               CALL HMASMIO(HMASMIOP);/*                    @Z67SP00*/
         ST    IOPPTR,@AL00001                                     0262
         L     @15,@CV01377                                        0262
         LA    @01,@AL00001                                        0262
         BALR  @14,@15                                             0262
*             END;                  /*                       @Z67SP00*/
*           ELSE                    /*                       @Z67SP00*/
*             IF IOPRETRN=IOPNTFND  /* IF NOT FOUND          @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
         B     @RC00259                                            0264
@RF00259 CLI   IOPRETRN(IOPPTR),4                                  0264
         BNE   @RF00264                                            0264
*               DO;                 /*                       @Z67SP00*/
*                 MGPCLEAR=''B;     /*                       @Z67SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0266
*                 MGPMGNO1=HMA246I; /* XXXXXXXX XXXXXXXX NOT FOUND ON
*                                      XXXXXXXX LIBRARY      @Z67SP00*/
         MVC   MGPMGNO1(2),@CH01388                                0267
*                 MGPVARPT(1)=ADDR(UPDSYSMD);/* SYSMOD NUMBER      0268
*                                                            @Z67SP00*/
         L     @08,@PC00001                                        0268
         LA    @08,UPDSYSMD(,@08)                                  0268
         ST    @08,MGPVARPT                                        0268
*                 MGPVARPT(2)=ADDR(TXTJCLIN);/* JCLIN        @Z67SP00*/
         LA    @08,@CC01422                                        0269
         ST    @08,MGPVARPT+4                                      0269
*                 MGPVARPT(3)=ADDR(DDNAME);/* LIBRARY DD NAME      0270
*                                                            @Z67SP00*/
         LA    @08,DDNAME                                          0270
         ST    @08,MGPVARPT+8                                      0270
*                 MGPTYPE=MGPERR;   /*                       @Z67SP00*/
         MVI   MGPTYPE,X'03'                                       0271
*                 CALL HMASMMSG(HMASMMGP);/* WRITE MSG       @Z67SP00*/
         L     @15,@CV01383                                        0272
         LA    @01,@AL00272                                        0272
         BALR  @14,@15                                             0272
*                 UPDRTNCD=MAX(UPDRTNCD,STOPPTF);/* RC=8     @Z67SP00*/
         SLR   @08,@08                                             0273
         IC    @08,UPDRTNCD                                        0273
         LA    @07,8                                               0273
         CR    @08,@07                                             0273
         BNL   *+6
         LR    @08,@07                                             0273
         STC   @08,UPDRTNCD                                        0273
*               END;                /*                       @Z67SP00*/
*         END;                      /* END DS ALLOCATED OK   @Z67SP00*/
@RF00264 DS    0H                                                  0275
@RC00259 DS    0H                                                  0276
*       UPDRTNCD=MAX(UPDRTNCD,IOPRETRN);/*                   @Z67SP00*/
@RF00253 SLR   @08,@08                                             0276
         IC    @08,UPDRTNCD                                        0276
         SLR   @07,@07                                             0276
         IC    @07,IOPRETRN(,IOPPTR)                               0276
         CR    @08,@07                                             0276
         BNL   *+6
         LR    @08,@07                                             0276
         STC   @08,UPDRTNCD                                        0276
*       IF UPDRTNCD>=STOPPTF        /* BLDL OR POSI. IF ERR  @Z67SP00*/
*         THEN                      /* THEN STOP PROCESS     @Z67SP00*/
         CLI   UPDRTNCD,8                                          0277
         BNL   @RT00277                                            0277
*         GO TO TERMMSG;            /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
         EJECT
*                                                                  0280
*   /*****************************************************************/
*   /*                                                               */
*   /* READ SYSGEN TAPE AND INVOKE SCAN                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0280
*   DO WHILE SCPRET=SCPGOOD;        /* PROCESS UNTIL EOF     @YA07506*/
@RF00234 B     @DE00280                                            0280
@DL00280 DS    0H                                                  0281
*     IF EOFSW=ON                   /* HAS EOF BEEN FOUNC?           */
*       THEN                        /* EOF ALREADY FOUND - EXIT      */
         TM    EOFSW,B'10000000'                                   0281
         BO    @RT00281                                            0281
*       GO TO GOODEXIT;             /* WITH GOOD RETURN CODE         */
*     UPDSW1=OFF;                   /* RESET SCAN SWITCHES   @YA05008*/
         MVI   UPDSW1,B'00000000'                                  0283
*     UPDSW2=OFF;                   /* RESET SCAN SWITCHES   @YA05008*/
         MVI   UPDSW2,B'00000000'                                  0284
*     IF SKIPREAD=OFF               /* IF OK TO READ                 */
*       THEN                        /* READ SYSGEN TAPE RECORD       */
         TM    SKIPREAD,B'01000000'                                0285
         BNZ   @RF00285                                            0285
*       DO;                                                        0286
*         CRPSCPAD=ADDR(HMASMSCP);  /* ADDR OF SCAN PARM     @Z67SP00*/
         LA    @08,HMASMSCP                                        0287
         ST    @08,CRPSCPAD                                        0287
*         CALL HMASMCRD(HMASMCRP);  /* RECORD FROM SMPJCLIN  @Z67SP00*/
         L     @15,@CV01379                                        0288
         LA    @01,@AL00288                                        0288
         BALR  @14,@15                                             0288
*         IF CRPRETRN=CRPGOOD       /* IF NEXT CARD READ     @Z67SP00*/
*             &(CRPINDS=IOPPTS      /* FROM PTS AND ITS A    @Z67SP00*/
*             &CRPBUFFR(1:2)='++')  /* CONTROL CARD THEN     @Z67SP00*/
*           THEN                    /* TREAT AS IF END OF    @Z67SP00*/
         CLI   CRPRETRN,0                                          0289
         BNE   @RF00289                                            0289
         CLI   CRPINDS,6                                           0289
         BNE   @RF00289                                            0289
         CLC   CRPBUFFR(2),@CC01487                                0289
         BNE   @RF00289                                            0289
*           CRPRETRN=CRPEOF;        /* FILE CONDITION        @Z67SP00*/
         MVI   CRPRETRN,X'04'                                      0290
*         IF CRPRETRN>CRPEOF        /* GOOD I/O OPERATION?   @Z67SP00*/
*           THEN                    /*                       @YA07506*/
@RF00289 CLI   CRPRETRN,4                                          0291
         BNH   @RF00291                                            0291
*           DO;                     /*                       @Z67SP00*/
*             UPDRTNCD=CRPRETRN;    /* SET BAD RC            @YA07506*/
         IC    @08,CRPRETRN                                        0293
         STC   @08,UPDRTNCD                                        0293
*             GO TO TERMMSG;        /* EXIT BADLY            @YA07506*/
         B     TERMMSG                                             0294
*           END;                    /*                       @YA07506*/
*         IF CRPRETRN=CRPEOF        /* END OF FILE ON TAPE?  @YA07506*/
*           THEN                    /* YES                   @SA75002*/
@RF00291 CLI   CRPRETRN,4                                          0296
         BNE   @RF00296                                            0296
*           IF FRSTREAD=ON          /* AT LEAST ONE READ?    @SA75002*/
*             THEN                  /* YES                   @SA75002*/
         TM    FRSTREAD,B'00100000'                                0297
         BO    @RT00297                                            0297
*             GO TO GOODEXIT;       /* EXIT OK               @SA75002*/
*           ELSE                    /* EOF ON FIRST READ     @SA75002*/
*             DO;                   /*                       @YA07506*/
*               UPDRTNCD=WARNPTF;   /* SET RC                @YA07506*/
         MVI   UPDRTNCD,X'04'                                      0300
*               MGPCLEAR=''B;       /* ZERO MSG PARM         @Z40SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0301
*               MGPTYPE=MGPWARN;    /* SET SEVERITY          @MS00001*/
         MVI   MGPTYPE,X'02'                                       0302
*               MGPMGNO1=HMA273I;   /* INPUT TEXT NOT FOUND  @YA12132*/
         MVC   MGPMGNO1(2),@CH00353                                0303
*               CALL HMASMMSG(HMASMMGP);/* WRITE MSG         @YA12132*/
         L     @15,@CV01383                                        0304
         LA    @01,@AL00304                                        0304
         BALR  @14,@15                                             0304
*               MGPTYPE=MGPINFO;    /* SET SEVERITY          @MS00001*/
         MVI   MGPTYPE,X'01'                                       0305
*               MGPMGNO1=HMA288I;   /* NO HMASMP UPDATE FUNCTIONS  0306
*                                      HAVE BEEN PERFORMED   @YA12132*/
         MVC   MGPMGNO1(2),@CH00557                                0306
*               CALL HMASMMSG(HMASMMGP);/* WRITE MSG         @Z40SP00*/
         L     @15,@CV01383                                        0307
         LA    @01,@AL00307                                        0307
         BALR  @14,@15                                             0307
*               GO TO EXIT;         /* EXIT WITH ERR MSG     @SA75002*/
         B     EXIT                                                0308
*             END;                  /*                       @YA07506*/
*         FRSTREAD=ON;              /* SET DID ONE READ SW   @SA75002*/
@RF00296 OI    FRSTREAD,B'00100000'                                0310
*       END;                                                       0311
*     ELSE                          /* OTHERWISE - RESET SKIP SWITCH */
*       SKIPREAD=OFF;               /* RESET SO READ NEXT TIME       */
         B     @RC00285                                            0312
@RF00285 NI    SKIPREAD,B'10111111'                                0312
*     BUFFER(1)=CRPBUFFR;           /* MOVE TO SCAN BUFFER   @Z67SP00*/
@RC00285 L     @08,BUFRPTR                                         0313
         MVC   BUFFER(80,@08),CRPBUFFR                             0313
*     SCPCHAR=ADDR(CRPBUFFR);       /* POINT TO SCAN BUFFER  @ZA28056*/
         LA    @08,CRPBUFFR                                        0314
         ST    @08,SCPCHAR                                         0314
*     SCPSRCH=ADDR(KSLBLNK);        /* SET FRST DSCAN ADDR   @Z67SP00*/
         LA    @08,KSLBLNK                                         0315
         ST    @08,SCPSRCH                                         0315
*     SCPINLN=LENGTH(CRPBFDTA);     /* SET INPUT CARD LEN    @Z67SP00*/
         MVC   SCPINLN(2),@CH01064                                 0316
*     CALL HMASMSCN(HMASMSCP);      /* SCAN JCL STATEMENT            */
         L     @15,@CV01380                                        0317
         LA    @01,@AL00317                                        0317
         BALR  @14,@15                                             0317
*   END;                                                           0318
@DE00280 CLI   SCPRET,0                                            0318
         BE    @DL00280                                            0318
         EJECT
*                                                                  0319
*   /*****************************************************************/
*   /*                                                               */
*   /* AN ERROR HAS OCCURRED. ISSUE MESSAGE INDICATING JOBNAME AND   */
*   /* STEP NAME CONTAINING FAILING JCL                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0319
*   MGPCLEAR=''B;                   /* ZERO MSG PARM         @Z67SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0319
*   MGPTYPE=MGPINFO;                /* SET SEVERITY          @MS00001*/
         MVI   MGPTYPE,X'01'                                       0320
*   MGPVARPT(1)=ADDR(STEPNAME);     /* POINT TO STEPNAME             */
         LA    @08,STEPNAME                                        0321
         ST    @08,MGPVARPT                                        0321
*   MGPVARPT(2)=ADDR(JOBNAME);      /* POINT TO JOBNAME              */
         LA    @08,JOBNAME                                         0322
         ST    @08,MGPVARPT+4                                      0322
*   MGPMGNO1=HMA263I;               /* ERROR OCCURRED IN STEP      0323
*                                      XXXXXXXX OF JOB XXXXXXXX    0323
*                                                            @Z40SP00*/
         MVC   MGPMGNO1(2),@CH01050                                0323
*   CALL HMASMMSG(HMASMMGP);        /* ISSUE MESSAGE                 */
*                                                                  0324
         L     @15,@CV01383                                        0324
         LA    @01,@AL00324                                        0324
         BALR  @14,@15                                             0324
*   /*****************************************************************/
*   /*                                                               */
*   /* FOLLOWING CODE IS FOR FORCED TERMINATE MESSAGE                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*TERMMSG:                           /*                       @OX05075*/
*   MGPCLEAR=''B;                   /* ZERO MSG PARM         @Z67SP00*/
TERMMSG  XC    MGPCLEAR(6),MGPCLEAR                                0325
*   MGPTYPE=MGPINFO;                /* SET SEVERITY          @MS00001*/
         MVI   MGPTYPE,X'01'                                       0326
*   MGPMGNO1=HMA262I;               /* ERROR FORCES SYSGEN SCAN TO 0327
*                                      TERMINATE             @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00708                                0327
*   CALL HMASMMSG(HMASMMGP);        /* ISSUE MESSAGE                 */
         L     @15,@CV01383                                        0328
         LA    @01,@AL00328                                        0328
         BALR  @14,@15                                             0328
         EJECT
*                                                                  0329
*   /*****************************************************************/
*   /*                                                               */
*   /* MAJOR RETURN POINT FROM HMASMUPD                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0329
*GOODEXIT:                          /*                       @YA07506*/
*   BUPFUNCT=BUPSTOW;               /* STOW SCDS SYSMOD      @Z67SP00*/
GOODEXIT MVI   BUPFUNCT,X'03'                                      0329
*   CALL HMASMBUE(BUPPARM);         /*                       @Z67SP00*/
         L     @15,@CV01378                                        0330
         LA    @01,@AL00330                                        0330
         BALR  @14,@15                                             0330
*   UPDRTNCD=MAX(UPDRTNCD,RTNCODE); /* SAVE RC               @Z67SP00*/
         SLR   @08,@08                                             0331
         IC    @08,UPDRTNCD                                        0331
         CR    @08,RTNCODE                                         0331
         BNL   *+6
         LR    @08,RTNCODE                                         0331
         STC   @08,UPDRTNCD                                        0331
*EXIT:                                                             0332
*   IOPFUNCT=IOPCLOSE;              /* INDICATE CLOSE OPERATION      */
EXIT     MVI   IOPFUNCT(IOPPTR),X'50'                              0332
*   IOPDSID=UPDDSID;                /*                       @Z67SP00*/
         L     @08,@PC00001                                        0333
         IC    @07,UPDDSID(,@08)                                   0333
         STC   @07,IOPDSID(,IOPPTR)                                0333
*   CALL HMASMIO(HMASMIOP);         /* CLOSE SYSGEN TAPE             */
         ST    IOPPTR,@AL00001                                     0334
         L     @15,@CV01377                                        0334
         LA    @01,@AL00001                                        0334
         BALR  @14,@15                                             0334
*   UPDRTNCD=MAX(UPDRTNCD,IOPRETRN);/* SAVE RC               @Z67SP00*/
         SLR   @08,@08                                             0335
         IC    @08,UPDRTNCD                                        0335
         SLR   @07,@07                                             0335
         IC    @07,IOPRETRN(,IOPPTR)                               0335
         CR    @08,@07                                             0335
         BNL   *+6
         LR    @08,@07                                             0335
         STC   @08,UPDRTNCD                                        0335
*   IF NXTBFRAD^=ZERO               /* HAS GETMAIN FOR JCL BUFFER    */
*     THEN                          /* BEEN DONE.. YES , FREE IT     */
         L     @08,NXTBFRAD                                        0336
         LTR   @08,@08                                             0336
         BZ    @RF00336                                            0336
*     DO;                                                          0337
*       RFY                                                        0338
*         SIZE RSTD;                /*                       @Z40SP00*/
*       SIZE=MAXJCL*LENGTH(BUFFER); /* CALCULATE SIZE TO FREE        */
         LH    SIZE,MAXJCL                                         0339
         MH    SIZE,@CH00539                                       0339
*       GEN(FREEMAIN E,LV=(SIZE),A=NXTBFRAD)                       0340
*       REFS(SIZE,NXTBFRAD);        /* FREE JCL BUFFER       @Z40SP00*/
         FREEMAIN E,LV=(SIZE),A=NXTBFRAD
*       RFY                                                        0341
*         SIZE UNRSTD;              /*                       @Z40SP00*/
*       NXTBFRAD=ZERO;              /* KRESET BUFFER ADDRESS         */
         SLR   @08,@08                                             0342
         ST    @08,NXTBFRAD                                        0342
*     END;                                                         0343
*                                                                  0343
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RELFILE ALLOCATION DONE THEN CALL IO TO FREE IT    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0344
*   IF ALCDONE=ON                   /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00336 TM    ALCDONE,B'00010000'                                 0344
         BNO   @RF00344                                            0344
*     DO;                           /*                       @Z67SP00*/
*       IOPFUNCT=IOPDALC;           /*                       @Z67SP00*/
         MVI   IOPFUNCT(IOPPTR),X'0E'                              0346
*       IOPDSN=UPDDSNAM;            /*                       @Z67SP00*/
         L     @08,@PC00001                                        0347
         MVC   IOPDSN(44,IOPPTR),UPDDSNAM(@08)                     0347
*       CALL HMASMIO(HMASMIOP);     /*                       @Z67SP00*/
         ST    IOPPTR,@AL00001                                     0348
         L     @15,@CV01377                                        0348
         LA    @01,@AL00001                                        0348
         BALR  @14,@15                                             0348
*       UPDRTNCD=MAX(UPDRTNCD,IOPRETRN);/*                   @Z67SP00*/
         SLR   @08,@08                                             0349
         IC    @08,UPDRTNCD                                        0349
         SLR   @07,@07                                             0349
         IC    @07,IOPRETRN(,IOPPTR)                               0349
         CR    @08,@07                                             0349
         BNL   *+6
         LR    @08,@07                                             0349
         STC   @08,UPDRTNCD                                        0349
*     END;                          /*                       @Z67SP00*/
*                                                                  0350
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN WITH CODE SET UPDURING PROCESSING              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0351
*   RETURN CODE(UPDRTNCD);          /* EXIT WITH RETURN CODE@YA07506 */
@RF00344 SLR   @15,@15                                             0351
         IC    @15,UPDRTNCD                                        0351
         L     @13,4(,@13)                                         0351
         L     @14,12(,@13)                                        0351
         LM    @00,@12,20(@13)                                     0351
         BR    @14                                                 0351
         EJECT
*                                                                  0352
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER HERE TO SAVE JOB AND STEP NAMES                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0352
*RJOBNMV:                                                          0352
*   PROCEDURE;                                                     0352
@EL00001 L     @13,4(,@13)                                         0352
@EF00001 DS    0H                                                  0352
@ER00001 LM    @14,@12,12(@13)                                     0352
         BR    @14                                                 0352
RJOBNMV  STM   @14,@12,12(@13)                                     0352
*   IF SCPPMLN=ZERO                 /* IS LENGTH ZERO?               */
*     THEN                          /* YES - MUST BUMP TO 1          */
         LH    @08,SCPPMLN                                         0353
         LTR   @08,@08                                             0353
         BNZ   @RF00353                                            0353
*     SCPPMLN=ONE;                  /* SET TO 1 SO DONT LOOP HERE    */
         MVC   SCPPMLN(2),@CH00054                                 0354
*   ELSE                                                           0355
*     IF SCPPMLN>MAXNAME            /* OR GREATER THAN MAX?          */
*       THEN                        /*                       @Z40SP00*/
         B     @RC00353                                            0355
@RF00353 LH    @08,SCPPMLN                                         0355
         C     @08,@CF00039                                        0355
         BNH   @RF00355                                            0355
*       NAMESAVE=SCPSTRNG(1:MAXNAME);/* SAVE PART            @Z40SP00*/
         L     @08,SCPCHAR                                         0356
         MVC   NAMESAVE(8),SCPSTRNG(@08)                           0356
*     ELSE                          /* ELSE, SAVE THE NAME           */
*       NAMESAVE=SCPSTRNG(1:SCPPMLN);/* SAVE JOB OR STEP NAME        */
         B     @RC00355                                            0357
@RF00355 MVI   NAMESAVE+1,C' '                                     0357
         MVC   NAMESAVE+2(6),NAMESAVE+1                            0357
         LH    @08,SCPPMLN                                         0357
         BCTR  @08,0                                               0357
         L     @01,SCPCHAR                                         0357
         EX    @08,@SM01604                                        0357
*   SCPRET=SCPGOOD;                 /* INDICATE CONTINUE SCN@YA07506 */
@RC00355 DS    0H                                                  0358
@RC00353 MVI   SCPRET,X'00'                                        0358
*   END RJOBNMV;                    /* RETURN                        */
*                                                                  0359
@EL00002 DS    0H                                                  0359
@EF00002 DS    0H                                                  0359
@ER00002 LM    @14,@12,12(@13)                                     0359
         BR    @14                                                 0359
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER HERE TO SET DUMMY JOB OR STEP NAME IF NONE CODED ON JCL */
*   /*                                                       @XA07937*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0360
*RSLBLNK:                           /*                       @XA07937*/
*   PROCEDURE;                      /*                       @XA07937*/
RSLBLNK  STM   @14,@12,12(@13)                                     0360
*   NAMESAVE=TXTNONAM;              /* SET DUMMY NAME        @XA07937*/
         MVC   NAMESAVE(8),@CC01418                                0361
*   SCPRET=SCPGOOD;                 /* SET GOOD RC           @YA07506*/
         MVI   SCPRET,X'00'                                        0362
*   END RSLBLNK;                    /* END PROC              @XA07937*/
*                                                                  0363
@EL00003 DS    0H                                                  0363
@EF00003 DS    0H                                                  0363
@ER00003 LM    @14,@12,12(@13)                                     0363
         BR    @14                                                 0363
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER HERE TO INDICATE JOB KEYWORD FOUND AND SAVE JOBNAME     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*RJOB:                                                             0364
*   PROCEDURE;                                                     0364
RJOB     STM   @14,@12,12(@13)                                     0364
*   JOBNAME=NAMESAVE;               /* PUT SAVED NAME IN JOBNAME     */
         MVC   JOBNAME(8),NAMESAVE                                 0365
*   SCPRET=SCPGOOD;                 /* INDICATE SUCCESS      @YA07506*/
         MVI   SCPRET,X'00'                                        0366
*   END RJOB;                       /* RETURN                        */
@EL00004 DS    0H                                                  0367
@EF00004 DS    0H                                                  0367
@ER00004 LM    @14,@12,12(@13)                                     0367
         BR    @14                                                 0367
         EJECT
*                                                                  0368
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN HAS ENCOUNTERED AN EXEC STATEMENT - READ AND SAVE JCL    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0368
*UPDEXC10:                                                         0368
*   PROCEDURE OPTIONS(SAVEAREA);                                   0368
UPDEXC10 STM   @14,@12,12(@13)                                     0368
         ST    @13,@SA00005+4                                      0368
         LA    @08,@SA00005                                        0368
         ST    @08,8(,@13)                                         0368
         LR    @13,@08                                             0368
*RASMS:                             /* ENTRY IF ASM TYPE STEP        */
*RPIEUASM:                          /*                               */
*RPIFOX00:                          /*                               */
*RPASMBLR:                          /*                               */
*RALTASM:                           /*                               */
*   ENTRY;                          /* ENTRY IF ASM TYPE STEP        */
         B     @EC00369                                            0369
RASMS    DS    0H                                                  0369
RPIEUASM DS    0H                                                  0369
RPIFOX00 DS    0H                                                  0369
RPASMBLR DS    0H                                                  0369
RALTASM  STM   @14,@12,12(@13)                                     0369
         ST    @13,@SA00005+4                                      0369
         LA    @08,@SA00005                                        0369
         ST    @08,8(,@13)                                         0369
         LR    @13,@08                                             0369
@EC00369 DS    0H                                                  0370
*   ASMSW=ON;                       /* SET ASM SW            @YA05008*/
         OI    ASMSW,B'01000000'                                   0370
*   GO TO UPDEXC05;                 /* BRANCH ARND OTHER ENTRY       */
         B     UPDEXC05                                            0371
*RLINKS:                            /* ENTRY IF LINK TYPE STEP       */
*RPIEWL:                            /*                               */
*RPHEWL:                            /*                               */
*RALTLKED:                          /*                               */
*   ENTRY;                          /* ENTRY IF LINK TYPE STEP       */
RLINKS   DS    0H                                                  0372
RPIEWL   DS    0H                                                  0372
RPHEWL   DS    0H                                                  0372
RALTLKED STM   @14,@12,12(@13)                                     0372
         ST    @13,@SA00005+4                                      0372
         LA    @08,@SA00005                                        0372
         ST    @08,8(,@13)                                         0372
         LR    @13,@08                                             0372
*   LKDSW=ON;                       /* SET LKD SW            @YA05008*/
         OI    LKDSW,B'00100000'                                   0373
*   GO TO UPDEXC05;                 /* BRANCH ARND OTHER ENTRY       */
         B     UPDEXC05                                            0374
*RPCOPY:                            /* ENTRY IF COPY TYPE STEP       */
*RALTCOPY:                          /*                               */
*   ENTRY;                          /* ENTRY IF COPY TYPE STEP       */
RPCOPY   DS    0H                                                  0375
RALTCOPY STM   @14,@12,12(@13)                                     0375
         ST    @13,@SA00005+4                                      0375
         LA    @08,@SA00005                                        0375
         ST    @08,8(,@13)                                         0375
         LR    @13,@08                                             0375
*   CPYSW=ON;                       /* SET CPY SW            @YA05008*/
         OI    CPYSW,B'00010000'                                   0376
*   GO TO UPDEXC05;                 /* BRANCH ARND OTHER ENTRY       */
         B     UPDEXC05                                            0377
*RPUPDTE:                           /* IEBUPDTE TYPE STEP    @YA05008*/
*RALTUPDT:                          /*                               */
*   ENTRY;                          /* IEBUPDTE TYPE STEP    @YA05008*/
RPUPDTE  DS    0H                                                  0378
RALTUPDT STM   @14,@12,12(@13)                                     0378
         ST    @13,@SA00005+4                                      0378
         LA    @08,@SA00005                                        0378
         ST    @08,8(,@13)                                         0378
         LR    @13,@08                                             0378
*   UPDSW=ON;                       /* SET UPD SW            @YA05008*/
         OI    UPDSW,B'10000000'                                   0379
*UPDEXC05:                                                         0380
*   SCPCHAR=SCPCHAR-SCPPMLN;        /* RESET PTR TO INSURE THAT THE
*                                      NEXT DSCAN WILL FIND AT LEAST
*                                      ONE VALID CHAR        @YA05008*/
UPDEXC05 L     @08,SCPCHAR                                         0380
         SH    @08,SCPPMLN                                         0380
         ST    @08,SCPCHAR                                         0380
*   STEPNAME=NAMESAVE;              /* PUT SAVED NAME IN STEPNAME    */
         MVC   STEPNAME(8),NAMESAVE                                0381
*   NUMJCL=2;                       /* SET STARTING LOOP VAL @Z67SP00*/
         MVC   NUMJCL(2),@CH00067                                  0382
*JCLSAV:                                                           0383
*   DO NUMJCL=NUMJCL TO MAXJCL;     /* READ IN JCL STATEMENT @Z67SP00*/
JCLSAV   LH    @08,NUMJCL                                          0383
         B     @DE00383                                            0383
@DL00383 DS    0H                                                  0384
*     CALL HMASMCRD(HMASMCRP);      /* READ NEXT RCD         @Z67SP00*/
         L     @15,@CV01379                                        0384
         LA    @01,@AL00384                                        0384
         BALR  @14,@15                                             0384
*     IF CRPRETRN=CRPGOOD           /* IF NEXT CARD READ     @Z67SP00*/
*         &CRPINDS=IOPPTS           /* FROM PTS AND ITS A    @Z67SP00*/
*         &CRPBUFFR(1:2)='++'       /* CONTROL CARD THEN     @Z67SP00*/
*       THEN                        /* TREAT AS IF END OF    @Z67SP00*/
         CLI   CRPRETRN,0                                          0385
         BNE   @RF00385                                            0385
         CLI   CRPINDS,6                                           0385
         BNE   @RF00385                                            0385
         CLC   CRPBUFFR(2),@CC01487                                0385
         BNE   @RF00385                                            0385
*       CRPRETRN=CRPEOF;            /* FILE CONDITION        @Z67SP00*/
         MVI   CRPRETRN,X'04'                                      0386
*     IF CRPRETRN^=CRPGOOD          /* GOOD RETURN?          @Z67SP00*/
*       THEN                        /* NO - ERROR FOUND              */
@RF00385 CLI   CRPRETRN,0                                          0387
         BE    @RF00387                                            0387
*       DO;                         /* TELL SCAN AND RETURN          */
*         IF CRPRETRN=CRPEOF        /* END OF FILE?          @Z67SP00*/
*           THEN                    /* YES - INDICATE FOUND          */
         CLI   CRPRETRN,4                                          0389
         BNE   @RF00389                                            0389
*           DO;                     /* INDICATE STOP                 */
*             SCPRET=SCPNDSCN;      /* INDICATE STOP SCAN    @YA07506*/
         MVI   SCPRET,X'04'                                        0391
*             EOFSW=ON;             /* INDICATE EOF FOUND            */
         OI    EOFSW,B'10000000'                                   0392
*           END;                                                   0393
*         ELSE                      /* OTHERWISE - BAD ERROR         */
*           SCPRET=CRPRETRN;        /* INDICATE ERROR        @YA07506*/
         B     @RC00389                                            0394
@RF00389 IC    @08,CRPRETRN                                        0394
         STC   @08,SCPRET                                          0394
*         RETURN;                   /* EXIT TO EFFECT ERROR          */
@EL00005 L     @13,4(,@13)                                         0395
@EF00005 DS    0H                                                  0395
@ER00005 LM    @14,@12,12(@13)                                     0395
         BR    @14                                                 0395
*       END;                                                       0396
*     BUFFER(NUMJCL)=CRPBUFFR;      /* MOVE RCD TO BUFFER    @Z67SP00*/
@RF00387 L     @08,BUFRPTR                                         0397
         LH    @07,NUMJCL                                          0397
         MH    @07,@CH00539                                        0397
         ST    @07,@TF00001                                        0397
         ALR   @07,@08                                             0397
         AL    @07,@CF01607                                        0397
         MVC   BUFFER(80,@07),CRPBUFFR                             0397
*                                                                  0398
*     /***************************************************************/
*     /*                                                             */
*     /* SEARCH INPUT FOR IEBUPDTE INPUT AND SKIP OVER IT    @YA05008*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0398
*     IF(BUFFER(NUMJCL,1:8)=SYSIN&UPDSW=ON)/* UPDTE SYSIN?   @Z67SP00*/
*         ×CONTSW=ON                /* OR CONTINUATION CARD  @YA05008*/
*       THEN                        /* YES                   @YA05008*/
         AL    @08,@TF00001                                        0398
         AL    @08,@CF01607                                        0398
         CLC   BUFFER(8,@08),@CC01416                              0398
         BNE   @GL00006                                            0398
         TM    UPDSW,B'10000000'                                   0398
         BO    @RT00398                                            0398
@GL00006 TM    CONTSW,B'10000000'                                  0398
         BNO   @RF00398                                            0398
@RT00398 DS    0H                                                  0399
*       DO;                         /* SCAN IT               @YA05008*/
*         CONTSW=OFF;               /* SET TO NOT CONTINUATION     0400
*                                                            @YA05008*/
         NI    CONTSW,B'01111111'                                  0400
*         K=3;                      /* STARTING SCAN COLUMN  @YA05008*/
         LA    @08,3                                               0401
         ST    @08,K                                               0401
*         IF DDSW=OFF               /* ALREADY HIT DD        @YA05008*/
*           THEN                    /* NO THEN LOOK FOR IT   @YA05008*/
         TM    DDSW,B'01000000'                                    0402
         BNZ   @RF00402                                            0402
*           DO;                     /*                       @YA05008*/
*             DO K=K TO UPDTLRCL;   /* SCAN THRU COLUMN 72   @YA05008*/
         B     @DE00404                                            0404
@DL00404 DS    0H                                                  0405
*               IF BUFFER(NUMJCL,K:K+2)=DD/* HIT DD?         @Z67SP00*/
*                 THEN              /* YES                   @YA05008*/
         LH    @07,NUMJCL                                          0405
         MH    @07,@CH00539                                        0405
         ALR   @07,@08                                             0405
         L     @01,BUFRPTR                                         0405
         ALR   @01,@07                                             0405
         AL    @01,@CF01609                                        0405
         CLC   BUFFER(3,@01),@CC01414                              0405
         BNE   @RF00405                                            0405
*                 DO;               /*                       @YA05008*/
*                   DDSW=ON;        /* SET FOUND DD SW       @YA05008*/
         OI    DDSW,B'01000000'                                    0407
*                   K=K+3;          /* INCR PTR TO NEXT BYTE @YA05008*/
         AL    @08,@CF00046                                        0408
         ST    @08,K                                               0408
*                   GO TO UPDT010;  /* BRANCH OUT OF DD SCAN @YA05008*/
         B     UPDT010                                             0409
*                 END;              /* END FOUND DD GROUP    @YA05008*/
*             END;                  /* END DD SEARCH GROUP   @YA05008*/
@RF00405 LA    @08,1                                               0411
         AL    @08,K                                               0411
         ST    @08,K                                               0411
@DE00404 C     @08,@CF00860                                        0411
         BNH   @DL00404                                            0411
*             NUMJCL=NUMJCL-1;      /* SET BUFFER INDEX TO USE     0412
*                                                            @Z67SP00*/
         LH    @08,NUMJCL                                          0412
         BCTR  @08,0                                               0412
         STH   @08,NUMJCL                                          0412
*             CONTSW=ON;            /* SAME AREA AGAIN       @YA05008*/
         OI    CONTSW,B'10000000'                                  0413
*             GO TO JCLSCN30;       /* GET NEXT CARD         @YA05008*/
         B     JCLSCN30                                            0414
*           END;                    /* END DD OFF LOOP       @YA05008*/
*UPDT010:                           /*                       @YA05008*/
*         IF DLMSW=OFF              /* DLM KEYWORD FOUND?    @YA05008*/
*           THEN                    /* NO                    @YA05008*/
@RF00402 DS    0H                                                  0416
UPDT010  TM    DLMSW,B'00100000'                                   0416
         BNZ   @RF00416                                            0416
*           DO;                     /* SCAN FOR IT           @YA05008*/
*             DO K=K TO UPDTLRCL WHILE BUFFER(NUMJCL,K)=BLANK;/* LOOP
*                                      THRU CARD LOOKING FOR FIRST 0418
*                                      NON BLANK AFTER DD CHARACTERS
*                                                            @Z40SP00*/
         L     @08,K                                               0418
         B     @DE00418                                            0418
@DL00418 LH    @07,NUMJCL                                          0418
         MH    @07,@CH00539                                        0418
         ALR   @07,@08                                             0418
         L     @01,BUFRPTR                                         0418
         ALR   @01,@07                                             0418
         AL    @01,@CF01609                                        0418
         CLI   BUFFER(@01),C' '                                    0418
         BNE   @DC00418                                            0418
*             END;                  /* END BLANK SEARCH      @Z40SP00*/
         AL    @08,@CF00054                                        0419
         ST    @08,K                                               0419
@DE00418 C     @08,@CF00860                                        0419
         BNH   @DL00418                                            0419
@DC00418 DS    0H                                                  0420
*             DO K=K TO UPDTLRCL WHILE BUFFER(NUMJCL,K)^=' ';/* AT 0420
*                                      THIS POINT K IS INDEX TO FIRST
*                                      NON-BLANK AFTER DD KEYWORD  0420
*                                                            @Z40SP00*/
         L     @08,K                                               0420
         B     @DE00420                                            0420
@DL00420 L     @07,BUFRPTR                                         0420
         LH    @06,NUMJCL                                          0420
         MH    @06,@CH00539                                        0420
         ALR   @06,@08                                             0420
         ST    @06,@TF00001                                        0420
         ALR   @06,@07                                             0420
         AL    @06,@CF01609                                        0420
         CLI   BUFFER(@06),C' '                                    0420
         BE    @DC00420                                            0420
*               DLMSW=ON;           /* SET TO FIUND DLM      @YA05008*/
         OI    DLMSW,B'00100000'                                   0421
*               IF BUFFER(NUMJCL,K:K+2)='DSN'/* DSNAME HIT   @YA05008*/
*                 THEN              /* YES - SKIP CARD       @YA05008*/
         LR    @08,@07                                             0422
         AL    @08,@TF00001                                        0422
         AL    @08,@CF01609                                        0422
         CLC   BUFFER(3,@08),@CC01568                              0422
         BE    @RT00422                                            0422
*                 GO TO JCLSCN30;   /*                       @YA05008*/
*               IF BUFFER(NUMJCL,K)='*'/* DD * TYPE INPUT?   @YA05008*/
*                 THEN              /* YES                   @YA05008*/
         AL    @07,@TF00001                                        0424
         AL    @07,@CF01609                                        0424
         CLI   BUFFER(@07),C'*'                                    0424
         BNE   @RF00424                                            0424
*                 ASTFSW=ON;        /* SET SW                @YA05008*/
         OI    ASTFSW,B'00010000'                                  0425
*               IF BUFFER(NUMJCL,K:K+3)='DATA'/* DD DATA?    @Z67SP00*/
*                 THEN              /* YES                   @YA05008*/
@RF00424 LH    @08,NUMJCL                                          0426
         MH    @08,@CH00539                                        0426
         AL    @08,K                                               0426
         L     @01,BUFRPTR                                         0426
         ALR   @01,@08                                             0426
         AL    @01,@CF01609                                        0426
         CLC   BUFFER(4,@01),@CC01569                              0426
         BNE   @RF00426                                            0426
*                 DATAFSW=ON;       /* SET SW                @YA05008*/
         OI    DATAFSW,B'00001000'                                 0427
*               IF BUFFER(NUMJCL,K:K+3)='DLM='/* DLM KEYWORD?      0428
*                                                            @Z67SP00*/
*                 THEN              /* YES                   @YA05008*/
@RF00426 L     @08,BUFRPTR                                         0428
         LH    @07,NUMJCL                                          0428
         MH    @07,@CH00539                                        0428
         AL    @07,K                                               0428
         ST    @07,@TF00001                                        0428
         ALR   @07,@08                                             0428
         AL    @07,@CF01609                                        0428
         CLC   BUFFER(4,@07),@CC01570                              0428
         BNE   @RF00428                                            0428
*                 DO;               /*                       @YA05008*/
*                   DLMFSW=ON;      /* SET SW                @YA05008*/
*                   ASTFSW=OFF;     /* RESET AST SW          @YA05008*/
*                   DATAFSW=OFF;    /* RESET DATA SW         @YA05008*/
         OI    DLMFSW,B'00000100'                                  0432
         NI    ASTFSW,B'11100111'                                  0432
*                   DLM=BUFFER(NUMJCL,K+4:K+5);/* SAVE DLM   @Z67SP00*/
         AL    @08,@TF00001                                        0433
         AL    @08,@CF01611                                        0433
         MVC   DLM(2),BUFFER(@08)                                  0433
*                   GO TO UPDT030;  /* BR OUT OF SEARCH      @YA05008*/
         B     UPDT030                                             0434
*                 END;              /* END DLM FOUND         @YA05008*/
*             END;                  /* END BUFFER LOOP       @YA05008*/
@RF00428 LA    @08,1                                               0436
         AL    @08,K                                               0436
         ST    @08,K                                               0436
@DE00420 C     @08,@CF00860                                        0436
         BNH   @DL00420                                            0436
@DC00420 DS    0H                                                  0437
*             IF BUFFER(NUMJCL,K-1)=','/* CONTINUATION?      @Z67SP00*/
*               THEN                /* YES                   @YA05008*/
         LH    @08,NUMJCL                                          0437
         MH    @08,@CH00539                                        0437
         AL    @08,K                                               0437
         L     @01,BUFRPTR                                         0437
         ALR   @01,@08                                             0437
         AL    @01,@CF01612                                        0437
         CLI   BUFFER(@01),C','                                    0437
         BNE   @RF00437                                            0437
*               DLMSW=OFF;          /* KRESET SW TO GO THRU NXT    0438
*                                                            @YA05008*/
         NI    DLMSW,B'11011111'                                   0438
*             GO TO UPDT030;        /* GET NEXT CARD         @YA05008*/
         B     UPDT030                                             0439
*           END;                    /* END DLM SEARCH        @YA05008*/
*         IF(ASTFSW=ON&(BUFFER(NUMJCL,1:2)^=SLASHAST&/*      @Z67SP00*/
*             BUFFER(NUMJCL,1:2)^=SLASHES))/*                @Z67SP00*/
*             ×(DATAFSW=ON&BUFFER(NUMJCL,1:2)^=SLASHAST)/*   @Z67SP00*/
*             ×(DLMFSW=ON&BUFFER(NUMJCL,1:2)^=DLM)/* EOF     @Z67SP00*/
*           THEN                    /* NO                    @YA05008*/
@RF00416 TM    ASTFSW,B'00010000'                                  0441
         BNO   @GL00009                                            0441
         L     @08,BUFRPTR                                         0441
         LH    @07,NUMJCL                                          0441
         MH    @07,@CH00539                                        0441
         ST    @07,@TF00001                                        0441
         ALR   @07,@08                                             0441
         AL    @07,@CF01607                                        0441
         CLC   BUFFER(2,@07),@CC01431                              0441
         BE    @GL00009                                            0441
         AL    @08,@TF00001                                        0441
         AL    @08,@CF01607                                        0441
         CLC   BUFFER(2,@08),@CC01429                              0441
         BNE   @RT00441                                            0441
@GL00009 TM    DATAFSW,B'00001000'                                 0441
         BNO   @GL00008                                            0441
         LH    @08,NUMJCL                                          0441
         MH    @08,@CH00539                                        0441
         L     @01,BUFRPTR                                         0441
         ALR   @01,@08                                             0441
         AL    @01,@CF01607                                        0441
         CLC   BUFFER(2,@01),@CC01431                              0441
         BNE   @RT00441                                            0441
@GL00008 TM    DLMFSW,B'00000100'                                  0441
         BNO   @RF00441                                            0441
         LH    @08,NUMJCL                                          0441
         MH    @08,@CH00539                                        0441
         L     @01,BUFRPTR                                         0441
         ALR   @01,@08                                             0441
         AL    @01,@CF01607                                        0441
         CLC   BUFFER(2,@01),DLM                                   0441
         BE    @RF00441                                            0441
@RT00441 DS    0H                                                  0442
*           DO;                     /*                       @YA05008*/
*UPDT030:                           /*                       @YA05008*/
*             NUMJCL=NUMJCL-1;      /* SET TO REUSE SAME BUFFER    0443
*                                                            @Z67SP00*/
UPDT030  LH    @08,NUMJCL                                          0443
         BCTR  @08,0                                               0443
         STH   @08,NUMJCL                                          0443
*             CONTSW=ON;            /* SET TO COME THRU AGAIN      0444
*                                                            @YA05008*/
         OI    CONTSW,B'10000000'                                  0444
*             GO TO JCLSCN30;       /* GET NEXT CARD         @YA05008*/
         B     JCLSCN30                                            0445
*           END;                    /*                       @YA05008*/
*         IF ASTFSW=ON&BUFFER(NUMJCL,1:2)=SLASHES/* NEXT JCL @Z67SP00*/
*           THEN                    /* FOR DD * TYPE INPUT?  @YA05008*/
@RF00441 TM    ASTFSW,B'00010000'                                  0447
         BNO   @RF00447                                            0447
         L     @08,BUFRPTR                                         0447
         LH    @07,NUMJCL                                          0447
         MH    @07,@CH00539                                        0447
         ST    @07,@TF00001                                        0447
         ALR   @07,@08                                             0447
         AL    @07,@CF01607                                        0447
         CLC   BUFFER(2,@07),@CC01429                              0447
         BNE   @RF00447                                            0447
*           DO;                     /* YES - WANT TO SCAN IT @YA05008*/
*             BUFFER(1)=BUFFER(NUMJCL);/* MOVE TO TOP OF BUF @Z67SP00*/
         LR    @01,@08                                             0449
         AL    @01,@TF00001                                        0449
         AL    @01,@CF01607                                        0449
         MVC   @TS00001(80),BUFFER(@01)                            0449
         MVC   BUFFER(80,@08),@TS00001                             0449
*             SKIPREAD=ON;          /* SET TO SKIP NEXT READ @YA05008*/
         OI    SKIPREAD,B'01000000'                                0450
*           END;                    /*                       @YA05008*/
*         SCPRET=SCPNDSCN;          /* HIT END OF SYSIN      @YA07506*/
@RF00447 MVI   SCPRET,X'04'                                        0452
*         RETURN;                   /* RETURN TO SCAN        @YA05008*/
         B     @EL00005                                            0453
*       END;                        /*                       @YA05008*/
*     IF BUFFER(NUMJCL,1:2)^=SLASHES/* END OF JCL?           @Z67SP00*/
*       THEN                                                       0455
@RF00398 LH    @08,NUMJCL                                          0455
         MH    @08,@CH00539                                        0455
         L     @01,BUFRPTR                                         0455
         ALR   @01,@08                                             0455
         AL    @01,@CF01607                                        0455
         CLC   BUFFER(2,@01),@CC01429                              0455
         BNE   @RT00455                                            0455
*       GO TO UPDEXC20;             /* YES - EXIT FROM LOOP          */
*JCLSCN05:                          /*                       @YA05008*/
*                                                                  0457
*     /***************************************************************/
*     /*                                                             */
*     /* SCAN JCL STATEMENT FOR POSSIBLE JOB OR EXEC                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0457
*     J=3;                          /* SET BLANK START POSITION      */
JCLSCN05 MVC   J(2),@CH00046                                       0457
*     IF BUFFER(NUMJCL,3)^=BLANK    /* IS THERE A LABEL      @Z67SP00*/
*       THEN                        /* YES - SKIP PAST IT            */
         LH    @08,NUMJCL                                          0458
         MH    @08,@CH00539                                        0458
         L     @01,BUFRPTR                                         0458
         ALR   @01,@08                                             0458
         AL    @01,@CF01614                                        0458
         CLI   BUFFER(@01),C' '                                    0458
         BE    @RF00458                                            0458
*       DO;                                                        0459
*         DO J=4 TO LENGTH(CRPBFDTA);/* SCAN FOR BLANK CHAR  @Z67SP00*/
         LA    @08,4                                               0460
         STH   @08,J                                               0460
@DL00460 DS    0H                                                  0461
*           IF BUFFER(NUMJCL,J)=BLANK/* IS THIS CHAR BLANK   @Z67SP00*/
*             THEN                  /* YES - JUMP OUT                */
         LH    @07,NUMJCL                                          0461
         MH    @07,@CH00539                                        0461
         ALR   @07,@08                                             0461
         L     @01,BUFRPTR                                         0461
         ALR   @01,@07                                             0461
         AL    @01,@CF01609                                        0461
         CLI   BUFFER(@01),C' '                                    0461
         BE    @RT00461                                            0461
*             GO TO JCLSCN10;       /* EXIT WITH BLANK FOUND         */
*         END;                                                     0463
         AL    @08,@CF00054                                        0463
         STH   @08,J                                               0463
         C     @08,@CF01064                                        0463
         BNH   @DL00460                                            0463
*         GO TO JCLSCN30;           /* SKIP STATEMENT IF FALL THRU   */
         B     JCLSCN30                                            0464
*       END;                                                       0465
*JCLSCN10:                                                         0466
*     DO J=J+1 TO LENGTH(CRPBFDTA); /* SCAN FOR NON-BLANK    @Z67SP00*/
@RF00458 DS    0H                                                  0466
JCLSCN10 LA    @08,1                                               0466
         AH    @08,J                                               0466
         B     @DE00466                                            0466
@DL00466 DS    0H                                                  0467
*       IF BUFFER(NUMJCL,J)^=BLANK  /* IS THIS NON=BLANK     @Z67SP00*/
*         THEN                      /* YES - EXIT FROM LOOP          */
         LH    @07,NUMJCL                                          0467
         MH    @07,@CH00539                                        0467
         ALR   @07,@08                                             0467
         L     @01,BUFRPTR                                         0467
         ALR   @01,@07                                             0467
         AL    @01,@CF01609                                        0467
         CLI   BUFFER(@01),C' '                                    0467
         BNE   @RT00467                                            0467
*         GO TO JCLSCN20;           /* QUIT CHECKING                 */
*     END;                                                         0469
         AL    @08,@CF00054                                        0469
@DE00466 STH   @08,J                                               0469
         C     @08,@CF01064                                        0469
         BNH   @DL00466                                            0469
*     GO TO JCLSCN30;               /* SKIP STATEMENT                */
         B     JCLSCN30                                            0470
*JCLSCN20:                                                         0471
*     IF BUFFER(NUMJCL,J:J+LENGTH(JOB)-1)=JOB/* IS THIS JOB  @Z67SP00*/
*         ×BUFFER(NUMJCL,J:J+LENGTH(EXEC)-1)=EXEC/* OR EXEC  @Z67SP00*/
*       THEN                        /* YES - NEW JOB OR STEP         */
JCLSCN20 L     @08,BUFRPTR                                         0471
         LH    @07,NUMJCL                                          0471
         MH    @07,@CH00539                                        0471
         AH    @07,J                                               0471
         ST    @07,@TF00001                                        0471
         ALR   @07,@08                                             0471
         AL    @07,@CF01609                                        0471
         CLC   BUFFER(4,@07),@CC01410                              0471
         BE    @RT00471                                            0471
         AL    @08,@TF00001                                        0471
         AL    @08,@CF01609                                        0471
         CLC   BUFFER(5,@08),@CC01412                              0471
         BNE   @RF00471                                            0471
@RT00471 DS    0H                                                  0472
*       DO;                                                        0472
*         BUFFER(1)=BUFFER(NUMJCL); /* MOVE RECORD TO HEAD   @Z67SP00*/
         L     @08,BUFRPTR                                         0473
         LH    @07,NUMJCL                                          0473
         MH    @07,@CH00539                                        0473
         ALR   @07,@08                                             0473
         AL    @07,@CF01607                                        0473
         MVC   @TS00001(80),BUFFER(@07)                            0473
         MVC   BUFFER(80,@08),@TS00001                             0473
*         SKIPREAD=ON;              /* INDICATE SKIP NEXT READ       */
         OI    SKIPREAD,B'01000000'                                0474
*         SCPRET=SCPNDSCN;          /* INDICATE STOP SCAN    @YA07506*/
         MVI   SCPRET,X'04'                                        0475
*         RETURN;                   /* RETURN TO CONTINUE SCAN       */
         B     @EL00005                                            0476
*       END;                                                       0477
*JCLSCN30:                                                         0478
*   END;                                                           0478
@RF00471 DS    0H                                                  0478
JCLSCN30 LA    @08,1                                               0478
         AH    @08,NUMJCL                                          0478
         STH   @08,NUMJCL                                          0478
@DE00383 CH    @08,MAXJCL                                          0478
         BNH   @DL00383                                            0478
*                                                                  0479
*   /*****************************************************************/
*   /*                                                               */
*   /* GET STORAGE FOR NEW JCL BUFFER AND FREE OLD IF GOTTEN         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0479
*JCLBUFGM:                          /* GET NEW JCL BUFFER    @YP12114*/
*   RFY                                                            0479
*     SIZE RSTD;                    /*                       @Z40SP00*/
JCLBUFGM DS    0H                                                  0480
*   SIZE=(MAXJCL+INCR)*LENGTH(BUFFER);/* CALCULATE SIZE OF BUFFER    */
         LA    SIZE,25                                             0480
         AH    SIZE,MAXJCL                                         0480
         MH    SIZE,@CH00539                                       0480
*   GEN(GETMAIN EC,LV=(SIZE),A=NXTBFRAD)                           0481
*   REFS(SIZE,NXTBFRAD);            /* GET STORAGE FOR BFR   @Z40SP00*/
         GETMAIN EC,LV=(SIZE),A=NXTBFRAD
*   RFY                                                            0482
*     SIZE UNRSTD;                  /*                       @Z40SP00*/
*   IF RTNCODE^=ZERO                /* WAS STORAGE AVAIL?    @Z40SP00*/
*     THEN                          /* NO - ISSUE MESSAGE AND EXIT   */
         SLR   @08,@08                                             0483
         CR    RTNCODE,@08                                         0483
         BE    @RF00483                                            0483
*     DO;                                                          0484
*       MGPTYPE=MGPSEV;             /* SET SEVERITY          @MS00001*/
         MVI   MGPTYPE,X'04'                                       0485
*       MGPMGNO1=HMA202I;           /* UNABLE TO OBTAIN STORAGE FOR
*                                      WORK AREAS            @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00046                                0486
*       MGPMGNO2=ZERO;              /* ZERO SECONDARY                */
         STH   @08,MGPMGNO2                                        0487
*       CALL HMASMMSG(HMASMMGP);    /* WRITE ERROR MESSAGE           */
         L     @15,@CV01383                                        0488
         LA    @01,@AL00488                                        0488
         BALR  @14,@15                                             0488
*       SCPRET=STOPFUNC;            /* INDICATE SCAN ERROR   @YA07506*/
         MVI   SCPRET,X'0C'                                        0489
*       RETURN;                     /* RETURN TO SCAN                */
         B     @EL00005                                            0490
*     END;                                                         0491
*   DO J=1 TO MAXJCL;               /* LOOP TO MOVE BUFFER RECORDS   */
@RF00483 LA    @08,1                                               0492
         B     @DE00492                                            0492
@DL00492 DS    0H                                                  0493
*     NXTBFRAD->BUFFER(J)=BUFFER(J);/* MOVE RECORD TO NEW BUFFER     */
         LR    @07,@08                                             0493
         MH    @07,@CH00539                                        0493
         L     @01,NXTBFRAD                                        0493
         ALR   @01,@07                                             0493
         AL    @01,@CF01607                                        0493
         L     @06,BUFRPTR                                         0493
         ALR   @06,@07                                             0493
         AL    @06,@CF01607                                        0493
         MVC   BUFFER(80,@01),BUFFER(@06)                          0493
*   END;                                                           0494
         AL    @08,@CF00054                                        0494
@DE00492 STH   @08,J                                               0494
         CH    @08,MAXJCL                                          0494
         BNH   @DL00492                                            0494
*   IF MAXJCL>INCR                  /* HAS PRIOR GETMAIN BEEN DONE?  */
*     THEN                          /* YES - MUST FREE OLD           */
         LH    @08,MAXJCL                                          0495
         C     @08,@CF00488                                        0495
         BNH   @RF00495                                            0495
*     DO;                                                          0496
*       RFY                                                        0497
*         SIZE RSTD;                /*                       @Z40SP00*/
*       SIZE=MAXJCL*LENGTH(BUFFER); /* CALCULATE SIZE OF OLD BUFFER  */
         MH    @08,@CH00539                                        0498
         LR    SIZE,@08                                            0498
*       GEN(FREEMAIN E,LV=(SIZE),A=BUFRPTR)                        0499
*       REFS(SIZE,BUFRPTR);         /* FREE OLD JCL BUFFER   @Z40SP00*/
         FREEMAIN E,LV=(SIZE),A=BUFRPTR
*       RFY                                                        0500
*         SIZE UNRSTD;              /*                       @Z40SP00*/
*     END;                                                         0501
*   BUFRPTR=NXTBFRAD;               /* SET BASE TO NEW BUFFER        */
@RF00495 L     @08,NXTBFRAD                                        0502
         ST    @08,BUFRPTR                                         0502
*   MAXJCL=MAXJCL+INCR;             /* SET NEW MAXIMUM JCL NUMBER    */
         LH    @08,MAXJCL                                          0503
         LA    @08,25(,@08)                                        0503
         STH   @08,MAXJCL                                          0503
*   GO TO JCLSAV;                   /* GO TO CONTINUE READING JCL    */
*                                                                  0504
         B     JCLSAV                                              0504
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO PASS JCL TO CALLED ROUTINE                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0505
*UPDEXC20:                                                         0505
*   IF BUFFER(NUMJCL,1:2)=SLASHAST  /* IS THIS A NULL STEP?  @Z67SP00*/
*     THEN                          /* YES - STOP SCAN               */
UPDEXC20 LH    @08,NUMJCL                                          0505
         MH    @08,@CH00539                                        0505
         L     @01,BUFRPTR                                         0505
         ALR   @01,@08                                             0505
         AL    @01,@CF01607                                        0505
         CLC   BUFFER(2,@01),@CC01431                              0505
         BNE   @RF00505                                            0505
*     DO;                                                          0506
*       SCPRET=SCPNDSCN;            /* INDICATE SCAN STOP    @YA07506*/
         MVI   SCPRET,X'04'                                        0507
*       RETURN;                     /* RETURN TO CONTINUE            */
         B     @EL00005                                            0508
*     END;                                                         0509
*   BUFFER(NUMJCL,1)=EOLST;         /* INDICATE END OF JCL   @Z67SP00*/
@RF00505 LH    @08,NUMJCL                                          0510
         MH    @08,@CH00539                                        0510
         LA    @07,255                                             0510
         L     @06,BUFRPTR                                         0510
         AL    @06,@CF01607                                        0510
         STC   @07,BUFFER(@08,@06)                                 0510
*   SCPPMLN=ZERO;                   /* RESET LENGTH SO THAT SCAN WILL
*                                      START SCAN AT START OF CARD 0511
*                                      (SINCE CRD HAS READ ANOTHER 0511
*                                      CARD) RATHER THAN OFFSET INTO
*                                      CARD EQUAL TO LENGTH OF PROC
*                                      OR PGM=XX FOUND       @Z67SP00*/
         SLR   @08,@08                                             0511
         STH   @08,SCPPMLN                                         0511
*   SCPRET=SCPGOOD;                 /* INDICATE SUCCESS      @YA07506*/
         MVI   SCPRET,X'00'                                        0512
*   END UPDEXC10;                   /* RETURN TO SCAN                */
         B     @EL00005                                            0513
         EJECT
*                                                                  0514
*   /*****************************************************************/
*   /*                                                               */
*   /* FOLLOWING ROUTINES INVOKE THE PROPER SYSGEN SCANNERS WHEN A   */
*   /* STEP CONSISTING OF AN EXECUTE OF THE LINKAGE EDITOR, THE      */
*   /* ASSEMBLER, OR IEBCOPY IS FOUND ON THE SYSGEN TAPE             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0514
*RINVOK:                                                           0514
*   PROCEDURE OPTIONS(SAVEAREA);                                   0514
*                                                                  0514
RINVOK   STM   @14,@12,12(@13)                                     0514
         ST    @13,@SA00006+4                                      0514
         LA    @08,@SA00006                                        0514
         ST    @08,8(,@13)                                         0514
         LR    @13,@08                                             0514
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN HAS ENCOUNTERED AN ASSEMBLY STEP - INVOKE HMASMASM       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0515
*   MGPCLEAR=''B;                   /* CLEAR MSG PARTS       @Z40SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0515
*   IF ASMSW=ON                     /* WAS STEP ASM?         @YA05008*/
*     THEN                          /* YES                   @YA05008*/
         TM    ASMSW,B'01000000'                                   0516
         BNO   @RF00516                                            0516
*     DO;                           /* PROCESS JCL           @YA05008*/
*       MGPMGNO2=PART025;           /* ASSEMBLER INPUT       @Z40SP00*/
         MVC   MGPMGNO2(2),@CH00488                                0518
*       CALL HMASMASM(BUPPARM,HMASMCRP,BUFFER,NUMJCL);/*     @Z67SP00*/
         MVC   @AL00001(16),@AL00519                               0519
         L     @08,BUFRPTR                                         0519
         ST    @08,@AL00001+8                                      0519
         L     @15,@CV01381                                        0519
         LA    @01,@AL00001                                        0519
         BALR  @14,@15                                             0519
*     END;                          /* END ASM STEP PROCESSING     0520
*                                                            @YA05008*/
*                                                                  0520
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN HAS ENCOUNTERED A LINK EDIT STEP - INVOKE HMASMLKD       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0521
*   ELSE                            /*                       @ZA24269*/
*     IF LKDSW=ON                   /* LINK STEP?            @YA05008*/
*       THEN                        /* YES                   @YA05008*/
         B     @RC00516                                            0521
@RF00516 TM    LKDSW,B'00100000'                                   0521
         BNO   @RF00521                                            0521
*       DO;                         /* DO LINK PROCESSING    @YA05008*/
*         MGPMGNO2=PART023;         /* LINKAGE EDITOR INPUT  @Z40SP00*/
         MVC   MGPMGNO2(2),@CH00484                                0523
*         CALL HMASMLKD(BUPPARM,HMASMCRP,BUFFER,NUMJCL);/*   @Z67SP00*/
         MVC   @AL00001(16),@AL00524                               0524
         L     @08,BUFRPTR                                         0524
         ST    @08,@AL00001+8                                      0524
         L     @15,@CV01382                                        0524
         LA    @01,@AL00001                                        0524
         BALR  @14,@15                                             0524
*       END;                        /* END LINK PROCESSING   @YA05008*/
*                                                                  0525
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN HAS ENCOUNTERED AN IEBCOPY STEP - INVOKE HMASMCPY        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0526
*     ELSE                          /*                       @ZA24269*/
*       IF CPYSW=ON                 /* COPY STEP?            @YA05008*/
*         THEN                      /* YES                   @YA05008*/
         B     @RC00521                                            0526
@RF00521 TM    CPYSW,B'00010000'                                   0526
         BNO   @RF00526                                            0526
*         DO;                       /* DO COPY PROCESSING    @YA05008*/
*           MGPMGNO2=PART024;       /* IEBCOPY INPUT         @Z40SP00*/
         MVC   MGPMGNO2(2),@CH00193                                0528
*           CALL HMASMCPY(BUPPARM,HMASMCRP,BUFFER,NUMJCL);/* @Z67SP00*/
         MVC   @AL00001(16),@AL00529                               0529
         L     @08,BUFRPTR                                         0529
         ST    @08,@AL00001+8                                      0529
         L     @15,@CV01384                                        0529
         LA    @01,@AL00001                                        0529
         BALR  @14,@15                                             0529
*         END;                      /* END COPY PROCESSING   @YA05008*/
*                                                                  0531
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK RETURN CODE FROM SCANNER ROUTINES - RETURN TO SCAN      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0531
*   IF RTNCODE^=ZERO                /* GOOD RETURN CODE?     @YA07506*/
*       &RTNCODE^=IOPEXC            /* AND NOT IOP EXCEEDED? @YA07506*/
*     THEN                          /* NO - EXIT BADLY               */
@RF00526 DS    0H                                                  0531
@RC00521 DS    0H                                                  0531
@RC00516 LTR   RTNCODE,RTNCODE                                     0531
         BZ    @RF00531                                            0531
         LA    @08,8                                               0531
         CR    RTNCODE,@08                                         0531
         BE    @RF00531                                            0531
*     DO;                           /* ISSUE PROPER MESSAGE          */
*       IF RTNCODE=SYNTERR          /* IS IT SYNTAX ERROR?           */
*         THEN                                                     0533
         C     RTNCODE,@CF00034                                    0533
         BNE   @RF00533                                            0533
*         DO;                                                      0534
*           MGPTYPE=MGPERR;         /* SET SEVERITY          @MS00001*/
         MVI   MGPTYPE,X'03'                                       0535
*           MGPMGNO1=HMA203I;       /* SYNTAX ERROR IN       @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00037                                0536
*           UPDRTNCD=MAX(UPDRTNCD,STOPPTF);/*                @ZA24269*/
         SLR   @07,@07                                             0537
         IC    @07,UPDRTNCD                                        0537
         CR    @07,@08                                             0537
         BNL   *+6
         LR    @07,@08                                             0537
         STC   @07,UPDRTNCD                                        0537
*         END;                      /*                       @YA07506*/
*       ELSE                        /* CHECK THE REST                */
*         IF RTNCODE=IOPIOERR       /* I/O ERROR?            @YA07506*/
*           THEN                    /* YES - INDICATE ERROR          */
         B     @RC00533                                            0539
@RF00533 LA    @08,16                                              0539
         CR    RTNCODE,@08                                         0539
         BNE   @RF00539                                            0539
*           DO;                     /*                       @YA07506*/
*             MGPTYPE=MGPTERM;      /* SET SEVERITY          @MS00001*/
         MVI   MGPTYPE,X'05'                                       0541
*             MGPMGNO1=HMA266I;     /* ERROR OCCURRED IN     @Z40SP00*/
         MVC   MGPMGNO1(2),@CH01056                                0542
*             UPDRTNCD=MAX(UPDRTNCD,STOPSMP);/*              @ZA24269*/
         SLR   @07,@07                                             0543
         IC    @07,UPDRTNCD                                        0543
         CR    @07,@08                                             0543
         BNL   *+6
         LR    @07,@08                                             0543
         STC   @07,UPDRTNCD                                        0543
*           END;                    /*                       @YA07506*/
*         ELSE                      /* OTHERWISE, TABLE EXCEED       */
*           IF RTNCODE=TBLEXCER     /* TABLE SPACE EXCEEDED?         */
*             THEN                  /* YES - INDICATE NO SPACE       */
         B     @RC00539                                            0545
@RF00539 LA    @08,12                                              0545
         CR    RTNCODE,@08                                         0545
         BNE   @RF00545                                            0545
*             DO;                   /*                       @YA07506*/
*               MGPTYPE=MGPSEV;     /* SET SEVERITY          @MS00001*/
         MVI   MGPTYPE,X'04'                                       0547
*               MGPMGNO1=HMA202I;   /* UNABLE TO OBTAIN STORAGE FOR
*                                      WORK AREAS            @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00046                                0548
*               UPDRTNCD=MAX(UPDRTNCD,STOPFUNC);/*           @ZA24269*/
         SLR   @07,@07                                             0549
         IC    @07,UPDRTNCD                                        0549
         CR    @07,@08                                             0549
         BNL   *+6
         LR    @07,@08                                             0549
         STC   @07,UPDRTNCD                                        0549
*             END;                  /*                       @YA07506*/
*           ELSE                                                   0551
*             IF RTNCODE=PREMEOF    /* IS IT END OF FILE?            */
*               THEN                /* YES - INDICATE EOF FOUND      */
         B     @RC00545                                            0551
@RF00545 C     RTNCODE,@CF00273                                    0551
         BNE   @RF00551                                            0551
*               DO;                                                0552
*                 EOFSW=ON;         /* INDICATE EOF FOUND ON JCL     */
         OI    EOFSW,B'10000000'                                   0553
*                 SCPRET=SCPNDSCN;  /* SAY STOP THE SCAN     @YA07506*/
         MVI   SCPRET,X'04'                                        0554
*                 RETURN;           /* RETURN WITH NO MESSAGE        */
@EL00006 L     @13,4(,@13)                                         0555
@EF00006 DS    0H                                                  0555
@ER00006 LM    @14,@12,12(@13)                                     0555
         BR    @14                                                 0555
*               END;                                               0556
*             ELSE                                                 0557
*               DO;                 /* JCL STATEMENTS ENCOUNTERED    */
@RF00551 DS    0H                                                  0558
*                 SKIPREAD=ON;      /* INDICATE SKIP READ OP         */
         OI    SKIPREAD,B'01000000'                                0558
*                 BUFFER(1)=CRPBUFFR;/* MOVE IOP RECORD TO BUFR      */
         L     @08,BUFRPTR                                         0559
         MVC   BUFFER(80,@08),CRPBUFFR                             0559
*                 SCPRET=SCPNDSCN;  /* INDICATE END SCAN     @YA07506*/
         MVI   SCPRET,X'04'                                        0560
*                 RETURN;           /* RETURN TO SCAN                */
         B     @EL00006                                            0561
*               END;                                               0562
*       CALL HMASMMSG(HMASMMGP);    /* ISSUE MESSAGE                 */
@RC00545 DS    0H                                                  0563
@RC00539 DS    0H                                                  0563
@RC00533 L     @15,@CV01383                                        0563
         LA    @01,@AL00563                                        0563
         BALR  @14,@15                                             0563
*       SCPRET=SCPSTOP;             /* INDICATE ERROR 2 SCN  @YA07506*/
         MVI   SCPRET,X'08'                                        0564
*     END;                                                         0565
*   ELSE                            /* OTHERWISE INDICATE SUCCESS    */
*     DO;                           /*                       @YA07506*/
         B     @RC00531                                            0566
@RF00531 DS    0H                                                  0567
*       IF RTNCODE=IOPEXC           /* IOPEXCEEDED?          @YA07506*/
*         THEN                                                     0567
         C     RTNCODE,@CF00039                                    0567
         BNE   @RF00567                                            0567
*         RTNCODE=STOPFUNC;         /* YES-TERMINATE JCLIN   @YA07506*/
         LA    RTNCODE,12                                          0568
*       SCPRET=RTNCODE;             /* SET RC                @YA07506*/
@RF00567 STC   RTNCODE,SCPRET                                      0569
*       IF UPDRTNCD<SCPRET          /* CHANGE RC?            @YA07506*/
*         THEN                                                     0570
         CLC   UPDRTNCD(1),SCPRET                                  0570
         BNL   @RF00570                                            0570
*         UPDRTNCD=SCPRET;          /* INSURE RC             @YA07506*/
         SLR   @08,@08                                             0571
         IC    @08,SCPRET                                          0571
         STC   @08,UPDRTNCD                                        0571
*     END;                          /*                       @YA07506*/
*   END RINVOK;                     /* RETURN TO SCAN                */
         B     @EL00006                                            0573
*   END HMASMUPD                                                   0574
*                                                                  0574
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*                                                                  0574
*       ;                                                          0574
@DATA    DS    0H
@CH00067 DC    H'2'
@CH00467 DC    H'13'
@CH00484 DC    H'23'
@CH00193 DC    H'24'
@CH01388 DC    H'47'
@CH00708 DC    H'63'
@CH01050 DC    H'64'
@CH01056 DC    H'67'
@CH00353 DC    H'74'
@CH00539 DC    H'80'
@CH00557 DC    H'89'
@SM01599 MVC   DSCKEY(0,@08),UPDPGMNM-1(@06)
@SM01604 MVC   NAMESAVE(0),SCPSTRNG(@01)
         DS    0F
@AL00317 DC    A(HMASMSCP)             LIST WITH   1 ARGUMENT(S)
@AL00519 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL00524 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL00529 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL00330 DC    A(BUPPARM)              LIST WITH   1 ARGUMENT(S)
@AL00288 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00384 DC    A(HMASMCRP)             LIST WITH   1 ARGUMENT(S)
@AL00272 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00304 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00307 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00324 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00328 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00488 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00563 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DC    A(NUMJCL)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00005 DS    18F
@SA00006 DS    18F
@AL00001 DS    4A
@TF00001 DS    F
         DS    0F
@CF00054 DC    F'1'
@CH00054 EQU   @CF00054+2
@CF00046 DC    F'3'
@CH00046 EQU   @CF00046+2
@CF00037 DC    F'4'
@CH00037 EQU   @CF00037+2
@CF00039 DC    F'8'
@CF00034 DC    F'10'
@CF00273 DC    F'14'
@CF00488 DC    F'25'
@CH00488 EQU   @CF00488+2
@CF01064 DC    F'71'
@CH01064 EQU   @CF01064+2
@CF00860 DC    F'72'
@CF01612 DC    F'-82'
@CF01609 DC    F'-81'
@CF01607 DC    F'-80'
@CF01614 DC    F'-78'
@CF01611 DC    F'-77'
@CF01597 DC    F'-13'
@CF01598 DC    F'-12'
@CV01377 DC    V(HMASMIO)
@CV01378 DC    V(HMASMBUE)
@CV01379 DC    V(HMASMCRD)
@CV01380 DC    V(HMASMSCN)
@CV01381 DC    V(HMASMASM)
@CV01382 DC    V(HMASMLKD)
@CV01383 DC    V(HMASMMSG)
@CV01384 DC    V(HMASMCPY)
         DS    0D
K        DS    F
NXTBFRAD DC    A(0)
BUFRPTR  DC    AL4(JCLBUF)
I        DS    H
J        DS    H
NUMJCL   DS    H
MAXJCL   DS    H
UPDRTNCD DC    AL1(0)
@TS00001 DS    CL80
@CC01416 DC    C'//SYSIN '
@CC01418 DC    C'*NONAME*'
@CC01420 DC    C'SMPTLIB '
@CC01422 DC    C'JCLIN   '
@CC01412 DC    C'EXEC '
@CC01410 DC    C'JOB '
@CC01569 DC    C'DATA'
@CC01570 DC    C'DLM='
@CC01414 DC    C'DD '
@CC01568 DC    C'DSN'
@CC01429 EQU   @CC01416
@CC01431 DC    C'/*'
@CC01487 DC    C'++'
HMASMCRP DS    CL106
         ORG   HMASMCRP
CRPUXNUM DS    FL1
@NM00172 DS    CL3
CRPSCPAD DS    AL4
CRPINDS  DS    FL1
CRPOUTDS DS    FL1
CRPRETRN DS    FL1
@NM00173 DS    CL3
CRPFLG1  DS    BL2
         ORG   CRPFLG1
CRPBFPRM DS    BL1
CRPLOGCK EQU   CRPFLG1+0
CRPPTS   EQU   CRPFLG1+0
CRPLOG   EQU   CRPFLG1+0
CRPPRINT EQU   CRPFLG1+0
CRPOTHER EQU   CRPFLG1+0
CRPOFFST EQU   CRPFLG1+0
CRPSCNCL EQU   CRPFLG1+0
CRPEOFEN DS    BL1
CRPTRMEX EQU   CRPFLG1+1
CRPNOWPP EQU   CRPFLG1+1
CRPLIST  EQU   CRPFLG1+1
CRPRPT   EQU   CRPFLG1+1
@NM00174 EQU   CRPFLG1+1
         ORG   HMASMCRP+16
CRPFLG2  DS    BL2
         ORG   CRPFLG2
CRPINSW0 DS    BL1
         ORG   CRPINSW0
CRPEOFSW DS    BL1
         ORG   CRPFLG2+0
CRPINSW1 EQU   CRPFLG2+0
         ORG   CRPINSW1
CRPEXADD EQU   CRPINSW1+0
         ORG   CRPFLG2+0
CRPINSW2 EQU   CRPFLG2+0
         ORG   CRPINSW2
CRPWRTLG EQU   CRPINSW2+0
         ORG   CRPFLG2+0
CRPINSW3 EQU   CRPFLG2+0
         ORG   CRPINSW3
CRPEOF1  EQU   CRPINSW3+0
         ORG   CRPFLG2+0
CRPINSW4 EQU   CRPFLG2+0
CRPINSW5 EQU   CRPFLG2+0
CRPINSW6 EQU   CRPFLG2+0
CRPINSW7 EQU   CRPFLG2+0
         DS    CL1
CRPINSW8 DS    BL1
CRPINSW9 EQU   CRPFLG2+1
CRPINSWA EQU   CRPFLG2+1
CRPINSWB EQU   CRPFLG2+1
CRPINSWC EQU   CRPFLG2+1
CRPINSWD EQU   CRPFLG2+1
CRPINSWE EQU   CRPFLG2+1
CRPINSWF EQU   CRPFLG2+1
         ORG   HMASMCRP+18
CRPBUFFR DS    CL80
         ORG   CRPBUFFR
CRPBFCTL DS    CL72
         ORG   CRPBFCTL
CRPBFDTA DS    CL71
CRPBFCNT DS    CL1
         ORG   CRPBUFFR+72
CRPBFSEQ DS    CL8
         ORG   HMASMCRP+98
CRPDDNAM DS    CL8
         ORG   HMASMCRP+106
         DS    CL2
HMASMSCP DS    CL26
         ORG   HMASMSCP
SCPCHAR  DS    AL4
SCPSRCH  DS    AL4
SCPWKAR  DS    AL4
SCPIORTN DS    AL4
SCPIOPAD DS    AL4
SCPINLN  DS    FL2
SCPPMLN  DS    FL2
SCPEOR   DS    BL1
         ORG   SCPEOR
SCPCONT  DS    BL1
SCPNOCT  EQU   SCPEOR+0
SCPCOMNT EQU   SCPEOR+0
SCPRTERR EQU   SCPEOR+0
SCPNOSUC EQU   SCPEOR+0
SCPNORT  EQU   SCPEOR+0
@NM00175 EQU   SCPEOR+0
         ORG   HMASMSCP+25
SCPRETRN DS    FL1
         ORG   SCPRETRN
SCPRET   DS    FL1
         ORG   HMASMSCP+26
         DS    CL2
HMASMMGP DS    CL24
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00177 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00178 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL12
         ORG   MGPVAR
MGPVARPT DS    3A
         ORG   HMASMMGP+24
BUPPARM  DS    CL20
         ORG   BUPPARM
BUPFUNCT DS    FL1
BUPTYPE  DS    FL1
BUPSTYPE DS    FL1
BUPFLAGS DS    BL1
         ORG   BUPFLAGS
BUPREDO  DS    BL1
@NM00179 EQU   BUPFLAGS+0
         ORG   BUPPARM+4
BUPSYSMD DS    CL7
@NM00180 DS    CL1
BUPIOPAD DS    AL4
BUPGTPAD DS    AL4
         ORG   BUPPARM+20
DLM      DC    CL2'  '
NAMESAVE DS    CL8
STEPNAME DS    CL8
JOBNAME  DS    CL8
DDNAME   DS    CL8
PATCHUPD DS    CL80
         ORG   PATCHUPD
@NM00181 DC    80X'FF'
         ORG   PATCHUPD+80
FLAGS    DS    BL1
         ORG   FLAGS
EOFSW    DS    BL1
SKIPREAD EQU   FLAGS+0
FRSTREAD EQU   FLAGS+0
ALCDONE  EQU   FLAGS+0
@NM00182 EQU   FLAGS+0
         ORG   FLAGS+1
UPDSW1   DS    BL1
         ORG   UPDSW1
CONTSW   DS    BL1
DDSW     EQU   UPDSW1+0
DLMSW    EQU   UPDSW1+0
ASTFSW   EQU   UPDSW1+0
DATAFSW  EQU   UPDSW1+0
DLMFSW   EQU   UPDSW1+0
@NM00183 EQU   UPDSW1+0
         ORG   UPDSW1+1
UPDSW2   DS    BL1
         ORG   UPDSW2
UPDSW    DS    BL1
ASMSW    EQU   UPDSW2+0
LKDSW    EQU   UPDSW2+0
CPYSW    EQU   UPDSW2+0
@NM00184 EQU   UPDSW2+0
         ORG   UPDSW2+1
         DS    CL3
ALTADDR  DC    AL4(KALTASM)
         DC    AL4(KALTLKED)
         DC    AL4(KALTUPDT)
         DC    AL4(KALTCOPY)
JCLBUF   DS    25CL80
HMASMUPD CSECT
KSLBLNK  DSCAN KEY='// ',ALT=KSLSL,SUCC=KJOB,ROUT=RSLBLNK    @XA07937
KSLSL    DSCAN KEY='//',ALT=KRESET,SUCC=KJOBNMV
KJOBNMV  DSCAN MINLEN=0,MAXLEN=8,TYPE=AN,SUCC=KJOB,ROUT=RJOBNMV
KJOB     DSCAN KEY='JOB',ALT=KEXEC,SUCC=KRESET,ROUT=RJOB
KEXEC    DSCAN KEY='EXEC',ALT=KRESET,SUCC=KASMS
KRESET   DSCAN MINLEN=0
KASMS    DSCAN KEY='ASMS',ALT=KLINKS,SUCC=KINVOK,ROUT=RASMS
KLINKS   DSCAN KEY='LINKS',ALT=KPCOPY,SUCC=KINVOK,ROUT=RLINKS
KPCOPY   DSCAN KEY='PGM=IEBCOPY',ALT=KPIEUASM,SUCC=KINVOK,ROUT=RPCOPY
KPIEUASM DSCAN KEY='PGM=IEUASM',ALT=KPIFOX00,SUCC=KINVOK,ROUT=RPIEUASM
KPIFOX00 DSCAN KEY='PGM=IFOX00',ALT=KPASMBLR,SUCC=KINVOK,ROUT=RPIFOX00
KPASMBLR DSCAN KEY='PGM=ASMBLR',ALT=KPIEWL,SUCC=KINVOK,ROUT=RPASMBLR
KPIEWL   DSCAN KEY='PGM=IEWL',ALT=KPHEWL,SUCC=KINVOK,ROUT=RPIEWL
KPHEWL   DSCAN KEY='PGM=HEWL',ALT=KPUPDTE,SUCC=KINVOK,ROUT=RPHEWL
KPUPDTE  DSCAN KEY='PGM=IEBUPDTE',ALT=KALTASM,ROUT=RPUPDTE
KALTASM  DSCAN KEY='////////////',ALT=KALTLKED,SUCC=KINVOK,            X
               ROUT=RALTASM
KALTLKED DSCAN KEY='////////////',ALT=KALTUPDT,SUCC=KINVOK,            X
               ROUT=RALTLKED
KALTUPDT DSCAN KEY='////////////',ALT=KALTCOPY,                        X
               ROUT=RALTUPDT
KALTCOPY DSCAN KEY='////////////',ALT=KRESET,SUCC=KINVOK,              X
               ROUT=RALTCOPY
KINVOK   DSCAN MINLEN=0,ROUT=RINVOK
HMASMUPD CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCAPTR   EQU   @11
IOPPTR   EQU   @09
SIZE     EQU   @02
RTNREG   EQU   @14
RTNCODE  EQU   @15
R1       EQU   @01
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00010 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00026 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00028 EQU   CCABLDLL
CCALKDRC EQU   @NM00028+20
@NM00030 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00030+20
@NM00032 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00032+20
@NM00034 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00034+20
@NM00036 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00036+20
@NM00038 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00038+20
@NM00040 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00040+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
@NM00044 EQU   HMASMIOP+12
@NM00045 EQU   @NM00044
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00155 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
SCPSTRNG EQU   0
DSCANMAP EQU   0
DSCFLAG  EQU   DSCANMAP+12
DSCKEYLN EQU   DSCANMAP+15
DSCEND   EQU   DSCANMAP+16
BUFFER   EQU   0
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
SCPIOPRM EQU   0
UPDPARM  EQU   0
UPDPGMS  EQU   UPDPARM
UPDPGMLN EQU   UPDPGMS
UPDPGMNM EQU   UPDPGMS+1
UPDSYSMD EQU   UPDPARM+52
UPDSTYPE EQU   UPDPARM+59
UPDDSID  EQU   UPDPARM+60
UPDDDNAM EQU   UPDPARM+64
UPDDSNAM EQU   UPDPARM+72
UPDGTPAD EQU   UPDPARM+116
UPDFLAGS EQU   UPDPARM+120
UPDFLG1  EQU   UPDFLAGS
UPDFLG2  EQU   UPDFLAGS
UPDFLG3  EQU   UPDFLAGS
UPDREDO  EQU   UPDFLG3
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00051 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPDSN   EQU   IOPDYNDT
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00062 EQU   IOPUDATA
@NM00063 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00072 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00083 EQU   IOPSRCDR+1
@NM00085 EQU   @NM00083+7
@NM00089 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00093 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00099 EQU   IOPMODDR+1
@NM00101 EQU   @NM00099+7
@NM00105 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00109 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00120 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00127 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00136 EQU   IOPPTFFX
@NM00137 EQU   @NM00136
IOPPDTES EQU   IOPPTFFX+41
@NM00140 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00165 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00165
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00169 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00169
IOPBFTB1 EQU   IOPBFTB0
DSCKEY   EQU   DSCEND
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00171 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00170 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00168 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00167 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00166 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00164 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00163 EQU   IOPPTSFX+35
@NM00162 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00161 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00160 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00159 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00158 EQU   IOPQFMDR
@NM00154 EQU   IOPQSMDR
@NM00153 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00152 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00151 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00150 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00149 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00148 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00147 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00146 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00145 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00144 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00143 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00142 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00141 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00140+3
IOPRECD  EQU   @NM00140
@NM00139 EQU   IOPPTFFX+8
@NM00138 EQU   @NM00136+7
IOPPRELN EQU   @NM00137
@NM00135 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00134 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00133 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00132 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00131 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00130 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00129 EQU   @NM00127+7
@NM00128 EQU   @NM00127
@NM00126 EQU   IOPSYSDR+5
@NM00125 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00124 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00123 EQU   IOPDLBFX+8
@NM00122 EQU   @NM00120+7
@NM00121 EQU   @NM00120
@NM00119 EQU   IOPDLBDR+1
@NM00118 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00117 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00116 EQU   IOPMODFX+12
@NM00115 EQU   IOPMODF4
@NM00114 EQU   IOPMODF3
@NM00113 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00112 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00111 EQU   @NM00109+7
@NM00110 EQU   @NM00109
@NM00108 EQU   IOPMODDR+17
@NM00107 EQU   @NM00105+7
@NM00106 EQU   @NM00105
@NM00104 EQU   @NM00101
@NM00103 EQU   @NM00101
@NM00102 EQU   @NM00101
@NM00100 EQU   @NM00099
@NM00098 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00097 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00096 EQU   IOPSRCFX+8
@NM00095 EQU   @NM00093+7
@NM00094 EQU   @NM00093
@NM00092 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00091 EQU   @NM00089+7
@NM00090 EQU   @NM00089
@NM00088 EQU   @NM00085
@NM00087 EQU   @NM00085
@NM00086 EQU   @NM00085
@NM00084 EQU   @NM00083
@NM00082 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00081 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00080 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00079 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00078 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00077 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00076 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00074 EQU   @NM00072+7
@NM00073 EQU   @NM00072
@NM00071 EQU   IOPLMDDR+6
@NM00070 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00069 EQU   IOPLMDF4
@NM00068 EQU   IOPLMDF3
@NM00067 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00066 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00065 EQU   IOPLMDDR
@NM00064 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00063+4
IOPUSED  EQU   @NM00063
IOPTPSEQ EQU   @NM00062+8
IOPVLSER EQU   @NM00062+2
IOPBLKSI EQU   @NM00062
IOPCQMAX EQU   IOPCQMAP+12
@NM00061 EQU   IOPCQMAP+11
@NM00060 EQU   IOPCQMAP+8
@NM00059 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00058 EQU   IOPSCMAP+11
@NM00057 EQU   IOPSCMAP+8
@NM00056 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00055 EQU   IOPNTMAX+11
@NM00054 EQU   IOPNTMAX+8
@NM00053 EQU   IOPNTMAX
@NM00052 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00051+5
IOPIPTF3 EQU   @NM00051
UPDFLG8  EQU   UPDFLAGS
UPDFLG7  EQU   UPDFLAGS
UPDFLG6  EQU   UPDFLAGS
UPDFLG5  EQU   UPDFLAGS
UPDFLG4  EQU   UPDFLAGS
UPDTRACE EQU   UPDFLG2
UPDCHECK EQU   UPDFLG1
@NM00001 EQU   UPDPARM+61
DSCMINLN EQU   DSCANMAP+14
DSCMAXLN EQU   DSCANMAP+13
@NM00176 EQU   DSCFLAG
DSCCALRT EQU   DSCFLAG
DSCHEX   EQU   DSCFLAG
DSCCOMMA EQU   DSCFLAG
DSCCONT  EQU   DSCFLAG
DSCBLANK EQU   DSCFLAG
DSCNUMER EQU   DSCFLAG
DSCALPHA EQU   DSCFLAG
DSCRTAD  EQU   DSCANMAP+8
DSCSUCAD EQU   DSCANMAP+4
DSCALTAD EQU   DSCANMAP
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00157 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00156 EQU   @NM00155+7
IOPQSMFM EQU   @NM00155
@NM00075 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00050 EQU   IOPUSERL
@NM00049 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00048 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00047 EQU   @NM00044+10
IOPSEQNO EQU   @NM00044+8
@NM00046 EQU   @NM00045+7
IOPPTFNM EQU   @NM00045
IOPNAM17 EQU   IOPNAME
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00043 EQU   CCABLDLM+2
@NM00042 EQU   CCABLDLM
CCAUPDPM EQU   @NM00040+24
@NM00041 EQU   @NM00040+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00040+12
CCAUPDTE EQU   @NM00040+8
CCAUPDNM EQU   @NM00040
CCASUPPM EQU   @NM00038+24
@NM00039 EQU   @NM00038+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00038+12
CCAIOSUP EQU   @NM00038+8
CCASUPNM EQU   @NM00038
CCAZAPPM EQU   @NM00036+24
@NM00037 EQU   @NM00036+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00036+12
CCASPZAP EQU   @NM00036+8
CCAZAPNM EQU   @NM00036
CCACOMPM EQU   @NM00034+24
@NM00035 EQU   @NM00034+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00034+12
CCACOMRS EQU   @NM00034+8
CCACOMNM EQU   @NM00034
CCACPYPM EQU   @NM00032+24
@NM00033 EQU   @NM00032+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00032+12
CCACOPY  EQU   @NM00032+8
CCACPYNM EQU   @NM00032
CCAASMPM EQU   @NM00030+24
@NM00031 EQU   @NM00030+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00030+12
CCAASM   EQU   @NM00030+8
CCAASMNM EQU   @NM00030
CCALKDPM EQU   @NM00028+24
@NM00029 EQU   @NM00028+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00028+12
CCALKED  EQU   @NM00028+8
CCALKDNM EQU   @NM00028
CCAPGMPM EQU   @NM00026+24
@NM00027 EQU   @NM00026+21
CCABPGRC EQU   @NM00026+20
CCABPGSP EQU   @NM00026+12
CCABPGAD EQU   @NM00026+8
CCABPGNM EQU   @NM00026
CCAEND   EQU   HMASMCCA+371
@NM00025 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00024 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00023 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00022 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00021 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00020 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00019 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00018 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00017 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00016 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00015 EQU   @NM00010+18
@NM00014 EQU   @NM00010+16
CCATBLPA EQU   @NM00010+12
@NM00013 EQU   @NM00010+8
@NM00012 EQU   @NM00010+4
@NM00011 EQU   @NM00010
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00009 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00008 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00007 EQU   CCAFBUFR+122
@NM00006 EQU   CCAFBUFR+120
@NM00005 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00004 EQU   CCAFBUFR+88
@NM00003 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00002 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00246 EQU   @RC00238
@RT00277 EQU   TERMMSG
@RT00281 EQU   GOODEXIT
@RT00297 EQU   GOODEXIT
@RC00389 EQU   @EL00005
@RT00422 EQU   JCLSCN30
@RF00437 EQU   UPDT030
@RT00455 EQU   UPDEXC20
@RT00461 EQU   JCLSCN10
@RT00467 EQU   JCLSCN20
@RC00531 EQU   @EL00006
@RF00570 EQU   @EL00006
@ENDDATA EQU   *
         END   HMASMUPD,(C'PLS2234',0802,78334)

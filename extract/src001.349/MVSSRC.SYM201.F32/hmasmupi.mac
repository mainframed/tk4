         TITLE 'HMASMUPI - MACRO/SOURCE UPDATE MODULE'
HMASMUPI CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMUPI  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*   CALL INITIAL;                   /* INITIALIZE MODULE             */
         BAL   @14,INITIAL                                         0183
*                                                                  0184
*   /*****************************************************************/
*   /*                                                               */
*   /* SYSMODS WITH REPLACEMENT ELEMENTS ARE PROCESSED IN FIRST PASS.*/
*   /* THE UPDATES ARE DONE AFTER ALL REPLACEMENTS.          @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0184
*                                                                  0184
*   /*****************************************************************/
*   /*                                                               */
*   /* MAIN PTF LOOP                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0184
*   DO I=1 BY 1                     /* LOOP THRU PTFS UNTIL          */
*         WHILE((ICTPEND(I)^=ICTENDNT)&/* NO MORE PTFS OR            */
*         (HIGHUPI^>STOPPTF));      /* SMP LEVEL ERROR.              */
*                                                                  0184
         LA    @08,1                                               0184
         ST    @08,I                                               0184
         B     @DE00184                                            0184
@DL00184 DS    0H                                                  0185
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS ELIGIBLE SYSMODS                            @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0185
*     IF ICTPECPL(I)=OFF            /* NOT COMPLETE.         @Z67SP00*/
*       THEN                        /*                               */
         L     @08,I                                               0185
         MH    @08,@CH01799                                        0185
         L     @01,CCAICPTF(,CCAPTR)                               0185
         ALR   @01,@08                                             0185
         AL    @01,@CF01805                                        0185
         TM    ICTPECPL-14(@01),B'01000000'                        0185
         BNZ   @RF00185                                            0185
*       DO;                         /* PTF IS CANDID. FOR UPDATE     */
*         UPIERROR=OFF;             /* ERROR SWITCH RESET    @Z67SP00*/
*                                                                  0187
         NI    UPIERROR,B'01111111'                                0187
*         /***********************************************************/
*         /*                                                         */
*         /* MAIN ELEMENT LOOP                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0188
*         DO J=1 BY 1 WHILE         /* PROCESS EACH ELEMENT          */
*               (ICTIXP(J)^=ICTENDIX/* IN PTF UNTIL NO MORE          */
*               &UPIERROR=OFF);     /* AND NO ERRORS         @Z67SP00*/
*                                                                  0188
         LA    @08,1                                               0188
         ST    @08,J                                               0188
         B     @DE00188                                            0188
@DL00188 DS    0H                                                  0189
*           /*********************************************************/
*           /*                                                       */
*           /* ELEMENT ELIGIBILITY CHECK                     @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0189
*           IF(ICTMMACR(1)=ON       /* IF MAC REPL. OR               */
*               ×ICTMSRCR(1)=ON)    /* SRC REPL. AND         @Z67SP00*/
*               &ICTMCPL(1)=OFF     /* NOT COMPLETE AND              */
*               &ICTMIDEL(1)=OFF    /* NOT DELETED           @Z67SP00*/
*               &ICTMISEL(1)=ON     /* SELECTED              @Z67SP00*/
*             THEN                  /* THEN ELEMENT IS               */
         L     @08,J                                               0189
         SLA   @08,2                                               0189
         L     @15,I                                               0189
         MH    @15,@CH01799                                        0189
         L     @14,CCAICPTF(,CCAPTR)                               0189
         LA    @01,0(@15,@14)                                      0189
         AL    @01,@CF01807                                        0189
         L     @01,ICTPCHN-64(,@01)                                0189
         AL    @01,@CF01808                                        0189
         L     @08,ICTIXP(@08,@01)                                 0189
         TM    ICTMMACR(@08),B'00001010'                           0189
         BZ    @RF00189                                            0189
         TM    ICTMCPL(@08),B'00100000'                            0189
         BNZ   @RF00189                                            0189
         TM    ICTMISEL(@08),B'10000000'                           0189
         BNO   @RF00189                                            0189
         TM    ICTMIDEL(@08),B'01000000'                           0189
         BNZ   @RF00189                                            0189
*             DO;                   /* CANDID. FOR UPDATE            */
*                                                                  0190
*               /*****************************************************/
*               /*                                                   */
*               /* CREATE (A)CDS SYSMOD ENTRY                @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0191
*               CALL HMASMSEC(ICTPTFS(I),IOPPTR);/*          @Z67SP00*/
         AL    @14,@CF01809                                        0191
         LA    @08,ICTPTFS(@15,@14)                                0191
         ST    @08,@AL00001                                        0191
         LA    @08,IOPPTR                                          0191
         ST    @08,@AL00001+4                                      0191
         L     @15,@CV01713                                        0191
         LA    @01,@AL00001                                        0191
         BALR  @14,@15                                             0191
*               RFY                                                0192
*                 RTNCODE RSTD;     /*                       @Z67SP00*/
*               IF RTNCODE^=ZERO THEN/* ERROR                @Z67SP00*/
         LTR   RTNCODE,RTNCODE                                     0193
         BZ    @RF00193                                            0193
*                 DO;               /*                       @Z67SP00*/
*                   UPIERROR=ON;    /* ERROR SW              @Z67SP00*/
         OI    UPIERROR,B'10000000'                                0195
*                   HIGHUPI=MAX(HIGHUPI,RTNCODE);/*          @Z67SP00*/
         SLR   @14,@14                                             0196
         IC    @14,HIGHUPI                                         0196
         CR    @14,RTNCODE                                         0196
         BNL   *+6
         LR    @14,RTNCODE                                         0196
         STC   @14,HIGHUPI                                         0196
*                 END;              /*                       @Z67SP00*/
*               RFY                                                0198
*                 RTNCODE UNRSTD;   /*                       @Z67SP00*/
@RF00193 DS    0H                                                  0199
*               ICTPROCS(I)=ON;     /* SET PTF IN PROCESS    @Z67SP00*/
         L     @08,I                                               0199
         MH    @08,@CH01799                                        0199
         L     @15,CCAICPTF(,CCAPTR)                               0199
         ST    @08,@TF00001                                        0199
         ALR   @08,@15                                             0199
         AL    @08,@CF01811                                        0199
         OI    ICTPROCS-8(@08),B'10000000'                         0199
*               ICTMPROC(1)=ON;     /* SET MODULE IN PROCESS @Z67SP00*/
*                                                                  0200
         L     @08,J                                               0200
         SLA   @08,2                                               0200
         L     @14,@TF00001                                        0200
         AL    @15,@CF01807                                        0200
         L     @01,ICTPCHN-64(@14,@15)                             0200
         AL    @01,@CF01808                                        0200
         L     @08,ICTIXP(@08,@01)                                 0200
         OI    ICTMPROC(@08),B'10000000'                           0200
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP IEBUPDTE CONTROL ON SYSUT1         @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0201
*               IF UPIERROR=OFF THEN/*                       @Z67SP00*/
         TM    UPIERROR,B'10000000'                                0201
         BNZ   @RF00201                                            0201
*                 CALL UT1SYSIN;    /* SET UP SYSIN          @Z67SP00*/
         BAL   @14,UT1SYSIN                                        0202
*               IF UPIERROR=OFF THEN/* IF NO PTF ERROR               */
@RF00201 TM    UPIERROR,B'10000000'                                0203
         BNZ   @RF00203                                            0203
*                 DO;               /* PROCEED WITH UPDATE           */
*                                                                  0204
*                   /*************************************************/
*                   /*                                               */
*                   /* SET UP INVOCATION PARMS               @Z67SP00*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0205
*                   UPPARM=MODPARM; /* PARM=MOD              @Z67SP00*/
         MVI   UPPARM+3,C' '                                       0205
         MVC   UPPARM+4(87),UPPARM+3                               0205
         MVC   UPPARM(3),MODPARM                                   0205
*                   UPDOPT=LENGTH(MODPARM);/* FIELD LENGTH   @Z67SP00*/
*                                                                  0206
         MVC   UPDOPT(2),@CH00234                                  0206
*                   /*************************************************/
*                   /*                                               */
*                   /* INTERFACE WITH IEBUPDTE               @Z67SP00*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0207
*                   CALL UPDATE;    /* PERFORM LIB. UPDATE           */
         BAL   @14,UPDATE                                          0207
*                 END;              /* END OF UPDATE                 */
*                                                                  0208
*               /*****************************************************/
*               /*                                                   */
*               /* SYSMOD COMPLETION                         @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0209
*               IF UPIERROR=OFF THEN/* NORMAL PARM           @Z67SP00*/
@RF00203 TM    UPIERROR,B'10000000'                                0209
         BNZ   @RF00209                                            0209
*                 STATUS=GOOD;      /*                       @Z67SP00*/
         MVI   STATUS,C'G'                                         0210
*               ELSE                /* ERROR PARM            @Z67SP00*/
*                 STATUS=BAD;       /*                       @Z67SP00*/
         B     @RC00209                                            0211
@RF00209 MVI   STATUS,C'B'                                         0211
*               CALL HMASMCPL(STATUS);/*                     @Z67SP00*/
@RC00209 L     @15,@CV01714                                        0212
         LA    @01,@AL00212                                        0212
         BALR  @14,@15                                             0212
*             END;                  /* END OF ELEMENT PROCESS.       */
*         END;                      /* END OF ELEMENT LOOP           */
@RF00189 LA    @08,1                                               0214
         AL    @08,J                                               0214
         ST    @08,J                                               0214
@DE00188 L     @08,J                                               0214
         SLA   @08,2                                               0214
         L     @15,I                                               0214
         MH    @15,@CH01799                                        0214
         L     @01,CCAICPTF(,CCAPTR)                               0214
         AL    @01,@CF01807                                        0214
         L     @01,ICTPCHN-64(@15,@01)                             0214
         AL    @01,@CF01808                                        0214
         L     @08,ICTIXP(@08,@01)                                 0214
         CL    @08,ICTENDIX                                        0214
         BE    @DC00188                                            0214
         TM    UPIERROR,B'10000000'                                0214
         BZ    @DL00188                                            0214
@DC00188 DS    0H                                                  0215
*       END;                        /* END OF PTF PROCESS.           */
*   END;                            /* END OF PTF LOOP               */
@RF00185 LA    @08,1                                               0216
         AL    @08,I                                               0216
         ST    @08,I                                               0216
@DE00184 L     @08,I                                               0216
         MH    @08,@CH01799                                        0216
         L     @01,CCAICPTF(,CCAPTR)                               0216
         AL    @01,@CF01809                                        0216
         L     @08,ICTPEND(@08,@01)                                0216
         CL    @08,ICTENDNT                                        0216
         BE    @DC00184                                            0216
         CLI   HIGHUPI,8                                           0216
         BNH   @DL00184                                            0216
@DC00184 DS    0H                                                  0217
         EJECT
*                                                                  0217
*   /*****************************************************************/
*   /*                                                               */
*   /* SYSMODS CONTAINING UPDATE ELEMENTS ARE NOW PROCESSED. @Z67SP00*/
*   /* MAIN PTF LOOP                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0217
*   DO I=1 BY 1                     /* LOOP THRU PTFS UNTIL          */
*         WHILE((ICTPEND(I)^=ICTENDNT)&/* NO MORE PTFS OR            */
*         (HIGHUPI^>STOPPTF));      /* SMP LEVEL ERROR.              */
*                                                                  0217
         LA    @08,1                                               0217
         ST    @08,I                                               0217
         B     @DE00217                                            0217
@DL00217 DS    0H                                                  0218
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS ELIGIBLE SYSMODS                            @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0218
*     IF ICTPCPL(I)=OFF             /* NOT COMPLETE.         @Z67SP00*/
*       THEN                        /*                               */
         L     @08,I                                               0218
         MH    @08,@CH01799                                        0218
         L     @01,CCAICPTF(,CCAPTR)                               0218
         ALR   @01,@08                                             0218
         AL    @01,@CF01811                                        0218
         TM    ICTPCPL-8(@01),B'00100000'                          0218
         BNZ   @RF00218                                            0218
*       DO;                         /* PTF IS CANDID. FOR UPDATE     */
*         UPIERROR=OFF;             /* ERROR SWITCH          @Z67SP00*/
*                                                                  0220
         NI    UPIERROR,B'01111111'                                0220
*         /***********************************************************/
*         /*                                                         */
*         /* MAIN ELEMENT LOOP                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0221
*         DO J=1 BY 1 WHILE         /* PROCESS EACH ELEMENT          */
*               (ICTIXP(J)^=ICTENDIX/* IN PTF UNTIL NO MORE          */
*               &UPIERROR=OFF);     /* OR PTF ERROR.                 */
*                                                                  0221
         LA    @08,1                                               0221
         ST    @08,J                                               0221
         B     @DE00221                                            0221
@DL00221 DS    0H                                                  0222
*           /*********************************************************/
*           /*                                                       */
*           /* ELEMENT ELIGIBILITY CHECK                     @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0222
*           IF(ICTMMACU(1)=ON       /* MAC. UPDATE OR        @Z67SP00*/
*               ×ICTMSRCU(1)=ON)    /* SRC. UPDATE                   */
*               &ICTMCPL(1)=OFF     /* NOT COMPLETE AND              */
*               &ICTMIDEL(1)=OFF    /* NOT DELETED           @Z67SP00*/
*               &ICTMISEL(1)=ON     /* SELECTED              @Z67SP00*/
*             THEN                  /* THEN ELEMENT IS               */
         L     @08,J                                               0222
         SLA   @08,2                                               0222
         L     @15,I                                               0222
         MH    @15,@CH01799                                        0222
         L     @14,CCAICPTF(,CCAPTR)                               0222
         LA    @01,0(@15,@14)                                      0222
         AL    @01,@CF01807                                        0222
         L     @01,ICTPCHN-64(,@01)                                0222
         AL    @01,@CF01808                                        0222
         L     @08,ICTIXP(@08,@01)                                 0222
         TM    ICTMMACU(@08),B'00000101'                           0222
         BZ    @RF00222                                            0222
         TM    ICTMCPL(@08),B'00100000'                            0222
         BNZ   @RF00222                                            0222
         TM    ICTMISEL(@08),B'10000000'                           0222
         BNO   @RF00222                                            0222
         TM    ICTMIDEL(@08),B'01000000'                           0222
         BNZ   @RF00222                                            0222
*             DO;                   /* CANDID. FOR UPDATE            */
*                                                                  0223
*               /*****************************************************/
*               /*                                                   */
*               /* PROCESS THE CANDIDATE ELEMENT CREATE (A)CDS SYSMOD*/
*               /* ENTRY                                     @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0224
*               CALL HMASMSEC(ICTPTFS(I),IOPPTR);/*          @Z67SP00*/
         AL    @14,@CF01809                                        0224
         LA    @08,ICTPTFS(@15,@14)                                0224
         ST    @08,@AL00001                                        0224
         LA    @08,IOPPTR                                          0224
         ST    @08,@AL00001+4                                      0224
         L     @15,@CV01713                                        0224
         LA    @01,@AL00001                                        0224
         BALR  @14,@15                                             0224
*               RFY                                                0225
*                 RTNCODE RSTD;     /*                       @Z67SP00*/
*               IF RTNCODE^=ZERO THEN/* ERROR                @Z67SP00*/
         LTR   RTNCODE,RTNCODE                                     0226
         BZ    @RF00226                                            0226
*                 DO;               /*                       @Z67SP00*/
*                   UPIERROR=ON;    /* ERROR SW              @Z67SP00*/
         OI    UPIERROR,B'10000000'                                0228
*                   HIGHUPI=MAX(HIGHUPI,RTNCODE);/*          @Z67SP00*/
         SLR   @14,@14                                             0229
         IC    @14,HIGHUPI                                         0229
         CR    @14,RTNCODE                                         0229
         BNL   *+6
         LR    @14,RTNCODE                                         0229
         STC   @14,HIGHUPI                                         0229
*                 END;              /*                       @Z67SP00*/
*               RFY                                                0231
*                 RTNCODE UNRSTD;   /*                       @Z67SP00*/
@RF00226 DS    0H                                                  0232
*               ICTPROCS(I)=ON;     /* SET PTF IN PROCESS    @Z67SP00*/
         L     @08,I                                               0232
         MH    @08,@CH01799                                        0232
         L     @15,CCAICPTF(,CCAPTR)                               0232
         ST    @08,@TF00001                                        0232
         ALR   @08,@15                                             0232
         AL    @08,@CF01811                                        0232
         OI    ICTPROCS-8(@08),B'10000000'                         0232
*               ICTMPROC(1)=ON;     /* SET MODULE IN PROCESS @Z67SP00*/
*                                                                  0233
         L     @08,J                                               0233
         SLA   @08,2                                               0233
         L     @14,@TF00001                                        0233
         AL    @15,@CF01807                                        0233
         L     @01,ICTPCHN-64(@14,@15)                             0233
         AL    @01,@CF01808                                        0233
         L     @08,ICTIXP(@08,@01)                                 0233
         OI    ICTMPROC(@08),B'10000000'                           0233
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP IEBUPDTE CONTROL                   @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0234
*               IF UPIERROR=OFF THEN/*                       @Z67SP00*/
         TM    UPIERROR,B'10000000'                                0234
         BNZ   @RF00234                                            0234
*                 CALL WRKSYSIN;    /* SET UP SYSIN          @Z67SP00*/
         BAL   @14,WRKSYSIN                                        0235
*               IF UPIERROR=OFF     /* NO ERROR              @Z67SP00*/
*                 THEN              /* THAN WARNING                  */
@RF00234 TM    UPIERROR,B'10000000'                                0236
         BNZ   @RF00236                                            0236
*                 DO;               /* PROCEED WITH UPDATE           */
*                                                                  0237
*                   /*************************************************/
*                   /*                                               */
*                   /* SET UP INVOCATION PARMS               @Z67SP00*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0238
*                   UPPARM=MODPARM; /* FOR UPDATES           @Z67SP00*/
         MVI   UPPARM+3,C' '                                       0238
         MVC   UPPARM+4(87),UPPARM+3                               0238
         MVC   UPPARM(3),MODPARM                                   0238
*                   UPDOPT=LENGTH(MODPARM);/* FIELD LENGTH   @Z67SP00*/
*                                                                  0239
         MVC   UPDOPT(2),@CH00234                                  0239
*                   /*************************************************/
*                   /*                                               */
*                   /* INTERFACE WITH IEBUPDTE               @Z67SP00*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0240
*                   CALL UPDATE;    /* PERFORM LIB. UPDATE           */
         BAL   @14,UPDATE                                          0240
*                 END;              /* END OF UPDATE                 */
*                                                                  0241
*               /*****************************************************/
*               /*                                                   */
*               /* SYSMOD COMPLETION                         @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0242
*               IF UPIERROR=OFF THEN/* NORMAL PARM           @Z67SP00*/
@RF00236 TM    UPIERROR,B'10000000'                                0242
         BNZ   @RF00242                                            0242
*                 STATUS=GOOD;      /*                       @Z67SP00*/
         MVI   STATUS,C'G'                                         0243
*               ELSE                /* ERROR PARM            @Z67SP00*/
*                 STATUS=BAD;       /*                       @Z67SP00*/
         B     @RC00242                                            0244
@RF00242 MVI   STATUS,C'B'                                         0244
*               CALL HMASMCPL(STATUS);/*                     @Z67SP00*/
@RC00242 L     @15,@CV01714                                        0245
         LA    @01,@AL00245                                        0245
         BALR  @14,@15                                             0245
*             END;                  /* END OF ELEMENT PROCESS.       */
*         END;                      /* END OF ELEMENT LOOP           */
@RF00222 LA    @08,1                                               0247
         AL    @08,J                                               0247
         ST    @08,J                                               0247
@DE00221 L     @08,J                                               0247
         SLA   @08,2                                               0247
         L     @15,I                                               0247
         MH    @15,@CH01799                                        0247
         L     @01,CCAICPTF(,CCAPTR)                               0247
         AL    @01,@CF01807                                        0247
         L     @01,ICTPCHN-64(@15,@01)                             0247
         AL    @01,@CF01808                                        0247
         L     @08,ICTIXP(@08,@01)                                 0247
         CL    @08,ICTENDIX                                        0247
         BE    @DC00221                                            0247
         TM    UPIERROR,B'10000000'                                0247
         BZ    @DL00221                                            0247
@DC00221 DS    0H                                                  0248
*       END;                        /* END OF PTF PROCESS.           */
*   END;                            /* END OF PTF LOOP               */
@RF00218 LA    @08,1                                               0249
         AL    @08,I                                               0249
         ST    @08,I                                               0249
@DE00217 L     @08,I                                               0249
         MH    @08,@CH01799                                        0249
         L     @01,CCAICPTF(,CCAPTR)                               0249
         AL    @01,@CF01809                                        0249
         L     @08,ICTPEND(@08,@01)                                0249
         CL    @08,ICTENDNT                                        0249
         BE    @DC00217                                            0249
         CLI   HIGHUPI,8                                           0249
         BNH   @DL00217                                            0249
@DC00217 DS    0H                                                  0250
*   RETURN CODE(HIGHUPI);           /*                       @Z67SP00*/
         SLR   @15,@15                                             0250
         IC    @15,HIGHUPI                                         0250
         L     @13,4(,@13)                                         0250
         L     @14,12(,@13)                                        0250
         LM    @00,@12,20(@13)                                     0250
         BR    @14                                                 0250
*INITIAL:                                                          0251
*   PROCEDURE;                      /* INITIAL SEGMENT               */
*                                                                  0251
@EL00001 L     @13,4(,@13)                                         0251
@EF00001 DS    0H                                                  0251
@ER00001 LM    @14,@12,12(@13)                                     0251
         BR    @14                                                 0251
INITIAL  STM   @14,@12,12(@13)                                     0251
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIAL SEGMENT -- THIS ROUTINE INITIALIZES THE MODULE. IOP   */
*   /* ADDRESSIBILITY IS ESTABLISHED, IOPBUFAD IS SAVED. RETURN CODE,*/
*   /* MESSAGES, AND SWITCHES ARE CLEARED, PRINT TO SMPOUT ONLY IS   */
*   /* ESTABLISHED.                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0252
*   RFY                                                            0252
*     ICTPTF BASED(CCAICPTF);       /* SET UP ICT ADDRESSABILITY     */
*   RFY                                                            0253
*     ICTIXPF BASED(ICTPCHN(I));    /* PTF TO MOD CHAIN              */
*   RFY                                                            0254
*     ICTMOD BASED(ICTIXP(J));      /* MOD BASED ON PTF PTR          */
*   IOPPTR=CCAIOPTR;                /* SET ADDRESSABILITY TO IOP     */
         L     @08,CCAIOPTR(,CCAPTR)                               0255
         ST    @08,IOPPTR                                          0255
*   BUFFSAVE=IOPBUFAD;              /* SAVE IOP COMMON BFR PTR       */
         MVC   BUFFSAVE(4),IOPBUFAD(@08)                           0256
*   HIGHUPI=ZERO;                   /* SET RETURN CODE TO ZERO       */
         MVI   HIGHUPI,X'00'                                       0257
*   HMASMMGP=''B;                   /* CLEAR MESSAGE NUMBERS @Z67SP00*/
         XC    HMASMMGP(36),HMASMMGP                               0258
*   MGPPRINT=ON;                    /* MESSAGES TO SMPOUT            */
*   MGPHLDS=ON;                     /* AND SMPLOG            @Z67SP00*/
         OI    MGPPRINT,B'10010000'                                0260
*   SWITCHG1=ZERO;                  /* ENSURE SWITCHES INITIALIZED   */
         MVI   SWITCHG1,X'00'                                      0261
*   END INITIAL;                    /* END OF SEGMENT                */
@EL00002 DS    0H                                                  0262
@EF00002 DS    0H                                                  0262
@ER00002 LM    @14,@12,12(@13)                                     0262
         BR    @14                                                 0262
         EJECT
*WRKSYSIN:                                                         0263
*   PROCEDURE;                      /* WRKSYSIN SEGMENT              */
*                                                                  0263
WRKSYSIN STM   @14,@12,@SA00003                                    0263
*   /*****************************************************************/
*   /*                                                               */
*   /* WRKSYSIN SEGMENT -- THIS ROUTINE ESTABLISHES SYSIN FOR        */
*   /* IEBUPDTE. SMPWRK1 JFCB IS MODIFIED TO REFLECT A SEQUENTIAL    */
*   /* DATA SET WITH PROPER DSNAME (ELEMENT). IF ERRORS OCCUR, SYSIN */
*   /* DD IS SET TO ***, OTHERWISE IT IS SET TO SMPWRK1. THE RETURN  */
*   /* PASSES BACK AN UPDATED HMASMUPI RETURN CODE IF AN ERROR OCCURS*/
*   /* ON THE SMPWRK1.                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0264
*   RFY                                                            0264
*     ICTPTF BASED(CCAICPTF);       /* SET UP ICT ADDRESSABILITY     */
*   RFY                                                            0265
*     ICTIXPF BASED(ICTPCHN(I));    /* PTF TO MOD CHAIN              */
*   RFY                                                            0266
*     ICTMOD BASED(ICTIXP(J));      /* MOD BASED ON PTF PTR          */
*   IOPFUNCT=IOPJFCSI;              /* JFCB MODIFY SEQUENTIAL FUNC.
*                                      FOR INPUT                     */
         L     @08,IOPPTR                                          0267
         MVI   IOPFUNCT(@08),X'05'                                 0267
*   IOPDSID=IOPJFCB;                /* USE JFCB                      */
         MVI   IOPDSID(@08),X'19'                                  0268
*   IOPNAME=ICTMNAME(1);            /* MEMBER IS ELEMENT NAME        */
         L     @15,J                                               0269
         SLA   @15,2                                               0269
         L     @14,I                                               0269
         MH    @14,@CH01799                                        0269
         L     @01,CCAICPTF(,CCAPTR)                               0269
         AL    @01,@CF01807                                        0269
         L     @01,ICTPCHN-64(@14,@01)                             0269
         AL    @01,@CF01808                                        0269
         L     @15,ICTIXP(@15,@01)                                 0269
         MVC   IOPNAME(8,@08),ICTMNAME(@15)                        0269
*   IF ICTMMACU(1)=ON THEN          /* IF MACRO UPDATE       @Z67SP00*/
         TM    ICTMMACU(@15),B'00000100'                           0270
         BNO   @RF00270                                            0270
*     DO;                           /*                       @Z67SP00*/
*       IOPDDNAM=SMPWRK1;           /* DD IS SMPWRK1         @Z67SP00*/
         MVC   IOPDDNAM(8,@08),SMPWRK1                             0272
*       IOPTYPE=IOPMCU;             /* --FOR MACRO TYPE      @Z67SP00*/
         MVI   IOPTYPE(@08),X'04'                                  0273
*       UPSYSIN=SMPWRK1;            /* IEBUPDTE SYSIN DDNAME @Z67SP00*/
         MVC   UPSYSIN(8),SMPWRK1                                  0274
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /* ELSE MODIFY ELEMENT NAME      */
*     DO;                           /*                       @Z67SP00*/
         B     @RC00270                                            0276
@RF00270 DS    0H                                                  0277
*       IOPDDNAM=SMPWRK2;           /* DD IS SMPWRK2         @Z67SP00*/
         L     @08,IOPPTR                                          0277
         MVC   IOPDDNAM(8,@08),SMPWRK2                             0277
*       IOPTYPE=IOPSCU;             /* --FOR SOURCE TYPE     @Z67SP00*/
         MVI   IOPTYPE(@08),X'09'                                  0278
*       UPSYSIN=SMPWRK2;            /* IEBUPDTE SYSIN DDNAME @Z67SP00*/
         MVC   UPSYSIN(8),SMPWRK2                                  0279
*     END;                          /*                       @Z67SP00*/
*   CALL HMASMIO(HMASMIOP);         /* SET ELEMENT AS SEQ. DATASET   */
@RC00270 L     @08,IOPPTR                                          0281
         ST    @08,@AL00001                                        0281
         L     @15,@CV01712                                        0281
         LA    @01,@AL00001                                        0281
         BALR  @14,@15                                             0281
*   IF IOPRETRN^=IOPGOOD            /* CHECK I/O RETURN              */
*     THEN                          /* I/O ERROR                     */
         L     @08,IOPPTR                                          0282
         CLI   IOPRETRN(@08),0                                     0282
         BE    @RF00282                                            0282
*     DO;                           /*                               */
*       ICTMNOGO(1)=ON;             /* MARK ELEMENT NOGO             */
         L     @15,J                                               0284
         SLA   @15,2                                               0284
         L     @14,I                                               0284
         MH    @14,@CH01799                                        0284
         L     @01,CCAICPTF(,CCAPTR)                               0284
         AL    @01,@CF01807                                        0284
         L     @01,ICTPCHN-64(@14,@01)                             0284
         AL    @01,@CF01808                                        0284
         L     @01,ICTIXP(@15,@01)                                 0284
         OI    ICTMNOGO(@01),B'01000000'                           0284
*       UPIERROR=ON;                /* PROCESSING ERROR SW   @Z67SP00*/
         OI    UPIERROR,B'10000000'                                0285
*       HIGHUPI=MAX(HIGHUPI,IOPRETRN);/* UPDATE RETURN CODE          */
         SLR   @15,@15                                             0286
         IC    @15,HIGHUPI                                         0286
         SLR   @14,@14                                             0286
         IC    @14,IOPRETRN(,@08)                                  0286
         CR    @15,@14                                             0286
         BNL   *+6
         LR    @15,@14                                             0286
         STC   @15,HIGHUPI                                         0286
*     END;                          /*                               */
*   RETURN CODE(HIGHUPI);           /* RETURN WITH HIGHEST RET. CDE. */
@RF00282 SLR   @15,@15                                             0288
         IC    @15,HIGHUPI                                         0288
         L     @14,@SA00003                                        0288
         LM    @00,@12,@SA00003+8                                  0288
         BR    @14                                                 0288
*   END WRKSYSIN;                   /* END OF WRKSYSIN SEGMENT       */
         EJECT
*UT1SYSIN:                                                         0290
*   PROCEDURE;                      /* UT1SYSIN SEGMENT              */
*                                                                  0290
UT1SYSIN STM   @14,@12,@SA00004                                    0290
*   /*****************************************************************/
*   /*                                                               */
*   /* UT1SYSIN SEGMENT -- THIS ROUTINE WRITES A ./SMP REPRO         */
*   /* STATEMENT TO SYSUT1. THE NAME= WILL CONTAIN THE NAME OF THE   */
*   /* ELEMENT BEING PROCESSED. SYSUT1 IS SET UP AS SYSIN FOR        */
*   /* IEBUPDTE. THIS WILL PROVIDE IEBUPDTE WITH A CONTROL STATEMENT */
*   /* FOR TOTAL MACRO OR SOURCE ELEMENT UPDATE. --WRITEALI          */
*   /* (PARM=UT1)-- IS CALLED TO WRITE ./ ALIAS STATEMENTS TO SYSUT1.*/
*   /* IF ERRORS OCCUR, SYSIN DD IS SET TO ***. THE RETURN WILL PASS */
*   /* BACK THE HIGHEST RETURN CODE ENCOUNTERED.                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0291
*   RFY                                                            0291
*     ICTPTF BASED(CCAICPTF);       /* SET UP ICT ADDRESSABILITY     */
*   RFY                                                            0292
*     ICTIXPF BASED(ICTPCHN(I));    /* PTF TO MOD CHAIN              */
*   RFY                                                            0293
*     ICTMOD BASED(ICTIXP(J));      /* MOD BASED ON PTF PTR          */
*   UPDFLD1='';                     /* INIT FILEDS IN RECORD @Z67SP00*/
         MVI   UPDFLD1,C' '                                        0294
         MVC   UPDFLD1+1(12),UPDFLD1                               0294
*   UPDFLD2='';                     /* INIT FILEDS IN RECORD @Z67SP00*/
         MVI   UPDFLD2,C' '                                        0295
         MVC   UPDFLD2+1(12),UPDFLD2                               0295
*   UPSYSIN=SYSUT1;                 /* SET SYSUT1 AS UPDTE SYSIN DD  */
         MVC   UPSYSIN(8),SYSUT1                                   0296
*   UPDTEFUN=UPDTEREP;              /* SET UPDTE CNTL. CARD TO REPRO */
         MVC   UPDTEFUN(6),UPDTEREP                                0297
*   UPDTENAM=ICTMNAME(1);           /* SET UPDTE CNTL. CARD NAME=    */
         L     @08,J                                               0298
         SLA   @08,2                                               0298
         L     @15,I                                               0298
         MH    @15,@CH01799                                        0298
         L     @01,CCAICPTF(,CCAPTR)                               0298
         AL    @01,@CF01807                                        0298
         L     @01,ICTPCHN-64(@15,@01)                             0298
         AL    @01,@CF01808                                        0298
         L     @08,ICTIXP(@08,@01)                                 0298
         MVC   UPDTENAM(8),ICTMNAME(@08)                           0298
*   IF ICTMSSI(1,1)^=BLANK          /* IF SSI SPECIFIED      @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CLC   ICTMSSI(1,@08),BLANK                                0299
         BE    @RF00299                                            0299
*     DO;                           /*                       @Z67SP00*/
*       SSINUM=ICTMSSI(1);          /*                       @Z67SP00*/
         MVC   SSINUM(8),ICTMSSI(@08)                              0301
*       UPDFLD1=UPDSSI;             /*                       @Z67SP00*/
         MVC   UPDFLD1(13),UPDSSI                                  0302
*       UPDFLD2=UPDMBR;             /*                       @Z67SP00*/
         MVC   UPDFLD2(13),UPDMBR                                  0303
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /* NO SSI, NAME ONLY     @Z67SP00*/
*     DO;                           /*                       @Z67SP00*/
         B     @RC00299                                            0305
@RF00299 DS    0H                                                  0306
*       UPDFLD1=UPDMBR;             /* NAME= ONTO STMT       @Z67SP00*/
         MVC   UPDFLD1(13),UPDMBR                                  0306
*       UPDFLD2='';                 /* BLANK OUT SECOND PART @Z67SP00*/
         MVI   UPDFLD2,C' '                                        0307
         MVC   UPDFLD2+1(12),UPDFLD2                               0307
*     END;                          /*                       @Z67SP00*/
*   IOPBUFAD=ADDR(UPDTECRD);        /* POINT TO UPDTE CARD FOR I/O   */
@RC00299 L     @08,IOPPTR                                          0309
         LA    @15,UPDTECRD                                        0309
         ST    @15,IOPBUFAD(,@08)                                  0309
*   IOPFUNCT=IOPWRITE;              /* I/O WRITE FUNCTION            */
         MVI   IOPFUNCT(@08),X'51'                                 0310
*   IOPDSID=IOPSCR1;                /* DATA SET SYSUT1               */
         MVI   IOPDSID(@08),X'03'                                  0311
*   CALL HMASMIO(HMASMIOP);         /* WRITE UPDTE CONTROL TO SYSUT1 */
         ST    @08,@AL00001                                        0312
         L     @15,@CV01712                                        0312
         LA    @01,@AL00001                                        0312
         BALR  @14,@15                                             0312
*   IOPBUFAD=BUFFSAVE;              /* RESTORE I/O BUFFER ADDRESS    */
         L     @08,IOPPTR                                          0313
         MVC   IOPBUFAD(4,@08),BUFFSAVE                            0313
*   IF IOPRETRN>IOPGOOD             /* CHECK RETURN FROM I/O         */
*     THEN                          /*                               */
         CLI   IOPRETRN(@08),0                                     0314
         BNH   @RF00314                                            0314
*     DO;                           /* SYSUT1 WRITE ERROR            */
*       ICTMNOGO(1)=ON;             /* MARK ELEMENT NOGO             */
         L     @15,J                                               0316
         SLA   @15,2                                               0316
         L     @14,I                                               0316
         MH    @14,@CH01799                                        0316
         L     @01,CCAICPTF(,CCAPTR)                               0316
         AL    @01,@CF01807                                        0316
         L     @01,ICTPCHN-64(@14,@01)                             0316
         AL    @01,@CF01808                                        0316
         L     @01,ICTIXP(@15,@01)                                 0316
         OI    ICTMNOGO(@01),B'01000000'                           0316
*       UPIERROR=ON;                /* PROCESSING ERROR      @Z67SP00*/
         OI    UPIERROR,B'10000000'                                0317
*       HIGHUPI=MAX(HIGHUPI,IOPRETRN);/* UPDATE RETURN CODE          */
         SLR   @15,@15                                             0318
         IC    @15,HIGHUPI                                         0318
         SLR   @14,@14                                             0318
         IC    @14,IOPRETRN(,@08)                                  0318
         CR    @15,@14                                             0318
         BNL   *+6
         LR    @15,@14                                             0318
         STC   @15,HIGHUPI                                         0318
*     END;                          /*                               */
*   ELSE                            /*                               */
*     IF ICTMALIS(1)=ON             /* ---ALIASES PRESENT    @Z67SP00*/
*       THEN                        /* THEN                          */
         B     @RC00314                                            0320
@RF00314 L     @08,J                                               0320
         SLA   @08,2                                               0320
         L     @15,I                                               0320
         MH    @15,@CH01799                                        0320
         L     @01,CCAICPTF(,CCAPTR)                               0320
         AL    @01,@CF01807                                        0320
         L     @01,ICTPCHN-64(@15,@01)                             0320
         AL    @01,@CF01808                                        0320
         L     @08,ICTIXP(@08,@01)                                 0320
         TM    ICTMALIS(@08),B'00000100'                           0320
         BNO   @RF00320                                            0320
*       CALL WRITEALI;              /* --ALIASES TO SYSUT1           */
         BAL   @14,WRITEALI                                        0321
*   IOPFUNCT=IOPCLOSE;              /* I/O FUNCTION IS CLOSE         */
@RF00320 DS    0H                                                  0322
@RC00314 L     @08,IOPPTR                                          0322
         MVI   IOPFUNCT(@08),X'50'                                 0322
*   IOPDSID=IOPSCR1;                /* DATA SET IS SYSUT1            */
         MVI   IOPDSID(@08),X'03'                                  0323
*   CALL HMASMIO(HMASMIOP);         /* ENSURE SYSUT1 IS CLOSED       */
         ST    @08,@AL00001                                        0324
         L     @15,@CV01712                                        0324
         LA    @01,@AL00001                                        0324
         BALR  @14,@15                                             0324
*   IF IOPRETRN>IOPGOOD             /* CHECK RETURN FROM I/O         */
*     THEN                          /* IF SYSUT1 CLOSE ERROR--       */
         L     @08,IOPPTR                                          0325
         CLI   IOPRETRN(@08),0                                     0325
         BNH   @RF00325                                            0325
*     DO;                           /* ---THEN----                   */
*       ICTMNOGO(1)=ON;             /* MARK ELEMENT NOGO             */
         L     @15,J                                               0327
         SLA   @15,2                                               0327
         L     @14,I                                               0327
         MH    @14,@CH01799                                        0327
         L     @01,CCAICPTF(,CCAPTR)                               0327
         AL    @01,@CF01807                                        0327
         L     @01,ICTPCHN-64(@14,@01)                             0327
         AL    @01,@CF01808                                        0327
         L     @01,ICTIXP(@15,@01)                                 0327
         OI    ICTMNOGO(@01),B'01000000'                           0327
*       UPIERROR=ON;                /* PROCESSING ERROR      @Z67SP00*/
         OI    UPIERROR,B'10000000'                                0328
*       HIGHUPI=MAX(HIGHUPI,IOPRETRN);/* UPDATE RETURN CODE          */
         SLR   @15,@15                                             0329
         IC    @15,HIGHUPI                                         0329
         SLR   @14,@14                                             0329
         IC    @14,IOPRETRN(,@08)                                  0329
         CR    @15,@14                                             0329
         BNL   *+6
         LR    @15,@14                                             0329
         STC   @15,HIGHUPI                                         0329
*     END;                          /*                               */
*   RETURN CODE(HIGHUPI);           /* RETURN HIGHEST RET. CODE      */
@RF00325 SLR   @15,@15                                             0331
         IC    @15,HIGHUPI                                         0331
         L     @14,@SA00004                                        0331
         LM    @00,@12,@SA00004+8                                  0331
         BR    @14                                                 0331
*   END UT1SYSIN;                   /* END UT1SYSIN SEGMENT          */
         EJECT
*WRITEALI:                                                         0333
*   PROC;                           /*                       @Z67SP00*/
*                                                                  0333
WRITEALI STM   @14,@12,@SA00005                                    0333
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITEALI SEGMENT -- THIS ROUTINE THEN WRITES THE ALIASES TO   */
*   /* SYSUT1 AS ./ ALIAS IEBUPDTE STATEMENTS. THE RETRUN PASSES BACK*/
*   /* THE HIGHEST RETURN CODE ENCOUNTERED, AND A SWITCH INDICATING  */
*   /* ANY ERROR.                                            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0334
*   RFY                                                            0334
*     ICTPTF BASED(CCAICPTF);       /* SET UP ICT ADDRESSABILITY     */
*   RFY                                                            0335
*     ICTIXPF BASED(ICTPCHN(I));    /* PTF TO MOD CHAIN              */
*   RFY                                                            0336
*     ICTMOD BASED(ICTIXP(J));      /* MOD BASED ON PTF PTR          */
*   RFY                                                            0337
*     ICTTALLS BASED(ICTMTCHN(1));  /* ELEMENT ALIAS LIST    @Z67SP00*/
*   UPDFLD1='';                     /* INIT FILEDS IN RECORD @Z67SP00*/
         MVI   UPDFLD1,C' '                                        0338
         MVC   UPDFLD1+1(12),UPDFLD1                               0338
*   UPDFLD2='';                     /* INIT FILEDS IN RECORD @Z67SP00*/
         MVI   UPDFLD2,C' '                                        0339
         MVC   UPDFLD2+1(12),UPDFLD2                               0339
*   IOPDSID=IOPSCR1;                /* SET I/O DS TO SYSUT1          */
         L     @08,IOPPTR                                          0340
         MVI   IOPDSID(@08),X'03'                                  0340
*   IOPNAME=ICTMNAME(1);            /* SET MEMBER AS ELEMENT NAME    */
         L     @15,J                                               0341
         SLA   @15,2                                               0341
         L     @14,I                                               0341
         MH    @14,@CH01799                                        0341
         L     @01,CCAICPTF(,CCAPTR)                               0341
         AL    @01,@CF01807                                        0341
         L     @01,ICTPCHN-64(@14,@01)                             0341
         AL    @01,@CF01808                                        0341
         L     @01,ICTIXP(@15,@01)                                 0341
         MVC   IOPNAME(8,@08),ICTMNAME(@01)                        0341
*   IOPFUNCT=IOPWRITE;              /* SET I/O FUNCTION TO WRITE     */
         MVI   IOPFUNCT(@08),X'51'                                 0342
*   IOPBUFAD=ADDR(UPDTECRD);        /* SET BFR ADDR TO UPDTE CARD    */
         LA    @15,UPDTECRD                                        0343
         ST    @15,IOPBUFAD(,@08)                                  0343
*   IOPRETRN=IOPGOOD;               /* INIT RETURN CODE      @Z67SP00*/
         MVI   IOPRETRN(@08),X'00'                                 0344
*   UPDTEFUN=UPDTEALI;              /* SET UPDTE CNTL CRD TO ALIAS   */
         MVC   UPDTEFUN(6),UPDTEALI                                0345
*   DO L=1 BY 1 WHILE(              /* LOOP THROUGH ALIAS    @Z67SP00*/
*         ICTTALND(L)^=ICTENDIX     /* TILL END              @Z67SP00*/
*         &IOPRETRN=IOPGOOD);       /* OR ERROR              @Z67SP00*/
         LA    @08,1                                               0346
         ST    @08,L                                               0346
         B     @DE00346                                            0346
@DL00346 DS    0H                                                  0347
*     UPDTENAM=ICTTALNM(L);         /* SET ALIAS NAME        @Z67SP00*/
         L     @08,L                                               0347
         SLA   @08,3                                               0347
         L     @15,J                                               0347
         SLA   @15,2                                               0347
         L     @14,I                                               0347
         MH    @14,@CH01799                                        0347
         L     @01,CCAICPTF(,CCAPTR)                               0347
         AL    @01,@CF01807                                        0347
         L     @01,ICTPCHN-64(@14,@01)                             0347
         AL    @01,@CF01808                                        0347
         L     @01,ICTIXP(@15,@01)                                 0347
         L     @01,ICTMTCHN(,@01)                                  0347
         ALR   @01,@08                                             0347
         AL    @01,@CF01813                                        0347
         MVC   UPDTENAM(8),ICTTALNM(@01)                           0347
*     UPDFLD1=UPDMBR;               /* MOVE ALIAS AND MEMBER @Z67SP00*/
         MVC   UPDFLD1(13),UPDMBR                                  0348
*     CALL HMASMIO(HMASMIOP);       /* CALL I/O TO WRITE ALIASES TO
*                                      OUTPUT DATA SET               */
         L     @08,IOPPTR                                          0349
         ST    @08,@AL00001                                        0349
         L     @15,@CV01712                                        0349
         LA    @01,@AL00001                                        0349
         BALR  @14,@15                                             0349
*   END;                            /* END OF ALIAS WRITE LOOP       */
         LA    @08,1                                               0350
         AL    @08,L                                               0350
         ST    @08,L                                               0350
@DE00346 L     @08,L                                               0350
         SLA   @08,3                                               0350
         L     @15,J                                               0350
         SLA   @15,2                                               0350
         L     @14,I                                               0350
         MH    @14,@CH01799                                        0350
         L     @01,CCAICPTF(,CCAPTR)                               0350
         AL    @01,@CF01807                                        0350
         L     @01,ICTPCHN-64(@14,@01)                             0350
         AL    @01,@CF01808                                        0350
         L     @01,ICTIXP(@15,@01)                                 0350
         L     @01,ICTMTCHN(,@01)                                  0350
         AL    @01,@CF01813                                        0350
         L     @08,ICTTALND(@08,@01)                               0350
         CL    @08,ICTENDIX                                        0350
         BE    @DC00346                                            0350
         L     @08,IOPPTR                                          0350
         CLI   IOPRETRN(@08),0                                     0350
         BE    @DL00346                                            0350
@DC00346 DS    0H                                                  0351
*   IF IOPRETRN^=IOPGOOD            /* CHECK I/O RETURN              */
*     THEN                                                         0351
         L     @08,IOPPTR                                          0351
         CLI   IOPRETRN(@08),0                                     0351
         BE    @RF00351                                            0351
*     DO;                           /* IF I/O ERROR THEN --          */
*       ICTMNOGO(1)=ON;             /* SET ELEMENT NOGO              */
         L     @08,J                                               0353
         SLA   @08,2                                               0353
         L     @15,I                                               0353
         MH    @15,@CH01799                                        0353
         L     @01,CCAICPTF(,CCAPTR)                               0353
         AL    @01,@CF01807                                        0353
         L     @01,ICTPCHN-64(@15,@01)                             0353
         AL    @01,@CF01808                                        0353
         L     @08,ICTIXP(@08,@01)                                 0353
         OI    ICTMNOGO(@08),B'01000000'                           0353
*       UPIERROR=ON;                /* PROCESSING ERROR      @Z67SP00*/
         OI    UPIERROR,B'10000000'                                0354
*       HIGHUPI=STOPSMP;            /* UPDATE UPI RETURN TO STOPSMP  */
         MVI   HIGHUPI,X'10'                                       0355
*     END;                                                         0356
*   IOPBUFAD=BUFFSAVE;              /* RESTORE I/O BFR ADDR          */
@RF00351 L     @08,IOPPTR                                          0357
         MVC   IOPBUFAD(4,@08),BUFFSAVE                            0357
*   END WRITEALI;                   /* END WRITEALI SEGMENT          */
@EL00005 DS    0H                                                  0358
@EF00005 DS    0H                                                  0358
@ER00005 LM    @14,@12,@SA00005                                    0358
         BR    @14                                                 0358
         EJECT
*UPDATE:                                                           0359
*   PROCEDURE;                      /* EXECUPDT SEGMENT              */
*                                                                  0359
UPDATE   STM   @14,@12,@SA00006                                    0359
*   /*****************************************************************/
*   /*                                                               */
*   /* EXECUPDT SEGMENT -- THIS ROUTINE INVOKES IEBUPDTE FOR UPDATING*/
*   /* MACRO OR SOURCE LIBRARIES. SYSIN DD HAS BEEN SET BY PREVIOUS  */
*   /* ROUTINES, SYSUT1 AND SYSUT2 DDS ARE SET FROM THE ICT. THE     */
*   /* IEBUPDTE RETURN CODE IS PRINTED. IF SMPWRK1 WAS SET AS SYSIN, */
*   /* THIS SYSIN DD'S JFCB IS MODIFIED TO REFLECT BACK TO A PDS. THE*/
*   /* RETURN PASSES BACK A RETURN CODE BASED ON IEBUPDTE RETURN     */
*   /* BELOW, EQUAL TO, OR ABOVE THRESHOLD OR A MORE SEVERE ERROR.   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0360
*   DECLARE                                                        0360
*     P FIXED(8);                   /* LOOP CONTROL          @Z67SP00*/
*   DECLARE                         /*                       @Z67SP00*/
*     UPDX FIXED(31);               /* ICT LOOP INDEX        @Z67SP00*/
*   RFY                                                            0362
*     ICTPTF BASED(CCAICPTF);       /* SET UP ICT ADDRESSABILITY     */
*   RFY                                                            0363
*     ICTIXPF BASED(ICTPCHN(I));    /* PTF TO MOD CHAIN              */
*   RFY                                                            0364
*     ICTMOD BASED(ICTIXP(J));      /* MOD BASED ON PTF PTR          */
*                                                                  0364
*   /*****************************************************************/
*   /*                                                               */
*   /* SPECIAL MTS OR STS PROCESSING FIRST.                  @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0365
*   IF ICTTOLIB(1)=SMPMTS×          /* IF TOLIB IS SMPMTS            */
*       ICTTOLIB(1)=SMPSTS          /* OR TOLIB IS SMPSTS            */
*     THEN                          /* THEN ----                     */
         L     @08,J                                               0365
         SLA   @08,2                                               0365
         L     @15,I                                               0365
         MH    @15,@CH01799                                        0365
         L     @01,CCAICPTF(,CCAPTR)                               0365
         AL    @01,@CF01807                                        0365
         L     @01,ICTPCHN-64(@15,@01)                             0365
         AL    @01,@CF01808                                        0365
         L     @08,ICTIXP(@08,@01)                                 0365
         CLC   ICTTOLIB(8,@08),SMPMTS                              0365
         BE    @RT00365                                            0365
         CLC   ICTTOLIB(8,@08),SMPSTS                              0365
         BNE   @RF00365                                            0365
@RT00365 DS    0H                                                  0366
*     DO;                           /* MUST CLOSE B4 UPDTE           */
*       IOPFUNCT=IOPCLOSE;          /* SET I/O FUNC. TO CLS.         */
         L     @08,IOPPTR                                          0367
         MVI   IOPFUNCT(@08),X'50'                                 0367
*       IF ICTTOLIB(1)=SMPMTS       /* IF TOLIB IS MTS               */
*         THEN                      /* THEN ---                      */
         L     @15,J                                               0368
         SLA   @15,2                                               0368
         L     @14,I                                               0368
         MH    @14,@CH01799                                        0368
         L     @01,CCAICPTF(,CCAPTR)                               0368
         AL    @01,@CF01807                                        0368
         L     @01,ICTPCHN-64(@14,@01)                             0368
         AL    @01,@CF01808                                        0368
         L     @01,ICTIXP(@15,@01)                                 0368
         CLC   ICTTOLIB(8,@01),SMPMTS                              0368
         BNE   @RF00368                                            0368
*         IOPDSID=IOPMTS;           /* SET I/O DS. TO MTS            */
         MVI   IOPDSID(@08),X'12'                                  0369
*       ELSE                        /* ELSE MUST BE STS              */
*         IOPDSID=IOPSTS;           /* SET I/O DS TO STS             */
         B     @RC00368                                            0370
@RF00368 L     @08,IOPPTR                                          0370
         MVI   IOPDSID(@08),X'1A'                                  0370
*       CALL HMASMIO(HMASMIOP);     /* CALL I/O FOR CLOSE            */
@RC00368 L     @08,IOPPTR                                          0371
         ST    @08,@AL00001                                        0371
         L     @15,@CV01712                                        0371
         LA    @01,@AL00001                                        0371
         BALR  @14,@15                                             0371
*       IF IOPRETRN^=IOPGOOD        /* CHECK I/O RETURN              */
*         THEN                      /* IF I/O ERROR                  */
         L     @08,IOPPTR                                          0372
         CLI   IOPRETRN(@08),0                                     0372
         BE    @RF00372                                            0372
*         DO;                       /* THEN ---                      */
*           ICTMNOGO(1)=ON;         /* MARK ELEMENT NOGO             */
         L     @15,J                                               0374
         SLA   @15,2                                               0374
         L     @14,I                                               0374
         MH    @14,@CH01799                                        0374
         L     @01,CCAICPTF(,CCAPTR)                               0374
         AL    @01,@CF01807                                        0374
         L     @01,ICTPCHN-64(@14,@01)                             0374
         AL    @01,@CF01808                                        0374
         L     @01,ICTIXP(@15,@01)                                 0374
         OI    ICTMNOGO(@01),B'01000000'                           0374
*           UPIERROR=ON;            /* PROCESSING ERROR      @Z67SP00*/
         OI    UPIERROR,B'10000000'                                0375
*           HIGHUPI=MAX(HIGHUPI,IOPRETRN);/* UPDATE UPI R.C.         */
         SLR   @15,@15                                             0376
         IC    @15,HIGHUPI                                         0376
         SLR   @14,@14                                             0376
         IC    @14,IOPRETRN(,@08)                                  0376
         CR    @15,@14                                             0376
         BNL   *+6
         LR    @15,@14                                             0376
         STC   @15,HIGHUPI                                         0376
*         END;                      /*                               */
*     END;                          /*                               */
@RF00372 DS    0H                                                  0379
*   IF UPIERROR=OFF                 /* IF OK                 @Z67SP00*/
*     THEN                          /* THEN ----                     */
@RF00365 TM    UPIERROR,B'10000000'                                0379
         BNZ   @RF00379                                            0379
*     DO;                           /* PROCEED WITH IEBUPDTE         */
*       UPSYSUT1=ICTFMLIB(1);       /* SET IEBUPDTE INPUT DD         */
         L     @08,J                                               0381
         SLA   @08,2                                               0381
         L     @15,I                                               0381
         MH    @15,@CH01799                                        0381
         L     @01,CCAICPTF(,CCAPTR)                               0381
         AL    @01,@CF01807                                        0381
         L     @01,ICTPCHN-64(@15,@01)                             0381
         AL    @01,@CF01808                                        0381
         L     @08,ICTIXP(@08,@01)                                 0381
         MVC   UPSYSUT1(8),ICTFMLIB(@08)                           0381
*       UPSYSUT2=ICTTOLIB(1);       /* SET IEBUPDTE OUTPUT DD        */
         MVC   UPSYSUT2(8),ICTTOLIB(@08)                           0382
*       RFY                         /* SYSIN DD & PARM PREVIOUSLY SET*/
*         UPDTEREG RSTD;            /*                               */
*                                                                  0383
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP PARMS FOR IEBUPDTE LINK                    @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0384
*       SYSPRINT=CCAUPDSP;          /* SYSPRINT DD           @Z67SP00*/
         L     @08,CCABLDLP(,CCAPTR)                               0384
         MVC   SYSPRINT(8),CCAUPDSP(@08)                           0384
*       IF CCAUPDPM(1)^=BLANK THEN  /* GET CCA PARMS         @Z67SP00*/
         CLC   CCAUPDPM(1,@08),BLANK                               0385
         BE    @RF00385                                            0385
*         DO;                       /*                       @Z67SP00*/
*           UPPARM(UPDOPT)=COMMA;   /* DELIMITER             @Z67SP00*/
         LH    @08,UPDOPT                                          0387
         LA    @04,UPPARM-1(@08)                                   0387
         MVI   0(@04),C','                                         0387
*           UPDOPT=UPDOPT+1;        /* BUMP PARM LENGTH      @Z67SP00*/
         LA    @04,1                                               0388
         ALR   @08,@04                                             0388
         STH   @08,UPDOPT                                          0388
*           DO P=1 BY 1 WHILE CCAUPDPM(P)^=BLANK;/* PARMS    @Z67SP00*/
         STC   @04,P                                               0389
         B     @DE00389                                            0389
@DL00389 DS    0H                                                  0390
*             UPDOPT=UPDOPT+1;      /* BUMP PARM LENGTH      @Z67SP00*/
         LA    @08,1                                               0390
         AH    @08,UPDOPT                                          0390
         STH   @08,UPDOPT                                          0390
*             UPPARM(UPDOPT)=CCAUPDPM(P);/* MOVE IT          @Z67SP00*/
         LA    @04,UPPARM-1(@08)                                   0391
         SLR   @08,@08                                             0391
         IC    @08,P                                               0391
         L     @01,CCABLDLP(,CCAPTR)                               0391
         ALR   @01,@08                                             0391
         MVC   0(1,@04),CCAUPDPM-1(@01)                            0391
*           END;                    /*                       @Z67SP00*/
         AH    @08,@CH00086                                        0392
         LR    @04,@08                                             0392
         STC   @04,P                                               0392
@DE00389 SLR   @08,@08                                             0392
         IC    @08,P                                               0392
         L     @04,CCABLDLP(,CCAPTR)                               0392
         ALR   @04,@08                                             0392
         CLC   CCAUPDPM-1(1,@04),BLANK                             0392
         BNE   @DL00389                                            0392
*         END;                      /*                       @Z67SP00*/
*                                                                  0393
*       /*************************************************************/
*       /*                                                           */
*       /* STAE SETUP                                        @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0394
*       SAVRVANM=RVAEPRNM;          /* SAVE RVA PROC NM      @Z67SP00*/
@RF00385 L     @08,CCARVAD(,CCAPTR)                                0394
         MVC   SAVRVANM(8),RVAEPRNM(@08)                           0394
*       RVAEPRNM=CCAUPDNM;          /* GET UPDATE NM         @Z67SP00*/
*                                                                  0395
         L     @04,CCABLDLP(,CCAPTR)                               0395
         MVC   RVAEPRNM(8,@08),CCAUPDNM(@04)                       0395
*       /*************************************************************/
*       /*                                                           */
*       /* INVOKE UPDATE UTILITY                             @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0396
*       UPDTEREG=CCAUPDTE;          /* INIT. REG WITH CCA'S IEBUPDTE
*                                      BLDL ADDRESS.                 */
         L     UPDTEREG,CCAUPDTE(,@04)                             0396
*       GEN(LINK DE=(UPDTEREG),PARAM=(UPDOPT,UPDDNAME),VL=1)       0397
*       REFS(UPDTEREG,UPDOPT,UPDDNAME);/* INVOKE IEBUPDTE            */
         LINK DE=(UPDTEREG),PARAM=(UPDOPT,UPDDNAME),VL=1
*       RFY                         /*                               */
*         UPDTEREG UNRSTD;          /*                               */
*                                                                  0398
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK RETURN CODE AND ISSUE MESSAGE FOR PRIMARY SYSMOD    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0399
*       RFY                         /*                               */
*         RTNCODE RSTD;             /*                               */
*       RVAEPRNM=SAVRVANM;          /* RESET RVA NAME        @Z67SP00*/
         L     @14,CCARVAD(,CCAPTR)                                0400
         MVC   RVAEPRNM(8,@14),SAVRVANM                            0400
*       HEXNO=RTNCODE;              /* SAVE UPDTE RETURN CODE IN HEX */
         ST    RTNCODE,HEXNO                                       0401
*       RFY                         /*                               */
*         RTNCODE UNRSTD;           /*                               */
*       CVD(HEXNO,DECNO1);          /* CNVT UPDTE CODE TO PKD. DEC.  */
         L     @08,HEXNO                                           0403
         CVD   @08,DECNO1                                          0403
*       UNPK(BCDNO,DECNO(COLSTR:COLSTP));/* UNPACK UPDTE RETURN CODE */
         UNPK  BCDNO(5),DECNO+6(3)                                 0404
*       MGPTYPE=MGPINFO;            /* INIT TO INFO SEVERITY @ZD00001*/
         MVI   MGPTYPE,X'01'                                       0405
*       IF HEXNO>CCARUPDT           /* IF UPDTE RETURN > THRESHOLD   */
*         THEN                      /* THEN ---                      */
         L     @01,CCABLDLP(,CCAPTR)                               0406
         SLR   @00,@00                                             0406
         IC    @00,CCARUPDT(,@01)                                  0406
         CR    @08,@00                                             0406
         BNH   @RF00406                                            0406
*         DO;                       /* PTF WILL BE FLUSHED           */
*           UPIERROR=ON;            /* ERROR SW              @Z67SP00*/
         OI    UPIERROR,B'10000000'                                0408
*           MGPTYPE=MGPERR;         /* SET SEVERITY          @ZD00001*/
         MVI   MGPTYPE,X'03'                                       0409
*           ICTMNOGO(1)=ON;         /* MARK ELEMENT NOGO             */
         L     @08,J                                               0410
         SLA   @08,2                                               0410
         L     @15,I                                               0410
         MH    @15,@CH01799                                        0410
         L     @01,CCAICPTF(,CCAPTR)                               0410
         AL    @01,@CF01807                                        0410
         L     @01,ICTPCHN-64(@15,@01)                             0410
         AL    @01,@CF01808                                        0410
         L     @08,ICTIXP(@08,@01)                                 0410
         OI    ICTMNOGO(@08),B'01000000'                           0410
*           HIGHUPI=MAX(HIGHUPI,STOPPTF);/* SET RETURN TO STOPPTF(8) */
         SLR   @08,@08                                             0411
         IC    @08,HIGHUPI                                         0411
         LA    @15,8                                               0411
         CR    @08,@15                                             0411
         BNL   *+6
         LR    @08,@15                                             0411
         STC   @08,HIGHUPI                                         0411
*         END;                      /*                               */
*       ELSE                        /* IF UPDTE RETURN ^> THRESHOLD  */
*         DO;                       /* THEN---                       */
         B     @RC00406                                            0413
@RF00406 DS    0H                                                  0414
*           IF HEXNO^=ZEROS         /* IF UPDTE RETURN NOT ZERO      */
*             THEN                                                 0414
         ICM   @08,15,HEXNO                                        0414
         BZ    @RF00414                                            0414
*             DO;                   /* THEN---               @ZD00001*/
*               MGPTYPE=MGPWARN;    /* MESSAGE IS WARNING    @ZD00001*/
         MVI   MGPTYPE,X'02'                                       0416
*               HIGHUPI=MAX(HIGHUPI,WARNPTF);/* SET RETURN TO      0417
*                                      WARNPTF(4)                    */
         SLR   @08,@08                                             0417
         IC    @08,HIGHUPI                                         0417
         LA    @15,4                                               0417
         CR    @08,@15                                             0417
         BNL   *+6
         LR    @08,@15                                             0417
         STC   @08,HIGHUPI                                         0417
*             END;                  /* WARNING SEV AND RC SET@ZD00001*/
*         END;                      /*                               */
@RF00414 DS    0H                                                  0420
*       MGPCLEAR=MGPCLEAR&&MGPCLEAR;/* ZERO MESSAGE NUMBERS  @ZD00001*/
@RC00406 XC    MGPCLEAR(6),MGPCLEAR                                0420
*       MGPMGNO1=HMA216I;           /* SET UP UPDTE RETURN MESSAGE   */
         MVC   MGPMGNO1(2),@CH00445                                0421
*       MGPVARPT(2)=ADDR(ICTMNAME(1));/* INSERT ELEMENT NAME         */
         L     @08,J                                               0422
         SLA   @08,2                                               0422
         L     @15,I                                               0422
         MH    @15,@CH01799                                        0422
         L     @14,CCAICPTF(,CCAPTR)                               0422
         LA    @01,0(@15,@14)                                      0422
         AL    @01,@CF01807                                        0422
         L     @01,ICTPCHN-64(,@01)                                0422
         AL    @01,@CF01808                                        0422
         L     @08,ICTIXP(@08,@01)                                 0422
         ST    @08,MGPVARPT+4                                      0422
*       MGPVARPT(3)=ADDR(ICTTOLIB(1));/* INSERT LIBRARY NAME @ZD00001*/
         LA    @08,ICTTOLIB(,@08)                                  0423
         ST    @08,MGPVARPT+8                                      0423
*       MGPVARPT(4)=ADDR(ICTPTFS(I));/* INSERT PTF NUMBER    @Z67SP00*/
         AL    @14,@CF01809                                        0424
         LA    @08,ICTPTFS(@15,@14)                                0424
         ST    @08,MGPVARPT+12                                     0424
*       MGPVARPT(5)=ADDR(BCDCOL);   /* INSERT UPDTE RC       @Z67SP00*/
         LA    @08,BCDCOL                                          0425
         ST    @08,MGPVARPT+16                                     0425
*       IF HEXNO>CCARUPDT           /* IF UPDTE RETURN > THRESHOLD   */
*         THEN                      /* THEN ---                      */
         L     @08,CCABLDLP(,CCAPTR)                               0426
         L     @15,HEXNO                                           0426
         SLR   @14,@14                                             0426
         IC    @14,CCARUPDT(,@08)                                  0426
         CR    @15,@14                                             0426
         BNH   @RF00426                                            0426
*         MGPVARPT(1)=ADDR(UPDFAIL);/* --- INDICATE UPDTE FAILURE    */
         LA    @08,UPDFAIL                                         0427
         ST    @08,MGPVARPT                                        0427
*       ELSE                        /* ELSE ---                      */
*         MGPVARPT(1)=ADDR(UPDSUCC);/* --- INDICATE UPDTE SUCESSFUL  */
         B     @RC00426                                            0428
@RF00426 LA    @08,UPDSUCC                                         0428
         ST    @08,MGPVARPT                                        0428
*       CALL HMASMMSG(HMASMMGP);    /* WRITE IEBUPTE COMPLETE MSG.   */
*                                                                  0429
@RC00426 L     @15,@CV01715                                        0429
         LA    @01,@AL00429                                        0429
         BALR  @14,@15                                             0429
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE UPDATE WAS FOR A MACRO OR SOURCE UPDATE THEN ISSUE */
*       /* MESSAGE FOR ANY OTHER SYSMODS THAT WERE MERGED INTO THIS  */
*       /* ONE CALL                                          @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0430
*       IF ICTMMACU(1)=ON×ICTMSRCU(1)=ON/* IF MAC OR SRC UPDATE    0430
*                                                            @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         L     @08,J                                               0430
         SLA   @08,2                                               0430
         L     @15,I                                               0430
         MH    @15,@CH01799                                        0430
         L     @01,CCAICPTF(,CCAPTR)                               0430
         AL    @01,@CF01807                                        0430
         L     @01,ICTPCHN-64(@15,@01)                             0430
         AL    @01,@CF01808                                        0430
         L     @08,ICTIXP(@08,@01)                                 0430
         TM    ICTMMACU(@08),B'00000101'                           0430
         BZ    @RF00430                                            0430
*         DO;                       /*                       @Z67SP00*/
*           DO UPDX=1 BY 1 WHILE(   /* LOOP THRU ALL MODS    @Z67SP00*/
*                 CCAICMOD->ICTMEND(UPDX)^=ICTENDNT);/* TILL END   0432
*                                                            @Z67SP00*/
         LA    @08,1                                               0432
         ST    @08,UPDX                                            0432
         B     @DE00432                                            0432
@DL00432 DS    0H                                                  0433
*             IF CCAICMOD->ICTMNAME(UPDX)=ICTMNAME(1)/*      @Z67SP00*/
*                 &CCAICMOD->ICTMISEL(UPDX)=ON/*             @Z67SP00*/
*                 &((CCAICMOD->ICTMMACU(UPDX)=ON&ICTMMACU(1)=ON)/*   */
*                 ×(CCAICMOD->ICTMSRCU(UPDX)=ON&ICTMSRCU(1)=ON))/*   */
*                 &CCAICMOD->ICTPPTR(UPDX)->ICTPTFS(1)^=ICTPTFS(I)/* */
*               THEN                /*                       @Z67SP00*/
         L     @08,UPDX                                            0433
         MH    @08,@CH01800                                        0433
         L     @15,CCAICMOD(,CCAPTR)                               0433
         L     @14,J                                               0433
         SLA   @14,2                                               0433
         L     @07,I                                               0433
         MH    @07,@CH01799                                        0433
         L     @01,CCAICPTF(,CCAPTR)                               0433
         AL    @01,@CF01807                                        0433
         L     @01,ICTPCHN-64(@07,@01)                             0433
         AL    @01,@CF01808                                        0433
         L     @14,ICTIXP(@14,@01)                                 0433
         ST    @08,@TF00001                                        0433
         ALR   @08,@15                                             0433
         AL    @08,@CF01814                                        0433
         CLC   ICTMNAME(8,@08),ICTMNAME(@14)                       0433
         BNE   @RF00433                                            0433
         LR    @08,@15                                             0433
         AL    @08,@TF00001                                        0433
         AL    @08,@CF01815                                        0433
         TM    ICTMISEL-11(@08),B'10000000'                        0433
         BNO   @RF00433                                            0433
         AL    @15,@TF00001                                        0433
         AL    @15,@CF01816                                        0433
         TM    ICTMMACU-9(@15),B'00000100'                         0433
         BNO   @GL00014                                            0433
         TM    ICTMMACU(@14),B'00000100'                           0433
         BO    @GL00011                                            0433
@GL00014 L     @08,UPDX                                            0433
         MH    @08,@CH01800                                        0433
         L     @01,CCAICMOD(,CCAPTR)                               0433
         ALR   @01,@08                                             0433
         AL    @01,@CF01816                                        0433
         TM    ICTMSRCU-9(@01),B'00000001'                         0433
         BNO   @RF00433                                            0433
         L     @08,J                                               0433
         SLA   @08,2                                               0433
         L     @15,I                                               0433
         MH    @15,@CH01799                                        0433
         L     @01,CCAICPTF(,CCAPTR)                               0433
         AL    @01,@CF01807                                        0433
         L     @01,ICTPCHN-64(@15,@01)                             0433
         AL    @01,@CF01808                                        0433
         L     @08,ICTIXP(@08,@01)                                 0433
         TM    ICTMSRCU(@08),B'00000001'                           0433
         BNO   @RF00433                                            0433
@GL00011 L     @08,UPDX                                            0433
         MH    @08,@CH01800                                        0433
         L     @01,CCAICMOD(,CCAPTR)                               0433
         AL    @01,@CF01817                                        0433
         L     @08,ICTPPTR-96(@08,@01)                             0433
         L     @15,I                                               0433
         MH    @15,@CH01799                                        0433
         L     @01,CCAICPTF(,CCAPTR)                               0433
         ALR   @01,@15                                             0433
         AL    @01,@CF01809                                        0433
         CLC   ICTPTFS(7,@08),ICTPTFS(@01)                         0433
         BE    @RF00433                                            0433
*               DO;                 /*                       @Z67SP00*/
*                                                                  0434
*                 /***************************************************/
*                 /*                                                 */
*                 /* MATCHING NAME AND TYPE ... ISSUE HMA216 @Z67SP00*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0435
*                 MGPVARPT(4)=ADDR(CCAICMOD->ICTPPTR(UPDX)->ICTPTFS(1))
*                     ;             /* PUT SYSMOD NUMBER IN  @Z67SP00*/
         ST    @08,MGPVARPT+12                                     0435
*                 CALL HMASMMSG(HMASMMGP);/* WRITE MSG       @Z67SP00*/
         L     @15,@CV01715                                        0436
         LA    @01,@AL00436                                        0436
         BALR  @14,@15                                             0436
*               END;                /*                       @Z67SP00*/
*           END;                    /*                       @Z67SP00*/
@RF00433 LA    @08,1                                               0438
         AL    @08,UPDX                                            0438
         ST    @08,UPDX                                            0438
@DE00432 L     @08,UPDX                                            0438
         MH    @08,@CH01800                                        0438
         L     @01,CCAICMOD(,CCAPTR)                               0438
         AL    @01,@CF01814                                        0438
         L     @08,ICTMEND(@08,@01)                                0438
         CL    @08,ICTENDNT                                        0438
         BNE   @DL00432                                            0438
*         END;                      /*                       @Z67SP00*/
*       RFY                                                        0440
*         ICTIXPF BASED(ICTPCHN(I));/*                       @ZD00005*/
@RF00430 DS    0H                                                  0441
*       IF UPSYSIN=SMPWRK1×         /* SYSIN ON WRKX THEN    @Z67SP00*/
*           UPSYSIN=SMPWRK2         /*                       @Z67SP00*/
*         THEN                      /*                               */
         CLC   UPSYSIN(8),SMPWRK1                                  0441
         BE    @RT00441                                            0441
         CLC   UPSYSIN(8),SMPWRK2                                  0441
         BNE   @RF00441                                            0441
@RT00441 DS    0H                                                  0442
*         DO;                       /* THEN RESET UCS OR PTS TO PDS  */
*           IOPDDNAM=UPSYSIN;       /* SET DD TO UCS OR PTS          */
         L     @08,IOPPTR                                          0443
         MVC   IOPDDNAM(8,@08),UPSYSIN                             0443
*           IOPDSID=IOPJFCB;        /* SET DSID TO MODIFY JFCB       */
         MVI   IOPDSID(@08),X'19'                                  0444
*           IOPFUNCT=IOPJFCBP;      /* REQUEST MODIFY JFCB TO PDS    */
         MVI   IOPFUNCT(@08),X'06'                                 0445
*           CALL HMASMIO(HMASMIOP); /* CALL I/O FOR JFCB MODIFY      */
         ST    @08,@AL00001                                        0446
         L     @15,@CV01712                                        0446
         LA    @01,@AL00001                                        0446
         BALR  @14,@15                                             0446
*           IF IOPRETRN^=IOPGOOD    /* CHECK I/O RETURN              */
*             THEN                  /*                               */
         L     @08,IOPPTR                                          0447
         CLI   IOPRETRN(@08),0                                     0447
         BE    @RF00447                                            0447
*             DO;                   /* IF JFCB MODIFY ERROR          */
*               ICTMNOGO(1)=ON;     /* SET ELEMENT NOGO              */
         L     @15,J                                               0449
         SLA   @15,2                                               0449
         L     @14,I                                               0449
         MH    @14,@CH01799                                        0449
         L     @01,CCAICPTF(,CCAPTR)                               0449
         AL    @01,@CF01807                                        0449
         L     @01,ICTPCHN-64(@14,@01)                             0449
         AL    @01,@CF01808                                        0449
         L     @01,ICTIXP(@15,@01)                                 0449
         OI    ICTMNOGO(@01),B'01000000'                           0449
*               HIGHUPI=MAX(HIGHUPI,IOPRETRN);/* UPDATE UPI RTNCD    */
         SLR   @15,@15                                             0450
         IC    @15,HIGHUPI                                         0450
         SLR   @14,@14                                             0450
         IC    @14,IOPRETRN(,@08)                                  0450
         CR    @15,@14                                             0450
         BNL   *+6
         LR    @15,@14                                             0450
         STC   @15,HIGHUPI                                         0450
*             END;                  /*                               */
*         END;                      /*                               */
*     END;                          /* END OF UPDTE PROCESS          */
*   END UPDATE;                     /* END SEGMENT                   */
@EL00006 DS    0H                                                  0454
@EF00006 DS    0H                                                  0454
@ER00006 LM    @14,@12,@SA00006                                    0454
         BR    @14                                                 0454
         EJECT
*   END HMASMUPI                    /* END OF HMASMUPI MODULE        */
*                                                                  0455
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*                                                                  0455
*       ;                                                          0455
@DATA    DS    0H
@CH00086 DC    H'1'
@CH00234 DC    H'3'
@CH00445 DC    H'17'
@CH01799 DC    H'116'
@CH01800 DC    H'144'
         DS    0F
@AL00212 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00245 DC    A(STATUS)               LIST WITH   1 ARGUMENT(S)
@AL00429 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00436 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@SA00004 DS    15F
@SA00006 DS    15F
@SA00005 DS    0F
@SA00003 DS    0F
         DS    15F
@AL00001 DS    2A
@TF00001 DS    F
         DS    0F
@CF01814 DC    F'-144'
@CF01816 DC    F'-135'
@CF01815 DC    F'-133'
@CF01809 DC    F'-116'
@CF01811 DC    F'-108'
@CF01805 DC    F'-102'
@CF01807 DC    F'-52'
@CF01817 DC    F'-48'
@CF01813 DC    F'-8'
@CF01808 DC    F'-4'
@CV01712 DC    V(HMASMIO)
@CV01713 DC    V(HMASMSEC)
@CV01714 DC    V(HMASMCPL)
@CV01715 DC    V(HMASMMSG)
         DS    0D
IOPPTR   DS    A
BUFFSAVE DS    A
I        DS    A
J        DS    A
L        DS    A
HEXNO    DS    F
UPDX     DS    F
HIGHUPI  DC    AL1(0)
P        DS    FL1
         DS    CL2
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL36
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00225 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00226 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL24
         ORG   MGPVAR
MGPVARPT DS    6A
         ORG   HMASMMGP+36
SAVRVANM DS    CL8
DECNO    DS    CL9
         ORG   DECNO
DECNO1   DS    CL8
@NM00230 DS    CL1
         ORG   DECNO+9
         DS    CL3
BCDNO    DS    CL5
         ORG   BCDNO
@NM00231 DS    CL1
BCDCOL   DS    CL2
@NM00232 DS    CL2
         ORG   BCDNO+5
SWITCHG1 DS    BL1
         ORG   SWITCHG1
UPIERROR DS    BL1
@NM00233 EQU   SWITCHG1+0
         ORG   SWITCHG1+1
STATUS   DS    CL1
BLANK    DC    CL1' '
SMPWRK1  DC    CL8'SMPWRK1 '
SMPWRK2  DC    CL8'SMPWRK2 '
SMPMTS   DC    CL8'SMPMTS  '
SMPSTS   DC    CL8'SMPSTS  '
SYSUT1   DC    CL8'SYSUT1  '
MODPARM  DC    CL3'MOD'
UPDTECRD DS    CL80
         ORG   UPDTECRD
UPDTESMP DC    CL6'./SMP '
UPDTEFUN DS    CL6
UPDFLD1  DS    CL13
UPDFLD2  DS    CL13
@NM00234 DC    CL42' '
         ORG   UPDTECRD+80
UPDTEREP DC    CL6'REPRO '
UPDTEALI DC    CL6'ALIAS '
UPDMBR   DS    CL13
         ORG   UPDMBR
@NM00235 DC    CL5'NAME='
UPDTENAM DS    CL8
         ORG   UPDMBR+13
UPDSSI   DS    CL13
         ORG   UPDSSI
@NM00236 DC    CL4'SSI='
SSINUM   DS    CL8
@NM00237 DC    CL1','
         ORG   UPDSSI+13
UPDFAIL  DC    CL10'FAILED    '
UPDSUCC  DC    CL10'SUCCESSFUL'
         DS    CL3
@NM00238 DS    CL76
         ORG   @NM00238
@NM00239 DS    CL2
UPDDNAME DC    H'72'
@NM00240 DC    X'0000000000000000'
@NM00241 DC    X'0000000000000000'
@NM00242 DC    X'0000000000000000'
@NM00243 DC    X'0000000000000000'
UPSYSIN  DC    CL8' '
SYSPRINT DS    CL8
@NM00244 DC    X'0000000000000000'
UPSYSUT1 DC    CL8' '
UPSYSUT2 DC    CL8' '
         ORG   @NM00238+76
@NM00245 DS    CL95
         ORG   @NM00245
@NM00246 DS    CL2
UPDOPT   DS    FL2
UPPARM   DC    CL91' '
         ORG   @NM00245+95
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCAPTR   EQU   @11
UPDTEREG EQU   @05
RTNCODE  EQU   @15
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCARVAD  EQU   CCAFSTA
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00009 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00025 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00027 EQU   CCABLDLL
CCALKDRC EQU   @NM00027+20
@NM00029 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+744
CCAUPDNM EQU   @NM00039
CCAUPDTE EQU   @NM00039+8
CCAUPDSP EQU   @NM00039+12
CCAUPDRC EQU   @NM00039+20
CCARUPDT EQU   CCAUPDRC
CCAUPDPM EQU   @NM00039+24
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
@NM00043 EQU   HMASMIOP+12
@NM00044 EQU   @NM00043
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00154 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPEND  EQU   ICTPTFS
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTPCPL  EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPFLG8 EQU   ICTPTF+14
ICTPECPL EQU   ICTPFLG8
ICTPFLG9 EQU   ICTPTF+15
@NM00181 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTIXP   EQU   ICTIXPF
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTMOD   EQU   0
ICTMNAME EQU   ICTMOD
ICTMEND  EQU   ICTMNAME
ICTMFLG2 EQU   ICTMOD+8
ICTMPROC EQU   ICTMFLG2
ICTMNOGO EQU   ICTMFLG2
ICTMCPL  EQU   ICTMFLG2
ICTMFLG1 EQU   ICTMOD+9
ICTMMODR EQU   ICTMFLG1
ICTMMACR EQU   ICTMFLG1
ICTMMACU EQU   ICTMFLG1
ICTMSRCR EQU   ICTMFLG1
ICTMSRCU EQU   ICTMFLG1
ICTMFLG3 EQU   ICTMOD+10
ICTMALIS EQU   ICTMFLG3
ICTMFLG4 EQU   ICTMOD+11
ICTMISEL EQU   ICTMFLG4
ICTMIDEL EQU   ICTMFLG4
ICTMFLG5 EQU   ICTMOD+12
ICTMODF4 EQU   ICTMOD+13
ICTMLEP1 EQU   ICTMODF4
ICTMODF5 EQU   ICTMOD+14
ICTMLEP2 EQU   ICTMODF5
ICTMODF6 EQU   ICTMOD+15
ICTMLEP3 EQU   ICTMODF6
ICTMODF7 EQU   ICTMOD+16
ICTMLEP4 EQU   ICTMODF7
ICTMACF4 EQU   ICTMOD+17
ICTFMLIB EQU   ICTMOD+24
ICTTOLIB EQU   ICTMOD+32
ICTMSSI  EQU   ICTMOD+72
ICTPPTR  EQU   ICTMOD+96
ICTMCHN  EQU   ICTMOD+100
ICTMICHN EQU   ICTMOD+104
ICTMACHN EQU   ICTMOD+112
ICTMTCHN EQU   ICTMOD+116
ICTMVCHN EQU   ICTMOD+120
ICTMUCHN EQU   ICTMOD+124
ICTIXMF  EQU   0
ICTMIDLS EQU   0
ICTMID   EQU   ICTMIDLS
ICTMODID EQU   ICTMID
ICTMODST EQU   ICTMID+7
ICTASMLS EQU   0
ICTASMAD EQU   ICTASMLS
ICTTALLS EQU   0
ICTTALNM EQU   ICTTALLS
ICTTALND EQU   ICTTALNM
ICTMVRLS EQU   0
ICTMVRNT EQU   ICTMVRLS
ICTMVRNM EQU   ICTMVRNT
ICTMUMLS EQU   0
ICTMUMNT EQU   ICTMUMLS
ICTMUMNM EQU   ICTMUMNT
ICTLMOD  EQU   0
ICTLMNAM EQU   ICTLMOD
ICTLNAME EQU   ICTLMNAM
ICTLFLG4 EQU   ICTLMOD+8
ICTLFLG1 EQU   ICTLMOD+9
ICTLFLG5 EQU   ICTLMOD+10
ICTLFLG6 EQU   ICTLMOD+11
ICTLFLG7 EQU   ICTLMOD+12
ICTLFLG2 EQU   ICTLMOD+13
ICTLFLG3 EQU   ICTLMOD+14
ICTLCHN  EQU   ICTLMOD+34
ICTIXLF  EQU   0
RVAPARM  EQU   0
RVAINFO  EQU   RVAPARM
RVAPASS  EQU   RVAPARM+12
RVASTAE  EQU   RVAPARM+20
RVAEPRNM EQU   RVASTAE+4
@NM00227 EQU   RVASTAE+16
@NM00228 EQU   RVASTAE+20
RVAFLAGS EQU   RVASTAE+24
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00050 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00061 EQU   IOPUDATA
@NM00062 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00071 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00082 EQU   IOPSRCDR+1
@NM00084 EQU   @NM00082+7
@NM00088 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00092 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00098 EQU   IOPMODDR+1
@NM00100 EQU   @NM00098+7
@NM00104 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00108 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00119 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00126 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00135 EQU   IOPPTFFX
@NM00136 EQU   @NM00135
IOPPDTES EQU   IOPPTFFX+41
@NM00139 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00164 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00164
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00168 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00168
IOPBFTB1 EQU   IOPBFTB0
ICTENDNT EQU   ICTENDCH
ICTENDIX EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00170 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00169 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00167 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00166 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00165 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00163 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00162 EQU   IOPPTSFX+35
@NM00161 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00160 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00159 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00158 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00157 EQU   IOPQFMDR
@NM00153 EQU   IOPQSMDR
@NM00152 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00151 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00150 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00149 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00148 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00147 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00146 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00145 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00144 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00143 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00142 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00141 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00140 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00139+3
IOPRECD  EQU   @NM00139
@NM00138 EQU   IOPPTFFX+8
@NM00137 EQU   @NM00135+7
IOPPRELN EQU   @NM00136
@NM00134 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00133 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00132 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00131 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00130 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00129 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00128 EQU   @NM00126+7
@NM00127 EQU   @NM00126
@NM00125 EQU   IOPSYSDR+5
@NM00124 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00123 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00122 EQU   IOPDLBFX+8
@NM00121 EQU   @NM00119+7
@NM00120 EQU   @NM00119
@NM00118 EQU   IOPDLBDR+1
@NM00117 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00116 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00115 EQU   IOPMODFX+12
@NM00114 EQU   IOPMODF4
@NM00113 EQU   IOPMODF3
@NM00112 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00111 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00110 EQU   @NM00108+7
@NM00109 EQU   @NM00108
@NM00107 EQU   IOPMODDR+17
@NM00106 EQU   @NM00104+7
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00100
@NM00102 EQU   @NM00100
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00098
@NM00097 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00096 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00095 EQU   IOPSRCFX+8
@NM00094 EQU   @NM00092+7
@NM00093 EQU   @NM00092
@NM00091 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00090 EQU   @NM00088+7
@NM00089 EQU   @NM00088
@NM00087 EQU   @NM00084
@NM00086 EQU   @NM00084
@NM00085 EQU   @NM00084
@NM00083 EQU   @NM00082
@NM00081 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00080 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00079 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00078 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00077 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00076 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00075 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00073 EQU   @NM00071+7
@NM00072 EQU   @NM00071
@NM00070 EQU   IOPLMDDR+6
@NM00069 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00068 EQU   IOPLMDF4
@NM00067 EQU   IOPLMDF3
@NM00066 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00065 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00064 EQU   IOPLMDDR
@NM00063 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00062+4
IOPUSED  EQU   @NM00062
IOPTPSEQ EQU   @NM00061+8
IOPVLSER EQU   @NM00061+2
IOPBLKSI EQU   @NM00061
IOPCQMAX EQU   IOPCQMAP+12
@NM00060 EQU   IOPCQMAP+11
@NM00059 EQU   IOPCQMAP+8
@NM00058 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00057 EQU   IOPSCMAP+11
@NM00056 EQU   IOPSCMAP+8
@NM00055 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00054 EQU   IOPNTMAX+11
@NM00053 EQU   IOPNTMAX+8
@NM00052 EQU   IOPNTMAX
@NM00051 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00050+5
IOPIPTF3 EQU   @NM00050
RVAEND   EQU   RVASTAE+25
@NM00229 EQU   RVAFLAGS
RVASDWFD EQU   RVAFLAGS
RVAVS1   EQU   RVAFLAGS
RVAMVS   EQU   RVAFLAGS
RVAUSRCH EQU   @NM00228+2
RVASYSCH EQU   @NM00228
RVAUSRCD EQU   @NM00227+2
RVASYSCD EQU   @NM00227
RVAABNDC EQU   RVASTAE+12
RVASDWAP EQU   RVASTAE
RVAREC   EQU   RVAPASS+4
RVATBL   EQU   RVAPASS
RVAMAJNM EQU   RVAINFO+8
RVACCAP  EQU   RVAINFO+4
RVAHDR   EQU   RVAINFO
ICTIXL   EQU   ICTIXLF
@NM00224 EQU   ICTLMOD+38
ICTLTTR  EQU   ICTLMOD+31
ICTTG2   EQU   ICTLMOD+23
ICTTG1   EQU   ICTLMOD+15
@NM00223 EQU   ICTLFLG3
ICTLZAP  EQU   ICTLFLG3
ICTLLKD  EQU   ICTLFLG3
ICTLCPY  EQU   ICTLFLG3
ICTLXPND EQU   ICTLFLG3
ICTTIND2 EQU   ICTLFLG3
ICTTIND1 EQU   ICTLFLG3
@NM00222 EQU   ICTLFLG2
ICTLDEL  EQU   ICTLFLG2
@NM00221 EQU   ICTLFLG2
ICTLTDEL EQU   ICTLFLG2
ICTLINK  EQU   ICTLFLG2
ICTCOPY  EQU   ICTLFLG2
@NM00220 EQU   ICTLFLG7
@NM00219 EQU   ICTLFLG6
@NM00218 EQU   ICTLFLG5
ICTLPAGA EQU   ICTLFLG5
ICTLNE   EQU   ICTLFLG5
@NM00217 EQU   ICTLFLG1
ICTLDC   EQU   ICTLFLG1
ICTLREFR EQU   ICTLFLG1
ICTLOVLY EQU   ICTLFLG1
ICTLSCTR EQU   ICTLFLG1
ICTLREUS EQU   ICTLFLG1
ICTLRENT EQU   ICTLFLG1
ICTLAPF  EQU   ICTLFLG1
@NM00216 EQU   ICTLFLG4
ICTLPASS EQU   ICTLFLG4
ICTLDDCK EQU   ICTLFLG4
ICTLMSG  EQU   ICTLFLG4
ICTLCPL  EQU   ICTLFLG4
ICTLNOGO EQU   ICTLFLG4
ICTLPROC EQU   ICTLFLG4
ICTLEND  EQU   ICTLNAME
@NM00215 EQU   ICTMUMNT+7
ICTMUMND EQU   ICTMUMNM
@NM00214 EQU   ICTMVRNT+7
ICTMVRND EQU   ICTMVRNM
ICTASMND EQU   ICTASMAD
ICTMIDTY EQU   ICTMODST
ICTMIDAM EQU   ICTMODST
ICTMIDRG EQU   ICTMODST
ICTMIDF1 EQU   ICTMODST
ICTMIDPL EQU   ICTMODST
ICTMIDPS EQU   ICTMODST
@NM00213 EQU   ICTMODST
ICTMIDND EQU   ICTMODID
ICTIXM   EQU   ICTIXMF
@NM00212 EQU   ICTMOD+128
ICTMICHA EQU   ICTMOD+108
@NM00211 EQU   ICTMOD+95
ICTMFMID EQU   ICTMOD+88
@NM00210 EQU   ICTMOD+87
ICTMRMID EQU   ICTMOD+80
ICTMDOBJ EQU   ICTMOD+64
ICTMSYSL EQU   ICTMOD+56
ICTMDSTL EQU   ICTMOD+48
ICTMASLB EQU   ICTMOD+40
ICTMRELN EQU   ICTMOD+22
@NM00209 EQU   ICTMOD+21
ICTMLANG EQU   ICTMOD+20
@NM00208 EQU   ICTMOD+19
ICTMACF5 EQU   ICTMOD+18
ICTMZMPR EQU   ICTMACF4
ICTMZOMZ EQU   ICTMACF4
ICTMDOAS EQU   ICTMACF4
ICTMXUPD EQU   ICTMACF4
ICTMFXC  EQU   ICTMACF4
ICTMFXBS EQU   ICTMACF4
ICTMHASM EQU   ICTMACF4
ICTMACDL EQU   ICTMACF4
@NM00207 EQU   ICTMLEP4
@NM00206 EQU   ICTMLEP3
@NM00205 EQU   ICTMLEP2
ICTMPAGA EQU   ICTMLEP2
ICTMNE   EQU   ICTMLEP2
@NM00204 EQU   ICTMLEP1
ICTMDC   EQU   ICTMLEP1
ICTMREFR EQU   ICTMLEP1
ICTMOVLY EQU   ICTMLEP1
ICTMSCTR EQU   ICTMLEP1
ICTMREUS EQU   ICTMLEP1
ICTMRENT EQU   ICTMLEP1
ICTMAPF  EQU   ICTMLEP1
@NM00203 EQU   ICTMFLG5
ICTMNORL EQU   ICTMFLG5
ICTMELCK EQU   ICTMFLG5
ICTMCOPY EQU   ICTMFLG5
ICTMPASS EQU   ICTMFLG5
@NM00202 EQU   ICTMFLG4
ICTMTSEL EQU   ICTMFLG4
ICTMDSTE EQU   ICTMFLG4
ICTMMIDE EQU   ICTMFLG4
ICTMASOC EQU   ICTMFLG4
ICTMSELM EQU   ICTMFLG4
@NM00201 EQU   ICTMFLG3
ICTMPRMS EQU   ICTMFLG3
ICTMWRK  EQU   ICTMFLG3
ICTMTRX  EQU   ICTMFLG3
ICTMRELF EQU   ICTMFLG3
ICTLIBTX EQU   ICTMFLG3
ICTLIBLK EQU   ICTMFLG3
ICTMXPND EQU   ICTMFLG1
ICTMZAP  EQU   ICTMFLG1
ICTMASM  EQU   ICTMMODR
ICTMMOD  EQU   ICTMMODR
@NM00200 EQU   ICTMFLG2
@NM00199 EQU   ICTMFLG2
ICTMMIDU EQU   ICTMFLG2
ICTMDEL  EQU   ICTMFLG2
ICTMMSG  EQU   ICTMFLG2
@NM00198 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00197 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00196 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00195 EQU   ICTCSRST
@NM00194 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00193 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00192 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00191 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00190 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00189 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00188 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00187 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00186 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00185 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00184 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
@NM00183 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPFMID EQU   ICTPTF+22
ICTPSUPN EQU   ICTPTF+20
ICTPONUM EQU   ICTPTF+18
ICTPTYPE EQU   ICTPTF+17
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00182 EQU   @NM00181
ICTPRQBY EQU   @NM00181
ICTPRQOK EQU   @NM00181
ICTPRQCK EQU   @NM00181
@NM00180 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00179 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00178 EQU   ICTPFLG4
@NM00177 EQU   ICTPFLG4
@NM00176 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00175 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00174 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00173 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00172 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00171 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00156 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00155 EQU   @NM00154+7
IOPQSMFM EQU   @NM00154
@NM00074 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00049 EQU   IOPUSERL
@NM00048 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00047 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00046 EQU   @NM00043+10
IOPSEQNO EQU   @NM00043+8
@NM00045 EQU   @NM00044+7
IOPPTFNM EQU   @NM00044
IOPNAM17 EQU   IOPNAME
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00042 EQU   CCABLDLM+2
@NM00041 EQU   CCABLDLM
@NM00040 EQU   @NM00039+21
CCASUPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00037+12
CCAIOSUP EQU   @NM00037+8
CCASUPNM EQU   @NM00037
CCAZAPPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00035+12
CCASPZAP EQU   @NM00035+8
CCAZAPNM EQU   @NM00035
CCACOMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00033+12
CCACOMRS EQU   @NM00033+8
CCACOMNM EQU   @NM00033
CCACPYPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00031+12
CCACOPY  EQU   @NM00031+8
CCACPYNM EQU   @NM00031
CCAASMPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00029+12
CCAASM   EQU   @NM00029+8
CCAASMNM EQU   @NM00029
CCALKDPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00027+12
CCALKED  EQU   @NM00027+8
CCALKDNM EQU   @NM00027
CCAPGMPM EQU   @NM00025+24
@NM00026 EQU   @NM00025+21
CCABPGRC EQU   @NM00025+20
CCABPGSP EQU   @NM00025+12
CCABPGAD EQU   @NM00025+8
CCABPGNM EQU   @NM00025
CCAEND   EQU   HMASMCCA+371
@NM00024 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00023 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00022 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00021 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00020 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00019 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00018 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00017 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00016 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00015 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00014 EQU   @NM00009+18
@NM00013 EQU   @NM00009+16
CCATBLPA EQU   @NM00009+12
@NM00012 EQU   @NM00009+8
@NM00011 EQU   @NM00009+4
@NM00010 EQU   @NM00009
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00008 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00007 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00006 EQU   CCAFBUFR+122
@NM00005 EQU   CCAFBUFR+120
@NM00004 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00003 EQU   CCAFBUFR+88
@NM00002 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00001 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00379 EQU   @EL00006
@RF00441 EQU   @EL00006
@RF00447 EQU   @EL00006
@ENDDATA EQU   *
         END   HMASMUPI,(C'PLS2236',0802,78334)

         TITLE 'HMASMTSB - HMASMP TABLE SUBROUTINES'
HMASMTSB CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMTSB  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @09,@01                                             0001
         USING @DATD,@09                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @09,8(,@13)                                         0001
         LR    @13,@09                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   TSBRTNCD=TSLGOOD;               /* SET GOOD RETURN CODE          */
         SLR   TSBRTNCD,TSBRTNCD                                   0204
*   CCAPTR=ADDR(HMASMCCA);          /*                               */
         L     CCAPTR,@CA00147                                     0205
*   LOCALTSL=''B;                   /* CLEAR LOCAL TSL PARM LIST     */
         XC    LOCALTSL(10),LOCALTSL                               0206
*   LOCALTSS=''B;                   /* ...                           */
         XC    LOCALTSS(256),LOCALTSS                              0207
*   ADDR(LOCALTSL)->TSLPMLAD=ADDR(LOCALTSS);/* PARM POINTER IN TSL   */
         LA    @08,LOCALTSL                                        0208
         LA    @03,LOCALTSS                                        0208
         ST    @03,TSLPMLAD(,@08)                                  0208
*   ADDR(LOCALTSL)->TSLTBLXP=TSLTBLXP;/* COPY TBLXPARM PTR TO LOCAL  */
*                                                                  0209
         L     @03,@PC00001                                        0209
         MVC   TSLTBLXP(4,@08),TSLTBLXP(@03)                       0209
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL THE REQUESTED FUNCTION PROCESSING ROUTINE                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0210
*   CALL TSBRTN;                    /* CALL REQUESTED SUBROUTINE     */
         SLR   @08,@08                                             0210
         IC    @08,TSLFUNCT(,@03)                                  0210
         SLA   @08,2                                               0210
         L     @15,SUBRTNS-4(@08)                                  0210
         BALR  @14,@15                                             0210
*   RFY                                                            0211
*     RTNCODE RSTD;                 /*                               */
*   TSBRTNCD=MAX(TSBRTNCD,RTNCODE); /*                               */
         CR    TSBRTNCD,RTNCODE                                    0212
         BNL   *+6
         LR    TSBRTNCD,RTNCODE                                    0212
*   RFY                                                            0213
*     RTNCODE UNRSTD;               /*                               */
*   TSLRETRN=TSBRTNCD;              /* SET PARMLIST RETURN CODE SAME
*                                      AS REG 15                     */
         L     @08,@PC00001                                        0214
         STC   TSBRTNCD,TSLRETRN(,@08)                             0214
*   RETURN CODE(TSBRTNCD);          /* RETURN WITH CODE IN PARM AREA */
         L     @13,4(,@13)                                         0215
         L     @00,@SIZDATD                                        0215
         LR    @01,@09                                             0215
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@02                                             0215
         L     @14,12(,@13)                                        0215
         LM    @00,@12,20(@13)                                     0215
         BR    @14                                                 0215
*   RFY                                                            0216
*     TSLPARMS BASED(ADDR(PARM1));                                 0216
*   RFY                                                            0217
*     TBLXPARM BASED(TSLTBLXP);                                    0217
         EJECT
*                                                                  0218
*/****************************************************************** */
*/*                                                                  */
*/* CHKICT  - CHECK THE ICT PTF SECTION TO DETERMINE WHETHER THE     */
*/*           SYSMOD PASSED IS IN THE ICT.                           */
*/*                                                                  */
*/****************************************************************** */
*                                                                  0218
*CHKICT:                                                           0218
*   PROC;                                                          0218
CHKICT   STM   @14,@12,12(@13)                                     0218
*   DCL                                                            0219
*     CKIPTFX FIXED(15);            /* LOCAL INDEX - PTF SECT ENTRIES*/
*   DCL                                                            0220
*     CKIRC FIXED(15);              /* RETURN CODE                   */
*   DCL                                                            0221
*     CKISTRTI FIXED(15);           /* START OF SEARCH INDEX         */
*   DCL                                                            0222
*     CKICTPTR PTR(31);             /* BASE FOR ICT PTF SECTION      */
*   RFY                                                            0223
*     TSLPARMS BASED(ADDR(PARM1));                                 0223
*   RFY                                                            0224
*     TBLXPARM BASED(TSLTBLXP);                                    0224
*   RESPECIFY                                                      0225
*     ICTPTF BASED(CKICTPTR);       /* ADDRESS ENTIRE PTF SECTION    */
*   CKIRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   CKIRC,CKIRC                                         0226
*   TSLICTF=''B;                    /* CLEAR RETURN INFORMATION FLAGS*/
         L     @08,@PC00001                                        0227
         L     @08,TSLPMLAD(,@08)                                  0227
         MVI   TSLICTF(@08),X'00'                                  0227
*   IF TSLIONXT=ON THEN             /* SEARCH FOR NEXT ENTRY?        */
         TM    TSLIONXT(@08),B'10000000'                           0228
         BNO   @RF00228                                            0228
*     DO;                           /* YES,                          */
*       CKISTRTI=2;                 /* START AT NEXT ENTRY           */
         LA    CKISTRTI,2                                          0230
*       CKICTPTR=TSLICTP;           /* ICT BASE IS PREVIOUS FOUND  0231
*                                      ENTRY                         */
         L     CKICTPTR,TSLICTP(,@08)                              0231
*       IF ICTPEND(1)=ICTENDNT THEN /* PREVIOUS IS END?              */
         CLC   ICTPEND(4,CKICTPTR),ICTENDNT                        0232
         BNE   @RF00232                                            0232
*         DO;                                                      0233
*           CKIRC=TSLNTFND;         /* NOT FOUND RETURN CODE         */
         LA    CKIRC,4                                             0234
*         END;                                                     0235
*       ELSE                                                       0236
*         ;                                                        0236
@RF00232 DS    0H                                                  0237
*     END;                                                         0237
*   ELSE                            /* SEARCH FOR 1ST ENTRY          */
*     DO;                                                          0238
         B     @RC00228                                            0238
@RF00228 DS    0H                                                  0239
*       CKISTRTI=1;                 /* START AT NEXT ENTRY           */
         LA    CKISTRTI,1                                          0239
*       CKICTPTR=CCAICPTF;          /* ICT BASE BEGINNING OF THE ICT */
         L     @08,@CA00147                                        0240
         L     CKICTPTR,CCAICPTF-HMASMCCA(,@08)                    0240
*     END;                                                         0241
*                                                                  0242
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH THE ICT PTF SECTION FOR THE SYSMOD                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0242
*   DO CKIPTFX=CKISTRTI BY 1        /*                               */
*         WHILE(ICTPEND(CKIPTFX)^=ICTENDNT/*                         */
*         &CKIRC=TSLGOOD);                                         0242
@RC00228 LR    CKIPTFX,CKISTRTI                                    0242
         B     @DE00242                                            0242
@DL00242 DS    0H                                                  0243
*     IF ICTPTFS(CKIPTFX)=TSLISMD   /* MATCH CALLER''S SYSMOD ?      */
*       THEN                                                       0243
         LR    @08,CKIPTFX                                         0243
         MH    @08,@CH02096                                        0243
         L     @15,@PC00001                                        0243
         L     @15,TSLPMLAD(,@15)                                  0243
         ST    @08,@TF00001                                        0243
         ALR   @08,CKICTPTR                                        0243
         AL    @08,@CF02115                                        0243
         CLC   ICTPTFS(7,@08),TSLISMD(@15)                         0243
         BNE   @RF00243                                            0243
*       DO;                         /* YES,                          */
*                                                                  0244
*         /***********************************************************/
*         /*                                                         */
*         /* SYSMOD FOUND IN ICT PTF SECTION SET TSL BASED ON ITS    */
*         /* STATUS AND PREVIOUSLY FOUND ENTRIES                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0245
*         TSLIFND=ON;               /* SYSMOD AT LEAST FOUND         */
         OI    TSLIFND(@15),B'10000000'                            0245
*         IF ICTPNOGO(CKIPTFX)=ON THEN/* NOGO?                       */
         LR    @08,CKICTPTR                                        0246
         AL    @08,@TF00001                                        0246
         AL    @08,@CF02117                                        0246
         TM    ICTPNOGO-8(@08),B'01000000'                         0246
         BNO   @RF00246                                            0246
*           DO;                     /*                               */
*             IF TSLIOK=OFF         /* RETURN PTR NOT PREVIOUSLY SET?*/
*                 &TSLISUP=OFF      /* ...                           */
*                 &TSLIDEL=OFF      /* ...                           */
*                 &TSLINOG=OFF THEN /* ... AND NOT ALREADY FOUND     */
         TM    TSLIOK(@15),B'01110010'                             0248
         BNZ   @RF00248                                            0248
*               DO;                 /* YES,                          */
*                 TSLICTP=ADDR(ICTPTF(CKIPTFX));/* SET RETURN PTR    */
         L     @08,@TF00001                                        0250
         AL    @08,@CF02115                                        0250
         LA    @08,ICTPTF(@08,CKICTPTR)                            0250
         ST    @08,TSLICTP(,@15)                                   0250
*               END;                                               0251
*             ELSE                                                 0252
*               ;                   /* RETURN PTR SET BY HIGHER    0252
*                                      PRIORITY ENTRY                */
@RF00248 DS    0H                                                  0253
*             TSLINOG=ON;           /* FOUND AS NOGO                 */
         L     @08,@PC00001                                        0253
         L     @08,TSLPMLAD(,@08)                                  0253
         OI    TSLINOG(@08),B'00000010'                            0253
*           END;                    /*                               */
*         ELSE                      /* NON NOGO ICT ENTRY            */
*           DO;                     /*                               */
         B     @RC00246                                            0255
@RF00246 DS    0H                                                  0256
*             IF ICTPDEXP(CKIPTFX)=ON/* DELETE?                      */
*                 ×ICTPDIMP(CKIPTFX)=ON THEN/*                       */
         LR    @08,CKIPTFX                                         0256
         MH    @08,@CH02096                                        0256
         ST    @08,@TF00001                                        0256
         ALR   @08,CKICTPTR                                        0256
         AL    @08,@CF02119                                        0256
         TM    ICTPDEXP-13(@08),B'00110000'                        0256
         BZ    @RF00256                                            0256
*               DO;                 /* YES                           */
*                 IF TSLIOK=OFF     /* RETURN PTR NOT PREVIOUSLY SET?*/
*                     &TSLIDEL=OFF THEN/* AND NOT PREVIOSLY FOUND?   */
         L     @08,@PC00001                                        0258
         L     @08,TSLPMLAD(,@08)                                  0258
         TM    TSLIOK(@08),B'01010000'                             0258
         BNZ   @RF00258                                            0258
*                   DO;             /* YES,                          */
*                     TSLICTP=ADDR(ICTPTF(CKIPTFX));/* SET RETURN PTR*/
         L     @01,@TF00001                                        0260
         AL    @01,@CF02115                                        0260
         LA    @15,ICTPTF(@01,CKICTPTR)                            0260
         ST    @15,TSLICTP(,@08)                                   0260
*                   END;                                           0261
*                 ELSE                                             0262
*                   ;               /* RETURN PTR SET BY HIGHER    0262
*                                      PRIORITY ENTRY                */
@RF00258 DS    0H                                                  0263
*                 TSLIDEL=ON;       /* FOUND AS DELETED SYSMOD       */
         L     @08,@PC00001                                        0263
         L     @08,TSLPMLAD(,@08)                                  0263
         OI    TSLIDEL(@08),B'00010000'                            0263
*                 IF ICTPDEXP(CKIPTFX)=ON/* EXPLICITLY DELETED ?     */
*                   THEN                                           0264
         LR    @15,CKIPTFX                                         0264
         MH    @15,@CH02096                                        0264
         ALR   @15,CKICTPTR                                        0264
         AL    @15,@CF02119                                        0264
         TM    ICTPDEXP-13(@15),B'00100000'                        0264
         BNO   @RF00264                                            0264
*                   DO;             /*                               */
*                     TSLIDLE=ON;   /* EXPLICITLY DELETED SYSMOD     */
         OI    TSLIDLE(@08),B'00001000'                            0266
*                   END;            /*                               */
*                 IF ICTPDIMP(CKIPTFX)=ON/* IMPLICITLY DELETED ?     */
*                   THEN                                           0268
@RF00264 LR    @08,CKIPTFX                                         0268
         MH    @08,@CH02096                                        0268
         ALR   @08,CKICTPTR                                        0268
         AL    @08,@CF02119                                        0268
         TM    ICTPDIMP-13(@08),B'00010000'                        0268
         BNO   @RF00268                                            0268
*                   DO;             /*                               */
*                     TSLIDLI=ON;   /* IMPLICITLY DELETED SYSMOD     */
         L     @08,@PC00001                                        0270
         L     @08,TSLPMLAD(,@08)                                  0270
         OI    TSLIDLI(@08),B'00000100'                            0270
*                   END;            /*                               */
*               END;                /*                               */
*             ELSE                  /* NOT DELETED                   */
*               DO;                 /*                               */
         B     @RC00256                                            0273
@RF00256 DS    0H                                                  0274
*                 IF ICTPSUPN(CKIPTFX)^=ZERO THEN/*                  */
         LR    @08,CKIPTFX                                         0274
         MH    @08,@CH02096                                        0274
         ST    @08,@TF00001                                        0274
         ALR   @08,CKICTPTR                                        0274
         AL    @08,@CF02123                                        0274
         SLR   @15,@15                                             0274
         ICM   @15,3,ICTPSUPN-20(@08)                              0274
         LTR   @15,@15                                             0274
         BZ    @RF00274                                            0274
*                   DO;             /*                               */
*                     IF TSLIOK=OFF /* RETURN PTR NOT PREVIOUSLY SET?*/
*                         &TSLIDEL=OFF/* ...                         */
*                         &TSLISUP=OFF THEN/* ... AND NOT ALREADY  0276
*                                      SUPED                         */
         L     @08,@PC00001                                        0276
         L     @08,TSLPMLAD(,@08)                                  0276
         TM    TSLIOK(@08),B'01110000'                             0276
         BNZ   @RF00276                                            0276
*                       DO;         /* YES,                          */
*                         TSLICTP=ADDR(ICTPTF(CKIPTFX));/* SET RETURN
*                                      PTR                           */
         L     @01,@TF00001                                        0278
         AL    @01,@CF02115                                        0278
         LA    @15,ICTPTF(@01,CKICTPTR)                            0278
         ST    @15,TSLICTP(,@08)                                   0278
*                       END;                                       0279
*                     ELSE                                         0280
*                       ;           /* RETURN PTR SET BY HIGHER    0280
*                                      PRIORITY ENTRY                */
@RF00276 DS    0H                                                  0281
*                     TSLISUP=ON;   /* IMPLICITLY DELETED SYSMOD     */
         L     @08,@PC00001                                        0281
         L     @08,TSLPMLAD(,@08)                                  0281
         OI    TSLISUP(@08),B'00100000'                            0281
*                   END;            /*                               */
*                 ELSE              /* WONDER OF WONDERS THE SYSMOD
*                                      IS OK!                        */
*                   DO;             /*                               */
         B     @RC00274                                            0283
@RF00274 DS    0H                                                  0284
*                     IF TSLIOK=OFF THEN/* NOT ALREADY FOUND         */
         L     @08,@PC00001                                        0284
         L     @08,TSLPMLAD(,@08)                                  0284
         TM    TSLIOK(@08),B'01000000'                             0284
         BNZ   @RF00284                                            0284
*                       DO;         /* YES,                          */
*                         TSLICTP=ADDR(ICTPTF(CKIPTFX));/* SET RETURN
*                                      PTR                           */
         LR    @15,CKIPTFX                                         0286
         MH    @15,@CH02096                                        0286
         AL    @15,@CF02115                                        0286
         LA    @15,ICTPTF(@15,CKICTPTR)                            0286
         ST    @15,TSLICTP(,@08)                                   0286
*                         TSLIOK=ON;/* FOUND AND IS GO               */
         OI    TSLIOK(@08),B'01000000'                             0287
*                       END;                                       0288
*                   END;            /*                               */
*               END;                /*                               */
*           END;                    /*                               */
*       END;                                                       0292
*     ELSE                          /* NOT A MATCHING ENTRY          */
*       DO;                         /*                               */
         B     @RC00243                                            0293
@RF00243 DS    0H                                                  0294
*       END;                        /*                               */
*   END;                            /* END OF ICT PTF SEARCH LOOP    */
@RC00243 AH    CKIPTFX,@CH00048                                    0295
@DE00242 LR    @08,CKIPTFX                                         0295
         MH    @08,@CH02096                                        0295
         AL    @08,@CF02115                                        0295
         L     @08,ICTPEND(@08,CKICTPTR)                           0295
         CL    @08,ICTENDNT                                        0295
         BE    @DC00242                                            0295
         LTR   CKIRC,CKIRC                                         0295
         BZ    @DL00242                                            0295
@DC00242 DS    0H                                                  0296
*   IF TSLIFND=OFF THEN             /* ENTRY NOT FOUND?              */
         L     @08,@PC00001                                        0296
         L     @08,TSLPMLAD(,@08)                                  0296
         TM    TSLIFND(@08),B'10000000'                            0296
         BNZ   @RF00296                                            0296
*     DO;                                                          0297
*       CKIRC=TSLNTFND;             /* NOT FOUND RC                  */
         LA    CKIRC,4                                             0298
*     END;                                                         0299
*   RETURN CODE(CKIRC);                                            0300
@RF00296 LR    @15,CKIRC                                           0300
         L     @14,12(,@13)                                        0300
         LM    @00,@12,20(@13)                                     0300
         BR    @14                                                 0300
*   RFY                                                            0301
*     TSLPARMS BASED;                                              0301
*   RFY                                                            0302
*     TBLXPARM BASED;                                              0302
*   RFY                                                            0303
*     ICTPTF BASED;                 /*                               */
*   END CHKICT;                                                    0304
*                                                                  0305
*   /*****************************************************************/
*   /*                                                               */
*   /* LSTICTCK - FIND ICT PTF ENTRY THAT CONTAINS THE NAMED SYSMOD  */
*   /* IN THE SPECIFIED INDEX LIST                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0305
*LSTICTCK:                                                         0305
*   PROC;                                                          0305
LSTICTCK STM   @14,@12,12(@13)                                     0305
*   DCL                                                            0306
*     1 LICFLAGS BIT(8),            /* LOCAL CONTROL FLAGS           */
*      2 LICFOUND BIT(1),           /* NAME FOUND IN INDEX LIST OF AN
*                                      ICT PTF ENT                   */
*      2 * BIT(7);                  /* UNUSED                        */
*   DCL                                                            0307
*     LICPTFX FIXED(15);            /* INDEX FOR ICT PTF SECTION LOOP*/
*   DCL                                                            0308
*     LICNDXI FIXED(15);            /* INDEX FOR INDEX LIST SEARCH   */
*   DCL                                                            0309
*     LICRC FIXED(15);              /* RETURN CODE                   */
*   DCL                                                            0310
*     LICICTP PTR(31);              /* BASE FOR ICT PTF SECTION      */
*   DCL                                                            0311
*     LICSTRTI FIXED(15);           /* START OF SEARCH INDEX         */
*   DCL                                                            0312
*     LICPTR31 PTR(31) BASED;       /* BASED POINTER                 */
*   DCL                                                            0313
*     LICIRQOF FIXED(31);           /* OFFSET OF ++IF REQ CHAIN      */
*   DCL                                                            0314
*     LICLSTI FIXED(31);            /* INCRAEMENT FOR SEARCH (1 OR 2)*/
*   RFY                                                            0315
*     TSLPARMS BASED(ADDR(PARM1));                                 0315
*   RFY                                                            0316
*     TBLXPARM BASED(TSLTBLXP);                                    0316
*   RFY                                                            0317
*     ICTPTF BASED(LICICTP);                                       0317
*   RFY                                                            0318
*     ICTENTLS BASED((ADDR(ICTPTF(LICPTFX))+TSLLOFST)->LICPTR31);  0318
*   LICRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   LICRC,LICRC                                         0319
*   LICFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         MVI   LICFLAGS,X'00'                                      0320
*   LICIRQOF=ADDR(ICTPICHN(1))      /* COMPUTE OFFSET OF ++IF REQ  0321
*                                      CHAIN PTR                     */
*       -ADDR(ICTPTF(1));                                          0321
         L     @08,LICICTP                                         0321
         LA    LICIRQOF,ICTPICHN(,@08)                             0321
         SLR   LICIRQOF,@08                                        0321
*   IF TSLLOFST=LICIRQOF THEN       /* ++IF REQ INDEX BEING        0322
*                                      PROCESSED?                    */
         L     @08,@PC00001                                        0322
         L     @08,TSLPMLAD(,@08)                                  0322
         C     LICIRQOF,TSLLOFST(,@08)                             0322
         BNE   @RF00322                                            0322
*     DO;                           /* YES,                          */
*       LICLSTI=2;                  /* INCREAMENT IS 2               */
         LA    LICLSTI,2                                           0324
*     END;                                                         0325
*   ELSE                            /* NOT THE ++IF REQ INDEX        */
*     DO;                                                          0326
         B     @RC00322                                            0326
@RF00322 DS    0H                                                  0327
*       LICLSTI=1;                  /* INCREAMENT IS 1               */
         LA    LICLSTI,1                                           0327
*     END;                                                         0328
*   IF TSLLONXT=ON THEN             /* SEARCH FOR NEXT ENTRY?        */
@RC00322 L     @08,@PC00001                                        0329
         L     @08,TSLPMLAD(,@08)                                  0329
         TM    TSLLONXT(@08),B'10000000'                           0329
         BNO   @RF00329                                            0329
*     DO;                           /* YES,                          */
*       LICSTRTI=2;                 /* START AT NEXT ENTRY           */
         LA    LICSTRTI,2                                          0331
*       LICICTP=TSLLRTNP;           /* ICT BASE IS PREVIOUS FOUND  0332
*                                      ENTRY                         */
         L     @08,TSLLRTNP(,@08)                                  0332
         ST    @08,LICICTP                                         0332
*       IF ICTPEND(1)=ICTENDNT THEN /* PREVIOUS IS END?              */
         CLC   ICTPEND(4,@08),ICTENDNT                             0333
         BNE   @RF00333                                            0333
*         DO;                                                      0334
*           LICRC=TSLNTFND;         /* NOT FOUND RETURN CODE         */
         LA    LICRC,4                                             0335
*         END;                                                     0336
*       ELSE                                                       0337
*         ;                                                        0337
@RF00333 DS    0H                                                  0338
*     END;                                                         0338
*   ELSE                            /* SEARCH FOR 1ST ENTRY          */
*     DO;                                                          0339
         B     @RC00329                                            0339
@RF00329 DS    0H                                                  0340
*       LICSTRTI=1;                 /* START AT NEXT ENTRY           */
         LA    LICSTRTI,1                                          0340
*       LICICTP=CCAICPTF;           /* ICT BASE BEGINNING OF THE ICT */
         L     @08,@CA00147                                        0341
         MVC   LICICTP(4),CCAICPTF-HMASMCCA(@08)                   0341
*     END;                                                         0342
*                                                                  0342
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH SPECIFIED INDEX LIST IN ALL ICT PTF ENTRIES            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0343
*   DO LICPTFX=LICSTRTI BY 1        /* SEARCH ICT PTF SECTION ...    */
*         WHILE(LICRC=ZERO          /* ... UNTIL ERROR, MATCH FOUND,
*                                      OR END LIST                   */
*         &LICFOUND=OFF             /* ...                           */
*         &ICTPEND(LICPTFX)^=ICTENDNT);/* ...                        */
@RC00329 LR    LICPTFX,LICSTRTI                                    0343
         B     @DE00343                                            0343
@DL00343 DS    0H                                                  0344
*     IF(ICTPNOGO(LICPTFX)=OFF      /* SYSMOD NOT NOGO               */
*         &(ICTPDEXP(LICPTFX)=OFF   /* AND NOT DELETED               */
*         &ICTPDIMP(LICPTFX)=OFF)   /* ...                           */
*         &ICTPSUPN(LICPTFX)=ZERO) THEN/* AND NOT SUP'ED             */
         L     @08,LICICTP                                         0344
         LR    @07,LICPTFX                                         0344
         MH    @07,@CH02096                                        0344
         ST    @07,@TF00001                                        0344
         ALR   @07,@08                                             0344
         AL    @07,@CF02117                                        0344
         TM    ICTPNOGO-8(@07),B'01000000'                         0344
         BNZ   @RF00344                                            0344
         LR    @07,@08                                             0344
         AL    @07,@TF00001                                        0344
         AL    @07,@CF02119                                        0344
         TM    ICTPDEXP-13(@07),B'00110000'                        0344
         BNZ   @RF00344                                            0344
         LR    @07,@08                                             0344
         AL    @07,@TF00001                                        0344
         AL    @07,@CF02123                                        0344
         SLR   @04,@04                                             0344
         ICM   @04,3,ICTPSUPN-20(@07)                              0344
         LTR   @04,@04                                             0344
         BNZ   @RF00344                                            0344
*       DO;                         /* YES,                          */
*         IF TSLLSMD^=ICTPTFS(LICPTFX) THEN/* NOT ENTRY INPUT SYSMOD
*                                      NAME?                         */
         L     @07,@PC00001                                        0346
         L     @07,TSLPMLAD(,@07)                                  0346
         AL    @08,@TF00001                                        0346
         AL    @08,@CF02115                                        0346
         CLC   TSLLSMD(7,@07),ICTPTFS(@08)                         0346
         BE    @RF00346                                            0346
*           DO;                     /* YES,                          */
*                                                                  0347
*             /*******************************************************/
*             /*                                                     */
*             /* SEARCH EACH INDEX LIST FOR A MATCH                  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0348
*             DO LICNDXI=1 BY LICLSTI/* PROCESS ALL INDEX LIST     0348
*                                      ENTRIES                       */
*                   WHILE(ADDR(ICTENTLS)^=ZERO/* NOT ZERO CHAIN PTR  */
*                   &ICTENTND(LICNDXI)^=ICTENDIX/* AND NOT END OF  0348
*                                      LIST                          */
*                   &LICFOUND=OFF); /* AND NOT YET FOUND     @Z67SP00*/
         LA    LICNDXI,1                                           0348
         B     @DE00348                                            0348
@DL00348 DS    0H                                                  0349
*               IF ICTENTNM(LICNDXI)=TSLLSMD THEN/* MATCH FOUND?     */
         LR    @08,LICNDXI                                         0349
         SLA   @08,3                                               0349
         LR    @07,LICPTFX                                         0349
         MH    @07,@CH02096                                        0349
         L     @01,LICICTP                                         0349
         AL    @01,@CF02115                                        0349
         LA    @07,ICTPTF(@07,@01)                                 0349
         L     @15,@PC00001                                        0349
         L     @15,TSLPMLAD(,@15)                                  0349
         LR    @14,@07                                             0349
         AL    @14,TSLLOFST(,@15)                                  0349
         L     @01,LICPTR31(,@14)                                  0349
         ALR   @01,@08                                             0349
         AL    @01,@CF02126                                        0349
         CLC   ICTENTNM(7,@01),TSLLSMD(@15)                        0349
         BNE   @RF00349                                            0349
*                 DO;               /* YES,                          */
*                   LICFOUND=ON;    /* FOUND FLAG ON                 */
         OI    LICFOUND,B'10000000'                                0351
*                   LICRC=TSLGOOD;  /* FOUND RETURN CODE             */
         SLR   LICRC,LICRC                                         0352
*                   TSLLRTNP=ADDR(ICTPTF(LICPTFX));/* RETURN ICT PTF
*                                      ADDR                          */
         ST    @07,TSLLRTNP(,@15)                                  0353
*                 END;                                             0354
*               ELSE                                               0355
*                 ;                 /* INDEX LIST NAME DOES NOT MATCH*/
@RF00349 DS    0H                                                  0356
*             END;                  /* END OF SEARCH THRU ONE INDEX
*                                      LIST                          */
         ALR   LICNDXI,LICLSTI                                     0356
@DE00348 LR    @08,LICPTFX                                         0356
         MH    @08,@CH02096                                        0356
         L     @07,LICICTP                                         0356
         AL    @07,@CF02115                                        0356
         LA    @08,ICTPTF(@08,@07)                                 0356
         L     @07,@PC00001                                        0356
         L     @07,TSLPMLAD(,@07)                                  0356
         AL    @08,TSLLOFST(,@07)                                  0356
         L     @08,LICPTR31(,@08)                                  0356
         LTR   @08,@08                                             0356
         BZ    @DC00348                                            0356
         LR    @07,LICNDXI                                         0356
         SLA   @07,3                                               0356
         AL    @08,@CF02126                                        0356
         L     @08,ICTENTND(@07,@08)                               0356
         CL    @08,ICTENDIX                                        0356
         BE    @DC00348                                            0356
         TM    LICFOUND,B'10000000'                                0356
         BZ    @DL00348                                            0356
@DC00348 DS    0H                                                  0357
*           END;                                                   0357
*         ELSE                                                     0358
*           ;                       /* ICT ENTRY FOR NAMED SYSMOD SO
*                                      SKIP                          */
@RF00346 DS    0H                                                  0359
*       END;                                                       0359
*     ELSE                                                         0360
*       ;                           /* NOT APPLICABLE SYSMOD SO SKIP
*                                      IT                            */
@RF00344 DS    0H                                                  0361
*   END;                            /* END OF ICT PTF SEARCH LOOP    */
         AH    LICPTFX,@CH00048                                    0361
@DE00343 LTR   LICRC,LICRC                                         0361
         BNZ   @DC00343                                            0361
         TM    LICFOUND,B'10000000'                                0361
         BNZ   @DC00343                                            0361
         LR    @08,LICPTFX                                         0361
         MH    @08,@CH02096                                        0361
         L     @07,LICICTP                                         0361
         AL    @07,@CF02115                                        0361
         L     @08,ICTPEND(@08,@07)                                0361
         CL    @08,ICTENDNT                                        0361
         BNE   @DL00343                                            0361
@DC00343 DS    0H                                                  0362
*   IF LICFOUND=OFF THEN            /* NOT FOUND?                    */
         TM    LICFOUND,B'10000000'                                0362
         BNZ   @RF00362                                            0362
*     DO;                                                          0363
*       LICRC=TSLNTFND;             /* NOT FOUND RC                  */
         LA    LICRC,4                                             0364
*     END;                                                         0365
*   ELSE                                                           0366
*     ;                             /* ALL IS WELL                   */
@RF00362 DS    0H                                                  0367
*   RETURN CODE(LICRC);             /* RETURN WITH THE RETURN CODE   */
         LR    @15,LICRC                                           0367
         L     @14,12(,@13)                                        0367
         LM    @00,@12,20(@13)                                     0367
         BR    @14                                                 0367
*   RFY                                                            0368
*     TSLPARMS BASED;                                              0368
*   RFY                                                            0369
*     TBLXPARM BASED;                                              0369
*   RFY                                                            0370
*     ICTPTF BASED;                                                0370
*   RFY                                                            0371
*     ICTENTLS BASED;                                              0371
*   END LSTICTCK;                   /*                               */
         EJECT
*                                                                  0373
*   /*****************************************************************/
*   /*                                                               */
*   /* GETDS - GET AN ENTRY FROM THE SPECIFIED DATA SET              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0373
*GETDS:                             /*                               */
*   PROC;                           /*                               */
GETDS    STM   @14,@12,@SA00004                                    0373
*   DCL                                                            0374
*     DSIDVALA(4) FIXED(8)          /* DSID VALUES PROCESS BY THIS 0374
*                                      ROUTINE AND THIS ARRAY USED TO
*                                      INDEX MESSAGE TEXT            */
*         INIT(IOPPTS,              /* SMPPTS DATA SET               */
*         IOPCDS,                   /* SMPCDS DATA SET               */
*         IOPACDS,                  /* SMPACDS DATA SET              */
*         0);                       /* UNKNOWN                       */
*   DCL                                                            0375
*     TXTDSIDA(4) CHAR(8)           /* MESSAGE VAR PARTS           0375
*                                      CORRESPONDING TO 'DSIDVALA' 0375
*                                      DSID'S                        */
*         INIT('SMPPTS  ',          /* 'SMPPTS'                      */
*         'SMPCDS  ',               /* 'SMPCDS'                      */
*         'SMPACDS ',               /* 'SMPACDS'                     */
*         '********');              /* UNKNOWN                       */
*   DCL                                                            0376
*     TYPEVALA(3) FIXED(8)          /* TYPE VALUES TO BE PROCESSED   */
*         INIT(IOPSMD,              /* SYSMOD ENTRY                  */
*         IOPMCS,                   /* MCS ENTRY                     */
*         0);                       /* UNKNOWN                       */
*   DCL                                                            0377
*     TXTTYPEA(3) CHAR(8)           /* MESSAGE VAR PARTS           0377
*                                      CORRESPONDING TO 'TYPEVALA' 0377
*                                      TYPES                         */
*         INIT('SYSMOD  ',          /* 'SYSMOD'                      */
*         'MCS     ',               /* 'MCS'                         */
*         '********');              /* UNKNOWN                       */
*   DCL                             /*                               */
*     1 GTCFLAGS BIT(8),            /* LOCAL CONTROL FLAGS           */
*      2 GTCDSFND BIT(1),           /* DSID FOUND                    */
*      2 GTCTYFND BIT(1),           /* TYPE FOUND                    */
*      2 * BIT(6);                  /* UNUSED                        */
*   DCL                                                            0379
*     GTCI FIXED(15);               /* INDEX INTO THE DSID TEXT ARRAY*/
*   DCL                                                            0380
*     GTCJ FIXED(15);               /* INDEX INTO THE TYPE TEXT    0380
*                                      ARRRAY                        */
*   DCL                                                            0381
*     GTCRC FIXED(15);              /* LOCMCS RETURN CODE            */
*   RFY                                                            0382
*     TSLPARMS BASED(ADDR(PARM1));                                 0382
*   RFY                                                            0383
*     TBLXPARM BASED(TSLTBLXP);                                    0383
*   RFY                                                            0384
*     HMASMIOP BASED(TSLGIOPP);                                    0384
*   GTCRC=ZERO;                     /* CLEAR THE RETURN CODE         */
         SLR   GTCRC,GTCRC                                         0385
*   IOPDSID=TSLGDSID;               /* DSID IS ONE IN PARM LIST ...  */
         L     @08,@PC00001                                        0386
         L     @08,TSLPMLAD(,@08)                                  0386
         L     @02,TSLGIOPP(,@08)                                  0386
         MVC   IOPDSID(1,@02),TSLGDSID(@08)                        0386
*   IOPNAME=TSLGSMD;                /* ... SYSMOD BEING PROCESSED    */
         MVI   IOPNAME+7(@02),C' '                                 0387
         MVC   IOPNAME(7,@02),TSLGSMD(@08)                         0387
*   IF TSLGOXTD=ON THEN             /* REQUEST IS FOR EXTENDED ENTRY?*/
         TM    TSLGOXTD(@08),B'00001000'                           0388
         BNO   @RF00388                                            0388
*     DO;                           /* YES,                          */
*       IOPFUNCT=IOPLOC;            /* SET FUNCTION AS EXTENDED ENTRY*/
         MVI   IOPFUNCT(@02),X'03'                                 0390
*     END;                                                         0391
*   ELSE                            /* ONLY BLDL                     */
*     DO;                                                          0392
         B     @RC00388                                            0392
@RF00388 DS    0H                                                  0393
*       IOPFUNCT=IOPBLDL;           /* SET FUNCTION AS BLDL          */
         L     @08,@PC00001                                        0393
         L     @08,TSLPMLAD(,@08)                                  0393
         L     @08,TSLGIOPP(,@08)                                  0393
         MVI   IOPFUNCT(@08),X'04'                                 0393
*     END;                                                         0394
*   IOPTYPE=IOPSMD;                 /* ...                           */
@RC00388 L     @08,@PC00001                                        0395
         L     @08,TSLPMLAD(,@08)                                  0395
         L     @08,TSLGIOPP(,@08)                                  0395
         MVI   IOPTYPE(@08),X'0B'                                  0395
*   CALL HMASMIO(HMASMIOP);         /* ...                           */
         ST    @08,@AL00001                                        0396
         L     @15,@CV01797                                        0396
         LA    @01,@AL00001                                        0396
         BALR  @14,@15                                             0396
*   GTCRC=MAX(GTCRC,IOPRETRN);      /* SET RETURN CODE               */
         L     @08,@PC00001                                        0397
         L     @08,TSLPMLAD(,@08)                                  0397
         L     @02,TSLGIOPP(,@08)                                  0397
         SLR   @15,@15                                             0397
         IC    @15,IOPRETRN(,@02)                                  0397
         CR    GTCRC,@15                                           0397
         BNL   *+6
         LR    GTCRC,@15                                           0397
*   IF IOPRETRN=IOPNTFND            /* WAS THERE AN ERROR            */
*       &TSLGOMSG=ON THEN           /* AND MESSAGE IS TO BE ISSUED?  */
         CLI   IOPRETRN(@02),4                                     0398
         BNE   @RF00398                                            0398
         TM    TSLGOMSG(@08),B'00010000'                           0398
         BNO   @RF00398                                            0398
*     DO;                           /* YES,                          */
*       GTCRC=STOPPTF;              /* STOP THE SYSMOD               */
*                                                                  0400
         LA    GTCRC,8                                             0400
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE DATA SET DDNAME AND THE ENTRY TYPE VALUES FOR THE */
*       /* MESSAGE TEXT                                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0401
*       DO GTCI=1 TO DIM(DSIDVALA)  /*                               */
*             WHILE(GTCDSFND=OFF);  /*                               */
         LA    GTCI,1                                              0401
@DL00401 TM    GTCDSFND,B'10000000'                                0401
         BNZ   @DC00401                                            0401
*         IF IOPDSID=DSIDVALA(GTCI) THEN/* MATCHING DSID?            */
         L     @08,@PC00001                                        0402
         L     @08,TSLPMLAD(,@08)                                  0402
         L     @08,TSLGIOPP(,@08)                                  0402
         SLR   @15,@15                                             0402
         IC    @15,IOPDSID(,@08)                                   0402
         SLR   @08,@08                                             0402
         IC    @08,DSIDVALA-1(GTCI)                                0402
         CR    @15,@08                                             0402
         BNE   @RF00402                                            0402
*           DO;                     /* YES,                          */
*             GTCDSFND=ON;          /* FOUND DSID                    */
         OI    GTCDSFND,B'10000000'                                0404
*           END;                    /*                               */
*         ELSE                                                     0406
*           ;                       /* NOT A MATCH                   */
@RF00402 DS    0H                                                  0407
*       END;                        /*                               */
         AH    GTCI,@CH00048                                       0407
         CH    GTCI,@CH00133                                       0407
         BNH   @DL00401                                            0407
@DC00401 DS    0H                                                  0408
*       DO GTCJ=1 TO DIM(TYPEVALA)  /*                               */
*             WHILE(GTCTYFND=OFF);  /*                               */
         LA    GTCJ,1                                              0408
@DL00408 TM    GTCTYFND,B'01000000'                                0408
         BNZ   @DC00408                                            0408
*         IF IOPDSID=DSIDVALA(GTCI) THEN/* MATCHING DSID?            */
         L     @08,@PC00001                                        0409
         L     @08,TSLPMLAD(,@08)                                  0409
         L     @08,TSLGIOPP(,@08)                                  0409
         SLR   @05,@05                                             0409
         IC    @05,IOPDSID(,@08)                                   0409
         SLR   @08,@08                                             0409
         IC    @08,DSIDVALA-1(GTCI)                                0409
         CR    @05,@08                                             0409
         BNE   @RF00409                                            0409
*           DO;                     /* YES,                          */
*             GTCTYFND=ON;          /* FOUND DSID                    */
         OI    GTCTYFND,B'01000000'                                0411
*           END;                    /*                               */
*         ELSE                                                     0413
*           ;                       /* NOT A MATCH                   */
@RF00409 DS    0H                                                  0414
*       END;                        /*                               */
*                                                                  0414
         AH    GTCJ,@CH00048                                       0414
         CH    GTCJ,@CH00077                                       0414
         BNH   @DL00408                                            0414
@DC00408 DS    0H                                                  0415
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MESSAGE HMA246I XXXXXXXX XXXXXXXX NOT FOUND ON      */
*       /* XXXXXXXX                                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0415
*       DO;                         /* HMASMPMG M1(HMA246I)VAR(TXTTYP
*                                      EA(GTCJ),IOPNAM17,TXTDSIDA(GTC
*                                      I))TYPE(ERR)TARGET(SYSOUT,LOG)*/
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */
         XC    HMASMMGP(28),HMASMMGP                               0416
*         MGPMGNO1=HMA246I;         /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01801                                0417
*         MGPTYPE=MGPERR;           /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0418
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0420
*         MGPVARPT(1)=ADDR(TXTTYPEA(GTCJ));/* SET VARIABLE PTR       */
         LR    @08,GTCJ                                            0421
         SLA   @08,3                                               0421
         LA    @08,TXTTYPEA-8(@08)                                 0421
         ST    @08,MGPVARPT                                        0421
*         MGPVARPT(2)=ADDR(IOPNAM17);/* SET VARIABLE PTR             */
         L     @08,@PC00001                                        0422
         L     @08,TSLPMLAD(,@08)                                  0422
         L     @08,TSLGIOPP(,@08)                                  0422
         LA    @08,IOPNAM17(,@08)                                  0422
         ST    @08,MGPVARPT+4                                      0422
*         MGPVARPT(3)=ADDR(TXTDSIDA(GTCI));/* SET VARIABLE PTR       */
         LR    @08,GTCI                                            0423
         SLA   @08,3                                               0423
         LA    @08,TXTDSIDA-8(@08)                                 0423
         ST    @08,MGPVARPT+8                                      0423
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */
         LA    @08,HMASMMGP                                        0424
         ST    @08,@AL00001                                        0424
         L     @15,@CV01796                                        0424
         LA    @01,@AL00001                                        0424
         BALR  @14,@15                                             0424
*       END;                                                       0425
*     END;                          /*                               */
*   ELSE                                                           0427
*     ;                             /* IO WAS OK                     */
@RF00398 DS    0H                                                  0428
*   RETURN CODE(GTCRC);             /*                               */
         LR    @15,GTCRC                                           0428
         L     @14,@SA00004                                        0428
         LM    @00,@12,@SA00004+8                                  0428
         BR    @14                                                 0428
*   RFY                                                            0429
*     TSLPARMS BASED;                                              0429
*   RFY                                                            0430
*     TBLXPARM BASED;                                              0430
*   RFY                                                            0431
*     HMASMIOP BASED;                                              0431
*   END GETDS;                      /*                               */
         EJECT
*CKICTCDS:                          /*                               */
*   PROC;                           /*                               */
CKICTCDS STM   @14,@12,@SA00005                                    0433
*   DCL                                                            0434
*     CICRC FIXED(15);              /* RETURN CODE                   */
*   DCL                                                            0435
*     1 CICFLAGS,                   /*                               */
*      2 CICFOUND BIT(1),           /* SYSMOD FOUND FLAG             */
*      2 * BIT(7);                  /*                               */
*   RFY                                                            0436
*     TSLPARMS BASED(ADDR(PARM1));                                 0436
*   RFY                                                            0437
*     TBLXPARM BASED(TSLTBLXP);                                    0437
*   CICFOUND=OFF;                   /*                               */
         NI    CICFOUND,B'01111111'                                0438
*   CICRC=TSLNTFND;                 /* ASSUME SYSMOD NOT FOUND       */
         LA    CICRC,4                                             0439
*   TSLSICTF=''B;                   /* CLEAR OUTPUT FLAGS            */
         L     @08,@PC00001                                        0440
         L     @08,TSLPMLAD(,@08)                                  0440
         MVI   TSLSICTF(@08),X'00'                                 0440
*   TSLSCDSF=''B;                   /* ...                           */
         MVI   TSLSCDSF(@08),X'00'                                 0441
*   IF TSLSOICT=ON THEN             /* SEARCH THE ICT FOR THE SYSMOD?*/
         TM    TSLSOICT(@08),B'10000000'                           0442
         BNO   @RF00442                                            0442
*     DO;                           /*                               */
*                                                                  0443
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP LOCAL TSL PARMLIST AND CALL HMASMTSB (THYSELF) TO   */
*       /* FIND THE SYSMOD IN THE ICT                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0444
*       ADDR(LOCALTSL)->TSLFUNCT=TSLFISRH;/* FUNCTION IS SEARCH ICT  */
         LA    @15,LOCALTSL                                        0444
         MVI   TSLFUNCT(@15),X'01'                                 0444
*       ADDR(LOCALTSS)->TSLISMD=TSLSSMD;/* SYSMOD NAME TO SEARCH FOR */
         LA    @15,LOCALTSS                                        0445
         MVC   TSLISMD(7,@15),TSLSSMD(@08)                         0445
*       CALL HMASMTSB(LOCALTSL);                                   0446
         LA    @08,LOCALTSL                                        0446
         ST    @08,@AL00001                                        0446
         LA    @01,@AL00001                                        0446
         L     @15,@CA00028                                        0446
         BALR  @14,@15                                             0446
*       TSLSICTF=ADDR(LOCALTSS)->TSLICTF;/* SET OUTPUT FLAGS         */
         L     @08,@PC00001                                        0447
         L     @08,TSLPMLAD(,@08)                                  0447
         LA    @03,LOCALTSS                                        0447
         MVC   TSLSICTF(1,@08),TSLICTF(@03)                        0447
*       TSLSICTP=ADDR(LOCALTSS)->TSLICTP;/* ICT PTF ENTRY PTR        */
         MVC   TSLSICTP(4,@08),TSLICTP(@03)                        0448
*       CICRC=ADDR(LOCALTSL)->TSLRETRN;/* RETURN CODE IS ICT SEARCH
*                                      RC                            */
         LA    @08,LOCALTSL                                        0449
         SLR   CICRC,CICRC                                         0449
         IC    CICRC,TSLRETRN(,@08)                                0449
*       IF CICRC=TSLGOOD THEN       /* SYSMOD FOUND?                 */
         LTR   CICRC,CICRC                                         0450
         BNZ   @RF00450                                            0450
*         DO;                       /* YES,                          */
*           CICFOUND=ON;            /* FOUND FLAG                    */
         OI    CICFOUND,B'10000000'                                0452
*           CICRC=TSLFOUND;         /* FOUND RETURN CODE             */
         SLR   CICRC,CICRC                                         0453
*         END;                      /*                               */
*       ELSE                        /* NOT FOUND IN THE ICT          */
*         DO;                                                      0455
*                                                                  0455
         B     @RC00450                                            0455
@RF00450 DS    0H                                                  0456
*           /*********************************************************/
*           /*                                                       */
*           /* LOOK FOR SYSMOD IN SUP LISTS OF ALL ICT SYSMODS       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0456
*           ADDR(LOCALTSL)->TSLFUNCT=TSLFLSRH;/* FUNCTION IS SEARCH
*                                      INDEX                         */
         LA    @08,LOCALTSL                                        0456
         MVI   TSLFUNCT(@08),X'02'                                 0456
*           ADDR(LOCALTSS)->TSLLSMD=TSLSSMD;/* SYSMOD NAME TO SEARCH
*                                      FOR                           */
         LA    @08,LOCALTSS                                        0457
         L     @15,@PC00001                                        0457
         L     @01,TSLPMLAD(,@15)                                  0457
         MVC   TSLLSMD(7,@08),TSLSSMD(@01)                         0457
*           RFY                                                    0458
*             ICTPTF BASED(CCAICPTF);                              0458
*           ADDR(LOCALTSS)->TSLLOFST=/* OFFSET OF SUP LIST           */
*               ADDR(ICTPSCHN)-ADDR(ICTPTF);                       0459
         MVC   TSLLOFST(4,@08),@CF00932                            0459
*           RFY                                                    0460
*             ICTPTF BASED;                                        0460
*           CALL HMASMTSB(LOCALTSL);                               0461
         LA    @08,LOCALTSL                                        0461
         ST    @08,@AL00001                                        0461
         LA    @01,@AL00001                                        0461
         L     @15,@CA00028                                        0461
         BALR  @14,@15                                             0461
*           TSLSICTP=ADDR(LOCALTSS)->TSLLRTNP;/* SET OUTPUT FLAGS    */
         L     @08,@PC00001                                        0462
         L     @08,TSLPMLAD(,@08)                                  0462
         LA    @03,LOCALTSS                                        0462
         MVC   TSLSICTP(4,@08),TSLLRTNP(@03)                       0462
*           CICRC=ADDR(LOCALTSL)->TSLRETRN;/* RETURN CODE IS ICT   0463
*                                      SEARCH                        */
         LA    @15,LOCALTSL                                        0463
         SLR   CICRC,CICRC                                         0463
         IC    CICRC,TSLRETRN(,@15)                                0463
*           IF CICRC=TSLFOUND THEN  /* FOUND?                        */
         LTR   CICRC,CICRC                                         0464
         BNZ   @RF00464                                            0464
*             DO;                                                  0465
*               TSLSIFND=ON;        /* FOUND FLAG                    */
*               TSLSISLS=ON;        /* FOUND IN SUP LIST ONLY        */
*               TSLSISUP=ON;        /* SUP'ED IN THE ICT             */
         OI    TSLSIFND(@08),B'10100001'                           0468
*             END;                                                 0469
*           ELSE                                                   0470
*             ;                     /* NOT FOUND                     */
@RF00464 DS    0H                                                  0471
*         END;                                                     0471
*     END;                          /*                               */
*   ELSE                                                           0473
*     ;                             /* NOT TO SEARCH THE ICT         */
@RF00442 DS    0H                                                  0474
*   IF(CICRC^=TSLFOUND              /*                               */
*       &TSLSOCDS=ON)               /*                               */
*       ×(TSLSOALL=ON               /*                               */
*       &TSLSOCDS=ON) THEN          /*                               */
@RC00442 LTR   CICRC,CICRC                                         0474
         BZ    @GL00009                                            0474
         L     @08,@PC00001                                        0474
         L     @08,TSLPMLAD(,@08)                                  0474
         TM    TSLSOCDS(@08),B'01000000'                           0474
         BO    @RT00474                                            0474
@GL00009 L     @08,@PC00001                                        0474
         L     @08,TSLPMLAD(,@08)                                  0474
         TM    TSLSOALL(@08),B'01100000'                           0474
         BNO   @RF00474                                            0474
@RT00474 DS    0H                                                  0475
*     DO;                           /*                               */
*                                                                  0475
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP LOCAL TSL PARMLIST AND CALL THYSELF TO 'GETDS'      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0476
*       LOCALTSS=''B;               /* CLEAR PARM LIST               */
         XC    LOCALTSS(256),LOCALTSS                              0476
*       ADDR(LOCALTSL)->TSLFUNCT=TSLFGETS;/* FUNCTION IS GET (A)CDS  */
         LA    @08,LOCALTSL                                        0477
         MVI   TSLFUNCT(@08),X'03'                                 0477
*       ADDR(LOCALTSS)->TSLGSMD=TSLSSMD;/* SYSMOD NAME TO SEARCH FOR */
         LA    @08,LOCALTSS                                        0478
         L     @15,@PC00001                                        0478
         L     @14,TSLPMLAD(,@15)                                  0478
         MVC   TSLGSMD(7,@08),TSLSSMD(@14)                         0478
*       ADDR(LOCALTSS)->TSLGDSID=TBLXCDSI;/* DSID OF TARGET (A)CDS   */
         L     @01,TSLTBLXP(,@15)                                  0479
         MVC   TSLGDSID(1,@08),TBLXCDSI(@01)                       0479
*       ADDR(LOCALTSS)->TSLGOPTF=TSLSOPTF;/* COPY OPTIONS FLAGS      */
         MVC   TSLGOPTF(1,@08),TSLSOPTF(@14)                       0480
*       IF TSLSIOPP^=ZERO THEN      /* WAS AN IOP SUPPLIED BY CALLER?*/
         L     @15,TSLSIOPP(,@14)                                  0481
         LTR   @15,@15                                             0481
         BZ    @RF00481                                            0481
*         DO;                       /* YES, USE IT                   */
*           ADDR(LOCALTSS)->TSLGIOPP=TSLSIOPP;/* COPY IOP PTR        */
         ST    @15,TSLGIOPP(,@08)                                  0483
*         END;                      /*                       @Z67SP00*/
*       ELSE                        /* NOT SUPPLIED, USE A LOCAL IOP */
*         DO;                       /*                       @Z67SP00*/
         B     @RC00481                                            0485
@RF00481 DS    0H                                                  0486
*           ADDR(LOCALTSS)->TSLGIOPP=ADDR(TSBIOPF);/* COPY IOP PTR   */
         LA    @08,LOCALTSS                                        0486
         LA    @15,TSBIOPF                                         0486
         ST    @15,TSLGIOPP(,@08)                                  0486
*         END;                      /*                       @Z67SP00*/
*       CALL HMASMTSB(LOCALTSL);                                   0488
@RC00481 LA    @08,LOCALTSL                                        0488
         ST    @08,@AL00001                                        0488
         LA    @01,@AL00001                                        0488
         L     @15,@CA00028                                        0488
         BALR  @14,@15                                             0488
*       CICRC=ADDR(LOCALTSL)->TSLRETRN;/* RETURN CODE IS ICT SEARCH
*                                      RC                            */
         LA    @08,LOCALTSL                                        0489
         SLR   CICRC,CICRC                                         0489
         IC    CICRC,TSLRETRN(,@08)                                0489
*       IF CICRC=TSLFOUND THEN      /* WAS THE ENTRY FOUND?          */
         LTR   CICRC,CICRC                                         0490
         BNZ   @RF00490                                            0490
*         DO;                                                      0491
*           TSLSCFND=ON;            /* SYSMOD FOUND ON CDS FLAG      */
         L     @08,@PC00001                                        0492
         L     @08,TSLPMLAD(,@08)                                  0492
         OI    TSLSCFND(@08),B'10000000'                           0492
*           CALL CDSCHK(ADDR(LOCALTSS)->TSLGIOPP);                 0493
         LA    @08,LOCALTSS                                        0493
         LA    @08,TSLGIOPP(,@08)                                  0493
         ST    @08,@AL00001                                        0493
         LA    @01,@AL00001                                        0493
         BAL   @14,CDSCHK                                          0493
*           RFY                                                    0494
*             RTNCODE RSTD;                                        0494
*           RFY                                                    0495
*             RTNCODE UNRSTD;                                      0495
*         END;                                                     0496
*     END;                          /*                               */
@RF00490 DS    0H                                                  0498
*   RETURN CODE(CICRC);             /*                               */
@RF00474 LR    @15,CICRC                                           0498
         L     @14,@SA00005                                        0498
         LM    @00,@12,@SA00005+8                                  0498
         BR    @14                                                 0498
*   RFY                                                            0499
*     TSLPARMS BASED;                                              0499
*   RFY                                                            0500
*     TBLXPARM BASED;                                              0500
*   END CKICTCDS;                   /*                               */
*                                                                  0502
*   /*****************************************************************/
*   /*                                                               */
*   /* CDSCHK - SET TSL FLAGS BASED ON IOP FLAGS                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0502
*CDSCHK:                                                           0502
*   PROC(CDSCIOPP);                 /* POINTER TO THE IOP            */
CDSCHK   STM   @14,@12,12(@13)                                     0502
         MVC   @PC00006(4),0(@01)                                  0502
*   DCL                                                            0503
*     CDSCIOPP PTR(31);             /* IOP TO BE CHECKED             */
*   DCL                                                            0504
*     CDSCHKRC FIXED(15);           /* LOCAL RETURN CODE             */
*   RFY                                                            0505
*     TSLPARMS BASED(ADDR(PARM1));                                 0505
*   RESPECIFY                                                      0506
*     HMASMIOP BASED(CDSCIOPP);     /* ADDRESS IOP                   */
*   CDSCHKRC=ZERO;                  /* INITIALIZE RETURN PARM        */
         SLR   CDSCHKRC,CDSCHKRC                                   0507
*   IF IOPDUMMP=OFF                 /* "DUMMY" ENTRY ?               */
*     THEN                                                         0508
         L     @08,@PC00006                                        0508
         L     @08,CDSCIOPP(,@08)                                  0508
         TM    IOPDUMMP(@08),B'00000100'                           0508
         BNZ   @RF00508                                            0508
*     DO;                           /* NO,                           */
*       IF IOPERROR=ON THEN         /* SYSMOD IN ERROR?              */
         TM    IOPERROR(@08),B'00010000'                           0510
         BNO   @RF00510                                            0510
*         DO;                                                      0511
*           TSLSCERR=ON;            /* IN ERROR OUTPUT FLAG          */
         L     @08,@PC00001                                        0512
         L     @08,TSLPMLAD(,@08)                                  0512
         OI    TSLSCERR(@08),B'00000010'                           0512
*         END;                                                     0513
*       ELSE                        /* NOT IN ERROR                  */
*         DO;                                                      0514
         B     @RC00510                                            0514
@RF00510 DS    0H                                                  0515
*           IF IOPSBYP=ON THEN      /* SUP ENTRY?                    */
         L     @08,@PC00006                                        0515
         L     @08,CDSCIOPP(,@08)                                  0515
         TM    IOPSBYP(@08),B'10000000'                            0515
         BNO   @RF00515                                            0515
*             DO;                                                  0516
*               TSLSCSUP=ON;        /* MARK AS SUP'ED                */
         L     @08,@PC00001                                        0517
         L     @08,TSLPMLAD(,@08)                                  0517
         OI    TSLSCSUP(@08),B'00100000'                           0517
*             END;                                                 0518
*           ELSE                    /* NOT A SUP                     */
*             DO;                                                  0519
         B     @RC00515                                            0519
@RF00515 DS    0H                                                  0520
*               IF IOPDBYP=ON THEN  /* DELETE ENTRY?                 */
         L     @08,@PC00006                                        0520
         L     @08,CDSCIOPP(,@08)                                  0520
         TM    IOPDBYP(@08),B'01000000'                            0520
         BNO   @RF00520                                            0520
*                 DO;                                              0521
*                   TSLSCDEL=ON;    /* MARK AS DELETED               */
         L     @08,@PC00001                                        0522
         L     @08,TSLPMLAD(,@08)                                  0522
         OI    TSLSCDEL(@08),B'00010000'                           0522
*                 END;                                             0523
*               ELSE                /* NOT A SUP                     */
*                 DO;                                              0524
         B     @RC00520                                            0524
@RF00520 DS    0H                                                  0525
*                   TSLSCOK=ON;     /* ENTRY FOUND AND IS OK         */
         L     @08,@PC00001                                        0525
         L     @08,TSLPMLAD(,@08)                                  0525
         OI    TSLSCOK(@08),B'01000000'                            0525
*                 END;                                             0526
*             END;                                                 0527
*         END;                                                     0528
*     END;                                                         0529
*   ELSE                            /* 'DUMMY' ENTRY                 */
*     DO;                                                          0530
         B     @RC00508                                            0530
@RF00508 DS    0H                                                  0531
*       IF IOPERROR=ON THEN         /* DUMMY AND IN ERROR?           */
         L     @08,@PC00006                                        0531
         L     @08,CDSCIOPP(,@08)                                  0531
         TM    IOPERROR(@08),B'00010000'                           0531
         BNO   @RF00531                                            0531
*         DO;                                                      0532
*           TSLSCERR=ON;            /* IN ERROR - NOT CLEAR THIS CAN
*                                      HAPPEN                        */
         L     @08,@PC00001                                        0533
         L     @08,TSLPMLAD(,@08)                                  0533
         OI    TSLSCERR(@08),B'00000010'                           0533
*         END;                                                     0534
*       ELSE                        /* NOT IN ERROR          @Z67SP00*/
*         DO;                       /*                       @Z67SP00*/
         B     @RC00531                                            0535
@RF00531 DS    0H                                                  0536
*           IF IOPSBYP=ON           /* "DUMMY" SUP ?                 */
*             THEN                                                 0536
         L     @08,@PC00006                                        0536
         L     @08,CDSCIOPP(,@08)                                  0536
         TM    IOPSBYP(@08),B'10000000'                            0536
         BNO   @RF00536                                            0536
*             DO;                                                  0537
*                                                                  0537
*               /*****************************************************/
*               /*                                                   */
*               /* NOTE THAT UNLIKE RELEASE 3, WE ARE NOT CHECKING   */
*               /*                                             STATUS*/
*               /* OF THE SUP'OR                                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0538
*               TSLSCSUP=ON;        /* SUP'ED SYSMOD                 */
         L     @08,@PC00001                                        0538
         L     @08,TSLPMLAD(,@08)                                  0538
         OI    TSLSCSUP(@08),B'00100000'                           0538
*             END;                                                 0539
*           ELSE                    /* NOT A DUMMY SUP               */
*             DO;                                                  0540
         B     @RC00536                                            0540
@RF00536 DS    0H                                                  0541
*               IF IOPDBYP=ON THEN  /* IS IT A DUMMY DELETE ENTRY?   */
         L     @08,@PC00006                                        0541
         L     @08,CDSCIOPP(,@08)                                  0541
         TM    IOPDBYP(@08),B'01000000'                            0541
         BNO   @RF00541                                            0541
*                 DO;                                              0542
*                   TSLSCDEL=ON;    /* MARK AS DELETED               */
         L     @08,@PC00001                                        0543
         L     @08,TSLPMLAD(,@08)                                  0543
         OI    TSLSCDEL(@08),B'00010000'                           0543
*                 END;                                             0544
*               ELSE                                               0545
*                 DO;                                              0545
         B     @RC00541                                            0545
@RF00541 DS    0H                                                  0546
*                   TSLSCOK=ON;     /* SYSMOD IS OK                  */
         L     @08,@PC00001                                        0546
         L     @08,TSLPMLAD(,@08)                                  0546
         OI    TSLSCOK(@08),B'01000000'                            0546
*                 END;                                             0547
*             END;                                                 0548
*         END;                                                     0549
*     END;                                                         0550
*   RETURN;                                                        0551
@EL00006 DS    0H                                                  0551
@EF00006 DS    0H                                                  0551
@ER00006 LM    @14,@12,12(@13)                                     0551
         BR    @14                                                 0551
*   RFY                                                            0552
*     TSLPARMS BASED;                                              0552
*   RFY                                                            0553
*     TBLXPARM BASED;                                              0553
*   END CDSCHK;                                                    0554
         B     @EL00006                                            0554
*                                                                  0555
*   /*****************************************************************/
*   /*                                                               */
*   /* CLRPASS -                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0555
*CLRPASS:                                                          0555
*   PROC;                                                          0555
CLRPASS  STM   @14,@12,12(@13)                                     0555
*   DCL                                                            0556
*     CLRPRC FIXED(15);             /* RETURN CODE                   */
*   DCL                                                            0557
*     CLRPPTFX FIXED(15);           /* ICT PTF INDEX                 */
*   DCL                                                            0558
*     CLRPMODX FIXED(15);           /* ICT MOD INDEX                 */
*   DCL                                                            0559
*     CLRPLMDX FIXED(15);           /* ICT LMOD INDEX                */
*   RFY                                                            0560
*     ICTPTF BASED(CCAICPTF);                                      0560
*   RFY                                                            0561
*     ICTMOD BASED(CCAICMOD);                                      0561
*   RFY                                                            0562
*     ICTLMOD BASED(CCAICLMD);                                     0562
*   CLRPRC=ZERO;                    /* CLEAR THE RETURN CODE         */
         SLR   CLRPRC,CLRPRC                                       0563
*   DO CLRPPTFX=1 BY 1              /* LOOP THRU ALL ICT PTF ENTRIES */
*         WHILE(ICTPEND(CLRPPTFX)^=ICTENDNT);/*                      */
         LA    CLRPPTFX,1                                          0564
         B     @DE00564                                            0564
@DL00564 DS    0H                                                  0565
*     ICTPFLGA(CLRPPTFX)=''B;       /* TURN PASS FLAGS OFF           */
         LR    @08,CLRPPTFX                                        0565
         MH    @08,@CH02096                                        0565
         L     @15,@CA00147                                        0565
         L     @01,CCAICPTF-HMASMCCA(,@15)                         0565
         ALR   @01,@08                                             0565
         AL    @01,@CF02128                                        0565
         MVI   ICTPFLGA-16(@01),X'00'                              0565
*   END;                            /*                               */
         AH    CLRPPTFX,@CH00048                                   0566
@DE00564 LR    @08,CLRPPTFX                                        0566
         MH    @08,@CH02096                                        0566
         L     @15,@CA00147                                        0566
         L     @01,CCAICPTF-HMASMCCA(,@15)                         0566
         AL    @01,@CF02115                                        0566
         L     @08,ICTPEND(@08,@01)                                0566
         CL    @08,ICTENDNT                                        0566
         BNE   @DL00564                                            0566
*   DO CLRPMODX=1 BY 1              /* LOOP THRU ALL MOD ENTRIES     */
*         WHILE(ICTMEND(CLRPMODX)^=ICTENDNT);/*                      */
         LA    CLRPMODX,1                                          0567
         B     @DE00567                                            0567
@DL00567 DS    0H                                                  0568
*     ICTMPASS(CLRPMODX)=OFF;       /* TURN PASS FLAG OFF            */
         LR    @08,CLRPMODX                                        0568
         MH    @08,@CH02097                                        0568
         L     @15,@CA00147                                        0568
         L     @01,CCAICMOD-HMASMCCA(,@15)                         0568
         ALR   @01,@08                                             0568
         AL    @01,@CF02129                                        0568
         NI    ICTMPASS-12(@01),B'01111111'                        0568
*   END;                            /*                               */
         AH    CLRPMODX,@CH00048                                   0569
@DE00567 LR    @08,CLRPMODX                                        0569
         MH    @08,@CH02097                                        0569
         L     @15,@CA00147                                        0569
         L     @01,CCAICMOD-HMASMCCA(,@15)                         0569
         AL    @01,@CF02130                                        0569
         L     @08,ICTMEND(@08,@01)                                0569
         CL    @08,ICTENDNT                                        0569
         BNE   @DL00567                                            0569
*   DO CLRPLMDX=1 BY 1              /* LOOP THRU ALL LMOD ENTRIES    */
*         WHILE(ICTLEND(CLRPLMDX)^=ICTENDNT);/*                      */
         LA    CLRPLMDX,1                                          0570
         B     @DE00570                                            0570
@DL00570 DS    0H                                                  0571
*     ICTLPASS(CLRPLMDX)=OFF;       /* TURN PASS FLAG OFF            */
         LR    @08,CLRPLMDX                                        0571
         MH    @08,@CH01106                                        0571
         L     @15,@CA00147                                        0571
         L     @01,CCAICLMD-HMASMCCA(,@15)                         0571
         ALR   @01,@08                                             0571
         AL    @01,@CF02131                                        0571
         NI    ICTLPASS-8(@01),B'11111011'                         0571
*   END;                            /*                               */
         AH    CLRPLMDX,@CH00048                                   0572
@DE00570 LR    @08,CLRPLMDX                                        0572
         MH    @08,@CH01106                                        0572
         L     @15,@CA00147                                        0572
         L     @01,CCAICLMD-HMASMCCA(,@15)                         0572
         AL    @01,@CF02133                                        0572
         L     @08,ICTLEND(@08,@01)                                0572
         CL    @08,ICTENDNT                                        0572
         BNE   @DL00570                                            0572
*   RETURN CODE(CLRPRC);            /* RETURN WITH THE RETURN CODE   */
         LR    @15,CLRPRC                                          0573
         L     @14,12(,@13)                                        0573
         LM    @00,@12,20(@13)                                     0573
         BR    @14                                                 0573
*   RFY                                                            0574
*     ICTPTF BASED;                                                0574
*   RFY                                                            0575
*     ICTMOD BASED;                                                0575
*   RFY                                                            0576
*     ICTLMOD BASED;                                               0576
*   END CLRPASS;                    /*                               */
*                                                                  0578
*   /*****************************************************************/
*   /*                                                               */
*   /* FNDSUBN - FIND SUBENTRY IN THE IOP SUB-ENTRY LIST             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0578
*FNDSUBN:                                                          0578
*   PROC;                           /*                               */
FNDSUBN  STM   @14,@12,12(@13)                                     0578
*   DCL                                                            0579
*     1 FSNFLAGS BIT(8),            /* LOCAL CONTROL FLAGS           */
*      2 FSNFOUND BIT(1),           /* SUB ENTRY FOUND               */
*      2 * BIT(7);                  /* UNSUED                        */
*   DCL                                                            0580
*     FSNRC FIXED(15);              /* RETURN CODE                   */
*   DCL                                                            0581
*     FSNENTX FIXED(15);            /* IOP SUB-ENTRY INDEX           */
*   DCL                                                            0582
*     FSNENT1P PTR(31);             /* PTR TO START OF SEARCH ENTRY  */
*   RFY                                                            0583
*     HMASMIOP BASED(FSNENT1P       /*                               */
*         -(LENGTH(HMASMIOP)+LENGTH(IOPPTFNT)));                   0583
*   RFY                                                            0584
*     TSLPARMS BASED(ADDR(PARM1));                                 0584
*   IF TSLEONXT=ON THEN             /* FIND NEXT?                    */
         L     @08,@PC00001                                        0585
         L     @08,TSLPMLAD(,@08)                                  0585
         TM    TSLEONXT(@08),B'10000000'                           0585
         BNO   @RF00585                                            0585
*     DO;                                                          0586
*       FSNENT1P=TSLEFNDP+LENGTH(IOPENTNT);/* START AT NEXT ENTRY    */
         LA    FSNENT1P,9                                          0587
         AL    FSNENT1P,TSLEFNDP(,@08)                             0587
*     END;                                                         0588
*   ELSE                                                           0589
*     DO;                                                          0589
         B     @RC00585                                            0589
@RF00585 DS    0H                                                  0590
*       FSNENT1P=TSLEBGNP;          /* START SEARCH AT BEGINNING     */
         L     @08,@PC00001                                        0590
         L     @08,TSLPMLAD(,@08)                                  0590
         L     FSNENT1P,TSLEBGNP(,@08)                             0590
*     END;                                                         0591
*   FSNRC=TSLNTFND;                 /* CLEAR THE RETURN CODE         */
@RC00585 LA    FSNRC,4                                             0592
*   FSNFLAGS=''B;                   /* CLEAR CONTROL FLAGS           */
         MVI   FSNFLAGS,X'00'                                      0593
*   DO FSNENTX=1 BY 1               /* SEARCH ALL ENTRIES IN THE IOP */
*         WHILE(FSNFOUND=OFF        /* FOR A MATCH                   */
*         &IOPPTFND(FSNENTX)^=IOPEOLST);/*                           */
         LA    FSNENTX,1                                           0594
         B     @DE00594                                            0594
@DL00594 DS    0H                                                  0595
*     IF IOPPIND(FSNENTX)=TSLETYPE  /* MATCHING TYPE ...             */
*         &IOPENTST(FSNENTX)=TSLEVER# THEN/* ... AND STATUS?         */
         LR    @08,FSNENTX                                         0595
         MH    @08,@CH00146                                        0595
         LR    @05,FSNENT1P                                        0595
         SH    @05,@CH02099                                        0595
         L     @15,@PC00001                                        0595
         L     @15,TSLPMLAD(,@15)                                  0595
         SLR   @14,@14                                             0595
         IC    @14,IOPPIND-9(@08,@05)                              0595
         SLR   @07,@07                                             0595
         IC    @07,TSLETYPE(,@15)                                  0595
         CR    @14,@07                                             0595
         BNE   @RF00595                                            0595
         SLR   @14,@14                                             0595
         IC    @14,IOPENTST-9(@08,@05)                             0595
         SLR   @07,@07                                             0595
         IC    @07,TSLEVER#(,@15)                                  0595
         CR    @14,@07                                             0595
         BNE   @RF00595                                            0595
*       DO;                         /*                               */
*         IF TSLENMEP^=ZERO THEN    /* NAME SUPPLIED?                */
         L     @15,TSLENMEP(,@15)                                  0597
         LTR   @15,@15                                             0597
         BZ    @RF00597                                            0597
*           DO;                     /*                               */
*             IF TSLENMEP->IOPENTNM(1)/* DOES NAME MATCH?            */
*                 =IOPENTNM(FSNENTX) THEN                          0599
         ALR   @05,@08                                             0599
         CLC   IOPENTNM(7,@15),IOPENTNM-9(@05)                     0599
         BNE   @RF00599                                            0599
*               DO;                 /* YES,                          */
*                 FSNFOUND=ON;      /* MATCH FOUND                   */
         OI    FSNFOUND,B'10000000'                                0601
*               END;                                               0602
*             ELSE                                                 0603
*               ;                   /* NO NAME MATCH                 */
@RF00599 DS    0H                                                  0604
*           END;                    /*                               */
*         ELSE                      /* NO NAME CHECK                 */
*           DO;                                                    0605
         B     @RC00597                                            0605
@RF00597 DS    0H                                                  0606
*             FSNFOUND=ON;          /* MATCH FOUND                   */
         OI    FSNFOUND,B'10000000'                                0606
*           END;                                                   0607
*         IF FSNFOUND=ON THEN       /* FOUND?                        */
@RC00597 TM    FSNFOUND,B'10000000'                                0608
         BNO   @RF00608                                            0608
*           DO;                     /*                               */
*             FSNRC=TSLFOUND;       /* NOT FOUND RC                  */
         SLR   FSNRC,FSNRC                                         0610
*             TSLEFNDP=ADDR(IOPENTNT(FSNENTX));/* RETURN FOUND ADDR  */
         L     @08,@PC00001                                        0611
         L     @08,TSLPMLAD(,@08)                                  0611
         LR    @05,FSNENTX                                         0611
         MH    @05,@CH00146                                        0611
         AL    @05,@CF02134                                        0611
         LA    @05,IOPENTNT-172(@05,FSNENT1P)                      0611
         ST    @05,TSLEFNDP(,@08)                                  0611
*           END;                    /*                               */
*         ELSE                                                     0613
*           ;                       /*                               */
@RF00608 DS    0H                                                  0614
*       END;                        /*                               */
*     ELSE                                                         0615
*       ;                           /* NO MATCH, CONTINUE SEARCH     */
@RF00595 DS    0H                                                  0616
*   END;                            /* END OF SEARCH LOOP            */
         AH    FSNENTX,@CH00048                                    0616
@DE00594 TM    FSNFOUND,B'10000000'                                0616
         BNZ   @DC00594                                            0616
         LR    @08,FSNENTX                                         0616
         MH    @08,@CH00146                                        0616
         AL    @08,@CF02134                                        0616
         SLR   @05,@05                                             0616
         IC    @05,IOPPTFND-172(@08,FSNENT1P)                      0616
         CH    @05,@CH00721                                        0616
         BNE   @DL00594                                            0616
@DC00594 DS    0H                                                  0617
*   RETURN CODE(FSNRC);             /* RETURN WITH THE RETURN CODE   */
         LR    @15,FSNRC                                           0617
         L     @14,12(,@13)                                        0617
         LM    @00,@12,20(@13)                                     0617
         BR    @14                                                 0617
*   RFY                                                            0618
*     HMASMIOP BASED;                                              0618
*   RFY                                                            0619
*     TSLPARMS BASED;                                              0619
*   END FNDSUBN;                    /*                               */
*                                                                  0621
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCFM - ISSUE SMP FUNCTION HALTED BECAUSE APPLICABLE FUNCTION*/
*   /* SYSMOD FAILED                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0621
*FUNCFM:                                                           0621
*   PROC;                                                          0621
FUNCFM   STM   @14,@12,@SA00009                                    0621
*   DCL                                                            0622
*     FUNCRC FIXED(15);             /* LOCAL RETURN CODE             */
*   RFY                                                            0623
*     TBLXPARM BASED(TSLTBLXP);                                    0623
*   RFY                                                            0624
*     TSLPARMS BASED(ADDR(PARM1));                                 0624
*   FUNCRC=STOPSMD;                 /* RETURN CODE IS ATLEAST STOP 0625
*                                      SYSMOD                        */
         LA    FUNCRC,8                                            0625
*   IF TSLMTYPE=IOPPFUNC THEN       /* DID A FUNCTION FAIL?          */
         L     @08,@PC00001                                        0626
         L     @03,TSLPMLAD(,@08)                                  0626
         CLI   TSLMTYPE(@03),4                                     0626
         BNE   @RF00626                                            0626
*     DO;                           /* YES,                          */
*       FUNCRC=STOPFUNC;            /* CONVERT RETURN CODE TO STOP 0628
*                                      FUNCTION                      */
*                                                                  0628
         LA    FUNCRC,12                                           0628
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MESSAGE 'HMA370I XXXXXXXX PROCESSING TERMINATED     */
*       /* BECAUSE FUNCTION SYSMOD XXXXXXX FAILED'                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0629
*       DO;                         /* HMASMPMG M1(HMA370I)TYPE(SEV)V
*                                      AR(TBLXFUNC,TSLMSMD)TARGET(SYS
*                                      OUT,LOG)                      */
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */
         XC    HMASMMGP(28),HMASMMGP                               0630
*         MGPMGNO1=HMA370I;         /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01806                                0631
*         MGPTYPE=MGPSEV;           /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'04'                                       0632
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0634
*         MGPVARPT(1)=ADDR(TBLXFUNC);/* SET VARIABLE PTR             */
         L     @08,TSLTBLXP(,@08)                                  0635
         LA    @08,TBLXFUNC(,@08)                                  0635
         ST    @08,MGPVARPT                                        0635
*         MGPVARPT(2)=ADDR(TSLMSMD);/* SET VARIABLE PTR              */
         LA    @08,TSLMSMD(,@03)                                   0636
         ST    @08,MGPVARPT+4                                      0636
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */
         LA    @08,HMASMMGP                                        0637
         ST    @08,@AL00001                                        0637
         L     @15,@CV01796                                        0637
         LA    @01,@AL00001                                        0637
         BALR  @14,@15                                             0637
*       END;                        /*                               */
*     END;                                                         0639
*   ELSE                                                           0640
*     ;                             /* NOT A FUNCTION TYPE SYSMOD    */
@RF00626 DS    0H                                                  0641
*   RETURN CODE(FUNCRC);            /* RETURN W/ RC                  */
         LR    @15,FUNCRC                                          0641
         L     @14,@SA00009                                        0641
         LM    @00,@12,@SA00009+8                                  0641
         BR    @14                                                 0641
*   RFY                                                            0642
*     TBLXPARM BASED;                                              0642
*   RFY                                                            0643
*     TSLPARMS BASED;                                              0643
*   END FUNCFM;                                                    0644
*                                                                  0645
*/********************************************************************/
*/*                                                                  */
*/* ASSUMTION: IF SYSMOD IS PREREQ'ED BY OTHER SYSMODS THEY WILL ALL */
*/*     BE IN THE ICT.                                               */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/* SUP'ED SYSMODS:                                                  */
*/*     - ALL SYSMODS IN THE SUPBY LIST MUST BE IN THE ICT AND OK    */
*/*       (TPR)                                                      */
*/*     - IF ANY SUP'ING SYSMOD FAILS, FAIL ALL OTHER SYSMODS THAT   */
*/*       ALSO SUP SYSMODS IN THE FAILING SYSMOD'S SUP LIST.         */
*/*       ALSO FAIL THE SUP'ED SYSMOD                                */
*/*       (TSB,CPL)                                                  */
*/*                                                                  */
*/* PRE'ING SYSMODS:                                                 */
*/*     - IF A PRE'ED SYSMOD FAILS, ALL PRE'ING SYSMODS ARE FAILED   */
*/*       (TSB,CPL)                                                  */
*/*                                                                  */
*/* REQ SYSMODS:                                                     */
*/*     - ALL SYSMODS THAT REQ A FAILED SYSMOD ARE FAILED.           */
*/*       (TSB,CPL)                                                  */
*/*                                                                  */
*/* IF REQ SYSMODS:                                                  */
*/*     - ALL SYSMODS THAT IREQ A FAILED SYSMOD ARE FAILED.          */
*/*       (TSB,CPL)                                                  */
*/*                                                                  */
*/* FMID SYSMODS:                                                    */
*/*     - ANY SYSMOD THAT FMID'S A SYSMOD THAT FAILS IS FAILED       */
*/*       (TSB,CPL)                                                  */
*/*                                                                  */
*/*                                                                  */
*/* NOTE: THERE SEEMS TO BE NO REASON TO RESTORE A SYSMOD IF THE     */
*/*       IREQ IS NOT IN THE ICT BUT IS ACCEPTED.  LIKEWISE, IF A    */
*/*       ONE WAY REQ IS BEING RESTORED BUT THE REQ'ED SYSMOD        */
*/*       IS ACCEPTED.  HOWEVER, THIS IS NOT DONE TO CONFORM TO THE  */
*/*       FPFS                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0645
*RESTCHK:                                                          0645
*   PROC;                                                          0645
RESTCHK  STM   @14,@12,@SA00010                                    0645
*   DCL                                                            0646
*     RSTCRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0647
*     RSTC1PRC FIXED(15);           /* RETURN CODE FOR THE CURRENT 0647
*                                      SYSMOD                        */
*   DCL                                                            0648
*     1 RSTCFLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 RSTCDONE BIT(1),           /* NO FURTHER CHECKING         0648
*                                      (RECURSIONS) NEEDED           */
*      2 RSTCHDRM BIT(1),           /* HEADER MESSAGE (HMA302) ISSUED*/
*      2 * BIT(6);                  /* UNUSED                        */
*   DCL                                                            0649
*     RSTCX1 FIXED(31);             /* LOOP COUNTER                  */
*   DCL                                                            0650
*     RSTCX2 FIXED(31);             /* FMID SEARCH LOOP COUNTER      */
*   DCL                                                            0651
*     RSTCTXT@ PTR(31);             /* PTR TO THE ERROR MESSAGE TEXT
*                                      FOR HMA359                    */
*   DCL                                                            0652
*     CANDIDTE CHAR(1) CONSTANT('C');/* CANDIDATE                    */
*   DCL                                                            0653
*     RSTCSUPI CONSTANT(1);         /* INCREAMENT INDICATOR FOR SUP'S*/
*   DCL                                                            0654
*     RSTCREQI CONSTANT(1);         /* INCREAMENT INDICATOR FOR REQ'S*/
*   DCL                                                            0655
*     RSTCPREI CONSTANT(1);         /* INCREAMENT INDICATOR FOR PRE'S*/
*   DCL                                                            0656
*     RSTCIRQI CONSTANT(2);         /* INCREAMENT INDICATOR FOR ++IF
*                                      REQ'S                         */
*   RFY                                                            0657
*     TBLXPARM BASED(TSLTBLXP);                                    0657
*   RFY                                                            0658
*     TSLPARMS BASED(ADDR(PARM1));                                 0658
*   RFY                                                            0659
*     ICTPTF BASED(CCAICPTF);                                      0659
*   RSTCRC=ZERO;                    /* CLEAR RETURN CODE             */
         SLR   RSTCRC,RSTCRC                                       0660
*   RSTCDONE=OFF;                   /* CLEAR COMPLETE FLAG SO THAT 0661
*                                      ATLEAST ONE PASS IS MADE      */
         NI    RSTCDONE,B'01111111'                                0661
*   DO WHILE(RSTCDONE=OFF           /* LOOP UNTIL THE STATUS OF NO 0662
*                                      SYSMOD CHANGES                */
*         &RSTCRC<STOPFUNC);        /* AND RETURN CODE IS LESS THAN
*                                      STOP SMP FUNCT                */
         B     @DE00662                                            0662
@DL00662 DS    0H                                                  0663
*     RSTCDONE=ON;                  /* ASSUME COMPLETETION: IF ANY 0663
*                                      NON-NOGO SYSMOD IS MARKED NOGO
*                                      BY 'RSTCNOGO' ROUTINE THIS  0663
*                                      FLAG WILL BE CLEARED          */
         OI    RSTCDONE,B'10000000'                                0663
*     DO RSTCX1=1 BY 1              /* LOOP THRU ALL ICT SYSMOD    0664
*                                      ENTRIES ONCE                  */
*           WHILE(ICTPEND(RSTCX1)^=ICTENDNT/*                        */
*           &RSTCRC<STOPFUNC);                                     0664
         LA    RSTCX1,1                                            0664
         B     @DE00664                                            0664
@DL00664 DS    0H                                                  0665
*       RSTC1PRC=ZERO;              /* CLEAR RETURN CODE FOR CURRENT
*                                      SYSMOD                        */
         SLR   RSTC1PRC,RSTC1PRC                                   0665
*       RSTCHDRM=OFF;               /* HEADER MESSAGE NOT YET ISSUED
*                                      FOR THE SYSMOD                */
         NI    RSTCHDRM,B'10111111'                                0666
*       IF ICTPNOGO(RSTCX1)^=ON THEN/* IS THE CURRENT SYSMOD OK?     */
         LR    @08,RSTCX1                                          0667
         MH    @08,@CH02096                                        0667
         L     @05,@CA00147                                        0667
         L     @05,CCAICPTF-HMASMCCA(,@05)                         0667
         ST    @08,@TF00001                                        0667
         ALR   @08,@05                                             0667
         AL    @08,@CF02117                                        0667
         TM    ICTPNOGO-8(@08),B'01000000'                         0667
         BO    @RF00667                                            0667
*         DO;                       /* YES,                          */
*                                                                  0668
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR SUP FAILURES                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0669
*           RSTCTXT@=ADDR(TXTSUPNG);/* TEXT IS 'SUPING' FOR HMA359   */
         LA    RSTCTXT@,@CC01812                                   0669
*           CALL RSTLST2(ICTPTF(RSTCX1),/*                           */
*               ADDR(ICTPSCHN(RSTCX1))-ADDR(ICTPTF(RSTCX1)));      0670
         L     @08,@TF00001                                        0670
         AL    @08,@CF02115                                        0670
         LA    @08,ICTPTF(@08,@05)                                 0670
         ST    @08,@AL00001                                        0670
         L     @08,@TF00001                                        0670
         AL    @08,@CF02136                                        0670
         LA    @08,ICTPSCHN-72(@08,@05)                            0670
         L     @07,@TF00001                                        0670
         AL    @05,@CF02115                                        0670
         LA    @07,ICTPTF(@07,@05)                                 0670
         SLR   @08,@07                                             0670
         ST    @08,@AFTEMPS                                        0670
         LA    @08,@AFTEMPS                                        0670
         ST    @08,@AL00001+4                                      0670
         LA    @01,@AL00001                                        0670
         BAL   @14,RSTLST2                                         0670
*           RFY                                                    0671
*             RTNCODE RSTD;                                        0671
*           RSTC1PRC=MAX(RSTC1PRC,RTNCODE);/* SET RC                 */
         CR    RSTC1PRC,RTNCODE                                    0672
         BNL   *+6
         LR    RSTC1PRC,RTNCODE                                    0672
*           RFY                                                    0673
*             RTNCODE UNRSTD;                                      0673
*           RSTCTXT@=ADDR(TXTSUPED);/* TEXT IS 'SUPED' FOR HMA359    */
         LA    RSTCTXT@,@CC01814                                   0674
*           CALL RSTLST1(ICTPTF(RSTCX1),/* CURRENT SYSMOD ENTRY      */
*               ICTPSCHN(RSTCX1),   /* SUP CHAIN TO BE CHECKED       */
*               CANDIDTE,RSTCSUPI); /*                               */
         LR    @08,RSTCX1                                          0675
         MH    @08,@CH02096                                        0675
         L     @07,@CA00147                                        0675
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0675
         LA    @05,0(@08,@07)                                      0675
         AL    @05,@CF02115                                        0675
         ST    @05,@AL00001                                        0675
         AL    @07,@CF02136                                        0675
         LA    @08,ICTPSCHN-72(@08,@07)                            0675
         ST    @08,@AL00001+4                                      0675
         LA    @08,@CC02002                                        0675
         ST    @08,@AL00001+8                                      0675
         LA    @08,@CF00048                                        0675
         ST    @08,@AL00001+12                                     0675
         LA    @01,@AL00001                                        0675
         BAL   @14,RSTLST1                                         0675
*           RFY                                                    0676
*             RTNCODE RSTD;                                        0676
*           RSTC1PRC=MAX(RSTC1PRC,RTNCODE);/* SET RC                 */
         CR    RSTC1PRC,RTNCODE                                    0677
         BNL   *+6
         LR    RSTC1PRC,RTNCODE                                    0677
*           RFY                                                    0678
*             RTNCODE UNRSTD;                                      0678
*                                                                  0678
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR PREREQUISITE FAILURES IF A PRE'ING SYSMOD IS*/
*           /* NOGO THEN THE CURRENT SYSMOD IS NOGO                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0679
*           IF RSTC1PRC<STOPFUNC THEN/* NO SEVERE ERROR?             */
         CH    RSTC1PRC,@CH00033                                   0679
         BNL   @RF00679                                            0679
*             DO;                   /* YES,                          */
*               RSTCTXT@=ADDR(TXTPRE);/* TEXT IS 'PRE' FOR HMA359    */
         LA    RSTCTXT@,@CC01816                                   0681
*               CALL RSTLST1(ICTPTF(RSTCX1),/*                       */
*                   ICTPPCHN(RSTCX1),/*                              */
*                   ZERO,RSTCPREI); /*                               */
         LR    @08,RSTCX1                                          0682
         MH    @08,@CH02096                                        0682
         L     @07,@CA00147                                        0682
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0682
         LA    @05,0(@08,@07)                                      0682
         AL    @05,@CF02115                                        0682
         ST    @05,@AL00001                                        0682
         AL    @07,@CF02137                                        0682
         LA    @08,ICTPPCHN-76(@08,@07)                            0682
         ST    @08,@AL00001+4                                      0682
         LA    @08,@CF00130                                        0682
         ST    @08,@AL00001+8                                      0682
         LA    @08,@CF00048                                        0682
         ST    @08,@AL00001+12                                     0682
         LA    @01,@AL00001                                        0682
         BAL   @14,RSTLST1                                         0682
*               RFY                                                0683
*                 RTNCODE RSTD;                                    0683
*               RSTC1PRC=MAX(RSTC1PRC,RTNCODE);/* SET RC             */
         CR    RSTC1PRC,RTNCODE                                    0684
         BNL   *+6
         LR    RSTC1PRC,RTNCODE                                    0684
*               RFY                                                0685
*                 RTNCODE UNRSTD;                                  0685
*               RSTCTXT@=ADDR(TXTPRENG);/* TEXT IS 'PREING' FOR    0686
*                                      HMA359                        */
         LA    RSTCTXT@,@CC01818                                   0686
*               CALL RSTLST2(ICTPTF(RSTCX1),/* CURRENT SYSMOD ENTRY  */
*                   ADDR(ICTPPCHN(RSTCX1))-ADDR(ICTPTF(RSTCX1)));  0687
         LR    @08,RSTCX1                                          0687
         MH    @08,@CH02096                                        0687
         L     @07,@CA00147                                        0687
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0687
         LA    @05,0(@08,@07)                                      0687
         AL    @05,@CF02115                                        0687
         ST    @05,@AL00001                                        0687
         LA    @05,0(@08,@07)                                      0687
         AL    @05,@CF02137                                        0687
         AL    @07,@CF02115                                        0687
         LA    @08,ICTPTF(@08,@07)                                 0687
         SLR   @05,@08                                             0687
         ST    @05,@AFTEMPS                                        0687
         LA    @08,@AFTEMPS                                        0687
         ST    @08,@AL00001+4                                      0687
         LA    @01,@AL00001                                        0687
         BAL   @14,RSTLST2                                         0687
*               RFY                                                0688
*                 RTNCODE RSTD;                                    0688
*               RSTC1PRC=MAX(RSTC1PRC,RTNCODE);/* SET RC             */
         CR    RSTC1PRC,RTNCODE                                    0689
         BNL   *+6
         LR    RSTC1PRC,RTNCODE                                    0689
*               RFY                                                0690
*                 RTNCODE UNRSTD;                                  0690
*             END;                                                 0691
*                                                                  0691
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR REQUISITE FAILURES                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0692
*           IF RSTC1PRC<STOPFUNC THEN/* NO SEVERE ERROR?             */
@RF00679 CH    RSTC1PRC,@CH00033                                   0692
         BNL   @RF00692                                            0692
*             DO;                   /* YES,                          */
*               RSTCTXT@=ADDR(TXTREQ);/* TEXT IS 'REQ' FOR HMA359    */
         LA    RSTCTXT@,@CC01820                                   0694
*               CALL RSTLST2(ICTPTF(RSTCX1),/* CURRENT SYSMOD ENTRY  */
*                   ADDR(ICTPRCHN(RSTCX1))-ADDR(ICTPTF(RSTCX1)));  0695
         LR    @08,RSTCX1                                          0695
         MH    @08,@CH02096                                        0695
         L     @07,@CA00147                                        0695
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0695
         LA    @05,0(@08,@07)                                      0695
         AL    @05,@CF02115                                        0695
         ST    @05,@AL00001                                        0695
         LA    @05,0(@08,@07)                                      0695
         AL    @05,@CF02138                                        0695
         AL    @07,@CF02115                                        0695
         LA    @08,ICTPTF(@08,@07)                                 0695
         SLR   @05,@08                                             0695
         ST    @05,@AFTEMPS                                        0695
         LA    @08,@AFTEMPS                                        0695
         ST    @08,@AL00001+4                                      0695
         LA    @01,@AL00001                                        0695
         BAL   @14,RSTLST2                                         0695
*               RFY                                                0696
*                 RTNCODE RSTD;                                    0696
*               RSTC1PRC=MAX(RSTC1PRC,RTNCODE);/* SET RC             */
         CR    RSTC1PRC,RTNCODE                                    0697
         BNL   *+6
         LR    RSTC1PRC,RTNCODE                                    0697
*               RFY                                                0698
*                 RTNCODE UNRSTD;                                  0698
*             END;                                                 0699
*                                                                  0699
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR ++IF REQUISITE FAILURES                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0700
*           IF RSTC1PRC<STOPFUNC THEN/* NO SEVERE ERROR?             */
@RF00692 CH    RSTC1PRC,@CH00033                                   0700
         BNL   @RF00700                                            0700
*             DO;                   /* YES,                          */
*               RSTCTXT@=ADDR(TXTIFREQ);/* TEXT IS 'IFREQ' FOR HMA359*/
         LA    RSTCTXT@,@CC01822                                   0702
*               CALL RSTLST2(ICTPTF(RSTCX1),/* CURRENT SYSMOD ENTRY  */
*                   ADDR(ICTPICHN(RSTCX1))-ADDR(ICTPTF(RSTCX1)));  0703
         LR    @08,RSTCX1                                          0703
         MH    @08,@CH02096                                        0703
         L     @07,@CA00147                                        0703
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0703
         LA    @05,0(@08,@07)                                      0703
         AL    @05,@CF02115                                        0703
         ST    @05,@AL00001                                        0703
         LA    @05,0(@08,@07)                                      0703
         AL    @05,@CF02139                                        0703
         AL    @07,@CF02115                                        0703
         LA    @08,ICTPTF(@08,@07)                                 0703
         SLR   @05,@08                                             0703
         ST    @05,@AFTEMPS                                        0703
         LA    @08,@AFTEMPS                                        0703
         ST    @08,@AL00001+4                                      0703
         LA    @01,@AL00001                                        0703
         BAL   @14,RSTLST2                                         0703
*               RFY                                                0704
*                 RTNCODE RSTD;                                    0704
*               RSTC1PRC=MAX(RSTC1PRC,RTNCODE);/* SET RC             */
         CR    RSTC1PRC,RTNCODE                                    0705
         BNL   *+6
         LR    RSTC1PRC,RTNCODE                                    0705
*               RFY                                                0706
*                 RTNCODE UNRSTD;                                  0706
*             END;                                                 0707
*                                                                  0707
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR FMID FAILURES                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0708
*           IF RSTC1PRC<STOPFUNC THEN/* NO SEVERE ERROR?             */
@RF00700 CH    RSTC1PRC,@CH00033                                   0708
         BNL   @RF00708                                            0708
*             DO;                   /* YES,                          */
*               RSTCTXT@=ADDR(TXTFMID);/* TEXT IS 'FMID' FOR HMA359  */
         LA    RSTCTXT@,@CC01824                                   0710
*               DO RSTCX2=1 BY 1    /* SEARCH THE ICT FOR FMIDING  0711
*                                      SYSMOD                        */
*                     WHILE(ICTPEND(RSTCX2)^=ICTENDNT/*              */
*                     &RSTC1PRC<STOPFUNC);                         0711
         LA    RSTCX2,1                                            0711
         B     @DE00711                                            0711
@DL00711 DS    0H                                                  0712
*                 IF ICTPFMID(RSTCX2)=ICTPTFS(RSTCX1)/* ICT ENTRY  0712
*                                      WITH FMID OF THE CURRENT    0712
*                                      SYSMOD?                       */
*                     &RSTCX1^=RSTCX2 THEN/*                         */
         LA    @08,116                                             0712
         LR    @01,RSTCX2                                          0712
         MR    @00,@08                                             0712
         L     @07,@CA00147                                        0712
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0712
         LR    @15,@08                                             0712
         MR    @14,RSTCX1                                          0712
         ST    @01,@TF00001                                        0712
         ALR   @01,@07                                             0712
         AL    @01,@CF02140                                        0712
         ST    @15,@TF00002                                        0712
         ALR   @15,@07                                             0712
         AL    @15,@CF02115                                        0712
         CLC   ICTPFMID-22(7,@01),ICTPTFS(@15)                     0712
         BNE   @RF00712                                            0712
         CR    RSTCX1,RSTCX2                                       0712
         BE    @RF00712                                            0712
*                   DO;             /* YES,                          */
*                     IF ICTPNOGO(RSTCX2)=ON THEN/* IS FMID SYSMOD 0714
*                                      NOGO                          */
         LR    @08,@07                                             0714
         AL    @08,@TF00001                                        0714
         AL    @08,@CF02117                                        0714
         TM    ICTPNOGO-8(@08),B'01000000'                         0714
         BNO   @RF00714                                            0714
*                       DO;         /* YES,                          */
*                         CALL RSTSMDM(ICTPTF(RSTCX1),/*             */
*                             ICTPTF(RSTCX2));/*                     */
         L     @08,@TF00002                                        0716
         AL    @08,@CF02115                                        0716
         LA    @08,ICTPTF(@08,@07)                                 0716
         ST    @08,@AL00001                                        0716
         L     @08,@TF00001                                        0716
         AL    @07,@CF02115                                        0716
         LA    @08,ICTPTF(@08,@07)                                 0716
         ST    @08,@AL00001+4                                      0716
         LA    @01,@AL00001                                        0716
         BAL   @14,RSTSMDM                                         0716
*                         RFY                                      0717
*                           RTNCODE RSTD;                          0717
*                         RSTC1PRC=MAX(RSTC1PRC,RTNCODE);/* SET RC   */
         CR    RSTC1PRC,RTNCODE                                    0718
         BNL   *+6
         LR    RSTC1PRC,RTNCODE                                    0718
*                         RFY                                      0719
*                           RTNCODE UNRSTD;                        0719
*                       END;                                       0720
*                     ELSE                                         0721
*                       ;           /* FMID SYSMOD IS OK             */
@RF00714 DS    0H                                                  0722
*                   END;                                           0722
*                 ELSE                                             0723
*                   ;               /* CONTINUE THE SEARCH           */
@RF00712 DS    0H                                                  0724
*               END;                /* END OF SEARCH LOOP            */
*                                                                  0724
         AL    RSTCX2,@CF00048                                     0724
@DE00711 LR    @08,RSTCX2                                          0724
         MH    @08,@CH02096                                        0724
         L     @07,@CA00147                                        0724
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0724
         AL    @07,@CF02115                                        0724
         L     @08,ICTPEND(@08,@07)                                0724
         CL    @08,ICTENDNT                                        0724
         BE    @DC00711                                            0724
         CH    RSTC1PRC,@CH00033                                   0724
         BL    @DL00711                                            0724
@DC00711 DS    0H                                                  0725
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK FOR FMID'ED SYSMOD NOT BEING A RESTORE      */
*               /* CANDIDATE                                         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0725
*               ADDR(LOCALTSL)->TSLFUNCT=TSLFISRH;/* SEARCH ICT ...  */
         LA    @08,LOCALTSL                                        0725
         MVI   TSLFUNCT(@08),X'01'                                 0725
*               ADDR(LOCALTSS)->TSLISMD=ICTPFMID(RSTCX1);/* ... FOR
*                                      FMID ...                      */
         LA    @08,LOCALTSS                                        0726
         LR    @05,RSTCX1                                          0726
         MH    @05,@CH02096                                        0726
         L     @15,@CA00147                                        0726
         L     @01,CCAICPTF-HMASMCCA(,@15)                         0726
         ALR   @01,@05                                             0726
         AL    @01,@CF02140                                        0726
         MVC   TSLISMD(7,@08),ICTPFMID-22(@01)                     0726
*               CALL HMASMTSB(LOCALTSL);/* ...                       */
         LA    @08,LOCALTSL                                        0727
         ST    @08,@AL00001                                        0727
         LA    @01,@AL00001                                        0727
         L     @15,@CA00028                                        0727
         BALR  @14,@15                                             0727
*               IF ADDR(LOCALTSS)->TSLINOG=ON THEN/* FMID'ED SYSMOD
*                                      IS NOGO?                      */
         LA    @08,LOCALTSS                                        0728
         TM    TSLINOG(@08),B'00000010'                            0728
         BNO   @RF00728                                            0728
*                 DO;               /*                               */
*                   IF ADDR(LOCALSS)->TSLICTP->ICTPMSG(1)^=ON THEN/*
*                                      IF THE SYSMOD IS NOGO AND NO
*                                      MESSAGE ISSUED THEN IT IS NOT
*                                      A CANDIDATE                   */
         LA    @08,LOCALSS                                         0730
         L     @08,TSLICTP(,@08)                                   0730
         TM    ICTPMSG(@08),B'00010000'                            0730
         BO    @RF00730                                            0730
*                     DO;           /* ISSUE ERROR MESSAGE           */
*                       RSTCTXT@=ADDR(TXTFMIDD);/* TEXT IS 'FMIDED'
*                                      FOR HMA359                    */
         LA    RSTCTXT@,@CC01826                                   0732
*                       CALL RSTSMDM(ICTPTF(RSTCX1),/*               */
*                           ICTPFMID(RSTCX1));/*                     */
         LR    @08,RSTCX1                                          0733
         MH    @08,@CH02096                                        0733
         L     @07,@CA00147                                        0733
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0733
         LA    @05,0(@08,@07)                                      0733
         AL    @05,@CF02115                                        0733
         ST    @05,@AL00001                                        0733
         AL    @07,@CF02140                                        0733
         LA    @08,ICTPFMID-22(@08,@07)                            0733
         ST    @08,@AL00001+4                                      0733
         LA    @01,@AL00001                                        0733
         BAL   @14,RSTSMDM                                         0733
*                       RFY                                        0734
*                         RTNCODE RSTD;                            0734
*                       RSTC1PRC=MAX(RSTC1PRC,RTNCODE);/* SET RC     */
         CR    RSTC1PRC,RTNCODE                                    0735
         BNL   *+6
         LR    RSTC1PRC,RTNCODE                                    0735
*                       RFY                                        0736
*                         RTNCODE UNRSTD;                          0736
*                     END;                                         0737
*                 END;                                             0738
@RF00730 DS    0H                                                  0739
*             END;                                                 0739
@RF00728 DS    0H                                                  0740
*           IF RSTC1PRC=STOPSMD THEN/* SYSMOD FAILED?                */
@RF00708 CH    RSTC1PRC,@CH00041                                   0740
         BNE   @RF00740                                            0740
*             DO;                   /* YES,                          */
*                                                                  0741
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE MESSAGE HMA226I XXXXXXXX PROCESSING         */
*               /* TERMINATED ... FOR SYSMOD XXXXXXX                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0742
*               DO;                 /* HMASMPMG M1(HMA226I)M2(PART011
*                                      )TYPE(ERR)VAR(TBLXFUNC,ICTPTFS
*                                      (RSTCX1))TARGET(SYSOUT,LOG)   */
*                 HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS  */
         XC    HMASMMGP(28),HMASMMGP                               0743
*                 MGPMGNO1=HMA226I; /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH00564                                0744
*                 MGPMGNO2=PART011; /* SET UP MSG 2 CODE             */
         MVC   MGPMGNO2(2),@CH00535                                0745
*                 MGPTYPE=MGPERR;   /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0746
*                 MGPPRINT='1'B;    /* SET TARGET FLAG               */
*                 MGPHLDS='1'B;     /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0748
*                 MGPVARPT(1)=ADDR(TBLXFUNC);/* SET VARIABLE PTR     */
         L     @08,@PC00001                                        0749
         L     @08,TSLTBLXP(,@08)                                  0749
         LA    @08,TBLXFUNC(,@08)                                  0749
         ST    @08,MGPVARPT                                        0749
*                 MGPVARPT(2)=ADDR(ICTPTFS(RSTCX1));/* SET VARIABLE
*                                      PTR                           */
         LR    @08,RSTCX1                                          0750
         MH    @08,@CH02096                                        0750
         L     @05,@CA00147                                        0750
         L     @05,CCAICPTF-HMASMCCA(,@05)                         0750
         AL    @05,@CF02115                                        0750
         LA    @08,ICTPTFS(@08,@05)                                0750
         ST    @08,MGPVARPT+4                                      0750
*                 CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED     */
         LA    @08,HMASMMGP                                        0751
         ST    @08,@AL00001                                        0751
         L     @15,@CV01796                                        0751
         LA    @01,@AL00001                                        0751
         BALR  @14,@15                                             0751
*               END;                /*                               */
*               ICTPCPL(RSTCX1)=ON; /* MARK SYSMOD COMPLETE          */
*               ICTPMSG(RSTCX1)=ON; /* ALL NECESSARY MESSAGES ISSUED */
*                                                                  0754
         LR    @08,RSTCX1                                          0754
         MH    @08,@CH02096                                        0754
         L     @05,@CA00147                                        0754
         L     @05,CCAICPTF-HMASMCCA(,@05)                         0754
         ST    @08,@TF00001                                        0754
         ALR   @08,@05                                             0754
         AL    @08,@CF02117                                        0754
         OI    ICTPCPL-8(@08),B'00110000'                          0754
*               /*****************************************************/
*               /*                                                   */
*               /* DO THE CHECKING FOR FUNCTION FAILURE              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0755
*               RFY                                                0755
*                 TSLPARMS BASED(ADDR(LOCALTSL));                  0755
*               TSLFUNCT=TSLFFUNC;  /* CHECK FOR FUNCTION FAILURE    */
         LA    @08,LOCALTSL                                        0756
         MVI   TSLFUNCT(@08),X'07'                                 0756
*               TSLMSMD=ICTPTFS(RSTCX1);/* SYSMOD NAME               */
         L     @15,TSLPMLAD(,@08)                                  0757
         LR    @14,@05                                             0757
         AL    @14,@TF00001                                        0757
         AL    @14,@CF02115                                        0757
         MVC   TSLMSMD(7,@15),ICTPTFS(@14)                         0757
*               TSLMTYPE=ICTPTYPE(RSTCX1);/* SYSMOD TYPE             */
         L     @01,@TF00001                                        0758
         AL    @05,@CF02141                                        0758
         SLR   @00,@00                                             0758
         IC    @00,ICTPTYPE-17(@01,@05)                            0758
         STC   @00,TSLMTYPE(,@15)                                  0758
*               CALL HMASMTSB(TSLPARMS);                           0759
         ST    @08,@AL00001                                        0759
         LA    @01,@AL00001                                        0759
         L     @15,@CA00028                                        0759
         BALR  @14,@15                                             0759
*               RSTC1PRC=MAX(RSTC1PRC,TSLRETRN);/* SAVE RETURN CODE  */
         LA    @08,LOCALTSL                                        0760
         SLR   @05,@05                                             0760
         IC    @05,TSLRETRN(,@08)                                  0760
         CR    RSTC1PRC,@05                                        0760
         BNL   *+6
         LR    RSTC1PRC,@05                                        0760
*               RFY                                                0761
*                 TSLPARMS BASED;                                  0761
*             END;                                                 0762
*           ELSE                                                   0763
*             ;                     /* NO FAIURE                     */
@RF00740 DS    0H                                                  0764
*           RSTCRC=MAX(RSTCRC,RSTC1PRC);/* SAVE RETURN CODE          */
         CR    RSTCRC,RSTC1PRC                                     0764
         BNL   *+6
         LR    RSTCRC,RSTC1PRC                                     0764
*         END;                                                     0765
*     END;                          /* END OF ICT SYSMOD LOOP        */
@RF00667 AL    RSTCX1,@CF00048                                     0766
@DE00664 LR    @08,RSTCX1                                          0766
         MH    @08,@CH02096                                        0766
         L     @05,@CA00147                                        0766
         L     @05,CCAICPTF-HMASMCCA(,@05)                         0766
         AL    @05,@CF02115                                        0766
         L     @08,ICTPEND(@08,@05)                                0766
         CL    @08,ICTENDNT                                        0766
         BE    @DC00664                                            0766
         CH    RSTCRC,@CH00033                                     0766
         BL    @DL00664                                            0766
@DC00664 DS    0H                                                  0767
*   END;                            /* END OF PROCESSING LOOP        */
@DE00662 TM    RSTCDONE,B'10000000'                                0767
         BNZ   @DC00662                                            0767
         CH    RSTCRC,@CH00033                                     0767
         BL    @DL00662                                            0767
@DC00662 DS    0H                                                  0768
*   RETURN CODE(RSTCRC);            /* RETURN W/ RC                  */
         LR    @15,RSTCRC                                          0768
         L     @14,@SA00010                                        0768
         LM    @00,@12,@SA00010+8                                  0768
         BR    @14                                                 0768
*   RFY                                                            0769
*     TBLXPARM BASED;                                              0769
*   RFY                                                            0770
*     TSLPARMS BASED;                                              0770
*   RFY                                                            0771
*     ICTPTF BASED;                                                0771
*                                                                  0772
*/********************************************************************/
*/* RSTLST1 - MARK CURRENT SYSMOD NOGO IF THE SPECIFIED (BY PARM2)   */
*/*           INDEX LIST LIST NAMES A SYSMOD THAT IS NOGO IN THE ICT */
*/*                                                                  */
*/* INPUT  - CURRENT SYSMOD ICT ENTRY                                */
*/*        - PTR TO THE INDEX LIST TO BE CHECKED                     */
*/*        - CANDIDATE INDICATOR                                     */
*/*          'C' - MARK CURRENT SYSMOD NOGO ONLY IF NAMED SYSMOD     */
*/*                IS A RESTORE CANDIDATE (ICTPRCND)                 */
*/*          ^'C'- MARK CURRENT SYSMOD NOGO REGARDLESS OF CANDIDATE  */
*/*                FLAG                                              */
*/*        - INDEX INCREANEMT (1 OR 2).  8*INCREAMENT=LENGTH OF LIST */
*/*          ENTRY                                                   */
*/*        - PTR TO THE INDEX LIST TO BE CHECKED                     */
*/*                                                                  */
*/* OUTPUT - ICTPNOGO IN THE CURRENT SYSMOD ICT ENTRY                */
*/*        - RETURN CODES                                            */
*/*          0 - SYSMOD IS OK OR ALREADY NOGO                        */
*/*          8 - SYSMOD IS MARKED NOGO                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0772
*RSTLST1:                                                          0772
*   PROC(RST1ENT,                   /* CURRENT SYSMOD ENTRY FOR WHICH
*                                      PROCESSING IS BEING DONE      */
*       RST1LST@,                   /* INDEX AREA CHAIN FOR WHICH  0772
*                                      PROCESSING IS TO BE DONE      */
*       RST1CAND,                   /* CANDIDATE INDICATOR           */
*       RST1INCR);                  /* INDEX LIST INCREAMENT (1 OR 2)*/
RSTLST1  STM   @14,@12,@SA00011                                    0772
         MVC   @PC00011(16),0(@01)                                 0772
*   DCL                                                            0773
*     RST1ENT CHAR(*);              /* ICT PTF ENTRY                 */
*   DCL                                                            0774
*     RST1LST@ PTR(31);             /* INDEX CHAIN POINTER           */
*   DCL                                                            0775
*     RST1CAND CHAR(1);             /* CANDIDATE INDICATOR           */
*   DCL                                                            0776
*     RST1INCR FIXED(31);           /* INDEX LIST INC                */
*   DCL                                                            0777
*     RST1RC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0778
*     RST1X1 FIXED(31);             /* ICT INDEX ENTRY LOOP COUNTER  */
*   DCL                                                            0779
*     RST1X2 FIXED(31);             /* ICT PTF SECTION LOOP COUNTER  */
*   DCL                                                            0780
*     1 RST1FLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 RST1FND BIT(1),            /* SYSMOD NAME IN LIST FOUND IN
*                                      THE ICT                       */
*      2 * BIT(7);                  /* UNUSED                        */
*   RFY                                                            0781
*     TBLXPARM BASED(TSLTBLXP);                                    0781
*   RFY                                                            0782
*     TSLPARMS BASED(ADDR(PARM1));                                 0782
*   RFY                                                            0783
*     ICTPTF BASED(CCAICPTF);                                      0783
*   RFY                                                            0784
*     ICTENTLS BASED(RST1LST@);                                    0784
*   RST1RC=ZERO;                    /* CLEAR RETURN CODE             */
         SLR   RST1RC,RST1RC                                       0785
*   DO RST1X1=1 BY RST1INCR         /* CHECK EACH SYSMOD IN THE INDEX
*                                      LIST                          */
*         WHILE(ICTENTND(RST1X1)^=ICTENDIX/*                         */
*         &RST1RC<STOPFUNC);                                       0786
         LA    RST1X1,1                                            0786
         B     @DE00786                                            0786
@DL00786 DS    0H                                                  0787
*     RST1FND=OFF;                  /* MATCH NOT FOUND               */
         NI    RST1FND,B'01111111'                                 0787
*     DO RST1X2=1 BY 1              /* SEARCH FOR THE NAMED SYSMOD IN
*                                      THE ICT                       */
*           WHILE(ICTPEND(RST1X2)^=ICTENDNT/*                        */
*           &RST1FND=OFF            /* ... AND NOT YET FOUND         */
*           &RST1RC<STOPFUNC);                                     0788
         LA    RST1X2,1                                            0788
         B     @DE00788                                            0788
@DL00788 DS    0H                                                  0789
*       IF ICTENTNM(RST1X1)=ICTPTFS(RST1X2) THEN/* MATCH?            */
         LR    @08,RST1X1                                          0789
         SLA   @08,3                                               0789
         L     @07,@PC00011+4                                      0789
         L     @07,RST1LST@(,@07)                                  0789
         LR    @05,RST1X2                                          0789
         MH    @05,@CH02096                                        0789
         L     @15,@CA00147                                        0789
         L     @15,CCAICPTF-HMASMCCA(,@15)                         0789
         ALR   @07,@08                                             0789
         AL    @07,@CF02126                                        0789
         ST    @05,@TF00001                                        0789
         ALR   @05,@15                                             0789
         AL    @05,@CF02115                                        0789
         CLC   ICTENTNM(7,@07),ICTPTFS(@05)                        0789
         BNE   @RF00789                                            0789
*         DO;                       /* YES,                          */
*           RST1FND=ON;             /* MATCH FOUND                   */
         OI    RST1FND,B'10000000'                                 0791
*           IF RST1CAND^=CANDIDTE   /* CANDIDATE NOT SPECIFIED ...   */
*               ×ICTPRCND(RST1X2)=ON THEN/* OR IS A CANDIDATE?       */
         L     @08,@PC00011+8                                      0792
         CLI   RST1CAND(@08),C'C'                                  0792
         BNE   @RT00792                                            0792
         AL    @15,@TF00001                                        0792
         AL    @15,@CF02142                                        0792
         TM    ICTPRCND-12(@15),B'00010000'                        0792
         BNO   @RF00792                                            0792
@RT00792 DS    0H                                                  0793
*             DO;                   /* YES, CHECK FOR NOGO           */
*               IF ICTPNOGO(RST1X2)=ON THEN/* SYSMOD IS NOGO?        */
         LR    @08,RST1X2                                          0794
         MH    @08,@CH02096                                        0794
         L     @07,@CA00147                                        0794
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0794
         ST    @08,@TF00001                                        0794
         ALR   @08,@07                                             0794
         AL    @08,@CF02117                                        0794
         TM    ICTPNOGO-8(@08),B'01000000'                         0794
         BNO   @RF00794                                            0794
*                 DO;               /* YES,                          */
*                   CALL RSTSMDM(RST1ENT,/* ICT SYSMOD ENTRY TO BE 0796
*                                      FAILED                        */
*                       ICTPTF(RST1X2));/* SYSMOD ENTRY CAUSING    0796
*                                      FAILURE                       */
         L     @08,@PC00011                                        0796
         ST    @08,@AL00001                                        0796
         L     @08,@TF00001                                        0796
         AL    @07,@CF02115                                        0796
         LA    @08,ICTPTF(@08,@07)                                 0796
         ST    @08,@AL00001+4                                      0796
         LA    @01,@AL00001                                        0796
         BAL   @14,RSTSMDM                                         0796
*                   RFY                                            0797
*                     RTNCODE RSTD;                                0797
*                   RST1RC=RTNCODE; /* SAVE THE RETURN CODE          */
         LR    RST1RC,RTNCODE                                      0798
*                   RFY                                            0799
*                     RTNCODE UNRSTD;                              0799
*                 END;                                             0800
*               ELSE                                               0801
*                 ;                 /* NOT NOGO SO IGNORE IT         */
@RF00794 DS    0H                                                  0802
*             END;                                                 0802
*           ELSE                                                   0803
*             ;                     /* CANDIDATE SPECIFIED AND SYSMOD
*                                      NOT A CANDIDATE               */
@RF00792 DS    0H                                                  0804
*         END;                                                     0804
*       ELSE                                                       0805
*         ;                         /* NOT A MATCH                   */
@RF00789 DS    0H                                                  0806
*     END;                                                         0806
*                                                                  0806
         AL    RST1X2,@CF00048                                     0806
@DE00788 LR    @08,RST1X2                                          0806
         MH    @08,@CH02096                                        0806
         L     @07,@CA00147                                        0806
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0806
         AL    @07,@CF02115                                        0806
         L     @08,ICTPEND(@08,@07)                                0806
         CL    @08,ICTENDNT                                        0806
         BE    @DC00788                                            0806
         TM    RST1FND,B'10000000'                                 0806
         BNZ   @DC00788                                            0806
         CH    RST1RC,@CH00033                                     0806
         BL    @DL00788                                            0806
@DC00788 DS    0H                                                  0807
*     /***************************************************************/
*     /*                                                             */
*     /* MATCH NOT FOUND ?????                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0807
*   END;                            /* END OF PROCESSING THE LIST    */
         L     @08,@PC00011+12                                     0807
         AL    RST1X1,RST1INCR(,@08)                               0807
@DE00786 LR    @08,RST1X1                                          0807
         SLA   @08,3                                               0807
         L     @07,@PC00011+4                                      0807
         L     @07,RST1LST@(,@07)                                  0807
         AL    @07,@CF02126                                        0807
         L     @08,ICTENTND(@08,@07)                               0807
         CL    @08,ICTENDIX                                        0807
         BE    @DC00786                                            0807
         CH    RST1RC,@CH00033                                     0807
         BL    @DL00786                                            0807
@DC00786 DS    0H                                                  0808
*   RETURN CODE(RST1RC);            /* RETURN W/ RC                  */
         LR    @15,RST1RC                                          0808
         L     @14,@SA00011                                        0808
         LM    @00,@12,@SA00011+8                                  0808
         BR    @14                                                 0808
*   RFY                                                            0809
*     TBLXPARM BASED;                                              0809
*   RFY                                                            0810
*     TSLPARMS BASED;                                              0810
*   RFY                                                            0811
*     ICTPTF BASED;                                                0811
*   RFY                                                            0812
*     ICTENTLS BASED;                                              0812
*   END RSTLST1;                                                   0813
*                                                                  0814
*/********************************************************************/
*/* RSTLST2 - MARK CURRENT SYSMOD NOGO IF A NOGO SYSMOD REFERNECES   */
*/*           THE CURRENT SYSMOD IN THE SPECIFIED INDEX LIST.        */
*/*                                                                  */
*/* INPUT  - CURRENT SYSMOD ICT ENTRY                                */
*/*        - OFFSET OF THE INDEX LIST POINTER                        */
*/*                                                                  */
*/* OUTPUT - ICTPNOGO IN THE CURRENT SYSMOD ICT ENTRY                */
*/*        - RETURN CODES                                            */
*/*          0 - SYSMOD IS OK OR ALREADY NOGO                        */
*/*          8 - SYSMOD IS MARKED NOGO                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0814
*RSTLST2:                                                          0814
*   PROC(RST2ENT,                   /* CURRENT SYSMOD ENTRY FOR WHICH
*                                      PROCESSING IS BEING DONE      */
*       RST2LSTI);                  /* OFFSET OF INDEX AREA CHAIN FOR
*                                      WHICH PROCESSING IS TO BE DONE*/
RSTLST2  STM   @14,@12,@SA00012                                    0814
         MVC   @PC00012(8),0(@01)                                  0814
*   DCL                                                            0815
*     RST2ENT CHAR(*);              /* ICT PTF ENTRY                 */
*   DCL                                                            0816
*     RST2LSTI PTR(31);             /* OFFSET INDEX CHAIN PTR        */
*   DCL                                                            0817
*     RST2INCR FIXED(31);           /* INCREAMENT FOR INDEX LIST     */
*   DCL                                                            0818
*     RST2RC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0819
*     1 RST2FLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 RST2DONE BIT(1),           /* SYSMOD NAME IN LIST FOUND IN
*                                      THE ICT                       */
*      2 RST2FND BIT(1),            /* SYSMOD NAME IN LIST FOUND IN
*                                      INDEX LIST                    */
*      2 * BIT(6);                  /* UNUSED                        */
*   DCL                                                            0820
*     RST2SMD CHAR(7) BASED(ADDR(RST2ENT));/* CURRENT SYSMOD         */
*   DCL                                                            0821
*     RST2PTR PTR(31) BASED;        /* POINTER TO THE INDEX LIST     */
*   DCL                                                            0822
*     RST2PTFX FIXED(31);           /* PTF SECTION SEARCH LOOP     0822
*                                      COUNTER                       */
*   DCL                                                            0823
*     RST2NDXI FIXED(31);           /* INDEX LIST COUNTER            */
*   DCL                                                            0824
*     RST2IROF FIXED(31);           /* OFFSET OF ++IF REQ CHAIN      */
*   RFY                                                            0825
*     TBLXPARM BASED(TSLTBLXP);                                    0825
*   RFY                                                            0826
*     TSLPARMS BASED(ADDR(LOCALTSL));                              0826
*   RFY                                                            0827
*     ICTPTF BASED(CCAICPTF);                                      0827
*   RFY                                                            0828
*     ICTENTLS BASED((ADDR(ICTPTF(RST2PTFX))+RST2LSTI)->RST2PTR);  0828
*   RST2RC=ZERO;                    /* CLEAR RETURN CODE             */
         SLR   RST2RC,RST2RC                                       0829
*   RST2FLGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         MVI   RST2FLGS,X'00'                                      0830
*   RST2IROF=ADDR(ICTPICHN(1))      /* COMPUTE OFFSET OF ++IF REQ  0831
*                                      CHAIN PTR                     */
*       -ADDR(ICTPTF(1));                                          0831
         L     @08,@CA00147                                        0831
         L     @08,CCAICPTF-HMASMCCA(,@08)                         0831
         LA    RST2IROF,ICTPICHN(,@08)                             0831
         SLR   RST2IROF,@08                                        0831
*   IF RST2LSTI=RST2IROF THEN       /* ++IF REQ INDEX BEING        0832
*                                      PROCESSED?                    */
         L     @08,@PC00012+4                                      0832
         C     RST2IROF,RST2LSTI(,@08)                             0832
         BNE   @RF00832                                            0832
*     DO;                           /* YES,                          */
*       RST2INCR=2;                 /* INCREAMENT IS 2               */
         LA    RST2INCR,2                                          0834
*     END;                                                         0835
*   ELSE                            /* NOT THE ++IF REQ INDEX        */
*     DO;                                                          0836
         B     @RC00832                                            0836
@RF00832 DS    0H                                                  0837
*       RST2INCR=1;                 /* INCREAMENT IS 1               */
         LA    RST2INCR,1                                          0837
*     END;                                                         0838
*   RST2DONE=OFF;                   /* SET TO PROCESSING NOT DONE    */
@RC00832 NI    RST2DONE,B'01111111'                                0839
*   DO RST2PTFX=1 BY 1              /* SEARCH ICT PTF SECTION ...    */
*         WHILE(RST2RC<STOPFUNC     /* ... UNTIL ERROR OR END LIST   */
*         &ICTPEND(RST2PTFX)^=ICTENDNT);/* ...                       */
         LA    RST2PTFX,1                                          0840
         B     @DE00840                                            0840
@DL00840 DS    0H                                                  0841
*     IF RST2SMD^=ICTPTFS(RST2PTFX) THEN/* NOT ENTRY INPUT SYSMOD  0841
*                                      NAME?                         */
         L     @08,@PC00012                                        0841
         LR    @07,RST2PTFX                                        0841
         MH    @07,@CH02096                                        0841
         L     @04,@CA00147                                        0841
         L     @04,CCAICPTF-HMASMCCA(,@04)                         0841
         ALR   @04,@07                                             0841
         AL    @04,@CF02115                                        0841
         CLC   RST2SMD(7,@08),ICTPTFS(@04)                         0841
         BE    @RF00841                                            0841
*       DO;                         /* YES,                          */
*                                                                  0842
*         /***********************************************************/
*         /*                                                         */
*         /* SEARCH EACH INDEX LIST FOR A MATCH                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0843
*         RST2FND=OFF;              /* AND NOT YET FOUND             */
         NI    RST2FND,B'10111111'                                 0843
*         DO RST2NDXI=1 BY RST2INCR /* PROCESS ALL INDEX LIST ENTRIES*/
*               WHILE(ADDR(ICTENTLS)^=ZERO/* NOT ZERO CHAIN PTR      */
*               &ICTENTND(RST2NDXI)^=ICTENDIX/* AND NOT END OF LIST  */
*               &RST2FND=OFF);      /* AND NOT YET FOUND     @Z67SP00*/
         LA    RST2NDXI,1                                          0844
         B     @DE00844                                            0844
@DL00844 DS    0H                                                  0845
*           IF ICTENTNM(RST2NDXI)=RST2SMD THEN/* MATCH FOUND?        */
         LR    @08,RST2NDXI                                        0845
         SLA   @08,3                                               0845
         LR    @07,RST2PTFX                                        0845
         MH    @07,@CH02096                                        0845
         L     @15,@CA00147                                        0845
         L     @15,CCAICPTF-HMASMCCA(,@15)                         0845
         LA    @01,0(@07,@15)                                      0845
         AL    @01,@CF02115                                        0845
         L     @14,@PC00012+4                                      0845
         AL    @01,RST2LSTI(,@14)                                  0845
         L     @01,RST2PTR(,@01)                                   0845
         L     @14,@PC00012                                        0845
         ALR   @01,@08                                             0845
         AL    @01,@CF02126                                        0845
         CLC   ICTENTNM(7,@01),RST2SMD(@14)                        0845
         BNE   @RF00845                                            0845
*             DO;                   /* YES,                          */
*               RST2FND=ON;         /* FOUND FLAG ON                 */
         OI    RST2FND,B'01000000'                                 0847
*               IF ICTPNOGO(RST2PTFX)=ON THEN/* REFERENCING SYSMOD IS
*                                      NOGO?                         */
         ST    @07,@TF00001                                        0848
         ALR   @07,@15                                             0848
         AL    @07,@CF02117                                        0848
         TM    ICTPNOGO-8(@07),B'01000000'                         0848
         BNO   @RF00848                                            0848
*                 DO;               /* YES,                          */
*                   CALL RSTSMDM(RST2ENT,/* ICT SYSMOD ENTRY TO BE 0850
*                                      FAILED                        */
*                       ICTPTF(RST2PTFX));/* SYSMOD ENTRY CAUSING  0850
*                                      FAILURE                       */
         ST    @14,@AL00001                                        0850
         L     @08,@TF00001                                        0850
         AL    @15,@CF02115                                        0850
         LA    @08,ICTPTF(@08,@15)                                 0850
         ST    @08,@AL00001+4                                      0850
         LA    @01,@AL00001                                        0850
         BAL   @14,RSTSMDM                                         0850
*                   RFY                                            0851
*                     RTNCODE RSTD;                                0851
*                   RST2RC=MAX(RST2RC,RTNCODE);/* SAVE RETURN CODE   */
         CR    RST2RC,RTNCODE                                      0852
         BNL   *+6
         LR    RST2RC,RTNCODE                                      0852
*                   RFY                                            0853
*                     RTNCODE UNRSTD;                              0853
*                 END;                                             0854
*               ELSE                                               0855
*                 ;                 /* NOT NOGO                      */
@RF00848 DS    0H                                                  0856
*             END;                                                 0856
*           ELSE                                                   0857
*             ;                     /* INDEX LIST NAME DOES NOT MATCH*/
@RF00845 DS    0H                                                  0858
*         END;                      /* END OF SEARCH THRU ONE INDEX
*                                      LIST                          */
         ALR   RST2NDXI,RST2INCR                                   0858
@DE00844 LR    @08,RST2PTFX                                        0858
         MH    @08,@CH02096                                        0858
         L     @07,@CA00147                                        0858
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0858
         AL    @07,@CF02115                                        0858
         LA    @08,ICTPTF(@08,@07)                                 0858
         L     @07,@PC00012+4                                      0858
         AL    @08,RST2LSTI(,@07)                                  0858
         L     @08,RST2PTR(,@08)                                   0858
         LTR   @08,@08                                             0858
         BZ    @DC00844                                            0858
         LR    @07,RST2NDXI                                        0858
         SLA   @07,3                                               0858
         AL    @08,@CF02126                                        0858
         L     @08,ICTENTND(@07,@08)                               0858
         CL    @08,ICTENDIX                                        0858
         BE    @DC00844                                            0858
         TM    RST2FND,B'01000000'                                 0858
         BZ    @DL00844                                            0858
@DC00844 DS    0H                                                  0859
*       END;                                                       0859
*     ELSE                                                         0860
*       ;                           /* ICT ENTRY FOR NAMED SYSMOD SO
*                                      SKIP IT                       */
@RF00841 DS    0H                                                  0861
*   END;                            /* END OF ICT PTF SEARCH LOOP    */
         AL    RST2PTFX,@CF00048                                   0861
@DE00840 CH    RST2RC,@CH00033                                     0861
         BNL   @DC00840                                            0861
         LR    @08,RST2PTFX                                        0861
         MH    @08,@CH02096                                        0861
         L     @07,@CA00147                                        0861
         L     @07,CCAICPTF-HMASMCCA(,@07)                         0861
         AL    @07,@CF02115                                        0861
         L     @08,ICTPEND(@08,@07)                                0861
         CL    @08,ICTENDNT                                        0861
         BNE   @DL00840                                            0861
@DC00840 DS    0H                                                  0862
*   RETURN CODE(RST2RC);            /* RETURN W/ RC                  */
         LR    @15,RST2RC                                          0862
         L     @14,@SA00012                                        0862
         LM    @00,@12,@SA00012+8                                  0862
         BR    @14                                                 0862
*   RFY                                                            0863
*     TBLXPARM BASED;                                              0863
*   RFY                                                            0864
*     TSLPARMS BASED;                                              0864
*   RFY                                                            0865
*     ICTPTF BASED;                                                0865
*   RFY                                                            0866
*     ICTENTLS BASED;                                              0866
*   END RSTLST2;                                                   0867
*RSTSMDM:                                                          0868
*   PROC(RSTMENT,                   /* ICT ENTRY FOR FAILING SYSMOD  */
*       RSTMNOGO);                  /* ICT ENTRY FOR SYSMOD CAUSING
*                                      FAILURE                       */
RSTSMDM  STM   @14,@12,@SA00013                                    0868
         MVC   @PC00013(8),0(@01)                                  0868
*   DCL                                                            0869
*     RSTMENT CHAR(*);              /* FAILING ENTRY                 */
*   DCL                                                            0870
*     RSTMNOGO CHAR(*);             /* CAUSING ENTRY                 */
*   DCL                                                            0871
*     RSTMRC FIXED(15);             /* LOCAL RETURN CODE             */
*   RFY                                                            0872
*     TBLXPARM BASED(TSLTBLXP);                                    0872
*   RFY                                                            0873
*     TSLPARMS BASED(ADDR(PARM1));                                 0873
*   RFY                                                            0874
*     ICTPTF BASED(ADDR(RSTMENT));                                 0874
*   RSTMRC=ZERO;                    /* CLEAR RETURN CODE             */
         SLR   RSTMRC,RSTMRC                                       0875
*   IF ICTPNOGO(1)^=ON THEN         /* SYSMOD NOT ALREADY NOGO?      */
         L     @08,@PC00013                                        0876
         TM    ICTPNOGO(@08),B'01000000'                           0876
         BO    @RF00876                                            0876
*     DO;                           /*                               */
*       RSTCDONE=OFF;               /* ANOTHER PASS THRU ICT REQUIRED*/
         NI    RSTCDONE,B'01111111'                                0878
*       ICTPNOGO(1)=ON;             /* SET IT                        */
*       ICTPMSG(1)=ON;              /* MESSAGE ISSUED                */
*       ICTPCPL(1)=ON;              /* COMPLETE                      */
         OI    ICTPNOGO(@08),B'01110000'                           0881
*       RSTMRC=STOPSMD;             /* RC IS SYSMOD FAILED           */
         LA    RSTMRC,8                                            0882
*     END;                          /*                               */
*   ELSE                                                           0884
*     ;                             /* SYSMOD IS ALREADY NOGO        */
@RF00876 DS    0H                                                  0885
*   IF RSTCHDRM=OFF THEN            /* HEADER MESSAGE NOT YET ISSUED */
         TM    RSTCHDRM,B'01000000'                                0885
         BNZ   @RF00885                                            0885
*     DO;                           /*                               */
*                                                                  0886
*       /*************************************************************/
*       /*                                                           */
*       /* HMA302I XXXXXXXX PROCESSING TERMINATED FOR SYSMOD XXXXXXX */
*       /* - REASON = HMA302I ... 'MISSING/NOGO REQUISITES:'         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0887
*       DO;                         /* HMASMPMG M1(HMA302I)M2(PART090
*                                      )TYPE(ERR)VAR(TBLXFUNC,RSTMENT
*                                      )TARGET(SYSOUT,LOG)           */
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */
         XC    HMASMMGP(28),HMASMMGP                               0888
*         MGPMGNO1=HMA302I;         /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH01803                                0889
*         MGPMGNO2=PART090;         /* SET UP MSG 2 CODE             */
         MVC   MGPMGNO2(2),@CH00631                                0890
*         MGPTYPE=MGPERR;           /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0891
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0893
*         MGPVARPT(1)=ADDR(TBLXFUNC);/* SET VARIABLE PTR             */
         L     @08,@PC00001                                        0894
         L     @08,TSLTBLXP(,@08)                                  0894
         LA    @08,TBLXFUNC(,@08)                                  0894
         ST    @08,MGPVARPT                                        0894
*         MGPVARPT(2)=ADDR(RSTMENT);/* SET VARIABLE PTR              */
         L     @08,@PC00013                                        0895
         ST    @08,MGPVARPT+4                                      0895
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */
         LA    @08,HMASMMGP                                        0896
         ST    @08,@AL00001                                        0896
         L     @15,@CV01796                                        0896
         LA    @01,@AL00001                                        0896
         BALR  @14,@15                                             0896
*       END;                        /*                               */
*       RSTCHDRM=ON;                /* INDICATE HEADER ISSUED        */
         OI    RSTCHDRM,B'01000000'                                0898
*     END;                          /*                               */
*   ELSE                                                           0900
*     ;                             /*                               */
*                                                                  0900
@RF00885 DS    0H                                                  0901
*   /*****************************************************************/
*   /*                                                               */
*   /* HMA359I - HMA359I ... ' --- XXXXXXX XXXXXXXX XXXXXXXXXXXX'    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0901
*   DO;                             /* HMASMPMG M1(HMA359I)M2(PART091
*                                      )TYPE(INFO)VAR(RSTMNOGO,(RSTCT
*                                      XT@),TXTBLANK)TARGET(SYSOUT,LO
*                                      G)                            */
*     HMASMMGP=HMASMMGP&&HMASMMGP;  /* SET PARMS TO ZEROS            */
         XC    HMASMMGP(28),HMASMMGP                               0902
*     MGPMGNO1=HMA359I;             /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH00958                                0903
*     MGPMGNO2=PART091;             /* SET UP MSG 2 CODE             */
         MVC   MGPMGNO2(2),@CH01810                                0904
*     MGPTYPE=MGPINFO;              /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'01'                                       0905
*     MGPPRINT='1'B;                /* SET TARGET FLAG               */
*     MGPHLDS='1'B;                 /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0907
*     MGPVARPT(1)=ADDR(RSTMNOGO);   /* SET VARIABLE PTR              */
         L     @08,@PC00013+4                                      0908
         ST    @08,MGPVARPT                                        0908
*     MGPVARPT(2)=(RSTCTXT@);       /* SET VARIABLE PTR              */
         ST    RSTCTXT@,MGPVARPT+4                                 0909
*     MGPVARPT(3)=ADDR(TXTBLANK);   /* SET VARIABLE PTR              */
         LA    @08,@CC01828                                        0910
         ST    @08,MGPVARPT+8                                      0910
*     CALL HMASMMSG(HMASMMGP);      /* HAVE MESSAGE ISSUED           */
         LA    @08,HMASMMGP                                        0911
         ST    @08,@AL00001                                        0911
         L     @15,@CV01796                                        0911
         LA    @01,@AL00001                                        0911
         BALR  @14,@15                                             0911
*   END;                            /*                               */
*   RETURN CODE(RSTMRC);            /* RETURN W/ RC                  */
         LR    @15,RSTMRC                                          0913
         L     @14,@SA00013                                        0913
         LM    @00,@12,@SA00013+8                                  0913
         BR    @14                                                 0913
*   RFY                                                            0914
*     TBLXPARM BASED;                                              0914
*   RFY                                                            0915
*     TSLPARMS BASED;                                              0915
*   RFY                                                            0916
*     ICTPTF BASED;                                                0916
*   END RSTSMDM;                                                   0917
*   END RESTCHK;                                                   0918
*                                                                  0919
*   /*****************************************************************/
*   /*                                                               */
*   /* RELMID - UNUSED DUMMY ROUTINE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0919
*RELMID:                                                           0919
*   PROC;                                                          0919
RELMID   STM   @14,@12,12(@13)                                     0919
*   DCL                                                            0920
*     RELMRC FIXED(15);             /* LOCAL RETURN CODE             */
*   RELMRC=TSLNTFND;                /* INIT RC=4, NO RELATIONSHIP  0921
*                                      FOUND                         */
         LA    RELMRC,4                                            0921
*   RETURN CODE(RELMRC);            /* RETURN W/RC VALUE             */
         LR    @15,RELMRC                                          0922
         L     @14,12(,@13)                                        0922
         LM    @00,@12,20(@13)                                     0922
         BR    @14                                                 0922
*   END RELMID;                                                    0923
*   END HMASMTSB                    /* END MODULE                    */
*                                                                  0924
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*                                                                  0924
*       ;                                                          0924
@DATA    DS    0H
@CH00077 DC    H'3'
@CH00133 DC    H'4'
@CH00041 DC    H'8'
@CH00146 DC    H'9'
@CH00535 DC    H'11'
@CH00033 DC    H'12'
@CH00564 DC    H'27'
@CH01801 DC    H'47'
@CH01106 DC    H'54'
@CH00631 DC    H'90'
@CH01810 DC    H'91'
@CH01803 DC    H'103'
@CH02096 DC    H'116'
@CH02097 DC    H'144'
@CH00958 DC    H'160'
@CH01806 DC    H'171'
@CH02099 DC    H'172'
@CH00721 DC    H'255'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00005 DS    15F
@SA00010 DS    15F
@PC00006 DS    1F
@SA00012 DS    15F
@PC00012 DS    2F
@SA00011 DS    15F
@PC00011 DS    4F
@SA00013 DS    0F
@PC00013 EQU   @SA00013+60
@SA00009 DS    0F
@SA00004 DS    0F
         DS    17F
@AL00001 DS    4A
@TF00001 DS    F
@TF00002 DS    F
@AFTEMPS DS    1F
HMASMTSB CSECT
         DS    0F
@CF00130 DC    F'0'
@CF00048 DC    F'1'
@CH00048 EQU   @CF00048+2
@CF00932 DC    F'72'
@CF02130 DC    F'-144'
@CF02129 DC    F'-132'
@CF02115 DC    F'-116'
@CF02117 DC    F'-108'
@CF02142 DC    F'-104'
@CF02119 DC    F'-103'
@CF02128 DC    F'-100'
@CF02141 DC    F'-99'
@CF02123 DC    F'-96'
@CF02140 DC    F'-94'
@CF02133 DC    F'-54'
@CF02138 DC    F'-48'
@CF02131 DC    F'-46'
@CF02136 DC    F'-44'
@CF02137 DC    F'-40'
@CF02139 DC    F'-36'
@CF02134 DC    F'-9'
@CF02126 DC    F'-8'
@DATD    DSECT
         DS    0D
LICICTP  DS    A
LOCALSS  DS    F
HMASMMGP DS    CL28
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00255 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00256 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL16
         ORG   MGPVAR
MGPVARPT DS    4A
         ORG   HMASMMGP+28
LOCALTSL DS    CL10
         DS    CL2
LOCALTSS DS    CL256
TSBIOPF  DS    CL143
LICFLAGS DS    BL1
         ORG   LICFLAGS
LICFOUND DS    BL1
@NM00258 EQU   LICFLAGS+0
         ORG   LICFLAGS+1
GTCFLAGS DS    BL1
         ORG   GTCFLAGS
GTCDSFND DS    BL1
GTCTYFND EQU   GTCFLAGS+0
@NM00259 EQU   GTCFLAGS+0
         ORG   GTCFLAGS+1
CICFLAGS DS    CL1
         ORG   CICFLAGS
CICFOUND DS    BL1
@NM00260 EQU   CICFLAGS+0
         ORG   CICFLAGS+1
FSNFLAGS DS    BL1
         ORG   FSNFLAGS
FSNFOUND DS    BL1
@NM00261 EQU   FSNFLAGS+0
         ORG   FSNFLAGS+1
RSTCFLGS DS    CL1
         ORG   RSTCFLGS
RSTCDONE DS    BL1
RSTCHDRM EQU   RSTCFLGS+0
@NM00262 EQU   RSTCFLGS+0
         ORG   RSTCFLGS+1
RST1FLGS DS    CL1
         ORG   RST1FLGS
RST1FND  DS    BL1
@NM00263 EQU   RST1FLGS+0
         ORG   RST1FLGS+1
RST2FLGS DS    CL1
         ORG   RST2FLGS
RST2DONE DS    BL1
RST2FND  EQU   RST2FLGS+0
@NM00264 EQU   RST2FLGS+0
         ORG   RST2FLGS+1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
HMASMTSB CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA00028 DC    A(HMASMTSB)
@CA00147 DC    A(HMASMCCA)
@CV01796 DC    V(HMASMMSG)
@CV01797 DC    V(HMASMIO)
         DS    0D
@CC01828 DC    C'            '
@CC01812 DC    C'SUPING  '
@CC01814 DC    C'SUPED   '
@CC01816 DC    C'PRE     '
@CC01818 DC    C'PREING  '
@CC01820 DC    C'REQ     '
@CC01822 DC    C'IFREQ   '
@CC01824 DC    C'FMID    '
@CC01826 DC    C'FMIDED  '
@CC02002 DC    C'C'
         DS    CL3
ICTENDCH DC    X'FFFFFFFF'
PATCHTSB DS    CL80
         ORG   PATCHTSB
@NM00257 DC    80X'FF'
         ORG   PATCHTSB+80
SUBRTNS  DC    AL4(CHKICT)
         DC    AL4(LSTICTCK)
         DC    AL4(GETDS)
         DC    AL4(CKICTCDS)
         DC    AL4(CLRPASS)
         DC    AL4(FNDSUBN)
         DC    AL4(FUNCFM)
         DC    AL4(RESTCHK)
         DC    AL4(RELMID)
         DC    A(0)
DSIDVALA DC    AL1(6)
         DC    AL1(2)
         DC    AL1(12)
         DC    AL1(0)
TXTDSIDA DC    CL8'SMPPTS  '
         DC    CL8'SMPCDS  '
         DC    CL8'SMPACDS '
         DC    CL8'********'
TYPEVALA DC    AL1(11)
         DC    AL1(16)
         DC    AL1(0)
TXTTYPEA DC    CL8'SYSMOD  '
         DC    CL8'MCS     '
         DC    CL8'********'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RELMRC   EQU   @02
RSTMRC   EQU   @02
RST2IROF EQU   @02
RST2NDXI EQU   @04
RST2PTFX EQU   @02
RST2RC   EQU   @03
RST2INCR EQU   @05
RST1X2   EQU   @03
RST1X1   EQU   @04
RST1RC   EQU   @02
RSTCTXT@ EQU   @06
RSTCX2   EQU   @05
RSTCX1   EQU   @02
RSTC1PRC EQU   @03
RSTCRC   EQU   @04
FUNCRC   EQU   @02
FSNENT1P EQU   @02
FSNENTX  EQU   @03
FSNRC    EQU   @04
CLRPLMDX EQU   @02
CLRPMODX EQU   @02
CLRPPTFX EQU   @02
CLRPRC   EQU   @03
CDSCHKRC EQU   @02
CICRC    EQU   @02
GTCRC    EQU   @03
GTCJ     EQU   @04
GTCI     EQU   @02
LICLSTI  EQU   @05
LICIRQOF EQU   @02
LICSTRTI EQU   @06
LICRC    EQU   @03
LICNDXI  EQU   @04
LICPTFX  EQU   @02
CKICTPTR EQU   @02
CKISTRTI EQU   @05
CKIRC    EQU   @04
CKIPTFX  EQU   @03
TSBRTNCD EQU   @02
CCAPTR   EQU   @11
RTNCODE  EQU   @15
RTNREG   EQU   @14
         EXTRN HMASMCCA
TSLPARMS EQU   0
TSLTBLXP EQU   TSLPARMS
TSLPMLAD EQU   TSLPARMS+4
TSLFUNCT EQU   TSLPARMS+8
TSLRETRN EQU   TSLPARMS+9
TSLICTSR EQU   0
TSLISMD  EQU   TSLICTSR
TSLIOPTF EQU   TSLICTSR+7
TSLIONXT EQU   TSLIOPTF
TSLICTP  EQU   TSLICTSR+8
TSLICTF  EQU   TSLICTSR+12
TSLIFND  EQU   TSLICTF
TSLIOK   EQU   TSLICTF
TSLISUP  EQU   TSLICTF
TSLIDEL  EQU   TSLICTF
TSLIDLE  EQU   TSLICTF
TSLIDLI  EQU   TSLICTF
TSLINOG  EQU   TSLICTF
TSLLSTSR EQU   0
TSLLSMD  EQU   TSLLSTSR
TSLLOPTF EQU   TSLLSTSR+7
TSLLONXT EQU   TSLLOPTF
TSLLOFST EQU   TSLLSTSR+8
TSLLRTNP EQU   TSLLSTSR+12
TSLGET   EQU   0
TSLGSMD  EQU   TSLGET
TSLGOPTF EQU   TSLGET+7
TSLGOMSG EQU   TSLGOPTF
TSLGOXTD EQU   TSLGOPTF
TSLGIOPP EQU   TSLGET+8
TSLGDSID EQU   TSLGET+12
TSLSICDS EQU   0
TSLSSMD  EQU   TSLSICDS
TSLSOPTF EQU   TSLSICDS+7
TSLSOICT EQU   TSLSOPTF
TSLSOCDS EQU   TSLSOPTF
TSLSOALL EQU   TSLSOPTF
TSLSICTP EQU   TSLSICDS+8
TSLSIOPP EQU   TSLSICDS+12
TSLSICTF EQU   TSLSICDS+16
TSLSIFND EQU   TSLSICTF
TSLSISUP EQU   TSLSICTF
TSLSISLS EQU   TSLSICTF
TSLSCDSF EQU   TSLSICDS+18
TSLSCFND EQU   TSLSCDSF
TSLSCOK  EQU   TSLSCDSF
TSLSCSUP EQU   TSLSCDSF
TSLSCDEL EQU   TSLSCDSF
TSLSCERR EQU   TSLSCDSF
TSLENTSR EQU   0
TSLETYPE EQU   TSLENTSR
TSLEVER# EQU   TSLENTSR+1
TSLEOPTF EQU   TSLENTSR+2
TSLEONXT EQU   TSLEOPTF
TSLENMEP EQU   TSLENTSR+4
TSLEBGNP EQU   TSLENTSR+8
TSLEFNDP EQU   TSLENTSR+12
TSLMFUNC EQU   0
TSLMTYPE EQU   TSLMFUNC
TSLMSMD  EQU   TSLMFUNC+1
TSLRELM  EQU   0
CCABLDLA EQU   0
@NM00041 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00043 EQU   CCABLDLL
CCALKDRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00047+20
@NM00049 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00049+20
@NM00051 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00051+20
@NM00053 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00053+20
@NM00055 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00055+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00059 EQU   HMASMIOP+12
@NM00060 EQU   @NM00059
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00170 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPEND  EQU   ICTPTFS
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPRCND EQU   ICTPFLG2
ICTPFLG4 EQU   ICTPTF+13
ICTPDEXP EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
@NM00197 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPTYPE EQU   ICTPTF+17
ICTPSUPN EQU   ICTPTF+20
ICTPFMID EQU   ICTPTF+22
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTND EQU   ICTENTNM
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTMOD   EQU   0
ICTMNAME EQU   ICTMOD
ICTMEND  EQU   ICTMNAME
ICTMFLG2 EQU   ICTMOD+8
ICTMFLG1 EQU   ICTMOD+9
ICTMMODR EQU   ICTMFLG1
ICTMFLG3 EQU   ICTMOD+10
ICTMFLG4 EQU   ICTMOD+11
ICTMFLG5 EQU   ICTMOD+12
ICTMPASS EQU   ICTMFLG5
ICTMODF4 EQU   ICTMOD+13
ICTMLEP1 EQU   ICTMODF4
ICTMODF5 EQU   ICTMOD+14
ICTMLEP2 EQU   ICTMODF5
ICTMODF6 EQU   ICTMOD+15
ICTMLEP3 EQU   ICTMODF6
ICTMODF7 EQU   ICTMOD+16
ICTMLEP4 EQU   ICTMODF7
ICTMACF4 EQU   ICTMOD+17
ICTMCHN  EQU   ICTMOD+100
ICTMICHN EQU   ICTMOD+104
ICTMACHN EQU   ICTMOD+112
ICTMTCHN EQU   ICTMOD+116
ICTMVCHN EQU   ICTMOD+120
ICTMUCHN EQU   ICTMOD+124
ICTIXMF  EQU   0
ICTMIDLS EQU   0
ICTMID   EQU   ICTMIDLS
ICTMODID EQU   ICTMID
ICTMODST EQU   ICTMID+7
ICTASMLS EQU   0
ICTASMAD EQU   ICTASMLS
ICTTALLS EQU   0
ICTTALNM EQU   ICTTALLS
ICTMVRLS EQU   0
ICTMVRNT EQU   ICTMVRLS
ICTMVRNM EQU   ICTMVRNT
ICTMUMLS EQU   0
ICTMUMNT EQU   ICTMUMLS
ICTMUMNM EQU   ICTMUMNT
ICTLMOD  EQU   0
ICTLMNAM EQU   ICTLMOD
ICTLNAME EQU   ICTLMNAM
ICTLEND  EQU   ICTLNAME
ICTLFLG4 EQU   ICTLMOD+8
ICTLPASS EQU   ICTLFLG4
ICTLFLG1 EQU   ICTLMOD+9
ICTLFLG5 EQU   ICTLMOD+10
ICTLFLG6 EQU   ICTLMOD+11
ICTLFLG7 EQU   ICTLMOD+12
ICTLFLG2 EQU   ICTLMOD+13
ICTLFLG3 EQU   ICTLMOD+14
ICTLCHN  EQU   ICTLMOD+34
ICTIXLF  EQU   0
TBLXPARM EQU   0
TBLXINDX EQU   TBLXPARM+4
TBLXTBL  EQU   TBLXPARM+28
TBLXCDSI EQU   TBLXPARM+60
TBLXFUNC EQU   TBLXPARM+64
TBLXFLG1 EQU   TBLXPARM+80
TBLXRC   EQU   TBLXPARM+92
TBLXOPTS EQU   0
TBLFLAGS EQU   TBLXOPTS+8
TBLFLG1  EQU   TBLFLAGS
TBLFLG2  EQU   TBLFLAGS+2
TBLFLG3  EQU   TBLFLAGS+3
TBLFLG4  EQU   TBLFLAGS+5
TBLFLG5  EQU   TBLFLAGS+7
TSBRTN   EQU   0
LICPTR31 EQU   0
RST2SMD  EQU   0
RST2PTR  EQU   0
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00025 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
PARM1    EQU   0
CDSCIOPP EQU   0
RST1ENT  EQU   0
RST1LST@ EQU   0
RST1CAND EQU   0
RST1INCR EQU   0
RST2ENT  EQU   0
RST2LSTI EQU   0
RSTMENT  EQU   0
RSTMNOGO EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00066 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00077 EQU   IOPUDATA
@NM00078 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00087 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00098 EQU   IOPSRCDR+1
@NM00100 EQU   @NM00098+7
@NM00104 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00108 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00114 EQU   IOPMODDR+1
@NM00116 EQU   @NM00114+7
@NM00120 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00124 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00135 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00142 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPERROR EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPSBYP  EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPPTFFX EQU   IOPPTFNT+24
@NM00151 EQU   IOPPTFFX
@NM00152 EQU   @NM00151
IOPPDTES EQU   IOPPTFFX+41
@NM00155 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPPTFND EQU   IOPPMODS
IOPPIND  EQU   IOPPNTRY+8
IOPENTNT EQU   IOPUDATA+104
IOPENTNM EQU   IOPENTNT
IOPENTST EQU   IOPENTNT+7
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00180 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00180
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00184 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00184
IOPBFTB1 EQU   IOPBFTB0
ICTENDNT EQU   ICTENDCH
ICTENDIX EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00186 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00185 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00183 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00182 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00181 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00179 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00178 EQU   IOPPTSFX+35
@NM00177 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00176 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00175 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00174 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00173 EQU   IOPQFMDR
@NM00169 EQU   IOPQSMDR
@NM00168 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00167 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00166 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00165 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00164 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00163 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00162 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00161 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00160 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00159 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00158 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00157 EQU   IOPENTNT+8
IOPPFMID EQU   IOPPTFFX+73
@NM00156 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00155+3
IOPRECD  EQU   @NM00155
@NM00154 EQU   IOPPTFFX+8
@NM00153 EQU   @NM00151+7
IOPPRELN EQU   @NM00152
@NM00150 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00149 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00148 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
@NM00147 EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00146 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00145 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00144 EQU   @NM00142+7
@NM00143 EQU   @NM00142
@NM00141 EQU   IOPSYSDR+5
@NM00140 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00139 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00138 EQU   IOPDLBFX+8
@NM00137 EQU   @NM00135+7
@NM00136 EQU   @NM00135
@NM00134 EQU   IOPDLBDR+1
@NM00133 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00132 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00131 EQU   IOPMODFX+12
@NM00130 EQU   IOPMODF4
@NM00129 EQU   IOPMODF3
@NM00128 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00127 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00126 EQU   @NM00124+7
@NM00125 EQU   @NM00124
@NM00123 EQU   IOPMODDR+17
@NM00122 EQU   @NM00120+7
@NM00121 EQU   @NM00120
@NM00119 EQU   @NM00116
@NM00118 EQU   @NM00116
@NM00117 EQU   @NM00116
@NM00115 EQU   @NM00114
@NM00113 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00112 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00111 EQU   IOPSRCFX+8
@NM00110 EQU   @NM00108+7
@NM00109 EQU   @NM00108
@NM00107 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00106 EQU   @NM00104+7
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00100
@NM00102 EQU   @NM00100
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00098
@NM00097 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00096 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00095 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00094 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00093 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00092 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00091 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00089 EQU   @NM00087+7
@NM00088 EQU   @NM00087
@NM00086 EQU   IOPLMDDR+6
@NM00085 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00084 EQU   IOPLMDF4
@NM00083 EQU   IOPLMDF3
@NM00082 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00081 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00080 EQU   IOPLMDDR
@NM00079 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00078+4
IOPUSED  EQU   @NM00078
IOPTPSEQ EQU   @NM00077+8
IOPVLSER EQU   @NM00077+2
IOPBLKSI EQU   @NM00077
IOPCQMAX EQU   IOPCQMAP+12
@NM00076 EQU   IOPCQMAP+11
@NM00075 EQU   IOPCQMAP+8
@NM00074 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00073 EQU   IOPSCMAP+11
@NM00072 EQU   IOPSCMAP+8
@NM00071 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00070 EQU   IOPNTMAX+11
@NM00069 EQU   IOPNTMAX+8
@NM00068 EQU   IOPNTMAX
@NM00067 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00066+5
IOPIPTF3 EQU   @NM00066
CCAEND   EQU   HMASMCCA+371
@NM00040 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00039 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00038 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00037 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00036 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00035 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00034 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00033 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00032 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00031 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00030 EQU   @NM00025+18
@NM00029 EQU   @NM00025+16
CCATBLPA EQU   @NM00025+12
@NM00028 EQU   @NM00025+8
@NM00027 EQU   @NM00025+4
@NM00026 EQU   @NM00025
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00024 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00023 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00022 EQU   CCAFBUFR+122
@NM00021 EQU   CCAFBUFR+120
@NM00020 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00019 EQU   CCAFBUFR+88
@NM00018 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00017 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00254 EQU   TBLFLG5
TBLICTOK EQU   TBLFLG5
@NM00253 EQU   TBLFLG4
TBLBPFM  EQU   TBLFLG4
@NM00252 EQU   TBLFLG4
TBLBPIRQ EQU   TBLFLG4
TBLBPREQ EQU   TBLFLG4
TBLBPPRE EQU   TBLFLG4
TBLBPID  EQU   TBLFLG4
@NM00251 EQU   TBLFLG3+1
TBLSTS   EQU   TBLFLG3
TBLMTS   EQU   TBLFLG3
TBLPTS   EQU   TBLFLG3
TBLACRQ  EQU   TBLFLG3
TBLCRQ   EQU   TBLFLG3
TBLSCDS  EQU   TBLFLG3
TBLACDS  EQU   TBLFLG3
TBLCDS   EQU   TBLFLG3
TBLMASS  EQU   TBLFLG2
@NM00250 EQU   TBLFLG2
TBLFMID  EQU   TBLFLG2
TBLGROUP EQU   TBLFLG2
TBLEXC   EQU   TBLFLG2
TBLSEL   EQU   TBLFLG2
@NM00249 EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
TBLDISR  EQU   TBLFLG1+1
TBLDISN  EQU   TBLFLG1+1
TBLNOJCL EQU   TBLFLG1
TBLFLUSH EQU   TBLFLG1
TBLUSER  EQU   TBLFLG1
TBLAPAR  EQU   TBLFLG1
TBLCOMP  EQU   TBLFLG1
TBLASSEM EQU   TBLFLG1
TBLCHECK EQU   TBLFLG1
TBLNOAPP EQU   TBLFLG1
@NM00248 EQU   TBLXOPTS+5
TBLNUCID EQU   TBLXOPTS+4
TBLJCLGT EQU   TBLXOPTS
TBLXEND0 EQU   TBLXPARM+124
@NM00247 EQU   TBLXPARM+108
TBLXIOP3 EQU   TBLXPARM+104
TBLXD2GT EQU   TBLXPARM+100
TBLXDLGT EQU   TBLXPARM+96
@NM00246 EQU   TBLXRC+3
TBLXIRC  EQU   TBLXRC+2
TBLXLRC  EQU   TBLXRC+1
TBLXTRC  EQU   TBLXRC
TBLXIBGN EQU   TBLXPARM+88
TBLXTSLP EQU   TBLXPARM+84
@NM00245 EQU   TBLXPARM+83
@NM00244 EQU   TBLXPARM+82
@NM00243 EQU   TBLXPARM+81
@NM00242 EQU   TBLXFLG1
TBLXTCRC EQU   TBLXFLG1
TBLXFUND EQU   TBLXPARM+72
@NM00241 EQU   TBLXPARM+62
TBLXCRQI EQU   TBLXPARM+61
TBLXLMGT EQU   TBLXPARM+56
TBLXSCGT EQU   TBLXPARM+52
TBLXSREL EQU   TBLXPARM+48
TBLXASGT EQU   TBLXPARM+44
TBLXIFGT EQU   TBLXPARM+40
TBLXNULL EQU   TBLXPARM+36
TBLXTOP  EQU   TBLXPARM+32
TBLXSEGT EQU   TBLXPARM+24
TBLXIOPF EQU   TBLXPARM+20
TBLXIOP2 EQU   TBLXPARM+16
TBLXEND  EQU   TBLXINDX+8
TBLXSTRT EQU   TBLXINDX+4
TBLXCUR  EQU   TBLXINDX
TBLXHDR  EQU   TBLXPARM
ICTIXL   EQU   ICTIXLF
@NM00240 EQU   ICTLMOD+38
ICTLTTR  EQU   ICTLMOD+31
ICTTG2   EQU   ICTLMOD+23
ICTTG1   EQU   ICTLMOD+15
@NM00239 EQU   ICTLFLG3
ICTLZAP  EQU   ICTLFLG3
ICTLLKD  EQU   ICTLFLG3
ICTLCPY  EQU   ICTLFLG3
ICTLXPND EQU   ICTLFLG3
ICTTIND2 EQU   ICTLFLG3
ICTTIND1 EQU   ICTLFLG3
@NM00238 EQU   ICTLFLG2
ICTLDEL  EQU   ICTLFLG2
@NM00237 EQU   ICTLFLG2
ICTLTDEL EQU   ICTLFLG2
ICTLINK  EQU   ICTLFLG2
ICTCOPY  EQU   ICTLFLG2
@NM00236 EQU   ICTLFLG7
@NM00235 EQU   ICTLFLG6
@NM00234 EQU   ICTLFLG5
ICTLPAGA EQU   ICTLFLG5
ICTLNE   EQU   ICTLFLG5
@NM00233 EQU   ICTLFLG1
ICTLDC   EQU   ICTLFLG1
ICTLREFR EQU   ICTLFLG1
ICTLOVLY EQU   ICTLFLG1
ICTLSCTR EQU   ICTLFLG1
ICTLREUS EQU   ICTLFLG1
ICTLRENT EQU   ICTLFLG1
ICTLAPF  EQU   ICTLFLG1
@NM00232 EQU   ICTLFLG4
ICTLDDCK EQU   ICTLFLG4
ICTLMSG  EQU   ICTLFLG4
ICTLCPL  EQU   ICTLFLG4
ICTLNOGO EQU   ICTLFLG4
ICTLPROC EQU   ICTLFLG4
@NM00231 EQU   ICTMUMNT+7
ICTMUMND EQU   ICTMUMNM
@NM00230 EQU   ICTMVRNT+7
ICTMVRND EQU   ICTMVRNM
ICTTALND EQU   ICTTALNM
ICTASMND EQU   ICTASMAD
ICTMIDTY EQU   ICTMODST
ICTMIDAM EQU   ICTMODST
ICTMIDRG EQU   ICTMODST
ICTMIDF1 EQU   ICTMODST
ICTMIDPL EQU   ICTMODST
ICTMIDPS EQU   ICTMODST
@NM00229 EQU   ICTMODST
ICTMIDND EQU   ICTMODID
ICTIXM   EQU   ICTIXMF
@NM00228 EQU   ICTMOD+128
ICTMICHA EQU   ICTMOD+108
ICTPPTR  EQU   ICTMOD+96
@NM00227 EQU   ICTMOD+95
ICTMFMID EQU   ICTMOD+88
@NM00226 EQU   ICTMOD+87
ICTMRMID EQU   ICTMOD+80
ICTMSSI  EQU   ICTMOD+72
ICTMDOBJ EQU   ICTMOD+64
ICTMSYSL EQU   ICTMOD+56
ICTMDSTL EQU   ICTMOD+48
ICTMASLB EQU   ICTMOD+40
ICTTOLIB EQU   ICTMOD+32
ICTFMLIB EQU   ICTMOD+24
ICTMRELN EQU   ICTMOD+22
@NM00225 EQU   ICTMOD+21
ICTMLANG EQU   ICTMOD+20
@NM00224 EQU   ICTMOD+19
ICTMACF5 EQU   ICTMOD+18
ICTMZMPR EQU   ICTMACF4
ICTMZOMZ EQU   ICTMACF4
ICTMDOAS EQU   ICTMACF4
ICTMXUPD EQU   ICTMACF4
ICTMFXC  EQU   ICTMACF4
ICTMFXBS EQU   ICTMACF4
ICTMHASM EQU   ICTMACF4
ICTMACDL EQU   ICTMACF4
@NM00223 EQU   ICTMLEP4
@NM00222 EQU   ICTMLEP3
@NM00221 EQU   ICTMLEP2
ICTMPAGA EQU   ICTMLEP2
ICTMNE   EQU   ICTMLEP2
@NM00220 EQU   ICTMLEP1
ICTMDC   EQU   ICTMLEP1
ICTMREFR EQU   ICTMLEP1
ICTMOVLY EQU   ICTMLEP1
ICTMSCTR EQU   ICTMLEP1
ICTMREUS EQU   ICTMLEP1
ICTMRENT EQU   ICTMLEP1
ICTMAPF  EQU   ICTMLEP1
@NM00219 EQU   ICTMFLG5
ICTMNORL EQU   ICTMFLG5
ICTMELCK EQU   ICTMFLG5
ICTMCOPY EQU   ICTMFLG5
@NM00218 EQU   ICTMFLG4
ICTMTSEL EQU   ICTMFLG4
ICTMDSTE EQU   ICTMFLG4
ICTMMIDE EQU   ICTMFLG4
ICTMASOC EQU   ICTMFLG4
ICTMSELM EQU   ICTMFLG4
ICTMIDEL EQU   ICTMFLG4
ICTMISEL EQU   ICTMFLG4
@NM00217 EQU   ICTMFLG3
ICTMPRMS EQU   ICTMFLG3
ICTMALIS EQU   ICTMFLG3
ICTMWRK  EQU   ICTMFLG3
ICTMTRX  EQU   ICTMFLG3
ICTMRELF EQU   ICTMFLG3
ICTLIBTX EQU   ICTMFLG3
ICTLIBLK EQU   ICTMFLG3
ICTMSRCU EQU   ICTMFLG1
ICTMSRCR EQU   ICTMFLG1
ICTMMACU EQU   ICTMFLG1
ICTMMACR EQU   ICTMFLG1
ICTMXPND EQU   ICTMFLG1
ICTMZAP  EQU   ICTMFLG1
ICTMASM  EQU   ICTMMODR
ICTMMOD  EQU   ICTMMODR
@NM00216 EQU   ICTMFLG2
@NM00215 EQU   ICTMFLG2
ICTMMIDU EQU   ICTMFLG2
ICTMDEL  EQU   ICTMFLG2
ICTMMSG  EQU   ICTMFLG2
ICTMCPL  EQU   ICTMFLG2
ICTMNOGO EQU   ICTMFLG2
ICTMPROC EQU   ICTMFLG2
@NM00214 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00213 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00212 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00211 EQU   ICTCSRST
@NM00210 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00209 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00208 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00207 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00206 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00205 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00204 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00203 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00202 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00201 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00200 EQU   ICTENTST
ICTIXP   EQU   ICTIXPF
@NM00199 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPONUM EQU   ICTPTF+18
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00198 EQU   @NM00197
ICTPRQBY EQU   @NM00197
ICTPRQOK EQU   @NM00197
ICTPRQCK EQU   @NM00197
@NM00196 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00195 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00194 EQU   ICTPFLG4
@NM00193 EQU   ICTPFLG4
@NM00192 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00191 EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00190 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00189 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00188 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00187 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00172 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00171 EQU   @NM00170+7
IOPQSMFM EQU   @NM00170
@NM00090 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00065 EQU   IOPUSERL
@NM00064 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00063 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00062 EQU   @NM00059+10
IOPSEQNO EQU   @NM00059+8
@NM00061 EQU   @NM00060+7
IOPPTFNM EQU   @NM00060
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00058 EQU   CCABLDLM+2
@NM00057 EQU   CCABLDLM
CCAUPDPM EQU   @NM00055+24
@NM00056 EQU   @NM00055+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00055+12
CCAUPDTE EQU   @NM00055+8
CCAUPDNM EQU   @NM00055
CCASUPPM EQU   @NM00053+24
@NM00054 EQU   @NM00053+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00053+12
CCAIOSUP EQU   @NM00053+8
CCASUPNM EQU   @NM00053
CCAZAPPM EQU   @NM00051+24
@NM00052 EQU   @NM00051+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00051+12
CCASPZAP EQU   @NM00051+8
CCAZAPNM EQU   @NM00051
CCACOMPM EQU   @NM00049+24
@NM00050 EQU   @NM00049+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00049+12
CCACOMRS EQU   @NM00049+8
CCACOMNM EQU   @NM00049
CCACPYPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00047+12
CCACOPY  EQU   @NM00047+8
CCACPYNM EQU   @NM00047
CCAASMPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00045+12
CCAASM   EQU   @NM00045+8
CCAASMNM EQU   @NM00045
CCALKDPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00043+12
CCALKED  EQU   @NM00043+8
CCALKDNM EQU   @NM00043
CCAPGMPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCABPGRC EQU   @NM00041+20
CCABPGSP EQU   @NM00041+12
CCABPGAD EQU   @NM00041+8
CCABPGNM EQU   @NM00041
TSLRRTNP EQU   TSLRELM+12
TSLRAPTR EQU   TSLRELM+8
@NM00016 EQU   TSLRELM+7
TSLRSMD  EQU   TSLRELM
@NM00015 EQU   TSLENTSR+3
@NM00014 EQU   TSLEOPTF
@NM00013 EQU   TSLSICDS+19
TSLSDUM  EQU   TSLSCDSF
@NM00012 EQU   TSLSCDSF
@NM00011 EQU   TSLSCDSF
@NM00010 EQU   TSLSICDS+17
TSLSINOG EQU   TSLSICTF
TSLSIDLI EQU   TSLSICTF
TSLSIDLE EQU   TSLSICTF
TSLSIDEL EQU   TSLSICTF
TSLSIOK  EQU   TSLSICTF
@NM00009 EQU   TSLSOPTF
TSLSOXTD EQU   TSLSOPTF
TSLSOMSG EQU   TSLSOPTF
@NM00008 EQU   TSLGOPTF
@NM00007 EQU   TSLGOPTF
@NM00006 EQU   TSLGOPTF
@NM00005 EQU   TSLGOPTF
@NM00004 EQU   TSLLOPTF
@NM00003 EQU   TSLICTSR+13
@NM00002 EQU   TSLICTF
@NM00001 EQU   TSLIOPTF
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00246 EQU   @RC00243
@RC00256 EQU   @RC00243
@RC00274 EQU   @RC00243
@RF00284 EQU   @RC00243
@RC00450 EQU   @RC00442
@RC00508 EQU   @EL00006
@RC00531 EQU   @EL00006
@RC00536 EQU   @EL00006
@RC00541 EQU   @EL00006
@RF00268 EQU   @RC00256
@RC00510 EQU   @RC00508
@RC00515 EQU   @RC00508
@RC00520 EQU   @RC00508
@ENDDATA EQU   *
         END   HMASMTSB,(C'PLS2223',0802,78334)

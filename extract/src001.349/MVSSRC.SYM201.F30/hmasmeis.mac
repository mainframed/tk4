         TITLE 'HMASMEIS - SMP ENTRIES IN STORAGE'
HMASMEIS CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMEIS  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0179
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FIRST SEGMENT OF CODE WILL PERFORM INITIALIZATION FOR     */
*   /* HMASMEIS. THE DATA SET ID AND FUNCTION IN THE IOP PASSED BY   */
*   /* THE USER ARE CHECKED TO SEE IF THEY ARE SUPPORTED BY HMASMEIS.*/
*   /* IF THEY ARE NOT A RETURN CODE OF 16 IS SET                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0179
*   EISRC=IOPGOOD;                  /* INIT RC TO GOOD               */
         SLR   EISRC,EISRC                                         0179
*   EISSW1='';                      /* INIT TO INVALID DATA SET AND
*                                      TO INVALID FUNCTION           */
         MVI   EISSW1,X'00'                                        0180
*   IOPPTR=ADDR(EISMIOP);           /* ADDRESS OF INPUT PARM         */
*                                                                  0181
         L     IOPPTR,@PC00001                                     0181
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO SETUP VARIOUS INDICIES TO ARRAY AND GTPS USED */
*   /* DURING PROCESSING. ALSO CHECK PARAMETER LIST FOR VALIDITY     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0182
*                                   /*                               */
*   CALL EISSETUP;                  /*                               */
         BAL   @14,EISSETUP                                        0182
*   RFY                                                            0183
*     RTNCODE RSTD;                 /*                               */
*   EISRC=MAX(EISRC,RTNCODE);       /*                               */
         CR    EISRC,RTNCODE                                       0184
         BNL   *+6
         LR    EISRC,RTNCODE                                       0184
*   RFY                                                            0185
*     RTNCODE UNRSTD;               /*                               */
         EJECT
*                                                                  0186
*   /*****************************************************************/
*   /*                                                               */
*   /* BASED ON THE VALUE IN FNCINDX DETERMINE THE PROPER SUBROUTINE */
*   /* TO CALL AND CALL IT. SGTPINDX IS SET UP TO USE THE GTP FOR THE*/
*   /* DIS GTP TO USE THIS TIME                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0186
*   IF EISRC=IOPGOOD                /* IF VALID DSID AND FUNC        */
*     THEN                          /* THEN DO                       */
         SLR   @11,@11                                             0186
         CR    EISRC,@11                                           0186
         BNE   @RF00186                                            0186
*     DO;                           /* THEN DO                       */
*       IF DSFIRST(PGTPINDX)=ZERO   /* IF FIRST TIME FOR THIS DIS  0188
*                                      FILE                  @Z67SP00*/
*         THEN                      /* ACCESS FOR DATASET            */
         SLR   @08,@08                                             0188
         IC    @08,PGTPINDX                                        0188
         SLR   @05,@05                                             0188
         IC    @05,DSFIRST-1(@08)                                  0188
         CR    @11,@05                                             0188
         BNE   @RF00188                                            0188
*         DO;                       /*                       @Z67SP00*/
*           HMASMGTP(PGTPINDX)=''B; /* ZERO PROPER GTP       @Z67SP00*/
         LR    @11,@08                                             0190
         MH    @11,@CH00467                                        0190
         LA    @05,HMASMGTP-28(@11)                                0190
         XC    0(28,@05),0(@05)                                    0190
*           GTPRCDLN(PGTPINDX)=DSDIRLN(PDSINDX);/* SET RCD LEN FROM
*                                      VALUE IN CONTROL ARRAY      0191
*                                                            @Z67SP00*/
         LR    @05,PDSINDX                                         0191
         MH    @05,@CH01521                                        0191
         SLR   @02,@02                                             0191
         IC    @02,DSDIRLN-103(@05)                                0191
         STH   @02,GTPRCDLN-28(@11)                                0191
*           GTPKEYLN(PGTPINDX)=KEYLEN;/* KEY LEN = 8         @Z67SP00*/
         LA    @05,8                                               0192
         STH   @05,GTPKEYLN-28(@11)                                0192
*           GTPNOSPM(PGTPINDX)=ON;  /* NO MSG IF UNABLE TO ADD RCD TO
*                                      FILE                  @Z67SP00*/
         LA    @05,GTPNOSPM-28(@11)                                0193
         OI    0(@05),B'10000000'                                  0193
*           DSFIRST(PGTPINDX)=ONE;  /* SET NOT FIRST SW      @Z67SP00*/
         LA    @11,1                                               0194
         STC   @11,DSFIRST-1(@08)                                  0194
*         END;                      /*                       @Z67SP00*/
*       IF DSFIRST(SGTPINDX)=ZERO   /* IF FIRST TIME FOR THIS DIS  0196
*                                      FILE                  @Z67SP00*/
*         THEN                      /* ACCESS FOR DATASET            */
@RF00188 SLR   @11,@11                                             0196
         IC    @11,SGTPINDX                                        0196
         SLR   @08,@08                                             0196
         IC    @08,DSFIRST-1(@11)                                  0196
         CH    @08,@CH00252                                        0196
         BNE   @RF00196                                            0196
*         DO;                       /*                       @Z67SP00*/
*           HMASMGTP(SGTPINDX)=''B; /* ZERO PROPER GTP       @Z67SP00*/
         LR    @08,@11                                             0198
         MH    @08,@CH00467                                        0198
         LA    @05,HMASMGTP-28(@08)                                0198
         XC    0(28,@05),0(@05)                                    0198
*           GTPRCDLN(SGTPINDX)=DSDIRLN(SDSINDX);/* SET RCD LEN FROM
*                                      VALUE IN CONTROL ARRAY      0199
*                                                            @Z67SP00*/
         SLR   @05,@05                                             0199
         IC    @05,SDSINDX                                         0199
         MH    @05,@CH01521                                        0199
         SLR   @02,@02                                             0199
         IC    @02,DSDIRLN-103(@05)                                0199
         STH   @02,GTPRCDLN-28(@08)                                0199
*           GTPKEYLN(SGTPINDX)=KEYLEN;/* KEY LEN = 8         @Z67SP00*/
         LA    @05,8                                               0200
         STH   @05,GTPKEYLN-28(@08)                                0200
*           GTPNOSPM(SGTPINDX)=ON;  /* NO MSG IF UNABLE TO ADD RCD TO
*                                      FILE                  @Z67SP00*/
         LA    @05,GTPNOSPM-28(@08)                                0201
         OI    0(@05),B'10000000'                                  0201
*           DSFIRST(SGTPINDX)=ONE;  /* SET NOT FIRST SW      @Z67SP00*/
         LA    @08,1                                               0202
         STC   @08,DSFIRST-1(@11)                                  0202
*         END;                      /*                       @Z67SP00*/
*       CALL EISRTN;                /* PERFORM FUNCTION              */
@RF00196 SLR   @11,@11                                             0204
         IC    @11,FNCINDX                                         0204
         SLA   @11,3                                               0204
         L     @15,FNCADDR-8(@11)                                  0204
         BALR  @14,@15                                             0204
*       RFY                                                        0205
*         RTNCODE RSTD;                                            0205
*       EISRC=RTNCODE;              /* SAVE EISRTN RETURN CODE       */
         LR    EISRC,RTNCODE                                       0206
*       RFY                                                        0207
*         RTNCODE UNRSTD;                                          0207
*     END;                                                         0208
*   IOPRETRN=EISRC;                 /* RETURN CODE TO USER           */
@RF00186 STC   EISRC,IOPRETRN(,IOPPTR)                             0209
*   RETURN CODE(EISRC);                                            0210
         LR    @15,EISRC                                           0210
         L     @13,4(,@13)                                         0210
         L     @14,12(,@13)                                        0210
         LM    @00,@12,20(@13)                                     0210
         BR    @14                                                 0210
         EJECT
*                                                                  0211
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO VERIFY THE INPUT PARAMETER FOR VALID        */
*   /* FUNCTION AND DATASETID. IF BOTH ARE OK THEN THIS ROUTINE WILL */
*   /* ALSO SET UP VARIOUS INDICIES INTO THE GTP ARRAY AND OTHER     */
*   /* ARRAYS IN THE MODULE FOR BOTH THE PRIMARY AND SECONDARY       */
*   /* PROCESSING FILES.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0211
*EISSETUP:                          /*                               */
*   PROCEDURE;                      /*                               */
EISSETUP STM   @14,@02,12(@13)                                     0211
         STM   @04,@12,36(@13)                                     0211
*   DECLARE                         /*                               */
*     SETUPRC FIXED(8);             /* LOCAL RC                      */
*   RFY                             /*                       @Z67SP00*/
*     HMASMIOP BASED(IOPPTR);       /*                       @Z67SP00*/
*   SETUPRC=ZERO;                   /* INIT RC                       */
*                                                                  0214
         SLR   SETUPRC,SETUPRC                                     0214
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO INSURE DATASET VALID. IF NOT SET RC=16               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0215
*   DO PDSINDX=ONE TO DIM(DSARRAY)  /* SEE IF DSID SUPPORTED         */
*         WHILE(VALDSNSW=OFF);                                     0215
         LA    PDSINDX,1                                           0215
@DL00215 TM    VALDSNSW,B'10000000'                                0215
         BNZ   @DC00215                                            0215
*     IF IOPDSID=DSMAIN(PDSINDX)    /* IF MATCH THEN TURN VALID      */
*       THEN                        /*                               */
         LR    @11,PDSINDX                                         0216
         MH    @11,@CH01521                                        0216
         SLR   @08,@08                                             0216
         IC    @08,IOPDSID(,IOPPTR)                                0216
         SLR   @05,@05                                             0216
         IC    @05,DSMAIN-103(@11)                                 0216
         CR    @08,@05                                             0216
         BNE   @RF00216                                            0216
*       VALDSNSW=ON;                /* DATASET SWITCH ON             */
         OI    VALDSNSW,B'10000000'                                0217
*   END;                                                           0218
@RF00216 AH    PDSINDX,@CH00087                                    0218
         CH    PDSINDX,@CH00112                                    0218
         BNH   @DL00215                                            0218
@DC00215 DS    0H                                                  0219
*   IF VALDSNSW=ON                  /* IF VALID DATASET      @Z67SP00*/
*     THEN                          /*                               */
         TM    VALDSNSW,B'10000000'                                0219
         BNO   @RF00219                                            0219
*     DO;                           /*                       @Z67SP00*/
*       PDSINDX=PDSINDX-ONE;        /* SET PRIMARY INDEX     @Z67SP00*/
         BCTR  PDSINDX,0                                           0221
*       SDSINDX=PDSINDX+NUMDS/2;    /* SET SECONDARY INDEX   @Z67SP00*/
         LA    @11,4(,PDSINDX)                                     0222
         STC   @11,SDSINDX                                         0222
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /* INVALID DATASET       @Z67SP00*/
*     SETUPRC=IOPIOERR;             /*                               */
*                                                                  0224
         B     @RC00219                                            0224
@RF00219 LA    SETUPRC,16                                          0224
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO INSURE FUNCTION REQUESTED VALID. IF NOT SET RC=16.   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0225
*   IF SETUPRC=ZERO                 /* IF VALID DSID THEN CHECK      */
*     THEN                                                         0225
@RC00219 CH    SETUPRC,@CH00252                                    0225
         BNE   @RF00225                                            0225
*     DO;                           /*                       @Z67SP00*/
*       DO FNCINDX=ONE TO DIM(FNCARRAY)/* FOR VALID FUNCTION         */
*             WHILE(VALFNCSW=OFF);  /*                               */
         LA    @11,1                                               0227
         STC   @11,FNCINDX                                         0227
@DL00227 TM    VALFNCSW,B'01000000'                                0227
         BNZ   @DC00227                                            0227
*         IF IOPFUNCT=FNCIOPCD(FNCINDX)/* IF MATCH THEN TURN VALID   */
*           THEN                    /*                               */
         SLA   @11,3                                               0228
         SLR   @08,@08                                             0228
         IC    @08,IOPFUNCT(,IOPPTR)                               0228
         SLR   @05,@05                                             0228
         IC    @05,FNCIOPCD-8(@11)                                 0228
         CR    @08,@05                                             0228
         BNE   @RF00228                                            0228
*           VALFNCSW=ON;            /* FUNCTION SWITCH ON            */
         OI    VALFNCSW,B'01000000'                                0229
*       END;                                                       0230
@RF00228 LA    @11,1                                               0230
         SLR   @08,@08                                             0230
         IC    @08,FNCINDX                                         0230
         ALR   @11,@08                                             0230
         STC   @11,FNCINDX                                         0230
         CH    @11,@CH00436                                        0230
         BNH   @DL00227                                            0230
@DC00227 DS    0H                                                  0231
*       IF VALFNCSW=ON              /* IF FUNCTION VALID     @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         TM    VALFNCSW,B'01000000'                                0231
         BNO   @RF00231                                            0231
*         FNCINDX=FNCINDX-ONE;      /* ADJUST INDEX          @Z67SP00*/
         SLR   @11,@11                                             0232
         IC    @11,FNCINDX                                         0232
         BCTR  @11,0                                               0232
         STC   @11,FNCINDX                                         0232
*       ELSE                        /*                       @Z67SP00*/
*         SETUPRC=IOPIOERR;         /* RC=16                 @Z67SP00*/
         B     @RC00231                                            0233
@RF00231 LA    SETUPRC,16                                          0233
*     END;                                                         0234
*                                                                  0234
@RC00231 DS    0H                                                  0235
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FUNCTION AND DATASET OK THEN SET UP INDEX FOR CORRECT GTP  */
*   /* TO USE DURING PROCESS BASED ON DATASET AND TYPE ENTRY. IF     */
*   /* INVALID COMBINATION SET RC=16.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0235
*   IF SETUPRC=ZERO                 /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00225 CH    SETUPRC,@CH00252                                    0235
         BNE   @RF00235                                            0235
*     DO;                           /*                       @Z67SP00*/
*       IF IOPFUNCT=IOPINIT         /* USE FIRST GTP FILE    @Z67SP00*/
*           ×IOPFUNCT=IOPFREE       /* FOR THESE FUNCTIONS   @Z67SP00*/
*           ×IOPFUNCT=IOPCLOSN      /*                       @Z67SP00*/
*           ×IOPFUNCT=IOPWRDIR      /*                       @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         CLI   IOPFUNCT(IOPPTR),8                                  0237
         BE    @RT00237                                            0237
         CLI   IOPFUNCT(IOPPTR),9                                  0237
         BE    @RT00237                                            0237
         CLI   IOPFUNCT(IOPPTR),12                                 0237
         BE    @RT00237                                            0237
         CLI   IOPFUNCT(IOPPTR),89                                 0237
         BNE   @RF00237                                            0237
@RT00237 DS    0H                                                  0238
*         DO;                       /*                       @Z67SP00*/
*           PGTPINDX=DSGTPFRS(PDSINDX);/*                    @Z67SP00*/
         LA    @11,103                                             0239
         LR    @01,PDSINDX                                         0239
         MR    @00,@11                                             0239
         SLR   @08,@08                                             0239
         IC    @08,DSGTPFRS-103(@01)                               0239
         STC   @08,PGTPINDX                                        0239
*           SGTPINDX=DSGTPFRS(SDSINDX);/*                    @Z67SP00*/
         LR    @01,@11                                             0240
         SLR   @11,@11                                             0240
         IC    @11,SDSINDX                                         0240
         MR    @00,@11                                             0240
         SLR   @11,@11                                             0240
         IC    @11,DSGTPFRS-103(@01)                               0240
         STC   @11,SGTPINDX                                        0240
*         END;                      /*                       @Z67SP00*/
*       ELSE                        /*                       @Z67SP00*/
*         IF IOPFUNCT=IOPLOC        /* GTP BASED ON TYPE AND @Z67SP00*/
*             ×IOPFUNCT=IOPBLDL     /*                       @Z67SP00*/
*             ×IOPFUNCT=IOPUDEO     /* DATASET FOR THESE     @Z67SP00*/
*             ×IOPFUNCT=IOPSTOWR    /* FUNCTIONS             @Z67SP00*/
*             ×IOPFUNCT=IOPSTOWD    /*                       @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         B     @RC00237                                            0242
@RF00237 CLI   IOPFUNCT(IOPPTR),3                                  0242
         BE    @RT00242                                            0242
         CLI   IOPFUNCT(IOPPTR),4                                  0242
         BE    @RT00242                                            0242
         CLI   IOPFUNCT(IOPPTR),86                                 0242
         BE    @RT00242                                            0242
         CLI   IOPFUNCT(IOPPTR),84                                 0242
         BE    @RT00242                                            0242
         CLI   IOPFUNCT(IOPPTR),83                                 0242
         BNE   @RF00242                                            0242
@RT00242 DS    0H                                                  0243
*           DO;                     /*                       @Z67SP00*/
*             PGTPINDX=GTP(IOPTYPE,PDSINDX);/*               @Z67SP00*/
         SLR   @11,@11                                             0244
         IC    @11,IOPTYPE(,IOPPTR)                                0244
         SLA   @11,3                                               0244
         LR    @08,PDSINDX                                         0244
         ALR   @08,@11                                             0244
         SLR   @05,@05                                             0244
         IC    @05,GTP-9(@08)                                      0244
         STC   @05,PGTPINDX                                        0244
*             SGTPINDX=GTP(IOPTYPE,SDSINDX);/*               @Z67SP00*/
         SLR   @08,@08                                             0245
         IC    @08,SDSINDX                                         0245
         ALR   @11,@08                                             0245
         SLR   @08,@08                                             0245
         IC    @08,GTP-9(@11)                                      0245
         STC   @08,SGTPINDX                                        0245
*           END;                    /*                       @Z67SP00*/
*         ELSE                      /*                       @Z67SP00*/
*           IF IOPFUNCT=IOPSTOWC    /*                       @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         B     @RC00242                                            0247
@RF00242 CLI   IOPFUNCT(IOPPTR),82                                 0247
         BNE   @RF00247                                            0247
*             DO;                   /*                       @Z67SP00*/
*               PGTPINDX=GTP(IOPOTYPE,PDSINDX);/*            @Z67SP00*/
         SLR   @11,@11                                             0249
         IC    @11,IOPOTYPE(,IOPPTR)                               0249
         SLA   @11,3                                               0249
         LR    @08,PDSINDX                                         0249
         ALR   @08,@11                                             0249
         SLR   @05,@05                                             0249
         IC    @05,GTP-9(@08)                                      0249
         STC   @05,PGTPINDX                                        0249
*               SGTPINDX=GTP(IOPOTYPE,SDSINDX);/*            @Z67SP00*/
         SLR   @08,@08                                             0250
         IC    @08,SDSINDX                                         0250
         ALR   @11,@08                                             0250
         SLR   @08,@08                                             0250
         IC    @08,GTP-9(@11)                                      0250
         STC   @08,SGTPINDX                                        0250
*             END;                  /*                       @Z67SP00*/
*           ELSE                    /*                       @Z67SP00*/
*             IF IOPFUNCT=IOPGETN   /* USE CURRENT GETN      @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
         B     @RC00247                                            0252
@RF00247 CLI   IOPFUNCT(IOPPTR),10                                 0252
         BNE   @RF00252                                            0252
*               DO;                 /*                       @Z67SP00*/
*                 PGTPINDX=DSGTPGN(PDSINDX);/*               @Z67SP00*/
         LA    @11,103                                             0254
         LR    @01,PDSINDX                                         0254
         MR    @00,@11                                             0254
         SLR   @08,@08                                             0254
         IC    @08,DSGTPGN-103(@01)                                0254
         STC   @08,PGTPINDX                                        0254
*                 SGTPINDX=DSGTPGN(SDSINDX);/*               @Z67SP00*/
         LR    @01,@11                                             0255
         SLR   @11,@11                                             0255
         IC    @11,SDSINDX                                         0255
         MR    @00,@11                                             0255
         SLR   @11,@11                                             0255
         IC    @11,DSGTPGN-103(@01)                                0255
         STC   @11,SGTPINDX                                        0255
*               END;                /*                       @Z67SP00*/
*       IF PGTPINDX=ZERO            /* IF NO PRIME GTP       @Z67SP00*/
*         THEN                      /* THEN INVALID          @Z67SP00*/
@RF00252 DS    0H                                                  0257
@RC00247 DS    0H                                                  0257
@RC00242 DS    0H                                                  0257
@RC00237 CLI   PGTPINDX,0                                          0257
         BNE   @RF00257                                            0257
*         SETUPRC=IOPIOERR;         /* COMBINATION           @Z67SP00*/
         LA    SETUPRC,16                                          0258
*     END;                          /*                       @Z67SP00*/
@RF00257 DS    0H                                                  0260
*   RETURN CODE(SETUPRC);           /*                       @Z67SP00*/
@RF00235 LR    @15,SETUPRC                                         0260
         L     @14,12(,@13)                                        0260
         LM    @00,@02,20(@13)                                     0260
         LM    @04,@12,36(@13)                                     0260
         BR    @14                                                 0260
*   END EISSETUP;                   /*                       @Z67SP00*/
         EJECT
*                                                                  0262
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED TO INITIALLY LOAD UP THE DIS FILE FROM */
*   /* THE APPROPRIATE SMP DATASET.                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0262
*EISINIT:                                                          0262
*   PROC;                                                          0262
EISINIT  STM   @14,@12,@SA00003                                    0262
*   DECLARE                         /*                       @Z67SP00*/
*     INITIOP CHAR(LENGTH(HMASMIOP)+LENGTH(IOPDIRMX));/* IOP FOR IO
*                                      CALLS                         */
*   DECLARE                         /*                       @Z67SP00*/
*     INITPTR PTR(31);              /* PTR TO LOCAL IOP      @Z67SP00*/
*   DECLARE                         /*                       @Z67SP00*/
*     INITRC FIXED(8);              /* EISINIT RETURN CODE           */
*   RFY                                                            0266
*     HMASMIOP BASED(INITPTR);                                     0266
*   INITRC=IOPGOOD;                 /* INIT RETURN CODE TO SUCCESSFUL*/
         SLR   INITRC,INITRC                                       0267
*   INITPTR=ADDR(INITIOP);          /*                       @Z67SP00*/
         LA    INITPTR,INITIOP                                     0268
*   IOPDSID=DSMAIN(PDSINDX);        /* PUT DSID IN IOP               */
         LR    @11,PDSINDX                                         0269
         MH    @11,@CH01521                                        0269
         SLR   @08,@08                                             0269
         IC    @08,DSMAIN-103(@11)                                 0269
         STC   @08,IOPDSID(,INITPTR)                               0269
*   IOPFUNCT=IOPCLOSN;              /* CLOSE FILE FOR GETN PROCESS   */
         MVI   IOPFUNCT(INITPTR),X'0C'                             0270
*   CALL HMASMIO(HMASMIOP);         /* CALL IO TO RETRIEVE RECORD    */
         ST    INITPTR,@AL00001                                    0271
         L     @15,@CV01269                                        0271
         LA    @01,@AL00001                                        0271
         BALR  @14,@15                                             0271
*   INITRC=MAX(INITRC,IOPRETRN);    /* SAVE RC                       */
         SLR   @11,@11                                             0272
         IC    @11,IOPRETRN(,INITPTR)                              0272
         CR    INITRC,@11                                          0272
         BNL   *+6
         LR    INITRC,@11                                          0272
*   IF INITRC=IOPGOOD               /* IF VALID REQUEST AND DS       */
*       &CCACHECK=OFF               /* AND NOT CHECK         @Z67SP00*/
*     THEN                          /* CLOSED OK                     */
         SLR   @11,@11                                             0273
         CR    INITRC,@11                                          0273
         BNE   @RF00273                                            0273
         L     @08,@CA00037                                        0273
         TM    CCACHECK-HMASMCCA(@08),B'00010000'                  0273
         BNZ   @RF00273                                            0273
*     DO;                           /*                               */
*       TMPINDX=PGTPINDX;           /* SAVE FIRST GTP INDEX  @Z67SP00*/
         SLR   TMPINDX,TMPINDX                                     0275
         IC    TMPINDX,PGTPINDX                                    0275
*       IOPFUNCT=IOPGETNC;          /* REQUEST GET NEXT WITH COUNT   */
         MVI   IOPFUNCT(INITPTR),X'0B'                             0276
*       GTPRETRN(TMPINDX)=GTPGOOD;  /* SET RC                        */
         LR    @08,TMPINDX                                         0277
         MH    @08,@CH00467                                        0277
         STC   @11,GTPRETRN-28(@08)                                0277
*       DO MEMUSE=0 BY 1 WHILE(     /* LOOP COUNTING ENTS    @Z67SP00*/
*             GTPRETRN(TMPINDX)=GTPGOOD/* RETRIEVE AND ADD RCD TO  0278
*                                      FILE                          */
*             &IOPRETRN=IOPGOOD);   /* WHILE IO & GTA RC'S=ZERO      */
         LR    MEMUSE,@11                                          0278
         B     @DE00278                                            0278
@DL00278 DS    0H                                                  0279
*         CALL HMASMIO(HMASMIOP);   /* CALL IO TO RETRIEVE RECORD    */
         ST    INITPTR,@AL00001                                    0279
         L     @15,@CV01269                                        0279
         LA    @01,@AL00001                                        0279
         BALR  @14,@15                                             0279
*         IF IOPRETRN=IOPGOOD       /* IF RECORD RETRIEVED THEN DO   */
*           THEN                                                   0280
         CLI   IOPRETRN(INITPTR),0                                 0280
         BNE   @RF00280                                            0280
*           DO;                     /*                               */
*             TMPINDX=GTP(IOPTYPE,PDSINDX);/* GTP TO USE     @Z67SP00*/
         SLR   @11,@11                                             0282
         IC    @11,IOPTYPE(,INITPTR)                               0282
         SLA   @11,3                                               0282
         ALR   @11,PDSINDX                                         0282
         SLR   TMPINDX,TMPINDX                                     0282
         IC    TMPINDX,GTP-9(@11)                                  0282
*             IF DSFIRST(TMPINDX)=ZERO/* IF GTP NOT INIT     @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
         SLR   @11,@11                                             0283
         IC    @11,DSFIRST-1(TMPINDX)                              0283
         CH    @11,@CH00252                                        0283
         BNE   @RF00283                                            0283
*               DO;                 /*                       @Z67SP00*/
*                 HMASMGTP(TMPINDX)=''B;/*                   @Z67SP00*/
         LR    @11,TMPINDX                                         0285
         MH    @11,@CH00467                                        0285
         LA    @08,HMASMGTP-28(@11)                                0285
         XC    0(28,@08),0(@08)                                    0285
*                 GTPRCDLN(TMPINDX)=DSDIRLN(PDSINDX);/*      @Z67SP00*/
         LR    @08,PDSINDX                                         0286
         MH    @08,@CH01521                                        0286
         SLR   @07,@07                                             0286
         IC    @07,DSDIRLN-103(@08)                                0286
         STH   @07,GTPRCDLN-28(@11)                                0286
*                 GTPKEYLN(TMPINDX)=KEYLEN;/*                @Z67SP00*/
         LA    @08,8                                               0287
         STH   @08,GTPKEYLN-28(@11)                                0287
*                 GTPNOSPM(TMPINDX)=ON;/*                    @Z67SP00*/
         LA    @08,GTPNOSPM-28(@11)                                0288
         OI    0(@08),B'10000000'                                  0288
*                 DSFIRST(TMPINDX)=ONE;/* GTA INIT           @Z67SP00*/
         LA    @11,1                                               0289
         STC   @11,DSFIRST-1(TMPINDX)                              0289
*               END;                /*                       @Z67SP00*/
*             GTPBUFAD(TMPINDX)=ADDR(IOPDRMAP);/* RECORD FROM TO ADD
*                                      VIA GTA                       */
@RF00283 LR    @11,TMPINDX                                         0291
         MH    @11,@CH00467                                        0291
         LA    @08,IOPDRMAP(,INITPTR)                              0291
         ST    @08,GTPBUFAD-28(@11)                                0291
*             GTPFUNCT(TMPINDX)=GTPADD;/* ADD TO IN STORAGE FILE   0292
*                                                            @Z67SP00*/
         LA    @08,4                                               0292
         STC   @08,GTPFUNCT-28(@11)                                0292
*             CALL HMASMGTA(HMASMGTP(TMPINDX));/* ADD VIA CALL TO GTA
*                                                            @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0293
         ST    @11,@AL00001                                        0293
         L     @15,@CV01268                                        0293
         LA    @01,@AL00001                                        0293
         BALR  @14,@15                                             0293
*           END;                                                   0294
*       END;                        /* END RETRIEVE AND ADD          */
@RF00280 AH    MEMUSE,@CH00087                                     0295
@DE00278 LR    @11,TMPINDX                                         0295
         MH    @11,@CH00467                                        0295
         SLR   @08,@08                                             0295
         IC    @08,GTPRETRN-28(@11)                                0295
         CH    @08,@CH00252                                        0295
         BNE   @DC00278                                            0295
         CLI   IOPRETRN(INITPTR),0                                 0295
         BE    @DL00278                                            0295
@DC00278 DS    0H                                                  0296
*       IF IOPRETRN=IOPEOF          /* IF NO MORE CDS ENTRIES        */
*         THEN                      /* THEN DO                       */
         CLI   IOPRETRN(INITPTR),4                                 0296
         BNE   @RF00296                                            0296
*         DO;                       /*                       @Z67SP00*/
*           DSBLKCT(PDSINDX)=IOPALLOC;/* SAVE COUNT OF ALLOCATED BLKS*/
         LR    @11,PDSINDX                                         0298
         MH    @11,@CH01521                                        0298
         L     @08,IOPALLOC(,INITPTR)                              0298
         ST    @08,DSBLKCT-103(@11)                                0298
*           DSMEMMAX(PDSINDX)=IOPALLOC*(LENGTH(OUTFILL)/DSDIRLN(PDSINDX
*               ));                 /* MAX ENTRIES EQUALS NUMBER OF
*                                      ALLOCATED BLOCKS TIMES MAX PER
*                                      BLOCK                 @Z67SP00*/
         LA    @01,254                                             0299
         SLR   @00,@00                                             0299
         SLR   @07,@07                                             0299
         IC    @07,DSDIRLN-103(@11)                                0299
         DR    @00,@07                                             0299
         LR    @15,@08                                             0299
         MR    @14,@01                                             0299
         ST    @15,DSMEMMAX-103(@11)                               0299
*           DSMEMUSE(PDSINDX)=MEMUSE;/* SET COUNT OF ENTS    @Z67SP00*/
         ST    MEMUSE,DSMEMUSE-103(@11)                            0300
*         END;                      /*                       @Z67SP00*/
*       ELSE                        /*                               */
*         INITRC=MAX(INITRC,IOPRETRN,GTPRETRN(TMPINDX));/* SAVE RC   */
         B     @RC00296                                            0302
@RF00296 SLR   @11,@11                                             0302
         IC    @11,IOPRETRN(,INITPTR)                              0302
         CR    @11,INITRC                                          0302
         BNL   *+6
         LR    @11,INITRC                                          0302
         LR    @08,TMPINDX                                         0302
         MH    @08,@CH00467                                        0302
         SLR   @15,@15                                             0302
         IC    @15,GTPRETRN-28(@08)                                0302
         CR    @11,@15                                             0302
         BNL   *+6
         LR    @11,@15                                             0302
         LR    INITRC,@11                                          0302
*       IF INITRC>IOPEOF            /* IF IO ERROR OR OUT OF IN      */
*         THEN                      /* STORAGE SPACE THEN DO         */
@RC00296 CH    INITRC,@CH00039                                     0303
         BNH   @RF00303                                            0303
*         DO;                       /*                               */
*           CALL EISFREE;           /* FREE FILE BUILT       @Z67SP00*/
         BAL   @14,EISFREE                                         0305
*           RFY                                                    0306
*             RTNCODE RSTD;         /*                       @Z67SP00*/
*           INITRC=MAX(INITRC,RTNCODE);/* SAVE RC            @Z67SP00*/
         CR    INITRC,RTNCODE                                      0307
         BNL   *+6
         LR    INITRC,RTNCODE                                      0307
*           RFY                                                    0308
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/
*           LOADOKSW=OFF;           /* DIR NOT LOADED        @Z67SP00*/
         NI    LOADOKSW,B'11011111'                                0309
*         END;                                                     0310
*       ELSE                        /* IF IN STORAGE FILE INITIALIZED*/
*         DO;                                                      0311
         B     @RC00303                                            0311
@RF00303 DS    0H                                                  0312
*           LOADOKSW=ON;            /* DIR LOADED OK         @Z67SP00*/
         OI    LOADOKSW,B'00100000'                                0312
*           TMPINDX=DSGTPFRS(PDSINDX);/* FIRST GTP OF FILE   @Z67SP00*/
         LR    @11,PDSINDX                                         0313
         MH    @11,@CH01521                                        0313
         SLR   TMPINDX,TMPINDX                                     0313
         IC    TMPINDX,DSGTPFRS-103(@11)                           0313
*           GTPFUNCT(TMPINDX)=GTPOPENN;/* POS TO START       @Z67SP00*/
         LR    @11,TMPINDX                                         0314
         MH    @11,@CH00467                                        0314
         LA    @08,1                                               0314
         STC   @08,GTPFUNCT-28(@11)                                0314
*           CALL HMASMGTA(HMASMGTP(TMPINDX));/* VIA CALL TO GTA      */
         LA    @11,HMASMGTP-28(@11)                                0315
         ST    @11,@AL00001                                        0315
         L     @15,@CV01268                                        0315
         LA    @01,@AL00001                                        0315
         BALR  @14,@15                                             0315
*           INITRC=GTPRETRN(TMPINDX);/* SAVE GTA RETURN CODE         */
         LR    @11,TMPINDX                                         0316
         MH    @11,@CH00467                                        0316
         SLR   INITRC,INITRC                                       0316
         IC    INITRC,GTPRETRN-28(@11)                             0316
*           DSGTPGN(PDSINDX)=TMPINDX;/* GTP FOR NEXT GETN    @Z67SP00*/
         LA    @11,103                                             0317
         LR    @01,PDSINDX                                         0317
         MR    @00,@11                                             0317
         STC   TMPINDX,DSGTPGN-103(@01)                            0317
*           DSGTPGN(SDSINDX)=DSGTPFRS(SDSINDX);/*            @Z67SP00*/
         LR    @01,@11                                             0318
         SLR   @11,@11                                             0318
         IC    @11,SDSINDX                                         0318
         MR    @00,@11                                             0318
         SLR   @11,@11                                             0318
         IC    @11,DSGTPFRS-103(@01)                               0318
         STC   @11,DSGTPGN-103(@01)                                0318
*         END;                                                     0319
*       IOPFUNCT=IOPCLOSN;          /* SET UP TO CLOSE FOR GETN      */
@RC00303 MVI   IOPFUNCT(INITPTR),X'0C'                             0320
*       CALL HMASMIO(HMASMIOP);     /* CALL IO TO DO CLOSE           */
         ST    INITPTR,@AL00001                                    0321
         L     @15,@CV01269                                        0321
         LA    @01,@AL00001                                        0321
         BALR  @14,@15                                             0321
*       INITRC=MAX(INITRC,IOPRETRN);/* SAVE MAXIMUM RETURN CODE      */
         SLR   @11,@11                                             0322
         IC    @11,IOPRETRN(,INITPTR)                              0322
         CR    INITRC,@11                                          0322
         BNL   *+6
         LR    INITRC,@11                                          0322
*       IOPFUNCT=IOPCLOSE;          /* SET UP TO CLOSE FOR DATA      */
         MVI   IOPFUNCT(INITPTR),X'50'                             0323
*       CALL HMASMIO(HMASMIOP);     /* CALL IO TO DO CLOSE           */
         ST    INITPTR,@AL00001                                    0324
         L     @15,@CV01269                                        0324
         LA    @01,@AL00001                                        0324
         BALR  @14,@15                                             0324
*       INITRC=MAX(INITRC,IOPRETRN);/* SAVE MAXIMUM RETURN CODE      */
         SLR   @11,@11                                             0325
         IC    @11,IOPRETRN(,INITPTR)                              0325
         CR    INITRC,@11                                          0325
         BNL   *+6
         LR    INITRC,@11                                          0325
*       IF LOADOKSW=ON              /* IF DIR LOADED         @Z67SP00*/
*         THEN                      /* THEN                  @Z67SP00*/
         TM    LOADOKSW,B'00100000'                                0326
         BNO   @RF00326                                            0326
*         CCAFLAG4=CCAFLAG4×DSMSKON(PDSINDX);/* TURN ON DIRECTORY IN
*                                      STORAGE INDICATOR             */
         L     @11,@CA00037                                        0327
         LR    @08,PDSINDX                                         0327
         MH    @08,@CH01521                                        0327
         LA    @04,DSMSKON-103(@08)                                0327
         OC    CCAFLAG4-HMASMCCA(1,@11),0(@04)                     0327
*     END;                          /* END OF INITIAL SUCCESSFUL   0328
*                                      CLOSE OPERATION               */
@RF00326 DS    0H                                                  0329
*   RETURN CODE(INITRC);                                           0329
@RF00273 LR    @15,INITRC                                          0329
         L     @14,@SA00003                                        0329
         LM    @00,@12,@SA00003+8                                  0329
         BR    @14                                                 0329
*   END EISINIT;                                                   0330
         EJECT
*                                                                  0331
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO FREE THE GTA FILE ASSOCIATED WITH EITHER THE       */
*   /* PRIMARY AND/OR SECONDARY DIS FILES                    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*EISFREE:                           /*                       @Z67SP00*/
*   PROC;                           /*                       @Z67SP00*/
EISFREE  STM   @14,@12,@SA00004                                    0331
*   DECLARE                         /*                       @Z67SP00*/
*     FREERC FIXED(8);              /*                       @Z67SP00*/
*   FREERC=IOPGOOD;                 /* INIT RETURN CODE      @Z67SP00*/
*                                                                  0333
         SLR   FREERC,FREERC                                       0333
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE SECONDARY DIS FILE IN ALL CASES (CHECK OR NOT)   @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0334
*   DO TMPINDX=DSGTPFRS(SDSINDX) TO DSGTPLST(SDSINDX);/*     @Z67SP00
*                                                            @Z67SP00*/
         SLR   @11,@11                                             0334
         IC    @11,SDSINDX                                         0334
         MH    @11,@CH01521                                        0334
         SLR   TMPINDX,TMPINDX                                     0334
         IC    TMPINDX,DSGTPFRS-103(@11)                           0334
         B     @DE00334                                            0334
@DL00334 DS    0H                                                  0335
*     IF DSFIRST(TMPINDX)=ONE       /* IF GTP INIT ALREADY   @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
         SLR   @11,@11                                             0335
         IC    @11,DSFIRST-1(TMPINDX)                              0335
         CH    @11,@CH00087                                        0335
         BNE   @RF00335                                            0335
*       DO;                         /*                       @Z67SP00*/
*         GTPFUNCT(TMPINDX)=GTPFREE;/* SET TO FREE PRIMARY   @Z67SP00*/
         LR    @11,TMPINDX                                         0337
         MH    @11,@CH00467                                        0337
         LA    @08,10                                              0337
         STC   @08,GTPFUNCT-28(@11)                                0337
*         CALL HMASMGTA(HMASMGTP(TMPINDX));/* FREE PRIMARY   @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0338
         ST    @11,@AL00001                                        0338
         L     @15,@CV01268                                        0338
         LA    @01,@AL00001                                        0338
         BALR  @14,@15                                             0338
*         FREERC=MAX(FREERC,GTPRETRN(TMPINDX));/* SAVE RC    @Z67SP00*/
         LR    @11,TMPINDX                                         0339
         MH    @11,@CH00467                                        0339
         SLR   @08,@08                                             0339
         IC    @08,GTPRETRN-28(@11)                                0339
         CR    FREERC,@08                                          0339
         BNL   *+6
         LR    FREERC,@08                                          0339
*         DSFIRST(TMPINDX)=ZERO;    /* GTP NOT INIT          @Z67SP00*/
         SLR   @11,@11                                             0340
         STC   @11,DSFIRST-1(TMPINDX)                              0340
*       END;                        /*                       @Z67SP00*/
*   END;                            /* END GTP LOOP          @Z67SP00*/
@RF00335 AH    TMPINDX,@CH00087                                    0342
@DE00334 SLR   @11,@11                                             0342
         IC    @11,SDSINDX                                         0342
         MH    @11,@CH01521                                        0342
         SLR   @08,@08                                             0342
         IC    @08,DSGTPLST-103(@11)                               0342
         CR    TMPINDX,@08                                         0342
         BNH   @DL00334                                            0342
*   IF CCACHECK=OFF                 /* IF NOT IN CHECK MODE  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @11,@CA00037                                        0343
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0343
         BNZ   @RF00343                                            0343
*     DO;                           /*                       @Z67SP00*/
*       DO TMPINDX=DSGTPFRS(PDSINDX) TO DSGTPLST(PDSINDX);/* @Z67SP00*/
         LR    @11,PDSINDX                                         0345
         MH    @11,@CH01521                                        0345
         SLR   TMPINDX,TMPINDX                                     0345
         IC    TMPINDX,DSGTPFRS-103(@11)                           0345
         B     @DE00345                                            0345
@DL00345 DS    0H                                                  0346
*         IF DSFIRST(TMPINDX)=ONE   /* IF GTP INIT ALREADY   @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         SLR   @11,@11                                             0346
         IC    @11,DSFIRST-1(TMPINDX)                              0346
         CH    @11,@CH00087                                        0346
         BNE   @RF00346                                            0346
*           DO;                     /*                       @Z67SP00*/
*             GTPFUNCT(TMPINDX)=GTPFREE;/* SET TO FREE PRIM  @Z67SP00*/
         LR    @11,TMPINDX                                         0348
         MH    @11,@CH00467                                        0348
         LA    @08,10                                              0348
         STC   @08,GTPFUNCT-28(@11)                                0348
*             CALL HMASMGTA(HMASMGTP(TMPINDX));/* FREE PRIM  @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0349
         ST    @11,@AL00001                                        0349
         L     @15,@CV01268                                        0349
         LA    @01,@AL00001                                        0349
         BALR  @14,@15                                             0349
*             FREERC=MAX(FREERC,GTPRETRN(TMPINDX));/* SV RC  @Z67SP00*/
         LR    @11,TMPINDX                                         0350
         MH    @11,@CH00467                                        0350
         SLR   @08,@08                                             0350
         IC    @08,GTPRETRN-28(@11)                                0350
         CR    FREERC,@08                                          0350
         BNL   *+6
         LR    FREERC,@08                                          0350
*             DSFIRST(TMPINDX)=ZERO;/* GTP NOT INIT          @Z67SP00*/
         SLR   @11,@11                                             0351
         STC   @11,DSFIRST-1(TMPINDX)                              0351
*           END;                    /*                       @Z67SP00*/
*       END;                        /* END GTP LOOP          @Z67SP00*/
@RF00346 AH    TMPINDX,@CH00087                                    0353
@DE00345 LR    @11,PDSINDX                                         0353
         MH    @11,@CH01521                                        0353
         SLR   @08,@08                                             0353
         IC    @08,DSGTPLST-103(@11)                               0353
         CR    TMPINDX,@08                                         0353
         BNH   @DL00345                                            0353
*       CCAFLAG4=CCAFLAG4&DSMSKOFF(PDSINDX);/* DIS NOT LOADED INTO 0354
*                                      STORAGE               @Z67SP00*/
         L     @11,@CA00037                                        0354
         LR    @08,PDSINDX                                         0354
         MH    @08,@CH01521                                        0354
         LA    @05,DSMSKOFF-103(@08)                               0354
         NC    CCAFLAG4-HMASMCCA(1,@11),0(@05)                     0354
*       CCAFLAG6=CCAFLAG6&DSMSKOFF(PDSINDX);/* DIS NOT UPDATED IN  0355
*                                      STORAGE               @Z67SP00*/
         LA    @05,DSMSKOFF-103(@08)                               0355
         NC    CCAFLAG6-HMASMCCA(1,@11),0(@05)                     0355
*       DSMEMMAX(PDSINDX)=ZERO;     /* NO DIR BLKS ALLOC     @Z67SP00*/
         SLR   @11,@11                                             0356
         ST    @11,DSMEMMAX-103(@08)                               0356
*       DSMEMUSE(PDSINDX)=ONE;      /* ONE FOR EOF MEMBER    @Z67SP00*/
         LA    @11,1                                               0357
         ST    @11,DSMEMUSE-103(@08)                               0357
*     END;                          /*                       @Z67SP00*/
*   RETURN CODE(FREERC);            /* RETURN                @Z67SP00*/
@RF00343 LR    @15,FREERC                                          0359
         L     @14,@SA00004                                        0359
         LM    @00,@12,@SA00004+8                                  0359
         BR    @14                                                 0359
*   END EISFREE;                    /*                       @Z67SP00*/
         EJECT
*                                                                  0361
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO LOCATE ENTRY IN DIS FILE. IF IN CHECK MODE  */
*   /* THEN SECONDARY IS SEARCH FIRST AND THEN PRIMARY. IF NOT IN    */
*   /* CHECK MODE THEN JUST PRIMARY IS SEARCHED              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0361
*EISLOC:                            /*                       @Z67SP00*/
*                                                                  0361
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO HANDLE IOPBLDL OPERATIONS           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0361
*EISBLDL:                           /*                       @Z67SP00*/
*   PROC;                           /*                       @Z67SP00*/
EISLOC   DS    0H                                                  0361
EISBLDL  STM   @14,@12,@SA00005                                    0361
*   DECLARE                         /*                       @Z67SP00*/
*     LOCRC FIXED(8);               /* PROC RETURN CODE      @Z67SP00*/
*   RFY                                                            0363
*     HMASMIOP BASED(IOPPTR);       /* PASSED IOP            @Z67SP00*/
*   LOCRC=IOPGOOD;                  /* INDICATE ENTRY FOUND  @Z67SP00*/
         SLR   LOCRC,LOCRC                                         0364
*   FNDSW=OFF;                      /* ENTRY NOT FOUND SW    @Z67SP00*/
         NI    FNDSW,B'11101111'                                   0365
*   IF CCACHECK=ON                  /* IF IN CHECK MODE      @Z67SP00*/
*     THEN                          /* THEN                  @Z67SP00*/
         L     @11,@CA00037                                        0366
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0366
         BNO   @RF00366                                            0366
*     DO;                           /*                       @Z67SP00*/
*       GTPFUNCT(SGTPINDX)=GTPLOC;  /* LOC ENTRY             @Z67SP00*/
         SLR   @11,@11                                             0368
         IC    @11,SGTPINDX                                        0368
         MH    @11,@CH00467                                        0368
         LA    @08,3                                               0368
         STC   @08,GTPFUNCT-28(@11)                                0368
*       GTPBUFAD(SGTPINDX)=ADDR(DSBUFFR(SDSINDX));/* TMP BUFF      0369
*                                                            @Z67SP00*/
         SLR   @08,@08                                             0369
         IC    @08,SDSINDX                                         0369
         MH    @08,@CH01521                                        0369
         LA    @05,DSBUFFR-103(@08)                                0369
         ST    @05,GTPBUFAD-28(@11)                                0369
*       DSBUFFR(SDSINDX,1:DSDIRLN(SDSINDX))=IOPDRMAP(1:DSDIRLN(SDSINDX)
*           );                      /* MOVE BUFFER           @Z67SP00*/
         LA    @05,DSBUFFR-103(@08)                                0370
         SLR   @03,@03                                             0370
         IC    @03,DSDIRLN-103(@08)                                0370
         BCTR  @03,0                                               0370
         MVC   @TS00001(12),IOPDRMAP(IOPPTR)                       0370
         EX    @03,@SM01524                                        0370
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/* LOC RCD         @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0371
         ST    @11,@AL00001                                        0371
         L     @15,@CV01268                                        0371
         LA    @01,@AL00001                                        0371
         BALR  @14,@15                                             0371
*       IF GTPRETRN(SGTPINDX)=GTPGOOD/* IF FOUND             @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         SLR   @11,@11                                             0372
         IC    @11,SGTPINDX                                        0372
         MH    @11,@CH00467                                        0372
         SLR   @08,@08                                             0372
         IC    @08,GTPRETRN-28(@11)                                0372
         CH    @08,@CH00252                                        0372
         BNE   @RF00372                                            0372
*         DO;                       /*                       @Z67SP00*/
*           FNDSW=ON;               /* ENTRY FOUND           @Z67SP00*/
         OI    FNDSW,B'00010000'                                   0374
*           IF DSBFDEL(SDSINDX)^=TXTDEL/* IF MEM DELETED     @Z67SP00*/
*             THEN                  /* THEN MOVE RCD TO IOP  @Z67SP00*/
         SLR   @11,@11                                             0375
         IC    @11,SDSINDX                                         0375
         MH    @11,@CH01521                                        0375
         LA    @08,DSBFDEL-103(@11)                                0375
         CLC   0(8,@08),@CC01281                                   0375
         BE    @RF00375                                            0375
*             IOPDRMAP(1:DSDIRLN(SDSINDX))=DSBUFFR(SDSINDX,1:DSDIRLN(
*                 SDSINDX));        /* MOVE RCD TO IOP       @Z67SP00*/
         SLR   @08,@08                                             0376
         IC    @08,DSDIRLN-103(@11)                                0376
         BCTR  @08,0                                               0376
         LA    @05,DSBUFFR-103(@11)                                0376
         EX    @08,@SM01526                                        0376
*           ELSE                    /* ELSE SET RC TO        @Z67SP00*/
*             LOCRC=IOPNTFND;       /* INDICATE NOT FOUND    @Z67SP00*/
         B     @RC00375                                            0377
@RF00375 LA    LOCRC,4                                             0377
*         END;                      /*                       @Z67SP00*/
@RC00375 DS    0H                                                  0379
*     END;                          /*                       @Z67SP00*/
@RF00372 DS    0H                                                  0380
*   IF FNDSW=OFF                    /* IF NOT FOUND YET      @Z67SP00*/
*     THEN                          /* THEN TRY TO LOCATE    @Z67SP00*/
@RF00366 TM    FNDSW,B'00010000'                                   0380
         BNZ   @RF00380                                            0380
*     DO;                           /* ON PRIMARY FILE       @Z67SP00*/
*       GTPFUNCT(PGTPINDX)=GTPLOC;  /* LOC ENTRY             @Z67SP00*/
         SLR   @11,@11                                             0382
         IC    @11,PGTPINDX                                        0382
         MH    @11,@CH00467                                        0382
         LA    @08,3                                               0382
         STC   @08,GTPFUNCT-28(@11)                                0382
*       GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* INPUT BUFFER    @Z67SP00*/
         LA    @08,IOPDRMAP(,IOPPTR)                               0383
         ST    @08,GTPBUFAD-28(@11)                                0383
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* LOC RCD         @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0384
         ST    @11,@AL00001                                        0384
         L     @15,@CV01268                                        0384
         LA    @01,@AL00001                                        0384
         BALR  @14,@15                                             0384
*       LOCRC=GTPRETRN(PGTPINDX);   /* SAVE RC               @Z67SP00*/
         SLR   @11,@11                                             0385
         IC    @11,PGTPINDX                                        0385
         MH    @11,@CH00467                                        0385
         SLR   LOCRC,LOCRC                                         0385
         IC    LOCRC,GTPRETRN-28(@11)                              0385
*     END;                          /*                       @Z67SP00*/
*                                                                  0386
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN WITH CODE FROM LOC/BLDL                        @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0387
*   RETURN CODE(LOCRC);             /*                       @Z67SP00*/
@RF00380 LR    @15,LOCRC                                           0387
         L     @14,@SA00005                                        0387
         LM    @00,@12,@SA00005+8                                  0387
         BR    @14                                                 0387
*   END EISLOC;                     /*                       @Z67SP00*/
         EJECT
*                                                                  0389
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO HANDLE SEQUENTIAL READS FROM THE DIRECTORY. */
*   /* IF IN CHECK MODE THE SECONDARY DIS IS SEARCH FIRST AND ITS    */
*   /* RESULT USED. IF NOT FOUND THEN THE PRIMARYS DIS IS OBTAINED   */
*   /* AND RETURNED TO THE USER                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0389
*EISGETN:                           /*                       @Z67SP00*/
*   PROC;                           /*                       @Z67SP00*/
EISGETN  STM   @14,@12,@SA00006                                    0389
*   DECLARE                         /*                       @Z67SP00*/
*     GETNRC FIXED(8);              /* PROC RETURN CODE      @Z67SP00*/
*   DECLARE                         /*                       @Z67SP00*/
*     1 GETNSW BIT(8),              /*                       @Z67SP00*/
*       3 PREAD BIT(1),             /*                       @Z67SP00*/
*       3 SREAD BIT(1),             /*                       @Z67SP00*/
*       3 DEL BIT(1),               /* RCD FOUND AS DEL IN SECONDARY
*                                      DIS FILE              @Z67SP00*/
*       3 STOP BIT(1),              /* LOOP CONTROL          @Z67SP00*/
*       3 STOP2 BIT(1),             /* LOOP CONTROL          @Z67SP00*/
*       3 * BIT(3);                 /*                       @Z67SP00*/
*   RFY                                                            0392
*     HMASMIOP BASED(IOPPTR);       /* PASSED IOP            @Z67SP00*/
*   GETNRC=IOPGOOD;                 /* INIT RC               @Z67SP00*/
         SLR   GETNRC,GETNRC                                       0393
*   DEL=ON;                         /* INIT SW SO LOOP WILL BE     0394
*                                      EXECUTED ONCE         @Z67SP00*/
         OI    DEL,B'00100000'                                     0394
*   DO WHILE DEL=ON;                /* READ UNTIL NO DELETED RCD   0395
*                                      FOUND IN SECONDARY DIS      0395
*                                                            @Z67SP00*/
         B     @DE00395                                            0395
@DL00395 DS    0H                                                  0396
*     GETNSW=OFF;                   /*                       @Z67SP00*/
         MVI   GETNSW,B'00000000'                                  0396
*     DEL=OFF;                      /* STOP LOOP             @Z67SP00*/
*                                                                  0397
         NI    DEL,B'11011111'                                     0397
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE WHICH DIS FILES A READ SHOULD BE DONE FROM        */
*     /*                                                     @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0398
*     IF CCACHECK=OFF               /* IF NOT IN CHECK MODE  @Z67SP00*/
*       THEN                        /* THEN                  @Z67SP00*/
         L     @11,@CA00037                                        0398
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0398
         BNZ   @RF00398                                            0398
*       DO;                         /* READ FROM ONLY        @Z67SP00*/
*         SEOF(PDSINDX)=ON;         /*                       @Z67SP00*/
         LR    @11,PDSINDX                                         0400
         MH    @11,@CH01521                                        0400
         LA    @08,SEOF-103(@11)                                   0400
         OI    0(@08),B'01000000'                                  0400
*         IF PEOF(PDSINDX)=OFF      /* IF NOT EOF ON PRIMARY @Z67SP00*/
*           THEN                    /* THEN READ FROM        @Z67SP00*/
         LA    @08,PEOF-103(@11)                                   0401
         TM    0(@08),B'10000000'                                  0401
         BNZ   @RF00401                                            0401
*           PREAD=ON;               /* THE PRIMARY DIS       @Z67SP00*/
         OI    PREAD,B'10000000'                                   0402
*         SREAD=OFF;                /*                       @Z67SP00*/
@RF00401 NI    SREAD,B'10111111'                                   0403
*       END;                        /*                       @Z67SP00*/
*     ELSE                          /*                       @Z67SP00*/
*       IF DSBFNAME(PDSINDX)<DSBFNAME(SDSINDX)/* DETERMINE   @Z67SP00*/
*           &PEOF(PDSINDX)=OFF      /*                       @Z67SP00*/
*         THEN                      /* BUFFER TO READ FROM   @Z67SP00*/
         B     @RC00398                                            0405
@RF00398 LA    @11,103                                             0405
         LR    @01,PDSINDX                                         0405
         MR    @00,@11                                             0405
         LR    @07,@11                                             0405
         SLR   @11,@11                                             0405
         IC    @11,SDSINDX                                         0405
         MR    @06,@11                                             0405
         LA    @11,DSBFNAME-103(@01)                               0405
         LA    @08,DSBFNAME-103(@07)                               0405
         CLC   0(8,@11),0(@08)                                     0405
         BNL   @RF00405                                            0405
         LA    @11,PEOF-103(@01)                                   0405
         TM    0(@11),B'10000000'                                  0405
         BNZ   @RF00405                                            0405
*         PREAD=ON;                 /* READ FROM PRINARY     @Z67SP00*/
         OI    PREAD,B'10000000'                                   0406
*       ELSE                        /*                       @Z67SP00*/
*         IF DSBFNAME(PDSINDX)>DSBFNAME(SDSINDX)/*           @Z67SP00*/
*             &SEOF(PDSINDX)=OFF    /*                       @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         B     @RC00405                                            0407
@RF00405 LA    @11,103                                             0407
         LR    @01,PDSINDX                                         0407
         MR    @00,@11                                             0407
         LR    @07,@11                                             0407
         SLR   @11,@11                                             0407
         IC    @11,SDSINDX                                         0407
         MR    @06,@11                                             0407
         LA    @11,DSBFNAME-103(@01)                               0407
         LA    @08,DSBFNAME-103(@07)                               0407
         CLC   0(8,@11),0(@08)                                     0407
         BNH   @RF00407                                            0407
         LA    @11,SEOF-103(@01)                                   0407
         TM    0(@11),B'01000000'                                  0407
         BNZ   @RF00407                                            0407
*           SREAD=ON;               /* SECONDARY READ        @Z67SP00*/
         OI    SREAD,B'01000000'                                   0408
*         ELSE                      /*                       @Z67SP00*/
*           DO;                     /* RCD EQUAL             @Z67SP00*/
         B     @RC00407                                            0409
@RF00407 DS    0H                                                  0410
*             IF PEOF(PDSINDX)=OFF  /*                       @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
         LR    @11,PDSINDX                                         0410
         MH    @11,@CH01521                                        0410
         LA    @08,PEOF-103(@11)                                   0410
         TM    0(@08),B'10000000'                                  0410
         BNZ   @RF00410                                            0410
*               PREAD=ON;           /* READ FROM BOTH        @Z67SP00*/
         OI    PREAD,B'10000000'                                   0411
*             IF SEOF(PDSINDX)=OFF  /*                       @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
@RF00410 LR    @11,PDSINDX                                         0412
         MH    @11,@CH01521                                        0412
         LA    @08,SEOF-103(@11)                                   0412
         TM    0(@08),B'01000000'                                  0412
         BNZ   @RF00412                                            0412
*               SREAD=ON;           /*                       @Z67SP00*/
         OI    SREAD,B'01000000'                                   0413
*           END;                    /*                       @Z67SP00*/
*                                                                  0414
@RF00412 DS    0H                                                  0415
*     /***************************************************************/
*     /*                                                             */
*     /* GET NEXT RECORDS FROM DIS FILES                     @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0415
*     IF PREAD=ON                   /* IF PRIMARY READ       @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
@RC00407 DS    0H                                                  0415
@RC00405 DS    0H                                                  0415
@RC00398 TM    PREAD,B'10000000'                                   0415
         BNO   @RF00415                                            0415
*       DO;                         /*                       @Z67SP00*/
*         STOP=OFF;                 /* LET LOOP GO THUR 1    @Z67SP00*/
         NI    STOP,B'11101111'                                    0417
*         DO WHILE STOP=OFF;        /* LOOP TILL RCD FOUND   @Z67SP00*/
         B     @DE00418                                            0418
@DL00418 DS    0H                                                  0419
*           STOP=ON;                /* STOP LOOP             @Z67SP00*/
         OI    STOP,B'00010000'                                    0419
*           GTPFUNCT(PGTPINDX)=GTPGETN;/* GET RCD INTO TEMP  @Z67SP00*/
         SLR   @11,@11                                             0420
         IC    @11,PGTPINDX                                        0420
         MH    @11,@CH00467                                        0420
         LA    @08,8                                               0420
         STC   @08,GTPFUNCT-28(@11)                                0420
*           GTPBUFAD(PGTPINDX)=ADDR(DSBUFFR(PDSINDX));/* BFR @Z67SP00*/
         LR    @08,PDSINDX                                         0421
         MH    @08,@CH01521                                        0421
         LA    @08,DSBUFFR-103(@08)                                0421
         ST    @08,GTPBUFAD-28(@11)                                0421
*           CALL HMASMGTA(HMASMGTP(PGTPINDX));/* GET RCD     @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0422
         ST    @11,@AL00001                                        0422
         L     @15,@CV01268                                        0422
         LA    @01,@AL00001                                        0422
         BALR  @14,@15                                             0422
*           IF GTPRETRN(PGTPINDX)=GTPEOF/* IF END OF FILE    @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         SLR   @11,@11                                             0423
         IC    @11,PGTPINDX                                        0423
         LR    @08,@11                                             0423
         MH    @08,@CH00467                                        0423
         SLR   @05,@05                                             0423
         IC    @05,GTPRETRN-28(@08)                                0423
         CH    @05,@CH00039                                        0423
         BNE   @RF00423                                            0423
*             DO;                   /*                       @Z67SP00*/
*               IF PGTPINDX<=DSGTPLST(PDSINDX)/* IF NOT AT   @Z67SP00*/
*                 THEN              /* END OF GTPS FOR THIS  @Z67SP00*/
         LR    @08,PDSINDX                                         0425
         MH    @08,@CH01521                                        0425
         SLR   @05,@05                                             0425
         IC    @05,DSGTPLST-103(@08)                               0425
         CR    @11,@05                                             0425
         BH    @RF00425                                            0425
*                 DO;               /* DATASET THEN GO       @Z67SP00*/
*                   STOP2=OFF;      /* LET LOOP GO THRU ONCE @Z67SP00*/
         NI    STOP2,B'11110111'                                   0427
*                   DO WHILE STOP2=OFF;/* GET NEXT FILE      @Z67SP00*/
         B     @DE00428                                            0428
@DL00428 DS    0H                                                  0429
*                     PGTPINDX=PGTPINDX+1;/* BUMP INDEX TO NEXT GTP
*                                                            @Z67SP00*/
         LA    @11,1                                               0429
         SLR   @08,@08                                             0429
         IC    @08,PGTPINDX                                        0429
         ALR   @08,@11                                             0429
         STC   @08,PGTPINDX                                        0429
*                     IF PGTPINDX>DSGTPLST(PDSINDX)/* IF     @Z67SP00*/
*                         ×DSFIRST(PGTPINDX)=ONE/* AT END OF GTPS OR
*                                      THIS GTP HAS RCDS     @Z67SP00*/
*                       THEN        /* THEN STOP LOOP AND    @Z67SP00*/
         LR    @05,PDSINDX                                         0430
         MH    @05,@CH01521                                        0430
         SLR   @15,@15                                             0430
         IC    @15,DSGTPLST-103(@05)                               0430
         CR    @08,@15                                             0430
         BH    @RT00430                                            0430
         SLR   @05,@05                                             0430
         IC    @05,DSFIRST-1(@08)                                  0430
         CR    @11,@05                                             0430
         BNE   @RF00430                                            0430
@RT00430 DS    0H                                                  0431
*                       STOP2=ON;   /* PROCESS ITS RCDS      @Z67SP00*/
         OI    STOP2,B'00001000'                                   0431
*                   END;            /*                       @Z67SP00*/
@RF00430 DS    0H                                                  0432
@DE00428 TM    STOP2,B'00001000'                                   0432
         BZ    @DL00428                                            0432
*                 END;              /*                       @Z67SP00*/
*               IF PGTPINDX>DSGTPLST(PDSINDX)/* IF NO GTP    @Z67SP00*/
*                 THEN              /* THEN                  @Z67SP00*/
@RF00425 LR    @11,PDSINDX                                         0434
         MH    @11,@CH01521                                        0434
         SLR   @08,@08                                             0434
         IC    @08,PGTPINDX                                        0434
         SLR   @05,@05                                             0434
         IC    @05,DSGTPLST-103(@11)                               0434
         CR    @08,@05                                             0434
         BNH   @RF00434                                            0434
*                 DO;               /*                       @Z67SP00*/
*                   PEOF(PDSINDX)=ON;/* END OF FILE          @Z67SP00*/
         LA    @08,PEOF-103(@11)                                   0436
         OI    0(@08),B'10000000'                                  0436
*                   PGTPINDX=DSGTPFRS(PDSINDX);/* FIRST GTP  @Z67SP00*/
         SLR   @08,@08                                             0437
         IC    @08,DSGTPFRS-103(@11)                               0437
         STC   @08,PGTPINDX                                        0437
*                   DSGTPGN(PDSINDX)=DSGTPFRS(PDSINDX);/*    @Z67SP00*/
         STC   @08,DSGTPGN-103(@11)                                0438
*                 END;              /*                       @Z67SP00*/
*               ELSE                /*                       @Z67SP00*/
*                 DO;               /*                       @Z67SP00*/
         B     @RC00434                                            0440
@RF00434 DS    0H                                                  0441
*                   GTPFUNCT(PGTPINDX)=GTPOPENN;/* OPEN      @Z67SP00*/
         SLR   @11,@11                                             0441
         IC    @11,PGTPINDX                                        0441
         MH    @11,@CH00467                                        0441
         LA    @08,1                                               0441
         STC   @08,GTPFUNCT-28(@11)                                0441
*                   CALL HMASMGTA(HMASMGTP(PGTPINDX));/*     @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0442
         ST    @11,@AL00001                                        0442
         L     @15,@CV01268                                        0442
         LA    @01,@AL00001                                        0442
         BALR  @14,@15                                             0442
*                   DSGTPGN(PDSINDX)=PGTPINDX;/*             @Z67SP00*/
         LR    @11,PDSINDX                                         0443
         MH    @11,@CH01521                                        0443
         SLR   @08,@08                                             0443
         IC    @08,PGTPINDX                                        0443
         STC   @08,DSGTPGN-103(@11)                                0443
*                   STOP=OFF;       /* CONTINUE WITH READS   @Z67SP00*/
         NI    STOP,B'11101111'                                    0444
*                 END;              /*                       @Z67SP00*/
*             END;                  /* END GTP EOF           @Z67SP00*/
@RC00434 DS    0H                                                  0447
*         END;                      /* END GTA READ LOOP     @Z67SP00*/
@RF00423 DS    0H                                                  0447
@DE00418 TM    STOP,B'00010000'                                    0447
         BZ    @DL00418                                            0447
*       END;                        /* END NEED PRIM READ    @Z67SP00*/
*     IF SREAD=ON                   /* IF SECONDARY DIS READ @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
@RF00415 TM    SREAD,B'01000000'                                   0449
         BNO   @RF00449                                            0449
*       DO;                         /*                       @Z67SP00*/
*         STOP=OFF;                 /* LET LOOP GO THUR 1    @Z67SP00*/
         NI    STOP,B'11101111'                                    0451
*         DO WHILE STOP=OFF;        /* LOOP TILL RCD FOUND   @Z67SP00*/
         B     @DE00452                                            0452
@DL00452 DS    0H                                                  0453
*           STOP=ON;                /* STOP LOOP             @Z67SP00*/
         OI    STOP,B'00010000'                                    0453
*           GTPFUNCT(SGTPINDX)=GTPGETN;/* GET RCD INTO TEMP  @Z67SP00*/
         SLR   @11,@11                                             0454
         IC    @11,SGTPINDX                                        0454
         MH    @11,@CH00467                                        0454
         LA    @08,8                                               0454
         STC   @08,GTPFUNCT-28(@11)                                0454
*           GTPBUFAD(SGTPINDX)=ADDR(DSBUFFR(SDSINDX));/* BFR @Z67SP00*/
         SLR   @08,@08                                             0455
         IC    @08,SDSINDX                                         0455
         MH    @08,@CH01521                                        0455
         LA    @08,DSBUFFR-103(@08)                                0455
         ST    @08,GTPBUFAD-28(@11)                                0455
*           CALL HMASMGTA(HMASMGTP(SGTPINDX));/* GET RCD     @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0456
         ST    @11,@AL00001                                        0456
         L     @15,@CV01268                                        0456
         LA    @01,@AL00001                                        0456
         BALR  @14,@15                                             0456
*           IF GTPRETRN(SGTPINDX)=GTPEOF/* IF END OF FILE    @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         SLR   @11,@11                                             0457
         IC    @11,SGTPINDX                                        0457
         LR    @08,@11                                             0457
         MH    @08,@CH00467                                        0457
         SLR   @05,@05                                             0457
         IC    @05,GTPRETRN-28(@08)                                0457
         CH    @05,@CH00039                                        0457
         BNE   @RF00457                                            0457
*             DO;                   /*                       @Z67SP00*/
*               IF SGTPINDX<=DSGTPLST(SDSINDX)/* IF NOT AT   @Z67SP00*/
*                 THEN              /* END OF GTPS FOR THIS  @Z67SP00*/
         SLR   @08,@08                                             0459
         IC    @08,SDSINDX                                         0459
         MH    @08,@CH01521                                        0459
         SLR   @05,@05                                             0459
         IC    @05,DSGTPLST-103(@08)                               0459
         CR    @11,@05                                             0459
         BH    @RF00459                                            0459
*                 DO;               /* DATASET THEN GO       @Z67SP00*/
*                   STOP2=OFF;      /*                       @Z67SP00*/
         NI    STOP2,B'11110111'                                   0461
*                   DO WHILE STOP2=OFF;/* GET NEXT FILE      @Z67SP00*/
         B     @DE00462                                            0462
@DL00462 DS    0H                                                  0463
*                     SGTPINDX=SGTPINDX+1;/* BUMP INDEX TO NEXT GTP
*                                                            @Z67SP00*/
         LA    @11,1                                               0463
         SLR   @08,@08                                             0463
         IC    @08,SGTPINDX                                        0463
         ALR   @08,@11                                             0463
         STC   @08,SGTPINDX                                        0463
*                     IF SGTPINDX>DSGTPLST(SDSINDX)/* IF     @Z67SP00*/
*                         ×DSFIRST(SGTPINDX)=ONE/* AT END OF GTPS OR
*                                      THIS GTP HAS RCDS     @Z67SP00*/
*                       THEN        /* THEN STOP LOOP AND    @Z67SP00*/
         SLR   @05,@05                                             0464
         IC    @05,SDSINDX                                         0464
         MH    @05,@CH01521                                        0464
         SLR   @15,@15                                             0464
         IC    @15,DSGTPLST-103(@05)                               0464
         CR    @08,@15                                             0464
         BH    @RT00464                                            0464
         SLR   @05,@05                                             0464
         IC    @05,DSFIRST-1(@08)                                  0464
         CR    @11,@05                                             0464
         BNE   @RF00464                                            0464
@RT00464 DS    0H                                                  0465
*                       STOP2=ON;   /* PROCESS ITS RCDS      @Z67SP00*/
         OI    STOP2,B'00001000'                                   0465
*                   END;            /*                       @Z67SP00*/
@RF00464 DS    0H                                                  0466
@DE00462 TM    STOP2,B'00001000'                                   0466
         BZ    @DL00462                                            0466
*                 END;              /*                       @Z67SP00*/
*               IF SGTPINDX>DSGTPLST(SDSINDX)/* IF NO GTP    @Z67SP00*/
*                 THEN              /* THEN                  @Z67SP00*/
@RF00459 LA    @11,103                                             0468
         SLR   @01,@01                                             0468
         IC    @01,SDSINDX                                         0468
         MR    @00,@11                                             0468
         SLR   @08,@08                                             0468
         IC    @08,SGTPINDX                                        0468
         SLR   @05,@05                                             0468
         IC    @05,DSGTPLST-103(@01)                               0468
         CR    @08,@05                                             0468
         BNH   @RF00468                                            0468
*                 DO;               /*                               */
*                   SEOF(PDSINDX)=ON;/* END OF FILE          @Z67SP00*/
         LR    @07,@11                                             0470
         MR    @06,PDSINDX                                         0470
         LA    @11,SEOF-103(@07)                                   0470
         OI    0(@11),B'01000000'                                  0470
*                   SGTPINDX=DSGTPFRS(SDSINDX);/* FIRST GTP          */
         SLR   @11,@11                                             0471
         IC    @11,DSGTPFRS-103(@01)                               0471
         STC   @11,SGTPINDX                                        0471
*                   DSGTPGN(SDSINDX)=DSGTPFRS(SDSINDX);/*    @Z67SP00*/
         STC   @11,DSGTPGN-103(@01)                                0472
*                 END;              /*                               */
*               ELSE                /*                       @Z67SP00*/
*                 DO;               /*                       @Z67SP00*/
         B     @RC00468                                            0474
@RF00468 DS    0H                                                  0475
*                   GTPFUNCT(SGTPINDX)=GTPOPENN;/* OPEN      @Z67SP00*/
         SLR   @11,@11                                             0475
         IC    @11,SGTPINDX                                        0475
         MH    @11,@CH00467                                        0475
         LA    @08,1                                               0475
         STC   @08,GTPFUNCT-28(@11)                                0475
*                   CALL HMASMGTA(HMASMGTP(SGTPINDX));/*     @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0476
         ST    @11,@AL00001                                        0476
         L     @15,@CV01268                                        0476
         LA    @01,@AL00001                                        0476
         BALR  @14,@15                                             0476
*                   DSGTPGN(SDSINDX)=SGTPINDX;/* SET GETN    @Z67SP00*/
         SLR   @11,@11                                             0477
         IC    @11,SDSINDX                                         0477
         MH    @11,@CH01521                                        0477
         SLR   @08,@08                                             0477
         IC    @08,SGTPINDX                                        0477
         STC   @08,DSGTPGN-103(@11)                                0477
*                   STOP=OFF;       /* CONTINUE WITH READS   @Z67SP00*/
         NI    STOP,B'11101111'                                    0478
*                 END;              /*                       @Z67SP00*/
*             END;                  /* END GTP EOF           @Z67SP00*/
@RC00468 DS    0H                                                  0481
*         END;                      /* END GTA READ LOOP     @Z67SP00*/
@RF00457 DS    0H                                                  0481
@DE00452 TM    STOP,B'00010000'                                    0481
         BZ    @DL00452                                            0481
*       END;                        /*                       @Z67SP00*/
*                                                                  0482
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR END OF FILE ON BOTH DIS FILES             @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0483
*     IF PEOF(PDSINDX)=ON           /* IF EOF ON PRIMARY     @Z67SP00*/
*         &SEOF(PDSINDX)=ON         /* AND EOF ON SECONDARY  @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
@RF00449 LR    @11,PDSINDX                                         0483
         MH    @11,@CH01521                                        0483
         LA    @08,PEOF-103(@11)                                   0483
         TM    0(@08),B'11000000'                                  0483
         BNO   @RF00483                                            0483
*       GETNRC=IOPEOF;              /* SET END OF FILE RC    @Z67SP00*/
*                                                                  0484
         LA    GETNRC,4                                            0484
*     /***************************************************************/
*     /*                                                             */
*     /* NOT END OF FILE OF BOTH PRIMARY AND SECONDARY       @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0485
*     ELSE                          /*                       @Z67SP00*/
*       DO;                         /*                       @Z67SP00*/
*                                                                  0485
         B     @RC00483                                            0485
@RF00483 DS    0H                                                  0486
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR SECONDARY RECORD LOWER THAN PRIMARY   @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0486
*         IF(SEOF(PDSINDX)=OFF      /* IF NOT EOF ON SDIS    @Z67SP00*/
*             &DSBFNAME(SDSINDX)<=DSBFNAME(PDSINDX))/* IF SECONDARY
*                                      HAS KEY LESS THAN PRIMARY   0486
*                                                            @Z67SP00*/
*             ×PEOF(PDSINDX)=ON     /* OR EOF ON PRIMARY     @Z67SP00*/
*           THEN                    /* THEN                  @Z67SP00*/
         LA    @11,103                                             0486
         LR    @01,PDSINDX                                         0486
         MR    @00,@11                                             0486
         LA    @08,SEOF-103(@01)                                   0486
         TM    0(@08),B'01000000'                                  0486
         BNZ   @GL00014                                            0486
         LR    @07,@11                                             0486
         SLR   @11,@11                                             0486
         IC    @11,SDSINDX                                         0486
         MR    @06,@11                                             0486
         LA    @11,DSBFNAME-103(@07)                               0486
         LA    @08,DSBFNAME-103(@01)                               0486
         CLC   0(8,@11),0(@08)                                     0486
         BNH   @RT00486                                            0486
@GL00014 LR    @11,PDSINDX                                         0486
         MH    @11,@CH01521                                        0486
         LA    @08,PEOF-103(@11)                                   0486
         TM    0(@08),B'10000000'                                  0486
         BNO   @RF00486                                            0486
@RT00486 DS    0H                                                  0487
*           DO;                     /*                       @Z67SP00*/
*             IF DSBFDEL(SDSINDX)^=TXTDEL/* IF NOT DELETED   @Z67SP00*/
*               THEN                /* THEN                  @Z67SP00*/
         SLR   @11,@11                                             0488
         IC    @11,SDSINDX                                         0488
         MH    @11,@CH01521                                        0488
         LA    @08,DSBFDEL-103(@11)                                0488
         CLC   0(8,@08),@CC01281                                   0488
         BE    @RF00488                                            0488
*               IOPDRMAP(1:DSDIRLN(SDSINDX))=DSBUFFR(SDSINDX,1:DSDIRLN(
*                   SDSINDX));      /* MOVE RCD              @Z67SP00*/
         SLR   @08,@08                                             0489
         IC    @08,DSDIRLN-103(@11)                                0489
         BCTR  @08,0                                               0489
         LA    @05,DSBUFFR-103(@11)                                0489
         EX    @08,@SM01526                                        0489
*             ELSE                  /* IF DELETED TYPE       @Z67SP00*/
*               DEL=ON;             /* SET SW TO CAUSE LOOP BACK TO
*                                      READ NEXT RCD FROM SECONDARY
*                                      DIS                   @Z67SP00*/
         B     @RC00488                                            0490
@RF00488 OI    DEL,B'00100000'                                     0490
*           END;                    /*                       @Z67SP00*/
@RC00488 DS    0H                                                  0492
*         IF(PEOF(PDSINDX)=OFF      /* IF NOT EOF ON PDIS    @Z67SP00*/
*             &DSBFNAME(PDSINDX)<DSBFNAME(SDSINDX))/* AND PRIMARY HAS
*                                      LOWER KEY THAN SECONDARY    0492
*                                                            @Z67SP00*/
*             ×SEOF(PDSINDX)=ON     /* OR EOF ON SECONDARY   @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
@RF00486 LA    @11,103                                             0492
         LR    @01,PDSINDX                                         0492
         MR    @00,@11                                             0492
         LA    @08,PEOF-103(@01)                                   0492
         TM    0(@08),B'10000000'                                  0492
         BNZ   @GL00016                                            0492
         LR    @07,@11                                             0492
         SLR   @11,@11                                             0492
         IC    @11,SDSINDX                                         0492
         MR    @06,@11                                             0492
         LA    @11,DSBFNAME-103(@01)                               0492
         LA    @08,DSBFNAME-103(@07)                               0492
         CLC   0(8,@11),0(@08)                                     0492
         BL    @RT00492                                            0492
@GL00016 LR    @11,PDSINDX                                         0492
         MH    @11,@CH01521                                        0492
         LA    @08,SEOF-103(@11)                                   0492
         TM    0(@08),B'01000000'                                  0492
         BNO   @RF00492                                            0492
@RT00492 DS    0H                                                  0493
*           IOPDRMAP(1:DSDIRLN(PDSINDX))=DSBUFFR(PDSINDX,1:DSDIRLN(
*               PDSINDX));          /* MOVE RCD              @Z67SP00*/
         LR    @11,PDSINDX                                         0493
         MH    @11,@CH01521                                        0493
         SLR   @08,@08                                             0493
         IC    @08,DSDIRLN-103(@11)                                0493
         BCTR  @08,0                                               0493
         LA    @05,DSBUFFR-103(@11)                                0493
         EX    @08,@SM01526                                        0493
*       END;                        /*                       @Z67SP00*/
@RF00492 DS    0H                                                  0495
*   END;                            /* END LOOP READING DIR  @Z67SP00*/
*                                                                  0495
@RC00483 DS    0H                                                  0495
@DE00395 TM    DEL,B'00100000'                                     0495
         BO    @DL00395                                            0495
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER WITH RC AND DIR INFO SET UP          @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0496
*   RETURN CODE(GETNRC);            /*                       @Z67SP00*/
         LR    @15,GETNRC                                          0496
         L     @14,@SA00006                                        0496
         LM    @00,@12,@SA00006+8                                  0496
         BR    @14                                                 0496
*   END EISGETN;                    /*                       @Z67SP00*/
         EJECT
*                                                                  0498
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO CLOSE DIS FILES IN PREPARATION FOR          */
*   /* SEQUENTIAL READ PROCESSING                            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0498
*EISCLOSN:                          /*                       @Z67SP00*/
*   PROC;                           /*                       @Z67SP00*/
*                                                                  0498
EISCLOSN STM   @14,@12,@SA00007                                    0498
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE SECONDARY FILE IF ONE EXISTS                    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0499
*   IF CCACHECK=ON                  /* IF IN CHECK MODE      @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @11,@CA00037                                        0499
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0499
         BNO   @RF00499                                            0499
*     DO;                           /*                       @Z67SP00*/
*       GTPFUNCT(SGTPINDX)=GTPOPENN;/* RESET PTRS            @Z67SP00*/
         SLR   @11,@11                                             0501
         IC    @11,SGTPINDX                                        0501
         MH    @11,@CH00467                                        0501
         LA    @08,1                                               0501
         STC   @08,GTPFUNCT-28(@11)                                0501
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/* DO OPEN         @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0502
         ST    @11,@AL00001                                        0502
         L     @15,@CV01268                                        0502
         LA    @01,@AL00001                                        0502
         BALR  @14,@15                                             0502
*       DSBUFFR(SDSINDX)='';        /* BLANK BUFFER          @Z67SP00*/
         SLR   @11,@11                                             0503
         IC    @11,SDSINDX                                         0503
         MH    @11,@CH01521                                        0503
         LA    @08,DSBUFFR-103(@11)                                0503
         MVI   0(@08),C' '                                         0503
         MVC   1(73,@08),0(@08)                                    0503
*       DSFLAGS1(SDSINDX)=ZERO;     /*                       @Z67SP00*/
         SLR   @08,@08                                             0504
         STC   @08,DSFLAGS1-103(@11)                               0504
*     END;                          /*                       @Z67SP00*/
*                                                                  0505
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE PRIMARY FILE                                    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0506
*   GTPFUNCT(PGTPINDX)=GTPOPENN;    /*                       @Z67SP00*/
@RF00499 SLR   @11,@11                                             0506
         IC    @11,PGTPINDX                                        0506
         MH    @11,@CH00467                                        0506
         LA    @08,1                                               0506
         STC   @08,GTPFUNCT-28(@11)                                0506
*   CALL HMASMGTA(HMASMGTP(PGTPINDX));/* DO OPEN             @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0507
         ST    @11,@AL00001                                        0507
         L     @15,@CV01268                                        0507
         LA    @01,@AL00001                                        0507
         BALR  @14,@15                                             0507
*   DSBUFFR(PDSINDX)='';            /* BLANK BUFFER          @Z67SP00*/
         LR    @11,PDSINDX                                         0508
         MH    @11,@CH01521                                        0508
         LA    @08,DSBUFFR-103(@11)                                0508
         MVI   0(@08),C' '                                         0508
         MVC   1(73,@08),0(@08)                                    0508
*   DSFLAGS1(PDSINDX)=ZERO;         /*                       @Z67SP00*/
         SLR   @08,@08                                             0509
         STC   @08,DSFLAGS1-103(@11)                               0509
*   RETURN CODE(IOPGOOD);           /*                       @Z67SP00*/
         LR    @15,@08                                             0510
         L     @14,@SA00007                                        0510
         LM    @00,@12,@SA00007+8                                  0510
         BR    @14                                                 0510
*   END EISCLOSN;                   /*                       @Z67SP00*/
         EJECT
*                                                                  0512
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO PERFORM THE STOWR FUNCTION. THE DATA PORTION*/
*   /* HAS ALREADY BEEN WRITTEN AND THE TTR IN THE DIRECTORY ENTRY   */
*   /* POINTS TO THE NEW DATA AREA                           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0512
*EISSTOWR:                          /*                       @Z67SP00*/
*                                                                  0512
*   /*****************************************************************/
*   /*                                                               */
*   /* ALTERNATE ENTRY POINT TO PERFORM THE UPDATE DIRECTORY ONLY    */
*   /* FUNCTION                                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0512
*EISUDEO:                           /*                       @Z67SP00*/
*   PROC;                           /*                       @Z67SP00*/
EISSTOWR DS    0H                                                  0512
EISUDEO  STM   @14,@12,@SA00008                                    0512
*   DECLARE                         /*                       @Z67SP00*/
*     STOWRRC FIXED(8);             /* INTERNAL RETURN CODE          */
*   RFY                                                            0514
*     HMASMIOP BASED(IOPPTR);       /* REFERENCE CALLERS IOP         */
*   STOWRRC=IOPGOOD;                /* INIT RETURN CODE              */
         SLR   STOWRRC,STOWRRC                                     0515
*   IF CCACHECK=OFF                 /* IF NOT CHECK MODE     @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @11,@CA00037                                        0516
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0516
         BNZ   @RF00516                                            0516
*     DO;                           /*                       @Z67SP00*/
*       GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* SET PTR TO ENTRY      0518
*                                                            @Z67SP00*/
         SLR   @11,@11                                             0518
         IC    @11,PGTPINDX                                        0518
         MH    @11,@CH00467                                        0518
         LA    @08,IOPDRMAP(,IOPPTR)                               0518
         ST    @08,GTPBUFAD-28(@11)                                0518
*       GTPFUNCT(PGTPINDX)=GTPADD;  /* ADD ENTRY TO DIS      @Z67SP00*/
         LA    @08,4                                               0519
         STC   @08,GTPFUNCT-28(@11)                                0519
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* ADD VIA CALL TO HMASMGTA
*                                                            @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0520
         ST    @11,@AL00001                                        0520
         L     @15,@CV01268                                        0520
         LA    @01,@AL00001                                        0520
         BALR  @14,@15                                             0520
*       STOWRRC=GTPRETRN(PGTPINDX); /* SAVE ADD RETURN CODE  @Z67SP00*/
         SLR   @11,@11                                             0521
         IC    @11,PGTPINDX                                        0521
         MH    @11,@CH00467                                        0521
         SLR   STOWRRC,STOWRRC                                     0521
         IC    STOWRRC,GTPRETRN-28(@11)                            0521
*       IF STOWRRC=ZERO             /* IF RCD STOWED         @Z67SP00*/
*           &GTPRCDNF(PGTPINDX)=ON  /* AND NOT THERE BEFORE  @Z67SP00*/
*         THEN                      /* THEN INCR RCDS USED   @Z67SP00*/
         CH    STOWRRC,@CH00252                                    0522
         BNE   @RF00522                                            0522
         LA    @08,GTPRCDNF-28(@11)                                0522
         TM    0(@08),B'01000000'                                  0522
         BNO   @RF00522                                            0522
*         DSMEMUSE(PDSINDX)=DSMEMUSE(PDSINDX)+1;/* BY 1      @Z67SP00*/
         LR    @11,PDSINDX                                         0523
         MH    @11,@CH01521                                        0523
         LA    @08,1                                               0523
         AL    @08,DSMEMUSE-103(@11)                               0523
         ST    @08,DSMEMUSE-103(@11)                               0523
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /* IF CHECK MODE         @Z67SP00*/
*     DO;                           /*                       @Z67SP00*/
         B     @RC00516                                            0525
@RF00516 DS    0H                                                  0526
*       GTPBUFAD(SGTPINDX)=ADDR(IOPDRMAP);/* SET PTR TO ENTRY      0526
*                                                            @Z67SP00*/
         SLR   @11,@11                                             0526
         IC    @11,SGTPINDX                                        0526
         MH    @11,@CH00467                                        0526
         LA    @08,IOPDRMAP(,IOPPTR)                               0526
         ST    @08,GTPBUFAD-28(@11)                                0526
*       GTPFUNCT(SGTPINDX)=GTPADD;  /* ADD ENTRY TO DIS      @Z67SP00*/
         LA    @08,4                                               0527
         STC   @08,GTPFUNCT-28(@11)                                0527
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/* ADD VIA CALL TO HMASMGTA
*                                                            @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0528
         ST    @11,@AL00001                                        0528
         L     @15,@CV01268                                        0528
         LA    @01,@AL00001                                        0528
         BALR  @14,@15                                             0528
*       STOWRRC=GTPRETRN(SGTPINDX); /* SAVE ADD RETURN CODE  @Z67SP00*/
         SLR   @11,@11                                             0529
         IC    @11,SGTPINDX                                        0529
         MH    @11,@CH00467                                        0529
         SLR   STOWRRC,STOWRRC                                     0529
         IC    STOWRRC,GTPRETRN-28(@11)                            0529
*     END;                          /*                       @Z67SP00*/
*   IF STOWRRC^=GTPGOOD             /* IF NO SPACE THEN DO           */
*     THEN                                                         0531
@RC00516 CH    STOWRRC,@CH00252                                    0531
         BE    @RF00531                                            0531
*     DO;                           /*                       @Z67SP00*/
*       CALL EISSPMSG;              /* ISSUE OUT OF SPCE MSG @Z67SP00*/
         BAL   @14,EISSPMSG                                        0533
*       RFY                                                        0534
*         RTNCODE RSTD;             /*                               */
*       STOWRRC=RTNCODE;            /* PASS ALONG RC         @Z67SP00*/
         LR    STOWRRC,RTNCODE                                     0535
*       RFY                         /*                       @Z67SP00*/
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*     END;                                                         0537
*   ELSE                            /*                       @Z67SP00*/
*     CCAFLAG6=CCAFLAG6×DSMSKON(PDSINDX);/* SET DIS UPDATED  @Z67SP00*/
         B     @RC00531                                            0538
@RF00531 L     @11,@CA00037                                        0538
         LR    @08,PDSINDX                                         0538
         MH    @08,@CH01521                                        0538
         LA    @05,DSMSKON-103(@08)                                0538
         OC    CCAFLAG6-HMASMCCA(1,@11),0(@05)                     0538
*   IF DSMEMUSE(PDSINDX)>DSMEMMAX(PDSINDX)/* IF STOW CAUSED  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RC00531 LR    @11,PDSINDX                                         0539
         MH    @11,@CH01521                                        0539
         L     @08,DSMEMUSE-103(@11)                               0539
         C     @08,DSMEMMAX-103(@11)                               0539
         BNH   @RF00539                                            0539
*     DO;                           /*                       @Z67SP00*/
*       HMASMMGP=''B;               /* WRITE ERROR MSG       @Z67SP00*/
         XC    HMASMMGP(24),HMASMMGP                               0541
*       MGPPRINT=ON;                /*                       @Z67SP00*/
*       MGPHLDS=ON;                 /*                       @Z67SP00*/
         OI    MGPPRINT,B'10010000'                                0543
*       MGPMGNO1=HMA267I;           /* DIRECTORY SPACE EXCEEDED    0544
*                                      ATTEMPTING TO STORE   @Z67SP00*/
         MVC   MGPMGNO1(2),@CH01031                                0544
*       MGPMGNO2=PART031;           /* XXXXXXXX XXXXXXXX     @Z67SP00*/
         MVC   MGPMGNO2(2),@CH00042                                0545
*       MGPMGNO3=PART016;           /* ON XXXXXXXX LIBRARY   @Z67SP00*/
         MVC   MGPMGNO3(2),@CH00188                                0546
*       MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE          @Z67SP00*/
         SLR   @11,@11                                             0547
         IC    @11,IOPTYPE(,IOPPTR)                                0547
         SLA   @11,3                                               0547
         L     @08,@CA00037                                        0547
         L     @05,CCATPAD-HMASMCCA(,@08)                          0547
         AL    @05,@CF01530                                        0547
         LA    @11,CCATYPEA(@11,@05)                               0547
         ST    @11,MGPVARPT                                        0547
*       MGPVARPT(2)=ADDR(IOPNAME);  /* MEMBER NAME           @Z67SP00*/
         LA    @11,IOPNAME(,IOPPTR)                                0548
         ST    @11,MGPVARPT+4                                      0548
*       MGPVARPT(3)=ADDR(CCADSIDA(IOPDSID));/* DATASET       @Z67SP00*/
         SLR   @11,@11                                             0549
         IC    @11,IOPDSID(,IOPPTR)                                0549
         SLA   @11,3                                               0549
         L     @08,CCADSAD-HMASMCCA(,@08)                          0549
         AL    @08,@CF01530                                        0549
         LA    @11,CCADSIDA(@11,@08)                               0549
         ST    @11,MGPVARPT+8                                      0549
*       MGPTYPE=MGPSEV;             /*                       @Z67SP00*/
         MVI   MGPTYPE,X'04'                                       0550
*       CALL HMASMMSG(HMASMMGP);    /*                       @Z67SP00*/
         L     @15,@CV01270                                        0551
         LA    @01,@AL00551                                        0551
         BALR  @14,@15                                             0551
*       STOWRRC=IOPDIRFL;           /* SET RC                @Z67SP00*/
         LA    STOWRRC,12                                          0552
*       GTPFUNCT(PGTPINDX)=GTPDEL;  /* DELETE ELEMENT JUST   @Z67SP00*/
         SLR   @11,@11                                             0553
         IC    @11,PGTPINDX                                        0553
         MH    @11,@CH00467                                        0553
         LA    @08,5                                               0553
         STC   @08,GTPFUNCT-28(@11)                                0553
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* ADDED           @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0554
         ST    @11,@AL00001                                        0554
         L     @15,@CV01268                                        0554
         LA    @01,@AL00001                                        0554
         BALR  @14,@15                                             0554
*     END;                          /*                       @Z67SP00*/
*   RETURN CODE(STOWRRC);                                          0556
@RF00539 LR    @15,STOWRRC                                         0556
         L     @14,@SA00008                                        0556
         LM    @00,@12,@SA00008+8                                  0556
         BR    @14                                                 0556
*   END EISSTOWR;                                                  0557
         EJECT
*                                                                  0558
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED TO PERFORM THE STOW DELETE FUNCTION.   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0558
*EISSTOWD:                          /*                       @Z67SP00*/
*   PROC;                           /*                       @Z67SP00*/
EISSTOWD STM   @14,@12,@SA00009                                    0558
*   DECLARE                         /*                       @Z67SP00*/
*     STOWDRC FIXED(8);             /*                       @Z67SP00*/
*   STOWDRC=IOPGOOD;                /* INIT RC               @Z67SP00*/
         SLR   STOWDRC,STOWDRC                                     0560
*   IF CCACHECK=OFF                 /* IF NOT IN CHECK MODE  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @11,@CA00037                                        0561
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0561
         BNZ   @RF00561                                            0561
*     DO;                           /*                       @Z67SP00*/
*       GTPFUNCT(PGTPINDX)=GTPDEL;  /* DO DELETE FROM PRIM   @Z67SP00*/
         SLR   @11,@11                                             0563
         IC    @11,PGTPINDX                                        0563
         MH    @11,@CH00467                                        0563
         LA    @08,5                                               0563
         STC   @08,GTPFUNCT-28(@11)                                0563
*       GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* DIR ENTRY ADDR  @Z67SP00*/
         LA    @08,IOPDRMAP(,IOPPTR)                               0564
         ST    @08,GTPBUFAD-28(@11)                                0564
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* DO DELETE       @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0565
         ST    @11,@AL00001                                        0565
         L     @15,@CV01268                                        0565
         LA    @01,@AL00001                                        0565
         BALR  @14,@15                                             0565
*       STOWDRC=MAX(STOWDRC,GTPRETRN(PGTPINDX));/* SAVE RC   @Z67SP00*/
         SLR   @11,@11                                             0566
         IC    @11,PGTPINDX                                        0566
         MH    @11,@CH00467                                        0566
         SLR   @08,@08                                             0566
         IC    @08,GTPRETRN-28(@11)                                0566
         CR    STOWDRC,@08                                         0566
         BNL   *+6
         LR    STOWDRC,@08                                         0566
*       IF GTPRETRN(PGTPINDX)=GTPGOOD/* IF DELETE OK         @Z67SP00*/
*           &GTPRCDNF(PGTPINDX)=OFF /* AND RCD FOUND         @Z67SP00*/
*         THEN                      /* THEN DECR USED CNT    @Z67SP00*/
         LTR   @08,@08                                             0567
         BNZ   @RF00567                                            0567
         LA    @08,GTPRCDNF-28(@11)                                0567
         TM    0(@08),B'01000000'                                  0567
         BNZ   @RF00567                                            0567
*         DSMEMUSE(PDSINDX)=DSMEMUSE(PDSINDX)-ONE;/* BY 1    @Z67SP00*/
         LR    @11,PDSINDX                                         0568
         MH    @11,@CH01521                                        0568
         L     @08,DSMEMUSE-103(@11)                               0568
         BCTR  @08,0                                               0568
         ST    @08,DSMEMUSE-103(@11)                               0568
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /* IF IN CHECK THEN      @Z67SP00*/
*     DO;                           /*                       @Z67SP00*/
         B     @RC00561                                            0570
@RF00561 DS    0H                                                  0571
*       DSBUFFR(SDSINDX,1:DSDIRLN(SDSINDX))=IOPDRMAP(1:DSDIRLN(SGTPINDX
*           ));                     /* MOVE RCD TO TEMP BUFFER     0571
*                                                            @Z67SP00*/
         SLR   @11,@11                                             0571
         IC    @11,SDSINDX                                         0571
         MH    @11,@CH01521                                        0571
         LA    @08,DSBUFFR-103(@11)                                0571
         SLR   @05,@05                                             0571
         IC    @05,DSDIRLN-103(@11)                                0571
         BCTR  @05,0                                               0571
         MVC   @TS00001(12),IOPDRMAP(IOPPTR)                       0571
         EX    @05,@SM01531                                        0571
*       DSBFDEL(SDSINDX)=TXTDEL;    /* MARK AS DELETED       @Z67SP00*/
         LA    @08,DSBFDEL-103(@11)                                0572
         MVC   0(8,@08),@CC01281                                   0572
*       GTPFUNCT(SGTPINDX)=GTPADD;  /* DO ADD/REP            @Z67SP00*/
         SLR   @08,@08                                             0573
         IC    @08,SGTPINDX                                        0573
         MH    @08,@CH00467                                        0573
         LA    @05,4                                               0573
         STC   @05,GTPFUNCT-28(@08)                                0573
*       GTPBUFAD(SGTPINDX)=ADDR(DSBUFFR(SDSINDX));/* RCD ADD @Z67SP00*/
         LA    @11,DSBUFFR-103(@11)                                0574
         ST    @11,GTPBUFAD-28(@08)                                0574
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/* DO ADD/REP      @Z67SP00*/
         LA    @11,HMASMGTP-28(@08)                                0575
         ST    @11,@AL00001                                        0575
         L     @15,@CV01268                                        0575
         LA    @01,@AL00001                                        0575
         BALR  @14,@15                                             0575
*       IF GTPRETRN(SGTPINDX)^=GTPGOOD/* IF NO SPACE         @Z67SP00*/
*         THEN                                                     0576
         SLR   @11,@11                                             0576
         IC    @11,SGTPINDX                                        0576
         MH    @11,@CH00467                                        0576
         SLR   @08,@08                                             0576
         IC    @08,GTPRETRN-28(@11)                                0576
         CH    @08,@CH00252                                        0576
         BE    @RF00576                                            0576
*         DO;                       /*                       @Z67SP00*/
*           CALL EISSPMSG;          /* ISSUE OUT OF SPCE MSG @Z67SP00*/
         BAL   @14,EISSPMSG                                        0578
*           RFY                                                    0579
*             RTNCODE RSTD;         /*                               */
*           STOWDRC=RTNCODE;        /*                               */
         LR    STOWDRC,RTNCODE                                     0580
*           RFY                                                    0581
*             RTNCODE UNRSTD;       /*                               */
*         END;                                                     0582
*     END;                          /*                       @Z67SP00*/
@RF00576 DS    0H                                                  0584
*   IF STOWDRC=ZERO                 /* IF DELETE OK          @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RC00561 CH    STOWDRC,@CH00252                                    0584
         BNE   @RF00584                                            0584
*     CCAFLAG6=CCAFLAG6×DSMSKON(PDSINDX);/* SET DIS UPDATED  @Z67SP00*/
         L     @11,@CA00037                                        0585
         LR    @08,PDSINDX                                         0585
         MH    @08,@CH01521                                        0585
         LA    @05,DSMSKON-103(@08)                                0585
         OC    CCAFLAG6-HMASMCCA(1,@11),0(@05)                     0585
*   RETURN CODE(STOWDRC);           /*                       @Z67SP00*/
@RF00584 LR    @15,STOWDRC                                         0586
         L     @14,@SA00009                                        0586
         LM    @00,@12,@SA00009+8                                  0586
         BR    @14                                                 0586
*   END EISSTOWD;                   /*                       @Z67SP00*/
         EJECT
*                                                                  0588
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL FORMAT THE IN STORAGE DIRECTORY INTO        */
*   /* DIRECTORY BLOCK FORMAT. IF THE NUMBER OF BLOCKS FORMATTED IS  */
*   /* LESS THAN OR EQUAL TO THE NUMBER OF DIRECTORY BLOCKS ALLOCATED*/
*   /* THEN IN STORAGE DIRECTORY WILL BE REFORMATTED AND WRITTEN OUT */
*   /* TO THE APPROPRIATE SMP DATA SET. IF THE NUMBER OF DIRECTORY   */
*   /* BLOCKS FORMATTED IS GREATER THAN THE NUMBER OF DIRECTORY      */
*   /* BLOCKS ALLOCATED THEN HMA2823 WILL BE ISSUED AND A RETURN CODE*/
*   /* OF 12 WILL BE SET.                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0588
*EISWRDIR:                          /*                       @Z67SP00*/
*   PROC;                           /*                       @Z67SP00*/
EISWRDIR STM   @14,@12,@SA00010                                    0588
*   DECLARE                                                        0589
*     WRDIRRC FIXED(8);             /* INTERNAL RETURN CODE          */
*   DECLARE                         /*                       @Z67SP00*/
*     DECALLOC CHAR(5) BDY(DWORD);  /* DIR BLK ALLOC DECIMAL COUNT   */
*   DECLARE                         /*                       @Z67SP00*/
*     DECREQD CHAR(5) BDY(DWORD);   /* DIR BLK REQUIRED DECIMAL COUNT*/
*   DECLARE                                                        0592
*     PRTALLOC CHAR(5);             /* DIR BLK ALLOC PRINTABLE COUNT */
*   DECLARE                                                        0593
*     PRTREQD CHAR(5);              /* DIR BLK REQUIRED PRINTABLE  0593
*                                      CNT.                          */
*   DECLARE                                                        0594
*     PRTMSK BIT(8) CONSTANT('F0'X);/* USED TO MAKE LAST CHAR      0594
*                                      PRINTABLE                     */
*   WRDIRRC=IOPGOOD;                /* INITIALIZE RETURN CODE        */
         SLR   WRDIRRC,WRDIRRC                                     0595
*   CALL EISFORM;                   /* DETERMINE IF INSTORAGE WILL 0596
*                                      FIT ON SMP DATA SET           */
         BAL   @14,EISFORM                                         0596
*   RFY                                                            0597
*     RTNCODE RSTD;                                                0597
*   WRDIRRC=RTNCODE;                /* SAVE RC FROM FORMAT ROUTINE   */
         LR    WRDIRRC,RTNCODE                                     0598
*   RFY                                                            0599
*     RTNCODE UNRSTD;                                              0599
*   IF DIRBKCT>DSBLKCT(PDSINDX)     /* IF NOT ENOUGH SPACE THEN DO   */
*     THEN                          /*                       @Z67SP00*/
         LR    @11,PDSINDX                                         0600
         MH    @11,@CH01521                                        0600
         L     @08,DSBLKCT-103(@11)                                0600
         CR    DIRBKCT,@08                                         0600
         BNH   @RF00600                                            0600
*     DO;                           /*                       @Z67SP00*/
*       HMASMMGP=''B;               /* CLEAR MESSAGE PARMS           */
         XC    HMASMMGP(24),HMASMMGP                               0602
*       MGPPRINT=ON;                /* MESSAGES TO SYSOUT            */
*       MGPHLDS=ON;                 /* MESSAGES TO LOG               */
         OI    MGPPRINT,B'10010000'                                0604
*       MGPTYPE=MGPSEV;             /* SET TO SEVERE MESSAGE         */
         MVI   MGPTYPE,X'04'                                       0605
*       MGPMGNO1=HMA282I;           /* SET MESSAGE NUMBER            */
         MVC   MGPMGNO1(2),@CH00518                                0606
*       MGPVARPT(1)=ADDR(DSDDNAME(PDSINDX));/*                       */
         LA    @11,DSDDNAME-103(@11)                               0607
         ST    @11,MGPVARPT                                        0607
*       CVD(DIRBKCT,DECREQD);       /* CONVERT REQUIRED BLK CT TO DEC*/
         CVD   DIRBKCT,@TS00001                                    0608
         MVC   DECREQD(5),@TS00001+3                               0608
*       UNPK(PRTREQD,DECREQD);      /* UNPACK DECIMAL RED BLOCK CNT. */
         UNPK  PRTREQD(5),DECREQD(5)                               0609
*       PRTREQD(5)=PRTREQD(5)×PRTMSK;/* MAKE LAST CHAR PRINTABLE     */
         OI    PRTREQD+4,X'F0'                                     0610
*       MGPVARPT(2)=ADDR(PRTREQD);  /* INSERT REQD CNT INTO MSG      */
         LA    @11,PRTREQD                                         0611
         ST    @11,MGPVARPT+4                                      0611
*       CVD(DSBLKCT(PDSINDX),DECALLOC);/* CNV. ALLOC CT. TO DEC      */
         CVD   @08,@TS00001                                        0612
         MVC   DECALLOC(5),@TS00001+3                              0612
*       UNPK(PRTALLOC,DECALLOC);    /* UNPACK DECIMAL ALOOCATED CNT. */
         UNPK  PRTALLOC(5),DECALLOC(5)                             0613
*       PRTALLOC(5)=PRTALLOC(5)×PRTMSK;/* MAKE LAST CHAR PRINTABLE   */
         OI    PRTALLOC+4,X'F0'                                    0614
*       MGPVARPT(3)=ADDR(PRTALLOC); /* INSERT ALLOC CNT INTO MSG     */
         LA    @11,PRTALLOC                                        0615
         ST    @11,MGPVARPT+8                                      0615
*       CALL HMASMMSG(HMASMMGP);    /* NOT ENOUGH SPACE ON SMP DS    */
         L     @15,@CV01270                                        0616
         LA    @01,@AL00616                                        0616
         BALR  @14,@15                                             0616
*       WRDIRRC=STOPFUNC;           /* SET RC TO STOP FUNCTION       */
         LA    WRDIRRC,12                                          0617
*     END;                                                         0618
*   ELSE                            /* IF ENOUGH SPACE THEN WRITE OUT
*                                      INSTORAGE FILE TO SMP DATA SET*/
*     IF CCACHECK=OFF               /* IF NOT IN CHECK MODE  @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
         B     @RC00600                                            0619
@RF00600 L     @11,@CA00037                                        0619
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0619
         BNZ   @RF00619                                            0619
*       DO;                         /*                       @Z67SP00*/
*         DSFLAGS1(PDSINDX)=''B;    /* ZERO EOF FLAGS BITS   @Z67SP00*/
         LR    @11,PDSINDX                                         0621
         MH    @11,@CH01521                                        0621
         LA    @08,DSFLAGS1-103(@11)                               0621
         MVI   0(@08),X'00'                                        0621
*         CALL EISWRITE;            /* WRITE IN STORAGE DIRECTORY TO
*                                      SMP DATA SET                  */
         BAL   @14,EISWRITE                                        0622
*         RFY                                                      0623
*           RTNCODE RSTD;                                          0623
*         WRDIRRC=RTNCODE;          /* SAVE RETURN CODE FROM WRITE   */
         LR    WRDIRRC,RTNCODE                                     0624
*         RFY                                                      0625
*           RTNCODE UNRSTD;                                        0625
*       END;                        /* END OF WRITE TO SMP DATA SET  */
*   CCAFLAG6=CCAFLAG6&DSMSKOFF(PDSINDX);/* TURN OFF DIS UPDATED    0627
*                                      INDICATOR             @Z67SP00*/
@RF00619 DS    0H                                                  0627
@RC00600 L     @11,@CA00037                                        0627
         LR    @08,PDSINDX                                         0627
         MH    @08,@CH01521                                        0627
         LA    @01,DSMSKOFF-103(@08)                               0627
         NC    CCAFLAG6-HMASMCCA(1,@11),0(@01)                     0627
*   RETURN CODE(WRDIRRC);                                          0628
         LR    @15,WRDIRRC                                         0628
         L     @14,@SA00010                                        0628
         LM    @00,@12,@SA00010+8                                  0628
         BR    @14                                                 0628
*   END EISWRDIR;                                                  0629
         EJECT
*                                                                  0630
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL READ THE IN STORAGE DIRECTORY VIA CALLS TO  */
*   /* HMASMGTA AND FORMAT THE RECORDS INTO DIRECTORY BLOCKS. THE    */
*   /* OUTPUT FROM THIS ROUTINE WILL BE A COUNT OF THE DIRECTORY     */
*   /* BLOCKS FORMATTED(DIRBKCT).                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0630
*EISFORM:                                                          0630
*   PROC;                                                          0630
EISFORM  STM   @14,@06,@SA00011                                    0630
         STM   @08,@12,@SA00011+36                                 0630
*   DECLARE                                                        0631
*     FORMRC FIXED(8);              /* INTERNAL RETURN CODE          */
*   RFY                                                            0632
*     HMASMIOP BASED(WRDIRPTR);     /* USE APPROPRIATE IOP           */
*   FORMRC=IOPGOOD;                 /* INIT INTERNAL RETURN CODE     */
         SLR   FORMRC,FORMRC                                       0633
*   UNUSEDSP=LENGTH(OUTFILL);       /* INIT UNUSED DIRECTORY SPACE   */
         LA    UNUSEDSP,254                                        0634
*   DIRBKCT=ZERO;                   /* INIT NO. OF DIRECTORY BLOCKS
*                                      FORMATTED                     */
         SLR   DIRBKCT,DIRBKCT                                     0635
*   GTPFUNCT(PGTPINDX)=GTPOPENN;    /* OPEN FOR GETN PROCESSING      */
         SLR   @11,@11                                             0636
         IC    @11,PGTPINDX                                        0636
         MH    @11,@CH00467                                        0636
         LA    @08,1                                               0636
         STC   @08,GTPFUNCT-28(@11)                                0636
*   CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO GTA             */
         LA    @11,HMASMGTP-28(@11)                                0637
         ST    @11,@AL00001                                        0637
         L     @15,@CV01268                                        0637
         LA    @01,@AL00001                                        0637
         BALR  @14,@15                                             0637
*   DO WHILE(FORMRC=GTPGOOD);       /* FORMAT UNTIL ALL RECORDS FROM
*                                      IN STORAGE FILE HAVE BEEN   0638
*                                      FORMATTED                     */
         B     @DE00638                                            0638
@DL00638 DS    0H                                                  0639
*     CALL EISGETN;                 /* GET NEXT RCD FROM GTA @Z67SP00*/
         BAL   @14,EISGETN                                         0639
*     RFY                           /*                       @Z67SP00*/
*       RTNCODE RSTD;               /*                       @Z67SP00*/
*     FORMRC=RTNCODE;               /* SAVE GTA RETURN CODE          */
         LR    FORMRC,RTNCODE                                      0641
*     RFY                           /*                       @Z67SP00*/
*       RTNCODE UNRSTD;             /*                       @Z67SP00*/
*     IF FORMRC=GTPGOOD             /* IF RECORD RETRIVED THEN DO    */
*       THEN                        /*                               */
         CH    FORMRC,@CH00252                                     0643
         BNE   @RF00643                                            0643
*       DO;                         /*                               */
*         MVSIZE=((ULEN&NOALIAS)*2+DIRBASE);/* CALCULATE SIZE OF   0645
*                                      ENTRY                         */
         SLR   @11,@11                                             0645
         IC    @11,PGTPINDX                                        0645
         MH    @11,@CH00467                                        0645
         L     @11,GTPBUFAD-28(@11)                                0645
         LA    MVSIZE,31                                           0645
         SLR   @08,@08                                             0645
         IC    @08,ULEN(,@11)                                      0645
         NR    MVSIZE,@08                                          0645
         ALR   MVSIZE,MVSIZE                                       0645
         AH    MVSIZE,@CH00033                                     0645
*         IF MVSIZE>UNUSEDSP        /* IF DIRECTORY BLOCK FULL THEN  */
*           THEN                    /* DO                            */
         CR    MVSIZE,UNUSEDSP                                     0646
         BNH   @RF00646                                            0646
*           DO;                     /*                       @Z67SP00*/
*             DIRBKCT=DIRBKCT+ONE;  /* INCR COUNT OF DIR. BLOCKS     */
         AH    DIRBKCT,@CH00087                                    0648
*             UNUSEDSP=LENGTH(OUTFILL);/* REINIT UNUSED SPACE        */
         LA    UNUSEDSP,254                                        0649
*           END;                    /*                               */
*         UNUSEDSP=UNUSEDSP-MVSIZE; /* UPDATE UNUSED SPACE COUNT     */
@RF00646 SLR   UNUSEDSP,MVSIZE                                     0651
*       END;                                                       0652
*     ELSE                                                         0653
*       DO;                         /*                       @Z67SP00*/
         B     @RC00643                                            0653
@RF00643 DS    0H                                                  0654
*         IF DIRBASE>UNUSEDSP       /* IF END OF FILE RETURNED THEN  */
*           THEN                    /*                       @Z67SP00*/
         CH    UNUSEDSP,@CH00033                                   0654
         BNL   @RF00654                                            0654
*           DIRBKCT=DIRBKCT+ONE;    /* UP COUNT OF DIR. BLKS IF    0655
*                                      NECESSARY                     */
         AH    DIRBKCT,@CH00087                                    0655
*         DIRBKCT=DIRBKCT+ONE;      /* WRITE OUT PAGE WITH EOF       */
@RF00654 AH    DIRBKCT,@CH00087                                    0656
*       END;                                                       0657
*   END;                                                           0658
@RC00643 DS    0H                                                  0658
@DE00638 CH    FORMRC,@CH00252                                     0658
         BE    @DL00638                                            0658
*   PGTPINDX=DSGTPFRS(PDSINDX);     /* RESET INDEX BACK TO FIRST GTP
*                                      FOR DATASET           @Z67SP00*/
         LR    @11,PDSINDX                                         0659
         MH    @11,@CH01521                                        0659
         SLR   @08,@08                                             0659
         IC    @08,DSGTPFRS-103(@11)                               0659
         STC   @08,PGTPINDX                                        0659
*   RETURN CODE(FORMRC);                                           0660
         LR    @15,FORMRC                                          0660
         L     @14,@SA00011                                        0660
         LM    @00,@06,@SA00011+8                                  0660
         LM    @08,@12,@SA00011+36                                 0660
         BR    @14                                                 0660
*   END EISFORM;                                                   0661
         EJECT
*                                                                  0662
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL FORMAT THE IN STORAGE DIRECTORY INTO        */
*   /* DIRECTORY BLOCK FORMAT AND UPDATE THE APPROPRIATE SMP DATA SET*/
*   /* DIRECTORY                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0662
*EISWRITE:                                                         0662
*   PROC;                                                          0662
EISWRITE STM   @14,@12,@SA00012                                    0662
*   DECLARE                                                        0663
*     WRITRC FIXED(8);              /* INTERNAL RETURN CODE          */
*   DECLARE                                                        0664
*     1 WRITSW BIT(8),              /* SWITCH FOR THIS ROUTINE       */
*       3 WRITSTOP BIT(1),          /* ON FOR EOF CONDITION          */
*       3 * BIT(7);                 /* UNUSED                        */
*   RFY                                                            0665
*     HMASMIOP BASED(WRDIRPTR);     /* ADDRESS APPROPRIATE IOP       */
*   WRITRC=IOPGOOD;                 /* INIT INTERNAL RETURN CODE     */
         SLR   WRITRC,WRITRC                                       0666
*   UNUSEDSP=LENGTH(OUTFILL);       /* INIT UNUSED DIRECTORY SPACE   */
         LA    UNUSEDSP,254                                        0667
*   FILLPTR=ADDR(OUTFILL);          /* INIT TO BEGINNING OF DIRECTORY
*                                      BLOCK                         */
         LA    FILLPTR,OUTFILL                                     0668
*   DIRBKCT=ZERO;                   /* INIT COUNT OF DIR BLOCKS      */
         SLR   DIRBKCT,DIRBKCT                                     0669
*   GTPFUNCT(PGTPINDX)=GTPOPENN;    /* POSITION TO START OF IN     0670
*                                      STORAGE FILE                  */
         SLR   @11,@11                                             0670
         IC    @11,PGTPINDX                                        0670
         MH    @11,@CH00467                                        0670
         LA    @06,1                                               0670
         STC   @06,GTPFUNCT-28(@11)                                0670
*   CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO HMASMGTA        */
         LA    @11,HMASMGTP-28(@11)                                0671
         ST    @11,@AL00001                                        0671
         L     @15,@CV01268                                        0671
         LA    @01,@AL00001                                        0671
         BALR  @14,@15                                             0671
*   WRITSTOP=OFF;                   /* CONTINUE WITH WRITE           */
         NI    WRITSTOP,B'01111111'                                0672
*   DO WHILE(WRITRC=IOPGOOD         /* RETRIEVE AND FORMAT UNTIL EOF */
*         &WRITSTOP=OFF);           /* CONDITION RETURNED            */
         B     @DE00673                                            0673
@DL00673 DS    0H                                                  0674
*     CALL EISGETN;                 /* GET NEXT RCD          @Z67SP00*/
         BAL   @14,EISGETN                                         0674
*     RFY                           /*                       @Z67SP00*/
*       RTNCODE RSTD;               /*                       @Z67SP00*/
*     WRITRC=RTNCODE;               /* SAVE RC               @Z67SP00*/
         LR    WRITRC,RTNCODE                                      0676
*     RFY                           /*                       @Z67SP00*/
*       RTNCODE UNRSTD;             /*                       @Z67SP00*/
*     IF WRITRC=GTPGOOD             /* IF RECORD RETRIEVED           */
*       THEN                                                       0678
         CH    WRITRC,@CH00252                                     0678
         BNE   @RF00678                                            0678
*       DO;                         /* THEN DO                       */
*         MVSIZE=((ULEN&NOALIAS)*2+DIRBASE);/* CALC. ENTRY SIZE      */
         SLR   @11,@11                                             0680
         IC    @11,PGTPINDX                                        0680
         MH    @11,@CH00467                                        0680
         L     @11,GTPBUFAD-28(@11)                                0680
         LA    MVSIZE,31                                           0680
         SLR   @15,@15                                             0680
         IC    @15,ULEN(,@11)                                      0680
         NR    MVSIZE,@15                                          0680
         ALR   MVSIZE,MVSIZE                                       0680
         AH    MVSIZE,@CH00033                                     0680
*         IF MVSIZE>UNUSEDSP        /* IF NO SPACE WRITE OUT BUFFER  */
*           THEN                                                   0681
         CR    MVSIZE,UNUSEDSP                                     0681
         BNH   @RF00681                                            0681
*           DO;                     /* TO SMP DATA SET               */
*             CALL BLKWRITE;                                       0683
         BAL   @14,BLKWRITE                                        0683
*             RFY                                                  0684
*               RTNCODE RSTD;                                      0684
*             WRITRC=RTNCODE;       /* SAVE RETURN CODE              */
         LR    WRITRC,RTNCODE                                      0685
*             RFY                                                  0686
*               RTNCODE UNRSTD;                                    0686
*           END;                                                   0687
*         IF WRITRC=IOPGOOD THEN                                   0688
@RF00681 CH    WRITRC,@CH00252                                     0688
         BNE   @RF00688                                            0688
*           DO;                     /* CONTINUE IF WRITE OK          */
*             OUTMEM(1:MVSIZE)=     /* WRITE RECORD TO OUTPUT BUFFER */
*                 NTRYMAP(1:MVSIZE);                               0690
         LR    @11,MVSIZE                                          0690
         BCTR  @11,0                                               0690
         SLR   @15,@15                                             0690
         IC    @15,PGTPINDX                                        0690
         MH    @15,@CH00467                                        0690
         L     @15,GTPBUFAD-28(@15)                                0690
         EX    @11,@SM01533                                        0690
*             OUTKEY(1:8)=NTRYKEY(1:8);/* SAVE KEY OF LAST RECORD    */
         MVC   OUTKEY(8),NTRYKEY(@15)                              0691
*             UNUSEDSP=UNUSEDSP-MVSIZE;/* UPDATE UNUSED SPACE COUNT  */
         SLR   UNUSEDSP,MVSIZE                                     0692
*             FILLPTR=FILLPTR+MVSIZE;/* UPDATE PTR TO NEXT RECORD IN
*                                      OUTPUT BUFFER                 */
         ALR   FILLPTR,MVSIZE                                      0693
*           END;                    /* END OF OUTPUT BUFFER UPDATE   */
*       END;                        /* END OF RECORD RETRIEVED       */
*     ELSE                                                         0696
*       DO;                         /* IF EOF THEN DO                */
         B     @RC00678                                            0696
@RF00678 DS    0H                                                  0697
*         WRITRC=IOPGOOD;           /* RESET RC TO SUCCESSFUL        */
         SLR   WRITRC,WRITRC                                       0697
*         WRITSTOP=ON;              /* SIGNAL STOP WRITE DUE TO EOF  */
         OI    WRITSTOP,B'10000000'                                0698
*         MVSIZE=DIRBASE;           /* SET LENGTH OF RECORD          */
         LA    MVSIZE,12                                           0699
*         IF MVSIZE>UNUSEDSP        /* IF NO SPACE WRITE OUT BUFFER  */
*           THEN                                                   0700
         CR    MVSIZE,UNUSEDSP                                     0700
         BNH   @RF00700                                            0700
*           DO;                     /* TO SMP DATA SET               */
*             CALL BLKWRITE;                                       0702
         BAL   @14,BLKWRITE                                        0702
*             RFY                                                  0703
*               RTNCODE RSTD;                                      0703
*             WRITRC=RTNCODE;       /* SAVE RETURN CODE              */
         LR    WRITRC,RTNCODE                                      0704
*             RFY                                                  0705
*               RTNCODE UNRSTD;                                    0705
*           END;                                                   0706
*         IF WRITRC=IOPGOOD THEN                                   0707
@RF00700 CH    WRITRC,@CH00252                                     0707
         BNE   @RF00707                                            0707
*           DO;                     /* CONTINUE IF WRITE OK          */
*             OUTMEM(1:MVSIZE)=     /* WRITE END OF FILE RECORD TO   */
*                 EOFRCD(1:MVSIZE); /* OUTPUT BUFFER                 */
         LR    @11,MVSIZE                                          0709
         BCTR  @11,0                                               0709
         EX    @11,@SM01535                                        0709
*             OUTKEY(1:8)=EOFKEY(1:8);/* SAVE KEY OF LAST RECORD     */
         MVC   OUTKEY(8),EOFKEY                                    0710
*             UNUSEDSP=UNUSEDSP-MVSIZE;/* DECREMENT UNUSED SPACE     */
         SLR   UNUSEDSP,MVSIZE                                     0711
*             CALL BLKWRITE;        /* WRITE LAST DIRECTORY BLOCK    */
         BAL   @14,BLKWRITE                                        0712
*             RFY                                                  0713
*               RTNCODE RSTD;                                      0713
*             WRITRC=RTNCODE;       /* SAVE WRITE RETURN CODE        */
         LR    WRITRC,RTNCODE                                      0714
*             RFY                                                  0715
*               RTNCODE UNRSTD;                                    0715
*           END;                    /* END WRITE OF LAST BLOCK       */
*       END;                        /* END UPDATE OF OUTPUT BUFFER   */
@RF00707 DS    0H                                                  0718
*   END;                            /* END OF FORMAT AND WRITE       */
@RC00678 DS    0H                                                  0718
@DE00673 CH    WRITRC,@CH00252                                     0718
         BNE   @DC00673                                            0718
         TM    WRITSTOP,B'10000000'                                0718
         BZ    @DL00673                                            0718
@DC00673 DS    0H                                                  0719
*   PGTPINDX=DSGTPFRS(PDSINDX);     /* SET INDEX BACK TO FIRST GTP 0719
*                                      FOR DATASET           @Z67SP00*/
         LR    @11,PDSINDX                                         0719
         MH    @11,@CH01521                                        0719
         SLR   @08,@08                                             0719
         IC    @08,DSGTPFRS-103(@11)                               0719
         STC   @08,PGTPINDX                                        0719
*   RETURN CODE(WRITRC);                                           0720
         LR    @15,WRITRC                                          0720
         L     @14,@SA00012                                        0720
         LM    @00,@12,@SA00012+8                                  0720
         BR    @14                                                 0720
*   END EISWRITE;                                                  0721
         EJECT
*                                                                  0722
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL READ A DIRECTORY BLOCK FROM THE SMP DATA SET*/
*   /* INTO INBUFF AND WILL WRITE OUT THE DIRECTORY BLOCK FROM OUBUFF*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0722
*BLKWRITE:                                                         0722
*   PROC;                                                          0722
BLKWRITE STM   @14,@04,@SA00013                                    0722
         ST    @06,@SA00013+28                                     0722
         STM   @09,@12,@SA00013+32                                 0722
*   DECLARE                                                        0723
*     INBUFF CHAR(264);             /* BUFFER TO CONTAIN OUTPUT OF 0723
*                                      DIRECTORY READ                */
*   DECLARE                                                        0724
*     BLKIOP CHAR(LENGTH(HMASMIOP));/* IOP FOR READ AND WRITE        */
*   DECLARE                                                        0725
*     BLKPTR PTR(31) INIT(ADDR(BLKIOP));/* ADDRESS IOP USED HERE     */
*   DECLARE                                                        0726
*     BLKWRRC FIXED(8);             /* INTERNAL RETURN CODE          */
*   RFY                                                            0727
*     HMASMIOP BASED(BLKPTR);       /* USE THIS ROUTINES IOP         */
*   BLKWRRC=IOPGOOD;                /* INIT INTERNAL RETURN CODE     */
         SLR   BLKWRRC,BLKWRRC                                     0728
*   IOPDSID=DSDIR(PDSINDX);         /* SET APPROPRIATE DSID          */
         L     @11,BLKPTR                                          0729
         LR    @06,PDSINDX                                         0729
         MH    @06,@CH01521                                        0729
         SLR   @04,@04                                             0729
         IC    @04,DSDIR-103(@06)                                  0729
         STC   @04,IOPDSID(,@11)                                   0729
*   IF DIRBKCT=ZERO                 /* IF WRITE OF FIRST BLOCK THEN
*                                      CLOSE SMP DATA SET DIRECTORY  */
*     THEN                                                         0730
         LTR   DIRBKCT,DIRBKCT                                     0730
         BNZ   @RF00730                                            0730
*     DO;                                                          0731
*       IOPFUNCT=IOPCLOSE;          /* SET FUNCTION TO CLOSE         */
         MVI   IOPFUNCT(@11),X'50'                                 0732
*       CALL HMASMIO(HMASMIOP);     /* CALL HMASMIO TO DO CLOSE      */
         ST    @11,@AL00001                                        0733
         L     @15,@CV01269                                        0733
         LA    @01,@AL00001                                        0733
         BALR  @14,@15                                             0733
*       BLKWRRC=IOPRETRN;           /* SAVE RETURN CODE              */
         L     @11,BLKPTR                                          0734
         SLR   BLKWRRC,BLKWRRC                                     0734
         IC    BLKWRRC,IOPRETRN(,@11)                              0734
*     END;                                                         0735
*   IF BLKWRRC=IOPGOOD              /* IF CLOSE SUCCESSFUL           */
*     THEN                                                         0736
@RF00730 CH    BLKWRRC,@CH00252                                    0736
         BNE   @RF00736                                            0736
*     DO;                           /* THEN DO                       */
*       DIRBKCT=DIRBKCT+ONE;        /* UP COUNT OF BLOCKS WRITTEN    */
         AH    DIRBKCT,@CH00087                                    0738
*       OUTBLKSZ=LENGTH(OUTFILL)-UNUSEDSP+LENGTH(OUTBLKSZ);/* SET UP
*                                      THE LENGTH OF DIRECTORY BLOCK */
         LA    @11,254                                             0739
         LR    @06,@11                                             0739
         SLR   @06,UNUSEDSP                                        0739
         LA    @06,2(,@06)                                         0739
         STH   @06,OUTBLKSZ                                        0739
*       UNUSEDSP=LENGTH(OUTFILL);   /* RE-INIT UNUSED SPACE CT       */
         LR    UNUSEDSP,@11                                        0740
*       FILLPTR=ADDR(OUTFILL);      /* RE-INIT NEXT RECORD POSITION  */
         LA    FILLPTR,OUTFILL                                     0741
*       IOPFUNCT=IOPREAD;           /* SET FUNCTION TO READ          */
         L     @11,BLKPTR                                          0742
         MVI   IOPFUNCT(@11),X'01'                                 0742
*       IOPBUFAD=ADDR(INBUFF);      /* PASS ADDRESS OF INPUT BUFFER  */
         LA    @06,INBUFF                                          0743
         ST    @06,IOPBUFAD(,@11)                                  0743
*       CALL HMASMIO(HMASMIOP);     /* READ DIRECTORY BLOCK          */
         ST    @11,@AL00001                                        0744
         L     @15,@CV01269                                        0744
         LA    @01,@AL00001                                        0744
         BALR  @14,@15                                             0744
*       BLKWRRC=IOPRETRN;           /* SAVE RETURN CODE              */
         L     @11,BLKPTR                                          0745
         SLR   BLKWRRC,BLKWRRC                                     0745
         IC    BLKWRRC,IOPRETRN(,@11)                              0745
*       IF BLKWRRC=IOPGOOD          /* IF READ SUCCESSFUL THEN DO  0746
*                                      WRITE                         */
*         THEN                                                     0746
         CH    BLKWRRC,@CH00252                                    0746
         BNE   @RF00746                                            0746
*         DO;                                                      0747
*           IOPFUNCT=IOPWRITE;      /* SET FUNCTION TO WRITE         */
         MVI   IOPFUNCT(@11),X'51'                                 0748
*           IOPBUFAD=ADDR(OUTBUFF); /* PASS OUTPUT ADDRESS           */
         LA    @06,OUTBUFF                                         0749
         ST    @06,IOPBUFAD(,@11)                                  0749
*           CALL HMASMIO(HMASMIOP); /* WRITE DIRECTORY BLOCK         */
         ST    @11,@AL00001                                        0750
         L     @15,@CV01269                                        0750
         LA    @01,@AL00001                                        0750
         BALR  @14,@15                                             0750
*           BLKWRRC=IOPRETRN;       /* SAVE RETURN CODE              */
         L     @11,BLKPTR                                          0751
         SLR   BLKWRRC,BLKWRRC                                     0751
         IC    BLKWRRC,IOPRETRN(,@11)                              0751
*         END;                                                     0752
*       IF BLKWRRC^=IOPGOOD×        /* IF BAD READ OR WRITE          */
*           OUTKEY(1:8)=EOFKEY(1:8) /* LAST BLOCK WRITTEN            */
*         THEN                                                     0753
@RF00746 CH    BLKWRRC,@CH00252                                    0753
         BNE   @RT00753                                            0753
         CLC   OUTKEY(8),EOFKEY                                    0753
         BNE   @RF00753                                            0753
@RT00753 DS    0H                                                  0754
*         DO;                       /* THEN DO                       */
*           IOPFUNCT=IOPCLOSE;      /* SET FUNCTION TO CLOSE         */
         L     @11,BLKPTR                                          0755
         MVI   IOPFUNCT(@11),X'50'                                 0755
*           CALL HMASMIO(HMASMIOP); /* CALL IO TO DO CLOSE           */
         ST    @11,@AL00001                                        0756
         L     @15,@CV01269                                        0756
         LA    @01,@AL00001                                        0756
         BALR  @14,@15                                             0756
*           BLKWRRC=MAX(IOPRETRN,BLKWRRC);/* SAVE MAX RC             */
         L     @11,BLKPTR                                          0757
         SLR   @06,@06                                             0757
         IC    @06,IOPRETRN(,@11)                                  0757
         CR    BLKWRRC,@06                                         0757
         BNL   *+6
         LR    BLKWRRC,@06                                         0757
*         END;                                                     0758
*     END;                                                         0759
@RF00753 DS    0H                                                  0760
*   RETURN CODE(BLKWRRC);                                          0760
@RF00736 LR    @15,BLKWRRC                                         0760
         L     @14,@SA00013                                        0760
         LM    @00,@04,@SA00013+8                                  0760
         L     @06,@SA00013+28                                     0760
         LM    @09,@12,@SA00013+32                                 0760
         BR    @14                                                 0760
*   END BLKWRITE;                                                  0761
         EJECT
*                                                                  0762
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED TO PERFORM STOW CHANGE OPERATIONS BOTH */
*   /* THE SECONDARY AND PRIMARY FILES ARE USED                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0762
*EISSTOWC:                                                         0762
*   PROC;                                                          0762
EISSTOWC STM   @14,@12,@SA00014                                    0762
*   DECLARE                                                        0763
*     STOWNIOP CHAR(LENGTH(HMASMIOP)+/* IOP TO LOCATE MEMBER         */
*         LENGTH(IOPDIRMX));        /* IN IOPNNAME                   */
*   DECLARE                                                        0764
*     STOWOIOP CHAR(LENGTH(HMASMIOP)+/* IOP TO LOCATE MEMBER         */
*         LENGTH(IOPDIRMX));        /* IN IOPONAME                   */
*   DECLARE                         /*                       @Z67SP00*/
*     STOWNPTR PTR(31) INIT(ADDR(STOWNIOP));/* ADDRESS OF NEWIOP     */
*   DECLARE                         /*                       @Z67SP00*/
*     STOWOPTR PTR(31) INIT(ADDR(STOWOIOP));/* ADDRESS OF OLDIOP     */
*   DECLARE                                                        0767
*     STOWCRC FIXED(8);             /* INTERNAL RETURN CODE          */
*   DECLARE                         /*                       @Z67SP00*/
*     1 * DEF(IOPDRMAP),            /*                       @Z67SP00*/
*       3 * CHAR(8),                /* ENTRY NAME            @Z67SP00*/
*       3 DELTYP CHAR(8);           /* DELETED. IF DEL ON SECONDARY
*                                      DIS                   @Z67SP00*/
*   DECLARE                         /*                       @Z67SP00*/
*     1 * BIT(8),                   /*                       @Z67SP00*/
*       3 DFND BIT(1),              /* NEW FOUND AS DEL      @Z67SP00*/
*       3 * BIT(7);                 /*                       @Z67SP00*/
*                                                                  0769
*   /*****************************************************************/
*   /*                                                               */
*   /* ATTEMPT TO LOCATE MEMBER IN IOPONAME PASSED BY CALLER         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0770
*   RFY                                                            0770
*     HMASMIOP BASED(STOWOPTR);     /* IOPONAME OP WHERE IOPONAME    */
*   STOWCRC=GTPNTFND;               /* RCD NOT FOUND YET     @Z67SP00*/
         LA    STOWCRC,4                                           0771
*   GTPFUNCT(PGTPINDX)=GTPLOC;      /* LOCATE IOPONAME VIA CALL TO 0772
*                                      GTA                           */
         LA    @11,3                                               0772
         LA    @08,28                                              0772
         SLR   @01,@01                                             0772
         IC    @01,PGTPINDX                                        0772
         MR    @00,@08                                             0772
         STC   @11,GTPFUNCT-28(@01)                                0772
*   GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* ADDRESS OF OUTPUT BUFFER    */
         L     @05,STOWOPTR                                        0773
         LA    @00,IOPDRMAP(,@05)                                  0773
         ST    @00,GTPBUFAD-28(@01)                                0773
*   IOPINAM=IOPPTR->IOPONAME;       /* LOCATE RECORD WITH KEY IN   0774
*                                      IOPONAME                      */
         MVC   IOPINAM(8,@05),IOPONAME(IOPPTR)                     0774
*   IF CCACHECK=ON                  /* IF IN CHECK MODE LOOK @Z67SP00*/
*     THEN                          /* AT SECONDARY DIS      @Z67SP00*/
         L     @15,@CA00037                                        0775
         TM    CCACHECK-HMASMCCA(@15),B'00010000'                  0775
         BNO   @RF00775                                            0775
*     DO;                           /*                       @Z67SP00*/
*       GTPFUNCT(SGTPINDX)=GTPLOC;  /*                       @Z67SP00*/
         LR    @01,@08                                             0777
         SLR   @08,@08                                             0777
         IC    @08,SGTPINDX                                        0777
         MR    @00,@08                                             0777
         STC   @11,GTPFUNCT-28(@01)                                0777
*       GTPBUFAD(SGTPINDX)=ADDR(IOPDRMAP);/*                 @Z67SP00*/
         LA    @11,IOPDRMAP(,@05)                                  0778
         ST    @11,GTPBUFAD-28(@01)                                0778
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/*                 @Z67SP00*/
         LA    @11,HMASMGTP-28(@01)                                0779
         ST    @11,@AL00001                                        0779
         L     @15,@CV01268                                        0779
         LA    @01,@AL00001                                        0779
         BALR  @14,@15                                             0779
*       IF GTPRETRN(SGTPINDX)=GTPGOOD/* IF FOUND             @Z67SP00*/
*           &DELTYP=TXTDEL          /* AS DELETED THEN       @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         SLR   @11,@11                                             0780
         IC    @11,SGTPINDX                                        0780
         MH    @11,@CH00467                                        0780
         SLR   @08,@08                                             0780
         IC    @08,GTPRETRN-28(@11)                                0780
         CH    @08,@CH00252                                        0780
         BNE   @RF00780                                            0780
         L     @11,STOWOPTR                                        0780
         CLC   DELTYP(8,@11),@CC01281                              0780
         BNE   @RF00780                                            0780
*         STOWCRC=IOPSTCRR;         /* ERROR                 @Z67SP00*/
         LA    STOWCRC,8                                           0781
*       ELSE                        /*                       @Z67SP00*/
*         STOWCRC=MAX(STOWCRC,GTPRETRN(SGTPINDX));/* SAVE RC @Z67SP00*/
         B     @RC00780                                            0782
@RF00780 SLR   @11,@11                                             0782
         IC    @11,SGTPINDX                                        0782
         MH    @11,@CH00467                                        0782
         SLR   @08,@08                                             0782
         IC    @08,GTPRETRN-28(@11)                                0782
         CR    STOWCRC,@08                                         0782
         BNL   *+6
         LR    STOWCRC,@08                                         0782
*     END;                          /*                       @Z67SP00*/
@RC00780 DS    0H                                                  0784
*   IF STOWCRC=GTPNTFND             /* IF RCD NOT FOUND IN SECONDARY
*                                      OR SECONDARY NOT      @Z67SP00*/
*     THEN                          /* SEARCHED              @Z67SP00*/
@RF00775 CH    STOWCRC,@CH00039                                    0784
         BNE   @RF00784                                            0784
*     DO;                           /*                       @Z67SP00*/
*       GTPFUNCT(PGTPINDX)=GTPLOC;  /*                       @Z67SP00*/
         SLR   @11,@11                                             0786
         IC    @11,PGTPINDX                                        0786
         MH    @11,@CH00467                                        0786
         LA    @08,3                                               0786
         STC   @08,GTPFUNCT-28(@11)                                0786
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO HMASMGTA    */
         LA    @11,HMASMGTP-28(@11)                                0787
         ST    @11,@AL00001                                        0787
         L     @15,@CV01268                                        0787
         LA    @01,@AL00001                                        0787
         BALR  @14,@15                                             0787
*       IF GTPRETRN(PGTPINDX)=GTPGOOD/* IF FOUND THEN        @Z67SP00*/
*         THEN                      /* CHANGE RC TO INDICATE @Z67SP00*/
         SLR   @11,@11                                             0788
         IC    @11,PGTPINDX                                        0788
         MH    @11,@CH00467                                        0788
         SLR   @08,@08                                             0788
         IC    @08,GTPRETRN-28(@11)                                0788
         CH    @08,@CH00252                                        0788
         BNE   @RF00788                                            0788
*         STOWCRC=GTPGOOD;          /* ENTRY FOUND           @Z67SP00*/
         SLR   STOWCRC,STOWCRC                                     0789
*       ELSE                        /*                       @Z67SP00*/
*         STOWCRC=IOPSTCRR;         /* STOW CHANGE ERR       @Z67SP00*/
         B     @RC00788                                            0790
@RF00788 LA    STOWCRC,8                                           0790
*     END;                          /*                       @Z67SP00*/
*                                                                  0791
@RC00788 DS    0H                                                  0792
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OLD ENTRY FOUND IN PROPER DATASET THEN SEE IF NEW NAME     */
*   /* ALREADY THERE                                         @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0792
*   IF STOWCRC=GTPGOOD              /* IF MEMBER FOUND       @Z67SP00*/
*     THEN                          /* THEN CONTINUE         @Z67SP00*/
@RF00784 CH    STOWCRC,@CH00252                                    0792
         BNE   @RF00792                                            0792
*     DO;                           /*                       @Z67SP00*/
*       RFY                                                        0794
*         HMASMIOP BASED(STOWNPTR); /* IOP TO RETRIEVE IOPNNAME KEY  */
*       IOPINAM=IOPPTR->IOPNNAME;   /* LOCATE RECORD WITH KEY IN   0795
*                                      IOPNNAME                      */
         L     @11,STOWNPTR                                        0795
         MVC   IOPINAM(8,@11),IOPNNAME(IOPPTR)                     0795
*       STOWCRC=GTPNTFND;           /* NEW NAME NOT FOUND    @Z67SP00*/
         LA    STOWCRC,4                                           0796
*       DFND=OFF;                   /* NOT FOUND AS DELETED  @Z67SP00*/
         NI    DFND,B'01111111'                                    0797
*       IF CCACHECK=ON              /* IF IN CHECK MODE      @Z67SP00*/
*         THEN                      /* THEN SEARCH SECONDARY @Z67SP00*/
         L     @08,@CA00037                                        0798
         TM    CCACHECK-HMASMCCA(@08),B'00010000'                  0798
         BNO   @RF00798                                            0798
*         DO;                       /* DIS                   @Z67SP00*/
*           GTPBUFAD(SGTPINDX)=ADDR(IOPDRMAP);/*             @Z67SP00*/
         SLR   @08,@08                                             0800
         IC    @08,SGTPINDX                                        0800
         MH    @08,@CH00467                                        0800
         LA    @11,IOPDRMAP(,@11)                                  0800
         ST    @11,GTPBUFAD-28(@08)                                0800
*           CALL HMASMGTA(HMASMGTP(SGTPINDX));/* LOC NEW     @Z67SP00*/
         LA    @11,HMASMGTP-28(@08)                                0801
         ST    @11,@AL00001                                        0801
         L     @15,@CV01268                                        0801
         LA    @01,@AL00001                                        0801
         BALR  @14,@15                                             0801
*           IF GTPRETRN(SGTPINDX)=GTPGOOD/* IF FOUND THEN    @Z67SP00*/
*             THEN                  /* CHECK FOR DELETED     @Z67SP00*/
         SLR   @11,@11                                             0802
         IC    @11,SGTPINDX                                        0802
         MH    @11,@CH00467                                        0802
         SLR   @08,@08                                             0802
         IC    @08,GTPRETRN-28(@11)                                0802
         CH    @08,@CH00252                                        0802
         BNE   @RF00802                                            0802
*             DO;                   /*                       @Z67SP00*/
*               IF DELTYP^=TXTDEL   /* IF NOT DELETED        @Z67SP00*/
*                 THEN              /*                       @Z67SP00*/
         L     @11,STOWNPTR                                        0804
         CLC   DELTYP(8,@11),@CC01281                              0804
         BE    @RF00804                                            0804
*                 STOWCRC=IOPSTCRR; /* SET BAD RC            @Z67SP00*/
         LA    STOWCRC,8                                           0805
*               ELSE                /* FOUND AS DELETED      @Z67SP00*/
*                 DFND=ON;          /* IN SECONDARY          @Z67SP00*/
         B     @RC00804                                            0806
@RF00804 OI    DFND,B'10000000'                                    0806
*             END;                  /*                       @Z67SP00*/
@RC00804 DS    0H                                                  0808
*         END;                      /*                       @Z67SP00*/
@RF00802 DS    0H                                                  0809
*       IF STOWCRC^=IOPSTCRR        /* IF NOT ERR YET        @Z67SP00*/
*           &DFND=OFF               /* OR FOUND AS DELETED TYPE IN 0809
*                                      SECONDARY             @Z67SP00*/
*         THEN                      /* THEN CHECK IN         @Z67SP00*/
@RF00798 CH    STOWCRC,@CH00112                                    0809
         BE    @RF00809                                            0809
         TM    DFND,B'10000000'                                    0809
         BNZ   @RF00809                                            0809
*         DO;                       /* PRIMRARY              @Z67SP00*/
*           GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/*             @Z67SP00*/
         SLR   @11,@11                                             0811
         IC    @11,PGTPINDX                                        0811
         MH    @11,@CH00467                                        0811
         L     @08,STOWNPTR                                        0811
         LA    @08,IOPDRMAP(,@08)                                  0811
         ST    @08,GTPBUFAD-28(@11)                                0811
*           CALL HMASMGTA(HMASMGTP(PGTPINDX));/* LOC IN PRIM @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0812
         ST    @11,@AL00001                                        0812
         L     @15,@CV01268                                        0812
         LA    @01,@AL00001                                        0812
         BALR  @14,@15                                             0812
*           IF GTPRETRN(PGTPINDX)=GTPGOOD/* IF FOUND         @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         SLR   @11,@11                                             0813
         IC    @11,PGTPINDX                                        0813
         MH    @11,@CH00467                                        0813
         SLR   @08,@08                                             0813
         IC    @08,GTPRETRN-28(@11)                                0813
         CH    @08,@CH00252                                        0813
         BNE   @RF00813                                            0813
*             STOWCRC=IOPSTCRR;     /* ERROR                 @Z67SP00*/
         LA    STOWCRC,8                                           0814
*         END;                      /*                       @Z67SP00*/
@RF00813 DS    0H                                                  0816
*       IF STOWCRC=GTPNTFND         /* IF NEW NOT FOUND      @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
@RF00809 CH    STOWCRC,@CH00039                                    0816
         BNE   @RF00816                                            0816
*         DO;                       /*                       @Z67SP00*/
*                                                                  0817
*           /*********************************************************/
*           /*                                                       */
*           /* DELETE MEMBER FROM EITHER PRIMARY OR ADD DELETED TYPE */
*           /* MEMBER TO SECONDARY                           @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0818
*           RFY                                                    0818
*             HMASMIOP BASED(STOWOPTR);/* ADDRESS IOP WITH OLD KEY   */
*           IF CCACHECK=OFF         /* IF NOT IN CHECK       @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         L     @11,@CA00037                                        0819
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0819
         BNZ   @RF00819                                            0819
*             DO;                   /*                       @Z67SP00*/
*               GTPFUNCT(PGTPINDX)=GTPDEL;/* DELETE CURRENT RECORD 0821
*                                      WITH OLD KEY FROM DIS         */
         SLR   @11,@11                                             0821
         IC    @11,PGTPINDX                                        0821
         MH    @11,@CH00467                                        0821
         LA    @08,5                                               0821
         STC   @08,GTPFUNCT-28(@11)                                0821
*               GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* POINT TO RECORD
*                                      TO BE ADDED                   */
         L     @08,STOWOPTR                                        0822
         LA    @08,IOPDRMAP(,@08)                                  0822
         ST    @08,GTPBUFAD-28(@11)                                0822
*               CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO GTA */
         LA    @11,HMASMGTP-28(@11)                                0823
         ST    @11,@AL00001                                        0823
         L     @15,@CV01268                                        0823
         LA    @01,@AL00001                                        0823
         BALR  @14,@15                                             0823
*               STOWCRC=GTPRETRN(PGTPINDX);/* SAVE RETURN CD @Z67SP00*/
         SLR   @11,@11                                             0824
         IC    @11,PGTPINDX                                        0824
         MH    @11,@CH00467                                        0824
         SLR   STOWCRC,STOWCRC                                     0824
         IC    STOWCRC,GTPRETRN-28(@11)                            0824
*             END;                  /*                       @Z67SP00*/
*           ELSE                    /*                       @Z67SP00*/
*             DO;                   /*                       @Z67SP00*/
         B     @RC00819                                            0826
@RF00819 DS    0H                                                  0827
*               GTPFUNCT(SGTPINDX)=GTPADD;/* ADD DELETED     @Z67SP00*/
         SLR   @11,@11                                             0827
         IC    @11,SGTPINDX                                        0827
         MH    @11,@CH00467                                        0827
         LA    @08,4                                               0827
         STC   @08,GTPFUNCT-28(@11)                                0827
*               DELTYP=TXTDEL;      /* RCD TO SECONDARY      @Z67SP00*/
         L     @08,STOWOPTR                                        0828
         MVC   DELTYP(8,@08),@CC01281                              0828
*               GTPBUFAD(SGTPINDX)=ADDR(IOPDRMAP);/* POINT TO RECORD
*                                      TO BE ADDED                   */
         LA    @08,IOPDRMAP(,@08)                                  0829
         ST    @08,GTPBUFAD-28(@11)                                0829
*               CALL HMASMGTA(HMASMGTP(SGTPINDX));/* VIA CALL TO GTA */
         LA    @11,HMASMGTP-28(@11)                                0830
         ST    @11,@AL00001                                        0830
         L     @15,@CV01268                                        0830
         LA    @01,@AL00001                                        0830
         BALR  @14,@15                                             0830
*               STOWCRC=GTPRETRN(SGTPINDX);/* SAVE RETURN CD @Z67SP00*/
         SLR   @11,@11                                             0831
         IC    @11,SGTPINDX                                        0831
         MH    @11,@CH00467                                        0831
         SLR   STOWCRC,STOWCRC                                     0831
         IC    STOWCRC,GTPRETRN-28(@11)                            0831
*             END;                  /*                       @Z67SP00*/
*                                                                  0832
*           /*********************************************************/
*           /*                                                       */
*           /* ADD NEW NAME TO EITHER PRIME OR SECOND DIS    @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0833
*           IF STOWCRC=GTPGOOD      /* IF STOW ADD/DEL OK    @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
@RC00819 CH    STOWCRC,@CH00252                                    0833
         BNE   @RF00833                                            0833
*             DO;                   /*                       @Z67SP00*/
*               IOPINAM=IOPPTR->IOPNNAME;/* REPLACE WITH NEW KEY     */
         L     @11,STOWOPTR                                        0835
         MVC   IOPINAM(8,@11),IOPNNAME(IOPPTR)                     0835
*               IF CCACHECK=OFF     /* IF NOT IN CHECK       @Z67SP00*/
*                 THEN              /*                       @Z67SP00*/
         L     @11,@CA00037                                        0836
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0836
         BNZ   @RF00836                                            0836
*                 DO;               /*                       @Z67SP00*/
*                   GTPFUNCT(PGTPINDX)=GTPADD;/* AND ADD TO IN     0838
*                                      STORAGE FILE          @Z67SP00*/
         SLR   @11,@11                                             0838
         IC    @11,PGTPINDX                                        0838
         MH    @11,@CH00467                                        0838
         LA    @08,4                                               0838
         STC   @08,GTPFUNCT-28(@11)                                0838
*                   CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO
*                                      HMASMGTA              @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0839
         ST    @11,@AL00001                                        0839
         L     @15,@CV01268                                        0839
         LA    @01,@AL00001                                        0839
         BALR  @14,@15                                             0839
*                   STOWCRC=GTPRETRN(PGTPINDX);/* SAVE RETURN CODE 0840
*                                      FROM STOW ADD         @Z67SP00*/
         SLR   @11,@11                                             0840
         IC    @11,PGTPINDX                                        0840
         MH    @11,@CH00467                                        0840
         SLR   STOWCRC,STOWCRC                                     0840
         IC    STOWCRC,GTPRETRN-28(@11)                            0840
*                 END;              /*                       @Z67SP00*/
*               ELSE                /* IF CHECK              @Z67SP00*/
*                 DO;               /*                       @Z67SP00*/
         B     @RC00836                                            0842
@RF00836 DS    0H                                                  0843
*                   GTPFUNCT(SGTPINDX)=GTPADD;/* AND ADD TO IN     0843
*                                      STORAGE FILE          @Z67SP00*/
         SLR   @11,@11                                             0843
         IC    @11,SGTPINDX                                        0843
         MH    @11,@CH00467                                        0843
         LA    @08,4                                               0843
         STC   @08,GTPFUNCT-28(@11)                                0843
*                   CALL HMASMGTA(HMASMGTP(SGTPINDX));/* VIA CALL TO
*                                      HMASMGTA              @Z67SP00*/
         LA    @11,HMASMGTP-28(@11)                                0844
         ST    @11,@AL00001                                        0844
         L     @15,@CV01268                                        0844
         LA    @01,@AL00001                                        0844
         BALR  @14,@15                                             0844
*                   STOWCRC=GTPRETRN(SGTPINDX);/* SAVE RETURN CODE 0845
*                                      FROM STOW ADD         @Z67SP00*/
         SLR   @11,@11                                             0845
         IC    @11,SGTPINDX                                        0845
         MH    @11,@CH00467                                        0845
         SLR   STOWCRC,STOWCRC                                     0845
         IC    STOWCRC,GTPRETRN-28(@11)                            0845
*                 END;              /*                       @Z67SP00*/
*             END;                  /*                       @Z67SP00*/
@RC00836 DS    0H                                                  0848
*           IF STOWCRC^=GTPGOOD     /* IF NO SPACE THEN DO           */
*             THEN                                                 0848
@RF00833 CH    STOWCRC,@CH00252                                    0848
         BE    @RF00848                                            0848
*             DO;                   /*                       @Z67SP00*/
*               CALL EISSPMSG;      /* ISSUE OUT OF SPCE MSG @Z67SP00*/
         BAL   @14,EISSPMSG                                        0850
*               RFY                                                0851
*                 RTNCODE RSTD;     /*                               */
*               STOWCRC=RTNCODE;    /*                               */
         LR    STOWCRC,RTNCODE                                     0852
*               RFY                                                0853
*                 RTNCODE UNRSTD;   /*                               */
*             END;                                                 0854
*         END;                                                     0855
@RF00848 DS    0H                                                  0856
*     END;                                                         0856
@RF00816 DS    0H                                                  0857
*   IF STOWCRC=ZERO                 /* IF STOWC DONE         @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00792 CH    STOWCRC,@CH00252                                    0857
         BNE   @RF00857                                            0857
*     CCAFLAG6=CCAFLAG6×DSMSKON(PDSINDX);/* TURN ON DIS UPDATED    0858
*                                      INDICATOR             @Z67SP00*/
         L     @11,@CA00037                                        0858
         LR    @08,PDSINDX                                         0858
         MH    @08,@CH01521                                        0858
         LA    @05,DSMSKON-103(@08)                                0858
         OC    CCAFLAG6-HMASMCCA(1,@11),0(@05)                     0858
*   RETURN CODE(STOWCRC);                                          0859
@RF00857 LR    @15,STOWCRC                                         0859
         L     @14,@SA00014                                        0859
         LM    @00,@12,@SA00014+8                                  0859
         BR    @14                                                 0859
*   END EISSTOWC;                                                  0860
         EJECT
*                                                                  0861
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED WHEN ADD TO DIS FILE RESULTS IN OUT OF SPACE   */
*   /* CONDITION                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0861
*EISSPMSG:                          /*                               */
*   PROCEDURE;                      /*                               */
EISSPMSG STM   @14,@12,@SA00015                                    0861
*   DECLARE                         /*                               */
*     MSGRC FIXED(8);               /*                               */
*   RFY                                                            0863
*     HMASMIOP BASED(IOPPTR);       /*                       @Z67SP00*/
*   HMASMMGP=''B;                   /* CLEAR MESSAGE PARMS   @Z67SP00*/
         XC    HMASMMGP(24),HMASMMGP                               0864
*   MGPPRINT=ON;                    /* MESSAGES TO SYSOUT    @Z67SP00*/
*   MGPHLDS=ON;                     /* MESSAGES TO LOG       @Z67SP00*/
*                                                                  0866
         OI    MGPPRINT,B'10010000'                                0866
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DATASET IN STORAGE FOR OUTPUT OR IF IN CHECK MODE THEN     */
*   /* CANNOT CONTINUE, ELSE JUST WARNING MSG                @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0867
*   IF CCACHECK=ON                  /* IN CHECK MODE         @Z67SP00*/
*       ×IOPDSID=IOPCDS&CCACDSOS=ON /*                       @Z67SP00*/
*       ×IOPDSID=IOPACDS&CCAACDOS=ON/*                       @Z67SP00*/
*       ×IOPDSID=IOPCRQ&CCACRQOS=ON /*                       @Z67SP00*/
*       ×IOPDSID=IOPACRQ&CCAACROS=ON/*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @11,@CA00037                                        0867
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0867
         BO    @RT00867                                            0867
         CLI   IOPDSID(IOPPTR),2                                   0867
         BNE   @GL00026                                            0867
         TM    CCACDSOS-HMASMCCA(@11),B'10000000'                  0867
         BO    @RT00867                                            0867
@GL00026 CLI   IOPDSID(IOPPTR),12                                  0867
         BNE   @GL00025                                            0867
         L     @11,@CA00037                                        0867
         TM    CCAACDOS-HMASMCCA(@11),B'01000000'                  0867
         BO    @RT00867                                            0867
@GL00025 CLI   IOPDSID(IOPPTR),28                                  0867
         BNE   @GL00024                                            0867
         L     @11,@CA00037                                        0867
         TM    CCACRQOS-HMASMCCA(@11),B'00100000'                  0867
         BO    @RT00867                                            0867
@GL00024 CLI   IOPDSID(IOPPTR),30                                  0867
         BNE   @RF00867                                            0867
         L     @11,@CA00037                                        0867
         TM    CCAACROS-HMASMCCA(@11),B'00010000'                  0867
         BNO   @RF00867                                            0867
@RT00867 DS    0H                                                  0868
*     DO;                           /*                               */
*       MGPTYPE=MGPSEV;             /* SEVER ERROR                   */
         MVI   MGPTYPE,X'04'                                       0869
*       MSGRC=STOPFUNC;             /* STOP FUNCTION         @Z67SP00*/
         LA    MSGRC,12                                            0870
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /*                       @Z67SP00*/
*     DO;                           /*                       @Z67SP00*/
         B     @RC00867                                            0872
@RF00867 DS    0H                                                  0873
*       MGPTYPE=MGPINFO;            /*                       @Z67SP00*/
         MVI   MGPTYPE,X'01'                                       0873
*       MSGRC=ZERO;                 /*                       @Z67SP00*/
         SLR   MSGRC,MSGRC                                         0874
*     END;                          /*                       @Z67SP00*/
*   MGPCLEAR=''B;                   /*                       @Z67SP00*/
@RC00867 XC    MGPCLEAR(6),MGPCLEAR                                0876
*   MGPMGNO1=HMA305I;               /* INSUFFICIENT STORAGE FOR    0877
*                                      XXXXXXXX IN STORAGE STOW/BLDL
*                                      OPERATIONS            @Z67SP00*/
         MVC   MGPMGNO1(2),@CH01285                                0877
*   MGPVARPT(1)=ADDR(DSDDNAME(SDSINDX));/* INSERT DD                 */
         SLR   @11,@11                                             0878
         IC    @11,SDSINDX                                         0878
         MH    @11,@CH01521                                        0878
         LA    @11,DSDDNAME-103(@11)                               0878
         ST    @11,MGPVARPT                                        0878
*   CALL HMASMMSG(HMASMMGP);        /*                               */
         L     @15,@CV01270                                        0879
         LA    @01,@AL00879                                        0879
         BALR  @14,@15                                             0879
*   IF MSGRC=ZERO                   /* IF ONLY INFO MSG      @Z67SP00*/
*     THEN                          /* THEN CAN NOW FREE     @Z67SP00*/
         CH    MSGRC,@CH00252                                      0880
         BNE   @RF00880                                            0880
*     DO;                           /* DIR. IF STOPFUNC THEN @Z67SP00*/
*       CALL EISFREE;               /* CANT FREE DIR UNTIL   @Z67SP00*/
         BAL   @14,EISFREE                                         0882
*       RFY                         /* DIRECTORY             @Z67SP00*/
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       MSGRC=MAX(MSGRC,RTNCODE);   /* AFTER CALL FOR WRITE  @Z67SP00*/
         CR    MSGRC,RTNCODE                                       0884
         BNL   *+6
         LR    MSGRC,RTNCODE                                       0884
*       RFY                         /* DIRECTORY             @Z67SP00*/
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
*   RETURN CODE(MSGRC);             /*                               */
@RF00880 LR    @15,MSGRC                                           0887
         L     @14,@SA00015                                        0887
         LM    @00,@12,@SA00015+8                                  0887
         BR    @14                                                 0887
*   END EISSPMSG;                   /*                               */
*   END HMASMEIS                                                   0889
*                                                                  0889
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*                                                                  0889
*       ;                                                          0889
@DATA    DS    0H
@CH00252 DC    H'0'
@CH00087 DC    H'1'
@CH00039 DC    H'4'
@CH00112 DC    H'8'
@CH00436 DC    H'11'
@CH00033 DC    H'12'
@CH00188 DC    H'16'
@CH00467 DC    H'28'
@CH00042 DC    H'31'
@CH01031 DC    H'68'
@CH00518 DC    H'83'
@CH01521 DC    H'103'
@CH01285 DC    H'106'
@SM01524 MVC   0(0,@05),@TS00001
@SM01526 MVC   IOPDRMAP(0,IOPPTR),0(@05)
@SM01531 MVC   0(0,@08),@TS00001
@SM01533 MVC   OUTMEM(0,FILLPTR),NTRYMAP(@15)
@SM01535 MVC   OUTMEM(0,FILLPTR),EOFRCD
         DS    0F
@AL00551 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00616 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00879 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    15F
@SA00008 DS    15F
@SA00009 DS    15F
@SA00014 DS    15F
@SA00010 DS    15F
@SA00015 DS    15F
@SA00011 DS    14F
@SA00012 DS    15F
@SA00013 DS    0F
@SA00007 DS    0F
@SA00006 DS    0F
@SA00005 DS    0F
@SA00004 DS    0F
         DS    15F
@AL00001 DS    1A
         DS    0F
@CF01530 DC    F'-8'
@CA00037 DC    A(HMASMCCA)
@CV01268 DC    V(HMASMGTA)
@CV01269 DC    V(HMASMIO)
@CV01270 DC    V(HMASMMSG)
         DS    0D
WRDIRPTR DC    AL4(WRDIRIOP)
BLKPTR   DC    AL4(BLKIOP)
STOWNPTR DC    AL4(STOWNIOP)
STOWOPTR DC    AL4(STOWOIOP)
FNCINDX  DS    FL1
PGTPINDX DS    FL1
SGTPINDX DS    FL1
SDSINDX  DS    FL1
         DS    0D
@TS00001 DS    CL12
@CC01281 DC    C'DELETED.'
HMASMMGP DS    CL24
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00171 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00172 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL12
         ORG   MGPVAR
MGPVARPT DS    3A
         ORG   HMASMMGP+24
TYPGTPTB DS    CL136
         ORG   TYPGTPTB
ASM      DC    AL1(1)
         DC    AL1(8)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(0)
         DC    AL1(0)
LMD      DC    AL1(2)
         DC    AL1(9)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(0)
         DC    AL1(0)
MAC      DC    AL1(3)
         DC    AL1(10)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(0)
         DC    AL1(0)
MCU      DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
MOD      DC    AL1(4)
         DC    AL1(11)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(0)
         DC    AL1(0)
DLB      DC    AL1(6)
         DC    AL1(12)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(0)
         DC    AL1(0)
SYS      DC    AL1(1)
         DC    AL1(8)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(0)
         DC    AL1(0)
SRC      DC    AL1(5)
         DC    AL1(12)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(0)
         DC    AL1(0)
SCU      DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
DND      DC    AL1(7)
         DC    AL1(14)
         DC    AL1(15)
         DC    AL1(16)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(19)
         DC    AL1(20)
SMD      DC    AL1(7)
         DC    AL1(14)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(0)
         DC    AL1(0)
ZAP      DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
XZP      DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
FMD      DC    AL1(0)
         DC    AL1(0)
         DC    AL1(15)
         DC    AL1(16)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(19)
         DC    AL1(20)
CSR      DC    AL1(0)
         DC    AL1(0)
         DC    AL1(15)
         DC    AL1(16)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(19)
         DC    AL1(20)
MCS      DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
MEM      DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
         ORG   TYPGTPTB+136
PATCHEIS DS    CL80
         ORG   PATCHEIS
@NM00178 DC    80X'FF'
         ORG   PATCHEIS+80
EISSW1   DS    BL1
         ORG   EISSW1
VALDSNSW DS    BL1
VALFNCSW EQU   EISSW1+0
LOADOKSW EQU   EISSW1+0
FNDSW    EQU   EISSW1+0
@NM00179 EQU   EISSW1+0
         ORG   EISSW1+1
         DS    CL3
OUTBUFF  DS    CL264
         ORG   OUTBUFF
OUTKEY   DS    CL8
OUTDATA  DS    CL256
         ORG   OUTDATA
OUTBLKSZ DS    FL2
OUTFILL  DS    CL254
         ORG   OUTBUFF+264
EOFRCD   DS    CL12
         ORG   EOFRCD
EOFKEY   DC    X'FFFFFFFFFFFFFFFF'
EOFTTR   DC    4X'00'
         ORG   EOFRCD+12
WRDIRIOP DS    CL130
INITIOP  DS    CL130
GETNSW   DS    BL1
         ORG   GETNSW
PREAD    DS    BL1
SREAD    EQU   GETNSW+0
DEL      EQU   GETNSW+0
STOP     EQU   GETNSW+0
STOP2    EQU   GETNSW+0
@NM00182 EQU   GETNSW+0
         ORG   GETNSW+1
         DS    CL7
DECALLOC DS    CL5
         DS    CL3
DECREQD  DS    CL5
PRTALLOC DS    CL5
PRTREQD  DS    CL5
WRITSW   DS    BL1
         ORG   WRITSW
WRITSTOP DS    BL1
@NM00183 EQU   WRITSW+0
         ORG   WRITSW+1
INBUFF   DS    CL264
BLKIOP   DS    CL68
STOWNIOP DS    CL130
STOWOIOP DS    CL130
@NM00186 DS    BL1
         ORG   @NM00186
DFND     DS    BL1
@NM00187 EQU   @NM00186+0
         ORG   @NM00186+1
         DS    CL3
HMASMGTP DS    CL28
         ORG   HMASMGTP+0
GTPFUNCT DS    FL1
GTPRETRN DS    FL1
@NM00173 DS    CL2
GTPRCDLN DS    FL2
GTPKEYLN DS    FL2
GTPWKAD  DS    AL4
GTPBUFAD DS    AL4
GTPRESTR DS    CL10
         ORG   GTPRESTR+0
GTPPAG   DS    AL4
GTPRCD   DS    AL4
GTPPOS   DS    FL2
         ORG   HMASMGTP+26
GTPFLGS1 DS    BL1
         ORG   GTPFLGS1+0
GTPNOSPM DS    BL1
GTPRCDNF EQU   GTPFLGS1+0
@NM00174 EQU   GTPFLGS1+0
GTPPSIZE EQU   GTPFLGS1+0
         ORG   HMASMGTP+27
@NM00175 DS    FL1
         ORG   HMASMGTP+560
DSARRAY  DS    CL103
         ORG   DSARRAY+0
DSMAIN   DC    AL1(2)
DSDIR    DC    AL1(8)
DSDIRLN  DC    AL1(36)
DSMSKON  DC    B'10000000'
DSMSKOFF DC    B'01111111'
DSGTPFRS DC    AL1(1)
DSGTPLST DC    AL1(7)
DSGTPGN  DC    AL1(1)
DSFLAGS1 DC    AL1(0)
         ORG   DSFLAGS1+0
PEOF     DS    BL1
SEOF     EQU   DSFLAGS1+0
@NM00176 EQU   DSFLAGS1+0
         ORG   DSARRAY+9
DSBLKCT  DC    FL4'0'
DSMEMMAX DC    FL4'0'
DSMEMUSE DC    FL4'1'
DSDDNAME DC    CL8'SMPCDS  '
DSBUFFR  DC    CL74' '
         ORG   DSBUFFR+0
DSBFNAME DS    CL8
DSBFDEL  DS    CL8
         ORG   DSARRAY+103
         ORG   DSARRAY+103
         DC    AL1(12)
         DC    AL1(13)
         DC    AL1(36)
         DC    B'01000000'
         DC    B'10111111'
         DC    AL1(8)
         DC    AL1(14)
         DC    AL1(8)
         DC    AL1(0)
         DC    FL4'0'
         DC    FL4'0'
         DC    FL4'1'
         DC    CL8'SMPACDS '
         DC    CL74' '
         ORG   DSARRAY+206
         ORG   DSARRAY+206
         DC    AL1(28)
         DC    AL1(29)
         DC    AL1(14)
         DC    B'00100000'
         DC    B'11011111'
         DC    AL1(15)
         DC    AL1(15)
         DC    AL1(15)
         DC    AL1(0)
         DC    FL4'0'
         DC    FL4'0'
         DC    FL4'1'
         DC    CL8'SMPCRQ  '
         DC    CL74' '
         ORG   DSARRAY+309
         ORG   DSARRAY+309
         DC    AL1(30)
         DC    AL1(31)
         DC    AL1(14)
         DC    B'00010000'
         DC    B'11101111'
         DC    AL1(16)
         DC    AL1(16)
         DC    AL1(16)
         DC    AL1(0)
         DC    FL4'0'
         DC    FL4'0'
         DC    FL4'1'
         DC    CL8'SMPACRQ '
         DC    CL74' '
         ORG   DSARRAY+412
         ORG   DSARRAY+412
         DC    AL1(2)
         DC    AL1(8)
         DC    AL1(36)
         DC    B'00000000'
         DC    B'11111111'
         DC    AL1(17)
         DC    AL1(17)
         DC    AL1(17)
         DC    AL1(0)
         DC    FL4'0'
         DC    FL4'0'
         DC    FL4'1'
         DC    CL8'SMPCDS  '
         DC    CL74' '
         ORG   DSARRAY+515
         ORG   DSARRAY+515
         DC    AL1(12)
         DC    AL1(13)
         DC    AL1(36)
         DC    B'00000000'
         DC    B'11111111'
         DC    AL1(18)
         DC    AL1(18)
         DC    AL1(18)
         DC    AL1(0)
         DC    FL4'0'
         DC    FL4'0'
         DC    FL4'1'
         DC    CL8'SMPACDS '
         DC    CL74' '
         ORG   DSARRAY+618
         ORG   DSARRAY+618
         DC    AL1(28)
         DC    AL1(29)
         DC    AL1(14)
         DC    B'00000000'
         DC    B'11111111'
         DC    AL1(19)
         DC    AL1(19)
         DC    AL1(19)
         DC    AL1(0)
         DC    FL4'0'
         DC    FL4'0'
         DC    FL4'1'
         DC    CL8'SMPCRQ  '
         DC    CL74' '
         ORG   DSARRAY+721
         ORG   DSARRAY+721
         DC    AL1(30)
         DC    AL1(31)
         DC    AL1(14)
         DC    B'00000000'
         DC    B'11111111'
         DC    AL1(20)
         DC    AL1(20)
         DC    AL1(20)
         DC    AL1(0)
         DC    FL4'0'
         DC    FL4'0'
         DC    FL4'1'
         DC    CL8'SMPACRQ '
         DC    CL74' '
         ORG   DSARRAY+824
DSFIRST  DC    20AL1(0)
FNCARRAY DS    CL8
         ORG   FNCARRAY+0
FNCIOPCD DC    AL1(8)
@NM00177 DS    CL3
FNCADDR  DC    AL4(EISINIT)
         ORG   FNCARRAY+8
         ORG   FNCARRAY+8
         DC    AL1(9)
         DS    CL3
         DC    AL4(EISFREE)
         ORG   FNCARRAY+16
         ORG   FNCARRAY+16
         DC    AL1(3)
         DS    CL3
         DC    AL4(EISLOC)
         ORG   FNCARRAY+24
         ORG   FNCARRAY+24
         DC    AL1(4)
         DS    CL3
         DC    AL4(EISBLDL)
         ORG   FNCARRAY+32
         ORG   FNCARRAY+32
         DC    AL1(10)
         DS    CL3
         DC    AL4(EISGETN)
         ORG   FNCARRAY+40
         ORG   FNCARRAY+40
         DC    AL1(12)
         DS    CL3
         DC    AL4(EISCLOSN)
         ORG   FNCARRAY+48
         ORG   FNCARRAY+48
         DC    AL1(86)
         DS    CL3
         DC    AL4(EISUDEO)
         ORG   FNCARRAY+56
         ORG   FNCARRAY+56
         DC    AL1(84)
         DS    CL3
         DC    AL4(EISSTOWR)
         ORG   FNCARRAY+64
         ORG   FNCARRAY+64
         DC    AL1(83)
         DS    CL3
         DC    AL4(EISSTOWD)
         ORG   FNCARRAY+72
         ORG   FNCARRAY+72
         DC    AL1(82)
         DS    CL3
         DC    AL4(EISSTOWC)
         ORG   FNCARRAY+80
         ORG   FNCARRAY+80
         DC    AL1(89)
         DS    CL3
         DC    AL4(EISWRDIR)
         ORG   FNCARRAY+88
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MSGRC    EQU   @02
STOWCRC  EQU   @02
BLKWRRC  EQU   @02
WRITRC   EQU   @02
FORMRC   EQU   @02
WRDIRRC  EQU   @02
STOWDRC  EQU   @02
STOWRRC  EQU   @02
GETNRC   EQU   @02
LOCRC    EQU   @02
FREERC   EQU   @04
INITRC   EQU   @05
INITPTR  EQU   @04
SETUPRC  EQU   @02
UNUSEDSP EQU   @05
MVSIZE   EQU   @06
FILLPTR  EQU   @08
EISRC    EQU   @02
MEMUSE   EQU   @06
DIRBKCT  EQU   @07
TMPINDX  EQU   @02
PDSINDX  EQU   @03
IOPPTR   EQU   @04
RTNCODE  EQU   @15
         EXTRN HMASMCCA
CCADSIDA EQU   0
CCATYPEA EQU   0
CCABLDLA EQU   0
@NM00025 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00027 EQU   CCABLDLL
CCALKDRC EQU   @NM00027+20
@NM00029 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00039+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
@NM00043 EQU   HMASMIOP+12
@NM00044 EQU   @NM00043
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00154 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
EISRTN   EQU   0
OUTMEM   EQU   0
NTRYMAP  EQU   0
NTRYKEY  EQU   NTRYMAP
ULEN     EQU   NTRYMAP+11
IOPBS01  EQU   0
IOPBS03  EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00009 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCACHECK EQU   CCAFLAG2
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCACDSOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
EISMIOP  EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00050 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPONAME EQU   IOPSTCMP
IOPOTYPE EQU   IOPSTCMP+8
IOPNNAME EQU   IOPSTCMP+9
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPDIRMX EQU   IOPNTMAX+12
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00061 EQU   IOPUDATA
@NM00062 EQU   IOPUDATA
IOPALLOC EQU   @NM00062+4
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00071 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00082 EQU   IOPSRCDR+1
@NM00084 EQU   @NM00082+7
@NM00088 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00092 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00098 EQU   IOPMODDR+1
@NM00100 EQU   @NM00098+7
@NM00104 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00108 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00119 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00126 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00135 EQU   IOPPTFFX
@NM00136 EQU   @NM00135
IOPPDTES EQU   IOPPTFFX+41
@NM00139 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00164 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00164
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00168 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00168
IOPBFTB1 EQU   IOPBFTB0
GTP      EQU   TYPGTPTB
@NM00184 EQU   IOPDRMAP
DELTYP   EQU   @NM00184+8
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00185 EQU   @NM00184
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00170 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00169 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00167 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00166 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00165 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00163 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00162 EQU   IOPPTSFX+35
@NM00161 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00160 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00159 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00158 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00157 EQU   IOPQFMDR
@NM00153 EQU   IOPQSMDR
@NM00152 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00151 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00150 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00149 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00148 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00147 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00146 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00145 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00144 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00143 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00142 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00141 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00140 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00139+3
IOPRECD  EQU   @NM00139
@NM00138 EQU   IOPPTFFX+8
@NM00137 EQU   @NM00135+7
IOPPRELN EQU   @NM00136
@NM00134 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00133 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00132 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00131 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00130 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00129 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00128 EQU   @NM00126+7
@NM00127 EQU   @NM00126
@NM00125 EQU   IOPSYSDR+5
@NM00124 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00123 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00122 EQU   IOPDLBFX+8
@NM00121 EQU   @NM00119+7
@NM00120 EQU   @NM00119
@NM00118 EQU   IOPDLBDR+1
@NM00117 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00116 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00115 EQU   IOPMODFX+12
@NM00114 EQU   IOPMODF4
@NM00113 EQU   IOPMODF3
@NM00112 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00111 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00110 EQU   @NM00108+7
@NM00109 EQU   @NM00108
@NM00107 EQU   IOPMODDR+17
@NM00106 EQU   @NM00104+7
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00100
@NM00102 EQU   @NM00100
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00098
@NM00097 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00096 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00095 EQU   IOPSRCFX+8
@NM00094 EQU   @NM00092+7
@NM00093 EQU   @NM00092
@NM00091 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00090 EQU   @NM00088+7
@NM00089 EQU   @NM00088
@NM00087 EQU   @NM00084
@NM00086 EQU   @NM00084
@NM00085 EQU   @NM00084
@NM00083 EQU   @NM00082
@NM00081 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00080 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00079 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00078 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00077 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00076 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00075 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00073 EQU   @NM00071+7
@NM00072 EQU   @NM00071
@NM00070 EQU   IOPLMDDR+6
@NM00069 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00068 EQU   IOPLMDF4
@NM00067 EQU   IOPLMDF3
@NM00066 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00065 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00064 EQU   IOPLMDDR
@NM00063 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPUSED  EQU   @NM00062
IOPTPSEQ EQU   @NM00061+8
IOPVLSER EQU   @NM00061+2
IOPBLKSI EQU   @NM00061
IOPCQMAX EQU   IOPCQMAP+12
@NM00060 EQU   IOPCQMAP+11
@NM00059 EQU   IOPCQMAP+8
@NM00058 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00057 EQU   IOPSCMAP+11
@NM00056 EQU   IOPSCMAP+8
@NM00055 EQU   IOPSCMAP
@NM00054 EQU   IOPNTMAX+11
@NM00053 EQU   IOPNTMAX+8
@NM00052 EQU   IOPNTMAX
@NM00051 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00050+5
IOPIPTF3 EQU   @NM00050
CCAEND   EQU   HMASMCCA+371
@NM00024 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00023 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00022 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00021 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00020 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00019 EQU   CCAFLAG5
@NM00018 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00017 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00016 EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00015 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00014 EQU   @NM00009+18
@NM00013 EQU   @NM00009+16
CCATBLPA EQU   @NM00009+12
@NM00012 EQU   @NM00009+8
@NM00011 EQU   @NM00009+4
@NM00010 EQU   @NM00009
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00008 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00007 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00006 EQU   CCAFBUFR+122
@NM00005 EQU   CCAFBUFR+120
@NM00004 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00003 EQU   CCAFBUFR+88
@NM00002 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00001 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00181 EQU   NTRYMAP+12
@NM00180 EQU   NTRYMAP+8
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00156 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00155 EQU   @NM00154+7
IOPQSMFM EQU   @NM00154
@NM00074 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00049 EQU   IOPUSERL
@NM00048 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00047 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00046 EQU   @NM00043+10
IOPSEQNO EQU   @NM00043+8
@NM00045 EQU   @NM00044+7
IOPPTFNM EQU   @NM00044
IOPNAM17 EQU   IOPNAME
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00042 EQU   CCABLDLM+2
@NM00041 EQU   CCABLDLM
CCAUPDPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00039+12
CCAUPDTE EQU   @NM00039+8
CCAUPDNM EQU   @NM00039
CCASUPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00037+12
CCAIOSUP EQU   @NM00037+8
CCASUPNM EQU   @NM00037
CCAZAPPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00035+12
CCASPZAP EQU   @NM00035+8
CCAZAPNM EQU   @NM00035
CCACOMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00033+12
CCACOMRS EQU   @NM00033+8
CCACOMNM EQU   @NM00033
CCACPYPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00031+12
CCACOPY  EQU   @NM00031+8
CCACPYNM EQU   @NM00031
CCAASMPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00029+12
CCAASM   EQU   @NM00029+8
CCAASMNM EQU   @NM00029
CCALKDPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00027+12
CCALKED  EQU   @NM00027+8
CCALKDNM EQU   @NM00027
CCAPGMPM EQU   @NM00025+24
@NM00026 EQU   @NM00025+21
CCABPGRC EQU   @NM00025+20
CCABPGSP EQU   @NM00025+12
CCABPGAD EQU   @NM00025+8
CCABPGNM EQU   @NM00025
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00522 EQU   @RC00516
@RF00567 EQU   @RC00561
@RF00688 EQU   @RC00678
@ENDDATA EQU   *
         END   HMASMEIS,(C'PLS2013',0802,78334)

         TITLE 'HMASMRCD - LOAD RELFILES TO TLIB DATASETS'
HMASMRCD CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMRCD  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  LA    @12,4095(,@10)                                      0001
         USING @PSTART,@10                                         0001
         USING @PSTART+4095,@12                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   RECXLAST=0;                     /* CLEAR CODE PASSED TO RECEIVE  */
         L     @05,@PC00001                                        0209
         SLR   @09,@09                                             0209
         ST    @09,RECXLAST(,@05)                                  0209
*   HMASMMGP=''B;                   /* CLEAR HMASMMSG PARM BLOCK     */
         XC    HMASMMGP(24),HMASMMGP                               0210
*   SPLPMAD=ADDR(LOCSPL);           /* SET UP ADDRESS OF LOCAL DSN   */
         LA    @09,LOCSPL                                          0211
         ST    @09,SPLPMAD                                         0211
*   IOPPTR=RECXIOPG;                /* SET UP DEFAULT IOP PTR        */
         L     IOPPTR,RECXIOPG(,@05)                               0212
*   LSW=''B;                        /* RESET LOCAL SWITCHES          */
*                                                                  0213
         MVI   LSW,X'00'                                           0213
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTART RELFILE GTA FILE FROM THE BEGINNING AND GET THE FIRST */
*   /* RECORD                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0214
*   RFY                                                            0214
*     HMASMGTP BASED(RECXGRFP);     /* ADDRESS RELFILE GTP           */
*   GTPFUNCT=GTPOPENN;              /* RESTART FROM BEGINNING        */
         L     @05,RECXGRFP(,@05)                                  0215
         MVI   GTPFUNCT(@05),X'01'                                 0215
*   CALL HMASMGTA(HMASMGTP);        /* GET TO BEGINNING OF FILE      */
         ST    @05,@AL00001                                        0216
         L     @15,@CV01465                                        0216
         LA    @01,@AL00001                                        0216
         BALR  @14,@15                                             0216
*   GTPFUNCT=GTPGETN;               /* SET UP TO GET NEXT RECORD     */
         L     @05,@PC00001                                        0217
         L     @05,RECXGRFP(,@05)                                  0217
         MVI   GTPFUNCT(@05),X'08'                                 0217
*   CALL HMASMGTA(HMASMGTP);        /* GET FIRST RECORD              */
         ST    @05,@AL00001                                        0218
         L     @15,@CV01465                                        0218
         LA    @01,@AL00001                                        0218
         BALR  @14,@15                                             0218
*   IF GTPRETRN>=GTPEOF THEN        /* IF END OF FILE THEN           */
         L     @05,@PC00001                                        0219
         L     @05,RECXGRFP(,@05)                                  0219
         CLI   GTPRETRN(@05),4                                     0219
         BL    @RF00219                                            0219
*     EOFSW=ON;                     /* POST EOF SW                   */
         OI    EOFSW,B'00100000'                                   0220
*                                                                  0221
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ALL RELFILE GTA RECORDS                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0221
*   DO WHILE EOFSW=OFF              /* ALL RECORDS NOT PROCESSED     */
*         &RECXLAST<STOPFUNC;       /* NO TERMINATING ERRORS         */
*                                                                  0221
@RF00219 B     @DE00221                                            0221
@DL00221 DS    0H                                                  0222
*     /***************************************************************/
*     /*                                                             */
*     /* GET ALL ELEMENTS TO BE LOADED FROM NEXT RELFILE             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0222
*     CALL ELEMPROC(SUBRC);         /* GET ELEMENTS NEXT RELFILE     */
         LA    @01,@AL00222                                        0222
         BAL   @14,ELEMPROC                                        0222
*     RECXLAST=MAX(RECXLAST,SUBRC); /* MAINTAIN MAX RETURN CODE      */
         L     @05,@PC00001                                        0223
         L     @09,SUBRC                                           0223
         L     @08,RECXLAST(,@05)                                  0223
         CR    @08,@09                                             0223
         BNL   *+6
         LR    @08,@09                                             0223
         ST    @08,RECXLAST(,@05)                                  0223
*     IF CURSYSM=ON                 /* SYSMOD WITH RELFILE ELEMENTS  */
*         &SUBRC<STOPPTF            /* NO TERMINATING ERRORS         */
*       THEN                                                       0224
         TM    CURSYSM,B'10000000'                                 0224
         BNO   @RF00224                                            0224
         CH    @09,@CH00037                                        0224
         BNL   @RF00224                                            0224
*       DO;                                                        0225
*                                                                  0225
*         /***********************************************************/
*         /*                                                         */
*         /* LOAD ALL ELEMENTS FROM THE RELFILE TO TLIB DATASET      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0226
*         CALL COPYFILE(SUBRC);     /* LOAD ELEMENTS FROM 1 FILE     */
         LA    @01,@AL00226                                        0226
         BAL   @14,COPYFILE                                        0226
*         RECXLAST=MAX(RECXLAST,SUBRC);/* MAINTAIN MAX RETURN CODE   */
         L     @05,@PC00001                                        0227
         L     @09,SUBRC                                           0227
         L     @08,RECXLAST(,@05)                                  0227
         CR    @08,@09                                             0227
         BNL   *+6
         LR    @08,@09                                             0227
         ST    @08,RECXLAST(,@05)                                  0227
*         IF SUBRC>0                /* "COPY" ERROR                  */
*           THEN                                                   0228
         LTR   @09,@09                                             0228
         BNP   @RF00228                                            0228
*           DO;                                                    0229
*                                                                  0229
*             /*******************************************************/
*             /*                                                     */
*             /* ERROR(S) LOADING RELFILE ELEMENTS                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0230
*             CALL DELSYSM(SUBRC);  /* CLEANUP TLIB DATASETS         */
         LA    @01,@AL00230                                        0230
         BAL   @14,DELSYSM                                         0230
*             RECXLAST=MAX(RECXLAST,SUBRC);/* MAINTAIN MAX RET CODE  */
         L     @05,@PC00001                                        0231
         L     @09,RECXLAST(,@05)                                  0231
         L     @08,SUBRC                                           0231
         CR    @09,@08                                             0231
         BNL   *+6
         LR    @09,@08                                             0231
         ST    @09,RECXLAST(,@05)                                  0231
*             CURSYSM=OFF;          /* NO SYSMOD BEING PROCESSED     */
         NI    CURSYSM,B'01111111'                                 0232
*           END;                                                   0233
*         ELSE                                                     0234
*           DO;                                                    0234
*                                                                  0234
         B     @RC00228                                            0234
@RF00228 DS    0H                                                  0235
*             /*******************************************************/
*             /*                                                     */
*             /* NO ERROR(S) LOADING RELFILE ELEMENTS                */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0235
*             IF NEWSYSM=ON         /* A NEW SYSMOD FOUND IN GTA     */
*                 ×EOFSW=ON         /* END-OF-FILE FOR GTA FILE      */
*               THEN                                               0235
         TM    NEWSYSM,B'01100000'                                 0235
         BZ    @RF00235                                            0235
*               DO;                                                0236
*                                                                  0236
*                 /***************************************************/
*                 /*                                                 */
*                 /* ALL ELEMENTS FOR THE A SYSMOD HAVE BEEN LOADED  */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0237
*                 CALL PUTSYSM(SUBRC);/* RE-WRITE PTS SYSMOD ENTRY   */
         LA    @01,@AL00237                                        0237
         BAL   @14,PUTSYSM                                         0237
*                 RECXLAST=MAX(RECXLAST,SUBRC);/* MAINTAIN R.C.      */
         L     @05,@PC00001                                        0238
         L     @09,SUBRC                                           0238
         L     @08,RECXLAST(,@05)                                  0238
         CR    @08,@09                                             0238
         BNL   *+6
         LR    @08,@09                                             0238
         ST    @08,RECXLAST(,@05)                                  0238
*                 CURSYSM=OFF;      /* NO SYSMOD BEING PROCESSED     */
         NI    CURSYSM,B'01111111'                                 0239
*                 IF SUBRC>0 THEN   /* ERROR(S) WRITING SYSMOD TO PTS*/
         LTR   @09,@09                                             0240
         BNP   @RF00240                                            0240
*                   CALL DELSYSM(SUBRC);/* CLEANUP TLIB DATASETS     */
         LA    @01,@AL00241                                        0241
         BAL   @14,DELSYSM                                         0241
*               END;                                               0242
@RF00240 DS    0H                                                  0243
*           END;                                                   0243
@RF00235 DS    0H                                                  0244
*       END;                                                       0244
@RC00228 DS    0H                                                  0245
*   END;                                                           0245
@RF00224 DS    0H                                                  0245
@DE00221 TM    EOFSW,B'00100000'                                   0245
         BNZ   @DC00221                                            0245
         L     @05,@PC00001                                        0245
         L     @05,RECXLAST(,@05)                                  0245
         CH    @05,@CH00034                                        0245
         BL    @DL00221                                            0245
@DC00221 DS    0H                                                  0246
*   IF RECXLAST>=STOPPTF            /* ONE OR MORE SYSMODS FAILED    */
*     THEN                                                         0246
         L     @05,@PC00001                                        0246
         L     @09,RECXLAST(,@05)                                  0246
         CH    @09,@CH00037                                        0246
         BL    @RF00246                                            0246
*     DO;                                                          0247
*                                                                  0247
*       /*************************************************************/
*       /*                                                           */
*       /* DELETE PTS SYSMOD AND MCS ENTRIES FOR SYSMODS WITH RELFILE*/
*       /* ELEMENTS WHICH WERE NOT LOADED                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0248
*       RESPECIFY                                                  0248
*         HMASMGTP BASED(RECXGSMP); /* ADDRESS SUMMARY GTP           */
*       GTPFUNCT=GTPOPENN;          /* RESTART FROM BEGINNING OF FILE*/
         L     @05,RECXGSMP(,@05)                                  0249
         MVI   GTPFUNCT(@05),X'01'                                 0249
*       CALL HMASMGTA(HMASMGTP);                                   0250
         ST    @05,@AL00001                                        0250
         L     @15,@CV01465                                        0250
         LA    @01,@AL00001                                        0250
         BALR  @14,@15                                             0250
*       GTPFUNCT=GTPGETN;           /* SET UP GET NEXT RECORD FUNCT. */
         L     @05,@PC00001                                        0251
         L     @05,RECXGSMP(,@05)                                  0251
         MVI   GTPFUNCT(@05),X'08'                                 0251
*       CALL HMASMGTA(HMASMGTP);    /* GET FIRST RECORD              */
*                                                                  0252
         ST    @05,@AL00001                                        0252
         L     @15,@CV01465                                        0252
         LA    @01,@AL00001                                        0252
         BALR  @14,@15                                             0252
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU SUMMARY GTA FILE                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0253
*       DO WHILE GTPRETRN=GTPGOOD;                                 0253
         B     @DE00253                                            0253
@DL00253 DS    0H                                                  0254
*         IF GSMRLFP=ON             /* RELFILES PRESENT IN SYSMOD    */
*             &GSMRLFL=OFF          /* RELFILES NOT LOADED           */
*           THEN                                                   0254
         L     @05,@PC00001                                        0254
         L     @05,RECXGSMP(,@05)                                  0254
         L     @05,GTPBUFAD(,@05)                                  0254
         TM    GSMRLFP(@05),B'01000000'                            0254
         BNO   @RF00254                                            0254
         TM    GSMRLFL(@05),B'00100000'                            0254
         BNZ   @RF00254                                            0254
*           DO;                                                    0255
*                                                                  0255
*             /*******************************************************/
*             /*                                                     */
*             /* SCRATCH SYSMOD ENTRY FROM PTS                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0256
*             IOPDSID=IOPPTS;       /* SMPPTS DATASET                */
         MVI   IOPDSID(IOPPTR),X'06'                               0256
*             IOPNAME=GSMS#;        /* SYSMOD-ID FROM SUMMARY RECORD */
         MVI   IOPNAME+7(IOPPTR),C' '                              0257
         MVC   IOPNAME(7,IOPPTR),GSMS#(@05)                        0257
*             IOPTYPE=IOPSMD;       /* ENTRY TYPE - SYSMOD           */
         MVI   IOPTYPE(IOPPTR),X'0B'                               0258
*             IOPFUNCT=IOPSTOWD;    /* FUNCTION - STOW-DELETE ENTRY  */
         MVI   IOPFUNCT(IOPPTR),X'53'                              0259
*             CALL HMASMIO(HMASMIOP);/* SCRATCH SYSMOD ENTRY FROM PTS*/
*                                                                  0260
         ST    IOPPTR,@AL00001                                     0260
         L     @15,@CV01464                                        0260
         LA    @01,@AL00001                                        0260
         BALR  @14,@15                                             0260
*             /*******************************************************/
*             /*                                                     */
*             /* SCRATCH MCS ENTRY FROM PTS                          */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0261
*             IOPTYPE=IOPMCS;       /* ENTRY TYPE - MCS              */
         MVI   IOPTYPE(IOPPTR),X'10'                               0261
*             IOPFUNCT=IOPSTOWD;    /* FUNCTION - STOW-DELETE ENTRY  */
         MVI   IOPFUNCT(IOPPTR),X'53'                              0262
*             CALL HMASMIO(HMASMIOP);/* SCRATCH MCS ENTRY FROM PTS   */
         ST    IOPPTR,@AL00001                                     0263
         L     @15,@CV01464                                        0263
         LA    @01,@AL00001                                        0263
         BALR  @14,@15                                             0263
*             IF GSMLERR=OFF        /* NO APPROPRIATE MSG ISSUED YET */
*               THEN                                               0264
         L     @05,@PC00001                                        0264
         L     @05,RECXGSMP(,@05)                                  0264
         L     @05,GTPBUFAD(,@05)                                  0264
         TM    GSMLERR(@05),B'00000010'                            0264
         BNZ   @RF00264                                            0264
*               DO;                                                0265
*                                                                  0265
*                 /***************************************************/
*                 /*                                                 */
*                 /* ISSUE HMA391I FOR SYSMODS WHOSE ELEMENTS WERE   */
*                 /* NOT LOADED                                      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0266
*                 HMASMMGP=''B;     /* CLEAR MGP                     */
         XC    HMASMMGP(24),HMASMMGP                               0266
*                 MGPMGNO1=HMA391I; /* SET MESSAGE ID                */
         SLR   @05,@05                                             0267
         IC    @05,HMA391I                                         0267
         STH   @05,MGPMGNO1                                        0267
*                 MGPVARPT(1)=ADDR(CURSYSM#);/* SET SYSMOD-ID IN MSG */
         LA    @05,CURSYSM#                                        0268
         ST    @05,MGPVARPT                                        0268
*                 MGPTYPE=MGPERR;   /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0269
*                 MGPPRINT=ON;      /* PUT TO SMPOUT                 */
*                 MGPHLDS=ON;       /* PUT TO SMPLOG                 */
         OI    MGPPRINT,B'10010000'                                0271
*                 CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE           */
         L     @15,@CV01466                                        0272
         LA    @01,@AL00272                                        0272
         BALR  @14,@15                                             0272
*               END;                                               0273
*           END;                                                   0274
@RF00264 DS    0H                                                  0275
*         GTPFUNCT=GTPGETN;         /* SET UP TO GET NEXT RECORD     */
@RF00254 L     @05,@PC00001                                        0275
         L     @05,RECXGSMP(,@05)                                  0275
         MVI   GTPFUNCT(@05),X'08'                                 0275
*         CALL HMASMGTA(HMASMGTP);  /* GET NEXT SUMMARY RECORD       */
         ST    @05,@AL00001                                        0276
         L     @15,@CV01465                                        0276
         LA    @01,@AL00001                                        0276
         BALR  @14,@15                                             0276
*       END;                                                       0277
@DE00253 L     @05,@PC00001                                        0277
         L     @05,RECXGSMP(,@05)                                  0277
         CLI   GTPRETRN(@05),0                                     0277
         BE    @DL00253                                            0277
*     END;                                                         0278
*   RETURN CODE(RECXLAST);          /* PASS THE RETURN CODE          */
@RF00246 L     @09,@PC00001                                        0279
         L     @15,RECXLAST(,@09)                                  0279
         L     @13,4(,@13)                                         0279
         L     @14,12(,@13)                                        0279
         LM    @00,@12,20(@13)                                     0279
         BR    @14                                                 0279
*                                                                  0280
*/********************************************************************/
*/*                                                                  */
*/*   ELEMPROC - BUILD "COPY" CONTROL STATEMENTS FOR MEMBERS OF      */
*/*              ONE UN-LOADED DATASET  ON RELFILE TAPE              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0280
*ELEMPROC:                                                         0280
*   PROC(ELEMRC);                                                  0280
ELEMPROC STM   @14,@03,@SA00002                                    0280
         STM   @05,@12,@SA00002+24                                 0280
         MVC   @PC00002(4),0(@01)                                  0280
*   DCL                                                            0281
*     ELEMRC FIXED(31);             /* RETURN CODE PARAMETER         */
*   DCL                                                            0282
*     SUB1RC FIXED(31);             /* R.C. PARM PASSED TO GETSYSM   */
*   ELEMRC=0;                       /* INITIALIZE RETURN CODE        */
         L     @05,@PC00002                                        0283
         SLR   @09,@09                                             0283
         ST    @09,ELEMRC(,@05)                                    0283
*   NEWSYSM=OFF;                    /* NEW SYSMOD NOT FOUND IN     0284
*                                      RELFILE GTA FILE              */
         NI    NEWSYSM,B'10111111'                                 0284
*   IF EOFSW=OFF                    /* NOT AT END OF GTA FILE        */
*       &GRFFLUSH=ON                /* THIS SYSMOD WAS FLUSHED       */
*     THEN                                                         0285
         TM    EOFSW,B'00100000'                                   0285
         BNZ   @RF00285                                            0285
         L     @05,@PC00001                                        0285
         L     @05,RECXGRFP(,@05)                                  0285
         L     @05,GTPBUFAD(,@05)                                  0285
         TM    GRFFLUSH(@05),B'10000000'                           0285
         BNO   @RF00285                                            0285
*     DO;                           /* THEN FIND NEXT NON-FLUSHED    */
*                                                                  0286
*       /*************************************************************/
*       /*                                                           */
*       /* SYSMOD FOUND IN RELFILE GTA IS BEING FLUSHED ... FIND NEXT*/
*       /* NON-FLUSHED SYSMOD                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0287
*       DO UNTIL GRFFLUSH=OFF×      /* SEARCH FOR NON-FLUSHED        */
*             EOFSW=ON;             /* SYSMOD OR EOF                 */
@DL00287 DS    0H                                                  0288
*         RFY                                                      0288
*           HMASMGTP BASED(RECXGRFP);/* REBASE HMASMGTP              */
*         DO;                       /* HMASMGPF F(GTPGETN)RLEN(LENGTH
*                                      (GRFREC))B(RECXGRFP)          */
*           GTPFUNCT=GTPGETN;       /* SET UP FUNCTION CODE          */
         L     @05,@PC00001                                        0290
         L     @05,RECXGRFP(,@05)                                  0290
         MVI   GTPFUNCT(@05),X'08'                                 0290
*           GTPRCDLN=LENGTH(GRFREC);/* SET UP RLEN                   */
         MVC   GTPRCDLN(2,@05),@CH00558                            0291
*           CALL HMASMGTA(HMASMGTP);/* HAVE FUNCTION PERFORMED       */
         ST    @05,@AL00001                                        0292
         L     @15,@CV01465                                        0292
         LA    @01,@AL00001                                        0292
         BALR  @14,@15                                             0292
*         END;                                                     0293
*         IF GTPRETRN=GTPEOF THEN   /* IF END OF FILE THEN           */
         L     @05,@PC00001                                        0294
         L     @05,RECXGRFP(,@05)                                  0294
         CLI   GTPRETRN(@05),4                                     0294
         BNE   @RF00294                                            0294
*           EOFSW=ON;               /* POST EOF SW                   */
         OI    EOFSW,B'00100000'                                   0295
*       END;                                                       0296
@RF00294 DS    0H                                                  0296
@DE00287 L     @05,@PC00001                                        0296
         L     @05,RECXGRFP(,@05)                                  0296
         L     @05,GTPBUFAD(,@05)                                  0296
         TM    GRFFLUSH(@05),B'10000000'                           0296
         BZ    @DC00287                                            0296
         TM    EOFSW,B'00100000'                                   0296
         BNO   @DL00287                                            0296
@DC00287 DS    0H                                                  0297
*     END;                                                         0297
*   IF EOFSW=OFF                    /* NOT AT END OF GTA FILE        */
*     THEN                                                         0298
@RF00285 TM    EOFSW,B'00100000'                                   0298
         BNZ   @RF00298                                            0298
*     DO;                                                          0299
*       RELFREST=GTPRESTR;          /* SAVE POSITION IN RELFILE GTA
*                                      ... RELFILE RESTART DATA      */
         L     @05,@PC00001                                        0300
         L     @05,RECXGRFP(,@05)                                  0300
         MVC   RELFREST(10),GTPRESTR(@05)                          0300
*       ABSFSEQ=GRFFSEQ;            /* SAVE ABSOLUTE FILE SEQUENCE 0301
*                                      NUMBER                        */
         L     @09,GTPBUFAD(,@05)                                  0301
         MVC   ABSFSEQ(2),GRFFSEQ(@09)                             0301
*       IF CURSYSM=OFF              /* NOT CURRENTLY PROCESSING A  0302
*                                      SYSMOD                        */
*         THEN                                                     0302
         TM    CURSYSM,B'10000000'                                 0302
         BNZ   @RF00302                                            0302
*         DO;                                                      0303
*                                                                  0303
*           /*********************************************************/
*           /*                                                       */
*           /* INITIALIZE FOR PROCESSING A NEW SYSMOD ... GET PTS    */
*           /* SYSMOD ENTRY AND GTA SUMMARY RECORD                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0304
*           SYSMREST=GTPRESTR;      /* SAVE POSITION IN RELFILE GTA
*                                      ... SYSMOD RESTART DATA       */
         MVC   SYSMREST(10),GTPRESTR(@05)                          0304
*           CALL GETSYSM(GRFSM#,    /* SYSMOD-ID                     */
*               GRFSTY,             /* SYSMOD TYPE                   */
*               SUB1RC);            /* RETURN CODE                   */
         LA    @05,GRFSM#(,@09)                                    0305
         ST    @05,@AL00001                                        0305
         LA    @05,GRFSTY(,@09)                                    0305
         ST    @05,@AL00001+4                                      0305
         LA    @05,SUB1RC                                          0305
         ST    @05,@AL00001+8                                      0305
         LA    @01,@AL00001                                        0305
         BAL   @14,GETSYSM                                         0305
*           ELEMRC=MAX(ELEMRC,SUB1RC);/* SAVE RETURN CODE            */
         L     @05,@PC00002                                        0306
         L     @09,SUB1RC                                          0306
         L     @08,ELEMRC(,@05)                                    0306
         CR    @08,@09                                             0306
         BNL   *+6
         LR    @08,@09                                             0306
         ST    @08,ELEMRC(,@05)                                    0306
*           IF SUB1RC=0 THEN                                       0307
         LTR   @09,@09                                             0307
         BNZ   @RF00307                                            0307
*             DO;                                                  0308
*               CURSYSM#=GRFSM#;    /* "CURRENT" SYSMOD-ID           */
         L     @05,@PC00001                                        0309
         L     @05,RECXGRFP(,@05)                                  0309
         L     @05,GTPBUFAD(,@05)                                  0309
         MVC   CURSYSM#(7),GRFSM#(@05)                             0309
*               CURSYSM=ON;         /* PROCESSING SYSMOD             */
         OI    CURSYSM,B'10000000'                                 0310
*             END;                                                 0311
*         END;                                                     0312
@RF00307 DS    0H                                                  0313
*       IF ELEMRC=0                 /* STILL GOOD RETURN CODE        */
*         THEN                                                     0313
@RF00302 L     @05,@PC00002                                        0313
         ICM   @09,15,ELEMRC(@05)                                  0313
         BNZ   @RF00313                                            0313
*         DO;                                                      0314
*                                                                  0314
*           /*********************************************************/
*           /*                                                       */
*           /* CONSTRUCT TAPE DATA SET NAME                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0315
*           TAPESYSM=GRFSM#;        /* SET UP SYSMOD                 */
         L     @09,@PC00001                                        0315
         L     @01,RECXGRFP(,@09)                                  0315
         L     @08,GTPBUFAD(,@01)                                  0315
         MVC   TAPESYSM(7),GRFSM#(@08)                             0315
*           TAPERELF=GRFRELF;       /* RELFILE NUMBER                */
         MVC   TAPERELF(2),GRFRELF(@08)                            0316
*           TAPEASEQ=GRFFSEQ;       /* SAVE ABSOLUTE SEQUENCE        */
         MVC   TAPEASEQ(2),GRFFSEQ(@08)                            0317
*           TLIBDSS#=GRFRELF#;      /* SAVE RELFILE (BINARY VALUE) 0318
*                                      FOR CONSTRUCTION OF TLIB DSN  */
*                                                                  0318
         MVC   TLIBDSS#(2),GRFRELF#(@08)                           0318
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE COPY "COPY INDD= ... OUTDD=" STMT. TO SYSUT1    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0319
*           CCRELF=GRFRELF;         /* PUT RELFILE ON STMT.          */
         MVC   CCRELF(4),GRFRELF(@08)                              0319
*           CCSMD=GRFSM#;           /* PUT SYSMOD ON STMT.           */
         MVC   CCSMD(7),GRFSM#(@08)                                0320
*           DO;                     /* HMASMRIO F(IOPWRITE)IOP((RECXI
*                                      OPG))DSID(IOPSCR1)BUFFER(COPYC
*                                      ARD)                          */
*             IOPPTR=(RECXIOPG);    /* SET UP IOP ADDRESS            */
         L     IOPPTR,RECXIOPG(,@09)                               0322
*             IOPFUNCT=IOPWRITE;    /* SET UP FUNCTION CODE          */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0323
*             IOPDSID=IOPSCR1;      /* SET UP DSN CODE               */
         MVI   IOPDSID(IOPPTR),X'03'                               0324
*             IOPBUFAD=ADDR(COPYCARD);/* SET BUFFER ADDRESS          */
         LA    @05,COPYCARD                                        0325
         ST    @05,IOPBUFAD(,IOPPTR)                               0325
*             CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED           */
         ST    IOPPTR,@AL00001                                     0326
         L     @15,@CV01464                                        0326
         LA    @01,@AL00001                                        0326
         BALR  @14,@15                                             0326
*           END;                                                   0327
*           ELEMRC=IOPRETRN;        /* SAVE RETURN CODE              */
         L     @05,@PC00002                                        0328
         SLR   @09,@09                                             0328
         IC    @09,IOPRETRN(,IOPPTR)                               0328
         ST    @09,ELEMRC(,@05)                                    0328
*         END;                                                     0329
*                                                                  0330
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP "SELECT MEMBER" STATEMENTS FOR THIS RELFILE        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0330
*       COLPTR=ADDR(SCDATA);        /* POINT TO SELECT CARD DATA     */
@RF00313 LA    COLPTR,SCDATA                                       0330
*       SCDATA=' ';                 /* BLANK DATA PORTION OF CARD    */
         MVI   SCDATA+1,C' '                                       0331
         MVC   SCDATA+2(60),SCDATA+1                               0331
         MVI   SCDATA,C' '                                         0331
*       FILETYPE=''B;               /* CLEAR FILE TYPE INDICATORS    */
         MVI   FILETYPE,X'00'                                      0332
*       SCSMD=GRFSM#;               /* PUT SYSMOD ON STMT.           */
*                                                                  0333
         L     @09,@PC00001                                        0333
         L     @01,RECXGRFP(,@09)                                  0333
         L     @01,GTPBUFAD(,@01)                                  0333
         MVC   SCSMD(7),GRFSM#(@01)                                0333
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ALL RELFILE RECORDS FOR "CURRENT" FILE            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0334
*       DO WHILE ABSFSEQ=GRFFSEQ    /* PROCESSING SAME PTFIN FILE    */
*             &EOFSW=OFF            /* NOT EOF ON RELFILE GTA FILE   */
*             &ELEMRC=0;            /* GOOD RETURN CODE              */
*                                                                  0334
         B     @DE00334                                            0334
@DL00334 DS    0H                                                  0335
*         /***********************************************************/
*         /*                                                         */
*         /* SET FILETYPE FLAGS FOR ELEMENT TYPES FOUND ON CURRENT   */
*         /* FILE                                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0335
*         IF GRFELTY=MCBMODTP       /* ++MOD ELEMENT                 */
*           THEN                                                   0335
         L     @09,@PC00001                                        0335
         L     @01,RECXGRFP(,@09)                                  0335
         L     @01,GTPBUFAD(,@01)                                  0335
         CLI   GRFELTY(@01),4                                      0335
         BNE   @RF00335                                            0335
*           DMOD=ON;                /* MOD FILE TYPE                 */
         OI    DMOD,B'10000000'                                    0336
*         ELSE                                                     0337
*           IF GRFELTY=MCBMCRTP     /* ++MAC ELEMENT                 */
*             THEN                                                 0337
         B     @RC00335                                            0337
@RF00335 L     @09,@PC00001                                        0337
         L     @01,RECXGRFP(,@09)                                  0337
         L     @01,GTPBUFAD(,@01)                                  0337
         CLI   GRFELTY(@01),5                                      0337
         BNE   @RF00337                                            0337
*             DMAC=ON;              /* MAC FILE TYPE                 */
         OI    DMAC,B'01000000'                                    0338
*           ELSE                                                   0339
*             IF GRFELTY=MCBSCRTP   /* ++SRC ELEMENT                 */
*               THEN                                               0339
         B     @RC00337                                            0339
@RF00337 L     @09,@PC00001                                        0339
         L     @01,RECXGRFP(,@09)                                  0339
         L     @01,GTPBUFAD(,@01)                                  0339
         CLI   GRFELTY(@01),6                                      0339
         BNE   @RF00339                                            0339
*               DSRC=ON;            /* SRC FILE TYPE                 */
         OI    DSRC,B'00100000'                                    0340
*             ELSE                                                 0341
*               IF GRFELTY=MCBJCLTP /* ++JCLIN ELEMENT               */
*                 THEN                                             0341
         B     @RC00339                                            0341
@RF00339 L     @09,@PC00001                                        0341
         L     @01,RECXGRFP(,@09)                                  0341
         L     @01,GTPBUFAD(,@01)                                  0341
         CLI   GRFELTY(@01),10                                     0341
         BNE   @RF00341                                            0341
*                 DJCL=ON;          /* JCLIN FILE TYPE               */
*                                                                  0342
         OI    DJCL,B'00010000'                                    0342
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF ELEMENT WILL FIT ON CURRENT CARD               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0343
*         GRFLOADD=ON;              /* POST ELEMENT LOADED           */
@RF00341 DS    0H                                                  0343
@RC00339 DS    0H                                                  0343
@RC00337 DS    0H                                                  0343
@RC00335 L     @09,@PC00001                                        0343
         L     @01,RECXGRFP(,@09)                                  0343
         L     @01,GTPBUFAD(,@01)                                  0343
         OI    GRFLOADD(@01),B'01000000'                           0343
*         IF ADDR(SCEND)-COLPTR<    /* IF THERE IS NOT ENOUGH ROOM   */
*             LENGTH(GRFELEM)+      /* ON CARD FOR ELEMENT AND       */
*             LENGTH(REPLACE) THEN  /* REPLACE CODES                 */
         LA    @08,SCEND                                           0344
         SLR   @08,COLPTR                                          0344
         CH    @08,@CH00341                                        0344
         BNL   @RF00344                                            0344
*           DO;                     /* PUT OUT THIS CARD             */
*             COLPTR=COLPTR-        /* BACK UP TO COMMA              */
*                 LENGTH(CARDCLOS); /* AFTER LAST PARAMETER          */
         BCTR  COLPTR,0                                            0346
         BCTR  COLPTR,0                                            0346
*             CARDCLOS=') ';        /* CLOSE SUBPARAMETER LIST       */
*                                                                  0347
         MVC   CARDCLOS(2,COLPTR),@CC01636                         0347
*             /*******************************************************/
*             /*                                                     */
*             /* WRITE COPY "SELECT MEMBER" STMT. TO SYSUT1 FILE     */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0348
*             DO;                   /* HMASMRIO F(IOPWRITE)IOP((RECXI
*                                      OPG))DSID(IOPSCR1)BUFFER(SCARD
*                                      )                             */
*               IOPPTR=(RECXIOPG);  /* SET UP IOP ADDRESS            */
         L     IOPPTR,RECXIOPG(,@09)                               0349
*               IOPFUNCT=IOPWRITE;  /* SET UP FUNCTION CODE          */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0350
*               IOPDSID=IOPSCR1;    /* SET UP DSN CODE               */
         MVI   IOPDSID(IOPPTR),X'03'                               0351
*               IOPBUFAD=ADDR(SCARD);/* SET BUFFER ADDRESS           */
         LA    @09,SCARD                                           0352
         ST    @09,IOPBUFAD(,IOPPTR)                               0352
*               CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED         */
         ST    IOPPTR,@AL00001                                     0353
         L     @15,@CV01464                                        0353
         LA    @01,@AL00001                                        0353
         BALR  @14,@15                                             0353
*             END;                                                 0354
*             ELEMRC=IOPRETRN;      /* SAVE RETURN CODE              */
         L     @09,@PC00002                                        0355
         SLR   @08,@08                                             0355
         IC    @08,IOPRETRN(,IOPPTR)                               0355
         ST    @08,ELEMRC(,@09)                                    0355
*             COLPTR=ADDR(SCDATA);  /* RESET POINTER                 */
         LA    COLPTR,SCDATA                                       0356
*             SCDATA=' ';           /* BLANK OUT OLD DATA            */
         MVI   SCDATA+1,C' '                                       0357
         MVC   SCDATA+2(60),SCDATA+1                               0357
         MVI   SCDATA,C' '                                         0357
*           END;                                                   0358
*                                                                  0358
*         /***********************************************************/
*         /*                                                         */
*         /* ADD ELEMENT TO CARD                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0359
*         DO I=1 TO 8 WHILE         /* MOVE UNTIL BLANK FOUND        */
*               GRFELEM(I)^=BLANK;  /* OR ALL 8 CHARACTERS MOVED     */
@RF00344 LA    I,1                                                 0359
@DL00359 L     @07,@PC00001                                        0359
         L     @07,RECXGRFP(,@07)                                  0359
         L     @07,GTPBUFAD(,@07)                                  0359
         LR    @01,@07                                             0359
         ALR   @01,I                                               0359
         CLI   GRFELEM-1(@01),C' '                                 0359
         BE    @DC00359                                            0359
*           CARDCOL=GRFELEM(I);     /* MOVE 1 CHARACTER              */
         ALR   @07,I                                               0360
         MVC   CARDCOL(1,COLPTR),GRFELEM-1(@07)                    0360
*           COLPTR=COLPTR+1;        /* POINT TO NEXT COLUMN          */
         AH    COLPTR,@CH00041                                     0361
*         END;                                                     0362
         AH    I,@CH00041                                          0362
         CH    I,@CH00037                                          0362
         BNH   @DL00359                                            0362
@DC00359 DS    0H                                                  0363
*         CARDREP=REPLACE;          /* POST ,,R),( AFTER ELEMENT     */
         MVC   CARDREP(6,COLPTR),@CC01544                          0363
*         COLPTR=COLPTR+            /* POINT PAST                    */
*             LENGTH(REPLACE);      /* CONTROL DATA                  */
         AH    COLPTR,@CH00090                                     0364
*         IF ELEMRC=0               /* STILL GOOD RETURN CODE        */
*           THEN                                                   0365
         L     @09,@PC00002                                        0365
         ICM   @08,15,ELEMRC(@09)                                  0365
         BNZ   @RF00365                                            0365
*           DO;                                                    0366
*                                                                  0366
*             /*******************************************************/
*             /*                                                     */
*             /* GET NEXT RELFILE RECORD FROM THE GTA FILE           */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0367
*             RFY                                                  0367
*               HMASMGTP BASED(RECXGRFP);/* REBASE HMASMGTP          */
*             DO;                   /* HMASMGPF F(GTPGETN)RLEN(LENGTH
*                                      (GRFREC))B(RECXGRFP)          */
*               GTPFUNCT=GTPGETN;   /* SET UP FUNCTION CODE          */
         L     @09,@PC00001                                        0369
         L     @09,RECXGRFP(,@09)                                  0369
         MVI   GTPFUNCT(@09),X'08'                                 0369
*               GTPRCDLN=LENGTH(GRFREC);/* SET UP RLEN               */
         MVC   GTPRCDLN(2,@09),@CH00558                            0370
*               CALL HMASMGTA(HMASMGTP);/* HAVE FUNCTION PERFORMED   */
         ST    @09,@AL00001                                        0371
         L     @15,@CV01465                                        0371
         LA    @01,@AL00001                                        0371
         BALR  @14,@15                                             0371
*             END;                                                 0372
*             IF GTPRETRN=GTPEOF THEN/* IF END OF FILE THEN          */
         L     @09,@PC00001                                        0373
         L     @01,RECXGRFP(,@09)                                  0373
         CLI   GTPRETRN(@01),4                                     0373
         BNE   @RF00373                                            0373
*               EOFSW=ON;           /* POST EOF SW                   */
         OI    EOFSW,B'00100000'                                   0374
*           END;                                                   0375
@RF00373 DS    0H                                                  0376
*       END;                        /* SELECT MEMBER STMTS BUILT FOR
*                                      ALL ELEMENTS IN RELFILE       */
@RF00365 DS    0H                                                  0376
@DE00334 L     @09,@PC00001                                        0376
         L     @01,RECXGRFP(,@09)                                  0376
         L     @01,GTPBUFAD(,@01)                                  0376
         CLC   ABSFSEQ(2),GRFFSEQ(@01)                             0376
         BNE   @DC00334                                            0376
         TM    EOFSW,B'00100000'                                   0376
         BNZ   @DC00334                                            0376
         L     @09,@PC00002                                        0376
         ICM   @08,15,ELEMRC(@09)                                  0376
         BZ    @DL00334                                            0376
@DC00334 DS    0H                                                  0377
*       IF ELEMRC=0                 /* PROCESSING SUCCESSFUL         */
*         THEN                                                     0377
         L     @09,@PC00002                                        0377
         ICM   @08,15,ELEMRC(@09)                                  0377
         BNZ   @RF00377                                            0377
*         DO;                                                      0378
*                                                                  0378
*           /*********************************************************/
*           /*                                                       */
*           /* FINISHED PROCESSING MEMBERS FOR "CURRENT" FILE ...    */
*           /* EITHER A NEW RELFILE WAS DETECTED, A NEW-SYSMOD WAS   */
*           /* ENCOUNTERED OR THE END OF THE RELFILE GTA FILE WAS    */
*           /* ENCOUNTERED                                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0379
*           IF EOFSW=OFF THEN       /* IF NOT END OF FILE THEN       */
         TM    EOFSW,B'00100000'                                   0379
         BNZ   @RF00379                                            0379
*             DO;                   /* CHECK IF NEW SYSMOD FOUND     */
*               IF GRFSM#^=CURSYSM# THEN/* IF SYSMODS DO NOT MATCH   */
         L     @04,@PC00001                                        0381
         L     @04,RECXGRFP(,@04)                                  0381
         L     @04,GTPBUFAD(,@04)                                  0381
         CLC   GRFSM#(7,@04),CURSYSM#                              0381
         BE    @RF00381                                            0381
*                 NEWSYSM=ON;       /* A NEW SYSMOD FOUND IN GTA     */
         OI    NEWSYSM,B'01000000'                                 0382
*             END;                                                 0383
@RF00381 DS    0H                                                  0384
*           IF SCDCOL^=BLANK THEN   /* IF CURRENT CARD CONTAINS      */
@RF00379 CLI   SCDCOL,C' '                                         0384
         BE    @RF00384                                            0384
*             DO;                   /* DATA THEN PUT OUT CARD        */
*               COLPTR=COLPTR-      /* BACK UP TO COMMA              */
*                   LENGTH(CARDCLOS);/* AFTER LAST RIGHT PAREN       */
         BCTR  COLPTR,0                                            0386
         BCTR  COLPTR,0                                            0386
*               CARDCLOS=') ';      /* CLOSE PARAMETER LIST          */
*                                                                  0387
         MVC   CARDCLOS(2,COLPTR),@CC01636                         0387
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE LAST COPY "SELECT MEMBER" STMT. TO SYSUT1   */
*               /* FILE                                              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0388
*               DO;                 /* HMASMRIO F(IOPWRITE)IOP((RECXI
*                                      OPG))DSID(IOPSCR1)BUFFER(SCARD
*                                      )                             */
*                 IOPPTR=(RECXIOPG);/* SET UP IOP ADDRESS            */
         L     @09,@PC00001                                        0389
         L     IOPPTR,RECXIOPG(,@09)                               0389
*                 IOPFUNCT=IOPWRITE;/* SET UP FUNCTION CODE          */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0390
*                 IOPDSID=IOPSCR1;  /* SET UP DSN CODE               */
         MVI   IOPDSID(IOPPTR),X'03'                               0391
*                 IOPBUFAD=ADDR(SCARD);/* SET BUFFER ADDRESS         */
         LA    @05,SCARD                                           0392
         ST    @05,IOPBUFAD(,IOPPTR)                               0392
*                 CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED       */
         ST    IOPPTR,@AL00001                                     0393
         L     @15,@CV01464                                        0393
         LA    @01,@AL00001                                        0393
         BALR  @14,@15                                             0393
*               END;                                               0394
*               ELEMRC=IOPRETRN;    /* SAVE RETURN CODE              */
         L     @05,@PC00002                                        0395
         SLR   @09,@09                                             0395
         IC    @09,IOPRETRN(,IOPPTR)                               0395
         ST    @09,ELEMRC(,@05)                                    0395
*               SCDATA=' ';         /* BLANK OUT OLD DATA            */
         MVI   SCDATA+1,C' '                                       0396
         MVC   SCDATA+2(60),SCDATA+1                               0396
         MVI   SCDATA,C' '                                         0396
*             END;                                                 0397
*                                                                  0397
*           /*********************************************************/
*           /*                                                       */
*           /* CLOSE SYSUT1 FILE                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0398
*           DO;                     /* HMASMRIO F(IOPCLOSE)IOP((RECXI
*                                      OPG))DSID(IOPSCR1)            */
@RF00384 DS    0H                                                  0399
*             IOPPTR=(RECXIOPG);    /* SET UP IOP ADDRESS            */
         L     @09,@PC00001                                        0399
         L     IOPPTR,RECXIOPG(,@09)                               0399
*             IOPFUNCT=IOPCLOSE;    /* SET UP FUNCTION CODE          */
         MVI   IOPFUNCT(IOPPTR),X'50'                              0400
*             IOPDSID=IOPSCR1;      /* SET UP DSN CODE               */
         MVI   IOPDSID(IOPPTR),X'03'                               0401
*             CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED           */
         ST    IOPPTR,@AL00001                                     0402
         L     @15,@CV01464                                        0402
         LA    @01,@AL00001                                        0402
         BALR  @14,@15                                             0402
*           END;                                                   0403
*           ELEMRC=MAX(ELEMRC,IOPRETRN);/* SAVE RETURN CODE          */
         L     @05,@PC00002                                        0404
         L     @09,ELEMRC(,@05)                                    0404
         SLR   @08,@08                                             0404
         IC    @08,IOPRETRN(,IOPPTR)                               0404
         CR    @09,@08                                             0404
         BNL   *+6
         LR    @09,@08                                             0404
         ST    @09,ELEMRC(,@05)                                    0404
*         END;                                                     0405
*     END;                          /* "COPY" SELECT MEMBER STMTS  0406
*                                      BUILT                         */
@RF00377 DS    0H                                                  0407
*   RETURN CODE(ELEMRC);                                           0407
@RF00298 L     @05,@PC00002                                        0407
         L     @15,ELEMRC(,@05)                                    0407
         L     @14,@SA00002                                        0407
         LM    @00,@03,@SA00002+8                                  0407
         LM    @05,@12,@SA00002+24                                 0407
         BR    @14                                                 0407
*   END ELEMPROC;                                                  0408
*                                                                  0409
*/********************************************************************/
*/*                                                                  */
*/*   COPYFILE - COPY MEMBERS FROM ONE SMPPTFIN RELFILE TO SMPTLIB   */
*/*              DATASET                                             */
*/*                                                                  */
*/*            - ALLOCATE DATASET ON SMPTLIB VOLUME                  */
*/*                                                                  */
*/*              * IF UNABLE TO ALLOCATE TLIB FILE FOR THIS          */
*/*                RELFILE, THEN RETURN TO THE CALLER AS             */
*/*                SUBSEQUENT ALLOCATIONS WILL ALSO FAIL.            */
*/*                                                                  */
*/*            - POSITION SMPPTFIN TO APPROPRIATE FILE (DSNAME)      */
*/*                                                                  */
*/*            - LOAD SMPPFIN DATASET TO SMPTLIB                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0409
*COPYFILE:                                                         0409
*   PROC(COPYRC);                                                  0409
COPYFILE STM   @14,@03,@SA00003                                    0409
         STM   @05,@12,@SA00003+24                                 0409
         MVC   @PC00003(4),0(@01)                                  0409
*   DCL                                                            0410
*     COPYRC FIXED(31);             /* COPYFILE RETURN CODE PARAMETER*/
*   DCL                                                            0411
*     1 COPYFFLG BIT(8),            /* LOCAL FLAGS                   */
*      2 COPYFALC BIT(1),           /* TLIB DATASET ALLOCATED        */
*      2 COPYFPOS BIT(1),           /* PTFIN POSITIONED TO FILE      */
*      2 * BIT(6);                  /* UNUSED                        */
*   COPYRC=0;                       /* CLEAR RETURN CODE PARAMETER   */
         L     @05,@PC00003                                        0412
         SLR   @09,@09                                             0412
         ST    @09,COPYRC(,@05)                                    0412
*   COPYFFLG=''B;                   /* CLEAR LOCAL FLAGS             */
         MVI   COPYFFLG,X'00'                                      0413
*   IOPPTR=RECXIOPP;                /* POINT TO PTS IOP              */
         L     @09,@PC00001                                        0414
         L     IOPPTR,RECXIOPP(,@09)                               0414
*                                                                  0415
*   /*****************************************************************/
*   /*                                                               */
*   /* FORM SMPTLIB DATASET NAME                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0415
*   SPLPMAD=ADDR(SPLPDSN);          /* POINT TO PARAMETER LIST       */
         L     @05,SPLPMAD                                         0415
         ST    @05,SPLPMAD                                         0415
*   SPLFUNCT=SPLBDDSN;              /* INDICATE DSN TO BE BUILT      */
         MVI   SPLFUNCT,X'05'                                      0416
*   SPLIPFX=IOPPTPFX;               /* SET UP PREFIX                 */
         MVC   SPLIPFX(26,@05),IOPPTPFX(IOPPTR)                    0417
*   SPLISMD=CURSYSM#;               /* SET UP CURRENT SYSMOD         */
         MVC   SPLISMD(7,@05),CURSYSM#                             0418
*   SPLIFIL=TLIBDSS#;               /* SET UP BINARY RELFILE         */
         MVC   SPLIFIL(2,@05),TLIBDSS#                             0419
*   CALL HMASMSUB(HMASMSPL);        /* FORM TLIB DATASET NAME        */
         L     @15,@CV01467                                        0420
         LA    @01,@AL00420                                        0420
         BALR  @14,@15                                             0420
*   IOPPTR=RECXIOPG;                /* POINT TO GENERAL IOP          */
*                                                                  0421
         L     @09,@PC00001                                        0421
         L     IOPPTR,RECXIOPG(,@09)                               0421
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TLIB FILE TYPE BASED UPON ELEMENT TYPES IN RELFILE        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0422
*   IOPDTYPE=''B;                   /* CLEAR TLIB FILE TYPE          */
         MVI   IOPDTYPE(IOPPTR),X'00'                              0422
*   IF DMOD=ON                      /* ++MOD FOUND                   */
*     THEN                                                         0423
         TM    DMOD,B'10000000'                                    0423
         BNO   @RF00423                                            0423
*     IOPDMOD=ON;                   /* SET MOD-TYPE FILE             */
         OI    IOPDMOD(IOPPTR),B'00010000'                         0424
*   IF DSRC=ON                      /* ++SRC FOUND                   */
*     THEN                                                         0425
@RF00423 TM    DSRC,B'00100000'                                    0425
         BNO   @RF00425                                            0425
*     IOPDSRC=ON;                   /* SET SRC-TYPE FILE             */
         OI    IOPDSRC(IOPPTR),B'01000000'                         0426
*   IF DMAC=ON                      /* ++MAC FOUND                   */
*     THEN                                                         0427
@RF00425 TM    DMAC,B'01000000'                                    0427
         BNO   @RF00427                                            0427
*     IOPDMAC=ON;                   /* SET MAC-TYPE FILE             */
         OI    IOPDMAC(IOPPTR),B'10000000'                         0428
*   IF DJCL=ON                      /* ++JCLIN FOUND                 */
*     THEN                                                         0429
@RF00427 TM    DJCL,B'00010000'                                    0429
         BNO   @RF00429                                            0429
*     IOPDJCL=ON;                   /* SET JCLIN-TYPE FILE           */
*                                                                  0430
         OI    IOPDJCL(IOPPTR),B'00100000'                         0430
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLOCATE SMPTLIB DATASET FOR THIS RELFILE                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0431
*   IOPSPACE=RECXDSPC;              /* SET UP SPACE PARAMETER        */
@RF00429 L     @05,@PC00001                                        0431
         MVC   IOPSPACE(6,IOPPTR),RECXDSPC(@05)                    0431
*   IOPFUNCT=IOPALC;                /* ALLOC FUNCTION                */
         MVI   IOPFUNCT(IOPPTR),X'0D'                              0432
*   IOPDSID=IOPLRF;                 /* TLIB DATASET                  */
         MVI   IOPDSID(IOPPTR),X'20'                               0433
*   IOPDDNAM='SMPTLIB';             /* DDNAME FOR TLIB VOLUME(S)     */
         MVI   IOPDDNAM+7(IOPPTR),C' '                             0434
         MVC   IOPDDNAM(7,IOPPTR),@CC01647                         0434
*   IOPDSN=SPLODSN;                 /* TLIB DSN FORMED ABOVE         */
         L     @05,SPLPMAD                                         0435
         MVC   IOPDSN(44,IOPPTR),SPLODSN(@05)                      0435
*   CALL HMASMIO(HMASMIOP);         /* ALLOCATE THE TLIB DATASET     */
         ST    IOPPTR,@AL00001                                     0436
         L     @15,@CV01464                                        0436
         LA    @01,@AL00001                                        0436
         BALR  @14,@15                                             0436
*   COPYRC=MAX(COPYRC,IOPRETRN);    /* MAINTAIN MAX RETURN CODE      */
         L     @05,@PC00003                                        0437
         L     @09,COPYRC(,@05)                                    0437
         SLR   @08,@08                                             0437
         IC    @08,IOPRETRN(,IOPPTR)                               0437
         CR    @09,@08                                             0437
         BNL   *+6
         LR    @09,@08                                             0437
         ST    @09,COPYRC(,@05)                                    0437
*   IF IOPRETRN>=STOPPTF            /* TLIB ALLOCATION ERROR         */
*     THEN                                                         0438
         CLI   IOPRETRN(IOPPTR),8                                  0438
         BL    @RF00438                                            0438
*     DO;                                                          0439
*                                                                  0439
*       /*************************************************************/
*       /*                                                           */
*       /* ALLOCATION FAILED ... SET GSMLERR IN SUMMARY RECORD       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0440
*       GSMLERR=ON;                 /* RELFILE PROCESSING ERROR      */
         L     @05,@PC00001                                        0440
         L     @05,RECXGSMP(,@05)                                  0440
         L     @01,GTPBUFAD(,@05)                                  0440
         OI    GSMLERR(@01),B'00000010'                            0440
*       RECXGSMP->GTPFUNCT=GTPADD;  /* PUT RECORD BACK TO FILE       */
         MVI   GTPFUNCT(@05),X'04'                                 0441
*       CALL HMASMGTA(RECXGSMP->HMASMGTP);                         0442
         ST    @05,@AL00001                                        0442
         L     @15,@CV01465                                        0442
         LA    @01,@AL00001                                        0442
         BALR  @14,@15                                             0442
*       IF CCATLBP=OFF              /* TLIB DD NOT PRESENT           */
*         THEN                                                     0443
         TM    CCATLBP(CCAPTR),B'10000000'                         0443
         BNZ   @RF00443                                            0443
*         COPYRC=MAX(COPYRC,STOPFUNC);/* MAKE SURE RELFILE PROCESSING
*                                      STOPS                         */
         L     @05,@PC00003                                        0444
         L     @09,COPYRC(,@05)                                    0444
         LA    @08,12                                              0444
         CR    @09,@08                                             0444
         BNL   *+6
         LR    @09,@08                                             0444
         ST    @09,COPYRC(,@05)                                    0444
*     END;                                                         0445
*   ELSE                                                           0446
*     COPYFALC=ON;                  /* TLIB ALLOCATION SUCCESSFUL    */
         B     @RC00438                                            0446
@RF00438 OI    COPYFALC,B'10000000'                                0446
*   IF COPYFALC=ON                  /* TLIB ALLOCATION SUCCESSFUL    */
*     THEN                          /*                               */
@RC00438 TM    COPYFALC,B'10000000'                                0447
         BNO   @RF00447                                            0447
*     DO;                                                          0448
*                                                                  0448
*       /*************************************************************/
*       /*                                                           */
*       /* POSITION TAPE TO PROPER FILE                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0449
*       DO;                         /* HMASMRIO F(IOPPOSI)IOP((RECXIO
*                                      PG))DSID(IOPPTFIN)DSN(TAPEDSN)
*                                      SEQ(TAPEASEQ)                 */
*         IOPPTR=(RECXIOPG);        /* SET UP IOP ADDRESS            */
         L     @09,@PC00001                                        0450
         L     IOPPTR,RECXIOPG(,@09)                               0450
*         IOPFUNCT=IOPPOSI;         /* SET UP FUNCTION CODE          */
         MVI   IOPFUNCT(IOPPTR),X'02'                              0451
*         IOPDSID=IOPPTFIN;         /* SET UP DSN CODE               */
         MVI   IOPDSID(IOPPTR),X'0A'                               0452
*         IOPSEQNO=TAPEASEQ;        /* SET UP SEQ                    */
         MVC   IOPSEQNO(2,IOPPTR),TAPEASEQ                         0453
*         IOPDSN=TAPEDSN;           /* SET UP DSN                    */
         MVC   IOPDSN(44,IOPPTR),TAPEDSN                           0454
*         CALL HMASMIO(HMASMIOP);   /* HAVE I/O PERFORMED            */
         ST    IOPPTR,@AL00001                                     0455
         L     @15,@CV01464                                        0455
         LA    @01,@AL00001                                        0455
         BALR  @14,@15                                             0455
*       END;                                                       0456
*       COPYRC=MAX(COPYRC,IOPRETRN);/* MAINTAIN MAX RETURN CODE      */
         L     @05,@PC00003                                        0457
         L     @09,COPYRC(,@05)                                    0457
         SLR   @08,@08                                             0457
         IC    @08,IOPRETRN(,IOPPTR)                               0457
         CR    @09,@08                                             0457
         BNL   *+6
         LR    @09,@08                                             0457
         ST    @09,COPYRC(,@05)                                    0457
*       IF IOPRETRN>IOPGOOD THEN    /* IF PTFIN CANNOT BE OPENED     */
         CLI   IOPRETRN(IOPPTR),0                                  0458
         BNH   @RF00458                                            0458
*         DO;                       /* POST LOAD ERROR IN SUMMARY    */
*                                                                  0459
*           /*********************************************************/
*           /*                                                       */
*           /* POSITION FAILED ... SET GSMLERR IN SUMMARY RECORD     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0460
*           GSMLERR=ON;             /* RELFILE PROCESSING ERROR      */
         L     @05,@PC00001                                        0460
         L     @05,RECXGSMP(,@05)                                  0460
         L     @01,GTPBUFAD(,@05)                                  0460
         OI    GSMLERR(@01),B'00000010'                            0460
*           RECXGSMP->GTPFUNCT=GTPADD;/* PUT RECORD BACK TO FILE     */
         MVI   GTPFUNCT(@05),X'04'                                 0461
*           CALL HMASMGTA(RECXGSMP->HMASMGTP);                     0462
         ST    @05,@AL00001                                        0462
         L     @15,@CV01465                                        0462
         LA    @01,@AL00001                                        0462
         BALR  @14,@15                                             0462
*         END;                                                     0463
*       ELSE                                                       0464
*         COPYFPOS=ON;              /* PTFIN POSITION SUCCESSFUL     */
         B     @RC00458                                            0464
@RF00458 OI    COPYFPOS,B'01000000'                                0464
*     END;                                                         0465
@RC00458 DS    0H                                                  0466
*   IF COPYFALC=ON                  /* TLIB ALLOCATION SUCCESSFUL    */
*       &COPYFPOS=ON                /* PTFIN POSITION SUCCESSFUL     */
*     THEN                                                         0466
@RF00447 TM    COPYFALC,B'11000000'                                0466
         BNO   @RF00466                                            0466
*     DO;                                                          0467
*                                                                  0467
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP STAE PARMS                                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0468
*       SAVRVANM=RVAEPRNM;          /* SAVE RVA PROC NM              */
         L     @05,CCARVAD(,CCAPTR)                                0468
         MVC   SAVRVANM(8),RVAEPRNM(@05)                           0468
*       RVAEPRNM=CCACPYNM;          /* COPY PROC NAME                */
*                                                                  0469
         L     @09,CCABLDLP(,CCAPTR)                               0469
         MVC   RVAEPRNM(8,@05),CCACPYNM(@09)                       0469
*       /*************************************************************/
*       /*                                                           */
*       /* INVOKE "COPY" TO COPY RELFILE TO TLIB                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0470
*       RTNREG=CCACOPY;             /* GET PROPER NAME FOR "COPY"    */
         L     RTNREG,CCACOPY(,@09)                                0470
*       GEN(LINK DE=(RTNREG),PARAM=(0,ALTDD),VL=1);/* COPY FILE      */
         LINK DE=(RTNREG),PARAM=(0,ALTDD),VL=1
*       RVAEPRNM=SAVRVANM;          /* RESTORE RVA NAME              */
         L     @05,CCARVAD(,CCAPTR)                                0472
         MVC   RVAEPRNM(8,@05),SAVRVANM                            0472
*       IF RTNCODE>CCACPYRC         /* CHECK AGAINST USER-SPECIFIED
*                                      RETURN CODE                   */
*         THEN                                                     0473
         L     @05,CCABLDLP(,CCAPTR)                               0473
         SLR   @09,@09                                             0473
         IC    @09,CCACPYRC(,@05)                                  0473
         CR    RTNCODE,@09                                         0473
         BNH   @RF00473                                            0473
*         DO;                                                      0474
*                                                                  0474
*           /*********************************************************/
*           /*                                                       */
*           /* "COPY" FAILED ... ISSUE HMA351I ... SET GSMRLF FLAG   */
*           /* OFF                                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0475
*           COPYRC=MAX(COPYRC,STOPPTF);/* MAINTAIN MAX RETURN CODE   */
         L     @09,@PC00003                                        0475
         L     @08,COPYRC(,@09)                                    0475
         LA    @07,8                                               0475
         CR    @08,@07                                             0475
         BNL   *+6
         LR    @08,@07                                             0475
         ST    @08,COPYRC(,@09)                                    0475
*           FIX31=RTNCODE;          /* SAVE RETURN CODE FOR CONVERT  */
         LR    FIX31,RTNCODE                                       0476
*           GSMLERR=ON;             /* POST LOAD ERROR               */
         L     @09,@PC00001                                        0477
         L     @09,RECXGSMP(,@09)                                  0477
         L     @08,GTPBUFAD(,@09)                                  0477
         OI    GSMLERR(@08),B'00000010'                            0477
*           GSMRLFL=OFF;            /* RESET LOADED IN SUMMARY FILE  */
*           GSMRECVD=OFF;           /* RESET RECEIVED IN SUMMARY     */
*                                                                  0479
         NI    GSMRLFL(@08),B'01011111'                            0479
*           /*********************************************************/
*           /*                                                       */
*           /* PUT SUMMARY RECORD TO SUMMARY GTA FILE                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0480
*           RECXGSMP->GTPFUNCT=GTPADD;/* PUT RECORD BACK TO FILE     */
         MVI   GTPFUNCT(@09),X'04'                                 0480
*           CALL HMASMGTA(RECXGSMP->HMASMGTP);                     0481
         ST    @09,@AL00001                                        0481
         L     @15,@CV01465                                        0481
         LA    @01,@AL00001                                        0481
         BALR  @14,@15                                             0481
*           MAXCOPY=MAX(MAXCOPY,RTNCODE);/* MAINTAIN MAX COPY RET. 0482
*                                      CODE                          */
         L     @09,MAXCOPY                                         0482
         CR    @09,RTNCODE                                         0482
         BNL   *+6
         LR    @09,RTNCODE                                         0482
         ST    @09,MAXCOPY                                         0482
*           CVD(FIX31,PKDDEC);      /* CONVERT RTN CODE TO PKD DEC   */
         CVD   FIX31,PKDDEC                                        0483
*           UNPK(EBCDIC,PKDDEC);    /* CONVERT PKD DEC TO EBCDIC     */
         UNPK  EBCDIC(8),PKDDEC(8)                                 0484
*           MVZ(EBCDIC(8),EBCDIC(7));/* FIX UP LOW-ORDER DIGIT       */
         MVZ   EBCDIC+7(1),EBCDIC+6                                0485
*           MGPCLEAR=''B;           /* CLEAR ALL MESSAGE NUMBERS     */
         XC    MGPCLEAR(6),MGPCLEAR                                0486
*           MGPFLAGS=''B;           /* CLEAR ALL FLAGS               */
         XC    MGPFLAGS(2),MGPFLAGS                                0487
*           MGPMGNO1=HMA351I;       /* PRIMARY MESSAGE               */
         SLR   @05,@05                                             0488
         IC    @05,HMA351I                                         0488
         STH   @05,MGPMGNO1                                        0488
*           MGPMGNO2=PART102;       /* SECONDARY MESSAGE PART        */
         SLR   @05,@05                                             0489
         IC    @05,PART102                                         0489
         STH   @05,MGPMGNO2                                        0489
*           MGPPRINT=ON;            /* MESSAGE TO SMPOUT             */
*           MGPHLDS=ON;             /* MESSAGE TO SMPLOG             */
         OI    MGPPRINT,B'10010000'                                0491
*           MGPVARPT(1)=ADDR(CURSYSM#);/* POINT TO SYSMOD NAME       */
         LA    @05,CURSYSM#                                        0492
         ST    @05,MGPVARPT                                        0492
*           MGPVARPT(2)=ADDR(EBCDIC(7));/* POINT TO LAST TWO DIGITS
*                                      OF RC                         */
         LA    @05,EBCDIC+6                                        0493
         ST    @05,MGPVARPT+4                                      0493
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0494
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */
         L     @15,@CV01466                                        0495
         LA    @01,@AL00495                                        0495
         BALR  @14,@15                                             0495
*         END;                                                     0496
*       ELSE                        /* IF LOADED THEN POST           */
*         DO;                       /* GRFLOADD IN RELFILE RECORDS   */
*                                                                  0497
         B     @RC00473                                            0497
@RF00473 DS    0H                                                  0498
*           /*********************************************************/
*           /*                                                       */
*           /* "COPY" SUCCESSFUL ... ONE RELFILE SUCCESSFULLY LOADED */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0498
*                                                                  0498
*           /*********************************************************/
*           /*                                                       */
*           /* POST RECORDS IN RELFILE GTA FILE TO INDICATE MEMBERS  */
*           /* LOADED                                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0498
*           RECXGRFP->GTPFUNCT=GTPSTRTN;/* RESTART AT FIRST ELEMENT
*                                      FOR RELFILE JUST LOADED       */
         L     @05,@PC00001                                        0498
         L     @05,RECXGRFP(,@05)                                  0498
         MVI   GTPFUNCT(@05),X'06'                                 0498
*           RECXGRFP->GTPRESTR=RELFREST;/* FIRST ELEMENT RESTART DATA*/
         MVC   GTPRESTR(10,@05),RELFREST                           0499
*           CALL HMASMGTA(RECXGRFP->HMASMGTP);                     0500
         ST    @05,@AL00001                                        0500
         L     @15,@CV01465                                        0500
         LA    @01,@AL00001                                        0500
         BALR  @14,@15                                             0500
*           RECXGRFP->GTPFUNCT=GTPGETN;/* GET FIRST RELFILE RECORD   */
         L     @05,@PC00001                                        0501
         L     @05,RECXGRFP(,@05)                                  0501
         MVI   GTPFUNCT(@05),X'08'                                 0501
*           CALL HMASMGTA(RECXGRFP->HMASMGTP);                     0502
*                                                                  0502
         ST    @05,@AL00001                                        0502
         L     @15,@CV01465                                        0502
         LA    @01,@AL00001                                        0502
         BALR  @14,@15                                             0502
*           /*********************************************************/
*           /*                                                       */
*           /* GO THRU ALL RECORDS IN RELFILE GTA FILE FOR MEMBERS   */
*           /* LOADED                                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0503
*           DO WHILE RECXGRFP->GTPRETRN^=GTPEOF/* NOT END-OF-FILE    */
*                 &ABSFSEQ=GRFFSEQ; /* FILE JUST LOADED              */
         B     @DE00503                                            0503
@DL00503 DS    0H                                                  0504
*             GRFLOADD=ON;          /* POST LOADED FLAG              */
         L     @05,@PC00001                                        0504
         L     @05,RECXGRFP(,@05)                                  0504
         L     @01,GTPBUFAD(,@05)                                  0504
         OI    GRFLOADD(@01),B'01000000'                           0504
*             RECXGRFP->GTPFUNCT=GTPADD;/* PUT RECORD BACK TO GTA  0505
*                                      FILE                          */
         MVI   GTPFUNCT(@05),X'04'                                 0505
*             CALL HMASMGTA(RECXGRFP->HMASMGTP);                   0506
         ST    @05,@AL00001                                        0506
         L     @15,@CV01465                                        0506
         LA    @01,@AL00001                                        0506
         BALR  @14,@15                                             0506
*             RECXGRFP->GTPFUNCT=GTPGETN;/* GET NEXT RECORD          */
         L     @05,@PC00001                                        0507
         L     @05,RECXGRFP(,@05)                                  0507
         MVI   GTPFUNCT(@05),X'08'                                 0507
*             CALL HMASMGTA(RECXGRFP->HMASMGTP);                   0508
         ST    @05,@AL00001                                        0508
         L     @15,@CV01465                                        0508
         LA    @01,@AL00001                                        0508
         BALR  @14,@15                                             0508
*           END;                                                   0509
@DE00503 L     @05,@PC00001                                        0509
         L     @05,RECXGRFP(,@05)                                  0509
         CLI   GTPRETRN(@05),4                                     0509
         BE    @DC00503                                            0509
         L     @05,GTPBUFAD(,@05)                                  0509
         CLC   ABSFSEQ(2),GRFFSEQ(@05)                             0509
         BE    @DL00503                                            0509
@DC00503 DS    0H                                                  0510
*         END;                                                     0510
*       IF COPYFALC=ON              /* TLIB DATASET ALLOCATED        */
*         THEN                                                     0511
@RC00473 TM    COPYFALC,B'10000000'                                0511
         BNO   @RF00511                                            0511
*         DO;                                                      0512
*                                                                  0512
*           /*********************************************************/
*           /*                                                       */
*           /* FREE UP ALLOCATED SMPTLIB DATASET                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0513
*           DO;                     /* HMASMRIO F(IOPDALC)IOP((RECXIO
*                                      PG))DSID(IOPLRF)DSN(SPLODSN)  */
*             IOPPTR=(RECXIOPG);    /* SET UP IOP ADDRESS            */
         L     @09,@PC00001                                        0514
         L     IOPPTR,RECXIOPG(,@09)                               0514
*             IOPFUNCT=IOPDALC;     /* SET UP FUNCTION CODE          */
         MVI   IOPFUNCT(IOPPTR),X'0E'                              0515
*             IOPDSID=IOPLRF;       /* SET UP DSN CODE               */
         MVI   IOPDSID(IOPPTR),X'20'                               0516
*             IOPDDNAM='SMPTLIB';   /* SET UP DD NAME                */
         MVI   IOPDDNAM+7(IOPPTR),C' '                             0517
         MVC   IOPDDNAM(7,IOPPTR),@CC01647                         0517
*             IOPDSN=SPLODSN;       /* SET UP DSN                    */
         L     @05,SPLPMAD                                         0518
         MVC   IOPDSN(44,IOPPTR),SPLODSN(@05)                      0518
*             CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED           */
         ST    IOPPTR,@AL00001                                     0519
         L     @15,@CV01464                                        0519
         LA    @01,@AL00001                                        0519
         BALR  @14,@15                                             0519
*           END;                                                   0520
*         END;                                                     0521
*     END;                                                         0522
@RF00511 DS    0H                                                  0523
*   RETURN CODE(COPYRC);            /* RETURN TO CALLER              */
@RF00466 L     @05,@PC00003                                        0523
         L     @15,COPYRC(,@05)                                    0523
         L     @14,@SA00003                                        0523
         LM    @00,@03,@SA00003+8                                  0523
         LM    @05,@12,@SA00003+24                                 0523
         BR    @14                                                 0523
*   END COPYFILE;                                                  0524
*                                                                  0525
*/********************************************************************/
*/*                                                                  */
*/*   PUTSYSM  - POST FINAL STATUS IN RECEIVE SUMMARY GTA FILE       */
*/*              RECORD AND RE-WRITE THE PTS SYSMOD ENTRY WITH       */
*/*              THE ERROR FLAG OFF.                                 */
*/*                                                                  */
*/*              - ISSUE HMASM344I/PART085: RELFILE ELEMENTS LOADED. */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0525
*PUTSYSM:                                                          0525
*   PROC(PUTSMRC);                                                 0525
PUTSYSM  STM   @14,@03,@SA00004                                    0525
         STM   @05,@12,@SA00004+24                                 0525
         MVC   @PC00004(4),0(@01)                                  0525
*   DCL                                                            0526
*     PUTSMRC FIXED(31);            /* RETURN CODE PARAMETER         */
*   PUTSMRC=0;                      /* CLEAR RETURN CODE PARAMETER   */
*                                                                  0527
         L     @09,@PC00004                                        0527
         SLR   @08,@08                                             0527
         ST    @08,PUTSMRC(,@09)                                   0527
*   /*****************************************************************/
*   /*                                                               */
*   /* PUT SUMMARY RECORD FOR THIS SYSMOD TO GTA SUMMARY FILE        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0528
*   GSMRECVD=ON;                    /* SYSMOD SUCCESSFULLY RECEIVED  */
*   GSMRLFL=ON;                     /* RELFILE ELEMENTS LOADED       */
         L     @09,@PC00001                                        0529
         L     @09,RECXGSMP(,@09)                                  0529
         L     @01,GTPBUFAD(,@09)                                  0529
         OI    GSMRECVD(@01),B'10100000'                           0529
*   RECXGSMP->GTPFUNCT=GTPADD;      /* PUT RECORD BACK TO GTA FILE   */
         MVI   GTPFUNCT(@09),X'04'                                 0530
*   CALL HMASMGTA(RECXGSMP->HMASMGTP);                             0531
*                                                                  0531
         ST    @09,@AL00001                                        0531
         L     @15,@CV01465                                        0531
         LA    @01,@AL00001                                        0531
         BALR  @14,@15                                             0531
*   /*****************************************************************/
*   /*                                                               */
*   /* RELFILES LOADED SUCCESSFULLY ... ISSUE HMA394I                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0532
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */
         XC    MGPCLEAR(6),MGPCLEAR                                0532
*   MGPFLAGS=''B;                   /* CLEAR ALL FLAGS               */
         XC    MGPFLAGS(2),MGPFLAGS                                0533
*   MGPMGNO1=HMA394I;               /* PRIMARY MESSAGE               */
         SLR   @09,@09                                             0534
         IC    @09,HMA394I                                         0534
         STH   @09,MGPMGNO1                                        0534
*   MGPVARPT(1)=ADDR(CURSYSM#);     /* SYSMOD NAME                   */
         LA    @09,CURSYSM#                                        0535
         ST    @09,MGPVARPT                                        0535
*   IF MAXCOPY>0 THEN                                              0536
         L     @09,MAXCOPY                                         0536
         LTR   @09,@09                                             0536
         BNP   @RF00536                                            0536
*     DO;                                                          0537
*                                                                  0537
*       /*************************************************************/
*       /*                                                           */
*       /* NON-ZERO COPY RETURN CODE ENCOUNTERED ... SET UP PART103  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0538
*       FIX31=MAXCOPY;              /* MAXIMUM COPY RETURN CODE      */
         LR    FIX31,@09                                           0538
*       CVD(FIX31,PKDDEC);          /* CONVERT RTN CODE TO PKD DEC   */
         CVD   FIX31,PKDDEC                                        0539
*       UNPK(EBCDIC,PKDDEC);        /* CONVERT PKD DEC TO EBCDIC     */
         UNPK  EBCDIC(8),PKDDEC(8)                                 0540
*       MVZ(EBCDIC(8),EBCDIC(7));   /* FIX UP LOW-ORDER DIGIT        */
         MVZ   EBCDIC+7(1),EBCDIC+6                                0541
*       MGPMGNO3=PART103;           /* SECONDARY MESSAGE PART        */
         SLR   @09,@09                                             0542
         IC    @09,PART103                                         0542
         STH   @09,MGPMGNO3                                        0542
*       MGPVARPT(2)=ADDR(EBCDIC(7));/* POINT TO LAST 2 DIGITS        */
         LA    @09,EBCDIC+6                                        0543
         ST    @09,MGPVARPT+4                                      0543
*     END;                                                         0544
*   MGPPRINT=ON;                    /* MESSAGE TO SMPOUT             */
@RF00536 DS    0H                                                  0546
*   MGPHLDS=ON;                     /* MESSAGE TO SMPLOG             */
         OI    MGPPRINT,B'10010000'                                0546
*   MGPTYPE=MGPINFO;                /* INFORMATIONAL MESSAGE         */
         MVI   MGPTYPE,X'01'                                       0547
*   CALL HMASMMSG(HMASMMGP);        /* ISSUE MESSAGE                 */
*                                                                  0548
         L     @15,@CV01466                                        0548
         LA    @01,@AL00548                                        0548
         BALR  @14,@15                                             0548
*   /*****************************************************************/
*   /*                                                               */
*   /* RE-WRITE PTS SYSMOD ENTRY WITH "IN-ERROR" FLAG OFF            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0549
*   IOPPTR=RECXIOPP;                /* SET UP IOP POINTER FOR PTS    */
         L     @09,@PC00001                                        0549
         L     IOPPTR,RECXIOPP(,@09)                               0549
*   IOPERROR=OFF;                   /* RESET ERROR FLAG IN PTS       */
         NI    IOPERROR(IOPPTR),B'11101111'                        0550
*   DO;                             /* HMASMRIO F(IOPSTOWR)DSID(IOPPT
*                                      S)NAME(CURSYSM#)TYPE(IOPSMD)  */
*     IOPFUNCT=IOPSTOWR;            /* SET UP FUNCTION CODE          */
         MVI   IOPFUNCT(IOPPTR),X'54'                              0552
*     IOPDSID=IOPPTS;               /* SET UP DSN CODE               */
         MVI   IOPDSID(IOPPTR),X'06'                               0553
*     IOPNAME=CURSYSM#;             /* SET UP NAME                   */
         MVI   IOPNAME+7(IOPPTR),C' '                              0554
         MVC   IOPNAME(7,IOPPTR),CURSYSM#                          0554
*     IOPTYPE=IOPSMD;               /* SET UP TYPE                   */
         MVI   IOPTYPE(IOPPTR),X'0B'                               0555
*     CALL HMASMIO(HMASMIOP);       /* HAVE I/O PERFORMED            */
         ST    IOPPTR,@AL00001                                     0556
         L     @15,@CV01464                                        0556
         LA    @01,@AL00001                                        0556
         BALR  @14,@15                                             0556
*   END;                                                           0557
*   PUTSMRC=MAX(PUTSMRC,IOPRETRN);  /* MAINTAIN MAX RETURN CODE      */
         L     @05,@PC00004                                        0558
         L     @09,PUTSMRC(,@05)                                   0558
         SLR   @08,@08                                             0558
         IC    @08,IOPRETRN(,IOPPTR)                               0558
         CR    @09,@08                                             0558
         BNL   *+6
         LR    @09,@08                                             0558
         ST    @09,PUTSMRC(,@05)                                   0558
*   IF IOPRETRN=IOPGOOD THEN                                       0559
         CLI   IOPRETRN(IOPPTR),0                                  0559
         BNE   @RF00559                                            0559
*     DO;                                                          0560
*                                                                  0560
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE HMA393I ... SYSMOD SUCCESSFULLY RECEIVED            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0561
*       DO;                         /* HMASMPMG M1(HMA393I)TYPE(INFO)
*                                      TARGET(SYSOUT,LOG)VAR(CURSYSM#
*                                      )                             */
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */
         XC    HMASMMGP(24),HMASMMGP                               0562
*         MGPMGNO1=HMA393I;         /* SET UP MSG 1 CODE             */
         SLR   @05,@05                                             0563
         IC    @05,HMA393I                                         0563
         STH   @05,MGPMGNO1                                        0563
*         MGPTYPE=MGPINFO;          /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'01'                                       0564
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0566
*         MGPVARPT(1)=ADDR(CURSYSM#);/* SET VARIABLE PTR             */
         LA    @05,CURSYSM#                                        0567
         ST    @05,MGPVARPT                                        0567
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */
         L     @15,@CV01466                                        0568
         LA    @01,@AL00568                                        0568
         BALR  @14,@15                                             0568
*       END;                                                       0569
*     END;                                                         0570
*   RETURN CODE(PUTSMRC);           /* RETURN TO CALLER              */
@RF00559 L     @05,@PC00004                                        0571
         L     @15,PUTSMRC(,@05)                                   0571
         L     @14,@SA00004                                        0571
         LM    @00,@03,@SA00004+8                                  0571
         LM    @05,@12,@SA00004+24                                 0571
         BR    @14                                                 0571
*   END PUTSYSM;                                                   0572
*                                                                  0573
*/********************************************************************/
*/*                                                                  */
*/*   DELSYSM  - CLEANUP TLIB DATASETS FOR A FAILING SYSMOD          */
*/*                                                                  */
*/*              NOTE - SYSMREST MUST BE INITIALIZED WITH THE DATA   */
*/*              WHICH DEFINES THE FIRST RELFILE GTA RECORD FOR THE  */
*/*              SYSMOD WHICH FAILED.                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0573
*DELSYSM:                                                          0573
*   PROC(DELSMRC);                                                 0573
DELSYSM  STM   @14,@12,@SA00005                                    0573
         MVC   @PC00005(4),0(@01)                                  0573
*   DCL                                                            0574
*     DELSMRC FIXED(31);            /* RETURN CODE PARAMETER         */
*   DCL                                                            0575
*     FAILSMD CHAR(7);              /* SYSMOD-ID                     */
*   DELSMRC=0;                      /* CLEAR RETURN CODE PARAMETER   */
*                                                                  0576
         L     @09,@PC00005                                        0576
         SLR   @08,@08                                             0576
         ST    @08,DELSMRC(,@09)                                   0576
*   /*****************************************************************/
*   /*                                                               */
*   /* PUT SUMMARY RECORD FOR THIS SYSMOD TO GTA SUMMARY FILE        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0577
*   RECXGSMP->GTPFUNCT=GTPADD;      /* PUT RECORD BACK TO GTA        */
         L     @09,@PC00001                                        0577
         L     @09,RECXGSMP(,@09)                                  0577
         MVI   GTPFUNCT(@09),X'04'                                 0577
*   CALL HMASMGTA(RECXGSMP->HMASMGTP);                             0578
         ST    @09,@AL00001                                        0578
         L     @15,@CV01465                                        0578
         LA    @01,@AL00001                                        0578
         BALR  @14,@15                                             0578
*   RESPECIFY                                                      0579
*     HMASMGTP BASED(RECXGRFP);     /* ADDRESS RELFILE GTP           */
*                                                                  0579
*   /*****************************************************************/
*   /*                                                               */
*   /* RE-POSITION RELFILE GTA FILE TO FIRST RECORD FOR THIS SYSMOD  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0580
*   GTPFUNCT=GTPSTRTN;              /* RESTART AT SPECIFIED RECORD   */
         L     @09,@PC00001                                        0580
         L     @09,RECXGRFP(,@09)                                  0580
         MVI   GTPFUNCT(@09),X'06'                                 0580
*   GTPRESTR=SYSMREST;              /* RESTART DATA                  */
         MVC   GTPRESTR(10,@09),SYSMREST                           0581
*   GTPRCDLN=LENGTH(GRFREC);        /* RELFILE RECORD LENGTH         */
         MVC   GTPRCDLN(2,@09),@CH00558                            0582
*   CALL HMASMGTA(HMASMGTP);        /* POSITION TO 1ST RECORD FOR  0583
*                                      CURRENT SYSMOD                */
*                                                                  0583
         ST    @09,@AL00001                                        0583
         L     @15,@CV01465                                        0583
         LA    @01,@AL00001                                        0583
         BALR  @14,@15                                             0583
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THE FIRST RELFILE RECORD FOR THE CURRENT SYSMOD           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0584
*   GTPFUNCT=GTPGETN;               /* GET NEXT RECORD FUNCTION      */
         L     @09,@PC00001                                        0584
         L     @09,RECXGRFP(,@09)                                  0584
         MVI   GTPFUNCT(@09),X'08'                                 0584
*   CALL HMASMGTA(HMASMGTP);        /* GET THE 1ST RECORD FOR THE  0585
*                                      CURRENT SYSMOD                */
         ST    @09,@AL00001                                        0585
         L     @15,@CV01465                                        0585
         LA    @01,@AL00001                                        0585
         BALR  @14,@15                                             0585
*   FAILSMD=GRFSM#;                 /* CURRENT SYSMOD-ID             */
         L     @09,@PC00001                                        0586
         L     @01,RECXGRFP(,@09)                                  0586
         L     @01,GTPBUFAD(,@01)                                  0586
         MVC   FAILSMD(7),GRFSM#(@01)                              0586
*                                                                  0587
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ALL RELFILE RECORDS FOR THIS SYSMOD                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0587
*   DO WHILE GTPRETRN^=GTPEOF       /* NOT AT END OF RELFILE GTA     */
*         &GRFSM#=FAILSMD           /* RELFILE SYSMOD-ID = CURRENT   */
*         &CCATLBP=ON;              /* TLIB DD PRESENT               */
         B     @DE00587                                            0587
@DL00587 DS    0H                                                  0588
*     ABSFSEQ=GRFFSEQ;              /* SET UP SEQUENCE NUMBER        */
*                                                                  0588
         L     @09,@PC00001                                        0588
         L     @01,RECXGRFP(,@09)                                  0588
         L     @08,GTPBUFAD(,@01)                                  0588
         MVC   ABSFSEQ(2),GRFFSEQ(@08)                             0588
*     /***************************************************************/
*     /*                                                             */
*     /* FORM TLIB DATASET NAME FOR THIS RELFILE                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0589
*     SPLPMAD=ADDR(SPLPDSN);        /* POINT TO PARAMETER LIST       */
         L     @07,SPLPMAD                                         0589
         ST    @07,SPLPMAD                                         0589
*     SPLFUNCT=SPLBDDSN;            /* INDICATE DSN TO BE BUILT      */
         MVI   SPLFUNCT,X'05'                                      0590
*     SPLIPFX=RECXIOPP->IOPPTPFX;   /* DSN PREFIX FROM SYSMOD IOP    */
         L     @06,RECXIOPP(,@09)                                  0591
         MVC   SPLIPFX(26,@07),IOPPTPFX(@06)                       0591
*     SPLISMD=RECXIOPP->IOPNAM17;   /* CURRENT SYSMOD-ID             */
         MVC   SPLISMD(7,@07),IOPNAM17(@06)                        0592
*     SPLIFIL=GRFRELF#;             /* RELFILE (BINARY)              */
         MVC   SPLIFIL(2,@07),GRFRELF#(@08)                        0593
*     CALL HMASMSUB(HMASMSPL);      /* FORM TLIB DSNAME              */
*                                                                  0594
         L     @15,@CV01467                                        0594
         LA    @01,@AL00594                                        0594
         BALR  @14,@15                                             0594
*     /***************************************************************/
*     /*                                                             */
*     /* DELETE TLIB DATASET FOR THIS RELFILE                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0595
*     RECXIOPG->IOPFUNCT=IOPDEL;    /* DELETE DATASET FUNCTION       */
         L     @09,@PC00001                                        0595
         L     @09,RECXIOPG(,@09)                                  0595
         MVI   IOPFUNCT(@09),X'0F'                                 0595
*     RECXIOPG->IOPDSID=IOPLRF;     /* TLIB DATASET                  */
         MVI   IOPDSID(@09),X'20'                                  0596
*     RECXIOPG->IOPDDNAM='SMPTLIB'; /* DDNAME FOR TLIB VOLUME(S)     */
         MVI   IOPDDNAM+7(@09),C' '                                0597
         MVC   IOPDDNAM(7,@09),@CC01647                            0597
*     RECXIOPG->IOPDSN=SPLODSN;     /* TLIB DSN FORMED ABOVE         */
         L     @08,SPLPMAD                                         0598
         MVC   IOPDSN(44,@09),SPLODSN(@08)                         0598
*     CALL HMASMIO(RECXIOPG->HMASMIOP);/* DELETE DATASET             */
*                                                                  0599
         ST    @09,@AL00001                                        0599
         L     @15,@CV01464                                        0599
         LA    @01,@AL00001                                        0599
         BALR  @14,@15                                             0599
*     /***************************************************************/
*     /*                                                             */
*     /* READ RELFILE GTA UNTIL NEXT RELFILE FOR THIS SYSMOD (OR EOF)*/
*     /* IS ENCOUNTERED                                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0600
*     DO WHILE GTPRETRN^=GTPEOF&    /* NOT AT END OF GTA FILE        */
*           ABSFSEQ=GRFFSEQ;        /* STILL THE SAME FILE SEQ #     */
         B     @DE00600                                            0600
@DL00600 DS    0H                                                  0601
*       GTPFUNCT=GTPGETN;           /* GET NEXT RECORD FUNCTION      */
         L     @09,@PC00001                                        0601
         L     @09,RECXGRFP(,@09)                                  0601
         MVI   GTPFUNCT(@09),X'08'                                 0601
*       CALL HMASMGTA(HMASMGTP);    /* GET THE NEXT RECORD           */
         ST    @09,@AL00001                                        0602
         L     @15,@CV01465                                        0602
         LA    @01,@AL00001                                        0602
         BALR  @14,@15                                             0602
*     END;                                                         0603
@DE00600 L     @09,@PC00001                                        0603
         L     @09,RECXGRFP(,@09)                                  0603
         CLI   GTPRETRN(@09),4                                     0603
         BE    @DC00600                                            0603
         L     @01,GTPBUFAD(,@09)                                  0603
         CLC   ABSFSEQ(2),GRFFSEQ(@01)                             0603
         BE    @DL00600                                            0603
@DC00600 DS    0H                                                  0604
*   END;                                                           0604
@DE00587 L     @09,@PC00001                                        0604
         L     @09,RECXGRFP(,@09)                                  0604
         CLI   GTPRETRN(@09),4                                     0604
         BE    @DC00587                                            0604
         L     @01,GTPBUFAD(,@09)                                  0604
         CLC   GRFSM#(7,@01),FAILSMD                               0604
         BNE   @DC00587                                            0604
         TM    CCATLBP(CCAPTR),B'10000000'                         0604
         BO    @DL00587                                            0604
@DC00587 DS    0H                                                  0605
*   IF GTPRETRN>=GTPEOF             /* END OF GTA FILE ENCOUNTERED   */
*     THEN                                                         0605
         L     @09,@PC00001                                        0605
         L     @01,RECXGRFP(,@09)                                  0605
         CLI   GTPRETRN(@01),4                                     0605
         BL    @RF00605                                            0605
*     EOFSW=ON;                     /* SET END-OF-FILE SWITCH        */
         OI    EOFSW,B'00100000'                                   0606
*   RETURN CODE(DELSMRC);                                          0607
@RF00605 L     @09,@PC00005                                        0607
         L     @15,DELSMRC(,@09)                                   0607
         L     @14,@SA00005                                        0607
         LM    @00,@12,@SA00005+8                                  0607
         BR    @14                                                 0607
*   END DELSYSM;                                                   0608
*                                                                  0609
*/********************************************************************/
*/*                                                                  */
*/*   GETSYSM  - GET RECEIVE SUMMARY FILE RECORD AND SMPPTS SYSMOD   */
*/*              ENTRY FOR THE SYSMOD TO BE PROCESSED                */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0609
*GETSYSM:                                                          0609
*   PROC(SUMSYSM,SUMSYSTY,GETSMRC);                                0609
GETSYSM  STM   @14,@03,@SA00006                                    0609
         STM   @05,@12,@SA00006+24                                 0609
         MVC   @PC00006(12),0(@01)                                 0609
*   DCL                                                            0610
*     SUMSYSM CHAR(7);              /* SYSMOD-ID                     */
*   DCL                                                            0611
*     SUMSYSTY CHAR(1);             /* SYSMOD TYPE                   */
*   DCL                                                            0612
*     GETSMRC FIXED(31);            /* RETURN CODE PARAMETER         */
*   GETSMRC=0;                      /* CLEAR RETURN CODE             */
*                                                                  0613
         L     @05,@PC00006+8                                      0613
         SLR   @09,@09                                             0613
         ST    @09,GETSMRC(,@05)                                   0613
*   /*****************************************************************/
*   /*                                                               */
*   /* GET NEW SYSMOD FROM SUMMARY FILE                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0614
*   GSMS#=SUMSYSM;                  /* SET SYSMOD NUMBER FOR LOCATE  */
         L     @05,@PC00001                                        0614
         L     @05,RECXGSMP(,@05)                                  0614
         L     @09,GTPBUFAD(,@05)                                  0614
         L     @08,@PC00006                                        0614
         MVC   GSMS#(7,@09),SUMSYSM(@08)                           0614
*   GSMSTY=SUMSYSTY;                /* SET SYSMOD TYPE FOR LOCATE    */
         L     @08,@PC00006+4                                      0615
         MVC   GSMSTY(1,@09),SUMSYSTY(@08)                         0615
*   RFY                                                            0616
*     HMASMGTP BASED(RECXGSMP);     /* REBASE HMASMGTP               */
*   DO;                             /* HMASMGPF F(GTPLOC)KLEN(LENGTH(
*                                      GSMKEY))RLEN(LENGTH(GSMREC))B(
*                                      RECXGSMP)                     */
*     GTPFUNCT=GTPLOC;              /* SET UP FUNCTION CODE          */
         MVI   GTPFUNCT(@05),X'03'                                 0618
*     GTPRCDLN=LENGTH(GSMREC);      /* SET UP RLEN                   */
         MVC   GTPRCDLN(2,@05),@CH00543                            0619
*     GTPKEYLN=LENGTH(GSMKEY);      /* SET UP KLEN                   */
         MVC   GTPKEYLN(2,@05),@CH00037                            0620
*     CALL HMASMGTA(HMASMGTP);      /* HAVE FUNCTION PERFORMED       */
         ST    @05,@AL00001                                        0621
         L     @15,@CV01465                                        0621
         LA    @01,@AL00001                                        0621
         BALR  @14,@15                                             0621
*   END;                                                           0622
*   IF GTPRETRN=GTPNTFND THEN       /* IF RECORD NOT FOUND THEN      */
         L     @05,@PC00001                                        0623
         L     @05,RECXGSMP(,@05)                                  0623
         CLI   GTPRETRN(@05),4                                     0623
         BNE   @RF00623                                            0623
*     DO;                           /* RETURN TO CALLER              */
*                                                                  0624
*       /*************************************************************/
*       /*                                                           */
*       /* RECORD NOT FOUND ... INTERNAL PROCESSING ERROR            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0625
*       GETSMRC=STOPFUNC;                                          0625
         L     @05,@PC00006+8                                      0625
         MVC   GETSMRC(4,@05),@CF00034                             0625
*     END;                                                         0626
*   ELSE                                                           0627
*     DO;                                                          0627
*                                                                  0627
         B     @RC00623                                            0627
@RF00623 DS    0H                                                  0628
*       /*************************************************************/
*       /*                                                           */
*       /* GET SYSMOD ENTRY FROM PTS                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0628
*       DO;                         /* HMASMRIO F(IOPLOC)IOP((RECXIOP
*                                      P))DSID(IOPPTS)NAME(SUMSYSM)TY
*                                      PE(IOPSMD)                    */
*         IOPPTR=(RECXIOPP);        /* SET UP IOP ADDRESS            */
         L     @09,@PC00001                                        0629
         L     IOPPTR,RECXIOPP(,@09)                               0629
*         IOPFUNCT=IOPLOC;          /* SET UP FUNCTION CODE          */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0630
*         IOPDSID=IOPPTS;           /* SET UP DSN CODE               */
         MVI   IOPDSID(IOPPTR),X'06'                               0631
*         IOPNAME=SUMSYSM;          /* SET UP NAME                   */
         MVI   IOPNAME+7(IOPPTR),C' '                              0632
         L     @05,@PC00006                                        0632
         MVC   IOPNAME(7,IOPPTR),SUMSYSM(@05)                      0632
*         IOPTYPE=IOPSMD;           /* SET UP TYPE                   */
         MVI   IOPTYPE(IOPPTR),X'0B'                               0633
*         CALL HMASMIO(HMASMIOP);   /* HAVE I/O PERFORMED            */
         ST    IOPPTR,@AL00001                                     0634
         L     @15,@CV01464                                        0634
         LA    @01,@AL00001                                        0634
         BALR  @14,@15                                             0634
*       END;                                                       0635
*       GETSMRC=IOPRETRN;           /* SAVE LOCATE RETURN CODE       */
         L     @05,@PC00006+8                                      0636
         SLR   @09,@09                                             0636
         IC    @09,IOPRETRN(,IOPPTR)                               0636
         ST    @09,GETSMRC(,@05)                                   0636
*       IF IOPRETRN=IOPNOTFD THEN   /* IF ENTRY NOT FOUND IN PTS     */
         CLI   IOPRETRN(IOPPTR),4                                  0637
         BNE   @RF00637                                            0637
*         DO;                       /* ISSUE ERROR MESSAGE           */
*                                                                  0638
*           /*********************************************************/
*           /*                                                       */
*           /* SYSMOD ENTRY NOT FOUND ON PTS ... ISSUE MESSAGE       */
*           /* HMA246I AND HMA391I                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0639
*           GETSMRC=STOPPTF;        /* SET RETURN CODE               */
         MVC   GETSMRC(4,@05),@CF00037                             0639
*           HMASMMGP=''B;           /* CLEAR MGP                     */
         XC    HMASMMGP(24),HMASMMGP                               0640
*           MGPMGNO1=HMA246I;       /* SET MESSAGE ID                */
         SLR   @05,@05                                             0641
         IC    @05,HMA246I                                         0641
         STH   @05,MGPMGNO1                                        0641
*           MGPVARPT(1)=ADDR(SUMSYSM);/* SET SYSMOD-ID IN MSG        */
         L     @05,@PC00006                                        0642
         ST    @05,MGPVARPT                                        0642
*           MGPVARPT(1)=ADDR(ENTRYX);/* ENTRY TYPE ("SYSMOD")        */
         LA    @05,ENTRYX                                          0643
         ST    @05,MGPVARPT                                        0643
*           MGPVARPT(1)=ADDR(SMPPTS);/* DATASET ("SMPPTS")           */
         LA    @05,SMPPTS                                          0644
         ST    @05,MGPVARPT                                        0644
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0645
*           MGPPRINT=ON;            /* PUT TO SMPOUT                 */
*           MGPHLDS=ON;             /* PUT TO SMPLOG                 */
         OI    MGPPRINT,B'10010000'                                0647
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */
         L     @15,@CV01466                                        0648
         LA    @01,@AL00648                                        0648
         BALR  @14,@15                                             0648
*           HMASMMGP=''B;           /* CLEAR MGP                     */
         XC    HMASMMGP(24),HMASMMGP                               0649
*           MGPMGNO1=HMA391I;       /* SET MESSAGE ID                */
         SLR   @05,@05                                             0650
         IC    @05,HMA391I                                         0650
         STH   @05,MGPMGNO1                                        0650
*           MGPVARPT(1)=ADDR(SUMSYSM);/* SET SYSMOD-ID IN MSG        */
         L     @05,@PC00006                                        0651
         ST    @05,MGPVARPT                                        0651
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0652
*           MGPPRINT=ON;            /* PUT TO SMPOUT                 */
*           MGPHLDS=ON;             /* PUT TO SMPLOG                 */
         OI    MGPPRINT,B'10010000'                                0654
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */
         L     @15,@CV01466                                        0655
         LA    @01,@AL00655                                        0655
         BALR  @14,@15                                             0655
*           GSMLERR=ON;             /* POST LOAD ERROR IN SUMMARY    */
*                                                                  0656
         L     @05,@PC00001                                        0656
         L     @05,RECXGSMP(,@05)                                  0656
         L     @01,GTPBUFAD(,@05)                                  0656
         OI    GSMLERR(@01),B'00000010'                            0656
*           /*********************************************************/
*           /*                                                       */
*           /* PUT SUMMARY RECORD BACK TO GTA WITH GSMLERR INDICATOR */
*           /* SET                                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0657
*           RFY                                                    0657
*             HMASMGTP BASED(RECXGSMP);/* REBASE HMASMGTP            */
*           DO;                     /* HMASMGPF F(GTPADD)KLEN(LENGTH(
*                                      GSMKEY))RLEN(LENGTH(GSMREC))B(
*                                      RECXGSMP)                     */
*             GTPFUNCT=GTPADD;      /* SET UP FUNCTION CODE          */
         MVI   GTPFUNCT(@05),X'04'                                 0659
*             GTPRCDLN=LENGTH(GSMREC);/* SET UP RLEN                 */
         MVC   GTPRCDLN(2,@05),@CH00543                            0660
*             GTPKEYLN=LENGTH(GSMKEY);/* SET UP KLEN                 */
         MVC   GTPKEYLN(2,@05),@CH00037                            0661
*             CALL HMASMGTA(HMASMGTP);/* HAVE FUNCTION PERFORMED     */
         ST    @05,@AL00001                                        0662
         L     @15,@CV01465                                        0662
         LA    @01,@AL00001                                        0662
         BALR  @14,@15                                             0662
*           END;                                                   0663
*         END;                                                     0664
*     END;                                                         0665
@RF00637 DS    0H                                                  0666
*   RETURN CODE(GETSMRC);           /* RETURN TO CALLER              */
@RC00623 L     @05,@PC00006+8                                      0666
         L     @15,GETSMRC(,@05)                                   0666
         L     @14,@SA00006                                        0666
         LM    @00,@03,@SA00006+8                                  0666
         LM    @05,@12,@SA00006+24                                 0666
         BR    @14                                                 0666
*   END GETSYSM;                                                   0667
*   END HMASMRCD                                                   0668
*                                                                  0668
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMCB)                                       */
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*                                                                  0668
*       ;                                                          0668
@DATA    DS    0H
@CH00041 DC    H'1'
@CH00090 DC    H'6'
@CH00341 DC    H'14'
@CH00543 DC    H'18'
@CH00558 DC    H'26'
         DS    0F
@AL00222 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00226 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00230 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00237 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00241 DC    A(SUBRC)                LIST WITH   1 ARGUMENT(S)
@AL00272 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00495 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00548 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00568 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00648 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00655 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
@AL00420 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00594 DC    A(HMASMSPL)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    14F
@PC00002 DS    1F
@SA00003 DS    14F
@PC00003 DS    1F
@SA00006 DS    0F
@PC00006 EQU   @SA00006+56
@SA00004 DS    0F
@PC00004 EQU   @SA00004+56
@SA00005 DS    0F
@PC00005 EQU   @SA00005+60
         DS    17F
@AL00001 DS    3A
         DS    0F
@CF00037 DC    F'8'
@CH00037 EQU   @CF00037+2
@CF00034 DC    F'12'
@CH00034 EQU   @CF00034+2
@CV01464 DC    V(HMASMIO)
@CV01465 DC    V(HMASMGTA)
@CV01466 DC    V(HMASMMSG)
@CV01467 DC    V(HMASMSUB)
         DS    0D
P        DS    A
SUBRC    DS    F
MAXCOPY  DS    F
SUB1RC   DS    F
ABSFSEQ  DC    H'0'
TAPEASEQ DC    H'0'
TLIBDSS# DC    H'0'
HMA246I  DC    AL1(47)
HMA351I  DC    AL1(152)
HMA391I  DC    AL1(192)
HMA393I  DC    AL1(194)
HMA394I  DC    AL1(195)
PART102  DC    AL1(102)
PART103  DC    AL1(103)
@CC01647 DC    C'SMPTLIB'
@CC01544 DC    C',,R),('
@CC01636 DC    C') '
HMASMSPL DS    CL5
         ORG   HMASMSPL
SPLPMAD  DS    AL4
SPLFUNCT DS    FL1
         ORG   HMASMSPL+5
SAVRVANM DS    CL8
         DS    CL3
HMASMMGP DS    CL24
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00196 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00197 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL12
         ORG   MGPVAR
MGPVARPT DS    3A
         ORG   HMASMMGP+24
ENTRYX   DC    CL5'ENTRY'
SMPPTS   DC    CL6'SMPPTS'
CURSYSM# DC    CL7' '
LSW      DS    BL1
         ORG   LSW
CURSYSM  DS    BL1
NEWSYSM  EQU   LSW+0
EOFSW    EQU   LSW+0
@NM00198 EQU   LSW+0
         ORG   LSW+1
         DS    CL1
PKDDEC   DS    CL8
EBCDIC   DS    CL8
FILETYPE DS    BL1
         ORG   FILETYPE
DMOD     DS    BL1
DMAC     EQU   FILETYPE+0
DSRC     EQU   FILETYPE+0
DJCL     EQU   FILETYPE+0
@NM00199 EQU   FILETYPE+0
         ORG   FILETYPE+1
         DS    CL3
RELFREST DS    CL10
         DS    CL2
SYSMREST DS    CL10
COPYCARD DS    CL80
         ORG   COPYCARD
@NM00200 DC    CL33' COPY INDD=SMPPTFIN,OUTDD=SMPTLIB'
@NM00201 DC    CL7' '
@NM00202 DC    CL10'RELFILE - '
CCRELF   DS    CL4
@NM00203 DC    CL18' '
CCSMD    DS    CL7
@NM00204 DC    CL1' '
         ORG   COPYCARD+80
SCARD    DS    CL80
         ORG   SCARD
@NM00205 DC    CL8'  S M=(('
SCDATA   DC    CL62' '
         ORG   SCDATA
SCDCOL   DS    CL1
         ORG   SCARD+70
SCEND    DC    CL1' '
SC72     DC    CL1' '
SCSMD    DC    CL7' '
@NM00206 DC    CL1' '
         ORG   SCARD+80
ALTDD    DS    CL90
         ORG   ALTDD
@NM00207 DC    AL2(88)
ALTNAMES DS    CL88
         ORG   ALTNAMES
@NM00208 DC    32X'00'
@NM00209 DC    CL8'SYSUT1'
@NM00210 DC    32X'00'
@NM00211 DC    CL8'SYSUT2'
@NM00212 DC    CL8'SYSUT3'
         ORG   ALTDD+90
TAPEDSN  DS    CL44
         ORG   TAPEDSN
TAPESREL DS    CL11
         ORG   TAPESREL
TAPESYSM DS    CL7
@NM00213 DC    CL2'.F'
TAPERELF DS    CL2
         ORG   TAPEDSN+11
@NM00214 DC    CL33' '
         ORG   TAPEDSN+44
LOCSPL   DS    CL44
PATCHRCD DS    CL80
         ORG   PATCHRCD
@NM00215 DC    80X'FF'
         ORG   PATCHRCD+80
COPYFFLG DS    BL1
         ORG   COPYFFLG
COPYFALC DS    BL1
COPYFPOS EQU   COPYFFLG+0
@NM00216 EQU   COPYFFLG+0
         ORG   COPYFFLG+1
FAILSMD  DS    CL7
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
FIX31    EQU   @05
COLPTR   EQU   @05
I        EQU   @06
IOPPTR   EQU   @04
CCAPTR   EQU   @11
RTNREG   EQU   @14
RTNCODE  EQU   @15
GSMREC   EQU   0
GSMKEY   EQU   GSMREC
GSMS#    EQU   GSMKEY
GSMSTY   EQU   GSMKEY+7
GSMSTAT1 EQU   GSMREC+15
GSMLERR  EQU   GSMSTAT1
GSMSTAT2 EQU   GSMREC+17
GSMRECVD EQU   GSMSTAT2
GSMRLFP  EQU   GSMSTAT2
GSMRLFL  EQU   GSMSTAT2
GSRREC   EQU   0
GSRKEY   EQU   GSRREC
GRFREC   EQU   0
GRFKEY   EQU   GRFREC
GRFFSEQ  EQU   GRFKEY
GRFELEM  EQU   GRFKEY+2
GRFELTY  EQU   GRFKEY+10
GRFSM#   EQU   GRFREC+11
GRFSTY   EQU   GRFREC+18
GRFFLGS  EQU   GRFREC+19
GRFFLUSH EQU   GRFFLGS
GRFLOADD EQU   GRFFLGS
GRFRELF# EQU   GRFREC+20
GRFRELF  EQU   GRFREC+22
GPSREC   EQU   0
GPSKEY   EQU   GPSREC
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCATLBP  EQU   CCAFLAG7+2
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCARVAD  EQU   CCAFSTA
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00017 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00033 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00035 EQU   CCABLDLL
CCALKDRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+248
CCACPYNM EQU   @NM00039
CCACOPY  EQU   @NM00039+8
CCACPYRC EQU   @NM00039+20
@NM00041 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00047+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00051 EQU   HMASMIOP+12
@NM00052 EQU   @NM00051
IOPSEQNO EQU   @NM00051+8
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00162 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPRCDLN EQU   HMASMGTP+4
GTPKEYLN EQU   HMASMGTP+6
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
MCBPTFMP EQU   0
MCBVERMP EQU   0
MCBVEND  EQU   MCBVERMP+8
MCBIFMP  EQU   0
MCBIEND  EQU   MCBIFMP+8
MCBELEMP EQU   0
MCBELEPM EQU   MCBELEMP+136
MCBEFLG1 EQU   MCBELEPM
MCBEFLG2 EQU   MCBELEPM+1
MCBEFLG3 EQU   MCBELEPM+2
MCBEFLG4 EQU   MCBELEPM+3
MCBEFLG5 EQU   MCBELEMP+140
MCBEEND  EQU   MCBELEMP+141
SPLPPACK EQU   0
SPLPUNPK EQU   0
SPLPDSN  EQU   0
SPLODSN  EQU   SPLPDSN
SPLIPFX  EQU   SPLODSN
SPLISMD  EQU   SPLODSN+26
SPLIFIL  EQU   SPLODSN+33
RVAPARM  EQU   0
RVAINFO  EQU   RVAPARM
RVAPASS  EQU   RVAPARM+12
RVASTAE  EQU   RVAPARM+20
RVAEPRNM EQU   RVASTAE+4
@NM00193 EQU   RVASTAE+16
@NM00194 EQU   RVASTAE+20
RVAFLAGS EQU   RVASTAE+24
CARDCOL  EQU   0
CARDCLOS EQU   0
CARDREP  EQU   0
CCADSIDA EQU   0
CCATYPEA EQU   0
DSNCHAR  EQU   0
DSNSRELF EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
RECXPARM EQU   0
RECXFLGS EQU   RECXPARM+8
RECXFLG1 EQU   RECXFLGS
RECXFLG2 EQU   RECXFLGS+1
RECXFLG3 EQU   RECXFLGS+2
RECXFLG4 EQU   RECXFLGS+3
RECXIOPS EQU   RECXPARM+12
RECXIOPP EQU   RECXIOPS+4
RECXIOPG EQU   RECXIOPS+8
RECXLAST EQU   RECXPARM+24
RECXGSMP EQU   RECXPARM+40
RECXGRFP EQU   RECXPARM+48
RECXDSPC EQU   RECXPARM+74
ELEMRC   EQU   0
COPYRC   EQU   0
PUTSMRC  EQU   0
DELSMRC  EQU   0
SUMSYSM  EQU   0
SUMSYSTY EQU   0
GETSMRC  EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00058 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPDSN   EQU   IOPDYNDT
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPDMAC  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00069 EQU   IOPUDATA
@NM00070 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00079 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00090 EQU   IOPSRCDR+1
@NM00092 EQU   @NM00090+7
@NM00096 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00100 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00106 EQU   IOPMODDR+1
@NM00108 EQU   @NM00106+7
@NM00112 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00116 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00127 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00134 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPERROR EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00143 EQU   IOPPTFFX
@NM00144 EQU   @NM00143
IOPPDTES EQU   IOPPTFFX+41
@NM00147 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00172 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00172
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00176 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00176
IOPBFTB1 EQU   IOPBFTB0
MCBVVLST EQU   MCBVEND
MCBVNTRY EQU   MCBVVLST
MCBVNUM  EQU   MCBVNTRY
MCBIVLST EQU   MCBIEND
MCBINTRY EQU   MCBIVLST
MCBINUM  EQU   MCBINTRY
MCBEVLST EQU   MCBEEND
MCBENTRY EQU   MCBEVLST
MCBENUM  EQU   MCBENTRY
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
MCBEIND  EQU   MCBEVLST+8
@NM00192 EQU   MCBENTRY+7
MCBEND   EQU   MCBENUM
MCBIIND  EQU   MCBIVLST+8
@NM00185 EQU   MCBINTRY+7
MCBIND   EQU   MCBINUM
MCBVIND  EQU   MCBVVLST+8
@NM00183 EQU   MCBVNTRY+7
MCBVND   EQU   MCBVNUM
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00178 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00177 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00175 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00174 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00173 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00171 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00170 EQU   IOPPTSFX+35
@NM00169 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00168 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00167 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00166 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00165 EQU   IOPQFMDR
@NM00161 EQU   IOPQSMDR
@NM00160 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00159 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00158 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00157 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00156 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00155 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00154 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00153 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00152 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00151 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00150 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00149 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00148 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00147+3
IOPRECD  EQU   @NM00147
@NM00146 EQU   IOPPTFFX+8
@NM00145 EQU   @NM00143+7
IOPPRELN EQU   @NM00144
@NM00142 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00141 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00140 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00139 EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00138 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00137 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00136 EQU   @NM00134+7
@NM00135 EQU   @NM00134
@NM00133 EQU   IOPSYSDR+5
@NM00132 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00131 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00130 EQU   IOPDLBFX+8
@NM00129 EQU   @NM00127+7
@NM00128 EQU   @NM00127
@NM00126 EQU   IOPDLBDR+1
@NM00125 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00124 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00123 EQU   IOPMODFX+12
@NM00122 EQU   IOPMODF4
@NM00121 EQU   IOPMODF3
@NM00120 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00119 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00118 EQU   @NM00116+7
@NM00117 EQU   @NM00116
@NM00115 EQU   IOPMODDR+17
@NM00114 EQU   @NM00112+7
@NM00113 EQU   @NM00112
@NM00111 EQU   @NM00108
@NM00110 EQU   @NM00108
@NM00109 EQU   @NM00108
@NM00107 EQU   @NM00106
@NM00105 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00104 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00103 EQU   IOPSRCFX+8
@NM00102 EQU   @NM00100+7
@NM00101 EQU   @NM00100
@NM00099 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00098 EQU   @NM00096+7
@NM00097 EQU   @NM00096
@NM00095 EQU   @NM00092
@NM00094 EQU   @NM00092
@NM00093 EQU   @NM00092
@NM00091 EQU   @NM00090
@NM00089 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00088 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00087 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00086 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00085 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00084 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00083 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00081 EQU   @NM00079+7
@NM00080 EQU   @NM00079
@NM00078 EQU   IOPLMDDR+6
@NM00077 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00076 EQU   IOPLMDF4
@NM00075 EQU   IOPLMDF3
@NM00074 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00073 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00072 EQU   IOPLMDDR
@NM00071 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00070+4
IOPUSED  EQU   @NM00070
IOPTPSEQ EQU   @NM00069+8
IOPVLSER EQU   @NM00069+2
IOPBLKSI EQU   @NM00069
IOPCQMAX EQU   IOPCQMAP+12
@NM00068 EQU   IOPCQMAP+11
@NM00067 EQU   IOPCQMAP+8
@NM00066 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00065 EQU   IOPSCMAP+11
@NM00064 EQU   IOPSCMAP+8
@NM00063 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00062 EQU   IOPNTMAX+11
@NM00061 EQU   IOPNTMAX+8
@NM00060 EQU   IOPNTMAX
@NM00059 EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00058+5
IOPIPTF3 EQU   @NM00058
RECXRELM EQU   RECXPARM+72
RECXRCUR EQU   RECXPARM+70
RECXRNXT EQU   RECXPARM+68
RECXRFLE EQU   RECXPARM+66
RECXSEQ# EQU   RECXPARM+64
RECXSCNT EQU   RECXPARM+62
RECXCNT  EQU   RECXPARM+60
RECXMNDX EQU   RECXPARM+56
RECXGPSP EQU   RECXPARM+52
RECXGSRP EQU   RECXPARM+44
RECXPPTR EQU   RECXPARM+36
RECXMCB  EQU   RECXPARM+32
RECXMAX  EQU   RECXPARM+28
RECXIOPT EQU   RECXIOPS
@NM00005 EQU   RECXFLG4
@NM00004 EQU   RECXFLG3
RECXPELM EQU   RECXFLG3
RECXPUPD EQU   RECXFLG3
RECXTXTF EQU   RECXFLG3
RECXPTXT EQU   RECXFLG3
RECXPIFS EQU   RECXFLG3
RECXPVER EQU   RECXFLG3
@NM00003 EQU   RECXFLG2
RECXELEF EQU   RECXFLG2
RECXJCLF EQU   RECXFLG2
RECXAVER EQU   RECXFLG2
RECXVERF EQU   RECXFLG2
@NM00002 EQU   RECXFLG1
RECXEXC  EQU   RECXFLG1
RECXSEL  EQU   RECXFLG1
RECXSYSS EQU   RECXFLG1
RECXSYSF EQU   RECXFLG1
RECXPEOF EQU   RECXFLG1
RECXSYSM EQU   RECXFLG1
RECXPROC EQU   RECXFLG1
@NM00001 EQU   RECXPARM
RVAEND   EQU   RVASTAE+25
@NM00195 EQU   RVAFLAGS
RVASDWFD EQU   RVAFLAGS
RVAVS1   EQU   RVAFLAGS
RVAMVS   EQU   RVAFLAGS
RVAUSRCH EQU   @NM00194+2
RVASYSCH EQU   @NM00194
RVAUSRCD EQU   @NM00193+2
RVASYSCD EQU   @NM00193
RVAABNDC EQU   RVASTAE+12
RVASDWAP EQU   RVASTAE
RVAREC   EQU   RVAPASS+4
RVATBL   EQU   RVAPASS
RVAMAJNM EQU   RVAINFO+8
RVACCAP  EQU   RVAINFO+4
RVAHDR   EQU   RVAINFO
SPLIUNPK EQU   SPLPUNPK+8
SPLOUNPK EQU   SPLPUNPK
SPLOPACK EQU   SPLPPACK+8
SPLIPACK EQU   SPLPPACK
@NM00191 EQU   MCBEFLG5
MCBEDEL  EQU   MCBEFLG5
MCBESTD  EQU   MCBEFLG5
@NM00190 EQU   MCBEFLG4
@NM00189 EQU   MCBEFLG3
@NM00188 EQU   MCBEFLG2
MCBEPAGA EQU   MCBEFLG2
MCBENE   EQU   MCBEFLG2
@NM00187 EQU   MCBEFLG1
MCBEDC   EQU   MCBEFLG1
MCBEREFR EQU   MCBEFLG1
MCBEOVLY EQU   MCBEFLG1
MCBESCTR EQU   MCBEFLG1
MCBEREUS EQU   MCBEFLG1
MCBERENT EQU   MCBEFLG1
MCBEAPF  EQU   MCBEFLG1
MCBERMID EQU   MCBELEMP+129
MCBELLKD EQU   MCBELEMP+128
MCBEJLKD EQU   MCBELEMP+116
MCBELUPI EQU   MCBELEMP+115
MCBEJUPI EQU   MCBELEMP+103
MCBELCPY EQU   MCBELEMP+102
MCBEJCPY EQU   MCBELEMP+90
MCBELASM EQU   MCBELEMP+89
MCBEJASM EQU   MCBELEMP+77
MCBERLF  EQU   MCBELEMP+73
MCBESSI  EQU   MCBELEMP+65
MCBEDALS EQU   MCBELEMP+57
MCBEASLB EQU   MCBELEMP+49
MCBELKLB EQU   MCBELEMP+41
MCBETXLB EQU   MCBELEMP+33
MCBESYS  EQU   MCBELEMP+25
MCBEDOBJ EQU   MCBELEMP+17
MCBEDIST EQU   MCBELEMP+9
MCBENAME EQU   MCBELEMP+1
@NM00186 EQU   MCBELEMP
MCBIFENV EQU   MCBIFMP+1
@NM00184 EQU   MCBIFMP
MCBSFMID EQU   MCBVERMP+1
@NM00182 EQU   MCBVERMP
MCBPTP   EQU   MCBPTFMP+10
MCBPRELN EQU   MCBPTFMP+8
MCBPNO   EQU   MCBPTFMP+1
MCBTYPE  EQU   MCBPTFMP
@NM00181 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00180 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPWKAD  EQU   HMASMGTP+8
@NM00179 EQU   HMASMGTP+2
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00164 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00163 EQU   @NM00162+7
IOPQSMFM EQU   @NM00162
@NM00082 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00057 EQU   IOPUSERL
@NM00056 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00055 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00054 EQU   @NM00051+10
@NM00053 EQU   @NM00052+7
IOPPTFNM EQU   @NM00052
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00050 EQU   CCABLDLM+2
@NM00049 EQU   CCABLDLM
CCAUPDPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00047+12
CCAUPDTE EQU   @NM00047+8
CCAUPDNM EQU   @NM00047
CCASUPPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00045+12
CCAIOSUP EQU   @NM00045+8
CCASUPNM EQU   @NM00045
CCAZAPPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00043+12
CCASPZAP EQU   @NM00043+8
CCAZAPNM EQU   @NM00043
CCACOMPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00041+12
CCACOMRS EQU   @NM00041+8
CCACOMNM EQU   @NM00041
CCACPYPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00039+12
CCAASMPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00037+12
CCAASM   EQU   @NM00037+8
CCAASMNM EQU   @NM00037
CCALKDPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00035+12
CCALKED  EQU   @NM00035+8
CCALKDNM EQU   @NM00035
CCAPGMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCABPGRC EQU   @NM00033+20
CCABPGSP EQU   @NM00033+12
CCABPGAD EQU   @NM00033+8
CCABPGNM EQU   @NM00033
CCAEND   EQU   HMASMCCA+371
@NM00032 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00031 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00030 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00029 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00028 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00027 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00026 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00025 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00024 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00023 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00022 EQU   @NM00017+18
@NM00021 EQU   @NM00017+16
CCATBLPA EQU   @NM00017+12
@NM00020 EQU   @NM00017+8
@NM00019 EQU   @NM00017+4
@NM00018 EQU   @NM00017
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00016 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00015 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00014 EQU   CCAFBUFR+122
@NM00013 EQU   CCAFBUFR+120
@NM00012 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00011 EQU   CCAFBUFR+88
@NM00010 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00009 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
GPSENT   EQU   GPSKEY+1
GPSTYPE  EQU   GPSKEY
@NM00008 EQU   GRFFLGS
GSRFMID  EQU   GSRKEY+4
GSRSREL  EQU   GSRKEY
@NM00007 EQU   GSMSTAT2
GSMSEL   EQU   GSMSTAT2
@NM00006 EQU   GSMSTAT1+1
GSMHPRT  EQU   GSMSTAT1+1
GSMNFND  EQU   GSMSTAT1+1
GSMCERR  EQU   GSMSTAT1+1
GSMRERR  EQU   GSMSTAT1+1
GSMRDUP  EQU   GSMSTAT1
GSMSIOE  EQU   GSMSTAT1
GSMNAVER EQU   GSMSTAT1
GSMEXCL  EQU   GSMSTAT1
GSMRCVD  EQU   GSMSTAT1
GSMSYNTX EQU   GSMSTAT1
GSMUSR   EQU   GSMSTAT1
GSMFMID  EQU   GSMREC+8
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00443 EQU   @RC00438
@ENDDATA EQU   *
         END   HMASMRCD,(C'PLS2107',0802,78334)

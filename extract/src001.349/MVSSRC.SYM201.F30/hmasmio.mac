         TITLE 'HMASMIO - HMASMP INPUT/OUTPUT ROUTINE'
HMASMIO  CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMIO   78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         LA    @09,4095(,@10)                                      0001
         LA    @08,4095(,@09)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         USING @PSTART+12285,@08                                   0001
         MVC   @PC00001(4),0(@01)                                  0001
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
         EJECT
*                                                                  0325
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ENTERED BEFORE AND ADJUST SAVE AREAS                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*   IOPPTR=ADDR(PASSIOP);           /* SET UP ADDR OF IOP            */
         L     IOPPTR,@PC00001                                     0325
*   IOENTCNT=IOENTCNT+1;            /* BUMP ENTRY COUNTER            */
         SLR   @11,@11                                             0326
         IC    @11,IOENTCNT                                        0326
         LA    @11,1(,@11)                                         0326
         STC   @11,IOENTCNT                                        0326
*   IF IOENTCNT>DIM(IOSVAREA)       /* EXCEEDED MAX ENTRIES? @ZA12350*/
*     THEN                          /* YES - EXIT                    */
         CLI   IOENTCNT,6                                          0327
         BNH   @RF00327                                            0327
*     DO;                                                          0328
*       IOENTCNT=IOENTCNT-1;        /* DECR COUNTER          @ZA12350*/
         BCTR  @11,0                                               0329
         STC   @11,IOENTCNT                                        0329
*       IOPRETRN=IOPIOERR;          /* SET I/O ERROR                 */
         MVI   IOPRETRN(IOPPTR),X'10'                              0330
*       RETURN;                     /* EXIT                          */
@EL00001 DS    0H                                                  0331
@EF00001 DS    0H                                                  0331
@ER00001 LM    @14,@12,12(@13)                                     0331
         BR    @14                                                 0331
*     END;                          /*                       @Z40SP00*/
*   R1=ADDR(IOSVAREA(IOENTCNT));    /* SET PTR TO DCLED AREA @ZA12350*/
@RF00327 SLR   @11,@11                                             0333
         IC    @11,IOENTCNT                                        0333
         LR    @04,@11                                             0333
         MH    @04,@CH00833                                        0333
         L     R1,ADIOSAVE                                         0333
         AL    R1,@CF04235                                         0333
         LA    R1,IOSVAREA(@04,R1)                                 0333
*   RFY                                                            0334
*     SVAREAS BASED(R1);            /*                       @Z40SP00*/
*   SVBACK=R13;                     /* CHAIN BACKWARDS               */
         ST    R13,SVBACK(,R1)                                     0335
*   RFY                                                            0336
*     SVAREAS BASED(R13);                                          0336
*   SVFWRD=R1;                      /* CHAIN FORWARDS                */
         ST    R1,SVFWRD(,R13)                                     0337
*   R13=R1;                         /* SET UP NEW SAVE AREA          */
         LR    R13,R1                                              0338
*   RFY                                                            0339
*    (R1) UNRSTD;                                                  0339
*                                                                  0339
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE EXISTING MGP IN CASE RE-ENTRY FROM MSG FROM IO   @ZA25875*/
*   /* INITIALIAZE HMASMMGP AND SAVE IOP BUFFER ADDRESS              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0340
*   SAVDSID(IOENTCNT)=IOPDSID;      /* SAVE DSID             @ZA25875*/
         SLR   @04,@04                                             0340
         IC    @04,IOPDSID(,IOPPTR)                                0340
         STC   @04,SAVDSID-1(@11)                                  0340
*   SAVCCADS(IOENTCNT)=CCACURDS;    /* SAVE CURRENT DSID     @Z67SP00*/
         L     @03,@CA00038                                        0341
         SLR   @15,@15                                             0341
         IC    @15,CCACURDS-HMASMCCA(,@03)                         0341
         STC   @15,SAVCCADS-1(@11)                                 0341
*   CCACURDS=IOPDSID;               /* MOVE NEW DSID OVER    @Z67SP00*/
         STC   @04,CCACURDS-HMASMCCA(,@03)                         0342
*   IF IOENTCNT>1                   /* IF RE-ENTRY           @ZA25875*/
*     THEN                          /*                       @ZA25875*/
         CLI   IOENTCNT,1                                          0343
         BNH   @RF00343                                            0343
*     SAVMGP(IOENTCNT-1)=HMASMMGP;  /* SAVE MGP              @ZA25875*/
         MH    @11,@CH00033                                        0344
         LA    @04,SAVMGP-24(@11)                                  0344
         MVC   0(12,@04),HMASMMGP                                  0344
*   HMASMMGP=HMASMMGP&&HMASMMGP;    /* CLEAR MSG PARM        @Z40SP00*/
@RF00343 XC    HMASMMGP(24),HMASMMGP                               0345
*   MGPPRINT=ON;                    /*                       @Z67SP00*/
*   MGPHLDS=ON;                     /*                       @Z67SP00*/
         OI    MGPPRINT,B'10010000'                                0347
*   IOPRETRN=IOPGOOD;               /* SET RETURN CODE       @ZA25875*/
         MVI   IOPRETRN(IOPPTR),X'00'                              0348
*   IF IOPDSID>IOPNUMDS             /* IF INVALID DSID       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CLI   IOPDSID(IOPPTR),42                                  0349
         BH    @RT00349                                            0349
*     GO TO BADEXIT;                /* RC=16                 @Z67SP00*/
*   IF IOPDSID=IOPWKX               /* IF WKX THEN RESET TO  @Z67SP00*/
*     THEN                          /* WK1 THRU WK4          @Z67SP00*/
         CLI   IOPDSID(IOPPTR),40                                  0351
         BNE   @RF00351                                            0351
*     DO;                           /*                       @Z67SP00*/
*       CALL IODSCHCK;              /*                       @Z67SP00*/
         BAL   @14,IODSCHCK                                        0353
*       IF IOPRETRN^=IOPGOOD        /* IF ERR                @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         CLI   IOPRETRN(IOPPTR),0                                  0354
         BNE   @RT00354                                            0354
*         GO TO EXIT;               /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
         EJECT
*IOINIT0:                           /*                       @ZA25875*/
*                                                                  0357
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PREV ERR ON PRINTER THEN NO MSG TO PRINTER AND IF THIS IS  */
*   /* WRITE TO PRINTER TRY TO SWITCH WRITE TO LOG           @ZA25875*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0357
*   CCACURDS=IOPDSID;               /* MOVE NEW DSID OVER    @Z67SP00*/
@RF00351 DS    0H                                                  0357
IOINIT0  L     @11,@CA00038                                        0357
         MVC   CCACURDS-HMASMCCA(1,@11),IOPDSID(IOPPTR)            0357
*   IF CCAOUTNG=ON                  /* IF PREV ERR TO PRINT  @Z67SP00*/
*     THEN                          /*                       @ZA25875*/
         TM    CCAOUTNG-HMASMCCA(@11),B'01000000'                  0358
         BNO   @RF00358                                            0358
*     DO;                           /*                       @ZA25875*/
*       IF IOPDSID=IOPPRINT         /* IF WRITE TO PRINT     @ZA25875*/
*         THEN                      /*                       @ZA25875*/
         CLI   IOPDSID(IOPPTR),11                                  0360
         BNE   @RF00360                                            0360
*         IF CCALOGNG=OFF           /* IF LOG OK             @Z67SP00*/
*             &IOPFUNCT=IOPWRITE    /* AND WRITE OPERATION   @ZA25875*/
*           THEN                    /*                       @ZA25875*/
         TM    CCALOGNG-HMASMCCA(@11),B'10000000'                  0361
         BNZ   @RF00361                                            0361
         CLI   IOPFUNCT(IOPPTR),81                                 0361
         BNE   @RF00361                                            0361
*           DO;                     /*                       @ZA25875*/
*             IOPRETRN=IOPNTOPN;    /* SET RC TO 12          @Z67SP00*/
         MVI   IOPRETRN(IOPPTR),X'0C'                              0363
*             IF PRLHEAD=OFF        /* IF NOT WORKING WITH   @Z67SP00*/
*                 &PRLHEADO=OFF     /* HEADINGS              @Z67SP00*/
*               THEN                /* THEN SWITCH OUTPUT    @Z67SP00*/
         L     @11,IOPBUFAD(,IOPPTR)                               0364
         TM    PRLHEAD(@11),B'11000000'                            0364
         BNZ   @RF00364                                            0364
*               DO;                 /* TO LOG                @Z67SP00*/
*                 PRLRLEN=PRLRLEN+LENGTH(HMASMPRL);/*        @ZA25875*/
         LA    @04,10                                              0366
         AH    @04,PRLRLEN(,@11)                                   0366
         STH   @04,PRLRLEN(,@11)                                   0366
*                 IOPDSID=IOPHLDS;  /* SWITCH TO LOG         @ZA25875*/
         MVI   IOPDSID(IOPPTR),X'01'                               0367
*               END;                /*                       @Z67SP00*/
*             ELSE                  /*                       @Z67SP00*/
*               IF PRLBLANK=ON      /* IF WRITE BLANK LINE   @Z67SP00*/
*                 THEN              /* THEN NOTHING TO       @Z67SP00*/
         B     @RC00364                                            0369
@RF00364 L     @11,IOPBUFAD(,IOPPTR)                               0369
         TM    PRLBLANK(@11),B'00100000'                           0369
         BO    @RT00369                                            0369
*                 GO TO EXIT;       /* SWITCH TO LOG         @Z67SP00*/
*           END;                    /*                       @ZA25875*/
*         ELSE                      /*                       @ZA25875*/
*           DO;                     /*                       @ZA25875*/
         B     @RC00361                                            0372
@RF00361 DS    0H                                                  0373
*             IOPRETRN=IOPIOERR;    /*                       @ZA25875*/
         MVI   IOPRETRN(IOPPTR),X'10'                              0373
*             GO TO EXIT;           /*                       @ZA25875*/
         B     EXIT                                                0374
*           END;                    /*                       @ZA25875*/
*     END;                          /*                       @ZA25875*/
@RC00361 DS    0H                                                  0376
@RF00360 DS    0H                                                  0377
         EJECT
*                                                                  0377
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PREV ERR ON LOG THEN NO MSG TO LOG AND IF THIS IS WRITE TO */
*   /* LOG TRY TO SWITCH WRITE TO PRINTER                    @ZA25875*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0377
*   IF CCALOGNG=ON                  /* IF PREV LOG ERR       @Z67SP00*/
*     THEN                          /*                       @ZA25875*/
@RF00358 L     @11,@CA00038                                        0377
         TM    CCALOGNG-HMASMCCA(@11),B'10000000'                  0377
         BNO   @RF00377                                            0377
*     DO;                           /*                       @ZA25875*/
*       IF IOPDSID=IOPHLDS          /* IF WRITE TO LOG       @ZA25875*/
*         THEN                      /*                       @ZA25875*/
         CLI   IOPDSID(IOPPTR),1                                   0379
         BNE   @RF00379                                            0379
*         IF CCAOUTNG=OFF           /* IF OK FOR PRINTER     @Z67SP00*/
*             &IOPFUNCT=IOPWRITE    /* AND WRITE OPERATION   @ZA25875*/
*           THEN                    /*                       @ZA25875*/
         TM    CCAOUTNG-HMASMCCA(@11),B'01000000'                  0380
         BNZ   @RF00380                                            0380
         CLI   IOPFUNCT(IOPPTR),81                                 0380
         BNE   @RF00380                                            0380
*           DO;                     /*                       @ZA25875*/
*             PRLRLEN=PRLRLEN-LENGTH(HMASMPRL);/*            @ZA25875*/
         L     @11,IOPBUFAD(,IOPPTR)                               0382
         LH    @04,PRLRLEN(,@11)                                   0382
         SH    @04,@CH00034                                        0382
         STH   @04,PRLRLEN(,@11)                                   0382
*             IOPDSID=IOPPRINT;     /* SWITCH TO PRINTER     @ZA25875*/
         MVI   IOPDSID(IOPPTR),X'0B'                               0383
*             IOPRETRN=IOPNTOPN;    /* SET RC TO 12          @ZA25875*/
         MVI   IOPRETRN(IOPPTR),X'0C'                              0384
*           END;                    /*                       @ZA25875*/
*         ELSE                      /* IF PRINT DEAD TOO     @ZA25875*/
*           DO;                     /*                       @ZA25875*/
         B     @RC00380                                            0386
@RF00380 DS    0H                                                  0387
*             IOPRETRN=IOPIOERR;    /* SET BAD RC            @ZA25875*/
         MVI   IOPRETRN(IOPPTR),X'10'                              0387
*             GO TO EXIT;           /*                       @ZA25875*/
         B     EXIT                                                0388
*           END;                    /*                       @ZA25875*/
*     END;                          /*                       @ZA25875*/
*                                                                  0390
@RC00380 DS    0H                                                  0390
@RF00379 DS    0H                                                  0391
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL HMASMION TO CONVERT THE PASSED MEMBER NAME TO THE FORM   */
*   /* THAT IT IS STORED ON THE SPECIFIED DATA SET           @ZD00008*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0391
*   CALL HMASMION(HMASMIOP);        /*                       @ZD00008*/
@RF00377 ST    IOPPTR,@AL00001                                     0391
         L     @15,@CV03344                                        0391
         LA    @01,@AL00001                                        0391
         BALR  @14,@15                                             0391
*   IF IOPRETRN^=IOPGOOD            /* IF BAD RTN FROM ION   @ZD00008*/
*     THEN                          /*                       @ZD00008*/
         CLI   IOPRETRN(IOPPTR),0                                  0392
         BNE   @RT00392                                            0392
*     GO TO EXIT;                   /* RETURN                @ZD00008*/
         EJECT
*                                                                  0394
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CLOSE ALL FUNCTION - LOOP CLOSING ALL OPEN FILES    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0394
*   IF IOPFUNCT=IOPCLOSA            /* IS IT CLOSE ALL FUNCTION      */
*     THEN                          /* YES - CLOSE                   */
         CLI   IOPFUNCT(IOPPTR),87                                 0394
         BNE   @RF00394                                            0394
*     DO;                                                          0395
*       DO OUTIN=IN TO OUT BY 2;    /* LOOP CLOSING INPUT AND OUTPUT
*                                      DCBS                  @Z67SP00*/
         LA    @11,1                                               0396
         SLR   @04,@04                                             0396
         IC    @04,IOENTCNT                                        0396
         LA    @04,INOUT-1(@04)                                    0396
         STC   @11,OUTIN(,@04)                                     0396
@DL00396 DS    0H                                                  0397
*         DO DCBNO=1 TO IOPNUMDS;   /* LOOP THRU ALL DCBS    @Z40SP00*/
         LA    @11,1                                               0397
         STC   @11,DCBNO                                           0397
@DL00397 DS    0H                                                  0398
*           DCBPTR=DCBS(DCBNO,OUTIN);/* PICK UP DCB AD               */
         SLA   @11,2                                               0398
         SLR   @04,@04                                             0398
         IC    @04,IOENTCNT                                        0398
         LA    @04,INOUT-1(@04)                                    0398
         SLR   @15,@15                                             0398
         IC    @15,OUTIN(,@04)                                     0398
         ALR   @11,@15                                             0398
         SLA   @11,2                                               0398
         L     DCBPTR,DCBS-20(@11)                                 0398
*           IF DCBPTR^=ZERO         /* ANY DCB FOR THIS TYPE @Z40SP00*/
*               &DCBOFOPN=ON        /* AND DCB OPENED        @SA72416*/
*             THEN                  /* YES                   @SA72416*/
         LTR   DCBPTR,DCBPTR                                       0399
         BZ    @RF00399                                            0399
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0399
         BNO   @RF00399                                            0399
*             DO;                   /*                       @YA07506*/
*               GEN(CLOSE ((DCBPTR)));/* CLOSE IT            @SA74327*/
         CLOSE ((DCBPTR))
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @YA07506*/
*                 THEN              /* YES                   @YA07506*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0402
         BNO   @RF00402                                            0402
*                 DO;               /* NEED TO WRITE MSG     @Z40SP00*/
*                   IF DCBNO=IOPPRINT/* IF PRINTER THEN      @Z40SP00*/
*                     THEN          /* SET SO NO MORE MSG    @Z40SP00*/
         CLI   DCBNO,11                                            0404
         BNE   @RF00404                                            0404
*                     DO;           /*                       @Z67SP00*/
*                       CCAOUTNG=ON;/* GO TO SMPOUT          @Z67SP00*/
         L     @11,@CA00038                                        0406
         OI    CCAOUTNG-HMASMCCA(@11),B'01000000'                  0406
*                       CCATERM=ON; /* STOP SMP AT DRV       @Z67SP00*/
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   0407
*                     END;          /*                       @Z67SP00*/
*                   IF DCBNO=IOPHLDS/* IF LOG THEN SET       @Z40SP00*/
*                     THEN          /* NO MORE MSG TO        @Z40SP00*/
@RF00404 CLI   DCBNO,1                                             0409
         BNE   @RF00409                                            0409
*                     DO;           /*                       @Z67SP00*/
*                       CCALOGNG=ON;/* SMPLOG                @Z67SP00*/
         L     @11,@CA00038                                        0411
         OI    CCALOGNG-HMASMCCA(@11),B'10000000'                  0411
*                       CCATERM=ON; /* STOP SMP AT DRV       @Z67SP00*/
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   0412
*                     END;          /*                       @Z67SP00*/
*                   MGPTYPE=MGPSEV; /* SET MESSAGE SEV.      @ZD00001*/
@RF00409 MVI   MGPTYPE,X'04'                                       0414
*                   IOPRETRN=IOPNTCLS;/* SET RETURN CODE     @YA07506*/
         MVI   IOPRETRN(IOPPTR),X'0C'                              0415
*                   MGPMGNO1=HMA201I;/* UNABLE TO XXX        @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00183                                0416
*                   MGPVARPT(1)=ADDR(TXTCLOSE);/* CLOSE      @Z40SP00*/
         LA    @11,@CC03331                                        0417
         ST    @11,MGPVARPT                                        0417
*                   MGPVARPT(2)=ADDR(CCADSIDA(IOPDSID));/*   @Z67SP00*/
         SLR   @11,@11                                             0418
         IC    @11,IOPDSID(,IOPPTR)                                0418
         SLA   @11,3                                               0418
         L     @04,@CA00038                                        0418
         L     @04,CCADSAD-HMASMCCA(,@04)                          0418
         AL    @04,@CF04239                                        0418
         LA    @11,CCADSIDA(@11,@04)                               0418
         ST    @11,MGPVARPT+4                                      0418
*                   CALL HMASMMSG(HMASMMGP);/* WRITE MSG     @Z40SP00*/
         L     @15,@CV03346                                        0419
         LA    @01,@AL00419                                        0419
         BALR  @14,@15                                             0419
*                 END;              /*                       @Z40SP00*/
*             END;                  /* END NO DCB OR NOT OPN @Z67SP00*/
@RF00402 DS    0H                                                  0422
*         END;                      /* END CLOSE 1 TYPE GROUP@SA72416*/
@RF00399 LA    @11,1                                               0422
         SLR   @04,@04                                             0422
         IC    @04,DCBNO                                           0422
         ALR   @11,@04                                             0422
         STC   @11,DCBNO                                           0422
         CH    @11,@CH00374                                        0422
         BNH   @DL00397                                            0422
*       END;                        /* END INPUT/OUTPUT LOOP @Z67SP00*/
         SLR   @04,@04                                             0423
         IC    @04,IOENTCNT                                        0423
         LA    @04,INOUT-1(@04)                                    0423
         LA    @11,2                                               0423
         SLR   @03,@03                                             0423
         IC    @03,OUTIN(,@04)                                     0423
         ALR   @11,@03                                             0423
         SLR   @04,@04                                             0423
         IC    @04,IOENTCNT                                        0423
         LA    @04,INOUT-1(@04)                                    0423
         STC   @11,OUTIN(,@04)                                     0423
         CH    @11,@CH00235                                        0423
         BNH   @DL00396                                            0423
*       GO TO EXIT;                 /* RETURN TO CALLER      @YA07506*/
         B     EXIT                                                0424
*     END;                                                         0425
         EJECT
*                                                                  0426
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE DCB TO USE BASED ON IOPDSID VALUE IN IOP. IF THE    */
*   /* DATASET CAN BE FOR INPUT OR OUTPUT DETERMINE MODE BASED ON    */
*   /* IOPFUNCT                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0426
*IOINIT:                                                           0426
*   IF IOPFUNCT<=IOPCLOSE           /* INPUT FUNCTION?       @SA72416*/
*     THEN                          /* YES                   @SA72416*/
@RF00394 DS    0H                                                  0426
IOINIT   CLI   IOPFUNCT(IOPPTR),80                                 0426
         BH    @RF00426                                            0426
*     OUTIN=IN;                     /* SET TYPE INDX TO INPUT@SA72416*/
         SLR   @11,@11                                             0427
         IC    @11,IOENTCNT                                        0427
         LA    @11,INOUT-1(@11)                                    0427
         MVI   OUTIN(@11),X'01'                                    0427
*   ELSE                            /* MUST BE OUTPUT FUNCT  @SA72416*/
*     OUTIN=OUT;                    /* SET TYPE TO OUTPUT    @SA72416*/
         B     @RC00426                                            0428
@RF00426 SLR   @11,@11                                             0428
         IC    @11,IOENTCNT                                        0428
         LA    @11,INOUT-1(@11)                                    0428
         MVI   OUTIN(@11),X'03'                                    0428
*IOCLOSCK:                                                         0429
*   DCBPTR=DCBS(IOPDSID,OUTIN);     /* GET PROPER DCB ADDR   @ZA12350*/
*                                                                  0429
@RC00426 DS    0H                                                  0429
IOCLOSCK SLR   @11,@11                                             0429
         IC    @11,IOPDSID(,IOPPTR)                                0429
         SLA   @11,2                                               0429
         SLR   @04,@04                                             0429
         IC    @04,IOENTCNT                                        0429
         LA    @04,INOUT-1(@04)                                    0429
         SLR   @15,@15                                             0429
         IC    @15,OUTIN(,@04)                                     0429
         ALR   @11,@15                                             0429
         SLA   @11,2                                               0429
         L     DCBPTR,DCBS-20(@11)                                 0429
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPERATION IS CLOSE THEN CLOSE DCB, BOTH INPUT AND OUTPUT   */
*   /* TYPES. IF IT WAS THE CDS DIRECTORY AND THE UPDATE DCB IS OPEN */
*   /* CLOSE IT AND OPEN AND CLOSE NORMAL CDS DCB IN ORDER TO RESET  */
*   /* SMPCDS LRECL AND BLKSIZE                              @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0430
*   IF IOPFUNCT=IOPCLOSE            /* IS THIS CLOSE OPERATION?      */
*     THEN                          /* YES -                 @SA72416*/
         CLI   IOPFUNCT(IOPPTR),80                                 0430
         BNE   @RF00430                                            0430
*     DO;                           /* CLOSE THE DCB         @SA72416*/
*       IF DCBPTR^=ZERO             /* IS THERE A DCB ADDR   @Z40SP00*/
*           &DCBOFOPN=ON            /* AND IS IT OPEN?       @YA07506*/
*         THEN                      /* YES - THEN OK TO CLOSE        */
         LTR   DCBPTR,DCBPTR                                       0432
         BZ    @RF00432                                            0432
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0432
         BNO   @RF00432                                            0432
*         DO;                       /*                       @YA07506*/
*           GEN(CLOSE ((DCBPTR)));  /* CLOSE THE DCB         @SA72416*/
         CLOSE ((DCBPTR))
*           IF DCBOFOPN=ON          /* CLOSE FAIL?           @YA07506*/
*             THEN                  /* YES                   @YA07506*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0435
         BO    @RT00435                                            0435
*             GO TO CLOSFAIL;       /* GO WRITE CLOSE MSG    @Z40SP00*/
*         END;                      /* END DCB AND OPEN      @YA07506*/
*       IF OUTIN=IN                 /* LAST CLOSE FOR INPUT DCB?     */
*         THEN                      /* YES                   @SA72416*/
@RF00432 SLR   @11,@11                                             0438
         IC    @11,IOENTCNT                                        0438
         LA    @11,INOUT-1(@11)                                    0438
         CLI   OUTIN(@11),1                                        0438
         BNE   @RF00438                                            0438
*         DO;                       /* RESET TO DO OUTPUT DCB@SA72416*/
*           OUTIN=OUT;              /* SET TYPE INDEX TO OUTPUT      */
         MVI   OUTIN(@11),X'03'                                    0440
*           GO TO IOCLOSCK;         /* GO TO CLOSE IT        @SA72416*/
         B     IOCLOSCK                                            0441
*         END;                      /*                       @SA72416*/
*       IF IOPDSID=IOPCDSD          /* IS THIS DIRECT DATA SET?      */
*           ×IOPDSID=IOPACDSD       /* OR ACDS DIRECTORY     @ZD00006*/
*           ×IOPDSID=IOPCRQD        /* OR CRQ DIRECTORY      @Z67SP00*/
*           ×IOPDSID=IOPACRQD       /* OR ACRQ DIRECTORY     @Z67SP00*/
*         THEN                      /* CHECK FOR UPDAT OPEN          */
@RF00438 CLI   IOPDSID(IOPPTR),8                                   0443
         BE    @RT00443                                            0443
         CLI   IOPDSID(IOPPTR),13                                  0443
         BE    @RT00443                                            0443
         CLI   IOPDSID(IOPPTR),29                                  0443
         BE    @RT00443                                            0443
         CLI   IOPDSID(IOPPTR),31                                  0443
         BNE   @RF00443                                            0443
@RT00443 DS    0H                                                  0444
*         DO;                                                      0444
*           DCBPTR=ADDIRDCB;        /* POINT TO DIR DCB      @Z40SP01*/
         L     DCBPTR,ADDIRDCB                                     0445
*           IF DCBOFOPN=ON          /* IS IT OPEN?                   */
*             THEN                  /* YES - CLOSE IT                */
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0446
         BNO   @RF00446                                            0446
*             DO;                                                  0447
*               GEN(CLOSE ((DCBPTR)));/* ISSUE CLOSE         @ZD00003*/
         CLOSE ((DCBPTR))
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @YA07506*/
*                 THEN              /* YES                   @YA07506*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0449
         BO    @RT00449                                            0449
*                 GO TO CLOSFAIL;   /* GO WRITE ERR MSG      @Z40SP00*/
*                                                                  0450
*               /*****************************************************/
*               /*                                                   */
*               /* FOLLOWING CODE IS TO UPDATE THE VTOC WITH CORRECT */
*               /* LRECL, BLKSIZE, AND KEY LENGTH                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0451
*               IF IOPDSID=IOPCDSD  /* IF CDS DIRECT         @ZD00004*/
*                 THEN              /* THEN POINT TO         @ZD00004*/
         CLI   IOPDSID(IOPPTR),8                                   0451
         BNE   @RF00451                                            0451
*                 DO;               /*                       @ZD00004*/
*                   DSBFMX=CCACBFMX;/* CDS BLK               @ZD00004*/
         L     @11,@CA00038                                        0453
         MVC   DSBFMX(2),CCACBFMX-HMASMCCA(@11)                    0453
*                   DCBPTR=ADCDODCB;/* CDS OUTPUT DCB        @ZD00004*/
         L     DCBPTR,ADCDODCB                                     0454
*                 END;              /*                       @ZD00004*/
*               ELSE                /* ELSE IS ACDS SO POINT @ZD00004*/
*                 IF IOPDSID=IOPACDSD/* IF ACDS              @Z67SP00*/
*                   THEN            /*                       @Z67SP00*/
         B     @RC00451                                            0456
@RF00451 CLI   IOPDSID(IOPPTR),13                                  0456
         BNE   @RF00456                                            0456
*                   DO;             /*                       @ZD00004*/
*                     DSBFMX=CCAABFMX;/* ACDS BLK            @ZD00004*/
         L     @11,@CA00038                                        0458
         MVC   DSBFMX(2),CCAABFMX-HMASMCCA(@11)                    0458
*                     DCBPTR=ADACODCB;/* TO ACDS ODCB        @ZD00004*/
         L     DCBPTR,ADACODCB                                     0459
*                   END;            /*                       @ZD00004*/
*                 ELSE              /*                       @Z67SP00*/
*                   IF IOPDSID=IOPCRQD/* IF CRQ              @Z67SP00*/
*                     THEN          /*                       @Z67SP00*/
         B     @RC00456                                            0461
@RF00456 CLI   IOPDSID(IOPPTR),29                                  0461
         BNE   @RF00461                                            0461
*                     DO;           /*                       @Z67SP00*/
*                       DSBFMX=CCAQBFMX;/*                   @Z67SP00*/
         L     @11,@CA00038                                        0463
         MVC   DSBFMX(2),CCAQBFMX-HMASMCCA(@11)                    0463
*                       DCBPTR=ADCQODCB;/*                   @Z67SP00*/
         L     DCBPTR,ADCQODCB                                     0464
*                     END;          /*                       @Z67SP00*/
*                   ELSE            /* MUST BE ACRQ          @Z67SP00*/
*                     DO;           /*                       @Z67SP00*/
         B     @RC00461                                            0466
@RF00461 DS    0H                                                  0467
*                       DSBFMX=CCAXBFMX;/*                   @Z67SP00*/
         L     @11,@CA00038                                        0467
         MVC   DSBFMX(2),CCAXBFMX-HMASMCCA(@11)                    0467
*                       DCBPTR=ADAQODCB;/*                   @Z67SP00*/
         L     DCBPTR,ADAQODCB                                     0468
*                     END;          /*                       @Z67SP00*/
*               IF DCBOFOPN=ON      /* IF DCB OPEN           @YA07506*/
*                 THEN              /* THEN                  @YA07506*/
@RC00461 DS    0H                                                  0470
@RC00456 DS    0H                                                  0470
@RC00451 TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0470
         BNO   @RF00470                                            0470
*                 GEN(CLOSE ((DCBPTR)));/* INSURE DCB CLOSED @Z67SP00*/
         CLOSE ((DCBPTR))
*               DCBBLKSI=DSBFMX*DCBLRECL;/* RESET BLKSIZE TO ORIGINAL
*                                      BLOCKSIZE. SIZE IS NOW 256. 0472
*                                      MUST BE RESET TO MULTIPLE OF
*                                      80                    @Z67SP00*/
@RF00470 LH    @11,DSBFMX                                          0472
         MH    @11,DCBLRECL+72(,DCBPTR)                            0472
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0472
*               GEN(OPEN  ((DCBPTR),OUTPUT));/* OPEN DCB     @Z67SP00*/
         OPEN  ((DCBPTR),OUTPUT)
*               IF DCBOFOPN=OFF     /* OPEN FAIL?            @YA07506*/
*                 THEN              /* YES                   @YA07506*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0474
         BZ    @RT00474                                            0474
*                 GO TO OPENFAIL;   /* WRITE ERR MSG         @Z40SP00*/
*               GEN(CLOSE ((DCBPTR)));/* CLOSE IT            @ZD00003*/
         CLOSE ((DCBPTR))
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @YA07506*/
*                 THEN              /* YES                   @YA07506*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0477
         BO    @RT00477                                            0477
*                 GO TO CLOSFAIL;   /* GO WRITE ERR MSG      @YA07506*/
*             END;                  /* END DCB OPEN GROUP            */
*         END;                                                     0480
@RF00446 DS    0H                                                  0481
*     END;                          /* END FUNCTION = CLOSE          */
@RF00443 DS    0H                                                  0482
*                                                                  0482
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW CHECK TO SEE IF THERE IS ANY PROCESSING TO DO FOR CLOSE   */
*   /* OPERATION FOR THE SPECIFIED DATASET. IF SO GO TO ROUTINE ELSE */
*   /* GO TO COMMON EXIT                                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0482
*   IF IOPFUNCT=IOPCLOSE            /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00430 CLI   IOPFUNCT(IOPPTR),80                                 0482
         BNE   @RF00482                                            0482
*     IF IOPDSID=IOPCDS             /*                       @Z67SP00*/
*         ×IOPDSID=IOPACDS          /*                       @Z67SP00*/
*         ×IOPDSID=IOPSCDS          /*                       @Z67SP00*/
*         ×IOPDSID=IOPPTS           /*                       @Z67SP00*/
*         ×IOPDSID=IOPMTS           /*                       @Z67SP00*/
*         ×IOPDSID=IOPSTS           /*                       @Z67SP00*/
*         ×IOPDSID=IOPCRQ           /*                       @Z67SP00*/
*         ×IOPDSID=IOPACRQ          /*                       @Z67SP00*/
*         ×IOPDSID=IOPWK1           /*                       @Z67SP00*/
*         ×IOPDSID=IOPWK2           /*                       @Z67SP00*/
*         ×IOPDSID=IOPWK3           /*                       @Z67SP00*/
*         ×IOPDSID=IOPWK4           /*                       @Z67SP00*/
*         ×IOPDSID=IOPWK5           /*                       @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
         CLI   IOPDSID(IOPPTR),2                                   0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),12                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),33                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),6                                   0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),18                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),26                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),28                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),30                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),35                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),36                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),37                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),38                                  0483
         BE    @RT00483                                            0483
         CLI   IOPDSID(IOPPTR),39                                  0483
         BNE   @RF00483                                            0483
@RT00483 DS    0H                                                  0484
*       GO TO IOROUT;               /* NEED CLOSE LOGIC      @Z67SP00*/
         SLR   @11,@11                                             0484
         IC    @11,IOPDSID(,IOPPTR)                                0484
         SLA   @11,2                                               0484
         L     @11,IOHNDLRS-4(@11)                                 0484
         BR    @11                                                 0484
*     ELSE                          /*                       @Z67SP00*/
*       GO TO GOODEXIT;             /*                       @Z67SP00*/
         EJECT
*                                                                  0486
*   /*****************************************************************/
*   /*                                                               */
*   /* IF IOPDSID=IOPDDNM OR IOPDSID=IOPTXTDD INSURE THAT DCB IS     */
*   /* OPENED FOR THE CORRECT DDNAME                         @Z30XX9J*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0486
*   IF(IOPDSID=IOPDDNM              /* USING ANY DD CARD?    @Z30XX9J*/
*       ×IOPDSID=IOPTXTDD           /* OR TEXTLIB DD         @Z40SP00*/
*       ×IOPDSID=IOPANYDD)          /* OR OTHER VARIABLE DD  @Z40SP00*/
*       &(DCBOFOPN=OFF              /* AND IF EITHER THE DCB IS    0486
*                                      CLOSED                @Z40SP00*/
*       ×((IOPFUNCT<IOPCLOSE&       /* OR IF OPEN AND INPUT  @Z40SP00*/
*       IOPDDNAM^=LASTDDI)          /* AND NOT SAME AS LAST INPUT OR
*                                                            @Z40SP00*/
*       ×(IOPFUNCT>IOPCLOSE&        /* OR IF OPEN AND OUTPT  @Z40SP00*/
*       IOPDDNAM^=LASTDDO)))        /* AND NOT SAME DDNAME AS LAST 0486
*                                      OUTPUT                @Z40SP00*/
*     THEN                          /* IF CONDITION MET      @Z30XX9J*/
@RF00482 CLI   IOPDSID(IOPPTR),14                                  0486
         BE    @GL00020                                            0486
         CLI   IOPDSID(IOPPTR),24                                  0486
         BE    @GL00020                                            0486
         CLI   IOPDSID(IOPPTR),24                                  0486
         BNE   @RF00486                                            0486
@GL00020 TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0486
         BZ    @RT00486                                            0486
         CLI   IOPFUNCT(IOPPTR),80                                 0486
         BNL   @GL00024                                            0486
         CLC   IOPDDNAM(8,IOPPTR),LASTDDI                          0486
         BNE   @RT00486                                            0486
@GL00024 CLI   IOPFUNCT(IOPPTR),80                                 0486
         BNH   @RF00486                                            0486
         CLC   IOPDDNAM(8,IOPPTR),LASTDDO                          0486
         BE    @RF00486                                            0486
@RT00486 DS    0H                                                  0487
*     DO;                           /*                       @Z30XX9J*/
*       IF DCBOFOPN=ON              /* DCB OPEN?             @Z30XX9J*/
*         THEN                      /* YES                   @Z30XX9J*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0488
         BNO   @RF00488                                            0488
*         DO;                       /*                       @YA07506*/
*           GEN(CLOSE  ((DCBPTR))); /* CLOSE IT              @Z30XX9J*/
         CLOSE  ((DCBPTR))
*           IF DCBOFOPN=ON          /* CLOSE FAIL?           @YA07506*/
*             THEN                  /* YES                   @YA07506*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0491
         BO    @RT00491                                            0491
*             GO TO CLOSFAIL;       /* GO WRITE ERR MSG      @Z40SP00*/
*         END;                      /* END DCB WAS OPENED    @YA07506*/
*       DCBDSORG=INITDSRG;          /* ZERO DSORG            @Z30XX9J*/
@RF00488 MVC   DCBDSORG+16(2,DCBPTR),INITDSRG                      0494
*       DCBRECFM=ZERO;              /* RECORD FORMAT         @Z40SP00*/
         MVI   DCBRECFM+28(DCBPTR),X'00'                           0495
*       DCBLRECL=ZERO;              /* LRECL AND             @Z40SP00*/
         SLR   @11,@11                                             0496
         STH   @11,DCBLRECL+72(,DCBPTR)                            0496
*       DCBBLKSI=ZERO;              /* BLKSIZE               @Z40SP00*/
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0497
*       DCBDDNAM=IOPDDNAM;          /* SET NEW DDNAME IN DCB @Z40SP00*/
         MVC   DCBDDNAM+40(8,DCBPTR),IOPDDNAM(IOPPTR)              0498
*       IF IOPFUNCT<IOPCLOSE        /* INPUT REQUEST?        @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
         CLI   IOPFUNCT(IOPPTR),80                                 0499
         BNL   @RF00499                                            0499
*         LASTDDI=IOPDDNAM;         /* SET NEW INPUT DDNAME  @Z40SP00*/
         MVC   LASTDDI(8),IOPDDNAM(IOPPTR)                         0500
*       ELSE                        /* MUST BE OUTPUT        @Z40SP00*/
*         LASTDDO=IOPDDNAM;         /* SET NEW OUTPUT DDNAME @Z40SP00*/
         B     @RC00499                                            0501
@RF00499 MVC   LASTDDO(8),IOPDDNAM(IOPPTR)                         0501
*     END;                          /* END IOPDSID=IOPDDNM   @Z30XX9J*/
*                                                                  0502
@RC00499 DS    0H                                                  0503
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DATA SET IS FOR COMPRESS,TEXTLIB, OR OTHER NON-DEFINED DATA*/
*   /* SETS THEN SAVE DD NAME IN APPROPRIATE SAVE AREA       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0503
*   IF IOPDSID=IOPDDNM              /* DD FOR COMPRESS?      @Z40SP00*/
*       ×IOPDSID=IOPTXTDD           /* OR FOR TEXTLIB?       @Z40SP00*/
*       ×IOPDSID=IOPANYDD           /* OR OTHER UN-DEFINED   @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
@RF00486 CLI   IOPDSID(IOPPTR),14                                  0503
         BE    @RT00503                                            0503
         CLI   IOPDSID(IOPPTR),24                                  0503
         BE    @RT00503                                            0503
         CLI   IOPDSID(IOPPTR),24                                  0503
         BNE   @RF00503                                            0503
@RT00503 DS    0H                                                  0504
*     DO;                           /*                       @Z67SP00*/
*       CCADSIDA(IOPDSID)=IOPDDNAM; /* IN DD ARRAY           @Z40SP00*/
         SLR   @11,@11                                             0505
         IC    @11,IOPDSID(,IOPPTR)                                0505
         SLA   @11,3                                               0505
         L     @04,@CA00038                                        0505
         L     @03,CCADSAD-HMASMCCA(,@04)                          0505
         ALR   @03,@11                                             0505
         AL    @03,@CF04239                                        0505
         MVC   CCADSIDA(8,@03),IOPDDNAM(IOPPTR)                    0505
*       CCACURDD=IOPDDNAM;          /* MOVE DDNAME OVER      @Z67SP00*/
         MVC   CCACURDD-HMASMCCA(8,@04),IOPDDNAM(IOPPTR)           0506
*     END;                          /*                       @Z67SP00*/
*                                                                  0508
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DATA SET IS MACRO LIBRARY INSURE THAT DCB IS OPEN FOR      */
*   /* CORRECT DDNAME                                        @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0508
*   IF IOPDSID=IOPMACL              /* MACRO LIBRARY?        @Z40SP00*/
*       &CCADSIDA(IOPMACL)^=IOPDDNAM/* AND NOT SAME DDNAME THAT DCB
*                                      IS OPEN FOR           @Z67SP00*/
*     THEN                          /* NO                    @Z40SP00*/
@RF00503 CLI   IOPDSID(IOPPTR),5                                   0508
         BNE   @RF00508                                            0508
         L     @11,@CA00038                                        0508
         L     @11,CCADSAD-HMASMCCA(,@11)                          0508
         CLC   CCADSIDA+32(8,@11),IOPDDNAM(IOPPTR)                 0508
         BE    @RF00508                                            0508
*     DO;                           /* CLOSE MACRO LIB DCB   @Z40SP00*/
*       IF DCBOFOPN=ON              /* DCB OPEN              @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0510
         BNO   @RF00510                                            0510
*         DO;                       /*                       @Z40SP00*/
*           GEN(CLOSE  ((DCBPTR))); /* CLOSE DCB             @Z40SP00*/
         CLOSE  ((DCBPTR))
*           IF DCBOFOPN=ON          /* CLOSE FAIL?           @YA07506*/
*             THEN                  /* YES                   @YA07506*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0513
         BO    @RT00513                                            0513
*             GO TO CLOSFAIL;       /* GO WRITE MSG          @YA07506*/
*         END;                      /* END DCB WAS OPENED    @YA07506*/
*       DCBDDNAM=IOPDDNAM;          /* SET NEW DD NAME       @Z40SP00*/
@RF00510 MVC   DCBDDNAM+40(8,DCBPTR),IOPDDNAM(IOPPTR)              0516
*       CCADSIDA(IOPMACL)=IOPDDNAM; /* SAVE NEW MAC DD       @Z67SP00*/
         L     @11,@CA00038                                        0517
         L     @04,CCADSAD-HMASMCCA(,@11)                          0517
         MVC   CCADSIDA+32(8,@04),IOPDDNAM(IOPPTR)                 0517
*       CCACURDD=IOPDDNAM;          /* MOVE DDNAME OVER      @Z67SP00*/
         MVC   CCACURDD-HMASMCCA(8,@11),IOPDDNAM(IOPPTR)           0518
*     END;                          /* END MAC DSID          @Z40SP00*/
*                                                                  0519
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DATA SET IS SOURCE LIBRARY INSURE THAT DCB IS OPEN FOR     */
*   /* CORRECT DDNAME                                        @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0520
*   IF IOPDSID=IOPSRCL              /* SOURCE LIBRARY?       @Z40SP00*/
*       &CCADSIDA(IOPSRCL)^=IOPDDNAM/* AND NOT SAME DDNAME THAT DCB
*                                      IS OPEN FOR           @Z40SP00*/
*     THEN                          /* NO                    @Z40SP00*/
@RF00508 CLI   IOPDSID(IOPPTR),22                                  0520
         BNE   @RF00520                                            0520
         L     @11,@CA00038                                        0520
         L     @11,CCADSAD-HMASMCCA(,@11)                          0520
         CLC   CCADSIDA+168(8,@11),IOPDDNAM(IOPPTR)                0520
         BE    @RF00520                                            0520
*     DO;                           /* CLOSE SOURCE LIB DCB  @Z40SP00*/
*       IF DCBOFOPN=ON              /* DCB OPEN              @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0522
         BNO   @RF00522                                            0522
*         DO;                       /*                       @Z40SP00*/
*           GEN(CLOSE  ((DCBPTR))); /* CLOSE DCB             @Z40SP00*/
         CLOSE  ((DCBPTR))
*           IF DCBOFOPN=ON          /* CLOSE FAIL?           @YA07506*/
*             THEN                  /* YES                   @YA07506*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0525
         BO    @RT00525                                            0525
*             GO TO CLOSFAIL;       /* GO WRITE ERR MSG      @YA07506*/
*         END;                      /* END DCB WAS OPENED    @YA07506*/
*       DCBDDNAM=IOPDDNAM;          /* SET NEW DD NAME       @Z40SP00*/
@RF00522 MVC   DCBDDNAM+40(8,DCBPTR),IOPDDNAM(IOPPTR)              0528
*       CCADSIDA(IOPSRCL)=IOPDDNAM; /* SAVE NEW SRC DD       @Z67SP00*/
         L     @11,@CA00038                                        0529
         L     @04,CCADSAD-HMASMCCA(,@11)                          0529
         MVC   CCADSIDA+168(8,@04),IOPDDNAM(IOPPTR)                0529
*       CCACURDD=IOPDDNAM;          /* MOVE DDNAME OVER      @Z67SP00*/
         MVC   CCACURDD-HMASMCCA(8,@11),IOPDDNAM(IOPPTR)           0530
*     END;                          /* END SOURCE DSID       @Z40SP00*/
*                                                                  0532
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FUNCTION WAS TO CHANGE A DD FROM MEMBER OF PDS BACK TO A   */
*   /* REAL PDS THEN COPY SAVED JFCB INTO WORK JFCB AREA     @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0532
*   SKIPRDJF=OFF;                   /* SET TO DO RDJFCB      @Z40SP00*/
@RF00520 NI    SKIPRDJF,B'11011111'                                0532
*   IF IOPDSID=IOPJFCB              /* REQUEST FOR JFCB ?    @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
         CLI   IOPDSID(IOPPTR),25                                  0533
         BNE   @RF00533                                            0533
*     DO;                           /* YES                   @Z40SP00*/
*       DCBDDNAM=IOPDDNAM;          /* SET DCB DDNAME        @Z40SP00*/
         MVC   DCBDDNAM+40(8,DCBPTR),IOPDDNAM(IOPPTR)              0535
*       CCADSIDA(IOPJFCB)=IOPDDNAM; /* SAVE NAME IN CASE ERR @Z67SP00*/
         L     @11,@CA00038                                        0536
         L     @04,CCADSAD-HMASMCCA(,@11)                          0536
         MVC   CCADSIDA+192(8,@04),IOPDDNAM(IOPPTR)                0536
*       CCACURDD=IOPDDNAM;          /* MOVE DDNAME OVER      @Z67SP00*/
         MVC   CCACURDD-HMASMCCA(8,@11),IOPDDNAM(IOPPTR)           0537
*       IF IOPFUNCT=IOPJFCBP        /* CHANGE BACK TO PDS?   @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
         CLI   IOPFUNCT(IOPPTR),6                                  0538
         BNE   @RF00538                                            0538
*         DO;                       /* SET SW TO SKIP RDJFCB @Z40SP00*/
*           SKIPRDJF=ON;            /* ALREADY HAVE SAVED    @Z40SP00*/
         OI    SKIPRDJF,B'00100000'                                0540
*           IF JFCB01NM=IOPDDNAM    /* IF SAVED IN 01 JFCB   @Z67SP00*/
*             THEN                  /* THEN RESTORE THAT     @Z67SP00*/
         CLC   JFCB01NM(8),IOPDDNAM(IOPPTR)                        0541
         BNE   @RF00541                                            0541
*             DO;                   /*                       @Z67SP00*/
*               JFCBAREA=ADJFCB01->JFCBAREA;/* TO TEMP ONE   @Z67SP00*/
         L     @11,JFCBPTR                                         0543
         L     @04,ADJFCB01                                        0543
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     0543
*               JFCB01NM(1)=BLANK;  /* JFCB NOW FREE         @Z67SP00*/
         MVI   JFCB01NM,C' '                                       0544
*             END;                  /*                       @Z67SP00*/
*           ELSE                    /* IF NOT SAVED IN 01    @Z67SP00*/
*             IF JFCB02NM=IOPDDNAM  /* IF SAVED IN 02        @Z67SP00*/
*               THEN                /* SO RESTORE THAT ONE   @Z67SP00*/
         B     @RC00541                                            0546
@RF00541 CLC   JFCB02NM(8),IOPDDNAM(IOPPTR)                        0546
         BNE   @RF00546                                            0546
*               DO;                 /*                       @Z67SP00*/
*                 JFCBAREA=ADJFCB02->JFCBAREA;/* TO TEMP AREA      0548
*                                                            @Z67SP00*/
         L     @11,JFCBPTR                                         0548
         L     @04,ADJFCB02                                        0548
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     0548
*                 JFCB02NM(1)=BLANK;/* JFCB NOW FREE         @Z67SP00*/
         MVI   JFCB02NM,C' '                                       0549
*               END;                /*                       @Z67SP00*/
*             ELSE                  /* ELSE                  @Z67SP00*/
*               GO TO BADEXIT;      /* INTERNAL ERROR        @Z67SP00*/
*           JFCBOPSW=ON;            /*                       @Z67SP00*/
@RC00541 L     @11,JFCBPTR                                         0552
         OI    JFCBOPSW(@11),B'10000000'                           0552
*           JFCNWRIT=OFF;           /*                       @Z67SP00*/
         NI    JFCNWRIT(@11),B'11110111'                           0553
*           JFCBELNM=' ';           /* BLANK ELEMENT NAME    @Z67SP00*/
         MVI   JFCBELNM+1(@11),C' '                                0554
         MVC   JFCBELNM+2(6,@11),JFCBELNM+1(@11)                   0554
         MVI   JFCBELNM(@11),C' '                                  0554
*         END;                      /* END END CHANGE BACK   @Z40SP00*/
*     END;                          /* END JFCB FUNCTION     @Z40SP00*/
@RF00538 DS    0H                                                  0557
         EJECT
*                                                                  0557
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF PROPER DCB IS OPEN, AND EXIT TO PROPER ROUTINE       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0557
*   IF DCBOFOPN=OFF                 /* IS THE DCB OPEN?      @Z40SP00*/
*     THEN                          /* NO - MUST OPEN IT             */
@RF00533 TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0557
         BNZ   @RF00557                                            0557
*     DO;                           /* GET LIST FORM OPEN    @Z40SP00*/
*                                                                  0558
*       /*************************************************************/
*       /*                                                           */
*       /* IF FUNCTION WAS OPEN OR THE DATA SET WAS THE CDS OR       */
*       /* REQUEST WAS FOR A JFCB MODIFICATION THEN ISSUE RDJFCB     */
*       /* BEFORE OPEN TO PREVENT DD STATEMENT MISSING MESSAGE AND TO*/
*       /* DO ANY MODIFICATIONS ALREADY SET UP IF IT WAS THE CDS THEN*/
*       /* INSURE THAT DATA SET WILL BE OPENED WITH DISP=OLD @Z40SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0559
*       RFY                                                        0559
*         R1 RSTD;                                                 0559
*       IF IOPFUNCT=IOPOPEN         /* IS THIS SPECIFIC OPEN?        */
*           ×IOPDSID=IOPJFCB        /* OR JFCB CHANGE        @Z40SP00*/
*           ×IOPDSID=IOPPTFIN       /* OR PTFIN              @Z67SP00*/
*           ×IOPDSID=IOPLRF         /* OR LRF                @Z67SP00*/
*         THEN                      /* YES - RDJFCB FIRST            */
         CLI   IOPFUNCT(IOPPTR),0                                  0560
         BE    @RT00560                                            0560
         CLI   IOPDSID(IOPPTR),25                                  0560
         BE    @RT00560                                            0560
         CLI   IOPDSID(IOPPTR),10                                  0560
         BE    @RT00560                                            0560
         CLI   IOPDSID(IOPPTR),32                                  0560
         BNE   @RF00560                                            0560
@RT00560 DS    0H                                                  0561
*         DO;                                                      0561
*                                                                  0561
*           /*********************************************************/
*           /*                                                       */
*           /* IF SW NOT SET TO SKIP OVER RDJFCB, ISSUE RDJFCB TO    */
*           /* INSURE THAT DD CARD IS PRESENT BEFORE OPEN TYPE=J     */
*           /*                                               @Z40SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0562
*           IF SKIPRDJF=OFF         /* WAS SW SET TO SKIP RDJFCB FOR
*                                      CHANGE JFCB TYPES     @Z40SP00*/
*             THEN                  /* NO                    @Z40SP00*/
         TM    SKIPRDJF,B'00100000'                                0562
         BNZ   @RF00562                                            0562
*             DO;                   /* RDJFCB TO CHECK DD    @Z40SP00*/
*                                                                  0563
*               /*****************************************************/
*               /*                                                   */
*               /* IF REQUEST FOR PTFIN DCB OPEN FOR FILE 1 (SYSMODS)*/
*               /* THEN COPY QSAM PTFIN DCB TO DCB TO BE USED. THEN  */
*               /* ISSUE READ JFCB MACRO                             */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0564
*               IF IOPDSID=IOPPTFIN /* IF PTFIN              @Z67SP00*/
*                   &IOPSEQNO=1     /* FILE 1                @Z67SP00*/
*                 THEN              /*                       @Z67SP00*/
         CLI   IOPDSID(IOPPTR),10                                  0564
         BNE   @RF00564                                            0564
         CLC   IOPSEQNO(2,IOPPTR),@CH00088                         0564
         BNE   @RF00564                                            0564
*                 DO;               /*                       @Z67SP00*/
*                   LENDCB=ADPTFND-ADPTFDCB;/* DCB LENGTH    @Z67SP00*/
         L     @11,ADPTFDCB                                        0566
         L     @04,ADPTFND                                         0566
         SLR   @04,@11                                             0566
         STH   @04,LENDCB                                          0566
*                   ADPTFDCB->IHADCB(1:LENDCB)=ADSVPTF->IHADCB(1:LENDCB
*                       );          /* MOVE IT               @Z67SP00*/
         BCTR  @04,0                                               0567
         L     @03,ADSVPTF                                         0567
         EX    @04,@SM04242                                        0567
*                 END;              /*                       @Z67SP00*/
*               JFCBDSNM(1)=BLANK;  /* RESET NAME IN JFCB            */
@RF00564 L     @11,JFCBPTR                                         0569
         MVI   JFCBDSNM(@11),C' '                                  0569
*               R1=DCBS(IOPDSID,OUTIN+1);/* OPEN LST FRM AD  @ZA12350*/
         SLR   @11,@11                                             0570
         IC    @11,IOPDSID(,IOPPTR)                                0570
         SLA   @11,2                                               0570
         SLR   @04,@04                                             0570
         IC    @04,IOENTCNT                                        0570
         LA    @04,INOUT-1(@04)                                    0570
         SLR   @03,@03                                             0570
         IC    @03,OUTIN(,@04)                                     0570
         ALR   @11,@03                                             0570
         SLA   @11,2                                               0570
         L     R1,DCBS-16(@11)                                     0570
*               GEN(RDJFCB MF=(E,(1)));/* READ JFCB INTO STORAGE     */
         RDJFCB MF=(E,(1))
*               IF JFCBDSNM(1)=BLANK/* DD CARD PRESENT?      @Z40SP00*/
*                 THEN              /* NO - INDICATE CANT OPEN       */
         L     @11,JFCBPTR                                         0572
         CLI   JFCBDSNM(@11),C' '                                  0572
         BNE   @RF00572                                            0572
*                 DO;                                              0573
*                   IOPRETRN=IOPNTOPN;/* SET BAD RTN CODE    @Z40SP00*/
         MVI   IOPRETRN(IOPPTR),X'0C'                              0574
*                   IF IOPFUNCT=IOPOPEN/* IF OPEN REQUEST    @Z67SP00*/
*                     THEN          /* RETURN WITH RC BUT    @Z67SP00*/
         CLI   IOPFUNCT(IOPPTR),0                                  0575
         BE    @RT00575                                            0575
*                     GO TO EXIT;   /* NO MSG                @Z67SP00*/
*                   GO TO NODDMSG;  /* IF IMPLIED OPEN FOR ONE OF THE
*                                      OTHER DDS THEN MSG    @Z67SP00*/
         B     NODDMSG                                             0577
*                 END;                                             0578
*                                                                  0578
*               /*****************************************************/
*               /*                                                   */
*               /* CALL ROUTINE TO DO ANY MODIFICATIONS TO JFCB      */
*               /*                                           @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0579
*               CALL JFCBMOD;       /* MODIFY JFCB           @Z40SP00*/
@RF00572 BAL   @14,JFCBMOD                                         0579
*             END;                  /* END RDJFCB GROUP      @Z40SP00*/
*                                                                  0580
*           /*********************************************************/
*           /*                                                       */
*           /* IF DATASET IS PTFIN THEN MODIFY DCB FOR EITHER PTFIN  */
*           /* INPUT (FILE 1) OR LOAD RELFILE INPUT (FILE>1)         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0581
*           IF IOPDSID=IOPPTFIN     /* IF PTFIN DATSET       @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
@RF00562 CLI   IOPDSID(IOPPTR),10                                  0581
         BNE   @RF00581                                            0581
*             IF IOPSEQNO>1         /* IF RELFILE PART OF    @Z67SP00*/
*               THEN                /* PTFIN DATASET         @Z67SP00*/
         LH    @11,IOPSEQNO(,IOPPTR)                               0582
         CH    @11,@CH00088                                        0582
         BNH   @RF00582                                            0582
*               DO;                 /*                       @Z67SP00*/
*                 DCBLRECL=ZERO;    /* USE LRECL AND BLKSIZE @Z67SP00*/
         SLR   @11,@11                                             0584
         STH   @11,DCBLRECL+72(,DCBPTR)                            0584
*                 DCBBLKSI=ZERO;    /* FROM SL TAPE          @Z67SP00*/
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0585
*                 DCBRECFM=RECFMNL; /* USE RECFM FROM SL TP  @Z67SP00*/
         MVI   DCBRECFM+28(DCBPTR),B'00000000'                     0586
*                 DCBMRECP=MACRFE;  /* SET MACRF=E           @Z67SP00*/
         OI    DCBMRECP+40(DCBPTR),B'10000000'                     0587
*                 DCBERACC=OFF;     /* ERROPT INVAL FOR EXCP @Z67SP00*/
         NI    DCBERACC+84(DCBPTR),B'01111111'                     0588
*               END;                /*                       @Z67SP00*/
*                                                                  0589
*           /*********************************************************/
*           /*                                                       */
*           /* TRY TO OPEN DCB                               @Z40SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0590
*           IF IOPRETRN^=IOPGOOD    /* IF ERROR IN JFCBMOD   @Z67SP00*/
*               ×(IOPDSID=IOPLRF&IOPFUNCT=IOPDEL)/* OR DELETE OF LRF
*                                      DATASET THEN NO NEED TO DO  0590
*                                      OPEN                  @Z67SP00*/
*             THEN                  /* THEN                  @Z67SP00*/
@RF00582 DS    0H                                                  0590
@RF00581 CLI   IOPRETRN(IOPPTR),0                                  0590
         BNE   @RT00590                                            0590
         CLI   IOPDSID(IOPPTR),32                                  0590
         BNE   @RF00590                                            0590
         CLI   IOPFUNCT(IOPPTR),15                                 0590
         BE    @RT00590                                            0590
*             GO TO EXIT;           /* RETURN                @Z67SP00*/
*           ELSE                    /* IF ERR IN JFCB MOD    @Z67SP00*/
*             DO;                   /*                       @Z67SP00*/
@RF00590 DS    0H                                                  0593
*               R1=DCBS(IOPDSID,OUTIN+1);/* OPEN LST FRM     @Z67SP00*/
         SLR   @11,@11                                             0593
         IC    @11,IOPDSID(,IOPPTR)                                0593
         SLA   @11,2                                               0593
         SLR   @04,@04                                             0593
         IC    @04,IOENTCNT                                        0593
         LA    @04,INOUT-1(@04)                                    0593
         SLR   @03,@03                                             0593
         IC    @03,OUTIN(,@04)                                     0593
         ALR   @11,@03                                             0593
         SLA   @11,2                                               0593
         L     R1,DCBS-16(@11)                                     0593
*               GEN(OPEN MF=(E,(1)),TYPE=J)                        0594
*               FLOWS(DCBEXIT);     /* OPEN DCB              @Z67SP00*/
         OPEN MF=(E,(1)),TYPE=J
*               IF DCBOFOPN=OFF     /* OPEN FAIL?            @Z40SP00*/
*                 THEN              /* YES - INDICATE ERROR          */
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0595
         BZ    @RT00595                                            0595
*                 GO TO OPENFAIL;   /* NEED TO PRINT MSG     @ZA12356*/
*             END;                  /*                       @Z67SP00*/
*         END;                                                     0598
*                                                                  0599
*       /*************************************************************/
*       /*                                                           */
*       /* IMPLIED OPEN - NOT SPECIFIC OPEN REQUEST - CHECK OPEN     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0599
*       ELSE                        /* NOT SPECIFIC OPEN OR MACLIB 0599
*                                      OPEN                  @VS05286*/
*         DO;                       /* THEN IMPLIED OPEN     @VS05286*/
         B     @RC00560                                            0599
@RF00560 DS    0H                                                  0600
*           DEVDDNAM=DCBDDNAM;      /* SET DD NAME TO FIND   @Z40SP00*/
         MVC   DEVDDNAM(8),DCBDDNAM+40(DCBPTR)                     0600
*           GEN(DEVTYPE DEVDDNAM,DEVADDR)                          0601
*           REFS(DEVDDNAM,DEVADDR); /* SEE IF DD HERE        @Z40SP00*/
         DEVTYPE DEVDDNAM,DEVADDR
*           RFY                                                    0602
*             RTNCODE RSTD;         /*                       @Z40SP00*/
*           IF RTNCODE^=ZERO        /* DD FOUND?             @Z40SP00*/
*             THEN                  /* NO                    @Z40SP00*/
         LTR   RTNCODE,RTNCODE                                     0603
         BNZ   @RT00603                                            0603
*             GO TO NODDMSG;        /* GO WRITE MSG          @Z40SP00*/
*           RFY                                                    0605
*             RTNCODE UNRSTD;       /*                       @Z40SP00*/
*           R1=DCBS(IOPDSID,OUTIN+1);/* OPEN LIST FORM AD    @ZA12350*/
         SLR   @11,@11                                             0606
         IC    @11,IOPDSID(,IOPPTR)                                0606
         SLA   @11,2                                               0606
         SLR   @04,@04                                             0606
         IC    @04,IOENTCNT                                        0606
         LA    @04,INOUT-1(@04)                                    0606
         SLR   @03,@03                                             0606
         IC    @03,OUTIN(,@04)                                     0606
         ALR   @11,@03                                             0606
         SLA   @11,2                                               0606
         L     R1,DCBS-16(@11)                                     0606
*           GEN(OPEN    MF=(E,(1))) /* OPEN THE DCB                  */
*           FLOWS(DCBEXIT);                                        0607
         OPEN    MF=(E,(1))
*           RFY                                                    0608
*             R1 UNRSTD;            /*                       @Z40SP00*/
*           IF DCBOFOPN=OFF         /* DCB STILL NOT OPEN??          */
*             THEN                  /* NO - ERROR CONDITION          */
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0609
         BZ    @RT00609                                            0609
*             GO TO OPENFAIL;       /* GO WRITE ERR MSG      @Z40SP00*/
*         END;                      /* END IMPLIED OPEN GROUP      0611
*                                                            @VS05286*/
*     END;                          /* END DCB NOT OPEN      @VS05286*/
@RC00560 DS    0H                                                  0613
         EJECT
*                                                                  0613
*   /*****************************************************************/
*   /*                                                               */
*   /* DCB NOW OPENED. DCBPTR IS POINTING TO THE CORRECT DCB AND WILL*/
*   /* REMAIN SO THROUGHOUT THE PROGRAM. IF FUNCTION WAS OPEN THEN   */
*   /* PUT DCB BLKSIZE IN IOP AND RETURN                     @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0613
*   IF IOPFUNCT=IOPOPEN             /* IS FUNCTION OPEN ONLY?        */
*     THEN                          /* YES -                 @VS05286*/
@RF00557 CLI   IOPFUNCT(IOPPTR),0                                  0613
         BNE   @RF00613                                            0613
*     DO;                           /*                       @VS05286*/
*       IOPBLKSI=DCBBLKSI;          /* PUT BLKSIZE IN IOP    @VS05286*/
         MVC   IOPBLKSI(2,IOPPTR),DCBBLKSI+52(DCBPTR)              0615
*       IF IOPDSID=IOPPTFIN         /* IF PTFIN              @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         CLI   IOPDSID(IOPPTR),10                                  0616
         BNE   @RF00616                                            0616
*         DO;                       /*                       @Z67SP00*/
*           IOPVLSER=JFCBVOLS(1:6); /* VOLSER OF TAPE        @Z67SP00*/
         L     @11,JFCBPTR                                         0618
         MVC   IOPVLSER(6,IOPPTR),JFCBVOLS(@11)                    0618
*           IF JFCBFLSQ=ZERO        /*                       @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         ICM   @04,3,JFCBFLSQ(@11)                                 0619
         BNZ   @RF00619                                            0619
*             IOPTPSEQ=1;           /*                       @Z67SP00*/
         MVC   IOPTPSEQ(2,IOPPTR),@CH00088                         0620
*           ELSE                    /*                       @Z67SP00*/
*             IOPTPSEQ=JFCBFLSQ;    /* FILE NUMBER           @Z67SP00*/
         B     @RC00619                                            0621
@RF00619 L     @11,JFCBPTR                                         0621
         MVC   IOPTPSEQ(2,IOPPTR),JFCBFLSQ(@11)                    0621
*         END;                      /*                       @Z67SP00*/
*       GO TO GOODEXIT;             /* EXIT GOOD TO REQUESTOR        */
         B     GOODEXIT                                            0623
*     END;                          /* END OPEN ONLY FUNCTION GROUP
*                                                            @VS05286*/
*                                                                  0624
*   /*****************************************************************/
*   /*                                                               */
*   /* BRANCH TO THE PROPER SUBROUTINE BASED ON THE DATA SET ID      */
*   /* SPECIFIED IN IOPDSID                                  @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0625
*   GO TO IOROUT;                   /* EXIT TO ROUTINE FOR THIS DS   */
@RF00613 SLR   @11,@11                                             0625
         IC    @11,IOPDSID(,IOPPTR)                                0625
         SLA   @11,2                                               0625
         L     @11,IOHNDLRS-4(@11)                                 0625
         BR    @11                                                 0625
         EJECT
*                                                                  0626
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE SMPJCLIN,SMPPTFIN, AND SMPREPIN. IT ALSO    */
*   /* THIS ROUTINE ALSO HANDLES THE DIRECTORY FOR THE SMPUCS,       */
*   /* SMPMTS, SMPPTS, AND THE SMPACDS                       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0626
*JCLINRTN:                                                         0626
*MTSDRTN:                                                          0626
*PTSDRTN:                           /*                       @Z40SP00*/
*STSDRTN:                           /*                       @Z40SP00*/
*SCDSDRTN:                          /*                       @Z67SP00*/
*   IF IOPFUNCT=IOPREAD             /* READ REQUEST?         @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
JCLINRTN DS    0H                                                  0626
MTSDRTN  DS    0H                                                  0626
PTSDRTN  DS    0H                                                  0626
STSDRTN  DS    0H                                                  0626
SCDSDRTN CLI   IOPFUNCT(IOPPTR),1                                  0626
         BNE   @RF00626                                            0626
*     CALL GET;                     /* GET A RECORD          @Z40SP00*/
         BAL   @14,GET                                             0627
*   ELSE                            /* NOT READ REQUEST      @Z40SP00*/
*     IOPRETRN=IOPIOERR;            /* SET BAD RETURN        @Z40SP00*/
         B     @RC00626                                            0628
@RF00626 MVI   IOPRETRN(IOPPTR),X'10'                              0628
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/
         B     EXIT                                                0629
         EJECT
*                                                                  0630
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO SET TO HANDLE CDS DATA SET                 @SA72416*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0630
*CDSRTN:                                                           0630
*   PDSI=CDS;                       /* SET INDEX TO CDS LOG  @SA72416*/
CDSRTN   MVI   PDSI,X'01'                                          0630
*   DSBFRMX=CCACBFMX;               /* CDS BLOCKING FCTR     @SA74317*/
         L     @11,@CA00038                                        0631
         MVC   DSBFRMX(2),CCACBFMX-HMASMCCA(@11)                   0631
*   DSBFPTRI=CCACBFIA;              /* CDS INPUT BUFFER      @Z67SP00*/
         MVC   DSBFPTRI(4),CCACBFIA-HMASMCCA(@11)                  0632
*   DSBFPTRO=CCACBFOA;              /* CDS OUTPUT BUFFER     @Z67SP00*/
         MVC   DSBFPTRO(4),CCACBFOA-HMASMCCA(@11)                  0633
*   IF CCACDSIS=ON                  /* IF CDS DIR IN STOR    @ZD00003*/
*     THEN                          /* THEN SET SW TO USE    @ZD00003*/
         TM    CCACDSIS-HMASMCCA(@11),B'10000000'                  0634
         BNO   @RF00634                                            0634
*     DISISW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/
         OI    DISISW,B'00010000'                                  0635
*   ELSE                            /*                       @ZD00004*/
*     DISISW=OFF;                   /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
         B     @RC00634                                            0636
@RF00634 NI    DISISW,B'11101111'                                  0636
*   IF CCACDSOS=ON                  /* IF CDS DIR IN STOR    @Z67SP00*/
*       ×((CCAAPPLY=ON×CCARES=ON)   /* OR APPLY/REST CHECK   @Z67SP00*/
*       &CCACHECK=ON)               /*                       @Z67SP00*/
*     THEN                          /* FOR UPDATE THEN SET   @Z67SP00*/
@RC00634 L     @11,@CA00038                                        0637
         TM    CCACDSOS-HMASMCCA(@11),B'10000000'                  0637
         BO    @RT00637                                            0637
         TM    CCAAPPLY-HMASMCCA(@11),B'01001000'                  0637
         BZ    @RF00637                                            0637
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0637
         BNO   @RF00637                                            0637
@RT00637 DS    0H                                                  0638
*     DISOSW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/
         OI    DISOSW,B'00001000'                                  0638
*   ELSE                            /*                       @Z67SP00*/
*     DISOSW=OFF;                   /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      UPDATE                @Z67SP00*/
         B     @RC00637                                            0639
@RF00637 NI    DISOSW,B'11110111'                                  0639
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */
*                                                                  0640
         B     PDSRTNS                                             0640
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO SET TO HANDLE THE SMPACDS DATA SET         @SA72416*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0641
*ACDSRTN:                                                          0641
*   PDSI=ACDS;                      /* SET INDEX TO ACDS LOGIC       */
ACDSRTN  MVI   PDSI,X'02'                                          0641
*   DSBFRMX=CCAABFMX;               /* MAX BLK FOR ACDS      @SA74317*/
         L     @11,@CA00038                                        0642
         MVC   DSBFRMX(2),CCAABFMX-HMASMCCA(@11)                   0642
*   DSBFPTRI=CCACBFIA;              /* ACDS INPUT BUFFER     @Z67SP00*/
         MVC   DSBFPTRI(4),CCACBFIA-HMASMCCA(@11)                  0643
*   DSBFPTRO=CCACBFOA;              /* ACDS OUTPUT BUFFER    @Z67SP00*/
         MVC   DSBFPTRO(4),CCACBFOA-HMASMCCA(@11)                  0644
*   IF CCAACDIS=ON                  /* IF ACDS DIR IN STOR   @ZD00003*/
*     THEN                          /* THEN SET SW TO USE    @ZD00003*/
         TM    CCAACDIS-HMASMCCA(@11),B'01000000'                  0645
         BNO   @RF00645                                            0645
*     DISISW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/
         OI    DISISW,B'00010000'                                  0646
*   ELSE                            /*                       @ZD00004*/
*     DISISW=OFF;                   /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
         B     @RC00645                                            0647
@RF00645 NI    DISISW,B'11101111'                                  0647
*   IF CCAACDOS=ON                  /* IF ACDS DIR IN STOR   @Z67SP00*/
*       ×(CCAACCPT=ON&CCACHECK=ON)  /* OR ACCEPT CHECK       @Z67SP00*/
*     THEN                          /* FOR UPDATE THEN SET   @Z67SP00*/
@RC00645 L     @11,@CA00038                                        0648
         TM    CCAACDOS-HMASMCCA(@11),B'01000000'                  0648
         BO    @RT00648                                            0648
         TM    CCAACCPT-HMASMCCA(@11),B'00100000'                  0648
         BNO   @RF00648                                            0648
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0648
         BNO   @RF00648                                            0648
@RT00648 DS    0H                                                  0649
*     DISOSW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/
         OI    DISOSW,B'00001000'                                  0649
*   ELSE                            /*                       @Z67SP00*/
*     DISOSW=OFF;                   /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      UPDATE                @Z67SP00*/
         B     @RC00648                                            0650
@RF00648 NI    DISOSW,B'11110111'                                  0650
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */
         B     PDSRTNS                                             0651
*                                                                  0652
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO SET TO HANDLE SCDS DATASET                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0652
*SCDSRTN:                                                          0652
*   PDSI=SCDS;                      /* SET INDEX TO CDSD     @Z67SP00*/
SCDSRTN  MVI   PDSI,X'03'                                          0652
*   DSBFRMX=CCAVBFMX;               /* SCDS BLOCKING FACTOR  @Z67SP00*/
         L     @11,@CA00038                                        0653
         MVC   DSBFRMX(2),CCAVBFMX-HMASMCCA(@11)                   0653
*   DSBFPTRI=CCAVBFIA;              /* SCDS INPUT BUFFER     @Z67SP00*/
         MVC   DSBFPTRI(4),CCAVBFIA-HMASMCCA(@11)                  0654
*   DSBFPTRO=CCAVBFOA;              /* SCDS OUTPUT BUFFER    @Z67SP00*/
         MVC   DSBFPTRO(4),CCAVBFOA-HMASMCCA(@11)                  0655
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
*   DISOSW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      UPDATE                @Z67SP00*/
         NI    DISISW,B'11100111'                                  0657
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */
*                                                                  0658
         B     PDSRTNS                                             0658
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE THE SMPPTS DATA SET                 @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0659
*PTSRTN:                            /*                       @Z40SP00*/
*   PDSI=PTS;                       /* SET INDEX TO USE PTS  @Z67SP00*/
PTSRTN   MVI   PDSI,X'04'                                          0659
*   DSBFRMX=CCAPBFMX;               /* PTS BLOCKING FACTOR   @Z67SP00*/
         L     @11,@CA00038                                        0660
         MVC   DSBFRMX(2),CCAPBFMX-HMASMCCA(@11)                   0660
*   DSBFPTRI=CCAPBFIA;              /* PTS INPUT BUFFER      @Z67SP00*/
         MVC   DSBFPTRI(4),CCAPBFIA-HMASMCCA(@11)                  0661
*   DSBFPTRO=CCAPBFOA;              /* PTS OUTPUT BUFFER     @Z67SP00*/
         MVC   DSBFPTRO(4),CCAPBFOA-HMASMCCA(@11)                  0662
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
*   DISOSW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      UPDATE                @Z67SP00*/
         NI    DISISW,B'11100111'                                  0664
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */
         B     PDSRTNS                                             0665
*                                                                  0666
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE THE SMPMTS DATA SET                 @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0666
*MTSRTN:                            /*                       @Z40SP00*/
*   PDSI=MTS;                       /* SET INDEX TO USE MTS  @Z67SP00*/
MTSRTN   MVI   PDSI,X'05'                                          0666
*   DSBFRMX=CCAMBFMX;               /* MTS BLOCKING FACTOR   @Z67SP00*/
         L     @11,@CA00038                                        0667
         MVC   DSBFRMX(2),CCAMBFMX-HMASMCCA(@11)                   0667
*   DSBFPTRI=CCAPBFIA;              /* MTS INPUT BUFFER      @Z67SP00*/
         MVC   DSBFPTRI(4),CCAPBFIA-HMASMCCA(@11)                  0668
*   DSBFPTRO=CCAPBFOA;              /* MTS OUTPUT BUFFER     @Z67SP00*/
         MVC   DSBFPTRO(4),CCAPBFOA-HMASMCCA(@11)                  0669
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
*   DISOSW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      UPDATE                @Z67SP00*/
         NI    DISISW,B'11100111'                                  0671
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */
*                                                                  0672
         B     PDSRTNS                                             0672
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE THE SMPSTS DATA SET                 @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0673
*STSRTN:                            /*                       @Z40SP00*/
*   PDSI=STS;                       /* SET INDEX TO USE STS  @Z67SP00*/
STSRTN   MVI   PDSI,X'06'                                          0673
*   DSBFRMX=CCASBFMX;               /* STS BLOCKING FACTOR   @Z67SP00*/
         L     @11,@CA00038                                        0674
         MVC   DSBFRMX(2),CCASBFMX-HMASMCCA(@11)                   0674
*   DSBFPTRI=CCAPBFIA;              /* STS INPUT BUFFER      @Z67SP00*/
         MVC   DSBFPTRI(4),CCAPBFIA-HMASMCCA(@11)                  0675
*   DSBFPTRO=CCAPBFOA;              /* STS OUTPUT BUFFER     @Z67SP00*/
         MVC   DSBFPTRO(4),CCAPBFOA-HMASMCCA(@11)                  0676
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
*   DISOSW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      UPDATE                @Z67SP00*/
         NI    DISISW,B'11100111'                                  0678
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */
         B     PDSRTNS                                             0679
*                                                                  0680
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO SET TO HANDLE CRQ DATA SET                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0680
*CRQRTN:                                                           0680
*   PDSI=CRQ;                       /* SET INDEX TO CDS LOG  @Z67SP00*/
CRQRTN   MVI   PDSI,X'07'                                          0680
*   DSBFRMX=CCAQBFMX;               /* CRQ BLOCKING FCTR     @Z67SP00*/
         L     @11,@CA00038                                        0681
         MVC   DSBFRMX(2),CCAQBFMX-HMASMCCA(@11)                   0681
*   DSBFPTRI=CCAQBFIA;              /* CRQ INPUT BUFFER      @Z67SP00*/
         MVC   DSBFPTRI(4),CCAQBFIA-HMASMCCA(@11)                  0682
*   DSBFPTRO=CCAQBFOA;              /* CRQ OUTPUT BUFFER     @Z67SP00*/
         MVC   DSBFPTRO(4),CCAQBFOA-HMASMCCA(@11)                  0683
*   IF CCACRQIS=ON                  /* IF CRQ DIR IN STOR    @Z67SP00*/
*     THEN                          /* THEN SET SW TO USE    @Z67SP00*/
         TM    CCACRQIS-HMASMCCA(@11),B'00100000'                  0684
         BNO   @RF00684                                            0684
*     DISISW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/
         OI    DISISW,B'00010000'                                  0685
*   ELSE                            /*                       @Z40ZP67*/
*     DISISW=OFF;                   /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
         B     @RC00684                                            0686
@RF00684 NI    DISISW,B'11101111'                                  0686
*   IF CCACRQOS=ON                  /* IF CRQ DIR IN STOR    @Z67SP00*/
*     THEN                          /* FOR UPDATE THEN SET   @Z67SP00*/
@RC00684 L     @11,@CA00038                                        0687
         TM    CCACRQOS-HMASMCCA(@11),B'00100000'                  0687
         BNO   @RF00687                                            0687
*     DISOSW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/
         OI    DISOSW,B'00001000'                                  0688
*   ELSE                            /*                       @Z67SP00*/
*     DISOSW=OFF;                   /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      UPDATE                @Z67SP00*/
         B     @RC00687                                            0689
@RF00687 NI    DISOSW,B'11110111'                                  0689
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON PDS  @Z67SP00*/
*                                                                  0690
         B     PDSRTNS                                             0690
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO SET TO HANDLE THE SMPACRQ DATA SET         @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0691
*ACRQRTN:                                                          0691
*   PDSI=ACRQ;                      /* SET INDEX TO ACRQ LOG @Z67SP00*/
ACRQRTN  MVI   PDSI,X'08'                                          0691
*   DSBFRMX=CCAXBFMX;               /* MAX BLK FOR ACRQ      @Z67SP00*/
         L     @11,@CA00038                                        0692
         MVC   DSBFRMX(2),CCAXBFMX-HMASMCCA(@11)                   0692
*   DSBFPTRI=CCAQBFIA;              /* ACRQ INPUT BUFFER     @Z67SP00*/
         MVC   DSBFPTRI(4),CCAQBFIA-HMASMCCA(@11)                  0693
*   DSBFPTRO=CCAQBFOA;              /* ACRQ OUTPUT BUFFER    @Z67SP00*/
         MVC   DSBFPTRO(4),CCAQBFOA-HMASMCCA(@11)                  0694
*   IF CCAACRIS=ON                  /* IF ACRQ DIR IN STOR   @Z67SP00*/
*     THEN                          /* THEN SET SW TO USE    @Z67SP00*/
         TM    CCAACRIS-HMASMCCA(@11),B'00010000'                  0695
         BNO   @RF00695                                            0695
*     DISISW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/
         OI    DISISW,B'00010000'                                  0696
*   ELSE                            /*                       @ZD00004*/
*     DISISW=OFF;                   /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
         B     @RC00695                                            0697
@RF00695 NI    DISISW,B'11101111'                                  0697
*   IF CCAACROS=ON                  /* IF ACRQ DIR IN STOR   @Z67SP00*/
*     THEN                          /* FOR UPDATE THEN SET   @Z67SP00*/
@RC00695 L     @11,@CA00038                                        0698
         TM    CCAACROS-HMASMCCA(@11),B'00010000'                  0698
         BNO   @RF00698                                            0698
*     DISOSW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/
         OI    DISOSW,B'00001000'                                  0699
*   ELSE                            /*                       @Z67SP00*/
*     DISOSW=OFF;                   /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      UPDATE                @Z67SP00*/
         B     @RC00698                                            0700
@RF00698 NI    DISOSW,B'11110111'                                  0700
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON PDS  @Z67SP00*/
         B     PDSRTNS                                             0701
*                                                                  0702
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE SMPWRK1, SMPWRK2,SMPWRK3, SMPWRK4   @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0702
*WK1RTN:                            /*                       @Z67SP00*/
*   PDSI=WK1;                       /* SET INDEX INTO ARRAY  @Z67SP00*/
WK1RTN   MVI   PDSI,X'09'                                          0702
*   DSBFRMX=CCA1BFMX;               /* DS BLOCKING FACTOR    @Z67SP00*/
         L     @11,@CA00038                                        0703
         MVC   DSBFRMX(2),CCA1BFMX-HMASMCCA(@11)                   0703
*   GO TO WKXRTN;                   /*                       @Z67SP00*/
         B     WKXRTN                                              0704
*WK2RTN:                            /*                       @Z67SP00*/
*   PDSI=WK2;                       /* SET INDEX INTO ARRAY  @Z67SP00*/
WK2RTN   MVI   PDSI,X'0A'                                          0705
*   DSBFRMX=CCA2BFMX;               /* DS BLOCKING FACTOR    @Z67SP00*/
         L     @11,@CA00038                                        0706
         MVC   DSBFRMX(2),CCA2BFMX-HMASMCCA(@11)                   0706
*   GO TO WKXRTN;                   /*                       @Z67SP00*/
         B     WKXRTN                                              0707
*WK3RTN:                            /*                       @Z67SP00*/
*   PDSI=WK3;                       /* SET INDEX INTO ARRAY  @Z67SP00*/
WK3RTN   MVI   PDSI,X'0B'                                          0708
*   DSBFRMX=CCA3BFMX;               /* DS BLOCKING FACTOR    @Z67SP00*/
         L     @11,@CA00038                                        0709
         MVC   DSBFRMX(2),CCA3BFMX-HMASMCCA(@11)                   0709
*   GO TO WKXRTN;                   /*                       @Z67SP00*/
         B     WKXRTN                                              0710
*WK4RTN:                            /*                       @Z67SP00*/
*   PDSI=WK4;                       /* SET INDEX INTO ARRAY  @Z67SP00*/
WK4RTN   MVI   PDSI,X'0C'                                          0711
*   DSBFRMX=CCA4BFMX;               /* DS BLOCKING FACTOR    @Z67SP00*/
         L     @11,@CA00038                                        0712
         MVC   DSBFRMX(2),CCA4BFMX-HMASMCCA(@11)                   0712
*   DSBFPTRI=CCA4BFIA;              /* INPUT BUFFER          @Z67SP00*/
         MVC   DSBFPTRI(4),CCA4BFIA-HMASMCCA(@11)                  0713
*   DSBFPTRO=CCA4BFOA;              /* OUTPUT BUFFER         @Z67SP00*/
         MVC   DSBFPTRO(4),CCA4BFOA-HMASMCCA(@11)                  0714
*   DISISW=OFF;                     /* DIR NOT INSTORAGE     @Z67SP00*/
*   DISOSW=OFF;                     /* DIR NOT INSTORAGE     @Z67SP00*/
         NI    DISISW,B'11100111'                                  0716
*   GO TO PDSRTNS;                  /* BR TO COMMON PDS RTN  @Z67SP00*/
         B     PDSRTNS                                             0717
*WK5RTN:                            /*                       @Z67SP00*/
*   PDSI=WK5;                       /* SET INDEX INTO ARRAY  @Z67SP00*/
WK5RTN   MVI   PDSI,X'0D'                                          0718
*   DSBFRMX=ZERO;                   /* NO BUFFER             @Z67SP00*/
         SLR   @11,@11                                             0719
         STH   @11,DSBFRMX                                         0719
*   GO TO WKXRTN;                   /*                       @Z67SP00*/
         B     WKXRTN                                              0720
*WKXRTN:                            /*                       @Z67SP00*/
*   DSBFPTRI=CCAWBFIA;              /* INPUT BUFFER          @Z67SP00*/
WKXRTN   L     @11,@CA00038                                        0721
         MVC   DSBFPTRI(4),CCAWBFIA-HMASMCCA(@11)                  0721
*   DSBFPTRO=CCAWBFOA;              /* OUTPUT BUFFER         @Z67SP00*/
         MVC   DSBFPTRO(4),CCAWBFOA-HMASMCCA(@11)                  0722
*   DISISW=OFF;                     /* DIR NOT INSTORAGE     @Z67SP00*/
*   DISOSW=OFF;                     /* DIR NOT INSTORAGE     @Z67SP00*/
         NI    DISISW,B'11100111'                                  0724
*   GO TO PDSRTNS;                  /* BR TO COMMON PDS RTN  @Z67SP00*/
         B     PDSRTNS                                             0725
         EJECT
*                                                                  0726
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON LOGIC FOR SMP PDS DATASETS                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0726
*PDSRTNS:                                                          0726
*   PDSADDR=ADDR(PDSARRAY(PDSI));   /* PTR TO ARRAY FOR DS   @Z67SP00*/
*                                                                  0726
PDSRTNS  SLR   @11,@11                                             0726
         IC    @11,PDSI                                            0726
         SLA   @11,4                                               0726
         LA    @11,PDSARRAY-16(@11)                                0726
         ST    @11,PDSADDR                                         0726
*   /*****************************************************************/
*   /*                                                               */
*   /* SET VARIABLE MESSAGE PARTS TO PROPER ENTRY TYPE IN CASE ERROR */
*   /* DURING PROCESSING                                     @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0727
*   IF IOPFUNCT=IOPSTOWC            /* IF STOW CHANGE        @Z40SP00*/
*     THEN                          /* THEN ONLY INDICATE    @Z40SP00*/
         CLI   IOPFUNCT(IOPPTR),82                                 0727
         BNE   @RF00727                                            0727
*     IOPTYPE=IOPMEM;               /* MEMBER                @Z67SP00*/
*                                                                  0728
         MVI   IOPTYPE(IOPPTR),X'11'                               0728
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CLOSE OPERATION THEN RESET COUNTS OF NUMBER OF RECORDS IN  */
*   /* INPUT AND OUTPUT BUFFERS SO THAT NEXT TIME THRU PROCESSING    */
*   /* WILL PICK UP CORRECT COUNTS                           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0729
*   IF IOPFUNCT=IOPCLOSE            /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00727 CLI   IOPFUNCT(IOPPTR),80                                 0729
         BNE   @RF00729                                            0729
*     DO;                           /*                       @Z67SP00*/
*       DSBFCNTI=ZERO;              /*                       @Z67SP00*/
         SLR   @11,@11                                             0731
         L     @04,PDSADDR                                         0731
         STH   @11,DSBFCNTI(,@04)                                  0731
*       DSBFCNTO=ZERO;              /*                       @Z67SP00*/
         STH   @11,DSBFCNTO(,@04)                                  0732
*       DSBFRMX=ZERO;               /*                       @Z67SP00*/
         STH   @11,DSBFRMX                                         0733
*       GO TO GOODEXIT;             /*                       @Z67SP00*/
         B     GOODEXIT                                            0734
*     END;                          /*                       @Z67SP00*/
         EJECT
*                                                                  0736
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FUNCTION FOR SMP PDS OUTPUT OPERATION           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0736
*   IF IOPFUNCT>IOPCLOSE            /* OUTPUT OPERATION?     @Z40SP00*/
*     THEN                          /* YES - DO PROPER OUTPUT OP     */
@RF00729 CLI   IOPFUNCT(IOPPTR),80                                 0736
         BNH   @RF00736                                            0736
*     DO;                                                          0737
*                                                                  0737
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEB ADDR SAVE AREA NOT SET THEN SAVE CURRENT DEB       */
*       /*                                                   @XA12947*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0738
*       IF PDSDEBAD=ZERO            /* NEED TO SAVE DEB ADDR @Z67SP00*/
*         THEN                      /* YES - TEN SAVE IT     @XA12947*/
         L     @11,PDSADDR                                         0738
         ICM   @04,7,PDSDEBAD(@11)                                 0738
         BNZ   @RF00738                                            0738
*         PDSDEBAD=DCBDEBA;         /* GET DEB ADDR FROM DCB @Z67SP00*/
*                                                                  0739
         MVC   PDSDEBAD(3,@11),DCBDEBA+40(DCBPTR)                  0739
*       /*************************************************************/
*       /*                                                           */
*       /* IF EOF MEMBER TTR NOT OBTAINED BEFORE FIRST OUTPUT        */
*       /* OPERATION GET IT (EOTHER LOCATE OR CREATE IT)     @XA12947*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0740
*       IF EOFTTR=ZERO              /* EOF TTR BEEN OBTAINED @Z67SP00*/
*           &(IOPDSID=IOPCDS        /* AND DS IS CDS         @Z67SP00*/
*           ×IOPDSID=IOPSCDS        /* OR SCDS               @Z67SP00*/
*           ×IOPDSID=IOPACDS        /* OR ACDS               @Z67SP00*/
*           ×IOPDSID=IOPCRQ         /* OR CRQ                @Z67SP00*/
*           ×IOPDSID=IOPACRQ)       /* OR ACRQ               @Z67SP00*/
*         THEN                      /* NO - GET IT NOW       @XA12947*/
@RF00738 L     @11,PDSADDR                                         0740
         ICM   @04,7,EOFTTR(@11)                                   0740
         BNZ   @RF00740                                            0740
         CLI   IOPDSID(IOPPTR),2                                   0740
         BE    @RT00740                                            0740
         CLI   IOPDSID(IOPPTR),33                                  0740
         BE    @RT00740                                            0740
         CLI   IOPDSID(IOPPTR),12                                  0740
         BE    @RT00740                                            0740
         CLI   IOPDSID(IOPPTR),28                                  0740
         BE    @RT00740                                            0740
         CLI   IOPDSID(IOPPTR),30                                  0740
         BNE   @RF00740                                            0740
@RT00740 DS    0H                                                  0741
*         DO;                       /*                       @XA12947*/
*           SAVTTR=IOPTTR;          /* SAVE TTR ACROSS CALL TO EOFSTR
*                                      AS OPERATION MAY NOT BE ONE 0742
*                                      THAT RESETS TTR(IOPUDEO).   0742
*                                                            @ZA13037*/
         MVC   SAVTTR(3),IOPTTR(IOPPTR)                            0742
*           SAVUSERL=IOPUSERL;      /* SAVE USER DATA LEN AND ALIAS
*                                      INDICATOR             @ZA14019*/
         MVC   SAVUSERL(1),IOPUSERL(IOPPTR)                        0743
*           CALL EOFSTR;            /* GET EOF TTR           @XA12947*/
         BAL   @14,EOFSTR                                          0744
*           IOPTTR=SAVTTR;          /* TTR OF MEMBER         @XA12947*/
         MVC   IOPTTR(3,IOPPTR),SAVTTR                             0745
*           IOPUSERL=SAVUSERL;      /* RESET LEN AND ALIAS   @ZA14019*/
         MVC   IOPUSERL(1,IOPPTR),SAVUSERL                         0746
*           IF IOPRETRN^=IOPGOOD    /* IF ERROR IN GETTING   @XA12947*/
*             THEN                  /* EOF TTR THEN RETURN   @XA12947*/
         CLI   IOPRETRN(IOPPTR),0                                  0747
         BNE   @RT00747                                            0747
*             GO TO EXIT;           /* WITH CODE PASSED BACK @XA12947*/
*         END;                      /*                       @XA12947*/
*                                                                  0749
*       /*************************************************************/
*       /*                                                           */
*       /* FUNCTION IS SMP PDS STOW CHANGE OR DELETE         @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0750
*       IF IOPFUNCT=IOPSTOWC        /* IS THIS STOW CHANGE OPERATION */
*           ×IOPFUNCT=IOPSTOWD      /* OR STOW DELETE OPERATION?     */
*           ×IOPFUNCT=IOPUDEO       /* OR UPDATE DIRECT ONLY @Z67SP00*/
*         THEN                      /* YES                   @Z40SP00*/
@RF00740 CLI   IOPFUNCT(IOPPTR),82                                 0750
         BE    @RT00750                                            0750
         CLI   IOPFUNCT(IOPPTR),83                                 0750
         BE    @RT00750                                            0750
         CLI   IOPFUNCT(IOPPTR),86                                 0750
         BNE   @RF00750                                            0750
@RT00750 DS    0H                                                  0751
*         DO;                                                      0751
*           CALL STOW;              /* DELETE OR CHANGE THE ENTRY    */
         BAL   @14,STOW                                            0752
*           DSBFCNTO=ZERO;          /* RESET BUFFER COUNT    @Z67SP00*/
         L     @11,PDSADDR                                         0753
         SLR   @04,@04                                             0753
         STH   @04,DSBFCNTO(,@11)                                  0753
*           GO TO EXIT;             /* RETURN TO REQUESTOR           */
         B     EXIT                                                0754
*         END;                                                     0755
*                                                                  0755
*       /*************************************************************/
*       /*                                                           */
*       /* FUNCTION IS WRITE TO SMP PDS                      @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0756
*       IF IOPFUNCT=IOPWRITE        /* IS IT A WRITE OPERATION?      */
*         THEN                      /* YES - DO WRITE OPERATION      */
@RF00750 CLI   IOPFUNCT(IOPPTR),81                                 0756
         BNE   @RF00756                                            0756
*         DO;                                                      0757
*           DSBFCNTO=DSBFCNTO+1;    /* INCR RCDS IN BFR CNT  @SA74317*/
         L     @11,PDSADDR                                         0758
         LA    @04,1                                               0758
         AH    @04,DSBFCNTO(,@11)                                  0758
         STH   @04,DSBFCNTO(,@11)                                  0758
*           DSOBUFR(DSBFCNTO)=LOGICREC;/* MOVE RCD TO BUFF   @SA74317*/
         L     @03,DSBFPTRO                                        0759
         LR    @15,@04                                             0759
         MH    @15,@CH00512                                        0759
         ALR   @15,@03                                             0759
         AL    @15,@CF04248                                        0759
         L     @14,IOPBUFAD(,IOPPTR)                               0759
         MVC   DSOBUFR(80,@15),LOGICREC(@14)                       0759
*           WRITESW=ON;             /* INDICATE WRITE PERFORMED    0760
*                                                            @SA74317*/
         OI    WRITESW(@11),B'10000000'                            0760
*           IF DSBFCNTO>=DSBFRMX    /* BUFFER FULL?          @SA74317*/
*             THEN                  /* YES - WRITE IT        @SA74317*/
         CH    @04,DSBFRMX                                         0761
         BL    @RF00761                                            0761
*             DO;                   /*                       @SA74317*/
*               BUFFSV=IOPBUFAD;    /* SAVE BUFFER ADDR      @ZD00009*/
         ST    @14,BUFFSV                                          0763
*               IOPBUFAD=DSBFPTRO;  /* SET OUTPUT BUFFR ADDR @Z67SP00*/
         ST    @03,IOPBUFAD(,IOPPTR)                               0764
*               CALL WRITE;         /* WRITE RECORD TO THE CDS       */
         BAL   @14,WRITE                                           0765
*               IOPBUFAD=BUFFSV;    /* RESET BUFFER ADDR     @ZD00009*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0766
*               IF NOTESW=ON        /* NEED TO DUE NOTE?     @XA12947*/
*                 THEN              /* YES - DUE TO JCLIN    @XA12947*/
         L     @11,PDSADDR                                         0767
         TM    NOTESW(@11),B'01000000'                             0767
         BNO   @RF00767                                            0767
*                 DO;               /* PSEUDO STOW? THEN     @XA12947*/
*                   CALL NOTE(IOPTTR);/* DO NOTE TO GET TTR  @XA12947*/
         LA    @11,IOPTTR(,IOPPTR)                                 0769
         ST    @11,@AL00001                                        0769
         LA    @01,@AL00001                                        0769
         BAL   @14,NOTE                                            0769
*                   DCBRELAD(1:3)=IOPTTR;/* OF RCD JUST WRITTEN INTO
*                                      THE DCB FOR THE NEXT PSEUDO 0770
*                                      STOW                  @XA12947*/
         MVC   DCBRELAD(3,DCBPTR),IOPTTR(IOPPTR)                   0770
*                   NOTESW=OFF;     /* RESET SW TO PREVENT   @XA12947*/
         L     @11,PDSADDR                                         0771
         NI    NOTESW(@11),B'10111111'                             0771
*                 END;              /* NOTE ON NEXT WRITE    @XA12947*/
*               DSBFCNTO=ZERO;      /* INIT CNT OF RCD IN BUF      0773
*                                                            @SA74317*/
@RF00767 L     @11,PDSADDR                                         0773
         SLR   @04,@04                                             0773
         STH   @04,DSBFCNTO(,@11)                                  0773
*               GO TO EXIT;         /* RETURN TO CALLER.     @ZD00009*/
         B     EXIT                                                0774
*             END;                                                 0775
*           GO TO GOODEXIT;         /* MOVE TO BUFR OK - RTN @SA74317*/
         B     GOODEXIT                                            0776
*         END;                      /* END WRITE OPERATION   @SA74317*/
         EJECT
*                                                                  0778
*       /*************************************************************/
*       /*                                                           */
*       /* SMP PDS MEMBER IS TO BE REPLACED - CALCULATE LENGTH OF    */
*       /* USER DATA BY LOOPING THRU ENTRY TILL FF BYTE IS FOUND.    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0778
*       IF IOPFUNCT=IOPSTOWR        /* STOW REPLACE?         @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
@RF00756 CLI   IOPFUNCT(IOPPTR),84                                 0778
         BNE   @RF00778                                            0778
*         DO;                       /* DO OPERATION          @Z40SP00*/
*                                                                  0779
*           /*********************************************************/
*           /*                                                       */
*           /* CALULATE LENGTH OF USER DATA                  @ZD00004*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0780
*           CALL HMASMIO1(HMASMIOP,DIRLEN,XTNDLEN);/*        @Z67SP00*/
         MVC   @AL00001+4(8),@AL00780                              0780
         ST    IOPPTR,@AL00001                                     0780
         L     @15,@CV03345                                        0780
         LA    @01,@AL00001                                        0780
         BALR  @14,@15                                             0780
*           IF IOPTYPE^=IOPLMD      /* NOT LMOD ENTRY        @ZD00008*/
*               &IOPTYPE^=IOPASM    /* NOT ASM ENTRY         @ZD00008*/
*               &(IOPDSID=IOPCDS    /* FOR CDS               @Z67SP00*/
*               ×IOPDSID=IOPACDS    /* OR ACDS               @Z67SP00*/
*               ×IOPDSID=IOPSCDS    /* OR SCDS               @Z67SP00*/
*               ×                   /* OR                    @Z67SP00*/
*               (IOPDSID=IOPPTS     /* FOR PTS               @Z67SP00*/
*               &(IOPTYPE=IOPSMD    /* SYSMOD ENTRY          @Z67SP00*/
*               ×IOPTYPE=IOPSYS))   /* OR SYSTEM ENTRY       @Z67SP00*/
*               ×                   /* OR                    @Z67SP00*/
*               ((IOPDSID=IOPCRQ    /* CRQ                   @Z67SP00*/
*               ×IOPDSID=IOPACRQ)   /* OR ACRQ               @Z67SP00*/
*               &IOPTYPE=IOPFMD))   /* AND TYPE IS FMID      @Z67SP00*/
*             THEN                  /* NO - WRITE OUT RCD    @SA74317*/
         CLI   IOPTYPE(IOPPTR),2                                   0781
         BE    @RF00781                                            0781
         CLI   IOPTYPE(IOPPTR),1                                   0781
         BE    @RF00781                                            0781
         CLI   IOPDSID(IOPPTR),2                                   0781
         BE    @RT00781                                            0781
         CLI   IOPDSID(IOPPTR),12                                  0781
         BE    @RT00781                                            0781
         CLI   IOPDSID(IOPPTR),33                                  0781
         BE    @RT00781                                            0781
         CLI   IOPDSID(IOPPTR),6                                   0781
         BNE   @GL00050                                            0781
         CLI   IOPTYPE(IOPPTR),11                                  0781
         BE    @RT00781                                            0781
         CLI   IOPTYPE(IOPPTR),7                                   0781
         BE    @RT00781                                            0781
@GL00050 CLI   IOPDSID(IOPPTR),28                                  0781
         BE    @GL00056                                            0781
         CLI   IOPDSID(IOPPTR),30                                  0781
         BNE   @RF00781                                            0781
@GL00056 CLI   IOPTYPE(IOPPTR),14                                  0781
         BNE   @RF00781                                            0781
@RT00781 DS    0H                                                  0782
*             DO;                   /* FROM IOP              @SA74317*/
*               DSBFCNTO=ZERO;      /* INIT RCD IN BFR CNT   @SA74317*/
         SLR   @11,@11                                             0783
         L     @04,PDSADDR                                         0783
         STH   @11,DSBFCNTO(,@04)                                  0783
*               IOPUSERL=DIRLEN/2;  /* CALC DIR LENGTH IN HALFWORDS
*                                                            @Z67SP00*/
*                                                                  0784
         L     @00,DIRLEN                                          0784
         SRDA  @00,32                                              0784
         D     @00,@CF00183                                        0784
         STC   @01,IOPUSERL(,IOPPTR)                               0784
*               /*****************************************************/
*               /*                                                   */
*               /* IF GREATER THAN CAN BE CONTAINED IN ACTUAL USER   */
*               /* DATA AREA THEN WRITE OVERFLOW DATA TO DATA AREA IN*/
*               /* 80 BYTE MULTIPLES                         @Z40SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0785
*               IF XTNDLEN^=ZERO    /* IF DATA EXTENDED      @Z67SP00*/
*                 THEN              /* YES                   @SA74317*/
         C     @11,XTNDLEN                                         0785
         BE    @RF00785                                            0785
*                 DO;               /*                       @SA74317*/
*                   DO J=1 TO XTNDLEN BY PDSLRECL;/* WRITE EXTEND  0787
*                                      DATA                  @Z67SP00*/
         LA    @11,1                                               0787
         ST    @11,J                                               0787
         B     @DE00787                                            0787
@DL00787 DS    0H                                                  0788
*                     DSBFCNTO=DSBFCNTO+1;/* INCR RCD IN BUFR      0788
*                                                            @SA74317*/
         L     @04,PDSADDR                                         0788
         LA    @03,1                                               0788
         AH    @03,DSBFCNTO(,@04)                                  0788
         STH   @03,DSBFCNTO(,@04)                                  0788
*                     TMPCPTR1=ADDR(XTNDCHAR(J));/* PTR TO NXT NEXT
*                                      80 CHAR RECORD        @Z67SP00*/
         LA    @04,IOPUDATA(,IOPPTR)                               0789
         AL    @04,DIRLEN                                          0789
         BCTR  @04,0                                               0789
         LA    @11,XTNDCHAR(@11,@04)                               0789
         ST    @11,TMPCPTR1                                        0789
*                     DSOBUFR(DSBFCNTO)=TMPCPTR1->LOGICREC;/*      0790
*                                                            @SA74317*/
         L     @04,DSBFPTRO                                        0790
         LR    @15,@03                                             0790
         MH    @15,@CH00512                                        0790
         ALR   @15,@04                                             0790
         AL    @15,@CF04248                                        0790
         MVC   DSOBUFR(80,@15),LOGICREC(@11)                       0790
*                     IF DSBFCNTO>=DSBFRMX/* BUFFER FULL?    @SA74317*/
*                       THEN        /* YES                   @SA74317*/
         CH    @03,DSBFRMX                                         0791
         BL    @RF00791                                            0791
*                       DO;         /* WRITE IT OUT          @SA74317*/
*                         BUFFSV=IOPBUFAD;/* SAVE BUFFER ADDR      0793
*                                                            @ZD00009*/
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0793
*                         IOPBUFAD=DSBFPTRO;/* PTR TO BUFFER @Z67SP00*/
         ST    @04,IOPBUFAD(,IOPPTR)                               0794
*                         CALL WRITE;/* WRITE BLOCK          @SA74317*/
         BAL   @14,WRITE                                           0795
*                         IOPBUFAD=BUFFSV;/* RESET IOPBUFAD  @SA74317*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0796
*                         DSBFCNTO=ZERO;/* RESET RCD IN BLOCK      0797
*                                                            @SA74317*/
         L     @11,PDSADDR                                         0797
         SLR   @04,@04                                             0797
         STH   @04,DSBFCNTO(,@11)                                  0797
*                         IF NOTESW=ON/* NEED TO DUE NOTE?   @XA12947*/
*                           THEN    /* YES - DUE TO JCLIN    @XA12947*/
         TM    NOTESW(@11),B'01000000'                             0798
         BNO   @RF00798                                            0798
*                           DO;     /* PSEUDO STOW? THEN     @XA12947*/
*                             CALL NOTE(IOPTTR);/* DO NOTE TO GET TTR
*                                                            @XA12947*/
         LA    @11,IOPTTR(,IOPPTR)                                 0800
         ST    @11,@AL00001                                        0800
         LA    @01,@AL00001                                        0800
         BAL   @14,NOTE                                            0800
*                             DCBRELAD(1:3)=IOPTTR;/* OF RCD JUST  0801
*                                      WRITTEN INTO THE DCB FOR THE
*                                      NEXT PSEUDO STOW      @XA12947*/
         MVC   DCBRELAD(3,DCBPTR),IOPTTR(IOPPTR)                   0801
*                             NOTESW=OFF;/* RESET SW TO PREVENT    0802
*                                                            @XA12947*/
         L     @11,PDSADDR                                         0802
         NI    NOTESW(@11),B'10111111'                             0802
*                           END;    /* NOTE ON NEXT WRITE    @XA12947*/
*                       END;        /* END WRITE GROUP       @SA74317*/
@RF00798 DS    0H                                                  0805
*                   END;            /* END DO WRITE GROUP    @SA74317*/
@RF00791 LA    @11,80                                              0805
         AL    @11,J                                               0805
         ST    @11,J                                               0805
@DE00787 C     @11,XTNDLEN                                         0805
         BNH   @DL00787                                            0805
*                 END;              /* END DIR EXTENDED      @SA74317*/
*                                                                  0806
*               /*****************************************************/
*               /*                                                   */
*               /* MEMBER IS DIRECTORY ONLY. INDICATE IT AS AN ALIAS */
*               /* OF EOF MEMBER. IF EOF NOT PRESENT, STOW IT AND    */
*               /* RELOCATE IT TO OBTAIN TTR OF THE EOF RECORD       */
*               /* ASSIGNED AND WRITTEN BY STOW. THE TTR IS PLACED IN*/
*               /* THE DIRECTORY-ONLY CDS MEMBERS.           @SA74317*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0807
*               ELSE                /* DIR NOT EXTENDED      @SA74317*/
*                 DO;               /*                       @SA74317*/
         B     @RC00785                                            0807
@RF00785 DS    0H                                                  0808
*                   IOPALIS=ON;     /* SET ALIAS INDICATOR   @Z67SP00*/
         OI    IOPALIS(IOPPTR),B'10000000'                         0808
*                   IOPTTR=EOFTTR;  /* SET TTR TO EOF TTR    @Z67SP00*/
         L     @11,PDSADDR                                         0809
         MVC   IOPTTR(3,IOPPTR),EOFTTR(@11)                        0809
*                   DSBFCNTO=ZERO;  /* RESET BUFFER COUNT    @Z67SP00*/
         SLR   @04,@04                                             0810
         STH   @04,DSBFCNTO(,@11)                                  0810
*                 END;              /*                       @SA74317*/
*             END;                  /* END NOT LMOD/ASM      @SA74317*/
*                                                                  0812
@RC00785 DS    0H                                                  0813
*           /*********************************************************/
*           /*                                                       */
*           /* BEFORE DOING STOW WRITE OUT SHORT BLOCK IF ONE. THIS  */
*           /* IS DONE FOR ALL TYPES OF ENTRIES(LMODS AND ASM).      */
*           /*                                               @SA74317*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0813
*           IF DSBFCNTO^=ZERO       /* ANY RCDS IN BUFFER?   @SA74317*/
*             THEN                  /* YES                   @SA74317*/
@RF00781 L     @11,PDSADDR                                         0813
         LH    @11,DSBFCNTO(,@11)                                  0813
         LTR   @11,@11                                             0813
         BZ    @RF00813                                            0813
*             DO;                   /* WRITE SHORT BLOCK     @SA74317*/
*               BUFFSV=IOPBUFAD;    /* SAVE BUFFER ADDR      @ZD00009*/
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0815
*               IOPBUFAD=DSBFPTRO;  /* PTR TO BUFFER         @Z67SP00*/
         MVC   IOPBUFAD(4,IOPPTR),DSBFPTRO                         0816
*               DCBBLKSI=DSBFCNTO*PDSLRECL;/* RESET BLOCK LENGTH   0817
*                                                            @SA74317*/
         MH    @11,@CH00512                                        0817
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0817
*               CALL WRITE;         /* WRITE IT              @SA74317*/
         BAL   @14,WRITE                                           0818
*               DCBBLKSI=DSBFRMX*PDSLRECL;/* RESET BLOCKSIZE @SA74317*/
         LH    @11,DSBFRMX                                         0819
         MH    @11,@CH00512                                        0819
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0819
*               IOPBUFAD=BUFFSV;    /* RESET IOPBUFAD        @SA74317*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0820
*               DSBFCNTO=ZERO;      /* RESET RCD IN BUFR COUNT     0821
*                                                            @SA74317*/
         L     @11,PDSADDR                                         0821
         SLR   @04,@04                                             0821
         STH   @04,DSBFCNTO(,@11)                                  0821
*               IF NOTESW=ON        /* NEED TO DUE NOTE?     @XA12947*/
*                 THEN              /* YES - DUE TO JCLIN    @XA12947*/
         TM    NOTESW(@11),B'01000000'                             0822
         BNO   @RF00822                                            0822
*                 DO;               /* PSEUDO STOW? THEN     @XA12947*/
*                   CALL NOTE(IOPTTR);/* DO NOTE TO GET TTR  @XA12947*/
         LA    @11,IOPTTR(,IOPPTR)                                 0824
         ST    @11,@AL00001                                        0824
         LA    @01,@AL00001                                        0824
         BAL   @14,NOTE                                            0824
*                   DCBRELAD(1:3)=IOPTTR;/* OF RCD JUST WRITTEN INTO
*                                      THE DCB FOR THE NEXT PSEUDO 0825
*                                      STOW                  @XA12947*/
         MVC   DCBRELAD(3,DCBPTR),IOPTTR(IOPPTR)                   0825
*                   NOTESW=OFF;     /* RESET SW TO PREVENT   @XA12947*/
         L     @11,PDSADDR                                         0826
         NI    NOTESW(@11),B'10111111'                             0826
*                 END;              /* NOTE ON NEXT WRITE    @XA12947*/
*             END;                  /*                       @SA74317*/
*                                                                  0828
@RF00822 DS    0H                                                  0829
*           /*********************************************************/
*           /*                                                       */
*           /* ALL DATA RECORD WRITTEN TO DATASET. NOW STOW  @Z67SP00*/
*           /* NOW DO STOW FOR MEMBER                        @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0829
*           CALL STOW;              /* STOW THE ENTRY        @Z67SP00*/
@RF00813 BAL   @14,STOW                                            0829
*           WRITESW=OFF;            /* INDICATE NO WRITE HAS BEEN  0830
*                                      DONE                          */
*                                                                  0830
         L     @11,PDSADDR                                         0830
         NI    WRITESW(@11),B'01111111'                            0830
*           /*********************************************************/
*           /*                                                       */
*           /* IF DATA SET HAS BEEN EXTENDED CLOSE BOTH INPUT AND    */
*           /* OUTPUT DCBS TO INSURE THAT EXTENSION IS BROUGHT IN FOR*/
*           /* NEXT INPUT OPERATION                          @ZD00004*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0831
*           IF DCBDEBA^=PDSDEBAD    /* HAS DEB BEEN MOVED?   @Z67SP00*/
*             THEN                  /* YES - DATA SET HAS NEW EXTENT */
         CLC   DCBDEBA+40(3,DCBPTR),PDSDEBAD(@11)                  0831
         BE    @RF00831                                            0831
*             DO;                                                  0832
*               PDSDEBAD=ZERO;      /* SET TO SAVE DEB NEXT TIME THRU
*                                      OUTPUT FUNCTION       @Z67SP00*/
         SLR   @04,@04                                             0833
         STCM  @04,7,PDSDEBAD(@11)                                 0833
*               DCBPTR=DCBS(IOPDSID,IN);/* CLOSE INPUT DCB FOR THIS
*                                      DATA SET              @ZA12350*/
         SLR   @11,@11                                             0834
         IC    @11,IOPDSID(,IOPPTR)                                0834
         SLA   @11,4                                               0834
         L     DCBPTR,DCBS-16(@11)                                 0834
*               GEN(CLOSE ((DCBPTR)));/* CLOSE DCB           @XA12947*/
         CLOSE ((DCBPTR))
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @XA12947*/
*                 THEN              /* YES                   @XA12947*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0836
         BO    @RT00836                                            0836
*                 GO TO CLOSFAIL;   /* GO WRITE ERR MSG      @XA12947*/
*               DCBPTR=DCBS(IOPDSID,OUT);/* CLOSE OUTPUT DCB FOR THIS
*                                      DATA SET              @ZA12350*/
         SLR   @11,@11                                             0838
         IC    @11,IOPDSID(,IOPPTR)                                0838
         SLA   @11,4                                               0838
         L     DCBPTR,DCBS-8(@11)                                  0838
*               GEN(CLOSE ((DCBPTR)));/* CLOSE INPUT DCB     @XA12947*/
         CLOSE ((DCBPTR))
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @XA12947*/
*                 THEN              /* YES                   @XA12947*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0840
         BO    @RT00840                                            0840
*                 GO TO CLOSFAIL;   /* GO WRITE ERR MSG      @XA12947*/
*             END;                  /*                       @XA12947*/
*           GO TO EXIT;             /* RETURN TO REQUESTOR           */
         B     EXIT                                                0843
*         END;                      /* END STOW REPLACE CODE @Z40SP00*/
         EJECT
*                                                                  0845
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF REQUEST TO WRITE OUT IN-STORAGE COPY OF   */
*       /* DIRECTORY                                         @ZD00003*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0845
*       IF IOPFUNCT=IOPWRDIR        /* IF WRITE DIR REQUEST  @ZD00003*/
*         THEN                      /*                       @ZD00003*/
@RF00778 CLI   IOPFUNCT(IOPPTR),89                                 0845
         BNE   @RF00845                                            0845
*         DO;                       /*                       @ZD00003*/
*           CALL HMASMEIS(HMASMIOP);/* CALL EIS TO WRITE IT  @ZD00003*/
         ST    IOPPTR,@AL00001                                     0847
         L     @15,@CV03343                                        0847
         LA    @01,@AL00001                                        0847
         BALR  @14,@15                                             0847
*           GO TO EXIT;             /* GO TO RETURN CODE     @ZD00003*/
         B     EXIT                                                0848
*         END;                      /*                       @ZD00003*/
*                                                                  0849
*       /*************************************************************/
*       /*                                                           */
*       /* INVALID OUTPUT REQUEST FOR SMP PDS                @Z40SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0850
*       IOPRETRN=IOPIOERR;          /* INVALID REQUEST SET   @Z67SP00*/
@RF00845 MVI   IOPRETRN(IOPPTR),X'10'                              0850
*       GO TO EXIT;                 /* BAD RTN AND EXIT      @Z40SP00*/
         B     EXIT                                                0851
*     END;                          /* END OF FUNCTION IS OUTPUT TYPE*/
         EJECT
*                                                                  0853
*   /*****************************************************************/
*   /*                                                               */
*   /* PDS READ OPERATION. IF NO MORE RECORDS IN CURRENT BUFFER READ */
*   /* IN ANOTHER BLOCK AND RESET INDEX INTO BLOCK. MOVE RECORD      */
*   /* POINTED TO BE INDEX FROM BLOCK TO USER BUFFER AREA    @YA07506*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0853
*   IF IOPFUNCT=IOPREAD             /* IS IT READ OPERATION?         */
*     THEN                          /* YES - ISSUE READ              */
@RF00736 CLI   IOPFUNCT(IOPPTR),1                                  0853
         BNE   @RF00853                                            0853
*     DO;                                                          0854
*       DSBFCNTI=DSBFCNTI+1;        /* INCR BUFFER NUMBER    @SA74317*/
         L     @11,PDSADDR                                         0855
         LA    @04,1                                               0855
         AH    @04,DSBFCNTI(,@11)                                  0855
         STH   @04,DSBFCNTI(,@11)                                  0855
*       IF DSBFCNTI>DSBFSIZI        /* NO MORE RCDS IN BLOCK @SA74317*/
*         THEN                      /* NO                    @SA74317*/
         CH    @04,DSBFSIZI(,@11)                                  0856
         BNH   @RF00856                                            0856
*         DO;                       /* GET NEXT BLOCK        @SA74317*/
*           BUFFSV=IOPBUFAD;        /* SAVE BUFFER ADDR      @ZD00009*/
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0858
*           IOPBUFAD=DSBFPTRI;      /* PTR TO INPUT BUFFR    @Z67SP00*/
         MVC   IOPBUFAD(4,IOPPTR),DSBFPTRI                         0859
*           CALL READ;              /* READ A PDS RECORD             */
         BAL   @14,READ                                            0860
*           IOPBUFAD=BUFFSV;        /* RESET IOPBUFAD        @SA74317*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0861
*           IF IOPRETRN=IOPGOOD     /* READ OK?              @SA74317*/
*               &DSBFRMX>ONE        /* AND PDS BLOCKED       @SA74317*/
*             THEN                  /* YES                   @SA74317*/
         CLI   IOPRETRN(IOPPTR),0                                  0862
         BNE   @RF00862                                            0862
         LH    @11,DSBFRMX                                         0862
         CH    @11,@CH00088                                        0862
         BNH   @RF00862                                            0862
*             DSBFSIZI=(DCBBLKSI-IOBRSCT)/PDSLRECL;/* CALC   @SA74317*/
         LA    @11,52                                              0863
         ALR   @11,DCBPTR                                          0863
         L     @04,DCBIOBA(,@11)                                   0863
         LH    @00,DCBBLKSI(,@11)                                  0863
         SH    @00,IOBRSCT+8(,@04)                                 0863
         SRDA  @00,32                                              0863
         D     @00,@CF00512                                        0863
         L     @11,PDSADDR                                         0863
         STH   @01,DSBFSIZI(,@11)                                  0863
*           ELSE                    /* RCD IN BLOCK          @SA74317*/
*             DSBFSIZI=ONE;         /* ELSE 1 RCD/BLK        @SA74317*/
         B     @RC00862                                            0864
@RF00862 L     @11,PDSADDR                                         0864
         MVC   DSBFSIZI(2,@11),@CH00088                            0864
*           DSBFCNTI=ONE;           /* SET TO MOVE FIRST RCD @SA74317*/
@RC00862 L     @11,PDSADDR                                         0865
         MVC   DSBFCNTI(2,@11),@CH00088                            0865
*         END;                      /* END READ GROUP        @SA74317*/
*       IF IOPRETRN=IOPEOF          /* END OF FILE?          @SA74317*/
*         THEN                      /* YES                   @SA74317*/
@RF00856 CLI   IOPRETRN(IOPPTR),4                                  0867
         BNE   @RF00867                                            0867
*         DSBFCNTI=ZERO;            /* RESET RCD COUNT       @SA74317*/
         L     @11,PDSADDR                                         0868
         SLR   @04,@04                                             0868
         STH   @04,DSBFCNTI(,@11)                                  0868
*       ELSE                        /* NOT EOF               @SA74317*/
*         LOGICREC=DSIBUFR(DSBFCNTI);/* MV RCD TO USER BUFR  @SA74317*/
         B     @RC00867                                            0869
@RF00867 L     @11,IOPBUFAD(,IOPPTR)                               0869
         L     @04,PDSADDR                                         0869
         LH    @04,DSBFCNTI(,@04)                                  0869
         MH    @04,@CH00512                                        0869
         L     @03,DSBFPTRI                                        0869
         ALR   @03,@04                                             0869
         AL    @03,@CF04248                                        0869
         MVC   LOGICREC(80,@11),DSIBUFR(@03)                       0869
*       GO TO EXIT;                 /* RETURN TO REQUESTOR           */
         B     EXIT                                                0870
*     END;                                                         0871
*                                                                  0871
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTION IS PDS POSITION FOR INPUT(POINT) ISSUE POINT AND     */
*   /* RETURN                                                @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0872
*   IF IOPFUNCT=IOPPOSI             /* POSITION INPUT OPERATION?     */
*     THEN                          /* YES - POINT AND RETURN        */
@RF00853 CLI   IOPFUNCT(IOPPTR),2                                  0872
         BNE   @RF00872                                            0872
*     DO;                                                          0873
*       CALL POINT;                 /* POSITION FOR INPUT            */
         BAL   @14,POINT                                           0874
*       DSBFCNTI=ZERO;              /* INIT INDEX INTO BLOCK @SA74317*/
         SLR   @11,@11                                             0875
         L     @04,PDSADDR                                         0875
         STH   @11,DSBFCNTI(,@04)                                  0875
*       DSBFSIZI=ZERO;              /* INIT NUM RCD IN BLOCK @SA74317*/
         STH   @11,DSBFSIZI(,@04)                                  0876
*       GO TO EXIT;                 /* AND RETURN            @Z40SP00*/
         B     EXIT                                                0877
*     END;                                                         0878
         EJECT
*                                                                  0879
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTION IS SMPCDS/SMPACDS LOCATE OR BLDL. IF FUNCTION WAS    */
*   /* BLDL OR IF MEMBER IS ALIAS RETURN ELSE READ DIRECTORY         */
*   /* EXTENSION.                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0879
*   IF IOPFUNCT=IOPLOC              /* LOCATE?               @Z40SP00*/
*       ×IOPFUNCT=IOPBLDL           /* OR BLDL?              @Z40SP00*/
*       ×IOPFUNCT=IOPXTND           /* OR EXTEND NTRY IN IOP @ZD00002*/
*     THEN                          /* YES                   @Z40SP00*/
@RF00872 CLI   IOPFUNCT(IOPPTR),3                                  0879
         BE    @RT00879                                            0879
         CLI   IOPFUNCT(IOPPTR),4                                  0879
         BE    @RT00879                                            0879
         CLI   IOPFUNCT(IOPPTR),7                                  0879
         BNE   @RF00879                                            0879
@RT00879 DS    0H                                                  0880
*     DO;                           /*                       @Z40SP00*/
*                                                                  0880
*       /*************************************************************/
*       /*                                                           */
*       /* CALC DIRECTORY LENGTH                             @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0881
*       CALL HMASMIO1(HMASMIOP,DIRLEN,XTNDLEN);/*            @Z67SP00*/
         MVC   @AL00001+4(8),@AL00881                              0881
         ST    IOPPTR,@AL00001                                     0881
         L     @15,@CV03345                                        0881
         LA    @01,@AL00001                                        0881
         BALR  @14,@15                                             0881
*       IF IOPFUNCT^=IOPXTND        /* IF DIR DATA NOT ALREADY IN IOP
*                                                            @ZD00002*/
*         THEN                      /* THEN GET IT VIA BLDL  @ZD00002*/
         CLI   IOPFUNCT(IOPPTR),7                                  0882
         BE    @RF00882                                            0882
*         DO;                       /*                       @Z67SP00*/
*           CALL BLDL;              /* LOCATE MEMBER IN THE CDS      */
         BAL   @14,BLDL                                            0884
*           IF IOPRETRN=IOPNTFND    /* IF NOT FOUND          @Z67SP00*/
*               &IOPTYPE=IOPSYS     /* AND WAS SYSTEM ENTRY  @Z67SP00*/
*               &(IOPDSID=IOPCDS×IOPDSID=IOPACDS)/* CDS      @Z67SP00*/
*             THEN                  /* FORMAT THEN TRY TO    @Z67SP00*/
         CLI   IOPRETRN(IOPPTR),4                                  0885
         BNE   @RF00885                                            0885
         CLI   IOPTYPE(IOPPTR),7                                   0885
         BNE   @RF00885                                            0885
         CLI   IOPDSID(IOPPTR),2                                   0885
         BE    @RT00885                                            0885
         CLI   IOPDSID(IOPPTR),12                                  0885
         BNE   @RF00885                                            0885
@RT00885 DS    0H                                                  0886
*             DO;                   /* LOC IN R3 FORMAT      @Z67SP00*/
*               SAVSYS=IOPINAME;    /* SAVE R4 INTERNAL      @Z67SP00*/
         MVC   SAVSYS(8),IOPINAME(IOPPTR)                          0887
*               IOPINAME=OLDSYS;    /* SET NAME              @Z67SP00*/
         MVC   IOPINAME(8,IOPPTR),@CC03371                         0888
*               CALL BLDL;          /* LOCATE IT             @Z67SP00*/
         BAL   @14,BLDL                                            0889
*               IOPINAME=SAVSYS;    /* RESET NAME            @Z67SP00*/
         MVC   IOPINAME(8,IOPPTR),SAVSYS                           0890
*             END;                  /*                       @Z67SP00*/
*         END;                      /*                       @Z67SP00*/
@RF00885 DS    0H                                                  0893
*       IF IOPRETRN^=IOPGOOD        /* IF MEMBER NOT FOUND   @YA07506*/
*           ×IOPFUNCT=IOPBLDL       /* OR WAS BLDL ONLY      @Z40SP00*/
*         THEN                      /* YES - THEN NO EXTENSION       */
@RF00882 CLI   IOPRETRN(IOPPTR),0                                  0893
         BNE   @RT00893                                            0893
         CLI   IOPFUNCT(IOPPTR),4                                  0893
         BE    @RT00893                                            0893
*         GO TO EXIT;               /* RETURN TO REQUESTOR           */
*       IF IOPTYPE=IOPSMD           /* IF SYSMOD TYPE        @Z67SP00*/
*           &IOPDUMMP=ON            /* AND NO DATA           @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         CLI   IOPTYPE(IOPPTR),11                                  0895
         BNE   @RF00895                                            0895
         TM    IOPDUMMP(IOPPTR),B'00000100'                        0895
         BNO   @RF00895                                            0895
*         DO;                       /*                       @Z67SP00*/
*           IOPPTFFX=''B;           /* ZERO FIXED FIELDS     @Z67SP00*/
         XC    IOPPTFFX(80,IOPPTR),IOPPTFFX(IOPPTR)                0897
*           IOPPFMID='';            /* BLANK FMID FIELD      @Z67SP00*/
         MVI   IOPPFMID(IOPPTR),C' '                               0898
         MVC   IOPPFMID+1(6,IOPPTR),IOPPFMID(IOPPTR)               0898
*           IOPPTFND(1)=IOPEOLST;   /* SET END OF LIST MARK  @Z67SP00*/
         MVI   IOPPTFND(IOPPTR),X'FF'                              0899
*           GO TO GOODEXIT;         /*                       @Z67SP00*/
         B     GOODEXIT                                            0900
*         END;                      /*                       @Z67SP00*/
*       IF IOPALIS=ON               /* IF ALIAS              @Z67SP00*/
*           ×IOPDSID=IOPWK5         /* OR SMPWRK5 DATASET    @Z67SP00*/
*           ×IOPTYPE=IOPASM         /* OR ASM?               @ZD00004*/
*           ×(IOPDSID=IOPPTS        /* OR PTS DATASET        @Z67SP00*/
*           &IOPTYPE=IOPMCS)        /* AND MCS TYPE ENTRY    @Z67SP00*/
*           ×IOPDSID=IOPMTS         /* OR MTS                @Z67SP00*/
*           ×IOPDSID=IOPSTS         /* OR STS                @Z67SP00*/
*           ×((IOPDSID=IOPCRQ×IOPDSID=IOPACRQ)/* OR CRQ/ACRQ @Z67SP00*/
*           &IOPTYPE=IOPCSR)        /* CAUSER ENTRY          @Z67SP00*/
*         THEN                      /* THEN NO EXTEND DATA   @ZD00004*/
@RF00895 TM    IOPALIS(IOPPTR),B'10000000'                         0902
         BO    @RT00902                                            0902
         CLI   IOPDSID(IOPPTR),39                                  0902
         BE    @RT00902                                            0902
         CLI   IOPTYPE(IOPPTR),1                                   0902
         BE    @RT00902                                            0902
         CLI   IOPDSID(IOPPTR),6                                   0902
         BNE   @GL00068                                            0902
         CLI   IOPTYPE(IOPPTR),16                                  0902
         BE    @RT00902                                            0902
@GL00068 CLI   IOPDSID(IOPPTR),18                                  0902
         BE    @RT00902                                            0902
         CLI   IOPDSID(IOPPTR),26                                  0902
         BE    @RT00902                                            0902
         CLI   IOPDSID(IOPPTR),28                                  0902
         BE    @GL00073                                            0902
         CLI   IOPDSID(IOPPTR),30                                  0902
         BNE   @RF00902                                            0902
@GL00073 CLI   IOPTYPE(IOPPTR),15                                  0902
         BE    @RT00902                                            0902
*         GO TO GOODEXIT;           /* RETURN                @ZD00004*/
*                                                                  0903
*       /*************************************************************/
*       /*                                                           */
*       /* THIS DIRECTORY ENTRY IS EXTENDED - READ EXTENSION FROM THE*/
*       /* SMPCDS/SMPACDS DATA PORTION AND APPEND IT TO THE USER DATA*/
*       /* FIELD IN THE HMASMIOP                             @Z40SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0904
*       CALL POINT;                 /* POSITION TO READ EXTENSION    */
@RF00902 BAL   @14,POINT                                           0904
*       DSBFCNTI=ONE;               /* SET INDEX INTO BLOCK TO MOVE
*                                      FIRST RCD             @SA74317*/
         LA    @11,1                                               0905
         L     @04,PDSADDR                                         0905
         STH   @11,DSBFCNTI(,@04)                                  0905
*       DSBFSIZI=ZERO;              /* SET NUM OF RCDS IN BLOCK TO 0906
*                                      ZERO TO FORCE READ    @SA74317*/
         SLR   @03,@03                                             0906
         STH   @03,DSBFSIZI(,@04)                                  0906
*       DO N=1 TO CCAPESIZ-DIRLEN BY PDSLRECL;/* LOOP TO READ      0907
*                                      EXTENSION             @Z67SP00*/
         ST    @11,N                                               0907
         B     @DE00907                                            0907
@DL00907 DS    0H                                                  0908
*         IF DSBFCNTI>DSBFSIZI      /* ANY MORE RCDS IN BLK? @SA74317*/
*           THEN                    /* NO                    @SA74317*/
         L     @11,PDSADDR                                         0908
         LH    @04,DSBFCNTI(,@11)                                  0908
         CH    @04,DSBFSIZI(,@11)                                  0908
         BNH   @RF00908                                            0908
*           DO;                     /* READ ANOTHER BLOCK    @SA74317*/
*             BUFFSV=IOPBUFAD;      /* SAVE BUFFER ADDR      @ZD00009*/
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0910
*             IOPBUFAD=DSBFPTRI;    /* PTR TO INPUT BUFFER   @Z67SP00*/
         MVC   IOPBUFAD(4,IOPPTR),DSBFPTRI                         0911
*             CALL READ;            /* READ EXTENSION MEMBER RECORD  */
         BAL   @14,READ                                            0912
*             IOPBUFAD=BUFFSV;      /* RESET IOPBUFAD        @SA74317*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0913
*             IF IOPRETRN=IOPGOOD   /* READ OK?              @SA74317*/
*                 &DSBFRMX>ONE      /* AND PDS BLOCKED?      @SA74317*/
*               THEN                /* YES - CALC RCD PER BLK      0914
*                                                            @SA74317*/
         CLI   IOPRETRN(IOPPTR),0                                  0914
         BNE   @RF00914                                            0914
         LH    @11,DSBFRMX                                         0914
         CH    @11,@CH00088                                        0914
         BNH   @RF00914                                            0914
*               DSBFSIZI=(DCBBLKSI-IOBRSCT)/PDSLRECL;/*      @SA74317*/
         LA    @11,52                                              0915
         ALR   @11,DCBPTR                                          0915
         L     @04,DCBIOBA(,@11)                                   0915
         LH    @00,DCBBLKSI(,@11)                                  0915
         SH    @00,IOBRSCT+8(,@04)                                 0915
         SRDA  @00,32                                              0915
         D     @00,@CF00512                                        0915
         L     @11,PDSADDR                                         0915
         STH   @01,DSBFSIZI(,@11)                                  0915
*             ELSE                  /* PDS NOT BLOCKED       @SA74317*/
*               DSBFSIZI=ONE;       /* SET BLOCKING FACTOR   @SA74317*/
         B     @RC00914                                            0916
@RF00914 L     @11,PDSADDR                                         0916
         MVC   DSBFSIZI(2,@11),@CH00088                            0916
*             DSBFCNTI=ZERO;        /* INIT INDEX IN CASE READ ERR 0917
*                                                            @SA74317*/
@RC00914 L     @11,PDSADDR                                         0917
         SLR   @04,@04                                             0917
         STH   @04,DSBFCNTI(,@11)                                  0917
*             IF IOPRETRN=IOPEOF    /* HAVE ALL RECORDS BEEN READ?   */
*               THEN                /* YES                   @Z40SP00*/
         CLI   IOPRETRN(IOPPTR),4                                  0918
         BE    @RT00918                                            0918
*               GO TO GOODEXIT;     /* RETURN WITH RC=0      @ZD00004*/
*             IF IOPRETRN>IOPEOF    /* I/O ERROR?                    */
*               THEN                /* EXIT TO REQUESTOR             */
         CLI   IOPRETRN(IOPPTR),4                                  0920
         BH    @RT00920                                            0920
*               GO TO EXIT;         /* WITH ERROR INDICATOR          */
*             DSBFCNTI=ONE;         /* SET TO MOVE FIRST RCD @SA74317*/
         MVC   DSBFCNTI(2,@11),@CH00088                            0922
*           END;                    /* END READ GROUP        @SA74317*/
*         TMPCPTR1=ADDR(XTNDCHAR(N));/* PTR TO NXT 80 CHARS  @Z40SP00*/
@RF00908 L     @11,N                                               0924
         LA    @04,IOPUDATA(,IOPPTR)                               0924
         AL    @04,DIRLEN                                          0924
         BCTR  @04,0                                               0924
         LA    @04,XTNDCHAR(@11,@04)                               0924
         ST    @04,TMPCPTR1                                        0924
*         TMPCPTR1->LOGICREC=DSIBUFR(DSBFCNTI);/* MOVE RCD FROM BLOCK
*                                      TO IOP AREA           @SA74317*/
         L     @03,PDSADDR                                         0925
         LH    @15,DSBFCNTI(,@03)                                  0925
         LR    @14,@15                                             0925
         MH    @14,@CH00512                                        0925
         L     @01,DSBFPTRI                                        0925
         ALR   @01,@14                                             0925
         AL    @01,@CF04248                                        0925
         MVC   LOGICREC(80,@04),DSIBUFR(@01)                       0925
*         IF IOPTYPE=IOPLMD         /* IF LMOD THEN RETURN   @Z67SP00*/
*           THEN                    /* AFTER READING FIRST   @Z67SP00*/
         CLI   IOPTYPE(IOPPTR),2                                   0926
         BE    @RT00926                                            0926
*           GOTO EXIT;              /* DATA RECORD           @Z67SP00*/
*         DSBFCNTI=DSBFCNTI+ONE;    /* INCR INDEX TO NEXT RCD      0928
*                                                            @SA74317*/
         AH    @15,@CH00088                                        0928
         STH   @15,DSBFCNTI(,@03)                                  0928
*       END;                                                       0929
*                                                                  0929
         AL    @11,@CF00512                                        0929
         ST    @11,N                                               0929
@DE00907 L     @04,@CA00038                                        0929
         L     @04,CCAPESIZ-HMASMCCA(,@04)                         0929
         SL    @04,DIRLEN                                          0929
         CR    @11,@04                                             0929
         BNH   @DL00907                                            0929
*       /*************************************************************/
*       /*                                                           */
*       /* IOP FULL. CHECK FOR ANY MORE RCDS IN BLOCK OR TRY ANOTHER */
*       /* READ TO CHECK FOR EOF CONDITION                   @SA74317*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0930
*       IF DSBFCNTI>DSBFSIZI        /* ANY MORE RCDS IN BLOCK?     0930
*                                                            @SA74317*/
*         THEN                      /* NO                    @SA74317*/
         L     @11,PDSADDR                                         0930
         LH    @04,DSBFCNTI(,@11)                                  0930
         CH    @04,DSBFSIZI(,@11)                                  0930
         BNH   @RF00930                                            0930
*         DO;                       /* TRY ANOTHER READ      @SA74317*/
*           BUFFSV=IOPBUFAD;        /* SAVE BUFFER ADDR      @ZD00009*/
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0932
*           IOPBUFAD=DSBFPTRI;      /* PTR TO INPUT BUFFER   @Z67SP00*/
         MVC   IOPBUFAD(4,IOPPTR),DSBFPTRI                         0933
*           CALL READ;              /* DO READ               @SA74317*/
         BAL   @14,READ                                            0934
*           IOPBUFAD=BUFFSV;        /* RESET IOPBUFAD        @SA74317*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0935
*           IF IOPRETRN=IOPEOF      /* END OF FILE?          @SA74317*/
*             THEN                  /* YES - THEN LOC OK     @SA74317*/
         CLI   IOPRETRN(IOPPTR),4                                  0936
         BE    @RT00936                                            0936
*             GO TO GOODEXIT;       /* RETURN WITH RC=0      @ZD00004*/
*         END;                      /* MORE RCD THAN IOP - ERR     0938
*                                                            @SA74317*/
*       MGPMGNO1=HMA219I;           /* PTF ELEMENT MAXIMUM EXCEEDED
*                                                            @Z67SP00*/
@RF00930 MVC   MGPMGNO1(2),@CH00355                                0939
*       MGPMGNO2=PART032;           /* FOR XXXXXXXX XXXXXXXX @Z67SP00*/
         MVC   MGPMGNO2(2),@CH00086                                0940
*       MGPMGNO3=PART016;           /* ON XXXXXXXX LIBRARY   @Z67SP00*/
         MVC   MGPMGNO3(2),@CH00188                                0941
*       MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE MEMBER   @ZD00008*/
         SLR   @11,@11                                             0942
         IC    @11,IOPTYPE(,IOPPTR)                                0942
         SLA   @11,3                                               0942
         L     @04,@CA00038                                        0942
         L     @03,CCATPAD-HMASMCCA(,@04)                          0942
         AL    @03,@CF04239                                        0942
         LA    @11,CCATYPEA(@11,@03)                               0942
         ST    @11,MGPVARPT                                        0942
*       MGPVARPT(2)=ADDR(IOPNAME);  /* MEMBER NAME           @Z67SP00*/
         LA    @11,IOPNAME(,IOPPTR)                                0943
         ST    @11,MGPVARPT+4                                      0943
*       MGPVARPT(3)=ADDR(CCADSIDA(IOPDSID));/* DD NAME       @Z67SP00*/
         SLR   @11,@11                                             0944
         IC    @11,IOPDSID(,IOPPTR)                                0944
         SLA   @11,3                                               0944
         L     @03,CCADSAD-HMASMCCA(,@04)                          0944
         AL    @03,@CF04239                                        0944
         LA    @11,CCADSIDA(@11,@03)                               0944
         ST    @11,MGPVARPT+8                                      0944
*       IF CCALIST=ON               /* IF LIST FUNCTION      @Z67SP00*/
*         THEN                      /* THEN ONLY             @ZD00001*/
         TM    CCALIST-HMASMCCA(@04),B'00000001'                   0945
         BNO   @RF00945                                            0945
*         MGPTYPE=MGPWARN;          /* WARNING               @ZD00001*/
         MVI   MGPTYPE,X'02'                                       0946
*       ELSE                        /* ELSE MESSAGE IS       @ZD00001*/
*         IF CCAUPDJ=ON             /* IF JCLIN THEN         @Z67SP00*/
*             ×CCACNV=ON            /* OR CONVERT            @Z67SP00*/
*           THEN                    /*                       @ZD00005*/
         B     @RC00945                                            0947
@RF00945 L     @11,@CA00038                                        0947
         TM    CCAUPDJ-HMASMCCA(@11),B'00000100'                   0947
         BO    @RT00947                                            0947
         TM    CCACNV-HMASMCCA(@11),B'10000000'                    0947
         BNO   @RF00947                                            0947
@RT00947 DS    0H                                                  0948
*           MGPTYPE=MGPSEV;         /* STOP CONVERT          @ZD00005*/
         MVI   MGPTYPE,X'04'                                       0948
*         ELSE                      /*                       @ZD00005*/
*           MGPTYPE=MGPERR;         /* ERR TO STOP PTF       @ZD00001*/
         B     @RC00947                                            0949
@RF00947 MVI   MGPTYPE,X'03'                                       0949
*       CALL HMASMMSG(HMASMMGP);    /* WRITE MSG             @YA05690*/
@RC00947 DS    0H                                                  0950
@RC00945 L     @15,@CV03346                                        0950
         LA    @01,@AL00950                                        0950
         BALR  @14,@15                                             0950
*       IOPRETRN=IOPEXC;            /* SET RETURN CODE       @YA05690*/
         MVI   IOPRETRN(IOPPTR),X'08'                              0951
*       GO TO EXIT;                 /* RETURN TO CALLER      @YA05690*/
         B     EXIT                                                0952
*     END;                          /* END BLDL OR LOC       @Z40SP00*/
*                                                                  0953
*   /*****************************************************************/
*   /*                                                               */
*   /* IF REQUEST FOR IN-STORAGE DIRECTORY OPERATION         @ZD00003*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0954
*   IF IOPFUNCT=IOPINIT             /* INIT IN-STORE-DIR?    @ZD00003*/
*       ×IOPFUNCT=IOPFREE           /* FREE IN-STORE-DIR?    @ZD00003*/
*       ×(DISISW=ON                 /* OR DIR IS IN STORE    @Z67SP00*/
*       &(IOPFUNCT=IOPCLOSN         /* AND CLOSE REQUEST?    @ZD00003*/
*       ×IOPFUNCT=IOPGETN))         /* OR GET NEXT?          @ZD00003*/
*     THEN                          /* THEN PROCESS VIA CALL @ZD00003*/
@RF00879 CLI   IOPFUNCT(IOPPTR),8                                  0954
         BE    @RT00954                                            0954
         CLI   IOPFUNCT(IOPPTR),9                                  0954
         BE    @RT00954                                            0954
         TM    DISISW,B'00010000'                                  0954
         BNO   @RF00954                                            0954
         CLI   IOPFUNCT(IOPPTR),12                                 0954
         BE    @RT00954                                            0954
         CLI   IOPFUNCT(IOPPTR),10                                 0954
         BNE   @RF00954                                            0954
@RT00954 DS    0H                                                  0955
*     DO;                           /*                       @ZD00003*/
*       IF IOPFUNCT=IOPINIT         /* IF INIT REQUEST       @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         CLI   IOPFUNCT(IOPPTR),8                                  0956
         BNE   @RF00956                                            0956
*         IF(IOPDSID=IOPCDS&CCACDSIS=OFF)/* AND DATASET      @Z67SP00*/
*             ×(IOPDSID=IOPACDS&CCAACDIS=OFF)/* NOT IN       @Z67SP00*/
*             ×(IOPDSID=IOPCRQ&CCACRQIS=OFF)/* STORAGE       @Z67SP00*/
*             ×(IOPDSID=IOPACRQ&CCAACRIS=OFF)/*              @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         CLI   IOPDSID(IOPPTR),2                                   0957
         BNE   @GL00083                                            0957
         L     @11,@CA00038                                        0957
         TM    CCACDSIS-HMASMCCA(@11),B'10000000'                  0957
         BZ    @RT00957                                            0957
@GL00083 CLI   IOPDSID(IOPPTR),12                                  0957
         BNE   @GL00082                                            0957
         L     @11,@CA00038                                        0957
         TM    CCAACDIS-HMASMCCA(@11),B'01000000'                  0957
         BZ    @RT00957                                            0957
@GL00082 CLI   IOPDSID(IOPPTR),28                                  0957
         BNE   @GL00081                                            0957
         L     @11,@CA00038                                        0957
         TM    CCACRQIS-HMASMCCA(@11),B'00100000'                  0957
         BZ    @RT00957                                            0957
@GL00081 CLI   IOPDSID(IOPPTR),30                                  0957
         BNE   @RF00957                                            0957
         L     @11,@CA00038                                        0957
         TM    CCAACRIS-HMASMCCA(@11),B'00010000'                  0957
         BNZ   @RF00957                                            0957
@RT00957 DS    0H                                                  0958
*           CALL HMASMEIS(HMASMIOP);/* LOAD DIRECTORY        @Z67SP00*/
         ST    IOPPTR,@AL00001                                     0958
         L     @15,@CV03343                                        0958
         LA    @01,@AL00001                                        0958
         BALR  @14,@15                                             0958
*         ELSE                      /* IN INIT AND DIR IN    @Z67SP00*/
*           ;                       /* STORAGE - NO PROCESS  @Z67SP00*/
@RF00957 DS    0H                                                  0960
*       ELSE                        /* IF NOT INIT           @Z67SP00*/
*         CALL HMASMEIS(HMASMIOP);  /* CALL EIS              @ZD00003*/
         B     @RC00956                                            0960
@RF00956 ST    IOPPTR,@AL00001                                     0960
         L     @15,@CV03343                                        0960
         LA    @01,@AL00001                                        0960
         BALR  @14,@15                                             0960
*       IF IOPRETRN=IOPGOOD         /* IF FUNCTION WAS OK    @ZD00003*/
*         THEN                      /* THEN MUST TRANSLATE   @ZD00003*/
@RC00956 CLI   IOPRETRN(IOPPTR),0                                  0961
         BNE   @RF00961                                            0961
*         DO;                       /*                       @Z67SP00*/
*           IF IOPFUNCT=IOPGETN     /* IF GETNEXT            @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         CLI   IOPFUNCT(IOPPTR),10                                 0963
         BNE   @RF00963                                            0963
*             CALL HMASMION(HMASMIOP);/* VIA CALL TO ION     @ZD00003*/
         ST    IOPPTR,@AL00001                                     0964
         L     @15,@CV03344                                        0964
         LA    @01,@AL00001                                        0964
         BALR  @14,@15                                             0964
*           ELSE                    /*                       @Z67SP00*/
*             IF IOPFUNCT=IOPINIT   /* IF REQUEST TO INIT    @Z67SP00*/
*               THEN                /* DIS FILE THEN SET SW  @Z67SP00*/
         B     @RC00963                                            0965
@RF00963 CLI   IOPFUNCT(IOPPTR),8                                  0965
         BNE   @RF00965                                            0965
*               NOTESW=ON;          /* TO CAUSE NOTE FOR TTR @Z67SP00*/
         L     @11,PDSADDR                                         0966
         OI    NOTESW(@11),B'01000000'                             0966
*         END;                      /*                       @Z67SP00*/
*       GO TO EXIT;                 /* GO TO EXIT CODE       @ZD00003*/
         B     EXIT                                                0968
*     END;                          /*                       @ZD00003*/
*                                                                  0969
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FUNCTION WAS REQUEST TO GET NEXT DIRECTORY ENTRY OR CLOSE  */
*   /* FOR GET NEXT FUNCTION THEN CALL IO GET NEXT ROUTINE   @ZD00008*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0970
*   IF IOPFUNCT=IOPGETN             /* IF GET NEXT           @ZD00008*/
*       ×IOPFUNCT=IOPGETNC          /* OR GET NEXT WITH CNT  @ZD00008*/
*       ×IOPFUNCT=IOPCLOSN          /* OR GET NEXT CLOSE     @ZD00008*/
*     THEN                          /*                       @ZD00008*/
@RF00954 CLI   IOPFUNCT(IOPPTR),10                                 0970
         BE    @RT00970                                            0970
         CLI   IOPFUNCT(IOPPTR),11                                 0970
         BE    @RT00970                                            0970
         CLI   IOPFUNCT(IOPPTR),12                                 0970
         BNE   @RF00970                                            0970
@RT00970 DS    0H                                                  0971
*     DO;                           /*                       @ZD00008*/
*       CALL IORDS;                 /*                       @ZD00008*/
         BAL   @14,IORDS                                           0972
*       GO TO EXIT;                 /*                       @ZD00008*/
         B     EXIT                                                0973
*     END;                          /*                       @ZD00008*/
*                                                                  0974
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID INPUT REQUEST FOR SMPCDS/SMPACDS              @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0975
*   IOPRETRN=IOPIOERR;              /* SET BAD RTN CDE AND   @Z40SP00*/
@RF00970 MVI   IOPRETRN(IOPPTR),X'10'                              0975
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/
         B     EXIT                                                0976
         EJECT
*                                                                  0977
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SETS UP TO HANDLE THE SMPOUT DATASET    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0977
*PRTRTN:                                                           0977
*   ARRYADDR=ADDR(SMPARRAY);        /* PTR TO CORRECT DATA   @Z40SP00*/
PRTRTN   LA    @11,SMPARRAY                                        0977
         ST    @11,ARRYADDR                                        0977
*   PGLEN=CCAPGLEN;                 /* PAGE LEN SPEC BY USER @Z67SP00*/
         L     @11,@CA00038                                        0978
         MVC   PGLEN(2),CCAPGLEN-HMASMCCA(@11)                     0978
*   GO TO PRINTRTN;                 /* GO TO PROCESS LINE    @Z40SP00*/
*                                                                  0979
         B     PRINTRTN                                            0979
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SETS UP TO HANDLE THE SYSPRINT DATASET  @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0980
*SYSRTN:                            /*                       @Z40SP00*/
*   ARRYADDR=ADDR(SYSARRAY);        /* PTR TO CORRECT DATA   @Z40SP00*/
SYSRTN   LA    @11,SYSARRAY                                        0980
         ST    @11,ARRYADDR                                        0980
*   PGLEN=PGLENDFT;                 /* FIXED PAGE LEN=60     @Z67SP00*/
         MVC   PGLEN(2),@CH00805                                   0981
*   GO TO PRINTRTN;                 /* GO TO PROCESS LINE    @Z40SP00*/
*                                                                  0982
         B     PRINTRTN                                            0982
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SETS UP TO HANDLE THE SMPRPT DATASET    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0983
*RPTRTN:                            /*                       @Z67SP00*/
*   ARRYADDR=ADDR(RPTARRAY);        /* PTR TO CORRECT DATA   @Z67SP00*/
RPTRTN   LA    @11,RPTARRAY                                        0983
         ST    @11,ARRYADDR                                        0983
*   PGLEN=PGLENDFT;                 /* FIXED PAGE LEN=60     @Z67SP00*/
         MVC   PGLEN(2),@CH00805                                   0984
*   GO TO PRINTRTN;                 /*                       @Z67SP00*/
*                                                                  0985
         B     PRINTRTN                                            0985
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SETS UP TO HANDLE THE SMPLIST DATASET   @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0986
*LSTRTN:                            /*                       @Z67SP00*/
*   ARRYADDR=ADDR(LSTARRAY);        /* PTR TO CORRECT DATA   @Z67SP00*/
LSTRTN   LA    @11,LSTARRAY                                        0986
         ST    @11,ARRYADDR                                        0986
*   PGLEN=PGLENDFT;                 /* FIXED PAGE LEN=60     @Z67SP00*/
         MVC   PGLEN(2),@CH00805                                   0987
*   GO TO PRINTRTN;                 /*                       @Z67SP00*/
         B     PRINTRTN                                            0988
*                                                                  0989
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON CODE TO HANDLE THE SMPOUT AND SYSPRINT DATA SET@Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0989
*PRINTRTN:                          /*                       @Z40SP00*/
*                                                                  0989
*   /*****************************************************************/
*   /*                                                               */
*   /* ADD A HEADING TO THE SMPOUT/SYSPRINT DATA SETS        @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0989
*   IF PRLHEAD=ON                   /* IS THIS A HEADER ADDITION?    */
*     THEN                          /* YES - ADD HEADER TO BUFFER    */
PRINTRTN L     @11,IOPBUFAD(,IOPPTR)                               0989
         TM    PRLHEAD(@11),B'10000000'                            0989
         BNO   @RF00989                                            0989
*     DO;                           /* BUILD HEADER BUFFER           */
*       HEADCT=HEADCT+1;            /* BUMP HEADER COUNT             */
         L     @04,ARRYADDR                                        0991
         LA    @03,1                                               0991
         AH    @03,HEADCT(,@04)                                    0991
         STH   @03,HEADCT(,@04)                                    0991
*       LINECT=LINEMAX;             /* SET LINES PRINTED TO MAX VALUE
*                                      TO FORCE NEW PAGE ON NEXT   0992
*                                      WRITE                 @Z67SP00*/
         MVC   LINECT(2,@04),@CH03486                              0992
*       IF PRLBLANK=ON              /* DOES PRL INDICATE BLNK LINE?  */
*         THEN                      /* YES - POINT TO BLNK LINE      */
         TM    PRLBLANK(@11),B'00100000'                           0993
         BNO   @RF00993                                            0993
*         HEADADDR(HEADCT)=ADDR(PRNTBUF);/* POINT TO BUFFER          */
         SLA   @03,2                                               0994
         LA    @11,PRNTBUF                                         0994
         AL    @04,@CF04250                                        0994
         ST    @11,HEADADDR(@03,@04)                               0994
*       ELSE                        /* ELSE IT IS NON-BLANK          */
*         HEADADDR(HEADCT)=PRLHDADR;/* SAVE HEADER ADDRESS           */
         B     @RC00993                                            0995
@RF00993 L     @11,ARRYADDR                                        0995
         LH    @04,HEADCT(,@11)                                    0995
         SLA   @04,2                                               0995
         L     @03,IOPBUFAD(,IOPPTR)                               0995
         SLR   @15,@15                                             0995
         ICM   @15,7,PRLHDADR(@03)                                 0995
         AL    @11,@CF04250                                        0995
         ST    @15,HEADADDR(@04,@11)                               0995
*       GO TO GOODEXIT;             /* RETURN WITH GOOD RETURN CODE  */
         B     GOODEXIT                                            0996
*     END;                                                         0997
*                                                                  0998
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE ALL HEADINGS FROM THE SMPOUT/SYSPRINT DATA SETS@Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0998
*   IF PRLHEADO=ON                  /* CLEAR HEAD REQUEST?           */
*     THEN                          /* YES - CLEAR OUT BUFFER        */
@RF00989 L     @11,IOPBUFAD(,IOPPTR)                               0998
         TM    PRLHEADO(@11),B'01000000'                           0998
         BNO   @RF00998                                            0998
*     DO;                           /* RESET HEADER INDICATORS       */
*       HEADCT=HEADSTRT;            /* RESET HEADER COUNTER          */
         L     @11,ARRYADDR                                        1000
         MVC   HEADCT(2,@11),@CH00183                              1000
*       LINECT=LINEMAX;             /* SET LINES PRINTED TO MAX VALUE
*                                      TO FORCE NEW PAGE HEADINGS  1001
*                                      WHEN NEXT LINE PRINTED      1001
*                                                            @Z67SP00*/
         MVC   LINECT(2,@11),@CH03486                              1001
*       GO TO GOODEXIT;             /* RETURN TO REQUESTOR           */
         B     GOODEXIT                                            1002
*     END;                                                         1003
*                                                                  1003
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DATA SET IS SYSPRINT THEN CHECK TO SEE IF THERE WAS A  */
*   /* PREVIOUS I/O ERROR. IF SO THEN RETURN WITH BAD CODE   @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1004
*   IF IOPDSID=IOPSYSPT             /* SYSPRINT DATA SET     @Z40SP00*/
*       &SYSPDEAD=ON                /* AND PREVIOUS ERROR    @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
@RF00998 CLI   IOPDSID(IOPPTR),20                                  1004
         BNE   @RF01004                                            1004
         TM    SYSPDEAD,B'10000000'                                1004
         BNO   @RF01004                                            1004
*     DO;                           /* RETURN WITH BAD CODE  @Z40SP00*/
*       IOPRETRN=IOPIOERR;          /* BAD RETURN CODE       @Z40SP00*/
         MVI   IOPRETRN(IOPPTR),X'10'                              1006
*       GO TO EXIT;                 /* RETURN TO CALLER      @Z40SP00*/
         B     EXIT                                                1007
*     END;                          /* END SYSPRINT DEAD     @Z40SP00*/
*                                                                  1008
*   /*****************************************************************/
*   /*                                                               */
*   /* IF REQUEST TO WRITE BLANK LINE AND AT TOP OF NEXT PAGE THEN DO*/
*   /* NOT WRITE LINE. RETURN WITH RC=0                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1009
*   IF LINECT>=PGLEN-HEADCT         /* IF AT BOTTOM OF PAGE  @Z67SP00*/
*       &(PRLBLANK=ON               /* AND REQUEST FOR BLANK @Z67SP00*/
*       ×PRLDATA(1:PRLRLEN)=PRNTDATA(1:PRLRLEN))/* OR LINE   @Z67SP00*/
*     THEN                          /* TO WRITE IS BLANK     @Z67SP00*/
@RF01004 L     @11,ARRYADDR                                        1009
         LH    @04,PGLEN                                           1009
         SH    @04,HEADCT(,@11)                                    1009
         CH    @04,LINECT(,@11)                                    1009
         BH    @RF01009                                            1009
         L     @11,IOPBUFAD(,IOPPTR)                               1009
         TM    PRLBLANK(@11),B'00100000'                           1009
         BO    @RT01009                                            1009
         LH    @04,PRLRLEN(,@11)                                   1009
         BCTR  @04,0                                               1009
         EX    @04,@SC04251                                        1009
         BE    @RT01009                                            1009
*     GO TO GOODEXIT;               /* (PRNTDATA INIT TO BLANK) THEN
*                                      RETURN WITH NO WRITE  @Z67SP00*/
*                                                                  1011
*   /*****************************************************************/
*   /*                                                               */
*   /* PUT PAGE NUMBER, TIME AND DATE INTO THE PAGE HEADING AND PRINT*/
*   /* THE SMPOUT/SYSPRINT HEADINGS PREVIOUSLY SET UP        @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1011
*   IF LINECT>=PGLEN-HEADCT         /* IF NUMBER OF LINES ALREADY  1011
*                                      PRINTED WAS MAX       @Z67SP00*/
*     THEN                          /* THEN MUST START AT            */
@RF01009 L     @11,ARRYADDR                                        1011
         LH    @04,PGLEN                                           1011
         SH    @04,HEADCT(,@11)                                    1011
         CH    @04,LINECT(,@11)                                    1011
         BH    @RF01011                                            1011
*     DO;                           /* TOP OF NEW PAGE               */
*       LINECT=ZERO;                /* NO LINES PRINTED      @Z67SP00*/
         SLR   @04,@04                                             1013
         STH   @04,LINECT(,@11)                                    1013
*       IF IOPDSID=IOPPRINT         /* WORKING WITH SMPOUT?  @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
         CLI   IOPDSID(IOPPTR),11                                  1014
         BNE   @RF01014                                            1014
*         MHEAD=OUTHEAD;            /* SET FOR SMPOUT HEADING@Z40SP00*/
         MVC   MHEAD(31),OUTHEAD                                   1015
*       ELSE                        /*                       @Z40SP00*/
*         IF IOPDSID=IOPSYSPT       /* IS IT SYSPRINT?       @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         B     @RC01014                                            1016
@RF01014 CLI   IOPDSID(IOPPTR),20                                  1016
         BNE   @RF01016                                            1016
*           MHEAD=PRNTHEAD;         /* SET FOR SYSPRINT      @Z40SP00*/
         MVI   MHEAD+15,C' '                                       1017
         MVC   MHEAD+16(15),MHEAD+15                               1017
         MVC   MHEAD(15),PRNTHEAD                                  1017
*         ELSE                      /*                       @Z67SP00*/
*           IF IOPDSID=IOPRPT       /* IF SMPRPT                     */
*             THEN                  /*                               */
         B     @RC01016                                            1018
@RF01016 CLI   IOPDSID(IOPPTR),41                                  1018
         BNE   @RF01018                                            1018
*             MHEAD=RPTHEAD;        /* MUST BE SMPRPT        @Z67SP00*/
         MVI   MHEAD+13,C' '                                       1019
         MVC   MHEAD+14(17),MHEAD+13                               1019
         MVC   MHEAD(13),RPTHEAD                                   1019
*           ELSE                    /*                       @Z67SP00*/
*             MHEAD=LSTHEAD;        /*                       @Z67SP00*/
         B     @RC01018                                            1020
@RF01018 MVI   MHEAD+14,C' '                                       1020
         MVC   MHEAD+15(16),MHEAD+14                               1020
         MVC   MHEAD(14),LSTHEAD                                   1020
*       PAGENO=PAGENO+1;            /* BUMP PAGE COUNTER             */
@RC01018 DS    0H                                                  1021
@RC01016 DS    0H                                                  1021
@RC01014 L     @11,ARRYADDR                                        1021
         LA    @04,1                                               1021
         LH    @03,PAGENO(,@11)                                    1021
         ALR   @03,@04                                             1021
         STH   @03,PAGENO(,@11)                                    1021
*       CVD(PAGENO,DBLWRD);         /* CONVERT PAGE NUMBER           */
         CVD   @03,DBLWRD                                          1022
*       UNPK(PAGEFLD,DBLWRD);       /* PUT PAGENO IN OUTPUT LINE     */
         UNPK  PAGEFLD(4),DBLWRD(8)                                1023
*       LASTDIG=LASTDIG×MAKPRINT;   /* MAKE LAST DIG PRINTABLE       */
         OI    LASTDIG,X'F0'                                       1024
*       UNPK(DATE,CCADATE);         /* MAKE DATE PRINTABLE           */
         L     @11,@CA00038                                        1025
         UNPK  DATE(5),CCADATE-HMASMCCA(3,@11)                     1025
*       DAY=DAY×MAKPRINT;           /* MAKE DATE PRINTABLE           */
         OI    DAY,X'F0'                                           1026
*       YY=DATEYY;                  /* PUT YEAR INTO MESSAGE         */
         MVC   YY(2),DATEYY                                        1027
*       DDD=DATEDDD;                /* PUT DAY INTO MESSAGE          */
         MVC   DDD(3),DATEDDD                                      1028
*       TIMETEMP(1:3)=CCATIME;      /* GET TIME FROM CCA     @SA74333*/
         MVC   TIMETEMP(3),CCATIME-HMASMCCA(@11)                   1029
*       UNPK(TIMEAREA,TIMETEMP);    /* UNPACK TIME STAMP     @SA74333*/
         UNPK  TIMEAREA(8),TIMETEMP(4)                             1030
*       HH=TIMEHH;                  /* MOVE HOURS            @SA74333*/
         MVC   HH(2),TIMEHH                                        1031
*       MM=TIMEMM;                  /* MOVE MINUTES          @SA74333*/
         MVC   MM(2),TIMEMM                                        1032
*       TT=TIMETT;                  /* MOVE TENTHS           @SA74333*/
         MVC   TT(2),TIMETT                                        1033
*       DO K=1 TO HEADCT;           /* LOOP THROUGH HEADERS          */
         B     @DE01034                                            1034
@DL01034 DS    0H                                                  1035
*         BUFFSV=IOPBUFAD;          /* SAVE BUFFER ADDR      @ZD00009*/
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          1035
*         IOPBUFAD=HEADADDR(K);     /* GET HEADING ADDR      @YA07506*/
         SLA   @04,2                                               1036
         L     @11,ARRYADDR                                        1036
         AL    @11,@CF04250                                        1036
         L     @11,HEADADDR(@04,@11)                               1036
         ST    @11,IOPBUFAD(,IOPPTR)                               1036
*         SAVRETRN(IOENTCNT)=IOPRETRN;/* SAVE CURR RETURN    @ZA25875*/
         SLR   @11,@11                                             1037
         IC    @11,IOENTCNT                                        1037
         SLR   @04,@04                                             1037
         IC    @04,IOPRETRN(,IOPPTR)                               1037
         STC   @04,SAVRETRN-1(@11)                                 1037
*         CALL PUT;                 /* OUTPUT HEADER                 */
         BAL   @14,PUT                                             1038
*         IOPBUFAD=BUFFSV;          /* RESET BUFFER ADDR     @ZD00009*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           1039
*         IF IOPRETRN^=IOPGOOD      /* SUCCESS?              @YA07506*/
*           THEN                    /* NO - RETURN TO CALLER         */
         CLI   IOPRETRN(IOPPTR),0                                  1040
         BE    @RF01040                                            1040
*           DO;                     /*                       @ZA99999*/
*             IOPRETRN=MAX(IOPRETRN,SAVRETRN(IOENTCNT));/*   @ZA25875*/
         SLR   @11,@11                                             1042
         IC    @11,IOENTCNT                                        1042
         SLR   @04,@04                                             1042
         IC    @04,IOPRETRN(,IOPPTR)                               1042
         SLR   @03,@03                                             1042
         IC    @03,SAVRETRN-1(@11)                                 1042
         CR    @04,@03                                             1042
         BNL   *+6
         LR    @04,@03                                             1042
         STC   @04,IOPRETRN(,IOPPTR)                               1042
*             GO TO EXIT;           /* RETURN                        */
         B     EXIT                                                1043
*           END;                    /*                       @ZA99999*/
*         IOPRETRN=SAVRETRN(IOENTCNT);/* RESET RTN CODE      @ZA99999*/
@RF01040 SLR   @11,@11                                             1045
         IC    @11,IOENTCNT                                        1045
         SLR   @04,@04                                             1045
         IC    @04,SAVRETRN-1(@11)                                 1045
         STC   @04,IOPRETRN(,IOPPTR)                               1045
*       END;                                                       1046
         LA    @04,1                                               1046
         AL    @04,K                                               1046
@DE01034 ST    @04,K                                               1046
         L     @11,ARRYADDR                                        1046
         CH    @04,HEADCT(,@11)                                    1046
         BNH   @DL01034                                            1046
*     END;                                                         1047
*                                                                  1048
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE SMPOUT/SYSPRINT DATA LINE                   @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1048
*   IF PRLBLANK=OFF                 /* BLANK LINE?                   */
*     THEN                          /* NO - MOVE USER LINE           */
@RF01011 L     @11,IOPBUFAD(,IOPPTR)                               1048
         TM    PRLBLANK(@11),B'00100000'                           1048
         BNZ   @RF01048                                            1048
*     IF PRLRLEN>=LENGTH(PRNTDATA)  /* LENGTH GREATER OR EQUAL TO  1049
*                                      MAX?                  @Z40SP00*/
*       THEN                        /* YES                   @Z40SP00*/
         LH    @04,PRLRLEN(,@11)                                   1049
         CH    @04,@CH03564                                        1049
         BL    @RF01049                                            1049
*       PRNTDATA=PRLDATA(1:LENGTH(PRNTDATA));/* MOVE MAX     @Z40SP00*/
         MVC   PRNTDATA(120),PRLDATA(@11)                          1050
*     ELSE                          /* IF LESS MOVE ONLY     @Z40SP00*/
*       PRNTDATA(1:PRLRLEN)=PRLDATA(1:PRLRLEN);/* THAT PASSED IN   1051
*                                      BUFFER                @Z40SP00*/
         B     @RC01049                                            1051
@RF01049 L     @11,IOPBUFAD(,IOPPTR)                               1051
         LH    @04,PRLRLEN(,@11)                                   1051
         BCTR  @04,0                                               1051
         EX    @04,@SM04253                                        1051
*   BUFFSV=IOPBUFAD;                /* SAVE BUFFER ADDR      @ZD00009*/
@RC01049 DS    0H                                                  1052
@RF01048 MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          1052
*   IOPBUFAD=ADDR(PRNTBUF);         /* POINT TO OUTPUT BUFFER        */
         LA    @11,PRNTBUF                                         1053
         ST    @11,IOPBUFAD(,IOPPTR)                               1053
*   SAVRETRN(IOENTCNT)=IOPRETRN;    /* SAVE CURRENT RC       @ZA25875*/
         SLR   @11,@11                                             1054
         IC    @11,IOENTCNT                                        1054
         SLR   @04,@04                                             1054
         IC    @04,IOPRETRN(,IOPPTR)                               1054
         STC   @04,SAVRETRN-1(@11)                                 1054
*   CALL PUT;                       /* WRITE STATEMENT TO PRINTER    */
         BAL   @14,PUT                                             1055
*   IOPRETRN=MAX(IOPRETRN,SAVRETRN(IOENTCNT));/*             @ZA25875*/
         SLR   @11,@11                                             1056
         IC    @11,IOENTCNT                                        1056
         SLR   @04,@04                                             1056
         IC    @04,IOPRETRN(,IOPPTR)                               1056
         SLR   @03,@03                                             1056
         IC    @03,SAVRETRN-1(@11)                                 1056
         CR    @04,@03                                             1056
         BNL   *+6
         LR    @04,@03                                             1056
         STC   @04,IOPRETRN(,IOPPTR)                               1056
*   IOPBUFAD=BUFFSV;                /* RESET BUFFER ADDR     @ZD00009*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           1057
*   LINECT=LINECT+1;                /* INCR LINES PRINTED    @Z67SP00*/
         L     @11,ARRYADDR                                        1058
         LA    @04,1                                               1058
         AH    @04,LINECT(,@11)                                    1058
         STH   @04,LINECT(,@11)                                    1058
*   PRNTBUF=BLANK;                  /* BLANK OUT PRINT LINE          */
         MVI   PRNTBUF+1,C' '                                      1059
         MVC   PRNTBUF+2(119),PRNTBUF+1                            1059
         MVI   PRNTBUF,C' '                                        1059
*   GO TO EXIT;                     /* RETURN TO REQUESTOR           */
         B     EXIT                                                1060
         EJECT
*                                                                  1061
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE IS TO HANDLE THE HISTORY LOG FILE       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1061
*HISTPRTN:                                                         1061
*   IF IOPFUNCT>IOPCLOSE            /* OUTPUT OPERATION?     @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
HISTPRTN CLI   IOPFUNCT(IOPPTR),80                                 1061
         BNH   @RF01061                                            1061
*     DO;                           /*                       @Z40SP00*/
*       IF IOPFUNCT=IOPWRITE        /* WRITE OPERATION?      @Z40SP00*/
*         THEN                      /* YES WRITE A RECORD WITH STAMP */
         CLI   IOPFUNCT(IOPPTR),81                                 1063
         BNE   @RF01063                                            1063
*         DO;                       /* OF TIME AND DATE              */
*                                                                  1064
*           /*********************************************************/
*           /*                                                       */
*           /* FUNCTION IS WRITE TO THE LOG - GET TIME AND DATE AND  */
*           /* WRITE MESSAGE. TCLOSE IS ISSUED TO WRITE END OF FILE  */
*           /* TO SAVE DATA                                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1065
*           IF PRLRLEN>250          /* IF GREATER THAN MAX   @Z67SP00*/
*             THEN                  /* RESE MSG TO MAX       @Z67SP00*/
         LA    @11,250                                             1065
         L     @04,IOPBUFAD(,IOPPTR)                               1065
         CH    @11,PRLRLEN(,@04)                                   1065
         BNL   @RF01065                                            1065
*             PRLRLEN=250;          /*                       @Z67SP00*/
         STH   @11,PRLRLEN(,@04)                                   1066
*           PRLSPAN=ZERO;           /* INSURE NO SPANNING INFO       */
@RF01065 L     @11,IOPBUFAD(,IOPPTR)                               1067
         SLR   @04,@04                                             1067
         STH   @04,PRLSPAN(,@11)                                   1067
*           PRLDATE=CCADATE;        /* GET CORRECT DATE FROM CCA     */
         L     @04,@CA00038                                        1068
         MVC   PRLDATE(3,@11),CCADATE-HMASMCCA(@04)                1068
*           GEN(TIME        DEC);   /* ISSUE TIME MACRO              */
         TIME        DEC
*           RFY                                                    1070
*             R0 RSTD;              /* RESTRICT PASSBK REGISTER      */
*           TIMETEMP=R0;            /* PUT TIME INTO SAVE AREA       */
         ST    R0,TIMETEMP                                         1071
*           RFY                                                    1072
*             R0 UNRSTD;            /* RELEASE REGISTER              */
*           PRLTIME=TIMETEMP(1:3);  /* PUT TIME IN PRL               */
         L     @11,IOPBUFAD(,IOPPTR)                               1073
         MVC   PRLTIME(3,@11),TIMETEMP                             1073
*           CALL WRITE;             /* WRITE RECORD TO HISTORY LOG   */
         BAL   @14,WRITE                                           1074
*         END;                                                     1075
*                                                                  1075
*       /*************************************************************/
*       /*                                                           */
*       /* FUNCTION IS POSITION FOR OUTPUT OR TO WRITE END OF FILE   */
*       /* AFTER A WRITE OPERATION - POINT TO END OF LOG             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1076
*       GEN(CLOSE (HISTDCB,LEAVE),TYPE=T);/* WRITE EOF               */
@RF01063 DS    0H                                                  1076
         CLOSE (HISTDCB,LEAVE),TYPE=T
*     END;                                                         1077
*                                                                  1077
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTION IS INPUT FOR SMPLOG, POSITION FOR INPUT OR READ      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1078
*   ELSE                            /* OTHERWISE, CHECK FURTHER      */
*     IF IOPFUNCT=IOPREAD           /* IS IT A READ OPERATION?       */
*       THEN                        /* YES - READ A RECORD           */
         B     @RC01061                                            1078
@RF01061 CLI   IOPFUNCT(IOPPTR),1                                  1078
         BNE   @RF01078                                            1078
*       CALL READ;                  /* READ A RECORD INTO THE PRL    */
         BAL   @14,READ                                            1079
*     ELSE                          /* OTHERWISE, IT IS POSITION     */
*       IF IOPFUNCT=IOPPOSI         /* POSITION FOR INPUT?   @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
         B     @RC01078                                            1080
@RF01078 CLI   IOPFUNCT(IOPPTR),2                                  1080
         BNE   @RF01080                                            1080
*         GEN(CLOSE (HISTDCB,REREAD),TYPE=T)                       1081
*         REFS(HISTDCB);            /* REPOSITION AT START   @Z40SP00*/
*                                                                  1081
         CLOSE (HISTDCB,REREAD),TYPE=T
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID REQUEST FOR SMPLOG                            @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1082
*       ELSE                        /* NOT VALID FUNCTION    @Z40SP00*/
*         IOPRETRN=IOPIOERR;        /* SET BAD RTN CDE       @Z40SP00*/
         B     @RC01080                                            1082
@RF01080 MVI   IOPRETRN(IOPPTR),X'10'                              1082
*   GO TO EXIT;                     /* RETURN TO REQUESTOR           */
         B     EXIT                                                1083
         EJECT
*                                                                  1084
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE IS TO HANDLE THE CDS AND ACDS DIRECTORY */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1084
*CDSDIRTN:                                                         1084
*   IF CCACDSOS=ON                  /* CDS IN STORAGE FOR    @Z67SP00*/
*     THEN                          /* UPDATE                @Z67SP00*/
CDSDIRTN L     @11,@CA00038                                        1084
         TM    CCACDSOS-HMASMCCA(@11),B'10000000'                  1084
         BNO   @RF01084                                            1084
*     DISOSW=ON;                    /* YES - SET DIS OUTPUT  @Z67SP00*/
         OI    DISOSW,B'00001000'                                  1085
*   ELSE                            /* NO                    @Z67SP00*/
*     DISOSW=OFF;                   /* SET NO OUTPUT SW      @Z67SP00*/
         B     @RC01084                                            1086
@RF01084 NI    DISOSW,B'11110111'                                  1086
*   PDSDDNAM=CCADSIDA(IOPCDS);      /* SET DD NAME           @Z67SP00*/
@RC01084 L     @11,@CA00038                                        1087
         L     @11,CCADSAD-HMASMCCA(,@11)                          1087
         MVC   PDSDDNAM(8),CCADSIDA+8(@11)                         1087
*   GO TO PDSDRTNS;                 /*                       @Z67SP00*/
         B     PDSDRTNS                                            1088
*ACDSDRTN:                                                         1089
*   IF CCAACDOS=ON                  /* ACDS IN STORAGE FOR   @Z67SP00*/
*     THEN                          /* UPDATE                @Z67SP00*/
ACDSDRTN L     @11,@CA00038                                        1089
         TM    CCAACDOS-HMASMCCA(@11),B'01000000'                  1089
         BNO   @RF01089                                            1089
*     DISOSW=ON;                    /* YES - SET DIS OUTPUT  @Z67SP00*/
         OI    DISOSW,B'00001000'                                  1090
*   ELSE                            /* NO                    @Z67SP00*/
*     DISOSW=OFF;                   /* SET NO OUTPUT SW      @Z67SP00*/
         B     @RC01089                                            1091
@RF01089 NI    DISOSW,B'11110111'                                  1091
*   PDSDDNAM=CCADSIDA(IOPACDS);     /* SET DD NAME           @Z67SP00*/
@RC01089 L     @11,@CA00038                                        1092
         L     @11,CCADSAD-HMASMCCA(,@11)                          1092
         MVC   PDSDDNAM(8),CCADSIDA+88(@11)                        1092
*   GO TO PDSDRTNS;                 /*                       @Z67SP00*/
         B     PDSDRTNS                                            1093
*CRQDRTN:                           /*                       @Z67SP00*/
*   IF CCACRQOS=ON                  /* CRQ IN STORAGE FOR    @Z67SP00*/
*     THEN                          /* UPDATE                @Z67SP00*/
CRQDRTN  L     @11,@CA00038                                        1094
         TM    CCACRQOS-HMASMCCA(@11),B'00100000'                  1094
         BNO   @RF01094                                            1094
*     DISOSW=ON;                    /* YES - SET DIS OUTPUT  @Z67SP00*/
         OI    DISOSW,B'00001000'                                  1095
*   ELSE                            /* NO                    @Z67SP00*/
*     DISOSW=OFF;                   /* SET NO OUTPUT SW      @Z67SP00*/
         B     @RC01094                                            1096
@RF01094 NI    DISOSW,B'11110111'                                  1096
*   PDSDDNAM=CCADSIDA(IOPCRQ);      /* SET DD NAME           @Z67SP00*/
@RC01094 L     @11,@CA00038                                        1097
         L     @11,CCADSAD-HMASMCCA(,@11)                          1097
         MVC   PDSDDNAM(8),CCADSIDA+216(@11)                       1097
*   GO TO PDSDRTNS;                 /*                       @Z67SP00*/
         B     PDSDRTNS                                            1098
*ACRQDRTN:                          /*                       @Z67SP00*/
*   IF CCAACROS=ON                  /* ACRQ IN STORAGE FOR   @Z67SP00*/
*     THEN                          /* UPDATE                @Z67SP00*/
ACRQDRTN L     @11,@CA00038                                        1099
         TM    CCAACROS-HMASMCCA(@11),B'00010000'                  1099
         BNO   @RF01099                                            1099
*     DISOSW=ON;                    /* YES - SET DIS OUTPUT  @Z67SP00*/
         OI    DISOSW,B'00001000'                                  1100
*   ELSE                            /* NO                    @Z67SP00*/
*     DISOSW=OFF;                   /* SET NO OUTPUT SW      @Z67SP00*/
         B     @RC01099                                            1101
@RF01099 NI    DISOSW,B'11110111'                                  1101
*   PDSDDNAM=CCADSIDA(IOPACRQ);     /* SET DD NAME           @Z67SP00*/
@RC01099 L     @11,@CA00038                                        1102
         L     @11,CCADSAD-HMASMCCA(,@11)                          1102
         MVC   PDSDDNAM(8),CCADSIDA+232(@11)                       1102
*   GO TO PDSDRTNS;                 /*                       @Z67SP00*/
         B     PDSDRTNS                                            1103
*                                                                  1104
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINES TO HANDLE DIRECTORY DCBS FOR DATASETS THAT CAN BE    */
*   /* UPDATED IN AN IN STORAGE ONLY MODE                    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1104
*PDSDRTNS:                          /*                       @Z67SP00*/
*   IF DISOSW=ON                    /* IN JCLIN MODE?        @Z67SP00*/
*     THEN                          /* YES - USE UPDAT DCB           */
PDSDRTNS TM    DISOSW,B'00001000'                                  1104
         BNO   @RF01104                                            1104
*     DO;                                                          1105
*       DCBPTR=ADDIRDCB;            /* UPDATE TO DIRECT DCB  @Z40SP01*/
         L     DCBPTR,ADDIRDCB                                     1106
*       IF DCBOFOPN=OFF             /* IS DCB CLOSED                 */
*         THEN                      /* YES - OPEN IT                 */
         LA    @11,40                                              1107
         ALR   @11,DCBPTR                                          1107
         TM    DCBOFOPN(@11),B'00010000'                           1107
         BNZ   @RF01107                                            1107
*         DO;                       /*                               */
*           DCBDDNAM=PDSDDNAM;      /* SET DD NAME           @Z67SP00*/
         MVC   DCBDDNAM(8,@11),PDSDDNAM                            1109
*           GEN(OPEN     (DIRUDCB,UPDAT));/* OPEN THE DCB            */
         OPEN     (DIRUDCB,UPDAT)
*           IF DCBOFOPN=OFF         /* DCB STILL CLOSED              */
*             THEN                  /* YES - ERR CONDITION           */
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     1111
         BZ    @RT01111                                            1111
*             GO TO OPENFAIL;       /* WRITE ERR MSG                 */
*         END;                                                     1113
*                                                                  1113
*       /*************************************************************/
*       /*                                                           */
*       /* READ/WRITE OPERATIONS WHEN USING DIRUDCB(IN-STORAGE MODE) */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1114
*       IF IOPFUNCT=IOPREAD         /* READ OPERATION?               */
*         THEN                      /* YES - ISSUE READ              */
@RF01107 CLI   IOPFUNCT(IOPPTR),1                                  1114
         BNE   @RF01114                                            1114
*         CALL READ;                /* READ DIRECTORY ENTRY          */
         BAL   @14,READ                                            1115
*       ELSE                        /* OTHERWISE - WRITE OPERATION   */
*         IF IOPFUNCT=IOPWRITE      /* WRITE?                @Z40SP00*/
*           THEN                    /* YES                   @Z40SP00*/
         B     @RC01114                                            1116
@RF01114 CLI   IOPFUNCT(IOPPTR),81                                 1116
         BNE   @RF01116                                            1116
*           CALL WRITE;             /* ISSUE WRITE                   */
*                                                                  1117
         BAL   @14,WRITE                                           1117
*       /*************************************************************/
*       /*                                                           */
*       /* INVALID REQUEST FOR IN-STORAGE DIRECTORY          @Z40SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1118
*         ELSE                      /* INVALID FUNCTION      @Z40SP00*/
*           IOPRETRN=IOPIOERR;      /* SET BAD RTN CDE       @Z40SP00*/
         B     @RC01116                                            1118
@RF01116 MVI   IOPRETRN(IOPPTR),X'10'                              1118
*       GO TO EXIT;                 /* RETURN                        */
         B     EXIT                                                1119
*     END;                          /* END IN-STORAGE MODE?  @SA99996*/
*                                                                  1120
*   /*****************************************************************/
*   /*                                                               */
*   /* FOR PDS DIRECTORY ACCESS USE GET                      @SA99996*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1121
*   IF IOPFUNCT=IOPREAD             /* READ REQUEST?         @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
@RF01104 CLI   IOPFUNCT(IOPPTR),1                                  1121
         BNE   @RF01121                                            1121
*     CALL GET;                     /* GET DIRECTORY BLOCK   @SA99996*/
*                                                                  1122
         BAL   @14,GET                                             1122
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID REQUEST FOR PDS DIRECTORY                     @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1123
*   ELSE                            /* INVALID REQUEST       @Z40SP00*/
*     IOPRETRN=IOPIOERR;            /* SET BAD RTN CDE       @Z40SP00*/
         B     @RC01121                                            1123
@RF01121 MVI   IOPRETRN(IOPPTR),X'10'                              1123
*   GO TO EXIT;                     /*                       @SA99996*/
         B     EXIT                                                1124
         EJECT
*                                                                  1125
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE IS TO HANDLE THE SMPCNTL DATA SET       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1125
*CNTLRTN:                                                          1125
*   IF CONTEOF=ON                   /* HAS EOF BEEN REACHED YET?     */
*     THEN                          /* YES - DON'T READ              */
CNTLRTN  TM    CONTEOF,B'01000000'                                 1125
         BNO   @RF01125                                            1125
*     IOPRETRN=IOPEOF;              /* SET EOF RETURN CODE   @YA07506*/
         MVI   IOPRETRN(IOPPTR),X'04'                              1126
*   ELSE                            /* OTHERWISE - ISSUE READ        */
*     IF IOPFUNCT=IOPREAD           /* READ REQUEST          @Z40SP00*/
*       THEN                        /* YES                   @Z40SP00*/
         B     @RC01125                                            1127
@RF01125 CLI   IOPFUNCT(IOPPTR),1                                  1127
         BNE   @RF01127                                            1127
*       DO;                                                        1128
*         CALL GET;                 /* GET A CONTROL CARD RECORD     */
         BAL   @14,GET                                             1129
*         IF IOPRETRN=IOPEOF        /* IS IT NOW EOF?        @YA07506*/
*           THEN                    /* YES - INDICATE EOF FOUND      */
         CLI   IOPRETRN(IOPPTR),4                                  1130
         BNE   @RF01130                                            1130
*           CONTEOF=ON;             /* CONTROL CARD END OF FILE      */
         OI    CONTEOF,B'01000000'                                 1131
*       END;                                                       1132
*                                                                  1132
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID REQUEST FOR SMPCNTL                           @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1133
*     ELSE                          /* NOT READ - INVALID    @Z40SP00*/
*       IOPRETRN=IOPIOERR;          /* SET BAD RTN CDE       @Z40SP00*/
         B     @RC01127                                            1133
@RF01127 MVI   IOPRETRN(IOPPTR),X'10'                              1133
*   GO TO EXIT;                     /* RETURN TO CALLER              */
         B     EXIT                                                1134
         EJECT
*                                                                  1135
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING IS TO HANDLE THE SYSUT1 DATA SET WHEN IT IS TO  */
*   /* BE USED AS LRECL=80                                   @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1135
*SCR1RTN:                                                          1135
*   IF IOPFUNCT=IOPREAD             /* IS IT A READ OPERATION?       */
*     THEN                          /* YES - READ A RECORD           */
SCR1RTN  CLI   IOPFUNCT(IOPPTR),1                                  1135
         BNE   @RF01135                                            1135
*     CALL GET;                     /* USING QSAM - INTO BUFAD       */
         BAL   @14,GET                                             1136
*   ELSE                            /* OTHERWISE - IT IS WRITE       */
*     IF IOPFUNCT=IOPWRITE          /* WRITEREQUEST?         @Z40SP00*/
*       THEN                        /* YES                   @Z40SP00*/
         B     @RC01135                                            1137
@RF01135 CLI   IOPFUNCT(IOPPTR),81                                 1137
         BNE   @RF01137                                            1137
*       CALL PUT;                   /* ISSUE QSAM PUT                */
*                                                                  1138
         BAL   @14,PUT                                             1138
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID REQUEST FOR SYSUT1                            @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1139
*     ELSE                          /* NOT WRITE - INVALID   @Z40SP00*/
*       IOPRETRN=IOPIOERR;          /* SET BAD RTN CDE       @Z40SP00*/
         B     @RC01137                                            1139
@RF01137 MVI   IOPRETRN(IOPPTR),X'10'                              1139
*   GO TO EXIT;                     /* RETURN TO REQUESTOR           */
*                                                                  1140
         B     EXIT                                                1140
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS TO HANDLE THE SYSUT1 DATA SET WHEN IT IS TO BE*/
*   /* USED AS LRECL=256                                     @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1141
*SCR2RTN:                                                          1141
*   IF IOPFUNCT=IOPREAD             /* IS THIS A READ OPERATION      */
*     THEN                          /* YES - ISSUE READ              */
SCR2RTN  CLI   IOPFUNCT(IOPPTR),1                                  1141
         BNE   @RF01141                                            1141
*     CALL READ;                    /* INVOKE READ SUBROUTINE        */
         BAL   @14,READ                                            1142
*   ELSE                            /* OTHERWISE - IT IS A WRITE     */
*     IF IOPFUNCT=IOPWRITE          /* WRITE REQUEST?        @Z40SP00*/
*       THEN                        /* YES                   @Z40SP00*/
         B     @RC01141                                            1143
@RF01141 CLI   IOPFUNCT(IOPPTR),81                                 1143
         BNE   @RF01143                                            1143
*       CALL WRITE;                 /* INVOKE WRITE SUBROUTINE       */
*                                                                  1144
         BAL   @14,WRITE                                           1144
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID REQUEST FOR SYSUT1                            @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1145
*     ELSE                          /* NOT WRITE - INVALID   @Z40SP00*/
*       IOPRETRN=IOPIOERR;          /* SET BAD RTN CDE       @Z40SP00*/
         B     @RC01143                                            1145
@RF01143 MVI   IOPRETRN(IOPPTR),X'10'                              1145
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/
         B     EXIT                                                1146
         EJECT
*                                                                  1147
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE THE SOURCE LIBRARIES                @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1147
*SRCRTN:                            /*                       @Z40SP00*/
*                                                                  1147
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE THE MACRO LIBRARIES                 @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1147
*MACRTN:                                                           1147
*                                                                  1147
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A LOCATE OPERATION, THEN CHECK CURRENT LIBRARY             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1147
*MACSRCRT:                          /*                       @Z40SP00*/
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
SRCRTN   DS    0H                                                  1147
MACRTN   DS    0H                                                  1147
MACSRCRT NI    DISISW,B'11101111'                                  1147
*   IF IOPFUNCT=IOPLOC              /* IS IT A LOCATE?               */
*       ×IOPFUNCT=IOPBLDL           /* OR BLDL               @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
         CLI   IOPFUNCT(IOPPTR),3                                  1148
         BE    @RT01148                                            1148
         CLI   IOPFUNCT(IOPPTR),4                                  1148
         BNE   @RF01148                                            1148
@RT01148 DS    0H                                                  1149
*     DO;                                                          1149
*       CALL BLDL;                  /* SEARCH CURRENT LIBRARY        */
         BAL   @14,BLDL                                            1150
*       GO TO EXIT;                 /* RETURN                        */
         B     EXIT                                                1151
*     END;                                                         1152
*                                                                  1152
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID REQUEST FOR MACRO/SOURCE LIBRARIES            @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1153
*   IOPRETRN=IOPIOERR;              /* SET BAD RTN           @Z40SP00*/
@RF01148 MVI   IOPRETRN(IOPPTR),X'10'                              1153
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/
         B     EXIT                                                1154
         EJECT
*                                                                  1155
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE DYNAMICALLY ALLOCATED DATASET(IOPLRF)Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1155
*LRFRTN:                            /*                       @Z67SP00*/
*   IF IOPFUNCT=IOPALC              /* IF ALLOCATE           @Z67SP00*/
*       ×IOPFUNCT=IOPDALC           /* OR DE-ALLOCATE        @Z67SP00*/
*       ×IOPFUNCT=IOPDEL            /* OR DELETE             @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
LRFRTN   CLI   IOPFUNCT(IOPPTR),13                                 1155
         BE    @RT01155                                            1155
         CLI   IOPFUNCT(IOPPTR),14                                 1155
         BE    @RT01155                                            1155
         CLI   IOPFUNCT(IOPPTR),15                                 1155
         BNE   @RF01155                                            1155
@RT01155 DS    0H                                                  1156
*     DO;                           /*                       @Z67SP00*/
*       GEN(CLOSE ((DCBPTR)))                                      1157
*       REFS(DCBPTR);               /* CLOSE DCB             @Z67SP00*/
         CLOSE ((DCBPTR))
*       IF DCBOFOPN=ON              /* IF CLOSE FAILED       @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     1158
         BO    @RT01158                                            1158
*         GO TO CLOSFAIL;           /* GO ISSUE MSG          @Z67SP00*/
*       TCBPTR=CVTNTCB;             /* ADDR OF CURRENT TCB   @Z67SP00*/
         L     @11,CVTPTR                                          1160
         L     @11,CVTTCBP(,@11)                                   1160
         L     @11,CVTNTCB(,@11)                                   1160
         ST    @11,TCBPTR                                          1160
*       TCBPTR=JSCBTCBP;            /* ADDR OF INITS TCB     @Z67SP00*/
         L     @11,TCBJSCB(,@11)                                   1161
         L     @11,JSCBTCBP(,@11)                                  1161
         ST    @11,TCBPTR                                          1161
*       RNAME=IOPDSN;               /* SET RESOURCE NAME     @Z67SP00*/
         MVC   RNAME(44),IOPDSN(IOPPTR)                            1162
*       DO RNAMELEN=0 TO LENGTH(RNAME) WHILE(/* CALC LEN     @Z67SP00*/
*             RNAME(RNAMELEN+1)^=BLANK);/* OF RNAME          @Z67SP00*/
         SLR   @11,@11                                             1163
         STC   @11,RNAMELEN                                        1163
@DL01163 LA    @04,RNAME(@11)                                      1163
         CLI   0(@04),C' '                                         1163
         BE    @DC01163                                            1163
*       END;                        /*                       @Z67SP00*/
         AH    @11,@CH00088                                        1164
         STC   @11,RNAMELEN                                        1164
         CH    @11,@CH00384                                        1164
         BNH   @DL01163                                            1164
@DC01163 DS    0H                                                  1165
*       IF IOPFUNCT=IOPALC          /* IF ALLOC REQUEST      @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         CLI   IOPFUNCT(IOPPTR),13                                 1165
         BNE   @RF01165                                            1165
*         DO;                       /*                       @Z67SP00*/
*           GEN(ENQ (QNAME,ENQRNAME,,0,SYSTEM),TCB=TCBPTR,RET=USE) 1167
*           REFS(QNAME,ENQRNAME,TCBPTR);/* ENQ ON DATASET NAME     1167
*                                      ALLOCATED SO THAT SYSTEM WILL
*                                      ALLOW RELEASE TO BE DONE AT 1167
*                                      COPY CLOSE            @Z67SP00*/
         ENQ (QNAME,ENQRNAME,,0,SYSTEM),TCB=TCBPTR,RET=USE
*           RFY                     /*                       @Z67SP00*/
*             RTNCODE RSTD;         /*                       @Z67SP00*/
*           IF RTNCODE=ZERO         /* IF ENQ DONE OK        @Z67SP00*/
*             THEN                  /* THEN                  @Z67SP00*/
         LTR   RTNCODE,RTNCODE                                     1169
         BNZ   @RF01169                                            1169
*             ENQDONE=ON;           /* REMEMBER TO DO DEQ    @Z67SP00*/
         OI    ENQDONE,B'01000000'                                 1170
*           ELSE                    /*                       @Z67SP00*/
*             DO;                   /*                       @Z67SP00*/
         B     @RC01169                                            1171
@RF01169 DS    0H                                                  1172
*               IF ENQRC=ENQNTAVL   /* IF RESOURCE NOT AVAIL @Z67SP00*/
*                 THEN              /*                       @Z67SP00*/
         CLI   ENQRC(RTNCODE),4                                    1172
         BNE   @RF01172                                            1172
*                 DO;               /*                       @Z67SP00*/
*                   MGPMGNO1=HMA403I;/* ENQ FAILED FOR DATASET X44X
*                                                            @Z67SP00*/
         MVC   MGPMGNO1(2),@CH03325                                1174
*                   MGPVARPT(1)=ADDR(IOPDSN);/* DSN          @Z67SP00*/
         LA    @14,IOPDSN(,IOPPTR)                                 1175
         ST    @14,MGPVARPT                                        1175
*                   MGPTYPE=MGPERR; /*                       @Z67SP00*/
         MVI   MGPTYPE,X'03'                                       1176
*                   CALL HMASMMSG(HMASMMGP);/*               @Z67SP00*/
         L     @15,@CV03346                                        1177
         LA    @01,@AL01177                                        1177
         BALR  @14,@15                                             1177
*                   IOPRETRN=IOPNQERR;/* ENQ ERROR           @Z67SP00*/
         MVI   IOPRETRN(IOPPTR),X'08'                              1178
*                 END;              /* END NOT AVAILABLE     @Z67SP00*/
*               ELSE                /*                       @Z67SP00*/
*                 ENQDONE=ON;       /*                       @Z67SP00*/
         B     @RC01172                                            1180
@RF01172 OI    ENQDONE,B'01000000'                                 1180
*             END;                  /* END NOT 0 ENQ RC      @Z67SP00*/
@RC01172 DS    0H                                                  1182
*           RFY                     /*                       @Z67SP00*/
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/
@RC01169 DS    0H                                                  1183
*         END;                      /* END ALC REQUEST       @Z67SP00*/
*       ELSE                        /* IF NOT ALC REQUEST    @Z67SP00*/
*         DO;                       /*                       @Z67SP00*/
         B     @RC01165                                            1184
@RF01165 DS    0H                                                  1185
*           IF ENQDONE=ON           /* IF ENQ DONE           @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         TM    ENQDONE,B'01000000'                                 1185
         BNO   @RF01185                                            1185
*             GEN(DEQ (QNAME,ENQRNAME,0,SYSTEM),TCB=TCBPTR,RET=HAVE)
*             REFS(QNAME,ENQRNAME,TCBPTR);/* DEQ ON DATASET NAME   1186
*                                                            @Z67SP00*/
         DEQ (QNAME,ENQRNAME,0,SYSTEM),TCB=TCBPTR,RET=HAVE
*         END;                      /* END NOT ALC           @Z67SP00*/
*       GO TO EXIT;                 /* RETURN                @Z67SP00*/
         B     EXIT                                                1188
*     END;                          /*                       @Z67SP00*/
*   GO TO ANYDDRTN;                 /* GO TO CODE TO HANDLE OTHER  1190
*                                      FUNCTIONS             @Z67SP00*/
         B     ANYDDRTN                                            1190
*                                                                  1191
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE OPERATIONS TO DATA SETS DEFINED IN THE      */
*   /* IOPDDNAM. THESE DATA SETS MAY BE TEXTLIB(IOPDSID=IOPTXTDD) OF */
*   /* OPERATING SYSTEM LIBRARIES(IOPDSID=IOPANYDD) TO GIVE BLDL AND */
*   /* STOW CAPIBILITY                                       @Z40SP00*/
*   /* IN ORDER TO DELETE A MEMBER THE LIBRARY MUST NOT BE MARKED AS */
*   /* UNMOVEABLE. IF IOPDSID=IOPDDNM THE THIS IS CHECKED    @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1191
*DDDELRTN:                          /*                       @Z30XX9J*/
*   IF DCBDSGU=ON                   /* OPENED UNMOVEABLE DS  @Z30XX9J*/
*       &IOPFUNCT=IOPSTOWD          /* AND FUNCTION WAS DELETE FROM
*                                      SYSTEM DATA SET       @Z40SP00*/
*     THEN                          /* YES - CANT DO SCR/COMPR     1191
*                                                            @Z30XX9J*/
DDDELRTN TM    DCBDSGU+16(DCBPTR),B'00000001'                      1191
         BNO   @RF01191                                            1191
         CLI   IOPFUNCT(IOPPTR),83                                 1191
         BNE   @RF01191                                            1191
*     DO;                           /* ERR                   @Z30XX9J*/
*       IOPRETRN=IOPUNMOV;          /* SET RETURN CODE       @Z30XX9J*/
         MVI   IOPRETRN(IOPPTR),X'04'                              1193
*       GO TO EXIT;                 /* RETURN                @Z30XX9J*/
         B     EXIT                                                1194
*     END;                          /* END UNMOVEABLE DS GROUP     1195
*                                                            @Z30XX9J*/
*                                                                  1195
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE ENTERED IF IOPDSID=IOPTXTDD OR IOPANYDD. ALSO FALL    */
*   /* THRU HERE IF IOPDSID=IOPDDNM AND DATA SET IS NOT UNMOVEABLE   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1196
*ANYDDRTN:                          /*                       @Z40SP00*/
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT
*                                      DIRECTORY NOT IN STORAGE FOR
*                                      SPECIFIED DATA SET    @Z67SP00*/
@RF01191 DS    0H                                                  1196
ANYDDRTN DS    0H                                                  1197
*   DISOSW=OFF;                     /*                       @Z67SP00*/
         NI    DISISW,B'11100111'                                  1197
*   DSBFRMX=DCBBLKSI/TXTLRECL;      /* SET BUFFER FACTOR     @Z67SP00*/
         LH    @00,DCBBLKSI+52(,DCBPTR)                            1198
         SRDA  @00,32                                              1198
         D     @00,@CF00512                                        1198
         STH   @01,DSBFRMX                                         1198
*   PDSI=XXX;                       /*                       @Z67SP00*/
         LA    @11,14                                              1199
         STC   @11,PDSI                                            1199
*   PDSADDR=ADDR(PDSARRAY(PDSI));   /* SET CONTROL ARRAY AD  @Z67SP00*/
         SLA   @11,4                                               1200
         LA    @11,PDSARRAY-16(@11)                                1200
         ST    @11,PDSADDR                                         1200
*   IF IOPFUNCT=IOPSTOWD            /* DELETE OPERATION?     @Z40SP00*/
*       ×IOPFUNCT=IOPUDEO           /* OR DIRECT UPDATE      @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
         CLI   IOPFUNCT(IOPPTR),83                                 1201
         BE    @RT01201                                            1201
         CLI   IOPFUNCT(IOPPTR),86                                 1201
         BNE   @RF01201                                            1201
@RT01201 DS    0H                                                  1202
*     DO;                           /* DO DELETE             @Z40SP00*/
*       CALL STOW;                  /* DO STOW DELETE        @Z30XX9J*/
         BAL   @14,STOW                                            1203
*       GO TO EXIT;                 /* RETURN                @Z30XX9J*/
         B     EXIT                                                1204
*     END;                          /* END STOW DELETE       @Z40SP00*/
*                                                                  1205
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTION=LOCATE                                       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1206
*   IF IOPFUNCT=IOPLOC              /* LOCATE?               @Z40SP00*/
*       ×IOPFUNCT=IOPBLDL           /* OR BLDL?              @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
@RF01201 CLI   IOPFUNCT(IOPPTR),3                                  1206
         BE    @RT01206                                            1206
         CLI   IOPFUNCT(IOPPTR),4                                  1206
         BNE   @RF01206                                            1206
@RT01206 DS    0H                                                  1207
*     DO;                           /*                       @Z40SP00*/
*       CALL BLDL;                  /* DO LOCATE             @Z40SP00*/
         BAL   @14,BLDL                                            1208
*       GO TO EXIT;                 /* RETURN                @Z40SP00*/
         B     EXIT                                                1209
*     END;                          /* END LOCATE OPERATION  @Z40SP00*/
*                                                                  1211
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTION IS INPUT(READ) FOR TEXT LIBRARY CHECK CCA TO SEE IF A*/
*   /* BUFFER HAS BEEN GETMAINED FOR THIS AREA YET. IF NOT GET ONE   */
*   /*                                                       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1211
*   RFY                                                            1211
*     SIZE RSTD;                    /* REMOVE SIZE FROM USE  @Z40SP00*/
@RF01206 DS    0H                                                  1212
*   IF DCBBLKSI>CCATBFSZ            /* CURRENT BUFFER TOO SMALL    1212
*                                                            @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
         L     @11,@CA00038                                        1212
         L     @03,CCATBFSZ-HMASMCCA(,@11)                         1212
         CH    @03,DCBBLKSI+52(,DCBPTR)                            1212
         BNL   @RF01212                                            1212
*     DO;                           /* GET ANOTHER AREA      @Z40SP00*/
*       IF CCATBFSZ^=ZERO           /* IS THERE A BUFFER?    @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
         LTR   @03,@03                                             1214
         BZ    @RF01214                                            1214
*         DO;                       /* FREE PRESENT BUFFER   @Z40SP00*/
*           SIZE=CCATBFSZ;          /* FREEMAIN SIZE         @Z40SP00*/
         LR    SIZE,@03                                            1216
*           FREEADDR=CCATBFIA;      /* SET FREEMAIN ADDR     @Z40SP00*/
         MVC   FREEADDR(4),CCATBFIA-HMASMCCA(@11)                  1217
*           GEN(FREEMAIN E,LV=(SIZE),A=FREEADDR)                   1218
*           REFS(SIZE,FREEADDR);    /* FREE OLD AREA         @Z40SP00*/
         FREEMAIN E,LV=(SIZE),A=FREEADDR
*         END;                      /* END FREEMAIN          @Z40SP00*/
*       SIZE=DCBBLKSI;              /* NEW SIZE              @Z40SP00*/
@RF01214 LH    SIZE,DCBBLKSI+52(,DCBPTR)                           1220
*       GEN(GETMAIN EC,LV=(SIZE),A=GETADDR)                        1221
*       REFS(SIZE,GETADDR);         /* GET ANOTHER AREA      @Z40SP00*/
         GETMAIN EC,LV=(SIZE),A=GETADDR
*       RFY                                                        1222
*         RTNCODE RSTD;             /* REMOVE R15 FROM USE   @Z40SP00*/
*       IF RTNCODE^=IOPGOOD         /* GETMAIN DONE?         @Z40SP00*/
*         THEN                      /* NO                    @Z40SP00*/
         SLR   @14,@14                                             1223
         CR    RTNCODE,@14                                         1223
         BE    @RF01223                                            1223
*         DO;                       /*                       @Z40SP00*/
*           RFY                                                    1225
*             RTNCODE UNRSTD;       /* RETURN R15 FOR USE    @Z40SP00*/
*           CCATBFIA=ZERO;          /* SET BUFFER ADDR       @Z40SP00*/
         L     @11,@CA00038                                        1226
         ST    @14,CCATBFIA-HMASMCCA(,@11)                         1226
*           MGPMGNO1=HMA202I;       /* SET FOR GETMAIN FAIL  @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00235                                1227
*           MGPTYPE=MGPERR;         /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'03'                                       1228
*           CALL HMASMMSG(HMASMMGP);/* WRITE MSG             @Z40SP00*/
         L     @15,@CV03346                                        1229
         LA    @01,@AL01229                                        1229
         BALR  @14,@15                                             1229
*           IOPRETRN=IOPNTOPN;      /* SET RETURN CODE       @Z40SP00*/
         MVI   IOPRETRN(IOPPTR),X'0C'                              1230
*           GO TO EXIT;             /* RETURN                @Z40SP00*/
         B     EXIT                                                1231
*         END;                      /* END GETMAIN FAIL      @Z40SP00*/
*       CCATBFIA=GETADDR;           /* SET ADDR OF GETMAIN   @Z40SP00*/
@RF01223 L     @11,@CA00038                                        1233
         MVC   CCATBFIA-HMASMCCA(4,@11),GETADDR                    1233
*       CCATBFSZ=SIZE;              /* PUT GETMAIN SIZE IN CCA     1234
*                                                            @Z40SP00*/
         ST    SIZE,CCATBFSZ-HMASMCCA(,@11)                        1234
*       CCATBFMX=DCBBLKSI/TXTLRECL; /* MAX RCD IN BLK        @Z40SP00*/
         LH    @00,DCBBLKSI+52(,DCBPTR)                            1235
         SRDA  @00,32                                              1235
         D     @00,@CF00512                                        1235
         STH   @01,CCATBFMX-HMASMCCA(,@11)                         1235
*       RFY                                                        1236
*         SIZE UNRSTD;              /* RETURN REG FOR USE    @Z40SP00*/
*     END;                          /* END NEED GETMAIN      @Z40SP00*/
*                                                                  1238
*   /*****************************************************************/
*   /*                                                               */
*   /* BUFFER IS AVAILABLE. OPERATION IS POSITION FOR INPUT FOR A    */
*   /* TXTLIB DATA SET                                       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1238
*   IF IOPFUNCT=IOPPOSI             /* POSITION FOR INPUT?   @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
@RF01212 CLI   IOPFUNCT(IOPPTR),2                                  1238
         BNE   @RF01238                                            1238
*     DO;                           /*                       @Z40SP00*/
*       CALL POINT;                 /* POINT                 @Z40SP00*/
         BAL   @14,POINT                                           1240
*       TBFRCNTI=ZERO;              /* ZERO RCD CNT          @Z40SP00*/
         SLR   @11,@11                                             1241
         STH   @11,TBFRCNTI                                        1241
*       TBFRSIZ=ZERO;               /* ZERO RCDS IN BUFR     @Z40SP00*/
         STH   @11,TBFRSIZ                                         1242
*       GO TO EXIT;                 /* RETURN                @Z40SP00*/
         B     EXIT                                                1243
*     END;                          /* END POSITION          @Z40SP00*/
*                                                                  1244
*   /*****************************************************************/
*   /*                                                               */
*   /* OPERATION IS READ FROM TXTLIB DATA SET                @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1245
*   IF IOPFUNCT=IOPREAD             /* READ                  @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
@RF01238 CLI   IOPFUNCT(IOPPTR),1                                  1245
         BNE   @RF01245                                            1245
*     DO;                           /*                       @Z40SP00*/
*       IOPRETRN=IOPGOOD;           /* SET GOOD RTN CODE     @Z40SP00*/
         MVI   IOPRETRN(IOPPTR),X'00'                              1247
*       TBFRCNTI=TBFRCNTI+1;        /* UPDATE RCD NUM        @Z40SP00*/
         LA    @11,1                                               1248
         AH    @11,TBFRCNTI                                        1248
         STH   @11,TBFRCNTI                                        1248
*       IF TBFRCNTI>TBFRSIZ         /* ANY RCDS IN BLK?      @Z40SP00*/
*         THEN                      /* NO                    @Z40SP00*/
         CH    @11,TBFRSIZ                                         1249
         BNH   @RF01249                                            1249
*         DO;                       /*                       @Z40SP00*/
*           BUFFSV=IOPBUFAD;        /* SAVE BUFFER ADDR      @ZD00009*/
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          1251
*           IOPBUFAD=CCATBFIA;      /* INPUT BUFFER ADDR     @Z40SP00*/
         L     @11,@CA00038                                        1252
         MVC   IOPBUFAD(4,IOPPTR),CCATBFIA-HMASMCCA(@11)           1252
*           CALL READ;              /* READ NEXT BLOCK       @Z40SP00*/
         BAL   @14,READ                                            1253
*           IOPBUFAD=BUFFSV;        /* RESET IOPBUFAD        @Z40SP00*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           1254
*           IF IOPRETRN=IOPGOOD     /* GOOD READ             @Z40SP00*/
*               &CCATBFMX>1         /* AND DS BLOCKED        @Z40SP00*/
*             THEN                  /* YES                   @Z40SP00*/
         CLI   IOPRETRN(IOPPTR),0                                  1255
         BNE   @RF01255                                            1255
         L     @11,@CA00038                                        1255
         LH    @11,CCATBFMX-HMASMCCA(,@11)                         1255
         CH    @11,@CH00088                                        1255
         BNH   @RF01255                                            1255
*             TBFRSIZ=(DCBBLKSI-IOBRSCT)/TXTLRECL;/*         @Z40SP00*/
         LA    @11,52                                              1256
         ALR   @11,DCBPTR                                          1256
         L     @04,DCBIOBA(,@11)                                   1256
         LH    @00,DCBBLKSI(,@11)                                  1256
         SH    @00,IOBRSCT+8(,@04)                                 1256
         SRDA  @00,32                                              1256
         D     @00,@CF00512                                        1256
         STH   @01,TBFRSIZ                                         1256
*           ELSE                    /* NOT BLOCKED AND GOOD  @Z40SP00*/
*             TBFRSIZ=ONE;          /* UNBLOCKED             @Z40SP00*/
         B     @RC01255                                            1257
@RF01255 MVC   TBFRSIZ(2),@CH00088                                 1257
*           TBFRCNTI=ONE;           /* RESET RCD LEFT        @Z40SP00*/
@RC01255 MVC   TBFRCNTI(2),@CH00088                                1258
*         END;                      /* END BLOCK EMPTY       @Z40SP00*/
*       IF IOPRETRN=IOPEOF          /* END OF FILE           @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
@RF01249 CLI   IOPRETRN(IOPPTR),4                                  1260
         BNE   @RF01260                                            1260
*         TBFRCNTI=ZERO;            /* RESET CNT FOR NEXT RD @Z40SP00*/
         SLR   @11,@11                                             1261
         STH   @11,TBFRCNTI                                        1261
*       ELSE                        /* NOT EOF               @Z40SP00*/
*         LOGICREC=TXTIBUFR(TBFRCNTI);/* MOVE RCD TO BFR     @Z40SP00*/
         B     @RC01260                                            1262
@RF01260 L     @11,IOPBUFAD(,IOPPTR)                               1262
         LH    @04,TBFRCNTI                                        1262
         MH    @04,@CH00512                                        1262
         L     @03,@CA00038                                        1262
         L     @03,CCATBFIA-HMASMCCA(,@03)                         1262
         ALR   @03,@04                                             1262
         AL    @03,@CF04248                                        1262
         MVC   LOGICREC(80,@11),TXTIBUFR(@03)                      1262
*       GO TO EXIT;                 /* RETURN                @Z40SP00*/
         B     EXIT                                                1263
*     END;                          /* END READ              @Z40SP00*/
*                                                                  1264
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID REQUEST FOR TEXTLIB                           @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1265
*   IOPRETRN=IOPIOERR;              /* INVALID FUNCTION      @Z40SP00*/
@RF01245 MVI   IOPRETRN(IOPPTR),X'10'                              1265
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/
         B     EXIT                                                1266
         EJECT
*                                                                  1267
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS TO HANDLE THE SMPPUNCH DATA SET       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1267
*PUNRTN:                            /*                       @Z40SP00*/
*   IF IOPFUNCT=IOPWRITE            /* WRITE REQUEST?        @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
PUNRTN   CLI   IOPFUNCT(IOPPTR),81                                 1267
         BNE   @RF01267                                            1267
*     DO;                           /*                       @Z40SP00*/
*       PRNTDATA(1:PRLRLEN)=PRLDATA(1:PRLRLEN);/* MOVE DATA TO OUTPUT
*                                      BUFFER                @Z40SP00*/
         L     @11,IOPBUFAD(,IOPPTR)                               1269
         LH    @04,PRLRLEN(,@11)                                   1269
         BCTR  @04,0                                               1269
         EX    @04,@SM04253                                        1269
*       BUFFSV=IOPBUFAD;            /* SAVE BUFFER ADDR      @ZD00009*/
         ST    @11,BUFFSV                                          1270
*       IOPBUFAD=ADDR(PRNTDATA(1)); /* POINT TO DATA TO PUNCH      1271
*                                                            @Z40SP00*/
         LA    @11,PRNTDATA                                        1271
         ST    @11,IOPBUFAD(,IOPPTR)                               1271
*       CALL PUT;                   /* PUNCH IT              @Z40SP00*/
         BAL   @14,PUT                                             1272
*       IOPBUFAD=BUFFSV;            /* RESET BUFFER ADDR     @ZD00009*/
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           1273
*       PRNTDATA=BLANK;             /* BLANK OUT BUFFER      @Z40SP00*/
         MVI   PRNTDATA+1,C' '                                     1274
         MVC   PRNTDATA+2(118),PRNTDATA+1                          1274
         MVI   PRNTDATA,C' '                                       1274
*     END;                          /* END WRITE REQUEST     @Z40SP00*/
*   ELSE                            /* NOT WRITE - INVALID   @Z40SP00*/
*     IOPRETRN=IOPIOERR;            /* SET BAD RTN CDE AND   @Z40SP00*/
         B     @RC01267                                            1276
@RF01267 MVI   IOPRETRN(IOPPTR),X'10'                              1276
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/
         B     EXIT                                                1277
         EJECT
*                                                                  1278
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED WHEN A REQUEST HAS BEEN MADE TO MODIFY */
*   /* A DATA SET TO BE OTHER THAN REQUESTED ON THE DD CARD. THE PDS */
*   /* MAY BECOME A MEMBER OF A PDS AND THEN CHANGED BACK OR THE     */
*   /* REQUEST COUND BE JUST TO RETRIEVE THE JFCB            @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1278
*JFCBRTN:                           /*                       @Z40SP00*/
*   GEN(CLOSE  ((DCBPTR)))                                         1278
*   REFS(DCBPTR);                   /* CLOSE DCB             @Z67SP00*/
JFCBRTN  CLOSE  ((DCBPTR))
*   IF DCBOFOPN=ON                  /* IF CLOSE FAILED       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     1279
         BO    @RT01279                                            1279
*     GO TO CLOSFAIL;               /* GO WRITE ERR MSG      @Z67SP00*/
*   GO TO EXIT;                     /* RETURN                @Z67SP00*/
         B     EXIT                                                1281
         EJECT
*                                                                  1282
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE REQUESTES FOR THE SMPPTFIN DATASET  @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1282
*PTFINRTN:                          /*                       @Z67SP00*/
*                                                                  1282
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS READ REQUESTS                                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1282
*   IF IOPFUNCT=IOPREAD             /* IF READ REQUEST       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
PTFINRTN CLI   IOPFUNCT(IOPPTR),1                                  1282
         BNE   @RF01282                                            1282
*     DO;                           /*                       @Z67SP00*/
*       CALL GET;                   /* GET NEXT RECORD       @Z67SP00*/
         BAL   @14,GET                                             1284
*       GO TO EXIT;                 /*                       @Z67SP00*/
         B     EXIT                                                1285
*     END;                          /*                       @Z67SP00*/
*                                                                  1286
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS POISTION FOR INPUT REQUESTS. JFCB HAS ALREADY BEEN    */
*   /* MODIFIED TO POINT TO CORRECT DATASETNAME AND FILE NUMBER. NOW */
*   /* CLOSE DCB WITH REREAD OPTION TO PREVENT TAPE REWIND           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1287
*   IF IOPFUNCT=IOPPOSI             /* IF POSITION FOR INPUT @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF01282 CLI   IOPFUNCT(IOPPTR),2                                  1287
         BNE   @RF01287                                            1287
*     DO;                           /*                       @Z67SP00*/
*       GEN(CLOSE ((DCBPTR),REREAD));/* CLOSE DCB            @Z40SP00*/
         CLOSE ((DCBPTR),REREAD)
*       IF DCBOFOPN=ON              /* CLOSE FAIL?           @Z40SP00*/
*         THEN                      /* YES                   @Z40SP00*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     1290
         BO    @RT01290                                            1290
*         GO TO CLOSFAIL;           /* GO WRITE ERR MSG      @Z40SP00*/
*       GO TO EXIT;                 /* RETURN                @Z40SP00*/
         B     EXIT                                                1292
*     END;                          /*                       @Z67SP00*/
*   GO TO BADEXIT;                  /* INVALID REQUEST       @Z67SP00*/
         B     BADEXIT                                             1294
         EJECT
*                                                                  1295
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO SET IOPDSID BASED ON TYPE MEMBER SPECIFIED  */
*   /* IF IOPDSID PASSED WAS IOPWKX                          @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1295
*IODSCHCK:                          /*                       @Z67SP00*/
*   PROCEDURE;                      /*                       @Z67SP00*/
IODSCHCK STM   @14,@12,12(@13)                                     1295
*   IF IOPTYPE=IOPMCR               /* IF MAC REPLACEMENT    @Z67SP00*/
*       ×IOPTYPE=IOPMCU             /* OR UPDATE             @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CLI   IOPTYPE(IOPPTR),3                                   1296
         BE    @RT01296                                            1296
         CLI   IOPTYPE(IOPPTR),4                                   1296
         BNE   @RF01296                                            1296
@RT01296 DS    0H                                                  1297
*     DO;                           /*                       @Z67SP00*/
*       IOPDDNAM=CCADSIDA(IOPWK1);  /*                       @Z67SP00*/
         L     @11,@CA00038                                        1298
         L     @11,CCADSAD-HMASMCCA(,@11)                          1298
         MVC   IOPDDNAM(8,IOPPTR),CCADSIDA+272(@11)                1298
*       IOPDSID=IOPWK1;             /* USE WK1               @Z67SP00*/
         MVI   IOPDSID(IOPPTR),X'23'                               1299
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /*                       @Z67SP00*/
*     IF IOPTYPE=IOPSRC             /* IF SRC REPLACEMENT    @Z67SP00*/
*         ×IOPTYPE=IOPSCU           /* OR SRCUPD             @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
         B     @RC01296                                            1301
@RF01296 CLI   IOPTYPE(IOPPTR),8                                   1301
         BE    @RT01301                                            1301
         CLI   IOPTYPE(IOPPTR),9                                   1301
         BNE   @RF01301                                            1301
@RT01301 DS    0H                                                  1302
*       DO;                         /*                       @Z67SP00*/
*         IOPDDNAM=CCADSIDA(IOPWK2);/*                       @Z67SP00*/
         L     @11,@CA00038                                        1303
         L     @11,CCADSAD-HMASMCCA(,@11)                          1303
         MVC   IOPDDNAM(8,IOPPTR),CCADSIDA+280(@11)                1303
*         IOPDSID=IOPWK2;           /* USE WK2               @Z67SP00*/
         MVI   IOPDSID(IOPPTR),X'24'                               1304
*       END;                        /*                       @Z67SP00*/
*     ELSE                          /*                       @Z67SP00*/
*       IF IOPTYPE=IOPMOD           /* IF MOD REPLACEMENT    @Z67SP00*/
*           ×IOPTYPE=IOPASM         /* OR ASSEMBLY           @Z67SP00*/
*           ×IOPTYPE=IOPZAP         /* OR ZAP                @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         B     @RC01301                                            1306
@RF01301 CLI   IOPTYPE(IOPPTR),5                                   1306
         BE    @RT01306                                            1306
         CLI   IOPTYPE(IOPPTR),1                                   1306
         BE    @RT01306                                            1306
         CLI   IOPTYPE(IOPPTR),12                                  1306
         BNE   @RF01306                                            1306
@RT01306 DS    0H                                                  1307
*         DO;                       /*                       @Z67SP00*/
*           IOPDDNAM=CCADSIDA(IOPWK3);/*                     @Z67SP00*/
         L     @11,@CA00038                                        1308
         L     @11,CCADSAD-HMASMCCA(,@11)                          1308
         MVC   IOPDDNAM(8,IOPPTR),CCADSIDA+288(@11)                1308
*           IOPDSID=IOPWK3;         /* USE WK3               @Z67SP00*/
         MVI   IOPDSID(IOPPTR),X'25'                               1309
*         END;                      /*                       @Z67SP00*/
*       ELSE                        /*                       @Z67SP00*/
*         IF IOPTYPE=IOPXZP         /* IF EXPAND CARDS       @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         B     @RC01306                                            1311
@RF01306 CLI   IOPTYPE(IOPPTR),13                                  1311
         BNE   @RF01311                                            1311
*           DO;                     /*                       @Z67SP00*/
*             IOPDDNAM=CCADSIDA(IOPWK4);/*                   @Z67SP00*/
         L     @11,@CA00038                                        1313
         L     @11,CCADSAD-HMASMCCA(,@11)                          1313
         MVC   IOPDDNAM(8,IOPPTR),CCADSIDA+296(@11)                1313
*             IOPDSID=IOPWK4;       /* USE WK4               @Z67SP00*/
         MVI   IOPDSID(IOPPTR),X'26'                               1314
*           END;                    /*                       @Z67SP00*/
*         ELSE                      /* INVALID TYPE/DSID     @Z67SP00*/
*           IOPRETRN=IOPIOERR;      /* SO SET BAD ERROR      @Z67SP00*/
         B     @RC01311                                            1316
@RF01311 MVI   IOPRETRN(IOPPTR),X'10'                              1316
*   END IODSCHCK;                   /*                       @Z67SP00*/
@EL00002 DS    0H                                                  1317
@EF00002 DS    0H                                                  1317
@ER00002 LM    @14,@12,12(@13)                                     1317
         BR    @14                                                 1317
         EJECT
*                                                                  1318
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED AFTER RDJFCB ISSUED. THIS ROUTINE WILL DO ALL  */
*   /* PROCESSING REQUIRED TO CHANGE THE JFCB                @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1318
*JFCBMOD:                           /*                       @Z67SP00*/
*   PROCEDURE;                      /*                       @Z67SP00*/
JFCBMOD  STM   @14,@12,@SA00003                                    1318
*   IOPRETRN=IOPGOOD;               /* SET RETURN CODE       @Z67SP00*/
*                                                                  1319
         MVI   IOPRETRN(IOPPTR),X'00'                              1319
*   /*****************************************************************/
*   /*                                                               */
*   /* MODIFY JFCB FOR IOPJFCB DATASET                       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1320
*   IF IOPDSID=IOPJFCB              /* JFCB CHANGE?          @Z40SP00*/
*       &(IOPFUNCT=IOPJFCSI         /* CHANGE TO MEM OF PDS FOR INPUT
*                                                            @Z40SP00*/
*       ×IOPFUNCT=IOPJFCSO)         /* OR CHANGE TO MEM OF PDS FOR 1320
*                                      OUTPUT                @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
         CLI   IOPDSID(IOPPTR),25                                  1320
         BNE   @RF01320                                            1320
         CLI   IOPFUNCT(IOPPTR),5                                  1320
         BE    @RT01320                                            1320
         CLI   IOPFUNCT(IOPPTR),88                                 1320
         BNE   @RF01320                                            1320
@RT01320 DS    0H                                                  1321
*     DO;                           /* SAVE JFCB             @Z40SP00*/
*       IF JFCB01NM(1)=BLANK        /* IF NO SAVE IN 01      @Z67SP00*/
*         THEN                      /* THEN SAVE JFCB THERE  @Z67SP00*/
         CLI   JFCB01NM,C' '                                       1322
         BNE   @RF01322                                            1322
*         DO;                       /*                       @Z67SP00*/
*           ADJFCB01->JFCBAREA=JFCBAREA;/*                   @Z67SP00*/
         L     @11,ADJFCB01                                        1324
         L     @04,JFCBPTR                                         1324
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     1324
*           JFCB01NM=IOPDDNAM;      /* JFCB IN USE BY        @Z67SP00*/
         MVC   JFCB01NM(8),IOPDDNAM(IOPPTR)                        1325
*         END;                      /*                       @Z67SP00*/
*       ELSE                        /* IF 01 IN USE          @Z67SP00*/
*         IF JFCB02NM(1)=BLANK      /* IF 02 NOT IN          @Z67SP00*/
*           THEN                    /* SAVE JFCB THERE       @Z67SP00*/
         B     @RC01322                                            1327
@RF01322 CLI   JFCB02NM,C' '                                       1327
         BNE   @RF01327                                            1327
*           DO;                     /*                       @Z67SP00*/
*             ADJFCB02->JFCBAREA=JFCBAREA;/*                 @Z67SP00*/
         L     @11,ADJFCB02                                        1329
         L     @04,JFCBPTR                                         1329
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     1329
*             JFCB02NM=IOPDDNAM;    /* JFCB IN USE BY        @Z67SP00*/
         MVC   JFCB02NM(8),IOPDDNAM(IOPPTR)                        1330
*           END;                    /*                       @Z67SP00*/
*         ELSE                      /* IF BOTH FILLED        @Z67SP00*/
*           IOPRETRN=IOPIOERR;      /* INTERNAL ERROR        @Z67SP00*/
         B     @RC01327                                            1332
@RF01327 MVI   IOPRETRN(IOPPTR),X'10'                              1332
*       IF IOPFUNCT=IOPJFCSO        /* IF RESET FOR OUTPUT   @Z67SP00*/
*           &JFCDISP=DISPNEW        /* AND DS IS ALLOC NEW   @Z67SP00*/
*         THEN                      /* CHANGE TO DISP=OLD    @Z67SP00*/
@RC01327 DS    0H                                                  1333
@RC01322 CLI   IOPFUNCT(IOPPTR),88                                 1333
         BNE   @RF01333                                            1333
         L     @11,JFCBPTR                                         1333
         TM    JFCDISP(@11),B'11000000'                            1333
         BNO   @RF01333                                            1333
*         JFCDISP=DISPOLD;          /* SO NO OUTPUT PROBLEMS WITH  1334
*                                      UTILITY. DISP WILL BE RESET 1334
*                                      WHEN DS CHANGED BACK TO PDS 1334
*                                                            @Z67SP00*/
         NI    JFCDISP(@11),B'01111111'                            1334
         OI    JFCDISP(@11),B'01000000'                            1334
*       JFCBOPSW=ON;                /* SET REWITE AT OPEN SW @Z40SP00*/
@RF01333 L     @11,JFCBPTR                                         1335
         OI    JFCBOPSW(@11),B'10000000'                           1335
*       JFCNWRIT=OFF;               /* RESET NO WRITE BIT    @Z67SP00*/
         NI    JFCNWRIT(@11),B'11110111'                           1336
*       JFCPDS=ON;                  /* SET MEM OF PDS        @Z40SP00*/
         OI    JFCPDS(@11),B'00000001'                             1337
*       JFCBELNM=IOPINAM;           /* SET MEMBER NAME       @ZD00008*/
         MVC   JFCBELNM(8,@11),IOPINAM(IOPPTR)                     1338
*     END;                          /* END JFCB CHANGE       @Z40SP00*/
*                                                                  1339
*   /*****************************************************************/
*   /*                                                               */
*   /* MODIFY JFCB FOR IOPCDS OR IOPACDS DATASETS            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1340
*   IF IOPDSID=IOPCDSM              /* WAS THIS FOR CDS?     @YA05376*/
*       ×IOPDSID=IOPCDSA            /* OR ACDS?              @SA72416*/
*     THEN                          /* YES - CHECK DISP      @YA05376*/
@RF01320 CLI   IOPDSID(IOPPTR),2                                   1340
         BE    @RT01340                                            1340
         CLI   IOPDSID(IOPPTR),12                                  1340
         BNE   @RF01340                                            1340
@RT01340 DS    0H                                                  1341
*     IF JFCDISP=DISPMOD            /* DISP=MOD?             @YA05376*/
*       THEN                        /* YES                   @YA05376*/
         L     @11,JFCBPTR                                         1341
         TM    JFCDISP(@11),B'10000000'                            1341
         BNO   @RF01341                                            1341
         TM    JFCDISP(@11),B'01000000'                            1341
         BNZ   @RF01341                                            1341
*       DO;                         /*                       @YA05376*/
*         JFCDISP=DISPOLD;          /* CHANGE TO DISP=OLD    @YA05376*/
         NI    JFCDISP(@11),B'01111111'                            1343
         OI    JFCDISP(@11),B'01000000'                            1343
*         JFCBOPSW=ON;              /* INDICATE THAT JFCB SHOULD BE
*                                      REWRITTEN AT OPEN     @Z40SP00*/
         OI    JFCBOPSW(@11),B'10000000'                           1344
*         JFCNWRIT=OFF;             /* RESET NO WRITE BIT    @Z67SP00*/
         NI    JFCNWRIT(@11),B'11110111'                           1345
*       END;                        /* END CDS/ACDS          @YA05376*/
*                                                                  1346
*   /*****************************************************************/
*   /*                                                               */
*   /* MODIFY JFCB FOR IOPPTFIN DATASET                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1347
*   IF IOPDSID=IOPPTFIN             /* IF PTFIN              @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF01341 DS    0H                                                  1347
@RF01340 CLI   IOPDSID(IOPPTR),10                                  1347
         BNE   @RF01347                                            1347
*     DO;                           /*                       @Z67SP00*/
*       IF IOPSEQNO=1               /* IF FILE 1 THEN        @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         CLC   IOPSEQNO(2,IOPPTR),@CH00088                         1349
         BNE   @RF01349                                            1349
*         DO;                       /*                       @Z67SP00*/
*           IF PTFJFSV=OFF          /* IF JFCB NOT SAVED YET @Z67SP00*/
*               ×PTFF2OP=OFF        /* OR NEVER OPENED 2ND   @Z67SP00*/
*             THEN                  /* FILE                  @Z67SP00*/
         TM    PTFJFSV,B'00000011'                                 1351
         BO    @RF01351                                            1351
*             DO;                   /*                               */
*               PTFJFSV=ON;         /* INDICATE JFCB SAVED   @Z67SP00*/
         OI    PTFJFSV,B'00000010'                                 1353
*               ADJFCBPT->JFCBAREA=JFCBAREA;/* SAVE IT       @Z67SP00*/
         L     @11,ADJFCBPT                                        1354
         L     @04,JFCBPTR                                         1354
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     1354
*             END;                  /*                               */
*           ELSE                    /* IF SECOND TIME THEN   @Z67SP00*/
*             JFCBAREA=ADJFCBPT->JFCBAREA;/* COPY FROM SAVE  @Z67SP00*/
         B     @RC01351                                            1356
@RF01351 L     @11,JFCBPTR                                         1356
         L     @04,ADJFCBPT                                        1356
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     1356
*           JFCBOPSW=ON;            /* REWRITE JFCB AT OPEN  @Z67SP00*/
@RC01351 L     @11,JFCBPTR                                         1357
         OI    JFCBOPSW(@11),B'10000000'                           1357
*           JFCNWRIT=OFF;           /* MERGE BACK JFCB       @Z67SP00*/
         NI    JFCNWRIT(@11),B'11110111'                           1358
*         END;                      /*                       @Z67SP00*/
*       ELSE                        /* IF RELFILE ON TAPE    @Z67SP00*/
*         DO;                       /*                       @Z67SP00*/
         B     @RC01349                                            1360
@RF01349 DS    0H                                                  1361
*           IF JFCSL=OFF            /* IF NOT SL TAPE        @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         L     @11,JFCBPTR                                         1361
         TM    JFCSL(@11),B'00000010'                              1361
         BNZ   @RF01361                                            1361
*             DO;                   /*                       @Z67SP00*/
*               MGPCLEAR=''B;       /*                       @Z67SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                1363
*               MGPMGNO1=HMA343I;   /* PTFIN WITH RELFILES MUST BE 1364
*                                      STANDARD LABEL        @Z67SP00*/
         MVC   MGPMGNO1(2),@CH03323                                1364
*               MGPTYPE=MGPTERM;    /*                       @Z67SP00*/
         MVI   MGPTYPE,X'05'                                       1365
*               CALL HMASMMSG(HMASMMGP);/* WRITE MSG         @Z67SP00*/
         L     @15,@CV03346                                        1366
         LA    @01,@AL01366                                        1366
         BALR  @14,@15                                             1366
*               IOPRETRN=IOPNTOPN;  /*                       @Z67SP00*/
         MVI   IOPRETRN(IOPPTR),X'0C'                              1367
*             END;                  /*                       @Z67SP00*/
*           ELSE                    /* IF TAPE IS SL         @Z67SP00*/
*             DO;                   /*                       @Z67SP00*/
         B     @RC01361                                            1369
@RF01361 DS    0H                                                  1370
*               PTFF2OP=ON;         /* OPENED SECOND FILE    @Z67SP00*/
         OI    PTFF2OP,B'00000001'                                 1370
*               JFCRECFM=RECFMNL;   /* GET RECFM FROM TAPE   @Z67SP00*/
         L     @11,JFCBPTR                                         1371
         MVI   JFCRECFM(@11),B'00000000'                           1371
*               JFCLRECL=ZERO;      /* GET LRECL FROM TAPE   @Z67SP00*/
         SLR   @04,@04                                             1372
         STH   @04,JFCLRECL(,@11)                                  1372
*               JFCBLKSI=ZERO;      /* GET BLKSIZE FROM TP   @Z67SP00*/
         STH   @04,JFCBLKSI(,@11)                                  1373
*               JFCBDSNM=IOPDSN;    /* MOVE DSN TO JFCB      @Z67SP00*/
         MVC   JFCBDSNM(44,@11),IOPDSN(IOPPTR)                     1374
*               JFCBFLSQ=IOPSEQNO;  /* MOVE FILE SEQ NUM     @Z67SP00*/
         MVC   JFCBFLSQ(2,@11),IOPSEQNO(IOPPTR)                    1375
*               JFCBOPSW=ON;        /* REWRITE JFCB AT OPEN  @Z67SP00*/
         OI    JFCBOPSW(@11),B'10000000'                           1376
*               JFCNWRIT=OFF;       /* MERGE BACK JFCB       @Z67SP00*/
         NI    JFCNWRIT(@11),B'11110111'                           1377
*             END;                  /*                       @Z67SP00*/
*         END;                      /* END PTFIN FILE 1      @Z67SP00*/
@RC01361 DS    0H                                                  1380
*     END;                          /* END PTFIN DATASET     @Z67SP00*/
*                                                                  1380
@RC01349 DS    0H                                                  1381
*   /*****************************************************************/
*   /*                                                               */
*   /* MODIFY JFCB FOR IOPLRF DATASET                        @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1381
*   IF IOPDSID=IOPLRF               /* IF LRF DS             @Z67SP00*/
*       &(IOPFUNCT=IOPALC           /* ALLOCATE              @Z67SP00*/
*       ×IOPFUNCT=IOPDALC           /* DEALLOCATE            @Z67SP00*/
*       ×IOPFUNCT=IOPDEL)           /* OR DELETE             @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF01347 CLI   IOPDSID(IOPPTR),32                                  1381
         BNE   @RF01381                                            1381
         CLI   IOPFUNCT(IOPPTR),13                                 1381
         BE    @RT01381                                            1381
         CLI   IOPFUNCT(IOPPTR),14                                 1381
         BE    @RT01381                                            1381
         CLI   IOPFUNCT(IOPPTR),15                                 1381
         BNE   @RF01381                                            1381
@RT01381 DS    0H                                                  1382
*     DO;                           /*                       @Z67SP00*/
*       JFCRECFM=RECFMNL;           /* GET RECFM FROM DS     @Z67SP00*/
         L     @11,JFCBPTR                                         1383
         MVI   JFCRECFM(@11),B'00000000'                           1383
*       IF IOPFUNCT=IOPALC          /* IF NEW DATASET ALLOC  @Z67SP00*/
*           &IOPSPRIM^=ZERO         /* (IE SPACE SPECIFIED   @Z67SP00*/
*         THEN                      /* THEN MUST SET RECFM   @Z67SP00*/
         CLI   IOPFUNCT(IOPPTR),13                                 1384
         BNE   @RF01384                                            1384
         ICM   @04,3,IOPSPRIM(IOPPTR)                              1384
         BZ    @RF01384                                            1384
*         IF IOPDMAC=ON             /* IF MAC/SRC/ OR JCLIN  @Z67SP00*/
*             ×IOPDSRC=ON           /*                       @Z67SP00*/
*             ×IOPDJCL=ON           /*                       @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         TM    IOPDMAC(IOPPTR),B'11100000'                         1385
         BZ    @RF01385                                            1385
*           DO;                     /* THEN ASSUME           @Z67SP00*/
*             JFCFMREC=RECFMF;      /* RECFM=F               @Z67SP00*/
         NI    JFCFMREC(@11),B'10111111'                           1387
         OI    JFCFMREC(@11),B'10000000'                           1387
*             JFCRFB=RECFMB;        /* RECFM=.B              @Z67SP00*/
         OI    JFCRFB(@11),B'00010000'                             1388
*           END;                    /*                       @Z67SP00*/
*         ELSE                      /* MUST BE MOD TYPE      @Z67SP00*/
*           JFCFMREC=RECFMU;        /* ASSUME RECFM=U        @Z67SP00*/
         B     @RC01385                                            1390
@RF01385 L     @11,JFCBPTR                                         1390
         OI    JFCFMREC(@11),B'11000000'                           1390
*       JFCLRECL=ZERO;              /* GET LRECL FROM DS     @Z67SP00*/
@RC01385 DS    0H                                                  1391
@RF01384 SLR   @11,@11                                             1391
         L     @04,JFCBPTR                                         1391
         STH   @11,JFCLRECL(,@04)                                  1391
*       JFCBLKSI=ZERO;              /* GET BLKSIZE FROM DS   @Z67SP00*/
         STH   @11,JFCBLKSI(,@04)                                  1392
*       CALL HMASMALC(HMASMIOP,INFMJFCB);/* CALL ALC MOD     @Z67SP00*/
         ST    IOPPTR,@AL00001                                     1393
         ST    @04,@AL00001+4                                      1393
         L     @15,@CV03342                                        1393
         LA    @01,@AL00001                                        1393
         BALR  @14,@15                                             1393
*       RFY                                                        1394
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       IOPRETRN=RTNCODE;           /* SAVE RC FROM ALC      @Z67SP00*/
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1395
*       RFY                                                        1396
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*       IF IOPRETRN<IOPNTFND        /* IF ALLOC OK           @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         CLI   IOPRETRN(IOPPTR),4                                  1397
         BNL   @RF01397                                            1397
*         DO;                       /*                       @Z67SP00*/
*           JFCBOPSW=ON;            /* REWRITE JFCB AT OPEN  @Z67SP00*/
         L     @11,JFCBPTR                                         1399
         OI    JFCBOPSW(@11),B'10000000'                           1399
*           JFCNWRIT=OFF;           /* RESET NO WRITE BIT    @Z67SP00*/
         NI    JFCNWRIT(@11),B'11110111'                           1400
*         END;                      /*                       @Z67SP00*/
*     END;                          /* END LRF DATASET       @Z67SP00*/
*   RETURN;                         /* RETURN TO CALLER      @Z67SP00*/
@EL00003 DS    0H                                                  1403
@EF00003 DS    0H                                                  1403
@ER00003 LM    @14,@12,@SA00003                                    1403
         BR    @14                                                 1403
*   END JFCBMOD;                    /*                       @Z67SP00*/
         B     @EL00003                                            1404
         EJECT
*                                                                  1405
*   /*****************************************************************/
*   /*                                                               */
*   /* DCB EXIT ROUTINE TO FIX BLKSIZE WHEN MISSING                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1405
*DCBEXIT:                                                          1405
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          1405
DCBEXIT  DS    0H                                                  1406
*   DECLARE                         /*                       @Z67SP00*/
*     WKXBLKSI CONSTANT(3200);      /*                       @Z67SP00*/
*   RFY                                                            1407
*     RTNREG RSTD;                                                 1407
*                                                                  1407
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW INSURE THAT BLKSIZE IS MULTIPLE OF LRECL FOR DATASETS     */
*   /* ALLOCATED WITHOUT DCB ATTRIBUTES AND SET BLKSIZE FOR WORK     */
*   /* FILES IF NOT ALREADY ALLOCATED                        @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1408
*   IF DCBRECL^=RECFMU              /* DO NOT CHECK BLKSIZE  @Z40SP00*/
*       &IOPDSID^=IOPLRF            /* AND LRECL IF RECFM=U  @Z67SP00*/
*     THEN                          /* OR FOR LRF DATASET    @Z40SP00*/
         TM    DCBRECL+28(DCBPTR),B'11000000'                      1408
         BO    @RF01408                                            1408
         CLI   IOPDSID(IOPPTR),32                                  1408
         BE    @RF01408                                            1408
*     DO;                           /* BLKSIZE NOT A MULTIPLE OF   1409
*                                      LRECL IN THIS CASE    @Z40SP02*/
*       IF DCBBLKSI=ZERO            /* IS BLOCK SIZE SPECIFIED?      */
*           ×(DCBBLKSI//DCBLRECL)^=ZERO/* OR IF THE SYSUT1 BLKSIZE 1410
*                                      HAS BEEN PREVIOUSLY SET TO AN
*                                      UNACCEPTABLE VALUE THEN     1410
*                                                            @YA05115*/
*         THEN                      /* NO - SET TO LRECL             */
         SLR   @15,@15                                             1410
         LH    @11,DCBBLKSI+52(,DCBPTR)                            1410
         CR    @11,@15                                             1410
         BE    @RT01410                                            1410
         LR    @00,@11                                             1410
         SRDA  @00,32                                              1410
         LH    @11,DCBLRECL+72(,DCBPTR)                            1410
         DR    @00,@11                                             1410
         CR    @00,@15                                             1410
         BE    @RF01410                                            1410
@RT01410 DS    0H                                                  1411
*         DO;                       /*                       @Z67SP00*/
*           IF IOPDSID=IOPWK1       /* IF WRK DATA SETS      @Z67SP00*/
*               ×IOPDSID=IOPWK2     /*                       @Z67SP00*/
*               ×IOPDSID=IOPWK3     /*                       @Z67SP00*/
*               ×IOPDSID=IOPWK4     /*                       @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         CLI   IOPDSID(IOPPTR),35                                  1412
         BE    @RT01412                                            1412
         CLI   IOPDSID(IOPPTR),36                                  1412
         BE    @RT01412                                            1412
         CLI   IOPDSID(IOPPTR),37                                  1412
         BE    @RT01412                                            1412
         CLI   IOPDSID(IOPPTR),38                                  1412
         BNE   @RF01412                                            1412
@RT01412 DS    0H                                                  1413
*             DCBBLKSI=WKXBLKSI;    /* SET BLKSIZE=3200      @Z67SP00*/
         MVC   DCBBLKSI+52(2,DCBPTR),@CH04103                      1413
*           ELSE                    /*                       @Z67SP00*/
*             DCBBLKSI=DCBLRECL;    /* SET BLKSIZE TO LRECL          */
         B     @RC01412                                            1414
@RF01412 MVC   DCBBLKSI+52(2,DCBPTR),DCBLRECL+72(DCBPTR)           1414
*         END;                      /*                       @Z67SP00*/
@RC01412 DS    0H                                                  1416
*       IF IOPDSID=IOPSCR1          /* OPENING SYSUT1 SCR1 DATA SET ?
*                                                            @YA05115*/
*         THEN                      /* YES THEN INSURE THAT  @YA05115*/
@RF01410 CLI   IOPDSID(IOPPTR),3                                   1416
         BNE   @RF01416                                            1416
*         DCBKEYLE=ZERO;            /* KEYLEN IS RESET TO 0 FROM ANY
*                                      PREVIOUS USES         @YA05115*/
         MVI   DCBKEYLE+16(DCBPTR),X'00'                           1417
*     END;                                                         1418
*   RFY                                                            1419
*     RTNREG UNRSTD;                                               1419
*   END DCBEXIT;                                                   1420
@EL00004 DS    0H                                                  1420
@EF00004 DS    0H                                                  1420
@ER00004 BR    @14                                                 1420
         EJECT
*READ:                                                             1421
*   PROCEDURE OPTIONS(SAVEAREA);    /* READ SUBROUTINE               */
*                                                                  1421
READ     STM   @14,@12,12(@13)                                     1421
         ST    @13,@SA00005+4                                      1421
         LA    @14,@SA00005                                        1421
         ST    @14,8(,@13)                                         1421
         LR    @13,@14                                             1421
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED TO PERFORM BSAM READS. THE DCB ADDR IS*/
*   /* OBTAINED FROM DCBPTR, THE AREA ADDRESS IS OBTAINED FROM       */
*   /* IOPBUFAD. THE RECORD LENGTH IS TAKEN FROM THE SPECIFIED DCB.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1422
*   IOPRETRN=IOPGOOD;               /* INDICATE GOOD RETURN          */
         MVI   IOPRETRN(IOPPTR),X'00'                              1422
*   DCBEODA=ADDR(READEOF);          /* SET EODAD ADDR IN DCB         */
         LA    @11,READEOF                                         1423
         STCM  @11,7,DCBEODA+28(DCBPTR)                            1423
*   RFY                                                            1424
*     IOPREG RSTD;                  /* REMOVE REG FROM USE   @Z40SP00*/
*   IOPREG=IOPBUFAD;                /* GET IOP BUFFER ADDR TO REG    */
         L     IOPREG,IOPBUFAD(,IOPPTR)                            1425
*   GENERATE CODE FLOWS(READEOF,BSAMERR) REFS(DCBPTR,IOPREG,IODECB);
*                                         /*                 @ZD00003*/
         READ  IODECB,SF,(DCBPTR),(IOPREG),'S',MF=E READ RECORD
         CHECK IODECB
*   RFY                                                            1427
*     IOPREG UNRSTD;                /* RETURN REG TO USE     @Z40SP00*/
*   RETURN;                         /* EXIT                          */
@EL00005 L     @13,4(,@13)                                         1428
@EF00005 DS    0H                                                  1428
@ER00005 LM    @14,@12,12(@13)                                     1428
         BR    @14                                                 1428
*READEOF:                                                          1429
*   IOPRETRN=IOPEOF;                /* INDICATE END OF FILE FOUND    */
READEOF  MVI   IOPRETRN(IOPPTR),X'04'                              1429
*   END READ;                       /* EXIT TO REQUESTOR             */
         B     @EL00005                                            1430
         EJECT
*WRITE:                                                            1431
*   PROCEDURE OPTIONS(NOSAVEAREA);  /*                       @Z40SP00*/
*                                                                  1431
WRITE    STM   @14,@12,12(@13)                                     1431
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED TO PERFORM BSAM WRITES - SINCE THIS   */
*   /* ROUTINE CAN BE RE-ENTERED DUE TO MULTIPLE I/O ERROR THE SAVE  */
*   /* AREA AND CHAINING MUST BE HANDLED SIMILIAR TO THAT AT THE MAIN*/
*   /* ENTRY FOR HMASMIO. AFTER ENTRY CODE IS SET UP THE DCB ADDRESS */
*   /* IS OBTAINED FROM DCBPTR, AND THE I/O AREA IS GOTTON FROM      */
*   /* IOPBUFAD                                              @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1432
*   WTENTCNT=WTENTCNT+1;            /* INCR RE-ENTRY COUNT   @Z40SP00*/
         SLR   @11,@11                                             1432
         IC    @11,WTENTCNT                                        1432
         LA    @11,1(,@11)                                         1432
         STC   @11,WTENTCNT                                        1432
*   IF WTENTCNT>DIM(WTSVAREA)       /* IF GREATER THEN CODE  @ZA12350*/
*     THEN                          /* ALLOWS THEN CANT DO   @Z40SP00*/
         CLI   WTENTCNT,6                                          1433
         BNH   @RF01433                                            1433
*     DO;                           /* WRITE                 @Z40SP00*/
*       WTENTCNT=WTENTCNT-1;        /* DECR ENTRY COUNT      @Z40SP00*/
         BCTR  @11,0                                               1435
         STC   @11,WTENTCNT                                        1435
*       IOPRETRN=IOPIOERR;          /* SET I/O ERR RTN       @Z40SP00*/
         MVI   IOPRETRN(IOPPTR),X'10'                              1436
*       RETURN;                     /* AND RETURN TO CALLER  @Z40SP00*/
@EL00006 DS    0H                                                  1437
@EF00006 DS    0H                                                  1437
@ER00006 LM    @14,@12,12(@13)                                     1437
         BR    @14                                                 1437
*     END;                          /*                       @Z40SP00*/
*   RFY                                                            1439
*     R1 RSTD;                      /*                       @ZA12350*/
@RF01433 DS    0H                                                  1440
*   R1=ADDR(WTSVAREA(WTENTCNT));    /* SET ADDR TO PROPER SAVE AREA
*                                      DECLARED IN IO        @ZA12350*/
         SLR   @11,@11                                             1440
         IC    @11,WTENTCNT                                        1440
         MH    @11,@CH00833                                        1440
         L     R1,ADWTSAVE                                         1440
         AL    R1,@CF04235                                         1440
         LA    R1,WTSVAREA(@11,R1)                                 1440
*   RFY                                                            1441
*     SVAREAS BASED(R1);            /*                       @Z40SP00*/
*   SVBACK=R13;                     /* ST 13,SAVE+4          @Z40SP00*/
         ST    R13,SVBACK(,R1)                                     1442
*   RFY                                                            1443
*     SVAREAS BASED(R13);           /*                       @Z40SP00*/
*   SVFWRD=R1;                      /* ST R1,8(R13)          @Z40SP00*/
         ST    R1,SVFWRD(,R13)                                     1444
*   R13=R1;                         /* SET PTR TO NEW SAVE AREA      */
         LR    R13,R1                                              1445
*   RFY                                                            1446
*     R1 UNRSTD;                    /*                       @Z40SP00*/
*                                                                  1446
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE AREA GOTTEN AND CHAINED TOGETHER NOW DO WRITE    @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1447
*   RFY                                                            1447
*    (LENREG,                                                      1447
*     IOPREG) RSTD;                 /* REMOVE REG FROM USE   @Z40SP00*/
*   IOPREG=IOPBUFAD;                /* GET IOP BUFFER ADDR TO REG    */
         L     @11,IOPBUFAD(,IOPPTR)                               1448
         LR    IOPREG,@11                                          1448
*   IF IOPDSID=IOPHLDS              /* IS THIS HISTORY LOG WRITE?    */
*     THEN                          /* YES - SET LENGTH OF RECORD    */
         CLI   IOPDSID(IOPPTR),1                                   1449
         BNE   @RF01449                                            1449
*     LENREG=PRLRLEN;               /* FROM PRL LENGTH               */
         LH    LENREG,PRLRLEN(,@11)                                1450
*   ELSE                            /* OTHERWISE - SET TO ZERO       */
*     LENREG=ZERO;                  /* SET ZERO LENGTH - UNUSED      */
         B     @RC01449                                            1451
@RF01449 SLR   LENREG,LENREG                                       1451
*   GENERATE CODE FLOWS(BSAMERR,BPAMERR) REFS(DCBPTR,IOPREG,LENREG,
*       IODECB);                                                   1452
@RC01449 DS    0H                                                  1452
*                                                /*          @ZD00003*/
         WRITE IODECB,SF,(DCBPTR),(IOPREG),(LENREG),MF=E WRITE RECORD
         CHECK IODECB                 WAIT FOR COMPLETION OF I/O
*   RFY                                                            1453
*    (LENREG,                                                      1453
*     IOPREG) UNRSTD;               /* RETURN REGS FOR USE   @Z40SP00*/
*                                                                  1453
*   /*****************************************************************/
*   /*                                                               */
*   /* MUST NOW RESET SAVE AREA CHAIN                        @ZA12350*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1454
*   RFY                                                            1454
*     SVAREAS BASED(R13);           /*                       @Z40SP00*/
*   R13=SVBACK;                     /* ADDR OF OLD SAVE AREA @Z40SP00*/
         L     R13,SVBACK(,R13)                                    1455
*   WTENTCNT=WTENTCNT-1;            /* DECR ENTRY COUNT      @Z40SP00*/
         SLR   @11,@11                                             1456
         IC    @11,WTENTCNT                                        1456
         BCTR  @11,0                                               1456
         STC   @11,WTENTCNT                                        1456
*   END WRITE;                      /* EXIT TO REQUESTOR             */
         B     @EL00006                                            1457
         EJECT
*POINT:                                                            1458
*   PROCEDURE OPTIONS(SAVEAREA);                                   1458
*                                                                  1458
POINT    STM   @14,@12,12(@13)                                     1458
         ST    @13,@SA00007+4                                      1458
         LA    @14,@SA00007                                        1458
         ST    @14,8(,@13)                                         1458
         LR    @13,@14                                             1458
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED TO PERFORM POINT OPERATIONS. THE TTR  */
*   /* IS OBTAINED FROM IOPTTR AND THE DCB ADDRESS IS GOTTEN FROM    */
*   /* DCBPTR.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1459
*   DECLARE                         /*                       @Z40SP00*/
*     1 POINTTTR CHAR(4) BDY(WORD), /* TTR FOR POINT MACRO   @Z40SP00*/
*      2 PTTR13 CHAR(3),            /* THREE BYTE TTR        @Z40SP00*/
*      2 PTTR4 FIXED(8) INIT(0);    /* MUST BE ZERO          @Z40SP00*/
*   IOPRETRN=IOPGOOD;               /* SET RETURN CODE       @Z40SP00*/
         MVI   IOPRETRN(IOPPTR),X'00'                              1460
*   PTTR13=IOPTTR;                  /* MOVE TTR TO PARM AREA @Z40SP00*/
         MVC   PTTR13(3),IOPTTR(IOPPTR)                            1461
*   PTTR4=ZERO;                     /* LAST BYTE MUST BE 0   @Z40SP00*/
         MVI   PTTR4,X'00'                                         1462
*   GENERATE REFS(DCBPTR,POINTTTR);                                1463
         POINT (DCBPTR),POINTTTR       POINT TO MEMBER       @Z40SP00
*   END POINT;                      /*                       @Z40SP00*/
@EL00007 L     @13,4(,@13)                                         1464
@EF00007 DS    0H                                                  1464
@ER00007 LM    @14,@12,12(@13)                                     1464
         BR    @14                                                 1464
         EJECT
*NOTE:                                                             1465
*   PROCEDURE(NOTETTR) OPTIONS(SAVEAREA);                          1465
*                                                                  1465
NOTE     STM   @14,@12,12(@13)                                     1465
         ST    @13,@SA00008+4                                      1465
         LA    @14,@SA00008                                        1465
         ST    @14,8(,@13)                                         1465
         LR    @13,@14                                             1465
         MVC   @PC00008(4),0(@01)                                  1465
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED TO PERFORM THE NOTE OPERATION. THE DCB*/
*   /* ADDRESS IS OBTAINED FROM DCBPTR AND THE TTR IS RETURNED IN THE*/
*   /* IOPTTR FIELD.                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1466
*   DECLARE                                                        1466
*     NOTETTR PTR(24);              /* TTR FOR NOTES                 */
*   IOPRETRN=IOPGOOD;               /* INDICATE GOOD RETURN  @YA07506*/
         MVI   IOPRETRN(IOPPTR),X'00'                              1467
*   GENERATE REFS(DCBPTR);                                         1468
         NOTE  (DCBPTR)             NOTE THE DCB
*   RFY                                                            1469
*     R1 RSTD;                                                     1469
*   TEMPTTR=R1;                     /* PUT TTR IN TEMP AREA          */
         ST    R1,TEMPTTR                                          1470
*   RFY                                                            1471
*     R1 UNRSTD;                                                   1471
*   NOTETTR=TEMPTTR(1:3);           /* PUT THE TTR IN THE PARM LIST  */
         L     @11,@PC00008                                        1472
         MVC   NOTETTR(3,@11),TEMPTTR                              1472
*   END NOTE;                       /* EXIT TO REQUESTOR             */
@EL00008 L     @13,4(,@13)                                         1473
@EF00008 DS    0H                                                  1473
@ER00008 LM    @14,@12,12(@13)                                     1473
         BR    @14                                                 1473
         EJECT
*STOW:                                                             1474
*   PROCEDURE OPTIONS(SAVEAREA);                                   1474
*                                                                  1474
STOW     STM   @14,@12,12(@13)                                     1474
         ST    @13,@SA00009+4                                      1474
         LA    @14,@SA00009                                        1474
         ST    @14,8(,@13)                                         1474
         LR    @13,@14                                             1474
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED TO STOW MEMBERS INTO A PDS. THE DCB   */
*   /* ADDRESS IS OBTAINED FROM DCBPTR, AND THE STOW PARM LIST IS    */
*   /* CONTAINED WITHIN THE IOP. IF THE OPERATION IS STOW DELETE OR  */
*   /* STOW REPLACE, THEN NO CHANGE NEED BE MADE TO THE IOP. FOR STOW*/
*   /* CHANGE, THE USER DATA FIELD CONTAINS THE NAMES TO BE SWAPPED  */
*   /* IN THE DIRECTORY.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1475
*   DECLARE                         /*                       @ZD00008*/
*     IOPPTR2 PTR(31);              /* PTR TO ALT IOP        @ZD00008*/
*   DECLARE                         /*                       @ZD00008*/
*     1 STOWCPRM,                   /* STOW CHANGE PARM      @ZD00008*/
*       3 STOWONAM CHAR(8),         /* OLD NAME              @ZD00008*/
*       3 STOWNNAM CHAR(8);         /* NEW NAME              @ZD00008*/
*   DECLARE                         /*                       @ZD00003*/
*     SAVONAME CHAR(8);             /* FOR SAVING NAMES      @ZD00003*/
*   DECLARE                         /* ACROSS CALLS          @ZD00003*/
*     SAVNNAME CHAR(8);             /* TO EIS FOR STOWC      @ZD00003*/
*   DECLARE                         /*                       @ZA17736*/
*     RELADSV CHAR(3);              /* DCBRELAD SAVE         @ZA17736*/
*   DECLARE                         /*                       @ZA17736*/
*     1 OFLGSSV CHAR(1),            /* DCBOFLGS SAVE FOR STOW      1480
*                                                            @ZA17736*/
*       3 OFLWRSV BIT(1),           /* ON IF LAST IO WRITE   @ZA17736*/
*       3 * BIT(7);                 /*                       @ZA17736*/
*   DECLARE                         /* FOR PROPER SAVING OF  @ZA17736*/
*     SAVMASK BIT(8) CONSTANT('80'X);/* DCBOFLWR             @ZA17736*/
*   RFY                                                            1482
*     IOPREG RSTD;                  /* REMOVE REG FROM USE   @Z40SP00*/
*   IOPREG=ADDR(IOPINAM);           /*                       @ZD00008*/
         LA    IOPREG,IOPINAM(,IOPPTR)                             1483
*   IOPRETRN=IOPGOOD;               /* INIT RETURN CODE      @ZD00003*/
*                                                                  1484
         MVI   IOPRETRN(IOPPTR),X'00'                              1484
*   /*****************************************************************/
*   /*                                                               */
*   /* OPERATION IS STOW REPLACE(ADD) OR STOW OF DIRECTORY INFO ONLY */
*   /*                                                       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1485
*   IF(IOPFUNCT=IOPSTOWR            /* IS THIS STOW (REPLACE)?       */
*       ×IOPFUNCT=IOPUDEO)          /* OR IS IT UPDATE DIRECT ONLY   */
*       &DISOSW=OFF                 /* AND DIRECTORY NOT INSTORAGE 1485
*                                      FOR UPDATE            @Z67SP00*/
*     THEN                          /* YES - PERFORM THE OPERATION   */
         CLI   IOPFUNCT(IOPPTR),84                                 1485
         BE    @GL00117                                            1485
         CLI   IOPFUNCT(IOPPTR),86                                 1485
         BNE   @RF01485                                            1485
@GL00117 TM    DISOSW,B'00001000'                                  1485
         BNZ   @RF01485                                            1485
*     DO;                                                          1486
*       IF IOPFUNCT=IOPUDEO         /* DIRECTORY ONLY UPDATE @ZA17736*/
*         THEN                      /* YES                   @ZA17736*/
         CLI   IOPFUNCT(IOPPTR),86                                 1487
         BNE   @RF01487                                            1487
*         DO;                       /*                       @ZA17736*/
*           RELADSV=DCBRELAD(1:3);  /* SAVE ACROSS STOW      @ZA17736*/
         MVC   RELADSV(3),DCBRELAD(DCBPTR)                         1489
*           DCBRELAD(1:3)=IOPTTR;   /* PUT TTR FROM IOP INTO DCB SO
*                                      THAT STOW WILL USE IT @ZA17736*/
         MVC   DCBRELAD(3,DCBPTR),IOPTTR(IOPPTR)                   1490
*           OFLGSSV=DCBOFLGS;       /* SAVE FLAGS ACROSS STOW@ZA17736*/
         LA    @11,40                                              1491
         ALR   @11,DCBPTR                                          1491
         MVC   OFLGSSV(1),DCBOFLGS(@11)                            1491
*           DCBOFLWR=OFF;           /* SET BIT TO ZERO       @ZA17736*/
         NI    DCBOFLWR(@11),B'01111111'                           1492
*           OFLGSSV=OFLGSSV&SAVMASK;/* SAVE ONLY DCBOFLWR    @ZA17736*/
         NI    OFLGSSV,X'80'                                       1493
*         END;                      /* END DIRECT ONLY UPDAT @Z40SP00*/
*       GENERATE REFS(DCBPTR,IOPREG);                              1495
@RF01487 DS    0H                                                  1495
        STOW  (DCBPTR),(IOPREG),R    STOW THE UPDATED MEMBER
*       RFY                                                        1496
*         RTNCODE RSTD;                                            1496
*       IOPRETRN=RTNCODE;           /* PUT RETURN CODE IN THE IOP    */
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1497
*       RFY                                                        1498
*         RTNCODE UNRSTD;                                          1498
*       IF IOPFUNCT=IOPUDEO         /* DIRECTORY ONLY UPDATE @ZA17736*/
*         THEN                      /* RESET TTR AND FLAGS   @ZA17736*/
         CLI   IOPFUNCT(IOPPTR),86                                 1499
         BNE   @RF01499                                            1499
*         DO;                       /*                       @ZA17736*/
*           DCBRELAD(1:3)=RELADSV;  /* RESET RELAD           @ZA17736*/
         MVC   DCBRELAD(3,DCBPTR),RELADSV                          1501
*           DCBOFLGS=DCBOFLGS×OFLGSSV;/* RESTORE FLAGS       @ZA17736*/
         OC    DCBOFLGS+40(1,DCBPTR),OFLGSSV                       1502
*         END;                      /* END DIRECT ONLY UPDAT @ZA17736*/
*       IF IOPRETRN<IOPDIRFL        /* IS RETURN CODE OK??   @Z40SP00*/
*         THEN                      /* YES - SET RTN CODE TO ZERO    */
@RF01499 CLI   IOPRETRN(IOPPTR),12                                 1504
         BNL   @RF01504                                            1504
*         DO;                       /*                       @Z40SP00*/
*           IOPRETRN=IOPGOOD;       /* INDICATE GOOD RETURN          */
         MVI   IOPRETRN(IOPPTR),X'00'                              1506
*           MGPPRINT=OFF;           /* NOT TO PRINTER        @Z40SP00*/
         NI    MGPPRINT,B'01111111'                                1507
*           MGPTYPE=MGPINFO;        /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'01'                                       1508
*           MGPMGNO1=HMA218I;       /* SUCCESSFULLY STORED   @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00450                                1509
*         END;                                                     1510
*       ELSE                        /* STOW RTN NOT GOOD     @YA07506*/
*         IF IOPRETRN=IOPDIRFL      /* DIRECTORY FULL?       @Z40SP00*/
*           THEN                    /* YES - INDICATE IN MESSAGE     */
         B     @RC01504                                            1511
@RF01504 CLI   IOPRETRN(IOPPTR),12                                 1511
         BNE   @RF01511                                            1511
*           DO;                     /*                       @ZD00001*/
*             MGPTYPE=MGPSEV;       /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'04'                                       1513
*             MGPMGNO1=HMA267I;     /* DIRECTORY EXCEEDED    @Z40SP00*/
         MVC   MGPMGNO1(2),@CH01031                                1514
*           END;                    /*                       @ZD00001*/
*         ELSE                      /* ELSE MUST BE I/O ERROR        */
*           DO;                     /*                       @YA07506*/
         B     @RC01511                                            1516
@RF01511 DS    0H                                                  1517
*             MGPTYPE=MGPTERM;      /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'05'                                       1517
*             MGPMGNO1=HMA268I;     /* I/O ERR ATTEMPTING TO STORE   */
         MVC   MGPMGNO1(2),@CH01033                                1518
*             IOPRETRN=IOPIOERR;    /* SET TO HIGEST SMP RTN @YA07506*/
         MVI   IOPRETRN(IOPPTR),X'10'                              1519
*           END;                    /*                       @YA07506*/
*     END;                                                         1521
@RC01511 DS    0H                                                  1521
@RC01504 DS    0H                                                  1522
         EJECT
*                                                                  1522
*   /*****************************************************************/
*   /*                                                               */
*   /* OPERATION IS STOW DELETE                              @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1522
*   IF IOPFUNCT=IOPSTOWD            /* IS IT A STOW DELETE FUNCTION  */
*       &DISOSW=OFF                 /* AND DIRECTORY NOT INSTORAGE 1522
*                                      FOR UPDATE            @Z67SP00*/
*     THEN                          /* YES - DELETE THE ENTRY        */
@RF01485 CLI   IOPFUNCT(IOPPTR),83                                 1522
         BNE   @RF01522                                            1522
         TM    DISOSW,B'00001000'                                  1522
         BNZ   @RF01522                                            1522
*     DO;                                                          1523
*       GENERATE REFS(DCBPTR,IOPREG);                              1524
         STOW   (DCBPTR),(IOPREG),D   DELETE THE CDS ENTRY
*       RFY                                                        1525
*         RTNCODE RSTD;                                            1525
*       IOPRETRN=RTNCODE;           /* SAVE STOW RETURN CODE @ZD00001*/
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1526
*       RFY                                                        1527
*         RTNCODE UNRSTD;           /*                       @ZD00001*/
*       IF IOPRETRN<IOPDIRFL        /* RETURN CODE OK??      @ZD00001*/
*         THEN                      /* YES - MAKE IT REAL GOOD       */
         CLI   IOPRETRN(IOPPTR),12                                 1528
         BNL   @RF01528                                            1528
*         DO;                       /* INDICATE IN MESSAGE..OK       */
*           IOPRETRN=IOPGOOD;       /* RETURN GOOD CODE      @Z40SP00*/
         MVI   IOPRETRN(IOPPTR),X'00'                              1530
*           MGPPRINT=OFF;           /* NOT TO PRINTER        @Z40SP00*/
         NI    MGPPRINT,B'01111111'                                1531
*           MGPTYPE=MGPINFO;        /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'01'                                       1532
*           MGPMGNO1=HMA224I;       /* SUCCESSFULLY DELETED  @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00461                                1533
*         END;                                                     1534
*       ELSE                        /* OTHERWISE , INDICATE ERROR    */
*         DO;                                                      1535
         B     @RC01528                                            1535
@RF01528 DS    0H                                                  1536
*           IOPRETRN=IOPIOERR;      /* RETURN I/O ERR RTN CDE@YA07506*/
         MVI   IOPRETRN(IOPPTR),X'10'                              1536
*           MGPTYPE=MGPTERM;        /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'05'                                       1537
*           MGPMGNO1=HMA268I;       /* I/O ERROR ATTEMPTING TO STORE */
         MVC   MGPMGNO1(2),@CH01033                                1538
*         END;                                                     1539
*     END;                                                         1540
@RC01528 DS    0H                                                  1541
*   RFY                                                            1541
*     IOPREG UNRSTD;                /* RETURN REG TO USE     @Z40SP00*/
@RF01522 DS    0H                                                  1542
         EJECT
*                                                                  1542
*   /*****************************************************************/
*   /*                                                               */
*   /* THE OPERATION MUST BE STOW CHANGE - USER DATA CONTAINS NAMES  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1542
*   IF IOPFUNCT=IOPSTOWC            /* IF STOW CHANGE        @ZD00003*/
*     THEN                          /*                       @ZD00003*/
         CLI   IOPFUNCT(IOPPTR),82                                 1542
         BNE   @RF01542                                            1542
*     DO;                           /*                       @ZD00003*/
*       IOPPTR2=ADDR(IOIOP);        /* IOP TO BE PASSED      @ZD00008*/
         LA    @11,IOIOP                                           1544
         ST    @11,IOPPTR2                                         1544
*       RFY                                                        1545
*         HMASMIOP BASED(IOPPTR2);  /*                       @ZD00008*/
*       IOPFUNCT=IOPNCODE;          /* SET FUNCT TO CAUSE ION TO   1546
*                                      CONVERT NAME          @Z67SP00*/
         MVI   IOPFUNCT(@11),X'10'                                 1546
*       IOPDSID=IOPPTR->IOPDSID;    /* DATA SET PASSED       @ZD00008*/
         MVC   IOPDSID(1,@11),IOPDSID(IOPPTR)                      1547
*       IOPNAME=IOPPTR->IOPONAME;   /* OLD NAME              @ZD00008*/
         MVC   IOPNAME(8,@11),IOPONAME(IOPPTR)                     1548
*       IOPTYPE=IOPPTR->IOPOTYPE;   /* OLD TYPE              @ZD00008*/
         MVC   IOPTYPE(1,@11),IOPOTYPE(IOPPTR)                     1549
*       CALL HMASMION(HMASMIOP);    /* CONVERT NAME          @ZD00008*/
         ST    @11,@AL00001                                        1550
         L     @15,@CV03344                                        1550
         LA    @01,@AL00001                                        1550
         BALR  @14,@15                                             1550
*       STOWONAM=IOPINAM;           /* MOVE NAME TO STOW LST @ZD00008*/
         L     @11,IOPPTR2                                         1551
         MVC   STOWONAM(8),IOPINAM(@11)                            1551
*       IOPNAME=IOPPTR->IOPNNAME;   /* NEW NAME              @ZD00008*/
         MVC   IOPNAME(8,@11),IOPNNAME(IOPPTR)                     1552
*       IOPTYPE=IOPPTR->IOPNTYPE;   /* NEW TYPE              @ZD00008*/
         MVC   IOPTYPE(1,@11),IOPNTYPE(IOPPTR)                     1553
*       CALL HMASMION(HMASMIOP);    /* CONVERT NAME          @ZD00008*/
         ST    @11,@AL00001                                        1554
         L     @15,@CV03344                                        1554
         LA    @01,@AL00001                                        1554
         BALR  @14,@15                                             1554
*       STOWNNAM=IOPINAM;           /* MOVE NAME TO STOW LST @ZD00008*/
         L     @11,IOPPTR2                                         1555
         MVC   STOWNNAM(8),IOPINAM(@11)                            1555
*       RFY                                                        1556
*         HMASMIOP BASED(IOPPTR);   /*                       @ZD00008*/
*       IF DISOSW=OFF               /* IF DIRECTORY NOT INSTORAGE    */
*         THEN                      /* FOR UPDATE            @Z67SP00*/
         TM    DISOSW,B'00001000'                                  1557
         BNZ   @RF01557                                            1557
*         DO;                       /*                       @Z67SP00*/
*           RFY                                                    1559
*             IOPREG RSTD;          /* REMOVE REG FROM USE   @Z40SP00*/
*           IOPREG=ADDR(STOWCPRM);  /* POINT STOW LIST       @ZD00008*/
         LA    IOPREG,STOWCPRM                                     1560
*           GENERATE REFS(DCBPTR,IOPREG);                          1561
         STOW  (DCBPTR),(IOPREG),C CHANGE THE ENTRY NAME
*           RFY                                                    1562
*             RTNCODE RSTD;                                        1562
*           IOPRETRN=RTNCODE;       /* SAVE RETURN CODE      @Z40SP00*/
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1563
*           RFY                                                    1564
*            (RTNCODE,                                             1564
*             IOPREG) UNRSTD;       /* RETURN REGS FOR USE   @Z40SP00*/
*           IF IOPRETRN=IOPGOOD     /* IF STOW OK            @SA76001*/
*             THEN                  /*                       @SA76001*/
         CLI   IOPRETRN(IOPPTR),0                                  1565
         BNE   @RF01565                                            1565
*             DO;                   /*                       @SA76001*/
*               MGPPRINT=OFF;       /* NOT TO PRINTER        @SA76001*/
         NI    MGPPRINT,B'01111111'                                1567
*               MGPTYPE=MGPINFO;    /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'01'                                       1568
*               MGPMGNO1=HMA218I;   /* SUCCESSFULLY STORED   @SA76001*/
         MVC   MGPMGNO1(2),@CH00450                                1569
*             END;                  /*                       @SA76001*/
*           ELSE                    /* STOW NOT OK           @SA76001*/
*             IF IOPRETRN>=IOPIOERR /* IF SEVER ERROR        @SA76001*/
*               THEN                /*                       @SA76001*/
         B     @RC01565                                            1571
@RF01565 CLI   IOPRETRN(IOPPTR),16                                 1571
         BL    @RF01571                                            1571
*               DO;                 /*                       @SA76001*/
*                 MGPTYPE=MGPTERM;  /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'05'                                       1573
*                 MGPMGNO1=HMA268I; /* I/O ERROR OCCURRED ATTEMPTING
*                                      TO STORE              @SA76001*/
         MVC   MGPMGNO1(2),@CH01033                                1574
*                 IOPRETRN=IOPIOERR;/* SET RTN TO 16         @SA76001*/
         MVI   IOPRETRN(IOPPTR),X'10'                              1575
*               END;                /*                       @SA76001*/
*             ELSE                  /* NOT SEVERE ERROR      @SA76001*/
*               IF IOPRETRN=IOPDIRFL/* IF DIRECTOY FULL      @SA76001*/
*                 THEN              /*                       @SA76001*/
         B     @RC01571                                            1577
@RF01571 CLI   IOPRETRN(IOPPTR),12                                 1577
         BNE   @RF01577                                            1577
*                 DO;               /* SET MESSAGE SEVERITY  @ZD00001*/
*                   MGPTYPE=MGPSEV; /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'04'                                       1579
*                   MGPMGNO1=HMA267I;/* DIRECTORY SPACE EXCEEDED   1580
*                                      ATTEMPTING TO STORE   @SA76001*/
         MVC   MGPMGNO1(2),@CH01031                                1580
*                 END;              /* SET MESSAGE SEVERITY  @ZD00001*/
*               ELSE                /* NOT DIRECT FULL       @SA76001*/
*                 DO;               /*                       @SA76001*/
         B     @RC01577                                            1582
@RF01577 DS    0H                                                  1583
*                   MGPTYPE=MGPERR; /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'03'                                       1583
*                   MGPMGNO1=HMA214I;/* STORE FAILED FOR     @SA76001*/
         MVC   MGPMGNO1(2),@CH00067                                1584
*                   IOPRETRN=IOPSTCRR;/* RESET RC TO 8       @SA76001*/
         MVI   IOPRETRN(IOPPTR),X'08'                              1585
*                 END;              /*                       @SA76001*/
*         END;                      /* END DIS NOT IN STOR.  @Z67SP00*/
@RC01577 DS    0H                                                  1587
@RC01571 DS    0H                                                  1587
@RC01565 DS    0H                                                  1588
*     END;                          /* END STOW CHANGE       @ZD00003*/
@RF01557 DS    0H                                                  1589
         EJECT
*                                                                  1589
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT JCLIN OR CONVERT THEN WRITE MESSAGE            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1589
*   IF DISOSW=OFF                   /* IF NOT DIW WRITE      @ZD00003*/
*       ×IOPRETRN^=IOPGOOD          /* OR IF ERROR           @Z67SP00*/
*     THEN                          /*                       @ZD00003*/
@RF01542 TM    DISOSW,B'00001000'                                  1589
         BZ    @RT01589                                            1589
         CLI   IOPRETRN(IOPPTR),0                                  1589
         BE    @RF01589                                            1589
@RT01589 DS    0H                                                  1590
*     CALL MEMMSG;                  /* WRITE MSG TO LOG      @ZD00003*/
*                                                                  1590
         BAL   @14,MEMMSG                                          1590
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DATASET DIRECTORY IS BEING MAINTAINED IN AN IN STORAGE FILE*/
*   /* ALSO THEN CALL HMASMEIS TO UPDATE IN STORAGE VERSION OF       */
*   /* DIRECTORY                                             @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1591
*   IF IOPRETRN=IOPGOOD             /* IF STOW DONE OK       @ZD00003*/
*       &DISISW=ON                  /* AND SPECIFIED DIRCT   @Z67SP00*/
*     THEN                          /* IS IN STORAGE         @ZD00003*/
@RF01589 CLI   IOPRETRN(IOPPTR),0                                  1591
         BNE   @RF01591                                            1591
         TM    DISISW,B'00010000'                                  1591
         BNO   @RF01591                                            1591
*     DO;                           /*                       @ZD00003*/
*                                                                  1592
*       /*************************************************************/
*       /*                                                           */
*       /* IF DATASET IN STORAGE FOR OUTPUT THEN MUST CHANGE CCW     */
*       /* CHAIN TO WRITE EOF RCD AND PRESERVE TTR AS PREVIOUSLY     */
*       /* DETERMINED (BY DOING NOTE AFTER FIRST WRITE)      @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1593
*       IF DISOSW=ON                /* IF DIR IN STORAGE FOR @Z67SP00*/
*           &IOPFUNCT=IOPSTOWR      /* AND STOW REPLACE      @Z67SP00*/
*           &IOPALIS=OFF            /* OUTPUT AND NOT ALIAS  @Z67SP00*/
*         THEN                      /* NO - MUST WRITE EOF   @Z67SP00*/
         TM    DISOSW,B'00001000'                                  1593
         BNO   @RF01593                                            1593
         CLI   IOPFUNCT(IOPPTR),84                                 1593
         BNE   @RF01593                                            1593
         TM    IOPALIS(IOPPTR),B'10000000'                         1593
         BNZ   @RF01593                                            1593
*         DO;                       /*                       @Z67SP00*/
*           TTRSV=DCBRELAD(1:3);    /* SAVE TTR IN DCB       @Z67SP00*/
         MVC   TTRSV(3),DCBRELAD(DCBPTR)                           1595
*           DCBBLKSI=ZERO;          /* SET TO WRT 0 LEN RCD  @Z67SP00*/
         SLR   @11,@11                                             1596
         STH   @11,DCBBLKSI+52(,DCBPTR)                            1596
*           DO M=1 TO 10;           /* LOOP THROUGH CCWS     @Z67SP00*/
         LA    @11,1                                               1597
         ST    @11,M                                               1597
@DL01597 DS    0H                                                  1598
*             IF CCWOP(M)=WCKD      /* WRT CNT,KEY,DATA?     @Z67SP00*/
*               THEN                /* YES - TURN OFF DATA   @Z67SP00*/
         SLA   @11,3                                               1598
         L     @04,DCBIOBA+52(,DCBPTR)                             1598
         L     @04,IOBSTART+8(,@04)                                1598
         ST    @11,@TF00001                                        1598
         ALR   @11,@04                                             1598
         AL    @11,@CF04239                                        1598
         CLI   CCWOP(@11),X'1D'                                    1598
         BNE   @RF01598                                            1598
*               DO;                 /*                       @Z67SP00*/
*                 CCWFLGSV=CCWFLAG(M);/* SAVE CCW FLAG       @Z67SP00*/
         LR    @11,@04                                             1600
         AL    @11,@TF00001                                        1600
         AL    @11,@CF04250                                        1600
         MVC   CCWFLGSV(1),CCWFLAG-4(@11)                          1600
*                 CCWDATA(M)=OFF;   /* TURN OFF DATA CHN BIT @Z67SP00*/
         AL    @04,@TF00001                                        1601
         AL    @04,@CF04250                                        1601
         NI    CCWDATA-4(@04),B'01111111'                          1601
*                 GO TO WRITZERO;   /* WRITE 0 LEN RCD       @Z67SP00*/
         B     WRITZERO                                            1602
*               END;                /*                       @Z67SP00*/
*           END;                    /*                       @Z67SP00*/
@RF01598 LA    @11,1                                               1604
         AL    @11,M                                               1604
         ST    @11,M                                               1604
         CH    @11,@CH00034                                        1604
         BNH   @DL01597                                            1604
*WRITZERO:                          /*                       @Z67SP00*/
*           CALL WRITE;             /* WRITE 0 LEN RCD       @Z67SP00*/
WRITZERO BAL   @14,WRITE                                           1605
*           NOTESW=ON;              /* SET SW TO FORCE NOTE TO GET 1606
*                                      TTR ON NEXT OUTPUT OP @Z67SP00*/
         L     @11,PDSADDR                                         1606
         OI    NOTESW(@11),B'01000000'                             1606
*           DCBBLKSI=DSBFRMX*PDSLRECL;/* RESET BLKSIZE       @Z67SP00*/
         LA    @11,52                                              1607
         ALR   @11,DCBPTR                                          1607
         LH    @04,DSBFRMX                                         1607
         MH    @04,@CH00512                                        1607
         STH   @04,DCBBLKSI(,@11)                                  1607
*           CCWFLAG(M)=CCWFLGSV;    /* RESET CCW FLAG IN STR @Z67SP00*/
         L     @04,M                                               1608
         SLA   @04,3                                               1608
         L     @11,DCBIOBA(,@11)                                   1608
         L     @11,IOBSTART+8(,@11)                                1608
         ALR   @11,@04                                             1608
         AL    @11,@CF04250                                        1608
         MVC   CCWFLAG-4(1,@11),CCWFLGSV                           1608
*           IOPTTR=TTRSV;           /* RESTORE TTR FOR THIS  @Z67SP00*/
         MVC   IOPTTR(3,IOPPTR),TTRSV                              1609
*         END;                      /* END IS ALIAS GROUP    @Z67SP00*/
*       IF IOPFUNCT=IOPSTOWC        /* IF STOW CHANGE        @ZD00003*/
*         THEN                      /*                       @ZD00003*/
@RF01593 CLI   IOPFUNCT(IOPPTR),82                                 1611
         BNE   @RF01611                                            1611
*         DO;                       /*                       @ZD00003*/
*           SAVONAME=IOPONAME;      /* SAVE ACTUAL NAMES     @ZD00003*/
         MVC   SAVONAME(8),IOPONAME(IOPPTR)                        1613
*           SAVNNAME=IOPNNAME;      /* ACROSS CALLS          @ZD00003*/
         MVC   SAVNNAME(8),IOPNNAME(IOPPTR)                        1614
*           IOPONAME=STOWONAM;      /* PASS CONVERTED        @ZD00003*/
         MVC   IOPONAME(8,IOPPTR),STOWONAM                         1615
*           IOPNNAME=STOWNNAM;      /* TO EIS                @ZD00003*/
         MVC   IOPNNAME(8,IOPPTR),STOWNNAM                         1616
*         END;                      /*                       @ZD00003*/
*       CALL HMASMEIS(HMASMIOP);    /* STOW TO IN-STORE DIR  @ZD00003*/
@RF01611 ST    IOPPTR,@AL00001                                     1618
         L     @15,@CV03343                                        1618
         LA    @01,@AL00001                                        1618
         BALR  @14,@15                                             1618
*       IF IOPFUNCT=IOPSTOWC        /* IF STOW CHANGE        @ZD00003*/
*         THEN                      /*                       @ZD00003*/
         CLI   IOPFUNCT(IOPPTR),82                                 1619
         BNE   @RF01619                                            1619
*         DO;                       /*                       @ZD00003*/
*           IOPONAME=SAVONAME;      /* RETURN ACTUAL NAMES   @ZD00003*/
         MVC   IOPONAME(8,IOPPTR),SAVONAME                         1621
*           IOPNNAME=SAVNNAME;      /*                       @ZD00003*/
         MVC   IOPNNAME(8,IOPPTR),SAVNNAME                         1622
*         END;                      /*                       @ZD00003*/
*       IF IOPRETRN=IOPGOOD         /* IF OPERATION OK       @Z67SP00*/
*           &CCAUPDJ=OFF            /* AND NOT JCLIN         @Z67SP00*/
*           &DISOSW=ON              /* AND ONLY DIRECTORY    @Z67SP00*/
*         THEN                      /* UPDATE                @Z67SP00*/
@RF01619 CLI   IOPRETRN(IOPPTR),0                                  1624
         BNE   @RF01624                                            1624
         L     @11,@CA00038                                        1624
         TM    CCAUPDJ-HMASMCCA(@11),B'00000100'                   1624
         BNZ   @RF01624                                            1624
         TM    DISOSW,B'00001000'                                  1624
         BNO   @RF01624                                            1624
*         DO;                       /* THEN ISSUE MESSAGE    @Z67SP00*/
*           MGPTYPE=MGPINFO;        /*                       @Z67SP00*/
         MVI   MGPTYPE,X'01'                                       1626
*           MGPPRINT=OFF;           /* NO MSG TO SMPOUT      @Z67SP00*/
         NI    MGPPRINT,B'01111111'                                1627
*           IF IOPFUNCT=IOPSTOWR    /*                       @Z67SP00*/
*               ×IOPFUNCT=IOPSTOWC  /*                       @Z67SP00*/
*               ×IOPFUNCT=IOPUDEO   /*                       @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         CLI   IOPFUNCT(IOPPTR),84                                 1628
         BE    @RT01628                                            1628
         CLI   IOPFUNCT(IOPPTR),82                                 1628
         BE    @RT01628                                            1628
         CLI   IOPFUNCT(IOPPTR),86                                 1628
         BNE   @RF01628                                            1628
@RT01628 DS    0H                                                  1629
*             MGPMGNO1=HMA218I;     /* SUCCESSFULLY STORED   @Z67SP00*/
         MVC   MGPMGNO1(2),@CH00450                                1629
*           ELSE                    /*                       @Z67SP00*/
*             MGPMGNO1=HMA224I;     /* SUCCESSFULLY DELETED  @Z67SP00*/
         B     @RC01628                                            1630
@RF01628 MVC   MGPMGNO1(2),@CH00461                                1630
*           CALL MEMMSG;            /*                       @Z67SP00*/
@RC01628 BAL   @14,MEMMSG                                          1631
*         END;                      /*                       @Z67SP00*/
*     END;                          /*                       @ZD00003*/
*   END STOW;                       /*                       @Z40SP00*/
@EL00009 L     @13,4(,@13)                                         1634
@EF00009 DS    0H                                                  1634
@ER00009 LM    @14,@12,12(@13)                                     1634
         BR    @14                                                 1634
         EJECT
*GET:                                                              1635
*   PROCEDURE OPTIONS(SAVEAREA);                                   1635
*                                                                  1635
GET      STM   @14,@12,12(@13)                                     1635
         ST    @13,@SA00010+4                                      1635
         LA    @14,@SA00010                                        1635
         ST    @14,8(,@13)                                         1635
         LR    @13,@14                                             1635
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE HANDLES QSAM GETS. THE DCB IS GOTTEN FROM DCBPTR */
*   /* AND THE AREA ADDRESS IS IN IOPBUFAD.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1636
*   IOPRETRN=IOPGOOD;               /* INDICATE SUCCESSFUL GET OP    */
         MVI   IOPRETRN(IOPPTR),X'00'                              1636
*   DCBEODA=ADDR(GETEOD);           /* DUMP EODAD ADDR TO DCB        */
         LA    @11,GETEOD                                          1637
         STCM  @11,7,DCBEODA+28(DCBPTR)                            1637
*   RFY                                                            1638
*     IOPREG RSTD;                  /* REMOVE REG FROM USE   @Z40SP00*/
*   IOPREG=IOPBUFAD;                /* GET BUFFER ADDR TO REGISTER   */
         L     IOPREG,IOPBUFAD(,IOPPTR)                            1639
*   GENERATE CODE FLOWS(GETEOD,QSAMERR) REFS(DCBPTR,IOPREG);       1640
         GET   (DCBPTR),(IOPREG)       GET THE RECORD TO BUFFER
*   RFY                                                            1641
*     IOPREG UNRSTD;                /* RETURN REG FOR USE    @Z40SP00*/
*   RETURN;                         /* RETURN TO REQUESTOR           */
@EL00010 L     @13,4(,@13)                                         1642
@EF00010 DS    0H                                                  1642
@ER00010 LM    @14,@12,12(@13)                                     1642
         BR    @14                                                 1642
*GETEOD:                                                           1643
*   IOPRETRN=IOPEOF;                /* INDICATE END OF FILE  @YA07506*/
GETEOD   MVI   IOPRETRN(IOPPTR),X'04'                              1643
*   END GET;                        /* EXIT TO REQUESTOR             */
         B     @EL00010                                            1644
         EJECT
*PUT:                               /*                               */
*   PROCEDURE OPTIONS(SAVEAREA);                                   1645
*                                                                  1645
PUT      STM   @14,@12,12(@13)                                     1645
         ST    @13,@SA00011+4                                      1645
         LA    @14,@SA00011                                        1645
         ST    @14,8(,@13)                                         1645
         LR    @13,@14                                             1645
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS ENTERED TO PREFORM QSAM PUTS                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1646
*   IOPRETRN=IOPGOOD;               /* SET SMP RTN           @YA07506*/
         MVI   IOPRETRN(IOPPTR),X'00'                              1646
*   RFY                                                            1647
*     IOPREG RSTD;                  /* REMOVE REG FROM USE   @Z40SP00*/
*   IOPREG=IOPBUFAD;                /* PUT BUFFER ADDR IN REG        */
         L     IOPREG,IOPBUFAD(,IOPPTR)                            1648
*   GENERATE REFS(DCBPTR,IOPREG) FLOWS(QSAMERR);                   1649
         PUT  (DCBPTR),(IOPREG)
*   RFY                                                            1650
*     IOPREG UNRSTD;                /* RETURN REG TO USE     @Z40SP00*/
*   END PUT;                                                       1651
@EL00011 L     @13,4(,@13)                                         1651
@EF00011 DS    0H                                                  1651
@ER00011 LM    @14,@12,12(@13)                                     1651
         BR    @14                                                 1651
         EJECT
*BLDL:                                                             1652
*   PROCEDURE OPTIONS(SAVEAREA);                                   1652
*                                                                  1652
BLDL     STM   @14,@12,12(@13)                                     1652
         ST    @13,@SA00012+4                                      1652
         LA    @14,@SA00012                                        1652
         ST    @14,8(,@13)                                         1652
         LR    @13,@14                                             1652
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS USED TO LOCATE MEMBERS IN A PDS. A BLDL PARM  */
*   /* LIST IS CONSTRUCTED FROM INFORMATION IN THE IOP. THE USER DATA*/
*   /* AND TTR ARE DUMPED INTO THE IOP AFTER THE OPERATION IS        */
*   /* COMPLETED SUCCESSFULLY.                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1653
*   DECLARE                                                        1653
*     1 BLDLLIST,                   /* PARM LIST FOR BLDL OPERATION  */
*      2 * FIXED(15) INIT(1),       /* NUMBER OF ENTRIES             */
*      2 * FIXED(15) INIT(76),      /* LENGTH OF EACH ENTRY          */
*      2 BLDLNAME CHAR(8),          /* NAME FOR THE BLDL             */
*      2 BLDLTTR PTR(24) BDY(BYTE), /* TTR FROM BLDL                 */
*      2 * CHAR(1),                 /* UNUSED                        */
*      2 * CHAR(1),                 /* UNUSED                        */
*      2 BLDLUSRL PTR(8),           /* LENGTH OF USER DATA           */
*       3 BLDLALIS BIT(1),          /* ENTRY IS ALIAS        @Z40SP00*/
*       3 BLDLTTRC BIT(2),          /* NUMBR OF TTRS         @Z40SP00*/
*       3 * BIT(5),                 /* ACTUAL USER DATA LEN  @Z40SP00*/
*      2 BLDLUSER CHAR(62);         /* USER DATA                     */
*   IF DISISW=ON                    /* IF DIRECTORY IS IN    @Z67SP00*/
*     THEN                          /* STORAGE THEN          @ZD00003*/
         TM    DISISW,B'00010000'                                  1654
         BNO   @RF01654                                            1654
*     CALL HMASMEIS(HMASMIOP);      /* CALL EIS              @ZD00003*/
         ST    IOPPTR,@AL00001                                     1655
         L     @15,@CV03343                                        1655
         LA    @01,@AL00001                                        1655
         BALR  @14,@15                                             1655
*   ELSE                            /* IF NOT IN STORAGE     @ZD00003*/
*     DO;                           /*                       @ZD00003*/
         B     @RC01654                                            1656
@RF01654 DS    0H                                                  1657
*       BLDLNAME=IOPINAM;           /* PUT NAME IN LIST      @ZD00008*/
         MVC   BLDLNAME(8),IOPINAM(IOPPTR)                         1657
*       GENERATE REFS(DCBPTR,BLDLLIST);                            1658
         BLDL  (DCBPTR),BLDLLIST      LOCATE THE MEMBER
*       RFY                                                        1659
*         RTNCODE RSTD;             /*                       @ZD00001*/
*       IOPRETRN=RTNCODE;           /* PUT RETURN CODE IN THE IOP    */
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1660
*       RFY                                                        1661
*         RTNCODE UNRSTD;           /*                       @ZD00001*/
*       IF IOPRETRN^=IOPGOOD        /* IS ENTRY LOCATED?     @YA07506*/
*         THEN                      /* NO - SET ERROR CODE           */
         CLI   IOPRETRN(IOPPTR),0                                  1662
         BE    @RF01662                                            1662
*         DO;                                                      1663
*           IOPTTR=ZERO;            /* ZERO THE TTR                  */
         SLR   @11,@11                                             1664
         STCM  @11,7,IOPTTR(IOPPTR)                                1664
*           IF IOPRETRN>IOPNTFND    /* I/O ERROR?            @Z40SP00*/
*             THEN                  /* YES - INDICATE ERROR          */
         CLI   IOPRETRN(IOPPTR),4                                  1665
         BNH   @RF01665                                            1665
*             DO;                   /*                       @Z40SP00*/
*               IOPRETRN=IOPIOERR;  /* SET RC TO I/O ERR     @YA07506*/
         MVI   IOPRETRN(IOPPTR),X'10'                              1667
*               MGPTYPE=MGPTERM;    /* SET MESSAGE SEVERITY  @ZD00001*/
         MVI   MGPTYPE,X'05'                                       1668
*               MGPMGNO1=HMA269I;   /* I/O ERROR ATTEMPTING TO BLDL  */
         MVC   MGPMGNO1(2),@CH01035                                1669
*               CALL MEMMSG;        /* WRITE MEMBER ERROR MESSAGE    */
         BAL   @14,MEMMSG                                          1670
*             END;                                                 1671
*         END;                                                     1672
*       ELSE                        /* IF RETURN IS GOOD     @ZD00003*/
*         DO;                       /*                       @ZD00003*/
         B     @RC01662                                            1673
@RF01662 DS    0H                                                  1674
*           IOPTTR=BLDLTTR;         /* PUT TTR IN THE IOP    @VS05281*/
         MVC   IOPTTR(3,IOPPTR),BLDLTTR                            1674
*           IOPUSERL=BLDLUSRL;      /* PUT THE USER DATA LENGTH IN   */
         MVC   IOPUSERL(1,IOPPTR),BLDLUSRL                         1675
*           BLDLALIS=OFF;           /* TURN OFF ALIAS BIT SO THAT THE
*                                      BYTE WILL CONTAIN ACTUAL USER
*                                      DATA LENGTH           @Z40SP00*/
         NI    BLDLALIS,B'01111111'                                1676
*           BLDLTTRC=OFF;           /* SAME FOR TTRC FIELD   @Z40SP00*/
         NI    BLDLTTRC,B'10011111'                                1677
*           IF BLDLUSRL>ZERO        /* IS THERE USER DATA?   @Z40SP00*/
*             THEN                  /* YES - MOVE TO REQUESTOR AREA  */
         CLI   BLDLUSRL,0                                          1678
         BNH   @RF01678                                            1678
*             IOPUDATA(1:(2*BLDLUSRL))=BLDLUSER;/* MOVE USRDTA     1679
*                                                            @ZD00003*/
         SLR   @11,@11                                             1679
         IC    @11,BLDLUSRL                                        1679
         ALR   @11,@11                                             1679
         BCTR  @11,0                                               1679
         EX    @11,@SM04259                                        1679
*         END;                      /* END RTN IS ZERO       @ZD00003*/
*     END;                          /* END DIR NOT IN STORE  @ZD00003*/
*   END BLDL;                       /* EXIT TO REQUESTOR             */
@EL00012 L     @13,4(,@13)                                         1682
@EF00012 DS    0H                                                  1682
@ER00012 LM    @14,@12,12(@13)                                     1682
         BR    @14                                                 1682
         EJECT
*EOFSTR:                                                           1683
*   PROCEDURE OPTIONS(SAVEAREA);                                   1683
*                                                                  1683
EOFSTR   STM   @14,@12,12(@13)                                     1683
         ST    @13,@SA00013+4                                      1683
         LA    @14,@SA00013                                        1683
         ST    @14,8(,@13)                                         1683
         LR    @13,@14                                             1683
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE IS INVOKED TO STORE THE EOF RECORD, IF NOT    */
*   /* ALREADY IN THE CDS. IF PRESENT, THE TTR OF THE EOF MEMBER IS  */
*   /* PLACED IN THE CURRENT MEMBER WHICH IS TO BE STORED AS AN ALIAS*/
*   /* OF THE EOF MEMBER.                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1684
*   DECLARE                         /*                       @Z40SP00*/
*     EOFFNCSV FIXED(8),            /* TO SAVE IOPFUNCT      @ZA13037*/
*     EOFTYPSV FIXED(8),            /* TO SAVE IOPTYPET      @Z67SP00*/
*     EOFNMSV CHAR(8),              /* TO SAVE IOPNAME       @Z67SP00*/
*     EOFINMSV CHAR(8),             /* TO SAVE IOPINAM       @Z67SP00*/
*     EOFLSV FIXED(8),              /* TO SAVE IOPUSERL      @Z40SP00*/
*     EOFDATSV CHAR(LENGTH(IOPDIRCT));/* TO SAVE USER DATA   @Z40SP00*/
*   DECLARE                         /*                       @Z67SP00*/
*     SAVBFMX FIXED(15);            /*                       @Z67SP00*/
*   SAVBFMX=DSBFRMX;                /* THESE HERE TO PREVENT @Z67SP00*/
         LH    @11,DSBFRMX                                         1686
         STH   @11,SAVBFMX                                         1686
*   DSBFRMX=SAVBFMX;                /* COMPILERE ERR MSG     @Z67SP00*/
         STH   @11,DSBFRMX                                         1687
*   EOFFNCSV=IOPFUNCT;              /* SAVE IOPFUNCT ACROSS EOF    1688
*                                      MEMBER STOW           @ZD00003*/
         MVC   EOFFNCSV(1),IOPFUNCT(IOPPTR)                        1688
*   EOFTYPSV=IOPTYPE;               /* SAVE TYPE MEMBER      @Z67SP00*/
         MVC   EOFTYPSV(1),IOPTYPE(IOPPTR)                         1689
*   EOFNMSV=IOPNAME;                /* SAVE MEMBER NAME      @Z67SP00*/
         MVC   EOFNMSV(8),IOPNAME(IOPPTR)                          1690
*   EOFINMSV=IOPINAM;               /* SAVE MEMBER NAME      @Z67SP00*/
         MVC   EOFINMSV(8),IOPINAM(IOPPTR)                         1691
*   EOFLSV=IOPUSERL;                /* SAVE USER DATA LENGTH @Z40SP00*/
         MVC   EOFLSV(1),IOPUSERL(IOPPTR)                          1692
*   EOFDATSV=IOPDIRCT;              /* SAVE USER DATA        @Z40SP00*/
         MVC   EOFDATSV(24),IOPDIRCT(IOPPTR)                       1693
*EOFBLDL:                                                          1694
*   IOPFUNCT=IOPNCODE;              /* ENCODE OPERATION      @Z67SP00*/
EOFBLDL  MVI   IOPFUNCT(IOPPTR),X'10'                              1694
*   IOPTYPE=IOPDND;                 /* EOF MEMBER            @Z67SP00*/
         MVI   IOPTYPE(IOPPTR),X'0A'                               1695
*   CALL HMASMION(HMASMIOP);        /* ENCODE EOF MEMBER NAM @Z67SP00*/
         ST    IOPPTR,@AL00001                                     1696
         L     @15,@CV03344                                        1696
         LA    @01,@AL00001                                        1696
         BALR  @14,@15                                             1696
*   IOPFUNCT=IOPBLDL;               /* SET TO BLDL           @ZD00003*/
         MVI   IOPFUNCT(IOPPTR),X'04'                              1697
*   CALL BLDL;                      /* LOCATE EOF MEMBER IN THE CDS  */
         BAL   @14,BLDL                                            1698
*   IF IOPRETRN=IOPNTFND            /* MEMBER NOT THERE      @YA07506*/
*     THEN                          /* MUST CREATE MEMBER            */
         CLI   IOPRETRN(IOPPTR),4                                  1699
         BNE   @RF01699                                            1699
*     DO;                           /* STOW AN EOF MEMBER            */
*       IOPFUNCT=IOPSTOWR;          /*                       @ZA13037*/
         MVI   IOPFUNCT(IOPPTR),X'54'                              1701
*       IOPUSERL=ZERO;              /* INDICATE ZERO USER DATA       */
         MVI   IOPUSERL(IOPPTR),X'00'                              1702
*       CALL STOW;                  /* STOW EOF MEMBER IN THE CDS    */
         BAL   @14,STOW                                            1703
*       IF IOPRETRN=IOPGOOD         /* STOW SUCCESSFUL?      @ZD00003*/
*         THEN                      /* NO - CANNOT CONTINUE          */
         CLI   IOPRETRN(IOPPTR),0                                  1704
         BE    @RT01704                                            1704
*         GO TO EOFBLDL;            /* GO BACK AND GET THE TTR       */
*     END;                                                         1706
*   IOPNAME=EOFNMSV;                /* RESTORE MEMBER NAME   @Z67SP00*/
@RF01699 MVC   IOPNAME(8,IOPPTR),EOFNMSV                           1707
*   IOPTYPE=EOFTYPSV;               /* RESTORE TYPE          @Z67SP00*/
         MVC   IOPTYPE(1,IOPPTR),EOFTYPSV                          1708
*   IOPFUNCT=EOFFNCSV;              /* RESTORE FUNCTION      @ZD00003*/
         MVC   IOPFUNCT(1,IOPPTR),EOFFNCSV                         1709
*   IOPINAM=EOFINMSV;               /* RESTORE MEMBER NAME   @Z67SP00*/
         MVC   IOPINAM(8,IOPPTR),EOFINMSV                          1710
*   IOPDIRCT=EOFDATSV;              /* RESTORE USER DATA     @Z40SP00*/
         MVC   IOPDIRCT(24,IOPPTR),EOFDATSV                        1711
*   IOPUSERL=EOFLSV;                /* RESTORE DATA LENGTH   @Z40SP00*/
         MVC   IOPUSERL(1,IOPPTR),EOFLSV                           1712
*   IF IOPRETRN=IOPGOOD             /* EOF MEMBER FOUND OK?  @ZD00003*/
*     THEN                          /* YES - THEN            @ZD00003*/
         CLI   IOPRETRN(IOPPTR),0                                  1713
         BNE   @RF01713                                            1713
*     EOFTTR=IOPTTR;                /* SAVE TTR OF EOF MEMBER        */
         L     @11,PDSADDR                                         1714
         MVC   EOFTTR(3,@11),IOPTTR(IOPPTR)                        1714
*   END EOFSTR;                                                    1715
@EL00013 L     @13,4(,@13)                                         1715
@EF00013 DS    0H                                                  1715
@ER00013 LM    @14,@12,12(@13)                                     1715
         BR    @14                                                 1715
         EJECT
*                                                                  1716
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO INTERFACE WITH SEQUENTIAL DIRETORY READ    @ZD00008*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1716
*IORDS:                             /*                       @ZD00008*/
*   PROCEDURE;                      /*                       @ZD00008*/
IORDS    STM   @14,@12,@SA00014                                    1716
*   HMASMRDP=HMASMRDP&&HMASMRDP;    /* CLEAR RDS PARM        @ZD00008*/
         XC    HMASMRDP(26),HMASMRDP                               1717
*   IF IOPFUNCT=IOPGETN             /* MOVE IOP FUNCT TO RDP @XA16640*/
*     THEN                          /*                       @XA16640*/
         CLI   IOPFUNCT(IOPPTR),10                                 1718
         BNE   @RF01718                                            1718
*     RDPFUNCT=RDPGETN;             /*                       @XA16640*/
         MVI   RDPFUNCT,X'01'                                      1719
*   ELSE                            /*                       @XA16640*/
*     IF IOPFUNCT=IOPGETNC          /*                       @XA16640*/
*       THEN                        /*                       @XA16640*/
         B     @RC01718                                            1720
@RF01718 CLI   IOPFUNCT(IOPPTR),11                                 1720
         BNE   @RF01720                                            1720
*       RDPFUNCT=RDPGETNC;          /*                       @XA16640*/
         MVI   RDPFUNCT,X'02'                                      1721
*     ELSE                          /*                       @XA16640*/
*       RDPFUNCT=RDPCLOSE;          /*                       @ZD00008*/
         B     @RC01720                                            1722
@RF01720 MVI   RDPFUNCT,X'03'                                      1722
*   RDPDSID=IOPDSID;                /* PASS DATASET ID       @Z67SP00*/
@RC01720 DS    0H                                                  1723
@RC01718 MVC   RDPDSID(1),IOPDSID(IOPPTR)                          1723
*   RDPBUFAD=ADDR(IOPDRMAP);        /* RETURN AREA           @ZD00008*/
         LA    @11,IOPDRMAP(,IOPPTR)                               1724
         ST    @11,RDPBUFAD                                        1724
*   CALL HMASMRDS(HMASMRDP);        /* GET ENTRY             @ZD00008*/
         L     @15,@CV03347                                        1725
         LA    @01,@AL01725                                        1725
         BALR  @14,@15                                             1725
*   IOPRETRN=RDPRETRN;              /* MOVE RETURN TO IOP    @ZD00008*/
         MVC   IOPRETRN(1,IOPPTR),RDPRETRN                         1726
*   IF RDPRETRN=RDPEOF              /* IF END OF FILE        @ZD00008*/
*       &IOPFUNCT=IOPGETNC          /* AND COUNT REQUESTED   @ZD00008*/
*     THEN                          /*                       @ZD00008*/
         CLI   RDPRETRN,4                                          1727
         BNE   @RF01727                                            1727
         CLI   IOPFUNCT(IOPPTR),11                                 1727
         BNE   @RF01727                                            1727
*     DO;                           /*                       @ZD00008*/
*       IOPALLOC=RDPALLOC;          /* MOVE BLK ALLOCATED    @ZD00008*/
         MVC   IOPALLOC(4,IOPPTR),RDPALLOC                         1729
*       IOPUSED=RDPUSED;            /* MOVE BLK USED         @ZD00008*/
         MVC   IOPUSED(4,IOPPTR),RDPUSED                           1730
*     END;                          /*                       @ZD00008*/
*   IF RDPRETRN=RDPGOOD             /* IF MEMBER RETRIEVED   @ZD00008*/
*       &(IOPFUNCT=IOPGETN          /* AND GETN OR GETNC     @ZD00008*/
*       ×IOPFUNCT=IOPGETNC)         /*                       @ZD00008*/
*     THEN                          /*                       @ZD00008*/
@RF01727 CLI   RDPRETRN,0                                          1732
         BNE   @RF01732                                            1732
         CLI   IOPFUNCT(IOPPTR),10                                 1732
         BE    @RT01732                                            1732
         CLI   IOPFUNCT(IOPPTR),11                                 1732
         BNE   @RF01732                                            1732
@RT01732 DS    0H                                                  1733
*     CALL HMASMION(HMASMIOP);      /* CALL ION TO SET IOPNAME AND 1733
*                                      IOPTYPE               @ZD00008*/
         ST    IOPPTR,@AL00001                                     1733
         L     @15,@CV03344                                        1733
         LA    @01,@AL00001                                        1733
         BALR  @14,@15                                             1733
*   END IORDS;                      /*                       @ZD00008*/
@EL00014 DS    0H                                                  1734
@EF00014 DS    0H                                                  1734
@ER00014 LM    @14,@12,@SA00014                                    1734
         BR    @14                                                 1734
         EJECT
*                                                                  1735
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ARE SYNAD EXITS FOR THE VARIOUS ACCESS METHODS  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1735
*   RFY                                                            1735
*    (R0,                                                          1735
*     R1) RSTD;                     /* REMOVE REG FROM USE   @Z40SP00*/
*QSAMERR:                                                          1736
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @YA12120*/
QSAMERR  DS    0H                                                  1737
*   DECLARE                         /*                       @Z40SP00*/
*     ERRENTCT FIXED(8) INIT(0);    /* ENTRY COUNT FOR SYNAD @YA12120*/
*   DECLARE                                                        1738
*     ERRSAVE1 CHAR(64) BDY(WORD);  /* SAVE AREA FOR ALL REG @YA12120*/
*   DECLARE                         /*                       @Z40SP00*/
*     ERRSAVE2(3) CHAR(64) BDY(WORD);/* SAVE AREA FOR REGS FOR     1739
*                                      MULTIPLE REENTRIES - COULD BE
*                                      SYSPRINT THEN SMPOUT THEN   1739
*                                      SMPLOG                @Z40SP00*/
*   DECLARE                         /*                       @Z40SP00*/
*     SYNDISP FIXED(8) CONSTANT(49);/* JOBNAME OFFSET        @Z40SP00*/
*   DECLARE                                                        1741
*     SYNJOBN CHAR(1) BASED(R1+SYNDISP);/* JOBNAME IN SYNAD MSG      */
*                                                                  1741
*   /*****************************************************************/
*   /*                                                               */
*   /* QSAM ERROR HAS OCCURRED                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1742
*   STM(R0,RTNCODE,ERRSAVE1);       /* SAVE ALL REGS ACROSS SYNAD. 1742
*                                      SAVE AREA IS NOT PROVIDED BY
*                                      CALLER THUS OWN MUST BE     1742
*                                      PROVIDED              @YA12120*/
         STM   R0,RTNCODE,ERRSAVE1                                 1742
*   GEN(SYNADAF ACSMETH=QSAM);      /* ISSUE SYNADAF FOR MESSAGE     */
         SYNADAF ACSMETH=QSAM
*   GO TO SYNMSG;                   /* GO WRITE OUT MSG      @Z40SP00*/
*                                                                  1744
         B     SYNMSG                                              1744
*   /*****************************************************************/
*   /*                                                               */
*   /* BSAM I/O ERROR OCCURRED                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1745
*BSAMERR:                                                          1745
*   ENTRY;                                                         1745
BSAMERR  DS    0H                                                  1746
*   STM(R0,RTNCODE,ERRSAVE1);       /* SAVE ALL REGS ACROSS SYNAD. 1746
*                                      SAVE AREA IS NOT PROVIDED BY
*                                      CALLER THUS OWN MUST BE     1746
*                                      PROVIDED              @YA12120*/
         STM   R0,RTNCODE,ERRSAVE1                                 1746
*   GEN(SYNADAF ACSMETH=BSAM);      /* GET SYNAD MESSAGE             */
         SYNADAF ACSMETH=BSAM
*   GO TO SYNMSG;                   /* GO PRINT MESSAGE              */
*                                                                  1748
         B     SYNMSG                                              1748
*   /*****************************************************************/
*   /*                                                               */
*   /* BPAM I/O ERROR OCCURRED                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1749
*BPAMERR:                                                          1749
*   ENTRY;                          /*                       @Z40SP00*/
BPAMERR  DS    0H                                                  1750
*   STM(R0,RTNCODE,ERRSAVE1);       /* SAVE ALL REGS ACROSS SYNAD. 1750
*                                      SAVE AREA IS NOT PROVIDED BY
*                                      CALLER THUS OWN MUST BE     1750
*                                      PROVIDED              @YA12120*/
         STM   R0,RTNCODE,ERRSAVE1                                 1750
*   GEN(SYNADAF ACSMETH=BPAM);      /* GET SYNAD MESSAGE             */
         SYNADAF ACSMETH=BPAM
*   GO TO SYNMSG;                   /* GO PRINT MESSAGE              */
         B     SYNMSG                                              1752
*                                                                  1753
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON ROUTINE TO PUT OUT I/O ERROR MSG               @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1753
*SYNMSG:                                                           1753
*   ERRENTCT=ERRENTCT+1;            /* UPDATE ENTRY COUNT    @YA12120*/
SYNMSG   SLR   @11,@11                                             1753
         IC    @11,ERRENTCT                                        1753
         LA    @11,1(,@11)                                         1753
         STC   @11,ERRENTCT                                        1753
*   ERRSAVE2(ERRENTCT)=ERRSAVE1;    /* MOVE SAVED REGS TO SAVE ARRAY
*                                      IN CASE REENTRY       @YA12120*/
         SLA   @11,6                                               1754
         LA    @04,ERRSAVE2-64(@11)                                1754
         MVC   0(64,@04),ERRSAVE1                                  1754
*   MGPVARPT(1)=ADDR(SYNJOBN);      /* POINT TO JOBNAME IN MESSAGE   */
         LA    @11,49                                              1755
         ALR   @11,R1                                              1755
         ST    @11,MGPVARPT                                        1755
*   RFY                                                            1756
*    (R0,                                                          1756
*     R1) UNRSTD;                   /*                       @Z40SP00*/
*   MGPMGNO1=HMA274I;               /* INDICATE I/O ERROR MESSAGE    */
         MVC   MGPMGNO1(2),@CH03320                                1757
*   MGPMGNO2=PART027;               /* INDICATE SYNAD SECONDARY      */
         MVC   MGPMGNO2(2),@CH00465                                1758
*   MGPMGNO3=ZERO;                  /* NO TERTIARY                   */
         SLR   @11,@11                                             1759
         STH   @11,MGPMGNO3                                        1759
*   IF IOPDSID=IOPSYSPT             /* SYSPRINT DATA SET     @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
         CLI   IOPDSID(IOPPTR),20                                  1760
         BNE   @RF01760                                            1760
*     SYSPDEAD=ON;                  /* SET SYSPRINT DEAD     @Z40SP00*/
         OI    SYSPDEAD,B'10000000'                                1761
*   ELSE                            /*                       @Z40SP00*/
*     IF IOPDSID=IOPPRINT           /* IS IT THE PRINTER             */
*       THEN                        /* YES - SET PRINT OFF           */
         B     @RC01760                                            1762
@RF01760 CLI   IOPDSID(IOPPTR),11                                  1762
         BNE   @RF01762                                            1762
*       DO;                         /*                       @Z67SP00*/
*         CCAOUTNG=ON;              /* SET OUT NO GOOD       @Z67SP00*/
         L     @11,@CA00038                                        1764
         OI    CCAOUTNG-HMASMCCA(@11),B'01000000'                  1764
*         CCATERM=ON;               /* STOP SMP AT DRV       @Z67SP00*/
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   1765
*       END;                        /*                       @Z67SP00*/
*     ELSE                          /* OTHERWISE - CHECK FOR HISTLOG */
*       IF IOPDSID=IOPHLDS          /* IS IT THE LOG?                */
*         THEN                      /* YES - SET LOG DEAD            */
         B     @RC01762                                            1767
@RF01762 CLI   IOPDSID(IOPPTR),1                                   1767
         BNE   @RF01767                                            1767
*         DO;                       /*                       @Z67SP00*/
*           CCALOGNG=ON;            /* SET LOG DEAD          @Z67SP00*/
         L     @11,@CA00038                                        1769
         OI    CCALOGNG-HMASMCCA(@11),B'10000000'                  1769
*           CCATERM=ON;             /* STOP SMP AT DRV       @Z67SP00*/
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   1770
*         END;                      /*                       @Z67SP00*/
*   MGPTYPE=MGPTERM;                /* SET MESSAGE SEVERITY  @ZD00001*/
@RF01767 DS    0H                                                  1772
@RC01762 DS    0H                                                  1772
@RC01760 MVI   MGPTYPE,X'05'                                       1772
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MESSAGE                 */
         L     @15,@CV03346                                        1773
         LA    @01,@AL01773                                        1773
         BALR  @14,@15                                             1773
*   IOPRETRN=IOPIOERR;              /* INDICATE I/O ERROR FOUND      */
         MVI   IOPRETRN(IOPPTR),X'10'                              1774
*   GEN(SYNADRLS);                  /* RELEASE SYNAD WORK AREA       */
         SYNADRLS
*   ERRSAVE1=ERRSAVE2(ERRENTCT);    /* MOVE REGS TO LM AREA  @YA12120*/
         SLR   @11,@11                                             1776
         IC    @11,ERRENTCT                                        1776
         LR    @04,@11                                             1776
         SLA   @04,6                                               1776
         LA    @03,ERRSAVE2-64(@04)                                1776
         MVC   ERRSAVE1(64),0(@03)                                 1776
*   ERRENTCT=ERRENTCT-1;            /* DECR ENTRY COUNT      @YA12120*/
         BCTR  @11,0                                               1777
         STC   @11,ERRENTCT                                        1777
*   LM(R0,RTNCODE,ERRSAVE1);        /* RESTORE REGS          @YA12120*/
         LM    R0,RTNCODE,ERRSAVE1                                 1778
*   RFY                                                            1779
*     RTNREG UNRSTD;                                               1779
*   END QSAMERR;                    /* RETURN AND CONTINUE           */
@EL00015 DS    0H                                                  1780
@EF00015 DS    0H                                                  1780
@ER00015 BR    @14                                                 1780
         EJECT
*                                                                  1781
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE IS INVOKED TO PRINT STOW/BLDL MESSAGES  */
*   /* MESSAGE TYPE HAS ALREADY BEEN SET UP BY CALLER        @ZD00001*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1781
*MEMMSG:                                                           1781
*   PROCEDURE OPTIONS(SAVEAREA);                                   1781
MEMMSG   STM   @14,@12,12(@13)                                     1781
         ST    @13,@SA00016+4                                      1781
         LA    @14,@SA00016                                        1781
         ST    @14,8(,@13)                                         1781
         LR    @13,@14                                             1781
*   MGPMGNO2=PART031;               /* XXXXXXXX XXXXXXXX     @Z67SP00*/
         MVC   MGPMGNO2(2),@CH00043                                1782
*   MGPMGNO3=PART016;               /* ON XXXXXXXX LIBRARY   @Z67SP00*/
         MVC   MGPMGNO3(2),@CH00188                                1783
*   MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE MEMBER       @Z67SP00*/
         SLR   @11,@11                                             1784
         IC    @11,IOPTYPE(,IOPPTR)                                1784
         SLA   @11,3                                               1784
         L     @04,@CA00038                                        1784
         L     @03,CCATPAD-HMASMCCA(,@04)                          1784
         AL    @03,@CF04239                                        1784
         LA    @11,CCATYPEA(@11,@03)                               1784
         ST    @11,MGPVARPT                                        1784
*   MGPVARPT(2)=ADDR(MEMNAME);      /* SET VARIABLE PTR TO MEMBER NM */
         LA    @11,MEMNAME                                         1785
         ST    @11,MGPVARPT+4                                      1785
*   MGPVARPT(3)=ADDR(CCADSIDA(IOPDSID));/* SET DD NAME       @Z67SP00*/
         SLR   @11,@11                                             1786
         IC    @11,IOPDSID(,IOPPTR)                                1786
         SLA   @11,3                                               1786
         L     @04,CCADSAD-HMASMCCA(,@04)                          1786
         AL    @04,@CF04239                                        1786
         LA    @11,CCADSIDA(@11,@04)                               1786
         ST    @11,MGPVARPT+8                                      1786
*   IF IOPFUNCT=IOPSTOWC            /* IF STOW CHANGE        @SA76001*/
*     THEN                          /* THEN NAME IN MSG IS   @SA76001*/
         CLI   IOPFUNCT(IOPPTR),82                                 1787
         BNE   @RF01787                                            1787
*     MEMNAME=IOPNNAME;             /* NEW NAME              @ZD00008*/
         MVC   MEMNAME(8),IOPNNAME(IOPPTR)                         1788
*   ELSE                            /* IF NOT STOW CHANGE    @Z40SP00*/
*     MEMNAME=IOPNAME;              /* MOVE NAME TO MSG AREA @Z40SP00*/
         B     @RC01787                                            1789
@RF01787 MVC   MEMNAME(8),IOPNAME(IOPPTR)                          1789
*   CALL HMASMMSG(HMASMMGP);        /* ISSUE MESSAGE                 */
@RC01787 L     @15,@CV03346                                        1790
         LA    @01,@AL01790                                        1790
         BALR  @14,@15                                             1790
*   END MEMMSG;                     /* RETURN                        */
@EL00016 L     @13,4(,@13)                                         1791
@EF00016 DS    0H                                                  1791
@ER00016 LM    @14,@12,12(@13)                                     1791
         BR    @14                                                 1791
         EJECT
*                                                                  1792
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO PRINT DD MISSING MESSAGE            @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1792
*NODDMSG:                           /*                       @Z40SP00*/
*   MGPMGNO1=HMA283I;               /* ****ERROR**** XXXXXXXX DDCARD
*                                      MISSING               @Z40SP00*/
NODDMSG  MVC   MGPMGNO1(2),@CH00520                                1792
*   MGPVARPT(1)=ADDR(CCADSIDA(IOPDSID));/* DD NAME           @Z40SP00*/
         SLR   @11,@11                                             1793
         IC    @11,IOPDSID(,IOPPTR)                                1793
         SLA   @11,3                                               1793
         L     @04,@CA00038                                        1793
         L     @04,CCADSAD-HMASMCCA(,@04)                          1793
         AL    @04,@CF04239                                        1793
         LA    @11,CCADSIDA(@11,@04)                               1793
         ST    @11,MGPVARPT                                        1793
*   GO TO WTERRMSG;                 /*                       @Z40SP00*/
*                                                                  1794
         B     WTERRMSG                                            1794
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINES ENTERED TO WRITE OUT OPEN/CLOSE FAIL MSG AND SET     */
*   /* RETURN CODES                                          @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1795
*CLOSFAIL:                          /*                       @Z40SP00*/
*   MGPVARPT(1)=ADDR(TXTCLOSE);     /* CLOSE                 @Z40SP00*/
CLOSFAIL LA    @11,@CC03331                                        1795
         ST    @11,MGPVARPT                                        1795
*   GO TO OPENCLOS;                 /* GO WRITE MSG          @Z40SP00*/
         B     OPENCLOS                                            1796
*OPENFAIL:                          /*                       @Z40SP00*/
*   MGPVARPT(1)=ADDR(TXTOPEN);      /* OPEN                  @Z40SP00*/
OPENFAIL LA    @11,@CC03333                                        1797
         ST    @11,MGPVARPT                                        1797
*OPENCLOS:                          /*                       @Z40SP00*/
*   MGPMGNO1=HMA201I;               /* XXX FAILED FOR XXXX   @Z40SP00*/
OPENCLOS MVC   MGPMGNO1(2),@CH00183                                1798
*   MGPVARPT(2)=ADDR(CCADSIDA(IOPDSID));/* DD NAME           @Z40SP00*/
         SLR   @11,@11                                             1799
         IC    @11,IOPDSID(,IOPPTR)                                1799
         SLA   @11,3                                               1799
         L     @04,@CA00038                                        1799
         L     @04,CCADSAD-HMASMCCA(,@04)                          1799
         AL    @04,@CF04239                                        1799
         LA    @11,CCADSIDA(@11,@04)                               1799
         ST    @11,MGPVARPT+4                                      1799
*WTERRMSG:                          /*                       @Z40SP00*/
*   IF IOPDSID=IOPHLDS              /* OPEN/CLOSE FOR LOG    @Z40SP00*/
*     THEN                          /* YES - THEN NO ERR     @Z40SP00*/
WTERRMSG CLI   IOPDSID(IOPPTR),1                                   1800
         BNE   @RF01800                                            1800
*     DO;                           /*                       @Z67SP00*/
*       CCALOGNG=ON;                /* LOG UNUSEABLE         @Z67SP00*/
         L     @11,@CA00038                                        1802
         OI    CCALOGNG-HMASMCCA(@11),B'10000000'                  1802
*       CCATERM=ON;                 /* STOP SMP AT DRV       @Z67SP00*/
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   1803
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /* NOT LOG OPEN/CLOSE    @Z40SP00*/
*     IF IOPDSID=IOPPRINT           /* WAS IT SMPOUT?        @Z40SP00*/
*       THEN                        /* YES - NO ERR MSG      @Z40SP00*/
         B     @RC01800                                            1805
@RF01800 CLI   IOPDSID(IOPPTR),11                                  1805
         BNE   @RF01805                                            1805
*       DO;                         /*                       @Z67SP00*/
*         CCAOUTNG=ON;              /*                       @Z67SP00*/
         L     @11,@CA00038                                        1807
         OI    CCAOUTNG-HMASMCCA(@11),B'01000000'                  1807
*         CCATERM=ON;               /* STOP SMP AT DRV       @Z67SP00*/
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   1808
*       END;                        /*                       @Z67SP00*/
*   MGPTYPE=MGPSEV;                 /* SET MESSAGE SEVERITY  @ZD00001*/
@RF01805 DS    0H                                                  1810
@RC01800 MVI   MGPTYPE,X'04'                                       1810
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MSG             @Z40SP00*/
         L     @15,@CV03346                                        1811
         LA    @01,@AL01811                                        1811
         BALR  @14,@15                                             1811
*   IOPRETRN=IOPNTOPN;              /* SAME RETURN FOR BOTH  @ZA25875*/
         MVI   IOPRETRN(IOPPTR),X'0C'                              1812
*   IF IOPFUNCT=IOPWRITE            /* IF WRITE              @ZA25875*/
*       &(                          /* AND                   @ZA25875*/
*       (IOPDSID=IOPHLDS            /* IF WRITE TO LOG       @ZA25875*/
*       &CCAOUTNG=OFF)              /* AND PRINTER OK        @ZA25875*/
*       ×                           /* OR                    @ZA25875*/
*       (IOPDSID=IOPPRINT           /* WRITE TO PRINTER      @ZA25875*/
*       &CCALOGNG=OFF)              /* AND LOG OK            @ZA25875*/
*       )                           /*                       @ZA25875*/
*     THEN                          /* THEN                  @ZA25875*/
         CLI   IOPFUNCT(IOPPTR),81                                 1813
         BNE   @RF01813                                            1813
         CLI   IOPDSID(IOPPTR),1                                   1813
         BNE   @GL00132                                            1813
         L     @11,@CA00038                                        1813
         TM    CCAOUTNG-HMASMCCA(@11),B'01000000'                  1813
         BZ    @RT01813                                            1813
@GL00132 CLI   IOPDSID(IOPPTR),11                                  1813
         BNE   @RF01813                                            1813
         L     @11,@CA00038                                        1813
         TM    CCALOGNG-HMASMCCA(@11),B'10000000'                  1813
         BZ    @RT01813                                            1813
*     GO TO IOINIT0;                /* GO TO TOP OF PGM SO THAT MSG
*                                      WILL BE SWITCHED TO ALTERNATE
*                                      DATA SET              @ZA25875*/
*   GO TO EXIT;                     /* GO TO RETURN POINT    @Z40SP00*/
         B     EXIT                                                1815
         EJECT
*                                                                  1816
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON RETURN POINT FROM HMASMIO TO CALLING PROCEDURE.        */
*   /* GOODEXIT SETS RETURN CODE TO COMPLETED SUCCESSFULLY AND EXIT  */
*   /* ASSUMES THAT THE RETURN CODE HAS PREVIOUSLY BEEN SET UP. IF   */
*   /* THIS IS A RE-ENTRY THE GETMAINED SAVE AREA IS FREED AND IN ALL*/
*   /* CASES THE ENTRY COUNT IS DECREMENTED BY ONE.          @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1816
*BADEXIT:                           /*                       @Z67SP00*/
*   IOPRETRN=IOPIOERR;              /*                       @Z67SP00*/
BADEXIT  MVI   IOPRETRN(IOPPTR),X'10'                              1816
*   GO TO EXIT;                     /*                       @Z67SP00*/
         B     EXIT                                                1817
*GOODEXIT:                                                         1818
*   IOPRETRN=IOPGOOD;               /* INDICATE SUCCESS      @YA07506*/
GOODEXIT MVI   IOPRETRN(IOPPTR),X'00'                              1818
*EXIT:                                                             1819
*   IOPDSID=SAVDSID(IOENTCNT);      /* RESET DSID            @ZA25875*/
EXIT     SLR   @11,@11                                             1819
         IC    @11,IOENTCNT                                        1819
         SLR   @04,@04                                             1819
         IC    @04,SAVDSID-1(@11)                                  1819
         STC   @04,IOPDSID(,IOPPTR)                                1819
*   CCACURDS=SAVCCADS(IOENTCNT);    /* RESET LAST DSID       @Z67SP00*/
         L     @04,@CA00038                                        1820
         SLR   @03,@03                                             1820
         IC    @03,SAVCCADS-1(@11)                                 1820
         STC   @03,CCACURDS-HMASMCCA(,@04)                         1820
*   IF IOENTCNT>1                   /* IF RE-ENTRY           @ZA25875*/
*     THEN                          /*                       @ZA25875*/
         CLI   IOENTCNT,1                                          1821
         BNH   @RF01821                                            1821
*     HMASMMGP=SAVMGP(IOENTCNT-1);  /* RESTORE MGP           @ZA25875*/
         MVI   HMASMMGP+12,C' '                                    1822
         MVC   HMASMMGP+13(11),HMASMMGP+12                         1822
         MH    @11,@CH00033                                        1822
         LA    @04,SAVMGP-24(@11)                                  1822
         MVC   HMASMMGP(12),0(@04)                                 1822
*   RFY                                                            1823
*     SVAREAS BASED(R13);           /* IO SAVE AREA          @Z40SP00*/
@RF01821 DS    0H                                                  1824
*   R13=SVBACK;                     /* CHAIN SAVE AREAS BACK         */
         L     R13,SVBACK(,R13)                                    1824
*   IOENTCNT=IOENTCNT-1;            /* DECREMENT ENTRY COUNTER       */
         SLR   @11,@11                                             1825
         IC    @11,IOENTCNT                                        1825
         BCTR  @11,0                                               1825
         STC   @11,IOENTCNT                                        1825
*   END HMASMIO                                                    1826
*                                                                  1826
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */
*/*%INCLUDE SYSLIB  (HMASMRDP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */
*                                                                  1826
*       ;                                                          1826
         B     @EL00001                                            1826
@DATA    DS    0H
@CH00088 DC    H'1'
@CH00235 DC    H'3'
@CH00034 DC    H'10'
@CH00033 DC    H'12'
@CH00067 DC    H'15'
@CH00188 DC    H'16'
@CH00450 DC    H'19'
@CH00355 DC    H'20'
@CH00461 DC    H'25'
@CH00465 DC    H'27'
@CH00043 DC    H'31'
@CH00086 DC    H'32'
@CH00374 DC    H'42'
@CH00384 DC    H'44'
@CH00805 DC    H'60'
@CH01031 DC    H'68'
@CH01033 DC    H'69'
@CH01035 DC    H'70'
@CH00833 DC    H'72'
@CH03320 DC    H'75'
@CH00520 DC    H'84'
@CH03564 DC    H'120'
@CH03323 DC    H'144'
@CH03325 DC    H'204'
@CH04103 DC    H'3200'
@CH03486 DC    H'10000'
@SM04242 MVC   IHADCB(0,@11),IHADCB(@03)
@SC04251 CLC   PRLDATA(0,@11),PRNTDATA
@SM04253 MVC   PRNTDATA(0),PRLDATA(@11)
@SM04259 MVC   IOPUDATA(0,IOPPTR),BLDLUSER
         DS    0F
@AL00419 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00950 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01177 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01229 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01366 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01773 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01790 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01811 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
@AL00780 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00881 DC    A(DIRLEN)               LIST WITH   2 ARGUMENT(S)
         DC    A(XTNDLEN)
@AL01725 DC    A(HMASMRDP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@PC00001 DS    1F
@SA00010 DS    18F
@SA00013 DS    18F
@SA00009 DS    18F
@SA00008 DS    18F
@PC00008 DS    1F
@SA00005 DS    18F
@SA00007 DS    18F
@SA00012 DS    18F
@SA00011 DS    18F
@SA00016 DS    18F
@SA00014 DS    0F
@SA00003 DS    0F
         DS    15F
@AL00001 DS    3A
@TF00001 DS    F
         DS    0F
@CF00183 DC    F'2'
@CH00183 EQU   @CF00183+2
@CF00512 DC    F'80'
@CH00512 EQU   @CF00512+2
@CF04248 DC    F'-80'
@CF04235 DC    F'-72'
@CF04239 DC    F'-8'
@CF04250 DC    F'-4'
@CA00038 DC    A(HMASMCCA)
@CV03342 DC    V(HMASMALC)
@CV03343 DC    V(HMASMEIS)
@CV03344 DC    V(HMASMION)
@CV03345 DC    V(HMASMIO1)
@CV03346 DC    V(HMASMMSG)
@CV03347 DC    V(HMASMRDS)
         DS    0D
DIRLEN   DS    F
TCBPTR   DC    A(0)
IOBPRPTR DS    A
IOBSTPTR DS    A
JFCBPTR  DC    AL4(JFCBOPEN)
J        DS    A
K        DS    A
M        DS    A
N        DS    A
BUFFSV   DS    A
XTNDLEN  DS    F
ADDIRDCB DC    AL4(DIRUDCB)
ADCDODCB DC    AL4(CDSODCB)
ADACODCB DC    AL4(ACDSODCB)
ADCQODCB DC    AL4(CRQODCB)
ADAQODCB DC    AL4(ACRQODCB)
ADPTFDCB DC    AL4(PTFDCB)
ADPTFND  DC    AL4(PTFDCBND)
ADSVPTF  DC    AL4(SVPTFDCB)
DSBFPTRI DS    A
DSBFPTRO DS    A
PDSADDR  DS    A
TMPCPTR1 DS    A
ARRYADDR DS    A
GETADDR  DC    F'0'
ADIOSAVE DC    AL4(IOSAVE)
ADWTSAVE DC    AL4(WTSAVE)
ADJFCB01 DC    AL4(JFCBSAV1)
ADJFCB02 DC    AL4(JFCBSAV2)
ADJFCBPT DC    AL4(JFCBPTF)
IOPPTR2  DS    A
INITDSRG DC    H'0'
DSBFMX   DS    H
DSBFRMX  DS    H
PGLEN    DS    H
TBFRCNTI DC    H'0'
TBFRSIZ  DC    H'0'
LENDCB   DS    H
SAVBFMX  DS    H
DCBNO    DS    FL1
TTRSV    DS    AL3
PDSI     DC    AL1(0)
SAVUSERL DS    FL1
IOENTCNT DC    AL1(0)
WTENTCNT DC    AL1(0)
EOFFNCSV DS    FL1
EOFTYPSV DS    FL1
EOFLSV   DS    FL1
ERRENTCT DC    AL1(0)
@CC03371 DC    C'1SYSTEM '
@CC03331 DC    C'CLOSE'
@CC03333 DC    C'OPEN '
         DS    CL2
HMASMRDP DS    CL26
         ORG   HMASMRDP
RDPDSID  DS    FL1
RDPFUNCT DS    FL1
RDPRETRN DS    FL1
@NM00173 DS    FL1
RDPBUFAD DS    AL4
RDPWKAD  DS    AL4
RDPENTS  DS    FL4
RDPALLOC DS    FL4
RDPUSED  DS    FL4
RDPTYPE  DS    BL2
         ORG   HMASMRDP+26
         DS    CL2
HMASMMGP DS    CL24
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00174 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00175 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL12
         ORG   MGPVAR
MGPVARPT DS    3A
         ORG   HMASMMGP+24
LASTDDI  DC    CL8' '
LASTDDO  DC    CL8' '
CCWFLGSV DS    BL1
         DS    CL3
TEMPTTR  DS    CL4
MEMNAME  DS    CL8
IOIOP    DS    CL68
SAVSYS   DS    CL8
PATCHIO  DS    CL80
         ORG   PATCHIO
@NM00208 DC    80X'FF'
         ORG   PATCHIO+80
PDSDDNAM DS    CL8
SAVTTR   DS    CL3
         DS    CL1
DBLWRD   DS    CL8
TIMETEMP DS    CL4
SMPARRAY DS    CL46
         ORG   SMPARRAY
@NM00225 DC    AL4(MAINHEAD)
         DC    AL4(PRNTBUF)
         DS    8XL4
@NM00226 DC    H'0'
@NM00227 DC    H'2'
@NM00228 DC    H'10000'
         ORG   SMPARRAY+46
MAINHEAD DS    CL121
         ORG   MAINHEAD
@NM00241 DC    CL1'1'
@NM00242 DC    5CL1' '
@NM00243 DC    CL5'DATE '
DATEFLD  DS    CL6
         ORG   DATEFLD
YY       DS    CL2
@NM00244 DC    CL1'.'
DDD      DS    CL3
         ORG   MAINHEAD+17
@NM00245 DC    2CL1' '
@NM00246 DC    CL5'TIME '
HH       DS    CL2
@NM00247 DC    CL1':'
MM       DS    CL2
@NM00248 DC    CL1':'
TT       DS    CL2
@NM00249 DC    6CL1' '
@NM00250 DC    CL17'HMASMP LVL 04.00 '
MHEAD    DC    CL31' '
@NM00251 DC    24CL1' '
@NM00252 DC    CL5'PAGE '
PAGEFLD  DS    CL4
         ORG   PAGEFLD
@NM00253 DS    CL3
LASTDIG  DS    BL1
         ORG   MAINHEAD+119
@NM00254 DC    2CL1' '
         ORG   MAINHEAD+121
PRNTBUF  DS    CL121
         ORG   PRNTBUF
PRNTASA  DC    CL1' '
PRNTDATA DC    CL120' '
         ORG   PRNTBUF+121
SYSARRAY DS    CL46
         ORG   SYSARRAY
@NM00229 DC    AL4(MAINHEAD)
         DC    AL4(PRNTBUF)
         DS    8XL4
@NM00230 DC    H'0'
@NM00231 DC    H'2'
@NM00232 DC    H'10000'
         ORG   SYSARRAY+46
         DS    CL2
RPTARRAY DS    CL46
         ORG   RPTARRAY
@NM00233 DC    AL4(MAINHEAD)
         DC    AL4(PRNTBUF)
         DS    8XL4
@NM00234 DC    H'0'
@NM00235 DC    H'2'
@NM00236 DC    H'10000'
         ORG   RPTARRAY+46
         DS    CL2
LSTARRAY DS    CL46
         ORG   LSTARRAY
@NM00237 DC    AL4(MAINHEAD)
         DC    AL4(PRNTBUF)
         DS    8XL4
@NM00238 DC    H'0'
@NM00239 DC    H'2'
@NM00240 DC    H'10000'
         ORG   LSTARRAY+46
OUTHEAD  DC    CL31'MESSAGES AND CONTROL STATEMENTS'
PRNTHEAD DC    CL15'SYSPRINT OUTPUT'
RPTHEAD  DC    CL13'SMPRPT OUTPUT'
LSTHEAD  DC    CL14'SMPLIST OUTPUT'
QNAME    DC    CL8'SYSDSN  '
ENQRNAME DS    CL45
         ORG   ENQRNAME
RNAMELEN DS    FL1
RNAME    DC    CL44' '
         ORG   ENQRNAME+45
SWITCHES DC    AL2(0)
         ORG   SWITCHES
SYSPDEAD DS    BL1
CONTEOF  EQU   SWITCHES+0
SKIPRDJF EQU   SWITCHES+0
DISISW   EQU   SWITCHES+0
DISOSW   EQU   SWITCHES+0
ALIASW   EQU   SWITCHES+0
PTFJFSV  EQU   SWITCHES+0
PTFF2OP  EQU   SWITCHES+0
CHNGDISP DS    BL1
ENQDONE  EQU   SWITCHES+1
@NM00257 EQU   SWITCHES+1
         ORG   SWITCHES+2
         DS    CL2
EXITLST  DS    CL8
         ORG   EXITLST
JFCEXL   DS    CL4
         ORG   JFCEXL
@NM00258 DC    X'07'
@NM00259 DC    AL3(JFCBOPEN)
         ORG   EXITLST+4
DCBXL    DS    CL4
         ORG   DCBXL
@NM00260 DC    X'85'
@NM00261 DC    AL3(DCBEXIT)
         ORG   EXITLST+8
DEVDDNAM DS    CL8
DEVADDR  DS    CL8
DCBDCLS  DS    CL672
         ORG   DCBDCLS
HISTENT  DS    CL16
         ORG   HISTENT
@NM00265 DC    AL4(HISTDCB)
@NM00266 DC    AL4(OPHISTI)
@NM00267 DC    AL4(HISTDCB)
@NM00268 DC    AL4(OPHISTO)
         ORG   DCBDCLS+16
CDSENT   DS    CL16
         ORG   CDSENT
@NM00269 DC    AL4(CDSIDCB)
@NM00270 DC    AL4(OPCDSI)
@NM00271 DC    AL4(CDSODCB)
@NM00272 DC    AL4(OPCDSO)
         ORG   DCBDCLS+32
SCR1ENT  DS    CL16
         ORG   SCR1ENT
@NM00273 DC    AL4(SCR1DCB)
@NM00274 DC    AL4(OPSCR1I)
@NM00275 DC    AL4(SCR1DCB)
@NM00276 DC    AL4(OPSCR1O)
         ORG   DCBDCLS+48
SCR2ENT  DS    CL16
         ORG   SCR2ENT
@NM00277 DC    AL4(SCR2DCB)
@NM00278 DC    AL4(OPSCR2I)
@NM00279 DC    AL4(SCR2DCB)
@NM00280 DC    AL4(OPSCR2O)
         ORG   DCBDCLS+64
MACENT   DS    CL16
         ORG   MACENT
@NM00281 DC    AL4(MACDCB)
@NM00282 DC    AL4(OPMACI)
@NM00283 DC    A(0)
@NM00284 DC    A(0)
         ORG   DCBDCLS+80
PTSENT   DS    CL16
         ORG   PTSENT
@NM00285 DC    AL4(PTSIDCB)
@NM00286 DC    AL4(OPPTSI)
@NM00287 DC    AL4(PTSODCB)
@NM00288 DC    AL4(OPPTSO)
         ORG   DCBDCLS+96
SGTENT   DS    CL16
         ORG   SGTENT
@NM00289 DC    AL4(SGTDCB)
@NM00290 DC    AL4(OPSGTI)
@NM00291 DC    A(0)
@NM00292 DC    A(0)
         ORG   DCBDCLS+112
CDSDENT  DS    CL16
         ORG   CDSDENT
@NM00293 DC    AL4(CDSDDCB)
@NM00294 DC    AL4(OPCDSDI)
@NM00295 DC    AL4(CDSDDCB)
@NM00296 DC    AL4(OPCDSDO)
         ORG   DCBDCLS+128
CONTENT  DS    CL16
         ORG   CONTENT
@NM00297 DC    AL4(CONTDCB)
@NM00298 DC    AL4(OPCONTI)
@NM00299 DC    A(0)
@NM00300 DC    A(0)
         ORG   DCBDCLS+144
PTFENT   DS    CL16
         ORG   PTFENT
@NM00301 DC    AL4(PTFDCB)
@NM00302 DC    AL4(OPPTFI)
@NM00303 DC    A(0)
@NM00304 DC    A(0)
         ORG   DCBDCLS+160
PRTENT   DS    CL16
         ORG   PRTENT
@NM00305 DC    A(0)
@NM00306 DC    A(0)
@NM00307 DC    AL4(PRTDCB)
@NM00308 DC    AL4(OPPRTO)
         ORG   DCBDCLS+176
ACDSENT  DS    CL16
         ORG   ACDSENT
@NM00309 DC    AL4(ACDSIDCB)
@NM00310 DC    AL4(OPACDSI)
@NM00311 DC    AL4(ACDSODCB)
@NM00312 DC    AL4(OPACDSO)
         ORG   DCBDCLS+192
ACDSDENT DS    CL16
         ORG   ACDSDENT
@NM00313 DC    AL4(ACDSDDCB)
@NM00314 DC    AL4(OPACDSDI)
@NM00315 DC    AL4(ACDSDDCB)
@NM00316 DC    AL4(OPACDSDO)
         ORG   DCBDCLS+208
STNDDD   DS    CL16
         ORG   STNDDD
@NM00317 DC    AL4(STNDIDCB)
@NM00318 DC    AL4(OPSTNDI)
@NM00319 DC    AL4(STNDODCB)
@NM00320 DC    AL4(OPSTNDO)
         ORG   DCBDCLS+224
PUNENT   DS    CL16
         ORG   PUNENT
@NM00321 DC    A(0)
@NM00322 DC    A(0)
@NM00323 DC    AL4(PUNODCB)
@NM00324 DC    AL4(OPPUNO)
         ORG   DCBDCLS+240
@NM00325 DS    CL16
         ORG   @NM00325
@NM00326 DC    A(0)
@NM00327 DC    A(0)
@NM00328 DC    A(0)
@NM00329 DC    A(0)
         ORG   DCBDCLS+256
@NM00330 DS    CL16
         ORG   @NM00330
@NM00331 DC    A(0)
@NM00332 DC    A(0)
@NM00333 DC    A(0)
@NM00334 DC    A(0)
         ORG   DCBDCLS+272
MTSENT   DS    CL16
         ORG   MTSENT
@NM00335 DC    AL4(MTSIDCB)
@NM00336 DC    AL4(OPMTSI)
@NM00337 DC    AL4(MTSODCB)
@NM00338 DC    AL4(OPMTSO)
         ORG   DCBDCLS+288
MTSDENT  DS    CL16
         ORG   MTSDENT
@NM00339 DC    AL4(MTSDDCB)
@NM00340 DC    AL4(OPMTSDI)
@NM00341 DC    A(0)
@NM00342 DC    A(0)
         ORG   DCBDCLS+304
SYSPTENT DS    CL16
         ORG   SYSPTENT
@NM00343 DC    A(0)
@NM00344 DC    A(0)
@NM00345 DC    AL4(SYSODCB)
@NM00346 DC    AL4(OPSYSO)
         ORG   DCBDCLS+320
@NM00347 DS    CL16
         ORG   @NM00347
@NM00348 DC    A(0)
@NM00349 DC    A(0)
@NM00350 DC    A(0)
@NM00351 DC    A(0)
         ORG   DCBDCLS+336
SRCENT   DS    CL16
         ORG   SRCENT
@NM00352 DC    AL4(SRCDCB)
@NM00353 DC    AL4(OPSRCI)
@NM00354 DC    A(0)
@NM00355 DC    A(0)
         ORG   DCBDCLS+352
PTSDENT  DS    CL16
         ORG   PTSDENT
@NM00356 DC    AL4(PTSDDCB)
@NM00357 DC    AL4(OPPTSDI)
@NM00358 DC    A(0)
@NM00359 DC    A(0)
         ORG   DCBDCLS+368
ANYDDENT DS    CL16
         ORG   ANYDDENT
@NM00360 DC    AL4(STNDIDCB)
@NM00361 DC    AL4(OPSTNDI)
@NM00362 DC    AL4(STNDODCB)
@NM00363 DC    AL4(OPSTNDO)
         ORG   DCBDCLS+384
JFCBENT  DS    CL16
         ORG   JFCBENT
@NM00364 DC    AL4(JFCBDCB)
@NM00365 DC    AL4(OPJFCBI)
@NM00366 DC    AL4(JFCBDCB)
@NM00367 DC    AL4(OPJFCBO)
         ORG   DCBDCLS+400
STSENT   DS    CL16
         ORG   STSENT
@NM00368 DC    AL4(STSIDCB)
@NM00369 DC    AL4(OPSTSI)
@NM00370 DC    AL4(STSODCB)
@NM00371 DC    AL4(OPSTSO)
         ORG   DCBDCLS+416
STSDENT  DS    CL16
         ORG   STSDENT
@NM00372 DC    AL4(STSDDCB)
@NM00373 DC    AL4(OPSTSDI)
@NM00374 DC    A(0)
@NM00375 DC    A(0)
         ORG   DCBDCLS+432
CRQENT   DS    CL16
         ORG   CRQENT
@NM00376 DC    AL4(CRQIDCB)
@NM00377 DC    AL4(OPCRQI)
@NM00378 DC    AL4(CRQODCB)
@NM00379 DC    AL4(OPCRQO)
         ORG   DCBDCLS+448
CRQDENT  DS    CL16
         ORG   CRQDENT
@NM00380 DC    AL4(CRQDIDCB)
@NM00381 DC    AL4(OPCRQDI)
@NM00382 DC    A(0)
@NM00383 DC    A(0)
         ORG   DCBDCLS+464
ACRQENT  DS    CL16
         ORG   ACRQENT
@NM00384 DC    AL4(ACRQIDCB)
@NM00385 DC    AL4(OPACRQI)
@NM00386 DC    AL4(ACRQODCB)
@NM00387 DC    AL4(OPACRQO)
         ORG   DCBDCLS+480
ACRQDENT DS    CL16
         ORG   ACRQDENT
@NM00388 DC    AL4(ACRQDDCB)
@NM00389 DC    AL4(OPACRQDI)
@NM00390 DC    A(0)
@NM00391 DC    A(0)
         ORG   DCBDCLS+496
LRFENT   DS    CL16
         ORG   LRFENT
@NM00392 DC    AL4(LRFIDCB)
@NM00393 DC    AL4(OPLRFI)
@NM00394 DC    A(0)
@NM00395 DC    A(0)
         ORG   DCBDCLS+512
SCDSENT  DS    CL16
         ORG   SCDSENT
@NM00396 DC    AL4(SCDSIDCB)
@NM00397 DC    AL4(OPSCDSI)
@NM00398 DC    AL4(SCDSODCB)
@NM00399 DC    AL4(OPSCDSO)
         ORG   DCBDCLS+528
SCDSDENT DS    CL16
         ORG   SCDSDENT
@NM00400 DC    AL4(SCDSDDCB)
@NM00401 DC    AL4(OPSCDSDI)
@NM00402 DC    A(0)
@NM00403 DC    A(0)
         ORG   DCBDCLS+544
WK1ENT   DS    CL16
         ORG   WK1ENT
@NM00404 DC    AL4(WK1IDCB)
@NM00405 DC    AL4(OPWK1I)
@NM00406 DC    AL4(WK1ODCB)
@NM00407 DC    AL4(OPWK1O)
         ORG   DCBDCLS+560
WK2ENT   DS    CL16
         ORG   WK2ENT
@NM00408 DC    AL4(WK2IDCB)
@NM00409 DC    AL4(OPWK2I)
@NM00410 DC    AL4(WK2ODCB)
@NM00411 DC    AL4(OPWK2O)
         ORG   DCBDCLS+576
WK3ENT   DS    CL16
         ORG   WK3ENT
@NM00412 DC    AL4(WK3IDCB)
@NM00413 DC    AL4(OPWK3I)
@NM00414 DC    AL4(WK3ODCB)
@NM00415 DC    AL4(OPWK3O)
         ORG   DCBDCLS+592
WK4ENT   DS    CL16
         ORG   WK4ENT
@NM00416 DC    AL4(WK4IDCB)
@NM00417 DC    AL4(OPWK4I)
@NM00418 DC    AL4(WK4ODCB)
@NM00419 DC    AL4(OPWK4O)
         ORG   DCBDCLS+608
WK5ENT   DS    CL16
         ORG   WK5ENT
@NM00420 DC    AL4(WK5IDCB)
@NM00421 DC    AL4(OPWK5I)
@NM00422 DC    AL4(WK5ODCB)
@NM00423 DC    AL4(OPWK5O)
         ORG   DCBDCLS+624
WKXENT   DS    CL16
         ORG   WKXENT
@NM00424 DC    A(0)
@NM00425 DC    A(0)
@NM00426 DC    A(0)
@NM00427 DC    A(0)
         ORG   DCBDCLS+640
RPTENT   DS    CL16
         ORG   RPTENT
@NM00428 DC    A(0)
@NM00429 DC    A(0)
@NM00430 DC    AL4(RPTODCB)
@NM00431 DC    AL4(OPRPTO)
         ORG   DCBDCLS+656
LSTENT   DS    CL16
         ORG   LSTENT
@NM00432 DC    A(0)
@NM00433 DC    A(0)
@NM00434 DC    AL4(LSTODCB)
@NM00435 DC    AL4(OPLSTO)
         ORG   DCBDCLS+672
ENDENTS  DS    0C
         ORG   DCBDCLS+672
JFCB01NM DC    CL8'        '
JFCB02NM DC    CL8'        '
POINTTTR DS    CL4
         ORG   POINTTTR
PTTR13   DS    CL3
PTTR4    DC    AL1(0)
         ORG   POINTTTR+4
STOWCPRM DS    CL16
         ORG   STOWCPRM
STOWONAM DS    CL8
STOWNNAM DS    CL8
         ORG   STOWCPRM+16
SAVONAME DS    CL8
SAVNNAME DS    CL8
RELADSV  DS    CL3
OFLGSSV  DS    CL1
         ORG   OFLGSSV
OFLWRSV  DS    BL1
@NM00438 EQU   OFLGSSV+0
         ORG   OFLGSSV+1
BLDLLIST DS    CL80
         ORG   BLDLLIST
@NM00439 DC    H'1'
@NM00440 DC    H'76'
BLDLNAME DS    CL8
BLDLTTR  DS    AL3
@NM00441 DS    CL1
@NM00442 DS    CL1
BLDLUSRL DS    AL1
         ORG   BLDLUSRL
BLDLALIS DS    BL1
BLDLTTRC EQU   BLDLUSRL+0
@NM00443 EQU   BLDLUSRL+0
         ORG   BLDLLIST+18
BLDLUSER DS    CL62
         ORG   BLDLLIST+80
EOFNMSV  DS    CL8
EOFINMSV DS    CL8
EOFDATSV DS    CL24
ERRSAVE1 DS    CL64
PDSARRAY DS    CL16
         ORG   PDSARRAY+0
@NM00213 DC    CL1'N'
@NM00214 DC    AL3(0)
@NM00215 DC    CL1' '
@NM00216 DC    AL3(0)
@NM00217 DC    AL1(0)
@NM00218 DC    CL1' '
@NM00219 DC    H'0'
@NM00220 DC    H'0'
@NM00221 DC    H'0'
         ORG   PDSARRAY+16
         ORG   PDSARRAY+16
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+32
         ORG   PDSARRAY+32
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+48
         ORG   PDSARRAY+48
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+64
         ORG   PDSARRAY+64
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+80
         ORG   PDSARRAY+80
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+96
         ORG   PDSARRAY+96
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+112
         ORG   PDSARRAY+112
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+128
         ORG   PDSARRAY+128
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+144
         ORG   PDSARRAY+144
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+160
         ORG   PDSARRAY+160
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+176
         ORG   PDSARRAY+176
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+192
         ORG   PDSARRAY+192
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+208
         ORG   PDSARRAY+208
         DC    CL1'N'
         DC    AL3(0)
         DC    CL1' '
         DC    AL3(0)
         DC    AL1(0)
         DC    CL1' '
         DC    H'0'
         DC    H'0'
         DC    H'0'
         ORG   PDSARRAY+224
SAVMGP   DS    6CL12
INOUT    DC    6AL1(0)
SAVDSID  DS    6AL1
SAVCCADS DC    6AL1(0)
SAVRETRN DS    6AL1
IOHNDLRS DC    AL4(HISTPRTN)
         DC    AL4(CDSRTN)
         DC    AL4(SCR1RTN)
         DC    AL4(SCR2RTN)
         DC    AL4(MACRTN)
         DC    AL4(PTSRTN)
         DC    AL4(JCLINRTN)
         DC    AL4(CDSDIRTN)
         DC    AL4(CNTLRTN)
         DC    AL4(PTFINRTN)
         DC    AL4(PRTRTN)
         DC    AL4(ACDSRTN)
         DC    AL4(ACDSDRTN)
         DC    AL4(DDDELRTN)
         DC    AL4(PUNRTN)
         DC    AL4(BADEXIT)
         DC    AL4(BADEXIT)
         DC    AL4(MTSRTN)
         DC    AL4(MTSDRTN)
         DC    AL4(SYSRTN)
         DC    AL4(BADEXIT)
         DC    AL4(SRCRTN)
         DC    AL4(PTSDRTN)
         DC    AL4(ANYDDRTN)
         DC    AL4(JFCBRTN)
         DC    AL4(STSRTN)
         DC    AL4(STSDRTN)
         DC    AL4(CRQRTN)
         DC    AL4(CRQDRTN)
         DC    AL4(ACRQRTN)
         DC    AL4(ACRQDRTN)
         DC    AL4(LRFRTN)
         DC    AL4(SCDSRTN)
         DC    AL4(SCDSDRTN)
         DC    AL4(WK1RTN)
         DC    AL4(WK2RTN)
         DC    AL4(WK3RTN)
         DC    AL4(WK4RTN)
         DC    AL4(WK5RTN)
         DC    A(0)
         DC    AL4(RPTRTN)
         DC    AL4(LSTRTN)
ERRSAVE2 DS    3CL64
HMASMIO  CSECT
*                                   /* SAVE AREA DECLARES    @ZA12350*/
IOSAVE   DS    0F                   /* BDY ALIGNMENT         @ZA12350*/
         DS    6CL72                /* MAIN IO SAVE AREAS    @ZA12350*/
WTSAVE   DS    0F                   /* BDY ALIGNMENT         @ZA12350*/
         DS    6CL72                /* WRITE RTN SAVE AREAS  @ZA12350*/
HMASMIO  CSECT
*                                             /*             @Z67SP00*/
         DS    0F                   /* ALIGN ON FULL WORD    @Z40SP00*/
JFCBOPEN DS    176C                 /* WORK JFCB             @Z40SP00*/
         DS    0F                   /* ALIGN ON FULL WORD    @Z40SP00*/
JFCBSAV1 DS    176C                 /* SAVED JFCB 1          @Z67SP00*/
         DS    0F                   /* ALIGN OF FULL WORD    @Z40SP00*/
JFCBSAV2 DS    176C                 /* SAVED JFCB 2          @Z67SP00*/
         DS    0F                   /* ALIGN OF FULL WORD    @Z40SP00*/
JFCBPTF  DS    176C                 /* SAVED JFCB FOR PTFIN  @Z67SP00*/
HMASMIO  CSECT
*                                   /*                       @ZD00003*/
         READ  IODECB,SF,MF=L       DECB FOR READS AND WRITES
OPENLIST DS    0F
OPHISTI  OPEN  (HISTDCB,OUTIN),MF=L
OPCDSI   OPEN  (CDSIDCB,INPUT),MF=L
OPSCR1I  OPEN  (SCR1DCB,INPUT),MF=L
OPSCR2I  OPEN  (SCR2DCB,INPUT),MF=L
OPMACI   OPEN  (MACDCB,INPUT),MF=L
OPPTSI   OPEN  (PTSIDCB,INPUT),MF=L
OPSGTI   OPEN  (SGTDCB,INPUT),MF=L
OPCDSDI  OPEN  (CDSDDCB,INPUT),MF=L
OPCDSDO  OPEN  (CDSDDCB,OUTPUT),MF=L
OPCONTI  OPEN  (CONTDCB,INPUT),MF=L
OPPTFI   OPEN  (PTFDCB,INPUT),MF=L
OPPRTO   OPEN  (PRTDCB,OUTPUT),MF=L
OPACDSI  OPEN  (ACDSIDCB,INPUT),MF=L
OPACDSO  OPEN  (ACDSODCB,OUTPUT),MF=L
OPACDSDI OPEN  (ACDSDDCB,INPUT),MF=L
OPACDSDO OPEN  (ACDSDDCB,OUTPUT),MF=L /*                     @ZD00006*/
OPHISTO  OPEN  (HISTDCB,OUTIN),MF=L
OPCDSO   OPEN  (CDSODCB,OUTPUT),MF=L
OPSCR1O  OPEN  (SCR1DCB,OUTPUT),MF=L
OPSCR2O  OPEN  (SCR2DCB,OUTPUT),MF=L
OPPTSO   OPEN  (PTSODCB,OUTPUT),MF=L
OPSTNDI  OPEN  (STNDIDCB,INPUT),MF=L  /*                     @Z40SP00*/
OPSTNDO  OPEN  (STNDODCB,OUTPUT),MF=L
OPPUNO   OPEN  (PUNODCB,OUTPUT),MF=L  /*                     @Z67SP00*/
OPMTSI   OPEN  (MTSIDCB,INPUT),MF=L   /*                     @Z40SP00*/
OPMTSO   OPEN  (MTSODCB,OUTPUT),MF=L  /*                     @Z40SP00*/
OPMTSDI  OPEN  (MTSDDCB,INPUT),MF=L
OPSYSO   OPEN  (SYSODCB,OUTPUT),MF=L
OPSRCI   OPEN  (SRCDCB,INPUT),MF=L
OPPTSDI  OPEN  (PTSDDCB,INPUT),MF=L
OPJFCBI  OPEN  (JFCBDCB,INPUT),MF=L /*                       @Z40SP00*/
OPJFCBO  OPEN  (JFCBDCB,OUTPUT),MF=L /*                      @Z40SP00*/
OPSTSI   OPEN  (STSIDCB,INPUT),MF=L   /*                     @Z40SP00*/
OPSTSO   OPEN  (STSODCB,OUTPUT),MF=L  /*                     @Z40SP00*/
OPSTSDI  OPEN  (STSDDCB,INPUT),MF=L
OPCRQI   OPEN  (CRQIDCB,INPUT),MF=L /*                       @Z67SP00*/
OPCRQO   OPEN  (CRQODCB,OUTPUT),MF=L /*                      @Z67SP00*/
OPCRQDI  OPEN  (CRQDIDCB,INPUT),MF=L /*                      @Z67SP00*/
OPACRQI  OPEN  (ACRQIDCB,INPUT),MF=L /*                      @Z67SP00*/
OPACRQO  OPEN  (ACRQODCB,OUTPUT),MF=L /*                     @Z67SP00*/
OPACRQDI OPEN  (ACRQDDCB,INPUT),MF=L /*                      @Z67SP00*/
OPLRFI   OPEN  (LRFIDCB,INPUT),MF=L /*                       @Z67SP00*/
OPSCDSI  OPEN  (SCDSIDCB,INPUT),MF=L  /*                     @Z67SP00*/
OPSCDSO  OPEN  (SCDSODCB,OUTPUT),MF=L /*                     @Z67SP00*/
OPSCDSDI OPEN  (SCDSDDCB,INPUT),MF=L  /*                     @Z67SP00*/
OPWK1I   OPEN  (WK1IDCB,INPUT),MF=L   /*                     @Z67SP00*/
OPWK1O   OPEN  (WK1ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/
OPWK2I   OPEN  (WK2IDCB,INPUT),MF=L   /*                     @Z67SP00*/
OPWK2O   OPEN  (WK2ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/
OPWK3I   OPEN  (WK3IDCB,INPUT),MF=L   /*                     @Z67SP00*/
OPWK3O   OPEN  (WK3ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/
OPWK4I   OPEN  (WK4IDCB,INPUT),MF=L   /*                     @Z67SP00*/
OPWK4O   OPEN  (WK4ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/
OPWK5I   OPEN  (WK5IDCB,INPUT),MF=L   /*                     @Z67SP00*/
OPWK5O   OPEN  (WK5ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/
OPRPTO   OPEN  (RPTODCB,OUTPUT),MF=L  /*                     @Z67SP00*/
OPLSTO   OPEN  (LSTODCB,OUTPUT),MF=L  /*                     @Z67SP00*/
HMASMIO  CSECT
         EJECT
DIRUDCB  DCB   DEVD=DA,DSORG=PS,MACRF=(R,W),DDNAME=SMPCDS,RECFM=FB,    X
               LRECL=256,BLKSIZE=256,SYNAD=BSAMERR,KEYLEN=8,           X
               EXLST=JFCEXL                                  @SA76154
         EJECT
HISTDCB  DCB   DEVD=DA,DSORG=PS,MACRF=(R,W),DDNAME=SMPLOG,BLKSIZE=260, X
               RECFM=U,SYNAD=BSAMERR,EXLST=JFCEXL
         EJECT
CDSIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPCDS,LRECL=80,        X
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0
         EJECT
CDSODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPCDS,LRECL=80,        X
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0
         EJECT
ACDSIDCB DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPACDS,LRECL=80,       X
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0
          EJECT
ACDSODCB DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPACDS,LRECL=80,       X
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0
         EJECT
SCR1DCB  DCB   DEVD=DA,DSORG=PS,MACRF=(GM,PM),DDNAME=SYSUT1,LRECL=80,  X
               RECFM=FB,EXLST=JFCEXL,SYNAD=QSAMERR
         EJECT
SCR2DCB  DCB   DEVD=DA,DSORG=PS,MACRF=(R,W),DDNAME=SYSUT1,LRECL=256,   X
               RECFM=F,SYNAD=BSAMERR,BLKSIZE=256,KEYLEN=8,             X
               EXLST=JFCEXL                                  @SA76154
         EJECT
MACDCB   DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=XXXXXXXX,EXLST=JFCEXL,  X
               LRECL=80,RECFM=FB,SYNAD=BPAMERR
         EJECT
PTSIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPPTS,LRECL=80,        X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR
         EJECT
PTSODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPPTS,LRECL=80,        X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR
         EJECT
SGTDCB   DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPJCLIN,LRECL=80,     X
               RECFM=FB,EXLST=JFCEXL,SYNAD=QSAMERR
         EJECT
CDSDDCB  DCB   DEVD=DA,DSORG=PS,MACRF=(GM,PM),DDNAME=SMPCDS,RECFM=FB,  X
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X
               SYNAD=QSAMERR                                 @XA11694
         EJECT
ACDSDDCB DCB   DEVD=DA,DSORG=PS,MACRF=(GM,PM),DDNAME=SMPACDS,RECFM=FB, X
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X
               SYNAD=QSAMERR                                 @XA11694
         EJECT
CONTDCB  DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPCNTL,LRECL=80,      X
               RECFM=FB,EXLST=JFCEXL,SYNAD=QSAMERR           @ZD00003
         EJECT
PTFDCB   DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPPTFIN,RECFM=FB,     X
               EXLST=JFCEXL,SYNAD=QSAMERR,EROPT=ACC          @Z67SP00
PTFDCBND EQU   *                                             @Z67SP00
         EJECT
SVPTFDCB DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPPTFIN,LRECL=80,     X
               RECFM=FB,EXLST=JFCEXL,SYNAD=QSAMERR,EROPT=ACC @Z67SP00
         EJECT
PRTDCB   DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SMPOUT,RECFM=FBA,      X
               LRECL=121,EXLST=JFCEXL,SYNAD=QSAMERR          @ZD00003
         EJECT
STNDIDCB DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=XXXXXXXX,               X
               SYNAD=BPAMERR,EXLST=JFCEXL                    @Z40SP00
         EJECT
STNDODCB DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=XXXXXXXX,               X
               SYNAD=BPAMERR,EXLST=JFCEXL                    @Z40SP00
         EJECT
PUNODCB  DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SMPPUNCH,RECFM=FB,     X
               LRECL=80,EXLST=JFCEXL,SYNAD=QSAMERR           @Z67SP00
         EJECT
MTSIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPMTS,RECFM=FB,        X
               LRECL=80,EXLST=JFCEXL,SYNAD=BPAMERR           @Z40SP00
         EJECT
MTSODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPMTS,LRECL=80,        X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z40SP00
         EJECT
MTSDDCB  DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPMTS,RECFM=FB,       X
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X
               SYNAD=QSAMERR                                 @Z40SP00
         EJECT
SYSODCB  DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SYSPRINT,RECFM=FBA,    X
               LRECL=121,EXLST=JFCEXL,SYNAD=QSAMERR          @ZD00003
         EJECT
SRCDCB   DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=XXXXXXXX,RECFM=FB,      X
               LRECL=80,SYNAD=BPAMERR,EXLST=JFCEXL           @Z40SP00
         EJECT
PTSDDCB  DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPPTS,RECFM=FB,       X
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X
               SYNAD=QSAMERR                                 @Z40SP00
         EJECT
JFCBDCB  DCB   DEVD=DA,DSORG=PO,MACRF=(R,W),DDNAME=XXXXXXXX,           X
               EXLST=JFCEXL                                  @Z40SP00
         EJECT
STSIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPSTS,RECFM=FB,        X
               LRECL=80,EXLST=JFCEXL,SYNAD=BPAMERR           @Z40SP00
         EJECT
STSODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPSTS,LRECL=80,        X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z40SP00
         EJECT
STSDDCB  DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPSTS,RECFM=FB,       X
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X
               SYNAD=QSAMERR                                 @Z40SP00
         EJECT
CRQIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPCRQ,RECFM=FB,        X
               LRECL=80,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
CRQODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPCRQ,LRECL=80,        X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
CRQDIDCB DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPCRQ,RECFM=FB,       X
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X
               SYNAD=QSAMERR                                 @Z67SP00
         EJECT
ACRQIDCB DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPACRQ,RECFM=FB,       X
               LRECL=80,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
ACRQODCB DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPACRQ,LRECL=80,       X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
ACRQDDCB DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPACRQ,RECFM=FB,      X
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X
               SYNAD=QSAMERR                                 @Z67SP00
         EJECT
LRFIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPTLIB,                X
               EXLST=JFCEXL                                  @Z67SP00
         EJECT
SCDSIDCB DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPSCDS,LRECL=80,       X
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0  @Z67SP00
         EJECT
SCDSODCB DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPSCDS,LRECL=80,       X
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0  @Z67SP00
         EJECT
SCDSDDCB DCB   DEVD=DA,DSORG=PS,MACRF=(GM,PM),DDNAME=SMPSCDS,RECFM=FB, X
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X
               SYNAD=QSAMERR                                 @Z67SP00
         EJECT
WK1IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK1,LRECL=80,       X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
WK1ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK1,LRECL=80,       X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
WK2IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK2,LRECL=80,       X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
WK2ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK2,LRECL=80,       X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
WK3IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK3,LRECL=80,       X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
WK3ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK3,LRECL=80,       X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
WK4IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK4,LRECL=80,       X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
WK4ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK4,LRECL=80,       X
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00
         EJECT
WK5IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK5,BLKSIZE=7294,   X
               RECFM=U,EXLST=JFCEXL,SYNAD=BPAMERR            @Z67SP00
         EJECT
WK5ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK5,BLKSIZE=7294,   X
               RECFM=U,EXLST=JFCEXL,SYNAD=BPAMERR            @Z67SP00
         EJECT
RPTODCB  DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SMPRPT,RECFM=FA,       X
               LRECL=121,EXLST=JFCEXL,SYNAD=QSAMERR          @Z67SP00
         EJECT
LSTODCB  DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SMPLIST,RECFM=FA,      X
               LRECL=121,EXLST=JFCEXL,SYNAD=QSAMERR          @Z67SP00
         EJECT
HMASMIO  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
IOPPTR   EQU   @05
DCBPTR   EQU   @02
R0       EQU   @00
R1       EQU   @01
IOPREG   EQU   @03
SIZE     EQU   @04
LENREG   EQU   @04
R13      EQU   @13
RTNREG   EQU   @14
RTNCODE  EQU   @15
         EXTRN HMASMCCA
CVTPTR   EQU   16
CCADSIDA EQU   0
CCATYPEA EQU   0
CCABLDLA EQU   0
@NM00025 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00027 EQU   CCABLDLL
CCALKDRC EQU   @NM00027+20
@NM00029 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00039+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
@NM00043 EQU   HMASMIOP+12
@NM00044 EQU   @NM00043
IOPSEQNO EQU   @NM00043+8
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPTTR   EQU   IOPDRMAP+8
IOPUSERL EQU   IOPDRMAP+11
IOPALIS  EQU   IOPUSERL
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00154 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
XTNDCHAR EQU   0
HMASMPRL EQU   0
PRLRLEN  EQU   HMASMPRL
PRLSPAN  EQU   HMASMPRL+2
PRLFLGS  EQU   PRLSPAN
PRLHEAD  EQU   PRLFLGS
PRLHEADO EQU   PRLFLGS
PRLBLANK EQU   PRLFLGS
PRLDATE  EQU   HMASMPRL+4
PRLHDADR EQU   PRLDATE
PRLTIME  EQU   HMASMPRL+7
PRLEND   EQU   HMASMPRL+10
CVTMAP   EQU   0
CVTTCBP  EQU   CVTMAP
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBXSCT  EQU   TCB+240
TCBXSCT1 EQU   TCBXSCT
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBTCBP EQU   JSCBSEC1+20
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCBSWT1 EQU   JSCBSEC1+55
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
IHADCB   EQU   0
IHADCS00 EQU   0
DCBRELAD EQU   IHADCS00
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBKEYLE EQU   DCBRELB
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSGU  EQU   DCBDSRG1
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEODA  EQU   DCBEODAD+1
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
DCBRECL  EQU   DCBRECLA
IHADCS24 EQU   0
DCBDDNAM EQU   IHADCS24
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRECP EQU   DCBMACR1
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBDEBA  EQU   DCBDEBAD+1
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBBLKSI EQU   IHADCS36+10
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   IHADCS36+20
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBLRECL EQU   IHADCS38+10
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IOBPREFX EQU   0
IOBCFLG1 EQU   IOBPREFX
IOBSTDRD EQU   0
IOBFLAG1 EQU   IOBSTDRD
IOBCYCCK EQU   IOBFLAG1
IOBRSTRT EQU   IOBFLAG1
IOBFLAG2 EQU   IOBSTDRD+1
IOBPURGE EQU   IOBFLAG2
IOBRDHA0 EQU   IOBFLAG2
IOBSENS0 EQU   IOBSTDRD+2
IOBS0B7  EQU   IOBSENS0
IOBSENS1 EQU   IOBSTDRD+3
IOBECBPT EQU   IOBSTDRD+4
IOBFLAG3 EQU   IOBSTDRD+8
IOBFL3   EQU   IOBFLAG3
IOBCNC   EQU   IOBFL3
IOBICL   EQU   IOBFL3
IOBCSW   EQU   IOBSTDRD+9
IOBIOCSW EQU   IOBCSW
IOBSTBYT EQU   IOBIOCSW+3
IOBUSTAT EQU   IOBSTBYT
IOBCSTAT EQU   IOBSTBYT+1
IOBSTART EQU   IOBSTDRD+16
IOBDCBPT EQU   IOBSTDRD+20
IOBFLAG4 EQU   IOBDCBPT
IOBRESTR EQU   IOBSTDRD+24
IOBINCAM EQU   IOBSTDRD+28
IOBBTAMF EQU   IOBINCAM
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCNWRIT EQU   JFCBTSDM
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCSL    EQU   JFCBLTYP
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBOPS1 EQU   JFCBMASK
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCPDS   EQU   JFCBIND1
JFCBIND2 EQU   INFMJFCB+87
JFCDISP  EQU   JFCBIND2
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
DCBEROPT EQU   0
DCBERACC EQU   DCBEROPT
DSIBUFR  EQU   0
DSOBUFR  EQU   0
PDSARRY1 EQU   0
PDSDEBAD EQU   PDSARRY1+1
EOFTTR   EQU   PDSARRY1+5
PDSSW    EQU   PDSARRY1+8
WRITESW  EQU   PDSSW
NOTESW   EQU   PDSSW
DSBFCNTI EQU   PDSARRY1+10
DSBFCNTO EQU   PDSARRY1+12
DSBFSIZI EQU   PDSARRY1+14
PRNTARRY EQU   0
HEADADDR EQU   PRNTARRY
PAGENO   EQU   PRNTARRY+40
HEADCT   EQU   PRNTARRY+42
LINECT   EQU   PRNTARRY+44
TXTIBUFR EQU   0
@NM00255 EQU   0
CVTNTCB  EQU   @NM00255
ENQRTNAR EQU   0
ENQRC    EQU   ENQRTNAR+3
LOGICREC EQU   0
CCWS     EQU   0
CCWOP    EQU   CCWS
CCWFLAG  EQU   CCWS+4
CCWDATA  EQU   CCWFLAG
IOSVAREA EQU   0
WTSVAREA EQU   0
SVAREAS  EQU   0
SVBACK   EQU   SVAREAS+4
SVFWRD   EQU   SVAREAS+8
OUTIN    EQU   0
JFCBAREA EQU   0
IOROUT   EQU   0
SYNJOBN  EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCACBFIA EQU   CCAFBUFR
CCACBFOA EQU   CCAFBUFR+4
CCAVBFIA EQU   CCAFBUFR+8
CCAVBFOA EQU   CCAFBUFR+12
CCAPBFIA EQU   CCAFBUFR+16
CCAPBFOA EQU   CCAFBUFR+20
CCAQBFIA EQU   CCAFBUFR+24
CCAQBFOA EQU   CCAFBUFR+28
CCAWBFIA EQU   CCAFBUFR+32
CCAWBFOA EQU   CCAFBUFR+36
CCATBFIA EQU   CCAFBUFR+40
CCA4BFIA EQU   CCAFBUFR+44
CCA4BFOA EQU   CCAFBUFR+48
CCATBFSZ EQU   CCAFBUFR+76
CCACBFMX EQU   CCAFBUFR+92
CCAABFMX EQU   CCAFBUFR+94
CCAVBFMX EQU   CCAFBUFR+96
CCAPBFMX EQU   CCAFBUFR+98
CCAMBFMX EQU   CCAFBUFR+100
CCASBFMX EQU   CCAFBUFR+102
CCAQBFMX EQU   CCAFBUFR+104
CCAXBFMX EQU   CCAFBUFR+106
CCA1BFMX EQU   CCAFBUFR+108
CCA2BFMX EQU   CCAFBUFR+110
CCA3BFMX EQU   CCAFBUFR+112
CCA4BFMX EQU   CCAFBUFR+114
CCATBFMX EQU   CCAFBUFR+116
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAPESIZ EQU   CCAFIOP+4
CCAFSYS  EQU   HMASMCCA+148
CCAPGLEN EQU   CCAFSYS+8
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00009 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAAPPLY EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCALIST  EQU   CCAFLAG1
CCACNV   EQU   CCAFLAG1+1
CCAFLAG2 EQU   CCAFFUNC+11
CCATERM  EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCACDSIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCAFLAG5 EQU   CCAFDIS+1
CCACDSOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCADATE  EQU   CCAFCTL+1
CCATIME  EQU   CCAFCTL+4
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCALOGNG EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCACURDS EQU   CCAFDSNG+2
CCACURDD EQU   CCAFDSNG+3
PASSIOP  EQU   0
NOTETTR  EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00050 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPONAME EQU   IOPSTCMP
IOPOTYPE EQU   IOPSTCMP+8
IOPNNAME EQU   IOPSTCMP+9
IOPNTYPE EQU   IOPSTCMP+17
IOPDYNDT EQU   IOPUDATA
IOPDSN   EQU   IOPDYNDT
IOPSPACE EQU   IOPDYNDT+44
IOPSPRIM EQU   IOPSPACE
IOPDTYPE EQU   IOPDYNDT+50
IOPDMAC  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00061 EQU   IOPUDATA
IOPBLKSI EQU   @NM00061
IOPVLSER EQU   @NM00061+2
IOPTPSEQ EQU   @NM00061+8
@NM00062 EQU   IOPUDATA
IOPUSED  EQU   @NM00062
IOPALLOC EQU   @NM00062+4
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00071 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00082 EQU   IOPSRCDR+1
@NM00084 EQU   @NM00082+7
@NM00088 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00092 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00098 EQU   IOPMODDR+1
@NM00100 EQU   @NM00098+7
@NM00104 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00108 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00119 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00126 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPDUMMP EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00135 EQU   IOPPTFFX
@NM00136 EQU   @NM00135
IOPPDTES EQU   IOPPTFFX+41
@NM00139 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPFMID EQU   IOPPTFFX+73
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPPTFND EQU   IOPPMODS
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00164 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00164
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00168 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00168
IOPBFTB1 EQU   IOPBFTB0
PRLDATA  EQU   PRLEND
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBASID EQU   JSCBSEC3+8
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCSCT   EQU   JSCBSEC3+68
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
IOBORG01 EQU   IOBPREFX+8
IOBNIOBA EQU   IOBORG01
IOBNFLG1 EQU   IOBNIOBA
IOBORG02 EQU   IOBPREFX+8
IOBDQADA EQU   IOBORG02
IOBDEQIN EQU   IOBDQADA
IOBORG03 EQU   IOBPREFX+12
IOBORG04 EQU   IOBINCAM
IOBORG12 EQU   IOBINCAM
IOBFL4   EQU   IOBORG12
IOBEXTEN EQU   IOBSTDRD+32
IOBSEEK  EQU   IOBEXTEN
IOBBB    EQU   IOBSEEK+1
IOBCC    EQU   IOBSEEK+3
IOBHH    EQU   IOBSEEK+5
IOBORG05 EQU   IOBEXTEN
IOBORG06 EQU   IOBEXTEN
IOBNXTPT EQU   IOBORG06+4
IOBSTATA EQU   IOBNXTPT
IOBORG07 EQU   IOBEXTEN+8
W1IEXTEN EQU   IOBORG07
IOBORG08 EQU   IOBEXTEN+8
IOBINDCT EQU   IOBORG08+4
IOBUNSQR EQU   IOBORG08+5
IOBFCHAD EQU   IOBORG08+8
IOBORG09 EQU   IOBEXTEN+8
IOBDPLAD EQU   IOBORG09+4
IOBDTYPE EQU   IOBORG09+8
IOBDTYP2 EQU   IOBORG09+9
IOBDSTAT EQU   IOBORG09+10
IOBSTAT1 EQU   IOBDSTAT
IOBORG10 EQU   IOBEXTEN+8
IOBSEEK2 EQU   IOBORG10
IOBORG11 EQU   IOBEXTEN
IOBERCT  EQU   IOBORG11
IOBUCBXV EQU   IOBERCT
IOBNAME  EQU   IOBORG11+4
IOBORG13 EQU   IOBEXTEN
IOBSKADR EQU   IOBORG13
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCFMREC EQU   JFCRCFM
JFCRFB   EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCLRECL EQU   JFCAMSYN
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCBS001 EQU   JFCBVOLS
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
IOBRSCT  EQU   IOBCSW+5
TIMEAREA EQU   DBLWRD
TIMEHH   EQU   TIMEAREA+1
TIMEMM   EQU   TIMEAREA+3
TIMETT   EQU   TIMEAREA+5
DATE     EQU   DBLWRD
DATEYY   EQU   DATE
DATEDDD  EQU   DATE+2
DAY      EQU   DATEDDD+2
FREEADDR EQU   GETADDR
DCBS     EQU   DCBDCLS
@NM00436 EQU   JFCBOPS1+4
JFCBOPSW EQU   @NM00436
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00437 EQU   @NM00436
@NM00224 EQU   DATEDDD
@NM00223 EQU   TIMEAREA+7
@NM00222 EQU   TIMEAREA
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBSPNM EQU   JFCBS001+45
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCRSV41 EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00206 EQU   JFCBS001
JFCAVOLS EQU   JFCBVOLS
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00205 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00204 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
IOBSKSS  EQU   IOBSKADR+3
IOBSK0   EQU   IOBSKADR+2
IOBSKTT  EQU   IOBSKADR+1
IOBSKRV  EQU   IOBSKADR
IOBCSWSV EQU   IOBORG11+17
IOBSENSV EQU   IOBORG11+16
IOBRCD   EQU   IOBORG11+12
IOBMDREC EQU   IOBORG11+8
IOBNAMEA EQU   IOBNAME+1
IOBNAMSZ EQU   IOBNAME
IOBERCTA EQU   IOBERCT+1
IOBRTYPE EQU   IOBUCBXV
IOBRDCHP EQU   IOBORG10+20
IOBNEXTA EQU   IOBORG10+16
IOBREADA EQU   IOBORG10+12
IOBBUFC  EQU   IOBORG10+8
IOBSK2R  EQU   IOBSEEK2+7
IOBSK2HH EQU   IOBSEEK2+5
IOBSK2CC EQU   IOBSEEK2+3
IOBSK2BB EQU   IOBSEEK2+1
IOBSK2M  EQU   IOBSEEK2
IOBCHNPR EQU   IOBORG09+40
IOBDNCRF EQU   IOBORG09+32
IOBRSV35 EQU   IOBORG09+24
IOBDQPTR EQU   IOBORG09+20
IOBRSV34 EQU   IOBORG09+18
IOBDBYTN EQU   IOBORG09+16
IOBDCPND EQU   IOBORG09+12
IOBSTAT2 EQU   IOBDSTAT+1
IOBSIORT EQU   IOBSTAT1
IOBADDVU EQU   IOBSTAT1
IOBBUFF  EQU   IOBSTAT1
IOBENQUE EQU   IOBSTAT1
IOBPASS2 EQU   IOBSTAT1
IOBSYNCH EQU   IOBSTAT1
IOBNEWVL EQU   IOBSTAT1
IOBABNRM EQU   IOBSTAT1
IOBRELEX EQU   IOBDTYP2
IOBADDTY EQU   IOBDTYP2
IOBTYPE  EQU   IOBDTYP2
IOBRQUST EQU   IOBDTYP2
IOBSUFFX EQU   IOBDTYP2
IOBSBLKL EQU   IOBDTYP2
IOBSKEY  EQU   IOBDTYP2
IOBRELBL EQU   IOBDTYPE
IOBRDEXC EQU   IOBDTYPE
IOBDYNBF EQU   IOBDTYPE
IOBACTAD EQU   IOBDTYPE
IOBFDBCK EQU   IOBDTYPE
IOBEXTSC EQU   IOBDTYPE
IOBOVFLO EQU   IOBDTYPE
IOBVERFY EQU   IOBDTYPE
IOBDPLB  EQU   IOBDPLAD+1
IOBDAYLI EQU   IOBDPLAD
IOBDIOBS EQU   IOBORG09+2
IOBDBYTR EQU   IOBORG09
IOBBCHAD EQU   IOBORG08+12
IOBFCHNB EQU   IOBFCHAD+1
IOBCOUNT EQU   IOBFCHAD
IOBASYN  EQU   IOBORG08+7
IOBAPP   EQU   IOBORG08+6
IOBRSV32 EQU   IOBUNSQR
IOBRSV31 EQU   IOBUNSQR
IOBRSV30 EQU   IOBUNSQR
IOBKNRWR EQU   IOBUNSQR
IOBKNWR  EQU   IOBUNSQR
IOBNTAV2 EQU   IOBUNSQR
IOBNTAV1 EQU   IOBUNSQR
IOBCPBSY EQU   IOBUNSQR
IOBCHNNL EQU   IOBINDCT
IOBRSV29 EQU   IOBINDCT
IOBRSV28 EQU   IOBINDCT
IOBRSV27 EQU   IOBINDCT
IOBKEYAD EQU   IOBINDCT
IOBOVPTR EQU   IOBINDCT
IOBUNSCH EQU   IOBINDCT
IOBDEQCP EQU   IOBINDCT
IOBCCWAD EQU   IOBORG08
W1OEXTEN EQU   W1IEXTEN
IOBCCW   EQU   IOBORG06+8
IOBNXTPB EQU   IOBNXTPT+1
IOBRSV26 EQU   IOBSTATA
IOBRSV25 EQU   IOBSTATA
IOBRSV24 EQU   IOBSTATA
IOBRSV23 EQU   IOBSTATA
IOBRSV22 EQU   IOBSTATA
IOBRSV21 EQU   IOBSTATA
IOBRSV20 EQU   IOBSTATA
IOBAVLFL EQU   IOBSTATA
IOBRSV37 EQU   IOBORG06+1
IOBUCBXG EQU   IOBORG06
IOBCPA   EQU   IOBORG05+32
IOBERINF EQU   IOBORG05+16
IOBERCCW EQU   IOBORG05+8
IOBSNDPT EQU   IOBORG05+7
IOBRCVPT EQU   IOBORG05+6
IOBWORK  EQU   IOBORG05+1
IOBUCBX  EQU   IOBORG05
IOBR     EQU   IOBSEEK+7
IOBHH2   EQU   IOBHH+1
IOBHH1   EQU   IOBHH
IOBCC2   EQU   IOBCC+1
IOBCC1   EQU   IOBCC
IOBBB2   EQU   IOBBB+1
IOBBB1   EQU   IOBBB
IOBM     EQU   IOBSEEK
IOBRSV46 EQU   IOBFL4
IOBRSV47 EQU   IOBFL4
IOBENT   EQU   IOBFL4
IOBEQP   EQU   IOBFL4
IOBBUS   EQU   IOBFL4
IOBDCK   EQU   IOBFL4
IOBREJ   EQU   IOBFL4
IOBOVR   EQU   IOBFL4
IOBCRILC EQU   IOBORG04+1
IOBCRDCC EQU   IOBORG04
IOBGQECB EQU   IOBORG03
IOBSWAP  EQU   IOBORG02+4
IOBDQADB EQU   IOBDQADA+1
IOBRSV13 EQU   IOBDEQIN
IOBRSV12 EQU   IOBDEQIN
IOBRSV11 EQU   IOBDEQIN
IOBRSV10 EQU   IOBDEQIN
IOBRSV09 EQU   IOBDEQIN
IOBRSV08 EQU   IOBDEQIN
IOBRSV07 EQU   IOBDEQIN
IOBDEQ   EQU   IOBDEQIN
IOBNECB  EQU   IOBORG01+4
IOBNIOBB EQU   IOBNIOBA+1
IOBFIRST EQU   IOBNFLG1
IOBUPERR EQU   IOBNFLG1
IOBSPAN  EQU   IOBNFLG1
IOBBKSPC EQU   IOBNFLG1
IOBUPDAT EQU   IOBNFLG1
IOBREAD  EQU   IOBNFLG1
IOBWRITE EQU   IOBNFLG1
IOBPRTOV EQU   IOBNFLG1
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCBASWA EQU   JSCBSEC3+96
JSCBUFPT EQU   JSCBSEC3+92
JSCBACT  EQU   JSCBSEC3+88
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV33 EQU   JSCBSEC3+86
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV53 EQU   JSCBSEC3+82
JSCDDNNO EQU   JSCBSEC3+80
JSCBVATA EQU   JSCBSEC3+76
JSCTMCOR EQU   JSCBSEC3+72
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCDSABQ EQU   JSCBSEC3+60
JSCBSSIB EQU   JSCBSEC3+56
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00185 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00184 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCRSV25 EQU   JSCBSEC3+10
JSCBTJID EQU   JSCBASID
JSCBPSCB EQU   JSCBSEC3+4
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00170 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00169 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00167 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00166 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00165 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00163 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00162 EQU   IOPPTSFX+35
@NM00161 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00160 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00159 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00158 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00157 EQU   IOPQFMDR
@NM00153 EQU   IOPQSMDR
@NM00152 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00151 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00150 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00149 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00148 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00147 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00146 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00145 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00144 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00143 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00142 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00141 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
@NM00140 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00139+3
IOPRECD  EQU   @NM00139
@NM00138 EQU   IOPPTFFX+8
@NM00137 EQU   @NM00135+7
IOPPRELN EQU   @NM00136
@NM00134 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00133 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00132 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
@NM00131 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00130 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00129 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00128 EQU   @NM00126+7
@NM00127 EQU   @NM00126
@NM00125 EQU   IOPSYSDR+5
@NM00124 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00123 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00122 EQU   IOPDLBFX+8
@NM00121 EQU   @NM00119+7
@NM00120 EQU   @NM00119
@NM00118 EQU   IOPDLBDR+1
@NM00117 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00116 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00115 EQU   IOPMODFX+12
@NM00114 EQU   IOPMODF4
@NM00113 EQU   IOPMODF3
@NM00112 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00111 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00110 EQU   @NM00108+7
@NM00109 EQU   @NM00108
@NM00107 EQU   IOPMODDR+17
@NM00106 EQU   @NM00104+7
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00100
@NM00102 EQU   @NM00100
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00098
@NM00097 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00096 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00095 EQU   IOPSRCFX+8
@NM00094 EQU   @NM00092+7
@NM00093 EQU   @NM00092
@NM00091 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00090 EQU   @NM00088+7
@NM00089 EQU   @NM00088
@NM00087 EQU   @NM00084
@NM00086 EQU   @NM00084
@NM00085 EQU   @NM00084
@NM00083 EQU   @NM00082
@NM00081 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00080 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00079 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00078 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00077 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00076 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00075 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00073 EQU   @NM00071+7
@NM00072 EQU   @NM00071
@NM00070 EQU   IOPLMDDR+6
@NM00069 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00068 EQU   IOPLMDF4
@NM00067 EQU   IOPLMDF3
@NM00066 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00065 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00064 EQU   IOPLMDDR
@NM00063 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPCQMAX EQU   IOPCQMAP+12
@NM00060 EQU   IOPCQMAP+11
@NM00059 EQU   IOPCQMAP+8
@NM00058 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00057 EQU   IOPSCMAP+11
@NM00056 EQU   IOPSCMAP+8
@NM00055 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00054 EQU   IOPNTMAX+11
@NM00053 EQU   IOPNTMAX+8
@NM00052 EQU   IOPNTMAX
@NM00051 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00050+5
IOPIPTF3 EQU   @NM00050
CCAEND   EQU   HMASMCCA+371
@NM00024 EQU   HMASMCCA+309
@NM00023 EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
@NM00022 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00021 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00020 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00019 EQU   CCAFLAG5
@NM00018 EQU   CCAFLAG4
@NM00017 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00016 EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00015 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCAUPDU  EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00014 EQU   @NM00009+18
@NM00013 EQU   @NM00009+16
CCATBLPA EQU   @NM00009+12
@NM00012 EQU   @NM00009+8
@NM00011 EQU   @NM00009+4
@NM00010 EQU   @NM00009
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00008 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAIOPTR EQU   CCAFIOP
@NM00007 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00006 EQU   CCAFBUFR+122
@NM00005 EQU   CCAFBUFR+120
@NM00004 EQU   CCAFBUFR+118
@NM00003 EQU   CCAFBUFR+88
@NM00002 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00001 EQU   CCAFBUFR+52
CCAID    EQU   HMASMCCA
@NM00264 EQU   SVAREAS+12
@NM00263 EQU   SVAREAS
@NM00262 EQU   CCWS+1
@NM00256 EQU   ENQRTNAR
CVTLTCB  EQU   @NM00255+4
@NM00212 EQU   PDSARRY1+9
@NM00211 EQU   PDSSW
@NM00210 EQU   PDSARRY1+4
@NM00209 EQU   PDSARRY1
@NM00207 EQU   DCBEROPT
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00203 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
IOBERRCT EQU   IOBSTDRD+30
IOBRSV19 EQU   IOBINCAM+1
IOBOLTST EQU   IOBBTAMF
IOBRFTMG EQU   IOBBTAMF
IOBRSV17 EQU   IOBBTAMF
IOBRSV16 EQU   IOBBTAMF
IOBRSV15 EQU   IOBBTAMF
IOBRSV14 EQU   IOBBTAMF
IOBINUSE EQU   IOBBTAMF
IOBPRMER EQU   IOBBTAMF
IOBRSTRB EQU   IOBRESTR+1
IOBREPOS EQU   IOBRESTR
IOBDCBPB EQU   IOBDCBPT+1
IOBRSV44 EQU   IOBFLAG4
IOBJES3I EQU   IOBFLAG4
IOBRSV42 EQU   IOBFLAG4
IOBRSV41 EQU   IOBFLAG4
IOBRSV40 EQU   IOBFLAG4
IOBPMERR EQU   IOBFLAG4
IOBCC3WE EQU   IOBFLAG4
IOBGDPOL EQU   IOBFLAG4
IOBSTRTB EQU   IOBSTART+1
IOBSIOCC EQU   IOBSTART
IOBCSB7  EQU   IOBCSTAT
IOBCSB6  EQU   IOBCSTAT
IOBCSB5  EQU   IOBCSTAT
IOBCSB4  EQU   IOBCSTAT
IOBCSB3  EQU   IOBCSTAT
IOBCSB2  EQU   IOBCSTAT
IOBCSB1  EQU   IOBCSTAT
IOBCSB0  EQU   IOBCSTAT
IOBUSB7  EQU   IOBUSTAT
IOBUSB6  EQU   IOBUSTAT
IOBUSB5  EQU   IOBUSTAT
IOBUSB4  EQU   IOBUSTAT
IOBUSB3  EQU   IOBUSTAT
IOBUSB2  EQU   IOBUSTAT
IOBUSB1  EQU   IOBUSTAT
IOBUSB0  EQU   IOBUSTAT
IOBCMDA  EQU   IOBIOCSW
IOBLOG   EQU   IOBFL3
IOBJAM   EQU   IOBICL
IOBMSG   EQU   IOBFL3
IOBSDR   EQU   IOBCNC
IOBACU   EQU   IOBFL3
IOBCDC   EQU   IOBFL3
IOBICC   EQU   IOBFL3
IOBCCC   EQU   IOBFL3
IOBECBPB EQU   IOBECBPT+1
IOBECBCC EQU   IOBECBPT
IOBS1B7  EQU   IOBSENS1
IOBS1B6  EQU   IOBSENS1
IOBS1B5  EQU   IOBSENS1
IOBS1B4  EQU   IOBSENS1
IOBS1B3  EQU   IOBSENS1
IOBS1B2  EQU   IOBSENS1
IOBS1B1  EQU   IOBSENS1
IOBS1B0  EQU   IOBSENS1
IOBSNSC9 EQU   IOBS0B7
IOBS0B6  EQU   IOBSENS0
IOBS0B5  EQU   IOBSENS0
IOBS0B4  EQU   IOBSENS0
IOBS0B3  EQU   IOBSENS0
IOBS0B2  EQU   IOBSENS0
IOBS0B1  EQU   IOBSENS0
IOBS0B0  EQU   IOBSENS0
IOBPNCH  EQU   IOBFLAG2
IOBSTATO EQU   IOBFLAG2
IOBSKUPD EQU   IOBFLAG2
IOBALTTR EQU   IOBFLAG2
IOBRRT2  EQU   IOBRDHA0
IOBRRT3  EQU   IOBPURGE
IOBSENSE EQU   IOBFLAG2
IOBHALT  EQU   IOBFLAG2
IOBSPSVC EQU   IOBRSTRT
IOBUNREL EQU   IOBFLAG1
IOBIOERR EQU   IOBFLAG1
IOBFCREX EQU   IOBCYCCK
IOBRPSTN EQU   IOBFLAG1
IOBERRTN EQU   IOBFLAG1
IOBCMDCH EQU   IOBFLAG1
IOBDATCH EQU   IOBFLAG1
IOBCNOPA EQU   IOBPREFX+12
IOBCICB  EQU   IOBPREFX+8
IOBCECB  EQU   IOBPREFX+4
IOBCONOP EQU   IOBPREFX+3
IOBCINOP EQU   IOBPREFX+2
IOBRSV05 EQU   IOBPREFX+1
IOBPCI   EQU   IOBCFLG1
IOBRSTCH EQU   IOBCFLG1
IOBABAPP EQU   IOBCFLG1
IOBPTST  EQU   IOBCFLG1
IOBRSV04 EQU   IOBCFLG1
IOBRSV03 EQU   IOBCFLG1
IOBRSV02 EQU   IOBCFLG1
IOBRSV01 EQU   IOBCFLG1
DCBNOTE  EQU   DCBCNTRL
@NM00202 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00201 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00200 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00199 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00198 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00197 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
@NM00196 EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBREAD  EQU   DCBWRITE
@NM00195 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
@NM00194 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBIBPCT EQU   DCBIFLG
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00193 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00192 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00191 EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00190 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGPO EQU   DCBDSRG1
DCBDSGMQ EQU   DCBDSRG1
DCBDSGCQ EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBTRBAL EQU   IHADCS01+6
@NM00189 EQU   IHADCS01+5
@NM00188 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00187 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
@NM00186 EQU   IHADCB
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00183 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBPASS EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCSIOTS EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBPCC  EQU   JSCBSEC1+16
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00182 EQU   IEZJSCB
@NM00181 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBRV143 EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00180 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBRV327 EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBRV326 EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBSTAWA EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBCCPVI EQU   TCBXSCT+2
TCBRV325 EQU   TCBXSCT+1
TCBRV324 EQU   TCBXSCT1
TCBRV323 EQU   TCBXSCT1
TCBRV322 EQU   TCBXSCT1
TCBRV321 EQU   TCBXSCT1
TCBRV320 EQU   TCBXSCT1
TCBRV319 EQU   TCBXSCT1
TCBS3A   EQU   TCBXSCT1
TCBACTIV EQU   TCBXSCT1
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00179 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00178 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00177 EQU   CVTFIX+248
@NM00176 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTBAH   EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTRV490 EQU   CVTMAP+388
CVTSU    EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTVS1B  EQU   CVTOPTB
CVTVS1A  EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVT      EQU   CVTMAP
PRLCONC  EQU   PRLTIME+2
@NM00172 EQU   PRLTIME
@NM00171 EQU   PRLFLGS
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00156 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00155 EQU   @NM00154+7
IOPQSMFM EQU   @NM00154
@NM00074 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00049 EQU   IOPUSERL
@NM00048 EQU   IOPUSERL
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00047 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00046 EQU   @NM00043+10
@NM00045 EQU   @NM00044+7
IOPPTFNM EQU   @NM00044
IOPNAM17 EQU   IOPNAME
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00042 EQU   CCABLDLM+2
@NM00041 EQU   CCABLDLM
CCAUPDPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00039+12
CCAUPDTE EQU   @NM00039+8
CCAUPDNM EQU   @NM00039
CCASUPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00037+12
CCAIOSUP EQU   @NM00037+8
CCASUPNM EQU   @NM00037
CCAZAPPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00035+12
CCASPZAP EQU   @NM00035+8
CCAZAPNM EQU   @NM00035
CCACOMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00033+12
CCACOMRS EQU   @NM00033+8
CCACOMNM EQU   @NM00033
CCACPYPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00031+12
CCACOPY  EQU   @NM00031+8
CCACPYNM EQU   @NM00031
CCAASMPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00029+12
CCAASM   EQU   @NM00029+8
CCAASMNM EQU   @NM00029
CCALKDPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00027+12
CCALKED  EQU   @NM00027+8
CCALKDNM EQU   @NM00027
CCAPGMPM EQU   @NM00025+24
@NM00026 EQU   @NM00025+21
CCABPGRC EQU   @NM00025+20
CCABPGSP EQU   @NM00025+12
CCABPGAD EQU   @NM00025+8
CCABPGNM EQU   @NM00025
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00349 EQU   BADEXIT
@RT00354 EQU   EXIT
@RT00369 EQU   EXIT
@RC00364 EQU   @RC00361
@RT00392 EQU   EXIT
@RT00435 EQU   CLOSFAIL
@RT00449 EQU   CLOSFAIL
@RT00474 EQU   OPENFAIL
@RT00477 EQU   CLOSFAIL
@RF00483 EQU   GOODEXIT
@RT00491 EQU   CLOSFAIL
@RT00513 EQU   CLOSFAIL
@RT00525 EQU   CLOSFAIL
@RF00546 EQU   BADEXIT
@RT00575 EQU   EXIT
@RT00590 EQU   EXIT
@RT00595 EQU   OPENFAIL
@RT00603 EQU   NODDMSG
@RT00609 EQU   OPENFAIL
@RF00616 EQU   GOODEXIT
@RC00619 EQU   GOODEXIT
@RC00626 EQU   EXIT
@RC00637 EQU   PDSRTNS
@RC00648 EQU   PDSRTNS
@RC00687 EQU   PDSRTNS
@RC00698 EQU   PDSRTNS
@RT00747 EQU   EXIT
@RF00761 EQU   GOODEXIT
@RT00836 EQU   CLOSFAIL
@RT00840 EQU   CLOSFAIL
@RF00831 EQU   EXIT
@RC00867 EQU   EXIT
@RT00893 EQU   EXIT
@RT00902 EQU   GOODEXIT
@RT00918 EQU   GOODEXIT
@RT00920 EQU   EXIT
@RT00926 EQU   EXIT
@RT00936 EQU   GOODEXIT
@RF00961 EQU   EXIT
@RF00965 EQU   EXIT
@RC00963 EQU   EXIT
@RC00993 EQU   GOODEXIT
@RT01009 EQU   GOODEXIT
@RC01080 EQU   EXIT
@RC01078 EQU   EXIT
@RC01061 EQU   EXIT
@RT01111 EQU   OPENFAIL
@RC01116 EQU   EXIT
@RC01114 EQU   EXIT
@RC01121 EQU   EXIT
@RC01127 EQU   EXIT
@RC01125 EQU   EXIT
@RC01137 EQU   EXIT
@RC01135 EQU   EXIT
@RC01143 EQU   EXIT
@RC01141 EQU   EXIT
@RT01158 EQU   CLOSFAIL
@RC01165 EQU   EXIT
@RF01185 EQU   EXIT
@RF01155 EQU   ANYDDRTN
@RC01260 EQU   EXIT
@RC01267 EQU   EXIT
@RT01279 EQU   CLOSFAIL
@RT01290 EQU   CLOSFAIL
@RF01287 EQU   BADEXIT
@RC01311 EQU   @EL00002
@RC01306 EQU   @EL00002
@RC01301 EQU   @EL00002
@RC01296 EQU   @EL00002
@RF01381 EQU   @EL00003
@RF01397 EQU   @EL00003
@RF01408 EQU   @EL00004
@RF01416 EQU   @EL00004
@RF01591 EQU   @EL00009
@RF01624 EQU   @EL00009
@RC01654 EQU   @EL00012
@RC01662 EQU   @EL00012
@RF01678 EQU   @EL00012
@RT01704 EQU   EOFBLDL
@RF01713 EQU   @EL00013
@RF01732 EQU   @EL00014
@RT01813 EQU   IOINIT0
@RF01813 EQU   EXIT
@RF01130 EQU   @RC01127
@RF01665 EQU   @RC01662
@ENDDATA EQU   *
         END   HMASMIO,(C'PLS2032',0802,78334)

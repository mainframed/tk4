         TITLE 'HMASMMSG - SMP MESSAGE MODULE'
HMASMMSG CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMMSG  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         MVC   @PC00001(4),0(@01)                                  0001
         EJECT
*                                                                  0185
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RE-ENTRY AND ADJUST SAVE AREAS                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0185
*   IF ENTERED=ON                   /* IS THIS SECOND ENTRY?         */
*     THEN                          /* YES - CHECK FURTHER FOR       */
         TM    ENTERED,B'10000000'                                 0185
         BNO   @RF00185                                            0185
*     DO;                           /* THIRD ENTRY                   */
*       IF REENTERD=ON              /* IF THIRD ENTRY,               */
*         THEN                      /* EXIT TO CALLER                */
         TM    REENTERD,B'01000000'                                0187
         BO    @RT00187                                            0187
*         RETURN;                   /* RETURN                        */
*       REENTERD=ON;                /* INDICATE RE-ENTERED           */
         OI    REENTERD,B'01000000'                                0189
*       R1=ADDR(SVAREA2);           /* POINT TO RE-ENTRY SAVE AREA   */
         LA    R1,SVAREA2                                          0190
*     END;                                                         0191
*   ELSE                            /* OTHERWISE - USE PRIMARY SV    */
*     DO;                                                          0192
         B     @RC00185                                            0192
@RF00185 DS    0H                                                  0193
*       R1=ADDR(SVAREA1);           /* POINT TO PRIME SAVE AREA      */
         LA    R1,SVAREA1                                          0193
*       ENTERED=ON;                 /* INDICATE PRIMARY ENTRY        */
         OI    ENTERED,B'10000000'                                 0194
*     END;                                                         0195
*   SVBACK=R13;                     /* CHAIN BACKWARD                */
@RC00185 ST    R13,SVBACK(,R1)                                     0196
*   RFY                                                            0197
*     SVMAP BASED(R13);                                            0197
*   SVFWRD=R1;                      /* CHAIN FORWARD                 */
         ST    R1,SVFWRD(,R13)                                     0198
*   R13=R1;                         /* SET UP NEW SAVE AREA          */
         LR    R13,R1                                              0199
*   RFY                                                            0200
*     R1 UNRSTD;                                                   0200
*                                                                  0200
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION AND PARM(HMASMMGP) SAVE                @SA75296*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0201
*   IOPPTR=ADDR(IOP);               /* SET PTR TO IOP                */
         LA    IOPPTR,IOP                                          0201
*   IOPBUFAD=ADDR(PRL);             /* SET PTR IN IOP TO PRL         */
         LA    @10,PRL                                             0202
         ST    @10,IOPBUFAD(,IOPPTR)                               0202
*   IOPFUNCT=IOPWRITE;              /* INITIALIZE 'WRITE' OPERATION  */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0203
*   PRLFLGS=ZERO;                   /* CLEAR FLAGS IN PRL            */
         MVI   PRLFLGS(@10),X'00'                                  0204
*   MSGRTNCD=ZERO;                  /* SET GOOD RETURN CODE  @Z67SP00*/
         SLR   MSGRTNCD,MSGRTNCD                                   0205
*   IF REENTERD=ON                  /* SECOND ENTRY?         @SA75296*/
*     THEN                          /* YES                   @SA75296*/
         TM    REENTERD,B'01000000'                                0206
         BNO   @RF00206                                            0206
*     SAVMGP2=HMASMMGP;             /* SAVE MGP PARM         @ZD00001*/
         L     @10,@PC00001                                        0207
         MVC   SAVMGP2(12),HMASMMGP(@10)                           0207
*   ELSE                            /* MUST BE FIRST ENTRY   @SA75296*/
*     SAVMGP1=HMASMMGP;             /* SAVE MGP PARM         @ZD00001*/
         B     @RC00206                                            0208
@RF00206 L     @10,@PC00001                                        0208
         MVC   SAVMGP1(12),HMASMMGP(@10)                           0208
         EJECT
         EJECT
*                                                                  0209
*   /*****************************************************************/
*   /*                                                               */
*   /* USING THE VAULES IN THE MGPMGNOX VARIABLES AS INDICIES INTO   */
*   /* EITHER THE PRIMARY MESSAGE NUMBER LIST(FOR MGPMGNO1) OR INTO  */
*   /* THE SECONDARY AND TERCIARY MESSAGE NUMBER LIST(FOR MGPMGNO2   */
*   /* AND MGPMGNO3) BUILD THE CONCATENATED MESSAGE IN A BUFFER AREA */
*   /* WHEN ONE OF THE MGPMGNOX IS A ZERO THEN THAT INDICATES THAT   */
*   /* THERE ARE NO MORE PARTS TO BE CONCATENATED. FOR THE FIRST PART*/
*   /* THE EXTERNAL MESSAGE NUMBER IS PLACED IN THE FIRSTS BUFFER    */
*   /* POSITIONS. THE EXTERNAL NUMBER IS ONE LESS THAT THE NUMBER IN */
*   /* MGPMGNO1(EX. MGPMGNO1=34, EXTERNAL MESSAGE NUMBER = HMA233I). */
*   /*                                                       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0209
*   DO I=1 TO DIM(MSGNDX) WHILE(    /* PUT TOGETHER MSG      @Z67SP00*/
*         MSGNDX(I)^=ZERO           /* ALL SPEC. MSG PARTS   @Z67SP00*/
*         &MSGRTNCD<LONGMSG);       /* TILL END OR ERR       @Z67SP00*/
@RC00206 LA    I,1                                                 0209
@DL00209 LR    @10,I                                               0209
         ALR   @10,@10                                             0209
         L     @08,@PC00001                                        0209
         BCTR  @10,0                                               0209
         BCTR  @10,0                                               0209
         LH    @10,MSGNDX(@10,@08)                                 0209
         LTR   @10,@10                                             0209
         BZ    @DC00209                                            0209
         CH    MSGRTNCD,@CH00054                                   0209
         BNL   @DC00209                                            0209
*     IF I=1 THEN                   /* INITIALIZE BUFFER IF FIRST MSG
*                                      SECTION                       */
         CH    I,@CH00044                                          0210
         BNE   @RF00210                                            0210
*       DO;                                                        0211
*         MSGPTR=DC1PMSG(MSGNDX(I));/* ADDR OF PRIM MSG      @Z67SP00*/
         SLA   @10,2                                               0212
         L     @15,@CA01347                                        0212
         AL    @15,@CF01363                                        0212
         L     MSGPTR,DC1PMSG-DC1PMSG(@10,@15)                     0212
*         MSGHDR=SYSMSGNO;          /* MOVE IN CONSTANT      @ZD00001*/
         L     @10,IOPBUFAD(,IOPPTR)                               0213
         MVC   MSGHDR(11,@10),SYSMSGNO                             0213
*         MSGHDRSV=SEVERITY(MGPTYPE);/* APPEND SPECIFIED SEVERITY TO
*                                      MSGID                 @Z67SP00*/
         SLR   @01,@01                                             0214
         IC    @01,MGPTYPE(,@08)                                   0214
         LA    @15,SEVERITY-1(@01)                                 0214
         MVC   MSGHDRSV(1,@10),0(@15)                              0214
*         MSGNO=MGPMGNO1+PAD;       /* ADD PADDING FACTOR    @ZD00001*/
         LA    MSGNO,199                                           0215
         AH    MSGNO,MGPMGNO1(,@08)                                0215
*         CVD(MSGNO,DECNO);         /* CONVERT MSG #         @ZD00001*/
         CVD   MSGNO,@TS00001                                      0216
         MVC   DECNO(3),@TS00001+5                                 0216
*         UNPK(MSGHDRNO,DECNO);     /*                       @ZD00001*/
         UNPK  MSGHDRNO(3,@10),DECNO(3)                            0217
*         MSGHDRZN=MSGHDRZN×ZONE;   /* REMOVE ZONE FROM NO.  @ZD00001*/
         OI    MSGHDRZN(@10),C'0'                                  0218
*         IF MGPTYPE=MGPERR         /* IF ERR TYPE MSG       @Z67SP00*/
*             ×MGPTYPE=MGPSEV       /* OR SEVERE             @Z67SP00*/
*             ×MGPTYPE=MGPTERM      /* OR TERMINATING        @Z67SP00*/
*           THEN                                                   0219
         CLI   MGPTYPE(@08),3                                      0219
         BE    @RT00219                                            0219
         CLI   MGPTYPE(@08),4                                      0219
         BE    @RT00219                                            0219
         CLI   MGPTYPE(@08),5                                      0219
         BNE   @RF00219                                            0219
@RT00219 DS    0H                                                  0220
*           MSGHDRHL=HILIMGP;       /* FLAG ERRORS WITH AST. @ZD00001*/
         L     @10,IOPBUFAD(,IOPPTR)                               0220
         MVC   MSGHDRHL(2,@10),@CC01271                            0220
*         CURLEN=DATASTRT;          /* UPDATE LENGTH         @SA75296*/
@RF00219 MVI   CURLEN,X'0C'                                        0221
*       END;                                                       0222
*     ELSE                                                         0223
*       MSGPTR=DC1SMSG(MSGNDX(I));  /* POINT TO SECONDARY    @Z67SP00*/
         B     @RC00210                                            0223
@RF00210 LR    @10,I                                               0223
         ALR   @10,@10                                             0223
         L     @08,@PC00001                                        0223
         BCTR  @08,0                                               0223
         BCTR  @08,0                                               0223
         LH    @10,MSGNDX(@10,@08)                                 0223
         SLA   @10,2                                               0223
         L     @08,@CA01348                                        0223
         AL    @08,@CF01363                                        0223
         L     MSGPTR,DC1SMSG-DC1SMSG(@10,@08)                     0223
*     IF CURLEN+MSGLEN-1>LOGLIM     /* CHECK IF TOO LONG     @SA75296*/
*       THEN                        /*                       @Z67SP00*/
@RC00210 SLR   @10,@10                                             0224
         IC    @10,CURLEN                                          0224
         SLR   @08,@08                                             0224
         IC    @08,MSGLEN(,MSGPTR)                                 0224
         ALR   @10,@08                                             0224
         BCTR  @10,0                                               0224
         CH    @10,@CH01247                                        0224
         BNH   @RF00224                                            0224
*       DO;                                                        0225
*         MSGRTNCD=LONGMSG;         /* SET RETURN CODE       @SA74329*/
         LA    MSGRTNCD,8                                          0226
*       END;                                                       0227
*     ELSE                          /*                       @Z67SP00*/
*       DO;                         /*                       @Z67SP00*/
         B     @RC00224                                            0228
@RF00224 DS    0H                                                  0229
*         PRLDATA(CURLEN:CURLEN+MSGLEN-1)=MSGTEXT(1:MSGLEN);/* MOVE
*                                      MESSAGE SECTION       @SA75296*/
         SLR   @10,@10                                             0229
         IC    @10,CURLEN                                          0229
         L     @08,IOPBUFAD(,IOPPTR)                               0229
         ALR   @10,@08                                             0229
         SLR   @07,@07                                             0229
         IC    @07,MSGLEN(,MSGPTR)                                 0229
         LR    @15,@07                                             0229
         BCTR  @15,0                                               0229
         EX    @15,@SM01364                                        0229
*         PRLDATA(CURLEN+MSGLEN)=BLANK;/* CLEAR BUFFER       @SA75296*/
         SLR   @10,@10                                             0230
         IC    @10,CURLEN                                          0230
         ALR   @10,@07                                             0230
         ALR   @08,@10                                             0230
         MVI   PRLDATA-1(@08),C' '                                 0230
*         CURLEN=CURLEN+MSGLEN+1;   /* UPDATE CURRENT LENGTH @SA75296*/
         LA    @10,1(,@10)                                         0231
         STC   @10,CURLEN                                          0231
*       END;                        /*                       @Z67SP00*/
*   END;                                                           0233
@RC00224 AH    I,@CH00044                                          0233
         CH    I,@CH00056                                          0233
         BNH   @DL00209                                            0233
@DC00209 DS    0H                                                  0234
         EJECT
*                                                                  0234
*   /*****************************************************************/
*   /*                                                               */
*   /* MESSAGE PARTS HAVE BEEN CONCATENATED. NOW SCAN THRU MESSAGE   */
*   /* LOOKING FOR ANY REQUESTS FOR VARIABLE PARTS(INDICATED BY ONE  */
*   /* OR MORE POUND SIGNS IN MESSAGE). EACH SET OF POUND SIGNS IS   */
*   /* ONE VARIABLE PART. THE LENGTH OF THE POUND SIGN STRING IS     */
*   /* DETERMINED THEN THAT MANY CHARACTERS FOR THE AREA POINTED TO  */
*   /* BY THE APPROPRIATE MGPVARPT(X) IS MOVED INTO THE MESSAGE. X IS*/
*   /* DETERMINED BY THE NUMBER OF GROUPS OF POUND SIGNS FOUND WITHIN*/
*   /* THE MESSAGE                                           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0234
*   CURLEN=CURLEN-2;                /* INIT MAX LENGTH       @SA75296*/
         SLR   @10,@10                                             0234
         IC    @10,CURLEN                                          0234
         BCTR  @10,0                                               0234
         BCTR  @10,0                                               0234
         STC   @10,CURLEN                                          0234
*   VARLEN=ZERO;                    /* INITIALIZE VARIBLE FIELD    0235
*                                      LENGTH                        */
         SLR   VARLEN,VARLEN                                       0235
*   VARNDX=ONE;                     /* INITIALIZE VARIABLE FIELD   0236
*                                      INDEX                         */
         LA    VARNDX,1                                            0236
*   DO I=DATASTRT TO CURLEN BY 1;   /* SCAN MESSAGE          @ZD00001*/
         LA    I,12                                                0237
         B     @DE00237                                            0237
@DL00237 DS    0H                                                  0238
*     IF PRLDATA(I)=POUND THEN      /* SEARCH FOR #                  */
         L     @10,IOPBUFAD(,IOPPTR)                               0238
         ALR   @10,I                                               0238
         CLI   PRLDATA-1(@10),C'#'                                 0238
         BNE   @RF00238                                            0238
*       DO;                                                        0239
*         VARLEN=VARLEN+1;          /* INCREMENT VAR FIELD LENGTH    */
         LA    @10,1                                               0240
         ALR   VARLEN,@10                                          0240
*         IF I=CURLEN THEN          /* SAVE LENGTH LIMIT     @SA75296*/
         SLR   @08,@08                                             0241
         IC    @08,CURLEN                                          0241
         CR    I,@08                                               0241
         BNE   @RF00241                                            0241
*           DO;                                                    0242
*             I=I+1;                /* UPDATE POINTER                */
         ALR   I,@10                                               0243
*             GO TO FILLIN;         /* FILL IN CHARACTERS            */
         B     FILLIN                                              0244
*           END;                                                   0245
*         ELSE                                                     0246
*           GO TO NEXTCHAR;         /* CONTINUE SCAN                 */
*       END;                                                       0247
*     IF PRLDATA(I-1)=POUND THEN    /* END OF VARIABLE FIELD         */
@RF00238 L     @10,IOPBUFAD(,IOPPTR)                               0248
         ALR   @10,I                                               0248
         CLI   PRLDATA-2(@10),C'#'                                 0248
         BNE   @RF00248                                            0248
*       DO;                                                        0249
*FILLIN:                            /* FILL IN VARIABLE FIELD        */
*         VARSTART=I-VARLEN;        /* POINT TO START OF VAR FIELD   */
FILLIN   LR    VARSTART,I                                          0250
         SLR   VARSTART,VARLEN                                     0250
*         PRLDATA(VARSTART:I-1)=VARSTRNG(1:VARLEN);/* MOVE VARIABLE
*                                      FIELD                         */
         L     @10,IOPBUFAD(,IOPPTR)                               0251
         ALR   @10,VARSTART                                        0251
         LR    @15,I                                               0251
         SLR   @15,VARSTART                                        0251
         BCTR  @15,0                                               0251
         LR    @14,VARNDX                                          0251
         SLA   @14,2                                               0251
         L     @03,@PC00001                                        0251
         L     @01,MGPVARPT-4(@14,@03)                             0251
         EX    @15,@SM01366                                        0251
*         VARNDX=VARNDX+1;          /* INCREMENT TO NEXT VAR FIELD   */
         LA    VARNDX,1(,VARNDX)                                   0252
*         VARLEN=ZERO;              /* RESET VARIABLE LENGTH FIELD   */
         SLR   VARLEN,VARLEN                                       0253
*       END;                                                       0254
*NEXTCHAR:                                                         0255
*   END;                                                           0255
@RF00248 DS    0H                                                  0255
NEXTCHAR AH    I,@CH00044                                          0255
@DE00237 SLR   @10,@10                                             0255
         IC    @10,CURLEN                                          0255
         CR    I,@10                                               0255
         BNH   @DL00237                                            0255
         EJECT
*                                                                  0256
*   /*****************************************************************/
*   /*                                                               */
*   /* MESSAGE BUILT AND ALL VARIABLE PARTS FILLED IN. NOW SCAN THRU */
*   /* MESSAGE TO COMPRESS OUT ANY MULTIPLE BLANKS           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0256
*   DO INDEX=DATASTRT TO CURLEN WHILE INDEX+1<=CURLEN;/*     @ZD00001*/
         LA    INDEX,12                                            0256
         B     @DE00256                                            0256
@DL00256 SLR   @10,@10                                             0256
         IC    @10,CURLEN                                          0256
         LA    @08,1                                               0256
         ALR   @08,INDEX                                           0256
         CR    @08,@10                                             0256
         BH    @DC00256                                            0256
*     IF PRLDATA(INDEX:INDEX+1)=TWOBLANK/* TWO BLANKS IN A ROW?    0257
*                                                            @Z67SP00*/
*       THEN                                                       0257
         L     @08,IOPBUFAD(,IOPPTR)                               0257
         LR    @06,@08                                             0257
         ALR   @06,INDEX                                           0257
         CLC   PRLDATA-1(2,@06),@CC01258                           0257
         BNE   @RF00257                                            0257
*       DO;                         /* REMOVE BLANK AND ADJUST LENGTH
*                                                            @ZD00001*/
*         PRLDATA(INDEX:CURLEN-1)=PRLDATA(INDEX+1:CURLEN);/* @SA75296*/
         LR    @06,@08                                             0259
         ALR   @06,INDEX                                           0259
         LR    @15,@10                                             0259
         SLR   @15,INDEX                                           0259
         BCTR  @15,0                                               0259
         ALR   @08,INDEX                                           0259
         MVC   @TS00001(256),PRLDATA(@08)                          0259
         EX    @15,@SM01368                                        0259
*         CURLEN=CURLEN-1;          /*                       @SA75296*/
         BCTR  @10,0                                               0260
         STC   @10,CURLEN                                          0260
*         INDEX=INDEX-1;                                           0261
         BCTR  INDEX,0                                             0261
*       END;                                                       0262
*   END;                                                           0263
@RF00257 AH    INDEX,@CH00044                                      0263
@DE00256 SLR   @10,@10                                             0263
         IC    @10,CURLEN                                          0263
         CR    INDEX,@10                                           0263
         BNH   @DL00256                                            0263
@DC00256 DS    0H                                                  0264
         EJECT
*                                                                  0264
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE TO LOG ROUTINE                                  @SA99994*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0264
*   IF(MGPHLDS=ON                   /* IF MSG TO LOG         @Z67SP00*/
*       ×                           /* OR TO                 @Z67SP00*/
*       (MGPPRINT=ON&CCAOUTNG=ON))  /* PRINT BUT PRINT DEAD  @Z67SP00*/
*       &CCALOGNG=OFF               /* AND NO PREV LOG ERROR @Z67SP00*/
*       &MSGRTNCD<LONGMSG           /* AND NO SEVERE ERR?    @Z67SP00*/
*     THEN                          /* YES                   @SA99994*/
         L     @10,@PC00001                                        0264
         TM    MGPHLDS(@10),B'00010000'                            0264
         BO    @GL00005                                            0264
         TM    MGPPRINT(@10),B'10000000'                           0264
         BNO   @RF00264                                            0264
         L     @10,@CA00069                                        0264
         TM    CCAOUTNG-HMASMCCA(@10),B'01000000'                  0264
         BNO   @RF00264                                            0264
@GL00005 L     @10,@CA00069                                        0264
         TM    CCALOGNG-HMASMCCA(@10),B'10000000'                  0264
         BNZ   @RF00264                                            0264
         CH    MSGRTNCD,@CH00054                                   0264
         BNL   @RF00264                                            0264
*     DO;                           /*                       @SA99994*/
*       IOPDSID=IOPHLDS;            /* LOG DATA SET          @SA99994*/
         MVI   IOPDSID(IOPPTR),X'01'                               0266
*       PRLRLEN=CURLEN+10;          /* LOG MSG LENGTH        @SA75296*/
         L     @10,IOPBUFAD(,IOPPTR)                               0267
         LA    @08,10                                              0267
         SLR   @06,@06                                             0267
         IC    @06,CURLEN                                          0267
         ALR   @08,@06                                             0267
         STH   @08,PRLRLEN(,@10)                                   0267
*       CALL HMASMIO(HMASMIOP);     /* WRITE MSG             @SA99994*/
         ST    IOPPTR,@AL00001                                     0268
         L     @15,@CV01281                                        0268
         LA    @01,@AL00001                                        0268
         BALR  @14,@15                                             0268
*       IF IOPRETRN^=IOPGOOD        /* WRITE OK?             @YA07506*/
*         THEN                      /* NO                    @SA99994*/
         CLI   IOPRETRN(IOPPTR),0                                  0269
         BE    @RF00269                                            0269
*         MSGRTNCD=IOPIOERR;        /* SET RETURN CODE       @Z67SP00*/
         LA    MSGRTNCD,16                                         0270
*       IF REENTERD=ON              /* RE-ENTRY?             @Z67SP00*/
*         THEN                      /* YES                   @Z67SP00*/
@RF00269 TM    REENTERD,B'01000000'                                0271
         BNO   @RF00271                                            0271
*         HMASMMGP=SAVMGP2;         /* RESTORE PROPER MGP    @ZD00001*/
         L     @10,@PC00001                                        0272
         MVC   HMASMMGP(12,@10),SAVMGP2                            0272
*       ELSE                        /* PRIMARY ENTRY         @Z67SP00*/
*         HMASMMGP=SAVMGP1;         /* RESTORE PROPER MGP    @ZD00001*/
         B     @RC00271                                            0273
@RF00271 L     @10,@PC00001                                        0273
         MVC   HMASMMGP(12,@10),SAVMGP1                            0273
*     END;                          /* END WRITE TO LOG GROUP      0274
*                                                            @SA99994*/
@RC00271 DS    0H                                                  0275
         EJECT
*                                                                  0275
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE TO SMPOUT, SMPLIST, SMPRPT, WTO, WTP, AND WTOR  @SA99994*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0275
*   IF MSGRTNCD<LONGMSG             /* IF NO SEVERE ERR?     @Z67SP00*/
*     THEN                          /* YES                   @SA99994*/
@RF00264 CH    MSGRTNCD,@CH00054                                   0275
         BNL   @RF00275                                            0275
*     DO;                           /*                       @SA99994*/
*       EXTSW=OFF;                  /* SET EXTENDED SW       @SA99994*/
*                                                                  0277
         NI    EXTSW,B'11011111'                                   0277
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP WRITING LINES UNTIL ALL OF MESSAGE HAS BEEN WRITTEN  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0278
*       DO UNTIL EXTSW=OFF;         /* DO AT LEAST ONCE AND THEN AS
*                                      MANY MORE TIMES AS REQUIRED 0278
*                                                            @Z67SP00*/
*                                                                  0278
@DL00278 DS    0H                                                  0279
*         /***********************************************************/
*         /*                                                         */
*         /* CALCULATE LENGTH OF LINE TO PRINT               @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0279
*         IF CURLEN>PRINTLIM        /* PRINTER LIMIT EXCEEDED      0279
*                                                            @SA75296*/
*           THEN                    /* YES                   @SA99994*/
         CLI   CURLEN,120                                          0279
         BNH   @RF00279                                            0279
*           DO;                     /*                       @SA99994*/
*             DO PRLRLEN=PRINTLIM TO 1 BY-1 WHILE PRLDATA(PRLRLEN)^=
*                   BLANK;          /* BACK UP TO LAST BLANK @SA99994*/
         LA    @10,120                                             0281
         L     @08,IOPBUFAD(,IOPPTR)                               0281
         STH   @10,PRLRLEN(,@08)                                   0281
@DL00281 L     @10,IOPBUFAD(,IOPPTR)                               0281
         LH    @08,PRLRLEN(,@10)                                   0281
         ALR   @10,@08                                             0281
         CLI   PRLDATA-1(@10),C' '                                 0281
         BE    @DC00281                                            0281
*             END;                  /*                       @SA99994*/
         L     @08,IOPBUFAD(,IOPPTR)                               0282
         SLR   @10,@10                                             0282
         BCTR  @10,0                                               0282
         AH    @10,PRLRLEN(,@08)                                   0282
         L     @08,IOPBUFAD(,IOPPTR)                               0282
         STH   @10,PRLRLEN(,@08)                                   0282
         LTR   @10,@10                                             0282
         BP    @DL00281                                            0282
@DC00281 DS    0H                                                  0283
*             PRLRLEN=PRLRLEN-1;    /* BACK UP TO NONBLANK   @SA99994*/
         L     @10,IOPBUFAD(,IOPPTR)                               0283
         LH    @08,PRLRLEN(,@10)                                   0283
         BCTR  @08,0                                               0283
         STH   @08,PRLRLEN(,@10)                                   0283
*             EXTSW=ON;             /* SET EXTENDED SW       @SA99994*/
         OI    EXTSW,B'00100000'                                   0284
*           END;                    /*                       @SA99994*/
*         ELSE                      /* NOT GREATER THAN LIM  @SA99994*/
*           DO;                     /*                       @Z67SP00*/
         B     @RC00279                                            0286
@RF00279 DS    0H                                                  0287
*             PRLRLEN=CURLEN;       /* SET LENGTH            @SA75296*/
         L     @10,IOPBUFAD(,IOPPTR)                               0287
         SLR   @08,@08                                             0287
         IC    @08,CURLEN                                          0287
         STH   @08,PRLRLEN(,@10)                                   0287
*             EXTSW=OFF;            /* STOP WRITE LOOP       @Z67SP00*/
         NI    EXTSW,B'11011111'                                   0288
*           END;                    /*                       @Z67SP00*/
         EJECT
*                                                                  0290
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE LINE TO SMPOUT                            @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0290
*         IF(MGPPRINT=ON            /* IF MSG TO SMPOUT      @Z67SP00*/
*             ×                     /* OR                    @Z67SP00*/
*             (MGPHLDS=ON&CCALOGNG=ON))/* LOG BUT LOG NOGO   @Z67SP00*/
*             &CCAOUTNG=OFF         /* AND NO PREV OUT ERR   @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
@RC00279 L     @10,@PC00001                                        0290
         TM    MGPPRINT(@10),B'10000000'                           0290
         BO    @GL00008                                            0290
         TM    MGPHLDS(@10),B'00010000'                            0290
         BNO   @RF00290                                            0290
         L     @10,@CA00069                                        0290
         TM    CCALOGNG-HMASMCCA(@10),B'10000000'                  0290
         BNO   @RF00290                                            0290
@GL00008 L     @10,@CA00069                                        0290
         TM    CCAOUTNG-HMASMCCA(@10),B'01000000'                  0290
         BNZ   @RF00290                                            0290
*           DO;                     /*                       @Z67SP00*/
*             IOPDSID=IOPPRINT;     /* SET FOR PRINTER       @SA99994*/
         MVI   IOPDSID(IOPPTR),X'0B'                               0292
*             CALL HMASMIO(HMASMIOP);/* DO WRITE             @SA99994*/
         ST    IOPPTR,@AL00001                                     0293
         L     @15,@CV01281                                        0293
         LA    @01,@AL00001                                        0293
         BALR  @14,@15                                             0293
*             MSGRTNCD=MAX(MSGRTNCD,IOPRETRN);/* SAVE RC     @Z67SP00*/
         SLR   @10,@10                                             0294
         IC    @10,IOPRETRN(,IOPPTR)                               0294
         CR    MSGRTNCD,@10                                        0294
         BNL   *+6
         LR    MSGRTNCD,@10                                        0294
*             IF REENTERD=ON        /* RE-ENTRY?             @Z67SP00*/
*               THEN                /* YES                   @Z67SP00*/
         TM    REENTERD,B'01000000'                                0295
         BNO   @RF00295                                            0295
*               HMASMMGP=SAVMGP2;   /* RESTORE PROPER MGP    @ZD00001*/
         L     @10,@PC00001                                        0296
         MVC   HMASMMGP(12,@10),SAVMGP2                            0296
*             ELSE                  /* PRIMARY ENTRY         @Z67SP00*/
*               HMASMMGP=SAVMGP1;   /* RESTORE PROPER MGP    @ZD00001*/
         B     @RC00295                                            0297
@RF00295 L     @10,@PC00001                                        0297
         MVC   HMASMMGP(12,@10),SAVMGP1                            0297
*           END;                    /*                       @Z67SP00*/
*                                                                  0298
@RC00295 DS    0H                                                  0299
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE TO PROGRAMMER ROUTINE                     @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0299
*         IF MGPWTP=ON              /* IS THIS A WTP MESSAGE?      0299
*                                                            @Z67SP00*/
*             ×                     /* OR                    @Z67SP00*/
*             (MGPPRINT=ON&CCAOUTNG=ON)/* OUT BUT OUT DEAD   @Z67SP00*/
*             ×                     /* OR TO                 @Z67SP00*/
*             (MGPHLDS=ON&CCALOGNG=ON&CCAOUTNG=ON)/* LOG BUT LOG IS
*                                      DEAD AND MSG HAS NOT ALREADY
*                                      BEEN ROUTED TO SMPOUT @Z67SP00*/
*           THEN                    /* YES - MUST ISSUE WTP  @Z67SP00*/
@RF00290 L     @10,@PC00001                                        0299
         TM    MGPWTP(@10),B'00000010'                             0299
         BO    @RT00299                                            0299
         TM    MGPPRINT(@10),B'10000000'                           0299
         BNO   @GL00011                                            0299
         L     @10,@CA00069                                        0299
         TM    CCAOUTNG-HMASMCCA(@10),B'01000000'                  0299
         BO    @RT00299                                            0299
@GL00011 L     @10,@PC00001                                        0299
         TM    MGPHLDS(@10),B'00010000'                            0299
         BNO   @RF00299                                            0299
         L     @10,@CA00069                                        0299
         TM    CCALOGNG-HMASMCCA(@10),B'11000000'                  0299
         BNO   @RF00299                                            0299
@RT00299 DS    0H                                                  0300
*           DO;                                                    0300
*             WTPLEN=CURLEN+4;      /* SET WTO LENGTH        @Z67SP00*/
         SLR   @10,@10                                             0301
         IC    @10,CURLEN                                          0301
         LA    @08,4(,@10)                                         0301
         STH   @08,WTPLEN                                          0301
*             MSGHDRSV=WTPMGP;      /* APPEND INFORMATIONAL SEVERITY
*                                      TO MESSAGE ID         @Z67SP00*/
         L     @08,IOPBUFAD(,IOPPTR)                               0302
         MVI   MSGHDRSV(@08),C'I'                                  0302
*             WTPTXT=PRLDATA(1:CURLEN);/* MOVE DATA TO WTO   @Z67SP00*/
         MVI   WTPTXT+1,C' '                                       0303
         MVC   WTPTXT+2(99),WTPTXT+1                               0303
         BCTR  @10,0                                               0303
         EX    @10,@SM01372                                        0303
*             GEN(WTO MF=(E,WTPMSG))                               0304
*             REFS(WTPMSG);         /*                       @Z67SP00*/
         WTO MF=(E,WTPMSG)
*           END;                                                   0305
         EJECT
*                                                                  0306
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE LINE TO SMPLIST IF REQUESTED              @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0306
*         IF MGPLIST=ON             /* IF MSG TO SMPLIST     @Z67SP00*/
*             &CCALISTP=ON          /* AND SMPLIST DD PRES.  @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
@RF00299 L     @10,@PC00001                                        0306
         TM    MGPLIST(@10),B'01000000'                            0306
         BNO   @RF00306                                            0306
         L     @10,@CA00069                                        0306
         TM    CCALISTP-HMASMCCA(@10),B'00010000'                  0306
         BNO   @RF00306                                            0306
*           DO;                     /*                       @Z67SP00*/
*             IOPDSID=IOPLIST;      /* SET FOR SMPLIST       @Z67SP00*/
         MVI   IOPDSID(IOPPTR),X'2A'                               0308
*             CALL HMASMIO(HMASMIOP);/* DO WRITE             @Z67SP00*/
         ST    IOPPTR,@AL00001                                     0309
         L     @15,@CV01281                                        0309
         LA    @01,@AL00001                                        0309
         BALR  @14,@15                                             0309
*             MSGRTNCD=MAX(MSGRTNCD,IOPRETRN);/* SAVE RC     @Z67SP00*/
         SLR   @10,@10                                             0310
         IC    @10,IOPRETRN(,IOPPTR)                               0310
         CR    MSGRTNCD,@10                                        0310
         BNL   *+6
         LR    MSGRTNCD,@10                                        0310
*             IF REENTERD=ON        /* RE-ENTRY?             @Z67SP00*/
*               THEN                /* YES                   @Z67SP00*/
         TM    REENTERD,B'01000000'                                0311
         BNO   @RF00311                                            0311
*               HMASMMGP=SAVMGP2;   /* RESTORE PROPER MGP    @Z67SP00*/
         L     @10,@PC00001                                        0312
         MVC   HMASMMGP(12,@10),SAVMGP2                            0312
*             ELSE                  /* PRIMARY ENTRY         @Z67SP00*/
*               HMASMMGP=SAVMGP1;   /* RESTORE PROPER MGP    @Z67SP00*/
         B     @RC00311                                            0313
@RF00311 L     @10,@PC00001                                        0313
         MVC   HMASMMGP(12,@10),SAVMGP1                            0313
*           END;                    /*                       @Z67SP00*/
*                                                                  0314
@RC00311 DS    0H                                                  0315
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE LINE TO SMPRPT                            @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0315
*         IF MGPRPT=ON              /* IF MSG TO SMPRPT      @Z67SP00*/
*             &CCARPTP=ON           /* AND SMPRPT DD PRESENT @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
@RF00306 L     @10,@PC00001                                        0315
         TM    MGPRPT(@10),B'00100000'                             0315
         BNO   @RF00315                                            0315
         L     @10,@CA00069                                        0315
         TM    CCARPTP-HMASMCCA(@10),B'00001000'                   0315
         BNO   @RF00315                                            0315
*           DO;                     /*                       @Z67SP00*/
*             IOPDSID=IOPRPT;       /* SET FOR SMPRPTR       @Z67SP00*/
         MVI   IOPDSID(IOPPTR),X'29'                               0317
*             CALL HMASMIO(HMASMIOP);/* DO WRITE             @Z67SP00*/
         ST    IOPPTR,@AL00001                                     0318
         L     @15,@CV01281                                        0318
         LA    @01,@AL00001                                        0318
         BALR  @14,@15                                             0318
*             MSGRTNCD=MAX(MSGRTNCD,IOPRETRN);/* SAVE RC     @Z67SP00*/
         SLR   @10,@10                                             0319
         IC    @10,IOPRETRN(,IOPPTR)                               0319
         CR    MSGRTNCD,@10                                        0319
         BNL   *+6
         LR    MSGRTNCD,@10                                        0319
*             IF REENTERD=ON        /* RE-ENTRY?             @Z67SP00*/
*               THEN                /* YES                   @Z67SP00*/
         TM    REENTERD,B'01000000'                                0320
         BNO   @RF00320                                            0320
*               HMASMMGP=SAVMGP2;   /* RESTORE PROPER MGP    @Z67SP00*/
         L     @10,@PC00001                                        0321
         MVC   HMASMMGP(12,@10),SAVMGP2                            0321
*             ELSE                  /* PRIMARY ENTRY         @Z67SP00*/
*               HMASMMGP=SAVMGP1;   /* RESTORE PROPER MGP    @Z67SP00*/
         B     @RC00320                                            0322
@RF00320 L     @10,@PC00001                                        0322
         MVC   HMASMMGP(12,@10),SAVMGP1                            0322
*           END;                    /*                       @Z67SP00*/
@RC00320 DS    0H                                                  0324
         EJECT
*                                                                  0324
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE TO OPERATOR MSG ROUTINE                   @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0324
*         IF(MGPWTO=ON              /* IS THIS A WTO MESSAGE?      0324
*                                                            @Z67SP00*/
*             ×(EXTSW=ON            /* OR FIRST PART OF      @Z67SP00*/
*             &MGPWTOR=ON))         /* WTOR                  @Z67SP00*/
*             &MSGRTNCD<LONGMSG     /* AND SMPOUT WRITE OK?  @Z67SP00*/
*           THEN                    /* YES - MUST ISSUE WTP  @Z67SP00*/
@RF00315 L     @10,@PC00001                                        0324
         TM    MGPWTO(@10),B'00000100'                             0324
         BO    @GL00017                                            0324
         TM    EXTSW,B'00100000'                                   0324
         BNO   @RF00324                                            0324
         TM    MGPWTOR(@10),B'00001000'                            0324
         BNO   @RF00324                                            0324
@GL00017 CH    MSGRTNCD,@CH00054                                   0324
         BNL   @RF00324                                            0324
*           DO;                                                    0325
*             WTOLEN=CURLEN+4;      /* SET WTO LENGTH        @Z67SP00*/
         SLR   @10,@10                                             0326
         IC    @10,CURLEN                                          0326
         LA    @08,4(,@10)                                         0326
         STH   @08,WTOLEN                                          0326
*             MSGHDRSV=WTOMGP;      /* APPEND INFORMATIONAL SEVERITY
*                                      TO MESSAGE ID         @Z67SP00*/
         L     @08,IOPBUFAD(,IOPPTR)                               0327
         MVI   MSGHDRSV(@08),C'I'                                  0327
*             WTOTXT=PRLDATA(1:CURLEN);/* MOVE DATA TO WTO   @Z67SP00*/
         MVI   WTOTXT+1,C' '                                       0328
         MVC   WTOTXT+2(99),WTOTXT+1                               0328
         BCTR  @10,0                                               0328
         EX    @10,@SM01374                                        0328
*             GEN(WTO MF=(E,WTOMSG))                               0329
*             REFS(WTOMSG);         /*                       @Z67SP00*/
         WTO MF=(E,WTOMSG)
*           END;                                                   0330
*                                                                  0330
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE TO OPERATOR WITH RESPONSE MESSAGE ROUTINE @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0331
*         IF(MGPWTOR=ON             /* WTOR TYPE MSG?        @Z67SP00*/
*             &EXTSW=OFF)           /* AND ONLY LAST PART    @Z67SP00*/
*             &MSGRTNCD<LONGMSG     /* AND NO PREV ERR?      @Z67SP00*/
*           THEN                    /* YES - MUST ISSUE WTOR @Z67SP00*/
@RF00324 L     @10,@PC00001                                        0331
         TM    MGPWTOR(@10),B'00001000'                            0331
         BNO   @RF00331                                            0331
         TM    EXTSW,B'00100000'                                   0331
         BNZ   @RF00331                                            0331
         CH    MSGRTNCD,@CH00054                                   0331
         BNL   @RF00331                                            0331
*           DO;                                                    0332
*             WTORRLN=CURLEN+4;     /* SET WTOR LENGTH       @Z67SP00*/
         SLR   @08,@08                                             0333
         IC    @08,CURLEN                                          0333
         LA    @06,4(,@08)                                         0333
         STC   @06,WTORRLN                                         0333
*             MSGHDRSV=WTORMGP;     /* APPEND INFORMATIONAL SEVERITY
*                                      TO MESSAGE ID         @Z67SP00*/
         L     @06,IOPBUFAD(,IOPPTR)                               0334
         MVI   MSGHDRSV(@06),C'I'                                  0334
*             WTORTXT=PRLDATA(1:CURLEN);/* MOVE DATA TO WTOR @Z67SP00*/
         MVI   WTORTXT+1,C' '                                      0335
         MVC   WTORTXT+2(99),WTORTXT+1                             0335
         BCTR  @08,0                                               0335
         EX    @08,@SM01376                                        0335
*             RFY                                                  0336
*              (R2,                                                0336
*               R3) RSTD;           /*                       @Z67SP00*/
*             R2=MGPVARPT(VARNDX);  /*                       @Z67SP00*/
         LR    @08,VARNDX                                          0337
         SLA   @08,2                                               0337
         L     R2,MGPVARPT-4(@08,@10)                              0337
*             R3=MGPVARPT(VARNDX+1);/*                       @Z67SP00*/
         L     R3,MGPVARPT(@08,@10)                                0338
*             GEN(WTOR (R2),(R3),,MF=(E,WTORMSG))                  0339
*             REFS(R2,R3,WTORMSG);  /* ISSUE WTOR            @Z67SP00*/
         WTOR (R2),(R3),,MF=(E,WTORMSG)
*             RFY                                                  0340
*              (R2,                                                0340
*               R3) UNRSTD;         /*                       @Z67SP00*/
*             GEN(WAIT ECB=ECB)     /*                       @Z67SP00*/
*             REFS(ECB);            /*                       @Z67SP00*/
         WAIT ECB=ECB
*           END;                                                   0342
*                                                                  0343
*         /***********************************************************/
*         /*                                                         */
*         /* NOW DETERMINE IF THERE IS ANOTHER PART OF MSG TO WRIT   */
*         /*                                                 @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0343
*         IF EXTSW=ON               /* PRINTER LINE EXTENDED?      0343
*                                                            @SA99994*/
*           THEN                    /* YES                   @SA99994*/
@RF00331 TM    EXTSW,B'00100000'                                   0343
         BNO   @RF00343                                            0343
*           DO;                     /*                       @SA99994*/
*             PRLDATA(1:DATASTRT)=BLANK;/* INIT HEADING AREA @SA99994*/
         L     @10,IOPBUFAD(,IOPPTR)                               0345
         MVI   PRLDATA+1(@10),C' '                                 0345
         MVC   PRLDATA+2(10,@10),PRLDATA+1(@10)                    0345
         MVI   PRLDATA(@10),C' '                                   0345
*             REMLEN=CURLEN-PRLRLEN-1;/* REMAING DATA LENGTH @SA75296*/
         LH    @08,PRLRLEN(,@10)                                   0346
         SLR   REMLEN,REMLEN                                       0346
         IC    REMLEN,CURLEN                                       0346
         SLR   REMLEN,@08                                          0346
         BCTR  REMLEN,0                                            0346
*             PRLDATA(DATASTRT:REMLEN+DATASTRT-1)=PRLDATA(PRLRLEN+2:
*                 CURLEN);          /* MOVE REST OF DATA TO START OF
*                                      LINE                  @SA75296*/
         LR    @06,REMLEN                                          0347
         BCTR  @06,0                                               0347
         ALR   @08,@10                                             0347
         MVC   @TS00001(256),PRLDATA+1(@08)                        0347
         EX    @06,@SM01378                                        0347
*             CURLEN=DATASTRT+REMLEN-1;/* RESET LINE LENGTH  @SA75296*/
         LR    @10,REMLEN                                          0348
         SH    @10,@CH01359                                        0348
         STC   @10,CURLEN                                          0348
*           END;                    /* END LINE EXTENED GROUP      0349
*                                                            @SA99994*/
*       END;                        /* END MULTI WRITE LOOP  @Z67SP00*/
@RF00343 DS    0H                                                  0350
@DE00278 TM    EXTSW,B'00100000'                                   0350
         BNZ   @DL00278                                            0350
*     END;                          /* END PRINTER GROUP     @SA99994*/
         EJECT
*                                                                  0352
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE TO OPERATOR IF I/O ERROR MSG ROUTINE            @SA99994*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0352
*   IF MGPMGNO1=IOERRMSG            /*                       @Z67SP00*/
*     THEN                          /* YES - MUST ISSUE WTO  @Z67SP00*/
@RF00275 L     @10,@PC00001                                        0352
         CLC   MGPMGNO1(2,@10),@CH01249                            0352
         BNE   @RF00352                                            0352
*     DO;                                                          0353
*       WTOLEN=CURLEN+4;            /* SET WTO LENGTH        @SA75296*/
         SLR   @10,@10                                             0354
         IC    @10,CURLEN                                          0354
         LA    @08,4(,@10)                                         0354
         STH   @08,WTOLEN                                          0354
*       MSGHDRSV=WTOMGP;            /* APPEND INFORMATIONAL  @ZD00001*/
*                                                                  0355
         L     @08,IOPBUFAD(,IOPPTR)                               0355
         MVI   MSGHDRSV(@08),C'I'                                  0355
*       /*************************************************************/
*       /*                                                           */
*       /* SEVERITY TO MESSAGE ID                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0356
*       WTOTXT=PRLDATA(1:CURLEN);   /* MOVE DATA TO WTO      @SA75296*/
         MVI   WTOTXT+1,C' '                                       0356
         MVC   WTOTXT+2(99),WTOTXT+1                               0356
         BCTR  @10,0                                               0356
         EX    @10,@SM01374                                        0356
*       GEN(WTO  MF=(E,WTOMSG))                                    0357
*       REFS(WTOMSG);               /*                       @Z67SP00*/
         WTO  MF=(E,WTOMSG)
*     END;                                                         0358
         EJECT
*                                                                  0359
*   /*****************************************************************/
*   /*                                                               */
*   /* CODE TO SET UP PROPER RETURN CODE, SAVE AREA ADDRESS AND      */
*   /* RETURN TO CALLING PROGRAM                             @SA74329*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0359
*   IF REENTERD=ON                  /* IS THIS RE-ENTRY?             */
*     THEN                          /* YES - TURN OFF                */
@RF00352 TM    REENTERD,B'01000000'                                0359
         BNO   @RF00359                                            0359
*     DO;                           /*                       @SA75296*/
*       HMASMMGP=SAVMGP2;           /* RESTORE PASSED MGP    @ZD00001*/
         L     @10,@PC00001                                        0361
         MVC   HMASMMGP(12,@10),SAVMGP2                            0361
*       REENTERD=OFF;               /* INDICATE RE-ENTRY COMPLETE    */
         NI    REENTERD,B'10111111'                                0362
*     END;                          /* END RE-ENTRY GROUP    @SA75296*/
*   ELSE                            /* OTHERWISE - INDICATE          */
*     DO;                           /* ONE ENTRY GROUP       @SA75296*/
         B     @RC00359                                            0364
@RF00359 DS    0H                                                  0365
*       HMASMMGP=SAVMGP1;           /* RESTORE PASSED MGP    @ZD00001*/
         L     @10,@PC00001                                        0365
         MVC   HMASMMGP(12,@10),SAVMGP1                            0365
*       ENTERED=OFF;                /* MAIN ENTRY COMPLETE           */
         NI    ENTERED,B'01111111'                                 0366
*     END;                          /* END ONE ENTRY GROUP   @SA75296*/
*   R13=SVBACK;                     /* RESTORE SV AREA PTR           */
@RC00359 L     R13,SVBACK(,R13)                                    0368
*   IF MSGRTNCD=IOPIOERR            /* SAVERE ERROR?         @Z67SP00*/
*     THEN                          /* YES - SET BIT TO STOP @Z67SP00*/
         CH    MSGRTNCD,@CH00042                                   0369
         BNE   @RF00369                                            0369
*     CCATERM=ON;                   /* SMP AT RTN TO DRV     @Z67SP00*/
         L     @10,@CA00069                                        0370
         OI    CCATERM-HMASMCCA(@10),B'00100000'                   0370
*   RETURN CODE(MSGRTNCD);          /* RETURN WITH SET CODE  @SA74329*/
@RF00369 LR    @15,MSGRTNCD                                        0371
         L     @14,12(,@13)                                        0371
         LM    @00,@12,20(@13)                                     0371
         BR    @14                                                 0371
*   END HMASMMSG                                                   0372
*                                                                  0372
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */
*                                                                  0372
*       ;                                                          0372
@EL00001 DS    0H                                                  0372
@EF00001 DS    0H                                                  0372
@ER00001 LM    @14,@12,12(@13)                                     0372
         BR    @14                                                 0372
@DATA    DS    0H
@CH00044 DC    H'1'
@CH00056 DC    H'3'
@CH00054 DC    H'8'
@CH00042 DC    H'16'
@CH01249 DC    H'75'
@CH01247 DC    H'250'
@CH01359 DC    H'-11'
@SM01364 MVC   PRLDATA-1(0,@10),MSGTEXT(MSGPTR)
@SM01366 MVC   PRLDATA-1(0,@10),VARSTRNG(@01)
@SM01368 MVC   PRLDATA-1(0,@06),@TS00001
@SM01372 MVC   WTPTXT(0),PRLDATA(@08)
@SM01374 MVC   WTOTXT(0),PRLDATA(@08)
@SM01376 MVC   WTORTXT(0),PRLDATA(@06)
@SM01378 MVC   PRLDATA+11(0,@10),@TS00001
         DS    0F
@PC00001 DS    1F
@AL00001 DS    1A
         DS    0F
@CF01363 DC    F'-4'
@CA00069 DC    A(HMASMCCA)
@CV01281 DC    V(HMASMIO)
@CA01347 DC    A(DC1PMSG)
@CA01348 DC    A(DC1SMSG)
         DS    0D
ECB      DC    F'0'
CURLEN   DS    FL1
         DS    0D
@TS00001 DS    CL256
@CC01258 DC    C'  '
@CC01271 DC    C'**'
SYSMSGNO DC    CL11'HMA        '
         DS    CL1
SVAREA1  DS    CL72
SVAREA2  DS    CL72
SWITCHES DC    AL1(0)
         ORG   SWITCHES
ENTERED  DS    BL1
REENTERD EQU   SWITCHES+0
EXTSW    EQU   SWITCHES+0
         ORG   SWITCHES+1
DECNO    DS    CL3
IOP      DS    CL68
PRL      DS    CL260
PATCHMSG DS    CL80
         ORG   PATCHMSG
@NM00181 DC    80X'FF'
         ORG   PATCHMSG+80
SAVMGP1  DS    CL12
SAVMGP2  DS    CL12
SEVERITY DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'D'
HMASMMSG CSECT
WTPLST WTO 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',            X
               DESC=7,ROUTCDE=(11),MF=L                      @Z67SP00
HMASMMSG CSECT
WTOLST WTO 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',            X
               DESC=7,ROUTCDE=(2,11),MF=L                    @ZA12166
HMASMMSG CSECT
WTORLST WTOR 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',,,ECB,    X
               ROUTCDE=(1,2),MF=L
HMASMMSG CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MSGNO    EQU   @07
REMLEN   EQU   @04
MSGPTR   EQU   @06
VARSTART EQU   @08
VARNDX   EQU   @07
VARLEN   EQU   @06
INDEX    EQU   @04
MSGRTNCD EQU   @05
I        EQU   @04
IOPPTR   EQU   @09
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
CCAPTR   EQU   @11
R13      EQU   @13
         EXTRN HMASMCCA
         EXTRN DC1PMSG
         EXTRN DC1SMSG
CCABLDLA EQU   0
@NM00027 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00029 EQU   CCABLDLL
CCALKDRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00039+20
@NM00041 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00041+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPNAME  EQU   HMASMIOP+4
@NM00045 EQU   HMASMIOP+12
@NM00046 EQU   @NM00045
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00156 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMPRL EQU   0
PRLRLEN  EQU   HMASMPRL
PRLSPAN  EQU   HMASMPRL+2
PRLFLGS  EQU   PRLSPAN
PRLDATE  EQU   HMASMPRL+4
PRLTIME  EQU   HMASMPRL+7
PRLEND   EQU   HMASMPRL+10
SVMAP    EQU   0
SVBACK   EQU   SVMAP+4
SVFWRD   EQU   SVMAP+8
VARSTRNG EQU   0
MSGMAP   EQU   0
MSGLEN   EQU   MSGMAP
MSGTEXT  EQU   MSGMAP+1
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCALISTP EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00011 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCATERM  EQU   CCAFLAG2
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCALOGNG EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
HMASMMGP EQU   0
MGPFIXED EQU   HMASMMGP
MGPCLEAR EQU   MGPFIXED
MGPMGNO1 EQU   MGPCLEAR
MGPFLAGS EQU   MGPFIXED+6
MGPPRINT EQU   MGPFLAGS
MGPLIST  EQU   MGPFLAGS
MGPRPT   EQU   MGPFLAGS
MGPHLDS  EQU   MGPFLAGS
MGPWTOR  EQU   MGPFLAGS
MGPWTO   EQU   MGPFLAGS
MGPWTP   EQU   MGPFLAGS
MGPTYPE  EQU   MGPFIXED+8
MGPVAR   EQU   HMASMMGP+12
MGPVARPT EQU   MGPVAR
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00052 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00063 EQU   IOPUDATA
@NM00064 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00073 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00084 EQU   IOPSRCDR+1
@NM00086 EQU   @NM00084+7
@NM00090 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00094 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00100 EQU   IOPMODDR+1
@NM00102 EQU   @NM00100+7
@NM00106 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00110 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00121 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00128 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00137 EQU   IOPPTFFX
@NM00138 EQU   @NM00137
IOPPDTES EQU   IOPPTFFX+41
@NM00141 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00166 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00166
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00170 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00170
IOPBFTB1 EQU   IOPBFTB0
PRLDATA  EQU   PRLEND
MSGHDR   EQU   PRLDATA
MSGHDRNO EQU   MSGHDR+3
MSGHDRZN EQU   MSGHDRNO+2
MSGHDRSV EQU   MSGHDR+6
MSGHDRHL EQU   MSGHDR+8
MSGNDX   EQU   MGPMGNO1
WTPMSG   EQU   WTOLST
WTPLEN   EQU   WTPMSG
WTPTXT   EQU   WTPMSG+4
WTOMSG   EQU   WTOLST
WTOLEN   EQU   WTOMSG
WTOTXT   EQU   WTOMSG+4
WTORMSG  EQU   WTORLST
WTORRLN  EQU   WTORMSG
WTORTXT  EQU   WTORMSG+12
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00184 EQU   WTORMSG+10
WTORTLN  EQU   WTORMSG+8
WTORECB  EQU   WTORMSG+4
WTORRAD  EQU   WTORMSG+1
@NM00183 EQU   WTOMSG+2
@NM00182 EQU   WTPMSG+2
@NM00180 EQU   MSGHDR+10
@NM00179 EQU   MSGHDR+7
@NM00178 EQU   MSGHDRNO
@NM00177 EQU   MSGHDR
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00172 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00171 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00169 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00168 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00167 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00165 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00164 EQU   IOPPTSFX+35
@NM00163 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00162 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00161 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00160 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00159 EQU   IOPQFMDR
@NM00155 EQU   IOPQSMDR
@NM00154 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00153 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00152 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00151 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00150 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00149 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00148 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00147 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00146 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00145 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00144 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00143 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00142 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00141+3
IOPRECD  EQU   @NM00141
@NM00140 EQU   IOPPTFFX+8
@NM00139 EQU   @NM00137+7
IOPPRELN EQU   @NM00138
@NM00136 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00135 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00134 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00133 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00132 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00131 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00130 EQU   @NM00128+7
@NM00129 EQU   @NM00128
@NM00127 EQU   IOPSYSDR+5
@NM00126 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00125 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00124 EQU   IOPDLBFX+8
@NM00123 EQU   @NM00121+7
@NM00122 EQU   @NM00121
@NM00120 EQU   IOPDLBDR+1
@NM00119 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00118 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00117 EQU   IOPMODFX+12
@NM00116 EQU   IOPMODF4
@NM00115 EQU   IOPMODF3
@NM00114 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00113 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00112 EQU   @NM00110+7
@NM00111 EQU   @NM00110
@NM00109 EQU   IOPMODDR+17
@NM00108 EQU   @NM00106+7
@NM00107 EQU   @NM00106
@NM00105 EQU   @NM00102
@NM00104 EQU   @NM00102
@NM00103 EQU   @NM00102
@NM00101 EQU   @NM00100
@NM00099 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00098 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00097 EQU   IOPSRCFX+8
@NM00096 EQU   @NM00094+7
@NM00095 EQU   @NM00094
@NM00093 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00092 EQU   @NM00090+7
@NM00091 EQU   @NM00090
@NM00089 EQU   @NM00086
@NM00088 EQU   @NM00086
@NM00087 EQU   @NM00086
@NM00085 EQU   @NM00084
@NM00083 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00082 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00081 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00080 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00079 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00078 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00077 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00075 EQU   @NM00073+7
@NM00074 EQU   @NM00073
@NM00072 EQU   IOPLMDDR+6
@NM00071 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00070 EQU   IOPLMDF4
@NM00069 EQU   IOPLMDF3
@NM00068 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00067 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00066 EQU   IOPLMDDR
@NM00065 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00064+4
IOPUSED  EQU   @NM00064
IOPTPSEQ EQU   @NM00063+8
IOPVLSER EQU   @NM00063+2
IOPBLKSI EQU   @NM00063
IOPCQMAX EQU   IOPCQMAP+12
@NM00062 EQU   IOPCQMAP+11
@NM00061 EQU   IOPCQMAP+8
@NM00060 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00059 EQU   IOPSCMAP+11
@NM00058 EQU   IOPSCMAP+8
@NM00057 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00056 EQU   IOPNTMAX+11
@NM00055 EQU   IOPNTMAX+8
@NM00054 EQU   IOPNTMAX
@NM00053 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00052+5
IOPIPTF3 EQU   @NM00052
@NM00002 EQU   MGPFIXED+9
@NM00001 EQU   MGPFLAGS
MGPMGNO3 EQU   MGPCLEAR+4
MGPMGNO2 EQU   MGPCLEAR+2
CCAEND   EQU   HMASMCCA+371
@NM00026 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00025 EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00024 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00023 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00022 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00021 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00020 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00019 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00018 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00017 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00016 EQU   @NM00011+18
@NM00015 EQU   @NM00011+16
CCATBLPA EQU   @NM00011+12
@NM00014 EQU   @NM00011+8
@NM00013 EQU   @NM00011+4
@NM00012 EQU   @NM00011
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00010 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00009 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00008 EQU   CCAFBUFR+122
@NM00007 EQU   CCAFBUFR+120
@NM00006 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00005 EQU   CCAFBUFR+88
@NM00004 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00003 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00176 EQU   SVMAP+12
@NM00175 EQU   SVMAP
PRLCONC  EQU   PRLTIME+2
@NM00174 EQU   PRLTIME
PRLHDADR EQU   PRLDATE
@NM00173 EQU   PRLFLGS
PRLBLANK EQU   PRLFLGS
PRLHEADO EQU   PRLFLGS
PRLHEAD  EQU   PRLFLGS
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00158 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00157 EQU   @NM00156+7
IOPQSMFM EQU   @NM00156
@NM00076 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00051 EQU   IOPUSERL
@NM00050 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00049 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00048 EQU   @NM00045+10
IOPSEQNO EQU   @NM00045+8
@NM00047 EQU   @NM00046+7
IOPPTFNM EQU   @NM00046
IOPNAM17 EQU   IOPNAME
IOPTYPE  EQU   HMASMIOP+3
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00044 EQU   CCABLDLM+2
@NM00043 EQU   CCABLDLM
CCAUPDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00041+12
CCAUPDTE EQU   @NM00041+8
CCAUPDNM EQU   @NM00041
CCASUPPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00039+12
CCAIOSUP EQU   @NM00039+8
CCASUPNM EQU   @NM00039
CCAZAPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00037+12
CCASPZAP EQU   @NM00037+8
CCAZAPNM EQU   @NM00037
CCACOMPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00035+12
CCACOMRS EQU   @NM00035+8
CCACOMNM EQU   @NM00035
CCACPYPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00033+12
CCACOPY  EQU   @NM00033+8
CCACPYNM EQU   @NM00033
CCAASMPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00031+12
CCAASM   EQU   @NM00031+8
CCAASMNM EQU   @NM00031
CCALKDPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00029+12
CCALKED  EQU   @NM00029+8
CCALKDNM EQU   @NM00029
CCAPGMPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCABPGRC EQU   @NM00027+20
CCABPGSP EQU   @NM00027+12
CCABPGAD EQU   @NM00027+8
CCABPGNM EQU   @NM00027
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00187 EQU   @EL00001
@RF00241 EQU   NEXTCHAR
@ENDDATA EQU   *
         END   HMASMMSG,(C'PLS2101',0802,78334)

         TITLE 'HMASMLKI - SMP LINK ROUTINE INTERFACE'
HMASMLKI CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMLKI  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         EJECT
*                                                                  0224
*   /*****************************************************************/
*   /*                                                               */
*   /* PROGRAM INITIALIZATION                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0224
*   FLAGS=CLEAR;                    /* RESET FLAG BYTE               */
         MVI   FLAGS,X'00'                                         0224
*   LKIRTNCD=ZERO;                  /* INIT RC AREA          @YA07506*/
         SLR   LKIRTNCD,LKIRTNCD                                   0225
*   HMASMMGP=''B;                   /* CLEAR MSG PARMS       @Z67SP00*/
         XC    HMASMMGP(40),HMASMMGP                               0226
*   IOPPTR=CCAIOPTR;                /* ADDRESSIBILITY FOR IOP        */
         MVC   IOPPTR(4),CCAIOPTR(CCAPTR)                          0227
*   RFY                                                            0228
*    (ICTLMOD) BASED(CCAICLMD);                                    0228
*   RFY                                                            0229
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0229
*   RFY                                                            0230
*    (ICTMOD) BASED(ICTIXL(J));                                    0230
*   RFY                                                            0231
*    (ICTPTF) BASED(ICTPPTR(1));                                   0231
*   RFY                                                            0232
*     RVAPARM BASED(CCARVAD);       /* RVA BASE              @Z67SP00*/
*                                                                  0232
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ELEMENTS TO BE LINKED FROM RELFILE DATASETS. IF MORE*/
*   /* THAN ONE RELFILE IS TO BE PROCESSED THEN THE ELEMENTS FROM ALL*/
*   /* BUT THE FIRST ARE TRANSFERED TO SYSUT5 AND THE MOD ENTRIES    */
*   /* WILL INDICATE SYSUT5 AS FROMLIB. ELEMENTS FROM THE FIRST OR   */
*   /* ONLY RELFILE DATASET WILL NOT BE TRANSFERED AND WILL INDICATE */
*   /* SMPTLIB AS FROMLIB. THE JFCB PROCESSING FOR THIS RELFILE WILL */
*   /* BE DONE.                                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0233
*   CILPTFNO='';                    /*                       @Z67SP00*/
         MVI   CILPTFNO,C' '                                       0233
         MVC   CILPTFNO+1(6),CILPTFNO                              0233
*   CILPTFDS='';                    /*                       @Z67SP00*/
         MVI   CILPTFDS,C' '                                       0234
         MVC   CILPTFDS+1(43),CILPTFDS                             0234
*   CALL HMASMCIL(CILPTFNO,CILPTFDS);/*                      @Z67SP00*/
         L     @15,@CV01635                                        0235
         LA    @01,@AL00235                                        0235
         BALR  @14,@15                                             0235
*   RFY                                                            0236
*     RTNCODE RSTD;                 /*                       @Z67SP00*/
*   LKIRTNCD=MAX(RTNCODE,LKIRTNCD); /*                       @Z67SP00*/
         CR    LKIRTNCD,RTNCODE                                    0237
         BNL   *+6
         LR    LKIRTNCD,RTNCODE                                    0237
*   RFY                                                            0238
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
*                                                                  0239
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTINUE PROCESSING UNTIL NO MORE LOAD MODULES CAN BE FOUND   */
*   /* ELIGIBLE FOR LINK EDITING.                            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0239
*   DOLINK=ON;                      /* INIT LOOP CONTROL     @Z67SP00*/
         OI    DOLINK,B'01000000'                                  0239
*   DO WHILE DOLINK=ON&LKIRTNCD<STOPFUNC;/*                  @Z67SP00*/
         B     @DE00240                                            0240
@DL00240 DS    0H                                                  0241
*     LINKERR=OFF;                  /* RESET ERROR SW        @Z67SP00*/
*                                                                  0241
*     /***************************************************************/
*     /*                                                             */
*     /* THIS IS THE MAIN LOOP THRU THE ICT FROM THE LOAD MODULE TO  */
*     /* THE PTF. PURPOSE IS TO SELECT THE LOAD MODULE TO PROCESS    */
*     /* WITH THE ASSOCIATED MODULES. IT CREATES THE INCLUDE CARDS   */
*     /* AFTER WRITTING OUT THE VALID CONTROL CARDS FROM THE CDS. IT */
*     /* THEN INTERFACES WITH THE OTHER INTERNAL PROCEDURES FOR      */
*     /* SPECIFIC FUNCTIONS AND FINALLY SETS THE RETURN CODE PASSED  */
*     /* TO THE CALLING ROUTINE.                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0242
*     DOLINK=OFF;                   /* RELET LOOP CONTROL    @Z67SP00*/
         NI    LINKERR,B'10011111'                                 0242
*     DO I=1 BY 1 WHILE ICTLEND(I)^=ICTENDNT/* LOOP THRU LOAD MODS   */
*           &DOLINK=OFF             /* STOP CHECKING LMODS WHEN ALL
*                                      POSSIBLE FOR THIS PASS HAVE 0243
*                                      BEEN SET UP           @Z67SP00*/
*           &LKIRTNCD<STOPFUNC;     /*                       @Z67SP00*/
         LA    I,1                                                 0243
         B     @DE00243                                            0243
@DL00243 DS    0H                                                  0244
*       IF ICTLLKD(I)=ON&ICTLCPL(I)=OFF&ICTLPROC(I)=OFF/* LINK-NOT 0244
*                                      COMPLETE-NOT INPROCESS        */
*         THEN                                                     0244
         LR    @07,I                                               0244
         MH    @07,@CH01006                                        0244
         L     @05,CCAICLMD(,CCAPTR)                               0244
         ST    @07,@TF00001                                        0244
         ALR   @07,@05                                             0244
         AL    @07,@CF01910                                        0244
         TM    ICTLLKD-14(@07),B'00001000'                         0244
         BNO   @RF00244                                            0244
         AL    @05,@TF00001                                        0244
         AL    @05,@CF01911                                        0244
         TM    ICTLCPL-8(@05),B'10100000'                          0244
         BNZ   @RF00244                                            0244
*         DO;                       /*                               */
*                                                                  0245
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK LMODS MODS TO SEE IF ANY CAN BE LINKED  @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0246
*           DO J=1 BY 1 WHILE ICTIXL(J)^=ICTENDIX;/* LOOP THROUGH  0246
*                                      MODS                          */
         LA    J,1                                                 0246
         B     @DE00246                                            0246
@DL00246 DS    0H                                                  0247
*             IF ICTMCPL(1)=OFF     /* IS MODULE COMPLETE            */
*                 &ICTMISEL(1)=ON   /* SELECTED              @Z67SP00*/
*                 &(ICTMMOD(1)=ON   /* MOD REPLACEMENT       @Z67SP00*/
*                 ×ICTMXPND(1)=ON)  /* OR EXPAND             @Z67SP00*/
*               THEN                                               0247
         LR    @07,J                                               0247
         SLA   @07,2                                               0247
         LR    @05,I                                               0247
         MH    @05,@CH01006                                        0247
         L     @02,CCAICLMD(,CCAPTR)                               0247
         AL    @02,@CF01912                                        0247
         L     @05,ICTLCHN-34(@05,@02)                             0247
         AL    @05,@CF01913                                        0247
         L     @07,ICTIXL(@07,@05)                                 0247
         TM    ICTMCPL(@07),B'00100000'                            0247
         BNZ   @RF00247                                            0247
         TM    ICTMISEL(@07),B'10000000'                           0247
         BNO   @RF00247                                            0247
         TM    ICTMMOD(@07),B'10010000'                            0247
         BZ    @RF00247                                            0247
*               DO;                 /*                       @YA13566*/
*                                                                  0248
*                 /***************************************************/
*                 /*                                                 */
*                 /* CREATE SYSMOD ENTRY ON THE CDS OR ACDS  @Z67SP00*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0249
*                 CALL HMASMSEC(ICTPTF(1),IOPPTR);/*         @Z67SP00*/
         L     @07,ICTPPTR(,@07)                                   0249
         ST    @07,@AL00001                                        0249
         LA    @07,IOPPTR                                          0249
         ST    @07,@AL00001+4                                      0249
         L     @15,@CV01637                                        0249
         LA    @01,@AL00001                                        0249
         BALR  @14,@15                                             0249
*                 RFY                                              0250
*                   RTNCODE RSTD;   /*                       @Z67SP00*/
*                 LKIRTNCD=MAX(LKIRTNCD,RTNCODE);/*          @Z67SP00*/
         CR    LKIRTNCD,RTNCODE                                    0251
         BNL   *+6
         LR    LKIRTNCD,RTNCODE                                    0251
*                 RFY                                              0252
*                   RTNCODE UNRSTD; /*                       @Z67SP00*/
*                 ICTPROCS(1)=ON;   /* PTF IN PROCESS        @Z67SP00*/
         LR    @07,J                                               0253
         SLA   @07,2                                               0253
         LR    @05,I                                               0253
         MH    @05,@CH01006                                        0253
         L     @02,CCAICLMD(,CCAPTR)                               0253
         LA    @01,0(@05,@02)                                      0253
         AL    @01,@CF01912                                        0253
         L     @01,ICTLCHN-34(,@01)                                0253
         AL    @01,@CF01913                                        0253
         L     @07,ICTIXL(@07,@01)                                 0253
         L     @07,ICTPPTR(,@07)                                   0253
         OI    ICTPROCS(@07),B'10000000'                           0253
*                 ICTLPROC(I)=ON;   /* LMOD IN PROCESS       @YA13566*/
         ALR   @02,@05                                             0254
         AL    @02,@CF01911                                        0254
         OI    ICTLPROC-8(@02),B'10000000'                         0254
*                 CALLCPL=ON;       /* HMASMCPL NEEDED       @Z67SP00*/
         OI    CALLCPL,B'00001000'                                 0255
*               END;                /*                       @YA13566*/
*           END;                                                   0257
*                                                                  0257
@RF00247 AH    J,@CH00085                                          0257
@DE00246 LR    @07,J                                               0257
         SLA   @07,2                                               0257
         LR    @05,I                                               0257
         MH    @05,@CH01006                                        0257
         L     @02,CCAICLMD(,CCAPTR)                               0257
         LA    @01,0(@05,@02)                                      0257
         AL    @01,@CF01912                                        0257
         L     @01,ICTLCHN-34(,@01)                                0257
         AL    @01,@CF01913                                        0257
         L     @07,ICTIXL(@07,@01)                                 0257
         CL    @07,ICTENDIX                                        0257
         BNE   @DL00246                                            0257
*           /*********************************************************/
*           /*                                                       */
*           /* ABOVE CHECK FOUND THAT THE LMOD CAN SHOULD BE LINKED. */
*           /*                                               @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0258
*           IF ICTLPROC(I)=ON       /* ELIGIBLE LMOD         @Z67SP00*/
*               &LKIRTNCD<STOPFUNC  /*                       @Z67SP00*/
*             THEN                  /* THEN PROCESS LMOD     @YA13566*/
         ALR   @02,@05                                             0258
         AL    @02,@CF01911                                        0258
         TM    ICTLPROC-8(@02),B'10000000'                         0258
         BNO   @RF00258                                            0258
         CH    LKIRTNCD,@CH00032                                   0258
         BNL   @RF00258                                            0258
*             DO;                   /*                       @YA13566*/
*                                                                  0259
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP LINKAGE EDITOR PARMS, AND DD NAMES @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0260
*               IF PARMSET=OFF THEN /* NEED TO SET PARMS     @Z67SP00*/
         TM    PARMSET,B'10000000'                                 0260
         BNZ   @RF00260                                            0260
*                 CALL PARMS;       /*                       @Z67SP00*/
*                                                                  0261
         BAL   @14,PARMS                                           0261
*               /*****************************************************/
*               /*                                                   */
*               /* CALL ROUTINE TO PROCESS RECORDS FROM THE CDS LMOD */
*               /* MEMBER.                                   @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0262
*               CALL CDSCARDS;      /*                       @Z67SP00*/
*                                                                  0262
@RF00260 BAL   @14,CDSCARDS                                        0262
*               /*****************************************************/
*               /*                                                   */
*               /* WHEN THE ENTIRE CDS LMOD MEMBER HAS BEEN PROCESSED*/
*               /* ( ALL LINK CONTROL RECORDS APPROPIATE ARE ON      */
*               /* SYSUT1) THE LINKAGE EDITOR PREPROCESSING IS DONE  */
*               /* FOR THIS LOAD MODULE.                     @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0263
*               IF LKIRTNCD<STOPFUNC THEN/*                  @Z67SP00*/
         CH    LKIRTNCD,@CH00032                                   0263
         BNL   @RF00263                                            0263
*                 DO;               /*                       @Z67SP00*/
*                   CALL MODCHK;    /*                       @Z67SP00*/
*                                                                  0265
         BAL   @14,MODCHK                                          0265
*                   /*************************************************/
*                   /*                                               */
*                   /* CHECK FOR MORE LMODS ELIGIBLE FOR PROCESSING  */
*                   /* IN THIS PASS TO THE LINKAGE EDITOR. IF MORE   */
*                   /* CAN BE PROCESSED THE MAIN LMOD LOOP WILL BE   */
*                   /* EXECUTED AGAIN. IF NO MORE CAN BE PICKED UP   */
*                   /* DOLINK WILL BE SET TO STOP THE LMOD LOOP.     */
*                   /*                                       @Z67SP00*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0266
*                   CALL LMCHECK;   /*                       @Z67SP00*/
*                                                                  0266
         BAL   @14,LMCHECK                                         0266
*                   /*************************************************/
*                   /*                                               */
*                   /* IF DOLINK IS SET OFF IT INDICATES THAT MORE   */
*                   /* LMODS ARE ELIGIBLE TO BE LINKED ALONG WITH THE*/
*                   /* CURRENT LMOD (INDEX VALUE IS I). THE INDEX    */
*                   /* VALUE M IS FOR THE LMOD FOUND TO BE ELIBIBLE  */
*                   /* FOR CONCURRENT PROCESSING. I WILL BE SET TO   */
*                   /* M-1 SO THAT THE INTERNAL LOOP INDES           */
*                   /* INCREMENTING PROCESSING WILL SET IT TO THE    */
*                   /* CORRECT VALUE AND THE LMOD REFERENCED BY M    */
*                   /* WILL BE THE NEXT PROCESSED IN THIS LOOP.      */
*                   /*                                       @Z67SP00*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0267
*                   IF DOLINK=OFF THEN/* SETUP FOR I TO BE   @Z67SP00*/
         TM    DOLINK,B'01000000'                                  0267
         BNZ   @RF00267                                            0267
*                     I=M-1;        /* EQUAL TO M AT TOP.    @Z67SP00*/
         LR    I,M                                                 0268
         BCTR  I,0                                                 0268
*                 END;              /*                       @Z67SP00*/
@RF00267 DS    0H                                                  0270
*             END;                                                 0270
@RF00263 DS    0H                                                  0271
*         END;                      /* END LMOD HAD MODULES TO LINK
*                                      DO GROUP              @YA13566*/
@RF00258 DS    0H                                                  0272
*     END;                                                         0272
*                                                                  0272
@RF00244 AH    I,@CH00085                                          0272
@DE00243 LR    @07,I                                               0272
         MH    @07,@CH01006                                        0272
         L     @05,CCAICLMD(,CCAPTR)                               0272
         AL    @05,@CF01916                                        0272
         L     @07,ICTLEND(@07,@05)                                0272
         CL    @07,ICTENDNT                                        0272
         BE    @DC00243                                            0272
         TM    DOLINK,B'01000000'                                  0272
         BNZ   @DC00243                                            0272
         CH    LKIRTNCD,@CH00032                                   0272
         BL    @DL00243                                            0272
@DC00243 DS    0H                                                  0273
*     /***************************************************************/
*     /*                                                             */
*     /* IF A LINK SHOULD NOW BE DONE THEN CALL PROC TO INIT THE     */
*     /* LINKAGE EDITOR PARAMETERS AN INVOKE THE EDITOR      @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0273
*     IF DOLINK=ON&LKIRTNCD<STOPFUNC/*                       @Z67SP00*/
*       THEN                                                       0273
         TM    DOLINK,B'01000000'                                  0273
         BNO   @RF00273                                            0273
         CH    LKIRTNCD,@CH00032                                   0273
         BNL   @RF00273                                            0273
*       DO;                         /*                       @YA07506*/
*         PARMSET=OFF;              /*                       @Z67SP00*/
         NI    PARMSET,B'01111111'                                 0275
*         CALL LINK;                /*                       @Z67SP00*/
         BAL   @14,LINK                                            0276
*         RELFALC=OFF;              /*                               */
*         RELFALCD=OFF;             /*                               */
         NI    RELFALC,B'11111001'                                 0278
*       END;                        /*                       @YA07506*/
*                                                                  0279
*     /***************************************************************/
*     /*                                                             */
*     /* DO SYSMOD COMPLETION PROCESSING                     @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0280
*     IF CALLCPL=ON THEN            /* HMASMCPL NEEDED       @Z67SP00*/
@RF00273 TM    CALLCPL,B'00001000'                                 0280
         BNO   @RF00280                                            0280
*       DO;                         /*                       @Z67SP00*/
*         IF LINKERR=ON THEN        /* DETERMINE PARM        @Z67SP00*/
         TM    LINKERR,B'00100000'                                 0282
         BNO   @RF00282                                            0282
*           STATUS=BAD;             /* NORMAL PROCESSING@Z67SP00     */
         MVI   STATUS,C'B'                                         0283
*         ELSE                      /*                       @Z67SP00*/
*           STATUS=GOOD;            /* ERROR PROCESSING      @Z67SP00*/
         B     @RC00282                                            0284
@RF00282 MVI   STATUS,C'G'                                         0284
*         CALL HMASMCPL(STATUS);    /*                       @Z67SP00*/
@RC00282 L     @15,@CV01636                                        0285
         LA    @01,@AL00285                                        0285
         BALR  @14,@15                                             0285
*         RFY                                                      0286
*           RTNCODE RSTD;           /*                       @Z67SP00*/
*         LKIRTNCD=MAX(RTNCODE,LKIRTNCD);/*                  @Z67SP00*/
         CR    LKIRTNCD,RTNCODE                                    0287
         BNL   *+6
         LR    LKIRTNCD,RTNCODE                                    0287
*         RFY                                                      0288
*           RTNCODE UNRSTD;         /*                       @Z67SP00*/
*         CALLCPL=OFF;              /* RESET INDICATOR       @Z67SP00*/
         NI    CALLCPL,B'11110111'                                 0289
*       END;                        /*                       @Z67SP00*/
*   END;                            /* END OUTER LOOP        @Z67SP00*/
@RF00280 DS    0H                                                  0291
@DE00240 TM    DOLINK,B'01000000'                                  0291
         BNO   @DC00240                                            0291
         CH    LKIRTNCD,@CH00032                                   0291
         BL    @DL00240                                            0291
@DC00240 DS    0H                                                  0292
*   RETURN CODE(LKIRTNCD);          /* SET RTNCODE TO FINISHED     0292
*                                                            @YA07506*/
         LR    @15,LKIRTNCD                                        0292
         L     @13,4(,@13)                                         0292
         L     @14,12(,@13)                                        0292
         LM    @00,@12,20(@13)                                     0292
         BR    @14                                                 0292
*                                                                  0293
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE CDS MEMBER FOR LINKEDIT CONTROL CARDS. SPECIAL      */
*   /* PROCESSING IS REQUIRED FOR CHANGE AND REPLACE RECORDS.        */
*   /*                                                       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0293
*CDSCARDS:                                                         0293
*   PROC;                           /*                       @Z67SP00*/
@EL00001 L     @13,4(,@13)                                         0293
@EF00001 DS    0H                                                  0293
@ER00001 LM    @14,@12,12(@13)                                     0293
         BR    @14                                                 0293
CDSCARDS STM   @14,@05,@SA00002                                    0293
         STM   @07,@12,@SA00002+32                                 0293
*   RFY                                                            0294
*    (ICTLMOD) BASED(CCAICLMD);                                    0294
*   RFY                                                            0295
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0295
*   RFY                                                            0296
*    (ICTMOD) BASED(ICTIXL(J));                                    0296
*   RFY                                                            0297
*    (ICTPTF) BASED(ICTPPTR(1));                                   0297
*                                                                  0297
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR READ OF LINK EDIT CONTROL CARDS FROM CDS   @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0298
*   CALL POINT;                     /* POSITION TO CNTL DATA         */
         BAL   @14,POINT                                           0298
*CKBLK:                                                            0299
*                                                                  0299
*   /*****************************************************************/
*   /*                                                               */
*   /* READ AND WRIETE NORMAL CONTROL RECORDS TO SYSUT1      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0299
*   DO WHILE BUFFER(1)=BLANK        /* SEARCH CTL RECS               */
*         &LKIRTNCD<STOPFUNC        /*                       @Z67SP00*/
*         &LINKEOF=OFF;             /* FOR CHANGE/REP CARDS  @Z67SP00*/
*                                                                  0299
CKBLK    B     @DE00299                                            0299
@DL00299 DS    0H                                                  0300
*     /***************************************************************/
*     /*                                                             */
*     /* READ ANOTHER RECORD FROM THE CDS LMOD MEMBER        @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0300
*     CALL READ;                    /* READ A CONTROL RECORD         */
         BAL   @14,READ                                            0300
*     IF LKIRTNCD<STOPFUNC          /*                       @Z67SP00*/
*         &LINKEOF=OFF              /* RECORD TO WRITE       @S67SP00*/
*         &BUFFER(1)=BLANK THEN     /* NOT C/R CARD          @Z67SP00*/
*                                                                  0301
         CH    LKIRTNCD,@CH00032                                   0301
         BNL   @RF00301                                            0301
         TM    LINKEOF,B'00010000'                                 0301
         BNZ   @RF00301                                            0301
         L     @07,IOPPTR                                          0301
         L     @07,IOPBUFAD(,@07)                                  0301
         CLI   BUFFER(@07),C' '                                    0301
         BNE   @RF00301                                            0301
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE NORMAL CONTROL CARDS TO SYSUT1              @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0302
*       CALL WRITE;                 /* WRITE CARDS TO SYSUT1         */
         BAL   @14,WRITE                                           0302
*   END;                                                           0303
*                                                                  0303
@RF00301 DS    0H                                                  0303
@DE00299 L     @07,IOPPTR                                          0303
         L     @07,IOPBUFAD(,@07)                                  0303
         CLI   BUFFER(@07),C' '                                    0303
         BNE   @DC00299                                            0303
         CH    LKIRTNCD,@CH00032                                   0303
         BNL   @DC00299                                            0303
         TM    LINKEOF,B'00010000'                                 0303
         BZ    @DL00299                                            0303
@DC00299 DS    0H                                                  0304
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FIRST CHAR OF CONTROL CARD IS EQUAL TO IOPLMCRM THEN THIS  */
*   /* INDICATES THAT CHANGE/REPLACE CARDS FOLLOW FOR THE MODULE     */
*   /* IDENTIFIED BY IOPLMCRN. THE CHANGE/REPLACE CARDS HAVE HE FIRST*/
*   /* CHARACTERS SET EQUAL TO IOPLMCRC                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0304
*   IF BUFFER(1)=IOPLMCRM           /* IF MOD FOR CH/REP     @Z67SP00*/
*       &LKIRTNCD<STOPFUNC          /*                       @Z67SP00*/
*       &LINKEOF=OFF                /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
*                                                                  0304
         L     @07,IOPPTR                                          0304
         L     @07,IOPBUFAD(,@07)                                  0304
         CLI   BUFFER(@07),C'*'                                    0304
         BNE   @RF00304                                            0304
         CH    LKIRTNCD,@CH00032                                   0304
         BNL   @RF00304                                            0304
         TM    LINKEOF,B'00010000'                                 0304
         BNZ   @RF00304                                            0304
*     /***************************************************************/
*     /*                                                             */
*     /* SEE IF THE CARD IS FOR A MOD IN THIS LMOD           @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0305
*SCAN:                                                             0305
*     DO J=1 BY 1 WHILE ICTIXL(J)^=ICTENDIX/* SEARCH MODS            */
*           &LINKEOF=OFF&LKIRTNCD<STOPFUNC;/*                @Z67SP00*/
SCAN     LA    J,1                                                 0305
         B     @DE00305                                            0305
@DL00305 DS    0H                                                  0306
*       IF ICTMNAME(1)=BUFFER(L2:L9)/* LOCATE MOD NAME               */
*         THEN                      /*                       @Z67SP00*/
         LR    @07,J                                               0306
         SLA   @07,2                                               0306
         LR    @05,I                                               0306
         MH    @05,@CH01006                                        0306
         L     @02,CCAICLMD(,CCAPTR)                               0306
         AL    @02,@CF01912                                        0306
         L     @05,ICTLCHN-34(@05,@02)                             0306
         AL    @05,@CF01913                                        0306
         L     @07,ICTIXL(@07,@05)                                 0306
         L     @05,IOPPTR                                          0306
         L     @05,IOPBUFAD(,@05)                                  0306
         CLC   ICTMNAME(8,@07),BUFFER+1(@05)                       0306
         BNE   @RF00306                                            0306
*         IF ICTMCPL(1)=OFF         /* IS MODULE COMPLETE    @Z67SP00*/
*             &ICTMISEL(1)=ON       /* SELECTED              @Z67SP00*/
*             &ICTMMOD(1)=ON        /* MOD REPLACEMENT       @Z67SP00*/
*             &ICTMXPND(1)=OFF      /* NOT EXPAND ENTRY      @Z67SP00*/
*           THEN                                                   0307
         TM    ICTMCPL(@07),B'00100000'                            0307
         BNZ   @RF00307                                            0307
         TM    ICTMISEL(@07),B'10000000'                           0307
         BNO   @RF00307                                            0307
         TM    ICTMMOD(@07),B'10000000'                            0307
         BNO   @RF00307                                            0307
         TM    ICTMXPND(@07),B'00010000'                           0307
         BNZ   @RF00307                                            0307
*           DO;                                                    0308
*             ICTMPROC(1)=ON;       /* SET MOD INPROCESS BIT ON      */
         OI    ICTMPROC(@07),B'10000000'                           0309
*             BUFFER(1)=IOPLMCRC;   /* SO INDICATOR RECORD SKIPED  0310
*                                                            @Z67SP00*/
*                                                                  0310
         MVI   BUFFER(@05),C'@'                                    0310
*             /*******************************************************/
*             /*                                                     */
*             /* GET ALL CHANGE REPLACE RECORDS FOR THIS ELEMENT AND */
*             /* WRITE THEM TO SYSUT1.                       @Z67SP00*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0311
*             DO WHILE BUFFER(1)=IOPLMCRC/* SRCH RCDS        @Z67SP00*/
*                   &LINKEOF=OFF&LKIRTNCD<STOPFUNC;/*        @Z67SP00*/
         B     @DE00311                                            0311
@DL00311 DS    0H                                                  0312
*               CALL READ;          /* READ A CNTL RECORD            */
*                                                                  0312
         BAL   @14,READ                                            0312
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK INDICATOR AND WRITE IF CORRECT      @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0313
*               IF BUFFER(1)=IOPLMCRC/* INDICATE CH/REP CC   @Z67SP00*/
*                   &LINKEOF=OFF&LKIRTNCD<STOPFUNC/*         @Z67SP00*/
*                 THEN                                             0313
         L     @07,IOPPTR                                          0313
         L     @07,IOPBUFAD(,@07)                                  0313
         CLI   BUFFER(@07),C'@'                                    0313
         BNE   @RF00313                                            0313
         TM    LINKEOF,B'00010000'                                 0313
         BNZ   @RF00313                                            0313
         CH    LKIRTNCD,@CH00032                                   0313
         BNL   @RF00313                                            0313
*                 DO;                                              0314
*                   BUFFER(1)=BLANK;/* CLEAR FIRST CHAR              */
         MVI   BUFFER(@07),C' '                                    0315
*                   CALL WRITE;     /* WRITE A CHANGE/REPLACE CARD   */
         BAL   @14,WRITE                                           0316
*                   BUFFER(1)=IOPLMCRC;/* SET FOR PROCC. BELOW     0317
*                                                            @Z67SP00*/
         L     @07,IOPPTR                                          0317
         L     @07,IOPBUFAD(,@07)                                  0317
         MVI   BUFFER(@07),C'@'                                    0317
*                 END;                                             0318
*             END;                                                 0319
*                                                                  0319
@RF00313 DS    0H                                                  0319
@DE00311 L     @07,IOPPTR                                          0319
         L     @07,IOPBUFAD(,@07)                                  0319
         CLI   BUFFER(@07),C'@'                                    0319
         BNE   @DC00311                                            0319
         TM    LINKEOF,B'00010000'                                 0319
         BNZ   @DC00311                                            0319
         CH    LKIRTNCD,@CH00032                                   0319
         BL    @DL00311                                            0319
@DC00311 DS    0H                                                  0320
*             /*******************************************************/
*             /*                                                     */
*             /* ALL CHANGE REPLACE RECORDS HAVE BEEN WRITTEN FOR    */
*             /* THIS ELEMENT.                               @Z67SP00*/
*             /* BUILD INCLUDE FOR ELEMENT WITH CHANGE/REPLACE       */
*             /*                                             @Z67SP00*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0320
*             IF LKIRTNCD<STOPFUNC THEN/*                    @Z67SP00*/
         CH    LKIRTNCD,@CH00032                                   0320
         BNL   @RF00320                                            0320
*               DO;                 /*                       @Z67SP00*/
*                 LIBNAME=ICTFMLIB(1);/* MOVE IN LIB NAME    @Z67SP00*/
         LR    @07,J                                               0322
         SLA   @07,2                                               0322
         LR    @05,I                                               0322
         MH    @05,@CH01006                                        0322
         L     @02,CCAICLMD(,CCAPTR)                               0322
         AL    @02,@CF01912                                        0322
         L     @05,ICTLCHN-34(@05,@02)                             0322
         AL    @05,@CF01913                                        0322
         L     @07,ICTIXL(@07,@05)                                 0322
         MVC   LIBNAME(8),ICTFMLIB(@07)                            0322
*                 MEMNAME=ICTMNAME(1);/* MOVE IN MOD NAME    @Z67SP00*/
         MVC   MEMNAME(8),ICTMNAME(@07)                            0323
*                 PTFNO=ICTPTFS(1); /* AND PTF NUMBER        @Z67SP00*/
         L     @05,ICTPPTR(,@07)                                   0324
         MVC   PTFNO(7),ICTPTFS(@05)                               0324
*                 IF CILPTFNO=PTFNO /* IF MOD FROM PTF       @Z67SP00*/
*                     &ICTMRELN(1)^=ZERO/* AND RELFILE       @Z67SP00*/
*                     &ICTMTRX(1)=OFF/* AND NOT MOVED        @Z67SP00*/
*                   THEN            /* THEN NEED TO ALLOC    @Z67SP00*/
         CLC   CILPTFNO(7),PTFNO                                   0325
         BNE   @RF00325                                            0325
         ICM   @05,3,ICTMRELN(@07)                                 0325
         BZ    @RF00325                                            0325
         TM    ICTMTRX(@07),B'00010000'                            0325
         BNZ   @RF00325                                            0325
*                   RELFALC=ON;     /* RELFILE               @Z67SP00*/
         OI    RELFALC,B'00000100'                                 0326
*                 CALL CTLSTMT;     /*                       @Z67SP00*/
@RF00325 BAL   @14,CTLSTMT                                         0327
*               END;                /*                       @Z67SP00*/
*             IF BUFFER(1)=BLANK    /* MORE NORMAL LKD RECORDS     0329
*                                                            @Z67SP00*/
*               THEN                                               0329
@RF00320 L     @07,IOPPTR                                          0329
         L     @07,IOPBUFAD(,@07)                                  0329
         CLI   BUFFER(@07),C' '                                    0329
         BE    @RT00329                                            0329
*               GOTO CKBLK;         /* BRANCH TO PROCESS RECORD      */
*             ELSE                  /*                       @Z67SP00*/
*                                                                  0331
*               /*****************************************************/
*               /*                                                   */
*               /* THIS MUST BE RECORD INDICATION C/R RECORDS FOLLOW */
*               /* FOR SOME OTHER ELEMENT. RESET ELEMENT LOOP COUNTER*/
*               /* AND LOOK FOR MATCH IN LMODS MODS.         @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0331
*               J=ZERO;             /* RESET LOOP COUNTER            */
         SLR   J,J                                                 0331
*           END;                                                   0332
*     END;                                                         0333
*                                                                  0333
@RF00307 DS    0H                                                  0333
@RF00306 AH    J,@CH00085                                          0333
@DE00305 LR    @07,J                                               0333
         SLA   @07,2                                               0333
         LR    @05,I                                               0333
         MH    @05,@CH01006                                        0333
         L     @02,CCAICLMD(,CCAPTR)                               0333
         AL    @02,@CF01912                                        0333
         L     @05,ICTLCHN-34(@05,@02)                             0333
         AL    @05,@CF01913                                        0333
         L     @07,ICTIXL(@07,@05)                                 0333
         CL    @07,ICTENDIX                                        0333
         BE    @DC00305                                            0333
         TM    LINKEOF,B'00010000'                                 0333
         BNZ   @DC00305                                            0333
         CH    LKIRTNCD,@CH00032                                   0333
         BL    @DL00305                                            0333
@DC00305 DS    0H                                                  0334
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CHANGE REPLACE ELEMENT NOT AN ELEMENT IN THIS LMOD. FLUSH */
*   /* PAST THE RECORDS.                                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0334
*   BUFFER(1)=IOPLMCRC;             /* INDICATE CH/REP       @Z67SP00*/
@RF00304 L     @07,IOPPTR                                          0334
         L     @07,IOPBUFAD(,@07)                                  0334
         MVI   BUFFER(@07),C'@'                                    0334
*   DO WHILE BUFFER(1)=IOPLMCRC     /* SEARCH RECS FOR CH/RP @Z67SP00*/
*         &LINKEOF=OFF&LKIRTNCD<STOPFUNC;/*                  @Z67SP00*/
         B     @DE00335                                            0335
@DL00335 DS    0H                                                  0336
*     CALL READ;                    /* CALL READ RTN                 */
         BAL   @14,READ                                            0336
*   END;                                                           0337
*                                                                  0337
@DE00335 L     @07,IOPPTR                                          0337
         L     @07,IOPBUFAD(,@07)                                  0337
         CLI   BUFFER(@07),C'@'                                    0337
         BNE   @DC00335                                            0337
         TM    LINKEOF,B'00010000'                                 0337
         BNZ   @DC00335                                            0337
         CH    LKIRTNCD,@CH00032                                   0337
         BL    @DL00335                                            0337
@DC00335 DS    0H                                                  0338
*   /*****************************************************************/
*   /*                                                               */
*   /* ONCE PAST THE ELEMENTS CHANGE REPLACE RECORDS CHECK THE NEW   */
*   /* RECORD FOR TYPE                                       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0338
*   IF LINKEOF=OFF&LKIRTNCD<STOPFUNC THEN/*                  @Z67SP00*/
         TM    LINKEOF,B'00010000'                                 0338
         BNZ   @RF00338                                            0338
         CH    LKIRTNCD,@CH00032                                   0338
         BNL   @RF00338                                            0338
*     DO;                           /*                       @Z67SP00*/
*       IF BUFFER(1)=IOPLMCRM       /* MORE C/R RECORDS ?    @Z67SP00*/
*         THEN                                                     0340
         L     @07,IOPPTR                                          0340
         L     @07,IOPBUFAD(,@07)                                  0340
         CLI   BUFFER(@07),C'*'                                    0340
         BE    @RT00340                                            0340
*         GOTO SCAN;                /* PROCESS RECORD                */
*       ELSE                        /* THESE ARE NORMAL RECORDS FOR
*                                      LKD@Z67SP00                   */
*         GOTO CKBLK;               /* PROCESS RECORD                */
         B     CKBLK                                               0342
*     END;                          /*                       @Z67SP00*/
*                                                                  0343
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET INDICATOR FOR END OF FILE FROM CDS MEMBER       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0344
*   LINKEOF=OFF;                    /*                       @Z67SP00*/
@RF00338 NI    LINKEOF,B'11101111'                                 0344
*   END CDSCARDS;                   /*                       @Z67SP00*/
@EL00002 DS    0H                                                  0345
@EF00002 DS    0H                                                  0345
@ER00002 LM    @14,@05,@SA00002                                    0345
         LM    @07,@12,@SA00002+32                                 0345
         BR    @14                                                 0345
         EJECT
*                                                                  0346
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE SETS UP THE OPTIONS LIST FOR LINK EDIT. IT     */
*   /* SCANS THE ICT FOR THE REQUIRED PARAMETERS AND MOVES THEM INTO */
*   /* THE OPTIONS LIST. IT THEN INVOKES THE LINKAGE EDITOR AND      */
*   /* CHECKS THE RETURN CODE.                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0346
*PARMS:                                                            0346
*   PROC;                           /*                       @Z67SP00*/
PARMS    STM   @14,@12,12(@13)                                     0346
*   RFY                                                            0347
*    (ICTLMOD) BASED(CCAICLMD);                                    0347
*   RFY                                                            0348
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0348
*   RFY                                                            0349
*    (ICTMOD) BASED(ICTIXL(J));                                    0349
*   RFY                                                            0350
*    (ICTPTF) BASED(ICTPPTR(1));                                   0350
*   OPTLGTH=ZERO;                   /*                       @Z67SP00*/
         SLR   @02,@02                                             0351
         STH   @02,OPTLGTH                                         0351
*   LX=ZERO;                        /*                       @Z67SP00*/
         SLR   LX,LX                                               0352
*   LY=ZERO;                        /*                       @Z67SP00*/
         SLR   LY,LY                                               0353
*   PARMSET=ON;                     /* LINK PARMS SET UP     @Z67SP00*/
*                                                                  0354
         OI    PARMSET,B'10000000'                                 0354
*   /*****************************************************************/
*   /*                                                               */
*   /* GET USER SUPPLIED PARMS FROM CCA                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0355
*   SYSPRINT=CCALKDSP;              /* SYSPRINT DD NAME      @Z67SP00*/
         L     @05,CCABLDLP(,CCAPTR)                               0355
         MVC   SYSPRINT(8),CCALKDSP(@05)                           0355
*   DO LX=1 BY 1 WHILE CCALKDPM(LX)^=BLANK;/*                @Z67SP00*/
         LA    LX,1                                                0356
         B     @DE00356                                            0356
@DL00356 DS    0H                                                  0357
*     OPTVAR(LX)=CCALKDPM(LX);      /* MOVE THRU PARMS       @Z67SP00*/
         LA    @01,OPTVAR-1(LX)                                    0357
         L     @15,CCABLDLP(,CCAPTR)                               0357
         ALR   @15,LX                                              0357
         MVC   0(1,@01),CCALKDPM-1(@15)                            0357
*   END;                            /*                       @Z67SP00*/
         AH    LX,@CH00085                                         0358
@DE00356 L     @01,CCABLDLP(,CCAPTR)                               0358
         ALR   @01,LX                                              0358
         CLI   CCALKDPM-1(@01),C' '                                0358
         BNE   @DL00356                                            0358
*   IF LX^=1 THEN                   /* ANY USER PARMS?       @Z67SP00*/
         LA    @15,1                                               0359
         CR    LX,@15                                              0359
         BE    @RF00359                                            0359
*     DO;                           /*                       @Z67SP00*/
*       OPTVAR(LX)=COMMA;           /* COMMA AFTER LAST      @Z67SP00*/
         LA    @01,OPTVAR-1(LX)                                    0361
         MVC   0(1,@01),COMMA                                      0361
*       LX=LX+1;                    /* BUMP POSITION         @Z67SP00*/
         ALR   LX,@15                                              0362
*     END;                          /*                       @Z67SP00*/
*   LY=LX-1;                        /* FOR MOVING PARMS      @Z67SP00*/
*                                                                  0364
@RF00359 LR    LY,LX                                               0364
         BCTR  LY,0                                                0364
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW GET LMOD PARMS FOR ICT                            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0365
*   IF ICTLRENT(I)=ON               /* REENTERABLE                   */
*     THEN                                                         0365
         LR    @02,I                                               0365
         MH    @02,@CH01006                                        0365
         L     @01,CCAICLMD(,CCAPTR)                               0365
         ALR   @01,@02                                             0365
         AL    @01,@CF01921                                        0365
         TM    ICTLRENT-9(@01),B'01000000'                         0365
         BNO   @RF00365                                            0365
*     DO;                                                          0366
*       LY=LY+L5;                   /* CALC DISP                     */
         AH    LY,@CH01674                                         0367
*       OPTVAR(LX:LY)=RENT;         /* MOVE RENT PARM                */
         LA    @02,OPTVAR-1(LX)                                    0368
         LR    @15,LY                                              0368
         SLR   @15,LX                                              0368
         EX    @15,@SM01922                                        0368
*     END;                                                         0369
*   IF ICTLREUS(I)=ON               /* SERIALLY REUSABLE             */
*     THEN                                                         0370
@RF00365 LR    @05,I                                               0370
         MH    @05,@CH01006                                        0370
         L     @02,CCAICLMD(,CCAPTR)                               0370
         ALR   @02,@05                                             0370
         AL    @02,@CF01921                                        0370
         TM    ICTLREUS-9(@02),B'00100000'                         0370
         BNO   @RF00370                                            0370
*     DO;                                                          0371
*       LX=LY+L1;                   /* CALC DISP                     */
         LA    LX,1                                                0372
         ALR   LX,LY                                               0372
*       LY=LY+L5;                   /* CALC DISP                     */
         AH    LY,@CH01674                                         0373
*       OPTVAR(LX:LY)=REUS;         /* MOVE REUS PARM                */
         LA    @02,OPTVAR-1(LX)                                    0374
         LR    @15,LY                                              0374
         SLR   @15,LX                                              0374
         EX    @15,@SM01924                                        0374
*     END;                                                         0375
*   IF ICTLSCTR(I)=ON               /* SCATTER LOAD                  */
*     THEN                                                         0376
@RF00370 LR    @05,I                                               0376
         MH    @05,@CH01006                                        0376
         L     @02,CCAICLMD(,CCAPTR)                               0376
         ALR   @02,@05                                             0376
         AL    @02,@CF01921                                        0376
         TM    ICTLSCTR-9(@02),B'00010000'                         0376
         BNO   @RF00376                                            0376
*     DO;                                                          0377
*       LX=LY+L1;                   /* CALC DISP                     */
         LA    LX,1                                                0378
         ALR   LX,LY                                               0378
*       LY=LY+L5;                   /* CALC DISP                     */
         AH    LY,@CH01674                                         0379
*       OPTVAR(LX:LY)=SCTR;         /* MOVE SCTR PARM                */
         LA    @02,OPTVAR-1(LX)                                    0380
         LR    @15,LY                                              0380
         SLR   @15,LX                                              0380
         EX    @15,@SM01926                                        0380
*     END;                                                         0381
*   IF ICTLOVLY(I)=ON               /* OVERLAY STRUCTURE             */
*     THEN                                                         0382
@RF00376 LR    @05,I                                               0382
         MH    @05,@CH01006                                        0382
         L     @02,CCAICLMD(,CCAPTR)                               0382
         ALR   @02,@05                                             0382
         AL    @02,@CF01921                                        0382
         TM    ICTLOVLY-9(@02),B'00001000'                         0382
         BNO   @RF00382                                            0382
*     DO;                                                          0383
*       LX=LY+L1;                   /* CALC DISP                     */
         LA    @02,1                                               0384
         LR    LX,LY                                               0384
         ALR   LX,@02                                              0384
*       LY=LY+L5;                   /* CALC DISP                     */
         LA    @15,5                                               0385
         ALR   LY,@15                                              0385
*       OPTVAR(LX:LY)=OVLY;         /* MOVE OVLY PARM                */
         LA    @01,OPTVAR-1(LX)                                    0386
         LR    @14,LY                                              0386
         SLR   @14,LX                                              0386
         EX    @14,@SM01928                                        0386
*       LX=LY+L1;                   /* CALC DISP                     */
         ALR   @02,LY                                              0387
         LR    LX,@02                                              0387
*       LY=LY+L5;                   /* CALC DISP                     */
         ALR   LY,@15                                              0388
*       OPTVAR(LX:LY)=XCAL;         /* MOVE XCAL PARM                */
         LA    @02,OPTVAR-1(LX)                                    0389
         LR    @15,LY                                              0389
         SLR   @15,LX                                              0389
         EX    @15,@SM01930                                        0389
*     END;                                                         0390
*   IF ICTLREFR(I)=ON               /* REFRESHABLE                   */
*     THEN                                                         0391
@RF00382 LR    @05,I                                               0391
         MH    @05,@CH01006                                        0391
         L     @02,CCAICLMD(,CCAPTR)                               0391
         ALR   @02,@05                                             0391
         AL    @02,@CF01921                                        0391
         TM    ICTLREFR-9(@02),B'00000100'                         0391
         BNO   @RF00391                                            0391
*     DO;                                                          0392
*       LX=LY+L1;                   /* CALC DISP                     */
         LA    LX,1                                                0393
         ALR   LX,LY                                               0393
*       LY=LY+L5;                   /* CALC DISP                     */
         AH    LY,@CH01674                                         0394
*       OPTVAR(LX:LY)=REFR;         /* MOVE REFR PARM                */
         LA    @02,OPTVAR-1(LX)                                    0395
         LR    @15,LY                                              0395
         SLR   @15,LX                                              0395
         EX    @15,@SM01932                                        0395
*     END;                                                         0396
*   IF ICTLDC(I)=ON                 /* DOWNWARD COMPATIBILITY        */
*     THEN                                                         0397
@RF00391 LR    @05,I                                               0397
         MH    @05,@CH01006                                        0397
         L     @02,CCAICLMD(,CCAPTR)                               0397
         ALR   @02,@05                                             0397
         AL    @02,@CF01921                                        0397
         TM    ICTLDC-9(@02),B'00000010'                           0397
         BNO   @RF00397                                            0397
*     DO;                                                          0398
*       LX=LY+L1;                   /* CALC DISP                     */
         LA    LX,1                                                0399
         ALR   LX,LY                                               0399
*       LY=LY+L3;                   /* CALC DISP                     */
         AH    LY,@CH01672                                         0400
*       OPTVAR(LX:LY)=DC;           /* MOVE DC PARM                  */
         LA    @02,OPTVAR-1(LX)                                    0401
         LR    @15,LY                                              0401
         SLR   @15,LX                                              0401
         EX    @15,@SM01934                                        0401
*     END;                                                         0402
*   IF ICTLNE(I)=ON                 /* NOT EDITABLE                  */
*     THEN                                                         0403
@RF00397 LR    @05,I                                               0403
         MH    @05,@CH01006                                        0403
         L     @02,CCAICLMD(,CCAPTR)                               0403
         ALR   @02,@05                                             0403
         AL    @02,@CF01936                                        0403
         TM    ICTLNE-10(@02),B'10000000'                          0403
         BNO   @RF00403                                            0403
*     DO;                                                          0404
*       LX=LY+L1;                   /* CALC DISP                     */
         LA    LX,1                                                0405
         ALR   LX,LY                                               0405
*       LY=LY+L3;                   /* CALC DISP                     */
         AH    LY,@CH01672                                         0406
*       OPTVAR(LX:LY)=NE;           /* MOVE NE PARM                  */
         LA    @02,OPTVAR-1(LX)                                    0407
         LR    @15,LY                                              0407
         SLR   @15,LX                                              0407
         EX    @15,@SM01937                                        0407
*     END;                                                         0408
*   IF ICTLAPF(I)=ON THEN           /* APF PARM, AC=1        @VS08700*/
@RF00403 LR    @05,I                                               0409
         MH    @05,@CH01006                                        0409
         L     @02,CCAICLMD(,CCAPTR)                               0409
         ALR   @02,@05                                             0409
         AL    @02,@CF01921                                        0409
         TM    ICTLAPF-9(@02),B'10000000'                          0409
         BNO   @RF00409                                            0409
*     DO;                           /*                       @VS08700*/
*       LX=LY+L1;                   /* CALC DISP             @VS08700*/
         LA    LX,1                                                0411
         ALR   LX,LY                                               0411
*       LY=LY+L5;                   /* CALC DISP             @VS08700*/
         AH    LY,@CH01674                                         0412
*       OPTVAR(LX:LY)=APF;          /* PASS APF PARM,AC=1 TO EDITOR
*                                                            @VS08700*/
         LA    @02,OPTVAR-1(LX)                                    0413
         LR    @15,LY                                              0413
         SLR   @15,LX                                              0413
         EX    @15,@SM01939                                        0413
*     END;                          /*                       @VS08700*/
*   IF ICTLPAGA(I)=ON               /* VS ALIGN2 OPTION SPECIFIED? 0415
*                                                            @XA05949*/
*     THEN                          /* YES                   @XA05949*/
@RF00409 LR    @05,I                                               0415
         MH    @05,@CH01006                                        0415
         L     @02,CCAICLMD(,CCAPTR)                               0415
         ALR   @02,@05                                             0415
         AL    @02,@CF01936                                        0415
         TM    ICTLPAGA-10(@02),B'01000000'                        0415
         BNO   @RF00415                                            0415
*     DO;                           /* PROCESS IT            @XA05949*/
*       LX=LY+1;                    /* SET STARTING POINT    @XA05949*/
         LA    LX,1                                                0417
         ALR   LX,LY                                               0417
*       LY=LY+LENGTH(ALIGN2);       /* SET ENDING ADDR       @XA05949*/
         AH    LY,@CH00238                                         0418
*       OPTVAR(LX:LY)=ALIGN2;       /* MOVE ALIGN2 TO PARM   @XA05949*/
         LA    @02,OPTVAR-1(LX)                                    0419
         LR    @15,LY                                              0419
         SLR   @15,LX                                              0419
         EX    @15,@SM01941                                        0419
*     END;                          /* END ALIGN2 PROCESSING @XA05949*/
*                                                                  0420
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE PARM LENGTH                                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0421
*   IF LY^=ZERO THEN                /*                       @Z67SP00*/
@RF00415 LTR   LY,LY                                               0421
         BZ    @RF00421                                            0421
*     OPTLGTH=LY-1;                 /*                       @Z67SP00*/
         LR    @05,LY                                              0422
         BCTR  @05,0                                               0422
         STH   @05,OPTLGTH                                         0422
*   ASYSLMOD=ICTTG1(I);             /* SET SYSLMOD FOR LINK          */
@RF00421 LR    @05,I                                               0423
         MH    @05,@CH01006                                        0423
         L     @01,CCAICLMD(,CCAPTR)                               0423
         ALR   @01,@05                                             0423
         AL    @01,@CF01943                                        0423
         MVC   ASYSLMOD(8),ICTTG1-15(@01)                          0423
*   END PARMS;                      /*                       @Z67SP00*/
@EL00003 DS    0H                                                  0424
@EF00003 DS    0H                                                  0424
@ER00003 LM    @14,@12,12(@13)                                     0424
         BR    @14                                                 0424
*                                                                  0425
*   /*****************************************************************/
*   /*                                                               */
*   /* LINK TO THE LINKAGE EDITOR                            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0425
*LINK:                                                             0425
*   PROCEDURE;                                                     0425
*                                                                  0425
LINK     STM   @14,@05,@SA00004                                    0425
         STM   @07,@12,@SA00004+32                                 0425
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE SYSUT1 WHICH IS SYSLIN TO THE LINKAGE EDITOR    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0426
*   CALL CLOSE;                     /* CLOSE SCR1 DATA SET           */
*                                                                  0426
         BAL   @14,CLOSE                                           0426
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLOCATE RELFILE DATASET IF REQUIRED                  @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   IF LKIRTNCD<STOPPTF             /*                       @Z67SP00*/
*       &RELFALC=ON                 /* IF RELFILE ALLOC REQ  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CH    LKIRTNCD,@CH00110                                   0427
         BNL   @RF00427                                            0427
         TM    RELFALC,B'00000100'                                 0427
         BNO   @RF00427                                            0427
*     DO;                           /*                       @Z67SP00*/
*       IOPFUNCT=IOPALC;            /* ALLOCATE IT           @Z67SP00*/
         L     @07,IOPPTR                                          0429
         MVI   IOPFUNCT(@07),X'0D'                                 0429
*       IOPDSID=IOPLRF;             /*                       @Z67SP00*/
         MVI   IOPDSID(@07),X'20'                                  0430
*       IOPDSN=CILPTFDS;            /*                       @Z67SP00*/
         MVC   IOPDSN(44,@07),CILPTFDS                             0431
*       IOPSPACE=''B;               /*                       @Z67SP00*/
         XC    IOPSPACE(6,@07),IOPSPACE(@07)                       0432
*       CALL HMASMIO(HMASMIOP);     /*                       @Z67SP00*/
         ST    @07,@AL00001                                        0433
         L     @15,@CV01634                                        0433
         LA    @01,@AL00001                                        0433
         BALR  @14,@15                                             0433
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* SAVE RC           @Z67SP00*/
         L     @07,IOPPTR                                          0434
         SLR   @15,@15                                             0434
         IC    @15,IOPRETRN(,@07)                                  0434
         CR    LKIRTNCD,@15                                        0434
         BNL   *+6
         LR    LKIRTNCD,@15                                        0434
*       RELFALCD=ON;                /*                       @Z67SP00*/
         OI    RELFALCD,B'00000010'                                0435
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /*                       @Z67SP00*/
*     RELFALCD=OFF;                 /*                       @Z67SP00*/
*                                                                  0437
         B     @RC00427                                            0437
@RF00427 NI    RELFALCD,B'11111101'                                0437
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ALL OK THEN CALL IEWL                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0438
*   IF LKIRTNCD<STOPPTF             /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RC00427 CH    LKIRTNCD,@CH00110                                   0438
         BNL   @RF00438                                            0438
*     DO;                           /*                       @Z67SP00*/
*       RFY                                                        0440
*         LINKREG RSTD;                                            0440
*       LINKREG=CCALKED;            /* ADDR BLDL ENTRY - LKED        */
         L     @07,CCABLDLP(,CCAPTR)                               0441
         L     LINKREG,CCALKED(,@07)                               0441
*       SAVRVANM=RVAEPRNM;          /* SAVE SMP PROCESSOR NM @Z67SP00*/
         L     @03,CCARVAD(,CCAPTR)                                0442
         MVC   SAVRVANM(8),RVAEPRNM(@03)                           0442
*       RVAEPRNM=CCALKDNM;          /* INDICATE LINKEDITOR   @Z67SP00*/
         MVC   RVAEPRNM(8,@03),CCALKDNM(@07)                       0443
*       GENERATE;                                                  0444
         LINK  DE=(LINKREG),PARAM=(OPTLST,DDNAMES),VL=1 EXEC LKED   */
*       RFY                                                        0445
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       RVAEPRNM=SAVRVANM;          /* RESTORE SMP NAME      @Z67SP00*/
         L     @14,CCARVAD(,CCAPTR)                                0446
         MVC   RVAEPRNM(8,@14),SAVRVANM                            0446
*       RFY                                                        0447
*         LINKREG UNRSTD;                                          0447
*       CVD(RTNCODE,SAVE1);         /* CONVERT TO DECIMAL    @Z40SP00*/
         CVD   RTNCODE,SAVE1                                       0448
*       UNPK(SAVE2,SAVE1);          /* UNPACK                @Z40SP00*/
         UNPK  SAVE2(8),SAVE1(8)                                   0449
*       SIGN=MASK;                  /* ELIMINATE SIGN BIT    @Z40SP00*/
         OI    SIGN,B'11110000'                                    0450
*       IF RTNCODE>CCARLINK         /* SUCCESSFUL RETURN?    @YA07506*/
*         THEN                                                     0451
         L     @14,CCABLDLP(,CCAPTR)                               0451
         SLR   @07,@07                                             0451
         IC    @07,CCARLINK(,@14)                                  0451
         CR    RTNCODE,@07                                         0451
         BNH   @RF00451                                            0451
*         DO;                                                      0452
*           LKIRTNCD=MAX(LKIRTNCD,STOPPTF);/* SET RC         @ZA16652*/
         LA    @14,8                                               0453
         CR    LKIRTNCD,@14                                        0453
         BNL   *+6
         LR    LKIRTNCD,@14                                        0453
*           LINKERR=ON;             /* SET ERROR INDICATOR           */
         OI    LINKERR,B'00100000'                                 0454
*         END;                                                     0455
*       ELSE                                                       0456
*         DO;                                                      0456
         B     @RC00451                                            0456
@RF00451 DS    0H                                                  0457
*           IF RTNCODE^=ZERO        /* IF NON-ZERO RTN       @ZA16652*/
*             THEN                  /* THEN MUST BE          @ZA16652*/
         LTR   RTNCODE,RTNCODE                                     0457
         BZ    @RF00457                                            0457
*             LKIRTNCD=MAX(LKIRTNCD,WARNPTF);/* SET RC       @ZA16652*/
         LA    @14,4                                               0458
         CR    LKIRTNCD,@14                                        0458
         BNL   *+6
         LR    LKIRTNCD,@14                                        0458
*         END;                                                     0459
*                                                                  0459
@RF00457 DS    0H                                                  0460
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MESSAGES FOR LINK COMPLETION                @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0460
*       CALL COMPMSG;               /* CALL COMPLETE RTN     @Z67SP00*/
@RC00451 BAL   @14,COMPMSG                                         0460
*     END;                          /*                       @Z67SP00*/
*   RFY                                                            0462
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
*                                                                  0462
@RF00438 DS    0H                                                  0463
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW FREE ALLOCATED RELFILES                           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0463
*   RELFALC=OFF;                    /*                       @Z67SP00*/
         NI    RELFALC,B'11111011'                                 0463
*   IF RELFALCD=ON                  /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    RELFALCD,B'00000010'                                0464
         BNO   @RF00464                                            0464
*     DO;                           /*                       @Z67SP00*/
*       IOPFUNCT=IOPDALC;           /*                       @Z67SP00*/
         L     @07,IOPPTR                                          0466
         MVI   IOPFUNCT(@07),X'0E'                                 0466
*       IOPDSID=IOPLRF;             /*                       @Z67SP00*/
         MVI   IOPDSID(@07),X'20'                                  0467
*       IOPDSN=CILPTFDS;            /*                       @Z67SP00*/
         MVC   IOPDSN(44,@07),CILPTFDS                             0468
*       IOPSPACE=''B;               /*                       @Z67SP00*/
         XC    IOPSPACE(6,@07),IOPSPACE(@07)                       0469
*       CALL HMASMIO(HMASMIOP);     /*                       @Z67SP00*/
         ST    @07,@AL00001                                        0470
         L     @15,@CV01634                                        0470
         LA    @01,@AL00001                                        0470
         BALR  @14,@15                                             0470
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* SAVE RC           @Z67SP00*/
         L     @07,IOPPTR                                          0471
         SLR   @15,@15                                             0471
         IC    @15,IOPRETRN(,@07)                                  0471
         CR    LKIRTNCD,@15                                        0471
         BNL   *+6
         LR    LKIRTNCD,@15                                        0471
*       RELFALCD=OFF;               /*                       @Z67SP00*/
         NI    RELFALCD,B'11111101'                                0472
*     END;                          /*                       @Z67SP00*/
*   END LINK;                                                      0474
@EL00004 DS    0H                                                  0474
@EF00004 DS    0H                                                  0474
@ER00004 LM    @14,@05,@SA00004                                    0474
         LM    @07,@12,@SA00004+32                                 0474
         BR    @14                                                 0474
         EJECT
*                                                                  0475
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE GAINS CONTROL ON A EOF RETURN FROM THE I/O     */
*   /* ROUTINE. IT BUILDS AN INCLUDE CARD FOR THE MODULE CURRENTLY   */
*   /* BEING PROCESSED IF ONE HAS NOT BEEN ALREADY AND AN INCLUDE    */
*   /* CARD FOR ANY MODULES THAT STILL REMAIN ON THE ICT. IT THEN    */
*   /* BUILDS AN INCLUDE CARD FOR THE LOAD MODULE, FOLLOWED BY A NAME*/
*   /* CARD.                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0475
*MODCHK:                                                           0475
*   PROCEDURE;                                                     0475
MODCHK   STM   @14,@05,@SA00005                                    0475
         STM   @07,@12,@SA00005+32                                 0475
*   RFY                                                            0476
*    (ICTLMOD) BASED(CCAICLMD);                                    0476
*   RFY                                                            0477
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0477
*   RFY                                                            0478
*    (ICTMOD) BASED(ICTIXL(J));                                    0478
*   RFY                                                            0479
*    (ICTPTF) BASED(ICTPPTR(1));                                   0479
*                                                                  0479
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU THE MODULES IN THE LOAD MODULE              @ZD00001*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0480
*   DO J=1 BY 1 WHILE ICTIXL(J)^=ICTENDIX;/* SEARCH MODS     @Z67SP00*/
         LA    J,1                                                 0480
         B     @DE00480                                            0480
@DL00480 DS    0H                                                  0481
*     IF(ICTMPROC(1)=OFF&           /* IF MOD NOT INPROCESS-         */
*         ICTMCPL(1)=OFF)           /* NOT COMPLETE          @OY04018*/
*         &ICTMISEL(1)=ON           /* SELECTED              @Z67SP00*/
*         &ICTMMOD(1)=ON            /* MOD REPLACEMENT       @Z67SP00*/
*         &ICTMXPND(1)=OFF          /* NOT EXPAND ENTRY      @Z67SP00*/
*       THEN                        /* THEN BUILD THE MOD INCLUDE  0481
*                                      CARD BEFORE           @OY04018*/
         LR    @07,J                                               0481
         SLA   @07,2                                               0481
         LR    @05,I                                               0481
         MH    @05,@CH01006                                        0481
         L     @02,CCAICLMD(,CCAPTR)                               0481
         AL    @02,@CF01912                                        0481
         L     @05,ICTLCHN-34(@05,@02)                             0481
         AL    @05,@CF01913                                        0481
         L     @07,ICTIXL(@07,@05)                                 0481
         TM    ICTMPROC(@07),B'10100000'                           0481
         BNZ   @RF00481                                            0481
         TM    ICTMISEL(@07),B'10000000'                           0481
         BNO   @RF00481                                            0481
         TM    ICTMMOD(@07),B'10000000'                            0481
         BNO   @RF00481                                            0481
         TM    ICTMXPND(@07),B'00010000'                           0481
         BNZ   @RF00481                                            0481
*       DO;                         /* THE LMOD INCLUDE CARD @OY04018*/
*         LIBNAME=ICTFMLIB(1);      /* SET LIB NAME                  */
         MVC   LIBNAME(8),ICTFMLIB(@07)                            0483
*         MEMNAME=ICTMNAME(1);      /* SET MEMBER NAME               */
         MVC   MEMNAME(8),ICTMNAME(@07)                            0484
*         PTFNO=ICTPTFS(1);         /* PTF NO FOR PRINTING   @ZD00001*/
         L     @05,ICTPPTR(,@07)                                   0485
         MVC   PTFNO(7),ICTPTFS(@05)                               0485
*         IF CILPTFNO=PTFNO         /* IF MOD FROM PTF       @Z67SP00*/
*             &ICTMRELN(1)^=ZERO    /* AND RELFILE           @Z67SP00*/
*             &ICTMTRX(1)=OFF       /* AND NOT MOVED         @Z67SP00*/
*           THEN                    /* THEN NEED TO ALLOC    @Z67SP00*/
         CLC   CILPTFNO(7),PTFNO                                   0486
         BNE   @RF00486                                            0486
         ICM   @05,3,ICTMRELN(@07)                                 0486
         BZ    @RF00486                                            0486
         TM    ICTMTRX(@07),B'00010000'                            0486
         BNZ   @RF00486                                            0486
*           RELFALC=ON;             /* RELFILE               @Z67SP00*/
         OI    RELFALC,B'00000100'                                 0487
*         CALL CTLSTMT;             /* CALL CTLSTMT ROUTINE          */
@RF00486 BAL   @14,CTLSTMT                                         0488
*         IF LKIRTNCD>=STOPFUNC     /* STOP FUNCTION?        @YA07506*/
*           THEN                                                   0489
         CH    LKIRTNCD,@CH00032                                   0489
         BNL   @RT00489                                            0489
*           RETURN;                 /* YES                   @YA07506*/
*         ICTMPROC(1)=ON;           /* SET INPROCESS BIT             */
         LR    @07,J                                               0491
         SLA   @07,2                                               0491
         LR    @05,I                                               0491
         MH    @05,@CH01006                                        0491
         L     @02,CCAICLMD(,CCAPTR)                               0491
         AL    @02,@CF01912                                        0491
         L     @05,ICTLCHN-34(@05,@02)                             0491
         AL    @05,@CF01913                                        0491
         L     @07,ICTIXL(@07,@05)                                 0491
         OI    ICTMPROC(@07),B'10000000'                           0491
*       END;                                                       0492
*   END;                                                           0493
*                                                                  0493
@RF00481 AH    J,@CH00085                                          0493
@DE00480 LR    @07,J                                               0493
         SLA   @07,2                                               0493
         LR    @05,I                                               0493
         MH    @05,@CH01006                                        0493
         L     @02,CCAICLMD(,CCAPTR)                               0493
         LA    @01,0(@05,@02)                                      0493
         AL    @01,@CF01912                                        0493
         L     @01,ICTLCHN-34(,@01)                                0493
         AL    @01,@CF01913                                        0493
         L     @07,ICTIXL(@07,@01)                                 0493
         CL    @07,ICTENDIX                                        0493
         BNE   @DL00480                                            0493
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR NEED TO BYPASS BUILD OF LMOD INCLUDE FROM SYSLMOD.  */
*   /*                                                       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0494
*   IF ICTLNE(I)=ON                 /* IF NOT-EDITABLE       @Z67SP00*/
*       ×(CCAACCPT=ON&ICTLXPND(I)=OFF)/* ..OR ACCEPT AND EXPAND    0494
*                                                            @Z67SP00*/
*       ×(ICTCOPY(I)=ON&ICTLXPND(I)=OFF)/* .. OR SYSGEN COPY LMOD  0494
*                                      BEING EXPANDED        @Z67SP00*/
*     THEN                                                         0494
         ST    @05,@TF00001                                        0494
         ALR   @05,@02                                             0494
         AL    @05,@CF01936                                        0494
         TM    ICTLNE-10(@05),B'10000000'                          0494
         BO    @RT00494                                            0494
         TM    CCAACCPT(CCAPTR),B'00100000'                        0494
         BNO   @GL00033                                            0494
         AL    @02,@TF00001                                        0494
         AL    @02,@CF01910                                        0494
         TM    ICTLXPND-14(@02),B'00100000'                        0494
         BZ    @RT00494                                            0494
@GL00033 LR    @07,I                                               0494
         MH    @07,@CH01006                                        0494
         L     @05,CCAICLMD(,CCAPTR)                               0494
         ST    @07,@TF00001                                        0494
         ALR   @07,@05                                             0494
         AL    @07,@CF01949                                        0494
         TM    ICTCOPY-13(@07),B'10000000'                         0494
         BNO   @RF00494                                            0494
         AL    @05,@TF00001                                        0494
         AL    @05,@CF01910                                        0494
         TM    ICTLXPND-14(@05),B'00100000'                        0494
         BZ    @RT00494                                            0494
*     ;                             /* THEN INCLUDE STATEMENT WILL 0495
*                                      NOT BE BUILT          @Z67SP00*/
*   ELSE                            /* OTHERWISE THE LMOD INCLUDE IS
*                                      CONSTRUCTED                   */
*     DO;                                                          0496
@RF00494 DS    0H                                                  0497
*       LIBNAME=ICTTG1(I);          /* SET LIB NAME                  */
         LR    @07,I                                               0497
         MH    @07,@CH01006                                        0497
         L     @05,CCAICLMD(,CCAPTR)                               0497
         ST    @07,@TF00001                                        0497
         ALR   @07,@05                                             0497
         AL    @07,@CF01943                                        0497
         MVC   LIBNAME(8),ICTTG1-15(@07)                           0497
*       MEMNAME=ICTLMNAM(I);        /* SET LM NAME                   */
         AL    @05,@TF00001                                        0498
         AL    @05,@CF01916                                        0498
         MVC   MEMNAME(8),ICTLMNAM(@05)                            0498
*       PTFNO=BLANK;                /* NO PTF NO. PRINTED    @ZD00001*/
         MVI   PTFNO+1,C' '                                        0499
         MVC   PTFNO+2(5),PTFNO+1                                  0499
         MVI   PTFNO,C' '                                          0499
*       CALL CTLSTMT;               /* INCLUDE FROM SYSLMOD          */
         BAL   @14,CTLSTMT                                         0500
*       IF LKIRTNCD>=STOPFUNC       /* STOP FUNCTION?        @YA07506*/
*         THEN                                                     0501
         CH    LKIRTNCD,@CH00032                                   0501
         BNL   @RT00501                                            0501
*         RETURN;                   /* YES                   @YA07506*/
*     END;                                                         0503
*                                                                  0503
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD INCLUDE FOR EXPAND CARDS AFTER LMOD INCLUDE     @OY04018*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0504
*   DO J=1 BY 1                     /* SEARCH THRU MODSIN THIS LMOD
*                                                            @Z67SP00*/
*         WHILE ICTIXL(J)^=ICTENDIX;/* LOOK FOR EXPANDABLES  @Z67SP00*/
@RT00494 LA    J,1                                                 0504
         B     @DE00504                                            0504
@DL00504 DS    0H                                                  0505
*     IF ICTMPROC(1)=OFF            /* IS MOD NOT INPROCESS  @OY04018*/
*         &ICTMCPL(1)=OFF           /* AND NOT COMPLETE      @OY04018*/
*         &ICTMISEL(1)=ON           /* SELECTED              @Z67SP00*/
*         &ICTMXPND(1)=ON THEN      /* AND EXPANDABLE        @OY04018*/
         LR    @07,J                                               0505
         SLA   @07,2                                               0505
         LR    @05,I                                               0505
         MH    @05,@CH01006                                        0505
         L     @02,CCAICLMD(,CCAPTR)                               0505
         AL    @02,@CF01912                                        0505
         L     @05,ICTLCHN-34(@05,@02)                             0505
         AL    @05,@CF01913                                        0505
         L     @07,ICTIXL(@07,@05)                                 0505
         TM    ICTMPROC(@07),B'10100000'                           0505
         BNZ   @RF00505                                            0505
         TM    ICTMISEL(@07),B'10000000'                           0505
         BNO   @RF00505                                            0505
         TM    ICTMXPND(@07),B'00010000'                           0505
         BNO   @RF00505                                            0505
*       DO;                         /* THEN CREATE INCLUDE FOR EXPAND
*                                      CARDS ON PTS@OY04018          */
*         LIBNAME=ICTFMLIB(1);      /* LIB NAME FOR INCLUDE, PTS   0507
*                                                            @OY04018*/
         MVC   LIBNAME(8),ICTFMLIB(@07)                            0507
*         MEMNAME=ICTMNAME(1);      /* MOOVE IN MOD NAME FROM ICT  0508
*                                                            @OY04018*/
         MVC   MEMNAME(8),ICTMNAME(@07)                            0508
*         PTFNO=ICTPTFS(1);         /* PTF FOR PRINTING      @ZD00001*/
         L     @07,ICTPPTR(,@07)                                   0509
         MVC   PTFNO(7),ICTPTFS(@07)                               0509
*         CALL CTLSTMT;             /* BUILD LOWERCASE NAME INCLUDE
*                                                            @OY04018*/
         BAL   @14,CTLSTMT                                         0510
*         ICTMPROC(1)=ON;           /* MOD INPROCESS         @OY05117*/
         LR    @07,J                                               0511
         SLA   @07,2                                               0511
         LR    @05,I                                               0511
         MH    @05,@CH01006                                        0511
         L     @02,CCAICLMD(,CCAPTR)                               0511
         AL    @02,@CF01912                                        0511
         L     @05,ICTLCHN-34(@05,@02)                             0511
         AL    @05,@CF01913                                        0511
         L     @07,ICTIXL(@07,@05)                                 0511
         OI    ICTMPROC(@07),B'10000000'                           0511
*         IF LKIRTNCD>=STOPFUNC     /* STOP FUNCTION?        @YA07506*/
*           THEN                                                   0512
         CH    LKIRTNCD,@CH00032                                   0512
         BNL   @RT00512                                            0512
*           RETURN;                 /* YES                   @YA07506*/
*       END;                        /* END OF BUILD INCLUDE DO     0514
*                                                            @OY04018*/
*   END;                            /* END OF LOOP LOOKING OF      0515
*                                      EXPANDABLE MODS       @OY04018*/
*                                                                  0515
@RF00505 AH    J,@CH00085                                          0515
@DE00504 LR    @07,J                                               0515
         SLA   @07,2                                               0515
         LR    @05,I                                               0515
         MH    @05,@CH01006                                        0515
         L     @02,CCAICLMD(,CCAPTR)                               0515
         LA    @01,0(@05,@02)                                      0515
         AL    @01,@CF01912                                        0515
         L     @15,ICTLCHN-34(,@01)                                0515
         AL    @07,@CF01913                                        0515
         L     @07,ICTIXL(@07,@15)                                 0515
         CL    @07,ICTENDIX                                        0515
         BNE   @DL00504                                            0515
*   /*****************************************************************/
*   /*                                                               */
*   /* ALIAS STATEMENTS BUILT                                @ZD00001*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0516
*   J=1;                            /* SET INDEX TO MOD SECTION      */
         LA    @07,1                                               0516
         LR    J,@07                                               0516
*   RFY                                                            0517
*     ICTTALLS BASED(ICTMTCHN(1));  /* ALIAS NAME LIST BASE  @Z67SP00*/
*   IF ICTMALIS(1)=ON               /* ALIAS ON ++MOD        @ZA16651*/
*       &ICTMNAME(1)=ICTLMNAM(I)    /* AND COPIED AT SYSGEN  @ZA16651*/
*     THEN                          /* THEN LMOD NEEDS ALIAS         */
         LR    @14,J                                               0518
         SLA   @14,2                                               0518
         AL    @15,@CF01913                                        0518
         L     @15,ICTIXL(@14,@15)                                 0518
         TM    ICTMALIS(@15),B'00000100'                           0518
         BNO   @RF00518                                            0518
         ALR   @02,@05                                             0518
         AL    @02,@CF01916                                        0518
         CLC   ICTMNAME(8,@15),ICTLMNAM(@02)                       0518
         BNE   @RF00518                                            0518
*     DO;                                                          0519
*                                                                  0519
*       /*************************************************************/
*       /*                                                           */
*       /* MOD COUNTER RESET FOR COPIED LMODS WHERE MODS AND LMODS   */
*       /* ARE ONE FOR ONE.                                  @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0520
*       DO R=1 BY 1 WHILE ICTTALND(R)^=ICTENDIX;/*           @Z67SP00*/
         LR    R,@07                                               0520
         B     @DE00520                                            0520
@DL00520 DS    0H                                                  0521
*         BUFFER=BLANK;             /* BLANK THE BUFFER              */
         L     @07,IOPPTR                                          0521
         L     @07,IOPBUFAD(,@07)                                  0521
         MVI   BUFFER+1(@07),C' '                                  0521
         MVC   BUFFER+2(78,@07),BUFFER+1(@07)                      0521
         MVI   BUFFER(@07),C' '                                    0521
*         BUFFER(L2:L6)=ALIAS;      /* MOVE IN ALIAS STMT            */
         MVC   BUFFER+1(5,@07),ALIAS                               0522
*         BUFFER(L8:L15)=ICTTALNM(R);/* PUT IN NAME          @Z67SP00*/
         LR    @02,R                                               0523
         SLA   @02,3                                               0523
         LR    @15,J                                               0523
         SLA   @15,2                                               0523
         LR    @14,I                                               0523
         MH    @14,@CH01006                                        0523
         L     @01,CCAICLMD(,CCAPTR)                               0523
         AL    @01,@CF01912                                        0523
         L     @01,ICTLCHN-34(@14,@01)                             0523
         AL    @01,@CF01913                                        0523
         L     @01,ICTIXL(@15,@01)                                 0523
         L     @01,ICTMTCHN(,@01)                                  0523
         ALR   @01,@02                                             0523
         AL    @01,@CF01950                                        0523
         MVC   BUFFER+7(8,@07),ICTTALNM(@01)                       0523
*         CALL WRITE;               /* WRITE STMT OUT                */
         BAL   @14,WRITE                                           0524
*         IF LKIRTNCD>=STOPFUNC     /* STOP A FUNCTION?      @YA07506*/
*           THEN                                                   0525
         CH    LKIRTNCD,@CH00032                                   0525
         BNL   @RT00525                                            0525
*           RETURN;                 /* YES                   @YA07506*/
*       END;                                                       0527
         AH    R,@CH00085                                          0527
@DE00520 LR    @07,R                                               0527
         SLA   @07,3                                               0527
         LR    @02,J                                               0527
         SLA   @02,2                                               0527
         LR    @15,I                                               0527
         MH    @15,@CH01006                                        0527
         L     @01,CCAICLMD(,CCAPTR)                               0527
         AL    @01,@CF01912                                        0527
         L     @01,ICTLCHN-34(@15,@01)                             0527
         AL    @01,@CF01913                                        0527
         L     @02,ICTIXL(@02,@01)                                 0527
         L     @02,ICTMTCHN(,@02)                                  0527
         AL    @02,@CF01950                                        0527
         L     @07,ICTTALND(@07,@02)                               0527
         CL    @07,ICTENDIX                                        0527
         BNE   @DL00520                                            0527
*     END;                          /*                       @YA07506*/
*                                                                  0528
*   /*****************************************************************/
*   /*                                                               */
*   /* NAME STATEMENT                                        @ZA16651*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0529
*   BUFFER=BLANK;                   /* CLEAR BUFFER                  */
@RF00518 L     @07,IOPPTR                                          0529
         L     @07,IOPBUFAD(,@07)                                  0529
         MVI   BUFFER+1(@07),C' '                                  0529
         MVC   BUFFER+2(78,@07),BUFFER+1(@07)                      0529
         MVI   BUFFER(@07),C' '                                    0529
*   BUFFER(L2:L6)=NAME;             /* INSERT NAME                   */
         MVC   BUFFER+1(5,@07),NAME                                0530
*   LX=L8;                          /* SET LGTH FIELD                */
         LA    LX,8                                                0531
*CK3:                                                              0532
*   IF ICTLMNAM(I,LX)=BLANK         /* LAST POSITION BLANK           */
*     THEN                                                         0532
CK3      LR    @07,I                                               0532
         MH    @07,@CH01006                                        0532
         ALR   @07,LX                                              0532
         L     @01,CCAICLMD(,CCAPTR)                               0532
         ALR   @01,@07                                             0532
         AL    @01,@CF01951                                        0532
         CLI   ICTLMNAM(@01),C' '                                  0532
         BNE   @RF00532                                            0532
*     DO;                                                          0533
*       LX=LX-L1;                   /* CK NEXT POSITION              */
         BCTR  LX,0                                                0534
*       GOTO CK3;                   /* BRANCH BACK TO TEST           */
         B     CK3                                                 0535
*     END;                                                         0536
*   LY=L6+LX;                       /* CALC DISP                     */
@RF00532 LA    LY,6                                                0537
         ALR   LY,LX                                               0537
*   BUFFER(L7:LY)=ICTLMNAM(I);      /* MOVE IN MEMBER NAME           */
         L     @05,IOPPTR                                          0538
         L     @05,IOPBUFAD(,@05)                                  0538
         LR    @02,LY                                              0538
         SH    @02,@CH00238                                        0538
         LR    @15,I                                               0538
         MH    @15,@CH01006                                        0538
         L     @01,CCAICLMD(,CCAPTR)                               0538
         ALR   @01,@15                                             0538
         AL    @01,@CF01916                                        0538
         EX    @02,@SM01952                                        0538
*   LZ=LY+L3;                       /* CALC DISP                     */
         LA    LZ,3                                                0539
         ALR   LZ,LY                                               0539
*   LY=LY+L1;                       /* CALC DISP                     */
         AH    LY,@CH01668                                         0540
*   BUFFER(LY:LZ)=REPL;             /* MOVE IN REPLACE               */
         ALR   @05,LY                                              0541
         BCTR  @05,0                                               0541
         LR    @02,LZ                                              0541
         SLR   @02,LY                                              0541
         EX    @02,@SM01954                                        0541
*   CALL WRITE;                     /* CALL WRITE RTN                */
*                                                                  0542
         BAL   @14,WRITE                                           0542
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET INPROCESS INDICATOR                             @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0543
*   DO J=1 BY 1                     /* SEARCH THRU MODSIN THIS LMOD
*                                                            @Z67SP00*/
*         WHILE ICTIXL(J)^=ICTENDIX;/*                       @Z67SP00*/
         LA    J,1                                                 0543
         B     @DE00543                                            0543
@DL00543 DS    0H                                                  0544
*     IF ICTMPROC(1)=ON             /* IS MOD INPROCESS      @Z67SP00*/
*       THEN                                                       0544
         LR    @07,J                                               0544
         SLA   @07,2                                               0544
         LR    @05,I                                               0544
         MH    @05,@CH01006                                        0544
         L     @02,CCAICLMD(,CCAPTR)                               0544
         AL    @02,@CF01912                                        0544
         L     @05,ICTLCHN-34(@05,@02)                             0544
         AL    @05,@CF01913                                        0544
         L     @07,ICTIXL(@07,@05)                                 0544
         TM    ICTMPROC(@07),B'10000000'                           0544
         BNO   @RF00544                                            0544
*       ICTMPROC(1)=OFF;            /*                       @Z67SP00*/
         NI    ICTMPROC(@07),B'01111111'                           0545
*   END;                            /*                       @Z67SP00*/
@RF00544 AH    J,@CH00085                                          0546
@DE00543 LR    @07,J                                               0546
         SLA   @07,2                                               0546
         LR    @05,I                                               0546
         MH    @05,@CH01006                                        0546
         L     @02,CCAICLMD(,CCAPTR)                               0546
         AL    @02,@CF01912                                        0546
         L     @05,ICTLCHN-34(@05,@02)                             0546
         AL    @05,@CF01913                                        0546
         L     @07,ICTIXL(@07,@05)                                 0546
         CL    @07,ICTENDIX                                        0546
         BNE   @DL00543                                            0546
*   END MODCHK;                                                    0547
@EL00005 DS    0H                                                  0547
@EF00005 DS    0H                                                  0547
@ER00005 LM    @14,@05,@SA00005                                    0547
         LM    @07,@12,@SA00005+32                                 0547
         BR    @14                                                 0547
         EJECT
*                                                                  0548
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE CREATES THE ACTUAL INCLUDE CARD FOR THE LINKAGE*/
*   /* EDITOR.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0548
*CTLSTMT:                                                          0548
*   PROCEDURE;                                                     0548
CTLSTMT  STM   @14,@05,@SA00006                                    0548
         STM   @07,@12,@SA00006+32                                 0548
*   RFY                                                            0549
*    (ICTLMOD) BASED(CCAICLMD);                                    0549
*   RFY                                                            0550
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0550
*   RFY                                                            0551
*    (ICTMOD) BASED(ICTIXL(J));                                    0551
*   RFY                                                            0552
*    (ICTPTF) BASED(ICTPPTR(1));                                   0552
*   CTLBUFF=BLANK;                  /* CLEAR BUFFER                  */
         MVI   CTLBUFF+1,C' '                                      0553
         MVC   CTLBUFF+2(78),CTLBUFF+1                             0553
         MVI   CTLBUFF,C' '                                        0553
*   CTLBUFF(L2:L8)=INCLUDE;         /* MOVE INCLUDE STMT             */
         MVC   CTLBUFF+1(7),INCLUDE                                0554
*   LX=L8;                          /* SET LENGTH FIELD              */
         LA    LX,8                                                0555
*CK1:                                                              0556
*   IF LIBNAME(LX)=BLANK            /* LAST CHAR BLANK               */
*     THEN                                                         0556
CK1      LA    @07,LIBNAME-1(LX)                                   0556
         CLI   0(@07),C' '                                         0556
         BNE   @RF00556                                            0556
*     DO;                                                          0557
*       LX=LX-L1;                   /* CK NEXT POSITION              */
         BCTR  LX,0                                                0558
*       GOTO CK1;                   /* BRANCH BACK TO TEST           */
         B     CK1                                                 0559
*     END;                                                         0560
*   LY=L9+LX;                       /* CALC DISP IN BUFFER           */
@RF00556 LA    LY,9                                                0561
         ALR   LY,LX                                               0561
*   CTLBUFF(L10:LY)=LIBNAME;        /* MOVE IN LIB NAME              */
         LR    @07,LY                                              0562
         SH    @07,@CH00033                                        0562
         EX    @07,@SM01956                                        0562
*   LY=LY+L1;                       /* CALC DISP                     */
         AH    LY,@CH01668                                         0563
*   CTLBUFF(LY)=LPAREN;             /* MOVE IN LEFT PAREN            */
         LA    @07,CTLBUFF-1(LY)                                   0564
         MVC   0(1,@07),LPAREN                                     0564
*   LX=L8;                          /* SET LGTH FIELD                */
         LA    LX,8                                                0565
*CK2:                                                              0566
*   IF MEMNAME(LX)=BLANK            /* LAST CHAR BLANK               */
*     THEN                                                         0566
CK2      LA    @07,MEMNAME-1(LX)                                   0566
         CLI   0(@07),C' '                                         0566
         BNE   @RF00566                                            0566
*     DO;                                                          0567
*       LX=LX-L1;                   /* CK NEXT POSITION              */
         BCTR  LX,0                                                0568
*       GOTO CK2;                   /* BRANCH BACK TO TEST           */
         B     CK2                                                 0569
*     END;                                                         0570
*   LZ=LY+LX;                       /* CALC DISP                     */
@RF00566 LR    LZ,LY                                               0571
         ALR   LZ,LX                                               0571
*   LY=LY+L1;                       /* CALC DISP                     */
         LA    @02,1                                               0572
         ALR   LY,@02                                              0572
*   CTLBUFF(LY:LZ)=MEMNAME;         /* MOVE IN MOD NAME      @Z67SP00*/
         LA    @01,CTLBUFF-1(LY)                                   0573
         LR    @15,LZ                                              0573
         SLR   @15,LY                                              0573
         EX    @15,@SM01958                                        0573
*   LZ=LZ+L1;                       /* CALC DISP                     */
         ALR   LZ,@02                                              0574
*   CTLBUFF(LZ)=RPAREN;             /* MOVE IN RIGHT PAREN   @Z67SP00*/
         LA    @01,CTLBUFF-1(LZ)                                   0575
         MVC   0(1,@01),RPAREN                                     0575
*   CTLBUFF(41:47)=PTFNO;           /* PTF NO. INTO STMT     @ZD00001*/
         MVC   CTLBUFF+40(7),PTFNO                                 0576
*   IOPBUFAD=ADDR(CTLBUFF);         /* ALTERNATE BUFFER      @Z67SP00*/
         LA    @07,CTLBUFF                                         0577
         L     @01,IOPPTR                                          0577
         ST    @07,IOPBUFAD(,@01)                                  0577
*   CALL WRITE;                     /* CALL WRITE RTN                */
         BAL   @14,WRITE                                           0578
*   IOPBUFAD=ADDR(BUFFER);          /* ORIGINAL BUFFER       @Z67SP00*/
         L     @07,IOPPTR                                          0579
         L     @15,IOPBUFAD(,@07)                                  0579
         ST    @15,IOPBUFAD(,@07)                                  0579
*   END CTLSTMT;                                                   0580
@EL00006 DS    0H                                                  0580
@EF00006 DS    0H                                                  0580
@ER00006 LM    @14,@05,@SA00006                                    0580
         LM    @07,@12,@SA00006+32                                 0580
         BR    @14                                                 0580
         EJECT
*                                                                  0581
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE ISSUES A POINT REQUEST TO THE I/O ROUTINE WHEN */
*   /* CALLED.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0581
*POINT:                                                            0581
*   PROCEDURE;                                                     0581
POINT    STM   @14,@05,@SA00007                                    0581
         STM   @07,@12,@SA00007+32                                 0581
*   RFY                                                            0582
*    (ICTLMOD) BASED(CCAICLMD);                                    0582
*   RFY                                                            0583
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0583
*   RFY                                                            0584
*    (ICTMOD) BASED(ICTIXL(J));                                    0584
*   RFY                                                            0585
*    (ICTPTF) BASED(ICTPPTR(1));                                   0585
*                                                                  0585
*   /*****************************************************************/
*   /*                                                               */
*   /* NO CONTROL CARDS FOR ACCEPT LINKS                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0586
*   IF CCAACCPT=ON THEN             /*                       @Z67SP00*/
         TM    CCAACCPT(CCAPTR),B'00100000'                        0586
         BNO   @RF00586                                            0586
*     LINKEOF=ON;                   /*                       @Z67SP00*/
         OI    LINKEOF,B'00010000'                                 0587
*   ELSE                            /*                       @Z67SP00*/
*                                                                  0588
*     /***************************************************************/
*     /*                                                             */
*     /* APPLY AND RESTORE GER THE LINK CONTRO CARDS         @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0588
*     DO;                           /*                       @Z67SP00*/
         B     @RC00586                                            0588
@RF00586 DS    0H                                                  0589
*       IOPDSID=IOPCDSM;            /* INDICATE CDS                  */
         L     @07,IOPPTR                                          0589
         MVI   IOPDSID(@07),X'02'                                  0589
*       IOPFUNCT=IOPPOSI;           /* INDICATE POINT REQUEST        */
         MVI   IOPFUNCT(@07),X'02'                                 0590
*       IOPNAME=ICTLMNAM(I);        /* NAME OF LM                    */
         LR    @05,I                                               0591
         MH    @05,@CH01006                                        0591
         L     @15,CCAICLMD(,CCAPTR)                               0591
         ST    @05,@TF00001                                        0591
         ALR   @05,@15                                             0591
         AL    @05,@CF01916                                        0591
         MVC   IOPNAME(8,@07),ICTLMNAM(@05)                        0591
*       IOPTYPE=IOPLMD;             /* INDICATE LM TYPE      @ZD00008*/
         MVI   IOPTYPE(@07),X'02'                                  0592
*       IOPTTR=ICTLTTR(I);          /* TTR FOR LM                    */
         AL    @15,@TF00001                                        0593
         AL    @15,@CF01961                                        0593
         MVC   IOPTTR(3,@07),ICTLTTR-31(@15)                       0593
*       CALL HMASMIO(HMASMIOP);     /* CALL I/O ROUTINE              */
         ST    @07,@AL00001                                        0594
         L     @15,@CV01634                                        0594
         LA    @01,@AL00001                                        0594
         BALR  @14,@15                                             0594
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* ERROR CODE        @Z67SP00*/
         L     @07,IOPPTR                                          0595
         SLR   @05,@05                                             0595
         IC    @05,IOPRETRN(,@07)                                  0595
         CR    LKIRTNCD,@05                                        0595
         BNL   *+6
         LR    LKIRTNCD,@05                                        0595
*       IF IOPRETRN^=IOPGOOD        /* SUCCESSFUL POINT?     @YA07506*/
*         THEN                                                     0596
         CLI   IOPRETRN(@07),0                                     0596
         BE    @RF00596                                            0596
*         DO;                                                      0597
*           LINKERR=ON;             /* INDICATE ERROR                */
         OI    LINKERR,B'00100000'                                 0598
*           MGPMGNO3=ZERO;          /* NO THIRD PART         @Z40SP00*/
         SLR   @07,@07                                             0599
         STH   @07,MGPMGNO3                                        0599
*         END;                                                     0600
*       ELSE                        /* GOOD IO               @Z67SP00*/
*         DO;                       /*                       @Z67SP00*/
         B     @RC00596                                            0601
@RF00596 DS    0H                                                  0602
*           CALL READ;              /* READ TO CONTROL RCD   @Z67SP00*/
         BAL   @14,READ                                            0602
*           BUFFER(1)=BLANK;        /* TO SKIP THIS RCD      @Z67SP00*/
         L     @07,IOPPTR                                          0603
         L     @07,IOPBUFAD(,@07)                                  0603
         MVI   BUFFER(@07),C' '                                    0603
*         END;                      /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
*   END POINT;                                                     0606
@EL00007 DS    0H                                                  0606
@EF00007 DS    0H                                                  0606
@ER00007 LM    @14,@05,@SA00007                                    0606
         LM    @07,@12,@SA00007+32                                 0606
         BR    @14                                                 0606
         EJECT
*                                                                  0607
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE ISSUES A READ REQUEST TO THE I/O ROUTINE WHEN  */
*   /* CALLED.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0607
*READ:                                                             0607
*   PROCEDURE OPTIONS(SAVEAREA);                                   0607
READ     STM   @14,@05,12(@13)                                     0607
         STM   @07,@12,48(@13)                                     0607
         ST    @13,@SA00008+4                                      0607
         LA    @14,@SA00008                                        0607
         ST    @14,8(,@13)                                         0607
         LR    @13,@14                                             0607
*   IOPDSID=IOPCDSM;                /* INDICATE CDS                  */
         L     @07,IOPPTR                                          0608
         MVI   IOPDSID(@07),X'02'                                  0608
*   IOPFUNCT=IOPREAD;               /* INDICATE READ REQUEST         */
         MVI   IOPFUNCT(@07),X'01'                                 0609
*   CALL HMASMIO(HMASMIOP);         /* CALL I/O ROUTINE TO READ A  0610
*                                      MEMBER                        */
         ST    @07,@AL00001                                        0610
         L     @15,@CV01634                                        0610
         LA    @01,@AL00001                                        0610
         BALR  @14,@15                                             0610
*   IF IOPRETRN=IOPEOF              /* END OF FILE?          @YA07506*/
*     THEN                                                         0611
         L     @07,IOPPTR                                          0611
         CLI   IOPRETRN(@07),4                                     0611
         BNE   @RF00611                                            0611
*     LINKEOF=ON;                   /* SET EOF INDICATOR             */
         OI    LINKEOF,B'00010000'                                 0612
*   IF IOPRETRN>IOPEOF THEN                                        0613
@RF00611 L     @07,IOPPTR                                          0613
         CLI   IOPRETRN(@07),4                                     0613
         BNH   @RF00613                                            0613
*     DO;                                                          0614
*       LINKERR=ON;                 /* INDICATE ERROR                */
         OI    LINKERR,B'00100000'                                 0615
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* EROR CODE         @Z67SP00*/
         SLR   @15,@15                                             0616
         IC    @15,IOPRETRN(,@07)                                  0616
         CR    LKIRTNCD,@15                                        0616
         BNL   *+6
         LR    LKIRTNCD,@15                                        0616
*       MGPMGNO3=ZERO;              /* NO THIRD PART         @Z40SP00*/
         SLR   @07,@07                                             0617
         STH   @07,MGPMGNO3                                        0617
*     END;                                                         0618
*   END READ;                                                      0619
@EL00008 L     @13,4(,@13)                                         0619
@EF00008 DS    0H                                                  0619
@ER00008 LM    @14,@05,12(@13)                                     0619
         LM    @07,@12,48(@13)                                     0619
         BR    @14                                                 0619
         EJECT
*                                                                  0620
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE ISSUES A WRITE REQUEST TO THE I/O ROUTINE WHEN */
*   /* CALLED.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0620
*WRITE:                                                            0620
*   PROCEDURE OPTIONS(SAVEAREA);                                   0620
WRITE    STM   @14,@05,12(@13)                                     0620
         STM   @07,@12,48(@13)                                     0620
         ST    @13,@SA00009+4                                      0620
         LA    @14,@SA00009                                        0620
         ST    @14,8(,@13)                                         0620
         LR    @13,@14                                             0620
*   IOPDSID=IOPSCR1;                /* INDICATE SCRATCH DS           */
         L     @07,IOPPTR                                          0621
         MVI   IOPDSID(@07),X'03'                                  0621
*   IOPFUNCT=IOPWRITE;              /* WRITE OPERATION               */
         MVI   IOPFUNCT(@07),X'51'                                 0622
*   CALL HMASMIO(HMASMIOP);         /* CALL I/O ROUTINE              */
         ST    @07,@AL00001                                        0623
         L     @15,@CV01634                                        0623
         LA    @01,@AL00001                                        0623
         BALR  @14,@15                                             0623
*   IF IOPRETRN^=IOPGOOD            /* I/O BAD.              @Z67SP00*/
*     THEN                                                         0624
         L     @07,IOPPTR                                          0624
         CLI   IOPRETRN(@07),0                                     0624
         BE    @RF00624                                            0624
*     DO;                                                          0625
*       LINKERR=ON;                 /* INDICATE ERROR                */
         OI    LINKERR,B'00100000'                                 0626
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* ERROR CODE        @Z67SP00*/
         SLR   @15,@15                                             0627
         IC    @15,IOPRETRN(,@07)                                  0627
         CR    LKIRTNCD,@15                                        0627
         BNL   *+6
         LR    LKIRTNCD,@15                                        0627
*       MGPMGNO3=ZERO;              /* NO THIRD PART         @Z40SP00*/
         SLR   @07,@07                                             0628
         STH   @07,MGPMGNO3                                        0628
*     END;                                                         0629
*   END WRITE;                                                     0630
@EL00009 L     @13,4(,@13)                                         0630
@EF00009 DS    0H                                                  0630
@ER00009 LM    @14,@05,12(@13)                                     0630
         LM    @07,@12,48(@13)                                     0630
         BR    @14                                                 0630
         EJECT
*                                                                  0631
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE ISSUES A CLOSE REQUEST TO THE I/O ROUTINE WHEN */
*   /* CALLED.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0631
*CLOSE:                                                            0631
*   PROCEDURE OPTIONS(SAVEAREA);                                   0631
CLOSE    STM   @14,@05,12(@13)                                     0631
         STM   @07,@12,48(@13)                                     0631
         ST    @13,@SA00010+4                                      0631
         LA    @14,@SA00010                                        0631
         ST    @14,8(,@13)                                         0631
         LR    @13,@14                                             0631
*   IOPDSID=IOPSCR1;                /* INDICATE SCRATCH DS           */
         L     @07,IOPPTR                                          0632
         MVI   IOPDSID(@07),X'03'                                  0632
*   IOPFUNCT=IOPCLOSE;              /* CLOSE OPERATION               */
         MVI   IOPFUNCT(@07),X'50'                                 0633
*   CALL HMASMIO(HMASMIOP);         /* CALL I/O ROUTINE              */
         ST    @07,@AL00001                                        0634
         L     @15,@CV01634                                        0634
         LA    @01,@AL00001                                        0634
         BALR  @14,@15                                             0634
*   IF IOPRETRN=IOPGOOD             /* I/O SUCCESSFUL?       @YA07506*/
*     THEN                                                         0635
         L     @07,IOPPTR                                          0635
         CLI   IOPRETRN(@07),0                                     0635
         BE    @RT00635                                            0635
*     RETURN;                       /* YES, CONTINUE                 */
*   ELSE                                                           0637
*     DO;                                                          0637
*       IF LKIRTNCD<IOPRETRN        /* CHANGE RC?            @YA07506*/
*         THEN                                                     0638
         SLR   @15,@15                                             0638
         IC    @15,IOPRETRN(,@07)                                  0638
         CR    LKIRTNCD,@15                                        0638
         BNL   @RF00638                                            0638
*         LKIRTNCD=IOPRETRN;        /* YES                   @YA07506*/
         LR    LKIRTNCD,@15                                        0639
*       LINKERR=ON;                 /* INDICATE ERROR                */
@RF00638 OI    LINKERR,B'00100000'                                 0640
*       MGPMGNO3=ZERO;              /* NO THIRD PART         @Z40SP00*/
         SLR   @07,@07                                             0641
         STH   @07,MGPMGNO3                                        0641
*     END;                                                         0642
*   END CLOSE;                                                     0643
@EL00010 L     @13,4(,@13)                                         0643
@EF00010 DS    0H                                                  0643
@ER00010 LM    @14,@05,12(@13)                                     0643
         LM    @07,@12,48(@13)                                     0643
         BR    @14                                                 0643
         EJECT
*                                                                  0644
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE SCANS THE ICT FOR LOAD MODULES WITH IDENTICAL  */
*   /* CHARACTERISTICS TO INCLUDE IN THE LINK REQUEST. WHEN A LOAD   */
*   /* MOD IS FOUND THAT MATCHES THE CURRENT LOAD MOD CHARACTERISTICS*/
*   /* THE LOOP COUNTER IS RESET TO THIS LOAD MOD AND PROCESSING     */
*   /* BEGINS WITH THE NEW LOAD MODULE.                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0644
*LMCHECK:                                                          0644
*   PROCEDURE OPTIONS(SAVEAREA);                                   0644
LMCHECK  STM   @14,@02,12(@13)                                     0644
         STM   @04,@12,36(@13)                                     0644
         ST    @13,@SA00011+4                                      0644
         LA    @14,@SA00011                                        0644
         ST    @14,8(,@13)                                         0644
         LR    @13,@14                                             0644
*   RFY                                                            0645
*    (ICTLMOD) BASED(CCAICLMD);                                    0645
*   RFY                                                            0646
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0646
*   RFY                                                            0647
*    (ICTMOD) BASED(ICTIXL(J));                                    0647
*   RFY                                                            0648
*    (ICTPTF) BASED(ICTPPTR(1));                                   0648
*                                                                  0648
*   /*****************************************************************/
*   /*                                                               */
*   /* ASSUME NO OTHER LMODS WILL BE LINKED. DOLINK ON MEANS NO LMODS*/
*   /* CAN BE CONCURRENTLY LINKED IN THIS PASS TO THE LINKAGE EDITOR.*/
*   /* DOLINK OFF WILL CAUSE THE MAIN LINK PROCESSING TO CONTIUE     */
*   /* SETTLING UP CONTROL CARDS FOR THE LMODS FOUND TO BE ELIGIBLE  */
*   /* FOR CONCURRENT PROCESSING.                            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0649
*   DOLINK=ON;                      /*                       @Z67SP00*/
*                                                                  0649
         OI    DOLINK,B'01000000'                                  0649
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH ICT LMODS FROM NEXT AFTER CURRENT              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0650
*   DO M=(I+1) BY 1                 /*                       @Z67SP00*/
*         WHILE ICTLEND(M)^=ICTENDNT/* FOR CALL TO LINK      @OY04018*/
*         &DOLINK=ON;               /* UNTIL NO OTHERS       @Z67SP00*/
*                                                                  0650
         LA    M,1                                                 0650
         ALR   M,I                                                 0650
         B     @DE00650                                            0650
@DL00650 DS    0H                                                  0651
*     /***************************************************************/
*     /*                                                             */
*     /* LOOK FOR ELEGIBLE LMOD TO LINK IN SAME CALL TO EDITOR       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0651
*     IF ICTTG1(M)=ICTTG1(I)&       /* SAME LIBS                     */
*         ICTLCPL(M)=OFF&           /* NOT COMPLETED         @Z40SP00*/
*         ICTLPROC(M)=OFF&          /* NOT ITSELF            @Z40SP00*/
*         ICTLLKD(M)=ON THEN        /* LINKABLE              @Z40SP00*/
         LA    @05,54                                              0651
         LR    @01,M                                               0651
         MR    @00,@05                                             0651
         L     @02,CCAICLMD(,CCAPTR)                               0651
         LR    @07,@05                                             0651
         MR    @06,I                                               0651
         ST    @01,@TF00001                                        0651
         ALR   @01,@02                                             0651
         AL    @01,@CF01943                                        0651
         ST    @07,@TF00002                                        0651
         ALR   @07,@02                                             0651
         AL    @07,@CF01943                                        0651
         CLC   ICTTG1-15(8,@01),ICTTG1-15(@07)                     0651
         BNE   @RF00651                                            0651
         LR    @05,@02                                             0651
         AL    @05,@TF00001                                        0651
         AL    @05,@CF01911                                        0651
         TM    ICTLCPL-8(@05),B'10100000'                          0651
         BNZ   @RF00651                                            0651
         LR    @05,@02                                             0651
         AL    @05,@TF00001                                        0651
         AL    @05,@CF01910                                        0651
         TM    ICTLLKD-14(@05),B'00001000'                         0651
         BNO   @RF00651                                            0651
*       IF                          /*                       @ZD00005*/
*           ICTLFLG1(M)=ICTLFLG1(I)&/* LE PARMS SAME         @ZD00004*/
*           ICTLFLG5(M)=ICTLFLG5(I)&/*                       @ZD00004*/
*           ICTLFLG6(M)=ICTLFLG6(I)&/*                       @ZD00004*/
*           ICTLFLG7(M)=ICTLFLG7(I) /*                       @ZD00004*/
*         THEN                                                     0652
*                                                                  0652
         LR    @05,@02                                             0652
         AL    @05,@TF00001                                        0652
         AL    @05,@CF01921                                        0652
         LR    @01,@02                                             0652
         AL    @01,@TF00002                                        0652
         AL    @01,@CF01921                                        0652
         CLC   ICTLFLG1-9(1,@05),ICTLFLG1-9(@01)                   0652
         BNE   @RF00652                                            0652
         LR    @05,@02                                             0652
         AL    @05,@TF00001                                        0652
         AL    @05,@CF01936                                        0652
         LR    @01,@02                                             0652
         AL    @01,@TF00002                                        0652
         AL    @01,@CF01936                                        0652
         CLC   ICTLFLG5-10(1,@05),ICTLFLG5-10(@01)                 0652
         BNE   @RF00652                                            0652
         LR    @05,@02                                             0652
         AL    @05,@TF00001                                        0652
         AL    @05,@CF01962                                        0652
         LR    @01,@02                                             0652
         AL    @01,@TF00002                                        0652
         AL    @01,@CF01962                                        0652
         CLC   ICTLFLG6-11(1,@05),ICTLFLG6-11(@01)                 0652
         BNE   @RF00652                                            0652
         LR    @05,@02                                             0652
         AL    @05,@TF00001                                        0652
         AL    @05,@CF01963                                        0652
         AL    @02,@TF00002                                        0652
         AL    @02,@CF01963                                        0652
         CLC   ICTLFLG7-12(1,@05),ICTLFLG7-12(@02)                 0652
         BNE   @RF00652                                            0652
*         /***********************************************************/
*         /*                                                         */
*         /* THIS ONE CAN BE LINKED ALONG WITH CURRENT LMOD GO BACK  */
*         /* TO MAIN LOOP TO PROCESS THIS LMOD FOR LINKING           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0653
*         DO;                       /*                       @Z67SP00*/
*           DOLINK=OFF;             /* DONT LINK YET         @Z67SP00*/
         NI    DOLINK,B'10111111'                                  0654
*         END;                      /*                       @Z67SP00*/
*   END;                                                           0656
*                                                                  0656
@RF00652 DS    0H                                                  0656
@RF00651 AH    M,@CH00085                                          0656
@DE00650 LR    @05,M                                               0656
         MH    @05,@CH01006                                        0656
         L     @02,CCAICLMD(,CCAPTR)                               0656
         AL    @02,@CF01916                                        0656
         L     @05,ICTLEND(@05,@02)                                0656
         CL    @05,ICTENDNT                                        0656
         BE    @DC00650                                            0656
         TM    DOLINK,B'01000000'                                  0656
         BO    @DL00650                                            0656
@DC00650 DS    0H                                                  0657
*   /*****************************************************************/
*   /*                                                               */
*   /* M WILL BE SET TO THE VALUE OF THE LMOD FOUND TO BE ELIGIBLE   */
*   /* FOR CONCURRENT PROCESSING SO THAT I IN THE MAIN LOOP CAN BE   */
*   /* SET TO POINT TO THIS LMOD ENTRY@Z67SP00                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0657
*   IF DOLINK=OFF THEN              /* CONCURRENT LMOD       @Z67SP00*/
         TM    DOLINK,B'01000000'                                  0657
         BNZ   @RF00657                                            0657
*     M=M-1;                        /* BUMP M DOWN           @Z67SP00*/
         BCTR  M,0                                                 0658
*   END LMCHECK;                                                   0659
@EL00011 L     @13,4(,@13)                                         0659
@EF00011 DS    0H                                                  0659
@ER00011 LM    @14,@02,12(@13)                                     0659
         LM    @04,@12,36(@13)                                     0659
         BR    @14                                                 0659
         EJECT
*                                                                  0660
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE IS INVOKED WHEN A LINK HAS BEEN COMPLETED.     */
*   /* MESSAGES ARE ISSUED FOR ALL LOAD MODULES AND RELATED MODULES  */
*   /* THAT WERE LINKED.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0660
*COMPMSG:                                                          0660
*   PROCEDURE;                                                     0660
COMPMSG  STM   @14,@12,@SA00012                                    0660
*   RFY                                                            0661
*    (ICTLMOD) BASED(CCAICLMD);                                    0661
*   RFY                                                            0662
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0662
*   RFY                                                            0663
*    (ICTMOD) BASED(ICTIXL(J));                                    0663
*   RFY                                                            0664
*    (ICTPTF) BASED(ICTPPTR(1));                                   0664
*   DCL                                                            0665
*     OUTCOME CHAR(10);             /* SUCCESS OF FAIL IN MSG@Z67SP00*/
*   DCL                                                            0666
*     OK CHAR(2) CONSTANT('00');    /* FOR MSG SEVERITY      @Z67SP00*/
*   DO I=1 BY 1 WHILE ICTLEND(I)^=ICTENDNT;/* LOOP THRU LM   @Z67SP00*/
         LA    I,1                                                 0667
         B     @DE00667                                            0667
@DL00667 DS    0H                                                  0668
*     IF ICTLPROC(I)=ON&ICTLCPL(I)=OFF/* INPROCESS-NOT COMP  @Z67SP00*/
*         &ICTLLKD(I)=ON            /* LINKED                @Z67SP00*/
*       THEN                                                       0668
         LR    @05,I                                               0668
         MH    @05,@CH01006                                        0668
         L     @15,CCAICLMD(,CCAPTR)                               0668
         ST    @05,@TF00001                                        0668
         ALR   @05,@15                                             0668
         AL    @05,@CF01911                                        0668
         TM    ICTLPROC-8(@05),B'10000000'                         0668
         BNO   @RF00668                                            0668
         TM    ICTLCPL-8(@05),B'00100000'                          0668
         BNZ   @RF00668                                            0668
         AL    @15,@TF00001                                        0668
         AL    @15,@CF01910                                        0668
         TM    ICTLLKD-14(@15),B'00001000'                         0668
         BNO   @RF00668                                            0668
*       DO;                         /*                       @ZD00001*/
*         DO J=1 BY 1 WHILE ICTIXL(J)^=ICTENDIX;/* SEARCH MOD      0670
*                                                            @Z67SP00*/
         LA    J,1                                                 0670
         B     @DE00670                                            0670
@DL00670 DS    0H                                                  0671
*           IF ICTMCPL(1)=OFF       /* MOD COMPLETE                  */
*               &ICTMISEL(1)=ON     /* SELECTED              @Z67SP00*/
*               &(ICTMMOD(1)=ON     /* MOD REPLACEMENT       @Z67SP00*/
*               ×ICTMXPND(1)=ON)    /* OR EXPAND             @Z67SP00*/
*             THEN                                                 0671
         LR    @05,J                                               0671
         SLA   @05,2                                               0671
         LR    @02,I                                               0671
         MH    @02,@CH01006                                        0671
         L     @01,CCAICLMD(,CCAPTR)                               0671
         AL    @01,@CF01912                                        0671
         L     @02,ICTLCHN-34(@02,@01)                             0671
         AL    @02,@CF01913                                        0671
         L     @05,ICTIXL(@05,@02)                                 0671
         TM    ICTMCPL(@05),B'00100000'                            0671
         BNZ   @RF00671                                            0671
         TM    ICTMISEL(@05),B'10000000'                           0671
         BNO   @RF00671                                            0671
         TM    ICTMMOD(@05),B'10010000'                            0671
         BZ    @RF00671                                            0671
*             DO;                   /*                       @ZD00005*/
*                                                                  0672
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE MESSAGE FOR LINK OF MOD IN LMOD     @Z67SP00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0673
*               IF LINKERR=OFF THEN /*                       @Z67SP00*/
         TM    LINKERR,B'00100000'                                 0673
         BNZ   @RF00673                                            0673
*                 OUTCOME=TXTSUCC;  /* SUCCESSFUL IN MSG     @Z67SP00*/
         MVC   OUTCOME(10),@CC01731                                0674
*               ELSE                /*                       @Z67SP00*/
*                 OUTCOME=TXTFAIL;  /* OR FAILURE            @Z67SP00*/
         B     @RC00673                                            0675
@RF00673 MVC   OUTCOME(10),@CC01734                                0675
*               MGPCLEAR=''B;       /* CLEAR MESSAGES        @Z67SP00*/
@RC00673 XC    MGPCLEAR(6),MGPCLEAR                                0676
*               MGPPRINT=ON;        /* INDICATE PRINTER              */
*               MGPHLDS=ON;         /* AND LOG               @Z40SP00*/
         OI    MGPPRINT,B'10010000'                                0678
*               MGPMGNO1=HMA239I;   /* LINK MESSAGE          @Z67SP00*/
         MVC   MGPMGNO1(2),@CH00487                                0679
*               MGPVARPT(1)=ADDR(OUTCOME);/* SUCCESS OR FAIL @Z67SP00*/
         LA    @05,OUTCOME                                         0680
         ST    @05,MGPVARPT                                        0680
*               MGPVARPT(2)=ADDR(ICTMNAME(1));/* FOR MODULE  @Z67SP00*/
         LR    @05,J                                               0681
         SLA   @05,2                                               0681
         LR    @02,I                                               0681
         MH    @02,@CH01006                                        0681
         L     @15,CCAICLMD(,CCAPTR)                               0681
         LA    @01,0(@02,@15)                                      0681
         AL    @01,@CF01912                                        0681
         L     @01,ICTLCHN-34(,@01)                                0681
         AL    @01,@CF01913                                        0681
         L     @05,ICTIXL(@05,@01)                                 0681
         ST    @05,MGPVARPT+4                                      0681
*               MGPVARPT(3)=ADDR(ICTLMNAM(I));/* LOAD MOD =  @Z67SP00*/
         LA    @01,0(@02,@15)                                      0682
         AL    @01,@CF01916                                        0682
         ST    @01,MGPVARPT+8                                      0682
*               MGPVARPT(4)=ADDR(ICTTG1(I));/* LIBRARY NAME  @Z67SP00*/
         AL    @15,@CF01943                                        0683
         LA    @02,ICTTG1-15(@02,@15)                              0683
         ST    @02,MGPVARPT+12                                     0683
*               MGPVARPT(5)=ADDR(ICTPTFS(1));/* PTF NUMBER   @Z67SP00*/
         L     @05,ICTPPTR(,@05)                                   0684
         ST    @05,MGPVARPT+16                                     0684
*               MGPVARPT(6)=ADDR(LINKRTN);/* LINK RETURN CODE      0685
*                                                            @Z67SP00*/
         LA    @05,LINKRTN                                         0685
         ST    @05,MGPVARPT+20                                     0685
*               IF LINKRTN=OK THEN  /* ZERO LINK RTN         @Z67SP00*/
         CLC   LINKRTN(2),@CC01900                                 0686
         BNE   @RF00686                                            0686
*                 MGPTYPE=MGPINFO;  /*                       @Z67SP00*/
         MVI   MGPTYPE,X'01'                                       0687
*               ELSE                /* NONZERO               @Z67SP00*/
*                 IF LINKERR=ON THEN/* BAD LINK              @Z67SP00*/
         B     @RC00686                                            0688
@RF00686 TM    LINKERR,B'00100000'                                 0688
         BNO   @RF00688                                            0688
*                   MGPTYPE=MGPERR; /*                       @Z67SP00*/
         MVI   MGPTYPE,X'03'                                       0689
*                 ELSE              /* NON-ZERO BUT GOOD     @Z67SP00*/
*                   MGPTYPE=MGPWARN;/*                       @Z67SP00*/
         B     @RC00688                                            0690
@RF00688 MVI   MGPTYPE,X'02'                                       0690
*               CALL HMASMMSG(HMASMMGP);/* CALL MSG ROUTINE          */
@RC00688 DS    0H                                                  0691
@RC00686 L     @15,@CV01638                                        0691
         LA    @01,@AL00691                                        0691
         BALR  @14,@15                                             0691
*             END;                  /*                       @Z67SP00*/
*         END;                                                     0693
*                                                                  0693
@RF00671 AH    J,@CH00085                                          0693
@DE00670 LR    @05,J                                               0693
         SLA   @05,2                                               0693
         LR    @02,I                                               0693
         MH    @02,@CH01006                                        0693
         L     @15,CCAICLMD(,CCAPTR)                               0693
         LA    @01,0(@02,@15)                                      0693
         AL    @01,@CF01912                                        0693
         L     @01,ICTLCHN-34(,@01)                                0693
         AL    @01,@CF01913                                        0693
         L     @05,ICTIXL(@05,@01)                                 0693
         CL    @05,ICTENDIX                                        0693
         BNE   @DL00670                                            0693
*         /***********************************************************/
*         /*                                                         */
*         /* SECOND TARGET LIBRARY PROCESSING                @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0694
*         IF LINKERR=OFF THEN       /*                       @Z67SP00*/
         TM    LINKERR,B'00100000'                                 0694
         BNZ   @RF00694                                            0694
*           DO;                     /*                       @Z67SP00*/
*             IF ICTTG2(I,1)=BLANK  /* NO SECOND TARGET      @Z67SP00*/
*                 ×ICTTIND1(I)=OFF  /* OR 2 EXIST AND 2ND PASS     0696
*                                                            @Z67SP00*/
*               THEN                /* CHECK FOR COMPLETE            */
         ST    @02,@TF00001                                        0696
         ALR   @02,@15                                             0696
         AL    @02,@CF01965                                        0696
         CLI   ICTTG2-23(@02),C' '                                 0696
         BE    @RT00696                                            0696
         AL    @15,@TF00001                                        0696
         AL    @15,@CF01910                                        0696
         TM    ICTTIND1-14(@15),B'10000000'                        0696
         BNZ   @RF00696                                            0696
@RT00696 DS    0H                                                  0697
*               DO;                                                0697
*                 ICTTIND1(I)=ON;   /* RESET INDICATOR       @Z67SP00*/
         LR    @05,I                                               0698
         MH    @05,@CH01006                                        0698
         L     @15,CCAICLMD(,CCAPTR)                               0698
         ST    @05,@TF00001                                        0698
         ALR   @05,@15                                             0698
         AL    @05,@CF01910                                        0698
         OI    ICTTIND1-14(@05),B'10000000'                        0698
*                 ICTLCPL(I)=ON;    /* SET COMPLETE BIT      @Z67SP00*/
         AL    @15,@TF00001                                        0699
         AL    @15,@CF01911                                        0699
         OI    ICTLCPL-8(@15),B'00100000'                          0699
*               END;                                               0700
*             ELSE                  /* 2 TGTLIBS AND 2ND PASS      0701
*                                                            @ZA01957*/
*               DO;                 /* SET UP FOR SECOND PASS      0701
*                                                            @ZA01957*/
         B     @RC00696                                            0701
@RF00696 DS    0H                                                  0702
*                 LIBNAME=ICTTG1(I);/* REVERSE NAMES         @Z67SP00*/
         LR    @05,I                                               0702
         MH    @05,@CH01006                                        0702
         L     @15,CCAICLMD(,CCAPTR)                               0702
         ST    @05,@TF00001                                        0702
         ALR   @05,@15                                             0702
         AL    @05,@CF01943                                        0702
         MVC   LIBNAME(8),ICTTG1-15(@05)                           0702
*                 ICTTG1(I)=ICTTG2(I);/* SECOND NOW FIRST    @Z67SP00*/
         LR    @05,@15                                             0703
         AL    @05,@TF00001                                        0703
         AL    @05,@CF01943                                        0703
         LR    @14,@15                                             0703
         AL    @14,@TF00001                                        0703
         AL    @14,@CF01965                                        0703
         MVC   ICTTG1-15(8,@05),ICTTG2-23(@14)                     0703
*                 ICTTG2(I)=LIBNAME;/* FIRST NOW SWCOND      @Z67SP00*/
         LR    @05,@15                                             0704
         AL    @05,@TF00001                                        0704
         AL    @05,@CF01965                                        0704
         MVC   ICTTG2-23(8,@05),LIBNAME                            0704
*                 ICTTIND1(I)=OFF;  /* IND. 2 TGTS. 2ND PASS @Z67SP00*/
         LR    @05,@15                                             0705
         AL    @05,@TF00001                                        0705
         AL    @05,@CF01910                                        0705
         NI    ICTTIND1-14(@05),B'01111111'                        0705
*                 ICTLPROC(I)=OFF;  /* TO GET HIT AGAIN      @Z67SP00*/
         AL    @15,@TF00001                                        0706
         AL    @15,@CF01911                                        0706
         NI    ICTLPROC-8(@15),B'01111111'                         0706
*               END;                                               0707
*           END;                    /*                       @Z67SP00*/
@RC00696 DS    0H                                                  0709
*       END;                        /*                       @ZD00001*/
@RF00694 DS    0H                                                  0710
*   END;                            /* END LOOP                      */
@RF00668 AH    I,@CH00085                                          0710
@DE00667 LR    @05,I                                               0710
         MH    @05,@CH01006                                        0710
         L     @01,CCAICLMD(,CCAPTR)                               0710
         AL    @01,@CF01916                                        0710
         L     @05,ICTLEND(@05,@01)                                0710
         CL    @05,ICTENDNT                                        0710
         BNE   @DL00667                                            0710
*   END COMPMSG;                                                   0711
@EL00012 DS    0H                                                  0711
@EF00012 DS    0H                                                  0711
@ER00012 LM    @14,@12,@SA00012                                    0711
         BR    @14                                                 0711
         EJECT
*   END HMASMLKI                                                   0712
*                                                                  0712
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*                                                                  0712
*       ;                                                          0712
@DATA    DS    0H
@CH00085 DC    H'1'
@CH00238 DC    H'7'
@CH00110 DC    H'8'
@CH00033 DC    H'10'
@CH00032 DC    H'12'
@CH00487 DC    H'40'
@CH01006 DC    H'54'
@CH01668 DC    XL2'01'
@CH01672 DC    XL2'03'
@CH01674 DC    XL2'05'
@SM01922 MVC   0(0,@02),RENT
@SM01924 MVC   0(0,@02),REUS
@SM01926 MVC   0(0,@02),SCTR
@SM01928 MVC   0(0,@01),OVLY
@SM01930 MVC   0(0,@02),XCAL
@SM01932 MVC   0(0,@02),REFR
@SM01934 MVC   0(0,@02),DC
@SM01937 MVC   0(0,@02),NE
@SM01939 MVC   0(0,@02),APF
@SM01941 MVC   0(0,@02),ALIGN2
@SM01952 MVC   BUFFER+6(0,@05),ICTLMNAM(@01)
@SM01954 MVC   BUFFER(0,@05),REPL
@SM01956 MVC   CTLBUFF+9(0),LIBNAME
@SM01958 MVC   0(0,@01),MEMNAME
         DS    0F
@AL00235 DC    A(CILPTFNO)             LIST WITH   2 ARGUMENT(S)
         DC    A(CILPTFDS)
@AL00285 DC    A(STATUS)               LIST WITH   1 ARGUMENT(S)
@AL00691 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    14F
@SA00005 DS    14F
@SA00011 DS    18F
@SA00004 DS    14F
@SA00007 DS    14F
@SA00008 DS    18F
@SA00009 DS    18F
@SA00006 DS    14F
@SA00010 DS    18F
@SA00012 DS    0F
         DS    15F
@AL00001 DS    2A
@TF00001 DS    F
@TF00002 DS    F
         DS    0F
@CF01951 DC    F'-55'
@CF01916 DC    F'-54'
@CF01911 DC    F'-46'
@CF01921 DC    F'-45'
@CF01936 DC    F'-44'
@CF01962 DC    F'-43'
@CF01963 DC    F'-42'
@CF01949 DC    F'-41'
@CF01910 DC    F'-40'
@CF01943 DC    F'-39'
@CF01965 DC    F'-31'
@CF01961 DC    F'-23'
@CF01912 DC    F'-20'
@CF01950 DC    F'-8'
@CF01913 DC    F'-4'
@CV01634 DC    V(HMASMIO)
@CV01635 DC    V(HMASMCIL)
@CV01636 DC    V(HMASMCPL)
@CV01637 DC    V(HMASMSEC)
@CV01638 DC    V(HMASMMSG)
         DS    0D
IOPPTR   DS    A
@CC01731 DC    C'SUCCESSFUL'
@CC01734 DC    C'FAILED    '
@CC01900 DC    C'00'
         DS    CL2
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL40
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00225 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00226 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL28
         ORG   MGPVAR
MGPVARPT DS    7A
         ORG   HMASMMGP+40
SAVRVANM DS    CL8
DDNAMES  DS    CL66
         ORG   DDNAMES
DDCOUNT  DC    XL2'42'
ASYSLIN  DC    CL8'SYSUT1  '
DD2      DC    8X'00'
ASYSLMOD DS    CL8
DD3      DC    16X'00'
SYSPRINT DS    CL8
DD4      DC    8X'00'
ASYSUT1  DC    CL8'SYSUT2  '
         ORG   DDNAMES+66
OPTLST   DS    CL93
         ORG   OPTLST
OPTLGTH  DS    FL2
OPTVAR   DC    CL91' '
         ORG   OPTLST+93
         DS    CL1
WORKAREA DS    CL16
         ORG   WORKAREA
SAVE1    DS    CL8
SAVE2    DS    CL8
         ORG   SAVE2
@NM00230 DS    CL6
LINKRTN  DS    CL2
         ORG   LINKRTN
@NM00231 DS    CL1
@NM00232 DS    CL1
         ORG   @NM00232
SIGN     DS    BL1
         ORG   WORKAREA+16
INCLUDE  DC    CL7'INCLUDE'
RPAREN   DC    CL1')'
REPL     DC    CL3'(R)'
NAME     DC    CL5'NAME '
LPAREN   DC    CL1'('
ALIAS    DC    CL5'ALIAS'
XCAL     DC    CL5'XCAL,'
NE       DC    CL3'NE,'
REFR     DC    CL5'REFR,'
RENT     DC    CL5'RENT,'
REUS     DC    CL5'REUS,'
DC       DC    CL3'DC,'
SCTR     DC    CL5'SCTR,'
OVLY     DC    CL5'OVLY,'
APF      DC    CL5'AC=1,'
ALIGN2   DC    CL7'ALIGN2,'
COMMA    DC    CL1','
STATUS   DS    CL1
FLAGS    DC    X'00'
         ORG   FLAGS
PARMSET  DS    BL1
DOLINK   EQU   FLAGS+0
LINKERR  EQU   FLAGS+0
LINKEOF  EQU   FLAGS+0
CALLCPL  EQU   FLAGS+0
RELFALC  EQU   FLAGS+0
RELFALCD EQU   FLAGS+0
@NM00233 EQU   FLAGS+0
         ORG   FLAGS+1
LIBNAME  DS    CL8
MEMNAME  DS    CL8
PTFNO    DS    CL7
CTLBUFF  DC    CL80' '
PATCHLKI DS    CL80
         ORG   PATCHLKI
@NM00234 DC    80X'FF'
         ORG   PATCHLKI+80
CILPTFNO DS    CL7
CILPTFDS DS    CL44
OUTCOME  DS    CL10
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
LKIRTNCD EQU   @06
LZ       EQU   @07
LY       EQU   @03
LX       EQU   @05
J        EQU   @03
R        EQU   @05
I        EQU   @04
M        EQU   @03
CCAPTR   EQU   @11
LINKREG  EQU   @02
RTNCODE  EQU   @15
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCARVAD  EQU   CCAFSTA
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00009 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAACCPT EQU   CCAFLAG1
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00025 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00027 EQU   CCABLDLL
CCALKDNM EQU   @NM00027
CCALKED  EQU   @NM00027+8
CCALKDSP EQU   @NM00027+12
CCALKDRC EQU   @NM00027+20
CCARLINK EQU   CCALKDRC
CCALKDPM EQU   @NM00027+24
@NM00029 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00039+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
@NM00043 EQU   HMASMIOP+12
@NM00044 EQU   @NM00043
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPTTR   EQU   IOPDRMAP+8
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00154 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
@NM00181 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTMOD   EQU   0
ICTMNAME EQU   ICTMOD
ICTMFLG2 EQU   ICTMOD+8
ICTMPROC EQU   ICTMFLG2
ICTMCPL  EQU   ICTMFLG2
ICTMFLG1 EQU   ICTMOD+9
ICTMMODR EQU   ICTMFLG1
ICTMMOD  EQU   ICTMMODR
ICTMXPND EQU   ICTMFLG1
ICTMFLG3 EQU   ICTMOD+10
ICTMTRX  EQU   ICTMFLG3
ICTMALIS EQU   ICTMFLG3
ICTMFLG4 EQU   ICTMOD+11
ICTMISEL EQU   ICTMFLG4
ICTMFLG5 EQU   ICTMOD+12
ICTMODF4 EQU   ICTMOD+13
ICTMLEP1 EQU   ICTMODF4
ICTMODF5 EQU   ICTMOD+14
ICTMLEP2 EQU   ICTMODF5
ICTMODF6 EQU   ICTMOD+15
ICTMLEP3 EQU   ICTMODF6
ICTMODF7 EQU   ICTMOD+16
ICTMLEP4 EQU   ICTMODF7
ICTMACF4 EQU   ICTMOD+17
ICTMRELN EQU   ICTMOD+22
ICTFMLIB EQU   ICTMOD+24
ICTPPTR  EQU   ICTMOD+96
ICTMCHN  EQU   ICTMOD+100
ICTMICHN EQU   ICTMOD+104
ICTMACHN EQU   ICTMOD+112
ICTMTCHN EQU   ICTMOD+116
ICTMVCHN EQU   ICTMOD+120
ICTMUCHN EQU   ICTMOD+124
ICTIXMF  EQU   0
ICTMIDLS EQU   0
ICTMID   EQU   ICTMIDLS
ICTMODID EQU   ICTMID
ICTMODST EQU   ICTMID+7
ICTASMLS EQU   0
ICTASMAD EQU   ICTASMLS
ICTTALLS EQU   0
ICTTALNM EQU   ICTTALLS
ICTTALND EQU   ICTTALNM
ICTMVRLS EQU   0
ICTMVRNT EQU   ICTMVRLS
ICTMVRNM EQU   ICTMVRNT
ICTMUMLS EQU   0
ICTMUMNT EQU   ICTMUMLS
ICTMUMNM EQU   ICTMUMNT
ICTLMOD  EQU   0
ICTLMNAM EQU   ICTLMOD
ICTLNAME EQU   ICTLMNAM
ICTLEND  EQU   ICTLNAME
ICTLFLG4 EQU   ICTLMOD+8
ICTLPROC EQU   ICTLFLG4
ICTLCPL  EQU   ICTLFLG4
ICTLFLG1 EQU   ICTLMOD+9
ICTLAPF  EQU   ICTLFLG1
ICTLRENT EQU   ICTLFLG1
ICTLREUS EQU   ICTLFLG1
ICTLSCTR EQU   ICTLFLG1
ICTLOVLY EQU   ICTLFLG1
ICTLREFR EQU   ICTLFLG1
ICTLDC   EQU   ICTLFLG1
ICTLFLG5 EQU   ICTLMOD+10
ICTLNE   EQU   ICTLFLG5
ICTLPAGA EQU   ICTLFLG5
ICTLFLG6 EQU   ICTLMOD+11
ICTLFLG7 EQU   ICTLMOD+12
ICTLFLG2 EQU   ICTLMOD+13
ICTCOPY  EQU   ICTLFLG2
ICTLFLG3 EQU   ICTLMOD+14
ICTTIND1 EQU   ICTLFLG3
ICTLXPND EQU   ICTLFLG3
ICTLLKD  EQU   ICTLFLG3
ICTTG1   EQU   ICTLMOD+15
ICTTG2   EQU   ICTLMOD+23
ICTLTTR  EQU   ICTLMOD+31
ICTLCHN  EQU   ICTLMOD+34
ICTIXLF  EQU   0
ICTIXL   EQU   ICTIXLF
RVAPARM  EQU   0
RVAINFO  EQU   RVAPARM
RVAPASS  EQU   RVAPARM+12
RVASTAE  EQU   RVAPARM+20
RVAEPRNM EQU   RVASTAE+4
@NM00227 EQU   RVASTAE+16
@NM00228 EQU   RVASTAE+20
RVAFLAGS EQU   RVASTAE+24
BUFFER   EQU   0
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00050 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPDSN   EQU   IOPDYNDT
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00061 EQU   IOPUDATA
@NM00062 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00071 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00082 EQU   IOPSRCDR+1
@NM00084 EQU   @NM00082+7
@NM00088 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00092 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00098 EQU   IOPMODDR+1
@NM00100 EQU   @NM00098+7
@NM00104 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00108 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00119 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00126 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00135 EQU   IOPPTFFX
@NM00136 EQU   @NM00135
IOPPDTES EQU   IOPPTFFX+41
@NM00139 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00164 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00164
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00168 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00168
IOPBFTB1 EQU   IOPBFTB0
ICTENDNT EQU   ICTENDCH
ICTENDIX EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00170 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00169 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00167 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00166 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00165 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00163 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00162 EQU   IOPPTSFX+35
@NM00161 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00160 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00159 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00158 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00157 EQU   IOPQFMDR
@NM00153 EQU   IOPQSMDR
@NM00152 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00151 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00150 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00149 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00148 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00147 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00146 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00145 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00144 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00143 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00142 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00141 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00140 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00139+3
IOPRECD  EQU   @NM00139
@NM00138 EQU   IOPPTFFX+8
@NM00137 EQU   @NM00135+7
IOPPRELN EQU   @NM00136
@NM00134 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00133 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00132 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00131 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00130 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00129 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00128 EQU   @NM00126+7
@NM00127 EQU   @NM00126
@NM00125 EQU   IOPSYSDR+5
@NM00124 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00123 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00122 EQU   IOPDLBFX+8
@NM00121 EQU   @NM00119+7
@NM00120 EQU   @NM00119
@NM00118 EQU   IOPDLBDR+1
@NM00117 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00116 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00115 EQU   IOPMODFX+12
@NM00114 EQU   IOPMODF4
@NM00113 EQU   IOPMODF3
@NM00112 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00111 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00110 EQU   @NM00108+7
@NM00109 EQU   @NM00108
@NM00107 EQU   IOPMODDR+17
@NM00106 EQU   @NM00104+7
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00100
@NM00102 EQU   @NM00100
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00098
@NM00097 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00096 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00095 EQU   IOPSRCFX+8
@NM00094 EQU   @NM00092+7
@NM00093 EQU   @NM00092
@NM00091 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00090 EQU   @NM00088+7
@NM00089 EQU   @NM00088
@NM00087 EQU   @NM00084
@NM00086 EQU   @NM00084
@NM00085 EQU   @NM00084
@NM00083 EQU   @NM00082
@NM00081 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00080 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00079 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00078 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00077 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00076 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00075 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00073 EQU   @NM00071+7
@NM00072 EQU   @NM00071
@NM00070 EQU   IOPLMDDR+6
@NM00069 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00068 EQU   IOPLMDF4
@NM00067 EQU   IOPLMDF3
@NM00066 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00065 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00064 EQU   IOPLMDDR
@NM00063 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00062+4
IOPUSED  EQU   @NM00062
IOPTPSEQ EQU   @NM00061+8
IOPVLSER EQU   @NM00061+2
IOPBLKSI EQU   @NM00061
IOPCQMAX EQU   IOPCQMAP+12
@NM00060 EQU   IOPCQMAP+11
@NM00059 EQU   IOPCQMAP+8
@NM00058 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00057 EQU   IOPSCMAP+11
@NM00056 EQU   IOPSCMAP+8
@NM00055 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00054 EQU   IOPNTMAX+11
@NM00053 EQU   IOPNTMAX+8
@NM00052 EQU   IOPNTMAX
@NM00051 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00050+5
IOPIPTF3 EQU   @NM00050
RVAEND   EQU   RVASTAE+25
@NM00229 EQU   RVAFLAGS
RVASDWFD EQU   RVAFLAGS
RVAVS1   EQU   RVAFLAGS
RVAMVS   EQU   RVAFLAGS
RVAUSRCH EQU   @NM00228+2
RVASYSCH EQU   @NM00228
RVAUSRCD EQU   @NM00227+2
RVASYSCD EQU   @NM00227
RVAABNDC EQU   RVASTAE+12
RVASDWAP EQU   RVASTAE
RVAREC   EQU   RVAPASS+4
RVATBL   EQU   RVAPASS
RVAMAJNM EQU   RVAINFO+8
RVACCAP  EQU   RVAINFO+4
RVAHDR   EQU   RVAINFO
@NM00224 EQU   ICTLMOD+38
@NM00223 EQU   ICTLFLG3
ICTLZAP  EQU   ICTLFLG3
ICTLCPY  EQU   ICTLFLG3
ICTTIND2 EQU   ICTLFLG3
@NM00222 EQU   ICTLFLG2
ICTLDEL  EQU   ICTLFLG2
@NM00221 EQU   ICTLFLG2
ICTLTDEL EQU   ICTLFLG2
ICTLINK  EQU   ICTLFLG2
@NM00220 EQU   ICTLFLG7
@NM00219 EQU   ICTLFLG6
@NM00218 EQU   ICTLFLG5
@NM00217 EQU   ICTLFLG1
@NM00216 EQU   ICTLFLG4
ICTLPASS EQU   ICTLFLG4
ICTLDDCK EQU   ICTLFLG4
ICTLMSG  EQU   ICTLFLG4
ICTLNOGO EQU   ICTLFLG4
@NM00215 EQU   ICTMUMNT+7
ICTMUMND EQU   ICTMUMNM
@NM00214 EQU   ICTMVRNT+7
ICTMVRND EQU   ICTMVRNM
ICTASMND EQU   ICTASMAD
ICTMIDTY EQU   ICTMODST
ICTMIDAM EQU   ICTMODST
ICTMIDRG EQU   ICTMODST
ICTMIDF1 EQU   ICTMODST
ICTMIDPL EQU   ICTMODST
ICTMIDPS EQU   ICTMODST
@NM00213 EQU   ICTMODST
ICTMIDND EQU   ICTMODID
ICTIXM   EQU   ICTIXMF
@NM00212 EQU   ICTMOD+128
ICTMICHA EQU   ICTMOD+108
@NM00211 EQU   ICTMOD+95
ICTMFMID EQU   ICTMOD+88
@NM00210 EQU   ICTMOD+87
ICTMRMID EQU   ICTMOD+80
ICTMSSI  EQU   ICTMOD+72
ICTMDOBJ EQU   ICTMOD+64
ICTMSYSL EQU   ICTMOD+56
ICTMDSTL EQU   ICTMOD+48
ICTMASLB EQU   ICTMOD+40
ICTTOLIB EQU   ICTMOD+32
@NM00209 EQU   ICTMOD+21
ICTMLANG EQU   ICTMOD+20
@NM00208 EQU   ICTMOD+19
ICTMACF5 EQU   ICTMOD+18
ICTMZMPR EQU   ICTMACF4
ICTMZOMZ EQU   ICTMACF4
ICTMDOAS EQU   ICTMACF4
ICTMXUPD EQU   ICTMACF4
ICTMFXC  EQU   ICTMACF4
ICTMFXBS EQU   ICTMACF4
ICTMHASM EQU   ICTMACF4
ICTMACDL EQU   ICTMACF4
@NM00207 EQU   ICTMLEP4
@NM00206 EQU   ICTMLEP3
@NM00205 EQU   ICTMLEP2
ICTMPAGA EQU   ICTMLEP2
ICTMNE   EQU   ICTMLEP2
@NM00204 EQU   ICTMLEP1
ICTMDC   EQU   ICTMLEP1
ICTMREFR EQU   ICTMLEP1
ICTMOVLY EQU   ICTMLEP1
ICTMSCTR EQU   ICTMLEP1
ICTMREUS EQU   ICTMLEP1
ICTMRENT EQU   ICTMLEP1
ICTMAPF  EQU   ICTMLEP1
@NM00203 EQU   ICTMFLG5
ICTMNORL EQU   ICTMFLG5
ICTMELCK EQU   ICTMFLG5
ICTMCOPY EQU   ICTMFLG5
ICTMPASS EQU   ICTMFLG5
@NM00202 EQU   ICTMFLG4
ICTMTSEL EQU   ICTMFLG4
ICTMDSTE EQU   ICTMFLG4
ICTMMIDE EQU   ICTMFLG4
ICTMASOC EQU   ICTMFLG4
ICTMSELM EQU   ICTMFLG4
ICTMIDEL EQU   ICTMFLG4
@NM00201 EQU   ICTMFLG3
ICTMPRMS EQU   ICTMFLG3
ICTMWRK  EQU   ICTMFLG3
ICTMRELF EQU   ICTMFLG3
ICTLIBTX EQU   ICTMFLG3
ICTLIBLK EQU   ICTMFLG3
ICTMSRCU EQU   ICTMFLG1
ICTMSRCR EQU   ICTMFLG1
ICTMMACU EQU   ICTMFLG1
ICTMMACR EQU   ICTMFLG1
ICTMZAP  EQU   ICTMFLG1
ICTMASM  EQU   ICTMMODR
@NM00200 EQU   ICTMFLG2
@NM00199 EQU   ICTMFLG2
ICTMMIDU EQU   ICTMFLG2
ICTMDEL  EQU   ICTMFLG2
ICTMMSG  EQU   ICTMFLG2
ICTMNOGO EQU   ICTMFLG2
ICTMEND  EQU   ICTMNAME
@NM00198 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00197 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00196 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00195 EQU   ICTCSRST
@NM00194 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00193 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00192 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00191 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00190 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00189 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00188 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00187 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00186 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00185 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00184 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
ICTIXP   EQU   ICTIXPF
@NM00183 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPFMID EQU   ICTPTF+22
ICTPSUPN EQU   ICTPTF+20
ICTPONUM EQU   ICTPTF+18
ICTPTYPE EQU   ICTPTF+17
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00182 EQU   @NM00181
ICTPRQBY EQU   @NM00181
ICTPRQOK EQU   @NM00181
ICTPRQCK EQU   @NM00181
@NM00180 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00179 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00178 EQU   ICTPFLG4
@NM00177 EQU   ICTPFLG4
@NM00176 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00175 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00174 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00173 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00172 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00171 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTPEND  EQU   ICTPTFS
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00156 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00155 EQU   @NM00154+7
IOPQSMFM EQU   @NM00154
@NM00074 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00049 EQU   IOPUSERL
@NM00048 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00047 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00046 EQU   @NM00043+10
IOPSEQNO EQU   @NM00043+8
@NM00045 EQU   @NM00044+7
IOPPTFNM EQU   @NM00044
IOPNAM17 EQU   IOPNAME
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00042 EQU   CCABLDLM+2
@NM00041 EQU   CCABLDLM
CCAUPDPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00039+12
CCAUPDTE EQU   @NM00039+8
CCAUPDNM EQU   @NM00039
CCASUPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00037+12
CCAIOSUP EQU   @NM00037+8
CCASUPNM EQU   @NM00037
CCAZAPPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00035+12
CCASPZAP EQU   @NM00035+8
CCAZAPNM EQU   @NM00035
CCACOMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00033+12
CCACOMRS EQU   @NM00033+8
CCACOMNM EQU   @NM00033
CCACPYPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00031+12
CCACOPY  EQU   @NM00031+8
CCACPYNM EQU   @NM00031
CCAASMPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00029+12
CCAASM   EQU   @NM00029+8
CCAASMNM EQU   @NM00029
@NM00028 EQU   @NM00027+21
CCAPGMPM EQU   @NM00025+24
@NM00026 EQU   @NM00025+21
CCABPGRC EQU   @NM00025+20
CCABPGSP EQU   @NM00025+12
CCABPGAD EQU   @NM00025+8
CCABPGNM EQU   @NM00025
CCAEND   EQU   HMASMCCA+371
@NM00024 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00023 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00022 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00021 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00020 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00019 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00018 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00017 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00016 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00015 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00014 EQU   @NM00009+18
@NM00013 EQU   @NM00009+16
CCATBLPA EQU   @NM00009+12
@NM00012 EQU   @NM00009+8
@NM00011 EQU   @NM00009+4
@NM00010 EQU   @NM00009
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00008 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00007 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00006 EQU   CCAFBUFR+122
@NM00005 EQU   CCAFBUFR+120
@NM00004 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00003 EQU   CCAFBUFR+88
@NM00002 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00001 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00329 EQU   CKBLK
@RT00340 EQU   SCAN
@RF00340 EQU   CKBLK
@RF00464 EQU   @EL00004
@RT00489 EQU   @EL00005
@RT00501 EQU   @EL00005
@RT00512 EQU   @EL00005
@RT00525 EQU   @EL00005
@RC00586 EQU   @EL00007
@RC00596 EQU   @EL00007
@RF00613 EQU   @EL00008
@RF00624 EQU   @EL00009
@RT00635 EQU   @EL00010
@RF00657 EQU   @EL00011
@ENDDATA EQU   *
         END   HMASMLKI,(C'PLS2047',0802,78334)

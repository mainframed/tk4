         TITLE 'HMASMFPT - FORMAT SYSMOD ENTRY'
HMASMFPT CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMFPT  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(12),0(@01)                                 0001
         EJECT
*                                                                  0175
*   /*****************************************************************/
*   /*                                                               */
*   /* INIT INTERNAL SWITCHES AND IOPPTR                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0175
*   IOPPTR=ADDR(PASSIOP);           /* IOP WITH SYSMOD ENTRY         */
         L     IOPPTR,@PC00001+4                                   0175
*   PRNTBUF(1:LENGTH(PRNTBUF))=BLANK;/* THEN CLEAR THE PRINT AREA    */
         MVI   PRNTBUF+1,C' '                                      0176
         MVC   PRNTBUF+2(118),PRNTBUF+1                            0176
         MVI   PRNTBUF,C' '                                        0176
*   RFY                                                            0177
*     RTNCODE RSTD;                 /*                               */
*   RTNCODE=ZERO;                   /* INIT RETURN CODE              */
*                                                                  0178
         SLR   RTNCODE,RTNCODE                                     0178
*   /*****************************************************************/
*   /*                                                               */
*   /* INIT COMMON AREAS IN HMASMFVL PARAMETER LIST                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0179
*   HMASMFVP=''B;                   /*                               */
         XC    HMASMFVP(15),HMASMFVP                               0179
*   FVPLSTAD=ADDR(IOPPNTRY(1));     /* SYSMOD SUBENTRY LIST START    */
         LA    @14,IOPPNTRY(,IOPPTR)                               0180
         ST    @14,FVPLSTAD                                        0180
*   FVPLNLEN=CCALNLEN;              /*                               */
         MVC   FVPLNLEN(2),CCALNLEN(CCAPTR)                        0181
*   FVPOFFST=ADDR(HDSUBHD)-ADDR(HDNAME);/*                           */
         MVC   FVPOFFST(2),@CH00036                                0182
*   FVPVERN=ZERO;                   /*                               */
         MVI   FVPVERN,X'00'                                       0183
*   FVPDSID=CCALSTDS;               /* OUTPUT DATASET ID             */
         MVC   FVPDSID(1),CCALSTDS(CCAPTR)                         0184
         EJECT
*                                                                  0185
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP INITIAL HEADING                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0185
*   IF IOPTYPE^=LASTTYPE            /* IF FIRST SYSMOD               */
*       ×IOPDSID=IOPSCDS            /* OR SCDS DATASET               */
*     THEN                          /*                               */
         L     @14,@PC00001+8                                      0185
         CLC   IOPTYPE(1,IOPPTR),LASTTYPE(@14)                     0185
         BNE   @RT00185                                            0185
         CLI   IOPDSID(IOPPTR),33                                  0185
         BNE   @RF00185                                            0185
@RT00185 DS    0H                                                  0186
*     CALL FPTSETHD;                /* INIT NEW PAGE HEADING         */
*                                                                  0186
         BAL   @14,FPTSETHD                                        0186
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL SYSMOD ELIGIBLITY CHECKER                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0187
*   IF RTNCODE=ZERO                 /* IF PREV FUNCTIONS OK          */
*     THEN                          /*                               */
@RF00185 LTR   RTNCODE,RTNCODE                                     0187
         BNZ   @RF00187                                            0187
*     CALL FPTCHECK;                /* CHECK TO SEE IF SYSMOD OK     */
         BAL   @14,FPTCHECK                                        0188
         EJECT
*                                                                  0189
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT TYPE LINE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0189
*   IF RTNCODE=ZERO                 /* IF PREV FUNCTIONS OK          */
*     THEN                          /*                               */
@RF00187 LTR   RTNCODE,RTNCODE                                     0189
         BNZ   @RF00189                                            0189
*     CALL FPTTYPE;                 /* FORMAT TYPE LINE              */
*                                                                  0190
         BAL   @14,FPTTYPE                                         0190
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT DUMMY SUPED OR DELETED TYPE ENTRY THEN FORMAT REST OF  */
*   /* DATA FROM SYSMOD                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0191
*   IF SUPONLY=OFF&IOPDBYP=OFF      /* IF NOT DUMMY SUP OR DELETE    */
*     THEN                          /*                               */
@RF00189 TM    SUPONLY,B'01000000'                                 0191
         BNZ   @RF00191                                            0191
         TM    IOPDBYP(IOPPTR),B'01000000'                         0191
         BNZ   @RF00191                                            0191
*     DO;                           /*                               */
*                                                                  0192
*       /*************************************************************/
*       /*                                                           */
*       /* IF CDS OR ACDS AND LASTUPDATE FIELD PRESENT FORMAT LINE   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0193
*       IF RTNCODE=ZERO             /*                               */
*           &(LISTCDS=ON×LISTACDS=ON)/*                              */
*           &IOPBUSMD(1)^=BLANK     /*                               */
*         THEN                      /*                               */
         LTR   RTNCODE,RTNCODE                                     0193
         BNZ   @RF00193                                            0193
         L     @14,@PC00001                                        0193
         TM    LISTCDS(@14),B'01100000'                            0193
         BZ    @RF00193                                            0193
         CLI   IOPBUSMD(IOPPTR),C' '                               0193
         BE    @RF00193                                            0193
*         CALL FPTLUPD;             /*                               */
*                                                                  0194
         BAL   @14,FPTLUPD                                         0194
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT STATUS LINE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0195
*       IF RTNCODE=ZERO             /* IF PREV FUNCTIONS OK          */
*           &LISTSCDS=OFF           /* AND NOT SCDS (NO STAT IN SCDS)*/
*         THEN                      /*                               */
@RF00193 LTR   RTNCODE,RTNCODE                                     0195
         BNZ   @RF00195                                            0195
         L     @14,@PC00001                                        0195
         TM    LISTSCDS(@14),B'00010000'                           0195
         BNZ   @RF00195                                            0195
*         CALL FPTSTAT;             /* FORMAT STATUS LINE            */
*                                                                  0196
         BAL   @14,FPTSTAT                                         0196
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT FMID LINE                                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0197
*       IF RTNCODE=ZERO             /* IF PREV FUNCTIONS OK          */
*         THEN                      /*                               */
@RF00195 LTR   RTNCODE,RTNCODE                                     0197
         BNZ   @RF00197                                            0197
*         CALL FPTFMID;             /* FORMAT FMID LINE              */
*                                                                  0198
         BAL   @14,FPTFMID                                         0198
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT JCLIN LINE                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0199
*       IF RTNCODE=ZERO             /*                               */
*           &IOPJCLP=ON             /*                               */
*         THEN                      /*                               */
@RF00197 LTR   RTNCODE,RTNCODE                                     0199
         BNZ   @RF00199                                            0199
         TM    IOPJCLP(IOPPTR),B'00000010'                         0199
         BNO   @RF00199                                            0199
*         CALL FPTJCL;              /*                               */
*                                                                  0200
         BAL   @14,FPTJCL                                          0200
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT DATE AND TIME STAMPS                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0201
*       IF RTNCODE=ZERO             /* IF PREV FUNCTIONS OK          */
*         THEN                      /*                               */
@RF00199 LTR   RTNCODE,RTNCODE                                     0201
         BNZ   @RF00201                                            0201
*         CALL FPTDATE;             /* FORMAT DATE AND TIME          */
*                                                                  0202
         BAL   @14,FPTDATE                                         0202
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT LRF DATASET NAME PREFIX                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0203
*       IF RTNCODE=ZERO             /* IF PREV FUNCTIONS OK          */
*           &LISTPTS=ON             /* AND PTS LIST                  */
*         THEN                      /*                               */
@RF00201 LTR   RTNCODE,RTNCODE                                     0203
         BNZ   @RF00203                                            0203
         L     @14,@PC00001                                        0203
         TM    LISTPTS(@14),B'00000010'                            0203
         BNO   @RF00203                                            0203
*         CALL FPTDSPFX;            /* FORMAT LRF DATA               */
         BAL   @14,FPTDSPFX                                        0204
*     END;                          /* END DUMMY SUP OR DELETE       */
*                                                                  0205
@RF00203 DS    0H                                                  0206
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT LAST SUP LINE                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0206
*   IF RTNCODE=ZERO                 /* IF PREV FUNCTIONS OK          */
*     THEN                          /*                               */
@RF00191 LTR   RTNCODE,RTNCODE                                     0206
         BNZ   @RF00206                                            0206
*     CALL FPTLSUP;                 /* FORMAT LAST SUP LINE          */
*                                                                  0207
         BAL   @14,FPTLSUP                                         0207
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT SUPBY SUBENTRIES                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0208
*   IF RTNCODE=ZERO                 /*                               */
*     THEN                          /*                               */
@RF00206 LTR   RTNCODE,RTNCODE                                     0208
         BNZ   @RF00208                                            0208
*     DO;                           /*                               */
*       FVPARRAD=ADDR(SMDARRY1);    /* SUPBY ARRAY                   */
         LA    @14,SMDARRY1                                        0210
         ST    @14,FVPARRAD                                        0210
*       CALL HMASMFVL(HMASMFVP);    /*                               */
         L     @15,@CV01312                                        0211
         LA    @01,@AL00211                                        0211
         BALR  @14,@15                                             0211
*     END;                          /*                               */
*                                                                  0212
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT DELBY LINE                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*   IF RTNCODE=ZERO                 /*                               */
*     THEN                          /*                               */
@RF00208 LTR   RTNCODE,RTNCODE                                     0213
         BNZ   @RF00213                                            0213
*     CALL FPTDELBY;                /*                               */
         BAL   @14,FPTDELBY                                        0214
         EJECT
*                                                                  0215
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT DUMMY SUPED OR DELETED TYPE ENTRY THEN FORMAT REST OF  */
*   /* DATA FROM SYSMOD SUBENTRIES                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0215
*   IF IOPDUMMP=OFF                 /* IF NOT DUMMY SUP OR DELETE    */
*     THEN                          /*                               */
@RF00213 TM    IOPDUMMP(IOPPTR),B'00000100'                        0215
         BNZ   @RF00215                                            0215
*     DO;                           /*                               */
*                                                                  0216
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT COMMENT TYPE SUBENTRIES IN SYSMOD                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0217
*       IF RTNCODE=ZERO             /* IF PREV FUNCTIONS OK          */
*         THEN                      /*                               */
         LTR   RTNCODE,RTNCODE                                     0217
         BNZ   @RF00217                                            0217
*         DO;                       /*                               */
*           FVPARRAD=ADDR(SMDARRY2);/* COMMENT ARRAY                 */
         LA    @14,SMDARRY2                                        0219
         ST    @14,FVPARRAD                                        0219
*           CALL HMASMFVL(HMASMFVP);/*                               */
         L     @15,@CV01312                                        0220
         LA    @01,@AL00220                                        0220
         BALR  @14,@15                                             0220
*         END;                      /*                               */
*                                                                  0221
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT CDSID/ACDSID SUBENTRIES IF PTS                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0222
*       IF RTNCODE=ZERO             /* IF PREV FUNCTIONS OK          */
*           &LISTPTS=ON             /* AND PTS DATASET               */
*         THEN                      /*                               */
@RF00217 LTR   RTNCODE,RTNCODE                                     0222
         BNZ   @RF00222                                            0222
         L     @14,@PC00001                                        0222
         TM    LISTPTS(@14),B'00000010'                            0222
         BNO   @RF00222                                            0222
*         DO;                       /*                               */
*           FVPARRAD=ADDR(SMDARRY3);/* PTS ARRAY                     */
         LA    @14,SMDARRY3                                        0224
         ST    @14,FVPARRAD                                        0224
*           CALL HMASMFVL(HMASMFVP);/*                               */
         L     @15,@CV01312                                        0225
         LA    @01,@AL00225                                        0225
         BALR  @14,@15                                             0225
*         END;                      /*                               */
*                                                                  0226
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT ++VER DATA IF NOT SCDS                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0227
*       IF RTNCODE=ZERO             /* IF PREV FUNCTIONS OK          */
*           &LISTSCDS=OFF           /* AND NOT SCDS                  */
*         THEN                      /*                               */
@RF00222 LTR   RTNCODE,RTNCODE                                     0227
         BNZ   @RF00227                                            0227
         L     @14,@PC00001                                        0227
         TM    LISTSCDS(@14),B'00010000'                           0227
         BNZ   @RF00227                                            0227
*         CALL FPTVER;              /* FORMAT SYSMOD ENTRIES FROM VER*/
*                                                                  0228
         BAL   @14,FPTVER                                          0228
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT SYSMOD SUBENTRIES                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0229
*       IF RTNCODE=ZERO             /* IF PREV FUNCTIONS OK          */
*           &LISTSCDS=OFF           /* AND NOT SCDS                  */
*         THEN                      /*                               */
@RF00227 LTR   RTNCODE,RTNCODE                                     0229
         BNZ   @RF00229                                            0229
         L     @14,@PC00001                                        0229
         TM    LISTSCDS(@14),B'00010000'                           0229
         BNZ   @RF00229                                            0229
*         DO;                       /*                               */
*           FVPARRAD=ADDR(SMDARRY5);/* SYSMOD SUBENTRY ARRAY         */
         LA    @14,SMDARRY5                                        0231
         ST    @14,FVPARRAD                                        0231
*           CALL HMASMFVL(HMASMFVP);/*                               */
         L     @15,@CV01312                                        0232
         LA    @01,@AL00232                                        0232
         BALR  @14,@15                                             0232
*         END;                      /*                               */
*                                                                  0233
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT SYSMOD SUBENTRIES IF SCDS                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0234
*       IF RTNCODE=ZERO             /* IF PREV FUNCTIONS OK          */
*           &LISTSCDS=ON            /* AND SCDS                      */
*         THEN                      /*                               */
@RF00229 LTR   RTNCODE,RTNCODE                                     0234
         BNZ   @RF00234                                            0234
         L     @14,@PC00001                                        0234
         TM    LISTSCDS(@14),B'00010000'                           0234
         BNO   @RF00234                                            0234
*         DO;                       /*                               */
*           FVPARRAD=ADDR(SMDARRY6);/* SCDS SUBENTRY ARRAY           */
         LA    @14,SMDARRY6                                        0236
         ST    @14,FVPARRAD                                        0236
*           CALL HMASMFVL(HMASMFVP);/*                               */
         L     @15,@CV01312                                        0237
         LA    @01,@AL00237                                        0237
         BALR  @14,@15                                             0237
*         END;                      /*                               */
*     END;                          /* END NOT DUMMY SUP OR DELETE   */
@RF00234 DS    0H                                                  0240
         EJECT
*                                                                  0240
*   /*****************************************************************/
*   /*                                                               */
*   /* IF XREF SPECIFIED THEN FORMAT XREF FILE DATA                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*   IF RTNCODE=ZERO                 /* IF NO PREV ERRORS             */
*       &LISTXREF=ON                /* AND XREF OPTION               */
*     THEN                          /*                               */
@RF00215 LTR   RTNCODE,RTNCODE                                     0240
         BNZ   @RF00240                                            0240
         L     @14,@PC00001                                        0240
         TM    LISTXREF(@14),B'01000000'                           0240
         BNO   @RF00240                                            0240
*     CALL HMASMFXF(HMASMIOP);      /* FORMAT XREF DATA              */
*                                                                  0241
         ST    IOPPTR,@AL00001                                     0241
         L     @15,@CV01311                                        0241
         LA    @01,@AL00001                                        0241
         BALR  @14,@15                                             0241
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING COMPLETED - RETURN TO THE CALLING PROGRAM          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0242
*   RETURN CODE(RTNCODE);           /*                               */
@RF00240 L     @13,4(,@13)                                         0242
         L     @14,12(,@13)                                        0242
         LM    @00,@12,20(@13)                                     0242
         BR    @14                                                 0242
*   RFY                                                            0243
*     RTNCODE UNRSTD;               /*                               */
         EJECT
*                                                                  0244
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE USED TO RESET THE HMASMIO HEADING BUFFERS             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0244
*FPTSETHD:                                                         0244
*   PROCEDURE;                                                     0244
FPTSETHD STM   @14,@12,@SA00002                                    0244
*   RFY                                                            0245
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   DECLARE                                                        0246
*     HEADSAV PTR(31);              /* SAVE AREA FOR BUFAD           */
*   DECLARE                         /*                               */
*     HDINDX FIXED(31);             /* LOOP CONTER                   */
*   DECLARE                         /*                               */
*     SETDSID FIXED(8);             /*                               */
*                                                                  0248
*   /*****************************************************************/
*   /*                                                               */
*   /* SET DATASET ID IN HEADING LINE                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0249
*   SETDSID=IOPDSID;                /*                               */
         SLR   SETDSID,SETDSID                                     0249
         IC    SETDSID,IOPDSID(,IOPPTR)                            0249
*   HDH1OPT=TXTXXXHD;               /* SYSMOD ENTRIES                */
         MVC   HDH1OPT(25),TXTXXXHD                                0250
*   HDH1SMD='';                     /* NO SYSMOD NUMBER              */
         MVI   HDH1SMD,C' '                                        0251
         MVC   HDH1SMD+1(6),HDH1SMD                                0251
*   IF LISTCDS=ON                   /*                               */
*     THEN                          /*                               */
         L     @08,@PC00001                                        0252
         TM    LISTCDS(@08),B'01000000'                            0252
         BNO   @RF00252                                            0252
*     HDH1DSID=TXTCDS;              /*                               */
         MVC   HDH1DSID(8),TXTCDS                                  0253
*   ELSE                            /*                               */
*     IF LISTACDS=ON                /*                               */
*       THEN                        /*                               */
         B     @RC00252                                            0254
@RF00252 L     @08,@PC00001                                        0254
         TM    LISTACDS(@08),B'00100000'                           0254
         BNO   @RF00254                                            0254
*       HDH1DSID=TXTACDS;           /*                               */
         MVC   HDH1DSID(8),TXTACDS                                 0255
*     ELSE                          /*                               */
*       IF LISTPTS=ON               /*                               */
*         THEN                      /*                               */
         B     @RC00254                                            0256
@RF00254 L     @08,@PC00001                                        0256
         TM    LISTPTS(@08),B'00000010'                            0256
         BNO   @RF00256                                            0256
*         HDH1DSID=TXTPTS;          /*                               */
         MVC   HDH1DSID(8),TXTPTS                                  0257
*       ELSE                        /*                               */
*         DO;                       /*                               */
         B     @RC00256                                            0258
@RF00256 DS    0H                                                  0259
*           HDH1DSID=TXTSCDS;       /*                               */
         MVC   HDH1DSID(8),TXTSCDS                                 0259
*           HDH1OPT=TXTSCDHD;       /* BACKUP ENTRIES FOR SYSMOD     */
         MVC   HDH1OPT(25),TXTSCDHD                                0260
*           HDH1SMD=IOPNAM17;       /*                               */
         MVC   HDH1SMD(7),IOPNAM17(IOPPTR)                         0261
*         END;                      /*                               */
*                                                                  0262
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP IOP TO DELETE EXISTING HEADINGS AND CALL IO TO DELETE  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0263
*   HEADSAV=IOPBUFAD;               /* SAVE THE BUFFER ADDRESS       */
@RC00256 DS    0H                                                  0263
@RC00254 DS    0H                                                  0263
@RC00252 L     HEADSAV,IOPBUFAD(,IOPPTR)                           0263
*   IOPBUFAD=ADDR(OUTAREA);         /* AND AIM AT THE PRINT LINE     */
         LA    @08,OUTAREA                                         0264
         ST    @08,IOPBUFAD(,IOPPTR)                               0264
*   IOPDSID=CCALSTDS;               /* INDICATE PRINTER DATA SET     */
         MVC   IOPDSID(1,IOPPTR),CCALSTDS(CCAPTR)                  0265
*   IOPFUNCT=IOPWRITE;              /* FOR OUTPUT                    */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0266
*   PRLHDADR=ZERO;                  /* ZERO OUT HEADING ADDRESS      */
         SLR   @05,@05                                             0267
         STCM  @05,7,PRLHDADR(@08)                                 0267
*   PRLRLEN=ZERO;                   /* INDICATE ZERO RECORD LENGTH 0268
*                                      USED TO RESET HEADINGS        */
         STH   @05,PRLRLEN(,@08)                                   0268
*   PRLHEAD=OFF;                    /* RESET ALL HEADINGS            */
*   PRLHEADO=ON;                    /* WITH THESE TWO PARMS          */
*   PRLBLANK=OFF;                   /* NOT A BLANK LINE              */
         OI    PRLHEADO(@08),B'01000000'                           0271
         NI    PRLHEAD(@08),B'01011111'                            0271
*   CALL HMASMIO(HMASMIOP);         /* CALL ON THE I/O ROUTINE       */
*                                                                  0272
         ST    IOPPTR,@AL00001                                     0272
         L     @15,@CV01313                                        0272
         LA    @01,@AL00001                                        0272
         BALR  @14,@15                                             0272
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP ADDING ALL SYSMOD HEADINGS                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0273
*   DO HDINDX=1 TO DIM(HEADPTR)     /* LOOP USING ALL THE HD PTRS    */
*         WHILE(IOPRETRN=IOPGOOD);  /*                               */
         LA    HDINDX,1                                            0273
@DL00273 CLI   IOPRETRN(IOPPTR),0                                  0273
         BNE   @DC00273                                            0273
*     PRLRLEN=LENGTH(PRNTBUF);      /* SET STANDARD LENGTH           */
         L     @08,IOPBUFAD(,IOPPTR)                               0274
         MVC   PRLRLEN(2,@08),@CH01339                             0274
*     PRLHEAD=ON;                   /* SET IN THE NEW HEADING        */
*     PRLHEADO=OFF;                 /* KILL THE RESET SWITCH         */
         OI    PRLHEAD(@08),B'10000000'                            0276
         NI    PRLHEADO(@08),B'10111111'                           0276
*     IF HEADPTR(HDINDX)=ZERO       /* BLANK HEADING?                */
*       THEN                                                       0277
         SLR   @05,@05                                             0277
         LR    @15,HDINDX                                          0277
         SLA   @15,2                                               0277
         C     @05,HEADPTR-4(@15)                                  0277
         BNE   @RF00277                                            0277
*       DO;                                                        0278
*         PRLBLANK=ON;              /* INDICATE BLANK HEADING        */
         OI    PRLBLANK(@08),B'00100000'                           0279
*         PRLHDADR=ZERO;            /* CLEAR HEADING ADDRESS         */
         STCM  @05,7,PRLHDADR(@08)                                 0280
*       END;                                                       0281
*     ELSE                                                         0282
*       DO;                         /* NO PASS A HEADING ADDRESS     */
         B     @RC00277                                            0282
@RF00277 DS    0H                                                  0283
*         PRLBLANK=OFF;             /* NOT A BLANK LINE              */
         L     @08,IOPBUFAD(,IOPPTR)                               0283
         NI    PRLBLANK(@08),B'11011111'                           0283
*         PRLHDADR=HEADPTR(HDINDX); /* INSERT THE HEAD ADDR          */
         LR    @05,HDINDX                                          0284
         SLA   @05,2                                               0284
         L     @05,HEADPTR-4(@05)                                  0284
         STCM  @05,7,PRLHDADR(@08)                                 0284
*       END;                                                       0285
*     CALL HMASMIO(HMASMIOP);       /* PASS TO I/O ROUTINE           */
@RC00277 ST    IOPPTR,@AL00001                                     0286
         L     @15,@CV01313                                        0286
         LA    @01,@AL00001                                        0286
         BALR  @14,@15                                             0286
*   END;                                                           0287
         AH    HDINDX,@CH00044                                     0287
         CH    HDINDX,@CH00069                                     0287
         BNH   @DL00273                                            0287
@DC00273 DS    0H                                                  0288
*   PRLBLANK=OFF;                   /* INSURE BLANK INDICATOR IS OFF */
         L     @08,IOPBUFAD(,IOPPTR)                               0288
         NI    PRLBLANK(@08),B'11011111'                           0288
*   IOPBUFAD=HEADSAV;               /* RESTORE BUFFER ADDRESS        */
         ST    HEADSAV,IOPBUFAD(,IOPPTR)                           0289
*   IOPDSID=SETDSID;                /*                               */
         STC   SETDSID,IOPDSID(,IOPPTR)                            0290
*   RETURN CODE(IOPRETRN);          /*                               */
         SLR   @15,@15                                             0291
         IC    @15,IOPRETRN(,IOPPTR)                               0291
         L     @14,@SA00002                                        0291
         LM    @00,@12,@SA00002+8                                  0291
         BR    @14                                                 0291
*   END FPTSETHD;                   /* RETURN TO CALLER              */
         EJECT
*                                                                  0293
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RECEIVE,APPLY,RESTORE,ACCEPT,BYPASS, OR ERROR OPTIONS  */
*   /* WERE SPECIFIED ON THE LIST CONTROL CARD INSURE THAT THE PTF IS*/
*   /* IN THE PROPER STATUS IF NOT SET RETURN CODE TO 4 TO INDICATE  */
*   /* SYSMOD NOT ELIGIBLE FOR LISTING                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0293
*FPTCHECK:                          /*                               */
*   PROCEDURE;                      /*                               */
FPTCHECK STM   @14,@12,12(@13)                                     0293
*   DECLARE                         /*                               */
*     CHKX FIXED(31);               /* LOOP VARIABLE                 */
*   DECLARE                         /*                               */
*     CHKRC FIXED(8);               /*                               */
*   RFY                                                            0296
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   CHKRC=ZERO;                     /* INIT RC                       */
*                                                                  0297
         SLR   CHKRC,CHKRC                                         0297
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TYPE SYSMOD AGAINST LIST                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0298
*   IF(LISTFUNC=OFF&LISTPTF=OFF&LISTAPAR=OFF&LISTUSER=OFF)/*         */
*       ×(LISTFUNC=ON&IOPPTYPE=IOPPFUNC)/* IF SYSMOD TYPE IS         */
*       ×(LISTPTF=ON&IOPPTYPE=IOPPPTF)/* TYPE REQUESTED              */
*       ×(LISTAPAR=ON&IOPPTYPE=IOPPAPAR)/* THEN SYSMOD SHOULD        */
*       ×(LISTUSER=ON&IOPPTYPE=IOPPUSER)/* BE LISTED                 */
*     THEN                          /* SO LEAVE RC ALONE             */
         L     @08,@PC00001                                        0298
         TM    LISTFUNC(@08),B'00001111'                           0298
         BZ    @RT00298                                            0298
         L     @08,@PC00001                                        0298
         TM    LISTFUNC(@08),B'00001000'                           0298
         BNO   @GL00015                                            0298
         CLI   IOPPTYPE(IOPPTR),4                                  0298
         BE    @RT00298                                            0298
@GL00015 L     @08,@PC00001                                        0298
         TM    LISTPTF(@08),B'00000100'                            0298
         BNO   @GL00014                                            0298
         CLI   IOPPTYPE(IOPPTR),3                                  0298
         BE    @RT00298                                            0298
@GL00014 L     @08,@PC00001                                        0298
         TM    LISTAPAR(@08),B'00000010'                           0298
         BNO   @GL00013                                            0298
         CLI   IOPPTYPE(IOPPTR),2                                  0298
         BE    @RT00298                                            0298
@GL00013 L     @08,@PC00001                                        0298
         TM    LISTUSER(@08),B'00000001'                           0298
         BNO   @RF00298                                            0298
         CLI   IOPPTYPE(IOPPTR),1                                  0298
         BE    @RT00298                                            0298
*     ;                             /*                               */
*   ELSE                            /* ELSE SET RC TO NOT LIST IT    */
*     CHKRC=NOTELIG;                /* SYSMOD NOT ELIGIBLE           */
@RF00298 LA    CHKRC,2                                             0300
*   IF LISTRES=ON&IOPRES=OFF        /* LIST RESTORED SYSMODS         */
*     THEN                          /* AND SYSMOD NOT REST           */
@RT00298 L     @08,@PC00001                                        0301
         TM    LISTRES(@08),B'00010000'                            0301
         BNO   @RF00301                                            0301
         TM    IOPRES(IOPPTR),B'01000000'                          0301
         BNZ   @RF00301                                            0301
*     CHKRC=IOPNTFND;               /* SET RC TO STOP FORMAT         */
         LA    CHKRC,4                                             0302
*   IF(LISTSUP=ON&IOPSBYP=OFF)      /* LIST SUP ONLY BUT NOT SUPED   */
*       ×(LISTNSUP=ON&IOPSBYP=ON)   /* LIST NOSUP ONLY BUT SUPED     */
*       ×(LISTBYP=ON&IOPBYP=OFF)    /* BYP ONLY AND NOT BYP?         */
*       ×(LISTERR=ON&IOPERROR=OFF)  /* ERROR ONLY AND NOT ERROR?     */
*       ×(LISTDEL=ON&IOPDBYP=OFF)   /* DEL ONLY BUT NOT DELETED?     */
*     THEN                          /* IF ANY OF ABOVE COND          */
@RF00301 L     @08,@PC00001                                        0303
         TM    LISTSUP(@08),B'10000000'                            0303
         BNO   @GL00025                                            0303
         TM    IOPSBYP(IOPPTR),B'10000000'                         0303
         BZ    @RT00303                                            0303
@GL00025 L     @08,@PC00001                                        0303
         TM    LISTNSUP(@08),B'01000000'                           0303
         BNO   @GL00024                                            0303
         TM    IOPSBYP(IOPPTR),B'10000000'                         0303
         BO    @RT00303                                            0303
@GL00024 L     @08,@PC00001                                        0303
         TM    LISTBYP(@08),B'00010000'                            0303
         BNO   @GL00023                                            0303
         TM    IOPBYP(IOPPTR),B'00000010'                          0303
         BZ    @RT00303                                            0303
@GL00023 L     @08,@PC00001                                        0303
         TM    LISTERR(@08),B'00001000'                            0303
         BNO   @GL00022                                            0303
         TM    IOPERROR(IOPPTR),B'00010000'                        0303
         BZ    @RT00303                                            0303
@GL00022 L     @08,@PC00001                                        0303
         TM    LISTDEL(@08),B'00100000'                            0303
         BNO   @RF00303                                            0303
         TM    IOPDBYP(IOPPTR),B'01000000'                         0303
         BNZ   @RF00303                                            0303
@RT00303 DS    0H                                                  0304
*     CHKRC=NOTELIG;                /* SYSMOD NOT ELIGIBLE           */
*                                                                  0304
         LA    CHKRC,2                                             0304
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE WHETHER SYSMOD IS SUPED ONLY                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0305
*   SUPONLY=OFF;                    /*                               */
@RF00303 NI    SUPONLY,B'10111111'                                 0305
*   IF IOPSBYP=ON                   /* IF SYSMOD BEEN SUPED          */
*     THEN                          /*                               */
         TM    IOPSBYP(IOPPTR),B'10000000'                         0306
         BNO   @RF00306                                            0306
*     IF IOPDUMMP=ON                /* IF NO SUBENTRIES              */
*       THEN                        /* THEN                          */
         TM    IOPDUMMP(IOPPTR),B'00000100'                        0307
         BNO   @RF00307                                            0307
*       SUPONLY=ON;                 /* SUPED ONLY SYSMOD             */
         OI    SUPONLY,B'01000000'                                 0308
*     ELSE                          /*                               */
*       DO;                         /*                               */
         B     @RC00307                                            0309
@RF00307 DS    0H                                                  0310
*         SUPONLY=ON;               /* ASSUME SUED ONLY              */
         OI    SUPONLY,B'01000000'                                 0310
*         DO CHKX=1 BY 1 WHILE(     /* LOOP THRU SYSMOD SUBENTRIES   */
*               IOPPTFND(CHKX)^=IOPEOLST/* TILL END                  */
*               &SUPONLY=ON);       /* AND NON-SUP NOT FOUND         */
         LA    CHKX,1                                              0311
         B     @DE00311                                            0311
@DL00311 DS    0H                                                  0312
*           IF IOPPIND(CHKX)^=IOPPSBY/* IF NOT SUPBY SUBENTRY        */
*             THEN                  /*                               */
         LR    @08,CHKX                                            0312
         MH    @08,@CH00490                                        0312
         SLR   @15,@15                                             0312
         IC    @15,IOPPIND-9(@08,IOPPTR)                           0312
         CH    @15,@CH01123                                        0312
         BE    @RF00312                                            0312
*             SUPONLY=OFF;          /* NOT SUPED ONLY                */
         NI    SUPONLY,B'10111111'                                 0313
*         END;                      /* END LOO THRU SYSMOD SUBENTRIES*/
@RF00312 AH    CHKX,@CH00044                                       0314
@DE00311 LR    @08,CHKX                                            0314
         MH    @08,@CH00490                                        0314
         SLR   @15,@15                                             0314
         IC    @15,IOPPTFND-9(@08,IOPPTR)                          0314
         CH    @15,@CH00679                                        0314
         BE    @DC00311                                            0314
         TM    SUPONLY,B'01000000'                                 0314
         BO    @DL00311                                            0314
@DC00311 DS    0H                                                  0315
*       END;                        /* END NOT DUMMY SUP ENTRY       */
*   RETURN CODE(CHKRC);             /*                               */
@RC00307 DS    0H                                                  0316
@RF00306 LR    @15,CHKRC                                           0316
         L     @14,12(,@13)                                        0316
         LM    @00,@12,20(@13)                                     0316
         BR    @14                                                 0316
*   END FPTCHECK;                   /*                               */
         EJECT
*                                                                  0318
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT TYPE LINE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0318
*FPTTYPE:                           /*                               */
*   PROCEDURE;                      /*                               */
FPTTYPE  STM   @14,@12,@SA00004                                    0318
*   RFY                                                            0319
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   HDSUBHD=TXTTYPE;                /*                               */
         MVC   HDSUBHD(15),@CC01404                                0320
*   HDSEPCHR=TXTEQ;                 /*                               */
         MVI   HDSEPCHR,C'='                                       0321
*   IF IOPDBYP=ON                   /* IF DUMMY DEL                  */
*       &IOPPTYPE=ZERO              /* AND NO KNOWN TYPE CODE        */
*     THEN                          /*                               */
         TM    IOPDBYP(IOPPTR),B'01000000'                         0322
         BNO   @RF00322                                            0322
         CLI   IOPPTYPE(IOPPTR),0                                  0322
         BNE   @RF00322                                            0322
*     HDDEL=TXTDELTD;               /*                               */
         MVC   HDDEL(7),@CC01410                                   0323
*   ELSE                            /*                               */
*     IF SUPONLY=ON                 /* IF DUMMY SUP                  */
*         &IOPPTYPE=ZERO            /* AND NO KNOWN TYPE CODE        */
*       THEN                        /*                               */
         B     @RC00322                                            0324
@RF00322 TM    SUPONLY,B'01000000'                                 0324
         BNO   @RF00324                                            0324
         CLI   IOPPTYPE(IOPPTR),0                                  0324
         BNE   @RF00324                                            0324
*       HDSUP=TXTSUP;               /*                               */
         MVC   HDSUP(10),@CC01407                                  0325
*     ELSE                          /*                               */
*       IF IOPPTYPE=IOPPAPAR        /*                               */
*         THEN                      /*                               */
         B     @RC00324                                            0326
@RF00324 CLI   IOPPTYPE(IOPPTR),2                                  0326
         BNE   @RF00326                                            0326
*         HDAPAR=TXTAPAR;           /*                               */
         MVC   HDAPAR(4),@CC01416                                  0327
*       ELSE                        /*                               */
*         IF IOPPTYPE=IOPPPTF       /*                               */
*           THEN                    /*                               */
         B     @RC00326                                            0328
@RF00326 CLI   IOPPTYPE(IOPPTR),3                                  0328
         BNE   @RF00328                                            0328
*           HDPTF=TXTPTF;           /*                               */
         MVC   HDPTF(3),@CC01414                                   0329
*         ELSE                      /*                               */
*           IF IOPPTYPE=IOPPFUNC    /*                               */
*             THEN                  /*                               */
         B     @RC00328                                            0330
@RF00328 CLI   IOPPTYPE(IOPPTR),4                                  0330
         BNE   @RF00330                                            0330
*             HDFUNC=TXTFUNC;       /*                               */
         MVC   HDFUNC(8),@CC01412                                  0331
*           ELSE                    /*                               */
*             IF IOPPTYPE=IOPPUSER  /*                               */
*               THEN                /*                               */
         B     @RC00330                                            0332
@RF00330 CLI   IOPPTYPE(IOPPTR),1                                  0332
         BNE   @RF00332                                            0332
*               HDUSER=TXTUSER;     /*                               */
         MVC   HDUSER(7),@CC01418                                  0333
*   HDNAME=IOPNAM17;                /* MOVE SYSMOD NUMBER            */
@RF00332 DS    0H                                                  0334
@RC00330 DS    0H                                                  0334
@RC00328 DS    0H                                                  0334
@RC00326 DS    0H                                                  0334
@RC00324 DS    0H                                                  0334
@RC00322 MVI   HDNAME+7,C' '                                       0334
         MVC   HDNAME(7),IOPNAM17(IOPPTR)                          0334
*   CALL FPTWRITE;                  /* WRITE LINE                    */
         BAL   @14,FPTWRITE                                        0335
*   RFY                                                            0336
*     RTNCODE RSTD;                 /*                               */
*   RETURN CODE(RTNCODE);           /* RTN WITH CODE FROM WRITE      */
         L     @14,@SA00004                                        0337
         LM    @00,@12,@SA00004+8                                  0337
         BR    @14                                                 0337
*   RFY                                                            0338
*     RTNCODE UNRSTD;               /*                               */
*   END FPTTYPE;                    /*                               */
         EJECT
*                                                                  0340
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT LASTUPDATE LINE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0340
*FPTLUPD:                           /*                               */
*   PROCEDURE;                      /*                               */
FPTLUPD  STM   @14,@12,@SA00005                                    0340
*   RFY                             /*                               */
*     RTNCODE RSTD;                 /*                               */
*   HDSUBHD=TXTLUPD;                /*                               */
         MVC   HDSUBHD(15),@CC01388                                0342
*   HDSEPCHR=TXTEQ;                 /*                               */
         MVI   HDSEPCHR,C'='                                       0343
*   HDUPDSMD=IOPBUSMD;              /*                               */
         MVC   HDUPDSMD(7),IOPBUSMD(IOPPTR)                        0344
*   IF IOPBUTYP=IOPBUADD            /*                               */
*     THEN                          /*                               */
         CLI   IOPBUTYP(IOPPTR),1                                  0345
         BNE   @RF00345                                            0345
*     HDUPDTYP=TXTADD;              /*                               */
         MVC   HDUPDTYP(3),@CC01391                                0346
*   ELSE                            /*                               */
*     IF IOPBUTYP=IOPBUMOD          /*                               */
*       THEN                        /*                               */
         B     @RC00345                                            0347
@RF00345 CLI   IOPBUTYP(IOPPTR),3                                  0347
         BNE   @RF00347                                            0347
*       HDUPDTYP=TXTUPD;            /*                               */
         MVC   HDUPDTYP(3),@CC01395                                0348
*     ELSE                          /*                               */
*       HDUPDTYP=TXTDEL;            /*                               */
         B     @RC00347                                            0349
@RF00347 MVC   HDUPDTYP(3),@CC01393                                0349
*   HDDATA=LUPDLINE;                /*                               */
@RC00347 DS    0H                                                  0350
@RC00345 MVI   HDDATA+17,C' '                                      0350
         MVC   HDDATA+18(74),HDDATA+17                             0350
         MVC   HDDATA(17),LUPDLINE                                 0350
*   CALL FPTWRITE;                  /*                               */
         BAL   @14,FPTWRITE                                        0351
*   RETURN CODE(RTNCODE);           /*                               */
         L     @14,@SA00005                                        0352
         LM    @00,@12,@SA00005+8                                  0352
         BR    @14                                                 0352
*   RFY                             /*                               */
*     RTNCODE UNRSTD;               /*                               */
*   END FPTLUPD;                    /*                               */
         EJECT
*                                                                  0355
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK STATUS OF PTF AND SET OUTPUT LINE STATUS. STATUS WILL   */
*   /* PRINT OUT FOR ALL PTFS EVEN SUPERCEDED ONLY PTFS IF ANY IS    */
*   /* PRESENT(ADDED BY USER VIA UCLIN)                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0355
*FPTSTAT:                           /*                               */
*   PROCEDURE;                      /*                               */
FPTSTAT  STM   @14,@12,@SA00006                                    0355
*   DECLARE                         /*                               */
*     STATINDX FIXED(31);           /*                               */
*   RFY                                                            0357
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   HDSUBHD=TXTSTAT;                /*                               */
         MVC   HDSUBHD(15),@CC01423                                0358
*   HDSEPCHR=TXTEQ;                 /*                               */
         MVI   HDSEPCHR,C'='                                       0359
*   STATINDX=1;                     /* INDEX TO OUTPUT AREA          */
         LA    @08,1                                               0360
         LR    STATINDX,@08                                        0360
*   HDSTAT(STATINDX)=TXTREC;        /* ALL SYSMODS RECEIVED          */
         LA    @03,5                                               0361
         LR    @01,STATINDX                                        0361
         MR    @00,@03                                             0361
         LA    @15,HDSTAT-5(@01)                                   0361
         MVC   0(3,@15),@CC01428                                   0361
*   IF IOPBYP=ON                    /* BYPASSD STATUS ?              */
*     THEN                                                         0362
         TM    IOPBYP(IOPPTR),B'00000010'                          0362
         BNO   @RF00362                                            0362
*     DO;                           /*                               */
*       STATINDX=STATINDX+1;        /*                               */
         ALR   STATINDX,@08                                        0364
*       HDSTAT(STATINDX)=TXTBYP;    /* YES - SET STATUS              */
         LR    @01,@03                                             0365
         MR    @00,STATINDX                                        0365
         LA    @08,HDSTAT-5(@01)                                   0365
         MVC   0(3,@08),@CC01426                                   0365
*     END;                          /*                               */
*   IF IOPAPP=ON                    /* APPLIED STATUS ?              */
*     THEN                                                         0367
@RF00362 TM    IOPAPP(IOPPTR),B'10000000'                          0367
         BNO   @RF00367                                            0367
*     DO;                           /*                               */
*       STATINDX=STATINDX+1;        /*                               */
         AH    STATINDX,@CH00044                                   0369
*       HDSTAT(STATINDX)=TXTAPP;    /* YES - SET STATUS              */
         LR    @08,STATINDX                                        0370
         MH    @08,@CH00069                                        0370
         LA    @03,HDSTAT-5(@08)                                   0370
         MVC   0(3,@03),@CC01430                                   0370
*     END;                          /*                               */
*   IF IOPRES=ON                    /* IF RESTORE WAS TRIED          */
*     THEN                          /* YES - THEN                    */
@RF00367 TM    IOPRES(IOPPTR),B'01000000'                          0372
         BNO   @RF00372                                            0372
*     DO;                           /*                               */
*       STATINDX=STATINDX+1;        /*                               */
         AH    STATINDX,@CH00044                                   0374
*       HDSTAT(STATINDX)=TXTRES;    /* YES - SET STATUS              */
         LR    @08,STATINDX                                        0375
         MH    @08,@CH00069                                        0375
         LA    @03,HDSTAT-5(@08)                                   0375
         MVC   0(3,@03),@CC01432                                   0375
*     END;                          /*                               */
*   IF IOPACC=ON                    /* ACCEPTED STATUS ?             */
*     THEN                                                         0377
@RF00372 TM    IOPACC(IOPPTR),B'00100000'                          0377
         BNO   @RF00377                                            0377
*     DO;                           /*                               */
*       STATINDX=STATINDX+1;        /*                               */
         AH    STATINDX,@CH00044                                   0379
*       HDSTAT(STATINDX)=TXTACC;    /* YES - SET STATUS              */
         LR    @08,STATINDX                                        0380
         MH    @08,@CH00069                                        0380
         LA    @03,HDSTAT-5(@08)                                   0380
         MVC   0(3,@03),@CC01434                                   0380
*     END;                          /*                               */
*   IF IOPREGEN=ON                  /* REGEN ON?                     */
*     THEN                          /* YES                           */
@RF00377 TM    IOPREGEN(IOPPTR),B'00000001'                        0382
         BNO   @RF00382                                            0382
*     DO;                           /*                               */
*       STATINDX=STATINDX+1;        /*                               */
         AH    STATINDX,@CH00044                                   0384
*       HDSTAT(STATINDX)=TXTRGN;    /* YES - SET STATUS              */
         LR    @08,STATINDX                                        0385
         MH    @08,@CH00069                                        0385
         LA    @03,HDSTAT-5(@08)                                   0385
         MVC   0(3,@03),@CC01436                                   0385
*     END;                          /*                               */
*   IF IOPERROR=ON                  /* PTF IN ERROR                  */
*     THEN                          /* YES                           */
@RF00382 TM    IOPERROR(IOPPTR),B'00010000'                        0387
         BNO   @RF00387                                            0387
*     DO;                           /*                               */
*       STATINDX=STATINDX+1;        /*                               */
         AH    STATINDX,@CH00044                                   0389
*       HDSTAT(STATINDX)=TXTERR;    /* YES - SET STATUS              */
         LR    @08,STATINDX                                        0390
         MH    @08,@CH00069                                        0390
         LA    @03,HDSTAT-5(@08)                                   0390
         MVC   0(3,@03),@CC01438                                   0390
*     END;                          /*                               */
*   CALL FPTWRITE;                  /* WRITE LINE                    */
@RF00387 BAL   @14,FPTWRITE                                        0392
*   RFY                                                            0393
*     RTNCODE RSTD;                 /*                               */
*   RETURN CODE(RTNCODE);           /* RTN WITH CODE FROM WRITE      */
         L     @14,@SA00006                                        0394
         LM    @00,@12,@SA00006+8                                  0394
         BR    @14                                                 0394
*   RFY                                                            0395
*     RTNCODE UNRSTD;               /*                               */
*   END FPTSTAT;                    /*                               */
         EJECT
*                                                                  0397
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT FMID LINE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0397
*FPTFMID:                           /*                               */
*   PROCEDURE;                      /*                               */
FPTFMID  STM   @14,@12,@SA00007                                    0397
*   RFY                                                            0398
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   RFY                                                            0399
*     RTNCODE RSTD;                 /*                               */
*   RTNCODE=ZERO;                   /*                               */
         SLR   RTNCODE,RTNCODE                                     0400
*   IF IOPPFMID(1)^=BLANK           /* IF FMID PRESENT               */
*       &IOPPFMID(1)^=ZERO          /*                               */
*     THEN                          /*                               */
         CLI   IOPPFMID(IOPPTR),C' '                               0401
         BE    @RF00401                                            0401
         CLI   IOPPFMID(IOPPTR),0                                  0401
         BE    @RF00401                                            0401
*     DO;                           /*                               */
*       HDSUBHD=TXTFMID;            /*                               */
         MVC   HDSUBHD(15),@CC01451                                0403
*       HDSEPCHR=TXTEQ;             /*                               */
         MVI   HDSEPCHR,C'='                                       0404
*       HDFMID=IOPPFMID;            /*                               */
         MVC   HDFMID(7),IOPPFMID(IOPPTR)                          0405
*       CALL FPTWRITE;              /*                               */
         BAL   @14,FPTWRITE                                        0406
*     END;                          /*                               */
*   RETURN CODE(RTNCODE);           /*                               */
@RF00401 L     @14,@SA00007                                        0408
         LM    @00,@12,@SA00007+8                                  0408
         BR    @14                                                 0408
*   RFY                                                            0409
*     RTNCODE UNRSTD;               /*                               */
*   END FPTFMID;                    /*                               */
         EJECT
*                                                                  0411
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT JCLIN= LINE                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*FPTJCL:                            /*                               */
*   PROCEDURE;                      /*                               */
FPTJCL   STM   @14,@12,@SA00008                                    0411
*   RFY                                                            0412
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   RFY                                                            0413
*     RTNCODE RSTD;                 /*                               */
*   HDSUBHD=TXTJCL;                 /*                               */
         MVC   HDSUBHD(15),@CC01442                                0414
*   HDSEPCHR=TXTEQ;                 /*                               */
         MVI   HDSEPCHR,C'='                                       0415
*   HDJCL=TXTYES;                   /*                               */
         MVC   HDJCL(3),@CC01445                                   0416
*   CALL FPTWRITE;                  /*                               */
         BAL   @14,FPTWRITE                                        0417
*   RETURN CODE(RTNCODE);           /*                               */
         L     @14,@SA00008                                        0418
         LM    @00,@12,@SA00008+8                                  0418
         BR    @14                                                 0418
*   RFY                                                            0419
*     RTNCODE UNRSTD;               /*                               */
*   END FPTJCL;                     /*                               */
         EJECT
*                                                                  0421
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT TIME AND DATE STAMPS                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0421
*FPTDATE:                           /*                               */
*   PROCEDURE;                      /*                               */
FPTDATE  STM   @14,@12,@SA00009                                    0421
*   RFY                                                            0422
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   RFY                                                            0423
*     RTNCODE RSTD;                 /*                               */
*   HDSUBHD=TXTDTTM;                /*                               */
         MVC   HDSUBHD(15),TXTDTTM                                 0424
*   RTNCODE=ZERO;                   /*                               */
         SLR   RTNCODE,RTNCODE                                     0425
*   IF LISTSCDS=OFF                 /* IF NOT SCDS LIST              */
*     THEN                          /* SCDS ONLY HAS APPLY           */
         L     @14,@PC00001                                        0426
         TM    LISTSCDS(@14),B'00010000'                           0426
         BNZ   @RF00426                                            0426
*     DO;                           /*                               */
*       DATEFUNC=TXTREC;            /*                               */
         MVC   DATEFUNC(3),@CC01428                                0428
*       CALL FPTCNV(IOPRECD,IOPRECT);/*                              */
         LA    @14,IOPRECD(,IOPPTR)                                0429
         ST    @14,@AL00001                                        0429
         LA    @14,IOPRECT(,IOPPTR)                                0429
         ST    @14,@AL00001+4                                      0429
         LA    @01,@AL00001                                        0429
         BAL   @14,FPTCNV                                          0429
*     END;                          /*                               */
*   IF RTNCODE=ZERO                 /*                               */
*       &LISTPTS=OFF                /*                               */
*     THEN                          /*                               */
@RF00426 LTR   RTNCODE,RTNCODE                                     0431
         BNZ   @RF00431                                            0431
         L     @14,@PC00001                                        0431
         TM    LISTPTS(@14),B'00000010'                            0431
         BNZ   @RF00431                                            0431
*     DO;                           /*                               */
*       DATEFUNC=TXTAPP;            /*                               */
         MVC   DATEFUNC(3),@CC01430                                0433
*       CALL FPTCNV(IOPAPPD,IOPAPPT);/*                              */
         LA    @14,IOPAPPD(,IOPPTR)                                0434
         ST    @14,@AL00001                                        0434
         LA    @14,IOPAPPT(,IOPPTR)                                0434
         ST    @14,@AL00001+4                                      0434
         LA    @01,@AL00001                                        0434
         BAL   @14,FPTCNV                                          0434
*       IF RTNCODE=ZERO             /*                               */
*           &LISTSCDS=OFF           /* ONLY IF NOT SCDS              */
*         THEN                      /*                               */
         LTR   RTNCODE,RTNCODE                                     0435
         BNZ   @RF00435                                            0435
         L     @14,@PC00001                                        0435
         TM    LISTSCDS(@14),B'00010000'                           0435
         BNZ   @RF00435                                            0435
*         DO;                       /*                               */
*           DATEFUNC=TXTRES;        /*                               */
         MVC   DATEFUNC(3),@CC01432                                0437
*           CALL FPTCNV(IOPRSTD,IOPRSTT);/*                          */
         LA    @14,IOPRSTD(,IOPPTR)                                0438
         ST    @14,@AL00001                                        0438
         LA    @14,IOPRSTT(,IOPPTR)                                0438
         ST    @14,@AL00001+4                                      0438
         LA    @01,@AL00001                                        0438
         BAL   @14,FPTCNV                                          0438
*           IF RTNCODE=ZERO         /*                               */
*             THEN                  /*                               */
         LTR   RTNCODE,RTNCODE                                     0439
         BNZ   @RF00439                                            0439
*             DO;                   /*                               */
*               DATEFUNC=TXTACC;    /*                               */
         MVC   DATEFUNC(3),@CC01434                                0441
*               CALL FPTCNV(IOPACCD,IOPACCT);/*                      */
         LA    @14,IOPACCD(,IOPPTR)                                0442
         ST    @14,@AL00001                                        0442
         LA    @14,IOPACCT(,IOPPTR)                                0442
         ST    @14,@AL00001+4                                      0442
         LA    @01,@AL00001                                        0442
         BAL   @14,FPTCNV                                          0442
*               IF RTNCODE=ZERO     /*                               */
*                 THEN              /*                               */
         LTR   RTNCODE,RTNCODE                                     0443
         BNZ   @RF00443                                            0443
*                 DO;               /*                               */
*                   DATEFUNC=TXTUCL;/*                               */
         MVC   DATEFUNC(3),@CC01471                                0445
*                   CALL FPTCNV(IOPUCLD,IOPUCLT);/*                  */
         LA    @14,IOPUCLD(,IOPPTR)                                0446
         ST    @14,@AL00001                                        0446
         LA    @14,IOPUCLT(,IOPPTR)                                0446
         ST    @14,@AL00001+4                                      0446
         LA    @01,@AL00001                                        0446
         BAL   @14,FPTCNV                                          0446
*                 END;              /*                               */
*             END;                  /*                               */
@RF00443 DS    0H                                                  0449
*         END;                      /*                               */
@RF00439 DS    0H                                                  0450
*     END;                          /*                               */
@RF00435 DS    0H                                                  0451
*   RETURN CODE(RTNCODE);           /*                               */
@RF00431 L     @14,@SA00009                                        0451
         LM    @00,@12,@SA00009+8                                  0451
         BR    @14                                                 0451
*   RFY                                                            0452
*     RTNCODE UNRSTD;               /*                               */
*   END FPTDATE;                    /*                               */
         EJECT
*                                                                  0454
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO CONVERT AND PRINT DATE AND TIME                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0454
*FPTCNV:                            /*                               */
*   PROCEDURE(CNVDATE,CNVTIME);     /*                               */
FPTCNV   STM   @14,@12,@SA00010                                    0454
         MVC   @PC00010(8),0(@01)                                  0454
*   DECLARE                         /*                               */
*     CNVDATE CHAR(3),              /*                               */
*     CNVTIME CHAR(3);              /*                               */
*   DECLARE                         /*                               */
*     NULL CHAR(3) INIT('000000'X); /*                               */
*   DECLARE                         /*                               */
*     1 DATEWORK CHAR(5),           /* TO UNPACK DATE                */
*       3 YEAR CHAR(2),             /*                               */
*       3 DAY CHAR(3);              /*                               */
*   DECLARE                         /*                               */
*     1 TIMEWORK CHAR(8) BDY(DWORD),/* TO UNPACK TIME                */
*       3 * CHAR(4),                /*                               */
*       3 TIME CHAR(3),             /*                               */
*       3 * CHAR(1);                /*                               */
*   DECLARE                         /*                               */
*     1 SEBCHMS CHAR(8),            /*                               */
*       3 * CHAR(1),                /*                               */
*       3 SEBCHH CHAR(2),           /*                               */
*       3 SEBCMM CHAR(2),           /*                               */
*       3 SEBCSS CHAR(2),           /*                               */
*       3 * CHAR(1);                /*                               */
*   IF CNVDATE^=NULL                /*                               */
*     THEN                          /*                               */
         L     @08,@PC00010                                        0460
         CLC   CNVDATE(3,@08),NULL                                 0460
         BE    @RF00460                                            0460
*     DO;                           /*                               */
*       UNPK(DATEWORK(1:5),CNVDATE(1:3));/*                          */
         UNPK  DATEWORK(5),CNVDATE(3,@08)                          0462
*       HDYEAR=YEAR;                /*                               */
         MVC   HDYEAR(2),YEAR                                      0463
*       HDPER1=PERIOD;              /*                               */
         MVI   HDPER1,C'.'                                         0464
*       HDDAY=DAY;                  /*                               */
         MVC   HDDAY(3),DAY                                        0465
*       HDDAY(3)=HDDAY(3)×HEX0;     /*                               */
         OI    HDDAY+2,X'F0'                                       0466
*       TIME=CNVTIME;               /*                               */
         L     @08,@PC00010+4                                      0467
         MVC   TIME(3),CNVTIME(@08)                                0467
*       UNPK(SEBCHMS,TIMEWORK);     /*                               */
         UNPK  SEBCHMS(8),TIMEWORK(8)                              0468
*       HDHH=SEBCHH;                /*                               */
         MVC   HDHH(2),SEBCHH                                      0469
*       HDCLN1=TXTCOLON;            /*                               */
         MVI   HDCLN1,C':'                                         0470
*       HDMM=SEBCMM;                /*                               */
         MVC   HDMM(2),SEBCMM                                      0471
*       HDCLN2=TXTCOLON;            /*                               */
         MVI   HDCLN2,C':'                                         0472
*       HDSS=SEBCSS;                /*                               */
         MVC   HDSS(2),SEBCSS                                      0473
*       HDSEPCHR=TXTEQ;             /*                               */
         MVI   HDSEPCHR,C'='                                       0474
*       CALL FPTWRITE;              /*                               */
         BAL   @14,FPTWRITE                                        0475
*       RFY                                                        0476
*         RTNCODE RSTD;             /*                               */
*     END;                          /*                               */
*   ELSE                            /*                               */
*     RTNCODE=ZERO;                 /*                               */
         B     @RC00460                                            0478
@RF00460 SLR   RTNCODE,RTNCODE                                     0478
*   RETURN CODE(RTNCODE);           /*                               */
@RC00460 L     @14,@SA00010                                        0479
         LM    @00,@12,@SA00010+8                                  0479
         BR    @14                                                 0479
*   RFY                                                            0480
*     RTNCODE UNRSTD;               /*                               */
*   END FPTCNV;                     /*                               */
         EJECT
*                                                                  0482
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT LRF DSNAME PREFIX IF SMPPTS DATASET                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0482
*FPTDSPFX:                          /*                               */
*   PROCEDURE;                      /*                               */
FPTDSPFX STM   @14,@12,@SA00011                                    0482
*   RFY                                                            0483
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   IF IOPLRFP=ON                   /* IF RELFILES PRESENT           */
*     THEN                          /*                               */
         TM    IOPLRFP(IOPPTR),B'00000001'                         0484
         BNO   @RF00484                                            0484
*     DO;                           /*                               */
*       HDSUBHD=TXTDSPFX;           /*                               */
         MVC   HDSUBHD(15),@CC01475                                0486
*       HDSEPCHR=TXTEQ;             /*                               */
         MVI   HDSEPCHR,C'='                                       0487
*       HDDSPFX=IOPPTPFX;           /*                               */
         MVC   HDDSPFX(26),IOPPTPFX(IOPPTR)                        0488
*       CALL FPTWRITE;              /*                               */
         BAL   @14,FPTWRITE                                        0489
*       RFY                                                        0490
*         RTNCODE RSTD;             /*                               */
*     END;                          /*                               */
*   ELSE                            /*                               */
*     RTNCODE=ZERO;                 /*                               */
         B     @RC00484                                            0492
@RF00484 SLR   RTNCODE,RTNCODE                                     0492
*   RETURN CODE(RTNCODE);           /*                               */
@RC00484 L     @14,@SA00011                                        0493
         LM    @00,@12,@SA00011+8                                  0493
         BR    @14                                                 0493
*   RFY                                                            0494
*     RTNCODE UNRSTD;               /*                               */
*   END FPTDSPFX;                   /*                               */
         EJECT
*                                                                  0496
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT LAST SUPING LINE                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0496
*FPTLSUP:                           /*                               */
*   PROCEDURE;                      /*                               */
FPTLSUP  STM   @14,@12,@SA00012                                    0496
*   RFY                                                            0497
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   IF IOPSBYP=ON                   /* IF SUPING PRESENT             */
*       &IOPSBYNO(1)^=ZERO          /* AND LAST SUP AVAIL            */
*       &IOPSBYNO(1)^=BLANK         /*                               */
*     THEN                          /*                               */
         TM    IOPSBYP(IOPPTR),B'10000000'                         0498
         BNO   @RF00498                                            0498
         CLI   IOPSBYNO(IOPPTR),0                                  0498
         BE    @RF00498                                            0498
         CLI   IOPSBYNO(IOPPTR),C' '                               0498
         BE    @RF00498                                            0498
*     DO;                           /*                               */
*       HDSUBHD=TXTLSUP;            /*                               */
         MVC   HDSUBHD(15),@CC01480                                0500
*       HDSEPCHR=TXTEQ;             /*                               */
         MVI   HDSEPCHR,C'='                                       0501
*       HDLSUP=IOPSBYNO;            /*                               */
         MVC   HDLSUP(7),IOPSBYNO(IOPPTR)                          0502
*       CALL FPTWRITE;              /*                               */
         BAL   @14,FPTWRITE                                        0503
*       RFY                                                        0504
*         RTNCODE RSTD;             /*                               */
*     END;                          /*                               */
*   ELSE                            /*                               */
*     RTNCODE=ZERO;                 /*                               */
         B     @RC00498                                            0506
@RF00498 SLR   RTNCODE,RTNCODE                                     0506
*   RETURN CODE(RTNCODE);           /*                               */
@RC00498 L     @14,@SA00012                                        0507
         LM    @00,@12,@SA00012+8                                  0507
         BR    @14                                                 0507
*   RFY                                                            0508
*     RTNCODE UNRSTD;               /*                               */
*   END FPTLSUP;                    /*                               */
         EJECT
*                                                                  0510
*   /*****************************************************************/
*   /*                                                               */
*   /* FPRMAT DELBY LINE                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0510
*FPTDELBY:                          /*                               */
*   PROCEDURE;                      /*                               */
FPTDELBY STM   @14,@12,@SA00013                                    0510
*   RFY                                                            0511
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   IF IOPDBYP=ON                   /* IF DELBY PRESENT              */
*     THEN                          /*                               */
         TM    IOPDBYP(IOPPTR),B'01000000'                         0512
         BNO   @RF00512                                            0512
*     DO;                           /*                               */
*       HDSUBHD=TXTDELBY;           /*                               */
         MVC   HDSUBHD(15),@CC01485                                0514
*       HDSEPCHR=TXTEQ;             /*                               */
         MVI   HDSEPCHR,C'='                                       0515
*       HDDELBY=IOPDBYNO;           /*                               */
         MVC   HDDELBY(7),IOPDBYNO(IOPPTR)                         0516
*       CALL FPTWRITE;              /*                               */
         BAL   @14,FPTWRITE                                        0517
*       RFY                                                        0518
*         RTNCODE RSTD;             /*                               */
*     END;                          /*                               */
*   ELSE                            /*                               */
*     RTNCODE=ZERO;                 /* INIT RC                       */
         B     @RC00512                                            0520
@RF00512 SLR   RTNCODE,RTNCODE                                     0520
*   RETURN CODE(RTNCODE);           /*                               */
@RC00512 L     @14,@SA00013                                        0521
         LM    @00,@12,@SA00013+8                                  0521
         BR    @14                                                 0521
*   RFY                                                            0522
*     RTNCODE UNRSTD;               /*                               */
*   END FPTDELBY;                   /*                               */
         EJECT
*                                                                  0524
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN THROUGH THE SYSMOD ENTRY AND FORMAT OUTPUT LINE FOR ALL  */
*   /* DATA ASSOCIATED WITH THE ++VER CARDS                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0524
*FPTVER:                            /*                               */
*   PROCEDURE;                      /*                               */
FPTVER   STM   @14,@12,@SA00014                                    0524
*   DECLARE                         /*                               */
*     VERRC FIXED(8);               /* RETURN CODE                   */
*   DECLARE                         /*                               */
*     VERX FIXED(31),               /* VER NUMBER INDEX              */
*     VERY FIXED(31),               /* LOOP INDEX                    */
*     VERZ FIXED(31),               /* LOOP INDEX                    */
*     VERXMIN FIXED(8),             /*                               */
*     VERXMAX FIXED(8);             /*                               */
*   DECLARE                         /*                               */
*     1 CVDWORK,                    /*                               */
*       3 * CHAR(6),                /*                               */
*       3 CVDWORK2 CHAR(2);         /*                               */
*   DECLARE                         /*                               */
*     TMPVER CHAR(3);               /*                               */
*   DECLARE                         /*                               */
*     VERSMD FIXED(31);             /* INDEX THRU SMDARRAYS          */
*   RFY                                                            0530
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   VERXMAX=ZERO;                   /* INIT MAX NUMBER OF VER        */
         SLR   VERXMAX,VERXMAX                                     0531
*   VERXMIN=255;                    /* INIT MIN NUMBER OF VER        */
         LA    VERXMIN,255                                         0532
*   VERRC=ZERO;                     /*                               */
*                                                                  0533
         SLR   VERRC,VERRC                                         0533
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND MIN AND MAX VALUE FOR ++VER DATA                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0534
*   DO VERZ=1 BY 1 WHILE(IOPPTFND(VERZ)^=IOPEOLST);/* LOOP THRU      */
         LA    VERZ,1                                              0534
         B     @DE00534                                            0534
@DL00534 DS    0H                                                  0535
*     RFY                                                          0535
*       FVPARRAY BASED(ADDR(SMDARRY4));/* BASE FOR TABLE             */
*     STOP=OFF;                     /* SUBENTRIES                    */
         NI    STOP,B'01111111'                                    0536
*     DO VERY=1 BY 1 WHILE(         /* LOOP THRU ++VER SUBENT TBL    */
*           FVPATYPE(VERY)^=IOPEOLST/* UNTIL TYPE FOUND              */
*           &STOP=OFF);             /*                               */
         LA    VERY,1                                              0537
         B     @DE00537                                            0537
@DL00537 DS    0H                                                  0538
*       IF IOPPIND(VERZ)=FVPATYPE(VERY)/* IF MATCH                   */
*         THEN                      /*                               */
         LR    @08,VERZ                                            0538
         MH    @08,@CH00490                                        0538
         LR    @07,VERY                                            0538
         MH    @07,@CH00503                                        0538
         LA    @15,SMDARRY4                                        0538
         SLR   @14,@14                                             0538
         IC    @14,IOPPIND-9(@08,IOPPTR)                           0538
         AL    @15,@CF01913                                        0538
         SLR   @01,@01                                             0538
         IC    @01,FVPATYPE(@07,@15)                               0538
         CR    @14,@01                                             0538
         BNE   @RF00538                                            0538
*         DO;                       /*                               */
*           STOP=ON;                /* STOP INNER LOOP               */
         OI    STOP,B'10000000'                                    0540
*           VERXMIN=MIN(VERXMIN,IOPENTST(VERZ));/* GET FIRST VER     */
         SLR   @07,@07                                             0541
         IC    @07,IOPENTST-9(@08,IOPPTR)                          0541
         CR    VERXMIN,@07                                         0541
         BNH   *+6
         LR    VERXMIN,@07                                         0541
*           VERXMAX=MAX(VERXMAX,IOPENTST(VERZ));/* GET LAST VER      */
         CR    VERXMAX,@07                                         0542
         BNL   *+6
         LR    VERXMAX,@07                                         0542
*         END;                      /*                               */
*     END;                          /*                               */
@RF00538 AH    VERY,@CH00044                                       0544
@DE00537 LR    @08,VERY                                            0544
         MH    @08,@CH00503                                        0544
         LA    @07,SMDARRY4                                        0544
         AL    @07,@CF01913                                        0544
         SLR   @15,@15                                             0544
         IC    @15,FVPATYPE(@08,@07)                               0544
         CH    @15,@CH00679                                        0544
         BE    @DC00537                                            0544
         TM    STOP,B'10000000'                                    0544
         BZ    @DL00537                                            0544
@DC00537 DS    0H                                                  0545
*   END;                            /*                               */
*                                                                  0545
         AH    VERZ,@CH00044                                       0545
@DE00534 LR    @08,VERZ                                            0545
         MH    @08,@CH00490                                        0545
         SLR   @07,@07                                             0545
         IC    @07,IOPPTFND-9(@08,IOPPTR)                          0545
         CH    @07,@CH00679                                        0545
         BNE   @DL00534                                            0545
*   /*****************************************************************/
*   /*                                                               */
*   /* NO LIST ALL VER DATA                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0546
*   DO VERX=VERXMIN TO VERXMAX WHILE/* MAX NUMBER OF ++VER           */
*         VERRC=ZERO;               /* OR ERR IN WRITE               */
         LR    VERX,VERXMIN                                        0546
         B     @DE00546                                            0546
@DL00546 CH    VERRC,@CH00308                                      0546
         BNE   @DC00546                                            0546
*     CVD(VERX,CVDWORK);            /* CONVERT VER NUMBER            */
         CVD   VERX,CVDWORK                                        0547
*     UNPK(TMPVER,CVDWORK2);        /* UNPACK VER NUMBER             */
         UNPK  TMPVER(3),CVDWORK2(2)                               0548
*     TMPVER(3)=TMPVER(3)×HEX0;     /*                               */
         OI    TMPVER+2,X'F0'                                      0549
*     RFY                                                          0550
*       FVPARRAY BASED(ADDR(SMDARRY4));/* VER ARRAY                  */
*     DO VERSMD=1 BY 1 WHILE(       /* LOOP THRU VER SMDARRAY        */
*           FVPATYPE(VERSMD)^=IOPEOLST);/* TILL END                  */
         LA    VERSMD,1                                            0551
         B     @DE00551                                            0551
@DL00551 DS    0H                                                  0552
*       IF FVPAVER(VERSMD)='VER'    /* IF LOCATION IS VER NUMBER     */
*         THEN                      /*                               */
         LR    @08,VERSMD                                          0552
         MH    @08,@CH00503                                        0552
         LA    @07,SMDARRY4                                        0552
         ST    @08,@TF00001                                        0552
         ALR   @08,@07                                             0552
         AL    @08,@CF01915                                        0552
         CLC   FVPAVER-9(3,@08),@CC01891                           0552
         BNE   @RF00552                                            0552
*         FVPAVERN(VERSMD)=TMPVER;  /* MOVE IN VER NUMBER            */
         AL    @07,@TF00001                                        0553
         AL    @07,@CF01916                                        0553
         MVC   FVPAVERN-13(3,@07),TMPVER                           0553
*     END;                          /*                               */
@RF00552 AH    VERSMD,@CH00044                                     0554
@DE00551 LR    @08,VERSMD                                          0554
         MH    @08,@CH00503                                        0554
         LA    @07,SMDARRY4                                        0554
         AL    @08,@CF01913                                        0554
         SLR   @15,@15                                             0554
         IC    @15,FVPATYPE(@08,@07)                               0554
         CH    @15,@CH00679                                        0554
         BNE   @DL00551                                            0554
*     FVPARRAD=ADDR(SMDARRY4);      /* ADDR OF CONTROL ARRAY         */
         ST    @07,FVPARRAD                                        0555
*     FVPVERN=VERX;                 /*                               */
         STC   VERX,FVPVERN                                        0556
*     CALL HMASMFVL(HMASMFVP);      /* FORMAT COMMENT ENTRIES        */
         L     @15,@CV01312                                        0557
         LA    @01,@AL00557                                        0557
         BALR  @14,@15                                             0557
*     RFY                                                          0558
*       RTNCODE RSTD;               /*                               */
*     VERRC=MAX(VERRC,RTNCODE);     /*                               */
         CR    VERRC,RTNCODE                                       0559
         BNL   *+6
         LR    VERRC,RTNCODE                                       0559
*     RFY                                                          0560
*       RTNCODE UNRSTD;             /*                               */
*   END;                            /* END VER LOOP                  */
         AH    VERX,@CH00044                                       0561
@DE00546 CR    VERX,VERXMAX                                        0561
         BNH   @DL00546                                            0561
@DC00546 DS    0H                                                  0562
*   FVPVERN=ZERO;                   /* RESET TO ZERO                 */
         MVI   FVPVERN,X'00'                                       0562
*   RETURN CODE(VERRC);             /*                               */
         LR    @15,VERRC                                           0563
         L     @14,@SA00014                                        0563
         LM    @00,@12,@SA00014+8                                  0563
         BR    @14                                                 0563
*   END FPTVER;                     /*                               */
         EJECT
*                                                                  0565
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT PRINT SUBROUTINE - PRINTS THE FORMATTED OUTPUT         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0565
*FPTWRITE:                                                         0565
*   PROCEDURE;                                                     0565
FPTWRITE STM   @14,@12,@SA00015                                    0565
*   RFY                                                            0566
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   DECLARE                                                        0567
*     WTRBUFSV PTR(31),             /* SAVE AREA FOR IOPBUFAD        */
*     WTRDSID FIXED(8),             /*                               */
*     WTRFUNCT FIXED(8);            /*                               */
*   WTRBUFSV=IOPBUFAD;              /* SAVE THE BUFFER ADDRESS       */
         L     WTRBUFSV,IOPBUFAD(,IOPPTR)                          0568
*   WTRDSID=IOPDSID;                /*                               */
         SLR   WTRDSID,WTRDSID                                     0569
         IC    WTRDSID,IOPDSID(,IOPPTR)                            0569
*   WTRFUNCT=IOPFUNCT;              /*                               */
         SLR   WTRFUNCT,WTRFUNCT                                   0570
         IC    WTRFUNCT,IOPFUNCT(,IOPPTR)                          0570
*   IOPBUFAD=ADDR(OUTAREA);         /* AIM THE IOP BUFFER AT THE   0571
*                                      INTERNAL AREA                 */
         LA    @08,OUTAREA                                         0571
         ST    @08,IOPBUFAD(,IOPPTR)                               0571
*   PRLRLEN=LENGTH(PRNTBUF);        /* INSERT RECORD LENGTH          */
         MVC   PRLRLEN(2,@08),@CH01339                             0572
*   PRLHEAD=OFF;                    /* THIS IS NOT A HEADING         */
*   PRLHEADO=OFF;                   /* DITTO                         */
*   PRLBLANK=OFF;                   /* THIS LINE IS NOT BLANK        */
         NI    PRLHEAD(@08),B'00011111'                            0575
*   IOPDSID=CCALSTDS;               /* SEND TO THE PRINTER           */
         MVC   IOPDSID(1,IOPPTR),CCALSTDS(CCAPTR)                  0576
*   IOPFUNCT=IOPWRITE;              /* AND WRITE IT                  */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0577
*   CALL HMASMIO(HMASMIOP);         /* CALL THE I/O ROUTINE          */
         ST    IOPPTR,@AL00001                                     0578
         L     @15,@CV01313                                        0578
         LA    @01,@AL00001                                        0578
         BALR  @14,@15                                             0578
*   PRNTBUF(1:LENGTH(PRNTBUF))=BLANK;/* THEN CLEAR THE AREA          */
         MVI   PRNTBUF+1,C' '                                      0579
         MVC   PRNTBUF+2(118),PRNTBUF+1                            0579
         MVI   PRNTBUF,C' '                                        0579
*   IOPBUFAD=WTRBUFSV;              /* RESTORE BUFFER ADDRESS        */
         ST    WTRBUFSV,IOPBUFAD(,IOPPTR)                          0580
*   IOPDSID=WTRDSID;                /*                               */
         STC   WTRDSID,IOPDSID(,IOPPTR)                            0581
*   IOPFUNCT=WTRFUNCT;              /*                               */
         STC   WTRFUNCT,IOPFUNCT(,IOPPTR)                          0582
*   RETURN CODE(IOPRETRN);          /*                               */
         SLR   @15,@15                                             0583
         IC    @15,IOPRETRN(,IOPPTR)                               0583
         L     @14,@SA00015                                        0583
         LM    @00,@12,@SA00015+8                                  0583
         BR    @14                                                 0583
*   END FPTWRITE;                   /* RETURN TO CALLER              */
*   END HMASMFPT                                                   0585
*                                                                  0585
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */
*                                                                  0585
*       ;                                                          0585
@DATA    DS    0H
@CH00308 DC    H'0'
@CH00044 DC    H'1'
@CH00069 DC    H'5'
@CH00490 DC    H'9'
@CH00036 DC    H'10'
@CH00503 DC    H'17'
@CH01339 DC    H'120'
@CH01123 DC    H'170'
@CH00679 DC    H'255'
         DS    0F
@AL00211 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00220 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00225 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00232 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00237 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00557 DC    A(HMASMFVP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00004 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00009 DS    15F
@SA00011 DS    15F
@SA00012 DS    15F
@SA00013 DS    15F
@SA00010 DS    15F
@PC00010 DS    2F
@SA00015 DS    0F
@SA00014 DS    0F
@SA00002 DS    0F
         DS    15F
@AL00001 DS    2A
@TF00001 DS    F
         DS    0F
@CF01913 DC    F'-17'
@CF01915 DC    F'-8'
@CF01916 DC    F'-4'
@CV01311 DC    V(HMASMFXF)
@CV01312 DC    V(HMASMFVL)
@CV01313 DC    V(HMASMIO)
         DS    0D
@CC01388 DC    C'LAST UPDATE    '
@CC01404 DC    C'TYPE           '
@CC01423 DC    C'STATUS         '
@CC01442 DC    C'JCLIN          '
@CC01451 DC    C'FMID           '
@CC01475 DC    C'DSPREFIX       '
@CC01480 DC    C'LASTSUP        '
@CC01485 DC    C'DELBY          '
@CC01407 DC    C'SUPERSEDED'
@CC01412 DC    C'FUNCTION'
@CC01410 DC    C'DELETED'
@CC01418 DC    C'USERMOD'
@CC01416 DC    C'APAR'
@CC01391 DC    C'ADD'
@CC01393 EQU   @CC01485
@CC01395 DC    C'UPD'
@CC01414 DC    C'PTF'
@CC01426 DC    C'BYP'
@CC01428 DC    C'REC'
@CC01430 DC    C'APP'
@CC01432 DC    C'RES'
@CC01434 DC    C'ACC'
@CC01436 DC    C'RGN'
@CC01438 DC    C'ERR'
@CC01445 DC    C'YES'
@CC01471 DC    C'UCL'
@CC01891 DC    C'VER'
         DS    CL1
HMASMFVP DS    CL15
         ORG   HMASMFVP
FVPARRAD DS    AL4
FVPLSTAD DS    AL4
FVPLNLEN DS    FL2
FVPOFFST DS    FL2
FVPVERN  DS    FL1
FVPDSID  DS    FL1
FVPRETRN DS    FL1
         ORG   HMASMFVP+15
MAINHD1  DS    CL121
         ORG   MAINHD1
@NM00185 DC    CL1' '
HDH1DSID DC    CL8'XXXXXXXX'
@NM00186 DC    CL1' '
HDH1OPT  DC    CL25' '
@NM00187 DC    CL1' '
HDH1SMD  DC    CL7' '
@NM00188 DC    78CL1' '
         ORG   MAINHD1+121
MAINHD2  DS    CL121
         ORG   MAINHD2
@NM00189 DC    CL1' '
@NM00190 DC    CL8'  NAME  '
@NM00191 DC    112CL1' '
         ORG   MAINHD2+121
@NM00182 DS    BL1
         ORG   @NM00182
STOP     DS    BL1
SUPONLY  EQU   @NM00182+0
@NM00183 EQU   @NM00182+0
         ORG   @NM00182+1
PATCHFPT DS    CL80
         ORG   PATCHFPT
@NM00184 DC    80X'FF'
         ORG   PATCHFPT+80
         DS    CL2
OUTAREA  DS    CL130
         ORG   OUTAREA
PRNTPRLG DS    CL10
PRNTBUF  DC    CL120' '
         ORG   OUTAREA+130
TXTCDS   DC    CL8'SMPCDS  '
TXTACDS  DC    CL8'SMPACDS '
TXTPTS   DC    CL8'SMPPTS  '
TXTSCDS  DC    CL8'SMPSCDS '
TXTXXXHD DC    CL25'SYSMOD ENTRIES           '
TXTSCDHD DC    CL25'BACKUP ENTRIES FOR SYSMOD'
LUPDLINE DS    CL17
         ORG   LUPDLINE
HDUPDSMD DS    CL7
@NM00195 DC    CL2'  '
@NM00196 DC    CL5'TYPE='
HDUPDTYP DS    CL3
         ORG   LUPDLINE+17
TXTDTTM  DC    CL15'DATE/TIME FNC  '
SMDARRY1 DS    CL18
         ORG   SMDARRY1
@NM00201 DS    CL17
         ORG   @NM00201
@NM00202 DC    AL1(170)
@NM00203 DC    AL1(7)
@NM00204 DC    CL15'SUPBY(IN SYSMD)'
         ORG   SMDARRY1+17
@NM00205 DS    CL1
         ORG   @NM00205
@NM00206 DC    AL1(255)
         ORG   SMDARRY1+18
SMDARRY2 DS    CL18
         ORG   SMDARRY2
@NM00207 DS    CL17
         ORG   @NM00207
@NM00208 DC    AL1(42)
@NM00209 DC    AL1(8)
@NM00210 DC    CL15'COMMENTS       '
         ORG   SMDARRY2+17
@NM00211 DS    CL1
         ORG   @NM00211
@NM00212 DC    AL1(255)
         ORG   SMDARRY2+18
SMDARRY3 DS    CL35
         ORG   SMDARRY3
@NM00213 DS    CL17
         ORG   @NM00213
@NM00214 DC    AL1(40)
@NM00215 DC    AL1(8)
@NM00216 DC    CL15'APPLY CDSID    '
         ORG   SMDARRY3+17
@NM00217 DS    CL17
         ORG   @NM00217
@NM00218 DC    AL1(41)
@NM00219 DC    AL1(8)
@NM00220 DC    CL15'ACCEPT ACDSID  '
         ORG   SMDARRY3+34
@NM00221 DS    CL1
         ORG   @NM00221
@NM00222 DC    AL1(255)
         ORG   SMDARRY3+35
SMDARRY4 DS    CL137
         ORG   SMDARRY4
@NM00223 DS    CL17
         ORG   @NM00223
@NM00224 DC    AL1(161)
@NM00225 DC    AL1(4)
@NM00226 DC    CL15'SREL   VER(XXX)'
         ORG   SMDARRY4+17
@NM00227 DS    CL17
         ORG   @NM00227
@NM00228 DC    AL1(168)
@NM00229 DC    AL1(7)
@NM00230 DC    CL15'DELETE VER(XXX)'
         ORG   SMDARRY4+34
@NM00231 DS    CL17
         ORG   @NM00231
@NM00232 DC    AL1(167)
@NM00233 DC    AL1(7)
@NM00234 DC    CL15'FMID   VER(XXX)'
         ORG   SMDARRY4+51
@NM00235 DS    CL17
         ORG   @NM00235
@NM00236 DC    AL1(163)
@NM00237 DC    AL1(7)
@NM00238 DC    CL15'NPRE   VER(XXX)'
         ORG   SMDARRY4+68
@NM00239 DS    CL17
         ORG   @NM00239
@NM00240 DC    AL1(162)
@NM00241 DC    AL1(7)
@NM00242 DC    CL15'PRE    VER(XXX)'
         ORG   SMDARRY4+85
@NM00243 DS    CL17
         ORG   @NM00243
@NM00244 DC    AL1(165)
@NM00245 DC    AL1(7)
@NM00246 DC    CL15'REQ    VER(XXX)'
         ORG   SMDARRY4+102
@NM00247 DS    CL17
         ORG   @NM00247
@NM00248 DC    AL1(164)
@NM00249 DC    AL1(7)
@NM00250 DC    CL15'SUP    VER(XXX)'
         ORG   SMDARRY4+119
@NM00251 DS    CL17
         ORG   @NM00251
@NM00252 DC    AL1(169)
@NM00253 DC    AL1(7)
@NM00254 DC    CL15'VERS   VER(XXX)'
         ORG   SMDARRY4+136
@NM00255 DS    CL1
         ORG   @NM00255
@NM00256 DC    AL1(255)
         ORG   SMDARRY4+137
SMDARRY5 DS    CL273
         ORG   SMDARRY5
@NM00257 DS    CL17
         ORG   @NM00257
@NM00258 DC    AL1(166)
@NM00259 DC    AL1(7)
@NM00260 DC    CL15'IFREQ          '
         ORG   SMDARRY5+17
@NM00261 DS    CL17
         ORG   @NM00261
@NM00262 DC    AL1(8)
@NM00263 DC    AL1(8)
@NM00264 DC    CL15'ASSEM          '
         ORG   SMDARRY5+34
@NM00265 DS    CL17
         ORG   @NM00265
@NM00266 DC    AL1(4)
@NM00267 DC    AL1(8)
@NM00268 DC    CL15'MAC            '
         ORG   SMDARRY5+51
@NM00269 DS    CL17
         ORG   @NM00269
@NM00270 DC    AL1(5)
@NM00271 DC    AL1(8)
@NM00272 DC    CL15'MACUPD         '
         ORG   SMDARRY5+68
@NM00273 DS    CL17
         ORG   @NM00273
@NM00274 DC    AL1(1)
@NM00275 DC    AL1(8)
@NM00276 DC    CL15'MOD            '
         ORG   SMDARRY5+85
@NM00277 DS    CL17
         ORG   @NM00277
@NM00278 DC    AL1(6)
@NM00279 DC    AL1(8)
@NM00280 DC    CL15'SRC            '
         ORG   SMDARRY5+102
@NM00281 DS    CL17
         ORG   @NM00281
@NM00282 DC    AL1(7)
@NM00283 DC    AL1(8)
@NM00284 DC    CL15'SRCUPD         '
         ORG   SMDARRY5+119
@NM00285 DS    CL17
         ORG   @NM00285
@NM00286 DC    AL1(2)
@NM00287 DC    AL1(8)
@NM00288 DC    CL15'SZAP           '
         ORG   SMDARRY5+136
@NM00289 DS    CL17
         ORG   @NM00289
@NM00290 DC    AL1(3)
@NM00291 DC    AL1(8)
@NM00292 DC    CL15'XZAP           '
         ORG   SMDARRY5+153
@NM00293 DS    CL17
         ORG   @NM00293
@NM00294 DC    AL1(84)
@NM00295 DC    AL1(8)
@NM00296 DC    CL15'RMAC           '
         ORG   SMDARRY5+170
@NM00297 DS    CL17
         ORG   @NM00297
@NM00298 DC    AL1(85)
@NM00299 DC    AL1(8)
@NM00300 DC    CL15'RMACUPD        '
         ORG   SMDARRY5+187
@NM00301 DS    CL17
         ORG   @NM00301
@NM00302 DC    AL1(81)
@NM00303 DC    AL1(8)
@NM00304 DC    CL15'RMOD           '
         ORG   SMDARRY5+204
@NM00305 DS    CL17
         ORG   @NM00305
@NM00306 DC    AL1(86)
@NM00307 DC    AL1(8)
@NM00308 DC    CL15'RSRC           '
         ORG   SMDARRY5+221
@NM00309 DS    CL17
         ORG   @NM00309
@NM00310 DC    AL1(87)
@NM00311 DC    AL1(8)
@NM00312 DC    CL15'RSRCUPD        '
         ORG   SMDARRY5+238
@NM00313 DS    CL17
         ORG   @NM00313
@NM00314 DC    AL1(82)
@NM00315 DC    AL1(8)
@NM00316 DC    CL15'RSZAP          '
         ORG   SMDARRY5+255
@NM00317 DS    CL17
         ORG   @NM00317
@NM00318 DC    AL1(83)
@NM00319 DC    AL1(8)
@NM00320 DC    CL15'RXZAP          '
         ORG   SMDARRY5+272
@NM00321 DS    CL1
         ORG   @NM00321
@NM00322 DC    AL1(255)
         ORG   SMDARRY5+273
SMDARRY6 DS    CL307
         ORG   SMDARRY6
@NM00323 DS    CL17
         ORG   @NM00323
@NM00324 DC    AL1(54)
@NM00325 DC    AL1(8)
@NM00326 DC    CL15'ASSEM  (ADD   )'
         ORG   SMDARRY6+17
@NM00327 DS    CL17
         ORG   @NM00327
@NM00328 DC    AL1(55)
@NM00329 DC    AL1(8)
@NM00330 DC    CL15'LMOD   (ADD   )'
         ORG   SMDARRY6+34
@NM00331 DS    CL17
         ORG   @NM00331
@NM00332 DC    AL1(56)
@NM00333 DC    AL1(8)
@NM00334 DC    CL15'MACRO  (ADD   )'
         ORG   SMDARRY6+51
@NM00335 DS    CL17
         ORG   @NM00335
@NM00336 DC    AL1(57)
@NM00337 DC    AL1(8)
@NM00338 DC    CL15'MOD    (ADD   )'
         ORG   SMDARRY6+68
@NM00339 DS    CL17
         ORG   @NM00339
@NM00340 DC    AL1(58)
@NM00341 DC    AL1(8)
@NM00342 DC    CL15'SRC    (ADD   )'
         ORG   SMDARRY6+85
@NM00343 DS    CL17
         ORG   @NM00343
@NM00344 DC    AL1(59)
@NM00345 DC    AL1(8)
@NM00346 DC    CL15'DLIB   (ADD   )'
         ORG   SMDARRY6+102
@NM00347 DS    CL17
         ORG   @NM00347
@NM00348 DC    AL1(60)
@NM00349 DC    AL1(8)
@NM00350 DC    CL15'ASSEM  (DEL   )'
         ORG   SMDARRY6+119
@NM00351 DS    CL17
         ORG   @NM00351
@NM00352 DC    AL1(61)
@NM00353 DC    AL1(8)
@NM00354 DC    CL15'LMOD   (DEL   )'
         ORG   SMDARRY6+136
@NM00355 DS    CL17
         ORG   @NM00355
@NM00356 DC    AL1(62)
@NM00357 DC    AL1(8)
@NM00358 DC    CL15'MACRO  (DEL   )'
         ORG   SMDARRY6+153
@NM00359 DS    CL17
         ORG   @NM00359
@NM00360 DC    AL1(63)
@NM00361 DC    AL1(8)
@NM00362 DC    CL15'MOD    (DEL   )'
         ORG   SMDARRY6+170
@NM00363 DS    CL17
         ORG   @NM00363
@NM00364 DC    AL1(64)
@NM00365 DC    AL1(8)
@NM00366 DC    CL15'SRC    (DEL   )'
         ORG   SMDARRY6+187
@NM00367 DS    CL17
         ORG   @NM00367
@NM00368 DC    AL1(65)
@NM00369 DC    AL1(8)
@NM00370 DC    CL15'DLIB   (DEL   )'
         ORG   SMDARRY6+204
@NM00371 DS    CL17
         ORG   @NM00371
@NM00372 DC    AL1(66)
@NM00373 DC    AL1(8)
@NM00374 DC    CL15'ASSEM  (UPDATE)'
         ORG   SMDARRY6+221
@NM00375 DS    CL17
         ORG   @NM00375
@NM00376 DC    AL1(67)
@NM00377 DC    AL1(8)
@NM00378 DC    CL15'LMOD   (UPDATE)'
         ORG   SMDARRY6+238
@NM00379 DS    CL17
         ORG   @NM00379
@NM00380 DC    AL1(68)
@NM00381 DC    AL1(8)
@NM00382 DC    CL15'MACRO  (UPDATE)'
         ORG   SMDARRY6+255
@NM00383 DS    CL17
         ORG   @NM00383
@NM00384 DC    AL1(69)
@NM00385 DC    AL1(8)
@NM00386 DC    CL15'MOD    (UPDATE)'
         ORG   SMDARRY6+272
@NM00387 DS    CL17
         ORG   @NM00387
@NM00388 DC    AL1(70)
@NM00389 DC    AL1(8)
@NM00390 DC    CL15'SRC    (UPDATE)'
         ORG   SMDARRY6+289
@NM00391 DS    CL17
         ORG   @NM00391
@NM00392 DC    AL1(71)
@NM00393 DC    AL1(8)
@NM00394 DC    CL15'DLIB   (UPDATE '
         ORG   SMDARRY6+306
@NM00395 DS    CL1
         ORG   @NM00395
@NM00396 DC    AL1(255)
         ORG   SMDARRY6+307
NULL     DC    X'000000'
DATEWORK DS    CL5
         ORG   DATEWORK
YEAR     DS    CL2
DAY      DS    CL3
         ORG   DATEWORK+5
TIMEWORK DS    CL8
         ORG   TIMEWORK
@NM00397 DS    CL4
TIME     DS    CL3
@NM00398 DS    CL1
         ORG   TIMEWORK+8
SEBCHMS  DS    CL8
         ORG   SEBCHMS
@NM00399 DS    CL1
SEBCHH   DS    CL2
SEBCMM   DS    CL2
SEBCSS   DS    CL2
@NM00400 DS    CL1
         ORG   SEBCHMS+8
CVDWORK  DS    CL8
         ORG   CVDWORK
@NM00401 DS    CL6
CVDWORK2 DS    CL2
         ORG   CVDWORK+8
TMPVER   DS    CL3
         DS    CL1
HEADPTR  DC    AL4(MAINHD1)
         DC    A(0)
         DC    A(0)
         DC    AL4(MAINHD2)
         DC    A(0)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
WTRFUNCT EQU   @04
WTRDSID  EQU   @03
WTRBUFSV EQU   @02
VERSMD   EQU   @02
VERXMAX  EQU   @05
VERXMIN  EQU   @06
VERZ     EQU   @02
VERY     EQU   @03
VERX     EQU   @03
VERRC    EQU   @04
STATINDX EQU   @02
CHKRC    EQU   @02
CHKX     EQU   @03
SETDSID  EQU   @03
HDINDX   EQU   @02
HEADSAV  EQU   @04
CCAPTR   EQU   @11
IOPPTR   EQU   @09
RTNCODE  EQU   @15
RTNREG   EQU   @14
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCALNLEN EQU   CCAFSYS+22
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00014 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCALSTDS EQU   CCAFCTL+8
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00030 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00032 EQU   CCABLDLL
CCALKDRC EQU   @NM00032+20
@NM00034 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00034+20
@NM00036 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00036+20
@NM00038 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00038+20
@NM00040 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00040+20
@NM00042 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00042+20
@NM00044 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00044+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00048 EQU   HMASMIOP+12
@NM00049 EQU   @NM00048
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00159 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMPRL EQU   0
PRLRLEN  EQU   HMASMPRL
PRLSPAN  EQU   HMASMPRL+2
PRLFLGS  EQU   PRLSPAN
PRLHEAD  EQU   PRLFLGS
PRLHEADO EQU   PRLFLGS
PRLBLANK EQU   PRLFLGS
PRLDATE  EQU   HMASMPRL+4
PRLHDADR EQU   PRLDATE
PRLTIME  EQU   HMASMPRL+7
PRLEND   EQU   HMASMPRL+10
FVPARRAY EQU   0
FVPATYPE EQU   FVPARRAY
FVPAHEAD EQU   FVPARRAY+2
FVPAVER  EQU   FVPAHEAD+7
FVPAVERN EQU   FVPAHEAD+11
FVPLIST  EQU   0
FVPLDATA EQU   FVPLIST
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
LISTPARM EQU   0
LISTPRM1 EQU   LISTPARM
LISTCDS  EQU   LISTPRM1
LISTACDS EQU   LISTPRM1
LISTSCDS EQU   LISTPRM1
LISTPTS  EQU   LISTPRM1
LISTPRM2 EQU   LISTPARM+2
LISTPRM3 EQU   LISTPARM+4
LISTRES  EQU   LISTPRM3
LISTFUNC EQU   LISTPRM3
LISTPTF  EQU   LISTPRM3
LISTAPAR EQU   LISTPRM3
LISTUSER EQU   LISTPRM3
LISTSUP  EQU   LISTPRM3+1
LISTNSUP EQU   LISTPRM3+1
LISTDEL  EQU   LISTPRM3+1
LISTBYP  EQU   LISTPRM3+1
LISTERR  EQU   LISTPRM3+1
LISTPRM4 EQU   LISTPARM+6
LISTXREF EQU   LISTPRM4
LISTDATE EQU   LISTPARM+7
LISTBDAT EQU   LISTDATE
LISTEDAT EQU   LISTDATE+6
PASSIOP  EQU   0
LASTTYPE EQU   0
CNVDATE  EQU   0
CNVTIME  EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00055 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00066 EQU   IOPUDATA
@NM00067 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00076 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPBUSMD EQU   IOPBUNT
IOPBUTYP EQU   IOPBUNT+7
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00087 EQU   IOPSRCDR+1
@NM00089 EQU   @NM00087+7
@NM00093 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00097 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00103 EQU   IOPMODDR+1
@NM00105 EQU   @NM00103+7
@NM00109 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00113 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00124 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00131 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPTYPE EQU   IOPPTFDR+1
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPAPP   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPREGEN EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPJCLP  EQU   IOPPTFF2
IOPLRFP  EQU   IOPPTFF2
IOPPTFF3 EQU   IOPPSTAT+3
IOPSBYP  EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPDBYNO EQU   IOPPTFDR+6
IOPSBYNO EQU   IOPPTFDR+13
IOPPTFFX EQU   IOPPTFNT+24
@NM00140 EQU   IOPPTFFX
@NM00141 EQU   @NM00140
IOPPDTES EQU   IOPPTFFX+41
@NM00144 EQU   IOPPDTES
IOPRECD  EQU   @NM00144
IOPRECT  EQU   @NM00144+3
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPAPPD  EQU   IOPDATES
IOPAPPT  EQU   IOPDATES+3
IOPRSTD  EQU   IOPDATES+6
IOPRSTT  EQU   IOPDATES+9
IOPACCD  EQU   IOPDATES+12
IOPACCT  EQU   IOPDATES+15
IOPUCLD  EQU   IOPDATES+18
IOPUCLT  EQU   IOPDATES+21
IOPPFMID EQU   IOPPTFFX+73
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPPTFND EQU   IOPPMODS
IOPPIND  EQU   IOPPNTRY+8
IOPENTNT EQU   IOPUDATA+104
IOPENTST EQU   IOPENTNT+7
IOPSRLNT EQU   IOPUDATA+104
IOPSRLNM EQU   IOPSRLNT
IOPPRENT EQU   IOPUDATA+104
IOPPRENM EQU   IOPPRENT
IOPNPRNT EQU   IOPUDATA+104
IOPNPRNM EQU   IOPNPRNT
IOPSUPNT EQU   IOPUDATA+104
IOPSUPNM EQU   IOPSUPNT
IOPREQNT EQU   IOPUDATA+104
IOPREQNM EQU   IOPREQNT
IOPIRQNT EQU   IOPUDATA+104
IOPIRQNM EQU   IOPIRQNT
IOPFIDNT EQU   IOPUDATA+104
IOPFIDNM EQU   IOPFIDNT
IOPDELNT EQU   IOPUDATA+104
IOPDELNM EQU   IOPDELNT
IOPVERNT EQU   IOPUDATA+104
IOPVERNM EQU   IOPVERNT
IOPSBYNT EQU   IOPUDATA+104
IOPSBYNM EQU   IOPSBYNT
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00169 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00169
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00173 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00173
IOPBFTB1 EQU   IOPBFTB0
PTOUTMAP EQU   PRNTBUF
HDNAME   EQU   PTOUTMAP
HDSUBHD  EQU   PTOUTMAP+10
HDSEPCHR EQU   PTOUTMAP+26
HDDATA   EQU   PTOUTMAP+28
TYPELINE EQU   HDDATA
HDSUP    EQU   TYPELINE
HDFUNC   EQU   HDSUP
HDDEL    EQU   HDFUNC
HDUSER   EQU   HDDEL
HDAPAR   EQU   HDUSER
HDPTF    EQU   HDAPAR
STATLINE EQU   HDDATA
HDSTAT   EQU   STATLINE
JCLLINE  EQU   HDDATA
HDJCL    EQU   JCLLINE
FMIDLINE EQU   HDDATA
HDFMID   EQU   FMIDLINE
DATELINE EQU   HDDATA
HDYEAR   EQU   DATELINE
HDPER1   EQU   DATELINE+2
HDDAY    EQU   DATELINE+3
HDHH     EQU   DATELINE+8
HDCLN1   EQU   DATELINE+10
HDMM     EQU   DATELINE+11
HDCLN2   EQU   DATELINE+13
HDSS     EQU   DATELINE+14
DTFNSBHD EQU   HDSUBHD
DATEFUNC EQU   DTFNSBHD+10
DSPFLINE EQU   HDDATA
HDDSPFX  EQU   DSPFLINE
LSUPLINE EQU   HDDATA
HDLSUP   EQU   LSUPLINE
DBYLINE  EQU   HDDATA
HDDELBY  EQU   DBYLINE
PRLDATA  EQU   PRLEND
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00200 EQU   DTFNSBHD+13
@NM00199 EQU   DTFNSBHD
@NM00198 EQU   DATELINE+6
@NM00197 EQU   STATLINE+3
@NM00194 EQU   PTOUTMAP+27
@NM00193 EQU   PTOUTMAP+25
@NM00192 EQU   PTOUTMAP+8
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00175 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00174 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00172 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00171 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00170 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00168 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00167 EQU   IOPPTSFX+35
@NM00166 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00165 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00164 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00163 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00162 EQU   IOPQFMDR
@NM00158 EQU   IOPQSMDR
@NM00157 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
@NM00156 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
@NM00155 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
@NM00154 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
@NM00153 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
@NM00152 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
@NM00151 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
@NM00150 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
@NM00149 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
@NM00148 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00147 EQU   IOPSRLNT+4
@NM00146 EQU   IOPENTNT+8
IOPENTNM EQU   IOPENTNT
@NM00145 EQU   IOPPTPFX+24
@NM00143 EQU   IOPPTFFX+8
@NM00142 EQU   @NM00140+7
IOPPRELN EQU   @NM00141
@NM00139 EQU   IOPPTFDR+20
@NM00138 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00137 EQU   IOPPTFF2+1
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
@NM00136 EQU   IOPFLGS5
@NM00135 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00134 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00133 EQU   @NM00131+7
@NM00132 EQU   @NM00131
@NM00130 EQU   IOPSYSDR+5
@NM00129 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00128 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00127 EQU   IOPDLBFX+8
@NM00126 EQU   @NM00124+7
@NM00125 EQU   @NM00124
@NM00123 EQU   IOPDLBDR+1
@NM00122 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00121 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00120 EQU   IOPMODFX+12
@NM00119 EQU   IOPMODF4
@NM00118 EQU   IOPMODF3
@NM00117 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00116 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00115 EQU   @NM00113+7
@NM00114 EQU   @NM00113
@NM00112 EQU   IOPMODDR+17
@NM00111 EQU   @NM00109+7
@NM00110 EQU   @NM00109
@NM00108 EQU   @NM00105
@NM00107 EQU   @NM00105
@NM00106 EQU   @NM00105
@NM00104 EQU   @NM00103
@NM00102 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00101 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00100 EQU   IOPSRCFX+8
@NM00099 EQU   @NM00097+7
@NM00098 EQU   @NM00097
@NM00096 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00095 EQU   @NM00093+7
@NM00094 EQU   @NM00093
@NM00092 EQU   @NM00089
@NM00091 EQU   @NM00089
@NM00090 EQU   @NM00089
@NM00088 EQU   @NM00087
@NM00086 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00085 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00084 EQU   IOPMACFX+8
@NM00083 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00082 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00081 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00080 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00078 EQU   @NM00076+7
@NM00077 EQU   @NM00076
@NM00075 EQU   IOPLMDDR+6
@NM00074 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00073 EQU   IOPLMDF4
@NM00072 EQU   IOPLMDF3
@NM00071 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00070 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00069 EQU   IOPLMDDR
@NM00068 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00067+4
IOPUSED  EQU   @NM00067
IOPTPSEQ EQU   @NM00066+8
IOPVLSER EQU   @NM00066+2
IOPBLKSI EQU   @NM00066
IOPCQMAX EQU   IOPCQMAP+12
@NM00065 EQU   IOPCQMAP+11
@NM00064 EQU   IOPCQMAP+8
@NM00063 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00062 EQU   IOPSCMAP+11
@NM00061 EQU   IOPSCMAP+8
@NM00060 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00059 EQU   IOPNTMAX+11
@NM00058 EQU   IOPNTMAX+8
@NM00057 EQU   IOPNTMAX
@NM00056 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00055+5
IOPIPTF3 EQU   @NM00055
LISTEYY  EQU   LISTEDAT+4
LISTEDD  EQU   LISTEDAT+2
LISTEMM  EQU   LISTEDAT
LISTBYY  EQU   LISTBDAT+4
LISTBDD  EQU   LISTBDAT+2
LISTBMM  EQU   LISTBDAT
@NM00005 EQU   LISTPRM4
LISTSEL  EQU   LISTPRM4
@NM00004 EQU   LISTPRM3+1
LISTNOAC EQU   LISTPRM3
LISTNOAP EQU   LISTPRM3
LISTALL3 EQU   LISTPRM3
@NM00003 EQU   LISTPRM2+1
LISTMCS  EQU   LISTPRM2+1
LISTFMD  EQU   LISTPRM2+1
LISTSMD  EQU   LISTPRM2+1
LISTSYS  EQU   LISTPRM2
LISTDLB  EQU   LISTPRM2
LISTSRC  EQU   LISTPRM2
LISTMOD  EQU   LISTPRM2
LISTMAC  EQU   LISTPRM2
LISTLMD  EQU   LISTPRM2
LISTASM  EQU   LISTPRM2
LISTALL2 EQU   LISTPRM2
@NM00002 EQU   LISTPRM1+1
LISTLOG  EQU   LISTPRM1+1
@NM00001 EQU   LISTPRM1
LISTACRQ EQU   LISTPRM1
LISTCRQ  EQU   LISTPRM1
LISTALL1 EQU   LISTPRM1
FVPLTYPE EQU   FVPLIST+8
FVPLSTAT EQU   FVPLDATA+7
@NM00181 EQU   FVPLDATA+1
FVPLEND  EQU   FVPLDATA
@NM00180 EQU   FVPAHEAD+14
@NM00179 EQU   FVPAHEAD+10
@NM00178 EQU   FVPAHEAD
FVPALEN  EQU   FVPARRAY+1
FVPAEND  EQU   FVPATYPE
PRLCONC  EQU   PRLTIME+2
@NM00177 EQU   PRLTIME
@NM00176 EQU   PRLFLGS
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00161 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00160 EQU   @NM00159+7
IOPQSMFM EQU   @NM00159
@NM00079 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00054 EQU   IOPUSERL
@NM00053 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00052 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00051 EQU   @NM00048+10
IOPSEQNO EQU   @NM00048+8
@NM00050 EQU   @NM00049+7
IOPPTFNM EQU   @NM00049
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00047 EQU   CCABLDLM+2
@NM00046 EQU   CCABLDLM
CCAUPDPM EQU   @NM00044+24
@NM00045 EQU   @NM00044+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00044+12
CCAUPDTE EQU   @NM00044+8
CCAUPDNM EQU   @NM00044
CCASUPPM EQU   @NM00042+24
@NM00043 EQU   @NM00042+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00042+12
CCAIOSUP EQU   @NM00042+8
CCASUPNM EQU   @NM00042
CCAZAPPM EQU   @NM00040+24
@NM00041 EQU   @NM00040+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00040+12
CCASPZAP EQU   @NM00040+8
CCAZAPNM EQU   @NM00040
CCACOMPM EQU   @NM00038+24
@NM00039 EQU   @NM00038+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00038+12
CCACOMRS EQU   @NM00038+8
CCACOMNM EQU   @NM00038
CCACPYPM EQU   @NM00036+24
@NM00037 EQU   @NM00036+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00036+12
CCACOPY  EQU   @NM00036+8
CCACPYNM EQU   @NM00036
CCAASMPM EQU   @NM00034+24
@NM00035 EQU   @NM00034+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00034+12
CCAASM   EQU   @NM00034+8
CCAASMNM EQU   @NM00034
CCALKDPM EQU   @NM00032+24
@NM00033 EQU   @NM00032+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00032+12
CCALKED  EQU   @NM00032+8
CCALKDNM EQU   @NM00032
CCAPGMPM EQU   @NM00030+24
@NM00031 EQU   @NM00030+21
CCABPGRC EQU   @NM00030+20
CCABPGSP EQU   @NM00030+12
CCABPGAD EQU   @NM00030+8
CCABPGNM EQU   @NM00030
CCAEND   EQU   HMASMCCA+371
@NM00029 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00028 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00027 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00026 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00025 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00024 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00023 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00022 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00021 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00020 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00019 EQU   @NM00014+18
@NM00018 EQU   @NM00014+16
CCATBLPA EQU   @NM00014+12
@NM00017 EQU   @NM00014+8
@NM00016 EQU   @NM00014+4
@NM00015 EQU   @NM00014
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
@NM00013 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00012 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00011 EQU   CCAFBUFR+122
@NM00010 EQU   CCAFBUFR+120
@NM00009 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00008 EQU   CCAFBUFR+88
@NM00007 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00006 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@ENDDATA EQU   *
         END   HMASMFPT,(C'PLS2022',0802,78334)

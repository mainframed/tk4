         TITLE 'HMASMLKD - LINK EDIT SYSGEN SCAN ROUTINE OF SMP'
HMASMLKD CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMLKD  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(16),0(@01)                                 0001
*   IOPPTR=CCAIOPTR;                /* INITIALIZE IOP PTR            */
         L     @15,CCAIOPTR(,CCAPTR)                               0210
         ST    @15,IOPPTR                                          0210
*   SCPPTR=ADDR(LKDSCP);            /* PTR TO LOCAL SCP      @Z67SP00*/
         LA    @14,LKDSCP                                          0211
         ST    @14,SCPPTR                                          0211
*   HMASMSCP=CRPSCPAD->HMASMSCP;    /* COPY PASSED SCP       @Z67SP00*/
         L     @09,@PC00001+4                                      0212
         L     @01,CRPSCPAD(,@09)                                  0212
         MVC   HMASMSCP(26,@14),HMASMSCP(@01)                      0212
*   CRPSCPAD=SCPPTR;                /* CHAIN CRP TO SCP      @Z67SP00*/
         ST    @14,CRPSCPAD(,@09)                                  0213
*   RFY                                                            0214
*     HMASMGTP BASED(ADDR(MDDLBGTP));/*                              */
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/
         LA    @14,MDDLBGTP                                        0215
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0215
*   GTPRCDLN=LENGTH(MDDLBRCD);      /*                       @Z67SP00*/
         MVC   GTPRCDLN(2,@14),@CH00216                            0216
*   GTPKEYLN=LENGTH(CSECTN);        /*                       @Z67SP00*/
         MVC   GTPKEYLN(2,@14),@CH00043                            0217
*   GTPBUFAD=ADDR(MDDLBRCD);        /*                       @Z67SP00*/
         LA    @09,MDDLBRCD                                        0218
         ST    @09,GTPBUFAD(,@14)                                  0218
*   GTPPSIZE=GTP512B;               /*                       @Z67SP00*/
         NI    GTPPSIZE(@14),B'11111001'                           0219
         OI    GTPPSIZE(@14),B'00000001'                           0219
*   RFY                                                            0220
*     HMASMGTP BASED(ADDR(CCGTP));  /* CONTROL CARD GTP      @Z67SP00*/
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/
         LA    @14,CCGTP                                           0221
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0221
*   GTPRCDLN=LENGTH(CCRCD);         /*                       @Z67SP00*/
         MVC   GTPRCDLN(2,@14),@CH00548                            0222
*   GTPKEYLN=LENGTH(CCKEY);         /*                       @Z67SP00*/
         MVC   GTPKEYLN(2,@14),@CH00064                            0223
*   GTPBUFAD=ADDR(CCRCD);           /*                       @Z67SP00*/
         LA    @09,CCRCD                                           0224
         ST    @09,GTPBUFAD(,@14)                                  0224
*   RFY                                                            0225
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/
*   BUPIOPAD=ADDR(HMASMIOP);        /*                       @Z67SP00*/
         L     @14,@PC00001                                        0226
         ST    @15,BUPIOPAD(,@14)                                  0226
*   BUPFUNCT=BUPABKUP;              /*                       @Z67SP00*/
         MVI   BUPFUNCT(@14),X'01'                                 0227
*   LKDRTNCD=ZERO;                  /* INIT RC                       */
         MVI   LKDRTNCD,X'00'                                      0228
*   SYSLADDR=ZERO;                  /* INITIALIZE ADDR OF SYSLMOD    */
         SLR   @14,@14                                             0229
         ST    @14,SYSLADDR                                        0229
*   MODKEYPT=ZERO;                  /* INIT ADDR OF MOD= KEY @SA72421*/
         ST    @14,MODKEYPT                                        0230
*   SWITCHES=ZERO;                  /* ZERO SWITCH BYTE      @Z40SP00*/
         STCM  @14,7,SWITCHES                                      0231
*   SAVBUFAD=IOPBUFAD;              /* SAVE CURRENT BUFFER ADDR      */
         L     @15,IOPBUFAD(,@15)                                  0232
         ST    @15,SAVBUFAD                                        0232
         EJECT
*                                                                  0233
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS DATA FROM JCL BUFFER PASSED                   @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0233
*   IF LKDRTNCD=ZERO                /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CLI   LKDRTNCD,0                                          0233
         BNE   @RF00233                                            0233
*     DO;                           /*                       @Z67SP00*/
*       CALL LKDJCL;                /*                       @Z67SP00*/
         BAL   @14,LKDJCL                                          0235
*       RFY                                                        0236
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       LKDRTNCD=MAX(LKDRTNCD,RTNCODE);/*                    @Z67SP00*/
         SLR   @14,@14                                             0237
         IC    @14,LKDRTNCD                                        0237
         CR    @14,RTNCODE                                         0237
         BNL   *+6
         LR    @14,RTNCODE                                         0237
         STC   @14,LKDRTNCD                                        0237
*       RFY                                                        0238
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
*                                                                  0239
*   /*****************************************************************/
*   /*                                                               */
*   /* IF JCL PROCESS OK NOW PROCESS DATA FROM INPUT STREAM  @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*   IF LKDRTNCD=ZERO                /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00233 CLI   LKDRTNCD,0                                          0240
         BNE   @RF00240                                            0240
*     DO;                           /*                       @Z67SP00*/
*       CALL LKDCC;                 /*                       @Z67SP00*/
         BAL   @14,LKDCC                                           0242
*       RFY                                                        0243
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       LKDRTNCD=MAX(LKDRTNCD,RTNCODE);/*                    @Z67SP00*/
         SLR   @14,@14                                             0244
         IC    @14,LKDRTNCD                                        0244
         CR    @14,RTNCODE                                         0244
         BNL   *+6
         LR    @14,RTNCODE                                         0244
         STC   @14,LKDRTNCD                                        0244
*       RFY                                                        0245
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
*                                                                  0246
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CONTROL CARDS PROCESSED OK BUT NAME CARD NOT FOUND THEN GET*/
*   /* LMOD NAME FROM JCL                                    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0247
*   IF LKDRTNCD=ZERO                /* CC PROCESSED OK       @Z67SP00*/
*       &NAMEFND=OFF                /* BUT NAME NOT FOUND    @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00240 CLI   LKDRTNCD,0                                          0247
         BNE   @RF00247                                            0247
         TM    NAMEFND,B'00010000'                                 0247
         BNZ   @RF00247                                            0247
*     DO;                           /*                       @Z67SP00*/
*       CALL LKDLNAME;              /*                       @Z67SP00*/
         BAL   @14,LKDLNAME                                        0249
*       RFY                                                        0250
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       LKDRTNCD=MAX(LKDRTNCD,RTNCODE);/*                    @Z67SP00*/
         SLR   @14,@14                                             0251
         IC    @14,LKDRTNCD                                        0251
         CR    @14,RTNCODE                                         0251
         BNL   *+6
         LR    @14,RTNCODE                                         0251
         STC   @14,LKDRTNCD                                        0251
*       RFY                                                        0252
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
*                                                                  0253
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW FREE BOTH GTPS THAT MAY HAVE BEEN USED AND        @Z67SP00*/
*   /* RETURN TO CALLER                                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0254
*   GTPPTR=ADDR(MDDLBGTP);          /*                       @Z67SP00*/
@RF00247 LA    @15,MDDLBGTP                                        0254
         ST    @15,GTPPTR                                          0254
*   GTPFUNCT=GTPFREE;               /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'0A'                                 0255
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/
         ST    @15,@AL00001                                        0256
         L     @15,@CV01384                                        0256
         LA    @01,@AL00001                                        0256
         BALR  @14,@15                                             0256
*   GTPPTR=ADDR(CCGTP);             /*                       @Z67SP00*/
         LA    @15,CCGTP                                           0257
         ST    @15,GTPPTR                                          0257
*   GTPFUNCT=GTPFREE;               /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'0A'                                 0258
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/
         ST    @15,@AL00001                                        0259
         L     @15,@CV01384                                        0259
         LA    @01,@AL00001                                        0259
         BALR  @14,@15                                             0259
*   IF LKDRTNCD=ZERO                /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CLI   LKDRTNCD,0                                          0260
         BNE   @RF00260                                            0260
*     DO;                           /*                       @Z67SP00*/
*       IF JCLENSW=ON               /* IF JCL CARD STOPPED   @Z67SP00*/
*         THEN                      /* SCAN                  @Z67SP00*/
         TM    JCLENSW,B'10000000'                                 0262
         BNO   @RF00262                                            0262
*         LKDRTNCD=JCLENC;          /* THEN SET RC           @Z67SP00*/
         MVI   LKDRTNCD,X'06'                                      0263
*       ELSE                        /* ELSE                  @Z67SP00*/
*         IF PREMSW=ON              /* IF END OF FILE        @Z67SP00*/
*           THEN                    /* STOPPED SCAN          @Z67SP00*/
         B     @RC00262                                            0264
@RF00262 TM    PREMSW,B'01000000'                                  0264
         BNO   @RF00264                                            0264
*           LKDRTNCD=PREMEOF;       /* SET RC                @Z67SP00*/
         MVI   LKDRTNCD,X'0E'                                      0265
*     END;                          /*                       @Z67SP00*/
@RF00264 DS    0H                                                  0266
@RC00262 DS    0H                                                  0267
*   RETURN CODE(LKDRTNCD);          /*                       @Z67SP00*/
@RF00260 SLR   @15,@15                                             0267
         IC    @15,LKDRTNCD                                        0267
         L     @13,4(,@13)                                         0267
         L     @14,12(,@13)                                        0267
         LM    @00,@12,20(@13)                                     0267
         BR    @14                                                 0267
         EJECT
*                                                                  0268
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS JCL IN BUFFER LOOKING FOR LEPARMS AND DSN     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0268
*LKDJCL:                            /*                       @Z67SP00*/
*   PROCEDURE;                      /*                       @Z67SP00*/
@EL00001 L     @13,4(,@13)                                         0268
@EF00001 DS    0H                                                  0268
@ER00001 LM    @14,@12,12(@13)                                     0268
         BR    @14                                                 0268
LKDJCL   STM   @14,@12,@SA00002                                    0268
*   DECLARE                         /*                       @Z67SP00*/
*     JCLRC FIXED(8);               /*                       @Z67SP00*/
*   JCLRC=ZERO;                     /*                       @Z67SP00*/
         MVI   JCLRC,X'00'                                         0270
*   IOPLMDNT=''B;                   /* INIT LMOD ENTRY       @Z67SP00*/
         L     @01,IOPPTR                                          0271
         XC    IOPLMDNT(104,@01),IOPLMDNT(@01)                     0271
*   SCPCHAR=ADDR(BUFFER);           /* SET POINTER TO STRING         */
*                                                                  0272
         L     @15,@PC00001+8                                      0272
         L     @14,SCPPTR                                          0272
         ST    @15,SCPCHAR(,@14)                                   0272
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOK THRU ALL JCL IN BUFFER                           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0273
*   DO UNTIL(                       /* LOOP THRU ALL JCL     @Z67SP00*/
*         SCPSTRNG(1)=IOPEOLST      /* UNTIL END OF JCL      @Z67SP00*/
*         ×JCLRC^=ZERO);            /* OR ERROR              @Z67SP00*/
*                                                                  0273
@DL00273 DS    0H                                                  0274
*     /***************************************************************/
*     /*                                                             */
*     /* LOOK FOR SPECIAL CHARACTERS - THEY SEPERATE KEYWORDS        */
*     /*                                                     @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0274
*     DO WHILE SCPSTRNG(1)>=CHARA   /* AS LONG AS LOOKING AT CHAR    */
*           &SCPSTRNG(1)<=CHARZ;    /* DATA                  @Z40SP00*/
         B     @DE00274                                            0274
@DL00274 DS    0H                                                  0275
*       SCPCHAR=SCPCHAR+1;          /* SKIP PAST DATA                */
         L     @15,SCPPTR                                          0275
         LA    @14,1                                               0275
         AL    @14,SCPCHAR(,@15)                                   0275
         ST    @14,SCPCHAR(,@15)                                   0275
*     END;                                                         0276
@DE00274 L     @01,SCPPTR                                          0276
         L     @15,SCPCHAR(,@01)                                   0276
         CLI   SCPSTRNG(@15),C'A'                                  0276
         BL    @DC00274                                            0276
         CLI   SCPSTRNG(@15),C'Z'                                  0276
         BNH   @DL00274                                            0276
@DC00274 DS    0H                                                  0277
*     SCPCHAR=SCPCHAR+1;            /* SEARCH TILL JCL               */
         L     @15,SCPPTR                                          0277
         LA    @14,1                                               0277
         L     @09,SCPCHAR(,@15)                                   0277
         ALR   @09,@14                                             0277
         ST    @09,SCPCHAR(,@15)                                   0277
*     IF SCPSTRNG(1)^=IOPEOLST      /* IF NOT AT END         @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
         CLI   SCPSTRNG(@09),255                                   0278
         BE    @RF00278                                            0278
*       DO;                         /*                       @Z67SP00*/
*                                                                  0279
*         /***********************************************************/
*         /*                                                         */
*         /* NOW LOOK AT CHAR AFTER SPECIAL CHARACTER TOO SEE IF IT  */
*         /* IS ONE OF THE KEYWORDS THAT MUST BE SAVED       @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0280
*         IF SCPSTRNG(1)>=CHARA     /* IS THIS CHARACTER ALPHABETIC? */
*             &SCPSTRNG(1)<=CHARZ   /* SAME AS ABOVE         @Z40SP00*/
*           THEN                    /* YES - CONSIDER IT AS POSSIBLE */
         CLI   SCPSTRNG(@09),C'A'                                  0280
         BL    @RF00280                                            0280
         CLI   SCPSTRNG(@09),C'Z'                                  0280
         BH    @RF00280                                            0280
*           DO TEMPPTR1=1 TO DIM(KEYS);/* LOOK THRU KEYS     @SA75303*/
         ST    @14,TEMPPTR1                                        0281
@DL00281 DS    0H                                                  0282
*             TEMPPTR2=KEYLEN(TEMPPTR1);/* GET LENGTH                */
*                                                                  0282
         MH    @14,@CH00466                                        0282
         SLR   @15,@15                                             0282
         IC    @15,KEYLEN-13(@14)                                  0282
         ST    @15,TEMPPTR2                                        0282
*             /*******************************************************/
*             /*                                                     */
*             /* IF MATCH FOUND IN KEYWORD TABLE, THEN GO TO ROUTINE */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0283
*             IF SCPSTRNG(1:TEMPPTR2)=/*                     @Z40SP00*/
*                 KEYWORD(TEMPPTR1,1:TEMPPTR2) THEN/*        @Z67SP00*/
         L     @01,SCPPTR                                          0283
         L     @01,SCPCHAR(,@01)                                   0283
         BCTR  @15,0                                               0283
         LA    @09,KEYWORD-13(@14)                                 0283
         EX    @15,@SC01727                                        0283
         BNE   @RF00283                                            0283
*               DO;                 /*                       @Z67SP00*/
*                 CALL KEYROUT;     /*                       @Z67SP00*/
         LA    @01,KEYROUTS-13(@14)                                0285
         ICM   @15,15,0(@01)                                       0285
         BALR  @14,@15                                             0285
*                 RFY                                              0286
*                   RTNCODE RSTD;   /*                       @Z67SP00*/
*                 JCLRC=MAX(JCLRC,RTNCODE);/* SAVE RC        @Z67SP00*/
         SLR   @14,@14                                             0287
         IC    @14,JCLRC                                           0287
         CR    @14,RTNCODE                                         0287
         BNL   *+6
         LR    @14,RTNCODE                                         0287
         STC   @14,JCLRC                                           0287
*                 RFY                                              0288
*                   RTNCODE UNRSTD; /*                       @Z67SP00*/
*               END;                /*                       @Z67SP00*/
*           END;                    /*                       @Z67SP00*/
@RF00283 LA    @14,1                                               0290
         AL    @14,TEMPPTR1                                        0290
         ST    @14,TEMPPTR1                                        0290
         C     @14,@CF00070                                        0290
         BNH   @DL00281                                            0290
*       END;                        /* END NOT AT EOLST      @Z67SP00*/
@RF00280 DS    0H                                                  0292
*   END;                            /* END JCL LOOP          @Z67SP00*/
*                                                                  0292
@RF00278 DS    0H                                                  0292
@DE00273 L     @01,SCPPTR                                          0292
         L     @01,SCPCHAR(,@01)                                   0292
         CLI   SCPSTRNG(@01),255                                   0292
         BE    @DC00273                                            0292
         CLI   JCLRC,0                                             0292
         BE    @DL00273                                            0292
@DC00273 DS    0H                                                  0293
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF SYSLMOD FOUND. IF NOT ISSUE ERROR MSG          @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0293
*   IF SYSTSW=ON                    /* SYSLMOD FOUND?        @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    SYSTSW,B'00001000'                                  0293
         BNO   @RF00293                                            0293
*     DO;                           /*                       @Z67SP00*/
*       FLAGSAV1=IOPLMDF1;          /* SAVE LKED FLAGS 1     @ZD00004*/
         L     @15,IOPPTR                                          0295
         MVC   FLAGSAV1(1),IOPLMDF1(@15)                           0295
*       FLAGSAV2=IOPLMDF2;          /* SAVE LKED FLAGS 2     @ZD00004*/
         MVC   FLAGSAV2(1),IOPLMDF2(@15)                           0296
*       FLAGSAV3=IOPLMDF3;          /* SAVE LKED FLAGS 3     @ZD00004*/
         MVC   FLAGSAV3(1),IOPLMDF3(@15)                           0297
*       FLAGSAV4=IOPLMDF4;          /* SAVE LKED FLAGS 4     @ZD00004*/
         MVC   FLAGSAV4(1),IOPLMDF4(@15)                           0298
*       FLAGSAV5=IOPLMDF5;          /* SAVE LMD OPTIONS      @ZD00004*/
         MVC   FLAGSAV5(1),IOPLMDF5(@15)                           0299
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /* NO - SYNTAX ERROR             */
*     DO;                           /*                       @SA72421*/
         B     @RC00293                                            0301
@RF00293 DS    0H                                                  0302
*       CALL LKDERR(BUFFER,NOSYSL); /* WRITE ERR MSG         @Z67SP00*/
         L     @15,@PC00001+8                                      0302
         ST    @15,@AL00001                                        0302
         LA    @15,NOSYSL                                          0302
         ST    @15,@AL00001+4                                      0302
         LA    @01,@AL00001                                        0302
         BAL   @14,LKDERR                                          0302
*       JCLRC=MAX(JCLRC,SYNTERR);   /* SAVE RC               @Z67SP00*/
         SLR   @15,@15                                             0303
         IC    @15,JCLRC                                           0303
         LA    @14,10                                              0303
         CR    @15,@14                                             0303
         BNL   *+6
         LR    @15,@14                                             0303
         STC   @15,JCLRC                                           0303
*     END;                          /*                       @SA72421*/
*                                                                  0304
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL JCL PROCESSED NOW RETURN                          @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0305
*   RETURN CODE(JCLRC);             /*                       @Z67SP00*/
@RC00293 SLR   @15,@15                                             0305
         IC    @15,JCLRC                                           0305
         L     @14,@SA00002                                        0305
         LM    @00,@12,@SA00002+8                                  0305
         BR    @14                                                 0305
*   END LKDJCL;                     /*                       @Z67SP00*/
         EJECT
*                                                                  0307
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW THAT JCL HAS BEEN SCANNED SET UP TO SCAN LKED CONTROL     */
*   /* CARDS FROM JCLIN INPUT STREAM. INITIALIZE LOCAL VERIABLES, SET*/
*   /* UP SCP.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0307
*LKDCC:                             /*                       @Z67SP00*/
*   PROCEDURE;                      /*                       @Z67SP00*/
LKDCC    STM   @14,@12,@SA00003                                    0307
*   DECLARE                         /*                       @Z67SP00*/
*     CCRC FIXED(8);                /*                       @Z67SP00*/
*   CCRC=ZERO;                      /*                       @Z67SP00*/
*                                                                  0309
         MVI   CCRC,X'00'                                          0309
*   /*****************************************************************/
*   /*                                                               */
*   /* INSURE THAT GTPS USED TO HOLD MOD/DLIB PAIRS AND CONTROL CARDS*/
*   /* ARE INITIALIZED TO ZERO                               @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0310
*   RFY                                                            0310
*     HMASMGTP BASED(ADDR(MDDLBGTP));/*                              */
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/
         LA    @15,MDDLBGTP                                        0311
         XC    HMASMGTP(28,@15),HMASMGTP(@15)                      0311
*   GTPRCDLN=LENGTH(MDDLBRCD);      /*                       @Z67SP00*/
         MVC   GTPRCDLN(2,@15),@CH00216                            0312
*   GTPKEYLN=LENGTH(CSECTN);        /*                       @Z67SP00*/
         MVC   GTPKEYLN(2,@15),@CH00043                            0313
*   GTPBUFAD=ADDR(MDDLBRCD);        /*                       @Z67SP00*/
         LA    @14,MDDLBRCD                                        0314
         ST    @14,GTPBUFAD(,@15)                                  0314
*   GTPPSIZE=GTP512B;               /*                       @Z67SP00*/
         NI    GTPPSIZE(@15),B'11111001'                           0315
         OI    GTPPSIZE(@15),B'00000001'                           0315
*   RFY                                                            0316
*     HMASMGTP BASED(ADDR(CCGTP));  /* CONTROL CARD GTP      @Z67SP00*/
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/
         LA    @15,CCGTP                                           0317
         XC    HMASMGTP(28,@15),HMASMGTP(@15)                      0317
*   GTPRCDLN=LENGTH(CCRCD);         /*                       @Z67SP00*/
         MVC   GTPRCDLN(2,@15),@CH00548                            0318
*   GTPKEYLN=LENGTH(CCKEY);         /*                       @Z67SP00*/
         MVC   GTPKEYLN(2,@15),@CH00064                            0319
*   GTPBUFAD=ADDR(CCRCD);           /*                       @Z67SP00*/
         LA    @14,CCRCD                                           0320
         ST    @14,GTPBUFAD(,@15)                                  0320
*   RFY                                                            0321
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/
*                                                                  0321
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SCP AND BUFFER AREA                        @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0322
*   CCSEQNO=ZERO;                   /* RESET SEQUENCE NUMBER @Z67SP00*/
         SLR   @15,@15                                             0322
         STCM  @15,15,CCSEQNO                                      0322
*   SCPIORTN=ZERO;                  /* INDICATE NO I/O ROUTINE       */
         L     @14,SCPPTR                                          0323
         ST    @15,SCPIORTN(,@14)                                  0323
*   SCPSRCH=ADDR(KINCLUDE);         /* POINT AT START SEARCH ARG     */
         LA    @15,KINCLUDE                                        0324
         ST    @15,SCPSRCH(,@14)                                   0324
*   SCPINLN=LENGTH(CRPBFDTA);       /* SET INPUT RCD LEN     @Z67SP00*/
         MVC   SCPINLN(2,@14),@CH01063                             0325
*   SCPCHAR=ADDR(CRPBUFFR);         /* PTR TO DATA TO SCAN   @Z67SP00*/
*                                                                  0326
         L     @15,@PC00001+4                                      0326
         LA    @15,CRPBUFFR(,@15)                                  0326
         ST    @15,SCPCHAR(,@14)                                   0326
*   /*****************************************************************/
*   /*                                                               */
*   /* FIRST CONTROL CARD IS IN BUFFER. NOW SCAN CARD AND ALL OTHER  */
*   /* CARDS UNTIL END OF INPUT OR ERROR                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0327
*   DO WHILE(                       /* LOOP SCANNING RCDS    @Z67SP00*/
*         SCPSTRNG(1:2)^=SLASHAST   /* TILL END              @Z67SP00*/
*         &JCLENSW=OFF              /* OF JCL CARD FOUND     @Z67SP00*/
*         &PREMSW=OFF               /* OR EOF FOUND          @Z67SP00*/
*         &CCRC=ZERO);              /* OR ERROR              @Z40SP00*/
         B     @DE00327                                            0327
@DL00327 DS    0H                                                  0328
*     CCORDER=CCOTHR;               /* SET TYPE CONTROL CARD @Z67SP00*/
         MVI   CCORDER,X'01'                                       0328
*     CALL HMASMSCN(HMASMSCP);      /* SCAN LKED CONTROL STMT        */
*                                                                  0329
         L     @01,SCPPTR                                          0329
         ST    @01,@AL00001                                        0329
         L     @15,@CV01386                                        0329
         LA    @01,@AL00001                                        0329
         BALR  @14,@15                                             0329
*     /***************************************************************/
*     /*                                                             */
*     /* IF CARD SCANNED SUCCESSFULLY CHECK FOR CONTINUATION         */
*     /* CHARACTER AND SET DSCAN ACCORDINGLY                 @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0330
*     IF SCPRETRN=SCPGOOD           /* IF SCAN OK            @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
         L     @15,SCPPTR                                          0330
         CLI   SCPRETRN(@15),0                                     0330
         BNE   @RF00330                                            0330
*       DO;                         /*                       @Z67SP00*/
*         SCPCHAR=ADDR(CRPBUFFR);   /* START OF CARD         @Z67SP00*/
         L     @14,@PC00001+4                                      0332
         LA    @09,CRPBUFFR(,@14)                                  0332
         ST    @09,SCPCHAR(,@15)                                   0332
*         IF CRPBFCNT^=BLANK        /* IS CONTINUATION INDICATED   0333
*                                                            @Z67SP00*/
*           THEN                    /* YES                   @XA07462*/
         CLI   CRPBFCNT(@14),C' '                                  0333
         BE    @RF00333                                            0333
*           IF INCLPARM=ON          /* IS THIS PARMLIB CONTINUATION
*                                                            @XA07462*/
*             THEN                  /*                       @XA07462*/
         TM    INCLPARM,B'00000100'                                0334
         BNO   @RF00334                                            0334
*             SCPSRCH=ADDR(KLKDSVCC);/* SET SCAN ENTRY TO IMMEDIATELY
*                                      WRITE PARMLIB CONTINUATION TO
*                                      CDS                   @XA07462*/
         LA    @14,KLKDSVCC                                        0335
         ST    @14,SCPSRCH(,@15)                                   0335
*           ELSE                    /*                       @XA07462*/
*             IF INCLFND=ON&        /* IF ANY INCLUDE CONTINUATION 0336
*                                                            @XA07462*/
*                 INCLSYSL=OFF      /* EXCEPT PARMLIB OR SYSLMOD   0336
*                                                            @XA07462*/
*               THEN                /* SET SCAN ENTRY TO CONTINUE  0336
*                                                            @XA07462*/
         B     @RC00334                                            0336
@RF00334 TM    INCLFND,B'00000001'                                 0336
         BNO   @RF00336                                            0336
         TM    INCLSYSL,B'00000010'                                0336
         BNZ   @RF00336                                            0336
*               SCPSRCH=ADDR(KCSECTV);/* SEARCH FOR MOD      @XA07462*/
         LA    @15,KCSECTV                                         0337
         L     @14,SCPPTR                                          0337
         ST    @15,SCPSRCH(,@14)                                   0337
*             ELSE                                                 0338
*               ;                   /* OTHER THAN INCLUDE OR INCLUDE
*                                      SYSLMOD - NO CHANGE   @XA07462*/
@RF00336 DS    0H                                                  0339
*         ELSE                      /*                       @XA07462*/
*           DO;                     /* POSSIBLE LAST OF CONTINUATIONS
*                                                            @XA07462*/
         B     @RC00333                                            0339
@RF00333 DS    0H                                                  0340
*             SCPSRCH=ADDR(KINCLUDE);/* SET SCAN ADDR        @Z67SP00*/
         LA    @15,KINCLUDE                                        0340
         L     @14,SCPPTR                                          0340
         ST    @15,SCPSRCH(,@14)                                   0340
*             INCLFND=OFF;          /* TURN OFF INCLUDE FOUND SWS- 0341
*                                      ANY                   @XA07462*/
*             INCLPARM=OFF;         /* - PARMLIB             @XA07462*/
*             INCLSYSL=OFF;         /* - SYSLMOD             @XA07462*/
         NI    INCLFND,B'11111000'                                 0343
*           END;                    /*                       @XA07462*/
*REREAD:                            /*                       @XA07462*/
*         CALL HMASMCRD(HMASMCRP);  /* READ JCLIN RCD        @Z67SP00*/
@RC00333 DS    0H                                                  0345
REREAD   L     @15,@PC00001+4                                      0345
         ST    @15,@AL00001                                        0345
         L     @15,@CV01383                                        0345
         LA    @01,@AL00001                                        0345
         BALR  @14,@15                                             0345
*         IF CRPRETRN=CRPGOOD       /* IF RECORD OBTAINED OK @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         L     @15,@PC00001+4                                      0346
         CLI   CRPRETRN(@15),0                                     0346
         BNE   @RF00346                                            0346
*           DO;                     /*                       @Z67SP00*/
*             IF CRPBUFFR(1:2)=TWOSLASH/* JCL FOUND?         @Z67SP00*/
*               THEN                                               0348
         CLC   CRPBUFFR(2,@15),@CC01407                            0348
         BNE   @RF00348                                            0348
*               JCLENSW=ON;         /* REMEMBER IT           @Z67SP00*/
         OI    JCLENSW,B'10000000'                                 0349
*             ELSE                  /*                       @Z67SP00*/
*               IF CRPINDS=IOPPTS   /* IF PTS DATASET        @Z67SP00*/
*                   &CRPBUFFR(1:2)=TWOPLUS/* AND NEX MCS     @Z67SP00*/
*                 THEN              /* TREAT AS PREMATURE    @Z67SP00*/
         B     @RC00348                                            0350
@RF00348 L     @15,@PC00001+4                                      0350
         CLI   CRPINDS(@15),6                                      0350
         BNE   @RF00350                                            0350
         CLC   CRPBUFFR(2,@15),@CC01409                            0350
         BNE   @RF00350                                            0350
*                 PREMSW=ON;        /* END OF FILE           @Z67SP00*/
         OI    PREMSW,B'01000000'                                  0351
*             IF INCLSYSL=ON        /* IS INCLUDE SYSLMOD          0352
*                                      CONTINUATION BEING PROCESSED
*                                                            @XA07462*/
*               THEN                /* YES ---               @XA07462*/
@RF00350 DS    0H                                                  0352
@RC00348 TM    INCLSYSL,B'00000010'                                0352
         BNO   @RF00352                                            0352
*               IF CRPBFCNT^=BLANK  /* THIS ANOTHER CONT     @Z67SP00*/
*                 THEN              /* YES ---               @XA07462*/
         L     @15,@PC00001+4                                      0353
         CLI   CRPBFCNT(@15),C' '                                  0353
         BNE   @RT00353                                            0353
*                 GO TO REREAD;     /* READ NEXT CARD        @Z67SP00*/
*               ELSE                /*                       @Z67SP00*/
*                 DO;               /*                       @Z67SP00*/
*                   INCLFND=OFF;    /* NOT IN INCLUDE        @Z67SP00*/
*                   INCLSYSL=OFF;   /* NOT SYSLMOD CONT      @Z67SP00*/
         NI    INCLFND,B'11111100'                                 0357
*                   GO TO REREAD;   /* READ NEXT RCD         @Z67SP00*/
         B     REREAD                                              0358
*                 END;              /*                       @XA07462*/
*           END;                    /*                       @Z67SP00*/
*         ELSE                      /* RCD NOT READ          @Z67SP00*/
*           IF CRPRETRN=CRPEOF      /* PREMATURE END OF FILE?@Z67SP00*/
*             THEN                  /* YES - INDICATE ERROR          */
         B     @RC00346                                            0361
@RF00346 L     @15,@PC00001+4                                      0361
         CLI   CRPRETRN(@15),4                                     0361
         BNE   @RF00361                                            0361
*             PREMSW=ON;            /* PREMATURE EOF         @Z67SP00*/
         OI    PREMSW,B'01000000'                                  0362
*           ELSE                    /*                       @Z67SP00*/
*             IF CRPRETRN>CRPEOF    /* SERIOUS ERROR?        @Z67SP00*/
*               THEN                /* YES - I/O ERROR               */
         B     @RC00361                                            0363
@RF00361 L     @15,@PC00001+4                                      0363
         CLI   CRPRETRN(@15),4                                     0363
         BNH   @RF00363                                            0363
*               DO;                 /*                       @Z67SP00*/
*                 CCRC=MAX(CCRC,CRPRETRN);/* SAVE RC         @Z67SP00*/
         SLR   @14,@14                                             0365
         IC    @14,CCRC                                            0365
         SLR   @09,@09                                             0365
         IC    @09,CRPRETRN(,@15)                                  0365
         CR    @14,@09                                             0365
         BNL   *+6
         LR    @14,@09                                             0365
         STC   @14,CCRC                                            0365
*                 CALL LKDERR(CRPBUFFR,LASTLINE);/*          @Z67SP00*/
         LA    @15,CRPBUFFR(,@15)                                  0366
         ST    @15,@AL00001                                        0366
         LA    @15,LASTLINE                                        0366
         ST    @15,@AL00001+4                                      0366
         LA    @01,@AL00001                                        0366
         BAL   @14,LKDERR                                          0366
*               END;                /*                       @Z67SP00*/
*       END;                        /* END SCAN OK           @Z67SP00*/
*                                                                  0368
*     /***************************************************************/
*     /*                                                             */
*     /* IF SCAN RETURN CODE NOT OK THEN CHECK FOR ERRS      @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0369
*     ELSE                          /*                       @Z67SP00*/
*       DO;                         /*                       @Z67SP00*/
         B     @RC00330                                            0369
@RF00330 DS    0H                                                  0370
*         IF EXCERR=ON              /* IOP EXCEEDED ERR?     @YA05690*/
*             ×INTERR=ON            /* I/O ERROR?                    */
*           THEN                    /* YES - RETURN                  */
         TM    EXCERR,B'11000000'                                  0370
         BZ    @RF00370                                            0370
*           DO;                     /*                       @SA72421*/
*             CALL LKDERR(CRPBUFFR,LASTLINE);/* ERR MSG      @Z67SP00*/
         L     @15,@PC00001+4                                      0372
         LA    @15,CRPBUFFR(,@15)                                  0372
         ST    @15,@AL00001                                        0372
         LA    @15,LASTLINE                                        0372
         ST    @15,@AL00001+4                                      0372
         LA    @01,@AL00001                                        0372
         BAL   @14,LKDERR                                          0372
*             CCRC=MAX(CCRC,IOPIOERR);/* SET RC              @Z67SP00*/
         SLR   @15,@15                                             0373
         IC    @15,CCRC                                            0373
         LA    @14,16                                              0373
         CR    @15,@14                                             0373
         BNL   *+6
         LR    @15,@14                                             0373
         STC   @15,CCRC                                            0373
*           END;                    /*                       @SA72421*/
*         ELSE                      /* ELSE, MUST BE SYNTAX ERROR    */
*           IF TBLEXC=ON            /* TABLE OVERFLOW?               */
*             THEN                  /* YES - INDICATE                */
         B     @RC00370                                            0375
@RF00370 TM    TBLEXC,B'00100000'                                  0375
         BNO   @RF00375                                            0375
*             DO;                   /*                       @SA72421*/
*               CALL LKDERR(CRPBUFFR,TBLOFLOW);/* ERR        @Z67SP00*/
         L     @15,@PC00001+4                                      0377
         LA    @15,CRPBUFFR(,@15)                                  0377
         ST    @15,@AL00001                                        0377
         LA    @15,TBLOFLOW                                        0377
         ST    @15,@AL00001+4                                      0377
         LA    @01,@AL00001                                        0377
         BAL   @14,LKDERR                                          0377
*               CCRC=MAX(CCRC,TBLERR);/* SET RC              @Z67SP00*/
         SLR   @15,@15                                             0378
         IC    @15,CCRC                                            0378
         LA    @14,12                                              0378
         CR    @15,@14                                             0378
         BNL   *+6
         LR    @15,@14                                             0378
         STC   @15,CCRC                                            0378
*             END;                  /*                       @SA72421*/
*           ELSE                    /* MUST BE SYNTAX ERROR          */
*             DO;                   /*                       @SA72421*/
         B     @RC00375                                            0380
@RF00375 DS    0H                                                  0381
*               CALL LKDERR(CRPBUFFR,CNTRLERR);/* ERR        @Z67SP00*/
         L     @15,@PC00001+4                                      0381
         LA    @15,CRPBUFFR(,@15)                                  0381
         ST    @15,@AL00001                                        0381
         LA    @15,CNTRLERR                                        0381
         ST    @15,@AL00001+4                                      0381
         LA    @01,@AL00001                                        0381
         BAL   @14,LKDERR                                          0381
*               CCRC=MAX(CCRC,SYNTERR);/* SET RC             @Z67SP00*/
         SLR   @15,@15                                             0382
         IC    @15,CCRC                                            0382
         LA    @14,10                                              0382
         CR    @15,@14                                             0382
         BNL   *+6
         LR    @15,@14                                             0382
         STC   @15,CCRC                                            0382
*             END;                  /*                       @SA72421*/
*       END;                        /*                       @Z67SP00*/
@RC00375 DS    0H                                                  0384
@RC00370 DS    0H                                                  0385
*   END;                                                           0385
*                                                                  0385
@RC00330 DS    0H                                                  0385
@DE00327 L     @01,SCPPTR                                          0385
         L     @01,SCPCHAR(,@01)                                   0385
         CLC   SCPSTRNG(2,@01),@CC01405                            0385
         BE    @DC00327                                            0385
         TM    JCLENSW,B'11000000'                                 0385
         BNZ   @DC00327                                            0385
         CLI   CCRC,0                                              0385
         BE    @DL00327                                            0385
@DC00327 DS    0H                                                  0386
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0386
*   RETURN CODE(CCRC);              /*                       @Z67SP00*/
         SLR   @15,@15                                             0386
         IC    @15,CCRC                                            0386
         L     @14,@SA00003                                        0386
         LM    @00,@12,@SA00003+8                                  0386
         BR    @14                                                 0386
*   END LKDCC;                      /*                       @Z67SP00*/
         EJECT
*                                                                  0388
*   /*****************************************************************/
*   /*                                                               */
*   /* NAME CARD NOT FOUND IN INPUT. SCAN JCL FOR NAME       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0388
*LKDLNAME:                          /*                       @Z67SP00*/
*   PROCEDURE;                      /*                       @Z67SP00*/
LKDLNAME STM   @14,@12,@SA00004                                    0388
*   DECLARE                         /*                       @Z67SP00*/
*     LMNRC FIXED(8);               /*                       @Z67SP00*/
*   LMNRC=ZERO;                     /*                       @Z67SP00*/
         MVI   LMNRC,X'00'                                         0390
*   IF SYSLADDR^=ZERO               /* SYSLMOD FOUND                 */
*     THEN                          /* YES - SCAN FOR MODNAME        */
         L     @15,SYSLADDR                                        0391
         LTR   @15,@15                                             0391
         BZ    @RF00391                                            0391
*     DO;                                                          0392
*       SCPCHAR=SYSLADDR;           /* POINT TO ADDRESS              */
         L     @14,SCPPTR                                          0393
         ST    @15,SCPCHAR(,@14)                                   0393
*       DO WHILE SCPSTRNG(1)^=IOPEOLST;/* LOOP LOOKING FOR LEFT PAREN
*                                                            @Z40SP00*/
         B     @DE00394                                            0394
@DL00394 DS    0H                                                  0395
*         SCPCHAR=SCPCHAR+1;        /* BUMP STRING BASE              */
         L     @15,SCPPTR                                          0395
         LA    @14,1                                               0395
         L     @09,SCPCHAR(,@15)                                   0395
         ALR   @09,@14                                             0395
         ST    @09,SCPCHAR(,@15)                                   0395
*         IF SCPSTRNG(1)=LPAREN     /* FND START OF MODNAME  @Z40SP00*/
*           THEN                    /* GO TO CONTINUE SCAN           */
         CLI   SCPSTRNG(@09),C'('                                  0396
         BNE   @RF00396                                            0396
*           DO;                                                    0397
*             SCPCHAR=SCPCHAR+1;    /* SKIP PAST LPAREN              */
         ALR   @09,@14                                             0398
         ST    @09,SCPCHAR(,@15)                                   0398
*             GO TO MODNMGT;        /* GO SAVE THE MODULE NAME       */
         B     MODNMGT                                             0399
*           END;                                                   0400
*       END;                                                       0401
@RF00396 DS    0H                                                  0401
@DE00394 L     @01,SCPPTR                                          0401
         L     @15,SCPCHAR(,@01)                                   0401
         CLI   SCPSTRNG(@15),255                                   0401
         BNE   @DL00394                                            0401
*       CALL LKDERR(JCLLINE,NOMODNM);/* WRITE ERR            @Z67SP00*/
         L     @14,@PC00001+8                                      0402
         LCR   @14,@14                                             0402
         ALR   @14,@15                                             0402
         ST    @15,@TF00001                                        0402
         SRDA  @14,32                                              0402
         D     @14,@CF00538                                        0402
         LCR   @14,@14                                             0402
         AL    @14,@TF00001                                        0402
         ST    @14,@AL00001                                        0402
         LA    @15,NOMODNM                                         0402
         ST    @15,@AL00001+4                                      0402
         LA    @01,@AL00001                                        0402
         BAL   @14,LKDERR                                          0402
*       LMNRC=MAX(LMNRC,SYNTERR);   /* SET RC                @YA07506*/
         SLR   @15,@15                                             0403
         IC    @15,LMNRC                                           0403
         LA    @14,10                                              0403
         CR    @15,@14                                             0403
         BNL   *+6
         LR    @15,@14                                             0403
         STC   @15,LMNRC                                           0403
*     END;                                                         0404
*                                                                  0404
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP UNTIL MOD= FOUND OR END OF JCL REACHED                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0405
*   ELSE                            /*                       @Z67SP00*/
*     DO;                           /*                       @Z67SP00*/
         B     @RC00391                                            0405
@RF00391 DS    0H                                                  0406
*       SCPCHAR=ADDR(BUFFER);       /* POINT TO JCL BUFFER           */
         L     @15,@PC00001+8                                      0406
         L     @14,SCPPTR                                          0406
         ST    @15,SCPCHAR(,@14)                                   0406
*       DO WHILE SCPSTRNG(1)^=IOPEOLST;/* LOOP TO FIND MOD= KEYWORD
*                                                            @Z67SP00*/
         B     @DE00407                                            0407
@DL00407 DS    0H                                                  0408
*         SCPCHAR=SCPCHAR+1;        /* BUMP STRING BASE              */
         L     @15,SCPPTR                                          0408
         LA    @14,1                                               0408
         AL    @14,SCPCHAR(,@15)                                   0408
         ST    @14,SCPCHAR(,@15)                                   0408
*         IF SCPSTRNG(1:LENGTH(MODKEY))=MODKEY/* THIS MOD=?  @Z40SP00*/
*           THEN                    /* THEN EXIT FROM SCAN LOOP      */
         CLC   SCPSTRNG(4,@14),@CC01412                            0409
         BE    @RT00409                                            0409
*           GO TO MODKEYGT;         /*                       @Z67SP00*/
*       END;                                                       0411
*                                                                  0411
@DE00407 L     @01,SCPPTR                                          0411
         L     @01,SCPCHAR(,@01)                                   0411
         CLI   SCPSTRNG(@01),255                                   0411
         BNE   @DL00407                                            0411
*       /*************************************************************/
*       /*                                                           */
*       /* MOD= KEYWORD NOT FOUND - ERROR                    @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0412
*       CALL LKDERR(CRPBUFFR,NOMODKEY);/* WRITE ERR MSG      @Z67SP00*/
         L     @15,@PC00001+4                                      0412
         LA    @15,CRPBUFFR(,@15)                                  0412
         ST    @15,@AL00001                                        0412
         LA    @15,NOMODKEY                                        0412
         ST    @15,@AL00001+4                                      0412
         LA    @01,@AL00001                                        0412
         BAL   @14,LKDERR                                          0412
*       LMNRC=MAX(LMNRC,SYNTERR);   /*                       @YA07506*/
         SLR   @15,@15                                             0413
         IC    @15,LMNRC                                           0413
         LA    @14,10                                              0413
         CR    @15,@14                                             0413
         BNL   *+6
         LR    @15,@14                                             0413
         STC   @15,LMNRC                                           0413
*     END;                          /*                       @Z67SP00*/
*   RETURN CODE(LMNRC);             /*                       @Z67SP00*/
@RC00391 SLR   @15,@15                                             0415
         IC    @15,LMNRC                                           0415
         L     @14,@SA00004                                        0415
         LM    @00,@12,@SA00004+8                                  0415
         BR    @14                                                 0415
*MODKEYGT:                                                         0416
*   MODKEYPT=SCPCHAR;               /* SAVE ADDR OF MOD= KEYWORD   0416
*                                                            @SA72421*/
MODKEYGT L     @15,SCPPTR                                          0416
         L     @14,SCPCHAR(,@15)                                   0416
         ST    @14,MODKEYPT                                        0416
*   SCPCHAR=SCPCHAR+LENGTH(MODKEY); /* BUMP PAST MOD KEYWORD         */
*                                                                  0417
         AL    @14,@CF00062                                        0417
         ST    @14,SCPCHAR(,@15)                                   0417
*   /*****************************************************************/
*   /*                                                               */
*   /* MOD NAME FOUND ON SYSLMOD OR MOD= KEYWORD FOUND NOW GET LMOD  */
*   /* NAME                                                  @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0418
*MODNMGT:                                                          0418
*   TEMPPTR1=SCPCHAR;               /* SAVE START OF NAME ADDR       */
MODNMGT  L     @01,SCPPTR                                          0418
         L     @15,SCPCHAR(,@01)                                   0418
         ST    @15,TEMPPTR1                                        0418
*   DO WHILE SCPSTRNG(1)^=IOPEOLST; /* BUMP & SCN FOR END    @Z40SP00*/
         B     @DE00419                                            0419
@DL00419 DS    0H                                                  0420
*     SCPCHAR=SCPCHAR+1;            /* BUMP STRING BASE FOR SCAN     */
         L     @15,SCPPTR                                          0420
         LA    @14,1                                               0420
         AL    @14,SCPCHAR(,@15)                                   0420
         ST    @14,SCPCHAR(,@15)                                   0420
*     IF SCPSTRNG(1)=COMMA          /* IS THIS A COMMA?      @Z40SP00*/
*         ×SCPSTRNG(1)=BLANK        /* OR BLANK?             @Z40SP00*/
*         ×SCPSTRNG(1)=RPAREN       /* OR RIGHT PAREN?       @Z40SP00*/
*       THEN                                                       0421
         CLI   SCPSTRNG(@14),C','                                  0421
         BE    @RT00421                                            0421
         CLI   SCPSTRNG(@14),C' '                                  0421
         BE    @RT00421                                            0421
         CLI   SCPSTRNG(@14),C')'                                  0421
         BE    @RT00421                                            0421
*       GO TO MODNMGT2;             /* YES - EXIT FROM LOOP          */
*   END;                                                           0423
*                                                                  0423
@DE00419 L     @15,SCPPTR                                          0423
         L     @01,SCPCHAR(,@15)                                   0423
         CLI   SCPSTRNG(@01),255                                   0423
         BNE   @DL00419                                            0423
*   /*****************************************************************/
*   /*                                                               */
*   /* UNABLE TO FIND LMOD NAME                              @SA72421*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0424
*   SCPCHAR=MODKEYPT;               /* POINT TO MOD= KEYWRD  @SA72421*/
         L     @14,MODKEYPT                                        0424
         ST    @14,SCPCHAR(,@15)                                   0424
*   CALL LKDERR(JCLLINE,INVALKEY);  /* FIND LINE IN ERR      @Z67SP00*/
         L     @15,@PC00001+8                                      0425
         LR    @00,@15                                             0425
         LCR   @00,@00                                             0425
         ALR   @00,@14                                             0425
         SRDA  @00,32                                              0425
         D     @00,@CF00538                                        0425
         SLR   @14,@00                                             0425
         ST    @14,@AL00001                                        0425
         LA    @15,INVALKEY                                        0425
         ST    @15,@AL00001+4                                      0425
         LA    @01,@AL00001                                        0425
         BAL   @14,LKDERR                                          0425
*   LMNRC=MAX(LMNRC,SYNTERR);       /* SET RC                @YA07506*/
*                                                                  0426
         SLR   @15,@15                                             0426
         IC    @15,LMNRC                                           0426
         LA    @14,10                                              0426
         CR    @15,@14                                             0426
         BNL   *+6
         LR    @15,@14                                             0426
         STC   @15,LMNRC                                           0426
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LMOD NAME FOUND THEN CALC LENGTH OF NAME           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   IF LMNRC=ZERO                   /* IF NAME FOUND         @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CLI   LMNRC,0                                             0427
         BNE   @RF00427                                            0427
*     DO;                           /*                       @Z67SP00*/
*MODNMGT2:                                                         0429
*       TEMPPTR2=SCPCHAR-TEMPPTR1;  /* CALCULATE CHAR LENGTH         */
MODNMGT2 L     @15,TEMPPTR1                                        0429
         L     @14,SCPPTR                                          0429
         L     @09,SCPCHAR(,@14)                                   0429
         SLR   @09,@15                                             0429
         ST    @09,TEMPPTR2                                        0429
*       SCPCHAR=TEMPPTR1;           /* POINT TO NAME OF LMOD         */
         ST    @15,SCPCHAR(,@14)                                   0430
*       SCPPMLN=TEMPPTR2;           /* INDICATE LENGTH FOR EXIT      */
         STH   @09,SCPPMLN(,@14)                                   0431
*       CALL RNAMEV;                /* GO STOW MODULES INTO CDS      */
         BAL   @14,RNAMEV                                          0432
*       IF SCPRET^=SCPGOOD          /* IF ERR IN STOW        @Z67SP00*/
*         THEN                      /*                               */
         L     @01,SCPPTR                                          0433
         CLI   SCPRET(@01),0                                       0433
         BE    @RF00433                                            0433
*         DO;                       /*                       @YA07506*/
*           IF INTERR=ON            /* INTERNAL ERROR?               */
*             THEN                  /* YES - MUST BE I/O ERROR       */
         TM    INTERR,B'10000000'                                  0435
         BNO   @RF00435                                            0435
*             DO;                   /*                       @Z67SP00*/
*               CALL LKDERR(CRPBUFFR,LASTLINE);/* ERR MSG    @Z67SP00*/
         L     @15,@PC00001+4                                      0437
         LA    @15,CRPBUFFR(,@15)                                  0437
         ST    @15,@AL00001                                        0437
         LA    @15,LASTLINE                                        0437
         ST    @15,@AL00001+4                                      0437
         LA    @01,@AL00001                                        0437
         BAL   @14,LKDERR                                          0437
*               LMNRC=MAX(LMNRC,STOPSMP);/*                  @Z67SP00*/
         SLR   @15,@15                                             0438
         IC    @15,LMNRC                                           0438
         LA    @14,16                                              0438
         CR    @15,@14                                             0438
         BNL   *+6
         LR    @15,@14                                             0438
         STC   @15,LMNRC                                           0438
*             END;                  /*                       @Z67SP00*/
*           ELSE                    /* NOT IO ERR            @SA72421*/
*             DO;                   /*                       @Z67SP00*/
         B     @RC00435                                            0440
@RF00435 DS    0H                                                  0441
*               CALL LKDERR(JCLLINE,STOWERR);/*              @Z67SP00*/
         L     @01,SCPPTR                                          0441
         L     @15,SCPCHAR(,@01)                                   0441
         L     @14,@PC00001+8                                      0441
         LR    @00,@14                                             0441
         LCR   @00,@00                                             0441
         ALR   @00,@15                                             0441
         SRDA  @00,32                                              0441
         D     @00,@CF00538                                        0441
         SLR   @15,@00                                             0441
         ST    @15,@AL00001                                        0441
         LA    @15,STOWERR                                         0441
         ST    @15,@AL00001+4                                      0441
         LA    @01,@AL00001                                        0441
         BAL   @14,LKDERR                                          0441
*               LMNRC=MAX(LMNRC,SYNTERR);/* SET RC           @YA07506*/
         SLR   @15,@15                                             0442
         IC    @15,LMNRC                                           0442
         LA    @14,10                                              0442
         CR    @15,@14                                             0442
         BNL   *+6
         LR    @15,@14                                             0442
         STC   @15,LMNRC                                           0442
*             END;                  /*                       @Z67SP00*/
*         END;                      /*                       @Z67SP00*/
@RC00435 DS    0H                                                  0445
*     END;                          /*                       @Z67SP00*/
*                                                                  0445
@RF00433 DS    0H                                                  0446
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0446
*   RETURN CODE(LMNRC);             /*                       @Z67SP00*/
@RF00427 SLR   @15,@15                                             0446
         IC    @15,LMNRC                                           0446
         L     @14,@SA00004                                        0446
         LM    @00,@12,@SA00004+8                                  0446
         BR    @14                                                 0446
*   END LKDLNAME;                   /*                       @Z67SP00*/
         EJECT
*                                                                  0448
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINES ENTERED DURING SCANNING OF JCL BUFFER        @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0448
*JCLROUTS:                          /*                       @Z67SP00*/
*   PROCEDURE;                      /*                       @Z67SP00*/
JCLROUTS STM   @14,@12,@SA00005                                    0448
*   DECLARE                         /*                       @Z67SP00*/
*     JRTRC FIXED(8);               /*                       @Z67SP00*/
*KEY010:                            /* RENT SPECIFIED                */
*   ENTRY;                          /*                       @Z67SP00*/
         B     @EC00450                                            0450
KEY010   STM   @14,@12,@SA00005                                    0450
@EC00450 DS    0H                                                  0451
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/
*     THEN                          /* YES                   @SA75303*/
         TM    PARMEQSW,B'10000000'                                0451
         BNO   @RF00451                                            0451
*     IOPRENT=ON;                   /* INDICATE RENT                 */
         L     @01,IOPPTR                                          0452
         OI    IOPRENT(@01),B'01000000'                            0452
*   GO TO SCANBMP;                  /* EXIT                          */
         B     SCANBMP                                             0453
*KEY020:                            /* REUS SPECIFIED                */
*   ENTRY;                          /*                       @Z67SP00*/
KEY020   STM   @14,@12,@SA00005                                    0454
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/
*     THEN                          /* YES                   @SA75303*/
         TM    PARMEQSW,B'10000000'                                0455
         BNO   @RF00455                                            0455
*     IOPREUS=ON;                   /* INDICATE REUS                 */
         L     @01,IOPPTR                                          0456
         OI    IOPREUS(@01),B'00100000'                            0456
*   GO TO SCANBMP;                  /* EXIT                          */
         B     SCANBMP                                             0457
*KEY030:                            /* SCTR SPECIFIED                */
*   ENTRY;                          /*                       @Z67SP00*/
KEY030   STM   @14,@12,@SA00005                                    0458
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/
*     THEN                          /* YES                   @SA75303*/
         TM    PARMEQSW,B'10000000'                                0459
         BNO   @RF00459                                            0459
*     IOPSCTR=ON;                   /* INDICATE SCTR                 */
         L     @01,IOPPTR                                          0460
         OI    IOPSCTR(@01),B'00010000'                            0460
*   GO TO SCANBMP;                  /* EXIT                          */
         B     SCANBMP                                             0461
*KEY040:                            /* OVLY SPECIFIED                */
*   ENTRY;                          /*                       @Z67SP00*/
KEY040   STM   @14,@12,@SA00005                                    0462
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/
*     THEN                          /* YES                   @SA75303*/
         TM    PARMEQSW,B'10000000'                                0463
         BNO   @RF00463                                            0463
*     IOPOVLY=ON;                   /* INDICATE OVLY                 */
         L     @01,IOPPTR                                          0464
         OI    IOPOVLY(@01),B'00001000'                            0464
*   GO TO SCANBMP;                  /* EXIT                          */
         B     SCANBMP                                             0465
*KEY050:                            /* REFR SPECIFIED                */
*   ENTRY;                          /*                       @Z67SP00*/
KEY050   STM   @14,@12,@SA00005                                    0466
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/
*     THEN                          /* YES                   @SA75303*/
         TM    PARMEQSW,B'10000000'                                0467
         BNO   @RF00467                                            0467
*     IOPREFR=ON;                   /* INDICATE REFR SPECIFIED       */
         L     @01,IOPPTR                                          0468
         OI    IOPREFR(@01),B'00000100'                            0468
*   GO TO SCANBMP;                  /* EXIT                          */
         B     SCANBMP                                             0469
*KEY060:                            /* DC SPECIFIED                  */
*   ENTRY;                          /*                       @Z67SP00*/
KEY060   STM   @14,@12,@SA00005                                    0470
*   IF SCPSTRNG(3)>=CHARA           /* IS NEXT CHAR ALPHABETIC?      */
*       &SCPSTRNG(3)<=CHARZ         /* HIGH RANGE FOR ALPHABETIC     */
*     THEN                          /* IF ALPHABETIC         @Z40SP00*/
         L     @01,SCPPTR                                          0471
         L     @15,SCPCHAR(,@01)                                   0471
         CLI   SCPSTRNG+2(@15),C'A'                                0471
         BL    @RF00471                                            0471
         CLI   SCPSTRNG+2(@15),C'Z'                                0471
         BNH   @RT00471                                            0471
*     GO TO JCLRTN;                 /* NOT NE SKIP           @Z40SP00*/
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/
*     THEN                          /* YES                   @SA75303*/
@RF00471 TM    PARMEQSW,B'10000000'                                0473
         BNO   @RF00473                                            0473
*     IOPDC=ON;                     /* INDICATE DC SPECIFIED         */
         L     @01,IOPPTR                                          0474
         OI    IOPDC(@01),B'00000010'                              0474
*   GO TO SCANBMP;                  /* EXIT                          */
         B     SCANBMP                                             0475
*KEY070:                            /* NE KEYWORD FOUND              */
*   ENTRY;                          /*                       @Z67SP00*/
KEY070   STM   @14,@12,@SA00005                                    0476
*   IF SCPSTRNG(3)>CHARA            /* IF NEXT CHAR IS ALPH  @ZA08843*/
*       &SCPSTRNG(3)<=CHAR9         /* OR NUMERIC            @ZA08843*/
*       &SCPSTRNG(3)^=BLANK         /* AND NOT BLANK         @ZA08843*/
*     THEN                          /* THEN NOT NE PARM      @ZA08843*/
         L     @01,SCPPTR                                          0477
         L     @15,SCPCHAR(,@01)                                   0477
         CLI   SCPSTRNG+2(@15),C'A'                                0477
         BNH   @RF00477                                            0477
         CLI   SCPSTRNG+2(@15),C'9'                                0477
         BH    @RF00477                                            0477
         CLI   SCPSTRNG+2(@15),C' '                                0477
         BNE   @RT00477                                            0477
*     GO TO JCLRTN;                 /* SKIP NE SETTING       @ZA08843*/
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/
*     THEN                          /* YES                   @SA75303*/
@RF00477 TM    PARMEQSW,B'10000000'                                0479
         BNO   @RF00479                                            0479
*     IOPNE=ON;                     /* NE SPECIFIED                  */
         L     @01,IOPPTR                                          0480
         OI    IOPNE(@01),B'10000000'                              0480
*   GO TO SCANBMP;                  /* EXIT TO CONTINUE              */
         B     SCANBMP                                             0481
*KEY075:                            /* APF PARM, AC=1 FOUND  @VS08700*/
*   ENTRY;                          /*                       @Z67SP00*/
KEY075   STM   @14,@12,@SA00005                                    0482
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/
*     THEN                          /* YES                   @SA75303*/
         TM    PARMEQSW,B'10000000'                                0483
         BNO   @RF00483                                            0483
*     IOPAPF=ON;                    /* INDICATE APF IN IOP   @VS08700*/
         L     @01,IOPPTR                                          0484
         OI    IOPAPF(@01),B'10000000'                             0484
*   GO TO SCANBMP;                  /* EXIT                  @VS08700*/
         B     SCANBMP                                             0485
*KEY080:                            /* SYSLMOD DD FOUND              */
*   ENTRY;                          /*                       @Z67SP00*/
KEY080   STM   @14,@12,@SA00005                                    0486
*   SYSLSW=ON;                      /* INDICATE SYSLMOD FOUND        */
         OI    SYSLSW,B'00010000'                                  0487
*   GO TO SCANBMP;                  /* RETURN TO CONTINUE            */
         B     SCANBMP                                             0488
*                                                                  0489
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTS TO SAVE SYSTEM LIBRARY NAME                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0489
*KEY090:                            /* DSN= KEYWORD FOUND            */
*   ENTRY;                          /*                       @Z67SP00*/
KEY090   STM   @14,@12,@SA00005                                    0489
*   IF SYSLSW=OFF                   /* IF SYSLMOD NOT FOUND          */
*     THEN                          /* THEN RETURN                   */
         TM    SYSLSW,B'00010000'                                  0490
         BZ    @RT00490                                            0490
*     GO TO SCANBMP;                /*                       @Z67SP00*/
*   SYSLADDR=SCPCHAR;               /* SAVE ADDR OF SYSLMOD          */
         L     @01,SCPPTR                                          0492
         L     @15,SCPCHAR(,@01)                                   0492
         ST    @15,SYSLADDR                                        0492
*KEY100:                            /* NAME= KEYWORD FOUND           */
*   ENTRY;                          /*                       @Z67SP00*/
         B     @EC00493                                            0493
KEY100   STM   @14,@12,@SA00005                                    0493
@EC00493 DS    0H                                                  0494
*   IF SYSTSW=ON                    /* IS SYSTEM LIBRARY FOUND?      */
*     THEN                          /* THEN RETURN                   */
         TM    SYSTSW,B'00001000'                                  0494
         BO    @RT00494                                            0494
*     GO TO SCANBMP;                /*                       @Z67SP00*/
*   SCPCHAR=SCPCHAR+KEYLEN(TEMPPTR1);/* BUMP PAST KEYWORD            */
*                                                                  0496
         L     @15,SCPPTR                                          0496
         L     @14,TEMPPTR1                                        0496
         MH    @14,@CH00466                                        0496
         SLR   @09,@09                                             0496
         IC    @09,KEYLEN-13(@14)                                  0496
         AL    @09,SCPCHAR(,@15)                                   0496
         ST    @09,SCPCHAR(,@15)                                   0496
*   /*****************************************************************/
*   /*                                                               */
*   /* PICK OFF THE SYSTEM LIBRARY FROM THE JCL                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0497
*   SYSLSW=OFF;                     /* TURN OFF SYSLMOD SWITCH       */
         NI    SYSLSW,B'11101111'                                  0497
*PICKLIB1:                                                         0498
*   TEMPPTR1=SCPCHAR;               /* SAVE CURRENT STRING PTR       */
PICKLIB1 L     @01,SCPPTR                                          0498
         L     @15,SCPCHAR(,@01)                                   0498
         ST    @15,TEMPPTR1                                        0498
*   DO J=0 TO 8;                    /* LOOP THROUGH TO FIND END      */
         SLR   @15,@15                                             0499
         ST    @15,J                                               0499
@DL00499 DS    0H                                                  0500
*     IF SCPSTRNG(1)=BLANK×         /* BLANK?                @Z40SP00*/
*         SCPSTRNG(1)=COMMA×        /* OR COMMA?             @Z40SP00*/
*         SCPSTRNG(1)=QUOTE×        /* OR QUOTE?             @Z40SP00*/
*         SCPSTRNG(1)=LPAREN        /* START OF MEMBER NAME  @Z40SP00*/
*       THEN                        /* THEN EXIT FROM LOOP           */
         L     @15,SCPPTR                                          0500
         L     @14,SCPCHAR(,@15)                                   0500
         CLI   SCPSTRNG(@14),C' '                                  0500
         BE    @RT00500                                            0500
         CLI   SCPSTRNG(@14),C','                                  0500
         BE    @RT00500                                            0500
         CLI   SCPSTRNG(@14),C''''                                 0500
         BE    @RT00500                                            0500
         CLI   SCPSTRNG(@14),C'('                                  0500
         BE    @RT00500                                            0500
*       GO TO PICKLIB2;             /*                       @Z67SP00*/
*     IF SCPSTRNG(1)=PERIOD         /* ANOTHER LEVEL OD DSN? @Z40SP00*/
*       THEN                        /* YES                   @SA71759*/
         CLI   SCPSTRNG(@14),C'.'                                  0502
         BNE   @RF00502                                            0502
*       DO;                         /*                       @SA72436*/
*         SCPCHAR=SCPCHAR+1;        /* UPDATE PTR TO CHAR    @SA72436*/
         AL    @14,@CF00048                                        0504
         ST    @14,SCPCHAR(,@15)                                   0504
*         GO TO PICKLIB1;           /* BRANCH TO PROCESS IT  @SA71759*/
         B     PICKLIB1                                            0505
*       END;                        /*                       @SA72436*/
*     SCPCHAR=SCPCHAR+1;            /* BUMP TO NEXT CHARACTER        */
@RF00502 L     @15,SCPPTR                                          0507
         LA    @14,1                                               0507
         AL    @14,SCPCHAR(,@15)                                   0507
         ST    @14,SCPCHAR(,@15)                                   0507
*   END;                                                           0508
         LA    @15,1                                               0508
         AL    @15,J                                               0508
         ST    @15,J                                               0508
         C     @15,@CF00043                                        0508
         BNH   @DL00499                                            0508
*PICKLIB2:                                                         0509
*   IF J=0                          /* NO DSNAME CODED?      @SA72436*/
*     THEN                          /* NO - ERR              @SA72436*/
PICKLIB2 L     @15,J                                               0509
         LTR   @15,@15                                             0509
         BNZ   @RF00509                                            0509
*     DO;                           /*                       @SA72421*/
*       CALL LKDERR(JCLLINE,NODSN); /* ERR MSG               @Z67SP00*/
         L     @01,SCPPTR                                          0511
         L     @15,SCPCHAR(,@01)                                   0511
         L     @14,@PC00001+8                                      0511
         LR    @00,@14                                             0511
         LCR   @00,@00                                             0511
         ALR   @00,@15                                             0511
         SRDA  @00,32                                              0511
         D     @00,@CF00538                                        0511
         SLR   @15,@00                                             0511
         ST    @15,@AL00001                                        0511
         LA    @15,NODSN                                           0511
         ST    @15,@AL00001+4                                      0511
         LA    @01,@AL00001                                        0511
         BAL   @14,LKDERR                                          0511
*       JRTRC=SYNTERR;              /* SET RC TO ERR         @Z67SP00*/
         MVI   JRTRC,X'0A'                                         0512
*       GO TO JCLRTN;               /*                       @Z67SP00*/
         B     JCLRTN                                              0513
*     END;                          /*                       @SA72421*/
*   SYSTLIB=TEMPPTR1->SCPSTRNG(1:J);/* GET LIB NAME          @Z40SP00*/
@RF00509 MVI   SYSTLIB+1,C' '                                      0515
         MVC   SYSTLIB+2(6),SYSTLIB+1                              0515
         L     @15,J                                               0515
         BCTR  @15,0                                               0515
         L     @01,TEMPPTR1                                        0515
         EX    @15,@SM01737                                        0515
*   SYSTSW=ON;                      /* INDICATE SYSTEM LIBRARY GOTTEN*/
         OI    SYSTSW,B'00001000'                                  0516
*   GO TO JCLRTN0;                  /* LOOK FOR NEXT KEYWORD         */
         B     JCLRTN0                                             0517
*                                                                  0518
*   /*****************************************************************/
*   /*                                                               */
*   /* ALIGN2 LKED OPTION SCAN ROUTINE                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0518
*KEY110:                                                           0518
*   ENTRY;                          /*                       @Z67SP00*/
KEY110   STM   @14,@12,@SA00005                                    0518
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/
*     THEN                          /* YES                   @SA75303*/
         TM    PARMEQSW,B'10000000'                                0519
         BNO   @RF00519                                            0519
*     IOPPAGA=ON;                   /* TURN ON LMOD ALIGN2 BIT     0520
*                                                            @XA05949*/
         L     @01,IOPPTR                                          0520
         OI    IOPPAGA(@01),B'01000000'                            0520
*   GO TO SCANBMP;                  /* EXIT                  @XA05949*/
*                                                                  0521
         B     SCANBMP                                             0521
*   /*****************************************************************/
*   /*                                                               */
*   /* COND= PARAMETER FOUND                                 @SA75303*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0522
*KEY120:                            /*                       @SA75303*/
*   ENTRY;                          /*                       @Z67SP00*/
KEY120   STM   @14,@12,@SA00005                                    0522
*   PARMEQSW=OFF;                   /* LINK-EDIT ATTRIBUTES ARE NOW
*                                      INVALID               @SA75303*/
         NI    PARMEQSW,B'01111111'                                0523
*   GO TO SCANBMP;                  /* EXIT                  @SA75303*/
*                                                                  0524
         B     SCANBMP                                             0524
*   /*****************************************************************/
*   /*                                                               */
*   /* PARM= PARAMETER FOUND                                 @SA75303*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0525
*KEY130:                            /*                       @SA75303*/
*   ENTRY;                          /*                       @Z67SP00*/
KEY130   STM   @14,@12,@SA00005                                    0525
*   IF SCPSTRNG(5)='='              /* IF PARM=              @ZA17731*/
*     THEN                          /* THEN                  @ZA17731*/
         L     @01,SCPPTR                                          0526
         L     @01,SCPCHAR(,@01)                                   0526
         CLI   SCPSTRNG+4(@01),C'='                                0526
         BNE   @RF00526                                            0526
*     PARMEQSW=ON;                  /* LINK-EDIT ATTRIBUTES ARE NOW
*                                      VALID                 @ZA17731*/
         OI    PARMEQSW,B'10000000'                                0527
*   GO TO SCANBMP;                  /* EXIT                  @SA75303*/
*                                                                  0528
         B     SCANBMP                                             0528
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON RETURN POINTS FOR ALL JCL SCAN ROUTS           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0529
*SCANBMP:                           /* BUMP THE SCAN PTR AFTER HIT   */
*   SCPCHAR=SCPCHAR+KEYLEN(TEMPPTR1);/* INCR PAST KEY                */
SCANBMP  L     @15,SCPPTR                                          0529
         L     @14,TEMPPTR1                                        0529
         MH    @14,@CH00466                                        0529
         SLR   @09,@09                                             0529
         IC    @09,KEYLEN-13(@14)                                  0529
         AL    @09,SCPCHAR(,@15)                                   0529
         ST    @09,SCPCHAR(,@15)                                   0529
*JCLRTN0:                           /*                       @Z67SP00*/
*   JRTRC=ZERO;                     /*                       @Z67SP00*/
JCLRTN0  MVI   JRTRC,X'00'                                         0530
*JCLRTN:                            /*                       @Z67SP00*/
*   RETURN CODE(JRTRC);             /*                       @Z67SP00*/
JCLRTN   SLR   @15,@15                                             0531
         IC    @15,JRTRC                                           0531
         L     @14,@SA00005                                        0531
         LM    @00,@12,@SA00005+8                                  0531
         BR    @14                                                 0531
*   END JCLROUTS;                   /* END JCL SCAN ROUTS    @Z67SP00*/
         EJECT
*                                                                  0533
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS DLIB NAME FROM INCLUDE STATEMENT              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0533
*RDLIBV:                                                           0533
*   PROCEDURE;                                                     0533
RDLIBV   STM   @14,@12,@SA00006                                    0533
*   DLIBN=SCPSTRNG(1:SCPPMLN);      /* SAVE DIST LIB         @Z40SP00*/
         MVI   DLIBN+1,C' '                                        0534
         MVC   DLIBN+2(6),DLIBN+1                                  0534
         L     @15,SCPPTR                                          0534
         LH    @14,SCPPMLN(,@15)                                   0534
         BCTR  @14,0                                               0534
         L     @01,SCPCHAR(,@15)                                   0534
         EX    @14,@SM01740                                        0534
*   IF DLIBN=PARMLIB                /* IS THIS PARMLIB?              */
*     THEN                          /* YES - MUST WRITE INCLUDE STMT */
         CLC   DLIBN(8),@CC01422                                   0535
         BNE   @RF00535                                            0535
*     DO;                           /* TO CDS                        */
*       INCLPARM=ON;                /* INDICATE PARMLIB INCLUDE FOUND
*                                                            @XA07462*/
         OI    INCLPARM,B'00000100'                                0537
*       CCORDER=CCOTHR;             /* CONTROL CARD          @Z67SP00*/
         MVI   CCORDER,X'01'                                       0538
*       CALL RLKDSVCC;              /* WRITE STMT TO CDS             */
         BAL   @14,RLKDSVCC                                        0539
*       RFY                         /*                       @Z67SP00*/
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       SCPRETRN=RTNCODE;           /*                       @Z67SP00*/
         L     @14,SCPPTR                                          0541
         STC   RTNCODE,SCPRETRN(,@14)                              0541
*       RFY                         /*                       @Z67SP00*/
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*     END;                                                         0543
*   ELSE                            /*                       @Z67SP00*/
*     IF DLIBN=SYSLMOD              /* IS THIS SYSLMOD?              */
*       THEN                        /* YES, MUST IGNORE IT           */
         B     @RC00535                                            0544
@RF00535 CLC   DLIBN(8),@CC01424                                   0544
         BNE   @RF00544                                            0544
*       DO;                         /*                       @XA07462*/
*         INCLSYSL=ON;              /* INDICATE SYSLMOD INCLUDE FOUND
*                                                            @XA07462*/
         OI    INCLSYSL,B'00000010'                                0546
*         SCPRET=SCPNDSCN;          /* STOP SCN              @YA07506*/
         L     @01,SCPPTR                                          0547
         MVI   SCPRET(@01),X'04'                                   0547
*       END;                        /*                       @XA07462*/
*     ELSE                          /* OTHERWISE CONTINUE            */
*       INCLFND=ON;                 /* IND. ANY INCLUDE FOUND      0549
*                                                            @XA07462*/
         B     @RC00544                                            0549
@RF00544 OI    INCLFND,B'00000001'                                 0549
*   END RDLIBV;                     /* RETURN TO SCAN                */
@EL00006 DS    0H                                                  0550
@EF00006 DS    0H                                                  0550
@ER00006 LM    @14,@12,@SA00006                                    0550
         BR    @14                                                 0550
         EJECT
*                                                                  0551
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS MODULE NAMES FROM INCLUDE STATEMENT           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0551
*RCSECTV:                                                          0551
*   PROCEDURE;                      /*                       @Z67SP00*/
RCSECTV  STM   @14,@12,@SA00007                                    0551
*   DECLARE                         /*                       @Z67SP00*/
*     SAVSEQNO FIXED(31);           /*                       @Z67SP00*/
*   RFY                                                            0553
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/
*   CSECTN=SCPSTRNG(1:SCPPMLN);     /* SAVE MODULE NAME      @Z67SP00*/
         MVI   CSECTN+1,C' '                                       0554
         MVC   CSECTN+2(6),CSECTN+1                                0554
         L     @15,SCPPTR                                          0554
         LH    @14,SCPPMLN(,@15)                                   0554
         BCTR  @14,0                                               0554
         L     @01,SCPCHAR(,@15)                                   0554
         EX    @14,@SM01742                                        0554
*   DLIBN=DLIBN;                    /* SAVE DLIB NAME        @Z67SP00*/
         MVC   @TS00001(8),DLIBN                                   0555
         MVC   DLIBN(8),@TS00001                                   0555
*   GTPPTR=ADDR(MDDLBGTP);          /* BASE FOR GTP          @Z67SP00*/
         LA    @15,MDDLBGTP                                        0556
         ST    @15,GTPPTR                                          0556
*   GTPFUNCT=GTPADD;                /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'04'                                 0557
*   CALL HMASMGTA(HMASMGTP);        /* SAVE MOD/DLIB PAIR    @Z67SP00*/
         ST    @15,@AL00001                                        0558
         L     @15,@CV01384                                        0558
         LA    @01,@AL00001                                        0558
         BALR  @14,@15                                             0558
*   IF GTPRETRN=GTPGOOD             /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @01,GTPPTR                                          0559
         CLI   GTPRETRN(@01),0                                     0559
         BNE   @RF00559                                            0559
*     DO;                           /*                       @Z67SP00*/
*       IF CHREPFND=ON              /* IF CH/REP STMT FOUND  @Z67SP00*/
*         THEN                      /* BEFORE THIS INCLUDE   @Z67SP00*/
         TM    CHREPFND,B'00100000'                                0561
         BNO   @RF00561                                            0561
*         DO;                       /*                       @Z67SP00*/
*           CHREPFND=OFF;           /* RESET SW              @Z67SP00*/
         NI    CHREPFND,B'11011111'                                0563
*           GTPPTR=ADDR(CCGTP);     /* CONTROL CARD GTP      @Z67SP00*/
         LA    @15,CCGTP                                           0564
         ST    @15,GTPPTR                                          0564
*           GTPFUNCT=GTPLOC;        /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'03'                                 0565
*           SAVSEQNO=CCSEQNO;       /* SAVE CURRENT SEQ NUM  @Z67SP00*/
         MVC   SAVSEQNO(4),CCSEQNO                                 0566
*           CCSEQNO=CHRSEQNO;       /* FIND MOD CONTROL RCD  @Z67SP00*/
         MVC   CCSEQNO(4),CHRSEQNO                                 0567
*           CCORDER=CCCHRP;         /* CHREP TYPE CARD       @Z67SP00*/
         MVI   CCORDER,X'02'                                       0568
*           CALL HMASMGTA(HMASMGTP);/* FOR THE SET OF CH/REP @Z67SP00*/
         ST    @15,@AL00001                                        0569
         L     @15,@CV01384                                        0569
         LA    @01,@AL00001                                        0569
         BALR  @14,@15                                             0569
*           IF GTPRETRN=GTPGOOD     /* STATEMENTS. IF FOUND  @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         L     @15,GTPPTR                                          0570
         CLI   GTPRETRN(@15),0                                     0570
         BNE   @RF00570                                            0570
*             DO;                   /*                       @Z67SP00*/
*               CCMOD=CSECTN;       /* PUT MOD NAME IN RCD   @Z67SP00*/
         MVC   CCMOD(8),CSECTN                                     0572
*               CCDLIB=DLIBN;       /* PUT IN MODS DLIB      @Z67SP00*/
         MVC   CCDLIB(8),DLIBN                                     0573
*               GTPFUNCT=GTPADD;    /* UPDATE GTA FILE       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'04'                                 0574
*               CALL HMASMGTA(HMASMGTP);/*                   @Z67SP00*/
         ST    @15,@AL00001                                        0575
         L     @15,@CV01384                                        0575
         LA    @01,@AL00001                                        0575
         BALR  @14,@15                                             0575
*             END;                  /*                       @Z67SP00*/
*           SCPRETRN=GTPRETRN;      /* SAVE RC               @Z67SP00*/
@RF00570 L     @01,GTPPTR                                          0577
         IC    @00,GTPRETRN(,@01)                                  0577
         L     @01,SCPPTR                                          0577
         STC   @00,SCPRETRN(,@01)                                  0577
*           CCSEQNO=SAVSEQNO;       /* RESTORE SEQ NO        @Z67SP00*/
         MVC   CCSEQNO(4),SAVSEQNO                                 0578
*         END;                      /* END CH/REP FOUND      @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /* UNABLE TO STORE MOD   @Z67SP00*/
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         B     @RC00559                                            0581
@RF00559 L     @01,SCPPTR                                          0581
         MVI   SCPRETRN(@01),X'08'                                 0581
*   END RCSECTV;                    /* RETURN                        */
@EL00007 DS    0H                                                  0582
@EF00007 DS    0H                                                  0582
@ER00007 LM    @14,@12,@SA00007                                    0582
         BR    @14                                                 0582
         EJECT
*                                                                  0583
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED WHEN CHANGE/REP STATEMENT FOUND. AT FIRST      */
*   /* CH/REP FOUND WRITE AN ADDITIONAL RCD TO GTA FILE TO BE USED TO*/
*   /* FILL IN THE MODULE NAME WHEN THE NEXT INCLUDE CARD IS FOUND.  */
*   /* THEN WRITE CH/REP CARD TO GTA FILE.                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0583
*RCHANGE:                                                          0583
*RREPLACE:                                                         0583
*   PROCEDURE;                      /*                       @Z67SP00*/
RCHANGE  DS    0H                                                  0583
RREPLACE STM   @14,@12,@SA00008                                    0583
*   CHREPFLG=ON;                    /* INDICATE CHANGE/REPLACE CARDS */
         OI    CHREPFLG,B'01000000'                                0584
*   IOPBUFAD=ADDR(CRPBUFFR);        /* SET PTR FOR RLKDSVCC  @Z67SP00*/
*                                                                  0585
         L     @15,@PC00001+4                                      0585
         LA    @14,CRPBUFFR(,@15)                                  0585
         L     @01,IOPPTR                                          0585
         ST    @14,IOPBUFAD(,@01)                                  0585
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FIRST CH/REP THEN WRITE ADDITIONAL RCD             @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0586
*   IF CHREPFND=OFF                 /* IF FIRST TIME         @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    CHREPFND,B'00100000'                                0586
         BNZ   @RF00586                                            0586
*     DO;                           /*                       @Z67SP00*/
*       SAVRCD1=CRPBUFFR;           /* SAVE BUFFR ACROSS CAL @Z67SP00*/
         MVC   SAVRCD1(80),CRPBUFFR(@15)                           0588
*       IOPLMCTL=BLANK;             /* INIT BUFFER TO SAVE   @Z67SP00*/
         MVI   IOPLMCTL+1(@14),C' '                                0589
         MVC   IOPLMCTL+2(78,@14),IOPLMCTL+1(@14)                  0589
         MVI   IOPLMCTL(@14),C' '                                  0589
*       IOPLMCC=IOPLMCRM;           /* CONTROL FOR CH/REP    @Z67SP00*/
         MVI   IOPLMCC(@14),C'*'                                   0590
*       CHREPFND=ON;                /*                       @Z67SP00*/
         OI    CHREPFND,B'00100000'                                0591
*       CCORDER=CCCHRP;             /* CHANGE/REP CRAD       @Z67SP00*/
         MVI   CCORDER,X'02'                                       0592
*       CALL RLKDSVCC;              /* SAVE IT               @Z67SP00*/
         BAL   @14,RLKDSVCC                                        0593
*       RFY                                                        0594
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       SCPRETRN=RTNCODE;           /*                       @Z67SP00*/
         L     @14,SCPPTR                                          0595
         STC   RTNCODE,SCPRETRN(,@14)                              0595
*       RFY                                                        0596
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*       CHRSEQNO=CCSEQNO;           /* SAVE CARD NUMBER      @Z67SP00*/
         MVC   CHRSEQNO(4),CCSEQNO                                 0597
*       CRPBUFFR=SAVRCD1;           /* RESTORE OLD RECORD    @Z67SP00*/
         L     @15,@PC00001+4                                      0598
         MVC   CRPBUFFR(80,@15),SAVRCD1                            0598
*     END;                          /*                       @Z67SP00*/
*                                                                  0599
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PREV FUNCTIONS OK THEN SAVE CH/REP                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0600
*   IF SCPRETRN=SCPGOOD             /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00586 L     @01,SCPPTR                                          0600
         CLI   SCPRETRN(@01),0                                     0600
         BNE   @RF00600                                            0600
*     DO;                           /*                       @Z67SP00*/
*WRITECC:                           /*                       @Z67SP00*/
*       IOPLMCC=IOPLMCRC;           /* CH/REP CARD           @Z67SP00*/
WRITECC  L     @01,IOPPTR                                          0602
         L     @01,IOPBUFAD(,@01)                                  0602
         MVI   IOPLMCC(@01),C'@'                                   0602
*       CCORDER=CCCHRP;             /* CHANGE/REP CRAD       @Z67SP00*/
         MVI   CCORDER,X'02'                                       0603
*       CALL RLKDSVCC;              /*                       @Z67SP00*/
         BAL   @14,RLKDSVCC                                        0604
*       RFY                                                        0605
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       SCPRETRN=RTNCODE;           /*                       @Z67SP00*/
         L     @14,SCPPTR                                          0606
         STC   RTNCODE,SCPRETRN(,@14)                              0606
*       RFY                                                        0607
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*       IF SCPRETRN=SCPGOOD         /*                       @Z67SP00*/
*           &CRPBFCNT^=BLANK        /* IF CH/REP CONTINUED   @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         CLI   SCPRETRN(@14),0                                     0608
         BNE   @RF00608                                            0608
         L     @15,@PC00001+4                                      0608
         CLI   CRPBFCNT(@15),C' '                                  0608
         BE    @RF00608                                            0608
*         DO;                       /*                       @Z67SP00*/
*           CALL HMASMCRD(HMASMCRP);/* READ CONTINUATION     @Z67SP00*/
         ST    @15,@AL00001                                        0610
         L     @15,@CV01383                                        0610
         LA    @01,@AL00001                                        0610
         BALR  @14,@15                                             0610
*           IF CRPRETRN=CRPGOOD     /* IF READ OK            @Z67SP00*/
*             THEN                  /* THEN                  @Z67SP00*/
         L     @15,@PC00001+4                                      0611
         CLI   CRPRETRN(@15),0                                     0611
         BE    @RT00611                                            0611
*             GO TO WRITECC;        /* WRITE IT              @Z67SP00*/
*           INTERR=ON;              /* SET ERR FOUND         @Z67SP00*/
         OI    INTERR,B'10000000'                                  0613
*           IF CRPRETRN=CRPEOF      /* IF END OF FILE        @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         CLI   CRPRETRN(@15),4                                     0614
         BNE   @RF00614                                            0614
*             SCPRETRN=SCPSTOP;     /* STOP SCAN             @Z67SP00*/
         L     @01,SCPPTR                                          0615
         MVI   SCPRETRN(@01),X'08'                                 0615
*           ELSE                    /*                       @Z67SP00*/
*             SCPRETRN=CRPRETRN;    /* SAVE RC               @Z67SP00*/
         B     @RC00614                                            0616
@RF00614 L     @15,@PC00001+4                                      0616
         IC    @14,CRPRETRN(,@15)                                  0616
         L     @15,SCPPTR                                          0616
         STC   @14,SCPRETRN(,@15)                                  0616
*         END;                      /*                       @Z67SP00*/
@RC00614 DS    0H                                                  0618
*     END;                          /*                       @Z67SP00*/
@RF00608 DS    0H                                                  0619
*   IF SCPRETRN^=SCPGOOD            /* IF NO ERR IN PROCESS  @Z67SP00*/
*     THEN                          /* THEN RESET TO         @Z67SP00*/
@RF00600 L     @15,SCPPTR                                          0619
         CLI   SCPRETRN(@15),0                                     0619
         BE    @RF00619                                            0619
*     SCPRETRN=SCPNDSCN;            /* STOP SCAN             @Z67SP00*/
         MVI   SCPRETRN(@15),X'04'                                 0620
*   IOPBUFAD=SAVBUFAD;              /* RESET BUFFER          @Z67SP00*/
@RF00619 L     @15,SAVBUFAD                                        0621
         L     @14,IOPPTR                                          0621
         ST    @15,IOPBUFAD(,@14)                                  0621
*   END RCHANGE;                    /* RETURN TO SCAN                */
@EL00008 DS    0H                                                  0622
@EF00008 DS    0H                                                  0622
@ER00008 LM    @14,@12,@SA00008                                    0622
         BR    @14                                                 0622
         EJECT
*                                                                  0623
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO SAVE LINK EDIT CONTROL CARDS IN GTA FILE.   */
*   /* CARDS ARE SAVED IN ORDER OF PROCESSING BY ASSIGNING EACH CARD */
*   /* A SEQUENCE NUMBER WHICH THEN BECOMES THE KEY INTO THE GTA     */
*   /* FILE.                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0623
*RLKDSVCC:                                                         0623
*   PROCEDURE;                      /*                       @Z67SP00*/
RLKDSVCC STM   @14,@12,@SA00009                                    0623
*   RFY                                                            0624
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/
*   CCSEQNO=CCSEQNO+1;              /*                       @Z67SP00*/
         LA    @15,1                                               0625
         ICM   @14,15,CCSEQNO                                      0625
         ALR   @15,@14                                             0625
         STCM  @15,15,CCSEQNO                                      0625
*   CCDATA=CRPBUFFR;                /* MOVE INPUT BUFFER     @Z67SP00*/
         L     @15,@PC00001+4                                      0626
         MVC   CCDATA(80),CRPBUFFR(@15)                            0626
*   GTPPTR=ADDR(CCGTP);             /* CONTROL CARD GTP      @Z67SP00*/
         LA    @15,CCGTP                                           0627
         ST    @15,GTPPTR                                          0627
*   GTPFUNCT=GTPADD;                /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'04'                                 0628
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/
         ST    @15,@AL00001                                        0629
         L     @15,@CV01384                                        0629
         LA    @01,@AL00001                                        0629
         BALR  @14,@15                                             0629
*   IF GTPRETRN^=GTPGOOD            /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @01,GTPPTR                                          0630
         CLI   GTPRETRN(@01),0                                     0630
         BE    @RF00630                                            0630
*     CALL LKDERR(CRPBUFFR,LASTLINE);/* WRITE ERR            @Z67SP00*/
         L     @15,@PC00001+4                                      0631
         LA    @15,CRPBUFFR(,@15)                                  0631
         ST    @15,@AL00001                                        0631
         LA    @15,LASTLINE                                        0631
         ST    @15,@AL00001+4                                      0631
         LA    @01,@AL00001                                        0631
         BAL   @14,LKDERR                                          0631
*   CCENTRD=ON;                     /* CONTROL CARD ENTERED  @Z67SP00*/
@RF00630 OI    CCENTRD,B'00001000'                                 0632
*   RETURN CODE(GTPRETRN);          /* RETURN WITH GTA RC    @Z67SP00*/
         L     @01,GTPPTR                                          0633
         SLR   @15,@15                                             0633
         IC    @15,GTPRETRN(,@01)                                  0633
         L     @14,@SA00009                                        0633
         LM    @00,@12,@SA00009+8                                  0633
         BR    @14                                                 0633
*   END RLKDSVCC;                   /* RETURN TO SCAN                */
         EJECT
*                                                                  0635
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED WHEN NAME CARD ENCOUNTERED OR AFTER ALL LKED   */
*   /* CONTROL CARDS READ AND LMOD NAME FOUND IN JCL. THIS ROUTINE   */
*   /* TAKES ALL THE CONTROL CARDS SAVED IN THE GTA FILE AND WRITES  */
*   /* THEM OUT TO THE CDS. IF REQUIRED THE CHANGE/REPLACE CARD      */
*   /* ENTERED THIS TIME ARE MERGED WITH THE ONES IN THE CDS @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0635
*RNAMEV:                            /*                       @Z67SP00*/
*   PROCEDURE;                      /*                       @Z67SP00*/
*                                                                  0635
RNAMEV   STM   @14,@12,@SA00010                                    0635
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE LMOD ON CDS AND IF FOUND MERGE ANY CHANGE/REPLACE CARDS*/
*   /* FOR AND MODULES NOT INCLUDED THIS TIME WITH THOSE IN THE CDS  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0636
*   SCPRETRN=SCPGOOD;               /* INIT RC IN CASE NOT CALLED  0636
*                                      FROM SCAN             @Z67SP00*/
         L     @15,SCPPTR                                          0636
         MVI   SCPRETRN(@15),X'00'                                 0636
*   LMODNAM=SCPSTRNG(1:SCPPMLN);    /* SAVE LMOD NAME        @Z67SP00*/
         MVI   LMODNAM+1,C' '                                      0637
         MVC   LMODNAM+2(6),LMODNAM+1                              0637
         LH    @14,SCPPMLN(,@15)                                   0637
         BCTR  @14,0                                               0637
         L     @01,SCPCHAR(,@15)                                   0637
         EX    @14,@SM01745                                        0637
*   IF LMODNAM(1:7)=IEANUC0         /* ONLY SUPPOTR 1 NUC    @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CLC   LMODNAM(7),@CC01418                                 0638
         BNE   @RF00638                                            0638
*     LMODNAM(8)=CHAR1;             /*                       @Z67SP00*/
         MVI   LMODNAM+7,C'1'                                      0639
*   IOPTYPE=IOPLMD;                 /*                       @Z67SP00*/
@RF00638 L     @15,IOPPTR                                          0640
         MVI   IOPTYPE(@15),X'02'                                  0640
*   IOPNAME=LMODNAM;                /*                       @Z67SP00*/
         MVC   IOPNAME(8,@15),LMODNAM                              0641
*   IOPDSID=IOPCDS;                 /*                       @Z67SP00*/
         MVI   IOPDSID(@15),X'02'                                  0642
*   IOPFUNCT=IOPLOC;                /*                       @Z67SP00*/
         MVI   IOPFUNCT(@15),X'03'                                 0643
*   LMDFND=OFF;                     /* SET LMOD NOT FOUND SW @Z67SP00*/
         NI    LMDFND,B'11111101'                                  0644
*   CALL HMASMIO(HMASMIOP);         /* LOCATE LMOD ON CDS    @Z67SP00*/
         ST    @15,@AL00001                                        0645
         L     @15,@CV01382                                        0645
         LA    @01,@AL00001                                        0645
         BALR  @14,@15                                             0645
*   IF IOPRETRN=IOPGOOD             /* IF FOUND              @Z67SP00*/
*     THEN                          /* PROCESS CHANGE REP    @Z67SP00*/
         L     @15,IOPPTR                                          0646
         CLI   IOPRETRN(@15),0                                     0646
         BNE   @RF00646                                            0646
*     DO;                           /*                       @Z67SP00*/
*       LMDFND=ON;                  /*                       @Z67SP00*/
         OI    LMDFND,B'00000010'                                  0648
*       IF IOPCHREP=ON              /* AND LMOD HAD CH/REPS  @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         TM    IOPCHREP(@15),B'00100000'                           0649
         BNO   @RF00649                                            0649
*         DO;                       /*                       @Z67SP00*/
*                                                                  0650
*           /*********************************************************/
*           /*                                                       */
*           /* READ ALL CONTROL CARDS AND SAVE CH/REP CARDS FOR MODS */
*           /* NOT LINKED THIS TIME IN CC GTP                @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0651
*           GTPPTR=ADDR(CCGTP);     /*                       @Z67SP00*/
         LA    @14,CCGTP                                           0651
         ST    @14,GTPPTR                                          0651
*           SAVRCD1=CRPBUFFR;       /* SAVE RCD IN BUFFER    @Z67SP00*/
         L     @14,@PC00001+4                                      0652
         MVC   SAVRCD1(80),CRPBUFFR(@14)                           0652
*           IOPBUFAD=ADDR(CRPBUFFR);/* INPUT BUFFER ADDR     @Z67SP00*/
         LA    @14,CRPBUFFR(,@14)                                  0653
         ST    @14,IOPBUFAD(,@15)                                  0653
*           IOPFUNCT=IOPREAD;       /*                       @Z67SP00*/
         MVI   IOPFUNCT(@15),X'01'                                 0654
*           CALL HMASMIO(HMASMIOP); /* PRIME BUFFER          @Z67SP00*/
         ST    @15,@AL00001                                        0655
         L     @15,@CV01382                                        0655
         LA    @01,@AL00001                                        0655
         BALR  @14,@15                                             0655
*           DO WHILE(               /* LOOP                  @Z67SP00*/
*                 IOPRETRN=IOPGOOD  /* TILL ERR OR EOF       @Z67SP00*/
*                 &GTPRETRN=GTPGOOD);/* AND ABLE TO SAVE CC  @Z67SP00*/
         B     @DE00656                                            0656
@DL00656 DS    0H                                                  0657
*             IF IOPLMCC=IOPLMCRM   /* IF MOD FOR CH/REPS    @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
         L     @01,IOPPTR                                          0657
         L     @15,IOPBUFAD(,@01)                                  0657
         CLI   IOPLMCC(@15),C'*'                                   0657
         BNE   @RF00657                                            0657
*               DO;                 /*                       @Z67SP00*/
*                 GTPPTR=ADDR(MDDLBGTP);/*                   @Z67SP00*/
         LA    @14,MDDLBGTP                                        0659
         ST    @14,GTPPTR                                          0659
*                 GTPFUNCT=GTPLOC;  /*                       @Z67SP00*/
         MVI   GTPFUNCT(@14),X'03'                                 0660
*                 CSECTN=IOPLMCRN;  /* SEE IF MOD WAS LINKED @Z67SP00*/
         MVC   CSECTN(8),IOPLMCRN(@15)                             0661
*                 CALL HMASMGTA(HMASMGTP);/* LOC CSECT       @Z67SP00*/
         ST    @14,@AL00001                                        0662
         L     @15,@CV01384                                        0662
         LA    @01,@AL00001                                        0662
         BALR  @14,@15                                             0662
*                 IF GTPRETRN=GTPNTFND/* IF NOT FOUND        @Z67SP00*/
*                   THEN            /*                       @Z67SP00*/
         L     @01,GTPPTR                                          0663
         CLI   GTPRETRN(@01),4                                     0663
         BNE   @RF00663                                            0663
*                   DO;             /*                       @Z67SP00*/
*                     CCORDER=CCCHRP;/* CH/REP CARD          @Z67SP00*/
         MVI   CCORDER,X'02'                                       0665
*                     CALL RLKDSVCC;/* SAVE CONTROL CARD     @Z67SP00*/
         BAL   @14,RLKDSVCC                                        0666
*                     RFY                                          0667
*                       RTNCODE RSTD;/*                      @Z67SP00*/
*                     IOPRETRN=RTNCODE;/* SAVE RC            @Z67SP00*/
         L     @14,IOPPTR                                          0668
         STC   RTNCODE,IOPRETRN(,@14)                              0668
*                     RFY                                          0669
*                       RTNCODE UNRSTD;/*                    @Z67SP00*/
*                     CALL HMASMIO(HMASMIOP);/* READ CH/REP  @Z67SP00*/
         ST    @14,@AL00001                                        0670
         L     @15,@CV01382                                        0670
         LA    @01,@AL00001                                        0670
         BALR  @14,@15                                             0670
*                     DO WHILE(     /* PROCESS ALL CH/REPS   @Z67SP00*/
*                           IOPLMCC=IOPLMCRC/*               @Z67SP00*/
*                           &IOPRETRN=IOPGOOD);/*            @Z67SP00*/
         B     @DE00671                                            0671
@DL00671 DS    0H                                                  0672
*                       CCORDER=CCCHRP;/* CH/REP CARD        @Z67SP00*/
         MVI   CCORDER,X'02'                                       0672
*                       CALL RLKDSVCC;/* SAVE CC             @Z67SP00*/
         BAL   @14,RLKDSVCC                                        0673
*                       RFY                                        0674
*                         RTNCODE RSTD;/*                    @Z67SP00*/
*                       IOPRETRN=RTNCODE;/*                          */
         L     @14,IOPPTR                                          0675
         STC   RTNCODE,IOPRETRN(,@14)                              0675
*                       IF RTNCODE=ZERO/* IF RCD SAVED OK    @Z67SP00*/
*                         THEN      /*                               */
         LTR   RTNCODE,RTNCODE                                     0676
         BNZ   @RF00676                                            0676
*                         CALL HMASMIO(HMASMIOP);/* READ     @Z67SP00*/
         ST    @14,@AL00001                                        0677
         L     @15,@CV01382                                        0677
         LA    @01,@AL00001                                        0677
         BALR  @14,@15                                             0677
*                       RFY                                        0678
*                         RTNCODE UNRSTD;/*                  @Z67SP00*/
@RF00676 DS    0H                                                  0679
*                     END;          /* END LOOP READ CH/REPS @Z67SP00*/
@DE00671 L     @15,IOPPTR                                          0679
         L     @01,IOPBUFAD(,@15)                                  0679
         CLI   IOPLMCC(@01),C'@'                                   0679
         BNE   @DC00671                                            0679
         CLI   IOPRETRN(@15),0                                     0679
         BE    @DL00671                                            0679
@DC00671 DS    0H                                                  0680
*                   END;            /* END MOD NOT LINKED    @Z67SP00*/
*                 ELSE              /* READ NEXT RCD IF      @Z67SP00*/
*                   CALL HMASMIO(HMASMIOP);/* NO LINKED      @Z67SP00*/
         B     @RC00663                                            0681
@RF00663 L     @01,IOPPTR                                          0681
         ST    @01,@AL00001                                        0681
         L     @15,@CV01382                                        0681
         LA    @01,@AL00001                                        0681
         BALR  @14,@15                                             0681
*                 GTPPTR=ADDR(CCGTP);/* GTP FOR CC           @Z67SP00*/
@RC00663 LA    @15,CCGTP                                           0682
         ST    @15,GTPPTR                                          0682
*               END;                /* END CC IS MOD FOR CR  @Z67SP00*/
*             ELSE                  /* IF NOT MOD FOR CH/REP @Z67SP00*/
*               CALL HMASMIO(HMASMIOP);/* READ NEXT CARD     @Z67SP00*/
         B     @RC00657                                            0684
@RF00657 L     @01,IOPPTR                                          0684
         ST    @01,@AL00001                                        0684
         L     @15,@CV01382                                        0684
         LA    @01,@AL00001                                        0684
         BALR  @14,@15                                             0684
*           END;                    /* END SAVE CH/REPS      @Z67SP00*/
@RC00657 DS    0H                                                  0685
@DE00656 L     @01,IOPPTR                                          0685
         CLI   IOPRETRN(@01),0                                     0685
         BNE   @DC00656                                            0685
         L     @01,GTPPTR                                          0685
         CLI   GTPRETRN(@01),0                                     0685
         BE    @DL00656                                            0685
@DC00656 DS    0H                                                  0686
*           CRPBUFFR=SAVRCD1;       /* RESTORE BUFFER        @Z67SP00*/
         L     @15,@PC00001+4                                      0686
         MVC   CRPBUFFR(80,@15),SAVRCD1                            0686
*         END;                      /* END LMOD HAD CH/REPS  @Z67SP00*/
*     END;                          /* END LMOD FOUND ON CDS @Z67SP00*/
*                                                                  0688
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR IN LMOD LOCATE ON CDS                           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0689
*   ELSE                            /* ELSE ERR              @Z67SP00*/
*     IF IOPRETRN>IOPNTFND          /* IF ERR IN LOCATE      @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
         B     @RC00646                                            0689
@RF00646 L     @15,IOPPTR                                          0689
         CLI   IOPRETRN(@15),4                                     0689
         BNH   @RF00689                                            0689
*       SCPRETRN=IOPRETRN;          /* PASS ALONG RC         @Z67SP00*/
         IC    @14,IOPRETRN(,@15)                                  0690
         L     @15,SCPPTR                                          0690
         STC   @14,SCPRETRN(,@15)                                  0690
*                                                                  0691
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE WHETHER LMOD CHANGE AND BACKUP ENTRY ON SCDS AND    */
*   /* UPDATE LIBRARIES                                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0691
*   IF IOPRETRN<=IOPNTFND           /* IF NO PREV ERRS       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00689 DS    0H                                                  0691
@RC00646 L     @15,IOPPTR                                          0691
         CLI   IOPRETRN(@15),4                                     0691
         BH    @RF00691                                            0691
*     DO;                           /*                       @Z67SP00*/
*       IF LMDFND=OFF               /* IF NEW LMOD ENTRY     @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         TM    LMDFND,B'00000010'                                  0693
         BNZ   @RF00693                                            0693
*         DO;                       /*                       @Z67SP00*/
*           STOWLMD=ON;             /*                       @Z67SP00*/
         OI    STOWLMD,B'00000001'                                 0695
*           IOPLMDNT=''B;           /* INIT ENTRY            @Z67SP00*/
         XC    IOPLMDNT(104,@15),IOPLMDNT(@15)                     0696
*           IOPNTLVL=IOPLMDLC;      /*                       @Z67SP00*/
         MVI   IOPNTLVL(@15),X'02'                                 0697
*           BUPTYPE=BUPADD;         /*                       @Z67SP00*/
         L     @14,@PC00001                                        0698
         MVI   BUPTYPE(@14),X'01'                                  0698
*           BUPIOPAD=ADDR(HMASMIOP);/*                       @Z67SP00*/
         ST    @15,BUPIOPAD(,@14)                                  0699
*           CALL HMASMBUE(BUPPARM); /* BACKUP ENTRY          @Z67SP00*/
         ST    @14,@AL00001                                        0700
         L     @15,@CV01385                                        0700
         LA    @01,@AL00001                                        0700
         BALR  @14,@15                                             0700
*           RFY                                                    0701
*             RTNCODE RSTD;         /*                       @Z67SP00*/
*           IOPRETRN=RTNCODE;       /*                       @Z67SP00*/
         L     @14,IOPPTR                                          0702
         STC   RTNCODE,IOPRETRN(,@14)                              0702
*           RFY                                                    0703
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/
*           J=1;                    /* INDEX FOR SYSLIB NAME @Z67SP00*/
         MVC   J(4),@CF00048                                       0704
*           IOPLMDND(1)=IOPEOLST;   /*                       @Z67SP00*/
         MVI   IOPLMDND(@14),X'FF'                                 0705
*         END;                      /*                       @Z67SP00*/
*                                                                  0706
*       /*************************************************************/
*       /*                                                           */
*       /* IF LMOD WAS ALREADY THERE SEE IF IT IS BEING UPDATED      */
*       /*                                                   @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0707
*       ELSE                        /*                       @Z67SP00*/
*         DO;                       /*                       @Z67SP00*/
         B     @RC00693                                            0707
@RF00693 DS    0H                                                  0708
*           I=0;                    /* COUNT OF SYSLIBS FND  @Z67SP00*/
         SLR   @15,@15                                             0708
         ST    @15,I                                               0708
*           DO J=1 TO DIM(IOPLNTRY) WHILE(/* LOOP THRU IOP   @Z67SP00*/
*                 IOPLMDND(J)^=IOPEOLST/* TILL END           @Z67SP00*/
*                 &(IOPLSYS(J)^=SYSTLIB/* OR NOT SYSLIB      @Z67SP00*/
*                 ×IOPLMIND(J)^=IOPLMSYS));/*                @Z67SP00*/
         LA    @15,1                                               0709
         ST    @15,J                                               0709
@DL00709 L     @14,IOPPTR                                          0709
         MH    @15,@CH00459                                        0709
         SLR   @09,@09                                             0709
         IC    @09,IOPLMDND-9(@15,@14)                             0709
         C     @09,@CF00648                                        0709
         BE    @DC00709                                            0709
         ST    @15,@TF00001                                        0709
         ALR   @15,@14                                             0709
         CLC   IOPLSYS-9(8,@15),SYSTLIB                            0709
         BNE   @DB00709                                            0709
         L     @15,@TF00001                                        0709
         SLR   @09,@09                                             0709
         IC    @09,IOPLMIND-9(@15,@14)                             0709
         C     @09,@CF00048                                        0709
         BE    @DC00709                                            0709
@DB00709 DS    0H                                                  0710
*             IF IOPLMIND(J)=IOPLMSYS/* IF SYSLIB TYPE       @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
         LA    @15,1                                               0710
         L     @14,J                                               0710
         LR    @09,@14                                             0710
         MH    @09,@CH00459                                        0710
         L     @01,IOPPTR                                          0710
         SLR   @08,@08                                             0710
         IC    @08,IOPLMIND-9(@09,@01)                             0710
         CR    @15,@08                                             0710
         BNE   @RF00710                                            0710
*               DO;                 /*                       @Z67SP00*/
*                 I=I+1;            /*                       @Z67SP00*/
         AL    @15,I                                               0712
         ST    @15,I                                               0712
*                 IF I=2            /* IF SECOND SYSLIB      @Z67SP00*/
*                   THEN            /* SAVE ITS POSITION     @Z67SP00*/
         C     @15,@CF00058                                        0713
         BNE   @RF00713                                            0713
*                   K=J;            /*                       @Z67SP00*/
         ST    @14,K                                               0714
*               END;                /*                       @Z67SP00*/
@RF00713 DS    0H                                                  0716
*           END;                    /*                       @Z67SP00*/
*                                                                  0716
@RF00710 LA    @15,1                                               0716
         AL    @15,J                                               0716
         ST    @15,J                                               0716
         C     @15,@CF00050                                        0716
         BNH   @DL00709                                            0716
@DC00709 DS    0H                                                  0717
*           /*********************************************************/
*           /*                                                       */
*           /* NOW CHECK TO SEE IF BEING CHANGED             @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0717
*           IF I>=2                 /* IF 2 SYSLIBS PRESENT  @Z67SP00*/
*             THEN                  /* OVERLAY SECOND ONE    @Z67SP00*/
         L     @15,I                                               0717
         C     @15,@CF00058                                        0717
         BL    @RF00717                                            0717
*             DO;                   /*                       @Z67SP00*/
*               IOPLSYS(K)=SYSTLIB; /*                       @Z67SP00*/
         L     @15,K                                               0719
         LR    @14,@15                                             0719
         MH    @14,@CH00459                                        0719
         L     @01,IOPPTR                                          0719
         ALR   @01,@14                                             0719
         MVC   IOPLSYS-9(8,@01),SYSTLIB                            0719
*               J=K;                /*                       @Z67SP00*/
         ST    @15,J                                               0720
*             END;                  /*                       @Z67SP00*/
*           STOWLMD=OFF;            /* NOT CHANGED           @Z67SP00*/
@RF00717 NI    STOWLMD,B'11111110'                                 0722
*           IF IOPLSYS(J)^=SYSTLIB  /* IF SYSTLIB NOT FND    @Z67SP00*/
*               ×CCENTRD=ON         /* OR CC ENTERED         @D67SP00*/
*               ×IOPLMDF1^=FLAGSAV1 /* OR LEPARMS CHANGED    @Z67SP00*/
*               ×IOPLMDF2^=FLAGSAV2 /* OR LEPARMS CHANGED    @Z67SP00*/
*               ×IOPLMDF3^=FLAGSAV3 /* OR LEPARMS CHANGED    @Z67SP00*/
*               ×IOPLMDF4^=FLAGSAV4 /* OR LEPARMS CHANGED    @Z67SP00*/
*               ×IOPLMDF5^=FLAGSAV5 /* OR LEPARMS CHANGED    @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         L     @15,IOPPTR                                          0723
         L     @14,J                                               0723
         MH    @14,@CH00459                                        0723
         ALR   @14,@15                                             0723
         CLC   IOPLSYS-9(8,@14),SYSTLIB                            0723
         BNE   @RT00723                                            0723
         TM    CCENTRD,B'00001000'                                 0723
         BO    @RT00723                                            0723
         CLC   IOPLMDF1(1,@15),FLAGSAV1                            0723
         BNE   @RT00723                                            0723
         CLC   IOPLMDF2(1,@15),FLAGSAV2                            0723
         BNE   @RT00723                                            0723
         CLC   IOPLMDF3(1,@15),FLAGSAV3                            0723
         BNE   @RT00723                                            0723
         CLC   IOPLMDF4(1,@15),FLAGSAV4                            0723
         BNE   @RT00723                                            0723
         CLC   IOPLMDF5(1,@15),FLAGSAV5                            0723
         BE    @RF00723                                            0723
@RT00723 DS    0H                                                  0724
*             DO;                   /*                       @Z67SP00*/
*               STOWLMD=ON;         /* MUST UPDATE LMOD      @Z67SP00*/
         OI    STOWLMD,B'00000001'                                 0725
*               BUPTYPE=BUPUPD;     /*                       @Z67SP00*/
         L     @15,@PC00001                                        0726
         MVI   BUPTYPE(@15),X'02'                                  0726
*               BUPIOPAD=ADDR(HMASMIOP);/*                   @Z67SP00*/
         L     @14,IOPPTR                                          0727
         ST    @14,BUPIOPAD(,@15)                                  0727
*               CALL HMASMBUE(BUPPARM);/*                    @Z67SP00*/
         ST    @15,@AL00001                                        0728
         L     @15,@CV01385                                        0728
         LA    @01,@AL00001                                        0728
         BALR  @14,@15                                             0728
*               RFY                                                0729
*                 RTNCODE RSTD;     /*                       @Z67SP00*/
*               IOPRETRN=RTNCODE;   /*                       @Z67SP00*/
         L     @14,IOPPTR                                          0730
         STC   RTNCODE,IOPRETRN(,@14)                              0730
*               RFY                                                0731
*                 RTNCODE UNRSTD;   /*                       @Z67SP00*/
*             END;                  /*                       @Z67SP00*/
*         END;                      /*                       @Z67SP00*/
@RF00723 DS    0H                                                  0734
*     END;                          /*                       @Z67SP00*/
@RC00693 DS    0H                                                  0735
*                                                                  0735
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE CONTROL CARDS TO CDS AND STOW LMOD ENTRY        @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0735
*   IF IOPRETRN<=IOPNTFND           /* IF PREV FUNCTIONS OK  @Z67SP00*/
*       &STOWLMD=ON                 /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00691 L     @15,IOPPTR                                          0735
         CLI   IOPRETRN(@15),4                                     0735
         BH    @RF00735                                            0735
         TM    STOWLMD,B'00000001'                                 0735
         BNO   @RF00735                                            0735
*     DO;                           /*                       @Z67SP00*/
*                                                                  0736
*       /*************************************************************/
*       /*                                                           */
*       /* SET NEW FIELDS IN LMOD ENTRY                      @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0737
*       IF IOPLMDND(J)=IOPEOLST     /* IF SYSLIB NOT FOUND   @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         LA    @14,255                                             0737
         L     @09,J                                               0737
         MH    @09,@CH00459                                        0737
         SLR   @08,@08                                             0737
         IC    @08,IOPLMDND-9(@09,@15)                             0737
         CR    @14,@08                                             0737
         BNE   @RF00737                                            0737
*         DO;                       /*                       @Z67SP00*/
*           IOPLSYS(J)=SYSTLIB;     /*                       @Z67SP00*/
         ST    @09,@TF00001                                        0739
         ALR   @09,@15                                             0739
         MVC   IOPLSYS-9(8,@09),SYSTLIB                            0739
*           IOPLMIND(J)=IOPLMSYS;   /* SYSLIB TYPE ENTRY     @Z67SP00*/
         LA    @09,1                                               0740
         L     @08,@TF00001                                        0740
         STC   @09,IOPLMIND-9(@08,@15)                             0740
*           IOPLMDND(J+1)=IOPEOLST; /*                       @Z67SP00*/
         L     @01,@TF00001                                        0741
         STC   @14,IOPLMDND(@01,@15)                               0741
*         END;                      /*                       @Z67SP00*/
*       IOPLMDF1=FLAGSAV1;          /* RESTORE LEPARMS 1     @ZD00004*/
@RF00737 L     @15,IOPPTR                                          0743
         MVC   IOPLMDF1(1,@15),FLAGSAV1                            0743
*       IOPLMDF2=FLAGSAV2;          /* RESTORE LEPARMS 2     @ZD00004*/
         MVC   IOPLMDF2(1,@15),FLAGSAV2                            0744
*       IOPLMDF3=FLAGSAV3;          /* RESTORE LEPARMS 3     @ZD00004*/
         MVC   IOPLMDF3(1,@15),FLAGSAV3                            0745
*       IOPLMDF4=FLAGSAV4;          /* RESTORE LEPARMS 4     @ZD00004*/
         MVC   IOPLMDF4(1,@15),FLAGSAV4                            0746
*       IOPLMDF5=FLAGSAV5;          /* RESTORE LMD OPTIONS   @ZD00004*/
         MVC   IOPLMDF5(1,@15),FLAGSAV5                            0747
*       IOPLINK=ON;                 /* LKED PARMS OBTAINED           */
         OI    IOPLINK(@15),B'01000000'                            0748
*       IF CHREPFLG=ON              /* THIS LMOD HAVE CH/REP STMTS?  */
*         THEN                      /* YES - PUT IN IOP              */
         TM    CHREPFLG,B'01000000'                                0749
         BNO   @RF00749                                            0749
*         DO;                                                      0750
*           IOPCHREP=ON;            /* INDICATE CHANGE/REPLACE IN IOP*/
         OI    IOPCHREP(@15),B'00100000'                           0751
*           CHREPFLG=OFF;           /* RESET FLAG FOR NEXT           */
         NI    CHREPFLG,B'10111111'                                0752
*         END;                                                     0753
*                                                                  0753
*       /*************************************************************/
*       /*                                                           */
*       /* NOW WRITE FIRST CONTROL RECORD PLUS ANY LINK EDIT CONTROL */
*       /* CARDS THAT WERE FOUND                             @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0754
*       IOPFUNCT=IOPWRITE;          /* SET TO WRITE CC       @Z67SP00*/
@RF00749 L     @15,IOPPTR                                          0754
         MVI   IOPFUNCT(@15),X'51'                                 0754
*       IOPBUFAD=ADDR(CCDATA);      /* READ INTO BUFFER      @Z67SP00*/
         LA    @14,CCDATA                                          0755
         ST    @14,IOPBUFAD(,@15)                                  0755
*       CCDATA=IOPLMDFX;            /* MOVE RCD TO BUFFER    @Z67SP00*/
         MVC   CCDATA(80),IOPLMDFX(@15)                            0756
*       CALL HMASMIO(HMASMIOP);     /* WRITE OUT FIRST RCD   @Z67SP00*/
         ST    @15,@AL00001                                        0757
         L     @15,@CV01382                                        0757
         LA    @01,@AL00001                                        0757
         BALR  @14,@15                                             0757
*       GTPPTR=ADDR(CCGTP);         /*                       @Z67SP00*/
         LA    @15,CCGTP                                           0758
         ST    @15,GTPPTR                                          0758
*       GTPFUNCT=GTPOPENN;          /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'01'                                 0759
*       CALL HMASMGTA(HMASMGTP);    /*                       @Z67SP00*/
         ST    @15,@AL00001                                        0760
         L     @15,@CV01384                                        0760
         LA    @01,@AL00001                                        0760
         BALR  @14,@15                                             0760
*       GTPFUNCT=GTPGETN;           /*                       @Z67SP00*/
         L     @15,GTPPTR                                          0761
         MVI   GTPFUNCT(@15),X'08'                                 0761
*       CALL HMASMGTA(HMASMGTP);    /*                       @Z67SP00*/
         ST    @15,@AL00001                                        0762
         L     @15,@CV01384                                        0762
         LA    @01,@AL00001                                        0762
         BALR  @14,@15                                             0762
*       SEQNO=ZERO;                 /* INIT RCD SEQUENCE NUM @Z67SP00*/
         SLR   @15,@15                                             0763
         ST    @15,SEQNO                                           0763
*       DO WHILE(                   /*                       @Z67SP00*/
*             IOPRETRN=IOPGOOD      /*                       @Z67SP00*/
*             &GTPRETRN=GTPGOOD);   /*                       @Z67SP00*/
         B     @DE00764                                            0764
@DL00764 DS    0H                                                  0765
*         IF IOPLMCC=IOPLMCRM       /* IF MOD CARD FOR CH/RP @Z67SP00*/
*             &IOPLMCRN=BLANK8      /* BUT NO MOD NAME       @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         L     @01,IOPPTR                                          0765
         L     @15,IOPBUFAD(,@01)                                  0765
         CLI   IOPLMCC(@15),C'*'                                   0765
         BNE   @RF00765                                            0765
         CLC   IOPLMCRN(8,@15),@CC01426                            0765
         BNE   @RF00765                                            0765
*           DO;                     /* SKIP CH/REPS          @Z67SP00*/
*             DO WHILE(             /* LOOP                  @Z67SP00*/
*                   GTPRETRN=GTPGOOD/* TILL EOF              @Z67SP00*/
*                   &IOPLMCC=IOPLMCRC);/* OR TILL END OF CH/REP    0767
*                                                            @Z67SP00*/
         B     @DE00767                                            0767
@DL00767 DS    0H                                                  0768
*               CALL HMASMGTA(HMASMGTP);/* CARDS             @Z67SP00*/
         L     @01,GTPPTR                                          0768
         ST    @01,@AL00001                                        0768
         L     @15,@CV01384                                        0768
         LA    @01,@AL00001                                        0768
         BALR  @14,@15                                             0768
*             END;                  /*                       @Z67SP00*/
@DE00767 L     @01,GTPPTR                                          0769
         CLI   GTPRETRN(@01),0                                     0769
         BNE   @DC00767                                            0769
         L     @01,IOPPTR                                          0769
         L     @01,IOPBUFAD(,@01)                                  0769
         CLI   IOPLMCC(@01),C'@'                                   0769
         BE    @DL00767                                            0769
@DC00767 DS    0H                                                  0770
*           END;                    /*                       @Z67SP00*/
*         IF GTPRETRN=GTPGOOD       /* IF CONTROL CARD FOUND @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
@RF00765 L     @01,GTPPTR                                          0771
         CLI   GTPRETRN(@01),0                                     0771
         BNE   @RF00771                                            0771
*           DO;                     /*                       @Z67SP00*/
*             SEQNO=SEQNO+INCR;     /* BUMP SEQUENCE NUMBER          */
         LA    @15,100                                             0773
         AL    @15,SEQNO                                           0773
         ST    @15,SEQNO                                           0773
*             CVD(SEQNO,DBLWRD);    /* CONVERT NUMBER                */
         CVD   @15,DBLWRD                                          0774
*             UNPK(CCRCDNO,DBLWRD); /* PUT NUMBER TO RECORD          */
         UNPK  CCRCDNO(8),DBLWRD(8)                                0775
*             CCMAKPR=CCMAKPR×PRBITS;/* MAKE PRINTABLE               */
         OI    CCMAKPR,X'F0'                                       0776
*             CALL HMASMIO(HMASMIOP);/* WRITE LINE           @Z67SP00*/
         L     @01,IOPPTR                                          0777
         ST    @01,@AL00001                                        0777
         L     @15,@CV01382                                        0777
         LA    @01,@AL00001                                        0777
         BALR  @14,@15                                             0777
*             CALL HMASMGTA(HMASMGTP);/* READ NEXT CC        @Z67SP00*/
         L     @01,GTPPTR                                          0778
         ST    @01,@AL00001                                        0778
         L     @15,@CV01384                                        0778
         LA    @01,@AL00001                                        0778
         BALR  @14,@15                                             0778
*           END;                    /*                       @Z67SP00*/
*       END;                        /*                       @Z67SP00*/
*                                                                  0780
@RF00771 DS    0H                                                  0780
@DE00764 L     @01,IOPPTR                                          0780
         CLI   IOPRETRN(@01),0                                     0780
         BNE   @DC00764                                            0780
         L     @01,GTPPTR                                          0780
         CLI   GTPRETRN(@01),0                                     0780
         BE    @DL00764                                            0780
@DC00764 DS    0H                                                  0781
*       /*************************************************************/
*       /*                                                           */
*       /* NOW STOW LMOD ENTRY ON CDS                        @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0781
*       IF IOPRETRN=IOPGOOD         /* IF WRITE WERE OK      @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         L     @15,IOPPTR                                          0781
         CLI   IOPRETRN(@15),0                                     0781
         BNE   @RF00781                                            0781
*         DO;                       /*                       @Z67SP00*/
*           IOPFUNCT=IOPSTOWR;      /* INDICATE STOW OPERATION       */
         MVI   IOPFUNCT(@15),X'54'                                 0783
*           CALL HMASMIO(HMASMIOP); /* STOW LINK EDIT CON CARDS      */
         ST    @15,@AL00001                                        0784
         L     @15,@CV01382                                        0784
         LA    @01,@AL00001                                        0784
         BALR  @14,@15                                             0784
*         END;                      /* END STOW LMOD         @Z67SP00*/
*     END;                          /* END MUST STOW LMOD    @Z67SP00*/
@RF00781 DS    0H                                                  0787
*   IOPBUFAD=SAVBUFAD;              /* RESET ADD IN CASE CHANGED   0787
*                                      DURING PROCESS        @Z67SP00*/
@RF00735 L     @15,IOPPTR                                          0787
         L     @14,SAVBUFAD                                        0787
         ST    @14,IOPBUFAD(,@15)                                  0787
*                                                                  0788
*   /*****************************************************************/
*   /*                                                               */
*   /* CREATE AND STORE MODULE ENTRIES IN THE CDS. MEMBERS MAY BE    */
*   /* UPDATED IF THIS LOAD MODULE DOES NOT APPEAR ON THE LOAD MODULE*/
*   /* LIST.                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0788
*   IF IOPRETRN=IOPGOOD             /* IF PREV FUNCTION OK   @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CLI   IOPRETRN(@15),0                                     0788
         BNE   @RF00788                                            0788
*     DO;                           /*                       @Z67SP00*/
*       GTPPTR=ADDR(MDDLBGTP);      /* GTP WITH MODS         @Z67SP00*/
         LA    @15,MDDLBGTP                                        0790
         ST    @15,GTPPTR                                          0790
*       GTPFUNCT=GTPOPENN;          /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'01'                                 0791
*       CALL HMASMGTA(HMASMGTP);    /* POS TO FIRST RCD      @Z67SP00*/
         ST    @15,@AL00001                                        0792
         L     @15,@CV01384                                        0792
         LA    @01,@AL00001                                        0792
         BALR  @14,@15                                             0792
*       GTPFUNCT=GTPGETN;           /* SEQUENTIAL READ       @Z67SP00*/
         L     @15,GTPPTR                                          0793
         MVI   GTPFUNCT(@15),X'08'                                 0793
*       CALL HMASMGTA(HMASMGTP);    /* GET FIRST RCD         @Z67SP00*/
         ST    @15,@AL00001                                        0794
         L     @15,@CV01384                                        0794
         LA    @01,@AL00001                                        0794
         BALR  @14,@15                                             0794
*       DO WHILE(                   /* LOOP READING AND STOW @Z67SP00*/
*             IOPRETRN=IOPGOOD      /* TILL ERR IN LOC/STOW  @Z67SP00*/
*             &GTPRETRN=GTPGOOD);   /* OR EOF ON MODS        @Z67SP00*/
         B     @DE00795                                            0795
@DL00795 DS    0H                                                  0796
*         IOPNAME=CSECTN;           /* MOVE MOD NAME TO IOP  @Z67SP00*/
         L     @15,IOPPTR                                          0796
         MVC   IOPNAME(8,@15),CSECTN                               0796
*         IOPTYPE=IOPMOD;           /* MOD TYPE RCD          @Z67SP00*/
         MVI   IOPTYPE(@15),X'05'                                  0797
*         IOPFUNCT=IOPLOC;          /*                       @Z67SP00*/
         MVI   IOPFUNCT(@15),X'03'                                 0798
*         CALL HMASMIO(HMASMIOP);   /* LOC MOD ON CDS        @Z67SP00*/
*                                                                  0799
         ST    @15,@AL00001                                        0799
         L     @15,@CV01382                                        0799
         LA    @01,@AL00001                                        0799
         BALR  @14,@15                                             0799
*         /***********************************************************/
*         /*                                                         */
*         /* IF MOD NOT FOUD SET SET INITIAL ENTRY AND CALL BUE      */
*         /*                                                 @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0800
*         IF IOPRETRN=IOPNTFND      /* IF NOT FOUND          @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         L     @15,IOPPTR                                          0800
         CLI   IOPRETRN(@15),4                                     0800
         BNE   @RF00800                                            0800
*           DO;                     /*                       @Z67SP00*/
*             IOPMODNT=''B;         /* INIT ENTRY            @Z67SP00*/
         XC    IOPMODNT(104,@15),IOPMODNT(@15)                     0802
*             IOPNTLVL=IOPMODLC;    /* SET CONVERSION LEVEL  @Z67SP00*/
         MVI   IOPNTLVL(@15),X'02'                                 0803
*             IOPRMID=BLANK;        /*                       @Z67SP00*/
         MVI   IOPRMID+1(@15),C' '                                 0804
         MVC   IOPRMID+2(5,@15),IOPRMID+1(@15)                     0804
         MVI   IOPRMID(@15),C' '                                   0804
*             IOPFMID=BLANK;        /*                       @Z67SP00*/
         MVI   IOPFMID+1(@15),C' '                                 0805
         MVC   IOPFMID+2(5,@15),IOPFMID+1(@15)                     0805
         MVI   IOPFMID(@15),C' '                                   0805
*             BUPTYPE=BUPADD;       /* INDICATE ADDED        @Z67SP00*/
         L     @15,@PC00001                                        0806
         MVI   BUPTYPE(@15),X'01'                                  0806
*             CALL HMASMBUE(BUPPARM);/*                      @Z67SP00*/
         ST    @15,@AL00001                                        0807
         L     @15,@CV01385                                        0807
         LA    @01,@AL00001                                        0807
         BALR  @14,@15                                             0807
*             RFY                                                  0808
*               RTNCODE RSTD;       /*                       @Z67SP00*/
*             IOPRETRN=RTNCODE;     /* SAVE RC               @Z67SP00*/
         L     @14,IOPPTR                                          0809
         STC   RTNCODE,IOPRETRN(,@14)                              0809
*             RFY                                                  0810
*               RTNCODE UNRSTD;     /*                       @Z67SP00*/
*             J=1;                  /* PLACE WHERE LMOD NAME WILL BE
*                                      PLACED LATER          @Z67SP00*/
         MVC   J(4),@CF00048                                       0811
*             IOPMODND(1)=IOPEOLST; /* SET END OF LIST       @Z67SP00*/
         MVI   IOPMODND(@14),X'FF'                                 0812
*           END;                    /*                       @Z67SP00*/
*                                                                  0813
*         /***********************************************************/
*         /*                                                         */
*         /* IF MOD FOUND ON CDS THEN DETERMINE WHETHER CHANGE WILL  */
*         /* BE MADE AND IF SO CALL BUE THEN MAKE CHANGE     @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0814
*         ELSE                      /*                       @Z67SP00*/
*           IF IOPRETRN=IOPGOOD     /* IF FOUND              @Z67SP00*/
*             THEN                  /*                       @Z67SP00*/
         B     @RC00800                                            0814
@RF00800 L     @01,IOPPTR                                          0814
         CLI   IOPRETRN(@01),0                                     0814
         BNE   @RF00814                                            0814
*             DO;                   /*                       @Z67SP00*/
*               DO J=1 BY 1 WHILE(  /* LOOP THRU MOD SUBENTS @Z67SP00*/
*                     IOPMODND(J)^=IOPEOLST/* TILL END       @Z67SP00*/
*                     &(IOPLMODS(J)^=LMODNAM/* OR UNTIL SUBENT     0816
*                                                            @Z67SP00*/
*                     ×IOPMDIND(J)^=IOPMDLMD));/* FOUND AS LMOD TYPE
*                                      EQUAL TO ONE BEING PROCESS  0816
*                                                            @Z67SP00*/
         LA    @15,1                                               0816
         ST    @15,J                                               0816
         B     @DE00816                                            0816
@DL00816 DS    0H                                                  0817
*               END;                /*                       @Z67SP00*/
         LA    @15,1                                               0817
         AL    @15,J                                               0817
         ST    @15,J                                               0817
@DE00816 L     @15,IOPPTR                                          0817
         L     @14,J                                               0817
         MH    @14,@CH00459                                        0817
         SLR   @09,@09                                             0817
         IC    @09,IOPMODND-9(@14,@15)                             0817
         C     @09,@CF00648                                        0817
         BE    @DC00816                                            0817
         ST    @14,@TF00001                                        0817
         ALR   @14,@15                                             0817
         CLC   IOPLMODS-9(8,@14),LMODNAM                           0817
         BNE   @DL00816                                            0817
         L     @14,@TF00001                                        0817
         SLR   @09,@09                                             0817
         IC    @09,IOPMDIND-9(@14,@15)                             0817
         C     @09,@CF00048                                        0817
         BNE   @DL00816                                            0817
@DC00816 DS    0H                                                  0818
*               IF IOPMODND(J)=IOPEOLST/* IF LMOD NOT FOUND  @Z67SP00*/
*                   ×IOPDLIB^=DLIBN /* OR DLIB CHANGED       @Z67SP00*/
*                 THEN              /*                       @Z67SP00*/
         L     @15,IOPPTR                                          0818
         L     @14,J                                               0818
         MH    @14,@CH00459                                        0818
         SLR   @09,@09                                             0818
         IC    @09,IOPMODND-9(@14,@15)                             0818
         C     @09,@CF00648                                        0818
         BE    @RT00818                                            0818
         CLC   IOPDLIB(8,@15),DLIBN                                0818
         BE    @RF00818                                            0818
@RT00818 DS    0H                                                  0819
*                 DO;               /*                       @Z67SP00*/
*                   BUPTYPE=BUPUPD; /* INDICATE UPDATE       @Z67SP00*/
         L     @15,@PC00001                                        0820
         MVI   BUPTYPE(@15),X'02'                                  0820
*                   CALL HMASMBUE(BUPPARM);/* CREATE BACKUP  @Z67SP00*/
         ST    @15,@AL00001                                        0821
         L     @15,@CV01385                                        0821
         LA    @01,@AL00001                                        0821
         BALR  @14,@15                                             0821
*                   RFY                                            0822
*                     RTNCODE RSTD; /*                       @Z67SP00*/
*                   IOPRETRN=RTNCODE;/*                      @Z67SP00*/
         L     @14,IOPPTR                                          0823
         STC   RTNCODE,IOPRETRN(,@14)                              0823
*                   RFY                                            0824
*                     RTNCODE UNRSTD;/*                      @Z67SP00*/
*                 END;              /*                       @Z67SP00*/
*             END;                  /*                       @Z67SP00*/
*           ELSE                    /*                       @Z67SP00*/
*             IF IOPRETRN=IOPEXC    /*                       @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
         B     @RC00814                                            0827
@RF00814 L     @01,IOPPTR                                          0827
         CLI   IOPRETRN(@01),8                                     0827
         BNE   @RF00827                                            0827
*               EXCERR=ON;          /*                       @Z67SP00*/
*                                                                  0828
         OI    EXCERR,B'01000000'                                  0828
*         /***********************************************************/
*         /*                                                         */
*         /* IF LOCATE OK AND BACKUP CREATED OK AND MOD CHANGED THEN */
*         /* STOW MOD ON CDS                                 @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0829
*         IF IOPRETRN<=IOPNTFND     /* IF NO ERR IN LOCATE   @Z67SP00*/
*             &(IOPMODND(J)=IOPEOLST/* AND LMOD NOT FOUND    @Z67SP00*/
*             ×IOPDLIB^=DLIBN)      /* IN MOD OR NEW DLIB    @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
@RF00827 DS    0H                                                  0829
@RC00814 DS    0H                                                  0829
@RC00800 L     @15,IOPPTR                                          0829
         CLI   IOPRETRN(@15),4                                     0829
         BH    @RF00829                                            0829
         L     @14,J                                               0829
         MH    @14,@CH00459                                        0829
         SLR   @09,@09                                             0829
         IC    @09,IOPMODND-9(@14,@15)                             0829
         C     @09,@CF00648                                        0829
         BE    @RT00829                                            0829
         CLC   IOPDLIB(8,@15),DLIBN                                0829
         BE    @RF00829                                            0829
@RT00829 DS    0H                                                  0830
*           DO;                     /*                       @Z67SP00*/
*             IF IOPMODND(J)=IOPEOLST/* IF LMOD NOT FOUND    @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
         LA    @15,255                                             0831
         L     @14,IOPPTR                                          0831
         L     @09,J                                               0831
         MH    @09,@CH00459                                        0831
         SLR   @08,@08                                             0831
         IC    @08,IOPMODND-9(@09,@14)                             0831
         CR    @15,@08                                             0831
         BNE   @RF00831                                            0831
*               DO;                 /*                       @Z67SP00*/
*                 IOPLMODS(J)=LMODNAM;/* MOVE LMOD NAME      @Z67SP00*/
         ST    @09,@TF00001                                        0833
         ALR   @09,@14                                             0833
         MVC   IOPLMODS-9(8,@09),LMODNAM                           0833
*                 IOPMDIND(J)=IOPMDLMD;/* LMOD TYPE          @Z67SP00*/
         LA    @09,1                                               0834
         L     @08,@TF00001                                        0834
         STC   @09,IOPMDIND-9(@08,@14)                             0834
*                 IOPMODND(J+1)=IOPEOLST;/*                  @Z67SP00*/
         L     @01,@TF00001                                        0835
         STC   @15,IOPMODND(@01,@14)                               0835
*               END;                /*                       @Z67SP00*/
*             IOPDLIB=DLIBN;        /* MOVE DLIB             @Z67SP00*/
@RF00831 L     @15,IOPPTR                                          0837
         MVC   IOPDLIB(8,@15),DLIBN                                0837
*             IOPFUNCT=IOPSTOWR;    /* STOW MOD ON CDS       @Z67SP00*/
         MVI   IOPFUNCT(@15),X'54'                                 0838
*             CALL HMASMIO(HMASMIOP);/*                      @Z67SP00*/
         ST    @15,@AL00001                                        0839
         L     @15,@CV01382                                        0839
         LA    @01,@AL00001                                        0839
         BALR  @14,@15                                             0839
*           END;                    /*                       @Z67SP00*/
*         CALL HMASMGTA(HMASMGTP);  /* GET NEXT MOD/DLIB     @Z67SP00*/
@RF00829 L     @01,GTPPTR                                          0841
         ST    @01,@AL00001                                        0841
         L     @15,@CV01384                                        0841
         LA    @01,@AL00001                                        0841
         BALR  @14,@15                                             0841
*       END;                        /* END GTA LOOP          @Z67SP00*/
@DE00795 L     @01,IOPPTR                                          0842
         CLI   IOPRETRN(@01),0                                     0842
         BNE   @DC00795                                            0842
         L     @01,GTPPTR                                          0842
         CLI   GTPRETRN(@01),0                                     0842
         BE    @DL00795                                            0842
@DC00795 DS    0H                                                  0843
*     END;                          /* END LMOD PROCESSED    @Z67SP00*/
*                                                                  0843
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW FREE AND REINITIALIZE MOD/DLIB GTP                @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0844
*   GTPPTR=ADDR(MDDLBGTP);          /*                       @Z67SP00*/
@RF00788 LA    @15,MDDLBGTP                                        0844
         ST    @15,GTPPTR                                          0844
*   GTPFUNCT=GTPFREE;               /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'0A'                                 0845
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/
         ST    @15,@AL00001                                        0846
         L     @15,@CV01384                                        0846
         LA    @01,@AL00001                                        0846
         BALR  @14,@15                                             0846
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/
         L     @15,GTPPTR                                          0847
         XC    HMASMGTP(28,@15),HMASMGTP(@15)                      0847
*   GTPRCDLN=LENGTH(MDDLBRCD);      /*                       @Z67SP00*/
         MVC   GTPRCDLN(2,@15),@CH00216                            0848
*   GTPKEYLN=LENGTH(CSECTN);        /*                       @Z67SP00*/
         MVC   GTPKEYLN(2,@15),@CH00043                            0849
*   GTPBUFAD=ADDR(MDDLBRCD);        /*                       @Z67SP00*/
         LA    @14,MDDLBRCD                                        0850
         ST    @14,GTPBUFAD(,@15)                                  0850
*   GTPPSIZE=GTP512B;               /*                       @Z67SP00*/
*                                                                  0851
         NI    GTPPSIZE(@15),B'11111001'                           0851
         OI    GTPPSIZE(@15),B'00000001'                           0851
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW FREE AND REINITIALIZE CONTROL CARD GTP            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0852
*   GTPPTR=ADDR(CCGTP);             /*                       @Z67SP00*/
         LA    @15,CCGTP                                           0852
         ST    @15,GTPPTR                                          0852
*   GTPFUNCT=GTPFREE;               /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'0A'                                 0853
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/
         ST    @15,@AL00001                                        0854
         L     @15,@CV01384                                        0854
         LA    @01,@AL00001                                        0854
         BALR  @14,@15                                             0854
*   GTPRCDLN=LENGTH(CCRCD);         /*                       @Z67SP00*/
         L     @15,GTPPTR                                          0855
         MVC   GTPRCDLN(2,@15),@CH00548                            0855
*   GTPKEYLN=LENGTH(CCKEY);         /*                       @Z67SP00*/
         MVC   GTPKEYLN(2,@15),@CH00064                            0856
*   GTPBUFAD=ADDR(CCRCD);           /*                       @Z67SP00*/
         LA    @14,CCRCD                                           0857
         ST    @14,GTPBUFAD(,@15)                                  0857
*   SCPRETRN=IOPRETRN;              /* SET SCAN RC           @Z67SP00*/
         L     @01,IOPPTR                                          0858
         IC    @00,IOPRETRN(,@01)                                  0858
         L     @01,SCPPTR                                          0858
         STC   @00,SCPRETRN(,@01)                                  0858
*   NAMEFND=ON;                     /* NAME FOUND            @Z67SP00*/
*   CCENTRD=OFF;                    /* NO CC                 @Z67SP00*/
         OI    NAMEFND,B'00010000'                                 0860
         NI    CCENTRD,B'11110111'                                 0860
*   END RNAMEV;                                                    0861
@EL00010 DS    0H                                                  0861
@EF00010 DS    0H                                                  0861
@ER00010 LM    @14,@12,@SA00010                                    0861
         BR    @14                                                 0861
         EJECT
*                                                                  0862
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO PRINT LINE IN ERROR DETECTED IN JCLIN SCAN TWO     */
*   /* POINTERS ARE RECEIVED. ONE POINTS TO THE LINE IN ERROR RECORD.*/
*   /* THE OTHER POINTS TO AN ACTION FIELD DESCRIBING THE ACTION     */
*   /* TAKEN.                                                @SA72421*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0862
*LKDERR:                            /* ERROR PRINT ROUTINE   @SA72421*/
*   PROCEDURE(LINE,ACTION);         /*                       @Z67SP00*/
LKDERR   STM   @14,@12,@SA00011                                    0862
         MVC   @PC00011(8),0(@01)                                  0862
*   DCL                                                            0863
*     LKDRBFSV PTR(31);             /* BUFF ADDRESS SAVE AREA      0863
*                                                            @SA72421*/
*   DCL                                                            0864
*     LINE CHAR(80);                /* LINE IN ERROR         @Z67SP00*/
*   DCL                                                            0865
*     ACTION CHAR(25);              /* ACTION INFO           @Z67SP00*/
*   DCL                                                            0866
*     1 JCLINOUT,                   /* CORE AREA EQUATING TO HMASMPRL
*                                                            @SA72421*/
*       3 * CHAR(LENGTH(HMASMPRL)), /* PRL CONTROL AREA      @Z40SP00*/
*       3 PRNTMAP CHAR(120),        /* PRINT LINE MAP        @SA72421*/
*         5 * CHAR(10) INIT('----------'),/* PREFIX          @SA72421*/
*         5 JCLINDAT CHAR(80),      /* LINE IN ERROR         @SA72421*/
*         5 * CHAR(5) INIT(' '),    /* SPACING               @SA72421*/
*         5 JCLINACT CHAR(25);      /* ACTION INFO           @SA72421*/
*   LKDRBFSV=IOPBUFAD;              /* SAVE BUFFER ADDRESS   @SA72421*/
         L     @15,IOPPTR                                          0867
         L     @14,IOPBUFAD(,@15)                                  0867
         ST    @14,LKDRBFSV                                        0867
*   IOPBUFAD=ADDR(JCLINOUT);        /* EQUATE PRL TO JCLINOUT MAP  0868
*                                                            @SA72421*/
         LA    @14,JCLINOUT                                        0868
         ST    @14,IOPBUFAD(,@15)                                  0868
*   JCLINDAT=LINE;                  /* FILL IN LINE IN ERROR @SA72421*/
         L     @09,@PC00011                                        0869
         MVC   JCLINDAT(80),LINE(@09)                              0869
*   JCLINACT=ACTION;                /* FILL IN ACTION INFO   @SA72421*/
         L     @09,@PC00011+4                                      0870
         MVC   JCLINACT(25),ACTION(@09)                            0870
*   PRLRLEN=LENGTH(PRNTMAP);        /* FILL IN LNGTH OF PRNT DATA  0871
*                                                            @SA72421*/
         MVC   PRLRLEN(2,@14),@CH01711                             0871
*   PRLFLGS=ZERO;                   /* RESET FLAGS           @Z40SP00*/
         MVI   PRLFLGS(@14),X'00'                                  0872
*   IOPDSID=IOPPRINT;               /* SET PRINT INDICATOR   @SA72421*/
         MVI   IOPDSID(@15),X'0B'                                  0873
*   IOPFUNCT=IOPWRITE;              /* INDICATE WRITE OP     @SA72421*/
         MVI   IOPFUNCT(@15),X'51'                                 0874
*   CALL HMASMIO(HMASMIOP);         /* WRITE LINE IN ERROR   @SA72421*/
         ST    @15,@AL00001                                        0875
         L     @15,@CV01382                                        0875
         LA    @01,@AL00001                                        0875
         BALR  @14,@15                                             0875
*   IF IOPRETRN^=IOPGOOD            /* ERROR?                @YA07506*/
*     THEN                                                         0876
         L     @15,IOPPTR                                          0876
         CLI   IOPRETRN(@15),0                                     0876
         BE    @RF00876                                            0876
*     IF LKDRTNCD<IOPRETRN          /* CHANGE RC?            @YA07506*/
*       THEN                                                       0877
         CLC   LKDRTNCD(1),IOPRETRN(@15)                           0877
         BNL   @RF00877                                            0877
*       LKDRTNCD=IOPRETRN;          /* YES                   @YA07506*/
         IC    @14,IOPRETRN(,@15)                                  0878
         STC   @14,LKDRTNCD                                        0878
*   IOPBUFAD=LKDRBFSV;              /* RESTORE BUFFER ADDRESS      0879
*                                                            @SA72421*/
@RF00877 DS    0H                                                  0879
@RF00876 L     @15,LKDRBFSV                                        0879
         L     @14,IOPPTR                                          0879
         ST    @15,IOPBUFAD(,@14)                                  0879
*   END LKDERR;                     /* RETURN                @SA72421*/
@EL00011 DS    0H                                                  0880
@EF00011 DS    0H                                                  0880
@ER00011 LM    @14,@12,@SA00011                                    0880
         BR    @14                                                 0880
*   END HMASMLKD                    /*                       @SA70537*/
*                                                                  0881
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*                                                                  0881
*       ;                                                          0881
@DATA    DS    0H
@CH00064 DC    H'5'
@CH00459 DC    H'9'
@CH00466 DC    H'13'
@CH00216 DC    H'16'
@CH01063 DC    H'71'
@CH00548 DC    H'85'
@CH01711 DC    H'120'
@SC01727 CLC   SCPSTRNG(0,@01),0(@09)
@SM01737 MVC   SYSTLIB(0),SCPSTRNG(@01)
@SM01740 MVC   DLIBN(0),SCPSTRNG(@01)
@SM01742 MVC   CSECTN(0),SCPSTRNG(@01)
@SM01745 MVC   LMODNAM(0),SCPSTRNG(@01)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    4F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00010 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00009 DS    15F
@SA00008 DS    15F
@SA00007 DS    0F
@SA00011 DS    0F
@PC00011 EQU   @SA00011+60
         DS    17F
@AL00001 DS    2A
@TF00001 DS    F
         DS    0F
@CF00048 DC    F'1'
@CF00058 DC    F'2'
@CF00062 DC    F'4'
@CF00050 DC    F'7'
@CF00043 DC    F'8'
@CH00043 EQU   @CF00043+2
@CF00070 DC    F'15'
@CF00538 DC    F'80'
@CF00648 DC    F'255'
@CV01382 DC    V(HMASMIO)
@CV01383 DC    V(HMASMCRD)
@CV01384 DC    V(HMASMGTA)
@CV01385 DC    V(HMASMBUE)
@CV01386 DC    V(HMASMSCN)
         DS    0D
IOPPTR   DS    A
SCPPTR   DS    A
GTPPTR   DS    A
TEMPPTR1 DS    A
TEMPPTR2 DS    A
I        DS    F
J        DS    F
K        DS    F
SAVBUFAD DS    A
MODKEYPT DS    A
SYSLADDR DS    A
SEQNO    DS    F
CHRSEQNO DS    F
SAVSEQNO DS    F
LKDRBFSV DS    A
LKDRTNCD DS    FL1
JCLRC    DS    FL1
CCRC     DS    FL1
LMNRC    DS    FL1
JRTRC    DS    FL1
@TS00001 DS    CL8
@CC01422 DC    C'PARMLIB '
@CC01424 DC    C'SYSLMOD '
@CC01426 DC    C'        '
@CC01418 DC    C'IEANUC0'
@CC01412 DC    C'MOD='
@CC01405 DC    C'/*'
@CC01407 DC    C'//'
@CC01409 DC    C'++'
NODSN    DC    CL25'NO DSNAME CODED          '
NOSYSL   DC    CL25'NO SYSLMOD CARD FOUND    '
LASTLINE DC    CL25'*****-LAST LINE PROCESSED'
TBLOFLOW DC    CL25'*****-TABLE OVERFLOW     '
CNTRLERR DC    CL25'ERROR IN LKED CNTRL STMT.'
NOMODNM  DC    CL25'NO MODNAME FOUND IN STMT.'
NOMODKEY DC    CL25'NO MOD KEYWORD FOUND     '
INVALKEY DC    CL25'INVALID KEYWORD FOR MOD  '
STOWERR  DC    CL25'ERROR ON MOD NAME STOW   '
         DS    CL1
LKDSCP   DS    CL26
LMODNAM  DS    CL8
SYSTLIB  DS    CL8
FLAGSAV1 DS    CL1
FLAGSAV2 DS    CL1
FLAGSAV3 DS    CL1
FLAGSAV4 DS    CL1
FLAGSAV5 DS    CL1
SAVRCD1  DS    CL80
         DS    CL5
DBLWRD   DS    CL8
PATCHLKD DS    CL80
         ORG   PATCHLKD
@NM00182 DC    80X'FF'
         ORG   PATCHLKD+80
SWITCHES DS    BL3
         ORG   SWITCHES
INTERR   DS    BL1
EXCERR   EQU   SWITCHES+0
TBLEXC   EQU   SWITCHES+0
SYSLSW   EQU   SWITCHES+0
SYSTSW   EQU   SWITCHES+0
INCLPARM EQU   SWITCHES+0
INCLSYSL EQU   SWITCHES+0
INCLFND  EQU   SWITCHES+0
PARMEQSW DS    BL1
CHREPFLG EQU   SWITCHES+1
CHREPFND EQU   SWITCHES+1
NAMEFND  EQU   SWITCHES+1
CCENTRD  EQU   SWITCHES+1
SYSTFND  EQU   SWITCHES+1
LMDFND   EQU   SWITCHES+1
STOWLMD  EQU   SWITCHES+1
JCLENSW  DS    BL1
PREMSW   EQU   SWITCHES+2
@NM00183 EQU   SWITCHES+2
         ORG   SWITCHES+3
         DS    CL1
MDDLBGTP DS    CL28
MDDLBRCD DS    CL16
         ORG   MDDLBRCD
CSECTN   DS    CL8
DLIBN    DS    CL8
         ORG   MDDLBRCD+16
CCGTP    DS    CL28
CCRCD    DS    CL85
         ORG   CCRCD
CCKEY    DS    CL5
         ORG   CCKEY
CCORDER  DS    FL1
CCSEQNO  DS    FL4
         ORG   CCRCD+5
CCDATA   DS    CL80
         ORG   CCDATA
CCTYPE   DS    CL1
CCMOD    DS    CL8
CCDLIB   DS    CL8
@NM00184 DS    CL55
CCRCDNO  DS    CL8
         ORG   CCRCDNO
@NM00185 DS    CL7
CCMAKPR  DS    BL1
         ORG   CCRCD+85
JCLINOUT DS    CL130
         ORG   JCLINOUT
@NM00186 DS    CL10
PRNTMAP  DS    CL120
         ORG   PRNTMAP
@NM00187 DC    CL10'----------'
JCLINDAT DS    CL80
@NM00188 DC    CL5' '
JCLINACT DS    CL25
         ORG   JCLINOUT+130
KEYS     DS    CL13
         ORG   KEYS+0
KEYWORD  DC    CL8'RENT'
KEYLEN   DC    AL1(4)
KEYROUTS DC    AL4(KEY010)
         ORG   KEYS+13
         ORG   KEYS+13
         DC    CL8'REUS'
         DC    AL1(4)
         DC    AL4(KEY020)
         ORG   KEYS+26
         ORG   KEYS+26
         DC    CL8'SCTR'
         DC    AL1(4)
         DC    AL4(KEY030)
         ORG   KEYS+39
         ORG   KEYS+39
         DC    CL8'OVLY'
         DC    AL1(4)
         DC    AL4(KEY040)
         ORG   KEYS+52
         ORG   KEYS+52
         DC    CL8'REFR'
         DC    AL1(4)
         DC    AL4(KEY050)
         ORG   KEYS+65
         ORG   KEYS+65
         DC    CL8'DC'
         DC    AL1(2)
         DC    AL4(KEY060)
         ORG   KEYS+78
         ORG   KEYS+78
         DC    CL8'NE'
         DC    AL1(2)
         DC    AL4(KEY070)
         ORG   KEYS+91
         ORG   KEYS+91
         DC    CL8'AC=1'
         DC    AL1(4)
         DC    AL4(KEY075)
         ORG   KEYS+104
         ORG   KEYS+104
         DC    CL8'SYSLMOD'
         DC    AL1(7)
         DC    AL4(KEY080)
         ORG   KEYS+117
         ORG   KEYS+117
         DC    CL8'DSN='
         DC    AL1(4)
         DC    AL4(KEY090)
         ORG   KEYS+130
         ORG   KEYS+130
         DC    CL8'DSNAME='
         DC    AL1(7)
         DC    AL4(KEY090)
         ORG   KEYS+143
         ORG   KEYS+143
         DC    CL8'NAME='
         DC    AL1(5)
         DC    AL4(KEY100)
         ORG   KEYS+156
         ORG   KEYS+156
         DC    CL8'ALIGN2'
         DC    AL1(6)
         DC    AL4(KEY110)
         ORG   KEYS+169
         ORG   KEYS+169
         DC    CL8'COND='
         DC    AL1(5)
         DC    AL4(KEY120)
         ORG   KEYS+182
         ORG   KEYS+182
         DC    CL8'PARM'
         DC    AL1(4)
         DC    AL4(KEY130)
         ORG   KEYS+195
HMASMLKD CSECT
KINCLUDE DSCAN KEY='INCLUDE',ALT=KNAME,SUCC=KDLIBV
KDLIBV   DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KCSECTLP,ROUT=RDLIBV
KCSECTLP DSCAN KEY='(',SUCC=KCSECTV
KCSECTV  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KCSECTRP,ROUT=RCSECTV
KCSECTRP DSCAN KEY=')',ALT=KCSECTV,COMMA=NO
KNAME    DSCAN KEY='NAME',ALT=KCHANGE,SUCC=KNAMEV
KNAMEV   DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,ROUT=RNAMEV
KCHANGE  DSCAN KEY='CHANGE',ALT=KREPLACE,ROUT=RCHANGE
KREPLACE DSCAN KEY='REPLACE',ALT=KLKDSVCC,ROUT=RREPLACE
KLKDSVCC DSCAN MINLEN=0,ROUT=RLKDSVCC
HMASMLKD CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCAPTR   EQU   @11
RTNCODE  EQU   @15
RTNREG   EQU   @14
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00011 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00027 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00029 EQU   CCABLDLL
CCALKDRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00039+20
@NM00041 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00041+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
@NM00045 EQU   HMASMIOP+12
@NM00046 EQU   @NM00045
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPLMCC  EQU   IOPLMCTL
IOPLMCRN EQU   IOPLMCTL+1
IOPQSMIF EQU   0
@NM00156 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMPRL EQU   0
PRLRLEN  EQU   HMASMPRL
PRLSPAN  EQU   HMASMPRL+2
PRLFLGS  EQU   PRLSPAN
PRLDATE  EQU   HMASMPRL+4
PRLTIME  EQU   HMASMPRL+7
PRLEND   EQU   HMASMPRL+10
HMASMSCP EQU   0
SCPCHAR  EQU   HMASMSCP
SCPSRCH  EQU   HMASMSCP+4
SCPIORTN EQU   HMASMSCP+12
SCPIOPAD EQU   HMASMSCP+16
SCPINLN  EQU   HMASMSCP+20
SCPPMLN  EQU   HMASMSCP+22
SCPEOR   EQU   HMASMSCP+24
SCPRETRN EQU   HMASMSCP+25
SCPRET   EQU   SCPRETRN
SCPSTRNG EQU   0
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPRCDLN EQU   HMASMGTP+4
GTPKEYLN EQU   HMASMGTP+6
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
GTPPSIZE EQU   GTPFLGS1
KEYROUT  EQU   0
JCLLINE  EQU   0
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
SCPIOPRM EQU   0
BUPPARM  EQU   0
BUPFUNCT EQU   BUPPARM
BUPTYPE  EQU   BUPPARM+1
BUPFLAGS EQU   BUPPARM+3
BUPIOPAD EQU   BUPPARM+12
HMASMCRP EQU   0
CRPSCPAD EQU   HMASMCRP+4
CRPINDS  EQU   HMASMCRP+8
CRPRETRN EQU   HMASMCRP+10
CRPFLG1  EQU   HMASMCRP+14
CRPFLG2  EQU   HMASMCRP+16
CRPINSW0 EQU   CRPFLG2
CRPINSW1 EQU   CRPFLG2
CRPINSW2 EQU   CRPFLG2
CRPINSW3 EQU   CRPFLG2
CRPBUFFR EQU   HMASMCRP+18
CRPBFCTL EQU   CRPBUFFR
CRPBFDTA EQU   CRPBFCTL
CRPBFCNT EQU   CRPBFCTL+71
BUFFER   EQU   0
MAXJCL   EQU   0
LINE     EQU   0
ACTION   EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00052 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00063 EQU   IOPUDATA
@NM00064 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPNTLVL EQU   IOPASMDR
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPAPF   EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPLMDF2 EQU   IOPLMLEP+1
IOPNE    EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLINK  EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLMDFX EQU   IOPLMDNT+24
@NM00073 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPLMDND EQU   IOPSYSLB
IOPLMIND EQU   IOPLNTRY+8
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMID  EQU   IOPRMIDE
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPFMID  EQU   IOPFMIDE
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00084 EQU   IOPSRCDR+1
@NM00086 EQU   @NM00084+7
@NM00090 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00094 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00100 EQU   IOPMODDR+1
@NM00102 EQU   @NM00100+7
@NM00106 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00110 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPDLIB  EQU   IOPMODFX+72
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODND EQU   IOPMODID
IOPMODST EQU   IOPLMODS+7
IOPMDIND EQU   IOPMNTRY+8
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00121 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00128 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00137 EQU   IOPPTFFX
@NM00138 EQU   @NM00137
IOPPDTES EQU   IOPPTFFX+41
@NM00141 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00166 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00166
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00170 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00170
IOPBFTB1 EQU   IOPBFTB0
PRLDATA  EQU   PRLEND
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00172 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00171 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00169 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00168 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00167 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00165 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00164 EQU   IOPPTSFX+35
@NM00163 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00162 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00161 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00160 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00159 EQU   IOPQFMDR
@NM00155 EQU   IOPQSMDR
@NM00154 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00153 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00152 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00151 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00150 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00149 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00148 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00147 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00146 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00145 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00144 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00143 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00142 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00141+3
IOPRECD  EQU   @NM00141
@NM00140 EQU   IOPPTFFX+8
@NM00139 EQU   @NM00137+7
IOPPRELN EQU   @NM00138
@NM00136 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00135 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00134 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00133 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00132 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00131 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00130 EQU   @NM00128+7
@NM00129 EQU   @NM00128
@NM00127 EQU   IOPSYSDR+5
@NM00126 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00125 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00124 EQU   IOPDLBFX+8
@NM00123 EQU   @NM00121+7
@NM00122 EQU   @NM00121
@NM00120 EQU   IOPDLBDR+1
@NM00119 EQU   IOPDLBDR
@NM00118 EQU   IOPMODST
@NM00117 EQU   IOPMODFX+12
@NM00116 EQU   IOPMODF4
@NM00115 EQU   IOPMODF3
@NM00114 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00113 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00112 EQU   @NM00110+7
@NM00111 EQU   @NM00110
@NM00109 EQU   IOPMODDR+17
@NM00108 EQU   @NM00106+7
@NM00107 EQU   @NM00106
@NM00105 EQU   @NM00102
@NM00104 EQU   @NM00102
@NM00103 EQU   @NM00102
@NM00101 EQU   @NM00100
@NM00099 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00098 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00097 EQU   IOPSRCFX+8
@NM00096 EQU   @NM00094+7
@NM00095 EQU   @NM00094
@NM00093 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00092 EQU   @NM00090+7
@NM00091 EQU   @NM00090
@NM00089 EQU   @NM00086
@NM00088 EQU   @NM00086
@NM00087 EQU   @NM00086
@NM00085 EQU   @NM00084
@NM00083 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00082 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00081 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00080 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
@NM00079 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00078 EQU   IOPRMST
@NM00077 EQU   IOPMACDR
@NM00075 EQU   @NM00073+7
@NM00074 EQU   @NM00073
@NM00072 EQU   IOPLMDDR+6
@NM00071 EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00070 EQU   IOPLMDF4
@NM00069 EQU   IOPLMDF3
@NM00068 EQU   IOPLMDF2
@NM00067 EQU   IOPFLGS2
@NM00066 EQU   IOPLMDDR
@NM00065 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPALLOC EQU   @NM00064+4
IOPUSED  EQU   @NM00064
IOPTPSEQ EQU   @NM00063+8
IOPVLSER EQU   @NM00063+2
IOPBLKSI EQU   @NM00063
IOPCQMAX EQU   IOPCQMAP+12
@NM00062 EQU   IOPCQMAP+11
@NM00061 EQU   IOPCQMAP+8
@NM00060 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00059 EQU   IOPSCMAP+11
@NM00058 EQU   IOPSCMAP+8
@NM00057 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00056 EQU   IOPNTMAX+11
@NM00055 EQU   IOPNTMAX+8
@NM00054 EQU   IOPNTMAX
@NM00053 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00052+5
IOPIPTF3 EQU   @NM00052
CRPDDNAM EQU   HMASMCRP+98
CRPBFSEQ EQU   CRPBUFFR+72
CRPINSWF EQU   CRPFLG2+1
CRPINSWE EQU   CRPFLG2+1
CRPINSWD EQU   CRPFLG2+1
CRPINSWC EQU   CRPFLG2+1
CRPINSWB EQU   CRPFLG2+1
CRPINSWA EQU   CRPFLG2+1
CRPINSW9 EQU   CRPFLG2+1
CRPINSW8 EQU   CRPFLG2+1
CRPINSW7 EQU   CRPFLG2
CRPINSW6 EQU   CRPFLG2
CRPINSW5 EQU   CRPFLG2
CRPINSW4 EQU   CRPFLG2
CRPEOF1  EQU   CRPINSW3
CRPWRTLG EQU   CRPINSW2
CRPEXADD EQU   CRPINSW1
CRPEOFSW EQU   CRPINSW0
@NM00177 EQU   CRPFLG1+1
CRPRPT   EQU   CRPFLG1+1
CRPLIST  EQU   CRPFLG1+1
CRPNOWPP EQU   CRPFLG1+1
CRPTRMEX EQU   CRPFLG1+1
CRPEOFEN EQU   CRPFLG1+1
CRPSCNCL EQU   CRPFLG1
CRPOFFST EQU   CRPFLG1
CRPOTHER EQU   CRPFLG1
CRPPRINT EQU   CRPFLG1
CRPLOG   EQU   CRPFLG1
CRPPTS   EQU   CRPFLG1
CRPLOGCK EQU   CRPFLG1
CRPBFPRM EQU   CRPFLG1
@NM00176 EQU   HMASMCRP+11
CRPOUTDS EQU   HMASMCRP+9
@NM00175 EQU   HMASMCRP+1
CRPUXNUM EQU   HMASMCRP
BUPGTPAD EQU   BUPPARM+16
@NM00002 EQU   BUPPARM+11
BUPSYSMD EQU   BUPPARM+4
@NM00001 EQU   BUPFLAGS
BUPREDO  EQU   BUPFLAGS
BUPSTYPE EQU   BUPPARM+2
@NM00181 EQU   HMASMGTP+27
@NM00180 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPWKAD  EQU   HMASMGTP+8
@NM00179 EQU   HMASMGTP+2
@NM00178 EQU   SCPEOR
SCPNORT  EQU   SCPEOR
SCPNOSUC EQU   SCPEOR
SCPRTERR EQU   SCPEOR
SCPCOMNT EQU   SCPEOR
SCPNOCT  EQU   SCPEOR
SCPCONT  EQU   SCPEOR
SCPWKAR  EQU   HMASMSCP+8
PRLCONC  EQU   PRLTIME+2
@NM00174 EQU   PRLTIME
PRLHDADR EQU   PRLDATE
@NM00173 EQU   PRLFLGS
PRLBLANK EQU   PRLFLGS
PRLHEADO EQU   PRLFLGS
PRLHEAD  EQU   PRLFLGS
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00158 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00157 EQU   @NM00156+7
IOPQSMFM EQU   @NM00156
@NM00076 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
@NM00051 EQU   IOPUSERL
@NM00050 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00049 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00048 EQU   @NM00045+10
IOPSEQNO EQU   @NM00045+8
@NM00047 EQU   @NM00046+7
IOPPTFNM EQU   @NM00046
IOPNAM17 EQU   IOPNAME
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00044 EQU   CCABLDLM+2
@NM00043 EQU   CCABLDLM
CCAUPDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00041+12
CCAUPDTE EQU   @NM00041+8
CCAUPDNM EQU   @NM00041
CCASUPPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00039+12
CCAIOSUP EQU   @NM00039+8
CCASUPNM EQU   @NM00039
CCAZAPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00037+12
CCASPZAP EQU   @NM00037+8
CCAZAPNM EQU   @NM00037
CCACOMPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00035+12
CCACOMRS EQU   @NM00035+8
CCACOMNM EQU   @NM00035
CCACPYPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00033+12
CCACOPY  EQU   @NM00033+8
CCACPYNM EQU   @NM00033
CCAASMPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00031+12
CCAASM   EQU   @NM00031+8
CCAASMNM EQU   @NM00031
CCALKDPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00029+12
CCALKED  EQU   @NM00029+8
CCALKDNM EQU   @NM00029
CCAPGMPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCABPGRC EQU   @NM00027+20
CCABPGSP EQU   @NM00027+12
CCABPGAD EQU   @NM00027+8
CCABPGNM EQU   @NM00027
CCAEND   EQU   HMASMCCA+371
@NM00026 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00025 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00024 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00023 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00022 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00021 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00020 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00019 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00018 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00017 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00016 EQU   @NM00011+18
@NM00015 EQU   @NM00011+16
CCATBLPA EQU   @NM00011+12
@NM00014 EQU   @NM00011+8
@NM00013 EQU   @NM00011+4
@NM00012 EQU   @NM00011
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00010 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00009 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00008 EQU   CCAFBUFR+122
@NM00007 EQU   CCAFBUFR+120
@NM00006 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00005 EQU   CCAFBUFR+88
@NM00004 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00003 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00334 EQU   @RC00333
@RT00353 EQU   REREAD
@RF00363 EQU   @RC00330
@RC00361 EQU   @RC00330
@RC00346 EQU   @RC00330
@RT00409 EQU   MODKEYGT
@RT00421 EQU   MODNMGT2
@RF00451 EQU   SCANBMP
@RF00455 EQU   SCANBMP
@RF00459 EQU   SCANBMP
@RF00463 EQU   SCANBMP
@RF00467 EQU   SCANBMP
@RT00471 EQU   JCLRTN
@RF00473 EQU   SCANBMP
@RT00477 EQU   JCLRTN
@RF00479 EQU   SCANBMP
@RF00483 EQU   SCANBMP
@RT00490 EQU   SCANBMP
@RT00494 EQU   SCANBMP
@RT00500 EQU   PICKLIB2
@RF00519 EQU   SCANBMP
@RF00526 EQU   SCANBMP
@RC00544 EQU   @EL00006
@RC00535 EQU   @EL00006
@RC00559 EQU   @EL00007
@RT00611 EQU   WRITECC
@RF00649 EQU   @RC00646
@RF00818 EQU   @RC00814
@RF00352 EQU   @RC00346
@RF00561 EQU   @RC00559
@ENDDATA EQU   *
         END   HMASMLKD,(C'PLS2046',0802,78334)

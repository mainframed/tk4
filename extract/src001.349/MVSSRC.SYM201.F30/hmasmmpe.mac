         TITLE 'HMASMMPE - MODIFICATION ELEMENT PARSE ROUTINE'
HMASMMPE CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMMPE  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0223
*   /*****************************************************************/
*   /*                                                               */
*   /* START OF HMASMMPE FUNCTION. INITIALIZE HMASMSCN & HMASMMSG    */
*   /* PARMS, THE MCB AND LOCAL DECLARES                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0224
*   CALL MPESETUP;                  /* SETUP AND INITIALIZE PROC     */
*                                                                  0224
         BAL   @14,MPESETUP                                        0224
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN THE ELEMENT MODIFICATION CONTROL STATEMENTS OF THE PTF   */
*   /* THE PROGRAM LOOPS BACK TO HERE WHEN THE PROCESSING FOR THE    */
*   /* ELEMENT HAS BEEN COMPLETED AND THE MCB FOR THAT ELEMENT HAS   */
*   /* BEEN BUILT                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0225
*   CALL MPESCAN;                   /* SCAN THE ELEMENT CONTROL    0225
*                                      STATEMENTS                    */
*                                                                  0225
         BAL   @14,MPESCAN                                         0225
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SCAN COMPLETED SUCCESSFULLY & IF IOP ADDRESS PASSED THEN   */
*   /* BUILD THE IOPPNTRY FOR THIS ELEMENT FROM DATA IN THE MCB      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0226
*   IF MPECODE=SCPGOOD              /* WAS SCAN PROCESS OK           */
*       &MPPIOPAD^=ZERO             /* WAS IOP ADDRESS PASSED        */
*     THEN                          /* YES                           */
         SLR   @08,@08                                             0226
         C     @08,MPECODE                                         0226
         BNE   @RF00226                                            0226
         L     @15,@PC00001                                        0226
         C     @08,MPPIOPAD(,@15)                                  0226
         BE    @RF00226                                            0226
*     CALL MPEIOPBD;                /* CALL IOPPNTRY BUILD PROCEDURE */
         BAL   @14,MPEIOPBD                                        0227
*   GOTO ENDOFMPE;                  /* GO END HMASMMPE PROCESSING    */
         B     ENDOFMPE                                            0228
*                                                                  0229
*   /*****************************************************************/
*   /*                                                               */
*   /* MPESETUP - SETUP SUBROUTINE PARAMETER LISTS AND INITIALIZE    */
*   /* LOCAL FIELDS AND THE MCB                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0229
*MPESETUP:                                                         0229
*   PROC;                                                          0229
*                                                                  0229
MPESETUP STM   @14,@12,12(@13)                                     0229
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR THE MCB AND INITIALIZE LOCAL VARIABLES                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0230
*   MPECODE=ZERO;                   /* INIT RETURN CODE              */
         SLR   @08,@08                                             0230
         ST    @08,MPECODE                                         0230
*   ASMPGMLN=ZERO;                  /* INIT ASM PGM LEN ON JCLIN     */
         MVI   ASMPGMLN,X'00'                                      0231
*   CPYPGMLN=ZERO;                  /* INIT CPY PGM LEN ON JCLIN     */
         MVI   CPYPGMLN,X'00'                                      0232
*   LKEPGMLN=ZERO;                  /* INIT LKE PGM LEN ON JCLIN     */
         MVI   LKEPGMLN,X'00'                                      0233
*   UPDPGMLN=ZERO;                  /* INIT UPD PGM LEN ON JCLIN     */
         MVI   UPDPGMLN,X'00'                                      0234
*   LOCALBIT=''B;                   /* INIT KEYWORD BITS             */
         XC    LOCALBIT(4),LOCALBIT                                0235
*   XTRABITS=''B;                   /* INIT KEYWORD BITS             */
         MVI   XTRABITS,X'00'                                      0236
*   MCBELEMP='';                    /* INITIALIZE MCB TO BLANKS      */
         L     @08,@PC00001                                        0237
         L     @15,MPPMCBAD(,@08)                                  0237
         MVI   MCBELEMP(@15),C' '                                  0237
         MVC   MCBELEMP+1(140,@15),MCBELEMP(@15)                   0237
*   MCBELASM=ZERO;                  /* ZERO JCLIN ASM NAME LENGTH    */
         MVI   MCBELASM(@15),X'00'                                 0238
*   MCBELCPY=ZERO;                  /* ZERO JCLIN COPY NAME LENGTH   */
         MVI   MCBELCPY(@15),X'00'                                 0239
*   MCBELUPI=ZERO;                  /* ZERO JCLIN UPDATE NAME LENGTH */
         MVI   MCBELUPI(@15),X'00'                                 0240
*   MCBELLKD=ZERO;                  /* ZERO JCLIN LKED NAME LENGTH   */
         MVI   MCBELLKD(@15),X'00'                                 0241
*   MCBELEPM=''B;                   /* TURN OFF BITS                 */
         XC    MCBELEPM(4,@15),MCBELEPM(@15)                       0242
*   MCBEFLG5=''B;                   /* TURN OFF BITS                 */
         MVI   MCBEFLG5(@15),X'00'                                 0243
*   MCBEND(1)=IOPEOLST;             /* INIT END OF MCB               */
*                                                                  0244
         MVI   MCBEND(@15),X'FF'                                   0244
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMSCN PARAMETER INITIALIZATION                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0245
*   SCPCHAR=ADDR(CRPBUFFR);         /* INPUT BUFFER                  */
         L     @15,MPPCRDPM(,@08)                                  0245
         LA    @14,CRPBUFFR(,@15)                                  0245
         ST    @14,SCPCHAR                                         0245
*   SCPSRCH=AMODSCAN;               /* SCANS FOR MODULE SEARCH       */
         MVC   SCPSRCH(4),AMODSCAN                                 0246
*   SCPIORTN=MPPCRDAD;              /* FOR ADDITIONAL RECORDS DURING
*                                      SCAN GO HERE                  */
         MVC   SCPIORTN(4),MPPCRDAD(@08)                           0247
*   SCPIOPAD=MPPCRDPM;              /* READ ROUTINE PARAMETER LIST   */
         ST    @15,SCPIOPAD                                        0248
*   SCPINLN=LENGTH(CRPBFCTL);       /* SET LENGTH OF INPUT BUFFER=72 */
         MVC   SCPINLN(2),@CH00839                                 0249
*   SCPEOR=ZERO;                    /* CLEAR END OF RECORD FLAG      */
         MVI   SCPEOR,X'00'                                        0250
*   SCPCOMNT=ON;                    /* SET SKIP-BY COMMENTS DURING 0251
*                                      SCAN                          */
*   SCPCONT=ON;                     /* SET READ CONTINUATION RECORD  */
*   SCPRTERR=OFF;                   /* SET OFF ROUT ERROR MSG SWITCH */
         OI    SCPCOMNT,B'10100000'                                0253
         NI    SCPRTERR,B'11101111'                                0253
*   CRPSCPAD=ADDR(HMASMSCP);        /* ADDRESS OF SCAN PARM FOR    0254
*                                      HMASMCRD                      */
*                                                                  0254
         LA    @08,HMASMSCP                                        0254
         ST    @08,CRPSCPAD(,@15)                                  0254
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMMSG PARAMETER INITIALIZATION                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0255
*   HMASMMGP=''B;                   /* CLEAR MGP                     */
         XC    HMASMMGP(28),HMASMMGP                               0255
*   MGPHLDS=ON;                     /* MESSAGES TO LOG               */
*   MGPPRINT=ON;                    /* MESSAGES TO PRINTER           */
         OI    MGPHLDS,B'10010000'                                 0257
*   END MPESETUP;                                                  0258
@EL00002 DS    0H                                                  0258
@EF00002 DS    0H                                                  0258
@ER00002 LM    @14,@12,12(@13)                                     0258
         BR    @14                                                 0258
*                                                                  0259
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN - SCAN THE ELEMENT MODIFICATION CONTROL STATEMENTS OF THE*/
*   /* SYSMOD FOR SYNTAX, MUTUALLY EXCLUSIVE KEYWORDS OR ANY         */
*   /* COMBINATION OF INVALID CONDITIONS. THE ELEMENT TYPES ARE:     */
*   /* ++MOD ++MAC ++ZAP ++SRC ++SRCUPD ++UPDTE ++MACUPD+ ++JCLIN.   */
*   /* HMASMSCN WILL CALL THE PROPER DSCAN ROUT TO PROCESS THE       */
*   /* KEYWORDS AND SAVE THEIR VALUES IN THE MCB BEING BUILT.        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0259
*MPESCAN:                                                          0259
*   PROC;                                                          0259
MPESCAN  STM   @14,@12,@SA00003                                    0259
*   CALL HMASMSCN(HMASMSCP);        /* SCAN MODULE HEADER            */
*                                                                  0260
         L     @15,@CV01419                                        0260
         LA    @01,@AL00260                                        0260
         BALR  @14,@15                                             0260
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF HMASMSCN & HMASMCRD (OPTIONALLY) WERE SUCCESSFULL*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0261
*   IF SCPRET=SCPGOOD THEN          /* IF SCAN SUCCESSFUL            */
         CLI   SCPRET,0                                            0261
         BNE   @RF00261                                            0261
*     DO;                                                          0262
*       IF CRPRETRN^=CRPGOOD THEN   /* IF UNUSAL READ CONDITION      */
         L     @08,@PC00001                                        0263
         L     @08,MPPCRDPM(,@08)                                  0263
         CLI   CRPRETRN(@08),0                                     0263
         BE    @RF00263                                            0263
*         DO;                                                      0264
*           IF CRPRETRN=CRPEOF THEN /* UNEXPECTED FILE END           */
         CLI   CRPRETRN(@08),4                                     0265
         BNE   @RF00265                                            0265
*             DO;                                                  0266
*               CRPRETRN=CRPTPTF;   /* STOP THE PTF                  */
         MVI   CRPRETRN(@08),X'08'                                 0267
*               CALL UCRDEOF;       /* INCOMPLETE CNTL STMT MSG      */
         BAL   @14,UCRDEOF                                         0268
*             END;                                                 0269
*         END;                                                     0270
*     END;                                                         0271
*   ELSE                                                           0272
*     DO;                           /* IF SCAN WAS UNSUCCESSFUL      */
         B     @RC00261                                            0272
@RF00261 DS    0H                                                  0273
*       IF SCPRTERR=OFF THEN        /* IF ERROR MESSAGE NOT SENT     */
         TM    SCPRTERR,B'00010000'                                0273
         BNZ   @RF00273                                            0273
*         CALL SYNTXMSG;            /* GENERATE SYNTAX MESSAGE       */
         BAL   @14,SYNTXMSG                                        0274
*     END;                          /* END SCAN UNSUCCESSFULL        */
@RF00273 DS    0H                                                  0276
*   MPECODE=MAX(MPECODE,SCPRET,CRPRETRN);/* HIGHEST RC IS IN MPECODE */
@RC00261 L     @08,MPECODE                                         0276
         SLR   @15,@15                                             0276
         IC    @15,SCPRET                                          0276
         CR    @08,@15                                             0276
         BNL   *+6
         LR    @08,@15                                             0276
         L     @15,@PC00001                                        0276
         L     @01,MPPCRDPM(,@15)                                  0276
         SLR   @00,@00                                             0276
         IC    @00,CRPRETRN(,@01)                                  0276
         CR    @08,@00                                             0276
         BNL   *+6
         LR    @08,@00                                             0276
         ST    @08,MPECODE                                         0276
*   END MPESCAN;                                                   0277
@EL00003 DS    0H                                                  0277
@EF00003 DS    0H                                                  0277
@ER00003 LM    @14,@12,@SA00003                                    0277
         BR    @14                                                 0277
*                                                                  0278
*   /*****************************************************************/
*   /*                                                               */
*   /* PUT ELEMENT NAME AND TYPE INDICATOR INTO THE CURRENT PTF IOP  */
*   /* VARIABLE ELEMENT LIST (EXCEPT IF ++JCLIN).                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0278
*MPEIOPBD:                                                         0278
*   PROC;                           /*                               */
*                                                                  0278
MPEIOPBD STM   @14,@12,@SA00004                                    0278
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS DETECTED IN THE SCAN OF THE CONTROL STATEMENTS,  */
*   /* THEN CONSTRUCT THE IOPPNTRY (EXCEPT FOR ++JCLIN).             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0279
*   IF JCL=ON THEN                  /* IS TYPE JCLIN                 */
         TM    JCL,B'00000010'                                     0279
         BNO   @RF00279                                            0279
*     DO;                                                          0280
*                                                                  0280
*       /*************************************************************/
*       /*                                                           */
*       /* THIS ROUTINE FOR ++JCLIN ONLY                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0281
*       IF IOPJCLP=ON THEN                                         0281
         L     @08,@PC00001                                        0281
         L     @08,MPPIOPAD(,@08)                                  0281
         TM    IOPJCLP(@08),B'00000010'                            0281
         BNO   @RF00281                                            0281
*         DO;                       /* IF THIS IOP HAS JCLIN ALREAD  */
*           MGPVARPT(1)=ADDR(CHJCLIN);/* FILL IN JCLIN IN MSG        */
         LA    @08,@CC01449                                        0283
         ST    @08,MGPVARPT                                        0283
*           MGPVARPT(2)=ADDR(CHSYSMOD);/* FILL SYSMOD IN MSG         */
         LA    @08,@CC01517                                        0284
         ST    @08,MGPVARPT+4                                      0284
*           CALL DUPKYWRD;          /* SEND MSG, SET RC=8, AND TERM  */
         BAL   @14,DUPKYWRD                                        0285
*         END;                                                     0286
*       ELSE                                                       0287
*         IOPJCLP=ON;               /* INDICATE JCLIN FOR THIS IOP   */
         B     @RC00281                                            0287
@RF00281 L     @08,@PC00001                                        0287
         L     @08,MPPIOPAD(,@08)                                  0287
         OI    IOPJCLP(@08),B'00000010'                            0287
*     END;                                                         0288
*   ELSE                                                           0289
*     DO;                                                          0289
*                                                                  0289
         B     @RC00279                                            0289
@RF00279 DS    0H                                                  0290
*       /*************************************************************/
*       /*                                                           */
*       /* DO THIS ROUTINE FOR ALL OTHER ELEMENT CONTROL STATEMENTS  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0290
*                                                                  0290
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP TILL EITHER THE END OF LIST (IOPEOLST) , A MATCHING  */
*       /* ELEMENT NAME (DUPELEM) , PEMAX SIZE IS EXHAUSTED (PEMAX). */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0290
*       DO INDX=1 BY 1 TO CCAPEMAX WHILE IOPPTFND(INDX)^=IOPEOLST& 0290
*             MPECODE<STOPPTF;                                     0290
*                                                                  0290
         LA    @08,1                                               0290
         ST    @08,INDX                                            0290
         B     @DE00290                                            0290
@DL00290 MH    @08,@CH00035                                        0290
         L     @15,@PC00001                                        0290
         L     @14,MPPIOPAD(,@15)                                  0290
         SLR   @07,@07                                             0290
         IC    @07,IOPPTFND-9(@08,@14)                             0290
         CH    @07,@CH00628                                        0290
         BE    @DC00290                                            0290
         L     @07,MPECODE                                         0290
         CH    @07,@CH00119                                        0290
         BNL   @DC00290                                            0290
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR DUPLICATE ELEMENTS IN SYSMOD                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0291
*         IF IOPPMODS(INDX)=MCBENAME THEN/* TEST DUP ELEM            */
         L     @01,MPPMCBAD(,@15)                                  0291
         ST    @08,@TF00001                                        0291
         ALR   @08,@14                                             0291
         CLC   IOPPMODS-9(8,@08),MCBENAME(@01)                     0291
         BNE   @RF00291                                            0291
*           DO;                                                    0292
*             IF MOD=ON&IOPPIND(INDX)=IOPPMOD THEN                 0293
         TM    MOD,B'10000000'                                     0293
         BNO   @RF00293                                            0293
         L     @08,@TF00001                                        0293
         SLR   @15,@15                                             0293
         IC    @15,IOPPIND-9(@08,@14)                              0293
         CH    @15,@CH00094                                        0293
         BNE   @RF00293                                            0293
*               CALL DUPELEM;                                      0294
         BAL   @14,DUPELEM                                         0294
*             IF MOD=ON&IOPPIND(INDX)=IOPPZAP THEN                 0295
@RF00293 TM    MOD,B'10000000'                                     0295
         BNO   @RF00295                                            0295
         L     @08,INDX                                            0295
         MH    @08,@CH00035                                        0295
         L     @15,@PC00001                                        0295
         L     @01,MPPIOPAD(,@15)                                  0295
         SLR   @00,@00                                             0295
         IC    @00,IOPPIND-9(@08,@01)                              0295
         CH    @00,@CH00190                                        0295
         BNE   @RF00295                                            0295
*               CALL DUPELEM;                                      0296
         BAL   @14,DUPELEM                                         0296
*             IF MAC=ON&IOPPIND(INDX)=IOPPMCR THEN                 0297
@RF00295 TM    MAC,B'01000000'                                     0297
         BNO   @RF00297                                            0297
         L     @08,INDX                                            0297
         MH    @08,@CH00035                                        0297
         L     @15,@PC00001                                        0297
         L     @01,MPPIOPAD(,@15)                                  0297
         SLR   @00,@00                                             0297
         IC    @00,IOPPIND-9(@08,@01)                              0297
         CH    @00,@CH00047                                        0297
         BNE   @RF00297                                            0297
*               CALL DUPELEM;                                      0298
         BAL   @14,DUPELEM                                         0298
*             IF MAC=ON&IOPPIND(INDX)=IOPPMCU THEN                 0299
@RF00297 TM    MAC,B'01000000'                                     0299
         BNO   @RF00299                                            0299
         L     @08,INDX                                            0299
         MH    @08,@CH00035                                        0299
         L     @15,@PC00001                                        0299
         L     @01,MPPIOPAD(,@15)                                  0299
         SLR   @00,@00                                             0299
         IC    @00,IOPPIND-9(@08,@01)                              0299
         CH    @00,@CH00137                                        0299
         BNE   @RF00299                                            0299
*               CALL DUPELEM;                                      0300
         BAL   @14,DUPELEM                                         0300
*             IF SRC=ON&IOPPIND(INDX)=IOPPSCR THEN                 0301
@RF00299 TM    SRC,B'00001000'                                     0301
         BNO   @RF00301                                            0301
         L     @08,INDX                                            0301
         MH    @08,@CH00035                                        0301
         L     @15,@PC00001                                        0301
         L     @01,MPPIOPAD(,@15)                                  0301
         SLR   @00,@00                                             0301
         IC    @00,IOPPIND-9(@08,@01)                              0301
         CH    @00,@CH00207                                        0301
         BNE   @RF00301                                            0301
*               CALL DUPELEM;                                      0302
         BAL   @14,DUPELEM                                         0302
*             IF SRC=ON&IOPPIND(INDX)=IOPPSCU THEN                 0303
@RF00301 TM    SRC,B'00001000'                                     0303
         BNO   @RF00303                                            0303
         L     @08,INDX                                            0303
         MH    @08,@CH00035                                        0303
         L     @15,@PC00001                                        0303
         L     @01,MPPIOPAD(,@15)                                  0303
         SLR   @00,@00                                             0303
         IC    @00,IOPPIND-9(@08,@01)                              0303
         CH    @00,@CH00043                                        0303
         BNE   @RF00303                                            0303
*               CALL DUPELEM;                                      0304
         BAL   @14,DUPELEM                                         0304
*           END;                                                   0305
@RF00303 DS    0H                                                  0306
*       END;                                                       0306
@RF00291 LA    @08,1                                               0306
         AL    @08,INDX                                            0306
         ST    @08,INDX                                            0306
@DE00290 CH    @08,CCAPEMAX(,CCAPTR)                               0306
         BNH   @DL00290                                            0306
@DC00290 DS    0H                                                  0307
*                                                                  0307
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK PEMAX                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0307
*       IF INDX>CCAPEMAX THEN                                      0307
         L     @08,INDX                                            0307
         CH    @08,CCAPEMAX(,CCAPTR)                               0307
         BNH   @RF00307                                            0307
*         CALL PEMAX;               /* EXCEEDED PEMAX SIZE           */
         BAL   @14,PEMAX                                           0308
*                                                                  0309
*       /*************************************************************/
*       /*                                                           */
*       /* IF NOT A DUPLICATE ELEMENT AND PEMAX NOT EXCEEDED, BUILD  */
*       /* IOPPNTRY                                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0309
*       IF MPECODE=SCPGOOD THEN     /* HAS ANY ERROR BEEN DETECTED   */
@RF00307 L     @08,MPECODE                                         0309
         LTR   @08,@08                                             0309
         BNZ   @RF00309                                            0309
*         DO;                                                      0310
*           IOPPMODS(INDX)=MCBENAME;                               0311
         L     @08,INDX                                            0311
         MH    @08,@CH00035                                        0311
         L     @15,@PC00001                                        0311
         L     @14,MPPIOPAD(,@15)                                  0311
         ST    @08,@TF00001                                        0311
         ALR   @08,@14                                             0311
         L     @01,MPPMCBAD(,@15)                                  0311
         MVC   IOPPMODS-9(8,@08),MCBENAME(@01)                     0311
*           IF MOD=ON THEN                                         0312
         TM    MOD,B'10000000'                                     0312
         BNO   @RF00312                                            0312
*             IOPPIND(INDX)=IOPPMOD;/* INDICATE MOD                  */
         LA    @08,1                                               0313
         L     @15,@TF00001                                        0313
         STC   @08,IOPPIND-9(@15,@14)                              0313
*           IF MAC=ON THEN                                         0314
@RF00312 TM    MAC,B'01000000'                                     0314
         BNO   @RF00314                                            0314
*             IOPPIND(INDX)=IOPPMCR;/* INDICATE MAC                  */
         L     @08,INDX                                            0315
         MH    @08,@CH00035                                        0315
         L     @15,@PC00001                                        0315
         L     @01,MPPIOPAD(,@15)                                  0315
         LA    @00,4                                               0315
         STC   @00,IOPPIND-9(@08,@01)                              0315
*           IF SRC=ON THEN                                         0316
@RF00314 TM    SRC,B'00001000'                                     0316
         BNO   @RF00316                                            0316
*             IOPPIND(INDX)=IOPPSCR;/* INDICATE SRC                  */
         L     @08,INDX                                            0317
         MH    @08,@CH00035                                        0317
         L     @15,@PC00001                                        0317
         L     @01,MPPIOPAD(,@15)                                  0317
         LA    @00,6                                               0317
         STC   @00,IOPPIND-9(@08,@01)                              0317
*           IF ZAP=ON THEN                                         0318
@RF00316 TM    ZAP,B'00010000'                                     0318
         BNO   @RF00318                                            0318
*             IOPPIND(INDX)=IOPPZAP;/* INDICATE ZAP                  */
         L     @08,INDX                                            0319
         MH    @08,@CH00035                                        0319
         L     @15,@PC00001                                        0319
         L     @01,MPPIOPAD(,@15)                                  0319
         LA    @00,2                                               0319
         STC   @00,IOPPIND-9(@08,@01)                              0319
*           IF UPD=ON THEN                                         0320
@RF00318 TM    UPD,B'00100000'                                     0320
         BNO   @RF00320                                            0320
*             IOPPIND(INDX)=IOPPMCU;/* INDIC UPDTE,MACUPD            */
         L     @08,INDX                                            0321
         MH    @08,@CH00035                                        0321
         L     @15,@PC00001                                        0321
         L     @01,MPPIOPAD(,@15)                                  0321
         LA    @00,5                                               0321
         STC   @00,IOPPIND-9(@08,@01)                              0321
*           IF SRU=ON THEN                                         0322
@RF00320 TM    SRU,B'00000100'                                     0322
         BNO   @RF00322                                            0322
*             IOPPIND(INDX)=IOPPSCU;/* INDICATE SRCUPD               */
         L     @08,INDX                                            0323
         MH    @08,@CH00035                                        0323
         L     @15,@PC00001                                        0323
         L     @01,MPPIOPAD(,@15)                                  0323
         LA    @00,7                                               0323
         STC   @00,IOPPIND-9(@08,@01)                              0323
*           INDX=INDX+1;            /* BUMP TO NEXT IOPPNTRY         */
@RF00322 LA    @08,1                                               0324
         AL    @08,INDX                                            0324
         ST    @08,INDX                                            0324
*           IF INDX>CCAPEMAX THEN                                  0325
         CH    @08,CCAPEMAX(,CCAPTR)                               0325
         BNH   @RF00325                                            0325
*             CALL PEMAX;           /* TEST FOR PEMAX LIMIT          */
         BAL   @14,PEMAX                                           0326
*           ELSE                                                   0327
*             IOPPTFND(INDX)=IOPEOLST;/* SET IF PEMAX LIMIT OK       */
         B     @RC00325                                            0327
@RF00325 L     @08,INDX                                            0327
         MH    @08,@CH00035                                        0327
         L     @15,@PC00001                                        0327
         L     @01,MPPIOPAD(,@15)                                  0327
         LA    @00,255                                             0327
         STC   @00,IOPPTFND-9(@08,@01)                             0327
*         END;                      /* END OF IF MPECODE=SCPGOOD     */
*     END;                          /* END OF JCL^=ON PROCESS        */
*   END MPEIOPBD;                   /*                               */
@EL00004 DS    0H                                                  0330
@EF00004 DS    0H                                                  0330
@ER00004 LM    @14,@12,@SA00004                                    0330
         BR    @14                                                 0330
*SYNTXMSG:                                                         0331
*   PROC;                                                          0331
*                                                                  0331
SYNTXMSG STM   @14,@12,@SA00005                                    0331
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT TO DECIMAL AND UNPACK WORK AREAS                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0332
*   DCL                                                            0332
*     COLSTR FIXED(8) CONSTANT(7);  /* STARTING BYTE FOR UNPACK      */
*   DCL                                                            0333
*     COLSTP FIXED(8) CONSTANT(9);  /* ENDING BYTE FOR UNPACK        */
*   DCL                                                            0334
*     HEXNO FIXED(31);              /* HEX NUMBER                    */
*   DCL                                                            0335
*     1 DECNO BDY(DWORD),           /* CONVERTED DECIMAL NUMBER      */
*      2 DECNO1 CHAR(8),            /* ACTUAL DECIMAL NUMBER         */
*      2 * CHAR(1);                 /* EXTRA FOR UNPACK              */
*   DCL                                                            0336
*     1 BCDNO BDY(WORD) CHAR(5),    /* EBCDIC NUMBER                 */
*      2 * CHAR(1),                 /* PADDING FOR 2 DIGIT NUMBER    */
*      2 BCDCOL CHAR(2),            /* COLUMN NUMBER                 */
*      2 * CHAR(2);                 /* EXCESS FOR SIGN               */
*                                                                  0336
*   /*****************************************************************/
*   /*                                                               */
*   /* SYNTAX ERROR MESSAGE ROUTINE                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   HEXNO=SCPCHAR-ADDR(CRPBUFFR)+1; /* GET COLUMN NUMBER             */
         L     @08,@PC00001                                        0337
         L     @08,MPPCRDPM(,@08)                                  0337
         LA    @08,CRPBUFFR(,@08)                                  0337
         LCR   @08,@08                                             0337
         AL    @08,SCPCHAR                                         0337
         AH    @08,@CH00094                                        0337
         ST    @08,HEXNO                                           0337
*   CVD(HEXNO,DECNO1);              /* CONVERT TO DECIMAL            */
         CVD   @08,DECNO1                                          0338
*   UNPK(BCDNO,DECNO(COLSTR:COLSTP));/* UNPACK NUMBER                */
         UNPK  BCDNO(5),DECNO+6(3)                                 0339
*   MGPMGNO1=HMA203I;               /* SYNTAX ERROR MESSAGE          */
         MVC   MGPMGNO1(2),@CH00047                                0340
*   MGPMGNO2=PART021;               /* CONTROL STATEMENT             */
         MVC   MGPMGNO2(2),@CH00459                                0341
*   MGPMGNO3=PART026;               /* AT COL                        */
         MVC   MGPMGNO3(2),@CH00469                                0342
*   MGPVARPT(1)=ADDR(BCDCOL);       /* MESSAGE TEXT COLUMN NUMBER    */
         LA    @08,BCDCOL                                          0343
         ST    @08,MGPVARPT                                        0343
*   MGPTYPE=MGPERR;                 /* MESSAGE SEVERITY              */
         MVI   MGPTYPE,X'03'                                       0344
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MESSAGE                 */
         L     @15,@CV01420                                        0345
         LA    @01,@AL00345                                        0345
         BALR  @14,@15                                             0345
*   END SYNTXMSG;                   /* END SYNTAX ROUTINE            */
@EL00005 DS    0H                                                  0346
@EF00005 DS    0H                                                  0346
@ER00005 LM    @14,@12,@SA00005                                    0346
         BR    @14                                                 0346
*                                                                  0347
*   /*****************************************************************/
*   /*                                                               */
*   /* UNEXPECTED END OF FILE RETURNED FROM HMASMCRD (I/O ROUTINE)   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0347
*UCRDEOF:                                                          0347
*   PROC;                           /* UNEXPECTED END OF FILE ON A 0347
*                                      CONTINUATION                  */
UCRDEOF  STM   @14,@12,@SA00006                                    0347
*   MGPMGNO1=HMA252I;               /* INCOMPLETE STATEMENT MESSAGE  */
         MVC   MGPMGNO1(2),@CH01424                                0348
*   MGPTYPE=MGPERR;                 /* MESSAGE SEVERITY              */
         MVI   MGPTYPE,X'03'                                       0349
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MESSAGE                 */
         L     @15,@CV01420                                        0350
         LA    @01,@AL00350                                        0350
         BALR  @14,@15                                             0350
*   END UCRDEOF;                                                   0351
@EL00006 DS    0H                                                  0351
@EF00006 DS    0H                                                  0351
@ER00006 LM    @14,@12,@SA00006                                    0351
         BR    @14                                                 0351
*                                                                  0352
*   /*****************************************************************/
*   /*                                                               */
*   /* MORE THAN 1 ++JCLIN ENCOUNTERED FOR THIS SYSMOD OR SAME       */
*   /* KEYWORD CODED TWICE ON SAME CONTROL STATEMENT. NOTE THAT      */
*   /* MGPVARPT(1,2) ARE SET BEFORE CALL.                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0352
*DUPKYWRD:                                                         0352
*   PROC;                           /* MULTIPLE ++JCLIN/KEYWORD    0352
*                                      ENCOUNTERED                   */
DUPKYWRD STM   @14,@12,@SA00007                                    0352
*   MGPMGNO1=HMA342I;               /* MULTIPLE JCLIN/KEYWORD MSG    */
         MVC   MGPMGNO1(2),@CH01435                                0353
*   MGPTYPE=MGPERR;                 /* MESSAGE SEVERITY              */
         MVI   MGPTYPE,X'03'                                       0354
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MESSAGE                 */
         L     @15,@CV01420                                        0355
         LA    @01,@AL00355                                        0355
         BALR  @14,@15                                             0355
*   MPECODE=MAX(MPECODE,STOPPTF);   /* SET RC TO HIGHEST RC HIT OR 0356
*                                      MIN=8                         */
         L     @08,MPECODE                                         0356
         LA    @15,8                                               0356
         CR    @08,@15                                             0356
         BNL   *+6
         LR    @08,@15                                             0356
         ST    @08,MPECODE                                         0356
*   END DUPKYWRD;                                                  0357
@EL00007 DS    0H                                                  0357
@EF00007 DS    0H                                                  0357
@ER00007 LM    @14,@12,@SA00007                                    0357
         BR    @14                                                 0357
*                                                                  0358
*   /*****************************************************************/
*   /*                                                               */
*   /* ++ZAP,++SRC,++SRCUPD NOT ALLOWED IN ++FUNCTION SYSMOD. NOTE   */
*   /* THAT MGPVARPT(1) IS SET BEFORE CALL.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0358
*NOTINFUN:                                                         0358
*   PROC;                           /* INVALID CNTL STMT IN FUNCTION
*                                      SYSMOD                        */
NOTINFUN STM   @14,@12,@SA00008                                    0358
*   MGPMGNO1=HMA338I;               /* CNTL STMT NOT VALID IN FUNC   */
         MVC   MGPMGNO1(2),@CH00873                                0359
*   MGPMGNO2=PART075;               /* IF NOT FUNCTION SYSMOD        */
         MVC   MGPMGNO2(2),@CH01439                                0360
*   MGPMGNO3=ZERO;                  /* NO THIRD MESSAGE              */
         SLR   @08,@08                                             0361
         STH   @08,MGPMGNO3                                        0361
*   MGPTYPE=MGPERR;                 /* MESSAGE SEVERITY              */
         MVI   MGPTYPE,X'03'                                       0362
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MESSAGE                 */
         L     @15,@CV01420                                        0363
         LA    @01,@AL00363                                        0363
         BALR  @14,@15                                             0363
*   END NOTINFUN;                                                  0364
@EL00008 DS    0H                                                  0364
@EF00008 DS    0H                                                  0364
@ER00008 LM    @14,@12,@SA00008                                    0364
         BR    @14                                                 0364
*                                                                  0365
*   /*****************************************************************/
*   /*                                                               */
*   /* PEMAX EXCEEDED IN SYSMOD                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0365
*PEMAX:                                                            0365
*   PROC;                           /* PEMAX LIMIT EXCEEDED FOR THIS
*                                      SYSMOD                        */
PEMAX    STM   @14,@12,@SA00009                                    0365
*   MGPCLEAR=''B;                   /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0366
*   MGPMGNO1=HMA259I;               /* X8X X8X PEMAX EXCEEDED      0367
*                                      ATTEMPTING TO ADD X16X X8X    */
         MVC   MGPMGNO1(2),@CH00811                                0367
*   MGPVARPT(1)=ADDR(CCATYPEA(IOPSMD));/* SYSMOD                     */
         L     @08,CCATPAD(,CCAPTR)                                0368
         LA    @08,CCATYPEA+80(,@08)                               0368
         ST    @08,MGPVARPT                                        0368
*   MGPVARPT(2)=ADDR(IOPNAM17);     /* SYSMOD NUMBER                 */
         L     @08,@PC00001                                        0369
         L     @08,MPPIOPAD(,@08)                                  0369
         LA    @08,IOPNAM17(,@08)                                  0369
         ST    @08,MGPVARPT+4                                      0369
*   IF MOD=ON                       /*                               */
*     THEN                          /*                               */
         TM    MOD,B'10000000'                                     0370
         BNO   @RF00370                                            0370
*     MGPVARPT(3)=ADDR(TXTMOD);     /*                               */
         LA    @08,@CC01522                                        0371
         ST    @08,MGPVARPT+8                                      0371
*   ELSE                            /*                               */
*     IF MAC=ON                     /*                               */
*       THEN                        /*                               */
         B     @RC00370                                            0372
@RF00370 TM    MAC,B'01000000'                                     0372
         BNO   @RF00372                                            0372
*       MGPVARPT(3)=ADDR(TXTMAC);   /*                               */
         LA    @08,@CC01525                                        0373
         ST    @08,MGPVARPT+8                                      0373
*     ELSE                          /*                               */
*       IF SRC=ON                   /*                               */
*         THEN                      /*                               */
         B     @RC00372                                            0374
@RF00372 TM    SRC,B'00001000'                                     0374
         BNO   @RF00374                                            0374
*         MGPVARPT(3)=ADDR(TXTSRC); /*                               */
         LA    @08,@CC01528                                        0375
         ST    @08,MGPVARPT+8                                      0375
*       ELSE                        /*                               */
*         IF ZAP=ON                 /*                               */
*           THEN                    /*                               */
         B     @RC00374                                            0376
@RF00374 TM    ZAP,B'00010000'                                     0376
         BNO   @RF00376                                            0376
*           MGPVARPT(3)=ADDR(TXTZAP);/*                              */
         LA    @08,@CC01531                                        0377
         ST    @08,MGPVARPT+8                                      0377
*         ELSE                      /*                               */
*           IF UPD=ON               /*                               */
*             THEN                  /*                               */
         B     @RC00376                                            0378
@RF00376 TM    UPD,B'00100000'                                     0378
         BNO   @RF00378                                            0378
*             MGPVARPT(3)=ADDR(TXTUPD);/*                            */
         LA    @08,@CC01534                                        0379
         ST    @08,MGPVARPT+8                                      0379
*           ELSE                    /*                               */
*             IF SRU=ON             /*                               */
*               THEN                /*                               */
         B     @RC00378                                            0380
@RF00378 TM    SRU,B'00000100'                                     0380
         BNO   @RF00380                                            0380
*               MGPVARPT(3)=ADDR(TXTSRU);/*                          */
         LA    @08,@CC01537                                        0381
         ST    @08,MGPVARPT+8                                      0381
*             ELSE                  /*                               */
*               MGPVARPT(3)=ADDR(TXTELEM);/*                         */
         B     @RC00380                                            0382
@RF00380 LA    @08,@CC01540                                        0382
         ST    @08,MGPVARPT+8                                      0382
*   MGPVARPT(4)=ADDR(MCBENAME);     /*                               */
@RC00380 DS    0H                                                  0383
@RC00378 DS    0H                                                  0383
@RC00376 DS    0H                                                  0383
@RC00374 DS    0H                                                  0383
@RC00372 DS    0H                                                  0383
@RC00370 L     @08,@PC00001                                        0383
         L     @08,MPPMCBAD(,@08)                                  0383
         LA    @08,MCBENAME(,@08)                                  0383
         ST    @08,MGPVARPT+12                                     0383
*   MGPTYPE=MGPERR;                 /* MESSAGE SEVERITY              */
         MVI   MGPTYPE,X'03'                                       0384
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MESSAGE                 */
         L     @15,@CV01420                                        0385
         LA    @01,@AL00385                                        0385
         BALR  @14,@15                                             0385
*   MPECODE=MAX(MPECODE,STOPPTF);   /* SET RC TO HIGHEST RC HIT OR 0386
*                                      MIN=8                         */
         L     @08,MPECODE                                         0386
         LA    @15,8                                               0386
         CR    @08,@15                                             0386
         BNL   *+6
         LR    @08,@15                                             0386
         ST    @08,MPECODE                                         0386
*   END PEMAX;                                                     0387
@EL00009 DS    0H                                                  0387
@EF00009 DS    0H                                                  0387
@ER00009 LM    @14,@12,@SA00009                                    0387
         BR    @14                                                 0387
*                                                                  0388
*   /*****************************************************************/
*   /*                                                               */
*   /* DUPLICATE ELEMENTS IN SYSMOD                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0388
*DUPELEM:                                                          0388
*   PROC;                           /* DUPLICATE ELEMENT IN SYSMOD   */
DUPELEM  STM   @14,@12,@SA00010                                    0388
*   MGPMGNO1=HMA281I;               /* DUPLICATE ELEM MESSAGE        */
         MVC   MGPMGNO1(2),@CH00522                                0389
*   MGPMGNO2=ZERO;                  /* NO SECOND MESSAGE             */
         SLR   @08,@08                                             0390
         STH   @08,MGPMGNO2                                        0390
*   MGPMGNO3=ZERO;                  /* NO THIRD MESSAGE              */
         STH   @08,MGPMGNO3                                        0391
*   MGPVARPT(1)=ADDR(MCBENAME);     /* ELEMENT NAME                  */
         L     @08,@PC00001                                        0392
         L     @01,MPPMCBAD(,@08)                                  0392
         LA    @15,MCBENAME(,@01)                                  0392
         ST    @15,MGPVARPT                                        0392
*   MGPVARPT(2)=ADDR(IOPNAM17);     /* SYSMOD ID                     */
         L     @08,MPPIOPAD(,@08)                                  0393
         LA    @08,IOPNAM17(,@08)                                  0393
         ST    @08,MGPVARPT+4                                      0393
*   MGPTYPE=MGPERR;                 /* MESSAGE SEVERITY              */
         MVI   MGPTYPE,X'03'                                       0394
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MESSAGE                 */
         L     @15,@CV01420                                        0395
         LA    @01,@AL00395                                        0395
         BALR  @14,@15                                             0395
*   MPECODE=MAX(MPECODE,STOPPTF);   /* SET RC TO HIGHEST RC HIT OR 0396
*                                      MIN=8                         */
         L     @08,MPECODE                                         0396
         LA    @15,8                                               0396
         CR    @08,@15                                             0396
         BNL   *+6
         LR    @08,@15                                             0396
         ST    @08,MPECODE                                         0396
*   END DUPELEM;                                                   0397
@EL00010 DS    0H                                                  0397
@EF00010 DS    0H                                                  0397
@ER00010 LM    @14,@12,@SA00010                                    0397
         BR    @14                                                 0397
*                                                                  0398
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCANS FOR MOD, MAC, MACUPD, UPDTE, ZAP, SRC, SRCUPD, JCLIN   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0398
*   GEN DATA;                                                      0398
*                                                                  0399
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN ++UPDTE, ++MACUPD                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*   GEN DATA;                                                      0399
*                                                                  0400
*   /*****************************************************************/
*   /*                                                               */
*   /* ++MAC SCANS                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0400
*   GEN DATA;                                                      0400
*                                                                  0401
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN ++ZAP                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0401
*   GEN DATA;                                                      0401
*                                                                  0402
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN ++SRCUPD                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0402
*   GEN DATA;                                                      0402
*                                                                  0403
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN ++SRC                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*   GEN DATA;                                                      0403
*                                                                  0404
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN ++JCLIN                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0404
*   GEN DATA;                                                      0404
*MPEPROCS:                                                         0405
*   PROC;                                                          0405
         B     @PB00011                                            0405
MPEPROCS STM   @14,@12,@SA00011                                    0405
*   RFY                                                            0406
*     REG1 RSTD;                                                   0406
*   RFY                                                            0407
*     RTNREG RSTD;                                                 0407
*                                                                  0407
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTS INVOKED BY HMASMSCN TO PROCESS KEYWORDS AND VALUES FROM */
*   /* ELEMENT MODIFICATION CONTROL STATEMENTS                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0408
*                                                                  0408
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL CARD IS ++MOD                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0408
*MODFND:                                                           0408
*   ENTRY;                                                         0408
         B     @EC00408                                            0408
MODFND   STM   @14,@12,@SA00011                                    0408
@EC00408 DS    0H                                                  0409
*   MOD=ON;                         /* PROCESSING MOD HEADER         */
         OI    MOD,B'10000000'                                     0409
*   MCBTYPE=MCBMODTP;               /* INDICATE MOD TYPE HEADER      */
         L     @15,@PC00001                                        0410
         L     @15,MPPMCBAD(,@15)                                  0410
         MVI   MCBTYPE(@15),X'04'                                  0410
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0411
*                                                                  0412
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL CARD IS ++MAC                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0412
*MACFND:                                                           0412
*   ENTRY;                                                         0412
MACFND   STM   @14,@12,@SA00011                                    0412
*   MAC=ON;                         /* PROCESSING MAC HEADER         */
         OI    MAC,B'01000000'                                     0413
*   MCBTYPE=MCBMCRTP;               /* INDICATE MAC TYPE HEADER      */
         L     @15,@PC00001                                        0414
         L     @15,MPPMCBAD(,@15)                                  0414
         MVI   MCBTYPE(@15),X'05'                                  0414
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0415
*                                                                  0416
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL CARD IS ++SRC                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0416
*SRCFND:                                                           0416
*   ENTRY;                          /* FOR SOURCE HEADER             */
SRCFND   STM   @14,@12,@SA00011                                    0416
*   SRC=ON;                         /* SOURCE HEADER FOUND           */
         OI    SRC,B'00001000'                                     0417
*   MCBTYPE=MCBSCRTP;               /* INDICATE SRC TYPE HEADER      */
         L     @15,@PC00001                                        0418
         L     @15,MPPMCBAD(,@15)                                  0418
         MVI   MCBTYPE(@15),X'06'                                  0418
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0419
*                                                                  0420
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL CARD IS ++JCLIN                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0420
*JCLINFND:                                                         0420
*   ENTRY;                          /* JCLIN FOUND                   */
JCLINFND STM   @14,@12,@SA00011                                    0420
*   JCL=ON;                         /* JCLIN HEADER FOUND ON         */
         OI    JCL,B'00000010'                                     0421
*   MCBTYPE=MCBJCLTP;               /* INDICATE JCLIN TYPE HEADER    */
         L     @15,@PC00001                                        0422
         L     @15,MPPMCBAD(,@15)                                  0422
         MVI   MCBTYPE(@15),X'0A'                                  0422
*   MCBENAME=BLANKS;                /* BLANK OUT THE ELEMENT NAME    */
         MVC   MCBENAME(8,@15),BLANKS                              0423
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0424
         B     GOODSCAN                                            0424
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL CARD IS ++UPDTE                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0425
*UPDFND:                                                           0425
*   ENTRY;                                                         0425
UPDFND   STM   @14,@12,@SA00011                                    0425
*   IF MPPIOPAD^=ZERO               /* WAS AN IOP PASSED AS PARAMETER*/
*     THEN                                                         0426
         L     @15,@PC00001                                        0426
         L     @15,MPPIOPAD(,@15)                                  0426
         LTR   @15,@15                                             0426
         BZ    @RF00426                                            0426
*     DO;                           /* IF YES CHECK FOR FUNCTION TYPE
*                                      SYSMOD                        */
*                                                                  0427
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR INVALID CONTROL CARD FOR FUNCTION SYSMOD         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0428
*       IF IOPPTYPE=IOPPFUNC THEN   /* FUNCTION TYPE SYSMOD          */
         CLI   IOPPTYPE(@15),4                                     0428
         BNE   @RF00428                                            0428
*         DO;                       /* NOTINFUN ROUTINE              */
*           MGPVARPT(1)=ADDR(CHUPD);/* SET MSG TO SHOW UPD           */
         LA    @15,@CC01443                                        0430
         ST    @15,MGPVARPT                                        0430
*           SAVREG1=REG1;           /* SAVE REG1 FOR RETURN TO SCAN  */
         ST    REG1,SAVREG1                                        0431
*           SAVREG14=RTNREG;        /* FREE REG14 FOR RETURN TO SCAN */
         ST    RTNREG,SAVREG14                                     0432
*           RFY                                                    0433
*             REG1 UNRSTD;          /* FREE REG1 FOR CALL            */
*           RFY                                                    0434
*             RTNREG UNRSTD;        /* FREE REG14 FOR CALL           */
*           CALL NOTINFUN;          /* COMMON ROUT TO SEND MSG       */
         BAL   @14,NOTINFUN                                        0435
*           RFY                                                    0436
*             REG1 RSTD;            /* RESTRICT REG1 USE             */
*           RFY                                                    0437
*             RTNREG RSTD;          /* RESTRICT REG14 USE            */
*           RTNREG=SAVREG14;        /* RESTORE REG14 SCAN RETURN     */
         L     RTNREG,SAVREG14                                     0438
*           REG1=SAVREG1;           /* RESTORE REG1 SCAN VALUE       */
         L     REG1,SAVREG1                                        0439
*           GO TO STOPSCAN;         /* GO END THE SCAN WITH RC=8     */
         B     STOPSCAN                                            0440
*         END;                      /* END OF NOTINFUN ROUTINE       */
*     END;                          /* CONTINUE IF NOT FUNCTION    0442
*                                      SYSMOD                        */
@RF00428 DS    0H                                                  0443
*   UPD=ON;                         /* PROCESSING UPDTE,MACUPD HEADER*/
@RF00426 OI    UPD,B'00100000'                                     0443
*   MCBTYPE=MCBMCUTP;               /* INDICATE UPDTE,MACUPD TYPE  0444
*                                      HEADER                        */
         L     @15,@PC00001                                        0444
         L     @15,MPPMCBAD(,@15)                                  0444
         MVI   MCBTYPE(@15),X'08'                                  0444
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0445
*                                                                  0446
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL CARD IS ++MACUPD                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0446
*MACUFND:                                                          0446
*   ENTRY;                                                         0446
MACUFND  STM   @14,@12,@SA00011                                    0446
*   IF MPPIOPAD^=ZERO               /* WAS AN IOP PASSED AS PARAMETER*/
*     THEN                                                         0447
         L     @15,@PC00001                                        0447
         L     @15,MPPIOPAD(,@15)                                  0447
         LTR   @15,@15                                             0447
         BZ    @RF00447                                            0447
*     DO;                           /* IF YES CHECK FOR FUNCTION TYPE
*                                      SYSMOD                        */
*                                                                  0448
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR INVALID CONTROL CARD FOR FUNCTION SYSMOD         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0449
*       IF IOPPTYPE=IOPPFUNC THEN   /* FUNCTION TYPE SYSMOD          */
         CLI   IOPPTYPE(@15),4                                     0449
         BNE   @RF00449                                            0449
*         DO;                       /* NOTINFUN ROUTINE              */
*           MGPVARPT(1)=ADDR(CHMACUPD);/* SHOW TYPE=MACUPD           */
         LA    @15,@CC01445                                        0451
         ST    @15,MGPVARPT                                        0451
*           SAVREG1=REG1;           /* SAVE REG1 FOR RETURN TO SCAN  */
         ST    REG1,SAVREG1                                        0452
*           SAVREG14=RTNREG;        /* FREE REG14 FOR RETURN TO SCAN */
         ST    RTNREG,SAVREG14                                     0453
*           RFY                                                    0454
*             REG1 UNRSTD;          /* FREE REG1 FOR CALL            */
*           RFY                                                    0455
*             RTNREG UNRSTD;        /* FREE REG14 FOR CALL           */
*           CALL NOTINFUN;          /* COMMON ROUT TO SEND MSG       */
         BAL   @14,NOTINFUN                                        0456
*           RFY                                                    0457
*             REG1 RSTD;            /* RESTRICT REG1 USE             */
*           RFY                                                    0458
*             RTNREG RSTD;          /* RESTRICT REG14 USE            */
*           RTNREG=SAVREG14;        /* RESTORE REG14 SCAN RETURN     */
         L     RTNREG,SAVREG14                                     0459
*           REG1=SAVREG1;           /* RESTORE REG1 SCAN VALUE       */
         L     REG1,SAVREG1                                        0460
*           GO TO STOPSCAN;         /* GO END THE SCAN WITH RC=8     */
         B     STOPSCAN                                            0461
*         END;                      /* END OF NOTINFUN ROUTINE       */
*     END;                          /* CONTINUE IF NOT FUNCTION    0463
*                                      SYSMOD                        */
@RF00449 DS    0H                                                  0464
*   UPD=ON;                         /* PROCESSING UPDTE,MACUPD HEADER*/
@RF00447 OI    UPD,B'00100000'                                     0464
*   MCBTYPE=MCBMCUTP;               /* INDICATE UPDTE,MACUPD TYPE  0465
*                                      HEADER                        */
         L     @15,@PC00001                                        0465
         L     @15,MPPMCBAD(,@15)                                  0465
         MVI   MCBTYPE(@15),X'08'                                  0465
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0466
*                                                                  0467
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL CARD IS ++ZAP                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0467
*ZAPFND:                                                           0467
*   ENTRY;                                                         0467
ZAPFND   STM   @14,@12,@SA00011                                    0467
*   IF MPPIOPAD^=ZERO               /* WAS AN IOP PASSED AS PARAMETER*/
*     THEN                                                         0468
         L     @15,@PC00001                                        0468
         L     @15,MPPIOPAD(,@15)                                  0468
         LTR   @15,@15                                             0468
         BZ    @RF00468                                            0468
*     DO;                           /* IF YES CHECK FOR FUNCTION TYPE
*                                      SYSMOD                        */
*                                                                  0469
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR INVALID CONTROL CARD FOR FUNCTION SYSMOD         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0470
*       IF IOPPTYPE=IOPPFUNC THEN   /* FUNCTION TYPE SYSMOD          */
         CLI   IOPPTYPE(@15),4                                     0470
         BNE   @RF00470                                            0470
*         DO;                       /* NOTINFUN ROUTINE              */
*           MGPVARPT(1)=ADDR(CHZAP);/* SET MSG TO SHOW ZAP           */
         LA    @15,@CC01441                                        0472
         ST    @15,MGPVARPT                                        0472
*           SAVREG1=REG1;           /* SAVE REG1 FOR RETURN TO SCAN  */
         ST    REG1,SAVREG1                                        0473
*           SAVREG14=RTNREG;        /* FREE REG14 FOR RETURN TO SCAN */
         ST    RTNREG,SAVREG14                                     0474
*           RFY                                                    0475
*             REG1 UNRSTD;          /* FREE REG1 FOR CALL            */
*           RFY                                                    0476
*             RTNREG UNRSTD;        /* FREE REG14 FOR CALL           */
*           CALL NOTINFUN;          /* COMMON ROUT TO SEND MSG       */
         BAL   @14,NOTINFUN                                        0477
*           RFY                                                    0478
*             REG1 RSTD;            /* RESTRICT REG1 USE             */
*           RFY                                                    0479
*             RTNREG RSTD;          /* RESTRICT REG14 USE            */
*           RTNREG=SAVREG14;        /* RESTORE REG14 SCAN RETURN     */
         L     RTNREG,SAVREG14                                     0480
*           REG1=SAVREG1;           /* RESTORE REG1 SCAN VALUE       */
         L     REG1,SAVREG1                                        0481
*           GO TO STOPSCAN;         /* GO END THE SCAN WITH RC=8     */
         B     STOPSCAN                                            0482
*         END;                      /* END OF NOTINFUN ROUTINE       */
*     END;                          /* CONTINUE IF NOT FUNCTION    0484
*                                      SYSMOD                        */
@RF00470 DS    0H                                                  0485
*   ZAP=ON;                         /* PROCESSING ZAP HEADER         */
@RF00468 OI    ZAP,B'00010000'                                     0485
*   MCBTYPE=MCBZAPTP;               /* INDICATE ZAP TYPE HEADER      */
         L     @15,@PC00001                                        0486
         L     @15,MPPMCBAD(,@15)                                  0486
         MVI   MCBTYPE(@15),X'07'                                  0486
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0487
*                                                                  0488
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL CARD IS ++SRCUPD                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0488
*SUPDFND:                                                          0488
*   ENTRY;                          /* FOR SOURCE UPDATE HEADER      */
SUPDFND  STM   @14,@12,@SA00011                                    0488
*   IF MPPIOPAD^=ZERO               /* WAS AN IOP PASSED AS PARAMETER*/
*     THEN                                                         0489
         L     @15,@PC00001                                        0489
         L     @15,MPPIOPAD(,@15)                                  0489
         LTR   @15,@15                                             0489
         BZ    @RF00489                                            0489
*     DO;                           /* IF YES CHECK FOR FUNCTION TYPE
*                                      SYSMOD                        */
*                                                                  0490
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR INVALID CONTROL CARD FOR FUNCTION SYSMOD         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0491
*       IF IOPPTYPE=IOPPFUNC THEN   /* FUNCTION TYPE SYSMOD          */
         CLI   IOPPTYPE(@15),4                                     0491
         BNE   @RF00491                                            0491
*         DO;                       /* NOTINFUN ROUTINE              */
*           MGPVARPT(1)=ADDR(CHSRCUPD);/* MSG TO SRCUPD              */
         LA    @15,@CC01447                                        0493
         ST    @15,MGPVARPT                                        0493
*           SAVREG1=REG1;           /* SAVE REG1 FOR RETURN TO SCAN  */
         ST    REG1,SAVREG1                                        0494
*           SAVREG14=RTNREG;        /* FREE REG14 FOR RETURN TO SCAN */
         ST    RTNREG,SAVREG14                                     0495
*           RFY                                                    0496
*             REG1 UNRSTD;          /* FREE REG1 FOR CALL            */
*           RFY                                                    0497
*             RTNREG UNRSTD;        /* FREE REG14 FOR CALL           */
*           CALL NOTINFUN;          /* COMMON ROUT TO SEND MSG       */
         BAL   @14,NOTINFUN                                        0498
*           RFY                                                    0499
*             REG1 RSTD;            /* RESTRICT REG1 USE             */
*           RFY                                                    0500
*             RTNREG RSTD;          /* RESTRICT REG14 USE            */
*           RTNREG=SAVREG14;        /* RESTORE REG14 SCAN RETURN     */
         L     RTNREG,SAVREG14                                     0501
*           REG1=SAVREG1;           /* RESTORE REG1 SCAN VALUE       */
         L     REG1,SAVREG1                                        0502
*           GO TO STOPSCAN;         /* GO END THE SCAN WITH RC=8     */
         B     STOPSCAN                                            0503
*         END;                      /* END OF NOTINFUN ROUTINE       */
*     END;                          /* CONTINUE IF NOT FUNCTION    0505
*                                      SYSMOD                        */
@RF00491 DS    0H                                                  0506
*   SRU=ON;                         /* SOURCE UPDATE HEADER FOUND    */
@RF00489 OI    SRU,B'00000100'                                     0506
*   MCBTYPE=MCBSCUTP;               /* INDICATE SRCUPD TYPE HEADER   */
         L     @15,@PC00001                                        0507
         L     @15,MPPMCBAD(,@15)                                  0507
         MVI   MCBTYPE(@15),X'09'                                  0507
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0508
*                                                                  0509
*   /*****************************************************************/
*   /*                                                               */
*   /* NAME FOUND                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0509
*MODNMFND:                                                         0509
*   ENTRY;                                                         0509
MODNMFND STM   @14,@12,@SA00011                                    0509
*   MCBENAME=SCPSTRNG(ONE:SCPPMLN); /* MOVE IN 1 TO 8 CHAR NAME      */
         L     @15,@PC00001                                        0510
         L     @15,MPPMCBAD(,@15)                                  0510
         MVI   MCBENAME+1(@15),C' '                                0510
         MVC   MCBENAME+2(6,@15),MCBENAME+1(@15)                   0510
         LH    @08,SCPPMLN                                         0510
         BCTR  @08,0                                               0510
         L     @07,SCPCHAR                                         0510
         EX    @08,@SM01960                                        0510
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0511
         B     GOODSCAN                                            0511
*   /*****************************************************************/
*   /*                                                               */
*   /* DISTLIB VALUE FOUND                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0512
*DISNMFND:                                                         0512
*   ENTRY;                                                         0512
DISNMFND STM   @14,@12,@SA00011                                    0512
*   MCBEDIST=SCPSTRNG(ONE:SCPPMLN); /* MOVE IN 1 TO 8 CHAR NAME      */
         L     @15,@PC00001                                        0513
         L     @15,MPPMCBAD(,@15)                                  0513
         MVI   MCBEDIST+1(@15),C' '                                0513
         MVC   MCBEDIST+2(6,@15),MCBEDIST+1(@15)                   0513
         LH    @08,SCPPMLN                                         0513
         BCTR  @08,0                                               0513
         L     @07,SCPCHAR                                         0513
         EX    @08,@SM01962                                        0513
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0514
*                                                                  0515
*   /*****************************************************************/
*   /*                                                               */
*   /* DALIAS KEYWORD FOUND                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0515
*DALFND:                                                           0515
*   ENTRY;                                                         0515
DALFND   STM   @14,@12,@SA00011                                    0515
*   IF DALIAS=ON THEN               /* HAS THIS KEYWORD BEEN FOUND 0516
*                                      ALREADY                       */
         TM    DALIAS,B'00100000'                                  0516
         BNO   @RF00516                                            0516
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHDALIAS); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01453                                        0518
         ST    @15,MGPVARPT                                        0518
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0519
*                                      AND TERMINATE THE HMASMMPE  0519
*                                      PROCESSING                    */
         B     SETVP2                                              0519
*     END;                                                         0520
*   ELSE                                                           0521
*     DALIAS=ON;                    /* DALIAS KEYWORD FOUND          */
@RF00516 OI    DALIAS,B'00100000'                                  0521
*   IF TALIAS=ON THEN               /* MUTUALLY EXCLUSIVE ONE FOUND  */
         TM    TALIAS,B'01000000'                                  0522
         BO    @RT00522                                            0522
*     GO TO MUTXERR;                /* ABNORMAL RETURN               */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0524
         B     GOODSCAN                                            0524
*   /*****************************************************************/
*   /*                                                               */
*   /* DALIAS NAME FOUND                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0525
*DALNMFND:                                                         0525
*   ENTRY;                                                         0525
DALNMFND STM   @14,@12,@SA00011                                    0525
*   MCBEDALS=SCPSTRNG(ONE:SCPPMLN); /* MOVE IN 1 TO 8 CHAR NAME      */
         L     @15,@PC00001                                        0526
         L     @15,MPPMCBAD(,@15)                                  0526
         MVI   MCBEDALS+1(@15),C' '                                0526
         MVC   MCBEDALS+2(6,@15),MCBEDALS+1(@15)                   0526
         LH    @08,SCPPMLN                                         0526
         BCTR  @08,0                                               0526
         L     @07,SCPCHAR                                         0526
         EX    @08,@SM01964                                        0526
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0527
*                                                                  0528
*   /*****************************************************************/
*   /*                                                               */
*   /* TALIAS KEYWORD FOUND                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0528
*TALFND:                                                           0528
*   ENTRY;                                                         0528
TALFND   STM   @14,@12,@SA00011                                    0528
*   IF TALIAS=ON THEN               /* HAS THIS KEYWORD BEEN FOUND 0529
*                                      ALREADY                       */
         TM    TALIAS,B'01000000'                                  0529
         BNO   @RF00529                                            0529
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHTALIAS); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01451                                        0531
         ST    @15,MGPVARPT                                        0531
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0532
*                                      AND TERMINATE THE HMASMMPE  0532
*                                      PROCESSING                    */
         B     SETVP2                                              0532
*     END;                                                         0533
*   ELSE                                                           0534
*     TALIAS=ON;                    /* TALIAS KEYWORD FOUND          */
@RF00529 OI    TALIAS,B'01000000'                                  0534
*   IF DALIAS=ON THEN               /* MUTUALLY EXCLUSIVE ONE FOUND  */
         TM    DALIAS,B'00100000'                                  0535
         BO    @RT00535                                            0535
*     GO TO MUTXERR;                /* ABNORMAL RETURN               */
*   INDX=ZERO;                      /* CLEAR INDEX                   */
         SLR   @15,@15                                             0537
         ST    @15,INDX                                            0537
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0538
         B     GOODSCAN                                            0538
*   /*****************************************************************/
*   /*                                                               */
*   /* TALIAS/MALIAS NAME FOUND                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0539
*TALNMFND:                                                         0539
*   ENTRY;                                                         0539
TALNMFND STM   @14,@12,@SA00011                                    0539
*LOOP1:                                                            0540
*   INDX=INDX+ONE;                  /* INCREMENT VARIABLE ENTRY INDEX*/
LOOP1    LA    @15,1                                               0540
         AL    @15,INDX                                            0540
         ST    @15,INDX                                            0540
*   IF MCBEND(INDX)^=IOPEOLST       /* IS THIS THE LAST ENTRY        */
*     THEN                          /* OF VARIABLE PART OF MCB       */
         LA    @08,255                                             0541
         MH    @15,@CH00035                                        0541
         L     @07,@PC00001                                        0541
         L     @07,MPPMCBAD(,@07)                                  0541
         ST    @15,@TF00001                                        0541
         ALR   @15,@07                                             0541
         MVC   @ZT00003+3(1),MCBEND-9(@15)                         0541
         C     @08,@ZT00003                                        0541
         BNE   @RT00541                                            0541
*     GO TO LOOP1;                  /* LOOP TILL END OF LIST FOUND   */
*   ELSE                                                           0543
*     DO;                           /* BUILD VARIABLE PARTS OF MCB   */
*       MCBENTRY(INDX)=SCPSTRNG(ONE:SCPPMLN);/* MOVE ENTRY NAME      */
         LR    @15,@07                                             0544
         AL    @15,@TF00001                                        0544
         MVI   MCBENTRY-8(@15),C' '                                0544
         MVC   MCBENTRY-7(6,@15),MCBENTRY-8(@15)                   0544
         LH    @06,SCPPMLN                                         0544
         BCTR  @06,0                                               0544
         L     @05,SCPCHAR                                         0544
         EX    @06,@SM01966                                        0544
*       MCBEIND(INDX)=MCBEALIS;     /* ALIAS (EITHER TALIAS OR     0545
*                                      MALIAS)                       */
         LA    @15,2                                               0545
         L     @06,@TF00001                                        0545
         STC   @15,MCBEIND-9(@06,@07)                              0545
*       MCBEND(INDX+ONE)=IOPEOLST;  /* SET NEXT END OF MCB FLAG      */
         L     @15,@TF00001                                        0546
         STC   @08,MCBEND(@15,@07)                                 0546
*     END;                          /* END OF VARIABLE PART BUILD    */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0548
*                                                                  0549
*   /*****************************************************************/
*   /*                                                               */
*   /* LEPARM KEYWORD FOUND                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0549
*LEFND:                                                            0549
*   ENTRY;                                                         0549
LEFND    STM   @14,@12,@SA00011                                    0549
*   IF LEPARM=ON THEN               /* HAS THIS KEYWORD BEEN FOUND 0550
*                                      ALREADY                       */
         TM    LEPARM,B'10000000'                                  0550
         BNO   @RF00550                                            0550
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHLEPARM); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01457                                        0552
         ST    @15,MGPVARPT                                        0552
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0553
*                                      AND TERMINATE THE HMASMMPE  0553
*                                      PROCESSING                    */
         B     SETVP2                                              0553
*     END;                                                         0554
*   ELSE                                                           0555
*     LEPARM=ON;                    /* LEPARM KEYWORD FOUND          */
@RF00550 OI    LEPARM,B'10000000'                                  0555
*   IF DEL=ON THEN                  /* MUTUALLY EXCLUSIVE WITH DELETE
*                                      KEYWORD                       */
         TM    DEL,B'00000100'                                     0556
         BO    @RT00556                                            0556
*     GO TO MUTXERR;                /* ABNORMAL RETURN               */
*   MCBEFLG1=ZERO;                  /* SET OTHER LE PARM FLAGS TO  0558
*                                      ZERO                          */
         L     @15,@PC00001                                        0558
         L     @15,MPPMCBAD(,@15)                                  0558
         MVI   MCBEFLG1(@15),X'00'                                 0558
*   MCBEFLG2=ZERO;                  /* SET OTHER LE PARM FLAGS TO  0559
*                                      ZERO                          */
         MVI   MCBEFLG2(@15),X'00'                                 0559
*   MCBESTD=OFF;                    /* SET OTHER LE PARM FLAGS OFF   */
         NI    MCBESTD(@15),B'01111111'                            0560
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
*                                                                  0561
         B     GOODSCAN                                            0561
*   /*****************************************************************/
*   /*                                                               */
*   /* RENT LINKEDIT OPTION FOUND                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0562
*LERENTFD:                                                         0562
*   ENTRY;                                                         0562
LERENTFD STM   @14,@12,@SA00011                                    0562
*   IF MCBERENT=ON THEN             /* HAS THIS KEYWORD BEEN FOUND 0563
*                                      ALREADY                       */
         L     @15,@PC00001                                        0563
         L     @15,MPPMCBAD(,@15)                                  0563
         TM    MCBERENT(@15),B'01000000'                           0563
         BNO   @RF00563                                            0563
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHRENT);   /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01459                                        0565
         ST    @15,MGPVARPT                                        0565
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0566
*                                      AND TERMINATE THE HMASMMPE  0566
*                                      PROCESSING                    */
         B     SETVP2                                              0566
*     END;                                                         0567
*   ELSE                                                           0568
*     MCBERENT=ON;                  /* INDICATE RENT FOUND           */
@RF00563 L     @15,@PC00001                                        0568
         L     @15,MPPMCBAD(,@15)                                  0568
         OI    MCBERENT(@15),B'01000000'                           0568
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
         B     GOODSCAN                                            0569
*                                                                  0570
*   /*****************************************************************/
*   /*                                                               */
*   /* REUS LINKEDIT OPTION FOUND                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0570
*LEREUSFD:                                                         0570
*   ENTRY;                                                         0570
LEREUSFD STM   @14,@12,@SA00011                                    0570
*   IF MCBEREUS=ON THEN             /* HAS THIS KEYWORD BEEN FOUND 0571
*                                      ALREADY                       */
         L     @15,@PC00001                                        0571
         L     @15,MPPMCBAD(,@15)                                  0571
         TM    MCBEREUS(@15),B'00100000'                           0571
         BNO   @RF00571                                            0571
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHREUS);   /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01461                                        0573
         ST    @15,MGPVARPT                                        0573
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0574
*                                      AND TERMINATE THE HMASMMPE  0574
*                                      PROCESSING                    */
         B     SETVP2                                              0574
*     END;                                                         0575
*   ELSE                                                           0576
*     MCBEREUS=ON;                  /* INDICATE REUS FOUND           */
@RF00571 L     @15,@PC00001                                        0576
         L     @15,MPPMCBAD(,@15)                                  0576
         OI    MCBEREUS(@15),B'00100000'                           0576
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
*                                                                  0577
         B     GOODSCAN                                            0577
*   /*****************************************************************/
*   /*                                                               */
*   /* SCTR LINKEDIT OPTION FOUND                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0578
*LESCTRFD:                                                         0578
*   ENTRY;                                                         0578
LESCTRFD STM   @14,@12,@SA00011                                    0578
*   IF MCBESCTR=ON THEN             /* HAS THIS KEYWORD BEEN FOUND 0579
*                                      ALREADY                       */
         L     @15,@PC00001                                        0579
         L     @15,MPPMCBAD(,@15)                                  0579
         TM    MCBESCTR(@15),B'00010000'                           0579
         BNO   @RF00579                                            0579
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHSCTR);   /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01463                                        0581
         ST    @15,MGPVARPT                                        0581
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0582
*                                      AND TERMINATE THE HMASMMPE  0582
*                                      PROCESSING                    */
         B     SETVP2                                              0582
*     END;                                                         0583
*   ELSE                                                           0584
*     MCBESCTR=ON;                  /* INDICATE SCTR FOUND           */
@RF00579 L     @15,@PC00001                                        0584
         L     @15,MPPMCBAD(,@15)                                  0584
         OI    MCBESCTR(@15),B'00010000'                           0584
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
         B     GOODSCAN                                            0585
*                                                                  0586
*   /*****************************************************************/
*   /*                                                               */
*   /* OVLY LINKEDIT OPTION FOUND                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0586
*LEOVLYFD:                                                         0586
*   ENTRY;                                                         0586
LEOVLYFD STM   @14,@12,@SA00011                                    0586
*   IF MCBEOVLY=ON THEN             /* HAS THIS KEYWORD BEEN FOUND 0587
*                                      ALREADY                       */
         L     @15,@PC00001                                        0587
         L     @15,MPPMCBAD(,@15)                                  0587
         TM    MCBEOVLY(@15),B'00001000'                           0587
         BNO   @RF00587                                            0587
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHOVLY);   /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01465                                        0589
         ST    @15,MGPVARPT                                        0589
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0590
*                                      AND TERMINATE THE HMASMMPE  0590
*                                      PROCESSING                    */
         B     SETVP2                                              0590
*     END;                                                         0591
*   ELSE                                                           0592
*     MCBEOVLY=ON;                  /* INDICATE OVLY FOUND           */
@RF00587 L     @15,@PC00001                                        0592
         L     @15,MPPMCBAD(,@15)                                  0592
         OI    MCBEOVLY(@15),B'00001000'                           0592
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
*                                                                  0593
         B     GOODSCAN                                            0593
*   /*****************************************************************/
*   /*                                                               */
*   /* REFR LINKEDIT OPTION FOUND                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0594
*LEREFRFD:                                                         0594
*   ENTRY;                                                         0594
LEREFRFD STM   @14,@12,@SA00011                                    0594
*   IF MCBEREFR=ON THEN             /* HAS THIS KEYWORD BEEN FOUND 0595
*                                      ALREADY                       */
         L     @15,@PC00001                                        0595
         L     @15,MPPMCBAD(,@15)                                  0595
         TM    MCBEREFR(@15),B'00000100'                           0595
         BNO   @RF00595                                            0595
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHREFR);   /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01467                                        0597
         ST    @15,MGPVARPT                                        0597
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0598
*                                      AND TERMINATE THE HMASMMPE  0598
*                                      PROCESSING                    */
         B     SETVP2                                              0598
*     END;                                                         0599
*   ELSE                                                           0600
*     MCBEREFR=ON;                  /* INDICATE REFR FOUND           */
@RF00595 L     @15,@PC00001                                        0600
         L     @15,MPPMCBAD(,@15)                                  0600
         OI    MCBEREFR(@15),B'00000100'                           0600
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
*                                                                  0601
         B     GOODSCAN                                            0601
*   /*****************************************************************/
*   /*                                                               */
*   /* DC LINKEDIT OPTION FOUND                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0602
*LEDCFD:                                                           0602
*   ENTRY;                                                         0602
LEDCFD   STM   @14,@12,@SA00011                                    0602
*   IF MCBEDC=ON THEN               /* HAS THIS KEYWORD BEEN FOUND 0603
*                                      ALREADY                       */
         L     @15,@PC00001                                        0603
         L     @15,MPPMCBAD(,@15)                                  0603
         TM    MCBEDC(@15),B'00000010'                             0603
         BNO   @RF00603                                            0603
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHDC);     /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01469                                        0605
         ST    @15,MGPVARPT                                        0605
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0606
*                                      AND TERMINATE THE HMASMMPE  0606
*                                      PROCESSING                    */
         B     SETVP2                                              0606
*     END;                                                         0607
*   ELSE                                                           0608
*     MCBEDC=ON;                    /* INDICATE DC FOUND             */
@RF00603 L     @15,@PC00001                                        0608
         L     @15,MPPMCBAD(,@15)                                  0608
         OI    MCBEDC(@15),B'00000010'                             0608
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
*                                                                  0609
         B     GOODSCAN                                            0609
*   /*****************************************************************/
*   /*                                                               */
*   /* NE LINKEDIT OPTION FOUND                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0610
*LENEFD:                                                           0610
*   ENTRY;                                                         0610
LENEFD   STM   @14,@12,@SA00011                                    0610
*   IF MCBENE=ON THEN               /* HAS THIS KEYWORD BEEN FOUND 0611
*                                      ALREADY                       */
         L     @15,@PC00001                                        0611
         L     @15,MPPMCBAD(,@15)                                  0611
         TM    MCBENE(@15),B'10000000'                             0611
         BNO   @RF00611                                            0611
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHNE);     /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01471                                        0613
         ST    @15,MGPVARPT                                        0613
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0614
*                                      AND TERMINATE THE HMASMMPE  0614
*                                      PROCESSING                    */
         B     SETVP2                                              0614
*     END;                                                         0615
*   ELSE                                                           0616
*     MCBENE=ON;                    /* INDICATE NE FOUND             */
@RF00611 L     @15,@PC00001                                        0616
         L     @15,MPPMCBAD(,@15)                                  0616
         OI    MCBENE(@15),B'10000000'                             0616
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
*                                                                  0617
         B     GOODSCAN                                            0617
*   /*****************************************************************/
*   /*                                                               */
*   /* APF LINKEDIT OPTION FOUND                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0618
*LEAPFFD:                                                          0618
*   ENTRY;                          /* ROUTINE FOR AC=1 SAVE         */
LEAPFFD  STM   @14,@12,@SA00011                                    0618
*   IF MCBEAPF=ON THEN              /* HAS THIS KEYWORD BEEN FOUND 0619
*                                      ALREADY                       */
         L     @15,@PC00001                                        0619
         L     @15,MPPMCBAD(,@15)                                  0619
         TM    MCBEAPF(@15),B'10000000'                            0619
         BNO   @RF00619                                            0619
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHAPF);    /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01473                                        0621
         ST    @15,MGPVARPT                                        0621
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0622
*                                      AND TERMINATE THE HMASMMPE  0622
*                                      PROCESSING                    */
         B     SETVP2                                              0622
*     END;                                                         0623
*   ELSE                                                           0624
*     MCBEAPF=ON;                   /* INDICATE APF FOUND            */
@RF00619 L     @15,@PC00001                                        0624
         L     @15,MPPMCBAD(,@15)                                  0624
         OI    MCBEAPF(@15),B'10000000'                            0624
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
         B     GOODSCAN                                            0625
*                                                                  0626
*   /*****************************************************************/
*   /*                                                               */
*   /* ALIGN2 LINKEDIT OPTION FOUND                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0626
*LEALN2FD:                                                         0626
*   ENTRY;                          /* ALIGN2 ROUTINE                */
LEALN2FD STM   @14,@12,@SA00011                                    0626
*   IF MCBEPAGA=ON THEN             /* HAS THIS KEYWORD BEEN FOUND 0627
*                                      ALREADY                       */
         L     @15,@PC00001                                        0627
         L     @15,MPPMCBAD(,@15)                                  0627
         TM    MCBEPAGA(@15),B'01000000'                           0627
         BNO   @RF00627                                            0627
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHALIGN2); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01475                                        0629
         ST    @15,MGPVARPT                                        0629
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0630
*                                      AND TERMINATE THE HMASMMPE  0630
*                                      PROCESSING                    */
         B     SETVP2                                              0630
*     END;                                                         0631
*   ELSE                                                           0632
*     MCBEPAGA=ON;                  /* INDICATE ALIGN2 FOUND         */
@RF00627 L     @15,@PC00001                                        0632
         L     @15,MPPMCBAD(,@15)                                  0632
         OI    MCBEPAGA(@15),B'01000000'                           0632
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
*                                                                  0633
         B     GOODSCAN                                            0633
*   /*****************************************************************/
*   /*                                                               */
*   /* STD LINKEDIT OPTION FOUND                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0634
*STDFND:                                                           0634
*   ENTRY;                          /* STD ROUTINE                   */
STDFND   STM   @14,@12,@SA00011                                    0634
*   IF MCBESTD=ON THEN              /* HAS THIS KEYWORD BEEN FOUND 0635
*                                      ALREADY                       */
         L     @15,@PC00001                                        0635
         L     @15,MPPMCBAD(,@15)                                  0635
         TM    MCBESTD(@15),B'10000000'                            0635
         BNO   @RF00635                                            0635
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHSTD);    /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01477                                        0637
         ST    @15,MGPVARPT                                        0637
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0638
*                                      AND TERMINATE THE HMASMMPE  0638
*                                      PROCESSING                    */
         B     SETVP2                                              0638
*     END;                                                         0639
*   ELSE                                                           0640
*     MCBESTD=ON;                   /* INDICATE STD FOUND            */
@RF00635 L     @15,@PC00001                                        0640
         L     @15,MPPMCBAD(,@15)                                  0640
         OI    MCBESTD(@15),B'10000000'                            0640
*   GO TO GOODSCAN;                 /* CONTINUE SCAN                 */
         B     GOODSCAN                                            0641
*                                                                  0642
*   /*****************************************************************/
*   /*                                                               */
*   /* TXLIB KEYWORD FOUND                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0642
*TXLFND:                                                           0642
*   ENTRY;                                                         0642
TXLFND   STM   @14,@12,@SA00011                                    0642
*   IF TXLIB=ON THEN                /* HAS THIS KEYWORD BEEN FOUND 0643
*                                      ALREADY                       */
         TM    TXLIB,B'00010000'                                   0643
         BNO   @RF00643                                            0643
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHTXLIB);  /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01479                                        0645
         ST    @15,MGPVARPT                                        0645
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0646
*                                      AND TERMINATE THE HMASMMPE  0646
*                                      PROCESSING                    */
         B     SETVP2                                              0646
*     END;                                                         0647
*   ELSE                                                           0648
*     TXLIB=ON;                     /* TXLIB KEYWORD FOUND           */
@RF00643 OI    TXLIB,B'00010000'                                   0648
*   IF LKLIB=ONDEL=ONRELF=ON THEN /* MUTUALLY EXCLUSIVE ONE FOUND  */
         TM    LKLIB,B'00001100'                                   0649
         BNZ   @RT00649                                            0649
         TM    RELF,B'10000000'                                    0649
         BO    @RT00649                                            0649
*     GO TO MUTXERR;                /* ABNORMAL RETURN               */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0651
         B     GOODSCAN                                            0651
*   /*****************************************************************/
*   /*                                                               */
*   /* TXLIB OR LKLIB NAME FOUND - COMMON ROUTINE                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0652
*LIBNMFND:                                                         0652
*   ENTRY;                                                         0652
LIBNMFND STM   @14,@12,@SA00011                                    0652
*   IF TXLIB=ON THEN                                               0653
         TM    TXLIB,B'00010000'                                   0653
         BNO   @RF00653                                            0653
*     MCBETXLB=SCPSTRNG(ONE:SCPPMLN);/* MOVE IN 1 TO 8 CHAR TXLIB  0654
*                                      NAME                          */
         L     @15,@PC00001                                        0654
         L     @15,MPPMCBAD(,@15)                                  0654
         MVI   MCBETXLB+1(@15),C' '                                0654
         MVC   MCBETXLB+2(6,@15),MCBETXLB+1(@15)                   0654
         LH    @08,SCPPMLN                                         0654
         BCTR  @08,0                                               0654
         L     @07,SCPCHAR                                         0654
         EX    @08,@SM01969                                        0654
*   ELSE                                                           0655
*     MCBELKLB=SCPSTRNG(ONE:SCPPMLN);/* MOVE IN 1 TO 8 CHAR LKLIB  0655
*                                      NAME                          */
         B     @RC00653                                            0655
@RF00653 L     @15,@PC00001                                        0655
         L     @15,MPPMCBAD(,@15)                                  0655
         MVI   MCBELKLB+1(@15),C' '                                0655
         MVC   MCBELKLB+2(6,@15),MCBELKLB+1(@15)                   0655
         LH    @08,SCPPMLN                                         0655
         BCTR  @08,0                                               0655
         L     @07,SCPCHAR                                         0655
         EX    @08,@SM01971                                        0655
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0656
*                                                                  0657
*   /*****************************************************************/
*   /*                                                               */
*   /* RELFILE KEYWORD FOUND                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0657
*RELFND:                                                           0657
*   ENTRY;                                                         0657
RELFND   STM   @14,@12,@SA00011                                    0657
*   IF RELF=ON THEN                 /* THIS KEYWORD FOUND ALREADY    */
         TM    RELF,B'10000000'                                    0658
         BNO   @RF00658                                            0658
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CRELFILE); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01499                                        0660
         ST    @15,MGPVARPT                                        0660
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0661
*                                      AND TERMINATE THE HMASMMPE  0661
*                                      PROCESSING                    */
         B     SETVP2                                              0661
*     END;                                                         0662
*   ELSE                                                           0663
*     RELF=ON;                      /* RELFILE KEYWORD FOUND         */
*                                                                  0663
@RF00658 OI    RELF,B'10000000'                                    0663
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RELFILE KEYWORD WITHOUT FILE SPECIFIED ON HEADER    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0664
*   IF MPPIOPAD^=ZERO THEN          /* WAS IOP ADDRESS PASSED        */
         SLR   @15,@15                                             0664
         L     @08,@PC00001                                        0664
         L     @08,MPPIOPAD(,@08)                                  0664
         CR    @08,@15                                             0664
         BE    @RF00664                                            0664
*     DO;                                                          0665
*       IF IOPPRELN=ZERO THEN       /* WAS FILE ON HEADER?           */
         CH    @15,IOPPRELN(,@08)                                  0666
         BNE   @RF00666                                            0666
*         DO;                       /* NO SEND ERROR MESSAGE         */
*           MGPCLEAR=''B;           /* CLEAR MSG NUMBERS             */
         XC    MGPCLEAR(6),MGPCLEAR                                0668
*           MGPMGNO1=HMA340I;       /* RELFILE WITHOUT FILE MESSAGE  */
         MVC   MGPMGNO1(2),@CH01431                                0669
*           MGPTYPE=MGPERR;         /* MESSAGE SEVERITY              */
         MVI   MGPTYPE,X'03'                                       0670
*           SAVREG1=REG1;           /* SAVE REG1 FOR RETURN TO SCAN  */
         ST    REG1,SAVREG1                                        0671
*           SAVREG14=RTNREG;        /* FREE REG14 FOR RETURN TO SCAN */
         ST    RTNREG,SAVREG14                                     0672
*           RFY                                                    0673
*             REG1 UNRSTD;          /* FREE REG1 FOR CALL            */
*           RFY                                                    0674
*             RTNREG UNRSTD;        /* FREE REG14 FOR CALL           */
*           CALL HMASMMSG(HMASMMGP);/* WRITE MESSAGE                 */
         L     @15,@CV01420                                        0675
         LA    @01,@AL00675                                        0675
         BALR  @14,@15                                             0675
*           RFY                                                    0676
*             REG1 RSTD;            /* RESTRICT REG1 USE             */
*           RFY                                                    0677
*             RTNREG RSTD;          /* RESTRICT REG14 USE            */
*           RTNREG=SAVREG14;        /* RESTORE REG14 SCAN RETURN     */
         L     RTNREG,SAVREG14                                     0678
*           REG1=SAVREG1;           /* RESTORE REG1 SCAN VALUE       */
         L     REG1,SAVREG1                                        0679
*           GO TO STOPSCAN;         /* ERROR IF NO FILES ON HEADER   */
         B     STOPSCAN                                            0680
*         END;                                                     0681
*     END;                                                         0682
@RF00666 DS    0H                                                  0683
*   IF LKLIB=ONDEL=ONTXLIB=ON THEN/* MUTUALLY EXCLUSIVE ONE FOUND  */
@RF00664 TM    LKLIB,B'00011100'                                   0683
         BNZ   @RT00683                                            0683
*     GO TO MUTXERR;                /* ABNORMAL RETURN               */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0685
         B     GOODSCAN                                            0685
*   /*****************************************************************/
*   /*                                                               */
*   /* RELFILE VALUE FOUND                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0686
*RELNOFND:                                                         0686
*   ENTRY;                                                         0686
RELNOFND STM   @14,@12,@SA00011                                    0686
*   MCBERLF=SCPSTRNG(ONE:SCPPMLN);  /* SAVE RELFILE VALUE            */
         L     @15,@PC00001                                        0687
         L     @15,MPPMCBAD(,@15)                                  0687
         MVI   MCBERLF+1(@15),C' '                                 0687
         MVC   MCBERLF+2(2,@15),MCBERLF+1(@15)                     0687
         LH    @08,SCPPMLN                                         0687
         BCTR  @08,0                                               0687
         L     @07,SCPCHAR                                         0687
         EX    @08,@SM01973                                        0687
*   IF MCBERLF(1:1)<NUM1 THEN                                      0688
         CLI   MCBERLF(@15),C'1'                                   0688
         BL    @RT00688                                            0688
*     GO TO ABNSCN2;                /* ERROR IF LESS THAN ONE        */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0690
*                                                                  0691
*   /*****************************************************************/
*   /*                                                               */
*   /* RMID KEYWORD FOUND                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0691
*RMIDFND:                                                          0691
*   ENTRY;                                                         0691
RMIDFND  STM   @14,@12,@SA00011                                    0691
*   IF RMID=ON THEN                 /* THIS KEYWORD FOUND ALREADY    */
         TM    RMID,B'01000000'                                    0692
         BNO   @RF00692                                            0692
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHRMID);   /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01483                                        0694
         ST    @15,MGPVARPT                                        0694
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0695
*                                      AND TERMINATE THE HMASMMPE  0695
*                                      PROCESSING                    */
         B     SETVP2                                              0695
*     END;                                                         0696
*   ELSE                                                           0697
*     RMID=ON;                      /* RMID KEYWORD FOUND            */
@RF00692 OI    RMID,B'01000000'                                    0697
*   IF MPPIOPAD^=ZERO THEN          /* WAS AN IOP ADDRESS PASSED     */
         SLR   @15,@15                                             0698
         L     @08,@PC00001                                        0698
         L     @08,MPPIOPAD(,@08)                                  0698
         CR    @08,@15                                             0698
         BE    @RF00698                                            0698
*     DO;                                                          0699
*       IF IOPPTYPE^=IOPPFUNC THEN  /* IS THIS A ++FUNCTION SYSMOD   */
         CLI   IOPPTYPE(@08),4                                     0700
         BE    @RF00700                                            0700
*         DO;                                                      0701
*           MGPCLEAR=''B;           /* CLEAR MSG NUMBERS             */
         XC    MGPCLEAR(6),MGPCLEAR                                0702
*           MGPMGNO1=HMA339I;       /* RMID INVALID                  */
         MVC   MGPMGNO1(2),@CH01429                                0703
*           MGPMGNO2=PART075;       /* IF NOT FUNCTION SYSMOD        */
         MVC   MGPMGNO2(2),@CH01439                                0704
*           MGPMGNO3=ZERO;          /* NO THIRD MESSAGE              */
         STH   @15,MGPMGNO3                                        0705
*           MGPTYPE=MGPERR;         /* MESSAGE SEVERITY              */
         MVI   MGPTYPE,X'03'                                       0706
*           SAVREG1=REG1;           /* SAVE REG1 FOR RETURN TO SCAN  */
         ST    REG1,SAVREG1                                        0707
*           SAVREG14=RTNREG;        /* FREE REG14 FOR RETURN TO SCAN */
         ST    RTNREG,SAVREG14                                     0708
*           RFY                                                    0709
*             REG1 UNRSTD;          /* FREE REG1 FOR CALL            */
*           RFY                                                    0710
*             RTNREG UNRSTD;        /* FREE REG14 FOR CALL           */
*           CALL HMASMMSG(HMASMMGP);/* WRITE MESSAGE                 */
         L     @15,@CV01420                                        0711
         LA    @01,@AL00711                                        0711
         BALR  @14,@15                                             0711
*           RFY                                                    0712
*             REG1 RSTD;            /* RESTRICT REG1 USE             */
*           RFY                                                    0713
*             RTNREG RSTD;          /* RESTRICT REG14 USE            */
*           RTNREG=SAVREG14;        /* RESTORE REG14 SCAN RETURN     */
         L     RTNREG,SAVREG14                                     0714
*           REG1=SAVREG1;           /* RESTORE REG1 SCAN VALUE       */
         L     REG1,SAVREG1                                        0715
*           GOTO STOPSCAN;          /* TERMINATE THE SCAN            */
         B     STOPSCAN                                            0716
*         END;                                                     0717
*     END;                                                         0718
@RF00700 DS    0H                                                  0719
*   IF DEL=ON THEN                  /* MUTUALLY EXCLUSIVE ONE FOUND  */
@RF00698 TM    DEL,B'00000100'                                     0719
         BO    @RT00719                                            0719
*     GO TO MUTXERR;                /* ABNORMAL RETURN               */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0721
         B     GOODSCAN                                            0721
*   /*****************************************************************/
*   /*                                                               */
*   /* RMID VALUE FOUND                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0722
*RMIDVAL:                                                          0722
*   ENTRY;                                                         0722
RMIDVAL  STM   @14,@12,@SA00011                                    0722
*   MCBERMID(1:7)=SCPSTRNG(1:7);    /* SAVE RMID SYSMOD IDENTIFIER   */
         L     @15,@PC00001                                        0723
         L     @15,MPPMCBAD(,@15)                                  0723
         L     @08,SCPCHAR                                         0723
         MVC   MCBERMID(7,@15),SCPSTRNG(@08)                       0723
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0724
*                                                                  0725
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE KEYWORD FOUND                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0725
*DELFND:                                                           0725
*   ENTRY;                                                         0725
DELFND   STM   @14,@12,@SA00011                                    0725
*   IF DEL=ON THEN                  /* HAS THIS KEYWORD BEEN FOUND 0726
*                                      ALREADY                       */
         TM    DEL,B'00000100'                                     0726
         BNO   @RF00726                                            0726
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHDELETE); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01455                                        0728
         ST    @15,MGPVARPT                                        0728
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0729
*                                      AND TERMINATE THE HMASMMPE  0729
*                                      PROCESSING                    */
         B     SETVP2                                              0729
*     END;                                                         0730
*   ELSE                                                           0731
*     DEL=ON;                       /* DELETE KEYWORD FOUND          */
@RF00726 OI    DEL,B'00000100'                                     0731
*   IF TXLIB=ONLKLIB=ONRELF=ONRMID=ONLEPARM=ONLMODBIT=ON THEN/*
*                                      MUTUALLY EXCLUSIVE ONE FOUND  */
         TM    TXLIB,B'00011000'                                   0732
         BNZ   @RT00732                                            0732
         TM    RELF,B'11000000'                                    0732
         BNZ   @RT00732                                            0732
         TM    LEPARM,B'10000000'                                  0732
         BO    @RT00732                                            0732
         TM    LMODBIT,B'00100000'                                 0732
         BO    @RT00732                                            0732
*     GO TO MUTXERR;                /* ABNORMAL RETURN               */
*   MCBEDEL=ON;                     /* TURN ON DELETE KEYWORD FOUND
*                                      BIT                           */
         L     @15,@PC00001                                        0734
         L     @15,MPPMCBAD(,@15)                                  0734
         OI    MCBEDEL(@15),B'01000000'                            0734
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0735
*                                                                  0736
*   /*****************************************************************/
*   /*                                                               */
*   /* VERSION KEYWORD FOUND                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0736
*VERSFND:                                                          0736
*   ENTRY;                                                         0736
VERSFND  STM   @14,@12,@SA00011                                    0736
*   IF VERSBIT=ON THEN              /* HAS THIS KEYWORD BEEN FOUND 0737
*                                      ALREADY                       */
         TM    VERSBIT,B'00000010'                                 0737
         BNO   @RF00737                                            0737
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CVERSION); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01501                                        0739
         ST    @15,MGPVARPT                                        0739
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0740
*                                      AND TERMINATE THE HMASMMPE  0740
*                                      PROCESSING                    */
         B     SETVP2                                              0740
*     END;                                                         0741
*   ELSE                                                           0742
*     VERSBIT=ON;                   /* VERSION KEYWORD FOUND         */
@RF00737 OI    VERSBIT,B'00000010'                                 0742
*   INDX=ZERO;                      /* ZERO INDEX COUNTER            */
         SLR   @15,@15                                             0743
         ST    @15,INDX                                            0743
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0744
         B     GOODSCAN                                            0744
*   /*****************************************************************/
*   /*                                                               */
*   /* VERSION VALUE FOUND                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0745
*VERSVAL:                                                          0745
*   ENTRY;                                                         0745
VERSVAL  STM   @14,@12,@SA00011                                    0745
*LOOP2:                                                            0746
*   INDX=INDX+ONE;                  /* INCREMENT VARIABLE ENTRY INDEX*/
LOOP2    LA    @15,1                                               0746
         L     @08,INDX                                            0746
         ALR   @08,@15                                             0746
         ST    @08,INDX                                            0746
*   IF MCBEND(INDX)^=IOPEOLST       /* IS THIS THE LAST ENTRY        */
*     THEN                          /* OF VARIABLE PART OF MCB       */
         LA    @07,255                                             0747
         MH    @08,@CH00035                                        0747
         L     @06,@PC00001                                        0747
         L     @06,MPPMCBAD(,@06)                                  0747
         ST    @08,@TF00001                                        0747
         ALR   @08,@06                                             0747
         MVC   @ZT00003+3(1),MCBEND-9(@08)                         0747
         C     @07,@ZT00003                                        0747
         BNE   @RT00747                                            0747
*     GO TO LOOP2;                  /* LOOP TILL END OF LIST FOUND   */
*   ELSE                                                           0749
*     DO;                           /* BUILD VARIABLE PARTS OF MCB   */
*       MCBENUM(INDX)=SCPSTRNG(1:7);/* SYSMODID TO VARIABLE PART     */
         LR    @08,@06                                             0750
         AL    @08,@TF00001                                        0750
         L     @05,SCPCHAR                                         0750
         MVC   MCBENUM-9(7,@08),SCPSTRNG(@05)                      0750
*       MCBEIND(INDX)=MCBEVERS;     /* VERSION                       */
         L     @08,@TF00001                                        0751
         STC   @15,MCBEIND-9(@08,@06)                              0751
*       MCBEND(INDX+ONE)=IOPEOLST;  /* SET NEXT END OF MCB FLAG      */
         L     @15,@TF00001                                        0752
         STC   @07,MCBEND(@15,@06)                                 0752
*     END;                          /* END OF VARIABLE PART BUILD    */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0754
*                                                                  0755
*   /*****************************************************************/
*   /*                                                               */
*   /* LKLIB KEYWORD FOUND                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0755
*LKLFND:                                                           0755
*   ENTRY;                                                         0755
LKLFND   STM   @14,@12,@SA00011                                    0755
*   IF LKLIB=ON THEN                /* HAS THIS KEYWORD BEEN FOUND 0756
*                                      ALREADY                       */
         TM    LKLIB,B'00001000'                                   0756
         BNO   @RF00756                                            0756
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHLKLIB);  /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01481                                        0758
         ST    @15,MGPVARPT                                        0758
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0759
*                                      AND TERMINATE THE HMASMMPE  0759
*                                      PROCESSING                    */
         B     SETVP2                                              0759
*     END;                                                         0760
*   ELSE                                                           0761
*     LKLIB=ON;                     /* LKLIB KEYWORD FOUND           */
@RF00756 OI    LKLIB,B'00001000'                                   0761
*   IF TXLIB=ONDEL=ONRELF=ON THEN /* MUTUALLY EXCLUSIVE ONE FOUND  */
         TM    TXLIB,B'00010100'                                   0762
         BNZ   @RT00762                                            0762
         TM    RELF,B'10000000'                                    0762
         BO    @RT00762                                            0762
*     GO TO MUTXERR;                /* ABNORMAL RETURN               */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0764
         B     GOODSCAN                                            0764
*   /*****************************************************************/
*   /*                                                               */
*   /* ASSEM KEYWORD FOUND                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0765
*ASSMFND:                                                          0765
*   ENTRY;                                                         0765
ASSMFND  STM   @14,@12,@SA00011                                    0765
*   IF ASSEM=ON THEN                /* HAS THIS KEYWORD BEEN FOUND 0766
*                                      ALREADY                       */
         TM    ASSEM,B'00001000'                                   0766
         BNO   @RF00766                                            0766
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHASSEM);  /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01491                                        0768
         ST    @15,MGPVARPT                                        0768
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0769
*                                      AND TERMINATE THE HMASMMPE  0769
*                                      PROCESSING                    */
         B     SETVP2                                              0769
*     END;                                                         0770
*   ELSE                                                           0771
*     ASSEM=ON;                     /* ASSEM KEYWORD FOUND           */
@RF00766 OI    ASSEM,B'00001000'                                   0771
*   IF MAC=ON&DEL=ON THEN                                          0772
         TM    MAC,B'01000000'                                     0772
         BNO   @RF00772                                            0772
         TM    DEL,B'00000100'                                     0772
         BO    @RT00772                                            0772
*     GO TO MUTXERR;                /* MUTXCLUSIVE ERROR             */
*   INDX=ZERO;                      /* CLEAR INDEX COUNTER           */
@RF00772 SLR   @15,@15                                             0774
         ST    @15,INDX                                            0774
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0775
*                                                                  0776
*   /*****************************************************************/
*   /*                                                               */
*   /* ASSEM VALUE FOUND - BUILD MCB VARIABLE ASSEMBLY NAME          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0776
*ASSNMFND:                                                         0776
*   ENTRY;                                                         0776
ASSNMFND STM   @14,@12,@SA00011                                    0776
*LOOP3:                                                            0777
*   INDX=INDX+ONE;                  /* INCREMENT VARIABLE ENTRY INDEX*/
LOOP3    LA    @15,1                                               0777
         AL    @15,INDX                                            0777
         ST    @15,INDX                                            0777
*   IF MCBEND(INDX)^=IOPEOLST       /* IS THIS THE LAST ENTRY        */
*     THEN                          /* OF VARIABLE PART OF MCB       */
         LA    @08,255                                             0778
         MH    @15,@CH00035                                        0778
         L     @07,@PC00001                                        0778
         L     @07,MPPMCBAD(,@07)                                  0778
         ST    @15,@TF00001                                        0778
         ALR   @15,@07                                             0778
         MVC   @ZT00003+3(1),MCBEND-9(@15)                         0778
         C     @08,@ZT00003                                        0778
         BNE   @RT00778                                            0778
*     GO TO LOOP3;                  /* LOOP TILL END OF LIST FOUND   */
*   ELSE                                                           0780
*     DO;                           /* BUILD VARIABLE PARTS OF MCB   */
*       MCBENTRY(INDX)=SCPSTRNG(ONE:SCPPMLN);/* MOVE ASSEM NAME      */
         LR    @15,@07                                             0781
         AL    @15,@TF00001                                        0781
         MVI   MCBENTRY-8(@15),C' '                                0781
         MVC   MCBENTRY-7(6,@15),MCBENTRY-8(@15)                   0781
         LH    @06,SCPPMLN                                         0781
         BCTR  @06,0                                               0781
         L     @05,SCPCHAR                                         0781
         EX    @06,@SM01966                                        0781
*       MCBEIND(INDX)=MCBEASSM;     /* ASSEM NAME                    */
         LA    @15,3                                               0782
         L     @06,@TF00001                                        0782
         STC   @15,MCBEIND-9(@06,@07)                              0782
*       MCBEND(INDX+ONE)=IOPEOLST;  /* SET NEXT END OF MCB FLAG      */
         L     @15,@TF00001                                        0783
         STC   @08,MCBEND(@15,@07)                                 0783
*     END;                          /* END OF VARIABLE PART BUILD    */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0785
*                                                                  0786
*   /*****************************************************************/
*   /*                                                               */
*   /* LMOD KEYWORD FOUND                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0786
*LMODFND:                                                          0786
*   ENTRY;                                                         0786
LMODFND  STM   @14,@12,@SA00011                                    0786
*   IF LMODBIT=ON THEN              /* HAS THIS KEYWORD BEEN FOUND 0787
*                                      ALREADY                       */
         TM    LMODBIT,B'00100000'                                 0787
         BNO   @RF00787                                            0787
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHLMOD);   /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01507                                        0789
         ST    @15,MGPVARPT                                        0789
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0790
*                                      AND TERMINATE THE HMASMMPE  0790
*                                      PROCESSING                    */
         B     SETVP2                                              0790
*     END;                                                         0791
*   ELSE                                                           0792
*     LMODBIT=ON;                   /* LMOD KEYWORD FOUND            */
@RF00787 OI    LMODBIT,B'00100000'                                 0792
*   IF DEL=ON THEN                  /* LMOD MUT XCLUSIVE WITH DEL    */
         TM    DEL,B'00000100'                                     0793
         BO    @RT00793                                            0793
*     GOTO MUTXERR;                 /*                               */
*   INDX=ZERO;                      /* ZERO INDEX COUNTER            */
         SLR   @15,@15                                             0795
         ST    @15,INDX                                            0795
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0796
*                                                                  0797
*   /*****************************************************************/
*   /*                                                               */
*   /* LMOD VALUE FOUND - BUILD MCB VARIABLE LMOD NAME ENTRY         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0797
*LMODVALU:                                                         0797
*   ENTRY;                                                         0797
LMODVALU STM   @14,@12,@SA00011                                    0797
*LOOP4:                                                            0798
*   INDX=INDX+ONE;                  /* INCREMENT VARIABLE ENTRY INDEX*/
LOOP4    LA    @15,1                                               0798
         AL    @15,INDX                                            0798
         ST    @15,INDX                                            0798
*   IF MCBEND(INDX)^=IOPEOLST       /* IS THIS THE LAST ENTRY        */
*     THEN                          /* OF VARIABLE PART OF MCB       */
         LA    @08,255                                             0799
         MH    @15,@CH00035                                        0799
         L     @07,@PC00001                                        0799
         L     @07,MPPMCBAD(,@07)                                  0799
         ST    @15,@TF00001                                        0799
         ALR   @15,@07                                             0799
         MVC   @ZT00003+3(1),MCBEND-9(@15)                         0799
         C     @08,@ZT00003                                        0799
         BNE   @RT00799                                            0799
*     GO TO LOOP4;                  /* LOOP TILL END OF LIST FOUND   */
*   ELSE                                                           0801
*     DO;                           /* BUILD VARIABLE PARTS OF MCB   */
*       MCBENTRY(INDX)=SCPSTRNG(ONE:SCPPMLN);/* MOVE LMOD NAME       */
         LR    @15,@07                                             0802
         AL    @15,@TF00001                                        0802
         MVI   MCBENTRY-8(@15),C' '                                0802
         MVC   MCBENTRY-7(6,@15),MCBENTRY-8(@15)                   0802
         LH    @06,SCPPMLN                                         0802
         BCTR  @06,0                                               0802
         L     @05,SCPCHAR                                         0802
         EX    @06,@SM01966                                        0802
*       MCBEIND(INDX)=MCBELMOD;     /* LMOD NAME                     */
         LA    @15,4                                               0803
         L     @06,@TF00001                                        0803
         STC   @15,MCBEIND-9(@06,@07)                              0803
*       MCBEND(INDX+ONE)=IOPEOLST;  /* SET NEXT END OF MCB FLAG      */
         L     @15,@TF00001                                        0804
         STC   @08,MCBEND(@15,@07)                                 0804
*     END;                          /* END OF VARIABLE PART BUILD    */
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
         B     GOODSCAN                                            0806
*                                                                  0807
*   /*****************************************************************/
*   /*                                                               */
*   /* SSI KEYWORD FOUND                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0807
*SSIDEL:                                                           0807
*   ENTRY;                                                         0807
SSIDEL   STM   @14,@12,@SA00011                                    0807
*   IF SSI=ON THEN                  /* HAS THIS KEYWORD BEEN FOUND 0808
*                                      ALREADY                       */
         TM    SSI,B'00010000'                                     0808
         BNO   @RF00808                                            0808
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHSSI);    /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01485                                        0810
         ST    @15,MGPVARPT                                        0810
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0811
*                                      AND TERMINATE THE HMASMMPE  0811
*                                      PROCESSING                    */
         B     SETVP2                                              0811
*     END;                                                         0812
*   ELSE                                                           0813
*     SSI=ON;                       /* SSI KEYWORD FOUND             */
@RF00808 OI    SSI,B'00010000'                                     0813
*   IF DEL=ON THEN                                                 0814
         TM    DEL,B'00000100'                                     0814
         BO    @RT00814                                            0814
*     GOTO MUTXERR;                 /* SSI MUT XCLUSIVE WITH DEL     */
*   GOTO GOODSCAN;                                                 0816
*                                                                  0816
         B     GOODSCAN                                            0816
*   /*****************************************************************/
*   /*                                                               */
*   /* SSI VALUE FOUND                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0817
*SSIFND:                                                           0817
*   ENTRY;                                                         0817
SSIFND   STM   @14,@12,@SA00011                                    0817
*   MCBESSI=SCPSTRNG(ONE:SCPPMLN);  /* SAVE SSI VALUE                */
         L     @15,@PC00001                                        0818
         L     @15,MPPMCBAD(,@15)                                  0818
         MVI   MCBESSI+1(@15),C' '                                 0818
         MVC   MCBESSI+2(6,@15),MCBESSI+1(@15)                     0818
         LH    @08,SCPPMLN                                         0818
         BCTR  @08,0                                               0818
         L     @07,SCPCHAR                                         0818
         EX    @08,@SM01975                                        0818
*   GO TO GOODSCAN;                 /* RETURN TO CONTINUE SCAN       */
*                                                                  0819
         B     GOODSCAN                                            0819
*   /*****************************************************************/
*   /*                                                               */
*   /* SYSLIB KEYWORD FOUND                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0820
*SYSDEL:                                                           0820
*   ENTRY;                                                         0820
SYSDEL   STM   @14,@12,@SA00011                                    0820
*   IF SYSLIB=ON THEN               /* HAS THIS KEYWORD BEEN FOUND 0821
*                                      ALREADY                       */
         TM    SYSLIB,B'00000100'                                  0821
         BNO   @RF00821                                            0821
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHSYSLIB); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01493                                        0823
         ST    @15,MGPVARPT                                        0823
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0824
*                                      AND TERMINATE THE HMASMMPE  0824
*                                      PROCESSING                    */
         B     SETVP2                                              0824
*     END;                                                         0825
*   ELSE                                                           0826
*     SYSLIB=ON;                    /* SYSLIB KEYWORD FOUND          */
@RF00821 OI    SYSLIB,B'00000100'                                  0826
*   IF DEL=ON THEN                                                 0827
         TM    DEL,B'00000100'                                     0827
         BO    @RT00827                                            0827
*     GOTO MUTXERR;                 /* SYSLIB MUT XCLUSIVE WITH DEL  */
*   GOTO GOODSCAN;                                                 0829
         B     GOODSCAN                                            0829
*                                                                  0830
*   /*****************************************************************/
*   /*                                                               */
*   /* SYSLIB VALUE FOUND                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0830
*SYSNMFND:                          /* SET SYSLIB INDICATOR          */
*   MCBESYS=SCPSTRNG(ONE:SCPPMLN);  /* SAVE NAME                     */
SYSNMFND L     @15,@PC00001                                        0830
         L     @15,MPPMCBAD(,@15)                                  0830
         MVI   MCBESYS+1(@15),C' '                                 0830
         MVC   MCBESYS+2(6,@15),MCBESYS+1(@15)                     0830
         LH    @08,SCPPMLN                                         0830
         BCTR  @08,0                                               0830
         L     @07,SCPCHAR                                         0830
         EX    @08,@SM01977                                        0830
*   GOTO GOODSCAN;                  /* EXIT GOOD                     */
*                                                                  0831
         B     GOODSCAN                                            0831
*   /*****************************************************************/
*   /*                                                               */
*   /* MACRO ALIAS NAME FOUND                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0832
*MALFND:                                                           0832
*   ENTRY;                          /* SET MALIAS INDICATOR          */
MALFND   STM   @14,@12,@SA00011                                    0832
*   IF MALIS=ON THEN                /* HAS THIS KEYWORD BEEN FOUND 0833
*                                      ALREADY                       */
         TM    MALIS,B'01000000'                                   0833
         BNO   @RF00833                                            0833
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHMALIAS); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01505                                        0835
         ST    @15,MGPVARPT                                        0835
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0836
*                                      AND TERMINATE THE HMASMMPE  0836
*                                      PROCESSING                    */
         B     SETVP2                                              0836
*     END;                                                         0837
*   ELSE                                                           0838
*     MALIS=ON;                     /* MALIAS KEYWORD FOUND          */
@RF00833 OI    MALIS,B'01000000'                                   0838
*   INDX=ZERO;                      /* RESET INDEX COUNTER           */
         SLR   @15,@15                                             0839
         ST    @15,INDX                                            0839
*   GOTO GOODSCAN;                  /* GOOD EXIT                     */
*                                                                  0840
         B     GOODSCAN                                            0840
*   /*****************************************************************/
*   /*                                                               */
*   /* ASMLIB KEYWORD FOUND                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0841
*ASMDEL:                                                           0841
*   ENTRY;                                                         0841
ASMDEL   STM   @14,@12,@SA00011                                    0841
*   IF ASMLIB=ON THEN               /* HAS THIS KEYWORD BEEN FOUND 0842
*                                      ALREADY                       */
         TM    ASMLIB,B'10000000'                                  0842
         BNO   @RF00842                                            0842
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHASMLIB); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01487                                        0844
         ST    @15,MGPVARPT                                        0844
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0845
*                                      AND TERMINATE THE HMASMMPE  0845
*                                      PROCESSING                    */
         B     SETVP2                                              0845
*     END;                                                         0846
*   ELSE                                                           0847
*     ASMLIB=ON;                    /* ASMLIB KEYWORD FOUND          */
@RF00842 OI    ASMLIB,B'10000000'                                  0847
*   IF DEL=ONDISTSRC=ON THEN       /* ASMLIB MUT XCLUSIVE WITH    0848
*                                      DEL,DISTSRC                   */
         TM    DEL,B'00000100'                                     0848
         BO    @RT00848                                            0848
         TM    DISTSRC,B'01000000'                                 0848
         BO    @RT00848                                            0848
*     GOTO MUTXERR;                                                0849
*   GOTO GOODSCAN;                                                 0850
         B     GOODSCAN                                            0850
*                                                                  0851
*   /*****************************************************************/
*   /*                                                               */
*   /* DISTSRC KEYWORD FOUND                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0851
*DISSDEL1:                                                         0851
*   ENTRY;                                                         0851
DISSDEL1 STM   @14,@12,@SA00011                                    0851
*   IF DISTSRC=ON THEN              /* HAS THIS KEYWORD BEEN FOUND 0852
*                                      ALREADY                       */
         TM    DISTSRC,B'01000000'                                 0852
         BNO   @RF00852                                            0852
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CDISTSRC); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01489                                        0854
         ST    @15,MGPVARPT                                        0854
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0855
*                                      AND TERMINATE THE HMASMMPE  0855
*                                      PROCESSING                    */
         B     SETVP2                                              0855
*     END;                                                         0856
*   ELSE                                                           0857
*     DISTSRC=ON;                   /* DISTSRC KEYWORD FOUND         */
@RF00852 OI    DISTSRC,B'01000000'                                 0857
*   IF DEL=ONASMLIB=ON THEN        /* DISTSRC MUT XCLUSIVE WITH   0858
*                                      DEL,ASMLIB                    */
         TM    DEL,B'00000100'                                     0858
         BO    @RT00858                                            0858
         TM    ASMLIB,B'10000000'                                  0858
         BO    @RT00858                                            0858
*     GOTO MUTXERR;                                                0859
*   GOTO GOODSCAN;                                                 0860
*                                                                  0860
         B     GOODSCAN                                            0860
*   /*****************************************************************/
*   /*                                                               */
*   /* DISTMOD KEYWORD FOUND                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0861
*DISMDEL1:                                                         0861
*   ENTRY;                                                         0861
DISMDEL1 STM   @14,@12,@SA00011                                    0861
*   IF DISTMOD=ON THEN              /* HAS THIS KEYWORD BEEN FOUND 0862
*                                      ALREADY                       */
         TM    DISTMOD,B'10000000'                                 0862
         BNO   @RF00862                                            0862
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CDISTMOD); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01497                                        0864
         ST    @15,MGPVARPT                                        0864
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0865
*                                      AND TERMINATE THE HMASMMPE  0865
*                                      PROCESSING                    */
         B     SETVP2                                              0865
*     END;                                                         0866
*   ELSE                                                           0867
*     DISTMOD=ON;                   /* DISTMOD KEYWORD FOUND         */
@RF00862 OI    DISTMOD,B'10000000'                                 0867
*   IF DEL=ONDOBJ=ON THEN          /* DISTMOD MUT XCLUSIVE WITH   0868
*                                      DEL,DISTOBJ                   */
         TM    DEL,B'00000100'                                     0868
         BO    @RT00868                                            0868
         TM    DOBJ,B'00100000'                                    0868
         BO    @RT00868                                            0868
*     GOTO MUTXERR;                                                0869
*   GOTO GOODSCAN;                                                 0870
         B     GOODSCAN                                            0870
*                                                                  0871
*   /*****************************************************************/
*   /*                                                               */
*   /* ASMLIB  DISTSRC VALUE FOUND                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0871
*ALBNMFND:                                                         0871
*   ENTRY;                          /* SET INDICATOR AND SAVE NAME   */
ALBNMFND STM   @14,@12,@SA00011                                    0871
*   MCBEASLB=SCPSTRNG(ONE:SCPPMLN); /* SAVE THE NAME                 */
         L     @15,@PC00001                                        0872
         L     @15,MPPMCBAD(,@15)                                  0872
         MVI   MCBEASLB+1(@15),C' '                                0872
         MVC   MCBEASLB+2(6,@15),MCBEASLB+1(@15)                   0872
         LH    @08,SCPPMLN                                         0872
         BCTR  @08,0                                               0872
         L     @07,SCPCHAR                                         0872
         EX    @08,@SM01979                                        0872
*   GOTO GOODSCAN;                  /* GOOD EXIT                     */
*                                                                  0873
         B     GOODSCAN                                            0873
*   /*****************************************************************/
*   /*                                                               */
*   /* PGM= FOUND FOR KEYWORD ASM ON ++JCLIN                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0874
*ASMPGMFD:                                                         0874
*   ENTRY;                          /* PGM= FOUND ON ++JCLIN FOR ASM
*                                      KEYWORD                       */
ASMPGMFD STM   @14,@12,@SA00011                                    0874
*   ASMPGMLN=SCPPMLN;               /* SAVE LENGTH OF 4 FOR PGM=     */
         MVC   ASMPGMLN(1),SCPPMLN+1                               0875
*   MCBEJASM(1:4)=SCPSTRNG(1:4);    /* SAVE PGM= IN MCB FIELD FOR ASM*/
         L     @15,@PC00001                                        0876
         L     @15,MPPMCBAD(,@15)                                  0876
         L     @08,SCPCHAR                                         0876
         MVC   MCBEJASM(4,@15),SCPSTRNG(@08)                       0876
*   GOTO GOODSCAN;                  /* NORMAL RETURN                 */
*                                                                  0877
         B     GOODSCAN                                            0877
*   /*****************************************************************/
*   /*                                                               */
*   /* PGM= FOUND FOR KEYWORD COPY ON ++JCLIN                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0878
*CPYPGMFD:                                                         0878
*   ENTRY;                          /* PGM= FOUND ON ++JCLIN FOR CPY
*                                      KEYWORD                       */
CPYPGMFD STM   @14,@12,@SA00011                                    0878
*   CPYPGMLN=SCPPMLN;               /* SAVE LENGTH OF 4 FOR PGM=     */
         MVC   CPYPGMLN(1),SCPPMLN+1                               0879
*   MCBEJCPY(1:4)=SCPSTRNG(1:4);    /* SAVE PGM= IN MCB FIELD FOR  0880
*                                      COPY                          */
         L     @15,@PC00001                                        0880
         L     @15,MPPMCBAD(,@15)                                  0880
         L     @08,SCPCHAR                                         0880
         MVC   MCBEJCPY(4,@15),SCPSTRNG(@08)                       0880
*   GOTO GOODSCAN;                  /* NORMAL RETURN                 */
*                                                                  0881
         B     GOODSCAN                                            0881
*   /*****************************************************************/
*   /*                                                               */
*   /* PGM= FOUND FOR KEYWORD LKED ON ++JCLIN                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0882
*LKEPGMFD:                                                         0882
*   ENTRY;                          /* PGM= FOUND ON ++JCLIN FOR LKE
*                                      KEYWORD                       */
LKEPGMFD STM   @14,@12,@SA00011                                    0882
*   LKEPGMLN=SCPPMLN;               /* SAVE LENGTH OF 4 FOR PGM=     */
         MVC   LKEPGMLN(1),SCPPMLN+1                               0883
*   MCBEJLKD(1:4)=SCPSTRNG(1:4);    /* SAVE PGM= IN MCB FIELD FOR  0884
*                                      LKED                          */
         L     @15,@PC00001                                        0884
         L     @15,MPPMCBAD(,@15)                                  0884
         L     @08,SCPCHAR                                         0884
         MVC   MCBEJLKD(4,@15),SCPSTRNG(@08)                       0884
*   GOTO GOODSCAN;                  /* NORMAL RETURN                 */
         B     GOODSCAN                                            0885
*                                                                  0886
*   /*****************************************************************/
*   /*                                                               */
*   /* PGM= FOUND FOR KEYWORD UPDATE ON ++JCLIN                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0886
*UPDPGMFD:                                                         0886
*   ENTRY;                          /* PGM= FOUND ON ++JCLIN FOR UPD
*                                      KEYWORD                       */
UPDPGMFD STM   @14,@12,@SA00011                                    0886
*   LKEPGMLN=SCPPMLN;               /* SAVE LENGTH OF 4 FOR PGM=     */
         MVC   LKEPGMLN(1),SCPPMLN+1                               0887
*   MCBEJUPI(1:4)=SCPSTRNG(1:4);    /* SAVE PGM= IN MCB FIELD FOR  0888
*                                      UPDATE                        */
         L     @15,@PC00001                                        0888
         L     @15,MPPMCBAD(,@15)                                  0888
         L     @08,SCPCHAR                                         0888
         MVC   MCBEJUPI(4,@15),SCPSTRNG(@08)                       0888
*   GOTO GOODSCAN;                  /* NORMAL RETURN                 */
*                                                                  0889
         B     GOODSCAN                                            0889
*   /*****************************************************************/
*   /*                                                               */
*   /* DISTOBJ KEYWORD FOUND                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0890
*DISTDEL:                                                          0890
*   ENTRY;                                                         0890
DISTDEL  STM   @14,@12,@SA00011                                    0890
*   IF DOBJ=ON THEN                 /* HAS THIS KEYWORD BEEN FOUND 0891
*                                      ALREADY                       */
         TM    DOBJ,B'00100000'                                    0891
         BNO   @RF00891                                            0891
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CDISTOBJ); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01495                                        0893
         ST    @15,MGPVARPT                                        0893
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0894
*                                      AND TERMINATE THE HMASMMPE  0894
*                                      PROCESSING                    */
         B     SETVP2                                              0894
*     END;                                                         0895
*   ELSE                                                           0896
*     DOBJ=ON;                      /* DISTOBJ KEYWORD FOUND         */
@RF00891 OI    DOBJ,B'00100000'                                    0896
*   IF DEL=ONDISTMOD=ON THEN       /* DISTOBJ MUT XCLUSIVE WITH   0897
*                                      DEL,DISTMOD                   */
         TM    DEL,B'00000100'                                     0897
         BO    @RT00897                                            0897
         TM    DISTMOD,B'10000000'                                 0897
         BO    @RT00897                                            0897
*     GOTO MUTXERR;                                                0898
*   GOTO GOODSCAN;                                                 0899
*                                                                  0899
         B     GOODSCAN                                            0899
*   /*****************************************************************/
*   /*                                                               */
*   /* DISTOBJ  DISTMOD VALUE FOUND                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0900
*DOBJFND:                                                          0900
*   ENTRY;                                                         0900
DOBJFND  STM   @14,@12,@SA00011                                    0900
*   MCBEDOBJ=SCPSTRNG(ONE:SCPPMLN); /* SAVE THE NAME                 */
         L     @15,@PC00001                                        0901
         L     @15,MPPMCBAD(,@15)                                  0901
         MVI   MCBEDOBJ+1(@15),C' '                                0901
         MVC   MCBEDOBJ+2(6,@15),MCBEDOBJ+1(@15)                   0901
         LH    @08,SCPPMLN                                         0901
         BCTR  @08,0                                               0901
         L     @07,SCPCHAR                                         0901
         EX    @08,@SM01981                                        0901
*   GOTO GOODSCAN;                  /* GOOD EXIT FROM ROUT           */
         B     GOODSCAN                                            0902
*                                                                  0903
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE KEYWORD FOUND ON MACRO OR SOURCE                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0903
*DELFND1:                                                          0903
*   ENTRY;                                                         0903
DELFND1  STM   @14,@12,@SA00011                                    0903
*   IF DEL=ON THEN                  /* HAS THIS KEYWORD BEEN FOUND 0904
*                                      ALREADY                       */
         TM    DEL,B'00000100'                                     0904
         BNO   @RF00904                                            0904
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHDELETE); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01455                                        0906
         ST    @15,MGPVARPT                                        0906
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0907
*                                      AND TERMINATE THE HMASMMPE  0907
*                                      PROCESSING                    */
         B     SETVP2                                              0907
*     END;                                                         0908
*   ELSE                                                           0909
*     DEL=ON;                       /* DELETE KEYWORD FOUND          */
@RF00904 OI    DEL,B'00000100'                                     0909
*   IF TXLIB=ONSSI=ONRELF=ONASMLIB=ONASSEM=ONDOBJ=ONRMID=ON 0910
*       SYSLIB=ONDISTSRC=ONDISTMOD=ON THEN/* MUTUALLY EXCLUSIVE ONE
*                                      FOUND                         */
         TM    TXLIB,B'00010000'                                   0910
         BO    @RT00910                                            0910
         TM    SSI,B'10010000'                                     0910
         BNZ   @RT00910                                            0910
         TM    ASMLIB,B'10000000'                                  0910
         BO    @RT00910                                            0910
         TM    ASSEM,B'01101100'                                   0910
         BNZ   @RT00910                                            0910
         TM    DISTSRC,B'11000000'                                 0910
         BNZ   @RT00910                                            0910
*     GO TO MUTXERR;                /* ABNORMAL RETURN               */
*   MCBEDEL=ON;                     /* TURN ON DELETE KEYWORD FOUND
*                                      BIT                           */
         L     @15,@PC00001                                        0912
         L     @15,MPPMCBAD(,@15)                                  0912
         OI    MCBEDEL(@15),B'01000000'                            0912
*   GO TO GOODSCAN;                 /* NORMAL RETURN                 */
*                                                                  0913
         B     GOODSCAN                                            0913
*   /*****************************************************************/
*   /*                                                               */
*   /* ASM VALUE FOUND ON ++JCLIN                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0914
*ASMFND:                                                           0914
*   ENTRY;                                                         0914
ASMFND   STM   @14,@12,@SA00011                                    0914
*   MCBEJASM((ASMPGMLN+1):(ASMPGMLN+SCPPMLN))=SCPSTRNG(1:SCPPMLN); 0915
         SLR   @15,@15                                             0915
         IC    @15,ASMPGMLN                                        0915
         L     @08,@PC00001                                        0915
         L     @08,MPPMCBAD(,@08)                                  0915
         ALR   @15,@08                                             0915
         LH    @07,SCPPMLN                                         0915
         LR    @06,@07                                             0915
         BCTR  @06,0                                               0915
         L     @05,SCPCHAR                                         0915
         EX    @06,@SM01983                                        0915
*   MCBELASM=ASMPGMLN+SCPPMLN;      /* SAVE THE LENGTH               */
         SLR   @15,@15                                             0916
         IC    @15,ASMPGMLN                                        0916
         ALR   @15,@07                                             0916
         STC   @15,MCBELASM(,@08)                                  0916
*   GOTO GOODSCAN;                  /* GOOD EXIT FROM ROUT           */
*                                                                  0917
         B     GOODSCAN                                            0917
*   /*****************************************************************/
*   /*                                                               */
*   /* COPY VALUE FOUND ON ++JCLIN                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0918
*CPYNMFND:                                                         0918
*   ENTRY;                                                         0918
CPYNMFND STM   @14,@12,@SA00011                                    0918
*   MCBEJCPY((CPYPGMLN+1):(CPYPGMLN+SCPPMLN))=SCPSTRNG(1:SCPPMLN); 0919
         SLR   @15,@15                                             0919
         IC    @15,CPYPGMLN                                        0919
         L     @08,@PC00001                                        0919
         L     @08,MPPMCBAD(,@08)                                  0919
         ALR   @15,@08                                             0919
         LH    @07,SCPPMLN                                         0919
         LR    @06,@07                                             0919
         BCTR  @06,0                                               0919
         L     @05,SCPCHAR                                         0919
         EX    @06,@SM01985                                        0919
*   MCBELCPY=CPYPGMLN+SCPPMLN;      /* SAVE THE LENGTH               */
         SLR   @15,@15                                             0920
         IC    @15,CPYPGMLN                                        0920
         ALR   @15,@07                                             0920
         STC   @15,MCBELCPY(,@08)                                  0920
*   GOTO GOODSCAN;                  /* GOOD EXIT FROM ROUT           */
         B     GOODSCAN                                            0921
*                                                                  0922
*   /*****************************************************************/
*   /*                                                               */
*   /* LKED VALUE FOUND ON ++JCLIN                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0922
*LKDNMFND:                                                         0922
*   ENTRY;                                                         0922
LKDNMFND STM   @14,@12,@SA00011                                    0922
*   MCBEJLKD((LKEPGMLN+1):(LKEPGMLN+SCPPMLN))=SCPSTRNG(1:SCPPMLN); 0923
         SLR   @15,@15                                             0923
         IC    @15,LKEPGMLN                                        0923
         L     @08,@PC00001                                        0923
         L     @08,MPPMCBAD(,@08)                                  0923
         ALR   @15,@08                                             0923
         LH    @07,SCPPMLN                                         0923
         LR    @06,@07                                             0923
         BCTR  @06,0                                               0923
         L     @05,SCPCHAR                                         0923
         EX    @06,@SM01987                                        0923
*   MCBELLKD=LKEPGMLN+SCPPMLN;      /* SAVE THE LENGTH               */
         SLR   @15,@15                                             0924
         IC    @15,LKEPGMLN                                        0924
         ALR   @15,@07                                             0924
         STC   @15,MCBELLKD(,@08)                                  0924
*   GOTO GOODSCAN;                  /* GOOD EXIT FROM ROUT           */
*                                                                  0925
         B     GOODSCAN                                            0925
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE VALUE FOUND ON ++JCLIN                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0926
*UPDNMFND:                                                         0926
*   ENTRY;                                                         0926
UPDNMFND STM   @14,@12,@SA00011                                    0926
*   MCBEJUPI((UPDPGMLN+1):(UPDPGMLN+SCPPMLN))=SCPSTRNG(1:SCPPMLN); 0927
         SLR   @15,@15                                             0927
         IC    @15,UPDPGMLN                                        0927
         L     @08,@PC00001                                        0927
         L     @08,MPPMCBAD(,@08)                                  0927
         ALR   @15,@08                                             0927
         LH    @07,SCPPMLN                                         0927
         LR    @06,@07                                             0927
         BCTR  @06,0                                               0927
         L     @05,SCPCHAR                                         0927
         EX    @06,@SM01989                                        0927
*   MCBELUPI=UPDPGMLN+SCPPMLN;      /* SAVE THE LENGTH               */
         SLR   @15,@15                                             0928
         IC    @15,UPDPGMLN                                        0928
         ALR   @15,@07                                             0928
         STC   @15,MCBELUPI(,@08)                                  0928
*   GOTO GOODSCAN;                  /* GOOD EXIT FROM ROUT           */
*                                                                  0929
         B     GOODSCAN                                            0929
*   /*****************************************************************/
*   /*                                                               */
*   /* TXLIB VALUE FOUND                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0930
*TLIBFND:                                                          0930
*   ENTRY;                                                         0930
TLIBFND  STM   @14,@12,@SA00011                                    0930
*   MCBETXLB=SCPSTRNG(ONE:SCPPMLN); /* SAVE THE NAME                 */
         L     @15,@PC00001                                        0931
         L     @15,MPPMCBAD(,@15)                                  0931
         MVI   MCBETXLB+1(@15),C' '                                0931
         MVC   MCBETXLB+2(6,@15),MCBETXLB+1(@15)                   0931
         LH    @08,SCPPMLN                                         0931
         BCTR  @08,0                                               0931
         L     @07,SCPCHAR                                         0931
         EX    @08,@SM01969                                        0931
*   GOTO GOODSCAN;                  /* GOOD EXIT FROM ROUT           */
         B     GOODSCAN                                            0932
*                                                                  0933
*   /*****************************************************************/
*   /*                                                               */
*   /* DISTLIB KEYWORD FOUND                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0933
*ONEDIST:                                                          0933
*   ENTRY;                                                         0933
ONEDIST  STM   @14,@12,@SA00011                                    0933
*   IF DISTLBIT=ON THEN             /* HAS THIS KEYWORD BEEN FOUND 0934
*                                      ALREADY                       */
         TM    DISTLBIT,B'00000010'                                0934
         BNO   @RF00934                                            0934
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CDISTLIB); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01503                                        0936
         ST    @15,MGPVARPT                                        0936
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0937
*                                      AND TERMINATE THE HMASMMPE  0937
*                                      PROCESSING                    */
         B     SETVP2                                              0937
*     END;                                                         0938
*   ELSE                                                           0939
*     DISTLBIT=ON;                  /* DISTLIB KEYWORD FOUND         */
@RF00934 OI    DISTLBIT,B'00000010'                                0939
*   GOTO GOODSCAN;                                                 0940
*                                                                  0940
         B     GOODSCAN                                            0940
*   /*****************************************************************/
*   /*                                                               */
*   /* ASM KEYWORD FOUND ON ++JCLIN                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0941
*ONEASM:                                                           0941
*   ENTRY;                                                         0941
ONEASM   STM   @14,@12,@SA00011                                    0941
*   IF JCLASM=ON THEN               /* HAS THIS KEYWORD BEEN FOUND 0942
*                                      ALREADY                       */
         TM    JCLASM,B'00100000'                                  0942
         BNO   @RF00942                                            0942
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHASM);    /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01509                                        0944
         ST    @15,MGPVARPT                                        0944
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0945
*                                      AND TERMINATE THE HMASMMPE  0945
*                                      PROCESSING                    */
         B     SETVP2                                              0945
*     END;                                                         0946
*   ELSE                                                           0947
*     JCLASM=ON;                    /* ASM ON JCLIN KEYWORD FOUND    */
@RF00942 OI    JCLASM,B'00100000'                                  0947
*   GOTO GOODSCAN;                                                 0948
*                                                                  0948
         B     GOODSCAN                                            0948
*   /*****************************************************************/
*   /*                                                               */
*   /* COPY KEYWORD FOUND ON ++JCLIN                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0949
*ONECOPY:                                                          0949
*   ENTRY;                                                         0949
ONECOPY  STM   @14,@12,@SA00011                                    0949
*   IF JCLCOPY=ON THEN              /* HAS THIS KEYWORD BEEN FOUND 0950
*                                      ALREADY                       */
         TM    JCLCOPY,B'00010000'                                 0950
         BNO   @RF00950                                            0950
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHCOPY);   /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01511                                        0952
         ST    @15,MGPVARPT                                        0952
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0953
*                                      AND TERMINATE THE HMASMMPE  0953
*                                      PROCESSING                    */
         B     SETVP2                                              0953
*     END;                                                         0954
*   ELSE                                                           0955
*     JCLCOPY=ON;                   /* COPY ON JCLIN KEYWORD FOUND   */
@RF00950 OI    JCLCOPY,B'00010000'                                 0955
*   GOTO GOODSCAN;                                                 0956
         B     GOODSCAN                                            0956
*                                                                  0957
*   /*****************************************************************/
*   /*                                                               */
*   /* LKED KEYWORD FOUND ON ++JCLIN                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0957
*ONELKED:                                                          0957
*   ENTRY;                                                         0957
ONELKED  STM   @14,@12,@SA00011                                    0957
*   IF JCLLKED=ON THEN              /* HAS THIS KEYWORD BEEN FOUND 0958
*                                      ALREADY                       */
         TM    JCLLKED,B'00001000'                                 0958
         BNO   @RF00958                                            0958
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHLKED);   /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01513                                        0960
         ST    @15,MGPVARPT                                        0960
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0961
*                                      AND TERMINATE THE HMASMMPE  0961
*                                      PROCESSING                    */
         B     SETVP2                                              0961
*     END;                                                         0962
*   ELSE                                                           0963
*     JCLLKED=ON;                   /* LKED ON JCLIN KEYWORD FOUND   */
@RF00958 OI    JCLLKED,B'00001000'                                 0963
*   GOTO GOODSCAN;                                                 0964
*                                                                  0964
         B     GOODSCAN                                            0964
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE KEYWORD FOUND ON ++JCLIN                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0965
*ONEUPD:                                                           0965
*   ENTRY;                                                         0965
ONEUPD   STM   @14,@12,@SA00011                                    0965
*   IF JCLUPD=ON THEN               /* HAS THIS KEYWORD BEEN FOUND 0966
*                                      ALREADY                       */
         TM    JCLUPD,B'00000100'                                  0966
         BNO   @RF00966                                            0966
*     DO;                           /* IF YES THEN ERROR             */
*       MGPVARPT(1)=ADDR(CHUPDATE); /* FILL IN KEYWORD IN MSG        */
         LA    @15,@CC01515                                        0968
         ST    @15,MGPVARPT                                        0968
*       GOTO SETVP2;                /* GO FILL IN REST OF MSG,SEND 0969
*                                      AND TERMINATE THE HMASMMPE  0969
*                                      PROCESSING                    */
         B     SETVP2                                              0969
*     END;                                                         0970
*   ELSE                                                           0971
*     JCLUPD=ON;                    /* UPDATE ON JCLIN KEYWORD FOUND */
@RF00966 OI    JCLUPD,B'00000100'                                  0971
*   GOTO GOODSCAN;                                                 0972
         B     GOODSCAN                                            0972
*                                                                  0973
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS TO FILL IN MGPVARPT(2), CALL MSG AND TERMINATE THE    */
*   /* HMASMMPE PROCESS.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0973
*SETVP2:                                                           0973
*   MGPVARPT(2)=ADDR(CHCONSTM);     /* FILL IN CONTROL STATEMENT     */
SETVP2   LA    @15,@CC01519                                        0973
         ST    @15,MGPVARPT+4                                      0973
*   SAVREG1=REG1;                   /* SAVE REG1 FOR RETURN TO SCAN  */
         ST    REG1,SAVREG1                                        0974
*   SAVREG14=RTNREG;                /* FREE REG14 FOR RETURN TO SCAN */
         ST    RTNREG,SAVREG14                                     0975
*   RFY                                                            0976
*     REG1 UNRSTD;                  /* FREE REG1 FOR CALL            */
*   RFY                                                            0977
*     RTNREG UNRSTD;                /* FREE REG14 FOR CALL           */
*   CALL DUPKYWRD;                  /* CALL PROC TO FINISH BUILD   0978
*                                      &SEND MSG                     */
         BAL   @14,DUPKYWRD                                        0978
*   RFY                                                            0979
*     REG1 RSTD;                    /* RESTRICT REG1 USE             */
*   RFY                                                            0980
*     RTNREG RSTD;                  /* RESTRICT REG14 USE            */
*   RTNREG=SAVREG14;                /* RESTORE REG14 SCAN RETURN     */
         L     RTNREG,SAVREG14                                     0981
*   REG1=SAVREG1;                   /* RESTORE REG1 SCAN VALUE       */
         L     REG1,SAVREG1                                        0982
*   GOTO STOPSCAN;                  /* GO TERMINATE SCAN             */
         B     STOPSCAN                                            0983
*                                                                  0984
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS TO FIND OUT INVALID KYWRD COMBINATION AND BUILD AND   */
*   /* SEND THE MESSAGE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0984
*MUTXERR:                                                          0984
*   MGPCLEAR=''B;                   /* CLEAR MESSAGE NUMBERS         */
MUTXERR  XC    MGPCLEAR(6),MGPCLEAR                                0984
*   MGPMGNO1=HMA341I;               /* MUTUALLY EXCLUSIVE KEYWORD MSG*/
         MVC   MGPMGNO1(2),@CH01433                                0985
*   MGPTYPE=MGPERR;                 /* MESSAGE SEVERITY              */
         MVI   MGPTYPE,X'03'                                       0986
*   IF TXLIB=ON&LKLIB=ON THEN                                      0987
         TM    TXLIB,B'00011000'                                   0987
         BNO   @RF00987                                            0987
*     DO;                                                          0988
*                                                                  0988
*       /*************************************************************/
*       /*                                                           */
*       /* TXLIB AND LKLIB ARE MUTUALLY EXCLUSIVE                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0989
*       MGPVARPT(1)=ADDR(CHTXLIB);  /* FILL IN FIRST VARIABLE PART   */
         LA    @15,@CC01479                                        0989
         ST    @15,MGPVARPT                                        0989
*       MGPVARPT(2)=ADDR(CHLKLIB);  /* FILL IN NEXT VARIABLE PART    */
         LA    @15,@CC01481                                        0990
         ST    @15,MGPVARPT+4                                      0990
*     END;                                                         0991
*   ELSE                                                           0992
*     IF(TXLIB=ONLKLIB=ON)&RELF=ON THEN                           0992
         B     @RC00987                                            0992
@RF00987 TM    TXLIB,B'00011000'                                   0992
         BZ    @RF00992                                            0992
         TM    RELF,B'10000000'                                    0992
         BNO   @RF00992                                            0992
*       DO;                                                        0993
*         MGPVARPT(1)=ADDR(CRELFILE);/* FILL IN FIRST VARIABLE PART  */
         LA    @15,@CC01499                                        0994
         ST    @15,MGPVARPT                                        0994
*         IF TXLIB=ON THEN                                         0995
*                                                                  0995
         TM    TXLIB,B'00010000'                                   0995
         BNO   @RF00995                                            0995
*           /*********************************************************/
*           /*                                                       */
*           /* TXLIB AND RELFILE ARE MUTUALLY EXCLUSIVE              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0996
*           MGPVARPT(2)=ADDR(CHTXLIB);/* FILL IN NEXT VARIABLE PART  */
         LA    @15,@CC01479                                        0996
         ST    @15,MGPVARPT+4                                      0996
*         ELSE                                                     0997
*                                                                  0997
*           /*********************************************************/
*           /*                                                       */
*           /* LKLIB AND RELFILE ARE MUTUALLY EXCLUSIVE              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0997
*           MGPVARPT(2)=ADDR(CHLKLIB);/* FILL IN NEXT VARIABLE PART  */
         B     @RC00995                                            0997
@RF00995 LA    @15,@CC01481                                        0997
         ST    @15,MGPVARPT+4                                      0997
*       END;                                                       0998
*     ELSE                                                         0999
*       IF TALIAS=ON&DALIAS=ON THEN /* TALIAS & DALIAS INVALID       */
         B     @RC00992                                            0999
@RF00992 TM    TALIAS,B'01100000'                                  0999
         BNO   @RF00999                                            0999
*         DO;                                                      1000
*                                                                  1000
*           /*********************************************************/
*           /*                                                       */
*           /* TALIAS AND DALIAS ARE MUTUALLY EXCLUSIVE              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1001
*           MGPVARPT(1)=ADDR(CHTALIAS);/* FILL IN FIRST VARIABLE PART*/
         LA    @15,@CC01451                                        1001
         ST    @15,MGPVARPT                                        1001
*           MGPVARPT(2)=ADDR(CHDALIAS);/* FILL IN NEXT VARIABLE PART */
         LA    @15,@CC01453                                        1002
         ST    @15,MGPVARPT+4                                      1002
*         END;                                                     1003
*       ELSE                                                       1004
*         IF DISTMOD=ON&DOBJ=ON THEN/* DISTMOD & DISTOBJ INVALID     */
         B     @RC00999                                            1004
@RF00999 TM    DISTMOD,B'10000000'                                 1004
         BNO   @RF01004                                            1004
         TM    DOBJ,B'00100000'                                    1004
         BNO   @RF01004                                            1004
*           DO;                                                    1005
*                                                                  1005
*             /*******************************************************/
*             /*                                                     */
*             /* DISTMOD AND DISTOBJ ARE MUTUALLY EXCLUSIVE          */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1006
*             MGPVARPT(1)=ADDR(CDISTMOD);/* FILL IN FIRST VARIABLE 1006
*                                      PART                          */
         LA    @15,@CC01497                                        1006
         ST    @15,MGPVARPT                                        1006
*             MGPVARPT(2)=ADDR(CDISTOBJ);/* FILL IN NEXT VARIABLE  1007
*                                      PART                          */
         LA    @15,@CC01495                                        1007
         ST    @15,MGPVARPT+4                                      1007
*           END;                                                   1008
*         ELSE                                                     1009
*           IF DISTSRC=ON&ASMLIB=ON THEN/* ASMLIB & DISTSRC INVALID  */
         B     @RC01004                                            1009
@RF01004 TM    DISTSRC,B'01000000'                                 1009
         BNO   @RF01009                                            1009
         TM    ASMLIB,B'10000000'                                  1009
         BNO   @RF01009                                            1009
*             DO;                                                  1010
*                                                                  1010
*               /*****************************************************/
*               /*                                                   */
*               /* DISTSRC AND ASMLIB ARE MUTUALLY EXCLUSIVE         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1011
*               MGPVARPT(1)=ADDR(CDISTSRC);/* FILL IN FIRST VARIABLE
*                                      PART                          */
         LA    @15,@CC01489                                        1011
         ST    @15,MGPVARPT                                        1011
*               MGPVARPT(2)=ADDR(CHASMLIB);/* FILL IN NEXT VARIABLE
*                                      PART                          */
         LA    @15,@CC01487                                        1012
         ST    @15,MGPVARPT+4                                      1012
*             END;                                                 1013
*           ELSE                                                   1014
*             IF DEL=ON THEN        /* IS DELETE INVOLVED            */
         B     @RC01009                                            1014
@RF01009 TM    DEL,B'00000100'                                     1014
         BNO   @RF01014                                            1014
*               DO;                                                1015
*                 MGPVARPT(1)=ADDR(CHDELETE);/* INDICATE DELETE      */
         LA    @15,@CC01455                                        1016
         ST    @15,MGPVARPT                                        1016
*                 IF DOBJ=ON THEN                                  1017
         TM    DOBJ,B'00100000'                                    1017
         BNO   @RF01017                                            1017
*                   MGPVARPT(2)=ADDR(CDISTOBJ);                    1018
         LA    @15,@CC01495                                        1018
         ST    @15,MGPVARPT+4                                      1018
*                 IF DISTMOD=ON THEN                               1019
@RF01017 TM    DISTMOD,B'10000000'                                 1019
         BNO   @RF01019                                            1019
*                   MGPVARPT(2)=ADDR(CDISTMOD);                    1020
         LA    @15,@CC01497                                        1020
         ST    @15,MGPVARPT+4                                      1020
*                 IF RELF=ON THEN                                  1021
@RF01019 TM    RELF,B'10000000'                                    1021
         BNO   @RF01021                                            1021
*                   MGPVARPT(2)=ADDR(CRELFILE);                    1022
         LA    @15,@CC01499                                        1022
         ST    @15,MGPVARPT+4                                      1022
*                 IF RMID=ON THEN                                  1023
@RF01021 TM    RMID,B'01000000'                                    1023
         BNO   @RF01023                                            1023
*                   MGPVARPT(2)=ADDR(CHRMID);                      1024
         LA    @15,@CC01483                                        1024
         ST    @15,MGPVARPT+4                                      1024
*                 IF SSI=ON THEN                                   1025
@RF01023 TM    SSI,B'00010000'                                     1025
         BNO   @RF01025                                            1025
*                   MGPVARPT(2)=ADDR(CHSSI);                       1026
         LA    @15,@CC01485                                        1026
         ST    @15,MGPVARPT+4                                      1026
*                 IF SYSLIB=ON THEN                                1027
@RF01025 TM    SYSLIB,B'00000100'                                  1027
         BNO   @RF01027                                            1027
*                   MGPVARPT(2)=ADDR(CHSYSLIB);                    1028
         LA    @15,@CC01493                                        1028
         ST    @15,MGPVARPT+4                                      1028
*                 IF TXLIB=ON THEN                                 1029
@RF01027 TM    TXLIB,B'00010000'                                   1029
         BNO   @RF01029                                            1029
*                   MGPVARPT(2)=ADDR(CHTXLIB);                     1030
         LA    @15,@CC01479                                        1030
         ST    @15,MGPVARPT+4                                      1030
*                 IF LKLIB=ON THEN                                 1031
@RF01029 TM    LKLIB,B'00001000'                                   1031
         BNO   @RF01031                                            1031
*                   MGPVARPT(2)=ADDR(CHLKLIB);                     1032
         LA    @15,@CC01481                                        1032
         ST    @15,MGPVARPT+4                                      1032
*                 IF ASMLIB=ON THEN                                1033
@RF01031 TM    ASMLIB,B'10000000'                                  1033
         BNO   @RF01033                                            1033
*                   MGPVARPT(2)=ADDR(CHASMLIB);                    1034
         LA    @15,@CC01487                                        1034
         ST    @15,MGPVARPT+4                                      1034
*                 IF DISTSRC=ON THEN                               1035
@RF01033 TM    DISTSRC,B'01000000'                                 1035
         BNO   @RF01035                                            1035
*                   MGPVARPT(2)=ADDR(CDISTSRC);                    1036
         LA    @15,@CC01489                                        1036
         ST    @15,MGPVARPT+4                                      1036
*                 IF LEPARM=ON THEN                                1037
@RF01035 TM    LEPARM,B'10000000'                                  1037
         BNO   @RF01037                                            1037
*                   MGPVARPT(2)=ADDR(CHLEPARM);                    1038
         LA    @15,@CC01457                                        1038
         ST    @15,MGPVARPT+4                                      1038
*                 IF ASSEM=ON THEN                                 1039
@RF01037 TM    ASSEM,B'00001000'                                   1039
         BNO   @RF01039                                            1039
*                   MGPVARPT(2)=ADDR(CHASSEM);                     1040
         LA    @15,@CC01491                                        1040
         ST    @15,MGPVARPT+4                                      1040
*                 IF LMODBIT=ON THEN                               1041
@RF01039 TM    LMODBIT,B'00100000'                                 1041
         BNO   @RF01041                                            1041
*                   MGPVARPT(2)=ADDR(CHLMOD);                      1042
         LA    @15,@CC01507                                        1042
         ST    @15,MGPVARPT+4                                      1042
*               END;                                               1043
@RF01041 DS    0H                                                  1044
*   SAVREG1=REG1;                   /* SAVE REG1 FOR RETURN TO SCAN  */
@RF01014 DS    0H                                                  1044
@RC01009 DS    0H                                                  1044
@RC01004 DS    0H                                                  1044
@RC00999 DS    0H                                                  1044
@RC00992 DS    0H                                                  1044
@RC00987 ST    REG1,SAVREG1                                        1044
*   SAVREG14=RTNREG;                /* FREE REG14 FOR RETURN TO SCAN */
         ST    RTNREG,SAVREG14                                     1045
*   RFY                                                            1046
*     REG1 UNRSTD;                  /* FREE REG1 FOR CALL            */
*   RFY                                                            1047
*     RTNREG UNRSTD;                /* FREE REG14 FOR CALL           */
*                                                                  1047
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL HMASMMSG TO SEND ERROR MESSAGE                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1048
*   CALL HMASMMSG(HMASMMGP);        /* SEND MESSAGE                  */
         L     @15,@CV01420                                        1048
         LA    @01,@AL01048                                        1048
         BALR  @14,@15                                             1048
*   RFY                                                            1049
*     REG1 RSTD;                    /* RESTRICT REG1 USE             */
*   RFY                                                            1050
*     RTNREG RSTD;                  /* RESTRICT REG14 USE            */
*   RTNREG=SAVREG14;                /* RESTORE REG14 SCAN RETURN     */
         L     RTNREG,SAVREG14                                     1051
*   REG1=SAVREG1;                   /* RESTORE REG1 SCAN VALUE       */
         L     REG1,SAVREG1                                        1052
*   GOTO STOPSCAN;                  /* TERMINATE SCAN                */
         B     STOPSCAN                                            1053
*                                                                  1054
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ROUTINE FROM APPENDAGES TO HMASMSCN                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1054
*                                                                  1054
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ROUTINE FOR NORMAL RETURN TO HMASMSCN                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1054
*GOODSCAN:                          /* RETURN POINT FOR GOOD SCAN  1054
*                                      PROCESSING                    */
*   SCPRET=SCPGOOD;                 /* GOOD RETURN CODE              */
GOODSCAN MVI   SCPRET,X'00'                                        1054
*   GO TO ROUTSEND;                 /* RETURN TO MAIN SCAN ROUTINE   */
         B     ROUTSEND                                            1055
*                                                                  1056
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ROUTINES FOR ERROR RETURN TO HMASMSCN                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1056
*STOPSCAN:                          /* RETURN POINT FOR TERMINATE  1056
*                                      WITH MESSAGE SENT             */
*   SCPRTERR=ON;                    /* INDICATE ERROR MESSAGE SENT   */
STOPSCAN OI    SCPRTERR,B'00010000'                                1056
*ABNSCN2:                           /* RETURN POINT FOR TERMINATE  1057
*                                      WITHOUT MESSAGE SENT          */
*   SCPRET=SCPSTOP;                 /* ABNORMAL RETURN CODE          */
ABNSCN2  MVI   SCPRET,X'08'                                        1057
*ROUTSEND:                          /* RETURN TO MAIN SCAN ROUTINE   */
*   END MPEPROCS;                                                  1058
@EL00011 DS    0H                                                  1058
@EF00011 DS    0H                                                  1058
@ER00011 LM    @14,@12,@SA00011                                    1058
         BR    @14                                                 1058
@PB00011 DS    0H                                                  1059
*   RFY                                                            1059
*     REG1 UNRSTD;                                                 1059
*   RFY                                                            1060
*     RTNREG UNRSTD;                                               1060
*                                                                  1061
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLING MODULE HMASMMPD WITH EITHER A NORMAL RETURN */
*   /* (RC=0, MCB BUILT, IOPPNTRY BUILT IF MPPIOPAD^=0) OR ERROR     */
*   /* RETURN (RC=8, ERROR MESSAGE SENT AND UNKNOWN STATE OF MCB     */
*   /* BUILD PROCESSING OR IOPPNTRY IF APPROPRIATE) OR THE HIGHEST   */
*   /* RETURN CODE FROM ANY CALLED MODULE.                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1061
*ENDOFMPE:                                                         1061
*                                                                  1061
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A RETURN CODE IS EQUAL TO SCPBAD (RC=4) THEN CONVERT IT TO */
*   /* STOPPTF (RC=8) BEFORE RETURN TO CALLING MODULE.               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1061
*   IF MPECODE=SCPBAD THEN          /* IS RETURN CODE EQUAL TO 4     */
ENDOFMPE CLC   MPECODE(4),@CF00047                                 1061
         BNE   @RF01061                                            1061
*     MPECODE=STOPPTF;              /* CONVERT TO STOP THE PTF       */
         MVC   MPECODE(4),@CF00119                                 1062
*   RETURN CODE(MPECODE);           /* RETURN TO HMASMMPD MODULE     */
@RF01061 L     @15,MPECODE                                         1063
         L     @13,4(,@13)                                         1063
         L     @14,12(,@13)                                        1063
         LM    @00,@12,20(@13)                                     1063
         BR    @14                                                 1063
*   END HMASMMPE                    /* END OF HMASMMPE CODE          */
*                                                                  1064
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMCB)                                       */
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*                                                                  1064
*       ;                                                          1064
@DATA    DS    0H
@CH00094 DC    H'1'
@CH00190 DC    H'2'
@CH00137 DC    H'5'
@CH00207 DC    H'6'
@CH00043 DC    H'7'
@CH00035 DC    H'9'
@CH00459 DC    H'21'
@CH00469 DC    H'26'
@CH01424 DC    H'53'
@CH00811 DC    H'60'
@CH00839 DC    H'72'
@CH01439 DC    H'75'
@CH00522 DC    H'82'
@CH00873 DC    H'139'
@CH01429 DC    H'140'
@CH01431 DC    H'141'
@CH01433 DC    H'142'
@CH01435 DC    H'143'
@CH00628 DC    H'255'
@SM01960 MVC   MCBENAME(0,@15),SCPSTRNG(@07)
@SM01962 MVC   MCBEDIST(0,@15),SCPSTRNG(@07)
@SM01964 MVC   MCBEDALS(0,@15),SCPSTRNG(@07)
@SM01966 MVC   MCBENTRY-9(0,@15),SCPSTRNG(@05)
@SM01969 MVC   MCBETXLB(0,@15),SCPSTRNG(@07)
@SM01971 MVC   MCBELKLB(0,@15),SCPSTRNG(@07)
@SM01973 MVC   MCBERLF(0,@15),SCPSTRNG(@07)
@SM01975 MVC   MCBESSI(0,@15),SCPSTRNG(@07)
@SM01977 MVC   MCBESYS(0,@15),SCPSTRNG(@07)
@SM01979 MVC   MCBEASLB(0,@15),SCPSTRNG(@07)
@SM01981 MVC   MCBEDOBJ(0,@15),SCPSTRNG(@07)
@SM01983 MVC   MCBEJASM(0,@15),SCPSTRNG(@05)
@SM01985 MVC   MCBEJCPY(0,@15),SCPSTRNG(@05)
@SM01987 MVC   MCBEJLKD(0,@15),SCPSTRNG(@05)
@SM01989 MVC   MCBEJUPI(0,@15),SCPSTRNG(@05)
         DS    0F
@AL00260 DC    A(HMASMSCP)             LIST WITH   1 ARGUMENT(S)
@AL00345 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00350 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00355 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00363 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00385 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00395 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00675 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00711 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01048 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00011 DS    15F
@SA00008 DS    0F
@SA00009 DS    0F
@SA00010 DS    0F
@SA00007 DS    0F
@SA00005 DS    0F
@SA00006 DS    0F
         DS    15F
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
         DS    0F
@CF00047 DC    F'4'
@CH00047 EQU   @CF00047+2
@CF00119 DC    F'8'
@CH00119 EQU   @CF00119+2
@CV01419 DC    V(HMASMSCN)
@CV01420 DC    V(HMASMMSG)
         DS    0D
IOPPTR   DS    A
INDX     DS    F
AMODSCAN DC    AL4(MODSCAN)
SAVREG1  DS    A
SAVREG14 DS    A
MPECODE  DS    F
HEXNO    DS    F
ASMPGMLN DS    FL1
CPYPGMLN DS    FL1
LKEPGMLN DS    FL1
UPDPGMLN DS    FL1
@CC01519 DC    C'CONTROL STATEMENT'
@CC01522 DC    C'MOD             '
@CC01525 DC    C'MAC             '
@CC01528 DC    C'SRC             '
@CC01531 DC    C'ZAP             '
@CC01534 DC    C'MACUPD          '
@CC01537 DC    C'SRCUPD          '
@CC01540 DC    C'ELEMENT         '
@CC01451 DC    C'TALIAS  '
@CC01453 DC    C'DALIAS  '
@CC01455 DC    C'DELETE  '
@CC01457 DC    C'LEPARM  '
@CC01459 DC    C'RENT    '
@CC01461 DC    C'REUS    '
@CC01463 DC    C'SCTR    '
@CC01465 DC    C'OVLY    '
@CC01467 DC    C'REFR    '
@CC01469 DC    C'DC      '
@CC01471 DC    C'NE      '
@CC01473 DC    C'APF     '
@CC01475 DC    C'ALIGN2  '
@CC01477 DC    C'STD     '
@CC01479 DC    C'TXLIB   '
@CC01481 DC    C'LKLIB   '
@CC01483 DC    C'RMID    '
@CC01485 DC    C'SSI     '
@CC01487 DC    C'ASMLIB  '
@CC01489 DC    C'DISTSRC '
@CC01491 DC    C'ASSEM   '
@CC01493 DC    C'SYSLIB  '
@CC01495 DC    C'DISTOBJ '
@CC01497 DC    C'DISTMOD '
@CC01499 DC    C'RELFILE '
@CC01501 DC    C'VERSION '
@CC01503 DC    C'DISTLIB '
@CC01505 DC    C'MALIAS  '
@CC01507 DC    C'LMOD    '
@CC01509 DC    C'ASM     '
@CC01511 DC    C'COPY    '
@CC01513 DC    C'LKED    '
@CC01515 DC    C'UPDATE  '
@CC01517 DC    C'SYSMOD  '
@CC01441 EQU   @CC01531
@CC01443 DC    C'UPD   '
@CC01445 EQU   @CC01534
@CC01447 EQU   @CC01537
@CC01449 DC    C'JCLIN '
         DS    CL3
HMASMSCP DS    CL26
         ORG   HMASMSCP
SCPCHAR  DS    AL4
SCPSRCH  DS    AL4
SCPWKAR  DS    AL4
SCPIORTN DS    AL4
SCPIOPAD DS    AL4
SCPINLN  DS    FL2
SCPPMLN  DS    FL2
SCPEOR   DS    BL1
         ORG   SCPEOR
SCPCONT  DS    BL1
SCPNOCT  EQU   SCPEOR+0
SCPCOMNT EQU   SCPEOR+0
SCPRTERR EQU   SCPEOR+0
SCPNOSUC EQU   SCPEOR+0
SCPNORT  EQU   SCPEOR+0
@NM00182 EQU   SCPEOR+0
         ORG   HMASMSCP+25
SCPRETRN DS    FL1
         ORG   SCPRETRN
SCPRET   DS    FL1
         ORG   HMASMSCP+26
         DS    CL2
HMASMMGP DS    CL28
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00186 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00187 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL16
         ORG   MGPVAR
MGPVARPT DS    4A
         ORG   HMASMMGP+28
BLANKS   DC    CL8' '
LOCALBIT DS    BL4
         ORG   LOCALBIT
BITFLG1  DS    BL1
         ORG   BITFLG1
MOD      DS    BL1
MAC      EQU   BITFLG1+0
UPD      EQU   BITFLG1+0
ZAP      EQU   BITFLG1+0
SRC      EQU   BITFLG1+0
SRU      EQU   BITFLG1+0
JCL      EQU   BITFLG1+0
@NM00188 EQU   BITFLG1+0
         ORG   LOCALBIT+1
BITFLG2  DS    BL1
         ORG   BITFLG2
LEPARM   DS    BL1
TALIAS   EQU   BITFLG2+0
DALIAS   EQU   BITFLG2+0
TXLIB    EQU   BITFLG2+0
LKLIB    EQU   BITFLG2+0
DEL      EQU   BITFLG2+0
DISTLBIT EQU   BITFLG2+0
@NM00189 EQU   BITFLG2+0
         ORG   LOCALBIT+2
BITFLG3  DS    BL1
         ORG   BITFLG3
RELF     DS    BL1
RMID     EQU   BITFLG3+0
DOBJ     EQU   BITFLG3+0
SSI      EQU   BITFLG3+0
ASSEM    EQU   BITFLG3+0
SYSLIB   EQU   BITFLG3+0
VERSBIT  EQU   BITFLG3+0
@NM00190 EQU   BITFLG3+0
         ORG   LOCALBIT+3
BITFLG4  DS    BL1
         ORG   BITFLG4
ASMLIB   DS    BL1
MALIS    EQU   BITFLG4+0
JCLASM   EQU   BITFLG4+0
JCLCOPY  EQU   BITFLG4+0
JCLLKED  EQU   BITFLG4+0
JCLUPD   EQU   BITFLG4+0
@NM00191 EQU   BITFLG4+0
         ORG   LOCALBIT+4
XTRABITS DS    BL1
         ORG   XTRABITS
DISTMOD  DS    BL1
DISTSRC  EQU   XTRABITS+0
LMODBIT  EQU   XTRABITS+0
@NM00192 EQU   XTRABITS+0
         ORG   XTRABITS+1
         DS    CL1
PATCHMPE DS    CL80
         ORG   PATCHMPE
@NM00193 DC    80X'FF'
         ORG   PATCHMPE+80
         DS    CL2
DECNO    DS    CL9
         ORG   DECNO
DECNO1   DS    CL8
@NM00194 DS    CL1
         ORG   DECNO+9
         DS    CL3
BCDNO    DS    CL5
         ORG   BCDNO
@NM00195 DS    CL1
BCDCOL   DS    CL2
@NM00196 DS    CL2
         ORG   BCDNO+5
HMASMMPE CSECT
MODSCAN DSCAN KEY='++',SUCC=MODKEY,BLANKS=ON
*
* LOOK FOR MOD HEADER & GET NAME
*
MODKEY DSCAN   KEY='MOD',ROUT=MODFND,SUCC=MODLPAR,ALT=UPDKEY
MODLPAR DSCAN KEY='(',SUCC=MODVAL
MODVAL DSCAN MAXLEN=8,ROUT=MODNMFND,SUCC=MODRPAR
MODRPAR DSCAN KEY=')',SUCC=DISTKEY
*
* LOOK FOR DISTLIB KEYWORD
*
DISTKEY DSCAN KEY='DISTLIB',SUCC=DISLPAR,ALT=DALKEY,ROUT=ONEDIST
DISLPAR DSCAN KEY='(',SUCC=DISVAL
DISVAL DSCAN MAXLEN=8,ROUT=DISNMFND,SUCC=DISRPAR
DISRPAR DSCAN KEY=')',SUCC=DISTKEY
*
* LOOK FOR DALIAS KEYWORD
*
DALKEY DSCAN KEY='DALIAS',SUCC=DALLPAR,ALT=TALKEY,ROUT=DALFND
DALLPAR DSCAN KEY='(',SUCC=DALVAL
DALVAL DSCAN MAXLEN=8,ROUT=DALNMFND,SUCC=DALRPAR
DALRPAR DSCAN KEY=')',SUCC=DISTKEY
*
* LOOK FOR TALIAS KEYWORD
*
TALKEY DSCAN KEY='TALIAS',SUCC=TALLPAR,ALT=LEPARKEY,ROUT=TALFND
TALLPAR DSCAN KEY='(',SUCC=TALVAL
TALVAL DSCAN MAXLEN=8,ROUT=TALNMFND,SUCC=TALRPAR,COMMA=NO
TALRPAR DSCAN KEY=')',SUCC=DISTKEY,ALT=TALVAL,COMMA=NO
*
* LOOK FOR LEPARM KEYWORD
*
LEPARKEY DSCAN KEY='LEPARM',SUCC=LELPAR,ALT=TXLKEY,ROUT=LEFND
LELPAR DSCAN KEY='(',SUCC=LERENT
LERENT DSCAN KEY='RENT',SUCC=LEREUS,ALT=LEREUS,ROUT=LERENTFD,COMMA=NO
LEREUS DSCAN KEY='REUS',SUCC=LERENT,ALT=LESCTR,ROUT=LEREUSFD,COMMA=NO
LESCTR DSCAN KEY='SCTR',SUCC=LERENT,ALT=LEOVLY,ROUT=LESCTRFD,COMMA=NO
LEOVLY DSCAN KEY='OVLY',SUCC=LERENT,ALT=LEREFR,ROUT=LEOVLYFD,COMMA=NO
LEREFR  DSCAN KEY='REFR',SUCC=LERENT,ALT=LENE,ROUT=LEREFRFD,COMMA=NO
LENE    DSCAN KEY='NE',SUCC=LERENT,ALT=LEAPF,ROUT=LENEFD,COMMA=NO
LEAPF   DSCAN KEY='AC=1',SUCC=LERENT,ALT=LEALN2,ROUT=LEAPFFD,COMMA=ON
LEALN2  DSCAN KEY='ALIGN2',SUCC=LERENT,ALT=LEDC,ROUT=LEALN2FD,COMMA=NO
LEDC    DSCAN KEY='DC',SUCC=LERENT,ALT=LESTD,COMMA=NO,ROUT=LEDCFD
LESTD   DSCAN KEY='STD',SUCC=LERENT,ALT=LEDCBS,COMMA=NO,ROUT=STDFND
LEDCBS  DSCAN KEY='DCBS',SUCC=LERENT,ALT=LEXREF,COMMA=N
LEXREF  DSCAN KEY='XREF',SUCC=LERENT,ALT=LELET,COMMA=NO
LELET   DSCAN KEY='LET',SUCC=LERENT,ALT=LEXCAL,COMMA=NO
LEXCAL  DSCAN KEY='XCAL',SUCC=LERENT,ALT=LELIST,COMMA=NO
LELIST  DSCAN KEY='LIST',SUCC=LERENT,ALT=LEOL,COMMA=NO
LEOL    DSCAN KEY='OL',SUCC=LERENT,ALT=LENCAL,COMMA=NO
LENCAL  DSCAN KEY='NCAL',SUCC=LERENT,ALT=LERPAR,COMMA=NO
LERPAR  DSCAN KEY=')',SUCC=DISTKEY
*
* LOOK FOR TXLIB KEYWORD
*
TXLKEY DSCAN KEY='TXLIB',SUCC=LIBLPAR,ALT=RELFKEY,ROUT=TXLFND
LIBLPAR DSCAN KEY='(',SUCC=LIBVAL
LIBVAL DSCAN MAXLEN=8,ROUT=LIBNMFND,SUCC=LIBRPAR
LIBRPAR DSCAN KEY=')',SUCC=DISTKEY
*
* LOOK FOR RELFILE KEYWORD
*
RELFKEY DSCAN KEY='RELFILE',SUCC=RELLPAR,ALT=RMIDKEY,ROUT=RELFND
RELLPAR DSCAN KEY='(',SUCC=RELVAL
RELVAL  DSCAN MINLEN=1,MAXLEN=4,TYPE=N,ROUT=RELNOFND,SUCC=RELRPAR
RELRPAR DSCAN KEY=')',SUCC=DISTKEY
*
* LOOK FOR RMID KEYWORD
*
RMIDKEY DSCAN KEY='RMID',SUCC=RMIDLPAR,ALT=DELKEY,ROUT=RMIDFND
RMIDLPAR DSCAN KEY='(',SUCC=RMIDVALA
RMIDVALA DSCAN MINLEN=7,MAXLEN=7,SUCC=RMIDRPAR,ROUT=RMIDVAL
RMIDRPAR DSCAN KEY=')',SUCC=DISTKEY
*
* LOOK FOR DELETE KEYWORD
*
DELKEY DSCAN KEY='DELETE',SUCC=DISTKEY,ALT=VERSKEY,ROUT=DELFND
*
* LOOK FOR VERSION KEYWORD
*
VERSKEY DSCAN KEY='VERSION',SUCC=VERSLPAR,ALT=LMODKEY,ROUT=VERSFND
VERSLPAR DSCAN KEY='(',SUCC=VERSVALA
VERSVALA DSCAN MINLEN=7,MAXLEN=7,SUCC=VERSRPAR,ROUT=VERSVAL
VERSRPAR DSCAN KEY=')',SUCC=DISTKEY,ALT=VERSVALA,COMMA=NO
*
* LOOK FOR LMOD KEYWORD
*
LMODKEY DSCAN KEY='LMOD',SUCC=LMODLPAR,ALT=LKLKEY,ROUT=LMODFND
LMODLPAR DSCAN KEY='(',SUCC=LMODVAL
LMODVAL DSCAN MAXLEN=8,SUCC=LMODRPAR,ROUT=LMODVALU,COMMA=NO
LMODRPAR DSCAN KEY=')',SUCC=DISTKEY,ALT=LMODVAL,COMMA=NO
*
* LOOK FOR LKLIB KEYWORD
*
LKLKEY DSCAN KEY='LKLIB',SUCC=LIBLPAR,ALT=MODPERIO,ROUT=LKLFND
* IF ABOVE KEYWORD FOUND, BRANCH TO COMMON DSCANS IN TXLIB SEARCH
*
* CONCLUDING DSCANS FOR MOD STATEMENT
*
MODPERIO DSCAN KEY='.',SUCC=EOCARD
HMASMMPE CSECT
*
* LOOK FOR UPDTE,MACUPD HEADER AND GET NAME
*
UPDKEY DSCAN KEY='UPDTE',ROUT=UPDFND,SUCC=UPDLPAR,ALT=MACUKEY
MACUKEY DSCAN KEY='MACUPD',ROUT=MACUFND,SUCC=UPDLPAR,ALT=MACKEY
UPDLPAR DSCAN KEY='(',SUCC=UPDVAL
UPDVAL DSCAN MAXLEN=8,ROUT=MODNMFND,SUCC=UPDRPAR
UPDRPAR DSCAN KEY=')',SUCC=ASM2KEY
*
* LOOK FOR ASSEM KEYWORD
*
ASM2KEY DSCAN KEY='ASSEM',SUCC=ASM2LPAR,ALT=SYU1KEY,ROUT=ASSMFND
ASM2LPAR DSCAN KEY='(',SUCC=ASM2VAL
ASM2VAL DSCAN MAXLEN=8,ROUT=ASSNMFND,SUCC=ASM2RPAR,COMMA=NO
ASM2RPAR DSCAN KEY=')',SUCC=ASM2KEY,ALT=ASM2VAL,COMMA=NO
*
* LOOK FOR SYSLIB KEYWORD
*
SYU1KEY DSCAN KEY='SYSLIB',ALT=MAL2KEY,SUCC=SYU1LPAR,ROUT=SYSDEL
SYU1LPAR DSCAN KEY='(',SUCC=SYU1VAL
SYU1VAL DSCAN MAXLEN=8,SUCC=SYU1RPAR,ROUT=SYSNMFND
SYU1RPAR DSCAN KEY=')',SUCC=ASM2KEY
*
* LOOK FOR MALIAS KEYWORD
*
MAL2KEY DSCAN KEY='MALIAS',ALT=ALB2KEY,SUCC=MAL2LPAR,ROUT=MALFND
MAL2LPAR DSCAN KEY='(',SUCC=MAL2VAL
MAL2VAL DSCAN MAXLEN=8,ROUT=TALNMFND,SUCC=MAL2RPAR,COMMA=NO
MAL2RPAR DSCAN KEY=')',SUCC=ASM2KEY,ALT=MAL2VAL,COMMA=NO
*
* LOOK FOR ASMLIB  DISTSRC KEYWORD
*
ALB2KEY DSCAN KEY='ASMLIB',SUCC=ALB2LPAR,ALT=DSTKEY2,ROUT=ASMDEL
DSTKEY2 DSCAN KEY='DISTSRC',SUCC=ALB2LPAR,ALT=VERSKEY2,ROUT=DISSDEL1
ALB2LPAR DSCAN KEY='(',SUCC=ALB2VAL
ALB2VAL DSCAN MAXLEN=8,ROUT=ALBNMFND,SUCC=ALB2RPAR
ALB2RPAR DSCAN KEY=')',SUCC=ASM2KEY
*
* LOOK FOR VERSION KEYWORD
*
VERSKEY2 DSCAN KEY='VERSION',SUCC=VERSLPR2,ALT=DIS4KEY,ROUT=VERSFND
VERSLPR2 DSCAN KEY='(',SUCC=VERSVAL2
VERSVAL2 DSCAN MINLEN=7,MAXLEN=7,SUCC=VERSRPA2,ROUT=VERSVAL
VERSRPA2 DSCAN KEY=')',SUCC=ASM2KEY,ALT=VERSVAL2,COMMA=NO
*
* LOOK FOR DISTLIB KEYWORD
*
DIS4KEY DSCAN KEY='DISTLIB',SUCC=DIS4LPAR,ALT=DISTOBJ2,ROUT=ONEDIST
DIS4LPAR DSCAN KEY='(',SUCC=DIS4VAL
DIS4VAL DSCAN MAXLEN=8,SUCC=DIS4RPAR,ROUT=DISNMFND
DIS4RPAR DSCAN KEY=')',SUCC=ASM2KEY
*
* LOOK FOR DISTOBJ  DISTMOD KEYWORD
*
DISTOBJ2 DSCAN KEY='DISTOBJ',SUCC=DOBJLPR2,ALT=DISTMOD2,ROUT=DISTDEL
DISTMOD2 DSCAN KEY='DISTMOD',SUCC=DOBJLPR2,ALT=BASEKEY2,ROUT=DISMDEL1
DOBJLPR2 DSCAN KEY='(',SUCC=DOBJVAL2
DOBJVAL2 DSCAN MAXLEN=8,ROUT=DOBJFND,SUCC=DOBJRPR2
DOBJRPR2 DSCAN KEY=')',SUCC=ASM2KEY
*
* LOOK FOR BASE(FIXEDUPDATE) KEYWORD AND IGNORE IT!!
*
BASEKEY2 DSCAN KEY='BASE',SUCC=BASELPR2,ALT=UPDPERIO
BASELPR2 DSCAN KEY='(',SUCC=BASEFIX2
BASEFIX2 DSCAN KEY='FIXED',SUCC=BASERPR2,ALT=BASEUPD2
BASEUPD2 DSCAN KEY='UPDATE',SUCC=BASERPR2
BASERPR2 DSCAN KEY=')',SUCC=ASM2KEY
*
* CONCLUDING DSCANS FOR UPDTE, MACUPD STATEMENT
*
UPDPERIO DSCAN KEY='.',SUCC=EOCARD
HMASMMPE CSECT
*
* LOOK FOR MAC HEADER AND GET NAME
*
MACKEY DSCAN KEY='MAC',ROUT=MACFND,SUCC=MACLPAR,ALT=ZAPKEY
MACLPAR DSCAN KEY='(',SUCC=MACVAL
MACVAL DSCAN MAXLEN=8,ROUT=MODNMFND,SUCC=MACRPAR
MACRPAR DSCAN KEY=')',SUCC=TX2KEY
*
* LOOK FOR TXLIB KEYWORD
*
TX2KEY DSCAN KEY='TXLIB',SUCC=LIB2LPAR,ALT=DIST2KEY,ROUT=TXLFND
LIB2LPAR DSCAN KEY='(',SUCC=LIB2VAL
LIB2VAL DSCAN MAXLEN=8,ROUT=TLIBFND,SUCC=LIB2RPAR
LIB2RPAR DSCAN KEY=')',SUCC=TX2KEY
*
* LOOK FOR DISTLIB KEYWORD
*
DIST2KEY DSCAN KEY='DISTLIB',SUCC=DIS3LPAR,ALT=DISTOBJ1,ROUT=ONEDIST
DIS3LPAR DSCAN KEY='(',SUCC=DIS3VAL
DIS3VAL DSCAN MAXLEN=8,ROUT=DISNMFND,SUCC=DIS3RPAR
DIS3RPAR DSCAN KEY=')',SUCC=TX2KEY
*
* LOOK FOR DISTOBJ  DISTMOD KEYWORD
*
DISTOBJ1 DSCAN KEY='DISTOBJ',ROUT=DISTDEL,SUCC=DOBJLPR1,ALT=DISTMOD1
DISTMOD1 DSCAN KEY='DISTMOD',ROUT=DISMDEL1,SUCC=DOBJLPR1,ALT=SSIKEY
DOBJLPR1 DSCAN KEY='(',SUCC=DOBJVAL1
DOBJVAL1 DSCAN MAXLEN=8,ROUT=DOBJFND,SUCC=DOBJRPR1
DOBJRPR1 DSCAN KEY=')',SUCC=TX2KEY
*
* LOOK FOR SSI KEYWORD
*
SSIKEY DSCAN KEY='SSI',ROUT=SSIDEL,SUCC=SSILPAR,ALT=ASSMKEY
SSILPAR DSCAN KEY='(',SUCC=SSIVAL
SSIVAL DSCAN MINLEN=8,MAXLEN=8,TYPE=H,ROUT=SSIFND,SUCC=SSIRPAR
SSIRPAR DSCAN KEY=')',SUCC=TX2KEY
*
* LOOK FOR ASSEM KEYWORD
*
ASSMKEY DSCAN KEY='ASSEM',SUCC=ASSMLPAR,ALT=SYM1KEY,ROUT=ASSMFND
ASSMLPAR DSCAN KEY='(',SUCC=ASSMVAL
ASSMVAL DSCAN MAXLEN=8,ROUT=ASSNMFND,SUCC=ASSMRPAR,COMMA=NO
ASSMRPAR DSCAN KEY=')',SUCC=TX2KEY,ALT=ASSMVAL,COMMA=NO
*
* LOOK FOR SYSLIB KEYWORD
*
SYM1KEY DSCAN KEY='SYSLIB',ROUT=SYSDEL,SUCC=SYM1LPAR,ALT=MAL1KEY
SYM1LPAR DSCAN KEY='(',SUCC=SYM1VAL
SYM1VAL DSCAN MAXLEN=8,ROUT=SYSNMFND,SUCC=SYM1RPAR
SYM1RPAR DSCAN KEY=')',SUCC=TX2KEY
*
* LOOK FOR MALIAS KEYWORD
*
MAL1KEY DSCAN KEY='MALIAS',SUCC=MAL1LPAR,ALT=ALBKEY,ROUT=MALFND
MAL1LPAR DSCAN KEY='(',SUCC=MAL1VAL
MAL1VAL DSCAN MAXLEN=8,ROUT=TALNMFND,SUCC=MAL1RPAR,COMMA=NO
MAL1RPAR DSCAN KEY=')',SUCC=TX2KEY,ALT=MAL1VAL,COMMA=NO
*
* LOOK FOR ASMLIB  DISTSRC KEYWORD
*
ALBKEY DSCAN KEY='ASMLIB',ROUT=ASMDEL,SUCC=ALBLPAR,ALT=DISTKEY1
DISTKEY1 DSCAN KEY='DISTSRC',ROUT=DISSDEL1,SUCC=ALBLPAR,ALT=RELFKEY1
ALBLPAR DSCAN KEY='(',SUCC=ALBVAL
ALBVAL DSCAN MAXLEN=8,SUCC=ALBRPAR,ROUT=ALBNMFND
ALBRPAR DSCAN KEY=')',SUCC=TX2KEY
*
* LOOK FOR RELFILE KEYWORD
*
RELFKEY1 DSCAN KEY='RELFILE',SUCC=RELLPAR1,ALT=RMIDKEY1,ROUT=RELFND
RELLPAR1 DSCAN KEY='(',SUCC=RELVAL1
RELVAL1 DSCAN MINLEN=1,MAXLEN=4,TYPE=N,ROUT=RELNOFND,SUCC=RELRPAR1
RELRPAR1 DSCAN KEY=')',SUCC=TX2KEY
*
* LOOK FOR RMID KEYWORD
*
RMIDKEY1 DSCAN KEY='RMID',SUCC=RMIDLPA1,ALT=DELKEY1,ROUT=RMIDFND
RMIDLPA1 DSCAN KEY='(',SUCC=RMIDVALB
RMIDVALB DSCAN MINLEN=7,MAXLEN=7,SUCC=RMIDRPA1,ROUT=RMIDVAL
RMIDRPA1 DSCAN KEY=')',SUCC=TX2KEY
*
* LOOK FOR DELETE KEYWORD
*
DELKEY1 DSCAN KEY='DELETE',SUCC=TX2KEY,ALT=VERSKEY1,ROUT=DELFND1
*
* LOOK FOR VERSION KEYWORD
*
VERSKEY1 DSCAN KEY='VERSION',SUCC=VERSLPA1,ALT=BASEKEY1,ROUT=VERSFND
VERSLPA1 DSCAN KEY='(',SUCC=VERSVALB
VERSVALB DSCAN MINLEN=7,MAXLEN=7,SUCC=VERSRPA1,ROUT=VERSVAL
VERSRPA1 DSCAN KEY=')',SUCC=TX2KEY,ALT=VERSVALB,COMMA=NO
*
*
* LOOK FOR BASE(FIXEDUPDATE) KEYWORD AND IGNORE IT!!
*
BASEKEY1 DSCAN KEY='BASE',SUCC=BASELPR1,ALT=MACPERIO
BASELPR1 DSCAN KEY='(',SUCC=BASEFIX1
BASEFIX1 DSCAN KEY='FIXED',SUCC=BASERPR1,ALT=BASEUPD1
BASEUPD1 DSCAN KEY='UPDATE',SUCC=BASERPR1
BASERPR1 DSCAN KEY=')',SUCC=TX2KEY
*
* CONCLUDING DSCANS FOR MAC STATEMENT
*
MACPERIO DSCAN KEY='.',SUCC=EOCARD
HMASMMPE CSECT
*
* LOOK FOR ZAP HEADER AND GET NAME
*
ZAPKEY DSCAN KEY='ZAP',ROUT=ZAPFND,SUCC=ZAPLPAR,ALT=SRUPKEY
ZAPLPAR DSCAN KEY='(',SUCC=ZAPVAL
ZAPVAL DSCAN MAXLEN=8,ROUT=MODNMFND,SUCC=ZAPRPAR
ZAPRPAR DSCAN KEY=')',SUCC=DIS2KEY
*
* LOOK FOR DISTLIB KEYWORD
*
DIS2KEY DSCAN KEY='DISTLIB',SUCC=DIS2LPAR,ALT=DAL2KEY,ROUT=ONEDIST
DIS2LPAR DSCAN KEY='(',SUCC=DIS2VAL
DIS2VAL DSCAN MAXLEN=8,ROUT=DISNMFND,SUCC=DIS2RPAR
DIS2RPAR DSCAN KEY=')',SUCC=DIS2KEY
*
* LOOK FOR DALIAS KEYWORD
*
DAL2KEY DSCAN KEY='DALIAS',SUCC=DAL2LPAR,ALT=TAL2KEY,ROUT=DALFND
DAL2LPAR DSCAN KEY='(',SUCC=DAL2VAL
DAL2VAL DSCAN MAXLEN=8,ROUT=DALNMFND,SUCC=DAL2RPAR
DAL2RPAR DSCAN KEY=')',SUCC=DIS2KEY
*
* LOOK FOR TALIAS KEYWORD
*
TAL2KEY DSCAN KEY='TALIAS',SUCC=TAL2LPAR,ALT=ZAPPERIO,ROUT=TALFND
TAL2LPAR DSCAN KEY='(',SUCC=TAL2VAL
TAL2VAL DSCAN MAXLEN=8,ROUT=TALNMFND,SUCC=TAL2RPAR,COMMA=NO
TAL2RPAR DSCAN KEY=')',SUCC=DIS2KEY,ALT=TAL2VAL,COMMA=NO
*
* CONCLUDING DSCANS FOR ZAP STATEMENT
*
ZAPPERIO DSCAN KEY='.',SUCC=EOCARD
HMASMMPE CSECT
*
* LOOK FOR SRCUPD HEADER AND GET NAME
*
SRUPKEY DSCAN KEY='SRCUPD',ROUT=SUPDFND,SUCC=SRUPLPAR,ALT=SRCKEY
SRUPLPAR DSCAN KEY='(',SUCC=SRUPVAL
SRUPVAL DSCAN MAXLEN=8,ROUT=MODNMFND,SUCC=SRUPRPAR
SRUPRPAR DSCAN KEY=')',SUCC=DIS5KEY
*
* LOOK FOR DISTLIB KEYWORD
*
DIS5KEY DSCAN KEY='DISTLIB',SUCC=DIS5LPAR,ALT=DISTOBJ3,ROUT=ONEDIST
DIS5LPAR DSCAN KEY='(',SUCC=DIS5VAL
DIS5VAL DSCAN MAXLEN=8,ROUT=DISNMFND,SUCC=DIS5RPAR
DIS5RPAR DSCAN KEY=')',SUCC=DIS5KEY
*
* LOOK FOR DISTOBJ  DISTMOD KEYWORD
*
DISTOBJ3 DSCAN KEY='DISTOBJ',SUCC=DOBJLPR3,ALT=DISTMOD3,ROUT=DISTDEL
DISTMOD3 DSCAN KEY='DISTMOD',SUCC=DOBJLPR3,ALT=SYS1KEY,ROUT=DISMDEL1
DOBJLPR3 DSCAN KEY='(',SUCC=DOBJVAL3
DOBJVAL3 DSCAN MAXLEN=8,ROUT=DOBJFND,SUCC=DOBJRPR3
DOBJRPR3 DSCAN KEY=')',SUCC=DIS5KEY
*
* LOOK FOR SYSLIB KEYWORD
*
SYS1KEY DSCAN KEY='SYSLIB',SUCC=SYS1LPAR,ALT=VERSKEY3,ROUT=SYSDEL
SYS1LPAR DSCAN KEY='(',SUCC=SYS1VAL
SYS1VAL DSCAN MAXLEN=8,SUCC=SYS1RPAR,ROUT=SYSNMFND
SYS1RPAR DSCAN KEY=')',SUCC=DIS5KEY
*
* LOOK FOR VERSION KEYWORD
*
VERSKEY3 DSCAN KEY='VERSION',SUCC=VERSLPR5,ALT=BASEKEY3,ROUT=VERSFND
VERSLPR5 DSCAN KEY='(',SUCC=VERSVAL5
VERSVAL5 DSCAN MINLEN=7,MAXLEN=7,SUCC=VERSRPA5,ROUT=VERSVAL
VERSRPA5 DSCAN KEY=')',SUCC=DIS5KEY,ALT=VERSVAL5,COMMA=NO
*
* LOOK FOR BASE(FIXEDUPDATE) KEYWORD AND IGNORE IT!!
*
BASEKEY3 DSCAN KEY='BASE',SUCC=BASELPR3,ALT=SRUPERIO
BASELPR3 DSCAN KEY='(',SUCC=BASEFIX3
BASEFIX3 DSCAN KEY='FIXED',SUCC=BASERPR3,ALT=BASEUPD3
BASEUPD3 DSCAN KEY='UPDATE',SUCC=BASERPR3
BASERPR3 DSCAN KEY=')',SUCC=DIS5KEY
*
* CONCLUDING DSCAN FOR SRCUPD STATEMENT
*
SRUPERIO DSCAN KEY='.',SUCC=EOCARD
HMASMMPE CSECT
*
* LOOK FOR SRC HEADER AND GET NAME
*
SRCKEY DSCAN KEY='SRC',SUCC=SRCLPAR,ROUT=SRCFND,ALT=JCLINKEY
SRCLPAR DSCAN KEY='(',SUCC=SRCVAL
SRCVAL DSCAN MAXLEN=8,SUCC=SRCRPAR,ROUT=MODNMFND
SRCRPAR DSCAN KEY=')',SUCC=DIS6KEY
*
* LOOK FOR DISTLIB KEYWORD
*
DIS6KEY DSCAN KEY='DISTLIB',SUCC=DIS6LPAR,ALT=DISTOBJ4,ROUT=ONEDIST
DIS6LPAR DSCAN KEY='(',SUCC=DIS6VAL
DIS6VAL DSCAN MAXLEN=8,SUCC=DIS6RPAR,ROUT=DISNMFND
DIS6RPAR DSCAN KEY=')',SUCC=DIS6KEY
*
* LOOK FOR DISTOBJ  DISTMOD KEYWORD
*
DISTOBJ4 DSCAN KEY='DISTOBJ',ROUT=DISTDEL,SUCC=DOBJLPR4,ALT=DISTMOD4
DISTMOD4 DSCAN KEY='DISTMOD',ROUT=DISMDEL1,SUCC=DOBJLPR4,ALT=SYS2KEY
DOBJLPR4 DSCAN KEY='(',SUCC=DOBJVAL4
DOBJVAL4 DSCAN MAXLEN=8,ROUT=DOBJFND,SUCC=DOBJRPR4
DOBJRPR4 DSCAN KEY=')',SUCC=DIS6KEY
*
* LOOK FOR SYSLIB KEYWORD
*
SYS2KEY DSCAN KEY='SYSLIB',ROUT=SYSDEL,SUCC=SYS2LPAR,ALT=TX3KEY
SYS2LPAR DSCAN KEY='(',SUCC=SYS2VAL
SYS2VAL DSCAN MAXLEN=8,SUCC=SYS2RPAR,ROUT=SYSNMFND
SYS2RPAR DSCAN KEY=')',SUCC=DIS6KEY
*
* LOOK FOR TXLIB KEYWORD
*
TX3KEY DSCAN KEY='TXLIB',SUCC=TX3LPAR,ALT=SSI2KEY,ROUT=TXLFND
TX3LPAR DSCAN KEY='(',SUCC=TX3VAL
TX3VAL DSCAN MAXLEN=8,SUCC=TX3RPAR,ROUT=TLIBFND
TX3RPAR DSCAN KEY=')',SUCC=DIS6KEY
*
* LOOK FOR SSI KEYWORD
*
SSI2KEY DSCAN KEY='SSI',ROUT=SSIDEL,SUCC=SSI2LPAR,ALT=RELFKEY5
SSI2LPAR DSCAN KEY='(',SUCC=SSI2VAL
SSI2VAL DSCAN MINLEN=8,MAXLEN=8,TYPE=H,ROUT=SSIFND,SUCC=SSI2RPAR
SSI2RPAR DSCAN KEY=')',SUCC=DIS6KEY
*
* LOOK FOR RELFILE KEYWORD
*
RELFKEY5 DSCAN KEY='RELFILE',SUCC=RELLPAR5,ALT=RMD5KEY,ROUT=RELFND
RELLPAR5 DSCAN KEY='(',SUCC=RELVAL5
RELVAL5 DSCAN MAXLEN=4,TYPE=N,ROUT=RELNOFND,SUCC=RELRPAR5
RELRPAR5 DSCAN KEY=')',SUCC=DIS6KEY
*
* LOOK FOR RMID KEYWORD
*
RMD5KEY  DSCAN KEY='RMID',SUCC=RMD5LPAR,ALT=DELKEY5,ROUT=RMIDFND
RMD5LPAR DSCAN KEY='(',SUCC=RMD5VALA
RMD5VALA DSCAN MINLEN=7,MAXLEN=7,SUCC=RMD5RPAR,ROUT=RMIDVAL
RMD5RPAR DSCAN KEY=')',SUCC=DIS6KEY
*
* LOOK FOR DELETE KEYWORD
*
DELKEY5 DSCAN KEY='DELETE',SUCC=DIS6KEY,ALT=VERSKEYF,ROUT=DELFND1
*
* LOOK FOR VERSION KEYWORD
*
VERSKEYF DSCAN KEY='VERSION',SUCC=VERFLPAR,ALT=BASEKEY4,ROUT=VERSFND
VERFLPAR DSCAN KEY='(',SUCC=VERFVALA
VERFVALA DSCAN MINLEN=7,MAXLEN=7,SUCC=VERFRPAR,ROUT=VERSVAL
VERFRPAR DSCAN KEY=')',SUCC=DIS6KEY,ALT=VERFVALA,COMMA=NO
*
* LOOK FOR BASE(FIXEDUPDATE) KEYWORD AND IGNORE IT!!
*
BASEKEY4 DSCAN KEY='BASE',SUCC=BASELPR4,ALT=SRCPERIO
BASELPR4 DSCAN KEY='(',SUCC=BASEFIX4
BASEFIX4 DSCAN KEY='FIXED',SUCC=BASERPR4,ALT=BASEUPD4
BASEUPD4 DSCAN KEY='UPDATE',SUCC=BASERPR4
BASERPR4 DSCAN KEY=')',SUCC=DIS6KEY
*
* CONCLUDING DSCAN FOR SRC STATEMENT
*
SRCPERIO DSCAN KEY='.',SUCC=EOCARD
HMASMMPE CSECT
*
* LOOK FOR JCLIN HEADER AND GET NAME
*
JCLINKEY DSCAN KEY='JCLIN',ROUT=JCLINFND,SUCC=ASM7KEY
*
* LOOK FOR ASM KEYWORD
*
ASM7KEY DSCAN KEY='ASM',SUCC=ASM7LPAR,ALT=COPYKEY,ROUT=ONEASM
ASM7LPAR DSCAN KEY='(',SUCC=ASMPGM
ASMPGM DSCAN KEY='PGM=',SUCC=ASM7VAL,ALT=ASM7VAL,ROUT=ASMPGMFD
ASM7VAL DSCAN MAXLEN=8,ROUT=ASMFND,SUCC=ASM7RPAR
ASM7RPAR DSCAN KEY=')',SUCC=ASM7KEY
*
* LOOK FOR COPY KEYWORD
*
COPYKEY DSCAN KEY='COPY',SUCC=COPYLPAR,ALT=LKEDKEY,ROUT=ONECOPY
COPYLPAR DSCAN KEY='(',SUCC=CPYPGM
CPYPGM DSCAN KEY='PGM=',SUCC=COPYVAL,ALT=COPYVAL,ROUT=CPYPGMFD
COPYVAL DSCAN MAXLEN=8,ROUT=CPYNMFND,SUCC=COPYRPAR
COPYRPAR DSCAN KEY=')',SUCC=ASM7KEY
*
* LOOK FOR LKED KEYWORD
*
LKEDKEY DSCAN KEY='LKED',SUCC=LKEDLPAR,ALT=UPDAKEY,ROUT=ONELKED
LKEDLPAR DSCAN KEY='(',SUCC=LKEPGM
LKEPGM DSCAN KEY='PGM=',SUCC=LKEDVAL,ALT=LKEDVAL,ROUT=LKEPGMFD
LKEDVAL DSCAN MAXLEN=8,ROUT=LKDNMFND,SUCC=LKEDRPAR
LKEDRPAR DSCAN KEY=')',SUCC=ASM7KEY
*
* LOOK FOR UPDATE KEYWORD
*
UPDAKEY DSCAN KEY='UPDATE',SUCC=UPDALPAR,ALT=TEXLKEY,ROUT=ONEUPD
UPDALPAR DSCAN KEY='(',SUCC=UPDPGM
UPDPGM DSCAN KEY='PGM=',SUCC=UPDAVAL,ALT=UPDAVAL,ROUT=UPDPGMFD
UPDAVAL DSCAN MAXLEN=8,ROUT=UPDNMFND,SUCC=UPDARPAR
UPDARPAR DSCAN KEY=')',SUCC=ASM7KEY
*
*
* LOOK FOR TXLIB KEYWORD
*
TEXLKEY DSCAN KEY='TXLIB',SUCC=TEXLLPAR,ROUT=TXLFND,ALT=RFLKEY
TEXLLPAR DSCAN KEY='(',SUCC=TEXLVAL
TEXLVAL DSCAN MAXLEN=8,SUCC=TEXLRPAR,ROUT=TLIBFND
TEXLRPAR DSCAN KEY=')',SUCC=ASM7KEY
*
* LOOK FOR RELFILE KEYWORD
*
RFLKEY DSCAN KEY='RELFILE',SUCC=RFLLPAR,ALT=JCLPERIO,ROUT=RELFND
RFLLPAR DSCAN KEY='(',SUCC=RFLVAL
RFLVAL DSCAN MINLEN=1,MAXLEN=4,TYPE=N,ROUT=RELNOFND,SUCC=RFLRPAR
RFLRPAR DSCAN KEY=')',SUCC=ASM7KEY
*
* CONCLUDING DSCANS FOR JCLIN STATEMENT
*
JCLPERIO DSCAN KEY='.',SUCC=EOCARD
*
* CONCLUDING DSCANS FOR ALL STATEMENTS
*
EOCARD   DSCAN MINLEN=0,MAXLEN=255,IO=NO,ROUT=ABNSCN2
HMASMMPE CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCAPTR   EQU   @11
RTNREG   EQU   @14
REG1     EQU   @01
RTNCODE  EQU   @15
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCAPEMAX EQU   CCAFSYS+10
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00009 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCATYPEA EQU   0
CCABLDLA EQU   0
@NM00025 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00027 EQU   CCABLDLL
CCALKDRC EQU   @NM00027+20
@NM00029 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00039+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00043 EQU   HMASMIOP+12
@NM00044 EQU   @NM00043
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00154 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
MCBPTFMP EQU   0
MCBTYPE  EQU   MCBPTFMP
MCBVERMP EQU   0
MCBVEND  EQU   MCBVERMP+8
MCBIFMP  EQU   0
MCBIEND  EQU   MCBIFMP+8
MCBELEMP EQU   0
MCBENAME EQU   MCBELEMP+1
MCBEDIST EQU   MCBELEMP+9
MCBEDOBJ EQU   MCBELEMP+17
MCBESYS  EQU   MCBELEMP+25
MCBETXLB EQU   MCBELEMP+33
MCBELKLB EQU   MCBELEMP+41
MCBEASLB EQU   MCBELEMP+49
MCBEDALS EQU   MCBELEMP+57
MCBESSI  EQU   MCBELEMP+65
MCBERLF  EQU   MCBELEMP+73
MCBEJASM EQU   MCBELEMP+77
MCBELASM EQU   MCBELEMP+89
MCBEJCPY EQU   MCBELEMP+90
MCBELCPY EQU   MCBELEMP+102
MCBEJUPI EQU   MCBELEMP+103
MCBELUPI EQU   MCBELEMP+115
MCBEJLKD EQU   MCBELEMP+116
MCBELLKD EQU   MCBELEMP+128
MCBERMID EQU   MCBELEMP+129
MCBELEPM EQU   MCBELEMP+136
MCBEFLG1 EQU   MCBELEPM
MCBEAPF  EQU   MCBEFLG1
MCBERENT EQU   MCBEFLG1
MCBEREUS EQU   MCBEFLG1
MCBESCTR EQU   MCBEFLG1
MCBEOVLY EQU   MCBEFLG1
MCBEREFR EQU   MCBEFLG1
MCBEDC   EQU   MCBEFLG1
MCBEFLG2 EQU   MCBELEPM+1
MCBENE   EQU   MCBEFLG2
MCBEPAGA EQU   MCBEFLG2
MCBEFLG3 EQU   MCBELEPM+2
MCBEFLG4 EQU   MCBELEPM+3
MCBEFLG5 EQU   MCBELEMP+140
MCBESTD  EQU   MCBEFLG5
MCBEDEL  EQU   MCBEFLG5
MCBEEND  EQU   MCBELEMP+141
SCPSTRNG EQU   0
HMASMCRP EQU   0
CRPSCPAD EQU   HMASMCRP+4
CRPRETRN EQU   HMASMCRP+10
CRPFLG1  EQU   HMASMCRP+14
CRPFLG2  EQU   HMASMCRP+16
CRPINSW0 EQU   CRPFLG2
CRPINSW1 EQU   CRPFLG2
CRPINSW2 EQU   CRPFLG2
CRPINSW3 EQU   CRPFLG2
CRPBUFFR EQU   HMASMCRP+18
CRPBFCTL EQU   CRPBUFFR
CCADSIDA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
SCPIOPRM EQU   0
MPPPARM  EQU   0
MPPIOPAD EQU   MPPPARM
MPPMCBAD EQU   MPPPARM+4
MPPCRDAD EQU   MPPPARM+8
MPPCRDPM EQU   MPPPARM+12
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00050 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00061 EQU   IOPUDATA
@NM00062 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00071 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00082 EQU   IOPSRCDR+1
@NM00084 EQU   @NM00082+7
@NM00088 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00092 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00098 EQU   IOPMODDR+1
@NM00100 EQU   @NM00098+7
@NM00104 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00108 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00119 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00126 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPTYPE EQU   IOPPTFDR+1
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPJCLP  EQU   IOPPTFF2
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00135 EQU   IOPPTFFX
@NM00136 EQU   @NM00135
IOPPRELN EQU   @NM00136
IOPPDTES EQU   IOPPTFFX+41
@NM00139 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPPTFND EQU   IOPPMODS
IOPPIND  EQU   IOPPNTRY+8
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00164 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00164
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00168 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00168
IOPBFTB1 EQU   IOPBFTB0
MCBVVLST EQU   MCBVEND
MCBVNTRY EQU   MCBVVLST
MCBVNUM  EQU   MCBVNTRY
MCBIVLST EQU   MCBIEND
MCBINTRY EQU   MCBIVLST
MCBINUM  EQU   MCBINTRY
MCBEVLST EQU   MCBEEND
MCBENTRY EQU   MCBEVLST
MCBENUM  EQU   MCBENTRY
MCBEND   EQU   MCBENUM
MCBEIND  EQU   MCBEVLST+8
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00181 EQU   MCBENTRY+7
MCBIIND  EQU   MCBIVLST+8
@NM00174 EQU   MCBINTRY+7
MCBIND   EQU   MCBINUM
MCBVIND  EQU   MCBVVLST+8
@NM00172 EQU   MCBVNTRY+7
MCBVND   EQU   MCBVNUM
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00170 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00169 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00167 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00166 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00165 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00163 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00162 EQU   IOPPTSFX+35
@NM00161 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00160 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00159 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00158 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00157 EQU   IOPQFMDR
@NM00153 EQU   IOPQSMDR
@NM00152 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00151 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00150 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00149 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00148 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00147 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00146 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00145 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00144 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00143 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00142 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00141 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPFMID EQU   IOPPTFFX+73
@NM00140 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00139+3
IOPRECD  EQU   @NM00139
@NM00138 EQU   IOPPTFFX+8
@NM00137 EQU   @NM00135+7
@NM00134 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00133 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00132 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00131 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
@NM00130 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00129 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00128 EQU   @NM00126+7
@NM00127 EQU   @NM00126
@NM00125 EQU   IOPSYSDR+5
@NM00124 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00123 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00122 EQU   IOPDLBFX+8
@NM00121 EQU   @NM00119+7
@NM00120 EQU   @NM00119
@NM00118 EQU   IOPDLBDR+1
@NM00117 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00116 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00115 EQU   IOPMODFX+12
@NM00114 EQU   IOPMODF4
@NM00113 EQU   IOPMODF3
@NM00112 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00111 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00110 EQU   @NM00108+7
@NM00109 EQU   @NM00108
@NM00107 EQU   IOPMODDR+17
@NM00106 EQU   @NM00104+7
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00100
@NM00102 EQU   @NM00100
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00098
@NM00097 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00096 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00095 EQU   IOPSRCFX+8
@NM00094 EQU   @NM00092+7
@NM00093 EQU   @NM00092
@NM00091 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00090 EQU   @NM00088+7
@NM00089 EQU   @NM00088
@NM00087 EQU   @NM00084
@NM00086 EQU   @NM00084
@NM00085 EQU   @NM00084
@NM00083 EQU   @NM00082
@NM00081 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00080 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00079 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00078 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00077 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00076 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00075 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00073 EQU   @NM00071+7
@NM00072 EQU   @NM00071
@NM00070 EQU   IOPLMDDR+6
@NM00069 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00068 EQU   IOPLMDF4
@NM00067 EQU   IOPLMDF3
@NM00066 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00065 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00064 EQU   IOPLMDDR
@NM00063 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00062+4
IOPUSED  EQU   @NM00062
IOPTPSEQ EQU   @NM00061+8
IOPVLSER EQU   @NM00061+2
IOPBLKSI EQU   @NM00061
IOPCQMAX EQU   IOPCQMAP+12
@NM00060 EQU   IOPCQMAP+11
@NM00059 EQU   IOPCQMAP+8
@NM00058 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00057 EQU   IOPSCMAP+11
@NM00056 EQU   IOPSCMAP+8
@NM00055 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00054 EQU   IOPNTMAX+11
@NM00053 EQU   IOPNTMAX+8
@NM00052 EQU   IOPNTMAX
@NM00051 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00050+5
IOPIPTF3 EQU   @NM00050
MPPSMDNM EQU   MPPPARM+16
CRPDDNAM EQU   HMASMCRP+98
CRPBFSEQ EQU   CRPBUFFR+72
CRPBFCNT EQU   CRPBFCTL+71
CRPBFDTA EQU   CRPBFCTL
CRPINSWF EQU   CRPFLG2+1
CRPINSWE EQU   CRPFLG2+1
CRPINSWD EQU   CRPFLG2+1
CRPINSWC EQU   CRPFLG2+1
CRPINSWB EQU   CRPFLG2+1
CRPINSWA EQU   CRPFLG2+1
CRPINSW9 EQU   CRPFLG2+1
CRPINSW8 EQU   CRPFLG2+1
CRPINSW7 EQU   CRPFLG2
CRPINSW6 EQU   CRPFLG2
CRPINSW5 EQU   CRPFLG2
CRPINSW4 EQU   CRPFLG2
CRPEOF1  EQU   CRPINSW3
CRPWRTLG EQU   CRPINSW2
CRPEXADD EQU   CRPINSW1
CRPEOFSW EQU   CRPINSW0
@NM00185 EQU   CRPFLG1+1
CRPRPT   EQU   CRPFLG1+1
CRPLIST  EQU   CRPFLG1+1
CRPNOWPP EQU   CRPFLG1+1
CRPTRMEX EQU   CRPFLG1+1
CRPEOFEN EQU   CRPFLG1+1
CRPSCNCL EQU   CRPFLG1
CRPOFFST EQU   CRPFLG1
CRPOTHER EQU   CRPFLG1
CRPPRINT EQU   CRPFLG1
CRPLOG   EQU   CRPFLG1
CRPPTS   EQU   CRPFLG1
CRPLOGCK EQU   CRPFLG1
CRPBFPRM EQU   CRPFLG1
@NM00184 EQU   HMASMCRP+11
CRPOUTDS EQU   HMASMCRP+9
CRPINDS  EQU   HMASMCRP+8
@NM00183 EQU   HMASMCRP+1
CRPUXNUM EQU   HMASMCRP
@NM00180 EQU   MCBEFLG5
@NM00179 EQU   MCBEFLG4
@NM00178 EQU   MCBEFLG3
@NM00177 EQU   MCBEFLG2
@NM00176 EQU   MCBEFLG1
@NM00175 EQU   MCBELEMP
MCBIFENV EQU   MCBIFMP+1
@NM00173 EQU   MCBIFMP
MCBSFMID EQU   MCBVERMP+1
@NM00171 EQU   MCBVERMP
MCBPTP   EQU   MCBPTFMP+10
MCBPRELN EQU   MCBPTFMP+8
MCBPNO   EQU   MCBPTFMP+1
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00156 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00155 EQU   @NM00154+7
IOPQSMFM EQU   @NM00154
@NM00074 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00049 EQU   IOPUSERL
@NM00048 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00047 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00046 EQU   @NM00043+10
IOPSEQNO EQU   @NM00043+8
@NM00045 EQU   @NM00044+7
IOPPTFNM EQU   @NM00044
IOPTYPE  EQU   HMASMIOP+3
IOPRETRN EQU   HMASMIOP+2
IOPFUNCT EQU   HMASMIOP+1
IOPDSID  EQU   HMASMIOP
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00042 EQU   CCABLDLM+2
@NM00041 EQU   CCABLDLM
CCAUPDPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00039+12
CCAUPDTE EQU   @NM00039+8
CCAUPDNM EQU   @NM00039
CCASUPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00037+12
CCAIOSUP EQU   @NM00037+8
CCASUPNM EQU   @NM00037
CCAZAPPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00035+12
CCASPZAP EQU   @NM00035+8
CCAZAPNM EQU   @NM00035
CCACOMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00033+12
CCACOMRS EQU   @NM00033+8
CCACOMNM EQU   @NM00033
CCACPYPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00031+12
CCACOPY  EQU   @NM00031+8
CCACPYNM EQU   @NM00031
CCAASMPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00029+12
CCAASM   EQU   @NM00029+8
CCAASMNM EQU   @NM00029
CCALKDPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00027+12
CCALKED  EQU   @NM00027+8
CCALKDNM EQU   @NM00027
CCAPGMPM EQU   @NM00025+24
@NM00026 EQU   @NM00025+21
CCABPGRC EQU   @NM00025+20
CCABPGSP EQU   @NM00025+12
CCABPGAD EQU   @NM00025+8
CCABPGNM EQU   @NM00025
CCAEND   EQU   HMASMCCA+371
@NM00024 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00023 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00022 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00021 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00020 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00019 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00018 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00017 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00016 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00015 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00014 EQU   @NM00009+18
@NM00013 EQU   @NM00009+16
CCATBLPA EQU   @NM00009+12
@NM00012 EQU   @NM00009+8
@NM00011 EQU   @NM00009+4
@NM00010 EQU   @NM00009
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00008 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00007 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00006 EQU   CCAFBUFR+122
@NM00005 EQU   CCAFBUFR+120
@NM00004 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00003 EQU   CCAFBUFR+88
@NM00002 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00001 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00226 EQU   ENDOFMPE
@RF00263 EQU   @RC00261
@RF00265 EQU   @RC00261
@RC00279 EQU   @EL00004
@RF00309 EQU   @EL00004
@RC00325 EQU   @EL00004
@RT00522 EQU   MUTXERR
@RT00535 EQU   MUTXERR
@RT00541 EQU   LOOP1
@RT00556 EQU   MUTXERR
@RT00649 EQU   MUTXERR
@RC00653 EQU   GOODSCAN
@RT00683 EQU   MUTXERR
@RT00688 EQU   ABNSCN2
@RT00719 EQU   MUTXERR
@RT00732 EQU   MUTXERR
@RT00747 EQU   LOOP2
@RT00762 EQU   MUTXERR
@RT00772 EQU   MUTXERR
@RT00778 EQU   LOOP3
@RT00793 EQU   MUTXERR
@RT00799 EQU   LOOP4
@RT00814 EQU   MUTXERR
@RT00827 EQU   MUTXERR
@RT00848 EQU   MUTXERR
@RT00858 EQU   MUTXERR
@RT00868 EQU   MUTXERR
@RT00897 EQU   MUTXERR
@RT00910 EQU   MUTXERR
@RC00995 EQU   @RC00992
ROUTSEND EQU   @EL00011
@RC00281 EQU   @RC00279
@ENDDATA EQU   *
         END   HMASMMPE,(C'PLS2054',0802,78334)

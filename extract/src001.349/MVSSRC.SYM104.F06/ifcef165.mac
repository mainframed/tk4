       TITLE   'IFCEF165 MODEL 165 CPU EDIT TABLE 4'
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        *
         SPACE 2
         MACRO
&NAME    DSGEN ,
.*                            THIS MACRO GENERATES ONE DSECT WORD
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE
.*                                 FIRST IS THE NAME OF THE LOG ITEM
.*                                 WHILE THE SECOND IS THE # OF BITS TO
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS
.*                                 UNUSED BIT GROUPS MUST BE GIVEN
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR
.*                                 THE LOG ITEMS MAY THEN BE USED IN
.*                                 THE CONVERSION MACRO INSTRUCTIONS.
         GBLC &ITEM(2000)                                      @YL02021
         GBLA &ITEMNBR,&BITS(2000),&SHIFT(2000)                @YL02021
         LCLB  &ONLY1,&CTIND                                   @YL02021
         LCLA  &START1,&START2,&END1,&END2                     @YL02021
         LCLC  &SYMBOL,&EQUSYM                                 @YL02021
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                        @YL02021
         ACTR  100000                                          @YL02021
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                   @YL02021
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1   @YL02021
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT    @YL02021
         AGO   .SET2A                   BRANCH AROUND          @YL02021
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'     @YL02021
         MEXIT                                                 @YL02021
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X
               ).SET2                   TEST FOR NO SECOND     @YL02021
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2   @YL02021
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2     @YL02021
         AGO   .LOOP                                           @YL02021
.SET2    ANOP                                                  @YL02021
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION
         AGO   .LOOP                                           @YL02021
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'    @YL02021
         MEXIT                                                 @YL02021
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'      @YL02021
         MEXIT                                                 @YL02021
.LOOP    ANOP                                                  @YL02021
&OP      SETA  &OP+1                                           @YL02021
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE  @YL02021
&ITEMNBR SETA  &ITEMNBR+1                                      @YL02021
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                   @YL02021
         MNOTE '**NULL BIT COUNT FIELD**'                      @YL02021
         MEXIT                                                 @YL02021
.OK1     ANOP                                                  @YL02021
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                               @YL02021
         AIF   ('&SYMBOL' NE '').OK                            @YL02021
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                @YL02021
         AGO   .START                   GET NEXT               @YL02021
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU @YL02021
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT
         AGO   .NO3                     BRANCH AROUND          @YL02021
.OK2     ANOP                                                  @YL02021
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED     @YL02021
.NO3     ANOP                                                  @YL02021
&SYMBOL  EQU   *+&BYTE                                         @YL02021
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL    @YL02021
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                           @YL02021
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                           @YL02021
.CNT     ANOP                                                  @YL02021
&CTIND   SETB  1                        SET COUNT INDICATOR    @YL02021
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                          @YL02021
&BYTE    SETA  &COUNT/8                                        @YL02021
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END    @YL02021
&END1    SETA  &END1+1                  INCREMENT COUNT        @YL02021
&OP      SETA  &OP-1                    DECREMENT INCREMENT    @YL02021
         AGO   .LOOP                    GENERATE NEXT          @YL02021
.TSTST   ANOP                                                  @YL02021
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END      @YL02021
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT
.NSET1   ANOP                                                  @YL02021
&OP      SETA  &OP-1                    DECREMENT INDEX        @YL02021
&START1  SETA  &START1+1                INCREMENT FIRST COUNT  @YL02021
         AGO   .LOOP                    GO DO NEXT             @YL02021
.LPDONE  ANOP                                                  @YL02021
&ONLY1   SETB  0                        CLEAR INDICATOR        @YL02021
         AGO   .START                   GO TEST FOR MORE SUB-LISTS
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT      @YL02021
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES    @YL02021
&NAME    DS    &COUNT.C                                        @YL02021
.END     MEXIT                                                 @YL02021
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**' @YL02021
         MEXIT                                                 @YL02021
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'          @YL02021
         MEXIT                                                 @YL02021
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN
*****               THE FOLLOWING STATEMENT                *****
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****
.EQU2    ANOP                                                  @YL02021
&EQUCNT  SETA  0                        CLEAR COUNTER          @YL02021
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND        @YL02021
.EQULOP  ANOP                                                  @YL02021
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX        @YL02021
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?       @YL02021
         AGO   .EQULOP                  NO-GET NEXT            @YL02021
.EQUOUT  ANOP                                                  @YL02021
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME         @YL02021
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS     @YL02021
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT        @YL02021
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED    @YL02021
         AGO   .START                   RETURN FOR NEXT        @YL02021
         MEND                                                  @YL02021
         EJECT                                                 @YL02021
         MACRO
         LINEND
.*                            THIS MACRO IS USED ONLY BY THE LINE
.*                                 MACRO TO SET THE NUMBER OF ENTRIES
.*                                 ASSOCIATED WITH EACH LINE.
         GBLA  &NRENTS
         GBLC &NRENTSX
         AIF   (&NRENTS EQ 0).NORENTS   TEST FOR NO COUNT
         ORG   &NRENTSX
         DC    FL1'&NRENTS'
         ORG
&NRENTS  SETA  0
.NORENTS ANOP
B&SYSNDX EQU   *
&NRENTSX SETC  'B&SYSNDX'
         MEND
*
         MACRO                                                 @YL02021
         BIN   ,                                               @YL02021
.*                                 &SYSLIST(&OP,1) - NAME OF LOG ITEM
.*                                      RECORD DSECT           @YL02021
.*                                 $SYSLIST(&OP,2) - NBR OF SPACES
.*                                      TO SKIP ON MULTIPLE    @YL02021
.*                                      PRINT OR NBR OF SPACES @YL02021
.*                                      TO BACK UP FROM COLUMN FOR
.*                                      START OF PRINTING. THE LETTER
.*                                      B PRECEEDS THE NUMBER (B5) IF
.*                                      THE LATTER IS DESIRED. OMISSION
.*                                      OF THIS OPERAND FORCES OPTION 2
.*                                      WITH BACKUP SPACING EQUAL TO
.*                                 THE NUMBER OF BITS IN THE ITEM
.*                                 DEFINITION (VIA MACRO 'DSGEN').
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE
.*                                 TOTAL NUMBER OF BITS TO PRINT.
         GBLA  &INITIAL                                        @YL02021
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                      @YL02021
         GBLC &ITEM(2000)                                      @YL02021
         GBLA &ITEMNBR,&BITS(2000),&SHIFT(2000),&NRENTS        @YL02021
         GBLC  &DSECT                                          @YL02021
         LCLB  &B,&SUB                                         @YL02021
         LCLA  &IBITS,&NDX,&ISHIFT,&K                          @YL02021
         LCLA  &TEMP,&T,&OP                                    @YL02021
         LCLC  &S                                              @YL02021
         AIF   (&DIAGTST EQ 0).NOMSG                           @YL02021
         AIF   (&INITIAL EQ 0).NOMSG                           @YL02021
         AIF   (&DIAGLIN EQ 1).NOMSG                           @YL02021
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'         @YL02021
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****            @YL02021
*        LINE                                                  @YL02021
         LINE                                                  @YL02021
.NOMSG   ANOP                                                  @YL02021
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP         @YL02021
&SUB     SETB  1                                               @YL02021
.LOOP    ANOP                                                  @YL02021
&OP      SETA  &OP+1                                           @YL02021
.LOOP1   ANOP                                                  @YL02021
&NDX     SETA  &NDX+1                                          @YL02021
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND      @YL02021
         AIF   (&NDX LT &ITEMNBR).LOOP1                        @YL02021
         MNOTE '**LOG ITEM NOT DEFINED**'                      @YL02021
         MEXIT                                                 @YL02021
.FOUND   ANOP                                                  @YL02021
&ISHIFT  SETA  &SHIFT(&NDX)                                    @YL02021
&IBITS   SETA  &BITS(&NDX)                                     @YL02021
&T       SETA  &IBITS-1                                        @YL02021
&B       SETB  0                                               @YL02021
         AIF   (&IBITS GT 0 AND &IBITS LT 16).SUB0             @YL02021
         MNOTE '**NO. OF BITS OUTSIDE RANGE OF 1-15**'         @YL02021
         MEXIT                                                 @YL02021
.SUB0    AIF   (&SUB EQ 1).SUBA                                @YL02021
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                    @YL02021
&K       SETA  K'&SYSLIST(2)                                   @YL02021
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                     @YL02021
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                       @YL02021
         AGO   .SUBB                                           @YL02021
.SUBA    ANOP                                                  @YL02021
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                @YL02021
&K       SETA  K'&SYSLIST(&OP,2)                               @YL02021
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                 @YL02021
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                   @YL02021
.SUBB    ANOP                                                  @YL02021
&T       SETA  &S                                              @YL02021
.BACKUP  ANOP                                                  @YL02021
&NRENTS  SETA  &NRENTS+1                                       @YL02021
&TEMP    SETA  &ISHIFT                                         @YL02021
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2                   @YL02021
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'       @YL02021
         AGO   .OUT                                            @YL02021
.BIN2    AIF   ('&SYSLIST(&OP,2)' NE '').BIN3                  @YL02021
&B       SETB  1                                               @YL02021
.BIN3    ANOP                                                  @YL02021
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'           @YL02021
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'    @YL02021
.OUT     ANOP                                                  @YL02021
&NDX     SETA  0                                               @YL02021
         AIF   (&SUB EQ 0).OUTA                                @YL02021
         AIF   (&OP LT N'&SYSLIST).LOOP                        @YL02021
.OUTA    ANOP                                                  @YL02021
         MEND                                                  @YL02021
         EJECT                                                 @YL02021
         MACRO
         HEX
.*                            THIS MACRO FACILITATES GENERATION OF THE
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE
.*                                 CONVERSIONS.
.*                            &SYSLIST(&OP,1) - NAME OF DATA ITEM TO BE
.*                                 CONVERTED
.*                            &SYSLIST(&OP,2) - # OF SPACES TO SKIP ON
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO
.*                                 BACK UP FROM COLUMN FOR START OF
.*                                 PRINTING. THE LETTER B PRECEEDS THE
.*                                 NUMBER (B8) IF THE LATTER OPTION IS
.*                                 DESIRED. OMISSION OF THIS OPERAND
.*                                 FORCES OPTION 2 WITH BACKUP SPACING
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR
.*                                 IMPLICITLY B).
.*                            &SYSLIST(&OP,3) - NUMBER OF BYTES TO
.*                                 PROCESS. THIS NUMBER IS SUFFIXED
.*                                 WITH AN L,R, OR B TO STIPULATE
.*                                 PRINTING OF THE LEFT HALF, RIGHT
.*                                 HALF, OR BOTH HALVES OF THE BYTE
.*                                 RESPECTIVELY. OMISSION OF THIS
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES-
.*                                 SARY. THIS MACRO MUST BE THE FIRST
.*                                 MACRO INSTRUCTION ISSUED FOR THE
.*                                 SUBJECT LINE(S).
         GBLC &ITEM(2000),&DSECT
         GBLA &ITEMNBR,&BITS(2000),&SHIFT(2000),&NRENTS
         GBLA  &INITIAL
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN
         LCLB  &B,&SUB
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP,&OP
         LCLC  &S,&LETTER
         AIF   (&DIAGTST EQ 0).NOMSG
         AIF   (&INITIAL EQ 0).NOMSG
         AIF   (&DIAGLIN EQ 1).NOMSG
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****
*        LINE
         LINE
.NOMSG   ANOP
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP
&SUB     SETB  1
.LOOP    ANOP
&OP      SETA  &OP+1
.LOOP1   ANOP
&NDX     SETA  &NDX+1
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND
         AIF   (&NDX LT &ITEMNBR).LOOP1
         MNOTE '**LOG ITEM NOT DEFINED**'
         MEXIT
.FOUND   ANOP
&ISHIFT  SETA  &SHIFT(&NDX)
&IBITS   SETA  &BITS(&NDX)
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).ALIGN
.ERR     MNOTE '**DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY**'
         MEXIT
.ALIGN   ANOP
&CODE    SETA  1
         AIF   (&SUB EQ 1).SUBA
&K       SETA  K'&SYSLIST(3)
         AGO   .SUBB
.SUBA    ANOP
&K       SETA  K'&SYSLIST(&OP,3)
.SUBB    ANOP
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK
         MNOTE '**BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL**'
         MEXIT
.OK      AIF   (&SUB EQ 1).SUBC
         AIF   ('&SYSLIST(3)' EQ '').USEDEFN
&LETTER  SETC  '&SYSLIST(3)'(&K,1)
&S       SETC  '&SYSLIST(3)'(1,&K-1)
         AGO   .SUBD
.SUBC    ANOP
         AIF   ('&SYSLIST(&OP,3)' EQ '').USEDEFN
&LETTER  SETC  '&SYSLIST(&OP,3)'(&K,1)
&S       SETC  '&SYSLIST(&OP,3)'(1,&K-1)
.SUBD    ANOP
&BYTESP  SETA  &S
         AIF   ('&LETTER' EQ 'B').BOTH
         AIF   ('&LETTER' EQ 'L').LEFT
&CODE    SETA  2
         AGO   .L
.LEFT    ANOP
&CODE    SETA  1
         AGO   .L
.USEDEFN ANOP
&BYTESP  SETA  &IBITS/8
.BOTH    AIF   (&ISHIFT NE 0).ERR
&CODE    SETA  3
&T       SETA  &BYTESP*2-1
&S       SETC  '&T'
.OK2     AIF   (&ISHIFT EQ 0).L
&CODE    SETA  2
.L       ANOP
&B       SETB  1
         AIF   (&SUB EQ 1).SUBE
         AIF   ('&SYSLIST(2)' EQ '').BACKUP
&K       SETA  K'&SYSLIST(2)
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)
         AGO   .SUBF
.SUBE    ANOP
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP
&K       SETA  K'&SYSLIST(&OP,2)
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)
.SUBF    ANOP
.BACKUP  ANOP
&NRENTS  SETA  &NRENTS+1
         AIF   (&BYTESP GT 0 AND &BYTESP LT 16).SUB0
         MNOTE '**NO. OF BYTES OUTSIDE RANGE OF 1-15**'
         MEXIT
.SUB0    AIF   (&SUB EQ 1).SUBG
         DC    AL.12(&SYSLIST(1)-&DSECT),XL.4'A'
         AGO   .SUBH
.SUBG    ANOP
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'A'
.SUBH    ANOP
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'
.OUT     ANOP
&NDX     SETA  0
         AIF   (&SUB EQ 0).OUTA
         AIF   (&OP LT N'&SYSLIST).LOOP
.OUTA    ANOP
         MEND
         MACRO                                                 @YL02021
         LSTART ,                                              @YL02021
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA
.*                                 OF THE TABLE IS TO BEGIN.   @YL02021
         GBLA  &LABELNR                                        @YL02021
         GBLC  &LBL(100)                                       @YL02021
         GBLC &LABELS(2000)                                    @YL02021
         GBLA  &LBLCTR(100)                                    @YL02021
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                      @YL02021
         LCLA  &NDX,&CTR                                       @YL02021
         AIF   (&DIAGTST EQ 0).NODIAG                          @YL02021
         AIF   (&DIAGSET EQ 0).NODIAG                          @YL02021
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'         @YL02021
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****          @YL02021
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'
.NODIAG  ANOP                                                  @YL02021
         LINEND                                                @YL02021
&CTR     SETA  1                                               @YL02021
.LOOP    ANOP                                                  @YL02021
&NDX     SETA  &NDX+1                                          @YL02021
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                   @YL02021
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                @YL02021
&CTR     SETA  &CTR+1                                          @YL02021
         AGO   .LOOPCTL                                        @YL02021
.NOLBL   ANOP                                                  @YL02021
         DC    C'&LABELS(&NDX)'                                @YL02021
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                         @YL02021
         MEND                                                  @YL02021
         EJECT                                                 @YL02021
         MACRO                                                 @YL02021
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C
               &LABEL7,&LABEL8                                 @YL02021
.*                                 THIS MACRO ALLOWS LABELS TO @YL02021
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-
.*                                 TION MARKS. THE COLUMN AND LINE END
.*                                 CONTROLS WILL BE INSERTED BY THE
.*                                 MACRO. OMITTED OPERANDS MEAN NO
.*                                 LABEL REQUIRED FOR RESPECTIVE
.*                                 COLUMN.                     @YL02021
         GBLC &LABELS(2000)                                    @YL02021
         GBLC  &LBL(100)                                       @YL02021
         GBLA  &LBLCTR(100)                                    @YL02021
         GBLA  &LABELNR                                        @YL02021
         GBLA  &NRENTS,&LPTR,&INITIAL                          @YL02021
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                      @YL02021
         LCLC  &MARGIN,&TACK                                   @YL02021
         LCLC  &TEXT                                           @YL02021
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                   @YL02021
         AIF   (&INITIAL EQ 0).DIAGCLR                         @YL02021
         AIF   (&DIAGTST EQ 0).DIAGCLR                         @YL02021
         AIF   (&DIAGLIN EQ 1).DIAGCLR                         @YL02021
         MNOTE '**NO LINE ASSOCIATED WITH PREVIOUS LABEL**'    @YL02021
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****          @YL02021
*        LINE                                                  @YL02021
         LINE                                                  @YL02021
.DIAGCLR ANOP                                                  @YL02021
&DIAGSET SETB  0                                               @YL02021
&DIAGLIN SETB  0                                               @YL02021
&MARGIN  SETC  '*'                                             @YL02021
         AIF   ('&NAME' EQ '').LOOPOUT                         @YL02021
&LPTR    SETA  &LPTR+1                                         @YL02021
&LBL(&LPTR) SETC '&NAME'                                       @YL02021
&LBLCTR(&LPTR) SETA &LABELNR+1                                 @YL02021
.LOOPOUT ANOP                                                  @YL02021
&OP      SETA  &OP+1                                           @YL02021
&K       SETA  K'&SYSLIST(&OP)                                 @YL02021
         AIF (&K GE 2).NORM                                    @YL02021
&K       SETA  2                                               @YL02021
.NORM    ANOP                                                  @YL02021
&START   SETA  2                                               @YL02021
         AIF (&OP LT N'&SYSLIST).NOTLAST                       @YL02021
&MARGIN  SETC  '$'                                             @YL02021
.NOTLAST ANOP                                                  @YL02021
&NRCHAR  SETA  8                                               @YL02021
&TACK    SETC  ''                                              @YL02021
.LOOPIN  ANOP                                                  @YL02021
&REMAIN  SETA  &K-&START                                       @YL02021
         AIF (&REMAIN GE 8).MORE                               @YL02021
&TACK    SETC  '&MARGIN'                                       @YL02021
&NRCHAR  SETA  &REMAIN                                         @YL02021
.MORE    ANOP                                                  @YL02021
&TEXT    SETC  ''                                              @YL02021
         AIF (&REMAIN EQ 0).ENDTEXT                            @YL02021
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                 @YL02021
.ENDTEXT ANOP                                                  @YL02021
&LABELNR SETA  &LABELNR+1                                      @YL02021
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                         @YL02021
&START   SETA  &START+8                                        @YL02021
         AIF ('&TACK' EQ '').LOOPIN                            @YL02021
         AIF ('&TACK' EQ '*').LOOPOUT                          @YL02021
         MEND                                                  @YL02021
         EJECT                                                 @YL02021
         MACRO
&NAME    ROUTINE &LOGITEM,&RNAME
         GBLA  &NRENTS
         GBLC  &DSECT,&CSECT
         GBLA  &INITIAL
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN
         AIF   (&DIAGTST EQ 0).NOMSG
         AIF   (&INITIAL EQ 0).NOMSG
         AIF   (&DIAGLIN EQ 1).NOMSG
         MNOTE '**NO LINE ASSOCIATED WITH THIS ROUTINE**'
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****
*        LINE
         LINE
.NOMSG   ANOP
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'
         DC    AL2(&RNAME-&CSECT)
&NRENTS  SETA  &NRENTS+1
         MEND
         EJECT                                                 @YL02021
         MACRO
&NAME    LINE  &DATA,&LABEL,&SKIP=
.*                            THIS MACRO ESTABLISHES THE MARGINS OR
.*                                 COLUMN SETTINGS FOR EACH LINE. IT
.*                                 GENERATES NECESSARY CARRIAGE CONTROL
.*                                 ENTRIES. LASTLY IT DETERMINES THE
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH
.*                                 THE PREVIOUS LINE AND STORES THAT #
.*                                 INTO THE APPROPRIATE BYTE.
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN
.*                                 DATA.
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE
.*                                 DATA COLUMN STARTING CHARACTERS.
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL
.*                                 STARTING CHARACTERS.
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE
.*                                 TO BEGIN NEXT PRINTED LINE.
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN
.*                                 NECESSARY. OMISSION OF ITEMS MEANS
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS
.*                                 SETTINGS. A LINE MACRO IS REQUIRED
.*                                 FOR EACH PRINTED LINE. IF NO SETTING
.*                                 CHANGES ARE REQUIRED ALL OPERANDS
.*                                 ARE OMITTED IN WHICH CASE ONLY THE
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE
.*                                 IS COMPUTED. THIS MACRO MUST BE THE
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR
.*                                 THE SUBJECT LINE
         GBLA  &DB,&DT,&LB,&LT,&NRENTS
         GBLA  &LASTCC,&INITIAL
         GBLC  &NRENTSX
         GBLC  &CARRCON
         GBLB  &TEST
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN
         LCLA  &S
         AIF   (&INITIAL EQ 0 OR &DIAGTST EQ 0).DIAGSET
         AIF   (&DIAGSET EQ 0).DIAGSET
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'
.DIAGSET ANOP
&DIAGSET SETB  1
&DIAGLIN SETB  1
&NAME    DS    0C
         AIF   (&INITIAL EQ 0).FIRSTLN
         LINEND
         AGO   .NTFIRST
.FIRSTLN ANOP
&NRENTSX SETC  'N&SYSNDX'
&INITIAL SETA  1
N&SYSNDX EQU   *
.NTFIRST ANOP
         DC    AL1(0)
         AIF   ('&DATA(1)' EQ '').CKDTABS
         AIF   (&DATA(1) EQ &DB).CKDTABS
&DB      SETA  &DATA(1)
         AGO   .AA
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA
         AIF   (&DATA(2) EQ &DT).NCDATA
         AGO   .CC
.AA      AIF   ('&DATA(2)' EQ '').BB
         AIF   (&DATA(2) EQ &DT).BB
.CC      ANOP
&DT      SETA  &DATA(2)
.BB      DC    XL2'FFFE'
         DC    FL1'&DB'
         DC    FL1'&DT'
&NRENTS  SETA  &NRENTS+1
.NCDATA  ANOP
         AIF   ('&LABEL(1)' EQ '').CKLTABS
         AIF   (&LABEL(1) EQ &LB).CKLTABS
&LB      SETA  &LABEL(1)
         AGO   .AAA
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL
         AIF   (&LABEL(2) EQ &LT).NCLABEL
         AGO   .CCC
.AAA     AIF   ('&LABEL(2)' EQ '').BBB
         AIF   (&LABEL(2) EQ &LT).BBB
.CCC     ANOP
&LT      SETA  &LABEL(2)
.BBB     DC    XL2'FFFF'
         DC    FL1'&LB'
         DC    FL1'&LT'
&NRENTS  SETA  &NRENTS+1
.NCLABEL ANOP
         AIF   ('&SKIP' NE '').CONT
         AIF   (&TEST EQ 0).NOCHANG
         AGO   .DEFALTA
.CONT    ANOP
         AIF   (&TEST EQ 0).AB
         AIF   ('&SKIP' EQ 'E').AB
&S       SETA  &SKIP
.DEFAULT ANOP
         AIF   (&SKIP EQ &LASTCC).DEFALTA
         ORG   &CARRCON+3
         DC    AL.3(0),AL.2(&S),AL.3(1)
         ORG
&LASTCC  SETA  &S
.DEFALTA ANOP
&TEST    SETB  0
         AGO   .DD
.AB      AIF   ('&SKIP' NE 'E').ABB
A&SYSNDX DC    X'FFFB8B00'              EJECT
         AGO   .ABC
.ABB     AIF   (&SKIP EQ &LASTCC).NOCHANG
A&SYSNDX DC    XL2'FFFB'
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)
&LASTCC  SETA  &SKIP
&TEST    SETB  1
.ABC     ANOP
&CARRCON SETC  'A&SYSNDX'
&NRENTS  SETA  &NRENTS+1
.DD      ANOP
.NOCHANG ANOP
         MEND
         EJECT
         GBLC  &DSECT,&CSECT
&DSECT   SETC  'INDEPEND'
&CSECT   SETC  'IFCEF165'
IFCEF165 CSECT
         USING *,R9
INDEPEND DSECT
         DS    0F
         DSGEN (XKEY,16),(XSWS8,9),(XSWS9,1),(XSWS10,1),(XSWS11,1),    C
               (XSWS12,1),(XSWS13,1),(XSWS14,1),(XSWS15,1)
         DSGEN (XDUM1,32)
         DSGEN (XDATE,32)
         DSGEN (XTIME,32)
         DSGEN (XDUM2,8),(XSER,24)
         DSGEN (XCPUMOD,16),(XDUM3,16)
         DSGEN (XPGMID,64)
         DSGEN (XJOBID,64)
         ORG   XJOBID                                          @YL02021
         DSGEN (MCETEF,1,0,7),(MCEMEF,1,0,7),(MCEIEF,1,0,7),   @YL02021X
               (MCESEF,1,0,7),(PDAR0,1,0,7),(PDAR1,1,0,7),     @YL02021X
               (PDAR2,1,0,7),(WDSIZE,8)                        @YL02021
         DSGEN (XMCKPSW,64)
M165     DS    214F
         DSGEN (A1LB,32)
         DSGEN (A1LC,32)
         DSGEN (A1LD,32)
         DSGEN (A1LE,32)
         DSGEN (A1LF,32)
         DSGEN (A1LG,32)
         DSGEN (A1LH,32)
         DSGEN (A1LJ,32)
         DSGEN (A1LK,32)
         DSGEN (A1LL,32)
         DSGEN (A2LB,32)
         DSGEN (A2LC,32)
         DSGEN (A2LD,32)
         DSGEN (A2LE,32)
         DSGEN (A2LF,32)
         DSGEN (A2LG,32)
         DSGEN (A2LH,32)
         DSGEN (A2LJ,32)
         DSGEN (A2LK,32)
         DSGEN (A2LL,32)
         DSGEN (A3LB,32)
         DSGEN (A3LC,32)
         DSGEN (A3LD,32)
         DSGEN (A3LE,32)
         DSGEN (A3LF,32)
         DSGEN (A3LG,32)
         DSGEN (A3LH,32)
         DSGEN (A3LJ,32)
         DSGEN (A3LK,32)
         DSGEN (A3LL,32)
         DSGEN (A4LB,32)
         DSGEN (A4LC,32)
         DSGEN (A4LD,32)
         DSGEN (A4LE,32)
         DSGEN (A4LF,32)
         DSGEN (A4LG,32)
         DSGEN (A4LH,32)
         DSGEN (A4LJ,32)
         DSGEN (A4LK,32)
         DSGEN (A4LL,32)
         DSGEN (A5LB,32)
         DSGEN (A5LC,32)
         DSGEN (A5LD,32)
         DSGEN (A5LE,32)
         DSGEN (A5LF,32)
         DSGEN (A5LG,32)
         DSGEN (A5LH,32)
         DSGEN (A5LJ,32)
         DSGEN (A5LK,32)
         DSGEN (A5LL,32)
         DSGEN (A6LB,32)
         DSGEN (A6LC,32)
         DSGEN (A6LD,32)
         DSGEN (A6LE,32)
         DSGEN (A6LF,32)
         DSGEN (A6LG,32)
         DSGEN (A6LH,32)
         DSGEN (A6LJ,32)
         DSGEN (A6LK,32)
         DSGEN (A6LL,32)
         DSGEN (A7LB,32)
         DSGEN (A7LC,32)
         DSGEN (A7LD,32)
         DSGEN (A7LE,32)
         DSGEN (A7LF,32)
         DSGEN (A7LG,32)
         DSGEN (A7LH,32)
         DSGEN (A7LJ,32)
         DSGEN (A7LK,32)
         DSGEN (A7LL,32)
         DSGEN (B0LB,32)
         DSGEN (B0LC,32)
         DSGEN (B0LD,32)
         DSGEN (B0LE,32)
         DSGEN (B0LF,32)
         DSGEN (B0LG,32)
         DSGEN (B0LH,32)
         DSGEN (B0LJ,32)
         DSGEN (B0LK,32)
         DSGEN (B0LL,32)
         DSGEN (B1LB,32)
         DSGEN (B1LC,32)
         DSGEN (B1LD,32)
         DSGEN (B1LE,32)
         DSGEN (B1LF,32)
         DSGEN (B1LG,32)
         DSGEN (B1LH,32)
         DSGEN (B1LJ,32)
         DSGEN (B1LK,32)
         DSGEN (B1LL,32)
         DSGEN (B2LB,32)
         DSGEN (B2LC,32)
         DSGEN (B2LD,32)
         DSGEN (B2LE,32)
         DSGEN (B2LF,32)
         DSGEN (B2LG,32)
         DSGEN (B2LH,32)
         DSGEN (B2LJ,32)
         DSGEN (B2LK,32)
         DSGEN (B2LL,32)
         DSGEN (B3LB,32)
         DSGEN (B3LC,32)
         DSGEN (B3LD,32)
         DSGEN (B3LE,32)
         DSGEN (B3LF,32)
         DSGEN (B3LG,32)
         DSGEN (B3LH,32)
         DSGEN (B3LJ,32)
         DSGEN (B3LK,32)
         DSGEN (B3LL,32)
         DSGEN (B4LB,32)
         DSGEN (B4LC,32)
         DSGEN (B4LD,32)
         DSGEN (B4LE,32)
         DSGEN (B4LF,32)
         DSGEN (B4LG,32)
         DSGEN (B4LH,32)
         DSGEN (B4LJ,32)
         DSGEN (B4LK,32)
         DSGEN (B4LL,32)
         DSGEN (B5LB,32)
         DSGEN (B5LC,32)
         DSGEN (B5LD,32)
         DSGEN (B5LE,32)
         DSGEN (B5LF,32)
         DSGEN (B5LG,32)
         DSGEN (B5LH,32)
         DSGEN (B5LJ,32)
         DSGEN (B5LK,32)
         DSGEN (B5LL,32)
         DSGEN (B6LB,32)
         DSGEN (B6LC,32)
         DSGEN (B6LD,32)
         DSGEN (B6LE,32)
         DSGEN (B6LF,32)
         DSGEN (B6LG,32)
         DSGEN (B6LH,32)
         DSGEN (B6LJ,32)
         DSGEN (B6LK,32)
         DSGEN (B6LL,32)
         DSGEN (C0LB,32)
         DSGEN (C0LC,32)
         DSGEN (C0LD,32)
         DSGEN (C0LE,32)
         DSGEN (C0LF,32)
         DSGEN (C0LG,32)
         DSGEN (C0LH,32)
         DSGEN (C0LJ,32)
         DSGEN (C0LK,32)
         DSGEN (C0LL,32)
         DSGEN (C1LB,32)
         DSGEN (C1LC,32)
         DSGEN (C1LD,32)
         DSGEN (C1LE,32)
         DSGEN (C1LF,32)
         DSGEN (C1LG,32)
         DSGEN (C1LH,32)
         DSGEN (C1LJ,32)
         DSGEN (C1LK,32)
         DSGEN (C1LL,32)
         DSGEN (C2LB,32)
         DSGEN (C2LC,32)
         DSGEN (C2LD,32)
         DSGEN (C2LE,32)
         DSGEN (C2LF,32)
         DSGEN (C2LG,32)
         DSGEN (C2LH,32)
         DSGEN (C2LJ,32)
         DSGEN (C2LK,32)
         DSGEN (C2LL,32)
         DSGEN (C3LB,32)
         DSGEN (C3LC,32)
         DSGEN (C3LD,32)
         DSGEN (C3LE,32)
         DSGEN (C3LF,32)
         DSGEN (C3LG,32)
         DSGEN (C3LH,32)
         DSGEN (C3LJ,32)
         DSGEN (C3LK,32)
         DSGEN (C3LL,32)
         DSGEN (C4LB,32)
         DSGEN (C4LC,32)
         DSGEN (C4LD,32)
         DSGEN (C4LE,32)
         DSGEN (C4LF,32)
         DSGEN (C4LG,32)
         DSGEN (C4LH,32)
         DSGEN (C4LJ,32)
         DSGEN (C4LK,32)
         DSGEN (C4LL,32)
         DSGEN (C5LB,32)
         DSGEN (C5LC,32)
         DSGEN (C5LD,32)
         DSGEN (C5LE,32)
         DSGEN (C5LF,32)
         DSGEN (C5LG,32)
         DSGEN (C5LH,32)
         DSGEN (C5LJ,32)
         DSGEN (C5LK,32)
         DSGEN (C5LL,32)
         DSGEN (C6LB,32)
         DSGEN (C6LC,32)
         DSGEN (C6LD,32)
         DSGEN (C6LE,32)
         DSGEN (C6LF,32)
         DSGEN (C6LG,32)
         DSGEN (C6LH,32)
         DSGEN (C6LJ,32)
         DSGEN (C6LK,32)
         DSGEN (C6LL,32)
         DSGEN (DARLNGTH,16),(,48)
         DSGEN (SYSSTAT,1,0,7)
         DSGEN (AREADT,1,0,15)
         DSGEN (ERRTYPE,1,0,7)
         DSGEN (RMSACTN,1,0,7)
         DSGEN (RMSINFO,1,0,7)
         DSGEN (WAITSUFF,8),(,8),(MCHFSAR,32),(,32)
         DSGEN (TRNSMOD,32,0,7)
         DSGEN (MCHPDR,1,0,7,0,7)
         DSGEN (MCHFSAV,32),(MCHFSEAV,32),(MCHPDARI,32),(MCHTCBCU,32)
LOGEND   EQU   *-2
IFCEF165 CSECT
***********************************************************************
*
***********************************************************************
ENTRYPTR DC    A(FORMAT1)
TABLNAME DC    CL8'IFCEF165'
REG9     DS    F
SAVE     DS    F
***
*              ***     SPECIAL ROUTINES AREA     ***
*
***********************************************************************
         USING INDEPEND,R2                                     @YL02021
ISITVS2  STM   R5,R8,XSAVE             SAVE REGS               @YL02021
         CLI   XKEY,H13                IS IT VS2?              @YL02021
         BE    ISVS2                   YES                     @YL02021
FIN      SR    R15,R15                 ELIM. LABEL             @YL02021
         LM    R5,R8,XSAVE                                     @YL02021
         BR    R14                                             @YL02021
ISVS2    SR    R5,R5                                           @YL02021
         L     R5,LINA                                         @YL02021
         ST    R5,REG9                                         @YL02021
         L     R6,LABA                                         @YL02021
         ST    R6,SAVE                                         @YL02021
         B     FIN                                             @YL02021
NOTVS2   STM   R5,R8,XSAVE                                     @YL02021
         L     R5,LINC                                         @YL02021
         ST    R5,REG9                                         @YL02021
         B     FIN                                             @YL02021
LINA     DC    A(LINE1-4)                                      @YL02021
LABA     DC    A(LAB1-1)                                       @YL02021
LINC     DC    A(VS2DUMP-4)                                    @YL02021
ROUT0    DS    0C
         STM   R3,R4,SAVER34            SAVE PRINT BFR PTR- LOG START
         BR    R14                      RETURN
ROUT1    DS    0C
         STM   R3,R8,XSAVE              SAVE ROUTINE REGISTERS
         L     R3,SAVER3                LOAD ADR OF PRINT BFR
         L     R7,L0(R4)                LOAD LOG DATA
         LA    R3,L3(R3)                INCREMENT PRINT BFR POINTER
         LA    R8,L4                    LOAD BYTE COUNT
ROUT1A   DS    0C
         LA    R5,L6                    LOAD BIT COUNT
ROUT1B   DS    0C
         SR    R6,R6                    CLEAR REGISTER R6
         MVI   L0(R3),CB                ASSUME 0 - SET BFR TO BLANK
         SLDL  R6,L1                    SHIFT DATA BIT INTO R6
         LTR   R6,R6                    TEST VALUE IN R6
         BZ    ROUT1C                   BRANCH IF R6 ZERO
         MVI   L0(R3),CS                MOVE SPLAT TO PRINT BFR
ROUT1C   DS    0C
         LA    R3,L3(R3)                INCREMENT PRINT BFR POINTER
         BCT   R5,ROUT1B                BRANCH ON BIT COUNT
         SLL   R7,L2                    BYPASS BITS 6 AND 7
         BCT   R8,ROUT1A                BRANCH ON BYTE COUNT
         LM    R3,R8,XSAVE              RESTORE REGISTERS
SKIPPER  BR    R14                      RETURN
         USING INDEPEND,R2
***********************************************************************
*        THIS ROUTINE CHECKS FOR 168-MP SYSTEM
***********************************************************************
MPBIT    EQU   X'04'
TESTMOD  STM   R6,R7,XSAVE              SAVE REGS
         CLC   XCPUMOD(L2),C165         Q/ IS THIS A 165
         BE    UPEXIT                   YES- DO C0 FOR UP
         BR    R14                      YES-DO C0 FOR MP
UPEXIT   LA    R6,UPLINE-L4             SET
         LA    R7,UPLAB-L1                 TO
         ST    R6,REG9                       DO
         ST    R7,SAVE                        UP PANEL
         LM    R6,R7,XSAVE              RESTORE REGS
         BR    R14                      RETURN
***********************************************************************
*        THIS ROUTINE BRANCHES TO M/F FRAME C1                        *
***********************************************************************
C1BR     STM   R6,R7,XSAVE              SAVE REGS
         LA    R6,C1LINE-L4             SET
         LA    R7,C1LAB-L1                 TO
         ST    R6,REG9                       BRANCH
         ST    R7,SAVE                        TO C1
         LM    R6,R7,XSAVE              RESTORE REGS
         SR    R15,R15                  CLEAR R15
         BR    14                       RETURN
C165     DC    X'0165'
         SPACE 3                                               @XA20540
***********************************************************************
**            THIS ROUTINE CHECKS FOR 370-EXTENSION AND VM ACTIVE    **
**      AND DECIDES WHETHER TO PRINT CONTROL REG 6 OR NOT            **
***********************************************************************
CKEXTVMA ST    R5,XSAVE            SAVE WORK REG               @XA20540
         TM    1(R4),X'30'         ARE 370-EXT OR VMA BITS ON? @XA20540
         BNZR  R14                 YES...CARRY ON              @XA20540
         SR    R5,R5               NO...CLEAR REG 5            @XA20540
         LA    R5,NOEV-4           GET @ NEXT LIST             @XA20540
         ST    R5,REG9             SKIP LIST FOR CONTROL REG 6 @XA20540
         L     R5,MFC5ADR          GET @ NEXT LABEL            @XA20540
         ST    R5,SAVE             SKIP REG. 6 LABELS          @XA20540
         SR    R15,R15             DON'T PRINT THIS LINE       @XA20540
         L     R5,XSAVE            RESTORE WORK REG            @XA20540
         BR    R14                 RETURN                      @XA20540
MFC5ADR  DC    A(MFC5-1)                                       @XA20540
         SPACE 3                                               @XA20540
***********************************************************************
**      THIS ROUTINE CHOOSES BETWEEN TWO LABELS FOR CONTROL REG      **
**    0, BIT 3...EITHER '3' OR 'LAP' DEPENDENT ON THE SETTING OF THE **
**     370-EXT AND VMA BITS                                          **
***********************************************************************
CKLAP1   TM    1(R4),X'30'         ARE 370-EXT OR VMA BITS ON? @XA20540
         BZR   R14                 NO...RETURN                 @XA20540
CKLAPX   SR    R15,R15             DON'T PRINT THIS LABEL      @XA20540
         BR    R14                 RETURN                      @XA20540
CKLAP2   TM    1(R4),X'30'         ARE 370-EXT OR VMA BITS ON? @XA20540
         BZ    CKLAPX              NO...WRONG LABEL            @XA20540
         BR    R14                 YES...RETURN                @XA20540
         SPACE 3                                               @XA20540
************************************************************** @XA21819
* THIS ROUTINE WILL SET THE PROPER DUMP SIZE TO DUMP THE WHOLE @XA21819
* RECORD BASED ON THE SIZE WHICH PRECEDES THE START OF THE     @XA21819
* MCH RECORD.                                                  @XA21819
************************************************************** @XA21819
DUMPSET  STM   R4,R8,XSAVE             SAVE WORK REGS          @XA21819
         S     R4,TWO                  BACK UP PTR TO REC LEN  @XA21819
         MVC   WORKSIZE(2),0(R4)       GET RECORD LENGTH       @XA21819
         SR    R5,R5                   ZERO REG                @XA21819
         LH    R5,WORKSIZE             R5 = RECORD LENGTH      @XA21819
         SH    R5,HTWO                 GET ACTUAL RECD LENGTH  @XA21819
         BC    3,DUMPSET1              NO, LENGTH > ZERO       @XA21819
         MVC   DUMPSIZE(2),DUMPAMT     YES, USE DEFAULT SIZE   @XA21819
         B     DUMPDONE                EXIT                    @XA21819
DUMPSET1 STH   R5,WORKSIZE             STORE FOR MOVE TO AVOID @XA21819
         MVC   DUMPSIZE(2),WORKSIZE    BOUNDARY PROBLEMS       @XA21819
DUMPDONE SR    R15,R15                 DO NOT PRINT            @XA21819
         LM    R4,R8,XSAVE             RESTORE WORK REGS       @XA21819
         BR    R14                     EXIT                    @XA21819
TWO      DC    F'00000002'                                     @XA21819
HTWO     DC    H'0002'                                         @XA21819
WORKSIZE DC    H'0000'                 WORK AREA               @XA21819
DUMPAMT  DC    H'1754'                 DUMPSIZE IF LEN IS BAD  @XA21819
************************************************************** @XA21819
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
CC1      EQU   1
CC2      EQU   2
CC4      EQU   4
CC7      EQU   7
CC8      EQU   8
L0       EQU   0
L1       EQU   1
L2       EQU   2
L3       EQU   3
L4       EQU   4
L5       EQU   5
L6       EQU   6
L7       EQU   7
L8       EQU   8
L9       EQU   9
L10      EQU   10
H13      EQU   X'13'                                           @YL02021
CB       EQU   C' '
CS       EQU   C'*'
XWORK    DS    D
XSAVE    DS    6F
SAVER34  DS    2F
SAVER3   EQU   SAVER34
SAVER4   EQU   SAVER34+4
***********************************************************************
*
FORMAT1  DC    F'0'
FORMAT2  DC    F'0'
LABELPTR DC    A(LABLAREA)
DISP     DC    FL2'0'
***********************************************************************
MFC0     LINE  (1,1),(1,1),SKIP=3
       LABEL  ' '
         LINE  (1,1),(19,1),SKIP=1
         ROUTINE  C0LB,ROUT0
         ROUTINE  XCPUMOD,TESTMOD
       LABEL  'M/F FRAME C0 MP CONTROL REGS'
         LINE  ,(12,1)
       LABEL  'PREFIX HOLD REGISTER             MP OSC ST X INTRLEAVE RX
               S MP'
         LINE  ,(3,1)
       LABEL  'P1  8  9 10 11 12 13 14 15 P2 16 17 18 19 LTH ON DTCON SX
                    4  EN P  V'
         LINE  ,(1,1)
         ROUTINE  C0LB,ROUT1
       LABEL  'LB'
         LINE  ,(3,1)
       LABEL  'CONF 0/FL REG 0  / FLIG ADDR REG 1 /CONF 4/FL REG 8  / FC
               LTG ADDR REG 9'
         LINE  ,(4,1)
       LABEL  '0  1  2  3  L  R  0  1  2  3  L  R  0  1  2  3  L  R  0 C
                1  2  3  L  R'
         LINE  ,(1,1)
         ROUTINE  C0LC,ROUT1
       LABEL  'LC'
         LINE  ,(3,1)
       LABEL  'CONF 1/FL REG 2  / FLTG ADDR REG 3 /CONF 5/FL REG 10 / FC
               LTG ADDR REG 11'
         LINE  ,(4,1)
       LABEL  '0  1  2  3  L  R  0  1  2  3  L  R  0  1  2  3  L  R  0 C
                1  2  3  L  R'
         LINE  ,(1,1)
         ROUTINE  C0LD,ROUT1
       LABEL  'LD'
         LINE  ,(3,1)
       LABEL  'CONF 2/FL REG 4  / FLTG ADDR REG 5 /CONF 6/FL REG 12 / FC
               LTG ADDR REG 13'
         LINE  ,(4,1)
       LABEL  '0  1  2  3  L  R  0  1  2  3  L  R  0  1  2  3  L  R  0 C
                1  2  3  L  R'
         LINE  ,(1,1)
         ROUTINE  C0LE,ROUT1
       LABEL  'LE'
         LINE  ,(3,1)
       LABEL  'CONF 3/FL REG 6  / FLTG ADDR REG 7 /CONF 7/FL REG 14 / FC
               LTG ADDR REG 15'
         LINE  ,(4,1)
       LABEL  '0  1  2  3  L  R  0  1  2  3  L  R  0  1  2  3  L  R  0 C
                1  2  3  L  R'
         LINE  ,(1,1)
         ROUTINE    C0LF,ROUT1
       LABEL  'LF'
         LINE  ,(3,1)
       LABEL  'LOC CHAN INT REG                    STOR SZE LOCAL'
         LINE  ,(4,1)
       LABEL  '0  1  2  3  4                       0  1  2  3  4'
         LINE  ,(1,1)
         ROUTINE    C0LG,ROUT1
       LABEL  'LG'
         LINE  ,(3,1)
       LABEL  'REM CHAN INT REG           CPU      STOR SZE REMTE      C
                CONTSTDUAL'
         LINE  ,(4,1)
       LABEL  '0  1  2  3  4             ADR       0  1  2  3          C
                ACTLTHENT'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C0LH,ROUT1
       LABEL  'LH'
         LINE  ,(1,1),SKIP=1
       LABEL  'LJ'
         LINE  ,(3,1)
       LABEL  'STOR PROT CHECKS                 PRFX'
         LINE  ,(3,1)
       LABEL  '   IK    OK  R  C                CHK'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C0LK,ROUT1
       LABEL  'LK'
         LINE  ,(1,1),SKIP=3
       LABEL  'LL'
         LINE  ,(19,1),SKIP=1
         ROUTINE  XCPUMOD,C1BR
       LABEL  ' '
UPLINE   LINE  (1,1),(19,1),SKIP=1
UPLAB  LABEL  'M/F FRAME C0 STORAGE CONFIGURATION'
         LINE  ,(57,1)
       LABEL  'INTRLEAVE'
         LINE  ,(58,1)
       LABEL  'S     4'
         LINE  ,(1,1)
         ROUTINE  C0LB,ROUT1
       LABEL  'LB'
         LINE  ,(6,1)
       LABEL  'CONFIG REG 0'
         LINE  ,(4,1)
       LABEL  '0  1  2  3  E'
         LINE  ,(1,1)
         ROUTINE  C0LC,ROUT1
       LABEL  'LC'
         LINE  ,(6,1)
       LABEL  'CONFIG REG 1'
         LINE  ,(4,1)
       LABEL  '0  1  2  3  E'
         LINE  ,(1,1)
         ROUTINE  C0LD,ROUT1
       LABEL  'LD'
         LINE  ,(6,1)
       LABEL  'CONFIG REG 2'
         LINE  ,(4,1)
       LABEL  '0  1  2  3  E'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C0LE,ROUT1
       LABEL  'LE'
         LINE  ,(1,1),SKIP=1
       LABEL  'LF'
         LINE  ,(42,1)
       LABEL  'STOR SIZE'
         LINE  ,(43,1)
       LABEL  '   2  3'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C0LG,ROUT1
       LABEL  'LG'
         LINE  ,(1,1),SKIP=3
       LABEL  'LH'
         LINE  ,(1,1),SKIP=1
       LABEL  'LJ'
         LINE  ,(5,1)
       LABEL  'STOR PROT CHECKS'
         LINE  ,(3,1)
       LABEL  'AC IK IB OK       R/C'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C0LK,ROUT1
       LABEL  'LK'
         LINE  ,(1,1),SKIP=3
       LABEL  'LL'
         LINE  ,(19,1),SKIP=1
       LABEL  ' '
C1LINE   LINE  ,(19,1),SKIP=1
C1LAB  LABEL  'M/F FRAME C1 SEGMENT TABLE ORIGIN STACK'
         LINE  (1,1),(26,1),SKIP=1
MFC1   LABEL  'STOK BFR REG                       CR 0 PSW'
         LINE  ,(7,1)
       LABEL  '8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  8 C
               11  P'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C1LB,ROUT1
       LABEL  'LB'
         LINE  ,(1,1),SKIP=1
       LABEL  'LC'
         LINE  ,(6,1)
       LABEL  '      PSW/CR          CMP  BLK                XLAT CTL XC
               L'
         LINE  ,(6,1)
       LABEL  '                      FUL  MOD                   0  1  BX
               SY'
         LINE  ,(1,1)
         ROUTINE  C1LD,ROUT1
       LABEL  'LD'
         LINE  ,(5,1)
       LABEL  'STK RP ST P=5        DLAT  INV DAT DLAT        REQUESTS'
         LINE  ,(6,1)
       LABEL  'ON LH VD TGR      RSSRCH DLAT ENT 0  1          XLT K'
         LINE  ,(1,1)
         ROUTINE  C1LE,ROUT1
       LABEL  'LE'
         LINE  ,(52,1)
       LABEL  'XLATOR INGATES'
         LINE  ,(53,1)
       LABEL  'SAL STE PTE'
         LINE  ,(1,1)
         ROUTINE  C1LF,ROUT1
       LABEL  'LF'
         LINE  ,(54,1)
       LABEL  'TAR INGATES'
         LINE  ,(54,1)
       LABEL  'LAR TL RA'
         LINE  ,(1,1)
         ROUTINE  C1LG,ROUT1
       LABEL  'LG'
         LINE  ,(53,1)
       LABEL  'DLAT CTRLS'
         LINE  ,(53,1)
       LABEL  'SSK  W  R'
         LINE  ,(1,1)
         ROUTINE  C1LH,ROUT1
       LABEL  'LH'
         LINE  ,(53,1)
       LABEL  'EXCEPTIONS'
         LINE  ,(53,1)
       LABEL  'SEG PG SPL'
         LINE  ,(1,1)
         ROUTINE  C1LJ,ROUT1
       LABEL  'LJ'
         LINE  ,(24,1)
       LABEL  'STOK CHECKS               TIR TAL HS CKS'
         LINE  ,(23,1)
       LABEL  'BFR    SP  ID              PTY  8 16 24'
         LINE  ,(1,1)
         ROUTINE  C1LK,ROUT1
       LABEL  'LK'
         LINE  ,(24,1)
       LABEL  'DLAT CHECKS                   TAL FS CKS'
         LINE  ,(24,1)
       LABEL  'MC  C IK OK  RA                8 16 24'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C1LL,ROUT1
       LABEL  'LL'
         LINE  ,(19,1),SKIP=1
MFC3   LABEL  'M/F FRAME C3 CONTROL REGISTERS'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 0 BITS 0-15'
         LINE  ,(13,1)
         ROUTINE   A4LJ,CKLAP1                                 @XA20540
       LABEL  'P BM  M  2  3  4  5  6  7  P PG SZ/PE/SG SZ  13 14 15'
         LINE  ,                                             @XA20540
         ROUTINE   A4LJ,CKLAP2                                 @XA20540
         LABEL 'P BM  M  2 LAP 4  5  6  7  P PG SZ/PE/SG SZ  13 14 15'
         LINE  ,(1,1)
         ROUTINE  C3LB,ROUT1
       LABEL  'LB'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 0 BITS 16-31'
         LINE  ,(13,1)
       LABEL  'P 16 17 18 19 CC CT 22 23  P IT IK ES  27 28 29 30 31'
         LINE  ,(1,1)
         ROUTINE  C3LC,ROUT1
       LABEL  'LC'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 1 BITS 0-15'
         LINE  ,(13,1)
       LABEL  'P  0  SGMNT TABLE LGTH  7  P SGMT TAB ORG AD BITS 0-7'
         LINE  ,(1,1)
         ROUTINE  C3LD,ROUT1
       LABEL  'LD'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 1 BITS 16-31'
         LINE  ,(13,1)
       LABEL  'P  SGMNT TABLE ORG ADDR  BITS 8-17  26 27 28 29 30 31'
         LINE  ,(1,1)
         ROUTINE  C3LE,ROUT1
       LABEL  'LE'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 2 BITS 0-15'
         LINE  ,(13,1)
       LABEL  'P  0  1  2  CHANNEL  6  7  P   CHANNEL    12 13 14 15'
         LINE  ,(1,1)
         ROUTINE  C3LF,ROUT1
       LABEL  'LF'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 2 BITS 16-31'
         LINE  ,(13,1)
       LABEL  'P  16 17 18 19 20 21 22 23 P  24 25 26 27 28 29 30 31'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C3LG,ROUT1
       LABEL  'LG'
         LINE  ,(1,1),SKIP=3
       LABEL  'LH'
         LINE  ,(1,1),SKIP=3
       LABEL  'LJ'
         LINE  ,(1,1),SKIP=3
       LABEL  'LK'
         LINE  ,(1,1),SKIP=3
       LABEL  'LL'
         LINE  ,(19,1),SKIP=1                                  @XA20540
         ROUTINE A4LJ,CKEXTVMA                                 @XA20540
MFC4     LABEL 'M/F FRAME C4 CONTROL REGISTERS'                @XA20540
         LINE  ,(1,1),SKIP=3                                   @XA20540
         LABEL 'LB'                                            @XA20540
         LINE  ,,SKIP=3                                        @XA20540
         LABEL 'LC'                                            @XA20540
         LINE  ,,SKIP=3                                        @XA20540
         LABEL 'LD'                                            @XA20540
         LINE  ,,SKIP=1                                        @XA20540
         LABEL 'LE'                                            @XA20540
         LINE  ,(24,1)                                         @XA20540
         LABEL 'CONTROL REGISTER 6 BITS 0-15'                  @XA20540
         LINE  ,(13,1)                                         @XA20540
         LABEL '                            VM POINTER LIST ADDRESS'
         LINE  ,(13,1)                                         @XA20540
         LABEL 'P  0  1  2  3  4  5  6  7  P  8  9 10 11 12 13 14 15'
         LINE  ,(1,1)                                          @XA20540
         ROUTINE C4LF,ROUT1                                    @XA20540
         LABEL 'LF'                                            @XA20540
         LINE  ,(24,1)                                         @XA20540
         LABEL 'CONTROL REGISTER 6 BITS 16-31'                 @XA20540
         LINE  ,(13,1)                                         @XA20540
         LABEL '            VM POINTER LIST ADDRESS'           @XA20540
         LINE  ,(13,1)                                         @XA20540
         LABEL 'P 16 17 18 19 20 21 22 23  P 24 25 26 27 28 29 30 31'
         LINE  ,(1,1),SKIP=3                                   @XA20540
         ROUTINE C4LG,ROUT1                                    @XA20540
         LABEL 'LG'                                            @XA20540
         LINE  ,(1,1),SKIP=3                                   @XA20540
         LABEL 'LH'                                            @XA20540
         LINE  ,(1,1),SKIP=3                                   @XA20540
         LABEL 'LJ'                                            @XA20540
         LINE  ,,SKIP=3                                        @XA20540
         LABEL 'LK'                                            @XA20540
         LINE  ,,SKIP=3                                        @XA20540
         LABEL 'LL'                                            @XA20540
NOEV     LINE  ,(19,1),SKIP=1                                  @XA20540
MFC5   LABEL  'M/F FRAME C5 CONTROL REGISTERS'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 8 BITS 0-15'
         LINE  ,(13,1)
       LABEL  'P  0  1  2  3  4  5  6  7  P  8  9  10 11 12 13 14 15'
         LINE  ,(1,1)
         ROUTINE  C5LB,ROUT1
       LABEL  'LB'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 8 BITS 16-31'
         LINE  ,(13,1)
       LABEL  'P 16 17 18 19 20 21 22 23  P 24 25 26 27 28 29 30 31'
         LINE  ,(1,1)
         ROUTINE  C5LC,ROUT1
       LABEL  'LC'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 9 BITS 0-15'
         LINE  ,(13,1)
       LABEL  'P SB FTH SA GA 4  5  6  7  P  8  9  10 11 12 13 14 15'
         LINE  ,(1,1)
         ROUTINE  C5LD,ROUT1
       LABEL  'LD'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 9 BITS 16-31'
         LINE  ,(13,1)
       LABEL  'P  0  1  2  3  4  5  6  7  P  8  9  10 11 12 13 14 15'
         LINE  ,(1,1)
         ROUTINE  C5LE,ROUT1
       LABEL  'LE'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 10 BITS 0-15'
         LINE  ,(13,1)
       LABEL  'P  0  1  2  3  4  5  6  7  P  8  9 10 11 12 13 14 15'
         LINE  ,(1,1)
         ROUTINE  C5LF,ROUT1
       LABEL  'LF'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 10 BITS 16-31'
         LINE  ,(13,1)
       LABEL  'P 16 17 18 19 20 21 22 23  P 24 25 26 27 28 29 30 31'
         LINE  ,(1,1)
         ROUTINE  C5LG,ROUT1
       LABEL  'LG'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 11 BITS 0-15'
         LINE  ,(13,1)
       LABEL  'P  0  1  2  3  4  5  6  7  P  8  9 10 11 12 13 14 15'
         LINE  ,(1,1)
         ROUTINE  C5LH,ROUT1
       LABEL  'LH'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 11 BITS 16-31'
         LINE  ,(13,1)
       LABEL  'P 16 17 18 19 20 21 22 23  P 24 25 26 27 28 29 30 31'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C5LJ,ROUT1
       LABEL  'LJ'
         LINE  ,(1,1),SKIP=3
       LABEL  'LK'
         LINE  ,(1,1),SKIP=3
       LABEL  'LL'
         LINE  ,(19,1),SKIP=1
MFC6   LABEL  'M/F FRAME C6 CONTROL REGISTERS'
         LINE  ,(1,1),SKIP=3
       LABEL  'LB'
         LINE  ,(1,1),SKIP=3
       LABEL  'LC'
         LINE  ,(1,1),SKIP=3
       LABEL  'LD'
         LINE  ,(1,1),SKIP=1
       LABEL  'LE'
         LINE  ,(24,1),SKIP=1
       LABEL  'CONTROL REGISTER 14 BITS 0-15'
         LINE  ,(13,1),
       LABEL  'P HS SM ELM 3 RMR 5 DRM 7  P AM AFL 10 11 12 13 14 15'
         LINE  ,(1,1)
         ROUTINE  C6LF,ROUT1
       LABEL  'LF'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 14 BITS 16-31'
         LINE  ,(13,1)
       LABEL  'P  16 17 18 19 20 21 22 23 P  24 25 26 27 28 29 30 31'
         LINE  ,(1,1)
         ROUTINE  C6LG,ROUT1
       LABEL  'LG'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 15 BITS 0-15'
         LINE  ,(13,1)
       LABEL  'P  0  1  2  3  4  5  6  7  P  8  9 10 11 12 13 14 15'
         LINE  ,(1,1)
         ROUTINE  C6LH,ROUT1
       LABEL  'LH'
         LINE  ,(24,1)
       LABEL  'CONTROL REGISTER 15 BITS 16-31'
         LINE  ,(13,1)
       LABEL  'P 16 17 18 19 20 21 22 23  P 24 25 26 27 28 29 30 31'
         LINE  ,(1,1),SKIP=3
         ROUTINE  C6LJ,ROUT1
       LABEL  'LJ'
         LINE  ,(1,1),SKIP=3
       LABEL  'LK'
         LINE  ,(1,1),SKIP=3
       LABEL  'LL'
         LINE  ,,SKIP=1                                        @YL02021
         ROUTINE   XKEY,ISITVS2                                @YL02021
         LABEL ''                                              @YL02021
         LINE  ,,SKIP=1                                        @YL02021
         ROUTINE   B6LG,SKIPPER                                @YL02021
         LABEL ''                                              @YL02021
         LINE  ,(19,1),SKIP=2
         LABEL 'MACHINE CHECK STATUS FIELD'
         LINE  (41,),(1,),SKIP=1
         HEX   DARLNGTH,0,2B
         LABEL 'MCSTATD FIELD LENGTH'
         LINE  ,(5,)
         LABEL '--- SYSTEM STATUS ---'
         LINE  (35,35),(1,40)
         BIN   SYSSTAT0
         BIN   SYSSTAT1
         LABEL 'HARDWARE RECOVERY','SOFTWARE RECOVERY'
         LINE
         BIN   SYSSTAT2
         BIN   SYSSTAT3
         LABEL 'TASK ABORTED','TASK SET NON-DISPATCHABLE'
         LINE
         BIN   SYSSTAT4
         BIN   SYSSTAT5
         LABEL 'OPERATING SYSTEM TERMINATION','QUIET MODE IN EFFECT'
         LINE  ,(5,)
         LABEL '--- DAMAGE AREA ---'
         LINE  ,(1,40)
         BIN   AREADT0
         BIN   AREADT1
         LABEL 'MAIN STORAGE','BUFFER'
         LINE
         BIN   AREADT2
         BIN   AREADT3
         LABEL 'CONTROL STORAGE','INTERVAL TIMER'
         LINE
         BIN   AREADT4
         BIN   AREADT5
         LABEL 'PROCESSOR','CHANNEL ERROR'
         LINE
         BIN   AREADT6
         BIN   AREADT7
         LABEL 'TOD CLOCK','SYSTEM DAMAGE'
         LINE  ,(5,)
         LABEL '--- ERROR TYPE ---'
         LINE  ,(1,40)
         BIN   ERRTYPE0
         BIN   ERRTYPE1
         LABEL 'INTERMITTENT','SOLID'
         LINE
         BIN   ERRTYPE2
         BIN   ERRTYPE3
         LABEL 'DATA','RESERVED'
         LINE
         BIN   ERRTYPE4
         BIN   ERRTYPE5
         LABEL 'RESERVED','PROTECT'
         LINE  ,(5,)
         LABEL '--- RMS ACTION DATA ---'
         LINE  ,(1,40)
         BIN   RMSACTN0
         BIN   RMSACTN1
         LABEL 'LOOP TIME OUT','REPAIR'
         LINE
         BIN   RMSACTN2
         BIN   RMSACTN3
         LABEL 'STORAGE RECONFIGURE','BUFFER RECONFIGURE'
         LINE  ,(5,)
         LABEL '--- RMS INFORMATION STATUS ---'
         LINE  ,(1,40)
         BIN   RMSINFO0
         BIN   RMSINFO1
         LABEL 'RESERVED','INVALID MCI CODE'
         LINE
         BIN   RMSINFO2
         BIN   RMSINFO3
         LABEL 'INVALID FAILING STORAGE ADDRESS','PROGRAM CHECK IN MCH'
         LINE  (15,),(5,),SKIP=1
         LABEL '--- HISTORY OF TRANSIENT MODULES ---'
         LINE  (1,15)
         HEX   TRNSMOD0,1,4B
         HEX   TRNSMOD1,1,4B
         HEX   TRNSMOD2,1,4B
         HEX   TRNSMOD3,1,4B
         LABEL ''
         LINE  ,,SKIP=2
         HEX   TRNSMOD4,1,4B
         HEX   TRNSMOD5,1,4B
         HEX   TRNSMOD6,1,4B
         HEX   TRNSMOD7,1,4B
         LABEL ''
         LINE  ,(5,),SKIP=1
         LABEL '--- PDAR ACTION ---'
         LINE  (35,35),(1,40)
         BIN   MCHPDR00
         BIN   MCHPDR01
         LABEL 'TERMINATION OF CURRENT TASK','RETRY POSSIBLE'
         LINE
         BIN   MCHPDR02
         BIN   MCHPDR03
         LABEL 'BYPASS(AFFECTED TASK) POSSIBLE','REPAIR UNSUCCESSFUL'
         LINE
         BIN   MCHPDR04
         BIN   MCHPDR05
         LABEL 'INDETERMINATE INSTRUCTION COUNTER','RESERVED'
         LINE  ,(5,)
         LABEL '--- FAILURE TYPE ---'
         LINE ,(1,40)
         BIN   MCHPDR10
         BIN   MCHPDR11
         LABEL 'SOLID STORAGE DATA ERROR','INTERMITTENT STOR. DATA ERR'
         LINE
         BIN   MCHPDR12
         BIN   MCHPDR13
         LABEL 'SOLID SPF KEY ERROR','INTERMITTENT SPF KEY ERROR'
         LINE  ,(5,)
         LABEL '--- OPERATING SYSTEM STATUS ---'
         LINE ,(1,40)
         BIN   MCHPDR20
         BIN   MCHPDR21
         LABEL 'WAIT PSEUDO TASK','PAGE SUPERVISOR TASK'
         LINE
         BIN   MCHPDR22
         BIN   MCHPDR23
         LABEL 'MASTER SCHEDULER TASK','SYSTEM TASK'
         LINE
         BIN   MCHPDR24
         BIN   MCHPDR25
         LABEL 'PROBLEM PROGRAM TASK','CURRENT PSW DISABLED FOR I/O'
         LINE  ,(5,)
         LABEL '--- LOCATION OF FAILURE ---'
         LINE ,(1,40)
         BIN   MCHPDR30
         BIN   MCHPDR31
         LABEL 'NUCLEUS','SQA AREA'
         LINE
         BIN   MCHPDR32
         BIN   MCHPDR33
         LABEL 'LSQA AREA','PQA'
         LINE
         BIN   MCHPDR34
         BIN   MCHPDR35
         LABEL 'PAGEABLE AREA','FIXED PAGE AREA'
         LINE
         BIN   MCHPDR36
         BIN   MCHPDR37
         LABEL 'V=R ADDRESS AREA','CRITICAL AREA'
         LINE  ,(5,)
         LABEL '--- REQUESTED OPERATOR AWARENESS ---'
         LINE ,(1,40)
         BIN   MCHPDR50
         BIN   MCHPDR51
         LABEL 'SUPERVISOR DAMAGE MESSAGE','TASK ABNORM TERMINATION MSGC
               '
         LINE
         BIN   MCHPDR52
         BIN   MCHPDR53
         LABEL 'DAMAGED PAGE NOW UNAVAILABLE MSG','DAMAGED PAGE NOW DELC
               ETED MSG'
         LINE
         BIN   MCHPDR54
         BIN   MCHPDR55
         LABEL 'TASK NON-DISPATCHABLE MESSAGE','SOFTWARE RECOVERY MESSAC
               GE'
         LINE  ,(5,)
         LABEL '--- FOOTPRINTS ---'
         LINE ,(1,40)
         BIN   MCHPDR60
         BIN   MCHPDR61
         LABEL 'CHANGE BIT ACTIVE','KEY IN EXTERNAL PAGE TABLE'
         LINE
         BIN   MCHPDR62
         BIN   MCHPDR63
         LABEL 'PAGE RECURSION','PAGE FIX ACTIVE IN LOW END'
         LINE
         BIN   MCHPDR64
         BIN   MCHPDR65
         LABEL 'TRANSLATE ERROR','NO PAGE EXISTS'
         LINE
         BIN   MCHPDR66
         BIN   MCHPDR67
         LABEL 'RELOCATE OFF','LOW END INTERFACE ACTIVE'
         LINE  ,(5,)
         LABEL '--- FOOTPRINTS - INTERFACES ---'
         LINE ,(1,40)
         BIN   MCHPDR70
         BIN   MCHPDR71
         LABEL 'ABTERM INTERFACE ACTIVE','TRANSLATE INTERFACE ACTIVE'
         LINE
         BIN   MCHPDR72
         BIN   MCHPDR73
         LABEL 'FIND PAGE INTERFACE ACTIVE','PAGE DEQUEUE INTERFACE ACTC
               .'
         LINE
         BIN   MCHPDR74
         BIN   MCHPDR75
         LABEL 'PAGE ENQUEUE INTERFACE ACTIVE',                        C
               'STAT FUNCTION INTERFACE ACT.'
         LINE  ,,SKIP=2
         BIN   MCHPDR76
         BIN   MCHPDR77
         LABEL 'V=R RELEASE INTERFACE ACTIVE','POST INTERFACE ACTIVE'
         LINE  (45,1),(1,),SKIP=1
         HEX   MCHFSAR,0,4B
         LABEL 'FAILING STORAGE REAL ADDRESS'
         LINE
         HEX   MCHFSAV,0,4B
         LABEL 'BEGINNING FAILING STORAGE VIRTUAL ADDRESS'
         LINE
         HEX   MCHFSEAV,0,4B
         LABEL 'ENDING FAILING STORAGE VIRTUAL ADDRESS'
         LINE
         HEX   MCHPDARI,0,4B
         LABEL 'INSTRUCTION ADDRESS AT FAILURE'
         LINE  ,,SKIP=2
         HEX   MCHTCBCU,0,4B
         LABEL 'CURRENT TCB POINTER'
         LINE  ,,SKIP=1
         LABEL ''
         LINE  ,                                               @YL02021
         ROUTINE   XKEY,NOTVS2                                 @YL02021
         LABEL ''                                              @YL02021
LINE1    LINE  ,(52,),SKIP=2                                   @YL02021
         ROUTINE   XKEY,SKIPPER                                @YL02021
LAB1     LABEL 'MACHINE-CHECK-ERROR INDICATORS'                @YL02021
         LINE  (5,35),(1,31)                                   @YL02021
         ROUTINE   XKEY,SKIPPER                                @YL02021
         LABEL 'TERMINAL ERROR FLAGS','HARD-MACHINE ERROR FLAGS',      X
               'INTERMEDIATE ERROR','SOFT-MACHINE-ERROR FLAGS' @YL02021
         LINE  (26,31),(1,31),SKIP=1                           @YL02021
         BIN   (MCETEF0),(MCEMEF0),(MCEIEF0),(MCESEF0)         @YL02021
         LABEL 'RESERVED','ASSUMED HD ERR FLG','RESERVED',     @YL02021X
               'ASSUMED SOFT ERROR '                           @YL02021
         LINE  ,                                               @YL02021
         BIN   (MCETEF1),(MCEMEF1),(MCEIEF1),(MCESEF1)         @YL02021
         LABEL 'RESERVED','RESERVED','RESERVED','RESERVED'     @YL02021
         LINE  ,                                               @YL02021
         BIN   (MCETEF2),(MCEMEF2),(MCEIEF2),(MCESEF2)         @YL02021
         LABEL 'THRESHOLD REACHED','RESERVED','RESERVED','RESERVED'
         LINE  ,                                               @YL02021
         BIN   (MCETEF3),(MCEMEF3),(MCEIEF3),(MCESEF3)         @YL02021
         LABEL 'SECONDARY ERROR FLAG','SYSTEM DAMAGE FLAG',    @XA20540*
               'RESERVED','RESERVED'                           @XA20540
         LINE  ,                                               @YL02021
         BIN   (MCETEF4),(MCEMEF4),(MCEIEF4),(MCESEF4)         @YL02021
         LABEL 'CHECK STOP FLAG','REG/PSW INVALID FLAG',       @YL02021X
               'TOD CLOCK ERROR FLAG','EXT DAMAGE FLAG'        @YL02021
         LINE  ,                                               @YL02021
         BIN   (MCETEF5),(MCEMEF5),(MCEIEF5),(MCESEF5)         @YL02021
         LABEL 'POWER WARNING FLAG','HARD STOR. ERR. FLAG',    @YL02021X
               'CLOCK COMP ERR. FLAG','ECC CORR. STOR. ERR. FLG'
         LINE  ,                                               @YL02021
         BIN   (MCETEF6),(MCEMEF6),(MCEIEF6),(MCESEF6)         @YL02021
         LABEL 'RESERVED','HARD PROTECT. KEY ERR.',            @XA20540*
               'CPU TIMER ERR. FLAG','HIR CORR PROC. ERR FG'   @YL02021
         LINE  ,SKIP=2                                         @YL02021
         BIN   (MCETEF7),(MCEMEF7),(MCEIEF7),(MCESEF7)         @YL02021
         LABEL 'INVALID LOGOUT FLAG','INST. PROC. DAMAGE FLAG',        X
               'INTERVAL TIMER ERR. FLAG','BUFFER ERR. FLAG'   @YL02021
         LINE  ,(30),SKIP=2                                    @YL02021
         ROUTINE   XKEY,SKIPPER                                @YL02021
         LABEL 'PROGRAM DAMAGE ASSESSMENT AND REPAIR'          @YL02021
         LINE  (30,32),(1,35),SKIP=2                           @YL02021
         ROUTINE   XKEY,SKIPPER                                @YL02021
         LABEL 'PDAR DATA','STOR. RECONFIG. STATUS',           @YL02021X
               'STORAGE RECONFIG. STATUS'                      @YL02021
         LINE  (26,32),(1,32),SKIP=1                           @YL02021
         BIN   (PDAR00),(PDAR10),(PDAR20)                      @YL02021
         LABEL 'RESERVED','RESERVED','FR OFF LN/SCHED OFF LN'  @YL02021
         LINE  ,                                               @YL02021
         BIN   (PDAR01),(PDAR11),(PDAR21)                      @YL02021
         LABEL 'RESERVED','RESERVED','INTERCEPT'               @YL02021
         LINE  ,                                               @YL02021
         BIN   (PDAR02),(PDAR12),(PDAR22)                      @YL02021
         LABEL 'RESERVED','RESERVED','PERM. ERR. IN FRAME'     @YL02021
         LINE  ,                                               @YL02021
         BIN   (PDAR03),(PDAR13),(PDAR23)                      @YL02021
         LABEL 'STORAGE RECONFIG.','RESERVED',                 @YL02021X
               'FRAME-PERM. RES. SYS.'                         @YL02021
         LINE  ,                                               @YL02021
         BIN   (PDAR04),(PDAR14),(PDAR24)                      @YL02021
         LABEL 'STOR. REFIG. STST AVAIL.','RESERVED','FRAME USE SQA'
         LINE  ,                                               @YL02021
         BIN   (PDAR05),(PDAR15),(PDAR25)                      @YL02021
         LABEL 'STOR REFIG. NOT ATTEMP.','RESERVED','FRAME USE LSQA'
         LINE  ,                                               @YL02021
         BIN   (PDAR06),(PDAR16),(PDAR26)                      @YL02021
         LABEL 'RESERVED','STOR ERR SET IN FRAME','FRAME-FIXED PG DATA'
         LINE  ,,SKIP=2                                        @YL02021
         BIN   (PDAR07),(PDAR17),(PDAR27)                      @YL02021
         LABEL 'RESERVED','FRAME-CHG IND. ON','FRAME-IS V=R OR SCHED.'
         LINE  (25,30),(1,),SKIP=2                             @YL02021
         HEX   WDSIZE                                          @YL02021
         LABEL 'PHYSICAL WORD LENGTH'                          @YL02021
         LINE  ,,SKIP=1                                        @YL02021
         LABEL ''                                              @YL02021
VS2DUMP  LINE  ,                                               @XA21819
         ROUTINE XKEY,DUMPSET                                  @XA21819
         LABEL ''                                              @XA21819
         DC    XL1'FF'                                         @XA21819
DUMPSIZE DC    AL2(0)                                          @XA21819
         DC    AL2(48)                                         @YL02021
         DC    AL2(232)                                        @YL02021
***********************************************************************
*              *****     LABEL AREA     *****
***********************************************************************
LABLAREA EQU   *
         LSTART
         END

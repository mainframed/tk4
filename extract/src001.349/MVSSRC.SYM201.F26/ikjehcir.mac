         TITLE '*********** IKJEHCIR:  CATALOG INFORMATION ROUTINE *****
               ******** '
IKJEHCIR CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEHCIR  74.346'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
*                                                                  0070
*        /************************************************************/
*        /*                                                          */
*        /* SET UP WORK AREA FOR CLP AND FPL.THEN CHECK ENTRY CODE   */
*        /* FROM CIR PARAMETER LIST                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0071
*        CIRPTR = REG1;                                    /*@YL026YB*/
         LR    CIRPTR,REG1                                         0071
*        CTGPLPTR = ADDR(CPLSTOR);                         /*@YL026YB*/
         LA    CTGPLPTR,CPLSTOR                                    0072
*        CTGFLPTR = ADDR(FPLSTOR);                         /*@YL026YB*/
         LA    @14,FPLSTOR                                         0073
         ST    @14,CTGFLPTR                                        0073
*        IF CIROPT = HEX01                                         0074
*          THEN                                                    0074
         CLI   CIROPT(CIRPTR),X'01'                                0074
         BNE   @RF00074                                            0074
*            CALL ENTRY01;                                 /*@YL026YB*/
         BAL   @14,ENTRY01                                         0075
*          ELSE                                                    0076
*            IF CIROPT = HEX02                                     0076
*              THEN                                                0076
         B     @RC00074                                            0076
@RF00074 CLI   CIROPT(CIRPTR),X'02'                                0076
         BNE   @RF00076                                            0076
*                CALL ENTRY02;                             /*@YL026YB*/
         BAL   @14,ENTRY02                                         0077
*              ELSE                                                0078
*                IF CIROPT = HEX04                                 0078
*                  THEN                                            0078
         B     @RC00076                                            0078
@RF00076 CLI   CIROPT(CIRPTR),X'04'                                0078
         BNE   @RF00078                                            0078
*                    CALL ENTRY04;                         /*@YL026YB*/
         BAL   @14,ENTRY04                                         0079
*                  ELSE                                            0080
*                    CALL ENTRY06;                         /*@YL026YB*/
*                                                                  0080
         B     @RC00078                                            0080
@RF00078 BAL   @14,ENTRY06                                         0080
*/********************************************************************/
*/*                                                                  */
*/* ENTRY01 IS THE PROCEDURE TO RETURN AN 8 BYTE QUALIFIER           */
*/* WITH ENTRY TYPE. 44 BYTE NAMES ARE OBTAINED BY CALLING           */
*/* SVC 26 FOR A GENERIC LOCATE.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0081
*                                                                  0081
*ENTRY01: PROCEDURE;                                       /*@YL026YB*/
         B     @PB00002                                            0081
ENTRY01  STM   @14,@12,@SA00002                                    0081
*        COUNT = 0;                                        /*@YL026YB*/
         SLR   @14,@14                                             0082
         STH   @14,COUNT                                           0082
*        CNN = 0;                                                  0083
         STH   @14,CNN                                             0083
*        CNT = 0;                                                  0084
         STH   @14,CNT                                             0084
*        SWITCH = 0;                                               0085
*                                                                  0085
         STH   @14,SWITCH                                          0085
*        /************************************************************/
*        /*                                                          */
*        /* DO A GETMAIN TO OBTAIN A TEMPORARY WORKAREA FOR DATA     */
*        /* RETURNED FROM SVC 26.SET REG 0 TO CONTAIN LENGTH OF      */
*        /* WORKAREA AND SUBPOOL NUMBER.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0086
*        RFY (REG0,REG1) RSTD;                                     0086
*        REG0 = MAX1;                                              0087
         LH    REG0,@CH00208                                       0087
*        REG0 = REG0 × SUBPOOL1;                                   0088
         O     REG0,@CF00176                                       0088
*        CORESIZE = REG0;                                          0089
         ST    REG0,CORESIZE                                       0089
*        GEN (GETMAIN R,LV=(0));                                   0090
         GETMAIN R,LV=(0)
*        DPTR = REG1;                                              0091
*                                                                  0091
         ST    REG1,DPTR                                           0091
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THE DSNAME FROM USER TO FIND ITS LENGTH.           */
*        /* INITIALIZE PARAMETER LIST FOR CPL.USE MOVE CHARACTER     */
*        /* LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0092
*        DO COUNT = LENGTH(USENAME) TO 1 BY -1             /*@YL026YB*/
*           WHILE(USENAME(COUNT) = BLANK);                 /*@YL026YB*/
         LA    @14,44                                              0092
         STH   @14,COUNT                                           0092
@DL00092 L     @10,CIRSRCH(,CIRPTR)                                0092
         ALR   @10,@14                                             0092
         AL    @10,@CF00251                                        0092
         CLI   USENAME(@10),X'40'                                  0092
         BNE   @DC00092                                            0092
*        END;                                              /*@YL026YB*/
         BCTR  @14,0                                               0093
         STH   @14,COUNT                                           0093
         LTR   @14,@14                                             0093
         BP    @DL00092                                            0093
@DC00092 DS    0H                                                  0094
*        GELENGTH = COUNT + 1;    /*MAKE ROOM FOR PERIOD TO   ZA00645*/
         LA    @14,1                                               0094
         AH    @14,COUNT                                           0094
         STC   @14,GELENGTH                                        0094
*                       /*LIMIT SEARCH TO CORRECT INDEX LEVEL ZA00645*/
*        USENAME(GELENGTH) = PERIOD;     /*INSERT PERIOD      ZA00645*/
         L     @10,CIRSRCH(,CIRPTR)                                0095
         ALR   @14,@10                                             0095
         AL    @14,@CF00251                                        0095
         MVI   USENAME(@14),X'4B'                                  0095
*        GNAME = USENAME(1:GELENGTH);                      /*@YL026YB*/
         MVI   GNAME+1,C' '                                        0096
         MVC   GNAME+2(42),GNAME+1                                 0096
         SLR   @14,@14                                             0096
         IC    @14,GELENGTH                                        0096
         BCTR  @14,0                                               0096
         EX    @14,@SM00307                                        0096
*        CPLSTOR = ''B;                                    /*@YL026YB*/
         XC    CPLSTOR(32),CPLSTOR                                 0097
*        CALL MOVEINST(QUALDATA);                          /*@YL026YB*/
         L     @14,DPTR                                            0098
         LA    @14,QUALDATA(,@14)                                  0098
         ST    @14,@AL00001                                        0098
         LA    @01,@AL00001                                        0098
         BAL   @14,MOVEINST                                        0098
*        QUALN = LENGTH(QUALAREA);                         /*@YL026YB*/
*                                                                  0099
         L     @14,DPTR                                            0099
         MVC   QUALN(2,@14),@CH00208                               0099
*        /************************************************************/
*        /*                                                          */
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0100
*        CTGNAME = ON;                                     /*@YL026YB*/
*        CTGCNAME = ON;                                    /*@YL026YB*/
         OI    CTGNAME(CTGPLPTR),B'00000110'                       0101
*        CTGSUPLT = ON;                                    /*@YL026YB*/
         OI    CTGSUPLT(CTGPLPTR),B'00010000'                      0102
*        CTGGENLD = ON;                                    /*@YL026YB*/
         OI    CTGGENLD(CTGPLPTR),B'00000001'                      0103
*        CTGAM0 = ON;                                      /*@YL026YB*/
         OI    CTGAM0(CTGPLPTR),B'00000001'                        0104
*        CTGENT = ADDR(GENAME);                            /*@YL026YB*/
         LA    @10,GENAME                                          0105
         ST    @10,CTGENT(,CTGPLPTR)                               0105
*        CTGCAT = CIRVOL;                                  /*@YL026YB*/
         MVC   CTGCAT(4,CTGPLPTR),CIRVOL(CIRPTR)                   0106
*        CTGPSWD = CIRPSWD;                                /*@YL026YB*/
         MVC   CTGPSWD(4,CTGPLPTR),CIRPSWD(CIRPTR)                 0107
*        CTGWKA = DPTR;                                    /*@YL026YB*/
*                                                                  0108
         ST    @14,CTGWKA(,CTGPLPTR)                               0108
*        /************************************************************/
*        /*                                                          */
*        /* CALL SVC 26 FOR GENERIC LOCATE. ON RETURN CHECK RETURN   */
*        /* CODE                                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0109
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/
         LR    REG1,CTGPLPTR                                       0109
*        GENERATE (CATLG (1));                             /*@YL026YB*/
         CATLG (1)
*        RETNCODE = REG15;                                 /*@YL026YB*/
*                                                                  0111
         ST    REG15,RETNCODE                                      0111
*        /************************************************************/
*        /*                                                          */
*        /* IF RETURN CODE IS ZERO, THIS ROUTINE TAKES 44 BYTE NAMES */
*        /* RETURNED AND COMPARES THEM WITH THE NAME FROM THE USER.  */
*        /* THEN RETURNS THE 8 BYTE QUALIFIERS NEEDED TO COMPLETE    */
*        /* THE NAME                                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0112
*        IF  RETNCODE = 0                                          0112
*          THEN                                                    0112
         L     @14,RETNCODE                                        0112
         LTR   @14,@14                                             0112
         BNZ   @RF00112                                            0112
*            DO;                                           /*@YL026YB*/
*              IF AREALN < RTNQLN                          /*@YL026YB*/
*                THEN                                      /*@YL026YB*/
         L     @14,CIRWA(,CIRPTR)                                  0114
         LH    @14,AREALN(,@14)                                    0114
         L     @10,DPTR                                            0114
         CH    @14,RTNQLN(,@10)                                    0114
         BNL   @RF00114                                            0114
*                  DO;                                     /*@YL026YB*/
*                    CIRLOCRC = 44;                        /*@YL026YB*/
         MVI   CIRLOCRC(CIRPTR),X'2C'                              0116
*                    RETNCODE = 4;                         /*@YL026YB*/
         MVC   RETNCODE(4),@CF00190                                0117
*                    GOTO FRECR01;                         /*@YL026YB*/
         B     FRECR01                                             0118
*                  END;                                    /*@YL026YB*/
*            CNT = COUNT + 2;                              /*@YL026YB*/
@RF00114 LA    @14,2                                               0120
         AH    @14,COUNT                                           0120
         STH   @14,CNT                                             0120
*            DATALN = RTNQLN;                              /*@YL026YB*/
         L     @14,CIRWA(,CIRPTR)                                  0121
         L     @10,DPTR                                            0121
         LH    @03,RTNQLN(,@10)                                    0121
         STH   @03,DATALN(,@14)                                    0121
*            FIRST = 1;                                    /*@YL026YB*/
         LA    @14,1                                               0122
         STH   @14,FIRST                                           0122
*            LAST = LENGTH(TYPE01);                        /*@YL026YB*/
         MVC   LAST(2),@CH00279                                    0123
*            QULTYPE = '07'X;                              /*@YL026YB*/
         MVI   QULTYPE,X'07'                                       0124
*            QULPTR = ADDR(QUALDATA);                      /*@YL026YB*/
         LA    @10,QUALDATA(,@10)                                  0125
         ST    @10,QULPTR                                          0125
*            CONTROL = (RTNQLN - 4) / 45;                  /*@YL026YB*/
         LR    @04,@03                                             0126
         SH    @04,@CH00190                                        0126
         SRDA  @04,32                                              0126
         D     @04,@CF00206                                        0126
         STH   @05,CONTROL                                         0126
*            DO  I = 1 TO CONTROL;                         /*@YL026YB*/
         B     @DE00127                                            0127
@DL00127 DS    0H                                                  0128
*            QULBUF = QULPTR->DATABLK;                     /*@YL026YB*/
         L     @14,QULPTR                                          0128
         MVC   QULBUF(45),DATABLK(@14)                             0128
*            IF QUALIFY(CNT) = BLANK                       /*@YL026YB*/
*               THEN                                       /*@YL026YB*/
         LH    @14,CNT                                             0129
         LA    @10,QUALIFY-1(@14)                                  0129
         CLI   0(@10),X'40'                                        0129
         BNE   @RF00129                                            0129
*                  DO;                                     /*@YL026YB*/
*                   RETNCODE = 12;                         /*@YL026YB*/
         MVC   RETNCODE(4),@CF00123                                0131
*                   GOTO FRECR01;                          /*@YL026YB*/
         B     FRECR01                                             0132
*                  END;                                    /*@YL026YB*/
*            DO  J = CNT TO 44 WHILE (QUALIFY(J) ^= BLANK);/*@YL026YB*/
@RF00129 LH    @14,CNT                                             0134
         B     @DE00134                                            0134
@DL00134 LA    @10,QUALIFY-1(@14)                                  0134
         CLI   0(@10),X'40'                                        0134
         BE    @DC00134                                            0134
*               /* MOVE ONLY NAMES LOCATED WITH THEIR NEXT    ZA00646*/
*               /* LEVEL BEING ALSO THEIR LAST, IE. NOT INDEX ZA00646*/
*               IF QUALIFY(J) = PERIOD THEN                /* ZA00646*/
         LA    @10,QUALIFY-1(@14)                                  0135
         CLI   0(@10),X'4B'                                        0135
         BE    @RT00135                                            0135
*                 GOTO BYPASS;                             /* ZA00646*/
*               ELSE;                                      /* ZA00646*/
*            END;                                          /*@YL026YB*/
         AH    @14,@CH00051                                        0138
@DE00134 ST    @14,J                                               0138
         CH    @14,@CH00183                                        0138
         BNH   @DL00134                                            0138
@DC00134 DS    0H                                                  0139
*            CNN = J - 1;                                  /*@YL026YB*/
         L     @14,J                                               0139
         BCTR  @14,0                                               0139
         STH   @14,CNN                                             0139
*            QULNAME = QUALIFY(CNT:CNN);                   /*@YL026YB*/
         MVI   QULNAME+1,C' '                                      0140
         MVC   QULNAME+2(6),QULNAME+1                              0140
         LH    @10,CNT                                             0140
         SLR   @14,@10                                             0140
         LA    @03,QUALIFY-1(@10)                                  0140
         EX    @14,@SM00311                                        0140
*            DATAREA(FIRST:LAST) = TYPE01;                 /*@YL026YB*/
*                                                                  0141
         LH    @14,FIRST                                           0141
         L     @10,CIRWA(,CIRPTR)                                  0141
         ALR   @10,@14                                             0141
         LH    @03,LAST                                            0141
         LCR   @14,@14                                             0141
         ALR   @14,@03                                             0141
         EX    @14,@SM00313                                        0141
*            /********************************************************/
*            /*                                                      */
*            /* ADJUST SUBSTRING VARIABLES AND POINT TO NEXT 44 BYTE */
*            /* NAME                                                 */
*            /*                                                      */
*            /********************************************************/
*                                                                  0142
*            FIRST = LAST + 1;                             /*@YL026YB*/
         AH    @03,@CH00051                                        0142
         STH   @03,FIRST                                           0142
*            LAST = FIRST + LENGTH(QULNAME);               /*@YL026YB*/
         AH    @03,@CH00055                                        0143
         STH   @03,LAST                                            0143
*BYPASS:     QULPTR = QULPTR + 45;                         /* ZA00646*/
BYPASS   LA    @14,45                                              0144
         AL    @14,QULPTR                                          0144
         ST    @14,QULPTR                                          0144
*            END;                                          /*@YL026YB*/
*                                                                  0145
         LA    @14,1                                               0145
         AL    @14,I                                               0145
@DE00127 ST    @14,I                                               0145
         CH    @14,CONTROL                                         0145
         BNH   @DL00127                                            0145
*            /********************************************************/
*            /*                                                      */
*            /*   PUT HEX FF AS THE LAST BYTE IN USER WORK AREA TO   */
*            /*   TO INDICATE END OF DATA                            */
*            /*                                                      */
*            /********************************************************/
*                                                                  0146
*            ENDBYTE = FIRST;                              /*@YL026YB*/
         LH    ENDBYTE,FIRST                                       0146
*            DATAREA(ENDBYTE) = FOXES;                     /*@YL026YB*/
         L     @14,CIRWA(,CIRPTR)                                  0147
         ALR   @14,ENDBYTE                                         0147
         MVI   DATAREA-1(@14),X'FF'                                0147
*            RETNCODE = 0;                                 /*@YL026YB*/
         SLR   @14,@14                                             0148
         ST    @14,RETNCODE                                        0148
*            GOTO FRECR01;                                 /*@YL026YB*/
         B     FRECR01                                             0149
*            END;                                          /*@YL026YB*/
*                                                                  0150
*        /************************************************************/
*        /*                                                          */
*        /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN TABLE*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0151
*        ELSE                                                      0151
*            DO;                                           /*@YL026YB*/
@RF00112 DS    0H                                                  0152
*              DO I =1 TO 8;                               /*@YL026YB*/
         LA    @14,1                                               0152
         ST    @14,I                                               0152
@DL00152 DS    0H                                                  0153
*              IF RTNTABLE(I) = RETNCODE                           0153
*                THEN                                              0153
         SLA   @14,2                                               0153
         L     @14,RTNTABLE-4(@14)                                 0153
         C     @14,RETNCODE                                        0153
         BNE   @RF00153                                            0153
*                  DO;                                     /*@YL026YB*/
*                    SWITCH = 1;                           /*@YL026YB*/
         MVC   SWITCH(2),@CH00051                                  0155
*                    CIRLOCRC = REG15;                     /*@YL026YB*/
         STC   REG15,CIRLOCRC(,CIRPTR)                             0156
*                    RETNCODE = 4;                         /*@YL026YB*/
         MVC   RETNCODE(4),@CF00190                                0157
*                    GOTO FRECR01;                         /*@YL026YB*/
         B     FRECR01                                             0158
*                  END;                                    /*@YL026YB*/
*                  ELSE;                                   /*@YL026YB*/
@RF00153 DS    0H                                                  0161
*              END;                                        /*@YL026YB*/
*                                                                  0161
         LA    @14,1                                               0161
         AL    @14,I                                               0161
         ST    @14,I                                               0161
         CH    @14,@CH00055                                        0161
         BNH   @DL00152                                            0161
*            /********************************************************/
*            /*                                                      */
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */
*            /* TABLE, SET THE RETURN CODE TO 12                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0162
*            IF SWITCH ^= 1                                        0162
*               THEN                                               0162
         CLC   SWITCH(2),@CH00051                                  0162
         BE    @RF00162                                            0162
*                 RETNCODE = 12;                           /*@YL026YB*/
         MVC   RETNCODE(4),@CF00123                                0163
*         END;                                             /*@YL026YB*/
*                                                                  0164
@RF00162 DS    0H                                                  0165
*        /************************************************************/
*        /*                                                          */
*        /* FREE TEMPORARY WORKAREA. RETURN TO CALLER                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0165
*FRECR01: REG1 = DPTR;                                             0165
FRECR01  L     REG1,DPTR                                           0165
*         REG0 = CORESIZE;                                         0166
         L     REG0,CORESIZE                                       0166
*         GEN (FREEMAIN R,LV=(0),A=(1));                           0167
         FREEMAIN R,LV=(0),A=(1)
*         RFY (REG0,REG1) UNRSTD;                                  0168
*         END;                                             /*@YL026YB*/
*                                                                  0169
@EL00002 DS    0H                                                  0169
@EF00002 DS    0H                                                  0169
@ER00002 LM    @14,@12,@SA00002                                    0169
         BR    @14                                                 0169
*/********************************************************************/
*/*                                                                  */
*/* ENTRY02 IS THE PROCEDURE TO RETURN A 44 BYTE NAME WITH ENTRY     */
*/* TYPE. IT ISSUES SVC 26 FOR GENERIC LOCATE TO A LIST OF 44 BYTE   */
*/* NAMES                                                            */
*/********************************************************************/
*                                                                  0170
*ENTRY02:PROCEDURE;                                        /*@YL026YB*/
ENTRY02  STM   @14,@12,@SA00003                                    0170
*        COUNT = 0;                                                0171
         SLR   @14,@14                                             0171
         STH   @14,COUNT                                           0171
*        SWITCH = 0;                                               0172
         STH   @14,SWITCH                                          0172
*        RFY (REG1) RSTD;                                          0173
*                                                                  0173
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THE DSNAME FROM USER TO FIND ITS LENGTH.           */
*        /* INITIALIZE PARAMETER LIST FOR CPL.USE MOVE CHARACTER     */
*        /* LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0174
*        DO COUNT = LENGTH(USENAME) TO 1 BY -1             /*@YL026YB*/
*           WHILE(USENAME(COUNT) = BLANK);                 /*@YL026YB*/
         LA    @14,44                                              0174
         STH   @14,COUNT                                           0174
@DL00174 L     @10,CIRSRCH(,CIRPTR)                                0174
         ALR   @10,@14                                             0174
         AL    @10,@CF00251                                        0174
         CLI   USENAME(@10),X'40'                                  0174
         BNE   @DC00174                                            0174
*        END;                                              /*@YL026YB*/
         BCTR  @14,0                                               0175
         STH   @14,COUNT                                           0175
         LTR   @14,@14                                             0175
         BP    @DL00174                                            0175
@DC00174 DS    0H                                                  0176
*        GELENGTH = COUNT + 1;    /*MAKE ROOM FOR PERIOD TO   ZA00645*/
         LA    @14,1                                               0176
         AH    @14,COUNT                                           0176
         STC   @14,GELENGTH                                        0176
*                       /*LIMIT SEARCH TO CORRECT INDEX LEVEL ZA00645*/
*        USENAME(GELENGTH) = PERIOD;     /*INSERT PERIOD      ZA00645*/
         L     @10,CIRSRCH(,CIRPTR)                                0177
         ALR   @14,@10                                             0177
         AL    @14,@CF00251                                        0177
         MVI   USENAME(@14),X'4B'                                  0177
*        GNAME = USENAME(1:GELENGTH);                      /*@YL026YB*/
         MVI   GNAME+1,C' '                                        0178
         MVC   GNAME+2(42),GNAME+1                                 0178
         SLR   @14,@14                                             0178
         IC    @14,GELENGTH                                        0178
         BCTR  @14,0                                               0178
         EX    @14,@SM00307                                        0178
*        CPLSTOR = ''B;                                    /*@YL026YB*/
*                                                                  0179
         XC    CPLSTOR(32),CPLSTOR                                 0179
*        /************************************************************/
*        /*                                                          */
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0180
*        CTGNAME = ON;                                     /*@YL026YB*/
*        CTGCNAME = ON;                                    /*@YL026YB*/
         OI    CTGNAME(CTGPLPTR),B'00000110'                       0181
*        CTGSUPLT = ON;                                    /*@YL026YB*/
         OI    CTGSUPLT(CTGPLPTR),B'00010000'                      0182
*        CTGGENLD = ON;                                    /*@YL026YB*/
         OI    CTGGENLD(CTGPLPTR),B'00000001'                      0183
*        CTGAM0 = ON;                                      /*@YL026YB*/
         OI    CTGAM0(CTGPLPTR),B'00000001'                        0184
*        CTGENT = ADDR(GENAME);                            /*@YL026YB*/
         LA    @14,GENAME                                          0185
         ST    @14,CTGENT(,CTGPLPTR)                               0185
*        CTGCAT = CIRVOL;                                  /*@YL026YB*/
         MVC   CTGCAT(4,CTGPLPTR),CIRVOL(CIRPTR)                   0186
*        CTGPSWD = CIRPSWD;                                /*@YL026YB*/
         MVC   CTGPSWD(4,CTGPLPTR),CIRPSWD(CIRPTR)                 0187
*        CTGWKA = CIRWA;                                   /*@YL026YB*/
*                                                                  0188
         MVC   CTGWKA(4,CTGPLPTR),CIRWA(CIRPTR)                    0188
*        /************************************************************/
*        /*                                                          */
*        /* CALL SVC 26 FOR GENERIC LOCATE. ON RETURN CHECK RETURN   */
*        /* CODE                                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0189
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/
         LR    REG1,CTGPLPTR                                       0189
*        GENERATE (CATLG (1));                             /*@YL026YB*/
         CATLG (1)
*        RETNCODE = REG15;                                 /*@YL026YB*/
*                                                                  0191
         ST    REG15,RETNCODE                                      0191
*        /************************************************************/
*        /*                                                          */
*        /* IF RETURN CODE IS ZERO, 44 BYTE NAMES NOW IN USER        */
*        /* WORK AREA.PUT A HEX FF AS THE LAST BYTE IN               */
*        /* USER WORK AREA TO INDICATE END OF DATA                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0192
*        IF RETNCODE = 0                                           0192
*          THEN                                                    0192
         L     @14,RETNCODE                                        0192
         LTR   @14,@14                                             0192
         BNZ   @RF00192                                            0192
*            DO;                                           /*@YL026YB*/
*              ENDBYTE = DATALN - 3;                       /*@YL026YB*/
         L     @14,CIRWA(,CIRPTR)                                  0194
         LH    ENDBYTE,DATALN(,@14)                                0194
         SH    ENDBYTE,@CH00090                                    0194
*              DATAREA(ENDBYTE) = FOXES;                   /*@YL026YB*/
         ALR   @14,ENDBYTE                                         0195
         MVI   DATAREA-1(@14),X'FF'                                0195
*            END;                                          /*@YL026YB*/
*          /**********************************************************/
*          /*                                                        */
*          /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN    */
*          /* TABLE                                                  */
*          /**********************************************************/
*          ELSE                                                    0197
*                                                                  0197
*            DO;                                           /*@YL026YB*/
         B     @RC00192                                            0197
@RF00192 DS    0H                                                  0198
*              DO I = 1 TO 8;                              /*@YL026YB*/
         LA    @14,1                                               0198
         ST    @14,I                                               0198
@DL00198 DS    0H                                                  0199
*              IF RTNTABLE(I) = RETNCODE                           0199
*                THEN                                              0199
         SLA   @14,2                                               0199
         L     @14,RTNTABLE-4(@14)                                 0199
         C     @14,RETNCODE                                        0199
         BNE   @RF00199                                            0199
*                  DO;                                     /*@YL026YB*/
*                    SWITCH = 1;                           /*@YL026YB*/
         MVC   SWITCH(2),@CH00051                                  0201
*                    CIRLOCRC = REG15;                     /*@YL026YB*/
         STC   REG15,CIRLOCRC(,CIRPTR)                             0202
*                    RETNCODE = 4;                         /*@YL026YB*/
         MVC   RETNCODE(4),@CF00190                                0203
*                  END;                                    /*@YL026YB*/
*                ELSE;                                     /*@YL026YB*/
@RF00199 DS    0H                                                  0206
*            END;                                          /*@YL026YB*/
*                                                                  0206
         LA    @14,1                                               0206
         AL    @14,I                                               0206
         ST    @14,I                                               0206
         CH    @14,@CH00055                                        0206
         BNH   @DL00198                                            0206
*            /********************************************************/
*            /*                                                      */
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */
*            /* TABLE, SET THE RETURN CODE TO 12                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0207
*            IF SWITCH ^= 1                                        0207
*              THEN                                                0207
         CLC   SWITCH(2),@CH00051                                  0207
         BE    @RF00207                                            0207
*                RETNCODE = 12;                            /*@YL026YB*/
         MVC   RETNCODE(4),@CF00123                                0208
*        END;                                              /*@YL026YB*/
*        RFY (REG1) UNRSTD;                                        0210
*        END;                                              /*@YL026YB*/
*                                                                  0211
@EL00003 DS    0H                                                  0211
@EF00003 DS    0H                                                  0211
@ER00003 LM    @14,@12,@SA00003                                    0211
         BR    @14                                                 0211
*/********************************************************************/
*/*                                                                  */
*/* ENTRY04 IS THE PROCEDURE TO RETURN VOLUMN INFORMATION.SVC 26     */
*/* IS ISSUED FOR A VSAM LOCATE                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0212
*ENTRY04: PROCEDURE;                                       /*@YL026YB*/
ENTRY04  STM   @14,@12,@SA00004                                    0212
*        COUNT = 0;                                                0213
         SLR   @14,@14                                             0213
         STH   @14,COUNT                                           0213
*        SWITCH = 0;                                               0214
*                                                                  0214
         STH   @14,SWITCH                                          0214
*        /************************************************************/
*        /*                                                          */
*        /* DO A GETMAIN TO OBTAIN A TEMPORARY WORKAREA FOR DATA     */
*        /* RETURNED FROM SVC 26.SET REG 0 TO CONTAIN LENGTH OF      */
*        /* WORKAREA AND SUBPOOL NUMBER.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0215
*        RFY (REG0,REG1) RSTD;                                     0215
*        REG0 = MAX1;                                              0216
         LH    REG0,@CH00208                                       0216
*        REG0 = REG0 × SUBPOOL1;                           /*@YL026YB*/
         O     REG0,@CF00176                                       0217
*        CORESIZE = REG0;                                          0218
         ST    REG0,CORESIZE                                       0218
*        GEN (GETMAIN R,LV=(0));                                   0219
         GETMAIN R,LV=(0)
*        DPTR = REG1;                                              0220
*                                                                  0220
         ST    REG1,DPTR                                           0220
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THE DSNAME FROM USER TO FIND ITS LENGTH.           */
*        /* INITIALIZE PARAMETER LIST FOR CPL.USE MOVE CHARACTER     */
*        /* LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0221
*        DO COUNT = LENGTH(USENAME) TO 1 BY -1             /*@YL026YB*/
*           WHILE(USENAME(COUNT) = BLANK);                 /*@YL026YB*/
         LA    @14,44                                              0221
         STH   @14,COUNT                                           0221
@DL00221 L     @10,CIRSRCH(,CIRPTR)                                0221
         ALR   @10,@14                                             0221
         AL    @10,@CF00251                                        0221
         CLI   USENAME(@10),X'40'                                  0221
         BNE   @DC00221                                            0221
*        END;                                              /*@YL026YB*/
         BCTR  @14,0                                               0222
         STH   @14,COUNT                                           0222
         LTR   @14,@14                                             0222
         BP    @DL00221                                            0222
@DC00221 DS    0H                                                  0223
*        GELENGTH = COUNT;                                 /*@YL026YB*/
         LH    @14,COUNT                                           0223
         STC   @14,GELENGTH                                        0223
*        GNAME = USENAME(1:GELENGTH);                      /*@YL026YB*/
         MVI   GNAME+1,C' '                                        0224
         MVC   GNAME+2(42),GNAME+1                                 0224
         BCTR  @14,0                                               0224
         L     @10,CIRSRCH(,CIRPTR)                                0224
         EX    @14,@SM00307                                        0224
*        CPLSTOR = ''B;                                    /*@YL026YB*/
         XC    CPLSTOR(32),CPLSTOR                                 0225
*        FPLSTOR = ''B;                                    /*@YL026YB*/
         XC    FPLSTOR(24),FPLSTOR                                 0226
*        CALL MOVEINST(QUALDATA);                          /*@YL026YB*/
         L     @14,DPTR                                            0227
         LA    @14,QUALDATA(,@14)                                  0227
         ST    @14,@AL00001                                        0227
         LA    @01,@AL00001                                        0227
         BAL   @14,MOVEINST                                        0227
*        QUALN = LENGTH(QUALAREA);                         /*@YL026YB*/
*                                                                  0228
         L     @14,DPTR                                            0228
         MVC   QUALN(2,@14),@CH00208                               0228
*        /************************************************************/
*        /*                                                          */
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0229
*        CTGNAME = ON;                                     /*@YL026YB*/
*        CTGCNAME = ON;                                    /*@YL026YB*/
         OI    CTGNAME(CTGPLPTR),B'00000110'                       0230
*        CTGFUNC = '001'B;                                 /*@YL026YB*/
         NI    CTGFUNC(CTGPLPTR),B'00111111'                       0231
         OI    CTGFUNC(CTGPLPTR),B'00100000'                       0231
*        CTGAM0 = ON;                                      /*@YL026YB*/
         OI    CTGAM0(CTGPLPTR),B'00000001'                        0232
*        CTGENT = ADDR(GNAME);                             /*@YL026YB*/
         LA    @10,GNAME                                           0233
         ST    @10,CTGENT(,CTGPLPTR)                               0233
*        CTGCAT = CIRVOL;                                  /*@YL026YB*/
         MVC   CTGCAT(4,CTGPLPTR),CIRVOL(CIRPTR)                   0234
*        CTGPSWD = CIRPSWD;                                /*@YL026YB*/
         MVC   CTGPSWD(4,CTGPLPTR),CIRPSWD(CIRPTR)                 0235
*        CTGWKA = DPTR;                                    /*@YL026YB*/
*                                                                  0236
         ST    @14,CTGWKA(,CTGPLPTR)                               0236
*        /************************************************************/
*        /*                                                          */
*        /* SET UP PARAMETER LIST FOR FPL                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0237
*        CTGNOFLD = 1;                                     /*@YL026YB*/
         MVI   CTGNOFLD(CTGPLPTR),X'01'                            0237
*        CTGFIELD(1) = ADDR(FPLSTOR);                      /*@YL026YB*/
         LA    @14,FPLSTOR                                         0238
         ST    @14,CTGFIELD(,CTGPLPTR)                             0238
*        CTGFLDNM = ADDR(ENNTRY);                          /*@YL026YB*/
         L     @14,CTGFLPTR                                        0239
         LA    @10,@CC00229                                        0239
         ST    @10,CTGFLDNM(,@14)                                  0239
*        CTGFLDNO = 1;                                     /*@YL026YB*/
*                                                                  0240
         MVI   CTGFLDNO(@14),X'01'                                 0240
*        /************************************************************/
*        /*                                                          */
*        /* CALL SVC 26 FOR VSAM    LOCATE. ON RETURN CHECK RETURN   */
*        /* CODE                                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0241
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/
         LR    REG1,CTGPLPTR                                       0241
*        GENERATE (CATLG (1));                             /*@YL026YB*/
         CATLG (1)
*        RETNCODE = REG15;                                 /*@YL026YB*/
*                                                                  0243
         ST    REG15,RETNCODE                                      0243
*        /************************************************************/
*        /*                                                          */
*        /* IF RETURN CODE IS ZERO, COMPUTE THE VOLUMN COUNT.        */
*        /* MOVE VOLUMN INFORMATION TO USER WORK AREA                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0244
*        IF  RETNCODE = 0                                          0244
*          THEN                                                    0244
         L     @14,RETNCODE                                        0244
         LTR   @14,@14                                             0244
         BNZ   @RF00244                                            0244
*            DO;                                                   0245
*              IF AREALN < RTNQLN                          /*@YL026YB*/
*                THEN                                      /*@YL026YB*/
         L     @14,CIRWA(,CIRPTR)                                  0246
         LH    @14,AREALN(,@14)                                    0246
         L     @10,DPTR                                            0246
         CH    @14,RTNQLN(,@10)                                    0246
         BNL   @RF00246                                            0246
*                  DO;                                     /*@YL026YB*/
*                    CIRLOCRC = 44;                        /*@YL026YB*/
         MVI   CIRLOCRC(CIRPTR),X'2C'                              0248
*                    RETNCODE = 4;                         /*@YL026YB*/
         MVC   RETNCODE(4),@CF00190                                0249
*                    GOTO FRECR04;                         /*@YL026YB*/
         B     FRECR04                                             0250
*                  END;                                    /*@YL026YB*/
*                  DATALN = RTNQLN;                        /*@YL026YB*/
@RF00246 L     @14,CIRWA(,CIRPTR)                                  0252
         L     @10,DPTR                                            0252
         MVC   DATALN(2,@14),RTNQLN(@10)                           0252
*              VOLCNT = CTGFLNG(1) / LENGTH(VOLAREA);      /*@YL026YB*/
         L     @10,CTGFLPTR                                        0253
         L     @04,CTGFLNG(,@10)                                   0253
         SRDA  @04,32                                              0253
         D     @04,@CF00145                                        0253
         STC   @05,VOLCNT                                          0253
*              DATAREA(1) = VOLCNT;                        /*@YL026YB*/
         STC   @05,DATAREA(,@14)                                   0254
*              LAST = 1;                                   /*@YL026YB*/
         LA    @14,1                                               0255
         STH   @14,LAST                                            0255
*              DO  I = 1 TO VOLCNT;                        /*@YL026YB*/
         B     @DE00256                                            0256
@DL00256 DS    0H                                                  0257
*              FIRST = LAST + 1;                           /*@YL026YB*/
         LA    @10,1                                               0257
         AH    @10,LAST                                            0257
         STH   @10,FIRST                                           0257
*              LAST = FIRST + (LENGTH(VOLDATA) - 1);       /*@YL026YB*/
         LA    @03,11                                              0258
         ALR   @03,@10                                             0258
         STH   @03,LAST                                            0258
*              VOLAREA = CTGFLPT(1)->VOLBLK(1:LENGTH(VOLAREA));    0259
         L     @09,CTGFLPTR                                        0259
         L     @08,CTGFLPT(,@09)                                   0259
         MVC   VOLAREA(15),VOLBLK(@08)                             0259
*              DATAREA(FIRST:LAST) = VOLDATA;              /*@YL026YB*/
         L     @07,CIRWA(,CIRPTR)                                  0260
         ALR   @07,@10                                             0260
         SLR   @03,@10                                             0260
         EX    @03,@SM00317                                        0260
*              CTGFLPT(1) = CTGFLPT(1) + LENGTH(VOLAREA);  /*@YL026YB*/
         AH    @08,@CH00145                                        0261
         ST    @08,CTGFLPT(,@09)                                   0261
*              END;                                        /*@YL026YB*/
*                                                                  0262
         AH    @14,@CH00051                                        0262
@DE00256 ST    @14,I                                               0262
         SLR   @10,@10                                             0262
         IC    @10,VOLCNT                                          0262
         CR    @14,@10                                             0262
         BNH   @DL00256                                            0262
*              /******************************************************/
*              /*                                                    */
*              /* PUT HEX FF AS THE LAST BYTE IN USER WORK AREA TO   */
*              /* TO INDICATE END OF DATA                            */
*              /*                                                    */
*              /******************************************************/
*                                                                  0263
*              ENDBYTE = LAST + 1;                         /*@YL026YB*/
         LA    ENDBYTE,1                                           0263
         AH    ENDBYTE,LAST                                        0263
*              DATAREA(ENDBYTE) = FOXES;                   /*@YL026YB*/
         L     @14,CIRWA(,CIRPTR)                                  0264
         ALR   @14,ENDBYTE                                         0264
         MVI   DATAREA-1(@14),X'FF'                                0264
*              RETNCODE = 0;                               /*@YL026YB*/
         SLR   @14,@14                                             0265
         ST    @14,RETNCODE                                        0265
*              GOTO FRECR04;                                       0266
         B     FRECR04                                             0266
*            END;                                          /*@YL026YB*/
*            /********************************************************/
*            /*                                                      */
*            /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN  */
*            /* TABLE                                                */
*            /********************************************************/
*            ELSE                                                  0268
*              DO;                                         /*@YL026YB*/
@RF00244 DS    0H                                                  0269
*                DO I = 1 TO 8;                            /*@YL026YB*/
         LA    @14,1                                               0269
         ST    @14,I                                               0269
@DL00269 DS    0H                                                  0270
*              IF RTNTABLE(I) = RETNCODE                           0270
*                THEN                                              0270
         SLA   @14,2                                               0270
         L     @14,RTNTABLE-4(@14)                                 0270
         C     @14,RETNCODE                                        0270
         BNE   @RF00270                                            0270
*                  DO;                                     /*@YL026YB*/
*                    SWITCH = 1;                           /*@YL026YB*/
         MVC   SWITCH(2),@CH00051                                  0272
*                    CIRLOCRC = REG15;                     /*@YL026YB*/
         STC   REG15,CIRLOCRC(,CIRPTR)                             0273
*                    RETNCODE = 4;                         /*@YL026YB*/
         MVC   RETNCODE(4),@CF00190                                0274
*                    GOTO FRECR04;                                 0275
         B     FRECR04                                             0275
*                  END;                                    /*@YL026YB*/
*                ELSE;                                     /*@YL026YB*/
@RF00270 DS    0H                                                  0278
*            END;                                          /*@YL026YB*/
*                                                                  0278
         LA    @14,1                                               0278
         AL    @14,I                                               0278
         ST    @14,I                                               0278
         CH    @14,@CH00055                                        0278
         BNH   @DL00269                                            0278
*            /********************************************************/
*            /*                                                      */
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */
*            /* TABLE, SET THE RETURN CODE TO 12                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0279
*            IF SWITCH ^= 1                                        0279
*              THEN                                                0279
         CLC   SWITCH(2),@CH00051                                  0279
         BE    @RF00279                                            0279
*                RETNCODE = 12;                            /*@YL026YB*/
         MVC   RETNCODE(4),@CF00123                                0280
*        END;                                              /*@YL026YB*/
*                                                                  0281
@RF00279 DS    0H                                                  0282
*        /************************************************************/
*        /*                                                          */
*        /* FREE TEMPORARY WORKAREA. RETURN TO CALLER                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0282
*FRECR04:REG1 = DPTR;                                              0282
FRECR04  L     REG1,DPTR                                           0282
*        REG0 = CORESIZE;                                          0283
         L     REG0,CORESIZE                                       0283
*        GEN (FREEMAIN R,LV=(0),A=(1));                            0284
         FREEMAIN R,LV=(0),A=(1)
*        RFY (REG0,REG1) UNRSTD;                                   0285
*        END;                                              /*@YL026YB*/
*                                                                  0286
@EL00004 DS    0H                                                  0286
@EF00004 DS    0H                                                  0286
@ER00004 LM    @14,@12,@SA00004                                    0286
         BR    @14                                                 0286
*/********************************************************************/
*/*                                                                  */
*/* ENTRY06 IS THE PROCEDURE TO RETURN 44 BYTE NAMES AND VOLUMN      */
*/* INFORMATION. IT GETS CONTROL IF THE ENTRY CODE IS HEX 05         */
*/* OR HEX 06. IF THE ENTRY CODE IS HEX 05 IT CALLS PROCEDURE        */
*/* ENTRY05. FIRST IT ISSUES SVC 26 FOR A GENERIC LOCATE             */
*/* AND TAKES THE 44 BYTE NAME RETURNED AND ISSUES SVC 26            */
*/* AGAIN FOR A VSAM LOCATE TO GET VOLUMN INFORMATION.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0287
*ENTRY06: PROCEDURE;                                       /*@YL026YB*/
ENTRY06  STM   @14,@12,@SA00005                                    0287
*        DCL SAVCNT          FIXED(15);/*LENGTH OF NAME      @YL026YB*/
*                                      /*FROM GENERIC LOCATE         */
*        DCL SAVNAME         CHAR(45); /*NAME FROM LOCATE    @YL026YB*/
*        DCL FS1             FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/
*        DCL FS2             FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/
*        DCL N1              FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/
*        DCL N2              FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/
*                                                                  0293
*                                                                  0293
*        COUNT = 0;                                                0294
*                                                                  0294
         SLR   @14,@14                                             0294
         STH   @14,COUNT                                           0294
*        /************************************************************/
*        /*                                                          */
*        /* DO A GETMAIN TO OBTAIN A TEMPORARY WORKAREA FOR DATA     */
*        /* RETURNED FROM SVC 26.SET REG 0 TO CONTAIN LENGTH OF      */
*        /* WORKAREA AND SUBPOOL NUMBER.                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0295
*        SWITCH = 0;                                               0295
         STH   @14,SWITCH                                          0295
*        RFY (REG0,REG1) RSTD;                                     0296
*        REG0 = MAX1;                                              0297
         LH    REG0,@CH00208                                       0297
*        REG0 = REG0 × SUBPOOL1;                                   0298
         O     REG0,@CF00176                                       0298
*        CORESIZE = REG0;                                          0299
         ST    REG0,CORESIZE                                       0299
*        GEN (GETMAIN R,LV=(0));                                   0300
         GETMAIN R,LV=(0)
*        DPTR1 = REG1;                                             0301
         ST    REG1,DPTR1                                          0301
*        TEMLN = LENGTH(WORKTEMP);                         /*@YL026YB*/
         L     @14,DPTR1                                           0302
         MVC   TEMLN(2,@14),@CH00208                               0302
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THE DSNAME FROM USER TO FIND ITS LENGTH.           */
*        /* INITIALIZE PARAMETER LIST FOR CPL.USE MOVE CHARACTER     */
*        /* LONG INSTRUCTION TO FILL TEMPDATA WITH BLANKS            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0303
*        DO COUNT = LENGTH(USENAME) TO 1 BY -1             /*@YL026YB*/
*           WHILE(USENAME(COUNT) = BLANK);                 /*@YL026YB*/
         LA    @14,44                                              0303
         STH   @14,COUNT                                           0303
@DL00303 L     @10,CIRSRCH(,CIRPTR)                                0303
         ALR   @10,@14                                             0303
         AL    @10,@CF00251                                        0303
         CLI   USENAME(@10),X'40'                                  0303
         BNE   @DC00303                                            0303
*        END;                                              /*@YL026YB*/
         BCTR  @14,0                                               0304
         STH   @14,COUNT                                           0304
         LTR   @14,@14                                             0304
         BP    @DL00303                                            0304
@DC00303 DS    0H                                                  0305
*        SAVCNT = COUNT;                                   /*@YL026YB*/
         LH    @14,COUNT                                           0305
         STH   @14,SAVCNT                                          0305
*        GELENGTH = COUNT + 1;    /*MAKE ROOM FOR PERIOD TO   ZA00645*/
         AH    @14,@CH00051                                        0306
         STC   @14,GELENGTH                                        0306
*                       /*LIMIT SEARCH TO CORRECT INDEX LEVEL ZA00645*/
*        USENAME(GELENGTH) = PERIOD;     /*INSERT PERIOD      ZA00645*/
         L     @10,CIRSRCH(,CIRPTR)                                0307
         ALR   @14,@10                                             0307
         AL    @14,@CF00251                                        0307
         MVI   USENAME(@14),X'4B'                                  0307
*        GNAME = USENAME(1:GELENGTH);                      /*@YL026YB*/
         MVI   GNAME+1,C' '                                        0308
         MVC   GNAME+2(42),GNAME+1                                 0308
         SLR   @14,@14                                             0308
         IC    @14,GELENGTH                                        0308
         BCTR  @14,0                                               0308
         EX    @14,@SM00307                                        0308
*        CALL MOVEINST(TEMPDATA);                          /*@YL026YB*/
         L     @14,DPTR1                                           0309
         LA    @14,TEMPDATA(,@14)                                  0309
         ST    @14,@AL00001                                        0309
         LA    @01,@AL00001                                        0309
         BAL   @14,MOVEINST                                        0309
*        CPLSTOR = ''B;                                    /*@YL026YB*/
         XC    CPLSTOR(32),CPLSTOR                                 0310
*        FPLSTOR = ''B;                                    /*@YL026YB*/
         XC    FPLSTOR(24),FPLSTOR                                 0311
*        WKPTR = ADDR(TEMPDATA);                           /*@YL026YB*/
         L     @14,DPTR1                                           0312
         LA    @10,TEMPDATA(,@14)                                  0312
         ST    @10,WKPTR                                           0312
*        /************************************************************/
*        /*                                                          */
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */
*        /*                                                          */
*        /************************************************************/
*        CTGNAME = ON;                                     /*@YL026YB*/
*        CTGCNAME = ON;                                    /*@YL026YB*/
         OI    CTGNAME(CTGPLPTR),B'00000110'                       0314
*        CTGSUPLT = ON;                                    /*@YL026YB*/
         OI    CTGSUPLT(CTGPLPTR),B'00010000'                      0315
*        CTGGENLD = ON;                                    /*@YL026YB*/
         OI    CTGGENLD(CTGPLPTR),B'00000001'                      0316
*        CTGAM0 = ON;                                      /*@YL026YB*/
         OI    CTGAM0(CTGPLPTR),B'00000001'                        0317
*        CTGENT = ADDR(GNAME);                             /*@YL026YB*/
         LA    @10,GNAME                                           0318
         ST    @10,CTGENT(,CTGPLPTR)                               0318
*        CTGCAT = CIRVOL;                                  /*@YL026YB*/
         MVC   CTGCAT(4,CTGPLPTR),CIRVOL(CIRPTR)                   0319
*        CTGPSWD = CIRPSWD;                                /*@YL026YB*/
         MVC   CTGPSWD(4,CTGPLPTR),CIRPSWD(CIRPTR)                 0320
*        CTGWKA = DPTR1;                                   /*@YL026YB*/
*                                                                  0321
         ST    @14,CTGWKA(,CTGPLPTR)                               0321
*        /************************************************************/
*        /*                                                          */
*        /* SET VARIABLES TO INITIAL SUBSTRING COUNT                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0322
*        FS1 = 1;                                          /*@YL026YB*/
         LA    @14,1                                               0322
         STH   @14,FS1                                             0322
*        FS2 = 9;                                          /*@YL026YB*/
         MVC   FS2(2),@CH00279                                     0323
*        N1 = 1;                                           /*@YL026YB*/
         STH   @14,N1                                              0324
*        N2 = 45;                                          /*@YL026YB*/
         MVC   N2(2),@CH00206                                      0325
*        /************************************************************/
*        /*                                                          */
*        /* CALL SVC 26 FOR GENERIC LOCATE. ON RETURN CHECK RETURN   */
*        /* CODE                                                     */
*        /*                                                          */
*        /************************************************************/
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/
         LR    REG1,CTGPLPTR                                       0326
*        GENERATE (CATLG (1));                             /*@YL026YB*/
         CATLG (1)
*        RETNCODE = REG15;                                 /*@YL026YB*/
*                                                                  0328
         ST    REG15,RETNCODE                                      0328
*        /************************************************************/
*        /*                                                          */
*        /* IF THE RETURN CODE IS ZERO THEN DETERMINE THE NUMBER     */
*        /* OF 44 BYTE NAMES RETURNED. IF THE ENTRY CODE IS HEX 05   */
*        /* GO TO PROCEDURE ENTRY 05                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0329
*        IF RETNCODE = 0                                           0329
*          THEN                                                    0329
         L     @14,RETNCODE                                        0329
         LTR   @14,@14                                             0329
         BNZ   @RF00329                                            0329
*            DO;                                           /*@YL026YB*/
*            REG0 = CORESIZE;                                      0331
         L     REG0,CORESIZE                                       0331
*            GEN (GETMAIN R,LV=(0));                               0332
         GETMAIN R,LV=(0)
*            DPTR = REG1;                                          0333
         ST    REG1,DPTR                                           0333
*              CONTROL = (TEMRTLN - 4) / 45;               /*@YL026YB*/
         L     @14,DPTR1                                           0334
         LH    @04,TEMRTLN(,@14)                                   0334
         SH    @04,@CH00190                                        0334
         SRDA  @04,32                                              0334
         D     @04,@CF00206                                        0334
         STH   @05,CONTROL                                         0334
*              DO I = 1 TO CONTROL;                        /*@YL026YB*/
         LA    @14,1                                               0335
         B     @DE00335                                            0335
@DL00335 DS    0H                                                  0336
*              SAVNAME = WKPTR->TEMBLK;                    /*@YL026YB*/
         L     @14,WKPTR                                           0336
         MVC   SAVNAME(45),TEMBLK(@14)                             0336
*              IF CIROPT = HEX05                                   0337
*                THEN                                              0337
         CLI   CIROPT(CIRPTR),X'05'                                0337
         BNE   @RF00337                                            0337
*                  DO;                                     /*@YL026YB*/
*                    LAST = FS2;                           /*@YL026YB*/
*                                                                  0339
         MVC   LAST(2),FS2                                         0339
*                    /************************************************/
*                    /*                                              */
*                    /* GO TO PROCEDURE ENTRY 05 AND PROCESS 8 BYTE  */
*                    /* QUALIFIER AND VOLUMN INFORMATION.            */
*                    /*                                              */
*                    /************************************************/
*                                                                  0340
*                    CALL ENTRY05(SAVNAME,FS1,FS2,SAVCNT);         0340
         LA    @14,SAVNAME                                         0340
         ST    @14,@AL00001                                        0340
         LA    @14,FS1                                             0340
         ST    @14,@AL00001+4                                      0340
         LA    @14,FS2                                             0340
         ST    @14,@AL00001+8                                      0340
         LA    @14,SAVCNT                                          0340
         ST    @14,@AL00001+12                                     0340
         LA    @01,@AL00001                                        0340
         BAL   @14,ENTRY05                                         0340
*                    IF REG15 ^= 0                                 0341
*                      THEN                                        0341
         LTR   REG15,REG15                                         0341
         BZ    @RF00341                                            0341
*                        RET05 = REG15;                    /*@YL026YB*/
*                                                                  0342
         STH   REG15,RET05                                         0342
*              /******************************************************/
*              /* RESET SUBSTRING COUNT                              */
*              /******************************************************/
*                                                                  0343
*              FS1 = FS2 + 1;                              /*@YL026YB*/
@RF00341 LA    @14,1                                               0343
         AH    @14,FS2                                             0343
         STH   @14,FS1                                             0343
*              FS2 = FS1 + 8;                              /*@YL026YB*/
         AH    @14,@CH00055                                        0344
         STH   @14,FS2                                             0344
*              END;                                        /*@YL026YB*/
*                                                                  0345
*              /******************************************************/
*              /* TURN OFF FLAGS FOR GENERIC LOCATE AND SET FLAG     */
*              /* FOR VSAM LOCATE                                    */
*              /******************************************************/
*                                                                  0346
*              ELSE                                                0346
*                DO;                                       /*@YL026YB*/
         B     @RC00337                                            0346
@RF00337 DS    0H                                                  0347
*                  CTGSUPLT = OFF;                         /*@YL026YB*/
         NI    CTGSUPLT(CTGPLPTR),B'11101111'                      0347
*                  CTGGENLD = OFF;                         /*@YL026YB*/
         NI    CTGGENLD(CTGPLPTR),B'11111110'                      0348
*                  CTGFUNC = '001'B;                       /*@YL026YB*/
         NI    CTGFUNC(CTGPLPTR),B'00111111'                       0349
         OI    CTGFUNC(CTGPLPTR),B'00100000'                       0349
*                  COUNT = 0;                              /*@YL026YB*/
*                                                                  0350
         SLR   @14,@14                                             0350
         STH   @14,COUNT                                           0350
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THE NAME FROM GENERIC LOCATE TO FIND ITS TRUE      */
*        /* LENGTH.POINT TO NAME AND WKAREA FOR CPL.USE MOVE         */
*        /* CHARACTER LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0351
*        DO COUNT = LENGTH(SAVNAME) TO 1 BY -1             /*@YL026YB*/
*           WHILE(SAVNAME(COUNT) = BLANK);                 /*@YL026YB*/
         LA    @14,45                                              0351
         STH   @14,COUNT                                           0351
@DL00351 LA    @10,SAVNAME-1(@14)                                  0351
         CLI   0(@10),X'40'                                        0351
         BNE   @DC00351                                            0351
*        END;                                              /*@YL026YB*/
         BCTR  @14,0                                               0352
         STH   @14,COUNT                                           0352
         LTR   @14,@14                                             0352
         BP    @DL00351                                            0352
@DC00351 DS    0H                                                  0353
*        GELENGTH = COUNT;                                 /*@YL026YB*/
         LH    @14,COUNT                                           0353
         STC   @14,GELENGTH                                        0353
*        GNAME = SAVNAME(1:GELENGTH);                      /*@YL026YB*/
         MVI   GNAME+1,C' '                                        0354
         MVC   GNAME+2(42),GNAME+1                                 0354
         BCTR  @14,0                                               0354
         EX    @14,@SM00321                                        0354
*        CALL MOVEINST(QUALDATA);                          /*@YL026YB*/
         L     @14,DPTR                                            0355
         LA    @14,QUALDATA(,@14)                                  0355
         ST    @14,@AL00001                                        0355
         LA    @01,@AL00001                                        0355
         BAL   @14,MOVEINST                                        0355
*        QUALN = LENGTH(QUALAREA);                         /*@YL026YB*/
         L     @14,DPTR                                            0356
         MVC   QUALN(2,@14),@CH00208                               0356
*        CTGENT = ADDR(GENAME);                            /*@YL026YB*/
         LA    @10,GENAME                                          0357
         ST    @10,CTGENT(,CTGPLPTR)                               0357
*        CTGWKA = DPTR;                                    /*@YL026YB*/
*                                                                  0358
         ST    @14,CTGWKA(,CTGPLPTR)                               0358
*        /************************************************************/
*        /*                                                          */
*        /* SET UP PARAMETER LIST FOR FPL                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0359
*        CTGNOFLD = 1;                                     /*@YL026YB*/
         MVI   CTGNOFLD(CTGPLPTR),X'01'                            0359
*        CTGFIELD(1) = ADDR(FPLSTOR);                      /*@YL026YB*/
         LA    @14,FPLSTOR                                         0360
         ST    @14,CTGFIELD(,CTGPLPTR)                             0360
*        CTGFLDNM = ADDR(ENNTRY);                          /*@YL026YB*/
         L     @14,CTGFLPTR                                        0361
         LA    @10,@CC00229                                        0361
         ST    @10,CTGFLDNM(,@14)                                  0361
*        CTGFLDNO = 1;                                     /*@YL026YB*/
         MVI   CTGFLDNO(@14),X'01'                                 0362
*        /************************************************************/
*        /*                                                          */
*        /* CALL SVC 26 FOR VSAM    LOCATE. ON RETURN CHECK RETURN   */
*        /* CODE                                                     */
*        /*                                                          */
*        /************************************************************/
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/
         LR    REG1,CTGPLPTR                                       0363
*        GENERATE (CATLG (1));                             /*@YL026YB*/
         CATLG (1)
*        RETNCODE = REG15;                                 /*@YL026YB*/
*                                                                  0365
         ST    REG15,RETNCODE                                      0365
*        /************************************************************/
*        /*                                                          */
*        /* IF RETURN CODE IS ZERO, COMPUTE THE VOLUMN COUNT.        */
*        /* MOVE VOLUMN INFORMATION TO USER WORK AREA                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0366
*        IF  RETNCODE = 0                                          0366
*          THEN                                                    0366
         L     @14,RETNCODE                                        0366
         LTR   @14,@14                                             0366
         BNZ   @RF00366                                            0366
*            DO;                                           /*@YL026YB*/
*              IF AREALN < RTNQLN                          /*@YL026YB*/
*                THEN                                      /*@YL026YB*/
         L     @14,CIRWA(,CIRPTR)                                  0368
         LH    @14,AREALN(,@14)                                    0368
         L     @10,DPTR                                            0368
         CH    @14,RTNQLN(,@10)                                    0368
         BNL   @RF00368                                            0368
*                  DO;                                     /*@YL026YB*/
*                    CIRLOCRC = 44;                        /*@YL026YB*/
         MVI   CIRLOCRC(CIRPTR),X'2C'                              0370
*                    RETNCODE = 4;                         /*@YL026YB*/
         MVC   RETNCODE(4),@CF00190                                0371
*                    GOTO FRECORE;                         /*@YL026YB*/
         B     FRECORE                                             0372
*                  END;                                    /*@YL026YB*/
*              DATALN = RTNQLN;                            /*@YL026YB*/
@RF00368 L     @14,CIRWA(,CIRPTR)                                  0374
         L     @10,DPTR                                            0374
         MVC   DATALN(2,@14),RTNQLN(@10)                           0374
*              VOLCNT = CTGFLNG(1) / LENGTH(VOLAREA);      /*@YL026YB*/
         L     @10,CTGFLPTR                                        0375
         L     @04,CTGFLNG(,@10)                                   0375
         SRDA  @04,32                                              0375
         D     @04,@CF00145                                        0375
         STC   @05,VOLCNT                                          0375
*              DATAREA(N1:N2) = SAVNAME;                   /*@YL026YB*/
         LH    @10,N1                                              0376
         ALR   @10,@14                                             0376
         LH    @04,N2                                              0376
         LH    @09,N1                                              0376
         LCR   @09,@09                                             0376
         ALR   @09,@04                                             0376
         EX    @09,@SM00323                                        0376
*              FIRST = N2 + 1;                             /*@YL026YB*/
         LA    @10,1                                               0377
         ALR   @04,@10                                             0377
         STH   @04,FIRST                                           0377
*              DATAREA(FIRST) = VOLCNT;                    /*@YL026YB*/
         STC   @05,DATAREA-1(@04,@14)                              0378
*              LAST = FIRST;                               /*@YL026YB*/
         STH   @04,LAST                                            0379
*              DO  K = 1 TO VOLCNT;                        /*@YL026YB*/
         B     @DE00380                                            0380
@DL00380 DS    0H                                                  0381
*              FIRST = LAST + 1;                           /*@YL026YB*/
         LA    @14,1                                               0381
         AH    @14,LAST                                            0381
         STH   @14,FIRST                                           0381
*              LAST = FIRST + (LENGTH(VOLDATA) - 1);       /*@YL026YB*/
         LA    @09,11                                              0382
         ALR   @09,@14                                             0382
         STH   @09,LAST                                            0382
*              VOLAREA = CTGFLPT(1)->VOLBLK(1:LENGTH(VOLAREA));    0383
         L     @08,CTGFLPTR                                        0383
         L     @07,CTGFLPT(,@08)                                   0383
         MVC   VOLAREA(15),VOLBLK(@07)                             0383
*              DATAREA(FIRST:LAST) = VOLDATA;              /*@YL026YB*/
         L     @06,CIRWA(,CIRPTR)                                  0384
         ALR   @06,@14                                             0384
         SLR   @09,@14                                             0384
         EX    @09,@SM00325                                        0384
*              CTGFLPT(1) = CTGFLPT(1) + LENGTH(VOLDATA);  /*@YL026YB*/
         AH    @07,@CH00123                                        0385
         ST    @07,CTGFLPT(,@08)                                   0385
*              END;                                        /*@YL026YB*/
*                                                                  0386
         AH    @10,@CH00051                                        0386
@DE00380 ST    @10,K                                               0386
         SLR   @14,@14                                             0386
         IC    @14,VOLCNT                                          0386
         CR    @10,@14                                             0386
         BNH   @DL00380                                            0386
*              /******************************************************/
*              /* RESET SUBSTRING COUNT                              */
*              /******************************************************/
*                                                                  0387
*              N1 = LAST + 1;                              /*@YL026YB*/
         LA    @14,1                                               0387
         AH    @14,LAST                                            0387
         STH   @14,N1                                              0387
*              N2 = N1 + (LENGTH(SAVNAME) - 1);            /*@YL026YB*/
         AH    @14,@CH00183                                        0388
         STH   @14,N2                                              0388
*              END;                                        /*@YL026YB*/
*          ELSE                                            /*@YL026YB*/
*            RET06 = REG15;                                /*@YL026YB*/
         B     @RC00366                                            0390
@RF00366 STH   REG15,RET06                                         0390
*              END;                                        /*@YL026YB*/
*                                                                  0391
@RC00366 DS    0H                                                  0392
*              /******************************************************/
*              /*                                                    */
*              /* ADJUST SUBSTRING VARIABLES AND POINT TO NEXT 44    */
*              /* BYTE  NAME                                         */
*              /*                                                    */
*              /******************************************************/
*                                                                  0392
*              WKPTR = WKPTR + 45;                         /*@YL026YB*/
@RC00337 LA    @14,45                                              0392
         AL    @14,WKPTR                                           0392
         ST    @14,WKPTR                                           0392
*              END;                                        /*@YL026YB*/
*                                                                  0393
         LA    @14,1                                               0393
         AL    @14,I                                               0393
@DE00335 ST    @14,I                                               0393
         CH    @14,CONTROL                                         0393
         BNH   @DL00335                                            0393
*              /******************************************************/
*              /*                                                    */
*              /* PUT HEX FF AS THE LAST BYTE IN USER WORK AREA TO   */
*              /* TO INDICATE END OF DATA                            */
*              /*                                                    */
*              /******************************************************/
*                                                                  0394
*              ENDBYTE = LAST + 1;                         /*@YL026YB*/
         LA    ENDBYTE,1                                           0394
         AH    ENDBYTE,LAST                                        0394
*              DATAREA(ENDBYTE) = FOXES;                   /*@YL026YB*/
         L     @14,CIRWA(,CIRPTR)                                  0395
         ALR   @14,ENDBYTE                                         0395
         MVI   DATAREA-1(@14),X'FF'                                0395
*              RETNCODE = 0;                               /*@YL026YB*/
         SLR   @14,@14                                             0396
         ST    @14,RETNCODE                                        0396
*              GOTO FRECORE;                                       0397
         B     FRECORE                                             0397
*              END;                                        /*@YL026YB*/
*            /********************************************************/
*            /*                                                      */
*            /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN  */
*            /* TABLE                                                */
*            /********************************************************/
*            ELSE                                                  0399
*              DO;                                         /*@YL026YB*/
@RF00329 DS    0H                                                  0400
*                DO I = 1 TO 8;                            /*@YL026YB*/
         LA    @14,1                                               0400
         ST    @14,I                                               0400
@DL00400 DS    0H                                                  0401
*                 IF RTNTABLE(I) = RETNCODE                        0401
*                   THEN                                           0401
         SLA   @14,2                                               0401
         L     @14,RTNTABLE-4(@14)                                 0401
         C     @14,RETNCODE                                        0401
         BNE   @RF00401                                            0401
*                    DO;                                   /*@YL026YB*/
*                    SWITCH = 1;                           /*@YL026YB*/
         MVC   SWITCH(2),@CH00051                                  0403
*                    CIRLOCRC = REG15;                     /*@YL026YB*/
         STC   REG15,CIRLOCRC(,CIRPTR)                             0404
*                    RETNCODE = 4;                         /*@YL026YB*/
         MVC   RETNCODE(4),@CF00190                                0405
*                    GOTO FRECORE;                         /*@YL026YB*/
         B     FRECORE                                             0406
*                    END;                                  /*@YL026YB*/
*                ELSE;                                     /*@YL026YB*/
@RF00401 DS    0H                                                  0409
*            END;                                          /*@YL026YB*/
*                                                                  0409
         LA    @14,1                                               0409
         AL    @14,I                                               0409
         ST    @14,I                                               0409
         CH    @14,@CH00055                                        0409
         BNH   @DL00400                                            0409
*            /********************************************************/
*            /*                                                      */
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */
*            /* TABLE, SET THE RETURN CODE TO 12                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0410
*            IF SWITCH ^= 1                                        0410
*              THEN                                                0410
         CLC   SWITCH(2),@CH00051                                  0410
         BE    @RF00410                                            0410
*                RETNCODE = 12;                            /*@YL026YB*/
         MVC   RETNCODE(4),@CF00123                                0411
*        END;                                              /*@YL026YB*/
*                                                                  0412
@RF00410 DS    0H                                                  0413
*        /************************************************************/
*        /*                                                          */
*        /* FREE TEMPORARY WORKAREA. RETURN TO CALLER                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0413
*FRECORE:REG1 = DPTR1;                                             0413
FRECORE  L     REG1,DPTR1                                          0413
*        REG0 = CORESIZE;                                          0414
         L     REG0,CORESIZE                                       0414
*        GEN (FREEMAIN R,LV=(0),A=(1));                            0415
         FREEMAIN R,LV=(0),A=(1)
*        IF RETNCODE = 0                                           0416
*          THEN                                                    0416
         ICM   @14,15,RETNCODE                                     0416
         BNZ   @RF00416                                            0416
*            DO;                                           /*@YL026YB*/
*              REG1 = DPTR;                                /*@YL026YB*/
         L     REG1,DPTR                                           0418
*              GEN (FREEMAIN R,LV=(0),A=(1));              /*@YL026YB*/
         FREEMAIN R,LV=(0),A=(1)
*              END;                                        /*@YL026YB*/
*        RFY (REG0,REG1) UNRSTD;                                   0421
*        END;                                              /*@YL026YB*/
*                                                                  0422
@EL00005 DS    0H                                                  0422
@EF00005 DS    0H                                                  0422
@ER00005 LM    @14,@12,@SA00005                                    0422
         BR    @14                                                 0422
*/********************************************************************/
*/*                                                                  */
*/* ENTRY05 IS THE PROCEDURE TO TAKE A 44 BYTE NAME AND ISSUE SVC 26 */
*/* FOR A VSAM LOCATE TO RETURN VOLUMN INFORMATION                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0423
*ENTRY05: PROCEDURE(SVNAME,FT1,FT2,USECNT);                /*@YL026YB*/
ENTRY05  STM   @14,@12,@SA00006                                    0423
         MVC   @PC00006(16),0(@01)                                 0423
*        DCL SVNAME          CHAR(45);/*NAME FROM LOCATE     @YL026YB*/
*        DCL FT1             FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/
*        DCL FT2             FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/
*        DCL USECNT          FIXED(15);/*LENGTH OF NAME      @YL026YB*/
*        /************************************************************/
*        /*                                                          */
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */
*        /*                                                          */
*        /************************************************************/
*        CTGSUPLT = OFF;                                   /*@YL026YB*/
         NI    CTGSUPLT(CTGPLPTR),B'11101111'                      0428
*        CTGGENLD = OFF;                                   /*@YL026YB*/
         NI    CTGGENLD(CTGPLPTR),B'11111110'                      0429
*        CTGFUNC = '001'B;                                 /*@YL026YB*/
         NI    CTGFUNC(CTGPLPTR),B'00111111'                       0430
         OI    CTGFUNC(CTGPLPTR),B'00100000'                       0430
*        COUNT = 0;                                        /*@YL026YB*/
         SLR   @14,@14                                             0431
         STH   @14,COUNT                                           0431
*        SWITCH = 0;                                       /*@YL026YB*/
         STH   @14,SWITCH                                          0432
*        CNT = 0;                                          /*@YL026YB*/
         STH   @14,CNT                                             0433
*        CNN = 0;                                          /*@YL026YB*/
         STH   @14,CNN                                             0434
*        RFY (REG1) RSTD;                                          0435
*                                                                  0435
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THE NAME FROM GENERIC LOCATE TO FIND ITS TRUE      */
*        /* LENGTH.POINT TO NAME AND WKAREA FOR CPL.USE MOVE         */
*        /* CHARACTER LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0436
*        DO COUNT = LENGTH(SVNAME) TO 1 BY -1              /*@YL026YB*/
*           WHILE(SVNAME(COUNT) = BLANK);                  /*@YL026YB*/
         LA    @14,45                                              0436
         STH   @14,COUNT                                           0436
@DL00436 L     @10,@PC00006                                        0436
         ALR   @10,@14                                             0436
         AL    @10,@CF00251                                        0436
         CLI   SVNAME(@10),X'40'                                   0436
         BNE   @DC00436                                            0436
*        END;                                              /*@YL026YB*/
         BCTR  @14,0                                               0437
         STH   @14,COUNT                                           0437
         LTR   @14,@14                                             0437
         BP    @DL00436                                            0437
@DC00436 DS    0H                                                  0438
*        GELENGTH = COUNT;                                 /*@YL026YB*/
         LH    @14,COUNT                                           0438
         STC   @14,GELENGTH                                        0438
*        GNAME = SVNAME(1:GELENGTH);                       /*@YL026YB*/
         MVI   GNAME+1,C' '                                        0439
         MVC   GNAME+2(42),GNAME+1                                 0439
         BCTR  @14,0                                               0439
         L     @10,@PC00006                                        0439
         EX    @14,@SM00327                                        0439
*        CALL MOVEINST(QUALDATA);                          /*@YL026YB*/
         L     @14,DPTR                                            0440
         LA    @14,QUALDATA(,@14)                                  0440
         ST    @14,@AL00001                                        0440
         LA    @01,@AL00001                                        0440
         BAL   @14,MOVEINST                                        0440
*        QUALN = LENGTH(QUALAREA);                         /*@YL026YB*/
         L     @14,DPTR                                            0441
         MVC   QUALN(2,@14),@CH00208                               0441
*        CTGENT = ADDR(GENAME);                            /*@YL026YB*/
         LA    @10,GENAME                                          0442
         ST    @10,CTGENT(,CTGPLPTR)                               0442
*        CTGWKA = DPTR;                                    /*@YL026YB*/
*                                                                  0443
         ST    @14,CTGWKA(,CTGPLPTR)                               0443
*        /************************************************************/
*        /*                                                          */
*        /* SET UP PARAMETER LIST FOR FPL                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0444
*        CTGNOFLD = 1;                                     /*@YL026YB*/
         MVI   CTGNOFLD(CTGPLPTR),X'01'                            0444
*        CTGFIELD(1) = ADDR(FPLSTOR);                      /*@YL026YB*/
         LA    @14,FPLSTOR                                         0445
         ST    @14,CTGFIELD(,CTGPLPTR)                             0445
*        CTGFLDNM = ADDR(ENNTRY);                          /*@YL026YB*/
         L     @14,CTGFLPTR                                        0446
         LA    @10,@CC00229                                        0446
         ST    @10,CTGFLDNM(,@14)                                  0446
*        CTGFLDNO = 1;                                     /*@YL026YB*/
         MVI   CTGFLDNO(@14),X'01'                                 0447
*        /************************************************************/
*        /*                                                          */
*        /* CALL SVC 26 FOR VSAM    LOCATE. ON RETURN CHECK RETURN   */
*        /* CODE                                                     */
*        /*                                                          */
*        /************************************************************/
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/
         LR    REG1,CTGPLPTR                                       0448
*        GENERATE (CATLG (1));                             /*@YL026YB*/
         CATLG (1)
*        RETNCODE = REG15;                                 /*@YL026YB*/
*                                                                  0450
         ST    REG15,RETNCODE                                      0450
*        /************************************************************/
*        /*                                                          */
*        /* IF RETURN CODE IS ZERO, COMPUTE THE VOLUMN COUNT.        */
*        /* MOVE VOLUMN INFORMATION TO USER WORK AREA                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0451
*        IF  RETNCODE = 0                                          0451
*          THEN                                                    0451
         L     @14,RETNCODE                                        0451
         LTR   @14,@14                                             0451
         BNZ   @RF00451                                            0451
*            DO;                                           /*@YL026YB*/
*              IF AREALN < RTNQLN                          /*@YL026YB*/
*                THEN                                      /*@YL026YB*/
         L     @14,CIRWA(,CIRPTR)                                  0453
         LH    @14,AREALN(,@14)                                    0453
         L     @10,DPTR                                            0453
         CH    @14,RTNQLN(,@10)                                    0453
         BNL   @RF00453                                            0453
*                  DO;                                     /*@YL026YB*/
*                    CIRLOCRC = 44;                        /*@YL026YB*/
         MVI   CIRLOCRC(CIRPTR),X'2C'                              0455
*                    RETURN CODE(4);                       /*@YL026YB*/
         LA    @15,4                                               0456
         L     @14,@SA00006                                        0456
         LM    @00,@12,@SA00006+8                                  0456
         BR    @14                                                 0456
*                  END;                                    /*@YL026YB*/
*              DATALN = RTNQLN;                            /*@YL026YB*/
@RF00453 L     @14,CIRWA(,CIRPTR)                                  0458
         L     @10,DPTR                                            0458
         MVC   DATALN(2,@14),RTNQLN(@10)                           0458
*              VOLCNT = CTGFLNG(1) / LENGTH(VOLAREA);      /*@YL026YB*/
         L     @09,CTGFLPTR                                        0459
         L     @04,CTGFLNG(,@09)                                   0459
         SRDA  @04,32                                              0459
         D     @04,@CF00145                                        0459
         STC   @05,VOLCNT                                          0459
*              CNT = USECNT + 2;                           /*@YL026YB*/
         L     @04,@PC00006+12                                     0460
         LA    @00,2                                               0460
         AH    @00,USECNT(,@04)                                    0460
         STH   @00,CNT                                             0460
*              CNN = COUNT;                                /*@YL026YB*/
         LH    @04,COUNT                                           0461
         STH   @04,CNN                                             0461
*              QULTYPE = '07'X;                            /*@YL026YB*/
         MVI   QULTYPE,X'07'                                       0462
*              QULPTR = ADDR(QUALDATA);                    /*@YL026YB*/
         LA    @10,QUALDATA(,@10)                                  0463
         ST    @10,QULPTR                                          0463
*              QULBUF = SVNAME;                            /*@YL026YB*/
         L     @10,@PC00006                                        0464
         MVC   QULBUF(45),SVNAME(@10)                              0464
*              QULNAME = QUALIFY(CNT:CNN);                 /*@YL026YB*/
         MVI   QULNAME+1,C' '                                      0465
         MVC   QULNAME+2(6),QULNAME+1                              0465
         SLR   @04,@00                                             0465
         LR    @10,@00                                             0465
         LA    @09,QUALIFY-1(@10)                                  0465
         EX    @04,@SM00329                                        0465
*              DATAREA(FT1:FT2) = TYPE01;                  /*@YL026YB*/
         L     @10,@PC00006+4                                      0466
         LH    @10,FT1(,@10)                                       0466
         ALR   @10,@14                                             0466
         L     @04,@PC00006+8                                      0466
         LH    @04,FT2(,@04)                                       0466
         L     @09,@PC00006+4                                      0466
         LH    @09,FT1(,@09)                                       0466
         LCR   @09,@09                                             0466
         ALR   @09,@04                                             0466
         EX    @09,@SM00313                                        0466
*              FIRST = FT2 + 1;                            /*@YL026YB*/
         LA    @10,1                                               0467
         ALR   @04,@10                                             0467
         STH   @04,FIRST                                           0467
*              DATAREA(FIRST) = VOLCNT;                    /*@YL026YB*/
         STC   @05,DATAREA-1(@04,@14)                              0468
*              LAST = FIRST;                               /*@YL026YB*/
         STH   @04,LAST                                            0469
*              DO  J = 1 TO VOLCNT;                        /*@YL026YB*/
         B     @DE00470                                            0470
@DL00470 DS    0H                                                  0471
*              FIRST = LAST + 1;                           /*@YL026YB*/
         LA    @14,1                                               0471
         AH    @14,LAST                                            0471
         STH   @14,FIRST                                           0471
*              LAST = FIRST + (LENGTH(VOLDATA) - 1);       /*@YL026YB*/
         LA    @00,11                                              0472
         ALR   @00,@14                                             0472
         STH   @00,LAST                                            0472
*              VOLAREA = CTGFLPT(1)->VOLBLK(1:LENGTH(VOLAREA));    0473
         L     @09,CTGFLPTR                                        0473
         L     @08,CTGFLPT(,@09)                                   0473
         MVC   VOLAREA(15),VOLBLK(@08)                             0473
*              DATAREA(FIRST:LAST) = VOLDATA;              /*@YL026YB*/
         L     @07,CIRWA(,CIRPTR)                                  0474
         ALR   @07,@14                                             0474
         SLR   @00,@14                                             0474
         LR    @14,@00                                             0474
         EX    @14,@SM00317                                        0474
*              CTGFLPT(1) = CTGFLPT(1) + LENGTH(VOLDATA);  /*@YL026YB*/
         AH    @08,@CH00123                                        0475
         ST    @08,CTGFLPT(,@09)                                   0475
*              END;                                        /*@YL026YB*/
*                                                                  0476
         AH    @10,@CH00051                                        0476
@DE00470 ST    @10,J                                               0476
         SLR   @14,@14                                             0476
         IC    @14,VOLCNT                                          0476
         CR    @10,@14                                             0476
         BNH   @DL00470                                            0476
*              /******************************************************/
*              /* RESET SUBSTRING COUNT                              */
*              /******************************************************/
*                                                                  0477
*              FT2 = LAST;                                 /*@YL026YB*/
         L     @14,@PC00006+8                                      0477
         MVC   FT2(2,@14),LAST                                     0477
*              RETURN CODE(0);                             /*@YL026YB*/
         SLR   @15,@15                                             0478
         L     @14,@SA00006                                        0478
         LM    @00,@12,@SA00006+8                                  0478
         BR    @14                                                 0478
*              END;                                        /*@YL026YB*/
*            /********************************************************/
*            /*                                                      */
*            /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN  */
*            /* TABLE                                                */
*            /********************************************************/
*            ELSE                                                  0480
*              DO;                                         /*@YL026YB*/
@RF00451 DS    0H                                                  0481
*                DO I = 1 TO 8;                            /*@YL026YB*/
         LA    @14,1                                               0481
         ST    @14,I                                               0481
@DL00481 DS    0H                                                  0482
*              IF RTNTABLE(I) = RETNCODE                           0482
*                THEN                                              0482
         SLA   @14,2                                               0482
         L     @14,RTNTABLE-4(@14)                                 0482
         C     @14,RETNCODE                                        0482
         BNE   @RF00482                                            0482
*                  DO;                                     /*@YL026YB*/
*                    SWITCH = 1;                           /*@YL026YB*/
         MVC   SWITCH(2),@CH00051                                  0484
*                    CIRLOCRC = REG15;                     /*@YL026YB*/
         STC   REG15,CIRLOCRC(,CIRPTR)                             0485
*                    RETURN CODE(4);                       /*@YL026YB*/
         LA    @15,4                                               0486
         L     @14,@SA00006                                        0486
         LM    @00,@12,@SA00006+8                                  0486
         BR    @14                                                 0486
*                  END;                                    /*@YL026YB*/
*                ELSE;                                     /*@YL026YB*/
@RF00482 DS    0H                                                  0489
*            END;                                          /*@YL026YB*/
*                                                                  0489
         LA    @14,1                                               0489
         AL    @14,I                                               0489
         ST    @14,I                                               0489
         CH    @14,@CH00055                                        0489
         BNH   @DL00481                                            0489
*            /********************************************************/
*            /*                                                      */
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */
*            /* TABLE, SET THE RETURN CODE TO 12                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0490
*            IF SWITCH ^= 1                                        0490
*              THEN                                                0490
         CLC   SWITCH(2),@CH00051                                  0490
         BE    @RF00490                                            0490
*                RETURN CODE(12);                          /*@YL026YB*/
         LA    @15,12                                              0491
         L     @14,@SA00006                                        0491
         LM    @00,@12,@SA00006+8                                  0491
         BR    @14                                                 0491
*        END;                                              /*@YL026YB*/
*        END;                                              /*@YL026YB*/
*                                                                  0493
@EL00006 DS    0H                                                  0493
@EF00006 DS    0H                                                  0493
@ER00006 LM    @14,@12,@SA00006                                    0493
         BR    @14                                                 0493
*/********************************************************************/
*/*                                                                  */
*/* THIS PROCEDURE MOVES BLANKS INTO A WORKAREA GREATER THAN 256     */
*/* BYTES. IT USES THE MVCL INSTRUCTION BY SETTING UP EVEN -ODD      */
*/* PAIRS OF REGISTERS                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0494
*MOVEINST: PROCEDURE(PARM1);                               /*@YL026YB*/
MOVEINST STM   @14,@12,12(@13)                                     0494
         MVC   @PC00007(4),0(@01)                                  0494
*        DCL PARM1                 CHAR(4996); /*WORK AREA   @YL026YB*/
*        DCL R4                    REG(4)  PTR  RSTD;/*WKAREA PTR    */
*        DCL R5                    REG(5)       RSTD;/*WKAREA LENGTH */
*        DCL R6                    REG(6)  PTR  RSTD;/*DATA POINTER  */
*        DCL R7                    REG(7)       RSTD;/*DATA + LENGTH */
*                                                                  0499
*        /************************************************************/
*        /*                                                          */
*        /* SET UP REGISTERS FOR THE MVCL INSTRUCTION,THEN FREE      */
*        /* THE REGISTERS.                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0500
*        R4 = ADDR(PARM1);                                         0500
         L     R4,@PC00007                                         0500
*        R5 = LENGTH(PARM1);                                       0501
         LH    R5,@CH00215                                         0501
*        R6 = ADDR(BLANK);                                         0502
         LA    R6,@CB00160                                         0502
*        R7 = '40000001'X;                                         0503
         L     R7,@CF00304                                         0503
*        MVCL  (R4,R6);                                            0504
         MVCL  R4,R6                                               0504
*        RESPECIFY(R4,R5,R6,R7) UNRSTD;                            0505
*        END;                                                      0506
@EL00007 DS    0H                                                  0506
@EF00007 DS    0H                                                  0506
@ER00007 LM    @14,@12,12(@13)                                     0506
         BR    @14                                                 0506
@PB00007 DS    0H                                                  0507
*        RETURN CODE(RETNCODE);                            /*@YL026YB*/
         L     @10,RETNCODE                                        0507
         L     @13,4(,@13)                                         0507
         L     @00,@SIZDATD                                        0507
         LR    @01,@11                                             0507
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@10                                             0507
         L     @14,12(,@13)                                        0507
         LM    @00,@12,20(@13)                                     0507
         BR    @14                                                 0507
*        END IKJEHCIR                                      /*@YL026YB*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*;                                                                 0508
@DATA    DS    0H
@CH00051 DC    H'1'
@CH00090 DC    H'3'
@CH00055 DC    H'8'
@CH00279 DC    H'9'
@CH00183 DC    H'44'
@CH00215 DC    H'4996'
@CH00208 DC    H'5000'
@SM00307 MVC   GNAME(0),USENAME(@10)
@SM00311 MVC   QULNAME(0),0(@03)
@SM00313 MVC   DATAREA-1(0,@10),TYPE01
@SM00317 MVC   DATAREA-1(0,@07),VOLDATA
@SM00321 MVC   GNAME(0),SAVNAME
@SM00323 MVC   DATAREA-1(0,@10),SAVNAME
@SM00325 MVC   DATAREA-1(0,@06),VOLDATA
@SM00327 MVC   GNAME(0),SVNAME(@10)
@SM00329 MVC   QULNAME(0),0(@09)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00005 DS    15F
@PC00007 DS    1F
@SA00006 DS    15F
@PC00006 DS    4F
@AL00001 DS    4A
IKJEHCIR CSECT
         DS    0F
@CF00190 DC    F'4'
@CH00190 EQU   @CF00190+2
@CF00123 DC    F'12'
@CH00123 EQU   @CF00123+2
@CF00145 DC    F'15'
@CH00145 EQU   @CF00145+2
@CF00206 DC    F'45'
@CH00206 EQU   @CF00206+2
@CF00251 DC    F'-1'
@CF00176 DC    XL4'01000000'
@CF00304 DC    XL4'40000001'
@DATD    DSECT
         DS    0D
CTGFLPTR DS    A
CORESIZE DS    F
RETNCODE DS    F
WKPTR    DS    A
DPTR     DS    A
DPTR1    DS    A
QULPTR   DS    A
I        DS    F
J        DS    F
K        DS    F
SWITCH   DS    H
CONTROL  DS    H
RET05    DS    H
RET06    DS    H
FIRST    DS    H
LAST     DS    H
COUNT    DS    H
CNT      DS    H
CNN      DS    H
SAVCNT   DS    H
FS1      DS    H
FS2      DS    H
N1       DS    H
N2       DS    H
LIMIT    DS    H
VOLCNT   DS    FL1
         DS    CL1
CPLSTOR  DS    CL32
         ORG   CPLSTOR
@NM00007 DS    CL28
@NM00008 DS    CL4
         ORG   CPLSTOR+32
FPLSTOR  DS    CL24
         ORG   FPLSTOR
@NM00009 DS    CL16
@NM00010 DS    CL8
         ORG   FPLSTOR+24
GENAME   DS    CL45
         ORG   GENAME
GELENGTH DS    CL1
GNAME    DS    CL44
         ORG   GENAME+45
TYPE01   DS    CL9
         ORG   TYPE01
QULTYPE  DS    CL1
QULNAME  DS    CL8
         ORG   TYPE01+9
         DS    CL2
QULBUF   DS    CL45
         ORG   QULBUF
@NM00011 DS    CL1
QUALIFY  DS    CL44
         ORG   QULBUF+45
VOLAREA  DS    CL15
         ORG   VOLAREA
@NM00012 DS    CL2
VOLDATA  DS    CL12
         ORG   VOLDATA
DEVTYPE  DS    CL4
VOLSER   DS    CL6
FSEQ     DS    CL2
         ORG   VOLAREA+14
@NM00013 DS    CL1
         ORG   VOLAREA+15
SAVNAME  DS    CL45
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEHCIR CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00229 DC    C'CATVOL  '
@CB00160 DC    X'40'
FIXAREA  DS    CL300
         ORG   FIXAREA
@NM00014 DC    150X'00'
@NM00015 DC    150X'00'
         ORG   FIXAREA+300
         DS    CL3
RTNTABLE DC    F'4'
         DC    F'8'
         DC    F'24'
         DC    F'32'
         DC    F'36'
         DC    F'44'
         DC    F'56'
         DC    F'188'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENDBYTE  EQU   @03
CTGPLPTR EQU   @03
REG0     EQU   @00
REG1     EQU   @01
REG15    EQU   @15
CIRPTR   EQU   @02
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
CIRPARM  EQU   0
CIROPT   EQU   CIRPARM
CIRLOCRC EQU   CIRPARM+3
CIRSRCH  EQU   CIRPARM+4
CIRVOL   EQU   CIRPARM+8
CIRWA    EQU   CIRPARM+12
CIRPSWD  EQU   CIRPARM+20
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGGENLD EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
WORKAREA EQU   0
AREALN   EQU   WORKAREA
DATALN   EQU   WORKAREA+2
DATAREA  EQU   WORKAREA+4
USENAME  EQU   0
TEMBLK   EQU   0
WORKTEMP EQU   0
TEMLN    EQU   WORKTEMP
TEMRTLN  EQU   WORKTEMP+2
TEMPDATA EQU   WORKTEMP+4
QUALAREA EQU   0
QUALN    EQU   QUALAREA
RTNQLN   EQU   QUALAREA+2
QUALDATA EQU   QUALAREA+4
DATABLK  EQU   0
VOLBLK   EQU   0
SVNAME   EQU   0
FT1      EQU   0
FT2      EQU   0
USECNT   EQU   0
PARM1    EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGFLCHN EQU   CTGFL+12
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00006 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
@NM00005 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGTYPE  EQU   CTGPL+18
@NM00004 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
CTGFVT   EQU   CTGENT
@NM00003 EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
@NM00002 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGRCATN EQU   CTGVMNT
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
CIRSAVE  EQU   CIRPARM+16
@NM00001 EQU   CIRPARM+1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00135 EQU   BYPASS
@RC00192 EQU   @EL00003
@RF00207 EQU   @EL00003
@RF00416 EQU   @EL00005
@RF00490 EQU   @EL00006
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@RC00078 EQU   @PB00002
@RC00076 EQU   @PB00002
@RC00074 EQU   @PB00002
@ENDDATA EQU   *
         END   IKJEHCIR,(C'PLS0408',0602,74346)

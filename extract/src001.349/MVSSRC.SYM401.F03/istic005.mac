         TITLE 'ISTIC005-OPTION DECODE                                 *
                        '
ISTIC005 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISTIC005  75.184'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
*   R3=R13;                                                        0047
         LR    R3,R13                                              0047
*   R13=ADDR(SVEIC003);                                            0048
         LA    R13,SVEIC003(,WAPTR)                                0048
*   BACKSAVE(3)=R13;                                               0049
         ST    R13,BACKSAVE+8(,R3)                                 0049
*   SVEIC003(2)=R3;                                                0050
         ST    R3,SVEIC003+4(,WAPTR)                               0050
*   OPTS=A33OPTN;                   /* MOVE OPTIONS TO WORK          */
         MVC   OPTS(44),A33OPTN                                    0051
*   IF $OPTMSG='1'B THEN            /* OPTION MSG REQUESTED ?        */
         TM    $OPTMSG(WAPTR),B'10000000'                          0052
         BNO   @RF00052                                            0052
*     DO;                           /* SET UP OPTIONS ARE MSG        */
*       EBTL='N';                                                  0054
         MVI   EBTL,C'N'                                           0054
*       IF $LOOPTST='1'B THEN       /* TEST LOOP (TL)                */
         TM    $LOOPTST(WAPTR),B'00000001'                         0055
         BNO   @RF00055                                            0055
*         EBTL=' ';                                                0056
         MVI   EBTL,C' '                                           0056
*       EBEL='N';                                                  0057
@RF00055 MVI   EBEL,C'N'                                           0057
*       IF $LOOPERR='1'B THEN       /* ERROR LOOP (EL)               */
         TM    $LOOPERR(WAPTR),B'00000010'                         0058
         BNO   @RF00058                                            0058
*         EBEL=' ';                                                0059
         MVI   EBEL,C' '                                           0059
*       EBPP='N';                                                  0060
@RF00058 MVI   EBPP,C'N'                                           0060
*       IF $ALTPRNT='1'B THEN       /* PARALLEL PRINT (PP)           */
         TM    $ALTPRNT(WAPTR),B'00010000'                         0061
         BNO   @RF00061                                            0061
*         EBPP=' ';                                                0062
         MVI   EBPP,C' '                                           0062
*       EBFE='N';                                                  0063
@RF00061 MVI   EBFE,C'N'                                           0063
*       IF $FSTCOMM='1'B THEN       /* FIRST ERROR COMM. (FE)        */
         TM    $FSTCOMM(WAPTR),B'00000001'                         0064
         BNO   @RF00064                                            0064
*         EBFE=' ';                                                0065
         MVI   EBFE,C' '                                           0065
*       EBMI='N';                                                  0066
@RF00064 MVI   EBMI,C'N'                                           0066
*       IF $MANINTV='1'B THEN       /* MANUAL INTERVENT (MI)         */
         TM    $MANINTV(WAPTR),B'10000000'                         0067
         BNO   @RF00067                                            0067
*         EBMI=' ';                                                0068
         MVI   EBMI,C' '                                           0068
*       EBEP='N';                                                  0069
@RF00067 MVI   EBEP,C'N'                                           0069
*       IF $NERRPRT='0'B THEN       /* ERROR PRINT (EP)              */
         TM    $NERRPRT(WAPTR),B'00000100'                         0070
         BNZ   @RF00070                                            0070
*         EBEP=' ';                                                0071
         MVI   EBEP,C' '                                           0071
*       EBCP='N';                                                  0072
@RF00070 MVI   EBCP,C'N'                                           0072
*       IF $NOCNTRL='1'B THEN       /* CONTROL PRINT (CP)            */
         TM    $NOCNTRL(WAPTR),B'00001000'                         0073
         BNO   @RF00073                                            0073
*         EBCP=' ';                                                0074
         MVI   EBCP,C' '                                           0074
*       EBPR='N';                                                  0075
@RF00073 MVI   EBPR,C'N'                                           0075
*       IF $NOPRT='1'B THEN         /* PRINT (PR)                    */
         TM    $NOPRT(WAPTR),B'00000100'                           0076
         BNO   @RF00076                                            0076
*         EBPR=' ';                                                0077
         MVI   EBPR,C' '                                           0077
*       EBTR='N';                                                  0078
@RF00076 MVI   EBTR,C'N'                                           0078
*       IF $TRACE='1'B THEN         /* TRACE (TR)                    */
         TM    $TRACE(WAPTR),B'00000100'                           0079
         BNO   @RF00079                                            0079
*         EBTR=' ';                                                0080
         MVI   EBTR,C' '                                           0080
*       EBAP='N';                                                  0081
@RF00079 MVI   EBAP,C'N'                                           0081
*       IF $ALTPRTR='1'B THEN       /* ALTERNATE PRINT (AP)          */
         TM    $ALTPRTR(WAPTR),B'00000010'                         0082
         BNO   @RF00082                                            0082
*         EBAP=' ';                                                0083
         MVI   EBAP,C' '                                           0083
*       $INBUFR(1:43)=OPTS;         /* MOVE OPTIONS FOR CECOM        */
*                                                                  0084
@RF00082 MVC   $INBUFR(43,WAPTR),OPTS                              0084
*       /*************************************************************/
*       /*                                                           */
*       /* TCEC MSGN(107)SUB(YES) INVOKED                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0085
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */
         OI    $TCECM(WAPTR),B'00000001'                           0085
*       R1=ADDR($TCA09);            /* SET UP PARM LIST $TR          */
         LA    R1,$TCA09                                           0086
*       CALL #EXIT;                 /* CALL CECOM                    */
         L     @15,#EXITA(,WAPTR)                                  0087
         BALR  @14,@15                                             0087
*       DCL                                                        0088
*         1 $TCA09,                 /* TCEC PARM LIST                */
*          2 $TCB09 FIXED(32) INIT(107),/* MSG NUMBER                */
*          2 $TCC09 FIXED(32) INIT(0),/* INCT LEN                    */
*          2 $TCD09 BIT(8) INIT('10000000'B),/* FLAG                 */
*          2 $TCE09 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ISSUE 0088
*                                      OPTIONS ARE ....              */
*       R3=$EXTA(1);                /* GET EXTERNAL DATA SIZE        */
         SLR   R3,R3                                               0089
         IC    R3,$EXTA(,WAPTR)                                    0089
*       IF R3^=0 THEN               /* IF EXT= HAS BEEN ENTER        */
         LTR   R3,R3                                               0090
         BZ    @RF00090                                            0090
*         DO;                       /* THEN SET UP TO WRITE NS       */
*           R4=R3+1;                                               0092
         LA    R4,1                                                0092
         ALR   R4,R3                                               0092
*           $INBUFR(1:54)='';                                      0093
         MVI   $INBUFR(WAPTR),C' '                                 0093
         MVC   $INBUFR+1(53,WAPTR),$INBUFR(WAPTR)                  0093
*           $INBUFR(1:R3)=$EXTA(2:R4);                             0094
*                                                                  0094
         LR    @14,R3                                              0094
         BCTR  @14,0                                               0094
         EX    @14,@SM00858                                        0094
*           /*********************************************************/
*           /*                                                       */
*           /* TCEC MSGN(327)SUB(YES) INVOKED                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0095
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */
         OI    $TCECM(WAPTR),B'00000001'                           0095
*           R1=ADDR($TCA10);        /* SET UP PARM LIST $TR          */
         LA    R1,$TCA10                                           0096
*           CALL #EXIT;             /* CALL CECOM                    */
         L     @15,#EXITA(,WAPTR)                                  0097
         BALR  @14,@15                                             0097
*           DCL                                                    0098
*             1 $TCA10,             /* TCEC PARM LIST                */
*              2 $TCB10 FIXED(32) INIT(327),/* MSG NUMBER            */
*              2 $TCC10 FIXED(32) INIT(0),/* INCT LEN                */
*              2 $TCD10 BIT(8) INIT('10000000'B),/* FLAG             */
*              2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK   0098
*                                      ISSUE EXT= MSG                */
*         END;                                                     0099
*       $OPTMSG='0'B;               /* RESET OPT MESSAGE SWT         */
@RF00090 NI    $OPTMSG(WAPTR),B'01111111'                          0100
*       GO TO OPT900;                                              0101
         B     OPT900                                              0101
*     END;                                                         0102
*   R3=$SLASHAD(2)+1;               /* PT TO 1ST CHAR OF OPTS        */
@RF00052 LA    R3,1                                                0103
         AL    R3,$SLASHAD+4(,WAPTR)                               0103
*   IF R3=$SLASHAD(3) THEN          /* SLASH ENTERED ?               */
         C     R3,$SLASHAD+8(,WAPTR)                               0104
         BE    @RT00104                                            0104
*     GO TO OPT900;                                                0105
*   A33SAVE=A33SAVE&&A33SAVE;       /* CLEAR SAVE AREA               */
         XC    A33SAVE(11),A33SAVE                                 0106
*   A33SAVE(1)=$TESTOPT;            /* SAVE                          */
         MVC   A33SAVE(1),$TESTOPT(WAPTR)                          0107
*   A33SAVE(2)=$ERROPT;             /* OLD                           */
         MVC   A33SAVE+1(1),$ERROPT(WAPTR)                         0108
*   A33SAVE(3)=$EXECFLG;            /* OPTIONS                       */
         MVC   A33SAVE+2(1),$EXECFLG(WAPTR)                        0109
*   A33SAVE(4)=$OLTFLGS;            /* AND                           */
         MVC   A33SAVE+3(1),$OLTFLGS(WAPTR)                        0110
*   A33SAVE(5)=$PRNTLVL;            /* CONSTANTS                     */
         MVC   A33SAVE+4(1),$PRNTLVL(WAPTR)                        0111
*   A33SAVE(6:7)=$ERRCNTA;          /*                               */
         MVC   A33SAVE+5(2),$ERRCNTA(WAPTR)                        0112
*   A33SAVE(8:9)=$TLCNT;                                           0113
         MVC   A33SAVE+7(2),$TLCNT(WAPTR)                          0113
*   A33SAVE(10)=$FLAG9;                                            0114
         MVC   A33SAVE+9(1),$FLAG9(WAPTR)                          0114
*   INTFLAGS=INTFLAGS&&INTFLAGS;    /* INIT INTERNAL FLAGS           */
         XC    INTFLAGS(1),INTFLAGS                                0115
*                                                                  0116
*   /*****************************************************************/
*   /*                                                               */
*   /* DECODE OPTION FIELD                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0116
*OPT050:                                                           0116
*   NO='0'B;                        /* SET NEGATIVE OPT FLAG         */
OPT050   NI    NO,B'01111111'                                      0116
*   IF INPUTBUF(1)='N' THEN         /* CHK 1ST CHAR= N               */
         CLI   INPUTBUF(R3),C'N'                                   0117
         BNE   @RF00117                                            0117
*     DO;                                                          0118
*       NO='1'B;                    /* YES SET FLAG ON               */
         OI    NO,B'10000000'                                      0119
*       R3=R3+1;                    /* PT TO OPTION                  */
         AL    R3,@CF00072                                         0120
*     END;                                                         0121
*   IF INPUTBUF(1:2)='TL' THEN      /* TEST LOOP SPECIFIED           */
@RF00117 CLC   INPUTBUF(2,R3),@CC00761                             0122
         BNE   @RF00122                                            0122
*     DO;                           /* YES                           */
*       IF NO='0'B THEN             /* NTL SPECIFIED                 */
         TM    NO,B'10000000'                                      0124
         BZ    @RT00124                                            0124
*         GO TO OPT300;             /* NO,PROCESS TL                 */
*       $LOOPTST='0'B;              /* TURN TL OFF                   */
         NI    $LOOPTST(WAPTR),B'11111110'                         0126
*       $TLCNT=1;                   /* INITIALIZE COUNT              */
         MVC   $TLCNT(2,WAPTR),@CH00072                            0127
*       GO TO OPT070;               /* SET UP TO DECODE NEXT         */
         B     OPT070                                              0128
*     END;                                                         0129
*   IF INPUTBUF(1:2)='EL' THEN      /* ERROR LOOP SPECIFIED          */
@RF00122 CLC   INPUTBUF(2,R3),@CC00764                             0130
         BNE   @RF00130                                            0130
*     DO;                           /* YES                           */
*       IF NO='0'B THEN             /* NEL SPECIFIED                 */
         TM    NO,B'10000000'                                      0132
         BZ    @RT00132                                            0132
*         GO TO OPT200;             /* NO,PROCESS EL                 */
*       $LOOPERR='0'B;              /* TURN EL OFF                   */
         NI    $LOOPERR(WAPTR),B'11111101'                         0134
*       GO TO OPT070;               /* SET UP TO DECODE NEXT         */
         B     OPT070                                              0135
*     END;                                                         0136
*   IF INPUTBUF(1:2)='PP' THEN      /* PARALLEL PRINT SPECIFED       */
@RF00130 CLC   INPUTBUF(2,R3),@CC00766                             0137
         BNE   @RF00137                                            0137
*     DO;                           /* YES                           */
*       IF NO='0'B THEN             /* NPP SPECIFIED                 */
         TM    NO,B'10000000'                                      0139
         BZ    @RT00139                                            0139
*         GO TO OPT100;             /* NO PROCESS PP                 */
*       $ALTPRNT='0'B;              /* TURN OFF PP                   */
         NI    $ALTPRNT(WAPTR),B'11101111'                         0141
*       GO TO OPT070;               /* SET UP TO DECODE NEXT         */
         B     OPT070                                              0142
*     END;                                                         0143
*   IF INPUTBUF(1:2)='AP'&$OLTACT='0'B THEN/* ALTERNATE PRINTER      */
@RF00137 CLC   INPUTBUF(2,R3),@CC00768                             0144
         BNE   @RF00144                                            0144
         TM    $OLTACT(WAPTR),B'00000001'                          0144
         BNZ   @RF00144                                            0144
*     DO;                           /* YES                           */
*       GO TO OPT400;                                              0146
         B     OPT400                                              0146
*     END;                                                         0147
*   IF INPUTBUF(1:2)='FE' THEN      /* FIRST ERROR COMM              */
@RF00144 CLC   INPUTBUF(2,R3),@CC00770                             0148
         BNE   @RF00148                                            0148
*     DO;                           /* YES                           */
*       $FSTCOMM='0'B;              /* SET NFE                       */
         NI    $FSTCOMM(WAPTR),B'11111110'                         0150
*       IF NO='0'B THEN             /* FE SPECIFIED                  */
         TM    NO,B'10000000'                                      0151
         BNZ   @RF00151                                            0151
*         $FSTCOMM='1'B;            /* YES                           */
         OI    $FSTCOMM(WAPTR),B'00000001'                         0152
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0153
*     END;                                                         0154
*   IF INPUTBUF(1:2)='MI' THEN      /* MANUAL INTERVENTION           */
@RF00148 CLC   INPUTBUF(2,R3),@CC00771                             0155
         BNE   @RF00155                                            0155
*     DO;                           /* YES                           */
*       $MANINTV='0'B;              /* SET NMI                       */
         NI    $MANINTV(WAPTR),B'01111111'                         0157
*       IF NO='0'B THEN             /* MI SPECIFIED                  */
         TM    NO,B'10000000'                                      0158
         BNZ   @RF00158                                            0158
*         $MANINTV='1'B;            /* YES                           */
         OI    $MANINTV(WAPTR),B'10000000'                         0159
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0160
*     END;                                                         0161
*   IF INPUTBUF(1:2)='EP' THEN      /* ERROR PRINT                   */
@RF00155 CLC   INPUTBUF(2,R3),@CC00772                             0162
         BNE   @RF00162                                            0162
*     DO;                           /* YES                           */
*       $NERRPRT='1'B;              /* SET NEP                       */
         OI    $NERRPRT(WAPTR),B'00000100'                         0164
*       IF NO='0'B THEN             /* EP SPECIFIED                  */
         TM    NO,B'10000000'                                      0165
         BNZ   @RF00165                                            0165
*         $NERRPRT='0'B;            /* YES                           */
         NI    $NERRPRT(WAPTR),B'11111011'                         0166
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0167
*     END;                                                         0168
*   IF INPUTBUF(1:2)='CP' THEN      /* CONTROL PRINT                 */
@RF00162 CLC   INPUTBUF(2,R3),@CC00773                             0169
         BNE   @RF00169                                            0169
*     DO;                           /* YES                           */
*       $NOCNTRL='0'B;              /* SET NCP                       */
         NI    $NOCNTRL(WAPTR),B'11110111'                         0171
*       IF NO='0'B THEN             /* CP SPECIFIED                  */
         TM    NO,B'10000000'                                      0172
         BNZ   @RF00172                                            0172
*         $NOCNTRL='1'B;            /* YES                           */
         OI    $NOCNTRL(WAPTR),B'00001000'                         0173
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0174
*     END;                                                         0175
*   IF INPUTBUF(1:2)='PR' THEN      /* PRINT                         */
@RF00169 CLC   INPUTBUF(2,R3),@CC00774                             0176
         BNE   @RF00176                                            0176
*     DO;                           /* YES                           */
*       $NOPRT='0'B;                /* SET NPR                       */
         NI    $NOPRT(WAPTR),B'11111011'                           0178
*       IF NO='0'B THEN             /* PR SPECIFIED                  */
         TM    NO,B'10000000'                                      0179
         BNZ   @RF00179                                            0179
*         $NOPRT='1'B;              /* YES                           */
         OI    $NOPRT(WAPTR),B'00000100'                           0180
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0181
*     END;                                                         0182
*   IF INPUTBUF(1:2)='TR' THEN      /* TRACE                         */
@RF00176 CLC   INPUTBUF(2,R3),@CC00775                             0183
         BNE   @RF00183                                            0183
*     DO;                           /* YES                           */
*       $TRACE='0'B;                /* SET NTR                       */
         NI    $TRACE(WAPTR),B'11111011'                           0185
*       IF NO='0'B THEN             /* TR SPECIFIED                  */
         TM    NO,B'10000000'                                      0186
         BNZ   @RF00186                                            0186
*         $TRACE='1'B;              /* YES                           */
         OI    $TRACE(WAPTR),B'00000100'                           0187
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0188
*     END;                                                         0189
*   IF INPUTBUF(1:4)='EXT=' THEN    /* EXTERNAL DATA                 */
@RF00183 CLC   INPUTBUF(4,R3),@CC00776                             0190
         BNE   @RF00190                                            0190
*     DO;                           /* YES                           */
*       R3=R3+4;                    /* POINT TO DATA                 */
         AL    R3,@CF00068                                         0192
*       IF INPUTBUF(1)='/' THEN     /* END OF OPTION FIELD           */
         CLI   INPUTBUF(R3),C'/'                                   0193
         BNE   @RF00193                                            0193
*         DO;                       /* YES,CONTINUE                  */
*           $EXTA=$EXTA&&$EXTA;     /* INIT EXTERNAL DATA AREA       */
         XC    $EXTA(56,WAPTR),$EXTA(WAPTR)                        0195
*           GO TO OPT080;           /* CHECK FOR END OF FIELD        */
         B     OPT080                                              0196
*         END;                                                     0197
*       R4=$SLASHAD(3)-R3;          /* CALCULATE LENGTH              */
@RF00193 L     R4,$SLASHAD+8(,WAPTR)                               0198
         SLR   R4,R3                                               0198
*       IF R4<1×                    /* CHECK FOR                     */
*           R4>54 THEN              /* VALID LENGTH                  */
         LA    @14,1                                               0199
         CR    R4,@14                                              0199
         BL    @RT00199                                            0199
         C     R4,@CF00750                                         0199
         BH    @RT00199                                            0199
*         GO TO OPT800;             /* INVALID LENGTH                */
*       $EXTA=$EXTA&&$EXTA;         /* CLEAR AREA                    */
         XC    $EXTA(56,WAPTR),$EXTA(WAPTR)                        0201
*       EXTNUMFX=R4;                /* MOVE COUNT                    */
         ST    R4,EXTNUMFX                                         0202
*       $EXTA(1)=EXTNUMCH;          /* INTO FIRST BYTE               */
         MVC   $EXTA(1,WAPTR),EXTNUMCH                             0203
*       R4=R4+1;                    /* ADD 1 FOR SUBSCRIPT           */
         ALR   R4,@14                                              0204
*       $EXTA(2:R4)=INPUTBUF;       /* MOVE IN DATA                  */
         LR    @14,R4                                              0205
         BCTR  @14,0                                               0205
         BCTR  @14,0                                               0205
         EX    @14,@SM00868                                        0205
*       R3=R3+EXTNUMFX;                                            0206
         L     @14,EXTNUMFX                                        0206
         ALR   R3,@14                                              0206
*       GO TO OPT080;               /* CHK FOR MUTALLY EXCL          */
         B     OPT080                                              0207
*     END;                                                         0208
*   R3=R3+1;                        /* PT TO INVALID OPTION          */
@RF00190 AL    R3,@CF00072                                         0209
*   GO TO OPT800;                   /* ERROR,INVALID OPTION          */
         B     OPT800                                              0210
*OPT070:                                                           0211
*   R3=R3+2;                        /* PT TO NEXT ENTRY              */
OPT070   AL    R3,@CF00137                                         0211
*OPT075:                                                           0212
*   IF INPUTBUF(1)=',' THEN         /* IS IT A COMMA                 */
OPT075   CLI   INPUTBUF(R3),C','                                   0212
         BNE   @RF00212                                            0212
*     DO;                                                          0213
*       R3=R3+1;                    /* PT TO NEXT OPTION             */
         AL    R3,@CF00072                                         0214
*       GO TO OPT050;               /* DEODE NEXT ENTRY              */
         B     OPT050                                              0215
*     END;                                                         0216
*OPT080:                                                           0217
*   IF INPUTBUF(1)='/' THEN         /* END OF OPT FIELD              */
@RF00212 DS    0H                                                  0217
OPT080   CLI   INPUTBUF(R3),C'/'                                   0217
         BE    @RT00217                                            0217
*     GO TO OPT900;                 /* YES,RETURN                    */
*   GO TO OPT800;                   /* NO,ERROR                      */
         B     OPT800                                              0219
*                                                                  0220
*   /*****************************************************************/
*   /*                                                               */
*   /* PP OPTION ENTRY                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0220
*OPT100:                                                           0220
*   $ALTPRNT='1'B;                  /* SET PARALLEL PRINT            */
OPT100   OI    $ALTPRNT(WAPTR),B'00010000'                         0220
*   $PRNTLVL='2';                   /* SET DEFAULT LEVEL             */
         MVI   $PRNTLVL(WAPTR),C'2'                                0221
*   IF INPUTBUF(3)='(' THEN         /* WILL PRNT LVL BE SPEC ?       */
         CLI   INPUTBUF+2(R3),C'('                                 0222
         BNE   @RF00222                                            0222
*     DO;                                                          0223
*       IF INPUTBUF(4)<'0'×         /* YES                           */
*           INPUTBUF(4)>'3' THEN    /* CHK HIGH-LOW LEGAL RNGE       */
         CLI   INPUTBUF+3(R3),C'0'                                 0224
         BL    @RT00224                                            0224
         CLI   INPUTBUF+3(R3),C'3'                                 0224
         BNH   @RF00224                                            0224
@RT00224 DS    0H                                                  0225
*         DO;                                                      0225
*           R3=R3+3;                /* ERROR                         */
         AL    R3,@CF00081                                         0226
*           GO TO OPT800;                                          0227
         B     OPT800                                              0227
*         END;                                                     0228
*       $PRNTLVL=INPUTBUF(4);       /* MOVE PRNT LEVEL TO TWA        */
@RF00224 MVC   $PRNTLVL(1,WAPTR),INPUTBUF+3(R3)                    0229
*OPT150:                                                           0230
*       IF INPUTBUF(5)^=')' THEN    /* CHK SYNTAX                    */
OPT150   CLI   INPUTBUF+4(R3),C')'                                 0230
         BE    @RF00230                                            0230
*         DO;                                                      0231
*           R3=R3+4;                /* ERROR                         */
         AL    R3,@CF00068                                         0232
*           GO TO OPT800;                                          0233
         B     OPT800                                              0233
*         END;                                                     0234
*       R3=R3+5;                    /* PT TO , OR /                  */
@RF00230 AL    R3,@CF00348                                         0235
*       GO TO OPT075;                                              0236
         B     OPT075                                              0236
*     END;                                                         0237
*   GO TO OPT070;                   /* GO CHK IT                     */
         B     OPT070                                              0238
*                                                                  0239
*   /*****************************************************************/
*   /*                                                               */
*   /* EL OPTION ENTRY                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0239
*OPT200:                                                           0239
*   $LOOPERR='1'B;                  /* SET EL BIT ON                 */
OPT200   OI    $LOOPERR(WAPTR),B'00000010'                         0239
*   $ERRCNT='0'B;                   /* TURN OFF COUNT GIVEN          */
         NI    $ERRCNT(WAPTR),B'11101111'                          0240
*   IF INPUTBUF(3)='(' THEN         /* COUNT SPECIFIED ?             */
         CLI   INPUTBUF+2(R3),C'('                                 0241
         BNE   @RF00241                                            0241
*     DO;                                                          0242
*       IF INPUTBUF(4)='I' THEN     /* INDEFINITE LOOP               */
         CLI   INPUTBUF+3(R3),C'I'                                 0243
         BNE   @RF00243                                            0243
*         DO;                       /* YES                           */
*           $INDEFLP='1'B;          /* TURN ON SWITCH                */
         OI    $INDEFLP(WAPTR),B'00000010'                         0245
*           GO TO OPT150;           /* GO CHK LEFT PAREN             */
         B     OPT150                                              0246
*         END;                                                     0247
*       R3=R3+3;                    /* PT TO NUMBER                  */
@RF00243 AL    R3,@CF00081                                         0248
*       GEN(BAL  R11,OPT350);       /* CONVERT NUMBER                */
         BAL  R11,OPT350
*       IF HEXNUM=0 THEN            /* LOOP CNT=0                    */
         L     @14,HEXNUM                                          0250
         LTR   @14,@14                                             0250
         BNZ   @RF00250                                            0250
*         DO;                       /* YES,CONTINUE                  */
*           $LOOPERR='0'B;          /* SET ERROR LOOP OFF            */
         NI    $LOOPERR(WAPTR),B'11111101'                         0252
*           GO TO OPT075;           /* CONTINUE DECODING             */
         B     OPT075                                              0253
*         END;                                                     0254
*       $ERRCNTA=HEXNUM;            /* STORE COUNT FOR OLT           */
@RF00250 L     @14,HEXNUM                                          0255
         STH   @14,$ERRCNTA(,WAPTR)                                0255
*       $ERRLPCT=$ERRCNTA;          /* PUT IN SCT ALSO               */
         STH   @14,$ERRLPCT(,WAPTR)                                0256
*       $ERRCNT='1'B;               /* SET COUNT GIVEN BIT           */
         OI    $ERRCNT(WAPTR),B'00010000'                          0257
*       $INDEFLP='0'B;              /* RESET INDEFINITE LOOP         */
         NI    $INDEFLP(WAPTR),B'11111101'                         0258
*       GO TO OPT075;               /* DECODE NEXT CHAR              */
         B     OPT075                                              0259
*     END;                                                         0260
*   $ERRLPCT=$COUNT;                /* USE OLT DEFAULT               */
@RF00241 L     @14,$LOWADDR(,WAPTR)                                0261
         LH    @10,RTNDISP(,@14)                                   0261
         ALR   @10,@14                                             0261
         LH    @14,$COUNT(,@10)                                    0261
         N     @14,@CF00872                                        0261
         STH   @14,$ERRLPCT(,WAPTR)                                0261
*   $INDEFLP='0'B;                  /* RESET INDEFINITE LOOP         */
         NI    $INDEFLP(WAPTR),B'11111101'                         0262
*   GO TO OPT070;                   /* DECODE NEXT CHAR              */
         B     OPT070                                              0263
*                                                                  0264
*   /*****************************************************************/
*   /*                                                               */
*   /* TL OPTION ENTRY                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0264
*OPT300:                                                           0264
*   $LOOPTST='1'B;                  /* SET TL BIT                    */
OPT300   OI    $LOOPTST(WAPTR),B'00000001'                         0264
*   $TLCNT=500;                     /* SET DEFAULT COUNT             */
         MVC   $TLCNT(2,WAPTR),@CH00796                            0265
*   IF INPUTBUF(3)='(' THEN         /* COUNT SPECIFIED ?             */
         CLI   INPUTBUF+2(R3),C'('                                 0266
         BNE   @RF00266                                            0266
*     DO;                           /* YES                           */
*       R3=R3+3;                    /* PT TO COUNT                   */
         AL    R3,@CF00081                                         0268
*       GEN(BAL  R11,OPT350);       /* DECODE & CONVERT CNT          */
         BAL  R11,OPT350
*       $TLCNT=HEXNUM;              /* MOVE IN COUNT FOR OLT         */
         L     @14,HEXNUM                                          0270
         STH   @14,$TLCNT(,WAPTR)                                  0270
*       GO TO OPT075;               /* DECODE NEXT                   */
         B     OPT075                                              0271
*     END;                                                         0272
*   GO TO OPT070;                   /* DECODE NEXT                   */
         B     OPT070                                              0273
*OPT350:                            /* CONVERT ROUTINE               */
*   WORK=EBCF0;                     /* INITIALIZE WORKAREA           */
OPT350   MVC   WORK(8),EBCF0                                       0274
*   DO I=1 TO 6 BY 1;               /* SCAN FOR RT. PAREN            */
         LA    @14,1                                               0275
         STH   @14,I                                               0275
@DL00275 DS    0H                                                  0276
*     IF INPUTBUF(I)=')' THEN       /* FOUND                         */
         ALR   @14,R3                                              0276
         BCTR  @14,0                                               0276
         CLI   INPUTBUF(@14),C')'                                  0276
         BE    @RT00276                                            0276
*       GO TO OPT355;               /* YES,DECODE & CONVERT          */
*     IF APFLAG='0'B THEN           /* IS THIS AN ALT PRTR           */
         TM    APFLAG,B'01000000'                                  0278
         BNZ   @RF00278                                            0278
*       DO;                         /* NO,CONTINUE                   */
*         IF INPUTBUF(I)>'9'×       /* IS CHAR                       */
*             '0'>INPUTBUF(I) THEN  /* NUMERIC                       */
         LH    @14,I                                               0280
         ALR   @14,R3                                              0280
         BCTR  @14,0                                               0280
         CLI   INPUTBUF(@14),C'9'                                  0280
         BH    @RT00280                                            0280
         LH    @14,I                                               0280
         ALR   @14,R3                                              0280
         BCTR  @14,0                                               0280
         CLI   INPUTBUF(@14),C'0'                                  0280
         BNL   @RF00280                                            0280
@RT00280 DS    0H                                                  0281
*           DO;                     /* NO,ERROR                      */
*             R3=R3+I;              /* POINT TO ERROR                */
         AH    R3,I                                                0282
*             GO TO OPT360;                                        0283
         B     OPT360                                              0283
*           END;                                                   0284
*       END;                                                       0285
@RF00280 DS    0H                                                  0286
*   END;                                                           0286
@RF00278 LA    @14,1                                               0286
         AH    @14,I                                               0286
         STH   @14,I                                               0286
         C     @14,@CF00446                                        0286
         BNH   @DL00275                                            0286
*   R3=R3+5;                        /* ERROR TOO MANY CHARS          */
         AL    R3,@CF00348                                         0287
*   GO TO OPT800;                   /* ISSUE 115 ERROR MSG           */
         B     OPT800                                              0288
*OPT355:                                                           0289
*   I=I-1;                          /* COMPUTE WORK AREA SUBSCR      */
OPT355   LH    @14,I                                               0289
         BCTR  @14,0                                               0289
         STH   @14,I                                               0289
*   IF I=0 THEN                     /* NOTHING FOUND?                */
         LTR   @14,@14                                             0290
         BZ    @RT00290                                            0290
*     GO TO OPT800;                 /* YES,ERROR                     */
*   N=9-I;                          /* NUMBER OF CHARACTERS          */
         LA    @10,9                                               0292
         SLR   @10,@14                                             0292
         STH   @10,N                                               0292
*   WORK(N:8)=INPUTBUF(1:I);        /* MOVE IN EBCDIC NUM            */
         LA    @08,WORK-1(@10)                                     0293
         LCR   @10,@10                                             0293
         AL    @10,@CF00054                                        0293
         EX    @10,@SM00873                                        0293
*   R3=R3+I;                        /* INCR INPUT POINTER            */
*                                                                  0294
         ALR   R3,@14                                              0294
*   /*****************************************************************/
*   /*                                                               */
*   /* ITACONV FROM(WORK)TO(WORKA)TYPE(EH)COUNT(8) INVOKED           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0295
*   DCL                                                            0295
*     1 ITATCPRM BDY(WORD),         /* CONVERT PARAMETER LIST        */
*      2 * CHAR(4) INIT('0102F4F1'X),                              0295
*      2 ITATCFR PTR,               /* ADDRESS OF FROM FIELD         */
*      2 ITATCTO PTR,               /* ADDRESS OF TO FIELD           */
*      2 * BIT(8) INIT(0),          /* FLAGS FOR CONVERT MODULE      */
*       3 ITATCTP BIT(1),           /* TYPE OF CONVERT REQUIRED      */
*      2 ITATCNT FIXED(8);          /* NUMBER OF BYTES TO CONVERT    */
*   ITATCFR=ADDR(WORK);             /* SET THE FROM ADDRESS          */
         LA    @14,WORK                                            0296
         ST    @14,ITATCFR                                         0296
*   ITATCTO=ADDR(WORKA);            /* SET THE TO ADDRESS            */
         LA    @14,WORKA                                           0297
         ST    @14,ITATCTO                                         0297
*   ITATCTP='0'B;                   /* SET THE TYPE OF CONVERT BIT   */
         NI    ITATCTP,B'01111111'                                 0298
*   ITATCNT=8;                      /* GIVE THE CONVERT BYTE COUNT   */
         MVI   ITATCNT,X'08'                                       0299
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */
         LA    R1,ITATCPRM                                         0300
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */
         L     @15,@CV00811                                        0301
         BALR  @14,@15                                             0301
*   IF R15^=0 THEN                  /* ERROR CONVERTING              */
         LTR   R15,R15                                             0302
         BNZ   @RT00302                                            0302
*     GO TO OPT800;                 /* YES,GO ISSUE 115 MSG          */
*   IF APFLAG='1'B THEN             /* IS THIS AN AP ENTRY ENT       */
         TM    APFLAG,B'01000000'                                  0304
         BO    @RT00304                                            0304
*     GO TO OPT370;                                                0305
*   HEXNUM=WORKA*16+12;             /* CONVERT TO                    */
         L     @14,WORKA                                           0306
         SLL   @14,4                                               0306
         AL    @14,@CF00134                                        0306
         ST    @14,HEXNUM                                          0306
*   CVB(HEXNUM,HEXNUMA);            /* HEX                           */
         XC    @TS00001(8),@TS00001                                0307
         MVC   @TS00001+4(4),HEXNUMA                               0307
         CVB   @14,@TS00001                                        0307
         ST    @14,HEXNUM                                          0307
*   IF HEXNUM>32767 THEN            /* NUM HAS TO FIT IN HALF        */
         C     @14,@CF00814                                        0308
         BNH   @RF00308                                            0308
*     DO;                           /* IT DOESNT,ERROR               */
*OPT360:                                                           0310
*       R3=R3-1;                    /* POINT TO ERROR                */
OPT360   BCTR  R3,0                                                0310
*       GO TO OPT800;               /* ISSUE 115 MSG                 */
         B     OPT800                                              0311
*     END;                                                         0312
*OPT370:                                                           0313
*   R3=R3+1;                        /* POINT TO ERROR CHAR           */
@RF00308 DS    0H                                                  0313
OPT370   AL    R3,@CF00072                                         0313
*   GEN(BR   R11);                  /* RETURN TO CALLER              */
         BR   R11
*                                                                  0315
*   /*****************************************************************/
*   /*                                                               */
*   /* AP OPTION ENTRY                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0315
*OPT400:                                                           0315
*   IF $ALTPRTR='1'B×               /* IS THERE AN ACTIVE AP OR      */
*       ($NOTDEV(2)='1'B&$ACQRED(2)='1'B)/* ONE WITH ERROR           */
*     THEN                          /* IF EITHER DO                  */
OPT400   TM    $ALTPRTR(WAPTR),B'00000010'                         0315
         BO    @RT00315                                            0315
         TM    $NOTDEV+68(WAPTR),B'11000000'                       0315
         BNO   @RF00315                                            0315
@RT00315 DS    0H                                                  0316
*     DO;                           /* YES CONTINUE                  */
*       SYM=ADDR($SYSMN(2));        /* GET NAME FOR RELEASE          */
         LA    @14,$SYSMN+68(,WAPTR)                               0317
         ST    @14,SYM                                             0317
*       R1=ADDR(RELPARM);           /* RELEASE PARM LIST             */
         LA    R1,RELPARM                                          0318
*       CALL #EXIT;                 /* RELEASE PRESENT AP            */
         L     @15,#EXITA(,WAPTR)                                  0319
         BALR  @14,@15                                             0319
*       IF R15^=0 THEN              /* ERROR ?                       */
         LTR   R15,R15                                             0320
         BNZ   @RT00320                                            0320
*         GO TO OPT890;             /* YES                           */
*     END;                                                         0322
*   $NOTDEV(2)='0'B;                /* NOT A TEST DEVICE             */
@RF00315 NI    $NOTDEV+68(WAPTR),B'01111111'                       0323
*   $ALTPRTR='0'B;                  /* RESET AP BIT                  */
*   $NEWAP='0'B;                    /* RESET NEW ALT PRTR FLAG       */
         NI    $ALTPRTR(WAPTR),B'11111100'                         0325
*   $APNAME='';                     /* INITIALIZE ALT PRT NAME       */
         MVI   $APNAME(WAPTR),C' '                                 0326
         MVC   $APNAME+1(7,WAPTR),$APNAME(WAPTR)                   0326
*   IF NO='1'B THEN                 /* AP SPECIFIED                  */
         TM    NO,B'10000000'                                      0327
         BO    @RT00327                                            0327
*     GO TO OPT070;                 /* NO DECODE NEXT                */
*   IF INPUTBUF(3)^='(' THEN        /* ALT PRINTER SPEC              */
         CLI   INPUTBUF+2(R3),C'('                                 0329
         BE    @RF00329                                            0329
*     DO;                           /* NO                            */
*       R3=R3+2;                    /* ERROR                         */
         AL    R3,@CF00137                                         0331
*       GO TO OPT800;               /* ISSUE ERROR MSG               */
         B     OPT800                                              0332
*     END;                                                         0333
*   R3=R3+3;                        /* PT TO 1ST CHAR OF NAME        */
@RF00329 AL    R3,@CF00081                                         0334
*   $DEVCDSF(2)='00'X;              /* CDS DEVICE FLAGS              */
*                                                                  0335
         MVI   $DEVCDSF+68(WAPTR),X'00'                            0335
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SYMBOLIC NAME FIELD                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0336
*   $$SYMNME(2)=$$SYMNME(2)&&$$SYMNME(2);                          0336
         XC    $$SYMNME+68(8,WAPTR),$$SYMNME+68(WAPTR)             0336
*   I=1;                            /* SET SUBSCRIPT                 */
         MVC   I(2),@CH00072                                       0337
*   IF INPUTBUF(1)>'Z' THEN         /* UNIT ADDRESS ?                */
         CLI   INPUTBUF(R3),C'Z'                                   0338
         BNH   @RF00338                                            0338
*     DO;                           /* YES                           */
*       APFLAG='1'B;                /* SET INT AP FLAG               */
         OI    APFLAG,B'01000000'                                  0340
*       GEN(BAL  R11,OPT350);       /* CONVERT UNIT ADDR TO HEX      */
         BAL  R11,OPT350
*       APFLAG='0'B;                /* RESET AP FLAG                 */
         NI    APFLAG,B'10111111'                                  0342
*       IF NUM>4095 THEN            /* MORE THAN 3 HEX DIGITS ?      */
         CLC   NUM(2),@CH00821                                     0343
         BNH   @RF00343                                            0343
*         DO;                       /* YES,ERROR                     */
*           R3=R3-2;                /* BACK UP TO LAST DIGIT         */
         BCTR  R3,0                                                0345
         BCTR  R3,0                                                0345
*           GO TO OPT800;           /* ERROR HANDLING                */
         B     OPT800                                              0346
*         END;                                                     0347
*       $APNAME(1:I)=WORK(N:8);     /* MOVE AP UNIT ADR              */
@RF00343 LH    @14,I                                               0348
         BCTR  @14,0                                               0348
         LH    @10,N                                               0348
         LA    @08,WORK-1(@10)                                     0348
         EX    @14,@SM00877                                        0348
*       $DEVUNAD(2)=WORKA;          /* UNIT ADDR TO DEV TBLE         */
         MVC   $DEVUNAD+68(4,WAPTR),WORKA                          0349
*       GO TO OPT450;               /* GO INQUIRE                    */
         B     OPT450                                              0350
*     END;                                                         0351
*OPT420:                                                           0352
*   IF INPUTBUF(I)='$'×             /* CHECK FOR                     */
*       INPUTBUF(I)='@'×            /* LEGAL                         */
*       INPUTBUF(I)='#'×            /* SYMBOLIC                      */
*       INPUTBUF(I)>='A' THEN       /* NAME                          */
@RF00338 DS    0H                                                  0352
OPT420   LH    @14,I                                               0352
         ALR   @14,R3                                              0352
         BCTR  @14,0                                               0352
         CLI   INPUTBUF(@14),C'$'                                  0352
         BE    @RT00352                                            0352
         LH    @14,I                                               0352
         ALR   @14,R3                                              0352
         BCTR  @14,0                                               0352
         CLI   INPUTBUF(@14),C'@'                                  0352
         BE    @RT00352                                            0352
         LH    @14,I                                               0352
         ALR   @14,R3                                              0352
         BCTR  @14,0                                               0352
         CLI   INPUTBUF(@14),C'#'                                  0352
         BE    @RT00352                                            0352
         LH    @14,I                                               0352
         ALR   @14,R3                                              0352
         BCTR  @14,0                                               0352
         CLI   INPUTBUF(@14),C'A'                                  0352
         BL    @RF00352                                            0352
@RT00352 DS    0H                                                  0353
*     DO;                                                          0353
*       I=I+1;                      /* PT TO NEXT CHAR               */
         LA    @14,1                                               0354
         AH    @14,I                                               0354
         STH   @14,I                                               0354
*       IF I>9 THEN                 /* MORE THAN 8 CHARS             */
         C     @14,@CF00715                                        0355
         BH    @RT00355                                            0355
*         GO TO OPT430;             /* YES,ERROR                     */
*       GO TO OPT420;               /* CHK NEXT CHAR                 */
         B     OPT420                                              0357
*     END;                                                         0358
*   IF INPUTBUF(I)^=')'×            /* IF NOT END OF FIELD OR        */
*       I=1 THEN                    /* NO NAME SPECIFIED             */
@RF00352 LH    @14,I                                               0359
         ALR   @14,R3                                              0359
         BCTR  @14,0                                               0359
         CLI   INPUTBUF(@14),C')'                                  0359
         BNE   @RT00359                                            0359
         LH    @14,I                                               0359
         C     @14,@CF00072                                        0359
         BNE   @RF00359                                            0359
@RT00359 DS    0H                                                  0360
*     DO;                           /* ERROR                         */
*OPT430:                                                           0361
*       R3=R3+I-1;                  /* POINT TO ERROR                */
OPT430   LR    @14,R3                                              0361
         AH    @14,I                                               0361
         BCTR  @14,0                                               0361
         LR    R3,@14                                              0361
*       GO TO OPT800;               /* WRITE ERROR MSG               */
         B     OPT800                                              0362
*     END;                                                         0363
*   $DEVCDSF(2)='0A'X;              /* CDS DEVICE FLAGS              */
@RF00359 MVI   $DEVCDSF+68(WAPTR),X'0A'                            0364
*   $$SYMNME(2)='';                 /* INIT SYM NAME                 */
         MVI   $$SYMNME+68(WAPTR),C' '                             0365
         MVC   $$SYMNME+69(7,WAPTR),$$SYMNME+68(WAPTR)             0365
*   I=I-1;                          /* RESET SUBSCRIPT               */
         LH    @14,I                                               0366
         BCTR  @14,0                                               0366
         STH   @14,I                                               0366
*   $$SYMNME(2,1:I)=INPUTBUF(1:I);  /* MOVE NAME TO DEV TBL          */
         LR    @10,@14                                             0367
         BCTR  @10,0                                               0367
         EX    @10,@SM00879                                        0367
*   $APNAME=$$SYMNME(2);            /* ALSO MOVE TO APNAME           */
         MVC   $APNAME(8,WAPTR),$$SYMNME+68(WAPTR)                 0368
*   R3=R3+I+1;                      /* INCR INPUT PTR                */
         ALR   @14,R3                                              0369
         AL    @14,@CF00072                                        0369
         LR    R3,@14                                              0369
*OPT450:                                                           0370
*   CDSADDR=ADDR($DEVTBLE(2));      /* CDS FOR ACQ/VER               */
OPT450   LA    @14,$DEVTBLE+68(,WAPTR)                             0370
         ST    @14,CDSADDR                                         0370
*   R1=ADDR(ACQPARM);               /* ADDRESS OF ACQ PARM LST       */
         LA    R1,ACQPARM                                          0371
*   CALL ISTSC030;                  /* CALL ACQUISITION              */
         L     @15,@CV00833                                        0372
         BALR  @14,@15                                             0372
*   IF R15^=0 THEN                  /* ERROR                         */
         LTR   R15,R15                                             0373
         BNZ   @RT00373                                            0373
*     GO TO OPT890;                 /* YES                           */
*   IF SYMNAME=$SYSMN(1) THEN       /* ALT PRT = CONTROL TERM        */
         L     @14,SYMPTR+2376(,WAPTR)                             0375
         CLC   SYMNAME(8,@14),$SYSMN(WAPTR)                        0375
         BNE   @RF00375                                            0375
*     DO;                           /* YES                           */
*OPT460:                                                           0377
*       R3=R3-2;                    /* PT TO ERROR                   */
OPT460   BCTR  R3,0                                                0377
         BCTR  R3,0                                                0377
*       GO TO OPT800;               /* ERROR HANDLING                */
         B     OPT800                                              0378
*     END;                                                         0379
*   $MSGOTSD(2)=0;                  /* CLCAB WORD FOR QUE            */
@RF00375 SLR   @14,@14                                             0380
         ST    @14,$MSGOTSD+68(,WAPTR)                             0380
*   $DEVFEAT(2)=DEVCHAR;            /* MOVE DEV CHARS FOR 200        */
         L     @14,DVCHRPTR+2376(,WAPTR)                           0381
         MVC   $DEVFEAT+68(4,WAPTR),DEVCHAR(@14)                   0381
*   R1=DVCHRPTR;                    /* POINT TO PARM LIST            */
         LR    R1,@14                                              0382
*   CALL I00C0200;                  /* CAN DEV BE AN ALT PRTR        */
         L     @15,@CV00836                                        0383
         BALR  @14,@15                                             0383
*   IF R15>4 THEN                   /* CHECK R/C                     */
         C     R15,@CF00068                                        0384
         BH    @RT00384                                            0384
*     GO TO OPT800;                 /* CANT BE ALT PRTR              */
*   $SYSMN(2)=SYMNAME;              /* MOVE SYM NAME TOO             */
         LA    @14,2376                                            0386
         ALR   @14,WAPTR                                           0386
         L     @10,SYMPTR(,@14)                                    0386
         MVC   $SYSMN+68(8,WAPTR),SYMNAME(@10)                     0386
*   $LINENME(2)=NAMERN;             /* MOVE NAME TO DEF TABLE        */
         MVC   $LINENME+68(8,WAPTR),NAMERN(@14)                    0387
*   $DEVFLG5(2)=FLG5;               /* MOVE DEVICE FLAGS             */
         MVC   $DEVFLG5+68(1,WAPTR),FLG5(@14)                      0388
*   $NEWAP='1'B;                    /* SET NEW AP FLAG               */
         OI    $NEWAP(WAPTR),B'00000001'                           0389
*   $APRQPER='1'B;                  /* AP REQ. PERMISSION            */
         OI    $APRQPER(WAPTR),B'01000000'                         0390
*   APFLAG='0'B;                    /* TURN OFF INT FLAG             */
         NI    APFLAG,B'10111111'                                  0391
*   GO TO OPT075;                   /* DECODE NEXT ENTRY             */
         B     OPT075                                              0392
*OPT800:                                                           0393
*                                                                  0393
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR HANDLING                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0393
*   R4=$SLASHAD(2)+1;               /* ADDR OF 1ST INPUT CHAR        */
OPT800   LA    R4,1                                                0393
         AL    R4,$SLASHAD+4(,WAPTR)                               0393
*   IF R3>$SLASHAD(3) THEN          /* BEYOND OPTION FIELD           */
         L     @14,$SLASHAD+8(,WAPTR)                              0394
         CR    R3,@14                                              0394
         BNH   @RF00394                                            0394
*     R3=$SLASHAD(3);               /* YES,RESET POINTER             */
         LR    R3,@14                                              0395
*   R6=R3;                          /* SET ERROR INPUT PTR           */
@RF00394 LR    R6,R3                                               0396
*   $INBUFR(1:8)=' ';               /* BLK OUT WORK AREA             */
         MVI   $INBUFR+1(WAPTR),C' '                               0397
         MVC   $INBUFR+2(6,WAPTR),$INBUFR+1(WAPTR)                 0397
         MVI   $INBUFR(WAPTR),C' '                                 0397
*   DO I=8 TO 1 BY-1;               /* SCAN INPUT                    */
         LA    @14,8                                               0398
         STH   @14,I                                               0398
@DL00398 DS    0H                                                  0399
*     $INBUFR(I)=ERRINPUT(1);       /* MOVE ERROR TO SUB FIELD       */
         ALR   @14,WAPTR                                           0399
         MVC   $INBUFR-1(1,@14),ERRINPUT(R6)                       0399
*     IF R6=R4 THEN                 /* END OF OPT FIELD              */
         CR    R6,R4                                               0400
         BE    @RT00400                                            0400
*       GO TO OPT820;               /* YES WRITE ERROR MSG           */
*     R6=R6-1;                      /* DECR INPUT PTR                */
         BCTR  R6,0                                                0402
*   END;                                                           0403
         LH    @10,I                                               0403
         BCTR  @10,0                                               0403
         LR    @14,@10                                             0403
         STH   @14,I                                               0403
         LTR   @14,@14                                             0403
         BP    @DL00398                                            0403
*OPT820:                                                           0404
*                                                                  0404
*   /*****************************************************************/
*   /*                                                               */
*   /* TCEC MSGN(115)SUB(YES) INVOKED                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0404
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */
OPT820   OI    $TCECM(WAPTR),B'00000001'                           0404
*   R1=ADDR($TCA12);                /* SET UP PARM LIST $TR          */
         LA    R1,$TCA12                                           0405
*   CALL #EXIT;                     /* CALL CECOM                    */
         L     @15,#EXITA(,WAPTR)                                  0406
         BALR  @14,@15                                             0406
*   DCL                                                            0407
*     1 $TCA12,                     /* TCEC PARM LIST                */
*      2 $TCB12 FIXED(32) INIT(115),/* MSG NUMBER                    */
*      2 $TCC12 FIXED(32) INIT(0),  /* INCT LEN                      */
*      2 $TCD12 BIT(8) INIT('10000000'B),/* FLAG                     */
*      2 $TCE12 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ISSUE ERROR
*                                      MSG                           */
*OPT850:                                                           0408
*   $TESTOPT=A33SAVE(1);            /* RESTORE                       */
OPT850   MVC   $TESTOPT(1,WAPTR),A33SAVE                           0408
*   $ERROPT=A33SAVE(2);             /* OLD                           */
         MVC   $ERROPT(1,WAPTR),A33SAVE+1                          0409
*   $EXECFLG=A33SAVE(3);            /* OPTIONS                       */
         MVC   $EXECFLG(1,WAPTR),A33SAVE+2                         0410
*   $OLTFLGS=A33SAVE(4);            /* AND                           */
         MVC   $OLTFLGS(1,WAPTR),A33SAVE+3                         0411
*   $PRNTLVL=A33SAVE(5);            /* CONSTANTS                     */
         MVC   $PRNTLVL(1,WAPTR),A33SAVE+4                         0412
*   $ERRCNTA=A33SAVE(6:9);          /*                               */
         MVC   $ERRCNTA(2,WAPTR),A33SAVE+7                         0413
*   $TLCNT=A33SAVE(8:9);            /*                               */
         MVC   $TLCNT(2,WAPTR),A33SAVE+7                           0414
*   $FLAG9=A33SAVE(10);             /*                               */
         MVC   $FLAG9(1,WAPTR),A33SAVE+9                           0415
*   $NEWAP='0'B;                    /* RESET ALT PRT FLAG            */
         NI    $NEWAP(WAPTR),B'11111110'                           0416
*OPT890:                                                           0417
*   $OPTERR='1'B;                   /* INDICATE ERROR                */
OPT890   OI    $OPTERR(WAPTR),B'00000100'                          0417
*   IF $ALTPRTR='0'B&               /* ALT PRINTER                   */
*       $NEWAP='0'B THEN            /* OR NEW ALT PRINTER            */
         TM    $ALTPRTR(WAPTR),B'00000011'                         0418
         BNZ   @RF00418                                            0418
*     DO;                                                          0419
*       $DEVTBLE(2)=$DEVTBLE(2)&&$DEVTBLE(2);/* CLEAR ENTRY          */
         XC    $DEVTBLE+68(68,WAPTR),$DEVTBLE+68(WAPTR)            0420
*       $NOTDEV(2)='1'B;            /* SET NOT DEVICE FOR AP         */
         OI    $NOTDEV+68(WAPTR),B'10000000'                       0421
*     END;                                                         0422
*OPT895:                            /* SCAN FOR NEXT ENTRY           */
*   IF INPUTBUF(1)=',' THEN         /* REACHED NEXT ENTRY?           */
@RF00418 DS    0H                                                  0423
OPT895   CLI   INPUTBUF(R3),C','                                   0423
         BNE   @RF00423                                            0423
*     DO;                           /* YES CONTINUE                  */
*       R3=R3+1;                    /* POINT TO NEXT ENTRY           */
         AL    R3,@CF00072                                         0425
*       GO TO OPT050;               /* CONTINUE DECODING             */
         B     OPT050                                              0426
*     END;                                                         0427
*   IF INPUTBUF(1)='/' THEN         /* END OF INPUT?                 */
@RF00423 CLI   INPUTBUF(R3),C'/'                                   0428
         BE    @RT00428                                            0428
*     GO TO OPT900;                 /* YES,RETURN TO COMM INT        */
*   R3=R3+1;                        /* UPDATE POINTER                */
         AL    R3,@CF00072                                         0430
*   GO TO OPT895;                   /* LOOK FOR END OF ENTRY         */
         B     OPT895                                              0431
*OPT900:                                                           0432
*   R13=SVEIC003(2);                /* MY SAVE PTR                   */
OPT900   L     R13,SVEIC003+4(,WAPTR)                              0432
*   RETURN;                         /* GO TO COMM INT                */
@EL00001 DS    0H                                                  0433
@EF00001 DS    0H                                                  0433
@ER00001 LM    @14,@12,12(@13)                                     0433
         BR    @14                                                 0433
*/* ATDSPLY   INVOKED.                                               */
*/********************************************************************/
*/* THERE HAVE BEEN NO ATBUILD INCLUSIONS IN THIS COMPILATION.       */
*/********************************************************************/
*/* END OF ATDSPLY.                                                  */
*                                                                  0434
*   END ISTIC005;                                                  0434
@DATA    DS    0H
@CH00796 DC    H'500'
@CH00821 DC    H'4095'
@SM00858 MVC   $INBUFR(0,WAPTR),$EXTA+1(WAPTR)
@SM00868 MVC   $EXTA+1(0,WAPTR),INPUTBUF(R3)
@SM00873 MVC   0(0,@08),INPUTBUF(R3)
@SM00877 MVC   $APNAME(0,WAPTR),0(@08)
@SM00879 MVC   $$SYMNME+68(0,WAPTR),INPUTBUF(R3)
         DS    0F
         DS    0F
@CF00072 DC    F'1'
@CH00072 EQU   @CF00072+2
@CF00137 DC    F'2'
@CF00081 DC    F'3'
@CF00068 DC    F'4'
@CF00348 DC    F'5'
@CF00446 DC    F'6'
@CF00054 DC    F'8'
@CF00715 DC    F'9'
@CF00134 DC    F'12'
@CF00750 DC    F'54'
@CF00814 DC    F'32767'
@CF00872 DC    XL4'0000FFFF'
@CV00811 DC    V(ISTSC021)
@CV00833 DC    V(ISTSC030)
@CV00836 DC    V(I00C0200)
         DS    0D
RCAPTR   DS    A
         DS    0D
@TS00001 DS    CL8
@CC00776 DC    C'EXT='
@CC00761 DC    C'TL'
@CC00764 DC    C'EL'
@CC00766 DC    C'PP'
@CC00768 DC    C'AP'
@CC00770 DC    C'FE'
@CC00771 DC    C'MI'
@CC00772 DC    C'EP'
@CC00773 DC    C'CP'
@CC00774 DC    C'PR'
@CC00775 DC    C'TR'
A33OPTN  DC    CL44'NTL,NEL,NPP,NFE,NMI,NEP,NCP,NPR,NTR,NAP'
@NM00055 DS    CL90
         ORG   @NM00055
N        DS    FL2
I        DS    FL2
EXTNUMFX DS    FL4
         ORG   EXTNUMFX
@NM00056 DS    CL3
EXTNUMCH DS    CL1
         ORG   @NM00055+8
@NM00057 DS    CL12
         ORG   @NM00057
WORK     DS    CL8
WORKA    DS    CL4
         ORG   WORKA
@NM00058 DS    CL2
NUM      DS    CL2
         ORG   @NM00055+20
HEXNUM   DS    FL4
         ORG   HEXNUM
HEXNUMA  DS    CL4
         ORG   @NM00055+24
OPTS     DS    CL44
         ORG   OPTS
EBTL     DS    CL1
@NM00059 DS    CL3
EBEL     DS    CL1
@NM00060 DS    CL3
EBPP     DS    CL1
@NM00061 DS    CL3
EBFE     DS    CL1
@NM00062 DS    CL3
EBMI     DS    CL1
@NM00063 DS    CL3
EBEP     DS    CL1
@NM00064 DS    CL3
EBCP     DS    CL1
@NM00065 DS    CL3
EBPR     DS    CL1
@NM00066 DS    CL3
EBTR     DS    CL1
@NM00067 DS    CL3
EBAP     DS    CL1
@NM00068 DS    CL3
         ORG   @NM00055+68
A33SAVE  DS    CL11
INTFLAGS DS    CL1
         ORG   INTFLAGS
NO       DS    BL1
APFLAG   EQU   INTFLAGS+0
@NM00069 EQU   INTFLAGS+0
         ORG   @NM00055+90
         DS    CL2
RELPARM  DS    CL9
         ORG   RELPARM
@NM00070 DC    X'0102F3F1'
SYM      DS    AL4
@NM00071 DC    B'10000000'
         ORG   RELPARM+9
         DS    CL3
ACQPARM  DS    CL5
         ORG   ACQPARM
CDSADDR  DS    AL4
@NM00072 DC    B'00100000'
         ORG   ACQPARM+5
EBCF0    DC    CL8'00000000'
         DS    CL3
$TCA09   DS    CL13
         ORG   $TCA09
$TCB09   DC    A(107)
$TCC09   DC    A(0)
$TCD09   DC    B'10000000'
$TCE09   DC    X'FFFFFFFF'
         ORG   $TCA09+13
         DS    CL3
$TCA10   DS    CL13
         ORG   $TCA10
$TCB10   DC    A(327)
$TCC10   DC    A(0)
$TCD10   DC    B'10000000'
$TCE10   DC    X'FFFFFFFF'
         ORG   $TCA10+13
         DS    CL3
ITATCPRM DS    CL14
         ORG   ITATCPRM
@NM00074 DC    X'0102F4F1'
ITATCFR  DS    AL4
ITATCTO  DS    AL4
@NM00075 DC    AL1(0)
         ORG   @NM00075
ITATCTP  DS    BL1
         ORG   ITATCPRM+13
ITATCNT  DS    FL1
         ORG   ITATCPRM+14
         DS    CL2
$TCA12   DS    CL13
         ORG   $TCA12
$TCB12   DC    A(115)
$TCC12   DC    A(0)
$TCD12   DC    B'10000000'
$TCE12   DC    X'FFFFFFFF'
         ORG   $TCA12+13
         DS    CL3
PATCH    DC    15F'0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
WAPTR    EQU   @02
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R6       EQU   @06
R9       EQU   @09
R11      EQU   @11
R13      EQU   @13
R15      EQU   @15
$RCAAREA EQU   0
$POINTER EQU   $RCAAREA+100
$TRTBLA  EQU   $POINTER+124
$CONSTNT EQU   $RCAAREA+244
$RCAFLG  EQU   $RCAAREA+604
TOLTEPWA EQU   0
$SCTTBLE EQU   TOLTEPWA
$ERRLPCT EQU   $SCTTBLE
$TESTOPT EQU   $SCTTBLE+2
$NOPRT   EQU   $TESTOPT
$INDEFLP EQU   $TESTOPT
$FSTCOMM EQU   $TESTOPT
$ERROPT  EQU   $SCTTBLE+3
$ALTPRNT EQU   $ERROPT
$NOCNTRL EQU   $ERROPT
$NERRPRT EQU   $ERROPT
$LOOPERR EQU   $ERROPT
$LOOPTST EQU   $ERROPT
$PDEVFLG EQU   $SCTTBLE+10
$CDSFLGS EQU   $SCTTBLE+11
$CDS8T19 EQU   $SCTTBLE+20
$EXECFLG EQU   $SCTTBLE+33
$ERRCNT  EQU   $EXECFLG
$OLTFLGS EQU   $SCTTBLE+36
$MANINTV EQU   $OLTFLGS
$TRACE   EQU   $OLTFLGS
$OLTFLG2 EQU   $SCTTBLE+37
$TOTFLG1 EQU   $SCTTBLE+38
$ROUTMSK EQU   $SCTTBLE+40
$CDA     EQU   TOLTEPWA+100
$SLASHAD EQU   $CDA+32
$RCA     EQU   $CDA+44
$OLTPTR  EQU   $CDA+52
$LOWADDR EQU   $OLTPTR
$HIMOREC EQU   $CDA+60
$TLCNT   EQU   $CDA+100
$ERRCNTA EQU   $CDA+102
$PRNTLVL EQU   $CDA+104
$COMMFLG EQU   TOLTEPWA+224
$FLAG1   EQU   $COMMFLG
$OLTACT  EQU   $FLAG1
$FLAG2   EQU   $COMMFLG+1
$FLAG3   EQU   $COMMFLG+2
$OPTERR  EQU   $FLAG3
$ALTPRTR EQU   $FLAG3
$NEWAP   EQU   $FLAG3
$FLAG4   EQU   $COMMFLG+3
$APRQPER EQU   $FLAG4
$FLAG5   EQU   $COMMFLG+4
$EOJ     EQU   $FLAG5
$CANCEL  EQU   $EOJ
$FLAG6   EQU   $COMMFLG+5
$ABNDBIT EQU   $FLAG6
$FLAG7   EQU   $COMMFLG+6
$FLAG8   EQU   $COMMFLG+7
$TCECM   EQU   $FLAG8
$FLAG9   EQU   $COMMFLG+8
$FLAG10  EQU   $COMMFLG+9
$FLAG11  EQU   $COMMFLG+10
$FLAG12  EQU   $COMMFLG+11
$OPTMSG  EQU   $FLAG12
$FLAG13  EQU   $COMMFLG+12
$DEVTBLE EQU   TOLTEPWA+240
$DEVCDS  EQU   $DEVTBLE
$DEVUNAD EQU   $DEVCDS
@NM00039 EQU   $DEVUNAD+2
$DEVFEAT EQU   $DEVCDS+4
$DEVCDSF EQU   $DEVCDS+9
$DEVSDCF EQU   $DEVCDS+10
$$SYMNME EQU   $DEVCDS+12
$MSGOTSD EQU   $$SYMNME
$DEVFLG1 EQU   $DEVTBLE+20
$EVNCPLT EQU   $DEVFLG1
$ATTNEXP EQU   $DEVFLG1
$INTOCC  EQU   $DEVFLG1
$DEVFLG2 EQU   $DEVTBLE+21
$DEVTECB EQU   $DEVTBLE+22
$OPIS    EQU   $DEVTECB
$OPND    EQU   $DEVTECB+2
$DEVFLG3 EQU   $DEVTBLE+27
$NOTDEV  EQU   $DEVFLG3
$ACQRED  EQU   $DEVFLG3
$SIOFLG  EQU   $DEVFLG3
$SYSMN   EQU   $DEVTBLE+28
$IFTOUT  EQU   $DEVTBLE+36
$DEVSESP EQU   $IFTOUT
$SSCPDAF EQU   $IFTOUT+6
$LDNCBPT EQU   $DEVTBLE+48
$RNINFO  EQU   $DEVTBLE+56
$LINENME EQU   $RNINFO
$DEVFLG5 EQU   $RNINFO+8
$DEVFLG4 EQU   $DEVTBLE+65
$SLTBL   EQU   TOLTEPWA+1468
$RUNTEST EQU   $SLTBL+13
$TESTFLG EQU   $SLTBL+21
$SECLST  EQU   $SLTBL+22
$INBUFR  EQU   TOLTEPWA+2104
$EXTA    EQU   TOLTEPWA+2320
$WORK    EQU   TOLTEPWA+2376
#EXITA   EQU   TOLTEPWA+2632
$CCOMDAT EQU   TOLTEPWA+2644
$CFLGS   EQU   $CCOMDAT+16
$24FEMSG EQU   TOLTEPWA+2681
$24CATMG EQU   $24FEMSG+11
$APNAME  EQU   TOLTEPWA+2704
@NM00048 EQU   TOLTEPWA+2776
$OUNTPTR EQU   @NM00048+4
$NSPTR   EQU   $OUNTPTR
$NSCNT   EQU   @NM00048+10
$ENXX    EQU   @NM00048+15
$IMITX   EQU   $ENXX
SVECC013 EQU   TOLTEPWA+3232
SVEIC003 EQU   TOLTEPWA+3592
SVESC022 EQU   TOLTEPWA+3736
SVECC011 EQU   TOLTEPWA+4024
#EXIT    EQU   0
@NM00051 EQU   0
RTNDISP  EQU   @NM00051+10
INST     EQU   @NM00051+12
$NEWSPRF EQU   0
#FLAGS   EQU   $NEWSPRF+16
$COUNT   EQU   $NEWSPRF+18
INPUTBUF EQU   0
@NM00073 EQU   0
SYMPTR   EQU   @NM00073
DVCHRPTR EQU   @NM00073+4
NAMERN   EQU   @NM00073+8
FLG5     EQU   @NM00073+16
SYMNAME  EQU   0
DEVCHAR  EQU   0
ERRINPUT EQU   0
BACKSAVE EQU   0
$TRTBL   EQU   0
OLTENTRY EQU   0
SVECC012 EQU   SVESC022
SVEIC00A EQU   SVEIC003
SVEIC004 EQU   SVEIC003
SVEIC005 EQU   SVEIC003
SVESC02A EQU   SVESC022
SVESC02B EQU   SVESC022
SVESC02D EQU   SVESC022
SVESC02E EQU   SVESC022
SVESC02F EQU   SVECC013
SVESC024 EQU   SVESC022
SVESC025 EQU   SVESC022
SVESC027 EQU   SVESC022
SVESC029 EQU   SVESC022
SVESC031 EQU   SVECC013
SVESC032 EQU   SVECC011
SVETC037 EQU   SVEIC003
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
$RME     EQU   $NEWSPRF+36
@NM00054 EQU   $NEWSPRF+35
$ECA     EQU   $NEWSPRF+32
$DCHB    EQU   $NEWSPRF+28
$MOSIZE  EQU   $NEWSPRF+24
$RTSIZE  EQU   $NEWSPRF+20
$REFNUM  EQU   $NEWSPRF+17
@NM00053 EQU   #FLAGS
#MSGIDRQ EQU   #FLAGS
#PLKMCOR EQU   #FLAGS
@NM00052 EQU   #FLAGS
$VIRTUAL EQU   #FLAGS
$PLINK$  EQU   $NEWSPRF+12
$SCTREQ  EQU   $NEWSPRF+11
$RM      EQU   $NEWSPRF+9
$CTYPE   EQU   $NEWSPRF+8
$CCLASS  EQU   $NEWSPRF+7
$CFEAT   EQU   $NEWSPRF+6
$CMODEL  EQU   $NEWSPRF+5
$TYPE    EQU   $NEWSPRF+4
$CLASS   EQU   $NEWSPRF+3
$FEAT    EQU   $NEWSPRF+2
$MODEL   EQU   $NEWSPRF+1
$RTN#    EQU   $NEWSPRF
#MSGID   EQU   @NM00051+16
LEVEL    EQU   @NM00051+8
SECTID   EQU   @NM00051
SVECC010 EQU   TOLTEPWA+3952
SVETC035 EQU   TOLTEPWA+3880
SVESC030 EQU   TOLTEPWA+3808
SVESC020 EQU   TOLTEPWA+3664
SVEIC002 EQU   TOLTEPWA+3520
SVECC014 EQU   TOLTEPWA+3376
SVESC120 EQU   TOLTEPWA+3304
SVESC033 EQU   TOLTEPWA+3160
@NM00050 EQU   TOLTEPWA+2980
$RPLERR  EQU   TOLTEPWA+2977
@NM00049 EQU   TOLTEPWA+2976
$R13PR3  EQU   TOLTEPWA+2972
$CEINT2  EQU   TOLTEPWA+2968
$CEINT1  EQU   TOLTEPWA+2964
$MSGGET  EQU   TOLTEPWA+2960
$ACQLIST EQU   TOLTEPWA+2956
$R4SAVE1 EQU   TOLTEPWA+2952
$CLSISS  EQU   TOLTEPWA+2950
$CLSCNT  EQU   TOLTEPWA+2948
$CUTABLE EQU   TOLTEPWA+2868
$BUFSZ2  EQU   TOLTEPWA+2864
$RESID2  EQU   TOLTEPWA+2860
$OLTCCW2 EQU   TOLTEPWA+2856
$ENDBFR2 EQU   TOLTEPWA+2852
$1STBFR2 EQU   TOLTEPWA+2848
$TECB2   EQU   TOLTEPWA+2844
$BUFSZ1  EQU   TOLTEPWA+2840
$RESID1  EQU   TOLTEPWA+2836
$OLTCCW1 EQU   TOLTEPWA+2832
$ENDBFR1 EQU   TOLTEPWA+2828
$1STBFR1 EQU   TOLTEPWA+2824
$TECB1   EQU   TOLTEPWA+2820
$WAITIME EQU   TOLTEPWA+2816
$TRTN#   EQU   TOLTEPWA+2815
$WIODEV  EQU   TOLTEPWA+2814
$RQSTSZE EQU   TOLTEPWA+2812
$RQSTPTR EQU   TOLTEPWA+2808
$R4SAVE  EQU   TOLTEPWA+2804
$PARTADR EQU   TOLTEPWA+2800
$TBSDATA EQU   TOLTEPWA+2796
$CTWIDTH EQU   TOLTEPWA+2795
$CTLINE  EQU   TOLTEPWA+2794
$APWIDTH EQU   TOLTEPWA+2793
$APLINE  EQU   TOLTEPWA+2792
$INDEX   EQU   $IMITX
$UMXX    EQU   @NM00048+14
$NSXX    EQU   @NM00048+12
$ATACNT  EQU   $NSCNT
$CTR     EQU   @NM00048+8
$ATAPTR  EQU   $NSPTR
$DDRPTR  EQU   @NM00048
$DTORESP EQU   TOLTEPWA+2712
$24SYMNE EQU   $24CATMG+4
$24DEVAD EQU   $24CATMG
$24RTN#  EQU   $24FEMSG+8
$ESECTID EQU   $24FEMSG
$24FLGS  EQU   TOLTEPWA+2680
$24SAVE2 EQU   TOLTEPWA+2676
$24SAVE1 EQU   TOLTEPWA+2672
$24UNADR EQU   TOLTEPWA+2668
$24SAV13 EQU   TOLTEPWA+2664
$24RETCD EQU   TOLTEPWA+2663
$MACID   EQU   TOLTEPWA+2661
$CSPARE  EQU   $CFLGS
$C2WAY   EQU   $CFLGS
$CINCT   EQU   $CCOMDAT+12
$CINADR  EQU   $CCOMDAT+8
$COUTCT  EQU   $CCOMDAT+4
$COUTAD  EQU   $CCOMDAT
ROOTLOC  EQU   TOLTEPWA+2640
$RETREG  EQU   TOLTEPWA+2636
$PASSONA EQU   TOLTEPWA+2264
$TRMINPT EQU   TOLTEPWA+2184
$BUFFER  EQU   TOLTEPWA+1976
$TLTRPL3 EQU   TOLTEPWA+1856
$TLTRPL2 EQU   TOLTEPWA+1736
$TLTRPL1 EQU   TOLTEPWA+1616
@NM00047 EQU   $SLTBL+135
$HIGHRTN EQU   $SLTBL+134
$PRIMADR EQU   $SLTBL+130
$CTSTPT  EQU   $SLTBL+128
$TSTCNT  EQU   $SLTBL+126
$SECFLGS EQU   $SECLST+3
$SECTION EQU   $SECLST
$SECACT  EQU   $TESTFLG
$CANTRUN EQU   $TESTFLG
$FINAL   EQU   $TESTFLG
$TESTSUF EQU   $RUNTEST+5
$TESTNUM EQU   $RUNTEST+1
$LETPRF  EQU   $RUNTEST
$SYMBOLC EQU   $SLTBL+5
$FAMILY  EQU   $SLTBL
$CDEVPT  EQU   TOLTEPWA+1466
$DEVCNTS EQU   TOLTEPWA+1464
$FEEDBCK EQU   $DEVTBLE+66
$WTISUED EQU   $DEVFLG4
$EXIOISD EQU   $DEVFLG4
$REMWRIT EQU   $DEVFLG4
$REMDONE EQU   $DEVFLG4
$2NDUSED EQU   $DEVFLG4
$1STUSED EQU   $DEVFLG4
$IGLXIFB EQU   $DEVFLG4
$EXIOLV3 EQU   $DEVFLG4
@NM00046 EQU   $DEVFLG5
$ASCII   EQU   $DEVFLG5
$DEVLU   EQU   $DEVFLG5
$OPNDFAL EQU   $DEVFLG5
$ACQNCB  EQU   $DEVFLG5
$REMOTE  EQU   $DEVFLG5
$ENDNODE EQU   $DEVFLG5
$CID     EQU   $DEVTBLE+52
$DVCOL   EQU   $LDNCBPT+2
$DVROW   EQU   $LDNCBPT
$NCSPLP  EQU   $DEVTBLE+44
$DVLN    EQU   $SSCPDAF
$DAF     EQU   $DEVSESP+4
$VARYPAB EQU   $DEVSESP
@NM00045 EQU   $DEVFLG3
$CLRSNT  EQU   $DEVFLG3
$OLTERR  EQU   $DEVFLG3
$SRTEST  EQU   $DEVFLG3
$DVSNDOK EQU   $SIOFLG
$POLLREQ EQU   $DEVFLG3
$DVINCT  EQU   $DEVTBLE+26
$DVBRKST EQU   $OPND+1
$DVBRKSN EQU   $OPND
$DVSEQNO EQU   $OPIS
$CEINTRP EQU   $DEVFLG2
$TESTMDE EQU   $DEVFLG2
$DEVALOC EQU   $DEVFLG2
$ALLDATA EQU   $DEVFLG2
$ENDCNTL EQU   $DEVFLG2
$CTLDEV  EQU   $DEVFLG2
$NOCDS   EQU   $DEVFLG2
$DATAIN  EQU   $DEVFLG2
$PRIMARY EQU   $DEVFLG1
$DVCTBYT EQU   $INTOCC
$DEVACT  EQU   $DEVFLG1
$DVLGMDE EQU   $ATTNEXP
$DVSPRM  EQU   $EVNCPLT
$GRABBED EQU   $DEVFLG1
$CATASTR EQU   $DEVFLG1
$LETGO   EQU   $DEVFLG1
$CURELEM EQU   $$SYMNME+4
$EXTDEV  EQU   $DEVCDS+11
@NM00044 EQU   $DEVSDCF
$NOTPRIM EQU   $DEVSDCF
@NM00043 EQU   $DEVCDSF
@NM00042 EQU   $DEVCDSF
@NM00041 EQU   $DEVCDSF
$CDSNAME EQU   $DEVCDSF
$EXTRN   EQU   $DEVCDSF
$CEVOLUM EQU   $DEVCDSF
$SHARD   EQU   $DEVCDSF
$DEVFPM  EQU   $DEVCDSF
$DEVCNT  EQU   $DEVCDS+8
$DEVTYPE EQU   $DEVFEAT+3
$DEVCLAS EQU   $DEVFEAT+2
$DEVFRRS EQU   $DEVFEAT+1
$DEVMOD  EQU   $DEVFEAT
$DEVRDGT EQU   @NM00039+1
$DEVCTLU EQU   @NM00039+1
$DEVCHAN EQU   @NM00039
@NM00040 EQU   @NM00039
$CTINDX  EQU   $DEVUNAD
$FLAG16  EQU   $COMMFLG+15
$FLAG15  EQU   $COMMFLG+14
$FLAG14  EQU   $COMMFLG+13
$TEP2ND  EQU   $FLAG13
$TEP1ST  EQU   $FLAG13
$CATMSG  EQU   $FLAG13
$PRMPTSW EQU   $FLAG13
$DEVENT  EQU   $FLAG13
$OLTMACC EQU   $FLAG13
$LGON    EQU   $FLAG13
$CTLOGON EQU   $FLAG13
@NM00038 EQU   $FLAG12
$VARYINP EQU   $FLAG12
$ENDTEST EQU   $FLAG12
$VRYHRD  EQU   $FLAG12
$VRYSFT  EQU   $FLAG12
$POSTFLG EQU   $FLAG12
$FEORCAT EQU   $FLAG11
@NM00037 EQU   $FLAG11
@NM00036 EQU   $FLAG10
$INBND   EQU   $FLAG10
$WAITFLG EQU   $FLAG10
$DPRINT  EQU   $FLAG10
$HOLD    EQU   $FLAG9
$NOTRRCH EQU   $FLAG9
@NM00035 EQU   $FLAG9
$COPY    EQU   $FLAG9
$LSTLNSW EQU   $FLAG9
$MULLNSW EQU   $FLAG9
$REMSW   EQU   $FLAG9
$IGRES   EQU   $FLAG9
$VS2     EQU   $FLAG8
$VS1     EQU   $FLAG8
$EDOS    EQU   $FLAG8
@NM00034 EQU   $FLAG8
$TWOWAY  EQU   $FLAG8
@NM00033 EQU   $FLAG8
$RCVMSG  EQU   $FLAG7
$RCVRFLG EQU   $FLAG7
$SNDRFLG EQU   $FLAG7
$LDOIS   EQU   $FLAG7
$DCONTCT EQU   $FLAG7
$EXIOWAT EQU   $FLAG7
$2NDDATA EQU   $FLAG7
$1STDATA EQU   $FLAG7
$CIREQ   EQU   $FLAG6
$ABTERM  EQU   $ABNDBIT
$FSTMCIS EQU   $FLAG6
$DISCREQ EQU   $FLAG6
$DISCISS EQU   $FLAG6
$CHANGE  EQU   $FLAG6
$CTERROR EQU   $FLAG6
$RECAL11 EQU   $FLAG6
@NM00032 EQU   $FLAG5
$PROGCK  EQU   $CANCEL
$PRINTAP EQU   $FLAG5
@NM00031 EQU   $FLAG5
$MSG922  EQU   $FLAG5
$CT924   EQU   $FLAG5
$FSTCAT  EQU   $FLAG5
$FSTFE   EQU   $FLAG5
$ACTOPND EQU   $FLAG4
$ACQCUTT EQU   $FLAG4
$CLSSACT EQU   $FLAG4
$BACKINT EQU   $FLAG4
$DMSGSW  EQU   $FLAG4
$TSTDEVP EQU   $FLAG4
$OPCOM   EQU   $FLAG4
$PRTONLY EQU   $FLAG3
$REQSTOR EQU   $FLAG3
$LOGOFFE EQU   $FLAG3
$TSTERR  EQU   $FLAG3
$DEVERR  EQU   $FLAG3
$PARTIAL EQU   $FLAG2
$NRMTERM EQU   $FLAG2
$VALDTST EQU   $FLAG2
$VALDDEV EQU   $FLAG2
$DBLSLSH EQU   $FLAG2
$NDR     EQU   $FLAG2
@NM00030 EQU   $FLAG2
$NORELDV EQU   $FLAG1
@NM00029 EQU   $FLAG1
$OPTCHNG EQU   $FLAG1
$DEVCHNG EQU   $FLAG1
$TESTCNG EQU   $FLAG1
$CNSLFG  EQU   $FLAG1
$TEP3RD  EQU   $FLAG1
@NM00028 EQU   $CDA+120
$CUCNT   EQU   $CDA+118
@NM00027 EQU   $CDA+117
$PRTFORM EQU   $CDA+116
$OPISCNT EQU   $CDA+114
$OPNDCNT EQU   $CDA+112
$GETMSZE EQU   $CDA+110
$GRCNTS  EQU   $CDA+108
$CTLCNT  EQU   $CDA+106
$ACTLVL  EQU   $CDA+105
$TIMEALW EQU   $CDA+96
$PTRAREA EQU   $CDA+92
$GETMPTR EQU   $CDA+88
$R13PTRT EQU   $CDA+84
$R13PTR  EQU   $CDA+80
$TEPEND  EQU   $CDA+76
$PLINKDL EQU   $CDA+72
$TEPBEGN EQU   $CDA+68
$FRELPTR EQU   $CDA+64
$HIGHADR EQU   $HIMOREC
$LOMOREC EQU   $CDA+56
$ENDCOMM EQU   $CDA+48
$COMMON  EQU   $RCA
$PASSON  EQU   $CDA+28
$TOLBRTB EQU   $CDA+24
$SCTPTR8 EQU   $CDA+20
$SCTPTR  EQU   $CDA+16
$TBWDPTR EQU   $CDA+12
$TFWDPTR EQU   $CDA+8
@NM00026 EQU   $CDA
@NM00025 EQU   $SCTTBLE+98
$SCTLWTC EQU   $SCTTBLE+96
$SCTLWTA EQU   $SCTTBLE+92
#EXT     EQU   $SCTTBLE+88
#PASS    EQU   $SCTTBLE+84
#TABLE   EQU   $SCTTBLE+80
#MSGIDAC EQU   $SCTTBLE+78
@NM00024 EQU   $SCTTBLE+71
$RETMASK EQU   $SCTTBLE+70
$R249255 EQU   $ROUTMSK+29
$R241248 EQU   $ROUTMSK+28
$R233240 EQU   $ROUTMSK+27
$R225232 EQU   $ROUTMSK+26
$R217224 EQU   $ROUTMSK+25
$R209216 EQU   $ROUTMSK+24
$R201208 EQU   $ROUTMSK+23
$R193200 EQU   $ROUTMSK+22
$R185192 EQU   $ROUTMSK+21
$R177184 EQU   $ROUTMSK+20
$R169176 EQU   $ROUTMSK+19
$R161168 EQU   $ROUTMSK+18
$R153160 EQU   $ROUTMSK+17
$R145152 EQU   $ROUTMSK+16
$R137144 EQU   $ROUTMSK+15
$R129136 EQU   $ROUTMSK+14
$R121128 EQU   $ROUTMSK+13
$R113120 EQU   $ROUTMSK+12
$R105112 EQU   $ROUTMSK+11
$R097104 EQU   $ROUTMSK+10
$R089096 EQU   $ROUTMSK+9
$R081088 EQU   $ROUTMSK+8
$R073080 EQU   $ROUTMSK+7
$R065072 EQU   $ROUTMSK+6
$R057064 EQU   $ROUTMSK+5
$R049056 EQU   $ROUTMSK+4
$R041048 EQU   $ROUTMSK+3
$R033040 EQU   $ROUTMSK+2
$R025032 EQU   $ROUTMSK+1
$R017024 EQU   $ROUTMSK
$TOTFLG2 EQU   $SCTTBLE+39
@NM00023 EQU   $TOTFLG1
@NM00022 EQU   $TOTFLG1
@NM00021 EQU   $TOTFLG1
$CURELOD EQU   $TOTFLG1
$CTEQTT  EQU   $TOTFLG1
@NM00020 EQU   $TOTFLG1
@NM00019 EQU   $TOTFLG1
$LINESHR EQU   $TOTFLG1
@NM00018 EQU   $OLTFLG2
@NM00017 EQU   $OLTFLG2
@NM00016 EQU   $OLTFLG2
@NM00015 EQU   $OLTFLG2
@NM00014 EQU   $OLTFLG2
@NM00013 EQU   $OLTFLG2
@NM00012 EQU   $OLTFLG2
$TALK    EQU   $OLTFLG2
$DYCOM   EQU   $OLTFLGS
@NM00011 EQU   $OLTFLGS
$RETCODE EQU   $OLTFLGS
$CONTCB  EQU   $OLTFLGS
$RETAIN  EQU   $OLTFLGS
$CLEANRT EQU   $OLTFLGS
$OLTSIZE EQU   $SCTTBLE+34
$QSCTMOD EQU   $EXECFLG
$CTRLMOD EQU   $EXECFLG
$CLEANUP EQU   $EXECFLG
$LSTPDEV EQU   $EXECFLG
$RTNSLCT EQU   $EXECFLG
$MULTDEV EQU   $EXECFLG
@NM00010 EQU   $EXECFLG
$RMSKCNT EQU   $SCTTBLE+32
$SYNAME  EQU   $CDS8T19+4
$EXTSIG  EQU   $CDS8T19+3
$CDFLGS  EQU   $CDS8T19+1
$CDSCNT  EQU   $CDS8T19
$PDEVDSC EQU   $SCTTBLE+16
$PDEVADR EQU   $SCTTBLE+12
$COMMCN  EQU   $CDSFLGS
$CUSTSYM EQU   $CDSFLGS
$TWOCHSW EQU   $CDSFLGS
$SYMNAME EQU   $CDSFLGS
$EXTINTC EQU   $CDSFLGS
$CEVOL   EQU   $CDSFLGS
$SHARED  EQU   $CDSFLGS
$FPM     EQU   $CDSFLGS
$LASTSUB EQU   $PDEVFLG
@NM00009 EQU   $PDEVFLG
@NM00008 EQU   $PDEVFLG
@NM00007 EQU   $PDEVFLG
$LASTDEV EQU   $PDEVFLG
@NM00006 EQU   $PDEVFLG
$EXFILPT EQU   $PDEVFLG
$FPMOLD  EQU   $PDEVFLG
$TSSSYM  EQU   $SCTTBLE+8
$SCTLEVL EQU   $SCTTBLE+7
$DRIVER  EQU   $SCTTBLE+6
$RT0916  EQU   $SCTTBLE+5
$RT0108  EQU   $SCTTBLE+4
$CATERR  EQU   $ERROPT
$ASTERIK EQU   $ERROPT
$TESTERR EQU   $ERROPT
$PARAPRT EQU   $TESTOPT
@NM00005 EQU   $TESTOPT
$TLTEND  EQU   $RCAAREA+936
$EXITSAV EQU   $RCAAREA+864
$TRASCII EQU   $RCAAREA+608
@NM00004 EQU   $RCAAREA+605
$VTAMEND EQU   $RCAFLG
$TPPOSTD EQU   $RCAFLG
$NEWCT   EQU   $RCAFLG
$ABNDALL EQU   $RCAFLG
$CUTESTB EQU   $RCAFLG
$CONSOLE EQU   $RCAFLG
$TPLOGON EQU   $RCAFLG
$UPDATE  EQU   $RCAFLG
$DEVAREA EQU   $RCAAREA+600
$CTDVAR  EQU   $RCAAREA+596
$BUFFS   EQU   $RCAAREA+464
$TLTNIB  EQU   $CONSTNT+140
$TLTPRPL EQU   $CONSTNT+20
@NM00003 EQU   $CONSTNT+4
@NM00002 EQU   $CONSTNT+2
$USECNT  EQU   $CONSTNT
$CURRTWA EQU   $POINTER+140
$CTNAME  EQU   $POINTER+132
$CTARGX  EQU   $POINTER+128
$COMINT  EQU   $POINTER+120
$QUEHNDL EQU   $POINTER+116
@NM00001 EQU   $POINTER+36
$RTNPTR  EQU   $POINTER+32
$TLTECB2 EQU   $POINTER+28
$TLTECB1 EQU   $POINTER+24
$CLEANP  EQU   $POINTER+20
$ABEND   EQU   $POINTER+16
$LSTAREA EQU   $POINTER+12
$FSTAREA EQU   $POINTER+8
$CVTSAVE EQU   $POINTER+4
$TOLTEP  EQU   $POINTER
$TLTACB  EQU   $RCAAREA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00104 EQU   OPT900
@RT00124 EQU   OPT300
@RT00132 EQU   OPT200
@RT00139 EQU   OPT100
@RF00151 EQU   OPT070
@RF00158 EQU   OPT070
@RF00165 EQU   OPT070
@RF00172 EQU   OPT070
@RF00179 EQU   OPT070
@RF00186 EQU   OPT070
@RT00199 EQU   OPT800
@RT00217 EQU   OPT900
@RF00222 EQU   OPT070
@RF00266 EQU   OPT070
@RT00276 EQU   OPT355
@RT00290 EQU   OPT800
@RT00302 EQU   OPT800
@RT00304 EQU   OPT370
@RT00320 EQU   OPT890
@RT00327 EQU   OPT070
@RT00355 EQU   OPT430
@RT00373 EQU   OPT890
@RT00384 EQU   OPT800
@RT00400 EQU   OPT820
@RT00428 EQU   OPT900
@ENDDATA EQU   *
         END   ISTIC005,(C'PLS1836',0701,75184)

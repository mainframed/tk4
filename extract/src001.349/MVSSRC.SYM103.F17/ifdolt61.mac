         TITLE 'IFDOLT61 DEVICE DECODE 2'
         LCLA  &T,&SPN                                            0001
.@001    ANOP                                                     0001
IFDOLT61 CSECT ,                                                  0001
         BC    15,24(0,@F)
         DC    C'IFDOLT61 14 FEB 78'                             0001
         STM   @E,@C,12(@D)                                       0001
         BALR  @B,0                                               0001
@PSTART  DS    0H                                                 0001
         USING @PSTART+00000,@B                                   0001
         ST    @D,@SAV001+4                                       0001
         LA    @F,@SAV001                                         0001
         ST    @F,8(0,@D)                                         0001
         LR    @D,@F                                              0001
         TITLE 'IFDOLT61 DEVICE DECODE 2'
         DS    0H
*         GEN(USING CHASCT,2);     /* SECTION CONTROL TABLE.    S21052*
         USING CHASCT,2
         DS    0H
*         GENERATE DATA;           /* COMMON AREA DSECT.        S21052*
*         /************************************************************
*         /*                        REGISTERS                   S21052*
*         /************************************************************
*
*         DCL R0 REG(0) PTR(31);   /* REGISTER 0 NAME           S21052*
*         DCL R1 REG(1) PTR(24);   /* REGISTER 1 NAME           S21052*
*         DCL R2 REG(2) PTR(31);   /* REGISTER 2 NAME           S21052*
*         DCL R3 REG(3) PTR(31);   /* REGISTER 3 NAME           S21052*
*         DCL R4 REG(4) PTR(31);   /* REGISTER 4 NAME           S21052*
*         DCL R5 REG(5) PTR(31);   /* REGISTER 5 NAME           S21052*
*         DCL GOODENT REG(6) PTR;  /* VALID DEV TAB COUNTER.    S21052*
*         DCL UCBLOOK REG(7) PTR;  /* LOOK UP UCB'S, IN SVC 59. S21052*
*         DCL DEVTABPT REG(8) PTR; /* PTR TO CURRENT DEV TAB LOC.
*                                                               S21052*
*         DCL R8 REG(8) PTR(31);                              /*X03008*
*         DCL R9 REG(9) PTR(24);   /* REGISTER 9 NAME           S21052*
*         DCL R13 REG(13) PTR(31); /* REGISTER 13 NAME          S21052*
*         DCL R14 REG(14) PTR(31); /* REGISTER 14 NAME          S21052*
*         DCL RC REG(15) PTR(31);  /* RETURN CODE REGISTER      S21052*
*         DCL R15 REG(15) PTR(31); /* REGISTER 15 NAME          S21052*
*         /************************************************************
*         /*                       SAVE AREAS                   S21052*
*         /************************************************************
*
*         DCL 1 MYSAVE BASED(R13), /*  MY SAVE AREA FORMAT      S21052*
*           3 * CHAR(4),
*           3 YOURR13 PTR(31);     /* CALLERS SAVE AREA ADDRESS S21052*
*
*
*         /*           CALLERS SAVE AREA FORMAT                 S21052*
*         DCL 1 YOURSAVE BASED(YOURR13),
*           3 * CHAR(12),
*           3 YOURR14 PTR(31);     /* CALLERS RETURN POINT      S21052*
*         /************************************************************
*         /*                  SECTION CONTROL TABLE             S21052*
*         /************************************************************
*
*         DCL CHASCT CHAR(88) GEND;
*
*
*         /*          FORMAT OF SCT                             S21052*
*         DCL 1 SCT BASED(ADDR(CHASCT)),
*           3 HEADER CHAR(8),      /* HEADER, NOT REFERENCED HERE
*                                                               S21052*
*           3 PRIDVSCT CHAR(12),   /* PRIMARY DEVICE ENTRY .    S21052*
*             5 * CHAR(2),
*             5 PRIDVFLG CHAR(1),  /*PRIMARY DEVICE FLAGS.      S21052*
*             5 * CHAR(1),
*             5 PRIDVAD CHAR(4),   /* PRIMARY DEVICE ADDRESS.   S21052*
*               7 * CHAR(2),
*               7 PRIHEXAD CHAR(2),/* PRIM DEV ADDR IN HEX.     S21052*
*             5 PRIDVDSC CHAR(4),  /* PRIMARY DEVICE DESCRIPTORS.
*                                                               S21052*
*           3 SECDVSCT CHAR(12),   /* SECONDARY DEVICE ENTRY.   S21052*
*             5 * CHAR(2),
*             5 SECDVFLG CHAR(1),  /* SECONDARY DEVICE FLAGS.   S21052*
*             5 * CHAR(1),
*             5 SECDVAD CHAR(4),   /* SECONDARY DEVICE ADDRESS. S21052*
*               7 * CHAR(2),
*               7 SECHEXAD CHAR(2),/* SEC DEV ADDR IN HEX.      S21052*
*             5 SECDVDSC CHAR(4);  /* SEC DEV DESCRIPTORS.      S21052*
*         /************************************************************
*         /*                       INPUT BUFFER                 S21052*
*         /************************************************************
*
*
*         /*          OVERLAY OF INPUT BUFFER                   S21052*
*         DCL INBUFR CHAR(120) GEND;
*
*         /*          OVERLAY OF INPUT BUFFER                   S21052*
*         DCL INPUTBUF CHAR(10) BASED(R5);
*
*         /*          POINTER TO INPUT BUFFER CHARACTER         S21052*
*         DCL INBUFPTR PTR(31) GEND;
*
*
*         /************************************************************
*         /*                        SWITCHES                    S21052*
*         /************************************************************
*
*         DCL CESWT CHAR(1) GENERATED;
*
*
*         /*          CE SWITCH FORMAT                          S21052*
*         DCL 1 OLTEPSW BASED(ADDR(CESWT)),
*           3 * BIT(4),
*           3 LEGALDEV BIT(1),     /* VALID DEVICE ENTRY MADE.  S21052*
*           3 REINT BIT(1);        /* REINITIALIZATION FLAG.    S21052*
*
*         DCL CESWT1 CHAR(1) GENERATED;
*
*
*         /*          CE SWITCH 1 FORMAT                        S21052*
*         DCL 1 OLTEPSW1 BASED(ADDR(CESWT1)),
*           3 * BIT(6),
*           3 ONLINETP BIT(2),     /* ONLINE OK AND TP FLAGS.   S21052*
*             5 ONLINEOK BIT(1),   /* TP CU ONLINE OK FLAG.     S21052*
*             5 TPFLAG BIT(1);     /* TP CU TEST FLAG.          S21052*
*
*         DCL CESWT2 CHAR(1) GENERATED;
*
*
*         /*          CE SWITCH 2 FORMAT                        S21052*
*         DCL 1 OLTEPSW2 BASED(ADDR(CESWT2)),
*           3 * BIT(3),
*           3 CHANTEST BIT(1),     /* CHANNEL TEST FLAG.        S21052*
*           3 * BIT(1),
*           3 NDR BIT(1);          /* NO DEVICE REQUIRED FOR TEST
*                                                               S21052*
*
*         DCL CESWT7 CHAR(1) GEND;
*
*
*         /*          CE SWITCH 7 FORMAT                        S21052*
*         DCL 1 OLTEPSW7 BASED(ADDR(CESWT7)),
*           3 INCLST BIT(1),       /* INCLUSIVE SERIES OF DEVICES
*                                                               S21052*
*           3 RETTO31 BIT(1);      /* RET TO IFDOLT31, MORE DECOD
*                                                               S21052*
*
*         DCL CESWTR CHAR(1) GEND;      /* RETAIN SWITCHES      S21052*
*
*
*         /*          RETAIN CESWITCH FORMAT                          *
*         DCL 1 * BASED(ADDR(CESWTR)),
*           3 RETAINAC BIT(1),          /* IS RETAIN ACTIVE?          *
*           3 * BIT(1),
*           3 REMNOMSG BIT(1);          /* NO MSG FROM REMOTE         *
*         /************************************************************
*         /*          RETAIN SWITCH FORMATS                           *
*         /************************************************************
*
*         DCL CESWTR2 CHAR(1) GEND;     /* THIRD RETAIN FLAG          *
*
*         DCL 1 * BASED(ADDR(CESWTR2)), /* SWITCH STRUCTURE           *
*           3 * BIT(7),
*           3 DPMSGREI BIT(1);          /* DATA PROT MSG TO REM XM0097*
*
*         /************************************************************
*         /*                   SVC PARAMETER LIST               S21052*
*         /************************************************************
*
*
*         DCL ROPT CHAR(8) GENERATED;
*
*
*         /*          PARAMETER LIST FORMAT                     S21052*
*         DCL 1 SVCPLIST BASED(ADDR(ROPT)-4),
*           3 * CHAR(2),
*           3 MODNUM CHAR(2),      /* NAME OF CALLING MODULE.   S21052*
*           3 ADDRDEV PTR(31),     /* BEGIN ADDR FOR UCB LOOK-UP.
*                                                               S21052*
*           3 ENTRIES FIXED(31);   /* NUMBER OF LOOK-UPS TO DO. S21052*
*         DCL DEVTBPTR PTR GEND;   /* POINTER TO DEVICE TABLES. S21052*
*
*
*         /************************************************************
*         /*                FORMAT OF DEVTABLE ENTRY            S21052*
*         /************************************************************
*
*         /*          ANY DEVICE TABLE                          S21052*
*         DCL 1 DEVTABXX CHAR(56)  BASED(DEVTABPT),
*           3 DEVADDR CHAR(8),     /* EBCDIC DEVICE ADDRESS.    S21052*
*           3 UCBADDR PTR(31),     /* UCB ADDRESS.              S21052*
*           3 FLG1 CHAR(1),        /* FIRST DEV TAB FLAG FIELD. S21052*
*             5 ONOFF BIT(1),      /* DEV ON/OFF LINE STATUS FLAG
*                                                               S21052*
*             5 PRIMARY BIT(1),    /* PRIMARY DEVICE FLAG.      S21052*
*           3 * CHAR(1),           /* SECOND FLAG FIELD.        S21052*
*           3 FLG3 CHAR(1),        /* THIRD FLAG FIELD.         S21052*
*             5 ANRNOTST BIT(1),   /* ANR DEVICE NOT TESTABLE.  S21052*
*             5 * BIT(3),
*             5 NOTEST BIT(1),     /* DEV NOT TESTABLE         XA00530*
*             5 SYSALLOC BIT(1),   /* DEV ALLOCATED IN SYS     XA00530*
*           3 * CHAR(1),           /* FOURTH FLAG FIELD.        S21052*
*           3 * CHAR(16),          /* TAPE LABEL, EXTENTS,MODE SAVE.
*                                                               S21052*
*           3 HEXADDR CHAR(4),     /* DEVICE ADDR IN HEX.       S21052*
*           3 CDSDVDSC CHAR(4),    /* CDS DEVICE DSCRPTRS.      S21052*
*             5 MODEL CHAR(1),     /* MODEL OF DEVICE.          S21052*
*             5 FEATURES CHAR(1),  /* DEVICE FEATURES.          S21052*
*             5 CLASS CHAR(1),     /* CLASS OF DEVICE.          S21052*
*             5 TYPE CHAR(1),      /* DEVICE TYPE.              S21052*
*           3 BYTECNT CHAR(1),     /* CDS BYTE COUNT.           S21052*
*           3 CDSFLAGS CHAR(1),    /* CDS FLAG BYTE.            S21052*
*             5 * BIT(4),
*             5 SYMDEVIC BIT(1),   /* DEV HAS SYMBOLIC NAME.    S21052*
*             5 * BIT(2),
*             5 REMLINE BIT(1),    /* REMOTE LINE TO ENABLE.    S21052*
*           3 EXTSGMSK CHAR(2),    /* EXTERNAL SIGNAL MASK.     S21052*
*           3 SYMNAME CHAR(8);     /* SYMBOLIC NAME OF DEVICE.  S21052*
*         /************************************************************
*         /*                        MESSAGES                    S21052*
*         /************************************************************
*
*
*         DCL IFDMSG61 LABEL NONLOCAL EXTERNAL;
*
*
*         /*          POINTERS TO MESSAGES                      S21052*
*         DCL 1 MSGPTR BASED(R4),
*           3 MSGPTR09 PTR(31),    /* MESSAGE IFD109I.          S21052*
*           3 MSGPTR10 PTR(31),    /* MESSAGE IFD110I.          S21052*
*           3 MSGPTR11 PTR(31),    /* MESSAGE IFD111I.          S21052*
*           3 MSGPTR14 PTR(31),    /* MESSAGE IFD114I.          S21052*
*           3 MSGPTR27 PTR(31),
*           3 MSGPTR54 PTR(31);         /* MESSAGE IFD154I.     X02906*
*
*
*         /*          MESSAGE IFD109I FORMAT                    S21052*
*         DCL 1 MSG109 BASED(R1),
*           3 * CHAR(12),
*           3 MSG109I CHAR(28);   /* MSG IFD109I TEST                 *
*
*
*         DCL 1 MSG154 BASED(R1),       /* MESSAGE IFDOLT  154  X02906*
*           3 * CHAR(12),               /* FLAGS FOR ROUTING    X02906*
*           3 MSG154I CHAR(60);         /* MESSAGE TEXT.        X02906*
*
*         DCL 1 MSG127 BASED(R1),
*           3 * CHAR(12),
*           3 MSG127I CHAR(19);
*         /************************************************************
*         /*            OTHER COMMON AREA CONSTANTS USED        S21052*
*         /************************************************************
*
*         DCL UNICTR CHAR(1) GEND; /* GOOD DEV ENTRY COUNTER.   S21052*
*
*         DCL TPSAVE CHAR(4) GEND; /* TEST TYPE SAVE AREA.      S21052*
*
*
*         /*          TEST TYPE SAVE AREA STRUCTURE             S21052*
*         DCL 1 TPSAV CHAR(4) BASED(ADDR(TPSAVE)),
*           3 * CHAR(3),
*           3 TPSAVE3 CHAR(1);     /* TP CU 2701,2,3 TEST TYPE. S21052*
*
*         /* POINTER TO ACTIVE SECTION ENTRY IN SECTION CONTROL TABLE
*                                                               S21052*
*         DCL DEVDEPAD PTR(31) GEND;
*
*         /* ENTRY IN IFDOLT30 TO REDEFINE TEST DEFINITION      S21052*
*         DCL REDEFINE PTR(31) GEND;
*
*         /* PTR TO PRIMARY DEV TABLE.  IN SCT.                 S21052*
*         DCL PRIDVPTR PTR(31) GEND;
*
*         /* PTR TO LAST GRABBED DEVICE TABLE. IN SCT.          S21052*
*         DCL SECDVPTR PTR(31) GEND;
*
*         /* LENGTH OF EACH DEVICE TABLE ENTRY                  S21052*
*         DCL TABLNGTH FIXED(15) GEND;
*
*         DCL PSCT PTR(31) GEND;   /* POINTER TO SCT.           S21052*
*         DCL UNITUSE CHAR(1) GEND;/* NUMBER OF DEVS TESTED CNTR.
*                                                               S21052*
*
*         /*          DEVICE TABLE AREA IN COMMON AREA          S21052*
*         DCL 1 * BASED(R8),       /* DEVICE TABLE              X03008*
*               3 DVT CHAR(16),    /* TABLE AREA                X03008*
*               3 DVTN CHAR(16);   /* NEXT TABLE AREA           X03008*
*         DCL TUCBAD1 PTR(31) GEND;/* PTR TO PRIM DEV UCB.      S21052*
*         DCL TUCBAD2 PTR(31) GEND;/* PTR TO SECONDARY DEV UCB. S21052*
*
*
*
*         /*          EXECUTIVE PROGRAM FLAGS IN SCT            S21052*
*         DCL 1 EXPGMFLG CHAR(1) BASED(ADDR(CHASCT)+33),
*           3 * BIT(1),
*           3 MORETHN1 BIT(1);     /* MORE THAN ONE DEV ENTERED S21052*
*
*         DCL NEXTREC PTR(31) GEND;/* READ NEXT REC IN IFDOLT31 S21052*
*         DCL TAB28 PTR(31) GEND;  /* NEW MACRO ENTRY POINT.    S21052*
*         /************************************************************
*         /*                   INTERNAL CONSTANTS               S21052*
*         /************************************************************
*
*         DCL CECDEV04 LABEL;
*
*
*         /*          SAVE INCLUSIVE ENTRIES                    S21052*
*         DCL 1 SAVENT PTR(31) GEND,
*           3 FRSTINCL FIXED(15),  /* FIRST INCLUSIVE SERIES DEV.
*                                                               S21052*
*           3 LASTINCL FIXED(15);  /* LAST INCLUSIVE SERIES DEV.S21052*
*
*         DCL AVAILBLE PTR(31);    /* NEXT AVAILABLE DEVICE TABLE
*                                                               S21052*
*
*         /*          SAVE COUNTER FOR NUMBER OF VALID DEV TABS BUILT
*                                                               S21052*
*         DCL SAVECNT FIXED(15) GEND;
*
*         /*          DEVICE TABLE OVERLAY                      S21052*
*         DCL DEVTABLE CHAR(56) BASED(AVAILBLE);
*         DCL LIMIT FIXED(15);     /* MAX NUMBER OF UCB LOOKUPS.S21052*
*
*
*         /*          NUMBER OF DEVICE TABLES COUNTER AND WORK AREA
*                                                               S21052*
*         DCL 1 X FIXED(15),
*           3 UNITCTR FIXED(15),   /* DEVTABLE COUNTER.         S21052*
*             5 * CHAR(1),
*             5 UNITCTR1 CHAR(1);  /* DEVTABLE COUNTER.         S21052*
*
*         DCL ERRORTAB FIXED(15);       /* ERROR DEV TABLES CNTRX02906*
*         DCL X1 FIXED(15);        /* LOOP COUNTER.             S21052*
*         DCL COUNT FIXED(15);          /* LOOP COUNTER.         M4833*
*         DCL I FIXED(15);              /* LOOP COUNTER.         M4833*
*         DCL ERRCODE CHAR(2);     /* ERROR CODE IN MESSAGE.    S21052*
*
*
*         /*          GRAPHICS CONTROL UNIT DEVICE TABLE STRUCTURE
*                                                               S21052*
*         DCL 1 GRAPHICS CHAR(56) BDY(WORD),
*           3 EBADDR CHAR(8),      /* EBCDIC DEVICE ADDRESS.    S21052*
*             5 * CHAR(7),
*             5 DEVICE CHAR(1),    /* DEVICE NUMBER.            S21052*
*           3 * CHAR(4),
*           3 FLAG CHAR(1),        /* FLAG FIELD.               S21052*
*             5 OFF BIT(1);        /* DEVICE ON-OFF LINE STATUS.S21052*
*
*
*         /*          CHARACTER REPRESENTATION OF NUMBERS       S21052*
*         DCL NUMBERS CHAR(16) INIT('0123456789ABCDEF');
*
*         /*          LOOK AT ONE NUMBER                        S21052*
*         DCL NUMBER CHAR(1) BASED(R9);
*
*         /*          CONVERSION AREA HEX/DECIMAL               S21052*
*         DCL 1 DEVAD CHAR(8) INIT('00000000'),
*           3 DEVAD1 CHAR(8);      /* DEVICE ADDRESS WORK AREA. S21052*
*
*
*         /*          DEVICE DECODE INTERNAL SWITCHES           S21052*
*         DCL 1 SWITCHES CHAR(1),
*           3 FRSTPASS BIT(1);     /* FIRST DEVICE TABLE BUILT. S21052*
*
*
*         /*          CDS NAME WORK AREA                        S21052*
*         DCL 1 PARMLIST CHAR(16) BDY(WORD),
*           3 MODNAME CHAR(8),
*             5 TCDSO CHAR(1) INIT('G'),
*             5 CDSDEV CHAR(7),
*           3 TARGETAD PTR,
*           3 PARMFLGS CHAR(1),
*           3 * CHAR(1),
*           3 CDSLNGTH FIXED(15);
*
*
*         /*          UNIT CONTROL BLOCK (UCB) STRUCTURE        S21052*
*         DCL 1 UCBDVDSC CHAR(4) BASED(UCBADDR+16),
*           3 UCBMODEL CHAR(1),    /* DEVICE MODEL.             S21052*
*           3 UCBFEAT CHAR(1),     /* DEVICE FEATURES.          S21052*
*             5 * BIT(2),
*             5 SHAREDDV BIT(1),   /* DEV SHAREABLE >1 CPU            *
*             5 * BIT(5),
*           3 UCBCLASS CHAR(1),    /* DEVICE CLASS.             S21052*
*           3 UCBTYPE CHAR(1);     /* DEVICE TYPE.              S21052*
*
*
*         /*          LOADED CDS ENTRY FORMAT                   S21052*
*         DCL 1 CDSENTRY CHAR(20) BASED(R1),
*           3 * CHAR(4),
*           3 DSCRPTRS CHAR(4);    /* CDS DEVICE DESCRIPTORS.   S21052*
*         RESTRICT(R1,R2,R3,R4,R5,GOODENT,UCBLOOK,DEVTABPT,R9);
*         /************************************************************
*         /*                                                    S21052*
*         /*                   PERFORM INITIALIZATION           S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*         R4=ADDR(IFDMSG61);       /*POINTER TO MESSAGE MODULE. S21052*
         L     @C,@V1              ADDRESS OF IFDMSG61            0085
         LR    @4,@C                                              0085
*         R5=INBUFPTR;             /* POINTER TO INPUTBUFFER.   S21052*
         L     @5,INBUFPTR                                        0086
*         X=0;                     /* INIT DEVICE COUNTER.      S21052*
         SR    @F,@F                                              0087
         STH   @F,X                                               0087
*         SECDVPTR=0;              /* INIT LAST GRABBED DEVICE. S21052*
         ST    @F,SECDVPTR                                        0088
*         LEGALDEV='0'B;           /* TURN OFF VALID DEV ENTRY FLG
*                                                               S21052*
         NI    OLTEPSW,B'11110111'                                0089
*         ONLINETP='00'B;          /* ONLINEOK,TP FLAGS OFF.    S21052*
         NI    OLTEPSW1,B'11111100'                               0090
*         REINT='1'B;              /* TURN ON REINITIAL FLAG.   S21052*
         OI    OLTEPSW,B'00000100'                                0091
*         LIMIT=16-UNICTR;         /* CALC UNUSED DEVICE TABLES.S21052*
         LA    @F,16                                              0092
         SR    @0,@0                                              0092
         IC    @0,UNICTR                                          0092
         SR    @F,@0                                              0092
         STH   @F,LIMIT                                           0092
*
*         /*          IF RETAIN IS ACTIVE THEN SET NO REMOTE MSG FLAG *
*         IF RETAINAC='1'B THEN         /* IS  REI  ACTIVE?     S21052*
         TM    A00012,B'10000000'                                 0093
         BC    12,@9FF                                            0093
*         DPMSGREI='1'B;                /* REM SITE GETS MSG    XM0097*
         OI    A00014,B'00000001'                                 0094
*
*         /*          RETURN FROM IFDOLT31 INDICATED            S21052*
*         IF RETTO31='1'B THEN     /* SECOND TIME ENTERED.      S21052*
@9FF     TM    OLTEPSW7,B'01000000'                               0095
         BC    12,@9FE                                            0095
*          DO;                     /* YES, RESTORE OLD VALUES.  S21052*
*           DEVTABPT=DEVTBPTR+(SAVECNT*TABLNGTH);
         LH    @E,TABLNGTH                                        0097
         MH    @E,SAVECNT                                         0097
         A     @E,DEVTBPTR                                        0097
         LR    @8,@E                                              0097
*           AVAILBLE=DEVTABPT;     /* LOCATE DEVICE TABLES.     S21052*
         ST    @8,AVAILBLE                                        0098
*           GOODENT=SAVECNT;       /* REINIT GOOD ENTRIES COUNTES21052*
         LH    @6,SAVECNT                                         0099
*           X=SAVECNT;             /* REINIT MISC COUNTER.      S21052*
         MVC   X(2),SAVECNT                                       0100
*           GO TO CECDEV00;        /* CHECK DE5ICE 23A342.      S21052*
         BC    15,CECDEV00                                        0101
*          END;
*         GOODENT=0;               /* INIT VALID ENTRIES COUNTER.
*                                                               S21052*
@9FE     SR    @6,@6                                              0103
*         DEVTABPT=DEVTBPTR;       /* INITIALIZE DEVICE TABLE PTR
*                                                               S21052*
         L     @8,DEVTBPTR                                        0104
*         AVAILBLE=DEVTABPT;       /* NEXT AVAILABLE DEV TABLE. S21052*
         ST    @8,AVAILBLE                                        0105
*
*
* CECDEV00:                             /*                      S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*                ON-LINE / OFF-LINE CHECK            S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*         /*          LOCAL OR REMOTE ANR DEVICE IN SYSTEM      S21052*
*         IF ANRNOTST='1'B ×       /* ANR DEV OK TO TEST       XA00530*
*            NOTEST='1'B THEN      /* IS DEVICE TESTABLE?      XA00530*
CECDEV00 TM    14(@8),B'10000000'                                 0106
         BC    01,@9FD                                            0106
         TM    14(@8),B'00001000'                                 0106
         BC    12,@9FC                                            0106
*           GO TO CECDEV14;        /* NO, NOT A VALID ENTRY.   XA00530*
         BC    03,CECDEV14                                        0107
*
*         /*          CHECK DEVICE ON LINE STATUS               S21052*
*         IF ONOFF='1'B THEN       /* IS DEVICE ONLINE.         S21052*
@9FC     TM    12(@8),B'10000000'                                 0108
*           GO TO CECDEV04;        /* YES, CHECK DEVICE CLASS.  S21052*
         BC    01,CECDEV04                                        0109
*         IF SYSALLOC='1'B THEN    /* DEV ALLOCATED? CHK CLASS XA00530*
         TM    14(@8),B'00000100'                                 0110
*           GO TO CECDEV04;        /* GO DO IT.                XA00530*
         BC    01,CECDEV04                                        0111
*
*         /*          CHECK FOR GRAPHICS 2250 DEVICE--CLASS     S21052*
*         IF UCBCLASS^='10'X       /* NO, IS IT GRAPHICS.       S21052*
*           THEN                   /* YES                       S21052*
         MVC   @TEMP4(4),8(@8)                                    0112
         L     @C,@TEMP4           
         CLI   18(@C),X'10'                                       0112
*           GO TO CECDEV10;        /* GO TO PUSH UP ROUTINE.    S21052*
         BC    07,CECDEV10                                        0113
*
*         /*          CHECK FOR GRAPHICS 2250 DEVICE--TYPE      S21052*
*         IF UCBTYPE^='02'X        /* YES, IS IT A 2250.        S21052*
*           THEN                   /* YES                       S21052*
         CLI   19(@C),X'02'                                       0114
*           GO TO CECDEV10;        /* NO, CONTINUE CLASSIFICATION.
*                                                               S21052*
         BC    07,CECDEV10                                        0115
*
*         /*          CHECK FOR GRAPHICS 2250 DEVICE--MODEL     S21052*
*         IF UCBMODEL='31'X        /* YES, IT IS A MODEL 1.     S21052*
*           THEN                   /* YES                       S21052*
         CLI   16(@C),X'31'                                       0116
*           GO TO CECDEV10;        /* YES, TO TO PUSH UP ROUTINE.
*                                                               S21052*
         BC    08,CECDEV10                                        0117
*         GRAPHICS=GRAPHICS&&GRAPHICS;
         XC    GRAPHICS(56),GRAPHICS                              0118
*         EBADDR=DEVADDR;          /* SAVE GRAPHICS DEVICE ADDR.S21052*
         MVC   GRAPHICS(8),0(@8)                                  0119
*         ADDRDEV=ADDR(GRAPHICS);  /* FILL SVC 59 POINTER.      S21052*
         LA    @F,GRAPHICS                                        0120
         ST    @F,SVCPLIST+4                                      0120
*         ENTRIES=1;               /* CHECK ONE ENTRY AT A TIME.S21052*
         LA    @F,1                                               0121
         ST    @F,SVCPLIST+8                                      0121
*         R9=ADDR(NUMBERS);        /* GET PTR TO NUMBER TABLE.  S21052*
         LA    @9,NUMBERS                                         0122
*         /*          CHECK ALL DEVICES ON GRAPHICS CONTROL UNITS21052*
*         DO X1=16 TO 1
*          BY -1;                  /* CHECK CU LINE STATUS.     S21052*
         LA    @F,16                                              0123
         STH   @F,X1                                              0123
*          DEVICE=NUMBER;          /* PUT NUMBER IN DEV ADDR.   S21052*
@DO9FB   MVC   GRAPHICS+7(1),0(@9)                                0124
*          RESTRICT(R1);           /* RESTRICT REG FOR COMPUTATION.
*                                                               S21052*
*          R1=64;                  /* SVC 59 CALLING CODE.      S21052*
         LA    @1,64                                              0126
*          R0=ADDR(ADDRDEV);       /* PARAMETER LIST IN REG 0.  S21052*
         LA    @0,SVCPLIST+4                                      0127
*          RELEASE(R1);            /* RELEASE REG FOR FURTHER USE
*                                                               S21052*
*          GEN(SVC  59);           /* SVC 59 FOR UCB LOOKUP.    S21052*
         SVC  59
         DS    0H
*
*          /*         IS GRAPHICS DEVICE ONLINE                 S21052*
*          IF OFF='1'B THEN        /* IS DEVICE OFFLINE.        S21052*
         TM    GRAPHICS+12,B'10000000'                            0130
         BC    12,@9F7                                            0130
*           DO;                    /* YES, CHECK NEXT DEVICE.   S21052*
*
*            /*       GRAPHICS DEVICE CHECK MADE HERE           S21052*
*            IF GRAPHICS(6)^='10'X
*             THEN                 /* CHECK FOR                 S21052*
         CLI   GRAPHICS+5,X'10'                                   0132
*             GO TO CECDEV02;      /* NOT GRAPHICS,CHECK NEXT DEV
*                                                               S21052*
         BC    07,CECDEV02                                        0133
*
*            /*       GRAPHICS DEVICE CHECK MADE HERE           S21052*
*            IF GRAPHICS(7)^='02'X
*             THEN                 /* CONTINUE,                 S21052*
         CLI   GRAPHICS+6,X'02'                                   0134
*             GO TO CECDEV02;      /* CHECK NEXT CU DEVICE.     S21052*
         BC    07,CECDEV02                                        0135
*
*            /*       GRAPHICS DEVICE CHECK MADE HERE           S21052*
*            IF GRAPHICS(5)='31'X
*             THEN                 /* CONTINUE,                 S21052*
         CLI   GRAPHICS+4,X'31'                                   0136
*             GO TO CECDEV02;      /* CHECK NEXT CU DEVICE.     S21052*
         BC    08,CECDEV02                                        0137
*            R1=MSGPTR14;          /* PRINT ERROR MESSAGE.      S21052*
         L     @1,12(0,@4)                                        0138
*            GEN(PWTO REG=(R1));
         PWTO REG=(R1)
         DS    0H
*            GO TO CECDEV26;       /* GO AND REDEFINE TEST.     S21052*
         BC    15,CECDEV26                                        0140
*           END;
*
*
* CECDEV02:                        /*                           S21052*
*
*          GRAPHICS(4:16)=GRAPHICS(4:16)&&GRAPHICS
*           (4:16);                /* CLEAR DEVICE TABLE AREA.  S21052*
@9F7     EQU   *                                                  0142
CECDEV02 XC    GRAPHICS+3(13),GRAPHICS+3                          0142
*          R9=R9+1;                /* POINT TO NEXT NUMBER.     S21052*
         LA    @9,1(0,@9)                                         0143
*         END;                     /* END GRAPHICS LOOP.        S21052*
*         GO TO CECDEV10;          /* GO TO DEV TAB PUSH UP ROUTN.
*                                                               S21052*
         LH    @F,X1                                              0144
         BCTR  @F,0                                               0144
@DO9FA   STH   @F,X1                                              0144
         CH    @F,@D1                                             0144
         BC    10,@DO9FB                                          0144
         BC    15,CECDEV10                                        0145
*
*
* CECDEV04:                             /*                      S21052*
*
*         /************************************************************
*         /*          ONLINE ALLOCATION CHECKS                 XA00530*
*         /************************************************************
*
*         /*          REMOTE TELEPROCESSING DEVICE ENTERED      S21052*
*         IF REMLINE='1'B THEN     /* IF REMOTE DEVICE IS NOT OFS21052*
CECDEV04 TM    41(@8),B'00000001'                                 0146
*           GO TO CECDEV06;        /* LINE, CAN'T TEST. PRINT MSG
*                                                               S21052*
         BC    01,CECDEV06                                        0147
*
*         /*          CHECK ANR DEVICE CLASS & TYPE             S21052*
*         IF UCBCLASS='10'X &      /* IF ANR DEVICE IS ONLINE,  S21052*
*            UCBTYPE>'08'X &               /* ANR DEVICE?      XA00530*
*            UCBTYPE<'0C'X THEN    /* WITHIN RANGE OF TYPES?   XA00530*
         MVC   @TEMP4(4),8(@8)                                    0148
         L     @1,@TEMP4           
         CLI   18(@1),X'10'                                       0148
         BC    07,@9F6                                            0148
         CLI   19(@1),X'08'                                       0148
         BC    12,@9F5                                            0148
         CLI   19(@1),X'0C'                                       0148
*              GO TO CECDEV10;     /* LOCAL 3270 DEVICE.       XA00530*
         BC    05,CECDEV10                                        0149
*         /*          CLASS 40 RESERVED FOR TELECOMMUNICATIONS DEVICES
*                                                               S21052*
*         IF UCBCLASS='40'X THEN   /* IS IT TELECOMMUNICATIONS. S21052*
@9F4     EQU   *                                                  0150
@9F5     EQU   *                                                  0150
@9F6     MVC   @TEMP4(4),8(@8)                                    0150
         L     @1,@TEMP4           
         CLI   18(@1),X'40'                                       0150
*           GO TO CECDEV06;        /* ONLINE ALLOCATED TP DEV
*                                                               S21052*
         BC    08,CECDEV06                                        0151
*
*         /*          CHECK FOR DASD DEVICES                    S21052*
*         IF UCBCLASS='20'X THEN    /* IS IT DASD?            @Y30LPAW*
         CLI   18(@1),X'20'                                       0152
*            GOTO CECDEV10;         /* YES,GO AROUND          @Y30LPAW*
         BC    08,CECDEV10                                        0153
*         IF UCBCLASS = '08'X &    /*  IS IT                  @ZA02796*
*             UCBTYPE = '42'X THEN /*        MSC?             @ZA02796*
         CLI   18(@1),X'08'                                       0154
         BC    07,@9F3                                            0154
         CLI   19(@1),X'42'                                       0154
*                 GOTO CECDEV10;    /* YES,GO AROUND          @Y30LPAW*
         BC    08,CECDEV10                                        0155
* CECDEV06:                             /*                      S21052*
*
*         /************************************************************
*         /*                 PRINT MESSAGE IFD109I              S21052*
*         /************************************************************
*
*
*         R1=MSGPTR09;             /* GET POINTER TO MESSAGE 109S21052*
@9F2     EQU   *                                                  0156
@9F3     EQU   *                                                  0156
CECDEV06 L     @1,0(0,@4)                                         0156
*         MSG109I(1:8)=DEVADDR;
         MVC   12(8,@1),0(@8)                                     0157
*         IF ONOFF='1'B             /* ONLINE DEVICE?          XA00530*
*          THEN
         TM    12(@8),B'10000000'                                 0158
         BC    12,@9F1                                            0158
*            MSG109I(10:17)='ONLINE ,';  /* DEV ONLINE IN MSG  XA00530*
         MVC   21(8,@1),@C12                                      0159
         BC    15,@9F0                                            0160
*          ELSE
*            MSG109I(10:17)='OFFLINE,';  /* DEV OFFLINE IN MSG XA00530*
@9F1     MVC   21(8,@1),@C13                                      0160
*         IF SYSALLOC='1'B         /*  IS DEV ALLOCATED?       XA00530*
*          THEN
@9F0     TM    14(@8),B'00000100'                                 0161
         BC    12,@9EF                                            0161
*           MSG109I(18:28)='ALLOCATED  ';  /* ALLOCATED IN MSG.XA00530*
         MVC   29(11,@1),@C14                                     0162
         BC    15,@9EE                                            0163
*          ELSE
*           MSG109I(18:28)='UNALLOCATED';  /* UNALLOCATED IN MSG.     *
@9EF     MVC   29(11,@1),@C15                                     0163
*         GEN( PWTO REG=(R1));          /* ISSUE MESSAGE 109I  XA00530*
@9EE     EQU   *                                                  0164
          PWTO REG=(R1)
         DS    0H
*         DEVTABXX=DEVTABXX
*          &&DEVTABXX;             /* CLEAR DEVICE TABLE.       S21052*
         XC    0(56,@8),0(@8)                                     0165
*         GO TO CECDEV14;          /* SKIP ENTRY.               S21052*
         BC    15,CECDEV14                                        0166
*
*
* CECDEV10:                             /*                      S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*          FIND LOCAL DEVICE CDS INFORMATION         S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*         IF SYMDEVIC='1'B THEN    /* SYMBOLIC DEVS ALREADY HAVES21052*
CECDEV10 TM    41(@8),B'00001000'                                 0167
*            GO TO CECDEV12;       /* CDS LOADED. MAKE DEVTAB CHK
*                                                               S21052*
         BC    01,CECDEV12                                        0168
*
*         /*          CHECK IF .CHXXXXXX DEVICE  ENTERED        S21052*
*         IF CHANTEST='1'B THEN    /* CHANNEL TESTS ALREADY HAVES21052*
         TM    OLTEPSW2,B'00010000'                               0169
*           GO TO CECDEV12;        /* CDS INFORMATION LOADED.   S21052*
         BC    01,CECDEV12                                        0170
*         CDSDEV=DEVADDR(2:8);
         MVC   PARMLIST+1(7),1(@8)                                0171
*         TARGETAD=DEVTABPT+32;
         LA    @F,32                                              0172
         AR    @F,@8                                              0172
         ST    @F,PARMLIST+8                                      0172
*         PARMFLGS='60'X;
         MVI   PARMLIST+12,X'60'                                  0173
*         CDSLNGTH='14'X;
         LA    @F,X'14'                                           0174
         STH   @F,PARMLIST+14                                     0174
*         GEN(IFDMOD  CALL='12',LIST=PARMLIST);
         IFDMOD  CALL='12',LIST=PARMLIST
         DS    0H
*         R1=RC;
         LR    @1,@F                                              0176
*         IF R1>0 THEN
         LTR   @1,@1                                              0177
         BC    12,@9ED                                            0177
*          DO;
*           CDSDVDSC=CDSDVDSC&&CDSDVDSC;
         XC    36(4,@8),36(@8)                                    0179
*           RESTRICT(1);
*           R1=MSGPTR27;
         L     @1,16(0,@4)                                        0181
*           MSG127I(12:19)=MODNAME;
         MVC   23(8,@1),PARMLIST                                  0182
*         MSG127I(12)='F0'X;            /* ZERO OUT 'G' FOR MSG X03008*
         MVI   23(@1),X'F0'                                       0183
*         GEN(PWTO REG=(1));
         PWTO REG=(1)
         DS    0H
*           RELEASE(1);
*           COUNT=72;                                        /*XA00530*
         LA    @F,72                                              0186
         STH   @F,COUNT                                           0186
*           DO I=1 TO COUNT BY +1;                           /*XA00530*
         LA    @F,1                                               0187
         BC    15,@DO9EB                                          0187
*             IF INPUTBUF(I)='/' THEN
@DO9EC   LH    @1,I                                               0188
         LA    @A,0(@1,@5)                                        0188
         BCTR  @A,0                                               0188
         CLI   0(@A),C'/'                                         0188
*              GO TO CECDV10A;
         BC    08,CECDV10A                                        0189
*            END;
* CECDV10A:
*           I=I+1;
         LH    @F,I                                               0190
         AH    @F,@D1                                             0190
@DO9EB   STH   @F,I                                               0190
         CH    @F,COUNT                                           0190
         BC    12,@DO9EC                                          0190
CECDV10A LA    @F,1                                               0191
         AH    @F,I                                               0191
         STH   @F,I                                               0191
*           IF INPUTBUF(I)='T' THEN
         LR    @1,@F                                              0192
         LA    @A,0(@1,@5)                                        0192
         BCTR  @A,0                                               0192
         CLI   0(@A),C'T'                                         0192
         BC    07,@9E8                                            0192
*            I=I+1;
         LA    @F,1                                               0193
         AH    @F,I                                               0193
         STH   @F,I                                               0193
*           IF INPUTBUF(I:I+5)='SOSPC/'           /*          @ZA29758*
*             THEN
@9E8     LH    @1,I                                               0194
         LA    @A,0(@1,@5)                                        0194
         BCTR  @A,0                                               0194
         CLC   0(6,@A),@C21                                       0194
         BC    07,@9E7                                            0194
*              DO;                      /* SOSP ENTERED        XA01010*
*               CDSDVDSC=UCBDVDSC;      /* INIT DV DSCRPT      XA01010*
         MVC   @TEMP4(4),8(@8)                                    0196
         L     @C,@TEMP4           
         MVC   36(4,@8),16(@C)                                    0196
*               IF SHAREDDV='1'B &      /* IF DASD SHAREABLE   XA01010*
*                UCBCLASS='20'X         /* DASD CLASS DEV      XA01010*
*                THEN                   /* THEN TURN ON        XA01010*
         MVC   @TEMP4(4),8(@8)                                    0197
         L     @C,@TEMP4           
         TM    17(@C),B'00100000'                                 0197
         BC    12,@9E6                                            0197
         CLI   18(@C),X'20'                                       0197
         BC    07,@9E5                                            0197
*                 CDSFLAGS=CDSFLAGS×'40'X; /* SHARED FLG IN CDSXA01010*
         OI    41(@8),X'40'                                       0198
*               GO TO CECDEV12;
         BC    15,CECDEV12                                        0199
*              END;
*           GO TO CECDEV14;
*          END;
* CECDEV12:                             /*                      S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*          ROUTINE TO REMOVE INVALID DEVICE TABLES   S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*         GOODENT=GOODENT+1;       /* INCREMENT VALID EN3R8 CN3R.
*                                                               S21052*
@9ED     EQU   *                                                  0203
CECDEV12 AH    @6,@D1                                             0203
*         DEVTABLE=DEVTABXX;       /* ADDRESS AVAILABLE DEV TAB.S21052*
         L     @1,AVAILBLE                                        0204
         MVC   0(56,@1),0(@8)                                     0204
*
*         /*          CHECK IF LAST FILLED DEV TAB WAS PROPER ONE
*                                                               S21052*
*
*         IF AVAILBLE^=DEVTABPT    /* IS CORRECT DEV TAB FILLED S21052*
*           THEN                   /* NO, CLEAR INVALID DEVICE TABLE.
*                                                               S21052*
         C     @8,AVAILBLE                                        0205
         BC    08,@9E4                                            0205
*           DEVTABXX=DEVTABXX&&
*            DEVTABXX;             /* CLEAR OUT DEVICE TABLE.   S21052*
         XC    0(56,@8),0(@8)                                     0206
*         AVAILBLE=AVAILBLE+TABLNGTH;
@9E4     LH    @F,TABLNGTH                                        0207
         A     @F,AVAILBLE                                        0207
         ST    @F,AVAILBLE                                        0207
*
*
* CECDV12A:                        /*                           S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*          CHECK CONTROL UNIT LINES                  S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*
*         /*          IS THIS A CONTROL UNIT TEST               S21052*
*         IF TPSAVE(1:3)^='270'
*           THEN                   /* 2701,2702,2703 C U TEST   S21052*
CECDV12A CLC   TPSAVE(3),@C22                                     0208
*           GO TO CECDEV14;        /* NOT A 2701,2702,2703 TEST.S21052*
         BC    07,CECDEV14                                        0209
*
*         /*          IS THIS A 2701 CONTROL UNIT TEST          S21052*
*         IF TPSAVE3='1' THEN      /* IS IT A 2701 TEST.        S21052*
         CLI   TPSAV+3,C'1'                                       0210
*           GO TO CECDEV14;        /* YES, CONTINUE CHECKS.     S21052*
         BC    08,CECDEV14                                        0211
*
*         /*          HAVE ANY VALID DEVICES BEEN DECODED YET   S21052*
*         IF GOODENT=0 THEN        /* NO VALID ENTRY MADE, END  S21052*
         LTR   @6,@6                                              0212
*           GO TO CECDEV20;        /* THIS D/T/O/ ENTRY.        S21052*
         BC    08,CECDEV20                                        0213
*
*
* CECDEV14:                        /*                           S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*          CHECK FOR MORE OUTSTANDING DEVICES        S21052*
*         /************************************************************
*
*         X=X+1;                   /* INCREMENT DEV TAB COUNTER.S21052*
CECDEV14 LA    @F,1                                               0214
         AH    @F,X                                               0214
         STH   @F,X                                               0214
*         DEVTABPT=DEVTABPT+TABLNGTH;
         AH    @8,TABLNGTH                                        0215
*
*         /*          CHECK DEVICE COUNTER IN COMMON AREA       S21052*
*         IF X^=UNICTR  THEN       /* ARE ALL DEVICES CHECKED.  S21052*
         SR    @F,@F                                              0216
         IC    @F,UNICTR                                          0216
         CH    @F,X                                               0216
*           GO TO CECDEV00;        /* NO, LOOP.  YES, CONTINUE. S21052*
         BC    07,CECDEV00                                        0217
*
*         /*          CHECK FOR ANY DEVS FOUND ONLINE & DEV TABS FULL
*                                                               S21052*
*         IF UNICTR=16 &           /* FORMER VALID ENTRY FOUND OS21052*
*           GOODENT<16 THEN        /* LINE, RESET VARIABLES AND S21052*
         CLI   UNICTR,16                                          0218
         BC    07,@9E3                                            0218
         CH    @6,@D2                                             0218
         BC    10,@9E2                                            0218
*          DO;                     /* CONTINUE B8               S21052*
*           SAVECNT=GOODENT;       /* RETURN TO IFDOLT31.       S21052*
         STH   @6,SAVECNT                                         0220
*           UNICTR=GOODENT;        /* SAVE GOOD ENTRIES  TO DATES21052*
         ST    @6,@TEMP4                                          0221
         MVC   UNICTR(1),@TEMP4                                   0221
*           RETTO31='1'B;          /* SET RETURN FLAG.          S21052*
         OI    OLTEPSW7,B'01000000'                               0222
*           GO TO CECDEV28;        /* RETURN POINT .            S21052*
         BC    15,CECDEV28                                        0223
*          END;
*         RETTO31='0'B;            /* DON'T RETURN TO IFDOLT31. S21052*
@9E2     EQU   *                                                  0225
@9E3     NI    OLTEPSW7,B'00111111'                               0225
*         INCLST='0'B;             /* END OF INCLUSIVE SERIES.  S21052*
*
*         /*          ARE ALL DEV TABS FILLED WITH VALID DEVICESS21052*
*         IF GOODENT=16 THEN       /* ARE THERE 16 GOOD ENTRIES.S21052*
         CH    @6,@D2                                             0227
         BC    07,@9E1                                            0227
*          DO;                     /* YES,                      S21052*
*           R1=MSGPTR10;           /* GET POINTER TO MESSAGE.   S21052*
         L     @1,4(0,@4)                                         0229
*           GEN(PWTO  REG=(1));
         PWTO  REG=(1)
         DS    0H
*
*
* CECDEV16:                        /*                           S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*                     FIND SLASH DELIMITER           S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*           /*        CHECK FOR END OF INPUT BUFFER             S21052*
*           IF INPUTBUF(1)='/'
*             THEN                 /* SLASH DELIMETER PRESENT.  S21052*
CECDEV16 CLI   0(@5),C'/'                                         0231
*             GO TO CECDEV22;      /* YES, A SLASH. GO TO EXIT. S21052*
         BC    08,CECDEV22                                        0232
*           R5=R5+1;               /* INCREMENT BUFFER POINTER. S21052*
         AH    @5,@D1                                             0233
*           GO TO CECDEV16;        /* LOOP UNTIL SLASH FOUND.   S21052*
         BC    15,CECDEV16                                        0234
*          END;                    /* END 16 GOOD ENTRIES LOOP. S21052*
*         X=0;                     /* SET DEV TAB CNTR TO ZERO. S21052*
@9E1     SR    @F,@F                                              0236
         STH   @F,X                                               0236
*         DEVTABPT=AVAILBLE;       /* PTR TO NEXT AVAILABLE DEV.S21052*
         L     @8,AVAILBLE                                        0237
*         LIMIT=16-GOODENT;        /* FIND NEW DEV TAB LIMIT.   S21052*
         LA    @F,16                                              0238
         SR    @F,@6                                              0238
         STH   @F,LIMIT                                           0238
*
*
*         /************************************************************
*         /*                                                          *
*         /*          CHECK FOR DEV UCB/CDS CLASS & TYPE DIFFERENCES  *
*         /*                                                    X02906*
*         /************************************************************
*
*         DEVTABPT=DEVTBPTR;            /* ADDRESS FIRST DEVTAB X02906*
         L     @8,DEVTBPTR                                        0239
*         ERRORTAB=0;                   /* CLEAR ERROR TABLE CTRX02906*
         SR    @F,@F                                              0240
         STH   @F,ERRORTAB                                        0240
*
*         DO I=1 TO GOODENT BY +1;      /* SEARCH ALL DEV TABLESX02906*
         LA    @F,1                                               0241
         BC    15,@DO9DF                                          0241
*
*          /*         ARE CDS/UCB CLASS VALUES EQUAL?           X02906*
*
*          IF UCBCLASS^=CLASS THEN      /* ARE CLASSES EQUAL?   X02906*
@DO9E0   MVC   @TEMP4(4),8(@8)                                    0242
         L     @1,@TEMP4           
         CLC   18(1,@1),38(@8)                                    0242
         BC    08,@9DC                                            0242
*
*           DO;                         /* NO, MAKE SPECIAL CHK X02906*
*
*            /*       CHECK FOR SYSTEM 7 DEVICE.                X02906*
*            IF CLASS='02'X &
*             TYPE='01'X THEN           /* SYS 7 CLASS/TYPE?    X02906*
         CLI   38(@8),X'02'                                       0244
         BC    07,@9DB                                            0244
         CLI   39(@8),X'01'                                       0244
*             GO TO CECDV18A;           /* OK, NOT IN ERROR     X02906*
         BC    08,CECDV18A                                        0245
*
*            /* IS THIS A TELECOMMUNICATIONS REMOTE DEVICE      X02906*
*
*          TPCLASS =CLASS & 'F0'X;      /* MASK FOR TP CLASS  @ZA09697*
@9DA     EQU   *                                                  0246
@9DB     LA    @F,X'F0'                                           0246
         SR    @0,@0                                              0246
         IC    @0,38(0,@8)                                        0246
         NR    @F,@0                                              0246
         ST    @F,TPCLASS                                         0246
*          IF TPCLASS = '40'X &         /* CDS CLASS TP &     @ZA09697*
*             UCBCLASS='40'X THEN       /* UCB CLASS FOR LINE   X02906*
         LA    @F,X'40'                                           0247
         C     @F,TPCLASS                                         0247
         BC    07,@9D9                                            0247
         MVC   @TEMP4(4),8(@8)                                    0247
         L     @1,@TEMP4           
         CLI   18(@1),X'40'                                       0247
*             GO TO CECDV18A;           /* OK, NOT IN ERROR     X02906*
         BC    08,CECDV18A                                        0248
*
*            /*       ERROR IN CLASS MATCHING, OUTPUT MSG IFD154I     *
*
*            RESTRICT(1);
@9D8     EQU   *                                                  0249
*            R1=MSGPTR54;               /* ADDRESS MESSAGE      X02906*
@9D9     L     @1,20(0,@4)                                        0250
*
*            /*       FILL MSG BUFFER WITH SYMBOLIC NAME OR UNIT ADDR *
*
*            IF SYMDEVIC='1'B
*             THEN                      /* PUT SYM NAME IN MSG  X02906*
         TM    41(@8),B'00001000'                                 0251
         BC    12,@9D7                                            0251
*              MSG154I(5:12)=DEVTABXX(45:52);
         MVC   16(8,@1),44(@8)                                    0252
         BC    15,@9D6                                            0253
*             ELSE                      /* USE DEV ADDR IN MSG  X02906*
*              MSG154I(5:12)=DEVTABXX(1:8);
@9D7     MVC   16(8,@1),0(@8)                                     0253
*
*            GEN(PWTO REG=(1));         /* OUTBUT MSG 154I      X02906*
@9D6     EQU   *                                                  0254
         PWTO REG=(1)
         DS    0H
*            DEVTABXX=DEVTABXX&&DEVTABXX;
         XC    0(56,@8),0(@8)                                     0255
*                                       /* CLEAR DEV TAB IN ERR X02906*
*            ERRORTAB=ERRORTAB+1;       /* UPDATE ERROR TAB CNT X02906*
         LA    @F,1                                               0256
         AH    @F,ERRORTAB                                        0256
         STH   @F,ERRORTAB                                        0256
*
* CECDV18A:                             /*                      X02906*
*
*           END;                        /* END DEV CLASS MATCH  X02906*
CECDV18A EQU   *                                                  0257
*          DEVTABPT=DEVTABPT+TABLNGTH;  /* NEXT DEV TAB ADDRESS X02906*
@9DC     AH    @8,TABLNGTH                                        0258
*         END;                          /* END DEV TAB SEARCH   X02906*
*
*         /*          REMOVE ANY BAD DEVICE TABLES FROM LIST    X02906*
*         IF ERRORTAB=0 THEN            /* ANY BAD TABLES?      X02906*
         LH    @F,I                                               0259
         AH    @F,@D1                                             0259
@DO9DF   STH   @F,I                                               0259
         CR    @F,@6                                              0259
         BC    12,@DO9E0                                          0259
         SR    @F,@F                                              0260
         CH    @F,ERRORTAB                                        0260
*          GO TO CECDEV18;              /* NO, GO ON .          X02906*
         BC    08,CECDEV18                                        0261
*
*         DEVTABPT=DEVTBPTR;            /* INIT DEV TABLE PTR   X02906*
         L     @8,DEVTBPTR                                        0262
*         AVAILBLE=DEVTBPTR;            /* INIT DEV TABLE PTR   X02906*
         MVC   AVAILBLE(4),DEVTBPTR                               0263
*         DO I=1 TO GOODENT BY +1;      /* SEARCH ALL DEV TABLESX02906*
         LA    @F,1                                               0264
         BC    15,@DO9D4                                          0264
*
*          /*         HAS DEV TABLE BEEN CLEARED OUT?           X02906*
*
*          IF CDSDVDSC=0 THEN           /* IF DSCRPTRS FOR DEV=0X02906*
@DO9D5   CLC   36(4,@8),@D3                                       0265
*           GO TO CECDV18B;             /* UPDATE TABLE PTR     X02906*
         BC    08,CECDV18B                                        0266
*          DEVTABLE=DEVTABXX;           /* OVERLAY WITH GOOD TABX02906*
         L     @C,AVAILBLE                                        0267
         MVC   0(56,@C),0(@8)                                     0267
*          AVAILBLE=AVAILBLE+TABLNGTH;  /* NEXT AVAILABLE DEVTABX02906*
         LH    @F,TABLNGTH                                        0268
         A     @F,AVAILBLE                                        0268
         ST    @F,AVAILBLE                                        0268
*
* CECDV18B:                             /*                      X02906*
*
*          DEVTABPT=DEVTABPT+TABLNGTH;  /*NEXT DEV TABLE IN LISTX02906*
CECDV18B AH    @8,TABLNGTH                                        0269
*         END;                          /* END OF GOODENTRY LOOPX02906*
*
*         GOODENT=GOODENT-ERRORTAB;     /* COOD TABLES CTR UPDT X02906*
         LH    @F,I                                               0270
         AH    @F,@D1                                             0270
@DO9D4   STH   @F,I                                               0270
         CR    @F,@6                                              0270
         BC    12,@DO9D5                                          0270
         SH    @6,ERRORTAB                                        0271
*
* CECDEV18:                             /*                      S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*          ARE THERE ANY VALID DEVICE TABLES         S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*         IF GOODENT=0 THEN        /* ANY GOOD DEV TABS BUILT.  S21052*
CECDEV18 LTR   @6,@6                                              0272
         BC    07,@9D1                                            0272
*          DO;                     /* NO,                       S21052*
*
*
* CECDEV20:                             /*                      S21052*
*
*           R1=MSGPTR11;           /* POINTER TO MESSAGE.       S21052*
CECDEV20 L     @1,8(0,@4)                                         0274
*           GEN(PWTO  REG=(1));
         PWTO  REG=(1)
         DS    0H
*           YOURR14=NEXTREC;       /* ALTER RET POINT IN IFDOLT30
*                                                               S21052*
         L     @C,4(0,@D)          
         MVC   12(4,@C),NEXTREC                                   0276
*
*           /*        CLEAR ALL DEVICE TABLES TO ZERO           S21052*
*
*           DEVTABPT=DEVTBPTR;     /* POINT TO FIRST DEV TABLE. S21052*
         L     @8,DEVTBPTR                                        0277
*           RESTRICT(R1);          /* RESTRICT REGISTER FOR MSG.S21052*
*
*           /*        DEV TAB CLEARING OUT PROCEEDURE           S21052*
*           DO R1 = 16 TO 1
*             BY -1;               /* CLEAR DEVICE TABLES.      S21052*
         LA    @1,16                                              0279
*             DEVTABXX=DEVTABXX&&
*              DEVTABXX;           /* CLEAR DEVICE TABLES.      S21052*
@DO9D0   XC    0(56,@8),0(@8)                                     0280
*             DEVTABPT=DEVTABPT+TABLNGTH;
         AH    @8,TABLNGTH                                        0281
*           END;                   /* END DEV TABLE CLEARING.   S21052*
*           RELEASE(R1);           /* RELEASE REGISTER FOR SYSTEM.
*                                                               S21052*
         BCT   @1,@DO9D0                                          0282
*           GO TO CECDEV28;        /* RETURN TO CALLER.         S21052*
         BC    15,CECDEV28                                        0284
*          END;                    /* END ZERO VALID ENTRIES LOOP
*                                                               S21052*
* CECDEV22:                             /*                      S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*          FILL SECTION CONTROL TABLE WITH DEV TAB DATA
*         /*                                                    S21052*
*         /************************************************************
*
*         IF GOODENT>1
*          THEN                    /* MORE THAN ONE DEVICE ENTRD.
*                                                               S21052*
@9D1     EQU   *                                                  0286
CECDEV22 CH    @6,@D1                                             0286
         BC    12,@9CC                                            0286
*           MORETHN1='1'B;         /* YES, SET FLAG IN COMM AREA.
*                                                               S21052*
         OI    EXPGMFLG,B'01000000'                               0287
         BC    15,@9CB                                            0288
*          ELSE                    /* ONLY ONE DEVICE ENTERED.  S21052*
*           MORETHN1='0'B;         /* SET FLAG IN COMM AREA.    S21052*
@9CC     NI    EXPGMFLG,B'10111111'                               0288
*         DEVTABPT=DEVTBPTR;       /* REINIT DEVICE TABLE POINTES21052*
@9CB     L     @8,DEVTBPTR                                        0289
*         PRIMARY='1'B;            /* SET PRIM FLAG IN DEV TAB. S21052*
         OI    12(@8),B'01000000'                                 0290
*         TUCBAD1=UCBADDR;         /* SAVE PRIM DEV UCB ADDR.   S21052*
         MVC   TUCBAD1(4),8(@8)                                   0291
*         PRIDVAD=HEXADDR;         /* SAVE PRIM DEV HEX DEV ADDR.
*                                                               S21052*
         MVC   SCT+12(4),32(@8)                                   0292
*         PRIDVFLG=PRIDVFLG×'11'X; /* SET LAST DEV FLGS IN SCT. S21052*
         OI    SCT+10,X'11'                                       0293
*
*         /*          CHECK DEVICE DESCRIPTORS IN DEVICE TABLE. S21052*
*         IF CDSDVDSC=0            /* DEV DSCRPTRS = 0. YES,    S21052*
*          THEN                    /* SET UP TO USE             S21052*
         CLC   36(4,@8),@D3                                       0294
         BC    07,@9CA                                            0294
*           PRIDVDSC=UCBDVDSC;     /* USE UCB DV DSCRPTRS.      S21052*
         MVC   @TEMP4(4),8(@8)                                    0295
         L     @1,@TEMP4           
         MVC   SCT+16(4),16(@1)                                   0295
         BC    15,@9C9                                            0296
*          ELSE                    /* NO,                       S21052*
*           PRIDVDSC=CDSDVDSC;     /* USE CDS DEVICE DSCRPTRS.  S21052*
@9CA     MVC   SCT+16(4),36(@8)                                   0296
*         PRIDVPTR=DEVTABPT;       /* SAVE PRIM DEV PTR.        S21052*
@9C9     ST    @8,PRIDVPTR                                        0297
*         DEVDEPAD=ADDR(PRIDVSCT); /* SAVE PRIM SCT DEV ADDR.   S21052*
         LA    @F,SCT+8                                           0298
         ST    @F,DEVDEPAD                                        0298
*
*         /*          WAS A REMOTE TERMINAL DEVICE ENTERED      S21052*
*         IF REMLINE='1'B THEN     /* REMOTE DEV ENTERED. YES,  S21052*
         TM    41(@8),B'00000001'                                 0299
         BC    12,@9C8                                            0299
*          DO;                     /*SET FLAGS TO INDICATE THIS.S21052*
*           TPFLAG='0'B;           /* NOT A 2702 OR 2703 TCU TEST
*                                                               S21052*
         NI    OLTEPSW1,B'11111110'                               0301
*           GO TO CECDEV24;        /* GO ON TO EXIT ROUTINE.    S21052*
         BC    15,CECDEV24                                        0302
*          END;                    /* END REMOTE DEV SET UP.    S21052*
*
*         /*          CHECK COMMON AREA TEST NAME SAVE AREA     S21052*
*
*
*
*         /* GO TO CECDEV24,SKIP 2702,3 TESTS,NO SET TPFLAG.    X03008*
*
*
*
*          GO TO CECDEV24;         /* IS IT A 2701,2702, OR 2703.
*                                                               S21052*
         BC    15,CECDEV24                                        0304
*
*         /*          2701 CONTROL UNIT TEST CHECK              S21052*
*         IF TPSAVE3='1' THEN      /* YES, A 2701 TEST.         S21052*
         CLI   TPSAV+3,C'1'                                       0305
*           GO TO CECDEV24;        /* NO, IT IS A 2702,2703 TEST.
*                                                               S21052*
         BC    08,CECDEV24                                        0306
*
*         /*          2702, 2703 C U TESTS REQUIRE ATLEAST 2 LINES
*                                                               S21052*
*         IF GOODENT^>1 THEN       /* ATLEAST 2 LINES ENTERED.  S21052*
         CH    @6,@D1                                             0307
         BC    02,@9C7                                            0307
*          DO;                     /* NO, AN ERROR CONDITION.   S21052*
*           DEVTABXX=DEVTABXX&&DEVTABXX;
         XC    0(56,@8),0(@8)                                     0309
*           GO TO CECDEV20;        /* CLEAR DEV TAB AND AND EXIT.
*                                                               S21052*
         BC    15,CECDEV20                                        0310
*          END;                    /* END INVALID ENTRY LOOP.   S21052*
*         TPFLAG='1'B;             /* SET FLAG, VALID TCU TEST. S21052*
@9C7     OI    OLTEPSW1,B'00000001'                               0312
*
*         /*          UPDATE DEVICE TABLE POINTER.              S21052*
*         DEVTABPT=DEVTBPTR+TABLNGTH;
         LH    @8,TABLNGTH                                        0313
         A     @8,DEVTBPTR                                        0313
*         SECDVAD=HEXADDR;         /* SAVE SECOND DEV ADDR IN C A
*                                                               S21052*
         MVC   SCT+24(4),32(@8)                                   0314
*         TUCBAD2=UCBADDR;         /* SAVE SECOND DEV UCB ADDR .S21052*
         MVC   TUCBAD2(4),8(@8)                                   0315
*         SECDVFLG=SECDVFLG×'11'X; /* SET LAST DEV FLAGS IN SCT.S21052*
         OI    SCT+22,X'11'                                       0316
*
*         /*          USE CDS OR UCB DEVICE DESCRIPTORS         S21052*
*         IF CDSDVDSC=0            /* DEV DSCRPTRS = 0. YES,    S21052*
*          THEN                    /* SET UP TO USE             S21052*
         CLC   36(4,@8),@D3                                       0317
         BC    07,@9C6                                            0317
*           SECDVDSC=UCBDVDSC;     /* USE UCB DV DSCRPTRS.      S21052*
         MVC   @TEMP4(4),8(@8)                                    0318
         L     @1,@TEMP4           
         MVC   SCT+28(4),16(@1)                                   0318
         BC    15,@9C5                                            0319
*          ELSE                    /* NO,                       S21052*
*           SECDVDSC=CDSDVDSC;     /* USE CDS DEVICE DSCRPTRS.  S21052*
@9C6     MVC   SCT+28(4),36(@8)                                   0319
*         DEVDEPAD=ADDR(SECDVSCT); /* SAVE SECOND SCT DEV ADDR. S21052*
@9C5     LA    @F,SCT+20                                          0320
         ST    @F,DEVDEPAD                                        0320
*         PRIDVFLG=PRIDVFLG&'EE'X; /* CLEAR PRIM LAST DEV FLAGS.S21052*
         NI    SCT+10,X'EE'                                       0321
* CECDEV24:                             /*                      S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*                      EXIT ROUTINE                  S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*         UNITCTR=GOODENT;         /* SAVE UNIT COUNTER.        S21052*
CECDEV24 STH   @6,X                                               0322
*         UNICTR=UNITCTR1;         /* SAVE VALUE IN COMMON AREA.S21052*
         MVC   UNICTR(1),X+1                                      0323
*         UNITUSE='00'X;           /* INIT UNITS TESTED COUNTER.S21052*
         MVI   UNITUSE,X'00'                                      0324
*         LEGALDEV='1'B;           /* VALID DEVICE(S) ENTERED FLAG
*                                                               S21052*
         OI    OLTEPSW,B'00001000'                                0325
*         INBUFPTR=R5;             /* SAVE INPUT BUFFER POINTER.S21052*
         ST    @5,INBUFPTR                                        0326
*         GO TO CECDEV28;          /* VALID DEVICE DECODE.      S21052*
         BC    15,CECDEV28                                        0327
*
*
* CECDEV26:                             /*                      S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*          CHANGE RETURN POINT, REDEFINE TEST        S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*         YOURR14=REDEFINE;        /* ALTER RET POINT IN IFDOLT30
*                                                               S21052*
CECDEV26 L     @1,4(0,@D)          
         MVC   12(4,@1),REDEFINE                                  0328
*         R8=DEVTBPTR;             /* DEVICE TABLES             X03008*
         L     @8,DEVTBPTR                                        0329
*         DO R9=TABLNGTH BY -1 TO 1; /* TABLE LENGTH            X03008*
         LH    @9,TABLNGTH                                        0330
         LTR   @9,@9                                              0330
         BC    12,@DO9C3                                          0330
*           DVT=DVT&&DVT;          /* ZERO TABLE AREA           X03008*
@DO9C4   XC    0(16,@8),0(@8)                                     0331
*           R8=ADDR(DVTN);         /* NEXT TABLE AREA           X03008*
         LA    @8,16(0,@8)                                        0332
*         END;                     /* ZERO TOTAL TABLE          X03008*
*         LEGALDEV='0'B;           /* NO LEGAL DEVICES          X03008*
         BCT   @9,@DO9C4                                          0333
@DO9C3   NI    OLTEPSW,B'11110111'                                0334
*
*
* CECDEV28:                             /*                      S21052*
*
*         /************************************************************
*         /*                                                    S21052*
*         /*          RETURN TO CALLER                          S21052*
*         /*                                                    S21052*
*         /************************************************************
*
*         DPMSGREI='0'B;                /* TURN OFF REM MSG FLG XM0097*
CECDEV28 NI    A00014,B'11111110'                                 0335
*         RETURN;                  /* RETURN TO CALLER          S21052*
*         END;                     /* END IFDOLT61.             S21052*
@EL01    L     @D,4(0,@D)                                         0337
         LM    @E,@C,12(@D)                                       0337
         BCR   15,@E                                              0337
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D3      DC    F'0'
@D1      DC    H'1'
@D2      DC    H'16'
@V1      DC    V(IFDMSG61)
         DS    0F
@C12     DC    C'ONLINE ,'
@C13     DC    C'OFFLINE,'
@C21     DC    C'SOSPC/'
@C14     DC    C'ALLOCATED  '
@C15     DC    C'UNALLOCATED'
@C22     DC    C'270'
         DS    0D
@DATA    EQU   *
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD
R0       EQU   00000000            FULLWORD POINTER REGISTER
R1       EQU   00000001            3  BYTE  POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD POINTER REGISTER
R4       EQU   00000004            FULLWORD POINTER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
GOODENT  EQU   00000006            FULLWORD POINTER REGISTER
UCBLOOK  EQU   00000007            FULLWORD POINTER REGISTER
DEVTABPT EQU   00000008            FULLWORD POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
R9       EQU   00000009            3  BYTE  POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
RC       EQU   00000015            FULLWORD POINTER REGISTER
R15      EQU   00000015            FULLWORD POINTER REGISTER
MYSAVE   EQU   00000000            8 BYTE(S) ON WORD
A00000   EQU   MYSAVE+00000000     4 BYTE(S)
YOURR13  EQU   MYSAVE+00000004     FULLWORD POINTER
YOURSAVE EQU   00000000            16 BYTE(S) ON WORD
A00001   EQU   YOURSAVE+00000000   12 BYTE(S)
YOURR14  EQU   YOURSAVE+00000012   FULLWORD POINTER
INPUTBUF EQU   00000000            10 BYTE(S)
DEVTABXX EQU   00000000            56 BYTE(S)
DEVADDR  EQU   DEVTABXX+00000000   8 BYTE(S)
UCBADDR  EQU   DEVTABXX+00000008   4  BYTE  POINTER
FLG1     EQU   DEVTABXX+00000012   1 BYTE(S)
ONOFF    EQU   DEVTABXX+00000012   1 BIT(S)
PRIMARY  EQU   DEVTABXX+00000012   1 BIT(S)
A00017   EQU   DEVTABXX+00000013   1 BYTE(S)
FLG3     EQU   DEVTABXX+00000014   1 BYTE(S)
ANRNOTST EQU   DEVTABXX+00000014   1 BIT(S)
A00018   EQU   DEVTABXX+00000014   3 BIT(S)
NOTEST   EQU   DEVTABXX+00000014   1 BIT(S)
SYSALLOC EQU   DEVTABXX+00000014   1 BIT(S)
A00019   EQU   DEVTABXX+00000015   1 BYTE(S)
A00020   EQU   DEVTABXX+00000016   16 BYTE(S)
HEXADDR  EQU   DEVTABXX+00000032   4 BYTE(S)
CDSDVDSC EQU   DEVTABXX+00000036   4 BYTE(S)
MODEL    EQU   DEVTABXX+00000036   1 BYTE(S)
FEATURES EQU   DEVTABXX+00000037   1 BYTE(S)
CLASS    EQU   DEVTABXX+00000038   1 BYTE(S)
TYPE     EQU   DEVTABXX+00000039   1 BYTE(S)
BYTECNT  EQU   DEVTABXX+00000040   1 BYTE(S)
CDSFLAGS EQU   DEVTABXX+00000041   1 BYTE(S)
A00021   EQU   DEVTABXX+00000041   4 BIT(S)
SYMDEVIC EQU   DEVTABXX+00000041   1 BIT(S)
A00022   EQU   DEVTABXX+00000041   2 BIT(S)
REMLINE  EQU   DEVTABXX+00000041   1 BIT(S)
EXTSGMSK EQU   DEVTABXX+00000042   2 BYTE(S)
SYMNAME  EQU   DEVTABXX+00000044   8 BYTE(S)
MSGPTR   EQU   00000000            24 BYTE(S) ON WORD
MSGPTR09 EQU   MSGPTR+00000000     FULLWORD POINTER
MSGPTR10 EQU   MSGPTR+00000004     FULLWORD POINTER
MSGPTR11 EQU   MSGPTR+00000008     FULLWORD POINTER
MSGPTR14 EQU   MSGPTR+00000012     FULLWORD POINTER
MSGPTR27 EQU   MSGPTR+00000016     FULLWORD POINTER
MSGPTR54 EQU   MSGPTR+00000020     FULLWORD POINTER
MSG109   EQU   00000000            40 BYTE(S) ON WORD
A00023   EQU   MSG109+00000000     12 BYTE(S)
MSG109I  EQU   MSG109+00000012     28 BYTE(S)
MSG154   EQU   00000000            72 BYTE(S) ON WORD
A00024   EQU   MSG154+00000000     12 BYTE(S)
MSG154I  EQU   MSG154+00000012     60 BYTE(S)
MSG127   EQU   00000000            31 BYTE(S) ON WORD
A00025   EQU   MSG127+00000000     12 BYTE(S)
MSG127I  EQU   MSG127+00000012     19 BYTE(S)
A00027   EQU   00000000            32 BYTE(S) ON WORD
DVT      EQU   A00027+00000000     16 BYTE(S)
DVTN     EQU   A00027+00000016     16 BYTE(S)
AVAILBLE EQU   @DATA+00000072      FULLWORD POINTER
DEVTABLE EQU   00000000            56 BYTE(S)
LIMIT    EQU   @DATA+00000076      HALFWORD INTEGER
X        EQU   @DATA+00000078      HALFWORD INTEGER
UNITCTR  EQU   X+00000000          HALFWORD INTEGER
A00029   EQU   X+00000000          1 BYTE(S)
UNITCTR1 EQU   X+00000001          1 BYTE(S)
ERRORTAB EQU   @DATA+00000080      HALFWORD INTEGER
X1       EQU   @DATA+00000082      HALFWORD INTEGER
COUNT    EQU   @DATA+00000084      HALFWORD INTEGER
I        EQU   @DATA+00000086      HALFWORD INTEGER
ERRCODE  EQU   @DATA+00000088      2 BYTE(S)
GRAPHICS EQU   @DATA+00000092      56 BYTE(S) ON WORD
EBADDR   EQU   GRAPHICS+00000000   8 BYTE(S)
A00030   EQU   GRAPHICS+00000000   7 BYTE(S)
DEVICE   EQU   GRAPHICS+00000007   1 BYTE(S)
A00031   EQU   GRAPHICS+00000008   4 BYTE(S)
FLAG     EQU   GRAPHICS+00000012   1 BYTE(S)
OFF      EQU   GRAPHICS+00000012   1 BIT(S)
         ORG   @DATA+00000148
NUMBERS  EQU   *                   16 BYTE(S)
         DC    C'0123456789ABCDEF'
NUMBER   EQU   00000000            1 BYTE(S)
DEVAD    EQU   *                   8 BYTE(S)
         DC    C'00000000'
DEVAD1   EQU   DEVAD+00000000      8 BYTE(S)
SWITCHES EQU   @DATA+00000172      1 BYTE(S)
FRSTPASS EQU   SWITCHES+00000000   1 BIT(S)
PARMLIST EQU   @DATA+00000176      16 BYTE(S) ON WORD
MODNAME  EQU   PARMLIST+00000000   8 BYTE(S)
         ORG   PARMLIST+00000000
TCDSO    EQU   *                   1 BYTE(S)
         DC    C'G'
CDSDEV   EQU   PARMLIST+00000001   7 BYTE(S)
TARGETAD EQU   PARMLIST+00000008   FULLWORD POINTER
PARMFLGS EQU   PARMLIST+00000012   1 BYTE(S)
A00032   EQU   PARMLIST+00000013   1 BYTE(S)
CDSLNGTH EQU   PARMLIST+00000014   HALFWORD INTEGER
UCBDVDSC EQU   00000016            4 BYTE(S)
UCBMODEL EQU   UCBDVDSC+00000000   1 BYTE(S)
UCBFEAT  EQU   UCBDVDSC+00000001   1 BYTE(S)
A00033   EQU   UCBDVDSC+00000001   2 BIT(S)
SHAREDDV EQU   UCBDVDSC+00000001   1 BIT(S)
A00034   EQU   UCBDVDSC+00000001   5 BIT(S)
UCBCLASS EQU   UCBDVDSC+00000002   1 BYTE(S)
UCBTYPE  EQU   UCBDVDSC+00000003   1 BYTE(S)
CDSENTRY EQU   00000000            20 BYTE(S)
A00035   EQU   CDSENTRY+00000000   4 BYTE(S)
DSCRPTRS EQU   CDSENTRY+00000004   4 BYTE(S)
TPCLASS  EQU   @DATA+00000192      FULLWORD INTEGER
         ORG   @DATA
         DS    00000196C
@TEMPS   DS    0F
@TEMP4   DC    F'0'
DEVCOMM  IFDCOM                   COMMON AREA DSECT
SCT      EQU   CHASCT+00000000     32 BYTE(S) ON WORD
HEADER   EQU   SCT+00000000        8 BYTE(S)
PRIDVSCT EQU   SCT+00000008        12 BYTE(S)
A00002   EQU   SCT+00000008        2 BYTE(S)
PRIDVFLG EQU   SCT+00000010        1 BYTE(S)
A00003   EQU   SCT+00000011        1 BYTE(S)
PRIDVAD  EQU   SCT+00000012        4 BYTE(S)
A00004   EQU   SCT+00000012        2 BYTE(S)
PRIHEXAD EQU   SCT+00000014        2 BYTE(S)
PRIDVDSC EQU   SCT+00000016        4 BYTE(S)
SECDVSCT EQU   SCT+00000020        12 BYTE(S)
A00005   EQU   SCT+00000020        2 BYTE(S)
SECDVFLG EQU   SCT+00000022        1 BYTE(S)
A00006   EQU   SCT+00000023        1 BYTE(S)
SECDVAD  EQU   SCT+00000024        4 BYTE(S)
A00007   EQU   SCT+00000024        2 BYTE(S)
SECHEXAD EQU   SCT+00000026        2 BYTE(S)
SECDVDSC EQU   SCT+00000028        4 BYTE(S)
OLTEPSW  EQU   CESWT+00000000      1 BYTE(S) ON WORD
A00008   EQU   OLTEPSW+00000000    4 BIT(S)
LEGALDEV EQU   OLTEPSW+00000000    1 BIT(S)
REINT    EQU   OLTEPSW+00000000    1 BIT(S)
OLTEPSW1 EQU   CESWT1+00000000     1 BYTE(S) ON WORD
A00009   EQU   OLTEPSW1+00000000   6 BIT(S)
ONLINETP EQU   OLTEPSW1+00000000   2 BIT(S)
ONLINEOK EQU   OLTEPSW1+00000000   1 BIT(S)
TPFLAG   EQU   OLTEPSW1+00000000   1 BIT(S)
OLTEPSW2 EQU   CESWT2+00000000     1 BYTE(S) ON WORD
A00010   EQU   OLTEPSW2+00000000   3 BIT(S)
CHANTEST EQU   OLTEPSW2+00000000   1 BIT(S)
A00011   EQU   OLTEPSW2+00000000   1 BIT(S)
NDR      EQU   OLTEPSW2+00000000   1 BIT(S)
OLTEPSW7 EQU   CESWT7+00000000     1 BYTE(S) ON WORD
INCLST   EQU   OLTEPSW7+00000000   1 BIT(S)
RETTO31  EQU   OLTEPSW7+00000000   1 BIT(S)
A00012   EQU   CESWTR+00000000     1 BYTE(S) ON WORD
RETAINAC EQU   A00012+00000000     1 BIT(S)
A00013   EQU   A00012+00000000     1 BIT(S)
REMNOMSG EQU   A00012+00000000     1 BIT(S)
A00014   EQU   CESWTR2+00000000    1 BYTE(S) ON WORD
A00015   EQU   A00014+00000000     7 BIT(S)
DPMSGREI EQU   A00014+00000000     1 BIT(S)
SVCPLIST EQU   ROPT-00000004       12 BYTE(S) ON WORD
A00016   EQU   SVCPLIST+00000000   2 BYTE(S)
MODNUM   EQU   SVCPLIST+00000002   2 BYTE(S)
ADDRDEV  EQU   SVCPLIST+00000004   FULLWORD POINTER
ENTRIES  EQU   SVCPLIST+00000008   FULLWORD INTEGER
TPSAV    EQU   TPSAVE+00000000     4 BYTE(S)
A00026   EQU   TPSAV+00000000      3 BYTE(S)
TPSAVE3  EQU   TPSAV+00000003      1 BYTE(S)
EXPGMFLG EQU   CHASCT+00000033     1 BYTE(S)
A00028   EQU   EXPGMFLG+00000000   1 BIT(S)
MORETHN1 EQU   EXPGMFLG+00000000   1 BIT(S)
FRSTINCL EQU   SAVENT+00000000     HALFWORD INTEGER
LASTINCL EQU   SAVENT+00000002     HALFWORD INTEGER
@DATEND  EQU   *
@9FD     EQU   CECDEV14
@9E6     EQU   CECDEV12
@9E5     EQU   CECDEV12
@9E7     EQU   CECDEV14
@9C8     EQU   CECDEV24
         END    ,(C'PL/S',1400,78045)

         TITLE 'IFDOLT07 DATA PROTECT PACK'
         TITLE 'IFDOLT07 DATA PROTECT PACK'
         LCLA  &T,&SPN                                            0002
.@001    ANOP                                                     0002
IFDOLT07 CSECT ,                                                  0002
         BC    15,24(0,@F)
         DC    C'IFDOLT07 16 NOV 73'                             0002
         STM   @E,@C,12(@D)                                       0002
         BALR  @B,0                                               0002
@PSTART  DS    0H                                                 0002
         USING @PSTART+00000,@B                                   0002
         ST    @D,@SAV001+4                                       0002
         LA    @F,@SAV001                                         0002
         ST    @F,8(0,@D)                                         0002
         LR    @D,@F                                              0002
*  GEN(USING CHASCT,2);                  /* COMMON AREA BASE REGISTER *
         USING CHASCT,2
         DS    0H
*         GEN DATA;
* GENERATE DATA;
*  /*******************************************************************
*  /*                                                                 *
*  /*                     DECLARED  REGISTERS                         *
*  /*                                                                 *
*  /*******************************************************************
*  DCL R0  REG(0)  PTR;
*  DCL R1  REG(1)  PTR;
*  DCL R2  REG(2)  PTR;
*  DCL R3  REG(3)  PTR;
*  DCL R4  REG(4)  PTR;
*  DCL R5  REG(5)  PTR;
*  DCL R6  REG(6)  PTR;
*  DCL R7  REG(7)  PTR;
*  DCL R8  REG(8)  PTR;
*  DCL R9  REG(9)  PTR;
*  DCL R10 REG(10) PTR;
*  DCL R11 REG(11) PTR;
*  DCL R12 REG(12) PTR;
*  DCL R13 REG(13) PTR;
*  DCL R14 REG(14) PTR;
*  DCL R15 REG(15) PTR;
*  RESTRICT(2,4,5,6,7,8);
*  DCL CESWT3 CHAR(1) GENERATED;         /* OLTEP SWITCHES       M4506*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWT3)),  /* OLTEP SWITCHES       M4506*
*         2 * BIT(3),                    /* NA                   M4506*
*         2 GRBCTL BIT(1),               /* GRAB IN CONTROL      M4506*
*         2 SUSDEL BIT(1),               /* SUSPENDED DELETION   M4506*
*           3 * BIT(1);                  /* NA                   M4506*
*  DCL OLTTAB GENERATED;                 /* LINK TABLE           M4506*
*  DCL 1 * BDY(WORD) BASED(ADDR(OLTTAB)), /* LINK TABLE          M4506*
*         2 OLTTAB1 PTR,                 /* OLD EXIO             M4506*
*         2 OLTTAB2 PTR,                 /* OLD WAITIO           M4506*
*           3 * PTR;                     /* NA                   M4506*
*
*
*  /*******************************************************************
*  /*                                                                 *
*  /*                       SECTION CONTROL TABLE                     *
*  /*                                                                 *
*  /*******************************************************************
*
*  DCL CHASCT GENERATED;            /* SECTION CONTROL TABLE          *
*  DCL 1 * CHAR(1) BASED(ADDR(CHASCT)+10),  /* SCT STRUCTURE          *
*        3 * BIT(1),                /* NA                             *
*        3 FPM BIT(1);              /* FILE PROTECT MODE BIT          *
*  DCL 1 * CHAR(1) BASED(ADDR(CHASCT)+11),    /* SCT CDS FLAGS   M1006*
*        3 CDSFPM BIT(1),                /* FILE PROTECT MODE    M1006*
*        3 * BIT(1),                     /* NA                   M1006*
*        3 CDSCEVOL BIT(1),              /* CE VOLUME            M1006*
*        3 * BIT(5);                     /* NA                   M1006*
*
* /********************************************************************
* /*                                                                  *
* /*                 COMMUNICATION SWITCHES STRUCTURE                 *
* /*                                                                  *
* /********************************************************************
*
*
*  DCL CESWT CHAR(5) GENERATED;     /* COMMUNICATION SWITCHES         *
*  DCL 1 * BASED(ADDR(CESWT)),      /* CE SWITCHES                    *
*        3 * BIT(8),                /* CE SWITCH                      *
*          5 * BIT(1),              /* NA                             *
*          5 PROTECT BIT(1),        /* DATA PROT ON SEC DEV           *
*          5 * BIT(6),              /* NA                             *
*        3 * BIT(8),                /* CE SWITCH 1                    *
*          5 * BIT(4),              /* NA                             *
*          5 FILMSK BIT(1),         /* FILE MASK BIT                  *
*          5 * BIT(1),              /* NA                             *
*          5 ONLINEOK BIT(1),       /* ONLINE OK BIT                  *
*          5 * BIT(1),              /* NA                             *
*        3 * BIT(8),                /* CE SWITCH 2                    *
*          5 NDCFO BIT(1),          /* PREVENTS DYNAMIC COMM INTERVAL *
*          5 DPONDEV BIT(1),        /* DATA DONE ON THIS DEVICE       *
*          5 * BIT(1),              /* NA                             *
*          5 CHANTEST BIT(1),       /* INDICATES CHAN TEST ACTIVE     *
*          5 * BIT(1),              /* NA                             *
*          5 * BIT(1),              /* NA                             *
*          5 TAPEHDR BIT(1),        /* TAPE HEADER BIT                *
*          5 AMERLDV BIT(1),             /* MERLIN DEVICE        M4505*
*        3 * BIT(8),                /* CE SWITCH 3                    *
*          5 * BIT(1),              /* NA                             *
*          5 NURUN BIT(1),          /* BRING NEW TESTS                *
*          5 BYPDEV BIT(1),         /* BYPASS TESTS ON THIS DEVICE    *
*          5 * BIT(1),              /* NA                             *
*          5 * BIT(1),              /* NA                             *
*          5 * BIT(1),              /* NA                             *
*          5 * BIT(1),              /* NA                             *
*          5 STDLAB BIT(1);         /* STANDARD LABEL BIT             *
*
*  DCL I FIXED;                          /* WORK WORD           S20203*
*         DCL LABEL2 GENERATED;    /*                           S20203*
*
* /********************************************************************
* /*                                                                  *
* /*                      DEVICE TABLE STRUCTURE                      *
* /*                                                                  *
* /********************************************************************
*
*         DCL  1 * BASED(R7),          /*                       S21050*
*         3 DEVADEB CHAR(8),             /* DEV ADDR IN EBCDIC  S21050*
*                3 UCBAD POINTER(31),  /* UCB ADDR (2BYTES)     S21050*
*                3 DEVFLG1 CHAR(1),    /* FLAG BYTE #1          S21050*
*                 5 STATUS BIT(1),     /* ON LINE VS. OFF-LINE  S21050*
*                 5 PRIMARY BIT(1),    /* PRIMARY BIT           S21050*
*                 5 DPDONE  BIT(1),    /* D.P. COMPLETE         S21050*
*                 5 *       BIT(3),    /* FILL                  S21050*
*                 5 FILEPROT BIT(1),   /* F.P. MODE OPERATION   S21050*
*                 5 *       BIT(1),    /* FILL                  S21050*
*                3 DEVFLG2 CHAR(1),    /* FLAG BYTE # 2         S21050*
*           5 * BIT(2),                  /* N/A                 S21050*
*           5 CEVOL BIT(1),              /* CE VOL ON DEVICE    S21050*
*                 5   STDLABL BIT(1),  /* STANDARD TAPE LABEL   S21050*
*                 5 * BIT(4),          /* FILL                  S21050*
*                3 DEVFLG3 CHAR(1),    /* FLAG BYTE # 3         S21050*
*                3 DEVFLG4 CHAR(1),    /* FLAG BYTE # 3         S21050*
*                3 TAPELABL CHAR(16),  /* TAPE LABEL SAVE AREA  S21050*
*                 5 VOL CHAR(10),      /* VOL NAME              S21050*
*                 5 HDR CHAR (4),      /* HDR NAME              S21050*
*                 5 MODESV CHAR(1),    /* MODE SAVE AREA        S21050*
*                 5 * CHAR(1),         /* FILL                  S21050*
*                3 ADRHEX CHAR (4),    /* 4 BYTE HEX ADDRESS    S21050*
*                 5 * CHAR(2),         /* FILL                  S21050*
*               5 HEXAD CHAR(2),         /* 2 BYTE HEX ADDRESS  S21052*
*            3 CDSINFOR CHAR(16),        /* CDS INFORMATION     X02906*
*               5 FEATURES CHAR(1),      /* FEATURES            X02906*
*               5 MODEL CHAR(1),         /* MODEL #             X02906*
*               5 CLASS CHAR(1),         /* CLASS               X02906*
*               5 TYPE CHAR(1),          /* TYPE                X02906*
*               5 * CHAR(1),             /* N/A                 X02906*
*               5 CDSFLAGS CHAR(1),      /* CDS FLAGS           X02906*
*                 7 DVCDSFPM BIT(1),     /* FILE PROTECT MODE   X02906*
*                 7 * BIT(1),            /*                     X02906*
*                 7 DVCDSCEV BIT (1),    /* CE VOLUME MOUNTED   X02906*
*                 7 * BIT(5);            /*                     X02906*
*
*
*
*  /*******************************************************************
*  /*                                                                 *
*  /*           EXIO PARAMETER LIST                                   *
*  /*                                                                 *
*  /*******************************************************************
*
*                                       /* IO EFFECTOR CNTL BLK Y02906*
*                                       /* IN COMMON AREA       Y02906*
*  DCL EFCTRCB CHAR(20) GEND;           /* IO EFFECTOR CNTL BLK       *
*  DCL CCWPTR PTR(31) GEND;             /* CCW LIST POINTER     Y02906*
*  DCL DVTPTR PTR(31) GEND;             /* DEVICE TABEL POINTER Y02906*
*  DCL FLGA   BIT(8)  GEND;             /* FLAG BYTE 1          Y02906*
*
*  DCL FLGB   BIT(8)  GEND;             /* FLAG BYTE 2          Y02906*
*
* DCL 1 FLG1A BIT(8) BASED(ADDR(FLGA)),
*       3 BYPASS BIT(1);                 /* BYPASS PREFIX       Y02906*
*
*  DCL 1 FLG2 BIT(8) BASED(ADDR(FLGB)),                       /*Y02906*
*        3 INTCALL BIT(1),              /* INTERNAL CALL FOR IO Y02906*
*        3 MODEREQ BIT(1);              /* IF ON MODE SET REQ   Y02906*
*  DCL FILEMSK CHAR(1) GEND;            /* FILE MSK FOR IOEFFEC Y02906*
* DCL SNSCNT CHAR(1) GEND;
* DCL TECBPTRX PTR(31) GEND;
*  DCL IORTNADR GEND;                   /* ADDR OF IO EFFECTOR  Y02906*
*         DCL 1 WAITLST CHAR(16) BDY(WORD), /* WAITIO LIST      Y02906*
*              3 XMGR CHAR(1) INIT('00'X), /* TRANS MGR STUFF   Y02906*
*              3 LVL CHAR(1) INIT('02'X),/* WAITIO LVL          Y02906*
*              3 MODID CHAR(2) INIT('36'), /* IFDOLT36 ID       Y02906*
*              3 TECBPTR PTR(31) INIT(ADDR(TECB)),/* TECB ADDR  Y02906*
*              3 CDSPTR PTR(31) INIT(0),  /*CDS = 0             Y02906*
*              3 FLG BIT(8) INIT('80'X), /* SET WAIT = YES      Y02906*
*               5 WAITYES BIT(1),        /* FLAG TO 1           Y02906*
*              3 TIME CHAR(2) INIT('001E'X); /* TIME IN SECONDS Y02906*
*
*
*  /*******************************************************************
*  /*                                                                 *
*  /*                  TEST EVENT CONTROL BLOCK FIELD                 *
*  /*                                                                 *
*  /*******************************************************************
*
*         DCL 1 TECB,                     /* EVENT BLOCK FOR IO Y02906*
*               2 FLDCNT CHAR(1) INIT('01'X),  /* NUMBER FDLS   Y02906*
*               2 FLDSIZE CHAR(1) INIT('0C'X), /* SIZE EACH FLD Y02906*
*               2 SOMETNG CHAR(1) INIT('00'X), /* N/A           Y02906*
*               2 SNSSIZE CHAR(1) INIT('18'X), /* SENSE EXPTD   Y02906*
*               2 FLG1 CHAR(1) INIT('00'X),    /* FLAGS         Y02906*
*               2 SNSCNTTB CHAR(1) INIT('01'X), /* XPECTED COUNTY02906*
*               2 CLRTECB  CHAR(39),     /* LABEL TO CLEAR TECB YM3336*
*                 3 CNTSNS CHAR(1) INIT('00'X), /* NUMB OCCURED Y02906*
*                 3 CNTINT CHAR(1) INIT('00'X), /*NUMB INTERRUPTY02906*
*                 3 CCP CHAR(1),        /* SIO COND CODE        Y02906*
*                 3 * CHAR(3),          /* N/A                  YM3336*
*                 3 CSW1 CHAR(8),       /* CSW NO. ONE          Y02906*
*                   5 * CHAR(4),        /* N/A                  Y02906*
*                   5 STATUSX CHAR(2),  /* TWO STATUS BYTES     Y02906*
*                     7 EXIOK CHAR(1),  /* STATUS BYTE 1        Y02906*
*                       9 * BIT(6),     /* N/A                  Y02906*
*                       9 UNITCK BIT(1), /* UNIT CHECK          Y02906*
*                       9 UNITEXCP BIT(1), /* UNIT EXCEPTION BITY02906*
*                     7 BYTE2 CHAR(1),  /* STATUS BYTE 2        Y02906*
*                       9 * BIT(1),     /* N/A                  Y02906*
*                       9 INLENGTH  BIT(1), /* INCORR LNG IND   Y02906*
*                       9 * BIT(6),     /* N/A                  Y02906*
*                   5 * CHAR(2),        /* N/A                  Y02906*
*                 3 SENSE  CHAR(24),    /* SENSE COUNT          Y02906*
*                   5 * CHAR(3),        /* N/A                  Y02906*
*                   5 SNS1 CHAR(7),     /* SENSE BYTES          Y02906*
*                     7 SNSFLD BIT(8),  /* BYTE0  SENSE         Y02906*
*                       9 * BIT(1),     /* N/A                  Y02906*
*                       9 SNS2 BIT(1),  /* BIT 1 SNS BYTE 0     Y02906*
*                     7 * CHAR(2),      /* SNS BYTES 1 & 2      Y02906*
*                     7 * BIT(8),       /* SNS BYTE 3           Y02906*
*                       9 * BIT(5),     /* FILL                 Y02906*
*                       9 PEIND BIT(1), /* BIT 5 BYTE3 OF SNS   Y02906*
*                     7 * CHAR(2),      /* SENCE BYTES 4 AND 5  Y02906*
*                     7 * CHAR(1),      /* SENCE BYTE 6         Y02906*
*                       9 * BIT(4),     /* NOT REFERENCED       Y02906*
*                       9 BIT4 BIT(1);  /* BIT FOUR FOR BIRTCH  Y03128*
*  /*******************************************************************
*  /*                                                                 *
*  /*                         R0 DATA LENGTH FIELD                    *
*  /*                                                                 *
*  /*******************************************************************
*
*                                  /*                           S20203*
*         DCL 1 BUF CHAR(20),            /* LABEL BUFFER        S20203*
*               3 STLAB CHAR(4),         /* STAND LABEL         S20203*
*               3 CEVOL1 CHAR(6),        /* CE VOLUME           S20203*
*               3 SECBYT CHAR(1),        /* SECURITY BYTE       S20203*
*               3 * CHAR(9);             /* NA                  S20203*
*         DCL 1 BUF1 CHAR(5),            /* HA BUFFER           S20203*
*               3 * BIT(8),              /* NA                  S20203*
*                 5 * BIT(5),            /* NA                  S20203*
*                 5 MERLIN BIT(1),       /* 3330 CE BIT         S20203*
*                 5 * BIT(2),            /* NA                  S20203*
*               3 * CHAR(4);             /* NA                  S20203*
*         DCL 1 BUF2 CHAR(20),           /* F0FE BUFFER         S20203*
*               3 * CHAR(14),            /* NA                  S20203*
*               3 CEF0FE CHAR(5),        /* CE F0FE BIT         S20203*
*               3 * CHAR(1);             /* NA                  S20203*
*
*
*
*
*  DCL IFDMSG07 EXT ENTRY;          /* MESSAGE MODULE                 *
*  DCL MSGPTR PTR INIT(ADDR(IFDMSG07));   /* POINTER TO MESSAGE MODULE*
*  DCL 1 * BASED(R4),               /* MESSAGE ADDRESS                *
*        3 MSG1 PTR,                /* POINTER TO MESSAGE             *
*        3 MSG2 PTR,                /* POINTER TO MESSAGE             *
*        3 MSG2A PTR,                    /* PNTR TO IFD124I     Y01906*
*        3 MSG3 PTR,                /* POINTER TO MESSAGE             *
*        3 MSG4 PTR,                /* POINTER TO MESSAGE             *
*          3 MSG5 PTR,              /* POINTER TO MESSAGE             *
*         3 MSG6 PTR,                    /* POINTER TO MESSAGE  S20203*
*         3 MSG7 PTR,                    /* POINTER TO MESSAGE  S20203*
*         3 MSG8 PTR;               /* POINTER TO MESSAGE       S20203*
*   DCL MSGDVAD CHAR(8) BASED(R1+16);    /*DEV ADDR AREA IN MSG S21050*
*   DCL MSGDVAD1 CHAR(8) BASED(R1+26);   /* DEVAD IN IFD124I    Y01906*
*   DCL MSGVOLID CHAR(6) BASED(R1+42);   /* NON-CE VOLID IN 124IY01906*
*   DCL MSGDVAD2 CHAR(8) BASED(R1+32);   /*DEV ADDR AREA IN MSG S21050*
*   DCL MSGDVAD3 CHAR(8) BASED(R1+29);   /*DEV ADDR AREA IN MSG S21050*
*  DCL MSGDVAD4 CHAR(8) BASED(R1+19);    /*DEV ADDR AREA IN MSG S21050*
*  DCL MSGCSW CHAR(14) BASED(R1+18);     /* CSW DATA IN MESSAGE S20203*
* DCL MSGSNS CHAR(12) BASED(R1+37);      /* SNS DATA IN IFD137I Y01906*
*  DCL SIX CHAR(2) INIT('0006'X);   /* USED TO COMPARE R0 DATA LENGTH *
*  DCL 1 MSGPARM BASED(R1),         /* NA                             *
*        3 LENGTH CHAR(1),          /* LENGTH OF RESPONSE             *
*        3 BUFAD PTR(24),           /* POINTER TO RESPONSE BUFFER     *
*        3 MSGECBAD FIXED;          /* ECB ADDRESS                    *
*  DCL DECB FIXED INIT(0);          /* EVENT CONTROL BLOCK            *
*   DCL INBUFR CHAR(72) GENERATED;
*    DCL BUFFER CHAR(1) BASED(ADDR(INBUFR));
*  DCL 1 INBUF CHAR(62),                 /* INPUT BUFFER        S20203*
*         3 CSWIN CHAR(14),              /* CONVERTED CSW DATA  S20203*
*         3 * CHAR(6),                  /* CONVERTED DEV ADDR   Y02906*
*         3 SNSIN CHAR(48);              /* CONVERTED SENSE DATAS20203*
*  DCL LABEL0 GENERATED;                 /*                     S20203*
*  DCL LABEL1 GENERATED;                 /*                     S20203*
*  DCL TAB28 PTR(31) GENERATED;     /* NEW MACRO ENTRY POINT          *
*  DCL CNVRT CHAR(14) GENERATED;    /* CONVERT PARAMETER LIST         *
*         DCL SEEKVOL CHAR(7) INIT('00000000000003'X);/* SEEK TO VOL1 *
*                                        /*                     S20203*
*         DCL SEEKF0FE CHAR(6) INIT('000000060000'X); /* SEEK TO F0FE *
*                                        /*                     S20203*
*  DCL SEEKMERL CHAR(6) INIT('000000000000'X);                /*S20203*
*  /*******************************************************************
*  /*                                                                 *
*  /*                  DETERMINE ONLINE OFFLINE STATUS                *
*  /*                                                                 *
*  /*                                                                 *
*         /************************************************************
*
*         R4=MSGPTR;                     /* PUT PTR TO MSG MOD IN R4  *
         L     @4,MSGPTR                                          0075
*         IF STATUS  = '1'B THEN        /* IF DASD IS ONLINE    Y02906*
         TM    12(@7),B'10000000'                                 0076
         BC    12,@9FF                                            0076
*           DO;                         /* SET THE FOLLOWING    Y02906*
*           ONLINEOK  = '1'B;           /* ONLINE OK COMMO SW   Y02906*
         OI    A00010+1,B'00000010'                               0078
*           DPPACK01:                   /* AND                  Y02906*
*           FPM       = '1'B;           /* SCT F.P.MODE SW      Y02906*
DPPACK01 OI    A00005,B'01000000'                                 0079
*           FILEPROT  = '1'B;           /* DEVTAB F.P.MODE      Y02906*
         OI    12(@7),B'00000010'                                 0080
*           CDSFPM    = '1'B;           /* SCT F.P.M. IN CDS    Y02906*
         OI    A00007,B'10000000'                                 0081
*           DVCDSFPM  = '1'B;           /* DEVTAB CDS FPM       Y02906*
         OI    41(@7),B'10000000'                                 0082
*           DPDONE    = '1'B;           /* D.P. COMPLETE        Y02906*
         OI    12(@7),B'00100000'                                 0083
*           GO TO DPPACK08;             /* GO EXIT THIS         Y02906*
         BC    15,DPPACK08                                        0084
*           END;                        /* MODULE               Y02906*
*         IF DPDONE='1'B THEN
@9FF     TM    12(@7),B'00100000'                                 0086
*           GOTO DPPACK08;
         BC    01,DPPACK08                                        0087
*   DPPACK00:                            /*                     Y01906*
*         IF TYPE = '09'X ×             /* IF THIS IS A 3330A   Y02906*
*            TYPE = '0D'X THEN          /* OR ICEBURG           Y02906*
DPPACK00 CLI   39(@7),X'09'                                       0088
         BC    08,@9FE                                            0088
         CLI   39(@7),X'0D'                                       0088
         BC    07,@9FD                                            0088
*           GO TO DPPACK14;             /* GO TO EXIO SETUP     Y02906*
         BC    08,DPPACK14                                        0089
*
*  /*******************************************************************
*  /*                                                                 *
*  /*                   SET UP PARAMETERS FOR EXIO                    *
*  /*                                                                 *
*  /*******************************************************************
*
*         CCWPTR = ADDR(LABEL1);        /* SET CCW POINTER      Y02906*
@9FD     LA    @F,LABEL1                                          0090
         ST    @F,CCWPTR                                          0090
*
*  GEN(BAL   R5,IORTN);                  /* I/O ROUTINES         M4506*
         BAL   R5,IORTN
         DS    0H
*  /*******************************************************************
*  /*                                                                 *
* /*                             CHECK FOR CE PACK              S20203*
*  /*                                                                 *
*  /*******************************************************************
*
*           IF CEF0FE='F0FE-' THEN       /* IS VOL F0FE PACK    S20203*
         CLC   BUF2+14(5),@C4                                     0092
*                 GOTO DPPACK09;         /* GO SET UP FOR EXIT  S20203*
         BC    08,DPPACK09                                        0093
*
*
*  /*******************************************************************
*  /*                                                                 *
*  /*                   SET UP PARAMETERS FOR EXIO              S20203*
*  /*                                                                 *
*  /*******************************************************************
*
*  DPPACK12:                             /*                     S20203*
*         CCWPTR = ADDR(LABEL0);        /* SET CCW POINTER      Y02906*
DPPACK12 LA    @F,LABEL0                                          0094
         ST    @F,CCWPTR                                          0094
*
*
*  GEN(BAL   R5,IORTN);                  /* I/O ROUTINES         M4506*
         BAL   R5,IORTN
         DS    0H
* /********************************************************************
* /*                                                                  *
*  /*              CHECK LABEL AND SECURITY BIT                 S20203*
* /*                                                                  *
* /********************************************************************
*
*         IF STLAB = 'VOL1' THEN         /* IF A STANDARD LABL, Y01906*
         CLC   BUF(4),@C5                                         0096
*            GOTO DPPAK12A;              /* CONTINUE CHECKING.  Y01906*
         BC    08,DPPAK12A                                        0097
*            ELSE DO;                    /*                     Y01906*
*               R1 = MSG2A;              /* IF NOT, PRINT -     Y01906*
         L     @1,8(0,@4)                                         0099
*               GO TO DPPACK13;          /* IFD124I SHORT FORM  Y01906*
         BC    15,DPPACK13                                        0100
*            END;                        /*                     Y01906*
*  DPPAK12A:                             /*                     Y01906*
*         IF SECBYT='F0'X×               /* NO SECURITY          M4506*
*           SECBYT='40'X ×               /* NO SECURITY               *
*           SECBYT='00'X THEN            /* NO SECURITY          M4506*
DPPAK12A CLI   BUF+10,X'F0'                                       0102
         BC    08,@9FC                                            0102
         CLI   BUF+10,X'40'                                       0102
         BC    08,@9FB                                            0102
         CLI   BUF+10,X'00'                                       0102
         BC    07,@9FA                                            0102
*             IF CEVOL1='CEPACK' THEN    /* CE PACK IDENTITY     M4506*
@9FB     EQU   *                                                  0103
@9FC     CLC   BUF+4(6),@C9                                       0103
*               GOTO DPPACK09;           /* CE PACK FOUND        M4506*
         BC    08,DPPACK09                                        0104
*             ELSE DO;                   /* STD LABL, NOT CEPAK Y01906*
*                R1 = MSG2;              /* PRINT IFD124I(LONG) Y01906*
         L     @1,4(0,@4)                                         0106
*                MSGVOLID = CEVOL1;      /* PUT VOLID IN MSG    Y01906*
         MVC   42(6,@1),BUF+4                                     0107
*                GO TO DPPACK13;         /* GO PRINT IFD124I    Y01906*
         BC    15,DPPACK13                                        0108
*             END;                       /*                     Y01906*
*         ELSE GOTO DPPACK11;            /* SECURITY PROTECTED   M4506*
*  DPPACK14:                             /*                     S20203*
*
*
*  /*******************************************************************
*  /*                                                                 *
*  /*                   SET UP PARAMETERS FOR EXIO              S20203*
*  /*                                                                 *
*  /*******************************************************************
*
*         CCWPTR = ADDR(LABEL2);        /* SET CCW POINTER      Y02906*
@9F9     EQU   *                                                  0111
DPPACK14 LA    @F,LABEL2                                          0111
         ST    @F,CCWPTR                                          0111
*
*
*  GEN(BAL   R5,IORTN);                  /* I/O ROUTINES         M4506*
         BAL   R5,IORTN
         DS    0H
*  /*******************************************************************
*  /*                                                                 *
*  /*                   CHECK MERLIN CE BIT                     S20203*
*  /*                                                                 *
*  /*******************************************************************
*            IF MERLIN='1'B THEN         /* IS THE VOL A CE PACKS20203*
         TM    BUF1,B'00000100'                                   0113
*               GOTO DPPACK09;           /* GO SET UP FOR EXIT  S20203*
         BC    01,DPPACK09                                        0114
*                                        /*                     S20203*
*         GOTO DPPACK12;                 /* CHK FOR CEPACK LABL ×01906*
         BC    15,DPPACK12                                        0115
*
*  /*******************************************************************
*  /*                                                                 *
*  /*                     PRINT IFD124I MESSAGE                       *
*  /*                                                                 *
*  /*******************************************************************
*  DPPACK13:                             /*                     S20203*
*         FILMSK='0'B;                   /*SET TO INHIBIT MODE SET CHG*
DPPACK13 NI    A00010+1,B'11110111'                               0116
*  MSGDVAD1=DEVADEB;                /* PUT DEV ADDR IN MSG2           *
         MVC   26(8,@1),0(@7)                                     0117
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506*
         BAL   R5,DPPWTO
         DS    0H
*
*  GOTO DPPACK10;                        /*GO PRINT MSG IFD139D       *
         BC    15,DPPACK10                                        0119
*
*  DPPACK09:                             /*                     S20203*
*         DPDONE   ='1'B;               /* SET DP COMPLETE SW   Y02906*
DPPACK09 OI    12(@7),B'00100000'                                 0120
*         FILEPROT ='0'B;               /* OFF FPM  SW          Y02906*
         NI    12(@7),B'11111101'                                 0121
*         FPM      ='0'B;               /* OFF FPM  SW          Y02906*
         NI    A00005,B'10111111'                                 0122
*         DVCDSFPM ='0'B;               /* OFF FPM  SW          Y02906*
         NI    41(@7),B'01111111'                                 0123
*         DVCDSCEV ='1'B;               /* ON CE VOL SW         Y02906*
         OI    41(@7),B'00100000'                                 0124
*         CDSFPM   ='0'B;               /* OFF FPM SW           Y02906*
         NI    A00007,B'01111111'                                 0125
*         CDSCEVOL ='1'B;               /* ON CEVOL SW          Y02906*
         OI    A00007,B'00100000'                                 0126
*         CEVOL    ='1'B;               /* ON CEVOL SW          Y02906*
         OI    13(@7),B'00100000'                                 0127
*  GOTO DPPACK08;                        /*                     S20203*
         BC    15,DPPACK08                                        0128
*  DPPACK02:
*  IF CCP='F3'X THEN                /* IF CC=3 GO PRINT          M1310*
DPPACK02 CLI   TECB+8,X'F3'                                       0129
*     GOTO DPPACK04;                /* MESSAGE                        *
         BC    08,DPPACK04                                        0130
*  IF SNS2='0'B THEN                /* IF INTERVENTION IS NOT REQUIRED*
         TM    TECB+23,B'01000000'                                0131
*     GOTO DPPACK05;                /* GO PRINT MESSAGE               *
         BC    08,DPPACK05                                        0132
*
*  R1=MSG4;                         /* POINTER TO MESSAGE             *
         L     @1,16(0,@4)                                        0133
*  MSGDVAD3=DEVADEB;                /* PUT DEV ADDR IN MSG4           *
         MVC   29(8,@1),0(@7)                                     0134
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506*
         BAL   R5,DPPWTO
         DS    0H
*
*  GOTO DPPACK10;                        /* PRINT MSG IFD139D   Y01906*
         BC    15,DPPACK10                                        0136
*
*  DPPACK03:
*  R1=MSG6;                         /* POINTER TO MESSAGE             *
DPPACK03 L     @1,24(0,@4)                                        0137
*  MSGCSW=CSWIN;                    /* PUT CONVERTED DATA IN MSG      *
         MVC   18(14,@1),INBUF                                    0138
*  MSGSNS = SNSIN;                       /* PUT SENSE IN IFD137IY01906*
         MVC   37(12,@1),INBUF+20                                 0139
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506*
         BAL   R5,DPPWTO
         DS    0H
*  /*******************************************************************
*  /*                                                                 *
*  /*                          PRINT MESSAGE IFD139D                  *
*  /*                                                                 *
*  /*******************************************************************
*  DPPACK10:
*  R1=MSG5;                         /* POINTER TO MESSAGE             *
DPPACK10 L     @1,20(0,@4)                                        0141
*  BUFAD=ADDR(BUFFER);              /* SET UP BUFFER ADDRESS          *
         LA    @F,BUFFER                                          0142
         ST    @F,@TEMP4                                          0142
         MVC   1(3,@1),@TEMP4+1                                   0142
*  MSGECBAD=ADDR(DECB);             /* PTR TO PWTOR ECB               *
         LA    @F,DECB                                            0143
         ST    @F,4(0,@1)                                         0143
*  LENGTH='01'X;                    /* LENGTH OF RESPONSE             *
         MVI   0(@1),X'01'                                        0144
*  DECB=0;                          /* CLEAR EVENT CONTROL BLOCK      *
         SR    @F,@F                                              0145
         ST    @F,DECB                                            0145
*  GEN(BAL   R5,DPPWTOR);                /* PRINT AND REPLY      M4506*
         BAL   R5,DPPWTOR
         DS    0H
*  IF BUFFER='P' THEN               /* IF PROCEED GO SET UP FOR RETURN*
         CLI   BUFFER,C'P'                                        0147
*     GOTO DPPACK01;                /* TO CALLING MODULE              *
         BC    08,DPPACK01                                        0148
*  IF BUFFER='B' THEN DO;
         CLI   BUFFER,C'B'                                        0149
         BC    07,@9F8                                            0149
*  DPPACK07:
*         IF PRIMARY ='1'B THEN
DPPACK07 TM    12(@7),B'01000000'                                 0151
         BC    12,@9F7                                            0151
*     BYPDEV='1'B;
         OI    A00010+3,B'00100000'                               0152
*     GOTO DPPACK08;
         BC    15,DPPACK08                                        0153
*                     END;
*  IF BUFFER='R' THEN               /* IF RETRY                       *
@9F8     CLI   BUFFER,C'R'                                        0155
*     GOTO DPPACK00;                /* GO READ R0 AGAIN               *
         BC    08,DPPACK00                                        0156
*  ELSE GOTO DPPACK10;              /* TRY AGAIN, DID NOT RECOGNIZE   *
         BC    15,DPPACK10                                        0157
*                                   /* REPLY                          *
*  /*******************************************************************
*  /*                                                                 *
*  /*                     PRINT MESSAGE IFD138I                       *
*  /*                                                                 *
*  /*******************************************************************
*  DPPACK04:
*  R1=MSG1;                         /* POINTER TO MESSAGE             *
DPPACK04 L     @1,0(0,@4)                                         0158
*  MSGDVAD=DEVADEB;                 /* PUT DEV ADDR IN MSG1           *
         MVC   16(8,@1),0(@7)                                     0159
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506*
         BAL   R5,DPPWTO
         DS    0H
*  GOTO DPPACK10;
         BC    15,DPPACK10                                        0161
*
*  /*******************************************************************
*  /*                                                                 *
*  /*                     PRINT MESSAGE IFD125I                       *
*  /*                                                                 *
*  /*******************************************************************
*  DPPACK05:
*  R1=MSG3;                         /* POINTER TO MESSAGE             *
DPPACK05 L     @1,12(0,@4)                                        0162
*  MSGDVAD2=DEVADEB;                /* PUT DEV ADDR IN MSG3           *
         MVC   32(8,@1),0(@7)                                     0163
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506*
         BAL   R5,DPPWTO
         DS    0H
*  GOTO DPPACK06;
         BC    15,DPPACK06                                        0165
*
*  /*******************************************************************
*  /*                                                                 *
*  /*                    CONVERT SENSE & CSW INFO                     *
*  /*                                                                 *
*  /*******************************************************************
*  DPPACK06:
*  GEN(BAL   R14,NEWCONV);               /* CONVERT CALL         M4506*
DPPACK06 BAL   R14,NEWCONV
         DS    0H
*  SUSDEL='1'B;                          /* SUSPEND DELETION     M4506*
         OI    A00000,B'00001000'                                 0167
*  GEN(BAL   R14,NEWCONV);               /* CONVERT CALL         M4506*
         BAL   R14,NEWCONV
         DS    0H
*  GOTO DPPACK03;                   /* GO PRINT SNS/CSW INFO          *
         BC    15,DPPACK03                                        0169
*
*
* /********************************************************************
* /*                                                                  *
* /*                       PRINT MESSAGE IFD122I                S20203*
* /*                                                                  *
* /********************************************************************
*
* DPPACK11:                              /*                     S20203*
* R1=MSG8;                          /* PTR TO MSG               S20203*
DPPACK11 L     @1,32(0,@4)                                        0170
* MSGDVAD4=DEVADEB;                 /* PUT DEV ADDR IN MSG 8    S20203*
         MVC   19(8,@1),0(@7)                                     0171
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506*
         BAL   R5,DPPWTO
         DS    0H
*
*
* /********************************************************************
* /*                                                                  *
* /*                       PRINT MESSAGE IFD139D                S20203*
* /*                                                                  *
* /********************************************************************
*
* R1=MSG7;                          /* POINTER TO MESSAGE       S20203*
         L     @1,28(0,@4)                                        0173
* BUFAD=ADDR(BUFFER);               /* SET UP BUFFER ADDR       S20203*
         LA    @F,BUFFER                                          0174
         ST    @F,@TEMP4                                          0174
         MVC   1(3,@1),@TEMP4+1                                   0174
* MSGECBAD=ADDR(DECB);                   /* POINTER TO PWTOR ECBS20203*
         LA    @F,DECB                                            0175
         ST    @F,4(0,@1)                                         0175
* LENGTH='01'X;                     /* LENGTH OF RESPONSE       S20203*
         MVI   0(@1),X'01'                                        0176
* DECB=0;                           /* CLEAR ECB                S20203*
         SR    @F,@F                                              0177
         ST    @F,DECB                                            0177
*  GEN(BAL   R5,DPPWTOR);                /* PRINT AND REPLY      M4506*
         BAL   R5,DPPWTOR
         DS    0H
* IF BUFFER='B' THEN                /* BYPASS X                 S20203*
         CLI   BUFFER,C'B'                                        0179
*         GOTO DPPACK07;                 /*                     S20203*
         BC    08,DPPACK07                                        0180
* IF BUFFER='R' THEN                /* RETRY ?                  S20203*
         CLI   BUFFER,C'R'                                        0181
*         GOTO DPPACK00;                 /*                     S20203*
         BC    08,DPPACK00                                        0182
* ELSE    GOTO DPPACK11;            /* REPLY NOT RECOGNIZED  TRY AGAIN*
         BC    15,DPPACK11                                        0183
*                                        /*                     S20203*
*
* DPPWTO:
*  GEN(PWTO  REG=(1));                   /* ISSUE WTO            M4506*
DPPWTO   PWTO  REG=(1)
         DS    0H
*  GOTO R5;                              /* RETURN               M4506*
         BCR   15,@5                                              0185
* DPPWTOR:
*  GEN(PWTOR REG=(1));                   /* ISSUE WTOR           M4506*
DPPWTOR  PWTOR REG=(1)
         DS    0H
*  GOTO R5;                              /* RETURN               M4506*
         BCR   15,@5                                              0187
* IORTN:
*  FILMSK='1'B;                          /* ALLOW MODE SET       M4506*
IORTN    OI    A00010+1,B'00001000'                               0188
*  PROTECT='1'B;                         /* FILE PROTECT MODE    M4506*
         OI    A00010,B'01000000'                                 0189
*         FLGB   = '00'X;               /* ZERO OUT FLGS        Y02906*
         MVI   FLGB,X'00'                                         0190
*         CLRTECB = CLRTECB && CLRTECB; /* CLEAR TECB           Y02906*
         XC    TECB+6(39),TECB+6                                  0191
*         DVTPTR = R7;                  /* SET DEVTAB ADDR      Y02906*
         ST    @7,DVTPTR                                          0192
*         FLGA   = '00'X;               /* ZERO OUT FLGS        Y02906*
         MVI   FLGA,X'00'                                         0193
*         INTCALL = '1'B;               /* SET INTERNAL CALL SW Y02906*
         OI    FLG2,B'10000000'                                   0194
*         BYPASS = '1'B;                 /* SET BYPASS PREFIX SWY02906*
         OI    FLG1A,B'10000000'                                  0195
*         SNSCNT = '18'X;                /* SET SENSE COUNT     Y02906*
         MVI   SNSCNT,X'18'                                       0196
*         TECBPTRX = ADDR(TECB);         /* SET ADDR TECB       Y02906*
         LA    @F,TECB                                            0197
         ST    @F,TECBPTRX                                        0197
*         CDSPTR = ADDR(ADRHEX);        /* SET ADDR OF CDS DEV  Y02906*
         LA    @F,32(0,@7)                                        0198
         ST    @F,WAITLST+8                                       0198
*         R15    = IORTNADR;            /* GET TO EFFECTOR ADDR Y02906*
         L     @F,IORTNADR                                        0199
*         GEN(BALR R14,R15);            /*                      Y02906*
         BALR R14,R15
         DS    0H
*         R1 = ADDR(WAITLST);           /* GET POINTER FOR WAIT Y02906*
         LA    @1,WAITLST                                         0201
*         R14 = ADDR(STATS);            /* GET WAIT RETURNADDR  Y02906*
         LA    @E,STATS                                           0202
*         R15 = TAB28;                   /* GET TRANS MGR ENTRY Y02906*
         L     @F,TAB28                                           0203
*         GO TO R15;                    /* GO TO THE WAIT MOD   Y02906*
         BCR   15,@F                                              0204
*       STATS:                          /* WAIT RETURN POINT    Y02906*
*  PROTECT='0'B;                         /* CLEAR BIT            M4506*
STATS    NI    A00010,B'10111111'                                 0205
*  IF EXIOK^='0C'X THEN                  /* CHECK EXIO           M4506*
         CLI   TECB+16,X'0C'                                      0206
*    GOTO DPPACK02;
         BC    07,DPPACK02                                        0207
*  GOTO R5;                              /* RETURN FROM ROUTINE  M4506*
         BCR   15,@5                                              0208
* NEWCONV:
*  R1=ADDR(CNVRT);                       /* CONVERT PARAMETER    M4506*
NEWCONV  LA    @1,CNVRT                                           0209
*  R15=TAB28;                            /* TRANSIENT MANAGER    M4506*
         L     @F,TAB28                                           0210
*  GOTO R15;                             /* CALL CONVERT         M4506*
         BCR   15,@F                                              0211
*
*  DPPACK08:
*  RETURN;                          /* RETURN TO CALLING MODULE       *
*         END;
@EL01    L     @D,4(0,@D)                                         0213
         LM    @E,@C,12(@D)                                       0213
         BCR   15,@E                                              0213
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
         DS    0F
@C5      DC    C'VOL1'
@C9      DC    C'CEPACK'
@C4      DC    C'F0FE-'
         DS    0D
@DATA    EQU   *
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD
Y        EQU   00000000            FULLWORD INTEGER
R0       EQU   00000000            FULLWORD POINTER REGISTER
R1       EQU   00000001            FULLWORD POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD POINTER REGISTER
R4       EQU   00000004            FULLWORD POINTER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
R6       EQU   00000006            FULLWORD POINTER REGISTER
R7       EQU   00000007            FULLWORD POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
R9       EQU   00000009            FULLWORD POINTER REGISTER
R10      EQU   00000010            FULLWORD POINTER REGISTER
R11      EQU   00000011            FULLWORD POINTER REGISTER
R12      EQU   00000012            FULLWORD POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
R15      EQU   00000015            FULLWORD POINTER REGISTER
I        EQU   @DATA+00000072      FULLWORD INTEGER
A00028   EQU   00000000            52 BYTE(S) ON WORD
DEVADEB  EQU   A00028+00000000     8 BYTE(S)
UCBAD    EQU   A00028+00000008     FULLWORD POINTER
DEVFLG1  EQU   A00028+00000012     1 BYTE(S)
STATUS   EQU   A00028+00000012     1 BIT(S)
PRIMARY  EQU   A00028+00000012     1 BIT(S)
DPDONE   EQU   A00028+00000012     1 BIT(S)
A00029   EQU   A00028+00000012     3 BIT(S)
FILEPROT EQU   A00028+00000012     1 BIT(S)
A00030   EQU   A00028+00000012     1 BIT(S)
DEVFLG2  EQU   A00028+00000013     1 BYTE(S)
A00031   EQU   A00028+00000013     2 BIT(S)
CEVOL    EQU   A00028+00000013     1 BIT(S)
STDLABL  EQU   A00028+00000013     1 BIT(S)
A00032   EQU   A00028+00000013     4 BIT(S)
DEVFLG3  EQU   A00028+00000014     1 BYTE(S)
DEVFLG4  EQU   A00028+00000015     1 BYTE(S)
TAPELABL EQU   A00028+00000016     16 BYTE(S)
VOL      EQU   A00028+00000016     10 BYTE(S)
HDR      EQU   A00028+00000026     4 BYTE(S)
MODESV   EQU   A00028+00000030     1 BYTE(S)
A00033   EQU   A00028+00000031     1 BYTE(S)
ADRHEX   EQU   A00028+00000032     4 BYTE(S)
A00034   EQU   A00028+00000032     2 BYTE(S)
HEXAD    EQU   A00028+00000034     2 BYTE(S)
CDSINFOR EQU   A00028+00000036     16 BYTE(S)
FEATURES EQU   A00028+00000036     1 BYTE(S)
MODEL    EQU   A00028+00000037     1 BYTE(S)
CLASS    EQU   A00028+00000038     1 BYTE(S)
TYPE     EQU   A00028+00000039     1 BYTE(S)
A00035   EQU   A00028+00000040     1 BYTE(S)
CDSFLAGS EQU   A00028+00000041     1 BYTE(S)
DVCDSFPM EQU   A00028+00000041     1 BIT(S)
A00036   EQU   A00028+00000041     1 BIT(S)
DVCDSCEV EQU   A00028+00000041     1 BIT(S)
A00037   EQU   A00028+00000041     5 BIT(S)
WAITLST  EQU   @DATA+00000076      16 BYTE(S) ON WORD
         ORG   WAITLST+00000000
XMGR     EQU   *                   1 BYTE(S)
         DC    X'00'
LVL      EQU   *                   1 BYTE(S)
         DC    X'02'
MODID    EQU   *                   2 BYTE(S)
         DC    C'36'
TECBPTR  EQU   *                   FULLWORD POINTER
         DC    AL4(TECB)
CDSPTR   EQU   *                   FULLWORD POINTER
         DC    AL4(0)
FLG      EQU   *                   8 BIT(S) ON BYTE
         DC    X'80'
WAITYES  EQU   WAITLST+00000012    1 BIT(S)
TIME     EQU   *                   2 BYTE(S)
         DC    X'001E'
TECB     EQU   @DATA+00000092      45 BYTE(S) ON WORD
         ORG   TECB+00000000
FLDCNT   EQU   *                   1 BYTE(S)
         DC    X'01'
FLDSIZE  EQU   *                   1 BYTE(S)
         DC    X'0C'
SOMETNG  EQU   *                   1 BYTE(S)
         DC    X'00'
SNSSIZE  EQU   *                   1 BYTE(S)
         DC    X'18'
FLG1     EQU   *                   1 BYTE(S)
         DC    X'00'
SNSCNTTB EQU   *                   1 BYTE(S)
         DC    X'01'
CLRTECB  EQU   TECB+00000006       39 BYTE(S)
CNTSNS   EQU   *                   1 BYTE(S)
         DC    X'00'
CNTINT   EQU   *                   1 BYTE(S)
         DC    X'00'
CCP      EQU   TECB+00000008       1 BYTE(S)
A00038   EQU   TECB+00000009       3 BYTE(S)
CSW1     EQU   TECB+00000012       8 BYTE(S)
A00039   EQU   TECB+00000012       4 BYTE(S)
STATUSX  EQU   TECB+00000016       2 BYTE(S)
EXIOK    EQU   TECB+00000016       1 BYTE(S)
A00040   EQU   TECB+00000016       6 BIT(S)
UNITCK   EQU   TECB+00000016       1 BIT(S)
UNITEXCP EQU   TECB+00000016       1 BIT(S)
BYTE2    EQU   TECB+00000017       1 BYTE(S)
A00041   EQU   TECB+00000017       1 BIT(S)
INLENGTH EQU   TECB+00000017       1 BIT(S)
A00042   EQU   TECB+00000017       6 BIT(S)
A00043   EQU   TECB+00000018       2 BYTE(S)
SENSE    EQU   TECB+00000020       24 BYTE(S)
A00044   EQU   TECB+00000020       3 BYTE(S)
SNS1     EQU   TECB+00000023       7 BYTE(S)
SNSFLD   EQU   TECB+00000023       8 BIT(S)
A00045   EQU   TECB+00000023       1 BIT(S)
SNS2     EQU   TECB+00000023       1 BIT(S)
A00046   EQU   TECB+00000024       2 BYTE(S)
A00047   EQU   TECB+00000026       8 BIT(S)
A00048   EQU   TECB+00000026       5 BIT(S)
PEIND    EQU   TECB+00000026       1 BIT(S)
A00049   EQU   TECB+00000027       2 BYTE(S)
A00050   EQU   TECB+00000029       1 BYTE(S)
A00051   EQU   TECB+00000029       4 BIT(S)
BIT4     EQU   TECB+00000029       1 BIT(S)
BUF      EQU   @DATA+00000137      20 BYTE(S)
STLAB    EQU   BUF+00000000        4 BYTE(S)
CEVOL1   EQU   BUF+00000004        6 BYTE(S)
SECBYT   EQU   BUF+00000010        1 BYTE(S)
A00052   EQU   BUF+00000011        9 BYTE(S)
BUF1     EQU   @DATA+00000157      5 BYTE(S)
A00053   EQU   BUF1+00000000       8 BIT(S)
A00054   EQU   BUF1+00000000       5 BIT(S)
MERLIN   EQU   BUF1+00000000       1 BIT(S)
A00055   EQU   BUF1+00000000       2 BIT(S)
A00056   EQU   BUF1+00000001       4 BYTE(S)
BUF2     EQU   @DATA+00000162      20 BYTE(S)
A00057   EQU   BUF2+00000000       14 BYTE(S)
CEF0FE   EQU   BUF2+00000014       5 BYTE(S)
A00058   EQU   BUF2+00000019       1 BYTE(S)
         ORG   @DATA+00000184
MSGPTR   EQU   *                   FULLWORD POINTER
         DC    VL4(IFDMSG07)
A00059   EQU   00000000            36 BYTE(S) ON WORD
MSG1     EQU   A00059+00000000     FULLWORD POINTER
MSG2     EQU   A00059+00000004     FULLWORD POINTER
MSG2A    EQU   A00059+00000008     FULLWORD POINTER
MSG3     EQU   A00059+00000012     FULLWORD POINTER
MSG4     EQU   A00059+00000016     FULLWORD POINTER
MSG5     EQU   A00059+00000020     FULLWORD POINTER
MSG6     EQU   A00059+00000024     FULLWORD POINTER
MSG7     EQU   A00059+00000028     FULLWORD POINTER
MSG8     EQU   A00059+00000032     FULLWORD POINTER
MSGDVAD  EQU   00000016            8 BYTE(S)
MSGDVAD1 EQU   00000026            8 BYTE(S)
MSGVOLID EQU   00000042            6 BYTE(S)
MSGDVAD2 EQU   00000032            8 BYTE(S)
MSGDVAD3 EQU   00000029            8 BYTE(S)
MSGDVAD4 EQU   00000019            8 BYTE(S)
MSGCSW   EQU   00000018            14 BYTE(S)
MSGSNS   EQU   00000037            12 BYTE(S)
SIX      EQU   *                   2 BYTE(S)
         DC    X'0006'
MSGPARM  EQU   00000000            8 BYTE(S) ON WORD
LENGTH   EQU   MSGPARM+00000000    1 BYTE(S)
BUFAD    EQU   MSGPARM+00000001    3  BYTE  POINTER ON WORD+1
MSGECBAD EQU   MSGPARM+00000004    FULLWORD INTEGER
         ORG   @DATA+00000192
DECB     EQU   *                   FULLWORD INTEGER
         DC    FL4'0'
INBUF    EQU   @DATA+00000196      62 BYTE(S)
CSWIN    EQU   INBUF+00000000      14 BYTE(S)
A00060   EQU   INBUF+00000014      6 BYTE(S)
SNSIN    EQU   INBUF+00000020      48 BYTE(S)
         ORG   @DATA+00000264
SEEKVOL  EQU   *                   7 BYTE(S)
         DC    X'00000000000003'
SEEKF0FE EQU   *                   6 BYTE(S)
         DC    X'000000060000'
SEEKMERL EQU   *                   6 BYTE(S)
         DC    X'000000000000'
         ORG   @DATA
         DS    00000288C
@TEMPS   DS    0F
@TEMP4   DC    F'0'
*                                                                     *
*                                 CCW LIST                            *
*                                                                     *
*              SEEK LABEL  ON VOL1 PACK                               *
LABEL0   DS    0D                                                S20203
         CCW   07,SEEKVOL,X'60',6       SEEK LABEL               S20203
         CCW   49,SEEKVOL+2,X'60',5     SEARCH FOR VOL1 ON LABEL S20203
         CCW   08,*-8,X'60',1           TIC                      S20203
         CCW   06,BUF,X'60',20          GET VOL1&SEC DATA        S20203
         CCW   04,*,X'30',1      FORCE CHAN END DEV END, NO DATA TRANS
*                                                                     *
*              SEEK FOR DATA ON FOFE PACK                             *
LABEL1   DS    0D                                                S20203
         CCW   07,SEEKF0FE,X'60',6      SEEK FOR F0FE            S20203
         CCW   22,BUF2,X'60',20         GET F0FE DATA R0+14      S20203
         CCW   04,*,X'30',1      FORCE CHAN END DEV END, NO DATA TRANS
*                                                                     *
*              SEEK AND READ HOME ADDRESS  ON MERLIN DEVICE           *
LABEL2   DS    0D                                                S20203
         CCW   07,SEEKMERL,X'60',6   SEEK                        S20203
         CCW   26,BUF1,X'60',5      READ HOME ADDR               S20203
         CCW   04,*,X'30',1      FORCE CHAN END DEV END, NO DATA TRANS
*                                                                     *
*              PARAMETER LIST FOR CONVERT MODULE                      *
CNVRT    DC    B'00000000'         CONTROL PROGRAM FLAGS
         DC    AL1(2)              MACRO LEVEL
         DC    CL2'41'             MACRO ID
         DC    A(CSW1+1)
         DC    A(INBUF)
         DC    AL2(31+32768)            COUNT AND TYPE           S20203
DSECTAA  IFDCOM
A00000   EQU   CESWT3+00000000     1 BYTE(S)
A00001   EQU   A00000+00000000     3 BIT(S)
GRBCTL   EQU   A00000+00000000     1 BIT(S)
SUSDEL   EQU   A00000+00000000     1 BIT(S)
A00002   EQU   A00000+00000000     1 BIT(S)
A00003   EQU   OLTTAB+00000000     8 BYTE(S) ON WORD
OLTTAB1  EQU   A00003+00000000     FULLWORD POINTER
OLTTAB2  EQU   A00003+00000004     FULLWORD POINTER
A00004   EQU   A00003+00000004     FULLWORD POINTER
A00005   EQU   CHASCT+00000010     1 BYTE(S)
A00006   EQU   A00005+00000000     1 BIT(S)
FPM      EQU   A00005+00000000     1 BIT(S)
A00007   EQU   CHASCT+00000011     1 BYTE(S)
CDSFPM   EQU   A00007+00000000     1 BIT(S)
A00008   EQU   A00007+00000000     1 BIT(S)
CDSCEVOL EQU   A00007+00000000     1 BIT(S)
A00009   EQU   A00007+00000000     5 BIT(S)
A00010   EQU   CESWT+00000000      4 BYTE(S) ON WORD
A00011   EQU   A00010+00000000     8 BIT(S)
A00012   EQU   A00010+00000000     1 BIT(S)
PROTECT  EQU   A00010+00000000     1 BIT(S)
A00013   EQU   A00010+00000000     6 BIT(S)
A00014   EQU   A00010+00000001     8 BIT(S)
A00015   EQU   A00010+00000001     4 BIT(S)
FILMSK   EQU   A00010+00000001     1 BIT(S)
A00016   EQU   A00010+00000001     1 BIT(S)
ONLINEOK EQU   A00010+00000001     1 BIT(S)
A00017   EQU   A00010+00000001     1 BIT(S)
A00018   EQU   A00010+00000002     8 BIT(S)
NDCFO    EQU   A00010+00000002     1 BIT(S)
DPONDEV  EQU   A00010+00000002     1 BIT(S)
A00019   EQU   A00010+00000002     1 BIT(S)
CHANTEST EQU   A00010+00000002     1 BIT(S)
A00020   EQU   A00010+00000002     1 BIT(S)
A00021   EQU   A00010+00000002     1 BIT(S)
TAPEHDR  EQU   A00010+00000002     1 BIT(S)
AMERLDV  EQU   A00010+00000002     1 BIT(S)
A00022   EQU   A00010+00000003     8 BIT(S)
A00023   EQU   A00010+00000003     1 BIT(S)
NURUN    EQU   A00010+00000003     1 BIT(S)
BYPDEV   EQU   A00010+00000003     1 BIT(S)
A00024   EQU   A00010+00000003     1 BIT(S)
A00025   EQU   A00010+00000003     1 BIT(S)
A00026   EQU   A00010+00000003     1 BIT(S)
A00027   EQU   A00010+00000003     1 BIT(S)
STDLAB   EQU   A00010+00000003     1 BIT(S)
FLG1A    EQU   FLGA+00000000       8 BIT(S) ON BYTE
BYPASS   EQU   FLG1A+00000000      1 BIT(S)
FLG2     EQU   FLGB+00000000       8 BIT(S) ON BYTE
INTCALL  EQU   FLG2+00000000       1 BIT(S)
MODEREQ  EQU   FLG2+00000000       1 BIT(S)
BUFFER   EQU   INBUFR+00000000     1 BYTE(S)
@DATEND  EQU   *
@9FE     EQU   DPPACK14
@9FA     EQU   DPPACK11
DPPACK08 EQU   @EL01
@9F7     EQU   DPPACK08
         END

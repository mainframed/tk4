         TITLE 'IFDOLT49 CDS EQUATING'
         TITLE ' CDS EQUATING.  IFDOLT49'
         LCLA  &T,&SPN                                            0002
.@001    ANOP                                                     0002
IFDOLT49 CSECT ,                                                  0002
         BC    15,24(0,@F)
         DC    C'IFDOLT49 13 SEP 73'                             0002
         STM   @E,@C,12(@D)                                       0002
         BALR  @B,0                                               0002
@PSTART  DS    0H                                                 0002
         USING @PSTART+00000,@B                                   0002
         ST    @D,@SAV001+4                                       0002
         LA    @F,@SAV001                                         0002
         ST    @F,8(0,@D)                                         0002
         LR    @D,@F                                              0002
*  GEN(USING CHASCT,2);                  /* COMMON AREA MAP           *
         USING CHASCT,2
         DS    0H
*  GENERATE DATA;
*  DCL R0 REG(0) PTR;                    /* GP REGISTER               *
*  DCL R1 REG(1) PTR;                    /* GP REGISTER               *
*  DCL R2 REG(2) PTR;                    /* GP REGISTER               *
*  DCL R3 REG(3) PTR;                    /* GP REGISTER               *
*  DCL R4 REG(4) PTR;                    /* GP REGISTER               *
*  DCL R5 REG(5) PTR;                    /* GP REGISTER               *
*  DCL R6 REG(6) PTR;                    /* GP REGISTER               *
*  DCL R7 REG(7) PTR;                    /* GP REGISTER               *
*  DCL R8 REG(8) PTR;                    /* GP REGISTER               *
*  DCL R9 REG(9) PTR;                    /* GP REGISTER               *
*  DCL R10 REG(10) PTR;                  /* GP REGISTER               *
*  DCL R11 REG(11) PTR;                  /* GP REGISTER               *
*  DCL R12 REG(12) PTR;                  /* GP REGISTER               *
*  DCL R13 REG(13) PTR;                  /* GP REGISTER               *
*  DCL R14 REG(14) PTR;                  /* GP REGISTER               *
*  DCL R15 REG(15) PTR;                  /* GP REGISTER               *
*  DCL DEVTBPTR PTR GENERATED;           /* DEVICE TABLE PTR          *
*  DCL TABLNGTH GENERATED;               /* TABLE SIZE PER DEVICE     *
*  DCL 1 * CHAR(1) BASED(ADDR(TABLNGTH)+2), /* OLTEP SWITCHES         *
*         3 * BIT(1),                    /* NA                  XM3338*
*         3 RESENTB BIT(1),              /* RESIDENT ENTRIES    XM3338*
*         3 * BIT(4),                                         /*XM0095*
*         3 FSTEQU BIT(1),               /* FIRST EQU ENTERED   XM0095*
*         3 * BIT(1);                                         /*XM0095*
*  DCL MCT GENERATED;                    /* MCT                       *
*  DCL ROOTPTR PTR BASED(ADDR(MCT)+128); /* IFDOLT00 ADDRESS          *
*  DCL IFDMSG49 CHAR(1) GENERATED;
*  DCL 1 * BDY(WORD) BASED(ADDR(IFDMSG49)), /* MESSAGE POINTERS       *
*         2 IFD394 PTR,                  /* MESSAGE ADDRESS           *
*         2 IFD395 PTR,                  /* MESSAGE ADDRESS           *
*         2 IFD396 PTR,                  /* MESSAGE ADDRESS           *
*         2 IFD397 PTR,                  /* MESSAGE ADDRESS           *
*         2 IFD398 PTR,                  /* MESSAGE ADDRESS           *
*         2 IFD373 PTR(31),              /* MESSAGE ADDRESS     XM0095*
*         9 * CHAR(1);                   /* NA                        *
*  DCL EQUECB FIXED;                     /* CDS EQUATE ECB            *
*  DCL LSTSLH FIXED;                     /* LAST SLASH                *
*  DCL L FIXED;                          /* LOW ITEM                  *
*  DCL H FIXED;                          /* HIGH ITEM                 *
*  DCL RESTPTR PTR;                      /* RESIDENT TABLE PTR        *
*  DCL 1 * BDY(WORD) BASED(RESTPTR),     /* RESIDENT TABLE            *
*         2 RESTAB CHAR(64);             /* CDS RESIDENT TABLE        *
*  DCL 1 SETWTOR BDY(WORD) CHAR(8),      /* WTOR ADDRESSES            *
*         2 * PTR INIT(ADDR(RBUF)),      /* REPLY BUFFER              *
*         2 * PTR INIT(ADDR(EQUECB));    /* EQUATE ECB                *
*  DCL 1 * BDY(WORD) FIXED INIT(0),      /* ZERO CONSTANT             *
*         2 KZIP4 CHAR(4),               /* CONSTANT                  *
*           3 KZIP2 CHAR(2);             /* CONSTANT                  *
*  DCL 1 * BDY(WORD),                    /* TABLE ADDRESSES           *
*         2 ADRENT2 PTR,                 /* 2ND WORK TABLE            *
*         2 ADRENT3 PTR;                 /* 3RD WORK TABLE            *
*  DCL THIDK FIXED(15);                  /* AVAILABLE CDS             *
*  DCL 1 * BDY(WORD) BASED(DEVTBPTR),    /* WORK AREA TABLES          *
*         2 FSTENT12 CHAR(256),          /* 1ST AND 2ND AREAS         *
*           3 FSTENT1 CHAR(128),         /* 1ST WORK AREA             *
*           3 FSTENT2 CHAR(128),         /* 2ND WORK AREA             *
*         2 FSTENT3 CHAR(128),           /* 3RD WORK AREA             *
*           3 ENDTABS CHAR(1);           /* END WORK TABLES           *
*  DCL 1 * BDY(WORD) BASED(R3),          /* WORK TABLE                *
*         2 FSTD FIXED(15),              /* 1ST DEVICE                *
*         2 SECD FIXED(15),              /* 2ND DEVICE                *
*         2 THID FIXED(15);              /* 3RD DEVICE                *
*  DCL 1 * BDY(WORD) BASED(R3),          /* WORK TABLE                *
*         2 RESLST CHAR(2),              /* LAST DEVICE               *
*           3 RES1 CHAR(1),              /* 1ST BYTE                  *
*           3 RES2 CHAR(1);              /* 2ND BYTE                  *
*  DCL INCR3 CHAR(1) BASED(R3+1);        /* ADD ONE TO REG            *
*  DCL SETCODS CHAR(4) BASED(R3);        /* END MESSAGE TEXT
*  DCL WTORADRS CHAR(8) BASED(R4);       /* REPLY AND ECB PTR         *
*  DCL 1 * BASED(R4+11),                 /* NA                        *
*         2 MSG3951 CHAR(23),            /* MESSAGE TEXT              *
*           3 * CHAR(1),                 /* NA                        *
*           3 MSG395 CHAR(23),           /* MESSAGE TEXT              *
*               9 * CHAR(1);             /* NA                        *
*  DCL 1 * BASED(R4),                    /* IFD397 MESSAGE
*         2 * CHAR(26),                  /* NA
*           3 * CHAR(1),                 /* NA
*           3 MSGSZ CHAR(1),             /* MESSAGE SIZE
*         2 INVR CHAR(48),               /* MESSAGE TEXT
*         2 * CHAR(4),                   /* NA
*         2 RTDESC CHAR(4);              /* ROUTCDE AND DESC
*  DCL 1 SBUF CHAR(4) BASED(R5),         /* SAVE EBCDIC DEVICE        *
*         2 * CHAR(1),                   /* NA                        *
*         2 SBUF1 CHAR(3);               /* SAVE EBCDIC DEVICE        *
*  DCL HEXWD FIXED BDY(WORD) BASED(R7);  /* RESIDENT TABLE WORD       *
*  DCL ZIPENT2 CHAR(128) BASED(R7);      /* 2ND WORK TABLE            *
*  DCL 1 * BDY(WORD) BASED(R7),          /* NEW ENTRIES               *
*         2 DEVLK CHAR(4),               /* COMPLETE ENTRY            *
*           3 DEVLK1 CHAR(2),            /* 1ST DEVICE                *
*           3 DEVLK2 CHAR(2),            /* 2ND DEVICE                *
*         2 NXTLK CHAR(4);               /* NEXT ENTRY                *
*  DCL R7P1 CHAR(1) BASED(R7+1);         /* NEXT ITEM                 *
*  DCL 1 * BDY(HWORD) BASED(R7),         /* WORK TABLE                *
*         2 TB2 CHAR(1),                 /* 1ST BYTE                  *
*         2 TB2A CHAR(1),                /* 2ND BYTE                  *
*         2 NXTTB CHAR(1);               /* NEXT BYTES                *
*  DCL NXTWK CHAR(1) BASED(R7+128);      /* NEXT WORK TABLE           *
*  DCL 1 * BDY(WORD) BASED(R8),          /* SAVE RESIDENT TABLE       *
*         2 DEVCOP CHAR(4),              /* COMPLETE ENTRY            *
*           3 DEV1 CHAR(2),              /* 1ST DEVICE                *
*           3 DEV2 CHAR(2),              /* 2ND DEVICE                *
*         2 NXTENT CHAR(8);              /* NEXT ENTRY                *
*  DCL ABYT CHAR(1) BASED(R8);           /* 1ST ENTRY BYTE            *
*  DCL 1 * BASED(R8),                    /* EBCDIC RESIDENT           *
*         2 PDEV1 CHAR(4),               /* 1ST PRINTABLE DEVICE      *
*         2 PDEV2 CHAR(4),               /* 2ND PRINTABLE DEVICE      *
*         2 PDEVNXT CHAR(4);             /* NEXT DEVICE               *
*  DCL KCLRSL CHAR(4) INIT('CLR/');      /* CONSTANT                  *
*  DCL KENDSL CHAR(4) INIT('END/');      /* CONSTANT                  *
*  DCL KNONE CHAR(4) INIT('NONE');       /* CONSTANT                  *
*  DCL KYES CHAR(3) INIT('YES');         /* CONSTANT                  *
*  DCL KNO CHAR(3) INIT('NO ');          /* CONSTANT                  *
*  DCL 1 LIST CHAR(16)                   /* HEX CHARACTERS            *
*         INIT('0123456789ABCDEF'),      /* IN EBCDIC                 *
*         2 * CHAR(1),                   /* NA                        *
*         2 LIST1 CHAR(15);              /* NON ZERO ITEMS            *
*  DCL 1 REP0T81 CHAR(82),               /* REPLY AREA                *
*         2 REP0T79 CHAR(80),            /* REPLY AREA START          *
*           3 * CHAR(1) INIT(' '),       /* NA                        *
*           3 RBUF CHAR(80),             /* REPLY BUFFER              *
*           3 * CHAR(1) INIT(' ');       /* NA                        *
*  DCL 1 CHIND CHAR(1),                  /* CHARACTER INDICATOR       *
*         2 BLKBIT BIT(1),               /* BLANK                     *
*         2 EQDASCOM BIT(3),             /* EQUAL SIGN DASH COMMA     *
*           3 EQUBIT BIT(1),             /* EQUAL SIGN                *
*           3 DASCOM BIT(2),             /* DASH, COMMA               *
*             4 DASBIT BIT(1),           /* DASH                      *
*             4 COMBIT BIT(1),           /* COMMA                     *
*               9 * BIT(1);              /* NA                        *
*  DCL SBC CHAR(1);                      /* SAVE BUFFER CHAR          *
*  DCL ACEQSEL CHAR(23)                  /* CONSTANT                  *
*         INIT('ACTIVE EQUATES SELECTED'); /* TEXT                    *
*  DCL CESWTR CHAR(1) GENERATED;         /*                     XM3317*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWTR)),  /*                     XM3317*
*        3 RETAINAC BIT(1);              /* RETAIN ACTIVE FLAG  XM3317*
*  DCL CESWTR2 CHAR(1) GENERATED;        /*                     XM3317*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWTR2)), /* REI SWITCHES        XM3317*
*        3 * BIT(7),                     /*                     XM3317*
*        3 DPMSGREI BIT(1);              /* DATA PROT MSG       XM3317*
*  RESTRICT(2,3,4,5,6,7,8,9);            /* RESTRICT REGS             *
*  GEN(EJECT);
         EJECT
         DS    0H
*  IF RETAINAC='1'B THEN                 /* IS RETAIN ACTIVE    XM3317*
         TM    A00030,B'10000000'                                 0072
         BC    12,@9FF                                            0072
*    DPMSGREI='1'B;                      /* YES, NO REPLY FROM  XM3317*
         OI    A00031,B'00000001'                                 0073
*                                        /* REMOTE              XM3317*
*  R7=DEVTBPTR;                          /* 1ST WORK TABLE            *
@9FF     L     @7,DEVTBPTR                                        0074
*  R7=ADDR(NXTWK);                       /* 2ND WORK TABLE            *
         LA    @7,128(0,@7)                                       0075
*  ADRENT2=R7;                           /* STORE ADDRESS             *
         ST    @7,A00010                                          0076
*  R7=ADDR(NXTWK);                       /* 3RD WORK TABLE            *
         LA    @7,128(0,@7)                                       0077
*  ADRENT3=R7;                           /* STORE ADDRESS             *
         ST    @7,A00010+4                                        0078
*  RESTPTR=ROOTPTR+32;                   /* RESIDENT TABLE PTR        *
         LA    @F,32                                              0079
         A     @F,ROOTPTR                                         0079
         ST    @F,RESTPTR                                         0079
*  IF FSTEQU='0'B THEN                   /* IS THIS FIRST TIME  XM0095*
         TM    A00000,B'00000010'                                 0080
         BC    05,@9FE                                            0080
*    DO;                                 /* EQU ENTERED, YES    XM0095*
*      FSTEQU='1'B;                      /* SET NOT FIRST TIME  XM0095*
         OI    A00000,B'00000010'                                 0082
*      R4=IFD373;                        /* SET MSG IFD373I FOR XM0095*
         L     @4,A00004+20                                       0083
*      GEN(BAL   R9,CDS140);             /* WARNING MESSAGE     XM0095*
         BAL   R9,CDS140
         DS    0H
*    END;                                /* NO                  XM0095*
* CDS010:                                /* LABEL                     *
*  GEN(BAL   R9,CDS212);                 /* ZERO WORK TABLES          *
@9FE     EQU   *                                                  0086
CDS010   BAL   R9,CDS212
         DS    0H
*  R4=DEVTBPTR;                          /* WORK AREA ADDRESS         *
         L     @4,DEVTBPTR                                        0087
*  R4->FSTENT3(1:64)=RESTAB;             /* SAVE RESIDENT TABLE       *
         L     @C,RESTPTR                                         0088
         MVC   256(64,@4),0(@C)                                   0088
*  R4=IFD394;                            /* REPLY EQU, CLR OR END     *
         L     @4,A00004                                          0089
*  GEN(BAL   R9,CDS170);                 /* ISSUE WTOR                *
         BAL   R9,CDS170
         DS    0H
* CDS022:                                /* LABEL                     *
*  DO R3=80 TO 1 BY -1;                  /* SCAN REPLY BUFFER         *
CDS022   LA    @3,80                                              0091
*    IF RBUF(R3)^=' ' THEN               /* TEST FOR END REPLY        *
@DO9FD   LR    @C,@3                                              0092
         LA    @A,REP0T81(@C)                                     0092
         CLI   0(@A),C' '                                         0092
*      GOTO CDS023;                      /* LAST NON-BLANK            *
         BC    07,CDS023                                          0093
*  END;                                  /* END SCANNING              *
* CDS023:                                /* LABEL                     *
*  R3=R3+1;                              /* LAST SLASH ITEM           *
         BCT   @3,@DO9FD                                          0094
CDS023   AH    @3,@D1                                             0095
*  RBUF(R3)='/';                         /* END OF LAST ENTRY         *
         LR    @C,@3                                              0096
         LA    @A,REP0T81(@C)                                     0096
         MVI   0(@A),C'/'                                         0096
*  LSTSLH=R3;                            /* LAST SLASH                *
         ST    @3,LSTSLH                                          0097
* CDS028:                                /* LABEL                     *
*  L=1;                                  /* 1ST REPLY ITEM            *
CDS028   LA    @F,1                                               0098
         ST    @F,L                                               0098
*  GOTO CDS034;                          /* CHECK 1ST ENTRY           *
         BC    15,CDS034                                          0099
* CDS030:                                /* LABEL                     *
*  GEN(BAL   R9,CDS210);                 /* ZERO TABLE                *
CDS030   BAL   R9,CDS210
         DS    0H
* CDS031:                                /* LABEL                     *
*  GEN(BAL   R9,CDS216);                 /* ZERO WORK TABLES          *
CDS031   BAL   R9,CDS216
         DS    0H
*  GEN(BAL   R9,CDS160);                 /* WORK TO RESIDENT          *
         BAL   R9,CDS160
         DS    0H
* CDS032:                                /* LABEL                     *
*  L=H+2;                                /* START OF ENTRY            *
CDS032   LA    @F,2                                               0103
         A     @F,H                                               0103
         ST    @F,L                                               0103
* CDS034:                                /* LABEL                     *
*  CHIND='00'X;                          /* CLEAR INDICATORS          *
CDS034   MVI   CHIND,X'00'                                        0104
*  H=0;                                  /* END OF ENTRY              *
         SR    @F,@F                                              0105
         ST    @F,H                                               0105
*  DO R3=L TO LSTSLH BY 1;               /* SEARCH ENTRY              *
         L     @3,L                                               0106
         BC    15,@DO9F8                                          0106
*    IF RBUF(R3)=' ' THEN                /* TEST FOR BLANK            *
@DO9F9   LR    @C,@3                                              0107
         LA    @A,REP0T81(@C)                                     0107
         CLI   0(@A),C' '                                         0107
         BC    07,@9F5                                            0107
*      BLKBIT='1'B;                      /* BLANK FOUND               *
         OI    CHIND,B'10000000'                                  0108
*    IF RBUF(R3)='/' THEN                /* TEST FOR SLASH            *
@9F5     LA    @A,REP0T81(@C)                                     0109
         CLI   0(@A),C'/'                                         0109
*      GOTO CDS040;                      /* END OF ENTRY              *
         BC    08,CDS040                                          0110
*    H=R3;                               /* LAST ENTRY                *
         ST    @3,H                                               0111
*  END;                                  /* END ENTRY SEARCH          *
*  GOTO CDS010;                          /* END OF REPLY              *
         AH    @3,@D1                                             0112
@DO9F8   C     @3,LSTSLH                                          0112
         BC    12,@DO9F9                                          0112
         BC    15,CDS010                                          0113
* CDS040:                                /* LABEL                     *
*  IF H=0 THEN                           /* CHECK ENTRY               *
CDS040   SR    @F,@F                                              0114
         C     @F,H                                               0114
         BC    07,@9F4                                            0114
*    DO;                                 /* NO ENTRY ITEM             *
* CDS042:                                /* LABEL                     *
*      L=ADDR(INCR3);                    /* START OF NEXT ENTRY       *
CDS042   LA    @F,1(0,@3)                                         0116
         ST    @F,L                                               0116
*      GOTO CDS034;                      /* SCAN ENTRY                *
         BC    15,CDS034                                          0117
*    END;                                /* END ENTRY CHECK           *
*  IF RBUF(L:L+3)=KCLRSL THEN            /* CHECK REPLY               *
@9F4     L     @C,L                                               0119
         LA    @A,REP0T81(@C)                                     0119
         CLC   0(4,@A),KCLRSL                                     0119
*    GOTO CDS030;                        /* CLEAR RESIDENT TABLE      *
         BC    08,CDS030                                          0120
*  IF RBUF(L:L+3)=KENDSL THEN            /* CHECK REPLY               *
         CLC   0(4,@A),KENDSL                                     0121
*    GOTO CDS180;                        /* END ENTRIES               *
         BC    08,CDS180                                          0122
*  IF BLKBIT='1'B THEN                   /* CHECK INDICATOR           *
         TM    CHIND,B'10000000'                                  0123
*    GOTO CDS130;                        /* ENBEDDED BLANK            *
         BC    01,CDS130                                          0124
*  R5=ADRENT3;                           /* END 2ND WORK TABLE        *
         L     @5,A00010+4                                        0125
*  GEN(BAL   R6,CDS066);                 /* SET UP WORK TABLE         *
         BAL   R6,CDS066
         DS    0H
*  DO R3=H TO L BY -1;                   /* SCAN ENTRY                *
         L     @3,H                                               0127
         BC    15,@DO9F2                                          0127
*    SBC=RBUF(R3);                       /* SAVE BUFFER CHAR          *
@DO9F3   LR    @C,@3                                              0128
         LA    @E,REP0T81(@C)                                     0128
         MVC   SBC(1),0(@E)                                       0128
*    DO R6=16 TO 1 BY -1;                /* SCAN EBCDIC LIST          *
         LA    @6,16                                              0129
*      IF SBC=LIST(R6) THEN              /* CHECK ENTRY ITEM          *
@DO9EF   LR    @C,@6                                              0130
         LA    @E,LIST-1(@C)                                      0130
         CLC   SBC(1),0(@E)                                       0130
         BC    07,@9EB                                            0130
*        DO;                             /* ITEM IN LIST              *
*          IF R4=0 THEN                  /* TEST DEVICE ADDRESS       *
         LTR   @4,@4                                              0132
*            GOTO CDS130;                /* TOO MANY CHARACTERS       *
         BC    08,CDS130                                          0133
*          SBUF(R4)=SBC;                 /* SAVE ITEM                 *
         LR    @C,@4                                              0134
         LA    @A,0(@C,@5)                                        0134
         BCTR  @A,0                                               0134
         MVC   0(1,@A),SBC                                        0134
*          R4=R4-1;                      /* COUNT OF ITEMS            *
         BCTR  @4,0                                               0135
*          GOTO CDS068;                  /* TEST NEXT ITEM            *
         BC    15,CDS068                                          0136
*        END;                            /* END SAVING ITEM           *
*    END;                                /* END SCANNING LIST         *
*    IF SBUF(2)='00'X THEN               /* TEST DEVICE ADDRESS       *
@9EB     BCT   @6,@DO9EF                                          0138
         CLI   1(@5),X'00'                                        0139
*      GOTO CDS130;                      /* TOO FEW CHARACTERS        *
         BC    08,CDS130                                          0140
*    IF SBC='=' THEN                     /* CHECK ENTRY ITEM          *
         CLI   SBC,C'='                                           0141
         BC    07,@9EA                                            0141
*      DO;                               /* SPECIAL CHARACTER         *
*        IF EQDASCOM^='000'B THEN        /* TEST FOR SPECIALS         *
         TM    CHIND,B'01110000'                                  0143
*          GOTO CDS130;                  /* NOT FIRST SPECIAL         *
         BC    05,CDS130                                          0144
*        EQUBIT='1'B;                    /* INDICATE EQUAL SIGN       *
         OI    CHIND,B'01000000'                                  0145
*        GOTO CDS064;                    /* NEXT DEVICE               *
         BC    15,CDS064                                          0146
*      END;                              /* END EQUAL SIGN TEST       *
*    IF EQUBIT='0'B THEN                 /* TEST INDICATOR            *
@9EA     TM    CHIND,B'01000000'                                  0148
*      GOTO CDS130;                      /* NO EQUAL SIGN             *
         BC    08,CDS130                                          0149
*    IF SBC='-' THEN                     /* CHECK ENTRY ITEM          *
         CLI   SBC,C'-'                                           0150
         BC    07,@9E9                                            0150
*      DO;                               /* DASH FOUND                *
*        IF DASCOM^='00'B THEN           /* TEST INDICATORS           *
         TM    CHIND,B'00110000'                                  0152
*          GOTO CDS130;                  /* PREVIOUS DASH/COMMA       *
         BC    05,CDS130                                          0153
*        DASBIT='1'B;                    /* INDICATE DASH             *
         OI    CHIND,B'00100000'                                  0154
*        GOTO CDS064;                    /* NEXT DEVICE               *
         BC    15,CDS064                                          0155
*      END;                              /* END DASH TEST             *
*    IF SBC^=',' THEN                    /* CHECK ENTRY ITEM          *
@9E9     CLI   SBC,C','                                           0157
*      GOTO CDS130;                      /* COMMA NOT FOUND           *
         BC    07,CDS130                                          0158
*    COMBIT='1'B;                        /* INDICATE COMMA            *
         OI    CHIND,B'00010000'                                  0159
*    IF DASBIT='1'B THEN                 /* TEST INDICATOR            *
         TM    CHIND,B'00100000'                                  0160
*      GOTO CDS130;                      /* PREVIOUS DASH             *
         BC    01,CDS130                                          0161
* CDS064:                                /* LABEL                     *
*    R6=ADDR(CDS068);                    /* RESUME ADDRESS            *
CDS064   LA    @6,CDS068                                          0162
* CDS066:                                /* LABEL                     *
*    R4=4;                               /* MAXIMUM DEVICE ITEM       *
CDS066   LA    @4,4                                               0163
*    R5=R5-R4;                           /* NEXT SAVE WORD            *
         SR    @5,@4                                              0164
*    SBUF(1)='0';                        /* SET UP WORD               *
         MVI   0(@5),C'0'                                         0165
*    GOTO R6;                            /* RESUME                    *
         BCR   15,@6                                              0166
* CDS068:                                /* LABEL                     *
*  END;                                  /* END SCANNING ENTRY        *
*  IF EQUBIT='0'B THEN                   /* TEST INDICATOR            *
CDS068   BCTR  @3,0                                               0167
@DO9F2   C     @3,L                                               0167
         BC    10,@DO9F3                                          0167
         TM    CHIND,B'01000000'                                  0168
*    GOTO CDS130;                        /* NO EQUAL SIGN             *
         BC    08,CDS130                                          0169
*  IF SBUF(2)='00'X THEN                 /* TEST DEVICE ADDRESS       *
         CLI   1(@5),X'00'                                        0170
*    GOTO CDS130;                        /* TOO FEW CHARACTERS        *
         BC    08,CDS130                                          0171
*  R7=ADRENT3;                           /* END 2ND WORK TABLE        *
         L     @7,A00010+4                                        0172
*  IF DASBIT='0'B THEN                   /* TEST INDICATOR            *
         TM    CHIND,B'00100000'                                  0173
*    GOTO CDS080;                        /* NO DASH BIT               *
         BC    08,CDS080                                          0174
*  R5=12;                                /* BYTES TO CONVERT          *
         LA    @5,12                                              0175
*  R7=R7-R5;                             /* CONTAIN EBCDIC            *
         SR    @7,@5                                              0176
*  GEN(BAL   R9,CDS120);                 /* EBCDIC TO HEX             *
         BAL   R9,CDS120
         DS    0H
* CDS069:                                /* LABEL                     *
*  R3=DEVTBPTR;                          /* 1ST WORK AREA             *
CDS069   L     @3,DEVTBPTR                                        0178
*  R5=FSTD;                              /* 1ST DEVICE                *
         LH    @5,0(0,@3)                                         0179
*  R4=SECD;                              /* 2ND DEVICE                *
         LH    @4,2(0,@3)                                         0180
*  R6=R4-R5;                             /* DEVICE RANGE              *
         LCR   @6,@5                                              0181
         AR    @6,@4                                              0181
*  IF R6<0 THEN                          /* CHECK SEQUENCE            *
         LTR   @6,@6                                              0182
*    GOTO CDS130;                        /* DECREASING ORDER          *
         BC    04,CDS130                                          0183
*  IF R6^<16 THEN                        /* CHECK DEVICES             *
         CH    @6,@D2                                             0184
*    GOTO CDS130;                        /* EXCEEDS MAX DEVICES       *
         BC    10,CDS130                                          0185
         BC    15,@DO9E7                                          0186
*  DO R5=R5 TO R4 BY 1;                  /* DEVICE RANGE              *
@DO9E8   EQU   *                                                  0186
*    GEN(STH   R5,0(R7));                /* REAL DEVICE               *
         STH   R5,0(R7)
         DS    0H
*    DEVLK2=THIDK;                       /* CDS DEVICE                *
         MVC   2(2,@7),THIDK                                      0188
*    R7=ADDR(NXTLK);                     /* NEXT EQUATE               *
         LA    @7,4(0,@7)                                         0189
*  END;                                  /* END DEVICE RANGE          *
*  GOTO CDS070;                          /* CHECK RESIDENT AREA       *
         AH    @5,@D1                                             0190
@DO9E7   CR    @5,@4                                              0190
         BC    12,@DO9E8                                          0190
* CDS070:                                /* LABEL                     *
*  R7=ADRENT2;                           /* NEW ENTRIES IN HEX        *
CDS070   L     @7,A00010                                          0192
* CDS072:                                /* LABEL                     *
*  R8=ADRENT3;                           /* RESIDENT AREA SAVED       *
CDS072   L     @8,A00010+4                                        0193
*  IF DEVLK=KZIP4 THEN                   /* CHECK NEW ENTRY           *
         CLC   0(4,@7),A00009                                     0194
*    GOTO CDS031;                        /* NO MORE ENTRIES           *
         BC    08,CDS031                                          0195
*  R5=0;                                 /* NO RESIDENT ADDRESS       *
         SR    @5,@5                                              0196
*  DO R3=16 TO 1 BY -1;                  /* RESIDENT ENTRIES          *
         LA    @3,16                                              0197
*    IF DEV1=DEVLK1 THEN                 /* CHECK REAL DEVICE         *
@DO9E4   CLC   0(2,@8),0(@7)                                      0198
*      GOTO CDS074;                      /* ITS IN RESIDENT AREA      *
         BC    08,CDS074                                          0199
*    IF DEVCOP=KZIP4&                    /* RESIDENT AREA UNUSED      *
*      R5=0 THEN                         /* NO PREVIOUS AREA          *
         CLC   0(4,@8),A00009                                     0200
         BC    07,@9E0                                            0200
         LTR   @5,@5                                              0200
         BC    07,@9DF                                            0200
*        R5=R8;                          /* SAVE OPEN AREA            *
         LR    @5,@8                                              0201
*    R8=ADDR(NXTENT);                    /* NEXT RESIDENT ITEM        *
@9DF     EQU   *                                                  0202
@9E0     LA    @8,4(0,@8)                                         0202
*  END;                                  /* END RESIDENT PASS         *
*  R8=R5;                                /* LOAD ADDRESS              *
         BCT   @3,@DO9E4                                          0203
         LR    @8,@5                                              0204
*  IF R8=0 THEN                          /* CHECK VALUE               *
         LTR   @8,@8                                              0205
*    GOTO CDS176;                        /* RESIDENT TABLE FULL       *
         BC    08,CDS176                                          0206
* CDS074:                                /* LABEL                     *
*  IF DEVLK1=DEVLK2 THEN                 /* CHECK DEVICE              *
CDS074   CLC   0(2,@7),2(@7)                                      0207
         BC    07,@9DE                                            0207
*    DEVLK=DEVLK&&DEVLK;                 /* DEVICES THE SAME          *
         XC    0(4,@7),0(@7)                                      0208
*  DEVCOP=DEVLK;                         /* UPDATE RESIDENT AREA      *
@9DE     MVC   0(4,@8),0(@7)                                      0209
*  R7=ADDR(NXTLK);                       /* NEXT ENTRY                *
         LA    @7,4(0,@7)                                         0210
*  GOTO CDS072;                          /* REPEAT SEARCH             *
         BC    15,CDS072                                          0211
* CDS080:                                /* LABEL                     *
*  R5=0;                                 /* ZERO BYTE COUNT           *
CDS080   SR    @5,@5                                              0212
* CDS082:                                /* LABEL                     *
*  R7=R7-4;                              /* NEXT DEVICE ENTRY         *
CDS082   SH    @7,@D3                                             0213
*  IF R7P1='00'X THEN                    /* CHECK ENTRY               *
         CLI   1(@7),X'00'                                        0214
*    GOTO CDS084;                        /* NO MORE ENTRIES           *
         BC    08,CDS084                                          0215
*  R5=R5+4;                              /* BYTES TO CONVERT          *
         AH    @5,@D3                                             0216
*  GOTO CDS082;                          /* SEARCH FOR ENTRY          *
         BC    15,CDS082                                          0217
* CDS084:                                /* LABEL                     *
*  R7=R7+4;                              /* 1ST ENTRY IN EBCDIC       *
CDS084   AH    @7,@D3                                             0218
*  GEN(BAL   R9,CDS120);                 /* EBCDIC TO HEX             *
         BAL   R9,CDS120
         DS    0H
*  R8=DEVTBPTR;                          /* 1ST WORK TABLE            *
         L     @8,DEVTBPTR                                        0220
* CDS086:                                /* LABEL                     *
*  IF DEV1=KZIP2 THEN                    /* CHECK NEW ENTRY           *
CDS086   CLC   0(2,@8),A00009                                     0221
*    GOTO CDS070;                        /* NO ENTRY LEFT             *
         BC    08,CDS070                                          0222
*  DEVLK1=DEV1;                          /* REAL DEVICE EQUATED       *
         MVC   0(2,@7),0(@8)                                      0223
*  DEVLK2=THIDK;                         /* CDS DEVICE EQUATE         *
         MVC   2(2,@7),THIDK                                      0224
*  R8=ADDR(DEV2);                        /* NEXT DEVICE               *
         LA    @8,2(0,@8)                                         0225
*  R7=ADDR(NXTLK);                       /* NEXT EQUATE               *
         LA    @7,4(0,@7)                                         0226
*  GOTO CDS086;                          /* CHECK                     *
         BC    15,CDS086                                          0227
*  GEN(EJECT);
         EJECT
         DS    0H
* /********************************************************************
* /* HEX TO EBCDIC CONVERSION                                         *
* /********************************************************************
* CDS110:                                /* LABEL                     *
*  DO R6=16 TO 1 BY -1;                  /* SCAN TABLE ENTRIES        *
CDS110   LA    @6,16                                              0229
*    R5=HEXWD;                           /* WORD TO CONVERT           *
@DO9DD   L     @5,0(0,@7)                                         0230
*    IF R5=0 THEN                        /* CHECK WORD                *
         LTR   @5,@5                                              0231
*      GOTO R9;                          /* NO ENTRY                  *
         BCR   08,@9                                              0232
*    DO R3=8 TO 1 BY -1;                 /* HEX IN WORD               *
         LA    @3,8                                               0233
*      R4=0;                             /* ZERO WORK REG             *
@DO9D9   SR    @4,@4                                              0234
*      GEN(SLDL  R4,4);                  /* LOAD HEX CHARACTER        *
         SLDL  R4,4
         DS    0H
*      GEN(IC    R4,LIST(R4));           /* HEX VALUE IN EBCDIC       *
         IC    R4,LIST(R4)
         DS    0H
*      GEN(STC   R4,0(R8));              /* STORE EBCDIC VALUE        *
         STC   R4,0(R8)
         DS    0H
*      R8=R8+1;                          /* NEXT STORAGE AREA         *
         AH    @8,@D1                                             0238
*    END;                                /* END HEX IN WORD           *
*    R7=ADDR(NXTLK);                     /* NEXT WORD                 *
         BCT   @3,@DO9D9                                          0239
         LA    @7,4(0,@7)                                         0240
*  END;                                  /* END TABLE SCANNING        *
*  GOTO R9;                              /* RETURN TO MAIN FLOW       *
         BCT   @6,@DO9DD                                          0241
         BCR   15,@9                                              0242
* /********************************************************************
* /* EBCDIC TO HEX CONVERTION                                         *
* /********************************************************************
* CDS120:                                /* LABEL                     *
*  R3=DEVTBPTR;                          /* 1ST WORK TABLE            *
CDS120   L     @3,DEVTBPTR                                        0243
*  DO R5=R5/2 TO 1 BY -1;                /* BYTES TO CONVERT          *
         LR    @F,@5                                              0244
         SRA   @F,1                                               0244
         LTR   @5,@F                                              0244
         BC    12,@DO9D4                                          0244
*    R4=0;                               /* ZERO HEX VALUE            *
@DO9D5   SR    @4,@4                                              0245
*    DO R6=15 TO 1 BY -1;                /* CONVERSION LIST           *
         LA    @6,15                                              0246
*      IF TB2=LIST1(R6) THEN             /* CHECK ODD BYTE            *
@DO9D1   LR    @C,@6                                              0247
         LA    @E,LIST(@C)                                        0247
         CLC   0(1,@7),0(@E)                                      0247
         BC    07,@9CD                                            0247
*        R4=R4×R6*16;                    /* HEX VALUE FOUND           *
         LR    @F,@6                                              0248
         SLA   @F,4                                               0248
         OR    @4,@F                                              0248
*      IF TB2A=LIST1(R6) THEN            /* CHECK EVEN BYTE           *
@9CD     LA    @E,LIST(@C)                                        0249
         CLC   1(1,@7),0(@E)                                      0249
         BC    07,@9CC                                            0249
*        R4=R4×R6;                       /* HEX VALUE FOUND           *
         OR    @4,@6                                              0250
*    END;                                /* END CONVERSION LIST       *
*    GEN(STC   R4,0(R3));                /* STORE HEX VALUE           *
@9CC     BCT   @6,@DO9D1                                          0251
         STC   R4,0(R3)
         DS    0H
*    R3=ADDR(RES2);                      /* NEXT HEX STORE AREA       *
         LA    @3,1(0,@3)                                         0253
*    R7=ADDR(NXTTB);                     /* NEXT EBCDIC ITEM          *
         LA    @7,2(0,@7)                                         0254
*  END;                                  /* END CONVERSION            *
*  R3=R3-2;                              /* LAST HEX AREA             *
         BCT   @5,@DO9D5                                          0255
@DO9D4   SH    @3,@D4                                             0256
*  THIDK=RESLST;                         /* LAST HEX DEVICE           *
         MVC   THIDK(2),0(@3)                                     0257
*  RESLST=RESLST&&RESLST;                /* ZERO OUT DEVICE           *
         XC    0(2,@3),0(@3)                                      0258
*  R7=ADRENT2;                           /* TO HOLD HEX EQUATES       *
         L     @7,A00010                                          0259
*  ZIPENT2=ZIPENT2&&ZIPENT2;             /* ZERO TABLE OUT            *
         XC    0(128,@7),0(@7)                                    0260
*  GOTO R9;                              /* RETURN TO MAIN FLOW       *
         BCR   15,@9                                              0261
*  GEN(EJECT);
         EJECT
         DS    0H
* /********************************************************************
* /* INVALID ENTRY MESSAGE                                            *
* /********************************************************************
* CDS130:                                /* LABEL                     *
*  R4=IFD397;                            /* WTO ADDRESS               *
CDS130   L     @4,A00004+12                                       0263
*  R3=H-L+27;                            /* VARIABLE REPLY SIZE
         LA    @3,27                                              0264
         S     @3,L                                               0264
         A     @3,H                                               0264
*  IF R3>74 THEN                         /* CHECK REPLY SIZE
         CH    @3,@D5                                             0265
         BC    12,@9CB                                            0265
*    R3=74;                              /* MAX SIZE
         LA    @3,74                                              0266
*  INVR(1:48)=RBUF(L:L+47);              /* INVALID REPLY TEXT
@9CB     L     @C,L                                               0267
         LA    @E,REP0T81(@C)                                     0267
         MVC   26(48,@4),0(@E)                                    0267
*  GEN(STC   R3,1(R4));                  /* MESSAGE SIZE TO WTO       *
         STC   R3,1(R4)
         DS    0H
*  R3=R3+R4;                             /* END OF MESSAGE
         AR    @3,@4                                              0269
*  SETCODS=RTDESC;                       /* ROUTCDE, DESC CODES
         MVC   0(4,@3),78(@4)                                     0270
*  GEN(BAL   R9,CDS140);                 /* ISSUE WTO                 *
         BAL   R9,CDS140
         DS    0H
*  GOTO CDS010;                          /* REQUEST ENTRY             *
         BC    15,CDS010                                          0272
* CDS140:                                /* LABEL                     *
*  R1=R4;                                /* WTO ADDRESS               *
CDS140   LR    @1,@4                                              0273
*  GEN(PWTO  REG=(1));                   /* ISSUE WTO                 *
         PWTO  REG=(1)
         DS    0H
*  GOTO R9;                              /* RETURN TO MAIN FLOW       *
         BCR   15,@9                                              0275
* CDS160:                                /* LABEL                     *
*  R7=RESTPTR;                           /* RESIDENT TABLE            *
CDS160   L     @7,RESTPTR                                         0276
*  R7->RESTAB=R7->RESTAB&&R7->RESTAB;    /* ZERO RESIDENT TABLE       *
         XC    0(64,@7),0(@7)                                     0277
*  R8=ADRENT3;                           /* RESIDENT AREA SAVED       *
         L     @8,A00010+4                                        0278
*  DO R4=16 TO 1 BY -1;                  /* ITEMS TO CHECK            *
         LA    @4,16                                              0279
*    IF DEV1=KZIP2 THEN                  /* CHECK DEVICE ENTRY        *
@DO9CA   CLC   0(2,@8),A00009                                     0280
*     GOTO CDS162;                       /* NO ENTRY                  *
         BC    08,CDS162                                          0281
*    DEVLK=DEVCOP;                       /* ENTRY TO RESIDENT         *
         MVC   0(4,@7),0(@8)                                      0282
*    R7=ADDR(NXTLK);                     /* NEXT RESIDENT AREA        *
         LA    @7,4(0,@7)                                         0283
* CDS162:                                /* LABEL                     *
*    R8=ADDR(NXTENT);                    /* NEXT ITEM TO CHECK        *
CDS162   LA    @8,4(0,@8)                                         0284
*  END;                                  /* END ITEM CHECKING         *
*  GOTO R9;                              /* RETURN TO MAIN FLOW       *
         BCT   @4,@DO9CA                                          0285
         BCR   15,@9                                              0286
* CDS210:                                /* LABEL                     *
*  RESTAB=RESTAB&&RESTAB;                /* ZERO RESIDENT TABLE       *
CDS210   L     @C,RESTPTR                                         0287
         XC    0(64,@C),0(@C)                                     0287
* CDS212:                                /* LABEL                     *
*  FSTENT3=FSTENT3&&FSTENT3;             /* ZERO WORK TABLE           *
CDS212   L     @C,DEVTBPTR                                        0288
         XC    256(128,@C),256(@C)                                0288
* CDS216:                                /* LABEL                     *
*  FSTENT12=FSTENT12&&FSTENT12;          /* ZERO WORK AREA            *
CDS216   L     @C,DEVTBPTR                                        0289
         XC    0(256,@C),0(@C)                                    0289
*  GOTO R9;                              /* RETURN TO MAIN FLOW       *
         BCR   15,@9                                              0290
*  GEN(EJECT);
         EJECT
         DS    0H
* /********************************************************************
* /* ENTER DEV EQUATES/END/CLR                                        *
* /********************************************************************
* CDS170:                                /* LABEL                     *
*  EQUECB=0;                             /* ZERO OUT ECB              *
CDS170   SR    @F,@F                                              0292
         ST    @F,EQUECB                                          0292
*  RBUF=REP0T79;                         /* CLEAR REPLY BUFFER        *
         MVC   REP0T81+1(80),REP0T81                              0293
*  R1=R4;                                /* WTOR ADDRESS              *
         LR    @1,@4                                              0294
*  WTORADRS(2:8)=SETWTOR(2:8);           /* UPDATE WTOR               *
         MVC   1(7,@4),SETWTOR+1                                  0295
*  GEN(PWTOR  REG=(1));                  /* ISSUE WTOR ADDRESSES      *
         PWTOR  REG=(1)
         DS    0H
*  GOTO R9;                              /* RETURN TO MAIN FLOW       *
         BCR   15,@9                                              0297
* CDS176:                                /* LABEL                     *
*  R4=IFD398;                            /* EXCEEDS MAXIMUM           *
CDS176   L     @4,A00004+16                                       0298
*  GEN(BAL   R9,CDS140);                 /* ISSUE WTO                 *
         BAL   R9,CDS140
         DS    0H
*  GEN(BAL   R9,CDS216);                 /* ZERO WORK TABLES          *
         BAL   R9,CDS216
         DS    0H
*  GEN(BAL   R9,CDS160);                 /* WORK TO RESIDENT          *
         BAL   R9,CDS160
         DS    0H
*  GOTO CDS180;                          /* OUTPUT EQUATES            *
* /********************************************************************
* /* WORK TABLE TO RESIDENT TABLE                                     *
* /********************************************************************
* CDS180:                                /* LABEL                     *
*  R8=DEVTBPTR;                          /* 1ST WORK TABLE            *
CDS180   L     @8,DEVTBPTR                                        0303
*  R7=RESTPTR;                           /* RESIDENT TABLE PTR        *
         L     @7,RESTPTR                                         0304
*  GEN(BAL   R9,CDS110);                 /* HEX TO EBCDIC             *
         BAL   R9,CDS110
         DS    0H
*  R4=IFD395;                            /* MESSAGE ADDRESS           *
         L     @4,A00004+4                                        0306
*  MSG395=ACEQSEL;                       /* EQUATES SELECTED          *
         MVC   12(23,@4),ACEQSEL                                  0307
*  GEN(BAL   R9,CDS140);                 /* ISSUE WTO                 *
         BAL   R9,CDS140
         DS    0H
* CDS181:                                /* LABEL                     *
*  MSG395=MSG3951;                       /* BLANK VARIABLES           *
CDS181   MVC   12(23,@4),11(@4)                                   0309
*  RESENTB='1'B;                         /* RESIDENT ENTRIES          *
         OI    A00000,B'01000000'                                 0310
*  R8=DEVTBPTR;                          /* 1ST WORK TABLE            *
         L     @8,DEVTBPTR                                        0311
*  IF ABYT='00'X THEN                    /* CHECK 1ST ENTRY           *
         CLI   0(@8),X'00'                                        0312
         BC    07,@9C6                                            0312
*    DO;                                 /* NO DEVICE EQUATES         *
*      RESENTB='0'B;                     /* NO RESIDENT ENTRIES       *
         NI    A00000,B'10111111'                                 0314
*      MSG395(1:4)=KNONE;                /* INDICATE SUCH             *
         MVC   12(4,@4),KNONE                                     0315
*      GEN(BAL   R9,CDS140);             /* ISSUE WTO                 *
         BAL   R9,CDS140
         DS    0H
*    END;                                /* END ENTRY CHECK           *
*  DO R6=16 TO 1 BY -1;                  /* RESIDENT ENTRIES          *
@9C6     LA    @6,16                                              0318
*    IF ABYT='00'X THEN                  /* CHECK ENTRY               *
@DO9C5   CLI   0(@8),X'00'                                        0319
*      GOTO CDS184;                      /* NO DEVICE                 *
         BC    08,CDS184                                          0320
*    MSG395(1:4)=PDEV1;                  /* REAL DEVICE               *
         MVC   12(4,@4),0(@8)                                     0321
*    MSG395(5)='=';                      /* EQUAL SIGN                *
         MVI   16(@4),C'='                                        0322
*    MSG395(6:9)=PDEV2;                  /* CDS EQUATE                *
         MVC   17(4,@4),4(@8)                                     0323
*    GEN(BAL   R9,CDS140);               /* ISSUE WTO                 *
         BAL   R9,CDS140
         DS    0H
*    R8=ADDR(PDEVNXT);                   /* NEXT EQUATE               *
         LA    @8,8(0,@8)                                         0325
*  END;                                  /* END ENTRY CHECK           *
* CDS184:                                /* LABEL                     *
*  GOTO CDS192;                          /* VERIFY EQUATES            *
         BCT   @6,@DO9C5                                          0326
* CDS192:                                /* LABEL                     *
*  R4=IFD396;                            /* VERIFICATION              *
CDS192   L     @4,A00004+8                                        0328
*  GEN(BAL   R9,CDS170);                 /* ISSUE WTOR                *
         BAL   R9,CDS170
         DS    0H
*  IF RBUF(1:3)=KNO THEN                 /* CHECK REPLY               *
         CLC   REP0T81+1(3),KNO                                   0330
*    GOTO CDS010;                        /* NO REPLIED                *
         BC    08,CDS010                                          0331
*  IF RBUF(1:3)^=KYES THEN               /* CHECK REPLY               *
         CLC   REP0T81+1(3),KYES                                  0332
*    GOTO CDS192;                        /* NOT YES                   *
         BC    07,CDS192                                          0333
*  GEN(BAL   R9,CDS212);                 /* ZERO WORK TABLES          *
         BAL   R9,CDS212
         DS    0H
*  DPMSGREI='0'B;                        /* ZERO DP MSG REI     XM3317*
         NI    A00031,B'11111110'                                 0335
*  RETURN;                               /* RETURN TO CALLER          *
* END IFDOLT49;
@EL01    L     @D,4(0,@D)                                         0337
         LM    @E,@C,12(@D)                                       0337
         BCR   15,@E                                              0337
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D1      DC    H'1'
@D2      DC    H'16'
@D3      DC    H'4'
@D4      DC    H'2'
@D5      DC    H'74'
         DS    0F
         DS    0D
@DATA    EQU   *
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD
X        EQU   00000000            FULLWORD INTEGER
R0       EQU   00000000            FULLWORD POINTER REGISTER
R1       EQU   00000001            FULLWORD POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD POINTER REGISTER
R4       EQU   00000004            FULLWORD POINTER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
R6       EQU   00000006            FULLWORD POINTER REGISTER
R7       EQU   00000007            FULLWORD POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
R9       EQU   00000009            FULLWORD POINTER REGISTER
R10      EQU   00000010            FULLWORD POINTER REGISTER
R11      EQU   00000011            FULLWORD POINTER REGISTER
R12      EQU   00000012            FULLWORD POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
R15      EQU   00000015            FULLWORD POINTER REGISTER
EQUECB   EQU   @DATA+00000072      FULLWORD INTEGER
LSTSLH   EQU   @DATA+00000076      FULLWORD INTEGER
L        EQU   @DATA+00000080      FULLWORD INTEGER
H        EQU   @DATA+00000084      FULLWORD INTEGER
RESTPTR  EQU   @DATA+00000088      FULLWORD POINTER
A00006   EQU   00000000            64 BYTE(S) ON WORD
RESTAB   EQU   A00006+00000000     64 BYTE(S)
SETWTOR  EQU   @DATA+00000092      8 BYTE(S) ON WORD
         ORG   SETWTOR+00000000
A00007   EQU   *                   FULLWORD POINTER
         DC    AL4(RBUF)
A00008   EQU   *                   FULLWORD POINTER
         DC    AL4(EQUECB)
A00009   EQU   *                   FULLWORD INTEGER
         DC    FL4'0'
KZIP4    EQU   A00009+00000000     4 BYTE(S)
KZIP2    EQU   A00009+00000000     2 BYTE(S)
A00010   EQU   @DATA+00000104      8 BYTE(S) ON WORD
ADRENT2  EQU   A00010+00000000     FULLWORD POINTER
ADRENT3  EQU   A00010+00000004     FULLWORD POINTER
THIDK    EQU   @DATA+00000112      HALFWORD INTEGER
A00011   EQU   00000000            384 BYTE(S) ON WORD
FSTENT12 EQU   A00011+00000000     256 BYTE(S)
FSTENT1  EQU   A00011+00000000     128 BYTE(S)
FSTENT2  EQU   A00011+00000128     128 BYTE(S)
FSTENT3  EQU   A00011+00000256     128 BYTE(S)
ENDTABS  EQU   A00011+00000256     1 BYTE(S)
A00012   EQU   00000000            6 BYTE(S) ON WORD
FSTD     EQU   A00012+00000000     HALFWORD INTEGER
SECD     EQU   A00012+00000002     HALFWORD INTEGER
THID     EQU   A00012+00000004     HALFWORD INTEGER
A00013   EQU   00000000            2 BYTE(S) ON WORD
RESLST   EQU   A00013+00000000     2 BYTE(S)
RES1     EQU   A00013+00000000     1 BYTE(S)
RES2     EQU   A00013+00000001     1 BYTE(S)
INCR3    EQU   00000001            1 BYTE(S)
SETCODS  EQU   00000000            4 BYTE(S)
WTORADRS EQU   00000000            8 BYTE(S)
A00014   EQU   00000011            24 BYTE(S) ON WORD
MSG3951  EQU   A00014+00000000     23 BYTE(S)
A00015   EQU   A00014+00000000     1 BYTE(S)
MSG395   EQU   A00014+00000001     23 BYTE(S)
A00016   EQU   A00014+00000001     1 BYTE(S)
A00017   EQU   00000000            82 BYTE(S) ON WORD
A00018   EQU   A00017+00000000     26 BYTE(S)
A00019   EQU   A00017+00000000     1 BYTE(S)
MSGSZ    EQU   A00017+00000001     1 BYTE(S)
INVR     EQU   A00017+00000026     48 BYTE(S)
A00020   EQU   A00017+00000074     4 BYTE(S)
RTDESC   EQU   A00017+00000078     4 BYTE(S)
SBUF     EQU   00000000            4 BYTE(S)
A00021   EQU   SBUF+00000000       1 BYTE(S)
SBUF1    EQU   SBUF+00000001       3 BYTE(S)
HEXWD    EQU   00000000            FULLWORD INTEGER
ZIPENT2  EQU   00000000            128 BYTE(S)
A00022   EQU   00000000            8 BYTE(S) ON WORD
DEVLK    EQU   A00022+00000000     4 BYTE(S)
DEVLK1   EQU   A00022+00000000     2 BYTE(S)
DEVLK2   EQU   A00022+00000002     2 BYTE(S)
NXTLK    EQU   A00022+00000004     4 BYTE(S)
R7P1     EQU   00000001            1 BYTE(S)
A00023   EQU   00000000            3 BYTE(S) ON HWORD
TB2      EQU   A00023+00000000     1 BYTE(S)
TB2A     EQU   A00023+00000001     1 BYTE(S)
NXTTB    EQU   A00023+00000002     1 BYTE(S)
NXTWK    EQU   00000128            1 BYTE(S)
A00024   EQU   00000000            12 BYTE(S) ON WORD
DEVCOP   EQU   A00024+00000000     4 BYTE(S)
DEV1     EQU   A00024+00000000     2 BYTE(S)
DEV2     EQU   A00024+00000002     2 BYTE(S)
NXTENT   EQU   A00024+00000004     8 BYTE(S)
ABYT     EQU   00000000            1 BYTE(S)
A00025   EQU   00000000            12 BYTE(S) ON WORD
PDEV1    EQU   A00025+00000000     4 BYTE(S)
PDEV2    EQU   A00025+00000004     4 BYTE(S)
PDEVNXT  EQU   A00025+00000008     4 BYTE(S)
         ORG   @DATA+00000114
KCLRSL   EQU   *                   4 BYTE(S)
         DC    C'CLR/'
KENDSL   EQU   *                   4 BYTE(S)
         DC    C'END/'
KNONE    EQU   *                   4 BYTE(S)
         DC    C'NONE'
KYES     EQU   *                   3 BYTE(S)
         DC    C'YES'
KNO      EQU   *                   3 BYTE(S)
         DC    C'NO '
LIST     EQU   *                   16 BYTE(S)
         DC    C'0123456789ABCDEF'
A00026   EQU   LIST+00000000       1 BYTE(S)
LIST1    EQU   LIST+00000001       15 BYTE(S)
REP0T81  EQU   @DATA+00000148      82 BYTE(S)
REP0T79  EQU   REP0T81+00000000    80 BYTE(S)
A00027   EQU   *                   1 BYTE(S)
         DC    C' '
RBUF     EQU   REP0T81+00000001    80 BYTE(S)
         ORG   REP0T81+00000081
A00028   EQU   *                   1 BYTE(S)
         DC    C' '
CHIND    EQU   @DATA+00000230      1 BYTE(S)
BLKBIT   EQU   CHIND+00000000      1 BIT(S)
EQDASCOM EQU   CHIND+00000000      3 BIT(S)
EQUBIT   EQU   CHIND+00000000      1 BIT(S)
DASCOM   EQU   CHIND+00000000      2 BIT(S)
DASBIT   EQU   CHIND+00000000      1 BIT(S)
COMBIT   EQU   CHIND+00000000      1 BIT(S)
A00029   EQU   CHIND+00000000      1 BIT(S)
SBC      EQU   @DATA+00000231      1 BYTE(S)
         ORG   @DATA+00000232
ACEQSEL  EQU   *                   23 BYTE(S)
         DC    C'ACTIVE EQUATES SELECTED'
         ORG   @DATA
         DS    00000255C
@TEMPS   DS    0F
IFDMSG49 DS    0F
         DC    A(MSG1)
         DC    A(MSG2)
         DC    A(MSG3)
         DC    A(MSG4)
         DC    A(MSG5)
         DC    A(MSG6)                                           XM0095
MSG1     DS    0F
         DC    X'50'
         DC    XL7'00'
         WTO   'IFD394D ENTER DEV EQUATES/END/CLR',ROUTCDE=10,DESC=7,MFX
               =L
MSG2     WTO   'IFD395I ACTIVE EQUATES SELECTED',ROUTCDE=10,DESC=7,MF=L
MSG3     DS    0F
         DC    X'03'
         DC    XL7'00'
         WTO   'IFD396D ARE EQUATES CORRECT?  YES/NO',ROUTCDE=10,DESC=7X
               ,MF=L
MSG4     WTO   'IFD397I INVALID ENTRY                                  X
                                  ',ROUTCDE=10,DESC=7,MF=L
MSG5     WTO   'IFD398I EQUATED DEVICES EXCEED 16',ROUTCDE=10,DESC=7,MFX
               =L
MSG6     WTO   'IFD373I WARNING, EQUATING CDS TO SHARED DEV COULD DESTRX
               OY DATA',ROUTCDE=10,DESC=7,MF=L
DSECT49  IFDCOM
IFDOLT49 CSECT
A00000   EQU   TABLNGTH+00000002   1 BYTE(S)
A00001   EQU   A00000+00000000     1 BIT(S)
RESENTB  EQU   A00000+00000000     1 BIT(S)
A00002   EQU   A00000+00000000     4 BIT(S)
FSTEQU   EQU   A00000+00000000     1 BIT(S)
A00003   EQU   A00000+00000000     1 BIT(S)
ROOTPTR  EQU   MCT+00000128        FULLWORD POINTER
A00004   EQU   IFDMSG49+00000000   24 BYTE(S) ON WORD
IFD394   EQU   A00004+00000000     FULLWORD POINTER
IFD395   EQU   A00004+00000004     FULLWORD POINTER
IFD396   EQU   A00004+00000008     FULLWORD POINTER
IFD397   EQU   A00004+00000012     FULLWORD POINTER
IFD398   EQU   A00004+00000016     FULLWORD POINTER
IFD373   EQU   A00004+00000020     FULLWORD POINTER
A00005   EQU   A00004+00000020     1 BYTE(S)
A00030   EQU   CESWTR+00000000     1 BYTE(S)
RETAINAC EQU   A00030+00000000     1 BIT(S)
A00031   EQU   CESWTR2+00000000    1 BYTE(S)
A00032   EQU   A00031+00000000     7 BIT(S)
DPMSGREI EQU   A00031+00000000     1 BIT(S)
@DATEND  EQU   *
CDS184   EQU   CDS192
         END   IFDOLT49

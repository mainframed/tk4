         TITLE 'IFDOLT33 OPTIONS DECODE'
         TITLE 'IFDOLT33 OPTIONS DECODE'
         LCLA  &T,&SPN                                            0002
.@001    ANOP                                                     0002
IFDOLT33 CSECT ,                                                  0002
         BC    15,24(0,@F)
         DC    C'IFDOLT33 14 FEB 78'                             0002
         STM   @E,@C,12(@D)                                       0002
         BALR  @B,0                                               0002
@PSTART  DS    0H                                                 0002
         USING @PSTART+00000,@B                                   0002
         ST    @D,@SAV001+4                                       0002
         LA    @F,@SAV001                                         0002
         ST    @F,8(0,@D)                                         0002
         LR    @D,@F                                              0002
*         GEN(USING CHASCT,2);
         USING CHASCT,2
         DS    0H
*         GENERATE DATA;
*         /************************************************************
*         /*                        REGISTERS                         *
*         /************************************************************
*         DCL R1 REG(1) PTR(31);         /* REGISTER 1.               *
*         DCL R2 REG(2) PTR(31);         /* REGISTER 2.               *
*         DCL R3 REG(3) PTR(31);         /* REGISTER 3.               *
*         DCL R4 REG(4) PTR(31);         /* REGISTER 4.               *
*         DCL R5 REG(5) PTR(31);         /* REGISTER 5.               *
*         DCL R6 REG(6) PTR(31);         /* REGISTER 6.               *
*         DCL I REG(7) PTR(24);          /* REGISTER 7.               *
*         DCL J REG(8) PTR(24);          /* REGISTER 8.               *
*         DCL R8 REG(8) PTR(31);         /* REGISTER 8.               *
*         DCL K REG(9) PTR(24);          /* REGISTER 9.               *
*         DCL R9 REG(9) PTR(24);         /* REGISTER 9.               *
*         DCL R13 REG(13) PTR(31);       /* REGISTER 13.              *
*         DCL R14 REG(14) PTR(31);       /* REGISTER 14.              *
*         DCL R15 REG(15) PTR(24);       /* REGISTER 15.              *
*         /************************************************************
*         /*                       SAVE AREAS                         *
*         /************************************************************
*         DCL 1 MYSAVE BASED(R13),
*               3 * CHAR(4),
*               3 YOURR13 PTR(31);
*         DCL 1 YOURSAVE BASED(YOURR13),
*               3 * CHAR(12),
*               3 YOURR14 PTR(31);
*         /************************************************************
*         /*                  SECTION CONTROL TABLE                   *
*         /************************************************************
*         DCL CHASCT CHAR(88) GENERATED;
*         DCL 1 SCT BASED(ADDR(CHASCT)), /*--------SCT FORMAT---------*
*               3 CELOOPCT FIXED(15),    /* ERROR LOOP COUNT.         *
*               3 TESTOPT CHAR(2),       /* OPTION FIELDS.            *
*                 5 OPTBYT CHAR(1),      /* FIRST OPTION FIELD.       *
*                   7 * BIT(5),          /* NOT LOOKED AT.            *
*                   7 NPR BIT(1),        /* PRINT FLAG.               *
*                   7 INDEFLP BIT(1),    /* NOT LOOKED AT.      Y02008*
*                   7 FRSTERR BIT(1),    /* FIRST ERROR COMM. FLAG.   *
*                 5 OPTBYTE CHAR(1),     /* SECOND OPTION FIELD.      *
*                   7 * BIT(2),          /* NOT LOOKED AT.            *
*                   7 UTCATAS BIT(1),    /* CATASTROPHIC ERROR FLAG.  *
*                   7 PP BIT(1),         /* PARALLEL PRINT FLAG  M1006*
*                   7 NCP BIT(1),        /* CONTROL PRINT FLAG.       *
*                   7 NEP BIT(1),        /* ERROR PRINT FLAG.         *
*                   7 EL BIT(1),         /* ERROR LOOP FLAG.          *
*                   7 TL BIT(1),         /* TEST LOOP FLAG.           *
*               3 * CHAR(29),            /* NOT LOOKED AT.            *
*               3 EXPGMFLG CHAR(1),      /* EXECUTIVE PROGRAM FLAGS.  *
*                 5 CECOMRPL BIT(1),     /* REPLY TO AN OUTSTANDING   *
*                                        /* OLT MESSAGE ISSUED BY     *
*                                        /* CECOM HAS BEEN MADE.      *
*                 5 MOREONE BIT(1),      /* MORE THAN 1 DEVICE TO BE  *
*                                        /* TESTED.                   *
*                 5 ROUTINES BIT(1),     /* OPERATOR HAS MADE ROUTINE *
*                                        /* SELECTION.                *
*                 5 ELCOUNT BIT(1),      /* OPERATOR HAS SPECIFIED A  *
*                                        /* COUNT FOR THE ERROR LOOP  *
*                                        /* OPTION.                   *
*                 5 FINAL BIT(1),        /* SET BY FINAL MACRO.       *
*                 5 CLEANUP BIT(1),      /* INDICATES CLEANUP ENTRY   *
*                                        /* FOR OLT.                  *
*               3 * CHAR(2),             /* NOT LOOKED AT.            *
*               3 FUNCFLGS CHAR(1),      /* OLT FUNCTIONAL FLAGS.     *
*                 5 MI BIT(1),           /* MANUAL INTERVENTION TESTS *
*                                        /* SELECTED BY THE OPERATOR. *
*             5 CLNUPPRV BIT(1),        /* INDICATES TO EXEC THAT     *
*                                       /* CLEANUP HAS BEEN PRO-      *
*                                       /* VIDED BY THE OLT.          *
*             5 * BIT(3),
*             5 TR BIT(1);              /* TRACE FUNCTION HAS   X02008*
*                                       /* BEEN REQSTD BY THE OLT     *
*         /************************************************************
*         /*                        SWITCHES                          *
*         /************************************************************
*         DCL CESWT CHAR(1) GENERATED;
*         DCL 1 OLTEPSW CHAR(1) BASED(ADDR(CESWT)),
*               3 LEGALTST BIT(1),       /* LEGAL TEST FLAG.          *
*               3 * BIT(3),              /* NOT LOOKED AT.            *
*               3 LEGALDEV BIT(1),       /* LEGAL DEVICE FLAG.        *
*               3 REINT BIT(1),          /* RE-INITIALIZE FLAG.       *
*               3 FERINT BIT(1),         /* FIRST ERROR COMM. INTERVAL*
*               3 FERCOM BIT(1);         /* FIRST ERROR COMM. FLAG.   *
*         DCL CESWT1 CHAR(1) GENERATED;
*         DCL 1 OLTEPSW1 CHAR(1) BASED(ADDR(CESWT1)),
*               3 * BIT(7),              /* NOT LOOKED AT.            *
*               3 TPFLAG BIT(1);         /* TP FLAG.                  *
*         DCL CESWT2 CHAR(1) GENERATED;
*         DCL 1 OLTEPSW2 CHAR(1) BASED(ADDR(CESWT2)),
*               3 NDCFO BIT(1),
*               3 * BIT(3),
*               3 INITENT BIT(1);        /* INITIAL ENTRY FLAG.       *
*         DCL CESWT5 CHAR(1) GEND;
*         DCL 1 OLTEPSW5 CHAR(1) BASED(ADDR(CESWT5)),
*              3 * BIT(7),
*               3 PRNTOPTN BIT(1);  /* PRINT OPTIONS FROM PREVIOUS21051
*                                   /* D/T/O/ ENTRY OR DEFAULT    21051
*                                   /* OPTNS ON FIRST ENTRY.      21051
*         DCL CESWT8 CHAR(1) GEND;      /* CESWT 8 IN COMM AREA X02008*
*         DCL 1 OLTEPSW8 CHAR(1) BASED(ADDR(CESWT8)),         /*X02008*
*           3 * BIT(7),
*           3 TALKHERE BIT(1);          /* TALK VERB ENTERED IN X02008*
*                                       /* THIS COMM INTERVAL.  X02008*
*         DCL CESWTR CHAR(1) GENERATED;  /* RETAIN 370 SWITCHES S20203*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR)),   /*             S20203*
*               3 RETAINAC BIT(1),       /* REI ACTIVE          S20203*
*               3 * BIT(1),              /*                     S20203*
*               3 REMNOMSG BIT(1),       /* REMOTE NO MSG       S20203*
*               3 * BIT(3),              /*                     S20203*
*               3 EXECOUT BIT(1),        /* MSG IFD104E ISSUED  S20203*
*               3 * BIT(1);              /*                     S20203*
*         DCL CESWTR1 CHAR(1) GENERATED; /*                     S20203*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR1)),  /*             S20203*
*               3 * BIT(5),              /*                     S20203*
*               3 REMANS BIT(1),         /* REMOTE ANSWERS IM   S20203*
*               3 * BIT(2);              /*                     S20203*
*         DCL CESWTR2 CHAR(1) GENERATED;    /* REI SWITCHES     S20203*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR2)),     /*          S20203*
*               2 REPLY00 BIT(1),        /* REPLY 00 TO MSG     S20203*
*               2 * BIT(1),              /*                     S20203*
*               2 ONCOMM BIT(1),         /* ONSITE ANSWERED FLG S20203*
*               2 * BIT(2),              /*                     S20203*
*               2 OPTERR BIT(1),         /*  ERROR IN OPT       S20203*
*               2 * BIT(1),
*               2 DPMSGREI BIT(1);      /* DP MODULE MSG BIT    YM2273*
*         DCL INBUFR CHAR(72) GENERATED;
*         DCL INPUTBUF CHAR(7) BASED(R5);
*         DCL PRTBUFR CHAR(1) GENERATED;
*         DCL OPTSAVE CHAR(4);
*         DCL ELSAVE FIXED(15);
*         DCL TLSAVE FIXED(15);
*         DCL LVLSAVE CHAR(1);
*         DCL REISAVE CHAR(1);           /* CESWTR1 SAVEAREA    S20203*
*         DCL 1 SWITCHES CHAR(1),
*               3 FSTSCN BIT(1),         /*                     S20203*
*               3 TWOBYTE BIT(1),        /*                     S20203*
*               3 THREEB BIT(1),         /*                     S20203*
*               3 FOURBYTE BIT(1);       /*                     S20203*
*         DCL 1 OPTAB(10) CHAR(5)       /* OPTION TABLE         X02008*
*           INITIAL('D5C6C5FE01'X,
*                   'D5D4C97F80'X,
*                   'D5D7D9FB04'X,
*                   'D5D7D7EF10'X,       /*                      M1006*
*                   'D5E3D3FE01'X,
*                   'D5C5D3FD02'X,
*                   'D5C3D7F708'X,
*                   'D5C5D7FB04'X,       /*                     S20203*
*                   'D5D9C5FB04'X,
*                   'D5E3D9FB04'X),     /*    TRACE OPTION      X02008*
*                 5 OPTION CHAR(3),
*                   7 * CHAR(1),
*                   7 OPTION1 CHAR(2),
*                 5 AND CHAR(1),
*                 5 OR CHAR(1);
*         DCL NUMBERS CHAR(10) INIT('0123456789');
*         DCL NUMBER CHAR(1) BASED(R6);
*         DCL 1 AREA CHAR(8) BDY(DWORD),
*               3 DUMMY FIXED(31),
*                 5 * CHAR(3),
*                 5 I3 CHAR(1);
*         DCL CNVRT CHAR(5);
*         DCL INBUFPTR PTR(31) GENERATED;
*         DCL DPLEVEL CHAR(1) GENERATED;
*         DCL LEVELIND CHAR(1) BASED(ADDR(DPLEVEL));
*         DCL DYNCOM CHAR(1) GENERATED;
*         DCL TLCOUNT FIXED(15) GENERATED;
*         DCL TLRUN FIXED(15) BASED(ADDR(TLCOUNT)+6);
*         DCL ECB3 CHAR(4) GENERATED;
*         DCL 1 ECB CHAR(4) BASED(ADDR(ECB3)),
*               3 * CHAR(1),
*                 5 * BIT(1),
*                 5 ECB3POST BIT(1);
*         DCL DEVDEPAD PTR(31) GENERATED;
*         DCL REGX PTR(31) GENERATED;
*         DCL PGMTAB CHAR(8) GENERATED;
*         DCL PGMTBL CHAR(8) BASED(ADDR(PGMTAB));
*         DCL SECLST CHAR(10) GENERATED;
*         DCL 1 SECLIST CHAR(10) BASED(ADDR(SECLST)),
*               3 * CHAR(2),
*               3 SECLST2 CHAR(8);
*         DCL SECTUSE CHAR(1) GENERATED;
*         DCL UNITUSE CHAR(1) GENERATED;
*         DCL TUCBAD1 PTR(31) GENERATED;
*         DCL TUCBAD2 PTR(31) GENERATED;
*         DCL DEVTAB CHAR(896) GENERATED;
*         DCL DEVTBPTR PTR GENERATED;
*         DCL 1 DEVTABLE BASED(DEVTBPTR),
*               3 DEVICE(16) CHAR(56) BDY(WORD),
*                 5 * CHAR(8),
*                 5 DVTABUCB PTR(31);
*         DCL REDEFINE PTR(31) GENERATED;
*         DCL COMMINT PTR(31) GENERATED;
*         DCL 1 MSGPTR BASED(R3),
*               3 MSGPTR04 PTR(31),
*               3 MSGPTR07 PTR(31),
*               3 MSGPTR15 PTR(31),
*               3 MSGPTR61 PTR(31),      /*                     S20203*
*           3 MSGPTXXX,
*           3 MSGPTR27;                 /* MESSAGE IFD327I      X02008*
*         DCL 1 MSG327 BASED(R1),       /* EXT BUFFER MESSAGE.  X02008*
*           3 * CHAR(16),               /* FLAGS, MSG ID        X02008*
*           3 EXTMSG CHAR(55);          /* EXT MESSAGE BUFFER   X02008*
*         DCL 1 WTOR104D CHAR(8) BDY(WORD),
*               3 REPLYAD PTR(31),
*                 5 REPLYLEN CHAR(1),
*               3 ECB3ADDR PTR(31);
*         DCL 1 MSG104 CHAR(79) BASED(R1),
*               3 MSGPRFX CHAR(8),
*               3 * CHAR(4),
*               3 MSG104D CHAR(67);
*         DCL 1 MSG107 BASED(R1),
*               3 * CHAR(4),
*               3 MSG107I CHAR(51);
*         DCL 1 NEGMSG BASED(R8),
*               3 NOT CHAR(1);
*  DCL SAVR5 PTR;                        /*                      M4501*
*  DCL MSG115A CHAR(10) BASED(R1+38);    /*                      M4501*
*         DCL EXTBUF CHAR(56) GENERATED;
*         DCL SATAB CHAR(12) GENERATED;
*         DCL OPSYS CHAR(1) BASED(ADDR(SATAB));
*         DCL IFDMSG33 LABEL NONLOCAL EXTERNAL;
*         RESTRICT(2,3,4,5,6,7,8,9);
*         /************************************************************
*         /*                                                          *
*         /*               SETUP AND SAVE OLD OPTIONS                 *
*         /*                                                          *
*         /************************************************************
*         IF INITENT='0'B THEN      /* IS THIS INITIAL CALL OF OPTION *
         TM    OLTEPSW2,B'00001000'                               0089
         BC    05,@9FF                                            0089
*           DO;                     /* DECODE MODULE. YES, SET THE    *
*           NCP='1'B;               /* DEFAULT OPTIONS INTO EFFECT.   *
         OI    SCT+3,B'00001000'                                  0091
*           FRSTERR='0'B;            /*     NFE DEFAULT       @ZA29758*
         NI    SCT+2,B'11111110'                                  0092
*           NPR='1'B;
         OI    SCT+2,B'00000100'                                  0093
*           END;                    /* NO, CONTINUE.                  *
*         R3=ADDR(IFDMSG33);
@9FF     L     @1,@V1              ADDRESS OF IFDMSG33            0095
         LR    @3,@1                                              0095
*         IF TALKHERE='1'B THEN         /* IF TALK ENTERED THIS X02008*
         TM    OLTEPSW8,B'00000001'                               0096
*           GO TO CECNP46A;             /* COMM INTERVAL, GIVE  X02008*
         BC    01,CECNP46A                                        0097
*                                       /* OLT DYN COMM AGAIN.  X02008*
*         IF PRNTOPTN='1'B THEN     /* NEED OPTIONS PRINTED?      21051
         TM    OLTEPSW5,B'00000001'                               0098
*           GO TO CECOPT46;         /* YES, GO TO OPTN MSG.       21051
         BC    01,CECOPT46                                        0099
*         R5=INBUFPTR+1;            /* INCREMENT INBUFR POINTER.*/
         LA    @5,1                                               0100
         A     @5,INBUFPTR                                        0100
*         OPTSAVE(1:2)=TESTOPT;     /* SAVE OLD OPTIONS.            */
         MVC   OPTSAVE(2),SCT+2                                   0101
*         OPTSAVE(3)=EXPGMFLG;      /* SAVE EXECUTIVE PROGRAM FLAGS.*/
         MVC   OPTSAVE+2(1),SCT+33                                0102
*         OPTSAVE(4)=FUNCFLGS;      /* SAVE OLT FUNCTIONAL FLAGS.   */
         MVC   OPTSAVE+3(1),SCT+36                                0103
*         REISAVE=CESWTR1;               /* SAVE REI SWITCHES   S20203*
         MVC   REISAVE(1),CESWTR1                                 0104
*         LVLSAVE=LEVELIND;         /* SAVE LEVEL OF PRINTING. */
         MVC   LVLSAVE(1),LEVELIND                                0105
*         ELSAVE=CELOOPCT;          /* SAVE C.E. ERROR LOOP COUNT. */
         MVC   ELSAVE(2),SCT                                      0106
*         TLSAVE=TLCOUNT;           /* SAVE C.E. TEST LOOP COUNT. */
         MVC   TLSAVE(2),TLCOUNT                                  0107
*         LEGALTST='1'B;            /* SET LEGAL TEST INDICATOR TO ONE*
         OI    OLTEPSW,B'10000000'                                0108
*         IF INPUTBUF(1)='/' THEN   /* ARE DEFAULT OR EXISTING */
         CLI   0(@5),C'/'                                         0109
         BC    07,@9FE                                            0109
*           DO;                     /* OPTIONS DESIRED. YES,          *
*           R4=R5+1;                /* GO TO FINISH UP ROUTINE.       *
         LA    @4,1                                               0111
         AR    @4,@5                                              0111
*           GO TO CECOPT42;
         BC    15,CECOPT42                                        0112
*           END;
* CECOPT01:
*         /************************************************************
*         /*          DETERMINE WHAT OPTIONS ARE SELECTED             *
*         /************************************************************
*         FSTSCN='1'B;              /* SET FIRST SCAN */
@9FE     EQU   *                                                  0114
CECOPT01 OI    SWITCHES,B'10000000'                               0114
*                                   /* INDICATOR ON.  */
* CECOPT02:
*  SAVR5=R5;                             /* SAVE ADDRESS         M4501*
CECOPT02 ST    @5,SAVR5                                           0115
*         /************************************************************
*         /*                                                          *
*         /*       IS IT FIRST OR SECOND SCAN OF OPTION TABLE         *
*         /*                                                          *
*         /************************************************************
*         IF FSTSCN^='1'B THEN      /* IS IT THE FIRST SCAN. NO, */
         TM    SWITCHES,B'10000000'                               0116
*           GO TO CECOPT10;         /* CHECK TWO BYTE OPTIONS.   */
         BC    12,CECOPT10                                        0117
*                                   /* YES, CHECK THREE BYTE OPTIONS.*/
*         IF INPUTBUF(1:3)^=OPTION(1) THEN  /* IS NFE SPECIFIED. */
         CLC   0(3,@5),OPTAB                                      0118
*           GO TO CECOPT03;                 /* NO, CHECK NEXT    */
         BC    07,CECOPT03                                        0119
*                                           /* THREE BYTE OPTION.*/
*         OPTBYT=OPTBYT&AND(1);     /* YES, SET FIRST ERROR */
         NC    SCT+2(1),OPTAB+3                                   0120
*                                   /* COMM. INDICATOR OFF. */
*         GO TO CECOPT30;           /* GO TO ROUTINE THAT WILL */
         BC    15,CECOPT30                                        0121
*                                   /* DECODE DELIMITERS.      */
* CECOPT03:
*         /************************************************************
*         /*                                                          *
*         /*                 IS NMI OPTION SPECIFIED                  *
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:3)^=OPTION(2) THEN  /* IS NMI SPECIFIED. */
CECOPT03 CLC   0(3,@5),OPTAB+5                                    0122
*          GO TO CEOPT04A;              /* CHECK NTR OPTION.    X02008*
         BC    07,CEOPT04A                                        0123
*         FUNCFLGS=FUNCFLGS&AND(2); /* YES, SET MANUAL INT. */
         NC    SCT+36(1),OPTAB+8                                  0124
*                                   /* INDICATOR OFF.       */
*         GO TO CECOPT30;           /* GO TO ROUTINE THAT WILL */
         BC    15,CECOPT30                                        0125
*                                   /* DECODE DELIMITERS.      */
* CEOPT04A:
*         /************************************************************
*         /*                                                          *
*         /*          IS NTR OPTION SPECIFIED                   X02008*
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:3)^=OPTION(10) THEN
CEOPT04A CLC   0(3,@5),OPTAB+45                                   0126
*          GO TO CECOPT04;              /* CHECK RE OPTION      X02008*
         BC    07,CECOPT04                                        0127
*          FUNCFLGS=FUNCFLGS&AND(10);   /* TURN OFF TR BIT IN SCT     *
         NC    SCT+36(1),OPTAB+48                                 0128
*          GO TO CECOPT30;              /* CHECK DELIMETER.     X02008*
         BC    15,CECOPT30                                        0129
*                                           /* THREE BYTE OPTION.*/
* CECOPT04:
*         /************************************************************
*         /*                                                          *
*         /*                 IS NPR OPTION SPECIFIED                  *
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:3)^=OPTION(3) THEN  /* IS NPR SPECIFIED. */
CECOPT04 CLC   0(3,@5),OPTAB+10                                   0130
*           GOTO CECOPT61;               /* NO, CHECK NEXT      S20203*
         BC    07,CECOPT61                                        0131
*                                           /* THREE BYTE OPTION.*/
*         OPTBYT=OPTBYT&AND(3);     /* YES, SET NO PRINT */
         NC    SCT+2(1),OPTAB+13                                  0132
*                                   /* INDICATOR OFF.    */
*         GO TO CECOPT30;           /* GO TO ROUTINE THAT WILL */
         BC    15,CECOPT30                                        0133
*                                   /* DECODE DELIMITERS.      */
* CECOPT61:                              /*                     S20203*
*         /************************************************************
*         /*                                                          *
*         /*                  IS NRE OPTION SPECIFIED                 *
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:3)^=OPTION(9) THEN   /* IS NRE SPEC     S20203*
CECOPT61 CLC   0(3,@5),OPTAB+40                                   0134
*           GOTO CECOPT05;               /* NO. CHECK NEXT      S20203*
         BC    07,CECOPT05                                        0135
*                                        /* THREE BYTE OPTION   S20203*
*         REMANS='0'B;                   /* ZERO REMANS SWITCH  S20203*
         NI    A00016,B'11111011'                                 0136
*         GOTO CECOPT30;                 /* GOTO ROUTINE THAT   S20203*
         BC    15,CECOPT30                                        0137
*                                        /* WILL DECODE DELIM   S20203*
* CECOPT05:
*         /************************************************************
*         /*                                                          *
*         /*   IS SPECIFIED OPTION ONE OF THE OTHER 3 BYTE OPTIONS    *
*         /*                                                          *
*         /************************************************************
*         DO I=8 TO 4 BY -1;              /* IS OPTION ANOTHER 3 */
CECOPT05 LA    @7,8                                               0138
*         IF INPUTBUF(1:3)=OPTION(I) THEN /* BYTE OPTION. YES,   */
@DO9FD   LR    @1,@7                                              0139
         MH    @1,@D1                                             0139
         LA    @E,OPTAB-5(@1)                                     0139
         CLC   0(3,@5),0(@E)                                      0139
*           GO TO CECOPT06;               /* CONTINUE PROCESSING.*/
         BC    08,CECOPT06                                        0140
*         END;
*         FSTSCN='0'B;                    /* NO, SET FIRST SCAN  */
         BCTR  @7,0                                               0141
@DO9FC   CH    @7,@D2                                             0141
         BC    10,@DO9FD                                          0141
         NI    SWITCHES,B'01111111'                               0142
*         GO TO CECOPT10;                 /* INDICATOR OFF AND   */
         BC    15,CECOPT10                                        0143
*                                         /* CHECK IF OPTION     */
*                                         /* MIGHT BE A 2 BYTE   */
*                                         /* ONE.                */
* CECOPT06:
*         /************************************************************
*         /*                                                          *
*         /*                  IS NCP OR NEP SPECIFIED                 *
*         /*                                                          *
*         /************************************************************
*         IF I=8 THEN               /* IS NEP SPECIFIED. YES, SET NEP *
CECOPT06 CH    @7,@D3                                             0144
         BC    07,@9F9                                            0144
*           OPTBYTE=OPTBYTE×OR(8);  /* INDICATOR ON AND CONTINUE      *
         OC    SCT+3(1),OPTAB+39                                  0145
         BC    15,@9F8                                            0146
*                                   /* DECODING.                      *
*         ELSE
*         OPTBYTE=OPTBYTE&AND(I);   /* NO, SET NCP/NTL/NEL FLAG OFF.  *
@9F9     LR    @1,@7                                              0146
         MH    @1,@D1                                             0146
         LA    @E,OPTAB-2(@1)                                     0146
         NC    SCT+3(1),0(@E)                                     0146
*         IF I=5 THEN               /* IF NTL, ZERO TEST LOOP COUNT   *
@9F8     CH    @7,@D1                                             0147
         BC    07,@9F7                                            0147
*         DO;
*          TLCOUNT=0;              /* CLEAR TL COUNT IN COMM AREA     *
         SR    @F,@F                                              0149
         STH   @F,TLCOUNT                                         0149
*          TLRUN =0;               /* CLEAR SCHEDULER COUNTER.  S21052*
         STH   @F,TLRUN                                           0150
*         END;
*         IF I=6 THEN               /* IS NEL OPT SELECTED      Y02008*
@9F7     CH    @7,@D4                                             0152
         BC    07,@9F6                                            0152
*           DO;                     /* YES,                     Y02008*
*             INDEFLP = '0'B;       /* SET INFINITE LOOP OFF    Y02008*
         NI    SCT+2,B'11111101'                                  0154
*             ELCOUNT = '0'B;       /* SET COUNT LOOP OFF       Y02008*
         NI    SCT+33,B'11101111'                                 0155
*           END;                    /* NO, NEL NOT SELECTED     Y02008*
*         GO TO CECOPT30;           /* GO TO ROUTINE THAT */
         BC    15,CECOPT30                                        0157
*                                   /* DECODES DELIMITERS.*/
* CECOPT10:
*         /************************************************************
*         /*                                                          *
*         /*                   IS IT A 2 BYTE OPTION                  *
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:2)^=OPTION1(1) THEN /* IS FE SPECIFIED. */
CECOPT10 CLC   0(2,@5),OPTAB+1                                    0158
*           GO TO CECOPT11;                 /* NO, CHECK NEXT 2 */
         BC    07,CECOPT11                                        0159
*                                           /* BYTE OPTION.     */
*         OPTBYT=OPTBYT×OR(1);              /* YES, SET FIRST   */
         OC    SCT+2(1),OPTAB+4                                   0160
*                                           /* ERROR COMM.      */
*                                           /* INDICATOR ON.    */
*         GO TO CECOPT29;           /* GO TO ROUTINE THAT WILL */
         BC    15,CECOPT29                                        0161
*                                   /* DECODE DELIMITERS.      */
* CECOPT11:
*         /************************************************************
*         /*                                                          *
*         /*                     IS MI SPECIFIED                      *
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:2)^=OPTION1(2) THEN  /* IS MI SPECIFIED. */
CECOPT11 CLC   0(2,@5),OPTAB+6                                    0162
*           GO TO CECOPT12;                  /* NO, CHECK NEXT 2 */
         BC    07,CECOPT12                                        0163
*                                            /* BYTE OPTION.     */
*         FUNCFLGS=FUNCFLGS×OR(2);           /* YES, SET MANUAL  */
         OC    SCT+36(1),OPTAB+9                                  0164
*                                            /* INTERVENTION IND.*/
*                                            /* ON AND CONTINUE  */
*                                            /* DECODING.        */
*         GO TO CECOPT29;           /* GO TO ROUTINE THAT WILL */
         BC    15,CECOPT29                                        0165
*                                   /* DECODE DELIMITERS.      */
* CECOPT12:
*         /************************************************************
*         /*                                                          *
*         /*                     IS PR SPECIFIED                      *
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:2)^=OPTION1(3) THEN  /* IS PR SPECIFIED.  */
CECOPT12 CLC   0(2,@5),OPTAB+11                                   0166
*          GO TO CEOPT12A;              /* CHECK FOR TRACE FNCTNX02008*
         BC    07,CEOPT12A                                        0167
*         OPTBYT=OPTBYT×OR(3);      /* YES, SET PRINT FLAG ON.        *
         OC    SCT+2(1),OPTAB+14                                  0168
*                                            /* INDICATOR OFF.    */
*         GO TO CECOPT29;           /* GO TO ROUTINE THAT WILL */
         BC    15,CECOPT29                                        0169
*                                   /* DECODE DELIMITERS.      */
* CEOPT12A:
*         /************************************************************
*         /*                                                          *
*         /*          IS TR OPTION SPECIFIED                    X02008*
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:2)^=OPTION1(10) THEN
CEOPT12A CLC   0(2,@5),OPTAB+46                                   0170
*          GO TO CECOPT60;              /* CHECK FOR RE OPTION. X02008*
         BC    07,CECOPT60                                        0171
*          FUNCFLGS=FUNCFLGS×OR(10);    /* TURN ON TR BIT IN SCTX02008*
         OC    SCT+36(1),OPTAB+49                                 0172
*          GOTO CECOPT29;               /* CHECK DELIMETER.     X02008*
         BC    15,CECOPT29                                        0173
*         /************************************************************
*         /*                                                          *
*         /*                   IS RE SPECIFIED                        *
*         /*                                                          *
*         /************************************************************
* CECOPT60:                              /*                     S20203*
*         IF INPUTBUF(1:2)^=OPTION1(9) THEN  /* IS RE SPECIFIED S20203*
CECOPT60 CLC   0(2,@5),OPTAB+41                                   0174
*           GOTO CECOPT13;                   /* NO.CHECK NEXT 2 S20203*
         BC    07,CECOPT13                                        0175
*         IF RETAINAC='1'B THEN              /* IS REI ACTIVE.  S20203*
         TM    A00012,B'10000000'                                 0176
         BC    12,@9F5                                            0176
*           DO;                              /*                 S20203*
*           REMANS='1'B;                 /* SET RE OPT FLAG     S20203*
         OI    A00016,B'00000100'                                 0178
*           GOTO CECOPT29;          /* GOTO ROUTINE THAT WILL   S20203*
         BC    15,CECOPT29                                        0179
*                                   /* DECODE DELIMITERS.       S20203*
*           END;                         /*                     S20203*
*         GOTO CECOPT33;                     /* NO.ERROR        S20203*
* CECOPT13:
*         /************************************************************
*         /*                                                          *
*         /*                     IS PP SPECIFIED                M1006*/
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:2)^=OPTION1(4) THEN  /* IS PP SPECIFIED. M1006*
CECOPT13 CLC   0(2,@5),OPTAB+16                                   0182
*           GO TO CECOPT14;                  /* NO, CHECK NEXT 2  */
         BC    07,CECOPT14                                        0183
*                                            /* BYTE OPTION.      */
*         OPTBYTE=OPTBYTE×OR(4);             /* YES, SET ALTERNATE*/
         OC    SCT+3(1),OPTAB+19                                  0184
*                                            /* PRINTER IND. ON.  */
*         IF INPUTBUF(3)^='(' &        /* IS A LEVEL OF PRINTING */
*
*               INPUTBUF(5)^=')' THEN  /* SPECIFIED. NO, SET     */
         CLI   2(@5),C'('                                         0185
         BC    08,@9F4                                            0185
         CLI   4(@5),C')'                                         0185
         BC    08,@9F3                                            0185
*                 DO;                  /* DEFAULT AS LEVEL OF    */
*                 LEVELIND='2';
         MVI   LEVELIND,C'2'                                      0187
*                 GO TO CECOPT29;      /* PRINT AND GO DECODE    */
         BC    15,CECOPT29                                        0188
*                 END;                 /* DELIMITER.             */
*         IF INPUTBUF(4:5)='0)'×        /* CHECK DELIMITERS           *
*              INPUTBUF(4:5)='1)'×
*                INPUTBUF(4:5)='2)'×
*                  INPUTBUF(4:5)='3)' THEN
@9F3     EQU   *                                                  0190
@9F4     CLC   3(2,@5),@C7                                        0190
         BC    08,@9F2                                            0190
         CLC   3(2,@5),@C8                                        0190
         BC    08,@9F1                                            0190
         CLC   3(2,@5),@C9                                        0190
         BC    08,@9F0                                            0190
         CLC   3(2,@5),@C10                                       0190
         BC    07,@9EF                                            0190
*               DO;
@9F0     EQU   *                                                  0191
@9F1     EQU   *                                                  0191
*               LEVELIND=INPUTBUF(4); /* YES, PUT IT IN COMMON AREA */
@9F2     MVC   LEVELIND(1),3(@5)                                  0192
*               R5=R5+5;               /* INCREMENT INBUFR POINTER. */
         AH    @5,@D1                                             0193
*               GO TO CECOPT31;        /* DECODE DELIMITER FILLOWING */
         BC    15,CECOPT31                                        0194
*               END;                   /* SPECIFIED OPTION.          */
*         GO TO CECOPT33;              /* NO, ERROR IN OPTION FIELD  */
* CECOPT14:
*         /************************************************************
*         /*                                                          *
*         /*   IS SPECIFIED OPTION ONE OF THE OTHER 2 BYTE OPTIONS    *
*         /*                                                          *
*         /************************************************************
*         DO I=8 TO 5 BY -1;        /* IS OPTION ANOTHER 2 BYTE OPTION*
CECOPT14 LA    @7,8                                               0197
*         IF INPUTBUF(1:2)=OPTION1(I) THEN  /* YES, CONTINUE DECODING.*
@DO9EE   LR    @1,@7                                              0198
         MH    @1,@D1                                             0198
         LA    @E,OPTAB-4(@1)                                     0198
         CLC   0(2,@5),0(@E)                                      0198
*           GO TO CECOPT15;
         BC    08,CECOPT15                                        0199
*         END;
*         GO TO CECOPT20;           /* NO, SEE IF EXT= IS SPECIFIED */
         BCTR  @7,0                                               0200
@DO9ED   CH    @7,@D1                                             0200
         BC    10,@DO9EE                                          0200
         BC    15,CECOPT20                                        0201
* CECOPT15:
*         /************************************************************
*         /*                                                          *
*         /*                    IS CP/EP SPECIFIED                    *
*         /*                                                          *
*         /************************************************************
*         IF I=8 THEN               /* IS EP SPECIFIED. YES, SET EP   *
CECOPT15 CH    @7,@D3                                             0202
         BC    07,@9EA                                            0202
*           DO;                     /* INDICATOR OFF AND CONTINUE     *
*           OPTBYTE=OPTBYTE&AND(8); /* DECODING.                      *
         NC    SCT+3(1),OPTAB+38                                  0204
*           GO TO CECOPT29;         /* GO TO ROUTINE THAT WILL */
         BC    15,CECOPT29                                        0205
*           END;                    /* DECODE DELIMITERS.      */
*         OPTBYTE=OPTBYTE×OR(I);    /* SET TL/EL/CP INDICATOR ON.     *
@9EA     LR    @1,@7                                              0207
         MH    @1,@D1                                             0207
         LA    @E,OPTAB-1(@1)                                     0207
         OC    SCT+3(1),0(@E)                                     0207
*         IF I=7 THEN               /* IF CP IS SPECIFIED, CONTINUE   *
         CH    @7,@D5                                             0208
*           GO TO CECOPT29;         /* DECODING.                      *
         BC    08,CECOPT29                                        0209
*         R5=R5+2;                  /* INCREMENT INBUFR POINTER. */
         AH    @5,@D6                                             0210
*         IF INPUTBUF(1)='(' THEN   /* IS A COUNT SPECIFIED IN */
         CLI   0(@5),C'('                                         0211
*                                   /* THE TL/EL OPTION.       */
*           GO TO CECOPT23;         /* YES, DECODE IT. */
         BC    08,CECOPT23                                        0212
*         IF I=5 THEN               /* IF NO COUNT IS SPECIFIED FOR  */
         CH    @7,@D1                                             0213
         BC    07,@9E9                                            0213
*         DO;
*          TLCOUNT=10;             /* TL, ASSIGN DEFAULT OF 10. S21052*
         LA    @F,10                                              0215
         STH   @F,TLCOUNT                                         0215
*          TLRUN=0;                /* CLEAR SCHEDULER COUNTER.  S21052*
         SR    @F,@F                                              0216
         STH   @F,TLRUN                                           0216
         BC    15,@9E8                                            0218
*         END;
*         ELSE                      /* SET ERROR LOOP INDICATOR */
*           ELCOUNT='0'B;           /* IN SCT TO INDICATE C.E.  */
@9E9     NI    SCT+33,B'11101111'                                 0218
*                                   /* DID NOT SPECIFY A COUNT. */
*         GO TO CECOPT31;           /* GO TO ROUTINE THAT WILL */
         BC    15,CECOPT31                                        0219
*                                   /* DECODE DELIMITERS.      */
* CECOPT20:
*         /************************************************************
*         /*                                                          *
*         /*                     IS EXT= SPECIFIED                    *
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:4)^='EXT=' THEN /* IS EXT= PRESENT IN THE  */
CECOPT20 CLC   0(4,@5),@C11                                       0220
*           GO TO CECOPT33;             /* OPTION FIELD. NO, ERROR.*/
         BC    07,CECOPT33                                        0221
*         R5=R5+4;                  /* INCREMENT INBUFR POINTER. */
         AH    @5,@D2                                             0222
*         FOURBYTE='1'B;                 /* FOUR BYTE OPTION    S20203*
         OI    SWITCHES,B'00010000'                               0223
*         DO I=1 TO 55;             /* FIND FINAL SLASH. */
         LA    @7,1                                               0224
*         IF INPUTBUF(I)='/' THEN
@DO9E7   LR    @1,@7                                              0225
         LA    @A,0(@1,@5)                                        0225
         BCTR  @A,0                                               0225
         CLI   0(@A),C'/'                                         0225
         BC    07,@9E3                                            0225
*           DO;
*           R4=R5+I;
         LR    @4,@7                                              0227
         AR    @4,@5                                              0227
*           GO TO CECOPT21;
         BC    15,CECOPT21                                        0228
*           END;
*         END;
*         GO TO CECOPT33;           /* SLASH NOT FOUND BEFORE LIMIT */
@9E3     AH    @7,@D7                                             0230
@DO9E6   CH    @7,@D8                                             0230
         BC    12,@DO9E7                                          0230
         BC    15,CECOPT33                                        0231
*                                   /* REACHED. ERROR.              */
* CECOPT21:
*         /************************************************************
*         /*                                                          *
*         /*             DECODE WHAT IS IN THE EXT= FIELD             *
*         /*                                                          *
*         /************************************************************
*         EXTBUF=EXTBUF&&EXTBUF;    /* CLEAR EXT AREA. */
CECOPT21 XC    EXTBUF(56),EXTBUF                                  0232
*         IF I=1 THEN               /* DOES EXT AREA CONTAIN    */
         CH    @7,@D7                                             0233
*           GO TO CECOPT22;         /* NOTHING.YES LEAVE EXT    */
         BC    08,CECOPT22                                        0234
*                                   /* AREA CLEAR.              */
*         EXTBUF(2:I)=INPUTBUF(1:I-1); /* PUT INFORMATION IN */
         LR    @E,@5                                              0235
         LR    @1,@7                                              0235
         SH    @1,@D6                                             0235
         LA    @A,EXTBUF+1                                        0235
         EX    @1,@MVC                                            0235
*                                      /* EXT AREA.          */
* CECOPT22:
*         /************************************************************
*         /*                PUT COUNT IN EXT BUFFER                   *
*         /************************************************************
*         DUMMY=I-1;                /* CALCULATE AMOUNT OF INFORMATION*
CECOPT22 LR    @F,@7                                              0236
         BCTR  @F,0                                               0236
         ST    @F,AREA                                            0236
*                                   /* IN EXT= OPTION.                *
*         EXTBUF(1)=I3;             /* PUT THIS COUNT IN FIRST BYTE */
         MVC   EXTBUF(1),AREA+3                                   0237
*                                   /* OF EXT AREA.                 */
*         GO TO CECOPT42;           /* GO TO FINISH UP ROUTINE. */
         BC    15,CECOPT42                                        0238
* CECOPT23:
*         /************************************************************
*         /*                                                          *
*         /*              DECODE COUNT THAT WAS SPECIFIED             *
*         /*                                                          *
*         /************************************************************
*         TWOBYTE='1'B;                  /* TWO BYTE OPTION     S20203*
CECOPT23 OI    SWITCHES,B'01000000'                               0239
*         IF I=6 THEN               /* IF  EL OPTION            Y02008*
         CH    @7,@D4                                             0240
         BC    07,@9E2                                            0240
*           DO;                     /* YES,                     Y02008*
*             INDEFLP = '0'B;       /* RESET INFINITE LOOP      Y02008*
         NI    SCT+2,B'11111101'                                  0242
*             IF INPUTBUF(2:3) = 'I)' THEN /* IS INF LOOP SELECTY02008*
         CLC   1(2,@5),@C12                                       0243
         BC    07,@9E1                                            0243
*               DO;                 /* YES,                     Y02008*
*                 INDEFLP = '1'B;   /* SET INFINITE LOOP ON     Y02008*
         OI    SCT+2,B'00000010'                                  0245
*                 R5 = R5+3;        /* INDEX TO END THIS OPT    Y02008*
         AH    @5,@D9                                             0246
*                 GOTO CECOPT31;    /* GO CHECK DELIMITER       Y02008*
         BC    15,CECOPT31                                        0247
*               END;                /* NO, NOT INFINITE SELECTIOY02008*
*             ELCOUNT = '1'B;       /* SET COUNT SELECT ON      Y02008*
@9E1     OI    SCT+33,B'00010000'                                 0249
*           END;                    /* NO, EL OPTION            Y02008*
*         DO K=2 TO 7;              /* DECODE NUMBER. */
@9E2     LA    @9,2                                               0251
*         R6=ADDR(NUMBERS);         /* INITIALIZE POINTER TO NUM. TAB.*
@DO9E0   LA    @6,NUMBERS                                         0252
*           DO J=10 TO 1 BY -1;     /* FIND LENGTH. */
         LA    @8,10                                              0253
*           IF INPUTBUF(K)=NUMBER THEN /* IS THIS A VALID NUMBER. */
@DO9DC   LR    @1,@9                                              0254
         LA    @A,0(@1,@5)                                        0254
         BCTR  @A,0                                               0254
         CLC   0(1,@A),0(@6)                                      0254
*             GO TO CECOPT24;          /* YES, CHECK NEXT CHAR.   */
         BC    08,CECOPT24                                        0255
*           R6=R6+1;                   /* NO, INCREMENT PTR TO NUM.TAB*
         AH    @6,@D7                                             0256
*           END;
*         IF K=2×                   /* IS THE NUMBER OF LENGTH 0 OR IS*
*              INPUTBUF(K)^=')' THEN/* THE NUMBER NOT ENCLOSED IN A ) *
         BCT   @8,@DO9DC                                          0257
         CH    @9,@D6                                             0258
         BC    08,@9D8                                            0258
         LR    @1,@9                                              0258
         LA    @A,0(@1,@5)                                        0258
         BCTR  @A,0                                               0258
         CLI   0(@A),C')'                                         0258
         BC    08,@9D7                                            0258
*            GO TO CECOPT33;        /* PARENTHESIS. YES, ERROR.       *
         BC    07,CECOPT33                                        0259
*         GO TO CECOPT25;           /* CONVERT THIS NUMBER.           *
         BC    15,CECOPT25                                        0260
* CECOPT24:
*         END;
* CECOPT25:
*         /************************************************************
*         /*                                                          *
*         /*                  CONVERT COUNT SPECIFIED                 *
*         /*                                                          *
*         /************************************************************
*         CNVRT=CNVRT&&CNVRT;       /* CLEAR CONVERSION AREA. */
CECOPT24 AH    @9,@D7                                             0261
@DO9DF   CH    @9,@D5                                             0261
         BC    12,@DO9E0                                          0261
CECOPT25 XC    CNVRT(5),CNVRT                                     0262
*         CNVRT(8-K:5)=INPUTBUF(2:K-1); /* PLACE COUNT IN  */
         LA    @E,1(0,@5)                                         0263
         LA    @1,5                                               0263
         LCR   @C,@9                                              0263
         AH    @C,@D3                                             0263
         SR    @1,@C                                              0263
         LA    @A,CNVRT-1(@C)                                     0263
         EX    @1,@MVC                                            0263
*                                       /* CONVERSION AREA.*/
*         GEN;                          /* CONVERT IT. */
         PACK  AREA(8),CNVRT(5)
         CVB   R6,AREA
         DS    0H
*         IF R6>0 &                 /* IS COUNT WITH-IN LIMITS */
*               R6<32768 THEN       /* YES, PLACE COUNT  */
         LTR   @6,@6                                              0265
         BC    12,@9D6                                            0265
         C     @6,@D10                                            0265
         BC    10,@9D5                                            0265
*            DO;                    /* WHERE IT BELONGS. */
*            R5=R5+K;               /* INCREMENT INBUFR POINTER. */
         AR    @5,@9                                              0267
*            IF I=5 THEN            /* PUT TL COUNT IN COMMON AREA. */
         CH    @7,@D1                                             0268
         BC    07,@9D4                                            0268
*         DO;
*          TLRUN=0;                /* CLEAR SCHEDULER FLAG      S21052*
         SR    @F,@F                                              0270
         STH   @F,TLRUN                                           0270
*          TLCOUNT=R6;             /* PUT TL COUNT IN COMM AREA S21052*
         STH   @6,TLCOUNT                                         0271
         BC    15,@9D3                                            0273
*         END;
*            ELSE
*              CELOOPCT=R6;         /* PUT EL COUNT IN SCT. */
@9D4     STH   @6,SCT                                             0273
*            GO TO CECOPT31;
         BC    15,CECOPT31                                        0274
*            END;
*         GO TO CECOPT33;           /* ERROR. */
* CECOPT29:
*         /************************************************************
*         /*                                                          *
*         /*              ROUTINE THAT DECODES DELIMITERS             *
*         /*                                                          *
*         /************************************************************
*         TWOBYTE='1'B;                  /* VALID 2-BYTE OPT    S20203*
CECOPT29 OI    SWITCHES,B'01000000'                               0277
*         R5=R5+2;                  /* INCREMENT INBUFR POINTER */
         AH    @5,@D6                                             0278
*         GO TO CECOPT31;           /* DECODE DELIMITER. */
         BC    15,CECOPT31                                        0279
* CECOPT30:
*         THREEB='1'B;                   /* VALID 3-BYTE OPT    S20203*
CECOPT30 OI    SWITCHES,B'00100000'                               0280
*         R5=R5+3;                  /* INCREMENT INBUFR POINTER. */
         AH    @5,@D9                                             0281
* CECOPT31:
*         /************************************************************
*         /*                   IS DELIMITER A COMMA                   *
*         /************************************************************
*         IF INPUTBUF(1)^=',' THEN  /* IS CHAR IN INBUFR A COMMA. */
CECOPT31 CLI   0(@5),C','                                         0282
*           GO TO CECOPT32;         /* NO, FIND OUT WHAT IT IS.   */
         BC    07,CECOPT32                                        0283
*         TWOBYTE='0'B;                  /* ZERO 2-BYTE SWITCH  S20203*
         NI    SWITCHES,B'10001111'                               0284
*         THREEB='0'B;                   /* ZERO 3-BYTE SWITCH  S20203*
*         FOURBYTE='0'B;                 /*                     S20203*
*         R5=R5+1;                  /* YES, INCREMENT INBUFR POINTER. *
         AH    @5,@D7                                             0287
*         GO TO CECOPT01;           /* DECODE NEXT OPTION. */
         BC    15,CECOPT01                                        0288
* CECOPT32:
*         /************************************************************
*         /*                   IS DELIMITER A SLASH                   *
*         /************************************************************
*         IF INPUTBUF(1)='/' THEN   /* IS CHAR IN INBUFR A SLASH.   */
CECOPT32 CLI   0(@5),C'/'                                         0289
         BC    07,@9D2                                            0289
*           DO;                     /* YES, GO TO FINISH UP ROUTINE.  *
*         TWOBYTE='0'B;                  /* ZERO 2-BYTE SWITCH  S20203*
         NI    SWITCHES,B'10001111'                               0291
*         THREEB='0'B;                   /* ZERO 3-BYTE SWITCH  S20203*
*         FOURBYTE='0'B;                 /*                     S20203*
*           R4=R5+1;
         LA    @4,1                                               0294
         AR    @4,@5                                              0294
*           GO TO CECOPT42;
         BC    15,CECOPT42                                        0295
*           END;
* CECOPT33:
*         /************************************************************
*         /*                                                          *
*         /*       RESTORE OLD OPTIONS, PRINT MESSAGE IFD115I         *
*         /*              AND RETURN TO REDEFINE TEST                 *
*         /*                                                          *
*         /************************************************************
*         CESWTR1=REISAVE;               /* RESTORE REI FLAGS   S20203*
@9D2     EQU   *                                                  0297
CECOPT33 MVC   CESWTR1(1),REISAVE                                 0297
*         TESTOPT=OPTSAVE(1:2);     /* RESTORE OLD OPTIONS. */
         MVC   SCT+2(2),OPTSAVE                                   0298
*         EXPGMFLG=OPTSAVE(3);      /* RESTORE EXEC. PROGRAM FLAGS. */
         MVC   SCT+33(1),OPTSAVE+2                                0299
*         FUNCFLGS=OPTSAVE(4);      /* RESTORE OLT FUNCTIONAL FLAGS. */
         MVC   SCT+36(1),OPTSAVE+3                                0300
*         LEVELIND=LVLSAVE;         /* RESTORE LEVEL OF PRINTING. */
         MVC   LEVELIND(1),LVLSAVE                                0301
*         CELOOPCT=ELSAVE;          /* RESTORE C.E. ERROR LOOP COUNT. *
         MVC   SCT(2),ELSAVE                                      0302
*         TLCOUNT=TLSAVE;           /* RESTORE C.E. TEST LOOP COUNT. */
         MVC   TLCOUNT(2),TLSAVE                                  0303
*         IF OPTERR='1'B THEN            /*  NO MESSAGE         S20203*
         TM    A00019,B'00000100'                                 0304
*           GOTO CECOPT62;               /* BRANCH AROUND MSG   S20203*
         BC    01,CECOPT62                                        0305
*  DO I=2 TO 10 BY 1;                    /* CHECK FOR UPTO 10 BY M4501*
         LA    @7,2                                               0306
*    IF INPUTBUF(2)='/'×                 /* CHECK FOR SLASH      M4501*
*         INPUTBUF(2)=','×               /* CHECK FOR COMMA      M4501*
*           INPUTBUF(2)=' ' THEN         /* CHECK FOR BLANK      M4501*
@DO9D1   CLI   1(@5),C'/'                                         0307
         BC    08,@9CD                                            0307
         CLI   1(@5),C','                                         0307
         BC    08,@9CC                                            0307
         CLI   1(@5),C' '                                         0307
         BC    07,@9CB                                            0307
*          DO;                           /* DELIMITER FOUND      M4501*
@9CC     EQU   *                                                  0308
*           INPUTBUF(2)=' ';             /* BLANK OUT DELIMITER  M4501*
@9CD     MVI   1(@5),C' '                                         0309
*         GOTO CECOPT38;                 /* GO SETUP MESSAGE     M4501*
         BC    15,CECOPT38                                        0310
*          END;                          /* SEARCH COMPLETE      M4501*
*    R5=R5+1;                            /* NEXT INPUT LOCATION  M4501*
@9CB     AH    @5,@D7                                             0312
*  END;                                  /* SEARCH COMPLETE      M4501*
* CECOPT38:                              /*                      M4501*
*  R5=SAVR5;                             /* RESTORE ADDRESS      M4501*
         AH    @7,@D7                                             0313
@DO9D0   CH    @7,@D11                                            0313
         BC    12,@DO9D1                                          0313
CECOPT38 L     @5,SAVR5                                           0314
*         RESTRICT(1);
*         R1=MSGPTR15;              /* GET POINTER TO MESSAGE IFD115I.*
         L     @1,8(0,@3)                                         0316
*         RELEASE (9);
*         IF TWOBYTE='1'B THEN           /* ADJUST FOR 2-BYTE   S20203*
         TM    SWITCHES,B'01000000'                               0318
         BC    12,@9CA                                            0318
*           I=I+2;                       /* OPT AT BEGINNING    S20203*
         LA    @7,2(0,@7)                                         0319
*         IF THREEB='1'B THEN            /* ADJUST FOR 3-BYTE   S20203*
@9CA     TM    SWITCHES,B'00100000'                               0320
         BC    12,@9C9                                            0320
*           I=I+3;                       /* OPT AT BEGINNING    S20203*
         LA    @7,3(0,@7)                                         0321
*         IF FOURBYTE='1'B THEN          /*                     S20203*
@9C9     TM    SWITCHES,B'00010000'                               0322
         BC    12,@9C8                                            0322
*           I=I+4;                       /*                     S20203*
         LA    @7,4(0,@7)                                         0323
*         IF I>10 THEN                   /* SET MAX VALUE FOR I S20203*
@9C8     CH    @7,@D11                                            0324
         BC    12,@9C7                                            0324
*           I=10;                        /* IF I > 10           S20203*
         LA    @7,10                                              0325
*  MSG115A(1)=' ';                       /* CLEAR BYT            M4501*
@9C7     MVI   38(@1),C' '                                        0326
*  MSG115A(2:10)=MSG115A(1:9);           /* CLEAR ARE            M4501*
         MVC   39(9,@1),38(@1)                                    0327
*  MSG115A(1:I)=INPUTBUF(1:I);           /* PUT ERROR INTO MESS  M4501*
         LR    @E,@5                                              0328
         LR    @9,@7                                              0328
         BCTR  @9,0                                               0328
         LA    @A,38(0,@1)                                        0328
         EX    @9,@MVC                                            0328
*         RESTRICT (9);
*         RELEASE(1);
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 *
         PWTO  REG=(1)
         DS    0H
*  CECOPT62:                             /*                     S20203*
*         TWOBYTE='0'B;                  /* ZERO 2-BYTE SWITCH  S20203*
CECOPT62 NI    SWITCHES,B'10001111'                               0332
*         THREEB='0'B;                   /* ZERO 3-BYTE SWITCH  S20203*
*         FOURBYTE='0'B;                 /*                     S20203*
*         OPTERR='0'B;                   /* ZERO FLAG           S20203*
         NI    A00019,B'11111011'                                 0335
*         RESTRICT(1);
*         IF RETAINAC='1'B THEN          /* IS REI ACTIVE?      S20203*
         TM    A00012,B'10000000'                                 0337
         BC    12,@9C6                                            0337
*           DPMSGREI='1'B;              /* REPLY TO NO DP MSGS  XM9156*
         OI    A00019,B'00000001'                                 0338
*         R1=MSGPTR61;              /* GET POINTER TO MESSAGE IFD161I.*
@9C6     L     @1,12(0,@3)                                        0339
*         RELEASE(1);
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 *
         PWTO  REG=(1)
         DS    0H
*         DPMSGREI='0'B;                /* TURN OFF DM MSG FLG  XM9156*
         NI    A00019,B'11111110'                                 0342
*         OPTERR='1'B;                   /* SET ERROR FLAG      S2020O*
         OI    A00019,B'00000100'                                 0343
*         GO TO CECOPT50;           /* GO TO ROUTINE THAT FORCES TEST*/
         BC    15,CECOPT50                                        0344
*                                   /* DEFINITION TO BE REDEFINED.   */
* CECOPT42:
*         /************************************************************
*         /*                                                          *
*         /*                    FINISH UP ROUTINE                     *
*         /*                                                          *
*         /************************************************************
*         R5=R4;                    /* PREPARE TO SCAN BUFR FOR BLANKS*
CECOPT42 LR    @5,@4                                              0345
*         R4=ADDR(PRTBUFR);         /* GET ADDRESS OF INBUFR END.     *
         LA    @4,PRTBUFR                                         0346
*         DO I=1 TO 72;             /* SCAN BUFFER.                   *
         LA    @7,1                                               0347
*           IF R5=R4 THEN           /* IS WHOLE BUFFER SCANNED. YES,  *
@DO9C5   CR    @5,@4                                              0348
*             GO TO CECOPT46;       /* FINISH UP.                     *
         BC    08,CECOPT46                                        0349
*           IF INPUTBUF(1)^=' ' THEN/*ERROR, RESTORE ALL PREVIOUS     *
         CLI   0(@5),C' '                                         0350
         BC    08,@9C1                                            0350
*             DO;                        /*                     S20203*
*             SAVR5=R5;                  /*                     S20203*
         ST    @5,SAVR5                                           0352
*             GO TO CECOPT33;       /* OPTIONS.                       *
         BC    15,CECOPT33                                        0353
*             END;                       /*                     S20203*
*           R5=R5+1;                /* POINT TO NEXT CHAR. IN INBUFR. *
@9C1     AH    @5,@D7                                             0355
*         END;
* CECOPT46:
*         IF MI='1'B & REMANS='1'B THEN  /* MI & RE BOTH        S20203*
         AH    @7,@D7                                             0356
@DO9C4   CH    @7,@D12                                            0356
         BC    12,@DO9C5                                          0356
CECOPT46 TM    SCT+36,B'10000000'                                 0357
         BC    12,@9C0                                            0357
         TM    A00016,B'00000100'                                 0357
         BC    12,@9BF                                            0357
*           DO;                          /*                     S20203*
*           R1=MSGPTXXX;                 /* GET MSG PTR         S20203*
         L     @1,16(0,@3)                                        0359
*           GEN(PWTO REG=(1));           /* PRINT MESSAGE       S20203*
         PWTO REG=(1)
         DS    0H
*         OPTERR='1'B;                   /* SET FLAG            S20203*
         OI    A00019,B'00000100'                                 0361
*           GOTO CECOPT33;               /* GO TO REDEFINE TEST S20203*
         BC    15,CECOPT33                                        0362
*           END;                         /*                     S20203*
*         /************************************************************
*         /*              PWTO OPTIONS THAT ARE SELECTED              *
*         /************************************************************
*         RESTRICT(1);
@9BF     EQU   *                                                  0364
*         R1=MSGPTR07;              /* GET POINTER TO MESSAGE IFD107I.*
@9C0     L     @1,4(0,@3)                                         0365
*         R8=R1+24;                 /* GET POINTER TO BEGINNING OF */
         LA    @8,24                                              0366
         AR    @8,@1                                              0366
*                                   /* OPTIONS IN MESSAGE IFD107I. */
*         DO R9=10 TO 1 BY -1;          /* CHECK FOR OPTIONS    X02008*
         LA    @9,10                                              0367
*         NOT='N';
@DO9BE   MVI   0(@8),C'N'                                         0368
*         R8=R8+4;                  /* STEP POINTER AND LOOP. */
         AH    @8,@D2                                             0369
*         END;
*         IF FRSTERR='1'B THEN      /* IS IT NFE.      */
         BCT   @9,@DO9BE                                          0370
         TM    SCT+2,B'00000001'                                  0371
         BC    12,@9BA                                            0371
*           MSG107I(21)=' ';        /* NO, BLANK OUT N.*/
         MVI   24(@1),C' '                                        0372
*         IF MI='1'B THEN           /* YES. IS IT NMI. */
@9BA     TM    SCT+36,B'10000000'                                 0373
         BC    12,@9B9                                            0373
*           MSG107I(25)=' ';        /* NO, BLANK OUT N.*/
         MVI   28(@1),C' '                                        0374
*         IF PP='1'B THEN           /* YES. IS IT NPP.          M1006*/
@9B9     TM    SCT+3,B'00010000'                                  0375
         BC    12,@9B8                                            0375
*           MSG107I(29)=' ';        /* NO, BLANK OUT N.*/
         MVI   32(@1),C' '                                        0376
*         IF TL='1'B THEN           /* YES. IS IT NTL. */
@9B8     TM    SCT+3,B'00000001'                                  0377
         BC    12,@9B7                                            0377
*           MSG107I(33)=' ';        /* NO, BLANK OUT N.*/
         MVI   36(@1),C' '                                        0378
*         IF EL='1'B THEN           /* YES. IS IT NEL. */
@9B7     TM    SCT+3,B'00000010'                                  0379
         BC    12,@9B6                                            0379
*           MSG107I(37)=' ';        /* NO, BLANK OUT N.*/
         MVI   40(@1),C' '                                        0380
*         IF NCP='1'B THEN          /* YES, IS IT NCP. */
@9B6     TM    SCT+3,B'00001000'                                  0381
         BC    12,@9B5                                            0381
*           MSG107I(41)=' ';        /* NO, BLANK OUT N.*/
         MVI   44(@1),C' '                                        0382
*         IF NEP='0'B THEN          /* YES. IS IT NEP. */
@9B5     TM    SCT+3,B'00000100'                                  0383
         BC    05,@9B4                                            0383
*           MSG107I(45)=' ';        /* NO, BLANK OUT N.*/
         MVI   48(@1),C' '                                        0384
*         IF NPR='1'B THEN          /* YES, IS IT NPR. */
@9B4     TM    SCT+2,B'00000100'                                  0385
         BC    12,@9B3                                            0385
*           MSG107I(49)=' ';        /* NO, BLANK OUT N.*/
         MVI   52(@1),C' '                                        0386
*         IF REMANS='1'B THEN            /* YES, IS IT NRE?     S20203*
@9B3     TM    A00016,B'00000100'                                 0387
         BC    12,@9B2                                            0387
*           MSG107I(53)=' ';             /* NO, BLANK OUT N     S20203*
         MVI   56(@1),C' '                                        0388
*         IF TR='1'B THEN               /* TRACE BIT ON?        X02008*
@9B2     TM    SCT+36,B'00000100'                                 0389
         BC    12,@9B1                                            0389
*          MSG107I(57)=' ';             /* ALTER MSG FOR TR.    X02008*
         MVI   60(@1),C' '                                        0390
*         IF PRNTOPTN='1'B THEN         /* PRINT OPTIONS HERE?        *
@9B1     TM    OLTEPSW5,B'00000001'                               0391
         BC    12,@9B0                                            0391
*          DO;                          /* SET UP FOR OPTION MSG      *
*          RELEASE(1);
*          GEN(PWTO REG=(1));           /* OUTPUT MESSAGE.            *
         PWTO REG=(1)
         DS    0H
*            IF EXTBUF(1)^='00'X THEN   /* IS BUFFER FILLED?    X02008*
         CLI   EXTBUF,X'00'                                       0395
         BC    08,@9AF                                            0395
*             DO;                       /* YES, CHECK NEXT CHAR.      *
*             RESTRICT(1);
*             R1=MSGPTR27;              /* ADDRESS EXT MSG.           *
         L     @1,20(0,@3)                                        0398
*             EXTMSG=EXTBUF(2:56);      /* SET UP MSG BUFFER    X02008*
         MVC   16(55,@1),EXTBUF+1                                 0399
*             GEN(PWTO REG=(1));        /* OUTPUT EXT BUFFER          *
         PWTO REG=(1)
         DS    0H
*             RETURN;
         BC    15,@EL01                                           0401
*             END;
*          RETURN;
*         END;
*         RELEASE(1);
*         IF UTCATAS='1'B THEN      /* IS REDEFINITION CAUSED BY   */
@9B0     TM    SCT+3,B'00100000'                                  0406
         BC    12,@9AE                                            0406
*           DO;                     /* RECOGNIZING OF CATASTROPHIC */
*                                   /* FAILURE.                    */
*           IF REINT='0'B THEN      /* YES, DID DEVICES AND OR   */
         TM    OLTEPSW,B'00000100'                                0408
         BC    05,@9AD                                            0408
*             UTCATAS='0'B;         /* TESTS CHANGE. NO, RESET   */
         NI    SCT+3,B'11011111'                                  0409
*                                   /* CATASTROPHIC BIT TO TELL  */
*                                   /* SCHEDULER REDEFINITION OF */
*                                   /* DEVICES&×TESTS DID NOT    */
*                                   /* OCCUR.                    */
*           GO TO CECOPT55;         /* RETURN TO IFDOLT30 AT THE */
         BC    15,CECOPT55                                        0410
*           END;                    /* POINT FISTERR6.           */
*         ELSE                      /* NO, DID DEVICES AND OR TESTS */
*         IF REINT='1'B THEN        /* CHANGE. YES, GO TO ROUTINE THAT*
@9AE     TM    OLTEPSW,B'00000100'                                0412
*           GO TO CECOPT43;         /* WILL CONTINUE TO FINISH UP.    *
         BC    01,CECOPT43                                        0413
* CECNP46A:
*
*
*         TALKHERE='0'B;                /* CLEAR CECOM TALK FLG X02008*
@9AC     EQU   *                                                  0414
CECNP46A NI    OLTEPSW8,B'11111110'                               0414
*                                       /* FOR USE NEXT COMM INTX02008*
*         IF FERINT^='1'B THEN      /* NO, IS REDEFINITION CAUSED BY */
         TM    OLTEPSW,B'00000010'                                0415
*           GO TO CECOPT45;         /* FIRST ERROR COMMUNICATION     */
         BC    12,CECOPT45                                        0416
*                                   /* INTERVAL. NO, CONTINUE.       */
*         IF NDCFO='1'B THEN        /* REISSUE OUTSTANDING WTOR FOR UT*
         TM    OLTEPSW2,B'10000000'                               0417
*           GO TO CECOPT45;
         BC    01,CECOPT45                                        0418
*         GO TO CECOPT55;           /* RETURN TO IFDOLT30 AT THE */
         BC    15,CECOPT55                                        0419
*                                   /* POINT FISTERR6.           */
* CECOPT43:/* CONTINUE FINISH UP ROUTINE */
*         SECTUSE='00'X;            /* CLEAR SECTIONS USED COUNTER. */
CECOPT43 MVI   SECTUSE,X'00'                                      0420
*         UNITUSE='00'X;            /* CLEAR UNITS USE COUNTER. */
         MVI   UNITUSE,X'00'                                      0421
*         TUCBAD1=DVTABUCB(1);      /* INITIALIZE UCB POINTER.*/
         L     @1,DEVTBPTR                                        0422
         MVC   TUCBAD1(4),8(@1)                                   0422
*         IF TPFLAG='1'B THEN       /* IS IT TPTEST.*/ /* FOR OLD */
         TM    OLTEPSW1,B'00000001'                               0423
*           GO TO CECOPT44;         /* YES, SET DEVDEPAD TO POINT */
         BC    01,CECOPT44                                        0424
*                                   /* TO CHASCT+20.              */
*         DEVDEPAD=ADDR(CHASCT)+8;  /* INITIALIZE  DEVDEPAD */
         LA    @F,CHASCT+8                                        0425
         ST    @F,DEVDEPAD                                        0425
*         REGX=ADDR(DVTABUCB(1));   /* AND REGX             */
         LA    @F,8(0,@1)                                         0426
         ST    @F,REGX                                            0426
*         GO TO CECOPT45;
         BC    15,CECOPT45                                        0427
* CECOPT44: /* FOR OLD TP */
*         DEVDEPAD=ADDR(CHASCT)+20;
CECOPT44 LA    @F,CHASCT+20                                       0428
         ST    @F,DEVDEPAD                                        0428
*         REGX=ADDR(DVTABUCB(2));
         L     @1,DEVTBPTR                                        0429
         LA    @F,64(0,@1)                                        0429
         ST    @F,REGX                                            0429
*         TUCBAD2=DVTABUCB(2);
         MVC   TUCBAD2(4),64(@1)                                  0430
* CECOPT45:
*         /************************************************************
*         /*                                                          *
*         /*      GIVE USER DYNAMIC COMMUNICATION POSSIBILITY         *
*         /*                                                          *
*         /************************************************************
*         IF INITENT='0'B THEN      /* IS THIS THE INITIAL ENTRY.     *
CECOPT45 TM    OLTEPSW2,B'00001000'                               0431
         BC    05,@9AB                                            0431
*           DO;                     /* YES,                           *
*           ECB3POST='1'B;          /* FAKE POSTING ECB3.             *
         OI    ECB,B'01000000'                                    0433
*           INITENT='1'B;           /* INDICATE THAT FURTHER ENTRIES  *
         OI    OLTEPSW2,B'00001000'                               0434
*           END;                    /* WILL NOT BE INITIAL ENTRIES.   *
*         IF ECB3POST^='0'B THEN    /* HAS USER ABILITY TO FORCE */
@9AB     TM    ECB,B'01000000'                                    0436
         BC    08,@9AA                                            0436
*           DO;                     /* COMMUNICATION WITH OLTEP. NO */
*           ECB3=ECB3&&ECB3;        /* CLEAR ECB3 AND GIVE IT TO HIM*/
         XC    ECB3(4),ECB3                                       0438
*           REPLYAD=ADDR(DYNCOM);   /* GET NECESSARY INFORMATION */
         LA    @F,DYNCOM                                          0439
         ST    @F,WTOR104D                                        0439
*           REPLYLEN='01'X;         /* TO ISSUE WTOR.            */
         MVI   WTOR104D,X'01'                                     0440
*           ECB3ADDR=ADDR(ECB3);
         LA    @F,ECB3                                            0441
         ST    @F,WTOR104D+4                                      0441
*         IF RETAINAC='1'B               /* REI ACTIVE          S20203*
*           & REMANS='0'B                /* ONSITE IN CHARGE    S20203*
*               THEN DPMSGREI='1'B;     /* NO REPLY TO DP MSGS  XM9156*
         TM    A00012,B'10000000'                                 0442
         BC    12,@9A9                                            0442
         TM    A00016,B'00000100'                                 0442
         BC    05,@9A8                                            0442
         OI    A00019,B'00000001'                                 0443
*         EXECOUT='1'B;                  /* MSG 104E ISSUED     S20203*
@9A8     EQU   *                                                  0444
@9A9     OI    A00012,B'00000010'                                 0444
*         REPLY00='1'B;                  /* SET REPLY00 FLAG    S20203*
         OI    A00019,B'10000000'                                 0445
*           RESTRICT(1);
*           R1=MSGPTR04;            /* GET POINTER TO MESSAGE IFD104D.*
         L     @1,0(0,@3)                                         0447
*           MSGPRFX=WTOR104D;       /* PUT INFORMATION IN MESSAGE. */
         MVC   0(8,@1),WTOR104D                                   0448
*           RELEASE(1);
*           GEN(PWTOR REG=(1),WAIT=NO);
         PWTOR REG=(1),WAIT=NO
         DS    0H
*         REPLY00='0'B;                  /* ZERO REPLY00 FLAG   S20203*
         NI    A00019,B'01111110'                                 0451
*         DPMSGREI='0'B;                /* TURN OFF DPMSG FLAG  XM9156*
*           END;
*         IF FERINT^='1'B THEN      /* IS THIS DYNAMIC COMMUNICATION. *
@9AA     TM    OLTEPSW,B'00000010'                                0454
*           GO TO CECOPT56;         /* NO, RETURN NORMALLY.           *
         BC    12,CECOPT56                                        0455
*         GO TO CECOPT55;           /* YES, RETURN TO OLTEP SCHEDULER.*
         BC    15,CECOPT55                                        0456
* CECOPT50:
*         /************************************************************
*         /*                                                          *
*         /*          RETURN AND REDEFINE TEST DEFINITION             *
*         /*                                                          *
*         /************************************************************
*         YOURR14=REDEFINE;         /* PREPARE TO RETURN TO IFDOLT30 */
CECOPT50 L     @1,4(0,@D)          
         MVC   12(4,@1),REDEFINE                                  0457
*                                   /* TO REDEFINE TEST.             */
*         GO TO CECOPT56;           /* RETURN */
         BC    15,CECOPT56                                        0458
* CECOPT55:
*         /************************************************************
*         /*                                                          *
*         /*         RETURN AFTER COMMUNICATION INTERVAL              *
*         /*                                                          *
*         /************************************************************
*         IF REINT='1'B THEN        /* SHOULD CONTROL RETURN TO U.T.  *
CECOPT55 TM    OLTEPSW,B'00000100'                                0459
*           GO TO CECOPT56;         /* NO.                            *
         BC    01,CECOPT56                                        0460
*         YOURR14=COMMINT-4;        /* PREPARE TO RETURN.        21051*
         L     @F,COMMINT                                         0461
         SH    @F,@D2                                             0461
         L     @1,4(0,@D)          
         ST    @F,12(0,@1)                                        0461
*                                   /* AFTER COMMUNICATION INT  S20203*
* CECOPT56:
*         /************************************************************
*         /*                                                          *
*         /*                     RETURN TO CALLER                     *
*         /*                                                          *
*         /************************************************************
*         ONCOMM='0'B;                   /* ZERO ONCOMM FLG     S20203*
CECOPT56 NI    A00019,B'11011111'                                 0462
*         IF FERINT='1'B &               /* DYN COMM            S2020O*
*           OPTERR='1'B THEN             /* OPT ERROR           S2020O*
         TM    OLTEPSW,B'00000010'                                0463
         BC    12,@9A7                                            0463
         TM    A00019,B'00000100'                                 0463
*           GOTO CECOPT63;               /*                     S20203*
         BC    03,CECOPT63                                        0464
*         REINT='0'B;               /* CLEAR REINT INDICATOR. */
@9A6     EQU   *                                                  0465
@9A7     NI    OLTEPSW,B'11111011'                                0465
*         NDCFO='0'B;               /* CLEAR DYN. COMM. BYPASS FLAG.  *
         NI    OLTEPSW2,B'01111111'                               0466
*         FERINT='0'B;              /* CLEAR FERINT INDICATOR.        *
         NI    OLTEPSW,B'11111101'                                0467
*    CECOPT63:                           /*                     S20203*
*         OPTERR='0'B;                   /* ZERO ERROR FLAG     S2020O*
CECOPT63 NI    A00019,B'11111011'                                 0468
*         RETURN;
*         END;
@EL01    L     @D,4(0,@D)                                         0470
         LM    @E,@C,12(@D)                                       0470
         BCR   15,@E                                              0470
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D10     DC    F'32768'
@D1      DC    H'5'
@D2      DC    H'4'
@D3      DC    H'8'
@D4      DC    H'6'
@D5      DC    H'7'
@D6      DC    H'2'
@D7      DC    H'1'
@D8      DC    H'55'
@D9      DC    H'3'
@D11     DC    H'10'
@D12     DC    H'72'
@MVC     MVC   0(1,@A),0(@E)
@V1      DC    V(IFDMSG33)
         DS    0F
@C11     DC    C'EXT='
@C7      DC    C'0)'
@C8      DC    C'1)'
@C9      DC    C'2)'
@C10     DC    C'3)'
@C12     DC    C'I)'
         DS    0D
@DATA    EQU   *
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD
R1       EQU   00000001            FULLWORD POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD POINTER REGISTER
R4       EQU   00000004            FULLWORD POINTER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
R6       EQU   00000006            FULLWORD POINTER REGISTER
I        EQU   00000007            3  BYTE  POINTER REGISTER
J        EQU   00000008            3  BYTE  POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
K        EQU   00000009            3  BYTE  POINTER REGISTER
R9       EQU   00000009            3  BYTE  POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
R15      EQU   00000015            3  BYTE  POINTER REGISTER
MYSAVE   EQU   00000000            8 BYTE(S) ON WORD
A00000   EQU   MYSAVE+00000000     4 BYTE(S)
YOURR13  EQU   MYSAVE+00000004     FULLWORD POINTER
YOURSAVE EQU   00000000            16 BYTE(S) ON WORD
A00001   EQU   YOURSAVE+00000000   12 BYTE(S)
YOURR14  EQU   YOURSAVE+00000012   FULLWORD POINTER
INPUTBUF EQU   00000000            7 BYTE(S)
OPTSAVE  EQU   @DATA+00000072      4 BYTE(S)
ELSAVE   EQU   @DATA+00000076      HALFWORD INTEGER
TLSAVE   EQU   @DATA+00000078      HALFWORD INTEGER
LVLSAVE  EQU   @DATA+00000080      1 BYTE(S)
REISAVE  EQU   @DATA+00000081      1 BYTE(S)
SWITCHES EQU   @DATA+00000082      1 BYTE(S)
FSTSCN   EQU   SWITCHES+00000000   1 BIT(S)
TWOBYTE  EQU   SWITCHES+00000000   1 BIT(S)
THREEB   EQU   SWITCHES+00000000   1 BIT(S)
FOURBYTE EQU   SWITCHES+00000000   1 BIT(S)
         ORG   @DATA+00000083
OPTAB    EQU   *                   10*5 BYTE(S)
         DC    X'D5C6C5FE01'
         DC    X'D5D4C97F80'
         DC    X'D5D7D9FB04'
         DC    X'D5D7D7EF10'
         DC    X'D5E3D3FE01'
         DC    X'D5C5D3FD02'
         DC    X'D5C3D7F708'
         DC    X'D5C5D7FB04'
         DC    X'D5D9C5FB04'
         DC    X'D5E3D9FB04'
OPTION   EQU   OPTAB+00000000      3 BYTE(S)
A00023   EQU   OPTAB+00000000      1 BYTE(S)
OPTION1  EQU   OPTAB+00000001      2 BYTE(S)
AND      EQU   OPTAB+00000003      1 BYTE(S)
OR       EQU   OPTAB+00000004      1 BYTE(S)
NUMBERS  EQU   *                   10 BYTE(S)
         DC    C'0123456789'
NUMBER   EQU   00000000            1 BYTE(S)
AREA     EQU   @DATA+00000144      8 BYTE(S) ON DWORD
DUMMY    EQU   AREA+00000000       FULLWORD INTEGER
A00024   EQU   AREA+00000000       3 BYTE(S)
I3       EQU   AREA+00000003       1 BYTE(S)
CNVRT    EQU   @DATA+00000152      5 BYTE(S)
DEVTABLE EQU   00000000            896 BYTE(S) ON WORD
DEVICE   EQU   DEVTABLE+00000000   16*56 BYTE(S) ON WORD
A00028   EQU   DEVTABLE+00000000   8 BYTE(S)
DVTABUCB EQU   DEVTABLE+00000008   FULLWORD POINTER
MSGPTR   EQU   00000000            24 BYTE(S) ON WORD
MSGPTR04 EQU   MSGPTR+00000000     FULLWORD POINTER
MSGPTR07 EQU   MSGPTR+00000004     FULLWORD POINTER
MSGPTR15 EQU   MSGPTR+00000008     FULLWORD POINTER
MSGPTR61 EQU   MSGPTR+00000012     FULLWORD POINTER
MSGPTXXX EQU   MSGPTR+00000016     FULLWORD INTEGER
MSGPTR27 EQU   MSGPTR+00000020     FULLWORD INTEGER
MSG327   EQU   00000000            71 BYTE(S) ON WORD
A00029   EQU   MSG327+00000000     16 BYTE(S)
EXTMSG   EQU   MSG327+00000016     55 BYTE(S)
WTOR104D EQU   @DATA+00000160      8 BYTE(S) ON WORD
REPLYAD  EQU   WTOR104D+00000000   FULLWORD POINTER
REPLYLEN EQU   WTOR104D+00000000   1 BYTE(S)
ECB3ADDR EQU   WTOR104D+00000004   FULLWORD POINTER
MSG104   EQU   00000000            79 BYTE(S)
MSGPRFX  EQU   MSG104+00000000     8 BYTE(S)
A00030   EQU   MSG104+00000008     4 BYTE(S)
MSG104D  EQU   MSG104+00000012     67 BYTE(S)
MSG107   EQU   00000000            55 BYTE(S) ON WORD
A00031   EQU   MSG107+00000000     4 BYTE(S)
MSG107I  EQU   MSG107+00000004     51 BYTE(S)
NEGMSG   EQU   00000000            1 BYTE(S) ON WORD
NOT      EQU   NEGMSG+00000000     1 BYTE(S)
SAVR5    EQU   @DATA+00000168      FULLWORD POINTER
MSG115A  EQU   00000038            10 BYTE(S)
         ORG   @DATA
         DS    00000172C
@TEMPS   DS    0F
OPTCOMM  IFDCOM
SCT      EQU   CHASCT+00000000     37 BYTE(S) ON WORD
CELOOPCT EQU   SCT+00000000        HALFWORD INTEGER
TESTOPT  EQU   SCT+00000002        2 BYTE(S)
OPTBYT   EQU   SCT+00000002        1 BYTE(S)
A00002   EQU   SCT+00000002        5 BIT(S)
NPR      EQU   SCT+00000002        1 BIT(S)
INDEFLP  EQU   SCT+00000002        1 BIT(S)
FRSTERR  EQU   SCT+00000002        1 BIT(S)
OPTBYTE  EQU   SCT+00000003        1 BYTE(S)
A00003   EQU   SCT+00000003        2 BIT(S)
UTCATAS  EQU   SCT+00000003        1 BIT(S)
PP       EQU   SCT+00000003        1 BIT(S)
NCP      EQU   SCT+00000003        1 BIT(S)
NEP      EQU   SCT+00000003        1 BIT(S)
EL       EQU   SCT+00000003        1 BIT(S)
TL       EQU   SCT+00000003        1 BIT(S)
A00004   EQU   SCT+00000004        29 BYTE(S)
EXPGMFLG EQU   SCT+00000033        1 BYTE(S)
CECOMRPL EQU   SCT+00000033        1 BIT(S)
MOREONE  EQU   SCT+00000033        1 BIT(S)
ROUTINES EQU   SCT+00000033        1 BIT(S)
ELCOUNT  EQU   SCT+00000033        1 BIT(S)
FINAL    EQU   SCT+00000033        1 BIT(S)
CLEANUP  EQU   SCT+00000033        1 BIT(S)
A00005   EQU   SCT+00000034        2 BYTE(S)
FUNCFLGS EQU   SCT+00000036        1 BYTE(S)
MI       EQU   SCT+00000036        1 BIT(S)
CLNUPPRV EQU   SCT+00000036        1 BIT(S)
A00006   EQU   SCT+00000036        3 BIT(S)
TR       EQU   SCT+00000036        1 BIT(S)
OLTEPSW  EQU   CESWT+00000000      1 BYTE(S)
LEGALTST EQU   OLTEPSW+00000000    1 BIT(S)
A00007   EQU   OLTEPSW+00000000    3 BIT(S)
LEGALDEV EQU   OLTEPSW+00000000    1 BIT(S)
REINT    EQU   OLTEPSW+00000000    1 BIT(S)
FERINT   EQU   OLTEPSW+00000000    1 BIT(S)
FERCOM   EQU   OLTEPSW+00000000    1 BIT(S)
OLTEPSW1 EQU   CESWT1+00000000     1 BYTE(S)
A00008   EQU   OLTEPSW1+00000000   7 BIT(S)
TPFLAG   EQU   OLTEPSW1+00000000   1 BIT(S)
OLTEPSW2 EQU   CESWT2+00000000     1 BYTE(S)
NDCFO    EQU   OLTEPSW2+00000000   1 BIT(S)
A00009   EQU   OLTEPSW2+00000000   3 BIT(S)
INITENT  EQU   OLTEPSW2+00000000   1 BIT(S)
OLTEPSW5 EQU   CESWT5+00000000     1 BYTE(S)
A00010   EQU   OLTEPSW5+00000000   7 BIT(S)
PRNTOPTN EQU   OLTEPSW5+00000000   1 BIT(S)
OLTEPSW8 EQU   CESWT8+00000000     1 BYTE(S)
A00011   EQU   OLTEPSW8+00000000   7 BIT(S)
TALKHERE EQU   OLTEPSW8+00000000   1 BIT(S)
A00012   EQU   CESWTR+00000000     1 BYTE(S)
RETAINAC EQU   A00012+00000000     1 BIT(S)
A00013   EQU   A00012+00000000     1 BIT(S)
REMNOMSG EQU   A00012+00000000     1 BIT(S)
A00014   EQU   A00012+00000000     3 BIT(S)
EXECOUT  EQU   A00012+00000000     1 BIT(S)
A00015   EQU   A00012+00000000     1 BIT(S)
A00016   EQU   CESWTR1+00000000    1 BYTE(S)
A00017   EQU   A00016+00000000     5 BIT(S)
REMANS   EQU   A00016+00000000     1 BIT(S)
A00018   EQU   A00016+00000000     2 BIT(S)
A00019   EQU   CESWTR2+00000000    1 BYTE(S)
REPLY00  EQU   A00019+00000000     1 BIT(S)
A00020   EQU   A00019+00000000     1 BIT(S)
ONCOMM   EQU   A00019+00000000     1 BIT(S)
A00021   EQU   A00019+00000000     2 BIT(S)
OPTERR   EQU   A00019+00000000     1 BIT(S)
A00022   EQU   A00019+00000000     1 BIT(S)
DPMSGREI EQU   A00019+00000000     1 BIT(S)
LEVELIND EQU   DPLEVEL+00000000    1 BYTE(S)
TLRUN    EQU   TLCOUNT+00000006    HALFWORD INTEGER
ECB      EQU   ECB3+00000000       4 BYTE(S)
A00025   EQU   ECB+00000000        1 BYTE(S)
A00026   EQU   ECB+00000000        1 BIT(S)
ECB3POST EQU   ECB+00000000        1 BIT(S)
PGMTBL   EQU   PGMTAB+00000000     8 BYTE(S)
SECLIST  EQU   SECLST+00000000     10 BYTE(S)
A00027   EQU   SECLIST+00000000    2 BYTE(S)
SECLST2  EQU   SECLIST+00000002    8 BYTE(S)
OPSYS    EQU   SATAB+00000000      1 BYTE(S)
@DATEND  EQU   *
@9F6     EQU   CECOPT30
@9F5     EQU   CECOPT33
@9EF     EQU   CECOPT33
@9E8     EQU   CECOPT31
@9D8     EQU   CECOPT33
@9D7     EQU   CECOPT25
@9D3     EQU   CECOPT31
@9D6     EQU   CECOPT33
@9D5     EQU   CECOPT33
@9AF     EQU   @EL01
@9AD     EQU   CECOPT55
         END    ,(C'PL/S',1400,78045)

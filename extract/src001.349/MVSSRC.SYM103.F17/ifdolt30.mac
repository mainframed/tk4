         TITLE 'IFDOLT30 CE COMMUNICATIONS ROOT MODULE'
         TITLE 'IFDOLT30 C.E. COMMUNICATIONS ROOT MODULE'
         LCLA  &T,&SPN                                            0002
.@001    ANOP                                                     0002
IFDOLT30 CSECT ,                                                  0002
         BC    15,24(0,@F)
         DC    C'IFDOLT30 01 MAR 77'                             0002
         ST    @E,12(0,@D)                                        0002
         STM   @0,@C,20(@D)                                       0002
         BALR  @B,0                                               0002
@PSTART  DS    0H                                                 0002
         USING @PSTART+00000,@B                                   0002
         ST    @D,@SAV001+4                                       0002
         LA    @F,@SAV001                                         0002
         ST    @F,8(0,@D)                                         0002
         LR    @D,@F                                              0002
         ENTRY ECB
         ENTRY CECINP02
         ENTRY CECINP03
         ENTRY CNTRLREC
         ENTRY SYMLIB
         DS    0H
*         GEN(USING CHASCT,2);
         USING CHASCT,2
         DS    0H
*         GENERATE DATA;
*         /************************************************************
*         /*                                                          *
*         /*                        DECLARES                          *
*         /*                                                          *
*         /************************************************************
*         DCL R0 REG(0) PTR(31);
*         DCL R1 REG(1) PTR(31);
*         DCL R2 REG(2) PTR(31);
*         DCL I REG(5) PTR(24);
*         DCL R6 REG(6) PTR(31);         /* REGISTER 6.               *
*         DCL R7 REG(7) PTR;             /*                      M4506*
*         DCL R8 REG(8) PTR(31);
*         DCL SLASHCNT REG(9) PTR(24);
*         DCL RETCODE REG(9) PTR(24);
*         DCL R9 REG(9) PTR(31);
*         DCL SA REG(13) PTR(31);
*         DCL R13 REG(13) PTR(31);
*         DCL R14 REG(14) PTR(31);
*         DCL R15 REG(15) PTR(31);
*         DCL RC REG(15) PTR(24);
*         DCL SAVE4 PTR(31) BASED(R13+4);
*         DCL SECLST CHAR(138) GENERATED;
*         DCL SOSPRUN CHAR(4) BASED(ADDR(SECLST)+3) ;/*SOSP IN SYSTEM?*
*                                        /*                     S20203*
*         DCL 1 CDSBLDL BASED(ADDR(SECLST)),
*               3 ENTRIES FIXED(15),
*               3 LENGTH FIXED(15),
*               3 NAME CHAR(8);
*         DCL TPSAVE CHAR(4) GENERATED;
*  DCL ECB FIXED;                        /* WTOR ECB                  *
*         DCL UNICTR PTR(8) GEND;
*         DCL DEVTBPTR PTR(31) GENERATED; /* PTR TO DEV TABLES.  21050*
*  DCL TABLNGTH FIXED(15) GENERATED;     /* DEVICE TABLE SIZE         *
*  DCL 1 * BASED(R8),                    /* DEVICE TABLE              *
*         2 DVT CHAR(16),                /* TABLE AREA                *
*         2 DVTN CHAR(16);               /* NEXT TABLE AREA           *
*  DCL 1 STOPREI CHAR(7) INIT('STOPREI'), /* STOPREI CONSTANT         *
*         2 * CHAR(4),                   /* NA                        *
*         2 REI CHAR(3);                 /* REI CONSTANT              *
*  DCL 1 FECSA BASED(SA),                /* SAVE AREA                 *
*               3 * CHAR(4),
*               3 INTSAPTR PTR(31);
*         DCL 1 SVAREA BDY(WORD) BASED(ADDR(IFDOLT30)+20), /* SA      *
*               3 * CHAR(4),
*               3 SVR13 PTR(31);
*         DCL 1 INITSA BASED(SVR13),
*               3 * CHAR(8),
*               3 SAVAREAD PTR(31);
*         DCL INBUFR CHAR(72) GENERATED;
*         DCL INPUTBUF CHAR(72) BASED(ADDR(INBUFR));
*  DCL 1 * BASED(R8),                    /* BUFFER LOCATION           *
*         2 B1ST CHAR(1),                /* FIRST LOCATION            *
*         2 TESTTYPE CHAR(5),            /* TEST TYPE                 *
*           3 B2ND CHAR(1);              /* SECOND LOCATION           *
*         DCL CNTRLREC CHAR(92) GENERATED;
*         DCL SYMLIB CHAR(92) GENERATED; /* REMOTE CDS DCB       21051*
*         DCL OFLAGS BIT(8) BASED(ADDR(CNTRLREC)+48);
*         DCL CAN CHAR(1) INIT('FF'X);
*       DCL CANFLG CHAR(1);     /* SAVE CANCEL INDICATOR      @ZA08985*
*         DCL REPBUFLN CHAR(1) BASED(R1);/* REPLY BUFFER LENGTH.      *
*         DCL 1 MSGPTR BASED(R6),        /*-FORMAT OF MESSAGE MODULE--*
*               3 MSGPTR00 PTR(31),      /* POINTER TO MESSAGE IFD100I*
*               3 MSGPTR02 PTR(31),      /* POINTER TO MESSAGE IFD102I*
*               3 MSGPTR03 PTR(31),      /* POINTER TO MESSAGE IFD103I*
*               3 MSGPTR05 PTR(31),      /* POINTER TO MESSAGE IFD105D*
*               3 MSGPTR06 PTR(31),      /* POINTER TO MESSAGE IFD106I*
*               3 MSGPTR08 PTR(31),      /* POINTER TO MESSAGE IFD108I*
*               3 MSGPTR17 PTR(31),      /* POINTER TO MESSAGE IFD117I*
*               3 MSGPR166 PTR(31),      /* PTR TO MSG IFD166I  Y02008*
*               3 MSGPTR29 PTR(31),      /* POINTER TO MESSAGE IFD129I*
*               3 MSGPTR34 PTR(31),      /* PTR TO MSG IFD134I  Y02008*
*               3 MSGPR501 PTR(31),      /* PTR TO MSG IFD501I  Y02008*
*               3 MSGPTR57 PTR(31),      /* POINTER TO MESSAGE IFD157I*
*               3 MSGPTR58 PTR(31),      /* POINTER TO MESSAGE IFD158I*
*               3 MSGPTR59 PTR(31),      /* POINTER TO MESSAGE IFD159I*
*               3 MSGPTR60 PTR(31),      /* POINTER TO MESSAGE IFD160I*
*               3 MSGPTR61 PTR(31),     /* PTR TO MSG IFD161I   X02008*
*               3 * CHAR(56),
*               3 MSGPTR66 PTR(31),      /* PTR TO MSG IFD166I  X03008*
*               3 MSGPTR13 PTR(31),      /* PTR TO MSG IFD113I  YM3333*
*               3 MSGPTR99 PTR(31),      /* PTR TO MSG IFD899I  YM3333*
*               3 MSGPR260 PTR(31);      /* PTR TO MSG IFD260I  Y02068*
*         DCL 1 IFD100 BASED(R1),        /*-FORMAT OF MESSAGE IFD100I-*
*               3 * CHAR(4),             /* MSG. LENGTH & MCS FLAGS.  *
*               3 IFD100I CHAR(80);      /* MESSAGE TEXT.             *
*         DCL 1 * BASED(R1),       /*-FORMAT OF MESSAGE IFD899I-YM3333*
*               3 * CHAR(65),      /* OFFSET                    YM3333*
*               3 MSG899ID CHAR(2); /* MESSAGE VARABLE          YM3333*
*         DCL 1 MSSGE BASED(R1),
*               3 * CHAR(4),
*               3 MESSAGE1 CHAR(40);
*         DCL CESWT  CHAR(1) GENERATED;
*         DCL 1 OLTEPSW  CHAR(1) BASED(ADDR(CESWT)),
*           3 LEGALTST BIT(1),          /* LEGAL TEST ENTRY      M4832*
*           3 * BIT(3),
*               3 LEGALDEV BIT(1),
*               3 * BIT(1),
*               3 FERINT BIT(1);
*         DCL CESWT1 CHAR(1) GENERATED;  /*                     S20203*
*         DCL 1 OLTEPSW1 CHAR(1) BASED(ADDR(CESWT1)),         /*S20203*
*                3 RTNFLD BIT(1);   /* SET ON WHEN NEW RTNS DECODED OR
*                                   /* BY IFDOLT32 IF RTNS PRESENT
*                                        /*                     S20203*
*         DCL CESWT2 CHAR(1) GENERATED;
*         DCL 1 OLTEPSW2 CHAR(1) BASED(ADDR(CESWT2)),
*               3 NDCFO BIT(1),
*               3 * BIT(3),
*               3 INITENT BIT(1),
*               3 NDR BIT(1),
*               3 TAPEHDR BIT(1);
*         DCL CESWT3 CHAR(1) GENERATED;
*         DCL 1 OLTEPSW3 CHAR(1) BASED(ADDR(CESWT3)),
*           3 TALKVERB BIT(1),          /* TALK RQST BY CE MADE X02008*
*               3 BYPALDEV BIT(1),
*           3 * BIT(2),                  /* NA                   M4506*
*           3 SUSDEL BIT(1),             /* SUSPENDED DELETION   M4506*
*           3 * BIT(1),                  /* NA                   M4506*
*               3 CDSEXIST BIT(1);
*         DCL CESWT5 CHAR(1) GENERATED;
*         DCL 1 OLTEPSW5 CHAR(1) BASED(ADDR(CESWT5)),
*               3 * BIT(3),
*               3 DPRINTFL BIT(2),
*               3 * BIT(2),
*               3 PRNTOPTN BIT(1); /* PRINT OPTIONS FROM PREVIOUS 21050
*                                  /* DTO ENTRY, OR DEFAULT OPNS 21050*
*         DCL CESWT6 CHAR(1) GENERATED;
*         DCL 1 OLTEPSW6 CHAR(1) BASED(ADDR(CESWT6)),
*               3 UTSCAL BIT(1),         /* CALL NOT RESIDENT OLTEP.  *
*               3 ATM BIT(1);
*         DCL CESWT7 CHAR(1) GENERATED;
*         DCL 1 OLTEPSW7 CHAR(1) BASED(ADDR(CESWT7)), /*         21050*
*               3 * BIT(1),        /* NOT USED                   21050*
*               3 RETTO31 BIT(1),  /* RETURN TO IFDOLT31         21050*
*           3 REMOTE BIT(1),            /* REMOTE TP DEVICE      M4832*
*           3 * BIT(3),                                       /*X03008*
*           3 VIRTUAL BIT(1),           /*OLTEP LOADED VIRTUAL  X03008*
*           3 GOTINPUT BIT(1);          /* D/T/O/ ENTRY MADE     M4832*
*         DCL CESWT8 CHAR(1) GEND;      /* CESWT 8 IN COMM AREA X02008*
*
*         DCL 1 OLTEPSW8 CHAR(1) BASED(ADDR(CESWT8)),
*           3 * BIT(5),                                       /*X03008*
*           3 SUTMSG BIT(1),            /*OLT IN PROCESS        X03008*
*           3 * BIT(1),                                       /*X03008*
*           3 TALKHERE BIT(1);          /* TALK VERB ENTERED IN X02008*
*                                       /* IN THIS COMM INTVL.  X02008*
*         DCL CESWT9 CHAR(1) GEND;      /*CESWT 9 IN COMM AREA  X03008*
*         DCL 1 OLTEPSW9 CHAR(1) BASED(ADDR(CESWT9)),         /*X03008*
*               3 CDSEQU BIT(1),        /* CDS EQUATE           X03906*
*               3 RESENTB BIT(1),       /* RESIDENT ENTRY       X03906*
*               3 * BIT(1),                                   /*X03008*
*               3 MODEV BIT(1),         /*OLT TOBE RUN VIRTUAL  X03008*
*               3 MODER BIT(1),         /*OLT TOBE RUN REAL     X03008*
*               3 MIXDEV BIT(1),        /* SET SYMB 1ST INPUT   X03008*
*               3 * BIT(2);                                   /*X03008*
*         DCL CESWT10 CHAR(1) GEND;      /* CE SW 10 IN C A     Y02068*
*         DCL 1 OLTPSW10 CHAR(1) BASED(ADDR(CESWT10)),        /*Y02068*
*               3 MPSYS BIT(1),          /* OLTEP IN MP SYSTEM  Y02068*
*               3 AFFNSET BIT(1),        /* CPU AFFINITY SET    Y02068*
*               3 VERBCALL BIT(1),       /* VERB ENTERED        Y02068*
*               3 * BIT(5);              /* NOT LOOKED AT       Y02068*
*         DCL CESWTR CHAR(1) GENERATED;  /* RETAIN 370 SWITCHES S20203*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR)),  /*              S20203*
*               3 RETAINAC BIT(1),       /* REI ACTIVE          S20203*
*               3 REMERR BIT(1),         /* ERROR OCCURRED      S20203*
*               3 REMNOMSG BIT(1),       /* REMOTE NO MSG       S20203*
*               3 CENOMSG BIT(1),        /* ONSITE NO MSG       S20203*
*               3 PRTNOMSG BIT(1),       /* SYSOUT NO MSG       S20203*
*               3 IMRESP BIT(1),         /* IMMEDIATE RESP MSG  S20203*
*               3 EXECOUT BIT(1),        /* MSG IFD104E ISSUED  S20203*
*               3 CECOMOUT BIT(1);       /* MSG IFD154E ISSUED  S20203*
*         DCL CESWTR1 CHAR(1) GENERATED; /*                     S20203*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR1)),  /*             S20203*
*               3 ILLRESP BIT(1),        /* ILLEGAL RESP FROM R S20203*
*               3 EXECANS BIT(1),        /* REMOTE ANS IFD104E  S20203*
*               3 CECOMANS BIT(1),       /* REMOTE ANS IFD154E  S20203*
*               3 INFOMSG BIT(1),        /* CE TALK TO REMOTE   S20203*
*               3 RETRIEVE BIT(1),       /* MSG IN FROM REMOTE  S20203*
*               3 REMANS BIT(1),         /* REMOTE ANS IMMEDIAT S20203*
*               3 EDTOMSG BIT(1),        /* MSG IFD105D ISSUED  S20203*
*               3 * BIT(1);              /* NOT USED            S20203*
*         DCL CESWTR2 CHAR(1) GENERATED;    /* REI SWITCHES     S20203*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR2)),     /*          S20203*
*               2 * BIT(2),              /*                     S20203*
*               2 ONCOMM BIT(1),         /*                     S20203*
*               2 * BIT(5);              /*                     S20203*
*         DCL CECINP03 LABEL;            /*                     S20203*
*         DCL INBUFPTR PTR(31) GENERATED;
*         DCL SAVEBUF CHAR(72);         /* SAVE D/T/O/ ENTRY     M4832*
*         DCL CHASCT CHAR(116) GENERATED;
*         DCL 1 SCT BASED(ADDR(CHASCT)),
*               3 * CHAR(3),
*               3 FLAGS CHAR(1),
*                 5 SETERROR BIT(1),
*                 5 ASTERB BIT(1),
*                 5 UTCATAS BIT(1),      /*                     S20203*
*               3 RTNFLDXX CHAR(2),      /* NORMAL ROUTINE SELECTION  *
*                                        /* FIELD.              S20203*
*               3 * CHAR(27),            /* NOT LOOKED AT.      S20203*
*               3 EXPGMFLG CHAR(1),      /* EXECUTIVE PROGRAM FLAGS.  *
*                                        /*                     S20203*
*                 5 * BIT(2),            /* NOT LOOKED AT.      S20203*
*                 5 RTNSLCTN BIT(1),     /* ROUTINES SELECTED FLAG.   *
*                                        /*                     S20203*
*           3 * CHAR(2),
*           3 OLTFLGS CHAR(1),          /* OLT FLAGS            X02008*
*             5 * BIT(7),
*             5 TALKOLT BIT(1),         /* OLT CAN HANDLE TALK  X02008*
*           3 OLTFLG2 CHAR(1),          /* OLT FLAGS            X02008*
*             5 TALKCE BIT(1),          /* CE HAS NTRD TALK VERBX02008*
*           3 * CHAR(2),                /*                      X02008*
*               3 EXPANDED CHAR(30);     /* EXPANDED ROUTINE SELECTION*
*                                        /* FIELD.              S20203*
*         DCL ZUESUCB CHAR(2) GEND;      /* DEVICE EXPO IN C.A. X03008*
*         DCL ROPT CHAR(8) GENERATED;
*         DCL ROPTMIN2 CHAR(2) BASED(ADDR(ROPT)-2);
*         DCL REIDEBAD PTR BASED(ADDR(ROPT)+8);  /* REI DEB PTR S20203*
*         DCL TSTDEBAD PTR GENERATED;    /* PTR TO TEST DEB     S20203*
*         DCL SCHEDSA PTR(31) GENERATED;
*         DCL ADSVAREA PTR(31) GENERATED;
*         DCL DATPTR PTR(31) GENERATED;
*         DCL MSGMOD PTR(31) GENERATED;
*         DCL IFDOLT48 LABEL NONLOCAL EXTERNAL;
*         RESTRICT(1,2,5,6,7,8,9);
*         DCL TALK CHAR(4) INIT('TALK');/* COMPARE FOR TALK VERBX02008*
*
*         DCL 1 PARMLIST CHAR(16) BDY(WORD), /* LIST FOR LOADER X02008*
*           3 CDSNAME CHAR(8),          /* NAME OF MOD TO LOAD. X02008*
*           3 LOADPT PTR,               /* LOAD ADDR FOR CDS    X02008*
*           3 PFLAGS CHAR(1),           /* LOADER FLAGS NEEDED  X02008*
*           3 * CHAR(1),
*           3 CDSSIZE CHAR(2);          /* SIZE OF MODULE TO LD X02008*
*
*  SVR13=INTSAPTR;                       /* SECOND SAVE AREA          *
         L     @3,@A1              ADDRESS OF IFDOLT30            0093
         MVC   24(4,@3),4(@D)                                     0093
*  SA=ADDR(SVAREA);                      /* SAVE AREA ADDRESS         *
         LA    @D,20(0,@3)                                        0094
*  ADSVAREA=SA;                          /* SAVE ADDRESS              *
         ST    @D,ADSVAREA                                        0095
*  SAVAREAD=SA;                          /* CHAINBACK ADDRESS         *
         L     @4,@A1              ADDRESS OF IFDOLT30            0096
         L     @4,24(0,@4)         SVAREA                         0096
         ST    @D,8(0,@4)                                         0096
*         CDSNAME='TCDSMDUM';           /* DUMMY CDS ENTRY. IF  X02008*
         MVC   PARMLIST(8),@C1                                    0097
*                                       /* IT EXISTS, CDS FILE  X02008*
*                                       /* IS PRESENT           X02008*
*         LOADPT=ADDR(LOADPT);          /* ADDR OF WHERE MOD LD X02008*
         LA    @F,PARMLIST+8                                      0098
         ST    @F,PARMLIST+8                                      0098
*         PFLAGS='60'X;                 /* COMPUTE, CDS FLGS SETX02008*
         MVI   PARMLIST+12,X'60'                                  0099
*         CDSSIZE='0001'X;              /* LOAD ONLY ONE BYTE   X02008*
         MVC   PARMLIST+14(2),@X3                                 0100
*
*
*         /*          ISSUE LOAD FOR DUMMY CDS MODULE           X02008*
*
*         GEN(IFDMOD CALL='12',LIST=PARMLIST);
         IFDMOD CALL='12',LIST=PARMLIST
         DS    0H
*
*         RETCODE=RC;
         LR    @9,@F                                              0102
*
*           /*        NON ZERO RETURN CODE ENDS OLTEP,NO CDS LOADED.  *
*
*         IF RETCODE ^= '00'X THEN  /* DID OPEN GO OK          XA01373*
         LA    @F,X'00'                                           0103
         CR    @F,@9                                              0103
         BC    08,@9FF                                            0103
*            DO;                    /*  ISSUE A TOTAL CLEANUP  XA01373*
*             ROPTMIN2 = '00';      /* IF NO OPEN, SET MYID    XA01373*
         MVC   ROPTMIN2(2),@C4                                    0105
*             R0 = ADDR(ROPT);      /* SET ROPT ADDRESS        XA01373*
         LA    @0,ROPT                                            0106
*             R1 = '14'X;           /* SET TOTAL CALL CODE     XA01373*
         LA    @1,X'14'                                           0107
*             GEN( SVC 59);         /* ISSUE SVC TO EFFECT CLEANS01373*
          SVC 59
         DS    0H
*             R6 = MSGMOD;          /* PTR TO MSG MOD FOR WTO   YM3333*
         L     @6,MSGMOD                                          0109
*             R1 = MSGPTR99;      /* PTR TO MSG IFD899I FOR WTO YM3333*
         L     @1,128(0,@6)                                       0110
*             IF MSG899ID(2) ^= '4' THEN /* HAS MSG BEEN ISSUED BEFORE*
         CLI   66(@1),C'4'                                        0111
         BC    08,@9FE                                            0111
*               DO;                        /* NO, NOW ISSUE IT  YM3333*
*                 MSG899ID(2) = '2';    /* MSG IDENT            YM3333*
         MVI   66(@1),C'2'                                        0113
*                 GEN(PWTO   REG=(1));  /* ISSUE MSG IFD899I    YM3333*
         PWTO   REG=(1)
         DS    0H
*               END;                                          /*YM3333*
*             GO TO CECINP17;       /* AND EXIT MOD            XA01373*
         BC    15,CECINP17                                        0116
*            END;                   /* END OF DO LOOP          XA01373*
*
*    CDSEXIST='1'B;                      /* CDS EXISTS INDICATED      *
@9FF     OI    OLTEPSW3,B'00000010'                               0118
*    IF MPSYS = '1'B THEN                /* IS OLTEP IN MP SYSTMY02068*
         TM    OLTPSW10,B'10000000'                               0119
         BC    12,@9FD                                            0119
*      DO;                               /* YES, SET SEFAULT AFFY02068*
*      VERBCALL = '0'B;                  /* SET TO INDICATE DEF Y02068*
         NI    OLTPSW10,B'10011111'                               0121
*      AFFNSET  = '0'B;                  /* SET TO NOT SET      Y02068*
*        GEN;                            /* CALL IFDOLT62 AFFN  Y02068*
         IFDMOD CALL='62'                * SET DEFAULT AFFINITY Y02068*
         IFDMOD DELETE='62'              * DELETE MODULE        Y02068*
         DS    0H
*        IF  AFFNSET='0'B THEN           /* AND AFFINIY NOT SET Y02068*
         TM    OLTPSW10,B'01000000'                               0124
*           GOTO CECINP17;               /*CANCEL EXIT FROM AFFNY02068*
         BC    08,CECINP17                                        0125
*      END;                              /* CONTINUE PROCESSING Y02068*
* CECINP01:
*         /************************************************************
*         /*             CAN CONTROL RECORD INPUT BE USED             *
*         /************************************************************
*  GEN(OPEN  (CNTRLREC,(INPUT),SYMLIB,(INPUT))); /* CONTROL AND REMOTE*
@9FD     EQU   *                                                  0127
CECINP01 OPEN  (CNTRLREC,(INPUT),SYMLIB,(INPUT))
         DS    0H
*                                      /* INPUT DATA SET.     */
* CECINP02:
*         /************************************************************
*         /*             DID CONTROL RECORD DATA SET OPEN             *
*         /************************************************************
*         IF OFLAGS(4)='0'B THEN    /* WAS THERE A SUCCESSFUL OPEN. */
CECINP02 TM    OFLAGS,B'00010000'                                 0128
*           GO TO CECINP03;         /* NO, GET INPUT FROM CONSOLE. */
         BC    08,CECINP03                                        0129
*         ONCOMM='0'B;                   /* ZERO ONCOMM SWITCH  S20203*
         NI    A00028,B'11011111'                                 0130
*         IF RETAINAC='1'B               /* REI ACTIVE          S20203*
*           & REMANS='1'B                /* RE OPTION           S20203*
*               THEN GOTO CECINP03;      /* BRANCH              S20203*
         TM    A00025,B'10000000'                                 0131
         BC    12,@9FC                                            0131
         TM    A00026,B'00000100'                                 0131
         BC    03,CECINP03                                        0132
*         R9=ADDR(INPUTBUF);
@9FB     EQU   *                                                  0133
@9FC     LA    @9,INPUTBUF                                        0133
*         GEN;                      /* READ A RECORD */
          READ  CNTLDECB,SF,CNTRLREC,(9),'S'
          CHECK CNTLDECB
         DS    0H
*         R6=MSGMOD;                /* GET POINTER TO MESSAGE MODULE. *
         L     @6,MSGMOD                                          0135
*         R1=MSGPTR00;              /* GET POINTER TO MESSAGE.        *
         L     @1,0(0,@6)                                         0136
*         IFD100I(9:80)=INPUTBUF;   /* PUT RECORD READ INTO MESSAGE.  *
         MVC   12(72,@1),INPUTBUF                                 0137
*         GEN(BAL   R7,CECPWTO);         /* ISSUE WTO            M4506*
         BAL   R7,CECPWTO
         DS    0H
*         ONCOMM='1'B;                   /* CARD INPUT          S20203*
         OI    A00028,B'00100000'                                 0139
*         GO TO CECINP04;           /* LOOK AT INPUT. */
         BC    15,CECINP04                                        0140
* CECINP18:
*         /************************************************************
*         /*                       END OF FILE                        *
*         /************************************************************
*         GEN(CLOSE (CNTRLREC));    /* CLOSE CNTRLIN.                 *
CECINP18 CLOSE (CNTRLREC)
         DS    0H
* CECINP03:
*         /************************************************************
*         /*                                                          *
*         /*                 GET INPUT FROM CONSOLE                   *
*         /*                                                          *
*         /************************************************************
*  IF CDSEQU='1'B THEN                   /* CHECK INDICATOR     XM0088*
CECINP03 TM    OLTEPSW9,B'10000000'                               0142
         BC    12,@9FA                                            0142
*    DO;                                 /* CDS EQUATE REQUEST  XM0088*
*      GEN(IFDMOD CALL='49');            /* CALL MODULE         XM0088*
         IFDMOD CALL='49'
         DS    0H
*      GEN(IFDMOD DELETE='49');          /* DELETE MODULE       XM4982*
         IFDMOD DELETE='49'
         DS    0H
*      LEGALDEV='0'B;                    /* NO DEVICE ENTRY     XM0088*
         NI    OLTEPSW,B'11110111'                                0146
*      CDSEQU='0'B;                      /* CDS EQUATES DONE    XM0088*
         NI    OLTEPSW9,B'01111111'                               0147
*    END;                                /* END CHECK           XM0088*
*         NDCFO='1'B;                    /* NO DYN COMM ALLOWEDXA01054*
@9FA     OI    OLTEPSW2,B'10000000'                               0149
*         PRNTOPTN='1'B;           /* SET FLAG TO INDECATE PREVIOUS OR*
         OI    OLTEPSW5,B'00000001'                               0150
*                                  /* DEFAULT OPTIONS  PRINTED   PRIOR
*                                  /* TO DTO MESSAGE OUTPUT.     21050*
*         GEN;
CL33OPTN IFDMOD CALL='33'
         DS    0H
*         GEN;
DLT33    IFDMOD DELETE='33'             DELETE IFDOLT33
         DS    0H
*         PRNTOPTN='0'B;           /* RESET OPTN PRNT FLAG.      21050*
         NI    OLTEPSW5,B'11111110'                               0153
*         ECB=ECB&&ECB;                /* CLEAR ECB.    */
         XC    ECB(4),ECB                                         0154
*         INPUTBUF(1)=' ';          /* CLEAR INBUFR.                  *
         MVI   INPUTBUF,C' '                                      0155
*         INPUTBUF(2:72)=INPUTBUF(1:71);
         MVC   INPUTBUF+1(71),INPUTBUF                            0156
*         /************************************************************
*         /*                                                          *
*         /*                 PWTO MESSAGE IFD105D                     *
*         /*                                                          *
*         /************************************************************
*         R6=MSGMOD;                /* GET POINTER TO MESSAGE MODULE. *
         L     @6,MSGMOD                                          0157
*         R1=MSGPTR05;              /* GET POINTER TO MESSAGE IFD105D *
         L     @1,12(0,@6)                                        0158
*         REPBUFLN='48'X;           /* PUT REPLY BUFFER LENGTH IN     *
         MVI   0(@1),X'48'                                        0159
*                                   /* WTOR PARAMETER LIST.           *
*         REMERR='0'B;                   /* ZERO RE ERROR FLAG   M4502*
         NI    A00025,B'10111111'                                 0160
*         ONCOMM='0'B;                   /* ZERO FLAG           S20203*
         NI    A00028,B'11011111'                                 0161
*         EDTOMSG='1'B;                  /* IDENTIFY MSG        S20203*
         OI    A00026,B'00000010'                                 0162
*         GEN(PWTOR REG=(1),WAIT=YES);
         PWTOR REG=(1),WAIT=YES
         DS    0H
*         EDTOMSG='0'B;                  /* ZERO EDTOMSG FLAG   S20203*
         NI    A00026,B'11111101'                                 0164
* CECINP04:
*         NDCFO='1'B;               /* SET BYPASS FOR DYNAMIC COMM.   *
CECINP04 OI    OLTEPSW2,B'10000000'                               0165
*         INBUFPTR=ADDR(INBUFR);    /* INITIALIZE INBUFR POINTER. */
         LA    @F,INBUFR                                          0166
         ST    @F,INBUFPTR                                        0166
*         /************************************************************
*         /*                                                          *
*         /*             ARE 3 SLASH DELIMITERS PRESENT               *
*         /*                                                          *
*         /************************************************************
*         R8=ADDR(INPUTBUF);            /* ADDRESS INPUTBUFFER   M4832*
         LA    @8,INPUTBUF                                        0167
*         SLASHCNT=0;               /* INITIALIZE SLASH COUNTER. */
         SR    @9,@9                                              0168
*  DO I=72 BY -1 TO 1;                   /* SEARCH BUFFER             *
         LA    @5,72                                              0169
*    IF B1ST='/' THEN                    /* CHECK FOR SLASH           *
@DO9F9   CLI   0(@8),C'/'                                         0170
         BC    07,@9F5                                            0170
*           DO;
*           SLASHCNT=SLASHCNT+1;    /* YES, INCREMENT SLASH COUNTER. */
         LA    @9,1(0,@9)                                         0172
*           IF SLASHCNT=1&                  /* IS SLASH COUNTER A ONE *
*            B2ND^='/' THEN              /* AND TEST ENTERED          *
         CH    @9,@D1                                             0173
         BC    07,@9F4                                            0173
         CLI   1(@8),C'/'                                         0173
         BC    08,@9F3                                            0173
*              DO;                       /* SAVE TEST TYPE            *
*             IF TESTTYPE(1)='T'×
*                   TESTTYPE(1)='P'×
*                         TESTTYPE(1)='N'×
*                               TESTTYPE(1)='R' THEN
         CLI   1(@8),C'T'                                         0175
         BC    08,@9F2                                            0175
         CLI   1(@8),C'P'                                         0175
         BC    08,@9F1                                            0175
         CLI   1(@8),C'N'                                         0175
         BC    08,@9F0                                            0175
         CLI   1(@8),C'R'                                         0175
         BC    07,@9EF                                            0175
*               TPSAVE=TESTTYPE(2:5);
@9F0     EQU   *                                                  0176
@9F1     EQU   *                                                  0176
@9F2     MVC   TPSAVE(4),2(@8)                                    0176
         BC    15,@9EE                                            0177
*             ELSE
*               TPSAVE=TESTTYPE(1:4);
@9EF     MVC   TPSAVE(4),1(@8)                                    0177
*             END;
@9EE     EQU   *                                                  0178
*           END;
@9F3     EQU   *                                                  0179
@9F4     EQU   *                                                  0179
*        R8=ADDR(B2ND);                  /* NEXT CHARACTER            *
@9F5     LA    @8,1(0,@8)                                         0180
*  END;                                  /* NEXT CHARACTER            *
* CECINP4B:                             /* LABEL, SLASH CHECK   X02008*
*         IF SLASHCNT^=3 THEN           /* THREE SLASHES IN BUF XM5089*
         BCT   @5,@DO9F9                                          0181
CECINP4B CH    @9,@D2                                             0182
*           GO TO CECINP4A;             /* CHECK FOR SPECIALS   XM5089*
         BC    07,CECINP4A                                        0183
*         IF INPUTBUF(1:2)='//' &       /* SAME DEV AND TEST?    M4832*
*          LEGALDEV='1'B &              /* VALID DEV TO TEST     M4832*
*          LEGALTST='1'B THEN           /* VALID TEST ENTERED    M4823*
         CLC   INPUTBUF(2),@C16                                   0184
         BC    07,@9ED                                            0184
         TM    OLTEPSW,B'00001000'                                0184
         BC    12,@9EC                                            0184
         TM    OLTEPSW,B'10000000'                                0184
         BC    12,@9EB                                            0184
*           DO;                         /* YES, THEN SET UP      M4832*
*            INBUFPTR=INBUFPTR+1;       /* INPUT BUFFER FOR      M4832*
         LA    @F,1                                               0186
         A     @F,INBUFPTR                                        0186
         ST    @F,INBUFPTR                                        0186
*            GO TO CECINP15;            /* OPTION DECODE,DYN COM M4832*
         BC    15,CECINP15                                        0187
*           END;
*         IF FERINT='1'B THEN           /* 1ST ERROR, DYN COMM?  M4832*
@9EB     EQU   *                                                  0189
@9EC     EQU   *                                                  0189
@9ED     TM    OLTEPSW,B'00000010'                                0189
         BC    12,@9EA                                            0189
*          DO;                          /* YES, SETUP FOR OLT    M4832*
*           SAVEBUF=INPUTBUF;           /* CLEANUP BY SAVING BUFRM4832*
         MVC   SAVEBUF(72),INPUTBUF                               0191
*           GOTINPUT='1'B;              /* SET BIT ON,SET UP FOR M4832*
         OI    OLTEPSW7,B'00000001'                               0192
*           GO TO CECINP09;             /* OLT SCHEDULER.        M4832*
         BC    15,CECINP09                                        0193
*          END;
*         GO TO CECINP07;               /* CONTINUE DECODING BUFXM5089*
* CECINP4A:
*         /************************************************************
*         /*                                                          *
*         /*         LOOK FOR SPECIAL ENTRIES                         *
*         /*                                                          *
*         /************************************************************
*                                        /* CPUAFFN VERB CHECK  Y02068*
*         IF INPUTBUF(1:8)^='CPUAFFN=' THEN/* IF AFFN VERB NOT  Y02068*
CECINP4A CLC   INPUTBUF(8),@C17                                   0196
*           GOTO CECINP4D;               /* ENTERED CHECK NEXT  Y02068*
         BC    07,CECINP4D                                        0197
*         IF FERINT='1'B                 /* IF THIS IS FIRST ERRY02068*
*           × UTCATAS='1'B THEN          /* REPLY OR CATASTROFICY02068*
         TM    OLTEPSW,B'00000010'                                0198
         BC    01,@9E9                                            0198
         TM    SCT+3,B'00100000'                                  0198
         BC    12,@9E8                                            0198
*             GOTO CECINP4D;             /* CPUAFFN REQ INVALID Y02068*
         BC    03,CECINP4D                                        0199
*         IF RETAINAC='1'B               /* IF REI ACTIVE & THISY02068*
*           & ONCOMM='0'B THEN           /* IS NOT A ONSITE COMMY02068*
@9E8     TM    A00025,B'10000000'                                 0200
         BC    12,@9E7                                            0200
         TM    A00028,B'00100000'                                 0200
*             GOTO CECINP4D;             /* CPUAFFN REQUEST NO GY02068*
         BC    10,CECINP4D                                        0201
*         IF MPSYS='0'B THEN             /* IF IS CHECK IF MP   Y02068*
@9E6     EQU   *                                                  0202
@9E7     TM    OLTPSW10,B'10000000'                               0202
         BC    05,@9E5                                            0202
*           DO;                          /* SYSTEM IF NOT THEN  Y02068*
*             R1 = MSGPR260;             /* ISSUE MSG IFD260I   Y02068*
         L     @1,132(0,@6)                                       0204
*             GEN(BAL   R7,CECPWTO);     /* VERB NOT VALID      Y02068*
         BAL   R7,CECPWTO
         DS    0H
*             GOTO CECINP03;             /* REDEFINE E DTO MSG  Y02068*
         BC    15,CECINP03                                        0206
*           END;                         /* IFD105D             Y02068*
*         VERBCALL = '1'B;               /* INDICATE THIS IS VRBY02068*
@9E5     OI    OLTPSW10,B'00100000'                               0208
*         AFFNSET = '0'B;                /* SHOW AFFN NOT SET   Y02068*
         NI    OLTPSW10,B'10111111'                               0209
*         GEN;                           /* GOTO CPU AFFINITY   Y02068*
         IFDMOD CALL='62'                * CALL IFDOLT62        Y02068*
         IFDMOD DELETE='62'              * DELETE MODULE        Y02068*
         DS    0H
*         IF AFFNSET = '1'B THEN         /* COMPLETE?           Y02068*
         TM    OLTPSW10,B'01000000'                               0211
*           GOTO CECINP02;               /* YES, READ NEXT      Y02068*
         BC    01,CECINP02                                        0212
*         IF  AFFNSET='0'B THEN          /* NO  AFFINIY NOT SET Y02068*
         TM    OLTPSW10,B'01000000'                               0213
*           GOTO CECINP17;               /*CANCEL EXIT FROM AFFNY02068*
         BC    08,CECINP17                                        0214
* CECINP4D:                                                   /*Y02068*
*                                        /* ELSE EQU VERB CHECK Y02068*
*  IF RETAINAC='1'B&                     /* REI ACTIVE          XM0088*
*    ONCOMM='0'B THEN                    /* NOT ONSITE          XM0088*
CECINP4D TM    A00025,B'10000000'                                 0215
         BC    12,@9E4                                            0215
         TM    A00028,B'00100000'                                 0215
*      GOTO CECINP4C;                    /* EQUATE NOT ALLOWED  XM0088*
         BC    10,CECINP4C                                        0216
*  IF INPUTBUF(1:3)='EQU' THEN           /* CHECK REPLY         XM0088*
@9E3     EQU   *                                                  0217
@9E4     CLC   INPUTBUF(3),@C18                                   0217
         BC    07,@9E2                                            0217
*    DO;                                 /* CDS EQUATE REQUEST  XM0088*
*      CDSEQU='1'B;                      /* INDICATE CDS EQUATE XM0088*
         OI    OLTEPSW9,B'10000000'                               0219
*      IF FERINT='1'B THEN               /* CHECK INDICATOR     XM0088*
         TM    OLTEPSW,B'00000010'                                0220
*        GOTO CECINP09;                  /* DYN COMMUNICATIONS  XM0088*
         BC    01,CECINP09                                        0221
*      GOTO CECINP02;                    /* ISSUE WTOR          XM0088*
         BC    15,CECINP02                                        0222
*    END;                                /* END REPLY CHECK     XM0088*
* CECINP4C:                              /* LABEL               XM0088*
*  IF INPUTBUF(1:3)^=REI THEN            /* IS REI SPECIFIED          *
@9E2     EQU   *                                                  0224
CECINP4C CLC   INPUTBUF(3),STOPREI+4                              0224
*    GOTO CECINP20;                      /* NO CONTINUE               *
         BC    07,CECINP20                                        0225
*         IF RETAINAC='1'B THEN          /* IF REI ALREADY      S20203*
         TM    A00025,B'10000000'                                 0226
*           GOTO CECINP02;               /* GO REDEFINE TEST    S20203*
         BC    01,CECINP02                                        0227
*  GEN;
CL54     IFDMOD CALL='54'               MODULE CALL               M4506
DLT54    IFDMOD DELETE='54'             DELETE IFDOLT54
         DS    0H
*         IF RETAINAC='0'B THEN          /* NO REI GOTO CONSOLE S20203*
         TM    A00025,B'10000000'                                 0229
*           GOTO CECINP03;               /*                     S20203*
         BC    08,CECINP03                                        0230
*         GOTO CECINP02;                 /* GO REDEFINE TEST    S20203*
         BC    15,CECINP02                                        0231
*  CECINP20:                             /*                     S20203*
*  IF INPUTBUF(1:7)^=STOPREI THEN        /* IS STOPREI ENTERED        *
CECINP20 CLC   INPUTBUF(7),STOPREI                                0232
*           GOTO CECINP21;               /* NO CONTINUE         S20203*
         BC    07,CECINP21                                        0233
*         IF RETAINAC='0'B THEN          /* IF REI NOT ACTIVE   S20203*
         TM    A00025,B'10000000'                                 0234
*           GOTO CECINP02;               /* GO REDEFINE TEST    S20203*
         BC    08,CECINP02                                        0235
*  GEN;
CL56     IFDMOD CALL='56'               MODULE CALL               M4506
DLT56    IFDMOD DELETE='56'             DELETE IFDOLT56
         DS    0H
*         GOTO CECINP02;                 /* GO REDEFINE TEST    S20203*
         BC    15,CECINP02                                        0237
*  CECINP21:                             /*                     S20203*
*         IF INPUTBUF(1:3)^='CAN' THEN /* IS CANCEL SPECIFIED. */
CECINP21 CLC   INPUTBUF(3),@C19                                   0238
*           GO TO CECINP05;           /* NO, CONTINUE.        */
         BC    07,CECINP05                                        0239
*         IF RETAINAC='1'B               /* REI ACTIVE          S20203*
*           & ONCOMM='0'B THEN           /* NOT ONSITE DYN COMM S20203*
         TM    A00025,B'10000000'                                 0240
         BC    12,@9E1                                            0240
         TM    A00028,B'00100000'                                 0240
*           GOTO CECINP02;               /* GO REDEFINE TEST    S20203*
         BC    10,CECINP02                                        0241
*         IF RETAINAC='1'B THEN          /* IS REI ACTIVE.      S20203*
@9E0     EQU   *                                                  0242
@9E1     TM    A00025,B'10000000'                                 0242
         BC    12,@9DF                                            0242
*           DO;                          /* YES.                S20203*
*  GEN(BAL   R14,CL56+4);                /* MODULE IDENTITY      M4506*
         BAL   R14,CL56+4
         DS    0H
*  GEN(BAL   R14,DLT56+4);               /* DELETE IFDOLT56           *
         BAL   R14,DLT56+4
         DS    0H
*           END;                         /* CONTINUE            S20203*
*         INPUTBUF(1)=CAN;          /* PUT CANCEL INDICATOR IN INBUFR.*
@9DF     MVC   INPUTBUF(1),CAN                                    0247
*         IF FERINT='1'B×           /* IS A TEST STILL IN PROCESS. */
*               UTCATAS='1'B THEN   /* YES, FREE IT UP AND BY-PASS */
         TM    OLTEPSW,B'00000010'                                0248
         BC    01,@9DE                                            0248
         TM    SCT+3,B'00100000'                                  0248
         BC    12,@9DD                                            0248
*           DO;                     /* ALL OTHERS.                 */
*           BYPALDEV='1'B;          /* SET BYPASS FLAG ON. */
@9DE     OI    OLTEPSW3,B'01000000'                               0250
*  GEN;                                                     /*@ZA16985*
         L     R13,SCHEDSA        /* SET UP TO GO */           @ZA16985
         BC    15,@EL01+4         /* TO SCHEDULER */           @ZA16985
         DS    0H
*           END;
*         GO TO CECINP16;           /* CLEAN-UP. */
         BC    15,CECINP16                                        0253
* CECINP05:
*
*         /*          DOES CE  WISH TO 'TALK' TO THE OLT?       X02008*
*
*         IF INPUTBUF(1:4)^=TALK THEN   /* IS TALK SPECIFIED?   X02008*
CECINP05 CLC   INPUTBUF(4),TALK                                   0254
*           GO TO CECINP19;             /* NO, GO ON.           X02008*
         BC    07,CECINP19                                        0255
*         IF FERINT='0'B &              /* NOT DYN COM OR FIRST X02008*
*           UTCATAS='0'B THEN           /* ERROR OR CATAS ERROR X02008*
         TM    OLTEPSW,B'00000010'                                0256
         BC    05,@9DC                                            0256
         TM    SCT+3,B'00100000'                                  0256
*           GO TO CECINP19;             /* COMM THEN GO  OUTPUT X02008*
         BC    10,CECINP19                                        0257
*                                       /* IFD106I MESSAGE.     X02008*
*         TALKVERB='1'B;                /* TALK VERB ENTERED.   X02008*
@9DB     EQU   *                                                  0258
@9DC     OI    OLTEPSW3,B'10000000'                               0258
*
*         /* CAN THE OLT ENTERED HANDLE THE TALK FACILITY?      X02008*
*
*         IF TALKOLT='1'B THEN          /* CAN OLT HANDLE TALK? X02008*
         TM    SCT+36,B'00000001'                                 0259
         BC    12,@9DA                                            0259
*           DO;                         /* YES,                 X02008*
*             TALKCE='1'B;              /* TURN ON FLAG FOR CE. X02008*
         OI    SCT+37,B'10000000'                                 0261
*             TALKHERE='1'B;            /* SET SWITCH, TALK ENT X02008*
         OI    OLTEPSW8,B'00000001'                               0262
*             GO TO CECINP15;           /* CONT.--ISSUE MSG 104 X02008*
         BC    15,CECINP15                                        0263
*           END;                        /* END LOOP.            X02008*
*
*         R1=MSGPTR66;                  /* ADDRESS TALK MSG.    X02008*
@9DA     L     @1,120(0,@6)                                       0265
*         GEN(BAL R7,CECPWTO);          /* ISSUE MESSAGE        X02008*
         BAL R7,CECPWTO
         DS    0H
*         TALKHERE='1'B;                /* SET SWITCH, TALK ENT X02008*
         OI    OLTEPSW8,B'00000001'                               0267
*         GO TO CECINP15;               /* CONTINUE DECODE PROCEX02008*
         BC    15,CECINP15                                        0268
* CECINP19:                             /* LABEL                X02008*
*         /************************************************************
*         /*                                                          *
*         /*                 IS PROMPTING SPECIFIED                   *
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1:6)='PROMPT' THEN /* IS PROMPTING DESIRED. */
CECINP19 CLC   INPUTBUF(6),@C20                                   0269
         BC    07,@9D9                                            0269
*           DO;                          /* YES, IS IT A VALID    */
*           IF INPUTBUF(8)='A'×          /* REQUEST. YES, PROMPT. */
*                 INPUTBUF(8)='D'×       /* NO, CONTINUE.         */
*                       INPUTBUF(8)='T'×
*                             INPUTBUF(8)='O' THEN
         CLI   INPUTBUF+7,C'A'                                    0271
         BC    08,@9D8                                            0271
         CLI   INPUTBUF+7,C'D'                                    0271
         BC    08,@9D7                                            0271
         CLI   INPUTBUF+7,C'T'                                    0271
         BC    08,@9D6                                            0271
         CLI   INPUTBUF+7,C'O'                                    0271
         BC    07,@9D5                                            0271
*             DO;
@9D6     EQU   *                                                  0272
@9D7     EQU   *                                                  0272
@9D8     EQU   *                                                  0272
*  GEN;
CL50     IFDMOD CALL='50'               MODULE CALL               M4506
DLT50    IFDMOD DELETE='50'             DELETE IFDOLT50
         DS    0H
*             GO TO CECINP03;
         BC    15,CECINP03                                        0274
*             END;
*           END;
@9D5     EQU   *                                                  0276
*         /************************************************************
*         /*                                                          *
*         /*                 PWTO MESSAGE IFD106I                     *
*         /*                                                          *
*         /************************************************************
*         R1=MSGPTR06;              /* MESSAGE IFD106I. */
@9D9     L     @1,16(0,@6)                                        0277
*         GEN(BAL   R7,CECPWTO);         /* ISSUE WTO            M4506*
         BAL   R7,CECPWTO
         DS    0H
*         GO TO CECINP03;           /* TRY AGAIN. */
         BC    15,CECINP03                                        0279
* CECINP06:
*         /************************************************************
*         /*                                                          *
*         /*            REWRITE TAPE LABELS AND CLEAN UP              *
*         /*                                                          *
*         /************************************************************
*         TAPEHDR='1'B;             /* REWRITE TAPE LABELS.           *
CECINP06 OI    OLTEPSW2,B'00000010'                               0280
*            CANFLG = INPUTBUF(1); /* SAVE CAN FLAG           @ZA08985*
         MVC   CANFLG(1),INPUTBUF                                 0281
*         R15=DATPTR;
         L     @F,DATPTR                                          0282
*         GEN(BALR  14,15);
         BALR  14,15
         DS    0H
*            INPUTBUF(1)=CANFLG;  /* RESTORE CAN FLG          @ZA08985*
         MVC   INPUTBUF(1),CANFLG                                 0284
* CECINP6A:                              /*                     S20203*
*         TAPEHDR='0'B;                  /* RESET TAPE LABEL FLGS20203*
CECINP6A NI    OLTEPSW2,B'11111101'                               0285
*         IF REMOTE='1'B THEN       /* REMOTE TERMINAL IN D/T/O/.     *
         TM    OLTEPSW7,B'00100000'                               0286
         BC    12,@9D4                                            0286
*           DO;                     /* YES, DISABLE ANY UP LINES.     *
*      GEN(IFDMOD CALL='74',LIST=0);     /* DISABLE                   *
         IFDMOD CALL='74',LIST=0
         DS    0H
*      GEN(IFDMOD DELETE='74');          /* DELETE MODULE       XM4982*
         IFDMOD DELETE='74'
         DS    0H
*           END;                    /* END DISABLE PROCEEDURE.        *
*         ROPTMIN2='00';            /* ISSUE SVC 59 TO CLEAN UP. */
@9D4     MVC   ROPTMIN2(2),@C4                                    0291
*         IF RETAINAC='1'B THEN          /* IF REI ACTIVE       S20203*
         TM    A00025,B'10000000'                                 0292
         BC    12,@9D3                                            0292
*           REIDEBAD=TSTDEBAD+128;       /* PTR TO REI DEB      S20203*
         LA    @F,128                                             0293
         A     @F,TSTDEBAD                                        0293
         ST    @F,REIDEBAD                                        0293
         BC    15,@9D2                                            0294
*           ELSE REIDEBAD=0;             /* NO. SET TO ZERO     S20203*
@9D3     SR    @F,@F                                              0294
         ST    @F,REIDEBAD                                        0294
*         R0=ADDR(ROPT);
@9D2     LA    @0,ROPT                                            0295
*
*         IF INPUTBUF(1)^=CAN           /* CAN IN INPUT BUFR    XM0097*
*         THEN                          /* NO ISSUE SVC FOR     XM0097*
         CLC   INPUTBUF(1),CAN                                    0296
         BC    08,@9D1                                            0296
*         R1='8014'X;                   /* PARTIAL CLEANUP.     XM0097*
         L     @1,@X24                                            0297
         BC    15,@9D0                                            0298
*         ELSE                          /* YES,  TOTAL CLEANUP. XM0097*
*         R1='14'X;
@9D1     LA    @1,X'14'                                           0298
*         GEN(SVC   59);                /* GO CLEAN UP          X03008*
@9D0     EQU   *                                                  0299
         SVC   59
         DS    0H
*         ZUESUCB=ZUESUCB&&ZUESUCB;    /* CLEAN UP DEVICE EXPO  X03008*
         XC    ZUESUCB(2),ZUESUCB                                 0300
*         GO TO R8;                 /* RETURN.                        *
         BCR   15,@8                                              0301
* CECINP07:
*         /************************************************************
*         /*                HAS A DEVICE BEEN ENTERED                 *
*         /************************************************************
*         IF INPUTBUF(1)='/' THEN   /* HAS A DEVICE BEEN ENTERED. */
CECINP07 CLI   INPUTBUF,C'/'                                      0302
*           GO TO CECINP08;         /* NO, CONTINUE. */
         BC    08,CECINP08                                        0303
*         IF INPUTBUF(1:2)='.N' THEN
         CLC   INPUTBUF(2),@C25                                   0304
*           GOTO CECINP22;               /* YES. BRANCH         S20203*
         BC    08,CECINP22                                        0305
*         IF RETAINAC='1'B               /*                     S20203*
*           & ONCOMM='0'B THEN           /*                     S20203*
         TM    A00025,B'10000000'                                 0306
         BC    12,@9CF                                            0306
         TM    A00028,B'00100000'                                 0306
*               GOTO CECINP13;           /* REMOTE ANSWERED     S20203*
         BC    10,CECINP13                                        0307
*  CECINP22:                             /*                     S20203*
*         IF INITENT='1'B × LEGALDEV='1'B THEN                /*YM6196*
@9CE     EQU   *                                                  0308
@9CF     EQU   *                                                  0308
CECINP22 TM    OLTEPSW2,B'00001000'                               0308
         BC    01,@9CD                                            0308
         TM    OLTEPSW,B'00001000'                                0308
         BC    12,@9CC                                            0308
*                            /* YES, IS IT THE INITIAL ENTRY.   YM6196*
*           DO;                     /* NO, CLEAN-UP BY REWRITING TAPE *
@9CD     EQU   *                                                  0309
*           GEN(BAL   R8,CECINP06); /* REWRITE TAPE LABELS AND CLEANUP*
         BAL   R8,CECINP06
         DS    0H
*                                   /* LABELS, BY ISSUEING SVC 59 AND *
*                                   /* CLEARING THE DEVTABLE.         *
*         REIDEBAD=0;                   /* CLEAR ROPT DEB ADDR  XM6301*
         SR    @F,@F                                              0311
         ST    @F,REIDEBAD                                        0311
*  R8=DEVTBPTR;                          /* DEVICE TABLES             *
         L     @8,DEVTBPTR                                        0312
*  DO R9=TABLNGTH BY -1 TO 1;            /* TABLE LENGTH              *
         LH    @9,TABLNGTH                                        0313
         LTR   @9,@9                                              0313
         BC    12,@DO9CA                                          0313
*    DVT=DVT&&DVT;                       /* ZERO TABLE AREA           *
@DO9CB   XC    0(16,@8),0(@8)                                     0314
*    R8=ADDR(DVTN);                      /* NEXT TABLE AREA           *
         LA    @8,16(0,@8)                                        0315
*  END;                                  /* ZERO TOTAL TABLE          *
*           DPRINTFL='00'B;         /* CLEAR DPRINT INTERNAL FLAGS.   *
         BCT   @9,@DO9CB                                          0316
@DO9CA   NI    OLTEPSW5,B'11100111'                               0317
*           END;
*         GO TO CECINP09;           /* CONTINUE. */
         BC    15,CECINP09                                        0319
* CECINP08:
*         /************************************************************
*         /*                 HAS A TEST BEEN ENTERED                  *
*         /************************************************************
*         IF INPUTBUF(2)='/' THEN   /* HAS A TEST BEEN ENTERED. */
CECINP08 CLI   INPUTBUF+1,C'/'                                    0320
*           GO TO CECINP11;         /* NO, CONTINUE.            */
         BC    08,CECINP11                                        0321
* CECINP09:
*         /************************************************************
*         /*                SHOULD TESTS BE CANCELED                  *
*         /************************************************************
*         IF FERINT^='1'B THEN      /* IS THIS FIRST ERROR COMM. */
CECINP09 TM    OLTEPSW,B'00000010'                                0322
*           GO TO CECINP11;         /* NO, CONTINUE. */
         BC    12,CECINP11                                        0323
*         BYPALDEV='1'B;            /* BYPASS ALL TESTING. */
         OI    OLTEPSW3,B'01000000'                               0324
*         ATM='1'B;                 /* SET ABNORMAL TERMINATION */
         OI    OLTEPSW6,B'01000000'                               0325
*                                   /* MESSAGE FLAG ON.         */
*         TALKVERB='0'B;                /* ZERO TALKVERB FLAG   X02008*
         NI    OLTEPSW3,B'01111111'                               0326
*         TALKCE='0'B;                  /* ZERO TALK FLG IN SCT X02008*
         NI    SCT+37,B'01111111'                                 0327
*         ASTERB = '1'B;               /* TERMINATE OLT WITH * T MSG  *
         OI    SCT+3,B'01000000'                                  0328
*  GEN;                                                     /*@ZA16985*
         L     R13,SCHEDSA      /* SET UP TO GO */             @ZA16985
         BC    15,@EL01+4       /* TO SCHEDULER */             @ZA16985
         DS    0H
* CECINP10:
*         FERINT='0'B;              /* CLEAR FERINT INDICATOR. */
CECINP10 NI    OLTEPSW,B'11111101'                                0330
*         SETERROR='0'B;            /* CLEAR ERROR BIT IN SCT. */
         NI    SCT+3,B'01111111'                                  0331
*         ATM='0'B;                 /* CLEAR ATM FLAG. */
         NI    OLTEPSW6,B'10111111'                               0332
*         BYPALDEV='0'B;            /* CLEAR BYPASS ALL DEVICES FLAG. *
         NI    OLTEPSW3,B'10111111'                               0333
*  IF CDSEQU='1'B THEN                   /* CHECK INDICATOR     XM0088*
         TM    OLTEPSW9,B'10000000'                               0334
*    GOTO CECINP02;                      /* CDS EQUATES         XM0088*
         BC    01,CECINP02                                        0335
*         IF GOTINPUT='1'B THEN         /* D/T/O/ ENTERED?       M4832*
         TM    OLTEPSW7,B'00000001'                               0336
         BC    12,@9C7                                            0336
*          DO;                          /* YES, RESET BIT TO ZEROM4832*
*           GOTINPUT='0'B;              /* AND RESTORE INBUT BUF M4832*
         NI    OLTEPSW7,B'11111110'                               0338
*           INPUTBUF=SAVEBUF;           /* FER, CONTINUE DECODINGM4832*
         MVC   INPUTBUF(72),SAVEBUF                               0339
*           GO TO CECINP04;             /* CHECK SLASH DELIMITERXM6301*
         BC    15,CECINP04                                        0340
*          END;                         /*                       M4832*
* CECINP11:
*         IF INPUTBUF(1)^='/' THEN  /* IS CHAR. A SLASH. */
@9C7     EQU   *                                                  0342
CECINP11 CLI   INPUTBUF,C'/'                                      0342
*           GO TO CECINP13;             /* DECODE DEVICE FIELD. SM2411*
         BC    07,CECINP13                                        0343
*         IF LEGALDEV^='1'B THEN    /* HAVE LEGAL DEVICES BEEN ENTERED*
         TM    OLTEPSW,B'00001000'                                0344
*           GO TO CECINP12;         /* PREVIOUSLY. NO, ERROR.         *
*         GO TO CECINP14;           /* DECODE TESTS. */
         BC    03,CECINP14                                        0346
* CECINP12:
*         /************************************************************
*         /*                                                          *
*         /*                 PWTO MESSAGE IFD108I                     *
*         /*                                                          *
*         /************************************************************
*         R1=MSGPTR08;              /* GET POINTER TO MESSAGE IFD108I.*
CECINP12 L     @1,20(0,@6)                                        0347
*         GEN(BAL   R7,CECPWTO);         /* ISSUE WTO            M4506*
         BAL   R7,CECPWTO
         DS    0H
*         R1=MSGPTR61;              /* GIVE MEANS OF PROMPTING, IF */
         L     @1,60(0,@6)                                        0349
*         GEN(BAL   R7,CECPWTO);         /* ISSUE WTO            M4506*
         BAL   R7,CECPWTO
         DS    0H
*         GO TO CECINP03;           /* CONTINUE. */
         BC    15,CECINP03                                        0351
* CECINP13:
*         /************************************************************
*         /*                                                          *
*         /*                     DECODE DEVICES                       *
*         /*                                                          *
*         /************************************************************
*         IF INPUTBUF(1)<'A'×       /* IS DEV ENTRY EQUAL TO    X03008*
*            INPUTBUF(1)>'Z' THEN   /* DEV ADDR OR SYMBOLIC     X03008*
CECINP13 CLI   INPUTBUF,C'A'                                      0352
         BC    04,@9C6                                            0352
         CLI   INPUTBUF,C'Z'                                      0352
         BC    12,@9C5                                            0352
*           MIXDEV='0'B;            /* ADDRESS ENTRY = DEV ADDR X03008*
@9C6     NI    OLTEPSW9,B'11111011'                               0353
         BC    15,@9C4                                            0354
*         ELSE                                                /*X03008*
*           MIXDEV='1'B;            /* SYMBOLIC ENTRY           X03008*
@9C5     OI    OLTEPSW9,B'00000100'                               0354
* CECIN13A:                         /* MORE ENTRIES DEV TABLE   X03008*
*         REMOTE='0'B;              /* NO REMOTE DEV DECODED YET. 21051
@9C4     EQU   *                                                  0355
CECIN13A NI    OLTEPSW7,B'11011111'                               0355
*  GEN;
CL31     IFDMOD CALL='31'               MODULE CALL               M4506
DLT31    IFDMOD DELETE='31'             DELETE IFDOLT31
         DS    0H
*         IF UNICTR=0×
*           NDR='1'B THEN
         CLI   UNICTR,0                                           0357
         BC    08,@9C3                                            0357
         TM    OLTEPSW2,B'00000100'                               0357
         BC    12,@9C2                                            0357
*           GO TO CECINP14;
         BC    03,CECINP14                                        0358
*         GEN;
@9C2     EQU   *                                                  0359
CL61     IFDMOD CALL='61'
DLT61    IFDMOD DELETE='61'             DELETE IFDOLT61
         DS    0H
*         IF RETTO31='1'B THEN     /* RETURN TO IFDOLT31,CONT DECODING*
         TM    OLTEPSW7,B'01000000'                               0360
*           GO TO CECIN13A;        /* DTO ENTRY & FILL DEV TABS.X03008*
         BC    01,CECIN13A                                        0361
* CECINP14:
*         /************************************************************
*         /*                                                          *
*         /*                      DECODE TEST SECTIONS
*         /*                                                          *
*         /************************************************************
*  GEN;
CECINP14 EQU   *                                                  0362
CL32     IFDMOD CALL='32'               MODULE CALL               M4506
DLT32    IFDMOD DELETE='32'             DELETE IFDOLT32
         DS    0H
*         IF RTNSLCTN='0'B & RTNFLD='1'B THEN DO; /* ROUTINES SELECTED*
         TM    SCT+33,B'00100000'                                 0363
         BC    05,@9C1                                            0363
         TM    OLTEPSW1,B'10000000'                               0363
         BC    12,@9C0                                            0363
*                                  /* IN IFDOLT32 BUT NOT DECODED YET?*
*                                        /*                     S20203*
*         /************************************************************
*         /*                                                          *
*         /*                   DECODE TEST ROUTINES                   *
*         /*                                                          *
*         /************************************************************
*  GEN;
CL38     IFDMOD CALL='38'               MODULE CALL               M4506
DLT38    IFDMOD DELETE='38'             DELETE IFDOLT38
         DS    0H
*         END;                           /*                     S20203*
* CECINP15:
*         /************************************************************
*         /*                                                          *
*         /*                     DECODE OPTIONS                       *
*         /*                                                          *
*         /************************************************************
*  GEN;
@9C0     EQU   *                                                  0367
@9C1     EQU   *                                                  0367
CECINP15 EQU   *                                                  0367
CL33     IFDMOD CALL='33'               MODULE CALL               M4506
DLTE33   IFDMOD DELETE='33'             DELETE IFDOLT33
         DS    0H
*         /************************************************************
*         /*                                                          *
*         /*                PERFORM DATA PROTECTION                   *
*         /*                                                          *
*         /************************************************************
*         R15=ADDR(IFDOLT48);       /* GET ADDRESS OF IFDOLT48.       *
         L     @3,@V2              ADDRESS OF IFDOLT48            0368
         LR    @F,@3                                              0368
*         GEN(BALR  14,15);         /* GO TO DATA PROTECTION.         *
         BALR  14,15
         DS    0H
* CECINP16:
*         /************************************************************
*         /*                                                          *
*         /*                     FINISH ROUTINE                       *
*         /*                                                          *
*         /************************************************************
*         IF FERINT='1'B&           /* SHOULD PROCESSING CONTINUE. */
*               ATM='1'B THEN       /* YES, START DECODING NEW ENTRY*/
CECINP16 TM    OLTEPSW,B'00000010'                                0370
         BC    12,@9BF                                            0370
         TM    OLTEPSW6,B'01000000'                               0370
*           GO TO CECINP10;
         BC    03,CECINP10                                        0371
*                                   /* NO, FINISH. */
*         IF INPUTBUF(1)^=CAN THEN  /* IS CANCEL IN INPUT BUFFER.     *
@9BE     EQU   *                                                  0372
@9BF     CLC   INPUTBUF(1),CAN                                    0372
*           GO TO CECINP02;         /* NO, GET NEXT TEST DEFINITION.  *
         BC    07,CECINP02                                        0373
*         GEN(BAL   R8,CECINP06);   /* REWRITE TAPE LABELS AND CLEANUP*
         BAL   R8,CECINP06
         DS    0H
* CECINP17:
*         R15=0;
CECINP17 SR    @F,@F                                              0375
*         R13=ADDR(SVAREA);
         L     @3,@A1              ADDRESS OF IFDOLT30            0376
         LA    @D,20(0,@3)                                        0376
*         RETURN;
         BC    15,@EL01                                           0377
*  GEN;
CECPWTO  PWTO  REG=(1)                  ISSUE WTO                 M4506
         DS    0H
*  GOTO R7;                              /* RESUME               M4506*
         BCR   15,@7                                              0379
*  GEN(DS     0H);
         DS     0H
         DS    0H
*  GOTO FISTERR6;                        /* DYNAMIC ENTRY             *
         BC    15,FISTERR6                                        0381
* FISTERR:
*         /************************************************************
*         /*                                                          *
*         /*   DYNAMIC, FIRST-ERROR OR CATASTROPHIC COMMUNICATION     *
*         /*                                                          *
*         /************************************************************
*         ENTRY;
FISTERR  ST    @E,12(0,@D)                                        0382
         STM   @0,@C,20(@D)                                       0382
         BALR  @B,0                                               0382
         LA    @F,FISTERR-IFDOLT30-24                             0382
         SR    @B,@F                                              0382
         ST    @D,@SAV001+4                                       0382
         LA    @F,@SAV001                                         0382
         ST    @F,8(0,@D)                                         0382
         LR    @D,@F                                              0382
*         RESTRICT(1,2,5,6,8,9);
*         IF FERINT='1'B                 /* FIRST ERROR COMM     M4502*
*           × REMERR='1'B THEN           /* REMOTE ERROR         M4502*
@9BD     TM    OLTEPSW,B'00000010'                                0384
         BC    01,@9BC                                            0384
         TM    A00025,B'01000000'                                 0384
         BC    12,@9BB                                            0384
*               GOTO CECINP23;           /* DONT ZERO SWITCHES   M4502*
         BC    03,CECINP23                                        0385
*         EXECOUT='0'B;                  /* ZERO EXECOUT FLAG   S20203*
@9BB     NI    A00025,B'11111101'                                 0386
*         EXECANS='0'B;                  /* ZERO EXECANS FLG    S20203*
         NI    A00026,B'10111111'                                 0387
*  CECINP23:                             /*                      M4502*
*         REMERR='0'B;                   /* ZERO ERROR FLAG     S20203*
CECINP23 NI    A00025,B'10111111'                                 0388
*         IF UTCATAS='1'B THEN      /* IS IT CATASTROPHIC COMM. */
         TM    SCT+3,B'00100000'                                  0389
*           DO;                     /* YES, PRINT MESSAGE IFD157I */
*                                   /* AND FIND OUT WHAT USER WANTS*/
*                                   /* TO DO.                      */
*           GO TO CECINP03;
         BC    03,CECINP03                                        0391
*           END;
*         FERINT='1'B;              /* INDICATE THIS IS DYNAMIC */
@9BA     OI    OLTEPSW,B'00000010'                                0393
*                                   /* COMMUNICATION.           */
*         GO TO CECINP03;
         BC    15,CECINP03                                        0394
* FISTERR6:
*  GEN(BAL   R14,DLTE33+4);              /* DELETE IFDOLT33           *
FISTERR6 BAL   R14,DLTE33+4
         DS    0H
*         RETURN;                   /* RETURN THROUGH DYNAMIC   */
*         END;                      /* COMMUNICATION SAVE AREA. */
@EL01    L     @D,4(0,@D)                                         0397
         L     @E,12(0,@D)                                        0397
         LM    @0,@C,20(@D)                                       0397
         BCR   15,@E                                              0397
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D1      DC    H'1'
@D2      DC    H'3'
@A1      DC    A(IFDOLT30)
@V2      DC    V(IFDOLT48)
         DS    0F
@C1      DC    C'TCDSMDUM'
@C17     DC    C'CPUAFFN='
@X24     DC    X'00008014'
@X3      DC    X'0001'
@C4      DC    C'00'
@C16     DC    C'//'
@C20     DC    C'PROMPT'
@C25     DC    C'.N'
@C18     DC    C'EQU'
@C19     DC    C'CAN'
         DS    0D
@DATA    EQU   *
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD
R0       EQU   00000000            FULLWORD POINTER REGISTER
R1       EQU   00000001            FULLWORD POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
I        EQU   00000005            3  BYTE  POINTER REGISTER
R6       EQU   00000006            FULLWORD POINTER REGISTER
R7       EQU   00000007            FULLWORD POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
SLASHCNT EQU   00000009            3  BYTE  POINTER REGISTER
RETCODE  EQU   00000009            3  BYTE  POINTER REGISTER
R9       EQU   00000009            FULLWORD POINTER REGISTER
SA       EQU   00000013            FULLWORD POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
R15      EQU   00000015            FULLWORD POINTER REGISTER
RC       EQU   00000015            3  BYTE  POINTER REGISTER
SAVE4    EQU   00000004            FULLWORD POINTER
ECB      EQU   @DATA+00000072      FULLWORD INTEGER
A00000   EQU   00000000            32 BYTE(S) ON WORD
DVT      EQU   A00000+00000000     16 BYTE(S)
DVTN     EQU   A00000+00000016     16 BYTE(S)
         ORG   @DATA+00000076
STOPREI  EQU   *                   7 BYTE(S)
         DC    C'STOPREI'
A00001   EQU   STOPREI+00000000    4 BYTE(S)
REI      EQU   STOPREI+00000004    3 BYTE(S)
FECSA    EQU   00000000            8 BYTE(S) ON WORD
A00002   EQU   FECSA+00000000      4 BYTE(S)
INTSAPTR EQU   FECSA+00000004      FULLWORD POINTER
SVAREA   EQU   IFDOLT30+00000020   8 BYTE(S) ON WORD
A00003   EQU   SVAREA+00000000     4 BYTE(S)
SVR13    EQU   SVAREA+00000004     FULLWORD POINTER
INITSA   EQU   00000000            12 BYTE(S) ON WORD
A00004   EQU   INITSA+00000000     8 BYTE(S)
SAVAREAD EQU   INITSA+00000008     FULLWORD POINTER
A00005   EQU   00000000            6 BYTE(S) ON WORD
B1ST     EQU   A00005+00000000     1 BYTE(S)
TESTTYPE EQU   A00005+00000001     5 BYTE(S)
B2ND     EQU   A00005+00000001     1 BYTE(S)
CAN      EQU   *                   1 BYTE(S)
         DC    X'FF'
CANFLG   EQU   @DATA+00000084      1 BYTE(S)
REPBUFLN EQU   00000000            1 BYTE(S)
MSGPTR   EQU   00000000            136 BYTE(S) ON WORD
MSGPTR00 EQU   MSGPTR+00000000     FULLWORD POINTER
MSGPTR02 EQU   MSGPTR+00000004     FULLWORD POINTER
MSGPTR03 EQU   MSGPTR+00000008     FULLWORD POINTER
MSGPTR05 EQU   MSGPTR+00000012     FULLWORD POINTER
MSGPTR06 EQU   MSGPTR+00000016     FULLWORD POINTER
MSGPTR08 EQU   MSGPTR+00000020     FULLWORD POINTER
MSGPTR17 EQU   MSGPTR+00000024     FULLWORD POINTER
MSGPR166 EQU   MSGPTR+00000028     FULLWORD POINTER
MSGPTR29 EQU   MSGPTR+00000032     FULLWORD POINTER
MSGPTR34 EQU   MSGPTR+00000036     FULLWORD POINTER
MSGPR501 EQU   MSGPTR+00000040     FULLWORD POINTER
MSGPTR57 EQU   MSGPTR+00000044     FULLWORD POINTER
MSGPTR58 EQU   MSGPTR+00000048     FULLWORD POINTER
MSGPTR59 EQU   MSGPTR+00000052     FULLWORD POINTER
MSGPTR60 EQU   MSGPTR+00000056     FULLWORD POINTER
MSGPTR61 EQU   MSGPTR+00000060     FULLWORD POINTER
A00006   EQU   MSGPTR+00000064     56 BYTE(S)
MSGPTR66 EQU   MSGPTR+00000120     FULLWORD POINTER
MSGPTR13 EQU   MSGPTR+00000124     FULLWORD POINTER
MSGPTR99 EQU   MSGPTR+00000128     FULLWORD POINTER
MSGPR260 EQU   MSGPTR+00000132     FULLWORD POINTER
IFD100   EQU   00000000            84 BYTE(S) ON WORD
A00007   EQU   IFD100+00000000     4 BYTE(S)
IFD100I  EQU   IFD100+00000004     80 BYTE(S)
A00008   EQU   00000000            67 BYTE(S) ON WORD
A00009   EQU   A00008+00000000     65 BYTE(S)
MSG899ID EQU   A00008+00000065     2 BYTE(S)
MSSGE    EQU   00000000            44 BYTE(S) ON WORD
A00010   EQU   MSSGE+00000000      4 BYTE(S)
MESSAGE1 EQU   MSSGE+00000004      40 BYTE(S)
SAVEBUF  EQU   @DATA+00000085      72 BYTE(S)
         ORG   @DATA+00000157
TALK     EQU   *                   4 BYTE(S)
         DC    C'TALK'
PARMLIST EQU   @DATA+00000164      16 BYTE(S) ON WORD
CDSNAME  EQU   PARMLIST+00000000   8 BYTE(S)
LOADPT   EQU   PARMLIST+00000008   FULLWORD POINTER
PFLAGS   EQU   PARMLIST+00000012   1 BYTE(S)
A00037   EQU   PARMLIST+00000013   1 BYTE(S)
CDSSIZE  EQU   PARMLIST+00000014   2 BYTE(S)
         ENTRY FISTERR
         ORG   @DATA
         DS    00000180C
@TEMPS   DS    0F
CNTRLREC DCB   DSORG=PS,BLKSIZE=80,DDNAME=CNTRLIN,DEVD=DA,             X
               EODAD=CECINP18,LRECL=80,MACRF=(R),RECFM=F,NCP=1,        X
               SYNAD=CECINP18                                  SA46803
SYMLIB   DCB   DDNAME=SYMSYM,DSORG=PO,RECFM=UT,BLKSIZE=3600,LRECL=80,  X
               MACRF=R
INPCOMM  IFDCOM
SOSPRUN  EQU   SECLST+00000003     4 BYTE(S)
CDSBLDL  EQU   SECLST+00000000     12 BYTE(S) ON WORD
ENTRIES  EQU   CDSBLDL+00000000    HALFWORD INTEGER
LENGTH   EQU   CDSBLDL+00000002    HALFWORD INTEGER
NAME     EQU   CDSBLDL+00000004    8 BYTE(S)
INPUTBUF EQU   INBUFR+00000000     72 BYTE(S)
OFLAGS   EQU   CNTRLREC+00000048   8 BIT(S) ON BYTE
OLTEPSW  EQU   CESWT+00000000      1 BYTE(S)
LEGALTST EQU   OLTEPSW+00000000    1 BIT(S)
A00011   EQU   OLTEPSW+00000000    3 BIT(S)
LEGALDEV EQU   OLTEPSW+00000000    1 BIT(S)
A00012   EQU   OLTEPSW+00000000    1 BIT(S)
FERINT   EQU   OLTEPSW+00000000    1 BIT(S)
OLTEPSW1 EQU   CESWT1+00000000     1 BYTE(S)
RTNFLD   EQU   OLTEPSW1+00000000   1 BIT(S)
OLTEPSW2 EQU   CESWT2+00000000     1 BYTE(S)
NDCFO    EQU   OLTEPSW2+00000000   1 BIT(S)
A00013   EQU   OLTEPSW2+00000000   3 BIT(S)
INITENT  EQU   OLTEPSW2+00000000   1 BIT(S)
NDR      EQU   OLTEPSW2+00000000   1 BIT(S)
TAPEHDR  EQU   OLTEPSW2+00000000   1 BIT(S)
OLTEPSW3 EQU   CESWT3+00000000     1 BYTE(S)
TALKVERB EQU   OLTEPSW3+00000000   1 BIT(S)
BYPALDEV EQU   OLTEPSW3+00000000   1 BIT(S)
A00014   EQU   OLTEPSW3+00000000   2 BIT(S)
SUSDEL   EQU   OLTEPSW3+00000000   1 BIT(S)
A00015   EQU   OLTEPSW3+00000000   1 BIT(S)
CDSEXIST EQU   OLTEPSW3+00000000   1 BIT(S)
OLTEPSW5 EQU   CESWT5+00000000     1 BYTE(S)
A00016   EQU   OLTEPSW5+00000000   3 BIT(S)
DPRINTFL EQU   OLTEPSW5+00000000   2 BIT(S)
A00017   EQU   OLTEPSW5+00000000   2 BIT(S)
PRNTOPTN EQU   OLTEPSW5+00000000   1 BIT(S)
OLTEPSW6 EQU   CESWT6+00000000     1 BYTE(S)
UTSCAL   EQU   OLTEPSW6+00000000   1 BIT(S)
ATM      EQU   OLTEPSW6+00000000   1 BIT(S)
OLTEPSW7 EQU   CESWT7+00000000     1 BYTE(S)
A00018   EQU   OLTEPSW7+00000000   1 BIT(S)
RETTO31  EQU   OLTEPSW7+00000000   1 BIT(S)
REMOTE   EQU   OLTEPSW7+00000000   1 BIT(S)
A00019   EQU   OLTEPSW7+00000000   3 BIT(S)
VIRTUAL  EQU   OLTEPSW7+00000000   1 BIT(S)
GOTINPUT EQU   OLTEPSW7+00000000   1 BIT(S)
OLTEPSW8 EQU   CESWT8+00000000     1 BYTE(S)
A00020   EQU   OLTEPSW8+00000000   5 BIT(S)
SUTMSG   EQU   OLTEPSW8+00000000   1 BIT(S)
A00021   EQU   OLTEPSW8+00000000   1 BIT(S)
TALKHERE EQU   OLTEPSW8+00000000   1 BIT(S)
OLTEPSW9 EQU   CESWT9+00000000     1 BYTE(S)
CDSEQU   EQU   OLTEPSW9+00000000   1 BIT(S)
RESENTB  EQU   OLTEPSW9+00000000   1 BIT(S)
A00022   EQU   OLTEPSW9+00000000   1 BIT(S)
MODEV    EQU   OLTEPSW9+00000000   1 BIT(S)
MODER    EQU   OLTEPSW9+00000000   1 BIT(S)
MIXDEV   EQU   OLTEPSW9+00000000   1 BIT(S)
A00023   EQU   OLTEPSW9+00000000   2 BIT(S)
OLTPSW10 EQU   CESWT10+00000000    1 BYTE(S)
MPSYS    EQU   OLTPSW10+00000000   1 BIT(S)
AFFNSET  EQU   OLTPSW10+00000000   1 BIT(S)
VERBCALL EQU   OLTPSW10+00000000   1 BIT(S)
A00024   EQU   OLTPSW10+00000000   5 BIT(S)
A00025   EQU   CESWTR+00000000     1 BYTE(S)
RETAINAC EQU   A00025+00000000     1 BIT(S)
REMERR   EQU   A00025+00000000     1 BIT(S)
REMNOMSG EQU   A00025+00000000     1 BIT(S)
CENOMSG  EQU   A00025+00000000     1 BIT(S)
PRTNOMSG EQU   A00025+00000000     1 BIT(S)
IMRESP   EQU   A00025+00000000     1 BIT(S)
EXECOUT  EQU   A00025+00000000     1 BIT(S)
CECOMOUT EQU   A00025+00000000     1 BIT(S)
A00026   EQU   CESWTR1+00000000    1 BYTE(S)
ILLRESP  EQU   A00026+00000000     1 BIT(S)
EXECANS  EQU   A00026+00000000     1 BIT(S)
CECOMANS EQU   A00026+00000000     1 BIT(S)
INFOMSG  EQU   A00026+00000000     1 BIT(S)
RETRIEVE EQU   A00026+00000000     1 BIT(S)
REMANS   EQU   A00026+00000000     1 BIT(S)
EDTOMSG  EQU   A00026+00000000     1 BIT(S)
A00027   EQU   A00026+00000000     1 BIT(S)
A00028   EQU   CESWTR2+00000000    1 BYTE(S)
A00029   EQU   A00028+00000000     2 BIT(S)
ONCOMM   EQU   A00028+00000000     1 BIT(S)
A00030   EQU   A00028+00000000     5 BIT(S)
SCT      EQU   CHASCT+00000000     70 BYTE(S) ON WORD
A00031   EQU   SCT+00000000        3 BYTE(S)
FLAGS    EQU   SCT+00000003        1 BYTE(S)
SETERROR EQU   SCT+00000003        1 BIT(S)
ASTERB   EQU   SCT+00000003        1 BIT(S)
UTCATAS  EQU   SCT+00000003        1 BIT(S)
RTNFLDXX EQU   SCT+00000004        2 BYTE(S)
A00032   EQU   SCT+00000006        27 BYTE(S)
EXPGMFLG EQU   SCT+00000033        1 BYTE(S)
A00033   EQU   SCT+00000033        2 BIT(S)
RTNSLCTN EQU   SCT+00000033        1 BIT(S)
A00034   EQU   SCT+00000034        2 BYTE(S)
OLTFLGS  EQU   SCT+00000036        1 BYTE(S)
A00035   EQU   SCT+00000036        7 BIT(S)
TALKOLT  EQU   SCT+00000036        1 BIT(S)
OLTFLG2  EQU   SCT+00000037        1 BYTE(S)
TALKCE   EQU   SCT+00000037        1 BIT(S)
A00036   EQU   SCT+00000038        2 BYTE(S)
EXPANDED EQU   SCT+00000040        30 BYTE(S)
ROPTMIN2 EQU   ROPT-00000002       2 BYTE(S)
REIDEBAD EQU   ROPT+00000008       FULLWORD POINTER
@DATEND  EQU   *
@9FE     EQU   CECINP17
@9EA     EQU   CECINP07
@9E9     EQU   CECINP4D
@9DD     EQU   CECINP16
@9CC     EQU   CECINP09
@9C3     EQU   CECINP14
@9BC     EQU   CECINP23
         END    ,(C'PL/S',1400,77060)

         TITLE 'IFDOLT31 DEVICE DECODE'
         TITLE 'IFDOLT31 DEVICE DECODE'
         LCLA  &T,&SPN                                            0002
.@001    ANOP                                                     0002
IFDOLT31 CSECT ,                                                  0002
         BC    15,24(0,@F)
         DC    C'IFDOLT31 05 DEC 75'                             0002
         STM   @E,@C,12(@D)                                       0002
         BALR  @B,0                                               0002
@PSTART  DS    0H                                                 0002
         USING @PSTART+00000,@B                                   0002
         ST    @D,@SAV001+4                                       0002
         LA    @F,@SAV001                                         0002
         ST    @F,8(0,@D)                                         0002
         LR    @D,@F                                              0002
*         GEN(USING CHASCT,2);
         USING CHASCT,2
         DS    0H
*         GENERATE DATA;
*         /************************************************************
*         /*                                                    X03906*
*         /*                        REGISTERS                         *
*         /*                                                    X03906*
*         /************************************************************
*         DCL R0 REG(0) PTR(31);         /* REGISTER 0.               *
*         DCL R1 REG(1) PTR(24);         /* REGISTER 1.               *
*         DCL R2 REG(2) PTR(31);         /* REGISTER 2.               *
*         DCL R3 REG(3) PTR(31);         /* REGISTER 3.               *
*         DCL I REG(3) PTR(31);          /* REGISTER 3.               *
*         DCL R4 REG(4) PTR(31);         /* REGISTER 4.               *
*         DCL R5 REG(5) PTR(31);         /* REGISTER 5.               *
*         DCL R7 REG(7) PTR(31);         /*                     X03008*
*         DCL GOODENT REG(6) PTR(24);    /* GOOD DEV ADDRS ENTERED    *
*         DCL UCBLOOK REG(7) PTR(24);    /* DEVS NEEDING UCB LOOKUPS  *
*         DCL R8 REG(8) PTR(31);         /* REGISTER 8.         X03008*
*         DCL DEVTABPT REG(8) PTR(31);   /* REGISTER 8.               *
*         DCL R9 REG(9) PTR(24);         /* REGISTER 9.               *
*         DCL Z REG(10) PTR(24);         /*                     X03008*
*         DCL R13 REG(13) PTR(31);       /* REGISTER 13.              *
*         DCL R14 REG(14) PTR(31);       /* REGISTER 14.              *
*         DCL RC REG(15) PTR(31);        /* REGISTER 15.              *
*         DCL R15 REG(15) PTR(31);       /* REGISTER 15.              *
*         /************************************************************
*         /*                                                    X03906*
*         /*                       SAVE AREAS                         *
*         /*                                                    X03906*
*         /************************************************************
*         DCL 1 MYSAVE BASED(R13),       /*---MY SAVE AREA FORMAT-----*
*               3 * CHAR(4),             /* NOT LOOKED AT.            *
*               3 YOURR13 PTR(31);       /* CALLER SAVE AREA ADDRESS. *
*         DCL 1 YOURSAVE BASED(YOURR13), /* CALLERS SAVE AREA FORMAT. *
*               3 * CHAR(12),            /* NOT NEEDED.               *
*               3 YOURR14 PTR(31);       /* CALLERS RETURN POINT.     *
*         /************************************************************
*         /*                                                    X03906*
*         /*                  SECTION CONTROL TABLE                   *
*         /*                                                    X03906*
*         /************************************************************
*         DCL CHASCT CHAR(88) GENERATED;
*         DCL 1 SCT BASED(ADDR(CHASCT)), /*--------SCT FORMAT---------*
*               3 HEADER CHAR(8),        /* HEADER.                   *
*               3 PRIDVSCT CHAR(12);     /* PRIMARY DEVICE ENTRY.     *
*         /************************************************************
*         /*                                                    X03906*
*         /*                       INPUT BUFFER                       *
*         /*                                                    X03906*
*         /************************************************************
*         DCL INBUFR CHAR(120) GENERATED;
*         DCL INPUTBUF CHAR(10) BASED(R5); /* INPUT BUFFER      21050 *
*         DCL INBUFPTR PTR(31) GENERATED;/* POINTER TO SLASH DELIMITER*
*         /************************************************************
*         /*                                                    X03906*
*         /*                        SWITCHES                          *
*         /*                                                    X03906*
*         /************************************************************
*         DCL CESWT CHAR(1) GENERATED;
*         DCL 1 OLTEPSW BASED(ADDR(CESWT)),/*-----CESWT FORMAT--------*
*               3 * BIT(4),              /* NOT LOOKED AT.            *
*               3 LEGALDEV BIT(1),       /* LEGAL DEVICE FLAG.        *
*               3 REINT BIT(1);          /* RE-INITIALIZE FLAG.       *
*         DCL CESWT2 CHAR(1) GENERATED;
*         DCL 1 OLTEPSW2 BASED(ADDR(CESWT2)),/*---CESWT2 FORMAT-------*
*               3 * BIT(3),              /* NOT LOOKED AT.            *
*               3 CHANTEST BIT(1),       /* CHANNEL TEST FLAG.        *
*               3 * BIT(1),              /* NOT LOOKED AT.            *
*               3 NDR BIT(1);            /* NO DEVICE REQUIRED FLAG.  *
*         DCL CESWT7 CHAR(1) GENERATED;  /*---CESWT7 FORMAT------21050*
*         DCL  1 OLTEPSW7 BASED(ADDR(CESWT7)), /* C E SWT FORMAT.21050*
*                3 INCLST BIT(1), /* INCLUSIVE SERIES OF DEVICESX03906*
*                3 RETTO31 BIT(1), /* NEED TO RET TO IFDOLT31.  X03906*
*                3 REMOTE BIT(1),  /* REMOTE TERMINAL IN SYSTEM.X03906*
*                3 LOADCDS BIT(1); /* LOAD CDS FROM REM FILE    X03906*
*         DCL CESWT9 CHAR(1) GENERATED;  /* CESWT9 IN COMM AREA X03008*
*         DCL 1 OLTEPSW9 BASED(ADDR(CESWT9)), /* CESWT9 FORMAT  X03008*
*               3 * BIT(5),        /* NOT LOOKED AT             X03008*
*               3 MIXDEV BIT(1),   /* CHECK DEV ENTRY  SYM      X03008*
*               3 * BIT(2);        /* NOT LOOKED AT             X03008*
*         DCL CESWTR CHAR(1) GENERATED;  /*                      20203*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR)),  /*               20203*
*               3 RETAINAC BIT(1),       /* REI ACTIVE FLAG      S20203
*               3 * BIT(1),              /*                      S20203
*               3 REMNOMSG BIT(1),       /* REMOTE NO MSG        S20203
*               3 * BIT(5);              /*                      S20203
*         DCL CESWTR1 CHAR(1) GENERATED; /*                      21050*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR1)),  /*              21050*
*               3 * BIT(5),              /*                      21050*
*               3 REMANS BIT(1),         /* REMOTE ANSWERS       21050*
*               3 * BIT(2);              /*                      21050*
*         DCL CESWTR2 CHAR(1) GENERATED; /* REI SWITCHES         20203*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR2)), /*               20203*
*               3 * BIT(2),              /*                      20203*
*               3 ONCOMM BIT(1),         /* ONSITE DYN COMM      S20203
*           3 * BIT(4),
*           3 DPMSGREI BIT(1);          /* DATA PROT MSG        YM2273*
*         /************************************************************
*         /*                                                    X03906*
*         /*                   SVC PARAMETER LIST                     *
*         /*                                                    X03906*
*         /************************************************************
*         DCL ROPT CHAR(8) GENERATED;
*         DCL 1 SVCPLIST BASED(ADDR(ROPT)-4),/*--FORMAT-SVC PLIST-----*
*               3 * CHAR(2),             /* NOT USED.                 *
*               3 MODNUM CHAR(2),        /* NAME OF CALLING MODULE.   *
*               3 ADDRDEV PTR(31),       /* BEGIN ADDR FOR UCBLOOK UP.*
*               3 ENTRIES FIXED(31),     /* NUMBER OF LOOK UPS  X03008*
*               3 SVCSAPTR PTR(31);      /* ADDR OF S.A. FOR 59 X03008*
*         /************************************************************
*         /*                                                    X03906*
*         /*                FORMAT OF DEVTABLE ENTRY                  *
*         /*                                                    X03906*
*         /************************************************************
*         DCL DEVTBPTR PTR GEND;   /* POINTER TO DEVICE TABLES   21050*
*         DCL 1 DEVTABXX CHAR(56)  BASED(DEVTABPT), /*           21050*
*               3 DEVADDR CHAR(8),       /* EBCDIC DEVICE ADDR   21050*
*               3 UCBADDR PTR(31),       /* UCB ADDRESS.              *
*               3 FLG1 CHAR(1),          /* FIRST FLAG FIELD.         *
*                 5 ONOFF BIT(1),        /* DEVICE STATUS FLAG.       *
*                 5 PRIMARY BIT(1),      /* PRIMARY DEVICE FLAG.      *
*               3 * CHAR(1),             /* SECOND FLAG FIELD.  YM7253*
*               3 FLG3 CHAR(1),          /* 3RD FLAG FEILD      YM7253*
*                 5 * BIT(4),            /* NOT LOOKED AT       YM7253*
*                 5 NOGODEV BIT(1),      /* DEV INUSE OR NOTAVAIYM7253*
*                 5 SYSALLOC BIT(1),       /* DEV ALLOC       @ZA06048*
*                 5 * BIT(2),              /* NOT LOOKED AT   @ZA06048*
*               3 FLG4 CHAR(1),          /* 4TH FLAG FEILD      Y02008*
*                 5 *    BIT(4),         /* NOT LOOKED AT       Y02008*
*                 5 DEVVAR BIT(1),       /* OLTEP VARIED DEV OFFLINE  *
*                 5 DEVENQNG BIT(1),     /* OLTEP ENQ OF DEV FAILED   *
*                 5 *    BIT(2),         /* NOT LOOKED AT       Y02008*
*               3 * CHAR(16),            /* EXTENTS OR TAPE LABEL     *
*                                        /* SAVE AREA.                *
*               3 HEXADDR CHAR(4),       /* DEV ADDR IN HEX      21050*
*               3 CDSDVDSC CHAR(4),      /* CDS DEVICE DSCRPTRS  21050*
*                 5 MODEL CHAR(1), /* MODEL OF DEVICE.           21050*
*                 5 FEATURES CHAR(1), /* DEVICE FEATURES.        21050*
*                 5 CLASS CHAR(1), /* DEVICE CLASS.              21050*
*                 5 TYPE CHAR(1),  /* DEVICE TYPE.               21050*
*               3 BYTECNT CHAR(1), /* CDS BYTE COUNT.            21050*
*               3 CDSFLAGS CHAR(1), /* CDS FLAG BYTE             21050*
*                 5 * BIT(4),      /* NOT NEEDED HERE.           21050*
*                 5 SYMDEVIC BIT(1), /* SET IF SYMBOLIC DEVICE.  21050*
*                 5 * BIT(2),      /*                            21050*
*                 5 REMLINE BIT(1),/* SET IF REMOTE LINE NEEDS TO     *
*                             /*   BE ENABLED FOR REMOTE TESTING 21050*
*               3 EXTSGMSK CHAR(2),/* EXGERNAL SIGNAL MASK       21050*
*               3 SYMNAME CHAR(8); /* SYMBOLICALLY NAMED ENTRY.  21050*
*         /************************************************************
*         /*                                                    X03906*
*         /*                        MESSAGES                          *
*         /*                                                    X03906*
*         /************************************************************
*         DCL IFDMSG31 LABEL NONLOCAL EXTERNAL;
*         DCL 1 MSGPTR BASED(R4),        /*-----MESSAGE POINTERS------*
*               3 MSGPTR08 PTR(31),      /* POINTER TO MESSAGE IFD108I*
*               3 MSGPTR11 PTR(31),      /* POINTER TO MESSAGE IFD111I*
*               3 MSGPTR79 PTR(31),      /* POINTER TO MESSAGE IFD127I*
*               3 MSGPTR61 PTR(31),      /* POINTER TO MESSAGE IFD161I*
*               3 MSGPTR27 PTR(31),      /* PTR TO MSG IFD127I  X03008*
*               3 MSGPTR65 PTR(31),      /* PTR TO MSG IFD165I  X03008*
*               3 MSGPTR51 PTR(31),      /* PTR TO MSG IFD251I  X03008*
*               3 MSGPTR52 PTR(31),      /* PTR TO MSG IFD252I  X03008*
*               3 MSGPTR14 PTR(31),      /* PTR TO MSG IFD140I  Y02008*
*               3 MSGPTR19 PTR(31),      /* PTR TO MSG IFD109I  Y02008*
*               3 MSGPTR67 PTR(31);      /* PTR TO MSG IFD467I  YM7253*
*         DCL 1 MSG108 BASED(R1),        /* MESSAGE IFD108I FORMAT.   *
*               3 * CHAR(12),            /* NOT LOOKED AT.            *
*               3 MSG108I CHAR(28);      /* MESSAGE TEXT.             *
*         DCL 1 MSG140 BASED(R1),        /* MESSAGE IFD140I FORMAT.   *
*               3 * CHAR(12),            /* NOT LOOKED AT.            *
*               3 MSG140DV CHAR(8);      /* MESSAGE TEXT.             *
*         DCL 1 MSG467 BASED(R1),        /* MESSAGE IFD467I FORMYM7253*
*               3 * CHAR(12),            /* NOT LOOKED AT.      YM7253*
*               3 MSG467DV CHAR(8);      /* MESSAGE TEXT.       YM7253*
*         DCL 1 MSG190 BASED(R1),        /* MESSAGE IFD109I FORMAT.   *
*               3 * CHAR(12),            /* NOT LOOKED AT.            *
*               3 MSG109DV CHAR(8),        /* FORMAT FOR 109  @ZA06048*
*               3 * CHAR(1),               /*                 @ZA06048*
*               3 ONOROFF CHAR(8),         /* ON OR OFF LINE  @ZA06048*
*               3 ALORNOT CHAR(11);        /* ALLOCATED?      @ZA06048*
*         DCL 1 MSG179 BASED(R1),        /* MESSAGE IFD127I FORMAT.   *
*               3 * CHAR(12),            /* NOT LOOKED AT.
*               3 MSG179I CHAR(27);      /* MESSAGE TEXT.        21050*
*         DCL 1 MSG127 BASED(R1),
*           3 * CHAR(12),
*           3 MSG127I CHAR(19);
*         /************************************************************
*         /*                                                    X03906*
*         /*            OTHER COMMON AREA CONSTANTS USED              *
*         /*                                                    X03906*
*         /************************************************************
*         DCL DIEPTR PTR(31) GENERATED;  /* POINTER TO DIE IN CAY02008*
*         DCL UNICTR CHAR(1) GENERATED;  /* UNIT COUNTER.             *
*         DCL REDEFINE PTR(31) GENERATED;/* RETURN POINT TO REDEFINE  *
*                                        /* TEST DEFINITION.          *
*         DCL UNITUSE CHAR(1) GENERATED; /* UNIT USED COUNTER.        *
*         DCL NEXTREC PTR(31) GENERATED; /* RETURN POINT TO READ NEXT *
*                                        /* RECORD.                   *
*         DCL TAB28 PTR(31) GENERATED;   /* NEW MACRO ENTRY POINT.    *
*         DCL TABLNGTH PTR(15) GENERATED;/* INDEX VALUE FOR TAB X03008*
*         /************************************************************
*         /*                                                    X03906*
*         /*                   INTERNAL CONSTANTS                     *
*         /*                                                    X03906*
*         /************************************************************
*         DCL 1 * BASED(R8),             /* DEVICE TABLE        X03008*
*                3 DVT CHAR(16),         /* TABLE AREA          X03008*
*                3 DVTN CHAR(16);        /* NEXT TABLE AREA     X03008*
*         DCL SUM PTR(24);               /*                     X03008*
*         DCL SAVLOOKT PTR(24);          /*                     X03008*
*         DCL 1 PARMLIST CHAR(16) BDY(WORD),
*           3 MODNAME CHAR(8),
*             5 TCDSO CHAR(1) INIT('G'),
*             5 CDSDEV CHAR(7),
*           3 TARGETAD PTR,
*           3 PARMFLGS CHAR(1),
*           3 * CHAR(1),
*           3 CDSLNGTH FIXED(15);
*         DCL COUNT REG(7) PTR(31);
*         DCL CNVRT1 CHAR(14) GENERATED; /* FIRST CONVERT PARMLIST.   *
*         DCL CNVRT2 CHAR(14) GENERATED; /* SECOND CONVERT PARMLIST.  *
*         DCL CNVRT3 CHAR(14) GENERATED; /* THIRD CONVERT PARMLIST.   *
*         DCL AVAILBLE PTR(31);          /* POINTER TO NEXT AVAILABLE *
*                                        /* ENTRY IN DEVTABLE.        *
*         DCL DEVTABLE CHAR(56) BASED(AVAILBLE); /*              21050*
*         DCL 1 DEVAREA CHAR(16),           /* DEVICE AREA      X03906*
*               3 FSTDEV FIXED(31),      /* FIRST DEVICE IN A SERIES. *
*                 5 FSTDEV2 CHAR(4), /* CONVERT AREA FOR EBCDIC  21050*
*                   7 HEX CHAR(4),       /* DEVICE ADDRESS.      21050*
*               3 FINDEV FIXED(31),      /* FINAL DEVICE IN A SERIES. *
*                 5 FINDEV2 CHAR(4); /* FINAL DEV ADDR IN HEX.   21050*
*         DCL LOOPPTR PTR(31);           /* INDEXED TABLE PTR   X03008*
*         DCL 1 * CHAR(56) BASED(LOOPPTR), /* DEVICE TBL OVERLAYX03008*
*               3 * CHAR(32),            /* NOT LOOKED AT       X03008*
*               3 HXADDR CHAR(4),        /* DEVICE ADDRESS      X03008*
*               3 * CHAR(8),             /* NOT LOOKED AT       X03008*
*               3 SYMBNM CHAR(8);        /* DEVICE SYMB NAME    X03008*
*         DCL  NEWADDR CHAR(4);          /* HOLD AREA FOR SCAN  X03008*
*         DCL LIMIT FIXED(15);           /* LIMIT OF UCB LOOK UPS     *
*                                        /* THAT CAN BE PERFORMED.    *
*         DCL 1 X FIXED(15),             /* COUNTER & WORK AREA.      *
*               3 UNITCTR FIXED(15),
*                 5 * CHAR(1),
*                 5 UNITCTR1 CHAR(1);
*         DCL ERRCODE CHAR(2);           /* ERROR CODE.               *
*         DCL NUMBERS CHAR(16)           /* VALID NUMBERS.            *
*              INITIAL('0123456789ABCDEF');
*         DCL NUMBER CHAR(1) BASED(R9);
*         DCL 1 DEVAD CHAR(8) INIT('0000'),/* CONVERT FROM AREA. 21050*
*               3 DEVAD1 CHAR(8);                              /*21050*
*         DCL 1 SWITCHES CHAR(1),        /* FLAGS.                    *
*               3 FRSTPASS BIT(1);       /* FIRST PASS FLAG.          *
*                                        /* FLAG.                     *
*         DCL UCBDVDSC CHAR(4) BASED(UCBADDR+16); /* UCB DEV DSSC21050*
*      DCL 1  CDSENTRY CHAR(20) BASED(R1),  /* CDS ENTRY LOADED  21050*
*               3 * CHAR(4),             /* DEVICE ADDRESS.           *
*               3 DSCRPTRS CHAR(4);/* CDS DEV DSCRPTRS           21050*
*         DCL CHARCNTR FIXED(15);  /* COUNTS CHARS IN ADDRESS    21050*
*         DCL EIGHT FIXED(15) INIT(8);  /* CONSTANT USED IN BUFR 21050*
*         DCL BLANKFLD CHAR(8) INIT((8)' ');
*         DCL SYMNAM   CHAR(8);    /* HOLDS SYMBOLIC NAME  ENTRY 21050*
*         DCL IGNORE FIXED(15);    /* ADDRESS FIELD NOT APPLICABLE21050
*         DCL SAVENT  FIXED(31) GEND;    /* SAV DEV IN INCLSV SER.21050
*         DCL OFLGS BIT(8) BASED(R9+48); /* CHECK FOR OPENED CDS 21051*
*
*         /*  BYTE IN DCB IS ZERO FOR DUMMY DD CARDS             01906*
*         DCL DDDUMMY CHAR(1) BASED(R9+17);
*
*         DCL SYMPTR PTR GEND;
*         RESTRICT(1,2,3,4,5,6,7,8,9,10);                     /*X03008*
*         /************************************************************
*         /*                                                          *
*         /*                   PERFORM INITIALIZATION                 *
*         /*                                                          *
*         /************************************************************
*         R4=ADDR(IFDMSG31);        /* GET POINTER TO MESSAGE MODULE. *
         L     @C,@V1              ADDRESS OF IFDMSG31            0097
         LR    @4,@C                                              0097
*         R5=INBUFPTR;              /* GET POINTER TO INPUT BUFFER.   *
         L     @5,INBUFPTR                                        0098
*         /************************************************************
*         /*                                                    X03906*
*         /*   IF RETAIN/370 INTERFACE IS ACTIVE, CHECK TO SEE WHO    *
*         /*   ANSWERED. ISSUE MSG IFD165I IF REMOTE SPECIALIST DID.  *
*         /*                                                    X03906*
*         /************************************************************
*         IF RETAINAC='0'B THEN    /* IS RETAIN INACTIVE.        21050*
         TM    A00007,B'10000000'                                 0099
*           GO TO INITIAL;         /* YES, CONT INITIALIZATION.  21050*
         BC    08,INITIAL                                         0100
*         IF INPUTBUF(1:2)='.N' THEN /* REMOTE CAN ANS NDR OR '/'21050*
         CLC   0(2,@5),@C2                                        0101
*           GO TO INITIAL;         /* CONTINUE ONITIALIZATION.   21050*
         BC    08,INITIAL                                         0102
*         IF INPUTBUF(1)='/' THEN  /*       SLASH ENTERED        21050*
         CLI   0(@5),C'/'                                         0103
*           GO TO INITIAL;         /* CONTINUE ONITIALIZATION.   21050*
         BC    08,INITIAL                                         0104
*         IF ONCOMM='1'B THEN      /* ONSITE DYN COMM           X03906*
         TM    A00013,B'00100000'                                 0105
*           GO TO INITIAL;         /* BYPASS ERROR MSG           21050*
         BC    01,INITIAL                                         0106
*         R1=MSGPTR65;             /* MSG PTR FOR IFD165I       X03906*
         L     @1,20(0,@4)                                        0107
*         GEN(PWTO REG=(1));       /* PRINT ERROR MESSAGE       X03906*
         PWTO REG=(1)
         DS    0H
*         GO TO CECDEV47;          /* RETURN TO REDEFINE        X03906*
         BC    15,CECDEV47                                        0109
* INITIAL:                                                    /*X03906*
*         IF RETAINAC='1'B THEN    /* IS REI ACTIVE?            X03906*
INITIAL  TM    A00007,B'10000000'                                 0110
         BC    12,@9FF                                            0110
*           DPMSGREI='1'B;              /* NO REPLY FROM REI    XM9156*
         OI    A00013,B'00000001'                                 0111
*         DEVAREA=DEVAREA&&DEVAREA; /* CLEAR FSTDEV AND FINDEV.       *
@9FF     XC    DEVAREA(16),DEVAREA                                0112
*         UCBLOOK=0;                /* INITIALIZE UCB LOOK UP COUNTER *
         SR    @7,@7                                              0113
*                                   /* TO ZERO.                       *
*         CHARCNTR=0;              /* INITIALIZE CHAR COUNTER    21050*
         SR    @F,@F                                              0114
         STH   @F,CHARCNTR                                        0114
*         IF RETTO31='1'B THEN DO; /* IS THIS RETURN FROM SECOND 21050*
         TM    OLTEPSW7,B'01000000'                               0115
         BC    12,@9FE                                            0115
*           GOODENT=UNICTR;        /* HALF OF DEVICE DECODE MOD. 21050*
         SR    @6,@6                                              0117
         IC    @6,UNICTR                                          0117
*           DEVTABPT=DEVTBPTR+(UNICTR*TABLNGTH);
         LH    @F,TABLNGTH                                        0118
         SR    @0,@0                                              0118
         IC    @0,UNICTR                                          0118
         MR    @E,@0                                              0118
         A     @F,DEVTBPTR                                        0118
         LR    @8,@F                                              0118
*                                        /* INIT PTRS AND CNTRS X03008*
*           FRSTPASS='1'B;         /* INIT FIRST PASS THRU COUNTER21050
         OI    SWITCHES,B'10000000'                               0119
*           AVAILBLE=DEVTABPT;     /* LOCATE NEXT AVAIL TABLE.   21050*
         ST    @8,AVAILBLE                                        0120
*           LIMIT=16-UNICTR;       /* REINIT AVAIL TABLE LIMIT.  21050*
         LA    @F,16                                              0121
         IC    @0,UNICTR                                          0121
         SR    @F,@0                                              0121
         STH   @F,LIMIT                                           0121
*         IF INCLST='1'B THEN DO;  /* IS INCLUSIVE SERIES OF     21050*
         TM    OLTEPSW7,B'10000000'                               0122
         BC    12,@9FD                                            0122
*           FSTDEV=SAVENT;         /* DEVICES ENTERED. YES% THEN 21050*
         MVC   DEVAREA(4),SAVENT                                  0124
*           GO TO CECDEV39;        /* REINIT LAST DEV USED, CONT. 21050
         BC    15,CECDEV39                                        0125
*           END;                   /* INCLUSIVE DEVICE SEARCH.   21050*
*         GO TO CECDEV19;          /* CHECK FOR DELIMETER.       21050*
*           END;
*         GOODENT=0;                /* INITIALIZE VALID ENTRIES       *
@9FE     SR    @6,@6                                              0129
*                                   /* COUNTER TO ZERO.               *
*         DEVTABPT=DEVTBPTR;       /* INITIALIZE DEVICE TABLE PTR21050*
         L     @8,DEVTBPTR                                        0130
*         AVAILBLE=DEVTABPT;        /* GET POINTER TO NEXT AVAILABLE  *
         ST    @8,AVAILBLE                                        0131
*                                   /* ENTRY IN DEVTABLE.             *
*         INCLST='0'B;              /* SET INCLST FLAG OFF.           *
         NI    OLTEPSW7,B'01111111'                               0132
*         FRSTPASS='0'B;            /* INITIALIZE FIRST PASS FLAG.    *
         NI    SWITCHES,B'01111111'                               0133
*         NDR='0'B;                 /* SET NDR FLAG OFF.              *
         NI    OLTEPSW2,B'11111011'                               0134
*         LIMIT=16;                 /* INITIALIZE LIMIT TO 16.        *
         LA    @F,16                                              0135
         STH   @F,LIMIT                                           0135
*         REINT='1'B;               /* SET REINT FLAG ON.             *
         OI    OLTEPSW,B'00000100'                                0136
*
*         /************************************************************
*         /*                                                          *
*         /*          IS ' .NDR ' ENTERED?                      X02906*
*         /*                                                          *
*         /************************************************************
* CECDEV00:
*         IF INPUTBUF(1)='.' THEN       /* IS .NDR SPECIFIED?   X02906*
CECDEV00 CLI   0(@5),C'.'                                         0137
         BC    07,@9FC                                            0137
*            DO;                   /* YES, THEN INCREMENT BUFFER 21050*
*            R5=R5+1;              /* TO NEXT CHAR.  ARE MORE    21050*
         AH    @5,@D1                                             0139
*            IF FRSTPASS='1'B THEN /* ENTRIES IN DEV FLD? CH,NDR 21050*
         TM    SWITCHES,B'10000000'                               0140
*              GO TO CECDEV41;     /*MUST BE ONLY ENTRIES.  MORE 21050*
         BC    01,CECDEV41                                        0141
*                                  /* ENTRIES INDICATE ERROR.    21050*
*            GO TO CECDEV27;       /* IF NOT, CHECK FOR CH,NDR   21050*
         BC    15,CECDEV27                                        0142
*            END;                  /*                            21050*
*
*         /************************************************************
*         /*                                                          *
*         /*               SCAN ADDRESS CHARACTERS                    *
*         /*                                                          *
*         /************************************************************
* CECDEV01:                        /*                            21050*
*         R3=ADDR(CECDEV05);       /* SAVE ADDR OF ALPHA CHECK   21050*
@9FC     EQU   *                                                  0144
CECDEV01 LA    @3,CECDEV05                                        0144
* CECDEV03:                        /*                            21050*
*         CHARCNTR=CHARCNTR+1;     /* NUM OF CHAR IN DEV ADDR.   21050*
CECDEV03 LA    @F,1                                               0145
         AH    @F,CHARCNTR                                        0145
         STH   @F,CHARCNTR                                        0145
*         R5=R5+1;                 /* MOVE TO NEXT ADDR CHAR.    21050*
         AH    @5,@D1                                             0146
*         IF CHARCNTR>8 THEN       /* ERROR IN DEV ENTRY IF MORE 21050*
         LA    @F,8                                               0147
         CH    @F,CHARCNTR                                        0147
*            GO TO CECDEV43;       /* THAN 8 CHARS ENTERED.      21050*
         BC    04,CECDEV43                                        0148
*         IF INPUTBUF(1)=','×      /* WHAT DELIMETER IS PRESENT? 21050*
*            INPUTBUF(1)='-'×      /*                            21050*
*            INPUTBUF(1)='/' THEN  /*                            21050*
         CLI   0(@5),C','                                         0149
         BC    08,@9FB                                            0149
         CLI   0(@5),C'-'                                         0149
         BC    08,@9FA                                            0149
         CLI   0(@5),C'/'                                         0149
         BC    07,@9F9                                            0149
*           DO;                    /* YES, RETURN TO FIRST CHAR  21050*
@9FA     EQU   *                                                  0150
*            R5=R5-CHARCNTR;       /* IN DEV ADDR AND GO TO POR- 21050*
@9FB     SH    @5,CHARCNTR                                        0151
*            GO TO R3;             /* TION OF CODE WHICH CHECKS  21050*
         BCR   15,@3                                              0152
*            END;                  /* FOR ALPHABETIC ENTRY.      21050*
*         GO TO CECDEV03;          /* NO DELIMITER. CHECK NEXT   21050*
*                                  /* DEVICE ADDRESS CHARACTER   21050*
* CECDEV05:                        /* HAS A SYMBOLIC NAME BEEN   21050*
*         IF INPUTBUF(1)<'A'×      /* ENTERED IN THE DEV FIELD?  21050*
*            INPUTBUF(1)>'Z'       /* CHECK FOR NON ALPHA CHARS. 21050*
*            THEN                  /* IF TRUE,                  X03008*
CECDEV05 CLI   0(@5),C'A'                                         0155
         BC    04,@9F8                                            0155
         CLI   0(@5),C'Z'                                         0155
         BC    12,@9F7                                            0155
*              DO;                                            /*X03008*
*                IF MIXDEV='1'B THEN /* CHECK IF SYMB NAME      X03008*
@9F8     TM    OLTEPSW9,B'00000100'                               0157
*                  GOTO CECDEV40;    /* MIXED ENTRY, YES ERROR  X03008*
         BC    01,CECDEV40                                        0158
*                GO TO CECDEV11;   /*CHECK FOR NUMERIC ADDRESS.  21050*
         BC    15,CECDEV11                                        0159
*              END;                                           /*X03008*
*        IF MIXDEV='0'B THEN       /* CHECK IF DEVICE ENTRY     X03008*
@9F7     TM    OLTEPSW9,B'00000100'                               0161
*          GOTO CECDEV40;          /* MIXED, YES ERROR          X03008*
         BC    08,CECDEV40                                        0162
*        REMOTE='1'B;              /* REMOTE TERMINAL IN SYSTEM. 21051*
         OI    OLTEPSW7,B'00100000'                               0163
*         SYMNAM=BLANKFLD;         /*SYMBOLIC ENTRY DETECTED.    21050*
         MVC   SYMNAM(8),BLANKFLD                                 0164
*         RELEASE(9);
*         SYMNAM(1:CHARCNTR)=INPUTBUF(1:CHARCNTR); /* FILL SYMNAME21050
         LR    @E,@5                                              0166
         LH    @9,CHARCNTR                                        0166
         BCTR  @9,0                                               0166
         LA    @A,SYMNAM                                          0166
         EX    @9,@MVC                                            0166
*                                  /* SYMNAME IN BUFFER AND LOAD 21050*
*         MODNAME=SYMNAM;
         MVC   PARMLIST(8),SYMNAM                                 0167
*         TARGETAD=DEVTABPT+32;
         LA    @F,32                                              0168
         AR    @F,@8                                              0168
         ST    @F,PARMLIST+8                                      0168
*         PARMFLGS='68'X;               /* SYMBOLIC CDS,COMPUTE X02008*
         MVI   PARMLIST+12,X'68'                                  0169
*         CDSLNGTH='14'X;
         LA    @F,X'14'                                           0170
         STH   @F,PARMLIST+14                                     0170
*
*         GEN(IFDMOD CALL='12',LIST=PARMLIST);
         IFDMOD CALL='12',LIST=PARMLIST
         DS    0H
*
*         R1=RC;
         LR    @1,@F                                              0172
*         IF R1>0 THEN
         LTR   @1,@1                                              0173
         BC    12,@9F6                                            0173
*          DO;
*           R5=R5+CHARCNTR;
         AH    @5,CHARCNTR                                        0175
*           RESTRICT(1);
*           R1=MSGPTR27;
         L     @1,16(0,@4)                                        0177
*           MSG127I(12:19)=SYMNAM;
         MVC   23(8,@1),SYMNAM                                    0178
*         GEN(PWTO REG=(1));
         PWTO REG=(1)
         DS    0H
*           RELEASE(1);
*           GO TO CECDEV15;
         BC    15,CECDEV15                                        0181
*          END;
*         FSTDEV2=HEXADDR;         /* PREPARE PARM LIST FOR CNVRT 21050
@9F6     MVC   DEVAREA(4),32(@8)                                  0183
*         R1=ADDR(CNVRT3);         /* MODULE. HEX TO EBCDIC .     21050
         LA    @1,CNVRT3                                          0184
*         R15=TAB28;               /* SET PTR TO TRANS MNGR       21050
         L     @F,TAB28                                           0185
*         GEN(BALR 14,15);
         BALR 14,15
         DS    0H
*         IF RC^=0 THEN            /* IF RETURN CODE NOT 0 GO AND 21051
         LTR   @F,@F                                              0187
*         GO TO CECDEV43;          /* PRINT ERROR MESSAGE.       21051*
         BC    07,CECDEV43                                        0188
*         SUM=GOODENT+UCBLOOK;     /* ADD TOLAL NO. DEVTAB ENTRYX03008*
         LR    @F,@7                                              0189
         AR    @F,@6                                              0189
         ST    @F,@TEMP4                                          0189
         MVC   SUM(3),@TEMP4+1                                    0189
*         IF SUM>'000000'X THEN    /* CHECK IF FIRST ENTRY      X03008*
         L     @F,@X11                                            0190
         MVC   @TEMP3+1(3),SUM                                    0190
         C     @F,@TEMP3                                          0190
*           GOTO CECDE39A;         /* NO, THEN CHECK FOR DUP    X03008*
         BC    04,CECDE39A                                        0191
* CECDEV06:                                                   /*X03008*
*         DEVADDR=DEVAD1;          /* PUT EBCDIC ADDR IN DEV TABLE21050
CECDEV06 MVC   0(8,@8),DEVAD                                      0192
*         FRSTPASS='1'B;           /* FLAG TO SHOW => 1 DEV ENTRD21050*
         OI    SWITCHES,B'10000000'                               0193
*         GO TO CECDEV13;          /* BOLIC NAME ENTRY.          21050*
         BC    15,CECDEV13                                        0194
* CECDEV11:                        /*                            21050*
*         IF CHARCNTR>4 THEN            /* OS ALLOWS 3 CHARS,         *
CECDEV11 LA    @F,4                                               0195
         CH    @F,CHARCNTR                                        0195
*          GO TO CECDEV43;              /* ANY OTHER LENGTH INVAL     *
         BC    04,CECDEV43                                        0196
*         IF CHARCNTR=4 THEN            /* FOUR CHAR DEV ADDR?        *
         CH    @F,CHARCNTR                                        0197
         BC    07,@9F5                                            0197
*          DO;                          /* YES,                       *
*           IF INPUTBUF(1:4)>'0999' THEN/* IS 4 CHAR ENTRY VALID      *
         CLC   0(4,@5),@C12                                       0199
*            GO TO CECDEV43;            /* NO, TOO LARGE DEV ADDR     *
         BC    02,CECDEV43                                        0200
*          END;
*         FRSTPASS='1'B;           /* INDICATE => 1 DEV ENTERED  21050*
@9F5     OI    SWITCHES,B'10000000'                               0202
*         IGNORE=EIGHT-CHARCNTR+1; /* ZERO FIELD IN ADDRESS      21050*
         LA    @F,1                                               0203
         SH    @F,CHARCNTR                                        0203
         AH    @F,EIGHT                                           0203
         STH   @F,IGNORE                                          0203
*         RELEASE(9);
*         DEVADDR='00000000';       /* CLEAR DEV ADDR FIELD.     21051*
         MVC   0(8,@8),@C13                                       0205
*         DEVADDR(IGNORE:8)=INPUTBUF(1:CHARCNTR);/* ADDR IN DEVTAB21050
         LR    @E,@5                                              0206
         LA    @1,8                                               0206
         LH    @9,IGNORE                                          0206
         SR    @1,@9                                              0206
         LA    @A,0(@9,@8)                                        0206
         BCTR  @A,0                                               0206
         EX    @1,@MVC                                            0206
*         RESTRICT(9);
*         DEVAD1=DEVADDR;          /* TAB. CONVERT DEV ADDR IN   21050*
         MVC   DEVAD(8),0(@8)                                     0208
*         R1=ADDR(CNVRT1);         /* EBCDIC TO HEX.  GET ADDR OF21050*
         LA    @1,CNVRT1                                          0209
*         R15=TAB28;               /* CONVERT RTN PARM LIST. GET 21050*
         L     @F,TAB28                                           0210
*                                  /*ENTRY PT ADDR TO  NEW MACROS21050*
*         GEN(BALR R14,R15);       /* BRANCH TO CNVERT RTN(41).  21050*
         BALR R14,R15
         DS    0H
*         IF RC^=0 THEN            /* CHECK RETURN CODE. NOT=0   21050*
         LTR   @F,@F                                              0212
*            GO TO CECDEV43;       /* MEANS AN ERROR. GET NEW DTO21050*
         BC    07,CECDEV43                                        0213
*         SUM=GOODENT+UCBLOOK;     /* ADD TOTAL NO. DEVTAB ENTRYX03008*
         LR    @F,@7                                              0214
         AR    @F,@6                                              0214
         ST    @F,@TEMP4                                          0214
         MVC   SUM(3),@TEMP4+1                                    0214
*         IF SUM>'000000'X THEN    /* CHECK IF FIRST ENTRY      X03008*
         L     @F,@X11                                            0215
         MVC   @TEMP3+1(3),SUM                                    0215
         C     @F,@TEMP3                                          0215
         BC    10,@9F4                                            0215
*           DO;                    /* NO                        X03008*
*             NEWADDR=HEX;         /* PLACE ADDR IN SCAN HOLD   X03008*
         MVC   NEWADDR(4),DEVAREA                                 0217
*             SAVLOOKT=UCBLOOK;    /* SAVE REG BEFOR SCAN       X03008*
         ST    @7,@TEMP4                                          0218
         MVC   SAVLOOKT(3),@TEMP4+1                               0218
*             GEN(BAL   R7,CECDE39B); /* CHECK FOR DUP ADDR     X03008*
         BAL   R7,CECDE39B
         DS    0H
*             UCBLOOK=SAVLOOKT;    /*RESTORE REG AFTER GOOD SCANX03008*
         MVC   @TEMP3+1(3),SAVLOOKT                               0220
         L     @7,@TEMP3                                          0220
*           END;                                              /*X03008*
*         HEXADDR=HEX;             /* PUT RETURNED HEX ADDR IN   21050*
@9F4     MVC   32(4,@8),DEVAREA                                   0222
*                                  /* DEV TAB ENTRY. ADD CHARCNTR21050*
* CECDEV13:                        /*                            21050*
*         R5=R5+CHARCNTR  ;        /* INCREMENT TO CHAR AFTER SYM21050*
CECDEV13 AH    @5,CHARCNTR                                        0223
*         DEVTABPT=DEVTABPT+TABLNGTH;/*INCREMENT DEVTAB POINTER X03008*
         AH    @8,TABLNGTH                                        0224
*         UCBLOOK=UCBLOOK+1;        /* INCREMENT UCB LOOK UP COUNTER  *
         LA    @7,1(0,@7)                                         0225
*                                   /* BY ONE.                        *
*         IF LIMIT=UCBLOOK THEN     /* IS LIMIT OF UCB LOOK UPS       *
         CH    @7,LIMIT                                           0226
         BC    07,@9F3                                            0226
*           DO;                     /* REACHED. YES, GO TO UCB LOOK UP*
*           R3=ADDR(CECDEV15);      /* FUNCTION. SET RETURN ADDRESS   *
         LA    @3,CECDEV15                                        0228
*                                  /*                            21050*
*           GO TO CECDEV31;         /* IN REGISTER 3.            21050*
         BC    15,CECDEV31                                        0229
*           END;
* CECDEV15:                                                    /*21050*
*         /************************************************************
*         /*                                                    X03906*
*         /*        IS AN INCLUSIVE SERIES OF DEVICES ENTERED         *
*         /*                                                    X03906*
*         /************************************************************
*         IF INPUTBUF(1)='-' THEN  /* A '-' DELIMITER INDICATES  21050*
@9F3     EQU   *                                                  0231
CECDEV15 CLI   0(@5),C'-'                                         0231
         BC    07,@9F2                                            0231
*            DO;                   /* AN INCLUSIVE SERIES. IF    21050*
*            IF INPUTBUF(2)>='A' & /* IT IS, MUST HAVE NUMERIC   21050*
*              INPUTBUF(2)<='Z'    /* ENTRY. NO INCLUSIVE SYMBOL 21050*
*              THEN GO TO CECDEV43;/* ICS, HAVE ERROR CONDITION. 21050*
         CLI   1(@5),C'A'                                         0233
         BC    04,@9F1                                            0233
         CLI   1(@5),C'Z'                                         0233
         BC    13,CECDEV43                                        0234
*                                  /* ENTRY IS INCLUSIVE & NUMBER21050*
*         INCLST='1'B;             /* SET INCLUSIVE ENTRY FLG ON.21050*
@9F0     EQU   *                                                  0235
@9F1     OI    OLTEPSW7,B'10000000'                               0235
*         R5=R5+1;                 /* INCREMENT TO CHAR AFTER'-'.21050*
         AH    @5,@D1                                             0236
*         CHARCNTR=0;              /* RESET CHARACTER COUNTER    21050*
         SR    @F,@F                                              0237
         STH   @F,CHARCNTR                                        0237
*         R3=ADDR(CECDEV17);       /* RET PT AFTER CHAR SCAN.    21050*
         LA    @3,CECDEV17                                        0238
*         GO TO CECDEV03;          /* GO TO START OF SCAN CODE   21050*
         BC    15,CECDEV03                                        0239
* CECDEV17:                                                    /*21050*
*         DEVAD1='00000000';       /* CLEAR FIELD FOR CONVERT.   21051*
CECDEV17 MVC   DEVAD(8),@C13                                      0240
*         IGNORE=EIGHT-CHARCNTR+1; /* DETERMINE NON SIGNIFICANT  21050*
         LA    @F,1                                               0241
         SH    @F,CHARCNTR                                        0241
         AH    @F,EIGHT                                           0241
         STH   @F,IGNORE                                          0241
*                                  /* PART OF ADDRESS FIELD.     21050*
*         RELEASE(9);
*         DEVAD1(IGNORE:8)=INPUTBUF(1:CHARCNTR); /*LOAD PARM FLD 21050*
         LR    @E,@5                                              0243
         LA    @1,8                                               0243
         LR    @9,@F                                              0243
         SR    @1,@9                                              0243
         LA    @A,DEVAD-1(@9)                                     0243
         EX    @1,@MVC                                            0243
*         RESTRICT(9);
*         R1=ADDR(CNVRT2);         /* LST FOR CONVRT RTN. SET    21050*
         LA    @1,CNVRT2                                          0245
*         R15=TAB28;               /* PTRS TO RTN AND NEW MACROS 21050*
         L     @F,TAB28                                           0246
*         GEN(BALR R14,R15);       /* BRANCH TO CONVERSION MODULE21050*
         BALR R14,R15
         DS    0H
*         IF RC^=0 THEN            /* IF RETURN CODE NOT 0, THEN 21050*
         LTR   @F,@F                                              0248
*            GO TO CECDEV43;       /* PRNT MSG & REDEFINE TEST.  21050*
         BC    07,CECDEV43                                        0249
*         ERRCODE='60' ;           /* ERROR. SET INCLUSIVE VALID 21050*
         MVC   ERRCODE(2),@C14                                    0250
*                                  /* CODE AND CHECK FOR VALID EN21050*
*         IF FSTDEV>FINDEV THEN    /* CLUSIVE RANGE. 2F 1ST DEV  21050*
         L     @F,DEVAREA+4                                       0251
         C     @F,DEVAREA                                         0251
*            GO TO CECDEV45;       /* ADDR IS > LAST DEV ADDR,   21050*
         BC    04,CECDEV45                                        0252
*         R5=R5+CHARCNTR  ;        /* PRNT ERROR MSG. MOVE TO    21050*
         AH    @5,CHARCNTR                                        0253
*         GO TO CECDEV39;          /* NEXT DELIMITER.  GO TO CODE21050*
         BC    15,CECDEV39                                        0254
*         END;                     /* THAT HANDLES INCLSVE SERIES21050*
* CECDEV19:                                                    /*21050*
*         /************************************************************
*         /*                   IS DELIMITER A COMMA                   *
*         /************************************************************
*         IF INPUTBUF(1)=',' THEN   /* IS CHAR IN INBUFR A COMMA.     *
@9F2     EQU   *                                                  0256
CECDEV19 CLI   0(@5),C','                                         0256
         BC    07,@9EF                                            0256
*           DO;                     /* YES,                           *
*           R5=R5+1;                /* INCREMENT INBUFR POINTER TO    *
         AH    @5,@D1                                             0258
*                                   /* POINT TO NEXT DEVICE IN INBUFR.*
*         CHARCNTR=0;              /* RESET CHARACTER COUNTER    21050*
         SR    @F,@F                                              0259
         STH   @F,CHARCNTR                                        0259
*           GO TO CECDEV00;         /* GO TO ROUTINE THAT DECODES     *
         BC    15,CECDEV00                                        0260
*           END;                    /* THE DEVICES ENTERED.           *
*         /************************************************************
*         /*                   IS DELIMITER A SLASH                   *
*         /************************************************************
*         IF INPUTBUF(1)^='/' THEN  /* IS CHAR IN INBUFR A SLASH.     *
@9EF     CLI   0(@5),C'/'                                         0262
*           GO TO CECDEV41;         /* NO, ERROR - PRINT MESSAGE.21050*
         BC    07,CECDEV41                                        0263
*         IF UCBLOOK^=0 THEN        /* ARE MORE UCB LOOK UPS REQUIRED.*
         LTR   @7,@7                                              0264
         BC    08,@9EE                                            0264
*           DO;                     /* YES,                           *
*           R3=ADDR(CECDEV21);      /* SUPPLY UCB LOOK UP WITH RETURN *
         LA    @3,CECDEV21                                        0266
*                                  /*                            21050*
*           GO TO CECDEV31;         /* ADDRESS & GO TO UCB LOOK UP21050
         BC    15,CECDEV31                                        0267
*           END;                    /* ROUTINE.                       *
* CECDEV21:                                                    /*21050*
*         /************************************************************
*         /*                ARE THERE ANY GOOD ENTRIES                *
*         /************************************************************
*         IF GOODENT=0 THEN         /* ARE THERE ANY GOOD ENTRIES.    *
@9EE     EQU   *                                                  0269
CECDEV21 LTR   @6,@6                                              0269
         BC    07,@9ED                                            0269
*           DO;                     /* NO,                            *
* CECDEV23:                                                    /*21050*
*           R1=MSGPTR11;            /* PRINT ERROR MESSAGE.           *
CECDEV23 L     @1,4(0,@4)                                         0271
*           GEN(PWTO  REG=(1));     /* PRINT MESSAGE.                 *
         PWTO  REG=(1)
         DS    0H
*           GEN(BAL   R7,CECDE40B); /* CLEAR DEVICE TABLE       X03008*
         BAL   R7,CECDE40B
         DS    0H
*           GO TO CECDEV47;         /* RETURN TO REDEFINE       X03008*
         BC    15,CECDEV47                                        0274
*           END;
* CECDEV25:                                                    /*21050*
*         /************************************************************
*         /*                                                          *
*         /*                      EXIT ROUTINE                        *
*         /*                                                          *
*         /************************************************************
*         UNITCTR=GOODENT;          /* SAVE UNIT COUNTER. */
@9ED     EQU   *                                                  0276
CECDEV25 STH   @6,X                                               0276
*         UNICTR=UNITCTR1;
         MVC   UNICTR(1),X+1                                      0277
*         UNITUSE='00'X;            /* INITIALIZE UNIT USE COUNTER. */
         MVI   UNITUSE,X'00'                                      0278
*         INBUFPTR=R5;              /* SAVE INBUFR POINTER. */
         ST    @5,INBUFPTR                                        0279
*         GO TO CECDEV49;           /* SUCCESSFUL ENTRY IN DEV FIELD. *
         BC    15,CECDEV49                                        0280
*                                                              /*21050*
* CECDEV27:                                                    /*21050*
*         /************************************************************
*         /*                                                          *
*         /*              ROUTINE FOR SPECIAL ENTRIES                 *
*         /*                                                          *
*         /************************************************************
* CECDEV29:                                                    /*21050*
*         IF INPUTBUF(1:4)^='NDR/' THEN/* DOES INPUT BUFFER CONTAIN   *
CECDEV27 EQU   *                                                  0281
CECDEV29 CLC   0(4,@5),@C15                                       0281
*           GO TO CECDEV43;         /* NDR/. NO, PRINT ERROR MESSAGE. *
         BC    07,CECDEV43                                        0282
*                                                              /*21050*
*         R5=R5+3;                  /* YES, INCREMENT INBUFR POINTER. *
         AH    @5,@D2                                             0283
*         NDR='1'B;                 /* SET NDR FLAG ON.               *
         OI    OLTEPSW2,B'00000100'                               0284
*         PRIDVSCT=PRIDVSCT&&PRIDVSCT;/* CLEAR PRIMARY ENTRY IN SCT.  *
         XC    SCT+8(12),SCT+8                                    0285
*         LEGALDEV='1'B;            /* .NDR IS LEGAL DEVICE ENTRY 21051
         OI    OLTEPSW,B'00001000'                                0286
*         GO TO CECDEV25;           /* GO TO FINISH ROUTINE.     21050*
         BC    15,CECDEV25                                        0287
* CECDEV31:                                                    /*21050*
*         /************************************************************
*         /*                                                          *
*         /*     UCB LOOK UP FUNCTION FOR VALID DEVICE ENTRIES        *
*         /*                                                          *
*         /************************************************************
*         MODNUM='31';              /* PUT NAME OF CALLING MODULE IN  *
CECDEV31 MVC   SVCPLIST+2(2),@C16                                 0288
*                                   /* SVC PARAMETER LIST.            *
*         DEVTABPT=DEVTABPT-(UCBLOOK*TABLNGTH);
         LH    @F,TABLNGTH                                        0289
         MR    @E,@7                                              0289
         LCR   @F,@F                                              0289
         AR    @8,@F                                              0289
*                                   /* GIVE SVC POINTER TO LIST X03008*
*         ADDRDEV=DEVTABPT;         /* THAT MUST BE CHECKED.     21050*
         ST    @8,SVCPLIST+4                                      0290
*         ENTRIES=UCBLOOK;          /* TELL SVC HOW MANY UCB LOOK UPS *
         ST    @7,SVCPLIST+8                                      0291
*                                   /* IT MUST PERFORM.               *
*         SVCSAPTR=DIEPTR+40; /* ADDR OF SA IN PARM LIST Y02008 */
         LA    @F,40                                              0292
         A     @F,DIEPTR                                          0292
         ST    @F,SVCPLIST+12                                     0292
*         RESTRICT(1);
*         R1=64;                    /* SET SVC CALLING CODE PARAMETER *
         LA    @1,64                                              0294
*                                   /* IN REGISTER 1.                 *
*         R0=ADDR(ADDRDEV);         /* SET POINTER TO PARAMETER LIST. *
         LA    @0,SVCPLIST+4                                      0295
*         RELEASE(1);
*         GEN(SVC   59);            /* ISSUE SVC 59 FOR UCB LOOK UP.  *
         SVC   59
         DS    0H
*         X=0;                      /* INITIALIZE COUNTER TO ZERO.    *
         SR    @F,@F                                              0298
         STH   @F,X                                               0298
* CECDEV33:                                                    /*21050*
*         /************************************************************
*         /*           DO DEVICES ENTERED HAVE VALID UCBS             *
*         /************************************************************
*         IF DEVENQNG = '1'B THEN   /*  IS THE DEV UCB NOT AVAILABLE  *
CECDEV33 TM    15(@8),B'00000100'                                 0299
         BC    12,@9EC                                            0299
*           DO;                     /* YES                            *
*             RESTRICT(1);
*             R1=MSGPTR19;          /* GET POINTER TO MESSAGE.        *
         L     @1,36(0,@4)                                        0302
*             MSG109DV(01:08)=DEVADDR;   /* PUT DEV ADDR IN MSG       *
         MVC   12(8,@1),0(@8)                                     0303
*             IF ONOFF='1'B                /* CHECK DEV STATUS        *
*               THEN                       /* IF ITS ONLINE,  @ZA06048*
         TM    12(@8),B'10000000'                                 0304
         BC    12,@9EB                                            0304
*                 ONOROFF='ONLINE ,';      /* SAY SO          @ZA06048*
         MVC   21(8,@1),@C17                                      0305
         BC    15,@9EA                                            0306
*               ELSE                       /* IF ITS NOT      @ZA06048*
*                 ONOROFF='OFFLINE,';      /* SAY SO          @ZA06048*
@9EB     MVC   21(8,@1),@C18                                      0306
*             IF SYSALLOC='1'B             /* CHECK ALLOC     @ZA06048*
*               THEN                       /* IF ITS ALLOCATED        *
@9EA     TM    14(@8),B'00000100'                                 0307
         BC    12,@9E9                                            0307
*                 ALORNOT='ALLOCATED  ';   /* SAY SO          @ZA06048*
         MVC   29(11,@1),@C19                                     0308
         BC    15,@9E8                                            0309
*               ELSE                       /* IF ITS NOT      @ZA06048*
*                 ALORNOT='UNALLOCATED';   /* SAY SO          @ZA06048*
@9E9     MVC   29(11,@1),@C20                                     0309
*             RELEASE(1);
@9E8     EQU   *                                                  0310
*             GEN(PWTO  REG=(1));   /* PRINT MESSAGE.                 *
         PWTO  REG=(1)
         DS    0H
*             DEVENQNG = '0'B;      /* ZERO BIT                       *
         NI    15(@8),B'11111011'                                 0312
*           END;
*         IF NOGODEV = '1'B THEN   /*  IS THE DEV NOT AVAILABLE YM7253*
@9EC     TM    14(@8),B'00001000'                                 0314
         BC    12,@9E7                                            0314
*           DO;                     /* YES                      YM7253*
*             RESTRICT(1);                                    /*YM7253*
*             R1=MSGPTR67;          /* GET POINTER TO MESSAGE.  YM7253*
         L     @1,40(0,@4)                                        0317
*             MSG467DV(01:08)=DEVADDR;/* PUT DEV ADDR IN MSG    YM7253*
         MVC   12(8,@1),0(@8)                                     0318
*             RELEASE(1);                                     /*YM7253*
*             GEN(PWTO  REG=(1));   /* PRINT MESSAGE.           YM7253*
         PWTO  REG=(1)
         DS    0H
*             GOTO CECDEV37;        /* GOTO NEXT DEVICE         YM7253*
         BC    15,CECDEV37                                        0321
*           END;                                              /*YM7253*
*         IF UCBADDR=0 THEN         /* IS IT A VALID DEVICE.          *
@9E7     SR    @F,@F                                              0323
         MVC   @TEMP4(4),8(@8)                                    0323
         C     @F,@TEMP4                                          0323
         BC    07,@9E6                                            0323
*           DO;                     /* NO,                            *
*           RESTRICT(1);
*           R1=MSGPTR79;            /* GET POINTER TO MESSAGE.        *
         L     @1,8(0,@4)                                         0326
*           MSG179I(20:27)=DEVADDR;      /* PUT DEV ADDR IN MSG  21050*
         MVC   31(8,@1),0(@8)                                     0327
*           RELEASE(1);
*           GEN(PWTO  REG=(1));     /* PRINT MESSAGE.                 *
         PWTO  REG=(1)
         DS    0H
*           GO TO CECDEV37;         /* SKIP ENTRY.               21050*
         BC    15,CECDEV37                                        0330
*           END;
*         IF DEVVAR ='1'B THEN      /*  HAS THE DEVICE BEEN VARRIED OF*
@9E6     TM    15(@8),B'00001000'                                 0332
         BC    12,@9E5                                            0332
*           DO;                     /* YES                            *
*           RESTRICT(1);
*           R1=MSGPTR14;            /* GET POINTER TO MESSAGE.        *
         L     @1,32(0,@4)                                        0335
*           MSG140DV(01:08)=DEVADDR;     /* PUT DEV ADDR IN MSG       *
         MVC   12(8,@1),0(@8)                                     0336
*           RELEASE(1);
*           GEN(PWTO  REG=(1));     /* PRINT MESSAGE.                 *
         PWTO  REG=(1)
         DS    0H
*           DEVVAR = '0'B;
         NI    15(@8),B'11110111'                                 0339
*           END;
* CECDEV35:                                                    /*21050*
*         /************************************************************
*         /*                UPDATE OR PUSH UP ROUTINE                 *
*         /************************************************************
*         GOODENT=GOODENT+1;        /* INCREMENT GOOD ENTRIES COUNTER.*
@9E5     EQU   *                                                  0341
CECDEV35 LA    @6,1(0,@6)                                         0341
*         DEVTABLE=DEVTABXX;        /* PUSH UP INFORMATION IN DEVTAB. *
         L     @1,AVAILBLE                                        0342
         MVC   0(56,@1),0(@8)                                     0342
*         IF AVAILBLE^=DEVTABPT THEN/* IS THIS A PUSH UP.             *
         C     @8,AVAILBLE                                        0343
         BC    08,@9E4                                            0343
*         DEVTABXX=DEVTABXX&&DEVTABXX; /* ZERO DEVTABLE TO AVOID 21050*
         XC    0(56,@8),0(@8)                                     0344
*                                   /* ERROR IN OTHER POSSIBLE UCB    *
*                                   /* LOOK UPS.                      *
*         AVAILBLE=AVAILBLE+TABLNGTH;
@9E4     LH    @F,TABLNGTH                                        0345
         A     @F,AVAILBLE                                        0345
         ST    @F,AVAILBLE                                        0345
*                             /* INCREMENT AVAILABLE POINTER TO X03008*
*                                   /* NEXT AVAILABLE DEVTAB ENTRY21050
* CECDEV37:                                                    /*21050*
*         /************************************************************
*         /*   ROUTINE THAT DETERMINES IF MORE UCBS ARE OUTSTANDING   *
*         /************************************************************
*         X=X+1;                    /* INCREMENT COUNTER.             *
CECDEV37 LA    @F,1                                               0346
         AH    @F,X                                               0346
         STH   @F,X                                               0346
*         DEVTABPT=DEVTABPT+TABLNGTH;/*INCREMENT DEVTABLE POINTERX03008
         AH    @8,TABLNGTH                                        0347
*         IF X^=UCBLOOK THEN        /* ARE ALL UCBS CHECKED.          *
         CH    @7,X                                               0348
*           GO TO CECDEV33;         /* NO, LOOP.  YES, CONTINUE. 21050*
         BC    07,CECDEV33                                        0349
*         IF GOODENT=16 THEN        /* ARE THERE 16 GOOD ENTRIES.     *
         CH    @6,@D3                                             0350
*             GO TO CECDEV25;      /* YES, GO TO EXIT ROUTINE.   21050*
         BC    08,CECDEV25                                        0351
*         UCBLOOK=0;                /* SET UCBLOOK UP COUNTER TO 0.   *
         SR    @7,@7                                              0352
*         X=0;                      /* SET COUNTER TO 0.              *
         SR    @F,@F                                              0353
         STH   @F,X                                               0353
*         DEVTABPT=AVAILBLE;        /* SET DEVTAB POINTER TO NEXT     *
         L     @8,AVAILBLE                                        0354
*                                   /* AVAILABLE ENTRY IN DEVTAB.     *
*         LIMIT=16-GOODENT;         /* FIND NEW LIMIT.                *
         LA    @F,16                                              0355
         SR    @F,@6                                              0355
         STH   @F,LIMIT                                           0355
*         GO TO R3;                /* RET TO POINT IN REG 3.     21050*
         BCR   15,@3                                              0356
* CECDEV39:                                                    /*21050*
*         /************************************************************
*         /*                                                          *
*         /*     ROUTINE THAT HANDLES INCLUSIVE SERIES OF DEVICES     *
*         /*                                                          *
*         /************************************************************
*         FSTDEV=FSTDEV+1;          /* INCREMENT FSTDEV BY ONE.       *
CECDEV39 LA    @F,1                                               0357
         A     @F,DEVAREA                                         0357
         ST    @F,DEVAREA                                         0357
*         SAVENT=FSTDEV;           /* SAVE DEVICE FOR LATER USE. 21050*
         MVC   SAVENT(4),DEVAREA                                  0358
*         IF FSTDEV>FINDEV THEN     /* HAS INCLUSIVE SERIES BEEN FULLY*
         L     @F,DEVAREA+4                                       0359
         C     @F,DEVAREA                                         0359
         BC    10,@9E3                                            0359
*           DO;                     /* DECODED. YES, RESET INCLUSIVE  *
*           INCLST='0'B;            /* FLAG. MAKE SURE NEXT DELIMITER *
         NI    OLTEPSW7,B'01111111'                               0361
*           IF INPUTBUF(1)^='-' THEN/* IS NOT A HYPHEN.               *
         CLI   0(@5),C'-'                                         0362
*             GO TO CECDEV19;                                  /*21050*
         BC    07,CECDEV19                                        0363
*           GO TO CECDEV41;         /* ERROR, PRINT MESSAGE.     21050*
         BC    15,CECDEV41                                        0364
*           END;
*         SUM=GOODENT+UCBLOOK;      /*ADD TOTAL NO. DEVTAB ENTRYX03008*
@9E3     LR    @F,@7                                              0366
         AR    @F,@6                                              0366
         ST    @F,@TEMP4                                          0366
         MVC   SUM(3),@TEMP4+1                                    0366
*         IF SUM>'000000'X THEN     /* CHECK IF THIS FIRST DEV  X03008*
         L     @F,@X11                                            0367
         MVC   @TEMP3+1(3),SUM                                    0367
         C     @F,@TEMP3                                          0367
         BC    10,@9E2                                            0367
*           DO;                     /* NO                       X03008*
*             NEWADDR=FSTDEV2;      /* ADDR OF DEV IN SCAN HOLD X03008*
         MVC   NEWADDR(4),DEVAREA                                 0369
*             SAVLOOKT=UCBLOOK;     /* SAVE REG BEFOR SCAN      X03008*
         ST    @7,@TEMP4                                          0370
         MVC   SAVLOOKT(3),@TEMP4+1                               0370
*             GEN(BAL   R7,CECDE39B); /* SCAN TABLE FOR DUP ADDRX03008*
         BAL   R7,CECDE39B
         DS    0H
*             UCBLOOK=SAVLOOKT;     /* RESTORE REG AFTER SCAN   X03008*
         MVC   @TEMP3+1(3),SAVLOOKT                               0372
         L     @7,@TEMP3                                          0372
*           END;                                              /*X03008*
*         HEXADDR=FSTDEV2;          /* PUT HEX DEVICE ADDRESS IN      *
@9E2     MVC   32(4,@8),DEVAREA                                   0374
*                                   /* DEVTABLE ENTRY.                *
*         R1=ADDR(CNVRT3);          /* GET ADDRESS OF CONVERT PARMLIST*
         LA    @1,CNVRT3                                          0375
*         R15=TAB28;                /* GET ENTRY POINT ADDRESS.       *
         L     @F,TAB28                                           0376
*         GEN(BALR R14,R15);        /* EXECUTE CONVERT MODULE.        *
         BALR R14,R15
         DS    0H
*         IF RC^=0 THEN            /* IF RETURN CODE NOT 0 GO AND 21051
         LTR   @F,@F                                              0378
*         GO TO CECDEV43;          /* PRINT ERROR MESSAGE.       21051*
         BC    07,CECDEV43                                        0379
*         DEVADDR=DEVAD1;           /* PUT EBCDIC DEVICE ADDRESS IN   *
         MVC   0(8,@8),DEVAD                                      0380
*                                   /* DEVTABLE ENTRY.                *
*         UCBLOOK=UCBLOOK+1;        /* INCREMENT UCB LOOK UP COUNTER  *
         LA    @7,1(0,@7)                                         0381
*                                   /* BY ONE.                        *
*         DEVTABPT=DEVTABPT+TABLNGTH;/* INCREMENT DEVTABLE POINTER TO *
         AH    @8,TABLNGTH                                        0382
*                                   /* POINT TO NEXT ENTRY.     X03008*
*         IF UCBLOOK=LIMIT THEN     /* IS LIMIT OF UCB LOOK UPS       *
         CH    @7,LIMIT                                           0383
         BC    07,@9E1                                            0383
*           DO;                     /* REACHED. YES, GO TO UCB LOOK UP*
*                                   /* ROUTINE.                       *
*           R3=ADDR(CECDEV39);      /* GIVE UCB LOOK UP ROUTINE A 21050
         LA    @3,CECDEV39                                        0385
*                                   /* RETURN ADDRESS.                *
*           GO TO CECDEV31;         /* GO TO UCBLOOK UP ROUTINE. 21050*
         BC    15,CECDEV31                                        0386
*           END;
*         GO TO CECDEV39;           /* CONTINUE WITH INCLUSIVE DEVICE *
*                                   /* HANDLING.                 21050*
* CECDE39A:                                                   /*X03008*
*        /******************************************************X03008*
*        /*                                                     X03008*
*        /* DUPLICATE DEVICE SYMBOLIC ENTRY CHECK               X03008*
*        /*                                                     X03008*
*        /******************************************************X03008*
*        LOOPPTR=DEVTBPTR;          /*SET SCAN BASE START OF TABX03008*
CECDE39A MVC   LOOPPTR(4),DEVTBPTR                                0389
*        SUM=GOODENT+UCBLOOK;       /*TOTAL NO. DEV IN TAB CNTL.X03008*
         LR    @F,@7                                              0390
         AR    @F,@6                                              0390
         ST    @F,@TEMP4                                          0390
         MVC   SUM(3),@TEMP4+1                                    0390
*          DO Z=1 TO SUM     BY +1; /* SCAN DEVICE TAB SYMBOLIC X03008*
         LA    @A,1                                               0391
         BC    15,@DO9DF                                          0391
*            IF SYMNAM=SYMBNM THEN  /* IS NEW ENTRY EQ OLD ENTRYX03008*
@DO9E0   L     @1,LOOPPTR                                         0392
         CLC   SYMNAM(8),44(@1)                                   0392
*              GOTO   CECDE40A;     /* YES, ERROR               X03008*
         BC    08,CECDE40A                                        0393
*            LOOPPTR=LOOPPTR+TABLNGTH; /* INDEX BASE CHECK NEXT X03008*
         LH    @F,TABLNGTH                                        0394
         A     @F,LOOPPTR                                         0394
         ST    @F,LOOPPTR                                         0394
*         END;                      /* NO DUP SYMB NAME FOUND   X03008*
*        GOTO CECDEV06;             /* RETURN TO PROCESSING     X03008*
         AH    @A,@D1                                             0395
@DO9DF   MVC   @TEMP3+1(3),SUM                                    0395
         C     @A,@TEMP3                                          0395
         BC    12,@DO9E0                                          0395
         BC    15,CECDEV06                                        0396
* CECDE39B:                                                   /*X03008*
*        /******************************************************X03008*
*        /*                                                     X03008*
*        /* DUPLICATE DEVICE ADDRESS ENTRY CHECK                X03008*
*        /*                                                     X03008*
*        /******************************************************X03008*
*        LOOPPTR=DEVTBPTR;          /*SET SCAN BASE START OF TABX03008*
CECDE39B MVC   LOOPPTR(4),DEVTBPTR                                0397
*        SUM=GOODENT+SAVLOOKT;      /*TOTAL NO. DEV IN TAB CNTL.X03008*
         MVC   @TEMP3+1(3),SAVLOOKT                               0398
         L     @F,@TEMP3                                          0398
         AR    @F,@6                                              0398
         ST    @F,@TEMP4                                          0398
         MVC   SUM(3),@TEMP4+1                                    0398
*          DO Z=1 TO SUM     BY +1; /* SCAN DEVICE TAB ADDRESS  X03008*
         LA    @A,1                                               0399
         BC    15,@DO9DB                                          0399
*            IF NEWADDR=HXADDR THEN /* IS NEW ENTRY EQ OLD ENTRYX03008*
@DO9DC   L     @1,LOOPPTR                                         0400
         CLC   NEWADDR(4),32(@1)                                  0400
*              GOTO CECDE40A;       /* YES, ERROR               X03008*
         BC    08,CECDE40A                                        0401
*            LOOPPTR=LOOPPTR+TABLNGTH; /* INDEX BASE CHECK NEXT X03008*
         LH    @F,TABLNGTH                                        0402
         A     @F,LOOPPTR                                         0402
         ST    @F,LOOPPTR                                         0402
*          END;                     /* NO DUP ADDR FOUND        X03008*
*        GEN(BR     R7);            /* RETURN TO PROCESSING     X03008*
         AH    @A,@D1                                             0403
@DO9DB   MVC   @TEMP3+1(3),SUM                                    0403
         C     @A,@TEMP3                                          0403
         BC    12,@DO9DC                                          0403
         BR     R7
         DS    0H
* CECDEV40:                                                   /*X03008*
*        /******************************************************X03008*
*        /*                                                     X03008*
*        /* OUTPUT IFD252I NO MIX OF ADDR AND SYMBOLIC IN DEV INPUT   *
*        /*                                                     X03008*
*        /******************************************************X03008*
*        R1=MSGPTR52;               /* SET MSG PTR TO IFD252I   X03008*
CECDEV40 L     @1,28(0,@4)                                        0405
*        GEN(PWTO  REG=(1));        /* ISSUE MESSAGE            X03008*
         PWTO  REG=(1)
         DS    0H
*        GEN(BAL   R7,CECDE40B);    /* CLEAR DEVICE TABLE       X03008*
         BAL   R7,CECDE40B
         DS    0H
*        GOTO CECDEV46;             /* ISSUE PROMPTING          X03008*
         BC    15,CECDEV46                                        0408
* CECDE40A:                                                   /*X03008*
*        /******************************************************X03008*
*        /*                                                     X03008*
*        /* OUTPUT IFD251I DUPLICATE ENTRIES IN DEVICE FEILD    X03008*
*        /*                                                     X03008*
*        /******************************************************X03008*
*        R1=MSGPTR51;               /* SET MSG PTR TO IFD251I   X03008*
CECDE40A L     @1,24(0,@4)                                        0409
*        GEN(PWTO  REG=(1));        /* ISSUE MESSAGE            X03008*
         PWTO  REG=(1)
         DS    0H
*        GEN(BAL   R7,CECDE40B);    /* CLEAR DEVICE TABLE       X03008*
         BAL   R7,CECDE40B
         DS    0H
*        GOTO CECDEV46;             /* ISSUE PROMPTING          X03008*
         BC    15,CECDEV46                                        0412
* CECDE40B:                                                   /*X03008*
*        /******************************************************X03008*
*        /*                                                     X03008*
*        /* CLEAR DEVICE TABLE ON ERROR                         X03008*
*        /*                                                     X03008*
*        /******************************************************X03008*
*         R8=DEVTBPTR;              /* DEVICE TABLES            X03008*
CECDE40B L     @8,DEVTBPTR                                        0413
*         DO R9=TABLNGTH BY -1 TO 1;/* TABLE LENGTH             X03008*
         LH    @9,TABLNGTH                                        0414
         LTR   @9,@9                                              0414
         BC    12,@DO9D7                                          0414
*           DVT=DVT&&DVT;           /* ZERO TABLE AREA          X03008*
@DO9D8   XC    0(16,@8),0(@8)                                     0415
*           R8=ADDR(DVTN);          /* NEXT TABLE AREA          X03008*
         LA    @8,16(0,@8)                                        0416
*         END;                      /* DEVICE TABLE CLEARED     X03008*
*         GEN(BR   R7);             /* RETURN                   X03008*
         BCT   @9,@DO9D8                                          0417
@DO9D7   EQU   *                                                  0417
         BR   R7
         DS    0H
* CECDEV41:                                                    /*21050*
*         /************************************************************
*         /*                                                          *
*         /*  PARALLEL PRINT MESSAGE IFD108I AND RETURN TO REDEFINE   *
*         /*                                                          *
*         /************************************************************
*         ERRCODE='01';             /* SET ERROR CODE TO 01.          *
CECDEV41 MVC   ERRCODE(2),@C21                                    0419
*         GO TO CECDEV45;           /* GO PRINT MESSAGE.         21050*
         BC    15,CECDEV45                                        0420
* CECDEV43:                                                    /*21050*
*         ERRCODE='02';             /* SET ERROR CODE TO 02.          *
CECDEV43 MVC   ERRCODE(2),@C22                                    0421
* CECDEV45:                                                    /*21050*
*         R1=MSGPTR08;              /* GET POINTER TO MESSAGE.        *
CECDEV45 L     @1,0(0,@4)                                         0422
*         MSG108I(26:27)=ERRCODE;       /* PUT ERROR CODE IN MSG.     *
         MVC   37(2,@1),ERRCODE                                   0423
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 *
         PWTO  REG=(1)
         DS    0H
* CECDEV46:                                                   /*X03906*
*        /******************************************************X03906*
*        /*                                                     X03906*
*        /* OUTPUT IFD161I PROMPTING                            X03906*
*        /*                                                     X03906*
*        /******************************************************X03906*
*         R1=MSGPTR61;              /* GET POINTER TO MESSAGE.        *
CECDEV46 L     @1,12(0,@4)                                        0425
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 *
         PWTO  REG=(1)
         DS    0H
* CECDEV47:
*         /************************************************************
*         /*    CHANGE RETURN POINT SO THAT TEST CAN BE REDEFINED     *
*         /************************************************************
*         LEGALDEV='0'B;                /* INVALID D/T/O/ ENTRY.      *
CECDEV47 NI    OLTEPSW,B'11110111'                                0427
*         YOURR14=REDEFINE;         /* ALTER RETURN POINT TO IFDOLT30.*
         L     @1,4(0,@D)          
         MVC   12(4,@1),REDEFINE                                  0428
* CECDEV49:                                                    /*21050*
*         /************************************************************
*         /*                    RETURN TO CALLER                      *
*         /************************************************************
*         DPMSGREI='0'B;                /* TURN OFF DP MSG REI  XM9156*
CECDEV49 NI    A00013,B'11111110'                                 0429
*         RETURN;
*         END;
@EL01    L     @D,4(0,@D)                                         0431
         LM    @E,@C,12(@D)                                       0431
         BCR   15,@E                                              0431
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D1      DC    H'1'
@D2      DC    H'3'
@D3      DC    H'16'
@MVC     MVC   0(1,@A),0(@E)
@V1      DC    V(IFDMSG31)
         DS    0F
@X11     DC    X'00000000'
@C12     DC    C'0999'
@C13     DC    C'00000000'
@C15     DC    C'NDR/'
@C17     DC    C'ONLINE ,'
@C18     DC    C'OFFLINE,'
@C2      DC    C'.N'
@C14     DC    C'60'
@C16     DC    C'31'
@C21     DC    C'01'
@C22     DC    C'02'
@C19     DC    C'ALLOCATED  '
@C20     DC    C'UNALLOCATED'
         DS    0D
@DATA    EQU   *
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD
R0       EQU   00000000            FULLWORD POINTER REGISTER
R1       EQU   00000001            3  BYTE  POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD POINTER REGISTER
I        EQU   00000003            FULLWORD POINTER REGISTER
R4       EQU   00000004            FULLWORD POINTER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
R7       EQU   00000007            FULLWORD POINTER REGISTER
GOODENT  EQU   00000006            3  BYTE  POINTER REGISTER
UCBLOOK  EQU   00000007            3  BYTE  POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
DEVTABPT EQU   00000008            FULLWORD POINTER REGISTER
R9       EQU   00000009            3  BYTE  POINTER REGISTER
Z        EQU   00000010            3  BYTE  POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
RC       EQU   00000015            FULLWORD POINTER REGISTER
R15      EQU   00000015            FULLWORD POINTER REGISTER
MYSAVE   EQU   00000000            8 BYTE(S) ON WORD
A00000   EQU   MYSAVE+00000000     4 BYTE(S)
YOURR13  EQU   MYSAVE+00000004     FULLWORD POINTER
YOURSAVE EQU   00000000            16 BYTE(S) ON WORD
A00001   EQU   YOURSAVE+00000000   12 BYTE(S)
YOURR14  EQU   YOURSAVE+00000012   FULLWORD POINTER
INPUTBUF EQU   00000000            10 BYTE(S)
DEVTABXX EQU   00000000            56 BYTE(S)
DEVADDR  EQU   DEVTABXX+00000000   8 BYTE(S)
UCBADDR  EQU   DEVTABXX+00000008   4  BYTE  POINTER
FLG1     EQU   DEVTABXX+00000012   1 BYTE(S)
ONOFF    EQU   DEVTABXX+00000012   1 BIT(S)
PRIMARY  EQU   DEVTABXX+00000012   1 BIT(S)
A00017   EQU   DEVTABXX+00000013   1 BYTE(S)
FLG3     EQU   DEVTABXX+00000014   1 BYTE(S)
A00018   EQU   DEVTABXX+00000014   4 BIT(S)
NOGODEV  EQU   DEVTABXX+00000014   1 BIT(S)
SYSALLOC EQU   DEVTABXX+00000014   1 BIT(S)
A00019   EQU   DEVTABXX+00000014   2 BIT(S)
FLG4     EQU   DEVTABXX+00000015   1 BYTE(S)
A00020   EQU   DEVTABXX+00000015   4 BIT(S)
DEVVAR   EQU   DEVTABXX+00000015   1 BIT(S)
DEVENQNG EQU   DEVTABXX+00000015   1 BIT(S)
A00021   EQU   DEVTABXX+00000015   2 BIT(S)
A00022   EQU   DEVTABXX+00000016   16 BYTE(S)
HEXADDR  EQU   DEVTABXX+00000032   4 BYTE(S)
CDSDVDSC EQU   DEVTABXX+00000036   4 BYTE(S)
MODEL    EQU   DEVTABXX+00000036   1 BYTE(S)
FEATURES EQU   DEVTABXX+00000037   1 BYTE(S)
CLASS    EQU   DEVTABXX+00000038   1 BYTE(S)
TYPE     EQU   DEVTABXX+00000039   1 BYTE(S)
BYTECNT  EQU   DEVTABXX+00000040   1 BYTE(S)
CDSFLAGS EQU   DEVTABXX+00000041   1 BYTE(S)
A00023   EQU   DEVTABXX+00000041   4 BIT(S)
SYMDEVIC EQU   DEVTABXX+00000041   1 BIT(S)
A00024   EQU   DEVTABXX+00000041   2 BIT(S)
REMLINE  EQU   DEVTABXX+00000041   1 BIT(S)
EXTSGMSK EQU   DEVTABXX+00000042   2 BYTE(S)
SYMNAME  EQU   DEVTABXX+00000044   8 BYTE(S)
MSGPTR   EQU   00000000            44 BYTE(S) ON WORD
MSGPTR08 EQU   MSGPTR+00000000     FULLWORD POINTER
MSGPTR11 EQU   MSGPTR+00000004     FULLWORD POINTER
MSGPTR79 EQU   MSGPTR+00000008     FULLWORD POINTER
MSGPTR61 EQU   MSGPTR+00000012     FULLWORD POINTER
MSGPTR27 EQU   MSGPTR+00000016     FULLWORD POINTER
MSGPTR65 EQU   MSGPTR+00000020     FULLWORD POINTER
MSGPTR51 EQU   MSGPTR+00000024     FULLWORD POINTER
MSGPTR52 EQU   MSGPTR+00000028     FULLWORD POINTER
MSGPTR14 EQU   MSGPTR+00000032     FULLWORD POINTER
MSGPTR19 EQU   MSGPTR+00000036     FULLWORD POINTER
MSGPTR67 EQU   MSGPTR+00000040     FULLWORD POINTER
MSG108   EQU   00000000            40 BYTE(S) ON WORD
A00025   EQU   MSG108+00000000     12 BYTE(S)
MSG108I  EQU   MSG108+00000012     28 BYTE(S)
MSG140   EQU   00000000            20 BYTE(S) ON WORD
A00026   EQU   MSG140+00000000     12 BYTE(S)
MSG140DV EQU   MSG140+00000012     8 BYTE(S)
MSG467   EQU   00000000            20 BYTE(S) ON WORD
A00027   EQU   MSG467+00000000     12 BYTE(S)
MSG467DV EQU   MSG467+00000012     8 BYTE(S)
MSG190   EQU   00000000            40 BYTE(S) ON WORD
A00028   EQU   MSG190+00000000     12 BYTE(S)
MSG109DV EQU   MSG190+00000012     8 BYTE(S)
A00029   EQU   MSG190+00000020     1 BYTE(S)
ONOROFF  EQU   MSG190+00000021     8 BYTE(S)
ALORNOT  EQU   MSG190+00000029     11 BYTE(S)
MSG179   EQU   00000000            39 BYTE(S) ON WORD
A00030   EQU   MSG179+00000000     12 BYTE(S)
MSG179I  EQU   MSG179+00000012     27 BYTE(S)
MSG127   EQU   00000000            31 BYTE(S) ON WORD
A00031   EQU   MSG127+00000000     12 BYTE(S)
MSG127I  EQU   MSG127+00000012     19 BYTE(S)
A00032   EQU   00000000            32 BYTE(S) ON WORD
DVT      EQU   A00032+00000000     16 BYTE(S)
DVTN     EQU   A00032+00000016     16 BYTE(S)
SUM      EQU   @DATA+00000073      3  BYTE  POINTER ON WORD+1
SAVLOOKT EQU   @DATA+00000077      3  BYTE  POINTER ON WORD+1
PARMLIST EQU   @DATA+00000080      16 BYTE(S) ON WORD
MODNAME  EQU   PARMLIST+00000000   8 BYTE(S)
         ORG   PARMLIST+00000000
TCDSO    EQU   *                   1 BYTE(S)
         DC    C'G'
CDSDEV   EQU   PARMLIST+00000001   7 BYTE(S)
TARGETAD EQU   PARMLIST+00000008   FULLWORD POINTER
PARMFLGS EQU   PARMLIST+00000012   1 BYTE(S)
A00033   EQU   PARMLIST+00000013   1 BYTE(S)
CDSLNGTH EQU   PARMLIST+00000014   HALFWORD INTEGER
COUNT    EQU   00000007            FULLWORD POINTER REGISTER
AVAILBLE EQU   @DATA+00000096      FULLWORD POINTER
DEVTABLE EQU   00000000            56 BYTE(S)
DEVAREA  EQU   @DATA+00000100      16 BYTE(S)
FSTDEV   EQU   DEVAREA+00000000    4  BYTE  INTEGER
FSTDEV2  EQU   DEVAREA+00000000    4 BYTE(S)
HEX      EQU   DEVAREA+00000000    4 BYTE(S)
FINDEV   EQU   DEVAREA+00000004    4  BYTE  INTEGER
FINDEV2  EQU   DEVAREA+00000004    4 BYTE(S)
LOOPPTR  EQU   @DATA+00000116      FULLWORD POINTER
A00034   EQU   00000000            56 BYTE(S)
A00035   EQU   A00034+00000000     32 BYTE(S)
HXADDR   EQU   A00034+00000032     4 BYTE(S)
A00036   EQU   A00034+00000036     8 BYTE(S)
SYMBNM   EQU   A00034+00000044     8 BYTE(S)
NEWADDR  EQU   @DATA+00000120      4 BYTE(S)
LIMIT    EQU   @DATA+00000124      HALFWORD INTEGER
X        EQU   @DATA+00000126      HALFWORD INTEGER
UNITCTR  EQU   X+00000000          HALFWORD INTEGER
A00037   EQU   X+00000000          1 BYTE(S)
UNITCTR1 EQU   X+00000001          1 BYTE(S)
ERRCODE  EQU   @DATA+00000128      2 BYTE(S)
         ORG   @DATA+00000130
NUMBERS  EQU   *                   16 BYTE(S)
         DC    C'0123456789ABCDEF'
NUMBER   EQU   00000000            1 BYTE(S)
DEVAD    EQU   *                   8 BYTE(S)
         DC    C'0000'
         DC    00004C' '
DEVAD1   EQU   DEVAD+00000000      8 BYTE(S)
SWITCHES EQU   @DATA+00000154      1 BYTE(S)
FRSTPASS EQU   SWITCHES+00000000   1 BIT(S)
UCBDVDSC EQU   00000016            4 BYTE(S)
CDSENTRY EQU   00000000            20 BYTE(S)
A00038   EQU   CDSENTRY+00000000   4 BYTE(S)
DSCRPTRS EQU   CDSENTRY+00000004   4 BYTE(S)
CHARCNTR EQU   @DATA+00000156      HALFWORD INTEGER
         ORG   @DATA+00000158
EIGHT    EQU   *                   HALFWORD INTEGER
         DC    FL2'8'
BLANKFLD EQU   *                   8 BYTE(S)
&T       SETA  00001
.L099999 ANOP
         DC    C' '
         DC    00007C' '
SYMNAM   EQU   @DATA+00000168      8 BYTE(S)
IGNORE   EQU   @DATA+00000176      HALFWORD INTEGER
OFLGS    EQU   00000048            8 BIT(S) ON BYTE
DDDUMMY  EQU   00000017            1 BYTE(S)
         ORG   @DATA
         DS    00000192C
@TEMPS   DS    0F
@TEMP3   DC    F'0'
@TEMP4   DC    F'0'
         CNOP  0,4
CNVRT1   DC    B'00000000'
         DC    AL1(2)
         DC    CL2'41'
         DC    A(DEVAD)
         DC    A(HEX)
C0021    DC    AL2(8+0)                                          21050
         CNOP  0,4
CNVRT2   DC    B'00000000'
         DC    AL1(2)
         DC    CL2'41'
         DC    A(DEVAD)
         DC    A(FINDEV2)
C0022    DC    AL2(8+0)                                          21050
         CNOP  0,4
CNVRT3   DC    B'00000000'
         DC    AL1(2)
         DC    CL2'41'
         DC    A(FSTDEV2)
         DC    A(DEVAD)
C0023    DC    AL2(4+32768)
DEVCOM   IFDCOM
SCT      EQU   CHASCT+00000000     20 BYTE(S) ON WORD
HEADER   EQU   SCT+00000000        8 BYTE(S)
PRIDVSCT EQU   SCT+00000008        12 BYTE(S)
OLTEPSW  EQU   CESWT+00000000      1 BYTE(S) ON WORD
A00002   EQU   OLTEPSW+00000000    4 BIT(S)
LEGALDEV EQU   OLTEPSW+00000000    1 BIT(S)
REINT    EQU   OLTEPSW+00000000    1 BIT(S)
OLTEPSW2 EQU   CESWT2+00000000     1 BYTE(S) ON WORD
A00003   EQU   OLTEPSW2+00000000   3 BIT(S)
CHANTEST EQU   OLTEPSW2+00000000   1 BIT(S)
A00004   EQU   OLTEPSW2+00000000   1 BIT(S)
NDR      EQU   OLTEPSW2+00000000   1 BIT(S)
OLTEPSW7 EQU   CESWT7+00000000     1 BYTE(S) ON WORD
INCLST   EQU   OLTEPSW7+00000000   1 BIT(S)
RETTO31  EQU   OLTEPSW7+00000000   1 BIT(S)
REMOTE   EQU   OLTEPSW7+00000000   1 BIT(S)
LOADCDS  EQU   OLTEPSW7+00000000   1 BIT(S)
OLTEPSW9 EQU   CESWT9+00000000     1 BYTE(S) ON WORD
A00005   EQU   OLTEPSW9+00000000   5 BIT(S)
MIXDEV   EQU   OLTEPSW9+00000000   1 BIT(S)
A00006   EQU   OLTEPSW9+00000000   2 BIT(S)
A00007   EQU   CESWTR+00000000     1 BYTE(S)
RETAINAC EQU   A00007+00000000     1 BIT(S)
A00008   EQU   A00007+00000000     1 BIT(S)
REMNOMSG EQU   A00007+00000000     1 BIT(S)
A00009   EQU   A00007+00000000     5 BIT(S)
A00010   EQU   CESWTR1+00000000    1 BYTE(S)
A00011   EQU   A00010+00000000     5 BIT(S)
REMANS   EQU   A00010+00000000     1 BIT(S)
A00012   EQU   A00010+00000000     2 BIT(S)
A00013   EQU   CESWTR2+00000000    1 BYTE(S)
A00014   EQU   A00013+00000000     2 BIT(S)
ONCOMM   EQU   A00013+00000000     1 BIT(S)
A00015   EQU   A00013+00000000     4 BIT(S)
DPMSGREI EQU   A00013+00000000     1 BIT(S)
SVCPLIST EQU   ROPT-00000004       16 BYTE(S) ON WORD
A00016   EQU   SVCPLIST+00000000   2 BYTE(S)
MODNUM   EQU   SVCPLIST+00000002   2 BYTE(S)
ADDRDEV  EQU   SVCPLIST+00000004   FULLWORD POINTER
ENTRIES  EQU   SVCPLIST+00000008   FULLWORD INTEGER
SVCSAPTR EQU   SVCPLIST+00000012   FULLWORD POINTER
@DATEND  EQU   *
@9FD     EQU   CECDEV19
@9F9     EQU   CECDEV03
@9E1     EQU   CECDEV39
         END    ,(C'PL/S',1400,75339)

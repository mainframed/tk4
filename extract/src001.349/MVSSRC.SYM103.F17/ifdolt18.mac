         TITLE ' RESIDENT TRANSIENT MANAGER.  IFDOLT18'
         TITLE ' RESIDENT TRANSIENT MANAGER.  IFDOLT18'
         LCLA  &T,&SPN                                            0002
.@001    ANOP                                                     0002
IFDOLT18 CSECT ,                                                  0002
         BC    15,24(0,@F)
         DC    C'IFDOLT18 17 NOV 73'                             0002
         STM   @E,@C,12(@D)                                       0002
         BALR  @B,0                                               0002
@PSTART  DS    0H                                                 0002
         USING @PSTART+00000,@B                                   0002
         ST    @D,@SAV001+4                                       0002
         LA    @F,@SAV001                                         0002
         ST    @F,8(0,@D)                                         0002
         LR    @D,@F                                              0002
*  GEN(USING CHASCT,2);                  /* COMMON AREA BASE REGISTER *
         USING CHASCT,2
         DS    0H
* GENERATE DATA;
*  RESTRICT(2,3,4,5,6,7,8,9);
*  DCL R0 REG(0) PTR;
*  DCL R1 REG(1) PTR;
*  DCL R2 REG(2) PTR;                    /* POINTER TO COMMON AREA */
*  DCL R3 REG(3) PTR;
*  DCL R4 REG(4) PTR;
*  DCL R5 REG(5) PTR;
*  DCL R6 REG(6) PTR;
*  DCL R7 REG(7) PTR;                    /* REGISTER 7 */
*  DCL R8 REG(8) PTR;
*  DCL R9 REG(9) PTR;                    /* REGISTER 9 */
*  DCL R11 REG(11) PTR;                  /* BASE REGISTER       X02008*
*  DCL R12 REG(12) PTR;
*  DCL R13 REG(13) PTR;
*  DCL R14 REG(14) PTR;                  /* RETURN REGISTER */
*  DCL R15 REG(15) PTR;
*  DCL MSGMOD PTR GENERATED;             /* MESSAGE MODULE */
*  DCL SCHEDSA PTR GENERATED;            /* SCHEDULER SAVE AREA */
*  DCL LOGADR PTR GENERATED;             /* POINTER TO LOGSCAN MODULE *
*  DCL TRA000 CHAR(1) GENERATED;         /* PROGRAM LOCATION    X02008*
*  DCL TRA001 LABEL;                     /* INDIVIDUAL ENTRY POINTS */
*  DCL TRA002C LABEL;
*  DCL TRA002 INT ENTRY;                 /* COMMON ENTRY POINT */
*  DCL IFDOLT23 EXT ENTRY;               /* COMMON AREA MODULE */
*  DCL IFDOLT39 EXT ENTRY;
*  DCL COMADR PTR INIT(ADDR(IFDOLT23));  /* COMMON AREA ADDRESS */
*  DCL WKSVC GENERATED;                  /* SVC WORK AREA */
*  DCL TABAD PTR GENERATED;              /* POINTER TO LINK TABLE */
*  DCL MCT CHAR(208) GENERATED;          /* MODULE CONTROL TABLE */
*  DCL CESWT2 GENERATED;                 /* OLTEP SWITCHES */
*  DCL CESWT6 GENERATED;                 /* OLTEP SWITCHES */
*  DCL COMMINT PTR GENERATED;            /* DYN COMMUNICATE */
*  DCL ECB3 FIXED GENERATED;             /* ECB FOR DYN COMMUNICATE */
*  DCL DEVTBPTR PTR GENERATED;           /* DEVICE TABLE PTR    X02008*
*  DCL LGWRTCT CHAR(2) GENERATED;        /* LARGE WRITE COUNT   X02008*
*  DCL LGWRTFLD PTR BASED(ADDR(LGWRTCT)-4); /* LARGE WRITE ADR  X02008*
*  DCL EXPAND1 FIXED GENERATED;          /* PARTITION SIZE            *
*  DCL OPFLG BIT(8) BASED(R9+48);        /* OPEN BIT                  *
*  DCL 1 * BIT(8) BASED(ADDR(CESWT2)),   /* OLTEP SWITCHES */
*         2 NDCFO BIT(1),                /* NO DYN COMMUN */
*         2 PLKMRB BIT(1),               /* PLINK OR MORECORE REQUEST *
*         2 FECOND BIT(1),               /* FIRST ERROR CONDITION */
*         2 * BIT(1);                    /* NA */
*  DCL CESWT3 CHAR(1) GENERATED;         /* OLTEP SWITCHES       M4506*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWT3)),  /* OLTEP SWITCHES       M4506*
*         2 * BIT(3),                    /* NA                   M4506*
*         2 GRBCTL BIT(1),               /* GRAB IN CONTROL      M4506*
*         2 SUSDEL BIT(1),               /* SUSPENDED DELETION   M4506*
*           3 * BIT(1);                  /* NA                   M4506*
*  DCL 1 * BIT(8) BASED(ADDR(CESWT6)),   /* OLTEP SWITCHES */
*         2 UTSCAL BIT(1);               /* UTS CALLER */
*  DCL CHASCT CHAR(80) GENERATED;        /* SCT ADDRESS */
*  DCL SECLST GENERATED;                 /* SECTION LIST */
*  DCL PARTITEM CHAR(12) GENERATED;      /* PARTITION ITEMS     X02008*
*  DCL 1 * BDY(WORD) BASED(ADDR(PARTITEM)), /* PARTITION ITEMS  X02008*
*         2 PARADR PTR,                  /* PARTITION ADDRESS   X02008*
*         2 PARSZ FIXED,                 /* PARTITION SIZE      X02008*
*               9 * CHAR(1);             /* NA                  X02008*
*  DCL OLTTAB PTR GENERATED;             /* LINK TABLE */
*  DCL SECPTR PTR GENERATED;             /* UTS GENERATED */
*  DCL HRTSEL CHAR(2) GENERATED;         /* HIGHEST ROUTINE BYTES */
*  DCL 1 * BASED(ADDR(HRTSEL)),          /* HIGHEST ROUTINE BYTES */
*         2 TERTN CHAR(1),               /* LAST ROUTINE IN UTS */
*         2 HIRTN CHAR(1);               /* HIGHEST ROUTINE SELECTED */
*  DCL 1 * BASED(ADDR(OLTTAB)),          /* LINK TABLE */
*         2 *(8) PTR,                    /* ENTRY POINTS FOR MACROS */
*         2 TMCOMAD PTR,                 /* TRANSIENT MANAGER AREA */
*         2 SECPRF PTR,                  /* SECTION PREFACE ADDRESS */
*           3 * PTR;                     /* LAST POINTER */
*  DCL 1 * BASED(R3+4),                  /* FLAG SECTION OF ROUTINE */
*         2 RTNEXT PTR,                  /* NEXT ROUTINE ADDRESS */
*         2 RTNN CHAR(1),                /* ROUTINE NUMBER */
*         2 REFN CHAR(1),                /* REFERENCE NUMBER */
*         2 RFLG BIT(8),                 /* ROUTINE FLAGS */
*           3 MIMK BIT(1),               /* MI MASK BIT */
*           3 TERM BIT(1),               /* TERMINATION BIT */
*           3 * BIT(1);                  /* END OF BYTE */
*  DCL RTN CHAR(1) BASED(R7);            /* ROUTINE NUMBER */
*  DCL REFNUM CHAR(1) BASED(R7+17);      /* REFERENCE NUMBER */
*  DCL 1 * BASED(ADDR(CHASCT)),          /* SECTION CONTROL TABLE */
*         2 SCTW0 FIXED,                 /* SCT WORD 0 */
*           3 * CHAR(2),                 /* FIRST BYTES OF WORD */
*           3 * BIT(8),                  /* BYTE OF BITS */
*             4 * BIT(5),                /* BIT ALIGNMENT */
*             4 NPR BIT(1),              /* NO PRINT INDICATOR */
*           3 * BIT(8),                  /* FLAGS */
*             4 ERBT BIT(1),             /* ERROR BIT FOR ROUTINE */
*             4 ASTERB BIT(1),           /* ASTERISK INDICATES ERROR */
*             4 CATB1 BIT(1),            /* CATASTROPHIC BIT */
*             4 * BIT(3),                /* NA */
*             4 ERLOP BIT(1),            /* ERROR LOOP */
*         2 SCTW1 FIXED,                 /* SCT WORD 1 */
*         2 SCTW2 FIXED,                 /* SCT WORD 2 */
*         2 SCTW3 FIXED,                 /* SCT WORD 3 */
*         2 SCTW4 FIXED,                 /* SCT WORD 4 */
*         2 SCTW5 FIXED,                 /* SCT WORD 5 */
*         2 SCTW6 FIXED,                 /* SCT WORD 6 */
*         2 SCTW7 FIXED,                 /* SCT WORD 7 */
*         2 SCTW8 FIXED,                 /* SCT WORD 8 */
*           3 * CHAR(1),                 /* ROUTINE MASK COUNT LENGTH *
*           3 * BIT(8),                  /* FLAGS */
*             4 * BIT(5),                /* NA                  X02008*
*             4 CLEANUP BIT(1),          /* UTS CLEAN UP ENTRY  X02008*
*           3 SCTW82 FIXED(15),          /* UTS SIZE IN FULL WORDS */
*         2 SCTW9 FIXED,                 /* SCT WORD 9 */
*           3 * BIT(8),                  /* FLAGS */
*             4 MIBT BIT(1),             /* MI BIT */
*            4 CLEANRT BIT(1),           /* OLT HAS CLEANUP     X03008*
*            4 * BIT(2),                 /* NA                  X03008*
*             4 RETCODE BIT(1),          /* RETURN CODE SUPPORT X02008*
*             4 TRACE BIT(1),            /* TRACE FUNCTION      X02008*
*           3 * CHAR(1),
*           3 SCTW9C CHAR(2),
*         2 SCTW10 FIXED,                /* SCT WORD 10 TO 17 */
*         2 *(2) PTR;                    /* TOTE USE */
*  DCL 1 * BASED(R5),                    /* ROUTINE MASK */
*         2 RTN8(32) CHAR(1);            /* ROUTINE MASK ADDRESS */
*  DCL 1 * BASED(R5),                    /* ROUTINE TO RUN */
*         2 RTNB BIT(8);                 /* INDIVIDUAL ROUTINE */
*  DCL RST15 PTR BASED(R13+16);          /* REG 15 SAVED */
*  DCL 1 * BASED(R13),                   /* SAVE AREA           X02008*
*         2 * FIXED,                     /* FIRST WORD          X02008*
*         2 CHNBK PTR,                   /* CALLER SAVE AREA    X02008*
*         2 SR13 PTR,                    /* REG 13 SAVED        X02008*
*         2 SR14 PTR,                    /* REG 14 SAVED        X02008*
*         2 SR15 PTR,                    /* REG 15 SAVED        X02008*
*         2 SR0 PTR,                     /* REG 0 SAVED         X02008*
*         2 SR1 PTR,                     /* REG 1 SAVED         X02008*
*           3 * PTR;                     /* LAST ITEM           X02008*
*  DCL 1 I FIXED,                        /* FIXED WORD WORK AREAX02008*
*         2 * CHAR(3),                   /* WORK BYTES          X02008*
*         2 I4 CHAR(1);                  /* WORK BYTE           X02008*
*  DCL RID CHAR(1) BASED(ADDR(MCT)+9);   /* ROOT ID BLOCK       X02008*
*  DCL 1 MCA BDY(WORD) BASED(R8),        /* MODULE CONTROL TABLEX02008*
*         2 MPRE PTR,                    /* PREVIOUS MCT IF ANY X02008*
*         2 MNXT PTR,                    /* NEXT MCT IF ANY     X02008*
*         2 MITEM(20) CHAR(6),           /* MCT ENTRY FORMAT    X02008*
*           3 MNM CHAR(2),               /* MODULE INDICATOR    X02008*
*             4 MNM1 CHAR(1),            /* FIRST INDICATOR BYTEX02008*
*               5 MB1 BIT(1),            /* NOT TO DELETE BIT   X02008*
*               5 MB2 BIT(1),            /* PRESENTLY ACTIVE BITX02008*
*               5 * BIT(5),              /* WORK BITS           X02008*
*               5 MB8 BIT(1),            /* WORK BIT            X02008*
*             4 MNM2 CHAR(1),            /* MODULE BLOCK ID     X02008*
*           3 MNAM CHAR(2),              /* OLTEP MODULE ID     X02008*
*             4 MN1 CHAR(1),             /* FIRST BYTE OF ID    X02008*
*           3 MMSIZ CHAR(2),             /* MODULE SIZE         X02008*
*         2 TITEM(20) PTR;               /* ADDRESS TABLE       X02008*
*  DCL MCTADS CHAR(1) BASED(R8+128);     /* MCT ADDRESSES       X02008*
*  DCL TADR(20) PTR BASED(R5);           /* MODULES ADDRESSES   X02008*
*  DCL 1 BMCT18 BIT(8),                  /* MCT INDICATORS      X02008*
*         2 BMCT12 BIT(2),               /* CORE FOR MCT        X02008*
*           3 BMCT1 BIT(1),              /* FIRST ATTEMPT MADE  X02008*
*           3 BMCT2 BIT(1),              /* SECOND ATTEMPT MADE X02008*
*         2 PLKBIT BIT(1),               /* PLINK REQUEST       X02008*
*         2 MOD8 BIT(1),                 /* EIGHT CHARACTER NAMEX02008*
*         2 BMCT45 BIT(2),               /* CORE DELETED        X02008*
*           3 BMCT4 BIT(1),              /* CORE DELETED        X02008*
*           3 BMCT5 BIT(1),              /* MORECORE REQUEST    X02008*
*         2 MINMOR BIT(1),               /* MINIMUM MORECORE    X02008*
*             4 * BIT(1);                /* LAST BIT            X02008*
*  DCL 1 SVR14 PTR BASED(CHNBK+12),      /* REG 14 SAVE AREA */
*         2 SVR141 CHAR(1);              /* 1ST BYTE OF REG 14 SAVED */
*  DCL SV15 PTR BASED(CHNBK+16);         /* REG 15 SAVE AREA */
*  DCL SVR3 PTR BASED(CHNBK+32);         /* REG 3 SAVED */
*  DCL 1 * BASED(R3),                    /* PARAMETER LIST */
*         2 PMW1 CHAR(10),               /* PARM LIST           X02008*
*           3 * CHAR(1),                 /* NA                  X02008*
*           3 PLEV CHAR(1),              /* MACRO LEVEL         X02008*
*           3 PLID CHAR(2),              /* MACRO ID            X02008*
*             4 * CHAR(1);               /* NA                  X02008*
*  DCL MIRTNM CHAR(4) BASED(R1+20);      /* ROUTINE NUMBER      X02008*
*  DCL CLIST CHAR(16)                    /* EBCDIC CHARACTERS   X02008*
*         INIT('0123456789ABCDEF');
*  DCL EBCD CHAR(1) BASED(R8);           /* EBCDIC CHARACTER    X02008*
*  DCL 1 RETMSG CHAR(41)
*         INIT('IFD450I * RTN XXX,ID YY,AT ZZZZZZZZ,RC WW'),
*         2 * CHAR(8),                   /* MESSAGE ID          X02008*
*         2 RTAST CHAR(1),               /* ASTERISK OR BLANK   X02008*
*         2 * CHAR(4),                   /* NA                  X02008*
*         2 RTNM14 CHAR(4),              /* BYTES IN GROUP      X02008*
*           3 * CHAR(1),                 /* NA                  X02008*
*           3 RTRTNM CHAR(3),            /* ROUTINE NUMBER      X02008*
*         2 * CHAR(4),                   /* NA                  X02008*
*         2 RTMCID CHAR(2),              /* MACRO ID            X02008*
*         2 * CHAR(4),                   /* NA                  X02008*
*         2 RTLOC CHAR(8),               /* RETURN LOCATION     X02008*
*         2 * CHAR(4),                   /* NA                  X02008*
*         2 RTTERM CHAR(2);              /* RETURN CODE         X02008*
*  DCL 1 * CHAR(8) BASED(R7),            /* RETURN CODE AREA    X02008*
*         2 RTLOC1 CHAR(1),              /* 1ST LOCATION        X02008*
*         2 RTLOC2 CHAR(1),              /* 2ND LOCATION        X02008*
*         2 NXTRTL CHAR(1);              /* NEXT LOCATION       X02008*
*  DCL 1 * BASED(R5),                    /* ADDRESS TABLE */
*         2 TAB1 PTR,                    /* ADDRESS TABLE ENTRY */
*         2 TAB2 PTR;                    /* NEXT ENTRY IN TABLE */
*  DCL 1 * BASED(R4),                    /* BRANCH INSTRUCTION TABLE */
*         2 * CHAR(4),                   /* BRANCH INSTRUCTION */
*         2 MIDOLD CHAR(2),              /* MODULE ID */
*           3 MIDOLD1 CHAR(1),           /* FIRST CHARACTER OF ID */
*         2 MAC2 CHAR(4);                /* NEXT BRANCH INSTRUCTION */
*  DCL 1 * BASED(R6),                    /* MODULE CONTROL TABLE */
*         2 *(2) PTR,                    /* MCT POINTERS */
*         2 * CHAR(1),                   /* INDICATORS */
*           3 * BIT(1),                  /* NA                   M4506*
*           3 ACTMD BIT(1),              /* ACTIVE MODULE        M4506*
*         2 MBK1 CHAR(1),                /* BLOCK ASSIGNMENT */
*         2 MID1 CHAR(2),                /* MODULE IDENTITY */
*         2 MSZ1 CHAR(2);                /* MODULE SIZE */
*  DCL MCT2 BASED(R6+6);                 /* NEXT ITEM IN MCT */
*  DCL 1 TMCOM BDY(WORD),                /* TRANSIENT MODULE COMMON */
*         2 WKAREA CHAR(60) BDY(WORD),   /* BLDL AND WORK AREA  X02008*
*           3 * FIXED(15) INIT(1),       /* NUMBER OF ENTRIES */
*           3 * FIXED(15) INIT(56),      /* SIZE OF EACH ENTRY  X02008*
*           3 WITEM CHAR(32),            /* BLDL ITEM */
*             4 WTOTNM CHAR(8),          /* MODULE NAME */
*               5 WNM CHAR(6) INIT('IFDOLT'), /* COMMON PART OF NAME */
*               5 WNAM CHAR(2),          /* VARYING PART MODULE NAME */
*             4 WTTRK CHAR(6),           /* MODULE LOCATION */
*               5 * CHAR(2),             /* TRACK AND CYLINDER */
*               5 WR CHAR(1),            /* RECORD */
*             4 * CHAR(11),              /* BLDL DATA */
*             4 WMSIZ CHAR(2),           /* MODULE SIZE */
*             4 * CHAR(1),               /* SPARE BYTE */
*           3 WK24 CHAR(24) BDY(WORD),   /* WORK BYTES          X02008*
*             5 GAVL CHAR(8),            /* CORE LIST           X02008*
*             5 GSIZS CHAR(8),           /* SIZES               X02008*
*             5 GAVL1 BDY(WORD) CHAR(8), /* WORK AREA           X02008*
*         2 KNT CHAR(8)                  /* OLTEP MODULE NAME */
*               INIT('IFDOLT  '),        /* IDENTITY OF OLTEP MODULES *
*           3 KNAME CHAR(6),             /* COMMON PART MODULE NAME */
*           3 KNMV CHAR(2),              /* VARYING PART MODULE NAME */
*         2 MODNN CHAR(8)                /* NON-OLTEP MODULE NAME */
*               INIT('IFDOLT  '),        /* INITIALLY ALL OLTEP NAMES *
*           3 MODNN6 CHAR(6),            /* FIRST SIX LETTERS OF NAME *
*         2 BDEL FIXED INIT(1),          /* BLOCK INDICATORS    S21937*
*           3 BIN CHAR(1),               /* BLOCK SEQUENCING */
*           3 WK1BYT CHAR(1),            /* WORK BYTE */
*           3 BHB CHAR(1),               /* HIGHEST BLOCK ASSIGNED */
*           3 BHLD CHAR(1),              /* LAST HIGH BLOCK DELETED */
*         2 GTCOR PTR,                   /* ADDRESS OF OBTAINED CORE */
*         2 SVPMW1 CHAR(10),             /* DATA SAVED FROM PARM LIST *
*           3 SVP1 CHAR(2),              /* MODULE INDICATORS */
*             4 P1BITS BIT(8),           /* BIT INDICATORS */
*               5 P1B0 BIT(1),           /* EIGHT CHARACTER NAME */
*               5 P1B1 BIT(1),           /* NOT A MODULE REQUEST */
*             5 P1B23 BIT(2),            /* LOAD DELETE BITS     M4506*
*               7 P1B2 BIT(1),           /* LOAD MODULE          M4506*
*               7 P1B3 BIT(1),           /* DELETE MODULE        M4506*
*               5 P1B4 BIT(1),           /* WORK BIT */
*               5 P1B5 BIT(1),           /* UNIT TEST MODULE */
*               5 P1B6 BIT(1),           /* ROOT MODULE */
*               5 P1B7 BIT(1),           /* OLD MODULE AND WORK BIT */
*             4 SVPL CHAR(1),            /* MACRO LEVEL */
*           3 SVP8 CHAR(8),              /* EIGHT CHARACTER NAME */
*             4 SVP2 CHAR(2);            /* TWO CHARACTER NAME */
*  DCL VID CHAR(2) BASED(ADDR(WKSVC)+2); /* MODULE ID FOR SVC USE */
*  DCL NXMCT PTR BASED(R8+4);            /* NEXT MCT */
*  DCL MCTAD1 PTR BASED(R8+128);         /* FIRST ADDRESS IN MCT */
*  DCL 1 * BDY(WORD) BASED(ADDR(MCT)+128), /* MCT ADDRESSES */
*         2 RTADR1 PTR,                  /* ROOT MODULE ADDRESS */
*         2 TMADR1 PTR,                  /* TRANSIENT MANAGER ADDRESS *
*         2 *(18) PTR;                   /* ADDRESSES */
*  DCL OLDMAC CHAR(2) INIT('0102'X);     /* OLD MACRO INDICATORS */
*  DCL 1 * BASED(R1),                    /* WTO ADDRESS */
*         2 * CHAR(13),                  /* SET VALUES AND IDENTITY */
*         2 WTOFORM CHAR(60);            /* MESSAGE TEXT */
*  DCL 1 BLDLIST BASED(R5),              /* BLDL LIST           X02008*
*         2 LENTCT FIXED(15),            /* NUMBER OF ENTRIES */
*         2 LENTSZ FIXED(15);            /* SIZE OF EACH ENTRY */
*  DCL 1 * BDY(WORD) BASED(ADDR(WK24)),  /* NA                  X02008*
*         2 AVADR PTR,                   /* CORE LOCATION       X02008*
*         2 AVSEZ FIXED,                 /* CORE SIZE           X02008*
*           3 * CHAR(2),                 /* NA                  X02008*
*           3 AVSIZ CHAR(2),             /* SIZE LIMITED        X02008*
*         2 LOSIZ FIXED,                 /* MINIMUM CORE REQUESTX02008*
*         2 HHSIZ FIXED,                 /* MAXIMUM CORE REQUESTX02008*
*           3 HHSIZC CHAR(4),            /* MAXIMUM CORE REQUESTX02008*
*             4 * CHAR(2),               /* NA                  X02008*
*             4 HISIZ CHAR(2),           /* MAXIMUM SIZE        X02008*
*               9 * CHAR(1);             /* NA                  X02008*
*  DCL WK1PTR PTR;                       /* WORK AREA POINTER   X02008*
*  DCL SAVR8 PTR;                        /* SAVE AREA           X02008*
*  DCL 1 * BDY(WORD) BASED(ADDR(WKAREA)), /* BLDL AND WORK AREA X02008*
*         2 *(5) PTR,                    /* FIRST FIVE WORDS    X02008*
*         2 NMCT CHAR(14),               /* SIMULATE NEW MCT    X02008*
*           3 NTADR PTR;                 /* NEW ADDRESS TABLE   X02008*
*  DCL 1 BLIST1 CHAR(60) BASED(R5),      /* BLDL LIST           X02008*
*         2 * CHAR(4),                   /* ENTRY SIZE AND COUNT */
*         2 * CHAR(8),                   /* NAME OF MODULE */
*           3 LNM2 CHAR(6),              /* COMMON PART OF NAME */
*           3 LNAM2 CHAR(2),             /* VARYING PART OF NAME */
*         2 LTTRK CHAR(6),               /* DATA LOCATION */
*           3 * CHAR(2),                 /* TRACK LOCATION */
*           3 LR CHAR(1),                /* RECORD NUMBER */
*         2 * CHAR(11),                  /* USER DATA */
*         2 LSIZ CHAR(2);                /* MODULE SIZE */
*  DCL BLIST2 BASED(R5+56);              /* NEXT BLDL ITEM      X02008*
*  DCL 1 * BDY(WORD) BASED(ADDR(TMCOM)+12), /* NA               X02008*
*         2 SV1T8 CHAR(8),               /* WORK AREA           X02008*
*           3 SV1 FIXED,                 /* 1ST HEX CHAR AREA   X02008*
*           3 SV2 FIXED,                 /* 2ND HEX CHAR AREA   X02008*
*           7 * CHAR(1);                 /* NA                  X02008*
*  DCL 1 * BASED(R5),                    /* SAVE AREA           X02008*
*         2 SV1C CHAR(1),                /* 1ST CHARACTER       X02008*
*         2 NXTSVC CHAR(3),              /* NEXT CHARACTERS     X02008*
*         2 SV2C CHAR(1);                /* 2ND WORD            X02008*
*  DCL MDMASK CHAR(1) BASED(R4);         /* MODULE MASK BIT     X02008*
*  DCL FKLKTBA PTR GENERATED;            /* FAKE TABLE ADDRESS  X02008*
*  DCL 1 * BDY(WORD) BASED(R2),          /* CHASCT              X02008*
*         2 *(17) PTR,                   /* NA                  X02008*
*         2 * PTR,                       /* NA                  X02008*
*           3 * CHAR(2),                 /* NA                  X02008*
*           3 RTMASK CHAR(1),            /* RETURN CODE MASK    X02008*
*         2 *(2) PTR,                    /* NA                  X02008*
*         2 SCTW20 PTR,                  /* BRANCH TABLE ADDRESSX02008*
*           3 * PTR;                     /* NA                  X02008*
*  DCL UTRET PTR BDY(WORD) INIT(0);      /* UTS RETURN ADDRESS  X02008*
*  DCL 1 BRID CHAR(2),                   /* BRANCH ID           X02008*
*         2 BRID1 CHAR(1),               /* FIRST ID BYTE       X02008*
*           3 BRIDB14 BIT(4);            /* ID BITS             X02008*
*  DCL 1 LIST CHAR(9) LOCAL INT,         /* WORK LIST           X02008*
*         2 RR CHAR(1),                  /* WORK BYTE           X02008*
*         2 MASK(8) CHAR(1)              /* MASK BITS           X02008*
*         INIT('80'X,'40'X,'20'X,'10'X,  /* BIT SET IN EACH MASK */
*              '08'X,'04'X,'02'X,'01'X); /* BIT SET IN EACH MASK */
*  DCL 1 * BASED(MSGMOD),                /* MESSAGE MODULE */
*         2 *(14) PTR,                   /* NA                  X02008*
*         2 IFD160 PTR,                  /* POINTER TO IFD160 MESSAGE *
*         2 * PTR,                       /* NA                        *
*         2 IFD210 PTR,                  /* PTR TO IFD210 MSG         *
*         2 * PTR,                       /* NA                        *
*         2 IFD168 PTR,                 /* PTR TO IFD168 MSG    S20203*
*         2 *(18) PTR,                   /* NA                  Y02008*
*         2 IFD229 PTR,                  /* PTR TO IFD229I MSG  Y02008*
*           3 * PTR;                     /* LAST POINTER */
*  DCL 1 * BASED(R1),                   /*                      S20203*
*    2 LENGTH CHAR(1),                  /* LENGTH OF RESPONSE   S20203*
*    2 BUFAD PTR(24),                   /* ADDR OF RESP BUFFER  S20203*
*    2 MECBAD PTR;                      /* ECB ADDRESS          S20203*
*  DCL 1 * BASED(ADDR(ECB3)),            /* ECB FOR DYN COMMUNICATE */
*         2 * CHAR(1),                   /* FIRST BYTE */
*           3 * BIT(1),                  /* BIT ALIGNMENT */
*           3 ECB3POST BIT(1);           /* DYN COMMUNICATE BIT */
*  DCL 1 * BDY(WORD) BASED(ADDR(TRA000)-12), /* WORK AREA       X02008*
*         2 MCTTWO CHAR(208),            /* SECOND MCT                *
*           3 FSTMCT PTR,                /* FIRST MCT PTR             *
*           3 RMCT2 CHAR(204);           /* REST OF SECOND MCT        *
*  DCL 1 * BDY(WORD),                    /* STORAGE AREA              *
*         2 SVDYN(18) PTR,               /* DYN SAVE AREA */
*         2 SVT13 PTR,                   /* TRANSIENT MANAGER AREA */
*         2 SVU13 PTR,                   /* UTS SAVE AREA */
*           3 * PTR;                     /* NA */
*  DCL CESWTR CHAR(1) GENERATED;        /* REI SWITCHES         S20203*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWTR)),  /* REI SWITCHES        S20203*
*    2 * BIT(1),                        /* NA                   S20203*
*    2 REMERR BIT(1),                   /* ERROR FLAG           S20203*
*    2 REMNOMSG BIT(1),                 /* REMOTE NO MSG        S20203*
*     2 CENOMSG BIT(1),                  /* ONSITE NO MSG       S20203*
*         2 TRANSMSG BIT(1),             /*                     S20203*
*  2 * BIT(1),                          /*                      S20203*
*           2 * BIT(2);                  /*                     S20203*
*  DCL CESWTR1 CHAR(1) GENERATED;       /* REI SWITCHES         S20203*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWTR1)),  /*                    S20203*
*           2 ILLRESP BIT(1),            /*                     S20203*
*    2 EXECANS BIT(1),                  /* ANS TO IFD104E       S20203*
*    2 * BIT(2),                        /* NA                   S20203*
*    2 RETRIEVE BIT(1),                 /* MSG IN FROM REMOTE   S20203*
*           2 REMANS BIT(1),             /*                     S20203*
*           2 * BIT(2);                  /*                     S20203*
*  DCL CESWTR2 CHAR(1) GENERATED;        /*  REI SWITCHES       S20203*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWTR2)),  /* REI SWITCHES       S20203*
*         3 * BIT(2),                    /*                     S20203*
*         3 ONCOMM BIT(1),               /* ONSITE DYNCOMM      S20203*
*         3 RECOMM BIT(1),               /* REMOTE TALK IN      S20203*
*         3 * BIT(4);                    /*                     S20203*
*  DCL TALKECB FIXED GENERATED;         /* ECB FOR CE TO RE     S20203*
*  DCL 1 * BASED(ADDR(TALKECB)),        /*                      S20203*
*    2 * CHAR(1),                       /* FIRST BYTE           S20203*
*      3 * BIT(1),                      /* BIT ALIGNMENT        S20203*
*      3 TALKPOST BIT(1);               /* CE COMMUNICATION     S20203*
*  DCL REIECB FIXED GENERATED;          /* REMOTE ECB           S20203*
*  DCL 1 * BASED(ADDR(REIECB)),         /* REMOTE ECB           S20203*
*    2 * CHAR(1),                       /* FIRST BYTE           S20203*
*      3 * BIT(1),                      /* BIT ALIGNMENT        S20203*
*      3 REIPOST BIT(1);                /* REMOTE ANSWERED BIT  S20203*
*  DCL RTALKBUF PTR GENERATED;          /* PTR TO DED BUF       S20203*
*  DCL DEDBUF CHAR(72) BASED(RTALKBUF);  /* DEDICATED BUFFER    S20203*
*  DCL PRTBUFR CHAR(124) GENERATED;     /* PRINT BUFFER         S20203*
*  DCL TALKID CHAR(8) BASED(ADDR(PRTBUFR)+1);  /*               S20203*
*  DCL RPTBUF CHAR(115) BASED(ADDR(PRTBUFR)+9);   /* PRT BUF    S20203*
*  DCL RTALKID CHAR(8) INIT('IFD255I ');  /*                    S20203*
*  DCL MHRPTR PTR GENERATED;            /* PTR TO MHR           S20203*
*    GEN(EJECT);
         EJECT
         DS    0H
* /*********************************/
* /***   INITIALIZE LINK TABLE   ***/
* /*********************************/
*  GEN(CNOP  0,4);
         CNOP  0,4
         DS    0H
*  GEN;
TRA000   DS    0F                                              X02008
         DS    0H
*  TMCOMAD=ADDR(TMCOM);                  /* TRANSIENT MANAGER AREA */
         LA    @F,TMCOM                                           0130
         ST    @F,A00009+32                                       0130
*  R8=ADDR(MCT);                         /* MCT ADDRESS */
         LA    @8,MCT                                             0131
*  R5=TABAD;                             /* LINK TABLE ADDRESS */
         L     @5,TABAD                                           0132
*  R4=ADDR(TRA001);                      /* FIRST ADDRESS FOR TABLE */
         LA    @4,TRA001                                          0133
*  DO R6=8 TO 1 BY -1;                   /* INITIALIZE TABLE */
         LA    @6,8                                               0134
*    TAB1=R4;                            /* STORE ADDRESS INTO TABLE */
@DO9FF   ST    @4,0(0,@5)                                         0135
*    R5=ADDR(TAB2);                      /* NEXT TABLE ENTRY */
         LA    @5,4(0,@5)                                         0136
*    R4=ADDR(MAC2);                      /* NEXT ADDRESS TO STORE */
         LA    @4,6(0,@4)                                         0137
*  END;                                  /* COMPLETE WHOLE TABLE */
*  R5=DEVTBPTR;                          /* BLDL LIST ADDRESS   X02008*
         BCT   @6,@DO9FF                                          0138
         L     @5,DEVTBPTR                                        0139
*  R6=R8;                                /* MCT ADDRESS */
         LR    @6,@8                                              0140
*  VID=MID1;                             /* OLTEP MODULE ID */
         MVC   VID(2),10(@6)                                      0141
*  LENTSZ=56;                            /* ENTRY SIZE IN BLDL  X02008*
         LA    @F,56                                              0142
         STH   @F,2(0,@5)                                         0142
*  LENTCT=10;                            /* ENTRIES IN BLDL */
         LA    @F,10                                              0143
         STH   @F,0(0,@5)                                         0143
*  DO R4=10 TO 1 BY -1;                  /* COUNT OF ENTRIES */
         LR    @4,@F                                              0144
*    LNM2=KNAME;                         /* COMMON PART MODULE NAME */
@DO9FB   MVC   4(6,@5),TMCOM+60                                   0145
*    LNAM2=MID1;                         /* VARYING PART MODULE NAME */
         MVC   10(2,@5),10(@6)                                    0146
*    R5=ADDR(BLIST2);                    /* NEXT ENTRY IN BLDL */
         LA    @5,56(0,@5)                                        0147
*    R6=ADDR(MCT2);                      /* NEXT ITEM IN MCT */
         LA    @6,6(0,@6)                                         0148
*  END;                                  /* ALL OLD MODULES IN BLDL */
*  R5=DEVTBPTR;                          /* BLDL LIST ADDRESS   X02008*
         BCT   @4,@DO9FB                                          0149
         L     @5,DEVTBPTR                                        0150
*  R0=R5;                                /* LIST ADDRESS FOR BLDL */
         LR    @0,@5                                              0151
*  GEN(BLDL  0,(0));                     /* ISSUE BLDL SYSTEM MACRO */
         BLDL  0,(0)
         DS    0H
* /*************************************************/
* /***   INITIALIZE FIRST MODULE CONTROL TABLE   ***/
* /*************************************************/
*  R6=R8;                                /* MCT ADDRESS */
         LR    @6,@8                                              0153
*  MBK1=RTADR1/2048;                     /* ROOT MODULE BLOCK ID */
         L     @E,A00057                                          0154
         SRA   @E,11                                              0154
         STC   @E,9(0,@6)                                         0154
*  LGWRTCT=LSIZ;                         /* LARGE WRITE COUNT   X02008*
         MVC   LGWRTCT(2),29(@5)                                  0155
*  IF MBK1='00'X THEN                    /* TEST ROOT MODULE BLOCK ID *
         CLI   9(@6),X'00'                                        0156
         BC    07,@9F7                                            0156
*    MBK1='01'X;                         /* REASSIGN BLOCK ID */
         MVI   9(@6),X'01'                                        0157
*  DO R4=10 TO 1 BY -1;                  /* COUNT OF ENTRIES */
@9F7     LA    @4,10                                              0158
*    IF LR^='00'X THEN                   /* TEST IF MODULE PRESENT */
@DO9F6   CLI   14(@5),X'00'                                       0159
         BC    08,@9F2                                            0159
*      MSZ1=LSIZ+48;                     /* MODULE SIZE RECORDED */
         LA    @F,48                                              0160
         MVC   @TEMP2+2(2),29(@5)                                 0160
         A     @F,@TEMP2                                          0160
         STH   @F,12(0,@6)                                        0160
*    BLIST1=BLIST1&&BLIST1;              /* ZERO OUT AREA IN BLDL */
@9F2     XC    0(60,@5),0(@5)                                     0161
*    R5=ADDR(BLIST2);                    /* NEXT ENTRY IN BLDL */
         LA    @5,56(0,@5)                                        0162
*    R6=ADDR(MCT2);                      /* NEXT ITEM IN MCT */
         LA    @6,6(0,@6)                                         0163
*  END;                                  /* ALL ENTRIES RECORDED */
*  SCTW20=FKLKTBA;                       /* LINK TABLE FOR UTS  X02008*
         BCT   @4,@DO9F6                                          0164
         MVC   80(4,@2),FKLKTBA                                   0165
*  RMCT2=RMCT2&&RMCT2;                   /* ZERO SECOND MCT           *
         XC    A00090+4(204),A00090+4                             0166
*  GOTO TRA016;                          /* RETURN */
         BC    15,TRA016                                          0167
*  GEN;
         DS    0F
FKLKTBA  DC    A(TRA000A-28)            FAKE LINK TABLE ADDRESS
TRA000A  DC    A(TRA001A)               ENTRY FROM UTS
         DS    0H
* TRA001:
*  GEN;
TRA001   EQU   *                                                  0169
UN       EQU   15
         BC    UN,TRA002-*(R15)         OLD EXIO
         DC    CL2'05'                  EXIO ID
         BC    UN,TRA002-*(R15)         OLD WAITIO
         DC    CL2'06'                  WAITIO ID
         BC    UN,TRA002-*(R15)         OLD COMPARE
         DC    CL2'09'                  COMPARE ID
         BC    UN,TRA002-*(R15)         OLD CONVERT
         DC    CL2'10'                  CONVERT ID
         BC    UN,TRA002-*(R15)         OLD CECOM
         DC    CL2'13'                  CECOM ID
         BC    UN,TRA002-*(R15)         OLD DPRINT
         DC    CL2'08'                  DPRINT ID
         BC    UN,TRA002-*(R15)         OLD RDATA
         DC    CL2'11'                  RDATA ID
         BC    UN,TRA002-*(R15)         NEW MACRO ENTRY
         DC    XL2'0100'                NEW MODULES
TRA001A  BC    UN,TRA002-*(R15)         UTS ENTRY
         DC    XL2'0200'                INDICATE UTS CALL
         DS    0H
*    GEN(EJECT);
         EJECT
         DS    0H
         BC    15,@9F1                                            0171
* TRA002:
*  ENTRY(X);
TRA002   STM   @E,@C,12(@D)                                       0171
         BALR  @B,0                                               0171
         LA    @F,TRA002-IFDOLT18-24                              0171
         SR    @B,@F                                              0171
         ST    @D,@SAV001+4                                       0171
         LA    @F,@SAV001                                         0171
         ST    @F,8(0,@D)                                         0171
         LR    @D,@F                                              0171
*  R3=R1;                                /* PARAMETER LIST POINTER */
@9F1     LR    @3,@1                                              0172
*  R2=COMADR;                            /* COMMON AREA ADDRESS */
         L     @2,COMADR                                          0173
*  SVR141='00'X;                         /* 1ST BYTE OF REG 14 SAVED */
         L     @C,4(0,@D)          
         MVI   12(@C),X'00'                                       0174
*  R5=SVR14;                             /* RETURN REGISTER VALUE */
         L     @5,12(0,@C)                                        0175
*  R4=SV15;                              /* ORIGINAL R15 VALUE  X02008*
         L     @4,16(0,@C)                                        0176
*  BRID=MIDOLD;                          /* SAVE BRANCH ID      X02008*
         MVC   BRID(2),4(@4)                                      0177
*  IF BRID1='02'X THEN                   /* CHECK ID            X02008*
         CLI   BRID,X'02'                                         0178
         BC    07,@9F0                                            0178
*    GEN(BAL   R9,TRA012D);              /* RETURN OR TRACE TESTX02008*
         BAL   R9,TRA012D
         DS    0H
*  IF GRBCTL='1'B THEN                   /* IS GRAB ACTIVE       M4506*
@9F0     TM    A00002,B'00010000'                                 0180
         BC    12,@9EF                                            0180
*    UTSCAL='1'B;                        /* MODULES ACTIVE       M4506*
         OI    A00005,B'10000000'                                 0181
*  RR='00'X;                             /* ALL MODULES TO DELETE */
@9EF     MVI   LIST,X'00'                                         0182
*  IF SUSDEL='1'B THEN                   /* TEST INDICATOR       M4507*
         TM    A00002,B'00001000'                                 0183
*    GOTO TRA002B;                       /* SUSPENDED DELETION   M4507*
         BC    01,TRA002B                                         0184
*  R8=ADDR(MCT);                         /* MCT ADDRESS */
         LA    @8,MCT                                             0185
*  IF FECOND='1'B THEN                   /* TEST INDICATOR */
         TM    A00000,B'00100000'                                 0186
         BC    12,@9EE                                            0186
*    DO;                                 /* FIRST ERROR CONDITION */
*      IF CLEANUP='1'B THEN              /* IS CLEANUP RTN      Y02008*
         TM    A00014+33,B'00000100'                              0188
*                                        /* EXECUTING           Y02008*
*      GO TO TRA002D;                    /* YES, DONT ALLOW FE  Y02008*
         BC    01,TRA002D                                         0189
*                                        /* COMMUNICATION INT.  Y02008*
*      FECOND='0'B;                      /* CLEAR FIRST ERROR BIT */
         NI    A00000,B'11011111'                                 0190
*      GEN(BAL   R9,TRA002A);            /* GO TO CE COMMUNICATIONS */
         BAL   R9,TRA002A
         DS    0H
*      IF ERLOP='1'B THEN                /* ERROR LOOP ON */
         TM    A00014+3,B'00000010'                               0192
         BC    12,@9ED                                            0192
*        CATB1='0'B;                     /* CLEAR CATASTROPHIC BIT */
         NI    A00014+3,B'11011111'                               0193
*      RETURN;                           /* RETURN */
         BC    15,@EL01                                           0194
*    END;                                /* END FIRST ERROR CHECK */
* TRA002D:                               /*                     Y02008*
*  R6=PARADR;                            /* PARTITION STARTS    X02008*
@9EE     EQU   *                                                  0196
TRA002D  L     @6,A00006                                          0196
*  R7=PARSZ+R6;                          /* END OF PARTITION    X02008*
         LR    @7,@6                                              0197
         A     @7,A00006+4                                        0197
*  IF R5>R6&                             /* RETURN IS AFTER UTS ENTRY *
*    R5<R7 THEN                          /* RETURN IS BEFORE UTS END */
         CR    @5,@6                                              0198
         BC    12,@9EC                                            0198
         CR    @5,@7                                              0198
         BC    10,@9EB                                            0198
*      GEN(BAL   R9,TRA012D);            /* RETURN OR TRACE TESTX02008*
         BAL   R9,TRA012D
         DS    0H
*  ELSE GOTO TRA002B;                    /* NO DYN COMMUNICATION TEST *
*  GEN(BAL   R9,TRA029);                 /* ALLOW DELETIONS     X02008*
@9EA     EQU   *                                                  0201
         BAL   R9,TRA029
         DS    0H
*  IF REMERR='1'B THEN                   /* REI ERROR           S20203*
         TM    A00093,B'01000000'                                 0202
*    GOTO REIERROR;                      /*                     S20203*
         BC    01,REIERROR                                        0203
*  IF NDCFO='0'B&                        /* TEST DYN INDICATOR */
*      ECB3POST='1'B THEN                /* TEST DYN COMMUNICATE */
         TM    A00000,B'10000000'                                 0204
         BC    05,@9E9                                            0204
         TM    A00087,B'01000000'                                 0204
         BC    12,@9E8                                            0204
*    DO;                                 /* BIT SET */
*    IF CLEANUP='1'B THEN                /* IS CLEANUP RTN      Y02008*
         TM    A00014+33,B'00000100'                              0206
*                                        /* EXECUTING           Y02008*
*      GO TO TRA002C;                    /* YES, DONT ALLOW     Y02008*
         BC    01,TRA002C                                         0207
*                                        /* DYN COMM INTERVAL   Y02008*
*  REIERROR:                             /*                     S20203*
*      R9=ADDR(TRA002C);                 /* RETURN ADDRESS */
REIERROR LA    @9,TRA002C                                         0208
* TRA002A:
*      SVT13=R13;                        /* NORMAL SAVE AREA */
TRA002A  ST    @D,A00091+72                                       0209
*      SVU13=CHNBK;                      /* UNIT TEST SAVE AREA */
         MVC   A00091+76(4),4(@D)                                 0210
*      R13=ADDR(SVDYN);                  /* DYN SAVE AREA */
         LA    @D,A00091                                          0211
*      R15=COMMINT;                      /* ENTRY TO CE COMMUNICATION *
         L     @F,COMMINT                                         0212
*      GEN(BALR  R14,R15);               /* LINK TO CE COMMUNICATIONS *
         BALR  R14,R15
         DS    0H
*      R13=SVT13;                        /* NORMAL SAVE AREA */
         L     @D,A00091+72                                       0214
*      CHNBK=SVU13;                      /* UNIT TEST SAVE AREA */
         MVC   4(4,@D),A00091+76                                  0215
*      GOTO R9;                          /* RETURN TO MAIN FLOW */
         BCR   15,@9                                              0216
*    END;                                /* END DYN COMMUNICATE TEST */
* TRA002C:
*  IF TALKPOST='1'B THEN                /* TEST CE TO RE COMM   S20203*
@9E8     EQU   *                                                  0218
@9E9     EQU   *                                                  0218
TRA002C  TM    A00103,B'01000000'                                 0218
         BC    12,@9E7                                            0218
*    DO;                                /* CE WANTS TO TALK     S20203*
*    CENOMSG='1'B;                      /* DON'T SEND ONSITE    S20203*
         OI    A00093,B'00010000'                                 0220
*  TALKID=RTALKID;                       /* MSG ID              S20203*
         MVC   TALKID(8),RTALKID                                  0221
*    RPTBUF=DEDBUF;                      /* MOVE MSG TO PRTBUFR S20203*
         L     @C,RTALKBUF                                        0222
         MVC   RPTBUF(72),0(@C)                                   0222
         MVI   RPTBUF+72,C' '                                     0222
         MVC   RPTBUF+73(42),RPTBUF+72                            0222
*         TRANSMSG='1'B;                 /*                     S20203*
         OI    A00093,B'00001000'                                 0223
*    GEN(PWRT  SIZE=72);                /* ISSUE PWRITE         S20203*
         PWRT  SIZE=72
         DS    0H
*         TRANSMSG='0'B;                 /*                     S20203*
         NI    A00093,B'11100111'                                 0225
*    CENOMSG='0'B;                      /* ZERO CENOMSG FLAG    S20203*
*    DEDBUF(1)=' ';                      /* CLEAR DEDBUF        S20203*
         MVI   0(@C),C' '                                         0227
*    DEDBUF(2:72)= DEDBUF(1:71);         /*                     S20203*
         MVC   1(71,@C),0(@C)                                     0228
*    R1=IFD168;                         /* ADDR OF MSG TO R1    S20203*
         L     @C,MSGMOD                                          0229
         L     @1,72(0,@C)                                        0229
*    BUFAD=RTALKBUF;                    /* ADDR OF RESP BUFFER  S20203*
         MVC   1(3,@1),RTALKBUF+1                                 0230
*    LENGTH='48'X;                      /* LENGTH OF BUFFER     S20203*
         MVI   0(@1),X'48'                                        0231
*    MECBAD=ADDR(TALKECB);              /* ADDR OF ECB          S20203*
         LA    @F,TALKECB                                         0232
         ST    @F,4(0,@1)                                         0232
*    TALKECB=0;                          /* ZERO ECB            S20203*
         SR    @F,@F                                              0233
         ST    @F,TALKECB                                         0233
*    REMNOMSG='1'B;                     /* DON'T SEND TO RE     S20203*
         OI    A00093,B'00100000'                                 0234
*    GEN(PWTOR REG=(1),WAIT=NO);        /* ISSUE WTOR           S20203*
         PWTOR REG=(1),WAIT=NO
         DS    0H
*    REMNOMSG='0'B;                     /* ZERO REMNOMSG FLAG   S20203*
         NI    A00093,B'11011111'                                 0236
*    END;                               /*                      S20203*
*  IF REIPOST='1'B THEN                  /* RE WANTS TO TALK    S20203*
@9E7     TM    A00106,B'01000000'                                 0238
         BC    12,@9E6                                            0238
*    DO;                                /* POSTED-GOTO MHR      S20203*
*      RETRIEVE='1'B;                   /* SET TO RETRIEVE MSG  S20203*
         OI    A00097,B'00001000'                                 0240
*      SVT13=R13;                       /*NORMAL SAVE AREA      S20203*
         ST    @D,A00091+72                                       0241
*      SVU13=CHNBK;                     /* UNIT TEST SAVE AREA  S20203*
         MVC   A00091+76(4),4(@D)                                 0242
*      R13=ADDR(SVDYN);                 /* DYN SAVE AREA        S20203*
         LA    @D,A00091                                          0243
*      R15=MHRPTR;                      /* ENTRY TO MSG HANDLER S20203*
         L     @F,MHRPTR                                          0244
*      GEN(BALR R14,R15);               /* LINK TO MHR          S20203*
         BALR R14,R15
         DS    0H
*      R13=SVT13;                       /* NORMAL SAVEAREA      S20203*
         L     @D,A00091+72                                       0246
*      CHNBK=SVU13;                     /* UNIT TEST SAVEAREA   S20203*
         MVC   4(4,@D),A00091+76                                  0247
*      RETRIEVE='0'B;                   /*   ZERO RETRIEVE FLAG S20203*
         NI    A00097,B'11110111'                                 0248
*         CESWTR1 = CESWTR1 & 'EF'X;     /* ZERO INFOMSG FLAG    M4502*
         NI    CESWTR1,X'EF'                                      0249
*      IF REMERR='1'B THEN              /* CHECK FOR ERROR      S20203*
         TM    A00093,B'01000000'                                 0250
*         GOTO TRA002R;                  /*                      M4502*
         BC    01,TRA002R                                         0251
*     IF ILLRESP='1'B THEN              /* WAS RESPONSE OKAY    S20203*
         TM    A00097,B'10000000'                                 0252
         BC    12,@9E5                                            0252
*         DO;                           /* NO                   S20203*
*         ILLRESP='0'B;                 /* ZERO ILLRSP FLAG     S20203*
         NI    A00097,B'01111111'                                 0254
*         GOTO TRA002B;                  /* NO CONTINUE         X02008*
         BC    15,TRA002B                                         0255
*         END;                           /*                     S20203*
*      IF EXECANS='1'B THEN             /* DOES REMOTE WANT COM S20203*
@9E5     TM    A00097,B'01000000'                                 0257
         BC    12,@9E4                                            0257
*         DO;                           /* YES                  S20203*
* TRA002R:
*         GEN(BAL R9,TRA002A);          /* GOTO CE COMM         S20203*
TRA002R  BAL R9,TRA002A
         DS    0H
*         END;                          /*                      S20203*
*      END;                             /*                      S20203*
@9E4     EQU   *                                                  0261
*         GEN(EJECT);
@9E6     EQU   *                                                  0262
         EJECT
         DS    0H
* TRA002B:
*  R8=ADDR(MCT);                         /* MCT ADDRESS */
TRA002B  LA    @8,MCT                                             0263
*  SVPMW1=PMW1;                          /* SAVE DATA FROM PARM LIST */
         MVC   TMCOM+84(10),0(@3)                                 0264
*  R4=SV15;                              /* ENTRY POINT ADDRESS */
         L     @C,4(0,@D)          
         L     @4,16(0,@C)                                        0265
*  IF MIDOLD1^>'02'X THEN                /* CHECK ENTRY         X02008*
         CLI   4(@4),X'02'                                        0266
*    GOTO TRA003;                        /* NEW MODULE INDICATED */
         BC    12,TRA003                                          0267
*  SVP1=OLDMAC;                          /* OLD MODULE INDICATORS */
         MVC   TMCOM+84(2),OLDMAC                                 0268
*  SVP2=MIDOLD;                          /* STORE OLD MODULE ID */
         MVC   TMCOM+86(2),4(@4)                                  0269
*  KNMV=MIDOLD;                          /* OLD MODULE IDENTITY */
         MVC   TMCOM+66(2),4(@4)                                  0270
* TRA003:
*  IF SVPL<'02'X THEN                    /* TEST MACRO LEVEL */
TRA003   CLI   TMCOM+85,X'02'                                     0271
*    GOTO TRA025;                        /* LEVEL NOT SUPPORTED */
         BC    04,TRA025                                          0272
*  WTOTNM=SVP8;                          /* EIGHT CHARACTER NAME */
         MVC   TMCOM+4(8),TMCOM+86                                0273
*  IF P1B0='1'B THEN                     /* TEST CHARACTERS IN NAME */
         TM    TMCOM+84,B'10000000'                               0274
*    GOTO TRA004;                        /* EIGHT CHARACTERS IN NAME */
         BC    01,TRA004                                          0275
*  WNM=KNAME;                            /* COMMON PART OF NAME */
         MVC   TMCOM+4(6),TMCOM+60                                0276
*  WNAM=SVP2;                            /* VARYING PART OF NAME */
         MVC   TMCOM+10(2),TMCOM+86                               0277
* TRA004:
*  IF WNM=KNAME THEN                     /* TEST MODULE NAME */
TRA004   CLC   TMCOM+4(6),TMCOM+60                                0278
         BC    07,@9E3                                            0278
*    DO;                                 /* OLTEP MODULE */
*      IF WNAM='40' THEN                 /* TEST FOR MODE MACRO */
         CLC   TMCOM+10(2),@C9                                    0280
         BC    07,@9E2                                            0280
*        DO;                             /* MODE MACRO NOT      Y02008*
*                                        /* SUPPORTED           Y02008*
*        R1=IFD229;                      /* PRINT MSG EXPLAININGY02008*
         L     @C,MSGMOD                                          0282
         L     @1,148(0,@C)                                       0282
*        GEN(PWTO  REG=(1));             /* THAT OLT WAS        Y02008*
         PWTO  REG=(1)
         DS    0H
*        GO TO TRA028;                   /* CANCELLED BECAUSE   Y02008*
         BC    15,TRA028                                          0284
*        END;                            /* MODE NOT SUPPORTED  Y02008*
*      IF WNAM='47' THEN                 /* TEST FOR ROUTINE MACRO */
@9E2     CLC   TMCOM+10(2),@C10                                   0286
*        GOTO TRA022;                    /* GO TO ROUTINE CODE */
         BC    08,TRA022                                          0287
*      IF NPR='1'B THEN                  /* TEST NO PRINT INDICATOR */
         TM    A00014+2,B'00000100'                               0288
*        GOTO TRA006;                    /* PRINTING ALLOWED */
         BC    01,TRA006                                          0289
*      IF WNAM='08' THEN                 /* TEST OLD DPRINT     X02008*
         CLC   TMCOM+10(2),@C11                                   0290
*        GOTO TRA019;                    /* SKIP PRINTING       X02008*
         BC    08,TRA019                                          0291
*      IF WNAM='39' THEN                 /* TEST NEW DPRINT     X02008*
         CLC   TMCOM+10(2),@C12                                   0292
*        GOTO TRA019;                    /* SKIP PRINTING       X02008*
         BC    08,TRA019                                          0293
*      GOTO TRA006;                      /* NO SPECIAL MODULES TO DO */
         BC    15,TRA006                                          0294
*    END;                                /* END OF FREECORE CHECK */
*  R4=4;                                 /* NA INDICATOR */
@9E3     LA    @4,4                                               0296
*  IF MODNN6=KNAME THEN                  /* TEST A PREVIOUS MODULE */
         CLC   TMCOM+68(6),TMCOM+60                               0297
*    GOTO TRA005;                        /* ONLY OLTEP MODULES */
         BC    08,TRA005                                          0298
*  GEN(DELETE EPLOC=MODNN);              /* DELETE NON-OLTEP MODULE */
         DELETE EPLOC=MODNN
         DS    0H
* TRA005:
*  IF P1B3='1'B THEN                     /* TEST FUNCTION TO PERFORM */
TRA005   TM    TMCOM+84,B'00010000'                               0300
         BC    12,@9E1                                            0300
*    IF WTOTNM=MODNN THEN                /* DELETION JUST MADE */
         CLC   TMCOM+4(8),TMCOM+68                                0301
*      GOTO TRA005A;                     /* CONTINUE */
         BC    08,TRA005A                                         0302
*    ELSE DO;
*           GEN(DELETE EPLOC=WTOTNM);
         DELETE EPLOC=WTOTNM
         DS    0H
* TRA005A:
*           MODNN=KNT;
TRA005A  MVC   TMCOM+68(8),TMCOM+60                               0305
*           GOTO TRA019;                 /* RETURN */
         BC    15,TRA019                                          0306
*         END;
*  ELSE;
*    GOTO TRA006;
*  MODNN=WTOTNM;                         /* NON-OLTEP MODULE TO LOAD */
         MVC   TMCOM+68(8),TMCOM+4                                0310
*         GEN(EJECT);
         EJECT
         DS    0H
* TRA006:
*  IF P1B23='11'B THEN                   /* CHECK BITS           M4506*
TRA006   TM    TMCOM+84,B'00110000'                               0312
         BC    12,@9DF                                            0312
*    SUSDEL='1'B;                        /* SUSPEND DELETION     M4506*
         OI    A00002,B'00001000'                                 0313
*  BIN='00'X;                            /* ZERO INDICATOR VALUEX02008*
@9DF     MVI   TMCOM+76,X'00'                                     0314
*  BMCT18='00'X;                         /* ZERO OUT INDICATORS X02008*
         MVI   BMCT18,X'00'                                       0315
*  R8=ADDR(MCT);                         /* MODULE CONTROL TABLEX02008*
         LA    @8,MCT                                             0316
*  HHSIZ=0;                              /* ZERO CORE SIZE REQUEST    *
         SR    @F,@F                                              0317
         ST    @F,A00061+12                                       0317
*  UTSCAL='1'B;                          /* ZERO CORE SIZE      X02008*
         OI    A00005,B'10000000'                                 0318
*  WK1BYT='00'X;                         /* ZERO ITEM INDICATOR X02008*
         MVI   TMCOM+77,X'00'                                     0319
*  IF P1B0='0'B THEN                     /* TEST NAME SIZE      X02008*
         TM    TMCOM+84,B'10000000'                               0320
*    GOTO TRA103;                        /* IFDOLT MODULE ID    X02008*
         BC    08,TRA103                                          0321
* /********************************/
* /***   EIGHT CHARACTER NAME   ***/
* /********************************/
*  MOD8='1'B;                            /* EIGHT CHARACTER NAMEX02008*
         OI    BMCT18,B'00010000'                                 0322
*  WTOTNM=SVP8;                          /* EIGHT CHARACTER NAMEX02008*
         MVC   TMCOM+4(8),TMCOM+86                                0323
*  R8=ADDR(NMCT);                        /* SIMULATE NEW MCT    X02008*
         LA    @8,A00065+20                                       0324
*  R5=R8;                                /* NEW ADDRESS TABLE   X02008*
         LR    @5,@8                                              0325
*  WK1BYT='01'X;                         /* FIRST NEW MCT ITEM  X02008*
         MVI   TMCOM+77,X'01'                                     0326
*  GOTO TRA021;                          /* FIND MODULE         X02008*
         BC    15,TRA021                                          0327
* /******************************/
* /***   TWO CHARACTER NAME   ***/
* /******************************/
* TRA103:
*  WNM=KNAME;                            /* COMMON OLTEP NAME   X02008*
TRA103   MVC   TMCOM+4(6),TMCOM+60                                0328
*  WNAM=SVP2;                            /* VARYING PART NAME   X02008*
         MVC   TMCOM+10(2),TMCOM+86                               0329
* TRA017:
*  DO I=1 TO 20;                         /* ITEMS PER MCT       X02008*
TRA017   LA    @F,1                                               0330
         ST    @F,I                                               0330
*    IF WNAM=MNAM(I) THEN                /* TEST FOR MODULE     X02008*
@DO9DE   L     @C,I                                               0331
         BCTR  @C,0                                               0331
         MH    @C,@D1                                             0331
         LA    @E,10(@C,@8)                                       0331
         CLC   TMCOM+10(2),0(@E)                                  0331
         BC    07,@9DA                                            0331
*      DO;                               /* NAME APPEARS IN MCT X02008*
*        WK1BYT=I4;                      /* ITEM IN MCT         X02008*
         MVC   TMCOM+77(1),I+3                                    0333
*        MB2(I)='0'B;                    /* NOT ACTIVE          X02008*
         LA    @A,8(@C,@8)                                        0334
         NI    0(@A),B'10111111'                                  0334
*        GOTO TRA027;                    /* FIND MODULE         X02008*
         BC    15,TRA027                                          0335
*      END;
*    IF WK1BYT^='00'X                    /* TEST IF ITEM FOUND  X02008*
*          MN1(I)^='00'X THEN           /* AVAILABLE ITEM TEST X02008*
@9DA     CLI   TMCOM+77,X'00'                                     0337
         BC    07,@9D9                                            0337
         L     @C,I                                               0337
         BCTR  @C,0                                               0337
         MH    @C,@D1                                             0337
         LA    @A,10(@C,@8)                                       0337
         CLI   0(@A),X'00'                                        0337
         BC    08,@9D8                                            0337
*      GOTO TRA018;                      /* ITEM ASSIGNED       X02008*
         BC    07,TRA018                                          0338
*    WK1PTR=R8;                          /* ZEROED ITEM IN MCT  X02008*
@9D8     ST    @8,WK1PTR                                          0339
*    WK1BYT=I4;                          /* ZEROED ITEM IN MCT  X02008*
         MVC   TMCOM+77(1),I+3                                    0340
* TRA018:
*  END;
*  IF MNXT^=0 THEN                       /* TEST FOR NEXT MCT   X02008*
TRA018   L     @F,I                                               0341
         AH    @F,@D2                                             0341
@DO9DD   ST    @F,I                                               0341
         CH    @F,@D3                                             0341
         BC    12,@DO9DE                                          0341
         SR    @F,@F                                              0342
         C     @F,4(0,@8)                                         0342
         BC    08,@9D7                                            0342
*    DO;                                 /* ANOTHER MCT EXISTS  X02008*
*      R8=MNXT;                          /* ADDRESS OF NEXT MCT X02008*
         L     @8,4(0,@8)                                         0344
*      GOTO TRA017;                      /* RESUME TEST OF MCT  X02008*
         BC    15,TRA017                                          0345
*    END;
*  IF WK1BYT^='00'X THEN                 /* TEST ITEM INDICATOR X02008*
@9D7     CLI   TMCOM+77,X'00'                                     0347
         BC    08,@9D6                                            0347
*    DO;                                 /* AVAILABLE ITEM      X02008*
*      R8=WK1PTR;                        /* MCT ADDRESS         X02008*
         L     @8,WK1PTR                                          0349
*      R5=ADDR(MCTADS);                  /* MCT ADDRESSES       X02008*
         LA    @5,128(0,@8)                                       0350
*      GOTO TRA021;                      /* FIND MODULE         X02008*
         BC    15,TRA021                                          0351
*    END;
*  GEN(EJECT);
@9D6     EQU   *                                                  0353
         EJECT
         DS    0H
* /*********************************/
* /***   CREATE ADDITIONAL MCT   ***/
* /*********************************/
*  LOSIZ=0;                              /* MINIMUM SIZE ZERO   X02008*
         SR    @F,@F                                              0354
         ST    @F,A00061+8                                        0354
*  HHSIZ=208;                            /* MAXIMUM SIZE REQUESTX02008*
         LA    @F,208                                             0355
         ST    @F,A00061+12                                       0355
*  I4=RID;                               /* ROOT ID BLOCK       X02008*
         MVC   I+3(1),RID                                         0356
* TRA018A:
*  GEN(BAL   R6,TRA040);                 /* GET CORE ROUTINE    X02008*
TRA018A  BAL   R6,TRA040
         DS    0H
*  IF AVSEZ^<HHSIZ THEN                  /* TEST CORE OBTAINED  X02008*
         L     @F,A00061+12                                       0358
         C     @F,A00061+4                                        0358
*    GOTO TRA020;                        /* SUCCESSFUL          X02008*
         BC    12,TRA020                                          0359
*  GEN(BAL   R6,TRA041);                 /* FREE CORE           X02008*
         BAL   R6,TRA041
         DS    0H
*  IF BMCT2='1'B THEN                    /* TEST ATTEMPTS       X02008*
         TM    BMCT18,B'01000000'                                 0361
*    GOTO TRA032A;                       /* SECOND ATTEMPT      X02008*
         BC    01,TRA032A                                         0362
*  BMCT1='1'B;                           /* FIRST TRY TO FREE   X02008*
         OI    BMCT18,B'11000000'                                 0363
*    BMCT2='1'B;                         /* PREVIOUS ATTEMPT    X02008*
*  GOTO TRA128;                          /* DELETE MODULES      X02008*
         BC    15,TRA128                                          0365
* TRA020:
*  R7=AVADR;                             /* LOCATION OF CORE    X02008*
TRA020   L     @7,A00061                                          0366
*  MNXT=R7;                              /* NEW NEXT MCT        X02008*
         ST    @7,4(0,@8)                                         0367
*  R7->MCA=R7->MCA&&R7->MCA;             /* ZERO OUT MCT        X02008*
         XC    0(208,@7),0(@7)                                    0368
*  R7->MPRE=R8;                          /* ADDRESS RECORDED    X02008*
         ST    @8,0(0,@7)                                         0369
*  R8=R7;                                /* NEW MCT ADDRESS     X02008*
         LR    @8,@7                                              0370
*  R5=ADDR(MCTADS);                      /* MCT ADDRESSES       X02008*
         LA    @5,128(0,@8)                                       0371
*  WK1BYT='01'X;                         /* FIRST ITEM IN MCT   X02008*
         MVI   TMCOM+77,X'01'                                     0372
*  GEN(EJECT);
         EJECT
         DS    0H
* /**********************************/
* /***   PREPARE TO LOAD MODULE   ***/
* /**********************************/
* TRA021:
*  R0=ADDR(WKAREA);                      /* BLDL LIST           X02008*
TRA021   LA    @0,TMCOM                                           0374
*  GEN(BLDL  0,(0));                     /* ISSUE BLDL          X02008*
         BLDL  0,(0)
         DS    0H
*  WK24=WK24&&WK24;                      /* ZERO WORK BYTES     X02008*
         XC    TMCOM+36(24),TMCOM+36                              0376
*  IF WR='00'X THEN                      /* TEST FOR MODULE     X02008*
         CLI   TMCOM+14,X'00'                                     0377
*    GOTO TRA038;                        /* NO MODULE           X02008*
         BC    08,TRA038                                          0378
*  HISIZ=WMSIZ+116;                      /* MODULE SIZE          M4507*
         LA    @F,116                                             0379
         MVC   @TEMP2+2(2),TMCOM+29                               0379
         A     @F,@TEMP2                                          0379
         STH   @F,A00061+14                                       0379
*  MMSIZ(WK1BYT)=HISIZ;                  /* MODULE SIZE         X02008*
         SR    @C,@C                                              0380
         IC    @C,TMCOM+77                                        0380
         BCTR  @C,0                                               0380
         MH    @C,@D1                                             0380
         LA    @A,12(@C,@8)                                       0380
         MVC   0(2,@A),A00061+14                                  0380
*  MNAM(WK1BYT)=WNAM;                    /* NAME INTO MCT       X02008*
         LA    @A,10(@C,@8)                                       0381
         MVC   0(2,@A),TMCOM+10                                   0381
* TRA123:
*  I4=BHLD;                              /* NEXT BLOCK TO DELETEX02008*
TRA123   MVC   I+3(1),TMCOM+79                                    0382
*  BHB='00'X;                            /* FIRST PASS          X02008*
         MVI   TMCOM+78,X'00'                                     0383
*  IF HISIZ<662 THEN
         CLC   A00061+14(2),@D4                                   0384
         BC    10,@9D5                                            0384
*    HISIZ=662;
         MVC   A00061+14(2),@D4                                   0385
* TRA023A:
*  LOSIZ=0;                              /* LOWEST MINIMUM SIZE X02008*
@9D5     EQU   *                                                  0386
TRA023A  SR    @F,@F                                              0386
         ST    @F,A00061+8                                        0386
*  IF BHB='01'X THEN
         CLI   TMCOM+78,X'01'                                     0387
*    GOTO TRA023B;
         BC    08,TRA023B                                         0388
*  IF BHB='03'X THEN
         CLI   TMCOM+78,X'03'                                     0389
*    GOTO TRA023F;                       /*                      M4507*
         BC    08,TRA023F                                         0390
*  GEN(BAL   R6,TRA040);                 /* LINK TO OBTAIN CORE X02008*
         BAL   R6,TRA040
         DS    0H
*  IF AVSIZ<HISIZ THEN                   /* TEST MODULE SIZE    X02008*
         CLC   A00061+6(2),A00061+14                              0392
*    GOTO TRA027A;                       /* MODULE TOO LARGE    X02008*
         BC    04,TRA027A                                         0393
*  BHB='01'X;
         MVI   TMCOM+78,X'01'                                     0394
*  GAVL1=GAVL;
         MVC   TMCOM+52(8),TMCOM+36                               0395
* TRA023B:
*  GEN(BAL   R6,TRA040);
TRA023B  BAL   R6,TRA040
         DS    0H
*  IF AVSIZ<HISIZ THEN
         CLC   A00061+6(2),A00061+14                              0397
*    GOTO TRA027A;
         BC    04,TRA027A                                         0398
*  BHB='02'X;
         MVI   TMCOM+78,X'02'                                     0399
*  GEN(BAL   R6,TRA041);
         BAL   R6,TRA041
         DS    0H
* TRA023C:
*  GAVL=GAVL1;
TRA023C  MVC   TMCOM+36(8),TMCOM+52                               0401
*  GEN(BAL   R6,TRA041);
         BAL   R6,TRA041
         DS    0H
*  IF BHB='02'X THEN
         CLI   TMCOM+78,X'02'                                     0403
*    GOTO TRA023E;
         BC    08,TRA023E                                         0404
* TRA023D:
*  BHB='03'X;
TRA023D  MVI   TMCOM+78,X'03'                                     0405
*  GEN(BAL   R6,TRA044);                 /* GET LOAD WORK AREA  X02008*
         BAL   R6,TRA044
         DS    0H
*  HISIZ=HISIZ+662;
         LA    @F,662                                             0407
         MVC   @TEMP2+2(2),A00061+14                              0407
         A     @F,@TEMP2                                          0407
         STH   @F,A00061+14                                       0407
* TRA023F:                               /*                      M4507*
*  GEN(BAL   R6,TRA040);
TRA023F  BAL   R6,TRA040
         DS    0H
*  IF AVSIZ<HISIZ THEN
         CLC   A00061+6(2),A00061+14                              0409
*    GOTO TRA027A;
         BC    04,TRA027A                                         0410
*  GEN(BAL   R6,TRA041);
         BAL   R6,TRA041
         DS    0H
*  GEN(BAL   R6,TRA043);                 /* FREE WORK AREA      X02008*
         BAL   R6,TRA043
         DS    0H
*         GEN(EJECT);
         EJECT
         DS    0H
* /***********************/
* /***   LOAD MODULE   ***/
* /***********************/
* TRA023E:
*  R0=ADDR(WITEM);                       /* MODULE NAME         X02008*
TRA023E  LA    @0,TMCOM+4                                         0414
*  GEN(LOAD  EPLOC=(0));                 /* LOAD MODULE         X02008*
         LOAD  EPLOC=(0)
         DS    0H
*  WK1PTR=R0;                            /* MODULE ENTRY POINT  X02008*
         ST    @0,WK1PTR                                          0416
*  I=(R0/2048);                          /* BLOCK ID ASSIGNED   X02008*
         LR    @E,@0                                              0417
         SRA   @E,11                                              0417
         ST    @E,I                                               0417
*  IF I4='00'X THEN                      /* TEST BLOCK ID       X02008*
         CLI   I+3,X'00'                                          0418
         BC    07,@9D4                                            0418
*    I4='01'X;                           /* ASSIGN NEXT ID      X02008*
         MVI   I+3,X'01'                                          0419
*  MNM2(WK1BYT)=I4;                      /* BLOCK ASSIGNMENT ID X02008*
@9D4     SR    @C,@C                                              0420
         IC    @C,TMCOM+77                                        0420
         BCTR  @C,0                                               0420
         MH    @C,@D1                                             0420
         LA    @A,9(@C,@8)                                        0420
         MVC   0(1,@A),I+3                                        0420
*  MB2(WK1BYT)='1'B;                     /* MODULE IN CORE      X02008*
         LA    @A,8(@C,@8)                                        0421
         OI    0(@A),B'01000000'                                  0421
*  TADR(WK1BYT)=WK1PTR;                  /* MODULE ADDRESS      X02008*
         L     @F,WK1PTR                                          0422
         SR    @C,@C                                              0422
         IC    @C,TMCOM+77                                        0422
         BCTR  @C,0                                               0422
         SLA   @C,2                                               0422
         ST    @F,0(@C,@5)                                        0422
*  IF I4='FF'X THEN                      /* TEST BLOCK ID       X02008*
         CLI   I+3,X'FF'                                          0423
         BC    07,@9D3                                            0423
*    I4='00'X;                           /* PREPARE LOWEST ID   X02008*
         MVI   I+3,X'00'                                          0424
*  I=I+1;                                /* NEXT BLOCK ID       X02008*
@9D3     LA    @F,1                                               0425
         A     @F,I                                               0425
         ST    @F,I                                               0425
*  BHLD=I4;                              /* NEXT BLOCK TO DELETEX02008*
         MVC   TMCOM+79(1),I+3                                    0426
* TRA125:
*  R4=WK1PTR;                            /* ADDRESS FOR REG 15  X02008*
TRA125   L     @4,WK1PTR                                          0427
*  IF P1B23^='00'B THEN                  /* CHECK INDICATORS    X02008*
         TM    TMCOM+84,B'00110000'                               0428
*    GOTO TRA016;                        /* RETURN TO CALLER    X02008*
         BC    05,TRA016                                          0429
* /***********************************/
* /***   BRANCH TO CALLED MODULE   ***/
* /***********************************/
* TRA013:
*  R13=CHNBK;                            /* SAVE AREA OF CALLER X02008*
TRA013   L     @D,4(0,@D)                                         0430
*  GEN(L     R14,12(R13));               /* RESTORE REG 14      X02008*
         L     R14,12(R13)
         DS    0H
*  R15=R4;                               /* RESTORE REG 15      X02008*
         LR    @F,@4                                              0432
*  GEN(LM    R0,R12,20(R13));            /* RESTORE REGS        X02008*
         LM    R0,R12,20(R13)
         DS    0H
*  GOTO R15;                             /* GO TO MODULE        X02008*
         BCR   15,@F                                              0434
* /****************************/
* /***   RETURN TO CALLER   ***/
* /****************************/
* TRA019:
*  R4=0;                                 /* RETURN CODE         X02008*
TRA019   SR    @4,@4                                              0435
* TRA016:
*  SUSDEL='0'B;                          /* ZERO OUT BIT        X02008*
TRA016   NI    A00002,B'11110111'                                 0436
*  R13=CHNBK;                            /* CALLER SAVE AREA */
         L     @D,4(0,@D)                                         0437
*  GEN(L     R14,12(R13));               /* RESTORE REG 14 */
         L     R14,12(R13)
         DS    0H
*  R15=R4;                               /* REG 15 VALUE */
         LR    @F,@4                                              0439
*  GEN(LM    R0,R12,20(R13));            /* RESTORE REGS 0 THRU 12 */
         LM    R0,R12,20(R13)
         DS    0H
*  GOTO R14;                             /* RETURN */
         BCR   15,@E                                              0441
*         GEN(EJECT);
         EJECT
         DS    0H
* /**************************************/
* /***   TRACE OR RETURN CODE SETUP   ***/
* /**************************************/
* TRA012D:                               /* RETURN OR TRACE TESTX02008*
*  IF TRACE='1'B THEN                    /* CHECK FOR TRACE     X02008*
TRA012D  TM    A00014+36,B'00000100'                              0443
*    GOTO TRA012F;                       /* TRACE REQUESTED     X02008*
         BC    01,TRA012F                                         0444
*  IF CLEANUP='0'B&                      /* CHECK FOR NO CLEANUPX02008*
*    RTMASK^='00'X THEN                  /* CHECK RETURN MASK   X02008*
         TM    A00014+33,B'00000100'                              0445
         BC    05,@9D2                                            0445
         CLI   70(@2),X'00'                                       0445
         BC    08,@9D1                                            0445
*      DO;                               /* RETURN CODE SET UP  X02008*
* TRA012F:                               /* PREPARE RETURN      X02008*
*        IF BRIDB14='0000'B THEN         /* CHECK MACRO         X02008*
TRA012F  TM    BRID,B'11110000'                                   0447
         BC    05,@9D0                                            0447
*          DO;                           /* NEW MACRO CALL      X02008*
*            RTMCID=PLID;                /* MACRO ID            X02008*
         MVC   RETMSG+21(2),2(@3)                                 0449
*            GOTO TRA012G;               /* SKIP STATEMENTS     X02008*
         BC    15,TRA012G                                         0450
*          END;                          /* END MACRO CHECK     X02008*
*        RTMCID=BRID;                    /* OLD MACRO ID        X02008*
@9D0     MVC   RETMSG+21(2),BRID                                  0452
*        RTNM14(2:4)=RTNM14(1:3);        /* CLEAR ROUTINE NUM   X02008*
         MVC   RETMSG+14(3),RETMSG+13                             0453
* TRA012G:
*        UTRET=R5;                       /* SAVE UTS RETURN     X02008*
TRA012G  ST    @5,UTRET                                           0454
*        SVR14=ADDR(TRA130);             /* RETURN CODE HANDLER X02008*
         LA    @F,TRA130                                          0455
         L     @C,4(0,@D)          
         ST    @F,12(0,@C)                                        0455
*      END;                              /* END CHECK           X02008*
*  UTSCAL='0'B;                          /* UTS CALL            X02008*
@9D1     EQU   *                                                  0457
@9D2     NI    A00005,B'01111111'                                 0457
*  GOTO R9;                              /* RETURN TO MAIN FLOW X02008*
         BCR   15,@9                                              0458
* /*************************************/
* /***   MODULE ID RECORDED IN MCT   ***/
* /*************************************/
* TRA027:
*  IF SUSDEL='1'B THEN                   /* CHECK INDICATOR     X02008*
TRA027   TM    A00002,B'00001000'                                 0459
*    GOTO TRA019;                        /* SUSPEND DELETION    X02008*
         BC    01,TRA019                                          0460
*  IF P1B3='1'B THEN                     /* CHECK FUNCTION      X02008*
         TM    TMCOM+84,B'00010000'                               0461
         BC    12,@9CF                                            0461
*    DO;                                 /* DELETE FUNCTION     X02008*
*      IF MB1(WK1BYT)='1'B THEN          /*IS THIS MODULE PER- X03008*/
         SR    @C,@C                                              0463
         IC    @C,TMCOM+77                                        0463
         BCTR  @C,0                                               0463
         MH    @C,@D1                                             0463
         LA    @A,8(@C,@8)                                        0463
         TM    0(@A),B'10000000'                                  0463
*                                        /* MANENTLY RESIDENT. X03008*/
*        GO TO TRA019;                   /* YES, BYPASS DELETE X03008*/
         BC    01,TRA019                                          0464
*                                        /* REQUEST.           X03008*/
*      GEN(DELETE EPLOC=WTOTNM);         /* DELETE MODULE       X02008*
         DELETE EPLOC=WTOTNM
         DS    0H
*      TITEM(WK1BYT)=0;                  /* ZERO ADDRESS        X02008*
         SR    @F,@F                                              0466
         SR    @C,@C                                              0466
         IC    @C,TMCOM+77                                        0466
         BCTR  @C,0                                               0466
         SLA   @C,2                                               0466
         ST    @F,128(@C,@8)                                      0466
*      MNM2(WK1BYT)='00'X;               /* BLOCK ID            X02008*
         SR    @C,@C                                              0467
         IC    @C,TMCOM+77                                        0467
         BCTR  @C,0                                               0467
         MH    @C,@D1                                             0467
         LA    @A,9(@C,@8)                                        0467
         MVI   0(@A),X'00'                                        0467
*      GOTO TRA019;                      /* RETURN              X02008*
         BC    15,TRA019                                          0468
*    END;                                /* END CHECKING        X02008*
*  IF TITEM(WK1BYT)^=0 THEN              /* TEST MODULE IN CORE X02008*
@9CF     SR    @F,@F                                              0470
         SR    @C,@C                                              0470
         IC    @C,TMCOM+77                                        0470
         BCTR  @C,0                                               0470
         SLA   @C,2                                               0470
         C     @F,128(@C,@8)                                      0470
         BC    08,@9CE                                            0470
*    DO;                                 /* MODULE IN CORE      X02008*
*      WK1PTR=TITEM(WK1BYT);             /* ADDRESS OF MODULE   X02008*
         L     @F,128(@C,@8)                                      0472
         ST    @F,WK1PTR                                          0472
*      MB2(WK1BYT)='1'B;                 /* MODULE ACTIVE       X02008*
         SR    @C,@C                                              0473
         IC    @C,TMCOM+77                                        0473
         BCTR  @C,0                                               0473
         MH    @C,@D1                                             0473
         LA    @A,8(@C,@8)                                        0473
         OI    0(@A),B'01000000'                                  0473
*      GOTO TRA125;                      /* GO TO MODULE        X02008*
         BC    15,TRA125                                          0474
*    END;
*  HISIZ=MMSIZ(WK1BYT)+48;               /* MAXIMUM REQUEST     X02008*
@9CE     LA    @F,48                                              0476
         SR    @C,@C                                              0476
         IC    @C,TMCOM+77                                        0476
         BCTR  @C,0                                               0476
         MH    @C,@D1                                             0476
         LA    @A,12(@C,@8)                                       0476
         MVC   @TEMP2+2(2),0(@A)                                  0476
         A     @F,@TEMP2                                          0476
         STH   @F,A00061+14                                       0476
*  R5=ADDR(MCTADS);                      /* MCT ADDRESSES       X02008*
         LA    @5,128(0,@8)                                       0477
*  GOTO TRA123;                          /* CHECK FOR SIZE      X02008*
         BC    15,TRA123                                          0478
*  GEN(EJECT);
         EJECT
         DS    0H
* /********************************/
* /***   DELETE OLTEP MODULES   ***/
* /********************************/
* TRA027A:
*  GEN(BAL   R6,TRA041);                 /* LINK TO FREE CORE   X02008*
TRA027A  BAL   R6,TRA041
         DS    0H
* TRA128:
*  BMCT4='0'B;                           /* NO DELETIONS        X02008*
TRA128   NI    BMCT18,B'11110111'                                 0481
* TRA029:
*  SAVR8=R8;                             /* SAVE REG 8 VALUE    X02008*
TRA029   ST    @8,SAVR8                                           0482
* TRA030:
*  R8=ADDR(MCT);                         /* MCT ADDRESS         X02008*
TRA030   LA    @8,MCT                                             0483
* TRA031:
*  DO R4=20 TO 1 BY -1;                  /* ITEMS IN MCT        X02008*
TRA031   LA    @4,20                                              0484
*    IF UTSCAL='0'B THEN                 /* TEST IF UTS CALL    X02008*
@DO9CD   TM    A00005,B'10000000'                                 0485
         BC    05,@9C9                                            0485
*      DO;                               /* CALL FROM UTS       X02008*
*        MB2(R4)='0'B;                   /* NOT ACTIVE FOR UTS  X02008*
         LR    @C,@4                                              0487
         BCTR  @C,0                                               0487
         MH    @C,@D1                                             0487
         LA    @A,8(@C,@8)                                        0487
         NI    0(@A),B'10111111'                                  0487
*        GOTO TRA032;                    /* ZERO ALL ACTIVE BITSX02008*
         BC    15,TRA032                                          0488
*      END;                              /* END OF BIT UPDATE   X02008*
*    IF MNM2(R4)=I4                      /* TEST FOR BLOCK ID   X02008*
*          &MB1(R4)='0'B                 /* TEST NO DELETE BIT  X02008*
*          &MB2(R4)='0'B THEN            /* TEST ACTIVE FOR UTS X02008*
@9C9     LR    @C,@4                                              0490
         BCTR  @C,0                                               0490
         MH    @C,@D1                                             0490
         LA    @A,9(@C,@8)                                        0490
         CLC   0(1,@A),I+3                                        0490
         BC    07,@9C8                                            0490
         LA    @A,8(@C,@8)                                        0490
         TM    0(@A),B'10000000'                                  0490
         BC    05,@9C7                                            0490
         TM    0(@A),B'01000000'                                  0490
         BC    05,@9C6                                            0490
*      DO;                               /* DELETE MODULE OK    X02008*
*        KNMV=MNAM(R4);                  /* VARYING PART OF NAMEX02008*
         LA    @E,10(@C,@8)                                       0492
         MVC   TMCOM+66(2),0(@E)                                  0492
*        IF LOGADR^=0 THEN               /* CHECK LOGSCAN       X02008*
         SR    @F,@F                                              0493
         C     @F,LOGADR                                          0493
         BC    08,@9C5                                            0493
*          DO;                           /* LOGSCAN ACTIVE      X02008*
*            IF KNMV='26' THEN           /* LOGSCAN ID          X02008*
         CLC   TMCOM+66(2),@C18                                   0495
*              GOTO TRA032;              /* SKIP DELETIONS      X02008*
         BC    08,TRA032                                          0496
*            IF KNMV='46' THEN           /* EXTRACTOR ID        X02008*
         CLC   TMCOM+66(2),@C19                                   0497
*              GOTO TRA032;              /* SKIP DELETIONS      X02008*
         BC    08,TRA032                                          0498
*          END;                          /* DELETE MODULES      X02008*
*        MNM2(R4)='00'X;                 /* ZERO OUT BLOCK ID   X02008*
@9C5     LR    @C,@4                                              0500
         BCTR  @C,0                                               0500
         MH    @C,@D1                                             0500
         LA    @A,9(@C,@8)                                        0500
         MVI   0(@A),X'00'                                        0500
*        R0=ADDR(KNT);                   /* MODULE NAME         X02008*
         LA    @0,TMCOM+60                                        0501
*        GEN(DELETE EPLOC=(0));          /* DELETE MODULE       X02008*
         DELETE EPLOC=(0)
         DS    0H
*        TITEM(R4)=0;                    /* MODULE NOT IN CORE  X02008*
         SR    @F,@F                                              0503
         LR    @C,@4                                              0503
         BCTR  @C,0                                               0503
         SLA   @C,2                                               0503
         ST    @F,128(@C,@8)                                      0503
*        BMCT4='1'B;                     /* INDICATE DELETIONS  X02008*
         OI    BMCT18,B'00001000'                                 0504
*      END;                              /* END UPDATING MODULE X02008*
* TRA032:
*  END;                                  /* COMPLETE MCT TESTED X02008*
@9C6     EQU   *                                                  0506
@9C7     EQU   *                                                  0506
@9C8     EQU   *                                                  0506
*  R8=MNXT;                              /* NEXT MCT IF ANY     X02008*
TRA032   BCT   @4,@DO9CD                                          0506
         L     @8,4(0,@8)                                         0507
*  IF R8^=0 THEN                         /* TEST NEXT MCT       X02008*
         LTR   @8,@8                                              0508
*    GOTO TRA031;                        /* TEST NEXT MCT       X02008*
         BC    07,TRA031                                          0509
*  R8=SAVR8;                             /* RESTORE REG 8 VALUE X02008*
         L     @8,SAVR8                                           0510
*  GEN(EJECT);
         EJECT
         DS    0H
* /*******************************/
* /***   RETURN TO MAIN FLOW   ***/
* /*******************************/
*  IF UTSCAL='0'B THEN                   /* TEST FIRST UTS CALL X02008*
         TM    A00005,B'10000000'                                 0512
*    GOTO R9;                            /* CALL FROM UTS       X02008*
         BCR   08,@9                                              0513
*  IF I4=BHLD THEN                       /* TEST BLOCK ID       X02008*
         CLC   I+3(1),TMCOM+79                                    0514
         BC    07,@9C4                                            0514
*    BIN=BIN+1;                          /* BLOCK COUNT STARTS  X02008*
         LA    @F,1                                               0515
         SR    @0,@0                                              0515
         IC    @0,TMCOM+76                                        0515
         AR    @F,@0                                              0515
         STC   @F,TMCOM+76                                        0515
*  I=I+1;                                /* NEXT BLOCK ID       X02008*
@9C4     LA    @F,1                                               0516
         A     @F,I                                               0516
         ST    @F,I                                               0516
*  IF I4='00'X THEN                      /* TEST FOR VALID ID   X02008*
         CLI   I+3,X'00'                                          0517
         BC    07,@9C3                                            0517
*    I4='01'X;                           /* LOWEST VALID ID     X02008*
         MVI   I+3,X'01'                                          0518
*  IF BMCT4='0'B&                        /* NO DELETIONS MADE   X02008*
*    BIN^>'02'X THEN                     /* INCOMPLETE PASS      M4506*
@9C3     TM    BMCT18,B'00001000'                                 0519
         BC    05,@9C2                                            0519
         CLI   TMCOM+76,X'02'                                     0519
*      GOTO TRA030;                      /* DELETE NEXT BLOCK   X02008*
         BC    13,TRA030                                          0520
*  IF BMCT1='1'B THEN                    /* TEST REQUEST        X02008*
@9C1     EQU   *                                                  0521
@9C2     TM    BMCT18,B'10000000'                                 0521
*    GOTO TRA018A;                       /* MCT CORE REQUEST    X02008*
         BC    01,TRA018A                                         0522
*  IF BMCT4='1'B THEN                    /* TEST DELETION BIT   X02008*
         TM    BMCT18,B'00001000'                                 0523
*    GOTO TRA023A;                       /* DELETIONS MADE      X02008*
         BC    01,TRA023A                                         0524
*  IF BIN^>'02'X THEN                    /* TEST DELETIONS       M4506*
         CLI   TMCOM+76,X'02'                                     0525
*    GOTO TRA030;                        /* DELETE MORE MODULES X02008*
         BC    12,TRA030                                          0526
*  IF BHB='00'X THEN
         CLI   TMCOM+78,X'00'                                     0527
*    GOTO TRA023D;
         BC    08,TRA023D                                         0528
*  IF BHB='01'X THEN
         CLI   TMCOM+78,X'01'                                     0529
*    GOTO TRA023C;
         BC    08,TRA023C                                         0530
*  GEN(BAL   R6,TRA043);                 /* FREE WORK AREA      X02008*
         BAL   R6,TRA043
         DS    0H
* /***************************/
* /***   NOT ENOUGH CORE   ***/
* /***************************/
* TRA032A:
*  R1=IFD160;                            /* INSUFFICIENT CORE   X02008*
TRA032A  L     @C,MSGMOD                                          0532
         L     @1,56(0,@C)                                        0532
* TRA024A:
*  GEN(PWTO  REG=(1));                   /* ISSUE A WTO         X02008*
TRA024A  PWTO  REG=(1)
         DS    0H
* TRA025:
*  R4=4;                                 /* MODULE NOT AVAILABLEX02008*
TRA025   LA    @4,4                                               0534
*  GOTO TRA016;                          /* RETURN TO CALLER    X02008*
         BC    15,TRA016                                          0535
* TRA038:
*  IF MOD8='1'B THEN                     /* TEST MODULE NAME    X02008*
TRA038   TM    BMCT18,B'00010000'                                 0536
         BC    12,@9C0                                            0536
*    MODNN=KNT;                          /* NON OLTEP MODULE    X02008*
         MVC   TMCOM+68(8),TMCOM+60                               0537
*  GOTO TRA025;                          /* MODULE NOT FOUND    X02008*
         BC    15,TRA025                                          0538
* /*****************************************/
* /***   GETMAIN AND FREEMAIN ROUTINES   ***/
* /*****************************************/
* TRA040:
*  GAVL=GAVL&&GAVL;                      /* ZERO OUT WORK AREA  X02008*
TRA040   XC    TMCOM+36(8),TMCOM+36                               0539
*  IF HHSIZ=0 THEN                       /* TEST SIZE           X02008*
         SR    @F,@F                                              0540
         C     @F,A00061+12                                       0540
*    GOTO R6;                            /* SIZE IS ZERO        X02008*
         BCR   08,@6                                              0541
*  GEN(GETMAIN VC,LA=GSIZS,A=GAVL);      /* GET AVAILABLE CORE  X02008*
         GETMAIN VC,LA=GSIZS,A=GAVL
         DS    0H
*  GOTO R6;                              /* BRANCH BACK         X02008*
         BCR   15,@6                                              0543
* TRA041:
*  IF AVSEZ=0 THEN                       /* TEST SIZE           X02008*
TRA041   SR    @F,@F                                              0544
         C     @F,A00061+4                                        0544
*    GOTO R6;                            /* MISSING VALUE       X02008*
         BCR   08,@6                                              0545
*  IF AVADR=0 THEN                       /* TEST ADDRESS        X02008*
         C     @F,A00061                                          0546
*    GOTO R6;                            /* MISSING VALUE       X02008*
         BCR   08,@6                                              0547
*  GEN(FREEMAIN V,A=GAVL);               /* FREE OBTAINED CORE  X02008*
         FREEMAIN V,A=GAVL
         DS    0H
*  GAVL=GAVL&&GAVL;                      /* ZERO OUT WORK AREA  X02008*
         XC    TMCOM+36(8),TMCOM+36                               0549
*  GOTO R6;                              /* BRANCH BACK         X02008*
         BCR   15,@6                                              0550
* TRA043:
*  AVADR=GTCOR;                          /* GOTTEN CORE ADDRESS X02008*
TRA043   MVC   A00061(4),TMCOM+80                                 0551
*  IF GTCOR=0 THEN                       /* TEST SIZE           X02008*
         SR    @F,@F                                              0552
         C     @F,TMCOM+80                                        0552
*    GOTO R6;                            /* MISSING VALUE       X02008*
         BCR   08,@6                                              0553
*  GEN(FREEMAIN E,LV=656,A=AVADR);       /* FREE CORE           X02008*
         FREEMAIN E,LV=656,A=AVADR
         DS    0H
*  GTCOR=0;                              /* NO CORE             X02008*
         SR    @F,@F                                              0555
         ST    @F,TMCOM+80                                        0555
*  GOTO R6;                              /* BRANCH BACK         X02008*
         BCR   15,@6                                              0556
* TRA044:
*  AVADR=0;                              /* NO CORE             X02008*
TRA044   SR    @F,@F                                              0557
         ST    @F,A00061                                          0557
*  GEN(GETMAIN EC,LV=656,A=AVADR);       /* OBTAIN CORE         X02008*
         GETMAIN EC,LV=656,A=AVADR
         DS    0H
*  IF R15^=0 THEN                        /* TEST CONDITION CODE X02008*
         LTR   @F,@F                                              0559
         BC    08,@9BF                                            0559
*    AVADR=0;                            /* NOT SUCCESSFUL      X02008*
         SR    @F,@F                                              0560
         ST    @F,A00061                                          0560
*  GTCOR=AVADR;                          /* SAVE CORE ADDRESS   X02008*
@9BF     MVC   TMCOM+80(4),A00061                                 0561
*  GOTO R6;                              /* BRANCH BACK         X02008*
         BCR   15,@6                                              0562
*    GEN(EJECT);
         EJECT
         DS    0H
* /***************************/
* /***   ROUTINE HANDLER   ***/
* /***************************/
* TRA022:
*  SVR14=R5;                             /* UTS RETURN ADDRESS  X02008*
TRA022   L     @C,4(0,@D)          
         ST    @5,12(0,@C)                                        0564
*  RTMASK='00'X;                         /* CLEAR RETURN MASK   X02008*
         MVI   70(@2),X'00'                                       0565
*  IF SVPL>'02'X THEN                    /* CHECK MACRO LEVEL */
         CLI   TMCOM+85,X'02'                                     0566
*    GOTO TRA025;                        /* LEVEL NOT SUPPORTED */
         BC    02,TRA025                                          0567
*  R4=RTNN;                              /* ROUTINE NUMBER */
         SR    @4,@4                                              0568
         IC    @4,8(0,@3)                                         0568
*  GEN(CVD   R4,64(R13));                /* ROUTINE IN DECIMAL        *
         CVD   R4,64(R13)
         DS    0H
*  GEN(UNPK  RTLOC(4),64(8,R13));        /* UNPACK              X02008*
         UNPK  RTLOC(4),64(8,R13)
         DS    0H
*  GEN(MVZ   RTLOC+3(1),RTLOC+2);        /* MOVE ZONE           X02008*
         MVZ   RTLOC+3(1),RTLOC+2
         DS    0H
*  RTRTNM=RTLOC(2:4);                    /* ROUTINE NUMBER      X02008*
         MVC   RETMSG+14(3),RETMSG+28                             0572
*  IF RTNN>TERTN THEN                    /* CHECK ROUTINE NUMBER      *
         CLC   8(1,@3),A00008                                     0573
         BC    12,@9BE                                            0573
*                                        /*                     A45731*
*    TERTN=RTNN;                         /* INSERT HIGHEST NUMBER     *
         MVC   A00008(1),8(@3)                                    0574
*                                        /*                     A45731*
*  R6=R4/8;                              /* MULTIPLES OF EIGHT */
@9BE     LR    @E,@4                                              0575
         SRA   @E,3                                               0575
         LR    @6,@E                                              0575
*  R4=R4-(R6*8);                         /* BIT COUNT */
         LA    @F,8                                               0576
         MR    @E,@6                                              0576
         LCR   @F,@F                                              0576
         AR    @4,@F                                              0576
*  IF R4=0 THEN                          /* TEST BIT COUNT */
         LTR   @4,@4                                              0577
         BC    07,@9BD                                            0577
*    R4=8;                               /* EIGHTH BIT OF BYTE */
         LA    @4,8                                               0578
         BC    15,@9BC                                            0579
*  ELSE R6=R6+1;                         /* BYTE COUNT */
@9BD     AH    @6,@D2                                             0579
*  IF R6>2 THEN                          /* TEST ROUTINE NUMBER */
@9BC     CH    @6,@D5                                             0580
         BC    12,@9BB                                            0580
*    R5=ADDR(SCTW9C);                    /* MASK FOR ABOVE ROUTINE 2 */
         LA    @5,A00014+38                                       0581
         BC    15,@9BA                                            0582
*  ELSE R5=ADDR(SCTW1);                  /* MASK FOR ROUTINES 1 OR 2 */
@9BB     LA    @5,A00014+4                                        0582
*  RR=MASK(R4)&RTN8(R6);                 /* MASK OUT ROUTINE BIT */
@9BA     LR    @C,@6                                              0583
         BCTR  @C,0                                               0583
         LA    @E,0(@C,@5)                                        0583
         MVC   LIST(1),0(@E)                                      0583
         LR    @C,@4                                              0583
         LA    @E,LIST(@C)                                        0583
         NC    LIST(1),0(@E)                                      0583
*  IF RR='00'X THEN                      /* TEST ROUTINE TO GO TO */
         CLI   LIST,X'00'                                         0584
*    GOTO TRA023;                        /* GO TO NEXT ROUTINE */
         BC    08,TRA023                                          0585
*  IF MIMK='1'B&                         /* TEST MASK BIT IN MACRO */
*    MIBT='0'B THEN                      /* TEST MI BIT IN SCT */
         TM    10(@3),B'10000000'                                 0586
         BC    12,@9B9                                            0586
         TM    A00014+36,B'10000000'                              0586
         BC    05,@9B8                                            0586
*      DO;                               /* SKIP ROUTINE              *
*        R1=IFD210;                      /* PTR TO IFD210 MSG         *
         L     @C,MSGMOD                                          0588
         L     @1,64(0,@C)                                        0588
*        MIRTNM=RTLOC(1:4);              /* ROUTINE NUMBER      X02008*
         MVC   20(4,@1),RETMSG+27                                 0589
*        GEN(PWTO  REG=(1));             /* ISSUE WTO                 *
         PWTO  REG=(1)
         DS    0H
* TRA023:
*        R4=RTNEXT;                      /* NEXT ROUTINE        X02008*
TRA023   L     @4,4(0,@3)                                         0591
*        GOTO TRA013;                    /* GO TO ROUTINE       X02008*
         BC    15,TRA013                                          0592
*      END;                              /* END SKIPPING              *
*        R7=SECPRF;                      /* ROUTINE NUMBER ADDRESS */
@9B8     EQU   *                                                  0594
@9B9     L     @7,A00009+36                                       0594
*        ERBT='0'B;                      /* ZERO ERROR BIT IN SCT */
         NI    A00014+3,B'01111111'                               0595
*        RTN=RTNN;                       /* RTN INTO SECTION PREFACE */
         MVC   0(1,@7),8(@3)                                      0596
*        IF REFN^='00'X THEN             /* TEST FOR REFERENCE NUMBER *
         CLI   9(@3),X'00'                                        0597
         BC    08,@9B7                                            0597
*          REFNUM=REFN;                  /* NUMBER INTO SECTION */
         MVC   17(1,@7),9(@3)                                     0598
*        RETURN;                         /* NORMAL RETURN */
         BC    15,@EL01                                           0599
* TRA028:
*  IF CLEANRT='1'B THEN                  /* DOES OLT HAVE CLN-UPX03008*
TRA028   TM    A00014+36,B'01000000'                              0600
         BC    12,@9B6                                            0600
*    CLEANUP='1'B;                       /* YES, MAKE SURE      X03008*
         OI    A00014+33,B'00000100'                              0601
*                                        /* CLEANUP EXECUTED    X03008*
*  ASTERB='1'B;                          /* INDICATE ASTERISK */
@9B6     OI    A00014+3,B'01000000'                               0602
*  CHNBK=SCHEDSA;                        /* SCHEDULER SAVE AREA */
         MVC   4(4,@D),SCHEDSA                                    0603
*  RETURN;                               /* RETURN TO SCHEDULER */
         BC    15,@EL01                                           0604
*         GEN(EJECT);
         EJECT
         DS    0H
         BC    15,@9B5                                            0606
* TRA130:
*  ENTRY(X);                             /* RETURN CODE HANDLER X02008*
TRA130   STM   @E,@C,12(@D)                                       0606
         BALR  @B,0                                               0606
         LA    @F,TRA130-IFDOLT18-24                              0606
         SR    @B,@F                                              0606
         ST    @D,@SAV001+4                                       0606
         LA    @F,@SAV001                                         0606
         ST    @F,8(0,@D)                                         0606
         LR    @D,@F                                              0606
*  SVR14=UTRET;                          /* UTS RETURN ADDRESS  X02008*
@9B5     L     @C,4(0,@D)          
         MVC   12(4,@C),UTRET                                     0607
*  R4=SV15;                              /* RETURN CODE         X02008*
         L     @4,16(0,@C)                                        0608
*  R5=R4;                                /* RETURN CODE SAVED   X02008*
         LR    @5,@4                                              0609
*  RTAST=' ';                            /* BLANK CHARACTER     X02008*
         MVI   RETMSG+8,C' '                                      0610
*  IF CLEANUP='1'B THEN                  /* CHECK FOR CLEANUP   X02008*
         TM    A00014+33,B'00000100'                              0611
*    GOTO TRA035;                        /* CHECK TRACE REQUEST X02008*
         BC    01,TRA035                                          0612
*  IF RTMASK='00'X THEN                  /* TEST RETURN CODE    X02008*
         CLI   70(@2),X'00'                                       0613
*    GOTO TRA035;                        /* NO RETURN CODE MASK X02008*
         BC    08,TRA035                                          0614
*  IF R4=0 THEN                          /* CHECK RETURN CODE   X02008*
         LTR   @4,@4                                              0615
*    GOTO TRA035;                        /* GOOD RETURN CODE    X02008*
         BC    08,TRA035                                          0616
*  IF R4>32 THEN                         /* CHECK RETURN CODE   X02008*
         CH    @4,@D6                                             0617
*    GOTO TRA035;                        /* ILLEGAL RETURN CODE X02008*
         BC    02,TRA035                                          0618
*  R4=R4/4;                              /* MULTIPLE OF FOUR    X02008*
         LR    @E,@4                                              0619
         SRA   @E,2                                               0619
         LR    @4,@E                                              0619
*  RR=RTMASK;                            /* MASK BITS FROM SCT  X02008*
         MVC   LIST(1),70(@2)                                     0620
*  R4=R4+ADDR(LIST);                     /* MASK BIT RETURNED   X02008*
         LA    @F,LIST                                            0621
         AR    @4,@F                                              0621
*  RR=RR&MDMASK;                         /* AND MASK TOGETHER   X02008*
         NC    LIST(1),0(@4)                                      0622
*  IF RR^=MDMASK THEN                    /* CHECK IF BITS MATCH X02008*
         CLC   LIST(1),0(@4)                                      0623
*    GOTO TRA035;                        /* CHECK TRACE REQUEST X02008*
         BC    07,TRA035                                          0624
*  RTAST='*';                            /* RETCODE REQUEST     X02008*
         MVI   RETMSG+8,C'*'                                      0625
*  GOTO TRA037;                          /* RETCODE REQUEST     X02008*
         BC    15,TRA037                                          0626
* TRA035:
*    IF TRACE='0'B THEN                  /* CHECK TRACE         X02008*
TRA035   TM    A00014+36,B'00000100'                              0627
*    RETURN;                             /* RETURN TO UTS       X02008*
         BC    10,@EL01                                           0628
* TRA037:
*  GEN(BAL   R9,TRA039);                 /* HEX TO EBCDIC       X02008*
@9B4     EQU   *                                                  0629
TRA037   BAL   R9,TRA039
         DS    0H
*  RTTERM=RTLOC(7:8);                    /* RETURN CODE TO PRINTX02008*
         MVC   RETMSG+39(2),RETMSG+33                             0630
*  R5=UTRET;                             /* UTS RETURN ADDRESS  X02008*
         L     @5,UTRET                                           0631
*  GEN(BAL   R9,TRA039);                 /* HEX TO EBCDIC       X02008*
         BAL   R9,TRA039
         DS    0H
*  PRTBUFR(1)=' ';                       /* CLEAR PRINT LOCATIONX02008*
         MVI   PRTBUFR,C' '                                       0633
*  PRTBUFR(2:124)=PRTBUFR(1:123);        /* CLEAR PRINT BUFFER  X02008*
         MVC   PRTBUFR+1(123),PRTBUFR                             0634
*  PRTBUFR(2:42)=RETMSG;                 /* MESSAGE INTO BUFFER X02008*
         MVC   PRTBUFR+1(41),RETMSG                               0635
*  R1=42;                                /* MESSAGE SIZE        X02008*
         LA    @1,42                                              0636
*  GEN(PWRT  SIZE=(1));                  /* PRINT MESSAGE       X02008*
         PWRT  SIZE=(1)
         DS    0H
*  IF RTAST=' ' THEN                     /* CHECK FOR TRACE     X02008*
         CLI   RETMSG+8,C' '                                      0638
*    RETURN;                             /* RETURN TO UTS       X02008*
         BC    08,@EL01                                           0639
*  GOTO TRA028;                          /* RETURN TO SCHEDULER X02008*
         BC    15,TRA028                                          0640
* TRA039:
*  SV1T8(1)='0F'X;                       /* INITIALIZE          X02008*
TRA039   MVI   A00071,X'0F'                                       0641
*  SV1T8(2:8)=SV1T8(1:7);                /* INITIALIZE          X02008*
         MVC   A00071+1(7),A00071                                 0642
*  SV2=R5&SV2;                           /* EVEN HEX CHARACTERS X02008*
         L     @F,A00071+4                                        0643
         NR    @F,@5                                              0643
         ST    @F,A00071+4                                        0643
*  R5=R5/16;                             /* SHIFT A HEX CHAR    X02008*
         LR    @E,@5                                              0644
         SRA   @E,4                                               0644
         LR    @5,@E                                              0644
*  SV1=R5&SV1;                           /* ODD HEX CHARACTERS  X02008*
         L     @F,A00071                                          0645
         NR    @F,@5                                              0645
         ST    @F,A00071                                          0645
*  R5=ADDR(SV1T8);                       /* SAVE AREA           X02008*
         LA    @5,A00071                                          0646
*  R6=ADDR(CLIST);                       /* LIST ADDRESS        X02008*
         LA    @6,CLIST                                           0647
*  R7=ADDR(RTLOC);                       /* RETURN LOCATION     X02008*
         LA    @7,RETMSG+27                                       0648
*  DO R4=4 TO 1 BY -1;                   /* CONVERT ROUTINE     X02008*
         LA    @4,4                                               0649
*    R8=R6+SV1C;                         /* CHARACTER ADDRESS   X02008*
@DO9B2   SR    @8,@8                                              0650
         IC    @8,0(0,@5)                                         0650
         AR    @8,@6                                              0650
*    RTLOC1=EBCD;                        /* CHARACTER TO PRINT  X02008*
         MVC   0(1,@7),0(@8)                                      0651
*    R8=R6+SV2C;                         /* CHARACTER ADDRESS   X02008*
         SR    @8,@8                                              0652
         IC    @8,4(0,@5)                                         0652
         AR    @8,@6                                              0652
*    RTLOC2=EBCD;                        /* CHARACTER TO PRINT  X02008*
         MVC   1(1,@7),0(@8)                                      0653
*    R7=ADDR(NXTRTL);                    /* NEXT LOCATION       X02008*
         LA    @7,2(0,@7)                                         0654
*    R5=ADDR(NXTSVC);                    /* NEXT CHARACTER      X02008*
         LA    @5,1(0,@5)                                         0655
*  END;                                  /* END ROUTINE         X02008*
*  GOTO R9;                              /* RETURN TO MAIN FLOW X02008*
         BCT   @4,@DO9B2                                          0656
         BCR   15,@9                                              0657
* END;
@EL01    L     @D,4(0,@D)                                         0658
         LM    @E,@C,12(@D)                                       0658
         BCR   15,@E                                              0658
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D1      DC    H'6'
@D2      DC    H'1'
@D3      DC    H'20'
@D4      DC    H'662'
@D5      DC    H'2'
@D6      DC    H'32'
         DS    0F
@C9      DC    C'40'
@C10     DC    C'47'
@C11     DC    C'08'
@C12     DC    C'39'
@C18     DC    C'26'
@C19     DC    C'46'
         DS    0D
@DATA    EQU   *
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD
X        EQU   00000000            FULLWORD INTEGER
R0       EQU   00000000            FULLWORD POINTER REGISTER
R1       EQU   00000001            FULLWORD POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD POINTER REGISTER
R4       EQU   00000004            FULLWORD POINTER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
R6       EQU   00000006            FULLWORD POINTER REGISTER
R7       EQU   00000007            FULLWORD POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
R9       EQU   00000009            FULLWORD POINTER REGISTER
R11      EQU   00000011            FULLWORD POINTER REGISTER
R12      EQU   00000012            FULLWORD POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
R15      EQU   00000015            FULLWORD POINTER REGISTER
         ORG   @DATA+00000072
COMADR   EQU   *                   FULLWORD POINTER
         DC    VL4(IFDOLT23)
OPFLG    EQU   00000048            8 BIT(S) ON BYTE
A00012   EQU   00000004            7 BYTE(S) ON WORD
RTNEXT   EQU   A00012+00000000     FULLWORD POINTER
RTNN     EQU   A00012+00000004     1 BYTE(S)
REFN     EQU   A00012+00000005     1 BYTE(S)
RFLG     EQU   A00012+00000006     8 BIT(S)
MIMK     EQU   A00012+00000006     1 BIT(S)
TERM     EQU   A00012+00000006     1 BIT(S)
A00013   EQU   A00012+00000006     1 BIT(S)
RTN      EQU   00000000            1 BYTE(S)
REFNUM   EQU   00000017            1 BYTE(S)
A00027   EQU   00000000            32 BYTE(S) ON WORD
RTN8     EQU   A00027+00000000     32*1 BYTE(S)
A00028   EQU   00000000            1 BYTE(S) ON WORD
RTNB     EQU   A00028+00000000     8 BIT(S)
RST15    EQU   00000016            FULLWORD POINTER
A00029   EQU   00000000            28 BYTE(S) ON WORD
A00030   EQU   A00029+00000000     FULLWORD INTEGER
CHNBK    EQU   A00029+00000004     FULLWORD POINTER
SR13     EQU   A00029+00000008     FULLWORD POINTER
SR14     EQU   A00029+00000012     FULLWORD POINTER
SR15     EQU   A00029+00000016     FULLWORD POINTER
SR0      EQU   A00029+00000020     FULLWORD POINTER
SR1      EQU   A00029+00000024     FULLWORD POINTER
A00031   EQU   A00029+00000024     FULLWORD POINTER
I        EQU   @DATA+00000076      FULLWORD INTEGER
A00032   EQU   I+00000000          3 BYTE(S)
I4       EQU   I+00000003          1 BYTE(S)
MCA      EQU   00000000            208 BYTE(S) ON WORD
MPRE     EQU   MCA+00000000        FULLWORD POINTER
MNXT     EQU   MCA+00000004        FULLWORD POINTER
MITEM    EQU   MCA+00000008        20*6 BYTE(S)
MNM      EQU   MCA+00000008        2 BYTE(S)
MNM1     EQU   MCA+00000008        1 BYTE(S)
MB1      EQU   MCA+00000008        1 BIT(S)
MB2      EQU   MCA+00000008        1 BIT(S)
A00033   EQU   MCA+00000008        5 BIT(S)
MB8      EQU   MCA+00000008        1 BIT(S)
MNM2     EQU   MCA+00000009        1 BYTE(S)
MNAM     EQU   MCA+00000010        2 BYTE(S)
MN1      EQU   MCA+00000010        1 BYTE(S)
MMSIZ    EQU   MCA+00000012        2 BYTE(S)
TITEM    EQU   MCA+00000128        20*FULLWORD POINTER
MCTADS   EQU   00000128            1 BYTE(S)
TADR     EQU   00000000            20*FULLWORD POINTER
BMCT18   EQU   @DATA+00000080      8 BIT(S) ON BYTE
BMCT12   EQU   BMCT18+00000000     2 BIT(S)
BMCT1    EQU   BMCT18+00000000     1 BIT(S)
BMCT2    EQU   BMCT18+00000000     1 BIT(S)
PLKBIT   EQU   BMCT18+00000000     1 BIT(S)
MOD8     EQU   BMCT18+00000000     1 BIT(S)
BMCT45   EQU   BMCT18+00000000     2 BIT(S)
BMCT4    EQU   BMCT18+00000000     1 BIT(S)
BMCT5    EQU   BMCT18+00000000     1 BIT(S)
MINMOR   EQU   BMCT18+00000000     1 BIT(S)
A00034   EQU   BMCT18+00000000     1 BIT(S)
SVR14    EQU   00000012            FULLWORD POINTER
SVR141   EQU   SVR14+00000000      1 BYTE(S)
SV15     EQU   00000016            FULLWORD POINTER
SVR3     EQU   00000032            FULLWORD POINTER
A00035   EQU   00000000            10 BYTE(S) ON WORD
PMW1     EQU   A00035+00000000     10 BYTE(S)
A00036   EQU   A00035+00000000     1 BYTE(S)
PLEV     EQU   A00035+00000001     1 BYTE(S)
PLID     EQU   A00035+00000002     2 BYTE(S)
A00037   EQU   A00035+00000002     1 BYTE(S)
MIRTNM   EQU   00000020            4 BYTE(S)
         ORG   @DATA+00000081
CLIST    EQU   *                   16 BYTE(S)
         DC    C'0123456789ABCDEF'
EBCD     EQU   00000000            1 BYTE(S)
RETMSG   EQU   *                   41 BYTE(S)
         DC    C'IFD450I * RTN XXX,ID YY,AT ZZZZZZZZ,RC WW'
A00038   EQU   RETMSG+00000000     8 BYTE(S)
RTAST    EQU   RETMSG+00000008     1 BYTE(S)
A00039   EQU   RETMSG+00000009     4 BYTE(S)
RTNM14   EQU   RETMSG+00000013     4 BYTE(S)
A00040   EQU   RETMSG+00000013     1 BYTE(S)
RTRTNM   EQU   RETMSG+00000014     3 BYTE(S)
A00041   EQU   RETMSG+00000017     4 BYTE(S)
RTMCID   EQU   RETMSG+00000021     2 BYTE(S)
A00042   EQU   RETMSG+00000023     4 BYTE(S)
RTLOC    EQU   RETMSG+00000027     8 BYTE(S)
A00043   EQU   RETMSG+00000035     4 BYTE(S)
RTTERM   EQU   RETMSG+00000039     2 BYTE(S)
A00044   EQU   00000000            8 BYTE(S)
RTLOC1   EQU   A00044+00000000     1 BYTE(S)
RTLOC2   EQU   A00044+00000001     1 BYTE(S)
NXTRTL   EQU   A00044+00000002     1 BYTE(S)
A00045   EQU   00000000            8 BYTE(S) ON WORD
TAB1     EQU   A00045+00000000     FULLWORD POINTER
TAB2     EQU   A00045+00000004     FULLWORD POINTER
A00046   EQU   00000000            10 BYTE(S) ON WORD
A00047   EQU   A00046+00000000     4 BYTE(S)
MIDOLD   EQU   A00046+00000004     2 BYTE(S)
MIDOLD1  EQU   A00046+00000004     1 BYTE(S)
MAC2     EQU   A00046+00000006     4 BYTE(S)
A00048   EQU   00000000            14 BYTE(S) ON WORD
A00049   EQU   A00048+00000000     2*FULLWORD POINTER
A00050   EQU   A00048+00000008     1 BYTE(S)
A00051   EQU   A00048+00000008     1 BIT(S)
ACTMD    EQU   A00048+00000008     1 BIT(S)
MBK1     EQU   A00048+00000009     1 BYTE(S)
MID1     EQU   A00048+00000010     2 BYTE(S)
MSZ1     EQU   A00048+00000012     2 BYTE(S)
MCT2     EQU   00000006            FULLWORD INTEGER
TMCOM    EQU   @DATA+00000140      94 BYTE(S) ON WORD
WKAREA   EQU   TMCOM+00000000      60 BYTE(S) ON WORD
         ORG   TMCOM+00000000
A00052   EQU   *                   HALFWORD INTEGER
         DC    FL2'1'
A00053   EQU   *                   HALFWORD INTEGER
         DC    FL2'56'
WITEM    EQU   TMCOM+00000004      32 BYTE(S)
WTOTNM   EQU   TMCOM+00000004      8 BYTE(S)
WNM      EQU   *                   6 BYTE(S)
         DC    C'IFDOLT'
WNAM     EQU   TMCOM+00000010      2 BYTE(S)
WTTRK    EQU   TMCOM+00000012      6 BYTE(S)
A00054   EQU   TMCOM+00000012      2 BYTE(S)
WR       EQU   TMCOM+00000014      1 BYTE(S)
A00055   EQU   TMCOM+00000018      11 BYTE(S)
WMSIZ    EQU   TMCOM+00000029      2 BYTE(S)
A00056   EQU   TMCOM+00000031      1 BYTE(S)
WK24     EQU   TMCOM+00000036      24 BYTE(S) ON WORD
GAVL     EQU   TMCOM+00000036      8 BYTE(S)
GSIZS    EQU   TMCOM+00000044      8 BYTE(S)
GAVL1    EQU   TMCOM+00000052      8 BYTE(S) ON WORD
         ORG   TMCOM+00000060
KNT      EQU   *                   8 BYTE(S)
         DC    C'IFDOLT  '
KNAME    EQU   TMCOM+00000060      6 BYTE(S)
KNMV     EQU   TMCOM+00000066      2 BYTE(S)
MODNN    EQU   *                   8 BYTE(S)
         DC    C'IFDOLT  '
MODNN6   EQU   TMCOM+00000068      6 BYTE(S)
BDEL     EQU   *                   FULLWORD INTEGER
         DC    FL4'1'
BIN      EQU   TMCOM+00000076      1 BYTE(S)
WK1BYT   EQU   TMCOM+00000077      1 BYTE(S)
BHB      EQU   TMCOM+00000078      1 BYTE(S)
BHLD     EQU   TMCOM+00000079      1 BYTE(S)
GTCOR    EQU   TMCOM+00000080      FULLWORD POINTER
SVPMW1   EQU   TMCOM+00000084      10 BYTE(S)
SVP1     EQU   TMCOM+00000084      2 BYTE(S)
P1BITS   EQU   TMCOM+00000084      8 BIT(S)
P1B0     EQU   TMCOM+00000084      1 BIT(S)
P1B1     EQU   TMCOM+00000084      1 BIT(S)
P1B23    EQU   TMCOM+00000084      2 BIT(S)
P1B2     EQU   TMCOM+00000084      1 BIT(S)
P1B3     EQU   TMCOM+00000084      1 BIT(S)
P1B4     EQU   TMCOM+00000084      1 BIT(S)
P1B5     EQU   TMCOM+00000084      1 BIT(S)
P1B6     EQU   TMCOM+00000084      1 BIT(S)
P1B7     EQU   TMCOM+00000084      1 BIT(S)
SVPL     EQU   TMCOM+00000085      1 BYTE(S)
SVP8     EQU   TMCOM+00000086      8 BYTE(S)
SVP2     EQU   TMCOM+00000086      2 BYTE(S)
NXMCT    EQU   00000004            FULLWORD POINTER
MCTAD1   EQU   00000128            FULLWORD POINTER
         ORG   @DATA+00000234
OLDMAC   EQU   *                   2 BYTE(S)
         DC    X'0102'
A00059   EQU   00000000            73 BYTE(S) ON WORD
A00060   EQU   A00059+00000000     13 BYTE(S)
WTOFORM  EQU   A00059+00000013     60 BYTE(S)
BLDLIST  EQU   00000000            4 BYTE(S) ON WORD
LENTCT   EQU   BLDLIST+00000000    HALFWORD INTEGER
LENTSZ   EQU   BLDLIST+00000002    HALFWORD INTEGER
A00061   EQU   @DATA+00000176      16 BYTE(S) ON WORD
AVADR    EQU   A00061+00000000     FULLWORD POINTER
AVSEZ    EQU   A00061+00000004     FULLWORD INTEGER
A00062   EQU   A00061+00000004     2 BYTE(S)
AVSIZ    EQU   A00061+00000006     2 BYTE(S)
LOSIZ    EQU   A00061+00000008     FULLWORD INTEGER
HHSIZ    EQU   A00061+00000012     FULLWORD INTEGER
HHSIZC   EQU   A00061+00000012     4 BYTE(S)
A00063   EQU   A00061+00000012     2 BYTE(S)
HISIZ    EQU   A00061+00000014     2 BYTE(S)
A00064   EQU   A00061+00000014     1 BYTE(S)
WK1PTR   EQU   @DATA+00000236      FULLWORD POINTER
SAVR8    EQU   @DATA+00000240      FULLWORD POINTER
A00065   EQU   @DATA+00000140      34 BYTE(S) ON WORD
A00066   EQU   A00065+00000000     5*FULLWORD POINTER
NMCT     EQU   A00065+00000020     14 BYTE(S)
NTADR    EQU   A00065+00000020     4  BYTE  POINTER
BLIST1   EQU   00000000            60 BYTE(S)
A00067   EQU   BLIST1+00000000     4 BYTE(S)
A00068   EQU   BLIST1+00000004     8 BYTE(S)
LNM2     EQU   BLIST1+00000004     6 BYTE(S)
LNAM2    EQU   BLIST1+00000010     2 BYTE(S)
LTTRK    EQU   BLIST1+00000012     6 BYTE(S)
A00069   EQU   BLIST1+00000012     2 BYTE(S)
LR       EQU   BLIST1+00000014     1 BYTE(S)
A00070   EQU   BLIST1+00000018     11 BYTE(S)
LSIZ     EQU   BLIST1+00000029     2 BYTE(S)
BLIST2   EQU   00000056            FULLWORD INTEGER
A00071   EQU   @DATA+00000152      8 BYTE(S) ON WORD
SV1T8    EQU   A00071+00000000     8 BYTE(S)
SV1      EQU   A00071+00000000     4  BYTE  INTEGER
SV2      EQU   A00071+00000004     4  BYTE  INTEGER
A00072   EQU   A00071+00000004     1 BYTE(S)
A00073   EQU   00000000            5 BYTE(S) ON WORD
SV1C     EQU   A00073+00000000     1 BYTE(S)
NXTSVC   EQU   A00073+00000001     3 BYTE(S)
SV2C     EQU   A00073+00000004     1 BYTE(S)
MDMASK   EQU   00000000            1 BYTE(S)
A00074   EQU   00000000            84 BYTE(S) ON WORD
A00075   EQU   A00074+00000000     17*FULLWORD POINTER
A00076   EQU   A00074+00000068     FULLWORD POINTER
A00077   EQU   A00074+00000068     2 BYTE(S)
RTMASK   EQU   A00074+00000070     1 BYTE(S)
A00078   EQU   A00074+00000072     2*FULLWORD POINTER
SCTW20   EQU   A00074+00000080     FULLWORD POINTER
A00079   EQU   A00074+00000080     FULLWORD POINTER
         ORG   @DATA+00000244
UTRET    EQU   *                   FULLWORD POINTER
         DC    AL4(0)
BRID     EQU   @DATA+00000248      2 BYTE(S)
BRID1    EQU   BRID+00000000       1 BYTE(S)
BRIDB14  EQU   BRID+00000000       4 BIT(S)
LIST     EQU   @DATA+00000250      9 BYTE(S)
RR       EQU   LIST+00000000       1 BYTE(S)
         ORG   LIST+00000001
MASK     EQU   *                   8*1 BYTE(S)
         DC    X'80'
         DC    X'40'
         DC    X'20'
         DC    X'10'
         DC    X'08'
         DC    X'04'
         DC    X'02'
         DC    X'01'
A00080   EQU   00000000            152 BYTE(S) ON WORD
A00081   EQU   A00080+00000000     14*FULLWORD POINTER
IFD160   EQU   A00080+00000056     FULLWORD POINTER
A00082   EQU   A00080+00000060     FULLWORD POINTER
IFD210   EQU   A00080+00000064     FULLWORD POINTER
A00083   EQU   A00080+00000068     FULLWORD POINTER
IFD168   EQU   A00080+00000072     FULLWORD POINTER
A00084   EQU   A00080+00000076     18*FULLWORD POINTER
IFD229   EQU   A00080+00000148     FULLWORD POINTER
A00085   EQU   A00080+00000148     FULLWORD POINTER
A00086   EQU   00000000            8 BYTE(S) ON WORD
LENGTH   EQU   A00086+00000000     1 BYTE(S)
BUFAD    EQU   A00086+00000001     3  BYTE  POINTER ON WORD+1
MECBAD   EQU   A00086+00000004     FULLWORD POINTER
A00091   EQU   @DATA+00000260      80 BYTE(S) ON WORD
SVDYN    EQU   A00091+00000000     18*FULLWORD POINTER
SVT13    EQU   A00091+00000072     FULLWORD POINTER
SVU13    EQU   A00091+00000076     FULLWORD POINTER
A00092   EQU   A00091+00000076     FULLWORD POINTER
DEDBUF   EQU   00000000            72 BYTE(S)
         ORG   @DATA+00000340
RTALKID  EQU   *                   8 BYTE(S)
         DC    C'IFD255I '
         ENTRY TRA130
         ORG   @DATA
         DS    00000352C
@TEMPS   DS    0F
@TEMP2   DC    F'0'
DSECT18  IFDCOM
IFDOLT18 CSECT
LGWRTFLD EQU   LGWRTCT-00000004    FULLWORD POINTER
A00000   EQU   CESWT2+00000000     8 BIT(S) ON BYTE
NDCFO    EQU   A00000+00000000     1 BIT(S)
PLKMRB   EQU   A00000+00000000     1 BIT(S)
FECOND   EQU   A00000+00000000     1 BIT(S)
A00001   EQU   A00000+00000000     1 BIT(S)
A00002   EQU   CESWT3+00000000     1 BYTE(S)
A00003   EQU   A00002+00000000     3 BIT(S)
GRBCTL   EQU   A00002+00000000     1 BIT(S)
SUSDEL   EQU   A00002+00000000     1 BIT(S)
A00004   EQU   A00002+00000000     1 BIT(S)
A00005   EQU   CESWT6+00000000     8 BIT(S) ON BYTE
UTSCAL   EQU   A00005+00000000     1 BIT(S)
A00006   EQU   PARTITEM+00000000   8 BYTE(S) ON WORD
PARADR   EQU   A00006+00000000     FULLWORD POINTER
PARSZ    EQU   A00006+00000004     FULLWORD INTEGER
A00007   EQU   A00006+00000004     1 BYTE(S)
A00008   EQU   HRTSEL+00000000     2 BYTE(S) ON WORD
TERTN    EQU   A00008+00000000     1 BYTE(S)
HIRTN    EQU   A00008+00000001     1 BYTE(S)
A00009   EQU   OLTTAB+00000000     40 BYTE(S) ON WORD
A00010   EQU   A00009+00000000     8*FULLWORD POINTER
TMCOMAD  EQU   A00009+00000032     FULLWORD POINTER
SECPRF   EQU   A00009+00000036     FULLWORD POINTER
A00011   EQU   A00009+00000036     FULLWORD POINTER
A00014   EQU   CHASCT+00000000     52 BYTE(S) ON WORD
SCTW0    EQU   A00014+00000000     FULLWORD INTEGER
A00015   EQU   A00014+00000000     2 BYTE(S)
A00016   EQU   A00014+00000002     8 BIT(S)
A00017   EQU   A00014+00000002     5 BIT(S)
NPR      EQU   A00014+00000002     1 BIT(S)
A00018   EQU   A00014+00000003     8 BIT(S)
ERBT     EQU   A00014+00000003     1 BIT(S)
ASTERB   EQU   A00014+00000003     1 BIT(S)
CATB1    EQU   A00014+00000003     1 BIT(S)
A00019   EQU   A00014+00000003     3 BIT(S)
ERLOP    EQU   A00014+00000003     1 BIT(S)
SCTW1    EQU   A00014+00000004     FULLWORD INTEGER
SCTW2    EQU   A00014+00000008     FULLWORD INTEGER
SCTW3    EQU   A00014+00000012     FULLWORD INTEGER
SCTW4    EQU   A00014+00000016     FULLWORD INTEGER
SCTW5    EQU   A00014+00000020     FULLWORD INTEGER
SCTW6    EQU   A00014+00000024     FULLWORD INTEGER
SCTW7    EQU   A00014+00000028     FULLWORD INTEGER
SCTW8    EQU   A00014+00000032     FULLWORD INTEGER
A00020   EQU   A00014+00000032     1 BYTE(S)
A00021   EQU   A00014+00000033     8 BIT(S)
A00022   EQU   A00014+00000033     5 BIT(S)
CLEANUP  EQU   A00014+00000033     1 BIT(S)
SCTW82   EQU   A00014+00000034     HALFWORD INTEGER
SCTW9    EQU   A00014+00000036     FULLWORD INTEGER
A00023   EQU   A00014+00000036     8 BIT(S)
MIBT     EQU   A00014+00000036     1 BIT(S)
CLEANRT  EQU   A00014+00000036     1 BIT(S)
A00024   EQU   A00014+00000036     2 BIT(S)
RETCODE  EQU   A00014+00000036     1 BIT(S)
TRACE    EQU   A00014+00000036     1 BIT(S)
A00025   EQU   A00014+00000037     1 BYTE(S)
SCTW9C   EQU   A00014+00000038     2 BYTE(S)
SCTW10   EQU   A00014+00000040     FULLWORD INTEGER
A00026   EQU   A00014+00000044     2*FULLWORD POINTER
RID      EQU   MCT+00000009        1 BYTE(S)
VID      EQU   WKSVC+00000002      2 BYTE(S)
A00057   EQU   MCT+00000128        80 BYTE(S) ON WORD
RTADR1   EQU   A00057+00000000     FULLWORD POINTER
TMADR1   EQU   A00057+00000004     FULLWORD POINTER
A00058   EQU   A00057+00000008     18*FULLWORD POINTER
A00087   EQU   ECB3+00000000       1 BYTE(S) ON WORD
A00088   EQU   A00087+00000000     1 BYTE(S)
A00089   EQU   A00087+00000000     1 BIT(S)
ECB3POST EQU   A00087+00000000     1 BIT(S)
A00090   EQU   TRA000-00000012     208 BYTE(S) ON WORD
MCTTWO   EQU   A00090+00000000     208 BYTE(S)
FSTMCT   EQU   A00090+00000000     4  BYTE  POINTER
RMCT2    EQU   A00090+00000004     204 BYTE(S)
A00093   EQU   CESWTR+00000000     1 BYTE(S)
A00094   EQU   A00093+00000000     1 BIT(S)
REMERR   EQU   A00093+00000000     1 BIT(S)
REMNOMSG EQU   A00093+00000000     1 BIT(S)
CENOMSG  EQU   A00093+00000000     1 BIT(S)
TRANSMSG EQU   A00093+00000000     1 BIT(S)
A00095   EQU   A00093+00000000     1 BIT(S)
A00096   EQU   A00093+00000000     2 BIT(S)
A00097   EQU   CESWTR1+00000000    1 BYTE(S)
ILLRESP  EQU   A00097+00000000     1 BIT(S)
EXECANS  EQU   A00097+00000000     1 BIT(S)
A00098   EQU   A00097+00000000     2 BIT(S)
RETRIEVE EQU   A00097+00000000     1 BIT(S)
REMANS   EQU   A00097+00000000     1 BIT(S)
A00099   EQU   A00097+00000000     2 BIT(S)
A00100   EQU   CESWTR2+00000000    1 BYTE(S)
A00101   EQU   A00100+00000000     2 BIT(S)
ONCOMM   EQU   A00100+00000000     1 BIT(S)
RECOMM   EQU   A00100+00000000     1 BIT(S)
A00102   EQU   A00100+00000000     4 BIT(S)
A00103   EQU   TALKECB+00000000    1 BYTE(S) ON WORD
A00104   EQU   A00103+00000000     1 BYTE(S)
A00105   EQU   A00103+00000000     1 BIT(S)
TALKPOST EQU   A00103+00000000     1 BIT(S)
A00106   EQU   REIECB+00000000     1 BYTE(S) ON WORD
A00107   EQU   A00106+00000000     1 BYTE(S)
A00108   EQU   A00106+00000000     1 BIT(S)
REIPOST  EQU   A00106+00000000     1 BIT(S)
TALKID   EQU   PRTBUFR+00000001    8 BYTE(S)
RPTBUF   EQU   PRTBUFR+00000009    115 BYTE(S)
@DATEND  EQU   *
@9ED     EQU   @EL01
@9EC     EQU   TRA002B
@9EB     EQU   TRA002B
@9E0     EQU   TRA006
@9E1     EQU   TRA006
@9D9     EQU   TRA018
@9C0     EQU   TRA025
@9B7     EQU   @EL01
@9B3     EQU   TRA028
         END

         TITLE ' RESIDENT DEVICE AND TEST SCHEDULER.  IFDOLT48'
         TITLE ' RESIDENT DEVICE AND TEST SCHEDULER.  IFDOLT48'
         LCLA  &T,&SPN                                            0002
.@001    ANOP                                                     0002
IFDOLT48 CSECT ,                                                  0002
         BC    15,24(0,@F)
         DC    C'IFDOLT48 01 JUN 76'                             0002
         STM   @E,@C,12(@D)                                       0002
         BALR  @B,0                                               0002
@PSTART  DS    0H                                                 0002
         USING @PSTART+00000,@B                                   0002
         ST    @D,@SAV001+4                                       0002
         LA    @F,@SAV001                                         0002
         ST    @F,8(0,@D)                                         0002
         LR    @D,@F                                              0002
*  GEN(USING CHASCT,2);                  /* COMMON AREA BASE REGISTER *
         USING CHASCT,2
         DS    0H
* GENERATE DATA;
*  RESTRICT(2,3,4,5,6,7,8,9);             /* RESTRICT REG USAGE S21937*
*  DCL R0 REG(0) PTR;
*  DCL R1 REG(1) PTR;
*  DCL R2 REG(2) PTR;
*  DCL R3 REG(3) PTR;
*  DCL R4 REG(4) PTR;
*  DCL R5 REG(5) PTR;
*  DCL R6 REG(6) PTR;
*  DCL R7 REG(7) PTR;
*  DCL R8 REG(8) PTR;
*  DCL R9 REG(9) PTR;
*  DCL R10 REG(10) PTR;
*  DCL R11 REG(11) PTR;
*  DCL R12 REG(12) PTR;
*  DCL R13 REG(13) PTR;
*  DCL R14 REG(14) PTR;
*  DCL R15 REG(15) PTR;
*  DCL SECDVPTR PTR GENERATED;           /* LAST GRAB DEVICE */
*  DCL REPBUF EXT ENTRY;                 /* REPLY BUFFER */
*  DCL CESWT4 GENERATED;                 /* OLTEP SWITCHES */
*  DCL CE46 CHAR(3) BASED(ADDR(CESWT4)); /* OLTEP SWITCHES */
*  DCL MSGMOD PTR GENERATED;             /* MESSAGE MODULE */
*  DCL DATPTR PTR GENERATED;             /* DATA PROTECT ROOT MODULE */
*  DCL CHASCT CHAR(88) GENERATED;        /* SECTION CONTROL TABLE */
*  DCL PRIDVPTR PTR GENERATED;           /* PRIME DEVICE TABLE */
*  DCL DEVDEPAD PTR GENERATED;           /* DEVICE ADDRESS */
*  DCL REGX PTR GENERATED;               /* POINTER TO UCB ADDRESS */
*  DCL UTCOM CHAR(64) GENERATED;         /* PASSON AREA */
*  DCL INBUFR CHAR(72) GENERATED;        /* INPUT OR OUTPUT BUFFER */
*  DCL PSCT GENERATED;                   /* SECTION CONTROL TABLE */
*  DCL SCHEDSA PTR GENERATED;            /* SAVE AREA ADDRESS */
*  DCL DEVTBPTR PTR GENERATED;           /* DEVICE TABLE ADDRESS      *
*  DCL TABLNGTH FIXED(15) GENERATED;     /* DEVICE TABLE LENGTH       *
*  DCL SECLST CHAR(10) GENERATED;        /* SECTION LIST */
*  DCL ECB37 FIXED GENERATED;            /* CECOM ECB */
*  DCL TAB28 PTR GENERATED;              /* NEW MACRO ENTRY POINT */
*  DCL OLTTAB PTR GENERATED;             /* LINK TABLE */
*  DCL LOGADR PTR GENERATED;             /* LOGSCAN MODULE ADDRESS */
*  DCL SECTUSE CHAR(1) GENERATED;        /* NUMBER OF SECTIONS RUN */
*  DCL UNICTR CHAR(1) GENERATED;         /* NUMBER OF DEVICES TO RUN */
*  DCL UNITUSE CHAR(1) GENERATED;        /* NUMBER OF DEVICES RUN */
*  DCL PLKMOR PTR GENERATED;             /* FIRST PLINKED MODULE */
*  DCL DATIND GENERATED;                 /* PARAMETER LIST FOR OLTEP */
*  DCL SECPTR PTR GENERATED;             /* ACTIVE SECTION ENTRY */
*  DCL UTENT PTR GENERATED;              /* FIRST UTS INSTRUCTION */
*  DCL CESWT CHAR(5) GENERATED;
*  DCL PRTBUFR CHAR(120) GENERATED;      /* PRINT BUFFER */
*  DCL TLCOUNT FIXED(15) GENERATED;      /* TEST LOOP COUNT */
*  DCL WKSVC GENERATED;                  /* SVC WORK AREA */
*  DCL MCT GENERATED;                    /* MODULE CONTROL TABLE */
*  DCL ROPT GENERATED;                   /* SVC AREA */
*  DCL EXPAND1 GENERATED;
*  DCL PARTITEM CHAR(12) GENERATED;      /* PARTITION ITEMS     X02008*
*  DCL 1 * BDY(WORD) BASED(ADDR(PARTITEM)), /* PARTITION ITEMS  X02008*
*         2 PARADR PTR,                  /* OLTS AREA ADDRESS   X02008*
*         2 PARSZ FIXED,                 /* OLTS TOTAL WORK AREAX02008*
*         2 RTPLKSZ FIXED,               /* ROOT AND PLINK SIZE X02008*
*           3 DBLZ CHAR(2),              /* DOUBLE ZERO         X02008*
*           3 UTSIZ CHAR(2),             /* UTS SIZE            X02008*
*             5 * CHAR(1),               /* NA                  X02008*
*             5 * BIT(8),                /* NA                  X02008*
*              6 * BIT(5),               /* NA                  X02008*
*              6 TRPBITS BIT(3),         /* LAST THREE BITS     X02008*
*               7 * BIT(2),              /* NA                  X02008*
*               7 CLRBIT BIT(1),         /* OLD UTS INDICATOR   X02008*
*                 9 * BIT(1);            /* NA                  X02008*
*  DCL HRTSEL CHAR(2) GENERATED;         /* HIGHEST ROUTINE BYTES */
*  DCL 1 * BASED(ADDR(HRTSEL)),          /* HIGHEST ROUTINE BYTES */
*         2 TERTN CHAR(1),               /* LAST ROUTINE IN UTS */
*         2 HIRTN CHAR(1);               /* HIGHEST ROUTINE SELECTED */
*  DCL VID CHAR(2) BASED(ADDR(WKSVC)+2); /* MODULE ID FOR SVC USE */
*  DCL MID1 CHAR(2) BASED(ADDR(MCT)+10); /* OLTEP MODULE ID */
*  DCL HCODE CHAR(1) BASED(132);         /* HCODE EQUATED */
*  DCL 1 * BDY(WORD) BASED(R5+16),       /* WORK AREA */
*         2 WKBY FIXED,                  /* WORK WORD */
*           3 * CHAR(2),                 /* BYTE ALIGNMENT */
*           3 WKBY34 CHAR(2);            /* WORK BYTES */
*  DCL 1 * BASED(MSGMOD),                /* MESSAGE MODULE */
*         2 IFD100 PTR,                  /* IFD100 MESSAGE PTR  S21937*
*         2 *(5) PTR,                    /* NA                  S21937*
*         2 IFD117 PTR,                  /* POINTER TO IFD117 MESSAGE *
*         2 IFD121 PTR,                  /* POINTER TO IFD121 MESSAGE *
*         2 * PTR,                       /* NA */
*         2 IFD135 PTR,                  /* POINTER TO IFD135 MESSAGE *
*         2 IFD501 PTR,                  /* IFD501 MESSAGE PTR  S21937*
*         2 * PTR,                       /* NA */
*         2 IFD158 PTR,                  /* POINTER TO IFD158 MESSAGE *
*         2 IFD201 PTR,                  /* PTR TO MESSAGE      X02008*
*         2 *(6) PTR,                    /* NA                  X02008*
*         2 IFD231 PTR,                  /* PTR TO MESSAGE      X02008*
*         2 IFD313 PTR,                  /* PTR TO MESSAGE      X02008*
*         2 IFD502 PTR,                  /* PTR TO MESSAGE      X02008*
*         2 IFD503 PTR,                  /* PTR TO MESSAGE      X02008*
*         2 IFD200 PTR,                  /* PTR TO MESSAGE      X02008*
*         2 *(10) PTR,                   /* NA                  Y02008*
*         2 IFD248 PTR,                  /* PTR TO MSG IFD248I  Y02008*
*           3 * PTR;                     /* LAST POINTER */
*  DCL IFD227 PTR BASED(MSGMOD+68);      /* IFD227 MSG PTR      X02008*
*  DCL 1 * BASED(IFD227),                /* IFD227 MESSAGE      X02008*
*         2 * CHAR(37),                  /* NA                  X02008*
*         2 UT227 CHAR(8);               /* UNIT TEST NAME      X02008*
*  DCL SECLEV CHAR(1) BASED(R3+11);      /* SCT LEVEL OF OLTS   X02008*
*  DCL 1 * BASED(IFD100),                /* IFD100 MESSAGE      S21937*
*         2 * CHAR(4),                   /* NA                  S21937*
*         2 MSG100A CHAR(78),            /* MESSAGE TEXT        S21937*
*           3 * CHAR(8),                 /* NA                  S21937*
*           3 MSG100 CHAR(70);           /* MESSAGE LESS ID     S21937*
*  DCL 1 SVR8 FIXED,                     /* SAVE AREA           X02008*
*         2 * CHAR(2),                   /* NA                  X02008*
*         2 SVR834 CHAR(2),              /* LAST HALF WORD      X02008*
*           3 * CHAR(1),                 /* NA                  X02008*
*           3 SVR84 CHAR(1);             /* LOW ORDER BYTE      X02008*
*  DCL RETCODE FIXED INIT(0);            /* RETURN CODE */
*  DCL TLRUN FIXED(15) BASED(ADDR(TLCOUNT)+6); /* TEST LOOP RUN S21937*
*  DCL INBF1 CHAR(1) BASED(ADDR(INBUFR)); /* FIRST BUFFER CHARACTER */
*  DCL 1 * BASED(ADDR(OLTTAB)),          /* LINK TABLE */
*         2 *(8) PTR,                    /* ENTRY POINTS FOR MACROS */
*         2 TMCOMAD PTR,                 /* TRANSIENT MANAGER AREA */
*         2 SECPRF PTR,                  /* SECTION PREFACE ADDRESS */
*           3 * PTR;                     /* LAST POINTER */
*  DCL 1 WK1TO8 CHAR(8) BASED(R5+4),     /* WORK AREA */
*         2 WK1TO4 CHAR(4),              /* FIRST WORD IN AREA */
*         2 WK5TO8 CHAR(4);              /* SECOND WORD IN AREA */
*  DCL 1 * BDY(WORD) BASED(R4),          /* MODULE ADDRESS */
*         2 INZNM CHAR(8),               /* MODULE NAME */
*         2 INZLV CHAR(2),               /* MACRO LEVEL */
*         2 INZRT FIXED(15),             /* DISPLACEMENT TO ROUTINE */
*         2 INZIN PTR,                   /* FIRST INSTRUCTION ADDRESS *
*           3 * CHAR(1);                 /* ITEM IN STRUCTURE */
*  DCL 1 WANTDONT CHAR(8) BASED(R3+1),   /* MASK FOR DESCRIPTS */
*         2 WANT CHAR(4),                /* BITS THAT MUST BE SET */
*         2 DONTWANT CHAR(4),            /* BITS THAT MUST NOT BE SET *
*             9 * CHAR(1);               /* NA                  X02008*
*  DCL 1 * BDY(WORD) BASED(R3+20),       /* NA                  X02008*
*         2 RTSIZ FIXED,                 /* ROOT AND PLINK SIZE X02008*
*         2 MOSIZ FIXED,                 /* MORECORE SIZE       X02008*
*           3 * CHAR(1);                 /* ITEM IN STRUCTURE */
*  DCL 1 * BDY(WORD) BASED(R4),          /* MODULE ADDRESS */
*         2 *(19) PTR,                   /* BRANCH AND SAVE AREA */
*         2 SECID CHAR(8),               /* OLD UTS NAME */
*         2 RTMSK CHAR(2);               /* ROUTINE */
*  DCL 1 * BASED(R4),                    /* MESSAGE ADDRESS */
*         2 * CHAR(13),                  /* WTO MESSAGE */
*         2 WTO12 CHAR(2),               /* CHARACTERS TO MODIFY */
*           3 WTO1 CHAR(1),              /* CHARACTER TO MODIFY */
*         2 * CHAR(1),                   /* BLANK CHARACTER */
*         2 MSGTEST CHAR(8),             /* TEST SECTION */
*           3 * CHAR(7),                 /* NA                        *
*           3 OLDTEST CHAR(1),           /* OLD UTS                   *
*         2 BLKUNIT CHAR(26),            /* UNIT MESSAGE        Y02008*
*           3 * CHAR(1),                 /* BLANK CHARACTER */
*           3 MSGUNIT CHAR(22),          /* UNIT DEVICE AND SYM       *
*             4 KUNIT CHAR(4),           /* UNIT LABEL */
*             4 * CHAR(1),               /* BLANK CHARACTER */
*             4 MSGDEV CHAR(8),
*             4 * CHAR(1),               /* NA                        *
*             4 MSGSYB CHAR(8),          /* SYMBOLIC NAME             *
*           3 * CHAR(3),                 /* BLANK WITH V=       Y02008*
*           3 MSGVR CHAR(1),             /* V OR R - HOW OLT IS Y02008*
*                                        /* BEING RUN           Y02008*
*           3 MPCPUID CHAR(9),           /* BLANK FOLLOWED BY   Y02008*
*                                        /* CPUID=              Y02008*
*             5 * CHAR(7),               /* BLANK FOLLOWED BY   Y02008*
*                                        /* CPUID=              Y02008*
*             5 MSGCPUID CHAR(2),        /* CPU ID, EITHER 00   Y02008*
*                                        /* OR 01               Y02008*
*         2 * CHAR(1);                   /* LAST CHARACTER */
*  DCL 1 * BASED(ADDR(PLKMOR)),          /* PLINK AND MORECORE AREA */
*         2 ZIP16 CHAR(16),              /* PLINK MORECORE POINTER */
*           3 * CHAR(8),                 /* NA                  X02008*
*           3 ZIP8 CHAR(8);              /* PLINK POINTERS */
*  DCL 1 TMWK BASED(TMCOMAD),            /* TRANSIENT MGR WORK AREA */
*         2 * CHAR(36),                  /* NA */
*         2 KNT CHAR(8),                 /* OLTEP MODULE NAME */
*           3 KNAME CHAR(6),             /* COMMON PART MODULE NAME */
*         2 MODNN CHAR(8),               /* NON OLTEP MODULE NAME */
*           3 MODNN6 CHAR(6),            /* FIRST SIX LETTERS OF NAME *
*         2 * CHAR(4),                   /* NA */
*         2 GTCOR PTR;                   /* OBTAINED CORE ADDRESS */
*  DCL 1 * BASED(R8),                    /* DEVICES TO TEST */
*         2 * CHAR(56),                  /* ACTIVE DEVICE TABLE       *
*           3 DVEBC CHAR(8),
*           3 DVUCB PTR,                 /* UCB ADDRESS               *
*           3 * BIT(8),                  /* FLAGS */
*             4 * BIT(1),                /* ALIGNMENT BIT */
*             4 PRIMBIT BIT(1),          /* PRIMARY DEVICE BIT */
*             4 * BIT(1),                /* NA                 SA51754*
*             4 EXIOACT BIT(1),          /* EXIO ACTIVE        SA51754*
*             4 * BIT(1),                /* NA                 SA51754*
*             4 GRABIT BIT(1),           /* GRAB BIT */
*             4 * BIT(1),                /* NA                @Y30LPAW*
*             4 SYMBSSID BIT(1),         /* SSID IN SYMB FLD  @Y30LPAW*
*           3 * CHAR(19),                /* FLAGS AND DATA            *
*             4 * BIT(8),                /* NA                 SA51755*
*             5 * BIT(1),                /* NA                  X02008*
*             5 LETGOB BIT(1),           /* LETGO BIT           X02008*
*               5 CEVOL BIT(1),          /* CE PACK            SA51755*
*             3 DVTABCDS CHAR(20),
*               5 DVADR CHAR(4),
*               5 DVCDS CHAR(4),
*             5 * CHAR(1),
*             5 CDSFLAG CHAR(1),
*               7 * BIT(4),              /* NA                 SA51754*
*               7 SYMBIT BIT(1),         /* SYMBOLIC NAME      SA51754*
*             5 * BIT(8),                /* NA                  X02008*
*               7 * BIT(1),              /* NA                  X02008*
*               7 SKIPRIM BIT(1),        /* SKIP PRIMARY DEVICE X02008*
*             5 * CHAR(1),               /* NA                  X02008*
*               5 SYMNAME CHAR(8);
*  DCL 1 * BASED(DVUCB),                 /* UCB MAP                   *
*         2 *(4) FIXED,                  /* NA                        *
*         2 DVUDD CHAR(4);               /* DEVICE DESCRIPTORS        *
*  DCL DCNT1 CHAR(1) BASED(ADDR(UNITUSE)); /* DEVICES RUN */
*  DCL DCNT2 CHAR(1) BASED(ADDR(UNICTR)); /* DEVICES TO RUN */
*  DCL SCNT1 CHAR(1) BASED(ADDR(SECTUSE)); /* SECTIONS RUN */
*  DCL 1 PARM12 CHAR(12) BDY(WORD),      /* LIST FOR LOADER     X02008*
*         2 BNAME CHAR(8),               /* SECTION NAME        X02008*
*           3 BNAMCM CHAR(5),            /* SECTION TYPE        X02008*
*           3 BNAMVR CHAR(3),            /* SECTION VARIABLE    X02008*
*         2 TARGADR FIXED,               /* TARGET ADDRESS      X02008*
*         2 * FIXED INIT(0),             /* NA                  X02008*
*           3 FUNC12 CHAR(1),            /* LOADER FUNCTION     X02008*
*             5 * BIT(1),                /* NA                  X02008*
*             5 COMPUTB BIT(1),          /* COMPUTE SIZE        X02008*
*             5 * BIT(1),                /* NA                  X02008*
*             5 UTSENVL BIT(1),          /* UTS ENVOLVED        X02008*
*        9 * CHAR(1);                    /* NA                  X02008*
*  DCL 1 LDLIST BDY(WORD),
*         2 * FIXED(15) INIT(2),
*         2 * CHAR(2) INIT('12'),
*         2 * PTR INIT(ADDR(PARM12));    /* LOADER LIST         X02008*
*  DCL 1 UTSPL BASED(ADDR(PARM12)),      /* LIST FOR LOADER     X02008*
*         2 PLNAM CHAR(8),               /* SECTION NAME */
*           3 * CHAR(1),                 /* FIRST CHARACTER IN NAME */
*           4 PLNM15 CHAR(5),            /* FIRST PART OF NAME */
*           4 PLNM68 CHAR(3),            /* REST OF NAME */
*           3 PLSNM CHAR(6),             /* VARIABLE IN NAME */
*             4 PLTYPE CHAR(4),          /* DEVICE TYPE */
*             4 PLNAM6 CHAR(2),          /* SPECIAL TEST */
*           3 * CHAR(1);                 /* LAST CHARACTER */
*  DCL 1 * BASED(ADDR(SECLST)),          /* SECTION LIST */
*         2 * CHAR(1),                   /* FIRST CHARACTER IN LIST */
*         2 SCNT2 CHAR(1),               /* COUNT OF SECTIONS TO RUN */
*         2 SNAM CHAR(5),                /* TYPE OF SECTION */
*           3 * CHAR(1),                 /* PREFIX LETTER */
*           3 STYPEN CHAR(4),            /* SECTION TYPE NUMBER */
*         2 SNAMST CHAR(5);              /* FIRST SECTION ENTRY */
*  DCL 1 * BASED(R9),                    /* SECTION TO RUN */
*         2 SNAM1 CHAR(3),               /* ACTIVE SECTION */
*         2 SLNG1 CHAR(2),               /* ACTIVE SECTION LENGTH */
*           3 * CHAR(1),                 /* BYTE ALIGNMENT */
*           3 * BIT(8),                  /* BYTE OF BITS */
*             4 * BIT(5),                /* NA                  X02008*
*             4 DBLBIT BIT(2),           /* BITS 5 AND 6        X02008*
*             4 OLDUT BIT(1),            /* OLD UTS */
*         2 SNAM2 CHAR(3);               /* NEXT SECTION */
*  DCL 1 * BASED(ADDR(CHASCT)),          /* SECTION CONTROL TABLE */
*         2 * CHAR(8),                   /* TWO WORDS OF DATA */
*           3 ERRLPCT CHAR(2),           /* EL COUNT           SA51757*
*           3 * BIT(8),                  /* BYTE OF BITS */
*             4 * BIT(5),                /* NA */
*             4 NPR BIT(1),              /* NO PRINT INDICATOR */
*             4 INDEFLP BIT(1),          /* INDEFINITE LOOP     X02008*
*             4 FECOM BIT(1),            /* 1ST ERROR COMMUNICATION */
*           3 * BIT(8),                  /* BYTE OF BITS */
*             4 SCTASTER BIT(2),         /* ERROR INDICATORS */
*               5 SCTERB BIT(1),         /* UNIT TEST IN ERROR */
*               5 ASTERB BIT(1),         /* ASTERISK INDICATES ERROR */
*             4 CATB1 BIT(1),            /* CATASTROPHIC BIT */
*             4 AP BIT(1),               /* ALTERNATE PRINT */
*             4 NCP BIT(1),              /* NO CONTROL PRINT */
*             4 NEP BIT(1),              /* NO ERROR PRINT */
*             4 ERLOP BIT(1),            /* ERROR LOOP */
*             4 TSLOP BIT(1),            /* TEST LOOP */
*           3 * CHAR(3),                 /* NA                  X02008*
*           3 SCTLEV CHAR(1),            /* SCT LEVEL           X02008*
*         2 DVSEC1 CHAR(2),              /* PRIME DEVICE SECTION */
*         2 PDFLG CHAR(2),               /* PRIME DEVICE FLAGS */
*           3 * BIT(8),                  /* NA                 SA51755*
*           3 * BIT(8),                  /* NA                 SA51755*
*             4 * BIT(2),                /* NA                 SA51755*
*             4 CEVOLUM BIT(1),          /* CE VOLUME          SA51755*
*         2 PDPAD1 CHAR(8),
*           3 PDPA1 CHAR(4),
*           3 PDDD1 CHAR(4),             /* PRIME DEVICE DESCRIPTS */
*             4 * CHAR(2),               /* BYTE ALIGNMENT */
*             4 DCLAS CHAR(1),           /* DEVICE CLASS */
*         2 DVSEC2 CHAR(2),              /* SECONDARY DEVICE SECTION */
*         2 * CHAR(2),
*         2 PDPAD2 CHAR(8),
*           3 PDPA2 CHAR(4),
*           3 PDDD2 CHAR(4),             /* SEC DEVICE DESCRIPTS */
*         2 * CHAR(1),                   /* BYTE ALIGNMENT */
*         2 * BIT(8),                    /* BYTE OF BITS */
*           3 * BIT(3),                  /* NA                 SA51757*
*           3 ERRCNT BIT(1),             /* EL COUNT IN OPTION SA51757*
*           3 ONEPRIM BIT(1),            /* ONE PRIME DEVICE ONLY */
*           3 CLEANUP BIT(1),            /* UTS CLEANING UP           *
*         2 * CHAR(2),                   /* NA                        *
*         2 * BIT(8),                    /* NA                        *
*           3 * BIT(1),                  /* NA                        *
*           3 CLEANRT BIT(1),            /* UTS HAS CLEANUP           *
*           3 * BIT(4),                  /* NA                   M1463*
*           3 LASTSEC BIT(1),            /* LAST SECTION RUNNING M1463*
*          3 DYCOM BIT(1),               /* OLT CAN HANDLE DYN  X02008*
*        2 * BIT(8),                     /* FLAGS               X02008*
*          3 TALKFLAG BIT(1),            /* CE WANTS TALK       X02008*
*             9 * CHAR(1);
*  DCL CDS8TO19 CHAR(12) BASED(ADDR(CHASCT)+20); /* CDS ITEMS         *
*  DCL 1 * BASED(ADDR(CHASCT)+4),        /* SCT WORD 1 */
*         2 SCTWD17 CHAR(28),            /* SCT WORDS 1 THRU 7 */
*           3 RTNM1ST CHAR(2),           /* 1ST ROUTINES MASK */
*         2 * CHAR(1),                   /* NA */
*         2 * BIT(8),                    /* FLAGS */
*           3 * BIT(2),                  /* NA */
*           3 CSELRTN BIT(1),            /* CONSOLE SELECTED ROUTINES *
*         2 * CHAR(6),                   /* NA */
*         2 RTNMLST CHAR(30);            /* EXTENDED ROUTINES MASK */
*  DCL 1 * BASED(ADDR(CESWT)),           /* OLTEP SWITCHES GROUP */
*         2 * BIT(8),                    /* OLTEP SWITCHES */
*           3 * BIT(2),                  /* NA */
*           3 OORN BIT(2),               /* OLD OR NEW UTS */
*             4 OUTS BIT(1),             /* OLD UNIT TEST SECTIONS */
*             4 NUTS BIT(1),             /* NEW UNIT TEST SECTIONS */
*         2 * BIT(8),                    /* OLTEP SWITCHES */
*           3 * BIT(1),
*           3 SEEK2321 BIT(1),           /* 2321 SPECIAL SECTION */
*           3 T2321T BIT(1),             /* 2321T TEST */
*           3 * BIT(2),                  /* NA */
*           3 T2321 BIT(1),              /* 2321 SECTION */
*           3 * BIT(1),                  /* NA */
*           3 TPFLAG BIT(1),             /* TP TESTS */
*         2 * BIT(8),                    /* OLTEP SWITCHES */
*           3 NDCFO BIT(1),              /* PREVENTS DYN COM */
*           3 DPONDEV BIT(1),            /* DATA PROTECT DONE */
*           3 * BIT(3),                  /* NA */
*           3 NDR BIT(1),                /* NO DEVICE REQUIRED */
*           3 TAPEHDR BIT(1),            /* TAPE HEADER BIT */
*         2 * BIT(8),                    /* OLTEP SWITCHES */
*           3 OSTWTOR BIT(1),            /* OUTSTANDING WTOR */
*           3 BYPDEV BIT(2),             /* BYPASS ONE OR ALL DEVICES *
*             4 NURUN BIT(1),            /* BYPASS ALL DEVICE TESTS */
*             4 NUDEV BIT(1),            /* BYPASS THIS DEVICE */
*           3 * BIT(2),
*           3 TP1419 BIT(1),             /* ACTIVE TP OR 1419 */
*         2 CE45 CHAR(2),                /* OLTEP SWITCHES      S21937*
*           3 CE4 BIT(8),                /* SWITCH 4            S21937*
*           3 CE5 BIT(8),                /* SWITCH 5            S21937*
*             4 * BIT(2),                /* NA                  S21937*
*             4 FEITEMS BIT(4),          /* FIRST ERROR ITEMS   S21937*
*               6 FFEFCE BIT(2),         /* 1ST ERROR BITS       M5851*
*         2 CE6 BIT(8),                  /* OLTEP SWITCHES      S21937*
*           3 UTSCAL BIT(1),             /* UTS CALLED INDICATION */
*           3 * BIT(1),                  /* ALIGNMENT BIT */
*           3 EOJLOG BIT(1),             /* EOJ LOGSCAN */
*           3 PFPMSG BIT(1),             /* PRINT FILE PROTECT */
*           3 CODE5 BIT(1),              /* CONDITION CODE 5 */
*           3 NORUN BIT(1),              /* DO NOT RUN SECTION */
*           3 SECRUN BIT(1),             /* SECTION RUN */
*           3 RTSTAE BIT(1),             /* STAE ROUTINE */
*         2 * BIT(8),                    /* OLTEP SWITCHES            *
*           3 * BIT(2),
*           3 REMOTE BIT(1),
*           3 * BIT(3),                  /* NA                  Y02008*
*           3 VIRTUAL BIT(1),            /* OLTEP IN V=V OR V=R Y02008*
*         2 CE8 BIT(8),                  /* OLTEP SWITCHES     SA51756*
*         3 * BIT(3),                    /*   NA               SA54318*
*         3 READDCHK BIT(1),             /* READD FLAG         SA54318*
*         3 OLTINVV BIT(1),              /* OLT IS IN VIRTUAL   Y02008*
*           3 SUTMSG BIT(1),             /* START MSG ISSUED   SA51756*
*           3 SNEWRUN BIT(1),            /* START NEW RUN      SA51756*
*             4 * BIT(1);                /* LAST OLTEP SWITCH */
*         DCL CESWTR CHAR(1) GENERATED;  /* RETAIN 370 SWITCHES S20203*
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR)),  /*              S20203*
*               3 RETAINAC BIT(1),       /* REI ACTIVE          S20203*
*               3 REMERR BIT(1),         /* ERROR OCCURRED      S20203*
*               3 REMNOMSG BIT(1),       /* REMOTE NO MSG       S20203*
*               3 CENOMSG BIT(1),        /* ONSITE NO MSG       S20203*
*               3 PRTNOMSG BIT(1),       /* SYSOUT NO MSG       S20203*
*               3 IMRESP BIT(1),         /* IMMEDIATE RESP MSG  S20203*
*               3 EXECOUT BIT(1),        /* MSG IFD104E ISSUED  S20203*
*               3 CECOMOUT BIT(1);       /* MSG IFD154E ISSUED  S20203*
*  DCL CESWTR1 CHAR(1) GENERATED;        /* REI SWITCHES        S20203*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWTR1)),  /*                    S20203*
*         3 * BIT(2),                    /*                     S20203*
*         3 CECOMANS BIT(1),             /*                     S20203*
*         3 * BIT(2),                    /*                     S20203*
*         3 REMANS BIT(1),               /*                     S20203*
*         3 * BIT(2);                    /*                     S20203*
*         DCL BNAMCMSV CHAR(5);          /*                     S20203*
*  DCL 1 * CHAR(4),                      /* MESSAGE MODIFIERS */
*         2 MSGSTR CHAR(2) INIT(' S'),   /* START MESSAGE */
*         2 MSGEND CHAR(2) INIT(' T');   /* TERMINATE MESSAGE */
*  DCL UTS201 CHAR(8) BASED(R1+43);      /* UTS NAME            X02008*
*  DCL 1 MSG231 BASED(R1),               /* IFD231 MESSAGE      X02008*
*         2 * CHAR(12),                  /* NA                  X02008*
*         2 WMSGTEST CHAR(8),            /* UNIT TEST NAME */
*         2 * CHAR(15),                  /* NA                  X02008*
*         2 WMSGDEV CHAR(8);
*  DCL RTMASK CHAR(1) BASED(R2+70);      /* RETURN CODE MASK    X02008*
*  DCL MSGUTS CHAR(8) BASED(R1+12);      /* SECTION NAME         M1463*
*  DCL 1 * BASED(R4),                    /* WTO MESSAGE */
*         2 * CHAR(20),                  /* ALIGNMENT BYTES */
*         2 WTO4NM CHAR(8);              /* SECTION NAME */
*  DCL 1 MSG200 BASED(R1),               /* IFD200 MESSAGE      X02008*
*         2 * CHAR(17),                  /* NA                  X02008*
*         2 NM200 CHAR(8);               /* SECTION NAME        X02008*
*  DCL IODEVTAB CHAR(36) GENERATED;      /* IO DEVICE TABLE     Y02008*
*  DCL 1 DEVTBENT CHAR(12) BASED(R5),    /* IO DEV TAB FORMAT   Y02008*
*        3 DEVPTR PTR(31),               /* DEVTAB PTR          Y02008*
*        3 IOSBPTR PTR(31),              /* IOSB PTR            Y02008*
*        3 * CHAR(4);                    /* NA                  Y02008*
*  DCL 1 IOSB CHAR(116) BDY(WORD) BASED(R1), /* IOSB FORMAT     Y02008*
*        3 * CHAR(112),                  /* NA                  Y02008*
*        3 PTRTECB PTR(31);              /* TECB PTR            Y02008*
*  DCL INDEX FIXED(15);                  /* INDEX FOR LOOP      Y02008*
*  DCL 1 DIOPARM BDY(WORD),              /* DIO PARM LIST      SA51754*
*         2 * FIXED(15) INIT(2),         /* NA                  X02008*
*         2 * CHAR(2) INIT('44'),        /* DIO ID             SA51754*
*         2 DIOCDSAD PTR,                /* CDS ADDRESS        SA51754*
*         2 DIOTECB PTR,                 /* TECB ADDRESS       SA51754*
*         2 * CHAR(1) INIT('01'X),       /* HIO REQUEST        SA51754*
*           3 * CHAR(1);                 /* NA                 SA51754*
*  DCL ACTSECT CHAR(8);                 /* ACTIVE SECTION NAME  Y02008*
*  DCL SPCOUNT CHAR(2) BASED(R3+18);     /* OLTS EL COUNT      SA51757*
*  DCL CESWT9 CHAR(1) GENERATED;         /* OLTEP FLAG FLD 9    Y02008*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWT9)),  /* OLTEP FLAG FLD 9    Y02008*
*        3 * BIT(2),                     /* CDS EQUATE FLAGS    Y02008*
*        3 VRCAP BIT(1),                 /* VIRTUAL OR REAL OLT Y02008*
*        3 * BIT(4),                     /* NA                        *
*        3 OLTTERM BIT(1);               /* OLT FORCED TO TERM  Y02008*
*  DCL OLTADDR FIXED(31);                /* OLT AREA ADDRESS    Y02008*
*  DCL CHARAFFN CHAR(2) GENERATED;       /* SELECTED CPU AFFN   Y02008*
*  DCL CESWT10 CHAR(1) GENERATED;        /* INTERNAL FLAGS      Y02008*
*  DCL 1 * CHAR(1) BASED(ADDR(CESWT10)), /* INTERNAL FLAGS      Y02008*
*        3 MPSYS BIT(1);                 /* 1-MP   0-NOT MP     Y02008*
*  GEN(EJECT);
         EJECT
         DS    0H
*  R5=TMCOMAD;                           /* BLDL LIST */
         L     @5,A00023+32                                       0123
* SCH001:
*  SNEWRUN='0'B;                         /* CLEAR NEW RUN BIT  SA51756*
SCH001   NI    A00105+8,B'11111101'                               0124
*  TLRUN=1;                              /* INIT TEST LOOP RUN  Y02008*
         LA    @F,1                                               0125
         STH   @F,TLRUN                                           0125
*  SCHEDSA=R13;                          /* SAVE AREA ADDRESS */
         ST    @D,SCHEDSA                                         0126
*  IF RETCODE^=0 THEN                    /* TEST PREVIOUS RETURN CODE *
         SR    @F,@F                                              0127
         C     @F,RETCODE                                         0127
         BC    08,@9FF                                            0127
*    DO;                                 /* RETURN CODE HANDLED */
*      CODE5='1'B;                       /* INDICATE RETURN BACK HERE *
         OI    A00105+6,B'00001000'                               0129
*      RETCODE=0;                        /* ZERO RETURN CODE */
         SR    @F,@F                                              0130
         ST    @F,RETCODE                                         0130
*      GOTO SCH015;                      /* GO HANDLE PREVIOUS RETURN *
         BC    15,SCH015                                          0131
*    END;                                /* END RETURN CODE TESTING */
* SCH002:
*  CODE5='0'B;                           /* INITIALIZE RETURN CODE */
@9FF     EQU   *                                                  0133
SCH002   NI    A00105+6,B'11110111'                               0133
*  R9=ADDR(SNAMST);                      /* FIRST SECTION */
         LA    @9,A00073+7                                        0134
*  BNAMCM=SNAM;                          /* SECTION TYPE */
         MVC   PARM12(5),A00073+2                                 0135
*  TARGADR=PARADR;                       /* TARGET ADDRESS      X02008*
         MVC   PARM12+8(4),A00000                                 0136
*  UTSENVL='1'B;                         /* UTS ENVOLVED        X02008*
         OI    PARM12+12,B'00010000'                              0137
*  SVR8=0;                               /* ZERO SAVE AREA      X02008*
         SR    @F,@F                                              0138
         ST    @F,SVR8                                            0138
*  DO R8=1 TO SCNT2 BY 1;                /* SECTION COUNT       X02008*
         LA    @F,1                                               0139
         LR    @8,@F                                              0139
@DO9FE   SR    @F,@F                                              0139
         IC    @F,A00073+1                                        0139
         CR    @F,@8                                              0139
         BC    04,@DO9FB                                          0139
         BC    15,@DO9FC                                          0139
@DO9FD   LA    @F,1                                               0139
         AR    @8,@F                                              0139
         BC    15,@DO9FE                                          0139
*    BNAMVR=SNAM1;                       /* SECTION NAME */
@DO9FC   MVC   PARM12+5(3),0(@9)                                  0140
*    RTPLKSZ=0;                          /* ZERO OUT AREA       X02008*
         SR    @F,@F                                              0141
         ST    @F,A00000+8                                        0141
*    IF SLNG1^=DBLZ THEN                 /* CHECK SIZE          X02008*
         CLC   3(2,@9),A00000+8                                   0142
*      GOTO SCH002M;                     /* SIZE GIVEN          X02008*
         BC    07,SCH002M                                         0143
*    GEN(BAL   R7,CALLCOMP);             /* CALL COMPUTE        X02008*
         BAL   R7,CALLCOMP
         DS    0H
*    IF R15^=0 THEN                      /* CHECK RETURN        X02008*
         LTR   @F,@F                                              0145
         BC    08,@9FA                                            0145
*      DO;                               /* SECTION NOT FOUND */
*        R4=IFD117;                      /* MESSAGE ADDRESS */
         L     @C,MSGMOD                                          0147
         L     @4,24(0,@C)                                        0147
*        WTO4NM=BNAME;                   /* SECTION NAME */
         MVC   20(8,@4),PARM12                                    0148
*        GEN(BAL   R7,SCH026A);          /* WTO MESSAGE */
         BAL   R7,SCH026A
         DS    0H
*        GOTO SCH002P;                   /* NEXT SECTION        X02008*
         BC    15,SCH002P                                         0150
*      END;                              /* END OF MESSAGE */
*    SVR8=R0;                            /* STORE LENGTH        X02008*
@9FA     ST    @0,SVR8                                            0152
*    SLNG1=SVR834;                       /* SAVE LENGTH         X02008*
         MVC   3(2,@9),SVR8+2                                     0153
* SCH002M:
*    SVR8=R8;                            /* SAVE COUNT          X02008*
SCH002M  ST    @8,SVR8                                            0154
* SCH002P:
*    R9=ADDR(SNAM2);                     /* NEXT SECTION */
SCH002P  LA    @9,5(0,@9)                                         0155
         BC    15,@DO9FD                                          0156
*  END;                                  /* CONTINUE SECTION TEST */
*  SCNT2=SVR84;                          /* LAST SECTION COUNT  X02008*
@DO9FB   MVC   A00073+1(1),SVR8+3                                 0157
*  GEN(EJECT);
         EJECT
         DS    0H
* SCH003:
*  CE46=CE46&&CE46;                      /* CLEAR SWITCHES      S21937*
SCH003   XC    CE46(3),CE46                                       0159
*  OORN='00'B;                           /* OLD OR NEW UTS INDICATOR */
         NI    A00105,B'11001111'                                 0160
*  DCNT1='00'X;                          /* INITIAL DEVICE COUNT */
         MVI   DCNT1,X'00'                                        0161
*  R8=DEVTBPTR;                          /* FIRST DEVICE TABLE        *
         L     @8,DEVTBPTR                                        0162
*  IF NDR='1'B THEN                      /* CHECK INDICATOR     X02008*
         TM    A00105+2,B'00000100'                               0163
*    GOTO SCH006;                        /* NO DEVICE NEEDED    X02008*
         BC    01,SCH006                                          0164
*  DO R7=DCNT2 TO 1 BY -1;               /* CHECK DEVICE        X02008*
         SR    @F,@F                                              0165
         IC    @F,DCNT2                                           0165
         LTR   @7,@F                                              0165
         BC    12,@DO9F8                                          0165
*    IF SKIPRIM='0'B THEN                /* TEST SKIP PRIME BIT Y02008*
@DO9F9   TM    42(@8),B'01000000'                                 0166
*        GOTO SCH003M;                   /* USE DEVICE ENTRY    X02008*
         BC    08,SCH003M                                         0167
*    R8=R8+TABLNGTH;                     /* NEXT DEVICE ENTRY   X02008*
         AH    @8,TABLNGTH                                        0168
*    DCNT1=DCNT1+1;                      /* NEXT DEVICE         X02008*
         LA    @F,1                                               0169
         SR    @0,@0                                              0169
         IC    @0,DCNT1                                           0169
         AR    @F,@0                                              0169
         STC   @F,DCNT1                                           0169
*  END;                                  /* ALL DEVICES         X02008*
*  GOTO SCH024A;                         /* END TEST            X02008*
         BCT   @7,@DO9F9                                          0170
         BC    15,SCH024A                                         0171
* SCH003M:
*  PRIDVPTR=R8;                          /* PRIME DEVICE TABLE */
SCH003M  ST    @8,PRIDVPTR                                        0172
*  DEVDEPAD=ADDR(DVSEC1);                /* PRIME DEVICE SCT SECTION */
         LA    @F,A00080+8                                        0173
         ST    @F,DEVDEPAD                                        0173
*      REGX=ADDR(DVUCB);                 /* ACTIVE UCB ADDRESS */
         LA    @F,8(0,@8)                                         0174
         ST    @F,REGX                                            0174
*  IF TPFLAG='1'B THEN                   /* TEST TP FLAG */
         TM    A00105+1,B'00000001'                               0175
         BC    12,@9F5                                            0175
*    DO;                                 /* TP DEVICE */
*  GEN(BAL   R7,SCHA05);                 /* UPDATE SCT          S21937*
         BAL   R7,SCHA05
         DS    0H
*      GEN(BAL   R7,SCH029);             /* LINK TO DATA PROTECT */
         BAL   R7,SCH029
         DS    0H
*      DCNT1=DCNT1+1;                    /* NEXT DEVICE ENTRY   X02008*
         LA    @F,1                                               0179
         SR    @0,@0                                              0179
         IC    @0,DCNT1                                           0179
         AR    @F,@0                                              0179
         STC   @F,DCNT1                                           0179
*      R8=R8+TABLNGTH;                   /* NEXT DEVICE TABLE         *
         AH    @8,TABLNGTH                                        0180
*      IF DCNT1=DCNT2 THEN               /* CHECK DEVICE COUNT  X02008*
         CLC   DCNT1(1),DCNT2                                     0181
*        GOTO SCH024A;                   /* ALL DEVICES CHECKED X02008*
         BC    08,SCH024A                                         0182
*    END;                                /* END OF FIRST TP DEVICE */
*  GOTO SCH006;                          /* BYPASS NEXT DEVICE BYPASS *
         BC    15,SCH006                                          0184
* SCH004:
*  DCNT1='00'X;                          /* NEW DEVICES TO RUN */
SCH004   MVI   DCNT1,X'00'                                        0185
* SCH005:
*  R8=R8+TABLNGTH;                       /* NEXT DEVICE TABLE         *
SCH005   AH    @8,TABLNGTH                                        0186
* SCH006:
*  CATB1='0'B;                           /* ZERO OUT CATASTRPHIC BIT */
SCH006   NI    A00080+3,B'11011111'                               0187
*  CE6=CE6&'02'X;                        /* CLEAR SWITCHES      S21937*
         NI    A00105+6,X'02'                                     0188
*  CE45=CE45&&CE45;                      /* CLEAR SWITCHES      S21937*
         XC    A00105+4(2),A00105+4                               0189
*  BYPDEV='00'B;                         /* ZERO OUT BYPASS SWITCHES */
         NI    A00105+3,B'10011111'                               0190
*  SCNT1='01'X;                          /* FIRST SECTION FOR DEVICE */
         MVI   SCNT1,X'01'                                        0191
*  LASTSEC='0'B;                         /* LAST SECTION NOT RUN M1463*
         NI    A00080+36,B'11111101'                              0192
*  R9=ADDR(SNAMST);                      /* FIRST SECTION TO RUN */
         LA    @9,A00073+7                                        0193
*  IF NDR='1'B THEN                      /* TEST IF DEVICE REQUIRED */
         TM    A00105+2,B'00000100'                               0194
*    GOTO SCH007;                        /* TEST NOT REQUIRED */
         BC    01,SCH007                                          0195
*  DCNT1=DCNT1+1;                        /* NEXT DEVICE */
         LA    @F,1                                               0196
         SR    @0,@0                                              0196
         IC    @0,DCNT1                                           0196
         AR    @F,@0                                              0196
         STC   @F,DCNT1                                           0196
*  IF SKIPRIM='1'B THEN                  /* TEST SKIP PRIME BIT Y02008*
         TM    42(@8),B'01000000'                                 0197
*      GOTO SCH023L;                     /* NEXT DEVICE         X02008*
         BC    01,SCH023L                                         0198
*  GEN(BAL   R7,SCHA05);                 /* UPDATE SCT          S21937*
         BAL   R7,SCHA05
         DS    0H
*  GEN(BAL   R7,SCH029);                 /* LINK TO DATA PROTECT */
         BAL   R7,SCH029
         DS    0H
* SCH007:
*  SECPTR=0;                             /* NO UTS LOADED */
SCH007   SR    @F,@F                                              0201
         ST    @F,SECPTR                                          0201
*  PLNM15=SNAM;                          /* TYPE OF SECTION */
         MVC   UTSPL(5),A00073+2                                  0202
*  PLNM68=SNAM1;                         /* COMPLETE THE SECTION NAME *
         MVC   UTSPL+5(3),0(@9)                                   0203
*  CLEANRT='0'B;                         /* ZERO SWITCH          M1390*
         NI    A00080+36,B'10111111'                              0204
*  IF LASTSEC='1'B THEN                  /* TEST LAST SECTION    M1463*
         TM    A00080+36,B'00000010'                              0205
*    GOTO SCH022;                        /* ALL SECTIONS RUN */
         BC    01,SCH022                                          0206
*  IF SCNT2^>SCNT1 THEN                  /* CHECK SECTION COUNT  M1463*
         CLC   A00073+1(1),SCNT1                                  0207
         BC    02,@9F4                                            0207
*    LASTSEC='1'B;                       /* LAST SECTION RUN     M1463*
         OI    A00080+36,B'00000010'                              0208
*  IF SLNG1='0000'X THEN                 /* TEST SECTION LENGTH */
@9F4     CLC   3(2,@9),@X7                                        0209
         BC    07,@9F3                                            0209
* SCH008:
*    DO;                                 /* NO SIZE MEANS NO SECTION */
*      R9=ADDR(SNAM2);                   /* NEXT SECTION ENTRY */
SCH008   LA    @9,5(0,@9)                                         0211
* SCH009:
*      SCNT1=SCNT1+1;                    /* NEXT SECTIONS */
SCH009   LA    @F,1                                               0212
         SR    @0,@0                                              0212
         IC    @0,SCNT1                                           0212
         AR    @F,@0                                              0212
         STC   @F,SCNT1                                           0212
*      GOTO SCH007;                      /* TEST NEXT SECTION */
         BC    15,SCH007                                          0213
*    END;                                /* NO SECTION FOUND LOOP END *
*  IF TPFLAG='1'B&                       /* TEST TP FLAG */
*    SECRUN='1'B&                        /* SECTION RUN ALREADY */
*      OLDUT='0'B THEN                   /* NEW UTS */
@9F3     TM    A00105+1,B'00000001'                               0215
         BC    12,@9F2                                            0215
         TM    A00105+6,B'00000010'                               0215
         BC    12,@9F1                                            0215
         TM    4(@9),B'00000001'                                  0215
*        GOTO SCH008;                    /* NEXT SECTION */
         BC    10,SCH008                                          0216
*  OORN='00'B;
@9F0     EQU   *                                                  0217
@9F1     EQU   *                                                  0217
@9F2     NI    A00105,B'11001111'                                 0217
*  UTSIZ=SLNG1;
         MVC   A00000+10(2),3(@9)                                 0218
*  IF CLRBIT='1'B THEN
         TM    A00000+11,B'00000001'                              0219
         BC    12,@9EF                                            0219
*    OUTS='1'B;
         OI    A00105,B'00100000'                                 0220
         BC    15,@9EE                                            0221
*  ELSE NUTS='1'B;
@9EF     OI    A00105,B'00010000'                                 0221
*  CLRBIT='0'B;
@9EE     NI    A00000+11,B'11111110'                              0222
*  IF RTPLKSZ>PARSZ THEN                 /* CHECK SIZE          X02008*
         L     @F,A00000+4                                        0223
         C     @F,A00000+8                                        0223
         BC    10,@9ED                                            0223
*    DO;                                 /* UTS TOO LARGE       X02008*
*      R1=IFD200;                        /* IFD200 MESSAGE      X02008*
         L     @C,MSGMOD                                          0225
         L     @1,96(0,@C)                                        0225
*      NM200=PLNAM;                      /* SECTION NAME        X02008*
         MVC   17(8,@1),UTSPL                                     0226
*      GOTO SCH025A;                     /* ISSUE WTO           X02008*
         BC    15,SCH025A                                         0227
*    END;                                /* END CORE CHECK      X02008*
*  IF PLSNM='2400W ' THEN                /* TAPE GAP TEST       S21937*
@9ED     CLC   UTSPL+1(6),@C8                                     0229
*    GOTO SCH025;                        /* BYPASS TEST         S21937*
         BC    08,SCH025                                          0230
* SCH010:
*  UTSCAL='0'B;                          /* UTS NOT CALLED YET */
SCH010   NI    A00105+6,B'01111111'                               0231
*  NDCFO='1'B;                           /* NO DYN COMMUNICATION TEST *
         OI    A00105+2,B'10000000'                               0232
*  R7=DEVTBPTR;                          /* FIRST DEVICE TABLE        *
         L     @7,DEVTBPTR                                        0233
*  DO R4=16 TO 1 BY -1;                  /* COUNT OF DEVICES     M4507*
         LA    @4,16                                              0234
*    R7->GRABIT='0'B;                    /* CLEAR GRAB BIT       M4507*
@DO9EC   NI    12(@7),B'11111011'                                 0235
*    R7=R7+TABLNGTH;                     /* NEXT DEVICE TABLE         *
         AH    @7,TABLNGTH                                        0236
*  END;                                  /* LOOP FOR TABLE       M4507*
*  CLEANRT='0'B;                         /* NO CLEAN UP          M1390*
         BCT   @4,@DO9EC                                          0237
         NI    A00080+36,B'10111111'                              0238
*  IF PLNAM=ACTSECT THEN                /* IS THIS SAME SECTION Y02008*
         CLC   UTSPL(8),ACTSECT                                   0239
*    GO TO SCH010A;                     /* YES, NO NEED TO      Y02008*
         BC    08,SCH010A                                         0240
*                                       /* RE-LOAD..CONTINUE    Y02008*
*  GEN(BAL   R7,CALLCOMP);               /* CALL COMPUTE        X02008*
         BAL   R7,CALLCOMP
         DS    0H
*  GEN(BAL   R7,CALLOAD);                /* CALL LOADER         X02008*
         BAL   R7,CALLOAD
         DS    0H
*  IF R15^=0 THEN                       /* WAS LOAD OK          Y02008*
         LTR   @F,@F                                              0243
*    GO TO SCH008;                      /* NO, TRY NEXT SECTION Y02008*
         BC    07,SCH008                                          0244
*  ACTSECT=PLNAM;                       /* SAVE SECTION NAME    Y02008*
         MVC   ACTSECT(8),UTSPL                                   0245
*  OLTADDR=R1;                           /* SAVE OLT ADDRESS    Y02008*
         ST    @1,OLTADDR                                         0246
*  OLTINVV='0'B;                         /* OLT IS IN V=R       Y02008*
         NI    A00105+8,B'11110111'                               0247
*  IF VIRTUAL='1'B THEN                  /* IS OLTEP IN VIRTUAL Y02008*
         TM    A00105+7,B'00000010'                               0248
         BC    12,@9E8                                            0248
*    DO;                                 /* YES, THEN OLT WILL  Y02008*
*    OLTINVV='1'B;                       /* BE TOO              Y02008*
         OI    A00105+8,B'00001000'                               0250
*    IF VRCAP='0'B THEN                  /* DOES OLT HAVE V=V   Y02008*
         TM    A00140,B'00100000'                                 0251
         BC    05,@9E7                                            0251
*                                        /* CAPABILITY          Y02008*
*      DO;                               /* NO, PRINT MSGIFD248IY02008*
*      R4=IFD248;                        /* GET PTR TO MSG 248I Y02008*
         L     @C,MSGMOD                                          0253
         L     @4,140(0,@C)                                       0253
*      GEN(BAL   R7,SCH026A);            /* PRINT MESSAGE       Y02008*
         BAL   R7,SCH026A
         DS    0H
*      END;                              /*                     Y02008*
*    END;                                /*                     Y02008*
@9E7     EQU   *                                                  0256
* SCH010A:                              /*                      Y02008*
*  R4=OLTADDR;                           /* RESTORE OLT ADDRESS Y02008*
@9E8     EQU   *                                                  0257
SCH010A  L     @4,OLTADDR                                         0257
*  NDCFO='0'B;                           /* TEST DYN COMMUNICATIONS */
         NI    A00105+2,B'01111111'                               0258
*  GO TO SCH011;                        /* PREPARE TO ENTER OLT Y02008*
         BC    15,SCH011                                          0259
* SCHA05:
*  CDS8TO19=DVTABCDS(9:20);              /* CDS BYTES TO SCT    S21937*
SCHA05   MVC   CDS8TO19(12),40(@8)                                0260
* SCHA06:
*  DEVDEPAD=ADDR(DVSEC1);                /* PRIMARY ENTRY       S21937*
SCHA06   LA    @F,A00080+8                                        0261
         ST    @F,DEVDEPAD                                        0261
*  IF DVCDS=0 THEN                       /* TEST DESCRIPTORS    S21937*
         CLC   36(4,@8),@D1                                       0262
         BC    07,@9E6                                            0262
*    PDDD1=DVUDD;                        /* USE UCB DESCRIPTORS S21937*
         L     @C,8(0,@8)          
         MVC   A00080+16(4),16(@C)                                0263
         BC    15,@9E5                                            0264
*  ELSE PDDD1=DVCDS;                     /* USE DEVICE CDS      S21937*
@9E6     MVC   A00080+16(4),36(@8)                                0264
*  PRIMBIT='1'B;                         /* PRIME BIT SET       S21937*
@9E5     OI    12(@8),B'01000000'                                 0265
*  PDPA1=DVADR;                          /* DEVICE ADDRESS      S21937*
         MVC   A00080+12(4),32(@8)                                0266
*  GOTO R7;                              /* RETURN TO MAIN FLOW S21937*
         BCR   15,@7                                              0267
* SCH011:
*  SECPTR=R4;                            /* SAVE ENTRY POINT ADDRESS */
SCH011   ST    @4,SECPTR                                          0268
*  GEN(EJECT);
         EJECT
         DS    0H
*  IF NUTS='1'B THEN                     /* CHECK UTS           X02008*
         TM    A00105,B'00010000'                                 0270
         BC    12,@9E4                                            0270
*    DO;                                 /* NEW UTS             X02008*
*      R3=R4+INZRT;                      /* POINTER TO ROUTINE */
         LH    @3,10(0,@4)                                        0272
         AR    @3,@4                                              0272
*      IF RTPLKSZ<RTSIZ THEN             /* TEST UTS SIZE TO USEX02008*
         L     @F,20(0,@3)                                        0273
         C     @F,A00000+8                                        0273
         BC    12,@9E3                                            0273
*        RTPLKSZ=RTSIZ;                  /* USE UTS AND PLINK   X02008*
         MVC   A00000+8(4),20(@3)                                 0274
*      UTENT=INZIN;                      /* FIRST INSTRUCTION ADDRESS *
@9E3     MVC   UTENT(4),12(@4)                                    0275
*      IF ERLOP='1'B&                    /* EL OPTION ENTERED  SA51757*
*        ERRCNT='0'B THEN                /* NO EL COUNT ENTER  SA51757*
         TM    A00080+3,B'00000010'                               0276
         BC    12,@9E2                                            0276
         TM    A00080+33,B'00010000'                              0276
         BC    05,@9E1                                            0276
*          ERRLPCT=SPCOUNT;              /* USE OLTS EL COUNT  SA51757*
         MVC   A00080(2),18(@3)                                   0277
*      IF SECLEV^>SCTLEV THEN            /* CHECK SCT LEVEL     X02008*
@9E1     EQU   *                                                  0278
@9E2     CLC   11(1,@3),A00080+7                                  0278
*        GOTO SCH012;                    /* UTS SUPPORTED       X02008*
         BC    12,SCH012                                          0279
*      UT227=PLNAM;                      /* SECTION NAME        X02008*
         L     @C,MSGMOD                                          0280
         L     @C,68(0,@C)         IFD227                         0280
         MVC   37(8,@C),UTSPL                                     0280
*      R1=IFD227;                        /* IFD227 MESSAGE      X02008*
         L     @C,MSGMOD                                          0281
         L     @1,68(0,@C)                                        0281
*      GOTO SCH025A;                     /* WTO MESSAGE         X02008*
         BC    15,SCH025A                                         0282
*    END;                                /* END UTS INITIALIZATION */
*  R3=ADDR(RTMSK);                       /* POINTER TO ROUTINE */
@9E4     LA    @3,84(0,@4)                                        0284
*  UTENT=R4;                             /* FIRST INSTRUCTION ADDRESS *
         ST    @4,UTENT                                           0285
* SCH012:
*  RTPLKSZ=RTPLKSZ+7;                    /* ROUND UP TO DWORD   X02008*
SCH012   LA    @F,7                                               0286
         A     @F,A00000+8                                        0286
         ST    @F,A00000+8                                        0286
*  TRPBITS='000'B;                       /* ZERO LOW ORDER BITS X02008*
         NI    A00000+11,B'11111000'                              0287
*  SECPRF=R3;                            /* ROUTINE ADDRESS */
         ST    @3,A00023+36                                       0288
*  UTSCAL='0'B;                          /* INDICATE GOING TO UTS */
         NI    A00105+6,B'01111111'                               0289
*  R4=IFD158;                            /* MESSAGE ADDRESS */
         L     @C,MSGMOD                                          0290
         L     @4,48(0,@C)                                        0290
*  MSGTEST=PLNAM;                        /* SECTION BEING RUN */
         MVC   16(8,@4),UTSPL                                     0291
*  IF OUTS='1'B THEN                     /* CHECK TEST                *
         TM    A00105,B'00100000'                                 0292
         BC    12,@9E0                                            0292
*    OLDTEST='$';                        /* INDICATE OLD TEST         *
         MVI   23(@4),C'$'                                        0293
*  MSGUNIT=BLKUNIT;                      /* CLEAR UNIT MESSAGE        *
@9E0     MVC   25(22,@4),24(@4)                                   0294
*  IF SYMBIT='1'B                  /* CHECK IF SYMBOLIC OR   @Y30LPAW*
*     SYMBSSID='1'B THEN            /* SSID IN SYMB NAME FLD  @Y30LPAW*
         TM    41(@8),B'00001000'                                 0295
         BC    01,@9DF                                            0295
         TM    12(@8),B'00000001'                                 0295
         BC    12,@9DE                                            0295
*    MSGSYB=SYMNAME;                     /* SYMBOLIC NAME             *
@9DF     MVC   39(8,@4),44(@8)                                    0296
*  MSGVR='R';                            /* INDICATE OLT IS IN  Y02008*
@9DE     MVI   50(@4),C'R'                                        0297
*                                        /* REAL                Y02008*
*  IF OLTINVV='1'B THEN                  /* IS OLT IN VIRTUAL   Y02008*
         TM    A00105+8,B'00001000'                               0298
         BC    12,@9DD                                            0298
*    MSGVR='V';                          /* YES, PUT V IN START Y02008*
         MVI   50(@4),C'V'                                        0299
*                                        /* MESSAGE             Y02008*
*  MSGCPUID=CHARAFFN;                    /* PLACE SELECTED AFFN Y02008*
@9DD     MVC   58(2,@4),CHARAFFN                                  0300
*                                        /* IN START TERM MSG   Y02008*
*  IF MPSYS='0'B THEN                    /* IS IT AN MP SYSTEM  Y02008*
         TM    A00143,B'10000000'                                 0301
         BC    05,@9DC                                            0301
*    MPCPUID=MPCPUID&&MPCPUID;           /* NO, ELIMATE MP      Y02008*
         XC    51(9,@4),51(@4)                                    0302
*                                        /* PART OF MSG IFD158I Y02008*
*  KUNIT='UNIT';                         /* INSERT UNIT CONSTANTY02008*
@9DC     MVC   25(4,@4),@C13                                      0303
*  MSGDEV='NONE    ';                    /* PLACE UNIT EQUAL TO Y02008*
         MVC   30(8,@4),@C14                                      0304
*                                        /* IN ALL CASES.       Y02008*
*  IF NDR='1'B THEN                      /* TEST IF DEV ARE REQ Y02008*
         TM    A00105+2,B'00000100'                               0305
*    GO TO SCH013;                       /* NO DEVICES-UNIT=NONEY02008*
         BC    01,SCH013                                          0306
*                                        /* IS OK IN S T MSG    Y02008*
*  MSGDEV=DVEBC;                         /* DEVICE ADDRESS */
         MVC   30(8,@4),0(@8)                                     0307
*  SVR8=R8;                              /* SAVE REG            S21937*
         ST    @8,SVR8                                            0308
*  IF TPFLAG='0'B THEN                   /* TEST TP FLAG        S21937*
         TM    A00105+1,B'00000001'                               0309
*    GOTO SCHA04;                        /* NO TP DEVICE        S21937*
         BC    08,SCHA04                                          0310
*  IF NUTS='1'B THEN                     /* TEST UTS            S21937*
         TM    A00105,B'00010000'                                 0311
         BC    12,@9DB                                            0311
*    DO;                                 /* NEW UTS             S21937*
*      PRIMBIT='0'B;                     /* ZERO PRIME BIT      S21937*
         NI    12(@8),B'10111111'                                 0313
*      R8=DEVTBPTR;                      /* FIRST DEVICE TABLE  S21937*
         L     @8,DEVTBPTR                                        0314
*      GEN(BAL   R7,SCHA05);             /* LOAD SCT            S21937*
         BAL   R7,SCHA05
         DS    0H
*      MSGDEV=DVEBC;                     /* DEVICE ADDRESS      S21937*
         MVC   30(8,@4),0(@8)                                     0316
*      GOTO SCHA04;                      /* RESUME PROGRAM      S21937*
         BC    15,SCHA04                                          0317
*    END;                                /* END NEW TP CHECK    S21937*
*  GEN(BAL   R7,SCHA06);                 /* UPDATE SCT          S21937*
@9DB     EQU   *                                                  0319
         BAL   R7,SCHA06
         DS    0H
*  PRIMBIT='0'B;                         /* CLEAR PRIME BIT     S21937*
         NI    12(@8),B'10111111'                                 0320
*  PDPAD2=PDPAD1;                        /* SECONDARY IN SCT    S21937*
         MVC   A00080+24(8),A00080+12                             0321
*  R8=R8-TABLNGTH;                       /* PREVIOUS DEVICE     S21937*
         SH    @8,TABLNGTH                                        0322
*  GEN(BAL   R7,SCHA06);                 /* UPDATE SCT          S21937*
         BAL   R7,SCHA06
         DS    0H
*  DEVDEPAD=ADDR(DVSEC2);                /* SECONDARY ENTRY     S21937*
         LA    @F,A00080+20                                       0324
         ST    @F,DEVDEPAD                                        0324
* SCHA04:
* PRIDVPTR=R8;                           /* PRIME DEVICE TABLE   M1398*
SCHA04   ST    @8,PRIDVPTR                                        0325
*  R8=SVR8;                              /* RESTORE REG         S21937*
         L     @8,SVR8                                            0326
* SCH013:
*  IF NUTS='0'B THEN                     /* TEST UTS */
SCH013   TM    A00105,B'00010000'                                 0327
*    GOTO SCH014;                        /* NOT NEW UTS */
         BC    08,SCH014                                          0328
*  IF NDR='1'B THEN                      /* TEST IF DEVICE REQUIRED */
         TM    A00105+2,B'00000100'                               0329
         BC    12,@9DA                                            0329
*    DO;                                 /* CHECK OLTS          X02008*
*      IF WANT(3:4)='0000'X THEN         /* CHECK CLASS AND TYPEX02008*
         CLC   3(2,@3),@X7                                        0331
*        GOTO SCH014;                    /* NONE NEEDED         X02008*
         BC    08,SCH014                                          0332
*      R1=IFD201;                        /* IFD201 MESSAGE      X02008*
         L     @C,MSGMOD                                          0333
         L     @1,52(0,@C)                                        0333
*      UTS201=MSGTEST;                   /* SECTION NAME        X02008*
         MVC   43(8,@1),16(@4)                                    0334
*      GOTO SCH013D;                     /* ISSUE WTO           X02008*
         BC    15,SCH013D                                         0335
*    END;                                /* END OLTS CHECK      X02008*
*  IF DVCDS=0 THEN                       /* TEST DEVICE DESCRIPTORS */
@9DA     CLC   36(4,@8),@D1                                       0337
         BC    07,@9D9                                            0337
*        DO;                             /* SECTION CAN NOT BE RUN */
*         ASTERB='1'B;                   /* INDICATE ERROR */
         OI    A00080+3,B'01000000'                               0339
*         R1=IFD502;                     /* IFD502 MESSAGE      X02008*
         L     @C,MSGMOD                                          0340
         L     @1,88(0,@C)                                        0340
*         GOTO SCH013D;                  /* WTO MESSAGE         X02008*
         BC    15,SCH013D                                         0341
*        END;                            /* END OF SECTION CHECK */
*  RETCODE=2;                            /* INCORRECT DEVICE CODE */
@9D9     LA    @F,2                                               0343
         ST    @F,RETCODE                                         0343
*  WK1TO4=PDDD1;                         /* DESCRIPTS INTO WORK AREA */
         MVC   4(4,@5),A00080+16                                  0344
*  WK5TO8=PDDD1;                         /* DESCRIPTS INTO WORK AREA */
         MVC   8(4,@5),A00080+16                                  0345
*  WK1TO8=WK1TO8&WANTDONT;               /* SELECT BITS TO CHECK */
         NC    4(8,@5),1(@3)                                      0346
*  WK1TO4=WK1TO4&&WANT;                  /* REMOVE UNWANTED BITS */
         XC    4(4,@5),1(@3)                                      0347
*       IF PDDD1(4) ^= DONTWANT(4) THEN /* IF TYPE NOT WANTED @ZA09701*
         CLC   A00080+19(1),8(@3)                                 0348
         BC    08,@9D8                                            0348
*          DO;                          /* NOT EQUAL TYPE GIVEN */
*            WK5TO8(4) = '00'X;         /* ZERO OUT RESULT BYTE*/
         MVI   11(@5),X'00'                                       0350
*          END;                                             /*@ZA09701*
*  IF WK1TO8^=ZIP8 THEN                  /* TEST DESCRIPTS */
@9D8     CLC   4(8,@5),A00043+8                                   0352
         BC    08,@9D7                                            0352
*    DO;                                 /* DEV DESC DONT MATCH Y02008*
*    R1=IFD201;                          /* PRINT MSG INDICATINGY02008*
         L     @C,MSGMOD                                          0354
         L     @1,52(0,@C)                                        0354
*    UTS201=MSGTEST;                     /* DEVICE NO GOOD FOR  Y02008*
         MVC   43(8,@1),16(@4)                                    0355
*    GEN(BAL   R7,SCH027);               /* TEST EXECUTION      Y02008*
         BAL   R7,SCH027
         DS    0H
*    GO TO SCH015;                       /*                     Y02008*
         BC    15,SCH015                                          0357
*    END;                                /*                     Y02008*
* SCH014:
*  IF OUTS='1'B&                         /* OLD UTS */
*    CSELRTN='1'B&                       /* CONSOLE SELECTED ROUTINES *
*      RTNM1ST='0000'X THEN             /* ROUTINES 1-16 MASK */
@9D7     EQU   *                                                  0359
SCH014   TM    A00105,B'00100000'                                 0359
         BC    12,@9D6                                            0359
         TM    A00100+29,B'00100000'                              0359
         BC    12,@9D5                                            0359
         CLC   A00100(2),@X7                                      0359
*        GOTO SCH014A;                   /* INCORRECT ROUTINES */
         BC    08,SCH014A                                         0360
*  WTO12=MSGSTR;                         /* START MESSAGE      SA51756*
@9D4     EQU   *                                                  0361
@9D5     EQU   *                                                  0361
@9D6     MVC   13(2,@4),A00128                                    0361
*  GEN(BAL   R7,SCH026);                 /* WTO MESSAGE        SA51756*
         BAL   R7,SCH026
         DS    0H
*  WTO12=MSGEND;                         /* TERMINATE MESSAGE  SA51756*
         MVC   13(2,@4),A00128+2                                  0363
*  SUTMSG='1'B;                          /* START MSG ISSUED   SA51756*
         OI    A00105+8,B'00000100'                               0364
*  R7=ADDR(SCH014AB);                    /* RETURN ADDRESS            *
         LA    @7,SCH014AB                                        0365
*  READDCHK='1'B;                        /* TELL READD SECT ENTSA54318*
         OI    A00105+8,B'00010000'                               0366
* SCH014AA:
*  R1=ADDR(PSCT);                        /* SECTION CONTROL TABLE */
SCH014AA LA    @1,PSCT                                            0367
*  R15=UTENT;                            /* ENTRY POINT TO UTS */
         L     @F,UTENT                                           0368
*  GEN(BALR  R14,R15);                   /* LINK TO SECTION */
         BALR  R14,R15
         DS    0H
*  RTMASK='00'X;                         /* RETURN CODE MASK    X02008*
         MVI   70(@2),X'00'                                       0370
*  UTSCAL='0'B;                          /* DELETE MODULES      XM5847*
         NI    A00105+6,B'01111111'                               0371
*  GOTO R7;                              /* RETURN FROM ROUTINE       *
         BCR   15,@7                                              0372
* SCH014AB:
*  IF BYPDEV^='00'B&                     /* BYPASS TEST               *
*    CLEANRT='1'B THEN                   /* UTS HAS CLEANUP           *
SCH014AB TM    A00105+3,B'01100000'                               0373
         BC    08,@9D3                                            0373
         TM    A00080+36,B'01000000'                              0373
         BC    12,@9D2                                            0373
*      CLEANUP='1'B;                     /* CLEAN UP UTS              *
         OI    A00080+33,B'00000100'                              0374
*  RETCODE=R15;                          /* SAVE RETURN CODE */
@9D2     EQU   *                                                  0375
@9D3     ST    @F,RETCODE                                         0375
*  IF OLTTERM='1'B &                     /* WAS OLT FORCED TO   Y02008*
*    CLEANRT='1'B THEN                   /* TERM & IS CLEANUP   Y02008*
         TM    A00140,B'00000001'                                 0376
         BC    12,@9D1                                            0376
         TM    A00080+36,B'01000000'                              0376
         BC    12,@9D0                                            0376
*      CLEANUP='1'B;                     /* NEEDED. YES, CLEANUPY02008*
         OI    A00080+33,B'00000100'                              0377
* SCH014A:
*  SECDVPTR=0;                           /* LAST GRAB DEVICE */
@9D0     EQU   *                                                  0378
@9D1     EQU   *                                                  0378
SCH014A  SR    @F,@F                                              0378
         ST    @F,SECDVPTR                                        0378
*  R0=ADDR(MODNN);                       /* ADDRESS OF MODULE NAME */
         L     @C,A00023+32        A00023                         0379
         LA    @0,44(0,@C)                                        0379
*  MODNN=KNT;                            /* OLTEP MODULE NAME */
         MVC   44(8,@C),36(@C)                                    0380
*  IF RTSTAE='1'B THEN                   /* STAE IN CONTROL           *
         TM    A00105+6,B'00000001'                               0381
*    GOTO SCH017;                        /* CHECK LOGSCAN             *
         BC    01,SCH017                                          0382
*  IF CSELRTN='0'B THEN                  /* TEST ROUTINES SELECTED */
         TM    A00100+29,B'00100000'                              0383
         BC    05,@9CF                                            0383
*    DO;                                 /* NOT SELECTED FROM CONSOLE *
*      RTNM1ST=RTNM1ST&&RTNM1ST;         /* ZERO FIRST ROUTINES MASK */
         XC    A00100(2),A00100                                   0385
*      RTNMLST=RTNMLST&&RTNMLST;         /* ZERO LAST ROUTINES MASK */
         XC    A00100+36(30),A00100+36                            0386
*    END;                                /* ROUTINES MASKS ZEROED */
*  IF TERTN<HIRTN THEN                   /* TEST ROUTINES IN UTS */
@9CF     CLC   A00006(1),A00006+1                                 0388
         BC    10,@9CE                                            0388
*    DO;                                 /* SOME ROUTINES NOT PRESENT *
*      R1=IFD503;                        /* IFD503 MESSAGE      X02008*
         L     @C,MSGMOD                                          0390
         L     @1,92(0,@C)                                        0390
*      GEN(BAL   R7,SCH027);             /* ISSUE WTO           X02008*
         BAL   R7,SCH027
         DS    0H
*                                        /*                     A45731*
*    END;                                /* END ROUTINE TEST */
* SCH015:
*         DYCOM='0'B;                    /* ZERO DYN COMM FLAG  X02008*
@9CE     EQU   *                                                  0393
SCH015   NI    A00080+36,B'11111110'                              0393
*         TALKFLAG ='0'B;                /* ZERO TALK FLAG      X02008*
         NI    A00080+37,B'01111111'                              0394
* SCH016:
*  IF RETCODE=2 THEN                     /* TEST RETURN CODE */
SCH016   LA    @F,2                                               0395
         C     @F,RETCODE                                         0395
         BC    07,@9CD                                            0395
*    DO;                                 /* INCORRECT DEVICE */
*      R1=IFD231;                        /* IFD231 MESSAGE      X02008*
         L     @C,MSGMOD                                          0397
         L     @1,80(0,@C)                                        0397
*      WMSGTEST=MSGTEST;                 /* SECTION NAME */
         MVC   12(8,@1),16(@4)                                    0398
*      WMSGDEV=MSGDEV;                   /* DEVICE ADDRESS */
         MVC   35(8,@1),30(@4)                                    0399
*      WTO1='*';                         /* TERMINATE WITH AN ERROR */
         MVI   13(@4),C'*'                                        0400
*       GOTO SCH013D;                    /* WTO MESSAGE         X02008*
         BC    15,SCH013D                                         0401
*    END;                                /* END MESSAGE OUTPUT */
*  IF PFPMSG='1'B THEN                   /* TEST FILE PROTECT BIT */
@9CD     TM    A00105+6,B'00010000'                               0403
         BC    12,@9CC                                            0403
*    DO;                                 /* TEST CANCELLED */
*      R1=IFD313;                        /* IFD313 MESSAGE      X02008*
         L     @C,MSGMOD                                          0405
         L     @1,84(0,@C)                                        0405
*      GEN(BAL   R7,SCH027);             /* ISSUE WTO           X02008*
         BAL   R7,SCH027
         DS    0H
*      PFPMSG='0'B;                      /* CLEAR FILE PROTECT BIT */
         NI    A00105+6,B'11101111'                               0407
*      WTO1='*';                         /* TERMINATE WITH AN ERROR */
         MVI   13(@4),C'*'                                        0408
*    END;                                /* END OF FILE PROTECT LOOP */
*  RESTRICT(6);
@9CC     EQU   *                                                  0410
* SCH017:
*  R6=LOGADR;                            /* LOGSCAN ADDRESS IF ANY */
SCH017   L     @6,LOGADR                                          0411
*  IF R6=0 THEN                          /* TEST IF LOGSCAN USED */
         LTR   @6,@6                                              0412
*    GOTO SCH018;                        /* NO LOGSCAN USED */
         BC    08,SCH018                                          0413
*  EOJLOG='1'B;                          /* INDICATE END OF LOGSCAN */
         OI    A00105+6,B'00100000'                               0414
*  R15=R6;                               /* ENTRY TO LOGSCAN */
         LR    @F,@6                                              0415
*  GEN(BALR  R14,R15);                   /* LINK TO LOGSCAN */
         BALR  R14,R15
         DS    0H
*  RELEASE(6);
* SCH018:
*  IF CLEANUP='1'B THEN                  /* CLEAN UP UTS              *
SCH018   TM    A00080+33,B'00000100'                              0418
         BC    12,@9CB                                            0418
*    DO;                                 /* CLEAN UP PRESENT   SA51756*
*    CLEANRT='0'B;                       /* ZERO OLT HAS CLEANUPX03008*
         NI    A00080+36,B'10111111'                              0420
*                                        /* FLAG                X03008*
*      FFEFCE='11'B;                     /* 1ST ERROR BITS     SA51756*
         OI    A00105+5,B'00110000'                               0421
*    GEN(BAL   R7,SCH014AA);             /* GO TO UTS                 *
         BAL   R7,SCH014AA
         DS    0H
*    END;                                /* END CLEAN UP CHECK SA51756*
*  OLTTERM='0'B;                         /* CLEAR OLT FORCED TO Y02008*
@9CB     NI    A00140,B'11111110'                                 0424
*                                        /* TERMINATE FLAG      Y02008*
*  CLEANUP='0'B;                         /* NO CLEANUP                *
         NI    A00080+33,B'11111011'                              0425
*  R7=DEVTBPTR;                          /* DEVICE TABLE       SA51754*
         L     @7,DEVTBPTR                                        0426
*  DO R6=16 TO 1 BY -1;                  /* COUNT OF DEVICES   SA51754*
         LA    @6,16                                              0427
*    IF R7->EXIOACT='0'B THEN            /* CHECK DEVICE       SA51754*
@DO9CA   TM    12(@7),B'00010000'                                 0428
*      GOTO SCH018D;                     /* DEVICE NOT ACTIVE  SA51754*
         BC    08,SCH018D                                         0429
*    DIOCDSAD=R7+32;                     /* CDS ADDRESS         X02008*
         LA    @F,32                                              0430
         AR    @F,@7                                              0430
         ST    @F,DIOPARM+4                                       0430
*    R5=ADDR(IODEVTAB(13));              /* POINT TO 2ND        YM4758*
         LA    @5,IODEVTAB+12                                     0431
*                                        /* IODEVTAB            YM4758*
*    DO INDEX=2 TO 1 BY -1;              /* FIND RIGHT TECB PTR YM4758*
         LA    @F,2                                               0432
         STH   @F,INDEX                                           0432
*    IF R7=DEVPTR THEN                   /* DOES THIS IO DEVTAB Y02008*
@DO9C6   MVC   @TEMP4(4),0(@5)                                    0433
         L     @F,@TEMP4                                          0433
         CR    @F,@7                                              0433
         BC    07,@9C2                                            0433
*                                        /* ENTRY POINT TO      Y02008*
*                                        /* CORRECT DEVTAB ENTRYY02008*
*      DO;                               /* YES, DO DIO PREP    Y02008*
*      R1=IOSBPTR;                       /* REG 1 IS IOSB PTR   Y02008*
         MVC   @TEMP4(4),4(@5)                                    0435
         L     @1,@TEMP4                                          0435
*      DIOTECB=PTRTECB;                  /* PUT TECB PTR IN DIO Y02008*
         MVC   DIOPARM+8(4),112(@1)                               0436
*                                        /* PARMLIST            Y02008*
*      GO TO SCH018C;                    /* GO DO DIO           Y02008*
         BC    15,SCH018C                                         0437
*      END;                              /*                     Y02008*
*    R5=R5+12;                           /* POINT TO NEXT IO    Y02008*
@9C2     AH    @5,@D2                                             0439
*                                        /* DEVTAB              Y02008*
*    END;                                /*                     Y02008*
*  GO TO SCH018C1;                       /* CANNOT FIND CONTROL YM4758*
         LH    @F,INDEX                                           0440
         BCTR  @F,0                                               0440
@DO9C5   STH   @F,INDEX                                           0440
         CH    @F,@D3                                             0440
         BC    10,@DO9C6                                          0440
         BC    15,SCH018C1                                        0441
*                                        /* BLOCK MATCH, BYPASS YM4758*
*                                        /* DIO ATTEMPT         YM4758*
* SCH018C:                               /*                     Y02008*
*    R5=TMCOMAD;                         /* RESTORE REG 5       Y02008*
SCH018C  L     @5,A00023+32                                       0442
*    R1=ADDR(DIOPARM);                   /* DIO PARM LIST      SA51754*
         LA    @1,DIOPARM                                         0443
*    R15=TAB28;                          /* ENTRY POINT        SA51754*
         L     @F,TAB28                                           0444
*    GEN(BALR  R14,R15);                 /* LINK TO DIO        SA51754*
         BALR  R14,R15
         DS    0H
* SCH018C1:                              /*                     YM4758*
*    R7->EXIOACT='0'B;                   /* DEVICE NOT ACTIVE   X02008*
SCH018C1 NI    12(@7),B'11101111'                                 0446
* SCH018D:
*    R7=R7+TABLNGTH;                     /* NEXT DEVICE ENTRY  SA51754*
SCH018D  AH    @7,TABLNGTH                                        0447
*    END;                                /* END DEVICE CHECK   SA51754*
*  IF RTSTAE='1'B THEN                   /* STAE IN CONTROL     X03008*
         BCT   @6,@DO9CA                                          0448
         TM    A00105+6,B'00000001'                               0449
*    GO TO SCH019;                       /* YES% CHECK PLINK    X03008*
         BC    01,SCH019                                          0450
* SCH018F:
*  UTSCAL='0'B;                          /* DELETE MODULES      XM5847*
SCH018F  NI    A00105+6,B'01111111'                               0451
*  R4=IFD158;                            /* TERMINATE MESSAGE   X02008*
         L     @6,MSGMOD                                          0452
         L     @4,48(0,@6)                                        0452
*  IF SCTASTER^='00'B THEN               /* TEST ERROR INDICATORS */
         TM    A00080+3,B'11000000'                               0453
         BC    08,@9C1                                            0453
*    WTO1='*';                           /* TERMINATE ERROR MESSAGE */
         MVI   13(@4),C'*'                                        0454
*  SCTASTER='00'B;                       /* CLEAR ERROR BITS */
@9C1     NI    A00080+3,B'00011111'                               0455
*  CATB1='0'B;                           /* CLEAR CATASTROPHIC OY01377*
*                                        /* ERROR FLAG AT DTERMOY01377*
*                                        /* TIME.              OY01377*
*  IF SUTMSG='1'B THEN                   /* START MSG ISSUED   SA51756*
         TM    A00105+8,B'00000100'                               0457
         BC    12,@9C0                                            0457
*  GEN(BAL   R7,SCH026);                 /* WTO MESSAGE */
         BAL   R7,SCH026
         DS    0H
*  SUTMSG='0'B;                          /* CLEAR BIT          SA51756*
@9C0     NI    A00105+8,B'11111011'                               0459
*  SECPTR=0;                             /* UTS DELETED               *
         SR    @F,@F                                              0460
         ST    @F,SECPTR                                          0460
*  RETCODE=0;                            /* RETURN CODE HANDLED */
         ST    @F,RETCODE                                         0461
*  TERTN='00'X;                          /* ZERO LAST ROUTINE NUMBER */
         MVI   A00006,X'00'                                       0462
*  GEN(EJECT);
         EJECT
         DS    0H
* SCH019:
*  ZIP16=ZIP16&&ZIP16;                   /* ZERO PLINK MORECORE X02008*
SCH019   XC    A00043(16),A00043                                  0464
*  IF RTSTAE='1'B THEN                   /* STAE IN CONTROL           *
         TM    A00105+6,B'00000001'                               0465
*    RETURN;                             /* RETURN TO STAE            *
         BC    03,@EL01                                           0466
*  IF FECOM='0'B THEN                    /* TEST 1ST ERROR */
@9BF     TM    A00080+2,B'00000001'                               0467
         BC    05,@9BE                                            0467
*    CATB1='0'B;                         /* NO 1ST ERROR */
         NI    A00080+3,B'11011111'                               0468
*  IF NPR='0'B                          /* TEST NO PRINT OPTION */
*    NEP='1'B THEN                       /* TEST NO ERROR PRINT */
@9BE     TM    A00080+2,B'00000100'                               0469
         BC    08,@9BD                                            0469
         TM    A00080+3,B'00000100'                               0469
         BC    12,@9BC                                            0469
*       CATB1='0'B;                      /* ZERO CAT BIT IF NO PRINT */
@9BD     NI    A00080+3,B'11011111'                               0470
*  IF CODE5='1'B THEN                    /* TEST IF LOOP BACK */
@9BC     TM    A00105+6,B'00001000'                               0471
*    GOTO SCH002;                        /* RETURN TO START */
         BC    01,SCH002                                          0472
*  IF BYPDEV^='00'B THEN                 /* TEST BYPASS BITS */
         TM    A00105+3,B'01100000'                               0473
*    GOTO SCH022;                        /* BYPASS THIS DEVICE */
         BC    05,SCH022                                          0474
*  IF SNEWRUN='1'B THEN                  /* TEST BIT           SA51756*
         TM    A00105+8,B'00000010'                               0475
*    GOTO SCH001;                        /* NEW DEVICES AND TESTS */
         BC    01,SCH001                                          0476
*  IF LASTSEC='0'B THEN                  /* CHECK SECTION COUNT  M1463*
         TM    A00080+36,B'00000010'                              0477
*    GOTO SCH008;                        /* NEXT SECTION */
         BC    08,SCH008                                          0478
* SCH022:
*  SECRUN='1'B;                          /* ALL SECTIONS RUN */
SCH022   OI    A00105+6,B'00000010'                               0479
* SCH023:
*  UTCOM=UTCOM&&UTCOM;                   /* ZERO OUT PASSON AREA */
SCH023   XC    UTCOM(64),UTCOM                                    0480
*  PRIMBIT='0'B;                         /* CLEAR PRIMARY DEVICE BIT */
         NI    12(@8),B'10111111'                                 0481
*  IF NURUN='1'B THEN                    /* TEST BYPASS ALL DEVICES */
         TM    A00105+3,B'01000000'                               0482
*    GOTO SCH024A;                       /* END TEST RUN */
         BC    01,SCH024A                                         0483
*  BYPDEV='00'B;                         /* ZERO OUT BYPASS SWITCHES */
         NI    A00105+3,B'10011111'                               0484
*  IF NDR='1'B THEN                      /* TEST IF DEVICE REQUIRED */
         TM    A00105+2,B'00000100'                               0485
*    GOTO SCH024;                        /* DEVICE NOT REQUIRED */
         BC    01,SCH024                                          0486
*  IF ONEPRIM='1'B THEN                  /* TEST ONE PRIME DEVICE BIT *
         TM    A00080+33,B'00001000'                              0487
*    GOTO SCH024;                        /* END OF DEVICE TESTING */
         BC    01,SCH024                                          0488
* SCH023L:
*  IF DCNT1^<DCNT2 THEN                  /* TEST DEVICE COUNT */
SCH023L  CLC   DCNT1(1),DCNT2                                     0489
         BC    04,@9BB                                            0489
*      DO;                               /* NO MORE DEVICES TO TEST */
* SCH024:
*        ONEPRIM='0'B;                   /* ZERO ONE PRIME DEVICE BIT *
SCH024   NI    A00080+33,B'11110111'                              0491
*        DCNT1='00'X;                    /* ZERO DEVICE COUNT */
         MVI   DCNT1,X'00'                                        0492
*        IF TLCOUNT>'0000'X&             /* CHECK TEST LOOP COUNT */
*          TLRUN<TLCOUNT THEN            /* CHECK TEST LOOP RUN */
         L     @F,@X17                                            0493
         CH    @F,TLCOUNT                                         0493
         BC    10,@9BA                                            0493
         LH    @F,TLCOUNT                                         0493
         CH    @F,TLRUN                                           0493
         BC    12,@9B9                                            0493
*            DO;                         /* LOOP THRU TESTS AGAIN */
*              TLRUN=TLRUN+1;            /* COUNT TEST RUNS */
         LA    @F,1                                               0495
         AH    @F,TLRUN                                           0495
         STH   @F,TLRUN                                           0495
*              GOTO SCH003;              /* RERUN TESTS */
         BC    15,SCH003                                          0496
*            END;                        /* END OF LOOP CHECK */
* SCH024A:
*        RETURN;                         /* NORMAL RETURN */
*      END;                              /* ALL ACTIONS COMPLETED */
*  GOTO SCH005;                          /* NEXT DEVICE */
* CALLCOMP:
*  COMPUTB='1'B;                         /* COMPUTE ONLY        X02008*
CALLCOMP OI    PARM12+12,B'01000000'                              0501
*  GOTO CALL12;                          /* GO TO LOADER        X02008*
         BC    15,CALL12                                          0502
* CALLOAD:
*  COMPUTB='0'B;                         /* LOAD MODULE         X02008*
CALLOAD  NI    PARM12+12,B'10111111'                              0503
* CALL12:
*  R1=ADDR(LDLIST);
CALL12   LA    @1,LDLIST                                          0504
*  R15=TAB28;                            /* ENTRY POINT         X02008*
         L     @F,TAB28                                           0505
*  GEN(BALR  R14,R15);
         BALR  R14,R15
         DS    0H
*  GOTO R7;
         BCR   15,@7                                              0507
* SCH025:
*  R1=IFD501;                            /* MESSAGE ADDRESS      M1463*
SCH025   L     @6,MSGMOD                                          0508
         L     @1,40(0,@6)                                        0508
*  MSGUTS=PLNAM;                         /* SECTION NAME        S21937*
         MVC   12(8,@1),UTSPL                                     0509
* SCH025A:
*  SLNG1='0000'X;                        /* ZERO SIZE VALUE     X02008*
SCH025A  MVC   3(2,@9),@X7                                        0510
* SCH013D:
*  GEN(BAL   R7,SCH027);                 /* WTO MESSAGE */
SCH013D  BAL   R7,SCH027
         DS    0H
*  GOTO SCH018F;                         /* NEXT TEST           X02008*
         BC    15,SCH018F                                         0512
*  RESTRICT(7);
* SCH026:
*  FEITEMS='0000'B;                      /* ZERO 1ST ERROR ITEM S21937*
SCH026   NI    A00105+5,B'11000011'                               0514
*  IF NCP='0'B THEN                      /* TEST NO CONTROL PRINT */
         TM    A00080+3,B'00001000'                               0515
*    GOTO R7;                            /* NO START OR TERMINATE */
         BCR   08,@7                                              0516
* SCH026A:
*  R1=R4;                                /* MESSAGE ADDRESS */
SCH026A  LR    @1,@4                                              0517
*  GEN;
SCH027   PWTO  REG=(1)                  ISSUE A WTO
         DS    0H
*  GOTO R7;                              /* RETURN TO MAIN FLOW */
         BCR   15,@7                                              0519
* SCH029:
*  PDFLG(2)=CDSFLAG;
SCH029   MVC   A00080+11(1),41(@8)                                0520
*  NDCFO='1'B;                           /* NO DYN COMMUNICATION TEST *
         OI    A00105+2,B'10000000'                               0521
*  UTSCAL='0'B;                          /* UTS NOT CALLED YET */
         NI    A00105+6,B'01111111'                               0522
*  R15=DATPTR;                           /* DATA PROTECT ROOT MODULE */
         L     @F,DATPTR                                          0523
*  GEN(BALR  R14,R15);                   /* GO TO DATA PROTECT */
         BALR  R14,R15
         DS    0H
*  IF CEVOL='1'B THEN                    /* CHECK FOR CE PACK  SA51755*
         TM    13(@8),B'00100000'                                 0525
         BC    12,@9B8                                            0525
*    CEVOLUM='1'B;                       /* CE VOLUME          SA51755*
         OI    A00080+11,B'00100000'                              0526
*  NDCFO='0'B;                           /* TEST DYN COMMUNICATIONS */
@9B8     NI    A00105+2,B'01111111'                               0527
*  IF BYPDEV^='00'B THEN                 /* TEST BYPASS BITS */
         TM    A00105+3,B'01100000'                               0528
*    GOTO SCH023;                        /* BYPASS ONE OR ALL TESTS */
         BC    05,SCH023                                          0529
*  GOTO R7;                              /* RETURN TO MAIN FLOW */
         BCR   15,@7                                              0530
* END;                                   /* END OF MAIN PROCEDURE */
@EL01    L     @D,4(0,@D)                                         0531
         LM    @E,@C,12(@D)                                       0531
         BCR   15,@E                                              0531
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D1      DC    F'0'
@D2      DC    H'12'
@D3      DC    H'1'
         DS    0F
@C13     DC    C'UNIT'
@C14     DC    C'NONE    '
@X17     DC    X'00000000'
@X7      DC    X'0000'
@C8      DC    C'2400W '
         DS    0D
@DATA    EQU   *
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD
X        EQU   00000000            FULLWORD INTEGER
R0       EQU   00000000            FULLWORD POINTER REGISTER
R1       EQU   00000001            FULLWORD POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD POINTER REGISTER
R4       EQU   00000004            FULLWORD POINTER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
R6       EQU   00000006            FULLWORD POINTER REGISTER
R7       EQU   00000007            FULLWORD POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
R9       EQU   00000009            FULLWORD POINTER REGISTER
R10      EQU   00000010            FULLWORD POINTER REGISTER
R11      EQU   00000011            FULLWORD POINTER REGISTER
R12      EQU   00000012            FULLWORD POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
R15      EQU   00000015            FULLWORD POINTER REGISTER
HCODE    EQU   00000132            1 BYTE(S)
A00007   EQU   00000016            4 BYTE(S) ON WORD
WKBY     EQU   A00007+00000000     FULLWORD INTEGER
A00008   EQU   A00007+00000000     2 BYTE(S)
WKBY34   EQU   A00007+00000002     2 BYTE(S)
A00009   EQU   00000000            144 BYTE(S) ON WORD
IFD100   EQU   A00009+00000000     FULLWORD POINTER
A00010   EQU   A00009+00000004     5*FULLWORD POINTER
IFD117   EQU   A00009+00000024     FULLWORD POINTER
IFD121   EQU   A00009+00000028     FULLWORD POINTER
A00011   EQU   A00009+00000032     FULLWORD POINTER
IFD135   EQU   A00009+00000036     FULLWORD POINTER
IFD501   EQU   A00009+00000040     FULLWORD POINTER
A00012   EQU   A00009+00000044     FULLWORD POINTER
IFD158   EQU   A00009+00000048     FULLWORD POINTER
IFD201   EQU   A00009+00000052     FULLWORD POINTER
A00013   EQU   A00009+00000056     6*FULLWORD POINTER
IFD231   EQU   A00009+00000080     FULLWORD POINTER
IFD313   EQU   A00009+00000084     FULLWORD POINTER
IFD502   EQU   A00009+00000088     FULLWORD POINTER
IFD503   EQU   A00009+00000092     FULLWORD POINTER
IFD200   EQU   A00009+00000096     FULLWORD POINTER
A00014   EQU   A00009+00000100     10*FULLWORD POINTER
IFD248   EQU   A00009+00000140     FULLWORD POINTER
A00015   EQU   A00009+00000140     FULLWORD POINTER
IFD227   EQU   00000068            FULLWORD POINTER
A00016   EQU   00000000            45 BYTE(S) ON WORD
A00017   EQU   A00016+00000000     37 BYTE(S)
UT227    EQU   A00016+00000037     8 BYTE(S)
SECLEV   EQU   00000011            1 BYTE(S)
A00018   EQU   00000000            82 BYTE(S) ON WORD
A00019   EQU   A00018+00000000     4 BYTE(S)
MSG100A  EQU   A00018+00000004     78 BYTE(S)
A00020   EQU   A00018+00000004     8 BYTE(S)
MSG100   EQU   A00018+00000012     70 BYTE(S)
SVR8     EQU   @DATA+00000072      FULLWORD INTEGER
A00021   EQU   SVR8+00000000       2 BYTE(S)
SVR834   EQU   SVR8+00000002       2 BYTE(S)
A00022   EQU   SVR8+00000002       1 BYTE(S)
SVR84    EQU   SVR8+00000003       1 BYTE(S)
         ORG   @DATA+00000076
RETCODE  EQU   *                   FULLWORD INTEGER
         DC    FL4'0'
WK1TO8   EQU   00000004            8 BYTE(S)
WK1TO4   EQU   WK1TO8+00000000     4 BYTE(S)
WK5TO8   EQU   WK1TO8+00000004     4 BYTE(S)
A00026   EQU   00000000            16 BYTE(S) ON WORD
INZNM    EQU   A00026+00000000     8 BYTE(S)
INZLV    EQU   A00026+00000008     2 BYTE(S)
INZRT    EQU   A00026+00000010     HALFWORD INTEGER
INZIN    EQU   A00026+00000012     FULLWORD POINTER
A00027   EQU   A00026+00000012     1 BYTE(S)
WANTDONT EQU   00000001            8 BYTE(S)
WANT     EQU   WANTDONT+00000000   4 BYTE(S)
DONTWANT EQU   WANTDONT+00000004   4 BYTE(S)
A00028   EQU   WANTDONT+00000004   1 BYTE(S)
A00029   EQU   00000020            8 BYTE(S) ON WORD
RTSIZ    EQU   A00029+00000000     FULLWORD INTEGER
MOSIZ    EQU   A00029+00000004     FULLWORD INTEGER
A00030   EQU   A00029+00000004     1 BYTE(S)
A00031   EQU   00000000            86 BYTE(S) ON WORD
A00032   EQU   A00031+00000000     19*FULLWORD POINTER
SECID    EQU   A00031+00000076     8 BYTE(S)
RTMSK    EQU   A00031+00000084     2 BYTE(S)
A00033   EQU   00000000            60 BYTE(S) ON WORD
A00034   EQU   A00033+00000000     13 BYTE(S)
WTO12    EQU   A00033+00000013     2 BYTE(S)
WTO1     EQU   A00033+00000013     1 BYTE(S)
A00035   EQU   A00033+00000015     1 BYTE(S)
MSGTEST  EQU   A00033+00000016     8 BYTE(S)
A00036   EQU   A00033+00000016     7 BYTE(S)
OLDTEST  EQU   A00033+00000023     1 BYTE(S)
BLKUNIT  EQU   A00033+00000024     26 BYTE(S)
A00037   EQU   A00033+00000024     1 BYTE(S)
MSGUNIT  EQU   A00033+00000025     22 BYTE(S)
KUNIT    EQU   A00033+00000025     4 BYTE(S)
A00038   EQU   A00033+00000029     1 BYTE(S)
MSGDEV   EQU   A00033+00000030     8 BYTE(S)
A00039   EQU   A00033+00000038     1 BYTE(S)
MSGSYB   EQU   A00033+00000039     8 BYTE(S)
A00040   EQU   A00033+00000047     3 BYTE(S)
MSGVR    EQU   A00033+00000050     1 BYTE(S)
MPCPUID  EQU   A00033+00000051     9 BYTE(S)
A00041   EQU   A00033+00000051     7 BYTE(S)
MSGCPUID EQU   A00033+00000058     2 BYTE(S)
A00042   EQU   A00033+00000050     1 BYTE(S)
TMWK     EQU   00000000            60 BYTE(S) ON WORD
A00045   EQU   TMWK+00000000       36 BYTE(S)
KNT      EQU   TMWK+00000036       8 BYTE(S)
KNAME    EQU   TMWK+00000036       6 BYTE(S)
MODNN    EQU   TMWK+00000044       8 BYTE(S)
MODNN6   EQU   TMWK+00000044       6 BYTE(S)
A00046   EQU   TMWK+00000052       4 BYTE(S)
GTCOR    EQU   TMWK+00000056       FULLWORD POINTER
A00047   EQU   00000000            56 BYTE(S) ON WORD
A00048   EQU   A00047+00000000     56 BYTE(S)
DVEBC    EQU   A00047+00000000     8 BYTE(S)
DVUCB    EQU   A00047+00000008     4  BYTE  POINTER
A00049   EQU   A00047+00000012     8 BIT(S)
A00050   EQU   A00047+00000012     1 BIT(S)
PRIMBIT  EQU   A00047+00000012     1 BIT(S)
A00051   EQU   A00047+00000012     1 BIT(S)
EXIOACT  EQU   A00047+00000012     1 BIT(S)
A00052   EQU   A00047+00000012     1 BIT(S)
GRABIT   EQU   A00047+00000012     1 BIT(S)
A00053   EQU   A00047+00000012     1 BIT(S)
SYMBSSID EQU   A00047+00000012     1 BIT(S)
A00054   EQU   A00047+00000013     19 BYTE(S)
A00055   EQU   A00047+00000013     8 BIT(S)
A00056   EQU   A00047+00000013     1 BIT(S)
LETGOB   EQU   A00047+00000013     1 BIT(S)
CEVOL    EQU   A00047+00000013     1 BIT(S)
DVTABCDS EQU   A00047+00000032     20 BYTE(S)
DVADR    EQU   A00047+00000032     4 BYTE(S)
DVCDS    EQU   A00047+00000036     4 BYTE(S)
A00057   EQU   A00047+00000040     1 BYTE(S)
CDSFLAG  EQU   A00047+00000041     1 BYTE(S)
A00058   EQU   A00047+00000041     4 BIT(S)
SYMBIT   EQU   A00047+00000041     1 BIT(S)
A00059   EQU   A00047+00000042     8 BIT(S)
A00060   EQU   A00047+00000042     1 BIT(S)
SKIPRIM  EQU   A00047+00000042     1 BIT(S)
A00061   EQU   A00047+00000043     1 BYTE(S)
SYMNAME  EQU   A00047+00000044     8 BYTE(S)
A00062   EQU   00000000            20 BYTE(S) ON WORD
A00063   EQU   A00062+00000000     4*FULLWORD INTEGER
DVUDD    EQU   A00062+00000016     4 BYTE(S)
PARM12   EQU   @DATA+00000080      12 BYTE(S) ON WORD
BNAME    EQU   PARM12+00000000     8 BYTE(S)
BNAMCM   EQU   PARM12+00000000     5 BYTE(S)
BNAMVR   EQU   PARM12+00000005     3 BYTE(S)
TARGADR  EQU   PARM12+00000008     FULLWORD INTEGER
         ORG   PARM12+00000012
A00064   EQU   *                   FULLWORD INTEGER
         DC    FL4'0'
FUNC12   EQU   PARM12+00000012     1 BYTE(S)
A00065   EQU   PARM12+00000012     1 BIT(S)
COMPUTB  EQU   PARM12+00000012     1 BIT(S)
A00066   EQU   PARM12+00000012     1 BIT(S)
UTSENVL  EQU   PARM12+00000012     1 BIT(S)
A00067   EQU   PARM12+00000013     1 BYTE(S)
LDLIST   EQU   @DATA+00000096      8 BYTE(S) ON WORD
A00068   EQU   *                   HALFWORD INTEGER
         DC    FL2'2'
A00069   EQU   *                   2 BYTE(S)
         DC    C'12'
A00070   EQU   *                   FULLWORD POINTER
         DC    AL4(PARM12)
UTSPL    EQU   @DATA+00000080      8 BYTE(S) ON WORD
PLNAM    EQU   UTSPL+00000000      8 BYTE(S)
A00071   EQU   UTSPL+00000000      1 BYTE(S)
PLNM15   EQU   UTSPL+00000000      5 BYTE(S)
PLNM68   EQU   UTSPL+00000005      3 BYTE(S)
PLSNM    EQU   UTSPL+00000001      6 BYTE(S)
PLTYPE   EQU   UTSPL+00000001      4 BYTE(S)
PLNAM6   EQU   UTSPL+00000005      2 BYTE(S)
A00072   EQU   UTSPL+00000007      1 BYTE(S)
A00076   EQU   00000000            8 BYTE(S) ON WORD
SNAM1    EQU   A00076+00000000     3 BYTE(S)
SLNG1    EQU   A00076+00000003     2 BYTE(S)
A00077   EQU   A00076+00000003     1 BYTE(S)
A00078   EQU   A00076+00000004     8 BIT(S)
A00079   EQU   A00076+00000004     5 BIT(S)
DBLBIT   EQU   A00076+00000004     2 BIT(S)
OLDUT    EQU   A00076+00000004     1 BIT(S)
SNAM2    EQU   A00076+00000005     3 BYTE(S)
BNAMCMSV EQU   @DATA+00000104      5 BYTE(S)
A00128   EQU   @DATA+00000109      4 BYTE(S)
         ORG   A00128+00000000
MSGSTR   EQU   *                   2 BYTE(S)
         DC    C' S'
MSGEND   EQU   *                   2 BYTE(S)
         DC    C' T'
UTS201   EQU   00000043            8 BYTE(S)
MSG231   EQU   00000000            43 BYTE(S) ON WORD
A00129   EQU   MSG231+00000000     12 BYTE(S)
WMSGTEST EQU   MSG231+00000012     8 BYTE(S)
A00130   EQU   MSG231+00000020     15 BYTE(S)
WMSGDEV  EQU   MSG231+00000035     8 BYTE(S)
RTMASK   EQU   00000070            1 BYTE(S)
MSGUTS   EQU   00000012            8 BYTE(S)
A00131   EQU   00000000            28 BYTE(S) ON WORD
A00132   EQU   A00131+00000000     20 BYTE(S)
WTO4NM   EQU   A00131+00000020     8 BYTE(S)
MSG200   EQU   00000000            25 BYTE(S) ON WORD
A00133   EQU   MSG200+00000000     17 BYTE(S)
NM200    EQU   MSG200+00000017     8 BYTE(S)
DEVTBENT EQU   00000000            12 BYTE(S)
DEVPTR   EQU   DEVTBENT+00000000   4  BYTE  POINTER
IOSBPTR  EQU   DEVTBENT+00000004   4  BYTE  POINTER
A00134   EQU   DEVTBENT+00000008   4 BYTE(S)
IOSB     EQU   00000000            116 BYTE(S) ON WORD
A00135   EQU   IOSB+00000000       112 BYTE(S)
PTRTECB  EQU   IOSB+00000112       FULLWORD POINTER
INDEX    EQU   @DATA+00000114      HALFWORD INTEGER
DIOPARM  EQU   @DATA+00000116      13 BYTE(S) ON WORD
         ORG   DIOPARM+00000000
A00136   EQU   *                   HALFWORD INTEGER
         DC    FL2'2'
A00137   EQU   *                   2 BYTE(S)
         DC    C'44'
DIOCDSAD EQU   DIOPARM+00000004    FULLWORD POINTER
DIOTECB  EQU   DIOPARM+00000008    FULLWORD POINTER
         ORG   DIOPARM+00000012
A00138   EQU   *                   1 BYTE(S)
         DC    X'01'
A00139   EQU   DIOPARM+00000012    1 BYTE(S)
ACTSECT  EQU   @DATA+00000129      8 BYTE(S)
SPCOUNT  EQU   00000018            2 BYTE(S)
OLTADDR  EQU   @DATA+00000140      FULLWORD INTEGER
         ORG   @DATA
         DS    00000148C
@TEMPS   DS    0F
@TEMP4   DC    F'0'
DSECT48  IFDCOM
IFDOLT48 CSECT
CE46     EQU   CESWT4+00000000     3 BYTE(S)
A00000   EQU   PARTITEM+00000000   12 BYTE(S) ON WORD
PARADR   EQU   A00000+00000000     FULLWORD POINTER
PARSZ    EQU   A00000+00000004     FULLWORD INTEGER
RTPLKSZ  EQU   A00000+00000008     FULLWORD INTEGER
DBLZ     EQU   A00000+00000008     2 BYTE(S)
UTSIZ    EQU   A00000+00000010     2 BYTE(S)
A00001   EQU   A00000+00000010     1 BYTE(S)
A00002   EQU   A00000+00000011     8 BIT(S)
A00003   EQU   A00000+00000011     5 BIT(S)
TRPBITS  EQU   A00000+00000011     3 BIT(S)
A00004   EQU   A00000+00000011     2 BIT(S)
CLRBIT   EQU   A00000+00000011     1 BIT(S)
A00005   EQU   A00000+00000011     1 BIT(S)
A00006   EQU   HRTSEL+00000000     2 BYTE(S) ON WORD
TERTN    EQU   A00006+00000000     1 BYTE(S)
HIRTN    EQU   A00006+00000001     1 BYTE(S)
VID      EQU   WKSVC+00000002      2 BYTE(S)
MID1     EQU   MCT+00000010        2 BYTE(S)
TLRUN    EQU   TLCOUNT+00000006    HALFWORD INTEGER
INBF1    EQU   INBUFR+00000000     1 BYTE(S)
A00023   EQU   OLTTAB+00000000     40 BYTE(S) ON WORD
A00024   EQU   A00023+00000000     8*FULLWORD POINTER
TMCOMAD  EQU   A00023+00000032     FULLWORD POINTER
SECPRF   EQU   A00023+00000036     FULLWORD POINTER
A00025   EQU   A00023+00000036     FULLWORD POINTER
A00043   EQU   PLKMOR+00000000     16 BYTE(S) ON WORD
ZIP16    EQU   A00043+00000000     16 BYTE(S)
A00044   EQU   A00043+00000000     8 BYTE(S)
ZIP8     EQU   A00043+00000008     8 BYTE(S)
DCNT1    EQU   UNITUSE+00000000    1 BYTE(S)
DCNT2    EQU   UNICTR+00000000     1 BYTE(S)
SCNT1    EQU   SECTUSE+00000000    1 BYTE(S)
A00073   EQU   SECLST+00000000     12 BYTE(S) ON WORD
A00074   EQU   A00073+00000000     1 BYTE(S)
SCNT2    EQU   A00073+00000001     1 BYTE(S)
SNAM     EQU   A00073+00000002     5 BYTE(S)
A00075   EQU   A00073+00000002     1 BYTE(S)
STYPEN   EQU   A00073+00000003     4 BYTE(S)
SNAMST   EQU   A00073+00000007     5 BYTE(S)
A00080   EQU   CHASCT+00000000     38 BYTE(S) ON WORD
A00081   EQU   A00080+00000000     8 BYTE(S)
ERRLPCT  EQU   A00080+00000000     2 BYTE(S)
A00082   EQU   A00080+00000002     8 BIT(S)
A00083   EQU   A00080+00000002     5 BIT(S)
NPR      EQU   A00080+00000002     1 BIT(S)
INDEFLP  EQU   A00080+00000002     1 BIT(S)
FECOM    EQU   A00080+00000002     1 BIT(S)
A00084   EQU   A00080+00000003     8 BIT(S)
SCTASTER EQU   A00080+00000003     2 BIT(S)
SCTERB   EQU   A00080+00000003     1 BIT(S)
ASTERB   EQU   A00080+00000003     1 BIT(S)
CATB1    EQU   A00080+00000003     1 BIT(S)
AP       EQU   A00080+00000003     1 BIT(S)
NCP      EQU   A00080+00000003     1 BIT(S)
NEP      EQU   A00080+00000003     1 BIT(S)
ERLOP    EQU   A00080+00000003     1 BIT(S)
TSLOP    EQU   A00080+00000003     1 BIT(S)
A00085   EQU   A00080+00000004     3 BYTE(S)
SCTLEV   EQU   A00080+00000007     1 BYTE(S)
DVSEC1   EQU   A00080+00000008     2 BYTE(S)
PDFLG    EQU   A00080+00000010     2 BYTE(S)
A00086   EQU   A00080+00000010     8 BIT(S)
A00087   EQU   A00080+00000011     8 BIT(S)
A00088   EQU   A00080+00000011     2 BIT(S)
CEVOLUM  EQU   A00080+00000011     1 BIT(S)
PDPAD1   EQU   A00080+00000012     8 BYTE(S)
PDPA1    EQU   A00080+00000012     4 BYTE(S)
PDDD1    EQU   A00080+00000016     4 BYTE(S)
A00089   EQU   A00080+00000016     2 BYTE(S)
DCLAS    EQU   A00080+00000018     1 BYTE(S)
DVSEC2   EQU   A00080+00000020     2 BYTE(S)
A00090   EQU   A00080+00000022     2 BYTE(S)
PDPAD2   EQU   A00080+00000024     8 BYTE(S)
PDPA2    EQU   A00080+00000024     4 BYTE(S)
PDDD2    EQU   A00080+00000028     4 BYTE(S)
A00091   EQU   A00080+00000032     1 BYTE(S)
A00092   EQU   A00080+00000033     8 BIT(S)
A00093   EQU   A00080+00000033     3 BIT(S)
ERRCNT   EQU   A00080+00000033     1 BIT(S)
ONEPRIM  EQU   A00080+00000033     1 BIT(S)
CLEANUP  EQU   A00080+00000033     1 BIT(S)
A00094   EQU   A00080+00000034     2 BYTE(S)
A00095   EQU   A00080+00000036     8 BIT(S)
A00096   EQU   A00080+00000036     1 BIT(S)
CLEANRT  EQU   A00080+00000036     1 BIT(S)
A00097   EQU   A00080+00000036     4 BIT(S)
LASTSEC  EQU   A00080+00000036     1 BIT(S)
DYCOM    EQU   A00080+00000036     1 BIT(S)
A00098   EQU   A00080+00000037     8 BIT(S)
TALKFLAG EQU   A00080+00000037     1 BIT(S)
A00099   EQU   A00080+00000037     1 BYTE(S)
CDS8TO19 EQU   CHASCT+00000020     12 BYTE(S)
A00100   EQU   CHASCT+00000004     66 BYTE(S) ON WORD
SCTWD17  EQU   A00100+00000000     28 BYTE(S)
RTNM1ST  EQU   A00100+00000000     2 BYTE(S)
A00101   EQU   A00100+00000028     1 BYTE(S)
A00102   EQU   A00100+00000029     8 BIT(S)
A00103   EQU   A00100+00000029     2 BIT(S)
CSELRTN  EQU   A00100+00000029     1 BIT(S)
A00104   EQU   A00100+00000030     6 BYTE(S)
RTNMLST  EQU   A00100+00000036     30 BYTE(S)
A00105   EQU   CESWT+00000000      9 BYTE(S) ON WORD
A00106   EQU   A00105+00000000     8 BIT(S)
A00107   EQU   A00105+00000000     2 BIT(S)
OORN     EQU   A00105+00000000     2 BIT(S)
OUTS     EQU   A00105+00000000     1 BIT(S)
NUTS     EQU   A00105+00000000     1 BIT(S)
A00108   EQU   A00105+00000001     8 BIT(S)
A00109   EQU   A00105+00000001     1 BIT(S)
SEEK2321 EQU   A00105+00000001     1 BIT(S)
T2321T   EQU   A00105+00000001     1 BIT(S)
A00110   EQU   A00105+00000001     2 BIT(S)
T2321    EQU   A00105+00000001     1 BIT(S)
A00111   EQU   A00105+00000001     1 BIT(S)
TPFLAG   EQU   A00105+00000001     1 BIT(S)
A00112   EQU   A00105+00000002     8 BIT(S)
NDCFO    EQU   A00105+00000002     1 BIT(S)
DPONDEV  EQU   A00105+00000002     1 BIT(S)
A00113   EQU   A00105+00000002     3 BIT(S)
NDR      EQU   A00105+00000002     1 BIT(S)
TAPEHDR  EQU   A00105+00000002     1 BIT(S)
A00114   EQU   A00105+00000003     8 BIT(S)
OSTWTOR  EQU   A00105+00000003     1 BIT(S)
BYPDEV   EQU   A00105+00000003     2 BIT(S)
NURUN    EQU   A00105+00000003     1 BIT(S)
NUDEV    EQU   A00105+00000003     1 BIT(S)
A00115   EQU   A00105+00000003     2 BIT(S)
TP1419   EQU   A00105+00000003     1 BIT(S)
CE45     EQU   A00105+00000004     2 BYTE(S)
CE4      EQU   A00105+00000004     8 BIT(S)
CE5      EQU   A00105+00000005     8 BIT(S)
A00116   EQU   A00105+00000005     2 BIT(S)
FEITEMS  EQU   A00105+00000005     4 BIT(S)
FFEFCE   EQU   A00105+00000005     2 BIT(S)
CE6      EQU   A00105+00000006     8 BIT(S)
UTSCAL   EQU   A00105+00000006     1 BIT(S)
A00117   EQU   A00105+00000006     1 BIT(S)
EOJLOG   EQU   A00105+00000006     1 BIT(S)
PFPMSG   EQU   A00105+00000006     1 BIT(S)
CODE5    EQU   A00105+00000006     1 BIT(S)
NORUN    EQU   A00105+00000006     1 BIT(S)
SECRUN   EQU   A00105+00000006     1 BIT(S)
RTSTAE   EQU   A00105+00000006     1 BIT(S)
A00118   EQU   A00105+00000007     8 BIT(S)
A00119   EQU   A00105+00000007     2 BIT(S)
REMOTE   EQU   A00105+00000007     1 BIT(S)
A00120   EQU   A00105+00000007     3 BIT(S)
VIRTUAL  EQU   A00105+00000007     1 BIT(S)
CE8      EQU   A00105+00000008     8 BIT(S)
A00121   EQU   A00105+00000008     3 BIT(S)
READDCHK EQU   A00105+00000008     1 BIT(S)
OLTINVV  EQU   A00105+00000008     1 BIT(S)
SUTMSG   EQU   A00105+00000008     1 BIT(S)
SNEWRUN  EQU   A00105+00000008     1 BIT(S)
A00122   EQU   A00105+00000008     1 BIT(S)
A00123   EQU   CESWTR+00000000     1 BYTE(S)
RETAINAC EQU   A00123+00000000     1 BIT(S)
REMERR   EQU   A00123+00000000     1 BIT(S)
REMNOMSG EQU   A00123+00000000     1 BIT(S)
CENOMSG  EQU   A00123+00000000     1 BIT(S)
PRTNOMSG EQU   A00123+00000000     1 BIT(S)
IMRESP   EQU   A00123+00000000     1 BIT(S)
EXECOUT  EQU   A00123+00000000     1 BIT(S)
CECOMOUT EQU   A00123+00000000     1 BIT(S)
A00124   EQU   CESWTR1+00000000    1 BYTE(S)
A00125   EQU   A00124+00000000     2 BIT(S)
CECOMANS EQU   A00124+00000000     1 BIT(S)
A00126   EQU   A00124+00000000     2 BIT(S)
REMANS   EQU   A00124+00000000     1 BIT(S)
A00127   EQU   A00124+00000000     2 BIT(S)
A00140   EQU   CESWT9+00000000     1 BYTE(S)
A00141   EQU   A00140+00000000     2 BIT(S)
VRCAP    EQU   A00140+00000000     1 BIT(S)
A00142   EQU   A00140+00000000     4 BIT(S)
OLTTERM  EQU   A00140+00000000     1 BIT(S)
A00143   EQU   CESWT10+00000000    1 BYTE(S)
MPSYS    EQU   A00143+00000000     1 BIT(S)
@DATEND  EQU   *
@9F5     EQU   SCH006
SCH024A  EQU   @EL01
@9BA     EQU   @EL01
@9B9     EQU   @EL01
@9BB     EQU   SCH005
@DO9F8   EQU   SCH024A
         END    ,(C'PL/S',1400,76153)

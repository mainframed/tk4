         TITLE 'IFCIOHND-IO SERVICES MODULE FOR IFCEREP1               *
                        '
IFCIOHND CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCIOHND  78.012'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@06,20(@13)                                     0001
         STM   @08,@12,52(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @10,4095(,@11)                                      0001
         LA    @09,4095(,@10)                                      0001
         LA    @08,4095(,@09)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         USING @PSTART+12285,@08                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*DCL ADDNUM(1) CHAR(1) BASED(ADDNXT);                      /*@Z427VLS*/
*DCL NEXTBY FIXED(31) INIT(0);                             /*@Z427VLS*/
*DCL ADDNXT FIXED(31) INIT(0);                             /*@Z427VLS*/
*DCL NUMBER FIXED(31) INIT(0);                             /*@Z427VLS*/
*DCL GETTIT CHAR(4) DEFINED(GETHIS); /*ALPHA ACCESS OF GETHIS*/    0069
*DCL LISTPTR PTR(31) BASED(PTRSPOT); /*POINTER TO LIST PARAMETER*/ 0070
*DCL INARG  FIXED(15) BASED(LISTPTR); /*INPUT PARAMETER WITH @Z427VLS*/
*                                     /*SERVICE REQUESTED CODE*/   0072
*DCL LINECTT FIXED(15) INIT(0); /*RUNNING LINE COUNT FOR PAGE SKIPIN */
*DCL LINEMAX FIXED(15) INIT(0); /*MAXIMUM LINES PER PAGE, TOURIST*/
*DCL CCSAVE  CHAR(1) INIT(' '); /*CARRIAGE CONTROL CHAR SAVE SPOT*/
*DCL BLANKS CHAR(134) INIT(' '); /*BLANKS FOR PRINT LINE     @Z427VLS*/
*DCL MSGNO  FIXED(31)  INIT(0); /*MESSAGE TEXT INDEX         @Z427VLS*/
*DCL BADNEWS FIXED(31) INIT(0); /*RETURN CODE SAVE ITEM      @Z427VLS*/
*DCL PACKPAS  CHAR(4) INIT('    ');                        /*@Z427VLS*/
*DCL CHARPAS  CHAR(8) INIT('        ');                    /*@Z427VLS*/
*DCL PASSNUM  FIXED(31) INIT(0);                           /*@Z427VLS*/
*DCL EDIFILD(9) CHAR(1);                                   /*@Z427VLS*/
*DCL EDFLD CHAR(9) DEFINED(EDIFILD);                       /*@Z427VLS*/
*DCL CTPTR(10) FIXED(31) DEFINED(CONTPTR);                 /*@Z427VLS*/
*DCL CHARS CHAR(16) INIT('0123456789ABCDEF');              /*@Z427VLS*/
*/********************************************************************/
*DCL CLOSEALL BIT(16) CONSTANT('FFFF'X); /*EOF ALL CLOSED MASK*/   0085
*DCL SKIPNEW BIT(8) CONSTANT('8B'X);          /* SKIP TO CHANNEL ONE*/
*DCL NODSETS BIT(16) CONSTANT('0000'X); /*NO DATA SETS ASKED OPEN*/
*DCL DBLWORD BIT(32) CONSTANT('00000007'X); /*NO DOUBLE WORD MASK*/
*DCL NULL    BIT(32) CONSTANT('00000000'X);                /*@Z427VLS*/
*DCL CHARZERO BIT(8) CONSTANT('F0'X);                      /*@Z427VLS*/
*DCL BLANK    BIT(8) CONSTANT('40'X);                      /*@Z427VLS*/
*/********************************************************************/
*DCL  1  IOPLINE  CHAR(134)  BASED(PRINTADR), /*PRINT WORK AREA DSECT*/
*      2 PRINTDS  CHAR(1), /*DATA SET IS ERREPT IF F0        @Z427VLS*/
*                          /*DATA SET IS TOURIST IF F1       @Z427VLS*/
*      2 PRINTCC  CHAR(1), /*CARRIAGE CONTROL CHARACTER, IGNORED*/ 0092
*                          /*IF FROM USER FOR TOURIST DATA SET*/   0092
*      2 PRINTBDY CHAR(132); /*LINE TO BE PRINTED, WILL BE CLEARED*/
*                            /*TO BLANKS BEFORE RETURN TO USER*/   0093
*DCL 1 ERRLINE(29), /*INTERNAL DEBUG15 MESSAGES              @G51DGBB*/
*    2 ERRDS CHAR(1) INIT((29)'1'),                                0093
*    2 ERRCS CHAR(1) INIT((29)' '),                                0093
*    2 PRINTNM CHAR(9) INIT((29)'DEBUG15  '),                      0093
*    2 PRNTXT CHAR(40)                                             0093
*INIT('SERLOG OPEN ATTEMPTED                   ',  /*53      @Z427VLS*/
*     'CHECK HEADER FOR MORE RECORDS ATTEMPTED ', /*54       @Z427VLS*/
*     'RESET OF SERLOG HEADER ATTEMPTED        ', /*55       @Z427VLS*/
*     'SERLOG CLOSE ATTEMPTED                  ', /*56       @Z427VLS*/
*     'ZEROALL ATTEMPTED                       ', /*57       @Z427VLS*/
*     'SDR COUNTER DUMP ATTEMPTED              ', /*58       @Z427VLS*/
*     'SYSIN OPEN ATTEMPTED                    ', /*59       @Z427VLS*/
*     'SYSIN CLOSE ATTEMPTED                   ', /*60       @Z427VLS*/
*     'DIRECTWK CLOSE FOR WRITING ATTEMPTED    ', /*61       @Z427VLS*/
*     'DIRECTWK CLOSE FOR READING ATTEMPTED    ', /*62       @Z427VLS*/
*     'DIRECTWK OPEN FOR WRITE ATTEMPTED      ', /*63        @Z427VLS*/
*     'ACCIN OPEN ATTEMPTED                    ', /*64       @Z427VLS*/
*     'ACCIN CLOSE ATTEMPTED                   ', /*65       @Z427VLS*/
*     'ACCDEV CLOSE ATTEMPTED                  ', /*66       @Z427VLS*/
*     'EREPPT OPEN ATTEMPTED                   ', /*67       @Z427VLS*/
*     'EREPPT CLOSE ATTEMPTED                  ', /*68       @Z427VLS*/
*     'ACCDEV OPEN ATTEMPTED                   ',  /*69TH ENTRY*/  0093
*     'FIRST FRAME READ ATTEMPT                ',                  0093
*     'TIMES IFCIOHND EXITED WITH R.C.12       ', /*70       @Z427VLS*/
*     'SERLOG SEQUENTIAL READ ATTEMPTS         ', /*71       @Z427VLS*/
*     'SERLOG DIRECT READ ATTEMPTS             ', /*72       @Z427VLS*/
*     'TIME CONVERSION NECESSARY NUM. TIMES    ', /*73       @Z427VLS*/
*     'RECORDS SAVED DURING ZEROALL PROCESSING ', /*74       @Z427VLS*/
*     'SYSIN READ ATTEMPTS                     ', /*75       @Z427VLS*/
*     'DIRECTWK WRITE ATTEMPTS                 ', /*76       @Z427VLS*/
*     'DIRECTWK READ ATTEMPTS                  ', /*77       @Z427VLS*/
*     'ACCIN SEQUENTIAL READ ATTEMPTS          ', /*78       @Z427VLS*/
*     'ACCDEV WRITE ATTEMPTS                   ',                  0093
*     'FRAME READ ATTEMPTS OF SYS1.LOGREC      ');         /*@G51DGBB*/
*DCL MACHCODE(256) CHAR(1) /* ENSURE VALID MACHINE CODE      @ZA18999*/
*INIT( (11)'09'X,'0B'X,(5)'09'X,'11'X,'09'X,'13'X,(5)'09'X,        0094
*      '19'X,'09'X,'1B'X,(109)'09'X,'89'X,'09'X,'8B'X,             0094
*       (5)'09'X,'91'X,'09'X,'93'X,(5)'09'X,'99'X,                 0094
*       '09'X,'9B'X,(5)'09'X,'A1'X,'09'X,'A3'X,                    0094
*       (5)'09'X,'A9'X,'09'X,'AB'X,(5)'09'X,'B1'X,                 0094
*       '09'X,'B3'X,(5)'09'X,'B9'X,'09'X,'BB'X,(5)'09'X,           0094
*       'C1'X,'09'X,'C3'X,(5)'09'X,'C9'X,'09'X,'CB'X,              0094
*       (5)'09'X,'D1'X,'09'X,'D3'X,(5)'09'X,'D9'X,                 0094
*        '09'X,'DB'X,(5)'09'X,'E1'X,'09'X,'E3'X,(20)'09'X);/*@ZA18999*/
*/********************************************************************/
*DCL PRNTBF CHAR(134) BDY(DWORD); /*INTERNAL PRINT LINE BUFFER*/   0095
*/********************************************************************/
*DCL 1  BUF1 BDY(DWORD), /*WORK AREA FOR QSAM RECORDS        @Z427VLS*/
*     2 BUF1RDW, /*RECORD DESCRIPTOR WORD                    @Z427VLS*/
*     3 BUF1RDWL FIXED(15) INIT(0), /*QSAM RECORD LENGTH     @Z427VLS*/
*     3 BUF1L    FIXED(15) INIT(0), /*QSAM ZEROS             @Z427VLS*/
*     2 BUF1DTA  CHAR(2000);    /*MAXIMUM SYS1.LOGREC RECORD LENGTH*/
*/*******************************************************************/
*DCL  1 RECTB BASED(RUNPTR), /*ZEROALL RECORD SAVE AREA DSECT*/    0097
*     2 FORPTR  PTR(31),                                           0097
*     2 JUNK,                                                      0097
*     3 JUNK1   CHAR(5),                                           0097
*     3 JUNK2   CHAR(1),                                           0097
*     3 JUNK3   FIXED(15),                                         0097
*     2 RECSPT  CHAR(1894);                                /*@Z427VLS*/
*/*******************************************************************/
* DCL 1 IOSWTCH CHAR(3) INIT('000000'X), /*NEW SWITCHES      @Z427VLS*/
*     2 HISTOPN BIT(1), /*OUTPUT HIST IS OPENED FLAG         @Z427VLS*/
*     2 SECGET   BIT(1), /*ZEROALL GETMAIN SWITCH            @Z427VLS*/
*     2 FLIPFLOP BIT(1), /*OFF SERLOG READSEQ, ON ACCIN READSEQ*/  0098
*     2 HISTYES BIT(1), /*INDICATES ACCIN INPUT SPECIFIED    @Z427VLS*/
*     2 DBLYES  BIT(1), /*DOUBLE WORD CREATION LOOP EXIT SWITCH*/  0098
*     2 LASTLOOP BIT(1),  /*ZEROALL PROCESSING               @Z427VLS*/
*     2 TOURERR BIT(1), /*ERROR WITH TOURIST DATA SET        @Z427VLS*/
*     2 INHISO  BIT(1), /*INPUT HIST IS IPENED FLAG          @Z427VLS*/
*     2 SERLO   BIT(1), /*SERLOG IS OPENED FLAG              @Z427VLS*/
*     2 TWOTRY  BIT(1), /*OFF IMPLIES 1ST EOF READING SERLOG SEQ.*/
*     2 INDIR   BIT(1), /*DIRECTWK IS OPENED FOR SEQ WRITE   @Z427VLS*/
*     2 NONBLANK BIT(1), /*NONBLANK LOOP FINDER SWITCH       @Z427VLS*/
*     2 CLOSE2  BIT(1), /*DIRECTWK IS OPENED FOR DIR WRITE   @Z427VLS*/
*     2 SYSOPN  BIT(1), /*SYSIN IS OPENED SWITCH             @Z427VLS*/
*     2 TOUROPN  BIT(1), /*TOURIST DS IS OPENED SWITCH       @Z427VLS*/
*     2 ERPTOPN  BIT(1), /*REGULAR PRINT D.S. HAS BEEN OPENED*/    0098
*    2 READFR   BIT(1), /*FRAMES ARE BEING READ SWITCH       @G51DGBB*/
*    2 SCRATCH  BIT(1), /*LAST OPERATION WAS READ DIRECT     @G51DGBB*/
*     2 SNAPOP  BIT(1); /*SNAP DS HAS BEEN OPENED SWITCH     @Z427VLS*/
*/********************************************************************/
*DCL    1   HDRBUFF   CHAR(64) BDY(DWORD),   /* EXTRACTOR WORK AREA  */
*          2   HDRSEEK             CHAR(8),  /* SEEK FIELD FOR I/O   */
*             3   HDRM             CHAR(1) INIT('00'X),            0099
*             3   HDRBB            CHAR(2) INIT('0000'X),          0099
*             3   HDRCC            CHAR(2) INIT('0000'X),          0099
*             3   HDRHH            CHAR(2) INIT('0000'X),          0099
*             3   HDRR             CHAR(1) INIT('00'X),            0099
*          2   HEADER              CHAR(40), /* HEADER REC - LOGREC  */
*             3   HDRKEY           CHAR(2),  /* FF00-HDR SOURCE FLD  */
*             3   HDRSCC           CHAR(2),  /* START OF     @Z427VLS*/
*             3   HDRSHH           CHAR(2),  /* SYS1.LOGREC  @Z427VLS*/
*             3   HDRECC           CHAR(2),  /* END OF       @Z427VLS*/
*             3   HDREHH           CHAR(2),  /* SYS1.LOGREC  @Z427VLS*/
*             3   HDRCOUNT         CHAR(1),  /* COUNT OF FULL MSG */
*             3   HDRREC1          CHAR(7),  /* CCHHR OF 1ST REC     */
*                4   HDR1BB        CHAR(2),                        0099
*                4   HDR1CC        CHAR(2),                        0099
*                4   HDR1HH        CHAR(2),                        0099
*                4   HDR1R         CHAR(1),                        0099
*             3   HDRREM           CHAR(2),  /* NO. OF BYTES REMAING */
*             3   HDRTRKCP         CHAR(2),  /* TRK CAPACITY @Z427VLS*/
*             3   HDRREC2          CHAR(7),  /* LAST ACTIVE RECORD   */
*                4   HDR2BB        CHAR(2),                        0099
*                4   HDR2CC        CHAR(2),                        0099
*                4   HDR2HH        CHAR(2),                        0099
*                4   HDR2R         CHAR(1),                        0099
*             3   HDRUCBNO         CHAR(2),  /* NO. OF UCB'S @Z427VLS*/
*             3   HDREXSZE         CHAR(2),  /* NO. OF TRK'S @Z427VLS*/
*             3   HDRTYPE          CHAR(1),  /* RES TYPE     @Z427VLS*/
*             3   *                CHAR(4),                        0099
*             3   *                CHAR(1),                        0099
*                4   HDRWNGBT       BIT(1),  /* 90% FULL SWITCH      */
*                4   *              BIT(1),                        0099
*                4   FRAMES         BIT(1), /*FRAMES EXIST FLAG*/  0099
*                4   *              BIT(4),                        0099
*             3   HDRSAFE          CHAR(1),  /* X'FF' INDICATES RECOK*/
*          2   PREVSEEK            CHAR(8),  /* PREVIOUS SEEK FIELD  */
*             3   PREVM            CHAR(1) INIT('FF'X), /* FF=CLOSED */
*             3   PREVBB           CHAR(2),                        0099
*             3   PREVCC           CHAR(2),                        0099
*             3   PREVHH           CHAR(2),                        0099
*             3   PREVR            CHAR(1);                /*@G51DGBB*/
*DCL     LOGRECA    CHAR(11) INIT('SYS1.LOGREC'); /* ENQUE/DEQUE     */
*DCL     LOGRECB    CHAR(8)  INIT('RECORDER');    /* NAMES FOR SYSTEM*/
*DCL     RESID      CHAR(8)  INIT('SERLOG');      /* & STEP ENQ/DEQ  */
*DCL     RESIDII    CHAR(8)  INIT('LOGREC');      /*         @Z427VLS*/
*DCL     SDRK  FIXED(15) INIT(0);                          /*@Z427VLS*/
*DCL     ZEROA CHAR(24);                                   /*@Z427VLS*/
*DCL 1 SEEKSAVE CHAR(8) INIT('0000000000000000'X), /*BEGINNING OF LOG*/
*    2 *      CHAR(7),                                             0106
*    2 SKSAVREC CHAR(1); /*R PORTION OF MBBCCHHR             @G51DGBB*/
*DCL     BYTESREM(14) FIXED(15)                             /*XL03145*/
*                        INIT(00000,    /* SPARE  CODE 00    @Z427VLS*/
*                             03419,    /* 2311   CODE 01    @Z427VLS*/
*                             20137,    /* 2301   CODE 02    @Z427VLS*/
*                             04596,    /* 2303   CODE 03    @Z427VLS*/
*                             04778,    /* 2302   CODE 04    @Z427VLS*/
*                             00000,    /* SPARE  CODE 05    @Z427VLS*/
*                             13192,    /* 2305-1 CODE 06    @Z427VLS*/
*                             14184,    /* 2305-2 CODE 07    @Z427VLS*/
*                             07008,    /* 2314   CODE 08    @Z427VLS*/
*                             12680,    /* 3330   CODE 09    @Z427VLS*/
*                             07954,    /* 3340   CODE 0A    @Z427VLS*/
*                             18800,    /* 3350   CODE 0B    @Z40RIVS*/
*                             00000,    /* SPARE  CODE 0C    @Z427VLS*/
*                             12680);   /* 3330-1 CODE 0D    @Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      ECB,IOB,& CCW'S FOR EXCP                            @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*DCL    1   XWRECB  FIXED(31) INIT(0),  /* ECB               @Z427VLS*/
*          2   POST      CHAR(1),                                  0108
*          2   *         CHAR(3);                          /*@Z427VLS*/
*DCL    1   XIOB    CHAR(40) BDY(DWORD),                           0109
*          2   XIOBFL1   CHAR(1) INIT('42'X),                      0109
*          2   XIOBFL2   CHAR(1) INIT('00'X),                      0109
*          2   XIOBSNS0  CHAR(1) INIT('00'X),                      0109
*          2   XIOBSNS1  CHAR(1) INIT('00'X),                      0109
*          2   XIOBECB   PTR(31) INIT(ADDR(XWRECB)),               0109
*          2   XIOBCSW   CHAR(8) INIT('0000000000000000'X),        0109
*          2   XIOBCCW   PTR(31) INIT(ADDR(SEQ)),                  0109
*          2   XIOBDCB   PTR(31),                                  0109
*          2   XIOBRA    PTR(31) INIT(0),                          0109
*          2   XIOBBEC   FIXED(31) INIT(0),                        0109
*          2   XIOBSEEK  CHAR(8),                                  0109
*             3   XIOBM  CHAR(1)  INIT('00'X),                     0109
*             3   XIOBBB CHAR(2)  INIT('0000'X),                   0109
*             3   XIOBCC CHAR(2)  INIT('0000'X),                   0109
*             3   XIOBHH CHAR(2)  INIT('0000'X),                   0109
*             3   XIOBR  CHAR(1)  INIT('00'X);             /*@Z427VLS*/
*DCL    1   SWITCH  BIT(8) INIT('00'X), /* INTERNAL SWITCH   @Z427VLS*/
*          2   SBT0      BIT(1),        /* DISK OPEN         @Z427VLS*/
*          2   SBT2      BIT(1),        /* WRITE REQUIRED    @Z427VLS*/
*          2   SBT3      BIT(1),        /*                   @Z427VLS*/
*          2   SBT4      BIT(1),        /* HEADER RECORD I/O @Z427VLS*/
*          2   SBT7      BIT(1);        /* INTERNAL ENQ ISSUED       */
*DCL    1   SEQ     CHAR(24) BDY(DWORD),/* CCW STRING        @Z427VLS*/
*          2   SID1       CHAR(8),                /* SEARCH ID EQUAL */
*             3   *       CHAR(1) INIT('31'X),                     0111
*             3   AREAADR PTR(24) BDY(BYTE),      /* PTR TO COUNT FLD*/
*             3   *       CHAR(2) INIT('4000'X),                   0111
*             3   *       FIXED(15) BDY(BYTE) INIT(5),             0111
*          2   TIC1       CHAR(8),                /* TRANSFER IN CHAN*/
*            3    *       CHAR(1) INIT('08'X),                     0111
*             3   *       PTR(24) BDY(BYTE) INIT(ADDR(SID1)),      0111
*             3   *       CHAR(2) INIT('4000'X),                   0111
*             3   *       FIXED(15) BDY(BYTE) INIT(1),             0111
*          2   CKD1       CHAR(8),                /* R/W COUNT KEY & */
*             3   CKDCOM  CHAR(1),                /* DATA    @Z427VLS*/
*             3   CKDAREA  PTR(24) BDY(BYTE),     /* DATA PTR        */
*             3   CKDCHAIN CHAR(1) INIT('20'X),                    0111
*             3   *        CHAR(1) INIT('00'X),                    0111
*             3   CKDCOUNT FIXED(15) BDY(BYTE);   /* SIZE OF RECORD  */
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      CONSTANTS & WORK AREAS FOR TIME/DATE CONVERSION     @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*DCL    1   WORK8   CHAR(8) BDY(DWORD),                            0112
*          2   WORK         FIXED(31),                             0112
*          2   WORKB        FIXED(31),                             0112
*             3   WHOURS     CHAR(1),                              0112
*             3   WMINS      CHAR(1),                              0112
*             3   WDAYS      CHAR(2),                              0112
*                4   WSECS   CHAR(1),                              0112
*                4   WTNTHS  CHAR(1);                      /*@Z427VLS*/
*DCL     TIMDIV     FIXED(31);                             /*@Z427VLS*/
*DCL     MILLION    FIXED(31) INIT(1000000);               /*@Z427VLS*/
*DCL     TWENTY4    FIXED(31) INIT(24);                    /*@Z427VLS*/
*DCL     SIXTY      FIXED(31) INIT(60);                    /*@Z427VLS*/
*DCL     CONSTG     FIXED(31) INIT('30040'X);              /*@Z427VLS*/
*DCL     CONSTH     FIXED(31) INIT('24AE062'X);            /*@Z427VLS*/
*DCL     SIXTYMIL   FIXED(31) INIT(60000000);              /*@Z427VLS*/
*DCL     PATCH(20) FIXED(15) INIT((20)0);    /* PATCH AREA   @Z427VLS*/
*GENERATE DATA;                                            /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      BASED DCL'S                                         @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      DSECT OF HEADER                                     @Z427VLS*/
*/*                                                          @Z427VLS*/
*DCL    1   OHEADER           CHAR(40) BASED(R4),                  0122
*          2   OHDRKEY        CHAR(2),                             0122
*          2   OHDRSCC        CHAR(2),                             0122
*          2   OHDRSHH        CHAR(2),                             0122
*          2   OHDRECC        CHAR(2),                             0122
*          2   OHDREHH        CHAR(2),                             0122
*          2   OHDRHI         CHAR(1),                             0122
*          2   OHDRREC1       CHAR(7),                             0122
*             3   OHDR1BB     CHAR(2),                             0122
*             3   OHDR1CC     CHAR(2),                             0122
*             3   OHDR1HH     CHAR(2),                             0122
*             3   OHDR1R      CHAR(1),                             0122
*          2   OHDRREM        CHAR(2),                             0122
*          2   OHDRTRXC       CHAR(2),                             0122
*          2   OHDRREC2       CHAR(7),                             0122
*             3   OHDR2BB     CHAR(2),                             0122
*             3   OHDR2CC     CHAR(2),                             0122
*             3   OHDR2HH     CHAR(2),                             0122
*             3   OHDR2R      CHAR(1),                             0122
*          2   OHDRUCBN       CHAR(2),                             0122
*          2   OHDREXSZ       CHAR(2),                             0122
*          2   OHDRTYP        CHAR(1),                             0122
*          2   *              CHAR(5),                             0122
*          2   OHDRSAFE       CHAR(1);                     /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/*      DSECT OF INPUT BUFFER                               @Z427VLS*/
*/*                                                          @Z427VLS*/
*DCL    1   BUFFER  DEFINED(BUF1), /*USE FOR SERLOP EXCP READS*/   0123
*          2   BCOUNT              CHAR(8),  /* COUNT AREA   @Z427VLS*/
*             3   BCCHHR           CHAR(5),  /* COUNT FROM REC       */
*             3   BKEYL            CHAR(1),  /* KEY LENGTH=0 @Z427VLS*/
*             3   BSIZE            CHAR(2),  /* SIZE OF RECORD READ  */
*          2   BDATA                 CHAR(1900);           /*@G51DGBB*/
*DCL  BSZ FIXED(15) DEFINED(BSIZE); /*ACCESS BSIZE AS NUMERIC*/    0124
*DCL SAVELENT FIXED(15) INIT(0); /*DATA LENGTH + 4 FROM READSEQ*/  0125
*DCL  BBRDW CHAR(2) DEFINED(BCCHHR) POSITION(5); /*USE TO SHUFFLE*/
*                                /*LOGREC RECORD INTO V FORMAT*/   0127
*/*                                                          @Z427VLS*/
*/*      DSCECT OF AN INPUT RECORD                           @Z427VLS*/
*/*                                                          @Z427VLS*/
*DCL    1   RECAREA              BASED(TIMEBASE),                  0127
*          2   RECKEY              CHAR(1),                        0127
*          2   *                   CHAR(1),                        0127
*          2   *                   CHAR(6),                        0127
*             3   *                 BIT(1),                        0127
*             3   NSSWITCH          BIT(1),  /* NS TIME INDICATOR    */
*             3   *                 BIT(2),                        0127
*             3   LCSWITCH          BIT(1),  /* LOCAL TIME  INDICATOR*/
*             3   *                 BIT(3),                        0127
*          2   DATETIME            CHAR(8),                        0127
*             3   DATE             CHAR(4),                        0127
*                4   DATE0         CHAR(1),                        0127
*                   5   GMTSW       BIT(1),                        0127
*                   5   *           BIT(7),                        0127
*                4   YEAR          CHAR(1),                        0127
*                4   DAYS          CHAR(2),                        0127
*             3   TIME             CHAR(4),                        0127
*                4   HOURS         CHAR(1),                        0127
*                4   MINS          CHAR(1),                        0127
*                4   SECS          CHAR(1),                        0127
*                4   TNTHS         CHAR(1);                /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      EQUATES                                             @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*GENERATE ;                                                /*@Z427VLS*/
L0       EQU   0
L1       EQU   1
L2       EQU   2
L4       EQU   4
L6       EQU   6
L8       EQU   8
L10      EQU   10
L12      EQU   12
L19      EQU   19
L20      EQU   20
L24      EQU   24
L36      EQU   36
L38      EQU   38
L256     EQU   256
OPENOK   EQU   X'10'
ZR0      EQU   8
*DCL THCONV FIXED(31) INIT(10000);                         /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      STARTING LOCATION FOR IFCIOHND                      @Z427VLS*/
*/*                                                          @Z427VLS*/
*                                      /*R2 HAS COMTABLE ADDRESS*/ 0130
*PTRSPOT = R1; /*GET PARAMETER LIST ADDRESS OF ADDRESS       @Z427VLS*/
         ST    R1,PTRSPOT                                          0130
*SAVER2 = R2; /*PRESUME THAT R2 HAS ADDRESS OF COMTABLE AT THIS POINT*/
         ST    R2,SAVER2                                           0131
*GENERATE;                                                 /*@Z427VLS*/
         USING IHADCB,R12      USE R12 FOR ADDRESSING DCBS
*BADNEWS = ZERO; /*RETURN CODE SAVE ITEM                     @Z427VLS*/
         SLR   @12,@12                                             0133
         ST    @12,BADNEWS                                         0133
*RESPECIFY (R2,R1) UNRESTRICTED;                           /*@Z427VLS*/
*/*DETERMINE SERVICE CALLER HAS REQUESTED AND BRANCH TO APPROPRIATE*/
*/*ROUTINE                                                   @Z427VLS*/
*IF INARG = READSEQ THEN /*IF READ OF SERLOG OR ACCIN REQUESTED*/  0135
         L     @12,PTRSPOT                                         0135
         L     @12,LISTPTR(,@12)                                   0135
         CLC   INARG(2,@12),@CH00077                               0135
         BNE   @RF00135                                            0135
*  CALL READSIT;                                           /*@Z427VLS*/
         BAL   @14,READSIT                                         0136
*ELSE                                                              0137
*  DO;                                                     /*@Z427VLS*/
         B     @RC00135                                            0137
@RF00135 DS    0H                                                  0138
*    IF INARG = READIRCT THEN                                      0138
         L     @12,PTRSPOT                                         0138
         L     @12,LISTPTR(,@12)                                   0138
         CLC   INARG(2,@12),@CH00082                               0138
         BNE   @RF00138                                            0138
*      CALL DIRECTIT; /*EXCP READ OF SERLOG OR POINT SEQ. READ OF WORK*
         BAL   @14,DIRECTIT                                        0139
*    ELSE                                                          0140
*      DO;                                                 /*@Z427VLS*/
         B     @RC00138                                            0140
@RF00138 DS    0H                                                  0141
*        IF INARG = RITEHIST THEN                                  0141
         L     @12,PTRSPOT                                         0141
         L     @12,LISTPTR(,@12)                                   0141
         CLC   INARG(2,@12),@CH00065                               0141
         BNE   @RF00141                                            0141
*          CALL HISTIT; /*QSAM WRITE TO ACCDEV, HISTORY OUTPUT*/   0142
         BAL   @14,HISTIT                                          0142
*        ELSE                                                      0143
*          DO;                                             /*@Z427VLS*/
         B     @RC00141                                            0143
@RF00141 DS    0H                                                  0144
*            IF INARG = RITESCRT THEN /*SEQUENTIAL NOTE WRITE TO WORK*/
         L     @12,PTRSPOT                                         0144
         L     @12,LISTPTR(,@12)                                   0144
         CLC   INARG(2,@12),@CH00080                               0144
         BNE   @RF00144                                            0144
*              CALL SCRCHIT;                               /*@Z427VLS*/
         BAL   @14,SCRCHIT                                         0145
*            ELSE                                                  0146
*              DO;                                         /*@Z427VLS*/
         B     @RC00144                                            0146
@RF00144 DS    0H                                                  0147
*                IF INARG = RITEPRTR THEN                          0147
         L     @12,PTRSPOT                                         0147
         L     @12,LISTPTR(,@12)                                   0147
         CLC   INARG(2,@12),@CH00075                               0147
         BNE   @RF00147                                            0147
*                  CALL PRINTIT;                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0148
*                ELSE                                              0149
*                  DO;                                     /*@Z427VLS*/
         B     @RC00147                                            0149
@RF00147 DS    0H                                                  0150
*                    IF INARG = IOOPEN THEN                        0150
         L     @12,PTRSPOT                                         0150
         L     @12,LISTPTR(,@12)                                   0150
         CLC   INARG(2,@12),@CH00056                               0150
         BNE   @RF00150                                            0150
*                      CALL OPENIT;                        /*@Z427VLS*/
         BAL   @14,OPENIT                                          0151
*                    ELSE                                          0152
*                      DO;                                 /*@Z427VLS*/
         B     @RC00150                                            0152
@RF00150 DS    0H                                                  0153
*                        IF INARG = IOCLOSE THEN                   0153
         L     @12,PTRSPOT                                         0153
         L     @12,LISTPTR(,@12)                                   0153
         CLC   INARG(2,@12),@CH00037                               0153
         BNE   @RF00153                                            0153
*                          CALL CLOSIT;                    /*@Z427VLS*/
         BAL   @14,CLOSIT                                          0154
*                        ELSE                                      0155
*                          DO;                             /*@Z427VLS*/
         B     @RC00153                                            0155
@RF00153 DS    0H                                                  0156
*                                IF INARG = READCARD THEN          0156
         L     @12,PTRSPOT                                         0156
         L     @12,LISTPTR(,@12)                                   0156
         CLC   INARG(2,@12),@CH00034                               0156
         BNE   @RF00156                                            0156
*                                  CALL REEDSYS;           /*@Z427VLS*/
         BAL   @14,REEDSYS                                         0157
*                                ELSE                              0158
*                                  DO;                     /*@Z427VLS*/
         B     @RC00156                                            0158
@RF00156 DS    0H                                                  0159
*                                     MSGNO = 1;           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00056                                   0159
*                                     CALL ERRMSG;         /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0160
*                                  END;                    /*@Z427VLS*/
*                           END;                           /*@Z427VLS*/
@RC00156 DS    0H                                                  0163
*                       END;                               /*@Z427VLS*/
@RC00153 DS    0H                                                  0164
*                    END;                                  /*@Z427VLS*/
@RC00150 DS    0H                                                  0165
*                END;                                      /*@Z427VLS*/
@RC00147 DS    0H                                                  0166
*             END;                                         /*@Z427VLS*/
@RC00144 DS    0H                                                  0167
*          END;                                            /*@Z427VLS*/
@RC00141 DS    0H                                                  0168
*       END;                                               /*@Z427VLS*/
@RC00138 DS    0H                                                  0169
*GOBACK: ;                                                 /*@Z427VLS*/
@RC00135 DS    0H                                                  0169
GOBACK   DS    0H                                                  0170
*RESPECIFY(R15) RESTRICTED;                                /*@Z427VLS*/
*R15 = BADNEWS;                                            /*@Z427VLS*/
         L     R15,BADNEWS                                         0171
*IF R15 > FOUR THEN /*FIND OUT IF USER CHECKING RETURN CODE  @Z427VLS*/
         C     R15,@CF00065                                        0172
         BNH   @RF00172                                            0172
*  ERRORENT = ERRORENT + 1; /*USER BUNGLE IF MORE THAN ONE   @Z427VLS*/
         LA    @14,1                                               0173
         AL    @14,ERRORENT                                        0173
         ST    @14,ERRORENT                                        0173
*RETURN;                                                   /*@Z427VLS*/
@EL00001 L     @13,4(,@13)                                         0174
@EF00001 DS    0H                                                  0174
@ER00001 L     @14,12(,@13)                                        0174
         LM    @00,@06,20(@13)                                     0174
         LM    @08,@12,52(@13)                                     0174
         BR    @14                                                 0174
*     /*THIS IS A STRUCTURED PROC TO REPLACE EXCPLOOP        @G51DGBB*/
*     /*OTHERWISE, THE ONLY CHANGES ARE THAT ALL REFERENCES  @G51DGBB*/
*     /*TO ZEROING INDIVIDUAL RECORDS HAVE BEEN REMOVED AND  @G51DGBB*/
*     /*THE LOCATION OF THE BEGINNING OF LOGREC FROM THE DEB @G51DGBB*/
*     /*IS SAVED FOR INITIALIZATION TO READ FRAMES           @G51DGBB*/
*/*EXCP LOOP THAT PERFORMS ALL IO OPERATIONS TO LOGREC. ONE CCW CHAIN*/
*/*IS USE FOR ALL THREE TYPES OF I-O PERFORMED. IN ALL CASES, THE   */
*/*FIRST CCW  IS A SEARCH FOR A PARTICULAR MBBCCHHR ACTUAL PHYSICAL */
*/*LOCATION OF A RECORD ON LOGREC ACCROSS THE ENTIRE EXTENT ALLO-   */
*/*CATED TO LOGREC. THE NEXT CCW IS A TIC WHICH LOOPS BACK TO THE   */
*/*SEARCH IF THE SEARCH FOR A PARTICULAR RECORD WAS UNSUCCESSFUL    */
*/*THE TYPES OF OPERATIONS WHICH ARE PERFORMED ARE:          @G51DGBB*/
*/* 1. CC= 6, READ LOGREC HEADER BY GIVING MBBCCHHR OF HEADER       */
*/* 2. CC= 5, WRITE HEADER OF SAME LENGTH BACK TO EXACT LOCATION    */
*/*           SPECIFIED IN GIVEN MBBCCHHR.                   @G51DGBB*/
*/* 3. CC= 158, READ THE NEXT ERROR RECORD AFTER THE RECORD WHOSE   */
*/*             MBBCCHHR IS GIVEN IN THE SEARCH              @G51DGBB*/
*/* R7 = ADDRESS OF AREA IN CORE TO PLACE THE RECORD READ    @G51DGBB*/
*RESPECIFY (R7,R5,R12) RESTRICTED;                         /*@G51DGBB*/
*EXCPLOOP: PROC;                                           /*@G51DGBB*/
EXCPLOOP STM   @14,@12,@SA00002                                    0176
*CKDAREA = R7; /*SET UP CCW3 CORE ADDRESS TO READ RECORD TO  @G51DGBB*/
         STCM  R7,7,CKDAREA                                        0177
*AREAADR = ADDR(HDRCC); /*SEARCH ID FOR FIRST CCW            @G51DGBB*/
         LA    @14,HDRCC                                           0178
         STCM  @14,7,AREAADR                                       0178
*IF SBT4 = ON THEN     /*IF HEADER I/O HAS BEEN REQUESTED    @G51DGBB*/
         TM    SBT4,B'00010000'                                    0179
         BNO   @RF00179                                            0179
*  DO;                                                     /*@G51DGBB*/
*    CKDCOUNT = 40;   /*3RD CCW NUMBER OF BYTES IN HEADER TO BE READ*/
         MVC   CKDCOUNT(2),@CH00463                                0181
*    IF SBT2 = ON THEN /*IF HEADER IS TO BE WRITTEN THEN     @G51DGBB*/
         TM    SBT2,B'01000000'                                    0182
         BNO   @RF00182                                            0182
*      CKDCOM = '05'X; /*SET 3RD CCW CHANNEL COMMAND TO WRITE IN PLACE*
         MVI   CKDCOM,X'05'                                        0183
*    ELSE              /*IF HEADER IS TO BE READ             @G51DGBB*/
*      CKDCOM = '06'X; /*SET 3RD CCW CHANNEL COMMAND TO READ SAME */
         B     @RC00182                                            0184
@RF00182 MVI   CKDCOM,X'06'                                        0184
*                      /*RECORD AS SEARCH ID EQUAL HAS FOUND @G51DGBB*/
*    HDRM = '00'X;                                         /*@G51DGBB*/
@RC00182 MVI   HDRM,X'00'                                          0185
*    HDRR = '01'X;    /*HEADER RECORD IS RECORD 1            @G51DGBB*/
         MVI   HDRR,X'01'                                          0186
*    GEN(LA R12,LOGREC); /*SET LOGREC DCB DSECT BASE ADDRESS @G51DGBB*/
         LA R12,LOGREC
*    GEN(L  R5,DCBDEBAD); /*LOAD ADDRESS OF DEB FROM DCB FOR LOGREC*/
         L  R5,DCBDEBAD
*    GEN(MVC HDRBB(L6),L36(R5)); /*GET BBCCHH OF BEGINNING OF LOGREC*/
         MVC HDRBB(L6),L36(R5)
*      /*FROM FIRST EXTENT DIRECT ACCESS EXTENSION TO THE DEB*/    0190
*    SEEKSAVE = HDRSEEK; /*SAVE FOR USE WHEN READING FRAMES  @G51DGBB*/
         MVC   SEEKSAVE(8),HDRSEEK                                 0190
*    SKSAVREC = '02'X; /*INDICATE TIME STAMP AS RECORD BEFORE 1ST FRM*/
         MVI   SKSAVREC,X'02'                                      0191
*  END;                                                    /*@G51DGBB*/
*ELSE  /*IF NORMAL, NON HEADER, READ OF LOGREC               @G51DGBB*/
*  DO;                                                     /*@G51DGBB*/
         B     @RC00179                                            0193
@RF00179 DS    0H                                                  0194
*    HDRSEEK = PREVSEEK; /*SET ADDRESS TO SEEK FROM COUNT FIELD OF */
         MVC   HDRSEEK(8),PREVSEEK                                 0194
*                        /*PREVIOUS RECORD                   @G51DGBB*/
*    CKDCOM = '9E'X;  /*SET THIRD CCW CHANNEL COMMAND TO SEEK NEXT */
         MVI   CKDCOM,X'9E'                                        0195
*                     /*RECORD AFTER RECORD WHOSE SEEK ID EQUAL IS */
*                     /*FOUND AS RESULT OF CCW1. DONE FOR SPEED*/  0196
*    CKDCOUNT = 1944; /*SET NUMBER OF BYTES TO READ. INCORRECT LENGTH*/
         MVC   CKDCOUNT(2),@CH00917                                0196
*                     /*ERRORS ARE SUPPRESSED                @G51DGBB*/
*  END;                                                    /*@G51DGBB*/
*XIOBSEEK = HDRSEEK; /*SET IOB SEEK ADDRESS                  @G51DGBB*/
@RC00179 MVC   XIOBSEEK(8),HDRSEEK                                 0198
*XWRECB = 0;         /*ZERO THE EVENT CONTROL BLOCK          @G51DGBB*/
         SLR   @14,@14                                             0199
         ST    @14,XWRECB                                          0199
*DO UNTIL POST ^= '44'X; /*LOOP UNTIL IO REQUEST NOT INTERCEPTED*/ 0200
@DL00200 DS    0H                                                  0201
*  GEN(EXCP XIOB); /*ISSUE SVC 0                             @G51DGBB*/
         EXCP XIOB
*  GEN(WAIT ECB=XWRECB); /*WAIT FOR COMPLETION OF IO         @G51DGBB*/
         WAIT ECB=XWRECB
*END;                                                      /*@G51DGBB*/
@DE00200 CLI   POST,X'44'                                          0203
         BE    @DL00200                                            0203
*RESPECIFY (R7,R5,R12) UNRESTRICTED;                       /*@G51DGBB*/
*END;                                                      /*@G51DGBB*/
@EL00002 DS    0H                                                  0205
@EF00002 DS    0H                                                  0205
@ER00002 LM    @14,@12,@SA00002                                    0205
         BR    @14                                                 0205
*READSER: PROC OPTIONS (DONTSAVE(7)); /*READ SYS1.LOGREC SEQUENTIALLY*/
READSER  STM   @14,@06,@SA00003                                    0206
         STM   @08,@12,@SA00003+36                                 0206
*  /*PROC HAS BEEN REWRITTEN TO HANDLE READING OF FRAMES AT END OF   */
*  /*OF FILE FOR ERROR RECORDS, IF FRAMES EXIST. THE PROC IS NOW     */
*  /*STRUCTURED.                                             @G51DGBB*/
*RESPECIFY (R7) RESTRICTED;                                /*@G51DGBB*/
*RSEQCNT = RSEQCNT + 1; /*COUNT NUMBER OF READ ATTEMPTS      @G51DGBB*/
         LA    @14,1                                               0208
         AL    @14,RSEQCNT                                         0208
         ST    @14,RSEQCNT                                         0208
*IF SERLO = YES THEN    /*IF SYS1.LOGREC IS OPEN THEN        @G51DGBB*/
         TM    SERLO,B'10000000'                                   0209
         BNO   @RF00209                                            0209
*  DO;                                                     /*@G51DGBB*/
*    IF READFR = OFF THEN /*IF READING ERROR RECORDS         @G51DGBB*/
         TM    READFR,B'10000000'                                  0211
         BNZ   @RF00211                                            0211
*      DO;                                                 /*@G51DGBB*/
*        IF PREVSEEK(2:8) = HDRREC2 THEN /*IF CURRENT SEEK ADDRESS IS*/
         CLC   PREVSEEK+1(7),HDRREC2                               0213
         BNE   @RF00213                                            0213
*         /*EQUAL TO LAST ACTIVE RECORD SEEK ADDRESS, IMPLICATION IS */
*         /*THAT THIS LAST RECORD HAS ALREADY BEEN READ      @G51DGBB*/
*          DO;                                             /*@G51DGBB*/
*            IF TWOTRY = NO & /*SECOND TRY FOR EOF ON SEQUENTIAL INPT*/
*               LASTLOOP = NO THEN /*NOT AN END OF FILE SAVING OF    */
         TM    TWOTRY,B'01000000'                                  0215
         BNZ   @RF00215                                            0215
         TM    LASTLOOP,B'00000100'                                0215
         BNZ   @RF00215                                            0215
*                                  /*RECORDS DURING ZERO ALL PROCESS*/
*              DO;                                         /*@G51DGBB*/
*                TWOTRY = YES; /*SET SECOND SEQUENTIAL READ TRY FLAG*/
         OI    TWOTRY,B'01000000'                                  0217
*                CALL CHECKHDR; /*ANY RECORDS WRITTEN WHILE READING?*/
         BAL   @14,CHECKHDR                                        0218
*                IF BADNEWS = FOUR &    /*IF NO NEW RECORDS WRITTEN*/
*                   FRAMES  = YES THEN  /*AND FRAMES EXIST ON LOGREC*/
         CLC   BADNEWS(4),@CF00065                                 0219
         BNE   @RF00219                                            0219
         TM    FRAMES,B'00100000'                                  0219
         BNO   @RF00219                                            0219
*                  DO;                                     /*@G51DGBB*/
*                    BADNEWS = ZERO; /*INDICATE NO END OF FILE YET*/
         SLR   @14,@14                                             0221
         ST    @14,BADNEWS                                         0221
*                    READFR = YES; /*SET READ FRAME SWITCH   @G51DGBB*/
         OI    READFR,B'10000000'                                  0222
*                    IF DEBUG15 = ON THEN /*IF DEBUG 15 MONITORING*/
         L     @14,SAVER2                                          0223
         TM    DEBUG15(@14),B'00000001'                            0223
         BNO   @RF00223                                            0223
*                      DO;                                 /*@G51DGBB*/
*                        MSGNO = 70; /*START OF FRAME READ MONITOR*/
         MVC   MSGNO(4),@CF00924                                   0225
*                        CALL ERRMSG; /*PRINT MESSAGE TO TOURIST*/ 0226
         BAL   @14,ERRMSG                                          0226
*                      END;                                /*@G51DGBB*/
*                    PREVSEEK = SEEKSAVE; /*GET TIME STAMP LOCATION*/
@RF00223 MVC   PREVSEEK(8),SEEKSAVE                                0228
*                  END;                                    /*@G51DGBB*/
*              END;                                        /*@G51DGBB*/
*            ELSE  /*EITHER SECOND END OF FILE OR ZEROALL PROCESSING*/
*              DO;                                         /*@G51DGBB*/
         B     @RC00215                                            0231
@RF00215 DS    0H                                                  0232
*                IF FRAMES = YES &    /*DO FRAMES EXIST ON SERLOG*/
*                   LASTLOOP = NO THEN /*NOT ZEROALL PROCESSING  */
         TM    FRAMES,B'00100000'                                  0232
         BNO   @RF00232                                            0232
         TM    LASTLOOP,B'00000100'                                0232
         BNZ   @RF00232                                            0232
*                  DO;                                     /*@G51DGBB*/
*                    READFR = YES; /*SET READING FRAMES SWITCH*/   0234
         OI    READFR,B'10000000'                                  0234
*                    IF DEBUG15 = ON THEN /*IF DEBUG15 MONITORING*/
         L     @14,SAVER2                                          0235
         TM    DEBUG15(@14),B'00000001'                            0235
         BNO   @RF00235                                            0235
*                      DO;                                 /*@G51DGBB*/
*                        MSGNO = 70; /*START OF FRAME READ MESSAGE*/
         MVC   MSGNO(4),@CF00924                                   0237
*                        CALL ERRMSG; /*WRITE MESSAGE TO TOURIST*/ 0238
         BAL   @14,ERRMSG                                          0238
*                      END;                                /*@G51DGBB*/
*                    PREVSEEK = SEEKSAVE; /*GET STARTING LOCATION*/
@RF00235 MVC   PREVSEEK(8),SEEKSAVE                                0240
*                    /*OF LOGREC FROM DEB. IMPLICATION IS THAT   */
*                    /*1ST FRAME MUST BE ON SAME TRACK AS HEADER */
*                   END;                                   /*@G51DGBB*/
*                 ELSE  /*LEGITIMATE END OF FILE             @G51DGBB*/
*                   BADNEWS = FOUR; /*INDICATE EOF TO WORLD  @G51DGBB*/
         B     @RC00232                                            0242
@RF00232 MVC   BADNEWS(4),@CF00065                                 0242
*               END;                                       /*@G51DGBB*/
*           END;                                           /*@G51DGBB*/
*      END;                                                /*@G51DGBB*/
*    ELSE  /*FRAMES ARE BEING READ                           @G51DGBB*/
*      DO;                                                 /*@G51DGBB*/
         B     @RC00211                                            0246
@RF00211 DS    0H                                                  0247
*        IF PREVSEEK(2:8) = HDRREC1 THEN /*IF SEEK ADDRESS FOR */  0247
         CLC   PREVSEEK+1(7),HDRREC1                               0247
         BNE   @RF00247                                            0247
*          /*PREVIOUS RECORD IS EQUAL TO SEEK ADDRESS OF LAST FRAME*/
*          /*THEN END OF FILE ON LOGREC HAS BEEN REACHED     @G51DGBB*/
*          BADNEWS = FOUR; /*INDICATE END OF FILE            @G51DGBB*/
         MVC   BADNEWS(4),@CF00065                                 0248
*        ELSE  /*NOT LAST FRAME                              @G51DGBB*/
*          RFRCOUNT = RFRCOUNT + 1; /*COUNT FRAMES FOR DEBUG16 TOTAL*/
         B     @RC00247                                            0249
@RF00247 LA    @14,1                                               0249
         AL    @14,RFRCOUNT                                        0249
         ST    @14,RFRCOUNT                                        0249
*      END;                                                /*@G51DGBB*/
@RC00247 DS    0H                                                  0251
*    IF BADNEWS = ZERO THEN /*IF NO EOF OR ERROR CONDITIONS THEN*/ 0251
@RC00211 L     @14,BADNEWS                                         0251
         LTR   @14,@14                                             0251
         BNZ   @RF00251                                            0251
*      DO;                                                 /*@G51DGBB*/
*        R7 = ADDR(BUF1); /*ADDRESS READ BUFFER              @G51DGBB*/
         LA    R7,BUF1                                             0253
*        CALL EXCPLOOP; /*ISSUE EXCP READ                    @G51DGBB*/
         BAL   @14,EXCPLOOP                                        0254
*        IF POST ^= '7F'X THEN /*IF UNSUCCESSFULL READ       @G51DGBB*/
         CLI   POST,X'7F'                                          0255
         BE    @RF00255                                            0255
*          DO;                                             /*@G51DGBB*/
*            IF POST = '42'X THEN /*OUT OF LOGREC EXTENT ERROR*/   0257
         CLI   POST,X'42'                                          0257
         BNE   @RF00257                                            0257
*              MSGNO = 14;                                 /*@G51DGBB*/
         MVC   MSGNO(4),@CF00759                                   0258
*            ELSE   /* HARD I-O ERROR                        @G51DGBB*/
*              MSGNO = 39;                                 /*@G51DGBB*/
         B     @RC00257                                            0259
@RF00257 MVC   MSGNO(4),@CF00925                                   0259
*            CALL ERRMSG;                                  /*@G51DGBB*/
@RC00257 BAL   @14,ERRMSG                                          0260
*            BADNEWS = TWELVE;                             /*@G51DGBB*/
         MVC   BADNEWS(4),@CF00068                                 0261
*          END;                                            /*@G51DGBB*/
*        ELSE /*SUCCESSFUL READ                              @G51DGBB*/
*          DO;                                             /*@G51DGBB*/
         B     @RC00255                                            0263
@RF00255 DS    0H                                                  0264
*            PREVCC(1:5) = BCOUNT; /*DIRECT ACCESS ADDRESS,CCHHR,*/
         MVC   PREVCC(5),BCOUNT                                    0264
*           /*OF RECORD LAST READ FROM COUNT RECORD PRECEEDING DATA*/
*           /*RECORD ON COUNT,DATA FORMATTED DIRECT ACCESS FILE*/  0265
*            FLIPFLOP = NO; /*INDICATE SEQUENTIAL INPUT FROM LOGREC,*/
         NI    FLIPFLOP,B'11011111'                                0265
*                           /* AND NOT FROM HISTORY INPUT    @G51DGBB*/
*            RECCCHHR = BCOUNT; /*PASS SAME VALUE TO USER VIA PARM*/
         L     @14,SAVER2                                          0266
         MVC   RECCCHHR(5,@14),BCOUNT                              0266
*            RECLNGTH = BSIZE; /*PASS RECORD LENGTH FROM COUNT RECRD*/
         LH    @12,BSIZE                                           0267
         N     @12,@CF01176                                        0267
         STH   @12,RECLNGTH(,@14)                                  0267
*            SAVELENT = BSIZE + 4; /*SAVE RECORD QSAM LENGTH FOR */
         LA    @12,4(,@12)                                         0268
         STH   @12,SAVELENT                                        0268
*                                  /*RITESCRT,RITEHIST       @G51DGBB*/
*            R7 = ADDR(BDATA); /*BKEY IS DATA PORTION OF RECORD SINCE*/
         LA    R7,BDATA                                            0269
*            TIMEBASE = R7; /*TELL TIME CONVERSION WHERE RECORD IS*/
         ST    R7,TIMEBASE                                         0270
*            CALL CONVTIME; /*CONVERT TIME, IF NECESSARY     @G51DGBB*/
         BAL   @14,CONVTIME                                        0271
*          END;                                            /*@G51DGBB*/
*      END;                                                /*@G51DGBB*/
*  END;                                                    /*@G51DGBB*/
*ELSE /*IF LOGREC HAS NOT BEEN OPENED                        @G51DGBB*/
*  DO;                                                     /*@G51DGBB*/
         B     @RC00209                                            0275
@RF00209 DS    0H                                                  0276
*    MSGNO = 47;                                           /*@G51DGBB*/
         MVC   MSGNO(4),@CF00927                                   0276
*    CALL ERRMSG;                                          /*@G51DGBB*/
         BAL   @14,ERRMSG                                          0277
*    BADNEWS = TWELVE;                                     /*@G51DGBB*/
         MVC   BADNEWS(4),@CF00068                                 0278
*  END;                                                    /*@G51DGBB*/
*END; /*END OF PROC READSER                                  @G51DGBB*/
@EL00003 DS    0H                                                  0280
@EF00003 DS    0H                                                  0280
@ER00003 LM    @14,@06,@SA00003                                    0280
         LM    @08,@12,@SA00003+36                                 0280
         BR    @14                                                 0280
*DIRRDSER: PROC OPTIONS(DONTSAVE(R7)); /*READ SERLOG DIRECTLY*/    0281
DIRRDSER STM   @14,@06,@SA00004                                    0281
         STM   @08,@12,@SA00004+36                                 0281
*RESPECIFY (R7) RESTRICTED;                                /*@Z427VLS*/
*IF SERLO = YES THEN /*DO ONLY IF SERLOG IS OPEN             @Z427VLS*/
         TM    SERLO,B'10000000'                                   0283
         BNO   @RF00283                                            0283
*  DO;                                                     /*@Z427VLS*/
*    RSERDCNT = RSERDCNT + 1; /*COUNT NUMBER OF READ ATTEMPTS*/    0285
         LA    @14,1                                               0285
         AL    @14,RSERDCNT                                        0285
         ST    @14,RSERDCNT                                        0285
*    PREVCC(1:5) = RECCCHHR;                               /*@Z427VLS*/
         L     @14,SAVER2                                          0286
         MVC   PREVCC(5),RECCCHHR(@14)                             0286
*    R7 = ADDR(BUF1);                                      /*@Z427VLS*/
         LA    R7,BUF1                                             0287
*    PREVR = PREVR - 1;                                    /*@Z427VLS*/
         SLR   @14,@14                                             0288
         IC    @14,PREVR                                           0288
         BCTR  @14,0                                               0288
         STC   @14,PREVR                                           0288
*    CALL EXCPLOOP;                                        /*@Z427VLS*/
         BAL   @14,EXCPLOOP                                        0289
*    IF POST ^= '7F'X THEN                                         0290
         CLI   POST,X'7F'                                          0290
         BE    @RF00290                                            0290
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 25;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF00932                                   0292
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0293
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0294
*        RETURN;                                           /*@Z427VLS*/
@EL00004 DS    0H                                                  0295
@EF00004 DS    0H                                                  0295
@ER00004 LM    @14,@06,@SA00004                                    0295
         LM    @08,@12,@SA00004+36                                 0295
         BR    @14                                                 0295
*      END;                                                /*@Z427VLS*/
*     PREVCC(1:5) = BCOUNT;                                /*@Z427VLS*/
@RF00290 MVC   PREVCC(5),BCOUNT                                    0297
*     RECLNGTH = BSZ;                                      /*@Z427VLS*/
         LH    @14,BSZ                                             0298
         L     @12,SAVER2                                          0298
         STH   @14,RECLNGTH(,@12)                                  0298
*     R7 = ADDR(BDATA);                                    /*@G51DGBB*/
         LA    R7,BDATA                                            0299
*     TIMEBASE = R7;                                       /*@Z427VLS*/
         ST    R7,TIMEBASE                                         0300
*     CALL CONVTIME;                                       /*@Z427VLS*/
         BAL   @14,CONVTIME                                        0301
*  END;                                                    /*@Z427VLS*/
*ELSE /*SERLOG NOT OPEN                                      @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00283                                            0303
@RF00283 DS    0H                                                  0304
*    MSGNO = 47;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00927                                   0304
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0305
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0306
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/
*END; /*CLOSING END TO DIRRDSER PROC                         @Z427VLS*/
         B     @EL00004                                            0309
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      RESET HEADER TO INDICATE AN EMPTY DATA SET          @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*RESETHDR: PROC;                                           /*@Z427VLS*/
RESETHDR STM   @14,@12,@SA00005                                    0310
*RESPECIFY (R7,R6) RESTRICTED;                             /*@Z427VLS*/
*        IF DEBUG15 = ON THEN                                      0312
         L     @14,SAVER2                                          0312
         TM    DEBUG15(@14),B'00000001'                            0312
         BNO   @RF00312                                            0312
*          DO; /*PRINT TO TOURIST ATTEMPT TO RESET HEADER    @Z427VLS*/
*            MSGNO = 55;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF00937                                   0314
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0315
*          END;                                            /*@Z427VLS*/
*        R7=ADDR(HEADER);               /* POINT TO HEADER AREA      */
@RF00312 LA    R7,HEADER                                           0317
*        SBT2='1'B;                     /* SET HEADER & WRITE        */
*        SBT4='1'B;                     /* SWITCHES ON       @Z427VLS*/
         OI    SBT2,B'01010000'                                    0319
*        HDRREC2=HDRREC1;               /* RESET LAST REC WRITTEN    */
         MVC   HDRREC2(7),HDRREC1                                  0320
*        R6=HDRTYPE;                    /* PICK UP DEV TYPE  @Z427VLS*/
         SLR   R6,R6                                               0321
         IC    R6,HDRTYPE                                          0321
*        GEN(SLL   R6,L1);              /* MULTIPLY BY 2     @Z427VLS*/
         SLL   R6,L1
*        GEN(LA    R6,BYTESREM(R6));    /* INDEX INTO TABLE  @Z427VLS*/
         LA    R6,BYTESREM(R6)
*        GEN(MVC   HDRREM(L2),L0(R6));  /* MOVE BYTES REM TO FLD     */
         MVC   HDRREM(L2),L0(R6)
*       IF FRAMES = YES THEN /*IF FRAMES TO BE SAVED FOR MERIDIAN*/
         TM    FRAMES,B'00100000'                                  0325
         BNO   @RF00325                                            0325
*         HDRREM = 20; /*DONT LET RECORDS ON LAST FRAME TRACK*/    0326
         MVC   HDRREM(2),@CH00662                                  0326
*        HDRWNGBT='0'B;                 /* TURN OFF EARLY WARN SWITCH*/
@RF00325 NI    HDRWNGBT,B'01111111'                                0327
*        HDRCOUNT = '00'X;             /* RESET THE MSG FIELD */   0328
         MVI   HDRCOUNT,X'00'                                      0328
*        CALL EXCPLOOP;                                    /*@Z427VLS*/
         BAL   @14,EXCPLOOP                                        0329
*        IF POST^='7F'X THEN            /* TEST FOR NORMAL   @Z427VLS*/
         CLI   POST,X'7F'                                          0330
         BE    @RF00330                                            0330
*          DO;                                             /*@Z427VLS*/
*            MSGNO = 48;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF00938                                   0332
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0333
*            BADNEWS = TWELVE;                             /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0334
*            CALL IFCMSG(201,ADDR(PRNTBF));                /*@Z427VLS*/
         LA    @14,PRNTBF                                          0335
         ST    @14,@AFTEMPS                                        0335
         L     @12,SAVER2                                          0335
         L     @15,ADIFCMSG(,@12)                                  0335
         LA    @01,@AL00335                                        0335
         BALR  @14,@15                                             0335
*            RETURN;                                       /*@Z427VLS*/
@EL00005 DS    0H                                                  0336
@EF00005 DS    0H                                                  0336
@ER00005 LM    @14,@12,@SA00005                                    0336
         BR    @14                                                 0336
*          END;                                            /*@Z427VLS*/
*RESPECIFY (R7,R6)  UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO PROC RESETHDR                         @Z427VLS*/
         B     @EL00005                                            0339
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      OPEN  SYS1.LOGREC                                   @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*OPENSERL: PROC;                                           /*@Z427VLS*/
OPENSERL STM   @14,@12,@SA00006                                    0340
*RESPECIFY(R1,R0,R7,R12) RESTRICTED;                       /*@Z427VLS*/
*IF DEBUG15 = ON THEN                                              0342
         L     @14,SAVER2                                          0342
         TM    DEBUG15(@14),B'00000001'                            0342
         BNO   @RF00342                                            0342
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 53;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00944                                   0344
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0345
*  END;                                                    /*@Z427VLS*/
*GENERATE;                                                 /*@Z427VLS*/
@RF00342 DS    0H                                                  0347
         LA    R1,LOGREC
         ST    R1,XIOBDCB
*IF SERLO = YES THEN /*IF SERLOG ALREADY OPEN THEN           @Z427VLS*/
         TM    SERLO,B'10000000'                                   0348
         BNO   @RF00348                                            0348
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 41;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00945                                   0350
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0351
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0352
*    RETURN;                                               /*@Z427VLS*/
@EL00006 DS    0H                                                  0353
@EF00006 DS    0H                                                  0353
@ER00006 LM    @14,@12,@SA00006                                    0353
         BR    @14                                                 0353
*  END;                                                    /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/*      BLOCK  GENERATE TO INTERFACE WITH SYSTEM MACROS & CONTROL   */
*/*                                                          @Z427VLS*/
*ZEROA = (ZEROA && ZEROA); /*CLEAR FIELD                     @Z427VLS*/
@RF00348 XC    ZEROA(24),ZEROA                                     0355
*IF NOSDR = NO THEN /*IF USER WANTS SDR COUNTERS DUMPED      @Z427VLS*/
         L     @14,SAVER2                                          0356
         TM    NOSDR(@14),B'00000001'                              0356
         BNZ   @RF00356                                            0356
*DO;                                                       /*@Z427VLS*/
*GENERATE;                                                 /*@Z427VLS*/
         LA    R0,4                     CODE TO DUMP SDR'S
         SVC   76                       ISSUE SVC TO DUMP SDR'S
*END;                                                      /*@Z427VLS*/
*GENERATE;                                                 /*@Z427VLS*/
@RF00356 DS    0H                                                  0360
         ENQ   (RESID,LOGRECA,E,11,STEP) ENQ TO PREVENT OTHER ACCESS
         OPEN  (LOGREC,(OUTPUT))         FROM ANOTHER IFCEREP0 TASK
         LA    R12,LOGREC               PICK UP ADDR FOR DSECT BASE
         TM    DCBOFLGS,OPENOK          DID OPEN GO OK
         BZ    BADOPENA                 BR-NO BAD OPEN
*        SERLO = YES;                   /* TURN ON OPEN DISK IND     */
         OI    SERLO,B'10000000'                                   0361
*        SBT4='1'B;                     /* TURN ON HDR READ SW       */
         OI    SBT4,B'00010000'                                    0362
*        R7=ADDR(HEADER);               /* POINT TO HEADER AREA      */
         LA    R7,HEADER                                           0363
*        CALL EXCPLOOP;                 /* GO DO I/O TO READ HDR     */
         BAL   @14,EXCPLOOP                                        0364
*        SBT4='0'B;                     /* TURN OFF HDR READ SW      */
         NI    SBT4,B'11101111'                                    0365
*        IF POST^='7F'X                 /* TEST FOR NORMAL   @Z427VLS*/
*              THEN                     /* RETURN FROM I/O   @Z427VLS*/
         CLI   POST,X'7F'                                          0366
         BNE   @RT00366                                            0366
*                   GOTO HDRERR0;       /* IF NOT GOTO ERROR EXIT    */
*        IF HDRSAFE^='FF'X              /* TEST FOR SAFETY BYTE      */
*              THEN                     /* IN HEADER RECORD  @Z427VLS*/
         CLI   HDRSAFE,X'FF'                                       0368
         BNE   @RT00368                                            0368
*                   GOTO HDRERR1;       /* IF NOT TAKE ERROR EXIT    */
*        GENERATE;                                         /*@Z427VLS*/
         MVC   DCBFDAD+L3(L4),HDRECC    SET DCB HIGH EXTENT FIELD
         XC    DCBTRBAL(L2),DCBTRBAL    ZERO THE TRACK BALANCE FIELD
L3       EQU   3
*PREVSEEK(2:8) = HDRREC1; /*SET START SEEK AT LAST FRAME LOCATION*/
         MVC   PREVSEEK+1(7),HDRREC1                               0371
*PREVM = '00'X; /*INDICATE DATA SET OPEN                     @G51DGBB*/
         MVI   PREVM,X'00'                                         0372
*        RETURN;                        /* TAKE NORMAL EXIT  @Z427VLS*/
         B     @EL00006                                            0373
*HDRERR0:     ;                                            /*@Z427VLS*/
HDRERR0  DS    0H                                                  0375
*        IF POST='42'X                  /* TEST FOR OUT OF EXTENT    */
*              THEN                     /* IF YES            @Z427VLS*/
         CLI   POST,X'42'                                          0375
         BNE   @RF00375                                            0375
*                MSGNO = 14;                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF00759                                   0376
*              ELSE                                                0377
*                MSGNO = 15;                               /*@Z427VLS*/
         B     @RC00375                                            0377
@RF00375 MVC   MSGNO(4),@CF00036                                   0377
*         CALL ERRMSG;                                     /*@Z427VLS*/
@RC00375 BAL   @14,ERRMSG                                          0378
*         BADNEWS = TWELVE;                                /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0379
*         RETURN;                                          /*@Z427VLS*/
         B     @EL00006                                            0380
*HDRERR1:     ;                                            /*@Z427VLS*/
HDRERR1  DS    0H                                                  0382
*      MSGNO = 16;                                         /*@Z427VLS*/
         MVC   MSGNO(4),@CF00089                                   0382
*      CALL ERRMSG;                                        /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0383
*      BADNEWS = TWELVE;                                   /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0384
*RESPECIFY (R1,R0,R7,R12) UNRESTRICTED;                    /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENSERL, OPEN SERLOG DATA SET   @Z427VLS*/
         B     @EL00006                                            0386
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      CHECK HEADER FOR MORE RECORDS WRITTEN WHILE PROCESSING      */
*/*                                                          @Z427VLS*/
*/********************************************************************/
*CHECKHDR: PROC;                                           /*@Z427VLS*/
CHECKHDR STM   @14,@12,@SA00007                                    0387
*RESPECIFY(R1,R4,R7) RESTRICTED;                           /*@Z427VLS*/
*        IF DEBUG15 = ON THEN                                      0389
         L     @14,SAVER2                                          0389
         TM    DEBUG15(@14),B'00000001'                            0389
         BNO   @RF00389                                            0389
*          DO;                                             /*@Z427VLS*/
*            MSGNO = 54;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF00953                                   0391
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0392
*          END;                                            /*@Z427VLS*/
*        IF SERLO = NO THEN             /* TEST FOR DISK OPEN        */
@RF00389 TM    SERLO,B'10000000'                                   0394
         BNZ   @RF00394                                            0394
*          DO;                                             /*@Z427VLS*/
*            MSGNO = 49;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF00954                                   0396
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0397
*            BADNEWS = TWELVE;                             /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0398
*            RETURN;                                       /*@Z427VLS*/
@EL00007 DS    0H                                                  0399
@EF00007 DS    0H                                                  0399
@ER00007 LM    @14,@12,@SA00007                                    0399
         BR    @14                                                 0399
*          END;                                            /*@Z427VLS*/
*        GEN(GETMAIN R,LV=40);          /* GET STORAGE TO HOLD HEADER*/
@RF00394 DS    0H                                                  0401
         GETMAIN R,LV=40
*        R4=R1;                         /* SET BASE FOR OLD HEADER   */
         LR    R4,R1                                               0402
*        OHEADER=HEADER;                /* MOVE HEADER TO GOTTEN CORE*/
         MVC   OHEADER(40,R4),HEADER                               0403
*        R7=ADDR(HEADER);               /* POINT TO BUFF FOR READ    */
         LA    R7,HEADER                                           0404
*        SBT4='1'B;                     /* TURN ON READ HEADER       */
         OI    SBT4,B'00010000'                                    0405
*        IF LASTLOOP = YES THEN /*DONT ENQUEUE EXCEPT FOR ZEROALL PRO*/
         TM    LASTLOOP,B'00000100'                                0406
         BNO   @RF00406                                            0406
*        DO; /*CESSING. MAYBE EXTRA RECORD WRITTEN AT EOF FOR READSEQ*/
*        SBT7='1'B;                     /* TURN ON INTERNAL ENQ SW   */
         OI    SBT7,B'00001000'                                    0408
*        GEN(ENQ  (RESIDII,LOGRECB,E,8,SYSTEM));           /*@Z427VLS*/
         ENQ  (RESIDII,LOGRECB,E,8,SYSTEM)
*        END;                                              /*@Z427VLS*/
*        CALL EXCPLOOP;                 /* GO DO I/O READ HEADER     */
@RF00406 BAL   @14,EXCPLOOP                                        0411
*CHK01  :     ;                                            /*@Z427VLS*/
CHK01    DS    0H                                                  0413
*        IF POST^='7F'X                 /* TEST POST CODE FOR NORMAL */
*              THEN                     /* RETURN IF NOT     @Z427VLS*/
         CLI   POST,X'7F'                                          0413
         BNE   @RT00413                                            0413
*                   GOTO CHK03;         /* TAKE ERROR EXIT   @Z427VLS*/
*        IF HDRSAFE^='FF'X              /* TEST HDR REC JUST READ FOR*/
*              THEN                     /* SAFETY BYTE       @Z427VLS*/
         CLI   HDRSAFE,X'FF'                                       0415
         BNE   @RT00415                                            0415
*                   GOTO CHK04;         /* IF NOT FF TAKE ERR EXIT   */
*        IF HDRREC2=OHDRREC2            /* TEST LAST REC WRITTEN FLDS*/
*              THEN                     /* IF THEY MATCH     @Z427VLS*/
         CLC   HDRREC2(7),OHDRREC2(R4)                             0417
         BNE   @RF00417                                            0417
*                   DO;                 /* THEN              @Z427VLS*/
*                        BADNEWS = FOUR; /*INDICATE REAL END OF FILE */
         MVC   BADNEWS(4),@CF00065                                 0419
*                        GOTO CHK02;    /* GO ON             @Z427VLS*/
         B     CHK02                                               0420
*                   END;                                   /*@Z427VLS*/
*        PREVSEEK(2:8)=OHDRREC2  ;                          /*YM01498*/
@RF00417 MVC   PREVSEEK+1(7),OHDRREC2(R4)                          0422
*CHK02  :     ;                                            /*@Z427VLS*/
CHK02    DS    0H                                                  0424
*        SBT4='0'B;                     /* TURN OF HEADER SW @Z427VLS*/
         NI    SBT4,B'11101111'                                    0424
*        R1=R4;                         /* SET R1 FOR FREE MAIN      */
         LR    R1,R4                                               0425
*        GEN(FREEMAIN R,LV=40,A=(1));   /* FREE MAIN OF GOTTEN CORE  */
         FREEMAIN R,LV=40,A=(1)
*          RETURN; /*GO BACK TO CALLER                       @Z427VLS*/
         B     @EL00007                                            0427
*CHK03  :     ;                                            /*@Z427VLS*/
CHK03    DS    0H                                                  0429
*        IF POST = '42'X THEN /*42 MEANS OUT OF EXTENT       @Z427VLS*/
         CLI   POST,X'42'                                          0429
         BNE   @RF00429                                            0429
*          MSGNO = 14;                                     /*@Z427VLS*/
         MVC   MSGNO(4),@CF00759                                   0430
*        ELSE                                                      0431
*          MSGNO = 15;   /*NOT 42 MEANS IO ERROR             @Z427VLS*/
         B     @RC00429                                            0431
@RF00429 MVC   MSGNO(4),@CF00036                                   0431
*        CALL ERRMSG;                                      /*@Z427VLS*/
@RC00429 BAL   @14,ERRMSG                                          0432
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0433
*        GOTO  CHK02;     /*GO BACK TO FREE EXCESS CORE      @Z427VLS*/
         B     CHK02                                               0434
*CHK04  :     ;                                            /*@Z427VLS*/
CHK04    DS    0H                                                  0436
*        MSGNO = 16; /*HEADER CHECK BYTE BAD                 @Z427VLS*/
         MVC   MSGNO(4),@CF00089                                   0436
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0437
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0438
*        GOTO CHK02;                     /*GO BACK TO DEQ    @Z427VLS*/
         B     CHK02                                               0439
*RESPECIFY(R1,R4,R7) UNRESTRICTED;                         /*@Z427VLS*/
*END; /*CLOSING END TO PROC CHECK HEADER                     @Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      CONVERT TIME ROUTINE                                @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*CONVTIME: PROC;                                           /*@Z427VLS*/
CONVTIME STM   @14,@12,@SA00008                                    0442
*RESPECIFY(R3,R4,R5,R6,R7) RESTRICTED;                     /*@Z427VLS*/
*        R7SAVE = R7;  /*SAVE RECORD ADDRESS                 @Z427VLS*/
         ST    R7,R7SAVE                                           0444
*        IF LCSWITCH='1'B               /*  HAS TIME BEEN CONVERTED  */
*              THEN                     /*  OR IS IT IN PROPER FORM  */
         L     @14,TIMEBASE                                        0445
         TM    LCSWITCH(@14),B'00001000'                           0445
         BO    @RT00445                                            0445
*                   RETURN;               /*  YES EXIT TO CALLER   */
*        CONVTCT = CONVTCT + 1;         /*NUMBER OF CONVERSIONS DONE*/
         LA    @12,1                                               0447
         AL    @12,CONVTCT                                         0447
         ST    @12,CONVTCT                                         0447
*        IF NSSWITCH='1'B               /*  IS TIME FROM  NS MACHINE */
*              THEN                     /*  IF YES           @Z427VLS*/
         TM    NSSWITCH(@14),B'01000000'                           0448
         BO    @RT00448                                            0448
*                   GOTO                /*  GOTO NS CONVERT ROUTINE  */
*                        CONVNS;        /*  IF NO TIME IN BINARY     */
*/********************************************************************/
*/*      BINARY TIME TO HHMMSSTH ROUTINE                     @Z427VLS*/
*/********************************************************************/
*CONVBIN:     ;                                            /*@Z427VLS*/
CONVBIN  DS    0H                                                  0451
*        LCSWITCH='1'B;                 /* SET CONVERTED TIME SW     */
         L     @14,TIMEBASE                                        0451
         OI    LCSWITCH(@14),B'00001000'                           0451
*        WORK=TIME;                     /* PULL TIME INTO WORK AREA  */
         ICM   @12,15,TIME(@14)                                    0452
         ST    @12,WORK                                            0452
*        R6=0 ;                         /* SET WORK REG TO 0 @Z427VLS*/
         SLR   R6,R6                                               0453
*        R7=WORK;                       /* PICK UP TIME      @Z427VLS*/
         LR    R7,@12                                              0454
*        IF R7=0                        /* TEST FOR ZERO TIME        */
*              THEN                     /* IF YES            @Z427VLS*/
         LTR   R7,R7                                               0455
         BNZ   @RF00455                                            0455
*                DO;                                       /*@Z427VLS*/
*                  R7 = R7SAVE;                            /*@Z427VLS*/
         L     R7,R7SAVE                                           0457
*                  RETURN;                /* EXIT TO CALLER  @Z427VLS*/
@EL00008 DS    0H                                                  0458
@EF00008 DS    0H                                                  0458
@ER00008 LM    @14,@12,@SA00008                                    0458
         BR    @14                                                 0458
*                END;                                      /*@Z427VLS*/
*        GEN(SRL   R7,L1);              /* DIVIDE TIME BY 2  @Z427VLS*/
@RF00455 DS    0H                                                  0460
         SRL   R7,L1
*        R3=32;                         /* SET CONSTANT NO. OF BITS  */
         LA    R3,32                                               0461
*        TIMDIV=10;                     /* SET DIVISOR       @Z427VLS*/
         MVC   TIMDIV(4),@CF00033                                  0462
*        GEN(M     R6,CONSTG);          /* MULTIPLY BY BIN CLK CONST */
         M     R6,CONSTG
*        GEN(D     R6,CONSTH);          /* DIVIDE   BY BIN CLK CONST */
         D     R6,CONSTH
*CONVBINA:    ;                                            /*@Z427VLS*/
CONVBINA DS    0H                                                  0466
*        R6=0 ;                                            /*@Z427VLS*/
         SLR   R6,R6                                               0466
*        GEN(D     R6,TIMDIV);          /* DIVIDE BY CONST   @Z427VLS*/
         D     R6,TIMDIV
*        R4=R6 ;                        /* SAVE REMAINDER    @Z427VLS*/
         LR    R4,R6                                               0468
*        GEN(SRDL  R4,L4);              /* SHIFT VALUE IN REG 5      */
         SRDL  R4,L4
*        R3=R3-4 ;                      /* DEC BY 4 BITS     @Z427VLS*/
         SL    R3,@CF00065                                         0470
*        IF R7=0                        /* HAVE WE FOUND ZERO        */
*              THEN                     /* IF YES            @Z427VLS*/
         LTR   R7,R7                                               0471
         BZ    @RT00471                                            0471
*                   GOTO CONVBINB;      /* GO FINISH UP CONVERSION   */
*        IF R3<24                       /* IF R3 LESS THAN 24        */
*              THEN                     /* AND DIVISOR WITH 12       */
         C     R3,@CF00228                                         0473
         BNL   @RF00473                                            0473
*                   TIMDIV=(TIMDIV && 12);                 /*@Z427VLS*/
         L     @14,TIMDIV                                          0474
         X     @14,@CF00068                                        0474
         ST    @14,TIMDIV                                          0474
*        GOTO  CONVBINA ;               /* LOOP BACK TILL DONE       */
         B     CONVBINA                                            0475
*CONVBINB:    ;                                            /*@Z427VLS*/
CONVBINB DS    0H                                                  0477
*        GEN(SRL   R5,L0(R3));          /* SHIFT TO RIGHT ADJUST ANS */
         SRL   R5,L0(R3)
*        TIME=R5 ;                      /* PUT IT BACK INTO RECORD   */
         L     @14,TIMEBASE                                        0478
         STCM  R5,15,TIME(@14)                                     0478
*        R7 = R7SAVE;                   /* RESET REG SEVEN   @Z427VLS*/
         L     R7,R7SAVE                                           0479
*        RETURN;                        /* EXIT              @Z427VLS*/
         B     @EL00008                                            0480
*/********************************************************************/
*/*      NEW SYSTEM - TO YYDDD & HHMMSS                      @Z427VLS*/
*/********************************************************************/
*CONVNS :     ;                                            /*@Z427VLS*/
CONVNS   DS    0H                                                  0482
*        WORK8=DATETIME;                /* MOVE DATE & TIME TO WORK  */
         L     @14,TIMEBASE                                        0482
         MVC   WORK8(8),DATETIME(@14)                              0482
*        NSSWITCH='0'B;                 /* TURN OFF NS SWITCH        */
*        LCSWITCH='1'B ;                /* TURN ON LOCAL SW  @Z427VLS*/
         OI    LCSWITCH(@14),B'00001000'                           0484
         NI    NSSWITCH(@14),B'10111111'                           0484
*        IF WORK=0 &                    /* TEST FOR          @Z427VLS*/
*           WORKB=0                     /* ZERO FIELD        @Z427VLS*/
*              THEN                     /* IF YES EXIT TO CALLER     */
         SLR   @14,@14                                             0485
         C     @14,WORK                                            0485
         BNE   @RF00485                                            0485
         C     @14,WORKB                                           0485
         BNE   @RF00485                                            0485
*                DO;                                       /*@Z427VLS*/
*                  R7 = R7SAVE;                            /*@Z427VLS*/
         L     R7,R7SAVE                                           0487
*                   RETURN;                                /*@Z427VLS*/
         B     @EL00008                                            0488
*                END;                                      /*@Z427VLS*/
*        R4=WORK ;                      /* PICK UP DATE/TIME @Z427VLS*/
@RF00485 L     R4,WORK                                             0490
*        R5=WORKB;                      /* INTO WORK REGS    @Z427VLS*/
         L     R5,WORKB                                            0491
*        GEN(SRDL  R4,L12);             /* CONVERT FROM NANO TO MICRO*/
         SRDL  R4,L12
*        GEN(D     R4,SIXTYMIL);        /* DIVIDE TO GET # OF MINUTES*/
         D     R4,SIXTYMIL
*        R6=0 ;                         /*                   @Z427VLS*/
         SLR   R6,R6                                               0494
*        R7=R4;                         /* MOVE REMAINDER TO OTHER RG*/
         LR    R7,R4                                               0495
*        GEN(D    R6,MILLION);          /* DIVIDE TO GET SECONDS     */
         D    R6,MILLION
*        GEN(CVD   R7,WORK8);           /* CONVERT # OF SECONDS      */
         CVD   R7,WORK8
*        R4=WORKB;                      /* PICK IT UP TO WORK REG    */
         L     R4,WORKB                                            0498
*        SRL(R4,FOUR);                  /* MOVE IT TO HI ORDER       */
         SRL   R4,4                                                0499
*        SECS=R4;                       /* PUT BYTE INTO RECORD      */
         L     @14,TIMEBASE                                        0500
         STC   R4,SECS(,@14)                                       0500
*        R4=0 ;                         /*                   @Z427VLS*/
         SLR   R4,R4                                               0501
*        R7=R6 ;                                            /*YM6362*/
         LR    R7,R6                                               0502
*        R6= 0 ;                                            /*YM6362*/
         SLR   R6,R6                                               0503
*        GEN( D  R6,THCONV);                                /*YM6362*/
          D  R6,THCONV
*        GEN( CVD R7,WORK8) ;                               /*YM6362*/
          CVD R7,WORK8
*        R6=WORKB ;                                         /*YM6362*/
         L     R6,WORKB                                            0506
*        SRL (R6,FOUR);                                    /*@Z427VLS*/
         SRL   R6,4                                                0507
*        TNTHS=R6 ;                                         /*YM6362*/
         L     @14,TIMEBASE                                        0508
         STC   R6,TNTHS(,@14)                                      0508
*        GEN(D     R4,SIXTY);           /* DIVIDE MIN TO GET HOURS   */
         D     R4,SIXTY
*        GEN(CVD   R4,WORK8);           /* CONVERT # MINUTES @Z427VLS*/
         CVD   R4,WORK8
*        R4=WORKB;                      /* PICK UP CONVERTED #       */
         L     R4,WORKB                                            0511
*        SRL (R4,FOUR);                 /* POSITION IT       @Z427VLS*/
         SRL   R4,4                                                0512
*        MINS=R4;                       /* SET IT INTO REC AS # MINS */
         L     @14,TIMEBASE                                        0513
         STC   R4,MINS(,@14)                                       0513
*        R4=0 ;                         /*                   @Z427VLS*/
         SLR   R4,R4                                               0514
*        GEN(D     R4,TWENTY4);         /* DIVIDE TO GET HOURS       */
         D     R4,TWENTY4
*        GEN(CVD   R4,WORK8);           /* CONVERT # OF HOURS        */
         CVD   R4,WORK8
*        R4=WORKB;                      /* PICK UP VALUE     @Z427VLS*/
         L     R4,WORKB                                            0517
*        SRL (R4,FOUR);                 /* POSITION IT IN REG        */
         SRL   R4,4                                                0518
*        HOURS=R4;                      /* PUT VALUE INTO RECORD     */
         L     @14,TIMEBASE                                        0519
         STC   R4,HOURS(,@14)                                      0519
*        IF GMTSW='1'B                  /* TEST FOR BASE VALUE TO BE */
*              THEN                     /* 1900 OR 1960      @Z427VLS*/
         TM    GMTSW(@14),B'10000000'                              0520
         BNO   @RF00520                                            0520
*                DO;                                       /*@Z427VLS*/
*                  R4 = 0;              /* BIT ON BASE IS 00   YM3662*/
         SLR   R4,R4                                               0522
*                  R5 = R5 + 1;         /* INCREMENT DAY COUNT YM3662
*                                          SINCE 1900 IS NOT   YM3662
*                                          A LEAP YEAR AND     YM3662
*                                          LOOP ASSUMES IT IS  YM3662*/
         AL    R5,@CF00056                                         0523
*                END;                                      /*@Z427VLS*/
*              ELSE                     /* IF BIT OFF SET BASE TO 60 */
*                   R4=60;              /*                   @Z427VLS*/
         B     @RC00520                                            0525
@RF00520 LA    R4,60                                               0525
*LEAPYEAR:    ;                         /* R5 HAS NUMBER OF DAYS     */
@RC00520 DS    0H                                                  0526
LEAPYEAR DS    0H                                                  0527
*        R5=R5-366;                     /* DECREMENT BY A LEAP YEAR  */
         LA    @14,366                                             0527
         SLR   R5,@14                                              0527
*        IF R5 < ZERO                   /* IF TOO MUCH       @Z427VLS*/
*              THEN                     /* THEN DO THE FOLLOWING     */
         LTR   R5,R5                                               0528
         BNM   @RF00528                                            0528
*                   DO;                 /*                   @Z427VLS*/
*                        R5=R5+366;     /* BUMP BACK # OF DAYS BY 366*/
         ALR   R5,@14                                              0530
*                        GOTO CONVNSDN; /* EXIT CONVERSION DONE      */
         B     CONVNSDN                                            0531
*                   END;                /*                   @Z427VLS*/
*        R4=R4+1;                       /* ADD 1 FOR YEAR    @Z427VLS*/
@RF00528 LA    @14,1                                               0533
         ALR   R4,@14                                              0533
*                                       /*                   @Z427VLS*/
*                                       /*  DO LOOP FOR REG YEARS    */
*        DO A=1 TO 3 BY 1;                                 /*@Z427VLS*/
         ST    @14,A                                               0534
@DL00534 DS    0H                                                  0535
*              R5=R5-365;               /* DECREMENT BY 365 DAYS     */
         LA    @14,365                                             0535
         SLR   R5,@14                                              0535
*              IF R5 < ZERO                  /* HAS VALUE    @Z427VLS*/
*                   THEN                /* GON NEGATIVE      @Z427VLS*/
         LTR   R5,R5                                               0536
         BNM   @RF00536                                            0536
*                        DO;            /* IF YES THEN       @Z427VLS*/
*                             R5=R5+365;     /* ADD BACK 365 DAYS    */
         ALR   R5,@14                                              0538
*                             GOTO CONVNSDN; /* & EXIT TO FINISH UP  */
         B     CONVNSDN                                            0539
*                        END;                              /*@Z427VLS*/
*              R4=R4+1;                 /* ADD 1 YEAR        @Z427VLS*/
@RF00536 AL    R4,@CF00056                                         0541
*        END ;                          /* END OF DO LOOP REPEAT 3X  */
         LA    @14,1                                               0542
         AL    @14,A                                               0542
         ST    @14,A                                               0542
         C     @14,@CF00077                                        0542
         BNH   @DL00534                                            0542
*        GOTO LEAPYEAR;                                    /*@Z427VLS*/
         B     LEAPYEAR                                            0543
*CONVNSDN:    ;                         /* R4 HAS YEAR       @Z427VLS*/
CONVNSDN DS    0H                                                  0545
*        R5=R5+1;                       /* R5 HAS DAYS ADD 1 TO YEAR */
         AL    R5,@CF00056                                         0545
*        GEN(CVD   R4,WORK8);           /* CONVERT YEARS TO DEC      */
         CVD   R4,WORK8
*        R4=WORKB;                      /* PICK UP VALUE     @Z427VLS*/
         L     R4,WORKB                                            0547
*        SRL (R4,FOUR);                 /* & POSITION IT IN A REG    */
         SRL   R4,4                                                0548
*        YEAR=R4;                       /* PUT YEAR IN RECORD        */
         L     @14,TIMEBASE                                        0549
         STC   R4,YEAR(,@14)                                       0549
*        GEN(CVD   R5,WORK8);           /* CONVERT THE NO OF DAYS    */
         CVD   R5,WORK8
*        DAYS=(WDAYS  '000F'X);        /* PUT DAYS INTO REC WTH SIGN*/
         L     @14,TIMEBASE                                        0551
         MVC   DAYS(2,@14),WDAYS                                   0551
         OC    DAYS(2,@14),@CB00981                                0551
*        DATE0='00'X;                   /* SET HI DIGITS TO ZERO     */
         MVI   DATE0(@14),X'00'                                    0552
*        R7 = R7SAVE;                                      /*@Z427VLS*/
         L     R7,R7SAVE                                           0553
*RESPECIFY (R3,R4,R5,R6,R7) UNRESTRICTED;                  /*@Z427VLS*/
* END; /*CLOSING END TO PROC CONVTIME                        @Z427VLS*/
         B     @EL00008                                            0555
*OPENIT: PROC;                                             /*@Z427VLS*/
OPENIT   STM   @14,@12,@SA00009                                    0556
*IF OTOURIST = YES THEN                                            0557
         L     @14,SAVER2                                          0557
         TM    OTOURIST(@14),B'10000000'                           0557
         BNO   @RF00557                                            0557
*  CALL OPENTOUR;                                          /*@Z427VLS*/
         BAL   @14,OPENTOUR                                        0558
*IF OEREPPT = YES THEN                                             0559
@RF00557 L     @14,SAVER2                                          0559
         TM    OEREPPT(@14),B'01000000'                            0559
         BNO   @RF00559                                            0559
*  CALL OPENERPT;                                          /*@Z427VLS*/
         BAL   @14,OPENERPT                                        0560
*IF OSERLOG = YES THEN                                             0561
@RF00559 L     @14,SAVER2                                          0561
         TM    OSERLOG(@14),B'00100000'                            0561
         BNO   @RF00561                                            0561
*  CALL OPENSERL;                                          /*@Z427VLS*/
         BAL   @14,OPENSERL                                        0562
*IF OACCIN = YES THEN                                              0563
@RF00561 L     @14,SAVER2                                          0563
         TM    OACCIN(@14),B'00010000'                             0563
         BNO   @RF00563                                            0563
*  CALL OPENHIST;                                          /*@Z427VLS*/
         BAL   @14,OPENHIST                                        0564
*IF OACCDEV = YES THEN                                             0565
@RF00563 L     @14,SAVER2                                          0565
         TM    OACCDEV(@14),B'00001000'                            0565
         BNO   @RF00565                                            0565
*  CALL OPENDEV;                                           /*@Z427VLS*/
         BAL   @14,OPENDEV                                         0566
*IF OSYSIN = YES THEN                                              0567
@RF00565 L     @14,SAVER2                                          0567
         TM    OSYSIN(@14),B'00000100'                             0567
         BNO   @RF00567                                            0567
*  CALL OPENSYS;                                           /*@Z427VLS*/
         BAL   @14,OPENSYS                                         0568
*IF ODRCTWRK = YES THEN                                            0569
@RF00567 L     @14,SAVER2                                          0569
         TM    ODRCTWRK(@14),B'00000010'                           0569
         BNO   @RF00569                                            0569
*  CALL OPENDIR;                                           /*@Z427VLS*/
         BAL   @14,OPENDIR                                         0570
*IF OPENIO = NODSETS THEN                                          0571
@RF00569 L     @14,SAVER2                                          0571
         CLC   OPENIO(2,@14),@CB00209                              0571
         BNE   @RF00571                                            0571
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 17;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00991                                   0573
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0574
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0575
*  END;                                                    /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENIT                           @Z427VLS*/
@EL00009 DS    0H                                                  0577
@EF00009 DS    0H                                                  0577
@ER00009 LM    @14,@12,@SA00009                                    0577
         BR    @14                                                 0577
*CLOSIT: PROC; /*SELECT DATA SET SPECIFIED AND CLOSE IT      @Z427VLS*/
CLOSIT   STM   @14,@12,@SA00010                                    0578
*IF CEREPPT = YES THEN                                             0579
         L     @14,SAVER2                                          0579
         TM    CEREPPT(@14),B'01000000'                            0579
         BNO   @RF00579                                            0579
*  CALL CLOSERPT;                                          /*@Z427VLS*/
         BAL   @14,CLOSERPT                                        0580
*IF CACCIN = YES THEN                                              0581
@RF00579 L     @14,SAVER2                                          0581
         TM    CACCIN(@14),B'00010000'                             0581
         BNO   @RF00581                                            0581
*  CALL CLOSHIST;                                          /*@Z427VLS*/
         BAL   @14,CLOSHIST                                        0582
*IF CACCDEV = YES THEN                                             0583
@RF00581 L     @14,SAVER2                                          0583
         TM    CACCDEV(@14),B'00001000'                            0583
         BNO   @RF00583                                            0583
*  CALL CLOSEDEV;                                          /*@Z427VLS*/
         BAL   @14,CLOSEDEV                                        0584
*IF CSYSIN = ON THEN                                               0585
@RF00583 L     @14,SAVER2                                          0585
         TM    CSYSIN(@14),B'00000100'                             0585
         BNO   @RF00585                                            0585
*  CALL CLOSSYS;                                           /*@Z427VLS*/
         BAL   @14,CLOSSYS                                         0586
*IF CDRCTWRK = YES THEN                                            0587
@RF00585 L     @14,SAVER2                                          0587
         TM    CDRCTWRK(@14),B'00000010'                           0587
         BNO   @RF00587                                            0587
*  CALL CLOSDIR;                                           /*@Z427VLS*/
         BAL   @14,CLOSDIR                                         0588
*IF CSERLOG = YES THEN                                             0589
@RF00587 L     @14,SAVER2                                          0589
         TM    CSERLOG(@14),B'00100000'                            0589
         BNO   @RF00589                                            0589
*  CALL CLOSSERL;                                          /*@Z427VLS*/
         BAL   @14,CLOSSERL                                        0590
*IF CTOURIST = YES THEN                                            0591
@RF00589 L     @14,SAVER2                                          0591
         TM    CTOURIST(@14),B'10000000'                           0591
         BNO   @RF00591                                            0591
*  CALL CLOSTOUR;                                          /*@Z427VLS*/
         BAL   @14,CLOSTOUR                                        0592
*/*MUST CLOSE TOURIST LAST TO GET ALL POSSIBLE ERROR MESSAGES*/    0593
*/*MUST CLOSE SERLOG SECOND TO LAST IN ORDER TO FREE UP AS MUCH*/  0593
*/*BUFFER SPACE IN ORDER TO DO A POTENTIAL ZEROALL, WHICH IMPLIES*/
*/*RECORDS WRITTEN WHILE PROCESSING MUST BE SAVED IN CORE. I HOPE*/
*/*THAT EREP1 HAD ENOUGH SENSE TO FREE UP THE SORTABLE OR ITS */   0593
*/*EQUIVALENT                                                @Z427VLS*/
*IF CLOSEIO = NODSETS THEN                                         0593
@RF00591 L     @14,SAVER2                                          0593
         CLC   CLOSEIO(2,@14),@CB00209                             0593
         BNE   @RF00593                                            0593
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 32;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00522                                   0595
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0596
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0597
*  END;                                                    /*@Z427VLS*/
*END; /*CLOSING END TO CLOSIT                                @Z427VLS*/
@EL00010 DS    0H                                                  0599
@EF00010 DS    0H                                                  0599
@ER00010 LM    @14,@12,@SA00010                                    0599
         BR    @14                                                 0599
*CLOSSERL: PROC; /*CLOSE THE SERLOG DATA SET AND ALL THAT IMPLIES*/
CLOSSERL STM   @14,@12,@SA00011                                    0600
*RESPECIFY (R15,R1,R0) RESTRICTED;                         /*@Z427VLS*/
*IF SERLO = ON THEN /*ONLY ATTEMPT TO CLOSE LOGREC IF ALREADY OPEN*/
         TM    SERLO,B'10000000'                                   0602
         BNO   @RF00602                                            0602
*DO;                                                       /*@Z427VLS*/
*IF DEBUG15 = ON THEN                                              0604
         L     @14,SAVER2                                          0604
         TM    DEBUG15(@14),B'00000001'                            0604
         BNO   @RF00604                                            0604
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 56;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01005                                   0606
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0607
*  END;                                                    /*@Z427VLS*/
*IF ZEROALL = YES  /*ZEROALL MEANS RESET THE HEADER TO INDICATE NO*/
*                  /*DATA. FIRST, ANY RECORDS WRITTEN WHILE PROCESS-*/
*               /*ING ARE READ INTO CORE. SECOND, THE HEADER IS */ 0609
*               /*RESET. THIRD, SVC 76 IS ISSUED TO REWRITE THE*/  0609
*               /*RECORDS BACK TO THE NEW SERLOG             @Z427VLS*/
*  THEN DO;                                                /*@Z427VLS*/
@RF00604 L     @14,SAVER2                                          0609
         TM    ZEROALL(@14),B'01000000'                            0609
         BNO   @RF00609                                            0609
*    IF DEBUG15 = ON THEN                                          0611
         TM    DEBUG15(@14),B'00000001'                            0611
         BNO   @RF00611                                            0611
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 57;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01006                                   0613
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0614
*      END;                                                /*@Z427VLS*/
*    LASTLOOP = YES; /*INDICATE ZEROALL PROCESSING           @Z427VLS*/
@RF00611 OI    LASTLOOP,B'00000100'                                0616
*    CALL CHECKHDR; /*SET UP TO READ RECORDS WRITTEN TO LOGREC WHILE*/
         BAL   @14,CHECKHDR                                        0617
*                   /*EREP HAS BEEN PROCESSING               @Z427VLS*/
*    IF BADNEWS = ZERO THEN /*NO PROBLEMS, YES THERE ARE MORE RECORDS*/
         L     @14,BADNEWS                                         0618
         LTR   @14,@14                                             0618
         BNZ   @RF00618                                            0618
*      DO;                                                 /*@Z427VLS*/
*        CALL SAVEM; /*READ RECORDS INTO CORE                @Z427VLS*/
         BAL   @14,SAVEM                                           0620
*        CALL RESETHDR;                                    /*@Z427VLS*/
         BAL   @14,RESETHDR                                        0621
*        GEN(DEQ  (RESIDII,LOGRECB,8,SYSTEM));             /*@Z427VLS*/
         DEQ  (RESIDII,LOGRECB,8,SYSTEM)
*        RUNPTR = FRSPTR;                                  /*@Z427VLS*/
         L     @14,FRSPTR                                          0623
         ST    @14,RUNPTR                                          0623
*        IF FRSPTR ^= ZERO THEN                                    0624
         LTR   @14,@14                                             0624
         BZ    @RF00624                                            0624
*         DO UNTIL RUNPTR = ZERO;                          /*@Z427VLS*/
@DL00625 DS    0H                                                  0626
*           CALL ISSUE76;                                  /*@Z427VLS*/
         BAL   @14,ISSUE76                                         0626
*           RUNPTR = FORPTR;                               /*@Z427VLS*/
         L     @14,RUNPTR                                          0627
         L     @14,FORPTR(,@14)                                    0627
         ST    @14,RUNPTR                                          0627
*         END;                                             /*@Z427VLS*/
@DE00625 L     @14,RUNPTR                                          0628
         LTR   @14,@14                                             0628
         BNZ   @DL00625                                            0628
*      END;                                                /*@Z427VLS*/
*    ELSE                                                          0630
*      DO;     /* NO RECORDS WRITTEN WHILE PROCESSING?       @Z427VLS*/
         B     @RC00618                                            0630
@RF00618 DS    0H                                                  0631
*        IF BADNEWS = FOUR THEN                                    0631
         CLC   BADNEWS(4),@CF00065                                 0631
         BNE   @RF00631                                            0631
*          DO;                                             /*@ZA18998*/
*            BADNEWS=ZERO;                /* RESET RTN CODE  @ZA19017*/
         SLR   @14,@14                                             0633
         ST    @14,BADNEWS                                         0633
*            CALL RESETHDR;               /* RESET HEADER    @Z427VLS*/
         BAL   @14,RESETHDR                                        0634
*          END;                                            /*@ZA18998*/
*        GEN(DEQ  (RESIDII,LOGRECB,8,SYSTEM));             /*@Z427VLS*/
@RF00631 DS    0H                                                  0636
         DEQ  (RESIDII,LOGRECB,8,SYSTEM)
*      END;                                                /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
@RC00618 DS    0H                                                  0639
*GEN(DEQ   (RESID,LOGRECA,11,STEP)); /*LET OTHER EREPS AT LOGREC*/ 0639
@RF00609 DS    0H                                                  0639
         DEQ   (RESID,LOGRECA,11,STEP)
*GEN(CLOSE (LOGREC));  /*CLOSE THE DCB                       @Z427VLS*/
         CLOSE (LOGREC)
*SERLO = OFF; /*INDICATE THAT SERLOG IS CLOSED               @Z427VLS*/
         NI    SERLO,B'01111111'                                   0641
*END;                                                      /*@Z427VLS*/
*ELSE /*IF SERLOG WAS NOT OPEN                               @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00602                                            0643
@RF00602 DS    0H                                                  0644
*    IF CLOSEIO ^= CLOSEALL THEN /*END OF JOB WRAPUP CLOSEALL ALLOWED*/
         L     @14,SAVER2                                          0644
         CLC   CLOSEIO(2,@14),@CB00262                             0644
         BE    @RF00644                                            0644
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 51;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01009                                   0646
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0647
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0648
*      END;                                                /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R15,R0,R1) UNRESTRICTED;                       /*@Z427VLS*/
*END; /*CLOSING END TO PROC CLOSSERL                         @Z427VLS*/
@EL00011 DS    0H                                                  0652
@EF00011 DS    0H                                                  0652
@ER00011 LM    @14,@12,@SA00011                                    0652
         BR    @14                                                 0652
*ISSUE76: PROC;                                            /*@Z427VLS*/
ISSUE76  STM   @14,@12,@SA00012                                    0653
*RESPECIFY (R0,R1) RESTRICTED;                             /*@Z427VLS*/
*IF DEBUG15 = ON THEN                                              0655
         L     @12,SAVER2                                          0655
         TM    DEBUG15(@12),B'00000001'                            0655
         BNO   @RF00655                                            0655
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 58;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01013                                   0657
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0658
*  END;                                                    /*@Z427VLS*/
*R0 =JUNK3;                                                /*@Z427VLS*/
@RF00655 L     @12,RUNPTR                                          0660
         LH    R0,JUNK3(,@12)                                      0660
*R1 = ADDR(RECSPT);                                        /*@Z427VLS*/
         LA    R1,RECSPT(,@12)                                     0661
*R0 = R0 * (-1);                                           /*@Z427VLS*/
         LR    @12,R0                                              0662
         MH    @12,@CH01014                                        0662
         LR    R0,@12                                              0662
*SVC(76);                                                  /*@Z427VLS*/
         SVC   76                                                  0663
*RESPECIFY (R0,R1) UNRESTRICTED;                           /*@Z427VLS*/
*END; /*CLOSING END TO PROC ISSUE76                          @Z427VLS*/
@EL00012 DS    0H                                                  0665
@EF00012 DS    0H                                                  0665
@ER00012 LM    @14,@12,@SA00012                                    0665
         BR    @14                                                 0665
*SAVEM: PROC;                                              /*@Z427VLS*/
SAVEM    STM   @14,@12,@SA00013                                    0666
*RESPECIFY (R2,R3,R4,R5,R6,R15) RESTRICTED;                /*@Z427VLS*/
*DO WHILE BADNEWS = ZERO;                                  /*@Z427VLS*/
         B     @DE00668                                            0668
@DL00668 DS    0H                                                  0669
*  CALL READSER;                                           /*@Z427VLS*/
         BAL   @14,READSER                                         0669
*  IF BADNEWS = ZERO THEN                                          0670
         L     @14,BADNEWS                                         0670
         LTR   @14,@14                                             0670
         BNZ   @RF00670                                            0670
*    DO;                                                   /*@Z427VLS*/
*      DBLYES = NO;                                        /*@Z427VLS*/
         NI    DBLYES,B'11110111'                                  0672
*      GETHIS = BSZ;                                       /*@Z427VLS*/
         LH    @14,BSZ                                             0673
         ST    @14,GETHIS                                          0673
*      GETHIS = GETHIS + 12;                               /*@Z427VLS*/
         AL    @14,@CF00068                                        0674
         ST    @14,GETHIS                                          0674
*      DO WHILE DBLYES = NO;                               /*@Z427VLS*/
         B     @DE00675                                            0675
@DL00675 DS    0H                                                  0676
*        IF (GETTIT & DBLWORD) ^= NULL THEN                        0676
         MVC   @TS00001(4),GETTIT                                  0676
         NC    @TS00001(4),@CB00523                                0676
         CLC   @TS00001(4),@CB00120                                0676
         BE    @RF00676                                            0676
*          GETHIS = GETHIS + 1;                            /*@Z427VLS*/
         LA    @14,1                                               0677
         AL    @14,GETHIS                                          0677
         ST    @14,GETHIS                                          0677
*        ELSE                                                      0678
*          DBLYES = YES;                                   /*@Z427VLS*/
         B     @RC00676                                            0678
@RF00676 OI    DBLYES,B'00001000'                                  0678
*      END;                                                /*@Z427VLS*/
@RC00676 DS    0H                                                  0679
@DE00675 TM    DBLYES,B'00001000'                                  0679
         BZ    @DL00675                                            0679
*      R6 = GETTIT; /*NUMBER OF BYTES NEEDED IN R6           @Z427VLS*/
         L     R6,GETTIT                                           0680
*      GEN(GETMAIN  EC,LV=(R6),A=SAVEPTR); /*STORAGE FOR RECORD*/  0681
         GETMAIN  EC,LV=(R6),A=SAVEPTR
*      NUMRECSV = NUMRECSV + 1;                            /*@Z427VLS*/
         LA    @14,1                                               0682
         AL    @14,NUMRECSV                                        0682
         ST    @14,NUMRECSV                                        0682
*      IF R15 = ZERO THEN                                          0683
         LTR   R15,R15                                             0683
         BNZ   @RF00683                                            0683
*        DO;                                               /*@Z427VLS*/
*          IF SECGET = NO THEN /*IF FIRST RECORD SAVED THEN  @Z427VLS*/
         TM    SECGET,B'01000000'                                  0685
         BNZ   @RF00685                                            0685
*            DO;                                           /*@Z427VLS*/
*              SECGET = YES;                               /*@Z427VLS*/
         OI    SECGET,B'01000000'                                  0687
*              FRSPTR = SAVEPTR; /*POINTER TO FIRST RECORD SAVED*/ 0688
         L     @14,SAVEPTR                                         0688
         ST    @14,FRSPTR                                          0688
*              RUNPTR = SAVEPTR; /*ESTABLISH ADDRESSABILITY  @Z427VLS*/
         ST    @14,RUNPTR                                          0689
*            END;                                          /*@Z427VLS*/
*           ELSE /*IF SAVING SECOND RECORD THEN              @Z427VLS*/
*            DO;                                           /*@Z427VLS*/
         B     @RC00685                                            0691
@RF00685 DS    0H                                                  0692
*              FORPTR = SAVEPTR; /*SET FORWARD POINTER FROM OLD REC*/
         L     @14,SAVEPTR                                         0692
         L     @12,RUNPTR                                          0692
         ST    @14,FORPTR(,@12)                                    0692
*                                /*TO LOCATION OF NEW RECORD SAVE ARR*/
*              RUNPTR = SAVEPTR; /*ESTABLISH ADDRESS OF NEW RECORD*/
         ST    @14,RUNPTR                                          0693
*            END;                                          /*@Z427VLS*/
*          R2 = ADDR(JUNK);                                /*@Z427VLS*/
@RC00685 L     R2,RUNPTR                                           0695
         LA    R2,JUNK(,R2)                                        0695
*          R3 = GETHIS - 4;                                /*@Z427VLS*/
         L     R3,GETHIS                                           0696
         SL    R3,@CF00065                                         0696
*          R4 = ADDR(BCOUNT); /*MAY BE WRONG                 @Z427VLS*/
         LA    R4,BCOUNT                                           0697
*          R5 = R3;                                        /*@Z427VLS*/
         LR    R5,R3                                               0698
*          MVCL(R2,R4);                                    /*@Z427VLS*/
         MVCL  R2,R4                                               0699
*          FORPTR = ZERO;                                  /*@Z427VLS*/
         L     @14,RUNPTR                                          0700
         SLR   @12,@12                                             0700
         ST    @12,FORPTR(,@14)                                    0700
*        END;                                              /*@Z427VLS*/
*      ELSE                                                        0702
*        DO;                                               /*@Z427VLS*/
         B     @RC00683                                            0702
@RF00683 DS    0H                                                  0703
*          MSGNO = 50;                                     /*@Z427VLS*/
         MVC   MSGNO(4),@CF00294                                   0703
*          CALL ERRMSG;                                    /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0704
*          BADNEWS = TWELVE;                               /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0705
*        END;                                              /*@Z427VLS*/
*     END;                                                 /*@Z427VLS*/
@RC00683 DS    0H                                                  0708
*   END;                                                   /*@Z427VLS*/
@RF00670 DS    0H                                                  0708
@DE00668 L     @14,BADNEWS                                         0708
         LTR   @14,@14                                             0708
         BZ    @DL00668                                            0708
*RESPECIFY (R2,R3,R4,R5,R6,R15) UNRESTRICTED;              /*@Z427VLS*/
*END; /*CLOSING END TO PROC SAVEM                            @Z427VLS*/
@EL00013 DS    0H                                                  0710
@EF00013 DS    0H                                                  0710
@ER00013 LM    @14,@12,@SA00013                                    0710
         BR    @14                                                 0710
*ERRMSG: PROC; /*WRITE ERROR MESSAGES TO THE TOURIST DATA SET*/    0711
ERRMSG   STM   @14,@12,@SA00014                                    0711
*              /*IF THE PROBLEM EXISTS WITH THE TOURIST DATA SET*/ 0712
*              /*THEN WRITE TO THE OPERATOR. IF THE OPERATOR @Z427VLS*/
*              /*CANNOT BE REACHED, THEN YOU ARE ASKING TOO MUCH*/ 0712
*              /*OF THIS PROGRAM                             @Z427VLS*/
*RESPECIFY (R7,R12,R5) RESTRICTED;                         /*@Z427VLS*/
*GEN(MVC PRNTBF(134),BLANKS); /*CLEAR INTERNAL PRINT BUFFER  @Z427VLS*/
         MVC PRNTBF(134),BLANKS
*IF MSGNO <= 52 THEN            /* SYSTEM ERROR MESSAGE ?    @Z427VLS*/
         L     @06,MSGNO                                           0714
         C     @06,@CF01024                                        0714
         BH    @RF00714                                            0714
*  DO;                                                     /*@Z427VLS*/
*    CALL IFCMSG(MSGNO,ADDR(PRNTBF)+2);                    /*@Z427VLS*/
         LA    @06,PRNTBF                                          0716
         AL    @06,@CF00075                                        0716
         ST    @06,@AFTEMPS+4                                      0716
         L     @06,SAVER2                                          0716
         L     @15,ADIFCMSG(,@06)                                  0716
         LA    @01,@AL00716                                        0716
         BALR  @14,@15                                             0716
*    PRNTBF(1:2) = '1 ';                                   /*@Z427VLS*/
         MVC   PRNTBF(2),@CC01025                                  0717
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              0719
*  DO;                                                     /*@Z427VLS*/
         B     @RC00714                                            0719
@RF00714 DS    0H                                                  0720
*    MSGNO = MSGNO - 52;                                   /*@Z427VLS*/
         L     @06,MSGNO                                           0720
         SL    @06,@CF01024                                        0720
         ST    @06,MSGNO                                           0720
*    R5 = ADDR(ERRLINE) + (51 * (MSGNO - 1)); /*POINT TO MESSAGE TEXT*/
         LA    R5,ERRLINE                                          0721
         BCTR  @06,0                                               0721
         MH    @06,@CH01009                                        0721
         ALR   R5,@06                                              0721
*    GEN(MVC PRNTBF(51),0(R5)); /*MOVE TEXT TO INTERNAL PRINT BUFFER*/
         MVC PRNTBF(51),0(R5)
*  END;                                                    /*@Z427VLS*/
*PRINTADR = ADDR(PRNTBF); /*ADDRESS THE DATA SET TYPE        @Z427VLS*/
@RC00714 LA    @06,PRNTBF                                          0724
         L     @04,SAVER2                                          0724
         ST    @06,PRINTADR(,@04)                                  0724
*IF TOUROPN = YES                 THEN /*IF TOURIST DATA SET IS OPEN*/
         TM    TOUROPN,B'00000010'                                 0725
         BNO   @RF00725                                            0725
*  DO;                                                     /*@Z427VLS*/
*     R7 = PRINTADR + 1; /*POINT PAST DATA SET INDICATOR     @Z427VLS*/
         LA    R7,1                                                0727
         ALR   R7,@06                                              0727
*     CCSAVE = PRINTCC; /*SAVE CARRIAGE CONTROL FROM CALLER  @Z427VLS*/
         MVC   CCSAVE(1),PRINTCC(@06)                              0728
*     PRINTCC = '09'X; /*CARRIAGE CONTROL TO PRINT ONE LINE  @Z427VLS*/
         MVI   PRINTCC(@06),X'09'                                  0729
*     GEN(LA R12,TOURDCB); /*ADDRESS TOURIST DCB             @Z427VLS*/
         LA R12,TOURDCB
*     GEN(PUT (12),(R7));                                  /*@Z427VLS*/
         PUT (12),(R7)
*     PRINTCC = CCSAVE; /*RESTORE CALLERS CARRIAGE CONTROL   @Z427VLS*/
         L     @06,SAVER2                                          0732
         L     @04,PRINTADR(,@06)                                  0732
         MVC   PRINTCC(1,@04),CCSAVE                               0732
*     PRINTBDY = BLANKS; /*CLEAR PRINT LINE FOR CALLER       @Z427VLS*/
         MVC   PRINTBDY(132,@04),BLANKS                            0733
*     LINECTT = LINECTT + 1;                               /*@Z427VLS*/
         LA    @15,1                                               0734
         AH    @15,LINECTT                                         0734
         STH   @15,LINECTT                                         0734
*     IF LINECTT = LINECT THEN                                     0735
         CH    @15,LINECT(,@06)                                    0735
         BNE   @RF00735                                            0735
*       DO;                                                /*@Z427VLS*/
*         LINECTT = 0;                                     /*@Z427VLS*/
         SLR   @06,@06                                             0737
         STH   @06,LINECTT                                         0737
*         CCSAVE = PRINTCC;                                /*@Z427VLS*/
         MVC   CCSAVE(1),PRINTCC(@04)                              0738
*         PRINTCC = SKIPNEW;                               /*@Z427VLS*/
         MVI   PRINTCC(@04),X'8B'                                  0739
*         GEN(PUT (R12),(R7));                             /*@Z427VLS*/
         PUT (R12),(R7)
*         PRINTCC = CCSAVE;                                /*@Z427VLS*/
         L     @06,SAVER2                                          0741
         L     @06,PRINTADR(,@06)                                  0741
         MVC   PRINTCC(1,@06),CCSAVE                               0741
*       END;                                               /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
* ELSE /*IF TOURIST UNREADABLE THEN GO TO OPERATOR           @Z427VLS*/
*   CALL IFCMSG(202,ADDR(PRNTBF));                         /*@Z427VLS*/
         B     @RC00725                                            0744
@RF00725 LA    @06,PRNTBF                                          0744
         ST    @06,@AFTEMPS+4                                      0744
         L     @06,SAVER2                                          0744
         L     @15,ADIFCMSG(,@06)                                  0744
         LA    @01,@AL00744                                        0744
         BALR  @14,@15                                             0744
*RESPECIFY (R7,R12,R5) UNRESTRICTED;                       /*@Z427VLS*/
* END; /*CLOSING END TO ERRMSG PROC                          @Z427VLS*/
@EL00014 DS    0H                                                  0746
@EF00014 DS    0H                                                  0746
@ER00014 LM    @14,@12,@SA00014                                    0746
         BR    @14                                                 0746
*PRINTIT: PROC; /*SELECT PRINT DATA SET AND PRINT LINE REQUESTED*/ 0747
PRINTIT  STM   @14,@12,@SA00015                                    0747
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/
*IF PRINTDS = 'F0'X THEN /*IF PRINT TO ERREPT THEN           @Z427VLS*/
         L     @06,SAVER2                                          0749
         L     @06,PRINTADR(,@06)                                  0749
         CLI   PRINTDS(@06),X'F0'                                  0749
         BNE   @RF00749                                            0749
*  DO;                                                     /*@Z427VLS*/
*    IF ERPTOPN = ON THEN /*IF ERREPT HAS BEEN OPENED THEN   @Z427VLS*/
         TM    ERPTOPN,B'00000001'                                 0751
         BNO   @RF00751                                            0751
*      DO;                                                 /*@Z427VLS*/
*        GEN(LA R12,EREPTDCB); /*ADDRESS ERREPT DCB          @Z427VLS*/
         LA R12,EREPTDCB
*        R7 = PRINTADR + 1; /*POINT PAST THE DATA SET DEFINER*/    0754
         LA    R7,1                                                0754
         L     @06,SAVER2                                          0754
         AL    R7,PRINTADR(,@06)                                   0754
*        GEN(TR 0(1,R7),MACHCODE); /* ENSURE VALID CODE      @ZA18999*/
         TR 0(1,R7),MACHCODE
*        GEN(PUT (12),(7));                                /*@Z427VLS*/
         PUT (12),(7)
*        PRINTBDY = BLANKS; /*CLEAR PRINT LINE FOR CALLER    @Z427VLS*/
         L     @06,SAVER2                                          0757
         L     @06,PRINTADR(,@06)                                  0757
         MVC   PRINTBDY(132,@06),BLANKS                            0757
*      END;                                                /*@Z427VLS*/
*    ELSE /*REQUEST TO WRITE TO DATA SET NOT OPEN            @Z427VLS*/
*      DO;                                                 /*@Z427VLS*/
         B     @RC00751                                            0759
@RF00751 DS    0H                                                  0760
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0760
*        MSGNO = 19;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01030                                   0761
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0762
*      END;                                                /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
*ELSE /*REQUEST FOR WRITE TO TOURIST DATA SET                @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00749                                            0765
@RF00749 DS    0H                                                  0766
*    IF TOUROPN = YES THEN /*IF TOURIST DATA SET IS OPEN THEN*/    0766
         TM    TOUROPN,B'00000010'                                 0766
         BNO   @RF00766                                            0766
*      DO;                                                 /*@Z427VLS*/
*        R7 = PRINTADR + 1; /* POINT PAST DATA SET ID        @Z427VLS*/
         L     @01,SAVER2                                          0768
         L     @15,PRINTADR(,@01)                                  0768
         LA    R7,1                                                0768
         ALR   R7,@15                                              0768
*        CCSAVE = PRINTCC;                                 /*@Z427VLS*/
         MVC   CCSAVE(1),PRINTCC(@15)                              0769
*        PRINTCC = '09'X; /*SET TO PRINT AND SKIP ONE        @Z427VLS*/
         MVI   PRINTCC(@15),X'09'                                  0770
*        GEN(LA R12,TOURDCB); /*ADDRESS TOURIST DCB          @Z427VLS*/
         LA R12,TOURDCB
*        GEN(PUT (12),(7)); /*PUT TO TOURIST                 @Z427VLS*/
         PUT (12),(7)
*        PRINTCC = CCSAVE; /*RESTORE USERS CARRIAGE CONTROL  @Z427VLS*/
         L     @06,SAVER2                                          0773
         L     @15,PRINTADR(,@06)                                  0773
         MVC   PRINTCC(1,@15),CCSAVE                               0773
*        PRINTBDY = BLANKS; /*BLANKS TO CALLERS LINE         @Z427VLS*/
         MVC   PRINTBDY(132,@15),BLANKS                            0774
*        LINECTT = LINECTT + 1;                            /*@Z427VLS*/
         LA    @14,1                                               0775
         AH    @14,LINECTT                                         0775
         STH   @14,LINECTT                                         0775
*        IF LINECTT = LINECT THEN                                  0776
         CH    @14,LINECT(,@06)                                    0776
         BNE   @RF00776                                            0776
*          DO;                                             /*@Z427VLS*/
*            LINECTT = 0;                                  /*@Z427VLS*/
         SLR   @06,@06                                             0778
         STH   @06,LINECTT                                         0778
*            CCSAVE = PRINTCC;                             /*@Z427VLS*/
         MVC   CCSAVE(1),PRINTCC(@15)                              0779
*            PRINTCC = SKIPNEW;                            /*@Z427VLS*/
         MVI   PRINTCC(@15),X'8B'                                  0780
*            GEN(PUT (R12),(R7));                          /*@Z427VLS*/
         PUT (R12),(R7)
*            PRINTCC = CCSAVE;                             /*@Z427VLS*/
         L     @06,SAVER2                                          0782
         L     @06,PRINTADR(,@06)                                  0782
         MVC   PRINTCC(1,@06),CCSAVE                               0782
*          END;                                            /*@Z427VLS*/
*     END;                                                 /*@Z427VLS*/
*   ELSE  /*IMPLIES TOURIST DATA SET NOT OPEN                @Z427VLS*/
*     DO;                                                  /*@Z427VLS*/
         B     @RC00766                                            0785
@RF00766 DS    0H                                                  0786
*       CALL IFCMSG(203,ADDR(PRNTBF));                     /*@Z427VLS*/
         LA    @06,PRNTBF                                          0786
         ST    @06,@AFTEMPS+8                                      0786
         L     @06,SAVER2                                          0786
         L     @15,ADIFCMSG(,@06)                                  0786
         LA    @01,@AL00786                                        0786
         BALR  @14,@15                                             0786
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0787
*     END;                                                 /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO PROC PRINTIT                          @Z427VLS*/
@EL00015 DS    0H                                                  0791
@EF00015 DS    0H                                                  0791
@ER00015 LM    @14,@12,@SA00015                                    0791
         BR    @14                                                 0791
*OPENSYS: PROC; /*OPEN SYSIN DATA SET TO READ CARDS          @Z427VLS*/
OPENSYS  STM   @14,@12,@SA00016                                    0792
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF SYSOPN = NO THEN /* IF ALREADY OPEN IS NO NO             @Z427VLS*/
         TM    SYSOPN,B'00000100'                                  0794
         BNZ   @RF00794                                            0794
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          0796
         L     @01,SAVER2                                          0796
         TM    DEBUG15(@01),B'00000001'                            0796
         BNO   @RF00796                                            0796
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 59;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01035                                   0798
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0799
*      END;                                                /*@Z427VLS*/
*    GENERATE;                                             /*@Z427VLS*/
@RF00796 DS    0H                                                  0801
         LA    R12,SYSDCB
         OPEN  ((R12),(INPUT))
         TM    DCBOFLGS,OPENOK
         BZ    SYSOBAD
*   SYSOPN = YES;                                          /*@Z427VLS*/
         OI    SYSOPN,B'00000100'                                  0802
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              0804
*  DO;                                                     /*@Z427VLS*/
         B     @RC00794                                            0804
@RF00794 DS    0H                                                  0805
*    MSGNO = 33;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01036                                   0805
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0806
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0807
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENSYS                          @Z427VLS*/
@EL00016 DS    0H                                                  0810
@EF00016 DS    0H                                                  0810
@ER00016 LM    @14,@12,@SA00016                                    0810
         BR    @14                                                 0810
*CLOSSYS: PROC; /*CLOSE SYSIN DATA SET FOR READING CARDS     @Z427VLS*/
CLOSSYS  STM   @14,@12,@SA00017                                    0811
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF SYSOPN = YES THEN                                              0813
         TM    SYSOPN,B'00000100'                                  0813
         BNO   @RF00813                                            0813
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          0815
         L     @01,SAVER2                                          0815
         TM    DEBUG15(@01),B'00000001'                            0815
         BNO   @RF00815                                            0815
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 60;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF00832                                   0817
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0818
*      END;                                                /*@Z427VLS*/
*    GENERATE;                                             /*@Z427VLS*/
@RF00815 DS    0H                                                  0820
         CLOSE (SYSDCB)
*    SYSOPN = NO;                                          /*@Z427VLS*/
         NI    SYSOPN,B'11111011'                                  0821
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              0823
*  DO;                                                     /*@Z427VLS*/
         B     @RC00813                                            0823
@RF00813 DS    0H                                                  0824
*    IF CLOSEIO ^= CLOSEALL THEN                                   0824
         L     @01,SAVER2                                          0824
         CLC   CLOSEIO(2,@01),@CB00262                             0824
         BE    @RF00824                                            0824
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 34;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01040                                   0826
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0827
*        BADNEWS = 12;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0828
*      END;                                                /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC CLOSSYS                          @Z427VLS*/
@EL00017 DS    0H                                                  0832
@EF00017 DS    0H                                                  0832
@ER00017 LM    @14,@12,@SA00017                                    0832
         BR    @14                                                 0832
*REEDSYS: PROC OPTIONS(DONTSAVE(R7)); /*READ THE SYSIN CARDS @Z427VLS*/
REEDSYS  STM   @14,@06,@SA00018                                    0833
         STM   @08,@12,@SA00018+36                                 0833
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/
*IF SYSOPN = YES THEN                                              0835
         TM    SYSOPN,B'00000100'                                  0835
         BNO   @RF00835                                            0835
*  DO;                                                     /*@Z427VLS*/
*    SYSRDCT = SYSRDCT + 1; /*NUMBER OF READS ATTEMPTED      @Z427VLS*/
         LA    @06,1                                               0837
         AL    @06,SYSRDCT                                         0837
         ST    @06,SYSRDCT                                         0837
*    GENERATE;                                             /*@Z427VLS*/
         LA    R7,CARDSPOT
         LA    R12,SYSDCB
         GET   (12),(7)
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              0840
*  DO;                                                     /*@Z427VLS*/
         B     @RC00835                                            0840
@RF00835 DS    0H                                                  0841
*    MSGNO = 35;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01044                                   0841
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0842
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0843
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO REEDSYS PROC                          @Z427VLS*/
@EL00018 DS    0H                                                  0846
@EF00018 DS    0H                                                  0846
@ER00018 LM    @14,@06,@SA00018                                    0846
         LM    @08,@12,@SA00018+36                                 0846
         BR    @14                                                 0846
*SCRCHIT: PROC; /*WRITE TO DIRECTWK DATA SET SEQUENTIALLY    @Z427VLS*/
SCRCHIT  STM   @14,@12,@SA00019                                    0847
*RESPECIFY (R7,R12,R1) RESTRICTED;                         /*@Z427VLS*/
*IF INDIR = YES & /*IF DATA SET IS OPEN AND OPEN FOR SEQUENTIAL*/  0849
*   CLOSE2 = NO THEN /*WRITING THEN                          @Z427VLS*/
         TM    INDIR,B'00100000'                                   0849
         BNO   @RF00849                                            0849
         TM    CLOSE2,B'00001000'                                  0849
         BNZ   @RF00849                                            0849
*  DO;                                                     /*@Z427VLS*/
*    RITEWKCT = RITEWKCT + 1; /*NUMBER OF WRITE ATTEMPTS     @Z427VLS*/
         LA    @06,1                                               0851
         AL    @06,RITEWKCT                                        0851
         ST    @06,RITEWKCT                                        0851
*GENERATE;                                                 /*@Z427VLS*/
         LA    R7,BUF1     GET ADDRESS OF RECORD
*        IF FLIPFLOP = OFF THEN /*MUST REARRANGE SERLOG PRE RECORD*/
         TM    FLIPFLOP,B'00100000'                                0853
         BNZ   @RF00853                                            0853
*          DO;                                             /*@Z427VLS*/
*            BBRDW = SAVELENT; /*GET UNMODIFIED QSAM RECORD LENGTH*/
         LH    @06,SAVELENT                                        0855
         STH   @06,BBRDW                                           0855
*            BSIZE = '0000'X;                              /*@Z427VLS*/
         MVC   BSIZE(2),@CB00209                                   0856
*            R7 = ADDR(BBRDW);                             /*@Z427VLS*/
         LA    R7,BBRDW                                            0857
*          END;                                            /*@Z427VLS*/
*         GENERATE;                                        /*@Z427VLS*/
@RF00853 DS    0H                                                  0859
         LA    R12,WORKWDCB   GET DCB ADDRESS
         WRITE WORKWDEC,SF,(12),(7)  ISSUE WRITE SVC
         CHECK WORKWDEC     MAKE SURE WRITE COMPLETES BEFORE PROCEED
         NOTE  (12)     RETRIEVE RELATIVE RECORD LOCATION ON DIRECTWK
         ST    R1,TTRSAVE  SAVE TTR FOR SORTABLE
         CLC   TTRSAVE(2),MAXTRK  ARE WE ON LAST TRACK OF DATA SET
         BNL   OVERFLOW    GO TELL OF OVERFLOW CONDITION
*RECCCHHR = TTRSAVE; /*PUT IN COMTABLE FOR USER ACCESS       @Z427VLS*/
         L     @06,SAVER2                                          0860
         MVI   RECCCHHR+4(@06),C' '                                0860
         MVC   RECCCHHR(4,@06),TTRSAVE                             0860
*END;                                                      /*@Z427VLS*/
*ELSE /*IF DATA SET IS NOT OPEN                              @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00849                                            0862
@RF00849 DS    0H                                                  0863
*    MSGNO = 28;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01048                                   0863
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0864
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0865
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R12,R1) UNRESTRICTED;                       /*@Z427VLS*/
*END; /*CLOSING END TO SCRSCHT PROC                          @Z427VLS*/
@EL00019 DS    0H                                                  0868
@EF00019 DS    0H                                                  0868
@ER00019 LM    @14,@12,@SA00019                                    0868
         BR    @14                                                 0868
*DIRRDSCR: PROC OPTIONS(DONTSAVE(R7)); /*READ DIRECTWK SEQUENTIALLY*/
DIRRDSCR STM   @14,@06,@SA00020                                    0869
         STM   @08,@12,@SA00020+36                                 0869
*                                     /*USING POINT          @Z427VLS*/
*RESPECIFY (R7,R6,R12) RESTRICTED;                         /*@Z427VLS*/
*IF INDIR = YES &  /*IF DATA SET OPEN AND OPEN FOR SEQUENTIAL*/    0871
*   CLOSE2 = YES THEN /*POINT READING                        @Z427VLS*/
         TM    INDIR,B'00101000'                                   0871
         BNO   @RF00871                                            0871
*  DO;                                                     /*@Z427VLS*/
*    READWKCT = READWKCT + 1;                              /*@Z427VLS*/
         LA    @15,1                                               0873
         AL    @15,READWKCT                                        0873
         ST    @15,READWKCT                                        0873
*    GENERATE;                                             /*@Z427VLS*/
         LA    R7,BUF1
         LA    R12,WORKRDCB
         LA    R6,RECCCHHR
         A     R6,SAVER2
         POINT (12),(6)
         READ  WORKRDEC,SF,(12),(7)
         CHECK WORKRDEC
*        R7 = R7 + 4; /*POINT PAST RDW FOR RETURN TO CALLER  @Z427VLS*/
         LA    @15,4                                               0875
         ALR   R7,@15                                              0875
*        BUF1L = BUF1RDWL; /*MOVE RECORD LENGTH TO 2 BYTES BEFORE REC*/
         LH    @14,BUF1RDWL                                        0876
         STH   @14,BUF1L                                           0876
*        BUF1L = BUF1L - 4; /*RECORD DATA LENGTH ONLY        @0001VLS*/
         SLR   @14,@15                                             0877
         STH   @14,BUF1L                                           0877
*        SCRATCH = YES; /*JUST READ CURRENT RECORD OFF DIRECTWK*/  0878
         OI    SCRATCH,B'01000000'                                 0878
*        RECLNGTH = BUF1L;                                 /*@Z427VLS*/
         L     @15,SAVER2                                          0879
         STH   @14,RECLNGTH(,@15)                                  0879
*  END;                                                    /*@Z427VLS*/
*ELSE /*DATA SET NOT OPEN                                    @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00871                                            0881
@RF00871 DS    0H                                                  0882
*    MSGNO = 46;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01053                                   0882
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0883
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0884
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R6,R12) UNRESTRICTED;                       /*@Z427VLS*/
*END; /*CLOSING END TO PROC DIRRDSER                         @Z427VLS*/
@EL00020 DS    0H                                                  0887
@EF00020 DS    0H                                                  0887
@ER00020 LM    @14,@06,@SA00020                                    0887
         LM    @08,@12,@SA00020+36                                 0887
         BR    @14                                                 0887
*DIRECTIT: PROC OPTIONS(DONTSAVE(R7)); /*CHOOSE DIRECT READ OF SERLOG*/
DIRECTIT STM   @14,@06,@SA00021                                    0888
         STM   @08,@12,@SA00021+36                                 0888
*                                     /*OR DIRECTWK          @Z427VLS*/
*RESPECIFY (R7) RESTRICTED;                                /*@Z427VLS*/
*IF HISTYES = YES THEN /*IS DIRECTWK DATA SET                @Z427VLS*/
         TM    HISTYES,B'00010000'                                 0890
         BNO   @RF00890                                            0890
*  CALL DIRRDSCR;                                          /*@Z427VLS*/
         BAL   @14,DIRRDSCR                                        0891
*ELSE /*IS SERLOG BY DEFAULT                                 @Z427VLS*/
*  CALL DIRRDSER;                                          /*@Z427VLS*/
         B     @RC00890                                            0892
@RF00890 BAL   @14,DIRRDSER                                        0892
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/
*END; /*CLOSING END TO DIRECTIT                              @Z427VLS*/
@EL00021 DS    0H                                                  0894
@EF00021 DS    0H                                                  0894
@ER00021 LM    @14,@06,@SA00021                                    0894
         LM    @08,@12,@SA00021+36                                 0894
         BR    @14                                                 0894
*CLOSDIR: PROC; /*CLOSE DIRECTWK DATA SET                    @Z427VLS*/
CLOSDIR  STM   @14,@12,@SA00022                                    0895
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF INDIR = YES THEN /*IF DATA SET IS OPEN THEN              @Z427VLS*/
         TM    INDIR,B'00100000'                                   0897
         BNO   @RF00897                                            0897
*  DO;                                                     /*@Z427VLS*/
*    IF CLOSE2 = NO THEN /*IF CLOSING DIRECTWK FOR WRITING   @Z427VLS*/
         TM    CLOSE2,B'00001000'                                  0899
         BNZ   @RF00899                                            0899
*      DO;                                                 /*@Z427VLS*/
*        IF DEBUG15 = ON THEN                                      0901
         L     @01,SAVER2                                          0901
         TM    DEBUG15(@01),B'00000001'                            0901
         BNO   @RF00901                                            0901
*          DO;                                             /*@Z427VLS*/
*            MSGNO = 61;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF01060                                   0903
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0904
*          END;                                            /*@Z427VLS*/
*        CLOSE2 = YES; /*INDICATE CLOSED FOR WRITING         @Z427VLS*/
@RF00901 OI    CLOSE2,B'00001000'                                  0906
*        GENERATE;                                         /*@Z427VLS*/
         CLOSE (WORKWDCB) CLOSE WRITE DCB
         LA    R12,WORKRDCB  GET READING DCB
         OPEN  ((R12),(INPUT))     OPEN FOR READING DIRECTWK
         TM    DCBOFLGS,OPENOK   IF OPEN SUCCESSFUL
         BZ    BADBRSEQ     IF FAILS,GO PRINT MESSAGE;     /*@Z427VLS*/
*    INDIR = YES; /*INDICATE OPEN SUCCESSFUL                 @Z427VLS*/
         OI    INDIR,B'00100000'                                   0908
*   END;                                                   /*@Z427VLS*/
*  ELSE /*CLOSE FOR SEQUENTIAL POINT READING                 @Z427VLS*/
*    DO;                                                   /*@Z427VLS*/
         B     @RC00899                                            0910
@RF00899 DS    0H                                                  0911
*      IF DEBUG15 = ON THEN                                        0911
         L     @01,SAVER2                                          0911
         TM    DEBUG15(@01),B'00000001'                            0911
         BNO   @RF00911                                            0911
*        DO;                                               /*@Z427VLS*/
*          MSGNO = 62;                                     /*@Z427VLS*/
         MVC   MSGNO(4),@CF01061                                   0913
*          CALL ERRMSG;                                    /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0914
*        END;                                              /*@Z427VLS*/
*      GEN(CLOSE (WORKRDCB)); /*ISSUE CLOSE SVC              @Z427VLS*/
@RF00911 DS    0H                                                  0916
         CLOSE (WORKRDCB)
*    END;                                                  /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
* ELSE  /*CLOSE REQUESTED WHEN NOT OPEN                      @Z427VLS*/
*   DO;                                                    /*@Z427VLS*/
         B     @RC00897                                            0919
@RF00897 DS    0H                                                  0920
*     IF CLOSEIO ^= CLOSEALL THEN /*END OF JOB WRAPUP IS ALLOWED*/ 0920
         L     @01,SAVER2                                          0920
         CLC   CLOSEIO(2,@01),@CB00262                             0920
         BE    @RF00920                                            0920
*       DO;                                                /*@Z427VLS*/
*         MSGNO = 29;                                      /*@Z427VLS*/
         MVC   MSGNO(4),@CF00535                                   0922
*         CALL ERRMSG;                                     /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0923
*         BADNEWS = TWELVE;                                /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0924
*       END;                                               /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC CLOSDIR                          @Z427VLS*/
@EL00022 DS    0H                                                  0928
@EF00022 DS    0H                                                  0928
@ER00022 LM    @14,@12,@SA00022                                    0928
         BR    @14                                                 0928
*READSIT: PROC OPTIONS(DONTSAVE(R7)); /*READ FROM SERLOG OR ACCIN*/
READSIT  STM   @14,@06,@SA00023                                    0929
         STM   @08,@12,@SA00023+36                                 0929
*RESPECIFY (R7) RESTRICTED;           /*SEQUENTIALLY         @Z427VLS*/
*IF INHISO = YES THEN /*IF ACCIN IS OPEN, READ IT. IF BOTH SERLOG */
         TM    INHISO,B'00000001'                                  0931
         BNO   @RF00931                                            0931
*  CALL READHIST;     /*AND ACCIN ARE OPEN, READ ACCIN FIRST @Z427VLS*/
         BAL   @14,READHIST                                        0932
*ELSE           /*IMPLIES HISTORY NOT OPEN                   @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00931                                            0933
@RF00931 DS    0H                                                  0934
*    IF SERLO = YES THEN /*IF SERLOG IS OPEN THEN IMPLIES ACCIN*/  0934
         TM    SERLO,B'10000000'                                   0934
         BNO   @RF00934                                            0934
*      CALL READSER;    /*NEVER OPEN OR ACCIN HAS BEEN READ, CLOSED*/
         BAL   @14,READSER                                         0935
*    ELSE                /*NEITHER DATA SET OPEN IMPLIED     @Z427VLS*/
*      DO;                                                 /*@Z427VLS*/
         B     @RC00934                                            0936
@RF00934 DS    0H                                                  0937
*        BADNEWS = TWELVE; /*SET BAD RETURN CODE             @Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0937
*        MSGNO = 21;     /*INDICATE ERROR MESSAGE TEXT NUMBER*/    0938
         MVC   MSGNO(4),@CF01066                                   0938
*        CALL ERRMSG; /*PRINT THE ERROR TO TOURIST           @Z427VLS*/
         BAL   @14,ERRMSG                                          0939
*      END;                                                /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/
* END; /*CLOSING END TO READSIT PROC                         @Z427VLS*/
@EL00023 DS    0H                                                  0943
@EF00023 DS    0H                                                  0943
@ER00023 LM    @14,@06,@SA00023                                    0943
         LM    @08,@12,@SA00023+36                                 0943
         BR    @14                                                 0943
*READHIST: PROC OPTIONS(DONTSAVE(R7)); /*READ ACCIN SEQUENTIALLY*/ 0944
READHIST STM   @14,@06,@SA00024                                    0944
         STM   @08,@12,@SA00024+36                                 0944
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/
*    ACIRDCT = ACIRDCT + 1; /*ACCIN READ ATTEMPTS            @Z427VLS*/
         LA    @06,1                                               0946
         AL    @06,ACIRDCT                                         0946
         ST    @06,ACIRDCT                                         0946
*    R7 = ADDR(BUF1RDW); /*GET ADDRESS OF WORKAREA           @Z427VLS*/
         LA    R7,BUF1RDW                                          0947
*    GEN(LA R12,INHIST); /*GET ADDRESS OF DCB                @Z427VLS*/
         LA R12,INHIST
*    GEN(GET (R12),(R7)); /*RETRIEVE A RECORD. NOTE THAT RECORD WILL*/
         GET (R12),(R7)
*                       /*WILL BE HERE FOR RITE TO SCRATCH AND FOR*/
*                       /*WRITE TO ACCDEV                    @Z427VLS*/
*    R7 = R7 + 4; /*POINT PAST RDW FOR RETURN TO CALLER      @Z427VLS*/
         AL    R7,@CF00065                                         0950
*    FLIPFLOP = YES;  /*TELL READIRCT WHAT STORY IS          @Z427VLS*/
         OI    FLIPFLOP,B'00100000'                                0951
*    RECCCHHR = (RECCCHHR && RECCCHHR); /*SET TO ACCIN INPUT IN PARM*/
         L     @06,SAVER2                                          0952
         XC    RECCCHHR(5,@06),RECCCHHR(@06)                       0952
*    RECLNGTH = BUF1RDWL; /*SET REC.LNTH FROM QSAM RDW IN PARM TABLE*/
         LH    @15,BUF1RDWL                                        0953
         STH   @15,RECLNGTH(,@06)                                  0953
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO READHIST PROC                         @Z427VLS*/
@EL00024 DS    0H                                                  0955
@EF00024 DS    0H                                                  0955
@ER00024 LM    @14,@06,@SA00024                                    0955
         LM    @08,@12,@SA00024+36                                 0955
         BR    @14                                                 0955
*OPENDIR : PROC; /*OPEN DIRECTWK DATA SET FOR SEQUENTIAL LOAD*/    0956
OPENDIR  STM   @14,@12,@SA00025                                    0956
*RESPECIFY (R1,R2,R12,R3) RESTRICTED;                      /*@Z427VLS*/
*IF INDIR  = NO THEN /*IF IT HASNT BEEN OPENED BEFORE        @Z427VLS*/
         TM    INDIR,B'00100000'                                   0958
         BNZ   @RF00958                                            0958
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          0960
         L     @15,SAVER2                                          0960
         TM    DEBUG15(@15),B'00000001'                            0960
         BNO   @RF00960                                            0960
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 63;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01073                                   0962
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0963
*      END;                                                /*@Z427VLS*/
*    GEN(LA R12,WORKWDCB); /*GET ADDRESS OF DCB              @Z427VLS*/
@RF00960 DS    0H                                                  0965
         LA R12,WORKWDCB
*    GEN(OPEN ((R12),(OUTPUT))); /*OPEN DIRECTWK TO LOAD SEQUENTIALLY*/
         OPEN ((R12),(OUTPUT))
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFUL          @Z427VLS*/
         TM DCBOFLGS,OPENOK
*    GEN(BZ BADBWSEQ);  /*SET BAD RETURN CODE AND PRINT ERRMSG*/   0968
         BZ BADBWSEQ
*  GENERATE;                                               /*@Z427VLS*/
         L     R1,DCBIFLGS  FLGS NOT SET, ACTUALLY LOAD DCBEBAD
         LH    R1,46(R1) LOAD NUMBER OF TRACKS IN THIS EXTENT
         BCTR  R1,R0        SUBTRACT ONE FOR RELATIVE TRACK NUMBER
         STH   R1,MAXTRK   SAVE NUMBER OF TRACKS OF OVERFLOW CHECK
*INDIR = YES; /*SET SUCCESSFUL OPEN OF DIRECTWK FLAG         @Z427VLS*/
         OI    INDIR,B'00100000'                                   0970
*END;                                                      /*@Z427VLS*/
*ELSE /*IF DATA SET IS ALREADY OPEN                          @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00958                                            0972
@RF00958 DS    0H                                                  0973
*    BADNEWS = TWELVE; /*SET RETURN CODE TO ERROR            @Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0973
*    MSGNO = 31;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00042                                   0974
*    CALL ERRMSG; /*WRITE MESSAGE TO TOURIST DATA SET        @Z427VLS*/
         BAL   @14,ERRMSG                                          0975
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R1,R12,R2,R3) UNRESTRICTED;                    /*@Z427VLS*/
*END; /*CLOSING END TO OPENDIR PROC                          @Z427VLS*/
@EL00025 DS    0H                                                  0978
@EF00025 DS    0H                                                  0978
@ER00025 LM    @14,@12,@SA00025                                    0978
         BR    @14                                                 0978
*OPENHIST: PROC; /*OPEN ACCIN DATA SET                       @Z427VLS*/
OPENHIST STM   @14,@12,@SA00026                                    0979
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF INHISO = NO THEN /*IF IT HASNT BEEN OPENED BEFORE        @Z427VLS*/
         TM    INHISO,B'00000001'                                  0981
         BNZ   @RF00981                                            0981
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          0983
         L     @01,SAVER2                                          0983
         TM    DEBUG15(@01),B'00000001'                            0983
         BNO   @RF00983                                            0983
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 64;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF00700                                   0985
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0986
*      END;                                                /*@Z427VLS*/
*    GEN(LA R12,INHIST); /*GET ADDRESS OF DCB                @Z427VLS*/
@RF00983 DS    0H                                                  0988
         LA R12,INHIST
*    GEN(OPEN ((R12),(INPUT))); /*OPEN ACCIN                 @Z427VLS*/
         OPEN ((R12),(INPUT))
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFUL          @Z427VLS*/
         TM DCBOFLGS,OPENOK
*    GEN(BZ BDOIHST);  /*SET BAD RETURN CODE AND PRINT ERRMSG*/    0991
         BZ BDOIHST
*    GEN(TM DCBRECFM,DCBRECV); /*IS CORRECT FORMAT           @Z427VLS*/
         TM DCBRECFM,DCBRECV
*    GEN(BZ BDIST);    /*IF NOT, GO TELL WORLD, SET BAD R.C. @Z427VLS*/
         BZ BDIST
*    GEN(TM DCBRECFM,DCBRECU); /*IS RECFM U                  @Z427VLS*/
         TM DCBRECFM,DCBRECU
*    GEN(BO BDIST);                                        /*@Z427VLS*/
         BO BDIST
*    INHISO = YES; /*TELL OF SUCCESSFUL OPEN OF ACCIN        @Z427VLS*/
*    HISTYES = YES;                                        /*@Z427VLS*/
         OI    INHISO,B'00010001'                                  0997
*  END;                                                    /*@Z427VLS*/
*ELSE /*IF OPEN ASKED WHEN ALREADY OPEN                      @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00981                                            0999
@RF00981 DS    0H                                                  1000
*    MSGNO = 11; /*TELL WHAT MESSAGE NUMBER TO PRINT         @Z427VLS*/
         MVC   MSGNO(4),@CF00032                                   1000
*    CALL ERRMSG; /*GO SELECT MESSAGE AND PRINT TO TOURIST   @Z427VLS*/
         BAL   @14,ERRMSG                                          1001
*    BADNEWS = TWELVE; /*TELL USER BAD NEWS                  @Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1002
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO OPEN HISTORY INPUT DATA SET PROC      @Z427VLS*/
@EL00026 DS    0H                                                  1005
@EF00026 DS    0H                                                  1005
@ER00026 LM    @14,@12,@SA00026                                    1005
         BR    @14                                                 1005
*CLOSHIST: PROC; /*CLOSE ACCIN DATA SET                      @Z427VLS*/
CLOSHIST STM   @14,@12,@SA00027                                    1006
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF INHISO = YES THEN /*IF DATA SET IS OPEN THEN             @Z427VLS*/
         TM    INHISO,B'00000001'                                  1008
         BNO   @RF01008                                            1008
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          1010
         L     @01,SAVER2                                          1010
         TM    DEBUG15(@01),B'00000001'                            1010
         BNO   @RF01010                                            1010
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 65;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01080                                   1012
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1013
*      END;                                                /*@Z427VLS*/
*    GEN(LA  R12,INHIST); /*GET ACCIN DCB ADDRESS            @Z427VLS*/
@RF01010 DS    0H                                                  1015
         LA  R12,INHIST
*    GEN(CLOSE  (INHIST));         /*ISSUE CLOSE SVC         @Z427VLS*/
         CLOSE  (INHIST)
*    GEN(FREEPOOL  (R12)); /*GET RID OF ACCIN BUFFERS        @Z427VLS*/
         FREEPOOL  (R12)
*    INHISO = NO; /*SAY THAT ACCIN IS CLOSED                 @Z427VLS*/
         NI    INHISO,B'11111110'                                  1018
*  END;                                                    /*@Z427VLS*/
*ELSE  /*IF DATA SET IS ALREADY CLOSED                       @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC01008                                            1020
@RF01008 DS    0H                                                  1021
*    IF CLOSEIO ^= CLOSEALL THEN                                   1021
         L     @01,SAVER2                                          1021
         CLC   CLOSEIO(2,@01),@CB00262                             1021
         BE    @RF01021                                            1021
*    DO;                                                   /*@Z427VLS*/
*    MSGNO = 12;                                           /*@Z427VLS*/
         LA    @15,12                                              1023
         ST    @15,MSGNO                                           1023
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         ST    @15,BADNEWS                                         1024
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1025
*    END;                                                  /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO CLOSE ACCIN DATA SET PROC             @Z427VLS*/
@EL00027 DS    0H                                                  1029
@EF00027 DS    0H                                                  1029
@ER00027 LM    @14,@12,@SA00027                                    1029
         BR    @14                                                 1029
*CLOSEDEV: PROC; /*PROC TO CLOSE ACCDEV DATA SET             @Z427VLS*/
CLOSEDEV STM   @14,@12,@SA00028                                    1030
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF HISTOPN = YES THEN                                             1032
         TM    HISTOPN,B'10000000'                                 1032
         BNO   @RF01032                                            1032
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          1034
         L     @01,SAVER2                                          1034
         TM    DEBUG15(@01),B'00000001'                            1034
         BNO   @RF01034                                            1034
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 66;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01084                                   1036
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1037
*      END;                                                /*@Z427VLS*/
*    GEN(LA R12,OUTHIST); /*FIND ADDRESS OF DCB              @Z427VLS*/
@RF01034 DS    0H                                                  1039
         LA R12,OUTHIST
*    GEN(CLOSE (OUTHIST));       /*ISSUE CLOSE SVC           @Z427VLS*/
         CLOSE (OUTHIST)
*    GEN(FREEPOOL  (R12)); /*GET RID OF ACCDEV BUFFERS       @Z427VLS*/
         FREEPOOL  (R12)
*    HISTOPN = NO; /*SAY THAT DATA SET IS CLOSED             @Z427VLS*/
         NI    HISTOPN,B'01111111'                                 1042
*  END;                                                    /*@Z427VLS*/
*ELSE /*IF ACCDEV IS ALREADY CLOSED                          @Z427VLS*/
* DO;                                                      /*@Z427VLS*/
         B     @RC01032                                            1044
@RF01032 DS    0H                                                  1045
*   IF CLOSEIO ^= CLOSEALL /*END OF JOB STEP VALID REQUEST   @Z427VLS*/
*     THEN DO;                                             /*@Z427VLS*/
         L     @01,SAVER2                                          1045
         CLC   CLOSEIO(2,@01),@CB00262                             1045
         BE    @RF01045                                            1045
*       MSGNO = 8;                                         /*@Z427VLS*/
         MVC   MSGNO(4),@CF00035                                   1047
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1048
*       CALL ERRMSG;                                       /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1049
*     END;                                                 /*@Z427VLS*/
* END;                                                     /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC CLOSEDEV                         @Z427VLS*/
@EL00028 DS    0H                                                  1053
@EF00028 DS    0H                                                  1053
@ER00028 LM    @14,@12,@SA00028                                    1053
         BR    @14                                                 1053
*OPENTOUR : PROC; /*OPEN THE TOURIST DATA SET                @Z427VLS*/
OPENTOUR STM   @14,@12,@SA00029                                    1054
*RESPECIFY (R12,R7) RESTRICTED;                            /*@Z427VLS*/
*  IF TOUROPN = NO THEN /*ILLEGAL TO OPEN AN OPEN DATA SET   @Z427VLS*/
         TM    TOUROPN,B'00000010'                                 1056
         BNZ   @RF01056                                            1056
*    DO;                                                   /*@Z427VLS*/
*      GENERATE;                                           /*@Z427VLS*/
         LA    R12,TOURDCB
         OPEN  ((R12),(OUTPUT))
         TM    DCBOFLGS,OPENOK    CHECK FOR SUCCESS
         BZ    BADOTOUR
*      TOUROPN = YES; /*HURRAY FOR SUCCESSFUL OPEN           @Z427VLS*/
         OI    TOUROPN,B'00000010'                                 1059
*      PRINTADR = ADDR(PRNTBF);                            /*@Z427VLS*/
         LA    @06,PRNTBF                                          1060
         L     @01,SAVER2                                          1060
         ST    @06,PRINTADR(,@01)                                  1060
*      R7 = PRINTADR + 1;                                  /*@Z427VLS*/
         LA    R7,1                                                1061
         ALR   R7,@06                                              1061
*      PRINTCC = SKIPNEW;                                  /*@Z427VLS*/
         MVI   PRINTCC(@06),X'8B'                                  1062
*      GEN(PUT  (R12),(R7)); /*INITIAL SKIP TO NEW PAGE      @Z427VLS*/
         PUT  (R12),(R7)
*    END;                                                  /*@Z427VLS*/
* ELSE  /*IF TOURIST ALREADY OPEN THEN                       @Z427VLS*/
*   DO;                                                    /*@Z427VLS*/
         B     @RC01056                                            1065
@RF01056 DS    0H                                                  1066
*     MSGNO = 23;                                          /*@Z427VLS*/
         MVC   MSGNO(4),@CF01088                                   1066
*     CALL ERRMSG;                                         /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1067
*     BADNEWS = TWELVE;                                    /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1068
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R12,R7) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENTOUR                         @Z427VLS*/
@EL00029 DS    0H                                                  1071
@EF00029 DS    0H                                                  1071
@ER00029 LM    @14,@12,@SA00029                                    1071
         BR    @14                                                 1071
*CLOSTOUR: PROC; /*CLOSE THE TOURIST DATA SET                @Z427VLS*/
CLOSTOUR STM   @14,@12,@SA00030                                    1072
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF TOUROPN = YES THEN /*IF REALLY NEEDS CLOSING             @Z427VLS*/
         TM    TOUROPN,B'00000010'                                 1074
         BNO   @RF01074                                            1074
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN /*PRINT SUMMARY OF IO OPERATIONS DURING RUN*/
         L     @01,SAVER2                                          1076
         TM    DEBUG15(@01),B'00000001'                            1076
         BNO   @RF01076                                            1076
*             DO J = 1 TO 11; /*PRINT ALL DEBUG15 TOTALS     @G51DGBB*/
         LA    @15,1                                               1077
         ST    @15,J                                               1077
@DL01077 DS    0H                                                  1078
*           MSGNO = J + 70; /*INCREMENT PAST SYSTEM MESSAGES @G51DGBB*/
         AL    @15,@CF00924                                        1078
         ST    @15,MSGNO                                           1078
*          CALL ERRMSG; /*PRINT OUT SUMMARY MESSAGE TEXT     @Z427VLS*/
         BAL   @14,ERRMSG                                          1079
*          PASSNUM = CTPTR(J); /*ACCESS PARTICULAR COUNT     @Z427VLS*/
         L     @15,J                                               1080
         SLA   @15,2                                               1080
         L     @15,CTPTR-4(@15)                                    1080
         ST    @15,PASSNUM                                         1080
*          CVD(PASSNUM,PACKPAS); /*CONVERT BINARY TO PACKED  @Z427VLS*/
         CVD   @15,@TS00001                                        1081
         MVC   PACKPAS(4),@TS00001+4                               1081
*          PACKPAS = (PACKPAS  '0000000F'X); /*TURN C TO F  @Z427VLS*/
         OC    PACKPAS(4),@CB01093                                 1082
*          UNPK(EDFLD,PACKPAS); /*CHANGE PACKED TO PRINTABLE @Z427VLS*/
         UNPK  EDFLD(9),PACKPAS(4)                                 1083
*          NONBLANK = OFF;                                 /*@Z427VLS*/
         NI    NONBLANK,B'11101111'                                1084
*          DO K = 1 BY 1 TO 8 WHILE NONBLANK = OFF;        /*@Z427VLS*/
         LA    @15,1                                               1085
         ST    @15,K                                               1085
@DL01085 TM    NONBLANK,B'00010000'                                1085
         BNZ   @DC01085                                            1085
*            IF EDIFILD(K) = CHARZERO THEN                         1086
         LA    @14,EDIFILD-1(@15)                                  1086
         CLI   0(@14),X'F0'                                        1086
         BNE   @RF01086                                            1086
*              EDIFILD(K) = BLANK;                         /*@Z427VLS*/
         LA    @14,EDIFILD-1(@15)                                  1087
         MVI   0(@14),X'40'                                        1087
*            ELSE                                                  1088
*              NONBLANK = ON;                              /*@Z427VLS*/
         B     @RC01086                                            1088
@RF01086 OI    NONBLANK,B'00010000'                                1088
*          END;                                            /*@Z427VLS*/
@RC01086 LA    @15,1                                               1089
         AL    @15,K                                               1089
         ST    @15,K                                               1089
         C     @15,@CF00035                                        1089
         BNH   @DL01085                                            1089
@DC01085 DS    0H                                                  1090
*          PRINTADR = ADDR(PRNTBF);                        /*@Z427VLS*/
         LA    @15,PRNTBF                                          1090
         L     @14,SAVER2                                          1090
         ST    @15,PRINTADR(,@14)                                  1090
*          PRINTDS = '1'; /*INDICATE PRINT TO TOURIST        @Z427VLS*/
         MVI   PRINTDS(@15),C'1'                                   1091
*          PRINTBDY = (PRINTBDY && PRINTBDY);              /*@Z427VLS*/
         XC    PRINTBDY(132,@15),PRINTBDY(@15)                     1092
*          GEN(MVC PRNTBF+10(9),EDFLD);                    /*@Z427VLS*/
         MVC PRNTBF+10(9),EDFLD
*          CALL PRINTIT;                                   /*@Z427VLS*/
         BAL   @14,PRINTIT                                         1094
*        END;                                              /*@Z427VLS*/
         LA    @15,1                                               1095
         AL    @15,J                                               1095
         ST    @15,J                                               1095
         C     @15,@CF00032                                        1095
         BNH   @DL01077                                            1095
*    GENERATE;                                             /*@Z427VLS*/
@RF01076 DS    0H                                                  1096
         LA    R12,TOURDCB
         CLOSE (TOURDCB)
         FREEPOOL (12)
*    TOUROPN = NO; /*INDICATE CLOSE                          @Z427VLS*/
         NI    TOUROPN,B'11111101'                                 1097
* END;                                                     /*@Z427VLS*/
*ELSE /*IF ALREADY CLOSED THEN                               @Z427VLS*/
* DO;                                                      /*@Z427VLS*/
         B     @RC01074                                            1099
@RF01074 DS    0H                                                  1100
*   IF CLOSEIO ^= CLOSEALL THEN /*LEGAL TO DO END OF JOB WRAPUP*/  1100
         L     @15,SAVER2                                          1100
         CLC   CLOSEIO(2,@15),@CB00262                             1100
         BE    @RF01100                                            1100
*     DO;                                                  /*@Z427VLS*/
*       CALL IFCMSG(204,ADDR(PRNTBF));                     /*@Z427VLS*/
         LA    @14,PRNTBF                                          1102
         ST    @14,@AFTEMPS+12                                     1102
         L     @15,ADIFCMSG(,@15)                                  1102
         LA    @01,@AL01102                                        1102
         BALR  @14,@15                                             1102
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1103
*     END;                                                 /*@Z427VLS*/
* END;                                                     /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO CLOSTOUR PROCEDURE                    @Z427VLS*/
@EL00030 DS    0H                                                  1107
@EF00030 DS    0H                                                  1107
@ER00030 LM    @14,@12,@SA00030                                    1107
         BR    @14                                                 1107
*OPENERPT: PROC; /*OPEN THE ERREPT D.S. FOR PRINTING         @Z427VLS*/
OPENERPT STM   @14,@12,@SA00031                                    1108
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF ERPTOPN = NO THEN                                              1110
         TM    ERPTOPN,B'00000001'                                 1110
         BNZ   @RF01110                                            1110
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          1112
         L     @01,SAVER2                                          1112
         TM    DEBUG15(@01),B'00000001'                            1112
         BNO   @RF01112                                            1112
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 67;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01099                                   1114
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1115
*      END;                                                /*@Z427VLS*/
*    GENERATE;                                             /*@Z427VLS*/
@RF01112 DS    0H                                                  1117
         LA    R12,EREPTDCB
         OPEN  ((R12),(OUTPUT))
         TM    DCBOFLGS,OPENOK
         BZ    BADORPT
*    ERPTOPN = YES; /*INDICATE SUCCESSFUL OPEN               @Z427VLS*/
         OI    ERPTOPN,B'00000001'                                 1118
*  END;                                                    /*@Z427VLS*/
*ELSE /*IF OPEN REQUESTED WHEN DATA SET ALREADY OPEN         @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC01110                                            1120
@RF01110 DS    0H                                                  1121
*    MSGNO = 45;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01100                                   1121
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1122
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1123
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENERPT                         @Z427VLS*/
@EL00031 DS    0H                                                  1126
@EF00031 DS    0H                                                  1126
@ER00031 LM    @14,@12,@SA00031                                    1126
         BR    @14                                                 1126
*CLOSERPT : PROC; /*OPEN ERREPT DATA SET                     @Z427VLS*/
CLOSERPT STM   @14,@12,@SA00032                                    1127
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF ERPTOPN = YES THEN /*MUST BE OPEN IN ORDER TO CLOSE      @Z427VLS*/
         TM    ERPTOPN,B'00000001'                                 1129
         BNO   @RF01129                                            1129
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          1131
         L     @01,SAVER2                                          1131
         TM    DEBUG15(@01),B'00000001'                            1131
         BNO   @RF01131                                            1131
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 68;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01104                                   1133
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1134
*      END;                                                /*@Z427VLS*/
*    GENERATE;                                             /*@Z427VLS*/
@RF01131 DS    0H                                                  1136
         LA    R12,EREPTDCB
         CLOSE (EREPTDCB)
         FREEPOOL (R12)
*    ERPTOPN = NO; /*INDICATE ERREPT IS CLOSED               @Z427VLS*/
         NI    ERPTOPN,B'11111110'                                 1137
*  END;                                                    /*@Z427VLS*/
*ELSE /*IF CLOSE REQUESTED WHEN NOT OPEN THEN                @Z427VLS*/
* DO;                                                      /*@Z427VLS*/
         B     @RC01129                                            1139
@RF01129 DS    0H                                                  1140
*   IF CLOSEIO ^= CLOSEALL THEN  /*VALID POTPOURI OF CLOSES  @Z427VLS*/
         L     @01,SAVER2                                          1140
         CLC   CLOSEIO(2,@01),@CB00262                             1140
         BE    @RF01140                                            1140
*     DO;                                                  /*@Z427VLS*/
*       MSGNO = 22;                                        /*@Z427VLS*/
         MVC   MSGNO(4),@CF01105                                   1142
*       CALL ERRMSG;                                       /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1143
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1144
*     END;                                                 /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO CLOSERPT PROC                         @Z427VLS*/
@EL00032 DS    0H                                                  1148
@EF00032 DS    0H                                                  1148
@ER00032 LM    @14,@12,@SA00032                                    1148
         BR    @14                                                 1148
*OPENDEV: PROC; /*OPEN ACCDEV DATA SET                       @Z427VLS*/
OPENDEV  STM   @14,@12,@SA00033                                    1149
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF HISTOPN = NO THEN /*IF DATA SET HAS NOT ALREADY BEEN OPENED*/  1151
         TM    HISTOPN,B'10000000'                                 1151
         BNZ   @RF01151                                            1151
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          1153
         L     @01,SAVER2                                          1153
         TM    DEBUG15(@01),B'00000001'                            1153
         BNO   @RF01153                                            1153
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 69;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01109                                   1155
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1156
*      END;                                                /*@Z427VLS*/
*    GEN(LA (R12),OUTHIST); /*FIND ADDRESS OF DCB            @Z427VLS*/
@RF01153 DS    0H                                                  1158
         LA (R12),OUTHIST
*    GEN(OPEN ((R12),(OUTPUT,DISP))); /*ISSUE OPEN SVC       @Z427VLS*/
         OPEN ((R12),(OUTPUT,DISP))
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFULL         @Z427VLS*/
         TM DCBOFLGS,OPENOK
*    GEN(BZ BADOOHST); /*GO TO ERROR ROUTINE                 @Z427VLS*/
         BZ BADOOHST
*    HISTOPN = YES;                                        /*@Z427VLS*/
         OI    HISTOPN,B'10000000'                                 1162
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              1164
*  DO;                                                     /*@Z427VLS*/
         B     @RC01151                                            1164
@RF01151 DS    0H                                                  1165
*    MSGNO = 2;                                            /*@Z427VLS*/
         MVC   MSGNO(4),@CF00075                                   1165
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1166
*    BADNEWS = TWELVE; /*ABORT RETURN CODE                   @Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1167
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENDEV                          @Z427VLS*/
@EL00033 DS    0H                                                  1170
@EF00033 DS    0H                                                  1170
@ER00033 LM    @14,@12,@SA00033                                    1170
         BR    @14                                                 1170
*HISTIT: PROC; /*WRITE TO ACCDEV USING QSAM                  @Z427VLS*/
HISTIT   STM   @14,@12,@SA00034                                    1171
*RESPECIFY (R12,R7) RESTRICTED;                            /*@Z427VLS*/
*IF HISTOPN = YES THEN                                             1173
         TM    HISTOPN,B'10000000'                                 1173
         BNO   @RF01173                                            1173
*  DO;                                                     /*@Z427VLS*/
*    DEVCT = DEVCT + 1;                                    /*@Z427VLS*/
         LA    @06,1                                               1175
         AL    @06,DEVCT                                           1175
         ST    @06,DEVCT                                           1175
*    GEN(LA (R12),OUTHIST); /*GET DCB ADDRESS                @Z427VLS*/
         LA (R12),OUTHIST
*    R7 = ADDR(BUF1RDW); /*ADDRESS THE RECORD DESCRIPTOR WORD*/    1177
         LA    R7,BUF1RDW                                          1177
*    IF SCRATCH = YES THEN /*IF FRAMES FROM DIRECTWK, MUST FIX REC*/
         TM    SCRATCH,B'01000000'                                 1178
         BNO   @RF01178                                            1178
*      DO;                 /*ORD DESCRIPTOR WORD BECAUSE IT WAS   */
*                          /*MANGLED FOR EDSUM MODULES       @G51DGBB*/
*        BUF1RDWL = BUF1L + 4; /*RE-ADD RDW LENGTH, MOVE TO RDW   */
         LH    @06,BUF1L                                           1180
         LA    @06,4(,@06)                                         1180
         STH   @06,BUF1RDWL                                        1180
*        BUF1L = '0000'X;      /*FINISH RDW RIGHTMOST TWO BYTES   */
         SLR   @06,@06                                             1181
         STH   @06,BUF1L                                           1181
*        R7 = ADDR(BUF1);      /*POINT TO RECORD FOR QSAM PUT     */
         LA    R7,BUF1                                             1182
*      END;                                                /*@G51DGBB*/
*    ELSE   /*RECORD NOT RETRIEVED FROM DIRECTWK             @G51DGBB*/
*      IF FLIPFLOP = OFF THEN /*IF RECORD FROM READSEQ OF LOGREC*/ 1184
         B     @RC01178                                            1184
@RF01178 TM    FLIPFLOP,B'00100000'                                1184
         BNZ   @RF01184                                            1184
*        DO;                                               /*@G51DGBB*/
*          BBRDW = SAVELENT; /*GET UNMODIFIED QSAM LENGTH    @G51DGBB*/
         LH    @06,SAVELENT                                        1186
         STH   @06,BBRDW                                           1186
*          BSIZE = '0000'X; /*COMPLETE RDW                   @G51DGBB*/
         MVC   BSIZE(2),@CB00209                                   1187
*          R7 = ADDR(BBRDW);                               /*@G51DGBB*/
         LA    R7,BBRDW                                            1188
*        END;                                              /*@G51DGBB*/
*    GEN(PUT  (R12),(R7)); /*ISSUE WRITE SVC USING QSAM      @Z427VLS*/
@RF01184 DS    0H                                                  1190
@RC01178 DS    0H                                                  1190
         PUT  (R12),(R7)
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              1192
*  DO;                                                     /*@Z427VLS*/
         B     @RC01173                                            1192
@RF01173 DS    0H                                                  1193
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1193
*    MSGNO = 4;                                            /*@Z427VLS*/
         MVC   MSGNO(4),@CF00065                                   1194
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1195
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO PROC HISTIT                           @Z427VLS*/
@EL00034 DS    0H                                                  1198
@EF00034 DS    0H                                                  1198
@ER00034 LM    @14,@12,@SA00034                                    1198
         BR    @14                                                 1198
*/*PROC TO CONVERT HEX DAT INTO PRINTABLE FORMAT             @Z427VLS*/
*/* ITEM NUMBER IS NUMBER OF BYTES TO BE CONVERTED           @Z427VLS*/
*/* ITEM NEXTBY IS THE ADDRESS OF THE DATA TO BE CONVERTED   @Z427VLS*/
*/* ITEM ADDNXT IS THE LOCATION WHERE THE CONVERTED DATA IS TO BE PUT*/
*CONVERT: PROC;                                            /*@Z427VLS*/
CONVERT  STM   @14,@12,12(@13)                                     1199
*RESPECIFY (R2,R3) RESTRICTED;                             /*@Z427VLS*/
*DO J = NUMBER BY -1 TO 1;                                 /*@Z427VLS*/
         L     @12,NUMBER                                          1201
         ST    @12,J                                               1201
         B     @DE01201                                            1201
@DL01201 DS    0H                                                  1202
*  R2 = NEXTBYTE(J);                                       /*@Z427VLS*/
         L     @01,NEXTBY                                          1202
         BCTR  @01,0                                               1202
         SLR   R2,R2                                               1202
         IC    R2,NEXTBYTE(@12,@01)                                1202
*  K  = 2 * J;                                             /*@Z427VLS*/
         LR    @15,@12                                             1203
         ALR   @15,@15                                             1203
         ST    @15,K                                               1203
*  SRDL(R2,4);                                             /*@Z427VLS*/
         SRDL  R2,4                                                1204
*  SRL(R3,28);                                             /*@Z427VLS*/
         SRL   R3,28                                               1205
*  R3 = R3 + 1;                                            /*@Z427VLS*/
         LA    @14,1                                               1206
         ALR   R3,@14                                              1206
*  R2 = R2 + 1;                                            /*@Z427VLS*/
         ALR   R2,@14                                              1207
*  ADDNUM(K-1) = CHARS(R2);                                /*@Z427VLS*/
         L     @14,ADDNXT                                          1208
         ALR   @15,@14                                             1208
         BCTR  @15,0                                               1208
         BCTR  @15,0                                               1208
         LA    @01,CHARS-1(R2)                                     1208
         MVC   ADDNUM(1,@15),0(@01)                                1208
*  ADDNUM(K) = CHARS(R3);                                  /*@Z427VLS*/
         L     @15,K                                               1209
         ALR   @14,@15                                             1209
         BCTR  @14,0                                               1209
         LA    @15,CHARS-1(R3)                                     1209
         MVC   ADDNUM(1,@14),0(@15)                                1209
*END;                                                      /*@Z427VLS*/
         BCTR  @12,0                                               1210
         ST    @12,J                                               1210
@DE01201 LTR   @12,@12                                             1210
         BP    @DL01201                                            1210
*RESPECIFY (R2,R3) UNRESTRICTED;                           /*@Z427VLS*/
*END; /*CLOSING END TO PROC CONVERT                          @Z427VLS*/
@EL00035 DS    0H                                                  1212
@EF00035 DS    0H                                                  1212
@ER00035 LM    @14,@12,12(@13)                                     1212
         BR    @14                                                 1212
*BADORPT:  ; /*ERREPT  UNSUCCESSFUL OPEN                     @Z427VLS*/
BADORPT  DS    0H                                                  1214
*MSGNO = 44;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01120                                   1214
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1215
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1216
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1217
*BADOTOUR: ; /*TOURIST UNSUCCESSFUL OPEN                     @Z427VLS*/
BADOTOUR DS    0H                                                  1219
* CALL IFCMSG(205,ADDR(PRNTBF));                           /*@Z427VLS*/
         LA    @12,PRNTBF                                          1219
         ST    @12,@AFTEMPS+16                                     1219
         L     @12,SAVER2                                          1219
         L     @15,ADIFCMSG(,@12)                                  1219
         LA    @01,@AL01219                                        1219
         BALR  @14,@15                                             1219
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1220
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1221
*HISTBAD:  ; /*ERROR EXIT WRITING TO ACCDEV                  @Z427VLS*/
HISTBAD  DS    0H                                                  1223
*MSGNO = 6;                                                /*@Z427VLS*/
         MVC   MSGNO(4),@CF00082                                   1223
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1224
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1225
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1226
*HISTEND:  ; /*EOF EXIT FOR READING ACCIN                    @Z427VLS*/
HISTEND  DS    0H                                                  1228
*CALL CLOSHIST;                                            /*@Z427VLS*/
         BAL   @14,CLOSHIST                                        1228
*IF SERLO = ON THEN /*IF SERLOG IS ALSO ON WE MUST READ IT ALSO*/  1229
         TM    SERLO,B'10000000'                                   1229
         BNO   @RF01229                                            1229
* DO;                                                      /*@Z427VLS*/
*  CALL READSER; /*WILL START READING SERLOG SEQUENTIALLY THERE*/  1231
         BAL   @14,READSER                                         1231
*  GOTO GOBACK;   /*RETURN TO CALLER                         @Z427VLS*/
         B     GOBACK                                              1232
* END;                                                     /*@Z427VLS*/
*ELSE                                                              1234
*  DO;                                                     /*@Z427VLS*/
@RF01229 DS    0H                                                  1235
*    BADNEWS = FOUR; /*INDICATE EOF ON SEQUENTIAL DATA       @Z427VLS*/
         MVC   BADNEWS(4),@CF00065                                 1235
*    GOTO GOBACK;                                          /*@Z427VLS*/
         B     GOBACK                                              1236
*  END;                                                    /*@Z427VLS*/
*HISTINBD:  ; /*ERROR EXIT FOR READING ACCIN                 @Z427VLS*/
HISTINBD DS    0H                                                  1239
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1239
*MSGNO =7;                                                 /*@Z427VLS*/
         MVC   MSGNO(4),@CF00037                                   1240
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1241
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1242
*BADBRSEQ: ; /*CANT OPEN DIRECTWK FOR READ EXIT              @Z427VLS*/
BADBRSEQ DS    0H                                                  1244
*MSGNO = 30;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01132                                   1244
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1245
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1246
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1247
*BADOPENA: ; /*SERLOG OPEN FAILED EXIT                       @Z427VLS*/
BADOPENA DS    0H                                                  1249
*GEN(DEQ   (RESID,LOGRECA,11,STEP)); /*STEP DEQUEUE          @Z427VLS*/
         DEQ   (RESID,LOGRECA,11,STEP)
*MSGNO = 13;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01135                                   1250
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1251
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1252
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1253
*BADBWSEQ:  ; /*ERROR EXIT IF CANT OPEN DIRECTWK FOR WRITING @Z427VLS*/
BADBWSEQ DS    0H                                                  1255
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1255
*MSGNO = 27;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01138                                   1256
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1257
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1258
*BDIST: ; /*IMPROPER RECORD FORMAT EXIT FOR ACCIN            @Z427VLS*/
BDIST    DS    0H                                                  1260
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1260
*MSGNO = 10;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF00033                                   1261
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1262
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1263
*BDOIHST: ;  /*CANT OPEN ACCIN EXIT                          @Z427VLS*/
BDOIHST  DS    0H                                                  1265
*MSGNO = 9;                                                /*@Z427VLS*/
         MVC   MSGNO(4),@CF00034                                   1265
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1266
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1267
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1268
*BADRDIR: ; /*SYNAD FOR READING DIRECTWK D.S. SEQUENTIALLY WITH POINT*/
BADRDIR  DS    0H                                                  1270
*MSGNO = 42;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01145                                   1270
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1271
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1272
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1273
*BADOOHST: ; /*CANT OPEN ACCDEV EXIT                         @Z427VLS*/
BADOOHST DS    0H                                                  1275
*MSGNO = 3;                                                /*@Z427VLS*/
         MVC   MSGNO(4),@CF00077                                   1275
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1276
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1277
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1278
*SYSOBAD: ;                                                /*@Z427VLS*/
SYSOBAD  DS    0H                                                  1280
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1280
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1281
*SYSBAD: ;                                                 /*@Z427VLS*/
SYSBAD   DS    0H                                                  1283
*MSGNO = 36; /*SYSIN READ ERROR                              @Z427VLS*/
         MVC   MSGNO(4),@CF01152                                   1283
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1284
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1285
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1286
*OVERFLOW: ;                                               /*@Z427VLS*/
OVERFLOW DS    0H                                                  1288
*MSGNO = 37;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01155                                   1288
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1289
*MSGNO = 38;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01156                                   1290
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1291
*PRINTADR = ADDR(PRNTBF);                                  /*@Z427VLS*/
         LA    @12,PRNTBF                                          1292
         L     @01,SAVER2                                          1292
         ST    @12,PRINTADR(,@01)                                  1292
*PRINTDS = 'F1'X;                                          /*@Z427VLS*/
         MVI   PRINTDS(@12),X'F1'                                  1293
*PRINTCC = '09'X;                                          /*@Z427VLS*/
         MVI   PRINTCC(@12),X'09'                                  1294
*NUMBER = 40; /*NUMBER OF BYTES OF LAST RECORD WRITTEN TO BE PRINTED*/
         MVC   NUMBER(4),@CF00463                                  1295
*NEXTBY = R7 + 4; /*ADDRESS OF RECORD PAST RECORD LENGTH     @Z427VLS*/
         LA    @06,4                                               1296
         ALR   @06,R7                                              1296
         ST    @06,NEXTBY                                          1296
*ADDNXT = PRINTADR + 2; /*PUT PRINTABLE NUMBER HERE IN PRINT BUFFER*/
         AL    @12,@CF00075                                        1297
         ST    @12,ADDNXT                                          1297
*CALL CONVERT; /*CONVERT HEXIDECIMAL RECORD HEADER TO PRINTABLE*/  1298
         BAL   @14,CONVERT                                         1298
*CALL PRINTIT; /*WRITE RECORD LAST PROCESSED TO THE TOURIST DATA SET*/
         BAL   @14,PRINTIT                                         1299
*BADNEWS = 8;                                              /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00035                                 1300
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1301
*SYSEOF: ;                                                 /*@Z427VLS*/
SYSEOF   DS    0H                                                  1303
*BADNEWS = FOUR;                                           /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00065                                 1303
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1304
*PRINTBAD: ;                                               /*@Z427VLS*/
PRINTBAD DS    0H                                                  1306
*MSGNO = 18;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01162                                   1306
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1307
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1308
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1309
*TOURBAD: ;                                                /*@Z427VLS*/
TOURBAD  DS    0H                                                  1311
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1311
*CALL IFCMSG(202,ADDR(PRNTBF));                            /*@Z427VLS*/
         LA    @12,PRNTBF                                          1312
         ST    @12,@AFTEMPS+16                                     1312
         L     @12,SAVER2                                          1312
         L     @15,ADIFCMSG(,@12)                                  1312
         LA    @01,@AL01312                                        1312
         BALR  @14,@15                                             1312
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1313
*WRITEERR:;                                                /*@Z427VLS*/
WRITEERR DS    0H                                                  1315
*MSGNO = 26;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01167                                   1315
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1316
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1317
*GO TO GOBACK;                                             /*@Z427VLS*/
         B     GOBACK                                              1318
*/*                                                          @Z427VLS*/
*/*      BLOCK GENERATE FOR CONTROL BLOCKS & DSECT           @Z427VLS*/
*/*                                                          @Z427VLS*/
*GENERATE ;                                                /*@Z427VLS*/
OUTHIST  DCB   MACRF=(PM),SYNAD=HISTBAD,LRECL=2000,                    C
               DSORG=PS,DDNAME=ACCDEV,BUFNO=2
INHIST   DCB   MACRF=(GM),DSORG=PS,DDNAME=ACCIN,LRECL=2000,            C
               EODAD=HISTEND,SYNAD=HISTINBD,BUFNO=2
LOGREC   DCB   MACRF=(E),IOBAD=XIOB,DSORG=DA,DEVD=DA,RECFM=U,          C
               DDNAME=SERLOG
* DIRECTWK IS READ WITH THE FIRST DCB USING NOTE LOGIC AND READ WITH
* THE SECOND DCB USING POINT LOGIC
* A CLOSE TO THE FIRST DCB MUST BE ISSUED BEFORE USING THE SECOND
WORKWDCB DCB   DDNAME=DIRECTWK,DEVD=DA,DSORG=PS,BLKSIZE=2000,          C
               MACRF=(WP),RECFM=V,SYNAD=WRITEERR
WORKRDCB DCB   DDNAME=DIRECTWK,DEVD=DA,DSORG=PS,BLKSIZE=2000,          C
               MACRF=(RP),RECFM=V,SYNAD=BADRDIR
SYSDCB   DCB   DDNAME=SYSIN,DEVD=DA,DSORG=PS,EODAD=SYSEOF,             C
               LRECL=80,MACRF=GM,SYNAD=SYSBAD,EXLST=BLKEXIT    @VS48705
* NOTE THAT EREPPT COMMAND CHARACTERS HAVE FLUCTUATED BETWEEN ANSI AND
* MACHINE CHARACTERS.
EREPTDCB DCB   MACRF=(PM),SYNAD=PRINTBAD,LRECL=133,DDNAME=EREPPT,      C
               DEVD=DA,DSORG=PS,RECFM=FBM,EXLST=BLKEXIT        @VS48705
TOURDCB  DCB   MACRF=(PM),SYNAD=TOURBAD,LRECL=133,DDNAME=TOURIST,      C
               DEVD=DA,DSORG=PS,RECFM=FBM,EXLST=BLKEXIT        @VS48705
BLKEXIT  DS    0F                         ALIGN ON A FULLWORD  @VS48705
         DC    AL1(128+5),AL3(ADDBLKSZ)   DCB OPEN EXIT        @VS48705
ADDBLKSZ EQU   *                                               @VS48705
         USING IHADCB,1                                        @VS48705
         OC    DCBBLKSI(2),DCBBLKSI   BLKSIZE SPECIFIED        @VS48705
         BNZR  R14                    YES...RETURN             @VS48705
         MVC   DCBBLKSI(2),DCBLRECL   DEFAULT BLKSIZE = LRECL  @VS48705
         BR    R14                    RETURN                   @VS48705
         DROP  1                                               @VS48705
*GENERATE DATA ;                                           /*@Z427VLS*/
*/********************************************************************/
*RESPECIFY (R7,R15) UNRESTRICTED;                          /*@Z427VLS*/
*        END  /*CLOSING END TO EXTERNAL PROC IFCIOHND        @Z427VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 1322
         B     @EL00001                                            1322
@DATA    DS    0H
@CH00080 DC    H'5'
@CH00662 DC    H'20'
@CH00917 DC    H'1944'
@CH01014 DC    H'-1'
         DS    0F
@AL00335 DC    A(@CF00939)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00716 DC    A(MSGNO)                LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
@AL00744 DC    A(@CF01026)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
@AL00786 DC    A(@CF01031)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+8)
@AL01102 DC    A(@CF01095)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+12)
@AL01219 DC    A(@CF01123)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+16)
@AL01312 DC    A(@CF01026)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+16)
         DS    0F
@SA00001 DS    18F
@SA00023 DS    14F
@SA00021 DS    14F
@SA00034 DS    15F
@SA00019 DS    15F
@SA00015 DS    15F
@SA00009 DS    15F
@SA00010 DS    15F
@SA00018 DS    14F
@SA00014 DS    15F
@SA00002 DS    15F
@SA00003 DS    14F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00004 DS    14F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00029 DS    15F
@SA00031 DS    15F
@SA00026 DS    15F
@SA00033 DS    15F
@SA00016 DS    15F
@SA00025 DS    15F
@SA00032 DS    15F
@SA00027 DS    15F
@SA00028 DS    15F
@SA00017 DS    15F
@SA00022 DS    15F
@SA00011 DS    15F
@SA00030 DS    15F
@SA00013 DS    15F
@SA00012 DS    15F
@SA00020 DS    14F
@SA00024 DS    14F
@AFTEMPS DS    5F
         DS    0F
@CF00056 DC    F'1'
@CH00056 EQU   @CF00056+2
@CF00075 DC    F'2'
@CH00075 EQU   @CF00075+2
@CF00077 DC    F'3'
@CH00077 EQU   @CF00077+2
@CF00065 DC    F'4'
@CH00065 EQU   @CF00065+2
@CF00082 DC    F'6'
@CH00082 EQU   @CF00082+2
@CF00037 DC    F'7'
@CH00037 EQU   @CF00037+2
@CF00035 DC    F'8'
@CF00034 DC    F'9'
@CH00034 EQU   @CF00034+2
@CF00033 DC    F'10'
@CF00032 DC    F'11'
@CF00068 DC    F'12'
@CF01135 DC    F'13'
@CF00759 DC    F'14'
@CF00036 DC    F'15'
@CF00089 DC    F'16'
@CF00991 DC    F'17'
@CF01162 DC    F'18'
@CF01030 DC    F'19'
@CF01066 DC    F'21'
@CF01105 DC    F'22'
@CF01088 DC    F'23'
@CF00228 DC    F'24'
@CF00932 DC    F'25'
@CF01167 DC    F'26'
@CF01138 DC    F'27'
@CF01048 DC    F'28'
@CF00535 DC    F'29'
@CF01132 DC    F'30'
@CF00042 DC    F'31'
@CF00522 DC    F'32'
@CF01036 DC    F'33'
@CF01040 DC    F'34'
@CF01044 DC    F'35'
@CF01152 DC    F'36'
@CF01155 DC    F'37'
@CF01156 DC    F'38'
@CF00925 DC    F'39'
@CF00463 DC    F'40'
@CH00463 EQU   @CF00463+2
@CF00945 DC    F'41'
@CF01145 DC    F'42'
@CF01120 DC    F'44'
@CF01100 DC    F'45'
@CF01053 DC    F'46'
@CF00927 DC    F'47'
@CF00938 DC    F'48'
@CF00954 DC    F'49'
@CF00294 DC    F'50'
@CF01009 DC    F'51'
@CH01009 EQU   @CF01009+2
@CF01024 DC    F'52'
@CF00944 DC    F'53'
@CF00953 DC    F'54'
@CF00937 DC    F'55'
@CF01005 DC    F'56'
@CF01006 DC    F'57'
@CF01013 DC    F'58'
@CF01035 DC    F'59'
@CF00832 DC    F'60'
@CF01060 DC    F'61'
@CF01061 DC    F'62'
@CF01073 DC    F'63'
@CF00700 DC    F'64'
@CF01080 DC    F'65'
@CF01084 DC    F'66'
@CF01099 DC    F'67'
@CF01104 DC    F'68'
@CF01109 DC    F'69'
@CF00924 DC    F'70'
@CF00939 DC    F'201'
@CF01026 DC    F'202'
@CF01031 DC    F'203'
@CF01095 DC    F'204'
@CF01123 DC    F'205'
@CF01176 DC    XL4'0000FFFF'
         DS    0D
SAVER2   DC    A(0)
PTRSPOT  DC    A(0)
SAVEPTR  DC    A(0)
FRSPTR   DC    A(0)
RUNPTR   DC    A(0)
A        DC    F'0'
K        DC    F'0'
J        DC    F'0'
GETHIS   DC    F'0'
R7SAVE   DC    F'0'
TIMEBASE DC    A(0)
NEXTBY   DC    F'0'
ADDNXT   DC    F'0'
NUMBER   DC    F'0'
MSGNO    DC    F'0'
BADNEWS  DC    F'0'
PASSNUM  DC    F'0'
XWRECB   DC    F'0'
         ORG   XWRECB
POST     DS    CL1
@NM00017 DS    CL3
         ORG   XWRECB+4
TIMDIV   DS    F
MILLION  DC    F'1000000'
TWENTY4  DC    F'24'
SIXTY    DC    F'60'
CONSTG   DC    XL4'30040'
CONSTH   DC    XL4'24AE062'
SIXTYMIL DC    F'60000000'
THCONV   DC    F'10000'
SAVELNGT DC    H'0'
LINECTT  DC    H'0'
LINEMAX  DC    H'0'
SDRK     DC    H'0'
SAVELENT DC    H'0'
         DS    0D
@TS00001 DS    CL8
@CC01025 DC    C'1 '
@CB00120 DC    X'00000000'
@CB00523 DC    X'00000007'
@CB01093 DC    X'0000000F'
@CB00209 EQU   @CB00120
@CB00262 DC    X'FFFF'
@CB00981 DC    X'000F'
CARDSPOT DC    CL80' '
         DS    CL2
MAXTRK   DC    X'00000000'
LOOKATIT DC    CL40'XXXXXXXXOPERATION COUNTS IFCEREP1XXXXXXX'
CONTPTR  DS    CL44
         ORG   CONTPTR
ERRORENT DC    F'0'
RSEQCNT  DC    F'0'
RSERDCNT DC    F'0'
CONVTCT  DC    F'0'
NUMRECSV DC    F'0'
SYSRDCT  DC    F'0'
RITEWKCT DC    F'0'
READWKCT DC    F'0'
ACIRDCT  DC    F'0'
DEVCT    DC    F'0'
RFRCOUNT DC    F'0'
         ORG   CONTPTR+44
TTRSAVE  DC    X'00000000'
CCSAVE   DC    CL1' '
BLANKS   DC    CL134' '
PACKPAS  DC    CL4'    '
CHARPAS  DC    CL8'        '
CHARS    DC    CL16'0123456789ABCDEF'
         DS    CL5
PRNTBF   DS    CL134
         DS    CL2
BUF1     DS    CL2004
         ORG   BUF1
BUF1RDW  DS    CL4
         ORG   BUF1RDW
BUF1RDWL DC    H'0'
BUF1L    DC    H'0'
         ORG   BUF1+4
BUF1DTA  DS    CL2000
         ORG   BUF1+2004
IOSWTCH  DC    X'000000'
         ORG   IOSWTCH
HISTOPN  DS    BL1
SECGET   EQU   IOSWTCH+0
FLIPFLOP EQU   IOSWTCH+0
HISTYES  EQU   IOSWTCH+0
DBLYES   EQU   IOSWTCH+0
LASTLOOP EQU   IOSWTCH+0
TOURERR  EQU   IOSWTCH+0
INHISO   EQU   IOSWTCH+0
SERLO    DS    BL1
TWOTRY   EQU   IOSWTCH+1
INDIR    EQU   IOSWTCH+1
NONBLANK EQU   IOSWTCH+1
CLOSE2   EQU   IOSWTCH+1
SYSOPN   EQU   IOSWTCH+1
TOUROPN  EQU   IOSWTCH+1
ERPTOPN  EQU   IOSWTCH+1
READFR   DS    BL1
SCRATCH  EQU   IOSWTCH+2
SNAPOP   EQU   IOSWTCH+2
         ORG   IOSWTCH+3
         DS    CL1
HDRBUFF  DS    CL64
         ORG   HDRBUFF
HDRSEEK  DS    CL8
         ORG   HDRSEEK
HDRM     DC    X'00'
HDRBB    DC    X'0000'
HDRCC    DC    X'0000'
HDRHH    DC    X'0000'
HDRR     DC    X'00'
         ORG   HDRBUFF+8
HEADER   DS    CL40
         ORG   HEADER
HDRKEY   DS    CL2
HDRSCC   DS    CL2
HDRSHH   DS    CL2
HDRECC   DS    CL2
HDREHH   DS    CL2
HDRCOUNT DS    CL1
HDRREC1  DS    CL7
         ORG   HDRREC1
HDR1BB   DS    CL2
HDR1CC   DS    CL2
HDR1HH   DS    CL2
HDR1R    DS    CL1
         ORG   HEADER+18
HDRREM   DS    CL2
HDRTRKCP DS    CL2
HDRREC2  DS    CL7
         ORG   HDRREC2
HDR2BB   DS    CL2
HDR2CC   DS    CL2
HDR2HH   DS    CL2
HDR2R    DS    CL1
         ORG   HEADER+29
HDRUCBNO DS    CL2
HDREXSZE DS    CL2
HDRTYPE  DS    CL1
@NM00012 DS    CL4
@NM00013 DS    CL1
         ORG   @NM00013
HDRWNGBT DS    BL1
@NM00014 EQU   @NM00013+0
FRAMES   EQU   @NM00013+0
@NM00015 EQU   @NM00013+0
         ORG   HEADER+39
HDRSAFE  DS    CL1
         ORG   HDRBUFF+48
PREVSEEK DS    CL8
         ORG   PREVSEEK
PREVM    DC    X'FF'
PREVBB   DS    CL2
PREVCC   DS    CL2
PREVHH   DS    CL2
PREVR    DS    CL1
         ORG   HDRBUFF+64
LOGRECA  DC    CL11'SYS1.LOGREC'
LOGRECB  DC    CL8'RECORDER'
RESID    DC    CL8'SERLOG'
RESIDII  DC    CL8'LOGREC'
ZEROA    DS    CL24
SEEKSAVE DC    X'0000000000000000'
         ORG   SEEKSAVE
@NM00016 DS    CL7
SKSAVREC DS    CL1
         ORG   SEEKSAVE+8
         DS    CL5
XIOB     DS    CL40
         ORG   XIOB
XIOBFL1  DC    X'42'
XIOBFL2  DC    X'00'
XIOBSNS0 DC    X'00'
XIOBSNS1 DC    X'00'
XIOBECB  DC    AL4(XWRECB)
XIOBCSW  DC    X'0000000000000000'
XIOBCCW  DC    AL4(SEQ)
XIOBDCB  DS    AL4
XIOBRA   DC    A(0)
XIOBBEC  DC    F'0'
XIOBSEEK DS    CL8
         ORG   XIOBSEEK
XIOBM    DC    X'00'
XIOBBB   DC    X'0000'
XIOBCC   DC    X'0000'
XIOBHH   DC    X'0000'
XIOBR    DC    X'00'
         ORG   XIOB+40
SEQ      DS    CL24
         ORG   SEQ
SID1     DS    CL8
         ORG   SID1
@NM00018 DC    X'31'
AREAADR  DS    AL3
@NM00019 DC    X'4000'
@NM00020 DC    H'5'
         ORG   SEQ+8
TIC1     DS    CL8
         ORG   TIC1
@NM00021 DC    X'08'
@NM00022 DC    AL3(SID1)
@NM00023 DC    X'4000'
@NM00024 DC    H'1'
         ORG   SEQ+16
CKD1     DS    CL8
         ORG   CKD1
CKDCOM   DS    CL1
CKDAREA  DS    AL3
CKDCHAIN DC    X'20'
@NM00025 DC    X'00'
CKDCOUNT DS    FL2
         ORG   SEQ+24
SWITCH   DC    X'00'
         ORG   SWITCH
SBT0     DS    BL1
SBT2     EQU   SWITCH+0
SBT3     EQU   SWITCH+0
SBT4     EQU   SWITCH+0
SBT7     EQU   SWITCH+0
         ORG   SWITCH+1
         DS    CL7
WORK8    DS    CL8
         ORG   WORK8
WORK     DS    FL4
WORKB    DS    FL4
         ORG   WORKB
WHOURS   DS    CL1
WMINS    DS    CL1
WDAYS    DS    CL2
         ORG   WDAYS
WSECS    DS    CL1
WTNTHS   DS    CL1
         ORG   WORK8+8
SUPERZAP DC    3CL10'SUPERZAP'
EDIFILD  DS    9CL1
ERRLINE  DS    CL51
         ORG   ERRLINE+0
ERRDS    DC    CL1'1'
ERRCS    DC    CL1' '
PRINTNM  DC    CL9'DEBUG15  '
PRNTXT   DC    CL40'SERLOG OPEN ATTEMPTED                   '
         ORG   ERRLINE+51
         ORG   ERRLINE+51
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'CHECK HEADER FOR MORE RECORDS ATTEMPTED '
         ORG   ERRLINE+102
         ORG   ERRLINE+102
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'RESET OF SERLOG HEADER ATTEMPTED        '
         ORG   ERRLINE+153
         ORG   ERRLINE+153
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SERLOG CLOSE ATTEMPTED                  '
         ORG   ERRLINE+204
         ORG   ERRLINE+204
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ZEROALL ATTEMPTED                       '
         ORG   ERRLINE+255
         ORG   ERRLINE+255
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SDR COUNTER DUMP ATTEMPTED              '
         ORG   ERRLINE+306
         ORG   ERRLINE+306
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SYSIN OPEN ATTEMPTED                    '
         ORG   ERRLINE+357
         ORG   ERRLINE+357
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SYSIN CLOSE ATTEMPTED                   '
         ORG   ERRLINE+408
         ORG   ERRLINE+408
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK CLOSE FOR WRITING ATTEMPTED    '
         ORG   ERRLINE+459
         ORG   ERRLINE+459
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK CLOSE FOR READING ATTEMPTED    '
         ORG   ERRLINE+510
         ORG   ERRLINE+510
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK OPEN FOR WRITE ATTEMPTED      '
         ORG   ERRLINE+561
         ORG   ERRLINE+561
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCIN OPEN ATTEMPTED                    '
         ORG   ERRLINE+612
         ORG   ERRLINE+612
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCIN CLOSE ATTEMPTED                   '
         ORG   ERRLINE+663
         ORG   ERRLINE+663
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCDEV CLOSE ATTEMPTED                  '
         ORG   ERRLINE+714
         ORG   ERRLINE+714
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'EREPPT OPEN ATTEMPTED                   '
         ORG   ERRLINE+765
         ORG   ERRLINE+765
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'EREPPT CLOSE ATTEMPTED                  '
         ORG   ERRLINE+816
         ORG   ERRLINE+816
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCDEV OPEN ATTEMPTED                   '
         ORG   ERRLINE+867
         ORG   ERRLINE+867
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'FIRST FRAME READ ATTEMPT                '
         ORG   ERRLINE+918
         ORG   ERRLINE+918
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'TIMES IFCIOHND EXITED WITH R.C.12       '
         ORG   ERRLINE+969
         ORG   ERRLINE+969
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SERLOG SEQUENTIAL READ ATTEMPTS         '
         ORG   ERRLINE+1020
         ORG   ERRLINE+1020
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SERLOG DIRECT READ ATTEMPTS             '
         ORG   ERRLINE+1071
         ORG   ERRLINE+1071
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'TIME CONVERSION NECESSARY NUM. TIMES    '
         ORG   ERRLINE+1122
         ORG   ERRLINE+1122
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'RECORDS SAVED DURING ZEROALL PROCESSING '
         ORG   ERRLINE+1173
         ORG   ERRLINE+1173
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SYSIN READ ATTEMPTS                     '
         ORG   ERRLINE+1224
         ORG   ERRLINE+1224
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK WRITE ATTEMPTS                 '
         ORG   ERRLINE+1275
         ORG   ERRLINE+1275
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK READ ATTEMPTS                  '
         ORG   ERRLINE+1326
         ORG   ERRLINE+1326
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCIN SEQUENTIAL READ ATTEMPTS          '
         ORG   ERRLINE+1377
         ORG   ERRLINE+1377
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCDEV WRITE ATTEMPTS                   '
         ORG   ERRLINE+1428
         ORG   ERRLINE+1428
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'FRAME READ ATTEMPTS OF SYS1.LOGREC      '
         ORG   ERRLINE+1479
MACHCODE DC    11X'09'
         DC    X'0B'
         DC    5X'09'
         DC    X'11'
         DC    X'09'
         DC    X'13'
         DC    5X'09'
         DC    X'19'
         DC    X'09'
         DC    X'1B'
         DC    109X'09'
         DC    X'89'
         DC    X'09'
         DC    X'8B'
         DC    5X'09'
         DC    X'91'
         DC    X'09'
         DC    X'93'
         DC    5X'09'
         DC    X'99'
         DC    X'09'
         DC    X'9B'
         DC    5X'09'
         DC    X'A1'
         DC    X'09'
         DC    X'A3'
         DC    5X'09'
         DC    X'A9'
         DC    X'09'
         DC    X'AB'
         DC    5X'09'
         DC    X'B1'
         DC    X'09'
         DC    X'B3'
         DC    5X'09'
         DC    X'B9'
         DC    X'09'
         DC    X'BB'
         DC    5X'09'
         DC    X'C1'
         DC    X'09'
         DC    X'C3'
         DC    5X'09'
         DC    X'C9'
         DC    X'09'
         DC    X'CB'
         DC    5X'09'
         DC    X'D1'
         DC    X'09'
         DC    X'D3'
         DC    5X'09'
         DC    X'D9'
         DC    X'09'
         DC    X'DB'
         DC    5X'09'
         DC    X'E1'
         DC    X'09'
         DC    X'E3'
         DC    20X'09'
         DS    8XL1
BYTESREM DC    H'0'
         DC    H'3419'
         DC    H'20137'
         DC    H'4596'
         DC    H'4778'
         DC    H'0'
         DC    H'13192'
         DC    H'14184'
         DC    H'7008'
         DC    H'12680'
         DC    H'7954'
         DC    H'18800'
         DC    H'0'
         DC    H'12680'
PATCH    DC    20H'0'
IFCIOHND CSECT
         DC    S(SUPERZAP)
IFCIOHND CSECT
         DC    S(PATCH)
IFCIOHND CSECT
         DCBD  DSORG=PS,DEVD=DA         DCB DSECT
IFCIOHND CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R2       EQU   @02
R1       EQU   @01
R7       EQU   @07
R0       EQU   @00
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R12      EQU   @12
R15      EQU   @15
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
R14      EQU   @14
R8       EQU   @08
R9       EQU   @09
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
NOSDR    EQU   SWITCHES
ZEROALL  EQU   SWITCHES+1
DEBUG    EQU   PARM+4
DEBUG15  EQU   DEBUG+1
DEBUGA   EQU   PARM+8
MISC     EQU   PARM+12
PRINTES  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
OTOURIST EQU   OPENIO
OEREPPT  EQU   OPENIO
OSERLOG  EQU   OPENIO
OACCIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OSYSIN   EQU   OPENIO
ODRCTWRK EQU   OPENIO
CLOSEIO  EQU   OPENCLSE+2
CTOURIST EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CSERLOG  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
@NM00007 EQU   PARM+75
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECCCHHR EQU   CCHHRLNG
RECLNGTH EQU   CCHHRLNG+6
LINECT   EQU   PARM+120
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVKEY    EQU   EVTABLE+6
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHAREIO  EQU   SHARE+2
SHRCUCPU EQU   SHAREIO
SHARECUA EQU   SHRCUCPU
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUAVAL   EQU   CUA+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
VOLUME   EQU   0
CPUS     EQU   0
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
NEXTBYTE EQU   0
ADDNUM   EQU   0
LISTPTR  EQU   0
INARG    EQU   0
IOPLINE  EQU   0
PRINTDS  EQU   IOPLINE
PRINTCC  EQU   IOPLINE+1
PRINTBDY EQU   IOPLINE+2
RECTB    EQU   0
FORPTR   EQU   RECTB
JUNK     EQU   RECTB+4
JUNK3    EQU   JUNK+6
RECSPT   EQU   RECTB+12
OHEADER  EQU   0
OHDRREC1 EQU   OHEADER+11
OHDRREC2 EQU   OHEADER+22
RECAREA  EQU   0
@NM00028 EQU   RECAREA+2
NSSWITCH EQU   @NM00028
LCSWITCH EQU   @NM00028
DATETIME EQU   RECAREA+8
DATE     EQU   DATETIME
DATE0    EQU   DATE
GMTSW    EQU   DATE0
YEAR     EQU   DATE+1
DAYS     EQU   DATE+2
TIME     EQU   DATETIME+4
HOURS    EQU   TIME
MINS     EQU   TIME+1
SECS     EQU   TIME+2
TNTHS    EQU   TIME+3
IOHND    EQU   0
GETTIT   EQU   GETHIS
EDFLD    EQU   EDIFILD
CTPTR    EQU   CONTPTR
BUFFER   EQU   BUF1
BCOUNT   EQU   BUFFER
BCCHHR   EQU   BCOUNT
BSIZE    EQU   BCOUNT+6
BDATA    EQU   BUFFER+8
BSZ      EQU   BSIZE
BBRDW    EQU   BCCHHR+4
TRECCH   EQU   TRECCH0
TRKNUM   EQU   MAXTRK
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
BKEYL    EQU   BCOUNT+5
@NM00032 EQU   DATE0
@NM00031 EQU   @NM00028
@NM00030 EQU   @NM00028
@NM00029 EQU   @NM00028
@NM00027 EQU   RECAREA+1
RECKEY   EQU   RECAREA
OHDRSAFE EQU   OHEADER+39
@NM00026 EQU   OHEADER+34
OHDRTYP  EQU   OHEADER+33
OHDREXSZ EQU   OHEADER+31
OHDRUCBN EQU   OHEADER+29
OHDR2R   EQU   OHDRREC2+6
OHDR2HH  EQU   OHDRREC2+4
OHDR2CC  EQU   OHDRREC2+2
OHDR2BB  EQU   OHDRREC2
OHDRTRXC EQU   OHEADER+20
OHDRREM  EQU   OHEADER+18
OHDR1R   EQU   OHDRREC1+6
OHDR1HH  EQU   OHDRREC1+4
OHDR1CC  EQU   OHDRREC1+2
OHDR1BB  EQU   OHDRREC1
OHDRHI   EQU   OHEADER+10
OHDREHH  EQU   OHEADER+8
OHDRECC  EQU   OHEADER+6
OHDRSHH  EQU   OHEADER+4
OHDRSCC  EQU   OHEADER+2
OHDRKEY  EQU   OHEADER
JUNK2    EQU   JUNK+5
JUNK1    EQU   JUNK
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
CPUVAL   EQU   CPUS+2
CPUNUM   EQU   CPUS
VOLVAL   EQU   VOLUME+2
VOLNUM   EQU   VOLUME
SERVAL   EQU   DEVSERAL+2
SERNUM   EQU   DEVSERAL
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
CUA2     EQU   CUAVAL+2
CUA1     EQU   CUAVAL
CUANUM   EQU   CUA
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+10
SHARSERB EQU   SHAREIO+7
SHARECUB EQU   SHAREIO+5
SHARSERA EQU   SHRCUCPU+2
SHAREDX  EQU   SHARECUA
SHARENUM EQU   SHARE
SYSTEMP  EQU   SYSUM2+9
SYSPERM  EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
EVLETTER EQU   EVKEY+5
EVSERIAL EQU   EVKEY+2
EVMODEL  EQU   EVKEY
EVNUM    EQU   EVTABLE+4
EVDAY    EQU   EVSTOP+1
EVYEAR   EQU   EVSTOP
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
@NM00009 EQU   CCHHRLNG+5
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
SORTNUM  EQU   PARM+84
TABSIZE  EQU   PARM+80
SYSRETRN EQU   @NM00007
@NM00006 EQU   PARM+72
WRTHRSH  EQU   PARM+69
RDTHRSH  EQU   PARM+66
TERM     EQU   PARM+58
EVSDAY   EQU   STRTDATE+1
EVSYEAR  EQU   STRTDATE
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
OSNAP    EQU   OPENIO
PASSFLAG EQU   MISC
PLOGREC  EQU   MISC
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PHIST    EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG12  EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG4   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
SHIFT3RD EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00172 EQU   @EL00001
@RF00213 EQU   @RC00211
@RC00215 EQU   @RC00211
@RC00232 EQU   @RC00211
@RC00209 EQU   @EL00003
@RC00283 EQU   @EL00004
@RF00330 EQU   @EL00005
@RT00366 EQU   HDRERR0
@RT00368 EQU   HDRERR1
@RT00413 EQU   CHK03
@RT00415 EQU   CHK04
@RT00445 EQU   @EL00008
@RT00448 EQU   CONVNS
@RT00471 EQU   CONVBINB
@RF00473 EQU   CONVBINA
@RF00571 EQU   @EL00009
@RF00593 EQU   @EL00010
@RF00624 EQU   @RC00618
@RC00602 EQU   @EL00011
@RF00644 EQU   @EL00011
@RC00725 EQU   @EL00014
@RC00749 EQU   @EL00015
@RC00766 EQU   @EL00015
@RC00794 EQU   @EL00016
@RC00813 EQU   @EL00017
@RF00824 EQU   @EL00017
@RC00835 EQU   @EL00018
@RC00849 EQU   @EL00019
@RC00871 EQU   @EL00020
@RC00890 EQU   @EL00021
@RC00897 EQU   @EL00022
@RF00920 EQU   @EL00022
@RC00931 EQU   @EL00023
@RC00934 EQU   @EL00023
@RC00958 EQU   @EL00025
@RC00981 EQU   @EL00026
@RC01008 EQU   @EL00027
@RF01021 EQU   @EL00027
@RC01032 EQU   @EL00028
@RF01045 EQU   @EL00028
@RC01056 EQU   @EL00029
@RC01074 EQU   @EL00030
@RF01100 EQU   @EL00030
@RC01110 EQU   @EL00031
@RC01129 EQU   @EL00032
@RF01140 EQU   @EL00032
@RC01151 EQU   @EL00033
@RC01173 EQU   @EL00034
@RF00219 EQU   @RC00215
@RF00251 EQU   @RC00209
@RC00255 EQU   @RC00209
@RF00735 EQU   @RC00725
@RC00751 EQU   @RC00749
@RF00776 EQU   @RC00766
@RC00899 EQU   @RC00897
@ENDDATA EQU   *
         END   IFCIOHND,(C'PLS2213',0701,78012)

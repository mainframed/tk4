         TITLE 'IFCMES01 - CONTROL FOR MEDIA ERROR STATISTICS PROCESSIN*
               NG       '
IFCMES01 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCMES01  78.017'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         B     @PB00002                                            0073
SORT     STM   @14,@12,@SA00002                                    0073
*SRTCONT =((RECCOUNT-1)* 11) + CURRPTR;                    /*@Z427VLS*/
         LH    @03,RECCOUNT                                        0076
         BCTR  @03,0                                               0076
         MH    @03,@CH00575                                        0076
         ALR   @03,CURRPTR                                         0076
         ST    @03,SRTCONT                                         0076
*/* THIS SORT IS DONE IN BAL IN ORDER TO GET MIN PROCESSING TIME    */
*/* SOME 35 INSTRUCTIONS WERE CUT FROM THE BEST THAT PLS WOULD DO   */
*/* THIS CUT THE RUN TIME DOWN BY APP. 50 PERCENT            @Z427VLS*/
*         GENERATE REFS(CONTRTAB);                         /*@Z427VLS*/
          LA     R15,11              LOAD THE INCREMENT VALUE
          LR     R7,CURRPTR          LOAD THE START OF THE TABLE
          L      R4,SRTCONT          LOAD THE MAX LIMIT
          LR     R1,R7               SET UP THE STOP LIMIT ON BACK UP
          B      DOIT                GO AROUND THIS CODE FIRST TIME
LOOPBCK1  ALR    R7,R15              MOVE THE POINTER TO NEXT ENTRY
          CR     R7,R4               ARE WE POINTING TO LAST ENTRY
          BNL    DONE                FINISHED WITH THE SORT SO EXIT
DOIT      CLC    CONTRTAB(11,R7),CONTRTAB+11(R7)
         BNH   LOOPBCK1            DONT NEED TO SORT ITEM
          XC     CONTRTAB(11,R7),CONTRTAB+11(R7)
          XC     CONTRTAB+11(11,R7),CONTRTAB(R7)
          XC     CONTRTAB(11,R7),CONTRTAB+11(R7)
          LR     R6,R7               SET NEW POINTER(BACKWARD)
LOOPBCK2  SR     R6,R15              POINT TO LAST ENTRY
          CR     R6,R1               DONT BACK OUT OF THE TABLE
          BL     LOOPBCK1            START WITH NEXT ENTRY
          CLC    CONTRTAB(11,R6),CONTRTAB+11(R6)
          BNH    LOOPBCK1            NO FUTHER SHUFFEL THIS SAMPLE
          XC     CONTRTAB+11(11,R6),CONTRTAB(R6)
          XC     CONTRTAB(11,R6),CONTRTAB+11(R6)
          XC     CONTRTAB+11(11,R6),CONTRTAB(R6)
          B      LOOPBCK2            DOES IT NEED TO BE MOVED AGAIN
DONE      EQU    *
*      RESPECIFY (R6) UNRESTRICTED;                        /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00002 DS    0H                                                  0079
@EF00002 DS    0H                                                  0079
@ER00002 LM    @14,@12,@SA00002                                    0079
         BR    @14                                                 0079
*/*                                                          @Z427VLS*/
*/* OUTPUT ALL OF THE SUMMARY COUNTERS THAT HAVE BEEN BUILT UP TO THIS*
*/* POINT.  CNTAREA CONTAINS THE ADDRESS OF THE FIRST COUNTER AREA.   *
*/*                                                          @Z427VLS*/
*OUTSUM: PROC;                                             /*@Z427VLS*/
OUTSUM   STM   @14,@12,@SA00003                                    0080
*        CURRCNTS = CNTAREA;              /* GET ADDRESS OF FIRST AREA*
         L     @06,CNTAREA                                         0081
         ST    @06,CURRCNTS                                        0081
*        DO WHILE (CURRCNTS ^= ZERO);                      /*@Z427VLS*/
         B     @DE00082                                            0082
@DL00082 DS    0H                                                  0083
*          RESPECIFY (R7,R9) RESTRICTED;                   /*@Z427VLS*/
*          R9 = SUMEDIT;                  /* SUMMARY OUTPUT EDITS     *
         L     @06,SUMTAB                                          0084
         L     R9,SUMEDIT(,@06)                                    0084
*          R7 = CURRCNTS;                 /* ADDRESS OF COUNTERS      *
         L     R7,CURRCNTS                                         0085
*          CALL IFCEEDIT;                 /* GO TO EDIT TABLE         *
         L     @15,@CV00534                                        0086
         BALR  @14,@15                                             0086
*          R9 = 22 + (2 * CNTSIZE);       /* SIZE OF COUNTER AREA     *
         L     @06,SUMTAB                                          0087
         LH    R9,CNTSIZE(,@06)                                    0087
         ALR   R9,R9                                               0087
         AL    R9,@CF00610                                         0087
*          CURRCNTS = NEXTTAB;            /* ADDRESS OF NEXT AREA.    *
         L     @08,CURRCNTS                                        0088
         L     @08,NEXTTAB(,@08)                                   0088
         ST    @08,CURRCNTS                                        0088
*          GEN(FREEMAIN R,LV=(R9),A=(R7));                 /*@Z427VLS*/
         FREEMAIN R,LV=(R9),A=(R7)
*          RESPECIFY (R7,R9) UNRESTRICTED;                 /*@Z427VLS*/
*        END;                                              /*@Z427VLS*/
@DE00082 SLR   @06,@06                                             0091
         C     @06,CURRCNTS                                        0091
         BNE   @DL00082                                            0091
*        CNTAREA = ZERO;                  /* INITIALIZE FIRST AREA ADD*
         ST    @06,CNTAREA                                         0092
*        LASTDATE = LASTDATE && LASTDATE;  /* CLEAR LAST DATE         *
         XC    LASTDATE(4),LASTDATE                                0093
*END;                                                      /*@Z427VLS*/
@EL00003 DS    0H                                                  0094
@EF00003 DS    0H                                                  0094
@ER00003 LM    @14,@12,@SA00003                                    0094
         BR    @14                                                 0094
*/*                                                          @Z427VLS*/
*/* THE NEXT CODE WILL INITIALIZE THE REGISTERS FOR EXITING TO        *
*/* AN EDIT MODULE.  THE EXPECTED PARAMETERS TO IFCEEDIT ARE:         *
*/*      REG2 - POINTING TO THE RECORD TO BE EDITTED.        @Z427VLS*/
*/*      REG9 - POINTING TO THE BASE OF THE EDIT TABLE.      @Z427VLS*/
*/*      REG15 - POINTING TO THE BASE OF IFCEEDIT.           @Z427VLS*/
*/*                                                          @Z427VLS*/
*OUTEDIT: PROC (RECFLAG);                                  /*@Z427VLS*/
OUTEDIT  STM   @14,@12,@SA00004                                    0095
         MVC   @PC00004(4),0(@01)                                  0095
*      DCL RECFLAG CHAR(1);                                /*@Z427VLS*/
*      DCL 1 THRSHRC CHAR(8) BASED(R7),/* DUMMY AREA FOR ADDRESSING   *
*           2 *       CHAR(4),                                     0097
*           2 THRSHFLG CHAR(1);        /* RECORD FLAG FOR THRSH PROC  *
*      RESPECIFY (R9) RESTRICTED;                          /*@Z427VLS*/
*      R9 = EDITTAB;                   /* GET BASE OF EDIT TABLE      *
         L     R9,EDITTAB                                          0099
*      IF PARMTHR = ON THEN                                        0100
         TM    PARMTHR(R2),B'00001000'                             0100
         BNO   @RF00100                                            0100
*        DO;                                               /*@Z427VLS*/
*          ERTHRE = RDTHRSH;           /* READ THRESHOLD     @Z427VLS*/
         MVC   ERTHRE(3,R9),RDTHRSH(R2)                            0102
*          EWTHRE = WRTHRSH;           /* WRITE THRESHOLD    @Z427VLS*/
         MVC   EWTHRE(3,R9),WRTHRSH(R2)                            0103
*        END;                                              /*@Z427VLS*/
*      THRSHFLG = RECFLAG;             /* FLAG FOR THRESHOLD PROCESS  *
@RF00100 L     @08,@PC00004                                        0105
         MVC   THRSHFLG(1,R7),RECFLAG(@08)                         0105
*      CALL IFCEEDIT;                  /* GO TO IFCEEDIT     @Z427VLS*/
         L     @15,@CV00534                                        0106
         BALR  @14,@15                                             0106
*      THRSHFLG = HEXZERO;             /* RESTORE PLACE IN RECORD     *
         MVI   THRSHFLG(R7),X'00'                                  0107
*      RETURN;                                             /*@Z427VLS*/
@EL00004 DS    0H                                                  0108
@EF00004 DS    0H                                                  0108
@ER00004 LM    @14,@12,@SA00004                                    0108
         BR    @14                                                 0108
*      RESPECIFY (R9) UNRESTRICTED;                        /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/* IN EVERY SUMMARY TABLE AT OFFSET 12 THERE IS A HALFWORK WITH THE  *
*/* NUMBER OF TWO BYTE COUNTERS NEEDED FOR THIS SERVICE.  AT THE      *
*/* BEGINNING OF EVERY COUNT AREA THERE ARE 22 BYTES OF CONTROL       *
*/* INFORMATION ADDED TO THE COUNT AREA.  THIS CODE ISSUES A GETMAIN  *
*/* FOR THIS AREA AND SETS IT TO ZERO.                       @Z427VLS*/
*/*                                                          @Z427VLS*/
*GETSPACE: PROC;                                           /*@Z427VLS*/
GETSPACE STM   @14,@12,@SA00005                                    0111
*          RESPECIFY (R0,R1,R7) RESTRICTED;                /*@Z427VLS*/
*          R0 = 22 + (CNTSIZE * 2);       /* DETERMINE SIZE OF AREA   *
         L     @06,SUMTAB                                          0113
         LH    R0,CNTSIZE(,@06)                                    0113
         ALR   R0,R0                                               0113
         AL    R0,@CF00610                                         0113
*          GEN(GETMAIN R,LV=(0));                          /*@Z427VLS*/
         GETMAIN R,LV=(0)
*          IF CNTAREA = ZERO THEN                                  0115
         L     @06,CNTAREA                                         0115
         LTR   @06,@06                                             0115
         BNZ   @RF00115                                            0115
*            CNTAREA = R1;                /* 1ST COUNTER AREA         *
         ST    R1,CNTAREA                                          0116
*          ELSE                                                    0117
*            DO CURRCNTS = CNTAREA;                        /*@Z427VLS*/
         B     @RC00115                                            0117
@RF00115 L     @06,CNTAREA                                         0117
         ST    @06,CURRCNTS                                        0117
*              DO WHILE (CURRCNTS -> NEXTTAB ^= ZERO); /* FIND END    *
         B     @DE00118                                            0118
@DL00118 DS    0H                                                  0119
*                CURRCNTS = NEXTTAB;                       /*@Z427VLS*/
         L     @06,CURRCNTS                                        0119
         L     @06,NEXTTAB(,@06)                                   0119
         ST    @06,CURRCNTS                                        0119
*              END;                                        /*@Z427VLS*/
@DE00118 L     @06,CURRCNTS                                        0120
         L     @05,NEXTTAB(,@06)                                   0120
         LTR   @05,@05                                             0120
         BNZ   @DL00118                                            0120
*              NEXTTAB = R1;              /* ADD TO END OF CHAIN      *
         ST    R1,NEXTTAB(,@06)                                    0121
*            END;                                          /*@Z427VLS*/
*          CURRCNTS = R1;                 /* SET POINTER TO AREA      *
@RC00115 ST    R1,CURRCNTS                                         0123
*          RESPECIFY (R0,R1) UNRESTRICTED;                 /*@Z427VLS*/
*          DO R7 = CNTSIZE TO 1 BY -1;    /* CLEAR SUM AREA  @Z427VLS*/
         L     @05,SUMTAB                                          0125
         LH    R7,CNTSIZE(,@05)                                    0125
         B     @DE00125                                            0125
@DL00125 DS    0H                                                  0126
*            COUNTERS(R7) = ZERO;                          /*@Z427VLS*/
         LR    @06,R7                                              0126
         ALR   @06,@06                                             0126
         SLR   @05,@05                                             0126
         L     @03,CURRCNTS                                        0126
         STH   @05,COUNTERS-2(@06,@03)                             0126
*          END;                                            /*@Z427VLS*/
         BCTR  R7,0                                                0127
@DE00125 LTR   R7,R7                                               0127
         BP    @DL00125                                            0127
*          /*                                                @Z427VLS*/
*          /* THIS CODE INITIALIZED THE HEADER AREA OF THE SUM AREA.  *
*          /* IT MARKS THIS AS THE LAST SUM AREA AND PUTS IN OTHER    *
*          /* IDENTIFYING INFORMATION.                       @Z427VLS*/
*          /*                                                @Z427VLS*/
*          NEXTTAB = ZERO;             /* INITIALIZE HEADER OF AREA   *
         L     @06,CURRCNTS                                        0128
         SLR   @05,@05                                             0128
         ST    @05,NEXTTAB(,@06)                                   0128
*          SUMIDENT = CUACPU;          /* CPU/CUA OR VOLID   @Z427VLS*/
         MVC   SUMIDENT(8,@06),CUACPU                              0129
*          MODNAME = STABNAME;         /* MODULE NAME TO EDIT AREA    *
         MVC   MODNAME(8,@06),STABNAME                             0130
*          CURRDEV = SAVEDEV;          /* DEVICE CODE        @Z427VLS*/
         MVC   CURRDEV(2,@06),SAVEDEV                              0131
*          RETURN;                                         /*@Z427VLS*/
@EL00005 DS    0H                                                  0132
@EF00005 DS    0H                                                  0132
@ER00005 LM    @14,@12,@SA00005                                    0132
         BR    @14                                                 0132
*          RESPECIFY (R7) UNRESTRICTED;                    /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/* THE NEXT CODE SUMMARIZES THE INDIVIDUAL RECORDS INTO THE COUNTER  *
*/* AREA.  A'FF'X ENTRY SIGNIFIES THE END OF THE TABLE AND WHEN IT IS *
*/* FOUND A BRANCH IS TAKEN TO CHECK WHAT PASS WE ARE IN.    @Z427VLS*/
*/*                                                          @Z427VLS*/
*SUMIT: PROC;                                              /*@Z427VLS*/
SUMIT    STM   @14,@12,@SA00006                                    0135
*       RESPECIFY (R3,R9) RESTRICTED;                      /*@Z427VLS*/
*       /*                                                   @Z427VLS*/
*       /* SUMSPEC1 IS LOADED WITH THE ADDRESS OF THE ENTRY FOR THE   *
*       /* SPECIAL ROUTINE WITHIN THE SUMMARY MODULE.  SPECIAL WILL   *
*       /* CAUSE THE NECESSARY LINKAGE TO BE GENERATED BY THE COMPILER*
*       /*                                                   @Z427VLS*/
*       DCL SUMSPEC1 PTR(31);                              /*@Z427VLS*/
*       DCL SPECIAL ENTRY BASED(SUMSPEC1);                 /*@Z427VLS*/
*       NEXTENT = SUMPTR;              /* GET POINTER TO SUM ENTRIES  *
         L     @08,SUMTAB                                          0139
         L     @06,SUMPTR(,@08)                                    0139
         ST    @06,NEXTENT(,@08)                                   0139
*       R9 = SUMTAB;                  /* ADDRESS OF SUMMARY TABLE     *
         LR    R9,@08                                              0140
*       DO UNTIL (SUMFLAG = FOXFOX);                       /*@Z427VLS*/
@DL00141 DS    0H                                                  0142
*         /*                                                 @Z427VLS*/
*         /* GET THE ADDRESS OF THE COUNTER TO BE UPDATED.   @Z427VLS*/
*         /*                                                 @Z427VLS*/
*         R3 = CURRCNTS + 22 + (2 * CNTOFSET);             /*@Z427VLS*/
         LA    R3,22                                               0142
         AL    R3,CURRCNTS                                         0142
         L     @08,SUMTAB                                          0142
         L     @08,NEXTENT(,@08)                                   0142
         LH    @06,CNTOFSET(,@08)                                  0142
         ALR   @06,@06                                             0142
         ALR   R3,@06                                              0142
*         /*                                                 @Z427VLS*/
*         /* A '00'X ENTRY MEANS THAT A GIVEN BIT IN THE RECORD MUST  *
*         /* BE TESTED AND THE COUNTER UPDATED IF THE BIT IS ON.  AN  *
*         /* '80'X ENTRY MEANS THAT CONTROL IS TO BE GIVEN TO SPECIAL *
*         /* ROUTINE WITH REG3 POINTING TO THE COUNTER TO BE UPDATED*/
*         /* AND REG9 HAVING THE BASE OF THE SUM TABLE.      @Z427VLS*/
*         /*                                                 @Z427VLS*/
*         IF SUMFLAG = HEXZERO THEN    /* IS THIS A NORMAL SUMMARY    *
         CLI   SUMFLAG(@08),X'00'                                  0143
         BNE   @RF00143                                            0143
*           DO;                                            /*@Z427VLS*/
*             IF (SUMMARY & SUMMASK) = SUMMASK THEN                0145
         LR    @06,BUFFPTR                                         0145
         AH    @06,OFFSET(,@08)                                    0145
         MVC   @TS00001(1),SUMMARY(@06)                            0145
         NC    @TS00001(1),SUMMASK(@08)                            0145
         CLC   @TS00001(1),SUMMASK(@08)                            0145
         BNE   @RF00145                                            0145
*                COUNTER = COUNTER + 1;  /* IF ON-INCREMENT CTR       *
         LA    @08,1                                               0146
         AH    @08,COUNTER(,R3)                                    0146
         STH   @08,COUNTER(,R3)                                    0146
*           END;                                           /*@Z427VLS*/
*         ELSE                                                     0148
*           DO;                                            /*@Z427VLS*/
         B     @RC00143                                            0148
@RF00143 DS    0H                                                  0149
*             R2 = BUFFPTR;            /* GET POINTER TO RECORD       *
         LR    R2,BUFFPTR                                          0149
*             SUMSPEC1 = SUMSPEC + SUMTAB;                 /*@Z427VLS*/
         L     @08,SUMTAB                                          0150
         L     @06,NEXTENT(,@08)                                   0150
         AH    @08,SUMSPEC(,@06)                                   0150
         LR    SUMSPEC1,@08                                        0150
*             CALL SPECIAL;            /* GO TO ROUTINE IN SUM TABLE  *
         LR    @15,SUMSPEC1                                        0151
         BALR  @14,@15                                             0151
*           END;                                           /*@Z427VLS*/
*         NEXTENT = NEXTENT + 6;       /* UPDATE SUMMARY ENTRY        *
@RC00143 L     @08,SUMTAB                                          0153
         LA    @06,6                                               0153
         AL    @06,NEXTENT(,@08)                                   0153
         ST    @06,NEXTENT(,@08)                                   0153
*       END;                                               /*@Z427VLS*/
@DE00141 L     @08,SUMTAB                                          0154
         L     @08,NEXTENT(,@08)                                   0154
         CLI   SUMFLAG(@08),X'FF'                                  0154
         BNE   @DL00141                                            0154
*       LASTDATE = DATE;               /* SAVE THE DATE OF THIS RECORD*
         MVC   LASTDATE(4),DATE(BUFFPTR)                           0155
*       LASTCUA = SAVECUA;             /* SAVE THE CUA OF THIS RECORD *
         MVC   LASTCUA(3),SAVECUA                                  0156
*       LASTCPU = SAVECPU;             /* SAVE THE CPU OF THIS RECORD *
         MVC   LASTCPU(5),SAVECPU                                  0157
*       RETURN;                                            /*@Z427VLS*/
@EL00006 DS    0H                                                  0158
@EF00006 DS    0H                                                  0158
@ER00006 LM    @14,@12,@SA00006                                    0158
         BR    @14                                                 0158
*       RESPECIFY (R3,R9) UNRESTRICTED;                    /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/* LOOK UP THE CUA IN THE SHARE TABLE FOR THE CONVERTED SHARE VALUE. *
*/* IF IT IS FOUND, RETURN THE CONVERTED VALUE IN NEW CUA. IF NOT,    *
*/* RETURN THE ORIGINAL VALUE IN NEWCUA.                     @Z427VLS*/
*/*                                                          @Z427VLS*/
*CUASHARE: PROC;                                           /*@Z427VLS*/
CUASHARE STM   @14,@12,12(@13)                                     0161
*    VALIDSHR = OFF;                          /* TURN OFF FOR SEARCH  *
         NI    VALIDSHR,B'11101111'                                0162
*    SHR74CUA = OCUA2;                        /* CUA FOR COMPARISON   *
         MVC   SHR74CUA(2),OCUA2(BUFFPTR)                          0163
*    SHR74CPU = CPUIDENT;                     /* CPU FOR COMPARISON   *
         MVC   SHR74CPU(3),CPUIDENT(BUFFPTR)                       0164
*    SHR74XXD = SHR74XXX;                     /* FOR CONTROLLER COMPR *
         MVC   SHR74XXD(5),SHR74XXX                                0165
*    SHR74CUX = SHR74CUX & FOXZERO;                        /*@Z427VLS*/
         NI    SHR74CUX,X'F0'                                      0166
*    SHR74XDD = ON;                                        /*@Z427VLS*/
         OI    SHR74XDD,B'10000000'                                0167
*    DO I = 1 TO SHARENUM BY 1 WHILE(VALIDSHR = OFF);      /*@Z427VLS*/
         LA    @06,1                                               0168
         STH   @06,I                                               0168
         B     @DE00168                                            0168
@DL00168 TM    VALIDSHR,B'00010000'                                0168
         BNZ   @DC00168                                            0168
*      IF SHAREDX(I) = ON THEN                                     0169
         MH    @06,@CH00575                                        0169
         L     @05,SHAREPTR(,R2)                                   0169
         ST    @06,@TF00001                                        0169
         ALR   @06,@05                                             0169
         AL    @06,@CF00650                                        0169
         TM    SHAREDX-2(@06),B'10000000'                          0169
         BNO   @RF00169                                            0169
*        DO;                                  /* CHECK FOR CONTROLLER *
*          IF SHR74XXD = SHRCUCPU(I) THEN                          0171
         LR    @06,@05                                             0171
         AL    @06,@TF00001                                        0171
         AL    @06,@CF00650                                        0171
         CLC   SHR74XXD(5),SHRCUCPU-2(@06)                         0171
         BNE   @RF00171                                            0171
*            DO;                                           /*@Z427VLS*/
*              /*                                            @Z427VLS*/
*              /* PUT IN CUA FROM SHARE TABLE WITH UNITS ADDR FROM REC*
*              /*                                            @Z427VLS*/
*              SHR74CUA = SHARECUB(I);                     /*@Z427VLS*/
         LR    @06,@05                                             0173
         AL    @06,@TF00001                                        0173
         AL    @06,@CF00651                                        0173
         MVC   SHR74CUA(2),SHARECUB-7(@06)                         0173
*              SHR74CUA = SHR74CUA & ZFFF;                 /*@Z427VLS*/
         NC    SHR74CUA(2),@CB00460                                0174
*              RECCUA = OCUA2 & ZZZF;                      /*@0001VLS*/
         MVC   RECCUA(2),OCUA2(BUFFPTR)                            0175
         NC    RECCUA(2),@CB00462                                  0175
*              RECCUA = RECCUA × SHR74CUA;                 /*@0001VLS*/
         OC    RECCUA(2),SHR74CUA                                  0176
*              RECCPU = SHARSERB(I);                       /*@0001VLS*/
         AL    @05,@TF00001                                        0177
         BCTR  @05,0                                               0177
         BCTR  @05,0                                               0177
         MVC   RECCPU(3),SHARSERB-9(@05)                           0177
*              VALIDSHR = ON;                              /*@Z427VLS*/
         OI    VALIDSHR,B'00010000'                                0178
*            END;                                          /*@Z427VLS*/
*        END;                                              /*@Z427VLS*/
*      ELSE                                                        0181
*        IF SHR74XXX = SHRCUCPU(I) THEN                            0181
         B     @RC00169                                            0181
@RF00169 LH    @06,I                                               0181
         MH    @06,@CH00575                                        0181
         L     @05,SHAREPTR(,R2)                                   0181
         ST    @06,@TF00001                                        0181
         ALR   @06,@05                                             0181
         AL    @06,@CF00650                                        0181
         CLC   SHR74XXX(5),SHRCUCPU-2(@06)                         0181
         BNE   @RF00181                                            0181
*          DO;                                /* CUA ONLY.   @Z427VLS*/
*            RECCUA = SHARECUB(I);                         /*@0001VLS*/
         LR    @06,@05                                             0183
         AL    @06,@TF00001                                        0183
         AL    @06,@CF00651                                        0183
         MVC   RECCUA(2),SHARECUB-7(@06)                           0183
*            RECCPU = SHARSERB(I);                         /*@0001VLS*/
         AL    @05,@TF00001                                        0184
         BCTR  @05,0                                               0184
         BCTR  @05,0                                               0184
         MVC   RECCPU(3),SHARSERB-9(@05)                           0184
*            VALIDSHR = ON;                                /*@Z427VLS*/
         OI    VALIDSHR,B'00010000'                                0185
*          END;                                            /*@Z427VLS*/
*    END;                                                  /*@Z427VLS*/
@RF00181 DS    0H                                                  0187
@RC00169 LA    @06,1                                               0187
         AH    @06,I                                               0187
         STH   @06,I                                               0187
@DE00168 L     @05,SHAREPTR(,R2)                                   0187
         CH    @06,SHARENUM(,@05)                                  0187
         BNH   @DL00168                                            0187
@DC00168 DS    0H                                                  0188
*    RETURN;                                               /*@Z427VLS*/
@EL00007 DS    0H                                                  0188
@EF00007 DS    0H                                                  0188
@ER00007 LM    @14,@12,12(@13)                                     0188
         BR    @14                                                 0188
* END;                                                     /*@Z427VLS*/
@PB00007 DS    0H                                                  0190
*/*                                                          @Z427VLS*/
*/* INITIALLY THE ADDRESS OF THE PARAMETER LIST IS SAVED.  NEXT AN    *
*/* AREA OF CORE IS GOTTEN FOR THE CONTROL TABLE.            @Z427VLS*/
*/*                                                          @Z427VLS*/
*        SAVEPARM = R2;                /* SAVE ADDR TO PARM TABLE     *
         LR    SAVEPARM,R2                                         0190
*        IF DEBUG4 = ON THEN                                       0191
         TM    DEBUG4(R2),B'00001000'                              0191
         BNO   @RF00191                                            0191
*          DO;                                             /*@Z427VLS*/
*            R15 = R12 - 27;                               /*@Z427VLS*/
         LR    R15,R12                                             0193
         SL    R15,@CF00635                                        0193
*            GEN(MVC  MSGADDR(16),0(R15));                 /*@Z427VLS*/
         MVC  MSGADDR(16),0(R15)
*            PRINTADR = ADDR(MESSAGE);                     /*@Z427VLS*/
         LA    @06,MESSAGE                                         0195
         ST    @06,PRINTADR(,R2)                                   0195
*            CURRPTR = ADDR(IFCEEDIT);                     /*@Z427VLS*/
         L     CURRPTR,@CV00534                                    0196
*            GEN(MVC MSGADDR+20(16),5(CURRPTR));           /*@Z427VLS*/
         MVC MSGADDR+20(16),5(CURRPTR)
*            PRINTADR = ADDR(MESSAGE);                     /*@Z427VLS*/
         LA    @06,MESSAGE                                         0198
         ST    @06,PRINTADR(,R2)                                   0198
*            CALL IOHND(RITEPRTR);                         /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0199
         LA    @01,@AL00199                                        0199
         BALR  @14,@15                                             0199
*          END;                                            /*@Z427VLS*/
*        RESPECIFY (R0,R1) RESTRICTED;                     /*@Z427VLS*/
@RF00191 DS    0H                                                  0202
*        R0 = TABSIZE;                                     /*@Z427VLS*/
         L     R0,TABSIZE(,R2)                                     0202
*  GEN(GETMAIN EC,LV=(0),A=TABPTR);                        /*@0001VLS*/
         GETMAIN EC,LV=(0),A=TABPTR
*    IF R15 = ZERO THEN                                            0204
         LTR   R15,R15                                             0204
         BNZ   @RF00204                                            0204
*    DO;                                                   /*@GZZDGVS*/
*        RESPECIFY (R0,R1) UNRESTRICTED;                   /*@Z427VLS*/
*        CURRPTR = TABPTR + TABSIZE - 2;                   /*@Z427VLS*/
         L     CURRPTR,TABPTR                                      0207
         AL    CURRPTR,TABSIZE(,R2)                                0207
         BCTR  CURRPTR,0                                           0207
         BCTR  CURRPTR,0                                           0207
*        EOTABLE = EOT;                /* PUT IN END OF TABLE INDICAT *
         MVC   EOTABLE(2,CURRPTR),@CB00259                         0208
*        CURRPTR = CURRPTR - 11;                           /*@Z427VLS*/
         SL    CURRPTR,@CF00575                                    0209
*        RESPECIFY (R15) RESTRICTED;                       /*@Z427VLS*/
*        CALL IOHND(READSEQ);          /* GET AN INPUT RECORD         *
         L     @15,ADIOHND(,R2)                                    0211
         LA    @01,@AL00211                                        0211
         BALR  @14,@15                                             0211
*        RETCODE = R15;                                    /*@Z427VLS*/
         ST    R15,RETCODE                                         0212
*        RESPECIFY (R15) UNRESTRICTED;                     /*@Z427VLS*/
*        DO WHILE (CURRPTR >= TABPTR & RETCODE = ZERO);    /*@Z427VLS*/
         B     @DE00214                                            0214
@DL00214 DS    0H                                                  0215
*          /*                                                @Z427VLS*/
*          /* THIS NEXT CODE WILL GET THE DEVICE TYPE AND CUA FROM THE*
*          /* PROPER OFFSET IN THE RECORD.  WITH A LONG OBR RECORD,   *
*          /* THE INFORMATION WILL BE RETRIEVED FROM THE NORMAL       *
*          /* OFFSETS.                                       @Z427VLS*/
*          /*                                                @Z427VLS*/
*          IF (RECTYP & FOXZERO) = OBRREC &                        0215
*              SHORT = OFF & DEV2 = SAVEDEV &                      0215
*              DATE >= STDATE & DATE <= ENDDATE &                  0215
*              ((SHIFT3RD = OFF & TIME >= STTIME1 & TIME <= ENDTIME1) ×
*               (SHIFT3RD = ON &                                   0215
*                ((TIME >= STTIME1 & DATE ^= ENDDATE) ×            0215
*                 (TIME <= ENDTIME2 & DATE ^= STDATE)))) THEN      0215
         MVC   @TS00001(1),RECTYP(BUFFPTR)                         0215
         NI    @TS00001,X'F0'                                      0215
         CLI   @TS00001,X'30'                                      0215
         BNE   @RF00215                                            0215
         TM    SHORT(BUFFPTR),B'00100000'                          0215
         BNZ   @RF00215                                            0215
         CLC   DEV2(2,BUFFPTR),SAVEDEV                             0215
         BNE   @RF00215                                            0215
         CLC   DATE(4,BUFFPTR),STDATE(R2)                          0215
         BL    @RF00215                                            0215
         CLC   DATE(4,BUFFPTR),ENDDATE(R2)                         0215
         BH    @RF00215                                            0215
         TM    SHIFT3RD(R2),B'00010000'                            0215
         BNZ   @GL00006                                            0215
         CLC   TIME(4,BUFFPTR),STTIME1(R2)                         0215
         BL    @GL00006                                            0215
         CLC   TIME(4,BUFFPTR),ENDTIME1(R2)                        0215
         BNH   @RT00215                                            0215
@GL00006 TM    SHIFT3RD(R2),B'00010000'                            0215
         BNO   @RF00215                                            0215
         CLC   TIME(4,BUFFPTR),STTIME1(R2)                         0215
         BL    @GL00010                                            0215
         CLC   DATE(4,BUFFPTR),ENDDATE(R2)                         0215
         BNE   @RT00215                                            0215
@GL00010 CLC   TIME(4,BUFFPTR),ENDTIME2(R2)                        0215
         BH    @RF00215                                            0215
         CLC   DATE(4,BUFFPTR),STDATE(R2)                          0215
         BE    @RF00215                                            0215
@RT00215 DS    0H                                                  0216
*            DO;                                           /*@Z427VLS*/
*              /*                                            @Z427VLS*/
*              /* THIS NEXT SECTION OF CODE COMPARES THE OBR JUST READ*
*              /* IN WITH THE PARAMETERS SPECIFIED ON THE EXEC CARD   *
*              /* AND PUT IN A LIST BY PARAMETER PROCESSOR.  @Z427VLS*/
*              /* IF NO CUA WAS SPECIFIED, THE POINTER TO THE CUA     *
*              /* TABLE WILL BE ZERO.  IF IT IS NOT, THEN A MAXIMUM   *
*              /* OF SIXTEEN INDIVIDUAL OR RANGE CUAS MUST BE COMPARED*
*              /* TO THE CUA IN THE RECORD.                  @Z427VLS*/
*              /*                                            @Z427VLS*/
*              VALIDCUA = OFF;                             /*@Z427VLS*/
*              VALIDCPU = OFF;                             /*@Z427VLS*/
*              VALIDSER = OFF;                             /*@Z427VLS*/
*              VALIDVOL = OFF;                             /*@Z427VLS*/
         NI    VALIDCUA,B'10010011'                                0220
*              IF CUAPTR ^= ZERO THEN        /* ARE ALL CUA'S WANTED  *
         L     @06,CUAPTR(,R2)                                     0221
         LTR   @06,@06                                             0221
         BZ    @RF00221                                            0221
*                DO I = 1 TO CUANUM BY 1 WHILE (VALIDCUA = OFF);   0222
         LA    @06,1                                               0222
         STH   @06,I                                               0222
         B     @DE00222                                            0222
@DL00222 TM    VALIDCUA,B'00001000'                                0222
         BNZ   @DC00222                                            0222
*                  IF OCUA2 >= CUA1(I) &     /* DOES THE CUA LIE IN   *
*                     OCUA2 <= CUA2(I) THEN  /* RANGE SPECIFIED       *
         SLA   @06,2                                               0223
         L     @03,CUAPTR(,R2)                                     0223
         ST    @06,@TF00001                                        0223
         ALR   @06,@03                                             0223
         BCTR  @06,0                                               0223
         BCTR  @06,0                                               0223
         CLC   OCUA2(2,BUFFPTR),CUA1-2(@06)                        0223
         BL    @RF00223                                            0223
         AL    @03,@TF00001                                        0223
         CLC   OCUA2(2,BUFFPTR),CUA2-4(@03)                        0223
         BH    @RF00223                                            0223
*                       VALIDCUA = ON;       /* ACCEPT RECORD         *
         OI    VALIDCUA,B'00001000'                                0224
*                END;                                      /*@Z427VLS*/
@RF00223 LA    @06,1                                               0225
         AH    @06,I                                               0225
         STH   @06,I                                               0225
@DE00222 L     @03,CUAPTR(,R2)                                     0225
         CH    @06,CUANUM(,@03)                                    0225
         BNH   @DL00222                                            0225
@DC00222 DS    0H                                                  0226
*              ELSE                                                0226
*                VALIDCUA = ON;              /* ACCEPT RECORD         *
         B     @RC00221                                            0226
@RF00221 OI    VALIDCUA,B'00001000'                                0226
*              /*                                            @Z427VLS*/
*              /* A CHECK IS MADE TO SEE IF A LIST OF VOLID'S WAS     *
*              /* PASSED IN THE PARAMETER LIST.  IF IT WAS, THE VOLID *
*              /* IN THE RECORD IS COMPARED TO THE VOLIDS IN THE LIST *
*              /* TO SEE IF THE RECORD SHOULD BE INCLUDED IN THE      *
*              /* REPORTS.                                   @Z427VLS*/
*              /*                                            @Z427VLS*/
*              IF VOLPTR ^= ZERO THEN        /* WAS A VOLID SPECIFIED *
@RC00221 L     @06,VOLPTR(,R2)                                     0227
         LTR   @06,@06                                             0227
         BZ    @RF00227                                            0227
*                DO I = 1 TO VOLNUM BY 1 WHILE(VALIDVOL = OFF);    0228
         LA    @06,1                                               0228
         STH   @06,I                                               0228
         B     @DE00228                                            0228
@DL00228 TM    VALIDVOL,B'00000100'                                0228
         BNZ   @DC00228                                            0228
*                  IF VOLVAL(I) = VOLID THEN /* VOLUME IN LIST        *
         MH    @06,@CH00078                                        0229
         L     @03,VOLPTR(,R2)                                     0229
         ALR   @03,@06                                             0229
         AL    @03,@CF00651                                        0229
         CLC   VOLVAL-2(6,@03),VOLID(BUFFPTR)                      0229
         BNE   @RF00229                                            0229
*                    VALIDVOL = ON;          /* ACCEPT RECORD         *
         OI    VALIDVOL,B'00000100'                                0230
*                END;                                      /*@Z427VLS*/
@RF00229 LA    @06,1                                               0231
         AH    @06,I                                               0231
         STH   @06,I                                               0231
@DE00228 L     @03,VOLPTR(,R2)                                     0231
         CH    @06,VOLNUM(,@03)                                    0231
         BNH   @DL00228                                            0231
@DC00228 DS    0H                                                  0232
*              ELSE                                                0232
*                VALIDVOL = ON;              /* ACCEPT RECORD         *
         B     @RC00227                                            0232
@RF00227 OI    VALIDVOL,B'00000100'                                0232
*              /*                                            @Z427VLS*/
*              /* A CHECK IS MADE AGAINST ANY CPU WERE SPECIFIED      *
*              /*                                            @Z427VLS*/
*              IF CPUPTR ^= ZERO THEN                              0233
@RC00227 L     @06,CPUPTR(,R2)                                     0233
         LTR   @06,@06                                             0233
         BZ    @RF00233                                            0233
*                DO I = 1 TO CPUNUM BY 1 WHILE(VALIDCPU = OFF);    0234
         LA    @06,1                                               0234
         STH   @06,I                                               0234
         B     @DE00234                                            0234
@DL00234 TM    VALIDCPU,B'00100000'                                0234
         BNZ   @DC00234                                            0234
*                  IF CPUIDENT = CPUVAL(I) THEN                    0235
         MH    @06,@CH00076                                        0235
         L     @03,CPUPTR(,R2)                                     0235
         ALR   @03,@06                                             0235
         AL    @03,@CF00655                                        0235
         CLC   CPUIDENT(5,BUFFPTR),CPUVAL-2(@03)                   0235
         BNE   @RF00235                                            0235
*                    VALIDCPU = ON;                        /*@Z427VLS*/
         OI    VALIDCPU,B'00100000'                                0236
*                END;                                      /*@Z427VLS*/
@RF00235 LA    @06,1                                               0237
         AH    @06,I                                               0237
         STH   @06,I                                               0237
@DE00234 L     @03,CPUPTR(,R2)                                     0237
         CH    @06,CPUNUM(,@03)                                    0237
         BNH   @DL00234                                            0237
@DC00234 DS    0H                                                  0238
*              ELSE                                                0238
*                VALIDCPU = ON;                            /*@Z427VLS*/
         B     @RC00233                                            0238
@RF00233 OI    VALIDCPU,B'00100000'                                0238
*              /*                                            @Z427VLS*/
*              /* A CHECK IS MADE AGAINST ANY DEVSER THAT WERE SPECIFD*
*              /*                                            @Z427VLS*/
*              IF SERPTR ^= ZERO THEN                              0239
@RC00233 L     @06,SERPTR(,R2)                                     0239
         LTR   @06,@06                                             0239
         BZ    @RF00239                                            0239
*                DO I = 1 TO SERNUM BY 1 WHILE(VALIDSER = OFF);    0240
         LA    @06,1                                               0240
         STH   @06,I                                               0240
         B     @DE00240                                            0240
@DL00240 TM    VALIDSER,B'01000000'                                0240
         BNZ   @DC00240                                            0240
*                  IF OSER74XX = SERVAL(I) THEN                    0241
         ALR   @06,@06                                             0241
         L     @03,SERPTR(,R2)                                     0241
         ALR   @03,@06                                             0241
         CLC   OSER74XX(2,BUFFPTR),SERVAL-2(@03)                   0241
         BNE   @RF00241                                            0241
*                    VALIDSER = ON;                        /*@Z427VLS*/
         OI    VALIDSER,B'01000000'                                0242
*                END;                                      /*@Z427VLS*/
@RF00241 LA    @06,1                                               0243
         AH    @06,I                                               0243
         STH   @06,I                                               0243
@DE00240 L     @03,SERPTR(,R2)                                     0243
         CH    @06,SERNUM(,@03)                                    0243
         BNH   @DL00240                                            0243
@DC00240 DS    0H                                                  0244
*              ELSE                                                0244
*                VALIDSER = ON;                            /*@Z427VLS*/
         B     @RC00239                                            0244
@RF00239 OI    VALIDSER,B'01000000'                                0244
*              /*                                            @Z427VLS*/
*              IF VALIDCUA = ON & VALIDVOL = ON & VALIDCPU = ON &  0245
*                 VALIDSER = ON THEN                               0245
@RC00239 TM    VALIDCUA,B'01101100'                                0245
         BNO   @RF00245                                            0245
*                DO RECCOUNT = RECCOUNT + 1; /* INCREMENT RECORD COUNT*
         LA    @06,1                                               0246
         AH    @06,RECCOUNT                                        0246
         STH   @06,RECCOUNT                                        0246
*                  IF PHIST = ON THEN                              0247
         TM    PHIST(R2),B'00100000'                               0247
         BNO   @RF00247                                            0247
*                   DO;                                    /*@0001VLS*/
*                    RESPECIFY (R15) RESTRICTED;           /*@0001VLS*/
*                    CALL IOHND(RITESCRT);                 /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0250
         LA    @01,@AL00250                                        0250
         BALR  @14,@15                                             0250
*                    RETCODE = R15;                        /*@0001VLS*/
         ST    R15,RETCODE                                         0251
*                    RESPECIFY (R15) UNRESTRICTED;         /*@0001VLS*/
*                   END;                                   /*@0001VLS*/
*                 IF RETCODE = ZERO THEN                           0254
@RF00247 SLR   @06,@06                                             0254
         C     @06,RETCODE                                         0254
         BNE   @RF00254                                            0254
*                  DO;                                     /*@0001VLS*/
*                  /*                                        @Z427VLS*/
*                  /* CHECK FOR SHARED I/O AND CHANGE CUA IF REQUIRED *
*                  /*                                        @Z427VLS*/
*                  CONTRTAB = CONTRTAB && CONTRTAB;        /*@0001VLS*/
         XC    CONTRTAB(11,CURRPTR),CONTRTAB(CURRPTR)              0256
*                  RECCUA = OCUA2;                         /*@0001VLS*/
         MVC   RECCUA(2),OCUA2(BUFFPTR)                            0257
*                  RECCPU = CPUSER;                        /*@0001VLS*/
         MVC   RECCPU(3),CPUSER(BUFFPTR)                           0258
*                  IF SHAREPTR ^= ZERO THEN                        0259
         C     @06,SHAREPTR(,R2)                                   0259
         BE    @RF00259                                            0259
*                    CALL CUASHARE;                        /*@Z427VLS*/
         BAL   @14,CUASHARE                                        0260
*                  CONTRCUA(2:3) = RECCUA;   /* GET CUA      @0001VLS*/
@RF00259 MVC   CONTRCUA+1(2,CURRPTR),RECCUA                        0261
*                  /*                                        @Z427VLS*/
*                  /* IF THRESHOLD, SORT BY CH AND CU ONLY.  @Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  IF PARMTHR = ON THEN                            0262
         TM    PARMTHR(R2),B'00001000'                             0262
         BNO   @RF00262                                            0262
*                    CONTRCUA(3) = CONTRCUA(3) & FOXZERO;  /*@Z427VLS*/
         NI    CONTRCUA+2(CURRPTR),X'F0'                           0263
*                  CPU = RECCPU;      /* PUT CPU SERIAL NUMBER IN    */
@RF00262 MVC   CPU(3,CURRPTR),RECCPU                               0264
*                  TABCCHHR = RECCCHHR;       /* PUT CCHHR IN TABLE   *
         MVC   TABCCHHR(5,CURRPTR),RECCCHHR(R2)                    0265
*                  CURRPTR = CURRPTR - 11;   /* DECREMENT TO NEXT ENTR*
         SL    CURRPTR,@CF00575                                    0266
*                  END;                                    /*@0001VLS*/
*                END;                                      /*@Z427VLS*/
@RF00254 DS    0H                                                  0269
*            END;                                          /*@Z427VLS*/
@RF00245 DS    0H                                                  0270
*            RESPECIFY (R15) RESTRICTED;                   /*@Z427VLS*/
@RF00215 DS    0H                                                  0271
*           IF RETCODE = ZERO THEN                                 0271
         L     @14,RETCODE                                         0271
         LTR   @14,@14                                             0271
         BNZ   @RF00271                                            0271
*             DO;                                          /*@0001VLS*/
*               CALL IOHND (READSEQ);         /* GET ANOTHER RECORD  */
         L     @15,ADIOHND(,R2)                                    0273
         LA    @01,@AL00273                                        0273
         BALR  @14,@15                                             0273
*               RETCODE = R15;                             /*@0001VLS*/
         ST    R15,RETCODE                                         0274
*             END;                                         /*@0001VLS*/
*            RESPECIFY (R15) UNRESTRICTED;                 /*@Z427VLS*/
@RF00271 DS    0H                                                  0277
*        END;                                              /*@Z427VLS*/
@DE00214 C     CURRPTR,TABPTR                                      0277
         BL    @DC00214                                            0277
         L     @06,RETCODE                                         0277
         LTR   @06,@06                                             0277
         BZ    @DL00214                                            0277
@DC00214 DS    0H                                                  0278
*        /*                                                  @Z427VLS*/
*        /* AT END OF FILE THE PART OF THE CONTROL TABLE THAT HAS NOT *
*        /* BEEN USED IS FREED AND THEN WE GO TO SORT THE CONTROL     *
*        /* TABLE AND PREPARE TO PROCESS THE RECORDS.        @Z427VLS*/
*        /*                                                  @Z427VLS*/
*        IF CURRPTR < TABPTR THEN         /* NOT ENOUGH TABLE SPACE   *
         C     CURRPTR,TABPTR                                      0278
         BNL   @RF00278                                            0278
*          DO;                                             /*@Z427VLS*/
*            CALL IFCMSG(53,ADDR(MSGADDR));                /*@Z427VLS*/
         LA    @06,MSGADDR                                         0280
         ST    @06,@AFTEMPS                                        0280
         L     @15,ADIFCMSG(,R2)                                   0280
         LA    @01,@AL00280                                        0280
         BALR  @14,@15                                             0280
*            PRINTADR = ADDR(MESSAGE);    /* INSUFF SPACE MESSAGE     *
         LA    @06,MESSAGE                                         0281
         ST    @06,PRINTADR(,R2)                                   0281
*            CALL IOHND(RITEPRTR);        /* OUTPUT MESSAGE  @Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0282
         LA    @01,@AL00282                                        0282
         BALR  @14,@15                                             0282
*          END;                                            /*@Z427VLS*/
*        CURRPTR = CURRPTR + 11;          /* PUT WITHIN BOUNDS        *
@RF00278 AL    CURRPTR,@CF00575                                    0284
*        CALL IFCMSG(54,ADDR(MSGADDR));                    /*@Z427VLS*/
         LA    @06,MSGADDR                                         0285
         ST    @06,@AFTEMPS                                        0285
         L     @15,ADIFCMSG(,R2)                                   0285
         LA    @01,@AL00285                                        0285
         BALR  @14,@15                                             0285
*        CVD (RECCOUNT,LASTDATE);         /* CONVVERT TO DECIMAL      *
         LH    @06,RECCOUNT                                        0286
         CVD   @06,@TS00001                                        0286
         MVC   LASTDATE(4),@TS00001+4                              0286
*        UNPK (NUMRECP,LASTDATE);         /* PRINTABLE CHARACTERS     *
         UNPK  NUMRECP(7),LASTDATE(4)                              0287
*        NUMRECP(7) = NUMRECP(7) × FOXZERO;                /*@Z427VLS*/
         OI    NUMRECP+6,X'F0'                                     0288
*        I = 1;                                            /*@Z427VLS*/
         MVC   I(2),@CH00052                                       0289
*        DO UNTIL (I > 6 × NUMRECP(I) ^= FOXZERO);         /*@Z427VLS*/
@DL00290 DS    0H                                                  0291
*          NUMRECP(I) = BLANK;            /* SET LEADING ZERO TO BLANK*
         LH    @06,I                                               0291
         LA    @03,NUMRECP-1(@06)                                  0291
         MVI   0(@03),C' '                                         0291
*          I = I + 1;                                      /*@Z427VLS*/
         LA    @06,1(,@06)                                         0292
         STH   @06,I                                               0292
*        END;                                              /*@Z427VLS*/
@DE00290 LH    @06,I                                               0293
         C     @06,@CF00078                                        0293
         BH    @DC00290                                            0293
         LA    @03,NUMRECP-1(@06)                                  0293
         CLI   0(@03),X'F0'                                        0293
         BE    @DL00290                                            0293
@DC00290 DS    0H                                                  0294
*        PRINTADR = ADDR(MESSAGE);                         /*@Z427VLS*/
         LA    @06,MESSAGE                                         0294
         ST    @06,PRINTADR(,R2)                                   0294
*        CALL IOHND(RITEPRTR);            /* OUTPUT MESSAGE  @Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0295
         LA    @01,@AL00295                                        0295
         BALR  @14,@15                                             0295
*        FREESIZE = (CURRPTR - TABPTR);   /* UNUSED SPACE    @Z427VLS*/
         L     @06,TABPTR                                          0296
         LR    @03,CURRPTR                                         0296
         SLR   @03,@06                                             0296
         ST    @03,FREESIZE                                        0296
*        IF FREESIZE > EIGHT THEN         /* OUTPUT MESSAGE  @Z427VLS*/
         C     @03,@CF00063                                        0297
         BNH   @RF00297                                            0297
*          DO;                                             /*@Z427VLS*/
*            FREESIZE = FREESIZE & 'FFFFF8'X;  /* DOUBLE WORD AMOUNT  *
         N     @03,@CF00640                                        0299
         ST    @03,FREESIZE                                        0299
*            RESPECIFY (R0,R1) RESTRICTED;                 /*@Z427VLS*/
*            R0 = FREESIZE;                                /*@Z427VLS*/
         LR    R0,@03                                              0301
*            R1 = TABPTR;                                  /*@Z427VLS*/
         LR    R1,@06                                              0302
*            GEN(FREEMAIN R,LV=(R0),A=(R1));               /*@Z427VLS*/
         FREEMAIN R,LV=(R0),A=(R1)
*            RESPECIFY (R0,R1) UNRESTRICTED;               /*@Z427VLS*/
*          END;                                            /*@Z427VLS*/
*        TABPTR = CURRPTR;                /* SAVE ADDRESS OF NEW TABLE*
@RF00297 ST    CURRPTR,TABPTR                                      0306
*        SORTNUM = RECCOUNT;              /* STORE NUMBER OF RECORDS  *
         LH    @06,RECCOUNT                                        0307
         ST    @06,SORTNUM(,R2)                                    0307
*        SORTADR = TABPTR;                /* LOCATION OF SORT TABLE   *
         L     @06,TABPTR                                          0308
         ST    @06,SORTADR(,R2)                                    0308
*        IF PHIST = ON THEN                                        0309
         TM    PHIST(R2),B'00100000'                               0309
         BNO   @RF00309                                            0309
*          DO;                                             /*@Z427VLS*/
*            /*                                              @Z427VLS*/
*            /* INPUT DATA SETS MUST BE CLOSED IF HISTORY IS INPUT    *
*            /*                                              @Z427VLS*/
*            CLOSEIO = CLOSEIO && CLOSEIO;                 /*@Z427VLS*/
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0311
*            IF PLOGREC = ON THEN                                  0312
         TM    PLOGREC(R2),B'00000010'                             0312
         BNO   @RF00312                                            0312
*              CSERLOG = ON;                               /*@Z427VLS*/
         OI    CSERLOG(R2),B'00100000'                             0313
*            CDRCTWRK = ON;                                /*@Z427VLS*/
@RF00312 OI    CDRCTWRK(R2),B'00000010'                            0314
*            CALL IOHND (IOCLOSE);                         /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0315
         LA    @01,@AL00315                                        0315
         BALR  @14,@15                                             0315
*          END;                                            /*@Z427VLS*/
*        /*                                                  @Z427VLS*/
*        /* WHEN END OF FILE HAS BEEN REACHED OR THE CONTROL @Z427VLS*/
*        /* TABLE IS FULL THE ENTRIES ARE SORTED FOR PROCESSING.      *
*        /* THE COUNT OF RECORDS AND THE ADDRESS OF THE FIRST ENTRY IS*
*        /* SAVED FOR THE SECOND PASS.                       @Z427VLS*/
*        /*                                                  @Z427VLS*/
*        IF RECCOUNT ^= ZERO THEN       /* ANY VALID RECORDS @ZA26586*/
@RF00309 LH    @06,RECCOUNT                                        0317
         LTR   @06,@06                                             0317
         BZ    @RF00317                                            0317
*          DO;                                             /*@Z427VLS*/
*            IF RECCOUNT > ONE THEN     /* INSURE > ONE REC  @ZA26586*/
         C     @06,@CF00052                                        0319
         BNH   @RF00319                                            0319
*              DO;                                         /*@ZA26586*/
*                CALL SORT;                                /*@ZA26586*/
         BAL   @14,SORT                                            0321
*              END;                                        /*@ZA26586*/
*            IF DEBUG11 = ON THEN      /* ABEND REQUESTED?   @Z427VLS*/
@RF00319 TM    DEBUG11(R2),B'00010000'                             0323
         BNO   @RF00323                                            0323
*              GEN (ABEND 520,DUMP);                       /*@Z427VLS*/
         ABEND 520,DUMP
*            /*                                              @Z427VLS*/
*            /* START PROCESSING THE ENTRIES IN THE CONTROL TABLE. AT *
*            /* THE END OF THE TABLE, PROCESS THE SUMMARY CTRS WHICH  *
*            /* HAVE BEEN BUILT DURING RECORD PROCESSING. LOAD        *
*            /* IFCECUA0/1 AND IFCSCUA0/1 FOR PROCESSING. IF THE      *
*            /* IFCE/SCUA1 ROUTINES ARE LOADED THRESHOLD HAS BEEN     *
*            /* SPECIFIED.                                   @Z427VLS*/
*            /*                                              @Z427VLS*/
*            IF PARMTHR = ON THEN                                  0325
@RF00323 TM    PARMTHR(R2),B'00001000'                             0325
         BNO   @RF00325                                            0325
*              TABNBR = CHARONE;         /* THRESHOLD PROCESSING      *
         MVI   TABNBR,C'1'                                         0326
*            STABNBR = TABNBR;           /* ESTABLISH SUM TBL NUMBER  *
@RF00325 MVC   STABNBR(1),TABNBR                                   0327
*            GENERATE REFS(ETABNAME,EDITTAB,STABNAME,SUMTAB);      0328
         LOADEREP EPLOC=ETABNAME   LOAD EDIT TABLE
               ST   R0,EDITTAB                  SAVE ADDRESS
         LOADEREP EPLOC=STABNAME   LOAD SUMMARY TABLE
               ST   R0,SUMTAB                   SAVE ADDRESS
*            DO CURRPTR = CURRPTR BY 11 WHILE (EOTABLE ^= EOT);    0329
         B     @DE00329                                            0329
@DL00329 DS    0H                                                  0330
*              RECCCHHR = TABCCHHR;                        /*@Z427VLS*/
         MVC   RECCCHHR(5,R2),TABCCHHR(CURRPTR)                    0330
*              RESPECIFY (R15) RESTRICTED;                 /*@Z427VLS*/
*              CALL IOHND(READIRCT);     /* GET A RECORD BY CCHHR     *
         L     @15,ADIOHND(,R2)                                    0332
         LA    @01,@AL00332                                        0332
         BALR  @14,@15                                             0332
*              RETCODE = R15;                              /*@Z427VLS*/
         ST    R15,RETCODE                                         0333
*              RESPECIFY (R15) UNRESTRICTED;               /*@Z427VLS*/
*              IF RETCODE = ZERO THEN                              0335
         L     @06,RETCODE                                         0335
         SLR   @03,@03                                             0335
         CR    @06,@03                                             0335
         BNE   @RF00335                                            0335
*                DO;                                       /*@Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  /* BUILD A TABLE WITH THE CUA, DEVICE CODE, AND CPU*
*                  /* SERIAL NUMBER, TO CONTROL PROCESSING THE RECORD.*
*                  /*                                        @Z427VLS*/
*                  CUACPU = CUACPU && CUACPU;       /* CLEAR SAVE AREA*
         XC    CUACPU(8),CUACPU                                    0337
*                  SAVECUA(2:3) = CONTRCUA(2:3);     /* SAVE CUA     */
         MVC   SAVECUA+1(2),CONTRCUA+1(CURRPTR)                    0338
*                  SAVECPU(1:3) = CPU;               /* SAVE CPU     */
         MVC   SAVECPU(3),CPU(CURRPTR)                             0339
*                  /*                                        @Z427VLS*/
*                  /* DETERMINE IF THE CUA SUMMARY COUNTERS MUST BE   *
*                  /* PRINTED.  THEY ARE PRINTED AFTER THE RECORDS FOR*
*                  /* EACH CUA.  EACH DATE COVERED HAS A SEPARATE CTR *
*                  /*                                        @Z427VLS*/
*                  IF PARMTHR = ON & CNTAREA ^= ZERO &             0340
*                    (LASTCUA ^= SAVECUA ×                         0340
*                    LASTCPU(1:3) ^= SAVECPU(1:3)) THEN            0340
         TM    PARMTHR(R2),B'00001000'                             0340
         BNO   @RF00340                                            0340
         C     @03,CNTAREA                                         0340
         BE    @RF00340                                            0340
         CLC   LASTCUA(3),SAVECUA                                  0340
         BNE   @RT00340                                            0340
         CLC   LASTCPU(3),SAVECPU                                  0340
         BE    @RF00340                                            0340
@RT00340 DS    0H                                                  0341
*                    /* DIFFERENT CUAS OR CPUS.              @Z427VLS*/
*                    DO;                                   /*@Z427VLS*/
*                      CALL OUTEDIT (FOXEASY);             /*@Z427VLS*/
         LA    @01,@AL00342                                        0342
         BAL   @14,OUTEDIT                                         0342
*                      CALL OUTSUM;               /* OUTPUT SUM CTRS  *
         BAL   @14,OUTSUM                                          0343
*                      GENERATE REFS(ETABNAME,STABNAME,EDITTAB,SUMTAB);
                         DELETE EPLOC=ETABNAME  DELETE EDIT TABLE
                         DELETE EPLOC=STABNAME  DELETE SUM  TABLE
         LOADEREP EPLOC=ETABNAME   LOAD EDIT TABLE
                         ST     R0,EDITTAB
         LOADEREP EPLOC=STABNAME   LOAD SUMMARY TABLE
                         ST     R0,SUMTAB
*                    END;                                  /*@Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  /* IS A DETAIL PRINT OF EVERY RECORD WANTED. FORCE *
*                  /* DETAIL PRINT IF THRESHOLD SPECIFIED    @Z427VLS*/
*                  /*                                        @Z427VLS*/
*                     RECCUA = OCUA2;                      /*@0001VLS*/
@RF00340 MVC   RECCUA(2),OCUA2(BUFFPTR)                            0346
*                     IF SHAREPTR ^= ZERO THEN                     0347
         L     @06,SHAREPTR(,R2)                                   0347
         LTR   @06,@06                                             0347
         BZ    @RF00347                                            0347
*                       CALL CUASHARE;                     /*@0001VLS*/
         BAL   @14,CUASHARE                                        0348
*                     SHRCUA = RECCUA;                     /*@0001VLS*/
@RF00347 MVC   SHRCUA(2,BUFFPTR),RECCUA                            0349
*                  IF PEDIT = ON THEN                              0350
         TM    PEDIT(R2),B'00010000'                               0350
         BNO   @RF00350                                            0350
*                    CALL OUTEDIT (HEXZERO);               /*@Z427VLS*/
         LA    @01,@AL00351                                        0351
         BAL   @14,OUTEDIT                                         0351
*                  /*                                        @Z427VLS*/
*                  /* THIS SECTION CONTROLS THE SUMMING OF RECORDS.   *
*                  /* THE COUNTERS ARE PROPERLY UPDATED.  IF THRESHOLD*
*                  /* IS SPECIFIED, A SUMMARY BY CUA IS FORCED.       *
*                  /*                                        @Z427VLS*/
*                  IF PSUM = ON THEN                               0352
@RF00350 TM    PSUM(R2),B'00001000'                                0352
         BNO   @RF00352                                            0352
*                    DO;                                   /*@Z427VLS*/
*                      /*                                    @Z427VLS*/
*                      /* CHECK IF THIS RECORD DATE IS DIFFERENT THAN *
*                      /* THE PREVIOUS ONE. IF IT IS, CHAIN ANOTHER   *
*                      /* SUM AREA TO THE CURRENT AREA.  IF THE DATES *
*                      /* ARE THE SAME, THE RECORD IS SUMMED INTO THE *
*                      /* CURRENT AREA.  DO NOT BREAK FOR CUA         *
*                      /* THRESHOLD SUMMARY.                 @Z427VLS*/
*                      /*                                    @Z427VLS*/
*                      IF (LASTDATE^=DATE & PARMTHR = OFF) ×       0354
*                    LASTCPU(1:3) ^= SAVECPU(1:3) ×                0354
*                    LASTCUA ^= SAVECUA THEN                       0354
         CLC   LASTDATE(4),DATE(BUFFPTR)                           0354
         BE    @GL00020                                            0354
         TM    PARMTHR(R2),B'00001000'                             0354
         BZ    @RT00354                                            0354
@GL00020 CLC   LASTCPU(3),SAVECPU                                  0354
         BNE   @RT00354                                            0354
         CLC   LASTCUA(3),SAVECUA                                  0354
         BE    @RF00354                                            0354
@RT00354 DS    0H                                                  0355
*                        CALL GETSPACE;                    /*@Z427VLS*/
         BAL   @14,GETSPACE                                        0355
*                     OCUA2 = RECCUA;                      /*@0001VLS*/
@RF00354 MVC   OCUA2(2,BUFFPTR),RECCUA                             0356
*                      CALL SUMIT;                         /*@Z427VLS*/
         BAL   @14,SUMIT                                           0357
*                    END;                                  /*@Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  /* PLACE THE VOLID IN THE RECORD CONTROL TABLE FOR *
*                  /* NEXT SORT OF THE TABLE AND PROCESSING BY VOLID. *
*                  /*                                        @Z427VLS*/
*                  CONTRVOL = VOLID;                       /*@Z427VLS*/
@RF00352 MVC   CONTRVOL(6,CURRPTR),VOLID(BUFFPTR)                  0359
*                END;                                      /*@Z427VLS*/
*              ELSE                                                0361
*                CONTRVOL = CONTRVOL && CONTRVOL;          /*@Z427VLS*/
         B     @RC00335                                            0361
@RF00335 XC    CONTRVOL(6,CURRPTR),CONTRVOL(CURRPTR)               0361
*            END;                                          /*@Z427VLS*/
@RC00335 AL    CURRPTR,@CF00575                                    0362
@DE00329 CLC   EOTABLE(2,CURRPTR),@CB00259                         0362
         BNE   @DL00329                                            0362
*            IF PARMTHR = ON THEN         /* OUTPUT TRESH STATS AT END*
         TM    PARMTHR(R2),B'00001000'                             0363
         BNO   @RF00363                                            0363
*              CALL OUTEDIT (FOXFOX);                      /*@Z427VLS*/
         LA    @01,@AL00364                                        0364
         BAL   @14,OUTEDIT                                         0364
*            /*                                              @Z427VLS*/
*            /* WAS A SUMMARY REQUESTED. FORCE SUMMARY EDIT PRINTING  *
*            /* IF THRESHOLD IS SPECIFIED.                   @Z427VLS*/
*            /*                                              @Z427VLS*/
*            IF CNTAREA ^= ZERO THEN                               0365
@RF00363 L     @06,CNTAREA                                         0365
         LTR   @06,@06                                             0365
         BZ    @RF00365                                            0365
*              CALL OUTSUM;                 /* OUTPUT THE SUMMARY CTRS*
         BAL   @14,OUTSUM                                          0366
*            /*                                              @Z427VLS*/
*            /* SORT THE RECORDS BY VOLID AND PROCESS ALL THE MES     *
*            /* RECORDS BY VOLID.                            @Z427VLS*/
*            /*                                              @Z427VLS*/
*            GENERATE REFS(ETABNAME,STABNAME);             /*@Z427VLS*/
@RF00365 DS    0H                                                  0367
               DELETE EPLOC=ETABNAME DELETE EDIT TABLE
               DELETE EPLOC=STABNAME DELETE SUMMARY TABLE
*            CURRPTR = TABPTR;         /* GET ADDRESS FIRST TABLE ENT *
         L     CURRPTR,TABPTR                                      0368
*            REPTYPE = VOLREP;         /* MOVE 'VOL' TO EDIT AND      *
         MVC   REPTYPE(4),VOLREP                                   0369
*            SREPTYPE = VOLREP;        /* SUMMARY TABLE NAMES         *
         MVC   SREPTYPE(4),VOLREP                                  0370
*            SORTFLG = ON;             /* RESET SORT FLAG    @Z427VLS*/
         OI    SORTFLG,B'10000000'                                 0371
*            IF RECCOUNT > ONE THEN     /* INSURE > ONE REC  @ZA26586*/
         LH    @06,RECCOUNT                                        0372
         C     @06,@CF00052                                        0372
         BNH   @RF00372                                            0372
*              DO;                                         /*@ZA26586*/
*                CALL SORT;                                /*@ZA26586*/
         BAL   @14,SORT                                            0374
*              END;                                        /*@ZA26586*/
*            GENERATE REFS(ETABNAME,EDITTAB,STABNAME,SUMTAB);      0376
@RF00372 DS    0H                                                  0376
         LOADEREP EPLOC=ETABNAME   LOAD EDIT TABLE
               ST   R0,EDITTAB       SAVE THE ENTRY POINT
         LOADEREP EPLOC=STABNAME   LOAD SUMMARY TABLE
               ST   R0,SUMTAB        SAVE THE ENTRY POINT
*            IF PARMTHR = ON THEN     /* FORCE NO VOL SUM IF THRESHOLD*
         TM    PARMTHR(R2),B'00001000'                             0377
         BNO   @RF00377                                            0377
*              PSUM = OFF;                                 /*@Z427VLS*/
         NI    PSUM(R2),B'11110111'                                0378
*            CUACPU = CUACPU && CUACPU;                    /*@Z427VLS*/
@RF00377 XC    CUACPU(8),CUACPU                                    0379
*            /*                                              @Z427VLS*/
*            /* PROCESS THE ENTRIES IN THE CONTROL TABLE.  AT THE END,*
*            /* PROCESS THE SUMMARY COUNTERS THAT HAVE BEEN BUILD.    *
*            /*                                              @Z427VLS*/
*            DO CURRPTR = CURRPTR BY 11 WHILE (EOTABLE ^= EOT);    0380
         B     @DE00380                                            0380
@DL00380 DS    0H                                                  0381
*              RECCCHHR = TABCCHHR;                        /*@Z427VLS*/
         MVC   RECCCHHR(5,R2),TABCCHHR(CURRPTR)                    0381
*              RESPECIFY (R15) RESTRICTED;                 /*@Z427VLS*/
*              CALL IOHND(READIRCT);                       /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0383
         LA    @01,@AL00383                                        0383
         BALR  @14,@15                                             0383
*              RETCODE = R15;                              /*@Z427VLS*/
         ST    R15,RETCODE                                         0384
*              RESPECIFY (R15) UNRESTRICTED;               /*@Z427VLS*/
*              IF RETCODE = ZERO THEN                              0386
         L     @06,RETCODE                                         0386
         LTR   @06,@06                                             0386
         BNZ   @RF00386                                            0386
*                DO;                                       /*@Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  /* BUILD A TABLE WITH THE DEVICE CODE AND VOLID.   *
*                  /* THE TABLE IS USED FOR PROCESSING THE RECORD.    *
*                  /*                                        @Z427VLS*/
*                  IF PARMTHR = OFF THEN                           0388
         TM    PARMTHR(R2),B'00001000'                             0388
         BNZ   @RF00388                                            0388
*                    CUACPU = VOLID;                       /*@Z427VLS*/
         MVI   CUACPU+6,C' '                                       0389
         MVI   CUACPU+7,C' '                                       0389
         MVC   CUACPU(6),VOLID(BUFFPTR)                            0389
*                  /*                                        @Z427VLS*/
*                  /* IS A DETAIL PRINT OF EVERY RECORD WANTED.       *
*                  /*                                        @Z427VLS*/
*                  IF PEDIT = ON THEN                              0390
@RF00388 TM    PEDIT(R2),B'00010000'                               0390
         BNO   @RF00390                                            0390
*                    CALL OUTEDIT (HEXZERO);               /*@Z427VLS*/
         LA    @01,@AL00391                                        0391
         BAL   @14,OUTEDIT                                         0391
*                  /*                                        @Z427VLS*/
*                  /* CHECK FOR SUMMARY REQUEST. ASSURE THAT SUMMARY  *
*                  /* COUNTERS ARE UPDATED PROPERLY.         @Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  IF PSUM = ON THEN                               0392
@RF00390 TM    PSUM(R2),B'00001000'                                0392
         BNO   @RF00392                                            0392
*                    DO;                                   /*@Z427VLS*/
*                      /*                                    @Z427VLS*/
*                      /* DETERMINE IF RECORD BEING PROCESSED SHOULD  *
*                      /* BE SUMMED WITH THE CURRENT COUNTERS OR IF A *
*                      /* NEW AREA IS NEEDED.                @Z427VLS*/
*                      /*                                    @Z427VLS*/
*                      IF SUMIDENT ^= CUACPU THEN                  0394
         L     @06,CURRCNTS                                        0394
         CLC   SUMIDENT(8,@06),CUACPU                              0394
         BE    @RF00394                                            0394
*                        CALL GETSPACE;                    /*@Z427VLS*/
         BAL   @14,GETSPACE                                        0395
*                      CALL SUMIT;                         /*@Z427VLS*/
@RF00394 BAL   @14,SUMIT                                           0396
*                    END;                                  /*@Z427VLS*/
*                END;                                      /*@Z427VLS*/
@RF00392 DS    0H                                                  0399
*            END;                                          /*@Z427VLS*/
@RF00386 AL    CURRPTR,@CF00575                                    0399
@DE00380 CLC   EOTABLE(2,CURRPTR),@CB00259                         0399
         BNE   @DL00380                                            0399
*            IF PARMTHR = ON THEN       /* OUTPUT THRESH STATS AT END *
         TM    PARMTHR(R2),B'00001000'                             0400
         BNO   @RF00400                                            0400
*              CALL OUTEDIT (FOXFOX);                      /*@Z427VLS*/
         LA    @01,@AL00401                                        0401
         BAL   @14,OUTEDIT                                         0401
*            IF CNTAREA ^= ZERO THEN    /* OUTPUT MES VOLUME SUMMARY  *
@RF00400 L     @06,CNTAREA                                         0402
         LTR   @06,@06                                             0402
         BZ    @RF00402                                            0402
*              CALL OUTSUM;                                /*@Z427VLS*/
         BAL   @14,OUTSUM                                          0403
*          END;                                            /*@Z427VLS*/
*    END;                /* END FOR GETMAIN FAILURE        @0001VLS   *
*     ELSE                                                         0406
*      DO;                                                 /*@GZZDGVS*/
         B     @RC00204                                            0406
@RF00204 DS    0H                                                  0407
*       CALL IFCMSG(55,ADDR(MSGADDR));  /* MESSAGE FOR GETMAIN FAIL  */
         LA    @06,MSGADDR                                         0407
         ST    @06,@AFTEMPS                                        0407
         L     @15,ADIFCMSG(,R2)                                   0407
         LA    @01,@AL00407                                        0407
         BALR  @14,@15                                             0407
*       PRINTADR = ADDR(MSGADDR);                          /*@0001VLS*/
         LA    @06,MSGADDR                                         0408
         ST    @06,PRINTADR(,R2)                                   0408
*       CALL IOHND(RITEPRTR);                              /*@0001VLS*/
         L     @15,ADIOHND(,R2)                                    0409
         LA    @01,@AL00409                                        0409
         BALR  @14,@15                                             0409
*      END;                                                /*@GZZDGVS*/
*        IF DEBUG12 = ON THEN           /* ABEND REQUESTED?  @Z427VLS*/
@RC00204 TM    DEBUG12(R2),B'00001000'                             0411
         BNO   @RF00411                                            0411
*          GEN(ABEND 540,DUMP);                            /*@Z427VLS*/
         ABEND 540,DUMP
*        RETURN;                                           /*@Z427VLS*/
@EL00001 L     @13,4(,@13)                                         0413
@EF00001 DS    0H                                                  0413
@ER00001 L     @14,12(,@13)                                        0413
         LM    @00,@12,20(@13)                                     0413
         BR    @14                                                 0413
* END                                                      /*@Z427VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 0414
         B     @EL00001                                            0414
@DATA    DS    0H
@CH00071 DC    H'2'
@CH00073 DC    H'3'
@CH00076 DC    H'5'
@CH00080 DC    H'7'
         DS    0F
@AL00199 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00282 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00295 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00409 DC    A(@CH00071)             LIST WITH   1 ARGUMENT(S)
@AL00211 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00273 DC    A(@CH00073)             LIST WITH   1 ARGUMENT(S)
@AL00250 DC    A(@CH00076)             LIST WITH   1 ARGUMENT(S)
@AL00280 DC    A(@CF00572)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00285 DC    A(@CF00637)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00315 DC    A(@CH00080)             LIST WITH   1 ARGUMENT(S)
@AL00332 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00383 DC    A(@CF00078+2)           LIST WITH   1 ARGUMENT(S)
@AL00342 DC    A(@CB00457)             LIST WITH   1 ARGUMENT(S)
@AL00351 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00391 DC    A(@CB00223)             LIST WITH   1 ARGUMENT(S)
@AL00364 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00401 DC    A(@CB00276)             LIST WITH   1 ARGUMENT(S)
@AL00407 DC    A(@CF00641)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00004 DS    0F
@PC00004 EQU   @SA00004+60
         DS    16F
@TF00001 DS    F
@AFTEMPS DS    1F
         DS    0F
@CF00052 DC    F'1'
@CH00052 EQU   @CF00052+2
@CF00078 DC    F'6'
@CH00078 EQU   @CF00078+2
@CF00063 DC    F'8'
@CF00575 DC    F'11'
@CH00575 EQU   @CF00575+2
@CF00610 DC    F'22'
@CF00635 DC    F'27'
@CF00572 DC    F'53'
@CF00637 DC    F'54'
@CF00641 DC    F'55'
@CF00650 DC    F'-9'
@CF00651 DC    F'-4'
@CF00655 DC    F'-3'
@CF00640 DC    XL4'FFFFF8'
@CV00534 DC    V(IFCEEDIT)
         DS    0D
EDITTAB  DS    F
CNTAREA  DC    A(0)
CURRCNTS DS    A
SUMTAB   DS    A
TABPTR   DS    A
RETCODE  DS    F
FREESIZE DC    F'8192'
SRTCONT  DC    F'0'
RECCOUNT DC    H'0'
I        DS    H
         DS    0D
@TS00001 DS    CL8
@CB00259 DC    X'FFFF'
@CB00460 DC    X'0FFF'
@CB00462 DC    X'000F'
@CB00223 EQU   @CB00462
@CB00276 EQU   @CB00259
@CB00457 DC    X'FE'
SUMCNTRL DS    CL10
         ORG   SUMCNTRL
CUACPU   DS    CL8
         ORG   CUACPU
SAVECUA  DS    CL3
SAVECPU  DS    CL5
         ORG   SUMCNTRL+8
SAVEDEV  DC    X'8003'
         ORG   SUMCNTRL+10
RECCPU   DC    CL3' '
RECCUA   DC    CL2' '
ETABNAME DS    CL8
         ORG   ETABNAME
@NM00013 DC    CL4'IFCE'
REPTYPE  DC    CL4'CUA0'
         ORG   ETABNAME+8
STABNAME DS    CL8
         ORG   STABNAME
@NM00014 DC    CL4'IFCS'
SREPTYPE DC    CL4'CUA0'
         ORG   STABNAME+8
LASTDATE DS    CL4
LASTCUA  DS    CL3
LASTCPU  DS    CL5
SWITCH   DC    X'80'
         ORG   SWITCH
SORTFLG  DS    BL1
VALIDSER EQU   SWITCH+0
VALIDCPU EQU   SWITCH+0
VALIDSHR EQU   SWITCH+0
VALIDCUA EQU   SWITCH+0
VALIDVOL EQU   SWITCH+0
         ORG   SWITCH+1
VOLREP   DC    CL4'VOL0'
MESSAGE  DS    CL134
         ORG   MESSAGE
@NM00027 DC    CL1'1'
@NM00028 DC    CL1' '
MSGADDR  DC    CL132' '
         ORG   MSGADDR
@NM00029 DS    CL8
NUMRECP  DS    CL7
         ORG   MESSAGE+134
@NM00030 DS    CL10
         ORG   @NM00030
SHR74XXX DS    CL5
         ORG   SHR74XXX
SHR74CUA DS    BL2
SHR74CPU DS    CL3
         ORG   @NM00030+5
SHR74XXD DS    CL5
         ORG   SHR74XXD
@NM00031 DS    CL2
         ORG   @NM00031
SHR74XDD DS    BL1
@NM00032 EQU   @NM00031+0
SHR74CUX DS    BL1
         ORG   SHR74XXD+2
@NM00033 DS    CL3
         ORG   @NM00030+10
SUPERZAP DC    3CL10'SUPERZAP'
         DS    CL1
PATCH    DC    20H'0'
IFCMES01 CSECT
         DC    S(SUPERZAP)
IFCMES01 CSECT
         DC    S(PATCH)
IFCMES01 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SUMSPEC1 EQU   @05
CURRPTR  EQU   @05
SAVEPARM EQU   @05
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R6       EQU   @06
R7       EQU   @07
R9       EQU   @09
R12      EQU   @12
R15      EQU   @15
BUFFPTR  EQU   @07
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
R14      EQU   @14
R5       EQU   @05
R8       EQU   @08
IOHND    EQU   0
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
PARMTHR  EQU   SWITCHES
SHIFT3RD EQU   SWITCHES+1
DEBUG    EQU   PARM+4
DEBUG4   EQU   DEBUG
DEBUG11  EQU   DEBUG+1
DEBUG12  EQU   DEBUG+1
DEBUGA   EQU   PARM+8
MISC     EQU   PARM+12
PHIST    EQU   MISC
PRINTES  EQU   MISC
PEDIT    EQU   PRINTES
PSUM     EQU   PRINTES
PLOGREC  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
CSERLOG  EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
RDTHRSH  EQU   PARM+66
WRTHRSH  EQU   PARM+69
@NM00007 EQU   PARM+75
TABSIZE  EQU   PARM+80
SORTNUM  EQU   PARM+84
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECCCHHR EQU   CCHHRLNG
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVKEY    EQU   EVTABLE+6
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHARENUM EQU   SHARE
SHAREIO  EQU   SHARE+2
SHRCUCPU EQU   SHAREIO
SHARECUA EQU   SHRCUCPU
SHAREDX  EQU   SHARECUA
SHARECUB EQU   SHAREIO+5
SHARSERB EQU   SHAREIO+7
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUANUM   EQU   CUA
CUAVAL   EQU   CUA+2
CUA1     EQU   CUAVAL
CUA2     EQU   CUAVAL+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
SERNUM   EQU   DEVSERAL
SERVAL   EQU   DEVSERAL+2
VOLUME   EQU   0
VOLNUM   EQU   VOLUME
VOLVAL   EQU   VOLUME+2
CPUS     EQU   0
CPUNUM   EQU   CPUS
CPUVAL   EQU   CPUS+2
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
COUNTER  EQU   0
EDITCUA1 EQU   0
ERTHRE   EQU   EDITCUA1+20
EWTHRE   EQU   EDITCUA1+23
SUMTABLE EQU   0
SUMPTR   EQU   SUMTABLE
SUMEDIT  EQU   SUMTABLE+4
NEXTENT  EQU   SUMTABLE+8
CNTSIZE  EQU   SUMTABLE+12
SUMHEAD  EQU   0
NEXTTAB  EQU   SUMHEAD
SUMIDENT EQU   SUMHEAD+4
MODNAME  EQU   SUMHEAD+12
CURRDEV  EQU   SUMHEAD+20
COUNTERS EQU   SUMHEAD+22
SUMENTRY EQU   0
SUMFLAG  EQU   SUMENTRY
SUMMASK  EQU   SUMENTRY+1
OFFSET   EQU   SUMENTRY+2
SUMSPEC  EQU   OFFSET
CNTOFSET EQU   SUMENTRY+4
BUFFER   EQU   0
RECTYP   EQU   BUFFER
SWITCHE  EQU   BUFFER+2
SW2      EQU   SWITCHE+1
SHORT    EQU   SW2
SHRCUA   EQU   BUFFER+5
DATE     EQU   BUFFER+8
TIME     EQU   BUFFER+12
CPUIDENT EQU   BUFFER+17
CPUSER   EQU   CPUIDENT
ODEVICE  EQU   BUFFER+52
DEV2     EQU   ODEVICE+2
OCUA     EQU   BUFFER+57
OCUA2    EQU   OCUA+1
VOLID    EQU   BUFFER+64
OSER74XX EQU   BUFFER+123
CONTRTAB EQU   0
CONTRVOL EQU   CONTRTAB
CONTRCUA EQU   CONTRVOL
EOTABLE  EQU   CONTRCUA
CPU      EQU   CONTRVOL+3
TABCCHHR EQU   CONTRTAB+6
SUMMARY  EQU   0
THRSHRC  EQU   0
THRSHFLG EQU   THRSHRC+4
SPECIAL  EQU   0
RECFLAG  EQU   0
TABNBR   EQU   REPTYPE+3
STABNBR  EQU   SREPTYPE+3
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00034 EQU   THRSHRC
@NM00026 EQU   BUFFER+70
@NM00025 EQU   BUFFER+60
@NM00024 EQU   OCUA
@NM00023 EQU   BUFFER+56
@NM00022 EQU   ODEVICE
@NM00021 EQU   BUFFER+22
CPUMOD   EQU   CPUIDENT+3
@NM00020 EQU   BUFFER+16
@NM00019 EQU   BUFFER+7
@NM00018 EQU   BUFFER+4
@NM00017 EQU   SW2
@NM00016 EQU   SWITCHE
@NM00015 EQU   BUFFER+1
@NM00012 EQU   EDITCUA1
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+10
SHARSERA EQU   SHRCUCPU+2
SYSTEMP  EQU   SYSUM2+9
SYSPERM  EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
EVLETTER EQU   EVKEY+5
EVSERIAL EQU   EVKEY+2
EVMODEL  EQU   EVKEY
EVNUM    EQU   EVTABLE+4
EVDAY    EQU   EVSTOP+1
EVYEAR   EQU   EVSTOP
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
LINECT   EQU   PARM+120
RECLNGTH EQU   CCHHRLNG+6
@NM00009 EQU   CCHHRLNG+5
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
SYSRETRN EQU   @NM00007
@NM00006 EQU   PARM+72
TERM     EQU   PARM+58
EVSDAY   EQU   STRTDATE+1
EVSYEAR  EQU   STRTDATE
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
PASSFLAG EQU   MISC
ERRORID  EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00145 EQU   @RC00143
@PB00006 EQU   @PB00007
@RF00171 EQU   @RC00169
@RF00317 EQU   @RC00204
@RF00402 EQU   @RC00204
@RF00411 EQU   @EL00001
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IFCMES01,(C'PLS2112',0701,78017)

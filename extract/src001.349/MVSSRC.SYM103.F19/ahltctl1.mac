         TITLE 'AHLTCTL1- GTF INITIALIZATION CONTROL MODULE FOR TRACE O*
               OPTION   '
AHLTCTL1 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'AHLTCTL1  76.167'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*                                                                  0073
*/********************************************************************/
*/*                                                                  */
*/*                BEGIN INITIALIZER SCAN CONTROL ROUTINE            */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                                                                  */
*/*           INITIALIZE INITDATA                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0073
*   PARMDCB=ADDR(DCBFORM);          /* @ PARMLIB DCB INITDATA  Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0073
         LA    @06,DCBFORM                                         0073
         ST    @06,PARMDCB(,@14)                                   0073
*   ICTFLAGS=ZEROWD(1:2);           /* CLEAR FLAG BYTES        Y02014*/
         MVC   ICTFLAGS(2,@14),ZEROWD                              0074
*/********************************************************************/
*/*                                                                  */
*/*                       INITIALIZE ECB LIST                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0075
*   WECBAD=ADDR(WTORECB);           /* @ WTOR ECB TO ECB LST   Y02014*/
         LA    @00,WTORECB(,@14)                                   0075
         ST    @00,WECBAD                                          0075
*   SECBAD=STOPECBA;                /* @ STOP ECB TO ECB LST   Y02014*/
         L     @00,STOPECBA(,PCTPTR)                               0076
         ST    @00,SECBAD                                          0076
*   ENDECB='1'B;                    /* SET END OF LIST IND           */
         OI    ENDECB,B'10000000'                                  0077
*                                                                  0078
*/********************************************************************/
*/*                                                                  */
*/*                  INITIALIZE FOR PARMLIB RDJFCB                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0078
*   TWT=TWT&&TWT;                   /* CLEAR TEMP WORK               */
         XC    TWT(192,@14),TWT(@14)                               0078
*   DCBPTR=ADDR(DCBFORM);           /* SET BASE FOR DCB              */
         LR    DCBPTR,@06                                          0079
*   EXPLAD=ADDR(TWT)+4;             /* SET EXIT LIST FOR JFCB        */
         LA    EXPLAD,TWT(,@14)                                    0080
         AL    EXPLAD,@CF00060                                     0080
*   TWT(1:4)=EXPLAD;                /* SET @INPUT AREA               */
         STCM  EXPLAD,15,TWT(@14)                                  0081
*   TWT(1)='07'X;                   /* JFCB ENTRY                    */
         MVI   TWT(@14),X'07'                                      0082
*   DCBEXLST=ADDR(TWT);             /* SET @EXIT LIST                */
         LA    @14,TWT(,@14)                                       0083
         STCM  @14,7,DCBEXLST(DCBPTR)                              0083
*   GENERATE;                                                      0084
*                                                                  0084
*                                   /* RDJFCB FOR PARMLIB            */
           RDJFCB  ((DCBPTR))
*/********************************************************************/
*/*                                                                  */
*/*                    TEST FOR SUCCESSFUL RDJFCB                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0085
*   IF TWT(5:8)=ZEROWD              /* TEST IF JFCB READ             */
*     THEN                          /* JFCB NOT READ                 */
         L     @14,INITPTR(,PCTPTR)                                0085
         CLC   TWT+4(4,@14),ZEROWD                                 0085
         BE    @RT00085                                            0085
*     GO TO CTL03;                  /* TO AHLTSCN-CONSOL INPT        */
*/********************************************************************/
*/*                                                                  */
*/*            RDJFCB SUCCESSFUL-TEST FOR CORRECT DS NAME            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0087
*   IF JFCBDSNM(1:12)^=PLIBNM       /* TEST FOR CORRECT DSNAME Y02014*/
*     THEN                          /* NOT CORRECT DSNAME            */
         CLC   JFCBDSNM(12,@14),PLIBNM                             0087
         BNE   @RT00087                                            0087
*     GO TO CTL03;                  /* TO AHLTSCN-CONSOL INPT        */
*/********************************************************************/
*/*                                                                  */
*/*                 ISSUE MESSAGE FOR PARMLIB INPUT                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0089
*   ELSAV=JFCBELNM;                 /* SAVE MEMBER NAME              */
         MVC   ELSAV(8,@14),JFCBELNM(@14)                          0089
*   ICTIOTYP=2;                     /* SET IND FOR WTO MESSAGE Y02014*/
         MVI   ICTIOTYP(@14),X'02'                                 0090
*   ICTMSGX=19;                     /* SET NDX FOR AHL121I           */
         MVI   ICTMSGX(@14),X'13'                                  0091
*   CALL AHLTIO;                    /* ISSUE MSG                     */
         BAL   @14,AHLTIO                                          0092
*   JFCBELNM=ELSAV;                 /* RESTORE MEMBER NAME           */
         L     @14,INITPTR(,PCTPTR)                                0093
         MVC   JFCBELNM(8,@14),ELSAV(@14)                          0093
*/********************************************************************/
*/*                                                                  */
*/*                     TEST FOR NO MEMBER NAME                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0094
*   IF JFCBELNM^=BLANK              /* TEST FOR MEMBER NAME          */
*     THEN                          /* MEMBER NAME IN JFCB           */
         CLC   JFCBELNM(8,@14),BLANK                               0094
         BNE   @RT00094                                            0094
*     GO TO CTL02;                  /* ISSUE STAE FOR OPEN           */
*   ICTMSGX=20;                     /* SET INDX FOR AHL122I          */
         MVI   ICTMSGX(@14),X'14'                                  0096
*                                                                  0097
*/********************************************************************/
*/*                                                                  */
*/*                       ISSUE ERROR MESSAGE                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0097
*CTL01:                                                            0097
*   ICTIOTYP=2;                     /* SET TYPE FOR WTO              */
CTL01    L     @14,INITPTR(,PCTPTR)                                0097
         MVI   ICTIOTYP(@14),X'02'                                 0097
*   CALL AHLTIO;                    /* ISSUE MSG                     */
         BAL   @14,AHLTIO                                          0098
*   GO TO CTL03;                    /* TO AHLTSCN FOR TRC OPS        */
         B     CTL03                                               0099
*                                                                  0100
*/********************************************************************/
*/*                                                                  */
*/*                   ISSUE STAE AND OPEN PARMLIB                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0100
*CTL02:                                                            0100
*   RFY                                                            0100
*     SAVREG RSTD;                  /*                         Y02014*/
CTL02    DS    0H                                                  0101
*   SAVREG=ADDR(SVAREA);            /* SET R8 = @SAVE AREA           */
         LA    SAVREG,SVAREA                                       0101
*   RTRYAD=ADDR(CTLRETRY);          /* SET R15 = @ RETRY ROUT        */
         LA    RTRYAD,CTLRETRY                                     0102
*   EXPLAD=ADDR(TWTWORK);           /* SET STAE PLIST BASE           */
         L     EXPLAD,INITPTR(,PCTPTR)                             0103
         LA    EXPLAD,TWTWORK(,EXPLAD)                             0103
*   EXPLAD1=EXPLAD;                 /* SAVE REGISTER VALUE     Y02014*/
         ST    EXPLAD,EXPLAD1                                      0104
*   GEN(STM R0,R15,8(SAVREG));      /* SAVE REGS                     */
         STM R0,R15,8(SAVREG)
*   RTRYCODE=RETRYCOD;              /* MOVE RETRY CODE TO SAVE AREA  */
         MVC   RTRYCODE(6),RETRYCOD                                0106
*   SAVARAD=SAVREG;                 /* @SAVE AREA TO PLIST           */
         ST    SAVREG,SAVARAD(,EXPLAD)                             0107
*   STAEPLST=STAELST2;              /* PLACE STAE LIST INTO GOTTEN 0108
*                                      CORE                          */
         MVC   STAEPLST(8),STAELST2                                0108
*   PARMRG1=ADDR(STAEPLST);         /* SET R1 = @ STAE PLIST   Y02014*/
         LA    PARMRG1,STAEPLST                                    0109
*   GENERATE;                                                      0110
*                                   /* ISSUE STAE                    */
           STAE  PARAM=(EXPLAD),MF=(E,(1))
*   DCBPTR=ADDR(DCBFORM);           /* GET DCB ADDR FOR OPEN         */
         LA    DCBPTR,DCBFORM                                      0111
*   OPENPLST=OPENLST2;              /* PLACE OPEN PARMLIST INTO    0112
*                                      GOTTEN CORE                   */
         MVC   OPENPLST(4),OPENLST2                                0112
*   PARMRG1=ADDR(OPENPLST);         /* SET R1 = @ PLIST        Y02014*/
         LA    PARMRG1,OPENPLST                                    0113
*   GENERATE;                                                      0114
*                                   /* OPEN PARMLIB DATA SET         */
           OPEN  ((DCBPTR)),MF=(E,(1))         OPEN PARMLIB
           STAE  0                             CANCEL STAE
*   RFY                                                            0115
*     SAVREG UNRSTD;                                               0115
*   ICTPLIB='1'B;                   /* TURN ON PARMLIB IND IN ICT    */
         L     @14,INITPTR(,PCTPTR)                                0116
         OI    ICTPLIB(@14),B'10000000'                            0116
*                                                                  0117
*/********************************************************************/
*/*                                                                  */
*/*                      PROCESS TRACE OPTIONS                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0117
*CTL03:                                                            0117
*                                                                  0117
*/********************************************************************/
*/*                                                                  */
*/*    PASS CONTROL TO INITIALIZER SCAN/ANALYSIS ROUTINE - AHLTSCN   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0117
*   CALL AHLTSCN;                   /* GO TO AHLTSCN TO REQUEST AND
*                                      ANALYZE OPTIONS         Y02014*/
CTL03    L     @15,@CV00389                                        0117
         BALR  @14,@15                                             0117
*/********************************************************************/
*/*                                                                  */
*/*                  TEST RETURN CODE FROM AHLTSCN                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0118
*   IF RTRNCODE^=0                  /* TEST FOR ERROR IN SCN         */
*     THEN                          /* ERROR IN AHLTSCN              */
         SLR   @14,@14                                             0118
         CR    RTRNCODE,@14                                        0118
         BNE   @RT00118                                            0118
*     GO TO CTL06;                  /* END GTF                       */
*/********************************************************************/
*/*                                                                  */
*/*                      TEST FOR ERROR IN SCAN                      */
*/*             AND RETRY OF TRACE OPTION SPECIFICATION              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0120
*   IF ICTRETRY='1'B                /* TEST FOR RETRY                */
*     THEN                          /* ERROR - RETRY                 */
         L     @06,INITPTR(,PCTPTR)                                0120
         TM    ICTRETRY(@06),B'00010000'                           0120
         BO    @RT00120                                            0120
*     GO TO CTL07;                  /* REINITIALIZE TBLS             */
*/********************************************************************/
*/*                                                                  */
*/*                         TEST FOR PROMPTING                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0122
*   IF GTFSYSP='0'B                 /* TEST FOR PROMPTING      Y02014*/
*       &(GTFOPT2&'55'X)=0 THEN     /* NO PROMPTING            Y02014*/
         TM    GTFSYSP(@06),B'01000000'                            0122
         BNZ   @RF00122                                            0122
         LA    @00,85                                              0122
         SLR   @11,@11                                             0122
         IC    @11,GTFOPT2(,@06)                                   0122
         NR    @00,@11                                             0122
         CR    @00,@14                                             0122
         BE    @RT00122                                            0122
*     GO TO CTL04;                  /* GOTO AHLT103                  */
*                                                                  0124
*/********************************************************************/
*/*                                                                  */
*/*         PASS CONTROL TO INITIALIZER PROMPT ROUTINE - AHLTPMT     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0124
*   CALL AHLTPMT;                   /* TO AHLTPMT TO PROMPT FOR    0124
*                                      OPTIONS                 Y02014*/
@RF00122 L     @15,@CV00388                                        0124
         BALR  @14,@15                                             0124
*/********************************************************************/
*/*                                                                  */
*/*                  TEST RETURN CODE FROM AHLTPMT                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0125
*   IF RTRNCODE^=0                  /* TEST FOR ERROR IN PMT         */
*     THEN                          /* ERROR IN AHLTPMT              */
         LTR   RTRNCODE,RTRNCODE                                   0125
         BNZ   @RT00125                                            0125
*     GO TO CTL06;                  /* END GTF                       */
*/********************************************************************/
*/*                                                                  */
*/*                      TEST FOR ERROR IN SCAN                      */
*/*             AND RETRY OF TRACE OPTION SPECIFICATION              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0127
*   IF ICTRETRY='1'B THEN                                          0127
         L     @14,INITPTR(,PCTPTR)                                0127
         TM    ICTRETRY(@14),B'00010000'                           0127
         BO    @RT00127                                            0127
*     GO TO CTL07;                                                 0128
*                                                                  0129
*/********************************************************************/
*/*                                                                  */
*/*       INITIALIZE GTF OPTION WORD                           Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0129
*CTL04:                                                            0129
*   GTFOPTS(1:3)=ZEROWD(1:3);       /* INITIALIZE TO ZERO      Y02014*/
CTL04    MVC   GTFOPTS(3,PCTPTR),ZEROWD                            0129
*   GTFOPTS(1:3)=GTFOPTS×GTFOPIND;  /* SET TO INDICATE OPTS    Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0130
         MVC   @TS00001(3),GTFOPTS(PCTPTR)                         0130
         OC    @TS00001(3),GTFOPIND(@14)                           0130
         MVC   GTFOPTS(3,PCTPTR),@TS00001                          0130
*                                                                  0131
*/********************************************************************/
*/*                                                                  */
*/*         PASS CONTROL TO AHLT103 TO BUILD MESSAGE AHL103I         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0131
*   CALL AHLT103;                   /* TO AHLT103 TO BUILD AND ISSUE
*                                      MESSAGE AHLT103I        Y02014*/
         L     @15,@CV00391                                        0131
         BALR  @14,@15                                             0131
*                                                                  0132
*/********************************************************************/
*/*                                                                  */
*/*                  ISSUE MESSAGE AHL125A TO CHECK                  */
*/*                 FOR TRACE OPTION RESPECIFICATION                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0132
*CTL04A:                                                           0132
*   ICTMSGX=23;                     /* SET NDX FOR AHL125A           */
CTL04A   L     @14,INITPTR(,PCTPTR)                                0132
         MVI   ICTMSGX(@14),X'17'                                  0132
*   ICTIOTYP=1;                     /* SET IO TYPE FOR WTOR          */
         MVI   ICTIOTYP(@14),X'01'                                 0133
*   CALL AHLTIO;                    /* ISSUE AHL125A                 */
         BAL   @14,AHLTIO                                          0134
*/********************************************************************/
*/*                                                                  */
*/*                     TEST FOR STOP ECB POSTED                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0135
*   IF ICTSTOP='1'B                 /* TEST FOR STOP ECB POST        */
*     THEN                          /* STOP ECB POSTED               */
         L     @14,INITPTR(,PCTPTR)                                0135
         TM    ICTSTOP(@14),B'00000100'                            0135
         BNO   @RF00135                                            0135
*     DO;                                                          0136
*       RTRNCODE=12;                /* SET RTRN CODE TO STOP         */
         LA    RTRNCODE,12                                         0137
*       GO TO CTL06;                /* RETURN                        */
         B     CTL06                                               0138
*     END;                                                         0139
*                                                                  0139
*/********************************************************************/
*/*                                                                  */
*/*             LOOP TO ANALYZE REPLY TO MESSAGE AHL125A             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0140
*   DO MSGPTRVR=1 TO 124            /* ANALYZE REPLY                 */
*         BY 1;                                                    0140
*                                                                  0140
@RF00135 LA    MSGPTRVR,1                                          0140
@DL00140 DS    0H                                                  0141
*/********************************************************************/
*/*                                                                  */
*/*                   ANALYZE REPLY                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0141
*     IF MSGREPLY(MSGPTRVR)         /* TEST FOR NON-BLANK      Y02014*/
*         ^=BLANK(1) THEN           /* NON-BLANK FOUND               */
         L     @14,INITPTR(,PCTPTR)                                0141
         LR    @11,@14                                             0141
         ALR   @11,MSGPTRVR                                        0141
         CLC   MSGREPLY-1(1,@11),BLANK                             0141
         BE    @RF00141                                            0141
*       DO;                         /* TEST FOR VALID REPLY          */
*/********************************************************************/
*/*                                                                  */
*/*                   TEST FOR NO RESPECIFICATION                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0143
*         IF MSGREPLY(MSGPTRVR)     /* TEST FOR U              Y02014*/
*             ='U' THEN             /* U SPECIFIED                   */
         LR    @11,@14                                             0143
         ALR   @11,MSGPTRVR                                        0143
         CLI   MSGREPLY-1(@11),C'U'                                0143
         BE    @RT00143                                            0143
*           GO TO CTL04B;           /* CONTINUE                      */
*/********************************************************************/
*/*                                                                  */
*/*                     TEST FOR RESPECIFICATION                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0145
*         IF MSGREPLY(MSGPTRVR:MSGPTRVR+5)^=TRCEQ/*            Y02014*/
*           THEN                                                   0145
         LR    @11,@14                                             0145
         ALR   @11,MSGPTRVR                                        0145
         CLC   MSGREPLY-1(6,@11),TRCEQ                             0145
         BE    @RF00145                                            0145
*           DO;                     /* NOT TRACE=              Y02014*/
*             ICTMSGX=32;           /* ISSUE AHL136I           Y02014*/
         MVI   ICTMSGX(@14),X'20'                                  0147
*             ICTIOTYP=2;           /* MESSAGE IS WTO          Y02014*/
         MVI   ICTIOTYP(@14),X'02'                                 0148
*             CALL AHLTIO;          /* GO ISSUE MESSAGE        Y02014*/
         BAL   @14,AHLTIO                                          0149
*             GO TO CTL04A;         /* REISSUE AHL125A               */
         B     CTL04A                                              0150
*           END;                                                   0151
*         ICTTRCIN='1'B;            /* SET IND-OPS IN BUFFER         */
@RF00145 L     @14,INITPTR(,PCTPTR)                                0152
         OI    ICTTRCIN(@14),B'00001000'                           0152
*         GO TO CTL07;              /* RESTART                       */
         B     CTL07                                               0153
*       END;                                                       0154
*   END;                                                           0155
@RF00141 AL    MSGPTRVR,@CF00055                                   0155
         C     MSGPTRVR,@CF00244                                   0155
         BNH   @DL00140                                            0155
*   ICTMSGX=32;                     /* ISSUE MSG AHL136I       Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0156
         MVI   ICTMSGX(@14),X'20'                                  0156
*   ICTIOTYP=2;                     /* MESSAGE IS WTO          Y02014*/
         MVI   ICTIOTYP(@14),X'02'                                 0157
*   CALL AHLTIO;                    /* GO ISSUE MESSAGE        Y02014*/
         BAL   @14,AHLTIO                                          0158
*   GO TO CTL04A;                   /* REISSUE AHL125A-NO RPLY       */
         B     CTL04A                                              0159
*                                                                  0160
*/********************************************************************/
*/*                                                                  */
*/*                         TEST FOR PROMPTING                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0160
*CTL04B:                                                           0160
*   IF GTFSYSP='0'B                 /* TEST FOR PROMPTING      Y02014*/
*       &(GTFOPT2&'55'X)=0 THEN     /* NO PROMPTING            Y02014*/
CTL04B   L     @14,INITPTR(,PCTPTR)                                0160
         TM    GTFSYSP(@14),B'01000000'                            0160
         BNZ   @RF00160                                            0160
         LA    @06,85                                              0160
         SLR   @00,@00                                             0160
         IC    @00,GTFOPT2(,@14)                                   0160
         NR    @06,@00                                             0160
         LTR   @06,@06                                             0160
         BZ    @RT00160                                            0160
*     GO TO CTL05B;                 /* EXIT                    Y02014*/
*/********************************************************************/
*/*                                                                  */
*/*    PASS CONTROL TO INITIALIZER ROUTINE TO CONVERT FILTER TABLES  */
*/*                     TO FINAL FORMAT - AHLTTAB                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0162
*   CALL AHLTTAB;                   /* TO AHLTTAB TO BUILD FILTER  0162
*                                      TABLES                  Y02014*/
@RF00160 L     @15,@CV00390                                        0162
         BALR  @14,@15                                             0162
*/********************************************************************/
*/*                                                                  */
*/*                TEST FOR RETURN CODE FROM AHLTTAB                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0163
*   IF RTRNCODE^=0                  /* TEST FOR ERROR IN TAB         */
*     THEN                          /* ERROR IN AHLTTAB              */
         LTR   RTRNCODE,RTRNCODE                                   0163
         BNZ   @RT00163                                            0163
*     GO TO CTL06;                  /* END GTF                       */
*/********************************************************************/
*/*                                                                  */
*/*              SET GTFOPIND FOR LOADING SCHEME               Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0165
*CTL05B:                                                           0165
*   IF(GTFSYSM='1'B                 /* WAS EITHER SYSM         Y02014*/
*       ×GTFSYS='1'B)               /* OR SYS SPECIFIED        Y02014*/
*     THEN                          /* YES, SO SET IMPLIED OPTIONS 0165
*                                                              Y02014*/
CTL05B   L     @14,INITPTR(,PCTPTR)                                0165
         TM    GTFSYSM(@14),B'10100000'                            0165
         BZ    @RF00165                                            0165
*     DO;                                                          0166
*       GTFSIO='1'B;                /* SET SIO                 Y02014*/
*       GTFIO='1'B;                 /* SET IO                  Y02014*/
*       GTFSVC='1'B;                /* SET SVC                 Y02014*/
*       GTFPI='1'B;                 /* SET PI                  Y02014*/
         OI    GTFSIO(@14),B'10101010'                             0170
*       GTFRR='1'B;                 /* SET RR                  Y02014*/
*       GTFEXT='1'B;                /* SET EXT                 Y02014*/
         OI    GTFRR(@14),B'10010000'                              0172
*     END;                                                         0173
*   IF GTFSYSP='1'B THEN            /* SYSP BIT ON             Y02014*/
@RF00165 L     @14,INITPTR(,PCTPTR)                                0174
         TM    GTFSYSP(@14),B'01000000'                            0174
         BNO   @RF00174                                            0174
*     DO;                                                          0175
*       GTFRR='1'B;                 /* SET RR                  Y02014*/
*       GTFEXT='1'B;                /* SET EXT                 Y02014*/
         OI    GTFRR(@14),B'10010000'                              0177
*     END;                                                         0178
*                                                                  0179
*/********************************************************************/
*/*                                                                  */
*/*          CLOSE PARMLIB, IF OPEN, AND RETURN TO AHLSCAN           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0179
*CTL05:                                                            0179
*   IF(DCBOFLGS&'10'X)=0            /* TEST FOR OPEN PARMLIB         */
*     THEN                          /* PARMLIB NOT OPEN              */
@RF00174 DS    0H                                                  0179
CTL05    LA    @14,16                                              0179
         SLR   @06,@06                                             0179
         IC    @06,DCBOFLGS(,DCBPTR)                               0179
         NR    @14,@06                                             0179
         LTR   @14,@14                                             0179
         BZ    @RT00179                                            0179
*     GO TO CTL05A;                 /* EXIT                          */
*   DCBPTR=ADDR(DCBFORM);           /* SET PTR TO DCB                */
         LA    DCBPTR,DCBFORM                                      0181
*   CLOSPLST=CLOSLST2;              /* PLACE CLOSE PARMLIST INTO   0182
*                                      GOTTEN CORE                   */
         MVC   CLOSPLST(4),CLOSLST2                                0182
*   PARMRG1=ADDR(CLOSPLST);         /* SET R1 = @CLOSE PLIST   Y02014*/
         LA    PARMRG1,CLOSPLST                                    0183
*/********************************************************************/
*/*                                                                  */
*/*                          CLOSE PARMLIB                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0184
*   GENERATE;                                                      0184
*                                   /* CLOSE PARMLIB DCB             */
           CLOSE ((DCBPTR)),MF=(E,(1))
*CTL05A:                                                           0185
*   RTRNCODE=0;                     /* SET RC FOR AHLSCAN --       0185
*                                      SUCCESSFUL COMPLETION   Y02014*/
CTL05A   SLR   RTRNCODE,RTRNCODE                                   0185
*CTL06:                                                            0186
*   GPRS15=RTRNCODE;                /* RETURN CODE TO R15 SAVE M1402 */
CTL06    L     @14,CALLRSA1(,SAVR)                                 0186
         ST    RTRNCODE,GPRS15(,@14)                               0186
*   RETURN;                         /* RETURN TO AHLSCAN       Y02014*/
@EL00001 L     @13,4(,@13)                                         0187
@EF00001 DS    0H                                                  0187
@ER00001 LM    @14,@12,12(@13)                                     0187
         BR    @14                                                 0187
*                                                                  0188
*/********************************************************************/
*/*                                                                  */
*/*              RESET FOR TRACE OPTION RESPECIFICATION              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0188
*CTL07:                                                            0188
*   DCBPTR=ADDR(DCBFORM);           /* SET PTR TO DCB                */
CTL07    LA    DCBPTR,DCBFORM                                      0188
*/********************************************************************/
*/*                                                                  */
*/*                      TEST FOR PARMLIB OPEN                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0189
*   IF(DCBOFLGS&'10'X)=0            /* TEST FOR OPEN PARMLIB         */
*     THEN                          /* PARMLIB NOT OPEN              */
         LA    @14,16                                              0189
         SLR   @06,@06                                             0189
         IC    @06,DCBOFLGS(,DCBPTR)                               0189
         NR    @14,@06                                             0189
         LTR   @14,@14                                             0189
         BZ    @RT00189                                            0189
*     GO TO CTL08;                  /* RESET ICTFLG1                 */
*   CLOSPLST=CLOSLST2;              /* PLACE CLOSE PARMLIST INTO   0191
*                                      GOTTEN CORE                   */
         MVC   CLOSPLST(4),CLOSLST2                                0191
*   PARMRG1=ADDR(CLOSPLST);         /* SET R1 = @CLOSE PLIST   Y02014*/
         LA    PARMRG1,CLOSPLST                                    0192
*/********************************************************************/
*/*                                                                  */
*/*                          CLOSE PARMLIB                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0193
*   GENERATE;                                                      0193
*                                   /* CLOSE PARMLIB DCB             */
           CLOSE ((DCBPTR)),MF=(E,(1))
*CTL08:                                                            0194
*   ICTFLAGS=ICTFLAGS&'0800'X;      /* TURN OFF ALL ICTFLGS EXCEPT 0194
*                                      ICTTRCIN                Y02014*/
CTL08    L     @14,INITPTR(,PCTPTR)                                0194
         LA    @06,2048                                            0194
         LH    @00,ICTFLAGS(,@14)                                  0194
         N     @00,@CF00533                                        0194
         NR    @06,@00                                             0194
         STH   @06,ICTFLAGS(,@14)                                  0194
*/********************************************************************/
*/*                                                                  */
*/*                    TEST FOR SIO EBCDIC TABLE                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0195
*   IF SIOTAB=0                     /* TEST FOR SIO TABLE      Y02014*/
*     THEN                          /* NO SIO TABLE                  */
         L     @06,SIOTAB(,@14)                                    0195
         LTR   @06,@06                                             0195
         BZ    @RT00195                                            0195
*     GO TO CTL10;                  /* TEST FOR IO TABLE             */
*/********************************************************************/
*/*                                                                  */
*/*              TEST FOR SIO AND IO EBCDIC TABLES SAME              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0197
*   IF SIOTAB=IOTAB                 /* TEST FOR SAME TBL       Y02014*/
*     THEN                          /* SAME TBLS                     */
         C     @06,IOTAB(,@14)                                     0197
         BE    @RT00197                                            0197
*     GO TO CTL09;                  /* FREE IO EBCDIC TBL      Y02014*/
*   FREEAD=SIOTAB;                  /* GET TBL ADDR            Y02014*/
         LR    FREEAD,@06                                          0199
*/********************************************************************/
*/*                                                                  */
*/*                    FREE SIO EBCDIC TABLE CORE              Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0200
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */
*     RESPECIFY                                                    0201
*      (GPR01F,                                                    0201
*       GPR00F) RESTRICTED;                                        0201
*     GPR00F=153;                   /* LENGTH REQUESTED              */
         LA    GPR00F,153                                          0202
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */
         LR    GPR01F,FREEAD                                       0203
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0204
*     RESPECIFY                                                    0205
*      (GPR01F,                                                    0205
*       GPR00F) UNRESTRICTED;                                      0205
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)
*                                      FREE SIO EBCDIC TBL Y02014    */
*CTL09:                                                            0207
*   SIOTAB=0;                       /* CLEAR SIOTAB            Y02014*/
CTL09    L     @14,INITPTR(,PCTPTR)                                0207
         SLR   @06,@06                                             0207
         ST    @06,SIOTAB(,@14)                                    0207
*/********************************************************************/
*/*                                                                  */
*/*                    TEST FOR I/O EBCIDC TABLE               Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0208
*CTL10:                                                            0208
*   IF IOTAB=0                      /* TEST FOR IO EBCDIC TBL  Y02014*/
*     THEN                          /* NO IO TBL                     */
CTL10    L     @14,INITPTR(,PCTPTR)                                0208
         L     @14,IOTAB(,@14)                                     0208
         LTR   @14,@14                                             0208
         BZ    @RT00208                                            0208
*     GO TO CTL11;                  /* TEST FOR PI TBL               */
*   FREEAD=IOTAB;                   /* GET TABLE ADDRESS       Y02014*/
         LR    FREEAD,@14                                          0210
*/********************************************************************/
*/*                                                                  */
*/*                    FREE I/O EBCDIC TABLE CORE              Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0211
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */
*     RESPECIFY                                                    0212
*      (GPR01F,                                                    0212
*       GPR00F) RESTRICTED;                                        0212
*     GPR00F=153;                   /* LENGTH REQUESTED              */
         LA    GPR00F,153                                          0213
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */
         LR    GPR01F,FREEAD                                       0214
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0215
*     RESPECIFY                                                    0216
*      (GPR01F,                                                    0216
*       GPR00F) UNRESTRICTED;                                      0216
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)
*                                      FREE IO EBCDIC TBL Y02014     */
*   IOTAB=0;                        /* CLEAR GTFIOFT           Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0218
         SLR   @06,@06                                             0218
         ST    @06,IOTAB(,@14)                                     0218
*/********************************************************************/
*/*                                                                  */
*/*                    TEST FOR PI EBCDIC TABLE                Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0219
*CTL11:                                                            0219
*   IF PITAB=0                      /* TEST FOR PI TBL         Y02014*/
*     THEN                          /* NO PI EBCDIC TBL              */
CTL11    L     @14,INITPTR(,PCTPTR)                                0219
         L     @14,PITAB(,@14)                                     0219
         LTR   @14,@14                                             0219
         BZ    @RT00219                                            0219
*     GO TO CTL12;                  /* TEST FOR SVC TBL              */
*   FREEAD=PITAB;                   /* GET TBL ADDR            Y02014*/
         LR    FREEAD,@14                                          0221
*/********************************************************************/
*/*                                                                  */
*/*                    FREE PI EBCDIC TABLE CORE               Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0222
*   DO;                             /* FREEMAIN(R) LV(60)A(FREETB)   */
*     RESPECIFY                                                    0223
*      (GPR01F,                                                    0223
*       GPR00F) RESTRICTED;                                        0223
*     GPR00F=60;                    /* LENGTH REQUESTED              */
         LA    GPR00F,60                                           0224
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */
         LR    GPR01F,FREEAD                                       0225
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0226
*     RESPECIFY                                                    0227
*      (GPR01F,                                                    0227
*       GPR00F) UNRESTRICTED;                                      0227
*   END;                            /* FREEMAIN(R) LV(60)A(FREETB) 0228
*                                      FREE PI EBCDIC TBL Y02014     */
*   PITAB=0;                        /* CLEAR PITAB             Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0229
         SLR   @06,@06                                             0229
         ST    @06,PITAB(,@14)                                     0229
*/********************************************************************/
*/*                                                                  */
*/*                    TEST FOR SVC EBCDIC TABLE               Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0230
*CTL12:                                                            0230
*   IF SVCTAB=0                     /* TEST FOR SVC TABLE      Y02014*/
*     THEN                          /* NO SVC EBCDIC TBL             */
CTL12    L     @14,INITPTR(,PCTPTR)                                0230
         L     @14,SVCTAB(,@14)                                    0230
         LTR   @14,@14                                             0230
         BZ    @RT00230                                            0230
*     GO TO CTL13;                  /* CLEAR LOADBYTS                */
*   FREEAD=SVCTAB;                  /* GET TABLE ADDR          Y02014*/
         LR    FREEAD,@14                                          0232
*/********************************************************************/
*/*                                                                  */
*/*                    FREE SVC EBCDIC TABLE CORE              Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0233
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */
*     RESPECIFY                                                    0234
*      (GPR01F,                                                    0234
*       GPR00F) RESTRICTED;                                        0234
*     GPR00F=153;                   /* LENGTH REQUESTED              */
         LA    GPR00F,153                                          0235
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */
         LR    GPR01F,FREEAD                                       0236
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0237
*     RESPECIFY                                                    0238
*      (GPR01F,                                                    0238
*       GPR00F) UNRESTRICTED;                                      0238
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)
*                                      FREE SVC EBCDIC TBL Y02014    */
*   SVCTAB=0;                       /* CLEAR SVCTAB            Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0240
         SLR   @06,@06                                             0240
         ST    @06,SVCTAB(,@14)                                    0240
*/********************************************************************/
*/*                                                                  */
*/*                         CLEAR INDICATORS                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0241
*CTL13:                                                            0241
*   GTFOPIND(1:3)=ZEROWD(1:3);      /* CLEAR GTFOPIND          Y02014*/
CTL13    L     @14,INITPTR(,PCTPTR)                                0241
         MVC   GTFOPIND(3,@14),ZEROWD                              0241
*   GTFOPTS(1:3)=ZEROWD(1:3);       /* CLEAR GTFOPTS           Y02014*/
         MVC   GTFOPTS(3,PCTPTR),ZEROWD                            0242
*   PCTCATF=0;                      /* CLEAR PCTCATF           Y02014*/
         SLR   @14,@14                                             0243
         ST    @14,PCTCATF(,PCTPTR)                                0243
*   GO TO CTL03;                    /* TO AHLTSCN FOR RETRY          */
         B     CTL03                                               0244
*                                                                  0245
*/********************************************************************/
*/*                                                                  */
*/*                  DECLARE SYSTEM PARAMETER LISTS                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0245
*   GENERATE;                                                      0245
*                                   /* GENERATE PARMLISTS            */
           DS    0F
STAELST1   STAE  CTLSTEX,CT,PARAM=0,MF=L    /* STAE PARMLIST         */
           DS    0F
OPENLST1   OPEN  (0,(INPUT)),MF=L           /* OPEN PARMLIST         */
           DS    0F
CLOSLST1   CLOSE (0),MF=L                   /* CLOSE PARMLIST        */
*      PARMLIB DATA CONTROL BLOCK
DCBFORM  DCB  MACRF=(GM),LRECL=80,DDNAME=SYSLIB,DSORG=PS         Y02014
*                                                                  0246
*/********************************************************************/
*/*                                                                  */
*/*                        STAE RETRY ROUTINE                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0246
*CTLRETRY:                                                         0246
*   RFY                                                            0246
*    (MSGPTR,                                                      0246
*     TRTBLAD) RSTD;                /* RESTRICT 7,8            Y02014*/
CTLRETRY DS    0H                                                  0247
*   RTRNCODE=CMPCD;                 /* SET R15 = COMP CODE           */
         L     RTRNCODE,CMPCD(,EXPLAD)                             0247
*/********************************************************************/
*/*                                                                  */
*/*                      ADJUST COMPLETION CODE                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0248
*   GENERATE;                                                      0248
*                                                                  0248
           LA    RTRNCODE,0(RTRNCODE)          CLEAR HIGH-ORDER BYTE
           SRL   RTRNCODE,12                   SHIFT SYSTEM CODE TO LOW
*                                              ORDER BYTES
*/********************************************************************/
*/*                                                                  */
*/*            TEST FOR MEMBER NOT FOUND ABEND FROM OPEN             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0249
*   IF RTRNCODE=NOMEMBR             /* TEST FOR MEMBER NOT FOUND     */
*     THEN                          /* MEMBER NOT FOUND- 013         */
         C     RTRNCODE,NOMEMBR                                    0249
         BE    @RT00249                                            0249
*     GO TO CTL14;                  /* ISSUE MSG AHL123I             */
*/********************************************************************/
*/*                                                                  */
*/*             OTHER ABEND IN OPEN--CONVERT COMPLETION              */
*/*                  CODE, ISSUE MESSAGE AND RETRY                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0251
*   GEN(SLL RTRNCODE,16);           /* SET RC FOR CONVERSION   YM1407*/
         SLL RTRNCODE,16
*   CMPCD=RTRNCODE;                 /* RESTORE RTRNOCDE              */
         ST    RTRNCODE,CMPCD(,EXPLAD)                             0252
*   ICTMSGX=29;                     /* SET NDX FOR MSG AHL131I -ABEND
*                                      IN OPEN-NOT 013               */
         L     @14,INITPTR(,PCTPTR)                                0253
         MVI   ICTMSGX(@14),X'1D'                                  0253
*   CALL AHLCTL2;                   /* GET MSG                       */
         BAL   @14,AHLCTL2                                         0254
*   EXPLAD=ADDR(CMPCD);             /* SET PTR TO CODE               */
         LA    @14,CMPCD(,EXPLAD)                                  0255
         LR    EXPLAD,@14                                          0255
*   MSGPTR=ADDR(MSGCODE);           /* SET PTR TO MSG AREA           */
         L     @14,INITPTR(,PCTPTR)                                0256
         LA    MSGPTR,MSGCODE(,@14)                                0256
*   TRTBLAD=ADDR(TRTBL);            /* GET @ CNVT TBL                */
         LA    TRTBLAD,TRTBL                                       0257
*   TWTWORK(1:4)=RTDCD;             /* SAVE ROUT/DESC CODES          */
         MVC   TWTWORK(4,@14),RTDCD(@14)                           0258
*/********************************************************************/
*/*                                                                  */
*/*                     CONVERT COMPLETION CODE                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0259
*   GENERATE;                                                      0259
*                                   /* CONVERT COMP CODE             */
           UNPK  0(4,MSGPTR),0(3,EXPLAD)
           TR    0(3,MSGPTR),0(TRTBLAD)
*   RTDCD=TWTWORK(1:4);             /* REPLACE ROUT/DESC CODE        */
         L     @14,INITPTR(,PCTPTR)                                0260
         MVC   RTDCD(4,@14),TWTWORK(@14)                           0260
*   ICTMSGX='FF'X;                  /* SET IND FOR MSG IN BUF        */
         MVI   ICTMSGX(@14),X'FF'                                  0261
*   RFY                                                            0262
*    (MSGPTR,                                                      0262
*     TRTBLAD) UNRSTD;              /* UNRESTRICT 7,8          Y02014*/
*   GO TO CTL01;                    /* ISSUE MSG                     */
         B     CTL01                                               0263
*/********************************************************************/
*/*                                                                  */
*/*                MEMBER NOT FOUND ABEND--PLACE NAME                */
*/*               IN MESSAGE, ISSUE MESSAGE, AND RETRY               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0264
*CTL14:                                                            0264
*   ICTMSGX=21;                     /* SET IND FOR AHL123I           */
CTL14    L     @14,INITPTR(,PCTPTR)                                0264
         MVI   ICTMSGX(@14),X'15'                                  0264
*   TWTWORK(1:8)=JFCBELNM;          /* SAVE MEMBER NAME              */
         MVC   TWTWORK(8,@14),JFCBELNM(@14)                        0265
*   CALL AHLCTL2;                   /* GET MSG                       */
         BAL   @14,AHLCTL2                                         0266
*   MSGMEMBR=TWTWORK(1:8);          /* PUT MEMBR NAME IN MSG         */
         L     @14,INITPTR(,PCTPTR)                                0267
         MVC   MSGMEMBR(8,@14),TWTWORK(@14)                        0267
*   ICTMSGX='FF'X;                  /* SET MSG IND                   */
         MVI   ICTMSGX(@14),X'FF'                                  0268
*   RFY                                                            0269
*    (MSGPTR,                                                      0269
*     TRTBLAD) UNRSTD;              /* UNRESTRICT 7,8          Y02014*/
*   GO TO CTL01;                    /* ISSUE MSG                     */
         B     CTL01                                               0270
*                                                                  0271
*/********************************************************************/
*/*                                                                  */
*/*         DEFINE TRANSLATE TABLE AND STAE EXIT ROUTINE CODE        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0271
*   GENERATE;                                                      0271
*                                   /* DEFINE TBL AND CODE           */
RTRYRT     LM    R0,R15,8(R15)              /* RESTORE REGS 0-15     */
           BCR   15,R15                     /* TO EXIT ROUTINE       */
           DC    C'0123456789ABCDEF'        /* TRANSLATE TABLE       */
           ORG   *-256                      /* RELOCATE TABLE START  */
TRTBL      DS    0C                         /* TABLE LABLE           */
           ORG
*                                                                  0272
*/********************************************************************/
*/*                                                                  */
*/*            STAE EXIT ROUTINE--PLACE COMPLETION CODE IN           */
*/*           STAE PARMLIST IN TWTWORK AND RETURN FOR RETRY          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0272
*CTLSTEX:                                                          0272
*   GENERATE;                                                      0272
*                                                                  0272
CTLSTEX  DS    0H                                                  0272
         ST    14,12(0,13)                                       Y02014
         STM   0,12,20(13)                                       Y02014
         BALR  12,0                                              Y02014
CTLSEXEP LA    15,CTLSEXEP-@PSTART                               Y02014
         SR    12,15                                             Y02014
         ST    13,SAV3AREA+4                                     Y02014
         LA    15,SAV3AREA                                       Y02014
         ST    15,8(0,13)                                        Y02014
         LR    13,15                                             Y02014
*/********************************************************************/
*/*                                                                  */
*/*                    TEST FOR NO STAE WORK AREA                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0273
*   RFY                                                            0273
*     R0 RSTD;                      /* RESTRICT REG 0          Y02014*/
*   IF R0=12                        /* TEST FOR STAE WORKAREA        */
*     THEN                          /* NO WORK AREA                  */
         C     R0,@CF00308                                         0274
         BE    @RT00274                                            0274
*     GO TO CTL15;                  /* GET PL@ FROM R2               */
*   EXPLAD=PARMAD;                  /* GET ADDR STAE PARMLIST FROM 0276
*                                      1ST WD-STAE WORK              */
         L     EXPLAD,PARMAD(,PARMRG1)                             0276
*   CMPCD=ABNDCC;                   /* COMP CODE TO STAE PARM LIST 0277
*                                      (IN TWTWORK)                  */
         L     @14,ABNDCC(,PARMRG1)                                0277
         ST    @14,CMPCD(,EXPLAD)                                  0277
*   GO TO CTL16;                    /* SET RETRY ADDR                */
         B     CTL16                                               0278
*CTL15:                                                            0279
*   EXPLAD=EXPLAD1;                 /* RESET REGISTER 3        Y02014*/
CTL15    L     EXPLAD,EXPLAD1                                      0279
*   CMPCD=PARMRG1;                  /* COMP CODE TO STAE PARM LIST 0280
*                                      (IN TWTWORK)            Y02014*/
         ST    PARMRG1,CMPCD(,EXPLAD)                              0280
*CTL16:                                                            0281
*   GPRS0=SAVARAD;                  /* SET R0=@ RETRY ROUT IN SAVE 0281
*                                      AREA                    Y02014*/
CTL16    L     @14,CALLRSA1(,SAVR)                                 0281
         L     @06,SAVARAD(,EXPLAD)                                0281
         ST    @06,GPRS0(,@14)                                     0281
*   GPRS15=4;                       /* SET RETURN CODE FOR RETRY WITH
*                                      PURGE                   Y02014*/
         MVC   GPRS15(4,@14),@CF00060                              0282
*   RFY                                                            0283
*     R0 UNRSTD;                    /* UNRESTRICT REG 0        Y02014*/
*   RETURN;                         /* RETURN TO STAE          Y02014*/
         B     @EL00001                                            0284
*                                                                  0285
*/********************************************************************/
*/*                                                                  */
*/*                           I/O ROUTINE                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0285
*AHLTIO:                                                           0285
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* DEFINE PROC OPTIONS   Y02014*/
AHLTIO   DS    0H                                                  0286
*   GENERATE;                                                      0286
*                                                                  0286
         ST   14,12(0,13)                                        Y02014
         STM  0,12,20(13)                                        Y02014
         BALR 12,0                                               Y02014
AHLTIOE  LA   15,AHLTIOE-@PSTART                                 Y02014
         SR   12,15                                              Y02014
         ST   13,SAV1AREA+4                                      Y02014
         LA   15,SAV1AREA                                        Y02014
         ST   15,8(0,13)                                         Y02014
         LR   13,15                                              Y02014
*/********************************************************************/
*/*                                                                  */
*/*                        REGISTER VARIABLES                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0287
*   DECLARE                         /* PTR TO INPUT BUFFER           */
*     AREAPTR PTR(31) REG(0);                                      0287
*                                                                  0288
*/********************************************************************/
*/*                                                                  */
*/*                  DEFINE MISCELLANEOUS VARIABLES                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0288
*   DECLARE                         /* ROUTINE LABELS FOR            */
*    (IO01,                         /* BRANCH TABLE                  */
*     IO02,                                                        0288
*     IO03,                                                        0288
*     IO04) LABEL;                                                 0288
*   DECLARE                         /* BRANCH TABLE                  */
*     IOROUT(4) PTR(31) INIT(ADDR(IO01),/* WTOR ROUTINE        Y02014*/
*         ADDR(IO02),               /* WTO ROUTINE                   */
*         ADDR(IO03),               /* READ PARMLIB ROUTINE          */
*         ADDR(IO04));              /* WTP ROUTINE             Y02014*/
*   DECLARE                         /* CONSTANT FOR COMPUTING        */
*     LISTLEN PTR(15) INIT(3);      /* MESSAGE LENGTH                */
*   DECLARE                         /* WTOR REPLY LENGTH             */
*     MAXRPLY PTR(15) INIT(123);                                   0291
*   DECLARE                         /* ECB ADDR IN WTOR              */
*     ECBAD PTR(31)                 /* PARMLIST                      */
*         DEFINED(TWTBUF) POSITION(5);/*                       Y02014*/
*   DECLARE                         /* WTOR REPLY ADDR IN            */
*     RPLYAD PTR(24)                /* WTOR PARMLIST                 */
*         DEFINED(TWTBUF) POSITION(2);/*                       Y02014*/
*   DECLARE                         /* WTOR REPLY LENGTH IN          */
*     RPLYLEN PTR(8)                /* WTOR PARMLIST                 */
*         DEFINED(TWTBUF);          /*                         Y02014*/
*   DECLARE                         /* MESSAGE AREA            Y02014*/
*     WTOMSG CHAR(123)              /*                         Y02014*/
*         DEFINED(TWTBUF) POSITION(5);/*                       Y02014*/
*   DECLARE                         /* WTO LENGTH IN WTO             */
*     WTOLEN PTR(15)                /* PARMLIST                      */
*         DEFINED(TWTBUF);          /*                         Y02014*/
*   DECLARE                         /* MESSAGE AREA            Y02014*/
*     WTORMSG CHAR(75)              /*                         Y02014*/
*         DEFINED(TWTBUF) POSITION(13);/*                      Y02014*/
*   DECLARE                         /*                         Y02014*/
*     MSGHOLD CHAR(75);             /* HOLDS WTOR TEXT         Y02014*/
*   DECLARE                         /* WTOR LENGTH IN WTOR           */
*     WTORLEN PTR(15)               /* PARMLIST                      */
*         DEFINED(TWTBUF) POSITION(9);/*                       Y02014*/
*   DECLARE                                                        0300
*     AHL127RC CHAR(4) DEFINED(TWTBUF) POSITION(37);/* AHL127I     0300
*                                      ROUTING CODES           Y02014*/
*   DECLARE                                                        0301
*     A127RCHD CHAR(4) DEFINED(TWTBUF) POSITION(71);/* NEW ROUTING CD
*                                      POSITION                Y02014*/
*   DECLARE                         /* SAVE MSG LENGTH         Y02014*/
*     SLENMSG PTR(31);                                             0302
*   DECLARE                         /* SAVE MSG ADDRESS        Y02014*/
*     SMSGPTR PTR(31);                                             0303
*   DECLARE                         /* SAVE MESSAGE TO BE WRITTEN    */
*     MSG CHAR(123) BASED(SMSGPTR) POSITION(13);/*             Y02014*/
*                                                                  0305
*/********************************************************************/
*/*                                                                  */
*/*                         BEGIN I/O ROUTINE                        */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                                                                  */
*/*            TEST FOR MESSAGE PREVIOUSLY PLACED IN BUFFER          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0305
*   IF ICTMSGX='FF'X                /* TEST FOR MSG IN BUFF          */
*     THEN                          /* MSG ALREADY IN BUFFER         */
         L     @14,INITPTR(,PCTPTR)                                0305
         CLI   ICTMSGX(@14),255                                    0305
         BE    @RT00305                                            0305
*     GO TO IO00;                   /* TO I/O ROUTINE                */
*   TWTBUF(1:152)='';               /* CLEAR TWTBUF            Y02014*/
         MVI   TWTBUF(@14),C' '                                    0307
         MVC   TWTBUF+1(151,@14),TWTBUF(@14)                       0307
*   CALL AHLCTL2;                   /* GET MSG                       */
         BAL   @14,AHLCTL2                                         0308
*IO00:                                                             0309
*   GO TO IOROUT(ICTIOTYP);         /* TO I/O ROUTINE                */
IO00     L     @14,INITPTR(,PCTPTR)                                0309
         SLR   @06,@06                                             0309
         IC    @06,ICTIOTYP(,@14)                                  0309
         SLA   @06,2                                               0309
         L     @14,IOROUT-4(@06)                                   0309
         BR    @14                                                 0309
*                                                                  0310
*/********************************************************************/
*/*                                                                  */
*/*                           WTOR ROUTINE                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0310
*IO01:                                                             0310
*   MSGREPLY(1:124)='';             /* CLEAR REPLY BUFFER      Y02014*/
IO01     L     @14,INITPTR(,PCTPTR)                                0310
         MVI   MSGREPLY(@14),C' '                                  0310
         MVC   MSGREPLY+1(123,@14),MSGREPLY(@14)                   0310
*   WTORECB=0;                      /* CLEAR ECB               Y02014*/
         SLR   @06,@06                                             0311
         ST    @06,WTORECB(,@14)                                   0311
*   ECBAD=ADDR(WTORECB);            /* PUT ADDR OF ECB IN GTFPCT INTO
*                                      THE WTOR PARMLIST       Y02014*/
         LA    @06,WTORECB(,@14)                                   0312
         ST    @06,ECBAD(,@14)                                     0312
*   RPLYAD=ADDR(MSGREPLY);          /* PUT ADDR OF REPLY AREA IN   0313
*                                      INITDATA INTO WTOR PLIST    0313
*                                                              Y02014*/
         LA    @06,MSGREPLY(,@14)                                  0313
         STCM  @06,7,RPLYAD(@14)                                   0313
*/********************************************************************/
*/*                                                                  */
*/*                     WRITE TO OPERATOR WITH REPLY                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0314
*   DO;                             /* WTORP MF(E,TWTBUF)            */
*     RFY                                                          0315
*       GPR01P RSTD;                /* RESTRICT REG 1                */
*     GPR01P=ADDR(TWTBUF);          /* ADDRESS CONTROL PROGRAM LIST  */
         LA    GPR01P,TWTBUF(,@14)                                 0316
*     SVC(35);                      /* ISSUE WTOR SVC                */
         SVC   35                                                  0317
*     RFY                                                          0318
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */
*   END;                            /* WTORP MF(E,TWTBUF) WTOR Y02014*/
*   DO;                             /* WAIT (1) ECBLIST(ECBLST)      */
*     RESPECIFY                                                    0321
*      (GPR00P,                                                    0321
*       GPR01P) RESTRICTED;                                        0321
*     GPR00P=1;                     /* LOAD WAIT COUNT               */
         LA    GPR00P,1                                            0322
*     GPR01P=-ADDR(ECBLST);         /* ADDRESS OF LIST OF ECB'S      */
         LA    GPR01P,ECBLST                                       0323
         LCR   GPR01P,GPR01P                                       0323
*     SVC(1);                       /* WAIT SVC                      */
         SVC   1                                                   0324
*     RESPECIFY                                                    0325
*      (GPR00P,                                                    0325
*       GPR01P) UNRESTRICTED;                                      0325
*   END;                            /* WAIT (1) ECBLIST(ECBLST) WAIT
*                                      ON WTOR AND STOP Y02014       */
*/********************************************************************/
*/*                                                                  */
*/*                     TEST FOR STOP ECB POSTED                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0327
*   IF POSTBIT='1'B                 /* TEST FOR STOP ECB POST        */
*     THEN                          /* STOP ECB POSTED               */
         L     @14,STOPECBA(,PCTPTR)                               0327
         TM    POSTBIT(@14),B'01000000'                            0327
         BNO   @RF00327                                            0327
*     DO;                                                          0328
*       ICTSTOP='1'B;               /* SET IND IN ICT                */
         L     @14,INITPTR(,PCTPTR)                                0329
         OI    ICTSTOP(@14),B'00000100'                            0329
*       GO TO IO12;                 /* RETURN TO CALLER        Y02014*/
         B     IO12                                                0330
*     END;                                                         0331
*                                                                  0331
*/********************************************************************/
*/*                                                                  */
*/*                   'OR' REPLY AREA WITH BLANKS                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0332
*   DO MSGPTRVR=124 TO 1            /* OR REPLY AREA WITH            */
*         BY-1;                                                    0332
@RF00327 LA    MSGPTRVR,124                                        0332
@DL00332 DS    0H                                                  0333
*     MSGREPLY(MSGPTRVR)=           /* BLANKS FOR ALL CAPITAL  Y02014*/
*         MSGREPLY(MSGPTRVR)×       /* LETTERS                 Y02014*/
*         BLANK(1);                                                0333
         L     @14,INITPTR(,PCTPTR)                                0333
         ALR   @14,MSGPTRVR                                        0333
         OC    MSGREPLY-1(1,@14),BLANK                             0333
*   END;                            /*                         Y02014*/
         BCTR  MSGPTRVR,0                                          0334
         LTR   MSGPTRVR,MSGPTRVR                                   0334
         BP    @DL00332                                            0334
*   ICTMSGX=30;                     /* SET UP FOR WRITING REPLY TO 0335
*                                      PROGRAMMER              Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0335
         MVI   ICTMSGX(@14),X'1E'                                  0335
*   TWTBUF(1:152)='';               /* CLEAR TWTBUF            Y02014*/
         MVI   TWTBUF(@14),C' '                                    0336
         MVC   TWTBUF+1(151,@14),TWTBUF(@14)                       0336
*   CALL AHLCTL2;                   /* GET MESSAGE             Y02014*/
         BAL   @14,AHLCTL2                                         0337
*   WTOMSG=MSGREPLY;                /* PLACE REPLY IN PARMLIST Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0338
         MVC   WTOMSG(123,@14),MSGREPLY(@14)                       0338
*                                                                  0339
*/********************************************************************/
*/*                                                                  */
*/*                           WTO ROUTINE                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0339
*IO02:                                                             0339
*                                                                  0339
*/********************************************************************/
*/*                                                                  */
*/*                           WRITE TO OPERATOR AND PROGRAMMER Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0339
*   DO;                             /* WTOP MF(E,TWTBUF)             */
IO02     DS    0H                                                  0340
*     RFY                                                          0340
*       GPR01P RSTD;                /* RESTRICT REG 1                */
*     GPR01P=ADDR(TWTBUF);          /* ADDRESS CONTROL PROGRAM LIST  */
         L     GPR01P,INITPTR(,PCTPTR)                             0341
         LA    GPR01P,TWTBUF(,GPR01P)                              0341
*     SVC(35);                      /* ISSUE WTO SVC                 */
         SVC   35                                                  0342
*     RFY                                                          0343
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */
*   END;                            /* WTOP MF(E,TWTBUF) WTO Y02014  */
*   GO TO IO12;                     /* RETURN                  Y02014*/
         B     IO12                                                0345
*                                                                  0346
*/********************************************************************/
*/*                                                                  */
*/*                       READ PARMLIB ROUTINE                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0346
*IO03:                                                             0346
*   DCBPTR=PARMDCB;                 /* GET @DCB FOR GET        Y02014*/
IO03     L     @14,INITPTR(,PCTPTR)                                0346
         L     DCBPTR,PARMDCB(,@14)                                0346
*   GEN;                                                           0347
*                                   /* SET SYNAD ROUT ADDR   @ZA09667*/
         LA    @06,IO10                                         ZA09667
         STCM  @06,7,DCBSYNAD+1(DCBPTR)                         ZA09667
*   DCBEODAD=ADDR(IO11);            /* SET ADDR FOR EOD              */
         LA    @14,IO11                                            0348
         ST    @14,DCBEODAD(,DCBPTR)                               0348
*   MSGREPLY(1:124)='';             /* CLEAR BUFFER            Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0349
         MVI   MSGREPLY(@14),C' '                                  0349
         MVC   MSGREPLY+1(123,@14),MSGREPLY(@14)                   0349
*   AREAPTR=ADDR(MSGREPLY);         /* SET INPUT BUFF PTR            */
         LA    AREAPTR,MSGREPLY(,@14)                              0350
*   GENERATE(GET (DCBPTR));         /* READ PARMLIB                  */
         GET (DCBPTR)
*   ICTMSGX=30;                     /* SET UP FOR WRITING MSG TO   0352
*                                      PROGRAMMER              Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0352
         MVI   ICTMSGX(@14),X'1E'                                  0352
*   TWTBUF='';                      /* CLEAR BUFFER            Y02014*/
         MVI   TWTBUF(@14),C' '                                    0353
         MVC   TWTBUF+1(151,@14),TWTBUF(@14)                       0353
*   CALL AHLCTL2;                   /* GET MESSAGE             Y02014*/
         BAL   @14,AHLCTL2                                         0354
*   WTOMSG=MSGREPLY;                /* MOVE RECORD TO PARMLIST Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0355
         MVC   WTOMSG(123,@14),MSGREPLY(@14)                       0355
*   GOTO IO02;                      /* GO PERFORM WTP          Y02014*/
         B     IO02                                                0356
*                                                                  0357
*/********************************************************************/
*/*                     WTP ROUTINE                                  */
*/********************************************************************/
*                                                                  0357
*IO04:                                                             0357
*   IF ICTMSGX='FF'X THEN           /* MESSAGE IN BUFFER       Y02014*/
IO04     L     @14,INITPTR(,PCTPTR)                                0357
         CLI   ICTMSGX(@14),255                                    0357
         BNE   @RF00357                                            0357
*     DO;                           /* YES                     Y02014*/
*       SLENMSG=WTORLEN-4;          /* ACTUAL TEXT LENGTH      Y02014*/
         LH    SLENMSG,WTORLEN(,@14)                               0359
         SL    SLENMSG,@CF00060                                    0359
*       MSGHOLD(1:SLENMSG)=WTORMSG(1:SLENMSG);/* SAVE TEXT     Y02014*/
         LR    @09,SLENMSG                                         0360
         BCTR  @09,0                                               0360
         EX    @09,@SM00535                                        0360
*       ICTMSGX=30;                 /* WTO PARMLIST NEEDED     Y02014*/
         MVI   ICTMSGX(@14),X'1E'                                  0361
*       TWTBUF(1:152)='';           /* CLEAR BUFFER            Y02014*/
         MVI   TWTBUF(@14),C' '                                    0362
         MVC   TWTBUF+1(151,@14),TWTBUF(@14)                       0362
*       CALL AHLCTL2;               /* OBTAIN PARMLIST         Y02014*/
         BAL   @14,AHLCTL2                                         0363
*       WTOMSG(1:SLENMSG)=MSGHOLD(1:SLENMSG);/* RESTORE TEXT   Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0364
         LR    @09,SLENMSG                                         0364
         BCTR  @09,0                                               0364
         EX    @09,@SM00537                                        0364
*       GOTO IO02;                  /* GO ISSUE WTO            Y02014*/
         B     IO02                                                0365
*     END;                                                         0366
*   SLENMSG=AHLLEN(ICTMSGX)-16;     /* LNG OF MESSAGE          Y02014*/
@RF00357 L     @14,MSGTBLAD                                        0367
         L     @11,INITPTR(,PCTPTR)                                0367
         SLR   @06,@06                                             0367
         IC    @06,ICTMSGX(,@11)                                   0367
         SLA   @06,2                                               0367
         LA    @09,0(@06,@14)                                      0367
         AL    @09,@CF00539                                        0367
         SLR   SLENMSG,SLENMSG                                     0367
         IC    SLENMSG,AHLLEN(,@09)                                0367
         SL    SLENMSG,@CF00232                                    0367
*   SMSGPTR=AHLAD(ICTMSGX);         /* ADDRESS OF MSG          Y02014*/
         AL    @14,@CF00539                                        0368
         L     SMSGPTR,AHLAD-1(@06,@14)                            0368
         LA    SMSGPTR,0(,SMSGPTR)                                 0368
*   ICTMSGX=30;                     /* OBTAIN WTO PARM LST     Y02014*/
         MVI   ICTMSGX(@11),X'1E'                                  0369
*   TWTBUF(1:152)='';               /* CLEAR BUFFER            Y02014*/
         MVI   TWTBUF(@11),C' '                                    0370
         MVC   TWTBUF+1(151,@11),TWTBUF(@11)                       0370
*   CALL AHLCTL2;                   /* GO GET PARM LST         Y02014*/
         BAL   @14,AHLCTL2                                         0371
*   WTOMSG(1:SLENMSG)=MSG(1:SLENMSG);/* MSG TO PARM LST        Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0372
         LR    @11,SLENMSG                                         0372
         BCTR  @11,0                                               0372
         EX    @11,@SM00540                                        0372
*   GOTO IO02;                      /* GO ISSUE WTO            Y02014*/
         B     IO02                                                0373
*                                                                  0374
*/********************************************************************/
*/*                                                                  */
*/*                    PARMLIB READ ERROR ROUTINE                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0374
*IO10:                                                             0374
*   GENERATE;                                                      0374
*                                                                  0374
IO10     DS    0H                                                  0374
*                                   /* ANALYZE I/O ERROR             */
    SYNADAF ACSMETH=QSAM
*/********************************************************************/
*/*                                                                  */
*/*                   SETUP ERROR MESSAGE AHL127I                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0375
*   ICTMSGX=25;                     /* SET INDX FOR AHL127I    Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0375
         MVI   ICTMSGX(@14),X'19'                                  0375
*   CALL AHLCTL2;                   /* GET AHL127I--1ST PART OF MSG
*                                      ONLY                    Y02014*/
         BAL   @14,AHLCTL2                                         0376
*   WTOLEN=WTOLEN+34;               /* UPDATE MSG LNG FOR WTO  Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0377
         LA    @00,34                                              0377
         AH    @00,WTOLEN(,@14)                                    0377
         STH   @00,WTOLEN(,@14)                                    0377
*   A127RCHD=AHL127RC;              /* SAVE ROUTING CD         Y02014*/
         MVC   A127RCHD(4,@14),AHL127RC(@14)                       0378
*   SYNADPTR=PARMRG1;               /* SET PTR TO SYNAD W/A    Y02014*/
         LR    SYNADPTR,PARMRG1                                    0379
*   UNITADR=SYNUAD;                 /* UNIT ADDR TO MSG              */
         MVC   UNITADR(4,@14),SYNUAD(SYNADPTR)                     0380
*   OPERR=SYNOPERR;                 /* OP AND ERR DESC TO MSG        */
         MVC   OPERR(23,@14),SYNOPERR(SYNADPTR)                    0381
*   ACSMETH=SYNAM;                  /* ACCESS METHOD TO MSG          */
         MVC   ACSMETH(6,@14),SYNAM(SYNADPTR)                      0382
*   GENERATE(SYNADRLS);             /* RELEASE SYNAD W/A             */
         SYNADRLS
*   ICTIOTYP=2;                     /* SET I/O TYPE FOR WTO          */
         L     @14,INITPTR(,PCTPTR)                                0384
         MVI   ICTIOTYP(@14),X'02'                                 0384
*   ICTIOERR='1'B;                  /* SET READ ERROR IND            */
         OI    ICTIOERR(@14),B'01000000'                           0385
*   GO TO IO02;                     /* ISSUE MESSAGE                 */
         B     IO02                                                0386
*/********************************************************************/
*/*                                                                  */
*/*                         PARMLIB READ EOD                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0387
*IO11:                                                             0387
*   ICTEOD='1'B;                    /* TURN ON EOD IND               */
IO11     L     @14,INITPTR(,PCTPTR)                                0387
         OI    ICTEOD(@14),B'00100000'                             0387
*IO12:                                                             0388
*   GENERATE;                                                      0388
IO12     DS    0H                                                  0388
         L   13,4(0,13)
         L   14,12(0,13)
         LM  0,12,20(13)
*   END AHLTIO;                     /* END I/O SUBROUTINE            */
@EL00002 DS    0H                                                  0389
@EF00002 DS    0H                                                  0389
@ER00002 BR    @14                                                 0389
*                                                                  0390
*/********************************************************************/
*/*                                                                  */
*/*                 PLACE MESSAGE IN BUFFER ROUTINE                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0390
*AHLCTL2:                                                          0390
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);/* DEFINE PROC OPTIONS   Y02014*/
AHLCTL2  DS    0H                                                  0391
*   GENERATE;                                                      0391
*                                                                  0391
         ST   14,12(0,13)                                        Y02014
         STM  0,12,20(13)                                        Y02014
         BALR 12,0                                               Y02014
AHLCTLE  LA   15,AHLCTLE-@PSTART                                 Y02014
         SR   12,15                                              Y02014
         ST   13,SAV2AREA+4                                      Y02014
         LA   15,SAV2AREA                                        Y02014
         ST   15,8(0,13)                                         Y02014
         LR   13,15                                              Y02014
*/********************************************************************/
*/*                                                                  */
*/*                       MESSAGE, BUFFER AREAS                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0392
*   DECLARE                         /* MSG IN AHLTCTL2               */
*     AHLMSG CHAR(135) BASED(MSGPTRVR);                            0392
*   DECLARE                         /* MSG OUTPUT BUFFER             */
*     MSGAREA CHAR(135) DEFINED(TWTBUF);/* MSG AREA            Y02014*/
*                                                                  0394
*/********************************************************************/
*/*                                                                  */
*/*                           BEGIN CTL2                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0394
*   MSGPTRVR=AHLAD(ICTMSGX);        /* SET PTR TO AHL MSG            */
         L     @14,MSGTBLAD                                        0394
         L     @11,INITPTR(,PCTPTR)                                0394
         SLR   @05,@05                                             0394
         IC    @05,ICTMSGX(,@11)                                   0394
         SLA   @05,2                                               0394
         LA    @04,0(@05,@14)                                      0394
         AL    @04,@CF00539                                        0394
         L     MSGPTRVR,AHLAD-1(,@04)                              0394
         LA    MSGPTRVR,0(,MSGPTRVR)                               0394
*   LENMSG=AHLLEN(ICTMSGX);         /* GET LENGTH OF MSG             */
         AL    @14,@CF00539                                        0395
         SLR   LENMSG,LENMSG                                       0395
         IC    LENMSG,AHLLEN(@05,@14)                              0395
*   MSGAREA(1:LENMSG)=              /* MOVE MSG FROM                 */
*       AHLMSG(1:LENMSG);           /* AHLTCTL2 TO BUFFER            */
         LR    @14,LENMSG                                          0396
         BCTR  @14,0                                               0396
         EX    @14,@SM00544                                        0396
*   GENERATE;                                                      0397
         L    13,4(0,13)
         L    14,12(0,13)
         LM   0,12,20(13)
*   END AHLCTL2;                                                   0398
@EL00003 DS    0H                                                  0398
@EF00003 DS    0H                                                  0398
@ER00003 BR    @14                                                 0398
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                     0399
*     GPR01F FIXED(31) REG(1),                                     0399
*     GPR00P PTR(31) REG(0),                                       0399
*     GPR01P PTR(31) REG(1);                                       0399
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0400
*     I031F FIXED(31) BASED,                                       0400
*     I031P PTR(31) BASED,                                         0400
*     I015F FIXED(15) BASED,                                       0400
*     I015P PTR(15) BASED,                                         0400
*     I008P PTR(8) BASED,                                          0400
*     I001C CHAR(1) BASED;          /* EXPAND MACRO VARIBLES Y02014  */
*   END AHLTCTL1                                                   0401
*                                                                  0401
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */
*/*%INCLUDE SYSLIB  (INITDATA)                                       */
*                                                                  0401
*       ;                                                          0401
@DATA    DS    0H
@SM00535 MVC   MSGHOLD(0),WTORMSG(@14)
@SM00537 MVC   WTOMSG(0,@14),MSGHOLD
@SM00540 MVC   WTOMSG(0,@14),MSG(SMSGPTR)
@SM00544 MVC   MSGAREA(0,@11),AHLMSG(MSGPTRVR)
         DS    0F
@SA00001 DS    18F
         DS    0F
@CF00055 DC    F'1'
@CF00060 DC    F'4'
@CF00308 DC    F'12'
@CF00232 DC    F'16'
@CF00244 DC    F'124'
@CF00539 DC    F'-4'
@CF00533 DC    XL4'0000FFFF'
@CV00388 DC    V(AHLTPMT)
@CV00389 DC    V(AHLTSCN)
@CV00390 DC    V(AHLTTAB)
@CV00391 DC    V(AHLT103)
@CV00398 DC    V(MSGTBL)
@CV00387 DC    V(AHLTCTL2)
         DS    0D
NOMEMBR  DC    XL4'13'
EXPLAD1  DS    A
MSGTBLAD DC    VL4(MSGTBL)
LISTLEN  DC    AL2(3)
MAXRPLY  DC    AL2(123)
@TS00001 DS    CL3
         DS    CL1
SVAREA   DS    CL72
         ORG   SVAREA
RTRYCODE DS    CL6
@NM00011 DS    CL2
REGSAVE  DS    CL64
         ORG   SVAREA+72
ECBLST   DS    CL8
         ORG   ECBLST
WECBAD   DS    AL4
SECBAD   DS    AL4
         ORG   SECBAD
ENDECB   DS    BL1
         ORG   ECBLST+8
CLOSPLST DS    CL4
OPENPLST DS    CL4
STAEPLST DS    CL8
TRCEQ    DC    CL6'TRACE='
PLIBNM   DC    CL12'SYS1.PARMLIB'
ZEROWD   DC    X'00000000'
         ORG   ZEROWD
ZEROCR   DS    CL1
         ORG   ZEROWD+4
BLANK    DC    CL8'        '
MSGHOLD  DS    CL75
CTLPTCH  DS    CL200
         DS    CL3
SAV1AREA DC    18A(0)
SAV2AREA DC    18A(0)
SAV3AREA DC    18A(0)
IOROUT   DC    AL4(IO01)
         DC    AL4(IO02)
         DC    AL4(IO03)
         DC    AL4(IO04)
AHLTCTL1 CSECT
         ENTRY AHLTIO                       /* AHLTIO EXTERNAL Y02014*/
         ENTRY AHLCTL2                     /* AHLCTL2 EXTERNAL Y02014*/
         ENTRY CTLSTEX                     /* STAE RTN         Y02014*/
AHLTCTL1 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SMSGPTR  EQU   @10
SLENMSG  EQU   @08
LENMSG   EQU   @09
MSGPTRVR EQU   @06
SYNADPTR EQU   @06
FREEAD   EQU   @08
R0       EQU   @00
PARMRG1  EQU   @01
EXPLAD   EQU   @03
DCBPTR   EQU   @07
TRTBLAD  EQU   @07
SAVREG   EQU   @08
MSGPTR   EQU   @08
SAVR     EQU   @13
RTRNCODE EQU   @15
RTRYAD   EQU   @15
PCTPTR   EQU   @02
GPR01F   EQU   @01
GPR00F   EQU   @00
AREAPTR  EQU   @00
GPR01P   EQU   @01
GPR00P   EQU   @00
ENTRYREG EQU   @15
R15      EQU   @15
FREETB   EQU   0
GTFPCT   EQU   0
GTFSTAT  EQU   GTFPCT+8
GTFOPTS  EQU   GTFPCT+12
GTFOPTS1 EQU   GTFOPTS
GTFOPTS2 EQU   GTFOPTS+1
GTFOPTS3 EQU   GTFOPTS+2
GTFOPTS4 EQU   GTFOPTS+3
PCTCATF  EQU   GTFPCT+16
INITPTR  EQU   GTFPCT+60
STOPECBA EQU   GTFPCT+76
NEXTBLOK EQU   GTFPCT+180
WRTRCOM  EQU   GTFPCT+204
TRMWRIT  EQU   GTFPCT+212
WRTRERR  EQU   GTFPCT+216
GTFSSRB  EQU   GTFPCT+220
QLOCKWRD EQU   GTFPCT+236
QLOCKECB EQU   GTFPCT+240
AUDITFLG EQU   GTFPCT+296
INITDATA EQU   0
ICT      EQU   INITDATA+16
ICTMSGX  EQU   ICT
ICTIOTYP EQU   ICT+1
ICTFLAGS EQU   ICT+2
ICTPLIB  EQU   ICTFLAGS
ICTIOERR EQU   ICTFLAGS
ICTEOD   EQU   ICTFLAGS
ICTRETRY EQU   ICTFLAGS
ICTTRCIN EQU   ICTFLAGS
ICTSTOP  EQU   ICTFLAGS
PARMDCB  EQU   INITDATA+20
WTORECB  EQU   INITDATA+24
MSGREPLY EQU   INITDATA+28
GTFOPIND EQU   INITDATA+152
GTFOPT1  EQU   GTFOPIND
GTFSYSM  EQU   GTFOPT1
GTFSYSP  EQU   GTFOPT1
GTFSYS   EQU   GTFOPT1
GTFOPT2  EQU   GTFOPIND+1
GTFSVC   EQU   GTFOPT2
GTFSIO   EQU   GTFOPT2
GTFPI    EQU   GTFOPT2
GTFIO    EQU   GTFOPT2
GTFOPT3  EQU   GTFOPIND+2
GTFEXT   EQU   GTFOPT3
GTFRR    EQU   GTFOPT3
GTFOPT4  EQU   GTFOPIND+3
IOTAB    EQU   INITDATA+156
SIOTAB   EQU   INITDATA+160
SVCTAB   EQU   INITDATA+164
PITAB    EQU   INITDATA+168
TWT      EQU   INITDATA+176
TWTWORK  EQU   TWT+8
TWTBUF   EQU   TWT+40
STAEXPL  EQU   0
SAVARAD  EQU   STAEXPL
CMPCD    EQU   STAEXPL+4
STAEWORK EQU   0
PARMAD   EQU   STAEWORK
ABNDCC   EQU   STAEWORK+4
SYNADMSG EQU   0
SYNUAD   EQU   SYNADMSG+68
SYNOPERR EQU   SYNADMSG+84
SYNAM    EQU   SYNADMSG+122
CTLSAVE  EQU   0
CALLRSA1 EQU   CTLSAVE+4
CLRSAVE  EQU   0
GPRS15   EQU   CLRSAVE+16
GPRS0    EQU   CLRSAVE+20
STOPECB  EQU   0
POSTBIT  EQU   STOPECB
DCBEXLST EQU   37
DCBOFLGS EQU   48
DCBEODAD EQU   32
AHLMSGTB EQU   0
AHLLEN   EQU   AHLMSGTB
AHLAD    EQU   AHLMSGTB+1
MSG      EQU   12
AHLMSG   EQU   0
DCBSYNAD EQU   56
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
JFCB     EQU   TWT+4
JFCBDSNM EQU   JFCB
JFCBELNM EQU   JFCB+44
TXT127   EQU   TWTBUF+36
UNITADR  EQU   TXT127
OPERR    EQU   TXT127+4
ACSMETH  EQU   TXT127+27
CLOSLST2 EQU   CLOSLST1
OPENLST2 EQU   OPENLST1
STAELST2 EQU   STAELST1
MSGMEMBR EQU   TWTBUF+20
RTDCD    EQU   TWTBUF+47
MSGCODE  EQU   TWTBUF+44
ELSAV    EQU   TWTWORK+24
RETRYCOD EQU   RTRYRT
ECBAD    EQU   TWTBUF+4
RPLYAD   EQU   TWTBUF+1
WTOMSG   EQU   TWTBUF+4
WTOLEN   EQU   TWTBUF
WTORMSG  EQU   TWTBUF+12
WTORLEN  EQU   TWTBUF+8
AHL127RC EQU   TWTBUF+36
A127RCHD EQU   TWTBUF+70
MSGAREA  EQU   TWTBUF
RPLYLEN  EQU   TWTBUF
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
WAITBIT  EQU   STOPECB
@NM00017 EQU   CLRSAVE+24
GPRS14   EQU   CLRSAVE+12
CALLDSA2 EQU   CLRSAVE+8
CALLRSA2 EQU   CLRSAVE+4
@NM00016 EQU   CLRSAVE
REGS     EQU   CTLSAVE+12
CALLDSA1 EQU   CTLSAVE+8
@NM00015 EQU   CTLSAVE
@NM00014 EQU   SYNADMSG+107
@NM00013 EQU   SYNADMSG+72
@NM00012 EQU   SYNADMSG
@NM00010 EQU   TWT+4
@NM00009 EQU   TWT
RANGPTR  EQU   INITDATA+172
GTFTIME  EQU   GTFOPT4
GTFRES3  EQU   GTFOPT4
GTFIOSIO EQU   GTFOPT3
GTFRES2  EQU   GTFOPT3
GTFSRM   EQU   GTFOPT3
GTFRNIO  EQU   GTFOPT3
GTFIOP   EQU   GTFOPT2
GTFPIP   EQU   GTFOPT2
GTFSIOP  EQU   GTFOPT2
GTFSVCP  EQU   GTFOPT2
GTFPCI   EQU   GTFOPT1
GTFRES1  EQU   GTFOPT1
GTFDSP   EQU   GTFOPT1
GTFTRC   EQU   GTFOPT1
GTFUSR   EQU   GTFOPT1
ICTRESV  EQU   ICTFLAGS
EXECPTR  EQU   INITDATA+12
CIBPTR   EQU   INITDATA+8
INITID   EQU   INITDATA
PCTWTOMD EQU   GTFPCT+312
PCTDMPMD EQU   GTFPCT+308
TRANSMAX EQU   GTFPCT+304
GTFASCB  EQU   GTFPCT+300
@NM00008 EQU   AUDITFLG+3
AFSLEBLD EQU   AUDITFLG+3
WSERFG06 EQU   AUDITFLG+3
WSERFG05 EQU   AUDITFLG+3
WSERFG04 EQU   AUDITFLG+3
WSERFG03 EQU   AUDITFLG+3
WSERFG02 EQU   AUDITFLG+2
WSERFLAG EQU   AUDITFLG+2
TERMFLAG EQU   AUDITFLG+2
AFXWRIT  EQU   AUDITFLG+2
AFQLWAIT EQU   AUDITFLG+2
AFSLEGET EQU   AUDITFLG+2
AFBUFGET EQU   AUDITFLG+2
AFFEOB   EQU   AUDITFLG+2
AFBLKFIX EQU   AUDITFLG+1
AFEQFIX  EQU   AUDITFLG+1
AFPGRLSE EQU   AUDITFLG+1
AFWRAP   EQU   AUDITFLG+1
AFBUFOFF EQU   AUDITFLG+1
AFLDFX   EQU   AUDITFLG+1
AFCLOSE  EQU   AUDITFLG+1
AFOPEN   EQU   AUDITFLG+1
AFGMBLOK EQU   AUDITFLG
AFGMSRB  EQU   AUDITFLG
AFWAIT   EQU   AUDITFLG
AFTERM   EQU   AUDITFLG
AFINIT   EQU   AUDITFLG
AFWWRIT  EQU   AUDITFLG
AFCWRIT  EQU   AUDITFLG
AFIWRIT  EQU   AUDITFLG
EQSHORT  EQU   GTFPCT+292
SLEMAX   EQU   GTFPCT+288
SLECNT   EQU   GTFPCT+284
RQPURGE  EQU   GTFPCT+280
RQTOTAL  EQU   GTFPCT+276
WRTDLST  EQU   GTFPCT+272
NUMOFBUF EQU   GTFPCT+268
SBUFDISA EQU   GTFPCT+264
SLESUSED EQU   GTFPCT+260
EQMIN    EQU   GTFPCT+256
EQLENGTH EQU   GTFPCT+252
WQMAX    EQU   GTFPCT+248
WQLENGTH EQU   GTFPCT+244
QLECBP   EQU   QLOCKECB
@NM00007 EQU   QLOCKECB
@NM00006 EQU   QLOCKWRD+3
SCHEDBUF EQU   QLOCKWRD+2
POSTWRIT EQU   QLOCKWRD+1
QLOCK    EQU   QLOCKWRD
WRITERDD EQU   GTFPCT+228
GTFLOSTR EQU   GTFPCT+224
SRBAVAIL EQU   GTFSSRB
WRTRERRP EQU   WRTRERR
@NM00005 EQU   WRTRERR
TRMWRITP EQU   TRMWRIT
@NM00004 EQU   TRMWRIT
GTFCMECB EQU   GTFPCT+208
WRTRCOMP EQU   WRTRCOM
@NM00003 EQU   WRTRCOM
TRANSCNT EQU   GTFPCT+200
AHLRDPLQ EQU   GTFPCT+196
SFEOBRTN EQU   GTFPCT+192
SBLOKRTN EQU   GTFPCT+188
CURRBLOK EQU   GTFPCT+184
GBCDS    EQU   NEXTBLOK
WSMODEND EQU   GTFPCT+176
WSMODBEG EQU   GTFPCT+172
BCBPAGE  EQU   GTFPCT+156
SLEPAGE  EQU   GTFPCT+152
SAVECNT  EQU   GTFPCT+148
SLQHEAD  EQU   GTFPCT+144
HQLENGTH EQU   GTFPCT+140
QTAIL    EQU   GTFPCT+136
HQHEAD   EQU   GTFPCT+132
WQHEAD   EQU   GTFPCT+128
RQHEAD   EQU   GTFPCT+124
EQHEAD   EQU   GTFPCT+120
WPOSTSRB EQU   GTFPCT+116
WTSKTCBA EQU   GTFPCT+112
WRTRTCBA EQU   GTFPCT+108
TRMWTASK EQU   GTFPCT+104
WTSKATTH EQU   GTFPCT+100
WTSKINIT EQU   GTFPCT+96
WTASKECB EQU   GTFPCT+92
WMTABPTR EQU   GTFPCT+88
ATTCHECB EQU   GTFPCT+84
AHLECB   EQU   GTFPCT+80
ECBADRLT EQU   GTFPCT+72
FIXLEN   EQU   GTFPCT+68
FIXPTR   EQU   GTFPCT+64
MCQEPTR  EQU   GTFPCT+56
GTFEIDL  EQU   GTFPCT+52
GTFPIBL  EQU   GTFPCT+48
GTFPIFT  EQU   GTFPCT+44
GTFSVCBL EQU   GTFPCT+40
GTFSVCFT EQU   GTFPCT+36
GTFIOBL  EQU   GTFPCT+32
GTFIOFT  EQU   GTFPCT+28
GTFSIOBL EQU   GTFPCT+24
GTFSIOFT EQU   GTFPCT+20
@NM00002 EQU   PCTCATF+1
PCTPIF   EQU   PCTCATF+1
PCTSIOF  EQU   PCTCATF+1
PCTIOF   EQU   PCTCATF+1
PCTSVCF  EQU   PCTCATF+1
PCTRR    EQU   PCTCATF+1
PCTSRM   EQU   PCTCATF+1
PCTRNIO  EQU   PCTCATF+1
PCTUSR   EQU   PCTCATF
PCTPI    EQU   PCTCATF
@NM00001 EQU   PCTCATF
PCTDSP   EQU   PCTCATF
PCTSIO   EQU   PCTCATF
PCTIO    EQU   PCTCATF
PCTEXT   EQU   PCTCATF
PCTSVC   EQU   PCTCATF
OPTTIME  EQU   GTFOPTS4
OPTRES3  EQU   GTFOPTS4
OPTIOSIO EQU   GTFOPTS3
OPTRES2  EQU   GTFOPTS3
OPTRR    EQU   GTFOPTS3
OPTSRM   EQU   GTFOPTS3
OPTRNIO  EQU   GTFOPTS3
OPTEXT   EQU   GTFOPTS3
OPTIOP   EQU   GTFOPTS2
OPTIO    EQU   GTFOPTS2
OPTPIP   EQU   GTFOPTS2
OPTPI    EQU   GTFOPTS2
OPTSIOP  EQU   GTFOPTS2
OPTSIO   EQU   GTFOPTS2
OPTSVCP  EQU   GTFOPTS2
OPTSVC   EQU   GTFOPTS2
OPTPCI   EQU   GTFOPTS1
OPTRES1  EQU   GTFOPTS1
OPTDSP   EQU   GTFOPTS1
OPTTRC   EQU   GTFOPTS1
OPTUSR   EQU   GTFOPTS1
OPTSYS   EQU   GTFOPTS1
OPTSYSP  EQU   GTFOPTS1
OPTSYSM  EQU   GTFOPTS1
GTFRESV  EQU   GTFSTAT
GTFDEBUG EQU   GTFSTAT
GTFMODE  EQU   GTFSTAT
GTFPCTID EQU   GTFPCT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00085 EQU   CTL03
@RT00087 EQU   CTL03
@RT00094 EQU   CTL02
@RT00118 EQU   CTL06
@RT00120 EQU   CTL07
@RT00122 EQU   CTL04
@RT00125 EQU   CTL06
@RT00127 EQU   CTL07
@RT00143 EQU   CTL04B
@RT00160 EQU   CTL05B
@RT00163 EQU   CTL06
@RT00179 EQU   CTL05A
@RT00189 EQU   CTL08
@RT00195 EQU   CTL10
@RT00197 EQU   CTL09
@RT00208 EQU   CTL11
@RT00219 EQU   CTL12
@RT00230 EQU   CTL13
@RT00249 EQU   CTL14
@RT00274 EQU   CTL15
@RT00305 EQU   IO00
@ENDDATA EQU   *
         END   AHLTCTL1,(C'PLS2342',0603,76167)

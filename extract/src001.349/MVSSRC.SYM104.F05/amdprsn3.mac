         TITLE 'AMDPRSN3--EDIT END OF STATEMENT PROCEDURES             *
                        '
AMDPRSN3 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
AMDPEOC2 DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00091-AMDPEOC2)
         ENTRY AMDPEOC2
AMDPFIN  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00179-AMDPFIN)
         ENTRY AMDPFIN
AMDPSUM1 DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00256-AMDPSUM1)
         ENTRY AMDPSUM1
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @07,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@07                                    0001
         LA    @08,@DATA                                           0001
         USING @DATA,@08                                           0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
*                                                                  0090
              EQUATES                   AMDPRDMP EQU MACRO
              COMMON                    EXPANDS TO AMDPRCOM TABLE
AMDPRSN3      CSECT                     RE-ESTABLISH SCAN CSECT
              USING COMMON,COMBASE      SET UP DSECT FOR AMDPRCOM
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE CONTINUES UPDATING/RESETTING PROCEDURES- IT   */
*   /* HAS BEEN DETERMINED THAT END-OF- STATEMENT HAS BEEN REACHED.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0091
*AMDPEOC2:                                                         0091
*   ENTRY;                          /* ENTRY POINT                   */
@EP00091 DS    0H                                                  0092
*AMDPEC21:                                                         0092
*   IF FLMODE='1'B THEN             /* IF FLUSH MODE,                */
AMDPEC21 TM    FLMODE(AEDITCBR),B'10000000'                        0092
         BNO   @RF00092                                            0092
*     DO;                           /* RESET VALUES                  */
*       EXITNAME=' ';               /* EXIT NAME BLANKED OUT         */
         MVI   EXITNAME+1(TTABPTR),C' '                            0094
         MVC   EXITNAME+2(6,TTABPTR),EXITNAME+1(TTABPTR)           0094
         MVI   EXITNAME(TTABPTR),C' '                              0094
*       DDNM=' ';                   /* DDNAME BLANKED OUT            */
         MVI   DDNM+1(TTABPTR),C' '                                0095
         MVC   DDNM+2(6,TTABPTR),DDNM+1(TTABPTR)                   0095
         MVI   DDNM(TTABPTR),C' '                                  0095
*       SIOTFLGS='0'B;              /* SIOTFLGS ZEROED OUT           */
         MVI   SIOTFLGS(TTABPTR),B'00000000'                       0096
*       IOTFLGS='0'B;               /* IOTFLGS ZEROED OUT            */
         MVI   IOTFLGS(TTABPTR),B'00000000'                        0097
*       USRTFLGS='0'B;              /* USRTFLGS ZEROED OUT           */
         MVI   USRTFLGS(TTABPTR),B'00000000'                       0098
*       SVCTFLGS='0'B;              /* SVCTFLGS ZEROED OUT           */
         MVI   SVCTFLGS(TTABPTR),B'00000000'                       0099
*       PITFLGS='0'B;               /* PITFLGS ZEROED OUT            */
         MVI   PITFLGS(TTABPTR),B'00000000'                        0100
*       SVCSTR='0'B;                /* ZERO TEMP SVC BIT STRING      */
         XC    SVCSTR+1(31,TTABPTR),SVCSTR+1(TTABPTR)              0101
         MVI   SVCSTR(TTABPTR),B'00000000'                         0101
*       PISTR='0'B;                 /* ZERO TEMP PI BIT STRING       */
         MVI   PISTR+1(TTABPTR),X'00'                              0102
         MVI   PISTR(TTABPTR),B'00000000'                          0102
*       PISTRB='0'B;                /* TURN OFF PI 17- 19 BITS       */
         MVI   PISTRB(TTABPTR),B'00000000'                         0103
*       SYSTFLGS='0'B;              /* SYSTFLGS ZEROED OUT           */
*                                                                  0104
         MVI   SYSTFLGS(TTABPTR),B'00000000'                       0104
*       /*************************************************************/
*       /*                                                           */
*       /* BEFORE BLANKING OR ZEROING OUT ERRONEOUS FIELDS IN        */
*       /* AMDPRTAB, DETERMINE IF FIELD POINTER POINTS WITHIN        */
*       /* ERRONEOUS FIELD. IF NOT, OMIT RE-INITIALIZATION.          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0105
*       JOBCRPTR=JOBNPTR;           /* RE-INIT JOBNAMES PTR          */
         L     @14,JOBNPTR(,TTABPTR)                               0105
         ST    @14,JOBCRPTR(,TTABPTR)                              0105
*       IF JOBCRPTR=ADDR(ADS)       /* Q/AT END OF JOBN SLOTS        */
*         THEN                      /* YES, SO DO BELOW              */
         LA    @10,ADS(,AEDITCBR)                                  0106
         CR    @14,@10                                             0106
         BE    @RT00106                                            0106
*         GOTO AMDTCB1;             /* OMIT RE-INITIALIZATION        */
*       JOBCRPTR->JOBCHAR           /* BLANK JOBN SLOT               */
*           =BLANK1;                                               0108
         MVC   JOBCHAR(8,@14),BLANK1(TTABPTR)                      0108
*AMDTCB1:                                                          0109
*       ASCBCPTR=ASCBPTR;           /* REINIT ASCB ADDRS PTR Y02014  */
AMDTCB1  L     @14,ASCBPTR(,TTABPTR)                               0109
         ST    @14,ASCBCPTR(,TTABPTR)                              0109
*       IF ASCBCPTR=ADDR(SIF)       /* AT END OF ASCB SLOTS    Y02014*/
*         THEN                      /* YES, SO DO BELOW              */
         LA    @10,SIF(,AEDITCBR)                                  0110
         CR    @14,@10                                             0110
         BE    @RT00110                                            0110
*         GOTO AMDSIO1;             /* OMIT RE-INITIALIZATION        */
*       ASCBCPTR->REINIT            /* ZERO ASCB ADDRS SLT     Y02014*/
*           =0;                                                    0112
         SLR   @10,@10                                             0112
         STCM  @10,15,REINIT(@14)                                  0112
*AMDSIO1:                                                          0113
*       SIOCRPTR=SIOPTR;            /* RE-INIT SIO DEVICES PTR       */
AMDSIO1  L     @14,SIOPTR(,TTABPTR)                                0113
         ST    @14,SIOCRPTR(,TTABPTR)                              0113
*       IF SIOCRPTR=ADDR(IO)        /* Q/AT END OF SIO DEVICE ADS    */
*         THEN                      /* YES, SO DO BELOW              */
         LA    @10,IO(,AEDITCBR)                                   0114
         CR    @14,@10                                             0114
         BE    @RT00114                                            0114
*         GOTO AMDIO1;              /* OMIT RE-INITIALIZATION        */
*       SIOCRPTR->DEVCHAR           /* BLANK OUT SIO SLOT            */
*           =BLANK1;                                               0116
         MVC   DEVCHAR(2,@14),BLANK1(TTABPTR)                      0116
*AMDIO1:                                                           0117
*       IOCRPTR=IOPTR;              /* RE-INIT IO DEVICES PTR        */
AMDIO1   L     @14,IOPTR(,TTABPTR)                                 0117
         ST    @14,IOCRPTR(,TTABPTR)                               0117
*       IF IOCRPTR=ADDR(VCF)        /* Q/AT END OF IO DEVICE ADS     */
*         THEN                      /* YES, SO DO BELOW              */
         LA    @10,VCF(,AEDITCBR)                                  0118
         CR    @14,@10                                             0118
         BE    @RT00118                                            0118
*         GOTO AMDUSRBL;            /* OMIT RE-INITIALIZATION        */
*       IOCRPTR->DEVCHAR            /* BLANK IO SLOT                 */
*           =BLANK1;                                               0120
*                                                                  0120
         MVC   DEVCHAR(2,@14),BLANK1(TTABPTR)                      0120
*       /*************************************************************/
*       /*                                                           */
*       /* BLANK OUT ALL USR SLOTS FILLED IN FROM THIS CARD          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0121
*AMDUSRBL:                                                         0121
*       DO I=USRCOUNT+1 TO USRCRCNT;                               0121
AMDUSRBL LA    @14,1                                               0121
         AL    @14,USRCOUNT(,TTABPTR)                              0121
         B     @DE00121                                            0121
@DL00121 DS    0H                                                  0122
*         USRNGTAB(I)=BLANK1;       /* BLANK OUT USR SLOT            */
         L     @14,I(,TTABPTR)                                     0122
         SLA   @14,2                                               0122
         ALR   @14,AEDITCBR                                        0122
         MVC   USRNGTAB-4(4,@14),BLANK1(TTABPTR)                   0122
*       END;                                                       0123
         LA    @14,1                                               0123
         AL    @14,I(,TTABPTR)                                     0123
@DE00121 ST    @14,I(,TTABPTR)                                     0123
         C     @14,USRCRCNT(,TTABPTR)                              0123
         BNH   @DL00121                                            0123
*       USRCRCNT=0;                 /* RE-INIT USR EID COUNT         */
         SLR   @14,@14                                             0124
         ST    @14,USRCRCNT(,TTABPTR)                              0124
*       STARTSL=' ';                /* START SLOT BLANKED OUT        */
         MVI   STARTSL+1(TTABPTR),C' '                             0125
         MVC   STARTSL+2(10,TTABPTR),STARTSL+1(TTABPTR)            0125
         MVI   STARTSL(TTABPTR),C' '                               0125
*       STOPSL=' ';                 /* STOP SLOT BLANKED OUT         */
*                                                                  0126
         MVI   STOPSL+1(TTABPTR),C' '                              0126
         MVC   STOPSL+2(10,TTABPTR),STOPSL+1(TTABPTR)              0126
         MVI   STOPSL(TTABPTR),C' '                                0126
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF START AND/OR STOP SLOT IN AMDPRTAB IS FILLED */
*       /* IN. IF SO, DO NOT BLANK OUT THE RESPECTIVE START AND/OR   */
*       /* STOP INTERNAL SLOT.                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0127
*       IF STARTIME=BLANK1 THEN     /* IF PRTAB START SLOT BLANK,    */
         CLC   STARTIME(12,AEDITCBR),BLANK1(TTABPTR)               0127
         BNE   @RF00127                                            0127
*         INTSTART=BLANK1;          /* BLANK OUT INT START SLOT      */
         MVC   INTSTART(5,TTABPTR),BLANK1(TTABPTR)                 0128
*       IF STOPTIME=BLANK1 THEN     /* IF PRTAB STOP SLOT BLANK,     */
@RF00127 CLC   STOPTIME(12,AEDITCBR),BLANK1(TTABPTR)               0129
         BNE   @RF00129                                            0129
*         INTSTOP=BLANK1;           /* BLANK OUT INT STOP SLOT       */
         MVC   INTSTOP(5,TTABPTR),BLANK1(TTABPTR)                  0130
*       OVERLTAB=' ';               /* OVERLAY TABLE BLANKED OUT     */
@RF00129 MVI   OVERLTAB+1(TTABPTR),C' '                            0131
         MVC   OVERLTAB+2(38,TTABPTR),OVERLTAB+1(TTABPTR)          0131
         MVI   OVERLTAB(TTABPTR),C' '                              0131
*       IF GRDRSW='1'B THEN         /* IF INPUT FROM SYSIN,          */
         TM    GRDRSW,B'00000001'                                  0132
         BO    @RT00132                                            0132
*         GOTO AMDPST4;             /* THEN RETURN TO AMDPRCTL       */
*       GOTO AMDPRESP;              /* IF INPUT FROM CONSOLE,      0134
*                                      RESPECIFY LAST LINE           */
         B     AMDPRESP                                            0134
*     END;                          /* IF FLUSH MODE BIT WAS ON      */
*                                                                  0135
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FLUSH MODE BIT WAS OFF, MAKE TEMPORARY VALUES PERM         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0136
*   IF EXITNAME^=BLANK1 THEN        /* MAKE TEMPORARY EXIT NAME      */
@RF00092 CLC   EXITNAME(8,TTABPTR),BLANK1(TTABPTR)                 0136
         BE    @RF00136                                            0136
*     USEREXIT=EXITNAME;            /* THE EXIT NAME IN AMDPRTAB     */
         MVC   USEREXIT(8,AEDITCBR),EXITNAME(TTABPTR)              0137
*   IF DDNM^=BLANK1 THEN            /* MAKE TEMPORARY DDNAME THE     */
@RF00136 CLC   DDNM(8,TTABPTR),BLANK1(TTABPTR)                     0138
         BE    @RF00138                                            0138
*     DDNAME=DDNM;                  /* DDNAME IN AMDPRTAB            */
         MVC   DDNAME(8,AEDITCBR),DDNM(TTABPTR)                    0139
*   IF STARTSL^=BLANK1 THEN         /* MAKE TEMPORARY START VALUE    */
@RF00138 CLC   STARTSL(12,TTABPTR),BLANK1(TTABPTR)                 0140
         BE    @RF00140                                            0140
*     STARTIME=STARTSL;             /* THE START VAL IN AMDPRTAB     */
         MVC   STARTIME(12,AEDITCBR),STARTSL(TTABPTR)              0141
*   IF STOPSL^=BLANK1 THEN          /* MAKE TEMPORARY STOP VALUE     */
@RF00140 CLC   STOPSL(12,TTABPTR),BLANK1(TTABPTR)                  0142
         BE    @RF00142                                            0142
*     STOPTIME=STOPSL;              /* THE STOP VAL IN AMDPRTAB      */
         MVC   STOPTIME(12,AEDITCBR),STOPSL(TTABPTR)               0143
*   JOBNPTR=JOBCRPTR;               /* UPDATE JOBNAMES PTR           */
@RF00142 L     @14,JOBCRPTR(,TTABPTR)                              0144
         ST    @14,JOBNPTR(,TTABPTR)                               0144
*   IF JOBNPTR=ADDR(ADS) THEN       /* Q/AT END OF JOBN SLOTS        */
         LA    @10,ADS(,AEDITCBR)                                  0145
         CR    @14,@10                                             0145
         BE    @RT00145                                            0145
*     GOTO AMDTCB;                  /* YES                           */
*   JOBNPTR->JOBCHAR=BLANK1;        /* IF NOT, BLANK SLOT            */
         MVC   JOBCHAR(8,@14),BLANK1(TTABPTR)                      0147
*AMDTCB:                                                           0148
*   ASCBPTR=ASCBCPTR;               /* UPDTE ASCB ADRS PTR     Y02014*/
AMDTCB   L     @14,ASCBCPTR(,TTABPTR)                              0148
         ST    @14,ASCBPTR(,TTABPTR)                               0148
*   IF ASCBPTR=ADDR(SIF) THEN       /* AT END OF ASCB SLTS     Y02014*/
         LA    @10,SIF(,AEDITCBR)                                  0149
         CR    @14,@10                                             0149
         BE    @RT00149                                            0149
*     GOTO AMDSIO;                  /* YES                           */
*   ASCBPTR->REINIT=0;              /* NO ZERO CURR SLOT       Y02014*/
         SLR   @10,@10                                             0151
         STCM  @10,15,REINIT(@14)                                  0151
*AMDSIO:                                                           0152
*   SIOFLGS=SIOFLGS                 /* UPDATE SIOFLGS                */
*       ×SIOTFLGS;                                                 0152
AMDSIO   OC    SIOFLGS(1,AEDITCBR),SIOTFLGS(TTABPTR)               0152
*   SIOPTR=SIOCRPTR;                /* UPDATE SIO DEVS PTR           */
         L     @14,SIOCRPTR(,TTABPTR)                              0153
         ST    @14,SIOPTR(,TTABPTR)                                0153
*   IF SIOPTR=ADDR(IO) THEN         /* Q/AT END OF SIO DEVICE ADS    */
         LA    @10,IO(,AEDITCBR)                                   0154
         CR    @14,@10                                             0154
         BE    @RT00154                                            0154
*     GOTO AMDIO;                   /* YES                           */
*   SIOPTR->DEVCHAR=BLANK1;         /* IF NOT, BLANK CURRENT SLOT    */
         MVC   DEVCHAR(2,@14),BLANK1(TTABPTR)                      0156
*AMDIO:                                                            0157
*   IOFLGS2=IOFLGS2×IOTFLGS;        /* UPDATE IOFLGS                 */
AMDIO    OC    IOFLGS2(1,AEDITCBR),IOTFLGS(TTABPTR)                0157
*   IOPTR=IOCRPTR;                  /* UPDATE IO DEVS PTR            */
         L     @14,IOCRPTR(,TTABPTR)                               0158
         ST    @14,IOPTR(,TTABPTR)                                 0158
*   IF IOPTR=ADDR(VCF) THEN         /* Q/AT END OF IO DEVICE ADS     */
         LA    @10,VCF(,AEDITCBR)                                  0159
         CR    @14,@10                                             0159
         BE    @RT00159                                            0159
*     GOTO AMDUSRCT;                /* YES                           */
*   IOPTR->DEVCHAR=BLANK1;          /* IF NOT, BLANK CURRENT SLOT    */
         MVC   DEVCHAR(2,@14),BLANK1(TTABPTR)                      0161
*AMDUSRCT:                                                         0162
*   USRFLGS=USRFLGS                 /* UPDATE USRFLGS                */
*       ×USRTFLGS;                                                 0162
AMDUSRCT OC    USRFLGS(1,AEDITCBR),USRTFLGS(TTABPTR)               0162
*   USRCOUNT=USRCOUNT               /* UPDATE USR EID COUNT          */
*       +USRCRCNT;                                                 0163
         L     @14,USRCOUNT(,TTABPTR)                              0163
         AL    @14,USRCRCNT(,TTABPTR)                              0163
         ST    @14,USRCOUNT(,TTABPTR)                              0163
*   USRCRCNT=0;                     /* REINIT CURRENT EID COUNT      */
         SLR   @14,@14                                             0164
         ST    @14,USRCRCNT(,TTABPTR)                              0164
*   PIFLGS=PIFLGS×PITFLGS;          /* UPDATE PIFLGS                 */
         OC    PIFLGS(1,AEDITCBR),PITFLGS(TTABPTR)                 0165
*   SVCFLGS=SVCFLGS                 /* UPDATE SVCFLGS                */
*       ×SVCTFLGS;                                                 0166
         OC    SVCFLGS(1,AEDITCBR),SVCTFLGS(TTABPTR)               0166
*   PICODES=PICODES×PISTR;          /* UPDATE PI CODES               */
         OC    PICODES(2,AEDITCBR),PISTR(TTABPTR)                  0167
*   PICODEA=PICODEA×PISTRB;         /* UPDATE PI CODES 17 18 19      */
         OC    PICODEA(1,AEDITCBR),PISTRB(TTABPTR)                 0168
*   SVCNUMS=SVCNUMS×SVCSTR;         /* UPDATE SVC NUMBERS            */
         OC    SVCNUMS(32,AEDITCBR),SVCSTR(TTABPTR)                0169
*   GENFLAGS=GENFLAGS               /* UPDATE SYSTEM FLAGS           */
*       ×SYSTFLGS;                                                 0170
*                                                                  0170
         OC    GENFLAGS(1,AEDITCBR),SYSTFLGS(TTABPTR)              0170
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH OVERLAY TABLE- IF VALUE EXISTS, OVERLAY CURRENT  */
*   /* VALUE IN USR EID RANGE TABLE                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0171
*   DO I=1 TO 20;                   /* LOOP THRU ENTIRE TABLE        */
         LA    @14,1                                               0171
         ST    @14,I(,TTABPTR)                                     0171
@DL00171 DS    0H                                                  0172
*     IF OVERSL(I)                  /* IF NON-BLANK VALUE IN         */
*         ^=BLANK1 THEN             /* OVERLTAB, THEN INSERT         */
         L     @14,I(,TTABPTR)                                     0172
         LR    @10,@14                                             0172
         ALR   @10,@10                                             0172
         ST    @10,@TF00001                                        0172
         ALR   @10,TTABPTR                                         0172
         CLC   OVERSL-2(2,@10),BLANK1(TTABPTR)                     0172
         BE    @RF00172                                            0172
*       USRNGTAB(I,3                /* VALUE IN USR EID RANGE        */
*           :4)=OVERSL(I);          /* TABLE UPPER RNG PORTION       */
         SLA   @14,2                                               0173
         ALR   @14,AEDITCBR                                        0173
         LR    @10,TTABPTR                                         0173
         AL    @10,@TF00001                                        0173
         MVC   USRNGTAB-2(2,@14),OVERSL-2(@10)                     0173
*   END;                            /* NO VALUE OR AT USRMAX         */
@RF00172 LA    @14,1                                               0174
         AL    @14,I(,TTABPTR)                                     0174
         ST    @14,I(,TTABPTR)                                     0174
         C     @14,@CF00130                                        0174
         BNH   @DL00171                                            0174
*   IF GCONTSW='1'B THEN            /* IF CONTINUE SWITCH ON,        */
         TM    GCONTSW,B'00000100'                                 0175
         BO    @RT00175                                            0175
*     GOTO AMDRET3;                 /* RETURN FOR ANOTHER STMT       */
*   GOTO AMDPFINN;                  /* SKIP ENTRY STATEMENT          */
         B     AMDPFINN                                            0177
*AMDRET3:                                                          0178
*   RETURN;                         /* RETURN TO CALLER              */
*                                                                  0178
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE ACCOMPLISHES THE SORTING OF THE SIO, IO, AND  */
*   /* USER PORTIONS OF AMDPRTAB. VALUES ARE ORGANIZED IN ASCENDING  */
*   /* ORDER.                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0179
*AMDPFIN:                                                          0179
*   ENTRY;                          /* ENTRY POINT                   */
@EP00179 DS    0H                                                  0180
*AMDPFINN:                                                         0180
*   SORTSW=0;                       /* READY TO SORT TABLES--      0180
*                                      SCANNING COMPLETE             */
AMDPFINN SLR   SORTSW,SORTSW                                       0180
*   IF SIOPTR=ADDR(DVADS1)          /* IF NO SIO DEVICE ADDRESSES    */
*     THEN                          /* IN SIO TABLE, THEN            */
         L     @14,SIOPTR(,TTABPTR)                                0181
         LA    @10,DVADS1(,AEDITCBR)                               0181
         CR    @14,@10                                             0181
         BE    @RT00181                                            0181
*     GOTO AMDPFIN1;                /* LOOK IN NEXT TABLE            */
*   SRTTABPT=ADDR(DVADS1);          /* INITIALIZE TO TABL BEGNING    */
         ST    @10,SRTTABPT(,TTABPTR)                              0183
*   INCRT=2;                        /* SIO TABLE 2 BYTES WIDE        */
         LA    @06,2                                               0184
         ST    @06,INCRT(,TTABPTR)                                 0184
*   SORTPTR=SIOPTR-(2*INCRT);       /* CALC NEXT TO LAST SLOT        */
         ALR   @06,@06                                             0185
         SLR   @14,@06                                             0185
         ST    @14,SORTPTR(,TTABPTR)                               0185
*   SAVETAB=ADDR(DVADS1);           /* SAVE TABLE BEGNING ADDRS      */
         ST    @10,SAVETAB(,TTABPTR)                               0186
*   SORTSW=1;                       /* PROCESSING SIO ELEMENTS       */
         LA    SORTSW,1                                            0187
*   RESPECIFY                                                      0188
*     DEVICE BASED(K);                                             0188
*AMDPDEV:                                                          0189
*   DO K=SRTTABPT TO SORTPTR        /* LOOP UNTIL HIT CURRENT        */
*         BY INCRT;                 /* SLOT                          */
AMDPDEV  L     K,SRTTABPT(,TTABPTR)                                0189
         B     @DE00189                                            0189
@DL00189 DS    0H                                                  0190
*     Y=K+INCRT;                    /* DEVICE1 NOW BELOW DEVICE      */
         L     @14,INCRT(,TTABPTR)                                 0190
         LR    Y,K                                                 0190
         ALR   Y,@14                                               0190
*     IF DEVICE1(1:INCRT)           /* TWO VALUES IN TABLE OUT OF    */
*         ^>DEVICE(1:INCRT)         /* ORDER                         */
*       THEN                        /* THEN                          */
         BCTR  @14,0                                               0191
         EX    @14,@SC00655                                        0191
         BH    @RF00191                                            0191
*       DO;                         /* PLACE IN CORRECT ORDER        */
*         SAVESLOT(1:INCRT)         /* SAVE VALUE TO BE SWITCHED     */
*             =DEVICE(1:INCRT);                                    0193
         EX    @14,@SM00657                                        0193
*         DEVICE(1:INCRT)           /* SWITCH SECOND VALUE TO        */
*             =DEVICE1(1:INCRT);    /* FIRST SLOT                    */
         EX    @14,@SM00659                                        0194
*         DEVICE1(1:INCRT)          /* SWITCH SAVED FIRST VALUE      */
*             =SAVESLOT(1:INCRT);   /* TO SECOND SLOT                */
         EX    @14,@SM00661                                        0195
*         NEWADDR=K;                /* SAVE CURRENT SORT PTR         */
         LR    NEWADDR,K                                           0196
*AMDPDEV1:                                                         0197
*         Z=NEWADDR-INCRT;          /* ELEM NOW ABOVE ELEM1          */
AMDPDEV1 L     @14,INCRT(,TTABPTR)                                 0197
         LR    Z,NEWADDR                                           0197
         SLR   Z,@14                                               0197
*         IF NEWADDR=SAVETAB        /* IF AT TOP OF TABLE,           */
*           THEN                    /* THEN                          */
         C     NEWADDR,SAVETAB(,TTABPTR)                           0198
         BE    @RT00198                                            0198
*           GOTO AMDPDEV2;          /* READY TO SORT NEXT ELEMS      */
*         IF ELEM1(1:INCRT)         /* IF ELEMS BELOW JUST-          */
*             >ELEM(1:INCRT)        /* SWITCHED ONES ARE IN ORDER    */
*           THEN                    /* THEN                          */
         LR    @10,@14                                             0200
         BCTR  @10,0                                               0200
         EX    @10,@SC00663                                        0200
         BH    @RT00200                                            0200
*           GOTO AMDPDEV2;          /* READY TO SORT NEXT ELEMS      */
*         SAVESLOT(1:INCRT)         /* SAVE VALUE TO BE SWITCHED     */
*             =ELEM(1:INCRT);                                      0202
         EX    @10,@SM00665                                        0202
*         ELEM(1:INCRT)             /* SWITCH SECOND VALUE TO        */
*             =ELEM1(1:INCRT);      /* FIRST SLOT                    */
         EX    @10,@SM00667                                        0203
*         ELEM1(1:INCRT)            /* SWITCH SAVED FIRST VALUE      */
*             =SAVESLOT(1:INCRT);   /* TO SECOND SLOT                */
         EX    @10,@SM00669                                        0204
*         NEWADDR=NEWADDR           /* GO BACK ONE SLOT              */
*             -INCRT;                                              0205
         SLR   NEWADDR,@14                                         0205
*         GOTO AMDPDEV1;            /* SORT REMAINING ELEMENTS       */
         B     AMDPDEV1                                            0206
*AMDPDEV2:                                                         0207
*       END;                        /* END OF DO LOOP                */
AMDPDEV2 DS    0H                                                  0208
*   END;                            /* READY TO LOOK AT NEXT TWO   0208
*                                      ELEMENTS FROM TOP             */
@RF00191 AL    K,INCRT(,TTABPTR)                                   0208
@DE00189 C     K,SORTPTR(,TTABPTR)                                 0208
         BNH   @DL00189                                            0208
*AMDPFIN1:                                                         0209
*   IF SORTSW>1 THEN                /* Q/BEYOND SIO&IO TABL SORTS    */
AMDPFIN1 C     SORTSW,@CF00046                                     0209
         BNH   @RF00209                                            0209
*     DO;                           /* IF SO, PROCEED AS FOLLOWS     */
*       IF SORTSW=2 THEN            /* YES--Q/BEYOND USR TBL SORT    */
         C     SORTSW,@CF00078                                     0211
         BE    @RT00211                                            0211
*         GOTO AMDPFIN3;            /* NO                            */
*       GOTO AMDPSUM;               /* YES--READY FOR SUMMARY MSG    */
         B     AMDPSUM                                             0213
*     END;                          /* SORTSW WAS > 1                */
*AMDPFIN2:                                                         0215
*   IF IOPTR=ADDR(DVADS2)           /* IF NO IO DEVICE ADDRESSES     */
*     THEN                          /* IN IO TABLE, THEN LOOK IN     */
@RF00209 DS    0H                                                  0215
AMDPFIN2 L     @14,IOPTR(,TTABPTR)                                 0215
         LA    @10,DVADS2(,AEDITCBR)                               0215
         CR    @14,@10                                             0215
         BE    @RT00215                                            0215
*     GOTO AMDPFIN3;                /* NEXT TABLE(USR)               */
*   SRTTABPT=ADDR(DVADS2);          /* INITIALIZE TO TABL BEGNING    */
         ST    @10,SRTTABPT(,TTABPTR)                              0217
*   INCRT=2;                        /* IO TABLE 2 BYTES WIDE         */
         LA    @06,2                                               0218
         ST    @06,INCRT(,TTABPTR)                                 0218
*   SORTPTR=IOPTR-(2*INCRT);        /* CALC NEXT TO LAST IO SLOT     */
         LR    @04,@06                                             0219
         ALR   @04,@04                                             0219
         SLR   @14,@04                                             0219
         ST    @14,SORTPTR(,TTABPTR)                               0219
*   SAVETAB=ADDR(DVADS2);           /* SAVE TABLE BEGNING ADDRS      */
         ST    @10,SAVETAB(,TTABPTR)                               0220
*   SORTSW=2;                       /* PROCESSING IO ELEMENTS        */
         LR    SORTSW,@06                                          0221
*   GOTO AMDPDEV;                   /* BEGIN ACTUAL SORT OPERATN     */
         B     AMDPDEV                                             0222
*AMDPFIN3:                                                         0223
*   IF USRCOUNT=0                   /* IF NO USR EIDS IN USR EID     */
*     THEN                          /* RANGE TABLE, THEN             */
AMDPFIN3 L     @14,USRCOUNT(,TTABPTR)                              0223
         LTR   @14,@14                                             0223
         BZ    @RT00223                                            0223
*     GOTO AMDPSUM;                 /* CONSTRUCT SUMMARY MESSAGE     */
*   SRTTABPT=ADDR(USRTAB);          /* INITIALIZE TO TABL BEGNING    */
         LA    @10,USRTAB(,AEDITCBR)                               0225
         ST    @10,SRTTABPT(,TTABPTR)                              0225
*   SORTPTR=SRTTABPT                /* CALCULATE ADDRS OF USER       */
*       +(USRCOUNT*4);              /* CURRENT SLOT                  */
         SLA   @14,2                                               0226
         ALR   @14,@10                                             0226
         ST    @14,SORTPTR(,TTABPTR)                               0226
*   INCRT=4;                        /* USR TABLE 4 BYTES WIDE        */
         LA    @06,4                                               0227
         ST    @06,INCRT(,TTABPTR)                                 0227
*   SORTPTR=SORTPTR-(2*INCRT);      /* STOP SORTING HERE             */
         ALR   @06,@06                                             0228
         SLR   @14,@06                                             0228
         ST    @14,SORTPTR(,TTABPTR)                               0228
*   SAVETAB=ADDR(USRTAB);           /* SAVE TABLE BEGNING ADDRS      */
         ST    @10,SAVETAB(,TTABPTR)                               0229
*   SORTSW=3;                       /* PROCESSING USR ELEMENTS       */
         LA    SORTSW,3                                            0230
*   GOTO AMDPDEV;                   /* BEGIN ACTUAL SORT OPERATN     */
*                                                                  0231
         B     AMDPDEV                                             0231
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SMALL SUBROUTINE SETS UP THE OPERATION OF ALLOWING       */
*   /* RESPECIFICATION OF A LINE CONTAINING ONE OR MORE ERRORS       */
*   /* INPUTTED FROM THE CONSOLE. THE USER CHOOSES BETWEEN 1)        */
*   /* RESPECIFYING THE PREVIOUS LINE, AND 2) REPLYING 'RUNEDIT' TO  */
*   /* CAUSE EDIT TO CONTINUE PROCESSING USING ACCEPTABLE VALUES THUS*/
*   /* FAR INPUTTED.                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0232
*AMDPRESP:                                                         0232
*   FLMODE='0'B;                    /* NO LONGER IN FLUSH MODE       */
AMDPRESP NI    FLMODE(AEDITCBR),B'01111111'                        0232
*   GCONTSW='1'B;                   /* CONTINUATION MSG WILL BE    0233
*                                      ISSUED                        */
         OI    GCONTSW,B'00000100'                                 0233
*   RUNEDIT='1'B;                   /* SET ON RETRY-IN-PROCESS BT    */
         OI    RUNEDIT(TTABPTR),B'00001000'                        0234
*   GEN(OI SWE,RESPC);              /* TURN ON RESPECIFY SW M4467    */
         OI SWE,RESPC
*   GOTO AMDRET3;                   /* RETURN TO AMDPRSCN            */
*                                                                  0236
         B     AMDRET3                                             0236
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0237
*AMDPST4:                                                          0237
*   IF GCONTSW='1'B THEN            /* GET ANOTHER STMT BY           */
AMDPST4  TM    GCONTSW,B'00000100'                                 0237
         BO    @RT00237                                            0237
*     GOTO AMDRET3;                 /* RETURNING TO CALLER           */
*   SCANBIT='0'B;                   /* READY FOR FIRST TIME SW       */
         NI    SCANBIT(TTABPTR),B'11011111'                        0239
*   REG15=4;                        /* SET EDIT-NO-CONTINUE CODE     */
         LA    REG15,4                                             0240
*   IF DDNAME^=BLANK1 THEN          /* EXTERNAL DATA SET             */
         CLC   DDNAME(8,AEDITCBR),BLANK1(TTABPTR)                  0241
         BNE   @RT00241                                            0241
*     GOTO AMDRET3;                 /* RETURN TO CALLER              */
*   SYNMSGA=0;                      /* DUMP DATA SET, SO INPUT STREAM
*                                      MUST BE FLUSHED               */
         SLR   @14,@14                                             0243
         ST    @14,SYNMSGA                                         0243
*   CALL AMDPRSYN;                  /* OUTPUT INPUT STREAM DATA    0244
*                                      FLUSHED MSG                   */
         L     @15,ASYNTAX                                         0244
         BALR  @14,@15                                             0244
*   REG15=4;                        /* RESET EDIT NO GO CODE         */
         LA    REG15,4                                             0245
*   GOTO AMDRET3;                   /* RETURN TO CALLER              */
         B     AMDRET3                                             0246
*AMDPSUM:                                                          0247
*   IF GFLSHMOD='1'B THEN           /* IF AMDPRDMP IN FLUSH MODE     */
AMDPSUM  TM    GFLSHMOD,B'10000000'                                0247
         BNO   @RF00247                                            0247
*     DO;                           /* DO THE FOLLOWING              */
*       IF DDNAME^=BLANK1 THEN      /* IF AN EXTERNAL DATA SET,      */
         CLC   DDNAME(8,AEDITCBR),BLANK1(TTABPTR)                  0249
         BNE   @RT00249                                            0249
*         GOTO AMDPSUMM;            /* CONTINUE EDIT ANYWAY          */
*       SCANBIT='0'B;               /* READY FOR FIRST TIME SW       */
         NI    SCANBIT(TTABPTR),B'11011111'                        0251
*       REG15=4;                    /* BUT IF DUMP DATA SET,         */
         LA    REG15,4                                             0252
*       GOTO AMDRET3;               /* STOP EDIT AND RETURN TO       */
         B     AMDRET3                                             0253
*     END;                          /* CALLER                        */
*   GOTO AMDPSUMM;                  /* OUTPUT EDIT SUMMARY MSG       */
*                                                                  0255
         B     AMDPSUMM                                            0255
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE CONSTRUCTS AND OUTPUTS THE EDIT      */
*   /* MESSAGE THAT IDENTIFIES THE EDIT OPTIONS CHOSEN BY THE USER.  */
*   /* IF DEFAULTS HAVE BEEN ASSIGNED, EXAMINATION OF THE CONTENTS OF*/
*   /* THIS MESSAGE WILL ENABLE RECOGNITION OF THESE DEFAULTS.       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0256
*AMDPSUM1:                                                         0256
*   ENTRY;                          /* ENTRY POINT                   */
@EP00256 DS    0H                                                  0257
*AMDPSUMM:                                                         0257
*   IF ALLS='1'B×SELS='1'B          /* IF SIO ALL OR SELECTIVE,      */
*       ×ALLI='1'B×SELI='1'B        /* OR IO ALL OR SELECTIVE,       */
*       ×ALLV='1'B×SELV='1'B THEN   /* OR SVC ALL OR SELECTIVE,      */
AMDPSUMM TM    ALLS(AEDITCBR),B'11000000'                          0257
         BNZ   @RT00257                                            0257
         TM    ALLI(AEDITCBR),B'11000000'                          0257
         BNZ   @RT00257                                            0257
         TM    ALLV(AEDITCBR),B'11000000'                          0257
         BNZ   @RT00257                                            0257
*     GOTO AMDPSUMN;                /* CONSTRUCT SUMMARY MESSAGE     */
*   IF ALLU='1'B×SELU='1'B          /* IF USR ALL OR SELECTIVE,      */
*       ×ALLP='1'B×SELP='1'B        /* OR PI ALL OR SELECTIVE,       */
*       ×EXT='1'B×DSP='1'B          /* OR EXT OR DSP,                */
*       ×SYS='1'B×RR='1'B           /* SYS OR RR               Y02014*/
*       ×RNIO='1'B×SRM='1'B THEN    /* RNIO OR SRM             Y02014*/
         TM    ALLU(AEDITCBR),B'11000000'                          0259
         BNZ   @RT00259                                            0259
         TM    ALLP(AEDITCBR),B'11000000'                          0259
         BNZ   @RT00259                                            0259
         TM    EXT(AEDITCBR),B'11101110'                           0259
         BNZ   @RT00259                                            0259
*     GOTO AMDPSUMN;                /* CONSTRUCT SUMMARY MESSAGE     */
*AMDSYSDF:                                                         0261
*   SYS='1'B;                       /* TURN ON SYSTEM ALL FLAG       */
AMDSYSDF DS    0H                                                  0262
*   SYSM='1'B;                      /* AND SYSM ALL FLAG             */
         OI    SYS(AEDITCBR),B'00110000'                           0262
*   ALLS='1'B;                      /* SYSTEM ALL FLAGS--SIO         */
         OI    ALLS(AEDITCBR),B'10000000'                          0263
*   ALLI='1'B;                      /* IO                            */
         OI    ALLI(AEDITCBR),B'10000000'                          0264
*   ALLV='1'B;                      /* SVC                           */
         OI    ALLV(AEDITCBR),B'10000000'                          0265
*   ALLP='1'B;                      /* PI                            */
         OI    ALLP(AEDITCBR),B'10000000'                          0266
*   EXT='1'B;                       /* EXT                           */
*   DSP='1'B;                       /* DSP                           */
*   RNIO='1'B;                      /* RNIO                    Y02014*/
*   SRM='1'B;                       /* SRM                     Y02014*/
*   RR='1'B;                        /* RR                      Y02014*/
         OI    EXT(AEDITCBR),B'11001110'                           0271
*   IF DDNAME=BLANK1 THEN           /* IF DUMP DATA SET        Y02014*/
         CLC   DDNAME(8,AEDITCBR),BLANK1(TTABPTR)                  0272
         BNE   @RF00272                                            0272
*     ALLU='1'B;                    /* SET ON USR=ALL IND      Y02014*/
         OI    ALLU(AEDITCBR),B'10000000'                          0273
*AMDPSUMN:                                                         0274
*   IF DDNAME=BLANK1 THEN           /* IF DUMP DATA SET        Y02014*/
@RF00272 DS    0H                                                  0274
AMDPSUMN CLC   DDNAME(8,AEDITCBR),BLANK1(TTABPTR)                  0274
         BNE   @RF00274                                            0274
*     DO;                                                          0275
*       STOPTIME=BLANK1;            /* BLANK STOP TIME         Y02014*/
         MVC   STOPTIME(12,AEDITCBR),BLANK1(TTABPTR)               0276
*       STARTIME=BLANK1;            /* BLANK START TIME        Y02014*/
         MVC   STARTIME(12,AEDITCBR),BLANK1(TTABPTR)               0277
*       GEN(OI    SWC,SEGRD);       /* INDICATE READ FOR EDIT BIT    */
         OI    SWC,SEGRD
*       GEN(NI SWC,255-EDITSW);     /* NO ADJUST NEEDED        Y02014*/
         NI SWC,255-EDITSW
*     END;                                                         0280
*   ELSE                                                           0281
*     GEN(BRREAD ADJUST);           /* FREE SPACE              Y02014*/
         B     @RC00274                                            0281
@RF00274 DS    0H                                                  0281
         BRREAD ADJUST
*   IF USEREXIT=BLANK1 THEN         /* NO USER EXIT            Y02014*/
@RC00274 CLC   USEREXIT(8,AEDITCBR),BLANK1(TTABPTR)                0282
         BNE   @RF00282                                            0282
*     EOF='0'B;                     /* NO EOF EXIT             Y02014*/
         NI    EOF(AEDITCBR),B'11111110'                           0283
*AMDPSUN1:                                                         0284
*   SYNMSGA=ADDR(AD11);             /* ADDRS OF ADDRS OF MESSAGE     */
@RF00282 DS    0H                                                  0284
AMDPSUN1 L     @14,@CA00319                                        0284
         LA    @14,AD11-AMDPRS00(,@14)                             0284
         ST    @14,SYNMSGA                                         0284
*   SUMSGBUF=ERRBUF;                /* MOVE MSG 11 INTO BUFFER       */
         L     @14,MSGADDR(,@14)                                   0285
         MVC   SUMSGBUF(80),ERRBUF(@14)                            0285
*   ADSUM=ADDR(SUMSGBUF);           /* HOLDS ADDRS OF SUM MSG BUF    */
         LA    @14,SUMSGBUF                                        0286
         ST    @14,ADSUM                                           0286
*   SYNMSGA=ADDR(ADSUM);            /* ADDRS OF ADDRS OF SUM MSG   0287
*                                      SIMULATED WTO LIST            */
         LA    @14,ADSUM                                           0287
         ST    @14,SYNMSGA                                         0287
*   SUMVAL=4+34;                    /* INITIALIZE MSG PTR--4 BYTES +
*                                      LENGTH OF MSG 11              */
         LA    SUMVAL,38                                           0288
*   RTDSCDES=SUMSGBUF(SUMVAL        /* SAVE ROUTER AND DESCRIPTOR    */
*       :SUMVAL+3);                 /* CODES                         */
         LA    @14,SUMSGBUF-1(SUMVAL)                              0289
         MVC   RTDSCDES(4),0(@14)                                  0289
*   SUMSGID=SUMSGBUF(5              /* SAVE MESSAGE ID               */
*       :12);                                                      0290
         MVC   SUMSGID(8),SUMSGBUF+4                               0290
*   PATHSW=0;                       /* NO KEYWORDS YET PROCESSED     */
         SLR   @14,@14                                             0291
         ST    @14,PATHSW                                          0291
*   IF USEREXIT=BLANK1 THEN         /* NO USER EXIT INFO TO          */
         CLC   USEREXIT(8,AEDITCBR),BLANK1(TTABPTR)                0292
         BE    @RT00292                                            0292
*     GOTO AMDPSUM2;                /* PRINT OUT                     */
*   NOWSW=1;                        /* KW TO BE PROCESSED            */
         LA    NOWSW,1                                             0294
*   SUMSGBUF(SUMVAL                 /* MOVE IN EXIT=                 */
*       :SUMVAL+4)=EXITCON;                                        0295
         LA    @14,SUMSGBUF-1(SUMVAL)                              0295
         MVC   0(5,@14),EXITCON                                    0295
*   SUMVAL=SUMVAL+5;                /* UPDATE BUFFER COUNT           */
         AL    SUMVAL,@CF00086                                     0296
*   VAL=8;                          /* LENGTH OF EXIT NAME           */
         MVC   VAL(4),@CF00033                                     0297
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0298
*AMDPSUM2:                                                         0299
*   IF DDNAME=BLANK1 THEN           /* NO DDNAME INFO TO PRINT       */
AMDPSUM2 CLC   DDNAME(8,AEDITCBR),BLANK1(TTABPTR)                  0299
         BE    @RT00299                                            0299
*     GOTO AMDPSUM3;                                               0300
*   NOWSW=2;                        /* KW TO BE PROCESSED            */
         LA    NOWSW,2                                             0301
*   VAL=15;                         /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00032                                     0302
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0303
*AMDPSUM3:                                                         0304
*   IF STARTIME=BLANK1 THEN         /* NO START TIME VALUE INFO      */
AMDPSUM3 CLC   STARTIME(12,AEDITCBR),BLANK1(TTABPTR)               0304
         BE    @RT00304                                            0304
*     GOTO AMDPSUM4;                /* TO PRINT OUT                  */
*   NOWSW=3;                        /* KW TO BE PROCESSED            */
         LA    NOWSW,3                                             0306
*   VAL=20;                         /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00130                                     0307
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0308
*AMDPSUM4:                                                         0309
*   IF STOPTIME=BLANK1 THEN         /* NO STOP TIME VALUE INFO       */
AMDPSUM4 CLC   STOPTIME(12,AEDITCBR),BLANK1(TTABPTR)               0309
         BE    @RT00309                                            0309
*     GOTO AMDPSUM5;                /* TO PRINT OUT                  */
*   NOWSW=4;                        /* KW TO BE PROCESSED            */
         LA    NOWSW,4                                             0311
*   VAL=19;                         /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00538                                     0312
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0313
*AMDPSUM5:                                                         0314
*   IF JOBNAMES(1)=BLANK1           /* NO JOBNAMES TO PRINT OUT      */
*     THEN                          /* SO                            */
AMDPSUM5 CLC   JOBNAMES(8,AEDITCBR),BLANK1(TTABPTR)                0314
         BE    @RT00314                                            0314
*     GOTO AMDPSUM6;                /* GO CHECK TCB ADDRESSES        */
*   NOWSW=5;                        /* KW TO BE PROCESSED            */
         LA    NOWSW,5                                             0316
*   VAL=18;                         /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00459                                     0317
*   JOBCT=1;                        /* INDEX INITIALIZED TO 1        */
         MVC   JOBCT(4),@CF00046                                   0318
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0319
*AMDPSUM6:                                                         0320
*   IF ASCBADDR(1)=0                /* NO ASCB ADDRS TO        Y02014*/
*     THEN                          /* PRINT SO                Y02014*/
AMDPSUM6 L     @14,ASCBADDR(,AEDITCBR)                             0320
         LTR   @14,@14                                             0320
         BZ    @RT00320                                            0320
*     GOTO AMDPSUM7;                /* GO CHECK SIOFLAGS             */
*   NOWSW=6;                        /* KW TO BE PROCESSED            */
         LA    NOWSW,6                                             0322
*   VAL=15;                         /* KW+VALUE LENGTH         Y02014*/
         MVC   VAL(4),@CF00032                                     0323
*   ASCBCT=1;                       /* INDEX INITIALIZED TO 1        */
         MVC   ASCBCT(4),@CF00046                                  0324
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0325
*AMDPSUM7:                                                         0326
*   IF ALLS='0'B                    /* NEITHER SIO=ALL               */
*       &SELS='0'B THEN             /* NOR SIO=SEL                   */
AMDPSUM7 TM    ALLS(AEDITCBR),B'11000000'                          0326
         BZ    @RT00326                                            0326
*     GOTO AMDPSUM8;                /* IN EFFECT                     */
*   NOWSW=7;                        /* KW TO BE PROCESSED            */
@RF00326 LA    NOWSW,7                                             0328
*   VAL=12;                         /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00075                                     0329
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0330
*AMDPSUM8:                                                         0331
*   IF ALLI='0'B                    /* NEITHER IO=ALL                */
*       &SELI='0'B THEN             /* NOR IO=SEL                    */
AMDPSUM8 TM    ALLI(AEDITCBR),B'11000000'                          0331
         BZ    @RT00331                                            0331
*     GOTO AMDPSUM9;                /* IN EFFECT                     */
*   NOWSW=8;                        /* KW TO BE PROCESSED            */
@RF00331 LA    NOWSW,8                                             0333
*   VAL=12;                         /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00075                                     0334
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0335
*AMDPSUM9:                                                         0336
*   IF ALLV='0'B                    /* NEITHER SVC=ALL               */
*       &SELV='0'B THEN             /* NOR SVC=SEL                   */
AMDPSUM9 TM    ALLV(AEDITCBR),B'11000000'                          0336
         BZ    @RT00336                                            0336
*     GOTO AMDPSUMA;                /* IN EFFECT                     */
*   NOWSW=9;                        /* KW TO BE PROCESSED            */
@RF00336 LA    @14,9                                               0338
         LR    NOWSW,@14                                           0338
*   VAL=9;                          /* KW+VALUE LENGTH               */
         ST    @14,VAL                                             0339
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0340
*AMDPSUMA:                                                         0341
*   IF ALLP='0'B                    /* NEITHER PI=ALL                */
*       &SELP='0'B THEN             /* NOR PI=SEL                    */
AMDPSUMA TM    ALLP(AEDITCBR),B'11000000'                          0341
         BZ    @RT00341                                            0341
*     GOTO AMDPSUMB;                /* IN EFFECT                     */
*   NOWSW=10;                       /* KW TO BE PROCESSED            */
@RF00341 LA    NOWSW,10                                            0343
*   VAL=8;                          /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00033                                     0344
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0345
*AMDPSUMB:                                                         0346
*   IF ALLU='0'B                    /* NEITHER USR=ALL               */
*       &SELU='0'B THEN             /* NOR USR=SEL                   */
AMDPSUMB TM    ALLU(AEDITCBR),B'11000000'                          0346
         BZ    @RT00346                                            0346
*     GOTO AMDPSUMC;                /* IN EFFECT                     */
*   NOWSW=11;                       /* KW TO BE PROCESSED            */
@RF00346 LA    NOWSW,11                                            0348
*   VAL=9;                          /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00167                                     0349
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0350
*AMDPSUMC:                                                         0351
*   IF EXT='0'B THEN                /* NO EXT INDICATION TO BE       */
AMDPSUMC TM    EXT(AEDITCBR),B'10000000'                           0351
         BZ    @RT00351                                            0351
*     GOTO AMDPSUMF;                /* PRINTED OUT             Y02014*/
*   NOWSW=12;                       /* KW TO BE PROCESSED            */
         LA    NOWSW,12                                            0353
*   VAL=3;                          /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00169                                     0354
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0355
*AMDPSUMF:                                                         0356
*   IF RNIO='0'B THEN               /* NO RNIO IND TO BE       Y02014*/
AMDPSUMF TM    RNIO(AEDITCBR),B'00001000'                          0356
         BZ    @RT00356                                            0356
*     GOTO AMDPSUMG;                /* PRINTED OUT             Y02014*/
*   NOWSW=15;                       /* KEYWD                   Y02014*/
         LA    NOWSW,15                                            0358
*   VAL=4;                          /* KW+VALUE LENGTH         Y02014*/
         MVC   VAL(4),@CF00099                                     0359
*   GOTO AMDPFIT;                   /* OVERFLOW LINE           Y02014*/
         B     AMDPFIT                                             0360
*AMDPSUMG:                                                         0361
*   IF SRM='0'B THEN                /* NO SRM IND TO BE        Y02014*/
AMDPSUMG TM    SRM(AEDITCBR),B'00000100'                           0361
         BZ    @RT00361                                            0361
*     GOTO AMDPSUMH;                /* PRINTED OUT             Y02014*/
*   NOWSW=16;                       /* KEYWORD                 Y02014*/
         LA    NOWSW,16                                            0363
*   VAL=3;                          /* KW+VALUE LENGTH         Y02014*/
         MVC   VAL(4),@CF00169                                     0364
*   GOTO AMDPFIT;                   /* OVERFLOW LINE           Y02014*/
         B     AMDPFIT                                             0365
*AMDPSUMH:                                                         0366
*   IF RR='0'B THEN                 /* NO RR IND TO BE         Y02014*/
AMDPSUMH TM    RR(AEDITCBR),B'00000010'                            0366
         BZ    @RT00366                                            0366
*     GOTO AMDPSUMI;                /* PRINTED OUT             Y02014*/
*   NOWSW=17;                       /* KEYWORD                 Y02014*/
         LA    NOWSW,17                                            0368
*   VAL=2;                          /* KW+VALUE LENGTH         Y02014*/
         MVC   VAL(4),@CF00078                                     0369
*   GOTO AMDPFIT;                   /* OVERFLOW LINE           Y02014*/
         B     AMDPFIT                                             0370
*AMDPSUMI:                                                         0371
*   IF EOF='0'B THEN                /* NO EOF IND TO BE        Y02014*/
AMDPSUMI TM    EOF(AEDITCBR),B'00000001'                           0371
         BZ    @RT00371                                            0371
*     GOTO AMDPSUMD;                /* PRINTED OUT             Y02014*/
*   NOWSW=18;                       /* KEYWORD                 Y02014*/
         LA    NOWSW,18                                            0373
*   VAL=8;                          /* KW+VALUE LENGTH         Y02014*/
         MVC   VAL(4),@CF00033                                     0374
*   GOTO AMDPFIT;                   /* OVERFLOW LINE           Y02014*/
         B     AMDPFIT                                             0375
*AMDPSUMD:                                                         0376
*   IF DSP='0'B THEN                /* NO DSP INDICATION TO BE       */
AMDPSUMD TM    DSP(AEDITCBR),B'01000000'                           0376
         BZ    @RT00376                                            0376
*     GOTO AMDPSUME;                /* PRINTED OUT                   */
*   NOWSW=13;                       /* KW TO BE PROCESSED            */
         LA    NOWSW,13                                            0378
*   VAL=3;                          /* KW+VALUE LENGTH               */
         MVC   VAL(4),@CF00169                                     0379
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0380
*AMDPSUME:                                                         0381
*   IF PATHSW=0 THEN                /* IF NO PORTION OF LINE LEFT    */
AMDPSUME L     @14,PATHSW                                          0381
         LTR   @14,@14                                             0381
         BZ    @RT00381                                            0381
*     GOTO AMDPNOWE;                /* TO WRITE OUT, RETURN          */
*   NOWSW=14;                       /* PROCESSING TO BE DONE         */
         LA    NOWSW,14                                            0383
*   GOTO AMDPLNMG;                  /* WRITE OUT LINE PORTION        */
*                                                                  0384
         B     AMDPLNMG                                            0384
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE DETERMINES 1) WHEN BLANKS SHOULD BE SUP-      */
*   /* PRESSED AT THE END OF A VALUE- 2) WHEN A COMMA IS NEEDED      */
*   /* FOLLOWING A KEYWORD OR VALUE- 2) WHEN A RIGHT PARENTHE- SIS IS*/
*   /* NEEDED TO COMPLETE A LINE- 3) AND TO WHICH PROCESSING         */
*   /* SUBROUTINE TO BRANCH. OUTPUTTING OF LINES OF SUMMARY MESSAGE  */
*   /* IS ACCOMPLISHED HERE.                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0385
*AMDPFIT:                                                          0385
*   IF NOWSW=1 THEN                 /* IF PROCESSING EXIT NAME,      */
AMDPFIT  C     NOWSW,@CF00046                                      0385
         BNE   @RF00385                                            0385
*     DO;                           /* THEN DO THE FOLLOWING         */
*       COMP8=USEREXIT;             /* MOVE EXIT NM INTO COMPAREA    */
         MVC   COMP8(8,TTABPTR),USEREXIT(AEDITCBR)                 0387
*       GOTO BLNKLAB;               /* CALCULATE # BLANKS IN VAL     */
         B     BLNKLAB                                             0388
*     END;                                                         0389
*   IF NOWSW=2 THEN                 /* IF PROCESSING DDNAME, THEN    */
@RF00385 C     NOWSW,@CF00078                                      0390
         BNE   @RF00390                                            0390
*     DO;                           /* DO THE FOLLOWING              */
*       COMP8=DDNAME;               /* MOVE DDNAME INTO COMPAREA     */
         MVC   COMP8(8,TTABPTR),DDNAME(AEDITCBR)                   0392
*       GOTO BLNKLAB;               /* CALCULATE # BLNKS IN VAL      */
         B     BLNKLAB                                             0393
*     END;                                                         0394
*   IF NOWSW^=5 THEN                /* IF NOT PROCESSING JOBNS,      */
@RF00390 C     NOWSW,@CF00086                                      0395
         BNE   @RT00395                                            0395
*     GOTO CKPATH;                  /* CONTINUE NORMAL PROCS'ING     */
*   COMP8=JOBNAMES(JOBCT);          /* MOVE JOBNAME INTO COMPAREA    */
*                                                                  0397
         L     @14,JOBCT                                           0397
         SLA   @14,3                                               0397
         ALR   @14,AEDITCBR                                        0397
         MVC   COMP8(8,TTABPTR),JOBNAMES-8(@14)                    0397
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE NUMBER OF BLANKS IN SLOT AND ADJUST 'VAL'.          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0398
*BLNKLAB:                                                          0398
*   DO I=2 TO 8 BY 1;               /* LOOP THROUGH VALUE            */
BLNKLAB  LA    @14,2                                               0398
         ST    @14,I(,TTABPTR)                                     0398
@DL00398 DS    0H                                                  0399
*     IF COMP8(I)=' ' THEN          /* IF CHAR SLOT IS BLANK,        */
         L     @14,I(,TTABPTR)                                     0399
         ALR   @14,TTABPTR                                         0399
         CLI   COMP8-1(@14),C' '                                   0399
         BE    @RT00399                                            0399
*       GOTO CALC;                  /* ADJUST VALUE LENGTH           */
*   END;                                                           0401
         LA    @14,1                                               0401
         AL    @14,I(,TTABPTR)                                     0401
         ST    @14,I(,TTABPTR)                                     0401
         C     @14,@CF00033                                        0401
         BNH   @DL00398                                            0401
*CALC:                                                             0402
*   VAL=VAL-(9-I);                  /* ADJUST VALUE LENGTH           */
CALC     L     @14,I(,TTABPTR)                                     0402
         SL    @14,@CF00167                                        0402
         AL    @14,VAL                                             0402
         ST    @14,VAL                                             0402
*CKPATH:                                                           0403
*   IF PATHSW=0 THEN                /* IF NO PORTION OF LINE LEFT    */
CKPATH   L     @14,PATHSW                                          0403
         LTR   @14,@14                                             0403
         BNZ   @RF00403                                            0403
*     GOTO BRNWTAB(NOWSW);          /* TO BE WRITTEN, BRANCH TO    0404
*                                      APPROPRIATE KEYWORD     SUBRTN*/
         LR    @14,NOWSW                                           0404
         SLA   @14,2                                               0404
         L     @14,BRNWTAB-4(@14)                                  0404
         BR    @14                                                 0404
*   IF SUMVAL+VAL>71 THEN           /* Q/WILL VALUE OVERFLOW LINE    */
@RF00403 LR    @14,SUMVAL                                          0405
         AL    @14,VAL                                             0405
         C     @14,@CF00576                                        0405
         BH    @RT00405                                            0405
*     GOTO AMDPNPRN;                /* YES                           */
*   SUMSGBUF(SUMVAL)=',';           /* NO, INSERT COMMA FOLLOWING  0407
*                                      LAST KEYWORD OR VALUE         */
         LA    @14,SUMSGBUF-1(SUMVAL)                              0407
         MVI   0(@14),C','                                         0407
*   SUMVAL=SUMVAL+1;                /* ADD ONE FOR COMMA             */
         AL    SUMVAL,@CF00046                                     0408
*   GOTO BRNWTAB(NOWSW);            /* BRANCH TO APPROPRIATE KEYWORD
*                                      SUBROUTINE                    */
         LR    @14,NOWSW                                           0409
         SLA   @14,2                                               0409
         L     @14,BRNWTAB-4(@14)                                  0409
         BR    @14                                                 0409
*AMDPNPRN:                                                         0410
*   IF PRNSW='1'B THEN              /* Q/RIGHT PAREN NEEDED          */
AMDPNPRN TM    PRNSW(TTABPTR),B'00000100'                          0410
         BNO   @RF00410                                            0410
*     DO;                           /* YES                           */
*       SUMSGBUF(SUMVAL)            /* INSERT RIGHT PAREN            */
*           =')';                                                  0412
         LA    @14,SUMSGBUF-1(SUMVAL)                              0412
         MVI   0(@14),C')'                                         0412
*       SUMVAL=SUMVAL               /* ADD ONE FOR RIGHT PAREN       */
*           +1;                                                    0413
         AL    SUMVAL,@CF00046                                     0413
*     END;                                                         0414
*AMDPLNMG:                                                         0415
*   SUMSGBUF(1:2)                   /* INSERT MSG LNGTH INTO WTO     */
*       =SUMVAL-1;                  /* LIST SIMULATION               */
@RF00410 DS    0H                                                  0415
AMDPLNMG LR    @14,SUMVAL                                          0415
         BCTR  @14,0                                               0415
         STCM  @14,3,SUMSGBUF                                      0415
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE ROUTER/DESCRIPTOR        */
*       +3)=RTDSCDES;               /* CODES IN FOLLOWING MSG        */
         LA    @14,SUMSGBUF-1(SUMVAL)                              0416
         MVC   0(4,@14),RTDSCDES                                   0416
*   GNOSTDMG='1'B;                  /* PREDEDING SYNTAX MESSAGE NOT
*                                      TO BE OUTPUTTED               */
         OI    GNOSTDMG,B'00010000'                                0417
*   CALL AMDPRSYN;                  /* OUTPUT SUMMARY LINE           */
         L     @15,ASYNTAX                                         0418
         BALR  @14,@15                                             0418
*   SUMSGBUF(5:12)                  /* MOVE MSG ID INTO BEGNING      */
*       =SUMSGID;                   /* OF MESSAGE                    */
         MVC   SUMSGBUF+4(8),SUMSGID                               0419
*   SUMSGBUF(13)=' ';               /* BEGIN BLANKING BUFR M1738     */
         MVI   SUMSGBUF+12,C' '                                    0420
*   SUMSGBUF(14:SUMVAL)             /* BLANK REST OF BUFR M1738      */
*       =SUMSGBUF(14:SUMVAL-1);     /* M1738                         */
         LR    @14,SUMVAL                                          0421
         SL    @14,@CF00378                                        0421
         MVC   @TS00001(80),SUMSGBUF+13                            0421
         EX    @14,@SM00678                                        0421
*   SUMVAL=4+9;                     /* RE-INITIALIZE BUFFER CNT TO 0422
*                                      BEYOND MESSAGE ID             */
         LA    SUMVAL,13                                           0422
*   PATHSW=0;                       /* NO DATA IN LINE TO OUTPUT     */
         SLR   @14,@14                                             0423
         ST    @14,PATHSW                                          0423
*   PRNSW='0'B;                     /* TURN OFF PAREN NEEDED SW      */
         NI    PRNSW(TTABPTR),B'11111011'                          0424
*   GOTO BRNWTAB(NOWSW);            /* BRANCH TO APPROPRIATE KEYWORD
*                                      SUBROUTINE                    */
         LR    @14,NOWSW                                           0425
         SLA   @14,2                                               0425
         L     @14,BRNWTAB-4(@14)                                  0425
         BR    @14                                                 0425
*AMDPNOW1:                                                         0426
*   PATHSW=1;                       /* EXIT NAME BEING PROCESSED     */
AMDPNOW1 MVC   PATHSW(4),@CF00046                                  0426
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'EXIT='               */
*       +VAL-1)=USEREXIT;                                          0427
         LA    @14,SUMSGBUF-1(SUMVAL)                              0427
         L     @10,VAL                                             0427
         LR    @06,@10                                             0427
         BCTR  @06,0                                               0427
         EX    @06,@SM00681                                        0427
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER COUNT           */
         ALR   SUMVAL,@10                                          0428
*   GOTO AMDPSUM2;                  /* CHECK DDNAME SLOT             */
         B     AMDPSUM2                                            0429
*AMDPNOW2:                                                         0430
*   PATHSW=2;                       /* DDNAME BEING PROCESSED        */
AMDPNOW2 MVC   PATHSW(4),@CF00078                                  0430
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'DDNAME='             */
*       +6)=DDCON;                                                 0431
         LA    @14,SUMSGBUF-1(SUMVAL)                              0431
         MVC   0(7,@14),DDCON                                      0431
*   SUMSGBUF(SUMVAL+7               /* MOVE IN DDNAME                */
*       :SUMVAL+VAL-1)=DDNAME;                                     0432
         LA    @14,SUMSGBUF+6(SUMVAL)                              0432
         L     @10,VAL                                             0432
         LR    @06,@10                                             0432
         SL    @06,@CF00033                                        0432
         EX    @06,@SM00683                                        0432
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER COUNT           */
         ALR   SUMVAL,@10                                          0433
*   GOTO AMDPSUM3;                  /* CHECK START VALUE SLOT        */
         B     AMDPSUM3                                            0434
*AMDPNOW3:                                                         0435
*   PATHSW=3;                       /* START BEING PROCESSED         */
AMDPNOW3 MVC   PATHSW(4),@CF00169                                  0435
*   WORD=0;                         /* INITIALIZE W A TO 0           */
         SLR   @14,@14                                             0436
         ST    @14,WORD(,TTABPTR)                                  0436
*   RFY                                                            0437
*    (REG4,                                                        0437
*     REG5,                                                        0437
*     REG6) RSTD;                   /* NEED WORK REGISTERS     Y02014*/
*   REG4=ADDR(INTSTART);            /* ADDRESS INT START SLOT        */
         LA    REG4,INTSTART(,TTABPTR)                             0438
*   REG5=ADDR(COMP4);               /* ADDRS CHARACTER WORK AREA     */
         LA    REG5,COMP4(,TTABPTR)                                0439
*   GENERATE;                                                      0440
*                                       /* MAKE PRINTABLE TIME VALUE */
         UNPK  0(4,R5),0(2,R4)          CONVERT DDD TO PRINTABLE FMT
         MVC   STARTFIL+1(3),1(R5)    MOVE DDD TO OUTPUT
*   WORD=INTSTART(3);               /* PLACE HH ON WORD BDY          */
         SLR   @14,@14                                             0441
         IC    @14,INTSTART+2(,TTABPTR)                            0441
         ST    @14,WORD(,TTABPTR)                                  0441
*   REG6=ADDR(STARTFIL)+5;          /* LOCATION IN OUTPUT            */
         LA    REG6,STARTFIL                                       0442
         AL    REG6,@CF00086                                       0442
*   CALL AMDPRNT;                   /* HAVE CONVERSION DONE          */
         BAL   @14,AMDPRNT                                         0443
*   WORD=INTSTART(4);               /* PLACE MM ON WORD BDY          */
         SLR   @14,@14                                             0444
         IC    @14,INTSTART+3(,TTABPTR)                            0444
         ST    @14,WORD(,TTABPTR)                                  0444
*   REG6=ADDR(STARTFIL)+8;          /* LOCATION IN OUTPUT            */
         LA    REG6,STARTFIL                                       0445
         AL    REG6,@CF00033                                       0445
*   CALL AMDPRNT;                   /* HAVE CONVERSION DONE          */
         BAL   @14,AMDPRNT                                         0446
*   WORD=INTSTART(5);               /* PLACE SS ON WORD BDY          */
         SLR   @14,@14                                             0447
         IC    @14,INTSTART+4(,TTABPTR)                            0447
         ST    @14,WORD(,TTABPTR)                                  0447
*   REG6=ADDR(STARTFIL)+11;         /* LOCATION IN OUTPUT            */
         LA    REG6,STARTFIL                                       0448
         AL    REG6,@CF00034                                       0448
*   CALL AMDPRNT;                   /* HAVE CONVERSION DONE          */
         BAL   @14,AMDPRNT                                         0449
*   RFY                                                            0450
*    (REG4,                                                        0450
*     REG5,                                                        0450
*     REG6) UNRSTD;                 /* RELEASE WORK REGISTERS        */
*   SUMSGBUF(SUMVAL:SUMVAL+         /* MOVE IN 'START='              */
*       5)=STARTCON;                                               0451
         LA    @14,SUMSGBUF-1(SUMVAL)                              0451
         MVC   0(6,@14),STARTCON                                   0451
*   SUMSGBUF(SUMVAL+6:SUMVAL        /* MOVE IN START VALUE           */
*       +19)=STARTFIL;                                             0452
         LA    @14,SUMSGBUF+5(SUMVAL)                              0452
         MVC   0(14,@14),STARTFIL                                  0452
*   ESDAY=STARTFIL(2:4);            /* SAVE DAY VALUE                */
         MVC   ESDAY(3,AEDITCBR),STARTFIL+1                        0453
*   ESHR=STARTFIL(6:7);             /* SAVE HOURS                    */
         MVC   ESHR(2,AEDITCBR),STARTFIL+5                         0454
*   ESMIN=STARTFIL(9:10);           /* SAVE MINUTES                  */
         MVC   ESMIN(2,AEDITCBR),STARTFIL+8                        0455
*   ESSEC=STARTFIL(12:13);          /* SAVE SECONDS                  */
         MVC   ESSEC(2,AEDITCBR),STARTFIL+11                       0456
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER COUNT           */
         AL    SUMVAL,VAL                                          0457
*   GOTO AMDPSUM4;                  /* CHECK STOP VALUE SLOT         */
         B     AMDPSUM4                                            0458
*AMDPNOW4:                                                         0459
*   PATHSW=4;                       /* STOP BEING PROCESSED          */
AMDPNOW4 MVC   PATHSW(4),@CF00099                                  0459
*   WORD=0;                         /* INITIALIZE W A TO 0           */
         SLR   @14,@14                                             0460
         ST    @14,WORD(,TTABPTR)                                  0460
*   RFY                                                            0461
*    (REG4,                                                        0461
*     REG5,                                                        0461
*     REG6) RSTD;                   /* NEED WORK REGISTERS     Y02014*/
*   REG4=ADDR(INTSTOP);             /* ADDRS CHARACTER STOP SLOT     */
         LA    REG4,INTSTOP(,TTABPTR)                              0462
*   REG5=ADDR(COMP4);               /* ADDRS CHARACTER WORK AREA     */
         LA    REG5,COMP4(,TTABPTR)                                0463
*   GENERATE;                                                      0464
         UNPK  0(4,R5),0(2,R4)          CONVERT DDD TO PRINTABLE FMT
         MVC   STOPFIL+1(3),1(R5)     MOVE DDD TO OUTPUT
*   WORD=INTSTOP(3);                /* PLACE HH ON WORD BDY          */
         SLR   @14,@14                                             0465
         IC    @14,INTSTOP+2(,TTABPTR)                             0465
         ST    @14,WORD(,TTABPTR)                                  0465
*   REG6=ADDR(STOPFIL)+5;           /* ADDRS OUTPUT AREA             */
         LA    REG6,STOPFIL                                        0466
         AL    REG6,@CF00086                                       0466
*   CALL AMDPRNT;                   /* HAVE CONVERSION DONE          */
         BAL   @14,AMDPRNT                                         0467
*   WORD=INTSTOP(4);                /* PLACE MM ON WORD BDY          */
         SLR   @14,@14                                             0468
         IC    @14,INTSTOP+3(,TTABPTR)                             0468
         ST    @14,WORD(,TTABPTR)                                  0468
*   REG6=ADDR(STOPFIL)+8;           /* ADDRS OUTPUT AREA             */
         LA    REG6,STOPFIL                                        0469
         AL    REG6,@CF00033                                       0469
*   CALL AMDPRNT;                   /* HAVE CONVERSION DONE          */
         BAL   @14,AMDPRNT                                         0470
*   WORD=INTSTOP(5);                /* PLACE SS ON WORD BDY          */
         SLR   @14,@14                                             0471
         IC    @14,INTSTOP+4(,TTABPTR)                             0471
         ST    @14,WORD(,TTABPTR)                                  0471
*   REG6=ADDR(STOPFIL)+11;          /* ADDRS OUTPUT AREA             */
         LA    REG6,STOPFIL                                        0472
         AL    REG6,@CF00034                                       0472
*   CALL AMDPRNT;                   /* HAVE CONVERSION DONE          */
         BAL   @14,AMDPRNT                                         0473
*   RFY                                                            0474
*    (REG4,                                                        0474
*     REG5,                                                        0474
*     REG6) UNRSTD;                 /* RELEASE WORK REGS       Y02014*/
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'STOP='               */
*       +4)=STOPCON;                                               0475
         LA    @14,SUMSGBUF-1(SUMVAL)                              0475
         MVC   0(5,@14),STOPCON                                    0475
*   SUMSGBUF(SUMVAL+5:SUMVAL        /* MOVE IN STOP VALUE            */
*       +18)=STOPFIL;                                              0476
         LA    @14,SUMSGBUF+4(SUMVAL)                              0476
         MVC   0(14,@14),STOPFIL                                   0476
*   ESPDAY=STOPFIL(2:4);            /* SAVE DAY STOP VALUE           */
         MVC   ESPDAY(3,AEDITCBR),STOPFIL+1                        0477
*   ESPHR=STOPFIL(6:7);             /* SAVE HOUR                     */
         MVC   ESPHR(2,AEDITCBR),STOPFIL+5                         0478
*   ESPMIN=STOPFIL(9:10);           /* SAVE MIN                      */
         MVC   ESPMIN(2,AEDITCBR),STOPFIL+8                        0479
*   ESPSEC=STOPFIL(12:13);          /* SAVE SEC                      */
         MVC   ESPSEC(2,AEDITCBR),STOPFIL+11                       0480
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER CHAR COUNT      */
         AL    SUMVAL,VAL                                          0481
*   GOTO AMDPSUM5;                  /* CHECK FOR JOBNAMES            */
         B     AMDPSUM5                                            0482
*AMDPNOW5:                                                         0483
*   IF JOBCT=1 THEN                 /* Q/FIRST TIME THROUGH          */
AMDPNOW5 CLC   JOBCT(4),@CF00046                                   0483
         BE    @RT00483                                            0483
*     GOTO AMDPNW51;                /* YES                           */
*   IF PATHSW=0 THEN                /* Q/LINE JUST OUTPUTTED         */
         L     @14,PATHSW                                          0485
         LTR   @14,@14                                             0485
         BNZ   @RF00485                                            0485
*     DO;                           /* IF YES, DO THE FOLLOWING      */
*       VAL=VAL+10;                 /* ALLOW FOR JOBN PREFIX         */
         LA    @14,10                                              0487
         AL    @14,VAL                                             0487
         ST    @14,VAL                                             0487
*       GOTO AMDPNW51;              /* CONTINUE ON                   */
         B     AMDPNW51                                            0488
*     END;                                                         0489
*   SUMSGBUF(SUMVAL:SUMVAL          /* INSERT JOBNAME INTO OUTPUT    */
*       +VAL-1)=JOBNAMES(JOBCT);                                   0490
@RF00485 LA    @14,SUMSGBUF-1(SUMVAL)                              0490
         L     @10,VAL                                             0490
         BCTR  @10,0                                               0490
         L     @06,JOBCT                                           0490
         SLA   @06,3                                               0490
         ALR   @06,AEDITCBR                                        0490
         EX    @10,@SM00685                                        0490
*   GOTO AMDPNW52;                  /* LOOK FOR ADDITIONAL JOBNS     */
         B     AMDPNW52                                            0491
*AMDPNW51:                                                         0492
*   PATHSW=5;                       /* JOBNAMES BEING PROCESSED      */
AMDPNW51 MVC   PATHSW(4),@CF00086                                  0492
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'JOBNAMES=('          */
*       +9)=JOBCON;                                                0493
         LA    @14,SUMSGBUF-1(SUMVAL)                              0493
         MVC   0(10,@14),JOBCON                                    0493
*   SUMSGBUF(SUMVAL+10:SUMVAL       /* MOVE IN JOBNAME               */
*       +VAL-1)=JOBNAMES(JOBCT);                                   0494
         LA    @14,SUMSGBUF+9(SUMVAL)                              0494
         L     @10,VAL                                             0494
         SL    @10,@CF00034                                        0494
         L     @06,JOBCT                                           0494
         SLA   @06,3                                               0494
         ALR   @06,AEDITCBR                                        0494
         EX    @10,@SM00685                                        0494
*AMDPNW52:                                                         0495
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER CHAR COUNT      */
AMDPNW52 AL    SUMVAL,VAL                                          0495
*   JOBCT=JOBCT+1;                  /* UPDATE JOBNAME COUNT          */
         LA    @14,1                                               0496
         AL    @14,JOBCT                                           0496
         ST    @14,JOBCT                                           0496
*   IF JOBCT>5 THEN                 /* Q/ALL JOBNAMES OUTPUTTED      */
         C     @14,@CF00086                                        0497
         BH    @RT00497                                            0497
*     GOTO AMDPNW53;                /* YES                           */
*   IF JOBNAMES(JOBCT)=BLANK1       /* IF NO MORE JOBNAMES,          */
*     THEN                          /* THEN                          */
         SLA   @14,3                                               0499
         ALR   @14,AEDITCBR                                        0499
         CLC   JOBNAMES-8(8,@14),BLANK1(TTABPTR)                   0499
         BE    @RT00499                                            0499
*     GOTO AMDPNW53;                /* FINISH VALUE INSERTION        */
*   PRNSW='1'B;                     /* MORE JOBNS/ WILL NEED ')'     */
         OI    PRNSW(TTABPTR),B'00000100'                          0501
*   VAL=8;                          /* NEED ONLY JOBN, NOT PREFIX    */
         MVC   VAL(4),@CF00033                                     0502
*   GOTO AMDPFIT;                   /* Q/WILL VALUE OVERFLOW LINE    */
         B     AMDPFIT                                             0503
*AMDPNW53:                                                         0504
*   SUMSGBUF(SUMVAL)=')';           /* INSERT RIGHT PARENTHESIS      */
AMDPNW53 LA    @14,SUMSGBUF-1(SUMVAL)                              0504
         MVI   0(@14),C')'                                         0504
*   PRNSW='0'B;                     /* PARENS ALREADY INSERTED       */
         NI    PRNSW(TTABPTR),B'11111011'                          0505
*   SUMVAL=SUMVAL+1;                /* UPDATE BUFFER CHAR COUNT      */
         AL    SUMVAL,@CF00046                                     0506
*   GOTO AMDPSUM6;                  /* GO CHECK ASCB ADDRESSES       */
         B     AMDPSUM6                                            0507
*AMDPNOW6:                                                         0508
*   IF ASCBCT=1 THEN                /* Q/FIRST TIME THRU       Y02014*/
AMDPNOW6 CLC   ASCBCT(4),@CF00046                                  0508
         BE    @RT00508                                            0508
*     GOTO AMDPNW61;                /* YES                           */
*   IF PATHSW=0 THEN                /* Q/LINE JUST OUTPUTTED         */
         L     @14,PATHSW                                          0510
         LTR   @14,@14                                             0510
         BNZ   @RF00510                                            0510
*     DO;                           /* IF YES, DO THE FOLLOWING      */
*       VAL=VAL+7;                  /* ALLOW FOR ASCB PREFIX   Y02014*/
         LA    @14,7                                               0512
         AL    @14,VAL                                             0512
         ST    @14,VAL                                             0512
*       GOTO AMDPNW62;              /* CONTINUE ON                   */
         B     AMDPNW62                                            0513
*     END;                                                         0514
*   SUMSGBUF(SUMVAL:SUMVAL          /* INSERT ASCB ADDRS FROM WORK   */
*       +7)=DBLWORD                 /* AREA INTO SUMMARY MESSAGE     */
*       (1:8);                      /* BUFFER                  Y02014*/
@RF00510 LA    @14,SUMSGBUF-1(SUMVAL)                              0515
         MVC   0(8,@14),DBLWORD(TTABPTR)                           0515
*   GOTO AMDPNW63;                  /* LOOK FOR ADDITIONAL ADDRS     */
*                                                                  0516
         B     AMDPNW63                                            0516
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT 4-BYTE ADDRESS TO PRINTABLE FORMAT, USING AMDPRDMP    */
*   /* SERVICE ROUTINE                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0517
*AMDPNW61:                                                         0517
*   REG1=ADDR(AADS(ASCBCT));        /* PICK UP ADDRS OF ASCB   Y02014*/
AMDPNW61 L     @14,ASCBCT                                          0517
         SLA   @14,2                                               0517
         LA    REG1,AADS-4(@14,AEDITCBR)                           0517
*   RFY                                                            0518
*    (REG4) RSTD;                   /* NEED REGISTER 4         Y02014*/
*   REG4=ADDR(DBLWORD);             /* PICK UP ADDRS OF OUTPUT AREA  */
         LA    REG4,DBLWORD(,TTABPTR)                              0519
*   CALL CNVTRTN2;                  /* HAVE ADDRS CONVERTED    Y02014*/
         L     @15,AWRDCNVT                                        0520
         BALR  @14,@15                                             0520
*   RFY                                                            0521
*    (REG4) UNRSTD;                 /* FINISHED WITH REG 4     Y02014*/
*   IF PRNSW='1'B THEN              /* IF CONVERSION RTN ENTERED     */
         TM    PRNSW(TTABPTR),B'00000100'                          0522
         BO    @RT00522                                            0522
*     GOTO AMDPFIT;                 /* BETWEEN VALUES, GO TO RTN THAT
*                                      DETERMINES IF VALUE WILL    0523
*                                      OVERFLOW CURRENT LINE         */
*AMDPNW62:                                                         0524
*   PATHSW=6;                       /* ASCB ADDR BEING PROCESSED     */
AMDPNW62 MVC   PATHSW(4),@CF00110                                  0524
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'ASCBS=('       Y02014*/
*       +6)=ASCBCON;                                               0525
         LA    @14,SUMSGBUF-1(SUMVAL)                              0525
         MVC   0(7,@14),ASCBCON                                    0525
*   SUMSGBUF(SUMVAL+7:SUMVAL        /* INSERT ASCB ADDRS       Y02014*/
*       +14)=DBLWORD                /* AREA INTO SUMMARY MESSAGE     */
*       (1:8);                      /* BUFFER                  Y02014*/
         LA    @14,SUMSGBUF+6(SUMVAL)                              0526
         MVC   0(8,@14),DBLWORD(TTABPTR)                           0526
*AMDPNW63:                                                         0527
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER CHAR COUNT      */
AMDPNW63 AL    SUMVAL,VAL                                          0527
*   ASCBCT=ASCBCT+1;                /* UPDTE ASCB ADDR CNT     Y02014*/
         LA    @14,1                                               0528
         AL    @14,ASCBCT                                          0528
         ST    @14,ASCBCT                                          0528
*   IF ASCBCT>5 THEN                /* Q/ALL ASCB ADDRS OUTPUTTED    */
         C     @14,@CF00086                                        0529
         BH    @RT00529                                            0529
*     GOTO AMDPNW64;                /* YES                     Y02014*/
*   IF ASCBADDR(ASCBCT)=0           /* NO MORE ASCB ADDRS,     Y02014*/
*     THEN                          /* THEN                          */
         SLA   @14,2                                               0531
         L     @14,ASCBADDR-4(@14,AEDITCBR)                        0531
         LTR   @14,@14                                             0531
         BZ    @RT00531                                            0531
*     GOTO AMDPNW64;                /* FINISH VALUE INSERTION        */
*   PRNSW='1'B;                     /* MORE ADDRS- WILL NEED ')'     */
         OI    PRNSW(TTABPTR),B'00000100'                          0533
*   VAL=8;                          /* NEED ONLY ADDR, NOT PREFIX  0534
*                                                              Y02014*/
         MVC   VAL(4),@CF00033                                     0534
*   GOTO AMDPNW61;                  /* CONVERT ADDR TO WORK AREA     */
         B     AMDPNW61                                            0535
*AMDPNW64:                                                         0536
*   SUMSGBUF(SUMVAL)=')';           /* INSERT RIGHT PARENTHESIS      */
AMDPNW64 LA    @14,SUMSGBUF-1(SUMVAL)                              0536
         MVI   0(@14),C')'                                         0536
*   PRNSW='0'B;                     /* PARENS ALREADY INSERTED       */
         NI    PRNSW(TTABPTR),B'11111011'                          0537
*   SUMVAL=SUMVAL+1;                /* ALLOW FOR RIGHT PAREN         */
         AL    SUMVAL,@CF00046                                     0538
*   GOTO AMDPSUM7;                  /* CHECK SIOFLGS                 */
         B     AMDPSUM7                                            0539
*AMDPNOW7:                                                         0540
*   PATHSW=7;                       /* SIO BEING PROCESSED           */
AMDPNOW7 MVC   PATHSW(4),@CF00035                                  0540
*   IF NOEQU='1'B THEN              /* Q/SIO-10 EQUIV NOT PERMITD    */
         TM    NOEQU(AEDITCBR),B'00010000'                         0541
         BO    @RT00541                                            0541
*     GOTO AMDPNW71;                /* YES--NOT PERMITTED            */
*   IF EQUIV='1'B THEN              /* IF SIO=I0, THEN               */
         TM    EQUIV(AEDITCBR),B'00100000'                         0543
         BO    @RT00543                                            0543
*     GOTO AMDPNOW8;                /* GO TO IO PROCESSING RTN       */
*AMDPNW71:                                                         0545
*   IF ALLS='1'B THEN               /* IF SIO=ALL                    */
AMDPNW71 TM    ALLS(AEDITCBR),B'10000000'                          0545
         BNO   @RF00545                                            0545
*     DO;                           /* DO THE FOLLOWING              */
*       SUMSGBUF(SUMVAL:SUMVAL      /* MOVE IN 'SIO=''ALL'''         */
*           +8)=SIOCON1;                                           0547
         LA    @14,SUMSGBUF-1(SUMVAL)                              0547
         MVC   0(9,@14),SIOCON1                                    0547
*AMDPNW72:                                                         0548
*       SUMVAL=SUMVAL+9;            /* UPDATE BUFFER CHAR COUNT HAVE
*                                      USED FEWER CHARS THAN       0548
*                                      PREVIOUSLY DEFINED VAL        */
AMDPNW72 AL    SUMVAL,@CF00167                                     0548
*       GOTO AMDPSUM8;              /* CHECK IOFLGS                  */
         B     AMDPSUM8                                            0549
*     END;                          /* SIO=ALL OR SEL INDICATED      */
*   SUMSGBUF(SUMVAL:SUMVAL          /* SIO=SEL INDICATED             */
*       +8)=SIOCON2;                                               0551
@RF00545 LA    @14,SUMSGBUF-1(SUMVAL)                              0551
         MVC   0(9,@14),SIOCON2                                    0551
*   GOTO AMDPNW72;                  /* UPDATE COUNT & CHK IOFLGS     */
         B     AMDPNW72                                            0552
*AMDPNOW8:                                                         0553
*   PATHSW=8;                       /* IO BEING PROCESSED            */
AMDPNOW8 MVC   PATHSW(4),@CF00033                                  0553
*   IF NOEQU='1'B THEN              /* Q/SIO-I0 EQUIV NOT PERMITD    */
         TM    NOEQU(AEDITCBR),B'00010000'                         0554
         BO    @RT00554                                            0554
*     GOTO AMDPNW82;                /* YES--NOT PERMITTED            */
*   IF EQUIV='0'B THEN              /* DO NOT HAVE SIO-I0            */
         TM    EQUIV(AEDITCBR),B'00100000'                         0556
         BZ    @RT00556                                            0556
*     GOTO AMDPNW82;                /* EQUIVALENCE                   */
*   IF ALLI='1'B THEN               /* IF IO=SIO=ALL, THEN           */
         TM    ALLI(AEDITCBR),B'10000000'                          0558
         BNO   @RF00558                                            0558
*     DO;                           /* DO THE FOLLOWING              */
*       SUMSGBUF(SUMVAL:SUMVAL      /* MOVE IN 'IO=SIO=''ALL'''      */
*           +11)=IOEQU1;                                           0560
         LA    @14,SUMSGBUF-1(SUMVAL)                              0560
         MVC   0(12,@14),IOEQU1                                    0560
*AMDPNW81:                                                         0561
*       SUMVAL=SUMVAL+VAL;          /* UPDATE BUFFER CHAR COUNT      */
AMDPNW81 AL    SUMVAL,VAL                                          0561
*       GOTO AMDPSUM9;              /* CHECK SVC FLAGS               */
         B     AMDPSUM9                                            0562
*     END;                          /* IO=SIO=ALL OR IO=SIO=SEL      */
*   SUMSGBUF(SUMVAL:SUMVAL+         /* IO=SIO=SEL                    */
*       11)=IOEQU2;                                                0564
@RF00558 LA    @14,SUMSGBUF-1(SUMVAL)                              0564
         MVC   0(12,@14),IOEQU2                                    0564
*   GOTO AMDPNW81;                  /* UPDATE COUNT & CHK     SVCFLGS*/
         B     AMDPNW81                                            0565
*AMDPNW82:                                                         0566
*   IF ALLI='1'B THEN               /* IF IO=ALL INDICATED, THEN     */
AMDPNW82 TM    ALLI(AEDITCBR),B'10000000'                          0566
         BNO   @RF00566                                            0566
*     DO;                           /* DO THE FOLLOWING              */
*       SUMSGBUF(SUMVAL:SUMVAL      /* MOVE IN 'IO=''ALL'''          */
*           +7)=IOCON1;                                            0568
         LA    @14,SUMSGBUF-1(SUMVAL)                              0568
         MVC   0(8,@14),IOCON1                                     0568
*AMDPNW83:                                                         0569
*       VAL=8;                      /* ADJUST VAL                    */
AMDPNW83 MVC   VAL(4),@CF00033                                     0569
*       GOTO AMDPNW81;              /* UPDATE COUNT & CHK     SVCFLGS*/
         B     AMDPNW81                                            0570
*     END;                          /* IO=ALL OR IO=SEL              */
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'IO=''SEL'''          */
*       +7)=IOCON2;                                                0572
@RF00566 LA    @14,SUMSGBUF-1(SUMVAL)                              0572
         MVC   0(8,@14),IOCON2                                     0572
*   GOTO AMDPNW83;                  /* UPDATE COUNT & CHK     SVCFLGS*/
         B     AMDPNW83                                            0573
*AMDPNOW9:                                                         0574
*   PATHSW=9;                       /* SVC BEING PROCESSED           */
AMDPNOW9 MVC   PATHSW(4),@CF00167                                  0574
*   IF ALLV='1'B THEN               /* SVC=ALL INDICATED             */
         TM    ALLV(AEDITCBR),B'10000000'                          0575
         BO    @RT00575                                            0575
*     GOTO AMDPNW91;                /* GO TO MOVE IN INDICATOR       */
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'SVC=''SEL'''         */
*       +8)=SVCCON2;                                               0577
         LA    @14,SUMSGBUF-1(SUMVAL)                              0577
         MVC   0(9,@14),SVCCON2                                    0577
*   GOTO AMDPNW92;                  /* UPDATE COUNT & CHK PIFLGS     */
         B     AMDPNW92                                            0578
*AMDPNW91:                                                         0579
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'SVC=''ALL'''         */
*       +8)=SVCCON1;                                               0579
AMDPNW91 LA    @14,SUMSGBUF-1(SUMVAL)                              0579
         MVC   0(9,@14),SVCCON1                                    0579
*AMDPNW92:                                                         0580
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER CHAR COUNT      */
AMDPNW92 AL    SUMVAL,VAL                                          0580
*   GOTO AMDPSUMA;                  /* CHECK PI FLAGS                */
         B     AMDPSUMA                                            0581
*AMDPNOWA:                                                         0582
*   PATHSW=10;                      /* PI BEING PROCESSED            */
AMDPNOWA MVC   PATHSW(4),@CF00385                                  0582
*   IF ALLP='1'B THEN               /* SVC=ALL INDICATED             */
         TM    ALLP(AEDITCBR),B'10000000'                          0583
         BO    @RT00583                                            0583
*     GOTO AMDPNWA1;                /* GO TO MOVE IN INDICATOR       */
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'PI=''SEL'''          */
*       +7)=PICON2;                                                0585
         LA    @14,SUMSGBUF-1(SUMVAL)                              0585
         MVC   0(8,@14),PICON2                                     0585
*   GOTO AMDPNWA2;                  /* UPDATE COUNT & CHK USRFLGS    */
         B     AMDPNWA2                                            0586
*AMDPNWA1:                                                         0587
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'PI=''ALL'''          */
*       +7)=PICON1;                                                0587
AMDPNWA1 LA    @14,SUMSGBUF-1(SUMVAL)                              0587
         MVC   0(8,@14),PICON1                                     0587
*AMDPNWA2:                                                         0588
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER CHAR COUNT      */
AMDPNWA2 AL    SUMVAL,VAL                                          0588
*   GOTO AMDPSUMB;                  /* CHECK USR FLAGS               */
         B     AMDPSUMB                                            0589
*AMDPNOWB:                                                         0590
*   PATHSW=11;                      /* USR BEING PROCESSED           */
AMDPNOWB MVC   PATHSW(4),@CF00034                                  0590
*   IF ALLU='1'B THEN               /* USR=ALL INDICATED             */
         TM    ALLU(AEDITCBR),B'10000000'                          0591
         BO    @RT00591                                            0591
*     GOTO AMDPNWB1;                /* GO TO MOVE IN INDICATOR       */
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'USR=''SEL'''         */
*       +8)=ALLCON2;                                               0593
         LA    @14,SUMSGBUF-1(SUMVAL)                              0593
         MVC   0(9,@14),ALLCON2                                    0593
*   GOTO AMDPNWB2;                  /* UPDATE COUNT & CHECK EXT      */
         B     AMDPNWB2                                            0594
*AMDPNWB1:                                                         0595
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'USR=''ALL'''         */
*       +8)=ALLCON1;                                               0595
AMDPNWB1 LA    @14,SUMSGBUF-1(SUMVAL)                              0595
         MVC   0(9,@14),ALLCON1                                    0595
*AMDPNWB2:                                                         0596
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER CHAR COUNT      */
AMDPNWB2 AL    SUMVAL,VAL                                          0596
*   GOTO AMDPSUMC;                  /* CHECK FOR EXT IND             */
         B     AMDPSUMC                                            0597
*AMDPNOWC:                                                         0598
*   PATHSW=12;                      /* EXT BEING PROCESSED           */
AMDPNOWC MVC   PATHSW(4),@CF00075                                  0598
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'EXT'                 */
*       +2)=EXTCON;                                                0599
         LA    @14,SUMSGBUF-1(SUMVAL)                              0599
         MVC   0(3,@14),EXTCON                                     0599
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER CHAR COUNT      */
         AL    SUMVAL,VAL                                          0600
*   GOTO AMDPSUMF;                  /* CHECK FOR RNIO IND      Y02014*/
         B     AMDPSUMF                                            0601
*AMDPNOWF:                                                         0602
*   PATHSW=15;                      /* RNIO BEING PROCESSED    Y02014*/
AMDPNOWF MVC   PATHSW(4),@CF00032                                  0602
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'RNIO'          Y02014*/
*       +3)=RNIOCON;                                               0603
         LA    @14,SUMSGBUF-1(SUMVAL)                              0603
         MVC   0(4,@14),RNIOCON                                    0603
*   SUMVAL=SUMVAL+VAL;              /* UPDTE CHAR COUNT        Y02014*/
         AL    SUMVAL,VAL                                          0604
*   GOTO AMDPSUMG;                  /* CHECK FOR SRM           Y02014*/
         B     AMDPSUMG                                            0605
*AMDPNOWG:                                                         0606
*   PATHSW=16;                      /* SRM BEING PROCESSED     Y02014*/
AMDPNOWG MVC   PATHSW(4),@CF00139                                  0606
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'SRM'           Y02014*/
*       +2)=SRMCON;                                                0607
         LA    @14,SUMSGBUF-1(SUMVAL)                              0607
         MVC   0(3,@14),SRMCON                                     0607
*   SUMVAL=SUMVAL+VAL;              /* UPDTE CHAR COUNT        Y02014*/
         AL    SUMVAL,VAL                                          0608
*   GOTO AMDPSUMH;                  /* CHECK FOR RR            Y02014*/
         B     AMDPSUMH                                            0609
*AMDPNOWH:                                                         0610
*   PATHSW=17;                      /* RR BEING PROCESSED      Y02014*/
AMDPNOWH MVC   PATHSW(4),@CF00561                                  0610
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'RR'            Y02014*/
*       +1)=RRCON;                                                 0611
         LA    @14,SUMSGBUF-1(SUMVAL)                              0611
         MVC   0(2,@14),RRCON                                      0611
*   SUMVAL=SUMVAL+VAL;              /* UPTE CHAR COUNT         Y02014*/
         AL    SUMVAL,VAL                                          0612
*   GOTO AMDPSUMI;                  /* CHECK FOR EOF           Y02014*/
         B     AMDPSUMI                                            0613
*AMDPNOWI:                                                         0614
*   PATHSW=18;                      /* EOF BEING PROCESSED     Y02014*/
AMDPNOWI MVC   PATHSW(4),@CF00459                                  0614
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'EOF EXIT'      Y02014*/
*       +7)=EOFCON;                                                0615
         LA    @14,SUMSGBUF-1(SUMVAL)                              0615
         MVC   0(8,@14),EOFCON                                     0615
*   SUMVAL=SUMVAL+VAL;              /* UPDTE CHAR COUNT        Y02014*/
         AL    SUMVAL,VAL                                          0616
*   GOTO AMDPSUMD;                  /* CHECK FOR DSP           Y02014*/
         B     AMDPSUMD                                            0617
*AMDPNOWD:                                                         0618
*   PATHSW=13;                      /* EOF BEING PROCESSED           */
AMDPNOWD MVC   PATHSW(4),@CF00566                                  0618
*   SUMSGBUF(SUMVAL:SUMVAL          /* MOVE IN 'DSP'                 */
*       +2)=DSPCON;                                                0619
         LA    @14,SUMSGBUF-1(SUMVAL)                              0619
         MVC   0(3,@14),DSPCON                                     0619
*   SUMVAL=SUMVAL+VAL;              /* UPDATE BUFFER CHAR COUNT      */
         AL    SUMVAL,VAL                                          0620
*   GOTO AMDPSUME;                  /* CHK FOR DATA LEFT ON LINE TO
*                                      BE PRINTED                    */
         B     AMDPSUME                                            0621
*AMDPNOWE:                                                         0622
*   SCN='0'B;                       /* TURN OFF AMDPRSCN BIT         */
AMDPNOWE NI    SCN(AEDITCBR),B'10111111'                           0622
*   REG15=0;                        /* SET ZERO RETURN CODE          */
         SLR   REG15,REG15                                         0623
*   SCANBIT='0'B;                   /* READY FOR FIRST TIME THRU     */
         NI    SCANBIT(TTABPTR),B'11011111'                        0624
*   GOTO AMDRET3;                   /* RETURN TO CALLER              */
*                                                                  0625
         B     AMDRET3                                             0625
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE CONVERTS BINARY DATA THAT IS ONE BYTE*/
*   /* IN LENGTH TO PRINTABLE DECIMAL. UPON ENTRY, REG 2 CONTAINS THE*/
*   /* INPUT DATA, REG 5 ADDRESSES A 4-BYTE CHARACTER DATA AREA, AND */
*   /* REG 6 ADDRESSES THE OUTPUT AREA. THIS SUBROUTINE IS USED IN   */
*   /* CONVERTING START AND STOP VALUES.                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0626
*AMDPRNT:                                                          0626
*   PROC;                                                          0626
@EL00001 L     @13,4(,@13)                                         0626
@EF00001 DS    0H                                                  0626
@ER00001 L     @14,12(,@13)                                        0626
         LM    @00,@12,20(@13)                                     0626
         BR    @14                                                 0626
AMDPRNT  STM   @14,@12,@SA00002                                    0626
*   RFY                                                            0627
*    (REG1,                         /* PARM REGISTER           Y02014*/
*     REG2,                         /* WORK REGISTER                 */
*     TTABPTR,                      /* POINTER TO AMDSCNTB           */
*     REG4,                         /* POINTS TO INPUT DATA          */
*     REG5,                         /* POINTS TO WORK AREA           */
*     REG6,                         /* POINTS TO OUTPUT AREA         */
*     REGPT,                        /* POINTER TO AMDPRCOM           */
*     AEDITCBR) RSTD;               /* POINTER TO AMDPRTAB     Y02014*/
*   REG2=WORD;                      /* REG 2 = INPUT DATA            */
         L     REG2,WORD(,TTABPTR)                                 0628
*   REG4=ADDR(DBLWORD);             /* REG 4 = @ DBLWRD WRK AREA     */
         LA    REG4,DBLWORD(,TTABPTR)                              0629
*   REG5=ADDR(COMP4);               /* REG 5 = @ CHAR WORK AREA      */
         LA    REG5,COMP4(,TTABPTR)                                0630
*   GENERATE;                                                      0631
         CVD   R2,0(R4)                 CONVERT BINARY VALUE TO DECIMAL
         UNPK  0(4,R5),6(2,R4)          UNPACK INTO DBLWORD
         OI    3(R5),X'F0'            REMOVE ZONE
         MVC   0(2,R6),2(R5)            MOVE RESULT INTO OUTPUT AREA
*   RETURN;                         /* RETURN TO CALLER              */
@EL00002 DS    0H                                                  0632
@EF00002 DS    0H                                                  0632
@ER00002 LM    @14,@12,@SA00002                                    0632
         BR    @14                                                 0632
*   END AMDPRNT;                    /* END OF INTERNAL PROCEDURE     */
*   END AMDPRSN3                                                   0634
*                                                                  0634
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMDPRTAB)                                       */
*/*%INCLUDE SYSLIB  (AMDSCNTB)                                       */
*                                                                  0634
*       ;                                                          0634
@DATA    DS    0H
@SC00655 CLC   DEVICE1(0,Y),DEVICE(K)
@SM00657 MVC   SAVESLOT(0),DEVICE(K)
@SM00659 MVC   DEVICE(0,K),DEVICE1(Y)
@SM00661 MVC   DEVICE1(0,Y),SAVESLOT
@SC00663 CLC   ELEM1(0,NEWADDR),ELEM(Z)
@SM00665 MVC   SAVESLOT(0),ELEM(Z)
@SM00667 MVC   ELEM(0,Z),ELEM1(NEWADDR)
@SM00669 MVC   ELEM1(0,NEWADDR),SAVESLOT
@SM00678 MVC   SUMSGBUF+13(0),@TS00001
@SM00681 MVC   0(0,@14),USEREXIT(AEDITCBR)
@SM00683 MVC   0(0,@14),DDNAME(AEDITCBR)
@SM00685 MVC   0(0,@14),JOBNAMES-8(@06)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@TF00001 DS    F
         DS    0F
@CF00046 DC    F'1'
@CF00078 DC    F'2'
@CF00169 DC    F'3'
@CF00099 DC    F'4'
@CF00086 DC    F'5'
@CF00110 DC    F'6'
@CF00035 DC    F'7'
@CF00033 DC    F'8'
@CF00167 DC    F'9'
@CF00385 DC    F'10'
@CF00034 DC    F'11'
@CF00075 DC    F'12'
@CF00566 DC    F'13'
@CF00378 DC    F'14'
@CF00032 DC    F'15'
@CF00139 DC    F'16'
@CF00561 DC    F'17'
@CF00459 DC    F'18'
@CF00538 DC    F'19'
@CF00130 DC    F'20'
@CF00576 DC    F'71'
@CA00319 DC    A(AMDPRS00)
         DS    0D
PATHSW   DS    F
VAL      DS    F
ADSUM    DS    A
JOBCT    DS    FL4
         ORG   JOBCT
ASCBCT   DS    FL4
         ORG   JOBCT+4
LASTPTR  DS    A
@TS00001 DS    CL80
SAVESLOT DC    CL4' '
RTDSCDES DS    BL4
SUMSGBUF DS    CL80
REPSLOT  DC    CL8' '
SELSW    DC    B'00000000'
EXITCON  DC    CL5'EXIT='
DDCON    DC    CL7'DDNAME='
STARTCON DC    CL6'START='
STARTFIL DC    CL14'(   ,  .  .  )'
STOPCON  DC    CL5'STOP='
STOPFIL  DC    CL14'(   ,  .  .  )'
JOBCON   DC    CL10'JOBNAMES=('
ASCBCON  DC    CL7'ASCBS=('
SIOCON1  DC    CL9'SIO=''ALL'''
SIOCON2  DC    CL9'SIO=''SEL'''
IOCON1   DC    CL8'IO=''ALL'''
IOCON2   DC    CL8'IO=''SEL'''
IOEQU1   DC    CL12'IO=SIO=''ALL'''
IOEQU2   DC    CL12'IO=SIO=''SEL'''
SVCCON1  DC    CL9'SVC=''ALL'''
SVCCON2  DC    CL9'SVC=''SEL'''
PICON1   DC    CL8'PI=''ALL'''
PICON2   DC    CL8'PI=''SEL'''
ALLCON1  DC    CL9'USR=''ALL'''
ALLCON2  DC    CL9'USR=''SEL'''
DSPCON   DC    CL3'DSP'
EXTCON   DC    CL3'EXT'
RNIOCON  DC    CL4'RNIO'
SRMCON   DC    CL3'SRM'
RRCON    DC    CL2'RR'
EOFCON   DC    CL8'EOF EXIT'
SUMSGID  DC    CL8' '
SCNPTCH  DC    CL256'SCNPTCH'
         DC    CL256' '
         DC    CL256' '
         DC    CL232' '
         DS    CL2
BRNWTAB  DC    AL4(AMDPNOW1)
         DC    AL4(AMDPNOW2)
         DC    AL4(AMDPNOW3)
         DC    AL4(AMDPNOW4)
         DC    AL4(AMDPNOW5)
         DC    AL4(AMDPNOW6)
         DC    AL4(AMDPNOW7)
         DC    AL4(AMDPNOW8)
         DC    AL4(AMDPNOW9)
         DC    AL4(AMDPNOWA)
         DC    AL4(AMDPNOWB)
         DC    AL4(AMDPNOWC)
         DC    AL4(AMDPNOWD)
         DC    AL4(AMDPNOWE)
         DC    AL4(AMDPNOWF)
         DC    AL4(AMDPNOWG)
         DC    AL4(AMDPNOWH)
         DC    AL4(AMDPNOWI)
AMDPRSN3 CSECT
ECB1     DC    F'0'                     NEEDED TO SIGNAL REPLY
AMDPRSN3 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
K        EQU   @04
SUMVAL   EQU   @02
Z        EQU   @06
Y        EQU   @02
NEWADDR  EQU   @02
SORTSW   EQU   @05
NOWSW    EQU   @05
AEDITCBR EQU   @09
TTABPTR  EQU   @03
REG1     EQU   @01
REG2     EQU   @02
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REGPT    EQU   @12
REG15    EQU   @15
REG7     EQU   @07
         ENTRY SCNPTCH
         EXTRN AMDPRS00
AMDPRTAB EQU   0
DEBGFLGS EQU   AMDPRTAB+8
PTHFLGS1 EQU   DEBGFLGS
SCN      EQU   PTHFLGS1
PTHFLGS2 EQU   DEBGFLGS+1
INRFCFGS EQU   DEBGFLGS+2
FLMODE   EQU   INRFCFGS
IOFLGS   EQU   DEBGFLGS+3
USEREXIT EQU   AMDPRTAB+24
DDNAME   EQU   AMDPRTAB+32
STARTIME EQU   AMDPRTAB+40
STOPTIME EQU   AMDPRTAB+52
NAMES    EQU   AMDPRTAB+64
JOBNAMES EQU   NAMES
ADS      EQU   AMDPRTAB+104
AADS     EQU   ADS
ASCBADDR EQU   AADS
SIF      EQU   AMDPRTAB+124
SIOFLGS  EQU   SIF
ALLS     EQU   SIOFLGS
SELS     EQU   SIOFLGS
EQUIV    EQU   SIOFLGS
NOEQU    EQU   SIOFLGS
DVADS1   EQU   AMDPRTAB+128
IO       EQU   AMDPRTAB+228
IOFLGS2  EQU   IO
ALLI     EQU   IOFLGS2
SELI     EQU   IOFLGS2
DVADS2   EQU   AMDPRTAB+232
VCF      EQU   AMDPRTAB+332
SVCFLGS  EQU   VCF
ALLV     EQU   SVCFLGS
SELV     EQU   SVCFLGS
SVCNUMS  EQU   AMDPRTAB+336
USR      EQU   AMDPRTAB+368
USRFLGS  EQU   USR
ALLU     EQU   USRFLGS
SELU     EQU   USRFLGS
USRTAB   EQU   AMDPRTAB+372
USRNGTAB EQU   USRTAB
PI       EQU   AMDPRTAB+452
PIFLGS   EQU   PI
ALLP     EQU   PIFLGS
SELP     EQU   PIFLGS
PGMNGEN  EQU   AMDPRTAB+456
PICODES  EQU   PGMNGEN
PICODEA  EQU   PGMNGEN+2
GENFLAGS EQU   PGMNGEN+3
EXT      EQU   GENFLAGS
DSP      EQU   GENFLAGS
SYS      EQU   GENFLAGS
SYSM     EQU   GENFLAGS
RNIO     EQU   GENFLAGS
SRM      EQU   GENFLAGS
RR       EQU   GENFLAGS
EOF      EQU   GENFLAGS
GENFLGS1 EQU   AMDPRTAB+460
ESTARTME EQU   AMDPRTAB+500
ESDAY    EQU   ESTARTME
ESHR     EQU   ESTARTME+3
ESMIN    EQU   ESTARTME+5
ESSEC    EQU   ESTARTME+7
ESTOPTME EQU   AMDPRTAB+509
ESPDAY   EQU   ESTOPTME
ESPHR    EQU   ESTOPTME+3
ESPMIN   EQU   ESTOPTME+5
ESPSEC   EQU   ESTOPTME+7
AMDSCNTB EQU   0
TEMPTAB  EQU   AMDSCNTB
EXITNAME EQU   TEMPTAB
DDNM     EQU   TEMPTAB+8
STARTSL  EQU   TEMPTAB+16
STOPSL   EQU   TEMPTAB+28
OVERLTAB EQU   TEMPTAB+40
OVERSL   EQU   OVERLTAB
SIOTFLGS EQU   TEMPTAB+80
IOTFLGS  EQU   TEMPTAB+81
USRTFLGS EQU   TEMPTAB+82
SVCTFLGS EQU   TEMPTAB+83
PITFLGS  EQU   TEMPTAB+84
SYSTFLGS EQU   TEMPTAB+85
SIOPTR   EQU   TEMPTAB+88
IOPTR    EQU   TEMPTAB+92
JOBNPTR  EQU   TEMPTAB+96
ASCBPTR  EQU   TEMPTAB+100
SIOCRPTR EQU   TEMPTAB+104
IOCRPTR  EQU   TEMPTAB+108
JOBCRPTR EQU   TEMPTAB+112
ASCBCPTR EQU   TEMPTAB+116
USRCOUNT EQU   TEMPTAB+120
USRCRCNT EQU   TEMPTAB+124
SVCSTR   EQU   TEMPTAB+128
PISTR    EQU   TEMPTAB+160
PISTRB   EQU   TEMPTAB+162
SCNBITS  EQU   AMDSCNTB+163
SCANBIT  EQU   SCNBITS
RUNEDIT  EQU   SCNBITS
PRNSW    EQU   SCNBITS
CODETABL EQU   AMDSCNTB+164
WORD     EQU   AMDSCNTB+168
DBLWORD  EQU   AMDSCNTB+176
BLANK1   EQU   AMDSCNTB+316
SCNPTR   EQU   AMDSCNTB+336
ADDRS3   EQU   AMDSCNTB+348
COMP4    EQU   AMDSCNTB+360
COMP8    EQU   AMDSCNTB+364
SAVETAB  EQU   AMDSCNTB+376
SORTPTR  EQU   AMDSCNTB+380
SRTTABPT EQU   AMDSCNTB+384
INCRT    EQU   AMDSCNTB+388
I        EQU   AMDSCNTB+396
INTSTART EQU   AMDSCNTB+404
INTSTOP  EQU   AMDSCNTB+409
AMDPRSYN EQU   0
MSGADDR  EQU   0
ERRBUF   EQU   0
DEVICE   EQU   0
CNVTRTN2 EQU   0
DEVICE1  EQU   0
ELEM     EQU   0
ELEM1    EQU   0
JOBCHAR  EQU   0
REINIT   EQU   0
DEVCHAR  EQU   0
CNVTRTN  EQU   0
SCNCHAR  EQU   0
VAL1     EQU   0
AD11     EQU   AMDPRS00+40
GFLSHMOD EQU   SWD
GNOSTDMG EQU   SWD
GCONTSW  EQU   SWD
GRDRSW   EQU   SWA
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
GSETCVTS EQU   SWA
GPRNTSW  EQU   SWA
GGOSW    EQU   SWA
GTSOSW   EQU   SWA
GJBNMSW  EQU   SWA
GREAD    EQU   SWA
GSTORSW  EQU   SWA
GFRBUFSW EQU   SWD
GGPRSFND EQU   SWD
GPREFMTD EQU   SWD
GNCDUMP  EQU   SWD
GSWPDCBC EQU   SWD
AD10     EQU   AMDPRS00+36
AD9      EQU   AMDPRS00+32
AD8      EQU   AMDPRS00+28
AD7      EQU   AMDPRS00+24
AD6      EQU   AMDPRS00+20
AD5      EQU   AMDPRS00+16
AD4      EQU   AMDPRS00+12
AD3      EQU   AMDPRS00+8
AD2      EQU   AMDPRS00+4
AD1      EQU   AMDPRS00
J        EQU   AMDSCNTB+400
ALLCT    EQU   AMDSCNTB+392
ALLPTR   EQU   SAVETAB
SVKEY    EQU   AMDSCNTB+372
LNGTH    EQU   AMDSCNTB+356
EOCADDR  EQU   AMDSCNTB+352
ADDRS1   EQU   AMDSCNTB+344
BUFADDR  EQU   AMDSCNTB+340
MASKS    EQU   AMDSCNTB+328
KWTAB2   EQU   AMDSCNTB+228
KWTAB1   EQU   AMDSCNTB+184
@NM00003 EQU   CODETABL+2
PAREN    EQU   CODETABL+2
NOVAL    EQU   CODETABL+2
CEOF     EQU   CODETABL+2
CRR      EQU   CODETABL+2
CSRM     EQU   CODETABL+1
CRNIO    EQU   CODETABL+1
CDSP     EQU   CODETABL+1
CEXT     EQU   CODETABL+1
CSYS     EQU   CODETABL+1
CPI      EQU   CODETABL+1
CSVC     EQU   CODETABL+1
CIO      EQU   CODETABL+1
CSIO     EQU   CODETABL
CUSR     EQU   CODETABL
CASCB    EQU   CODETABL
CJOBN    EQU   CODETABL
CSTOP    EQU   CODETABL
CSTART   EQU   CODETABL
CDDN     EQU   CODETABL
CXIT     EQU   CODETABL
RESBITS  EQU   SCNBITS
EQUIND   EQU   SCNBITS
MORESW   EQU   SCNBITS
IORTNSW  EQU   SCNBITS
@NM00002 EQU   TEMPTAB+86
EOFT     EQU   SYSTFLGS
RRT      EQU   SYSTFLGS
SRMT     EQU   SYSTFLGS
RNIOT    EQU   SYSTFLGS
SYSMT    EQU   SYSTFLGS
SYST     EQU   SYSTFLGS
DSPT     EQU   SYSTFLGS
EXTT     EQU   SYSTFLGS
T        EQU   PITFLGS
SELPT    EQU   PITFLGS
ALLPT    EQU   PITFLGS
GT       EQU   SVCTFLGS
SELVT    EQU   SVCTFLGS
ALLVT    EQU   SVCTFLGS
ET       EQU   USRTFLGS
SELUT    EQU   USRTFLGS
ALLUT    EQU   USRTFLGS
BT       EQU   IOTFLGS
SELIT    EQU   IOTFLGS
ALLIT    EQU   IOTFLGS
AT       EQU   SIOTFLGS
NOEQUT   EQU   SIOTFLGS
EQUIVT   EQU   SIOTFLGS
SELST    EQU   SIOTFLGS
ALLST    EQU   SIOTFLGS
DYSTP    EQU   STOPSL+10
YRSTP    EQU   STOPSL+8
TIMERU   EQU   STOPSL
DY       EQU   STARTSL+10
YR       EQU   STARTSL+8
TIMEU    EQU   STARTSL
RESERVED EQU   AMDPRTAB+522
CVTTZONE EQU   AMDPRTAB+518
ADTSBUF  EQU   AMDPRTAB+496
OFSTDATA EQU   AMDPRTAB+494
OFSTEID  EQU   AMDPRTAB+492
AFRMAD   EQU   AMDPRTAB+488
REENTWKA EQU   AMDPRTAB+484
PRFMTADD EQU   AMDPRTAB+480
AEIOCT   EQU   AMDPRTAB+476
EXITADDR EQU   AMDPRTAB+472
EXITNM   EQU   AMDPRTAB+464
RECDLL   EQU   AMDPRTAB+461
@NM00001 EQU   GENFLGS1
FIRSTHSW EQU   GENFLGS1
TSFOUND  EQU   GENFLGS1
EOFINPRO EQU   GENFLGS1
TS       EQU   GENFLGS1
Q        EQU   PI+1
P01R     EQU   PIFLGS
O        EQU   USR+1
N01R     EQU   USRFLGS
M        EQU   VCF+1
L        EQU   SVCFLGS
IODVADS  EQU   DVADS2
K01RES   EQU   IO+1
JJ       EQU   IOFLGS2
SIODVADS EQU   DVADS1
II       EQU   SIF+1
H        EQU   SIOFLGS
DAY2     EQU   STOPTIME+10
F        EQU   STOPTIME+8
TIME2    EQU   STOPTIME
DAY      EQU   STARTIME+10
D        EQU   STARTIME+8
TIME     EQU   STARTIME
GTFWDPTR EQU   AMDPRTAB+20
C        EQU   DEBGFLGS+4
B        EQU   IOFLGS
GETEOF   EQU   IOFLGS
DMDFMT   EQU   INRFCFGS
EDITSTOP EQU   INRFCFGS
EXTTRC   EQU   INRFCFGS
RET      EQU   INRFCFGS
FMT      EQU   INRFCFGS
SPIE     EQU   INRFCFGS
TERM     EQU   INRFCFGS
REMAIN   EQU   PTHFLGS2
APP      EQU   PTHFLGS2
REXT     EQU   PTHFLGS1
FRM      EQU   PTHFLGS1
FLT      EQU   PTHFLGS1
HEX      EQU   PTHFLGS1
CON      EQU   PTHFLGS1
GET      EQU   PTHFLGS1
ROOT     EQU   PTHFLGS1
CURREC   EQU   AMDPRTAB+4
AFMG     EQU   AMDPRTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00106 EQU   AMDTCB1
@RT00110 EQU   AMDSIO1
@RT00114 EQU   AMDIO1
@RT00118 EQU   AMDUSRBL
@RT00132 EQU   AMDPST4
@RT00145 EQU   AMDTCB
@RT00149 EQU   AMDSIO
@RT00154 EQU   AMDIO
@RT00159 EQU   AMDUSRCT
AMDRET3  EQU   @EL00001
@RT00181 EQU   AMDPFIN1
@RT00198 EQU   AMDPDEV2
@RT00200 EQU   AMDPDEV2
@RT00211 EQU   AMDPFIN3
@RT00215 EQU   AMDPFIN3
@RT00223 EQU   AMDPSUM
@RT00237 EQU   AMDRET3
@RT00241 EQU   AMDRET3
@RT00249 EQU   AMDPSUMM
@RF00247 EQU   AMDPSUMM
@RT00257 EQU   AMDPSUMN
@RT00259 EQU   AMDPSUMN
@RT00292 EQU   AMDPSUM2
@RT00299 EQU   AMDPSUM3
@RT00304 EQU   AMDPSUM4
@RT00309 EQU   AMDPSUM5
@RT00314 EQU   AMDPSUM6
@RT00320 EQU   AMDPSUM7
@RT00326 EQU   AMDPSUM8
@RT00331 EQU   AMDPSUM9
@RT00336 EQU   AMDPSUMA
@RT00341 EQU   AMDPSUMB
@RT00346 EQU   AMDPSUMC
@RT00351 EQU   AMDPSUMF
@RT00356 EQU   AMDPSUMG
@RT00361 EQU   AMDPSUMH
@RT00366 EQU   AMDPSUMI
@RT00371 EQU   AMDPSUMD
@RT00376 EQU   AMDPSUME
@RT00381 EQU   AMDPNOWE
@RT00395 EQU   CKPATH
@RT00399 EQU   CALC
@RT00405 EQU   AMDPNPRN
@RT00483 EQU   AMDPNW51
@RT00497 EQU   AMDPNW53
@RT00499 EQU   AMDPNW53
@RT00508 EQU   AMDPNW61
@RT00522 EQU   AMDPFIT
@RT00529 EQU   AMDPNW64
@RT00531 EQU   AMDPNW64
@RT00541 EQU   AMDPNW71
@RT00543 EQU   AMDPNOW8
@RT00554 EQU   AMDPNW82
@RT00556 EQU   AMDPNW82
@RT00575 EQU   AMDPNW91
@RT00583 EQU   AMDPNWA1
@RT00591 EQU   AMDPNWB1
@RT00175 EQU   AMDRET3
@ENDDATA EQU   *
         END   AMDPRSN3,(C'PLS2034',0701,76224)

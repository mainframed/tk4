         TITLE ' AMDPRFRM-CONTROL RTN                                  *
                        '
AMDPRFRM CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'AMDPRFRM  76.211'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         EQUATES
         COMMON                    AMDPRCOM MAPPING MACRE
         USING COMMON,COMBASE      BASE COMMON CSECT
         SYNEPS                    MAPPING MACRO FOR ENTRY POINTS OF
*                                  AMDPRSYN
AMDPRFRM  CSECT                    RESTART AMDPRFRM
*   AEDITCBR=AEDITCB;               /* POINT TO AMDPRTAB             */
         L     AEDITCBR,AEDITCB                                    0081
*   FRM='1'B;                       /* INDICATE AMDPRFRM IN CONTROL  */
         OI    FRM(AEDITCBR),B'00000010'                           0082
*   FRMSWITC='00'X;                 /* INIT ALL SWITCHES             */
         MVI   FRMSWITC,X'00'                                      0083
*   AFRMAD=ADDR(FRMATAB);           /* STORE ADDRESS OF FRM ADDR   0084
*                                      TABLE IN AMDPRTAB           0084
*                                      (COMMUNICATIONS AREA FOR ALL
*                                      OF EDIT)                      */
         LA    @14,FRMATAB                                         0084
         ST    @14,AFRMAD(,AEDITCBR)                               0084
*   AFMG=APRFMG;                    /* SET ADDRESS OF EDIT EXECUTION
*                                      MESSAGE CSECT IN AMDPRTAB     */
         L     @14,APRFMG                                          0085
         ST    @14,AFMG(,AEDITCBR)                                 0085
*/*  OBTAIN CORE FOR PARM LIST WORK AREA                       Y02014*/
*                                                                  0086
*   GEN(GETMAIN EC,LV=256,A=ADDRHOLD);                             0086
         GETMAIN EC,LV=256,A=ADDRHOLD
*   IF REG15^=0 THEN                /* SUCCESSFUL              Y02014*/
         LTR   REG15,REG15                                         0087
         BZ    @RF00087                                            0087
*     DO;                                                          0088
*       GEN(USING SYNTAX,R15);      /* BASE EP OF MSG WTR      Y02014*/
         USING SYNTAX,R15
*       SYNMSGA=ADDR(AMDPRE14);     /* PT TO AMD151I           Y02014*/
         L     @14,AFMG(,AEDITCBR)                                 0090
         LA    @14,AMDPRE14(,@14)                                  0090
         ST    @14,SYNMSGA                                         0090
*       GEN(OI SWD,NOSTDMG);        /* INDICATE NO PRDMP MSG   Y02014*/
         OI SWD,NOSTDMG
*       REG15=ASYNTAX;              /* PT TO MSG WRITER        Y02014*/
         L     REG15,ASYNTAX                                       0092
*       CALL SYNTAXA;               /* CALL MSG WRITER         Y02014*/
         BAL   @14,SYNTAXA                                         0093
*       GOTO OUT;                   /* TERMINATE EDIT          Y02014*/
         B     OUT                                                 0094
*     END;                                                         0095
*   REENTWKA=ADDRHOLD;              /* PLACE ADDR IN PRTAB     Y02014*/
@RF00087 L     @14,ADDRHOLD                                        0096
         ST    @14,REENTWKA(,AEDITCBR)                             0096
*   GEN(LOAD EP=AMDPRFMT);          /* LOAD FORMATTING ROUTINE Y02014*/
         LOAD EP=AMDPRFMT
*   PRFMTADD=REG0;                  /* SAVE ADDRESS IN PRTAB   Y02014*/
         ST    REG0,PRFMTADD(,AEDITCBR)                            0098
*   STOPSAVE=STOPEXIT;              /* SAVE CALLER'S STOP ROUTINE  0099
*                                      ADDR                          */
         L     @14,STOPEXIT                                        0099
         ST    @14,STOPSAVE                                        0099
*   STOPEXIT=ADDR(FRMSTOP);         /* ESTABLISH STOP EXIT FOR EDIT  */
         LA    @14,FRMSTOP                                         0100
         ST    @14,STOPEXIT                                        0100
*   DRIVER='0000'X;                 /* CLEAR DRIVER STRING           */
         MVC   DRIVER(2),@CB00374                                  0101
*   DRVGET='1'B;                    /* SET UP DRIVER FOR CALLGET     */
         OI    DRVGET,B'00000001'                                  0102
*   DRVPOSIT='1'B;                  /* AND POSIT                     */
         OI    DRVPOSIT,B'00100000'                                0103
*                                                                  0104
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*  SELECT-ROUTINE.  ROUTINE IS SELECTED IF CORRESPONDING DRIVER BIT*/
*/*  IS ON.  DRIVER IS SCANNED HIGH-TO-LOW ORDER BITS, SO THIS IS    */
*/*  THE PRIORITY IN WHICH ROUTINES ARE EXECUTED.                    */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0104
*   RFY                                                            0104
*    (REG4,                                                        0104
*     REG5,                                                        0104
*     REG6) RSTD;                   /* REGISTER USAGE IN SELECT-   0104
*                                      ROUTINE PROCESSING: REG 4 - 0104
*                                      MASK FOR SELECTION BIT ON IS
*                                      TO BE SELECTED IF CORRES-   0104
*                                      PONDING BIT IS ON IN DRIVER 0104
*                                      REG 5 - INDEX INTO SELECTION
*                                      BRANCH TABLE REG 6 - WORK REG
*                                      IN WHICH MASK IS AND-ED WITH
*                                      DRIVER                        */
*   GEN;                                                           0105
STARTSEL  LA   R4,256            INIT MASK FOR HIGHEST PRIORITY
*                                  ROUTINE
          SR   R5,R5               CLEAR BRANCH TABLE INDEX REG
SELECT    LH   R6,DRIVER           PICK UP DRIVER - SOME ROUTINE MAY
*                                  HAVE CHANGED DRIVER VALUE
          NR   R6,R4               AND WITH MASK TO MAKE ROUTINE
*                                  SELECTION
*                                  IF RESULT IS ZERO, NO ROUTINE WAS
          BZ   NEXTRTN             SELECTED, SO BRANCH TO TRY NEXT
*                                  LOWER PRIORITY ROUTINE
          B    RTNTAB(R5)          BRANCH TABLE FOR ROUTINE SELECTION
*                                  INDEX VALUE (OPPOSITE PRIORITY)
RTNTAB    B    CALLGET             0 - LINK TO AMDPRGET
          B    TERMEDIT            4 - GO EXIT
          B    VALIDITY            8 - CHECK FOR GTF RECORD
          B    POSIT               12 - POSITION BY VALUE OF START=
*                                       PARAMETER '1'B EDIT CARD
          B    DUMP                16 - INIT FOR PROCESSING GTF BUFFERS
*                                       IN DUMP DATA SET
          B    EXTERNAL            20 - INIT FOR PROCESSING GTF
*                                       EXTERNAL TRACE
          B    PRNTITLE            24 - GO TITLE EDIT OUTPUT
          B    CALLCON             28 - LINK TO AMDPRCON
          B    CALLFLT             32 - LINK TO AMDPRFLT
*                                  END OF BRANCH TABLE
NEXTRTN   SRA  R4,1                SHIFT MASK TO BIT FOR NEXT LOWER
*                                  PRIORITY SUBROUTINE
          BZ   STARTSEL            TEST CONDITION CODE FOR ZERO RESULT
*                                  WHICH INDICATES MASK EXHAUSTED AND
*                                  HENCE END OF CYCLE - BRANCH TO START
*                                  NEW CYCLE
          LA   R5,4(R5)            INCREMENT ROUTINE SELECTION INDEX
          B    SELECT              IF MASK NOT ZERO, BRANCH TO TRY FOR
*                                  NEXT LOWER PRIORITY ROUTINE
*   RFY                                                            0106
*    (REG6) UNRSTD;                                                0106
*                                                                  0107
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*  EDIT STOP EXIT ROUTINE.  SHUT DOWN EDIT AFTER OPERATOR RESPONSE */
*/*  TO MESSAGE AMD156I.                                             */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0107
*   GEN;                                                           0107
         USING *,R15
FRMSTOP  LA    R13,@SA00001        POINT TO FRM SAVE AREA        Y02014
*                                  ***  SAVE AREA LABEL BSL DEPENDENT
         LM    R14,R12,12(R13)     RE-LOAD REGISTERS
         DROP  R15                 GO BACK TO OLD BASE
         USING SYNTAX,R15          BASE EP-S OF MESSAGE WRITER FOR
*                                  HERE FOLLOWING
*   EDITSTOP='1'B;                  /* INDICATE EDIT STOP IN PROGRESS*/
*   TERM='1'B;                      /* REQUEST EDIT TERMINATION      */
         OI    EDITSTOP(AEDITCBR),B'01000010'                      0109
*   DRVGET='1'B;                    /* RESET DRIVER TO CALL GET AND  */
         OI    DRVGET,B'00000001'                                  0110
*   DRVTERM='1'B;                   /* CALL FRM TERM ROUTINE         */
         OI    DRVTERM,B'10000000'                                 0111
*   GEN(NI SWC,255-EDITSW);         /* EDIT NO LONGER IN CONTROL     */
         NI SWC,255-EDITSW
*   GO TO STARTSEL;                 /* ENTER ROUTINE SELECTION AT TOP*/
         B     STARTSEL                                            0113
*                                                                  0114
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*                          CALL AMDPRGET                           */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0114
*CALLGET:                                                          0114
*   CALL PRGET;                     /* CALL AMDPRGET                 */
CALLGET  L     @15,AGET                                            0114
         BALR  @14,@15                                             0114
*   IF TERM='1'B THEN               /* IF TERMINATION HAS BEEN     0115
*                                      REQUESTED BY AMDPRGET,        */
         TM    TERM(AEDITCBR),B'01000000'                          0115
         BNO   @RF00115                                            0115
*     DRVTERM='1'B;                 /* SET DRIVER BIT FOR AMDPRFRM 0116
*                                      TERM ROUTINE SO THAT EDIT   0116
*                                      PROCESSING STOPS              */
         OI    DRVTERM,B'10000000'                                 0116
*   GO TO NEXTRTN;                  /* RETURN TO ROUTINE SELECTION   */
         B     NEXTRTN                                             0117
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*  TERMINATE EDIT.  THIS ROUTINE IS ENTERED TO STOP EDIT PROCESSING*/
*/*  AND RETURN TO AMDPRDMP.                                         */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0118
*TERMEDIT:                                                         0118
*   IF EDITSTOP='1'B THEN           /* TEST FOR STOP REQUESTED BY  0118
*                                      OPERATOR                      */
TERMEDIT TM    EDITSTOP(AEDITCBR),B'00000010'                      0118
         BNO   @RF00118                                            0118
*     DO;                           /* IN THIS CASE, RESTORE CALLER-S
*                                      STOP ROUTINE ADDR AND BRANCH
*                                      TO IT                         */
*       GEN(DELETE EP=AMDPRFMT);    /* DELETE FORMAT RTN       Y02014*/
         DELETE EP=AMDPRFMT
*       REG15=STOPSAVE;             /* POINT TO CALLER-S ROUTINE     */
         L     REG15,STOPSAVE                                      0121
*       STOPEXIT=REG15;             /* RESTORE THIS ADDRESS IN     0122
*                                      AMDPRCOM                      */
         ST    REG15,STOPEXIT                                      0122
*       GEN(BR  R15);               /* BRANCH TO CALLER-S STOP     0123
*                                      ROUTINE                       */
         BR  R15
*     END;                                                         0124
*                                                                  0124
*   /*****************************************************************/
*   /*                                                               */
*   /* IF END-OF-FILE IS REACHED DURING POSITIONING, POSIT. HAS      */
*   /* FAILED                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0125
*   IF DRVPOSIT='1'B&EXTTRC='1'B&GETEOF='1'B&STARTIME^='            '
*     THEN                          /* VERIFY START SPECIFIED        */
@RF00118 TM    DRVPOSIT,B'00100000'                                0125
         BNO   @RF00125                                            0125
         TM    EXTTRC(AEDITCBR),B'00000100'                        0125
         BNO   @RF00125                                            0125
         TM    GETEOF(AEDITCBR),B'10000000'                        0125
         BNO   @RF00125                                            0125
         CLC   STARTIME(12,AEDITCBR),@CC00379                      0125
         BE    @RF00125                                            0125
*NOTIMEMG:                                                         0126
*     DO;                           /* ISSUE MESSAGE AMD226I         */
NOTIMEMG DS    0H                                                  0127
*       SYNMSGA=ADDR(AMDPRE02);     /* POINT TO ADDR OF MESSAGE    0127
*                                      AMD226I IN AMDPRFMG           */
         L     @14,AFMG(,AEDITCBR)                                 0127
         LA    @14,AMDPRE02(,@14)                                  0127
         ST    @14,SYNMSGA                                         0127
*       GEN(OI  SWD,NOSTDMG);       /* INDICATE STANDARD MESSAGE   0128
*                                      AMD165I IS NOT REQUIRED       */
         OI  SWD,NOSTDMG
*       REG15=ASYNTAX;              /* POINT TO MESSAGE WRITER       */
         L     REG15,ASYNTAX                                       0129
*       CALL SYNTAXA;               /* CALL MESSAGE WRITER - AMDPRSYN*/
         BAL   @14,SYNTAXA                                         0130
*     END NOTIMEMG;                                                0131
*   IF EXTITLE='1'B THEN            /* IF EXTERNAL TRACE WAS       0132
*                                      PROCESSED,                    */
@RF00125 TM    EXTITLE,B'10000000'                                 0132
         BNO   @RF00132                                            0132
*     TITLEMOD=TITLSAVE;            /* AMDPRDMP-S PAGE TITLE MUST BE
*                                      RESTORED                      */
         MVC   TITLEMOD(47),TITLSAVE                               0133
*   GEN(DELETE EP=AMDPRFMT);        /* DELETE FORMAT RTN             */
@RF00132 DS    0H                                                  0134
         DELETE EP=AMDPRFMT
*OUT:                                                              0135
*   FRM='0'B;                       /* TURN OFF AMDPRFRM PATH FLAG   */
OUT      NI    FRM(AEDITCBR),B'11111101'                           0135
*   STOPEXIT=STOPSAVE;              /* RESTORE CALLERS STOP A51748   */
         L     @14,STOPSAVE                                        0136
         ST    @14,STOPEXIT                                        0136
*   RETURN;                         /* RETURN TO AMDPRCTL IN AMDPRDMP
*                                      EDIT DONE                     */
@EL00001 L     @13,4(,@13)                                         0137
@EF00001 DS    0H                                                  0137
@ER00001 LM    @14,@12,12(@13)                                     0137
         BR    @14                                                 0137
*                                                                  0138
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*  VALIDITY.  VERIFY THAT TRACE RECORD READ IS FROM GTF AND ROUTE  */
*/*  TO AMDPRFLT OR AMDPRCON                                         */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*/* TEST FOR NON-TRACE CONTROL RECORD                                */
*                                                                  0138
*VALIDITY:                                                         0138
*   IF RECAID='00'X THEN                                           0138
*                                                                  0138
VALIDITY L     @14,CURREC(,AEDITCBR)                               0138
         CLI   RECAID(@14),X'00'                                   0138
         BNE   @RF00138                                            0138
*     /***************************************************************/
*     /*                                                             */
*     /* TIME-STAMP AND LOST-DATA RECORD PROCESSING                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0139
*NONTRC:                                                           0139
*     DO;                                                          0139
NONTRC   DS    0H                                                  0140
*       IF RECFID='01'X THEN        /* TIME-STAMP RECORD             */
         L     @14,CURREC(,AEDITCBR)                               0140
         CLI   RECFID(@14),X'01'                                   0140
         BNE   @RF00140                                            0140
*TIMEREC:                                                          0141
*         DO;                                                      0141
*                                                                  0141
TIMEREC  DS    0H                                                  0142
*           /*********************************************************/
*           /*                                                       */
*           /* TEST STOP-TIME TO DETERMINE IF ALL RECORDS HAVE BEEN  */
*           /* PROCESSED - FIRST MUST CHECK IF STOP-TIME HAS BEEN    */
*           /* SPECIFIED. IF NOT STOP-TIME NOT SPECIFIED OR NOT      */
*           /* PASSED, BRANCH TO CHANNEL RECORD TO AMDPRCON.         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0142
*           IF STOPTIME='            ' THEN                        0142
         CLC   STOPTIME(12,AEDITCBR),@CC00379                      0142
         BE    @RT00142                                            0142
*             GO TO CONOUT;                                        0143
*           RFY                                                    0144
*            (WREG2) RSTD;                                         0144
*           ADCVTTZ=ADDR(RECVTTZ);  /* ADDR CVT TIME ZONE VALUE      */
         L     @14,CURREC(,AEDITCBR)                               0145
         LA    @10,RECVTTZ(,@14)                                   0145
         ST    @10,ADCVTTZ                                         0145
*           ADTODCLK=ADDR(RECTOD);  /* ADDR TOD VALUE                */
         LA    @14,RECTOD(,@14)                                    0146
         ST    @14,ADTODCLK                                        0146
*           ADTMEBUF=ADDR(TMEBUF);  /* ADDR OUTPUT AREA              */
         LA    @14,TMEBUF                                          0147
         ST    @14,ADTMEBUF                                        0147
*           PARMREG=ADDR(TIMEPARM); /* ADDR PARM LIST IN R 1         */
         LA    PARMREG,TIMEPARM                                    0148
*           WREG2=1;                /* CONVERT TO FULL TIME          */
         LA    WREG2,1                                             0149
*           CALL TODCNVRT;          /* CALL TOD CONVERSION RTN       */
*                                                                  0150
         L     @15,QATMERTN                                        0150
         BALR  @14,@15                                             0150
*           /*********************************************************/
*           /*                                                       */
*           /* MOVE INTO SAVE AREA TIME VALUE IN CURRENT REC         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0151
*           DSAV=DAYYR;                                            0151
         MVC   DSAV(3),DAYYR                                       0151
*           TSAV(1:2)=TOD(1:2);                                    0152
         MVC   TSAV(2),TOD                                         0152
*           TSAV(3:4)=TOD(4:5);                                    0153
         MVC   TSAV+2(2),TOD+3                                     0153
*           TSAV(5:6)=TOD(7:8);                                    0154
*                                                                  0154
         MVC   TSAV+4(2),TOD+6                                     0154
*           /*********************************************************/
*           /*                                                       */
*           /* TEST FOR TIME OVER STOP VALUE                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0155
*           IF ESTOPTME<TIMSAVE THEN                               0155
         CLC   ESTOPTME(9,AEDITCBR),TIMSAVE                        0155
         BNL   @RF00155                                            0155
*TSTOP:                                                            0156
*             DO;                   /* STOP BECAUSE TIME LIMIT Y3316 */
TSTOP    DS    0H                                                  0157
*               TERM='1'B;          /* SIGNAL AMDPRGET TO CLOSE DOWN */
         OI    TERM(AEDITCBR),B'01000000'                          0157
*               GO TO NEXTRTN;      /* BRANCH BACK TO ROUTINE      0158
*                                      SELECT-N                      */
         B     NEXTRTN                                             0158
*             END TSTOP;                                           0159
*           ELSE                                                   0160
*             GO TO CONOUT;         /* STOP-TIME HAS NOT PASSED -  0160
*                                      SEND RECORD TO CALLCON        */
*         END TIMEREC;                                             0161
*       IF RECFID='02'X×            /* LOST-DATA RECORD        Y02014*/
*           RECFID='03'X THEN       /* LOST-BLOCK RECORD       Y02014*/
@RF00140 L     @14,CURREC(,AEDITCBR)                               0162
         CLI   RECFID(@14),X'02'                                   0162
         BE    @RT00162                                            0162
         CLI   RECFID(@14),X'03'                                   0162
         BNE   @RF00162                                            0162
@RT00162 DS    0H                                                  0163
*LOSTREC:                                                          0163
*         DO;                                                      0163
*                                                                  0163
LOSTREC  DS    0H                                                  0164
*           /*********************************************************/
*           /*                                                       */
*           /* BRANCH HERE TO CHANNEL RECORD TO NON-TRACE FORMAT     */
*           /* ROUTINE - AMDPRCON                                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0164
*CONOUT:                                                           0164
*           DRVCON='1'B;            /* TURN ON CALLCON BIT IN DRIVER */
CONOUT   OI    DRVCON,B'00000010'                                  0164
*           GO TO NEXTRTN;          /* BRANCH BACK TO ROUTINE      0165
*                                      SELECT-N                      */
         B     NEXTRTN                                             0165
*         END LOSTREC;                                             0166
*                                                                  0166
*       /*************************************************************/
*       /*                                                           */
*       /* IGNORE RECORDS WHICH ARE NOT TIME-STAMP OR LOST-DATA      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0167
*       GO TO NEXTRTN;                                             0167
         B     NEXTRTN                                             0167
*     END NONTRC;                                                  0168
*                                                                  0168
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR EVENT TRACE RECORD                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0169
*   IF RECAID='FF'X THEN            /* TRACE RECORD -                */
@RF00138 L     @14,CURREC(,AEDITCBR)                               0169
         CLI   RECAID(@14),X'FF'                                   0169
         BNE   @RF00169                                            0169
*     DRVFLT='1'B;                  /* CHANNEL TO AMDPRFLT           */
*                                                                  0170
         OI    DRVFLT,B'00000001'                                  0170
*   /*****************************************************************/
*   /*                                                               */
*   /* BRANCH BACK TO ROUTINE SELECTION                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0171
*   GO TO NEXTRTN;                  /* NON-GTF RECORD ARE IGNORED  0171
*                                      BECAUSE NEITHER CALLCON NOR 0171
*                                      CALLFLT HAVE BEEN TURNED ON   */
         B     NEXTRTN                                             0171
*                                                                  0172
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*  POSITION TO START TIME.  IF USER HAS NOT SPECIFIED START TIME,  */
*/*  THEN POSITION TO FIRST TIME-STAMP RECORD                        */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0172
*POSIT:                                                            0172
*   IF EXTTRC='0'B THEN             /* DUMP DATA SET           Y02014*/
POSIT    TM    EXTTRC(AEDITCBR),B'00000100'                        0172
         BNZ   @RF00172                                            0172
*     DO;                                                          0173
*       DRVDUMP='1'B;               /* RECORD TO DUMP RTN      Y02014*/
         OI    DRVDUMP,B'00010000'                                 0174
*       GOTO SAVEOPTS;              /* GO SAVE GTF OPT WD      Y02014*/
         B     SAVEOPTS                                            0175
*     END;                                                         0176
*   IF RECAID^='00'X×               /* IGNORE ALL BUT TIME STAMP REC */
*       RECFID^='01'X THEN                                         0177
@RF00172 L     @14,CURREC(,AEDITCBR)                               0177
         CLI   RECAID(@14),X'00'                                   0177
         BNE   @RT00177                                            0177
         CLI   RECFID(@14),X'01'                                   0177
         BNE   @RT00177                                            0177
*     GO TO NEXTRTN;                /* GO BACK TO ROUTINE SELECTION
*                                      TO REPEAT GET-POSIT SEQUENCE  */
*                                                                  0178
*   /*****************************************************************/
*   /*                                                               */
*   /* SCREEN OUT CASE WHERE STOP TIME ISN-T IN DATA SET. IF FIRST   */
*   /* TIME THROUGH, ISSUE ERROR MESSAGE. ON SUBSEQUENT TIMES, FORCE */
*   /* AN END OF FILE SITUATION AND ISSUE MSG AMD226I                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0179
*   RFY                                                            0179
*    (WREG2) RSTD;                                                 0179
*   TSFOUND='1'B;                   /* TIME STAMP FOUND        Y02014*/
         OI    TSFOUND(AEDITCBR),B'00100000'                       0180
*   ADCVTTZ=ADDR(RECVTTZ);          /* ADDR CVT TIME ZONE VALUE      */
         LA    @10,RECVTTZ(,@14)                                   0181
         ST    @10,ADCVTTZ                                         0181
*   ADTODCLK=ADDR(RECTOD);          /* ADDR TOD VALUE                */
         LA    @14,RECTOD(,@14)                                    0182
         ST    @14,ADTODCLK                                        0182
*   ADTMEBUF=ADDR(TMEBUF);          /* ADDR OUTPUT AREA              */
         LA    @14,TMEBUF                                          0183
         ST    @14,ADTMEBUF                                        0183
*   PARMREG=ADDR(TIMEPARM);         /* ADDR PARM LIST IN R 1         */
         LA    PARMREG,TIMEPARM                                    0184
*   WREG2=1;                        /* CONVERT TO FULL TIME          */
         LA    WREG2,1                                             0185
*   CALL TODCNVRT;                  /* CALL TOD CONVERSION RTN       */
*                                                                  0186
         L     @15,QATMERTN                                        0186
         BALR  @14,@15                                             0186
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE INTO SAVE AREA TIME VALUE IN CURRENT REC                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0187
*   DSAV=DAYYR;                                                    0187
         MVC   DSAV(3),DAYYR                                       0187
*   TSAV(1:2)=TOD(1:2);                                            0188
         MVC   TSAV(2),TOD                                         0188
*   TSAV(3:4)=TOD(4:5);                                            0189
         MVC   TSAV+2(2),TOD+3                                     0189
*   TSAV(5:6)=TOD(7:8);                                            0190
*                                                                  0190
         MVC   TSAV+4(2),TOD+6                                     0190
*/* FIRST TEST FOR TIME TOO EARLY                                    */
*                                                                  0191
*   IF STOPTIME='            ' THEN                                0191
         CLC   STOPTIME(12,AEDITCBR),@CC00379                      0191
         BE    @RT00191                                            0191
*     GO TO STARTEST;               /* DON T POSITION BY STOP TIME   */
*   IF ESTOPTME<TIMSAVE THEN        /* STOP TIME WITHIN D S ?        */
         CLC   ESTOPTME(9,AEDITCBR),TIMSAVE                        0193
         BNL   @RF00193                                            0193
*NOSTOP:                                                           0194
*     DO;                                                          0194
NOSTOP   DS    0H                                                  0195
*       TERM='1'B;                  /* SIGNAL GET TO CLOSE DOWN      */
         OI    TERM(AEDITCBR),B'01000000'                          0195
*       IF STPSW='0'B THEN                                         0196
         TM    STPSW,B'01000000'                                   0196
         BNZ   @RF00196                                            0196
*         DO;                       /* TEST IF 1ST TIME THROUGH M4465*/
*           SYNMSGA=ADDR(AMDPRE02); /* POINT TO ADDR OF MESSAGE    0198
*                                      AMD226I IN AMDPRFMG           */
         L     @14,AFMG(,AEDITCBR)                                 0198
         LA    @14,AMDPRE02(,@14)                                  0198
         ST    @14,SYNMSGA                                         0198
*           GEN(OI   SWD,NOSTDMG);  /* INDICATE STANDARD MESSAGE   0199
*                                      AMD165I IS NOT REQUIRED       */
         OI   SWD,NOSTDMG
*           REG15=ASYNTAX;          /* POINT TO MESSAGE WRITER       */
         L     REG15,ASYNTAX                                       0200
*           CALL SYNTAXB;           /* CALL MESSAGE WRITER - AMDPRSYN*/
         BAL   @14,SYNTAXB                                         0201
*         END;                      /* M4465                         */
*       ELSE                                                       0203
*         GETEOF='1'B;              /* DUMMY END OF FILE M4465       */
         B     @RC00196                                            0203
@RF00196 OI    GETEOF(AEDITCBR),B'10000000'                        0203
*       GO TO NEXTRTN;              /* BRANCH BACK TO ROUTINE      0204
*                                      SELECTION - NEXT ROUTINE WILL
*                                      BE CALLGET AND THEN TERMEDIT  */
         B     NEXTRTN                                             0204
*     END NOSTOP;                                                  0205
*   STPSW='1'B;                     /* SET NOT 1ST TIME SW M4465     */
*                                                                  0206
@RF00193 OI    STPSW,B'01000000'                                   0206
*   /*****************************************************************/
*   /*                                                               */
*   /* HAS START TIME BEEN SPECIFIED                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0207
*STARTEST:                                                         0207
*   IF STARTIME='            ' THEN                                0207
STARTEST CLC   STARTIME(12,AEDITCBR),@CC00379                      0207
         BE    @RT00207                                            0207
*     GO TO SETEXT;                 /* IF NOT, POSITIONING IS OK     */
*                                                                  0208
*   /*****************************************************************/
*   /*                                                               */
*   /* IF START-TIME HAS BEEN SPECIFIED, TEST FOR RECORD-TIME LESS   */
*   /* THAN START-TIME - 1-ST TEST FOR DAY OF TIME STAMP RECORD NOT  */
*   /* UP TO START VALUE                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0209
*   IF TIMSAVE<ESTARTME THEN        /* COMPARE REC TIME TO START TIME*/
         CLC   TIMSAVE(9),ESTARTME(AEDITCBR)                       0209
         BL    @RT00209                                            0209
*     GO TO NEXTRTN;                /* IF SO, BRANCH TO ROUTINE    0210
*                                      SELECTION SO THAT GET-POSIT 0210
*                                      SEQUENCE IS REPEATED          */
*/* BRANCH HERE TO CHANNEL RECORD TO EXTERNAL DATA SET SET-UP        */
*                                                                  0211
*SETEXT:                                                           0211
*   DRVEXT='1'B;                    /* SET EXTERNAL IN DRIVER        */
SETEXT   OI    DRVEXT,B'00001000'                                  0211
*/* SAVE GTF OPTIONS IN EFFECT                                       */
*                                                                  0212
*SAVEOPTS:                                                         0212
*   OPTSAVE=RECGTFOP;                                              0212
SAVEOPTS L     @14,CURREC(,AEDITCBR)                               0212
         MVC   OPTSAVE(4),RECGTFOP(@14)                            0212
*   GTFWDPTR=ADDR(OPTSAVE);         /* POINT TAB TO OPTION WORD SAVE
*                                      AREA                    Y02014*/
         LA    @10,OPTSAVE                                         0213
         ST    @10,GTFWDPTR(,AEDITCBR)                             0213
*   CVTTZONE=RECVTTZ;               /* SAVE TIME ZONE FIELD    Y02014*/
         MVC   CVTTZONE(4,AEDITCBR),RECVTTZ(@14)                   0214
*   DRVTITLE='1'B;                  /* REQUEST TITLING OF FIRST PAGE */
*   DRVCON='1'B;                    /* TURN ON CALLCON SO THAT     0216
*                                      CURRENT RECORD IS FORMATTED   */
*   DRVVALID='1'B;                  /* VALIDITY TO GET CONTROL ON ALL
*                                      SUBSEQUENT RECORDS            */
*   DRVPOSIT='0'B;                  /* TURN OFF BIT FOR THIS ROUTINE
*                                      - POSITIONING NOW COMPLETE    */
         OI    DRVTITLE,B'01000110'                                0218
         NI    DRVPOSIT,B'11011111'                                0218
*   GO TO NEXTRTN;                  /* GO SELECT NEXT ROUTINE        */
         B     NEXTRTN                                             0219
*                                                                  0220
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*  DUMP.  SET GENERAL FLAGS FOR AMDPRAPP.                          */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0220
*DUMP:                                                             0220
*   IF OPTSYSM='1'B THEN                                           0220
DUMP     L     @14,GTFWDPTR(,AEDITCBR)                             0220
         TM    OPTSYSM(@14),B'10000000'                            0220
         BNO   @RF00220                                            0220
*     DO;                           /* TRACE DATA SYSM FORMAT, Y02014*/
*       SYSM='1'B;                  /* INDICATE SUCH IN PRTAB        */
         OI    SYSM(AEDITCBR),B'00010000'                          0222
*       IF JOBNAMES(1)^='        ' THEN/* JOB SELECTION REQUESTED    */
         CLC   JOBNAMES(8,AEDITCBR),@CC00413                       0223
         BNE   @RT00223                                            0223
*         GO TO ASKOP;              /* YES GO ASK OPERATOR     Y02014*/
*     END;                          /*                         Y02014*/
*   ELSE                                                           0226
*     SYS='1'B;                     /* OTHERWISE, INDICATE FULL    0226
*                                      SYSTEM FORMAT                 */
         B     @RC00220                                            0226
@RF00220 OI    SYS(AEDITCBR),B'00100000'                           0226
*DUMPEXT:                           /* RETURN FROM ASKING OPERATOR 0227
*                                                              Y02014*/
*   DRVDUMP='0'B;                   /* DUMP SET-UP COMPLETE          */
@RC00220 DS    0H                                                  0227
DUMPEXT  NI    DRVDUMP,B'11101111'                                 0227
*   GO TO NEXTRTN;                  /* GO BACK TO SELECT NEXT ROUTINE*/
         B     NEXTRTN                                             0228
*                                                                  0229
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*  EXTERNAL.  SET-UP TO PROCESS EXTERNAL TRACE DATA SET.           */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0229
*EXTERNAL:                                                         0229
*   IF OPTSYSM^='1'B THEN           /* FULL SYSTEM FORMAT-OK   Y02014*/
*                                                                  0229
EXTERNAL L     @14,GTFWDPTR(,AEDITCBR)                             0229
         TM    OPTSYSM(@14),B'10000000'                            0229
         BO    @RF00229                                            0229
*     /***************************************************************/
*     /*                                                             */
*     /* (IF SYSM, CAN'T HAVE JOB SELECTIVITY)                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0230
*EXTOK:                                                            0230
*     DO;                                                          0230
EXTOK    DS    0H                                                  0231
*       TITLSAVE=TITLEMOD;          /* SAVE AMDPRDMP-S PAGE TITLE    */
         MVC   TITLSAVE(47),TITLEMOD                               0231
*       EXTITLE='1'B;               /* INDICATE TITLE SAVED          */
         OI    EXTITLE,B'10000000'                                 0232
*       EXTTITL(21:28)=DDNAME;      /* FIND IN DDNAME VALUE IN TITLE */
         MVC   EXTTITL+20(8),DDNAME(AEDITCBR)                      0233
*       TITLEMOD=EXTTITL;           /* REPLACE AMDPRDMP-S TITLE WITH
*                                      EDIT-S                        */
         MVC   TITLEMOD(47),EXTTITL                                0234
*       DRVEXT='0'B;                /* EXTERNAL SET-UP COMPLETE      */
         NI    DRVEXT,B'11110111'                                  0235
*       GO TO NEXTRTN;              /* GO TO ROUTINE SELECTION       */
         B     NEXTRTN                                             0236
*     END EXTOK;                                                   0237
*                                                                  0237
*   /*****************************************************************/
*   /*                                                               */
*   /* VERIFY JOB SELECTION IS NOT REQUESTED FOR SYSM TRACE    Y02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0238
*   IF JOBNAMES(1)='        ' THEN                                 0238
@RF00229 CLC   JOBNAMES(8,AEDITCBR),@CC00413                       0238
         BE    @RT00238                                            0238
*     GO TO EXTOK;                                                 0239
*                                                                  0239
*   /*****************************************************************/
*   /*                                                               */
*   /* IF JOB SELECTION IS REQUESTED, THEN EITHER: 1: TERM. EDIT IF  */
*   /* COMMANDS ARE COMMING FROM SYSIN, OR 2) ASK OPERATOR FOR       */
*   /* PERMISSION TO CONTINUE IF COMMANDS ARE COMMING FROM CONSOLE.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*   ELSE                                                           0240
*ASKOP:                                                            0240
*     DO;                                                          0240
ASKOP    DS    0H                                                  0241
*       SYNMSGA=ADDR(AMDPRE09);     /* POINT TO ADDR OF MESSAGE    0241
*                                      AMD217I                       */
         L     @14,AFMG(,AEDITCBR)                                 0241
         LA    @14,AMDPRE09(,@14)                                  0241
         ST    @14,SYNMSGA                                         0241
*       GEN(OI  SWD,NOSTDMG);       /* INDICATE STANDARD MESSAGE   0242
*                                      AMD165I IS NOT REQUIRED       */
         OI  SWD,NOSTDMG
*       REG15=ASYNTAX;              /* POINT TO MESSAGE WRITER       */
         L     REG15,ASYNTAX                                       0243
*       CALL SYNTAXA;               /* CALL MESSAGE WRITE - AMDPRSYN */
         BAL   @14,SYNTAXA                                         0244
*       GEN;                                                       0245
         TM    SWA,RDRSW           TEST SOURCE OF CONTROL STATEMENTS
         BO    SETTERM             RDR SWITCH '1'B MEANS CARDS IN SYSIN
*                                  DATA SET - SO BRANCH TO SET TERM
*                                  IN DRIVER
*OPERR:                                                            0246
*       ECB=0;                      /* CLEAR ECB FOR WTOR            */
OPERR    SLR   ECB,ECB                                             0246
*       RFY                                                        0247
*        (REG1) RSTD;                                              0247
*       REG1=AMDPRE10;              /* POINT TO WTOR LIST IN AMDPRFMG*/
*                                                                  0248
         L     @14,AFMG(,AEDITCBR)                                 0248
         L     REG1,AMDPRE10(,@14)                                 0248
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE MESSAGE AMD218D TO OPERATOR                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0249
*       GEN;                                                       0249
         WTOR  ,REPLY,1,ECB,MF=(E,(1))
         WAIT  ECB=ECB             WAIT FOR REPLY
*       REPLY=REPLY×'40'X;          /* MAKE REPLY CAPS               */
         OI    REPLY,X'40'                                         0250
*       REG1=AMDPRE10+12;           /* POINT TO MESSAGE TEXT TO WRITE
*                                      ON SYSPRINT                   */
         L     @14,AFMG(,AEDITCBR)                                 0251
         LA    REG1,12                                             0251
         AL    REG1,AMDPRE10(,@14)                                 0251
*       GEN;                                                       0252
         BRPRTMSG  (R1),65      /* PRINT MESSAGE ON SYSPRINT
*                                  USE INDENTIFIER R1 TO INDICATE
*                                  THAT REG 1 IS ALREADY LOADED      */
         BRPRTMSG  REPLY,1      /* PRINT REPLY ON SYSPRINT           */
*       RFY                                                        0253
*        (REG1) UNRSTD;                                            0253
*       IF REPLY='C' THEN           /* TEST FOR GO-AHEAD             */
*                                                                  0254
         CLI   REPLY,C'C'                                          0254
         BNE   @RF00254                                            0254
*         /***********************************************************/
*         /*                                                         */
*         /* OPERATOR SAYS OK                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0255
*CONT:                                                             0255
*         DO;                                                      0255
CONT     DS    0H                                                  0256
*           DO I=5 TO 1 BY-1;       /* CLEAR JOB ARRAY         Y02014*/
         LA    @14,5                                               0256
         ST    @14,I                                               0256
@DL00256 DS    0H                                                  0257
*             JOBNAMES(I)=' ';                                     0257
         LR    @10,@14                                             0257
         SLA   @10,3                                               0257
         ALR   @10,AEDITCBR                                        0257
         MVI   JOBNAMES-7(@10),C' '                                0257
         MVC   JOBNAMES-6(6,@10),JOBNAMES-7(@10)                   0257
         MVI   JOBNAMES-8(@10),C' '                                0257
*           END;                                                   0258
         BCTR  @14,0                                               0258
         ST    @14,I                                               0258
         LTR   @14,@14                                             0258
         BP    @DL00256                                            0258
*           IF EXTTRC='1'B THEN     /* EXTERNAL DATA SET       Y02014*/
         TM    EXTTRC(AEDITCBR),B'00000100'                        0259
         BO    @RT00259                                            0259
*             GOTO EXTOK;           /* COMPLETE EXTERNAL SET UP    0260
*                                                              Y02014*/
*           ELSE                                                   0261
*             GOTO DUMPEXT;         /* COMPLETE DUMP SET UP    Y02014*/
         B     DUMPEXT                                             0261
*         END CONT;                                                0262
*       IF REPLY='S' THEN           /* TEST FOR 'S' - STOP REQUESTED */
*                                                                  0263
@RF00254 CLI   REPLY,C'S'                                          0263
         BNE   @RF00263                                            0263
*         /***********************************************************/
*         /*                                                         */
*         /* OPERATOR SAYS DO NOT CONTINUE, SO SET UP FOR EDIT       */
*         /* TERMINATION                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0264
*SETTERM:                                                          0264
*         DO;                                                      0264
SETTERM  DS    0H                                                  0265
*           DRVTERM='1'B;           /* REQUEST TERM ROUTINE          */
*           DRVTITLE='0'B;          /* DON-T TITLE AND               */
*           DRVCON='0'B;            /* DON-T FORMAT CURRENT RECORD   */
         OI    DRVTERM,B'10000000'                                 0267
         NI    DRVTITLE,B'11111001'                                0267
*           TERM='1'B;              /* INDICATE EDIT STOPPING        */
         OI    TERM(AEDITCBR),B'01000000'                          0268
*           GO TO NEXTRTN;          /* GO BACK TO ROUTINE SELECTION,
*                                      GET-TERM WILL BE CALLED       */
         B     NEXTRTN                                             0269
*         END SETTERM;                                             0270
*       ELSE                                                       0271
*         GO TO OPERR;              /* NOT 'C' OR 'S' MEAN ERROR IN
*                                      REPLY - REISSUE MSG AMD218D   */
*     END ASKOP;                                                   0272
*                                                                  0273
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*  TITLE EDIT OUTPUT AND PRINT GTF OPTIONS                         */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0273
*PRNTITLE:                                                         0273
*   GEN(BRWRITE  1,IMM);            /* SKIP TO CLEAN PAGE, PREP M4381*/
PRNTITLE BRWRITE  1,IMM
*   GEN(BRWRITE  SKIP);             /* SKIP TO CLEAN PAGE            */
         BRWRITE  SKIP
*   OUTBUF(45:73)=MAINTITL;         /* MAIN TITLE TO OUTPUT AREA     */
         L     @14,CURBUF                                          0275
         MVC   OUTBUF+44(29,@14),MAINTITL                          0275
*   GEN(BRWRITE 3);                 /* PRINT TITLE                   */
         BRWRITE 3
*   RFY                                                            0277
*    (REG2,                                                        0277
*     REG3) RSTD;                   /* REGISTER USAGE IN TITLE     0277
*                                      ROUTINE REG 2 - LENGTH OF DATA
*                                      BEING MOVED TO OUTPUT LINE REG
*                                      3 - DURING INIT, OFFSET INTO
*                                      LINE, AFTER INIT, ADDR OF   0277
*                                      VALUE OF CURRENT GTF OPTION   */
*                                                                  0277
*   /*****************************************************************/
*   /*                                                               */
*   /* DATAPTR IS INDEX INTO STRING OF LABELS FOR GTF OPTIONS        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0278
*   DATAPTR=1;                      /* START WITH 1-ST BYTE OF OPTION
*                                      LIST                          */
         LA    @14,1                                               0278
         ST    @14,DATAPTR                                         0278
*   DO I=1 TO 14;                   /* LOOP TO PRINT LINES IN GTF  0279
*                                      OPTION DISPLAY                */
         ST    @14,I                                               0279
@DL00279 DS    0H                                                  0280
*     REG2=OPTSOFF(I);              /* GET LENGTH OF CURRENT OPTION  */
         SLR   REG2,REG2                                           0280
         IC    REG2,OPTSOFF-1(@14)                                 0280
*     REG3=58-REG2;                 /* COMPUTE INDEX INTO OUTPUT BUF
*                                      WHERE OPTION SHOULD BE PLACED */
*                                                                  0281
         LA    @10,58                                              0281
         LR    REG3,@10                                            0281
         SLR   REG3,REG2                                           0281
*     /***************************************************************/
*     /*                                                             */
*     /* MOVE CURRENT OPTION TO OUTPUT LINE                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0282
*     OUTBUF(REG3:58)=OPTS(DATAPTR:DATAPTR+REG2);                  0282
*                                                                  0282
         L     @08,CURBUF                                          0282
         LR    @07,@08                                             0282
         ALR   @07,REG3                                            0282
         SLR   @10,REG3                                            0282
         L     @06,DATAPTR                                         0282
         LA    @14,OPTS-1(@06)                                     0282
         EX    @10,@SM00508                                        0282
*     /***************************************************************/
*     /*                                                             */
*     /* UPDATE INDEX INTO VALUE STRING AND ACCOUNT FOR OPTSOFF      */
*     /* MEMBER BEING 1-LESS                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0283
*     DATAPTR=DATAPTR+REG2+1;                                      0283
         ALR   @06,REG2                                            0283
         AL    @06,@CF00069                                        0283
         ST    @06,DATAPTR                                         0283
*     OUTBUF(59)='=';               /* MOVE EQUAL SIGN TO OUTPUT LINE*/
         MVI   OUTBUF+58(@08),C'='                                 0284
*     REG2=I*4;                     /* COMPUTE OFFSET INTO BRANCH TAB*/
         L     @14,I                                               0285
         SLA   @14,2                                               0285
         LR    REG2,@14                                            0285
*     GEN;                                                         0286
*                                                                  0286
BRTAB    B     BRTAB(R2)           BRANCH TABLE TO SELECT TESTING
*                                  ROUTINE FOR EACH GTF OPTION
         B     FORMAT              SYS OR SYSM TRACE RECORD FORMATX
         B     SVCOP               SVC-S:  ALL, NONE OR SELECTIVE
         B     SIOOP               SIO-S:  ALL, NONE OR SELECTIVE
         B     PIOP                PGM INTERRUPTS:  ALL, NONE OR
*                                  SELECTIVE
         B     IOOP                I/O INTERRUPTS:  ALL, NONE OR
*                                  SELECTIVE
         B     EXTOP               TRACING EXTERNAL INTERRUPTS
         B     RROP                RR TRACING                    Y02014
         B     USROP               USER TRACES
         B     GTF                 TRACING GTF INTERRUPTS
         B     DSPOP               TRACING DISPATCHES
         B     PCI                 TRACING PCI INTERRUPTS
         B     RNIOOP              RNIO TRACING                  Y02014
         B     SRMOP               SRM TRACING                   Y02014
         B     USERTIME            USER TIME-STAMP IN EACH RECORD
*     /***************************************************************/
*     /*                                                             */
*     /* FORMAT OPTION                                               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0287
*FORMAT:                                                           0287
*     IF OPTSYSM='1'B THEN          /* TEST FOR SYSM FORMAT    Y02014*/
FORMAT   L     @14,GTFWDPTR(,AEDITCBR)                             0287
         TM    OPTSYSM(@14),B'10000000'                            0287
         BNO   @RF00287                                            0287
*       DO;                         /* IF SO,                        */
*         REG2=3;                   /* SET LENGTH OF 'SYSM' - OPTION
*                                      VALUE                         */
*                                                                  0289
         LA    REG2,3                                              0289
*         /***********************************************************/
*         /*                                                         */
*         /* POINT TO OPTION VALUE                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0290
*         REG3=ADDR(SYSMLAB);                                      0290
*                                                                  0290
         LA    REG3,SYSMLAB                                        0290
*         /***********************************************************/
*         /*                                                         */
*         /* *** BSL DEPENDENT AND TRICKY *** UPDATE LOOP COUNTER TO */
*         /* SKIP SVC, SIO, PI, I/O, RR AND EXT OPTIONS BECAUSE THESE*/
*         /* ARE IMPLIED YES BY SYSM                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0291
*         I=7;                      /*                         Y02014*/
*                                                                  0291
         MVC   I(4),@CF00080                                       0291
*         /***********************************************************/
*         /*                                                         */
*         /* UPDATE DATA POINTER TO POSITION TO CORRECT LABEL        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0292
*         DATAPTR=DATAPTR+15;       /*                         Y02014*/
         LA    @14,15                                              0292
         AL    @14,DATAPTR                                         0292
         ST    @14,DATAPTR                                         0292
*         GO TO MOVEVAL;            /* GO MOVE OPTION VALUE TO OUTPUT*/
         B     MOVEVAL                                             0293
*       END;                                                       0294
*     ELSE                                                         0295
*       DO;                         /* IF NOT SYSM, MUST BE FULL SYS
*                                      FORMAT                        */
@RF00287 DS    0H                                                  0296
*         REG2=2;                   /* SET LENGTH OF OPTION VALUE    */
         LA    REG2,2                                              0296
*         REG3=ADDR(SYSLAB);        /* POINT TO VALUE                */
         LA    REG3,SYSLAB                                         0297
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */
         B     MOVEVAL                                             0298
*       END;                                                       0299
*                                                                  0299
*     /***************************************************************/
*     /*                                                             */
*     /* SVC OPTION - FIRST TEST FOR SELECT SVC TRACING - SVC        */
*     /* PROMPTING                                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0300
*SVCOP:                                                            0300
*     IF OPTSVCP='1'B THEN                                         0300
SVCOP    L     @14,GTFWDPTR(,AEDITCBR)                             0300
         TM    OPTSVCP(@14),B'01000000'                            0300
         BO    @RT00300                                            0300
*       GO TO SELECTVE;             /*                         Y02014*/
*                                                                  0301
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT SELECTIVE TRACING, CHECK FOR ALL BY TESTING SVC ALL  */
*     /* BIT OR                                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0302
*     IF OPTSVC='1'B×OPTSYS='1'B THEN/* ALL SVC OR SYS PMTING  Y02014*/
         TM    OPTSVC(@14),B'10000000'                             0302
         BO    @RT00302                                            0302
         TM    OPTSYS(@14),B'00100000'                             0302
         BO    @RT00302                                            0302
*       GO TO ALL;                                                 0303
*     ELSE                                                         0304
*       GO TO NONE;                 /* LABEL SVC-S AS NONE           */
*                                                                  0304
         B     NONE                                                0304
*     /***************************************************************/
*     /*                                                             */
*     /* SIO OPTION - FIRST TEST FOR TRACING BY SELECT DEVICE - SIO  */
*     /* PROMPTING                                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0305
*SIOOP:                                                            0305
*     IF OPTSIOP='1'B THEN                                         0305
SIOOP    L     @14,GTFWDPTR(,AEDITCBR)                             0305
         TM    OPTSIOP(@14),B'00010000'                            0305
         BO    @RT00305                                            0305
*       GO TO SELECTVE;             /*                         Y02014*/
*                                                                  0306
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT SELECTIVE TRACING, CHECK FOR ALL BY TESTING SIO ALL  */
*     /* BIT OR                                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0307
*     IF OPTSIO='1'B×OPTSYS='1'B THEN/* ALL SIO OR SYS         Y02014*/
         TM    OPTSIO(@14),B'00100000'                             0307
         BO    @RT00307                                            0307
         TM    OPTSYS(@14),B'00100000'                             0307
         BO    @RT00307                                            0307
*       GO TO ALL;                                                 0308
*     ELSE                                                         0309
*       GO TO NONE;                 /* LABEL SIO-S AS NONE           */
*                                                                  0309
         B     NONE                                                0309
*     /***************************************************************/
*     /*                                                             */
*     /* PI OPTION - TEST FOR TRACING OF SELECT PGM INTERRUPTS - PI  */
*     /* PROMPT                                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0310
*PIOP:                                                             0310
*     IF OPTPIP='1'B THEN                                          0310
PIOP     L     @14,GTFWDPTR(,AEDITCBR)                             0310
         TM    OPTPIP(@14),B'00000100'                             0310
         BO    @RT00310                                            0310
*       GO TO SELECTVE;             /*                         Y02014*/
*                                                                  0311
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT SELECTIVE TRACING, CHECK FOR ALL BY TESTING PI ALL   */
*     /* BIT OR                                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0312
*     IF OPTPI='1'B×OPTSYS='1'B THEN/* ALL PI OR SYS PROMPTING Y02014*/
         TM    OPTPI(@14),B'00001000'                              0312
         BO    @RT00312                                            0312
         TM    OPTSYS(@14),B'00100000'                             0312
         BO    @RT00312                                            0312
*       GO TO ALL;                                                 0313
*     ELSE                                                         0314
*       GO TO NONE;                 /* LABEL PI-S AS NONE            */
*                                                                  0314
         B     NONE                                                0314
*     /***************************************************************/
*     /*                                                             */
*     /* I/O OPTION - TEST FOR SELECTIVE IO BECAUSE OF IO=SIO        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0315
*IOOP:                                                             0315
*     IF OPTIOSIO='1'B THEN         /*                         Y02014*/
IOOP     L     @14,GTFWDPTR(,AEDITCBR)                             0315
         TM    OPTIOSIO(@14),B'00000001'                           0315
         BNO   @RF00315                                            0315
*MVSIO:                                                            0316
*       DO;                         /* PRINT 'SIO' VALUE OF IO OPTION*/
MVSIO    DS    0H                                                  0317
*         REG2=2;                   /* SET LENGTH OF VALUE           */
         LA    REG2,2                                              0317
*         REG3=ADDR(SIOLAB);        /* POINT TO VALUE                */
         LA    REG3,SIOLAB                                         0318
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */
         B     MOVEVAL                                             0319
*       END MVSIO;                                                 0320
*                                                                  0320
*     /***************************************************************/
*     /*                                                             */
*     /* TEST FOR TRACING OF I/O INTERRUPTS BY SELECT DEVICE - I/O   */
*     /* PROMPTING                                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0321
*     IF OPTIOP='1'B THEN           /*                         Y02014*/
@RF00315 L     @14,GTFWDPTR(,AEDITCBR)                             0321
         TM    OPTIOP(@14),B'00000001'                             0321
         BNO   @RF00321                                            0321
*SELECTVE:                                                         0322
*       DO;                         /* PRINT 'SELECTIVE' OPTION VALUE*/
SELECTVE DS    0H                                                  0323
*         REG2=8;                   /* SET LENGTH OF 'SELECTIVE'     */
*                                                                  0323
         LA    REG2,8                                              0323
*         /***********************************************************/
*         /*                                                         */
*         /* POINT TO OPTION VALUE                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0324
*         REG3=ADDR(SELECTLB);                                     0324
         LA    REG3,SELECTLB                                       0324
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */
         B     MOVEVAL                                             0325
*       END SELECTVE;                                              0326
*                                                                  0326
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT SELECTIVE TRACING, CHECK FOR ALL BY TESTING I/O ALL  */
*     /* BIT OR                                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0327
*     IF OPTIO='1'B×OPTSYS='1'B THEN/* ALL IO OR SYS PROMPTING Y02014*/
@RF00321 L     @14,GTFWDPTR(,AEDITCBR)                             0327
         TM    OPTIO(@14),B'00000010'                              0327
         BO    @RT00327                                            0327
         TM    OPTSYS(@14),B'00100000'                             0327
         BNO   @RF00327                                            0327
@RT00327 DS    0H                                                  0328
*ALL:                                                              0328
*       DO;                         /* PRINT 'ALL' VALUE OF OPTIONS  */
ALL      DS    0H                                                  0329
*         REG2=2;                   /* SET LENGTH OF 'ALL'           */
         LA    REG2,2                                              0329
*         REG3=ADDR(ALLAB);         /* POINT TO VALUE                */
         LA    REG3,ALLAB                                          0330
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */
         B     MOVEVAL                                             0331
*       END ALL;                                                   0332
*                                                                  0332
*     /***************************************************************/
*     /*                                                             */
*     /* LABEL I/O-S AS NONE                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0333
*     ELSE                                                         0333
*NONE:                                                             0333
*       DO;                         /* PRINT 'NONE' OPTION           */
@RF00327 DS    0H                                                  0333
NONE     DS    0H                                                  0334
*         REG2=3;                   /* SET LENGTH OF VALUE           */
*                                                                  0334
         LA    REG2,3                                              0334
*         /***********************************************************/
*         /*                                                         */
*         /* POINT TO OPTION VALUE                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0335
*         REG3=ADDR(NONELAB);                                      0335
         LA    REG3,NONELAB                                        0335
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */
         B     MOVEVAL                                             0336
*       END NONE;                                                  0337
*                                                                  0337
*     /***************************************************************/
*     /*                                                             */
*     /* EXT OPTION - TEST FOR YES BY OR OF EXT, ALL SYS, AND SYSP   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0338
*EXTOP:                                                            0338
*     IF OPTEXT='1'B×               /*                         Y02014*/
*         OPTSYS='1'B×              /*                         Y02014*/
*         OPTSYSP='1'B THEN                                        0338
EXTOP    L     @14,GTFWDPTR(,AEDITCBR)                             0338
         TM    OPTEXT(@14),B'10000000'                             0338
         BO    @RT00338                                            0338
         TM    OPTSYS(@14),B'01100000'                             0338
         BNZ   @RT00338                                            0338
*       GO TO YES;                  /*                         Y02014*/
*     ELSE                                                         0340
*       GO TO NO;                                                  0340
*                                                                  0340
         B     NO                                                  0340
*     /***************************************************************/
*     /*                                                             */
*     /* RR OPTION BY OR OF RR ALL SYS AND SYSP                Y02014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0341
*RROP:                                                             0341
*     IF OPTRR='1'B×                /*                         Y02014*/
*         OPTSYS='1'B×              /*                         Y02014*/
*         OPTSYSP='1'B THEN                                        0341
RROP     L     @14,GTFWDPTR(,AEDITCBR)                             0341
         TM    OPTRR(@14),B'00010000'                              0341
         BO    @RT00341                                            0341
         TM    OPTSYS(@14),B'01100000'                             0341
         BNZ   @RT00341                                            0341
*       GOTO YES;                   /*                         Y02014*/
*     ELSE                                                         0343
*       GOTO NO;                    /*                         Y02014*/
*                                                                  0343
         B     NO                                                  0343
*     /***************************************************************/
*     /*                                                             */
*     /* RNIO OPTION INDICATED                                 Y02014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0344
*RNIOOP:                            /*                         Y02014*/
*     IF OPTRNIO='1'B THEN                                         0344
RNIOOP   L     @14,GTFWDPTR(,AEDITCBR)                             0344
         TM    OPTRNIO(@14),B'01000000'                            0344
         BO    @RT00344                                            0344
*       GOTO YES;                   /* RNIO OPTION             Y02014*/
*     ELSE                                                         0346
*       GOTO NO;                    /*                         Y02014*/
*                                                                  0346
         B     NO                                                  0346
*     /***************************************************************/
*     /*                                                             */
*     /* SRM OPTION INDICATED                                  Y02014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0347
*SRMOP:                             /*                         Y02014*/
*     IF OPTSRM='1'B THEN                                          0347
SRMOP    L     @14,GTFWDPTR(,AEDITCBR)                             0347
         TM    OPTSRM(@14),B'00100000'                             0347
         BO    @RT00347                                            0347
*       GO TO YES;                  /* SRM OPTION              Y02014*/
*     ELSE                                                         0349
*       GO TO NO;                   /*                         Y02014*/
*                                                                  0349
         B     NO                                                  0349
*     /***************************************************************/
*     /*                                                             */
*     /* USR OPTION INDICATED                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0350
*USROP:                                                            0350
*     IF OPTUSR='1'B THEN                                          0350
USROP    L     @14,GTFWDPTR(,AEDITCBR)                             0350
         TM    OPTUSR(@14),B'00010000'                             0350
         BO    @RT00350                                            0350
*       GO TO YES;                  /*                         Y02014*/
*     ELSE                                                         0352
*       GO TO NO;                                                  0352
*                                                                  0352
         B     NO                                                  0352
*     /***************************************************************/
*     /*                                                             */
*     /* GTF OPTION INDICATED                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0353
*GTF:                                                              0353
*     IF OPTTRC='1'B THEN                                          0353
GTF      L     @14,GTFWDPTR(,AEDITCBR)                             0353
         TM    OPTTRC(@14),B'00001000'                             0353
         BO    @RT00353                                            0353
*       GO TO YES;                  /*                         Y02014*/
*     ELSE                                                         0355
*       GO TO NO;                                                  0355
*                                                                  0355
         B     NO                                                  0355
*     /***************************************************************/
*     /*                                                             */
*     /* DSP OPTION INDICATED                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0356
*DSPOP:                                                            0356
*     IF OPTDSP='1'B THEN                                          0356
DSPOP    L     @14,GTFWDPTR(,AEDITCBR)                             0356
         TM    OPTDSP(@14),B'00000100'                             0356
         BO    @RT00356                                            0356
*       GO TO YES;                  /*                         Y02014*/
*     ELSE                                                         0358
*       GO TO NO;                                                  0358
*                                                                  0358
         B     NO                                                  0358
*     /***************************************************************/
*     /*                                                             */
*     /* PCI OPTION INDICATED                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0359
*PCI:                                                              0359
*     IF OPTPCI='1'B THEN                                          0359
PCI      L     @14,GTFWDPTR(,AEDITCBR)                             0359
         TM    OPTPCI(@14),B'00000001'                             0359
         BO    @RT00359                                            0359
*       GO TO YES;                  /*                         Y02014*/
*     ELSE                                                         0361
*       GO TO NO;                                                  0361
*                                                                  0361
         B     NO                                                  0361
*     /***************************************************************/
*     /*                                                             */
*     /* USERTIME OPTION INDICATED                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0362
*USERTIME:                                                         0362
*     IF OPTTIME='1'B THEN          /*                         Y02014*/
USERTIME L     @14,GTFWDPTR(,AEDITCBR)                             0362
         TM    OPTTIME(@14),B'00000001'                            0362
         BNO   @RF00362                                            0362
*YES:                                                              0363
*       DO;                         /* PRINT 'YES'                   */
YES      DS    0H                                                  0364
*         REG2=2;                   /* SET LENGTH OF VALUE           */
         LA    REG2,2                                              0364
*         REG3=ADDR(YESLAB);        /* POINT TO VALUE                */
         LA    REG3,YESLAB                                         0365
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */
         B     MOVEVAL                                             0366
*       END YES;                                                   0367
*     ELSE                                                         0368
*NO:                                                               0368
*       DO;                         /* PRINT 'NO'                    */
@RF00362 DS    0H                                                  0368
NO       DS    0H                                                  0369
*         REG2=1;                   /* SET LENGTH OF VALUE           */
         LA    REG2,1                                              0369
*         REG3=ADDR(NOLAB);         /* POINT TO VALUE                */
*                                                                  0370
         LA    REG3,NOLAB                                          0370
*         /***********************************************************/
*         /*                                                         */
*         /* FALL THROUGH TO MOVE VALUE TO OUTPUT LINE               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0371
*       END NO;                                                    0371
*                                                                  0371
*     /***************************************************************/
*     /*                                                             */
*     /* BRANCH HERE TO MOVE VALUE OF CURRENT GTF OPTION TO OUTPUT   */
*     /* LINE AND THEN PRINT LINE - OPTVAL BASED ON REG 3 SET ABOVE  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0372
*MOVEVAL:                                                          0372
*     OUTBUF(60:60+REG2)=OPTVAL;                                   0372
MOVEVAL  L     @14,CURBUF                                          0372
         EX    REG2,@SM00510                                       0372
*     GEN(BRWRITE  1);              /* PRINT CURRENT OPTION LINE     */
         BRWRITE  1
*ENDGTFOP:                                                         0374
*   END;                            /* END FOR PRINTING OF A SINGLE
*                                      LINE OF OPTION DISPLAY - LOOP
*                                      TO PRINT NEXT LINE            */
ENDGTFOP LA    @14,1                                               0374
         AL    @14,I                                               0374
         ST    @14,I                                               0374
         C     @14,@CF00310                                        0374
         BNH   @DL00279                                            0374
*   RFY                                                            0375
*    (REG2,                                                        0375
*     REG3) UNRSTD;                 /*                         Y02014*/
*   GEN(BRWRITE  SKIP);             /* GTF OPTIONS ON SEPARATE PAGE  */
         BRWRITE  SKIP
*   DRVTITLE='0'B;                  /* TURN OFF TITLE BIT IN DRIVER  */
         NI    DRVTITLE,B'11111011'                                0377
*   GO TO NEXTRTN;                  /* GO BACK AND SELECT NEXT     0378
*                                      ROUTINE                       */
         B     NEXTRTN                                             0378
*                                                                  0379
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*                            CALLCON                               */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0379
*CALLCON:                                                          0379
*   CALL PRCON;                     /* CALL AMDPRCON TO FORMAT TIME-
*                                      STAMP RECORD                  */
CALLCON  L     @15,ACON                                            0379
         BALR  @14,@15                                             0379
*   DRVCON='0'B;                    /* TURN OFF CALLCON BIT IN DRIVER*/
         NI    DRVCON,B'11111101'                                  0380
*   GO TO NEXTRTN;                  /* GO BACK TO ROUTINE SELECTION  */
         B     NEXTRTN                                             0381
*/********************************************************************
*                                                                    */
*/*                                                                  */
*/*                            CALLFLT                               */
*/*                                                                  */
*/********************************************************************
*                                                                    */
*                                                                  0382
*CALLFLT:                                                          0382
*   CALL PRFLT;                     /* CALL AMDPRFLT TO BEGIN      0382
*                                      PROCESSING OF GTF TRACE RECORD*/
*                                                                  0382
CALLFLT  L     @15,AFLT                                            0382
         BALR  @14,@15                                             0382
*   /*****************************************************************/
*   /*                                                               */
*   /* TERM REQUESTED DURING TRACE RECORD PROCESSING                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0383
*   IF TERM='1'B THEN                                              0383
         TM    TERM(AEDITCBR),B'01000000'                          0383
         BNO   @RF00383                                            0383
*     DRVTERM='1'B;                 /* IF SO, REQUEST TERM ROUTINE IN
*                                      AMDPRFRM                      */
         OI    DRVTERM,B'10000000'                                 0384
*   DRVFLT='0'B;                    /* TURN OFF CALL FLT IN DRIVER   */
@RF00383 NI    DRVFLT,B'11111110'                                  0385
*   GO TO NEXTRTN;                  /* GO BACK TO ROUTINE SELECTION  */
         B     NEXTRTN                                             0386
*   END AMDPRFRM                                                   0387
*                                                                  0387
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMDPRTAB)                                       */
*/*%INCLUDE SYSLIB  (AMDOPTWD)                                       */
*/*%INCLUDE SYSLIB  (RECMAP  )                                       */
*                                                                  0387
*       ;                                                          0387
@DATA    DS    0H
@SM00508 MVC   OUTBUF-1(0,@07),0(@14)
@SM00510 MVC   OUTBUF+59(0,@14),OPTVAL(REG3)
         DS    0F
@SA00001 DS    18F
         DS    0F
@CF00069 DC    F'1'
@CF00080 DC    F'7'
@CF00310 DC    F'14'
@CV00233 DC    V(AMDPRGET)
@CV00234 DC    V(AMDPRHEX)
@CV00235 DC    V(AMDPRCON)
@CV00236 DC    V(AMDPRFLT)
@CV00237 DC    V(AMDPRAPP)
@CV00238 DC    V(AMDPREXT)
@CV00239 DC    V(AMDPRFMG)
@CV00240 DC    V(AMDPRSPI)
@CV00241 DC    V(AMDPRTME)
         DS    0D
I        DS    F
STOPSAVE DS    A
ADDRHOLD DS    A
DATAPTR  DS    A
@CC00379 DC    C'            '
@CC00413 EQU   @CC00379
@CB00374 DC    X'0000'
         DS    CL2
FRMATAB  DS    CL40
         ORG   FRMATAB
AGET     DC    VL4(AMDPRGET)
AHEX     DC    VL4(AMDPRHEX)
ACON     DC    VL4(AMDPRCON)
AFLT     DC    VL4(AMDPRFLT)
AAPP     DC    VL4(AMDPRAPP)
AEXT     DC    VL4(AMDPREXT)
APRFMG   DC    VL4(AMDPRFMG)
ASPI     DC    VL4(AMDPRSPI)
ATME     DC    VL4(AMDPRTME)
FRMRES1  DC    A(0)
         ORG   FRMATAB+40
DRIVER   DS    BL2
         ORG   DRIVER
DRVRSV   DS    BL1
DRVGET   EQU   DRIVER+0
DRVTERM  DS    BL1
DRVVALID EQU   DRIVER+1
DRVPOSIT EQU   DRIVER+1
DRVDUMP  EQU   DRIVER+1
DRVEXT   EQU   DRIVER+1
DRVTITLE EQU   DRIVER+1
DRVCON   EQU   DRIVER+1
DRVFLT   EQU   DRIVER+1
         ORG   DRIVER+2
FRMPTCH  DC    CL200'FRMPTCH'
         DS    CL2
OPTSAVE  DS    CL4
MAINTITL DC    CL29'* * * *    E D I T    * * * *'
OPTS     DC    CL85'GTF OPTIONS IN EFFECT-  FORMATSVCSIOPIIOEXTRRUSRGTFC
               DSPPCIRNIOSRMUSERTIME'
SYSMLAB  DC    CL4'SYSM'
SYSLAB   DC    CL3'SYS'
ALLAB    DC    CL3'ALL'
SELECTLB DC    CL9'SELECTIVE'
SIOLAB   DC    CL3'SIO'
NONELAB  DC    CL4'NONE'
YESLAB   DC    CL3'YES'
NOLAB    DC    CL2'NO'
TITLSAVE DS    CL47
EXTTITL  DC    CL47'EXTERNAL TRACE - DD XXXXXXXX'
REPLY    DS    CL1
FRMSWITC DS    BL1
         ORG   FRMSWITC
EXTITLE  DS    BL1
STPSW    EQU   FRMSWITC+0
SW127    EQU   FRMSWITC+0
         ORG   FRMSWITC+1
FRMSWT2  DC    X'00'
         ORG   FRMSWT2
FIRST    DS    BL1
@NM00003 EQU   FRMSWT2+0
         ORG   FRMSWT2+1
         DS    CL2
TIMEPARM DS    CL12
         ORG   TIMEPARM
ADCVTTZ  DS    AL4
ADTODCLK DS    AL4
ADTMEBUF DS    AL4
         ORG   TIMEPARM+12
TMEBUF   DS    CL22
         ORG   TMEBUF
YEAR     DS    CL4
DAYYR    DS    CL3
TOD      DS    CL15
         ORG   TMEBUF+22
TIMSAVE  DS    CL9
         ORG   TIMSAVE
DSAV     DS    CL3
TSAV     DS    CL6
         ORG   TIMSAVE+9
OPTSOFF  DC    AL1(29)
         DC    AL1(2)
         DC    AL1(2)
         DC    AL1(1)
         DC    AL1(1)
         DC    AL1(2)
         DC    AL1(1)
         DC    AL1(2)
         DC    AL1(2)
         DC    AL1(2)
         DC    AL1(2)
         DC    AL1(3)
         DC    AL1(2)
         DC    AL1(7)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ECB      EQU   @03
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG12    EQU   @12
REG15    EQU   @15
AEDITCBR EQU   @09
PARMREG  EQU   @01
WREG2    EQU   @02
         ENTRY FRMPTCH
OUTBUF   EQU   1
OPTVAL   EQU   0
AMDPRTAB EQU   0
AFMG     EQU   AMDPRTAB
CURREC   EQU   AMDPRTAB+4
DEBGFLGS EQU   AMDPRTAB+8
PTHFLGS1 EQU   DEBGFLGS
FRM      EQU   PTHFLGS1
PTHFLGS2 EQU   DEBGFLGS+1
INRFCFGS EQU   DEBGFLGS+2
TERM     EQU   INRFCFGS
EXTTRC   EQU   INRFCFGS
EDITSTOP EQU   INRFCFGS
IOFLGS   EQU   DEBGFLGS+3
GETEOF   EQU   IOFLGS
GTFWDPTR EQU   AMDPRTAB+20
DDNAME   EQU   AMDPRTAB+32
STARTIME EQU   AMDPRTAB+40
STOPTIME EQU   AMDPRTAB+52
NAMES    EQU   AMDPRTAB+64
JOBNAMES EQU   NAMES
ADS      EQU   AMDPRTAB+104
AADS     EQU   ADS
SIF      EQU   AMDPRTAB+124
SIOFLGS  EQU   SIF
DVADS1   EQU   AMDPRTAB+128
IO       EQU   AMDPRTAB+228
IOFLGS2  EQU   IO
DVADS2   EQU   AMDPRTAB+232
VCF      EQU   AMDPRTAB+332
SVCFLGS  EQU   VCF
USR      EQU   AMDPRTAB+368
USRFLGS  EQU   USR
USRTAB   EQU   AMDPRTAB+372
PI       EQU   AMDPRTAB+452
PIFLGS   EQU   PI
PGMNGEN  EQU   AMDPRTAB+456
GENFLAGS EQU   PGMNGEN+3
SYS      EQU   GENFLAGS
SYSM     EQU   GENFLAGS
GENFLGS1 EQU   AMDPRTAB+460
TSFOUND  EQU   GENFLGS1
PRFMTADD EQU   AMDPRTAB+480
REENTWKA EQU   AMDPRTAB+484
AFRMAD   EQU   AMDPRTAB+488
ESTARTME EQU   AMDPRTAB+500
ESTOPTME EQU   AMDPRTAB+509
CVTTZONE EQU   AMDPRTAB+518
AMDOPTWD EQU   0
OPTS1    EQU   AMDOPTWD
OPTSYSM  EQU   OPTS1
OPTSYSP  EQU   OPTS1
OPTSYS   EQU   OPTS1
OPTUSR   EQU   OPTS1
OPTTRC   EQU   OPTS1
OPTDSP   EQU   OPTS1
OPTPCI   EQU   OPTS1
OPTS2    EQU   AMDOPTWD+1
OPTSVC   EQU   OPTS2
OPTSVCP  EQU   OPTS2
OPTSIO   EQU   OPTS2
OPTSIOP  EQU   OPTS2
OPTPI    EQU   OPTS2
OPTPIP   EQU   OPTS2
OPTIO    EQU   OPTS2
OPTIOP   EQU   OPTS2
OPTS3    EQU   AMDOPTWD+2
OPTEXT   EQU   OPTS3
OPTRNIO  EQU   OPTS3
OPTSRM   EQU   OPTS3
OPTRR    EQU   OPTS3
OPTIOSIO EQU   OPTS3
OPTS4    EQU   AMDOPTWD+3
OPTTIME  EQU   OPTS4
PRGET    EQU   0
PRCON    EQU   0
PRFLT    EQU   0
RECMAP   EQU   0
RECAID   EQU   RECMAP+4
RECFID   EQU   RECMAP+5
RECTIME  EQU   RECMAP+6
RECVTTZ  EQU   RECTIME
RECTOD   EQU   RECTIME+4
RECGTFOP EQU   RECMAP+18
SVHKREC  EQU   0
SVHKDATA EQU   SVHKREC+6
TODCNVRT EQU   0
AMDPRE02 EQU   12
AMDPRE09 EQU   20
AMDPRE10 EQU   24
AMDPRE14 EQU   28
AMDPRE11 EQU   52
PRAPP    EQU   0
PREXT    EQU   0
PRHEX    EQU   0
PRSPI    EQU   0
PRTME    EQU   0
TIMEBUF  EQU   49
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
SVHKTCB  EQU   SVHKDATA+4
SVHKASID EQU   SVHKDATA+2
SVHKEID  EQU   SVHKDATA
SVHKAFID EQU   SVHKREC+4
@NM00002 EQU   SVHKREC+2
SVHKLEN  EQU   SVHKREC
RECLSTEV EQU   RECGTFOP
RECRES1  EQU   RECMAP+2
RECLL    EQU   RECMAP
OPTRES3  EQU   OPTS4
OPTRES2  EQU   OPTS3
OPTRES1  EQU   OPTS1
RESERVED EQU   AMDPRTAB+522
ESPSEC   EQU   ESTOPTME+7
ESPMIN   EQU   ESTOPTME+5
ESPHR    EQU   ESTOPTME+3
ESPDAY   EQU   ESTOPTME
ESSEC    EQU   ESTARTME+7
ESMIN    EQU   ESTARTME+5
ESHR     EQU   ESTARTME+3
ESDAY    EQU   ESTARTME
ADTSBUF  EQU   AMDPRTAB+496
OFSTDATA EQU   AMDPRTAB+494
OFSTEID  EQU   AMDPRTAB+492
AEIOCT   EQU   AMDPRTAB+476
EXITADDR EQU   AMDPRTAB+472
EXITNM   EQU   AMDPRTAB+464
RECDLL   EQU   AMDPRTAB+461
@NM00001 EQU   GENFLGS1
FIRSTHSW EQU   GENFLGS1
EOFINPRO EQU   GENFLGS1
TS       EQU   GENFLGS1
EOF      EQU   GENFLAGS
RR       EQU   GENFLAGS
SRM      EQU   GENFLAGS
RNIO     EQU   GENFLAGS
DSP      EQU   GENFLAGS
EXT      EQU   GENFLAGS
PICODEA  EQU   PGMNGEN+2
PICODES  EQU   PGMNGEN
Q        EQU   PI+1
P01R     EQU   PIFLGS
SELP     EQU   PIFLGS
ALLP     EQU   PIFLGS
USRNGTAB EQU   USRTAB
O        EQU   USR+1
N01R     EQU   USRFLGS
SELU     EQU   USRFLGS
ALLU     EQU   USRFLGS
SVCNUMS  EQU   AMDPRTAB+336
M        EQU   VCF+1
L        EQU   SVCFLGS
SELV     EQU   SVCFLGS
ALLV     EQU   SVCFLGS
IODVADS  EQU   DVADS2
K01RES   EQU   IO+1
JJ       EQU   IOFLGS2
SELI     EQU   IOFLGS2
ALLI     EQU   IOFLGS2
SIODVADS EQU   DVADS1
II       EQU   SIF+1
H        EQU   SIOFLGS
NOEQU    EQU   SIOFLGS
EQUIV    EQU   SIOFLGS
SELS     EQU   SIOFLGS
ALLS     EQU   SIOFLGS
ASCBADDR EQU   AADS
DAY2     EQU   STOPTIME+10
F        EQU   STOPTIME+8
TIME2    EQU   STOPTIME
DAY      EQU   STARTIME+10
D        EQU   STARTIME+8
TIME     EQU   STARTIME
USEREXIT EQU   AMDPRTAB+24
C        EQU   DEBGFLGS+4
B        EQU   IOFLGS
DMDFMT   EQU   INRFCFGS
RET      EQU   INRFCFGS
FMT      EQU   INRFCFGS
SPIE     EQU   INRFCFGS
FLMODE   EQU   INRFCFGS
REMAIN   EQU   PTHFLGS2
APP      EQU   PTHFLGS2
REXT     EQU   PTHFLGS1
FLT      EQU   PTHFLGS1
HEX      EQU   PTHFLGS1
CON      EQU   PTHFLGS1
GET      EQU   PTHFLGS1
SCN      EQU   PTHFLGS1
ROOT     EQU   PTHFLGS1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00115 EQU   NEXTRTN
@RT00142 EQU   CONOUT
@RF00155 EQU   CONOUT
@RF00162 EQU   NEXTRTN
@RF00169 EQU   NEXTRTN
@RT00177 EQU   NEXTRTN
@RT00191 EQU   STARTEST
@RC00196 EQU   NEXTRTN
@RT00207 EQU   SETEXT
@RT00209 EQU   NEXTRTN
@RT00223 EQU   ASKOP
@RT00238 EQU   EXTOK
@RT00259 EQU   EXTOK
@RF00259 EQU   DUMPEXT
@RF00263 EQU   OPERR
@RT00300 EQU   SELECTVE
@RT00302 EQU   ALL
@RF00302 EQU   NONE
@RT00305 EQU   SELECTVE
@RT00307 EQU   ALL
@RF00307 EQU   NONE
@RT00310 EQU   SELECTVE
@RT00312 EQU   ALL
@RF00312 EQU   NONE
@RT00338 EQU   YES
@RF00338 EQU   NO
@RT00341 EQU   YES
@RF00341 EQU   NO
@RT00344 EQU   YES
@RF00344 EQU   NO
@RT00347 EQU   YES
@RF00347 EQU   NO
@RT00350 EQU   YES
@RF00350 EQU   NO
@RT00353 EQU   YES
@RF00353 EQU   NO
@RT00356 EQU   YES
@RF00356 EQU   NO
@RT00359 EQU   YES
@RF00359 EQU   NO
@ENDDATA EQU   *
         END   AMDPRFRM,(C'PLS2235',0701,76211)

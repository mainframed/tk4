         TITLE 'AMDPRSN2--PART 2 OF EDIT SCAN                          *
                       '
AMDPRSN2 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'AMDPRSN2  73.240'                                 0001
AMDPNAM  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00041-AMDPNAM)
         ENTRY AMDPNAM
AMDVLMG  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00056-AMDVLMG)
         ENTRY AMDVLMG
AMDVLEN  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00112-AMDVLEN)
         ENTRY AMDVLEN
AMDPTAJ  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00123-AMDPTAJ)
         ENTRY AMDPTAJ
AMDELIM  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00203-AMDELIM)
         ENTRY AMDELIM
AMDUMMG  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00213-AMDUMMG)
         ENTRY AMDUMMG
AMDPSIO  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00224-AMDPSIO)
         ENTRY AMDPSIO
AMDPSVC  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00390-AMDPSVC)
         ENTRY AMDPSVC
AMDPPGM  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00425-AMDPPGM)
         ENTRY AMDPPGM
AMDPSYS  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00474-AMDPSYS)
         ENTRY AMDPSYS
AMDPEXT  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00487-AMDPEXT)
         ENTRY AMDPEXT
AMDPDSP  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00490-AMDPDSP)
         ENTRY AMDPDSP
AMDPRNIO DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00493-AMDPRNIO)
         ENTRY AMDPRNIO
AMDPSRM  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00496-AMDPSRM)
         ENTRY AMDPSRM
AMDPRR   DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00499-AMDPRR)
         ENTRY AMDPRR
AMDPEOF  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00502-AMDPEOF)
         ENTRY AMDPEOF
AMDPRCVB DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00505-AMDPRCVB)
         ENTRY AMDPRCVB
AMDPRHX  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00508-AMDPRHX)
         ENTRY AMDPRHX
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @07,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@07                                    0001
         LA    @08,@DATA                                           0001
         USING @DATA,@08                                           0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
*                                                                  0040
         EQUATES                        AMDPRDMP EQU MACRO
         COMMON                         EXPANDS TO AMDPRCOM TABLE
AMDPRSN2 CSECT                          RE-ESTABLISH CSECT
         USING COMMON,COMBASE           SET UP DSECT FOR AMDPRCOM
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE PROCESSES THE EXIT AND DDNAME KEYWORDS.       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0041
*AMDPNAM:                                                          0041
*   ENTRY;                          /* ENTRY POINT                   */
@EP00041 DS    0H                                                  0042
*   IF PAREN='1'B THEN              /* IF PARENS INCLUDED AROUND     */
         TM    PAREN(TTABPTR),B'00010000'                          0042
         BNO   @RF00042                                            0042
*     DO;                           /* VALUE, THEY ARE INVALID       */
*       REG15=12;                   /* SO, ISSUE INV PARENS MSG      */
         LA    REG15,12                                            0044
*       GOTO AMDRTCTL;              /* RETURN TO CALLER              */
         B     AMDRTCTL                                            0045
*     END;                                                         0046
*   IF SCNCHAR=>'A'                 /* Q/IS FIRST CHAR ALPHABETIC    */
*       &SCNCHAR=<'I' THEN                                         0047
@RF00042 L     @14,SCNPTR(,TTABPTR)                                0047
         CLI   SCNCHAR(@14),C'A'                                   0047
         BL    @RF00047                                            0047
         CLI   SCNCHAR(@14),C'I'                                   0047
         BNH   @RT00047                                            0047
*     GOTO AMDPNAM1;                /* YES                           */
*   IF SCNCHAR=>'J'                 /* Q/IS FIRST CHAR ALPHABETIC    */
*       &SCNCHAR=<'R' THEN                                         0049
@RF00047 L     @14,SCNPTR(,TTABPTR)                                0049
         CLI   SCNCHAR(@14),C'J'                                   0049
         BL    @RF00049                                            0049
         CLI   SCNCHAR(@14),C'R'                                   0049
         BNH   @RT00049                                            0049
*     GOTO AMDPNAM1;                /* YES                           */
*   IF SCNCHAR=>'S'                 /* Q/IS FIRST CHAR ALPHABETIC    */
*       &SCNCHAR=<'Z' THEN                                         0051
@RF00049 L     @14,SCNPTR(,TTABPTR)                                0051
         CLI   SCNCHAR(@14),C'S'                                   0051
         BL    @RF00051                                            0051
         CLI   SCNCHAR(@14),C'Z'                                   0051
         BNH   @RT00051                                            0051
*     GOTO AMDPNAM1;                /* YES                           */
*                                                                  0052
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF A NATIONAL CHARACTER                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0053
*   IF SCNCHAR='$'                  /* IF CHAR IS A DOLLAR SIGN      */
*       ×SCNCHAR='#'                /* OR A POUND SIGN               */
*       ×SCNCHAR='@' THEN           /* OR AN AT SIGN, THEN           */
@RF00051 L     @14,SCNPTR(,TTABPTR)                                0053
         CLI   SCNCHAR(@14),C'$'                                   0053
         BE    @RT00053                                            0053
         CLI   SCNCHAR(@14),C'#'                                   0053
         BE    @RT00053                                            0053
         CLI   SCNCHAR(@14),C'@'                                   0053
         BE    @RT00053                                            0053
*     GOTO AMDPNAM1;                /* LEGAL EXIT NM OR DDNAME       */
*   GOTO AMDVMSG;                   /* OUTPUT INV KW DIAGNOSTIC      */
*                                                                  0055
         B     AMDVMSG                                             0055
*/*  THIS SUBROUTINE OUTPUTS THE INVALID KEYWORD VALUE DIAGNOSTIC MSG*/
*                                                                  0056
*AMDVLMG:                                                          0056
*   ENTRY;                          /* ENTRY POINT                   */
@EP00056 DS    0H                                                  0057
*AMDVMSG:                                                          0057
*   SYNMSGA=ADDR(AD3);              /* INSERT ADDRS OF ADDRS OF      */
AMDVMSG  L     @14,@CA00319                                        0057
         LA    @14,AD3-AMDPRS00(,@14)                              0057
         ST    @14,SYNMSGA                                         0057
*                                   /* INV VALUE MSG INTO     SYNMSGA*/
*   IF SVKEY>11 THEN                /* Q/KW IN KWTAB2          Y02014*/
         L     @10,SVKEY(,TTABPTR)                                 0058
         CH    @10,@CH00034                                        0058
         BH    @RT00058                                            0058
*     GOTO AMDVLMG1;                /* YES                           */
*   ERRBUF(45:48)                   /* NO--MOVE IN KEYWORD FROM      */
*       =KWTAB1(SVKEY);             /* KWTAB1                        */
         L     @14,MSGADDR(,@14)                                   0060
         SLA   @10,2                                               0060
         ALR   @10,TTABPTR                                         0060
         MVC   ERRBUF+44(4,@14),KWTAB1-4(@10)                      0060
*   GOTO AMDVLMG2;                                                 0061
         B     AMDVLMG2                                            0061
*AMDVLMG1:                                                         0062
*   ERRBUF(45:52)                   /* MOVE IN KW FROM KWTAB2        */
*       =KWTAB2(SVKEY-11);          /*                         Y02014*/
AMDVLMG1 L     @14,SYNMSGA                                         0062
         L     @14,MSGADDR(,@14)                                   0062
         L     @10,SVKEY(,TTABPTR)                                 0062
         SLA   @10,3                                               0062
         ALR   @10,TTABPTR                                         0062
         MVC   ERRBUF+44(8,@14),KWTAB2-96(@10)                     0062
*AMDVLMG2:                                                         0063
*   GNOSTDMG='1'B;                  /* OMIT USSUANCE OF AMD165I      */
AMDVLMG2 OI    GNOSTDMG,B'00010000'                                0063
*   CALL AMDPRSYN;                  /* HAVE MESSAGE WRITTEN          */
         L     @15,ASYNTAX                                         0064
         BALR  @14,@15                                             0064
*   ERRBUF(45:52)=BLANK1;           /* BLANK FOR SHORTER KW          */
         L     @14,SYNMSGA                                         0065
         L     @14,MSGADDR(,@14)                                   0065
         MVC   ERRBUF+44(8,@14),BLANK1(TTABPTR)                    0065
*   GOTO AMDPCALL;                  /* SET FLUSH MODE BIT            */
         B     AMDPCALL                                            0066
*AMDPNAM1:                                                         0067
*   IF SCNCHAR=' '                  /* IF DELIMITER OF BLANK         */
*       ×SCNCHAR=',' THEN           /* OR COMMA FOUND, THEN          */
AMDPNAM1 L     @14,SCNPTR(,TTABPTR)                                0067
         CLI   SCNCHAR(@14),C' '                                   0067
         BE    @RT00067                                            0067
         CLI   SCNCHAR(@14),C','                                   0067
         BE    @RT00067                                            0067
*     GOTO AMDPNAM2;                /* CALCULATE KW LENGTH           */
*   IF SCNPTR                       /* IF AT LOGICAL END OF STMT,    */
*       =EOCADDR THEN               /* THEN                          */
         C     @14,EOCADDR(,TTABPTR)                               0069
         BE    @RT00069                                            0069
*     GOTO AMDPNAM2;                /* CALCULATE VALUE LENGTH        */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AH    @14,@CH00046                                        0071
         ST    @14,SCNPTR(,TTABPTR)                                0071
*   GOTO AMDPNAM1;                  /* CONTINUE SCAN FOR DELIMITR    */
         B     AMDPNAM1                                            0072
*AMDPNAM2:                                                         0073
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE VALUE LENGTH        */
AMDPNAM2 L     @14,ADDRS3(,TTABPTR)                                0073
         L     @10,SCNPTR(,TTABPTR)                                0073
         SR    @10,@14                                             0073
         ST    @10,LNGTH(,TTABPTR)                                 0073
*   IF LNGTH>8 THEN                 /* IF LONGER THAN EIGHT CHARS    */
         CH    @10,@CH00033                                        0074
         BH    @RT00074                                            0074
*     GOTO AMDVLN1;                 /* OUTPUT ERROR MESSAGE          */
*   IF LNGTH<1 THEN                 /* IF LENGTH<ONE                 */
         LTR   @10,@10                                             0076
         BNP   @RT00076                                            0076
*     GOTO AMDELIM1;                /* THEN OUTPUT BAD DELIM MSG     */
*   COMP8=' ';                      /* BLANK COMPARE AREA            */
         MVI   COMP8+1(TTABPTR),C' '                               0078
         MVC   COMP8+2(6,TTABPTR),COMP8+1(TTABPTR)                 0078
         MVI   COMP8(TTABPTR),C' '                                 0078
*   COMP8=VAL1(1:LNGTH);            /* MOVE IN VALUE                 */
         MVI   COMP8+1(TTABPTR),C' '                               0079
         MVC   COMP8+2(6,TTABPTR),COMP8+1(TTABPTR)                 0079
         BCTR  @10,0                                               0079
         EX    @10,@SM00614                                        0079
*   IF CXIT='1'B THEN               /* IF PROCESSING EXIT, THEN      */
         TM    CXIT(TTABPTR),B'10000000'                           0080
         BO    @RT00080                                            0080
*     GOTO AMDPNAM3;                /* CHECK EXIT SLOTS              */
*   IF DDNAME^=BLANK1 THEN          /* IF DDNAME ALREADY SPEC'D,     */
         CLC   DDNAME(8,AEDITCBR),BLANK1(TTABPTR)                  0082
         BNE   @RT00082                                            0082
*     GOTO AMDPNAM4;                /* CHECK IF SAME                 */
*   IF DDNM^=BLANK1 THEN            /* IF TEMP DDNAME ALREADY        */
         CLC   DDNM(8,TTABPTR),BLANK1(TTABPTR)                     0084
         BNE   @RT00084                                            0084
*     GOTO AMDPNAM5;                /* SPEC'D, CHECK IF SAME         */
*   DDNM(1:LNGTH)=VAL1(1            /* OTHERWISE, MOVE VALUE INTO    */
*       :LNGTH);                    /* DDNAME SLOT IN TEMPTAB        */
         EX    @10,@SM00616                                        0086
*   GOTO AMDPEOCL;                  /* POSITION TO NEXT KW           */
         B     AMDPEOCL                                            0087
*AMDPNAM3:                                                         0088
*   IF USEREXIT^=BLANK1 THEN        /* IF EXIT ALREADY SPECIFIED,    */
AMDPNAM3 CLC   USEREXIT(8,AEDITCBR),BLANK1(TTABPTR)                0088
         BNE   @RT00088                                            0088
*     GOTO AMDPNAM6;                /* CHECK IF SAME                 */
*   IF EXITNAME^=BLANK1 THEN        /* IF TEMP EXIT ALREADY          */
         CLC   EXITNAME(8,TTABPTR),BLANK1(TTABPTR)                 0090
         BNE   @RT00090                                            0090
*     GOTO AMDPNAM7;                /* SPECIFIED, CHECK IF SAME      */
*   EXITNAME(1:LNGTH)=VAL1          /* OTHERWISE, MOVE VALUE INTO    */
*       (1:LNGTH);                  /* EXIT SLOT IN TEMPTAB          */
         L     @14,LNGTH(,TTABPTR)                                 0092
         BCTR  @14,0                                               0092
         L     @10,ADDRS3(,TTABPTR)                                0092
         EX    @14,@SM00618                                        0092
*AMDPEOCL:                                                         0093
*   REG15=4;                        /* POSITION TO NEXT KW           */
AMDPEOCL LA    REG15,4                                             0093
*   GOTO AMDRTCTL;                  /* RETURN TO CALLER              */
         B     AMDRTCTL                                            0094
*AMDPNAM4:                                                         0095
*   IF DDNAME=COMP8 THEN            /* IF DDNAMES SAME, SIMPLY       */
AMDPNAM4 CLC   DDNAME(8,AEDITCBR),COMP8(TTABPTR)                   0095
         BE    @RT00095                                            0095
*     GOTO AMDPEOCL;                /* POSITION TO NEXT KEYWORD      */
*   GOTO AMDKWMG;                   /* IF NOT, DUPLICATE KW'S MSG    */
         B     AMDKWMG                                             0097
*AMDPNAM5:                                                         0098
*   IF DDNM=COMP8 THEN              /* IF MATCH WITH TEMP DDNAME,    */
AMDPNAM5 CLC   DDNM(8,TTABPTR),COMP8(TTABPTR)                      0098
         BE    @RT00098                                            0098
*     GOTO AMDPEOCL;                /* POSITION TO NEXT KEYWORD      */
*   GOTO AMDKWMG;                   /* IF NOT, DUPLICATE KW'S MSG    */
         B     AMDKWMG                                             0100
*AMDPNAM6:                                                         0101
*   IF USEREXIT=COMP8 THEN          /* IF EXIT NAMES SAME, POSITN    */
AMDPNAM6 CLC   USEREXIT(8,AEDITCBR),COMP8(TTABPTR)                 0101
         BE    @RT00101                                            0101
*     GOTO AMDPEOCL;                /* TO NEXT KEYWORD               */
*   GOTO AMDKWMG;                   /* IF NOT, DUPLICATE KW'S MSG    */
         B     AMDKWMG                                             0103
*AMDPNAM7:                                                         0104
*   IF EXITNAME=COMP8 THEN          /* IF MATCH WITH TEMP EXIT       */
AMDPNAM7 CLC   EXITNAME(8,TTABPTR),COMP8(TTABPTR)                  0104
         BE    @RT00104                                            0104
*     GOTO AMDPEOCL;                /* NAME, POSITION TO NEXT KW     */
*AMDKWMG:                                                          0106
*   SYNMSGA=ADDR(AD5);              /* ADDRS OF ADDRS OF MSG         */
AMDKWMG  L     @14,@CA00319                                        0106
         LA    @14,AD5-AMDPRS00(,@14)                              0106
         ST    @14,SYNMSGA                                         0106
*   ERRBUF(34:41)                   /* MOVE IN 'DDNAME' OR 'EXIT'    */
*       =KWTAB2(SVKEY-11);          /*                         Y02014*/
         L     @14,MSGADDR(,@14)                                   0107
         L     @10,SVKEY(,TTABPTR)                                 0107
         SLA   @10,3                                               0107
         ALR   @10,TTABPTR                                         0107
         MVC   ERRBUF+33(8,@14),KWTAB2-96(@10)                     0107
*AMDKWMG1:                                                         0108
*   GNOSTDMG='1'B;                  /* OMIT ISSUANCE OF AMD165I      */
AMDKWMG1 OI    GNOSTDMG,B'00010000'                                0108
*   CALL AMDPRSYN;                  /* HAVE MESSAGE WRITTEN          */
         L     @15,ASYNTAX                                         0109
         BALR  @14,@15                                             0109
*AMDPCALL:                                                         0110
*   REG15=0;                        /* SET FLUSH MODE BIT BEFORE   0110
*                                      CONTINUING                    */
AMDPCALL SR    REG15,REG15                                         0110
*AMDRTCTL:                                                         0111
*   RETURN;                         /* RETURN TO CALLER              */
*                                                                  0111
@EL00001 L     @13,4(,@13)                                         0111
@EF00001 DS    0H                                                  0111
@ER00001 L     @14,12(,@13)                                        0111
         LM    @00,@12,20(@13)                                     0111
         BR    @14                                                 0111
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE OUTPUTS THE INVALID KEYWORD VALUE LENGTH      */
*   /* MESSAGE.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0112
*AMDVLEN:                                                          0112
*   ENTRY;                          /* ENTRY POINT                   */
@EP00112 DS    0H                                                  0113
*AMDVLN1:                                                          0113
*   SYNMSGA=ADDR(AD4);              /* ADDRS OF ADDRS OF MSG         */
AMDVLN1  L     @14,@CA00319                                        0113
         LA    @14,AD4-AMDPRS00(,@14)                              0113
         ST    @14,SYNMSGA                                         0113
*   IF SVKEY>11 THEN                /* Q/KW IN KWTAB2          Y02014*/
         L     @10,SVKEY(,TTABPTR)                                 0114
         CH    @10,@CH00034                                        0114
         BH    @RT00114                                            0114
*     GOTO AMDVLEN1;                /* YES                           */
*   ERRBUF(49:52)                   /* MOVE IN 4-BYTE KEYWORD        */
*       =KWTAB1(SVKEY);                                            0116
         L     @14,MSGADDR(,@14)                                   0116
         SLA   @10,2                                               0116
         ALR   @10,TTABPTR                                         0116
         MVC   ERRBUF+48(4,@14),KWTAB1-4(@10)                      0116
*   GOTO AMDVLEN2;                  /* GO TO HAVE MSG OUTPUTTED      */
         B     AMDVLEN2                                            0117
*AMDVLEN1:                                                         0118
*   ERRBUF(49:56)                   /* MOVE IN 8-BYTE KEYWORD        */
*       =KWTAB2(SVKEY-11);          /*                         Y02014*/
AMDVLEN1 L     @14,SYNMSGA                                         0118
         L     @14,MSGADDR(,@14)                                   0118
         L     @10,SVKEY(,TTABPTR)                                 0118
         SLA   @10,3                                               0118
         ALR   @10,TTABPTR                                         0118
         MVC   ERRBUF+48(8,@14),KWTAB2-96(@10)                     0118
*AMDVLEN2:                                                         0119
*   GNOSTDMG='1'B;                  /* OMIT ISSUANCE OF AMD165I      */
AMDVLEN2 OI    GNOSTDMG,B'00010000'                                0119
*   CALL AMDPRSYN;                  /* HAVE MESSAGE WRITTEN          */
         L     @15,ASYNTAX                                         0120
         BALR  @14,@15                                             0120
*                                   /* OUTPUTTED                     */
*   ERRBUF(49:56)=BLANK1;           /* BLANK MSG AREA FOR FUTURE     */
         L     @14,SYNMSGA                                         0121
         L     @14,MSGADDR(,@14)                                   0121
         MVC   ERRBUF+48(8,@14),BLANK1(TTABPTR)                    0121
*   GOTO AMDPCALL;                  /* SET FLUSH MODE BIT            */
*                                                                  0122
         B     AMDPCALL                                            0122
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE PROCESSES THE JOBNAMES AND ASCB KEYWORDS      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0123
*AMDPTAJ:                                                          0123
*   ENTRY;                          /* ENTRY POINT                   */
@EP00123 DS    0H                                                  0124
*   IF CASCB='1'B THEN              /* IF PROCESSING ASCB      Y02014*/
         TM    CASCB(TTABPTR),B'00000100'                          0124
         BNO   @RF00124                                            0124
*     DO;                           /* DO THE FOLLOWING              */
*       SRTTABPT=ADDR(ADS);         /* INITIALIZE PLACE KEEPER       */
         LA    @14,ADS(,AEDITCBR)                                  0126
         ST    @14,SRTTABPT(,TTABPTR)                              0126
*       INCRT=4;                    /* ASCB ADDRS IS 4 BYTES         */
         MVC   INCRT(4,TTABPTR),@CF00099                           0127
*     END;                          /*                         Y02014*/
*   ELSE                            /* IF PROCESSING JOBNAMES        */
*     DO;                           /* DO THE FOLLOWING              */
         B     @RC00124                                            0129
@RF00124 DS    0H                                                  0130
*       SRTTABPT=ADDR(NAMES);       /* INITIALIZE PLACE KEEPER       */
         LA    @14,NAMES(,AEDITCBR)                                0130
         ST    @14,SRTTABPT(,TTABPTR)                              0130
*       INCRT=8;                    /* JOBNAME IS 8 BYTES LONG       */
         MVC   INCRT(4,TTABPTR),@CF00033                           0131
*     END;                                                         0132
*   LASTPTR=SRTTABPT+(5             /* CALCULATE END OF TABLE @      */
*       *INCRT);                                                   0133
@RC00124 L     @14,INCRT(,TTABPTR)                                 0133
         MH    @14,@CH00086                                        0133
         A     @14,SRTTABPT(,TTABPTR)                              0133
         ST    @14,LASTPTR                                         0133
*AMDPTAJX:                                                         0134
*   IF SCNCHAR=','                  /* IF DELIMITER OF COMMA,        */
*       ×SCNCHAR=')'                /* RIGHT PARENTHESIS,            */
*       ×SCNCHAR=' ' THEN           /* OR BLANK IS FOUND, THEN       */
AMDPTAJX L     @14,SCNPTR(,TTABPTR)                                0134
         CLI   SCNCHAR(@14),C','                                   0134
         BE    @RT00134                                            0134
         CLI   SCNCHAR(@14),C')'                                   0134
         BE    @RT00134                                            0134
         CLI   SCNCHAR(@14),C' '                                   0134
         BE    @RT00134                                            0134
*     GOTO AMDPTAJ1;                /* CALCULATE VALUE LENGTH        */
*   IF SCNPTR=EOCADDR               /* IF AT LOGICAL END OF STMT,    */
*     THEN                          /* THEN                          */
         C     @14,EOCADDR(,TTABPTR)                               0136
         BE    @RT00136                                            0136
*     GOTO AMDPTAJ1;                /* CALCULATE VALUE LENGTH        */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AH    @14,@CH00046                                        0138
         ST    @14,SCNPTR(,TTABPTR)                                0138
*   GOTO AMDPTAJX;                  /* CONTINUE DELIMITER SCAN       */
         B     AMDPTAJX                                            0139
*AMDPTAJ1:                                                         0140
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE VALUE LENGTH        */
AMDPTAJ1 L     @14,ADDRS3(,TTABPTR)                                0140
         L     @10,SCNPTR(,TTABPTR)                                0140
         SR    @10,@14                                             0140
         ST    @10,LNGTH(,TTABPTR)                                 0140
*   COMP8=' ';                      /* BLANK OUT COMPARE AREA        */
         MVI   COMP8+1(TTABPTR),C' '                               0141
         MVC   COMP8+2(6,TTABPTR),COMP8+1(TTABPTR)                 0141
         MVI   COMP8(TTABPTR),C' '                                 0141
*   IF CASCB='1'B THEN              /* IF KEYWORD IS ASCB      Y02014*/
         TM    CASCB(TTABPTR),B'00000100'                          0142
         BO    @RT00142                                            0142
*     GOTO AMDPTAJ3;                /* HANDLE THAT KEYWORD           */
*   IF LNGTH>8 THEN                 /* IF VALUE LENGTH GREATER       */
         CH    @10,@CH00033                                        0144
         BH    @RT00144                                            0144
*     GOTO AMDVLN1;                 /* THAN 8, OUTPUT ERROR MSG      */
*   IF LNGTH<1 THEN                 /* IF ZERO LENGTH, HAVE DELIM    */
         LTR   @10,@10                                             0146
         BNP   @RT00146                                            0146
*     GOTO AMDELIM1;                /* WHERE ONE DOESN'T BELONG      */
*   IF VAL1(1)=>'A'                 /* Q/IS FIRST CHAR ALPHABETIC    */
*       &VAL1(1)=<'I' THEN                                         0148
         CLI   VAL1(@14),C'A'                                      0148
         BL    @RF00148                                            0148
         CLI   VAL1(@14),C'I'                                      0148
         BNH   @RT00148                                            0148
*     GOTO AMDPTAJ2;                /* YES                           */
*   IF VAL1(1)=>'J'                 /* Q/IS FIRST CHAR ALPHABETIC    */
*       &VAL1(1)=<'R' THEN                                         0150
@RF00148 L     @14,ADDRS3(,TTABPTR)                                0150
         CLI   VAL1(@14),C'J'                                      0150
         BL    @RF00150                                            0150
         CLI   VAL1(@14),C'R'                                      0150
         BNH   @RT00150                                            0150
*     GOTO AMDPTAJ2;                /* YES                           */
*   IF VAL1(1)=>'S'                 /* Q/IS FIRST CHAR ALPHABETIC    */
*       &VAL1(1)=<'Z' THEN                                         0152
@RF00150 L     @14,ADDRS3(,TTABPTR)                                0152
         CLI   VAL1(@14),C'S'                                      0152
         BL    @RF00152                                            0152
         CLI   VAL1(@14),C'Z'                                      0152
         BNH   @RT00152                                            0152
*     GOTO AMDPTAJ2;                /* YES                           */
*                                                                  0153
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF A NATIONAL CHARACTER                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0154
*   IF VAL1(1)='$'                  /* IF CHAR IS A DOLLAR SIGN      */
*       ×VAL1(1)='#'                /* OR A POUND SIGN               */
*       ×VAL1(1)='@' THEN           /* OR AN AT SIGN, THEN           */
@RF00152 L     @14,ADDRS3(,TTABPTR)                                0154
         CLI   VAL1(@14),C'$'                                      0154
         BE    @RT00154                                            0154
         CLI   VAL1(@14),C'#'                                      0154
         BE    @RT00154                                            0154
         CLI   VAL1(@14),C'@'                                      0154
         BE    @RT00154                                            0154
*     GOTO AMDPTAJ2;                /* LEGAL JOBNAME                 */
*   GOTO AMDVMSG;                   /* IF NOT, INVALID VALUE         */
         B     AMDVMSG                                             0156
*AMDPTAJ2:                                                         0157
*   COMP8=VAL1(1:LNGTH);            /* MOVE IN DELIMITED VALUE       */
AMDPTAJ2 MVI   COMP8+1(TTABPTR),C' '                               0157
         MVC   COMP8+2(6,TTABPTR),COMP8+1(TTABPTR)                 0157
         L     @14,LNGTH(,TTABPTR)                                 0157
         BCTR  @14,0                                               0157
         L     @10,ADDRS3(,TTABPTR)                                0157
         EX    @14,@SM00620                                        0157
*   SORTPTR=JOBCRPTR;               /* CURRENT JOBNAME POINTER       */
         MVC   SORTPTR(4,TTABPTR),JOBCRPTR(TTABPTR)                0158
*AMDPTAJ4:                                                         0159
*   IF SRTTABPT=LASTPTR THEN        /* IF AT END OF TABLE            */
AMDPTAJ4 L     @14,SRTTABPT(,TTABPTR)                              0159
         C     @14,LASTPTR                                         0159
         BE    @RT00159                                            0159
*     GOTO AMDUMSG;                 /* HAVE TOO MANY VALUES          */
*   IF SRTTABPT=SORTPTR THEN        /* Q/AT CURRENT SLOT             */
         C     @14,SORTPTR(,TTABPTR)                               0161
         BNE   @RF00161                                            0161
*     DO;                           /* IF SO, DO THE FOLLOWING       */
*       DEV(1:INCRT)=COMP8;         /* YES--INSERT VALUE             */
         L     @10,INCRT(,TTABPTR)                                 0163
         LR    @06,@10                                             0163
         BCTR  @06,0                                               0163
         EX    @06,@SM00622                                        0163
*       IF CASCB='1'B THEN          /* IF ASCB                 Y02014*/
         TM    CASCB(TTABPTR),B'00000100'                          0164
         BNO   @RF00164                                            0164
*         DO;                       /* DO THE FOLLOWING              */
*           ASCBCPTR=ASCBCPTR       /* UPDTE ASCB POINTER      Y02014*/
*               +INCRT;                                            0166
         A     @10,ASCBCPTR(,TTABPTR)                              0166
         ST    @10,ASCBCPTR(,TTABPTR)                              0166
*           GOTO AMDPARN;           /* CHECK FOR ADD'AL VALUES       */
         B     AMDPARN                                             0167
*         END;                      /* INSERTED VAL & UPDATD PTRS    */
*       JOBCRPTR=JOBCRPTR+INCRT;    /* UPDATE JOBNAME POINTER        */
*                                                                  0169
@RF00164 L     @14,JOBCRPTR(,TTABPTR)                              0169
         A     @14,INCRT(,TTABPTR)                                 0169
         ST    @14,JOBCRPTR(,TTABPTR)                              0169
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SUBROUTINE POSTIONS THE SCANNER DEPENDING UPON       */
*       /* WHETHER PARENTHESES ARE NOW MATCHED, ARE YET TO BE        */
*       /* MATCHED, OR DO NOT EXIST IN THIS KEYWORD VALUE.           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0170
*AMDPARN:                                                          0170
*       IF PAREN='0'B THEN          /* IF ONLY ONE VALUE TO PROC,    */
AMDPARN  TM    PAREN(TTABPTR),B'00010000'                          0170
         BZ    @RT00170                                            0170
*         GOTO AMDPEOCL;            /* CHECK FOR NEXT KEYWORD        */
*       IF SCNCHAR=')' THEN         /* IF SCANNED ALL VALUES THEN    */
         L     @14,SCNPTR(,TTABPTR)                                0172
         CLI   SCNCHAR(@14),C')'                                   0172
         BE    @RT00172                                            0172
*         GOTO AMDPEOCL;            /* CHECK FOR NEXT KEYWORD        */
*       SCNPTR=SCNPTR+1;            /* POSITION BUFFER POINTER       */
         AH    @14,@CH00046                                        0174
         ST    @14,SCNPTR(,TTABPTR)                                0174
*       ADDRS3=SCNPTR;              /* ADDRS OF NEXT VALUE           */
         ST    @14,ADDRS3(,TTABPTR)                                0175
*       IF CJOBN='1'B               /* IF PROCESSING JOBNAMES        */
*           ×CASCB='1'B THEN        /* OR ASCB, THEN           Y02014*/
         TM    CJOBN(TTABPTR),B'00001100'                          0176
         BNZ   @RT00176                                            0176
*         GOTO AMDPTAJX;            /* RESUME SCAN AT THAT RTN       */
*       IF CSVC='1'B THEN           /* IF PROCESSING SVC, THEN       */
         TM    CSVC(TTABPTR),B'01000000'                           0178
         BO    @RT00178                                            0178
*         GOTO AMDPSVC2;            /* RESUME SCAN AT THAT RTN       */
*       IF CPI='1'B THEN            /* IF PROCESSING PI, THEN        */
         TM    CPI(TTABPTR),B'00100000'                            0180
         BO    @RT00180                                            0180
*         GOTO AMDPPGM2;            /* RESUME SCAN AT THAT RTN       */
*       GOTO AMDPIORS;              /* RESUME SCAN AT IO/SIO RTN     */
         B     AMDPIORS                                            0182
*     END;                          /* HAVE INSERTED VALUE           */
*   IF DEV(1:INCRT)^=COMP8          /* Q/DOES VALUE EQUAL VALUE      */
*     THEN                          /* ALREADY IN TABLE              */
@RF00161 L     @14,SRTTABPT(,TTABPTR)                              0184
         L     @10,INCRT(,TTABPTR)                                 0184
         LR    @06,@10                                             0184
         BCTR  @06,0                                               0184
         EX    @06,@SC00624                                        0184
         BE    @RF00184                                            0184
*     DO;                           /* IF NOT, DO THE FOLLOWING      */
*       SRTTABPT=SRTTABPT           /* LOOK AT NXT TABL VALUE        */
*           +INCRT;                                                0186
         AR    @14,@10                                             0186
         ST    @14,SRTTABPT(,TTABPTR)                              0186
*       GOTO AMDPTAJ4;              /* CONTINUE SEARCH               */
         B     AMDPTAJ4                                            0187
*     END;                          /* UNEQUAL COMPARE               */
*   GOTO AMDPARN;                   /* EQUAL COMPARE--SCAN FOR       */
         B     AMDPARN                                             0189
*AMDPTAJ3:                                                         0190
*   IF LNGTH>8 THEN                 /* ASCB ADDR MAX OF 8      Y02014*/
AMDPTAJ3 L     @14,LNGTH(,TTABPTR)                                 0190
         CH    @14,@CH00033                                        0190
         BH    @RT00190                                            0190
*     GOTO AMDVLN1;                 /* CHARS--IF LRGER, ERROR MSG    */
*   IF LNGTH<1 THEN                 /* IF ZERO LENGTH, HAVE          */
         LTR   @14,@14                                             0192
         BNP   @RT00192                                            0192
*     GOTO AMDELIM1;                /* INVALID DELIMITER             */
*                                                                  0193
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF ALL DIGITS ARE VALID HEX DIGITS--BETWEEN         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0194
*   DO I=LNGTH TO 1 BY-1;           /* CHECK TO DETERMINE THAT       */
         ST    @14,I(,TTABPTR)                                     0194
         B     @DE00194                                            0194
@DL00194 DS    0H                                                  0195
*     IF VAL1(I)=>'A'               /* ALL DIGITS ARE BETWEEN 'A'    */
*         &VAL1(I)=<'F' THEN        /* AND 'F'                       */
         L     @14,I(,TTABPTR)                                     0195
         L     @10,ADDRS3(,TTABPTR)                                0195
         ALR   @14,@10                                             0195
         AL    @14,@CF00473                                        0195
         CLI   VAL1(@14),C'A'                                      0195
         BL    @RF00195                                            0195
         L     @14,I(,TTABPTR)                                     0195
         ALR   @10,@14                                             0195
         AL    @10,@CF00473                                        0195
         CLI   VAL1(@10),C'F'                                      0195
         BNH   @RT00195                                            0195
*       GOTO AMDPOK1;               /* OR                            */
*     IF VAL1(I)<'0'                /* 0                             */
*         ×VAL1(I)>'9' THEN         /* AND 9                         */
@RF00195 L     @14,I(,TTABPTR)                                     0197
         L     @10,ADDRS3(,TTABPTR)                                0197
         ALR   @14,@10                                             0197
         AL    @14,@CF00473                                        0197
         CLI   VAL1(@14),C'0'                                      0197
         BL    @RT00197                                            0197
         L     @14,I(,TTABPTR)                                     0197
         ALR   @10,@14                                             0197
         AL    @10,@CF00473                                        0197
         CLI   VAL1(@10),C'9'                                      0197
         BH    @RT00197                                            0197
*       GOTO AMDVMSG;               /* OTHERWISE, INVALID VALUE      */
*AMDPOK1:                                                          0199
*   END;                            /* DIGIT VALIDITY CHECK          */
AMDPOK1  SR    @14,@14                                             0199
         BCTR  @14,0                                               0199
         A     @14,I(,TTABPTR)                                     0199
         ST    @14,I(,TTABPTR)                                     0199
@DE00194 LTR   @14,@14                                             0199
         BP    @DL00194                                            0199
*   CALL AMDHEX;                    /* CNVT TCB ADDRS TO BINARY      */
         BAL   @14,AMDHEX                                          0200
*   SORTPTR=ASCBCPTR;               /* CURR ASCB ADDR PTR      Y02014*/
         MVC   SORTPTR(4,TTABPTR),ASCBCPTR(TTABPTR)                0201
*   GOTO AMDPTAJ4;                  /* BEGIN SEARCH                  */
*                                                                  0202
         B     AMDPTAJ4                                            0202
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE OUTPUTS THE INVALID DELIMITER DIAGNOSTIC      */
*   /* MESSAGE.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0203
*AMDELIM:                                                          0203
*   ENTRY;                          /* ENTRY POINT                   */
@EP00203 DS    0H                                                  0204
*AMDELIM1:                                                         0204
*   SYNMSGA=ADDR(AD7);              /* ADDRS OF ADDRS OF MESSAGE     */
AMDELIM1 L     @14,@CA00319                                        0204
         LA    @14,AD7-AMDPRS00(,@14)                              0204
         ST    @14,SYNMSGA                                         0204
*   GNOSTDMG='1'B;                  /* OMIT ISSUANCE OF AMD165I      */
         OI    GNOSTDMG,B'00010000'                                0205
*   IF SVKEY>11 THEN                /* Q/KW IN KWTAB2          Y02014*/
         L     @10,SVKEY(,TTABPTR)                                 0206
         CH    @10,@CH00034                                        0206
         BH    @RT00206                                            0206
*     GOTO AMDELIM2;                /* YES                           */
*   ERRBUF(44:47)                   /* MOVE IN 4-BYTE KEYWORD        */
*       =KWTAB1(SVKEY);                                            0208
         L     @14,MSGADDR(,@14)                                   0208
         SLA   @10,2                                               0208
         ALR   @10,TTABPTR                                         0208
         MVC   ERRBUF+43(4,@14),KWTAB1-4(@10)                      0208
*   GOTO AMDELIM3;                  /* GO TO HAVE MSG OUTPUTTED      */
         B     AMDELIM3                                            0209
*AMDELIM2:                                                         0210
*   ERRBUF(44:51)                   /* MOVE IN 8-BYTE KEYWORD        */
*       =KWTAB2(SVKEY-11);          /*                         Y02014*/
AMDELIM2 L     @14,SYNMSGA                                         0210
         L     @14,MSGADDR(,@14)                                   0210
         L     @10,SVKEY(,TTABPTR)                                 0210
         SLA   @10,3                                               0210
         ALR   @10,TTABPTR                                         0210
         MVC   ERRBUF+43(8,@14),KWTAB2-96(@10)                     0210
*AMDELIM3:                                                         0211
*   CALL AMDPRSYN;                  /* OUTPUT INVALID DELIM MSG      */
AMDELIM3 L     @15,ASYNTAX                                         0211
         BALR  @14,@15                                             0211
*   GOTO AMDPCALL;                  /* SET FLUSH MODE BIT            */
*                                                                  0212
         B     AMDPCALL                                            0212
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE OUTPUTS THE EXCESSIVE NUMBER OF VALUES        */
*   /* DIAGNOSTIC MESSAGE.                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*AMDUMMG:                                                          0213
*   ENTRY;                          /* ENTRY POINT                   */
@EP00213 DS    0H                                                  0214
*AMDUMSG:                                                          0214
*   SYNMSGA=ADDR(AD6);              /* ADDRS OF ADDRS OF MESSAGE     */
AMDUMSG  L     @14,@CA00319                                        0214
         LA    @14,AD6-AMDPRS00(,@14)                              0214
         ST    @14,SYNMSGA                                         0214
*   IF SVKEY>11 THEN                /* Q/KW IN KWTAB2          Y02014*/
         L     @10,SVKEY(,TTABPTR)                                 0215
         CH    @10,@CH00034                                        0215
         BH    @RT00215                                            0215
*     GOTO AMDUMMG1;                /* YES                           */
*   ERRBUF(52:55)                   /* MOVE IN 4-BYTE KEYWORD        */
*       =KWTAB1(SVKEY);                                            0217
         L     @14,MSGADDR(,@14)                                   0217
         SLA   @10,2                                               0217
         ALR   @10,TTABPTR                                         0217
         MVC   ERRBUF+51(4,@14),KWTAB1-4(@10)                      0217
*   GOTO AMDUMMG2;                  /* GO TO HAVE MSG OUTPUTTED      */
         B     AMDUMMG2                                            0218
*AMDUMMG1:                                                         0219
*   ERRBUF(52:59)                   /* MOVE IN 8-BYTE KEYWORD        */
*       =KWTAB2(SVKEY-11);          /*                         Y02014*/
AMDUMMG1 L     @14,SYNMSGA                                         0219
         L     @14,MSGADDR(,@14)                                   0219
         L     @10,SVKEY(,TTABPTR)                                 0219
         SLA   @10,3                                               0219
         ALR   @10,TTABPTR                                         0219
         MVC   ERRBUF+51(8,@14),KWTAB2-96(@10)                     0219
*AMDUMMG2:                                                         0220
*   GNOSTDMG='1'B;                  /* OMIT ISSUANCE OF AMD165I      */
AMDUMMG2 OI    GNOSTDMG,B'00010000'                                0220
*   CALL AMDPRSYN;                  /* HAVE MESSAGE WRITTEN          */
         L     @15,ASYNTAX                                         0221
         BALR  @14,@15                                             0221
*   ERRBUF(52:59)=BLANK1;           /* BLANK MSG AREA TOR FUTURE   0222
*                                      SHORTER KEYWORDS              */
         L     @14,SYNMSGA                                         0222
         L     @14,MSGADDR(,@14)                                   0222
         MVC   ERRBUF+51(8,@14),BLANK1(TTABPTR)                    0222
*   GOTO AMDPCALL;                  /* SET FLUSH MODE BIT            */
*                                                                  0223
         B     AMDPCALL                                            0223
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE PROCESSES THE SIO AND IO KEYWORDS, AS WELL AS */
*   /* IO=SIO AND SIO AND IO.                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0224
*AMDPSIO:                                                          0224
*   ENTRY;                          /* ENTRY POINT                   */
@EP00224 DS    0H                                                  0225
*   IF IORTNSW='1'B THEN            /* Q/BACK FROM PAREN CK RTN      */
         TM    IORTNSW(TTABPTR),B'10000000'                        0225
         BNO   @RF00225                                            0225
*     DO;                           /* IF SO, DO THE FOLLOWING       */
*       IORTNSW='0'B;               /* TURN OFF IO RTN SWITCH        */
         NI    IORTNSW(TTABPTR),B'01111111'                        0227
*       GOTO AMDPSIOA;              /* CONTINUE PROCESSING           */
         B     AMDPSIOA                                            0228
*     END;                                                         0229
*   IF SYS='1'B THEN                /* Q/SYS ALREADY SPECIFIED       */
@RF00225 TM    SYS(AEDITCBR),B'00100000'                           0230
         BO    @RT00230                                            0230
*     GOTO AMDPEOCL;                /* YES                           */
*   IF SYST='1'B THEN               /* Q/SYS SPECIFIED IN TEMPTAB    */
         TM    SYST(TTABPTR),B'00100000'                           0232
         BO    @RT00232                                            0232
*     GOTO AMDPEOCL;                /* YES                           */
*   IF NOVAL='1'B THEN              /* IF IO=ALL OR SIO=ALL          */
         TM    NOVAL(TTABPTR),B'00100000'                          0234
         BO    @RT00234                                            0234
*     GOTO AMDPSIO1;                /* SPECIFIED, SET BITS           */
*   ALLCT=0;                        /* INITIALIZE SIO/IO TRACKERS    */
         SR    @14,@14                                             0236
         ST    @14,ALLCT(,TTABPTR)                                 0236
*   IF CSIO='1'B THEN               /* IF KEYWORD IS SIO, PROCESS    */
         TM    CSIO(TTABPTR),B'00000001'                           0237
         BO    @RT00237                                            0237
*     GOTO AMDPSIO2;                /* THAT KEYWORD                  */
*   SVTABY=ADDR(DVADS2);            /* BEG ADDRS OF IO TABLE         */
         LA    @14,DVADS2(,AEDITCBR)                               0239
         ST    @14,SVTABY                                          0239
*   SRTBPTY=ADDR(DVADS2);           /* INITIALIZE PLACE KEEPER       */
         ST    @14,SRTBPTY                                         0240
*   LSTPTRY=SRTBPTY+(50             /* ADDRS OF END OF IO TABLE      */
*       *2);                                                       0241
         LA    @10,100                                             0241
         AR    @14,@10                                             0241
         ST    @14,LSTPTRY                                         0241
*   IF VAL1(1:3)=KWTAB1             /* IF SIO FOLLOWS IO=            */
*       (1,1:3)THEN                 /*                               */
         L     @14,ADDRS3(,TTABPTR)                                0242
         CLC   VAL1(3,@14),KWTAB1(TTABPTR)                         0242
         BNE   @RF00242                                            0242
*     DO;                           /* DO THE FOLLOWING              */
*       CSIO='1'B;                  /* SET ON SIO BIT                */
         OI    CSIO(TTABPTR),B'00000001'                           0244
*       SCNPTR=SCNPTR               /* POSITION CORRECTLY            */
*           +2;                                                    0245
         LA    @14,2                                               0245
         A     @14,SCNPTR(,TTABPTR)                                0245
         ST    @14,SCNPTR(,TTABPTR)                                0245
*       SVTABX=ADDR                 /* BEG OF SIO TABLE              */
*           (DVADS1);                                              0246
         LA    @14,DVADS1(,AEDITCBR)                               0246
         ST    @14,SVTABX                                          0246
*       SRTBPTX=ADDR                /* SIO PLACE KEEPER              */
*           (DVADS1);                                              0247
         ST    @14,SRTBPTX                                         0247
*       LSTPTRX=SRTBPTX             /* ADDRS OF END OF SIO TABLE     */
*           +(50*2);                                               0248
         AR    @14,@10                                             0248
         ST    @14,LSTPTRX                                         0248
*       GOTO AMDPSIO3;              /* CONTINUE PROCESSING           */
         B     AMDPSIO3                                            0249
*     END;                          /* IO=SIO=                       */
*   IF ALLI='1'B THEN               /* IF IO=ALL ALREADY SPEC'D,     */
@RF00242 TM    ALLI(AEDITCBR),B'10000000'                          0251
         BO    @RT00251                                            0251
*     GOTO AMDPEOCL;                /* SEARCH FOR NEXT KEYWORD       */
*   IF ALLIT='1'B THEN              /* IF IO=ALL IN TEMPTAB, THEN    */
         TM    ALLIT(TTABPTR),B'10000000'                          0253
         BO    @RT00253                                            0253
*     GOTO AMDPEOCL;                /* SEARCH FOR NEXT KEYWORD       */
*   GOTO AMDPSIO4;                  /* CONTINUE SELECTIVE PROC'G     */
         B     AMDPSIO4                                            0255
*AMDPSIO1:                                                         0256
*   IF CSIO^='1'B THEN              /* IF NOT PROCESSING SIO,        */
AMDPSIO1 TM    CSIO(TTABPTR),B'00000001'                           0256
         BO    @RF00256                                            0256
*     DO;                           /* DO THE FOLLOWING              */
*       ALLIT='1'B;                 /* IO=ALL                        */
         OI    ALLIT(TTABPTR),B'10000000'                          0258
*       GOTO AMDPNOEQ;              /* NO IO=SIO FROM NOW ON         */
         B     AMDPNOEQ                                            0259
*     END;                                                         0260
*   ALLST='1'B;                     /* PROCESSING SIO, SO SIO=ALL    */
@RF00256 OI    ALLST(TTABPTR),B'10000000'                          0261
*AMDPNOEQ:                                                         0262
*   NOEQUT='1'B;                    /* SET ON SIO/IO EQUIV NOT     0262
*                                      PERMITTED FLAG                */
AMDPNOEQ OI    NOEQUT(TTABPTR),B'00010000'                         0262
*AMDPCLCL:                                                         0263
*   REG15=16;                       /* SEARCH FOR NEXT KW            */
AMDPCLCL LA    REG15,16                                            0263
*   GOTO AMDRTCTL;                  /* RETURN TO CALLER              */
         B     AMDRTCTL                                            0264
*AMDPSIO2:                                                         0265
*   SVTABX=ADDR(DVADS1);            /* BEG ADDRS OF SIO TABLE        */
AMDPSIO2 LA    @14,DVADS1(,AEDITCBR)                               0265
         ST    @14,SVTABX                                          0265
*   SRTBPTX=ADDR(DVADS1);           /* INITIALIZE SIO PLC KEEPER     */
         ST    @14,SRTBPTX                                         0266
*   LSTPTRX=SRTBPTX+(50             /* ADDRS OF END OF SIO TABLE     */
*       *2);                                                       0267
         LA    @10,100                                             0267
         AR    @14,@10                                             0267
         ST    @14,LSTPTRX                                         0267
*   IF VAL1(1:2)=KWTAB1             /* IF IO FOLLOWS SIO=            */
*       (2,1:2)THEN                 /* THEN                          */
         L     @14,ADDRS3(,TTABPTR)                                0268
         CLC   VAL1(2,@14),KWTAB1+4(TTABPTR)                       0268
         BNE   @RF00268                                            0268
*     DO;                           /* DO THE FOLLOWING              */
*       CIO='1'B;                   /* SET ON IO BIT                 */
         OI    CIO(TTABPTR),B'10000000'                            0270
*       SCNPTR=SCNPTR+1;            /* POSITION TO O OF IO           */
         LA    @14,1                                               0271
         A     @14,SCNPTR(,TTABPTR)                                0271
         ST    @14,SCNPTR(,TTABPTR)                                0271
*       SVTABY=ADDR(DVADS2);        /* BEG ADDRS OF IO TABLE         */
         LA    @14,DVADS2(,AEDITCBR)                               0272
         ST    @14,SVTABY                                          0272
*       SRTBPTY=ADDR(DVADS2);       /* INITIALIZE IO PLACE KEEPER    */
         ST    @14,SRTBPTY                                         0273
*       LSTPTRY=SRTBPTY+(50         /* ADDRS OF END OF IO TABLE      */
*           *2);                                                   0274
         AR    @14,@10                                             0274
         ST    @14,LSTPTRY                                         0274
*       GOTO AMDPSIO3;              /* CONTINUE PROCESSING           */
         B     AMDPSIO3                                            0275
*     END;                          /* SIO=IO=                       */
*   IF ALLS='1'B THEN               /* IF SIO=ALL ALREADY     SPEC'D,*/
@RF00268 TM    ALLS(AEDITCBR),B'10000000'                          0277
         BO    @RT00277                                            0277
*     GOTO AMDPEOCL;                /* SEARCH FOR NEXT KEYWORD       */
*   IF ALLST='1'B THEN              /* IF SIO=ALL IN TEMPTAB,        */
         TM    ALLST(TTABPTR),B'10000000'                          0279
         BO    @RT00279                                            0279
*     GOTO AMDPEOCL;                /* SEARCH FOR NEXT KEYWORD       */
*AMDPSIO4:                                                         0281
*   NOEQUT='1'B;                    /* SIO OR IO INDIVIDUALLY        */
AMDPSIO4 OI    NOEQUT(TTABPTR),B'00010000'                         0281
*                                   /* SPEC'D, SO SIO/IO EQUIV       */
*                                   /* NOT PERMITTED                 */
*   IF PAREN='1'B THEN              /* IF MORE THAN ONE VALUE        */
         TM    PAREN(TTABPTR),B'00010000'                          0282
         BNO   @RF00282                                            0282
*     SCNPTR=SCNPTR-3;              /* ALLOW FOR LEFT PAREN          */
         L     @14,SCNPTR(,TTABPTR)                                0283
         SH    @14,@CH00169                                        0283
         ST    @14,SCNPTR(,TTABPTR)                                0283
*   ELSE                            /* IF ONLY ONE VALUE             */
*     SCNPTR=SCNPTR-2;              /* NEED BACKSPACE ONLY TWO       */
         B     @RC00282                                            0284
@RF00282 L     @14,SCNPTR(,TTABPTR)                                0284
         BCTR  @14,0                                               0284
         BCTR  @14,0                                               0284
         ST    @14,SCNPTR(,TTABPTR)                                0284
*   GOTO AMDPSIO6;                  /* BEGIN VALUE SCAN              */
         B     AMDPSIO6                                            0285
*AMDPSIO3:                                                         0286
*   IF NOEQU='1'B                   /* IF SIO/IO EQUIV NOT           */
*       ×NOEQUT='1'B THEN           /* PERMITTED, THEN EXAMINE       */
AMDPSIO3 TM    NOEQU(AEDITCBR),B'00010000'                         0286
         BO    @RT00286                                            0286
         TM    NOEQUT(TTABPTR),B'00010000'                         0286
         BO    @RT00286                                            0286
*     GOTO AMDPSIO5;                /* INDIVIDUAL BITS               */
*   EQUIVT='1'B;                    /* SIO AND IO NOW EQUIVALENT     */
         OI    EQUIVT(TTABPTR),B'00100000'                         0288
*AMDPSI31:                                                         0289
*   EQUIND='1'B;                    /* PROCESS SIO AND IO TABLE      */
AMDPSI31 OI    EQUIND(TTABPTR),B'00010000'                         0289
*   GOTO AMDPSIO6;                  /* BEGIN VALUE SEARCH            */
         B     AMDPSIO6                                            0290
*AMDPSIO5:                                                         0291
*   IF ALLS='0'B                    /* IF SIO AND IO 'ALL'           */
*       &ALLST='0'B                 /* INDICATORS ARE ALL OFF IN     */
*       &ALLI='0'B                  /* BOTH TABLES                   */
*       &ALLIT='0'B THEN            /* THEN IO AND SIO TABLES        */
AMDPSIO5 TM    ALLS(AEDITCBR),B'10000000'                          0291
         BNZ   @RF00291                                            0291
         TM    ALLST(TTABPTR),B'10000000'                          0291
         BNZ   @RF00291                                            0291
         TM    ALLI(AEDITCBR),B'10000000'                          0291
         BNZ   @RF00291                                            0291
         TM    ALLIT(TTABPTR),B'10000000'                          0291
         BZ    @RT00291                                            0291
*     GOTO AMDPSI31;                /* CAN BE PROCESSED TOGETHER     */
*   IF ALLS='1'B                    /* IF SIO=ALL IN AMDPRTAB        */
*       ×ALLST='1'B THEN            /* TEMPTAB, THEN                 */
@RF00291 TM    ALLS(AEDITCBR),B'10000000'                          0293
         BO    @RT00293                                            0293
         TM    ALLST(TTABPTR),B'10000000'                          0293
         BNO   @RF00293                                            0293
@RT00293 DS    0H                                                  0294
*     DO;                           /* DO THE FOLLOWING              */
*       CSIO='0'B;                  /* SET OFF SIO PROCESSING BIT    */
         NI    CSIO(TTABPTR),B'11111110'                           0295
*       ALLCT=1;                    /* ONE OF TWO KWS NULLIFIED      */
         MVC   ALLCT(4,TTABPTR),@CF00046                           0296
*     END;                          /* SIO=ALL                       */
*AMDPSI51:                                                         0298
*   IF ALLI='1'B                    /* IF IO=ALL IN AMDPRTAB OR      */
*       ×ALLIT='1'B THEN            /* TEMPTAB, THEN                 */
@RF00293 DS    0H                                                  0298
AMDPSI51 TM    ALLI(AEDITCBR),B'10000000'                          0298
         BO    @RT00298                                            0298
         TM    ALLIT(TTABPTR),B'10000000'                          0298
         BNO   @RF00298                                            0298
@RT00298 DS    0H                                                  0299
*     DO;                           /* DO THE FOLLOWING              */
*       CIO='0'B;                   /* SET OFF IO PROCESSING BIT     */
         NI    CIO(TTABPTR),B'01111111'                            0300
*       ALLCT=ALLCT+1;              /* ONE OR TWO KWS NULLIFIED      */
         LA    @14,1                                               0301
         A     @14,ALLCT(,TTABPTR)                                 0301
         ST    @14,ALLCT(,TTABPTR)                                 0301
*     END;                          /* IO=ALL                        */
*AMDPSIO6:                                                         0303
*   SCNPTR=SCNPTR+1;                /* POSITION TO DELIMITER         */
@RF00298 DS    0H                                                  0303
AMDPSIO6 LA    @14,1                                               0303
         A     @14,SCNPTR(,TTABPTR)                                0303
         ST    @14,SCNPTR(,TTABPTR)                                0303
*   IF SCNCHAR=','                  /* IF NEXT CHAR IS COMMA,        */
*       ×SCNPTR=EOCADDR THEN        /* OR END-OF-STMT IS REACHED,    */
         CLI   SCNCHAR(@14),C','                                   0304
         BE    @RT00304                                            0304
         C     @14,EOCADDR(,TTABPTR)                               0304
         BNE   @RF00304                                            0304
@RT00304 DS    0H                                                  0305
*     DO;                           /* DO THE FOLLOWING              */
*       IF CSIO='1'B THEN           /* SET ON SIO=ALL TEMP BIT       */
         TM    CSIO(TTABPTR),B'00000001'                           0306
         BNO   @RF00306                                            0306
*         ALLST='1'B;               /* IF SIO BEING PROCESSED        */
         OI    ALLST(TTABPTR),B'10000000'                          0307
*       IF CIO='1'B THEN            /* SET ON IO=ALL TEMP BIT        */
@RF00306 TM    CIO(TTABPTR),B'10000000'                            0308
         BNO   @RF00308                                            0308
*         ALLIT='1'B;               /* IF IO BEING PROCESSED         */
         OI    ALLIT(TTABPTR),B'10000000'                          0309
*       GOTO AMDPCLCL;              /* POSITION TO NEXT KEYWORD      */
         B     AMDPCLCL                                            0310
*     END;                          /* DELIMITER WAS COMMA           */
*   IF SCNCHAR^='=' THEN            /* IF EQUAL SIGN DOES NOT        */
@RF00304 L     @14,SCNPTR(,TTABPTR)                                0312
         CLI   SCNCHAR(@14),C'='                                   0312
         BNE   @RT00312                                            0312
*     GOTO AMDELIM1;                /* FOLLOW, HAVE BAD DELIMITER    */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         LA    @10,1                                               0314
         AR    @14,@10                                             0314
         ST    @14,SCNPTR(,TTABPTR)                                0314
*   IF SCNCHAR=',' THEN             /* NO VALUE, SO GO ON TO NEXT    */
         CLI   SCNCHAR(@14),C','                                   0315
         BE    @RT00315                                            0315
*     GOTO AMDPCLCL;                /* KEYWORD                       */
*   IF SCNCHAR='(' THEN             /* IF LEFT PAREN FOLLOWS,        */
         CLI   SCNCHAR(@14),C'('                                   0317
         BNE   @RF00317                                            0317
*     DO;                           /* DO THE FOLLOWING              */
*       IF PAREN='1'B THEN          /* PARENS ALREADY CHECKED IF     */
         TM    PAREN(TTABPTR),B'00010000'                          0319
         BNO   @RF00319                                            0319
*         DO;                       /* SIO OR IO ALONE SPEC, SO      */
*           SCNPTR=SCNPTR+1;        /* UPDATE BUFFER PTR             */
         AR    @14,@10                                             0321
         ST    @14,SCNPTR(,TTABPTR)                                0321
*           ADDRS3=SCNPTR;          /* SAVE ADDRS OF VAL BEG'NG      */
         ST    @14,ADDRS3(,TTABPTR)                                0322
*           GOTO AMDPSIOA;          /* RESUME VALUE SCAN             */
         B     AMDPSIOA                                            0323
*         END;                                                     0324
*       IORTNSW='1'B;               /* SET RETURN INDICATION         */
@RF00319 OI    IORTNSW(TTABPTR),B'10000000'                        0325
*       REG15=8;                    /* CHECK FOR MATCHING PARENS     */
         LA    REG15,8                                             0326
*       GOTO AMDRTCTL;              /* RETURN TO CALLER              */
         B     AMDRTCTL                                            0327
*     END;                                                         0328
*   ELSE                                                           0329
*     ADDRS3=SCNPTR;                /* SAVE ADDRS OF VAL BEG'NG      */
@RF00317 MVC   ADDRS3(4,TTABPTR),SCNPTR(TTABPTR)                   0329
*AMDPSIOA:                                                         0330
*   IF CSIO='1'B THEN               /* IF PROCESSING SEL IO,         */
AMDPSIOA TM    CSIO(TTABPTR),B'00000001'                           0330
         BNO   @RF00330                                            0330
*     DO;                           /* DO THE FOLLOWING              */
*       SELST='1'B;                 /* SET ON SIO SEL TEMP BIT       */
         OI    SELST(TTABPTR),B'01000000'                          0332
*       IF CIO='1'B THEN            /* IF PROCESSING IO ALSO,        */
         TM    CIO(TTABPTR),B'10000000'                            0333
         BNO   @RF00333                                            0333
*         SELIT='1'B;               /* SET ON IO SELECTIVE BIT       */
         OI    SELIT(TTABPTR),B'01000000'                          0334
*       GOTO AMDPIORS;              /* BEGIN VALUE SCAN              */
         B     AMDPIORS                                            0335
*     END;                          /* IO BEING PROCESSED            */
*   IF CIO='0'B THEN                /* IF NOT PROCESSING IO,         */
@RF00330 TM    CIO(TTABPTR),B'10000000'                            0337
         BZ    @RT00337                                            0337
*     GOTO AMDPEOCL;                /* LOOK FOR NEXT KEYWORD         */
*   SELIT='1'B;                     /* SET ON IO SEL TEMP BIT        */
         OI    SELIT(TTABPTR),B'01000000'                          0339
*AMDPIORS:                                                         0340
*   IF SCNCHAR=','                  /* IF DELIMITER OF COMMA         */
*       ×SCNCHAR=')'                /* OF RIGHT PAREN                */
*       ×SCNCHAR=' ' THEN           /* OR BLANK                      */
AMDPIORS L     @14,SCNPTR(,TTABPTR)                                0340
         CLI   SCNCHAR(@14),C','                                   0340
         BE    @RT00340                                            0340
         CLI   SCNCHAR(@14),C')'                                   0340
         BE    @RT00340                                            0340
         CLI   SCNCHAR(@14),C' '                                   0340
         BE    @RT00340                                            0340
*     GOTO AMDPSIOC;                /* FOUND, ISOLATE VALUE          */
*   IF SCNPTR=EOCADDR               /* IF AT LOGICAL END OF STMT,    */
*     THEN                          /* THEN                          */
         C     @14,EOCADDR(,TTABPTR)                               0342
         BE    @RT00342                                            0342
*     GOTO AMDPSIOC;                /* ISOLATE VALUE                 */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AH    @14,@CH00046                                        0344
         ST    @14,SCNPTR(,TTABPTR)                                0344
*   GOTO AMDPIORS;                  /* CONTINUE SCAN                 */
         B     AMDPIORS                                            0345
*AMDPSIOC:                                                         0346
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE VALUE LENGTH        */
AMDPSIOC L     @14,SCNPTR(,TTABPTR)                                0346
         S     @14,ADDRS3(,TTABPTR)                                0346
         ST    @14,LNGTH(,TTABPTR)                                 0346
*   IF LNGTH<1 THEN                 /* IF LENGTH<1                   */
         LTR   @14,@14                                             0347
         BNP   @RT00347                                            0347
*     GOTO AMDELIM1;                /* OUTPUT BAD DELIMITER MSG      */
*   IF LNGTH^=3 THEN                /* IF LENGTH NOT = 3       Y02014*/
         CH    @14,@CH00169                                        0349
         BNE   @RT00349                                            0349
*     GOTO AMDVLN1;                 /* OUTPUT BAD VALUE LNGTH MSG    */
*                                                                  0350
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF ALL DIGITS ARE VALID HEX DIGITS--BETWEEN ZERO AND*/
*   /* 'F'.                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0351
*   DO I=LNGTH TO 1 BY-1;           /* CHECK TO DETERMINE THAT       */
         ST    @14,I(,TTABPTR)                                     0351
         B     @DE00351                                            0351
@DL00351 DS    0H                                                  0352
*     IF VAL1(I)=>'A'               /* ALL DIGITS ARE BETWEEN 'A'    */
*         &VAL1(I)=<'F' THEN        /* AND 'F'                       */
         L     @14,I(,TTABPTR)                                     0352
         L     @10,ADDRS3(,TTABPTR)                                0352
         ALR   @14,@10                                             0352
         AL    @14,@CF00473                                        0352
         CLI   VAL1(@14),C'A'                                      0352
         BL    @RF00352                                            0352
         L     @14,I(,TTABPTR)                                     0352
         ALR   @10,@14                                             0352
         AL    @10,@CF00473                                        0352
         CLI   VAL1(@10),C'F'                                      0352
         BNH   @RT00352                                            0352
*       GOTO AMDPEND;               /* OR                            */
*     IF VAL1(I)<'0'                /* 0                             */
*         ×VAL1(I)>'9' THEN         /* AND 9                         */
@RF00352 L     @14,I(,TTABPTR)                                     0354
         L     @10,ADDRS3(,TTABPTR)                                0354
         ALR   @14,@10                                             0354
         AL    @14,@CF00473                                        0354
         CLI   VAL1(@14),C'0'                                      0354
         BL    @RT00354                                            0354
         L     @14,I(,TTABPTR)                                     0354
         ALR   @10,@14                                             0354
         AL    @10,@CF00473                                        0354
         CLI   VAL1(@10),C'9'                                      0354
         BH    @RT00354                                            0354
*       GOTO AMDVMSG;               /* OTHERWISE, INVALID VALUE      */
*AMDPEND:                                                          0356
*   END;                            /* DIGIT VALIDITY CHECK          */
AMDPEND  SR    @14,@14                                             0356
         BCTR  @14,0                                               0356
         A     @14,I(,TTABPTR)                                     0356
         ST    @14,I(,TTABPTR)                                     0356
@DE00351 LTR   @14,@14                                             0356
         BP    @DL00351                                            0356
*AMDPSIOD:                                                         0357
*   CALL AMDHEX;                    /* CNVT VALUE TO BINARY          */
AMDPSIOD BAL   @14,AMDHEX                                          0357
*   IF CSIO='0'B THEN               /* IF SIO NOT BEING PROCESSED    */
         TM    CSIO(TTABPTR),B'00000001'                           0358
         BZ    @RT00358                                            0358
*     GOTO AMDPSIOE;                /* SET UP POINTERS FOR IO        */
*   SORTPTR=SIOCRPTR;               /* CURRENT SIO DEV POINTER       */
         MVC   SORTPTR(4,TTABPTR),SIOCRPTR(TTABPTR)                0360
*   SAVETAB=SVTABX;                 /* INIT BEG ADDRS TO SIO TAB     */
         MVC   SAVETAB(4,TTABPTR),SVTABX                           0361
*   SRTTABPT=SRTBPTX;               /* INIT TO SIO PLACE KEEPER      */
         MVC   SRTTABPT(4,TTABPTR),SRTBPTX                         0362
*   LASTPTR=LSTPTRX;                /* INIT TO SIO END ADDRS         */
         MVC   LASTPTR(4),LSTPTRX                                  0363
*AMDPSIOF:                                                         0364
*   IF SRTTABPT=LASTPTR THEN        /* Q/AT END OF TABLE             */
AMDPSIOF L     @14,SRTTABPT(,TTABPTR)                              0364
         C     @14,LASTPTR                                         0364
         BE    @RT00364                                            0364
*     GOTO AMDUMSG;                 /* YES--TOO MANY VALUES MSG      */
*   IF SRTTABPT=SORTPTR THEN        /* Q/AT CURRENT SLOT             */
         C     @14,SORTPTR(,TTABPTR)                               0366
         BE    @RT00366                                            0366
*     GOTO AMDPIO1;                 /* YES                           */
*   GOTO AMDPIO2;                   /* NO--CHECK VALUE               */
         B     AMDPIO2                                             0368
*AMDPSIOE:                                                         0369
*   SORTPTR=IOCRPTR;                /* CURRENT IO DEV POINTER        */
AMDPSIOE MVC   SORTPTR(4,TTABPTR),IOCRPTR(TTABPTR)                 0369
*   SAVETAB=SVTABY;                 /* INIT BEG ADDRS TO IO TAB      */
         MVC   SAVETAB(4,TTABPTR),SVTABY                           0370
*   SRTTABPT=SRTBPTY;               /* INIT TO IO PLACE KEEPER       */
         MVC   SRTTABPT(4,TTABPTR),SRTBPTY                         0371
*   LASTPTR=LSTPTRY;                /* INIT TO IO END ADDRS          */
         MVC   LASTPTR(4),LSTPTRY                                  0372
*   GOTO AMDPSIOF;                  /* BEGIN TABLE SEARCH            */
         B     AMDPSIOF                                            0373
*AMDPIO1:                                                          0374
*   IF CSIO='1'B THEN               /* IF PROCESSING SIO,            */
AMDPIO1  TM    CSIO(TTABPTR),B'00000001'                           0374
         BO    @RT00374                                            0374
*     GOTO AMDPIO4;                 /* CHK IF NOW ON SIO OR IO       */
*AMDPIO3:                                                          0376
*   IOCRPTR=IOCRPTR+2;              /* NOW AT NEXT IO SLOT           */
AMDPIO3  LA    @14,2                                               0376
         A     @14,IOCRPTR(,TTABPTR)                               0376
         ST    @14,IOCRPTR(,TTABPTR)                               0376
*   DEV=COMP8(3:4);                 /* MOVE IN CONVERTED VALUE       */
         L     @14,SRTTABPT(,TTABPTR)                              0377
         MVC   DEV(2,@14),COMP8+2(TTABPTR)                         0377
*   GOTO AMDPARN;                   /* CHECK FOR ADDITIONAL VALS     */
         B     AMDPARN                                             0378
*AMDPIO2:                                                          0379
*   IF DEV=COMP8(3:4)               /* IF EQUAL COMPARE,             */
*     THEN                          /* THEN                          */
AMDPIO2  L     @14,SRTTABPT(,TTABPTR)                              0379
         CLC   DEV(2,@14),COMP8+2(TTABPTR)                         0379
         BE    @RT00379                                            0379
*     GOTO AMDPARN;                 /* CHECK FOR ADDITIONAL VALS     */
*   SRTTABPT=SRTTABPT+2;            /* SEE IF EQUAL COMPARE WITH NEXT
*                                      VALUE IN TABLE                */
         AH    @14,@CH00078                                        0381
         ST    @14,SRTTABPT(,TTABPTR)                              0381
*   GOTO AMDPSIOF;                  /* CONTINUE TABLE SEARCH         */
         B     AMDPSIOF                                            0382
*AMDPIO4:                                                          0383
*   IF SAVETAB=ADDR(DVADS2)THEN     /* NOW PROCESSING IO             */
AMDPIO4  LA    @14,DVADS2(,AEDITCBR)                               0383
         C     @14,SAVETAB(,TTABPTR)                               0383
         BE    @RT00383                                            0383
*     GOTO AMDPIO3;                 /* INSERT VALUE IN IO TABLE      */
*   SIOCRPTR=SIOCRPTR+2;            /* NOW AT NEXT SIO SLOT          */
         LA    @14,2                                               0385
         A     @14,SIOCRPTR(,TTABPTR)                              0385
         ST    @14,SIOCRPTR(,TTABPTR)                              0385
*   DEV=COMP8(3:4);                 /* MOVE IN CONVERTED VALUE       */
         L     @14,SRTTABPT(,TTABPTR)                              0386
         MVC   DEV(2,@14),COMP8+2(TTABPTR)                         0386
*   IF EQUIND='1'B THEN             /* IF PROCESSING IO TABLE TOO    */
         TM    EQUIND(TTABPTR),B'00010000'                         0387
         BO    @RT00387                                            0387
*     GOTO AMDPSIOE;                /* SET UP IO POINTERS            */
*   GOTO AMDPARN;                   /* CHECK FOR ADDITIONAL VALS     */
*                                                                  0389
         B     AMDPARN                                             0389
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE PROCESSES THE SVC KEYWORD.                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0390
*AMDPSVC:                                                          0390
*   ENTRY;                          /* ENTRY POINT                   */
@EP00390 DS    0H                                                  0391
*   IF SYS='1'B                     /* IF AMDPRTAB SYS FLAG,         */
*       ×SYST='1'B                  /* OR TEMPTAB SYS FLAG,          */
*       ×ALLV='1'B                  /* OR AMDPRTAB SVC ALL FLAG,     */
*       ×ALLVT='1'B THEN            /* OR TTAB SVC ALL FLAG IS ON    */
         TM    SYS(AEDITCBR),B'00100000'                           0391
         BO    @RT00391                                            0391
         TM    SYST(TTABPTR),B'00100000'                           0391
         BO    @RT00391                                            0391
         TM    ALLV(AEDITCBR),B'10000000'                          0391
         BO    @RT00391                                            0391
         TM    ALLVT(TTABPTR),B'10000000'                          0391
         BO    @RT00391                                            0391
*     GOTO AMDPEOCL;                /* SEARCH FOR NEXT KEYWORD       */
*   IF NOVAL='1'B THEN              /* IF NO VALUES FOLLOW,          */
         TM    NOVAL(TTABPTR),B'00100000'                          0393
         BNO   @RF00393                                            0393
*     DO;                           /* DO THE FOLLOWING              */
*       ALLVT='1'B;                 /* 'SVC=ALL' INDICATED--SET SW   */
         OI    ALLVT(TTABPTR),B'10000000'                          0395
*       GOTO AMDPCLCL;              /* POSITION TO NEXT KEYWORD      */
         B     AMDPCLCL                                            0396
*     END;                                                         0397
*AMDPSVC1:                                                         0398
*   SELVT='1'B;                     /* SET ON SVC SELECTIVE SW       */
@RF00393 DS    0H                                                  0398
AMDPSVC1 OI    SELVT(TTABPTR),B'01000000'                          0398
*AMDPSVC2:                                                         0399
*   IF SCNCHAR=','                  /* IF DELIMITER OF COMMA         */
*       ×SCNCHAR=' '                /* OR BLANK                      */
*       ×SCNCHAR=')' THEN           /* OF RIGHT PAREN FOUND, HAVE    */
AMDPSVC2 L     @14,SCNPTR(,TTABPTR)                                0399
         CLI   SCNCHAR(@14),C','                                   0399
         BE    @RT00399                                            0399
         CLI   SCNCHAR(@14),C' '                                   0399
         BE    @RT00399                                            0399
         CLI   SCNCHAR(@14),C')'                                   0399
         BE    @RT00399                                            0399
*     GOTO AMDPSVC3;                /* DELIMITED VALUE               */
*   IF SCNPTR=EOCADDR               /* IF LOGICAL END OF STMT        */
*     THEN                          /* FOUND, THEN                   */
         C     @14,EOCADDR(,TTABPTR)                               0401
         BE    @RT00401                                            0401
*     GOTO AMDPSVC3;                /* CONTINUE PROCESSING           */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AH    @14,@CH00046                                        0403
         ST    @14,SCNPTR(,TTABPTR)                                0403
*   GOTO AMDPSVC2;                  /* RESUME SCAN FOR DELIMITER     */
         B     AMDPSVC2                                            0404
*AMDPSVC3:                                                         0405
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE VALUE LENGTH        */
AMDPSVC3 L     @14,SCNPTR(,TTABPTR)                                0405
         S     @14,ADDRS3(,TTABPTR)                                0405
         ST    @14,LNGTH(,TTABPTR)                                 0405
*   IF LNGTH>3 THEN                                                0406
         CH    @14,@CH00169                                        0406
         BH    @RT00406                                            0406
*     GOTO AMDVLN1;                 /* INVALID VALUE LENGTH MSG      */
*   IF LNGTH<1 THEN                 /* IF LENGTH<1, OUTPUT           */
         LTR   @14,@14                                             0408
         BNP   @RT00408                                            0408
*     GOTO AMDELIM1;                /* INVALID DELIMITER MSG         */
*                                                                  0409
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO DETERMINE THAT ALL DIGITS ARE BETWEEN 0 AND 9.       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0410
*   DO I=LNGTH TO 1 BY-1;           /* CHECK ALL DIGITS              */
         ST    @14,I(,TTABPTR)                                     0410
         B     @DE00410                                            0410
@DL00410 DS    0H                                                  0411
*     IF VAL1(I)<'0'                /* IF DIGIT LOWER THAN 0         */
*         ×VAL1(I)>'9' THEN         /* OR HIGHER THAN 9,             */
         L     @14,I(,TTABPTR)                                     0411
         L     @10,ADDRS3(,TTABPTR)                                0411
         ALR   @14,@10                                             0411
         AL    @14,@CF00473                                        0411
         CLI   VAL1(@14),C'0'                                      0411
         BL    @RT00411                                            0411
         L     @14,I(,TTABPTR)                                     0411
         ALR   @10,@14                                             0411
         AL    @10,@CF00473                                        0411
         CLI   VAL1(@10),C'9'                                      0411
         BH    @RT00411                                            0411
*       GOTO AMDVMSG;               /* OUTPUT INVALID VALUE MSG      */
*   END;                            /* PROCEED TO NEXT DIGIT         */
         SR    @14,@14                                             0413
         BCTR  @14,0                                               0413
         A     @14,I(,TTABPTR)                                     0413
         ST    @14,I(,TTABPTR)                                     0413
@DE00410 LTR   @14,@14                                             0413
         BP    @DL00410                                            0413
*   CALL AMDCVB;                    /* CONVERT SVC NUM TO BINARY     */
         BAL   @14,AMDCVB                                          0414
*   COMP4=COMP4+1;                  /* ALLOW FOR ZERO INDEXING       */
         LA    @14,1                                               0415
         L     @10,COMP4(,TTABPTR)                                 0415
         ALR   @10,@14                                             0415
         ST    @10,COMP4(,TTABPTR)                                 0415
*   IF COMP4>256                    /* IF NUMBER > 256               */
*       ×COMP4<1 THEN               /* OR NUMBER <ONE, THEN          */
         CH    @10,@CH00121                                        0416
         BH    @RT00416                                            0416
         CR    @10,@14                                             0416
         BL    @RT00416                                            0416
*     GOTO AMDVMSG;                 /* OUTPUT INVALID VALUE MSG      */
*                                                                  0417
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ON APPROPRIATE SVC BIT IN STRING                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0418
*   I=COMP4/8;                      /* CALCULATE BYTE                */
         SRL   @10,3                                               0418
         ST    @10,I(,TTABPTR)                                     0418
*AMDSVCSR:                                                         0419
*   J=COMP4//8;                     /* CALCULATE BIT IN BYTE         */
AMDSVCSR L     @14,COMP4(,TTABPTR)                                 0419
         N     @14,@CF00035                                        0419
         ST    @14,J(,TTABPTR)                                     0419
*   IF J=0 THEN                     /* IF NO REMAINDER, THEN         */
         LTR   @14,@14                                             0420
         BNZ   @RF00420                                            0420
*     J=8;                          /* SET ON LAST BIT IN BYTE       */
         MVC   J(4,TTABPTR),@CF00033                               0421
*   ELSE                            /* IF REMAINDER,                 */
*     I=I+1;                        /* ARE INTO NEXT BYTE            */
         B     @RC00420                                            0422
@RF00420 LA    @14,1                                               0422
         A     @14,I(,TTABPTR)                                     0422
         ST    @14,I(,TTABPTR)                                     0422
*   STRING(I)=STRING(I)             /* SET ON APPROPRIATE SVC        */
*       ×MASKS(J);                  /* BIT                           */
@RC00420 L     @14,I(,TTABPTR)                                     0423
         ALR   @14,TTABPTR                                         0423
         L     @10,J(,TTABPTR)                                     0423
         ALR   @10,TTABPTR                                         0423
         OC    STRING-1(1,@14),MASKS-1(@10)                        0423
*   GOTO AMDPARN;                   /* CHECK FOR MORE VALUES         */
*                                                                  0424
         B     AMDPARN                                             0424
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE PROCESSES THE PI KEYWORD AND VALUES. */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0425
*AMDPPGM:                                                          0425
*   ENTRY;                          /* ENTRY POINT                   */
@EP00425 DS    0H                                                  0426
*   IF SYS='1'B                     /* IF AMDPRTAB SYS FLAG,         */
*       ×SYST='1'B                  /* OR TEMPTAB SYS FLAG,          */
*       ×ALLP='1'B                  /* OR AMDPRTAB PI ALL FLAG,      */
*       ×ALLPT='1'B THEN            /* OR TTAB PI ALL FLAG IS ON,    */
         TM    SYS(AEDITCBR),B'00100000'                           0426
         BO    @RT00426                                            0426
         TM    SYST(TTABPTR),B'00100000'                           0426
         BO    @RT00426                                            0426
         TM    ALLP(AEDITCBR),B'10000000'                          0426
         BO    @RT00426                                            0426
         TM    ALLPT(TTABPTR),B'10000000'                          0426
         BO    @RT00426                                            0426
*     GOTO AMDPEOCL;                /* SEARCH FOR NEXT KEYWORD       */
*   IF NOVAL='1'B THEN              /* IF NO VALUES FOLLOW, THEN     */
         TM    NOVAL(TTABPTR),B'00100000'                          0428
         BNO   @RF00428                                            0428
*     DO;                           /* DO THE FOLLOWING              */
*       ALLPT='1'B;                 /* ALL IS INDICATED              */
         OI    ALLPT(TTABPTR),B'10000000'                          0430
*       GOTO AMDPCLCL;              /* PREPARE FOR NEXT KEYWORD      */
         B     AMDPCLCL                                            0431
*     END;                          /* NO VALUES SPECIFIED           */
*   SELPT='1'B;                     /* SET ON PI SELECTIVE IND       */
@RF00428 OI    SELPT(TTABPTR),B'01000000'                          0433
*AMDPPGM2:                                                         0434
*   IF SCNCHAR=','                  /* IF DELIMITER OF COMMA         */
*       ×SCNCHAR=' '                /* OR BLANK                      */
*       ×SCNCHAR=')' THEN           /* OR RIGHT PAREN FOUND, HAVE    */
AMDPPGM2 L     @14,SCNPTR(,TTABPTR)                                0434
         CLI   SCNCHAR(@14),C','                                   0434
         BE    @RT00434                                            0434
         CLI   SCNCHAR(@14),C' '                                   0434
         BE    @RT00434                                            0434
         CLI   SCNCHAR(@14),C')'                                   0434
         BE    @RT00434                                            0434
*     GOTO AMDPPGM3;                /* DELIMITED VALUE               */
*   IF SCNPTR=EOCADDR               /* IF LOGICAL END OF STMT        */
*     THEN                          /* FOUND, THEN                   */
         C     @14,EOCADDR(,TTABPTR)                               0436
         BE    @RT00436                                            0436
*     GOTO AMDPPGM3;                /* CONTINUE PROCESSING           */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AH    @14,@CH00046                                        0438
         ST    @14,SCNPTR(,TTABPTR)                                0438
*   GOTO AMDPPGM2;                  /* RESUME SCAN FOR DELIMITER     */
         B     AMDPPGM2                                            0439
*AMDPPGM3:                                                         0440
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE LENGTH              */
AMDPPGM3 L     @14,SCNPTR(,TTABPTR)                                0440
         S     @14,ADDRS3(,TTABPTR)                                0440
         ST    @14,LNGTH(,TTABPTR)                                 0440
*   IF LNGTH>2 THEN                 /* IF LNGTH>TWO, OUTPUT          */
         CH    @14,@CH00078                                        0441
         BH    @RT00441                                            0441
*     GOTO AMDVLN1;                 /* INVALID VALUE LENGTH MSG      */
*   IF LNGTH<1 THEN                 /* IF LENGTH<ONE,OUTPUT          */
         LTR   @14,@14                                             0443
         BNP   @RT00443                                            0443
*     GOTO AMDELIM1;                /* INVALID DELIMITER MSG         */
*                                                                  0444
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO DETERMINE THAT ALL DIGITS ARE BETWEEN 0 AND 9.       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0445
*   DO I=LNGTH TO 1 BY-1;           /* CHECK ALL DIGITS              */
         ST    @14,I(,TTABPTR)                                     0445
         B     @DE00445                                            0445
@DL00445 DS    0H                                                  0446
*     IF VAL1(I)<'0'                /* IF DIGIT LOWER THAN 0         */
*         ×VAL1(I)>'9' THEN         /* OR HIGHER THAN 9,             */
         L     @14,I(,TTABPTR)                                     0446
         L     @10,ADDRS3(,TTABPTR)                                0446
         ALR   @14,@10                                             0446
         AL    @14,@CF00473                                        0446
         CLI   VAL1(@14),C'0'                                      0446
         BL    @RT00446                                            0446
         L     @14,I(,TTABPTR)                                     0446
         ALR   @10,@14                                             0446
         AL    @10,@CF00473                                        0446
         CLI   VAL1(@10),C'9'                                      0446
         BH    @RT00446                                            0446
*       GOTO AMDVMSG;               /* OUTPUT INVALID VALUE MSG      */
*   END;                            /* PROCEED TO NEXT DIGIT         */
         SR    @14,@14                                             0448
         BCTR  @14,0                                               0448
         A     @14,I(,TTABPTR)                                     0448
         ST    @14,I(,TTABPTR)                                     0448
@DE00445 LTR   @14,@14                                             0448
         BP    @DL00445                                            0448
*   CALL AMDCVB;                    /* CONVERT PI CODE TO BINARY     */
         BAL   @14,AMDCVB                                          0449
*   IF COMP4=17 THEN                                               0450
         CLC   COMP4(4,TTABPTR),@CF00564                           0450
         BNE   @RF00450                                            0450
*     DO;                           /* IF VALUE = PI 17              */
*       PISTRB(1)='1'B;             /* SET ON BIT IN AMDSCNTB        */
         OI    PISTRB(TTABPTR),B'10000000'                         0452
*       GOTO AMDPARN;               /* GO CHECK FOR MORE VALUES      */
         B     AMDPARN                                             0453
*     END;                                                         0454
*   IF COMP4=18 THEN                                               0455
@RF00450 CLC   COMP4(4,TTABPTR),@CF00565                           0455
         BNE   @RF00455                                            0455
*     DO;                           /* IF VALUE = PI 18              */
*       PISTRB(2)='1'B;             /* SET ON BIT IN AMDSCNTB        */
         OI    PISTRB(TTABPTR),B'01000000'                         0457
*       GOTO AMDPARN;               /* GO CHECK FOR MORE VALUES      */
         B     AMDPARN                                             0458
*     END;                                                         0459
*   IF COMP4=19 THEN                                               0460
@RF00455 CLC   COMP4(4,TTABPTR),@CF00566                           0460
         BNE   @RF00460                                            0460
*     DO;                           /* IF VALUE = PI 19              */
*       PISTRB(3)='1'B;             /* SET ON BIT IN AMDSCNTB        */
         OI    PISTRB(TTABPTR),B'00100000'                         0462
*       GOTO AMDPARN;               /* CHECK FOR MORE VALUES         */
         B     AMDPARN                                             0463
*     END;                                                         0464
*   IF COMP4>16                     /* IF VALUE NOT WITHIN RANGE     */
*       ×COMP4<1 THEN               /* OF 1 AND 16, THEN       Y02014*/
@RF00460 L     @14,COMP4(,TTABPTR)                                 0465
         CL    @14,@CF00139                                        0465
         BH    @RT00465                                            0465
         CL    @14,@CF00046                                        0465
         BL    @RT00465                                            0465
*     GOTO AMDVMSG;                 /* OUTPUT INVALID VALUE MSG      */
*                                                                  0466
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ON APPROPRIATE PI BIT IN STRING                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0467
*   I=COMP4/8;                      /* CALCULATE BYTE                */
         SRL   @14,3                                               0467
         ST    @14,I(,TTABPTR)                                     0467
*AMDPISTR:                                                         0468
*   J=COMP4//8;                     /* CALCULATE BIT IN BYTE         */
AMDPISTR L     @14,COMP4(,TTABPTR)                                 0468
         N     @14,@CF00035                                        0468
         ST    @14,J(,TTABPTR)                                     0468
*   IF J=0 THEN                     /* IF NO REMAINDER, THEN         */
         LTR   @14,@14                                             0469
         BNZ   @RF00469                                            0469
*     J=8;                          /* SET ON LAST BIT IN BYTE       */
         MVC   J(4,TTABPTR),@CF00033                               0470
*   ELSE                            /* IF REMAINDER,                 */
*     I=I+1;                        /* ARE INTO NEXT BYTE            */
         B     @RC00469                                            0471
@RF00469 LA    @14,1                                               0471
         A     @14,I(,TTABPTR)                                     0471
         ST    @14,I(,TTABPTR)                                     0471
*   STRING1(I)=STRING1(I)           /* SET ON APPROPRIATE PI         */
*       ×MASKS(J);                  /* BIT                           */
@RC00469 L     @14,I(,TTABPTR)                                     0472
         ALR   @14,TTABPTR                                         0472
         L     @10,J(,TTABPTR)                                     0472
         ALR   @10,TTABPTR                                         0472
         OC    STRING1-1(1,@14),MASKS-1(@10)                       0472
*   GOTO AMDPARN;                   /* CHECK FOR MORE VALUES         */
*                                                                  0473
         B     AMDPARN                                             0473
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE PROCESSES THE SYS KEYWORD.           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0474
*AMDPSYS:                                                          0474
*   ENTRY;                          /* ENTRY POINT                   */
@EP00474 DS    0H                                                  0475
*   SYST='1'B;                      /* SET ON SYS BIT IN TEMPTAB     */
*   SYSMT='1'B;                     /* SET ON TEMPTAB SYSM BIT       */
         OI    SYST(TTABPTR),B'00110000'                           0476
*   ALLST='1'B;                     /* SET ON TEMPTAB SIO ALL BIT    */
         OI    ALLST(TTABPTR),B'10000000'                          0477
*   ALLIT='1'B;                     /* SET ON TEMPTAB IO ALL BIT     */
         OI    ALLIT(TTABPTR),B'10000000'                          0478
*   ALLVT='1'B;                     /* SET ON TEMPTAB SVC ALL BIT    */
         OI    ALLVT(TTABPTR),B'10000000'                          0479
*   ALLPT='1'B;                     /* SET ON TEMPTAB PI ALL BIT     */
         OI    ALLPT(TTABPTR),B'10000000'                          0480
*   EXTT='1'B;                      /* SET ON TEMPTAB EXT BIT        */
*   DSPT='1'B;                      /* SET ON TEMPTAB DSP BIT        */
*   RNIOT='1'B;                     /* SET TEMPTAB RNIO        Y02014*/
*   SRMT='1'B;                      /* SET TEMPTAB SRM BIT     Y02014*/
*   RRT='1'B;                       /* SET TEMPTAB RR BIT      Y02014*/
         OI    EXTT(TTABPTR),B'11001110'                           0485
*   GOTO AMDPEOCL;                  /* SEARCH FOR NEXT KEYWORD       */
*                                                                  0486
         B     AMDPEOCL                                            0486
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SBROUTINE PROCESSES THE EXT KEYWORD.            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0487
*AMDPEXT:                                                          0487
*   ENTRY;                          /* ENTRY POINT                   */
@EP00487 DS    0H                                                  0488
*   EXTT='1'B;                      /* SET ON TEMPTAB EXT BIT        */
         OI    EXTT(TTABPTR),B'10000000'                           0488
*   GOTO AMDPEOCL;                  /* SEARCH FOR NEXT KEYWORD       */
*                                                                  0489
         B     AMDPEOCL                                            0489
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE PROCESSES THE DSP KEYWORD.           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0490
*AMDPDSP:                                                          0490
*   ENTRY;                          /* ENTRY POINT                   */
@EP00490 DS    0H                                                  0491
*   DSPT='1'B;                      /* SET ON TEMPTAB DSP BIT        */
         OI    DSPT(TTABPTR),B'01000000'                           0491
*   GOTO AMDPEOCL;                  /* SEARCH FOR NEXT KEYWORD       */
*                                                                  0492
         B     AMDPEOCL                                            0492
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE PROCESSES THE RNIO KEYWD       Y02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0493
*AMDPRNIO:                                                         0493
*   ENTRY;                          /* ENTRY POINT             Y02014*/
@EP00493 DS    0H                                                  0494
*   RNIOT='1'B;                     /* SET TEMPTAB RNIO        Y02014*/
         OI    RNIOT(TTABPTR),B'00001000'                          0494
*   GOTO AMDPEOCL;                  /* SRCH FOR NEXT KEYWD     Y02014*/
*                                                                  0495
         B     AMDPEOCL                                            0495
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE PROCESSES THE SRM KEYWD        Y02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0496
*AMDPSRM:                                                          0496
*   ENTRY;                          /* ENTRY POINT             Y02014*/
@EP00496 DS    0H                                                  0497
*   SRMT='1'B;                      /* SET ON TEMPTAB SRM      Y02014*/
         OI    SRMT(TTABPTR),B'00000100'                           0497
*   GOTO AMDPEOCL;                  /* SRCH FOR NEXT KEYWD     Y02014*/
*                                                                  0498
         B     AMDPEOCL                                            0498
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE PROCESSES THE RR KEYWD         Y02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0499
*AMDPRR:                                                           0499
*   ENTRY;                          /* ENTRY POINT             Y02014*/
@EP00499 DS    0H                                                  0500
*   RRT='1'B;                       /* SET TEMPTAB RR BIT      Y02014*/
         OI    RRT(TTABPTR),B'00000010'                            0500
*   GOTO AMDPEOCL;                  /* SRCH FOR NEXT KEYWD     Y02014*/
*                                                                  0501
         B     AMDPEOCL                                            0501
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE PROCESSES THE EOF KEYWD        Y02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0502
*AMDPEOF:                                                          0502
*   ENTRY;                          /* ENTRY POINT             Y02014*/
@EP00502 DS    0H                                                  0503
*   EOFT='1'B;                      /* SET TEMPTAB EOF BIT     Y02014*/
         OI    EOFT(TTABPTR),B'00000001'                           0503
*   GOTO AMDPEOCL;                  /* SRCH FOR NEXT KEYWD     Y02014*/
*                                                                  0504
         B     AMDPEOCL                                            0504
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE CONVERTS PRINTABLE DECIMAL TO BINARY.*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0505
*AMDPRCVB:                                                         0505
*   ENTRY;                          /* CVB EXTERNAL ROUTINE          */
@EP00505 DS    0H                                                  0506
*   CALL AMDCVB;                    /* CALL INTERNAL ROUTINE         */
         BAL   @14,AMDCVB                                          0506
*   RETURN;                         /* RETURN TO CALLER              */
*                                                                  0507
         B     @EL00001                                            0507
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE CONVERTS PRINTABLE HEX TO BINARY.    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0508
*AMDPRHX:                                                          0508
*   ENTRY;                          /* ENTRY POINT                   */
@EP00508 DS    0H                                                  0509
*   CALL AMDHEX;                    /* CALL INTERNAL ROUTINE         */
         BAL   @14,AMDHEX                                          0509
*   RETURN;                         /* RETURN TO CALLER              */
*                                                                  0510
         B     @EL00001                                            0510
*   /*****************************************************************/
*   /*                                                               */
*   /* INTERNAL PROCEDURE                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0511
*AMDCVB:                                                           0511
*   PROC;                           /* INTERNAL PROCEDURE            */
AMDCVB   STM   @14,@12,@SA00002                                    0511
*   RFY                                                            0512
*    (REG4,                         /* WORK REGISTER           Y02014*/
*     REG5,                         /* WORK REGISTER                 */
*     AEDITCBR,                     /* PTR TO AMDPRTAB               */
*     TTABPTR,                      /* PTR TO AMDSCNTB               */
*     REG6,                         /* WORK REGISTER                 */
*     REGPT)RSTD;                   /* POINTER TO AMDPRCOM     Y02014*/
*   REG6=LNGTH-1;                   /* OBTAIN VALUE LENGTH           */
         L     REG6,LNGTH(,TTABPTR)                                0513
         BCTR  REG6,0                                              0513
*   REG4=ADDRS3;                    /* OBTAIN ADDRS OF VALUE STRT    */
         L     REG4,ADDRS3(,TTABPTR)                               0514
*   REG5=ADDR(DBLWORD);             /* OBTAIN ADDRS OF RECEIVER      */
         LA    REG5,DBLWORD(,TTABPTR)                              0515
*   GENERATE;                                                      0516
*                                       /* CNVRT FROM DEC TO BIN     */
         EX   R6,PACK3                  EXECUTE PACK INSTRUCTION
         B    AMDPCVB1                  CONVERT RESULT TO BINARY
PACK3    PACK  0(8,R5),0(0,R4)          PACK DIGITS
AMDPCVB1 CVB   R6,0(R5)              RESULT CONVERTED TO BINARY
*   COMP4=REG6;                     /* SAVE RESULT                   */
         ST    REG6,COMP4(,TTABPTR)                                0517
*   RETURN;                         /* RETURN TO CALLER              */
@EL00002 DS    0H                                                  0518
@EF00002 DS    0H                                                  0518
@ER00002 LM    @14,@12,@SA00002                                    0518
         BR    @14                                                 0518
*   END AMDCVB;                     /* END OF INTERNAL PROCEDURE     */
*                                                                  0519
*   /*****************************************************************/
*   /*                                                               */
*   /* INTERNAL PROCEDURE                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0520
*AMDHEX:                                                           0520
*   PROC;                           /* INTERNAL PROCEDURE            */
AMDHEX   STM   @14,@12,@SA00003                                    0520
*   RFY                                                            0521
*    (REG2,                         /* WORK REGISTER           Y02014*/
*     REG4,                         /* WORK REGISTER                 */
*     AEDITCBR,                     /* PTR TO AMDPRTAB               */
*     TTABPTR,                      /* PTR TO AMDSCNTB               */
*     REG5,                         /* WORK REGISTER                 */
*     REGPT)RSTD;                   /* POINTER TO AMDPRCOM     Y02014*/
*   REG2=LNGTH-1;                   /* OBTAIN VALUE LNGTH            */
         L     REG2,LNGTH(,TTABPTR)                                0522
         BCTR  REG2,0                                              0522
*   REG4=ADDRS3;                    /* OBTAIN PTR TO FIRST CHAR      */
         L     REG4,ADDRS3(,TTABPTR)                               0523
*   GENERATE;                                                      0524
*                                       /* CNVRT FROM HEX TO BIN     */
         EX   R2,ANDCHAR                EXECUTE NC INSTRUCTION
         EX   R2,TRANCHAR               EXECUTE TR INSTRUCTION
         B    INTHEX1                   PREPARE FOR PACK INSTRUCTION
ANDCHAR  NC   0(0,R4),ZONES       PREPARATION FOR TRANSLATE
TRANCHAR TR   0(0,R4),TRNTABL     PREPARATION FOR PACK
INTHEX1  LA   R5,WORDPLUS               OBTAIN ADDRS OF RECEIVER
         LA   R2,1(R2)                OBTAIN ACTUAL LENGTH
         EX   R2,PACKCHAR               ELIMINATE ZONES
         B    INTHEX2                   STORE RESULT
PACKCHAR PACK 0(5,R5),0(0,R4) PACK DIGITS
*INTHEX2:                                                          0525
*   COMP8=WORDPLUS;                 /* STRIP EXTRA BYTE/STORE RESULT */
INTHEX2  MVI   COMP8+5(TTABPTR),C' '                               0525
         MVC   COMP8+6(2,TTABPTR),COMP8+5(TTABPTR)                 0525
         MVC   COMP8(5,TTABPTR),WORDPLUS                           0525
*   RETURN;                         /* RETURN TO CALLER              */
@EL00003 DS    0H                                                  0526
@EF00003 DS    0H                                                  0526
@ER00003 LM    @14,@12,@SA00003                                    0526
         BR    @14                                                 0526
*   END AMDHEX;                                                    0527
*   END AMDPRSN2                    /* END OF EXTERNAL PROCEDURE     */
*                                                                  0528
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMDPRTAB)                                       */
*/*%INCLUDE SYSLIB  (AMDSCNTB)                                       */
*                                                                  0528
*       ;                                                          0528
         B     @EL00001                                            0528
@DATA    DS    0H
@CH00078 DC    H'2'
@CH00169 DC    H'3'
@CH00086 DC    H'5'
@CH00034 DC    H'11'
@CH00121 DC    H'256'
@SM00614 MVC   COMP8(0,TTABPTR),VAL1(@14)
@SM00616 MVC   DDNM(0,TTABPTR),VAL1(@14)
@SM00618 MVC   EXITNAME(0,TTABPTR),VAL1(@10)
@SM00620 MVC   COMP8(0,TTABPTR),VAL1(@10)
@SM00622 MVC   DEV(0,@14),COMP8(TTABPTR)
@SC00624 CLC   DEV(0,@14),COMP8(TTABPTR)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00003 DS    15F
         DS    0F
@CF00473 DC    F'-1'
@CF00046 DC    F'1'
@CH00046 EQU   @CF00046+2
@CF00099 DC    F'4'
@CF00035 DC    F'7'
@CF00033 DC    F'8'
@CH00033 EQU   @CF00033+2
@CF00139 DC    F'16'
@CF00564 DC    F'17'
@CF00565 DC    F'18'
@CF00566 DC    F'19'
@CA00319 DC    A(AMDPRS00)
         DS    0D
LASTPTR  DS    A
SRTBPTX  DS    A
SVTABX   DS    A
LSTPTRX  DS    A
SRTBPTY  DS    A
SVTABY   DS    A
LSTPTRY  DS    A
ZONES    DC    X'1F1F1F1F1F1F1F1F'
TRNTABL  DS    CL32
         ORG   TRNTABL
TRNTABL1 DC    X'00FAFBFCFDFEFF'
TRNTABL2 DS    CL9
TRNTABL3 DC    CL16'0123456789ABCDEF'
         ORG   TRNTABL+32
WORDPLUS DS    CL5
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
AEDITCBR EQU   @09
TTABPTR  EQU   @03
REG1     EQU   @01
REG2     EQU   @02
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REGPT    EQU   @12
REG15    EQU   @15
REG7     EQU   @07
         EXTRN AMDPRS00
AMDPRTAB EQU   0
DEBGFLGS EQU   AMDPRTAB+8
PTHFLGS1 EQU   DEBGFLGS
PTHFLGS2 EQU   DEBGFLGS+1
INRFCFGS EQU   DEBGFLGS+2
IOFLGS   EQU   DEBGFLGS+3
USEREXIT EQU   AMDPRTAB+24
DDNAME   EQU   AMDPRTAB+32
STARTIME EQU   AMDPRTAB+40
STOPTIME EQU   AMDPRTAB+52
NAMES    EQU   AMDPRTAB+64
ADS      EQU   AMDPRTAB+104
AADS     EQU   ADS
SIF      EQU   AMDPRTAB+124
SIOFLGS  EQU   SIF
ALLS     EQU   SIOFLGS
NOEQU    EQU   SIOFLGS
DVADS1   EQU   AMDPRTAB+128
IO       EQU   AMDPRTAB+228
IOFLGS2  EQU   IO
ALLI     EQU   IOFLGS2
DVADS2   EQU   AMDPRTAB+232
VCF      EQU   AMDPRTAB+332
SVCFLGS  EQU   VCF
ALLV     EQU   SVCFLGS
USR      EQU   AMDPRTAB+368
USRFLGS  EQU   USR
USRTAB   EQU   AMDPRTAB+372
PI       EQU   AMDPRTAB+452
PIFLGS   EQU   PI
ALLP     EQU   PIFLGS
PGMNGEN  EQU   AMDPRTAB+456
GENFLAGS EQU   PGMNGEN+3
SYS      EQU   GENFLAGS
GENFLGS1 EQU   AMDPRTAB+460
ESTARTME EQU   AMDPRTAB+500
ESTOPTME EQU   AMDPRTAB+509
AMDSCNTB EQU   0
TEMPTAB  EQU   AMDSCNTB
EXITNAME EQU   TEMPTAB
DDNM     EQU   TEMPTAB+8
STARTSL  EQU   TEMPTAB+16
STOPSL   EQU   TEMPTAB+28
OVERLTAB EQU   TEMPTAB+40
SIOTFLGS EQU   TEMPTAB+80
ALLST    EQU   SIOTFLGS
SELST    EQU   SIOTFLGS
EQUIVT   EQU   SIOTFLGS
NOEQUT   EQU   SIOTFLGS
IOTFLGS  EQU   TEMPTAB+81
ALLIT    EQU   IOTFLGS
SELIT    EQU   IOTFLGS
USRTFLGS EQU   TEMPTAB+82
SVCTFLGS EQU   TEMPTAB+83
ALLVT    EQU   SVCTFLGS
SELVT    EQU   SVCTFLGS
PITFLGS  EQU   TEMPTAB+84
ALLPT    EQU   PITFLGS
SELPT    EQU   PITFLGS
SYSTFLGS EQU   TEMPTAB+85
EXTT     EQU   SYSTFLGS
DSPT     EQU   SYSTFLGS
SYST     EQU   SYSTFLGS
SYSMT    EQU   SYSTFLGS
RNIOT    EQU   SYSTFLGS
SRMT     EQU   SYSTFLGS
RRT      EQU   SYSTFLGS
EOFT     EQU   SYSTFLGS
SIOCRPTR EQU   TEMPTAB+104
IOCRPTR  EQU   TEMPTAB+108
JOBCRPTR EQU   TEMPTAB+112
ASCBCPTR EQU   TEMPTAB+116
SVCSTR   EQU   TEMPTAB+128
PISTR    EQU   TEMPTAB+160
PISTRB   EQU   TEMPTAB+162
SCNBITS  EQU   AMDSCNTB+163
IORTNSW  EQU   SCNBITS
EQUIND   EQU   SCNBITS
CODETABL EQU   AMDSCNTB+164
CXIT     EQU   CODETABL
CJOBN    EQU   CODETABL
CASCB    EQU   CODETABL
CSIO     EQU   CODETABL
CIO      EQU   CODETABL+1
CSVC     EQU   CODETABL+1
CPI      EQU   CODETABL+1
NOVAL    EQU   CODETABL+2
PAREN    EQU   CODETABL+2
DBLWORD  EQU   AMDSCNTB+176
KWTAB1   EQU   AMDSCNTB+184
KWTAB2   EQU   AMDSCNTB+228
BLANK1   EQU   AMDSCNTB+316
MASKS    EQU   AMDSCNTB+328
SCNPTR   EQU   AMDSCNTB+336
ADDRS3   EQU   AMDSCNTB+348
EOCADDR  EQU   AMDSCNTB+352
LNGTH    EQU   AMDSCNTB+356
COMP4    EQU   AMDSCNTB+360
COMP8    EQU   AMDSCNTB+364
SVKEY    EQU   AMDSCNTB+372
SAVETAB  EQU   AMDSCNTB+376
SORTPTR  EQU   AMDSCNTB+380
SRTTABPT EQU   AMDSCNTB+384
INCRT    EQU   AMDSCNTB+388
ALLCT    EQU   AMDSCNTB+392
I        EQU   AMDSCNTB+396
J        EQU   AMDSCNTB+400
AMDPRSYN EQU   0
MSGADDR  EQU   0
ERRBUF   EQU   0
VAL1     EQU   0
SCNCHAR  EQU   0
DEV      EQU   0
DEVICE   EQU   0
AD3      EQU   AMDPRS00+8
AD4      EQU   AMDPRS00+12
AD5      EQU   AMDPRS00+16
AD6      EQU   AMDPRS00+20
AD7      EQU   AMDPRS00+24
GNOSTDMG EQU   SWD
STRING   EQU   SVCSTR
STRING1  EQU   PISTR
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
GRDRSW   EQU   SWA
GSETCVTS EQU   SWA
GPRNTSW  EQU   SWA
GGOSW    EQU   SWA
GTSOSW   EQU   SWA
GJBNMSW  EQU   SWA
GREAD    EQU   SWA
GSTORSW  EQU   SWA
GFRBUFSW EQU   SWD
GGPRSFND EQU   SWD
GCONTSW  EQU   SWD
GPREFMTD EQU   SWD
GNCDUMP  EQU   SWD
GSWPDCBC EQU   SWD
GFLSHMOD EQU   SWD
AD11     EQU   AMDPRS00+40
AD10     EQU   AMDPRS00+36
AD9      EQU   AMDPRS00+32
AD8      EQU   AMDPRS00+28
AD2      EQU   AMDPRS00+4
AD1      EQU   AMDPRS00
INTSTOP  EQU   AMDSCNTB+409
INTSTART EQU   AMDSCNTB+404
ALLPTR   EQU   SAVETAB
ADDRS1   EQU   AMDSCNTB+344
BUFADDR  EQU   AMDSCNTB+340
WORD     EQU   AMDSCNTB+168
@NM00003 EQU   CODETABL+2
CEOF     EQU   CODETABL+2
CRR      EQU   CODETABL+2
CSRM     EQU   CODETABL+1
CRNIO    EQU   CODETABL+1
CDSP     EQU   CODETABL+1
CEXT     EQU   CODETABL+1
CSYS     EQU   CODETABL+1
CUSR     EQU   CODETABL
CSTOP    EQU   CODETABL
CSTART   EQU   CODETABL
CDDN     EQU   CODETABL
RESBITS  EQU   SCNBITS
PRNSW    EQU   SCNBITS
RUNEDIT  EQU   SCNBITS
SCANBIT  EQU   SCNBITS
MORESW   EQU   SCNBITS
USRCRCNT EQU   TEMPTAB+124
USRCOUNT EQU   TEMPTAB+120
ASCBPTR  EQU   TEMPTAB+100
JOBNPTR  EQU   TEMPTAB+96
IOPTR    EQU   TEMPTAB+92
SIOPTR   EQU   TEMPTAB+88
@NM00002 EQU   TEMPTAB+86
T        EQU   PITFLGS
GT       EQU   SVCTFLGS
ET       EQU   USRTFLGS
SELUT    EQU   USRTFLGS
ALLUT    EQU   USRTFLGS
BT       EQU   IOTFLGS
AT       EQU   SIOTFLGS
OVERSL   EQU   OVERLTAB
DYSTP    EQU   STOPSL+10
YRSTP    EQU   STOPSL+8
TIMERU   EQU   STOPSL
DY       EQU   STARTSL+10
YR       EQU   STARTSL+8
TIMEU    EQU   STARTSL
RESERVED EQU   AMDPRTAB+522
CVTTZONE EQU   AMDPRTAB+518
ESPSEC   EQU   ESTOPTME+7
ESPMIN   EQU   ESTOPTME+5
ESPHR    EQU   ESTOPTME+3
ESPDAY   EQU   ESTOPTME
ESSEC    EQU   ESTARTME+7
ESMIN    EQU   ESTARTME+5
ESHR     EQU   ESTARTME+3
ESDAY    EQU   ESTARTME
ADTSBUF  EQU   AMDPRTAB+496
OFSTDATA EQU   AMDPRTAB+494
OFSTEID  EQU   AMDPRTAB+492
AFRMAD   EQU   AMDPRTAB+488
REENTWKA EQU   AMDPRTAB+484
PRFMTADD EQU   AMDPRTAB+480
AEIOCT   EQU   AMDPRTAB+476
EXITADDR EQU   AMDPRTAB+472
EXITNM   EQU   AMDPRTAB+464
RECDLL   EQU   AMDPRTAB+461
@NM00001 EQU   GENFLGS1
FIRSTHSW EQU   GENFLGS1
TSFOUND  EQU   GENFLGS1
EOFINPRO EQU   GENFLGS1
TS       EQU   GENFLGS1
EOF      EQU   GENFLAGS
RR       EQU   GENFLAGS
SRM      EQU   GENFLAGS
RNIO     EQU   GENFLAGS
SYSM     EQU   GENFLAGS
DSP      EQU   GENFLAGS
EXT      EQU   GENFLAGS
PICODEA  EQU   PGMNGEN+2
PICODES  EQU   PGMNGEN
Q        EQU   PI+1
P01R     EQU   PIFLGS
SELP     EQU   PIFLGS
USRNGTAB EQU   USRTAB
O        EQU   USR+1
N01R     EQU   USRFLGS
SELU     EQU   USRFLGS
ALLU     EQU   USRFLGS
SVCNUMS  EQU   AMDPRTAB+336
M        EQU   VCF+1
L        EQU   SVCFLGS
SELV     EQU   SVCFLGS
IODVADS  EQU   DVADS2
K01RES   EQU   IO+1
JJ       EQU   IOFLGS2
SELI     EQU   IOFLGS2
SIODVADS EQU   DVADS1
II       EQU   SIF+1
H        EQU   SIOFLGS
EQUIV    EQU   SIOFLGS
SELS     EQU   SIOFLGS
ASCBADDR EQU   AADS
JOBNAMES EQU   NAMES
DAY2     EQU   STOPTIME+10
F        EQU   STOPTIME+8
TIME2    EQU   STOPTIME
DAY      EQU   STARTIME+10
D        EQU   STARTIME+8
TIME     EQU   STARTIME
GTFWDPTR EQU   AMDPRTAB+20
C        EQU   DEBGFLGS+4
B        EQU   IOFLGS
GETEOF   EQU   IOFLGS
DMDFMT   EQU   INRFCFGS
EDITSTOP EQU   INRFCFGS
EXTTRC   EQU   INRFCFGS
RET      EQU   INRFCFGS
FMT      EQU   INRFCFGS
SPIE     EQU   INRFCFGS
TERM     EQU   INRFCFGS
FLMODE   EQU   INRFCFGS
REMAIN   EQU   PTHFLGS2
APP      EQU   PTHFLGS2
REXT     EQU   PTHFLGS1
FRM      EQU   PTHFLGS1
FLT      EQU   PTHFLGS1
HEX      EQU   PTHFLGS1
CON      EQU   PTHFLGS1
GET      EQU   PTHFLGS1
SCN      EQU   PTHFLGS1
ROOT     EQU   PTHFLGS1
CURREC   EQU   AMDPRTAB+4
AFMG     EQU   AMDPRTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00047 EQU   AMDPNAM1
@RT00049 EQU   AMDPNAM1
@RT00051 EQU   AMDPNAM1
@RT00053 EQU   AMDPNAM1
@RT00058 EQU   AMDVLMG1
@RT00067 EQU   AMDPNAM2
@RT00069 EQU   AMDPNAM2
@RT00074 EQU   AMDVLN1
@RT00076 EQU   AMDELIM1
@RT00080 EQU   AMDPNAM3
@RT00082 EQU   AMDPNAM4
@RT00084 EQU   AMDPNAM5
@RT00088 EQU   AMDPNAM6
@RT00090 EQU   AMDPNAM7
@RT00095 EQU   AMDPEOCL
@RT00098 EQU   AMDPEOCL
@RT00101 EQU   AMDPEOCL
@RT00104 EQU   AMDPEOCL
AMDRTCTL EQU   @EL00001
@RT00114 EQU   AMDVLEN1
@RT00134 EQU   AMDPTAJ1
@RT00136 EQU   AMDPTAJ1
@RT00142 EQU   AMDPTAJ3
@RT00144 EQU   AMDVLN1
@RT00146 EQU   AMDELIM1
@RT00148 EQU   AMDPTAJ2
@RT00150 EQU   AMDPTAJ2
@RT00152 EQU   AMDPTAJ2
@RT00154 EQU   AMDPTAJ2
@RT00159 EQU   AMDUMSG
@RT00170 EQU   AMDPEOCL
@RT00172 EQU   AMDPEOCL
@RT00176 EQU   AMDPTAJX
@RT00178 EQU   AMDPSVC2
@RT00180 EQU   AMDPPGM2
@RF00184 EQU   AMDPARN
@RT00190 EQU   AMDVLN1
@RT00192 EQU   AMDELIM1
@RT00195 EQU   AMDPOK1
@RT00197 EQU   AMDVMSG
@RT00206 EQU   AMDELIM2
@RT00215 EQU   AMDUMMG1
@RT00230 EQU   AMDPEOCL
@RT00232 EQU   AMDPEOCL
@RT00234 EQU   AMDPSIO1
@RT00237 EQU   AMDPSIO2
@RT00251 EQU   AMDPEOCL
@RT00253 EQU   AMDPEOCL
@RT00277 EQU   AMDPEOCL
@RT00279 EQU   AMDPEOCL
@RC00282 EQU   AMDPSIO6
@RT00286 EQU   AMDPSIO5
@RT00291 EQU   AMDPSI31
@RF00308 EQU   AMDPCLCL
@RT00312 EQU   AMDELIM1
@RT00315 EQU   AMDPCLCL
@RF00333 EQU   AMDPIORS
@RT00337 EQU   AMDPEOCL
@RT00340 EQU   AMDPSIOC
@RT00342 EQU   AMDPSIOC
@RT00347 EQU   AMDELIM1
@RT00349 EQU   AMDVLN1
@RT00352 EQU   AMDPEND
@RT00354 EQU   AMDVMSG
@RT00358 EQU   AMDPSIOE
@RT00364 EQU   AMDUMSG
@RT00366 EQU   AMDPIO1
@RT00374 EQU   AMDPIO4
@RT00379 EQU   AMDPARN
@RT00383 EQU   AMDPIO3
@RT00387 EQU   AMDPSIOE
@RT00391 EQU   AMDPEOCL
@RT00399 EQU   AMDPSVC3
@RT00401 EQU   AMDPSVC3
@RT00406 EQU   AMDVLN1
@RT00408 EQU   AMDELIM1
@RT00411 EQU   AMDVMSG
@RT00416 EQU   AMDVMSG
@RT00426 EQU   AMDPEOCL
@RT00434 EQU   AMDPPGM3
@RT00436 EQU   AMDPPGM3
@RT00441 EQU   AMDVLN1
@RT00443 EQU   AMDELIM1
@RT00446 EQU   AMDVMSG
@RT00465 EQU   AMDVMSG
@PB00003 EQU   @EL00001
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   AMDPRSN2,(C'PL/S-II',0502,73240)

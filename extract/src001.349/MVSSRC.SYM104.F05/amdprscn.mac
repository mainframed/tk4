         TITLE 'AMDPRSCN-EDIT CONTROL STATEMENT SCAN                   *
                        '
AMDPRSCN CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'AMDPRSCN  77.255'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         LA    @08,@DATA                                           0001
         USING @DATA,@08                                           0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
              EQUATES                   AMDPRDMP EQU MACRO
              COMMON                    EXPANDS TO AMDPRCOM TABLE
AMDPRSCN      CSECT                     RE-ESTABLISH SCAN CSECT
              USING COMMON,COMBASE      SET UP DSECT FOR AMDPRCOM
*   TTABPTR=ADDR(TEMPTAB);          /* INITIALIZE TTAB POINTER       */
         LA    TTABPTR,TEMPTAB                                     0061
*   IF SCANBIT='1'B THEN            /* Q/FIRST TIME IN SCAN          */
         TM    SCANBIT,B'00100000'                                 0062
         BO    @RT00062                                            0062
*     GOTO AMDPSCN1;                /* NO                            */
*   CALL AMDPROOT;                  /* INITIALIZE AMDPRTAB           */
         L     @15,AROOT                                           0064
         BALR  @14,@15                                             0064
*   AEDITCBR=AEDITCB;               /* ESTABLISH BASE FOR PRTAB      */
         L     AEDITCBR,AEDITCB                                    0065
*   SCN='1'B;                       /* SET ON SCAN BIT IN AMDPRTAB   */
*                                                                  0066
         OI    SCN(AEDITCBR),B'01000000'                           0066
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE VALUES IN AMDSCNTB                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0067
*   EXITNAME=' ';                   /* BLANK USER EXIT NAME          */
         MVI   EXITNAME+1,C' '                                     0067
         MVC   EXITNAME+2(6),EXITNAME+1                            0067
         MVI   EXITNAME,C' '                                       0067
*   DDNM=' ';                       /* BLANK DDNAME SLOT             */
         MVI   DDNM+1,C' '                                         0068
         MVC   DDNM+2(6),DDNM+1                                    0068
         MVI   DDNM,C' '                                           0068
*   STARTSL=' ';                    /* BLANK START TIME SLOT         */
         MVI   STARTSL+1,C' '                                      0069
         MVC   STARTSL+2(10),STARTSL+1                             0069
         MVI   STARTSL,C' '                                        0069
*   STOPSL=' ';                     /* BLANK STOP TIME SLOT          */
         MVI   STOPSL+1,C' '                                       0070
         MVC   STOPSL+2(10),STOPSL+1                               0070
         MVI   STOPSL,C' '                                         0070
*   OVERLTAB=' ';                   /* BLANK EID OVERLAY TABLE       */
         MVI   OVERLTAB+1,C' '                                     0071
         MVC   OVERLTAB+2(38),OVERLTAB+1                           0071
         MVI   OVERLTAB,C' '                                       0071
*   SIOTFLGS='0'B;                  /* ZERO SIO BITS                 */
         MVI   SIOTFLGS,B'00000000'                                0072
*   IOTFLGS='0'B;                   /* ZERO IO BITS                  */
         MVI   IOTFLGS,B'00000000'                                 0073
*   USRTFLGS='0'B;                  /* ZERO USR FLAGS                */
         MVI   USRTFLGS,B'00000000'                                0074
*   SVCTFLGS='0'B;                  /* ZERO SVC BITS                 */
         MVI   SVCTFLGS,B'00000000'                                0075
*   PITFLGS='0'B;                   /* ZERO PI BITS                  */
         MVI   PITFLGS,B'00000000'                                 0076
*   SYSTFLGS='0'B;                  /* ZERO SYS TEMP FLGS            */
         MVI   SYSTFLGS,B'00000000'                                0077
*   USRCOUNT=0;                     /* ZERO EID COUNT                */
         SLR   @10,@10                                             0078
         ST    @10,USRCOUNT                                        0078
*   USRCRCNT=0;                     /* ZERO CURRENT EID COUNT        */
         ST    @10,USRCRCNT                                        0079
*   SVCSTR='0'B;                    /* TURN OFF SVC BITS             */
         XC    SVCSTR+1(31),SVCSTR+1                               0080
         MVI   SVCSTR,B'00000000'                                  0080
*   PISTR='0'B;                     /* TURN OFF PI CODE BITS         */
         MVI   PISTR+1,X'00'                                       0081
         MVI   PISTR,B'00000000'                                   0081
*   PISTRB='0'B;                    /* TURN OFF PI 17, 19 BITS       */
         MVI   PISTRB,B'00000000'                                  0082
*   SCNBITS='0'B;                   /* TURN OFF SCAN BITS            */
         MVI   SCNBITS,B'00000000'                                 0083
*   CODETABL='0'B;                  /* TURN OFF KW BITS              */
         XC    CODETABL+1(2),CODETABL+1                            0084
         MVI   CODETABL,B'00000000'                                0084
*   WORD=0;                         /* ZERO WORD WORK AREA           */
         ST    @10,WORD                                            0085
*   INTSTART=' ';                   /* BLANK INT START SLOT          */
         MVI   INTSTART+1,C' '                                     0086
         MVC   INTSTART+2(3),INTSTART+1                            0086
         MVI   INTSTART,C' '                                       0086
*   INTSTOP=' ';                    /* BLANK INT STOP SLOT           */
         MVI   INTSTOP+1,C' '                                      0087
         MVC   INTSTOP+2(3),INTSTOP+1                              0087
         MVI   INTSTOP,C' '                                        0087
*   SIOPTR=ADDR(DVADS1);            /* INITIALIZE SIO DEV PTR        */
         LA    @10,DVADS1(,AEDITCBR)                               0088
         ST    @10,SIOPTR                                          0088
*   IOPTR=ADDR(DVADS2);             /* INITIALIZE IO DEV PTR         */
         LA    @02,DVADS2(,AEDITCBR)                               0089
         ST    @02,IOPTR                                           0089
*   JOBNPTR=ADDR(NAMES);            /* INITIALIZE JOBNAMES PTR       */
         LA    @15,NAMES(,AEDITCBR)                                0090
         ST    @15,JOBNPTR                                         0090
*   ASCBPTR=ADDR(ADS);              /* INITIALIZE ASCB         Y02014
*                                      PTR                     Y02014*/
         LA    @14,ADS(,AEDITCBR)                                  0091
         ST    @14,ASCBPTR                                         0091
*   SIOCRPTR=ADDR(DVADS1);          /* INITIALIZE NEW SIO DEV PTR    */
         ST    @10,SIOCRPTR                                        0092
*   IOCRPTR=ADDR(DVADS2);           /* INITIALIZE NEW IO DEV PTR     */
         ST    @02,IOCRPTR                                         0093
*   JOBCRPTR=ADDR(NAMES);           /* INITIALIZE NEW JOBN PTR       */
         ST    @15,JOBCRPTR                                        0094
*   ASCBCPTR=ADDR(ADS);             /* INITIALIZE NEW          Y02014
*                                      ASCB PTR                Y02014*/
         ST    @14,ASCBCPTR                                        0095
*   BUFADDR=ADDR(WTORMSG);          /* INITIALIZE BUFADDR            */
         LA    @10,WTORMSG                                         0096
         ST    @10,BUFADDR                                         0096
*   SCANBIT='1'B;                   /* SET ON NOT-FIRST TIME SW      */
         OI    SCANBIT,B'00100000'                                 0097
*   SCNPTR=VERBEND;                 /* FIRST COLUMN NUMBER           */
         L     @10,VERBEND                                         0098
         ST    @10,SCNPTR                                          0098
*   GOTO AMDPSTRT;                  /* BRANCH TO BEGIN SCAN          */
         B     AMDPSTRT                                            0099
*AMDPSCN1:                                                         0100
*   AEDITCBR=AEDITCB;               /* ESTABLISH BASE FOR PRTAB      */
AMDPSCN1 L     AEDITCBR,AEDITCB                                    0100
*   SCNPTR=ADDR(WTORMSG);           /* INITIALIZE BUFFER POINTER     */
         LA    @10,WTORMSG                                         0101
         ST    @10,SCNPTR                                          0101
*   GOTO AMDPSTT;                   /* OMIT COMMA CHK IF CONTNUTN    */
         B     AMDPSTT                                             0102
*AMDPSTRT:                                                         0103
*   IF SCNCHAR=',' THEN             /* IF DEFAULTS REQUESTED,        */
AMDPSTRT L     @10,SCNPTR                                          0103
         CLI   SCNCHAR(@10),C','                                   0103
         BE    @RT00103                                            0103
*     GOTO AMDSUMCL;                                               0104
*AMDPSTT:                                                          0105
*   IF SCNCHAR^=' ' THEN            /* IF NON-BLANK, HAVE HIT        */
AMDPSTT  L     @10,SCNPTR                                          0105
         CLI   SCNCHAR(@10),C' '                                   0105
         BNE   @RT00105                                            0105
*     GOTO AMDPSTR1;                /* MUST DELIMIT STMT             */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0107
         ST    @10,SCNPTR                                          0107
*   IF SCNPTR-BUFADDR               /* IF NOT AT END OF INPUT,       */
*       <72 THEN                    /* THEN                          */
         SL    @10,BUFADDR                                         0108
         C     @10,@CF00465                                        0108
         BL    @RT00108                                            0108
*     GOTO AMDPSTT;                 /* LOOK AT NEXT CHAR             */
*                                                                  0109
*   /*****************************************************************/
*   /*                                                               */
*   /* SINCE NO KEYWORDS ON STATEMENT, ASSUME DEFAULTS               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0110
*AMDSUMCL:                                                         0110
*   CALL AMDPSUM1;                  /* BEGIN SUMMARY MESSAGE         */
AMDSUMCL L     @15,@CV00417                                        0110
         BALR  @14,@15                                             0110
*AMDNRET:                                                          0111
*   RETURN;                         /* RETURN TO CALLER              */
@EL00001 L     @13,4(,@13)                                         0111
@EF00001 DS    0H                                                  0111
@ER00001 L     @14,12(,@13)                                        0111
         LM    @00,@12,20(@13)                                     0111
         BR    @14                                                 0111
*AMDPSTR1:                                                         0112
*   ADDRS1=SCNPTR;                  /* HAVE FOUND KEYWRD BEGNING     */
AMDPSTR1 L     @10,SCNPTR                                          0112
         ST    @10,ADDRS1                                          0112
*AMDPSTR2:                                                         0113
*   IF SCNCHAR=' ' THEN             /* IF BLANK FOUND, HAVE          */
AMDPSTR2 L     @10,SCNPTR                                          0113
         CLI   SCNCHAR(@10),C' '                                   0113
         BE    @RT00113                                            0113
*     GOTO AMDPSTR3;                /* DELIMITED STMT                */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0115
         ST    @10,SCNPTR                                          0115
*   IF SCNPTR-BUFADDR               /* IF NOT AT END OF INPUT,       */
*       <72 THEN                    /* THEN                          */
         SL    @10,BUFADDR                                         0116
         C     @10,@CF00465                                        0116
         BL    @RT00116                                            0116
*     GOTO AMDPSTR2;                /* LOOK AT NEXT CHAR             */
*AMDPSTR3:                                                         0118
*   EOCADDR=SCNPTR;                 /* SAVE PTR TO 1ST BLANK OR END
*                                      OF INPUT BUFFER-EOCADDR IS  0118
*                                      LOGICAL END OF BUFFER         */
AMDPSTR3 L     @10,SCNPTR                                          0118
         ST    @10,EOCADDR                                         0118
*   SCNPTR=SCNPTR-1;                /* POSITION BUFFER POINTER       */
         BCTR  @10,0                                               0119
         ST    @10,SCNPTR                                          0119
*   IF SCNCHAR=',' THEN             /* IF COMMA PRESENT, SET ON      */
         CLI   SCNCHAR(@10),C','                                   0120
         BNE   @RF00120                                            0120
*     GCONTSW='1'B;                 /* CONTINUATION REQUESTED SW     */
         OI    GCONTSW,B'00000100'                                 0121
*   SCNPTR=ADDRS1;                  /* RESET PTR TO KW BEGINNING     */
*                                                                  0122
@RF00120 L     @10,ADDRS1                                          0122
         ST    @10,SCNPTR                                          0122
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE BEGINS THE PROCESS OF ISOLATING A       */
*   /* KEYWORD AND ITS VALUES.                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0123
*AMDPRES:                                                          0123
*   CODETABL='0'B;                  /* RE-INITIALIZE CODE TABLE      */
AMDPRES  XC    CODETABL+1(2),CODETABL+1                            0123
         MVI   CODETABL,B'00000000'                                0123
*   LNGTH=0;                        /* KW/VALUE LENGTH=0             */
         SLR   @10,@10                                             0124
         ST    @10,LNGTH                                           0124
*   EQUIND='0'B;                    /* NO SIO=IO OR IO=SIO YET       */
         NI    EQUIND,B'11101111'                                  0125
*   COMP4=' ';                      /* BLANK COMPARE AREA            */
         MVI   COMP4+1,C' '                                        0126
         MVC   COMP4+2(2),COMP4+1                                  0126
         MVI   COMP4,C' '                                          0126
*   COMP8=' ';                      /* BLANK COMPARE AREA            */
         MVI   COMP8+1,C' '                                        0127
         MVC   COMP8+2(6),COMP8+1                                  0127
         MVI   COMP8,C' '                                          0127
*AMDPRES1:                                                         0128
*   IF SCNCHAR=' ' THEN             /* Q/DELIMITER                   */
AMDPRES1 L     @10,SCNPTR                                          0128
         CLI   SCNCHAR(@10),C' '                                   0128
         BE    @RT00128                                            0128
*     GOTO AMDPRES2;                /* YES--EXAMINE KEYWORD          */
*   IF SCNCHAR='=' THEN             /* Q/DELIMITER                   */
         CLI   SCNCHAR(@10),C'='                                   0130
         BE    @RT00130                                            0130
*     GOTO AMDPRES2;                /* YES--EXAMINE KEYWORD          */
*   IF SCNCHAR=',' THEN             /* Q/DELIMITER                   */
         CLI   SCNCHAR(@10),C','                                   0132
         BE    @RT00132                                            0132
*     GOTO AMDPRES2;                /* YES--EXAMINE KEYWORD          */
*   IF SCNPTR^=EOCADDR              /* Q/AT END OF STATEMENT         */
*     THEN                          /* NO                            */
         C     @10,EOCADDR                                         0134
         BE    @RF00134                                            0134
*     DO;                           /* LOOK AT NEXT CHAR             */
*       SCNPTR=SCNPTR+1;            /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0136
         ST    @10,SCNPTR                                          0136
*       GOTO AMDPRES1;              /* GO BACK TO SCAN AGAIN         */
         B     AMDPRES1                                            0137
*     END;                                                         0138
*AMDPRES2:                                                         0139
*   LNGTH=SCNPTR-ADDRS1;            /* CALCULATE KEYWORD LENGTH      */
@RF00134 DS    0H                                                  0139
AMDPRES2 L     @10,ADDRS1                                          0139
         L     @02,SCNPTR                                          0139
         SLR   @02,@10                                             0139
         ST    @02,LNGTH                                           0139
*   IF RUNEDIT='0'B THEN            /* NOT IN RETRY SITUATION        */
         TM    RUNEDIT,B'00001000'                                 0140
         BZ    @RT00140                                            0140
*     GOTO AMDPRES3;                                               0141
*   RUNEDIT='0'B;                   /* IN RETRY SITUATION--SET OFF 0142
*                                      RETRY SWITCH                  */
         NI    RUNEDIT,B'11110111'                                 0142
*   IF LNGTH^=7 THEN                /* USER HAS NOT SPECIFIED        */
         C     @02,@CF00055                                        0143
         BNE   @RT00143                                            0143
*     GOTO AMDPRES3;                /* 'RUNEDIT'                     */
*   IF KEYWORD(1:7)                 /* USER WISHES TO RUN EDIT       */
*       =CHARRUN THEN               /* WITH OPTIONS THUS FAR         */
         CLC   KEYWORD(7,@10),CHARRUN                              0145
         BNE   @RF00145                                            0145
*     DO;                           /* SPECIFIED -- THEN             */
*       CALL AMDPFIN;               /* PREPARE FOR SCAN TERM         */
         L     @15,@CV00418                                        0147
         BALR  @14,@15                                             0147
*       GOTO AMDNRET;               /* RETURN TO CALLER              */
         B     AMDNRET                                             0148
*     END;                                                         0149
*AMDPRES3:                                                         0150
*   IF SCNCHAR='=' THEN             /* CHECK FOR VALID KEYWORD       */
@RF00145 DS    0H                                                  0150
AMDPRES3 L     @10,SCNPTR                                          0150
         CLI   SCNCHAR(@10),C'='                                   0150
         BE    @RT00150                                            0150
*     GOTO AMDPRES4;                /* FOLLOWED BY EQUAL SIGN        */
*   IF LNGTH>4 THEN                 /* NO EQUAL SIGN SO        Y02014
*                                      CANNOT BE               Y02014*/
         L     @10,LNGTH                                           0152
         C     @10,@CF00098                                        0152
         BH    @RT00152                                            0152
*     GOTO AMDPBDKW;                /* GTR THAN 4 CHARS        Y02014
*                                      IN LENGTH               Y02014*/
*   IF LNGTH<1 THEN                 /* IF LENGTH IS < 1, IGNORE      */
         LA    @02,1                                               0154
         CR    @10,@02                                             0154
         BL    @RT00154                                            0154
*     GOTO AMDPCLS1;                /* EXTRA DELIMITER               */
*   COMP4(1:LNGTH)=KEYWORD          /* MOVE INTO COMPARE AREA        */
*       (1:LNGTH);                                                 0156
*                                                                  0156
         BCTR  @10,0                                               0156
         L     @15,ADDRS1                                          0156
         EX    @10,@SM00659                                        0156
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH KWTAB1 TO FIND KEYWORD MATCH                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0157
*   DO I=1 TO 11;                   /* ELEVEN KEYWORDS IN      Y02014
*                                      TABLE                   Y02014*/
         ST    @02,I                                               0157
@DL00157 DS    0H                                                  0158
*     IF COMP4=KWTAB1(I) THEN       /* IF MATCH FOUND, PROCEED TO    */
         LR    @10,@02                                             0158
         SLA   @10,2                                               0158
         LA    @15,KWTAB1-4(@10)                                   0158
         CLC   COMP4(4),0(@15)                                     0158
         BE    @RT00158                                            0158
*       GOTO AMDPKW1;               /* BRANCH TO KW ROUTINE          */
*   END;                            /* NO MATCH YET                  */
         AL    @02,@CF00044                                        0160
         ST    @02,I                                               0160
         C     @02,@CF00273                                        0160
         BNH   @DL00157                                            0160
*   GOTO AMDPBDKW;                  /* NO MATCH IN TABLE--BAD KW     */
         B     AMDPBDKW                                            0161
*AMDPKW1:                                                          0162
*   NOVAL='1'B;                     /* TO SIGNIFY TO KEYWORD RTN THAT
*                                      NO VALUES FOLLOW-- THUS, 'ALL'
*                                      IS INDICATED                  */
AMDPKW1  OI    NOVAL,B'00100000'                                   0162
*   IF I=1 THEN                     /* IF PROCESSING SIO,            */
         CLC   I(4),@CF00044                                       0163
         BNE   @RF00163                                            0163
*     X1(1)=X1(1)                   /* TURN ON SIO BIT               */
*         ×MASKS(8);                                               0164
         OC    X1(1),MASKS+7                                       0164
*   ELSE                                                           0165
*     DO;                           /*                         Y02014*/
         B     @RC00163                                            0165
@RF00163 DS    0H                                                  0166
*       IF I=11×I=10 THEN           /* SET APPROPRIATE BIT     Y02014*/
         L     @10,I                                               0166
         C     @10,@CF00273                                        0166
         BE    @RT00166                                            0166
         C     @10,@CF00488                                        0166
         BNE   @RF00166                                            0166
@RT00166 DS    0H                                                  0167
*         X1(3)=X1(3)×MASKS(I-9);   /*                         Y02014*/
         L     @10,I                                               0167
         LA    @02,MASKS-10(@10)                                   0167
         OC    X1+2(1),0(@02)                                      0167
*       ELSE                                                       0168
*         X1(2)=X1(2)×MASKS(I-1);   /*                         Y02014*/
         B     @RC00166                                            0168
@RF00166 L     @10,I                                               0168
         LA    @02,MASKS-2(@10)                                    0168
         OC    X1+1(1),0(@02)                                      0168
*     END;                          /*                         Y02014*/
@RC00166 DS    0H                                                  0170
*   SVKEY=I;                        /* KEEP TRACK OF INDEX           */
@RC00163 L     @10,I                                               0170
         ST    @10,SVKEY                                           0170
*   KWADDR=BRTAB(I+7);              /* CALC KW RTN ADDRS       Y02014*/
         SLA   @10,2                                               0171
         L     KWADDR,BRTAB+24(@10)                                0171
*   CALL KWRTN;                     /* CALL APPROP KW RTN            */
*                                                                  0172
         LR    @15,KWADDR                                          0172
         BALR  @14,@15                                             0172
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE INTERROGATES THE CODE RETURNED BY AMDPRSN2 IN */
*   /* ORDER TO DETERMINE THE ACTION NEXT TO BE PERFORMED BY MAINLINE*/
*   /* SCAN (AMDPRSCN).                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0173
*AMDCDCK:                                                          0173
*   GENERATE;                                                      0173
AMDCDCK  DS    0H                                                  0173
*                                       /* USE A BRANCH TABLE        */
         B     AMDRTN(REG15)            BRNCH TO APPROP ROUTINE
AMDRTN   B     AMDPEOC                  SET FLUSH MODE BIT
         B     AMDPEOC1                 DETERMINE IF AT END OF STMT
         B     AMDPRS51                 CHK FOR MATCHED PARENS
         B     AMDPMTD                  ISSUE UNMATCHED PARENS MSG
         B     AMDPCK1                  CHECK FOR NEXT KEYWORD
*AMDPBDKW:                                                         0174
*   SYNMSGA=ADDR(AD1);              /* INSERT ADDRS OF ADDRS OF INV
*                                      KEYWORD MSG INTO SYNMSGA      */
AMDPBDKW L     @10,@CA00352                                        0174
         ST    @10,SYNMSGA                                         0174
*   ERRBUF(45:47)=KEYWORD(1:3);     /* MOVE IN 1ST 3 CHARS OF MSG    */
         L     @10,MSGADDR(,@10)                                   0175
         L     @02,ADDRS1                                          0175
         MVC   ERRBUF+44(3,@10),KEYWORD(@02)                       0175
*   GNOSTDMG='1'B;                  /* OMIT ISSUANCE OF AMD165I      */
         OI    GNOSTDMG,B'00010000'                                0176
*   CALL AMDPRSYN;                  /* HAVE MESSAGE WRITTEN          */
*                                                                  0177
         L     @15,ASYNTAX                                         0177
         BALR  @14,@15                                             0177
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE FLUSH MODE SWITCH                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0178
*AMDPEOC:                                                          0178
*   FLMODE='1'B;                    /* SET ON FLUSH MODE BIT-- DONE
*                                      ONLY IF ERROR OCCURRD         */
*                                                                  0178
AMDPEOC  OI    FLMODE(AEDITCBR),B'10000000'                        0178
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF AT LOGICAL END OF STATEMENT                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0179
*AMDPEOC1:                                                         0179
*   IF SCNPTR=EOCADDR               /* IF AT LOGICAL END-OF-STMT     */
*     THEN                          /* READY FOR END-OF-STMT         */
AMDPEOC1 CLC   SCNPTR(4),EOCADDR                                   0179
         BNE   @RF00179                                            0179
*     DO;                           /* PROCEDURES                    */
*       CALL AMDPEOC2;              /* EXECUTE PART OF AMDPRSN3      */
         L     @15,@CV00419                                        0181
         BALR  @14,@15                                             0181
*       GOTO AMDNRET;               /* RETURN TO AMDPRCTL            */
         B     AMDNRET                                             0182
*     END;                                                         0183
*   GOTO AMDPCK1;                   /* MOVE PAST CURRENT KEYWORD TO
*                                      NEXT KEYWORD                  */
         B     AMDPCK1                                             0184
*AMDPRES4:                                                         0185
*   IF LNGTH>7 THEN                 /* KEYWORD IS TOO LONG           */
AMDPRES4 L     @10,LNGTH                                           0185
         C     @10,@CF00055                                        0185
         BH    @RT00185                                            0185
*     GOTO AMDPBDKW;                                               0186
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         LA    @02,1                                               0187
         L     @00,SCNPTR                                          0187
         ALR   @00,@02                                             0187
         ST    @00,SCNPTR                                          0187
*   IF SCNPTR=EOCADDR               /* IF ALREADY AT END OF CARD,    */
*     THEN                          /* CAN HAVE NO VALUE AFTER       */
         C     @00,EOCADDR                                         0188
         BE    @RT00188                                            0188
*     GOTO AMDPEC1L;                /* THE EQUAL SIGN--IGNORE KW     */
*   IF SCNCHAR='(' THEN             /* CHECK FOR VALID PARENS        */
         LR    @15,@00                                             0190
         CLI   SCNCHAR(@15),C'('                                   0190
         BE    @RT00190                                            0190
*     GOTO AMDPRS51;                /* IF LEFT PAREN PRESENT         */
*   IF SCNCHAR=',' THEN                                            0192
         LR    @15,@00                                             0192
         CLI   SCNCHAR(@15),C','                                   0192
         BNE   @RF00192                                            0192
*     DO;                           /* FOLLOWED BY COMMA       Y02014*/
*       KWDCOMP='';                 /* BLANK COMPARE AREA      Y02014*/
         MVI   KWDCOMP,C' '                                        0194
         MVC   KWDCOMP+1(7),KWDCOMP                                0194
*       KWDCOMP(1:LNGTH)=KEYWORD(1:LNGTH);/* KEYWD             Y02014*/
         BCTR  @10,0                                               0195
         L     @15,ADDRS1                                          0195
         EX    @10,@SM00663                                        0195
*       DO I=1 TO 11;               /* LOOP THRU KWDTAB2       Y02014*/
         ST    @02,I                                               0196
@DL00196 DS    0H                                                  0197
*         IF KWDCOMP(1:8)=KWTAB2(I,1:8) THEN/* MATCH           Y02014*/
         LR    @10,@02                                             0197
         SLA   @10,3                                               0197
         LA    @15,KWTAB2-8(@10)                                   0197
         CLC   KWDCOMP(8),0(@15)                                   0197
         BE    @RT00197                                            0197
*           GO TO CONT;             /* MATCH FOUND             Y02014*/
*       END;                                                       0199
         AL    @02,@CF00044                                        0199
         ST    @02,I                                               0199
         C     @02,@CF00273                                        0199
         BNH   @DL00196                                            0199
*       GO TO AMDPBDKW;             /* BAD KWD MSG NEEDED      Y02014*/
         B     AMDPBDKW                                            0200
*     END;                                                         0201
*CONT:                                                             0202
*   ADDRS3=SCNPTR;                  /* SAVE ADDRS OF 1ST CHAR IN   0202
*                                      KEYWORD VALUE                 */
@RF00192 DS    0H                                                  0202
CONT     L     @10,SCNPTR                                          0202
         ST    @10,ADDRS3                                          0202
*   GOTO AMDPCHK;                   /* EXAMINE 1ST CHAR              */
*                                                                  0203
         B     AMDPCHK                                             0203
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SUBROUTINE DETERMINES IF PARENTHESES ARE        */
*   /* MATCHED. IF NOT, A DIAGNOSTIC IS ISSUED IN SUBROUTINE AMDPMTD.*/
*   /* IF MATCHING PARENS ARE FOUND, POINTERS ARE RESET TO WHAT THEY */
*   /* WERE AT ENTRY, AND PROCESSING CONTINUES.                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0204
*AMDPRS51:                                                         0204
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
AMDPRS51 LA    @10,1                                               0204
         AL    @10,SCNPTR                                          0204
         ST    @10,SCNPTR                                          0204
*   ADDRS3=SCNPTR;                  /* SAVE ADDRS OF 1ST CHAR IN   0205
*                                      KEYWORD VALUE - CHARACTER   0205
*                                      FOLLOWS LEFT PAREN            */
         ST    @10,ADDRS3                                          0205
*AMDPMTC:                                                          0206
*   IF SCNCHAR='(' THEN             /* IF LEFT PAREN, HAVE           */
AMDPMTC  L     @10,SCNPTR                                          0206
         CLI   SCNCHAR(@10),C'('                                   0206
         BE    @RT00206                                            0206
*     GOTO AMDPMTD;                 /* UNMATCHED PARENTHESES         */
*   IF SCNCHAR=')' THEN             /* IF RIGHT PAREN, HAVE          */
         CLI   SCNCHAR(@10),C')'                                   0208
         BE    @RT00208                                            0208
*     GOTO AMDPMTC2;                /* MATCHED PARENTHESES           */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0210
         ST    @10,SCNPTR                                          0210
*   IF SCNPTR=EOCADDR               /* IF AT END OF CARD, DO NOT     */
*     THEN                          /* HAVE MATCHED PARENS--NEED     */
         C     @10,EOCADDR                                         0211
         BE    @RT00211                                            0211
*     GOTO AMDPMTD;                 /* ERROR MSG OUTPUTTED           */
*   GOTO AMDPMTC;                   /* SCAN AGAIN FOR ( OR )         */
*                                                                  0213
         B     AMDPMTC                                             0213
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SMALL SUBROUTINE ISSUES A DIAGNOSTIC IDENTIFYING AN      */
*   /* INVALID PARENTHESES SITUATION.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0214
*AMDPMTD:                                                          0214
*   SYNMSGA=ADDR(AD2);              /* INSERT ADDRS OF ADDRS OF PAREN
*                                      MSG INTO SYNMSGA              */
AMDPMTD  L     @10,@CA00352                                        0214
         LA    @10,AD2-AMDPRS00(,@10)                              0214
         ST    @10,SYNMSGA                                         0214
*   GNOSTDMG='1'B;                  /* OMIT ISSUANCE OF AMD165I      */
         OI    GNOSTDMG,B'00010000'                                0215
*   CALL AMDPRSYN;                  /* HAVE MESSAGE WRITTEN          */
         L     @15,ASYNTAX                                         0216
         BALR  @14,@15                                             0216
*   IF PAREN='1'B THEN              /* IF SITUATION IS THAT SINGLE 0217
*                                      VALUE IN PARENS THEN          */
         TM    PAREN,B'00010000'                                   0217
         BO    @RT00217                                            0217
*     GOTO AMDPEOC;                 /* CAN GO ON IN THIS STATEMNT    */
*   FLMODE='1'B;                    /* MUST SET FLUSH BIT AND IGNORE
*                                      REST OF STMT                  */
         OI    FLMODE(AEDITCBR),B'10000000'                        0219
*AMDPEC1L:                                                         0220
*   CALL AMDPEOC2;                  /* TO RESET VALUES BEFORE        */
AMDPEC1L L     @15,@CV00419                                        0220
         BALR  @14,@15                                             0220
*   GOTO AMDNRET;                   /* CURRENT LINE INPUTTED         */
         B     AMDNRET                                             0221
*AMDPMTC2:                                                         0222
*   PAREN='1'B;                     /* MATCHED PARENS--SET     SWITCH*/
AMDPMTC2 OI    PAREN,B'00010000'                                   0222
*   REM=SCNPTR-ADDRS3;              /* NUM OF CHARS BEFORE )         */
         L     @10,SCNPTR                                          0223
         LR    REM,@10                                             0223
         SL    REM,ADDRS3                                          0223
*   SCNPTR=SCNPTR-REM;              /* RESET BUFFER POINTER          */
         SLR   @10,REM                                             0224
         ST    @10,SCNPTR                                          0224
*   IF IORTNSW='1'B THEN            /* HAVE COME FROM SIO/IO RTN     */
         TM    IORTNSW,B'10000000'                                 0225
         BNO   @RF00225                                            0225
*     DO;                           /* DO THE FOLLOWING              */
*       CALL AMDPSIO;               /* CALL IO/SIO KEYWORD RTN       */
         L     @15,@CV00388                                        0227
         BALR  @14,@15                                             0227
*       GOTO AMDCDCK;               /* CHECK RETURN CODE             */
         B     AMDCDCK                                             0228
*     END;                                                         0229
*AMDPCHK:                                                          0230
*   IF SCNCHAR=',' THEN             /* MAY BE FINISHED WITH KW       */
@RF00225 DS    0H                                                  0230
AMDPCHK  L     @10,SCNPTR                                          0230
         CLI   SCNCHAR(@10),C','                                   0230
         BNE   @RF00230                                            0230
*     DO;                           /* DO THE FOLLOWING              */
*AMDPCHK1:                                                         0232
*       IF PAREN='1'B THEN          /* MUST FIND RIGHT PAREN IF      */
AMDPCHK1 TM    PAREN,B'00010000'                                   0232
         BO    @RT00232                                            0232
*         GOTO AMDPCHK6;            /* IN MATCHED PAREN SITUATION    */
*       GOTO AMDPCLS1;              /* WILL SEARCH FOR NXT KW        */
         B     AMDPCLS1                                            0234
*     END;                                                         0235
*AMDPCHK2:                                                         0236
*   IF KEYWORD(1)='J' THEN          /* LENGTH DETERMINED BY KW       */
@RF00230 DS    0H                                                  0236
AMDPCHK2 L     @10,ADDRS1                                          0236
         CLI   KEYWORD(@10),C'J'                                   0236
         BE    @RT00236                                            0236
*     GOTO AMDPLN;                  /* CHECK FOR VALID KEYWORD       */
*   IF KEYWORD(1)='D' THEN          /* LENGTH DETERMINED BY KW       */
         CLI   KEYWORD(@10),C'D'                                   0238
         BE    @RT00238                                            0238
*     GOTO AMDPLN;                  /* CHECK FOR VALID KEYWORD       */
*   GOTO AMDPLN1;                   /* LENGTH WILL EQUAL 8           */
*                                                                  0240
         B     AMDPLN1                                             0240
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE POSITIONS THE BUFFER POINTER TO THE DELIMITER */
*   /* PRECEDING THE NEXT KEYWORD, IF ONE EXISTS. OTHERWISE,         */
*   /* END-0F-STATEMENT PROCEDURES ARE INVOKED IN MODULE AMDPRSN3.   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0241
*AMDPCK1:                                                          0241
*   IF PAREN='1'B THEN              /* IF MATCHED PARENS, MUST       */
AMDPCK1  TM    PAREN,B'00010000'                                   0241
         BO    @RT00241                                            0241
*     GOTO AMDPCHK6;                /* FIND )                        */
*AMDPCHK5:                                                         0243
*   IF SCNCHAR=',' THEN             /* HAVE FOUND DELIMITER--NXT     */
AMDPCHK5 L     @10,SCNPTR                                          0243
         CLI   SCNCHAR(@10),C','                                   0243
         BE    @RT00243                                            0243
*     GOTO AMDPCLS1;                /* LOOK AT NXT KEYWORD           */
*   IF SCNPTR=EOCADDR               /* IF AT LOGICAL END-OF-STMT,    */
*     THEN                          /* READY FOR END-OF-STMT         */
         C     @10,EOCADDR                                         0245
         BE    @RT00245                                            0245
*     GOTO AMDPEC1L;                /* PROCEDURES                    */
*   IF SCNCHAR=' ' THEN             /* HAVE FOUND DELIMITER--NXT     */
         CLI   SCNCHAR(@10),C' '                                   0247
         BE    @RT00247                                            0247
*     GOTO AMDPCLS1;                /* LOOK AT NXT KEYWORD           */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0249
         ST    @10,SCNPTR                                          0249
*   GOTO AMDPCHK5;                  /* CONTINUE SCAN FOR DELIM.      */
         B     AMDPCHK5                                            0250
*AMDPCHK6:                                                         0251
*   IF SCNCHAR=')' THEN             /* HAVE FOUND PRELIM. DELIM.     */
AMDPCHK6 L     @10,SCNPTR                                          0251
         CLI   SCNCHAR(@10),C')'                                   0251
         BE    @RT00251                                            0251
*     GOTO AMDPCHK5;                /* SCAN NOW FOR COMMA OR BLNK    */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0253
         ST    @10,SCNPTR                                          0253
*   GOTO AMDPCHK6;                  /* KEEP SCANNING FOR RIGHT )     */
*                                                                  0254
         B     AMDPCHK6                                            0254
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE POSITIONS THE BUFFER POINTER TO THE NEXT      */
*   /* KEYWORD, IF ONE EXISTS. IF NOT, END-OF- STATEMENT PROCEDURES  */
*   /* ARE INVOKED IN MODULE AMDPRSN3.                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0255
*AMDPCLS1:                                                         0255
*   SCNPTR=SCNPTR+1;                /* MOVE TO 1ST CHAR OF NXT KW    */
AMDPCLS1 LA    @10,1                                               0255
         AL    @10,SCNPTR                                          0255
         ST    @10,SCNPTR                                          0255
*   IF SCNPTR=EOCADDR               /* IF AT LOGICAL END-OF-STMT     */
*     THEN                          /* READY FOR END-OF-STMT         */
         C     @10,EOCADDR                                         0256
         BE    @RT00256                                            0256
*     GOTO AMDPEC1L;                /* PROCEDURES                    */
*   ADDRS1=SCNPTR;                  /* SAVE LOCATION OF 1ST CHAR IN
*                                      NEXT KEYWORD                  */
         ST    @10,ADDRS1                                          0258
*   GOTO AMDPRES;                   /* BEGIN KEYWORD SCAN AGAIN      */
         B     AMDPRES                                             0259
*AMDPLN:                                                           0260
*   COMPLEN=LNGTH;                  /* KEYWORD VALIDITY CHECK BASED
*                                      ON LENGTH OF KEYWORD IF BEGINS
*                                      WITH J OR D                   */
AMDPLN   L     COMPLEN,LNGTH                                       0260
*   GOTO AMDPLN2;                   /* BRANCH AROUND NEXT STMT       */
         B     AMDPLN2                                             0261
*AMDPLN1:                                                          0262
*   COMPLEN=8;                      /* IN USUAL CASE, COMPARE LENGTH
*                                      EQUAL TO 8                    */
AMDPLN1  LA    COMPLEN,8                                           0262
*AMDPLN2:                                                          0263
*   COMP8(1:LNGTH)=KEYWORD          /* MOVE IW INTO COMPARE AREA     */
*       (1:LNGTH);                                                 0263
*                                                                  0263
AMDPLN2  L     @10,LNGTH                                           0263
         BCTR  @10,0                                               0263
         L     @05,ADDRS1                                          0263
         EX    @10,@SM00665                                        0263
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH KWTAB2 TO FIND KEYWORD MATCH                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0264
*   DO I=1 TO 11;                                                  0264
         LA    @10,1                                               0264
         ST    @10,I                                               0264
@DL00264 DS    0H                                                  0265
*     IF COMP8(1:COMPLEN)           /* IF MATCH FOUND,               */
*         =KWTAB2(I,1:COMPLEN)      /* THEN                          */
*       THEN                        /* PROCEED TO                    */
         LR    @05,@10                                             0265
         SLA   @05,3                                               0265
         LR    @02,COMPLEN                                         0265
         BCTR  @02,0                                               0265
         LA    @15,KWTAB2-8(@05)                                   0265
         EX    @02,@SC00667                                        0265
         BE    @RT00265                                            0265
*       GOTO AMDPKW2;               /* BRANCH TO KW ROUTINE          */
*   END;                            /* NO MATCH YET                  */
         AL    @10,@CF00044                                        0267
         ST    @10,I                                               0267
         C     @10,@CF00273                                        0267
         BNH   @DL00264                                            0267
*   GOTO AMDPBDKW;                  /* NO MATCH/OUTPUT ERROR MSG     */
         B     AMDPBDKW                                            0268
*AMDPKW2:                                                          0269
*   WORD=I/8;                       /* CALCULATE APPROP BYTE         */
AMDPKW2  L     @10,I                                               0269
         LA    @02,8                                               0269
         LR    @04,@10                                             0269
         SRDA  @04,32                                              0269
         DR    @04,@02                                             0269
         ST    @05,WORD                                            0269
*   J=I//8;                         /* CALCULATE BIT IN BYTE         */
         LR    @04,@10                                             0270
         SRDA  @04,32                                              0270
         D     @04,@CF00033                                        0270
         ST    @04,J                                               0270
*   IF J=0 THEN                     /* IF NO REMAINDER,              */
         LTR   @04,@04                                             0271
         BNZ   @RF00271                                            0271
*     J=8;                          /* WILL USE LAST BIT             */
         ST    @02,J                                               0272
*   ELSE                            /* IF REMAINDER, ARE INTO        */
*     WORD=WORD+1;                  /* NEXT BYTE                     */
         B     @RC00271                                            0273
@RF00271 LA    @10,1                                               0273
         AL    @10,WORD                                            0273
         ST    @10,WORD                                            0273
*   X1(WORD)=X1(WORD)×MASKS(J);     /* TURN ON APPROP BIT            */
@RC00271 L     @10,WORD                                            0274
         LA    @02,X1-1(@10)                                       0274
         L     @10,J                                               0274
         LA    @15,MASKS-1(@10)                                    0274
         OC    0(1,@02),0(@15)                                     0274
*   SVKEY=(I+11);                   /* INDEX INCREASED BY NUM      0275
*                                      KEYWORDS IN KWTAB1            */
         L     @10,I                                               0275
         LA    @02,11                                              0275
         ALR   @02,@10                                             0275
         ST    @02,SVKEY                                           0275
*   IF I=3                          /* IF PROCESSING START           */
*       ×I=4 THEN                   /* OR STOP KW, THEN              */
         C     @10,@CF00168                                        0276
         BE    @RT00276                                            0276
         C     @10,@CF00098                                        0276
         BE    @RT00276                                            0276
*     GOTO AMDPPOS;                 /* GO TO THAT KW RTN             */
*   IF I=7 THEN                     /* IF PROCESSING USR,            */
         C     @10,@CF00055                                        0278
         BE    @RT00278                                            0278
*     GOTO AMDPUSR;                 /* GO TO THAT KW RTN             */
*   KWADDR=BRTAB(I);                /* CALC KW RTN ADDRS             */
         SLA   @10,2                                               0280
         L     KWADDR,BRTAB-4(@10)                                 0280
*   CALL KWRTN;                     /* CALL APPROP KW RTN            */
         LR    @15,KWADDR                                          0281
         BALR  @14,@15                                             0281
*   GOTO AMDCDCK;                   /* CHECK RETURN CODE             */
*                                                                  0282
         B     AMDCDCK                                             0282
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE PROCESSES THE START AND STOP KEYWORDS.        */
*   /* ACCEPTABLE VALUES ARE DDD/ DDD,HH/ DDD,HH.MM/ AND             */
*   /* DDD,HH.MM.SS.                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0283
*AMDPPOS:                                                          0283
*   IF CSTART='1'B THEN             /* IF PROCESSING 'START',        */
AMDPPOS  TM    CSTART,B'00100000'                                  0283
         BO    @RT00283                                            0283
*     GOTO AMDPPOS1;                /* CHECK APPROPRIATE SLOTS       */
*   IF STOPTIME^=BLANK1             /* IF AMDPRTAB STOP VALUE        */
*       ×STOPSL^=BLANK1 THEN        /* OR TEMPTAB STOP VALUE IS    0285
*                                      NON-BLANK, DO WHAT FOLLOWS    */
         CLC   STOPTIME(12,AEDITCBR),BLANK1                        0285
         BNE   @RT00285                                            0285
         CLC   STOPSL(12),BLANK1                                   0285
         BNE   @RT00285                                            0285
*AMDC1CAL:                                                         0286
*     GOTO AMDPEOC1;                /* IGNORE THE CURRENT VAL AND  0286
*                                      SCAN FOR NEXT KW              */
*   ALLPTR=ADDR(INTSTOP);           /* PROCESSING STOP VALUE         */
         LA    @10,INTSTOP                                         0287
         ST    @10,ALLPTR                                          0287
*   GOTO AMDPPOS2;                  /* BEGIN VALUE SCAN              */
         B     AMDPPOS2                                            0288
*AMDPPOS1:                                                         0289
*   IF STARTIME^=BLANK1             /* IF AMDPRTAB START VALUE       */
*       ×STARTSL^=BLANK1 THEN       /* OR TEMPTAB START VALUE IS     */
AMDPPOS1 CLC   STARTIME(12,AEDITCBR),BLANK1                        0289
         BNE   @RT00289                                            0289
         CLC   STARTSL(12),BLANK1                                  0289
         BNE   @RT00289                                            0289
*     GOTO AMDPEOC1;                /* NON-BLANK, IGNORE CURRENT   0290
*                                      VALUE                         */
*   ALLPTR=ADDR(INTSTART);          /* PROCESSING START VALUE        */
         LA    @10,INTSTART                                        0291
         ST    @10,ALLPTR                                          0291
*AMDPPOS2:                                                         0292
*   IF SCNCHAR=','                  /* BEGIN VALUE SCAN              */
*       ×SCNCHAR=' '                /* IF DELIMITER OF COMMA,        */
*       ×SCNCHAR=')' THEN           /* BLANK OR RIGHT PAREN FOUND    */
AMDPPOS2 L     @10,SCNPTR                                          0292
         CLI   SCNCHAR(@10),C','                                   0292
         BE    @RT00292                                            0292
         CLI   SCNCHAR(@10),C' '                                   0292
         BE    @RT00292                                            0292
         CLI   SCNCHAR(@10),C')'                                   0292
         BE    @RT00292                                            0292
*     GOTO AMDPPOS3;                /* CALCULATE VALUE LENGTH        */
*   IF SCNPTR=EOCADDR               /* IF AT LOGICAL END-OF-STMT,    */
*     THEN                          /* THEN                          */
         C     @10,EOCADDR                                         0294
         BE    @RT00294                                            0294
*     GOTO AMDPPOS3;                /* CALCULATE VALUE LENGTH        */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0296
         ST    @10,SCNPTR                                          0296
*   GOTO AMDPPOS2;                  /* CONTINUE DELIMITER SCAN       */
         B     AMDPPOS2                                            0297
*AMDPPOS3:                                                         0298
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE VALUE LENGTH        */
AMDPPOS3 L     @10,SCNPTR                                          0298
         SL    @10,ADDRS3                                          0298
         ST    @10,LNGTH                                           0298
*   IF LNGTH>3 THEN                 /* IF LENGTH>THREE,              */
         C     @10,@CF00168                                        0299
         BNH   @RF00299                                            0299
*     DO;                           /* OUTPUT BAD VALUE LNGTH MSG    */
*AMDVLNCL:                                                         0301
*       CALL AMDVLEN;               /* HAVE MESSAGE ISSUED           */
AMDVLNCL L     @15,@CV00422                                        0301
         BALR  @14,@15                                             0301
*       GOTO AMDCDCK;               /* CHECK RETURN CODE             */
         B     AMDCDCK                                             0302
*     END;                                                         0303
*   IF LNGTH<1 THEN                 /* IF LENGTH<ONE,                */
@RF00299 L     @10,LNGTH                                           0304
         LTR   @10,@10                                             0304
         BP    @RF00304                                            0304
*     DO;                           /* THEN DO THE FOLLOWING         */
*AMDELMCL:                                                         0306
*       CALL AMDELIM;               /* OUTPUT BAD DELIM MSG          */
AMDELMCL L     @15,@CV00423                                        0306
         BALR  @14,@15                                             0306
*       GOTO AMDCDCK;               /* CHECK RETURN CODE             */
         B     AMDCDCK                                             0307
*     END;                                                         0308
*   COMP4=' ';                      /* BLANK COMPARE AREA            */
@RF00304 MVI   COMP4+1,C' '                                        0309
         MVC   COMP4+2(2),COMP4+1                                  0309
         MVI   COMP4,C' '                                          0309
*   COMP4(2:4)='366';               /* MOVE IN MAX NUM DAYS IN YR    */
         MVC   COMP4+1(3),@CC00550                                 0310
*   CHARWORD=' ';                   /* BLANK WORK AREA               */
         MVI   CHARWORD+1,C' '                                     0311
         MVC   CHARWORD+2(2),CHARWORD+1                            0311
         MVI   CHARWORD,C' '                                       0311
*   CHARWORD(5-LNGTH:4)             /* RIGHT JUSTIFY SPECIFIED       */
*       =VAL1(1:LNGTH);             /* DDD                           */
         LA    @10,5                                               0312
         SL    @10,LNGTH                                           0312
         LA    @02,CHARWORD-1(@10)                                 0312
         LCR   @10,@10                                             0312
         AL    @10,@CF00098                                        0312
         L     @15,ADDRS3                                          0312
         EX    @10,@SM00669                                        0312
*   IF CHARWORD>COMP4 THEN          /* IF VALUE>CHAR. 366, THEN      */
         CLC   CHARWORD(4),COMP4                                   0313
         BNH   @RF00313                                            0313
*     DO;                           /* OUTPUT BAD VALUE MSG          */
*AMDVMGCL:                                                         0315
*       CALL AMDVLMG;               /* ISSUE DIAGNOSTIC              */
AMDVMGCL L     @15,@CV00424                                        0315
         BALR  @14,@15                                             0315
*       GOTO AMDCDCK;               /* CHECK RETURN CODE             */
         B     AMDCDCK                                             0316
*     END;                                                         0317
*   CHARWORD=' ';                   /* BLANK WORK AREA               */
@RF00313 MVI   CHARWORD+1,C' '                                     0318
         MVC   CHARWORD+2(2),CHARWORD+1                            0318
         MVI   CHARWORD,C' '                                       0318
*   CHARWORD(1:LNGTH)               /* LEFT JUSTIFY DDD              */
*       =VAL1(1:LNGTH);                                            0319
*                                                                  0319
         L     @10,LNGTH                                           0319
         BCTR  @10,0                                               0319
         L     @02,ADDRS3                                          0319
         EX    @10,@SM00671                                        0319
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVRT PRINTABLE DECIMAL TO INTERNAL (PACKED) DECIMAL.        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0320
*   RFY                                                            0320
*    (REG4,                                                        0320
*     REG5,                                                        0320
*     REG6) RSTD;                   /* NEED THESE REGS         Y02014*/
*   REG4=ADDRS3;                    /* OBTAIN PTR TO FIRST CHAR      */
         LR    REG4,@02                                            0321
*   REG6=LNGTH-1;                   /* OBTAIN VALUE LENGTH - ONE     */
         LR    REG6,@10                                            0322
*   REG5=ALLPTR;                    /* GET PTR TO START/STOP SLOT    */
         L     REG5,ALLPTR                                         0323
*   GENERATE;                                                      0324
         EX  R6,PACKDGTS                EXECUTE PACK INSTRUCTION
         B   AMDPPOS4                   FINISHED WITH CONVERSION
PACKDGTS PACK  0(2,R5),0(0,R4) PACK DIGITS
*   RFY                                                            0325
*    (REG4,                                                        0325
*     REG5,                                                        0325
*     REG6) UNRSTD;                 /*                         Y02014*/
*AMDPPOS4:                                                         0326
*   IF PAREN='0'B THEN              /* IF ONLY DDD SPECIFIED,        */
AMDPPOS4 TM    PAREN,B'00010000'                                   0326
         BZ    @RT00326                                            0326
*     GOTO AMDPSLT;                 /* BEGIN TEMPTAB VAL INSERTN     */
*   IF SCNCHAR=')' THEN             /* IF HAVE (DDD), THEN           */
         L     @10,SCNPTR                                          0328
         CLI   SCNCHAR(@10),C')'                                   0328
         BE    @RT00328                                            0328
*     GOTO AMDPSLT;                 /* NO MORE VALUES                */
*AMDPOS41:                                                         0330
*   ADDRS3=SCNPTR+1;                /* SAVE VALUE BEG'NG ADDRS       */
AMDPOS41 LA    @10,1                                               0330
         AL    @10,SCNPTR                                          0330
         ST    @10,ADDRS3                                          0330
*   SCNPTR=SCNPTR+1;                /* UPDATE BUFFER POINTER         */
         ST    @10,SCNPTR                                          0331
*AMDPPOS5:                                                         0332
*   IF SCNCHAR=')' THEN             /* IF RIGHT PAREN AS DELIM,      */
AMDPPOS5 L     @10,SCNPTR                                          0332
         CLI   SCNCHAR(@10),C')'                                   0332
         BE    @RT00332                                            0332
*     GOTO AMDPPOS6;                /* GO CALCULATE LENGTH           */
*   IF SCNCHAR='.' THEN             /* IF PERIOD AS DELIM,           */
         CLI   SCNCHAR(@10),C'.'                                   0334
         BNE   @RF00334                                            0334
*     DO;                           /* DO THE FOLLOWING              */
*       MORESW='1'B;                /* MORE TO COME                  */
         OI    MORESW,B'01000000'                                  0336
*       GOTO AMDPPOS6;              /* GO CALCULATE LENGTH           */
         B     AMDPPOS6                                            0337
*     END;                          /* PERIOD WAS DELIMITER          */
*   IF SCNCHAR=',' THEN             /* COMMA NOT LEGAL DELIMITER     */
@RF00334 L     @10,SCNPTR                                          0339
         CLI   SCNCHAR(@10),C','                                   0339
         BE    @RT00339                                            0339
*     GOTO AMDELMCL;                /* ISSUE DIAGNOSTIC MESSAGE      */
*   IF SCNPTR=EOCADDR               /* IF AT LOGICAL END OF STMT,    */
*     THEN                          /* THEN                          */
         C     @10,EOCADDR                                         0341
         BE    @RT00341                                            0341
*     GOTO AMDPPOS6;                /* GO CALCULATE LENGTH           */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0343
         ST    @10,SCNPTR                                          0343
*   GOTO AMDPPOS5;                  /* CONTINUE DELIMITER SCAN       */
         B     AMDPPOS5                                            0344
*AMDPPOS6:                                                         0345
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE LENGTH              */
AMDPPOS6 L     @10,SCNPTR                                          0345
         SL    @10,ADDRS3                                          0345
         ST    @10,LNGTH                                           0345
*   IF LNGTH>2 THEN                 /* Q/TOO LONG                    */
         C     @10,@CF00077                                        0346
         BH    @RT00346                                            0346
*     GOTO AMDVLNCL;                /* YES--BAD VALUE LENGTH MSG     */
*   IF LNGTH<1 THEN                 /* Q/TOO SHORT                   */
         LTR   @10,@10                                             0348
         BNP   @RT00348                                            0348
*     GOTO AMDELMCL;                /* YES--INVALID DELIMITER MSG    */
*   IF FIVECHAR(5)^=' '             /* IF SECONDS AREA ALREADY       */
*     THEN                          /* FILLED IN, THEN HAVE TOO      */
         L     @10,ALLPTR                                          0350
         CLI   FIVECHAR+4(@10),C' '                                0350
         BNE   @RT00350                                            0350
*     GOTO AMDVLNCL;                /* MANY VALUE PORTIONS           */
*   IF FIVECHAR(4)^=' '             /* IF MINUTES AREA ALREADY       */
*     THEN                          /* FILLED IN, NOW PROCESSING     */
         CLI   FIVECHAR+3(@10),C' '                                0352
         BE    @RF00352                                            0352
*     DO;                           /* SECONDS, SO                   */
*       SECIND='1'B;                /* SECONDS--VALIDITY CHECK       */
         OI    SECIND,B'10000000'                                  0354
*       GOTO AMDPPOS7;              /* VALUE AFTER CNVRTING IT       */
         B     AMDPPOS7                                            0355
*     END;                          /* SECONDS BEING PROCESSED       */
*   IF FIVECHAR(3)^=' '             /* IF HOURS AREA ALREADY         */
*     THEN                          /* FILLED IN, NOW PROCESSING     */
@RF00352 L     @10,ALLPTR                                          0357
         CLI   FIVECHAR+2(@10),C' '                                0357
         BE    @RF00357                                            0357
*     MININD='1'B;                  /* MINUTES                       */
         OI    MININD,B'01000000'                                  0358
*AMDPPOS7:                                                         0359
*   CALL AMDPRCVB;                  /* CONVERT VALUE TO BINARY       */
@RF00357 DS    0H                                                  0359
AMDPPOS7 L     @15,@CV00420                                        0359
         BALR  @14,@15                                             0359
*   IF MININD='1'B                  /* IF PROCESSING MINUTES         */
*       ×SECIND='1'B THEN           /* OR SECONDS,                   */
         TM    MININD,B'11000000'                                  0360
         BNZ   @RT00360                                            0360
*     GOTO AMDPPOS8;                /* CHK THAT NOT >59              */
*   IF COMP4>23 THEN                /* IF VALUE OVER 23, OUTPUT      */
         CLC   COMP4(4),@CF00566                                   0362
         BH    @RT00362                                            0362
*     GOTO AMDVMGCL;                /* INVALID VALUE MESSAGE         */
*   FIVECHAR(3)=COMP4(4);           /* INSERT HOURS IN HOUR AREA     */
         L     @10,ALLPTR                                          0364
         MVC   FIVECHAR+2(1,@10),COMP4+3                           0364
*AMDPMOR:                                                          0365
*   IF MORESW='1'B THEN             /* IF MORE VALUES FOLLOW,        */
AMDPMOR  TM    MORESW,B'01000000'                                  0365
         BNO   @RF00365                                            0365
*     DO;                           /* DO THE FOLLOWING              */
*       MORESW='0'B;                /* SET OFF INDICATOR SWITCH      */
         NI    MORESW,B'10111111'                                  0367
*       GOTO AMDPOS41;              /* SCAN FOR ADDITIONAL VALUES    */
         B     AMDPOS41                                            0368
*     END;                          /* MORESW WAS ON                 */
*AMDPSLT:                                                          0370
*   IF CSTART='1'B THEN             /* IF PROCESSING 'START',        */
@RF00365 DS    0H                                                  0370
AMDPSLT  TM    CSTART,B'00100000'                                  0370
         BNO   @RF00370                                            0370
*     DO;                           /* DO THE FOLLOWING              */
*       DY=FIVECHAR(1:2);           /* INSERT DDD IN START SLOT      */
         L     @10,ALLPTR                                          0372
         MVC   DY(2),FIVECHAR(@10)                                 0372
*       GOTO AMDPSLT1;              /* IN TEMPTAB--CONTINUE          */
         B     AMDPSLT1                                            0373
*     END;                          /* PROCESSING 'START'            */
*   DYSTP=FIVECHAR(1:2);            /* INSERT DDD IN STOP SLOT       */
@RF00370 L     @10,ALLPTR                                          0375
         MVC   DYSTP(2),FIVECHAR(@10)                              0375
*AMDPSLT1:                                                         0376
*   IF FIVECHAR(3)=' '              /* IF HOURS NOT SPECIFIED,       */
*     THEN                          /* THEN NO TIME SPECIFIED        */
AMDPSLT1 L     @10,ALLPTR                                          0376
         CLI   FIVECHAR+2(@10),C' '                                0376
         BNE   @RF00376                                            0376
*     DO;                           /* DO THE FOLLOWING              */
*                                                                  0377
*       /*************************************************************/
*       /*                                                           */
*       /* SET TO ZERO THE HH, MM, AND SS BYTES IN THE INTERNAL TIME */
*       /* SLOT                                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0378
*       DO I=3 TO 5;                /* ZERO OUT HH, MM, SS BYTES     */
         LA    @10,3                                               0378
         ST    @10,I                                               0378
@DL00378 DS    0H                                                  0379
*         FIVECHAR(I)               /* SET EACH BYTE TO ZERO         */
*             ='00'X;                                              0379
         L     @02,ALLPTR                                          0379
         ALR   @02,@10                                             0379
         BCTR  @02,0                                               0379
         MVI   FIVECHAR(@02),X'00'                                 0379
*       END;                                                       0380
         AL    @10,@CF00044                                        0380
         ST    @10,I                                               0380
         C     @10,@CF00085                                        0380
         BNH   @DL00378                                            0380
*       IF CSTART='1'B THEN         /* IF PROCESSING 'START',        */
         TM    CSTART,B'00100000'                                  0381
         BNO   @RF00381                                            0381
*         TIMEU=TIMEU               /* START TIMER UNITS=ZERO        */
*             &&TIMEU;                                             0382
         XC    TIMEU(8),TIMEU                                      0382
*       ELSE                        /* STOP TIMER UNITS=ZERO         */
*         TIMERU=TIMERU             /* STOP TIMER UNITS=ZERO         */
*             &&TIMERU;                                            0383
         B     @RC00381                                            0383
@RF00381 XC    TIMERU(8),TIMERU                                    0383
*       GOTO AMDPEOC1;              /* SEARCH FOR NEXT KEYWORD       */
         B     AMDPEOC1                                            0384
*     END;                          /* NO HOURS SPECIFIED            */
*   IF FIVECHAR(4)=' ' THEN         /* IF NO MINUTES SPECIFIED,      */
@RF00376 L     @10,ALLPTR                                          0386
         CLI   FIVECHAR+3(@10),C' '                                0386
         BNE   @RF00386                                            0386
*     FIVECHAR(4)='00'X;            /* INSERT ZEROES IN THEIR PLC    */
         MVI   FIVECHAR+3(@10),X'00'                               0387
*   IF FIVECHAR(5)=' '              /* IF NO SECONDS SPECIFIED,      */
*     THEN                          /* THEN                          */
@RF00386 L     @10,ALLPTR                                          0388
         CLI   FIVECHAR+4(@10),C' '                                0388
         BNE   @RF00388                                            0388
*     FIVECHAR(5)='00'X;            /* INSERT ZEROES IN THEIR PLC    */
         MVI   FIVECHAR+4(@10),X'00'                               0389
*   RFY                                                            0390
*    (REG4,                                                        0390
*     REG5,                                                        0390
*     REG6,                         /* NEED THESE REGS         Y02014*/
*     REG7) RSTD;                   /*                         Y02014*/
@RF00388 DS    0H                                                  0391
*   IF CSTART='1'B THEN             /* IF PROCESSING START VALUE,    */
         TM    CSTART,B'00100000'                                  0391
         BNO   @RF00391                                            0391
*     REG5=FIVECHAR(3)              /* REG 5 CONTAINS TOTAL NUM      */
*         *THREESIX+FIVECHAR(4)     /* OF                            */
*         *SIXTY+FIVECHAR(5);       /* SECONDS SPECIFIED             */
         L     @10,ALLPTR                                          0392
         SLR   @15,@15                                             0392
         IC    @15,FIVECHAR+2(,@10)                                0392
         M     @14,THREESIX                                        0392
         ST    @15,@TF00001                                        0392
         SLR   @15,@15                                             0392
         IC    @15,FIVECHAR+3(,@10)                                0392
         M     @14,SIXTY                                           0392
         AL    @15,@TF00001                                        0392
         SLR   REG5,REG5                                           0392
         IC    REG5,FIVECHAR+4(,@10)                               0392
         ALR   @15,REG5                                            0392
         LR    REG5,@15                                            0392
*   ELSE                            /* IF STOP VALUE, THEN           */
*     REG5=FIVECHAR(3)              /* REG 5 CONTAINS TOTAL NUM      */
*         *THREESIX+FIVECHAR(4)     /* OF                            */
*         *SIXTY+FIVECHAR(5)+       /* SECONDS SPECIFIED PLUS        */
*         1;                        /* 1 TO ALLOW FOR REC TIME >     */
         B     @RC00391                                            0393
@RF00391 L     @10,ALLPTR                                          0393
         SLR   @15,@15                                             0393
         IC    @15,FIVECHAR+2(,@10)                                0393
         M     @14,THREESIX                                        0393
         ST    @15,@TF00001                                        0393
         SLR   @15,@15                                             0393
         IC    @15,FIVECHAR+3(,@10)                                0393
         M     @14,SIXTY                                           0393
         AL    @15,@TF00001                                        0393
         SLR   REG5,REG5                                           0393
         IC    REG5,FIVECHAR+4(,@10)                               0393
         ALR   @15,REG5                                            0393
         AL    @15,@CF00044                                        0393
         LR    REG5,@15                                            0393
*   GEN(M REG4,MILLION);            /* REGS 4 AND 5 CONTAIN # OF   0394
*                                      MICROSECONDS                  */
@RC00391 DS    0H                                                  0394
         M REG4,MILLION
*   GEN(D REG4,NUM2604);            /* DIVIDE BY 2604                */
         D REG4,NUM2604
*   REG7=REG4;                      /* SAVE THE REMAINDER            */
         LR    REG7,REG4                                           0396
*   GENERATE;                                                      0397
         M REG4,HUNDRED                 REG5=TIMER UNITS SUBTOTAL #1
         M REG6,HUNDRED                 REG6 CONTAINS
         D REG6,NUM2604                 TIMER UNITS SUBTOTAL #2
*   IF REG6=>HALFTIME               /* IF REMAINDER>=1302            */
*       &REG6^=NUM2604 THEN         /* AND DIVIDEND WAS NOT = 0      */
         C     REG6,HALFTIME                                       0398
         BL    @RF00398                                            0398
         C     REG6,NUM2604                                        0398
         BE    @RF00398                                            0398
*     REG7=REG7+1;                  /* ADD ONE TO QUOTIENT           */
         AL    REG7,@CF00044                                       0399
*   GEN(ALR REG5,REG7);             /* REG5=TOTAL TIMER UNITS        */
@RF00398 DS    0H                                                  0400
         ALR REG5,REG7
*   IF CSTART='1'B THEN             /* IF PROCESSING 'START' VAL     */
         TM    CSTART,B'00100000'                                  0401
         BNO   @RF00401                                            0401
*     DO;                           /* DO THE FOLLOWING              */
*       TIMEU=TIMEU&&TIMEU;         /* ZERO START TIMER        Y02014*/
         XC    TIMEU(8),TIMEU                                      0403
*       TIMEU(5:8)=REG5;            /* INSERT START TIMER UNITS      */
         STCM  REG5,15,TIMEU+4                                     0404
*     END;                          /* CHECK STOP SLOTS FOR VALS     */
*   ELSE                            /* IF PROCESSING 'STOP' VAL      */
*     DO;                           /* DO THE FOLLOWING              */
         B     @RC00401                                            0406
@RF00401 DS    0H                                                  0407
*       TIMERU=TIMERU&&TIMERU;      /* ZERO STOP TIMER         Y02014*/
         XC    TIMERU(8),TIMERU                                    0407
*       TIMERU(5:8)=REG5;           /* INSERT STOP TIMER UNITS       */
         STCM  REG5,15,TIMERU+4                                    0408
*       GOTO AMDPPOS9;              /* STOP SLOT HAS TIMER UNITS     */
         B     AMDPPOS9                                            0409
*     END;                          /* AND NOW EXAMINE START SLTS    */
*   IF TIME2^=BLANK1 THEN           /* IF PRTAB STOP SLOT NON-BNK    */
@RC00401 CLC   TIME2(8,AEDITCBR),BLANK1                            0411
         BNE   @RT00411                                            0411
*     GOTO AMDPPOSA;                /* CHECK IF START>STOP           */
*   IF TIMERU^=BLANK1 THEN          /* IF TTAB STOP SLOT NON-BLNK    */
         CLC   TIMERU(8),BLANK1                                    0413
         BNE   @RT00413                                            0413
*     GOTO AMDPOSA1;                /* CHECK IF START>STOP           */
*   GOTO AMDPEOC1;                  /* OTHERWISE, LOOK FOR NXT KW    */
         B     AMDPEOC1                                            0415
*   RFY                                                            0416
*    (REG4,                                                        0416
*     REG5,                                                        0416
*     REG6,                         /* RELEASE THESE REG       Y02014*/
*     REG7) UNRSTD;                 /*                         Y02014*/
*AMDPPOS9:                                                         0417
*   IF TIME^=BLANK1 THEN            /* IF PRTAB START SLOT IS      0417
*                                      NON-BLANK, THEN               */
AMDPPOS9 CLC   TIME(8,AEDITCBR),BLANK1                             0417
         BNE   @RT00417                                            0417
*     GOTO AMDPPOSB;                /* CHECK IF START>STOP           */
*   IF TIMEU^=BLANK1 THEN           /* IF TTAB START SLOT IS       0419
*                                      NON-BLANK, THEN               */
         CLC   TIMEU(8),BLANK1                                     0419
         BNE   @RT00419                                            0419
*     GOTO AMDPOSA1;                /* CHECK IF START>STOP           */
*   GOTO AMDPEOC1;                  /* OTHERWISE, LOOK FOR NXT KW    */
*                                                                  0421
         B     AMDPEOC1                                            0421
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF TEMPTAB START DAY IS GREATER THAN AMDPRTAB STOP  */
*   /* DAY, OR IF TEMPTAB START TIMER UNITS ARE GREATER THAN AMDPRTAB*/
*   /* TIMER UNITS. IF SO, OUTPUT ERROR MESSAGE. SINCE THE EQUIVALENT*/
*   /* OF 1 SECOND HAS BEEN ADDED TO THE STOP TIME VALUE TO ALLOW FOR*/
*   /* THE RECORD TIME BEING GREATER THAN THE SPECIFIED SECOND.000000*/
*   /* MICROSECONDS, THE TIMER UNIT COMPARISON IS FOR EQUAL TO OR    */
*   /* GREATER THAN.                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0422
*AMDPPOSA:                                                         0422
*   IF DY>DAY2 THEN                 /* COMPARE START/STOP VALUES     */
AMDPPOSA CLC   DY(2),DAY2(AEDITCBR)                                0422
         BH    @RT00422                                            0422
*     GOTO AMDTIMSG;                /* IF ERROR, OUTPUT DIAG MSG     */
*   IF DY=DAY2                      /* COMPARE START/STOP VALUES     */
*       &TIMEU=>TIME2 THEN          /* IN TABLES. IF ERROR,          */
         CLC   DY(2),DAY2(AEDITCBR)                                0424
         BNE   @RF00424                                            0424
         CLC   TIMEU(8),TIME2(AEDITCBR)                            0424
         BNL   @RT00424                                            0424
*     GOTO AMDTIMSG;                /* OUTPUT DIAGNOSTIC MESSAGE     */
*   GOTO AMDPEOC1;                  /* OTHERWISE, LOOK AT NEXT KW    */
*                                                                  0426
         B     AMDPEOC1                                            0426
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF TEMPTAB START DAY IS GREATER THAN TEMPTAB STOP   */
*   /* DAY, OR IF TEMPTAB START TIMER UNITS ARE GREATER THAN AMDPRTAB*/
*   /* TIMER UNITS. IF SO, OUTPUT ERROR MESSAGE.                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*AMDPOSA1:                                                         0427
*   IF DY>DYSTP THEN                /* COMPARE TEMPTAB VALUES        */
AMDPOSA1 CLC   DY(2),DYSTP                                         0427
         BH    @RT00427                                            0427
*     GOTO AMDTIMSG;                /* IF ERR, OUTPUT MESSAGE        */
*   IF DY=DYSTP                     /* COMPARE TEMPTAB VALUES        */
*       &TIMEU=>TIMERU THEN         /* --TIMER UNITS TOO             */
         CLC   DY(2),DYSTP                                         0429
         BNE   @RF00429                                            0429
         CLC   TIMEU(8),TIMERU                                     0429
         BNL   @RT00429                                            0429
*     GOTO AMDTIMSG;                /* IF ERR, OUTPUT MESSAGE        */
*   GOTO AMDPEOC1;                  /* OTHERWISE, LOOK AT NEXT KW    */
*                                                                  0431
         B     AMDPEOC1                                            0431
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF AMDPRTAB START DAY IS GREATER THAN TEMPTAB STOP  */
*   /* DAY, OR IF AMDPRTAB START TIMER UNITS ARE GREATER THAN TEMPTAB*/
*   /* TIMER UNITS. IF SO, OUTPUT ERROR MESSAGE.                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0432
*AMDPPOSB:                                                         0432
*   IF DAY>DYSTP THEN               /* COMPARE DAY VALUES            */
AMDPPOSB CLC   DAY(2,AEDITCBR),DYSTP                               0432
         BH    @RT00432                                            0432
*     GOTO AMDTIMSG;                /* IF ERR, OUTPUT MESSAGE        */
*   IF DAY=DYSTP                    /* COMPARE DAY VALUES            */
*       &TIME=>TIMERU THEN          /* COMPARE TIMER UNIT VALUES     */
         CLC   DAY(2,AEDITCBR),DYSTP                               0434
         BNE   @RF00434                                            0434
         CLC   TIME(8,AEDITCBR),TIMERU                             0434
         BNL   @RT00434                                            0434
*     GOTO AMDTIMSG;                /* IF ERR, OUTPUT MESSAGE        */
*   GOTO AMDPEOC1;                  /* OTHERWISE, LOOK FOR NXT KW    */
         B     AMDPEOC1                                            0436
*AMDTIMSG:                                                         0437
*   SYNMSGA=ADDR(AD8);              /* ADDRS OF ADDRS OF MSG         */
AMDTIMSG L     @10,@CA00352                                        0437
         LA    @10,AD8-AMDPRS00(,@10)                              0437
         ST    @10,SYNMSGA                                         0437
*   GNOSTDMG='1'B;                  /* OMIT PRECEDING SYNTAX ERR   0438
*                                      MESSAGE                       */
         OI    GNOSTDMG,B'00010000'                                0438
*   CALL AMDPRSYN;                  /* OUTPUT START>STOP MESSAGE     */
         L     @15,ASYNTAX                                         0439
         BALR  @14,@15                                             0439
*   GOTO AMDPEOC;                   /* SET FLUSH MODE BIT            */
         B     AMDPEOC                                             0440
*AMDPPOS8:                                                         0441
*   IF COMP4>59 THEN                /* IF MINS OR SECS>59, THEN      */
AMDPPOS8 CLC   COMP4(4),@CF00582                                   0441
         BH    @RT00441                                            0441
*     GOTO AMDVMGCL;                /* OUTPUT BAD VALUE MSG          */
*   IF SECIND='1'B THEN             /* IF CALCULATING SECONDS,       */
         TM    SECIND,B'10000000'                                  0443
         BNO   @RF00443                                            0443
*     DO;                           /* DO THE FOLLOWING              */
*       FIVECHAR(5)                 /* INSERT THEM IN SLOT           */
*           =COMP4(4);                                             0445
         L     @10,ALLPTR                                          0445
         MVC   FIVECHAR+4(1,@10),COMP4+3                           0445
*       SECIND='0'B;                /* TURN OFF SECONDS SWITCH       */
         NI    SECIND,B'01111111'                                  0446
*       GOTO AMDPMOR;               /* MAKE SURE NO MORE VALUES      */
         B     AMDPMOR                                             0447
*     END;                          /* CALCULATING SECONDS           */
*   FIVECHAR(4)=COMP4(4);           /* INSERT MINS IN SLOT           */
@RF00443 L     @10,ALLPTR                                          0449
         MVC   FIVECHAR+3(1,@10),COMP4+3                           0449
*   MININD='0'B;                    /* TURN OFF MINUTES SWITCH       */
         NI    MININD,B'10111111'                                  0450
*   GOTO AMDPMOR;                   /* CHK FOR MORE VALUES           */
*                                                                  0451
         B     AMDPMOR                                             0451
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE PROCESSES THE USR KEYWORD AND ITS ASSOCIATED  */
*   /* VALUES. A SYMBOLIC EID, A SINGLE EID, AND AN EID RANGE ALL    */
*   /* QUALIFY AS 'USR' KEYWORDS. 'USR=ALL' ALSO IS AN ACCEPTABLE    */
*   /* KEYWORD/VALUE COMBINATION.                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0452
*AMDPUSR:                                                          0452
*   IF ALLU='1'B                    /* USR=ALL ALREADY SPECIFIED     */
*       ×ALLUT='1'B THEN            /* OR USR=ALL IND IN TEMPTAB     */
AMDPUSR  TM    ALLU(AEDITCBR),B'10000000'                          0452
         BO    @RT00452                                            0452
         TM    ALLUT,B'10000000'                                   0452
         BO    @RT00452                                            0452
*     GOTO AMDPCK1;                 /* IGNORE REST OF KW             */
*   SELUT='1'B;                     /* SET ON USR=SEL BIT IN TTAB    */
         OI    SELUT,B'01000000'                                   0454
*AMDPUSR1:                                                         0455
*   LFTBIT='0'B;                    /* TURN OFF LEFT INDICATOR       */
AMDPUSR1 DS    0H                                                  0456
*   RTBIT='0'B;                     /* TURN OFF RIGHT INDICATOR      */
*   BOTHBIT='0'B;                   /* TURN OFF SINGLE VALUE IND     */
*   SYMBIT='0'B;                    /* TURN OFF SYMBOLIC EID IND     */
*   DASHSW='0'B;                    /* TURN OFF DASH SWITCH          */
         NI    LFTBIT,B'00000111'                                  0459
*   LFTVAL=' ';                     /* BLANK OUT LEFT SLOT           */
         MVI   LFTVAL+1,C' '                                       0460
         MVI   LFTVAL,C' '                                         0460
*   RTVAL=' ';                      /* BLANK OUT RIGHT SLOT          */
         MVI   RTVAL+1,C' '                                        0461
         MVI   RTVAL,C' '                                          0461
*   NUMCNT=USRCOUNT+USRCRCNT;       /* UPDATE COUNTER FOR EACH VALUE
*                                      SPECIFIED                     */
         L     NUMCNT,USRCOUNT                                     0462
         AL    NUMCNT,USRCRCNT                                     0462
*   IF NUMCNT>20 THEN               /* IF OVER 20 VALUES GIVEN,      */
         C     NUMCNT,@CF00129                                     0463
         BNH   @RF00463                                            0463
*     DO;                           /* OUTPUT EXCESSIV # VALS MSG    */
*AMDEXCAL:                                                         0465
*       CALL AMDUMMG;               /* HAVE DIAGNOSTIC OUTPUTTED     */
AMDEXCAL L     @15,@CV00425                                        0465
         BALR  @14,@15                                             0465
*       GOTO AMDCDCK;               /* CHECK RETURN CODE             */
         B     AMDCDCK                                             0466
*     END;                                                         0467
*AMDPUSR2:                                                         0468
*   IF SCNCHAR=','                  /* IF DELIMITER OF COMMA         */
*       ×SCNCHAR=' '                /* OR BLANK                      */
*       ×SCNCHAR=')' THEN           /* OR RIGHT PAREN FOUND, THEN    */
@RF00463 DS    0H                                                  0468
AMDPUSR2 L     @10,SCNPTR                                          0468
         CLI   SCNCHAR(@10),C','                                   0468
         BE    @RT00468                                            0468
         CLI   SCNCHAR(@10),C' '                                   0468
         BE    @RT00468                                            0468
         CLI   SCNCHAR(@10),C')'                                   0468
         BE    @RT00468                                            0468
*     GOTO AMDPUSR3;                /* CALCULATE VALUE LENGTH        */
*   IF SCNPTR=EOCADDR               /* IF AT LOGICAL END OF STMT,    */
*     THEN                          /* THEN                          */
         C     @10,EOCADDR                                         0470
         BE    @RT00470                                            0470
*     GOTO AMDPUSR3;                /* CALCULATE VALUE LENGTH        */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0472
         ST    @10,SCNPTR                                          0472
*   GOTO AMDPUSR2;                  /* CONTINUE SCAN FOR DELIMITR    */
         B     AMDPUSR2                                            0473
*AMDPUSR3:                                                         0474
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE VALUE LENGTH        */
AMDPUSR3 L     @10,ADDRS3                                          0474
         L     @02,SCNPTR                                          0474
         SLR   @02,@10                                             0474
         ST    @02,LNGTH                                           0474
*   IF LNGTH>9 THEN                 /* IF >9 CHARS, OUTPUT     YM1411*/
         C     @02,@CF00166                                        0475
         BH    @RT00475                                            0475
*     GOTO AMDVLNCL;                /* BAD VALUE LENGTH MESSAGE      */
*   IF LNGTH<1 THEN                 /* IF LNGTH<1, OUTPUT BAD        */
         LTR   @02,@02                                             0477
         BNP   @RT00477                                            0477
*     GOTO AMDELMCL;                /* DELIMITER MESSAGE             */
*   IF LNGTH=3 THEN                 /* IF LENGTH IS THREE            */
         C     @02,@CF00168                                        0479
         BNE   @RF00479                                            0479
*     DO;                           /* DO THE FOLLOWING              */
*       IF VAL1(1:3)                /* CHECK FOR SPECIAL CASE OF     */
*           ^='ALL' THEN            /* 'USR=ALL'--IF NOT, THEN       */
         CLC   VAL1(3,@10),@CC00593                                0481
         BNE   @RT00481                                            0481
*         GOTO AMDPUSR4;            /* CONTINUE VALUE SCAN           */
*       ALLUT='1'B;                 /* IF SO, SET ON USR ALL FLG     */
         OI    ALLUT,B'10000000'                                   0483
*       GOTO AMDPCK1;               /* SEARCH FOR NEXT KEYWORD       */
         B     AMDPCK1                                             0484
*     END;                          /* LENGTH WAS 3                  */
*                                                                  0485
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF ALL DIGITS ARE VALID HEX DIGITS--BETWEEN ZERO AND*/
*   /* 'F'. IF ANY ARE NOT, CHK SYMBOLIC EID TABLE.                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0486
*AMDPUSR4:                                                         0486
*   DO I=LNGTH TO 1 BY-1;           /* CHECK TO DETERMINE IF ALL     */
@RF00479 DS    0H                                                  0486
AMDPUSR4 L     @10,LNGTH                                           0486
         ST    @10,I                                               0486
         B     @DE00486                                            0486
@DL00486 DS    0H                                                  0487
*     IF VAL1(I)='-' THEN           /* IF EMBEDDED DASH              */
         L     @02,ADDRS3                                          0487
         ALR   @10,@02                                             0487
         BCTR  @10,0                                               0487
         CLI   VAL1(@10),C'-'                                      0487
         BE    @RT00487                                            0487
*       GOTO AMDDASH;               /* CHECK FOR VALIDITY            */
*     IF VAL1(I)=>'A'               /* DIGITS ARE BETWEEN 'A'        */
*         &VAL1(I)=<'F' THEN        /* AND 'F'                       */
         L     @10,I                                               0489
         ALR   @10,@02                                             0489
         BCTR  @10,0                                               0489
         CLI   VAL1(@10),C'A'                                      0489
         BL    @RF00489                                            0489
         L     @10,I                                               0489
         ALR   @02,@10                                             0489
         BCTR  @02,0                                               0489
         CLI   VAL1(@02),C'F'                                      0489
         BNH   @RT00489                                            0489
*       GOTO AMDPEND2;              /* OR                            */
*     IF VAL1(I)<'0'                /* 0                             */
*         ×VAL1(I)>'9' THEN         /* AND 9                         */
@RF00489 L     @10,ADDRS3                                          0491
         L     @02,I                                               0491
         ALR   @02,@10                                             0491
         BCTR  @02,0                                               0491
         CLI   VAL1(@02),C'0'                                      0491
         BL    @RT00491                                            0491
         L     @02,I                                               0491
         ALR   @10,@02                                             0491
         BCTR  @10,0                                               0491
         CLI   VAL1(@10),C'9'                                      0491
         BH    @RT00491                                            0491
*       GOTO AMDPSYMB;              /* IF NOT, SYMBOLIC EID          */
*AMDPEND2:                                                         0493
*   END;                                                           0493
AMDPEND2 SLR   @10,@10                                             0493
         BCTR  @10,0                                               0493
         AL    @10,I                                               0493
         ST    @10,I                                               0493
@DE00486 LTR   @10,@10                                             0493
         BP    @DL00486                                            0493
*   GOTO AMDPUSR6;                  /* NON-SYMBOLIC EID              */
*                                                                  0494
         B     AMDPUSR6                                            0494
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR EMBEDDED DASH. IF 1ST OR LAST CHARACTER, OR IF MORE */
*   /* THEN ONE IN RANGE, HAVE INVALID DELIMITER                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0495
*AMDDASH:                                                          0495
*   IF I=1                          /* IF FIRST CHARACTER,           */
*       ×I=LNGTH THEN               /* OR DASH IS LAST CHARACTER     */
AMDDASH  L     @10,I                                               0495
         C     @10,@CF00044                                        0495
         BE    @RT00495                                            0495
         C     @10,LNGTH                                           0495
         BE    @RT00495                                            0495
*     GOTO AMDELMCL;                /* OUTPUT INVALID DELIM MSG      */
*   IF DASHSW='1'B THEN             /* IF MORE THAN 1 DASH IN VAL    */
         TM    DASHSW,B'00001000'                                  0497
         BNO   @RF00497                                            0497
*     DO;                           /* DO THE FOLLOWING              */
*       DASHSW='0'B;                /* TURN OFF DASHSW               */
         NI    DASHSW,B'11110111'                                  0499
*       GOTO AMDELMCL;              /* OUTPUT INVALID DELIM MSG      */
         B     AMDELMCL                                            0500
*     END;                                                         0501
*   DASHSW='1'B;                    /* IF FIRST DASH, SET ON SW      */
@RF00497 OI    DASHSW,B'00001000'                                  0502
*   GOTO AMDPEND2;                  /* CHECK NEXT DIGIT              */
         B     AMDPEND2                                            0503
*AMDPSYMB:                                                         0504
*   IF LNGTH>4 THEN                 /* SYMBOLIC EID MUST BE=> 4      */
AMDPSYMB L     @10,LNGTH                                           0504
         C     @10,@CF00098                                        0504
         BH    @RT00504                                            0504
*     GOTO AMDPSR51;                /* OUTPUT ERROR MESSAGE          */
*   EIDCT=1;                        /* BEGIN EID TABLE SEARCH        */
         MVC   EIDCT(4),@CF00044                                   0506
*   COMP4=' ';                      /* BLANK COMPARE AREA            */
         MVI   COMP4+1,C' '                                        0507
         MVC   COMP4+2(2),COMP4+1                                  0507
         MVI   COMP4,C' '                                          0507
*   COMP4=VAL1(1:LNGTH);            /* MOVE IN DELIMITED VALUE       */
         MVI   COMP4+1,C' '                                        0508
         MVC   COMP4+2(2),COMP4+1                                  0508
         BCTR  @10,0                                               0508
         L     @02,ADDRS3                                          0508
         EX    @10,@SM00676                                        0508
*AMDPUSR5:                                                         0509
*   IF SYMBIT='1'B THEN             /* PROCESSING SYMBOLIC EID?      */
AMDPUSR5 TM    SYMBIT,B'00010000'                                  0509
         BNO   @RF00509                                            0509
*     DO;                           /* IF SO, DO THE FOLLOWING       */
*       IF EIDCT>18 THEN            /* IF BEYOND # OF SYMB EIDS,     */
         L     @10,EIDCT                                           0511
         C     @10,@CF00399                                        0511
         BNH   @RF00511                                            0511
*         DO;                       /* THEN DO THE FOLLOWING         */
*           SYMBIT='0'B;            /* SET TO 0 SYMB EID BIT         */
         NI    SYMBIT,B'11101111'                                  0513
*           GOTO AMDPUPRN;          /* CHECK FOR MORE VALUES         */
         B     AMDPUPRN                                            0514
*         END;                                                     0515
*       GOTO AMDINPRN;              /* IF # OK, CHK FOR EID MATCH    */
         B     AMDINPRN                                            0516
*     END;                                                         0517
*CHK:                                                              0518
*   IF EIDCT>18 THEN                /* IF BEYOND # SYMBOLIC EIDS     */
@RF00509 DS    0H                                                  0518
CHK      L     @10,EIDCT                                           0518
         C     @10,@CF00399                                        0518
         BNH   @RF00518                                            0518
*     DO;                           /* DO THE FOLLOWING              */
*AMDPSR51:                                                         0520
*       SYNMSGA=ADDR(AD9);          /* OUTPUT ERR MSG--STORE ADRS    */
AMDPSR51 L     @10,@CA00352                                        0520
         LA    @10,AD9-AMDPRS00(,@10)                              0520
         ST    @10,SYNMSGA                                         0520
*       GNOSTDMG='1'B;              /* OMIT ISSUANCE OF AMD165I      */
         OI    GNOSTDMG,B'00010000'                                0521
*       CALL AMDPRSYN;              /* OUTPUT INVALID EID MSG        */
         L     @15,ASYNTAX                                         0522
         BALR  @14,@15                                             0522
*       GOTO AMDPEOC;               /* SET FLUSH MODE SWITCH         */
         B     AMDPEOC                                             0523
*     END;                          /* HAD INVALID SYMBOLIC EID      */
*AMDINPRN:                                                         0525
*   IF EIDNAM0(EIDCT)               /* IF SYMBOLIC EID MATCH         */
*       =COMP4                      /* FOUND                         */
*     THEN                          /* THEN                          */
@RF00518 DS    0H                                                  0525
AMDINPRN L     @10,EIDCT                                           0525
         SLA   @10,3                                               0525
         L     @02,@CA00401                                        0525
         ST    @10,@TF00001                                        0525
         ALR   @10,@02                                             0525
         AL    @10,@CF00678                                        0525
         CLC   EIDNAM0-AMDPRS01(4,@10),COMP4                       0525
         BNE   @RF00525                                            0525
*     DO;                           /* DO THE FOLLOWING              */
*       LFTVAL=LRANGE0              /* MOVE IN LEFT AND              */
*           (EIDCT);                                               0527
         L     @10,@TF00001                                        0527
         AL    @10,@CF00679                                        0527
         LH    @10,LRANGE0-AMDPRS01-4(@10,@02)                     0527
         STH   @10,LFTVAL                                          0527
*       RTVAL=HRANGE0               /* RIGHT VALUES                  */
*           (EIDCT);                                               0528
         L     @10,@TF00001                                        0528
         BCTR  @02,0                                               0528
         BCTR  @02,0                                               0528
         LH    @10,HRANGE0-AMDPRS01-6(@10,@02)                     0528
         STH   @10,RTVAL                                           0528
*       SYMBIT='1'B;                /* SET ON SYMBOLIC EID BIT       */
         OI    SYMBIT,B'00010000'                                  0529
*       GOTO AMDPSARG;              /* BEGIN USRTAB PROCESSING       */
         B     AMDPSARG                                            0530
*     END;                          /* MATCH WAS FOUND               */
*   EIDCT=EIDCT+1;                  /* NO MATCH-CHECK NEXT ELEM      */
@RF00525 LA    @10,1                                               0532
         AL    @10,EIDCT                                           0532
         ST    @10,EIDCT                                           0532
*   GOTO AMDPUSR5;                  /* CONTINUE SYMBOLIC SEARCH      */
         B     AMDPUSR5                                            0533
*AMDPUSR6:                                                         0534
*   IF LNGTH>7 THEN                 /* IF LENGTH > SEVEN             */
AMDPUSR6 L     @10,LNGTH                                           0534
         C     @10,@CF00055                                        0534
         BH    @RT00534                                            0534
*     GOTO AMDVLNCL;                /* OUTPUT INVALID VALUE LENGTH 0535
*                                      MESSAGE                       */
*   IF LNGTH>3 THEN                 /* BETTER HAVE EID RANGE         */
         C     @10,@CF00168                                        0536
         BNH   @RF00536                                            0536
*     DO;                           /* DO THE FOLLOWING              */
*       SCNPTR=ADDRS3;              /* RESET POINTER                 */
*                                                                  0538
         L     @10,ADDRS3                                          0538
         ST    @10,SCNPTR                                          0538
*       /*************************************************************/
*       /*                                                           */
*       /* SCAN LENGTH NUMBER OF CHARACTERS FOR DASH-- ARE DEALING   */
*       /* WITH EID RANGE.                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0539
*       DO I=1 TO LNGTH;            /* SCAN LNGTH NUM OF CHARS       */
         LA    @10,1                                               0539
         B     @DE00539                                            0539
@DL00539 DS    0H                                                  0540
*         IF SCNCHAR='-' THEN       /* LOOKING FOR RANGE DELIMITR    */
         L     @02,SCNPTR                                          0540
         CLI   SCNCHAR(@02),C'-'                                   0540
         BE    @RT00540                                            0540
*           GOTO AMDPFND;           /* IF FOUND, CONTINUE SEARCH     */
*         SCNPTR=SCNPTR+1;          /* EXAMINE NEXT CHARACTER        */
         AL    @02,@CF00044                                        0542
         ST    @02,SCNPTR                                          0542
*       END;                        /* SEARCH FOR DASH               */
         AL    @10,@CF00044                                        0543
@DE00539 ST    @10,I                                               0543
         C     @10,LNGTH                                           0543
         BNH   @DL00539                                            0543
*       GOTO AMDVLNCL;              /* OVER 3 CHARS AND NOT RANGE    */
         B     AMDVLNCL                                            0544
*     END;                          /* EID RANGE CHECK               */
*   IF LNGTH=3 THEN                 /* MAY HAVE SPECIAL CASE         */
@RF00536 CLC   LNGTH(4),@CF00168                                   0546
         BNE   @RF00546                                            0546
*     DO;                           /* DO THE FOLLOWING              */
*       IF VAL1(2)='-'              /* IF MIDDLE CHARACTER IS A      */
*         THEN                                                     0548
         L     @10,ADDRS3                                          0548
         CLI   VAL1+1(@10),C'-'                                    0548
         BNE   @RF00548                                            0548
*         DO;                       /* DASH, THEN                    */
*           LNGTH=1;                /* LNGTH OF FIRST VALUE IS 1     */
         MVC   LNGTH(4),@CF00044                                   0550
*           ALLPTR=SCNPTR-1;        /* POSITION TO BEG'NG OF 2ND   0551
*                                      VALUE                         */
         L     @10,SCNPTR                                          0551
         BCTR  @10,0                                               0551
         ST    @10,ALLPTR                                          0551
*           GOTO AMDPFND1;          /* PROCEED AS WITH 'LEFT' VAL    */
         B     AMDPFND1                                            0552
*         END;                      /* THREE CHARS WITH RANGE        */
*       GOTO AMDPUSR7;              /* NO DASH IN MIDL--NO RANGE     */
         B     AMDPUSR7                                            0554
*     END;                          /* IF LENGTH=THREE               */
*AMDPUSR7:                                                         0556
*   ALLCT=1;                        /* BEGIN TABLE SEARCH            */
@RF00546 DS    0H                                                  0556
AMDPUSR7 MVC   ALLCT(4),@CF00044                                   0556
*   BOTHBIT='1'B;                   /* HAVE SINGLE RANGE             */
         OI    BOTHBIT,B'00100000'                                 0557
*   CALL AMDPRHX;                   /* CNVT EXT HEX TO BINARY        */
         L     @15,@CV00421                                        0558
         BALR  @14,@15                                             0558
*   LFTVAL=COMP8(3:4);              /* MOVE IN RESULT                */
         MVC   LFTVAL(2),COMP8+2                                   0559
*   RTVAL=COMP8(3:4);               /* MOVE IN RESULT                */
         MVC   RTVAL(2),COMP8+2                                    0560
*AMDPUS71:                                                         0561
*   ARG=LFTVAL;                     /* PROCESS LEFT VALUE FIRST      */
AMDPUS71 MVC   ARG(2),LFTVAL                                       0561
*AMDPUSR8:                                                         0562
*   IF USRNGTAB(ALLCT,3:4)          /* Q/IS UPPER RANGE PORTION      */
*       =BLANK1 THEN                /* BLANK                         */
AMDPUSR8 L     @10,ALLCT                                           0562
         SLA   @10,2                                               0562
         ST    @10,@TF00001                                        0562
         ALR   @10,AEDITCBR                                        0562
         CLC   USRNGTAB-2(2,@10),BLANK1                            0562
         BE    @RT00562                                            0562
*     GOTO AMDPINS;                 /* IF YES, INSERT VAL            */
*   IF ARG=>USRNGTAB(ALLCT,1        /* IF CURRENT VALUE=>LOWER       */
*       :2)&ARG=<USRNGTAB           /* RANGE PORTION, AND =<         */
*       (ALLCT,3:4) THEN            /* UPPER RNG PORTION, THEN NO  0564
*                                      NEED TO INSERT VAL            */
         LR    @10,AEDITCBR                                        0564
         AL    @10,@TF00001                                        0564
         CLC   ARG(2),USRNGTAB-4(@10)                              0564
         BL    @RF00564                                            0564
         LR    @10,AEDITCBR                                        0564
         AL    @10,@TF00001                                        0564
         CLC   ARG(2),USRNGTAB-2(@10)                              0564
         BNH   @RT00564                                            0564
*     GOTO AMDPUSRA;                /* VAL--CONTINUE PROCESSING      */
*   IF RTBIT='1'B THEN              /* IF PROCESSING UPPER LIMIT,    */
@RF00564 TM    RTBIT,B'01000000'                                   0566
         BO    @RT00566                                            0566
*     GOTO AMDPINS2;                /* CHECK FURTHER                 */
*   ALLCT=ALLCT+1;                  /* CONTINUE TABLE SEARCH         */
         LA    @10,1                                               0568
         AL    @10,ALLCT                                           0568
         ST    @10,ALLCT                                           0568
*   IF ALLCT>20 THEN                /* Q/OUT OF TABLE                */
         C     @10,@CF00129                                        0569
         BH    @RT00569                                            0569
*     GOTO AMDEXCAL;                /* YES--TOO MANY VALS ERR MSG    */
*   GOTO AMDPUSR8;                  /* NO--CONTINUE TABLE SEARCH     */
         B     AMDPUSR8                                            0571
*AMDPFND:                                                          0572
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE VALUE LENGTH        */
AMDPFND  L     @10,SCNPTR                                          0572
         LR    @02,@10                                             0572
         SL    @02,ADDRS3                                          0572
         ST    @02,LNGTH                                           0572
*   ALLPTR=SCNPTR+1;                /* CALC BEG'NG @ OF NEXT VAL     */
         LA    @15,1                                               0573
         ALR   @10,@15                                             0573
         ST    @10,ALLPTR                                          0573
*   IF LNGTH>3 THEN                 /* IF LNGTH>3, THEN              */
         C     @02,@CF00168                                        0574
         BH    @RT00574                                            0574
*     GO TO AMDVLNCL;               /* OUTPUT INVALID LNGTH MSG      */
*   IF LNGTH<1 THEN                 /* IF LENGTH<1, THEN             */
         CR    @02,@15                                             0576
         BL    @RT00576                                            0576
*     GOTO AMDELMCL;                /* OUTPUT BAD DELIMITER MSG      */
*AMDPFND1:                                                         0578
*   CALL AMDPRHX;                   /* CNVT EXT HEX TO BINARY        */
AMDPFND1 L     @15,@CV00421                                        0578
         BALR  @14,@15                                             0578
*   LFTVAL=COMP8(3:4);              /* MOVE IN RESULT                */
         MVC   LFTVAL(2),COMP8+2                                   0579
*AMDPSARG:                                                         0580
*   LFTBIT='1'B;                    /* SET ON LOWER RANGE INDCATR    */
AMDPSARG OI    LFTBIT,B'10000000'                                  0580
*   ALLCT=1;                        /* INITIALIZE TABLE SEARCH CT    */
         MVC   ALLCT(4),@CF00044                                   0581
*   GOTO AMDPUS71;                  /* PROCESS LEFT VALUE FIRST      */
         B     AMDPUS71                                            0582
*AMDPINS:                                                          0583
*   IF BOTHBIT='1'B THEN            /* IF PROCESSING SINGLE VAL,     */
AMDPINS  TM    BOTHBIT,B'00100000'                                 0583
         BNO   @RF00583                                            0583
*     DO;                           /* DO THE FOLLOWING              */
*       USRNGTAB(ALLCT,1:2)         /* INSERT VAL AS LOWER PART      */
*           =ARG;                   /* OF RANGE                      */
         L     @10,ALLCT                                           0585
         SLA   @10,2                                               0585
         ST    @10,@TF00001                                        0585
         ALR   @10,AEDITCBR                                        0585
         MVC   USRNGTAB-4(2,@10),ARG                               0585
*       USRNGTAB(ALLCT,3:4)         /* INSERT VAL AS UPPER PART      */
*           =ARG;                   /* OF RANGE                      */
         LR    @10,AEDITCBR                                        0586
         AL    @10,@TF00001                                        0586
         MVC   USRNGTAB-2(2,@10),ARG                               0586
*       USRCRCNT=USRCRCNT+1;        /* UPDATE USR VALUE COUNTER      */
         LA    @10,1                                               0587
         AL    @10,USRCRCNT                                        0587
         ST    @10,USRCRCNT                                        0587
*       BOTHBIT='0'B;               /* TURN OFF SINGLE VALUE BIT     */
*                                                                  0588
         NI    BOTHBIT,B'11011111'                                 0588
*       /*************************************************************/
*       /*                                                           */
*       /* POSITION TO NEXT KEYWORD VALUE. IF NONE EXISTS, ATTEMPT TO*/
*       /* POSITION TO NEXT KEYWORD.                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0589
*AMDPUPRN:                                                         0589
*       IF SYMBIT='1'B THEN         /* IF PROCESSING SYMB EIDS,      */
AMDPUPRN TM    SYMBIT,B'00010000'                                  0589
         BNO   @RF00589                                            0589
*         DO;                       /* DO THE FOLLOWING              */
*           EIDCT=EIDCT+1;          /* UPDATE EID TABL INDEX         */
         LA    @10,1                                               0591
         AL    @10,EIDCT                                           0591
         ST    @10,EIDCT                                           0591
*           GOTO AMDPUSR5;          /* CONTINUE EID TABL SEARCH      */
         B     AMDPUSR5                                            0592
*         END;                      /*                         Y02014*/
*       IF PAREN='0'B THEN          /* IF NO MORE VALUES, THEN       */
@RF00589 TM    PAREN,B'00010000'                                   0594
         BZ    @RT00594                                            0594
*         GOTO AMDPEOC1;            /* LOOK FOR NEXT KEYWORD         */
*       IF SCNCHAR=')' THEN         /* IF DELIMITER FOUND, THEN      */
         L     @10,SCNPTR                                          0596
         CLI   SCNCHAR(@10),C')'                                   0596
         BE    @RT00596                                            0596
*         GOTO AMDPEOC1;            /* LOOK FOR NEXT KEYWORD         */
*       SCNPTR=SCNPTR+1;            /* UPDATE BUFFER SCAN PTR        */
         AL    @10,@CF00044                                        0598
         ST    @10,SCNPTR                                          0598
*       ADDRS3=SCNPTR;              /* ADDRS OF NEXT VALUE           */
         ST    @10,ADDRS3                                          0599
*       GOTO AMDPUSR1;              /* RESUME USER SCAN              */
         B     AMDPUSR1                                            0600
*     END;                          /* WAS PROCESSING SINGLE VAL     */
*   IF LFTBIT='0'B THEN             /* IF LEFT OFF, MUST BE          */
@RF00583 TM    LFTBIT,B'10000000'                                  0602
         BZ    @RT00602                                            0602
*     GOTO AMDPINS2;                /* PROCESSING RT OR UPPER VAL    */
*   USRNGTAB(ALLCT,1:2)             /* LEFT VAL, SO INSERT IT        */
*       =ARG;                       /* INTO LOWER RANGE              */
         L     @10,ALLCT                                           0604
         SLA   @10,2                                               0604
         ALR   @10,AEDITCBR                                        0604
         MVC   USRNGTAB-4(2,@10),ARG                               0604
*   USRCRCNT=USRCRCNT+1;            /* UPDATE USR VALUE COUNTER      */
         LA    @10,1                                               0605
         AL    @10,USRCRCNT                                        0605
         ST    @10,USRCRCNT                                        0605
*AMDPRTVL:                                                         0606
*   LFTBIT='0'B;                    /* TURN OFF LEFT BIT             */
AMDPRTVL NI    LFTBIT,B'01111111'                                  0606
*   IF RTVAL^=BLANK1 THEN           /* Q/RT VAL FILLED IN            */
         CLC   RTVAL(2),BLANK1                                     0607
         BNE   @RT00607                                            0607
*     GOTO AMDPIN12;                /* YES                           */
*   ADDRS3=ALLPTR;                  /* RESET ADDRS3                  */
         L     @10,ALLPTR                                          0609
         ST    @10,ADDRS3                                          0609
*   SCNPTR=ADDRS3;                  /* POINT TO NEXT VAL             */
         ST    @10,SCNPTR                                          0610
*AMDPINS1:                                                         0611
*   IF SCNCHAR=','                  /* IF DELIMITER OF COMMA         */
*       ×SCNCHAR=' '                /* OR BLANK                      */
*       ×SCNCHAR=')' THEN           /* OR RIGHT PAREN FOUND, THEN    */
AMDPINS1 L     @10,SCNPTR                                          0611
         CLI   SCNCHAR(@10),C','                                   0611
         BE    @RT00611                                            0611
         CLI   SCNCHAR(@10),C' '                                   0611
         BE    @RT00611                                            0611
         CLI   SCNCHAR(@10),C')'                                   0611
         BE    @RT00611                                            0611
*     GOTO AMDPIN11;                /* CONTINUE PROCESSING           */
*   IF SCNPTR=EOCADDR               /* IF LOGICAL END OF STMT        */
*     THEN                          /* SERVES AS DELIMITER, THEN     */
         C     @10,EOCADDR                                         0613
         BE    @RT00613                                            0613
*     GOTO AMDPIN11;                /* CONTINUE PROCESSING           */
*   SCNPTR=SCNPTR+1;                /* POSITION BUFFER POINTER       */
         AL    @10,@CF00044                                        0615
         ST    @10,SCNPTR                                          0615
*   GOTO AMDPINS1;                  /* CONTINUE SCAN FOR DELIMITR    */
         B     AMDPINS1                                            0616
*AMDPIN11:                                                         0617
*   LNGTH=SCNPTR-ADDRS3;            /* CALCULATE VALUE LENGTH        */
AMDPIN11 L     @10,SCNPTR                                          0617
         SL    @10,ADDRS3                                          0617
         ST    @10,LNGTH                                           0617
*   IF LNGTH>3 THEN                 /* IF LENGTH>THREE, OUTPUT       */
         C     @10,@CF00168                                        0618
         BH    @RT00618                                            0618
*     GOTO AMDVLNCL;                /* INVALID VALUE LENGTH MSG      */
*   IF LNGTH<1 THEN                 /* IF LENGTH<ONE, OUTPUT         */
         LTR   @10,@10                                             0620
         BNP   @RT00620                                            0620
*     GOTO AMDELMCL;                /* INVALID DELIMITER MESSAGE     */
*   CALL AMDPRHX;                   /* CNVT EXT HEX TO BINARY        */
         L     @15,@CV00421                                        0622
         BALR  @14,@15                                             0622
*   RTVAL=COMP8(3:4);               /* MOVE IN RESULT                */
         MVC   RTVAL(2),COMP8+2                                    0623
*AMDPIN12:                                                         0624
*   ARG=RTVAL;                      /* PROCESSING RIGHT VALUE        */
AMDPIN12 MVC   ARG(2),RTVAL                                        0624
*   RTBIT='1'B;                     /* SET ON RIGHT BIT              */
         OI    RTBIT,B'01000000'                                   0625
*   GOTO AMDPUSR8;                  /* CHECK USR TABLE FOR BLANKS    */
         B     AMDPUSR8                                            0626
*AMDPINS2:                                                         0627
*   IF USRNGTAB(ALLCT,1             /* IF LOWER RANGE VALUE >        */
*       :2)>ARG THEN                /* THAN PROPOSED UPPER VAL       */
AMDPINS2 L     @10,ALLCT                                           0627
         SLA   @10,2                                               0627
         ST    @10,@TF00001                                        0627
         ALR   @10,AEDITCBR                                        0627
         CLC   USRNGTAB-4(2,@10),ARG                               0627
         BH    @RT00627                                            0627
*     GOTO AMDPSR51;                /* OUTPUT INVALID EID MSG        */
*   IF USRNGTAB(ALLCT,3             /* IF UPPER EID NOT FILLED       */
*       :4)=BLANK1 THEN             /* IN, THEN                      */
         LR    @10,AEDITCBR                                        0629
         AL    @10,@TF00001                                        0629
         CLC   USRNGTAB-2(2,@10),BLANK1                            0629
         BNE   @RF00629                                            0629
*     DO;                           /* DO THE FOLLOWING              */
*       USRNGTAB(ALLCT              /* INSERT CURRENT VALUE THERE    */
*           ,3:4)=ARG;                                             0631
         LR    @10,AEDITCBR                                        0631
         AL    @10,@TF00001                                        0631
         MVC   USRNGTAB-2(2,@10),ARG                               0631
*       GOTO AMDPUPRN;              /* CHECK FOR MORE VALUES         */
         B     AMDPUPRN                                            0632
*     END;                          /* UPPER SLOT WAS BLANK          */
*   IF ARG<=USRNGTAB(ALLCT,         /* IF CURRENT VAL WITHIN         */
*       3:4) THEN                   /* UPPER LIMIT, THEN SIMPLY      */
@RF00629 L     @10,ALLCT                                           0634
         LR    @02,@10                                             0634
         SLA   @02,2                                               0634
         ALR   @02,AEDITCBR                                        0634
         CLC   ARG(2),USRNGTAB-2(@02)                              0634
         BNH   @RT00634                                            0634
*     GOTO AMDPUPRN;                /* CHECK FOR MORE VALUES         */
*   IF OVERSL(ALLCT)=BLANK1         /* IF CORRESPONDING SLOT IN      */
*     THEN                          /* OVERLAY TABLE IS BLANK,       */
         ALR   @10,@10                                             0636
         LA    @02,OVERSL-2(@10)                                   0636
         CLC   0(2,@02),BLANK1                                     0636
         BNE   @RF00636                                            0636
*     DO;                           /* DO THE FOLLOWING              */
*AMDPUSR9:                                                         0638
*       OVERSL(ALLCT)=ARG;          /* INSERT CURRENT VALUE THERE    */
AMDPUSR9 L     @10,ALLCT                                           0638
         ALR   @10,@10                                             0638
         LA    @02,OVERSL-2(@10)                                   0638
         MVC   0(2,@02),ARG                                        0638
*       GOTO AMDPUPRN;              /* CHECK FOR MORE VALUES         */
         B     AMDPUPRN                                            0639
*     END;                          /* OVERLTAB SLOT WAS BLNK        */
*   IF ARG<=OVERSL(ALLCT)           /* NON-BLANK SLOT--IF WITHIN     */
*     THEN                          /* RANGE, THEN SIMPLY            */
@RF00636 L     @10,ALLCT                                           0641
         ALR   @10,@10                                             0641
         LA    @02,OVERSL-2(@10)                                   0641
         CLC   ARG(2),0(@02)                                       0641
         BNH   @RT00641                                            0641
*     GOTO AMDPUPRN;                /* CHECK ADDITIONAL VALUES       */
*   GOTO AMDPUSR9;                  /* IF NOT, OVERLAY OVERL SLOT    */
         B     AMDPUSR9                                            0643
*AMDPUSRA:                                                         0644
*   IF RTBIT='1'B THEN              /* DETERMINE WHERE TO            */
AMDPUSRA TM    RTBIT,B'01000000'                                   0644
         BO    @RT00644                                            0644
*     GOTO AMDPINS2;                /* PLACE VALUE                   */
*   IF BOTHBIT='1'B THEN            /* Q/WITHIN RANGE                */
         TM    BOTHBIT,B'00100000'                                 0646
         BO    @RT00646                                            0646
*     GOTO AMDPINS2;                /* YES                           */
*   GOTO AMDPRTVL;                  /* NOW DELIMIT RT VALUE          */
*                                                                  0648
         B     AMDPRTVL                                            0648
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0649
*   END AMDPRSCN                    /* END OF MAIN PROCEDURE         */
*                                                                  0649
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMDPRTAB)                                       */
*/*%INCLUDE SYSLIB  (AMDSCNTB)                                       */
*                                                                  0649
*       ;                                                          0649
         B     @EL00001                                            0649
@DATA    DS    0H
@SM00659 MVC   COMP4(0),KEYWORD(@15)
@SM00663 MVC   KWDCOMP(0),KEYWORD(@15)
@SM00665 MVC   COMP8(0),KEYWORD(@05)
@SC00667 CLC   COMP8(0),0(@15)
@SM00669 MVC   0(0,@02),VAL1(@15)
@SM00671 MVC   CHARWORD(0),VAL1(@02)
@SM00676 MVC   COMP4(0),VAL1(@02)
         DS    0F
@SA00001 DS    18F
@TF00001 DS    F
         DS    0F
@CF00044 DC    F'1'
@CF00077 DC    F'2'
@CF00168 DC    F'3'
@CF00098 DC    F'4'
@CF00085 DC    F'5'
@CF00055 DC    F'7'
@CF00033 DC    F'8'
@CF00166 DC    F'9'
@CF00488 DC    F'10'
@CF00273 DC    F'11'
@CF00399 DC    F'18'
@CF00129 DC    F'20'
@CF00566 DC    F'23'
@CF00582 DC    F'59'
@CF00465 DC    F'72'
@CF00678 DC    F'-8'
@CF00679 DC    F'-4'
@CA00352 DC    A(AMDPRS00)
@CV00386 DC    V(AMDPNAM)
@CV00387 DC    V(AMDPTAJ)
@CV00388 DC    V(AMDPSIO)
@CV00389 DC    V(AMDPSVC)
@CV00390 DC    V(AMDPPGM)
@CV00391 DC    V(AMDPSYS)
@CV00392 DC    V(AMDPEXT)
@CV00393 DC    V(AMDPDSP)
@CV00394 DC    V(AMDPRNIO)
@CV00395 DC    V(AMDPSRM)
@CV00396 DC    V(AMDPRR)
@CV00397 DC    V(AMDPEOF)
@CA00401 DC    A(AMDPRS01)
@CV00417 DC    V(AMDPSUM1)
@CV00418 DC    V(AMDPFIN)
@CV00419 DC    V(AMDPEOC2)
@CV00420 DC    V(AMDPRCVB)
@CV00421 DC    V(AMDPRHX)
@CV00422 DC    V(AMDVLEN)
@CV00423 DC    V(AMDELIM)
@CV00424 DC    V(AMDVLMG)
@CV00425 DC    V(AMDUMMG)
         DS    0D
JOBCT    DS    FL4
         ORG   JOBCT
TCBCT    DS    FL4
         ORG   JOBCT+4
HUNDRED  DC    F'100'
MILLION  DC    F'1000000'
SIXTY    DC    F'60'
THREESIX DC    F'3600'
NUM2604  DC    F'2604'
HALFTIME DC    F'1302'
EIDCT    DS    F
SORTSW   DS    F
@CC00550 DC    C'366'
@CC00593 DC    C'ALL'
         DS    CL6
AMDSCNTB DS    CL414
         ORG   AMDSCNTB
TEMPTAB  DS    CL163
         ORG   TEMPTAB
EXITNAME DS    CL8
DDNM     DS    CL8
STARTSL  DS    CL12
         ORG   STARTSL
TIMEU    DS    CL8
YR       DS    CL2
DY       DS    CL2
         ORG   TEMPTAB+28
STOPSL   DS    CL12
         ORG   STOPSL
TIMERU   DS    CL8
YRSTP    DS    CL2
DYSTP    DS    CL2
         ORG   TEMPTAB+40
OVERLTAB DS    CL40
         ORG   OVERLTAB
OVERSL   DS    20CL2
         ORG   TEMPTAB+80
SIOTFLGS DS    BL1
         ORG   SIOTFLGS
ALLST    DS    BL1
SELST    EQU   SIOTFLGS+0
EQUIVT   EQU   SIOTFLGS+0
NOEQUT   EQU   SIOTFLGS+0
AT       EQU   SIOTFLGS+0
         ORG   TEMPTAB+81
IOTFLGS  DS    BL1
         ORG   IOTFLGS
ALLIT    DS    BL1
SELIT    EQU   IOTFLGS+0
BT       EQU   IOTFLGS+0
         ORG   TEMPTAB+82
USRTFLGS DS    BL1
         ORG   USRTFLGS
ALLUT    DS    BL1
SELUT    EQU   USRTFLGS+0
ET       EQU   USRTFLGS+0
         ORG   TEMPTAB+83
SVCTFLGS DS    BL1
         ORG   SVCTFLGS
ALLVT    DS    BL1
SELVT    EQU   SVCTFLGS+0
GT       EQU   SVCTFLGS+0
         ORG   TEMPTAB+84
PITFLGS  DS    BL1
         ORG   PITFLGS
ALLPT    DS    BL1
SELPT    EQU   PITFLGS+0
T        EQU   PITFLGS+0
         ORG   TEMPTAB+85
SYSTFLGS DS    BL1
         ORG   SYSTFLGS
EXTT     DS    BL1
DSPT     EQU   SYSTFLGS+0
SYST     EQU   SYSTFLGS+0
SYSMT    EQU   SYSTFLGS+0
RNIOT    EQU   SYSTFLGS+0
SRMT     EQU   SYSTFLGS+0
RRT      EQU   SYSTFLGS+0
EOFT     EQU   SYSTFLGS+0
         ORG   TEMPTAB+86
@NM00002 DS    BL2
SIOPTR   DS    AL4
IOPTR    DS    AL4
JOBNPTR  DS    AL4
ASCBPTR  DS    AL4
SIOCRPTR DS    AL4
IOCRPTR  DS    AL4
JOBCRPTR DS    AL4
ASCBCPTR DS    AL4
USRCOUNT DS    FL4
USRCRCNT DS    FL4
SVCSTR   DS    BL32
PISTR    DS    BL2
PISTRB   DS    BL1
         ORG   AMDSCNTB+163
SCNBITS  DC    X'00'
         ORG   SCNBITS
IORTNSW  DS    BL1
MORESW   EQU   SCNBITS+0
SCANBIT  EQU   SCNBITS+0
EQUIND   EQU   SCNBITS+0
RUNEDIT  EQU   SCNBITS+0
PRNSW    EQU   SCNBITS+0
RESBITS  EQU   SCNBITS+0
         ORG   AMDSCNTB+164
CODETABL DS    BL3
         ORG   CODETABL
CXIT     DS    BL1
CDDN     EQU   CODETABL+0
CSTART   EQU   CODETABL+0
CSTOP    EQU   CODETABL+0
CJOBN    EQU   CODETABL+0
CASCB    EQU   CODETABL+0
CUSR     EQU   CODETABL+0
CSIO     EQU   CODETABL+0
CIO      DS    BL1
CSVC     EQU   CODETABL+1
CPI      EQU   CODETABL+1
CSYS     EQU   CODETABL+1
CEXT     EQU   CODETABL+1
CDSP     EQU   CODETABL+1
CRNIO    EQU   CODETABL+1
CSRM     EQU   CODETABL+1
CRR      DS    BL1
CEOF     EQU   CODETABL+2
NOVAL    EQU   CODETABL+2
PAREN    EQU   CODETABL+2
@NM00003 EQU   CODETABL+2
         ORG   AMDSCNTB+168
WORD     DS    FL4
         DS    CL4
DBLWORD  DS    CL8
KWTAB1   DC    CL4'SIO '
         DC    CL4'IO  '
         DC    CL4'SVC '
         DC    CL4'PI  '
         DC    CL4'SYS '
         DC    CL4'EXT '
         DC    CL4'DSP '
         DC    CL4'RNIO'
         DC    CL4'SRM'
         DC    CL4'RR'
         DC    CL4'EOF'
KWTAB2   DC    CL8'EXIT    '
         DC    CL8'DDNAME  '
         DC    CL8'START   '
         DC    CL8'STOP    '
         DC    CL8'JOBNAME '
         DC    CL8'ASCB    '
         DC    CL8'USR     '
         DC    CL8'SIO     '
         DC    CL8'IO      '
         DC    CL8'SVC     '
         DC    CL8'PI      '
BLANK1   DC    CL12'            '
MASKS    DC    X'80'
         DC    X'40'
         DC    X'20'
         DC    X'10'
         DC    X'08'
         DC    X'04'
         DC    X'02'
         DC    X'01'
SCNPTR   DS    AL4
BUFADDR  DS    AL4
ADDRS1   DS    AL4
ADDRS3   DS    AL4
EOCADDR  DS    AL4
LNGTH    DS    FL4
COMP4    DS    CL4
COMP8    DS    CL8
SVKEY    DS    FL4
SAVETAB  DS    AL4
         ORG   SAVETAB
ALLPTR   DS    AL4
         ORG   AMDSCNTB+380
SORTPTR  DS    AL4
SRTTABPT DS    AL4
INCRT    DS    FL4
ALLCT    DS    FL4
I        DS    FL4
J        DS    FL4
INTSTART DS    CL5
INTSTOP  DS    CL5
         ORG   AMDSCNTB+414
CHARRUN  DC    CL7'RUNEDIT'
CHARWORD DS    CL4
BITIND   DC    AL1(0)
         ORG   BITIND
SECIND   DS    BL1
MININD   EQU   BITIND+0
@NM00004 EQU   BITIND+0
         ORG   BITIND+1
USRBITS  DS    BL1
         ORG   USRBITS
LFTBIT   DS    BL1
RTBIT    EQU   USRBITS+0
BOTHBIT  EQU   USRBITS+0
SYMBIT   EQU   USRBITS+0
DASHSW   EQU   USRBITS+0
RSVBITS  EQU   USRBITS+0
         ORG   USRBITS+1
         DS    CL1
LFTVAL   DS    CL2
         DS    CL2
RTVAL    DS    CL2
ARG      DS    CL2
KWDCOMP  DS    CL8
BRTAB    DC    VL4(AMDPNAM)
         DC    VL4(AMDPNAM)
         DC    AL4(AMDPPOS)
         DC    AL4(AMDPPOS)
         DC    VL4(AMDPTAJ)
         DC    VL4(AMDPTAJ)
         DC    AL4(AMDPUSR)
         DC    VL4(AMDPSIO)
         DC    VL4(AMDPSIO)
         DC    VL4(AMDPSVC)
         DC    VL4(AMDPPGM)
         DC    VL4(AMDPSYS)
         DC    VL4(AMDPEXT)
         DC    VL4(AMDPDSP)
         DC    VL4(AMDPRNIO)
         DC    VL4(AMDPSRM)
         DC    VL4(AMDPRR)
         DC    VL4(AMDPEOF)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
KWADDR   EQU   @04
NUMCNT   EQU   @04
COMPLEN  EQU   @04
REM      EQU   @04
AEDITCBR EQU   @09
TTABPTR  EQU   @03
REG1     EQU   @01
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REGPT    EQU   @12
REG15    EQU   @15
REG2     EQU   @02
         ENTRY AMDSCNTB
         EXTRN AMDPRS00
         EXTRN AMDPRS01
AMDPRTAB EQU   0
DEBGFLGS EQU   AMDPRTAB+8
PTHFLGS1 EQU   DEBGFLGS
SCN      EQU   PTHFLGS1
PTHFLGS2 EQU   DEBGFLGS+1
INRFCFGS EQU   DEBGFLGS+2
FLMODE   EQU   INRFCFGS
IOFLGS   EQU   DEBGFLGS+3
STARTIME EQU   AMDPRTAB+40
TIME     EQU   STARTIME
DAY      EQU   STARTIME+10
STOPTIME EQU   AMDPRTAB+52
TIME2    EQU   STOPTIME
DAY2     EQU   STOPTIME+10
NAMES    EQU   AMDPRTAB+64
ADS      EQU   AMDPRTAB+104
AADS     EQU   ADS
SIF      EQU   AMDPRTAB+124
SIOFLGS  EQU   SIF
DVADS1   EQU   AMDPRTAB+128
IO       EQU   AMDPRTAB+228
IOFLGS2  EQU   IO
DVADS2   EQU   AMDPRTAB+232
VCF      EQU   AMDPRTAB+332
SVCFLGS  EQU   VCF
USR      EQU   AMDPRTAB+368
USRFLGS  EQU   USR
ALLU     EQU   USRFLGS
USRTAB   EQU   AMDPRTAB+372
USRNGTAB EQU   USRTAB
PI       EQU   AMDPRTAB+452
PIFLGS   EQU   PI
PGMNGEN  EQU   AMDPRTAB+456
GENFLAGS EQU   PGMNGEN+3
GENFLGS1 EQU   AMDPRTAB+460
ESTARTME EQU   AMDPRTAB+500
ESTOPTME EQU   AMDPRTAB+509
AMDPRSYN EQU   0
MSGADDR  EQU   0
ERRBUF   EQU   0
VAL1     EQU   0
SCNCHAR  EQU   0
KEYWORD  EQU   0
AMDPROOT EQU   0
FIVECHAR EQU   0
KWRTN    EQU   0
DEVICE   EQU   0
AD1      EQU   AMDPRS00
AD2      EQU   AMDPRS00+4
AD8      EQU   AMDPRS00+28
AD9      EQU   AMDPRS00+32
EIDNAM0  EQU   AMDPRS01
LRANGE0  EQU   AMDPRS01+4
HRANGE0  EQU   AMDPRS01+6
GNOSTDMG EQU   SWD
GCONTSW  EQU   SWD
X1       EQU   CODETABL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
GRDRSW   EQU   SWA
GSETCVTS EQU   SWA
GPRNTSW  EQU   SWA
GGOSW    EQU   SWA
GTSOSW   EQU   SWA
GJBNMSW  EQU   SWA
GREAD    EQU   SWA
GSTORSW  EQU   SWA
GFRBUFSW EQU   SWD
GGPRSFND EQU   SWD
GPREFMTD EQU   SWD
GNCDUMP  EQU   SWD
GSWPDCBC EQU   SWD
GFLSHMOD EQU   SWD
AD11     EQU   AMDPRS00+40
AD10     EQU   AMDPRS00+36
AD7      EQU   AMDPRS00+24
AD6      EQU   AMDPRS00+20
AD5      EQU   AMDPRS00+16
AD4      EQU   AMDPRS00+12
AD3      EQU   AMDPRS00+8
RESERVED EQU   AMDPRTAB+522
CVTTZONE EQU   AMDPRTAB+518
ESPSEC   EQU   ESTOPTME+7
ESPMIN   EQU   ESTOPTME+5
ESPHR    EQU   ESTOPTME+3
ESPDAY   EQU   ESTOPTME
ESSEC    EQU   ESTARTME+7
ESMIN    EQU   ESTARTME+5
ESHR     EQU   ESTARTME+3
ESDAY    EQU   ESTARTME
ADTSBUF  EQU   AMDPRTAB+496
OFSTDATA EQU   AMDPRTAB+494
OFSTEID  EQU   AMDPRTAB+492
AFRMAD   EQU   AMDPRTAB+488
REENTWKA EQU   AMDPRTAB+484
PRFMTADD EQU   AMDPRTAB+480
AEIOCT   EQU   AMDPRTAB+476
EXITADDR EQU   AMDPRTAB+472
EXITNM   EQU   AMDPRTAB+464
RECDLL   EQU   AMDPRTAB+461
@NM00001 EQU   GENFLGS1
FIRSTHSW EQU   GENFLGS1
TSFOUND  EQU   GENFLGS1
EOFINPRO EQU   GENFLGS1
TS       EQU   GENFLGS1
EOF      EQU   GENFLAGS
RR       EQU   GENFLAGS
SRM      EQU   GENFLAGS
RNIO     EQU   GENFLAGS
SYSM     EQU   GENFLAGS
SYS      EQU   GENFLAGS
DSP      EQU   GENFLAGS
EXT      EQU   GENFLAGS
PICODEA  EQU   PGMNGEN+2
PICODES  EQU   PGMNGEN
Q        EQU   PI+1
P01R     EQU   PIFLGS
SELP     EQU   PIFLGS
ALLP     EQU   PIFLGS
O        EQU   USR+1
N01R     EQU   USRFLGS
SELU     EQU   USRFLGS
SVCNUMS  EQU   AMDPRTAB+336
M        EQU   VCF+1
L        EQU   SVCFLGS
SELV     EQU   SVCFLGS
ALLV     EQU   SVCFLGS
IODVADS  EQU   DVADS2
K01RES   EQU   IO+1
JJ       EQU   IOFLGS2
SELI     EQU   IOFLGS2
ALLI     EQU   IOFLGS2
SIODVADS EQU   DVADS1
II       EQU   SIF+1
H        EQU   SIOFLGS
NOEQU    EQU   SIOFLGS
EQUIV    EQU   SIOFLGS
SELS     EQU   SIOFLGS
ALLS     EQU   SIOFLGS
ASCBADDR EQU   AADS
JOBNAMES EQU   NAMES
F        EQU   STOPTIME+8
D        EQU   STARTIME+8
DDNAME   EQU   AMDPRTAB+32
USEREXIT EQU   AMDPRTAB+24
GTFWDPTR EQU   AMDPRTAB+20
C        EQU   DEBGFLGS+4
B        EQU   IOFLGS
GETEOF   EQU   IOFLGS
DMDFMT   EQU   INRFCFGS
EDITSTOP EQU   INRFCFGS
EXTTRC   EQU   INRFCFGS
RET      EQU   INRFCFGS
FMT      EQU   INRFCFGS
SPIE     EQU   INRFCFGS
TERM     EQU   INRFCFGS
REMAIN   EQU   PTHFLGS2
APP      EQU   PTHFLGS2
REXT     EQU   PTHFLGS1
FRM      EQU   PTHFLGS1
FLT      EQU   PTHFLGS1
HEX      EQU   PTHFLGS1
CON      EQU   PTHFLGS1
GET      EQU   PTHFLGS1
ROOT     EQU   PTHFLGS1
CURREC   EQU   AMDPRTAB+4
AFMG     EQU   AMDPRTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00062 EQU   AMDPSCN1
@RT00103 EQU   AMDSUMCL
@RT00105 EQU   AMDPSTR1
@RT00108 EQU   AMDPSTT
AMDNRET  EQU   @EL00001
@RT00113 EQU   AMDPSTR3
@RT00116 EQU   AMDPSTR2
@RT00128 EQU   AMDPRES2
@RT00130 EQU   AMDPRES2
@RT00132 EQU   AMDPRES2
@RT00140 EQU   AMDPRES3
@RT00143 EQU   AMDPRES3
@RT00150 EQU   AMDPRES4
@RT00152 EQU   AMDPBDKW
@RT00154 EQU   AMDPCLS1
@RT00158 EQU   AMDPKW1
@RF00179 EQU   AMDPCK1
@RT00185 EQU   AMDPBDKW
@RT00188 EQU   AMDPEC1L
@RT00190 EQU   AMDPRS51
@RT00197 EQU   CONT
@RT00206 EQU   AMDPMTD
@RT00208 EQU   AMDPMTC2
@RT00211 EQU   AMDPMTD
@RT00217 EQU   AMDPEOC
@RT00232 EQU   AMDPCHK6
@RT00236 EQU   AMDPLN
@RT00238 EQU   AMDPLN
@RT00241 EQU   AMDPCHK6
@RT00243 EQU   AMDPCLS1
@RT00245 EQU   AMDPEC1L
@RT00247 EQU   AMDPCLS1
@RT00251 EQU   AMDPCHK5
@RT00256 EQU   AMDPEC1L
@RT00265 EQU   AMDPKW2
@RT00276 EQU   AMDPPOS
@RT00278 EQU   AMDPUSR
@RT00283 EQU   AMDPPOS1
@RT00285 EQU   AMDPEOC1
AMDC1CAL EQU   AMDPEOC1
@RT00289 EQU   AMDPEOC1
@RT00292 EQU   AMDPPOS3
@RT00294 EQU   AMDPPOS3
@RT00326 EQU   AMDPSLT
@RT00328 EQU   AMDPSLT
@RT00332 EQU   AMDPPOS6
@RT00339 EQU   AMDELMCL
@RT00341 EQU   AMDPPOS6
@RT00346 EQU   AMDVLNCL
@RT00348 EQU   AMDELMCL
@RT00350 EQU   AMDVLNCL
@RT00360 EQU   AMDPPOS8
@RT00362 EQU   AMDVMGCL
@RC00381 EQU   AMDPEOC1
@RT00411 EQU   AMDPPOSA
@RT00413 EQU   AMDPOSA1
@RT00417 EQU   AMDPPOSB
@RT00419 EQU   AMDPOSA1
@RT00422 EQU   AMDTIMSG
@RT00424 EQU   AMDTIMSG
@RF00424 EQU   AMDPEOC1
@RT00427 EQU   AMDTIMSG
@RT00429 EQU   AMDTIMSG
@RF00429 EQU   AMDPEOC1
@RT00432 EQU   AMDTIMSG
@RT00434 EQU   AMDTIMSG
@RF00434 EQU   AMDPEOC1
@RT00441 EQU   AMDVMGCL
@RT00452 EQU   AMDPCK1
@RT00468 EQU   AMDPUSR3
@RT00470 EQU   AMDPUSR3
@RT00475 EQU   AMDVLNCL
@RT00477 EQU   AMDELMCL
@RT00481 EQU   AMDPUSR4
@RT00487 EQU   AMDDASH
@RT00489 EQU   AMDPEND2
@RT00491 EQU   AMDPSYMB
@RT00495 EQU   AMDELMCL
@RT00504 EQU   AMDPSR51
@RF00511 EQU   AMDINPRN
@RT00534 EQU   AMDVLNCL
@RT00540 EQU   AMDPFND
@RF00548 EQU   AMDPUSR7
@RT00562 EQU   AMDPINS
@RT00564 EQU   AMDPUSRA
@RT00566 EQU   AMDPINS2
@RT00569 EQU   AMDEXCAL
@RT00574 EQU   AMDVLNCL
@RT00576 EQU   AMDELMCL
@RT00594 EQU   AMDPEOC1
@RT00596 EQU   AMDPEOC1
@RT00602 EQU   AMDPINS2
@RT00607 EQU   AMDPIN12
@RT00611 EQU   AMDPIN11
@RT00613 EQU   AMDPIN11
@RT00618 EQU   AMDVLNCL
@RT00620 EQU   AMDELMCL
@RT00627 EQU   AMDPSR51
@RT00634 EQU   AMDPUPRN
@RT00641 EQU   AMDPUPRN
@RT00644 EQU   AMDPINS2
@RT00646 EQU   AMDPINS2
@ENDDATA EQU   *
         END   AMDPRSCN,(C'PLS0957',0701,77255)

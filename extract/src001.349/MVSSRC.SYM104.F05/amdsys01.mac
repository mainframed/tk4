         TITLE 'AMDSYS01 - EDIT SYS SVC FORMAT APPENDAGE               *
                        '
AMDSYS01 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'AMDSYS01  76.069'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @11,0                                            01S0001
@PSTART  LA    @12,4095(,@11)                                   01S0001
         LA    @08,4095(,@12)                                   01S0001
         USING @PSTART,@11                                      01S0001
         USING @PSTART+4095,@12                                 01S0001
         USING @PSTART+8190,@08                                 01S0001
*   PLISTPTR=R1;                    /* ADDR OF PLIST PASSED BY CALLER*/
         LR    PLISTPTR,R1                                      01S0154
*   R10=DYNAMSTG;                   /* ADDR OF GETMAINED AREA        */
         L     R10,DYNAMSTG(,PLISTPTR)                          01S0155
*   GEN SETS(R13,R15);                                          01S0156
         USING @DATD,R10             ADDRESSABILITY FOR DYNAM VARIABLES
         ST    R13,@SA00001+4
         LA    R15,@SA00001
         ST    R15,8(R13)
         LR    R13,R15
*   ABDPLPTR=SNAPPARM;              /* ADDR OF PARMLIST              */
         L     @14,SNAPPARM(,PLISTPTR)                          01S0157
         ST    @14,ABDPLPTR(,PLISTPTR)                          01S0157
*   IF TIMESW=0 THEN                /* IS THIS THE FIRST PASS        */
         ICM   @14,3,TIMESW                                     01S0158
         BNZ   @RF00158                                         01S0158
*     DO;                           /* YES - CHECK TO SEE IF THIS SVC
*                                      IS TO BE PROCESSED            */
*                                                               02S0160
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF THIS SVC RECORD SHOULD BE PROCESSED          */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0160
*       IF ERRECORD='EEEE'X THEN    /* IS ENTIRE RECORD IN ERROR     */
         L     @14,DATAPTR(,PLISTPTR)                           02S0160
         CLC   ERRECORD(2,@14),@CB01365                         02S0160
         BNE   @RF00160                                         02S0160
*         RETCODE=12;               /* YES - INDICATES TO PRINT 02S0161
*                                      RECORD IN HEX                 */
         LA    RETCODE,12                                       02S0161
*       ELSE                        /* NO - RECORD IS OK             */
*         DO;                                                   02S0162
         B     @RC00160                                         02S0162
@RF00160 DS    0H                                               02S0163
*           IF ALLV=ON THEN         /* ARE ALL SVCS BEING TRACED     */
         TM    ALLV(AEDITCBR),B'10000000'                       02S0163
         BNO   @RF00163                                         02S0163
*             RETCODE=0;            /* YES - INDICATES TO FORMAT THIS
*                                      RECORD                        */
         SLR   RETCODE,RETCODE                                  02S0164
*           ELSE                    /* NO - CHECK TABLE OF SVCS      */
*             DO;                                               02S0165
         B     @RC00163                                         02S0165
@RF00163 DS    0H                                               02S0166
*               I=SYSSVC/8;         /* CALCULATE BYTE                */
         L     @14,DATAPTR(,PLISTPTR)                           02S0166
         SLR   @05,@05                                          02S0166
         IC    @05,SYSSVC(,@14)                                 02S0166
         LR    I,@05                                            02S0166
         SRL   I,3                                              02S0166
*               J=SYSSVC//8;        /* CALCULATE BIT IN BYTE         */
         LR    @02,@05                                          02S0167
         SRDA  @02,32                                           02S0167
         D     @02,@CF00034                                     02S0167
         LR    J,@02                                            02S0167
*               IF(SVCLIST(I+1)&HEXTEST(J+1))^=0 THEN/* IS THIS SVC
*                                      BEING TRACED                  */
         SLR   @14,@14                                          02S0168
         LR    @05,J                                            02S0168
         ALR   @05,@05                                          02S0168
         LH    @05,HEXTEST(@05)                                 02S0168
         SLR   @03,@03                                          02S0168
         IC    @03,SVCLIST(I,AEDITCBR)                          02S0168
         NR    @05,@03                                          02S0168
         CR    @05,@14                                          02S0168
         BE    @RF00168                                         02S0168
*                 RETCODE=0;        /* YES - INDICATES TO FORMAT THIS
*                                      SVC                           */
         LR    RETCODE,@14                                      02S0169
*               ELSE                /* NO - THIS SVC ISN'T BEING
*                                      TRACED                        */
*                 RETCODE=8;        /* INDICATES TO SKIP THIS AND GET
*                                      NEXT SVC RECORD               */
         B     @RC00168                                         02S0170
@RF00168 LA    RETCODE,8                                        02S0170
*             END;                                              02S0171
@RC00168 DS    0H                                               02S0172
*         END;                                                  02S0172
@RC00163 DS    0H                                               02S0173
*       IF RETCODE=0 THEN           /* IS THIS SVC TO BE FORMATTED   */
@RC00160 LTR   RETCODE,RETCODE                                  01S0173
         BNZ   @RF00173                                         01S0173
*         DO;                       /* YES - FORMAT THE FIRST LINE   */
*                                                               02S0175
*           /*********************************************************/
*           /*                                                       */
*           /* FORMAT THE FIRST LINE OF THE BASIC RECORD             */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0175
*           CNVTSVC=SYSSVC;         /* MOVE SVC NUMB FOR CONVERT     */
         L     @14,DATAPTR(,PLISTPTR)                           02S0175
         SLR   CNVTSVC,CNVTSVC                                  02S0175
         IC    CNVTSVC,SYSSVC(,@14)                             02S0175
*           CVD(CNVTSVC,PAKEDSVC);  /* CONVERT TO DECIMAL            */
         CVD   CNVTSVC,@TS00001                                 02S0176
         MVC   PAKEDSVC(2),@TS00001+6                           02S0176
*           UNPK(UNPAKTO,UNPAKFRM); /* UNPACK SVC NUMBER             */
         UNPK  UNPAKTO(5),UNPAKFRM(3)                           02S0177
*           ADPLFMT2=ADDR(UNPAKTO); /* ADDR OF DECIMAL SVC NUMBER    */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0178
         LA    @07,UNPAKTO                                      02S0178
         ST    @07,ADPLFMT2(,@14)                               02S0178
*           R0=ADDR(SVCTITLE);      /* ADDR OF FORMAT PATTERN        */
         LA    R0,SVCTITLE                                      02S0179
*           R1=ABDPLPTR;            /* ADDR OF ABDUMP PLIST FOR 02S0180
*                                      AMDPRFMT                      */
         LR    R1,@14                                           02S0180
*           CALL AMDPRFMT;          /* FORMAT SVC TITLE              */
         L     @15,FMTADDR(,PLISTPTR)                           02S0181
         BALR  @14,@15                                          02S0181
*           ADPLFMT2=DATAPTR;       /* ADDR OF DATA IN BUFFER        */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0182
         MVC   ADPLFMT2(4,@14),DATAPTR(PLISTPTR)                02S0182
*           R0=ADDR(FIRSTLN);       /* ADDR OF PATTERNS FOR FIRST
*                                      LINE                          */
         LA    R0,FIRSTLN                                       02S0183
*           CALL AMDPRFMT;          /* FORMAT FIRST LINE             */
         L     @15,FMTADDR(,PLISTPTR)                           02S0184
         BALR  @14,@15                                          02S0184
*           CALL SVCFORMX;          /* CHECK FOR ADDITIONAL DATA TO
*                                      BE FORMATTED                  */
         BAL   @14,SVCFORMX                                     01S0185
*         END;                                                  01S0186
*     END;                                                      01S0187
*   ELSE                                                        01S0188
*     DO;                           /* NO - THIS IS NOT THE FIRST
*                                      PASS                          */
         B     @RC00158                                         01S0188
@RF00158 DS    0H                                               01S0189
*       IF TIMESW=1 THEN            /* IS THIS THE SECOND PASS       */
         CLC   TIMESW(2),@CH00046                               01S0189
         BNE   @RF00189                                         01S0189
*         DO;                       /* YES - FORMAT THE REGS         */
*                                                               02S0191
*           /*********************************************************/
*           /*                                                       */
*           /* FORMAT THE SECOND LINE OF THE BASIC RECORD            */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0191
*           ADPLFMT1=ADDR(LBASICL2);/* ADDR OF LABELS FOR THIS LINE  */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0191
         LA    @07,LBASICL2                                     02S0191
         ST    @07,ADPLFMT1(,@14)                               02S0191
*           ADPLFMT2=ADDR(R15FLD);  /* ADDR OF DATA IN BUFFER        */
         L     @07,DATAPTR(,PLISTPTR)                           02S0192
         LA    @07,R15FLD(,@07)                                 02S0192
         ST    @07,ADPLFMT2(,@14)                               02S0192
*           R0=ADDR(SECONDLN);      /* ADDR OF PATTERNS FOR SECOND
*                                      LINE                          */
         LA    R0,SECONDLN                                      02S0193
*           R1=ABDPLPTR;            /* ADDR OF ABDUMP PLIST FOR 02S0194
*                                      AMDPRFMT                      */
         LR    R1,@14                                           02S0194
*           CALL AMDPRFMT;          /* FORMAT REGISTERS              */
         L     @15,FMTADDR(,PLISTPTR)                           02S0195
         BALR  @14,@15                                          02S0195
*         END;                                                  01S0196
*       CALL SVCFORMX;              /* CHECK FOR ADDITIONAL DATA TO
*                                      BE FORMATTED                  */
@RF00189 BAL   @14,SVCFORMX                                     01S0197
*     END;                                                      01S0198
*   IF RETCODE=0 THEN               /* IS ANOTHER PASS NECESSARY     */
@RC00158 LTR   RETCODE,RETCODE                                  01S0199
         BNZ   @RF00199                                         01S0199
*     TIMESW=TIMESW+1;              /* YES - INDICATES TO PROCESS
*                                      SUBSEQUENT PASSES             */
         LA    @14,1                                            01S0200
         AH    @14,TIMESW                                       01S0200
         STH   @14,TIMESW                                       01S0200
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER WITH RETURN
*                                      CODE                          */
@RF00199 L     @13,4(,@13)                                      01S0201
         L     @14,12(,@13)                                     01S0201
         LM    @00,@12,20(@13)                                  01S0201
         BR    @14                                              01S0201
*                                                               02S0202
*   /*****************************************************************/
*   /*                                                               */
*   /* USING THE SVC NUMBER IN THE BASIC RECORD BRANCH TO THE        */
*   /* SPECIFIC ROUTINE AND DETERMINE WHAT ADDITIONAL DATA IS TO BE  */
*   /* FORMATTED                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0202
*SVCFORMX:                                                      02S0202
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                            02S0202
SVCFORMX DS    0H                                               02S0203
*   RESPECIFY                                                   02S0203
*     R14 RESTRICTED;                                           02S0203
*   SAVER14=R14;                    /* SAVE RETURN POINT ADDR        */
         ST    R14,SAVER14                                      02S0204
*   RESPECIFY                                                   02S0205
*     R14 UNRESTRICTED;                                         02S0205
*   R1=ABDPLPTR;                    /* ADDR OF ABDUMP PLIST FOR 02S0206
*                                      AMDPRFMT                      */
         L     R1,ABDPLPTR(,PLISTPTR)                           02S0206
*   SVCNUMBR=SYSSVC;                /* SVC NUMBER FOR BRANCH TABLE   */
         L     @14,DATAPTR(,PLISTPTR)                           02S0207
         SLR   SVCNUMBR,SVCNUMBR                                02S0207
         IC    SVCNUMBR,SYSSVC(,@14)                            02S0207
*   IF SVCNUMBR^='FF'X THEN         /* IS THIS SVC 255               */
         CH    SVCNUMBR,@CH01372                                02S0208
         BE    @RF00208                                         02S0208
*     SVCNUMBR=SVCNUMBR+1;          /* NO - INCREMENT SVC NUMBER FOR
*                                      BRANCH TABLE                  */
         AH    SVCNUMBR,@CH00046                                02S0209
*   DO;                             /* CASE(SVCNUMBR)NAMES(S00,GP2,GP
*                                      2,G1,GP2,GP2,S06,S06,S08,S08,G
*                                      1,G1,G1,S13,S14,S15,S16,GP2,GP
*                                      2,GP2,GP2,S21,GP2,GP2,GP3,S25,
*                                      S26,S27,S13,S29,S30,GP3,S32,S3
*                                      2,G1,GP2,G1,GP2,G1,GP2,GP2,S08
*                                      ,S42,G1,S44,GP2,G1,GP2,S48,G1,
*                                      G1,GP2,S52,GP3,S00,GP3,S48,GP3
*                                      ,GP3,G1,GP2,G1,S44,GP2,GP2,G1,
*                                      S66,G1,S13,GP3,GP2,S71,G1,GP2,
*                                      GP2,S75,G1,G1,S32,G1,GP2,S71,S
*                                      82,G1,G1,G1,S86,GP2,S88,G1,G1,
*                                      G1,S00,G1,G1,G1,GP2,G1,S98,G1,
*                                      G1,G1,GP2,G1,G1,G1,G1,G1,G1,G1
*                                      ,G1,G1,G1,G1,S00,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G
*                                      1,G1,G1,G1,G1,G1)             */
@RF00208 DS    0H                                               02S0211
*     DCL                                                       02S0211
*       CL0001@ LABEL BASED(CP0001@(SVCNUMBR)) VALUERANGE(S00,GP2,GP2,
*           G1,GP2,GP2,S06,S06,S08,S08,G1,G1,G1,S13,S14,S15,S16,GP2,GP2
*           ,GP2,GP2,S21,GP2,GP2,GP3,S25,S26,S27,S13,S29,S30,GP3,S32,
*           S32,G1,GP2,G1,GP2,G1,GP2,GP2,S08,S42,G1,S44,GP2,G1,GP2,S48,
*           G1,G1,GP2,S52,GP3,S00,GP3,S48,GP3,GP3,G1,GP2,G1,S44,GP2,GP2
*           ,G1,S66,G1,S13,GP3,GP2,S71,G1,GP2,GP2,S75,G1,G1,S32,G1,GP2,
*           S71,S82,G1,G1,G1,S86,GP2,S88,G1,G1,G1,S00,G1,G1,G1,GP2,G1,
*           S98,G1,G1,G1,GP2,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,S00,G1,G1
*           ,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,
*           G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1
*           ,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,
*           G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1
*           ,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,
*           G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1
*           ,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,
*           G1,G1);                 /* BRANCH TARGET                 */
*     DCL                                                       02S0212
*       CP0001@(255) PTR(31) INIT(ADDR(S00),ADDR(GP2),ADDR(GP2),ADDR(G1
*           ),ADDR(GP2),ADDR(GP2),ADDR(S06),ADDR(S06),ADDR(S08),ADDR(
*           S08),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(S13),ADDR(S14),ADDR(
*           S15),ADDR(S16),ADDR(GP2),ADDR(GP2),ADDR(GP2),ADDR(GP2),ADDR
*           (S21),ADDR(GP2),ADDR(GP2),ADDR(GP3),ADDR(S25),ADDR(S26),
*           ADDR(S27),ADDR(S13),ADDR(S29),ADDR(S30),ADDR(GP3),ADDR(S32)
*           ,ADDR(S32),ADDR(G1),ADDR(GP2),ADDR(G1),ADDR(GP2),ADDR(G1),
*           ADDR(GP2),ADDR(GP2),ADDR(S08),ADDR(S42),ADDR(G1),ADDR(S44),
*           ADDR(GP2),ADDR(G1),ADDR(GP2),ADDR(S48),ADDR(G1),ADDR(G1),
*           ADDR(GP2),ADDR(S52),ADDR(GP3),ADDR(S00),ADDR(GP3),ADDR(S48)
*           ,ADDR(GP3),ADDR(GP3),ADDR(G1),ADDR(GP2),ADDR(G1),ADDR(S44),
*           ADDR(GP2),ADDR(GP2),ADDR(G1),ADDR(S66),ADDR(G1),ADDR(S13),
*           ADDR(GP3),ADDR(GP2),ADDR(S71),ADDR(G1),ADDR(GP2),ADDR(GP2),
*           ADDR(S75),ADDR(G1),ADDR(G1),ADDR(S32),ADDR(G1),ADDR(GP2),
*           ADDR(S71),ADDR(S82),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(S86),
*           ADDR(GP2),ADDR(S88),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(S00),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(GP2),ADDR(G1),ADDR(S98),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(GP2),ADDR(G1),ADDR(G1),ADDR
*           (G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(S00),ADDR(G1),ADDR(G1),ADDR(G1),ADDR
*           (G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1));
*     GOTO CL0001@;                 /* BRANCH TO SELECTED CASE       */
         LR    @14,SVCNUMBR                                     02S0213
         SLA   @14,2                                            02S0213
         L     @14,CP0001@-4(@14)                               02S0213
         BR    @14                                              02S0213
*                                                               02S0214
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS:               */
*     /* 3,10,11,12,34,36,38,43,46,49,50,59,61,65,72,76,77,79,83, 84,*/
*     /* 85,89,90,91,93,94,95,97,99,100,101,103,104,105,106,107,108, */
*     /* 109,110,111,112,113,115,116,117,118,119,120,121,122,123,124.*/
*     /* IT WILL ALSO PROCESS ALL USER SVCS - 128 - 255. THE         */
*     /* FORMATTING CONSISTS OF ONLY THE BASIC RECORD.               */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0214
*G1:                                                            02S0214
*     DO;                           /* SUBCASE                       */
G1       DS    0H                                               02S0215
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */
         SLR   @14,@14                                          02S0215
         CH    @14,TIMESW                                       02S0215
         BNE   @RF00215                                         02S0215
*         RETCODE=0;                /* YES - INDICATES TO PRINT 02S0216
*                                      BUFFER AND RETURN FOR SECOND
*                                      PASS                          */
         LR    RETCODE,@14                                      02S0216
*       ELSE                                                    02S0217
*         RETCODE=4;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND GET NEXT RECORD           */
         B     @RC00215                                         02S0217
@RF00215 LA    RETCODE,4                                        02S0217
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0218
*     END G1;                       /* END OF SUBCASE                */
*                                                               02S0220
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS:               */
*     /* 1,2,4,5,17,18,19,20,22,23,35,37,39,40,45,47,51,60,63,64,    */
*     /* 70,73,74,80,87,96,102. THE FORMATTING CONSISTS OFTHE BASIC  */
*     /* RECORD + A VARIABLE LENGTH PARAMETER LIST.                  */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0220
*GP2:                                                           02S0220
*     DO;                           /* SUBCASE                       */
GP2      DS    0H                                               02S0221
*       IF TIMESW=0×TIMESW=1 THEN   /* HAS BASIC RECORD BEEN    02S0221
*                                      FORMATTED                     */
         LH    @14,TIMESW                                       02S0221
         LTR   @14,@14                                          02S0221
         BZ    @RT00221                                         02S0221
         CH    @14,@CH00046                                     02S0221
         BNE   @RF00221                                         02S0221
@RT00221 DS    0H                                               02S0222
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         SLR   RETCODE,RETCODE                                  02S0222
*       ELSE                                                    02S0223
*         DO;                       /* YES - CHECK LENGTH AND MODIFY
*                                      PATTERN ACCORDINGLY           */
         B     @RC00221                                         02S0223
@RF00221 DS    0H                                               02S0224
*           IF GRP2LNTH=0 THEN      /* IS THERE A PLIST              */
         L     @14,DATAPTR(,PLISTPTR)                           02S0224
         CLI   GRP2LNTH+46(@14),0                               02S0224
         BNE   @RF00224                                         02S0224
*             R0=ADDR(GP2NA);       /* NO - ADDR OF PATTERN FOR THIS
*                                      LINE                          */
         LA    R0,GP2NA                                         02S0225
*           ELSE                                                02S0226
*             DO;                   /* YES - THERE IS A PLIST        */
         B     @RC00224                                         02S0226
@RF00224 DS    0H                                               02S0227
*               DYNAMPTN(1:LENGTH(GRP2LN3))=GRP2LN3;/* MOVE PATTERN
*                                      TO GETMAIN AREA               */
         MVC   DYNAMPTN(41),GRP2LN3                             02S0227
*               ADPLFMT2=ADDR(GRP2LNTH)+1;/* ADDR OF DATA IN BUFFER  */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0228
         L     @07,DATAPTR(,PLISTPTR)                           02S0228
         LA    @05,47                                           02S0228
         ALR   @05,@07                                          02S0228
         ST    @05,ADPLFMT2(,@14)                               02S0228
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S0229
*               IF GRP2LNTH=ERROR THEN/* IS FIELD IN ERROR           */
         CLI   GRP2LNTH+46(@07),255                             02S0230
         BNE   @RF00230                                         02S0230
*                 DO;               /* YES - ONLY FORMAT 4 BYTES     */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0232
         IC    @14,OLDFLG                                       02S0232
         O     @14,@CF00092                                     02S0232
         STC   @14,OLDFLG                                       02S0232
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0233
*                 END;                                          02S0234
*               ELSE                                            02S0235
*                 DO;               /* NO - DETERMINE HOW MANY BYTES
*                                      IN PLIST                      */
         B     @RC00230                                         02S0235
@RF00230 DS    0H                                               02S0236
*                   IF GRP2LNTH<4 THEN/* IS PLIST LESS THAN ONE WORD */
         LA    @14,46                                           02S0236
         AL    @14,DATAPTR(,PLISTPTR)                           02S0236
         CLI   GRP2LNTH(@14),4                                  02S0236
         BNL   @RF00236                                         02S0236
*                     DO;           /* YES                           */
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA LENGTH
*                                      TO 0                          */
         SLR   @07,@07                                          02S0238
         IC    @07,OLDLN                                        02S0238
         N     @07,@CF00297                                     02S0238
         STC   @07,OLDLN                                        02S0238
*                       OLDLN(1)=OLDLN(1)×(GRP2LNTH-1);/* NEW DATA
*                                      LENGTH                        */
         SLR   @05,@05                                          02S0239
         IC    @05,GRP2LNTH(,@14)                               02S0239
         BCTR  @05,0                                            02S0239
         OR    @07,@05                                          02S0239
         STC   @07,OLDLN                                        02S0239
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0240
*                     END;                                      02S0241
*                   ELSE                                        02S0242
*                     DO;           /* NO - MODIFY PATTERNS          */
         B     @RC00236                                         02S0242
@RF00236 DS    0H                                               02S0243
*                       K=GRP2LNTH/4;/* NUMBER OF FULL WORDS         */
         L     @14,DATAPTR(,PLISTPTR)                           02S0243
         SLR   @05,@05                                          02S0243
         IC    @05,GRP2LNTH+46(,@14)                            02S0243
         LR    K,@05                                            02S0243
         SRL   K,2                                              02S0243
*                       MOD=GRP2LNTH//4;/* REMAINDER OF PARTIAL WORD */
         LR    @02,@05                                          02S0244
         SRDA  @02,32                                           02S0244
         D     @02,@CF00099                                     02S0244
         LR    MOD,@02                                          02S0244
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */
         SLR   @14,@14                                          02S0245
         CR    MOD,@14                                          02S0245
         BNE   @RF00245                                         02S0245
*                         OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0246
         SLA   @07,2                                            02S0246
         STC   @14,OLDFLG(@07)                                  02S0246
*                       ELSE                                    02S0247
*                         DO;       /* NO - MODIFY PATTERNS     02S0247
*                                      ACCORDINGLY                   */
         B     @RC00245                                         02S0247
@RF00245 DS    0H                                               02S0248
*                           OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET DATA
*                                      LENGTH TO ZERO                */
         LR    @14,K                                            02S0248
         SLA   @14,2                                            02S0248
         SLR   @05,@05                                          02S0248
         IC    @05,OLDLN(@14)                                   02S0248
         N     @05,@CF00297                                     02S0248
         STC   @05,OLDLN(@14)                                   02S0248
*                           OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW DATA
*                                      LENGTH                        */
         LR    @03,MOD                                          02S0249
         BCTR  @03,0                                            02S0249
         OR    @05,@03                                          02S0249
         STC   @05,OLDLN(@14)                                   02S0249
*                           OLDFLG(K+2)=0;/* INDICATE END OF PATTERNS*/
         SLR   @07,@07                                          02S0250
         STC   @07,OLDFLG+4(@14)                                02S0250
*                         END;                                  02S0251
*                     END;                                      02S0252
@RC00245 DS    0H                                               02S0253
*                 END;                                          02S0253
@RC00236 DS    0H                                               02S0254
*             END;                                              02S0254
@RC00230 DS    0H                                               02S0255
*           ADPLFMT1=ADDR(GROUP2);  /* LABEL FOR THIS LINE           */
@RC00224 L     @14,ABDPLPTR(,PLISTPTR)                          02S0255
         LA    @07,GROUP2                                       02S0255
         ST    @07,ADPLFMT1(,@14)                               02S0255
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0256
         BALR  @14,@15                                          02S0256
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0257
*         END;                                                  02S0258
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0259
*     END GP2;                      /* END OF SUBCASE                */
*                                                               02S0261
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS:               */
*     /* 24,31,53,55,57, 58,69. THE FORMATTING CONSISTS OF THE BASIC */
*     /* RECORD + A DDNAME                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0261
*GP3:                                                           02S0261
*     DO;                           /* SUBCASE                       */
GP3      DS    0H                                               02S0262
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */
         ICM   @14,3,TIMESW                                     02S0262
         BNZ   @RF00262                                         02S0262
*         DO;                       /* YES - FORMAT DDNAME           */
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0264
         LA    @07,LDDNL1                                       02S0264
         ST    @07,ADPLFMT1(,@14)                               02S0264
*           ADPLFMT2=ADDR(GRP3DDN); /* ADDR OF DDNAME IN RECORD      */
         LA    @07,46                                           02S0265
         AL    @07,DATAPTR(,PLISTPTR)                           02S0265
         ST    @07,ADPLFMT2(,@14)                               02S0265
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */
         LA    R0,DDNLN1                                        02S0266
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0267
         BALR  @14,@15                                          02S0267
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR SECOND PASS        */
         SLR   RETCODE,RETCODE                                  02S0268
*         END;                                                  02S0269
*       ELSE                                                    02S0270
*         RETCODE=4;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND GET NEXT RECORD           */
         B     @RC00262                                         02S0270
@RF00262 LA    RETCODE,4                                        02S0270
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0271
*     END GP3;                      /* END OF SUBCASE                */
*                                                               02S0273
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 0,54,92,114.  */
*     /* THE FORMATTING CONSISTS OF THE BASIC RECORD + A DDNAME + A  */
*     /* DCB AND DEB ADDRESS.                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0273
*S00:                                                           02S0273
*     DO;                           /* SUBCASE                       */
S00      DS    0H                                               02S0274
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */
         ICM   @14,3,TIMESW                                     02S0274
         BNZ   @RF00274                                         02S0274
*         DO;                       /* YES - FORMAT DDNAME           */
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0276
         LA    @07,LDDNL1                                       02S0276
         ST    @07,ADPLFMT1(,@14)                               02S0276
*           ADPLFMT2=ADDR(RCD0DDN); /* ADDR OF DDNAME IN RECORD      */
         LA    @07,46                                           02S0277
         AL    @07,DATAPTR(,PLISTPTR)                           02S0277
         ST    @07,ADPLFMT2(,@14)                               02S0277
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */
         LA    R0,DDNLN1                                        02S0278
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0279
         BALR  @14,@15                                          02S0279
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR SECOND PASS        */
         SLR   RETCODE,RETCODE                                  02S0280
*         END;                                                  02S0281
*       ELSE                                                    02S0282
*         DO;                       /* NO - FORMAT REGS AND REMAINING
*                                      FIELDS                        */
         B     @RC00274                                         02S0282
@RF00274 DS    0H                                               02S0283
*           DYNAMPTN(1:LENGTH(GP4S00))=GP4S00;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(9),GP4S00                               02S0283
*           IF RCD0DCB=ASTER4×RCD0DCB=PEES4×RCD0DCB=ESSES4 THEN/* IS
*                                      FIELD IN ERROR                */
         LA    @14,46                                           02S0284
         AL    @14,DATAPTR(,PLISTPTR)                           02S0284
         CLC   RCD0DCB(4,@14),ASTER4                            02S0284
         BE    @RT00284                                         02S0284
         CLC   RCD0DCB(4,@14),PEES4                             02S0284
         BE    @RT00284                                         02S0284
         CLC   RCD0DCB(4,@14),ESSES4                            02S0284
         BNE   @RF00284                                         02S0284
@RT00284 DS    0H                                               02S0285
*             OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0285
         IC    @14,OLDFLG                                       02S0285
         O     @14,@CF00092                                     02S0285
         STC   @14,OLDFLG                                       02S0285
*           IF RCD0DEB=ASTER4×RCD0DEB=PEES4×RCD0DEB=ESSES4 THEN/* IS
*                                      FIELD IN ERROR                */
@RF00284 LA    @14,46                                           02S0286
         AL    @14,DATAPTR(,PLISTPTR)                           02S0286
         CLC   RCD0DEB(4,@14),ASTER4                            02S0286
         BE    @RT00286                                         02S0286
         CLC   RCD0DEB(4,@14),PEES4                             02S0286
         BE    @RT00286                                         02S0286
         CLC   RCD0DEB(4,@14),ESSES4                            02S0286
         BNE   @RF00286                                         02S0286
@RT00286 DS    0H                                               02S0287
*             OLDFLG(2)=OLDFLG(2)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0287
         IC    @14,OLDFLG+4                                     02S0287
         O     @14,@CF00092                                     02S0287
         STC   @14,OLDFLG+4                                     02S0287
*           ADPLFMT1=ADDR(GP4TYP1); /* ADDR OF LABELS FOR THIS LINE  */
@RF00286 L     @14,ABDPLPTR(,PLISTPTR)                          02S0288
         LA    @07,GP4TYP1                                      02S0288
         ST    @07,ADPLFMT1(,@14)                               02S0288
*           ADPLFMT2=ADDR(RCD0DCB); /* ADDR OF DATA IN BUFFER        */
         L     @07,DATAPTR(,PLISTPTR)                           02S0289
         LA    @07,RCD0DCB+46(,@07)                             02S0289
         ST    @07,ADPLFMT2(,@14)                               02S0289
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S0290
*           CALL AMDPRFMT;          /* FORMAT LINE                   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0291
         BALR  @14,@15                                          02S0291
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0292
*         END;                                                  02S0293
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0294
*     END S00;                      /* END OF SUBCASE                */
*                                                               02S0296
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 6,7. THE      */
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + AN EP/CE NAME + A */
*     /* 12 BYTE/8 BYTE PLIST                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0296
*S06:                                                           02S0296
*     DO;                           /* SUBCASE                       */
S06      DS    0H                                               02S0297
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0297
         CH    @14,TIMESW                                       02S0297
         BNE   @RF00297                                         02S0297
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0298
*       ELSE                                                    02S0299
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS
*                                      & FORMAT THEM                 */
         B     @RC00297                                         02S0299
@RF00297 DS    0H                                               02S0300
*           DYNAMPTN(1:LENGTH(GP4S06))=GP4S06;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(17),GP4S06                              02S0300
*           IF RCD6LST=ASTER8×RCD6LST=PEES8×RCD6LST=ESSES8 THEN/* IS
*                                      FIELD IN ERROR                */
         LA    @14,46                                           02S0301
         AL    @14,DATAPTR(,PLISTPTR)                           02S0301
         CLC   RCD6LST(8,@14),ASTER8                            02S0301
         BE    @RT00301                                         02S0301
         CLC   RCD6LST(8,@14),PEES8                             02S0301
         BE    @RT00301                                         02S0301
         CLC   RCD6LST(8,@14),ESSES8                            02S0301
         BNE   @RF00301                                         02S0301
@RT00301 DS    0H                                               02S0302
*             DO;                   /* YES                           */
*               OLDFLG(2)=OLDFLG(2)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S0303
         SLR   @05,@05                                          02S0303
         IC    @05,OLDFLG+4                                     02S0303
         OR    @05,@14                                          02S0303
         STC   @05,OLDFLG+4                                     02S0303
*               OLDFLG(3)=OLDFLG(3)×CHARFLAG;                   02S0304
         SLR   @05,@05                                          02S0304
         IC    @05,OLDFLG+8                                     02S0304
         OR    @05,@14                                          02S0304
         STC   @05,OLDFLG+8                                     02S0304
*               OLDFLG(4)=OLDFLG(4)×CHARFLAG;                   02S0305
         SLR   @05,@05                                          02S0305
         IC    @05,OLDFLG+12                                    02S0305
         OR    @14,@05                                          02S0305
         STC   @14,OLDFLG+12                                    02S0305
*             END;                                              02S0306
*           IF SVCNUMBR=8 THEN      /* IS THIS SVC 7                 */
@RF00301 CH    SVCNUMBR,@CH00034                                02S0307
         BNE   @RF00307                                         02S0307
*             OLDFLG(4)=0;          /* YES - INDICATE END OF PATTERNS*/
         MVI   OLDFLG+12,X'00'                                  02S0308
*           ADPLFMT1=ADDR(GP4TYP3); /* ADDR OF LABELS FOR THIS LINE  */
@RF00307 L     @14,ABDPLPTR(,PLISTPTR)                          02S0309
         LA    @07,GP4TYP3                                      02S0309
         ST    @07,ADPLFMT1(,@14)                               02S0309
*           ADPLFMT2=ADDR(EPDENM1); /* ADDR OF DATA IN BUFFER        */
         LA    @07,46                                           02S0310
         AL    @07,DATAPTR(,PLISTPTR)                           02S0310
         ST    @07,ADPLFMT2(,@14)                               02S0310
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0311
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0312
         BALR  @14,@15                                          02S0312
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0313
*         END;                                                  02S0314
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0315
*     END S06;                      /* END OF SUBCASE                */
*                                                               02S0317
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 8,9,41. THE   */
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + AN EP/CE          */
*     /* NAME/NAME.                                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0317
*S08:                                                           02S0317
*     DO;                           /* SUBCASE                       */
S08      DS    0H                                               02S0318
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0318
         CH    @14,TIMESW                                       02S0318
         BNE   @RF00318                                         02S0318
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0319
*       ELSE                                                    02S0320
*         DO;                       /* YES - FORMAT REMAINING FIELD  */
         B     @RC00318                                         02S0320
@RF00318 DS    0H                                               02S0321
*           IF SVCNUMBR=42 THEN     /* IS THIS SVC 41                */
         CH    SVCNUMBR,@CH00563                                02S0321
         BNE   @RF00321                                         02S0321
*             DO;                   /* YES                           */
*               DYNAMPTN(1:LENGTH(GP4S41))=GP4S41;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(5),GP4S41                               02S0323
*               ADPLFMT1=ADDR(GP4TYP15);/* ADDR OF LABELS FOR THIS
*                                      LINE                          */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0324
         LA    @07,GP4TYP15                                     02S0324
         ST    @07,ADPLFMT1(,@14)                               02S0324
*             END;                                              02S0325
*           ELSE                                                02S0326
*             DO;                   /* NO - ITS SVC 8 OR 9           */
         B     @RC00321                                         02S0326
@RF00321 DS    0H                                               02S0327
*               DYNAMPTN(1:LENGTH(GP4S08))=GP4S08;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(5),GP4S08                               02S0327
*               ADPLFMT1=ADDR(GP4TYP3);/* ADDR OF LABELS FOR THIS
*                                      LINE                          */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0328
         LA    @07,GP4TYP3                                      02S0328
         ST    @07,ADPLFMT1(,@14)                               02S0328
*             END;                                              02S0329
*           ADPLFMT2=ADDR(EPDENM2); /* ADDR OF DATA IN BUFFER        */
@RC00321 L     @14,ABDPLPTR(,PLISTPTR)                          02S0330
         LA    @07,46                                           02S0330
         AL    @07,DATAPTR(,PLISTPTR)                           02S0330
         ST    @07,ADPLFMT2(,@14)                               02S0330
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0331
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0332
         BALR  @14,@15                                          02S0332
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0333
*         END;                                                  02S0334
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0335
*     END S08;                      /* END OF SUBCASE                */
*                                                               02S0337
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 13,28,68. THE */
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + A COMP            */
*     /* CODE/REGISTER 13.                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0337
*S13:                                                           02S0337
*     DO;                           /* SUBCASE                       */
S13      DS    0H                                               02S0338
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0338
         CH    @14,TIMESW                                       02S0338
         BNE   @RF00338                                         02S0338
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0339
*       ELSE                                                    02S0340
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS
*                                      & FORMAT THEM                 */
         B     @RC00338                                         02S0340
@RF00338 DS    0H                                               02S0341
*           IF SVCNUMBR=14 THEN     /* IS THIS SVC 13                */
         CH    SVCNUMBR,@CH00434                                02S0341
         BNE   @RF00341                                         02S0341
*             DO;                   /* YES                           */
*               DYNAMPTN(1:LENGTH(GP4S13))=GP4S13;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(5),GP4S13                               02S0343
*               ADPLFMT1=ADDR(GP4TYP4);/* ADDR OF LABELS FOR THIS
*                                      LINE                          */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0344
         LA    @07,GP4TYP4                                      02S0344
         ST    @07,ADPLFMT1(,@14)                               02S0344
*             END;                                              02S0345
*           ELSE                                                02S0346
*             DO;                   /* NO - ITS SVC 28 OR 68         */
         B     @RC00341                                         02S0346
@RF00341 DS    0H                                               02S0347
*               DYNAMPTN(1:LENGTH(GP4S28))=GP4S28;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(5),GP4S28                               02S0347
*               ADPLFMT1=ADDR(GP4TYP11);/* ADDR OF LABELS FOR THIS
*                                      LINE                          */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0348
         LA    @07,GP4TYP11                                     02S0348
         ST    @07,ADPLFMT1(,@14)                               02S0348
*             END;                                              02S0349
*           IF COMPCODE=ASTER4×COMPCODE=PEES4×COMPCODE=ESSES4 THEN/*
*                                      IS FIELD IN ERROR             */
@RC00341 LA    @14,46                                           02S0350
         AL    @14,DATAPTR(,PLISTPTR)                           02S0350
         CLC   COMPCODE(4,@14),ASTER4                           02S0350
         BE    @RT00350                                         02S0350
         CLC   COMPCODE(4,@14),PEES4                            02S0350
         BE    @RT00350                                         02S0350
         CLC   COMPCODE(4,@14),ESSES4                           02S0350
         BNE   @RF00350                                         02S0350
@RT00350 DS    0H                                               02S0351
*             OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN EBCDIC*/
         SLR   @14,@14                                          02S0351
         IC    @14,OLDFLG                                       02S0351
         O     @14,@CF00092                                     02S0351
         STC   @14,OLDFLG                                       02S0351
*           ADPLFMT2=ADDR(COMPCODE);/* ADDR OF DATA IN BUFFER        */
@RF00350 L     @14,ABDPLPTR(,PLISTPTR)                          02S0352
         LA    @07,46                                           02S0352
         AL    @07,DATAPTR(,PLISTPTR)                           02S0352
         ST    @07,ADPLFMT2(,@14)                               02S0352
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0353
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0354
         BALR  @14,@15                                          02S0354
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0355
*         END;                                                  02S0356
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0357
*     END S13;                      /* END OF SUBCASE                */
*                                                               02S0359
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 14. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A PICA.                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0359
*S14:                                                           02S0359
*     DO;                           /* SUBCASE                       */
S14      DS    0H                                               02S0360
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0360
         CH    @14,TIMESW                                       02S0360
         BNE   @RF00360                                         02S0360
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0361
*       ELSE                                                    02S0362
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS
*                                      & FORMAT THEM                 */
         B     @RC00360                                         02S0362
@RF00360 DS    0H                                               02S0363
*           DYNAMPTN(1:LENGTH(GP4S14))=GP4S14;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(5),GP4S14                               02S0363
*           IF PICA=ASTER6×PICA=PEES6×PICA=ESSES6 THEN/* IS FIELD IN
*                                      ERROR                         */
         LA    @14,46                                           02S0364
         AL    @14,DATAPTR(,PLISTPTR)                           02S0364
         CLC   PICA(6,@14),ASTER6                               02S0364
         BE    @RT00364                                         02S0364
         CLC   PICA(6,@14),PEES6                                02S0364
         BE    @RT00364                                         02S0364
         CLC   PICA(6,@14),ESSES6                               02S0364
         BNE   @RF00364                                         02S0364
@RT00364 DS    0H                                               02S0365
*             OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0365
         IC    @14,OLDFLG                                       02S0365
         O     @14,@CF00092                                     02S0365
         STC   @14,OLDFLG                                       02S0365
*           ADPLFMT1=ADDR(GP4TYP5); /* ADDR OF LABELS FOR THIS LINE  */
@RF00364 L     @14,ABDPLPTR(,PLISTPTR)                          02S0366
         LA    @07,GP4TYP5                                      02S0366
         ST    @07,ADPLFMT1(,@14)                               02S0366
*           ADPLFMT2=ADDR(PICA);    /* ADDR OF DATA IN BUFFER        */
         LA    @07,46                                           02S0367
         AL    @07,DATAPTR(,PLISTPTR)                           02S0367
         ST    @07,ADPLFMT2(,@14)                               02S0367
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0368
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0369
         BALR  @14,@15                                          02S0369
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0370
*         END;                                                  02S0371
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0372
*     END S14;                      /* END OF SUBCASE                */
*                                                               02S0374
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 15. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A DDNAME + ERROR FLAGS + A TCB ADDR + A  */
*     /* CUU.                                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0374
*S15:                                                           02S0374
*     DO;                           /* SUBCASE                       */
S15      DS    0H                                               02S0375
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */
         ICM   @14,3,TIMESW                                     02S0375
         BNZ   @RF00375                                         02S0375
*         DO;                       /* YES - FORMAT DDNAME           */
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0377
         LA    @07,LDDNL1                                       02S0377
         ST    @07,ADPLFMT1(,@14)                               02S0377
*           ADPLFMT2=ADDR(RCD15DDN);/* ADDR OF DDNAME IN RECORD      */
         LA    @07,46                                           02S0378
         AL    @07,DATAPTR(,PLISTPTR)                           02S0378
         ST    @07,ADPLFMT2(,@14)                               02S0378
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */
         LA    R0,DDNLN1                                        02S0379
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0380
         BALR  @14,@15                                          02S0380
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR SECOND PASS        */
         SLR   RETCODE,RETCODE                                  02S0381
*         END;                                                  02S0382
*       ELSE                                                    02S0383
*         DO;                       /* NO - FORMAT REGS AND REMAINING
*                                      FIELDS                        */
         B     @RC00375                                         02S0383
@RF00375 DS    0H                                               02S0384
*           DYNAMPTN(1:LENGTH(GP4S15))=GP4S15;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(13),GP4S15                              02S0384
*           IF ERRFLGS=ASTER1×ERRFLGS=PEES1×ERRFLGS=ESSES1 THEN/* IS
*                                      FIELD IN ERROR                */
         LA    @14,46                                           02S0385
         AL    @14,DATAPTR(,PLISTPTR)                           02S0385
         CLC   ERRFLGS(1,@14),ASTER1                            02S0385
         BE    @RT00385                                         02S0385
         CLC   ERRFLGS(1,@14),PEES1                             02S0385
         BE    @RT00385                                         02S0385
         CLC   ERRFLGS(1,@14),ESSES1                            02S0385
         BNE   @RF00385                                         02S0385
@RT00385 DS    0H                                               02S0386
*             OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0386
         IC    @14,OLDFLG                                       02S0386
         O     @14,@CF00092                                     02S0386
         STC   @14,OLDFLG                                       02S0386
*           IF RCD15TCB=ASTER4×RCD15TCB=PEES4×RCD15TCB=ESSES4 THEN/*
*                                      IS FIELD IN ERROR             */
@RF00385 LA    @14,46                                           02S0387
         AL    @14,DATAPTR(,PLISTPTR)                           02S0387
         CLC   RCD15TCB(4,@14),ASTER4                           02S0387
         BE    @RT00387                                         02S0387
         CLC   RCD15TCB(4,@14),PEES4                            02S0387
         BE    @RT00387                                         02S0387
         CLC   RCD15TCB(4,@14),ESSES4                           02S0387
         BNE   @RF00387                                         02S0387
@RT00387 DS    0H                                               02S0388
*             OLDFLG(2)=OLDFLG(2)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0388
         IC    @14,OLDFLG+4                                     02S0388
         O     @14,@CF00092                                     02S0388
         STC   @14,OLDFLG+4                                     02S0388
*           IF RCD15CUU=ASTER2×RCD15CUU=PEES2×RCD15CUU=ESSES2 THEN/*
*                                      IS FIELD IN ERROR             */
@RF00387 LA    @14,46                                           02S0389
         AL    @14,DATAPTR(,PLISTPTR)                           02S0389
         CLC   RCD15CUU(2,@14),ASTER2                           02S0389
         BE    @RT00389                                         02S0389
         CLC   RCD15CUU(2,@14),PEES2                            02S0389
         BE    @RT00389                                         02S0389
         CLC   RCD15CUU(2,@14),ESSES2                           02S0389
         BNE   @RF00389                                         02S0389
@RT00389 DS    0H                                               02S0390
*             OLDFLG(3)=OLDFLG(3)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0390
         IC    @14,OLDFLG+8                                     02S0390
         O     @14,@CF00092                                     02S0390
         STC   @14,OLDFLG+8                                     02S0390
*           ADPLFMT1=ADDR(GP4TYP6); /* ADDR OF LABELS FOR THIS LINE  */
@RF00389 L     @14,ABDPLPTR(,PLISTPTR)                          02S0391
         LA    @07,GP4TYP6                                      02S0391
         ST    @07,ADPLFMT1(,@14)                               02S0391
*           ADPLFMT2=ADDR(ERRFLGS); /* ADDR OF DATA IN BUFFER        */
         L     @07,DATAPTR(,PLISTPTR)                           02S0392
         LA    @07,ERRFLGS+46(,@07)                             02S0392
         ST    @07,ADPLFMT2(,@14)                               02S0392
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S0393
*           CALL AMDPRFMT;          /* FORMAT LINE                   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0394
         BALR  @14,@15                                          02S0394
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0395
*         END;                                                  02S0396
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0397
*     END S15;                      /* END OF SUBCASE                */
*                                                               02S0399
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 16. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A DDANME + A DCB ADDR + A 12 BYTE PLIST. */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0399
*S16:                                                           02S0399
*     DO;                           /* SUBCASE                       */
S16      DS    0H                                               02S0400
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */
         ICM   @14,3,TIMESW                                     02S0400
         BNZ   @RF00400                                         02S0400
*         DO;                       /* YES - FORMAT DDNAME           */
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0402
         LA    @07,LDDNL1                                       02S0402
         ST    @07,ADPLFMT1(,@14)                               02S0402
*           ADPLFMT2=ADDR(RCD16DDN);/* ADDR OF DDNAME IN RECORD      */
         LA    @07,46                                           02S0403
         AL    @07,DATAPTR(,PLISTPTR)                           02S0403
         ST    @07,ADPLFMT2(,@14)                               02S0403
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */
         LA    R0,DDNLN1                                        02S0404
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0405
         BALR  @14,@15                                          02S0405
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR SECOND PASS        */
         SLR   RETCODE,RETCODE                                  02S0406
*         END;                                                  02S0407
*       ELSE                                                    02S0408
*         DO;                       /* NO - FORMAT REGS AND REMAINING
*                                      FIELDS                        */
         B     @RC00400                                         02S0408
@RF00400 DS    0H                                               02S0409
*           DYNAMPTN(1:LENGTH(GP4S16))=GP4S16;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(17),GP4S16                              02S0409
*           IF RCD16DCB=ASTER4×RCD16DCB=PEES4×/*             @YM04524*/
*               RCD16DCB=ESSES4×RCD16DCB=UA THEN/*           @YM04524
*                                      IS FIELD IN ERROR     @YM04524*/
         LA    @14,46                                           02S0410
         AL    @14,DATAPTR(,PLISTPTR)                           02S0410
         CLC   RCD16DCB(4,@14),ASTER4                           02S0410
         BE    @RT00410                                         02S0410
         CLC   RCD16DCB(4,@14),PEES4                            02S0410
         BE    @RT00410                                         02S0410
         CLC   RCD16DCB(4,@14),ESSES4                           02S0410
         BE    @RT00410                                         02S0410
         CLC   RCD16DCB(4,@14),UA                               02S0410
         BNE   @RF00410                                         02S0410
@RT00410 DS    0H                                               02S0411
*             OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0411
         IC    @14,OLDFLG                                       02S0411
         O     @14,@CF00092                                     02S0411
         STC   @14,OLDFLG                                       02S0411
*           IF PPL=ASTER12×PPL=PEES12×PPL=ESSES12 THEN/* IS FIELD IN
*                                      ERROR                         */
@RF00410 LA    @14,46                                           02S0412
         AL    @14,DATAPTR(,PLISTPTR)                           02S0412
         CLC   PPL(12,@14),ASTER12                              02S0412
         BE    @RT00412                                         02S0412
         CLC   PPL(12,@14),PEES12                               02S0412
         BE    @RT00412                                         02S0412
         CLC   PPL(12,@14),ESSES12                              02S0412
         BNE   @RF00412                                         02S0412
@RT00412 DS    0H                                               02S0413
*             DO;                   /* YES                           */
*               OLDFLG(2)=OLDFLG(2)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S0414
         SLR   @07,@07                                          02S0414
         IC    @07,OLDFLG+4                                     02S0414
         OR    @07,@14                                          02S0414
         STC   @07,OLDFLG+4                                     02S0414
*               OLDFLG(3)=OLDFLG(3)×CHARFLAG;                   02S0415
         SLR   @07,@07                                          02S0415
         IC    @07,OLDFLG+8                                     02S0415
         OR    @07,@14                                          02S0415
         STC   @07,OLDFLG+8                                     02S0415
*               OLDFLG(4)=OLDFLG(4)×CHARFLAG;                   02S0416
         SLR   @07,@07                                          02S0416
         IC    @07,OLDFLG+12                                    02S0416
         OR    @14,@07                                          02S0416
         STC   @14,OLDFLG+12                                    02S0416
*             END;                                              02S0417
*           ADPLFMT1=ADDR(GP4TYP7); /* ADDR OF LABELS FOR THIS LINE  */
@RF00412 L     @14,ABDPLPTR(,PLISTPTR)                          02S0418
         LA    @07,GP4TYP7                                      02S0418
         ST    @07,ADPLFMT1(,@14)                               02S0418
*           ADPLFMT2=ADDR(RCD16DCB);/* ADDR OF DATA IN BUFFER        */
         L     @07,DATAPTR(,PLISTPTR)                           02S0419
         LA    @07,RCD16DCB+46(,@07)                            02S0419
         ST    @07,ADPLFMT2(,@14)                               02S0419
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S0420
*           CALL AMDPRFMT;          /* FORMAT LINE                   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0421
         BALR  @14,@15                                          02S0421
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0422
*         END;                                                  02S0423
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0424
*     END S16;                      /* END OF SUBCASE                */
*                                                               02S0426
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 21. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A DDNAME + A VARIABLE LENGTH PLIST.      */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0426
*S21:                                                           02S0426
*     DO;                           /* SUBCASE                       */
S21      DS    0H                                               02S0427
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */
         ICM   @14,3,TIMESW                                     02S0427
         BNZ   @RF00427                                         02S0427
*         DO;                       /* YES - FORMAT DDNAME           */
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0429
         LA    @07,LDDNL1                                       02S0429
         ST    @07,ADPLFMT1(,@14)                               02S0429
*           ADPLFMT2=ADDR(RCD21DDN);/* ADDR OF DDNAME IN RECORD      */
         LA    @07,46                                           02S0430
         AL    @07,DATAPTR(,PLISTPTR)                           02S0430
         ST    @07,ADPLFMT2(,@14)                               02S0430
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */
         LA    R0,DDNLN1                                        02S0431
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0432
         BALR  @14,@15                                          02S0432
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR SECOND PASS        */
         SLR   RETCODE,RETCODE                                  02S0433
*         END;                                                  02S0434
*       ELSE                                                    02S0435
*         DO;                       /* NO - FORMAT REGS AND REMAINING
*                                      FIELDS                        */
         B     @RC00427                                         02S0435
@RF00427 DS    0H                                               02S0436
*           DYNAMPTN(1:LENGTH(GP4S21))=GP4S21;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(17),GP4S21                              02S0436
*           IF RCD21LN=ERROR THEN   /* IS FIELD IN ERROR             */
         L     @14,DATAPTR(,PLISTPTR)                           02S0437
         CLI   RCD21LN+46(@14),255                              02S0437
         BNE   @RF00437                                         02S0437
*             DO;                   /* YES                           */
*               OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0439
         IC    @14,OLDFLG                                       02S0439
         O     @14,@CF00092                                     02S0439
         STC   @14,OLDFLG                                       02S0439
*               OLDFLG(2)=0;        /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0440
*             END;                                              02S0441
*           ELSE                                                02S0442
*             DO;                   /* NO - FORMAT 3 OR 4 WORDS      */
         B     @RC00437                                         02S0442
@RF00437 DS    0H                                               02S0443
*               IF RCD21LN=12 THEN  /* ARE THERE ONLY THREE WORDS    */
         L     @14,DATAPTR(,PLISTPTR)                           02S0443
         CLI   RCD21LN+46(@14),12                               02S0443
         BNE   @RF00443                                         02S0443
*                 OLDFLG(4)=0;      /* YES - INDICATE END OF PATTERNS*/
         MVI   OLDFLG+12,X'00'                                  02S0444
*             END;                                              02S0445
@RF00443 DS    0H                                               02S0446
*           ADPLFMT1=ADDR(GROUP2);  /* ADDR OF LABEL FOR THIS LINE   */
@RC00437 L     @14,ABDPLPTR(,PLISTPTR)                          02S0446
         LA    @07,GROUP2                                       02S0446
         ST    @07,ADPLFMT1(,@14)                               02S0446
*           ADPLFMT2=ADDR(RCD21LN)+1;/* ADDR OF DATA IN BUFFER       */
         L     @07,DATAPTR(,PLISTPTR)                           02S0447
         LA    @07,RCD21LN+46(,@07)                             02S0447
         AH    @07,@CH00046                                     02S0447
         ST    @07,ADPLFMT2(,@14)                               02S0447
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S0448
*           CALL AMDPRFMT;          /* FORMAT LINE                   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0449
         BALR  @14,@15                                          02S0449
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0450
*         END;                                                  02S0451
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0452
*     END S21;                      /* END OF SUBCASE                */
*                                                               02S0454
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 25. THE FORMATTING CONSISTS OF*/
*     /* THE BAISC RECORD + A DDNAME + A DCBFDAD + A DCBTRKBAK.      */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0454
*S25:                                                           02S0454
*     DO;                           /* SUBCASE                       */
S25      DS    0H                                               02S0455
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */
         ICM   @14,3,TIMESW                                     02S0455
         BNZ   @RF00455                                         02S0455
*         DO;                       /* YES - FORMAT DDNAME           */
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0457
         LA    @07,LDDNL1                                       02S0457
         ST    @07,ADPLFMT1(,@14)                               02S0457
*           ADPLFMT2=ADDR(RCD25DDN);/* ADDR OF DDNAME IN RECORD      */
         LA    @07,46                                           02S0458
         AL    @07,DATAPTR(,PLISTPTR)                           02S0458
         ST    @07,ADPLFMT2(,@14)                               02S0458
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */
         LA    R0,DDNLN1                                        02S0459
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0460
         BALR  @14,@15                                          02S0460
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR SECOND PASS        */
         SLR   RETCODE,RETCODE                                  02S0461
*         END;                                                  02S0462
*       ELSE                                                    02S0463
*         DO;                       /* NO - FORMAT REGS AND REMAINING
*                                      FIELDS                        */
         B     @RC00455                                         02S0463
@RF00455 DS    0H                                               02S0464
*           DYNAMPTN(1:LENGTH(GP4S25))=GP4S25;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(13),GP4S25                              02S0464
*           IF DCBFDAD=ASTER8×DCBFDAD=PEES8×DCBFDAD=ESSES8 THEN/* IS
*                                      FIELD IN ERROR                */
         LA    @14,46                                           02S0465
         AL    @14,DATAPTR(,PLISTPTR)                           02S0465
         CLC   DCBFDAD(8,@14),ASTER8                            02S0465
         BE    @RT00465                                         02S0465
         CLC   DCBFDAD(8,@14),PEES8                             02S0465
         BE    @RT00465                                         02S0465
         CLC   DCBFDAD(8,@14),ESSES8                            02S0465
         BNE   @RF00465                                         02S0465
@RT00465 DS    0H                                               02S0466
*             DO;                   /* YES                           */
*               OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S0467
         SLR   @07,@07                                          02S0467
         IC    @07,OLDFLG                                       02S0467
         OR    @07,@14                                          02S0467
         STC   @07,OLDFLG                                       02S0467
*               OLDFLG(2)=OLDFLG(2)×CHARFLAG;                   02S0468
         SLR   @07,@07                                          02S0468
         IC    @07,OLDFLG+4                                     02S0468
         OR    @07,@14                                          02S0468
         STC   @07,OLDFLG+4                                     02S0468
*               OLDFLG(3)=OLDFLG(3)×CHARFLAG;                   02S0469
         SLR   @07,@07                                          02S0469
         IC    @07,OLDFLG+8                                     02S0469
         OR    @14,@07                                          02S0469
         STC   @14,OLDFLG+8                                     02S0469
*             END;                                              02S0470
*           ADPLFMT1=ADDR(GP4TYP8); /* ADDR OF LABELS FOR THIS LINE  */
@RF00465 L     @14,ABDPLPTR(,PLISTPTR)                          02S0471
         LA    @07,GP4TYP8                                      02S0471
         ST    @07,ADPLFMT1(,@14)                               02S0471
*           ADPLFMT2=ADDR(DCBFDAD); /* ADDR OF DATA IN BUFFER        */
         L     @07,DATAPTR(,PLISTPTR)                           02S0472
         LA    @07,DCBFDAD+46(,@07)                             02S0472
         ST    @07,ADPLFMT2(,@14)                               02S0472
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S0473
*           CALL AMDPRFMT;          /* FORMAT LINE                   */
         L     @15,FMTADDR(,PLISTPTR)                           02S0474
         BALR  @14,@15                                          02S0474
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0475
*         END;                                                  02S0476
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0477
*     END S25;                      /* END OF SUBCASE                */
*                                                               02S0479
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC26. THE FORMATTING CONSISTS OF */
*     /* THE BASIC RECORD + A VARIABLE LENGTH PLIST + A VARIABLE     */
*     /* LENGTH DSNAME + A VARIABLE LENGTH VOLIST.                   */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0479
*S26:                                                           02S0479
*     DO;                           /* SUBCASE                       */
S26      DS    0H                                               02S0480
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0480
         CH    @14,TIMESW                                       02S0480
         BNE   @RF00480                                         02S0480
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0481
*       ELSE                                                    02S0482
*         DO;                       /* YES - REGISTERS HAVE BEEN
*                                      FORMATTED                     */
         B     @RC00480                                         02S0482
@RF00480 DS    0H                                               02S0483
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE
*                                      BEEN FORMATTED                */
         CLC   TIMESW(2),@CH00046                               02S0483
         BNE   @RF00483                                         02S0483
*             DO;                   /* NO                            */
*               DYNAMPTN(1:LENGTH(GP4S26A))=GP4S26A;/* MOVE PATTERNS
*                                      TO GETMAIN AREA               */
         MVC   DYNAMPTN(21),GP4S26A                             02S0485
*               IF RCD26LN=ERROR THEN/* IS FIELD IN ERROR            */
         LA    @14,46                                           02S0486
         AL    @14,DATAPTR(,PLISTPTR)                           02S0486
         CLI   RCD26LN(@14),255                                 02S0486
         BNE   @RF00486                                         02S0486
*                 DO;               /* YES                           */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @07,@07                                          02S0488
         IC    @07,OLDFLG                                       02S0488
         O     @07,@CF00092                                     02S0488
         STC   @07,OLDFLG                                       02S0488
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0489
*                   RCD26LN=4;      /* MODIFY LENGTH IN ORDER TO
*                                      ACCESS NEXT FIELD             */
         MVI   RCD26LN(@14),X'04'                               02S0490
*                 END;                                          02S0491
*               ELSE                                            02S0492
*                 DO;               /* FORMAT 4 OR 5 WORDS           */
         B     @RC00486                                         02S0492
@RF00486 DS    0H                                               02S0493
*                   IF RCD26LN=16 THEN/* IS PLIST 4 WORDS            */
         L     @14,DATAPTR(,PLISTPTR)                           02S0493
         CLI   RCD26LN+46(@14),16                               02S0493
         BNE   @RF00493                                         02S0493
*                     OLDFLG(5)=0;  /* YES - INDICATE END OF PATTERNS*/
         MVI   OLDFLG+16,X'00'                                  02S0494
*                 END;                                          02S0495
@RF00493 DS    0H                                               02S0496
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABELS FOR THIS LINE*/
@RC00486 L     @14,ABDPLPTR(,PLISTPTR)                          02S0496
         LA    @07,GROUP2                                       02S0496
         ST    @07,ADPLFMT1(,@14)                               02S0496
*               ADPLFMT2=ADDR(RCD26LN)+1;/* ADDR OF DATA IN BUFFER   */
         LA    @07,47                                           02S0497
         AL    @07,DATAPTR(,PLISTPTR)                           02S0497
         ST    @07,ADPLFMT2(,@14)                               02S0497
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0498
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0499
         BALR  @14,@15                                          02S0499
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR THIRD PASS         */
         SLR   RETCODE,RETCODE                                  02S0500
*             END;                                              02S0501
*           ELSE                                                02S0502
*             DO;                   /* YES                           */
         B     @RC00483                                         02S0502
@RF00483 DS    0H                                               02S0503
*               IF TIMESW=2 THEN    /* HAS THIRD LINE BEEN FORMATTED */
         CLC   TIMESW(2),@CH00078                               02S0503
         BNE   @RF00503                                         02S0503
*                 DO;               /* NO                            */
*                   DYNAMPTN(1:LENGTH(GP4S26B))=GP4S26B;/* MOVE 02S0505
*                                      PATTERNS TO GETMAIN AREA      */
         MVC   DYNAMPTN(13),GP4S26B                             02S0505
*                   FIELDADR=ADDR(RCD26LN)+RCD26LN+1;/* ADDR OF 02S0506
*                                      DSNAME IN BUFFER              */
         LA    @14,46                                           02S0506
         AL    @14,DATAPTR(,PLISTPTR)                           02S0506
         SLR   @07,@07                                          02S0506
         IC    @07,RCD26LN(,@14)                                02S0506
         ALR   @07,@14                                          02S0506
         AH    @07,@CH00046                                     02S0506
         ST    @07,FIELDADR                                     02S0506
*                   IF NXTFIELD^=ERROR THEN/* IS FIELD IN ERROR      */
         CLI   NXTFIELD(@07),255                                02S0507
         BE    @RF00507                                         02S0507
*                     DO;           /* NO                            */
*                       IF NXTFIELD^=44 THEN/* IS DSN MAX LENGTH     */
         CLI   NXTFIELD(@07),44                                 02S0509
         BE    @RF00509                                         02S0509
*                         DO;       /* NO                            */
*                           K=NXTFIELD/16;/* NUMBER OF FULL WORDS    */
         L     @14,FIELDADR                                     02S0511
         SLR   @05,@05                                          02S0511
         IC    @05,NXTFIELD(,@14)                               02S0511
         LR    K,@05                                            02S0511
         SRL   K,4                                              02S0511
*                           MOD=NXTFIELD//16;/* REMAINDER OF PARTIAL
*                                      WORD                          */
         LR    @02,@05                                          02S0512
         SRDA  @02,32                                           02S0512
         D     @02,@CF00139                                     02S0512
         LR    MOD,@02                                          02S0512
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */
         SLR   @14,@14                                          02S0513
         CR    MOD,@14                                          02S0513
         BNE   @RF00513                                         02S0513
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0514
         SLA   @07,2                                            02S0514
         STC   @14,OLDFLG(@07)                                  02S0514
*                           ELSE                                02S0515
*                             DO;   /* NO - MODIFY PATTERNS     02S0515
*                                      ACCORDINGLY                   */
         B     @RC00513                                         02S0515
@RF00513 DS    0H                                               02S0516
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET
*                                      DATA LENGTH TO ZERO           */
         LR    @14,K                                            02S0516
         SLA   @14,2                                            02S0516
         SLR   @05,@05                                          02S0516
         IC    @05,OLDLN(@14)                                   02S0516
         N     @05,@CF00297                                     02S0516
         STC   @05,OLDLN(@14)                                   02S0516
*                               OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW
*                                      DATA LENGTH                   */
         LR    @03,MOD                                          02S0517
         BCTR  @03,0                                            02S0517
         OR    @05,@03                                          02S0517
         STC   @05,OLDLN(@14)                                   02S0517
*                               OLDFLG(K+2)=0;/* INDICATE END OF
*                                      PATTERNS                      */
         SLR   @07,@07                                          02S0518
         STC   @07,OLDFLG+4(@14)                                02S0518
*                             END;                              02S0519
*                         END;                                  02S0520
*                     END;                                      02S0521
*                   ELSE                                        02S0522
*                     DO;           /* YES - FIELD IS IN ERROR       */
         B     @RC00507                                         02S0522
@RF00507 DS    0H                                               02S0523
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH*/
         SLR   @14,@14                                          02S0523
         IC    @14,OLDLN                                        02S0523
         N     @14,@CF00297                                     02S0523
         STC   @14,OLDLN                                        02S0523
*                       OLDLN(1)=OLDLN(1)×DATALN4;/* SET DATA LENGTH
*                                      TO FORMAT 4 BYTES             */
         O     @14,@CF00170                                     02S0524
         STC   @14,OLDLN                                        02S0524
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0525
*                       NXTFIELD=4; /* MODIFY LENGTH IN ORDER TO
*                                      ACCESS VOLIST                 */
         L     @14,FIELDADR                                     02S0526
         MVI   NXTFIELD(@14),X'04'                              02S0526
*                     END;                                      02S0527
*                   ADPLFMT1=ADDR(GP4TYP9);/* ADDR OF LABELS FOR THIS
*                                      LINE                          */
@RC00507 L     @14,ABDPLPTR(,PLISTPTR)                          02S0528
         LA    @07,GP4TYP9                                      02S0528
         ST    @07,ADPLFMT1(,@14)                               02S0528
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */
         LA    @07,1                                            02S0529
         AL    @07,FIELDADR                                     02S0529
         ST    @07,ADPLFMT2(,@14)                               02S0529
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */
         LA    R0,DYNAMPTN                                      02S0530
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0531
         BALR  @14,@15                                          02S0531
*                   RETCODE=0;      /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR FOURTH PASS        */
         SLR   RETCODE,RETCODE                                  02S0532
*                 END;                                          02S0533
*               ELSE                                            02S0534
*                 DO;               /* YES - FORMAT THE FOURTH LINE  */
         B     @RC00503                                         02S0534
@RF00503 DS    0H                                               02S0535
*                   DYNAMPTN(1:LENGTH(GP4S26C))=GP4S26C;/* MOVE 02S0535
*                                      PATTERNS TO GETMAIN AREA      */
         MVC   DYNAMPTN(41),GP4S26C                             02S0535
*                   FIELDADR=FIELDADR+NXTFIELD+1;/* ADDR OF VOLIST IN
*                                      BUFFER                        */
         L     @14,FIELDADR                                     02S0536
         SLR   @07,@07                                          02S0536
         IC    @07,NXTFIELD(,@14)                               02S0536
         ALR   @07,@14                                          02S0536
         AH    @07,@CH00046                                     02S0536
         ST    @07,FIELDADR                                     02S0536
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS FOR THIS
*                                      LINE                          */
         LA    R0,DYNAMPTN                                      02S0537
*                   IF NXTFIELD=ERROR THEN/* IS FIELD IN ERROR       */
         CLI   NXTFIELD(@07),255                                02S0538
         BNE   @RF00538                                         02S0538
*                     DO;           /* YES - ONLY FORMAT 4 BYTES     */
*                       OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA
*                                      IN EBCDIC                     */
         SLR   @14,@14                                          02S0540
         IC    @14,OLDFLG                                       02S0540
         O     @14,@CF00092                                     02S0540
         STC   @14,OLDFLG                                       02S0540
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0541
*                     END;                                      02S0542
*                   ELSE                                        02S0543
*                     DO;           /* NO - DETERMINE HOW MANY BYTES
*                                      IN VOLIST                     */
         B     @RC00538                                         02S0543
@RF00538 DS    0H                                               02S0544
*                       IF NXTFIELD=0 THEN/* IS THERE ANY DATA       */
         L     @14,FIELDADR                                     02S0544
         CLI   NXTFIELD(@14),0                                  02S0544
         BNE   @RF00544                                         02S0544
*                         R0=ADDR(GP4S26D);/* NO - ADDR OF PATTERNS
*                                      FOR THIS LINE                 */
         LA    R0,GP4S26D                                       02S0545
*                       ELSE                                    02S0546
*                         DO;       /* YES - THERE IS DATA IN VOLIST */
         B     @RC00544                                         02S0546
@RF00544 DS    0H                                               02S0547
*                           IF NXTFIELD<4 THEN/* IS VOLIST LESS THAN
*                                      ONE WORD                      */
         L     @14,FIELDADR                                     02S0547
         CLI   NXTFIELD(@14),4                                  02S0547
         BNL   @RF00547                                         02S0547
*                             DO;   /* YES                           */
*                               OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA
*                                      LENGTH TO 0                   */
         SLR   @07,@07                                          02S0549
         IC    @07,OLDLN                                        02S0549
         N     @07,@CF00297                                     02S0549
         STC   @07,OLDLN                                        02S0549
*                               OLDLN(1)=OLDLN(1)×(NXTFIELD-1);/* NEW
*                                      DATA LENGTH                   */
         SLR   @05,@05                                          02S0550
         IC    @05,NXTFIELD(,@14)                               02S0550
         BCTR  @05,0                                            02S0550
         OR    @07,@05                                          02S0550
         STC   @07,OLDLN                                        02S0550
*                               OLDFLG(2)=0;/* INDICATE END OF  02S0551
*                                      PATTERNS                      */
         MVI   OLDFLG+4,X'00'                                   02S0551
*                             END;                              02S0552
*                           ELSE                                02S0553
*                             DO;   /* NO - MODIFY PATTERNS          */
         B     @RC00547                                         02S0553
@RF00547 DS    0H                                               02S0554
*                               K=NXTFIELD/4;/* NUMBER OF FULL WORDS */
         L     @14,FIELDADR                                     02S0554
         SLR   @05,@05                                          02S0554
         IC    @05,NXTFIELD(,@14)                               02S0554
         LR    K,@05                                            02S0554
         SRL   K,2                                              02S0554
*                               MOD=NXTFIELD//4;/* REMAINDER OF 02S0555
*                                      PARTIAL WORD                  */
         LR    @02,@05                                          02S0555
         SRDA  @02,32                                           02S0555
         D     @02,@CF00099                                     02S0555
         LR    MOD,@02                                          02S0555
*                               IF MOD=0 THEN/* ARE ALL FULL WORDS   */
         SLR   @14,@14                                          02S0556
         CR    MOD,@14                                          02S0556
         BNE   @RF00556                                         02S0556
*                                 OLDFLG(K+1)=0;/* YES - INDICATE END
*                                      OF PATTERNS                   */
         LR    @07,K                                            02S0557
         SLA   @07,2                                            02S0557
         STC   @14,OLDFLG(@07)                                  02S0557
*                               ELSE                            02S0558
*                                 DO;/* NO - MODIFY PATTERNS    02S0558
*                                      ACCORDINGLY                   */
         B     @RC00556                                         02S0558
@RF00556 DS    0H                                               02S0559
*                                   OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/*
*                                      SET DATA LENGTH TO ZERO       */
         LR    @14,K                                            02S0559
         SLA   @14,2                                            02S0559
         SLR   @05,@05                                          02S0559
         IC    @05,OLDLN(@14)                                   02S0559
         N     @05,@CF00297                                     02S0559
         STC   @05,OLDLN(@14)                                   02S0559
*                                   OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/*
*                                      NEW DATA LENGTH               */
         LR    @03,MOD                                          02S0560
         BCTR  @03,0                                            02S0560
         OR    @05,@03                                          02S0560
         STC   @05,OLDLN(@14)                                   02S0560
*                                   OLDFLG(K+2)=0;/* INDICATE END OF
*                                      PATTERNS                      */
         SLR   @07,@07                                          02S0561
         STC   @07,OLDFLG+4(@14)                                02S0561
*                                 END;                          02S0562
*                             END;                              02S0563
@RC00556 DS    0H                                               02S0564
*                         END;                                  02S0564
@RC00547 DS    0H                                               02S0565
*                     END;                                      02S0565
@RC00544 DS    0H                                               02S0566
*                   ADPLFMT1=ADDR(GP4TYP2);/* ADDR OF LABEL FOR THIS
*                                      LINE                          */
@RC00538 L     @14,ABDPLPTR(,PLISTPTR)                          02S0566
         LA    @07,GP4TYP2                                      02S0566
         ST    @07,ADPLFMT1(,@14)                               02S0566
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */
         LA    @07,1                                            02S0567
         AL    @07,FIELDADR                                     02S0567
         ST    @07,ADPLFMT2(,@14)                               02S0567
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0568
         BALR  @14,@15                                          02S0568
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0569
*                 END;                                          02S0570
*             END;                                              02S0571
*         END;                                                  02S0572
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0573
*     END S26;                      /* END OF SUBCASE                */
*                                                               02S0575
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 27. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A 16 BYTE PLIST + A VOL-SER + A VARIABLE */
*     /* DSNAME/TTR.                                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0575
*S27:                                                           02S0575
*     DO;                           /* SUBCASE                       */
S27      DS    0H                                               02S0576
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0576
         CH    @14,TIMESW                                       02S0576
         BNE   @RF00576                                         02S0576
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0577
*       ELSE                                                    02S0578
*         DO;                       /* YES - REGISTERS HAVE BEEN
*                                      FORMATTED                     */
         B     @RC00576                                         02S0578
@RF00576 DS    0H                                               02S0579
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE
*                                      BEEN FORMATTED                */
         CLC   TIMESW(2),@CH00046                               02S0579
         BNE   @RF00579                                         02S0579
*             DO;                   /* NO                            */
*               DYNAMPTN(1:LENGTH(GP4S27A))=GP4S27A;/* MOVE PATTERNS
*                                      TO GETMAIN AREA               */
         MVC   DYNAMPTN(21),GP4S27A                             02S0581
*               IF RCD27LST=ASTER16×RCD27LST=PEES16×RCD27LST=ESSES16
*                 THEN              /* IS FIELD IN ERROR             */
         LA    @14,46                                           02S0582
         AL    @14,DATAPTR(,PLISTPTR)                           02S0582
         CLC   RCD27LST(16,@14),ASTER16                         02S0582
         BE    @RT00582                                         02S0582
         CLC   RCD27LST(16,@14),PEES16                          02S0582
         BE    @RT00582                                         02S0582
         CLC   RCD27LST(16,@14),ESSES16                         02S0582
         BNE   @RF00582                                         02S0582
@RT00582 DS    0H                                               02S0583
*                 DO;               /* YES                           */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S0584
         SLR   @07,@07                                          02S0584
         IC    @07,OLDFLG                                       02S0584
         OR    @07,@14                                          02S0584
         STC   @07,OLDFLG                                       02S0584
*                   OLDFLG(2)=OLDFLG(2)×CHARFLAG;               02S0585
         SLR   @07,@07                                          02S0585
         IC    @07,OLDFLG+4                                     02S0585
         OR    @07,@14                                          02S0585
         STC   @07,OLDFLG+4                                     02S0585
*                   OLDFLG(3)=OLDFLG(3)×CHARFLAG;               02S0586
         SLR   @07,@07                                          02S0586
         IC    @07,OLDFLG+8                                     02S0586
         OR    @07,@14                                          02S0586
         STC   @07,OLDFLG+8                                     02S0586
*                   OLDFLG(4)=OLDFLG(4)×CHARFLAG;               02S0587
         SLR   @07,@07                                          02S0587
         IC    @07,OLDFLG+12                                    02S0587
         OR    @14,@07                                          02S0587
         STC   @14,OLDFLG+12                                    02S0587
*                 END;                                          02S0588
*               ADPLFMT1=ADDR(GP4TYP10);/* ADDR OF LABELS FOR THIS
*                                      LINE                          */
@RF00582 L     @14,ABDPLPTR(,PLISTPTR)                          02S0589
         LA    @07,GP4TYP10                                     02S0589
         ST    @07,ADPLFMT1(,@14)                               02S0589
*               ADPLFMT2=ADDR(RCD27LST);/* ADDR OF DATA IN BUFFER    */
         LA    @07,46                                           02S0590
         AL    @07,DATAPTR(,PLISTPTR)                           02S0590
         ST    @07,ADPLFMT2(,@14)                               02S0590
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0591
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0592
         BALR  @14,@15                                          02S0592
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR THIRD PASS         */
         SLR   RETCODE,RETCODE                                  02S0593
*             END;                                              02S0594
*           ELSE                                                02S0595
*             DO;                   /* YES - FORMAT THE THIRD LINE   */
         B     @RC00579                                         02S0595
@RF00579 DS    0H                                               02S0596
*               DYNAMPTN(1:LENGTH(GP4S27B))=GP4S27B;/* MOVE PATTERNS
*                                      TO GETMAIN AREA               */
         MVC   DYNAMPTN(13),GP4S27B                             02S0596
*               IF RCD27LN^=ERROR THEN/* IS FIELD IN ERROR           */
         LA    @14,46                                           02S0597
         AL    @14,DATAPTR(,PLISTPTR)                           02S0597
         CLI   RCD27LN(@14),255                                 02S0597
         BE    @RF00597                                         02S0597
*                 DO;               /* NO                            */
*                   IF RCD27LN^=44 THEN/* IS DSN MAX LENGTH          */
         CLI   RCD27LN(@14),44                                  02S0599
         BE    @RF00599                                         02S0599
*                     DO;           /* NO                            */
*                       K=RCD27LN/16;/* NUMBER OF FULL WORDS         */
         SLR   @05,@05                                          02S0601
         IC    @05,RCD27LN(,@14)                                02S0601
         LR    K,@05                                            02S0601
         SRL   K,4                                              02S0601
*                       MOD=RCD27LN//16;/* REMAINDER OF PARTIAL WORD */
         LR    @02,@05                                          02S0602
         SRDA  @02,32                                           02S0602
         D     @02,@CF00139                                     02S0602
         LR    MOD,@02                                          02S0602
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */
         SLR   @14,@14                                          02S0603
         CR    MOD,@14                                          02S0603
         BNE   @RF00603                                         02S0603
*                         OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0604
         SLA   @07,2                                            02S0604
         STC   @14,OLDFLG(@07)                                  02S0604
*                       ELSE                                    02S0605
*                         DO;       /* NO - MODIFY PATTERNS     02S0605
*                                      ACCORDINGLY                   */
         B     @RC00603                                         02S0605
@RF00603 DS    0H                                               02S0606
*                           OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET DATA
*                                      LENGTH TO ZERO                */
         LR    @14,K                                            02S0606
         SLA   @14,2                                            02S0606
         SLR   @05,@05                                          02S0606
         IC    @05,OLDLN(@14)                                   02S0606
         N     @05,@CF00297                                     02S0606
         STC   @05,OLDLN(@14)                                   02S0606
*                           OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW DATA
*                                      LENGTH                        */
         LR    @03,MOD                                          02S0607
         BCTR  @03,0                                            02S0607
         OR    @05,@03                                          02S0607
         STC   @05,OLDLN(@14)                                   02S0607
*                           OLDFLG(K+2)=0;/* INDICATE END OF PATTERNS*/
         SLR   @07,@07                                          02S0608
         STC   @07,OLDFLG+4(@14)                                02S0608
*                         END;                                  02S0609
*                     END;                                      02S0610
*                 END;                                          02S0611
*               ELSE                                            02S0612
*                 DO;               /* YES - FIELD IS IN ERROR       */
         B     @RC00597                                         02S0612
@RF00597 DS    0H                                               02S0613
*                   OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH    */
         SLR   @14,@14                                          02S0613
         IC    @14,OLDLN                                        02S0613
         N     @14,@CF00297                                     02S0613
         STC   @14,OLDLN                                        02S0613
*                   OLDLN(1)=OLDLN(1)×DATALN4;/* SET DATA LENGTH TO
*                                      FORMAT 4 BYTES                */
         O     @14,@CF00170                                     02S0614
         STC   @14,OLDLN                                        02S0614
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0615
*                 END;                                          02S0616
*               ADPLFMT1=ADDR(GP4TP10A);/* ADDR OF LABELS FOR THIS
*                                      LINE                          */
@RC00597 L     @14,ABDPLPTR(,PLISTPTR)                          02S0617
         LA    @07,GP4TP10A                                     02S0617
         ST    @07,ADPLFMT1(,@14)                               02S0617
*               ADPLFMT2=ADDR(RCD27LN)+1;/* ADDR OF DATA IN BUFFER   */
         L     @07,DATAPTR(,PLISTPTR)                           02S0618
         LA    @07,RCD27LN+46(,@07)                             02S0618
         AH    @07,@CH00046                                     02S0618
         ST    @07,ADPLFMT2(,@14)                               02S0618
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0619
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0620
         BALR  @14,@15                                          02S0620
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0621
*             END;                                              02S0622
*         END;                                                  02S0623
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0624
*     END S27;                      /* END OF SUBCASE                */
*                                                               02S0626
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 29. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A 16 BYTE PLIST + A VARIABLE LENGTH      */
*     /* DSNAME + A VARIABLE LENGTH VOLIST.                          */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0626
*S29:                                                           02S0626
*     DO;                           /* SUBCASE                       */
S29      DS    0H                                               02S0627
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0627
         CH    @14,TIMESW                                       02S0627
         BNE   @RF00627                                         02S0627
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0628
*       ELSE                                                    02S0629
*         DO;                       /* YES - REGISTERS HAVE BEEN
*                                      FORMATTED                     */
         B     @RC00627                                         02S0629
@RF00627 DS    0H                                               02S0630
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE
*                                      BEEN FORMATTED                */
         CLC   TIMESW(2),@CH00046                               02S0630
         BNE   @RF00630                                         02S0630
*             DO;                   /* NO                            */
*               DYNAMPTN(1:LENGTH(GP4S26A))=GP4S26A;/* MOVE PATTERNS
*                                      TO GETMAIN AREA               */
         MVC   DYNAMPTN(21),GP4S26A                             02S0632
*               IF RCD29LST=ASTER16×RCD29LST=PEES16×RCD29LST=ESSES16
*                 THEN              /* IS FIELD IN ERROR             */
         LA    @14,46                                           02S0633
         AL    @14,DATAPTR(,PLISTPTR)                           02S0633
         CLC   RCD29LST(16,@14),ASTER16                         02S0633
         BE    @RT00633                                         02S0633
         CLC   RCD29LST(16,@14),PEES16                          02S0633
         BE    @RT00633                                         02S0633
         CLC   RCD29LST(16,@14),ESSES16                         02S0633
         BNE   @RF00633                                         02S0633
@RT00633 DS    0H                                               02S0634
*                 DO;               /* YES                           */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S0635
         SLR   @07,@07                                          02S0635
         IC    @07,OLDFLG                                       02S0635
         OR    @07,@14                                          02S0635
         STC   @07,OLDFLG                                       02S0635
*                   OLDFLG(2)=OLDFLG(2)×CHARFLAG;               02S0636
         SLR   @07,@07                                          02S0636
         IC    @07,OLDFLG+4                                     02S0636
         OR    @07,@14                                          02S0636
         STC   @07,OLDFLG+4                                     02S0636
*                   OLDFLG(3)=OLDFLG(3)×CHARFLAG;               02S0637
         SLR   @07,@07                                          02S0637
         IC    @07,OLDFLG+8                                     02S0637
         OR    @07,@14                                          02S0637
         STC   @07,OLDFLG+8                                     02S0637
*                   OLDFLG(4)=OLDFLG(4)×CHARFLAG;               02S0638
         SLR   @07,@07                                          02S0638
         IC    @07,OLDFLG+12                                    02S0638
         OR    @14,@07                                          02S0638
         STC   @14,OLDFLG+12                                    02S0638
*                 END;                                          02S0639
*               OLDFLG(5)=0;        /* INDICATE END OF PATTERNS      */
@RF00633 MVI   OLDFLG+16,X'00'                                  02S0640
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABELS FOR THIS LINE*/
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0641
         LA    @07,GROUP2                                       02S0641
         ST    @07,ADPLFMT1(,@14)                               02S0641
*               ADPLFMT2=ADDR(RCD29LST);/* ADDR OF DATA IN BUFFER    */
         LA    @07,46                                           02S0642
         AL    @07,DATAPTR(,PLISTPTR)                           02S0642
         ST    @07,ADPLFMT2(,@14)                               02S0642
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0643
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0644
         BALR  @14,@15                                          02S0644
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR THIRD PASS         */
         SLR   RETCODE,RETCODE                                  02S0645
*             END;                                              02S0646
*           ELSE                                                02S0647
*             DO;                   /* YES                           */
         B     @RC00630                                         02S0647
@RF00630 DS    0H                                               02S0648
*               IF TIMESW=2 THEN    /* HAS THIRD LINE BEEN FORMATTED */
         CLC   TIMESW(2),@CH00078                               02S0648
         BNE   @RF00648                                         02S0648
*                 DO;               /* NO                            */
*                   DYNAMPTN(1:LENGTH(GP4S26B))=GP4S26B;/* MOVE 02S0650
*                                      PATTERNS TO GETMAIN AREA      */
         MVC   DYNAMPTN(13),GP4S26B                             02S0650
*                   IF RCD29LN^=ERROR THEN/* IS FIELD IN ERROR       */
         LA    @14,46                                           02S0651
         AL    @14,DATAPTR(,PLISTPTR)                           02S0651
         CLI   RCD29LN(@14),255                                 02S0651
         BE    @RF00651                                         02S0651
*                     DO;           /* NO                            */
*                       IF RCD29LN^=44 THEN/* IS DSN MAX LENGTH      */
         CLI   RCD29LN(@14),44                                  02S0653
         BE    @RF00653                                         02S0653
*                         DO;       /* NO                            */
*                           K=RCD29LN/16;/* NUMBER OF FULL WORDS     */
         SLR   @05,@05                                          02S0655
         IC    @05,RCD29LN(,@14)                                02S0655
         LR    K,@05                                            02S0655
         SRL   K,4                                              02S0655
*                           MOD=RCD29LN//16;/* REMAINDER OF PARTIAL
*                                      WORD                          */
         LR    @02,@05                                          02S0656
         SRDA  @02,32                                           02S0656
         D     @02,@CF00139                                     02S0656
         LR    MOD,@02                                          02S0656
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */
         SLR   @14,@14                                          02S0657
         CR    MOD,@14                                          02S0657
         BNE   @RF00657                                         02S0657
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0658
         SLA   @07,2                                            02S0658
         STC   @14,OLDFLG(@07)                                  02S0658
*                           ELSE                                02S0659
*                             DO;   /* NO - MODIFY PATTERNS     02S0659
*                                      ACCORDINGLY                   */
         B     @RC00657                                         02S0659
@RF00657 DS    0H                                               02S0660
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET
*                                      DATA LENGTH TO ZERO           */
         LR    @14,K                                            02S0660
         SLA   @14,2                                            02S0660
         SLR   @05,@05                                          02S0660
         IC    @05,OLDLN(@14)                                   02S0660
         N     @05,@CF00297                                     02S0660
         STC   @05,OLDLN(@14)                                   02S0660
*                               OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW
*                                      DATA LENGTH                   */
         LR    @03,MOD                                          02S0661
         BCTR  @03,0                                            02S0661
         OR    @05,@03                                          02S0661
         STC   @05,OLDLN(@14)                                   02S0661
*                               OLDFLG(K+2)=0;/* INDICATE END OF
*                                      PATTERNS                      */
         SLR   @07,@07                                          02S0662
         STC   @07,OLDFLG+4(@14)                                02S0662
*                             END;                              02S0663
*                         END;                                  02S0664
*                     END;                                      02S0665
*                   ELSE                                        02S0666
*                     DO;           /* YES - FIELD IS IN ERROR       */
         B     @RC00651                                         02S0666
@RF00651 DS    0H                                               02S0667
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH*/
         SLR   @14,@14                                          02S0667
         IC    @14,OLDLN                                        02S0667
         N     @14,@CF00297                                     02S0667
         STC   @14,OLDLN                                        02S0667
*                       OLDLN(1)=OLDLN(1)×DATALN4;/* SET DATA LENGTH
*                                      TO FORMAT 4 BYTES             */
         O     @14,@CF00170                                     02S0668
         STC   @14,OLDLN                                        02S0668
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0669
*                       RCD29LN=4;  /* MODIFY LENGTH IN ORDER TO
*                                      ACCESS NEXT FIELD             */
         L     @14,DATAPTR(,PLISTPTR)                           02S0670
         MVI   RCD29LN+46(@14),X'04'                            02S0670
*                     END;                                      02S0671
*                   ADPLFMT1=ADDR(GP4TYP9A);/* ADDR OF LABELS FOR
*                                      THIS LINE                     */
@RC00651 L     @14,ABDPLPTR(,PLISTPTR)                          02S0672
         LA    @07,GP4TYP9A                                     02S0672
         ST    @07,ADPLFMT1(,@14)                               02S0672
*                   ADPLFMT2=ADDR(RCD29LN)+1;/* ADDR OF DATA IN 02S0673
*                                      BUFFER                        */
         L     @07,DATAPTR(,PLISTPTR)                           02S0673
         LA    @07,RCD29LN+46(,@07)                             02S0673
         AH    @07,@CH00046                                     02S0673
         ST    @07,ADPLFMT2(,@14)                               02S0673
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */
         LA    R0,DYNAMPTN                                      02S0674
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0675
         BALR  @14,@15                                          02S0675
*                   RETCODE=0;      /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR 4TH PASS   @YM03666*/
         SLR   RETCODE,RETCODE                                  02S0676
*                 END;                                          02S0677
*               ELSE                                            02S0678
*                 DO;               /* YES - FORMAT THE FOURTH LINE  */
         B     @RC00648                                         02S0678
@RF00648 DS    0H                                               02S0679
*                   DYNAMPTN(1:LENGTH(GP4S26C))=GP4S26C;/* MOVE 02S0679
*                                      PATTERNS TO GETMAIN AREA      */
         MVC   DYNAMPTN(41),GP4S26C                             02S0679
*                   FIELDADR=ADDR(RCD29LN)+RCD29LN+1;/* ADDR OF 02S0680
*                                      VOLIST IN BUFFER              */
         LA    @14,46                                           02S0680
         AL    @14,DATAPTR(,PLISTPTR)                           02S0680
         LA    @07,RCD29LN(,@14)                                02S0680
         SLR   @05,@05                                          02S0680
         IC    @05,RCD29LN(,@14)                                02S0680
         ALR   @07,@05                                          02S0680
         AH    @07,@CH00046                                     02S0680
         ST    @07,FIELDADR                                     02S0680
*                   IF NXTFIELD=ERROR THEN/* IS FIELD IN ERROR       */
         CLI   NXTFIELD(@07),255                                02S0681
         BNE   @RF00681                                         02S0681
*                     DO;           /* YES - ONLY FORMAT 4 BYTES     */
*                       OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA
*                                      IN EBCDIC                     */
         SLR   @14,@14                                          02S0683
         IC    @14,OLDFLG                                       02S0683
         O     @14,@CF00092                                     02S0683
         STC   @14,OLDFLG                                       02S0683
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0684
*                     END;                                      02S0685
*                   ELSE                                        02S0686
*                     DO;           /* NO - DETERMINE HOW MANY BYTES
*                                      IN VOLIST                     */
         B     @RC00681                                         02S0686
@RF00681 DS    0H                                               02S0687
*                       IF NXTFIELD<4 THEN/* IS VOLIST LESS THAN ONE
*                                      WORD                          */
         L     @14,FIELDADR                                     02S0687
         CLI   NXTFIELD(@14),4                                  02S0687
         BNL   @RF00687                                         02S0687
*                         DO;       /* YES                           */
*                           OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA
*                                      LENGTH TO 0                   */
         SLR   @07,@07                                          02S0689
         IC    @07,OLDLN                                        02S0689
         N     @07,@CF00297                                     02S0689
         STC   @07,OLDLN                                        02S0689
*                           OLDLN(1)=OLDLN(1)×(NXTFIELD-1);/* NEW
*                                      DATA LENGTH                   */
         SLR   @05,@05                                          02S0690
         IC    @05,NXTFIELD(,@14)                               02S0690
         BCTR  @05,0                                            02S0690
         OR    @07,@05                                          02S0690
         STC   @07,OLDLN                                        02S0690
*                           OLDFLG(2)=0;/* INDICATE END OF PATTERNS  */
         MVI   OLDFLG+4,X'00'                                   02S0691
*                         END;                                  02S0692
*                       ELSE                                    02S0693
*                         DO;       /* NO - MODIFY PATTERNS          */
         B     @RC00687                                         02S0693
@RF00687 DS    0H                                               02S0694
*                           K=NXTFIELD/4;/* NUMBER OF FULL WORDS     */
         L     @14,FIELDADR                                     02S0694
         SLR   @05,@05                                          02S0694
         IC    @05,NXTFIELD(,@14)                               02S0694
         LR    K,@05                                            02S0694
         SRL   K,2                                              02S0694
*                           MOD=NXTFIELD//4;/* REMAINDER OF PARTIAL
*                                      WORD                          */
         LR    @02,@05                                          02S0695
         SRDA  @02,32                                           02S0695
         D     @02,@CF00099                                     02S0695
         LR    MOD,@02                                          02S0695
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */
         SLR   @14,@14                                          02S0696
         CR    MOD,@14                                          02S0696
         BNE   @RF00696                                         02S0696
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0697
         SLA   @07,2                                            02S0697
         STC   @14,OLDFLG(@07)                                  02S0697
*                           ELSE                                02S0698
*                             DO;   /* NO - MODIFY PATTERNS     02S0698
*                                      ACCORDINGLY                   */
         B     @RC00696                                         02S0698
@RF00696 DS    0H                                               02S0699
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET
*                                      DATA LENGTH TO ZERO           */
         LR    @14,K                                            02S0699
         SLA   @14,2                                            02S0699
         SLR   @05,@05                                          02S0699
         IC    @05,OLDLN(@14)                                   02S0699
         N     @05,@CF00297                                     02S0699
         STC   @05,OLDLN(@14)                                   02S0699
*                               OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW
*                                      DATA LENGTH                   */
         LR    @03,MOD                                          02S0700
         BCTR  @03,0                                            02S0700
         OR    @05,@03                                          02S0700
         STC   @05,OLDLN(@14)                                   02S0700
*                               OLDFLG(K+2)=0;/* INDICATE END OF
*                                      PATTERNS                      */
         SLR   @07,@07                                          02S0701
         STC   @07,OLDFLG+4(@14)                                02S0701
*                             END;                              02S0702
*                         END;                                  02S0703
@RC00696 DS    0H                                               02S0704
*                     END;                                      02S0704
@RC00687 DS    0H                                               02S0705
*                   ADPLFMT1=ADDR(GP4TYP2);/* ADDR OF LABEL FOR THIS
*                                      LINE                          */
@RC00681 L     @14,ABDPLPTR(,PLISTPTR)                          02S0705
         LA    @07,GP4TYP2                                      02S0705
         ST    @07,ADPLFMT1(,@14)                               02S0705
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */
         LA    @07,1                                            02S0706
         AL    @07,FIELDADR                                     02S0706
         ST    @07,ADPLFMT2(,@14)                               02S0706
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */
         LA    R0,DYNAMPTN                                      02S0707
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0708
         BALR  @14,@15                                          02S0708
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0709
*                 END;                                          02S0710
*             END;                                              02S0711
*         END;                                                  02S0712
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0713
*     END S29;                      /* END OF SUBCASE                */
*                                                               02S0715
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 30. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A 16 BYTE PLIST + VARIABLE LENGTH OLD AND*/
*     /* NEW DSNAMES + A VARIABLE LENGTH VOLIST.                     */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0715
*S30:                                                           02S0715
*     DO;                           /* SUBCASE                       */
S30      DS    0H                                               02S0716
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0716
         CH    @14,TIMESW                                       02S0716
         BNE   @RF00716                                         02S0716
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0717
*       ELSE                                                    02S0718
*         DO;                       /* YES - REGISTERS HAVE BEEN
*                                      FORMATTED                     */
         B     @RC00716                                         02S0718
@RF00716 DS    0H                                               02S0719
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE
*                                      BEEN FORMATTED                */
         CLC   TIMESW(2),@CH00046                               02S0719
         BNE   @RF00719                                         02S0719
*             DO;                   /* NO                            */
*               DYNAMPTN(1:LENGTH(GP4S30A))=GP4S30A;/* MOVE PATTERNS
*                                      TO GETMAIN AREA               */
         MVC   DYNAMPTN(17),GP4S30A                             02S0721
*               IF RCD30LST=ASTER16×RCD30LST=PEES16×RCD30LST=ESSES16
*                 THEN              /* IS FIELD IN ERROR             */
         LA    @14,46                                           02S0722
         AL    @14,DATAPTR(,PLISTPTR)                           02S0722
         CLC   RCD30LST(16,@14),ASTER16                         02S0722
         BE    @RT00722                                         02S0722
         CLC   RCD30LST(16,@14),PEES16                          02S0722
         BE    @RT00722                                         02S0722
         CLC   RCD30LST(16,@14),ESSES16                         02S0722
         BNE   @RF00722                                         02S0722
@RT00722 DS    0H                                               02S0723
*                 DO;               /* YES                           */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S0724
         SLR   @07,@07                                          02S0724
         IC    @07,OLDFLG                                       02S0724
         OR    @07,@14                                          02S0724
         STC   @07,OLDFLG                                       02S0724
*                   OLDFLG(2)=OLDFLG(2)×CHARFLAG;               02S0725
         SLR   @07,@07                                          02S0725
         IC    @07,OLDFLG+4                                     02S0725
         OR    @07,@14                                          02S0725
         STC   @07,OLDFLG+4                                     02S0725
*                   OLDFLG(3)=OLDFLG(3)×CHARFLAG;               02S0726
         SLR   @07,@07                                          02S0726
         IC    @07,OLDFLG+8                                     02S0726
         OR    @07,@14                                          02S0726
         STC   @07,OLDFLG+8                                     02S0726
*                   OLDFLG(4)=OLDFLG(4)×CHARFLAG;               02S0727
         SLR   @07,@07                                          02S0727
         IC    @07,OLDFLG+12                                    02S0727
         OR    @14,@07                                          02S0727
         STC   @14,OLDFLG+12                                    02S0727
*                 END;                                          02S0728
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABELS FOR THIS LINE*/
@RF00722 L     @14,ABDPLPTR(,PLISTPTR)                          02S0729
         LA    @07,GROUP2                                       02S0729
         ST    @07,ADPLFMT1(,@14)                               02S0729
*               ADPLFMT2=ADDR(RCD30LST);/* ADDR OF DATA IN BUFFER    */
         LA    @07,46                                           02S0730
         AL    @07,DATAPTR(,PLISTPTR)                           02S0730
         ST    @07,ADPLFMT2(,@14)                               02S0730
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0731
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0732
         BALR  @14,@15                                          02S0732
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR THIRD PASS         */
         SLR   RETCODE,RETCODE                                  02S0733
*             END;                                              02S0734
*           ELSE                                                02S0735
*             DO;                   /* YES                           */
         B     @RC00719                                         02S0735
@RF00719 DS    0H                                               02S0736
*               IF TIMESW=2 THEN    /* HAS THIRD LINE BEEN FORMATTED */
         CLC   TIMESW(2),@CH00078                               02S0736
         BNE   @RF00736                                         02S0736
*                 DO;               /* NO                            */
*                   DYNAMPTN(1:LENGTH(GP4S30B))=GP4S30B;/* MOVE 02S0738
*                                      PATTERNS TO GETMAIN AREA      */
         MVC   DYNAMPTN(13),GP4S30B                             02S0738
*                   IF RCD30LN^=ERROR THEN/* IS FIELD IN ERROR       */
         LA    @14,46                                           02S0739
         AL    @14,DATAPTR(,PLISTPTR)                           02S0739
         CLI   RCD30LN(@14),255                                 02S0739
         BE    @RF00739                                         02S0739
*                     DO;           /* NO                            */
*                       IF RCD30LN^=44 THEN/* IS DSN MAX LENGTH      */
         CLI   RCD30LN(@14),44                                  02S0741
         BE    @RF00741                                         02S0741
*                         DO;       /* NO                            */
*                           K=RCD30LN/16;/* NUMBER OF FULL WORDS     */
         SLR   @05,@05                                          02S0743
         IC    @05,RCD30LN(,@14)                                02S0743
         LR    K,@05                                            02S0743
         SRL   K,4                                              02S0743
*                           MOD=RCD30LN//16;/* REMAINDER OF PARTIAL
*                                      WORD                          */
         LR    @02,@05                                          02S0744
         SRDA  @02,32                                           02S0744
         D     @02,@CF00139                                     02S0744
         LR    MOD,@02                                          02S0744
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */
         SLR   @14,@14                                          02S0745
         CR    MOD,@14                                          02S0745
         BNE   @RF00745                                         02S0745
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0746
         SLA   @07,2                                            02S0746
         STC   @14,OLDFLG(@07)                                  02S0746
*                           ELSE                                02S0747
*                             DO;   /* NO - MODIFY PATTERNS     02S0747
*                                      ACCORDINGLY                   */
         B     @RC00745                                         02S0747
@RF00745 DS    0H                                               02S0748
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET
*                                      DATA LENGTH TO ZERO           */
         LR    @14,K                                            02S0748
         SLA   @14,2                                            02S0748
         SLR   @05,@05                                          02S0748
         IC    @05,OLDLN(@14)                                   02S0748
         N     @05,@CF00297                                     02S0748
         STC   @05,OLDLN(@14)                                   02S0748
*                               OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW
*                                      DATA LENGTH                   */
         LR    @03,MOD                                          02S0749
         BCTR  @03,0                                            02S0749
         OR    @05,@03                                          02S0749
         STC   @05,OLDLN(@14)                                   02S0749
*                               OLDFLG(K+2)=0;/* INDICATE END OF
*                                      PATTERNS                      */
         SLR   @07,@07                                          02S0750
         STC   @07,OLDFLG+4(@14)                                02S0750
*                             END;                              02S0751
*                         END;                                  02S0752
*                     END;                                      02S0753
*                   ELSE                                        02S0754
*                     DO;           /* YES - FIELD IS IN ERROR       */
         B     @RC00739                                         02S0754
@RF00739 DS    0H                                               02S0755
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH*/
         SLR   @14,@14                                          02S0755
         IC    @14,OLDLN                                        02S0755
         N     @14,@CF00297                                     02S0755
         STC   @14,OLDLN                                        02S0755
*                       OLDLN(1)=OLDLN(1)×DATALN4;/* SET DATA LENGTH
*                                      TO FORMAT 4 BYTES             */
         O     @14,@CF00170                                     02S0756
         STC   @14,OLDLN                                        02S0756
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0757
*                       RCD30LN=4;  /* MODIFY LENGTH IN ORDER TO
*                                      ACCESS NEXT FIELD             */
         L     @14,DATAPTR(,PLISTPTR)                           02S0758
         MVI   RCD30LN+46(@14),X'04'                            02S0758
*                     END;                                      02S0759
*                   ADPLFMT1=ADDR(GP4TYP12);/* ADDR OF LABELS FOR
*                                      THIS LINE                     */
@RC00739 L     @14,ABDPLPTR(,PLISTPTR)                          02S0760
         LA    @07,GP4TYP12                                     02S0760
         ST    @07,ADPLFMT1(,@14)                               02S0760
*                   ADPLFMT2=ADDR(RCD30LN)+1;/* ADDR OF DATA IN 02S0761
*                                      BUFFER                        */
         L     @07,DATAPTR(,PLISTPTR)                           02S0761
         LA    @07,RCD30LN+46(,@07)                             02S0761
         AH    @07,@CH00046                                     02S0761
         ST    @07,ADPLFMT2(,@14)                               02S0761
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */
         LA    R0,DYNAMPTN                                      02S0762
*                   CALL AMDPRFMT;  /* FORMAT THE OLD DSN            */
         L     @15,FMTADDR(,PLISTPTR)                           02S0763
         BALR  @14,@15                                          02S0763
*                   DYNAMPTN(1:LENGTH(GP4S30C))=GP4S30C;/* MOVE 02S0764
*                                      PATTERNS TO GETMAIN AREA      */
         MVC   DYNAMPTN(13),GP4S30C                             02S0764
*                   FIELDADR=ADDR(RCD30LN)+RCD30LN+1;/* ADDRESS OF
*                                      NEW DSN FIELD IN BUFFER       */
         LA    @14,46                                           02S0765
         AL    @14,DATAPTR(,PLISTPTR)                           02S0765
         LA    @07,RCD30LN(,@14)                                02S0765
         SLR   @05,@05                                          02S0765
         IC    @05,RCD30LN(,@14)                                02S0765
         ALR   @07,@05                                          02S0765
         AH    @07,@CH00046                                     02S0765
         ST    @07,FIELDADR                                     02S0765
*                   IF NXTFIELD^=ERROR THEN/* IS FIELD IN ERROR      */
         CLI   NXTFIELD(@07),255                                02S0766
         BE    @RF00766                                         02S0766
*                     DO;           /* NO                            */
*                       IF NXTFIELD^=44 THEN/* IS DSN MAX LENGTH     */
         CLI   NXTFIELD(@07),44                                 02S0768
         BE    @RF00768                                         02S0768
*                         DO;       /* NO                            */
*                           K=NXTFIELD/16;/* NUMBER OF FULL WORDS    */
         L     @14,FIELDADR                                     02S0770
         SLR   @05,@05                                          02S0770
         IC    @05,NXTFIELD(,@14)                               02S0770
         LR    K,@05                                            02S0770
         SRL   K,4                                              02S0770
*                           MOD=NXTFIELD//16;/* REMAINDER OF PARTIAL
*                                      WORD                          */
         LR    @02,@05                                          02S0771
         SRDA  @02,32                                           02S0771
         D     @02,@CF00139                                     02S0771
         LR    MOD,@02                                          02S0771
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */
         SLR   @14,@14                                          02S0772
         CR    MOD,@14                                          02S0772
         BNE   @RF00772                                         02S0772
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0773
         SLA   @07,2                                            02S0773
         STC   @14,OLDFLG(@07)                                  02S0773
*                           ELSE                                02S0774
*                             DO;   /* NO - MODIFY PATTERNS     02S0774
*                                      ACCORDINGLY                   */
         B     @RC00772                                         02S0774
@RF00772 DS    0H                                               02S0775
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET
*                                      DATA LENGTH TO ZERO           */
         LR    @14,K                                            02S0775
         SLA   @14,2                                            02S0775
         SLR   @05,@05                                          02S0775
         IC    @05,OLDLN(@14)                                   02S0775
         N     @05,@CF00297                                     02S0775
         STC   @05,OLDLN(@14)                                   02S0775
*                               OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW
*                                      DATA LENGTH                   */
         LR    @03,MOD                                          02S0776
         BCTR  @03,0                                            02S0776
         OR    @05,@03                                          02S0776
         STC   @05,OLDLN(@14)                                   02S0776
*                               OLDFLG(K+2)=0;/* INDICATE END OF
*                                      PATTERNS                      */
         SLR   @07,@07                                          02S0777
         STC   @07,OLDFLG+4(@14)                                02S0777
*                             END;                              02S0778
*                         END;                                  02S0779
*                     END;                                      02S0780
*                   ELSE                                        02S0781
*                     DO;           /* YES - FIELD IS IN ERROR       */
         B     @RC00766                                         02S0781
@RF00766 DS    0H                                               02S0782
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH*/
         SLR   @14,@14                                          02S0782
         IC    @14,OLDLN                                        02S0782
         N     @14,@CF00297                                     02S0782
         STC   @14,OLDLN                                        02S0782
*                       OLDLN(1)=OLDLN(1)×DATALN4;/* SET DATA LENGTH
*                                      TO FORMAT 4 BYTES             */
         O     @14,@CF00170                                     02S0783
         STC   @14,OLDLN                                        02S0783
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0784
*                       NXTFIELD=4; /* MODIFY LENGTH IN ORDER TO
*                                      ACCESS NEXT FIELD             */
         L     @14,FIELDADR                                     02S0785
         MVI   NXTFIELD(@14),X'04'                              02S0785
*                     END;                                      02S0786
*                   ADPLFMT1=ADDR(GP4TP12A);/* ADDR OF LABELS FOR
*                                      THIS LINE                     */
@RC00766 L     @14,ABDPLPTR(,PLISTPTR)                          02S0787
         LA    @07,GP4TP12A                                     02S0787
         ST    @07,ADPLFMT1(,@14)                               02S0787
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */
         LA    @07,1                                            02S0788
         AL    @07,FIELDADR                                     02S0788
         ST    @07,ADPLFMT2(,@14)                               02S0788
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */
         LA    R0,DYNAMPTN                                      02S0789
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0790
         BALR  @14,@15                                          02S0790
*                   RETCODE=0;      /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR FOURTH PASS        */
         SLR   RETCODE,RETCODE                                  02S0791
*                 END;                                          02S0792
*               ELSE                                            02S0793
*                 DO;               /* YES - FORMAT THE FOURTH LINE  */
         B     @RC00736                                         02S0793
@RF00736 DS    0H                                               02S0794
*                   DYNAMPTN(1:LENGTH(GP4S26C))=GP4S26C;/* MOVE 02S0794
*                                      PATTERNS TO GETMAIN AREA      */
         MVC   DYNAMPTN(41),GP4S26C                             02S0794
*                   FIELDADR=FIELDADR+NXTFIELD+1;/* ADDR OF VOLIST IN
*                                      BUFFER                        */
         L     @14,FIELDADR                                     02S0795
         SLR   @07,@07                                          02S0795
         IC    @07,NXTFIELD(,@14)                               02S0795
         ALR   @07,@14                                          02S0795
         AH    @07,@CH00046                                     02S0795
         ST    @07,FIELDADR                                     02S0795
*                   IF NXTFIELD=ERROR THEN/* IS FIELD IN ERROR       */
         CLI   NXTFIELD(@07),255                                02S0796
         BNE   @RF00796                                         02S0796
*                     DO;           /* YES - ONLY FORMAT 4 BYTES     */
*                       OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA
*                                      IN EBCDIC                     */
         SLR   @14,@14                                          02S0798
         IC    @14,OLDFLG                                       02S0798
         O     @14,@CF00092                                     02S0798
         STC   @14,OLDFLG                                       02S0798
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0799
*                     END;                                      02S0800
*                   ELSE                                        02S0801
*                     DO;           /* NO - DETERMINE HOW MANY BYTES
*                                      IN VOLIST                     */
         B     @RC00796                                         02S0801
@RF00796 DS    0H                                               02S0802
*                       IF NXTFIELD<4 THEN/* IS VOLIST LESS THAN ONE
*                                      WORD                          */
         L     @14,FIELDADR                                     02S0802
         CLI   NXTFIELD(@14),4                                  02S0802
         BNL   @RF00802                                         02S0802
*                         DO;       /* YES                           */
*                           OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA
*                                      LENGTH TO 0                   */
         SLR   @07,@07                                          02S0804
         IC    @07,OLDLN                                        02S0804
         N     @07,@CF00297                                     02S0804
         STC   @07,OLDLN                                        02S0804
*                           OLDLN(1)=OLDLN(1)×(NXTFIELD-1);/* NEW
*                                      DATA LENGTH                   */
         SLR   @05,@05                                          02S0805
         IC    @05,NXTFIELD(,@14)                               02S0805
         BCTR  @05,0                                            02S0805
         OR    @07,@05                                          02S0805
         STC   @07,OLDLN                                        02S0805
*                           OLDFLG(2)=0;/* INDICATE END OF PATTERNS  */
         MVI   OLDFLG+4,X'00'                                   02S0806
*                         END;                                  02S0807
*                       ELSE                                    02S0808
*                         DO;       /* NO - MODIFY PATTERNS          */
         B     @RC00802                                         02S0808
@RF00802 DS    0H                                               02S0809
*                           K=NXTFIELD/4;/* NUMBER OF FULL WORDS     */
         L     @14,FIELDADR                                     02S0809
         SLR   @05,@05                                          02S0809
         IC    @05,NXTFIELD(,@14)                               02S0809
         LR    K,@05                                            02S0809
         SRL   K,2                                              02S0809
*                           MOD=NXTFIELD//4;/* REMAINDER OF PARTIAL
*                                      WORD                          */
         LR    @02,@05                                          02S0810
         SRDA  @02,32                                           02S0810
         D     @02,@CF00099                                     02S0810
         LR    MOD,@02                                          02S0810
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */
         SLR   @14,@14                                          02S0811
         CR    MOD,@14                                          02S0811
         BNE   @RF00811                                         02S0811
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0812
         SLA   @07,2                                            02S0812
         STC   @14,OLDFLG(@07)                                  02S0812
*                           ELSE                                02S0813
*                             DO;   /* NO - MODIFY PATTERNS     02S0813
*                                      ACCORDINGLY                   */
         B     @RC00811                                         02S0813
@RF00811 DS    0H                                               02S0814
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET
*                                      DATA LENGTH TO ZERO           */
         LR    @14,K                                            02S0814
         SLA   @14,2                                            02S0814
         SLR   @05,@05                                          02S0814
         IC    @05,OLDLN(@14)                                   02S0814
         N     @05,@CF00297                                     02S0814
         STC   @05,OLDLN(@14)                                   02S0814
*                               OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW
*                                      DATA LENGTH                   */
         LR    @03,MOD                                          02S0815
         BCTR  @03,0                                            02S0815
         OR    @05,@03                                          02S0815
         STC   @05,OLDLN(@14)                                   02S0815
*                               OLDFLG(K+2)=0;/* INDICATE END OF
*                                      PATTERNS                      */
         SLR   @07,@07                                          02S0816
         STC   @07,OLDFLG+4(@14)                                02S0816
*                             END;                              02S0817
*                         END;                                  02S0818
@RC00811 DS    0H                                               02S0819
*                     END;                                      02S0819
@RC00802 DS    0H                                               02S0820
*                   ADPLFMT1=ADDR(GP4TYP2);/* ADDR OF LABEL FOR THIS
*                                      LINE                          */
@RC00796 L     @14,ABDPLPTR(,PLISTPTR)                          02S0820
         LA    @07,GP4TYP2                                      02S0820
         ST    @07,ADPLFMT1(,@14)                               02S0820
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */
         LA    @07,1                                            02S0821
         AL    @07,FIELDADR                                     02S0821
         ST    @07,ADPLFMT2(,@14)                               02S0821
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */
         LA    R0,DYNAMPTN                                      02S0822
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0823
         BALR  @14,@15                                          02S0823
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0824
*                 END;                                          02S0825
*             END;                                              02S0826
*         END;                                                  02S0827
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0828
*     END S30;                      /* END OF SUBCASE                */
*                                                               02S0830
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 32,33,78. THE */
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + A CUU + A VARIABLE*/
*     /* LENGTH DSNAME/A CUU ALONE.                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0830
*S32:                                                           02S0830
*     DO;                           /* SUBCASE                       */
S32      DS    0H                                               02S0831
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0831
         CH    @14,TIMESW                                       02S0831
         BNE   @RF00831                                         02S0831
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0832
*       ELSE                                                    02S0833
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS
*                                      & FORMAT THEM                 */
         B     @RC00831                                         02S0833
@RF00831 DS    0H                                               02S0834
*           DYNAMPTN(1:LENGTH(GP4S32))=GP4S32;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(21),GP4S32                              02S0834
*           IF RCD32CUU=ASTER2×RCD32CUU=PEES2×RCD32CUU=ESSES2 THEN/*
*                                      IS FIELD IN ERROR             */
         LA    @14,46                                           02S0835
         AL    @14,DATAPTR(,PLISTPTR)                           02S0835
         CLC   RCD32CUU(2,@14),ASTER2                           02S0835
         BE    @RT00835                                         02S0835
         CLC   RCD32CUU(2,@14),PEES2                            02S0835
         BE    @RT00835                                         02S0835
         CLC   RCD32CUU(2,@14),ESSES2                           02S0835
         BNE   @RF00835                                         02S0835
@RT00835 DS    0H                                               02S0836
*             OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN EBCDIC*/
         SLR   @14,@14                                          02S0836
         IC    @14,OLDFLG                                       02S0836
         O     @14,@CF00092                                     02S0836
         STC   @14,OLDFLG                                       02S0836
*           IF SVCNUMBR^=33 THEN    /* IS THIS SVC 33 OR 78          */
@RF00835 CH    SVCNUMBR,@CH00514                                02S0837
         BE    @RF00837                                         02S0837
*             OLDFLG(2)=0;          /* YES - INDICATE END OF PATTERNS*/
         MVI   OLDFLG+4,X'00'                                   02S0838
*           ELSE                                                02S0839
*             DO;                   /* NO - ITS SVC 32 - FORMAT THE
*                                      DDNAME ALSO                   */
         B     @RC00837                                         02S0839
@RF00837 DS    0H                                               02S0840
*               IF RCD32LN^=ERROR THEN/* IS FIELD IN ERROR           */
         LA    @14,46                                           02S0840
         AL    @14,DATAPTR(,PLISTPTR)                           02S0840
         CLI   RCD32LN(@14),255                                 02S0840
         BE    @RF00840                                         02S0840
*                 DO;               /* NO                            */
*                   IF RCD32LN^=44 THEN/* IS DSN MAX LENGTH          */
         CLI   RCD32LN(@14),44                                  02S0842
         BE    @RF00842                                         02S0842
*                     DO;           /* NO                            */
*                       K=RCD32LN/16;/* NUMBER OF FULL WORDS         */
         SLR   @05,@05                                          02S0844
         IC    @05,RCD32LN(,@14)                                02S0844
         LR    K,@05                                            02S0844
         SRL   K,4                                              02S0844
*                       MOD=RCD32LN//16;/* REMAINDER OF PARTIAL WORD */
         LR    @02,@05                                          02S0845
         SRDA  @02,32                                           02S0845
         D     @02,@CF00139                                     02S0845
         LR    MOD,@02                                          02S0845
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */
         SLR   @14,@14                                          02S0846
         CR    MOD,@14                                          02S0846
         BNE   @RF00846                                         02S0846
*                         OLDFLG(K+3)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0847
         SLA   @07,2                                            02S0847
         STC   @14,OLDFLG+8(@07)                                02S0847
*                       ELSE                                    02S0848
*                         DO;       /* NO - MODIFY PATTERNS     02S0848
*                                      ACCORDINGLY                   */
         B     @RC00846                                         02S0848
@RF00846 DS    0H                                               02S0849
*                           OLDLN(K+3)=OLDLN(K+3)&DATAOFF;/* SET DATA
*                                      LENGTH TO ZERO                */
         LR    @14,K                                            02S0849
         SLA   @14,2                                            02S0849
         SLR   @05,@05                                          02S0849
         IC    @05,OLDLN+8(@14)                                 02S0849
         N     @05,@CF00297                                     02S0849
         STC   @05,OLDLN+8(@14)                                 02S0849
*                           OLDLN(K+3)=OLDLN(K+3)×(MOD-1);/* NEW DATA
*                                      LENGTH                        */
         LR    @03,MOD                                          02S0850
         BCTR  @03,0                                            02S0850
         OR    @05,@03                                          02S0850
         STC   @05,OLDLN+8(@14)                                 02S0850
*                           OLDFLG(K+4)=0;/* INDICATE END OF PATTERNS*/
         SLR   @07,@07                                          02S0851
         STC   @07,OLDFLG+12(@14)                               02S0851
*                         END;                                  02S0852
*                     END;                                      02S0853
*                 END;                                          02S0854
*               ELSE                                            02S0855
*                 DO;               /* YES - FIELD IS IN ERROR       */
         B     @RC00840                                         02S0855
@RF00840 DS    0H                                               02S0856
*                   OLDLN(3)=OLDLN(3)&DATAOFF;/* ZERO DATA LENGTH    */
         SLR   @14,@14                                          02S0856
         IC    @14,OLDLN+8                                      02S0856
         N     @14,@CF00297                                     02S0856
         STC   @14,OLDLN+8                                      02S0856
*                   OLDLN(3)=OLDLN(3)×DATALN4;/* SET DATA LENGTH TO
*                                      FORMAT 4 BYTES                */
         O     @14,@CF00170                                     02S0857
         STC   @14,OLDLN+8                                      02S0857
*                   OLDFLG(4)=0;    /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+12,X'00'                                  02S0858
*                 END;                                          02S0859
*             END;                                              02S0860
@RC00840 DS    0H                                               02S0861
*           ADPLFMT1=ADDR(GP4TYP13);/* ADDR OF LABELS FOR THIS LINE  */
@RC00837 L     @14,ABDPLPTR(,PLISTPTR)                          02S0861
         LA    @07,GP4TYP13                                     02S0861
         ST    @07,ADPLFMT1(,@14)                               02S0861
*           ADPLFMT2=ADDR(RCD32CUU);/* ADDR OF DATA IN BUFFER        */
         LA    @07,46                                           02S0862
         AL    @07,DATAPTR(,PLISTPTR)                           02S0862
         ST    @07,ADPLFMT2(,@14)                               02S0862
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0863
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0864
         BALR  @14,@15                                          02S0864
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0865
*         END;                                                  02S0866
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0867
*     END S32;                      /* END OF SUBCASE                */
*                                                               02S0869
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 42. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A VARIABLE LENGTH SUPREVISOR LIST + A    */
*     /* VARIABLE LENGTH PROBLEM PROGRAM LIST.                       */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0869
*S42:                                                           02S0869
*     DO;                           /* SUBCASE                       */
S42      DS    0H                                               02S0870
*       IF TIMESW=0×TIMESW=1 THEN   /* HAS BASIC RECORD BEEN    02S0870
*                                      FORMATTED                     */
         LH    @14,TIMESW                                       02S0870
         LTR   @14,@14                                          02S0870
         BZ    @RT00870                                         02S0870
         CH    @14,@CH00046                                     02S0870
         BNE   @RF00870                                         02S0870
@RT00870 DS    0H                                               02S0871
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR THIRD PASS     */
         SLR   RETCODE,RETCODE                                  02S0871
*       ELSE                                                    02S0872
*         DO;                       /* YES                           */
         B     @RC00870                                         02S0872
@RF00870 DS    0H                                               02S0873
*           IF TIMESW=2 THEN        /* HAS THIRD LINE BEEN FORMATTED */
         CLC   TIMESW(2),@CH00078                               02S0873
         BNE   @RF00873                                         02S0873
*             DO;                   /* NO                            */
*               DYNAMPTN(1:LENGTH(GP4S42A))=GP4S42A;/* MOVE PATTERNS
*                                      TO GETMAIN AREA               */
         MVC   DYNAMPTN(37),GP4S42A                             02S0875
*               IF RCD42LN=ERROR THEN/* IS FIELD IN ERROR            */
         L     @14,DATAPTR(,PLISTPTR)                           02S0876
         CLI   RCD42LN+46(@14),255                              02S0876
         BNE   @RF00876                                         02S0876
*                 DO;               /* YES - FORMAT ONLY 4 BYTES     */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S0878
         IC    @14,OLDFLG                                       02S0878
         O     @14,@CF00092                                     02S0878
         STC   @14,OLDFLG                                       02S0878
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0879
*                 END;                                          02S0880
*               ELSE                                            02S0881
*                 DO;               /* NO - DETERMINE HOW MANY BYTES
*                                      IN SPVSR LIST                 */
         B     @RC00876                                         02S0881
@RF00876 DS    0H                                               02S0882
*                   IF RCD42LN>36 THEN/* DOES DATA NEED TWO LINES    */
         LA    @14,46                                           02S0882
         AL    @14,DATAPTR(,PLISTPTR)                           02S0882
         CLI   RCD42LN(@14),36                                  02S0882
         BNH   @RF00882                                         02S0882
*                     DATALNTH=RCD42LN-36;/* YES - LENGTH OF DATA FOR
*                                      2ND LINE OF LIST              */
         SLR   @07,@07                                          02S0883
         IC    @07,RCD42LN(,@14)                                02S0883
         SH    @07,@CH01324                                     02S0883
         STC   @07,DATALNTH                                     02S0883
*                   IF RCD42LN<4 THEN/* IS LIST LESS THAN ONE WORD   */
@RF00882 LA    @14,46                                           02S0884
         AL    @14,DATAPTR(,PLISTPTR)                           02S0884
         CLI   RCD42LN(@14),4                                   02S0884
         BNL   @RF00884                                         02S0884
*                     DO;           /* YES                           */
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA LENGTH
*                                      TO 0                          */
         SLR   @07,@07                                          02S0886
         IC    @07,OLDLN                                        02S0886
         N     @07,@CF00297                                     02S0886
         STC   @07,OLDLN                                        02S0886
*                       OLDLN(1)=OLDLN(1)×(RCD42LN-1);/* NEW DATA
*                                      LENGTH                        */
         SLR   @05,@05                                          02S0887
         IC    @05,RCD42LN(,@14)                                02S0887
         BCTR  @05,0                                            02S0887
         OR    @07,@05                                          02S0887
         STC   @07,OLDLN                                        02S0887
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0888
*                     END;                                      02S0889
*                   ELSE                                        02S0890
*                     DO;           /* NO - MODIFY PATTERNS     02S0890
*                                      ACCORDINGLY                   */
         B     @RC00884                                         02S0890
@RF00884 DS    0H                                               02S0891
*                       K=RCD42LN/4;/* NUMBER OF FULL WORDS          */
         L     @14,DATAPTR(,PLISTPTR)                           02S0891
         SLR   @05,@05                                          02S0891
         IC    @05,RCD42LN+46(,@14)                             02S0891
         LR    K,@05                                            02S0891
         SRL   K,2                                              02S0891
*                       MOD=RCD42LN//4;/* REMAINDER OF PARTIAL WORD  */
         LR    @02,@05                                          02S0892
         SRDA  @02,32                                           02S0892
         D     @02,@CF00099                                     02S0892
         LR    MOD,@02                                          02S0892
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */
         SLR   @14,@14                                          02S0893
         CR    MOD,@14                                          02S0893
         BNE   @RF00893                                         02S0893
*                         OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0894
         SLA   @07,2                                            02S0894
         STC   @14,OLDFLG(@07)                                  02S0894
*                       ELSE                                    02S0895
*                         DO;       /* NO - MODIFY PATTERNS     02S0895
*                                      ACCORDINGLY                   */
         B     @RC00893                                         02S0895
@RF00893 DS    0H                                               02S0896
*                           OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET DATA
*                                      LENGTH TO ZERO                */
         LR    @14,K                                            02S0896
         SLA   @14,2                                            02S0896
         SLR   @05,@05                                          02S0896
         IC    @05,OLDLN(@14)                                   02S0896
         N     @05,@CF00297                                     02S0896
         STC   @05,OLDLN(@14)                                   02S0896
*                           OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW DATA
*                                      LENGTH                        */
         LR    @03,MOD                                          02S0897
         BCTR  @03,0                                            02S0897
         OR    @05,@03                                          02S0897
         STC   @05,OLDLN(@14)                                   02S0897
*                           OLDFLG(K+2)=0;/* INDICATE END OF PATTERNS*/
         SLR   @07,@07                                          02S0898
         STC   @07,OLDFLG+4(@14)                                02S0898
*                         END;                                  02S0899
*                     END;                                      02S0900
@RC00893 DS    0H                                               02S0901
*                 END;                                          02S0901
@RC00884 DS    0H                                               02S0902
*               ADPLFMT1=ADDR(GP4TYP16);/* ADDR OF LABEL FOR THIS
*                                      LINE                          */
@RC00876 L     @14,ABDPLPTR(,PLISTPTR)                          02S0902
         LA    @07,GP4TYP16                                     02S0902
         ST    @07,ADPLFMT1(,@14)                               02S0902
*               ADPLFMT2=ADDR(RCD42LN)+1;/* ADDR OF DATA IN BUFFER   */
         LA    @07,47                                           02S0903
         AL    @07,DATAPTR(,PLISTPTR)                           02S0903
         ST    @07,ADPLFMT2(,@14)                               02S0903
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0904
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0905
         BALR  @14,@15                                          02S0905
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR FOURTH PASS        */
         SLR   RETCODE,RETCODE                                  02S0906
*             END;                                              02S0907
*           ELSE                                                02S0908
*             DO;                   /* YES                           */
         B     @RC00873                                         02S0908
@RF00873 DS    0H                                               02S0909
*               IF TIMESW=3 THEN    /* HAS LINE 4 BEEN FORMATTED     */
         CLC   TIMESW(2),@CH00170                               02S0909
         BNE   @RF00909                                         02S0909
*                 DO;               /* NO                            */
*                   IF RCD42LN=ERROR THEN/* WAS FIELD IN ERROR       */
         LA    @14,46                                           02S0911
         AL    @14,DATAPTR(,PLISTPTR)                           02S0911
         CLI   RCD42LN(@14),255                                 02S0911
         BNE   @RF00911                                         02S0911
*                     DO;           /* YES                           */
*                       RCD42LN=4;  /* MODIFY LENGTH IN ORDER TO
*                                      ACCESS NEXT FIELD             */
         MVI   RCD42LN(@14),X'04'                               02S0913
*                       GO TO FMTPLIST;/* FORMAT PLIST ON FOURTH LINE*/
         B     FMTPLIST                                         02S0914
*                     END;                                      02S0915
*                   ELSE                                        02S0916
*                     DO;           /* CHECK SPVR LIST SIZE          */
@RF00911 DS    0H                                               02S0917
*                       IF RCD42LN<=36 THEN/* DOES SPVR LIST NEED 2
*                                      LINES                         */
         L     @14,DATAPTR(,PLISTPTR)                           02S0917
         CLI   RCD42LN+46(@14),36                               02S0917
         BNH   @RT00917                                         02S0917
*                         GO TO FMTPLIST;/* NO - FORMAT PLIST ON
*                                      FOURTH LINE                   */
*                       ELSE                                    02S0919
*                         DO;       /* YES - FORMAT REMAINDER OF LIST*/
*                           DYNAMPTN(1:LENGTH(GP4S42B))=GP4S42B;/*
*                                      MOVE PATTERNS TO GETMAIN AREA */
         MVC   DYNAMPTN(25),GP4S42B                             02S0920
*                           IF DATALNTH<4 THEN/* IS PLIST LESS THAN
*                                      ONE WORD                      */
         CLI   DATALNTH,4                                       02S0921
         BNL   @RF00921                                         02S0921
*                             DO;   /* YES                           */
*                               OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA
*                                      LENGTH TO 0                   */
         SLR   @14,@14                                          02S0923
         IC    @14,OLDLN                                        02S0923
         N     @14,@CF00297                                     02S0923
         STC   @14,OLDLN                                        02S0923
*                               OLDLN(1)=OLDLN(1)×(DATALNTH-1);/* NEW
*                                      DATA LENGTH                   */
         SLR   @07,@07                                          02S0924
         IC    @07,DATALNTH                                     02S0924
         BCTR  @07,0                                            02S0924
         OR    @14,@07                                          02S0924
         STC   @14,OLDLN                                        02S0924
*                               OLDFLG(2)=0;/* INDICATE END OF  02S0925
*                                      PATTERNS                      */
         MVI   OLDFLG+4,X'00'                                   02S0925
*                             END;                              02S0926
*                           ELSE                                02S0927
*                             DO;   /* NO - MODIFY PATTERNS          */
         B     @RC00921                                         02S0927
@RF00921 DS    0H                                               02S0928
*                               K=DATALNTH/4;/* NUMBER OF FULL WORDS */
         SLR   @14,@14                                          02S0928
         IC    @14,DATALNTH                                     02S0928
         LR    K,@14                                            02S0928
         SRL   K,2                                              02S0928
*                               MOD=DATALNTH//4;/* REMAINDER OF 02S0929
*                                      PARTIAL WORD                  */
         LR    @02,@14                                          02S0929
         SRDA  @02,32                                           02S0929
         D     @02,@CF00099                                     02S0929
         LR    MOD,@02                                          02S0929
*                               IF MOD=0 THEN/* ARE ALL FULL WORDS   */
         SLR   @14,@14                                          02S0930
         CR    MOD,@14                                          02S0930
         BNE   @RF00930                                         02S0930
*                                 OLDFLG(K+1)=0;/* YES - INDICATE END
*                                      OF PATTERNS                   */
         LR    @07,K                                            02S0931
         SLA   @07,2                                            02S0931
         STC   @14,OLDFLG(@07)                                  02S0931
*                               ELSE                            02S0932
*                                 DO;/* NO - MODIFY PATTERNS    02S0932
*                                      ACCORDINGLY                   */
         B     @RC00930                                         02S0932
@RF00930 DS    0H                                               02S0933
*                                   OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/*
*                                      SET DATA LENGTH TO ZERO       */
         LR    @14,K                                            02S0933
         SLA   @14,2                                            02S0933
         SLR   @05,@05                                          02S0933
         IC    @05,OLDLN(@14)                                   02S0933
         N     @05,@CF00297                                     02S0933
         STC   @05,OLDLN(@14)                                   02S0933
*                                   OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/*
*                                      NEW DATA LENGTH               */
         LR    @03,MOD                                          02S0934
         BCTR  @03,0                                            02S0934
         OR    @05,@03                                          02S0934
         STC   @05,OLDLN(@14)                                   02S0934
*                                   OLDFLG(K+2)=0;/* INDICATE END OF
*                                      PATTERNS                      */
         SLR   @07,@07                                          02S0935
         STC   @07,OLDFLG+4(@14)                                02S0935
*                                 END;                          02S0936
*                             END;                              02S0937
@RC00930 DS    0H                                               02S0938
*                         END;                                  02S0938
@RC00921 DS    0H                                               02S0939
*                       R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS        */
         LA    R0,DYNAMPTN                                      02S0939
*                       CALL AMDPRFMT;/* FORMAT THE LINE             */
         L     @15,FMTADDR(,PLISTPTR)                           02S0940
         BALR  @14,@15                                          02S0940
*                       RETCODE=0;  /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR FIFTH PASS         */
         SLR   RETCODE,RETCODE                                  02S0941
*                     END;                                      02S0942
*                 END;                                          02S0943
*               ELSE                                            02S0944
*                 DO;               /* YES - FORMAT FIFTH LINE       */
         B     @RC00909                                         02S0944
@RF00909 DS    0H                                               02S0945
*FMTPLIST:                                                      02S0945
*                   DYNAMPTN(1:LENGTH(GP4S42C))=GP4S42C;/* MOVE 02S0945
*                                      PATTERNS TO GETMAIN AREA      */
FMTPLIST MVC   DYNAMPTN(41),GP4S42C                             02S0945
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS    @YM03669*/
         LA    R0,DYNAMPTN                                      02S0946
*                   FIELDADR=ADDR(RCD42LN)+RCD42LN+1;/* ADDR OF PROB
*                                      PLIST IN BUFFER               */
         LA    @14,46                                           02S0947
         AL    @14,DATAPTR(,PLISTPTR)                           02S0947
         SLR   @07,@07                                          02S0947
         IC    @07,RCD42LN(,@14)                                02S0947
         ALR   @07,@14                                          02S0947
         AH    @07,@CH00046                                     02S0947
         ST    @07,FIELDADR                                     02S0947
*                   IF NXTFIELD^=ERROR THEN/* IS FIELD IN ERROR      */
         CLI   NXTFIELD(@07),255                                02S0948
         BE    @RF00948                                         02S0948
*                     DO;           /* NO-CHECK DATA LENGTH FOR ZERO */
*                       IF NXTFIELD=0 THEN/* IS THERE ANY DATA  02S0950
*                                                            @YM03669*/
         CLI   NXTFIELD(@07),0                                  02S0950
         BNE   @RF00950                                         02S0950
*                         R0=ADDR(GP4S42D);/* NO - ADDR OF FORMAT
*                                      PATTERNS FOR THIS LINE   02S0951
*                                                            @YM03669*/
         LA    R0,GP4S42D                                       02S0951
*                       ELSE                                    02S0952
*                         DO;       /* YES - THERE IS DATA           */
         B     @RC00950                                         02S0952
@RF00950 DS    0H                                               02S0953
*                           K=NXTFIELD/4;/* NUMBER OF FULL WORDS     */
         L     @14,FIELDADR                                     02S0953
         SLR   @05,@05                                          02S0953
         IC    @05,NXTFIELD(,@14)                               02S0953
         LR    K,@05                                            02S0953
         SRL   K,2                                              02S0953
*                           MOD=NXTFIELD//4;/* REMAINDER OF PARTIAL
*                                      WORD                          */
         LR    @02,@05                                          02S0954
         SRDA  @02,32                                           02S0954
         D     @02,@CF00099                                     02S0954
         LR    MOD,@02                                          02S0954
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */
         SLR   @14,@14                                          02S0955
         CR    MOD,@14                                          02S0955
         BNE   @RF00955                                         02S0955
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S0956
         SLA   @07,2                                            02S0956
         STC   @14,OLDFLG(@07)                                  02S0956
*                           ELSE    /*                       @YM03669*/
*                             DO;   /* NO - MODIFY PATTERNS     02S0957
*                                      ACCORDINGLY                   */
         B     @RC00955                                         02S0957
@RF00955 DS    0H                                               02S0958
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET
*                                      DATA LENGTH TO ZERO           */
         LR    @14,K                                            02S0958
         SLA   @14,2                                            02S0958
         SLR   @05,@05                                          02S0958
         IC    @05,OLDLN(@14)                                   02S0958
         N     @05,@CF00297                                     02S0958
         STC   @05,OLDLN(@14)                                   02S0958
*                               OLDLN(K+1)=OLDLN(K+1)×(MOD-1);/* NEW
*                                      DATA LENGTH                   */
         LR    @03,MOD                                          02S0959
         BCTR  @03,0                                            02S0959
         OR    @05,@03                                          02S0959
         STC   @05,OLDLN(@14)                                   02S0959
*                               OLDFLG(K+2)=0;/* INDICATE END OF
*                                      PATTERNS                      */
         SLR   @07,@07                                          02S0960
         STC   @07,OLDFLG+4(@14)                                02S0960
*                             END;                              02S0961
*                         END;      /*                       @YM03669*/
*                     END;                                      02S0963
*                   ELSE                                        02S0964
*                     DO;           /* YES - FIELD IS IN ERROR       */
         B     @RC00948                                         02S0964
@RF00948 DS    0H                                               02S0965
*                       OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA
*                                      IN EBCDIC             @YM03669*/
         SLR   @14,@14                                          02S0965
         IC    @14,OLDFLG                                       02S0965
         O     @14,@CF00092                                     02S0965
         STC   @14,OLDFLG                                       02S0965
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S0966
*                     END;                                      02S0967
*                   ADPLFMT1=ADDR(GP4TP16A);/* ADDR OF LABELS FOR
*                                      THIS LINE                     */
@RC00948 L     @14,ABDPLPTR(,PLISTPTR)                          02S0968
         LA    @07,GP4TP16A                                     02S0968
         ST    @07,ADPLFMT1(,@14)                               02S0968
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */
         LA    @07,1                                            02S0969
         AL    @07,FIELDADR                                     02S0969
         ST    @07,ADPLFMT2(,@14)                               02S0969
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0970
         BALR  @14,@15                                          02S0970
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0971
*                 END;                                          02S0972
*             END;                                              02S0973
*         END;                                                  02S0974
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0975
*     END S42;                      /* END OF SUBCASE                */
*                                                               02S0977
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 44,62. THE    */
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + A CHAPPED TCB     */
*     /* ADDRESS/A DETACHED TCB ADDRESS.                             */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0977
*S44:                                                           02S0977
*     DO;                           /* SUBCASE                       */
S44      DS    0H                                               02S0978
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0978
         CH    @14,TIMESW                                       02S0978
         BNE   @RF00978                                         02S0978
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0979
*       ELSE                                                    02S0980
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS
*                                      & FORMAT THEM                 */
         B     @RC00978                                         02S0980
@RF00978 DS    0H                                               02S0981
*           DYNAMPTN(1:LENGTH(GP4S44))=GP4S44;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(5),GP4S44                               02S0981
*           IF TCBADDR=ASTER4×TCBADDR=PEES4×TCBADDR=ESSES4 THEN/* IS
*                                      FIELD IN ERROR                */
         LA    @14,46                                           02S0982
         AL    @14,DATAPTR(,PLISTPTR)                           02S0982
         CLC   TCBADDR(4,@14),ASTER4                            02S0982
         BE    @RT00982                                         02S0982
         CLC   TCBADDR(4,@14),PEES4                             02S0982
         BE    @RT00982                                         02S0982
         CLC   TCBADDR(4,@14),ESSES4                            02S0982
         BNE   @RF00982                                         02S0982
@RT00982 DS    0H                                               02S0983
*             OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN EBCDIC*/
         SLR   @14,@14                                          02S0983
         IC    @14,OLDFLG                                       02S0983
         O     @14,@CF00092                                     02S0983
         STC   @14,OLDFLG                                       02S0983
*           IF SVCNUMBR=45 THEN     /* IS THIS SVC 44                */
@RF00982 CH    SVCNUMBR,@CH01425                                02S0984
         BNE   @RF00984                                         02S0984
*             ADPLFMT1=ADDR(GP4TYP17);/* YES - ADDR OF LABELS FOR
*                                      THIS LINE                     */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0985
         LA    @07,GP4TYP17                                     02S0985
         ST    @07,ADPLFMT1(,@14)                               02S0985
*           ELSE                    /* NO - ITS SVC 62               */
*             ADPLFMT1=ADDR(GP4TYP20);/* ADDR OF LABELS FOR THIS LINE*/
         B     @RC00984                                         02S0986
@RF00984 L     @14,ABDPLPTR(,PLISTPTR)                          02S0986
         LA    @07,GP4TYP20                                     02S0986
         ST    @07,ADPLFMT1(,@14)                               02S0986
*           ADPLFMT2=ADDR(TCBADDR); /* ADDR OF DATA IN BUFFER        */
@RC00984 L     @14,ABDPLPTR(,PLISTPTR)                          02S0987
         LA    @07,46                                           02S0987
         AL    @07,DATAPTR(,PLISTPTR)                           02S0987
         ST    @07,ADPLFMT2(,@14)                               02S0987
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S0988
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S0989
         BALR  @14,@15                                          02S0989
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S0990
*         END;                                                  02S0991
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0992
*     END S44;                      /* END OF SUBCASE                */
*                                                               02S0994
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 48,56. THE    */
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + A 20 BYTE PLIST + */
*     /* A MAJOR NAME AND A VARIABLE LENGTH MINOR NAME.              */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0994
*S48:                                                           02S0994
*     DO;                           /* SUBCASE                       */
S48      DS    0H                                               02S0995
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S0995
         CH    @14,TIMESW                                       02S0995
         BNE   @RF00995                                         02S0995
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S0996
*       ELSE                                                    02S0997
*         DO;                       /* YES - REGISTERS HAVE BEEN
*                                      FORMATTED                     */
         B     @RC00995                                         02S0997
@RF00995 DS    0H                                               02S0998
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE
*                                      BEEN FORMATTED                */
         CLC   TIMESW(2),@CH00046                               02S0998
         BNE   @RF00998                                         02S0998
*             DO;                   /* NO                            */
*               DYNAMPTN(1:LENGTH(GP4S48A))=GP4S48A;/* MOVE PATTERNS
*                                      TO GETMAINED AREA             */
         MVC   DYNAMPTN(21),GP4S48A                             02S1000
*               IF RCD48LN^=ERROR THEN/* IS FIELD IN ERROR           */
         LA    @14,46                                           02S1001
         AL    @14,DATAPTR(,PLISTPTR)                           02S1001
         CLI   RCD48LN(@14),255                                 02S1001
         BE    @RF01001                                         02S1001
*                 DO;               /* NO                            */
*                   IF RCD48LN^=44 THEN/* IS DSN MAX LENGTH          */
         CLI   RCD48LN(@14),44                                  02S1003
         BE    @RF01003                                         02S1003
*                     DO;           /* NO                            */
*                       K=RCD48LN/16;/* NUMBER OF FULL WORDS         */
         SLR   @05,@05                                          02S1005
         IC    @05,RCD48LN(,@14)                                02S1005
         LR    K,@05                                            02S1005
         SRL   K,4                                              02S1005
*                       MOD=RCD48LN//16;/* REMAINDER OF PARTIAL WORD */
         LR    @02,@05                                          02S1006
         SRDA  @02,32                                           02S1006
         D     @02,@CF00139                                     02S1006
         LR    MOD,@02                                          02S1006
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */
         SLR   @14,@14                                          02S1007
         CR    MOD,@14                                          02S1007
         BNE   @RF01007                                         02S1007
*                         OLDFLG(K+3)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S1008
         SLA   @07,2                                            02S1008
         STC   @14,OLDFLG+8(@07)                                02S1008
*                       ELSE                                    02S1009
*                         DO;       /* NO - MODIFY PATTERNS     02S1009
*                                      ACCORDINGLY                   */
         B     @RC01007                                         02S1009
@RF01007 DS    0H                                               02S1010
*                           OLDLN(K+3)=OLDLN(K+3)&DATAOFF;/* SET DATA
*                                      LENGTH TO ZERO                */
         LR    @14,K                                            02S1010
         SLA   @14,2                                            02S1010
         SLR   @05,@05                                          02S1010
         IC    @05,OLDLN+8(@14)                                 02S1010
         N     @05,@CF00297                                     02S1010
         STC   @05,OLDLN+8(@14)                                 02S1010
*                           OLDLN(K+3)=OLDLN(K+3)×(MOD-1);/* NEW DATA
*                                      LENGTH                        */
         LR    @03,MOD                                          02S1011
         BCTR  @03,0                                            02S1011
         OR    @05,@03                                          02S1011
         STC   @05,OLDLN+8(@14)                                 02S1011
*                           OLDFLG(K+4)=0;/* INDICATE END OF PATTERNS*/
         SLR   @07,@07                                          02S1012
         STC   @07,OLDFLG+12(@14)                               02S1012
*                         END;                                  02S1013
*                     END;                                      02S1014
*                 END;                                          02S1015
*               ELSE                                            02S1016
*                 DO;               /* YES - FIELD IS IN ERROR       */
         B     @RC01001                                         02S1016
@RF01001 DS    0H                                               02S1017
*                   OLDLN(3)=OLDLN(3)&DATAOFF;/* ZERO DATA LENGTH    */
         SLR   @14,@14                                          02S1017
         IC    @14,OLDLN+8                                      02S1017
         N     @14,@CF00297                                     02S1017
         STC   @14,OLDLN+8                                      02S1017
*                   OLDLN(3)=OLDLN(3)×DATALN4;/* SET DATA LENGTH TO
*                                      FORMAT 4 BYTES                */
         O     @14,@CF00170                                     02S1018
         STC   @14,OLDLN+8                                      02S1018
*                   OLDFLG(4)=0;    /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+12,X'00'                                  02S1019
*                 END;                                          02S1020
*               ADPLFMT1=ADDR(GP4TYP18);/* ADDR OF LABELS FOR THIS
*                                      LINE                          */
@RC01001 L     @14,ABDPLPTR(,PLISTPTR)                          02S1021
         LA    @07,GP4TYP18                                     02S1021
         ST    @07,ADPLFMT1(,@14)                               02S1021
*               ADPLFMT2=ADDR(MAJORNM);/* ADDR OF DATA IN BUFFER     */
         L     @07,DATAPTR(,PLISTPTR)                           02S1022
         LA    @07,MAJORNM+46(,@07)                             02S1022
         ST    @07,ADPLFMT2(,@14)                               02S1022
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S1023
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1024
         BALR  @14,@15                                          02S1024
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR THIRD PASS         */
         SLR   RETCODE,RETCODE                                  02S1025
*             END;                                              02S1026
*           ELSE                                                02S1027
*             DO;                   /* YES - FORMAT THE THIRD LINE   */
         B     @RC00998                                         02S1027
@RF00998 DS    0H                                               02S1028
*               DYNAMPTN(1:LENGTH(GP4S48B))=GP4S48B;/* MOVE PATTERNS
*                                      TO GETMAINED AREA             */
         MVC   DYNAMPTN(21),GP4S48B                             02S1028
*               IF RCD48LST=ASTER20×RCD48LST=PEES20×RCD48LST=ESSES20
*                 THEN              /* IS FIELD IN ERROR             */
         LA    @14,46                                           02S1029
         AL    @14,DATAPTR(,PLISTPTR)                           02S1029
         CLC   RCD48LST(20,@14),ASTER20                         02S1029
         BE    @RT01029                                         02S1029
         CLC   RCD48LST(20,@14),PEES20                          02S1029
         BE    @RT01029                                         02S1029
         CLC   RCD48LST(20,@14),ESSES20                         02S1029
         BNE   @RF01029                                         02S1029
@RT01029 DS    0H                                               02S1030
*                 DO;               /* YES                           */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S1031
         SLR   @07,@07                                          02S1031
         IC    @07,OLDFLG                                       02S1031
         OR    @07,@14                                          02S1031
         STC   @07,OLDFLG                                       02S1031
*                   OLDFLG(2)=OLDFLG(2)×CHARFLAG;               02S1032
         SLR   @07,@07                                          02S1032
         IC    @07,OLDFLG+4                                     02S1032
         OR    @07,@14                                          02S1032
         STC   @07,OLDFLG+4                                     02S1032
*                   OLDFLG(3)=OLDFLG(3)×CHARFLAG;               02S1033
         SLR   @07,@07                                          02S1033
         IC    @07,OLDFLG+8                                     02S1033
         OR    @07,@14                                          02S1033
         STC   @07,OLDFLG+8                                     02S1033
*                   OLDFLG(4)=OLDFLG(4)×CHARFLAG;               02S1034
         SLR   @07,@07                                          02S1034
         IC    @07,OLDFLG+12                                    02S1034
         OR    @07,@14                                          02S1034
         STC   @07,OLDFLG+12                                    02S1034
*                   OLDFLG(5)=OLDFLG(5)×CHARFLAG;               02S1035
         SLR   @07,@07                                          02S1035
         IC    @07,OLDFLG+16                                    02S1035
         OR    @14,@07                                          02S1035
         STC   @14,OLDFLG+16                                    02S1035
*                 END;                                          02S1036
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS LINE */
@RF01029 L     @14,ABDPLPTR(,PLISTPTR)                          02S1037
         LA    @07,GROUP2                                       02S1037
         ST    @07,ADPLFMT1(,@14)                               02S1037
*               ADPLFMT2=ADDR(RCD48LST);/* ADDR OF DATA FOR THIS LINE*/
         LA    @07,46                                           02S1038
         AL    @07,DATAPTR(,PLISTPTR)                           02S1038
         ST    @07,ADPLFMT2(,@14)                               02S1038
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIRD
*                                      LINE                          */
         LA    R0,DYNAMPTN                                      02S1039
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1040
         BALR  @14,@15                                          02S1040
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S1041
*             END;                                              02S1042
*         END;                                                  02S1043
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S1044
*     END S48;                      /* END OF SUBCASE                */
*                                                               02S1046
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 52. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A 52 BYTE PARAMETER LIST.                */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S1046
*S52:                                                           02S1046
*     DO;                           /* SUBCASE                       */
S52      DS    0H                                               02S1047
*       IF TIMESW=0×TIMESW=1 THEN   /* HAS BASIC RECORD BEEN    02S1047
*                                      FORMATTED                     */
         LH    @14,TIMESW                                       02S1047
         LTR   @14,@14                                          02S1047
         BZ    @RT01047                                         02S1047
         CH    @14,@CH00046                                     02S1047
         BNE   @RF01047                                         02S1047
@RT01047 DS    0H                                               02S1048
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR THIRD PASS     */
         SLR   RETCODE,RETCODE                                  02S1048
*       ELSE                                                    02S1049
*         DO;                       /* YES                           */
         B     @RC01047                                         02S1049
@RF01047 DS    0H                                               02S1050
*           IF TIMESW=2 THEN        /* HAS THIRD LINE BEEN FORMATTED */
         CLC   TIMESW(2),@CH00078                               02S1050
         BNE   @RF01050                                         02S1050
*             DO;                   /* NO                            */
*               DYNAMPTN(1:LENGTH(GP4S52A))=GP4S52A;/* MOVE PATTERNS
*                                      TO GETMAIN AREA               */
         MVC   DYNAMPTN(45),GP4S52A                             02S1052
*               IF ERRCHECK=ASTER20×ERRCHECK=PEES20×ERRCHECK=ESSES20
*                 THEN              /* IS FIELD IN ERROR             */
         LA    @14,46                                           02S1053
         AL    @14,DATAPTR(,PLISTPTR)                           02S1053
         CLC   ERRCHECK(20,@14),ASTER20                         02S1053
         BE    @RT01053                                         02S1053
         CLC   ERRCHECK(20,@14),PEES20                          02S1053
         BE    @RT01053                                         02S1053
         CLC   ERRCHECK(20,@14),ESSES20                         02S1053
         BNE   @RF01053                                         02S1053
@RT01053 DS    0H                                               02S1054
*                 DO;               /* YES                           */
*                   ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS
*                                      LINE                          */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1055
         LA    @07,GROUP2                                       02S1055
         ST    @07,ADPLFMT1(,@14)                               02S1055
*                   ADPLFMT2=ADDR(RCD52LST);/* ADDR OF DATA IN BUFFER*/
         LA    @07,46                                           02S1056
         AL    @07,DATAPTR(,PLISTPTR)                           02S1056
         ST    @07,ADPLFMT2(,@14)                               02S1056
*                   R0=ADDR(GP4S52C);/* ADDR OF PATTERNS FOR THIS
*                                      LINE                          */
         LA    R0,GP4S52C                                       02S1057
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1058
         BALR  @14,@15                                          02S1058
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S1059
*                 END;                                          02S1060
*               ELSE                                            02S1061
*                 DO;               /* NO - FIELD IS IN HEX          */
         B     @RC01053                                         02S1061
@RF01053 DS    0H                                               02S1062
*                   ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS
*                                      LINE                          */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1062
         LA    @07,GROUP2                                       02S1062
         ST    @07,ADPLFMT1(,@14)                               02S1062
*                   ADPLFMT2=ADDR(RCD52LST);/* ADDR OF DATA IN BUFFER*/
         LA    @07,46                                           02S1063
         AL    @07,DATAPTR(,PLISTPTR)                           02S1063
         ST    @07,ADPLFMT2(,@14)                               02S1063
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */
         LA    R0,DYNAMPTN                                      02S1064
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1065
         BALR  @14,@15                                          02S1065
*                   RETCODE=0;      /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR FOURTH PASS        */
         SLR   RETCODE,RETCODE                                  02S1066
*                 END;                                          02S1067
*             END;                                              02S1068
*           ELSE                                                02S1069
*             DO;                   /* YES - FORMAT THE FOURTH LINE  */
         B     @RC01050                                         02S1069
@RF01050 DS    0H                                               02S1070
*               ADPLFMT2=ADDR(RCD52LST)+44;/* ADDR OF REMAINDER OF
*                                      PLIST IN BUFFER               */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1070
         LA    @07,90                                           02S1070
         AL    @07,DATAPTR(,PLISTPTR)                           02S1070
         ST    @07,ADPLFMT2(,@14)                               02S1070
*               R0=ADDR(GP4S52B);   /* ADDR OF PATTERNS              */
         LA    R0,GP4S52B                                       02S1071
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1072
         BALR  @14,@15                                          02S1072
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S1073
*             END;                                              02S1074
*         END;                                                  02S1075
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S1076
*     END S52;                      /* END OF SUBCASE                */
*                                                               02S1078
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 66. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + AN IOBERINF.                             */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S1078
*S66:                                                           02S1078
*     DO;                           /* SUBCASE                       */
S66      DS    0H                                               02S1079
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S1079
         CH    @14,TIMESW                                       02S1079
         BNE   @RF01079                                         02S1079
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S1080
*       ELSE                                                    02S1081
*         DO;                       /* YES - REGISTERS HAVE BEEN
*                                      FORMATTED                     */
         B     @RC01079                                         02S1081
@RF01079 DS    0H                                               02S1082
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE
*                                      BEEN FORMATTED                */
         CLC   TIMESW(2),@CH00046                               02S1082
         BNE   @RF01082                                         02S1082
*             DO;                   /* NO                            */
*               DYNAMPTN(1:LENGTH(GP4S66))=GP4S66;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(17),GP4S66                              02S1084
*               IF IOBERR=ASTER16×IOBERR=PEES16×IOBERR=ESSES16 THEN/*
*                                      IS FIELD IN ERROR             */
         LA    @14,46                                           02S1085
         AL    @14,DATAPTR(,PLISTPTR)                           02S1085
         CLC   IOBERR(16,@14),ASTER16                           02S1085
         BE    @RT01085                                         02S1085
         CLC   IOBERR(16,@14),PEES16                            02S1085
         BE    @RT01085                                         02S1085
         CLC   IOBERR(16,@14),ESSES16                           02S1085
         BNE   @RF01085                                         02S1085
@RT01085 DS    0H                                               02S1086
*                 DO;               /* YES                           */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S1087
         SLR   @07,@07                                          02S1087
         IC    @07,OLDFLG                                       02S1087
         OR    @07,@14                                          02S1087
         STC   @07,OLDFLG                                       02S1087
*                   OLDFLG(2)=OLDFLG(2)×CHARFLAG;               02S1088
         SLR   @07,@07                                          02S1088
         IC    @07,OLDFLG+4                                     02S1088
         OR    @07,@14                                          02S1088
         STC   @07,OLDFLG+4                                     02S1088
*                   OLDFLG(3)=OLDFLG(3)×CHARFLAG;               02S1089
         SLR   @07,@07                                          02S1089
         IC    @07,OLDFLG+8                                     02S1089
         OR    @07,@14                                          02S1089
         STC   @07,OLDFLG+8                                     02S1089
*                   OLDFLG(4)=OLDFLG(4)×CHARFLAG;               02S1090
         SLR   @07,@07                                          02S1090
         IC    @07,OLDFLG+12                                    02S1090
         OR    @14,@07                                          02S1090
         STC   @14,OLDFLG+12                                    02S1090
*                 END;                                          02S1091
*               ADPLFMT1=ADDR(GP4TYP21);/* ADDR OF LABELS FOR THIS
*                                      LINE                          */
@RF01085 L     @14,ABDPLPTR(,PLISTPTR)                          02S1092
         LA    @07,GP4TYP21                                     02S1092
         ST    @07,ADPLFMT1(,@14)                               02S1092
*               ADPLFMT2=ADDR(IOBERR);/* ADDR OF DATA IN BUFFER      */
         LA    @07,46                                           02S1093
         AL    @07,DATAPTR(,PLISTPTR)                           02S1093
         ST    @07,ADPLFMT2(,@14)                               02S1093
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S1094
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1095
         BALR  @14,@15                                          02S1095
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S1096
*             END;                                              02S1097
*         END;                                                  02S1098
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S1099
*     END S66;                      /* END OF SUBCASE                */
*                                                               02S1101
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 71. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A DDNAME + A 16 BYTE PLIST.              */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S1101
*S71:                                                           02S1101
*     DO;                           /* SUBCASE                       */
S71      DS    0H                                               02S1102
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */
         ICM   @14,3,TIMESW                                     02S1102
         BNZ   @RF01102                                         02S1102
*         DO;                       /* YES - FORMAT DDNAME           */
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1104
         LA    @07,LDDNL1                                       02S1104
         ST    @07,ADPLFMT1(,@14)                               02S1104
*           ADPLFMT2=ADDR(RCD71DDN);/* ADDR OF DDNAME IN RECORD      */
         LA    @07,46                                           02S1105
         AL    @07,DATAPTR(,PLISTPTR)                           02S1105
         ST    @07,ADPLFMT2(,@14)                               02S1105
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */
         LA    R0,DDNLN1                                        02S1106
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */
         L     @15,FMTADDR(,PLISTPTR)                           02S1107
         BALR  @14,@15                                          02S1107
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR SECOND PASS        */
         SLR   RETCODE,RETCODE                                  02S1108
*         END;                                                  02S1109
*       ELSE                                                    02S1110
*         DO;                       /* Z40KI3N                       */
         B     @RC01102                                         02S1110
@RF01102 DS    0H                                               02S1111
*           IF TIMESW=1 THEN        /* IF SECOND PASS        @Z40KI3N*/
         CLC   TIMESW(2),@CH00046                               02S1111
         BNE   @RF01111                                         02S1111
*             DO;                   /* NO - FORMAT REGS AND REMAINING
*                                      FIELDS                        */
*               DYNAMPTN(1:LENGTH(GP4S21))=GP4S21;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(17),GP4S21                              02S1113
*               IF RCD71LST=ASTER12×RCD71LST=PEES12×RCD71LST=ESSES12
*                 THEN              /* IS FIELD IN ERROR             */
         LA    @14,46                                           02S1114
         AL    @14,DATAPTR(,PLISTPTR)                           02S1114
         CLC   RCD71LST(12,@14),ASTER12                         02S1114
         BE    @RT01114                                         02S1114
         CLC   RCD71LST(12,@14),PEES12                          02S1114
         BE    @RT01114                                         02S1114
         CLC   RCD71LST(12,@14),ESSES12                         02S1114
         BNE   @RF01114                                         02S1114
@RT01114 DS    0H                                               02S1115
*                 DO;               /* YES                           */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S1116
         SLR   @05,@05                                          02S1116
         IC    @05,OLDFLG                                       02S1116
         OR    @05,@14                                          02S1116
         STC   @05,OLDFLG                                       02S1116
*                   OLDFLG(2)=OLDFLG(2)×CHARFLAG;               02S1117
         SLR   @05,@05                                          02S1117
         IC    @05,OLDFLG+4                                     02S1117
         OR    @05,@14                                          02S1117
         STC   @05,OLDFLG+4                                     02S1117
*                   OLDFLG(3)=OLDFLG(3)×CHARFLAG;               02S1118
         SLR   @05,@05                                          02S1118
         IC    @05,OLDFLG+8                                     02S1118
         OR    @05,@14                                          02S1118
         STC   @05,OLDFLG+8                                     02S1118
*                   OLDFLG(4)=OLDFLG(4)×CHARFLAG;               02S1119
         SLR   @05,@05                                          02S1119
         IC    @05,OLDFLG+12                                    02S1119
         OR    @14,@05                                          02S1119
         STC   @14,OLDFLG+12                                    02S1119
*                 END;                                          02S1120
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS LINE */
@RF01114 L     @14,ABDPLPTR(,PLISTPTR)                          02S1121
         LA    @05,GROUP2                                       02S1121
         ST    @05,ADPLFMT1(,@14)                               02S1121
*               ADPLFMT2=ADDR(RCD71LST);/* ADDR OF DATA FOR THIS LINE*/
         L     @05,DATAPTR(,PLISTPTR)                           02S1122
         LA    @05,RCD71LST+46(,@05)                            02S1122
         ST    @05,ADPLFMT2(,@14)                               02S1122
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S1123
*               CALL AMDPRFMT;      /* FORMAT LINE                   */
         L     @15,FMTADDR(,PLISTPTR)                           02S1124
         BALR  @14,@15                                          02S1124
*               IF SVCNUMBR=82&(LSVC81R='006E'X×LSVC81R='0076'X) THEN
         CH    SVCNUMBR,@CH01327                                02S1125
         BNE   @RF01125                                         02S1125
         L     @14,RECPTR(,PLISTPTR)                            02S1125
         CLC   LSVC81R(2,@14),@CB01430                          02S1125
         BE    @RT01125                                         02S1125
         CLC   LSVC81R(2,@14),@CB01431                          02S1125
         BNE   @RF01125                                         02S1125
@RT01125 DS    0H                                               02S1126
*                                   /*                       @Z40KI3N*/
*                                                               02S1126
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF SVC 81 AND LONG PLIST                @Z40KI3N*/
*                 /*                                                 */
*                 /***************************************************/
*                                                               02S1126
*                 RETCODE=0;        /* RETURN FOR ANOTHER PASS  02S1126
*                                                            @Z40KI3N*/
         SLR   RETCODE,RETCODE                                  02S1126
*               ELSE                /* IF SVC71 OR 81 WITH SHORT
*                                      PLIST                 @Z40KI3N*/
*                 RETCODE=4;        /* THIS IS LAST PASS     @Z40KI3N*/
         B     @RC01125                                         02S1127
@RF01125 LA    RETCODE,4                                        02S1127
*             END;                  /*                       @Z40KI3N*/
*           ELSE                    /* THIRD PASS FOR SVC81 WITH LG
*                                      PLIST ONLY            @Z40KI3N*/
*             DO;                   /* FORMAT REMAINING 32 BYTES OF
*                                      PLIST                 @Z40KI3N*/
         B     @RC01111                                         02S1129
@RF01111 DS    0H                                               02S1130
*               DYNAMPTN=GP4S21A;   /* MOVE FORMAT PATT TO GETMAIN
*                                      AREA                  @Z40KI3N*/
         MVI   DYNAMPTN+33,C' '                                 02S1130
         MVC   DYNAMPTN+34(14),DYNAMPTN+33                      02S1130
         MVC   DYNAMPTN(33),GP4S21A                             02S1130
*               ADPLFMT2=ADDR(RCD81LNG);/* ADDR OF REMAINING PLIST
*                                      BYTES                 @Z40KI3N*/
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1131
         L     @07,DATAPTR(,PLISTPTR)                           02S1131
         LA    @07,RCD81LNG+46(,@07)                            02S1131
         ST    @07,ADPLFMT2(,@14)                               02S1131
*               R0=ADDR(DYNAMPTN);  /*                       @Z40KI3N*/
         LA    R0,DYNAMPTN                                      02S1132
*               CALL AMDPRFMT;      /* FORMAT LINE           @Z40KI3N*/
         L     @15,FMTADDR(,PLISTPTR)                           02S1133
         BALR  @14,@15                                          02S1133
*               RETCODE=4;          /* PRINT FINAL BUFFER AND GET
*                                      NEXT GTF RECORD       @Z40KI3N*/
         LA    RETCODE,4                                        02S1134
*             END;                  /*                       @Z40KI3N*/
*         END;                                                  02S1136
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S1137
*     END S71;                      /* END OF SUBCASE                */
*                                                               02S1139
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 75. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A VARIABLE LENGTH IQE.                   */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S1139
*S75:                                                           02S1139
*     DO;                           /* SUBCASE                       */
S75      DS    0H                                               02S1140
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S1140
         CH    @14,TIMESW                                       02S1140
         BNE   @RF01140                                         02S1140
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S1141
*       ELSE                                                    02S1142
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS
*                                      & FORMAT THEM                 */
         B     @RC01140                                         02S1142
@RF01140 DS    0H                                               02S1143
*           DYNAMPTN(1:LENGTH(GP4S75A))=GP4S75A;/* MOVE PATTERNS TO
*                                      GETMAIN AREA                  */
         MVC   DYNAMPTN(13),GP4S75A                             02S1143
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S1144
*           IF RCD75LN=ERROR THEN   /* IS FIELD IN ERROR             */
         L     @14,DATAPTR(,PLISTPTR)                           02S1145
         CLI   RCD75LN+46(@14),255                              02S1145
         BNE   @RF01145                                         02S1145
*             DO;                   /* YES                           */
*               OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                @YM03669*/
         SLR   @14,@14                                          02S1147
         IC    @14,OLDFLG                                       02S1147
         O     @14,@CF00092                                     02S1147
         STC   @14,OLDFLG                                       02S1147
*               OLDFLG(2)=0;        /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S1148
*             END;                                              02S1149
*           ELSE                                                02S1150
*             DO;                   /* NO - CHECK DATA LENGTH FOR
*                                      ZERO                          */
         B     @RC01145                                         02S1150
@RF01145 DS    0H                                               02S1151
*               IF RCD75LN=0 THEN   /* IS THERE ANY DATA             */
         L     @14,DATAPTR(,PLISTPTR)                           02S1151
         CLI   RCD75LN+46(@14),0                                02S1151
         BNE   @RF01151                                         02S1151
*                 R0=ADDR(GP4S75B); /* NO - ADDR OF FORMAT PATTERNS
*                                      FOR THIS LINE                 */
         LA    R0,GP4S75B                                       02S1152
*             END;                                              02S1153
@RF01151 DS    0H                                               02S1154
*           ADPLFMT1=ADDR(GP4TYP22);/* ADDR OF LABEL FOR THIS LINE   */
@RC01145 L     @14,ABDPLPTR(,PLISTPTR)                          02S1154
         LA    @07,GP4TYP22                                     02S1154
         ST    @07,ADPLFMT1(,@14)                               02S1154
*           ADPLFMT2=ADDR(RCD75LN)+1;/* ADDR OF DATA IN BUFFER       */
         LA    @07,47                                           02S1155
         AL    @07,DATAPTR(,PLISTPTR)                           02S1155
         ST    @07,ADPLFMT2(,@14)                               02S1155
*           CALL AMDPRFMT;          /* FORMAT LINE                   */
         L     @15,FMTADDR(,PLISTPTR)                           02S1156
         BALR  @14,@15                                          02S1156
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S1157
*         END;                                                  02S1158
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S1159
*     END S75;                      /* END OF SUBCASE                */
*                                                               02S1161
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 82. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A VOL-SER + A VARIABLE LENGTH TTR + A    */
*     /* VARIABLE LENGTH PLIST.                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S1161
*S82:                                                           02S1161
*     DO;                           /* SUBCASE                       */
S82      DS    0H                                               02S1162
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S1162
         CH    @14,TIMESW                                       02S1162
         BNE   @RF01162                                         02S1162
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S1163
*       ELSE                                                    02S1164
*         DO;                       /* YES - REGISTERS HAVE BEEN
*                                      FORMATTED                     */
         B     @RC01162                                         02S1164
@RF01162 DS    0H                                               02S1165
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE
*                                      BEEN FORMATTED                */
         CLC   TIMESW(2),@CH00046                               02S1165
         BNE   @RF01165                                         02S1165
*             DO;                   /* NO                            */
*               ADPLFMT1=ADDR(GP4TYP23);/* ADDR OF LABEL FOR THIS
*                                      FIELD                         */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1167
         LA    @07,GP4TYP23                                     02S1167
         ST    @07,ADPLFMT1(,@14)                               02S1167
*               ADPLFMT2=ADDR(VOLSER1);/* ADDR OF DATA IN BUFFER     */
         LA    @07,46                                           02S1168
         AL    @07,DATAPTR(,PLISTPTR)                           02S1168
         ST    @07,ADPLFMT2(,@14)                               02S1168
*               R0=ADDR(GP4S82A);   /* ADDR OF PATTERNS              */
         LA    R0,GP4S82A                                       02S1169
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1170
         BALR  @14,@15                                          02S1170
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND
*                                      RETURN FOR THIRD PASS         */
         SLR   RETCODE,RETCODE                                  02S1171
*             END;                                              02S1172
*           ELSE                                                02S1173
*             DO;                   /* YES - FORMAT THE THIRD LINE   */
         B     @RC01165                                         02S1173
@RF01165 DS    0H                                               02S1174
*               DYNAMPTN(1:LENGTH(GP4S48B))=GP4S48B;/* MOVE PATTERNS
*                                      TO GETMAINED AREA             */
         MVC   DYNAMPTN(21),GP4S48B                             02S1174
*               IF RCD82LN=ERROR THEN/* IS FIELD IN ERROR            */
         LA    @14,46                                           02S1175
         AL    @14,DATAPTR(,PLISTPTR)                           02S1175
         CLI   RCD82LN(@14),255                                 02S1175
         BNE   @RF01175                                         02S1175
*                 DO;               /* YES                           */
*                   OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @07,@07                                          02S1177
         IC    @07,OLDFLG                                       02S1177
         O     @07,@CF00092                                     02S1177
         STC   @07,OLDFLG                                       02S1177
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S1178
*                   RCD82LN=4;      /* MODIFY LENGTH IN ORDER TO
*                                      ACCESS NEXT FIELD             */
         MVI   RCD82LN(@14),X'04'                               02S1179
*                 END;                                          02S1180
*               ELSE                                            02S1181
*                 DO;               /* NO - FORMAT 2, 3 OR 4 WORDS   */
         B     @RC01175                                         02S1181
@RF01175 DS    0H                                               02S1182
*                   K=RCD82LN/4;    /* NUMBER OF WORDS               */
         L     @14,DATAPTR(,PLISTPTR)                           02S1182
         SLR   K,K                                              02S1182
         IC    K,RCD82LN+46(,@14)                               02S1182
         SRL   K,2                                              02S1182
*                   OLDFLG(K+1)=0;  /* INDICATE END OF PATTERNS      */
         LR    @14,K                                            02S1183
         SLA   @14,2                                            02S1183
         SLR   @07,@07                                          02S1183
         STC   @07,OLDFLG(@14)                                  02S1183
*                 END;                                          02S1184
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIS LINE*/
@RC01175 LA    R0,DYNAMPTN                                      02S1185
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS LINE */
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1186
         LA    @07,GROUP2                                       02S1186
         ST    @07,ADPLFMT1(,@14)                               02S1186
*               ADPLFMT2=ADDR(RCD82LN)+1;/* ADDR OF DATA IN BUFFER   */
         L     @07,DATAPTR(,PLISTPTR)                           02S1187
         LA    @07,RCD82LN+46(,@07)                             02S1187
         AH    @07,@CH00046                                     02S1187
         ST    @07,ADPLFMT2(,@14)                               02S1187
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1188
         BALR  @14,@15                                          02S1188
*               DYNAMPTN(1:LENGTH(GP4S82B))=GP4S82B;/* MOVE PATTERNS
*                                      TO GETMAIN AREA               */
         MVC   DYNAMPTN(9),GP4S82B                              02S1189
*               FIELDADR=ADDR(RCD82LN)+RCD82LN+1;/* ADDR OF TTR IN
*                                      BUFFER                        */
         LA    @14,46                                           02S1190
         AL    @14,DATAPTR(,PLISTPTR)                           02S1190
         LA    @07,RCD82LN(,@14)                                02S1190
         SLR   @05,@05                                          02S1190
         IC    @05,RCD82LN(,@14)                                02S1190
         ALR   @07,@05                                          02S1190
         AH    @07,@CH00046                                     02S1190
         ST    @07,FIELDADR                                     02S1190
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S1191
*               IF NXTFIELD=0 THEN  /* IS THERE ANY DATA             */
         CLI   NXTFIELD(@07),0                                  02S1192
         BNE   @RF01192                                         02S1192
*                 R0=ADDR(GP4S82C); /* NO - ADDR OF PATTERNS FOR THIS
*                                      LINE                          */
         LA    R0,GP4S82C                                       02S1193
*               ELSE                                            02S1194
*                 DO;               /* YES - CHECK FOR ERROR         */
         B     @RC01192                                         02S1194
@RF01192 DS    0H                                               02S1195
*                   IF NXTFIELD=ERROR THEN/* IS FIELD IN ERROR       */
         L     @14,FIELDADR                                     02S1195
         CLI   NXTFIELD(@14),255                                02S1195
         BNE   @RF01195                                         02S1195
*                     DO;           /* YES                           */
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA LENGTH
*                                      TO 0                          */
         SLR   @14,@14                                          02S1197
         IC    @14,OLDLN                                        02S1197
         N     @14,@CF00297                                     02S1197
         STC   @14,OLDLN                                        02S1197
*                       OLDLN(1)=OLDLN(1)×(4-1);/* LENGTH OF 4 TO
*                                      FORMAT ERROR INDICATOR        */
         O     @14,@CF00170                                     02S1198
         STC   @14,OLDLN                                        02S1198
*                       OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA
*                                      IN EBCDIC                     */
         SLR   @14,@14                                          02S1199
         IC    @14,OLDFLG                                       02S1199
         O     @14,@CF00092                                     02S1199
         STC   @14,OLDFLG                                       02S1199
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+4,X'00'                                   02S1200
*                     END;                                      02S1201
*                   ELSE                                        02S1202
*                     DO;           /* NO - FIELD IS OK              */
         B     @RC01195                                         02S1202
@RF01195 DS    0H                                               02S1203
*                       IF NXTFIELD^=8 THEN/* IS ENTIRE TTR THERE    */
         L     @14,FIELDADR                                     02S1203
         CLI   NXTFIELD(@14),8                                  02S1203
         BE    @RF01203                                         02S1203
*                         OLDFLG(2)=0;/* INDICATE END OF PATTERNS    */
         MVI   OLDFLG+4,X'00'                                   02S1204
*                     END;                                      02S1205
@RF01203 DS    0H                                               02S1206
*                 END;                                          02S1206
@RC01195 DS    0H                                               02S1207
*               ADPLFMT1=ADDR(GP4TP23A);/* ADDR OF LABEL FOR THIS
*                                      LINE                          */
@RC01192 L     @14,ABDPLPTR(,PLISTPTR)                          02S1207
         LA    @07,GP4TP23A                                     02S1207
         ST    @07,ADPLFMT1(,@14)                               02S1207
*               ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER        */
         LA    @07,1                                            02S1208
         AL    @07,FIELDADR                                     02S1208
         ST    @07,ADPLFMT2(,@14)                               02S1208
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1209
         BALR  @14,@15                                          02S1209
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S1210
*             END;                                              02S1211
*         END;                                                  02S1212
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S1213
*     END S82;                      /* END OF SUBCASE                */
*                                                               02S1215
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 86. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + AN 8 BYTE PLIST + A TTR.                 */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S1215
*S86:                                                           02S1215
*     DO;                           /* SUBCASE                       */
S86      DS    0H                                               02S1216
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S1216
         CH    @14,TIMESW                                       02S1216
         BNE   @RF01216                                         02S1216
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S1217
*       ELSE                                                    02S1218
*         DO;                       /* YES - FORMAT REMAINING FIELDS */
         B     @RC01216                                         02S1218
@RF01216 DS    0H                                               02S1219
*           DYNAMPTN(1:LENGTH(GP4S86))=GP4S86;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(13),GP4S86                              02S1219
*           IF RCD86LST=ASTER8×RCD86LST=PEES8×RCD86LST=ESSES8 THEN/*
*                                      IS FIELD IN ERROR             */
         LA    @14,46                                           02S1220
         AL    @14,DATAPTR(,PLISTPTR)                           02S1220
         CLC   RCD86LST(8,@14),ASTER8                           02S1220
         BE    @RT01220                                         02S1220
         CLC   RCD86LST(8,@14),PEES8                            02S1220
         BE    @RT01220                                         02S1220
         CLC   RCD86LST(8,@14),ESSES8                           02S1220
         BNE   @RF01220                                         02S1220
@RT01220 DS    0H                                               02S1221
*             DO;                   /* YES                           */
*               OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         LA    @14,32                                           02S1222
         SLR   @07,@07                                          02S1222
         IC    @07,OLDFLG                                       02S1222
         OR    @07,@14                                          02S1222
         STC   @07,OLDFLG                                       02S1222
*               OLDFLG(2)=OLDFLG(2)×CHARFLAG;                   02S1223
         SLR   @07,@07                                          02S1223
         IC    @07,OLDFLG+4                                     02S1223
         OR    @14,@07                                          02S1223
         STC   @14,OLDFLG+4                                     02S1223
*             END;                                              02S1224
*           IF TTR=ASTER5×TTR=PEES5×TTR=ESSES5 THEN/* IS FIELD IN
*                                      ERROR                         */
@RF01220 LA    @14,46                                           02S1225
         AL    @14,DATAPTR(,PLISTPTR)                           02S1225
         CLC   TTR(5,@14),ASTER5                                02S1225
         BE    @RT01225                                         02S1225
         CLC   TTR(5,@14),PEES5                                 02S1225
         BE    @RT01225                                         02S1225
         CLC   TTR(5,@14),ESSES5                                02S1225
         BNE   @RF01225                                         02S1225
@RT01225 DS    0H                                               02S1226
*             OLDFLG(3)=OLDFLG(3)×CHARFLAG;/* INDICATE DATA IN EBCDIC*/
         SLR   @14,@14                                          02S1226
         IC    @14,OLDFLG+8                                     02S1226
         O     @14,@CF00092                                     02S1226
         STC   @14,OLDFLG+8                                     02S1226
*           ADPLFMT1=ADDR(GP4TYP24);/* ADDR OF LABELS FOR THIS LINE  */
@RF01225 L     @14,ABDPLPTR(,PLISTPTR)                          02S1227
         LA    @07,GP4TYP24                                     02S1227
         ST    @07,ADPLFMT1(,@14)                               02S1227
*           ADPLFMT2=ADDR(RCD86LST);/* ADDR OF DATA IN BUFFER        */
         LA    @07,46                                           02S1228
         AL    @07,DATAPTR(,PLISTPTR)                           02S1228
         ST    @07,ADPLFMT2(,@14)                               02S1228
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R0,DYNAMPTN                                      02S1229
*           CALL AMDPRFMT;          /* FORMAT LINE                   */
         L     @15,FMTADDR(,PLISTPTR)                           02S1230
         BALR  @14,@15                                          02S1230
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S1231
*         END;                                                  02S1232
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S1233
*     END S86;                      /* END OF SUBCASE                */
*                                                               02S1235
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 88. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A DEB ADDR + A DSSTAT + A DEVMOD.        */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S1235
*S88:                                                           02S1235
*     DO;                           /* SUBCASE                       */
S88      DS    0H                                               02S1236
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S1236
         CH    @14,TIMESW                                       02S1236
         BNE   @RF01236                                         02S1236
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S1237
*       ELSE                                                    02S1238
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS
*                                      & FORMAT THEM                 */
         B     @RC01236                                         02S1238
@RF01236 DS    0H                                               02S1239
*           DYNAMPTN(1:LENGTH(GP4S88))=GP4S88;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(13),GP4S88                              02S1239
*           IF RCD88DEB=ASTER4×RCD88DEB=PEES4×RCD88DEB=ESSES4 THEN/*
*                                      IS FIELD IN ERROR             */
         LA    @14,46                                           02S1240
         AL    @14,DATAPTR(,PLISTPTR)                           02S1240
         CLC   RCD88DEB(4,@14),ASTER4                           02S1240
         BE    @RT01240                                         02S1240
         CLC   RCD88DEB(4,@14),PEES4                            02S1240
         BE    @RT01240                                         02S1240
         CLC   RCD88DEB(4,@14),ESSES4                           02S1240
         BNE   @RF01240                                         02S1240
@RT01240 DS    0H                                               02S1241
*             OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S1241
         IC    @14,OLDFLG                                       02S1241
         O     @14,@CF00092                                     02S1241
         STC   @14,OLDFLG                                       02S1241
*           IF DSSTAT=ASTER1×DSSTAT=PEES1×DSSTAT=ESSES1 THEN/* IS
*                                      FIELD IN ERROR                */
@RF01240 LA    @14,46                                           02S1242
         AL    @14,DATAPTR(,PLISTPTR)                           02S1242
         CLC   DSSTAT(1,@14),ASTER1                             02S1242
         BE    @RT01242                                         02S1242
         CLC   DSSTAT(1,@14),PEES1                              02S1242
         BE    @RT01242                                         02S1242
         CLC   DSSTAT(1,@14),ESSES1                             02S1242
         BNE   @RF01242                                         02S1242
@RT01242 DS    0H                                               02S1243
*             OLDFLG(2)=OLDFLG(2)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S1243
         IC    @14,OLDFLG+4                                     02S1243
         O     @14,@CF00092                                     02S1243
         STC   @14,OLDFLG+4                                     02S1243
*           IF DEVMOD=ASTER1×DEVMOD=PEES1×DEVMOD=ESSES1 THEN/* IS
*                                      FIELD IN ERROR                */
@RF01242 LA    @14,46                                           02S1244
         AL    @14,DATAPTR(,PLISTPTR)                           02S1244
         CLC   DEVMOD(1,@14),ASTER1                             02S1244
         BE    @RT01244                                         02S1244
         CLC   DEVMOD(1,@14),PEES1                              02S1244
         BE    @RT01244                                         02S1244
         CLC   DEVMOD(1,@14),ESSES1                             02S1244
         BNE   @RF01244                                         02S1244
@RT01244 DS    0H                                               02S1245
*             OLDFLG(3)=OLDFLG(3)×CHARFLAG;/* YES - INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S1245
         IC    @14,OLDFLG+8                                     02S1245
         O     @14,@CF00092                                     02S1245
         STC   @14,OLDFLG+8                                     02S1245
*           ADPLFMT1=ADDR(GP4TYP14);/* ADDR OF LABELS FOR THIS LINE  */
@RF01244 L     @14,ABDPLPTR(,PLISTPTR)                          02S1246
         LA    @07,GP4TYP14                                     02S1246
         ST    @07,ADPLFMT1(,@14)                               02S1246
*           ADPLFMT2=ADDR(RCD88DEB);/* ADDR OF DATA IN BUFFER        */
         LA    @07,46                                           02S1247
         AL    @07,DATAPTR(,PLISTPTR)                           02S1247
         ST    @07,ADPLFMT2(,@14)                               02S1247
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S1248
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1249
         BALR  @14,@15                                          02S1249
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S1250
*         END;                                                  02S1251
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S1252
*     END S88;                      /* END OF SUBCASE                */
*                                                               02S1254
*     /***************************************************************/
*     /*                                                             */
*     /* THIS ROUTINE WILL PROCESS SVC 98. THE FORMATTING CONSISTS OF*/
*     /* THE BASIC RECORD + A 4 BYTE PLIST + A VARIABLE LENGTH       */
*     /* DSNAME.                                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S1254
*S98:                                                           02S1254
*     DO;                           /* SUBCASE                       */
S98      DS    0H                                               02S1255
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/
         SLR   @14,@14                                          02S1255
         CH    @14,TIMESW                                       02S1255
         BNE   @RF01255                                         02S1255
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER
*                                      AND RETURN FOR SECOND PASS    */
         LR    RETCODE,@14                                      02S1256
*       ELSE                                                    02S1257
*         DO;                       /* YES - REGISTERS HAVE BEEN
*                                      FORMATTED                     */
         B     @RC01255                                         02S1257
@RF01255 DS    0H                                               02S1258
*           DYNAMPTN(1:LENGTH(GP4S98))=GP4S98;/* MOVE PATTERNS TO
*                                      GETMAINED AREA                */
         MVC   DYNAMPTN(21),GP4S98                              02S1258
*           IF RCD98LST=ASTER4×RCD98LST=PEES4×RCD98LST=ESSES4 THEN/*
*                                      IS FIELD IN ERROR             */
         LA    @14,46                                           02S1259
         AL    @14,DATAPTR(,PLISTPTR)                           02S1259
         CLC   RCD98LST(4,@14),ASTER4                           02S1259
         BE    @RT01259                                         02S1259
         CLC   RCD98LST(4,@14),PEES4                            02S1259
         BE    @RT01259                                         02S1259
         CLC   RCD98LST(4,@14),ESSES4                           02S1259
         BNE   @RF01259                                         02S1259
@RT01259 DS    0H                                               02S1260
*             DO;                   /* YES                           */
*               OLDFLG(1)=OLDFLG(1)×CHARFLAG;/* INDICATE DATA IN
*                                      EBCDIC                        */
         SLR   @14,@14                                          02S1261
         IC    @14,OLDFLG                                       02S1261
         O     @14,@CF00092                                     02S1261
         STC   @14,OLDFLG                                       02S1261
*             END;                                              02S1262
*           IF RCD98LN^=ERROR THEN  /* IS FIELD IN ERROR             */
@RF01259 LA    @14,46                                           02S1263
         AL    @14,DATAPTR(,PLISTPTR)                           02S1263
         CLI   RCD98LN(@14),255                                 02S1263
         BE    @RF01263                                         02S1263
*             DO;                   /* NO-CHECK DATA LENGTH FOR ZERO */
*               IF RCD98LN=0 THEN   /* IS THERE ANY DATA     @YM03669*/
         CLI   RCD98LN(@14),0                                   02S1265
         BNE   @RF01265                                         02S1265
*                 DO;               /* NO                    @YM03669*/
*                   OLDFLG(3)=OLDFLG(3)&DATAFLAG;/* INDICATE NO DATA
*                                                            @YM03669*/
         SLR   @14,@14                                          02S1267
         IC    @14,OLDFLG+8                                     02S1267
         N     @14,@CF00295                                     02S1267
         STC   @14,OLDFLG+8                                     02S1267
*                   OLDLN(3)=96;    /* NEW LABEL LENGTH ((7-1)*16)
*                                      AND ZERO DATA LENGTH  @YM03669*/
         MVI   OLDLN+8,X'60'                                    02S1268
*                   OLDFLG(4)=0;    /* INDICATE END OF PATTERNS 02S1269
*                                                            @YM03669*/
         MVI   OLDFLG+12,X'00'                                  02S1269
*                 END;              /*                       @YM03669*/
*               ELSE                /*                       @YM03669*/
*                 DO;               /* YES - THERE IS DATA   @YM03669*/
         B     @RC01265                                         02S1271
@RF01265 DS    0H                                               02S1272
*                   IF RCD98LN^=44 THEN/* IS DSN MAX LENGTH          */
         LA    @14,46                                           02S1272
         AL    @14,DATAPTR(,PLISTPTR)                           02S1272
         CLI   RCD98LN(@14),44                                  02S1272
         BE    @RF01272                                         02S1272
*                     DO;           /* NO                            */
*                       K=RCD98LN/16;/* NUMBER OF FULL WORDS         */
         SLR   @05,@05                                          02S1274
         IC    @05,RCD98LN(,@14)                                02S1274
         LR    K,@05                                            02S1274
         SRL   K,4                                              02S1274
*                       MOD=RCD98LN//16;/* REMAINDER OF PARTIAL WORD */
         LR    @02,@05                                          02S1275
         SRDA  @02,32                                           02S1275
         D     @02,@CF00139                                     02S1275
         LR    MOD,@02                                          02S1275
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */
         SLR   @14,@14                                          02S1276
         CR    MOD,@14                                          02S1276
         BNE   @RF01276                                         02S1276
*                         OLDFLG(K+3)=0;/* YES - INDICATE END OF
*                                      PATTERNS                      */
         LR    @07,K                                            02S1277
         SLA   @07,2                                            02S1277
         STC   @14,OLDFLG+8(@07)                                02S1277
*                       ELSE                                    02S1278
*                         DO;       /* NO - MODIFY PATTERNS     02S1278
*                                      ACCORDINGLY                   */
         B     @RC01276                                         02S1278
@RF01276 DS    0H                                               02S1279
*                           OLDLN(K+3)=OLDLN(K+3)&DATAOFF;/* SET DATA
*                                      LENGTH TO ZERO                */
         LR    @14,K                                            02S1279
         SLA   @14,2                                            02S1279
         SLR   @05,@05                                          02S1279
         IC    @05,OLDLN+8(@14)                                 02S1279
         N     @05,@CF00297                                     02S1279
         STC   @05,OLDLN+8(@14)                                 02S1279
*                           OLDLN(K+3)=OLDLN(K+3)×(MOD-1);/* NEW DATA
*                                      LENGTH                        */
         LR    @03,MOD                                          02S1280
         BCTR  @03,0                                            02S1280
         OR    @05,@03                                          02S1280
         STC   @05,OLDLN+8(@14)                                 02S1280
*                           OLDFLG(K+4)=0;/* INDICATE END OF PATTERNS*/
         SLR   @07,@07                                          02S1281
         STC   @07,OLDFLG+12(@14)                               02S1281
*                         END;                                  02S1282
*                     END;                                      02S1283
*                 END;              /*                       @YM03669*/
*             END;                                              02S1285
*           ELSE                                                02S1286
*             DO;                   /* YES - FIELD IS IN ERROR       */
         B     @RC01263                                         02S1286
@RF01263 DS    0H                                               02S1287
*               OLDLN(3)=OLDLN(3)&DATAOFF;/* ZERO DATA LENGTH        */
         SLR   @14,@14                                          02S1287
         IC    @14,OLDLN+8                                      02S1287
         N     @14,@CF00297                                     02S1287
         STC   @14,OLDLN+8                                      02S1287
*               OLDLN(3)=OLDLN(3)×DATALN4;/* SET DATA LENGTH TO 02S1288
*                                      FORMAT 4 BYTES                */
         O     @14,@CF00170                                     02S1288
         STC   @14,OLDLN+8                                      02S1288
*               OLDFLG(4)=0;        /* INDICATE END OF PATTERNS      */
         MVI   OLDFLG+12,X'00'                                  02S1289
*             END;                                              02S1290
*           ADPLFMT1=ADDR(GP4TYP19);/* ADDR OF LABELS FOR THIS LINE  */
@RC01263 L     @14,ABDPLPTR(,PLISTPTR)                          02S1291
         LA    @07,GP4TYP19                                     02S1291
         ST    @07,ADPLFMT1(,@14)                               02S1291
*           ADPLFMT2=ADDR(RCD98LST);/* ADDR OF DATA IN BUFFER        */
         LA    @07,46                                           02S1292
         AL    @07,DATAPTR(,PLISTPTR)                           02S1292
         ST    @07,ADPLFMT2(,@14)                               02S1292
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */
         LA    R0,DYNAMPTN                                      02S1293
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */
         L     @15,FMTADDR(,PLISTPTR)                           02S1294
         BALR  @14,@15                                          02S1294
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND
*                                      GET NEXT RECORD               */
         LA    RETCODE,4                                        02S1295
*         END;                                                  02S1296
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S1297
*     END S98;                      /* END OF SUBCASE                */
*CE0001@:                                                       02S1299
*   END;                            /* END OF CASE                   */
*                                                               02S1299
CE0001@  DS    0H                                               02S1300
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER WITH RETURN CODE IN REGISTER 15.             */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1300
*   RESPECIFY                                                   02S1300
*     R14 RESTRICTED;                                           02S1300
*   R14=SAVER14;                    /* ADDR OF RETURN POINT          */
         L     R14,SAVER14                                      02S1301
*   RESPECIFY                                                   02S1302
*     R14 UNRESTRICTED;                                         02S1302
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER WITH RETURN
*                                      CODE                          */
@EL00002 DS    0H                                               02S1303
@EF00002 DS    0H                                               02S1303
@ER00002 BR    @14                                              02S1303
*   END SVCFORMX;                                               02S1304
*   END AMDSYS01                                                01S1305
*                                                               01S1305
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSUT5  (SYS01LOG)                                       */
*/*%INCLUDE SYSUT5  (MACROS  )                                       */
*/*%INCLUDE SYSLIB  (AMDPRTAB)                                       */
*/*%INCLUDE SYSLIB  (IHAABDPL)                                       */
*/*%INCLUDE SYSUT5  (SYS01DCL)                                       */
*/*%INCLUDE SYSUT5  (FORMTPTN)                                       */
*/*%INCLUDE SYSUT5  (CHECKSVC)                                       */
*/*%INCLUDE SYSUT5  (BASICLN1)                                       */
*/*%INCLUDE SYSUT5  (BASICLN2)                                       */
*/*%INCLUDE SYSUT5  (SVCFORMX)                                       */
*                                                               01S1305
*       ;                                                       01S1305
@DATA    DS    0H
@CH00046 DC    H'1'
@CH00078 DC    H'2'
@CH00434 DC    H'14'
@CH00514 DC    H'33'
@CH01324 DC    H'36'
@CH00563 DC    H'42'
@CH01425 DC    H'45'
@CH01327 DC    H'82'
@CH01372 DC    XL2'FF'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
AMDSYS01 CSECT
         DS    0F
@CF00170 DC    F'3'
@CH00170 EQU   @CF00170+2
@CF00099 DC    F'4'
@CF00034 DC    F'8'
@CH00034 EQU   @CF00034+2
@CF00139 DC    F'16'
@CF00092 DC    F'32'
@CF00297 DC    F'240'
@CF00295 DC    F'251'
@DATD    DSECT
         DS    0D
FIELDADR DS    A
SAVER14  DS    A
PTRNADDR DS    A
TIMESW   DS    H
         DS    0D
@TS00001 DS    CL8
DYNAMPTN DS    CL48
PAKEDSVC DS    CL2
UNPAKTO  DS    CL5
DATALNTH DS    CL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
AMDSYS01 CSECT
         NOPR  ((@ENDDATD-@DATD)/201*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CB01365 DC    X'EEEE'
@CB01430 DC    X'006E'
@CB01431 DC    X'0076'
ASTER20  DC    CL20'********************'
         ORG   ASTER20
ASTER16  DS    CL16
         ORG   ASTER16
ASTER12  DS    CL12
         ORG   ASTER12
ASTER8   DS    CL8
         ORG   ASTER8
ASTER6   DS    CL6
         ORG   ASTER6
ASTER5   DS    CL5
         ORG   ASTER8+6
ASTER2   DS    CL2
         ORG   ASTER12+8
ASTER4   DS    CL4
         ORG   ASTER16+12
ASTER1   DS    CL1
         ORG   ASTER20+20
PEES20   DC    CL20'PPPPPPPPPPPPPPPPPPPP'
         ORG   PEES20
PEES16   DS    CL16
         ORG   PEES16
PEES12   DS    CL12
         ORG   PEES12
PEES8    DS    CL8
         ORG   PEES8
PEES6    DS    CL6
         ORG   PEES6
PEES5    DS    CL5
         ORG   PEES8+6
PEES2    DS    CL2
         ORG   PEES12+8
PEES4    DS    CL4
         ORG   PEES16+12
PEES1    DS    CL1
         ORG   PEES20+20
ESSES20  DC    CL20'SSSSSSSSSSSSSSSSSSSS'
         ORG   ESSES20
ESSES16  DS    CL16
         ORG   ESSES16
ESSES12  DS    CL12
         ORG   ESSES12
ESSES8   DS    CL8
         ORG   ESSES8
ESSES6   DS    CL6
         ORG   ESSES6
ESSES5   DS    CL5
         ORG   ESSES8+6
ESSES2   DS    CL2
         ORG   ESSES12+8
ESSES4   DS    CL4
         ORG   ESSES16+12
ESSES1   DS    CL1
         ORG   ESSES20+20
UA       DC    CL4'U/A '
LBASICL0 DC    CL3'SVC'
LBASICL1 DC    CL25'ASCBCPUJOBNOLD PSWTCBMODN'
LBASICL2 DC    CL7'R15R0R1'
LDDNL1   DC    CL3'DDN'
GROUP2   DC    CL9'PLIST N/A'
GP4TYP1  DC    CL6'DCBDEB'
GP4TYP2  DC    CL10'VOLIST N/A'
GP4TYP3  DC    CL15'EP/DE NAMEPLIST'
GP4TYP4  DC    CL9'COMP CODE'
GP4TYP5  DC    CL4'PICA'
GP4TYP6  DC    CL14'ERR FLGSTCBCUU'
GP4TYP7  DC    CL12'DCBPRG PLIST'
GP4TYP8  DC    CL16'DCBFDADDCBTRKBAL'
GP4TYP9  DC    CL6'DSN/CI'
GP4TYP9A DC    CL6'DSN   '
GP4TYP10 DC    CL12'PLISTVOL-SER'
GP4TP10A DC    CL7'DSN/TTR'
GP4TYP11 DC    CL3'R13'
GP4TYP12 DC    CL7'OLD DSN'
GP4TP12A DC    CL7'NEW DSN'
GP4TYP13 DC    CL6'CUUDSN'
GP4TYP14 DC    CL15'DEBDSSTATDEVMOD'
GP4TYP15 DC    CL4'NAME'
GP4TYP16 DC    CL9'SPVR LIST'
GP4TP16A DC    CL14'PROB PLIST N/A'
GP4TYP17 DC    CL9'CHAP TCB '
GP4TYP18 DC    CL10'MAJORMINOR'
GP4TYP19 DC    CL12'PLISTDSN N/A'
GP4TYP20 DC    CL9'DETCH TCB'
GP4TYP21 DC    CL8'IOBERINF'
GP4TYP22 DC    CL7'IQE N/A'
GP4TYP23 DC    CL7'VOL-SER'
GP4TP23A DC    CL7'TTR N/A'
GP4TYP24 DC    CL8'PLISTTTR'
SVCTITLE DS    CL9
         ORG   SVCTITLE
@NM00009 DC    AL1(55)
@NM00010 DC    AL1(34)
@NM00011 DC    AL1(0)
@NM00012 DC    AL1(6)
@NM00013 DC    AL4(LBASICL0)
@NM00014 DC    AL1(0)
         ORG   SVCTITLE+9
         DS    CL3
FIRSTLN  DS    CL33
         ORG   FIRSTLN
@NM00015 DC    AL1(23)
@NM00016 DC    AL1(51)
@NM00017 DC    AL1(10)
@NM00018 DC    AL1(15)
@NM00019 DC    AL4(LBASICL1)
@NM00020 DC    AL1(21)
@NM00021 DC    AL1(33)
@NM00022 DC    AL1(25)
@NM00023 DC    AL1(29)
@NM00024 DC    AL1(53)
@NM00025 DC    AL1(55)
@NM00026 DC    AL1(35)
@NM00027 DC    AL1(40)
@NM00028 DC    AL1(21)
@NM00029 DC    AL1(99)
@NM00030 DC    AL1(50)
@NM00031 DC    AL1(58)
@NM00032 DC    AL1(20)
@NM00033 DC    AL1(3)
@NM00034 DC    AL1(0)
@NM00035 DC    AL1(67)
@NM00036 DC    AL1(21)
@NM00037 DC    AL1(35)
@NM00038 DC    AL1(77)
@NM00039 DC    AL1(81)
@NM00040 DC    AL1(53)
@NM00041 DC    AL1(55)
@NM00042 DC    AL1(91)
@NM00043 DC    AL1(96)
@NM00044 DC    AL1(0)
         ORG   FIRSTLN+33
         DS    CL3
SECONDLN DS    CL13
         ORG   SECONDLN
@NM00045 DC    AL1(21)
@NM00046 DC    AL1(35)
@NM00047 DC    AL1(10)
@NM00048 DC    AL1(15)
@NM00049 DC    AL1(21)
@NM00050 DC    AL1(19)
@NM00051 DC    AL1(25)
@NM00052 DC    AL1(29)
@NM00053 DC    AL1(21)
@NM00054 DC    AL1(19)
@NM00055 DC    AL1(39)
@NM00056 DC    AL1(42)
@NM00057 DC    AL1(0)
         ORG   SECONDLN+13
         DS    CL3
DDNLN1   DS    CL5
         ORG   DDNLN1
@NM00058 DC    AL1(53)
@NM00059 DC    AL1(39)
@NM00060 DC    AL1(106)
@NM00061 DC    AL1(110)
@NM00062 DC    AL1(0)
         ORG   DDNLN1+5
         DS    CL3
GRP2LN3  DS    CL41
         ORG   GRP2LN3
@NM00063 DC    AL1(21)
@NM00064 DC    AL1(67)
@NM00065 DC    AL1(10)
@NM00066 DC    AL1(16)
@NM00067 DC    AL1(20)
@NM00068 DC    AL1(3)
@NM00069 DC    AL1(0)
@NM00070 DC    AL1(25)
@NM00071 DC    AL1(20)
@NM00072 DC    AL1(3)
@NM00073 DC    AL1(0)
@NM00074 DC    AL1(34)
@NM00075 DC    AL1(20)
@NM00076 DC    AL1(3)
@NM00077 DC    AL1(0)
@NM00078 DC    AL1(43)
@NM00079 DC    AL1(20)
@NM00080 DC    AL1(3)
@NM00081 DC    AL1(0)
@NM00082 DC    AL1(52)
@NM00083 DC    AL1(20)
@NM00084 DC    AL1(3)
@NM00085 DC    AL1(0)
@NM00086 DC    AL1(61)
@NM00087 DC    AL1(20)
@NM00088 DC    AL1(3)
@NM00089 DC    AL1(0)
@NM00090 DC    AL1(70)
@NM00091 DC    AL1(20)
@NM00092 DC    AL1(3)
@NM00093 DC    AL1(0)
@NM00094 DC    AL1(79)
@NM00095 DC    AL1(20)
@NM00096 DC    AL1(3)
@NM00097 DC    AL1(0)
@NM00098 DC    AL1(88)
@NM00099 DC    AL1(20)
@NM00100 DC    AL1(3)
@NM00101 DC    AL1(0)
@NM00102 DC    AL1(97)
@NM00103 DC    AL1(0)
         ORG   GRP2LN3+41
         DS    CL3
GP2NA    DS    CL5
         ORG   GP2NA
@NM00104 DC    AL1(17)
@NM00105 DC    AL1(128)
@NM00106 DC    AL1(10)
@NM00107 DC    AL1(0)
@NM00108 DC    AL1(0)
         ORG   GP2NA+5
         DS    CL3
GP4S00   DS    CL9
         ORG   GP4S00
@NM00109 DC    AL1(21)
@NM00110 DC    AL1(35)
@NM00111 DC    AL1(52)
@NM00112 DC    AL1(56)
@NM00113 DC    AL1(21)
@NM00114 DC    AL1(35)
@NM00115 DC    AL1(66)
@NM00116 DC    AL1(70)
@NM00117 DC    AL1(0)
         ORG   GP4S00+9
         DS    CL3
GP4S06   DS    CL17
         ORG   GP4S06
@NM00118 DC    AL1(53)
@NM00119 DC    AL1(151)
@NM00120 DC    AL1(52)
@NM00121 DC    AL1(63)
@NM00122 DC    AL1(21)
@NM00123 DC    AL1(67)
@NM00124 DC    AL1(73)
@NM00125 DC    AL1(79)
@NM00126 DC    AL1(20)
@NM00127 DC    AL1(3)
@NM00128 DC    AL1(0)
@NM00129 DC    AL1(88)
@NM00130 DC    AL1(20)
@NM00131 DC    AL1(3)
@NM00132 DC    AL1(0)
@NM00133 DC    AL1(97)
@NM00134 DC    AL1(0)
         ORG   GP4S06+17
         DS    CL3
GP4S08   DS    CL5
         ORG   GP4S08
@NM00135 DC    AL1(53)
@NM00136 DC    AL1(151)
@NM00137 DC    AL1(52)
@NM00138 DC    AL1(63)
@NM00139 DC    AL1(0)
         ORG   GP4S08+5
         DS    CL3
GP4S13   DS    CL5
         ORG   GP4S13
@NM00140 DC    AL1(21)
@NM00141 DC    AL1(131)
@NM00142 DC    AL1(52)
@NM00143 DC    AL1(63)
@NM00144 DC    AL1(0)
         ORG   GP4S13+5
         DS    CL3
GP4S14   DS    CL5
         ORG   GP4S14
@NM00145 DC    AL1(21)
@NM00146 DC    AL1(53)
@NM00147 DC    AL1(52)
@NM00148 DC    AL1(58)
@NM00149 DC    AL1(0)
         ORG   GP4S14+5
         DS    CL3
GP4S15   DS    CL13
         ORG   GP4S15
@NM00150 DC    AL1(21)
@NM00151 DC    AL1(112)
@NM00152 DC    AL1(52)
@NM00153 DC    AL1(61)
@NM00154 DC    AL1(21)
@NM00155 DC    AL1(35)
@NM00156 DC    AL1(66)
@NM00157 DC    AL1(70)
@NM00158 DC    AL1(21)
@NM00159 DC    AL1(33)
@NM00160 DC    AL1(80)
@NM00161 DC    AL1(84)
@NM00162 DC    AL1(0)
         ORG   GP4S15+13
         DS    CL3
GP4S16   DS    CL17
         ORG   GP4S16
@NM00163 DC    AL1(21)
@NM00164 DC    AL1(35)
@NM00165 DC    AL1(52)
@NM00166 DC    AL1(56)
@NM00167 DC    AL1(21)
@NM00168 DC    AL1(131)
@NM00169 DC    AL1(66)
@NM00170 DC    AL1(76)
@NM00171 DC    AL1(20)
@NM00172 DC    AL1(3)
@NM00173 DC    AL1(0)
@NM00174 DC    AL1(85)
@NM00175 DC    AL1(20)
@NM00176 DC    AL1(3)
@NM00177 DC    AL1(0)
@NM00178 DC    AL1(94)
@NM00179 DC    AL1(0)
         ORG   GP4S16+17
         DS    CL3
GP4S21   DS    CL17
         ORG   GP4S21
@NM00180 DC    AL1(21)
@NM00181 DC    AL1(67)
@NM00182 DC    AL1(52)
@NM00183 DC    AL1(58)
@NM00184 DC    AL1(20)
@NM00185 DC    AL1(3)
@NM00186 DC    AL1(0)
@NM00187 DC    AL1(67)
@NM00188 DC    AL1(20)
@NM00189 DC    AL1(3)
@NM00190 DC    AL1(0)
@NM00191 DC    AL1(76)
@NM00192 DC    AL1(20)
@NM00193 DC    AL1(3)
@NM00194 DC    AL1(0)
@NM00195 DC    AL1(85)
@NM00196 DC    AL1(0)
         ORG   GP4S21+17
         DS    CL3
GP4S21A  DS    CL33
         ORG   GP4S21A
@NM00197 DC    AL1(20)
@NM00198 DC    AL1(3)
@NM00199 DC    AL1(0)
@NM00200 DC    AL1(15)
@NM00201 DC    AL1(20)
@NM00202 DC    AL1(3)
@NM00203 DC    AL1(0)
@NM00204 DC    AL1(24)
@NM00205 DC    AL1(20)
@NM00206 DC    AL1(3)
@NM00207 DC    AL1(0)
@NM00208 DC    AL1(33)
@NM00209 DC    AL1(20)
@NM00210 DC    AL1(3)
@NM00211 DC    AL1(0)
@NM00212 DC    AL1(42)
@NM00213 DC    AL1(20)
@NM00214 DC    AL1(3)
@NM00215 DC    AL1(0)
@NM00216 DC    AL1(51)
@NM00217 DC    AL1(20)
@NM00218 DC    AL1(3)
@NM00219 DC    AL1(0)
@NM00220 DC    AL1(60)
@NM00221 DC    AL1(20)
@NM00222 DC    AL1(3)
@NM00223 DC    AL1(0)
@NM00224 DC    AL1(69)
@NM00225 DC    AL1(20)
@NM00226 DC    AL1(3)
@NM00227 DC    AL1(0)
@NM00228 DC    AL1(78)
@NM00229 DC    AL1(0)
         ORG   GP4S21A+33
         DS    CL3
GP4S25   DS    CL13
         ORG   GP4S25
@NM00230 DC    AL1(21)
@NM00231 DC    AL1(99)
@NM00232 DC    AL1(52)
@NM00233 DC    AL1(61)
@NM00234 DC    AL1(20)
@NM00235 DC    AL1(3)
@NM00236 DC    AL1(0)
@NM00237 DC    AL1(70)
@NM00238 DC    AL1(21)
@NM00239 DC    AL1(129)
@NM00240 DC    AL1(80)
@NM00241 DC    AL1(90)
@NM00242 DC    AL1(0)
         ORG   GP4S25+13
         DS    CL3
GP4S26A  DS    CL21
         ORG   GP4S26A
@NM00243 DC    AL1(21)
@NM00244 DC    AL1(67)
@NM00245 DC    AL1(52)
@NM00246 DC    AL1(58)
@NM00247 DC    AL1(20)
@NM00248 DC    AL1(3)
@NM00249 DC    AL1(0)
@NM00250 DC    AL1(67)
@NM00251 DC    AL1(20)
@NM00252 DC    AL1(3)
@NM00253 DC    AL1(0)
@NM00254 DC    AL1(76)
@NM00255 DC    AL1(20)
@NM00256 DC    AL1(3)
@NM00257 DC    AL1(0)
@NM00258 DC    AL1(85)
@NM00259 DC    AL1(20)
@NM00260 DC    AL1(3)
@NM00261 DC    AL1(0)
@NM00262 DC    AL1(94)
@NM00263 DC    AL1(0)
         ORG   GP4S26A+21
         DS    CL3
GP4S26B  DS    CL13
         ORG   GP4S26B
@NM00264 DC    AL1(53)
@NM00265 DC    AL1(95)
@NM00266 DC    AL1(10)
@NM00267 DC    AL1(18)
@NM00268 DC    AL1(52)
@NM00269 DC    AL1(15)
@NM00270 DC    AL1(0)
@NM00271 DC    AL1(34)
@NM00272 DC    AL1(52)
@NM00273 DC    AL1(11)
@NM00274 DC    AL1(0)
@NM00275 DC    AL1(50)
@NM00276 DC    AL1(0)
         ORG   GP4S26B+13
         DS    CL3
GP4S26C  DS    CL41
         ORG   GP4S26C
@NM00277 DC    AL1(21)
@NM00278 DC    AL1(83)
@NM00279 DC    AL1(10)
@NM00280 DC    AL1(17)
@NM00281 DC    AL1(20)
@NM00282 DC    AL1(3)
@NM00283 DC    AL1(0)
@NM00284 DC    AL1(26)
@NM00285 DC    AL1(20)
@NM00286 DC    AL1(3)
@NM00287 DC    AL1(0)
@NM00288 DC    AL1(35)
@NM00289 DC    AL1(20)
@NM00290 DC    AL1(3)
@NM00291 DC    AL1(0)
@NM00292 DC    AL1(44)
@NM00293 DC    AL1(20)
@NM00294 DC    AL1(3)
@NM00295 DC    AL1(0)
@NM00296 DC    AL1(53)
@NM00297 DC    AL1(20)
@NM00298 DC    AL1(3)
@NM00299 DC    AL1(0)
@NM00300 DC    AL1(62)
@NM00301 DC    AL1(20)
@NM00302 DC    AL1(3)
@NM00303 DC    AL1(0)
@NM00304 DC    AL1(71)
@NM00305 DC    AL1(20)
@NM00306 DC    AL1(3)
@NM00307 DC    AL1(0)
@NM00308 DC    AL1(80)
@NM00309 DC    AL1(20)
@NM00310 DC    AL1(3)
@NM00311 DC    AL1(0)
@NM00312 DC    AL1(89)
@NM00313 DC    AL1(20)
@NM00314 DC    AL1(3)
@NM00315 DC    AL1(0)
@NM00316 DC    AL1(98)
@NM00317 DC    AL1(0)
         ORG   GP4S26C+41
         DS    CL3
GP4S26D  DS    CL5
         ORG   GP4S26D
@NM00318 DC    AL1(17)
@NM00319 DC    AL1(144)
@NM00320 DC    AL1(10)
@NM00321 DC    AL1(0)
@NM00322 DC    AL1(0)
         ORG   GP4S26D+5
         DS    CL3
GP4S27A  DS    CL21
         ORG   GP4S27A
@NM00323 DC    AL1(21)
@NM00324 DC    AL1(67)
@NM00325 DC    AL1(52)
@NM00326 DC    AL1(58)
@NM00327 DC    AL1(20)
@NM00328 DC    AL1(3)
@NM00329 DC    AL1(0)
@NM00330 DC    AL1(67)
@NM00331 DC    AL1(20)
@NM00332 DC    AL1(3)
@NM00333 DC    AL1(0)
@NM00334 DC    AL1(76)
@NM00335 DC    AL1(20)
@NM00336 DC    AL1(3)
@NM00337 DC    AL1(0)
@NM00338 DC    AL1(85)
@NM00339 DC    AL1(53)
@NM00340 DC    AL1(101)
@NM00341 DC    AL1(95)
@NM00342 DC    AL1(103)
@NM00343 DC    AL1(0)
         ORG   GP4S27A+21
         DS    CL3
GP4S27B  DS    CL13
         ORG   GP4S27B
@NM00344 DC    AL1(53)
@NM00345 DC    AL1(111)
@NM00346 DC    AL1(10)
@NM00347 DC    AL1(18)
@NM00348 DC    AL1(52)
@NM00349 DC    AL1(15)
@NM00350 DC    AL1(0)
@NM00351 DC    AL1(34)
@NM00352 DC    AL1(52)
@NM00353 DC    AL1(11)
@NM00354 DC    AL1(0)
@NM00355 DC    AL1(50)
@NM00356 DC    AL1(0)
         ORG   GP4S27B+13
         DS    CL3
GP4S28   DS    CL5
         ORG   GP4S28
@NM00357 DC    AL1(21)
@NM00358 DC    AL1(35)
@NM00359 DC    AL1(52)
@NM00360 DC    AL1(56)
@NM00361 DC    AL1(0)
         ORG   GP4S28+5
         DS    CL3
GP4S30A  DS    CL17
         ORG   GP4S30A
@NM00362 DC    AL1(21)
@NM00363 DC    AL1(67)
@NM00364 DC    AL1(52)
@NM00365 DC    AL1(58)
@NM00366 DC    AL1(20)
@NM00367 DC    AL1(3)
@NM00368 DC    AL1(0)
@NM00369 DC    AL1(67)
@NM00370 DC    AL1(20)
@NM00371 DC    AL1(3)
@NM00372 DC    AL1(0)
@NM00373 DC    AL1(76)
@NM00374 DC    AL1(20)
@NM00375 DC    AL1(3)
@NM00376 DC    AL1(0)
@NM00377 DC    AL1(85)
@NM00378 DC    AL1(0)
         ORG   GP4S30A+17
         DS    CL3
GP4S30B  DS    CL13
         ORG   GP4S30B
@NM00379 DC    AL1(53)
@NM00380 DC    AL1(111)
@NM00381 DC    AL1(10)
@NM00382 DC    AL1(18)
@NM00383 DC    AL1(52)
@NM00384 DC    AL1(15)
@NM00385 DC    AL1(0)
@NM00386 DC    AL1(34)
@NM00387 DC    AL1(52)
@NM00388 DC    AL1(11)
@NM00389 DC    AL1(0)
@NM00390 DC    AL1(50)
@NM00391 DC    AL1(0)
         ORG   GP4S30B+13
         DS    CL3
GP4S30C  DS    CL13
         ORG   GP4S30C
@NM00392 DC    AL1(53)
@NM00393 DC    AL1(111)
@NM00394 DC    AL1(64)
@NM00395 DC    AL1(72)
@NM00396 DC    AL1(52)
@NM00397 DC    AL1(15)
@NM00398 DC    AL1(0)
@NM00399 DC    AL1(88)
@NM00400 DC    AL1(52)
@NM00401 DC    AL1(11)
@NM00402 DC    AL1(0)
@NM00403 DC    AL1(104)
@NM00404 DC    AL1(0)
         ORG   GP4S30C+13
         DS    CL3
GP4S32   DS    CL21
         ORG   GP4S32
@NM00405 DC    AL1(21)
@NM00406 DC    AL1(33)
@NM00407 DC    AL1(52)
@NM00408 DC    AL1(58)
@NM00409 DC    AL1(20)
@NM00410 DC    AL1(0)
@NM00411 DC    AL1(0)
@NM00412 DC    AL1(64)
@NM00413 DC    AL1(53)
@NM00414 DC    AL1(47)
@NM00415 DC    AL1(64)
@NM00416 DC    AL1(68)
@NM00417 DC    AL1(52)
@NM00418 DC    AL1(15)
@NM00419 DC    AL1(0)
@NM00420 DC    AL1(84)
@NM00421 DC    AL1(52)
@NM00422 DC    AL1(11)
@NM00423 DC    AL1(0)
@NM00424 DC    AL1(100)
@NM00425 DC    AL1(0)
         ORG   GP4S32+21
         DS    CL3
GP4S41   DS    CL5
         ORG   GP4S41
@NM00426 DC    AL1(53)
@NM00427 DC    AL1(55)
@NM00428 DC    AL1(52)
@NM00429 DC    AL1(57)
@NM00430 DC    AL1(0)
         ORG   GP4S41+5
         DS    CL3
GP4S42A  DS    CL37
         ORG   GP4S42A
@NM00431 DC    AL1(21)
@NM00432 DC    AL1(131)
@NM00433 DC    AL1(10)
@NM00434 DC    AL1(21)
@NM00435 DC    AL1(20)
@NM00436 DC    AL1(3)
@NM00437 DC    AL1(0)
@NM00438 DC    AL1(30)
@NM00439 DC    AL1(20)
@NM00440 DC    AL1(3)
@NM00441 DC    AL1(0)
@NM00442 DC    AL1(39)
@NM00443 DC    AL1(20)
@NM00444 DC    AL1(3)
@NM00445 DC    AL1(0)
@NM00446 DC    AL1(48)
@NM00447 DC    AL1(20)
@NM00448 DC    AL1(3)
@NM00449 DC    AL1(0)
@NM00450 DC    AL1(57)
@NM00451 DC    AL1(20)
@NM00452 DC    AL1(3)
@NM00453 DC    AL1(0)
@NM00454 DC    AL1(66)
@NM00455 DC    AL1(20)
@NM00456 DC    AL1(3)
@NM00457 DC    AL1(0)
@NM00458 DC    AL1(75)
@NM00459 DC    AL1(20)
@NM00460 DC    AL1(3)
@NM00461 DC    AL1(0)
@NM00462 DC    AL1(84)
@NM00463 DC    AL1(20)
@NM00464 DC    AL1(3)
@NM00465 DC    AL1(0)
@NM00466 DC    AL1(93)
@NM00467 DC    AL1(0)
         ORG   GP4S42A+37
         DS    CL3
GP4S42B  DS    CL25
         ORG   GP4S42B
@NM00468 DC    AL1(20)
@NM00469 DC    AL1(3)
@NM00470 DC    AL1(0)
@NM00471 DC    AL1(21)
@NM00472 DC    AL1(20)
@NM00473 DC    AL1(3)
@NM00474 DC    AL1(0)
@NM00475 DC    AL1(30)
@NM00476 DC    AL1(20)
@NM00477 DC    AL1(3)
@NM00478 DC    AL1(0)
@NM00479 DC    AL1(39)
@NM00480 DC    AL1(20)
@NM00481 DC    AL1(3)
@NM00482 DC    AL1(0)
@NM00483 DC    AL1(48)
@NM00484 DC    AL1(20)
@NM00485 DC    AL1(3)
@NM00486 DC    AL1(0)
@NM00487 DC    AL1(57)
@NM00488 DC    AL1(20)
@NM00489 DC    AL1(3)
@NM00490 DC    AL1(0)
@NM00491 DC    AL1(66)
@NM00492 DC    AL1(0)
         ORG   GP4S42B+25
         DS    CL3
GP4S42C  DS    CL41
         ORG   GP4S42C
@NM00493 DC    AL1(21)
@NM00494 DC    AL1(147)
@NM00495 DC    AL1(10)
@NM00496 DC    AL1(21)
@NM00497 DC    AL1(20)
@NM00498 DC    AL1(3)
@NM00499 DC    AL1(0)
@NM00500 DC    AL1(30)
@NM00501 DC    AL1(20)
@NM00502 DC    AL1(3)
@NM00503 DC    AL1(0)
@NM00504 DC    AL1(39)
@NM00505 DC    AL1(20)
@NM00506 DC    AL1(3)
@NM00507 DC    AL1(0)
@NM00508 DC    AL1(48)
@NM00509 DC    AL1(20)
@NM00510 DC    AL1(3)
@NM00511 DC    AL1(0)
@NM00512 DC    AL1(57)
@NM00513 DC    AL1(20)
@NM00514 DC    AL1(3)
@NM00515 DC    AL1(0)
@NM00516 DC    AL1(66)
@NM00517 DC    AL1(20)
@NM00518 DC    AL1(3)
@NM00519 DC    AL1(0)
@NM00520 DC    AL1(75)
@NM00521 DC    AL1(20)
@NM00522 DC    AL1(3)
@NM00523 DC    AL1(0)
@NM00524 DC    AL1(84)
@NM00525 DC    AL1(20)
@NM00526 DC    AL1(3)
@NM00527 DC    AL1(0)
@NM00528 DC    AL1(93)
@NM00529 DC    AL1(20)
@NM00530 DC    AL1(3)
@NM00531 DC    AL1(0)
@NM00532 DC    AL1(102)
@NM00533 DC    AL1(0)
         ORG   GP4S42C+41
         DS    CL3
GP4S42D  DS    CL5
         ORG   GP4S42D
@NM00534 DC    AL1(17)
@NM00535 DC    AL1(208)
@NM00536 DC    AL1(10)
@NM00537 DC    AL1(0)
@NM00538 DC    AL1(0)
         ORG   GP4S42D+5
         DS    CL3
GP4S44   DS    CL5
         ORG   GP4S44
@NM00539 DC    AL1(21)
@NM00540 DC    AL1(131)
@NM00541 DC    AL1(52)
@NM00542 DC    AL1(62)
@NM00543 DC    AL1(0)
         ORG   GP4S44+5
         DS    CL3
GP4S48A  DS    CL21
         ORG   GP4S48A
@NM00544 DC    AL1(53)
@NM00545 DC    AL1(71)
@NM00546 DC    AL1(52)
@NM00547 DC    AL1(58)
@NM00548 DC    AL1(20)
@NM00549 DC    AL1(0)
@NM00550 DC    AL1(0)
@NM00551 DC    AL1(68)
@NM00552 DC    AL1(53)
@NM00553 DC    AL1(79)
@NM00554 DC    AL1(68)
@NM00555 DC    AL1(74)
@NM00556 DC    AL1(52)
@NM00557 DC    AL1(15)
@NM00558 DC    AL1(0)
@NM00559 DC    AL1(90)
@NM00560 DC    AL1(52)
@NM00561 DC    AL1(11)
@NM00562 DC    AL1(0)
@NM00563 DC    AL1(106)
@NM00564 DC    AL1(0)
         ORG   GP4S48A+21
         DS    CL3
GP4S48B  DS    CL21
         ORG   GP4S48B
@NM00565 DC    AL1(21)
@NM00566 DC    AL1(67)
@NM00567 DC    AL1(10)
@NM00568 DC    AL1(16)
@NM00569 DC    AL1(20)
@NM00570 DC    AL1(3)
@NM00571 DC    AL1(0)
@NM00572 DC    AL1(25)
@NM00573 DC    AL1(20)
@NM00574 DC    AL1(3)
@NM00575 DC    AL1(0)
@NM00576 DC    AL1(34)
@NM00577 DC    AL1(20)
@NM00578 DC    AL1(3)
@NM00579 DC    AL1(0)
@NM00580 DC    AL1(43)
@NM00581 DC    AL1(20)
@NM00582 DC    AL1(3)
@NM00583 DC    AL1(0)
@NM00584 DC    AL1(52)
@NM00585 DC    AL1(0)
         ORG   GP4S48B+21
         DS    CL3
GP4S52A  DS    CL45
         ORG   GP4S52A
@NM00586 DC    AL1(21)
@NM00587 DC    AL1(67)
@NM00588 DC    AL1(10)
@NM00589 DC    AL1(16)
@NM00590 DC    AL1(20)
@NM00591 DC    AL1(3)
@NM00592 DC    AL1(0)
@NM00593 DC    AL1(25)
@NM00594 DC    AL1(20)
@NM00595 DC    AL1(3)
@NM00596 DC    AL1(0)
@NM00597 DC    AL1(34)
@NM00598 DC    AL1(20)
@NM00599 DC    AL1(3)
@NM00600 DC    AL1(0)
@NM00601 DC    AL1(43)
@NM00602 DC    AL1(20)
@NM00603 DC    AL1(3)
@NM00604 DC    AL1(0)
@NM00605 DC    AL1(52)
@NM00606 DC    AL1(20)
@NM00607 DC    AL1(3)
@NM00608 DC    AL1(0)
@NM00609 DC    AL1(61)
@NM00610 DC    AL1(20)
@NM00611 DC    AL1(3)
@NM00612 DC    AL1(0)
@NM00613 DC    AL1(70)
@NM00614 DC    AL1(20)
@NM00615 DC    AL1(3)
@NM00616 DC    AL1(0)
@NM00617 DC    AL1(79)
@NM00618 DC    AL1(20)
@NM00619 DC    AL1(3)
@NM00620 DC    AL1(0)
@NM00621 DC    AL1(88)
@NM00622 DC    AL1(20)
@NM00623 DC    AL1(3)
@NM00624 DC    AL1(0)
@NM00625 DC    AL1(97)
@NM00626 DC    AL1(20)
@NM00627 DC    AL1(3)
@NM00628 DC    AL1(0)
@NM00629 DC    AL1(106)
@NM00630 DC    AL1(0)
         ORG   GP4S52A+45
         DS    CL3
GP4S52B  DS    CL9
         ORG   GP4S52B
@NM00631 DC    AL1(20)
@NM00632 DC    AL1(3)
@NM00633 DC    AL1(0)
@NM00634 DC    AL1(16)
@NM00635 DC    AL1(20)
@NM00636 DC    AL1(3)
@NM00637 DC    AL1(0)
@NM00638 DC    AL1(25)
@NM00639 DC    AL1(0)
         ORG   GP4S52B+9
         DS    CL3
GP4S52C  DS    CL17
         ORG   GP4S52C
@NM00640 DC    AL1(53)
@NM00641 DC    AL1(79)
@NM00642 DC    AL1(10)
@NM00643 DC    AL1(16)
@NM00644 DC    AL1(52)
@NM00645 DC    AL1(15)
@NM00646 DC    AL1(0)
@NM00647 DC    AL1(33)
@NM00648 DC    AL1(52)
@NM00649 DC    AL1(15)
@NM00650 DC    AL1(0)
@NM00651 DC    AL1(50)
@NM00652 DC    AL1(52)
@NM00653 DC    AL1(3)
@NM00654 DC    AL1(0)
@NM00655 DC    AL1(67)
@NM00656 DC    AL1(0)
         ORG   GP4S52C+17
         DS    CL3
GP4S66   DS    CL17
         ORG   GP4S66
@NM00657 DC    AL1(21)
@NM00658 DC    AL1(115)
@NM00659 DC    AL1(52)
@NM00660 DC    AL1(61)
@NM00661 DC    AL1(20)
@NM00662 DC    AL1(3)
@NM00663 DC    AL1(0)
@NM00664 DC    AL1(70)
@NM00665 DC    AL1(20)
@NM00666 DC    AL1(3)
@NM00667 DC    AL1(0)
@NM00668 DC    AL1(79)
@NM00669 DC    AL1(20)
@NM00670 DC    AL1(3)
@NM00671 DC    AL1(0)
@NM00672 DC    AL1(88)
@NM00673 DC    AL1(0)
         ORG   GP4S66+17
         DS    CL3
GP4S75A  DS    CL13
         ORG   GP4S75A
@NM00674 DC    AL1(21)
@NM00675 DC    AL1(35)
@NM00676 DC    AL1(52)
@NM00677 DC    AL1(57)
@NM00678 DC    AL1(20)
@NM00679 DC    AL1(3)
@NM00680 DC    AL1(0)
@NM00681 DC    AL1(66)
@NM00682 DC    AL1(20)
@NM00683 DC    AL1(3)
@NM00684 DC    AL1(0)
@NM00685 DC    AL1(75)
@NM00686 DC    AL1(0)
         ORG   GP4S75A+13
         DS    CL3
GP4S75B  DS    CL5
         ORG   GP4S75B
@NM00687 DC    AL1(17)
@NM00688 DC    AL1(96)
@NM00689 DC    AL1(52)
@NM00690 DC    AL1(0)
@NM00691 DC    AL1(0)
         ORG   GP4S75B+5
         DS    CL3
GP4S82A  DS    CL5
         ORG   GP4S82A
@NM00692 DC    AL1(53)
@NM00693 DC    AL1(101)
@NM00694 DC    AL1(52)
@NM00695 DC    AL1(61)
@NM00696 DC    AL1(0)
         ORG   GP4S82A+5
         DS    CL3
GP4S82B  DS    CL9
         ORG   GP4S82B
@NM00697 DC    AL1(21)
@NM00698 DC    AL1(37)
@NM00699 DC    AL1(54)
@NM00700 DC    AL1(58)
@NM00701 DC    AL1(20)
@NM00702 DC    AL1(1)
@NM00703 DC    AL1(0)
@NM00704 DC    AL1(70)
@NM00705 DC    AL1(0)
         ORG   GP4S82B+9
         DS    CL3
GP4S82C  DS    CL5
         ORG   GP4S82C
@NM00706 DC    AL1(17)
@NM00707 DC    AL1(96)
@NM00708 DC    AL1(54)
@NM00709 DC    AL1(0)
@NM00710 DC    AL1(0)
         ORG   GP4S82C+5
         DS    CL3
GP4S86   DS    CL13
         ORG   GP4S86
@NM00711 DC    AL1(21)
@NM00712 DC    AL1(67)
@NM00713 DC    AL1(52)
@NM00714 DC    AL1(58)
@NM00715 DC    AL1(20)
@NM00716 DC    AL1(3)
@NM00717 DC    AL1(0)
@NM00718 DC    AL1(67)
@NM00719 DC    AL1(21)
@NM00720 DC    AL1(36)
@NM00721 DC    AL1(77)
@NM00722 DC    AL1(82)
@NM00723 DC    AL1(0)
         ORG   GP4S86+13
         DS    CL3
GP4S88   DS    CL13
         ORG   GP4S88
@NM00724 DC    AL1(21)
@NM00725 DC    AL1(35)
@NM00726 DC    AL1(52)
@NM00727 DC    AL1(57)
@NM00728 DC    AL1(21)
@NM00729 DC    AL1(80)
@NM00730 DC    AL1(67)
@NM00731 DC    AL1(74)
@NM00732 DC    AL1(21)
@NM00733 DC    AL1(80)
@NM00734 DC    AL1(78)
@NM00735 DC    AL1(85)
@NM00736 DC    AL1(0)
         ORG   GP4S88+13
         DS    CL3
GP4S98   DS    CL21
         ORG   GP4S98
@NM00737 DC    AL1(21)
@NM00738 DC    AL1(67)
@NM00739 DC    AL1(52)
@NM00740 DC    AL1(58)
@NM00741 DC    AL1(20)
@NM00742 DC    AL1(0)
@NM00743 DC    AL1(0)
@NM00744 DC    AL1(68)
@NM00745 DC    AL1(53)
@NM00746 DC    AL1(47)
@NM00747 DC    AL1(68)
@NM00748 DC    AL1(72)
@NM00749 DC    AL1(52)
@NM00750 DC    AL1(15)
@NM00751 DC    AL1(0)
@NM00752 DC    AL1(88)
@NM00753 DC    AL1(52)
@NM00754 DC    AL1(11)
@NM00755 DC    AL1(0)
@NM00756 DC    AL1(104)
@NM00757 DC    AL1(0)
         ORG   GP4S98+21
         DS    CL1
HEXTEST  DC    H'128'
         DC    H'64'
         DC    H'32'
         DC    H'16'
         DC    H'8'
         DC    H'4'
         DC    H'2'
         DC    H'1'
         DS    CL2
PATCH    DC    30F'0'
CP0001@  DC    AL4(S00)
         DC    AL4(GP2)
         DC    AL4(GP2)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(GP2)
         DC    AL4(S06)
         DC    AL4(S06)
         DC    AL4(S08)
         DC    AL4(S08)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(S13)
         DC    AL4(S14)
         DC    AL4(S15)
         DC    AL4(S16)
         DC    AL4(GP2)
         DC    AL4(GP2)
         DC    AL4(GP2)
         DC    AL4(GP2)
         DC    AL4(S21)
         DC    AL4(GP2)
         DC    AL4(GP2)
         DC    AL4(GP3)
         DC    AL4(S25)
         DC    AL4(S26)
         DC    AL4(S27)
         DC    AL4(S13)
         DC    AL4(S29)
         DC    AL4(S30)
         DC    AL4(GP3)
         DC    AL4(S32)
         DC    AL4(S32)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(GP2)
         DC    AL4(S08)
         DC    AL4(S42)
         DC    AL4(G1)
         DC    AL4(S44)
         DC    AL4(GP2)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(S48)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(S52)
         DC    AL4(GP3)
         DC    AL4(S00)
         DC    AL4(GP3)
         DC    AL4(S48)
         DC    AL4(GP3)
         DC    AL4(GP3)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(G1)
         DC    AL4(S44)
         DC    AL4(GP2)
         DC    AL4(GP2)
         DC    AL4(G1)
         DC    AL4(S66)
         DC    AL4(G1)
         DC    AL4(S13)
         DC    AL4(GP3)
         DC    AL4(GP2)
         DC    AL4(S71)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(GP2)
         DC    AL4(S75)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(S32)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(S71)
         DC    AL4(S82)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(S86)
         DC    AL4(GP2)
         DC    AL4(S88)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(S00)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(G1)
         DC    AL4(S98)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(GP2)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(S00)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
         DC    AL4(G1)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MOD      EQU   @07
K        EQU   @04
J        EQU   @07
I        EQU   @04
CNVTSVC  EQU   @04
SVCNUMBR EQU   @07
PLISTPTR EQU   @06
AEDITCBR EQU   @09
R0       EQU   @00
R1       EQU   @01
R9       EQU   @09
R10      EQU   @10
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
RETCODE  EQU   @15
R11      EQU   @11
R12      EQU   @12
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
AMDPRTAB EQU   0
DEBGFLGS EQU   AMDPRTAB+8
PTHFLGS1 EQU   DEBGFLGS
PTHFLGS2 EQU   DEBGFLGS+1
INRFCFGS EQU   DEBGFLGS+2
IOFLGS   EQU   DEBGFLGS+3
STARTIME EQU   AMDPRTAB+40
STOPTIME EQU   AMDPRTAB+52
NAMES    EQU   AMDPRTAB+64
ADS      EQU   AMDPRTAB+104
AADS     EQU   ADS
SIF      EQU   AMDPRTAB+124
SIOFLGS  EQU   SIF
DVADS1   EQU   AMDPRTAB+128
IO       EQU   AMDPRTAB+228
IOFLGS2  EQU   IO
DVADS2   EQU   AMDPRTAB+232
VCF      EQU   AMDPRTAB+332
SVCFLGS  EQU   VCF
ALLV     EQU   SVCFLGS
SVCNUMS  EQU   AMDPRTAB+336
USR      EQU   AMDPRTAB+368
USRFLGS  EQU   USR
USRTAB   EQU   AMDPRTAB+372
PI       EQU   AMDPRTAB+452
PIFLGS   EQU   PI
PGMNGEN  EQU   AMDPRTAB+456
GENFLAGS EQU   PGMNGEN+3
GENFLGS1 EQU   AMDPRTAB+460
ESTARTME EQU   AMDPRTAB+500
ESTOPTME EQU   AMDPRTAB+509
ABDPL    EQU   0
ADPLFLAG EQU   ABDPL+7
ADPLFMT1 EQU   ABDPL+44
ADPLFMT2 EQU   ABDPL+48
PLIST    EQU   0
RECPTR   EQU   PLIST
DATAPTR  EQU   PLIST+16
FMTADDR  EQU   PLIST+20
DYNAMSTG EQU   PLIST+24
SNAPPARM EQU   PLIST+28
NXTFIELD EQU   0
AMDPRFMT EQU   0
BASICRCD EQU   0
ASCBFLD  EQU   BASICRCD
ERRECORD EQU   ASCBFLD
PSWFLD   EQU   BASICRCD+14
SYSSVC   EQU   PSWFLD+3
R15FLD   EQU   BASICRCD+34
LSVC81R  EQU   0
GRP2RCD  EQU   0
GRP2LNTH EQU   GRP2RCD
GRP3RCD  EQU   0
GRP3DDN  EQU   GRP3RCD
GP4RCD0  EQU   0
RCD0DDN  EQU   GP4RCD0
RCD0DCB  EQU   GP4RCD0+8
RCD0DEB  EQU   GP4RCD0+12
GP4RCD6  EQU   0
EPDENM1  EQU   GP4RCD6
RCD6LST  EQU   GP4RCD6+8
GP4RCD8  EQU   0
EPDENM2  EQU   GP4RCD8
GP4RCD13 EQU   0
COMPCODE EQU   GP4RCD13
GP4RCD14 EQU   0
PICA     EQU   GP4RCD14
GP4RCD15 EQU   0
RCD15DDN EQU   GP4RCD15
ERRFLGS  EQU   GP4RCD15+8
RCD15TCB EQU   GP4RCD15+9
RCD15CUU EQU   GP4RCD15+13
GP4RCD16 EQU   0
RCD16DDN EQU   GP4RCD16
RCD16DCB EQU   GP4RCD16+8
PPL      EQU   GP4RCD16+12
GP4RCD21 EQU   0
RCD21DDN EQU   GP4RCD21
RCD21LN  EQU   GP4RCD21+8
GP4RCD25 EQU   0
RCD25DDN EQU   GP4RCD25
DCBFDAD  EQU   GP4RCD25+8
GP4RCD26 EQU   0
RCD26LN  EQU   GP4RCD26
GP4RCD27 EQU   0
RCD27LST EQU   GP4RCD27
RCD27LN  EQU   GP4RCD27+22
GP4RCD29 EQU   0
RCD29LST EQU   GP4RCD29
RCD29LN  EQU   GP4RCD29+16
GP4RCD30 EQU   0
RCD30LST EQU   GP4RCD30
RCD30LN  EQU   GP4RCD30+16
GP4RCD32 EQU   0
RCD32CUU EQU   GP4RCD32
RCD32LN  EQU   GP4RCD32+2
GP4RCD42 EQU   0
RCD42LN  EQU   GP4RCD42
GP4RCD44 EQU   0
TCBADDR  EQU   GP4RCD44
GP4RCD48 EQU   0
RCD48LST EQU   GP4RCD48
MAJORNM  EQU   GP4RCD48+20
RCD48LN  EQU   GP4RCD48+28
GP4RCD52 EQU   0
RCD52LST EQU   GP4RCD52
ERRCHECK EQU   RCD52LST
GP4RCD66 EQU   0
IOBERR   EQU   GP4RCD66
GP4RCD71 EQU   0
RCD71DDN EQU   GP4RCD71
RCD71LST EQU   GP4RCD71+8
RCD81LNG EQU   GP4RCD71+24
GP4RCD75 EQU   0
RCD75LN  EQU   GP4RCD75
GP4RCD82 EQU   0
VOLSER1  EQU   GP4RCD82
RCD82LN  EQU   GP4RCD82+6
GP4RCD86 EQU   0
RCD86LST EQU   GP4RCD86
TTR      EQU   GP4RCD86+8
GP4RCD88 EQU   0
RCD88DEB EQU   GP4RCD88
DSSTAT   EQU   GP4RCD88+4
DEVMOD   EQU   GP4RCD88+5
GP4RCD98 EQU   0
RCD98LST EQU   GP4RCD98
RCD98LN  EQU   GP4RCD98+4
CL0001@  EQU   0
ABDPLPTR EQU   SNAPPARM
SVCLIST  EQU   SVCNUMS
PTRNMAPS EQU   DYNAMPTN
OLDFLG   EQU   PTRNMAPS
OLDLN    EQU   PTRNMAPS+1
UNPAKFRM EQU   PAKEDSVC
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00004 EQU   PTRNMAPS+3
@NM00003 EQU   PTRNMAPS+2
@NM00008 EQU   GP4RCD71+20
VOLSER   EQU   GP4RCD27+16
DCBTRKBC EQU   GP4RCD25+16
R1FLD    EQU   BASICRCD+42
R0FLD    EQU   BASICRCD+38
CDENMFLD EQU   BASICRCD+26
TCBFLD   EQU   BASICRCD+22
@NM00007 EQU   PSWFLD+4
@NM00006 EQU   PSWFLD
JOBNMFLD EQU   BASICRCD+6
CPUIDFLD EQU   BASICRCD+4
@NM00005 EQU   ASCBFLD+2
EIDPTR   EQU   PLIST+12
GTFOPTR  EQU   PLIST+8
BUFFER   EQU   PLIST+4
ADPLEXT  EQU   ABDPL+52
ADPLCOM4 EQU   ABDPL+40
ADPLCOM3 EQU   ABDPL+36
ADPLCOM2 EQU   ABDPL+32
ADPLCOM1 EQU   ABDPL+28
ADPLFRMT EQU   ABDPL+24
ADPLMEMA EQU   ABDPL+20
ADPLCVT  EQU   ABDPL+16
ADPLPRNT EQU   ABDPL+12
ADPLBUF  EQU   ABDPL+8
@NM00002 EQU   ADPLFLAG
ADPLSYTM EQU   ADPLFLAG
ADPLSNPR EQU   ADPLFLAG
ADPLSBPL EQU   ABDPL+6
ADPLASID EQU   ABDPL+4
ADPLTCB  EQU   ABDPL
RESERVED EQU   AMDPRTAB+522
CVTTZONE EQU   AMDPRTAB+518
ESPSEC   EQU   ESTOPTME+7
ESPMIN   EQU   ESTOPTME+5
ESPHR    EQU   ESTOPTME+3
ESPDAY   EQU   ESTOPTME
ESSEC    EQU   ESTARTME+7
ESMIN    EQU   ESTARTME+5
ESHR     EQU   ESTARTME+3
ESDAY    EQU   ESTARTME
ADTSBUF  EQU   AMDPRTAB+496
OFSTDATA EQU   AMDPRTAB+494
OFSTEID  EQU   AMDPRTAB+492
AFRMAD   EQU   AMDPRTAB+488
REENTWKA EQU   AMDPRTAB+484
PRFMTADD EQU   AMDPRTAB+480
AEIOCT   EQU   AMDPRTAB+476
EXITADDR EQU   AMDPRTAB+472
EXITNM   EQU   AMDPRTAB+464
RECDLL   EQU   AMDPRTAB+461
@NM00001 EQU   GENFLGS1
FIRSTHSW EQU   GENFLGS1
TSFOUND  EQU   GENFLGS1
EOFINPRO EQU   GENFLGS1
TS       EQU   GENFLGS1
EOF      EQU   GENFLAGS
RR       EQU   GENFLAGS
SRM      EQU   GENFLAGS
RNIO     EQU   GENFLAGS
SYSM     EQU   GENFLAGS
SYS      EQU   GENFLAGS
DSP      EQU   GENFLAGS
EXT      EQU   GENFLAGS
PICODEA  EQU   PGMNGEN+2
PICODES  EQU   PGMNGEN
Q        EQU   PI+1
P01R     EQU   PIFLGS
SELP     EQU   PIFLGS
ALLP     EQU   PIFLGS
USRNGTAB EQU   USRTAB
O        EQU   USR+1
N01R     EQU   USRFLGS
SELU     EQU   USRFLGS
ALLU     EQU   USRFLGS
M        EQU   VCF+1
L        EQU   SVCFLGS
SELV     EQU   SVCFLGS
IODVADS  EQU   DVADS2
K01RES   EQU   IO+1
JJ       EQU   IOFLGS2
SELI     EQU   IOFLGS2
ALLI     EQU   IOFLGS2
SIODVADS EQU   DVADS1
II       EQU   SIF+1
H        EQU   SIOFLGS
NOEQU    EQU   SIOFLGS
EQUIV    EQU   SIOFLGS
SELS     EQU   SIOFLGS
ALLS     EQU   SIOFLGS
ASCBADDR EQU   AADS
JOBNAMES EQU   NAMES
DAY2     EQU   STOPTIME+10
F        EQU   STOPTIME+8
TIME2    EQU   STOPTIME
DAY      EQU   STARTIME+10
D        EQU   STARTIME+8
TIME     EQU   STARTIME
DDNAME   EQU   AMDPRTAB+32
USEREXIT EQU   AMDPRTAB+24
GTFWDPTR EQU   AMDPRTAB+20
C        EQU   DEBGFLGS+4
B        EQU   IOFLGS
GETEOF   EQU   IOFLGS
DMDFMT   EQU   INRFCFGS
EDITSTOP EQU   INRFCFGS
EXTTRC   EQU   INRFCFGS
RET      EQU   INRFCFGS
FMT      EQU   INRFCFGS
SPIE     EQU   INRFCFGS
TERM     EQU   INRFCFGS
FLMODE   EQU   INRFCFGS
REMAIN   EQU   PTHFLGS2
APP      EQU   PTHFLGS2
REXT     EQU   PTHFLGS1
FRM      EQU   PTHFLGS1
FLT      EQU   PTHFLGS1
HEX      EQU   PTHFLGS1
CON      EQU   PTHFLGS1
GET      EQU   PTHFLGS1
SCN      EQU   PTHFLGS1
ROOT     EQU   PTHFLGS1
CURREC   EQU   AMDPRTAB+4
AFMG     EQU   AMDPRTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00173 EQU   @RC00158
@RC00215 EQU   CE0001@
@RC00221 EQU   CE0001@
@RC00262 EQU   CE0001@
@RC00274 EQU   CE0001@
@RC00297 EQU   CE0001@
@RC00318 EQU   CE0001@
@RC00338 EQU   CE0001@
@RC00360 EQU   CE0001@
@RC00375 EQU   CE0001@
@RC00400 EQU   CE0001@
@RC00427 EQU   CE0001@
@RC00455 EQU   CE0001@
@RF00509 EQU   @RC00507
@RC00513 EQU   @RC00507
@RC00480 EQU   CE0001@
@RC00483 EQU   CE0001@
@RC00503 EQU   CE0001@
@RF00599 EQU   @RC00597
@RC00603 EQU   @RC00597
@RC00576 EQU   CE0001@
@RC00579 EQU   CE0001@
@RF00653 EQU   @RC00651
@RC00657 EQU   @RC00651
@RC00627 EQU   CE0001@
@RC00630 EQU   CE0001@
@RC00648 EQU   CE0001@
@RF00741 EQU   @RC00739
@RC00745 EQU   @RC00739
@RF00768 EQU   @RC00766
@RC00772 EQU   @RC00766
@RC00716 EQU   CE0001@
@RC00719 EQU   CE0001@
@RC00736 EQU   CE0001@
@RF00842 EQU   @RC00840
@RC00846 EQU   @RC00840
@RC00831 EQU   CE0001@
@RT00917 EQU   FMTPLIST
@RC00950 EQU   @RC00948
@RC00955 EQU   @RC00948
@RC00870 EQU   CE0001@
@RC00873 EQU   CE0001@
@RC00909 EQU   CE0001@
@RC00978 EQU   CE0001@
@RF01003 EQU   @RC01001
@RC01007 EQU   @RC01001
@RC00995 EQU   CE0001@
@RC00998 EQU   CE0001@
@RC01047 EQU   CE0001@
@RC01050 EQU   CE0001@
@RC01079 EQU   CE0001@
@RF01082 EQU   CE0001@
@RC01102 EQU   CE0001@
@RC01111 EQU   CE0001@
@RC01140 EQU   CE0001@
@RC01162 EQU   CE0001@
@RC01165 EQU   CE0001@
@RC01216 EQU   CE0001@
@RC01236 EQU   CE0001@
@RC01265 EQU   @RC01263
@RF01272 EQU   @RC01263
@RC01276 EQU   @RC01263
@RC01255 EQU   CE0001@
@RC01053 EQU   @RC01050
@RC01125 EQU   @RC01111
@ENDDATA EQU   *
         END   AMDSYS01,(C'PLS1655',0603,76069)

         TITLE 'IFCETUL1 MODEL  145 MACHINE CHECK EDIT'
*                                  DSGEN MACRO     DSGEN MACRO
*                                  DSGEN MACRO     DSGEN MACRO
         SPACE 2
         MACRO
&NAME    DSGEN
.*       THIS  MACRO               GENERATES ONE DSECT WORD
.*       FORMATTED FOR             THE SUBJECT LOG RECORD
.*       EACH  OPERAND             HAS TWO SUB LISTS. THE
.*       FIRST IS                  THE NAME OF THE LOG ITEM
.*       WHILE THE                 SECOND IS THE # OF BITS TO
.*       ALLOCATE FOR              THIS ITEM. ITEMS MUST
.*       BE    DEFINED             CONTIGUOUSLY WITHOUT GAPS
.*       UNUSED BIT                GROUPS MUST BE GIVEN
.*       DUMMY NAMES.              THE NAMES PROVIDED FOR
.*       THE   LOG                 ITEMS MAY THEN BE USED IN
.*       THE   CONVERSION          MACRO INSTRUCTIONS.
         GBLC  &ITEM(2000)
         GBLA  &ITEMNBR,&BITS(2000),&SHIFT(2000)
         LCLB  &ONLY1,&CTIND
         LCLA  &START1,&START2,&END1,&END2
         LCLC  &SYMBOL,&EQUSYM
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT
         ACTR  100000
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' AND '&SYSLIST(&OP+1,4)' EQ '').ERR1
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3
&START1  SETA  &SYSLIST(&OP+1,3)   GET START COUNT OF 1
&START2  SETA  &SYSLIST(&OP+1,4)   GET FIRST END COUNT
         AGO   .SET2A              BRANCH AROUND
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'
         MEXIT
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X
               ).SET2                   TEST FOR NO SECOND
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3
&END1    SETA  &SYSLIST(&OP+1,5)   GET START COUNT OF 2
&END2    SETA  &SYSLIST(&OP+1,6)   GET END COUNT OF 2
         AGO   .LOOP
.SET2    ANOP
&ONLY1   SETB  1                   INDICATE ONLY ONE CONCATENATION
         AGO   .LOOP
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'
         MEXIT
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'
         MEXIT
.LOOP    ANOP
&OP      SETA  &OP+1
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE
&ITEMNBR SETA  &ITEMNBR+1
         AIF   ('&SYSLIST(&OP,2)'  NE '').OK1
         MNOTE '**NULL BIT COUNT FIELD**'
         MEXIT
.OK1     ANOP
&SYMBOL  SETC  '&SYSLIST(&OP,1)'
         AIF   ('&SYMBOL'          NE '').OK
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****
         AIF   ('&SYSLIST(&OP,3)'  NE 'EQU').CNT
         AGO   .START              GET NEXT
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT
         AIF   ('&SYSLIST(&OP,3)'  EQ 'EQU').EQU   TEST FOR EQU
         AIF   (&ONLY1).OK2        TEST FOR ONLY ONE CONCAT
&SYMBOL  SETC  '&SYMBOL.&START1.&END1' GET 1 AND 2 CONCAT
         AGO   .NO3                BRANCH AROUND
.OK2     ANOP
&SYMBOL  SETC  '&SYMBOL.&START1'   GET 1 CONCATENATED
.NO3     ANOP
&SYMBOL  EQU   *+&BYTE
&ITEM(&ITEMNBR) SETC '&SYMBOL'     GET LABEL IN GLOBAL
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8
.CNT     ANOP
&CTIND   SETB  1                   SET COUNT INDICATOR
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)
&BYTE    SETA  &COUNT/8
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT
         AIF   (&ONLY1).TSTST      TEST FOR ONLY ONE CONCAT
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END
&END1    SETA  &END1+1             INCREMENT COUNT
&OP      SETA  &OP-1               DECREMENT INCREMENT
         AGO   .LOOP               GENERATE NEXT
.TSTST   ANOP
         AIF   (&START1            EQ &START2).LPDONE   TEST FOR END
         AIF   (&ONLY1).NSET1      TEST FOR ONLY ONE CONCAT
&END1    SETA  &SYSLIST(&OP,5)     RE-INIT SECOND START COUNT
.NSET1   ANOP
&OP      SETA  &OP-1               DECREMENT INDEX
&START1  SETA  &START1+1           INCREMENT FIRST COUNT
         AGO   .LOOP               GO DO NEXT
.LPDONE  ANOP
&ONLY1   SETB  0                   CLEAR INDICATOR
         AGO   .START              GO TEST FOR MORE SUB-LISTS
.DONE    AIF   (&COUNT-&COUNT/8*8  NE 0).ERR  TEST FOR MULTIPLE OF 8
         AIF   (&CTIND             EQ 0).END        NO DS IF NO COUNT
&COUNT   SETA  &COUNT/8            GET NUMBER OF BYTES
&NAME    DS    &COUNT.C
.END     MEXIT
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'
         MEXIT
.EQU     AIF   ('&SYSLIST(&OP,4)'  NE '').EQU1     TEST FOR NULL LABEL
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'
         MEXIT
.EQU1    AIF   (&SYSLIST(&OP,2)    LT 16).EQU2  COUNT OVER FIFTEEN
*****               THE FOLLOWING STATEMENT                *****
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****
.EQU2    ANOP
&EQUCNT  SETA  0                   CLEAR COUNTER
&EQUSYM  SETC  '&SYSLIST(&OP,4)'   GET EQU OPERAND
.EQULOP  ANOP
&EQUCNT  SETA  &EQUCNT+1           INCREMENT INDEX
         AIF   ('&ITEM(&EQUCNT)'   EQ '&EQUSYM').EQUOUT  LABEL FOUND?
         AIF   (&EQUCNT            EQ &ITEMNBR).ERR4    ALL TESTED?
         AGO   .EQULOP             NO-GET NEXT
.EQUOUT  ANOP
&ITEM(&ITEMNBR) SETC '&SYMBOL'     GET LABEL NAME
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2) GET NUMBER OF BITS
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT) GET SHIFT COUNT
&SYMBOL  EQU   &EQUSYM             THIS SYMBOL EQUATED
         AGO   .START              RETURN FOR NEXT
         MEND
*
*
         MACRO
&NAME    LINE  &DATA,&LABEL,&SKIP=
.*       THIS  MACRO               ESTABLISHES THE MARGINS OR
.*       COLUMN SETTINGS           FOR EACH LINE. IT
.*       GENERATES NECESSARY       CARRIAGE CONTROL
.*       ENTRIES. LASTLY           IT DETERMINES THE
.*       NUMBER OF                 ENTRIES ASSOCIATED WITH
.*       THE   PREVIOUS            LINE AND STORES THAT #
.*       INTO  THE                 APPROPRIATE BYTE.
.*
.*       &DATA(1) -                CHARACTER POSITION TO
.*       BEGIN DATA.
.*
.*       &DATA(2) -                # OF SPACES BETWEEN
.*       SUCCESSIVE DATA           COLUMN STARTING
.*       CHARACTERS.
.*
.*       &LABEL(1) -               CHARACTER POSITION
.*       TO    BEGIN               LABELS.
.*
.*       &LABEL(2) -               # OF SPACES BETWEEN
.*       LINE'S LABEL              STARTING CHARACTERS.
.*
.*       &SKIP= -                  # OF LINES TO ADVANCE
.*       CARRIAGE TO               BEGIN NEXT PRINTED LINE.
.*
.*       NEW   ENTRIES             ARE GENERATED ONLY WHEN
.*       NECESSARY. OMISSION       OF ITEMS MEANS
.*       THEY  HAVE                NOT CHANGED SINCE PREVIOUS
.*       SETTINGS. A               LINE MACRO IS REQUIRED
.*       FOR   EACH                PRINTED LINE. IF NO SETTING
.*       CHANGES ARE               REQUIRED ALL OPERANDS
.*       ARE   OMITTED             IN WHICH CASE ONLY THE
.*       #     OF                  ENTRIES FOR THE PREVIOUS LINE
.*       IS    COMPUTED.           THIS MACRO MUST BE THE
.*       FIRST MACRO               INSTRUCTION ISSUED FOR
.*       THE   SUBJECT             LINE.
         GBLA  &DB,&DT,&LB,&LT,&NRENTS
         GBLA  &LASTCC,&INITIAL
         GBLC  &NRENTSX
         GBLC  &CARRCON
         GBLB  &TEST
         LCLA  &S
&NAME    DS    0C
         AIF   (&INITIAL EQ 0).FIRSTLN
         LINEND
         AGO   .NTFIRST
.FIRSTLN ANOP
&NRENTSX SETC  'N&SYSNDX'
&INITIAL SETA  1
N&SYSNDX EQU   *
.NTFIRST ANOP
         DC    AL1(0)
         AIF   ('&DATA(1)' EQ '').CKDTABS
         AIF   (&DATA(1) EQ &DB).CKDTABS
&DB      SETA  &DATA(1)
         AGO   .AA
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA
         AIF   (&DATA(2) EQ &DT).NCDATA
         AGO   .CC
.AA      AIF   ('&DATA(2)' EQ '').BB
         AIF   (&DATA(2) EQ &DT).BB
.CC      ANOP
&DT      SETA  &DATA(2)
.BB      DC    XL2'FFFE'
         DC    FL1'&DB'
         DC    FL1'&DT'
&NRENTS  SETA  &NRENTS+1
.NCDATA  ANOP
         AIF   ('&LABEL(1)' EQ '').CKLTABS
         AIF   (&LABEL(1) EQ &LB).CKLTABS
&LB      SETA  &LABEL(1)
         AGO   .AAA
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL
         AIF   (&LABEL(2) EQ &LT).NCLABEL
         AGO   .CCC
.AAA     AIF   ('&LABEL(2)' EQ '').BBB
         AIF   (&LABEL(2) EQ &LT).BBB
.CCC     ANOP
&LT      SETA  &LABEL(2)
.BBB     DC    XL2'FFFF'
         DC    FL1'&LB'
         DC    FL1'&LT'
&NRENTS  SETA  &NRENTS+1
.NCLABEL ANOP
         AIF   ('&SKIP' NE '').CONT
         AIF   (&TEST EQ 0).NOCHANG
&S       SETA  &LASTCC
         AGO   .DEFAULT
.CONT    ANOP
         AIF   (&TEST EQ 0).AB
&S       SETA  &SKIP
.DEFAULT ANOP
         ORG   &CARRCON+3
         DC    AL.3(0),AL.2(&S),AL.3(1)
         ORG
&LASTCC  SETA  &S
&TEST    SETB  0
         AGO   .DD
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG
A&SYSNDX DC    XL2'FFFB'
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)
         DC    FL1'9'
&LASTCC  SETA  &SKIP
&TEST    SETB  1
&CARRCON SETC  'A&SYSNDX'
&NRENTS  SETA  &NRENTS+1
.DD      ANOP
.NOCHANG ANOP
         MEND
*
*
***********************************************************************
*
*
         MACRO
         BIN   ,
.*       &SYSLIST(&OP,1) -         NAME OF LOG ITEM
.*       RECORD DSECT
.*       $SYSLIST(&OP,2) -         NBR OF SPACES
.*       TO    SKIP                ON MULTIPLE
.*       PRINT OR                  NBR OF SPACES
.*       TO    BACK                UP FROM COLUMN FOR
.*       START OF                  PRINTING. THE LETTER
.*       B     PRECEEDS            THE NUMBER (B5) IF
.*       THE   LATTER              IS DESIRED. OMISSION
.*       OF    THIS                OPERAND FORCES OPTION 2
.*       WITH  BACKUP              SPACING EQUAL TO
.*       THE   NUMBER              OF BITS IN THE ITEM
.*       DEFINITION (VIA           MACRO 'DSGEN').
.*       A     LIMIT               OF 15 BITS IS IMPOSED FOR THE
.*       TOTAL NUMBER              OF BITS TO PRINT.
         GBLA  &INITIAL
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN
         GBLC  &ITEM(2000),&DSECT
         GBLA  &BITS(2000),&ITEMNBR,&SHIFT(2000),&NRENTS
         LCLB  &B,&SUB
         LCLA  &IBITS,&NDX,&ISHIFT,&K
         LCLA  &TEMP,&T,&OP
         LCLC  &S
         ACTR  500000
         AIF   (&DIAGTST EQ 0).NOMSG
         AIF   (&INITIAL EQ 0).NOMSG
         AIF   (&DIAGLIN EQ 1).NOMSG
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****
*        LINE
         LINE
.NOMSG   ANOP
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP
&SUB     SETB  1
.LOOP    ANOP
&OP      SETA  &OP+1
.LOOP1   ANOP
&NDX     SETA  &NDX+1
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND
         AIF   (&NDX LT &ITEMNBR).LOOP1
         MNOTE '**LOG ITEM NOT DEFINED**'
         MEXIT
.FOUND   ANOP
&ISHIFT  SETA  &SHIFT(&NDX)
&IBITS   SETA  &BITS(&NDX)
         AIF   (&SUB EQ 1).SUB00
         AIF   ('&SYSLIST(3)' EQ '').SETT
&IBITS   SETA  &SYSLIST(3)
         AGO   .SETT
.SUB00   AIF   ('&SYSLIST(&OP,3)'  EQ '').SETT
&IBITS   SETA  &SYSLIST(&OP,3)
.SETT    ANOP
&T       SETA  &IBITS-1
&B       SETB  0
         AIF   (&IBITS GT 0 AND &IBITS LT 16).SUB0
         MNOTE '**NO. OF BITS OUTSIDE RANGE OF 1-15**'
         MEXIT
.SUB0    AIF   (&SUB EQ 1).SUBA
         AIF   ('&SYSLIST(2)' EQ '').BACKUP
&K       SETA  K'&SYSLIST(2)
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)
         AGO   .SUBB
.SUBA    ANOP
         AIF   ('&SYSLIST(&OP,2)'  EQ '').BACKUP
&K       SETA  K'&SYSLIST(&OP,2)
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)
.SUBB    ANOP
&T       SETA  &S
.BACKUP  ANOP
&NRENTS  SETA  &NRENTS+1
&TEMP    SETA  &ISHIFT
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'
         AGO   .OUT
.BIN2    AIF   (&SUB EQ 1).BIN2A
         AIF   ('&SYSLIST(2)' NE '').BIN3
         AGO   .BIN2B
.BIN2A   AIF   ('&SYSLIST(&OP,2)'  NE '').BIN3
.BIN2B   ANOP
&B       SETB  1
.BIN3    ANOP
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'
.OUT     ANOP
&NDX     SETA  0
         AIF   (&SUB EQ 0).OUTA
         AIF   (&OP LT N'&SYSLIST).LOOP
.OUTA    ANOP
         MEND
*
*
***********************************************************************
*
*
         MACRO
         HEX   &LOGITEM,&SKIP$OR,&BYTES
.*
.*       THIS  MACRO               FACILITATES GENERATION
.*       OF    THE                 TABLE ENTRIES SPECIFYING HEX
.*       TYPE  CONVERSIONS.
.*
.*       &LOGITEM -                NAME OF DATA ITEM TO BE
.*       CONVERTED.
.*
.*       &SKIP$OR -                NUMBER OF SPACES TO SKIP
.*       ON    MULTIPLE            PRINT OF NUMBER OF
.*       SPACES TO                 BACK UP FROM COLUMN FOR
.*       START OF                  PRINTING. THE LETTER B
.*       PRECEEDS THE              NUMBER (B8) IF THE
.*       LATTER OPTION             IS DESIRED. OMISSION
.*       OF    THIS                OPERAND FORCES OPTION 2 WITH
.*       BACKUP SPACING            EQUAL TO THE NUMBER
.*       OF    BYTES               SPECIFIED BY THE NEXT
.*       OPERAND (TWICE            THIS NUMBER IF SUFFIX
.*       IS    EXPLICITLY          OR IMPLICITLY B).
.*
.*       &BYTES -                  NUMBER OF TOTAL INPUT BYTES
.*       TO    PROCESS.            THIS NUMBER IS SUFFIXED
.*       WITH  A                   L,R, OR B TO STIPULATE
.*       PRINTING OF               THE LEFT HALF, RIGHT
.*       HALF, OR                  BOTH HALVES OF THE BYTE
.*       RESPECTIVELY. OMISSION    OF THIS
.*       OPERAND DEFAULTS          TO B WITH THE
.*       NUMBER OF                 BYTES EQUAL TO THE ITEM
.*       LENGTH.
.*
.*       A     NEW                 ENTRY IS GENERATED ONLY WHEN
.*       NECESSARY. THIS           MACRO MUST BE THE
.*       FIRST MACRO               INSTRUCTION ISSUED FOR
.*       THE   SUBJECT             LINE(S)
         GBLC  &ITEM(2000),&DSECT
         GBLA  &ITEMNBR,&BITS(2000),&SHIFT(2000),&NRENTS
         LCLB  &B
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP
         LCLC  &S,&LETTER
.LOOP    ANOP
&NDX     SETA  &NDX+1
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND
         AIF   (&NDX LT &ITEMNBR).LOOP
         MNOTE '**LOG ITEM NOT FOUND**'
         MEXIT
.FOUND   ANOP
&ISHIFT  SETA  &SHIFT(&NDX)
&IBITS   SETA  &BITS(&NDX)
&CODE    SETA  1
&K       SETA  K'&BYTES
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK
         MNOTE 'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'
         MEXIT
.OK      AIF   ('&BYTES' EQ '').USEDEFN
&LETTER  SETC  '&BYTES'(&K,1)
&S       SETC  '&BYTES'(1,&K-1)
&BYTESP  SETA  &S
         AIF   ('&LETTER' EQ 'B').BOTH
         AIF   ('&LETTER' EQ 'L').LEFT
&CODE    SETA  2
         AGO   .L
.LEFT    ANOP
&CODE    SETA  1
         AGO   .L
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2
.ERR     MNOTE 'DATA NOT ALIGNED ON HEX OR BYTE BOUNDARY'
         MEXIT
.USEDEFN ANOP
&BYTESP  SETA  &IBITS/8
.BOTH    AIF   (&ISHIFT NE 0).ERR
&CODE    SETA  3
&T       SETA  &BYTESP*2-1
&S       SETC  '&T'
.OK2     AIF   (&ISHIFT EQ 0).L
&CODE    SETA  2
.L       ANOP
&B       SETB  1
         AIF   ('&SKIP$OR' EQ '').BACKUP
&K       SETA  K'&SKIP$OR
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)
.BACKUP  ANOP
&NRENTS  SETA  &NRENTS+1
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'
.OUT     ANOP
         MEND
*
*
***********************************************************************
*
*
         MACRO
&NAME    ROUTINE &LOGITEM,&RNAME
         GBLC  &ITEM(2000)
         GBLA  &SHIFT(2000),&ITEMNBR
         GBLC  &DSECT,&CSECT
         GBLA  &NRENTS
         LCLA  &ISHIFT,&NDX
.LOOP    ANOP
&NDX     SETA  &NDX+1
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND
         AIF   (&NDX LT &ITEMNBR).LOOP
         MNOTE 'LOG ITEM NOT DEFINED'
         MEXIT
.FOUND   ANOP
&ISHIFT  SETA  &SHIFT(&NDX)
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)
&NRENTS  SETA  &NRENTS+1
         MEND
*
*
***********************************************************************
*
*
         MACRO
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C
               &LABEL7,&LABEL8
.*       THIS  MACRO               ALLOWS UP TO ACHT LABELS TO
.*       BE    SPECIFIED           FOR A GIVEN LINE. THE
.*       LABELS SHOULD             BE ENCLOSED IN QUOTA-
.*       TION  MARKS.              THE COLUMN AND LINE END
.*       CONTROLS WILL             BE INSERTED BY THE
.*       MACRO. OMITTED            OPERANDS MEAN NO
.*       LABEL REQUIRED            FOR RESPECTIVE
.*       COLUMN. THIS              MACRO WILL ALSO ALERT
.*       THE   PROGRAMMER          TO EXACTLY WHERE THE
.*       TABLE MUST                BE BROKEN IF NECESSARY
.*       TO    AVOID               EXCEEDING THE MAXIMUM LIMIT
         GBLC  &LABELS(2000)
         GBLC  &LBL(100)
         GBLA  &LBLCTR(100)
         GBLA  &LABELNR
         GBLA  &NRENTS,&LPTR
         LCLC  &MARGIN,&TACK
         LCLC  &TEXT
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN
&MARGIN  SETC  '*'
         AIF   ('&NAME' EQ '').LOOPOUT
&LPTR    SETA  &LPTR+1
&LBL(&LPTR) SETC '&NAME'
&LBLCTR(&LPTR) SETA &LABELNR+1
.LOOPOUT ANOP
&OP      SETA  &OP+1
&K       SETA  K'&SYSLIST(&OP)
         AIF   (&K GE 2).NORM
&K       SETA  2
.NORM    ANOP
&START   SETA  2
         AIF   (&OP LT N'&SYSLIST).NOTLAST
&MARGIN  SETC  '$'
.NOTLAST ANOP
&NRCHAR  SETA  8
&TACK    SETC  ''
.LOOPIN  ANOP
&REMAIN  SETA  &K-&START
         AIF   (&REMAIN GE 8).MORE
&TACK    SETC  '&MARGIN'
&NRCHAR  SETA  &REMAIN
.MORE    ANOP
&TEXT    SETC  ''
         AIF   (&REMAIN EQ 0).ENDTEXT
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)
.ENDTEXT ANOP
&LABELNR SETA  &LABELNR+1
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'
&START   SETA  &START+8
         AIF   ('&TACK' EQ '').LOOPIN
         AIF   ('&TACK' EQ '*').LOOPOUT
         MEND
         SPACE 2
         MACRO
         LSTART
.*       THIS  MACRO               IS ISSUED WHEN THE LABEL AREA
.*       OF    THE                 TABLE IS TO BEGIN.
         GBLC  &LABELS(2000)
         GBLA  &LABELNR
         GBLC  &LBL(100)
         GBLA  &LBLCTR(100)
         LCLA  &NDX,&CTR
         LINEND
&CTR     SETA  1
.LOOP    ANOP
&NDX     SETA  &NDX+1
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL
&LBL(&CTR) DC  C'&LABELS(&NDX)'
&CTR     SETA  &CTR+1
         AGO   .LOOPCTL
.NOLBL   ANOP
         DC    C'&LABELS(&NDX)'
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP
         MEND
*
*
***********************************************************************
*
*
         MACRO
         LINEND
.*       THIS  MACRO               IS USED ONLY BY THE LINE
.*       MACRO TO                  SET THE NUMBER OF ENTRIES
.*       ASSOCIATED WITH           EACH LINE.
         GBLA  &NRENTS
         GBLC  &NRENTSX
         ORG   &NRENTSX
         DC    FL1'&NRENTS'
         ORG
&NRENTS  SETA  0
B&SYSNDX EQU   *
&NRENTSX SETC  'B&SYSNDX'
         MEND
*
*
***********************************************************************
*
*
         MACRO
&NAME    BIND  &Z1,&Z2,&Z3,&Z4
.*       THIS  MACRO               HELPS COLLOCATE BITS IN
.*       DIFFERENT AREAS           OF THE LOG TO MAKE
.*       THEM  ACCESSIBLE          TO THE 'HEX' MACRO.
.*       EACH  OPERAND             HAS 3 SUBFIELDS:1 SPE-
.*       CIFIES BY                 LOGITEM NAME THE BYTE TO
.*       BE    REFERENCED,2        GIVES THE NUMBER OF
.*       UNDESIRED BITS            TO THE LEFT OF THE
.*       LOG   ITEM'S FIRST BIT,3 GIVES THE LOG
.*       ITEM'S LENGTH             IN BITS. THE MACRO
.*       CAUSES THE                INFORMATION TO BE STORED &
.*       CONTROL IS                GIVEN TO THE 'BINDER' ROU-
.*       TINE,WHICH STORES         THE COLLOCATED
.*       BITS  RIGHT-JUSTIFIED     IN THE FOUR-
.*       BYTE  WORK                AREA INSERTED IN THE LOG,
.*       BEGINNING AT              'LOGWORK1'
         GBLC  &DSECT
         LCLA  &OP
&NAME    BC    15,BINDER
.LOOP    ANOP
&OP      SETA  &OP+1
         DC    AL.16(&SYSLIST(&OP,1)-&DSECT)
         DC    FL1'&SYSLIST(&OP,2)'
         DC    FL1'&SYSLIST(&OP,3)'
         AIF   (&OP LT N'&SYSLIST).LOOP
         ORG   &NAME+4
         DC    AL.4(&OP),AL.12(&SYSLIST(1,1)-&DSECT)
         ORG
         MEND
         MACRO
&NAME    CKPARITY &PAR1,&PAR2,&PAR3,&PAR4,&PAR5,&PAR6
.*       THIS  MACRO               HELPS SET THE LOCATION
.*       CONTROLS FOR              A SPECIAL ROUTINE TO
.*       CHECK PARITY              ON ITEMS FROM THE LOG
.*       ALREADY ASSEMBLED         FOR PRINTING IN THE
.*       PRINT BUFFER              THAT HAS BEEN SET UP.
.*       EACH  OPERAND             (UP TO SIX) HAS THREE
.*       SUBFIELDS:1 GIVES         THE DISPLACEMENT
.*       FROM  PRINT               POSITION ZERO TO BEGIN
.*       THE   PARITY              CHECK(I.E.,LOC. OF PARITY
.*       BIT   IN                  BUFFER);2 GIVES THE NUMBER OF
.*       POSITIONS TO              CHECK AGAINST THE PARITY
.*       BIT   (ASSUMING           1 SPACE BETWEEN PAR BIT
.*       AND   THE                 FIRST POSITION TO BE CHECKED)
.*       3     GIVES               THE NUMBER OF SEQUENTIAL PAR.
.*       CHECKS OF                 THIS SORT TO MAKE,ASSUMING
.*       TWO   SPACES              BETWEEN THE LAST POSITION
.*       CHECKED AND               NEXT PAR. BIT POSITION
         LCLA  &OP
&NAME    BC    15,PARPUT
         DC    X'0'
.LOOP    ANOP
&OP      SETA  &OP+1
         DC    FL1'&SYSLIST(&OP,1)'
         DC    FL1'&SYSLIST(&OP,2)'
         DC    FL1'&SYSLIST(&OP,3)'
         AIF   (&OP LT N'&SYSLIST).LOOP
         ORG   &NAME+4
         DC    FL1'&OP'
         ORG
         MEND
         GBLC  &DSECT,&CSECT
IFCETUL1 CSECT
&CSECT   SETC  'IFCETUL1'
&DSECT   SETC  'DSECT145'
DSECT145 DSECT
         DS    0F
         DSGEN (XKEY,8),(XRELN,8),(XSWS0,8),(XSWS8,1),(XSWS9,1),       C
               (XSWS10,1),(XSWS11,1),                                  *
               (XSWS12,1),(XSWS13,1),(XSWS14,1),(XSWS15,1)
         DSGEN (LOGWORK1,8),(LOGWORK2,6),(LOGWORK3,2),(LOGWRK3A,4),    *
               (LOGWRK3B,3),(LOGWRK3C,1),(LOGWORK4,8)
         DSGEN (XDATE,32)
         DSGEN (XTIME,32)
         DSGEN (XDUM2,8),(XSER,24)
         DSGEN (XCPUMOD,16),(XDUM3,16)
         DSGEN (XPGMID,64)
         ORG   XPGMID
         DSGEN (RECLNT,32),(WAITST,32)
         DSGEN (XJOBID,64)
         ORG   XJOBID
         DSGEN (MCETEF,1,0,7),(MCEMEF,1,0,7),(MCEIEF,1,0,7),           X
               (MCESEF,1,0,7),(PDAR0,1,0,7),(PDAR1,1,0,7),             X
               (PDAR2,1,0,7),(WDSIZE,8)
         DSGEN (XMCKPSW,64)
         DSGEN (MCIC,1,0,47),(EXTDLOG,16)
         DSGEN (RESRVDB,64)
         DSGEN (FAILSTA,32)
         DSGEN (CTRLWD,16),(ERCORCD,8),(RGCODE,1,24,31)
         DSGEN (DUMMY1,32)
         DSGEN (MCAR,32)
         DSGEN (MCDR1,32)
         DSGEN (MCDR2,32)
         DSGEN (MANTLTH1,32)
         DSGEN (MANTLTH2,32)
         DSGEN (MCRR1,32)
         DSGEN (MCRR2,32)
         DSGEN (ICM90,32)
         DSGEN (STATUS,32)
         DSGEN (FDUM1,32)
         DSGEN (FDUM2,32)
         DSGEN (FDUM3,32)
         DSGEN (FDUM4,32)
         DSGEN (FDUM5,32)
         DSGEN (FDUM6,32)
         DSGEN (FDUM7,32)
         DSGEN (FDUM8,32)
         DSGEN (FDUM9,32)
         DSGEN (FDUM10,32)
         DSGEN (FDUM11,32)
         DSGEN (FDUM12,32)
         DSGEN (FDUM13,32)
         DSGEN (FDUM14,32)
FLOATPTS DSGEN (FP0,32)
         DSGEN (FP1,32)
         DSGEN (FP2,32)
         DSGEN (FP3,32)
         DSGEN (FP4,32)
         DSGEN (FP5,32)
         DSGEN (FP6,32)
         DSGEN (FP7,32)
GENPURPR DSGEN (GPR0,32)
         DSGEN (GPR1,32)
         DSGEN (GPR2,32)
         DSGEN (GPR3,32)
         DSGEN (GPR4,32)
         DSGEN (GPR5,32)
         DSGEN (GPR6,32)
         DSGEN (GPR7,32)
         DSGEN (GPR8,32)
         DSGEN (GPR9,32)
         DSGEN (GP10,32)
         DSGEN (GP11,32)
         DSGEN (GP12,32)
         DSGEN (GP13,32)
         DSGEN (GP14,32)
         DSGEN (GP15,32)
         DSGEN (CTR0,32)
         DSGEN (CTR1,32)
         DSGEN (CTR2,32)
         DSGEN (CTR3,32)
         DSGEN (CTR4,32)
         DSGEN (CTR5,32)
         DSGEN (CTR6,32)
         DSGEN (CTR7,32)
         DSGEN (CTR8,32)
         DSGEN (CTR9,32)
         DSGEN (CR10,32)
         DSGEN (CR11,32)
         DSGEN (CR12,32)
         DSGEN (CR13,32)
         DSGEN (CR14,32)
         DSGEN (CR15,32)
         DSGEN (RETCNTUN,4),(RETCNT2H,4),(RETUNUS,16),(NONRETRY,8)
         DSGEN (MCHRG00,1),(MCHRG01,1),(MCHRG02,1),(MCHRG03,1),        X
               (MCHRG04,1),(MCHRG05,1),(MCHRG06,1),(MCHRG07,1),        X
               (MCHRG08,1),(MCHRG09,1),(MCHRG10,1),(MCHRG11,1),        X
               (MCHRG12,1),(MCHRG13,1),(MCHRG14,1),(MCHRG15,1),        X
               (MCHRG16,1),(MCHRG17,1),(MCHRG18,1),(MCHRG19,1),        X
               (MCHRG20,1),(MCHRG21,1),(MCHRG22,1),(MCHRG23,1),        X
               (MCHRG24,1),(MCHRG25,1),(MCHRG26,1),(MCHRG27,1),        X
               (MCHRG28,1),(MCHRG29,1),(MCHRG30,1),(MCHRG31,1)
         DSGEN (MCHRGB00,1),(MCHRGB01,1),(MCHRGB02,1),(MCHRGB03,1),    X
               (MCHRGB04,1),(MCHRGB05,1),(MCHRGB06,1),(MCHRGB07,1),    X
               (MCHRGB08,1),(MCHRGB09,1),(MCHRGB10,1),(MCHRGB11,1),    X
               (MCHRGB12,1),(MCHRGB13,1),(MCHRGB14,1),(MCHRGB15,1),    X
               (MCHRGB16,1),(MCHRGB17,1),(MCHRGB18,1),(MCHRGB19,1),    X
               (MCHRGB20,1),(MCHRGB21,1),(MCHRGB22,1),(MCHRGB23,1),    X
               (MCHRGB24,1),(MCHRGB25,1),(MCHRGB26,1),(MCHRGB27,1),    X
               (MCHRGB28,1),(MCHRGB29,1),(MCHRGB30,1),(MCHRGB31,1)
         DSGEN (RTYREG1,32),(RTYREG2,32)
         DSGEN (REGUNU,8),                                             X
               (HREG0,1),(HREG1,1),(HREG2,1),(HREG3,1),(HREG4,1),      X
               (HREG5,1),(HREG6,1),(HREG7,1),(RETRG23,16)
         DSGEN (RTYRG400,1),(RTYRG401,1),(RTYRG402,1),(RTYRG403,1),    X
               (RTYRG404,1),(RTYRG405,1),(RTYRG406,1),(RTYRG407,1),    X
               (RTYRG408,1),(RTYRG409,1),(RTYRG410,1),(RTYRG411,1),    X
               (RTYRG412,1),(RTYRG413,1),(RTYRG414,1),(RTYRG415,1),    X
               (RTRUNSED,1),(RTYRG417,3),(RTYRG420,3),(RTYEXP,1),      C
               (RTYUNSD,1),                                            C
               (RTYRG425,3),(RTYRG428,3),(RTYNOTUS,1)
         DSGEN (CTRLDWD,32)
         DSGEN (SYSREG00,1),(SYSREG01,1),(SYSREG02,1),(SYSREG03,1),    X
               (SYSREG04,1),(SYSREG05,1),(SYSREG06,1),(SYSREG07,1),    X
               (SYSREG08,1),(SYSREG09,1),(SYSREG10,1),(SYSREG11,1),    X
               (SYSREG12,1),(SYSREG13,1),(SYSREG14,1),(SYSREG15,1),    X
               (SYSREG16,1),(SYSREG17,1),(SYSREG18,1),(SYSREG19,1),    X
               (SYSREG20,1),(SYSREG21,1),(SYSREG22,1),(SYSREG23,1),    X
               (SYSREG24,1),(SYSREG25,1),(SYSREG26,1),(SYSREG27,1),    X
               (SYSREG28,1),(SYSREG29,1),(SYSREG30,1),(SYSREG31,1)
         DSGEN (IREG,8),(IREGB,24)
         DSGEN (UREGA1,2),(UREGA2,2),(UREGA3,4),(UREGA4,4),(UREGA5,4), X
               (UREGC1,8),(UREGC2,8)
         DSGEN (WREG,32)
         DSGEN (VREG,32)
         DSGEN (XREG,32)
         DSGEN (RREG,32)
         DSGEN (YREG,32)
         DSGEN (QREG,32)
         DSGEN (IBUG,32)
         DSGEN (TRRG,32)
         DSGEN (SPAR,32)
         DSGEN (SNRG,8),(SNRA,8),(SNRB,16)
         DSGEN (PNRG,16),(RLPAGE,16)
         DSGEN (WKRG,32)
         DSGEN (NPRGXST,16),                                           X
               (EXPDST00,1),(EXPDST01,1),(EXPDST02,1),(EXPDST03,1),    X
               (EXPDST04,1),(EXPDST05,1),(EXPDST06,1),(EXPDST07,1),    X
               (EXPDST08,1),(EXPDST09,1),(EXPDST10,1),(EXPDST11,1),    X
               (EXPDST12,1),(EXPDST13,1),(EXPDST14,1),(EXPDST15,1)
         DSGEN (DMREG,32),(RWREG,32)
         DSGEN (CPUREG00,1),(CPUREG01,1),(CPUREG02,1),(CPUREG03,1),    X
               (CPUREG04,1),(CPUREG05,1),(CPUREG06,1),(CPUREG07,1),    X
               (CPUREG16,8),(NEWRELTB,8),(OLDRELTB,8)
         DSGEN (PSWCTL00,1),(PSWCTL01,1),(PSWCTL02,1),(PSWCTL03,1),    X
               (PSWCTL04,1),(PSWCTL05,1),(PSWCTL06,1),(PSWCTL07,1),    X
               (PSWCTL08,1),(PSWCTL09,1),(PSWCTL10,1),(PSWCTL11,1),    X
               (PSWCTL12,1),(PSWCTL13,1),(PSWCTL14,1),(PSWCTL15,1),    X
               (PSWCTL16,1),(PSWCTL17,1),(PSWCTL18,1),(PSWCTL19,1),    X
               (PSWCTL20,1),(PSWCTL21,1),(PSWCTL22,1),(PSWCTL23,1),    X
               (PSWCTL24,1),(PSWCTL25,1),(PSWCTL26,1),(PSWCTL27,1),    X
               (PSWCTL28,1),(PSWCTL29,1),(PSWCTL30,1),(PSWCTL31,1)
         DSGEN (SHCTL00,2),(SHCTL02,2),(SHCTL04,4),(SHCTL10,1),        X
               (SHCTL11,1),(SHCTL12,2),(SHCTL14,4),(SHCTL20,8),        X
               (SHCTL30,8)
         DSGEN (SHHI,32),(SHLO,32)
         ORG   SHCTL12
         DSGEN (MULTCTR,8)
         DSGEN (DARLNGTH,16),(,48)
         DSGEN (SYSSTAT,1,0,7)
         DSGEN (AREADT,1,0,15)
         DSGEN (ERRTYPE,1,0,7)
         DSGEN (RMSACTN,1,0,7)
         DSGEN (RMSINFO,1,0,7)
         DSGEN (WAITSUFF,8),(,8),(MCHFSAR,32),(,32)
         DSGEN (TRNSMOD,32,0,7)
         DSGEN (MCHPDR,1,0,7,0,7)
         DSGEN (MCHFSAV,32),(MCHFSEAV,32),(MCHPDARI,32),(MCHTCBCU,32)
IFCETUL1 CSECT
         USING *,9
         USING DSECT145,R2
ENTRYPTR DC    A(STARTER)
TABLNAME DC    CL8'IFCETUL1'
REG9     DC    F'0'
LP       DC    F'0'
SKIPPER  BR    14
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
H01      EQU   X'01'
H13      EQU   X'13'
H20      EQU   X'20'
R13      EQU   13
R14      EQU   14
R15      EQU   15
HEX00    EQU   X'00'
HEX08    EQU   X'08'
HEX40    EQU   X'40'
HEX80    EQU   X'80'
HEX48    EQU   X'48'
HEXBF    EQU   X'BF'
L0       EQU   0
L1       EQU   1
L2       EQU   2
L3       EQU   3
L4       EQU   4
L5       EQU   5
L6       EQU   6
L7       EQU   7
L8       EQU   8
L12      EQU   12
L19      EQU   19
L60      EQU   60
CONVREL  STM   R5,R8,XSAVE         SAVE WORK REGS
         SR    R6,R6               CLEAR R6
         IC    R6,L0(R4)           PICK UP REL & SYS VALUES
         SRDL  R6,L5               SAVE REL NO IN R7
         SLL   R6,L2               MULTIPLY SYS VALUE BY 4
         L     R8,XLABELP          PICK UP LABEL POINTER
         LA    R6,RELTAB(R6)       INDEX INTO TABLE OF SYSTEMS
         MVC   L0(L4,R8),L0(R6)    MOVE SYSTEM NAME INTO LABEL
         SR    R6,R6               CLEAR R6
         SLDL  R6,L5               RETREIVE REL NO.
         LTR   R6,R6               IS IT ZERO
         BZ    NOREL               BR-YES
         CVD   R6,WORK             CONVERT IT
         UNPK  L0(L2,R3),WORK+L6(L2) UNPACK IT INTO PRINT BUFF
         MVZ   L1(L1,R3),L0(R3)    MOVE ON PROPER ZONE
         B     RETURN              EXIT
NOREL    MVC   L0(L4,R3),NONE      MOVE IN NONE FOR REL
         B     RETURN
*
SETJOBN  MVC   L0(L8,R3),L0(R4)    MOVE JOB NAME
         BR    R14                 RETURN
*
SETDATE  UNPK  XWORK(L8),L0(L4,R4) UNPACK DATE
         MVZ   XWORK+L7(L1),XWORK  SET ZONE
         MVC   L0(L3,R3),XWORK+L5  MOVE DAY
         MVC   L6(L2,R3),XWORK+L3  MOVE YEAR
         BR    R14                 RETURN
*
TSTREC   STM   R5,R8,XSAVE                                     @XA20224
         TM    0(R4),HEX80         TEST SHORT FORM RECORD SWITCH
         BZ    TSTRECN             BRANCH IF LONG FORM
         CLI   VS2FLG,H01
         BE    VS2SH
         LA    R5,SHORTREC-L4      ADDRESS OF END OF SHORT RECORD
         ST    R5,REG9             INTO ENTRY POINTER
         B     RETURN                                          @XA20224
VS2SH    L     R5,LINEB            SET UP LINE PTR.
         L     R6,LABB             SET UP LABEL PTR.
         ST    R5,REG9             STORE
         ST    R6,XLABELP          STORE
         B     RETURN                                          @XA20224
TSTRECN  SR    R15,R15            DON'T PRINT LAST LINE        @XA20224
         BR    R14                 RETURN
ROUT3    ST    R3,XSAVE            SAVE REG 3
         TM    0(R4),HEX80         TEST SHORT FORM RECORD SWITCH
         BO    ROUT3A              BRANCH IF SHORT FORM
         SR    R15,R15             DON'T PRINT LAST LINE
ROUT3A   L     R3,XSAVE            RESTORE REG 3
         BR    R14                 RETURN
RETURN   LM    R5,R8,XSAVE         RESTORE WORK REGISTERS
         BR    R14                 RETURN
SYSTERM  STM   R5,R8,XSAVE         SAVE REGS
         CLI   VS2FLG,H01          IS IT VS2?
         BNE   CONTIN              NO, RETURN
         TM    XSWS10,H20          YES,CK FLAG
         BO    RETURN              ON,PRINT MSG RETURN
CONTIN   SR    R15,R15             ELIM LABEL
         B     RETURN
ISITVS2  STM   R5,R8,XSAVE
         CLI   XKEY,H13            IS IT VS2?
         BE    ITIS                YES
         B     RETURN              NO
ITIS     OI    VS2FLG,H01          YES VS2
         B     RETURN
VS2TEST1 STM   R5,R8,XSAVE
         CLI   VS2FLG,H01          IS THIS VS2
         BE    ITISVS2             YES VS2
FIN      SR    R15,R15             ELIM. LABEL
         B     RETURN
ITISVS2  L     R5,LINEA            CHANGE LINE PTR
         L     R6,LABA             CHANGE LABEL PTR
         ST    R5,XR9PTR           STORE PTR
         ST    R6,XLABELP          STORE LABEL
         B     FIN                 CLEAN UP AND RETURN
VS2TEST2 STM   R5,R8,XSAVE
         CLI   VS2FLG,H01          IS THIS VS2?
         BE    ISVS2               YES
         B     FIN                 NO, RETURN
ISVS2    L     R5,LINEB            SET UP LINE PTR
         L     R6,LABB             SET UP LABEL PTR
         ST    R5,XR9PTR           STORE LINE ADDR.
         ST    R6,XLABELP          STORE LABEL PTR
         B     FIN
VS2TEST3 STM   R5,R8,XSAVE
         CLI   VS2FLG,H01
         BE    TESTRL              VS2 BRANCH
         TM    XSWS8,HEX80         TEST SIZE OF REC.
         BO    SHORT               SHORT REC.
         LA    R5,DUMPCODE-4       SET UP BRANCH PTR
         ST    R5,REG9
         B     RETURN              GO BACK
SHORT    LA    R5,SHORTREC-4       N-T 0S2 2&T S & 3   CC&
         ST    R5,REG9             STORE IN CORE
         B     RETURN
TESTRL   TM    XSWS8,HEX80         VS2,WHAT IS REC .
         BO    SHTFRM
         B     RETURN
SHTFRM   LA    R5,SHTVS2-4         SET UP PTR TO SHORT REC.
         ST    R5,REG9             STORE IN CORE
         B     RETURN              CLOSE OUT
*        ELIMINATE LINE IF NOT MVS                             @XA20224
ISITMVS  CLI   XKEY,H13                IS IT MVS               @XA20224
         BE    RETURNA                 YES                     @XA20224
         SR    R15,R15                 ELIM. LABEL             @XA20224
RETURNA  BR    R14                                             @XA20224
ISIT148  STM   R5,R8,XSAVE
         LA    R5,40               NO. OF SPACES TO BACK UP
         LR    R6,R3               GET OUTPUT PTR
         SR    R6,R5               BACKUP PTR
         MVI   L0(R6),C'8'         MAKE IT 148
         CLI   L1(R4),X'48'        IS IT 148
         BE    RETURN              YES
         MVC   L0(L3,R6),LAB145    MAKE IT 145-3
         B     RETURN              DONE
JUMP     STM   R5,R8,XSAVE
         L     R5,LINEC            SET UP LINE PTR.
         ST    R5,XR9PTR           STORE LINE ADDR.
         B     FIN                 CLEAN UP AND RETURN
REGCODE  LA    R3,49(R3)           POSITION PTR
         BR    R14                 RETURN
RETRYCNT LA    R3,59(R3)           POSITION PTR
         BR    R14                 RETURN
HILO     DS    0H
         MVC   HLSAVE(1),1(R4)     SAVE FLAG BYTE
         TM    1(R4),X'01'         HI STORAGE?
         BO    HI                  YES
         MVI   0(R3),X'F0'         LOW STORAGE
         B     RETHILO             RESET AND RETURN
HI       MVI   0(R3),X'F1'         INDICATE HI STORAGE
RETHILO  NI    1(R4),X'FC'         TURN OFF LOW BITS
         BR    R14                 RETURN
RESHILO  DS    0H                  RESTORE LOGREC
         MVC   1(1,R4),HLSAVE
         BR    R14
HLSAVE   DC    X'00'
VS2FLG   DC    X'00'
LINEA    DC    A(LINE1-4)
LABA     DC    A(LAB1-1)
LINEB    DC    A(LINE2-4)
LABB     DC    A(LAB2-1)
LINEC    DC    A(DUMPCODE-4)
XWORK    DS    D
RELTAB   DS    0C                  @L03163
         DC    C'OS  '             @L03163
         DC    C'DOS '             @L03163
         DC    C'VS 1'             @L03163
         DC    C'V370'             @L03163
         DC    C'VS 2'             @L03163
         DC    C'    '             @L03163
         DC    C'    '             @L03163
         DC    C'    '             @L03163
XR9PTR   EQU   REG9
XLABELP  EQU   LP
WORK     EQU   XWORK
XSAVE    DS    2D
NONE     DC    CL4'NONE'
X148     DC    X'0148'
LAB145   DC    C'5-3'
         LTORG
STARTER  DS    0F
         DC    XL4'00010001'
         DC    XL4'00010001'
         DC    A(LABAREA)
         DC    H'0'
         DC    X'01'
         DC    X'000B8B00'
         LABEL ''
         LINE  ,,SKIP=2
         ROUTINE XKEY,ISITVS2
         LABEL ''
         LINE  (48,1),(1,35),SKIP=2
         HEX   XSER,1,3B
         ROUTINE XCPUMOD,ISIT148
         LABEL 'MODEL 14','SERIAL NO'
*
         LINE  (10,)
         ROUTINE XRELN,CONVREL
         LABEL 'XXXX REL.'
         LINE  (48,1)
         LABEL '--- RECORD SOURCE - MCH ---','TYPE - CPU'
*
         LINE  (15,1),(1,1)
         HEX   XMCKPSW,1,8B
         LABEL 'MCK OLD PSW'
         LINE  (21,1),(1,1)
         ROUTINE XRELN,SYSTERM
         LABEL 'XXXXX  SYSTEM TERMINATED  XXXXX'
         LINE  ,
         ROUTINE XRELN,VS2TEST1
         LABEL ''
         LINE  (21,1),(1,1)
         ROUTINE XJOBID,SETJOBN
         LABEL 'JOB NAME'
*
         LINE
         ROUTINE XPGMID,SETJOBN
         LABEL 'PROGRAM NAME'
*
LINE1    LINE  ,(8,40),SKIP=1
         ROUTINE XSWS0,SKIPPER
LAB1     LABEL 'DAY  YEAR','HH MM SS.TH'
         LINE  (8,40),(1,40),SKIP=2
         ROUTINE XDATE,SETDATE
         HEX   XTIME,1,4B
         LABEL 'DATE _','TIME _'
**********************************************************************
START    DS    0C
         LINE  ,(30,1)
         LABEL '--- MACHINE CHECK INTERRUPT CODE ---'
         LINE  (41,50),(1,50),SKIP=1
         LABEL '--- SUB CLASS ---'
         LINE
         BIN   MCIC0
         BIN   MCIC4
         LABEL 'SYSTEM DAMAGE (SD)','TIMING FACILITIES DAMAGE (CD)'
         LINE
         BIN   MCIC1
         BIN   MCIC5
         LABEL 'INSTRUCTION PROCESSING DAMAGE (PD)',                   C
               'EXTERNAL DAMAGE (ED)'
         LINE
         BIN   MCIC2
         BIN   MCIC7
         LABEL 'SYSTEM RECOVERY (SR)','DEGRADATION (DG)'
         LINE
         BIN   MCIC3
         BIN   MCIC8
         LABEL 'TIMER DAMAGE','WARNING (W)'
         LINE
         LABEL ''
         LINE  ,(1,1),SKIP=1
         LABEL '--- INTERRUPT TENSE CODES ---'
         LINE  (41,50),(1,50)
         BIN   MCIC14
         BIN   MCIC15
         LABEL 'BACKED-UP (B)','DELAYED (D)'
         LINE
         LABEL ''
         LINE  ,(1,1),SKIP=1
         LABEL '--- STORAGE AND PROTECTION ERROR CODES ---'
         LINE  (41,50),(1,50)
         BIN   MCIC16
         BIN   MCIC18
         LABEL 'UNCORRECTED STORAGE ERRORS (SE)',                      C
               'KEY IN STORAGE ERROR UNCORRECTED (KE)'
         LINE
         BIN   MCIC17
         LABEL 'CORRECTED STORAGE ERRORS (SC)'
         LINE
         LABEL ''
         LINE  ,(1,1),SKIP=1
         LABEL '--- PSW VALIDITY CODES ---'
         LINE  (41,50),(1,50)
         BIN   MCIC20
         BIN   MCIC21
         LABEL 'EMWP BITS OF M.C. OLD ARE VALID (WP)',                 C
               'SYSTEM MASK AND KEY ARE VALID (MS)'
         LINE
         BIN   MCIC22
         BIN   MCIC23
         LABEL 'PGM MASK AND COND CODE ARE VALID (PM)',                C
               'INSTR ADDR OF M.C. OLD IS VALID (IA)'
         LINE
         LABEL ''
         LINE  ,(1,1),SKIP=1
         LABEL '--- MISC VALIDITY CODES ---'
         LINE  (41,50),(1,50)
         BIN   MCIC24
         BIN   MCIC25
         LABEL 'FAILING STORAGE ADDR IS VALID (FA)','REGION CODE VALID X
                (RC)'
         LINE
         BIN   MCIC27
         BIN   MCIC28
         LABEL 'FP REGS STORED ARE VALID (FP)','GP REGS STORED ARE VALIX
               D (GP)'
         LINE
         BIN   MCIC29
         BIN   MCIC30
         LABEL 'CONTROL REGS STORED ARE VALID (CR)','EXTENDED LOGOUT ARX
               EA VALID (LG)'
         LINE
         BIN   MCIC31
         BIN   MCIC46
         LABEL 'INSTR MODIFIED STORAGE VALID (ST)','CPU TIMER VALID'
         LINE
         BIN   MCIC47
         LABEL 'CLOCK COMPARATOR VALID'
         LINE
         LABEL ''
         LINE  (58,1),(30,30),SKIP=2                           @XA20224
         BIN   MCIC32                                          @XA20224
         ROUTINE  XKEY,ISITMVS                                 @XA20224
         LABEL '--- LRB MAY NOT BE VALID','---'                @XA20224
         LINE  (37,50),(1,50),SKIP=2
         HEX   EXTDLOG,1,2B
         LABEL 'EXTENDED LOGOUT LENGTH'
         LINE  (37,1),(1,1)
         HEX   RESRVDB,1,14B
         ROUTINE XSWS8,ROUT3
         LABEL 'MC STATUS FIELD'
         LINE  ,(1,1),SKIP=1
         ROUTINE XSWS8,TSTREC
         LABEL 'ABBREVIATED MACHINE CHECK LOGOUT'
         LINE  (35,1),(1,1),SKIP=2
         HEX   FAILSTA,1,4B
         LABEL 'FAILING STORAGE ADDRESS'
         LINE  ,(1,1),SKIP=1
         LABEL '--- REGION CODE ---'
         LINE  ,(46,),SKIP=1
         LABEL 'BIT(BYTE 3)'
         LINE  (37,4),(1,46)
         ROUTINE CTRLWD,HILO
         HEX   CTRLWD
         ROUTINE CTRLWD,REGCODE
         BIN   RGCODE24,B7
         ROUTINE CTRLWD,RESHILO
         LABEL 'CONTROL STORAGE ADDRESS(BYTES 0-1)','0   UNUSED'
         LINE
         HEX   ERCORCD
         BIN   RGCODE25
         LABEL 'ERROR CORRECTION CODES(BYTE 2)','1   UNUSED'
         LINE  (91,),(47,)
         BIN   RGCODE26
         LABEL '2   CHECK BIT OR DATA BIT FAILURE'
         LINE
         BIN   RGCODE27
         LABEL '3   DATA BIT FAILURE'
         LINE
         BIN   RGCODE28
         LABEL '4   CONTROL STORAGE DOUBLE BIT FAILURE'
         LINE
         BIN   RGCODE29
         LABEL '5   THRESHOLD LIMIT EXCEEDED(BIT 7 ALSO 1)'
         LINE
         BIN   RGCODE30
         LABEL '6   INTERMITTENT SINGLE BIT FAILURE(CS/MS)'
         LINE
         BIN   RGCODE31
         LABEL '7=0 MAIN STORAGE FAILURE IF BIT 6=1'
         LINE  ,,SKIP=2
         LABEL '7=1 CONTROL STORAGE FAILURE IF BIT 6=1'
         LINE  ,(5,35),SKIP=1
         LABEL ''
         DC    X'01000B8B00'
         LABEL ''
         LINE  ,(5,1)
         LABEL '--- FLOATING POINT REGISTERS ---'
         LINE  (16,15),(1,1)
         HEX   FP0,1,4B
         HEX   FP1,1,4B
         HEX   FP2,1,4B
         HEX   FP3,1,4B
         LABEL 'FP REGS 0,2'
         LINE  (16,15),(1,1)
         HEX   FP4,1,4B
         HEX   FP5,1,4B
         HEX   FP6,1,4B
         HEX   FP7,1,4B
         LABEL 'FP REGS 4,6'
         LINE
         LABEL ''
         LINE  ,(5,1)
         LABEL '--- GENERAL PURPOSE REGISTERS ---'
         LINE  (16,15),(1,1)
         HEX   GPR0,1,4B
         HEX   GPR1,1,4B
         HEX   GPR2,1,4B
         HEX   GPR3,1,4B
         LABEL 'GP REGS 0-3'
         LINE  (16,15),(1,1)
         HEX   GPR4,1,4B
         HEX   GPR5,1,4B
         HEX   GPR6,1,4B
         HEX   GPR7,1,4B
         LABEL 'GP REGS 4-7'
         LINE  (16,15),(1,1)
         HEX   GPR8,1,4B
         HEX   GPR9,1,4B
         HEX   GP10,1,4B
         HEX   GP11,1,4B
         LABEL 'GP REGS 8-B'
         LINE  (16,15),(1,1)
         HEX   GP12,1,4B
         HEX   GP13,1,4B
         HEX   GP14,1,4B
         HEX   GP15,1,4B
         LABEL 'GP REGS C-F'
         LINE
         LABEL ''
         LINE  ,(5,1)
         LABEL '--- CONTROL REGISTERS ---'
         LINE  (16,15),(1,1)
         HEX   CTR0,1,4B
         HEX   CTR1,1,4B
         HEX   CTR2,1,4B
         HEX   CTR3,1,4B
         LABEL 'CR REGS 0-3'
         LINE  (16,15),(1,1)
         HEX   CTR4,1,4B
         HEX   CTR5,1,4B
         HEX   CTR6,1,4B
         HEX   CTR7,1,4B
         LABEL 'CR REGS 4-7'
         LINE  (16,15),(1,1)
         HEX   CTR8,1,4B
         HEX   CTR9,1,4B
         HEX   CR10,1,4B
         HEX   CR11,1,4B
         LABEL 'CR REGS 8-B'
         LINE  (16,15),(1,1)
         HEX   CR12,1,4B
         HEX   CR13,1,4B
         HEX   CR14,1,4B
         HEX   CR15,1,4B
         LABEL 'CR REGS C-F'
         DC    X'01000B8B00'
         LABEL ''
         LINE  ,(40,1),SKIP=2
         LABEL 'CPU DEPENDENT LOGOUT'
         LINE  ,(30,1),SKIP=2
         LABEL '----------------------------------------------------'
         LINE  ,(40,1),SKIP=2
         LABEL 'MACHINE CHECK REGISTER A'
         LINE  ,(14,62),SKIP=2
         LABEL 'BYTE 0','BYTE 2'
         LINE  (38,60),(1,59),SKIP=1
         BIN   MCHRG00
         BIN   MCHRG16
         LABEL 'LOCAL STORAGE A SOURCE ADDR CHK','ALU 2 HALF SUM CHK'
         LINE
         BIN   MCHRG01
         BIN   MCHRG17
         LABEL 'LOCAL STORAGE B SOURCE ADDR CHK','ALU 3 HALF SUM CHK'
         LINE
         BIN   MCHRG02
         BIN   MCHRG18
         LABEL 'LOCAL STORAGE A DEST ADDR CHK','ALU LOGICAL CHK'
         LINE
         BIN   MCHRG03
         BIN   MCHRG19
         LABEL 'LOCAL STORAGE B DEST ADDR CHK','B REG SHIFT CHK'
         LINE
         BIN   MCHRG04
         BIN   MCHRG20
         LABEL 'DEST BYTE CTRL CHK','A REG PTY CHK'
         LINE
         BIN   MCHRG05
         BIN   MCHRG21
         LABEL 'LOCAL STORAGE A-B DEST ADDR COMPARE','B REG PTY CHK'
         LINE
         BIN   MCHRG06
         BIN   MCHRG22
         LABEL 'LOCAL STORAGE CTRL ASSM CHK','Z REG PTY CHK'
         LINE  (38,60),(1,59),SKIP=2
         BIN   MCHRG07
         BIN   MCHRG23
         LABEL 'CTRL REG PTY CHK','D REG PTY CHK'
         LINE  ,(14,62),SKIP=2
         LABEL 'BYTE 1','BYTE 3'
         LINE  (38,60),(1,59),SKIP=1
         BIN   MCHRG08
         BIN   MCHRG24
         LABEL 'ADDR CHK BOUND REG CHK','EXT REG DEST X COMP CHK'
         LINE
         BIN   MCHRG09
         BIN   MCHRG25
         LABEL 'LOCAL STORAGE COMP CHK','EXT REG DEST Y COMP CHK'
         LINE
         BIN   MCHRG10
         BIN   MCHRG26
         LABEL 'FLUSH THRU CHK','EXT REG SOURCE Y CHK'
         LINE
         BIN   MCHRG11
         BIN   MCHRG27
         LABEL 'H REG PTY CHK','EXT CTRL ASSM PTY CHK'
         LINE
         BIN   MCHRG12
         BIN   MCHRG28
         LABEL 'CLOCK COMPARATOR-CPU TIMER CHK','INTERV TIMER PTY CHK'
         LINE
         BIN   MCHRG13
         BIN   MCHRG29
         LABEL 'P REG PTY CHK','S REC DUP CHK'
         LINE
         BIN   MCHRG14
         BIN   MCHRG30
         LABEL 'T REG PTY CHK','TIME OF DAY CLOCK CHK'
         LINE  ,,SKIP=2            A45391
         BIN   MCHRG15
         BIN   MCHRG31
         LABEL 'L REG PTY CHK','INC/DEC CHK'
         LINE  ,(40,1),SKIP=2
         LABEL 'MACHINE CHECK REGISTER B'
         LINE  ,(14,62),SKIP=2
         LABEL 'BYTE 0','BYTE 2'
         LINE  (38,60),(1,59),SKIP=1
         BIN   MCHRGB00
         BIN   MCHRGB16
         LABEL 'STORAGE ADD CHK','I CYCLE HARD ERROR'
         LINE
         BIN   MCHRGB01
         BIN   MCHRGB17
         LABEL 'SDBI PTY CHK','DOUBLE ECC ERROR'
         LINE
         BIN   MCHRGB02
         BIN   MCHRGB18
         LABEL 'SDBO PTY CHK','02I CTRL LINE PTY CHK'
         LINE
         BIN   MCHRGB03
         BIN   MCHRGB19
         LABEL 'STORE PTY CHK','MULTIPLY CHK'
         LINE
         BIN   MCHRGB04
         BIN   MCHRGB20
         LABEL 'COUNT CHK','SHIFT LOAD CHK'
         LINE
         BIN   MCHRGB05
         BIN   MCHRGB21
         LABEL 'STORAGE PROT STACK PTY CHK','DOUBLE ECC ERROR'
         LINE
         BIN   MCHRGB06
         BIN   MCHRGB22
         LABEL 'CLOCK SYN CHK A','SINGLE ECC ERROR'
         LINE  (38,60),(1,59),SKIP=2
         BIN   MCHRGB07
         BIN   MCHRGB23
         LABEL 'CLOCK SYN CHK B','SINGLE DATA BIT CORRCT'
         LINE  ,(14,62),SKIP=2
         LABEL 'BYTE 1','BYTE 3'
         LINE  (38,60),(1,59),SKIP=1
         BIN   MCHRGB08
         BIN   MCHRGB24
         LABEL 'M REG COMP A CHK','02I CT ERROR CORRCT'
         LINE
         BIN   MCHRGB09
         BIN   MCHRGB25
         LABEL 'M REG COMP B CHK','C32 DATA BIT CORRCT'
         LINE
         BIN   MCHRGB10
         BIN   MCHRGB26
         LABEL 'M REG COMP C CHK','C16 DATA BIT CORRCT'
         LINE
         BIN   MCHRGB11
         BIN   MCHRGB27
         LABEL 'M REG COMP D CHK','C8 DATA BIT CORRCT'
         LINE
         BIN   MCHRGB12
         BIN   MCHRGB28
         LABEL 'NO RELOCATE REGISTER MATCH','C4 DATA BIT CORRCT'
         LINE
         BIN   MCHRGB13
         BIN   MCHRGB29
         LABEL 'MULT RELOCATE REG MATCH','C2 DATA BIT CORRCT'
         LINE
         BIN   MCHRGB14
         BIN   MCHRGB30
         LABEL 'RELOCATE LRU INVALID','C1 DATA BIT CORRCT'
         LINE  (38,60),(1,59),SKIP=2
         BIN   MCHRGB15
         BIN   MCHRGB31
         LABEL 'ANY MACH CHK ON','C0 DATA BIT CORRCT'
         EJECT
         DC    X'01000B8B00'
         LABEL ''
         LINE  ,(14,62),SKIP=2
         LABEL 'RETRY COUNTS','RETRY REGS 1,2'
         LINE  (38,60),(1,59)
         BIN   RETCNT2H
         HEX   RTYREG1
         LABEL 'RETRIES PER CURRENT MACRO','ABRTY REG'
         LINE  (38,60),(1,59)
         HEX   NONRETRY
         HEX   RTYREG2
         LABEL 'NUMBER OF MACROS RETRIED','SPTLB REG'
         LINE  ,(14,62),SKIP=2
         LABEL 'HMRTY REG','CPURTY REG'
         LINE  (38,60),(1,59),SKIP=1
         BIN   HREG0
         BIN   RTYRG404
         LABEL 'MACHINE CHECK TRAP','DEST BYTE LINE 0'
         LINE
         BIN   HREG1
         BIN   RTYRG405
         LABEL 'RETRY TRAP','DEST BYTE LINE 1'
         LINE
         BIN   HREG2
         BIN   RTYRG406
         LABEL 'CPU HIGH TRAP','DEST BYTE LINE 2'
         LINE
         BIN   HREG3
         BIN   RTYRG407
         LABEL 'INT FILE ADPTR OR SEL CHN 1,2 OR 3','DEST BYTE LINE 3'
         LINE
         BIN   HREG4
         LABEL 'SEL CHN 1,2,3(IF IFA) OR SEL CHN 4','RETRY FLAGS'
         LINE  (38,60),(1,59)
         BIN   HREG5
         BIN   RTYRG408
         LABEL 'MPX TRAP','STORAGE 2 CYCLE ERROR'
         LINE
         BIN   HREG6
         BIN   RTYRG409
         LABEL 'INT FILE ADAPTR TRAP','TYPE 1 ERROR'
         LINE
         BIN   HREG7
         BIN   RTYRG410
         LABEL 'STORE-DISPLAY','TYPE 2 ERROR'
         LINE  (98,1),(59,1)
         BIN   RTYRG411
         LABEL ' ','TYPE 3 ERROR'
         LINE  (38,60),(1,59)
         ROUTINE REGUNU,SKIPPER
         BIN   RTYRG412
         LABEL 'CTRL WORD ADDR AT TIME','LOCAL(0) OR EXT REG(1) DEST'
         LINE  (34,4),(1,59)
         ROUTINE RETRG23,HILO
         HEX   RETRG23
         ROUTINE RETRG23,RETRYCNT
         BIN   RTYRG413,B7
         ROUTINE RETRG23,RESHILO
         LABEL 'OF FAILURE','STORAGE WORD IN ERROR'
         LINE  (98,1),(60,1)
         BIN   RTYRG414
         LABEL 'ERROR IN TRAP 2 CYCLE'
         LINE
         BIN   RTYRG415
         LABEL 'SINGLE BIT ERROR-SEL SHARE 2 CYCLE'
         LINE  ,(5,55)
         LABEL 'CONTROL WORD','LOCAL STORAGE DEST'
         LINE  (12,86),(64,1)
         HEX   CTRLDWD
         BIN   RTYRG417
         LABEL ' ','YYY'
         LINE  (98,1),(65,)
         BIN   RTYRG420
         LABEL 'XXX'
         LINE  (98,1),(60,1),SKIP=2
         BIN   RTYEXP
         LABEL 'LOCAL STORE(0) OR EXP LOCAL STORE(1)'
         LINE  ,(60,1),SKIP=1
         LABEL 'EXTERNAL REGISTER DEST'
         LINE  (98,1),(65,1)
         BIN   RTYRG425
         LABEL 'YYY'
         LINE  (98,1),(65,1),SKIP=2
         BIN   RTYRG428
         LABEL 'XXX'
         LINE  ,(40,1),SKIP=2
         LABEL 'SYSTEM REGISTER'
         LINE  ,(14,62),SKIP=2
         LABEL 'BYTE 0','BYTE 2'
         LINE  (38,60),(1,59),SKIP=1
         BIN   SYSREG00
         BIN   SYSREG16
         LABEL 'MACHINE CHK INTERPT PENDING','ENABLE CLEAR SWITCH'
         LINE
         BIN   SYSREG01
         BIN   SYSREG17
         LABEL 'RETRY ROUTINE','TMPL'
         LINE
         BIN   SYSREG02
         BIN   SYSREG18
         LABEL 'MACHINE CHK ROUTINE','LOAD FILE WAIT'
         LINE
         BIN   SYSREG03
         BIN   SYSREG19
         LABEL 'DOCUMENTARY CONSOLE 2','CE KEY IN CE MODE'
         LINE
         BIN   SYSREG04
         BIN   SYSREG20
         LABEL 'LOG PRESENT','IPL'
         LINE
         BIN   SYSREG05
         BIN   SYSREG21
         LABEL 'SPARE','POWER ON RESET'
         LINE
         BIN   SYSREG06
         BIN   SYSREG22
         LABEL 'I/O INSTN LATCH','SPARE'
         LINE  (38,60),(1,59),SKIP=2
         BIN   SYSREG07
         BIN   SYSREG23
         LABEL 'FORCE MODULE 0 TO LSCS','INSTR PROC LATCH'
         LINE  ,(14,62),SKIP=2
         LABEL 'BYTE 1','BYTE 3'
         LINE  (38,60),(1,59),SKIP=1
         BIN   SYSREG08
         BIN   SYSREG24
         LABEL 'ADDR CONTENTS','MACHINE CHECK TRAP'
         LINE
         BIN   SYSREG09
         BIN   SYSREG25
         LABEL 'CPU INTRPT FORCE','RETRY TRAP'
         LINE
         BIN   SYSREG10
         BIN   SYSREG26
         LABEL 'SAR INTRPT FORCE','CPU HIGH TRAP'
         LINE
         BIN   SYSREG11
         BIN   SYSREG27
         LABEL 'PSW RESTART','INT FILE ADAPTR OR SEL CHN 1,2 OR 3'
         LINE
         BIN   SYSREG12
         BIN   SYSREG28
         LABEL 'EC MODE','SEL CHN 1,2,3(IF IFA) OR SEL CHN 4'
         LINE
         BIN   SYSREG13
         BIN   SYSREG29
         LABEL 'SYS CTRL INTRPT','MPX TRAP'
         LINE
         BIN   SYSREG14
         BIN   SYSREG30
         LABEL 'TIMER INTRPT FORCE','INT FILE ADAPTR TRAP'
         LINE  (38,60),(1,59),SKIP=1
         BIN   SYSREG15
         BIN   SYSREG31
         LABEL 'PRTY INTRUPT','STORE-DISPLAY'
         EJECT
         DC    X'01000B8B00'
         LABEL ''
         LINE  ,(40,1),SKIP=2
         LABEL '--- LOCAL STORAGE REGISTERS'
         LINE  ,(14,53),SKIP=2
         LABEL 'I REGISTER','U REGISTER'
         LINE  (23,74),(1,59),SKIP=1
         HEX   IREG
         BIN   UREGA1
         LABEL 'KEY','INSTR LENGTH CODE'
         LINE
         HEX   IREGB
         BIN   UREGA2
         LABEL 'INSTR ADDR','CONDITION CODE'
         LINE  (97,1),(60,1)
         BIN   UREGA3
         LABEL 'PROGRAM MASK'
         LINE
         BIN   UREGA4
         LABEL 'SPECIAL CPU USE'
         LINE
         BIN   UREGA5
         LABEL 'AMWP BITS'
         LINE
         HEX   UREGC1
         LABEL 'OP CODE'
         LINE  (97,1),(60,1),SKIP=2
         HEX   UREGC2
         LABEL 'IMMEDIATE BYTE'
         LINE  ,(5,35),SKIP=2
         LABEL 'NP REGISTER','CPU REGISTER','---  PSWCTL REGISTER ---'
         LINE  (25,30),(1,30),SKIP=1
         HEX   NPRGXST
         BIN   CPUREG00
         BIN   PSWCTL01
         BIN   PSWCTL12
         LABEL 'LAST VIRTUAL ADDRESS','HARD STOP LATCH','EVR MSK',     C
               'EC MODE'
         LINE
         BIN   EXPDST00
         BIN   CPUREG02
         BIN   PSWCTL05
         BIN   PSWCTL13
         LABEL 'RELOCATE MODE','ENABLE HARD RETRY','TRANS MODE',       C
               'MACH CHK MSK'
         LINE
         BIN   EXPDST01
         BIN   CPUREG03
         BIN   PSWCTL06
         BIN   PSWCTL14
         LABEL 'FORMAT CHK','SG BIT FAIL M STOR','I/O MASTER MSK',     X
               'WAIT STATE'
         LINE
         BIN   EXPDST02
         BIN   CPUREG04
         BIN   PSWCTL07
         BIN   PSWCTL15
         LABEL 'SPARE','SG BIT FAIL CT STOR','EXT MASTER MSK',         C
               'PROB STATE'
         LINE
         BIN   EXPDST03
         BIN   CPUREG05
         BIN   PSWCTL16
         BIN   PSWCTL24
         LABEL '1 MEG SEGMENT','THRESH MODE CT STOR','TIMER MSK',      C
               'MPX CCH MSK'
         LINE
         BIN   EXPDST04
         HEX   CPUREG16
         BIN   PSWCTL17
         BIN   PSWCTL25
         LABEL '4K PAGE SIZE','LST T+S CONS FILE','INTERRUPT KEY MASK',C
               'CHAN 1 MSK'
         LINE
         BIN   EXPDST05
         HEX   NEWRELTB
         BIN   PSWCTL18
         BIN   PSWCTL26
         LABEL 'LOCAL MODE','RELOC TABLE LAST USED','EXT SIGNAL MSK',  C
               'CHAN 2 MSK'
         LINE
         BIN   EXPDST06
         HEX   OLDRELTB
         ROUTINE FDUM8,SKIPPER
         BIN   PSWCTL27
         LABEL 'SEGMENT NUMBER INVALID','RELOC MATCH REG','',          C
               'CHAN 3 MASK'
         LINE
         BIN   EXPDST07
         ROUTINE FDUM8,SKIPPER     A45391
         ROUTINE FDUM8,SKIPPER
         BIN   PSWCTL28
         LABEL 'RESET TABLE','','','CHAN 4 MASK'
         LINE  (25,1)
         BIN   EXPDST08
         LABEL 'PAGE INVALID'
         LINE
         BIN   EXPDST09
         LABEL 'SEGMENT VALID'
         LINE
         BIN   EXPDST10
         LABEL 'PAGE NUMBER INVALID'
         LINE
         BIN   EXPDST11
         LABEL 'PAGE FORMAT INVALID'
         LINE  (25,1),SKIP=3
         BIN   EXPDST12
         LABEL 'EXECUTED INSTRUCTION'
         LINE  ,(5,35),SKIP=1
         LABEL 'X REGISTER','R REGISTER','Y REGISTER','Q REGISTER'
         LINE  (8,35),(1,1),SKIP=2
         HEX   XREG
         HEX   RREG
         HEX   YREG
         HEX   QREG
         LABEL ''
         LINE  ,(5,35),SKIP=1
         LABEL 'IBU REGISTER','TR REGISTER','SN REGISTER','PN REGISTER'
         LINE  (8,35),(1,1),SKIP=2
         HEX   IBUG
         HEX   TRRG
         HEX   SNRB
         HEX   RLPAGE
         LABEL ''
         LINE  ,(5,35),SKIP=1
         LABEL 'WK REGISTER','DM REGISTER','RW REGISTER','V REGISTER'
         LINE  (8,35),(1,1),SKIP=2
         HEX   WKRG
         HEX   DMREG
         HEX   RWREG
         HEX   VREG
         LABEL ''
         LINE  ,(5,35),SKIP=1
         LABEL 'W REGISTER','SHHI REGISTER','SHLO REGISTER'
         LINE  (8,35),(1,1),SKIP=5
         HEX   WREG
         HEX   SHHI
         HEX   SHLO
         LABEL ''
         DC    X'01000B8B00'
         LABEL ''
         LINE  ,(5,1),SKIP=2
         LABEL 'SHCTL SHIFTER CONTROL REGISTER'
         LINE  ,(5,70),SKIP=1
         LABEL '--BYTE 0--','--BYTE 2--'
         LINE  (30,70),(5,70)
         BIN   SHCTL00
         HEX   SHCTL20
         LABEL 'RESULT CODE','T REGISTER BUFFER'
         LINE  (30,1),(5,1)
         BIN   SHCTL02
         LABEL 'BIT SHIFT AMOUNT'
         LINE  (30,1),(5,1)
         BIN   SHCTL04
         LABEL 'DIGIT SHIFT AMOUNT'
         LINE  ,(5,70)
         LABEL '--BYTE 1--','--BYTE 3--'
         LINE  (30,70),(5,70)
         BIN   SHCTL10
         HEX   SHCTL30,0,1L
         LABEL 'SPARE','UNUSED'
         LINE  (30,70),(5,70)
         BIN   SHCTL11
         HEX   SHCTL30,0,1R
         LABEL 'SPARE','MULTIPLICAN LOW DIGIT'
         LINE  (30,1),(5,1)
         BIN   SHCTL12
         LABEL 'MULTIPLY CONTROLS'
         LINE  (30,1),(5,1)
         BIN   SHCTL14,2,4
         LABEL 'SHIFT CONTROLS'
EJCT     DC    X'01000B8B00'
         LABEL ''
         LINE  ,(30,),SKIP=2
         ROUTINE FDUM8,SKIPPER
         LABEL 'MACHINE CHECK STATUS FIELD'
         LINE  ,
         ROUTINE XRELN,VS2TEST2
         LABEL ''
         LINE  (41,),(1,),SKIP=1
         HEX   DARLNGTH,0,2B
         LABEL 'MCSTATD FIELD LENGTH'
         LINE  ,(5,)
         ROUTINE FDUM8,SKIPPER
         LABEL '--- SYSTEM STATUS ---'
         LINE  (35,35),(1,40)
         BIN   SYSSTAT0
         BIN   SYSSTAT1
         LABEL 'HARDWARE RECOVERY','SOFTWARE RECOVERY'
         LINE
         BIN   SYSSTAT2
         BIN   SYSSTAT3
         LABEL 'TASK ABORTED','TASK SET NON-DISPATCHABLE'
         LINE
         BIN   SYSSTAT4
         BIN   SYSSTAT5
         LABEL 'OPERATING SYSTEM TERMINATION','QUIET MODE IN EFFECT'
         LINE  ,(5,)
         ROUTINE FDUM8,SKIPPER
         LABEL '--- DAMAGE AREA ---'
         LINE  ,(1,40)
         BIN   AREADT0
         BIN   AREADT1
         LABEL 'MAIN STORAGE','BUFFER'
         LINE
         BIN   AREADT2
         BIN   AREADT3
         LABEL 'CONTROL STORAGE','INTERVAL TIMER'
         LINE
         BIN   AREADT4
         BIN   AREADT5
         LABEL 'PROCESSOR','CHANNEL ERROR'
         LINE
         BIN   AREADT6
         BIN   AREADT7
         LABEL 'TOD CLOCK','SYSTEM DAMAGE'
         LINE  ,(5,)
         ROUTINE FDUM8,SKIPPER
         LABEL '--- ERROR TYPE ---'
         LINE  ,(1,40)
         BIN   ERRTYPE0
         BIN   ERRTYPE1
         LABEL 'INTERMITTENT','SOLID'
         LINE
         BIN   ERRTYPE2
         BIN   ERRTYPE3
         LABEL 'DATA','RESERVED'
         LINE
         BIN   ERRTYPE4
         BIN   ERRTYPE5
         LABEL 'RESERVED','PROTECT'
         LINE  ,(5,)
         ROUTINE FDUM8,SKIPPER
         LABEL '--- RMS ACTION DATA ---'
         LINE  ,(1,40)
         BIN   RMSACTN0
         BIN   RMSACTN1
         LABEL 'LOOP TIME OUT','REPAIR'
         LINE
         BIN   RMSACTN2
         BIN   RMSACTN3
         LABEL 'STORAGE RECONFIGURE','BUFFER RECONFIGURE'
         LINE  ,(5,)
         ROUTINE FDUM8,SKIPPER
         LABEL '--- RMS INFORMATION STATUS ---'
         LINE  ,(1,40)
         BIN   RMSINFO0
         BIN   RMSINFO1
         LABEL 'RESERVED','INVALID MCI CODE'
         LINE
         BIN   RMSINFO2
         BIN   RMSINFO3
         LABEL 'INVALID FAILING STORAGE ADDRESS','PROGRAM CHECK IN MCH'
         LINE  ,(5,),SKIP=1
         ROUTINE FDUM8,SKIPPER
         LABEL '--- HISTORY OF TRANSIENT MODULES ---'
         LINE  (1,15)
         HEX   TRNSMOD0,1,4B
         HEX   TRNSMOD1,1,4B
         HEX   TRNSMOD2,1,4B
         HEX   TRNSMOD3,1,4B
         LABEL ''
         LINE  ,,SKIP=2
         HEX   TRNSMOD4,1,4B
         HEX   TRNSMOD5,1,4B
         HEX   TRNSMOD6,1,4B
         HEX   TRNSMOD7,1,4B
         LABEL ''
         LINE  ,(5,),SKIP=1
         LABEL '--- PDAR ACTION ---'
         LINE  (35,35),(1,40)
         BIN   MCHPDR00
         BIN   MCHPDR01
         LABEL 'TERMINATION OF CURRENT TASK','RETRY POSSIBLE'
         LINE
         BIN   MCHPDR02
         BIN   MCHPDR03
         LABEL 'BYPASS(AFFECTED TASK) POSSIBLE','REPAIR UNSUCCESSFUL'
         LINE
         BIN   MCHPDR04
         BIN   MCHPDR05
         LABEL 'INDETERMINATE INSTRUCTION COUNTER','RESERVED'
         LINE  ,(5,)
         LABEL '--- FAILURE TYPE ---'
         LINE  ,(1,40)
         BIN   MCHPDR10
         BIN   MCHPDR11
         LABEL 'SOLID STORAGE DATA ERROR','INTERMITTENT STOR. DATA ERR'
         LINE
         BIN   MCHPDR12
         BIN   MCHPDR13
         LABEL 'SOLID SPF KEY ERROR','INTERMITTENT SPF KEY ERROR'
         LINE  ,(5,)
         LABEL '--- OPERATING SYSTEM STATUS ---'
         LINE  ,(1,40)
         BIN   MCHPDR20
         BIN   MCHPDR21
         LABEL 'WAIT PSEUDO TASK','PAGE SUPERVISOR TASK'
         LINE
         BIN   MCHPDR22
         BIN   MCHPDR23
         LABEL 'MASTER SCHEDULER TASK','SYSTEM TASK'
         LINE
         BIN   MCHPDR24
         BIN   MCHPDR25
         LABEL 'PROBLEM PROGRAM TASK','CURRENT PSW DISABLED FOR I/O'
         LINE  ,(5,)
         LABEL '--- LOCATION OF FAILURE ---'
         LINE  ,(1,40)
         BIN   MCHPDR30
         BIN   MCHPDR31
         LABEL 'NUCLEUS','SQA AREA'
         LINE
         BIN   MCHPDR32
         BIN   MCHPDR33
         LABEL 'LSQA AREA','PQA'
         LINE
         BIN   MCHPDR34
         BIN   MCHPDR35
         LABEL 'PAGEABLE AREA','FIXED PAGE AREA'
         LINE
         BIN   MCHPDR36
         BIN   MCHPDR37
         LABEL 'V=R ADDRESS AREA','CRITICAL AREA'
         LINE  ,(5,)
         LABEL '--- REQUESTED OPERATOR AWARENESS ---'
         LINE  ,(1,40)
         BIN   MCHPDR50
         BIN   MCHPDR51
         LABEL 'SUPERVISOR DAMAGE MESSAGE','TASK ABNORM TERMINATION MSGC
               '
         LINE
         BIN   MCHPDR52
         BIN   MCHPDR53
         LABEL 'DAMAGED PAGE NOW UNAVAILABLE MSG','DAMAGED PAGE NOW DELC
               ETED MSG'
         LINE
         BIN   MCHPDR54
         BIN   MCHPDR55
         LABEL 'TASK NON-DISPATCHABLE MESSAGE','SOFTWARE RECOVERY MESSAC
               GE'
         LINE  ,(5,)
         LABEL '--- FOOTPRINTS ---'
         LINE  ,(1,40)
         BIN   MCHPDR60
         BIN   MCHPDR61
         LABEL 'CHANGE BIT ACTIVE','KEY IN EXTERNAL PAGE TABLE'
         LINE
         BIN   MCHPDR62
         BIN   MCHPDR63
         LABEL 'PAGE RECURSION','PAGE FIX ACTIVE IN LOW END'
         LINE
         BIN   MCHPDR64
         BIN   MCHPDR65
         LABEL 'TRANSLATE ERROR','NO PAGE EXISTS'
         LINE
         BIN   MCHPDR66
         BIN   MCHPDR67
         LABEL 'RELOCATE OFF','LOW END INTERFACE ACTIVE'
         DC    X'01000B8B00'
         LABEL ''
         LINE  ,(5,)
         LABEL '--- FOOTPRINTS - INTERFACES ---'
         LINE  ,(1,40)
         BIN   MCHPDR70
         BIN   MCHPDR71
         LABEL 'ABTERM INTERFACE ACTIVE','TRANSLATE INTERFACE ACTIVE'
         LINE
         BIN   MCHPDR72
         BIN   MCHPDR73
         LABEL 'FIND PAGE INTERFACE ACTIVE','PAGE DEQUEUE INTERFACE ACTC
               .'
         LINE
         BIN   MCHPDR74
         BIN   MCHPDR75
         LABEL 'PAGE ENQUEUE INTERFACE ACTIVE',                        C
               'STAT FUNCTION INTERFACE ACT.'
         LINE  ,,SKIP=2
         BIN   MCHPDR76
         BIN   MCHPDR77
         LABEL 'V=R RELEASE INTERFACE ACTIVE','POST INTERFACE ACTIVE'
         LINE  (45,1),(1,),SKIP=1
         HEX   MCHFSAR,0,4B
         LABEL 'FAILING STORAGE REAL ADDRESS'
         LINE
         HEX   MCHFSAV,0,4B
         LABEL 'BEGINNING FAILING STORAGE VIRTUAL ADDRESS'
         LINE
         HEX   MCHFSEAV,0,4B
         LABEL 'ENDING FAILING STORAGE VIRTUAL ADDRESS'
         LINE
         HEX   MCHPDARI,0,4B
         LABEL 'INSTRUCTION ADDRESS AT FAILURE'
         LINE  ,,SKIP=1
         HEX   MCHTCBCU,0,4B
         LABEL 'CURRENT TCB POINTER'
         LINE  ,
         ROUTINE XRELN,JUMP
         LABEL ''
LINE2    LINE  (41,1),(1,1),SKIP=2
         HEX   RECLNT
LAB2     LABEL 'RECORD LENGTH'
         LINE  ,
         HEX   WAITST
         LABEL 'WAIT STATE'
         LINE  ,(52,),SKIP=2
         ROUTINE XRELN,SKIPPER
         LABEL 'MACHINE-CHECK-ERROR INDICATORS'
         LINE  (5,35),(1,31)
         ROUTINE XRELN,SKIPPER
         LABEL 'TERMINAL ERROR FLAGS','HARD-MACHINE ERROR FLAGS',      X
               'INTERMEDIATE ERROR','SOFT-MACHINE-ERROR FLAGS'
         LINE  (26,31),(1,31),SKIP=1
         BIN   (MCETEF0),(MCEMEF0),(MCEIEF0),(MCESEF0)
         LABEL 'RESERVED','ASSUMED HD ERR FLG','RESERVED',             X
               'ASSUMED SOFT ERROR'
         LINE  ,
         BIN   (MCETEF1),(MCEMEF1),(MCEIEF1),(MCESEF1)
         LABEL 'RESERVED','RESERVED','RESERVED','RESERVED'
         LINE  ,
         BIN   (MCETEF2),(MCEMEF2),(MCEIEF2),(MCESEF2)
         LABEL 'THRESHOLD REACHED','RESERVED','RESERVED','RESERVED'
         LINE  ,
         BIN   (MCETEF3),(MCEMEF3),(MCEIEF3),(MCESEF3)
         LABEL 'SECONDARY ERROR FLAG','SYSTEM DAMAGE FLAG',   @XA20543 *
               'RESERVED','RESERVED'
         LINE  ,
         BIN   (MCETEF4),(MCEMEF4),(MCEIEF4),(MCESEF4)
         LABEL 'CHECK STOP FLAG','REG/PSW INVALID FLAG',               X
               'TOD CLOCK ERROR FLAG','EXT DAMAGE FLAG'
         LINE  ,
         BIN   (MCETEF5),(MCEMEF5),(MCEIEF5),(MCESEF5)
         LABEL 'POWER WARNING FLAG','HARD STOR. ERR. FLAG',            X
               'CLOCK COMP ERR. FLAG','ECC CORR. STOR. ERR.'
         LINE  ,
         BIN   (MCETEF6),(MCEMEF6),(MCEIEF6),(MCESEF6)
         LABEL 'RESERVED','HARD PROTECT. KEY ERR.',           @XA20543 *
               'CPU TIMER ERR. FLAG','HIR CORR. PROC ERR FG'
         LINE  ,SKIP=2
         BIN   (MCETEF7),(MCEMEF7),(MCEIEF7),(MCESEF7)
         LABEL 'INVALID LOGOUT FLAG','INST. PROC. DAMAGE FLAG',        X
               'INTERVAL TIMER ERR. FLAG','BUFFER ERR. FLAG'
         LINE  ,(30),SKIP=2
         ROUTINE XRELN,SKIPPER
         LABEL 'PROGRAM DAMAGE ASSESSMENT AND REPAIR'
         LINE  (30,32),(1,35),SKIP=2
         ROUTINE XRELN,SKIPPER
         LABEL 'PDAR DATA','STOR. RECONFIG. STATUS',                   X
               'STORAGE RECONFIG. STATUS'
         LINE  (26,32),(1,32),SKIP=1
         BIN   (PDAR00),(PDAR10),(PDAR20)
         LABEL 'RESERVED','RESERVED','FR OFF LN/SCHED OFF LN'
         LINE  ,
         BIN   (PDAR01),(PDAR11),(PDAR21)
         LABEL 'RESERVED','RESERVED','INTERCEPT'
         LINE  ,
         BIN   (PDAR02),(PDAR12),(PDAR22)
         LABEL 'RESERVED','RESERVED','PERM. ERR. IN FRAME'
         LINE  ,
         BIN   (PDAR03),(PDAR13),(PDAR23)
         LABEL 'STORAGE RECONFIG.','RESERVED',                         X
               'FRAME-PERM. RES. SYS.'
         LINE  ,
         BIN   (PDAR04),(PDAR14),(PDAR24)
         LABEL 'STOR REFIG STST AVAIL.','RESERVED','FRAME USE SQA'
         LINE  ,
         BIN   (PDAR05),(PDAR15),(PDAR25)
         LABEL 'STOR REFIG. NOT ATTEMP.','RESERVED','FRAME USE LSQA'
         LINE  ,
         BIN   (PDAR06),(PDAR16),(PDAR26)
         LABEL 'RESERVED','STOR ERR SET IN FRAME','FRAME-FIXED PG DATA'
         LINE  ,,SKIP=2
         BIN   (PDAR07),(PDAR17),(PDAR27)
         LABEL 'RESERVED','FRAME-CHG IND. ON','FRAME-IS V=R OR SCHED.'
         LINE  (25,30),(1,),SKIP=2
         HEX   WDSIZE
         LABEL 'PHYSICAL WORD LENGTH'
         LINE  ,,SKIP=1
         ROUTINE XRELN,VS2TEST3
         LABEL ''
         DC    X'FF'
         DC    X'1B8'
         DC    XL2'30'
         DC    XL2'0'
DUMPCODE DC    X'FF'
         DC    X'0208'
         DC    XL2'30'
         DC    XL2'0'
SHORTREC DC    X'FF'
         DC    XL2'80'
         DC    XL2'30'
         DC    XL2'0'
SHTVS2   DC    X'FF'
         DC    XL2'30'
         DC    XL2'30'
         DC    XL2'0'
LABAREA  EQU   *
         LSTART
         END

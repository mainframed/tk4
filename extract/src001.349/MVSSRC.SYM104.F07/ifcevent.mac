         TITLE 'IFCEVENT-EVENT HISTORY PROCESSING                      *
                        '
IFCEVENT CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCEVENT  78.251'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  LA    @11,4095(,@10)                                      0001
         LA    @12,4095(,@11)                                      0001
         USING @PSTART,@10                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@12                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         B     @PB00002                                            0198
TEMPLATE STM   @14,@12,@SA00002                                    0198
*  SPACING = UPSPACE;                                      /*@Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0199
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0200
*  SPACING = DOUBLE;                                       /*@Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0201
*  TOPTEMP = LINE01;             /*MOVE THE TOP LINE OF TEMPLATE IN  */
         MVC   TOPTEMP(23),LINE01                                  0202
*  CALL PRINTIT;                 /*PRINT OUT THE HEADING FOR TEMPLATE*/
         BAL   @14,PRINTIT                                         0203
*  DO N = 1 BY 1 TO 9;           /*PRINT 9 PAIR OF LINES     @Z427VLS*/
         LA    @06,1                                               0204
         ST    @06,N                                               0204
@DL00204 DS    0H                                                  0205
*    GEN(MVI  TIME1,X'40');                                /*@Z427VLS*/
         MVI  TIME1,X'40'
*    GEN(MVC  TIME1+1(130),TIME1);                         /*@Z427VLS*/
         MVC  TIME1+1(130),TIME1
*    SPACING = SINGLE;                                     /*@Z427VLS*/
         MVC   SPACING(1),SINGLE                                   0207
*    CALL PRINTIT;               /*PRINT SEPT LINE           @Z427VLS*/
         BAL   @14,PRINTIT                                         0208
*    LINE002 = LINE02;           /*MOVE COMMON PART OF LINE IN       */
         MVC   LINE002(20),LINE02                                  0209
*    R8 = ADDRTAB1(N);           /*WHERE THE DATA IS AT      @Z427VLS*/
         L     @06,N                                               0210
         SLA   @06,2                                               0210
         L     R8,ADDRTAB1-4(@06)                                  0210
*    R9 = NUMCHAR1(N);           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/
         L     R9,NUMCHAR1-4(@06)                                  0211
*    GEN(EX   R9,EXECMVC);       /*EXEC THE MOVE CHAR        @Z427VLS*/
         EX   R9,EXECMVC
*    SPACING = DOUBLE;                                     /*@Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0213
*    CALL PRINTIT;               /*GO PRINT THE DATA         @Z427VLS*/
         BAL   @14,PRINTIT                                         0214
*    DUPLICAT  = LINE04;         /*MOVE IN THE COMMON PART OF MESSAGE*/
         MVC   DUPLICAT(33),LINE04                                 0215
*    R8 = ADDRTAB2(N);           /*SET UP WHERE THE DATA IS  @Z427VLS*/
         L     @06,N                                               0216
         SLA   @06,2                                               0216
         L     R8,ADDRTAB2-4(@06)                                  0216
*    R9 = NUMCHAR2(N);           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/
         L     R9,NUMCHAR2-4(@06)                                  0217
*    GEN(EX    R9,EXECMVC2);     /*EXEC THE MVC INSTRUCTION  @Z427VLS*/
         EX    R9,EXECMVC2
*    SPACING = DOUBLE;           /*SET TO SINGLE SPACE ON THIS LINE  */
         MVC   SPACING(1),DOUBLE                                   0219
*    CALL PRINTIT;               /*GO RPINT THE BUFFER       @Z427VLS*/
         BAL   @14,PRINTIT                                         0220
*   END;                                                   /*@Z427VLS*/
         LA    @06,1                                               0221
         AL    @06,N                                               0221
         ST    @06,N                                               0221
         C     @06,@CF00085                                        0221
         BNH   @DL00204                                            0221
*   SPACING = SINGLE;                                      /*@Z427VLS*/
         MVC   SPACING(1),SINGLE                                   0222
*   MDROBRLN = MDRLINE;          /*SET UP SECOND HALF OF OUTPUT      */
         MVC   MDROBRLN(35),MDRLINE                                0223
*   CALL PRINTIT;                /*GO PRINT THE THIRD LINE FOR THIS  */
         BAL   @14,PRINTIT                                         0224
*    GENERATE DATA;                                        /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
@EL00002 DS    0H                                                  0226
@EF00002 DS    0H                                                  0226
@ER00002 LM    @14,@12,@SA00002                                    0226
         BR    @14                                                 0226
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL CONVERT THE BINARY NUMBER IN ITEM BINWORD TO   */
*/*    PRINTABLE IF THE NUMBER (CONVERTED) IS > THAN THE NUMBER OF   */
*/*    CHARACTERS REQUESTED (IN ITEM BNDECNUM) A NINE WILL BE PLACED */
*/*    IN EACH PRINT POSITION                                @Z427VLS*/
*/*                                                          @Z427VLS*/
*CONVBIN:  PROC;                                           /*@Z427VLS*/
CONVBIN  STM   @14,@12,@SA00003                                    0227
* R8 = BINWORD;                  /*LOAD THE ITEM TO CONVERT  @Z427VLS*/
         L     R8,BINWORD                                          0228
* GEN(CVD   R8,DBLWORD);         /*CONVERT THE NUMBER        @Z427VLS*/
         CVD   R8,DBLWORD
* GEN(UNPK   WORK(8),DBLWORD);   /*UNPACK THE CONVERTED NUMBER       */
         UNPK   WORK(8),DBLWORD
* GEN(OI    WORK+7,X'F0');       /*INSURE SIGN IS NO PROBLEM @Z427VLS*/
         OI    WORK+7,X'F0'
* SWITCH2 = OFF;                 /*CLEAR THE SWITCH PRIOR TO START   */
         NI    SWITCH2,B'10111111'                                 0232
* DO L = 1 BY 1 TO 7 WHILE (SWITCH2 = OFF);                /*@Z427VLS*/
         LA    @06,1                                               0233
         ST    @06,L                                               0233
@DL00233 TM    SWITCH2,B'01000000'                                 0233
         BNZ   @DC00233                                            0233
*  IF WORKOVER(L)  = 'F0'X       /*IS IT A 0 IF SO MAKE IT A BLANK   */
*    THEN                                                          0234
         LA    @03,WORKOVER-1(@06)                                 0234
         CLI   0(@03),X'F0'                                        0234
         BNE   @RF00234                                            0234
*      WORKOVER(L) = '40'X;      /*SET TO A BLANK            @Z427VLS*/
         LA    @03,WORKOVER-1(@06)                                 0235
         MVI   0(@03),X'40'                                        0235
*    ELSE                                                          0236
*      SWITCH2 = ON;             /*SET SWITCH TO TERMINATE DO LOOP   */
         B     @RC00234                                            0236
@RF00234 OI    SWITCH2,B'01000000'                                 0236
* END;                                                     /*@Z427VLS*/
@RC00234 LA    @06,1                                               0237
         AL    @06,L                                               0237
         ST    @06,L                                               0237
         C     @06,@CF00082                                        0237
         BNH   @DL00233                                            0237
@DC00233 DS    0H                                                  0238
* IF (TEN   - L) > BNDECNUM      /*IS THE CONVERTED NUMBER TO LARGE  */
*    THEN                                                          0238
         L     @06,TEN                                             0238
         SL    @06,L                                               0238
         C     @06,BNDECNUM                                        0238
         BNH   @RF00238                                            0238
*      DO;                                                 /*@Z427VLS*/
*        GEN(MVI   WORKOVER,X'F9');  /*SET FIRST NINE IN THE MEASSAGE*/
         MVI   WORKOVER,X'F9'
*        GEN(MVC   WORKOVER+1(7),WORKOVER);/*FILL WITH NINES @Z427VLS*/
         MVC   WORKOVER+1(7),WORKOVER
*      END;                                                /*@Z427VLS*/
* R8 = ADDR(WORKOVER) + (8-BNDECNUM);/*SET WHERE TO MOVE FROM ADDRESS*/
@RF00238 LA    R8,WORKOVER                                         0243
         L     @06,BNDECNUM                                        0243
         LA    @03,8                                               0243
         SLR   @03,@06                                             0243
         ALR   R8,@03                                              0243
* R9 = BNDECNUM - ONE;           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/
         SL    @06,ONE                                             0244
         LR    R9,@06                                              0244
* RESPECIFY (R6) RESTRICTED;                               /*@Z427VLS*/
* R6 = DECADDR;                  /*ADDRESS TO MOVE TO        @Z427VLS*/
         L     R6,DECADDR                                          0246
* GEN(EX    R9,MVCDATA);         /*MOVE DATA TO REQUESTED LOCATION   */
         EX    R9,MVCDATA
* GENERATE DATA;                                           /*@Z427VLS*/
* RESPECIFY (R6) UNRESTRICTED;                             /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00003 DS    0H                                                  0250
@EF00003 DS    0H                                                  0250
@ER00003 LM    @14,@12,@SA00003                                    0250
         BR    @14                                                 0250
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL CONVERT THE HEX DATA INTO PRINTABLE    @Z427VLS*/
*/*                                                          @Z427VLS*/
*/*    IF IT IS NECESSARY TO CONVERT ONLY 1/2 OF FIRST BYTE(CUA FOR  */
*/*    EXP. THEN THE USER SHOULD SET THE SWITCH1 TO THEON CONDITION  */
*CONVERT: PROC;                                            /*@Z427VLS*/
CONVERT  STM   @14,@12,12(@13)                                     0251
* DO P = NUMBER BY -1 TO 1;      /*# = # OF BYTES TO CONVERT TO PRINT*/
         L     @06,NUMBER                                          0252
         ST    @06,P                                               0252
         B     @DE00252                                            0252
@DL00252 DS    0H                                                  0253
*   R8 = NEXTBYTE(P);            /*LOAD THE NEXT BYTE TO CONVERT     */
         L     @03,NEXTBY                                          0253
         BCTR  @03,0                                               0253
         SLR   R8,R8                                               0253
         IC    R8,NEXTBYTE(@06,@03)                                0253
*   X =  TWO * P;                /*OUTPUT INDEX MUST BE TWICE INPUT  */
         L     @01,TWO                                             0254
         MR    @00,@06                                             0254
         ST    @01,X                                               0254
*   SRDL  (R8,FOUR);             /*MOVE 1/2 IN TO NEXT REG   @Z427VLS*/
         SRDL  R8,4                                                0255
*   SRL   (R9,TWOEIGHT);         /*SHIFT THE REG 28 BITS     @Z427VLS*/
         L     @03,TWOEIGHT                                        0256
         SRL   R9,0(@03)                                           0256
*   R9  =  R9 + NUMBER1;         /*INSURE INDEX BY 0 DOES NOT AFFECT */
         L     @03,NUMBER1                                         0257
         ALR   R9,@03                                              0257
*   R8  =  R8 + NUMBER1;         /*SAME                      @Z427VLS*/
         ALR   R8,@03                                              0258
*   IF SWITCH1 = ON & P = ONE    /*DO WE NOT PUT THE HALF BYTE OUT   */
*    THEN                                                          0259
         TM    SWITCH1,B'10000000'                                 0259
         BNO   @RF00259                                            0259
         C     @06,ONE                                             0259
         BNE   @RF00259                                            0259
*     SWITCH1 = OFF;             /*TURN OFF THE SWITCH       @Z427VLS*/
         NI    SWITCH1,B'01111111'                                 0260
*    ELSE                                                          0261
*     ADDNUM(X-ONE) = CHARS(R8);/*PUT THE PRINT CHAR INTO THE OUTPUT*/
         B     @RC00259                                            0261
@RF00259 L     @06,X                                               0261
         SL    @06,ONE                                             0261
         L     @03,ADDNXT                                          0261
         ALR   @03,@06                                             0261
         BCTR  @03,0                                               0261
         LA    @06,CHARS-1(R8)                                     0261
         MVC   ADDNUM(1,@03),0(@06)                                0261
*     ADDNUM(X)  = CHARS(R9);   /*FINSH THE BYTE             @Z427VLS*/
@RC00259 L     @06,ADDNXT                                          0262
         AL    @06,X                                               0262
         BCTR  @06,0                                               0262
         LA    @03,CHARS-1(R9)                                     0262
         MVC   ADDNUM(1,@06),0(@03)                                0262
* END;                                                     /*@Z427VLS*/
         SLR   @06,@06                                             0263
         BCTR  @06,0                                               0263
         AL    @06,P                                               0263
         ST    @06,P                                               0263
@DE00252 LTR   @06,@06                                             0263
         BP    @DL00252                                            0263
*END;                                                      /*@Z427VLS*/
@EL00004 DS    0H                                                  0264
@EF00004 DS    0H                                                  0264
@ER00004 LM    @14,@12,12(@13)                                     0264
         BR    @14                                                 0264
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL ADD TOTALS OF EACH TYPE RECORD AND PRINT THE   */
*/*    TOTALS                                                @Z427VLS*/
*/*    THIS PROC IS BASED ON THERE BEING 23 MINOR TYPES OF RECORDS   */
*/*    (UNDER THE 9 MAIN) ANY CHANGE IN THE NUMBER OF TYPES WILL     */
*/*    RESULT IN BAD THINGS                                  @Z427VLS*/
*/*    ALL 23 LENGHT ITEMS WILL JUST NEED THERE LENGTH ADJUSTED ALSO */
*/*    THE TYPES WILL NEED ADJUSTING AND THE TYPE COUNTERS THESE ARE */
*/*    NOT IN A TABLE AND START AFTER ITEM NUMCHAR2          @Z427VLS*/
*/*                                                          @Z427VLS*/
*PRTTOTAL:  PROC;                                          /*@Z427VLS*/
PRTTOTAL STM   @14,@12,@SA00005                                    0265
* SPACING = UPSPACE;             /*START ON A FRESH PAGE     @Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0266
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0267
*  SWITCH5 = ON;    /*SET TO UP SPACE DURING TOTALS IF REQ   @0001VLS*/
         OI    SWITCH5,B'00001000'                                 0268
* SPACING = DOUBLE;              /*RESET TO SINGLE SPACING   @Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0269
* Z = ONE;                       /*SET INDEX TO STEP THROUGH @Z427VLS*/
         L     @06,ONE                                             0270
         ST    @06,Z                                               0270
* TOTALHD2 = TOTALHD1;           /*MOVE IN WORDS RECORD TYPES        */
         MVC   TOTALHD2(12),TOTALHD1                               0271
* RESPECIFY (R6) RESTRICTED;                               /*@Z427VLS*/
* R6 = ADDR(TOTALHD3) ;                                    /*@Z427VLS*/
         LA    R6,TOTALHD3                                         0273
* R8 = ADDR(TIME1) + 26;                                   /*@Z427VLS*/
         LA    R8,TIME1                                            0274
         AL    R8,@CF01065                                         0274
* R9 = 7     + SIX * EVNUM;                                /*@Z427VLS*/
         L     @03,EVPTR(,R2)                                      0275
         L     R9,SIX                                              0275
         MH    R9,EVNUM(,@03)                                      0275
         AL    R9,@CF00082                                         0275
* GEN(EX  R9,MOVECHAR);                                    /*@Z427VLS*/
         EX  R9,MOVECHAR
* RESPECIFY (R6) UNRESTRICTED;                             /*@Z427VLS*/
* CALL PRINTIT;                  /*PRINT THE HEADING FOR THE TOTALS  */
         BAL   @14,PRINTIT                                         0278
* SPACING = SINGLE;              /*PRINT THE HEADING FOR THE TOTALS  */
         MVC   SPACING(1),SINGLE                                   0279
* DO J = 1 BY 1 TO 9 ;           /*MAIN LOOP FOR 9 TYPES OF RECORDS  */
         LA    @06,1                                               0280
         ST    @06,J                                               0280
@DL00280 DS    0H                                                  0281
*  DO  WHILE(LETTER(Z) = LETTER1);                         /*@Z427VLS*/
         B     @DE00281                                            0281
@DL00281 DS    0H                                                  0282
*   BNDECNUM = SIX;              /*SET FOR SIX CHARACTERS OUT        */
         L     @06,SIX                                             0282
         ST    @06,BNDECNUM                                        0282
*   TOTALNME = NMETOTAL(Z);      /*WILL MOVE IN 7 CHAR SUBNAME       */
         L     @06,Z                                               0283
         MH    @06,@CH00082                                        0283
         LA    @03,NMETOTAL-7(@06)                                 0283
         MVC   TOTALNME(7),0(@03)                                  0283
*   BINWORD = ZERO;              /*SET TO 0 PRIOR TO START   @Z427VLS*/
         SLR   @06,@06                                             0284
         ST    @06,BINWORD                                         0284
*   DO K = 1 BY 1 TO EVNUM;   /*EVNUM# OF CPUS FOUND THIS JOB  */  0285
         LA    @06,1                                               0285
         ST    @06,K                                               0285
         B     @DE00285                                            0285
@DL00285 DS    0H                                                  0286
*    BINWORD = COUNT(Z,K) + BINWORD;/*ADD UP THE TOTAL THIS SUBTYPE  */
         L     @03,Z                                               0286
         SLA   @03,4                                               0286
         ALR   @03,@06                                             0286
         SLA   @03,2                                               0286
         L     @03,COUNT-68(@03)                                   0286
         AL    @03,BINWORD                                         0286
         ST    @03,BINWORD                                         0286
*   END;                                                   /*@Z427VLS*/
         AL    @06,@CF00054                                        0287
         ST    @06,K                                               0287
@DE00285 L     @03,EVPTR(,R2)                                      0287
         CH    @06,EVNUM(,@03)                                     0287
         BNH   @DL00285                                            0287
*   TOTAL = TOTAL + BINWORD;     /*SAVE TO HAVE THE TOTAL OF THIS LNE*/
         L     @06,BINWORD                                         0288
         L     @03,TOTAL                                           0288
         ALR   @03,@06                                             0288
         ST    @03,TOTAL                                           0288
*   TOTOFTOT = TOTOFTOT + BINWORD;                         /*@Z427VLS*/
         AL    @06,TOTOFTOT                                        0289
         ST    @06,TOTOFTOT                                        0289
*   DECADDR = ADDR(TOTALVAL);    /*SET WHERE TO PUT CONVERTED VALUE  */
         LA    @06,TOTALVAL                                        0290
         ST    @06,DECADDR                                         0290
*   CALL CONVBIN;                /*GO CONVERT THE ITEM TO PRINTABLE  */
         BAL   @14,CONVBIN                                         0291
*   BNDECNUM = FIVE;             /*CHANGE INDIVIDUAL ITEMS TO 5 CHAR */
         L     @06,FIVE                                            0292
         ST    @06,BNDECNUM                                        0292
*   DECADDR = DECADDR + SEVEN;   /*MOVE DOWN THE PRINT LINE BY 7 CHAR*/
         L     @06,DECADDR                                         0293
         AL    @06,SEVEN                                           0293
         ST    @06,DECADDR                                         0293
*   DO K = 1 BY 1 TO EVNUM;   /*SET BY FILTER 4 TO # OF CPUS @Z427VLS*/
         LA    @06,1                                               0294
         ST    @06,K                                               0294
         B     @DE00294                                            0294
@DL00294 DS    0H                                                  0295
*    BINWORD = COUNT(Z,K);       /*PULL UP THE FIRST COUNT   @Z427VLS*/
         L     @03,Z                                               0295
         SLA   @03,4                                               0295
         ALR   @03,@06                                             0295
         SLA   @03,2                                               0295
         L     @03,COUNT-68(@03)                                   0295
         ST    @03,BINWORD                                         0295
*    TOTALS(K) = TOTALS(K) + BINWORD;/*CPU TOTALS FOR THIS LINE      */
         SLA   @06,2                                               0296
         L     @15,TOTALS-4(@06)                                   0296
         ALR   @15,@03                                             0296
         ST    @15,TOTALS-4(@06)                                   0296
*   SUBTOT(K) = SUBTOT(K) + BINWORD;/*FOR OVER ALL TOTAL     @Z427VLS*/
         AL    @03,SUBTOT-4(@06)                                   0297
         ST    @03,SUBTOT-4(@06)                                   0297
*    CALL CONVBIN;               /*GO CONVERT TO PRINTABLE 5 CHARS   */
         BAL   @14,CONVBIN                                         0298
*    DECADDR = DECADDR + SIX;    /*MOVE DOWN PRINT TO NEXT CPU       */
         L     @06,DECADDR                                         0299
         AL    @06,SIX                                             0299
         ST    @06,DECADDR                                         0299
*   END;                                                   /*@Z427VLS*/
         LA    @06,1                                               0300
         AL    @06,K                                               0300
         ST    @06,K                                               0300
@DE00294 L     @03,EVPTR(,R2)                                      0300
         CH    @06,EVNUM(,@03)                                     0300
         BNH   @DL00294                                            0300
*   CALL PRINTIT;                /*PRINT TOTAL AND INDIVIDULE COUNT  */
         BAL   @14,PRINTIT                                         0301
*   Z = Z + ONE;                 /*MOVE TO THE NEXT SUB CASE @Z427VLS*/
         L     @06,Z                                               0302
         AL    @06,ONE                                             0302
         ST    @06,Z                                               0302
*  END;                                                    /*@Z427VLS*/
@DE00281 L     @06,Z                                               0303
         LA    @03,LETTER-1(@06)                                   0303
         CLC   0(1,@03),LETTER1                                    0303
         BE    @DL00281                                            0303
*  CPU12 = EVLETTER(PTR);                                  /*@Z427VLS*/
         L     @03,PTR                                             0304
         MH    @03,@CH00080                                        0304
         L     @01,EVPTR(,R2)                                      0304
         ALR   @01,@03                                             0304
         MVC   CPU12(1),EVLETTER-6(@01)                            0304
*  LETTER1 = LETTER(Z);          /*CHANGE THE CONTROL CHARACTER      */
         LA    @03,LETTER-1(@06)                                   0305
         MVC   LETTER1(1),0(@03)                                   0305
*  BINWORD = TOTAL;              /*SET TO CONVERT THE TOTAL FOR LINE */
         L     @06,TOTAL                                           0306
         ST    @06,BINWORD                                         0306
*  BNDECNUM = SIX;               /*LET TOTAL HAVE SIX PLACES OUT     */
         L     @06,SIX                                             0307
         ST    @06,BNDECNUM                                        0307
*  TOTALNM1 = TOTHEAD(J);        /*MOVE IN WORDS TO DESCRIBE THE LINE*/
         L     @06,J                                               0308
         MH    @06,@CH00747                                        0308
         LA    @03,TOTHEAD-22(@06)                                 0308
         MVC   TOTALNM1(22),0(@03)                                 0308
*  DECADDR = ADDR(TOTALVAL);     /*WHERE TO PUT THE DATA     @Z427VLS*/
         LA    @06,TOTALVAL                                        0309
         ST    @06,DECADDR                                         0309
*  CALL CONVBIN;                 /*CONVERT THE NUMBER TO PRINTABLE   */
         BAL   @14,CONVBIN                                         0310
*  BNDECNUM = FIVE;              /*CHANGE BACK TO ONLY 5 CHARS OUT   */
         L     @06,FIVE                                            0311
         ST    @06,BNDECNUM                                        0311
*  DECADDR = DECADDR + SEVEN;    /*MOVE DOWN THE PRINT LINE  @Z427VLS*/
         L     @06,DECADDR                                         0312
         AL    @06,SEVEN                                           0312
         ST    @06,DECADDR                                         0312
*  DO K = 1 BY 1 TO EVNUM;    /*PROCESS THROUGH ALL CPUS     @Z427VLS*/
         LA    @06,1                                               0313
         ST    @06,K                                               0313
         B     @DE00313                                            0313
@DL00313 DS    0H                                                  0314
*   BINWORD = TOTALS(K);         /*GET TOTAL FOR EACH CPU    @Z427VLS*/
         SLA   @06,2                                               0314
         L     @06,TOTALS-4(@06)                                   0314
         ST    @06,BINWORD                                         0314
*   CALL CONVBIN;                /*CONVERT THIS TO PRINTABLE @Z427VLS*/
         BAL   @14,CONVBIN                                         0315
*   DECADDR = DECADDR + SIX;     /*MOVE DOWN THE PRINT LINE FOR NEXT */
         L     @06,DECADDR                                         0316
         AL    @06,SIX                                             0316
         ST    @06,DECADDR                                         0316
*  END;                                                    /*@Z427VLS*/
         LA    @06,1                                               0317
         AL    @06,K                                               0317
         ST    @06,K                                               0317
@DE00313 L     @03,EVPTR(,R2)                                      0317
         CH    @06,EVNUM(,@03)                                     0317
         BNH   @DL00313                                            0317
*  CALL PRINTIT;                 /*GO PRINT THE TOTALS FOR EACH CPU  */
         BAL   @14,PRINTIT                                         0318
*  TOTAL = ZERO;                 /*SET ITEM TO ZERO          @Z427VLS*/
         SLR   @06,@06                                             0319
         ST    @06,TOTAL                                           0319
*  SPACING = DOUBLE;             /*MAKE THE OUTPTU LOOK BETTER       */
         MVC   SPACING(1),DOUBLE                                   0320
*  CALL PRINTIT;                 /*WITH A GAP BETWEEN SECTIONS       */
         BAL   @14,PRINTIT                                         0321
*  SPACING = SINGLE;             /*RETURN THE SPAVING TO 1 SPACE     */
         MVC   SPACING(1),SINGLE                                   0322
*  GEN(MVI   TOTALS,X'00');      /*SET FIRST BYTE TO ZERO    @Z427VLS*/
         MVI   TOTALS,X'00'
*  GEN(MVC   TOTALS+1(63),TOTALS);/*RIPPLE THE 0 THROUGH THE ARRAY   */
         MVC   TOTALS+1(63),TOTALS
* END;                                                     /*@Z427VLS*/
         LA    @06,1                                               0325
         AL    @06,J                                               0325
         ST    @06,J                                               0325
         C     @06,@CF00085                                        0325
         BNH   @DL00280                                            0325
* MVCOVER = OVERTOT;     /*MOVE IN THE WORDS DESCRIBING THIS GRAND   */
         MVC   MVCOVER(16),OVERTOT                                 0326
* BINWORD = TOTOFTOT;    /*PICK UP OVER ALL TOTAL            @Z427VLS*/
         L     @06,TOTOFTOT                                        0327
         ST    @06,BINWORD                                         0327
* BNDECNUM = SIX;        /*SET UP TO DO SIX BYTES OF PRINTABLE       */
         L     @06,SIX                                             0328
         ST    @06,BNDECNUM                                        0328
* DECADDR = ADDR(TOTALVAL);/*ADDRESS OF WHERE TO PUT CONVERTED VALUE */
         LA    @06,TOTALVAL                                        0329
         ST    @06,DECADDR                                         0329
* CALL CONVBIN;          /*GO CONVERT THE DATA TO PRINTABLE  @Z427VLS*/
         BAL   @14,CONVBIN                                         0330
* BNDECNUM = FIVE;       /*RESET TO = LAST GROUP             @Z427VLS*/
         L     @06,FIVE                                            0331
         ST    @06,BNDECNUM                                        0331
* DECADDR = DECADDR + SEVEN;/*ADJUST DOWN THE PRINT LINE     @Z427VLS*/
         L     @06,DECADDR                                         0332
         AL    @06,SEVEN                                           0332
         ST    @06,DECADDR                                         0332
* DO K = 1 BY 1 TO EVNUM;                                  /*@Z427VLS*/
         LA    @06,1                                               0333
         ST    @06,K                                               0333
         B     @DE00333                                            0333
@DL00333 DS    0H                                                  0334
*  BINWORD = SUBTOT(K);  /*PICK UP THE NEXT OVER ALL TOTAL   @Z427VLS*/
         SLA   @06,2                                               0334
         L     @06,SUBTOT-4(@06)                                   0334
         ST    @06,BINWORD                                         0334
*  CALL CONVBIN;         /*GO AND CONVERT THE ITEM TO BINARY @Z427VLS*/
         BAL   @14,CONVBIN                                         0335
*  DECADDR = DECADDR + SIX ;/* MOVE DOWN THE LINE FOR THE NEXT TOTAL */
         L     @06,DECADDR                                         0336
         AL    @06,SIX                                             0336
         ST    @06,DECADDR                                         0336
* END;                                                     /*@Z427VLS*/
         LA    @06,1                                               0337
         AL    @06,K                                               0337
         ST    @06,K                                               0337
@DE00333 L     @03,EVPTR(,R2)                                      0337
         CH    @06,EVNUM(,@03)                                     0337
         BNH   @DL00333                                            0337
* CALL PRINTIT;          /*AT LAST THE LAST TOTAL LINE       @Z427VLS*/
         BAL   @14,PRINTIT                                         0338
* GENERATE DATA;                                           /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00005 DS    0H                                                  0340
@EF00005 DS    0H                                                  0340
@ER00005 LM    @14,@12,@SA00005                                    0340
         BR    @14                                                 0340
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL BUILD THE MAIN HEADING FOR THE OUTPUT  @Z427VLS*/
*/*                                                          @Z427VLS*/
*MAINHEAD: PROC;                                           /*@Z427VLS*/
MAINHEAD STM   @14,@12,@SA00006                                    0341
*  SPACING = UPSPACE;         /*TIME FOR A NEW PAGE          @Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0342
*  CALL PRINTIT;              /*SKIP TO CHANNEL ONE          @Z427VLS*/
         BAL   @14,PRINTIT                                         0343
*  SPACING = SINGLE;          /*RETURN TO PRINT AND SKIP ONE LINE    */
         MVC   SPACING(1),SINGLE                                   0344
*  HEAD01 = LINE01;           /*MOVE IN THE MAIN HEADING EVENT H--   */
         MVC   HEAD01(13),LINE01                                   0345
*  DAYSDATE = DATENOW;        /*PARM PROCESSOR SHOULD HAVE FILLED THS*/
         MVC   DAYSDATE(6),DATENOW(R2)                             0346
*  TODAYDT = REPORTDY;        /*MOVE WORDS 'REPORT DATE TO PRINT LINE*/
         MVC   TODAYDT(12),REPORTDY                                0347
*  CALL PRINTIT;              /*GO PRINT THE FIRST LINE      @Z427VLS*/
         BAL   @14,PRINTIT                                         0348
*  NUMBER = ONE;              /*SET FOR ONE BYTE TO BE CONVERTED     */
         L     @06,ONE                                             0349
         ST    @06,NUMBER                                          0349
*  NEXTBY = ADDR(EVSYEAR);    /*SET UP THE ADDRESS OF THE DATE       */
         LA    @06,EVSYEAR(,R2)                                    0350
         ST    @06,NEXTBY                                          0350
*  ADDNXT = ADDR(DATEYR);     /*SET UP WHERE TO PUT THE CONVERTED DAY*/
         LA    @06,DATEYR                                          0351
         ST    @06,ADDNXT                                          0351
*  CALL CONVERT;              /*GO CONVERT THE DATE          @Z427VLS*/
         BAL   @14,CONVERT                                         0352
*  NUMBER = TWO;              /*SET UP TO CONVERT TWO BYTES OF DATA  */
         L     @06,TWO                                             0353
         ST    @06,NUMBER                                          0353
*  SWITCH1 = ON;              /*SET TO DROP THE 1/2 BYTE     @Z427VLS*/
         OI    SWITCH1,B'10000000'                                 0354
*  SRL(EVSDAY,FOUR);          /*CHUCK THE F IN LAST 1/2 BYTE @Z427VLS*/
         LH    @06,EVSDAY(,R2)                                     0355
         N     @06,@CF01464                                        0355
         SRL   @06,4                                               0355
         STH   @06,EVSDAY(,R2)                                     0355
*  NEXTBY = ADDR(EVSDAY);     /*SET UP WHERE TO GET THE DAY  @Z427VLS*/
         LA    @06,EVSDAY(,R2)                                     0356
         ST    @06,NEXTBY                                          0356
*  ADDNXT = ADDR(DATEDAY)-1;  /*SET WHERE TO PUT CONVERTED DAY       */
         LA    @06,DATEDAY                                         0357
         BCTR  @06,0                                               0357
         ST    @06,ADDNXT                                          0357
*  CALL CONVERT;              /*GO CONVERT THE DAY TO PRINTABLE      */
         BAL   @14,CONVERT                                         0358
*  HEDDATE = HEADDATE;        /*MOVE IN THE DATA TO THE PRINT LINE   */
         MVC   HEDDATE(18),HEADDATE                                0359
*  CALL PRINTIT;              /*GO PRINT THE FROM DAY YEAR   @Z427VLS*/
         BAL   @14,PRINTIT                                         0360
*  FROMTO = TO;               /*CHANGE THE WORD (FROM) TO (TO)       */
         MVC   FROMTO(5),TO                                        0361
*  SWITCH1 = ON;              /*SET SO ONE HALF OF A BYTE IS DROPPED */
         OI    SWITCH1,B'10000000'                                 0362
*  NEXTBY = ADDR(EVDAY);      /*ADDRESS OF DATA              @Z427VLS*/
         L     @06,EVPTR(,R2)                                      0363
         LA    @03,EVDAY(,@06)                                     0363
         ST    @03,NEXTBY                                          0363
*  ADDNXT = ADDR(DATEDAY)-1;  /*SET WHERE TO PUT CONVERTED DAY       */
         LA    @03,DATEDAY                                         0364
         BCTR  @03,0                                               0364
         ST    @03,ADDNXT                                          0364
*  SRL(EVDAY,FOUR);           /*MOVE THE F OUT OF THE DAY FIELD      */
         SLR   @03,@03                                             0365
         ICM   @03,3,EVDAY(@06)                                    0365
         SRL   @03,4                                               0365
         STCM  @03,3,EVDAY(@06)                                    0365
*  CALL CONVERT;              /*CHANGE THE LAST DAY TO PRINTABLE     */
         BAL   @14,CONVERT                                         0366
*  NUMBER =  ONE;             /*SET UP TO DO JUST ONE BYTE   @Z427VLS*/
         L     @06,ONE                                             0367
         ST    @06,NUMBER                                          0367
*  NEXTBY = ADDR(EVYEAR);     /*SET UP THE ADDRESS OF THE LAST YEAR  */
         L     @06,EVPTR(,R2)                                      0368
         ST    @06,NEXTBY                                          0368
*  ADDNXT = ADDR(DATEYR);     /*SET UP ADDRESS WHERE TO PUT THE YEAR */
         LA    @06,DATEYR                                          0369
         ST    @06,ADDNXT                                          0369
*  CALL CONVERT;              /*CONVERT THE LAST RECORD DATE TO PRINT*/
         BAL   @14,CONVERT                                         0370
*  HEDDATE = HEADDATE;        /*MOVE THE DATA TO THE PRINT LINE      */
         MVC   HEDDATE(18),HEADDATE                                0371
*  CALL PRINTIT;              /*GO PRINT THE TO DATE INFORMATION     */
         BAL   @14,PRINTIT                                         0372
*END;                                                      /*@Z427VLS*/
@EL00006 DS    0H                                                  0373
@EF00006 DS    0H                                                  0373
@ER00006 LM    @14,@12,@SA00006                                    0373
         BR    @14                                                 0373
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PRINT THE NEW DATE WHEN CALLED,FROM THE RECORD */
*/*                                                          @Z427VLS*/
*NEWDATE: PROC;                                            /*@Z427VLS*/
NEWDATE  STM   @14,@12,@SA00007                                    0374
*  IF DEBUG24 ^= ON THEN      /*IF SO DO NOT WANT SPACE      @Z427VLS*/
         TM    DEBUG24(R2),B'10000000'                             0375
         BO    @RF00375                                            0375
*   CALL PRINTIT;             /*UPSPACE ONE LINE FOR LOOKS   @Z427VLS*/
         BAL   @14,PRINTIT                                         0376
*  LASTDATE = LRTDATE;        /*CHANGE THE BREAKPOINT TO THE NEW DATE*/
@RF00375 MVC   LASTDATE(4),LRTDATE(R7)                             0377
*  NUMBER = ONE;              /*SET UP TO CONVERT 1 BYTE OF HEX      */
         L     @06,ONE                                             0378
         ST    @06,NUMBER                                          0378
*  NEXTBY = ADDR(LRTYEAR);    /*SET UP ADDRESS OF WHERE TO PUT IT    */
         LA    @06,LRTYEAR(,R7)                                    0379
         ST    @06,NEXTBY                                          0379
*  ADDNXT = ADDR(YEARJUL);    /*SET UP ADDRESS OF THE YEAR IN RECORD */
         LA    @06,YEARJUL                                         0380
         ST    @06,ADDNXT                                          0380
*  CALL CONVERT;              /*GO FORMATE THE YEAR FOR PRINTING     */
         BAL   @14,CONVERT                                         0381
*  NUMBER= TWO;               /*SET UP TO CONVERT THE JULIAN DATE    */
         L     @06,TWO                                             0382
         ST    @06,NUMBER                                          0382
*  SWITCH1 = ON;                                           /*@Z427VLS*/
         OI    SWITCH1,B'10000000'                                 0383
*  TABLECHH = LRTDAY;         /*MOVE SO WE CAN SHIFT OUT THE 'F'X */
         MVC   TABLECHH(2),LRTDAY(R7)                              0384
*  SRL(TABLECHH,FOUR);        /*SHIFT OUT THE F IN THE DATE  @0001VLS*/
         SLR   @06,@06                                             0385
         ICM   @06,3,TABLECHH                                      0385
         SRL   @06,4                                               0385
         STCM  @06,3,TABLECHH                                      0385
*  NEXTBY = ADDR(TABLECHH);   /*SET UP WHERE THE INFO TO CONVERT IS*/
         LA    @06,TABLECHH                                        0386
         ST    @06,NEXTBY                                          0386
*  ADDNXT = ADDR(DAYJUL);     /*SET UP ADDRESS OF WHERE TO PUT DATA  */
         LA    @06,DAYJUL                                          0387
         ST    @06,ADDNXT                                          0387
*  CALL CONVERT;              /*CONVERT THE DATA TO PRINTABLE        */
         BAL   @14,CONVERT                                         0388
*  NEWDATEO = NEWDATEH;       /*MOVE THE LINE TO THE PRINT BUFFER    */
         MVC   NEWDATEO(12),NEWDATEH                               0389
*  IF DEBUG24 ^= ON THEN      /*IF TRUE ONLY ONE LINE OUT    @Z427VLS*/
         TM    DEBUG24(R2),B'10000000'                             0390
         BO    @RF00390                                            0390
*  DO;                                                     /*@Z427VLS*/
*  GEN(MVI  TIME1+13,X'40');                               /*@Z427VLS*/
         MVI  TIME1+13,X'40'
*  GEN(MVC  TIME1+14(120),TIME1+13);                       /*@Z427VLS*/
         MVC  TIME1+14(120),TIME1+13
*   SPACING = DOUBLE ;        /*SET SPACING TO DOUBLE FOR THIS LINE  */
         MVC   SPACING(1),DOUBLE                                   0394
*  END;                                                    /*@Z427VLS*/
*  MYLINECT = MYLINECT + ONE; /*ADJUST FOR THE DOUBLE SPACING        */
@RF00390 LH    @06,MYLINECT                                        0396
         AL    @06,ONE                                             0396
         STH   @06,MYLINECT                                        0396
*  CALL PRINTIT;              /*GO PRINT THE NEW DAY YEAR    @Z427VLS*/
         BAL   @14,PRINTIT                                         0397
*  SPACING = SINGLE;          /*RETURN THE SPACING TO NORMAL(ONE)    */
         MVC   SPACING(1),SINGLE                                   0398
*END;                                                      /*@Z427VLS*/
@EL00007 DS    0H                                                  0399
@EF00007 DS    0H                                                  0399
@ER00007 LM    @14,@12,@SA00007                                    0399
         BR    @14                                                 0399
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL SETUP LINKAGE TO ACCESS I/O SERVICE PRINT      */
*/*                                                          @Z427VLS*/
*PRINTIT: PROC;                                            /*@Z427VLS*/
PRINTIT  STM   @14,@12,@SA00008                                    0400
*  PRINTADR = ADDR(PRTLINE);                               /*@Z427VLS*/
         LA    @06,PRTLINE                                         0401
         ST    @06,PRINTADR(,R2)                                   0401
*  CALL IOHND(RITEPRTR);      /*PASS CONTROL TO I/O HANDLER  @Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0402
         LA    @01,@AL00402                                        0402
         BALR  @14,@15                                             0402
*  IF SPACING = SINGLE        /*SINGLE SPACING REQUESTED     @Z427VLS*/
*   THEN                                                           0403
         CLC   SPACING(1),SINGLE                                   0403
         BNE   @RF00403                                            0403
*    MYLINECT = MYLINECT + ONE;                            /*@Z427VLS*/
         LH    @06,MYLINECT                                        0404
         AL    @06,ONE                                             0404
         STH   @06,MYLINECT                                        0404
*   ELSE                                                           0405
*    IF SPACING = DOUBLE      /*DOUBLE SPACING REQUESTED     @Z427VLS*/
*     THEN                                                         0405
         B     @RC00403                                            0405
@RF00403 CLC   SPACING(1),DOUBLE                                   0405
         BNE   @RF00405                                            0405
*      MYLINECT = MYLINECT + TWO;                          /*@Z427VLS*/
         LH    @06,MYLINECT                                        0406
         AL    @06,TWO                                             0406
         STH   @06,MYLINECT                                        0406
*     ELSE                                                         0407
*      IF SPACING = TRIPLE    /*RIGHT U GUESSED TRIPLE SPACING REQUES*/
*       THEN                                                       0407
         B     @RC00405                                            0407
@RF00405 CLC   SPACING(1),TRIPLE                                   0407
         BNE   @RF00407                                            0407
*        MYLINECT = MYLINECT + THREE;/*ELSE IT'S AN UPSPACE  @Z427VLS*/
         LH    @06,MYLINECT                                        0408
         LA    @06,3(,@06)                                         0408
         STH   @06,MYLINECT                                        0408
*       ELSE                                                       0409
*        IF SPACING = UPSPACE     /*IF TRUE LINECT MUST BE RESET     */
*           THEN                                                   0409
         B     @RC00407                                            0409
@RF00407 CLC   SPACING(1),UPSPACE                                  0409
         BNE   @RF00409                                            0409
*             MYLINECT = ZERO;                             /*@Z427VLS*/
         SLR   @06,@06                                             0410
         STH   @06,MYLINECT                                        0410
* IF SWITCH5 = ON & MYLINECT=> LINECT THEN/*HEADING FOR SUMMARY*/  0411
@RF00409 DS    0H                                                  0411
@RC00407 DS    0H                                                  0411
@RC00405 DS    0H                                                  0411
@RC00403 TM    SWITCH5,B'00001000'                                 0411
         BNO   @RF00411                                            0411
         LH    @06,MYLINECT                                        0411
         CH    @06,LINECT(,R2)                                     0411
         BL    @RF00411                                            0411
*  DO;                                                     /*@Z427VLS*/
*   KEEPSP = SPACING;                                      /*@Z427VLS*/
         MVC   KEEPSP(1),SPACING                                   0413
*   SPACING = UPSPACE;                                     /*@Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0414
*   PRINTADR = ADDR(PRTLINE);                              /*@Z427VLS*/
         LA    @06,PRTLINE                                         0415
         ST    @06,PRINTADR(,R2)                                   0415
*   CALL IOHND(RITEPRTR);                                  /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0416
         LA    @01,@AL00416                                        0416
         BALR  @14,@15                                             0416
*MYLINECT = THREE;                                         /*@0001VLS*/
         MVC   MYLINECT(2),@CH00075                                0417
*RESPECIFY (R6) RESTRICTED;                                /*@0001VLS*/
*  SPACING = SINGLE;                                       /*@0001VLS*/
         MVC   SPACING(1),SINGLE                                   0419
*  TOTALHD2 = TOTALHD1;     /*MOVE IN THE FIRST PART OF THE HEADING  */
         MVC   TOTALHD2(12),TOTALHD1                               0420
* R6 = ADDR(TOTALHD3);    /*WHERE THE HEADING IS AT          @0001VLS*/
         LA    R6,TOTALHD3                                         0421
* R8 = ADDR(TIME1) + 26;  /*WHERE TO MOVE THE LINE TO        @0001VLS*/
         LA    R8,TIME1                                            0422
         AL    R8,@CF01065                                         0422
* R9 = 7 + SIX * EVNUM;   /*HOW MANY BYTES TO MOVE INTO THE HEADING*/
         L     @03,EVPTR(,R2)                                      0423
         L     R9,SIX                                              0423
         MH    R9,EVNUM(,@03)                                      0423
         AL    R9,@CF00082                                         0423
* GEN(EX  R9,MOVECHAR);   /*MOVE THE CHARACTERS INTO THE PRINT BUFF*/
         EX  R9,MOVECHAR
*RESPECIFY (R6) UNRESTRICTED;                              /*@0001VLS*/
*PRINTADR = ADDR(PRTLINE);    /*TELL I/O WHERE THE BUFFER IS AT*/  0426
         LA    @06,PRTLINE                                         0426
         ST    @06,PRINTADR(,R2)                                   0426
*CALL IOHND(RITEPRTR);        /*GO WRITE THE HEADING TO THE BUFFER*/
         L     @15,ADIOHND(,R2)                                    0427
         LA    @01,@AL00427                                        0427
         BALR  @14,@15                                             0427
*   SPACING = KEEPSP;                                      /*@Z427VLS*/
         MVC   SPACING(1),KEEPSP                                   0428
*  END;                                                    /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00008 DS    0H                                                  0430
@EF00008 DS    0H                                                  0430
@ER00008 LM    @14,@12,@SA00008                                    0430
         BR    @14                                                 0430
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL CONVERT THE TIME IN THE RECORD TO PRINTABLE    */
*/*                                                          @Z427VLS*/
*TIME:  PROC;                                              /*@Z427VLS*/
TIME     STM   @14,@12,@SA00009                                    0431
*  NEXTBY  =  ADDR(LRTTIME);     /*SET POINTER TO POINT TO TIME FIELD*/
         LA    @06,LRTTIME(,R7)                                    0432
         ST    @06,NEXTBY                                          0432
*  NUMBER = ONE;                 /*CONVERT 1 TO ALLOW FOR SPACES     */
         L     @06,ONE                                             0433
         ST    @06,NUMBER                                          0433
*  ADDNXT = ADDR(TIME1);         /*SET POINTER TO START OF OUTPUT    */
         LA    @06,TIME1                                           0434
         ST    @06,ADDNXT                                          0434
*  DO R = 4 BY -1 TO 1;          /*CONV HR'S MINS SECONDS    @Z427VLS*/
         LA    @06,4                                               0435
         ST    @06,R                                               0435
@DL00435 DS    0H                                                  0436
*    CALL CONVERT;               /*CONVERT THE BYTE OF DATA  @Z427VLS*/
         BAL   @14,CONVERT                                         0436
*    NEXTBY = NEXTBY + ONE;      /*MOVE TO THE NEXT FIELD    @Z427VLS*/
         L     @06,NEXTBY                                          0437
         AL    @06,ONE                                             0437
         ST    @06,NEXTBY                                          0437
*    ADDNXT = ADDNXT + THREE;    /*ALLOW FOR BLANK BETWEEN EACH FIELD*/
         LA    @06,3                                               0438
         AL    @06,ADDNXT                                          0438
         ST    @06,ADDNXT                                          0438
*  END;                                                    /*@Z427VLS*/
         SLR   @06,@06                                             0439
         BCTR  @06,0                                               0439
         AL    @06,R                                               0439
         ST    @06,R                                               0439
         LTR   @06,@06                                             0439
         BP    @DL00435                                            0439
*END;                                                      /*@Z427VLS*/
@EL00009 DS    0H                                                  0440
@EF00009 DS    0H                                                  0440
@ER00009 LM    @14,@12,@SA00009                                    0440
         BR    @14                                                 0440
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL MOVE THE DATA FOR EACH TYPE OF RECORD INTO    */
* /*    THE PRINT LINE                                       @Z427VLS*/
*MOVEDATA:  PROC;                                          /*@Z427VLS*/
MOVEDATA STM   @14,@12,@SA00010                                    0441
*/*EREPCASE (CURRENT) VALUES(1,2,3,4,5,6,7,8,9,10,11)*/            0442
* DCL  I0001   FIXED(15);                                          0442
* I0001 = 0;                                                       0443
         SLR   I0001,I0001                                         0443
* IF CURRENT = 1 THEN                                              0444
         CLC   CURRENT(4),@CF00054                                 0444
         BNE   @RF00444                                            0444
*      I0001 = 4 ;                                                 0445
         LA    I0001,4                                             0445
* IF CURRENT = 2 THEN                                              0446
@RF00444 CLC   CURRENT(4),@CF00073                                 0446
         BNE   @RF00446                                            0446
*      I0001 = 8 ;                                                 0447
         LA    I0001,8                                             0447
* IF CURRENT = 3 THEN                                              0448
@RF00446 CLC   CURRENT(4),@CF00075                                 0448
         BNE   @RF00448                                            0448
*      I0001 = 12 ;                                                0449
         LA    I0001,12                                            0449
* IF CURRENT = 4 THEN                                              0450
@RF00448 CLC   CURRENT(4),@CF00063                                 0450
         BNE   @RF00450                                            0450
*      I0001 = 16 ;                                                0451
         LA    I0001,16                                            0451
* IF CURRENT = 5 THEN                                              0452
@RF00450 CLC   CURRENT(4),@CF00078                                 0452
         BNE   @RF00452                                            0452
*      I0001 = 20 ;                                                0453
         LA    I0001,20                                            0453
* IF CURRENT = 6 THEN                                              0454
@RF00452 CLC   CURRENT(4),@CF00080                                 0454
         BNE   @RF00454                                            0454
*      I0001 = 24 ;                                                0455
         LA    I0001,24                                            0455
* IF CURRENT = 7 THEN                                              0456
@RF00454 CLC   CURRENT(4),@CF00082                                 0456
         BNE   @RF00456                                            0456
*      I0001 = 28 ;                                                0457
         LA    I0001,28                                            0457
* IF CURRENT = 8 THEN                                              0458
@RF00456 CLC   CURRENT(4),@CF00065                                 0458
         BNE   @RF00458                                            0458
*      I0001 = 32 ;                                                0459
         LA    I0001,32                                            0459
* IF CURRENT = 9 THEN                                              0460
@RF00458 CLC   CURRENT(4),@CF00085                                 0460
         BNE   @RF00460                                            0460
*      I0001 = 36 ;                                                0461
         LA    I0001,36                                            0461
* IF CURRENT = 10 THEN                                             0462
@RF00460 CLC   CURRENT(4),@CF00032                                 0462
         BNE   @RF00462                                            0462
*      I0001 = 40 ;                                                0463
         LA    I0001,40                                            0463
* IF CURRENT = 11 THEN                                             0464
@RF00462 CLC   CURRENT(4),@CF00033                                 0464
         BNE   @RF00464                                            0464
*      I0001 = 44 ;                                                0465
         LA    I0001,44                                            0465
* GENERATE;                                                        0466
@RF00464 DS    0H                                                  0466
    B    L00010(I0001)
L00010 B    L000112
    B    L00011
    B    L00012
    B    L00013
    B    L00014
    B    L00015
    B    L00016
    B    L00017
    B    L00018
    B    L00019
    B    L000110
    B    L000111
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL MCH TYPE RECORDS           @Z427VLS*/
*                                                                  0467
*/*EREPSUB  */                                                     0467
*L00011:                                                           0467
*     DO;                                               /*@Z427VLS*/
L00011   DS    0H                                                  0468
*    CALL TIME;                     /*MOVE THE TIME INTO THE PRINT L */
         BAL   @14,TIME                                            0468
*    JOBNAME1 = MCHJOBID;           /*MOVE THE JOB NAME INTO PRINT L */
         MVC   JOBNAME1(8),MCHJOBID(R7)                            0469
*    CPU12 = EVLETTER(PTR);    /*MOVE IN THE CPU LETTER      @0001VLS*/
         L     @06,PTR                                             0470
         LR    @03,@06                                             0470
         MH    @03,@CH00080                                        0470
         L     @01,EVPTR(,R2)                                      0470
         ALR   @01,@03                                             0470
         MVC   CPU12(1),EVLETTER-6(@01)                            0470
*    IF MCHSYSTR = ON               /*DID IT TERMINATE THE SYSTEM    */
*      THEN                         /*YES BIT IS ON          @Z427VLS*/
         TM    MCHSYSTR(R7),B'10000000'                            0471
         BNO   @RF00471                                            0471
*       DO;                                                /*@Z427VLS*/
*        RECTYP1 = MCHTRM;          /*SET TYPE = TO  MCH-TRM @Z427VLS*/
         MVC   RECTYP1(7),MCHTRM                                   0473
*        MCHTRMCT(PTR) = MCHTRMCT(PTR) + ONE;              /*@Z427VLS*/
         SLA   @06,2                                               0474
         L     @03,MCHTRMCT-4(@06)                                 0474
         AL    @03,ONE                                             0474
         ST    @03,MCHTRMCT-4(@06)                                 0474
*       END;                                               /*@Z427VLS*/
*      ELSE                                                        0476
*       DO;                                                /*@Z427VLS*/
         B     @RC00471                                            0476
@RF00471 DS    0H                                                  0477
*        RECTYP1 = MCH;             /*SET TO PLAIN   MCH     @Z427VLS*/
         MVC   RECTYP1(7),MCH                                      0477
*        MCHCT(PTR) = MCHCT(PTR) + ONE;                    /*@Z427VLS*/
         L     @06,PTR                                             0478
         SLA   @06,2                                               0478
         L     @03,MCHCT-4(@06)                                    0478
         AL    @03,ONE                                             0478
         ST    @03,MCHCT-4(@06)                                    0478
*       END;                                               /*@Z427VLS*/
*    NUMBER = ONE;                  /*SET UP # OF BYTES TO CONVERT   */
@RC00471 L     @06,ONE                                             0480
         ST    @06,NUMBER                                          0480
*    ADDNXT = ADDR(PSWMCH) ;        /*SET UP BASE FOR OUTPUT ADDRESS */
         LA    @06,PSWMCH                                          0481
         ST    @06,ADDNXT                                          0481
*    NEXTBY = ADDR(MCHMOD);         /*SET BASE TO POINT TO MCH MODLE */
         LA    @06,MCHMOD(,R7)                                     0482
         ST    @06,NEXTBY                                          0482
*    CALL CONVERT;                  /*GO CONVERT THE MODLE TO PRINT  */
         BAL   @14,CONVERT                                         0483
*    NUMBER = EIGHT;                /*SET UP # OF BYTES TO CONVERT   */
         MVC   NUMBER(4),@CF00065                                  0484
*    ADDNXT  = ADDR(PSWMCH);        /*SET BASE TO POINT TO START ADD */
         LA    @06,PSWMCH                                          0485
         ST    @06,ADDNXT                                          0485
*    NEXTBY = ADDR(MCHOPSW);        /*SET BASE POINTER TO DATA ADDRES*/
         LA    @06,MCHOPSW(,R7)                                    0486
         ST    @06,NEXTBY                                          0486
*    CALL CONVERT;                  /*CALL PROGRAM TO CONVERT DATA   */
         BAL   @14,CONVERT                                         0487
*IF  LRTKEY1 = '13'X &                                             0488
*    (LRTERRID & '10'X) = '10'X THEN                               0488
         CLI   LRTKEY1(R7),X'13'                                   0488
         BNE   @RF00488                                            0488
         MVC   @TS00001(1),LRTERRID(R7)                            0488
         NI    @TS00001,X'10'                                      0488
         CLI   @TS00001,X'10'                                      0488
         BNE   @RF00488                                            0488
* DO;                                                      /*@0098VLS*/
* NUMBER = 10;   /*ERRORID1 HAS 10 BYTES                     @0098VLS*/
         LA    @06,10                                              0490
         ST    @06,NUMBER                                          0490
* ADDNXT = ADDR(ERRORID1); /*ADDRESS IN THE OUTPUT LINE TO PLACE IT*/
         LA    @03,ERRORID1                                        0491
         ST    @03,ADDNXT                                          0491
* NEXTBY = ADDR(RERR);/*ADDRESS OF ERRORID1(R7 + RECLNGTH  - 10*/  0492
         LR    @03,R7                                              0492
         AH    @03,RECLNGTH(,R2)                                   0492
         SLR   @03,@06                                             0492
         ST    @03,NEXTBY                                          0492
* CALL CONVERT; /*GO CONVERT THE ITEM TO PRINTABLE           @0098VLS*/
         BAL   @14,CONVERT                                         0493
* END;                                                     /*@0098VLS*/
* ELSE                                                             0495
* ERRORNA = NOTAPPLY; /*PUT IN THE WORDS NOT AVAIBLE         @0098VLS*/
*                                                                  0495
         B     @RC00488                                            0495
@RF00488 MVC   ERRORNA(8),NOTAPPLY                                 0495
*/*EREPSEND  */                                                    0496
*       GO TO L000113;                                             0496
         B     L000113                                             0496
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL CCH TYPE RECORDS           @Z427VLS*/
*                                                                  0498
*/*EREPSUB  */                                                     0498
*L00012:                                                           0498
*     DO;                                               /*@Z427VLS*/
L00012   DS    0H                                                  0499
*      CALL TIME;                    /*GO CONVERT THIS RECORDS TIME  */
         BAL   @14,TIME                                            0499
*      JOBNAME1 = CCHJOBID;          /*MOVE THE JOB NAME INTO PRINT  */
         MVC   JOBNAME1(8),CCHJOBID(R7)                            0500
*      IF CCHRINC = ON                                             0501
*         THEN                                                     0501
         TM    CCHRINC(R7),B'01000000'                             0501
         BNO   @RF00501                                            0501
*          DO;                                             /*@Z427VLS*/
*           RECTYP1 = CCHINC;        /*MAKE PRINT READ CCH-INC       */
         MVC   RECTYP1(7),CCHINC                                   0503
*           CCHINCCT(PTR) = CCHINCCT(PTR) + ONE;           /*@Z427VLS*/
         L     @06,PTR                                             0504
         SLA   @06,2                                               0504
         L     @03,CCHINCCT-4(@06)                                 0504
         AL    @03,ONE                                             0504
         ST    @03,CCHINCCT-4(@06)                                 0504
*          END;                                            /*@Z427VLS*/
*         ELSE                                                     0506
*          DO;                                             /*@Z427VLS*/
         B     @RC00501                                            0506
@RF00501 DS    0H                                                  0507
*            IF CCHRCRH = ON         /*IS IT A CCH-CRH TYPE RECORD   */
*               THEN                                               0507
         TM    CCHRCRH(R7),B'00000100'                             0507
         BNO   @RF00507                                            0507
*                DO;                                       /*@Z427VLS*/
*                  RECTYP1 = CCHCRH; /*MAKE PRINT READ CCH-CHR       */
         MVC   RECTYP1(7),CCHCRH                                   0509
*                  CCHCRHCT(PTR) = CCHCRHCT(PTR) + ONE;    /*@Z427VLS*/
         L     @06,PTR                                             0510
         SLA   @06,2                                               0510
         L     @03,CCHCRHCT-4(@06)                                 0510
         AL    @03,ONE                                             0510
         ST    @03,CCHCRHCT-4(@06)                                 0510
*                END;                                      /*@Z427VLS*/
*               ELSE                                               0512
*                DO;                                       /*@Z427VLS*/
         B     @RC00507                                            0512
@RF00507 DS    0H                                                  0513
*                  RECTYP1 = CCH;    /*MAKE IT PLAIN CCH     @Z427VLS*/
         MVC   RECTYP1(7),CCH                                      0513
*                  CCHCT(PTR) = CCHCT(PTR) + ONE;          /*@Z427VLS*/
         L     @06,PTR                                             0514
         SLA   @06,2                                               0514
         L     @03,CCHCT-4(@06)                                    0514
         AL    @03,ONE                                             0514
         ST    @03,CCHCT-4(@06)                                    0514
*                END;                                      /*@Z427VLS*/
*          END;                                            /*@Z427VLS*/
@RC00507 DS    0H                                                  0517
*      NUMBER = TWO;                  /*SET TO CONVERT 2 BYTES       */
@RC00501 L     @06,TWO                                             0517
         ST    @06,NUMBER                                          0517
*      CPU12 = EVLETTER(PTR);         /*INSERT THE CPU LETTER SET BY */
         L     @06,PTR                                             0518
         MH    @06,@CH00080                                        0518
         L     @03,EVPTR(,R2)                                      0518
         ALR   @03,@06                                             0518
         MVC   CPU12(1),EVLETTER-6(@03)                            0518
*                                     /*IFCFILT4 FOR THIS SERIAL MOD */
*      ADDNXT = ADDR(CUA11);          /*SET UP THE CUA TO PRINT      */
         LA    @06,CUA11                                           0519
         ST    @06,ADDNXT                                          0519
*      NEXTBY = ADDR(CCHCUA);         /*ADDRESS OF WHERE CUA IS      */
         LA    @06,CCHCUA(,R7)                                     0520
         ST    @06,NEXTBY                                          0520
*      SWITCH1 = ON;                  /*SET NOT TO USE FIRST 1/2 BYTE*/
         OI    SWITCH1,B'10000000'                                 0521
*      CALL CONVERT;                  /*GO CONVERT CUA TO PRINTABLE  */
         BAL   @14,CONVERT                                         0522
*      DEVCOMP = CCHCODE2;            /*PUT DEVICE IN COMMON AREA    */
         MVC   DEVCOMP(2),CCHCODE2(R7)                             0523
*      CALL DODEVICE;                 /*CALL PROC TO BUILD DEVICE NME*/
         BAL   @14,DODEVICE                                        0524
*     NUMBER = EIGHT;      /*SET UP FOR THE CSW              @ZA19014*/
         MVC   NUMBER(4),@CF00065                                  0525
*     ADDNXT = ADDR(CSW1); /*WHERE TO PLACE THE CONVER CSW   @ZA19014*/
         LA    @06,CSW1                                            0526
         ST    @06,ADDNXT                                          0526
*     NEXTBY = ADDR(CCHCSW);/*WHERE TO GET THE CSW TO CONVE  @ZA19014*/
         LA    @06,CCHCSW(,R7)                                     0527
         ST    @06,NEXTBY                                          0527
*     CALL CONVERT;       /*GO CONVERT THE CSW TO PRINTABLE  @ZA19014*/
*                                                                  0528
         BAL   @14,CONVERT                                         0528
*/*EREPSEND  */                                                    0529
*       GO TO L000113;                                             0529
         B     L000113                                             0529
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL OBR TYPE RECORDS           @Z427VLS*/
* /*                                                         @Z427VLS*/
*                                                                  0531
*/*EREPSUB  */                                                     0531
*L00013:                                                           0531
*     DO;                                               /*@Z427VLS*/
L00013   DS    0H                                                  0532
*   CALL TIME;                        /*GO CONVERT THIS RECORDS TIME */
         BAL   @14,TIME                                            0532
*   JOBNAME1 = OBRJOBID;              /*MOVE THE NAME INTO PRINT LINE*/
         MVC   JOBNAME1(8),OBRJOBID(R7)                            0533
*   NUMBER = TWO;                     /*SET # OF BYTES TO CONVERT    */
         L     @06,TWO                                             0534
         ST    @06,NUMBER                                          0534
*   CPU12 = EVLETTER(PTR) ;           /*INSERT THE CPU LETTER        */
         L     @06,PTR                                             0535
         MH    @06,@CH00080                                        0535
         L     @03,EVPTR(,R2)                                      0535
         ALR   @03,@06                                             0535
         MVC   CPU12(1),EVLETTER-6(@03)                            0535
*   SWITCH1 = ON;                     /*SET TO NOT DO FIRST 1/2 BYTE */
         OI    SWITCH1,B'10000000'                                 0536
*   ADDNXT = ADDR(CUA11);             /*ADDRESS OF WHERE TO PUT DATA */
         LA    @06,CUA11                                           0537
         ST    @06,ADDNXT                                          0537
*   IF SHORTSW = ON                   /*IS THIS A SHORT OBR  @Z427VLS*/
*     THEN                                                         0538
         TM    SHORTSW(R7),B'00100000'                             0538
         BNO   @RF00538                                            0538
*      DO;                                                 /*@Z427VLS*/
*    IF (OBRSDEV2 & 'F000'X) = '8000'X THEN                        0540
         MVC   @TS00001(2),OBRSDEV2(R7)                            0540
         NC    @TS00001(2),@CB01306                                0540
         CLC   @TS00001(2),@CB00193                                0540
         BNE   @RF00540                                            0540
*        VOLUME1 = OBRVOL;            /*MOVE IN THE OBR VOLUME ID    */
         MVC   VOLUME1(6),OBRVOL(R7)                               0541
*       DEVICE1 = HH1;                /*WILL SET THE ITEM BACK TO    */
@RF00540 MVC   DEVICE1(4),HH1                                      0542
*                                     /*BLANKS               @Z427VLS*/
*       NEXTBY = ADDR(OBRSCUA) + ONE; /*ADDRESS OF CUA IN SHORT OBR  */
         LA    @06,OBRSCUA(,R7)                                    0543
         AL    @06,ONE                                             0543
         ST    @06,NEXTBY                                          0543
*       DEVCOMP = OBRSDEV2;           /*SHORT OBR DEVICE     @Z427VLS*/
         MVC   DEVCOMP(2),OBRSDEV2(R7)                             0544
*       JOBNAME1 = NOTAPPLY;                               /*@Z427VLS*/
         MVC   JOBNAME1(8),NOTAPPLY                                0545
*      END;                                                /*@Z427VLS*/
*     ELSE                                                         0547
*      DO;                                                 /*@Z427VLS*/
         B     @RC00538                                            0547
@RF00538 DS    0H                                                  0548
*       IF OBRCLASS = '80'X THEN                                   0548
         CLI   OBRCLASS(R7),X'80'                                  0548
         BNE   @RF00548                                            0548
*        VOLUME1 = OBRVOL;                                 /*@Z427VLS*/
         MVC   VOLUME1(6),OBRVOL(R7)                               0549
*       IF (OBRDEV = '2009'X)                                     0550
*          (OBRDEV = '200D'X) &((OBRCODE2 & '08'X) = '08'X) THEN   0550
@RF00548 CLC   OBRDEV(2,R7),@CB01308                               0550
         BE    @RT00550                                            0550
         CLC   OBRDEV(2,R7),@CB01309                               0550
         BNE   @RF00550                                            0550
         MVC   @TS00001(1),OBRCODE2(R7)                            0550
         NI    @TS00001,X'08'                                      0550
         CLI   @TS00001,X'08'                                      0550
         BNE   @RF00550                                            0550
@RT00550 DS    0H                                                  0551
*          LETTERV = 'V';                                  /*@Z427VLS*/
         MVI   LETTERV,C'V'                                        0551
*      IF DEBUG29 = ON THEN  /*USE SECONDARY CUA RATHER THAN PRIMARY*/
@RF00550 TM    DEBUG29(R2),B'00000100'                             0552
         BNO   @RF00552                                            0552
*       NEXTBY = ADDR(OBRSECUA) + 1;/*ADDRESS OF THE SECONDARY CUA*/
         LA    @06,OBRSECUA(,R7)                                   0553
         AL    @06,@CF00054                                        0553
         ST    @06,NEXTBY                                          0553
*      ELSE                                                        0554
*       NEXTBY = ADDR(OBRPCUA) + ONE; /*ADDRESS OF LONG OBR CUA      */
         B     @RC00552                                            0554
@RF00552 LA    @06,OBRPCUA(,R7)                                    0554
         AL    @06,ONE                                             0554
         ST    @06,NEXTBY                                          0554
*       DEVCOMP = OBRDEV;             /*LONG OBR DEVICE TYPE @Z427VLS*/
@RC00552 MVC   DEVCOMP(2),OBRDEV(R7)                               0555
*   JOBNAME1 = OBRJOBID;              /*MOVE THE NAME INTO PRINT LINE*/
         MVC   JOBNAME1(8),OBRJOBID(R7)                            0556
*    IF LRTKEY1 ='36'X    /*WILL ALWAYS HAVE A TERMINAL NAME    */
*     ((LRTKEY1 = '34'X  LRTKEY1 = '32'X) & OBRTCAM = '0F'X) THEN 0557
         CLI   LRTKEY1(R7),X'36'                                   0557
         BE    @RT00557                                            0557
         CLI   LRTKEY1(R7),X'34'                                   0557
         BE    @GL00007                                            0557
         CLI   LRTKEY1(R7),X'32'                                   0557
         BNE   @RF00557                                            0557
@GL00007 CLI   OBRTCAM(R7),X'0F'                                   0557
         BNE   @RF00557                                            0557
@RT00557 DS    0H                                                  0558
*       TERMNAME = OBRTERMN;    /*MOVE TERMINAL NAME TO PRT BUFFER*/
         MVC   TERMNAME(8),OBRTERMN(R7)                            0558
*      END;                                                /*@Z427VLS*/
@RF00557 DS    0H                                                  0560
*   CALL CONVERT;                     /*GO CONVERT 1 & 1/2 BYTES     */
@RC00538 BAL   @14,CONVERT                                         0560
*   CALL DODEVICE;                    /*GO PROCESS THE DEVICE        */
         BAL   @14,DODEVICE                                        0561
* IF(SDRCOUNT = OFF &          /*END OF DAY COUNTER FLAG OFF @0001VLS*/
*    OBRTEMP  = OFF &          /*IT IS NOT AN TEMP OBR       @0001VLS*/
*    SHORTSW  = OFF &          /*IT IS NOT A SHORT OBR       @0001VLS*/
*    DISMOUNT = OFF ) &        /*IT IS NOT A DISMOUNT RECORD @0001VLS*/
*    OBRSEN1 ^= '40'X         /*AND NOT A INTERVENTION REQUIRED */ 0562
*    THEN                      /*IT MUST BE A OBR-PERM  ERROR   */ 0562
         TM    SDRCOUNT(R7),B'11100100'                            0562
         BNZ   @RF00562                                            0562
         LA    @06,64                                              0562
         ALR   @06,R7                                              0562
         SLR   @03,@03                                             0562
         IC    @03,OBRDEVDC(,R7)                                   0562
         SLA   @03,3                                               0562
         ALR   @06,@03                                             0562
         SLR   @03,@03                                             0562
         IC    @03,OBRLSDRC(,R7)                                   0562
         ALR   @06,@03                                             0562
         CLI   OBRSEN1(@06),X'40'                                  0562
         BE    @RF00562                                            0562
*    DO;                                                   /*@ZA19014*/
*     CALL OBRISPRM; /*CALL THE OBR PERM PROC TO BUILD  LINE @ZA19014*/
         BAL   @14,OBRISPRM                                        0564
*     OBRPRMCT(PTR) = OBRPRMCT(PTR) + ONE;               /*  @ZA19014*/
         L     @06,PTR                                             0565
         SLA   @06,2                                               0565
         L     @03,OBRPRMCT-4(@06)                                 0565
         AL    @03,ONE                                             0565
         ST    @03,OBRPRMCT-4(@06)                                 0565
*     RECTYP1 = OBRPRM; /*MOVE IN THE OBR IS PERMENT NAME    @ZA19014*/
         MVC   RECTYP1(7),OBRPRM                                   0566
*    END;                                                  /*@ZA19014*/
*    ELSE                                                          0568
*     IF SDRCOUNT = ON                /*IS IT AN OBR END OF DAY      */
*      THEN                                                        0568
         B     @RC00562                                            0568
@RF00562 TM    SDRCOUNT(R7),B'10000000'                            0568
         BNO   @RF00568                                            0568
*       DO;                                                /*@Z427VLS*/
*        RECTYP1 = OBREOD;            /*SET UP THE NAME FOR EOD      */
         MVC   RECTYP1(7),OBREOD                                   0570
*        OBREODCT(PTR) = OBREODCT(PTR) + ONE;              /*@Z427VLS*/
         L     @06,PTR                                             0571
         SLA   @06,2                                               0571
         L     @03,OBREODCT-4(@06)                                 0571
         AL    @03,ONE                                             0571
         ST    @03,OBREODCT-4(@06)                                 0571
*       END;                                               /*@Z427VLS*/
*      ELSE                                                        0573
*      IF SHORTSW = ON THEN                                        0573
         B     @RC00568                                            0573
@RF00568 TM    SHORTSW(R7),B'00100000'                             0573
         BNO   @RF00573                                            0573
*       DO;                                                /*@ZA19014*/
*        RECTYP1 = OBRSHT;     /*SET TYPE TO OBR SHORT       @ZA19014*/
         MVC   RECTYP1(7),OBRSHT                                   0575
*        OBRSHTCT(PTR) = OBRSHTCT(PTR) + ONE;           /*   @ZA19014*/
         L     @06,PTR                                             0576
         SLA   @06,2                                               0576
         L     @03,OBRSHTCT-4(@06)                                 0576
         AL    @03,ONE                                             0576
         ST    @03,OBRSHTCT-4(@06)                                 0576
*         END;                                             /*@Z427VLS*/
*        ELSE                                                      0578
*         IF OBRTEMP = ON THEN                                     0578
         B     @RC00573                                            0578
@RF00573 TM    OBRTEMP(R7),B'01000000'                             0578
         BNO   @RF00578                                            0578
*          DO;                                             /*@ZA19014*/
*           RECTYP1 = OBRTMP; /*MAKE THE LABLE A OBR TEMP    @ZA19014*/
         MVC   RECTYP1(7),OBRTMP                                   0580
*           OBRTMPCT(PTR) = OBRTMPCT(PTR) + ONE;      /*     @ZA19014*/
         L     @06,PTR                                             0581
         SLA   @06,2                                               0581
         L     @03,OBRTMPCT-4(@06)                                 0581
         AL    @03,ONE                                             0581
         ST    @03,OBRTMPCT-4(@06)                                 0581
*           END;                                           /*@Z427VLS*/
*          ELSE                                                    0583
*           IF DISMOUNT = ON          /*WAS IT A DISMOUNT OBR        */
*            THEN                                                  0583
         B     @RC00578                                            0583
@RF00578 TM    DISMOUNT(R7),B'00000100'                            0583
         BNO   @RF00583                                            0583
*             DO;                                          /*@Z427VLS*/
*              RECTYP1 = OBRDMT ;                          /*@Z427VLS*/
         MVC   RECTYP1(7),OBRDMT                                   0585
*              OBRDMTCT(PTR) = OBRDMTCT(PTR) + ONE;        /*@Z427VLS*/
         L     @06,PTR                                             0586
         SLA   @06,2                                               0586
         L     @03,OBRDMTCT-4(@06)                                 0586
         AL    @03,ONE                                             0586
         ST    @03,OBRDMTCT-4(@06)                                 0586
*             END;                                         /*@Z427VLS*/
*            ELSE                                                  0588
*             DO;                     /*IS A ODD OBR         @Z427VLS*/
         B     @RC00583                                            0588
@RF00583 DS    0H                                                  0589
*              RECTYP1 = OBR;         /*SET NAME TO JUST PLAIN OBR   */
         MVC   RECTYP1(7),OBR                                      0589
*              OBRCT(PTR) = OBRCT(PTR) + ONE;              /*@Z427VLS*/
         L     @06,PTR                                             0590
         SLA   @06,2                                               0590
         L     @03,OBRCT-4(@06)                                    0590
         AL    @03,ONE                                             0590
         ST    @03,OBRCT-4(@06)                                    0590
*              ADDNXT = ADDR(CSW1);   /*SET UP FOR CSW OUTPUT        */
         LA    @06,CSW1                                            0591
         ST    @06,ADDNXT                                          0591
*              NEXTBY = ADDR(OBRSTAT);/*SET UP WHERE TO GET THE DATA */
         LA    @06,OBRSTAT(,R7)                                    0592
         ST    @06,NEXTBY                                          0592
*              CALL CONVERT;          /*GO CONVERT THE NUM # STILL 2 */
         BAL   @14,CONVERT                                         0593
*              NUMBER = 1;            /*SET UP TO DO 1 BYTE  @Z427VLS*/
         MVC   NUMBER(4),@CF00054                                  0594
*              ADDNXT = ADDR(CMD1);   /*SET UP FOR CCW FIRST BYTE    */
         LA    @06,CMD1                                            0595
         ST    @06,ADDNXT                                          0595
*              NEXTBY = ADDR(OBRSRDS);/*ADDRESS OF WHERE THE DATA IS */
         LA    @06,OBRSRDS(,R7)                                    0596
         ST    @06,NEXTBY                                          0596
*              CALL CONVERT;          /*GO CONVERT THE CCMDTTO PRINT */
         BAL   @14,CONVERT                                         0597
*             END;                                         /*@Z427VLS*/
*                                                                  0598
*/*EREPSEND  */                                                    0599
*       GO TO L000113;                                             0599
         B     L000113                                             0599
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL SFT TYPE RECORDS           @Z427VLS*/
* /*                                                         @Z427VLS*/
*                                                                  0601
*/*EREPSUB  */                                                     0601
*L00014:                                                           0601
*     DO;                                               /*@Z427VLS*/
L00014   DS    0H                                                  0602
*   CALL TIME;                     /*GO AND SET UP THE TIME  FROM REC*/
         BAL   @14,TIME                                            0602
*   JOBNAME1 = SFTJOBID;           /*MOVE IN THE JOB NAME    @Z427VLS*/
         MVC   JOBNAME1(8),SFTJOBID(R7)                            0603
*   NUMBER = EIGHT;               /*NUMBER OF BYTES TO CHANGE       */
         MVC   NUMBER(4),@CF00065                                  0604
*   ADDNXT = ADDR(PSWMCH);        /*WHERE TO PUT THE CONVERTED DATA */
         LA    @06,PSWMCH                                          0605
         ST    @06,ADDNXT                                          0605
*   NEXTBY = ADDR(SFTPROGC);      /*WHERE IN THE RECORD TO GET DATA */
         LA    @06,SFTPROGC(,R7)                                   0606
         ST    @06,NEXTBY                                          0606
*   CALL CONVERT;                 /*GO AND CONVERT THE DATA  @Z427VLS*/
         BAL   @14,CONVERT                                         0607
*   RCYRYXIT = SFTREXN;                                    /*@Z427VLS*/
         MVC   RCYRYXIT(8),SFTREXN(R7)                             0608
*   COMPMOD = SFTMODN;                                     /*@Z427VLS*/
         MVC   COMPMOD(8),SFTMODN(R7)                              0609
*   CSECTID = SFTCSECT;                                    /*@Z427VLS*/
         MVC   CSECTID(8),SFTCSECT(R7)                             0610
* NUMBER = 4;                /*REASON CODE HAS 4 BYTES OF INFO*/   0611
         LA    @06,4                                               0611
         ST    @06,NUMBER                                          0611
* ADDNXT = ADDR(REASON) -2; /*LOCATION IN THE PRINT LINE     @0098VLS*/
         LA    @03,REASON                                          0612
         BCTR  @03,0                                               0612
         BCTR  @03,0                                               0612
         ST    @03,ADDNXT                                          0612
* NEXTBY = ADDR(SFTABNDC) + 4;/*WHERE INFO IS                @0098VLS*/
         LA    @03,SFTABNDC(,R7)                                   0613
         ALR   @03,@06                                             0613
         ST    @03,NEXTBY                                          0613
* CALL CONVERT;                                            /*@0098VLS*/
         BAL   @14,CONVERT                                         0614
* IF (LRTERRID & '20'X) = '20'X THEN                               0615
         MVC   @TS00001(1),LRTERRID(R7)                            0615
         NI    @TS00001,X'20'                                      0615
         CLI   @TS00001,X'20'                                      0615
         BNE   @RF00615                                            0615
*  DO;                                                     /*@0098VLS*/
*   NUMBER = 10;  /*ERROR ID IS TEN BYTES LONG               @0098VLS*/
         LA    @06,10                                              0617
         ST    @06,NUMBER                                          0617
*   ADDNXT = ADDR(ERRORID1); /*WHERE IN THE LINE TO PUT IT   @0098VLS*/
         LA    @03,ERRORID1                                        0618
         ST    @03,ADDNXT                                          0618
*   NEXTBY = ADDR(RERR);/*LOCATION OF THE ERROR ID(R7 + RECLNGTH + 10*/
         LR    @03,R7                                              0619
         AH    @03,RECLNGTH(,R2)                                   0619
         SLR   @03,@06                                             0619
         ST    @03,NEXTBY                                          0619
*   CALL CONVERT;   /*CONVERT TO PRINTABLE                   @0098VLS*/
         BAL   @14,CONVERT                                         0620
*  END;                                                    /*@0098VLS*/
* ELSE                                                             0622
*  ERRORNA = NOTAPPLY;   /*PUT THE WORDS DOES NOT APPLY      @0098VLS*/
         B     @RC00615                                            0622
@RF00615 MVC   ERRORNA(8),NOTAPPLY                                 0622
*   IF SFTKEY1 = '40'X                                             0623
*    THEN                                                          0623
@RC00615 CLI   SFTKEY1(R7),X'40'                                   0623
         BNE   @RF00623                                            0623
*     DO;                                                  /*@Z427VLS*/
*      RECTYP1  = SFTABN;                                  /*@Z427VLS*/
         MVC   RECTYP1(7),SFTABN                                   0625
*      SFTABNCT(PTR) = SFTABNCT(PTR) + ONE;                /*@Z427VLS*/
         L     @06,PTR                                             0626
         SLA   @06,2                                               0626
         L     @03,SFTABNCT-4(@06)                                 0626
         AL    @03,ONE                                             0626
         ST    @03,SFTABNCT-4(@06)                                 0626
*     END;                                                 /*@Z427VLS*/
*    ELSE                                                          0628
*     IF SFTKEY1 = '42'X                                           0628
*      THEN                                                        0628
         B     @RC00623                                            0628
@RF00623 CLI   SFTKEY1(R7),X'42'                                   0628
         BNE   @RF00628                                            0628
*       DO;                                                /*@Z427VLS*/
*        RECTYP1 = SFTPI;                                  /*@Z427VLS*/
         MVC   RECTYP1(7),SFTPI                                    0630
*        SFTPICT(PTR) = SFTPICT(PTR) + ONE;                /*@Z427VLS*/
         L     @06,PTR                                             0631
         SLA   @06,2                                               0631
         L     @03,SFTPICT-4(@06)                                  0631
         AL    @03,ONE                                             0631
         ST    @03,SFTPICT-4(@06)                                  0631
*       END;                                               /*@Z427VLS*/
*      ELSE                                                        0633
*       IF SFTKEY1 = '44'X                                         0633
*        THEN                                                      0633
         B     @RC00628                                            0633
@RF00628 CLI   SFTKEY1(R7),X'44'                                   0633
         BNE   @RF00633                                            0633
*         DO;                                              /*@Z427VLS*/
*          RECTYP1 = SFTRST;                               /*@Z427VLS*/
         MVC   RECTYP1(7),SFTRST                                   0635
*          SFTRSTCT(PTR) = SFTRSTCT(PTR) + ONE;            /*@Z427VLS*/
         L     @06,PTR                                             0636
         SLA   @06,2                                               0636
         L     @03,SFTRSTCT-4(@06)                                 0636
         AL    @03,ONE                                             0636
         ST    @03,SFTRSTCT-4(@06)                                 0636
*         END;                                             /*@Z427VLS*/
*        ELSE                                                      0638
*         IF SFTKEY1 = '48'X                                       0638
*          THEN                                                    0638
         B     @RC00633                                            0638
@RF00633 CLI   SFTKEY1(R7),X'48'                                   0638
         BNE   @RF00638                                            0638
*           DO;                                            /*@Z427VLS*/
*            RECTYP1 = SFTMCH;                             /*@Z427VLS*/
         MVC   RECTYP1(7),SFTMCH                                   0640
*            SFTMCHCT(PTR) = SFTMCHCT(PTR) + ONE;          /*@Z427VLS*/
         L     @06,PTR                                             0641
         SLA   @06,2                                               0641
         L     @03,SFTMCHCT-4(@06)                                 0641
         AL    @03,ONE                                             0641
         ST    @03,SFTMCHCT-4(@06)                                 0641
*           END;                                           /*@Z427VLS*/
*          ELSE                                                    0643
*            IF SFTKEY1 = '4F'X      /*SHORT RECORD SOFT     @ZA27247*/
*             THEN                                                 0643
         B     @RC00638                                            0643
@RF00638 CLI   SFTKEY1(R7),X'4F'                                   0643
         BNE   @RF00643                                            0643
*              DO;                                         /*@ZA27247*/
*               RECTYP1 = SFT;                             /*@ZA27247*/
         MVC   RECTYP1(7),SFT                                      0645
*               SFTCT(PTR) = SFTCT(PTR) + ONE;             /*@ZA27247*/
         L     @06,PTR                                             0646
         SLA   @06,2                                               0646
         L     @03,SFTCT-4(@06)                                    0646
         AL    @03,ONE                                             0646
         ST    @03,SFTCT-4(@06)                                    0646
*               GENERATE;                                  /*@ZA27247*/
                 MVC JOBNAME1,=CL8' '
                 MVC LOSTSOFT(54),LOSTMSG
*              END;                                        /*@ZA27247*/
*             ELSE                                                 0649
*              DO;                                         /*@ZA27247*/
         B     @RC00643                                            0649
@RF00643 DS    0H                                                  0650
*               RECTYP1 = SFT;                             /*@ZA27247*/
         MVC   RECTYP1(7),SFT                                      0650
*               SFTCT(PTR) = SFTCT(PTR) + ONE;             /*@ZA27247*/
         L     @06,PTR                                             0651
         SLA   @06,2                                               0651
         L     @03,SFTCT-4(@06)                                    0651
         AL    @03,ONE                                             0651
         ST    @03,SFTCT-4(@06)                                    0651
*              END;                                        /*@ZA27247*/
*   CPU12 = EVLETTER(PTR);                                 /*@Z427VLS*/
*                                                                  0653
@RC00643 DS    0H                                                  0653
@RC00638 DS    0H                                                  0653
@RC00633 DS    0H                                                  0653
@RC00628 DS    0H                                                  0653
@RC00623 L     @06,PTR                                             0653
         MH    @06,@CH00080                                        0653
         L     @03,EVPTR(,R2)                                      0653
         ALR   @03,@06                                             0653
         MVC   CPU12(1),EVLETTER-6(@03)                            0653
*/*EREPSEND  */                                                    0654
*       GO TO L000113;                                             0654
         B     L000113                                             0654
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL IPL TYPE RECORDS           @Z427VLS*/
*                                                                  0656
*/*EREPSUB  */                                                     0656
*L00015:                                                           0656
*     DO;                                               /*@Z427VLS*/
L00015   DS    0H                                                  0657
*     CALL TIME;                     /*CONVERT THE TIME FOR THIS REC */
         BAL   @14,TIME                                            0657
*     RECTYP1 = IPL;                 /*PUT IN THE TYPE OF RECORD     */
         MVC   RECTYP1(7),IPL                                      0658
*     IPLCT(PTR) = IPLCT(PTR) + ONE; /*ADD ONE TO THE IPL COUNTER    */
         L     @06,PTR                                             0659
         LR    @03,@06                                             0659
         SLA   @03,2                                               0659
         L     @15,ONE                                             0659
         L     @14,IPLCT-4(@03)                                    0659
         ALR   @14,@15                                             0659
         ST    @14,IPLCT-4(@03)                                    0659
*     CPU12 = EVLETTER(PTR);         /*MOVE IN THE CPU  LETTER       */
         MH    @06,@CH00080                                        0660
         L     @03,EVPTR(,R2)                                      0660
         ALR   @03,@06                                             0660
         MVC   CPU12(1),EVLETTER-6(@03)                            0660
*     REASON = IPLREAS;              /*MOVE IN THE IPL REASON@ZA24916*/
         MVI   REASON+2,C' '                                       0661
         MVC   REASON+3(3),REASON+2                                0661
         MVC   REASON(2),IPLREAS(R7)                               0661
*     NUMBER = ONE;                  /*SET UP # OF BYTES TO CONVERT  */
         ST    @15,NUMBER                                          0662
*     ADDNXT = ADDR(SSYS);           /*SET ADDRESS OF REASON CODE    */
         LA    @06,SSYS                                            0663
         ST    @06,ADDNXT                                          0663
*     NEXTBY = ADDR(IPLSYSID);       /*SET ADD OF WHERE IN RECORD ID */
         LA    @06,IPLSYSID(,R7)                                   0664
         ST    @06,NEXTBY                                          0664
*     CALL CONVERT;                  /*GO CONVERT TO PRINTABLE       */
         BAL   @14,CONVERT                                         0665
*     JOBNAME1 = NOTAPPLY;                                 /*@Z427VLS*/
*                                                                  0666
         MVC   JOBNAME1(8),NOTAPPLY                                0666
*/*EREPSEND  */                                                    0667
*       GO TO L000113;                                             0667
         B     L000113                                             0667
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL DDR TYPE RECORDS           @Z427VLS*/
*                                                                  0669
*/*EREPSUB  */                                                     0669
*L00016:                                                           0669
*     DO;                                               /*@Z427VLS*/
L00016   DS    0H                                                  0670
*    CALL TIME;                 /*MOVE THE TIME INTO THE LINE       */
         BAL   @14,TIME                                            0670
*     IF DDRDEPSW = '20'X        /*WAS IT AN OPERATOR REQUEST        */
*        THEN                    /*YES IT WAS                @Z427VLS*/
         CLI   DDRDEPSW(R7),X'20'                                  0671
         BNE   @RF00671                                            0671
*         DO;                                              /*@Z427VLS*/
*          RECTYP1 = DDROPR;     /*MOVE DDR-OPR INTO THE PRINT LINE  */
         MVC   RECTYP1(7),DDROPR                                   0673
*          DDROPRCT(PTR) = DDROPRCT(PTR) + ONE;            /*@Z427VLS*/
         L     @06,PTR                                             0674
         SLA   @06,2                                               0674
         L     @03,DDROPRCT-4(@06)                                 0674
         AL    @03,ONE                                             0674
         ST    @03,DDROPRCT-4(@06)                                 0674
*          JOBNAME1 = DDRJOBID;  /*MOVE IN THE JOB NAME      @Z427VLS*/
         MVC   JOBNAME1(8),DDRJOBID(R7)                            0675
*         END;                                             /*@Z427VLS*/
*        ELSE                                                      0677
*         DO;                                              /*@Z427VLS*/
         B     @RC00671                                            0677
@RF00671 DS    0H                                                  0678
*          IF DDRDEPSW = '10'X   /*WAS IT A SYSTEM REQUESTED IPL     */
*            THEN                                                  0678
         CLI   DDRDEPSW(R7),X'10'                                  0678
         BNE   @RF00678                                            0678
*             DO;                                          /*@Z427VLS*/
*              RECTYP1 = DDRSYS; /*MOVE DDR-SYS INTO THE PRINT LINE  */
         MVC   RECTYP1(7),DDRSYS                                   0680
*              DDRSYSCT(PTR) = DDRSYSCT(PTR) + ONE;        /*@Z427VLS*/
         L     @06,PTR                                             0681
         SLA   @06,2                                               0681
         L     @03,DDRSYSCT-4(@06)                                 0681
         AL    @03,ONE                                             0681
         ST    @03,DDRSYSCT-4(@06)                                 0681
*             END;                                         /*@Z427VLS*/
*            ELSE                                                  0683
*             DO;                                          /*@Z427VLS*/
         B     @RC00678                                            0683
@RF00678 DS    0H                                                  0684
*              RECTYP1 = DDR;    /*MOVE JUST PLAIN DDR IN TO PRINT   */
         MVC   RECTYP1(7),DDR                                      0684
*              DDRCT(PTR) = DDRCT(PTR) + ONE;              /*@Z427VLS*/
         L     @06,PTR                                             0685
         SLA   @06,2                                               0685
         L     @03,DDRCT-4(@06)                                    0685
         AL    @03,ONE                                             0685
         ST    @03,DDRCT-4(@06)                                    0685
*             END;                                         /*@Z427VLS*/
*         END;                                             /*@Z427VLS*/
@RC00678 DS    0H                                                  0688
*     IF(DDRDEPSW & 'F0'X) = '10'X THEN                            0688
@RC00671 MVC   @TS00001(1),DDRDEPSW(R7)                            0688
         NI    @TS00001,X'F0'                                      0688
         CLI   @TS00001,X'10'                                      0688
         BNE   @RF00688                                            0688
*      JOBNAME1 = DDRJOBID;      /*THEN MOVE IN THE JOB NAME @Z427VLS*/
         MVC   JOBNAME1(8),DDRJOBID(R7)                            0689
*     CPU12 = EVLETTER(PTR);     /*MOVE IN CPU LETTER        @Z427VLS*/
@RF00688 L     @06,PTR                                             0690
         MH    @06,@CH00080                                        0690
         L     @03,EVPTR(,R2)                                      0690
         ALR   @03,@06                                             0690
         MVC   CPU12(1),EVLETTER-6(@03)                            0690
*     DEVCOMP = DDRDEV2;         /*SET UP THE DEVICE TYPE    @Z427VLS*/
         MVC   DEVCOMP(2),DDRDEV2(R7)                              0691
*     CALL DODEVICE;             /*PROCESS THE DEVICE NAME   @Z427VLS*/
         BAL   @14,DODEVICE                                        0692
*     DEVSAVE = DEVTYPE1;        /*SAVE THIS TO MOVE INTO THE PRINT  */
         MVC   DEVSAVE(4),DEVTYPE1                                 0693
*     DEVCOMP = DDRCODE2;        /*SET UP THE FROM DEVICE TYPE       */
         MVC   DEVCOMP(2),DDRCODE2(R7)                             0694
*     CALL DODEVICE;             /*CONVERT THE FROM DEVICE   @Z427VLS*/
         BAL   @14,DODEVICE                                        0695
*     SWITCH1 = ON;              /*SET FOR 1 & 1/2 BYTES OUT OF CONV */
         OI    SWITCH1,B'10000000'                                 0696
*     NUMBER = 2;                /*SET UP TO PROCESS TWO BYTES       */
         MVC   NUMBER(4),@CF00073                                  0697
*     NEXTBY = ADDR(DDRFCUA)+1; /*WHERE TO GET THE CUA       @Z427VLS*/
         LA    @06,DDRFCUA(,R7)                                    0698
         AL    @06,@CF00054                                        0698
         ST    @06,NEXTBY                                          0698
*     ADDNXT = ADDR(CUA11);      /*WHERE TO PUT THE CUA      @Z427VLS*/
         LA    @06,CUA11                                           0699
         ST    @06,ADDNXT                                          0699
*     CALL CONVERT;              /*PUT FROM CUA IN TO LINE   @Z427VLS*/
         BAL   @14,CONVERT                                         0700
*     SWITCH1= ON;               /*SAME DO 1 & 1/2 BYTES     @Z427VLS*/
         OI    SWITCH1,B'10000000'                                 0701
*     NEXTBY = ADDR(DDRTOCUA)+1; /*WHERE TO PUT TO CUA       @Z427VLS*/
         LA    @06,DDRTOCUA(,R7)                                   0702
         AL    @06,@CF00054                                        0702
         ST    @06,NEXTBY                                          0702
*     ADDNXT = ADDR(TOCUA);                                /*@Z427VLS*/
         LA    @06,TOCUA                                           0703
         ST    @06,ADDNXT                                          0703
*     CALL CONVERT;                                        /*@Z427VLS*/
         BAL   @14,CONVERT                                         0704
*     GEN(MVC   CMD1(12),DDRSPEC);                         /*@Z427VLS*/
         MVC   CMD1(12),DDRSPEC
*     VOLUME1 = DDRVOL1;/*VOLUME FROM ID                     @Z427VLS*/
         MVC   VOLUME1(6),DDRVOL1(R7)                              0706
*     IF DDRVOL2 ^= BLANK1 THEN  /*WILL BE BLANK IF NOT ANY TO VOLUME*/
         CLC   DDRVOL2(6,R7),BLANK1                                0707
         BE    @RF00707                                            0707
*     DO;                                                  /*@Z427VLS*/
*     GEN(MVC   BB1(2),TOO);     /*MOVE WORD TO INTO THE LINE        */
         MVC   BB1(2),TOO
*     R9 = ADDR(DDRVOL2);                                  /*@Z427VLS*/
         LA    R9,DDRVOL2(,R7)                                     0710
*     GEN(MVC  BB1+3(6),0(R9));                            /*@Z427VLS*/
         MVC  BB1+3(6),0(R9)
*     END;                                                 /*@Z427VLS*/
*                                                                  0712
*/*EREPSEND  */                                                    0713
*       GO TO L000113;                                             0713
         B     L000113                                             0713
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL MIH TYPE RECORDS           @Z427VLS*/
*                                                                  0715
*/*EREPSUB  */                                                     0715
*L00017:                                                           0715
*     DO;                                               /*@Z427VLS*/
L00017   DS    0H                                                  0716
*     CALL TIME;                /*GO FORMAT THE TIME FROM THE RECORD */
         BAL   @14,TIME                                            0716
*     JOBNAME1 = MIHJOBID;      /*SET UP THE TYPE OF RECORD ONLY 1   */
         MVC   JOBNAME1(8),MIHJOBID(R7)                            0717
*     CPU12 = EVLETTER(PTR);    /*MOVE IN THE CPU LETTER FILT4 BUILT */
         L     @06,PTR                                             0718
         LR    @03,@06                                             0718
         MH    @03,@CH00080                                        0718
         L     @01,EVPTR(,R2)                                      0718
         ALR   @01,@03                                             0718
         MVC   CPU12(1),EVLETTER-6(@01)                            0718
*     VOLUME1 = MIHVOL;         /*MOVE IN THE VOLUME NAME    @Z427VLS*/
         MVC   VOLUME1(6),MIHVOL(R7)                               0719
*     IF MIHCEBIT = ON          /*WAS RECORD CAUSED BY CONTROL END   */
*       THEN                                                       0720
         TM    MIHCEBIT(R7),B'10000000'                            0720
         BNO   @RF00720                                            0720
*         DO;                                              /*@Z427VLS*/
*          RECTYP1 = MIHCE;     /*MAKE THE RECORD TYPE MIH-CE        */
         MVC   RECTYP1(7),MIHCE                                    0722
*          MIHCECT(PTR) = MIHCECT(PTR) + ONE;              /*@Z427VLS*/
         SLA   @06,2                                               0723
         L     @03,MIHCECT-4(@06)                                  0723
         AL    @03,ONE                                             0723
         ST    @03,MIHCECT-4(@06)                                  0723
*         END;                                             /*@Z427VLS*/
*       ELSE                                                       0725
*        DO;                                               /*@Z427VLS*/
         B     @RC00720                                            0725
@RF00720 DS    0H                                                  0726
*         IF MIHDEBIT = ON      /*WAS RECORD FROM DEVICE END @Z427VLS*/
*           THEN                                                   0726
         TM    MIHDEBIT(R7),B'01000000'                            0726
         BNO   @RF00726                                            0726
*            DO;                                           /*@Z427VLS*/
*             RECTYP1 = MIHDE;  /*SET RECORD NAME TO MIH-DE  @Z427VLS*/
         MVC   RECTYP1(7),MIHDE                                    0728
*             MIHDECT(PTR) = MIHDECT(PTR) + ONE;           /*@Z427VLS*/
         L     @06,PTR                                             0729
         SLA   @06,2                                               0729
         L     @03,MIHDECT-4(@06)                                  0729
         AL    @03,ONE                                             0729
         ST    @03,MIHDECT-4(@06)                                  0729
*            END;                                          /*@Z427VLS*/
*           ELSE                                                   0731
*            DO;                                           /*@Z427VLS*/
         B     @RC00726                                            0731
@RF00726 DS    0H                                                  0732
*             RECTYP1 = MIH;    /*SET TO PLAIN MIH TYPE RECORD       */
         MVC   RECTYP1(7),MIH                                      0732
*             MIHCT(PTR) = MIHCT(PTR) + ONE;               /*@Z427VLS*/
         L     @06,PTR                                             0733
         SLA   @06,2                                               0733
         L     @03,MIHCT-4(@06)                                    0733
         AL    @03,ONE                                             0733
         ST    @03,MIHCT-4(@06)                                    0733
*            END;                                          /*@Z427VLS*/
*        END;                                              /*@Z427VLS*/
@RC00726 DS    0H                                                  0736
*     SWITCH1 = ON;             /*SET TO DROP LAST 1/2 BYTE  @Z427VLS*/
@RC00720 OI    SWITCH1,B'10000000'                                 0736
*     NUMBER = 2 ;              /*SET UP TO PROCESS 2 BYTES OF DATA  */
         MVC   NUMBER(4),@CF00073                                  0737
*     NEXTBY = ADDR(MIHCUA)+ONE;/*LOCATION OF CUA IN THE RECORD      */
         LA    @06,MIHCUA(,R7)                                     0738
         AL    @06,ONE                                             0738
         ST    @06,NEXTBY                                          0738
*     ADDNXT = ADDR(CUA11);     /*ADDRESS OF WHERE TO PUT CONVERTED  */
         LA    @06,CUA11                                           0739
         ST    @06,ADDNXT                                          0739
*     CALL CONVERT;             /*GO CHANGE THE FORMAT OF THE CUA    */
         BAL   @14,CONVERT                                         0740
*     DEVCOMP = MIHCODE2;       /*SET UP THE DEVICE TO CHANGE        */
         MVC   DEVCOMP(2),MIHCODE2(R7)                             0741
*     CALL DODEVICE;            /*PROCESS THE DEVICE NAME    @Z427VLS*/
*                                                                  0742
         BAL   @14,DODEVICE                                        0742
*/*EREPSEND  */                                                    0743
*       GO TO L000113;                                             0743
         B     L000113                                             0743
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL EOD TYPE RECORDS           @Z427VLS*/
*                                                                  0745
*/*EREPSUB  */                                                     0745
*L00018:                                                           0745
*     DO;                                               /*@Z427VLS*/
L00018   DS    0H                                                  0746
*     CALL TIME;                /*GO FORMAT THE TIME FROM THE RECORD */
         BAL   @14,TIME                                            0746
*     CPU12 = EVLETTER(PTR);    /*MOVE IN THE LETTER FILT4 ASSIGNED  */
         L     @06,PTR                                             0747
         LR    @03,@06                                             0747
         MH    @03,@CH00080                                        0747
         L     @01,EVPTR(,R2)                                      0747
         ALR   @01,@03                                             0747
         MVC   CPU12(1),EVLETTER-6(@01)                            0747
*     RECTYP1 = EOD;            /*SET THE RECORD TYPE TO PLAIN EOD   */
         MVC   RECTYP1(7),EOD                                      0748
*     EODCT(PTR) = EODCT(PTR) + ONE;                       /*@Z427VLS*/
         SLA   @06,2                                               0749
         L     @03,EODCT-4(@06)                                    0749
         AL    @03,ONE                                             0749
         ST    @03,EODCT-4(@06)                                    0749
*     JOBNAME1 = NOTAPPLY;                                 /*@Z427VLS*/
*                                                                  0750
         MVC   JOBNAME1(8),NOTAPPLY                                0750
*/*EREPSEND  */                                                    0751
*       GO TO L000113;                                             0751
         B     L000113                                             0751
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL MDR TYPE RECORDS           @Z427VLS*/
*                                                                  0753
*/*EREPSUB  */                                                     0753
*L00019:                                                           0753
*     DO;                                               /*@Z427VLS*/
L00019   DS    0H                                                  0754
*    CALL TIME;                     /*GO FORMAT THE TIME FROM RECORD */
         BAL   @14,TIME                                            0754
*    CPU12 = EVLETTER(PTR);         /*MOVE IN THE LETTER FILT4 BUILT */
         L     @06,PTR                                             0755
         MH    @06,@CH00080                                        0755
         L     @03,EVPTR(,R2)                                      0755
         ALR   @03,@06                                             0755
         MVC   CPU12(1),EVLETTER-6(@03)                            0755
*    SWITCH1 = ON;                  /*SET SWITCH SO 1/2 BYTE IS DROP */
         OI    SWITCH1,B'10000000'                                 0756
*    NUMBER = TWO;                  /*SET TO PROCESS TWO BYTES       */
         L     @06,TWO                                             0757
         ST    @06,NUMBER                                          0757
*    ADDNXT = ADDR(CUA11);          /*SET UP THE ADDRESS TO PUT IT   */
         LA    @06,CUA11                                           0758
         ST    @06,ADDNXT                                          0758
*    NEXTBY = ADDR(TPRCUA);         /*SET UP WHERE TO FIND THE DATA  */
         LA    @06,TPRCUA(,R7)                                     0759
         ST    @06,NEXTBY                                          0759
*    CALL CONVERT;                  /*GO CONVERT THE DATA TO PRINT   */
         BAL   @14,CONVERT                                         0760
* DEVTYPE1 = UKNO;                                         /*@G51DGGB*/
         MVC   DEVTYPE1(4),UKNO                                    0761
* CALL IFCDEVIC(32,TPRDEV,DEVTYPE1);                       /*@G51DGGB*/
         MVC   @AL00001(12),@AL00762                               0762
         LA    @06,TPRDEV(,R7)                                     0762
         ST    @06,@AL00001+4                                      0762
         L     @15,@CV01334                                        0762
         LA    @01,@AL00001                                        0762
         BALR  @14,@15                                             0762
*    JOBNAME1 = NOTAPPLY;           /*DOES NOT APPLY FOR MDR RECORDS */
         MVC   JOBNAME1(8),NOTAPPLY                                0763
*    IF TPRDEV = '01'X             /*IS THIS A DASD DEVICE  @Z427VLS*/
*       TPRDEV = '02'X                                            0764
*       TPRDEV = '09'X                                            0764
*       TPRDEV = '0A'X                                            0764
*       TPRDEV = '0E'X                                            0764
*       TPRDEV = '11'X                                            0764
*       TPRDEV = '12'X                                             0764
*         THEN                                                     0764
         CLI   TPRDEV(R7),X'01'                                    0764
         BE    @RT00764                                            0764
         CLI   TPRDEV(R7),X'02'                                    0764
         BE    @RT00764                                            0764
         CLI   TPRDEV(R7),X'09'                                    0764
         BE    @RT00764                                            0764
         CLI   TPRDEV(R7),X'0A'                                    0764
         BE    @RT00764                                            0764
         CLI   TPRDEV(R7),X'0E'                                    0764
         BE    @RT00764                                            0764
         CLI   TPRDEV(R7),X'11'                                    0764
         BE    @RT00764                                            0764
         CLI   TPRDEV(R7),X'12'                                    0764
         BNE   @RF00764                                            0764
@RT00764 DS    0H                                                  0765
*           DO;                                            /*@Z427VLS*/
*    VOLUME1 = TPRVOL;              /*PUT IN THE VOLID       @Z427VLS*/
         MVC   VOLUME1(6),TPRVOL(R7)                               0766
*            RECTYP1 = MDRDAS;                             /*@Z427VLS*/
         MVC   RECTYP1(7),MDRDAS                                   0767
*            MDRDASCT(PTR) = MDRDASCT(PTR) + ONE;          /*@Z427VLS*/
         L     @06,PTR                                             0768
         SLA   @06,2                                               0768
         L     @03,MDRDASCT-4(@06)                                 0768
         AL    @03,ONE                                             0768
         ST    @03,MDRDASCT-4(@06)                                 0768
*            NUMBER = 16;            /*NUMBER OF BYTES TO DO @Z427VLS*/
         MVC   NUMBER(4),@CF00088                                  0769
*            NEXTBY = ADDR(TPRVOL) + (TPRBUFC &'0F'X) + 14;/*@Z427VLS*/
         LA    @06,TPRVOL(,R7)                                     0770
         LA    @03,15                                              0770
         SLR   @15,@15                                             0770
         IC    @15,TPRBUFC(,R7)                                    0770
         NR    @03,@15                                             0770
         ALR   @06,@03                                             0770
         AL    @06,@CF01340                                        0770
         ST    @06,NEXTBY                                          0770
*            ADDNXT = ADDR(TEMPSAVE);/*ADDRESS OF WHERE TO PUT IT    */
         LA    @06,TEMPSAVE                                        0771
         ST    @06,ADDNXT                                          0771
*            CALL CONVERT;           /*GO CONVERT TO PRINTABLE       */
         BAL   @14,CONVERT                                         0772
*            GENERATE;                                     /*@Z427VLS*/
              MVC  SENSEA3(8),TEMPSAVE
              MVC  SENSEA4(8),TEMPSAVE+8
              MVC  SENSEA5(8),TEMPSAVE+16
              MVC  SENSEA6(8),TEMPSAVE+24
*           END;                                           /*@Z427VLS*/
*          ELSE                                                    0775
*           DO;                                            /*@Z427VLS*/
         B     @RC00764                                            0775
@RF00764 DS    0H                                                  0776
*           MDRCT(PTR) = MDRCT(PTR) + ONE;                 /*@Z427VLS*/
         L     @06,PTR                                             0776
         SLA   @06,2                                               0776
         L     @03,MDRCT-4(@06)                                    0776
         AL    @03,ONE                                             0776
         ST    @03,MDRCT-4(@06)                                    0776
*           RECTYP1 = MDR;                                 /*@Z427VLS*/
         MVC   RECTYP1(7),MDR                                      0777
*           END;                                           /*@Z427VLS*/
*                                                                  0778
*/*EREPSEND  */                                                    0779
*       GO TO L000113;                                             0779
         B     L000113                                             0779
*     END;                                              /*@Z427VLS*/
*/*EREPSUB  */                                                     0781
*L000110:                                                          0781
*   DO;                                                 /*@G51DGGB*/
L000110  DS    0H                                                  0782
* CALL FRAME;                                              /*@G51DGGB*/
         BAL   @14,FRAME                                           0782
*/*EREPSEND  */                                                    0783
*     GO TO L000113;                                               0783
         B     L000113                                             0783
*   END;                                                /*@G51DGGB*/
*/*EREPSUB  */                                                     0785
*L000111:                                                          0785
*   DO;                                                 /*@G51DGGB*/
L000111  DS    0H                                                  0786
* CALL FRAME;                                              /*@G51DGGB*/
         BAL   @14,FRAME                                           0786
*/*EREPSEND  */                                                    0787
*     GO TO L000113;                                               0787
         B     L000113                                             0787
*   END;                                                /*@G51DGGB*/
*/*EREPCEND  */                                                    0789
*L000112:;                                                         0789
*L000113:;                                                /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00010 DS    0H                                                  0791
@EF00010 DS    0H                                                  0791
@ER00010 LM    @14,@12,@SA00010                                    0791
         BR    @14                                                 0791
*OBRISPRM: PROC;                                           /*@Z427VLS*/
OBRISPRM STM   @14,@12,@SA00011                                    0792
* /*******************************************************************/
*/** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL PROCESS ALL OBR RECORDS WITH PERM ERROR       */
*       GEN(MVI  TEMPSAVE,X'40');                          /*@Z427VLS*/
         MVI  TEMPSAVE,X'40'
*       GEN(MVC  TEMPSAVE+1(71),TEMPSAVE);                 /*@Z427VLS*/
         MVC  TEMPSAVE+1(71),TEMPSAVE
*              NUMBER = 1;            /*SET UP TO DO 1 BYTE  @Z427VLS*/
         MVC   NUMBER(4),@CF00054                                  0795
*              ADDNXT = ADDR(CMD1);   /*SET UP FOR CCW FIRST BYTE    */
         LA    @06,CMD1                                            0796
         ST    @06,ADDNXT                                          0796
*              NEXTBY = ADDR(OBRSRDS);/*ADDRESS OF WHERE THE DATA IS */
         LA    @06,OBRSRDS(,R7)                                    0797
         ST    @06,NEXTBY                                          0797
*              CALL CONVERT;          /*GO CONVERT THE CCMDTTO PRINT */
         BAL   @14,CONVERT                                         0798
*       NUMBER = 2;                                        /*@Z427VLS*/
         MVC   NUMBER(4),@CF00073                                  0799
*       ADDNXT = ADDR(CSW1);          /*SET UP TO CONVERT THE CSW    */
         LA    @06,CSW1                                            0800
         ST    @06,ADDNXT                                          0800
*       NEXTBY = ADDR(OBRSTAT);       /*ADDRESS OF DATA TO CONVERT   */
         LA    @06,OBRSTAT(,R7)                                    0801
         ST    @06,NEXTBY                                          0801
*       CALL CONVERT;                 /*CALL TO CONVERT THE DATA     */
         BAL   @14,CONVERT                                         0802
*       NEXTBY = ADDR(OBRVOL) + EIGHT * OBRDEVDC  + OBRLSDRC;      0803
         LA    @06,OBRVOL(,R7)                                     0803
         SLR   @03,@03                                             0803
         IC    @03,OBRDEVDC(,R7)                                   0803
         SLA   @03,3                                               0803
         ALR   @06,@03                                             0803
         SLR   @03,@03                                             0803
         IC    @03,OBRLSDRC(,R7)                                   0803
         ALR   @06,@03                                             0803
         ST    @06,NEXTBY                                          0803
*       ADDNXT = ADDR(TEMPSAVE) ;     /*SET UP SPECIAL TO CONVERT TO */
         LA    @06,TEMPSAVE                                        0804
         ST    @06,ADDNXT                                          0804
*       NUMBER = OBRSBCNT;            /*SET UP NUMBER OF SENSE BYTES */
         SLR   @06,@06                                             0805
         ICM   @06,3,OBRSBCNT(R7)                                  0805
         ST    @06,NUMBER                                          0805
*       IF NUMBER > 40 THEN                                        0806
         LA    @03,40                                              0806
         CR    @06,@03                                             0806
         BNH   @RF00806                                            0806
*         NUMBER = 40;                                     /*@Z427VLS*/
         ST    @03,NUMBER                                          0807
*       CALL CONVERT;                 /*GO AND CONVERT THE NUMBERS   */
@RF00806 BAL   @14,CONVERT                                         0808
*       GENERATE;                                          /*@Z427VLS*/
          MVC    SENSEA1(8),TEMPSAVE
          MVC    SENSEA2(8),TEMPSAVE+8
          MVC    SENSEA3(8),TEMPSAVE+16
          MVC    SENSEA4(8),TEMPSAVE+24
          MVC    SENSEA5(8),TEMPSAVE+32
          MVC    SENSEA6(8),TEMPSAVE+40
          MVC    SENSEA7(8),TEMPSAVE+48
          MVC    SENSEA8(8),TEMPSAVE+56
*       IF OBRSBCNT ^> 24 THEN       /*HAVE WE MESSED UP REST OF LINE*/
         CLC   OBRSBCNT(2,R7),@CH00222                             0810
         BH    @RF00810                                            0810
*         DO;                                              /*@Z427VLS*/
*          IF OBRDEVDC ^= ZERO THEN  /*IF NO DEV DEP INFO DONT MOVE  */
         CLI   OBRDEVDC(R7),0                                      0812
         BE    @RF00812                                            0812
*           DO;                                            /*@Z427VLS*/
*            IF OBRCLASS = '80'X                                  0814
*                    OBRDEV = '0843'X                             0814
*               OBRDEV   = '0842'X                                0814
*               OBRCLASS = '20'X THEN                              0814
         CLI   OBRCLASS(R7),X'80'                                  0814
         BE    @RT00814                                            0814
         CLC   OBRDEV(2,R7),@CB01352                               0814
         BE    @RT00814                                            0814
         CLC   OBRDEV(2,R7),@CB01353                               0814
         BE    @RT00814                                            0814
         CLI   OBRCLASS(R7),X'20'                                  0814
         BNE   @RF00814                                            0814
@RT00814 DS    0H                                                  0815
*                 VOLUME1 = OBRVOL;                        /*@Z427VLS*/
         MVC   VOLUME1(6),OBRVOL(R7)                               0815
*           END;                                           /*@Z427VLS*/
@RF00814 DS    0H                                                  0817
*          IF OBRCLASS = '20'X THEN                                0817
@RF00812 CLI   OBRCLASS(R7),X'20'                                  0817
         BNE   @RF00817                                            0817
*           DO;                                            /*@Z427VLS*/
*           TEMPSAVE = TEMPSAVE && TEMPSAVE;/*CLEAR AREA     @Z427VLS*/
         XC    TEMPSAVE(84),TEMPSAVE                               0819
*           NUMBER = SEVEN;          /*SET UP TO CONVERT 7 BYTES     */
         L     @06,SEVEN                                           0820
         ST    @06,NUMBER                                          0820
*           NEXTBY = ADDR(OBRSEEK)+3;/*ADDRESS OF WHERE TO PUT DATA  */
         LA    @06,OBRSEEK(,R7)                                    0821
         AL    @06,@CF00075                                        0821
         ST    @06,NEXTBY                                          0821
*           ADDNXT = ADDR(TEMPSAVE); /*WHERE IT'S ALL AT     @Z427VLS*/
         LA    @06,TEMPSAVE                                        0822
         ST    @06,ADDNXT                                          0822
*           CALL CONVERT;            /*GO CONVERT THE DATA TO PRINT  */
         BAL   @14,CONVERT                                         0823
*           GENERATE;                                      /*@Z427VLS*/
              MVC    BB1(4),TEMPSAVE
              MVC    CC1(4),TEMPSAVE+4
              MVC    HH1(4),TEMPSAVE+8
              MVC    R111(2),TEMPSAVE+12
*           END;                                           /*@Z427VLS*/
*          END;                                            /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
@EL00011 DS    0H                                                  0827
@EF00011 DS    0H                                                  0827
@ER00011 LM    @14,@12,@SA00011                                    0827
         BR    @14                                                 0827
*DODEVICE: PROC;                                           /*@Z427VLS*/
DODEVICE STM   @14,@12,@SA00012                                    0828
* DEVTYPE1 = UKNO;                  /*IF NO MATCH TELL EVERYONE      */
         MVC   DEVTYPE1(4),UKNO                                    0829
* CALL IFCDEVIC(22,DEVCOMP,DEVTYPE1);                      /*@G51DGGB*/
         L     @15,@CV01334                                        0830
         LA    @01,@AL00830                                        0830
         BALR  @14,@15                                             0830
*END;                                                      /*@Z427VLS*/
@EL00012 DS    0H                                                  0831
@EF00012 DS    0H                                                  0831
@ER00012 LM    @14,@12,@SA00012                                    0831
         BR    @14                                                 0831
*FRAME: PROC;                                              /*@G51DGGB*/
FRAME    STM   @14,@12,@SA00013                                    0832
* DCL FRAMEMCH  CHAR(7) INIT('FRM-MCH');                   /*@G51DGGB*/
* DCL FRAMECCH  CHAR(7) INIT('FRM-CCH');                   /*@G51DGGB*/
* DCL FRMTEMP  CHAR(7) INIT(' ');                          /*@G51DGGB*/
* DCL LAST CHAR(1) BASED(R7+6);                            /*@G51DGGB*/
* CALL TIME;            /*PUT THE TIME IN THE PRINTLINE      @G51DGGB*/
         BAL   @14,TIME                                            0837
* CPU12  = EVLETTER(PTR);                                  /*@G51DGGB*/
         L     @06,PTR                                             0838
         MH    @06,@CH00080                                        0838
         L     @03,EVPTR(,R2)                                      0838
         ALR   @03,@06                                             0838
         MVC   CPU12(1),EVLETTER-6(@03)                            0838
* IF CURRENT = 10 THEN                                             0839
         CLC   CURRENT(4),@CF00032                                 0839
         BNE   @RF00839                                            0839
*  RECTYP1 = FRAMEMCH;                                     /*@G51DGGB*/
         MVC   RECTYP1(7),FRAMEMCH                                 0840
* ELSE                                                             0841
*  RECTYP1 = FRAMECCH;                                     /*@G51DGGB*/
         B     @RC00839                                            0841
@RF00839 MVC   RECTYP1(7),FRAMECCH                                 0841
* NUMBER = THREE ;          /*SET FOR THREE BYTES TO BE CONVERTED*/
@RC00839 MVC   NUMBER(4),@CF00075                                  0842
* ADDNXT = ADDR(FRMTEMP);   /*ADDRESS OF THE TEMPORARY LOCATION  */
         LA    @06,FRMTEMP                                         0843
         ST    @06,ADDNXT                                          0843
* NEXTBY = R7 + 1865;       /*THE INFO IS IN THE LAST LINE OF THE */
         LA    @06,1865                                            0844
         ALR   @06,R7                                              0844
         ST    @06,NEXTBY                                          0844
* CALL CONVERT;             /*CONVERT THEE FRAME INFO TO PRINTABLE*/
         BAL   @14,CONVERT                                         0845
* GEN(MVC CUA12+2(2),FRMTEMP);/*MOVE THE GROUP NUMBER        @G51DGGB*/
         MVC CUA12+2(2),FRMTEMP
* GEN(MVC CUA12+10(2),FRMTEMP+2);/*MOVE THE FRAME NUMBER     @G51DGGB*/
         MVC CUA12+10(2),FRMTEMP+2
* GEN(MVC CUA12+19(2),FRMTEMP+4);/*MOVE THE EC LEVEL INTO THE PRINT L*/
         MVC CUA12+19(2),FRMTEMP+4
* BNDECNUM = 2;                                            /*@G51DGGB*/
         MVC   BNDECNUM(4),@CF00073                                0849
* BINWORD = LAST;                                          /*@G51DGGB*/
         SLR   @06,@06                                             0850
         IC    @06,LAST+6(,R7)                                     0850
         ST    @06,BINWORD                                         0850
* DECADDR= ADDR(SENSEA2);                                  /*@G51DGGB*/
         LA    @06,SENSEA2                                         0851
         ST    @06,DECADDR                                         0851
* CALL CONVBIN;                                            /*@G51DGGB*/
         BAL   @14,CONVBIN                                         0852
* IF (LRTSMS & '80'X) = '00'X THEN                                 0853
         MVC   @TS00001(1),LRTSMS(R7)                              0853
         NI    @TS00001,X'80'                                      0853
         CLI   @TS00001,X'00'                                      0853
         BNE   @RF00853                                            0853
*  GEN(MVI  SENSEA3,X'5C');                                /*@G51DGGB*/
         MVI  SENSEA3,X'5C'
*END;                                                      /*@G51DGGB*/
@EL00013 DS    0H                                                  0855
@EF00013 DS    0H                                                  0855
@ER00013 LM    @14,@12,@SA00013                                    0855
         BR    @14                                                 0855
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL DETERMINE WHICH HEADING TO PRINT      @Z427VLS*/
*HEADING:  PROC;                                           /*@Z427VLS*/
HEADING  STM   @14,@12,@SA00014                                    0856
*  IF MYLINECT > LINECT - TWO THEN   /*IS IT TIME FOR A NEW HEADING  */
         LH    @06,LINECT(,R2)                                     0857
         SL    @06,TWO                                             0857
         CH    @06,MYLINECT                                        0857
         BNL   @RF00857                                            0857
*      DO;                                                 /*@Z427VLS*/
*       MYLINECT = MINUS1;           /*RESET THE COUNT TO -1 @Z427VLS*/
         L     @06,MINUS1                                          0859
         STH   @06,MYLINECT                                        0859
*       SPACING = UPSPACE;           /*UP TO A NEW PAGE      @Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0860
*       CALL PRINTIT;                /*SPACE TO A NEW PAGE   @Z427VLS*/
         BAL   @14,PRINTIT                                         0861
*       SPACING = SINGLE;            /*RETURN TO NORMAL CC CONTROL   */
         MVC   SPACING(1),SINGLE                                   0862
*      END;                                                /*@Z427VLS*/
* IF DEBUG5 = ON                 /*DO THEY WANT HEADING FOR EACH REC */
*   THEN                                                           0864
@RF00857 TM    DEBUG5(R2),B'00000100'                              0864
         BNO   @RF00864                                            0864
*     CALL BUGHEAD;              /*GO DETERMINE THE TYPE OF HEADING  */
         BAL   @14,BUGHEAD                                         0865
*   ELSE                                                           0866
*     CALL TYPEHEAD;             /*GO OUTPUT THE NORMAL HEADING      */
         B     @RC00864                                            0866
@RF00864 BAL   @14,TYPEHEAD                                        0866
* DUPLICAT = LINE04;                 /*THIS PART OF HEADING IS STAND */
@RC00864 MVC   DUPLICAT(33),LINE04                                 0867
* CALL PRINTIT;                  /*PRINT OUT HEADING SELECTED        */
         BAL   @14,PRINTIT                                         0868
*IF DEBUG5 = OFF &            /*PUT DATE AT THE TOP OF THE PAGE */ 0869
*   Y ^= ZERO THEN            /*NOT FIRST TIME THROUGH       @0001VLS*/
         TM    DEBUG5(R2),B'00000100'                              0869
         BNZ   @RF00869                                            0869
         L     @06,Y                                               0869
         LTR   @06,@06                                             0869
         BZ    @RF00869                                            0869
* CALL NEWDATE;               /*PRINT THE DATE OF CURRENT RECORD*/ 0870
         BAL   @14,NEWDATE                                         0870
*END;                                                      /*@Z427VLS*/
@EL00014 DS    0H                                                  0871
@EF00014 DS    0H                                                  0871
@ER00014 LM    @14,@12,@SA00014                                    0871
         BR    @14                                                 0871
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL MCH TYPE HEADERS           @Z427VLS*/
*MCHHEDER:  PROC;                                          /*@Z427VLS*/
MCHHEDER STM   @14,@12,12(@13)                                     0872
*DCL PSWMCH1 CHAR(77) DEFINED(PSWMCH);                     /*@0098VLS*/
*PSWMCH1 = LINE8;                                          /*@0098VLS*/
         MVC   PSWMCH1(77),LINE8                                   0874
*END;                                                      /*@Z427VLS*/
@EL00015 DS    0H                                                  0875
@EF00015 DS    0H                                                  0875
@ER00015 LM    @14,@12,12(@13)                                     0875
         BR    @14                                                 0875
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL CHH TYPE HEADERS           @Z427VLS*/
*CCHHEDER: PROC;                                           /*@Z427VLS*/
CCHHEDER STM   @14,@12,12(@13)                                     0876
*   CCHFINSH = LINE1;             /*SET UP REST OF CCH HEADING       */
         MVC   CCHFINSH(18),LINE1                                  0877
*END;                                                      /*@Z427VLS*/
@EL00016 DS    0H                                                  0878
@EF00016 DS    0H                                                  0878
@ER00016 LM    @14,@12,12(@13)                                     0878
         BR    @14                                                 0878
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL OBR TYPE HEADERS           @Z427VLS*/
*OBRHEDER: PROC;                                           /*@Z427VLS*/
OBRHEDER STM   @14,@12,12(@13)                                     0879
*   OBRFINSH = LINE5;             /*SET UP THE REST OF OBR HEADING   */
         MVC   OBRFINSH(98),LINE5                                  0880
*END;                                                      /*@Z427VLS*/
@EL00017 DS    0H                                                  0881
@EF00017 DS    0H                                                  0881
@ER00017 LM    @14,@12,12(@13)                                     0881
         BR    @14                                                 0881
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL SFT TYPE HEADERS           @Z427VLS*/
*SFTHEDER: PROC;                                           /*@Z427VLS*/
SFTHEDER STM   @14,@12,12(@13)                                     0882
* SFTFINSH = LINE66;                                       /*@0098VLS*/
         MVC   SFTFINSH(78),LINE66                                 0883
*END;                                                      /*@Z427VLS*/
@EL00018 DS    0H                                                  0884
@EF00018 DS    0H                                                  0884
@ER00018 LM    @14,@12,12(@13)                                     0884
         BR    @14                                                 0884
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL IPL TYPE HEADERS           @Z427VLS*/
*IPLHEDER: PROC;                                           /*@Z427VLS*/
IPLHEDER STM   @14,@12,12(@13)                                     0885
*   IPLFINSH = LINE7;             /*SET UP THE REST OF IPL HEADING   */
         MVC   IPLFINSH(17),LINE7                                  0886
*END;                                                      /*@Z427VLS*/
@EL00019 DS    0H                                                  0887
@EF00019 DS    0H                                                  0887
@ER00019 LM    @14,@12,12(@13)                                     0887
         BR    @14                                                 0887
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL DDR TYPE HEADERS           @Z427VLS*/
*DDRHEDER: PROC;                                           /*@Z427VLS*/
DDRHEDER STM   @14,@12,@SA00020                                    0888
*   GEN(MVC  CUA12(104),LINE3);   /*SET UP THE REST OF IPL HEADING   */
         MVC  CUA12(104),LINE3
*END;                                                      /*@Z427VLS*/
@EL00020 DS    0H                                                  0890
@EF00020 DS    0H                                                  0890
@ER00020 LM    @14,@12,@SA00020                                    0890
         BR    @14                                                 0890
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL MIH TYPE HEADERS           @Z427VLS*/
*MIHHEDER: PROC;                                           /*@Z427VLS*/
MIHHEDER STM   @14,@12,@SA00021                                    0891
*   GEN(MVC  CUA12(104),LINE3);   /*SET UP THE REST OF DDR HEADING   */
         MVC  CUA12(104),LINE3
*END;                                                      /*@Z427VLS*/
@EL00021 DS    0H                                                  0893
@EF00021 DS    0H                                                  0893
@ER00021 LM    @14,@12,@SA00021                                    0893
         BR    @14                                                 0893
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL EOD TYPE HEADERS           @Z427VLS*/
*EODHEDER: PROC;                                           /*@Z427VLS*/
EODHEDER STM   @14,@12,12(@13)                                     0894
*    /*NOTHING IS REQUIRED AT THIS TIME                      @Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00022 DS    0H                                                  0895
@EF00022 DS    0H                                                  0895
@ER00022 LM    @14,@12,12(@13)                                     0895
         BR    @14                                                 0895
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL MDR TYPE HEADERS           @Z427VLS*/
*MDRHEDER: PROC;                                           /*@Z427VLS*/
MDRHEDER STM   @14,@12,12(@13)                                     0896
*   NEWMDR   = LINE3;        /*SAME AS DDR TYPE RECORD       @Z427VLS*/
         MVC   NEWMDR(104),LINE3                                   0897
*END;                                                      /*@Z427VLS*/
@EL00023 DS    0H                                                  0898
@EF00023 DS    0H                                                  0898
@ER00023 LM    @14,@12,12(@13)                                     0898
         BR    @14                                                 0898
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL MDR & OBR TYPE HEADERS     @Z427VLS*/
*MDROBRHD: PROC;                                           /*@Z427VLS*/
MDROBRHD STM   @14,@12,@SA00024                                    0899
*   LINE44 = LINE4;                                        /*@Z427VLS*/
         MVC   LINE44(82),LINE4                                    0900
*   CALL PRINTIT;            /*THIS ONE HAS AN EXTRA LINE    @Z427VLS*/
         BAL   @14,PRINTIT                                         0901
*   MDROBRLN = MDRLINE;      /*SET UP THE SECOND LINE OF OUTPUT      */
         MVC   MDROBRLN(35),MDRLINE                                0902
*END;                                                      /*@Z427VLS*/
@EL00024 DS    0H                                                  0903
@EF00024 DS    0H                                                  0903
@ER00024 LM    @14,@12,@SA00024                                    0903
         BR    @14                                                 0903
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL STANDARD HEADERS           @Z427VLS*/
*COMMONHD: PROC;                                           /*@Z427VLS*/
COMMONHD STM   @14,@12,@SA00025                                    0904
*   LINE0006 = LINE6;        /*SET UP THE FIRST OF COMMON HEADER     */
         MVC   LINE0006(78),LINE6                                  0905
*   CALL PRINTIT;            /*GO PRINT THE LINE             @Z427VLS*/
         BAL   @14,PRINTIT                                         0906
*   OBRFINSH = LINE5;        /*SET UP THE SECOND LINE        @Z427VLS*/
         MVC   OBRFINSH(98),LINE5                                  0907
*END;                                                      /*@Z427VLS*/
@EL00025 DS    0H                                                  0908
@EF00025 DS    0H                                                  0908
@ER00025 LM    @14,@12,@SA00025                                    0908
         BR    @14                                                 0908
* /***************************************************************/
* /*    THIS PROC WILL OUTPUT THE FRAME HEADER               @G51DGGB*/
*FRMHEDER: PROC;                                           /*@G51DGGB*/
FRMHEDER STM   @14,@12,12(@13)                                     0909
*DCL LINEFRAM CHAR(43)                                             0910
* INIT('GROUP   FRAME   EC LEVEL    SEQ #  LASTFLAG');     /*@G51DGGB*/
*DCL LINEFRM1 CHAR(43) DEFINED(CUA12);                     /*@G51DGGB*/
* LINEFRM1 = LINEFRAM;      /*MOVE THE FRAME HEADER IN TO THE LINE*/
         MVC   LINEFRM1(43),LINEFRAM                               0912
*END;                                                      /*@G51DGGB*/
@EL00026 DS    0H                                                  0913
@EF00026 DS    0H                                                  0913
@ER00026 LM    @14,@12,12(@13)                                     0913
         BR    @14                                                 0913
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL DETERMINE WHICH TYPE HEADING TO PRINT @Z427VLS*/
* /*                                                         @Z427VLS*/
*BUGHEAD: PROC;                                            /*@Z427VLS*/
BUGHEAD  STM   @14,@12,@SA00027                                    0914
*  R8 = CURRENT;                       /*PICK UP THE RECORD TYPE     */
         L     R8,CURRENT                                          0915
*  IF R8 = ONE                         /*IS IT A MCH RECORD  @Z427VLS*/
*    THEN                                                          0916
         C     R8,ONE                                              0916
         BNE   @RF00916                                            0916
*      CALL MCHHEDER;                  /*GO SET UP MCH HEADER        */
         BAL   @14,MCHHEDER                                        0917
*    ELSE                                                          0918
*     IF R8 = TWO                      /*IS IT A CCH TYPE RECORD     */
*      THEN                                                        0918
         B     @RC00916                                            0918
@RF00916 C     R8,TWO                                              0918
         BNE   @RF00918                                            0918
*       CALL CCHHEDER;                 /*GO SET UP CCH HEADER        */
         BAL   @14,CCHHEDER                                        0919
*      ELSE                                                        0920
*       IF R8 = THREE                  /*IS IT MCH TYPE RECORD       */
*        THEN                                                      0920
         B     @RC00918                                            0920
@RF00918 C     R8,@CF00075                                         0920
         BNE   @RF00920                                            0920
*         CALL OBRHEDER;               /*GO FORMATE THE OBR HEADER   */
         BAL   @14,OBRHEDER                                        0921
*        ELSE                                                      0922
*         IF R8 = FOUR                 /*IS IT A SOFTWARE RECORD     */
*          THEN                                                    0922
         B     @RC00920                                            0922
@RF00920 C     R8,@CF00063                                         0922
         BNE   @RF00922                                            0922
*           CALL SFTHEDER;             /*FORMATE THE SOFTWARE HEADER */
         BAL   @14,SFTHEDER                                        0923
*          ELSE                                                    0924
*           IF R8 = FIVE               /*IS THE RECORD AN IPL TYPE   */
*            THEN                                                  0924
         B     @RC00922                                            0924
@RF00922 C     R8,FIVE                                             0924
         BNE   @RF00924                                            0924
*             CALL IPLHEDER;           /*FORMATE IPL HEADER  @Z427VLS*/
         BAL   @14,IPLHEDER                                        0925
*            ELSE                                                  0926
*             IF R8 = SIX              /*IS THE RECORD AN DDR RECORD */
*              THEN                                                0926
         B     @RC00924                                            0926
@RF00924 C     R8,SIX                                              0926
         BNE   @RF00926                                            0926
*               CALL DDRHEDER;         /*FORMAT HEADER FOR DDR RECORD*/
         BAL   @14,DDRHEDER                                        0927
*              ELSE                                                0928
*               IF R8 = SEVEN          /*IS THE RECORD AN MIH RECORD */
*                THEN                                              0928
         B     @RC00926                                            0928
@RF00926 C     R8,SEVEN                                            0928
         BNE   @RF00928                                            0928
*                 CALL MIHHEDER;       /*FORMAT TH HEADER FOR MIH REC*/
         BAL   @14,MIHHEDER                                        0929
*                ELSE                                              0930
*                 IF R8 = EIGHT        /*IS THE RECORD AN EOD RECORD */
*                  THEN                                            0930
         B     @RC00928                                            0930
@RF00928 C     R8,@CF00065                                         0930
         BNE   @RF00930                                            0930
*                   CALL EODHEDER;     /*FORMAT FOR EOD RRECORD      */
         BAL   @14,EODHEDER                                        0931
*                  ELSE                                            0932
*                   IF R8 = NINE       /*IS RECORD AN MDR TYPE       */
*                    THEN                                          0932
         B     @RC00930                                            0932
@RF00930 C     R8,@CF00085                                         0932
         BNE   @RF00932                                            0932
*                     CALL MDRHEDER;   /*FORMAT FOR AN MDR TYPE      */
         BAL   @14,MDRHEDER                                        0933
*                     ELSE                                         0934
*                      IF R8 = TEN  /*REC IS A MCF TYPE RECORD*/  0934
*                         R8 = 11     THEN/*IS A CCF TYPE OF RECORD*/
         B     @RC00932                                            0934
@RF00932 C     R8,TEN                                              0934
         BE    @RT00934                                            0934
         C     R8,@CF00033                                         0934
         BNE   @RF00934                                            0934
@RT00934 DS    0H                                                  0935
*                          CALL FRMHEDER; /*PRINT THE FRAME HEADER*/
         BAL   @14,FRMHEDER                                        0935
*                    ELSE                                          0936
*                     CALL COMMONHD;   /*SHOULD NOT OCCUR BUT JUST IN*/
         B     @RC00934                                            0936
@RF00934 BAL   @14,COMMONHD                                        0936
*END;                                                      /*@Z427VLS*/
@EL00027 DS    0H                                                  0937
@EF00027 DS    0H                                                  0937
@ER00027 LM    @14,@12,@SA00027                                    0937
         BR    @14                                                 0937
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL DETERMINE THE HEADING TO USE IN NORMAL OPERATI*/
*TYPEHEAD: PROC;                                           /*@Z427VLS*/
TYPEHEAD STM   @14,@12,@SA00028                                    0938
*  RTYP =(RECTYPE & 'FF80'X);                              /*@G51DGGB*/
         L     @06,@CF00089                                        0939
         LH    @03,RECTYPE(,R2)                                    0939
         N     @03,@CF01464                                        0939
         NR    @06,@03                                             0939
         ST    @06,RTYP                                            0939
*  IF RTYP = '8000'X                   /*IS IT AN MDR TYPE   @Z427VLS*/
*   THEN                                                           0940
         C     @06,@CF00193                                        0940
         BNE   @RF00940                                            0940
*    CALL MCHHEDER;                    /*FORMAT FOR AN MCH RECORD    */
         BAL   @14,MCHHEDER                                        0941
*   ELSE                                                           0942
*    IF RTYP = '4000'X                 /*IS THE RECORD AN CCH TYPE   */
*     THEN                                                         0942
         B     @RC00940                                            0942
@RF00940 CLC   RTYP(4),@CF01435                                    0942
         BNE   @RF00942                                            0942
*      CALL CCHHEDER;                  /*FORMAT HEADER FOR AN CCH    */
         BAL   @14,CCHHEDER                                        0943
*     ELSE                                                         0944
*      IF RTYP = '2000'X               /*IS THE RECORD TYPE AN OBR   */
*       THEN                                                       0944
         B     @RC00942                                            0944
@RF00942 CLC   RTYP(4),@CF01436                                    0944
         BNE   @RF00944                                            0944
*        CALL OBRHEDER;                /*FORMAT FOR AN OBR RECORD    */
         BAL   @14,OBRHEDER                                        0945
*       ELSE                                                       0946
*        IF RTYP = '1000'X                                         0946
*         THEN                                                     0946
         B     @RC00944                                            0946
@RF00944 CLC   RTYP(4),@CF01437                                    0946
         BNE   @RF00946                                            0946
*          CALL SFTHEDER;              /*FORMAT FOR SFT TYPE @Z427VLS*/
         BAL   @14,SFTHEDER                                        0947
*         ELSE                                                     0948
*          IF RTYP = '0800'X                                       0948
*           THEN                                                   0948
         B     @RC00946                                            0948
@RF00946 CLC   RTYP(4),@CF01438                                    0948
         BNE   @RF00948                                            0948
*            CALL IPLHEDER;            /*FORMAT FOR IPL RECORD       */
         BAL   @14,IPLHEDER                                        0949
*           ELSE                                                   0950
*            IF RTYP = '0400'X         /*IS THE RECORD SELECTION DDR */
*             THEN                                                 0950
         B     @RC00948                                            0950
@RF00948 CLC   RTYP(4),@CF01439                                    0950
         BNE   @RF00950                                            0950
*              CALL DDRHEDER;          /*FORMAT FOR AN DDR TYPE      */
         BAL   @14,DDRHEDER                                        0951
*             ELSE                                                 0952
*              IF RTYP = '0200'X       /*IS THE RECORD SELECTION MIH */
*               THEN                                               0952
         B     @RC00950                                            0952
@RF00950 CLC   RTYP(4),@CF01440                                    0952
         BNE   @RF00952                                            0952
*                CALL MIHHEDER;        /*FORMAT FOR AN MIH TYPE      */
         BAL   @14,MIHHEDER                                        0953
*               ELSE                                               0954
*                IF RTYP = '0100'X     /*IS THE RECORD SELECTION EOD */
*                 THEN                                             0954
         B     @RC00952                                            0954
@RF00952 CLC   RTYP(4),@CF00100                                    0954
         BNE   @RF00954                                            0954
*                  CALL EODHEDER;      /*FORMAT FOR AN EOD TYPE      */
         BAL   @14,EODHEDER                                        0955
*                 ELSE                                             0956
*                  IF RTYP = '0080'X                               0956
*                   THEN                                           0956
         B     @RC00954                                            0956
@RF00954 CLC   RTYP(4),@CF01441                                    0956
         BNE   @RF00956                                            0956
*                    CALL MDRHEDER;    /*FORMAT FOR AN MDR TYPE      */
         BAL   @14,MDRHEDER                                        0957
*                   ELSE                                           0958
*                    IF RTYP = '2080'X                             0958
*                     THEN                                         0958
         B     @RC00956                                            0958
@RF00956 CLC   RTYP(4),@CF01442                                    0958
         BNE   @RF00958                                            0958
*                      CALL MDROBRHD;  /*FORMAT FOR COMB MDR-OBR TYPE*/
         BAL   @14,MDROBRHD                                        0959
*                     ELSE                                         0960
*                      IF DEBUG47 = ON                            0960
*                         DEBUG46 = ON THEN                        0960
         B     @RC00958                                            0960
@RF00958 TM    DEBUG47(R2),B'00000011'                             0960
         BZ    @RF00960                                            0960
*                          CALL FRMHEDER;                  /*@G51DGGB*/
         BAL   @14,FRMHEDER                                        0961
*                     ELSE                                         0962
*                      CALL COMMONHD;  /*JUST COMMON OLD HEADING     */
         B     @RC00960                                            0962
@RF00960 BAL   @14,COMMONHD                                        0962
*END;                                                      /*@Z427VLS*/
*                                                                  0963
@EL00028 DS    0H                                                  0963
@EF00028 DS    0H                                                  0963
@ER00028 LM    @14,@12,@SA00028                                    0963
         BR    @14                                                 0963
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*    THIS PROC WILL DEVELOPE THE TABLE OF CPU SERIAL AND MODEL     */
*/*    NUMBERS AND PRINT IT. THIS WILL BE THE LAST THING PRINTED     */
*/*                                                          @Z427VLS*/
*CPUINFO: PROC;                                            /*@Z427VLS*/
CPUINFO  STM   @14,@12,@SA00029                                    0964
*  SPACING = DOUBLE ;                                      /*@Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0965
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0966
*  CPULINE1 = CPULINE;           /*SET UP THE HEADING FOR CPU SERIAL */
         MVC   CPULINE1(24),CPULINE                                0967
*  CALL PRINTIT;                 /*GO AND PRINT IT           @Z427VLS*/
         BAL   @14,PRINTIT                                         0968
*  SPACING = SINGLE;                                       /*@Z427VLS*/
         MVC   SPACING(1),SINGLE                                   0969
*  DO I = 1 BY 1 TO EVNUM;    /*SET UP TO PROCESS ALL CPUS   @Z427VLS*/
         LA    @06,1                                               0970
         ST    @06,I                                               0970
         B     @DE00970                                            0970
@DL00970 DS    0H                                                  0971
*   CPUTYPE = EVLETTER(I);       /*SET IN ACTUAL LETTER      @Z427VLS*/
         MH    @06,@CH00080                                        0971
         L     @03,EVPTR(,R2)                                      0971
         ST    @06,@TF00001                                        0971
         ALR   @06,@03                                             0971
         MVC   CPUTYPE(1),EVLETTER-6(@06)                          0971
*   NUMBER= TWO;                 /*SET FOR TWO BYTES         @Z427VLS*/
         L     @06,TWO                                             0972
         ST    @06,NUMBER                                          0972
*   ADDNXT = ADDR(CPUMODEL);     /*WHERE THE INFO IS TO BE PLACED    */
         LA    @06,CPUMODEL                                        0973
         ST    @06,ADDNXT                                          0973
*   NEXTBY = ADDR(EVMODEL(I));   /*ADDRESS WHERE THE DATA IS @Z427VLS*/
         L     @06,@TF00001                                        0974
         LA    @06,EVMODEL-6(@06,@03)                              0974
         ST    @06,NEXTBY                                          0974
*   CALL CONVERT;                /*GO AND CONVERT THE DATA   @Z427VLS*/
         BAL   @14,CONVERT                                         0975
*   ADDNXT = ADDR(CPUSERAL);     /*WHERE TO PUT THE SERIAL DATA      */
         LA    @06,CPUSERAL                                        0976
         ST    @06,ADDNXT                                          0976
*   NEXTBY = ADDR(EVSERIAL(I));  /*WHERE THE SERIAL INFO IS KEPT     */
         L     @06,I                                               0977
         MH    @06,@CH00080                                        0977
         L     @03,EVPTR(,R2)                                      0977
         LA    @06,EVSERIAL-6(@06,@03)                             0977
         ST    @06,NEXTBY                                          0977
*   NUMBER = THREE;              /*SET UP FOR THREE IN SIX OUT       */
         MVC   NUMBER(4),@CF00075                                  0978
*   CALL CONVERT ;               /*GO CONVERT THE SERIAL TO PRINTABLE*/
         BAL   @14,CONVERT                                         0979
*   PRTLINE1 = CPUDATA;          /*MOVE CPU DATA TO THE PRINT LINE   */
         MVI   PRTLINE1+22,C' '                                    0980
         MVC   PRTLINE1+23(79),PRTLINE1+22                         0980
         MVC   PRTLINE1(22),CPUDATA                                0980
*   CALL PRINTIT;                /*GO PRINT WHAT WE FOUND    @Z427VLS*/
         BAL   @14,PRINTIT                                         0981
*  END;                                                    /*@Z427VLS*/
         LA    @06,1                                               0982
         AL    @06,I                                               0982
         ST    @06,I                                               0982
@DE00970 L     @03,EVPTR(,R2)                                      0982
         CH    @06,EVNUM(,@03)                                     0982
         BNH   @DL00970                                            0982
*  SPACING = SINGLE;             /*RESTORE SPACING CONTROL TO 1      */
         MVC   SPACING(1),SINGLE                                   0983
* END;                                                     /*@Z427VLS*/
@EL00029 DS    0H                                                  0984
@EF00029 DS    0H                                                  0984
@ER00029 LM    @14,@12,@SA00029                                    0984
         BR    @14                                                 0984
*/********************************************************************/
*/*       THIS PROC WILL DETERMINE THE INDEX FOR ALL FOLLOWING WORK  */
*/*       IT IS BASED ON MATCHING THE SERIAL AND CPU WITH EV TABLE   */
* CPULETER: PROC;                                          /*@Z427VLS*/
CPULETER STM   @14,@12,12(@13)                                     0985
*   SWITCH3 = OFF;               /*TURN THE SWITCH OFF PRIOR TO START*/
         NI    SWITCH3,B'11011111'                                 0986
*   PTR = ZERO;                  /*START AT ZERO             @Z427VLS*/
         SLR   @06,@06                                             0987
         ST    @06,PTR                                             0987
*   DO S = 1 BY 1 TO 16 WHILE(SWITCH3 = OFF);          /*    @ZA19014*/
         LA    @06,1                                               0988
         ST    @06,S                                               0988
@DL00988 TM    SWITCH3,B'00100000'                                 0988
         BNZ   @DC00988                                            0988
*     IF EVSERIAL(S) = LRTCPUS   /*DO THE SERIALS MATCH      @Z427VLS*/
*        &  EVMODEL(S) = LRTMODEL/*AND THE MODEL # MATCHES   @Z427VLS*/
*          THEN                                                    0989
         LR    @03,@06                                             0989
         MH    @03,@CH00080                                        0989
         L     @15,EVPTR(,R2)                                      0989
         ST    @03,@TF00001                                        0989
         ALR   @03,@15                                             0989
         CLC   EVSERIAL-6(3,@03),LRTCPUS(R7)                       0989
         BNE   @RF00989                                            0989
         AL    @15,@TF00001                                        0989
         CLC   EVMODEL-6(2,@15),LRTMODEL(R7)                       0989
         BNE   @RF00989                                            0989
*           DO;                                            /*@Z427VLS*/
*            PTR = S;            /*SET THE INDEX FOR FOLLOWING PROCS */
         ST    @06,PTR                                             0991
*            SWITCH3 = ON;       /* SET TO EXIT THE LOOP     @Z427VLS*/
         OI    SWITCH3,B'00100000'                                 0992
*           END;                                           /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
@RF00989 LA    @06,1                                               0994
         AL    @06,S                                               0994
         ST    @06,S                                               0994
         C     @06,@CF00088                                        0994
         BNH   @DL00988                                            0994
@DC00988 DS    0H                                                  0995
*                                /*FILT4 DROPS THE BALL BUT JUST IN -*/
* END;                                                     /*@Z427VLS*/
@EL00030 DS    0H                                                  0995
@EF00030 DS    0H                                                  0995
@ER00030 LM    @14,@12,12(@13)                                     0995
         BR    @14                                                 0995
@PB00030 DS    0H                                                  0996
*/********************************************************************/
*/********************************************************************/
*/*******************PRIME LOOP***************************************/
*/*                                                          @Z427VLS*/
* IF DEBUG4 = ON THEN           /*PRINT NAME AND COMPILE DATE        */
         TM    DEBUG4(R2),B'00001000'                              0996
         BNO   @RF00996                                            0996
* DO;                                                      /*@Z427VLS*/
*  R9 = R10 -27;                                           /*@Z427VLS*/
         LR    R9,R10                                              0998
         SL    R9,@CF01451                                         0998
*  GEN(MVC  TIME1(16),0(R9));    /*MOVE IN NAME & COMPILE DATE      */
         MVC  TIME1(16),0(R9)
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         1000
* END;                                                     /*@Z427VLS*/
* DDNAME = '0';                 /*DIRECT BACK TO NORMAL DD SET      */
@RF00996 MVI   DDNAME,C'0'                                         1002
* IF DEBUG6 ^= ON & DEBUG24 ^= ON THEN                             1003
         TM    DEBUG6(R2),B'00000010'                              1003
         BO    @RF01003                                            1003
         TM    DEBUG24(R2),B'10000000'                             1003
         BO    @RF01003                                            1003
* DO;                                                      /*@Z427VLS*/
*IF DEBUG47 ^= ON THEN                                             1005
         TM    DEBUG47(R2),B'00000001'                             1005
         BO    @RF01005                                            1005
* CALL TEMPLATE;                /*GO PRINT OUT THE TEMPLATE  @Z427VLS*/
         BAL   @14,TEMPLATE                                        1006
* CALL MAINHEAD;                /*GO PRINT MAIN HEADING      @Z427VLS*/
@RF01005 BAL   @14,MAINHEAD                                        1007
* IF DEBUG5 ^= ON THEN                                             1008
         TM    DEBUG5(R2),B'00000100'                              1008
         BO    @RF01008                                            1008
*  CALL HEADING;                                           /*@Z427VLS*/
         BAL   @14,HEADING                                         1009
* END;                                                     /*@Z427VLS*/
@RF01008 DS    0H                                                  1011
* DO Y = 1 BY 1 TO SORTNUM;     /*SET UP INDEX TO PROCESS ALL ITEMS  */
@RF01003 LA    @06,1                                               1011
         ST    @06,Y                                               1011
         B     @DE01011                                            1011
@DL01011 DS    0H                                                  1012
*  RECCCHHR = SORTCCHR(Y);      /*SET UP FOR THE DIRECT READ @Z427VLS*/
         MH    @06,@CH00032                                        1012
         L     @03,SORTADR(,R2)                                    1012
         ALR   @03,@06                                             1012
         AL    @03,@CF01467                                        1012
         MVC   RECCCHHR(5,R2),SORTCCHR-5(@03)                      1012
*  CALL IOHND(READIRCT);                                   /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    1013
         LA    @01,@AL01013                                        1013
         BALR  @14,@15                                             1013
*  IF R15 = ZERO THEN           /*DON'T PROCESS IF READ ERROR        */
         LTR   R15,R15                                             1014
         BNZ   @RF01014                                            1014
*   DO;                                                    /*@Z427VLS*/
*    R8 = LRTKEY1;              /*PICK UP THE RECORD TYPE    @Z427VLS*/
         SLR   R8,R8                                               1016
         IC    R8,LRTKEY1(,R7)                                     1016
*    SRL (R8,FOUR);             /*DROP THE UNWANTED BITS FROM THE TYP*/
         SRL   R8,4                                                1017
*    CURRENT = R8;              /*SAVE FOR AN INDEX VALUE    @Z427VLS*/
         ST    R8,CURRENT                                          1018
*  IF(DEBUG5 = ON              /*PRINT HEADING FOR EACH RECORD      */
*  MYLINECT > LINECT) &         /*CHECK IF NEW PAGE IS REQUIRED*/  1019
*     DEBUG24 ^= ON                                                1019
*     THEN                                                         1019
         TM    DEBUG5(R2),B'00000100'                              1019
         BO    @GL00023                                            1019
         LH    @06,MYLINECT                                        1019
         CH    @06,LINECT(,R2)                                     1019
         BNH   @RF01019                                            1019
@GL00023 TM    DEBUG24(R2),B'10000000'                             1019
         BO    @RF01019                                            1019
*       CALL HEADING;           /*GO PRINT THE HEADING       @Z427VLS*/
         BAL   @14,HEADING                                         1020
*  CALL CPULETER;                                          /*@Z427VLS*/
@RF01019 BAL   @14,CPULETER                                        1021
*  IF LASTDATE ^= LRTDATE & DEBUG6 = OFF                           1022
*     THEN                                                         1022
         CLC   LASTDATE(4),LRTDATE(R7)                             1022
         BE    @RF01022                                            1022
         TM    DEBUG6(R2),B'00000010'                              1022
         BNZ   @RF01022                                            1022
*       CALL NEWDATE;           /*GO PRINT THE NEW DATE      @Z427VLS*/
         BAL   @14,NEWDATE                                         1023
*  IF PTR ^= ZERO THEN          /*DON'T LET A ZERO INDEX SLIP BY     */
@RF01022 L     @06,PTR                                             1024
         LTR   @06,@06                                             1024
         BZ    @RF01024                                            1024
*   DO;                                                    /*@Z427VLS*/
*    CALL MOVEDATA;             /*MOVE THE DATA INTO THE PRINT LINE  */
         BAL   @14,MOVEDATA                                        1026
*    IF DEBUG6 = OFF & DEBUG24 = OFF THEN  /* IF TRUE DON'T PRINT    */
         TM    DEBUG6(R2),B'00000010'                              1027
         BNZ   @RF01027                                            1027
         TM    DEBUG24(R2),B'10000000'                             1027
         BNZ   @RF01027                                            1027
*      CALL PRINTIT;            /*GO PRINT OUT THE DATA LINE @Z427VLS*/
         BAL   @14,PRINTIT                                         1028
*   END;                                                   /*@Z427VLS*/
* END;                                                     /*@Z427VLS*/
* ELSE                                                             1031
*  BADRECRD = BADRECRD + ONE;   /*ADD 1 TO NUMBER OF READ FAILURES   */
         B     @RC01014                                            1031
@RF01014 L     @06,BADRECRD                                        1031
         AL    @06,ONE                                             1031
         ST    @06,BADRECRD                                        1031
* IF DEBUG17 = ON &R15 = ZERO THEN/*   WANTS A HEX DUMP OF EACH REC. */
@RC01014 TM    DEBUG17(R2),B'01000000'                             1032
         BNO   @RF01032                                            1032
         SLR   @14,@14                                             1032
         CR    R15,@14                                             1032
         BNE   @RF01032                                            1032
*  DO;                                                     /*@Z427VLS*/
*   MYLINECT = ZERO;            /*DON'T LET UP SPACE GET IN ACTION   */
         STH   @14,MYLINECT                                        1034
*   NUMBER = 66;                                           /*@Z427VLS*/
         LA    @06,66                                              1035
         ST    @06,NUMBER                                          1035
*   ADDNXT = ADDR(TIME1);                                  /*@Z427VLS*/
         LA    @03,TIME1                                           1036
         ST    @03,ADDNXT                                          1036
*   NEXTBY = R7;                                           /*@Z427VLS*/
         ST    R7,NEXTBY                                           1037
*   DO T = 66 BY 66 TO RECLNGTH;                           /*@Z427VLS*/
         ST    @06,T                                               1038
         B     @DE01038                                            1038
@DL01038 DS    0H                                                  1039
*    CALL CONVERT;                                         /*@Z427VLS*/
         BAL   @14,CONVERT                                         1039
*    NEXTBY = NEXTBY + 66;                                 /*@Z427VLS*/
         LA    @06,66                                              1040
         AL    @06,NEXTBY                                          1040
         ST    @06,NEXTBY                                          1040
*    CALL PRINTIT;                                         /*@Z427VLS*/
         BAL   @14,PRINTIT                                         1041
*   END;                                                   /*@Z427VLS*/
         LA    @06,66                                              1042
         AL    @06,T                                               1042
         ST    @06,T                                               1042
@DE01038 CH    @06,RECLNGTH(,R2)                                   1042
         BNH   @DL01038                                            1042
*   NUMBER = RECLNGTH - (T-66);                            /*@Z427VLS*/
         L     @06,T                                               1043
         SL    @06,@CF01453                                        1043
         LCR   @06,@06                                             1043
         AH    @06,RECLNGTH(,R2)                                   1043
         ST    @06,NUMBER                                          1043
*   IF NUMBER > ZERO THEN                                          1044
         LTR   @06,@06                                             1044
         BNP   @RF01044                                            1044
*    DO;                                                   /*@Z427VLS*/
*     CALL CONVERT;                                        /*@Z427VLS*/
         BAL   @14,CONVERT                                         1046
*     CALL PRINTIT;                                        /*@Z427VLS*/
         BAL   @14,PRINTIT                                         1047
*    END;                                                  /*@Z427VLS*/
*   CALL PRINTIT;               /*BLANK LINE TO MAKE MORE READABLE   */
@RF01044 BAL   @14,PRINTIT                                         1049
*  END;                                                    /*@Z427VLS*/
* END;                                                     /*@Z427VLS*/
@RF01032 LA    @06,1                                               1051
         AL    @06,Y                                               1051
         ST    @06,Y                                               1051
@DE01011 C     @06,SORTNUM(,R2)                                    1051
         BNH   @DL01011                                            1051
*IF DEBUG47 ^= ON THEN                                             1052
         TM    DEBUG47(R2),B'00000001'                             1052
         BO    @RF01052                                            1052
* CALL PRTTOTAL;         /*GO  PRINT THE SUMMRY TABLE        @G51DGGB*/
         BAL   @14,PRTTOTAL                                        1053
*CALL CPUINFO;                  /*GO PRINT THE CUP SERIAL LETTER TAB */
@RF01052 BAL   @14,CPUINFO                                         1054
* IF BADRECRD ^= ZERO THEN                                         1055
         L     @06,BADRECRD                                        1055
         LTR   @06,@06                                             1055
         BZ    @RF01055                                            1055
*  DO;                                                     /*@Z427VLS*/
*   CALL IFCMSG(63,ADDR(BADREC));                          /*@Z427VLS*/
         LA    @06,BADREC                                          1057
         ST    @06,@AFTEMPS                                        1057
         L     @15,ADIFCMSG(,R2)                                   1057
         LA    @01,@AL01057                                        1057
         BALR  @14,@15                                             1057
*   BINWORD = BADRECRD;         /*SET UP THE BINARY COUNT TO CONVERT */
         L     @06,BADRECRD                                        1058
         ST    @06,BINWORD                                         1058
*   DECADDR = ADDR(NUMFAIL);    /*SET UP ADDRESS OF WHERE TO PUT IT  */
         LA    @06,NUMFAIL                                         1059
         ST    @06,DECADDR                                         1059
*   BNDECNUM = SIX;             /*NUMBER OF CHARS TO PRINT   @Z427VLS*/
         L     @06,SIX                                             1060
         ST    @06,BNDECNUM                                        1060
*   CALL CONVBIN;               /*GO CONVERT THE NUMBER TO PRINTABLE */
         BAL   @14,CONVBIN                                         1061
*   CALL PRINTIT;               /*PRINT THE BAD RECORD COUNT MESSAGE */
         BAL   @14,PRINTIT                                         1062
*  END;                                                    /*@Z427VLS*/
* IF DEBUG12 = ON THEN          /*USER WANTS TO ABEND        @Z427VLS*/
@RF01055 TM    DEBUG12(R2),B'00001000'                             1064
         BNO   @RF01064                                            1064
* GEN(ABEND 444,DUMP);                                     /*@Z427VLS*/
         ABEND 444,DUMP
*/********************************************************************/
*/********************************************************************/
*RETURN;                                                   /*@Z427VLS*/
@EL00001 L     @13,4(,@13)                                         1066
@EF00001 DS    0H                                                  1066
@ER00001 L     @14,12(,@13)                                        1066
         LM    @00,@12,20(@13)                                     1066
         BR    @14                                                 1066
*END;                                                      /*@Z427VLS*/
         B     @EL00001                                            1067
@DATA    DS    0H
@CH00222 DC    H'24'
         DS    0F
@AL00402 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00416 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00427 DC    A(@CF00073+2)           LIST WITH   1 ARGUMENT(S)
@AL00762 DC    A(@CF01292)             LIST WITH   3 ARGUMENT(S)
@AL01013 DC    A(@CF00080+2)           LIST WITH   1 ARGUMENT(S)
         DC    A(DEVTYPE1)
@AL00830 DC    A(@CF00747)             LIST WITH   3 ARGUMENT(S)
         DC    A(DEVCOMP)
         DC    A(DEVTYPE1)
@AL01057 DC    A(@CF01454)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00008 DS    15F
@SA00003 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00009 DS    15F
@SA00010 DS    15F
@SA00011 DS    15F
@SA00013 DS    15F
@SA00014 DS    15F
@SA00027 DS    15F
@SA00028 DS    15F
@SA00020 DS    15F
@SA00021 DS    15F
@SA00024 DS    15F
@SA00025 DS    15F
@SA00029 DS    15F
@SA00012 DS    0F
         DS    15F
@AL00001 DS    3A
@TF00001 DS    F
@AFTEMPS DS    1F
         DS    0F
@CF00054 DC    F'1'
@CF00073 DC    F'2'
@CH00073 EQU   @CF00073+2
@CF00075 DC    F'3'
@CH00075 EQU   @CF00075+2
@CF00063 DC    F'4'
@CF00078 DC    F'5'
@CF00080 DC    F'6'
@CH00080 EQU   @CF00080+2
@CF00082 DC    F'7'
@CH00082 EQU   @CF00082+2
@CF00065 DC    F'8'
@CF00085 DC    F'9'
@CF00032 DC    F'10'
@CH00032 EQU   @CF00032+2
@CF00033 DC    F'11'
@CF01340 DC    F'14'
@CF00088 DC    F'16'
@CF00747 DC    F'22'
@CH00747 EQU   @CF00747+2
@CF01065 DC    F'26'
@CF01451 DC    F'27'
@CF01292 DC    F'32'
@CF01454 DC    F'63'
@CF01453 DC    F'66'
@CF01467 DC    F'-5'
@CF01464 DC    XL4'0000FFFF'
@CF00089 DC    XL4'FF80'
@CF00100 DC    XL4'0100'
@CF00193 DC    XL4'8000'
@CF01435 DC    XL4'4000'
@CF01436 DC    XL4'2000'
@CF01437 DC    XL4'1000'
@CF01438 DC    XL4'0800'
@CF01439 DC    XL4'0400'
@CF01440 DC    XL4'0200'
@CF01441 DC    XL4'0080'
@CF01442 DC    XL4'2080'
@CV01334 DC    V(IFCDEVIC)
         DS    0D
PTR      DC    F'0'
L8       DC    F'8'
J        DC    F'0'
TOTOFTOT DC    F'0'
BADRECRD DC    F'0'
TEN      DC    F'10'
FIVE     DC    F'5'
ONE      DC    F'1'
TWOEIGHT DC    F'28'
NEXTBY   DC    F'0'
ADDNXT   DC    F'0'
BINWORD  DC    F'0'
NUMBER1  DC    F'1'
BNDECNUM DC    F'0'
DECADDR  DC    F'0'
I        DC    F'0'
NUMBER   DC    F'0'
TWO      DC    F'2'
CURRENT  DC    F'0'
MINUS1   DC    F'-1'
TOTAL    DC    F'0'
X        DC    F'0'
K        DC    F'0'
Z        DC    F'0'
SIX      DC    F'6'
M        DC    F'0'
N        DC    F'0'
L        DC    F'0'
P        DC    F'0'
R        DC    F'0'
S        DC    F'0'
T        DC    F'0'
Y        DC    F'0'
SEVEN    DC    F'7'
RTYP     DC    F'0'
MYLINECT DC    H'1000'
@TS00001 DS    CL2
@CB00193 DC    X'8000'
@CB01306 DC    X'F000'
@CB01308 DC    X'2009'
@CB01309 DC    X'200D'
@CB01352 DC    X'0843'
@CB01353 DC    X'0842'
LINE01   DC    CL23'EVENT HISTORY TEMPLATE '
LINE02   DC    CL20'FOR RECORD TYPES:  '
LINE03   DC    CL12'MCH, MCH-TRM'
LINE04   DC    CL33'   TIME     JOBNAME  RECTYP  CPU '
LINE06   DC    CL21'CCH, CCH-INC, CCH-CRH'
LINE08   DC    CL3'OBR'
LINE10   DC    CL74'OBR-DMT, OBR-EOD, DDR, DDR-OPR, DDR-SYS, MIH MIH-CEC
               , MIH-DE, MDR         '
LINE12   DC    CL16'OBR-PRM, OBR-TMP'
LINE14   DC    CL38'SFT, SFT-ABN, SFT-MCH, SFT-PI, SFT-RST'
LINE16   DC    CL3'IPL'
LINE18   DC    CL3'EOD'
DEVCOMP  DC    CL2'  '
LOSTMSG  DC    CL54'LOST RECORD SUMMARY  TYPE=4F (SHORT SOFT RECORD)   C
                  '
PRTLINE  DC    CL154' '
         ORG   PRTLINE
DDNAME   DC    CL1'1'
SPACING  DC    X'09'
TIME1    DS    CL11
@NM00070 DS    CL1
JOBNAME1 DS    CL8
@NM00071 DS    CL1
RECTYP1  DS    CL7
@NM00072 DS    CL1
CPU11    DS    CL1
CPU12    DS    CL1
@NM00073 DS    CL1
CUA11    DS    CL1
CUA12    DS    CL1
@NM00074 DS    CL2
LETTERV  DS    CL1
@NM00075 DS    CL1
DEVICE1  DS    CL4
@NM00076 DS    CL2
CMD1     DS    CL2
@NM00077 DS    CL1
CSW1     DS    CL4
VLETTER  DS    CL1
@NM00078 DS    CL1
SENSEA1  DS    CL8
@NM00079 DS    CL1
SENSEA2  DS    CL8
@NM00080 DS    CL1
SENSEA3  DS    CL8
@NM00081 DS    CL1
SENSEA4  DS    CL8
@NM00082 DS    CL1
SENSEA5  DS    CL8
@NM00083 DS    CL1
SENSEA6  DS    CL8
@NM00084 DS    CL1
VOLUME1  DS    CL6
         ORG   VOLUME1
SENSEA7  DS    CL1
         ORG   PRTLINE+115
@NM00085 DS    CL1
BB1      DS    CL4
         ORG   BB1
@NM00086 DS    CL2
SENSEA8  DS    CL2
         ORG   PRTLINE+120
@NM00087 DS    CL1
CC1      DS    CL4
@NM00088 DS    CL1
HH1      DS    CL4
         ORG   HH1
@NM00089 DS    CL2
SENSEA9  DS    CL2
         ORG   PRTLINE+130
@NM00090 DS    CL1
R111     DS    CL2
         ORG   PRTLINE+154
UPSPACE  DC    X'89'
SINGLE   DC    X'09'
DOUBLE   DC    X'11'
TRIPLE   DC    X'19'
DDRSPEC  DS    CL12
         ORG   DDRSPEC
@NM00091 DC    CL3'TO '
TOCUA    DC    CL3'   '
@NM00092 DC    CL2'  '
DEVSAVE  DS    CL4
         ORG   DDRSPEC+12
TOO      DC    CL2'TO'
UKNO     DC    CL4'UKNO'
REPORTDY DC    CL12'REPORT DATE '
HEADDATE DS    CL18
         ORG   HEADDATE
@NM00094 DC    CL7'PERIOD '
FROMTO   DC    CL5'FROM '
DATE     DS    CL6
         ORG   DATE
DATEDAY  DC    CL3'   '
@NM00095 DC    CL1' '
DATEYR   DC    CL2'  '
         ORG   HEADDATE+18
TO       DC    CL5'  TO '
NOTAPPLY DC    CL8'  N/A   '
BLANK    DC    CL6'      '
BLANK1   DC    X'000000000000'
KEEPSP   DC    CL1' '
LINE8    DC    CL78'                     PSW-MCH /PROG-EC              C
                                 ERROR-ID '
LINE1    DC    CL18'CUA DEVICE     CSW'
LINE2    DC    CL18'CUA DEVICE CMD CSW'
LINE3    DC    CL104'CUA DEVICE                                        C
                                       VOLUME/TERMINAL NAME        '
LINE5    DC    CL98'CUA DEVICE CMD CSW  SENSE    04  06   08  10   12  C
               14   16  18   20  22   VOLUME B B  C C  H H  R'
LINE66   DC    CL78'          REASON     PSW-MCH /PROG-EC   RCYRYXIT  CC
               OMP/MOD  CSECTID  ERROR-ID '
LINE7    DC    CL17'   SSYS ID REASON'
LINE6    DC    CL78'   SSYS ID  REASON   PSW-MCH /PROG-EC   RCYRYXIT  CC
               OMP/MOD  CSECTID  ERROR-ID'
LINE4    DC    CL87'CUA DEVICE                             BYTES    DATC
               A CK  SEEKS  OVERRUN   VOLUME'
@NM00107 DS    CL182
         ORG   @NM00107
MCH      DC    CL7'MCH    '
MCHTRM   DC    CL7'MCH-TRM'
CCH      DC    CL7'CCH    '
CCHINC   DC    CL7'CCH-INC'
CCHCRH   DC    CL7'CCH-CRH'
OBR      DC    CL7'OBR    '
OBRSHT   DC    CL7'OBR-SHT'
OBRDMT   DC    CL7'OBR-DMT'
OBREOD   DC    CL7'OBR-EOD'
OBRTMP   DC    CL7'OBR-TMP'
OBRPRM   DC    CL7'OBR-PRM'
SFT      DC    CL7'SFT    '
SFTABN   DC    CL7'SFT-ABN'
SFTMCH   DC    CL7'SFT-MCH'
SFTPI    DC    CL7'SFT-PI '
SFTRST   DC    CL7'SFT-RST'
IPL      DC    CL7'IPL    '
DDR      DC    CL7'DDR    '
DDROPR   DC    CL7'DDR-OPR'
DDRSYS   DC    CL7'DDR-SYS'
MIH      DC    CL7'MIH    '
MIHCE    DC    CL7'MIH-CE '
MIHDE    DC    CL7'MIH-DE '
EOD      DC    CL7'EOD    '
MDR      DC    CL7'MDR    '
MDRDAS   DC    CL7'MDR-DAS'
         ORG   @NM00107+182
ALLCTS   DS    CL1664
         ORG   ALLCTS
MCHCT    DC    16F'0'
MCHTRMCT DC    16F'0'
CCHCT    DC    16F'0'
CCHINCCT DC    16F'0'
CCHCRHCT DC    16F'0'
OBRCT    DC    16F'0'
OBRSHTCT DC    16F'0'
OBRDMTCT DC    16F'0'
OBREODCT DC    16F'0'
OBRTMPCT DC    16F'0'
OBRPRMCT DC    16F'0'
SFTCT    DC    16F'0'
SFTABNCT DC    16F'0'
SFTMCHCT DC    16F'0'
SFTPICT  DC    16F'0'
SFTRSTCT DC    16F'0'
IPLCT    DC    16F'0'
DDRCT    DC    16F'0'
DDROPRCT DC    16F'0'
DDRSYSCT DC    16F'0'
MIHCT    DC    16F'0'
MIHCECT  DC    16F'0'
MIHDECT  DC    16F'0'
EODCT    DC    16F'0'
MDRCT    DC    16F'0'
MDRDASCT DC    16F'0'
         ORG   ALLCTS+1664
LASTDATE DC    CL4'    '
TABLECHH DC    CL2'  '
TOTALHD1 DC    CL12'RECORD TYPES'
TOTALHD3 DC    CL107' TOTAL  CPU-A CPU-B CPU-C CPU-D CPU-E CPU-F CPU-G C
               CPU-H CPU-I CPU-J CPU-K CPU-L CPU-M CPU-N CPU-O CPU-P   C
                '
CHARS    DC    CL16'0123456789ABCDEF'
         DS    CL3
WORK     DS    CL8
TEMPSAVE DC    CL84' '
SWITCHE  DC    AL1(0)
         ORG   SWITCHE
SWITCH1  DS    BL1
SWITCH2  EQU   SWITCHE+0
SWITCH3  EQU   SWITCHE+0
SWITCH4  EQU   SWITCHE+0
SWITCH5  EQU   SWITCHE+0
         ORG   SWITCHE+1
LETTER1  DC    CL1'M'
CPULINE  DC    CL24'CPU   MODEL   SERIAL NO.'
CPUDATA  DC    CL22' '
         ORG   CPUDATA
@NM00111 DS    CL1
CPUTYPE  DS    CL1
@NM00112 DS    CL5
CPUMODEL DS    CL3
@NM00113 DS    CL6
CPUSERAL DS    CL6
         ORG   CPUDATA+22
NEWDATEH DS    CL12
         ORG   NEWDATEH
@NM00114 DC    CL5'DATE '
DAYJUL   DC    CL3'   '
@NM00115 DC    CL2'  '
YEARJUL  DC    CL2'  '
         ORG   NEWDATEH+12
OVERTOT  DC    CL16' OVER ALL TOTALS'
MDRLINE  DC    CL35'RD/SRCHD COR/RTRY  CNT/ERR COM/DATA'
FRAMEMCH DC    CL7'FRM-MCH'
FRAMECCH DC    CL7'FRM-CCH'
FRMTEMP  DC    CL7' '
LINEFRAM DC    CL43'GROUP   FRAME   EC LEVEL    SEQ #  LASTFLAG'
         DS    CL5
DBLWORD  DS    CL8
TOTHEAD  DC    CL22'MACHINE CHECK         '
         DC    CL22'CHANNEL CHECK         '
         DC    CL22'OUTBOARD              '
         DC    CL22'SOFTWARE              '
         DC    CL22'SYSTEM INITIALIZATION '
         DC    CL22'SYSTEM RECONFIGURATION'
         DC    CL22'MISSING INTERRUPT     '
         DC    CL22'SYSTEM TERMINATION    '
         DC    CL22'BUFFER OFFLOAD        '
         DS    CL2
ADDRTAB1 DC    AL4(LINE03)
         DC    AL4(LINE06)
         DC    AL4(LINE08)
         DC    AL4(LINE10)
         DC    AL4(LINE12)
         DC    AL4(LINE14)
         DC    AL4(LINE16)
         DC    AL4(LINE18)
         DC    AL4(MDRDAS)
NUMCHAR1 DC    A(11)
         DC    A(20)
         DC    A(2)
         DC    A(73)
         DC    A(15)
         DC    A(37)
         DC    A(2)
         DC    A(2)
         DC    A(6)
ADDRTAB2 DC    AL4(LINE8)
         DC    AL4(LINE1)
         DC    AL4(LINE2)
         DC    AL4(LINE3)
         DC    AL4(LINE5)
         DC    AL4(LINE66)
         DC    AL4(LINE7)
         DC    AL4(LINE6)
         DC    AL4(LINE4)
NUMCHAR2 DC    A(77)
         DC    A(17)
         DC    A(17)
         DC    A(103)
         DC    A(97)
         DC    A(77)
         DC    A(16)
         DC    A(0)
         DC    A(79)
SUBTOT   DC    16F'0'
PATCH    DC    20F'0'
TOTALS   DC    16F'0'
LETTER   DC    CL1'M'
         DC    CL1'M'
         DC    CL1'C'
         DC    CL1'C'
         DC    CL1'C'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'S'
         DC    CL1'S'
         DC    CL1'S'
         DC    CL1'S'
         DC    CL1'S'
         DC    CL1'I'
         DC    CL1'D'
         DC    CL1'D'
         DC    CL1'D'
         DC    CL1'M'
         DC    CL1'M'
         DC    CL1'M'
         DC    CL1'E'
         DC    CL1'M'
         DC    CL1'M'
IFCEVENT CSECT
     DC  S(PATCH)    SET UP THE ADDRESSABILITY FOR THE PATCH AREA
IFCEVENT CSECT
EXECMVC  MVC RECTYP1(0),0(R8)
EXECMVC2 MVC   CUA12(0),0(R8)
IFCEVENT CSECT
MVCDATA  MVC   R0(R0,R6),0(R8)
IFCEVENT CSECT
MOVECHAR   MVC  R0(0,R8),0(R6)
IFCEVENT CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
I0001    EQU   @03
R2       EQU   @02
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
R10      EQU   @10
R11      EQU   @11
R12      EQU   @12
R15      EQU   @15
R0       EQU   @00
R1       EQU   @01
R13      EQU   @13
R14      EQU   @14
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
IOHND    EQU   0
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
DEBUG    EQU   PARM+4
DEBUG4   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG12  EQU   DEBUG+1
DEBUG17  EQU   DEBUG+2
DEBUG24  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUGA   EQU   PARM+8
DEBUG46  EQU   DEBUGA+1
DEBUG47  EQU   DEBUGA+1
MISC     EQU   PARM+12
PRINTES  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
EVSYEAR  EQU   STRTDATE
EVSDAY   EQU   STRTDATE+1
SORTNUM  EQU   PARM+84
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECCCHHR EQU   CCHHRLNG
RECLNGTH EQU   CCHHRLNG+6
LINECT   EQU   PARM+120
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
DUMPTABL EQU   PARM+200
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
TRENDTMP EQU   TREND2+8
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVYEAR   EQU   EVSTOP
EVDAY    EQU   EVSTOP+1
EVNUM    EQU   EVTABLE+4
EVKEY    EQU   EVTABLE+6
EVMODEL  EQU   EVKEY
EVSERIAL EQU   EVKEY+2
EVLETTER EQU   EVKEY+5
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SYSTEMP  EQU   SYSUM2+7
SHARE    EQU   0
SHAREIO  EQU   SHARE+2
SHRCUCPU EQU   SHAREIO
SHARECUA EQU   SHRCUCPU
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUAVAL   EQU   CUA+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
VOLUME   EQU   0
CPUS     EQU   0
CPUCUAS  EQU   0
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
LRTREC   EQU   0
LRTKEY   EQU   LRTREC
LRTKEY1  EQU   LRTKEY
LRTSMS   EQU   LRTREC+2
LRTERRID EQU   LRTREC+3
LRTDATE  EQU   LRTREC+8
LRTYRDAY EQU   LRTDATE+1
LRTYEAR  EQU   LRTYRDAY
LRTDAY   EQU   LRTYRDAY+1
LRTTIME  EQU   LRTREC+12
LRTCPU   EQU   LRTREC+16
LRTCPMOD EQU   LRTCPU+1
LRTCPUS  EQU   LRTCPMOD
LRTMODEL EQU   LRTCPMOD+3
MCHREC   EQU   0
MCHHEAD  EQU   MCHREC
MCHKEY   EQU   MCHHEAD
MCHSMS   EQU   MCHHEAD+2
MCHSYSTR EQU   MCHSMS+1
MCHCPUID EQU   MCHHEAD+16
MCHMOD   EQU   MCHCPUID+4
MCHJOBID EQU   MCHREC+32
MCHOPSW  EQU   MCHREC+40
CCHREC   EQU   0
CCHHEAD  EQU   CCHREC
CCHKEY   EQU   CCHHEAD
CCHSMS   EQU   CCHHEAD+2
CCHRINC  EQU   CCHSMS
CCHRCRH  EQU   CCHSMS+2
CCHCPUID EQU   CCHHEAD+16
CCHJOBID EQU   CCHREC+24
CCHCSW   EQU   CCHREC+56
CCHCODE  EQU   CCHREC+68
CCHCODE2 EQU   CCHCODE+2
CCHCUA   EQU   CCHREC+74
OBRREC   EQU   0
OBRHEAD  EQU   OBRREC
OBRKEY   EQU   OBRHEAD
OBRSMS   EQU   OBRHEAD+2
MISCSW   EQU   OBRSMS
OBRSUBTP EQU   OBRSMS+1
SDRCOUNT EQU   OBRSUBTP
OBRTEMP  EQU   OBRSUBTP
SHORTSW  EQU   OBRSUBTP
DISMOUNT EQU   OBRSUBTP
OBRCPUID EQU   OBRHEAD+16
OBRJOBID EQU   OBRREC+24
OBRSDEV2 EQU   OBRJOBID+2
OBRSCUA  EQU   OBRJOBID+5
OBRFCCW  EQU   OBRREC+32
OBRSRDS  EQU   OBRFCCW
OBRCSW   EQU   OBRREC+40
OBRSTAT  EQU   OBRCSW+4
OBRDEVDC EQU   OBRREC+48
OBRSECUA EQU   OBRREC+49
OBRCODE  EQU   OBRREC+52
OBRCODE1 EQU   OBRCODE
OBRCODE2 EQU   OBRCODE1+1
OBRDEV   EQU   OBRCODE+2
OBRCLASS EQU   OBRDEV
OBRLSDRC EQU   OBRREC+56
OBRPCUA  EQU   OBRREC+57
OBRSBCNT EQU   OBRREC+62
OBRVOL   EQU   OBRREC+64
OBRSEEK  EQU   OBRREC+70
OBRTCAM  EQU   OBRSEEK
OBRTERMN EQU   OBRSEEK+2
SFTREC   EQU   0
SFTHEAD  EQU   SFTREC
SFTKEY   EQU   SFTHEAD
SFTKEY1  EQU   SFTKEY
SFTCPUID EQU   SFTHEAD+16
SFTJOBID EQU   SFTREC+24
SFTSDWA  EQU   SFTREC+32
SFTABNDC EQU   SFTSDWA
SFTAEC1  EQU   SFTSDWA+96
SFTPROGC EQU   SFTAEC1+8
SFTFLGS  EQU   SFTSDWA+232
SFTRECP  EQU   SFTSDWA+292
SFTMODN  EQU   SFTRECP
SFTCSECT EQU   SFTRECP+8
SFTREXN  EQU   SFTRECP+16
IPLREC   EQU   0
IPLHEAD  EQU   IPLREC
IPLKEY   EQU   IPLHEAD
IPLCPUID EQU   IPLHEAD+16
IPLSYSID EQU   IPLREC+24
IPLREAS  EQU   IPLREC+28
IPLSTIME EQU   IPLREC+52
DDRREC   EQU   0
DDRHEAD  EQU   DDRREC
DDRKEY   EQU   DDRHEAD
DDRSMS   EQU   DDRHEAD+2
DDRDEPSW EQU   DDRSMS+1
DDRCPUID EQU   DDRHEAD+16
@NM00053 EQU   DDRREC+24
DDRJOBID EQU   @NM00053
DDRVOL1  EQU   @NM00053+8
DDRVOL2  EQU   @NM00053+14
DDRFCUA  EQU   DDRREC+45
DDRFDEV  EQU   DDRREC+48
DDRCODE2 EQU   DDRFDEV+2
DDRTOCUA EQU   DDRREC+53
DDRTODEV EQU   DDRREC+56
DDRDEV2  EQU   DDRTODEV+2
MIHREC   EQU   0
MIHHEAD  EQU   MIHREC
MIHKEY   EQU   MIHHEAD
@NM00055 EQU   MIHHEAD+4
MIHCEBIT EQU   @NM00055
MIHDEBIT EQU   @NM00055
MIHCPUID EQU   MIHHEAD+16
@NM00059 EQU   MIHREC+24
MIHJOBID EQU   @NM00059
MIHCUA   EQU   MIHREC+35
MIHVOL   EQU   MIHREC+38
MIHDEV   EQU   MIHREC+44
MIHCODE2 EQU   MIHDEV+2
EODREC   EQU   0
EODHEAD  EQU   EODREC
EODKEY   EQU   EODHEAD
EODCPUID EQU   EODHEAD+16
TPRREC   EQU   0
TPRHEAD  EQU   TPRREC
TPRKEY   EQU   TPRHEAD
TPRDEV   EQU   TPRHEAD+4
TPRBUFC  EQU   TPRHEAD+5
TPRCPUID EQU   TPRHEAD+16
TPRCUA   EQU   TPRREC+24
@NM00067 EQU   TPRREC+26
TPRVOL   EQU   @NM00067
RERR     EQU   0
OBRSENSE EQU   0
OBRSEN1  EQU   OBRSENSE+1
NEXTBYTE EQU   0
ADDNUM   EQU   0
LAST     EQU   0
NEWMDR   EQU   TIME1
LINE002  EQU   TIME1
TOPTEMP  EQU   TIME1+53
DUPLICAT EQU   TIME1
CCHFINSH EQU   CUA12
OBRFINSH EQU   CUA12
SFTFINSH EQU   CUA12
IPLFINSH EQU   CUA12
HEAD01   EQU   TIME1
TODAYDT  EQU   CUA11
TERMNAME EQU   VOLUME1
DEVTYPE1 EQU   DEVICE1
DAYSDATE EQU   TIME1+44
HEDDATE  EQU   CUA11
TOTALNM1 EQU   TIME1
PRTLINE1 EQU   TIME1
SSYS     EQU   PRTLINE1+37
REASON   EQU   PRTLINE1+46
PSWMCH   EQU   PRTLINE1+53
RCYRYXIT EQU   PRTLINE1+72
COMPMOD  EQU   PRTLINE1+82
CSECTID  EQU   PRTLINE1+92
ERRORID1 EQU   PRTLINE1+102
LINE0006 EQU   TIME1+32
BADREC   EQU   TIME1
NUMFAIL  EQU   TIME1+8
LINE44   EQU   CUA12
ERRORNA  EQU   ERRORID1
TOTALHD2 EQU   TIME1
WORKOVER EQU   WORK
HEADTOTL EQU   TIME1
RECNAME  EQU   HEADTOTL
TOTALVAL EQU   HEADTOTL+26
NMETOTAL EQU   MCH
TOTALNME EQU   RECNAME+4
COUNT    EQU   MCHCT
CPULINE1 EQU   TIME1
MVCOVER  EQU   TIME1
NEWDATEO EQU   TIME1
MDROBRLN EQU   TIME1+71
PSWMCH1  EQU   PSWMCH
LINEFRM1 EQU   CUA12
BADCOUNT EQU   TIME1
DDRFINSH EQU   CUA12
HEAD1    EQU   LINE01
LINE004  EQU   CUA12
LINE006  EQU   TIME1+54
LOSTSOFT EQU   SENSEA1
ODDMOVE  EQU   TIME1
RECCOUNT EQU   MCHCT
TOTALHD4 EQU   TOTALVAL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00110 EQU   HEADTOTL+36
CPUA1    EQU   HEADTOTL+32
FORTOTAL EQU   TOTALVAL+1
@NM00109 EQU   TOTALVAL
@NM00108 EQU   HEADTOTL+22
RTYPE    EQU   RECNAME
@NM00106 EQU   PRTLINE1+100
@NM00105 EQU   PRTLINE1+90
@NM00104 EQU   PRTLINE1+80
@NM00103 EQU   PRTLINE1+70
PROGEC   EQU   PRTLINE1+62
@NM00102 EQU   PRTLINE1+61
@NM00101 EQU   PRTLINE1+52
@NM00100 EQU   PRTLINE1+41
@NM00099 EQU   PRTLINE1+30
RECTYP2  EQU   PRTLINE1+23
@NM00098 EQU   PRTLINE1+22
JOBNAME2 EQU   PRTLINE1+14
@NM00097 EQU   PRTLINE1+13
TIME2    EQU   PRTLINE1+2
@NM00096 EQU   PRTLINE1
YR       EQU   DAYSDATE+4
@NM00093 EQU   DAYSDATE+3
DAY      EQU   DAYSDATE
OBRSEN0  EQU   OBRSENSE
DVBSDRE  EQU   TPRREC+56
@NM00069 EQU   TPRREC+39
TPRMODE  EQU   TPRREC+38
TPRLINAD EQU   TPRREC+36
@NM00068 EQU   TPRREC+34
TPRCEL   EQU   TPRCPUID+6
TPRMODEL EQU   TPRCPUID+4
TPRSER   EQU   TPRCPUID+1
@NM00066 EQU   TPRCPUID
TPRTIME  EQU   TPRHEAD+12
TPRDATE  EQU   TPRHEAD+8
@NM00065 EQU   TPRHEAD+6
TPRLENGT EQU   TPRBUFC
@NM00064 EQU   TPRBUFC
TPRSMS   EQU   TPRHEAD+2
TPRKEY2  EQU   TPRKEY+1
TPRKEY1  EQU   TPRKEY
EODCEL   EQU   EODCPUID+6
EODMODEL EQU   EODCPUID+4
EODSER   EQU   EODCPUID+1
@NM00063 EQU   EODCPUID
EODTIME  EQU   EODHEAD+12
EODDATE  EQU   EODHEAD+8
@NM00062 EQU   EODHEAD+5
EODDEV   EQU   EODHEAD+4
EODSMS   EQU   EODHEAD+2
EODKEY2  EQU   EODKEY+1
EODKEY1  EQU   EODKEY
MIHTYPE  EQU   MIHCODE2+1
MIHCLASS EQU   MIHCODE2
@NM00061 EQU   MIHDEV
@NM00060 EQU   @NM00059+8
MIHCEL   EQU   MIHCPUID+6
MIHMOD   EQU   MIHCPUID+4
MIHSER   EQU   MIHCPUID+1
@NM00058 EQU   MIHCPUID
MIHTIME  EQU   MIHHEAD+12
MIHDATE  EQU   MIHHEAD+8
@NM00057 EQU   MIHHEAD+5
@NM00056 EQU   @NM00055
MIHSMS   EQU   MIHHEAD+2
MIHKEY2  EQU   MIHKEY+1
MIHKEY1  EQU   MIHKEY
DDRDEV1  EQU   DDRTODEV
@NM00054 EQU   DDRREC+52
DDRTYPE  EQU   DDRCODE2+1
DDRCLASS EQU   DDRCODE2
DDRCODE1 EQU   DDRFDEV
DDRPHD   EQU   @NM00053+20
DDRCEL   EQU   DDRCPUID+6
DDRMOD   EQU   DDRCPUID+4
DDRSER   EQU   DDRCPUID+1
@NM00052 EQU   DDRCPUID
DDRTIME  EQU   DDRHEAD+12
DDRDATE  EQU   DDRHEAD+8
@NM00051 EQU   DDRHEAD+4
@NM00050 EQU   DDRSMS
DDRKEY2  EQU   DDRKEY+1
DDRKEY1  EQU   DDRKEY
IPLSHSEC EQU   IPLSTIME+3
IPLSSEC  EQU   IPLSTIME+2
IPLSMIN  EQU   IPLSTIME+1
IPLSHOUR EQU   IPLSTIME
IPLSDATE EQU   IPLREC+48
IPLTEMP  EQU   IPLREC+46
IPLHIGH  EQU   IPLREC+42
IPLCHAN  EQU   IPLREC+32
@NM00049 EQU   IPLREC+30
@NM00048 EQU   IPLREC+25
IPLCEL   EQU   IPLCPUID+6
IPLMOD   EQU   IPLCPUID+4
IPLSER   EQU   IPLCPUID+1
@NM00047 EQU   IPLCPUID
IPLTIME  EQU   IPLHEAD+12
IPLDATE  EQU   IPLHEAD+8
@NM00046 EQU   IPLHEAD+4
IPLSMS   EQU   IPLHEAD+2
IPLKEY2  EQU   IPLKEY+1
IPLKEY1  EQU   IPLKEY
SFTXDATA EQU   SFTREC+434
SFTLVARA EQU   SFTREC+432
@NM00045 EQU   SFTSDWA+238
SFTLCPUA EQU   SFTSDWA+236
SFTERRD  EQU   SFTFLGS+3
SFTERRC  EQU   SFTFLGS+2
SFTERRB  EQU   SFTFLGS+1
SFTERRA  EQU   SFTFLGS
@NM00044 EQU   SFTSDWA+136
SFTAAEC1 EQU   SFTSDWA+120
@NM00043 EQU   SFTSDWA+112
@NM00042 EQU   SFTAEC1
@NM00041 EQU   SFTSDWA+88
SFTGRSV  EQU   SFTSDWA+24
SFTCEL   EQU   SFTCPUID+6
SFTMOD   EQU   SFTCPUID+4
SFTSER   EQU   SFTCPUID+1
@NM00040 EQU   SFTCPUID
SFTTIME  EQU   SFTHEAD+12
SFTDATE  EQU   SFTHEAD+8
@NM00039 EQU   SFTHEAD+4
SFTSMS   EQU   SFTHEAD+2
SFTKEY2  EQU   SFTKEY+1
OBR34CT2 EQU   OBRTERMN+5
OBR34CT1 EQU   OBRTERMN+4
@NM00038 EQU   OBRTERMN
@NM00037 EQU   OBRSEEK+1
OBRRETRY EQU   OBRREC+60
OBRTYPE  EQU   OBRDEV+1
@NM00036 EQU   OBRCODE1
@NM00035 EQU   OBRCSW
OBRSDRS2 EQU   OBRSRDS
OBRSDRS1 EQU   OBRSRDS
OBRSSDRC EQU   OBRJOBID+4
OBRSDEV1 EQU   OBRJOBID
OBRCEL   EQU   OBRCPUID+6
OBRMOD   EQU   OBRCPUID+4
OBRSER   EQU   OBRCPUID+1
@NM00034 EQU   OBRCPUID
OBRTIME  EQU   OBRHEAD+12
OBRDATE  EQU   OBRHEAD+8
@NM00033 EQU   OBRHEAD+4
@NM00032 EQU   OBRSUBTP
@NM00031 EQU   OBRSUBTP
@NM00030 EQU   MISCSW
TRUNC    EQU   MISCSW
@NM00029 EQU   MISCSW
OBRKEY2  EQU   OBRKEY+1
OBRKEY1  EQU   OBRKEY
CCHLOG   EQU   CCHREC+80
CCHMP    EQU   CCHREC+76
@NM00028 EQU   CCHREC+73
CCHID    EQU   CCHREC+72
CCHTYPE  EQU   CCHCODE2+1
CCHCLASS EQU   CCHCODE2
CCHCODE1 EQU   CCHCODE
CCHECSW  EQU   CCHREC+64
CCHFCCW  EQU   CCHREC+48
CCHATIO  EQU   CCHREC+32
CCHCEL   EQU   CCHCPUID+6
CCHMOD   EQU   CCHCPUID+4
CCHSER   EQU   CCHCPUID+1
@NM00027 EQU   CCHCPUID
CCHTIME  EQU   CCHHEAD+12
CCHDATE  EQU   CCHHEAD+8
@NM00026 EQU   CCHHEAD+5
@NM00025 EQU   CCHSMS+2
@NM00024 EQU   CCHSMS+1
@NM00023 EQU   CCHSMS
@NM00022 EQU   CCHSMS
CCHKEY2  EQU   CCHKEY+1
CCHKEY1  EQU   CCHKEY
MCHLOG   EQU   MCHREC+48
MCHPGMID EQU   MCHREC+24
MCHCEL   EQU   MCHCPUID+6
MCHSER   EQU   MCHCPUID+1
@NM00021 EQU   MCHCPUID
MCHTIME  EQU   MCHHEAD+12
MCHDATE  EQU   MCHHEAD+8
@NM00020 EQU   MCHHEAD+4
@NM00019 EQU   MCHSMS
MCHKEY2  EQU   MCHKEY+1
MCHKEY1  EQU   MCHKEY
LRTMCEL  EQU   LRTCPU+6
@NM00018 EQU   LRTCPU
LRTHSECS EQU   LRTTIME+3
LRTSEC   EQU   LRTTIME+2
LRTMIN   EQU   LRTTIME+1
LRTHOUR  EQU   LRTTIME
LRTDATE0 EQU   LRTDATE
@NM00017 EQU   LRTREC+4
LRTDSMNT EQU   LRTERRID
@NM00016 EQU   LRTERRID
LRTSHRT  EQU   LRTERRID
@NM00015 EQU   LRTERRID
@NM00014 EQU   LRTSMS
LRTIMCNV EQU   LRTSMS
@NM00013 EQU   LRTSMS
LRTRUNC  EQU   LRTSMS
LRNS     EQU   LRTSMS
@NM00012 EQU   LRTSMS
LRTKEY2  EQU   LRTKEY+1
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUAV  EQU   CPUCUAS+2
CPCUANUM EQU   CPUCUAS
CPUVAL   EQU   CPUS+2
CPUNUM   EQU   CPUS
VOLVAL   EQU   VOLUME+2
VOLNUM   EQU   VOLUME
SERVAL   EQU   DEVSERAL+2
SERNUM   EQU   DEVSERAL
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+36
MDRNUM   EQU   DEVICE+34
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
CUA2     EQU   CUAVAL+2
CUA1     EQU   CUAVAL
CUANUM   EQU   CUA
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+10
SHARSERB EQU   SHAREIO+7
SHARECUB EQU   SHAREIO+5
SHARSERA EQU   SHRCUCPU+2
SHAREDX  EQU   SHARECUA
SHARENUM EQU   SHARE
@NM00011 EQU   SYSTEMP
SYSPERM  EQU   SYSTEMP
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
TRENDPRM EQU   TRENDTMP
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00010 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+12
TRECCH   EQU   TREGEN+8
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
ADCPUT   EQU   PARM+144
@NM00009 EQU   CCHHRLNG+5
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
TABSIZE  EQU   PARM+80
@NM00007 EQU   PARM+75
@NM00006 EQU   PARM+72
WRTHRSH  EQU   PARM+69
RDTHRSH  EQU   PARM+66
TERM     EQU   PARM+58
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CSERLOG  EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
PASSFLAG EQU   MISC
PLOGREC  EQU   MISC
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PHIST    EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SHIFT3RD EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00411 EQU   @EL00008
L000113  EQU   @EL00010
L000112  EQU   @EL00010
@RF00810 EQU   @EL00011
@RF00817 EQU   @EL00011
@RF00853 EQU   @EL00013
@RF00869 EQU   @EL00014
@RC00934 EQU   @EL00027
@RC00932 EQU   @EL00027
@RC00930 EQU   @EL00027
@RC00928 EQU   @EL00027
@RC00926 EQU   @EL00027
@RC00924 EQU   @EL00027
@RC00922 EQU   @EL00027
@RC00920 EQU   @EL00027
@RC00918 EQU   @EL00027
@RC00916 EQU   @EL00027
@RC00960 EQU   @EL00028
@RC00958 EQU   @EL00028
@RC00956 EQU   @EL00028
@RC00954 EQU   @EL00028
@RC00952 EQU   @EL00028
@RC00950 EQU   @EL00028
@RC00948 EQU   @EL00028
@RC00946 EQU   @EL00028
@RC00944 EQU   @EL00028
@RC00942 EQU   @EL00028
@RC00940 EQU   @EL00028
@PB00029 EQU   @PB00030
@RF01024 EQU   @RC01014
@RF01027 EQU   @RC01014
@RF01064 EQU   @EL00001
@RC00488 EQU   L000113
@RC00583 EQU   L000113
@RC00578 EQU   L000113
@RC00573 EQU   L000113
@RC00568 EQU   L000113
@RC00562 EQU   L000113
@RF00707 EQU   L000113
@RC00764 EQU   L000113
@PB00028 EQU   @PB00029
@PB00027 EQU   @PB00028
@PB00026 EQU   @PB00027
@PB00025 EQU   @PB00026
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IFCEVENT

*    NEW MODULE, RELEASE 17.                                       DG0H
*A547700-548000,714600                                           A35464
*C548100                                                         A35464
*D548600-549100                                                  A35464
*A285900-285984,291900,763600,764100                             A38710
*C308200,436100,444100                                           A38710
*A598700-598792                                                  A44355
*A412650-413100                                                 OY01164
*C162400                                                       @ZA04231
*C162400                                                       @ZA07345
*D184600                                                       @ZA24045
*A598730-598737,600100,603100,609700                           @ZA24045
         LCLA  &T,&SPN                                            0002
.@001    ANOP                                                     0002
IEBFDANL CSECT ,                                                  0002
         ST    @E,12(0,@D)                                        0002
         STM   @0,@8,20(@D)                                       0002
         STM   @A,@C,60(@D)                                       0002
         BALR  @B,0                                               0002
@PSTART  DS    0H                                                 0002
         USING @PSTART+00000,@B                                   0002
         LA    @3,4095(0,@B)                                      0002
         USING @PSTART+04095,@3                                   0002
         L     @0,@SIZ001                                         0002
         GETMAIN  R,LV=(0)                                        0002
         LR    @C,@1                                              0002
         USING @DATD+00000,@C                                     0002
         LM    @0,@1,20(@D)                                       0002
         XC    @TEMPS(@L),@TEMPS                                  0002
         ST    @D,@SAV001+4                                       0002
         LA    @F,@SAV001                                         0002
         ST    @F,8(0,@D)                                         0002
         LR    @D,@F                                              0002
*  F1A2:;
*         IF FDPSW = ON THEN DO     /*DO WE CONTINUE AFTER PICT LGTH*/;
F1A2     CLC   549(1,@5),ON                                       0046
         BC    07,@9FF                                            0046
*               R9 = R9 + 2         /*YES ADVANCE PTR TO CONT COLUMN*/;
         AH    @9,@D1                                             0048
*         R6 = LREMAIN         /** REFRESH VALUE TO BE MOVED**/;
         L     @6,612(0,@5)                                       0049
*               GO TO F4B5          /*BRANCH TO PROCESS PICTURE */;
         BC    15,F4B5                                            0050
*         END;
*  /*******************************************************************
*  /**                                                               **
*  /** THIS SECTION TESTS FOR THE FDPCSW WHICH WAS SET WHEN THE       *
*  /** PICTURE PARAMETER WAS CONTINUED UPON ANOTHER CARD.IF THE SWITCH*
*  /** IS ON IT IS TURNED OFF,THE SCAN POINTER ADVANCED TO COLUMN     *
*  /** THREE(ONE MORE TO BE ADDED LATER),THE LENGTH REMAINING IN THE  *
*  /** PICTURE PLACED IN A REGISTER AND A BRANCH TAKEN TO SCAN OUT THE*
*  /** REST OF THE PICTURE.THE BASE MODULE PASSES CONTROL TO THIS     *
*  /** MODULE WHEN THE FDPCSW IS FOUND ON.                            *
*  /**                                                                *
*                              /**WE ARE NOW SCANNING OUT A PICTURE  **
*                              /**THAT EXTENDS OVER MORE THAN ONE    **
*                              /**INPUT CARD                         **
*  /******************************************************************/
*         IF FDPCSW = ON THEN DO   /* IF PICSW ON THEN DO FOLLOWING*/;
@9FF     CLC   538(1,@5),ON                                       0052
         BC    07,@9FE                                            0052
*               FDPCSW = OFF   /**TURN OFF PICTURE CONTINUE SWITCH**/;
         MVC   538(1,@5),OFF                                      0054
*               R9 = R9 + 2              /**ADD TWO TO BUF PTR **/;
         AH    @9,@D1                                             0055
*               R6 = LREMAIN        /** PICK UP REMAINING LENGTH**/;
         L     @6,612(0,@5)                                       0056
*               GO TO F4E3               /*BRANCH TO CONT PROCESS */;
         BC    15,F4E3                                            0057
*         END;
*  /*******************************************************************
*  /**                                                                *
*  /** THIS SECTION TESTS FOR THE FDCSW (FD CONTINUATION SWITCH) BEING*
*  /** ON.IT WAS SET WHEN A FD CONTINUATION WAS DETERMINED.CONTROL IS *
*  /** PASSED TO THIS MODULE WHEN THE BASE MODULE FINDS THIS SWITCH ON*
*  /** WHEN ON,THE CONTINUATION SWITCH IS TURNED OFF,THE SCAN POINTER *
*  /**ADVANCED TO COLUMN THREE(ONE MORE TO BE ADDED LATER) AND A      *
*  /** BRANCH TAKEN FOR FURTHER PROCESSING.                           *
*                              /**THIS IS A NORMAL CONTINUATION      **
*                              /**EXPECT A KEYWORD NEXT              **
*  /**                                                                *
*  /*******************************************************************
*         IF FDCSW = ON THEN DO    /*IF FD CONTINUE ON DO FOLLOWING*/;
@9FE     CLC   536(1,@5),ON                                       0059
         BC    07,@9FD                                            0059
*               FDCSW = OFF    /**TURN OFF FD CONTINUE SWITCH**/;
         MVC   536(1,@5),OFF                                      0061
*               R9 = R9 + 2              /**ADD 2 TO BUF POINTER**/;
         AH    @9,@D1                                             0062
*               GO TO F1E2         /*BRANCH TO CONTINUE PROCESSING*/;
         BC    15,F1E2                                            0063
*         END;
*  /******************************************************************/
*  /**                                                                *
*  /** THE FDCTR IS USED TO DETERMINE THE NUMBER OF FD TABLES PRESENT *
*  /** PER GETMAIN OF 520 BYTES.FDCTR EQUAL TO ZERO OR EIGHT INDICATED*
*  /** THE NEED FOR A GETMAIN.IF THE COUNTER IS OTHER THAN ZERO OR    *
*  /** EIGHT A BRANCH IS TAKEN TO SCAN FOR KEYWORDS                   *
*  /**                                                               **
*  /******************************************************************/
*  F1C2:        R9 = R9 + 2  /*STEP POINTER TO COLUMN AFTER OPERATION*/
@9FD     EQU   *                                                  0065
F1C2     AH    @9,@D1                                             0065
*         IF FDCTR = 0 THEN GO TO F1C3  /*IF FDCTR = 0 GO TO GETMAIN*/;
         SR    @F,@F                                              0066
         CH    @F,608(0,@5)                                       0066
         BC    08,F1C3                                            0067
*        IF FDCTR ^= 8 THEN GO TO F1D2  /*BR IF WE HAVE MORE SPACE*/;
         LA    @F,8                                               0068
         CH    @F,608(0,@5)                                       0068
         BC    07,F1D2                                            0069
*  /*******************************************************************
*  /**                                                                *
*  /** THIS SECTION GETS MAIN FOR 520 BYTES TO BE USED FOR FD TABLES  *
*  /** A FD TABLE IS 64 BYTES LONG.THIS AREA WILL HOLD EIGHT FD TABLES*
*  /** THE EIGHT   BYTES LEFT OVER ARE USED FOR LINKAGE TO THE NEXT FD*
*  /** TABLE.THE LINK ADDRESS IS STORED IN THE LAST FOUR BYTES OF THIS*
*  /** AREA.AN UNSUCCESSFUL GETMAIN CAUSES CON CODE 12 AND A RETURN   *
*  /** CORE IS CLEARED TO BINARY ZEROES.WE STEP THROUGH THIS TABLE BY *
*  /** INCREMENTING THE FD POINTER BY 64.COUNT IS KEPT IN FDCTR       *
*  /**                                                                *
*  /*******************************************************************
*  F1C3:;
*  /*NEXT SEQUENCE ISSUES A CONDITIONAL GETMAIN                       *
*               FDCTR = 0      /**REINITILIZE FD COUNTER**/;
F1C3     SR    @F,@F                                              0071
         STH   @F,608(0,@5)                                       0071
*               R6 = ADDR(GCADDR)        /*PICK UP ADDRESS FOR GMAIN*/;
         LA    @6,376(0,@5)                                       0072
*               R1 = ADDR(GETMLIST)      /*PICK UP LIST ADDR*/;
         LA    @1,364(0,@5)                                       0073
*                              /*ISSUE GET MAIN MACRO*/
*  GEN ( GETMAIN EC,LV=520,A=(R6),SP=0,MF=(E,(R1)));
          GETMAIN EC,LV=520,A=(R6),SP=0,MF=(E,(R1))
         DS    0H
*         IF R15 = 0 THEN GO TO F1B5  /*BR IF SUCCESSFUL GET MAIN*/;
         LTR   @F,@F                                              0075
         BC    08,F1B5                                            0076
*               MS = 10         /*INDICATE MESSAGE */;
         LA    @F,10                                              0077
         STH   @F,406(0,@5)                                       0077
*  /******************************************************************/
*  /**                                                               **
*  /** THIS SECTION CONSISTING OF THREE LABELS WHICH ARE BRANCHED TO  *
*  /** FOR EXITING FROM THIS ROUTINE WHEN RETURN OF CONTROL IS NOT    *
*  /** REQUIRED.A BRANCH TO F1B41 CAUSES ALL FD SWITCHES TO BE TURNED**
*  /** OFF AND A NORMAL RETURN TO THE BASE MODULE.A BRANCH TO F1B411  *
*  /** CAUSES THE EPSW TO BE SET TO ONE(INDICATES NEED FOR MESSAGE)   *
*  /** SWITCHES OFF AND RETURN.A BRANCH TO F1B4 CAUSES FLAGSW(1) TO   *
*  /** BE SET INDICATING A NEED FOR ERROR FLAGGING A MESSAGE.EPSW IS  *
*  /** THEN SET,SWITCHES TURNED OFF AND A RETURN ISSUED.THUS F1B41    *
*  /** IS FOR A NORMAL RETURN.F1B411 INDICATES NEED FOR A MESSAGE AND *
*  /** RETURN.F1B4 INDICATES ERROR FLAGGING,MESSAGE AND RETURN.       *
*  /**                                                               **
*  /******************************************************************/
*  F1B4:;
*               FLAGSW(1) = '1'B         /*INDICATE ERROR FLAG WANTED*/
F1B4     OI    566(@5),B'10000000'                                0079
*  F1B411:;
*               EPSW = 1        /*INDICATE NEED FOR MESSAGE */;
F1B411   MVI   568(@5),1                                          0081
*               FDNAME = 'BADFIELD' /**INDICATE BAD FIELD **/;
         L     @1,596(0,@5)        
         MVC   0(8,@1),@C2                                        0082
*  F1B41:;
*               SWITCH(1) = OFF          /**TURN OFF FIRST FD SWITCH**/
F1B41    MVC   536(1,@5),OFF                                      0084
*         SWITCH(2:14) = SWITCH(1:13) /** TURN OFF FD SWITCHES**/;
         MVC   537(13,@5),536(@5)                                 0085
*               RETURN;
         BC    15,@EL01                                           0086
*  F1B5:;
*  /**                                                                *
*  /**    THIS SECTION CLEARS CORE FOR THE 520 BYTE FD TABLE.         *
*  /** POINTERS ARE INITILIZED AS FOLLOWS                             *
*  /**    FDPTR1- INIT ONCE FOR FIRST TIME                            *
*  /**    FDPTR2- INIT TO CURRENT FD TABLE                            *
*  /**FDPTR - INIT TO CURRENT 64 BYTE ENTRY                           *
*  /** FOR FIRST TIME LOGIC 64 IS TAKEN AWAY FROM FDPTR AS WE ADD 64  *
*  /** TO STEP THROUGH THE TABLE                                      *
*  /**                                                                *
*  /*******************************************************************
*               FDPTR = GCADDR /** INIT PTR TO NEW ADDRESS           **
F1B5     MVC   596(4,@5),376(@5)                                  0088
*               FDTBL(1) = '00'X  /*FIRST BYTE OF NEW TABLE TO ZERO*/;
         L     @1,596(0,@5)        
         MVI   0(@1),X'00'                                        0089
*               FDTBL(2:256) = FDTBL(1:255)     /* CLEAR TABLE*/;
         MVC   1(255,@1),0(@1)                                    0090
*               FDTBL(257:512) = FDTBL(255:511) /*CLEAR TABLE*/;
         MVC   256(256,@1),254(@1)                                0091
*         FDTBL(513:520) = FDTBL(512:519) /**CLEAR THRU 520 BYTES**/;
         MVC   512(8,@1),511(@1)                                  0092
*         IF FDPTR2 ^= 0 THEN GO TO F1B6 /**BR NOT FIRST TIME IN TBL **
         SR    @F,@F                                              0093
         C     @F,604(0,@5)                                       0093
         BC    07,F1B6                                            0094
*               FDPTR1 = GCADDR         /**INIT PTR TO FIRST TBL ADDR**
         MVC   600(4,@5),376(@5)                                  0095
*               GO TO F1B7            /**BR NO LINKAGE FOR FIRST TIME**
         BC    15,F1B7                                            0096
*  F1B6:;
*         FDPTR2 -> FDTBL(517:520) = GCADDR /**LINK TABLE TO LAST**/;
F1B6     L     @1,604(0,@5)        
         MVC   516(4,@1),376(@5)                                  0098
*  F1B7:;
*               FDPTR2 = GCADDR               /**INIT CURRENT PTR**/;
F1B7     MVC   604(4,@5),376(@5)                                  0100
*               FDPTR = FDPTR - 64 /**INIT PTR FOR FIRST TIME LOGIC**/;
         LH    @F,@D2                                             0101
         A     @F,596(0,@5)                                       0101
         ST    @F,596(0,@5)                                       0101
*  /* A BRANCH IS TAKEN TO THIS POINT IF THE FD TABLE ISNT USED UP */
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS IS ENTERED WHEN WE HAVE ROOM FOR ANOTHER 64 BYTE ENTRY *
*  /** WITHIN THE FD TABLE.ONE IS ADDED TO THE FDCTR AND THE FDPTR IS *
*  /** INCREMENTED BY 64 TO POINT TO A FRESH SECTION OF THE FD TABLE. *
*  /** THE SCAN POINTER IS NOW POINTING AT THE COLUMN FOLLOWING THE   *
*  /** CONTROL CARD NAME(FD).A MESSAGE IS INDICATED IF A BLANK IS NOT *
*  /** IN THIS POSITION.CONTROL PASSES TO THE NEXT SECTION IF A BLANK *
*  /** IS PRESENT.                                                    *
*  /**                                                                *
*  /*******************************************************************
*  F1D2:;
*               FDCTR = FDCTR + 1        /*ADD ONE TO FDCTR*/;
F1D2     LA    @F,1                                               0103
         AH    @F,608(0,@5)                                       0103
         STH   @F,608(0,@5)                                       0103
*               FDPTR = FDPTR + 64 /**POINT AT FRESH TABLE**/;
         LA    @F,64                                              0104
         A     @F,596(0,@5)                                       0104
         ST    @F,596(0,@5)                                       0104
*         IF INBUF(1) ^=' ' THEN DO;/* IF NO BLANK AFTER KEY SET MSG*/
         CLI   0(@9),C' '                                         0105
         BC    08,@9FC                                            0105
*               MS = 11                  /*SET MESSAGE*/;
         LA    @F,11                                              0107
         STH   @F,406(0,@5)                                       0107
*               GO TO F1B4           /* BRANCH TO EXIT POINT */;
         BC    15,F1B4                                            0108
*         END;
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION WILL SCAN,LOOKING FOR A NON-BLANK.IF THE       *
*  /** POINTER IS AT COLUMN 71 AND COLUMN 72 IS NON-BLANK,A COMMENTS  *
*  /** CONTINUATION IS INDICATED.A BLANK IN COLUMN 71 INDICATES A     *
*  /** REGULAR CONTINUATION.BLANK CARDS WILL BE SCANNED AND IGNORED   *
*  /** WE ARE LOOKING FOR THE FIRST KEYWORD.                          *
*  /**                                                                *
*  /*******************************************************************
*  F1E2:        R9 = R9 + 1              /*STEP POINTER BY ONE */;
@9FC     EQU   *                                                  0110
F1E2     AH    @9,@D3                                             0110
*         IF R9 => COUNTER THEN DO       /*IS POINTER PAST COL 71 */;
         C     @9,232(0,@5)                                       0111
         BC    04,@9FB                                            0111
*               FDCSW = ON               /*TURN ON FD CONTINUE SWITCH*/
         MVC   536(1,@5),ON                                       0113
*               RETURN                   /*RETURN TO IEBDG*/;
         BC    15,@EL01                                           0114
*         END;
*         IF INBUF(1) = ' ' THEN GO TO F1E2 /*IF BLANK BRANCH TO F1E2*/
@9FB     CLI   0(@9),C' '                                         0116
         BC    08,F1E2                                            0117
*               GO TO F2B11              /**BRANCH TO SCAN KEYWORDS**/;
         BC    15,F2B11                                           0118
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION CHECKS FOR A COMMA OR BLANK FOLLOWING A KEYWORD*
*  /** PARAMETER.A BLANK INDICATES THE END OF KEYWORD PROCESSING.     *
*  /** A NON-BLANK IN COLUMN 72 INDICATES A COMMENTS CONTINUATION.THE *
*  /** NEXT CARD WILL BE TREATED AS A COMMENT CARD AS THE COMCSW WILL *
*  /** BE TURNED ON.THE BASE MODULE PROCESSES ALL COMMENT CONT. CARDS *
*  /** FOR THIS MODULE.IF A BLANK IS FOUND THE FIELD LENGTH IS PICKED *
*  /** UP IN A REGISTER AND A BRANCH IS TAKEN TO PROCESS THIS ENTRY IN*
*  /** THE FD TABLE.A COMMA WILL CAUSE A BRANCH INTO THE KEYWORD SCAN.*
*  /** AN IMPROPER VALUE WILL CAUSE A MSG INDICATION AND BRANCH       *
*  /**                                                                *
*  /*******************************************************************
*  F2A1:;
*        IF R9 > COUNTER + 1 THEN GO TO F2A11 ; /* PAST COL 72 A38710 *
F2A1     LA    @F,1                                               0120
         A     @F,232(0,@5)                                       0120
         CR    @F,@9                                              0120
         BC    04,F2A11                                           0121
*        IF R9 = COUNTER + 1 THEN DO ;     /* AT COL 72        A38710 *
         LA    @F,1                                               0122
         A     @F,232(0,@5)                                       0122
         CR    @F,@9                                              0122
         BC    07,@9FA                                            0122
*              IF INBUF(1) = ' ' THEN   /* NO CONTINUATION     A38710 *
         CLI   0(@9),C' '                                         0124
*                   GO TO F2A11 ;                           /* A38710 *
         BC    08,F2A11                                           0125
*                   GO TO F2B12 ;        /* CONTINUATION       A38710 *
         BC    15,F2B12                                           0126
*              END ;                                        /* A38710 *
*   IF INBUF(1) = ' ' THEN DO;
@9FA     CLI   0(@9),C' '                                         0128
         BC    07,@9F9                                            0128
*  /*THE CONTINUATION SW WILL BE SET IF COL 72 IS NOT BLANK */
*               IF COUNTER -> INBUF(2) ^=' ' THEN DO;
         L     @1,232(0,@5)        
         CLI   1(@1),C' '                                         0130
         BC    08,@9F8                                            0130
*                    COMCSW = ON         /*TURN ON COMMENT SW*/;
         MVC   565(1,@5),ON                                       0132
*               END;
* F2A11: R6 = FDLGTH ;                  /* RESTORE FIELD LENGTHA38710*/
@9F8     EQU   *                                                  0134
F2A11    L     @1,596(0,@5)        
         LH    @6,24(0,@1)                                        0134
*               GO TO F5D2          /*BRANCH TO PROCESS WKAREA*/;
         BC    15,F5D2                                            0135
*  /*COLUMN AFTER PARA MUST ALWAYS BE A COMMA */
*         END;
*   IF INBUF(1) = ',' THEN GO TO F2B1 ;
@9F9     CLI   0(@9),C','                                         0137
         BC    08,F2B1                                            0138
*        IF R9 = COUNTER THEN GO TO F1E2 ; /* AT COL 71        A38710 *
         C     @9,232(0,@5)                                       0139
         BC    08,F1E2                                            0140
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION IS THE KEYWORD SCAN.                           *
*  /** IF A BLANK FOLLOWS THE COMMA AFTER LAST PARAMETER SCANNED,THIS *
*  /** INDICATES A CONTINUATION OF THE FD CARD.THE FDCSW WILL BE      *
*  /** TURNED ON AND A BRANCH TAKEN TO RETURN TO THE BASE MODULE. IF  *
*  /** NOT A BLANK A BRANCH IS TAKEN TO SCAN FOR KEYWORDS.ILLEGIMATE. *
*  /** KEYWORDS WILL CAUSE A MSG INDICATION AND A BRANCH TO EXIT.     *
*  /** THERE IS NO CHECK FOR DUPLICATE KEYWORDS.A DUPLICATE WILL CAUSE*
*  /** THE LAST FOUND TO BE OVERLAID.THIS SCAN ALWAYS CONSIDERS THE   *
*  /** EQUAL SIGN FOLLOWING THE KEYWORD TO BE PART OF THE KEYWORD.WHEN*
*  /** A LEGITIMATE KEYWORD IS FOUND A BRANCH WILL BE TAKEN TO PROCESS*
*  /** IT.INDEX BY NAME IS NOT ALLOWED FOR FIRST RELEASE,ALTHOUGH CODE*
*  /** WILL BE FOUND WHICH PLACES THE NAME IN THE TABLE.THE SAME IS   *
*  /** TRUE FOR 'REPLACE'.THEREFORE A NAME IN PLACE OF A NUMBER FOR   *
*  /** THE KEYWORD INDEX= WILL CAUSE THE NAME TO BE PLACED IN THE FD  *
*  /** TABLE.THIS MAY CAUSE INCONSISTENT RESULTS WHEN INDEXING AS THE *
*  /** CREATE MODULE IS CODED FOR PROCESSING INDEX BY NUMBER ONLY     *
*  /**                                                                *
*  /*******************************************************************
*  F2A2:;
*               MS = 11        /** INDICATE MESSABE NUMBER 11**/;
F2A2     LA    @F,11                                              0142
         STH   @F,406(0,@5)                                       0142
*               GO TO F1B4               /*BRANCH TO EXIT POINT*/;
         BC    15,F1B4                                            0143
*  F2B1:;
*         IF INBUF(2) = ' ' THEN GO TO F2B12 /**BR CONTINUATION**/;
F2B1     CLI   1(@9),C' '                                         0145
         BC    08,F2B12                                           0146
*               R9 = R9 + 1              /**STEP POINTER PAST COMMA**/;
         AH    @9,@D3                                             0147
*  F2B11:;
*        IF R9 = COUNTER + 1 THEN DO ; /* COMMA IN COL 72      A38710 *
F2B11    LA    @F,1                                               0149
         A     @F,232(0,@5)                                       0149
         CR    @F,@9                                              0149
         BC    07,@9F7                                            0149
*  F2B12:;
*               FDCSW = ON     /**TURN ON FD CONTINUATION SWITCH**/;
F2B12    MVC   536(1,@5),ON                                       0152
*         RETURN               /** RETURN TO BASE MODULE**/;
         BC    15,@EL01                                           0153
*         END;
*                                       /**IF NAME= BRANCH TO F2B2**/
*         IF INBUF(1:5) = 'NAME=' THEN GO TO F2B2;
@9F7     CLC   0(5,@9),@C6                                        0155
         BC    08,F2B2                                            0156
*         IF INBUF(1:6) = 'INPUT=' THEN GO TO F3H1 /**BR ITS INPUT **/;
         CLC   0(6,@9),@C7                                        0157
         BC    08,F3H1                                            0158
*         IF INBUF(1:8) = 'FROMLOC=' THEN GO TO F3J1 /**BR TO F3J1 FOR
         CLC   0(8,@9),@C8                                        0159
*                                                       FROMLOC **/;
         BC    08,F3J1                                            0160
*                                        /*IF LENGTH= GO TO F2C2 */
*         IF INBUF(1:7) = 'LENGTH=' THEN GO TO F2C2 /*BR IF LENGTH*/;
         CLC   0(7,@9),@C9                                        0161
         BC    08,F2C2                                            0162
*                                        /*IF STARTLOC= GO TO F2D2*/
*         IF INBUF(1:9) = 'STARTLOC=' THEN GO TO F2D2;
         CLC   0(9,@9),@C10                                       0163
         BC    08,F2D2                                            0164
*                                        /*IF PICTURE= GO TO F2E2*/
*         IF INBUF(1:8) = 'PICTURE=' THEN GO TO F2E2;
         CLC   0(8,@9),@C11                                       0165
         BC    08,F2E2                                            0166
*                                        /*IF FORMAT= GO TO F2F2*/
*         IF INBUF(1:7) = 'FORMAT=' THEN GO TO F2F2;
         CLC   0(7,@9),@C12                                       0167
         BC    08,F2F2                                            0168
*                                        /*IF ACTION= GO TO F2G2*/
*         IF INBUF(1:7) = 'ACTION=' THEN GO TO F2G2;
         CLC   0(7,@9),@C13                                       0169
         BC    08,F2G2                                            0170
*                                        /*IF FILL= GO TO F2H2 */
*         IF INBUF(1:5) = 'FILL=' THEN GO TO F2H2;
         CLC   0(5,@9),@C14                                       0171
         BC    08,F2H2                                            0172
*                                        /*IF CYCLE= GO TO F2J2*/
*         IF INBUF(1:6) = 'CYCLE=' THEN GO TO F2J2;
         CLC   0(6,@9),@C15                                       0173
         BC    08,F2J2                                            0174
*         IF INBUF(1:6) = 'RANGE=' THEN GO TO F3A1 /*BR IF RANGE*/;
         CLC   0(6,@9),@C16                                       0175
         BC    08,F3A1                                            0176
*                                        /*IF CHARACTER= GO TO F3C2*/
*         IF INBUF(1:10) = 'CHARACTER=' THEN GO TO F3C2;
         CLC   0(10,@9),@C17                                      0177
         BC    08,F3C2                                            0178
*                                        /*IF SIGN= GO TO F3D2*/
*         IF INBUF(1:5) = 'SIGN=' THEN GO TO F3D2;
         CLC   0(5,@9),@C18                                       0179
         BC    08,F3D2                                            0180
*                                        /*IF INDEX= GO TO F3E2*/
*         IF INBUF(1:6) = 'INDEX=' THEN GO TO F3E2;
         CLC   0(6,@9),@C19                                       0181
         BC    08,F3E2                                            0182
*                                        /*IF REPLACE= GO TO F3G2*/
*         IF INBUF(1:8) = 'REPLACE=' THEN GO TO F3G2;
         CLC   0(8,@9),@C20                                       0183
         BC    08,F3G2                                            0184
*  /*AT THIS POINT A LEGITIMATE KEYWORD WAS NOT FOUND.ISSUE MSG */
*               MS = 5                   /* INDICATE MSG */;
         LA    @F,5                                               0185
         STH   @F,406(0,@5)                                       0185
*               GO TO F1B4               /*BRANCH TO EXIT POINT */;
         BC    15,F1B4                                            0186
*  /******************************************************************/
*  /* NAME IS PROCESSED HERE ****************************************/
*  /** THE SCAN POINTER IS INCREMENTED TO POINT AT THE NAME FOLLOWING *
*  /** THE EQUAL SIGN AND THE NAME IS SCANNED OUT.IF THE FIRST        *
*  /** CHARACTER IS VALID ALPHABETIC AND THE LENGTH IS PROPER THE NAME*
*  /** IS PLACED IN THE FD TABLE,OTHERWISE A MSG IS INDICATED AND A   *
*  /**BRANCH TAKEN TO EXIT.THE POINTER IS THEN STEPPED PAST THE       *
*  /** PARAMETER AND A BRANCH TAKEN TO TEST FOR LAST PARAMETER ON CARD*
*  F2B2:;
*         R9 = R9 + 5                    /*POINT AT NAME PARAMETER*/;
F2B2     AH    @9,@D4                                             0188
*               CALL SCANOUT;            /*SCANS OUT PARAMETER*/
         BAL   @E,SCANOUT                                         0189
*  /** THE EQUAL SIGN AND THE NAME IS SCANNED OUT.THE SCANOUT ROUTINE *
*  /** TESTS FOR THE NAME BEING LONGER THAN 8 CHARS.THE FD TABLES ARE *
*  /** THEN SCANNED TO SEE IF THE NAME IS A DUPLICATE.THE SCAN IS     *
*  /** ENDED WHEN THE LAST NAME FIELD AND LINK FIELD CONTAIN ZERO     *
*         HOLDNAME = INBUF(1:R7);
         LR    @1,@7                                              0190
         BCTR  @1,0                                               0190
         LR    @E,@9                                              0190
         LA    @A,790(0,@5)                                       0190
         MVI   0(@A),C' '                                         0190
         MVC   1(007,@A),0(@A)                                    0190
         EX    @1,@MVC                                            0190
*               R4 = FDPTR1    /**PICK UP FIRST TABLE ADDRESS**/;
         L     @4,600(0,@5)                                       0191
*  F2B21:;
*  /**LMOVED IS USED AS COUNTER,IT IS INIT TO ZERO WHEN USED ELSEWHERE*
*               LMOVED = 0    /**INIT COUNTER FOR SCAN**/;
F2B21    SR    @F,@F                                              0193
         STH   @F,620(0,@5)                                       0193
*               R6 = R4        /**  COPY ADDRESS**/;
         LR    @6,@4                                              0194
*  F2B22:;
*               LMOVED = LMOVED + 1 /** ADD ONE TO COUNTER**/;
F2B22    LA    @F,1                                               0196
         AH    @F,620(0,@5)                                       0196
         STH   @F,620(0,@5)                                       0196
*         IF R6 -> FDTBL(1) ^= '00'X THEN DO /**DO BELOW IF NO NAME**/;
         CLI   0(@6),X'00'                                        0197
         BC    08,@9F6                                            0197
*         IF R6-> FDTBL(1:8) = HOLDNAME  THEN
         CLC   0(8,@6),790(@5)                                    0199
         BC    07,@9F5                                            0199
*         DO;
*        /**   FOUND DUPLICATE NAME   **/
*               MS = 3         /** SET MESSAGE INDICATION **/;
         LA    @F,3                                               0201
         STH   @F,406(0,@5)                                       0201
*               GO TO F1B4     /**BR TO EXIT THIS ROUTINE**/;
         BC    15,F1B4                                            0202
*         END;
*               R6 = R6 + 64   /**POINT AT NEXT FD ENTRY**/;
@9F5     AH    @6,@D5                                             0204
*         IF LMOVED ^= 8 THEN DO /**BR IF AT END OF TABLE**/;
         LA    @F,8                                               0205
         CH    @F,620(0,@5)                                       0205
*               GO TO F2B22    /** BRANCH TO COMPARE**/;
         BC    07,F2B22                                           0207
*         END;
*         R4 = R4 -> FDTBL(517:520) /** PICK UP NEXT TABLE ADDRESS**/;
@9F4     L     @4,516(0,@4)                                       0209
*               GO TO F2B21    /**BR TO START LOOKING AGAIN**/;
         BC    15,F2B21                                           0210
*         END;
*  F2B23:;
@9F6     EQU   *                                                  0212
*         FDNAME = INBUF(1:R7)           /*PLACE NAME IN FDTABLE*/;
F2B23    LR    @1,@7                                              0213
         BCTR  @1,0                                               0213
         LR    @E,@9                                              0213
         L     @2,596(0,@5)        
         LR    @A,@2                                              0213
         MVI   0(@A),C' '                                         0213
         MVC   1(007,@A),0(@A)                                    0213
         EX    @1,@MVC                                            0213
*  STEPPTR:     R9 = R8             /*STEP POINTER PAST PARAMETER*/;
STEPPTR  LR    @9,@8                                              0214
*               GO TO F2A1               /*BR TO TEST FOR LAST PARA */;
         BC    15,F2A1                                            0215
*  /******************************************************************/
*  /* LENGTH IS PROCESSED HERE **************************************/
*  /******************************************************************/
*  /**                                                                *
*  /**    THE SCAN POINTER IS STEPPED TO POINT AT THE LENGTH,AND THE  *
*  /** NUMBER IS SCANNED OUT,VALIDITY CHECKED,CONVERTED TO BINARY AND *
*  /** PLACED IN FDLGTH OF THE TABLE.A BRANCH IS THEN TAKEN TO STEP   *
*  /** POINTER PAST PARAMETER AND TEST FOR LAST PARAMETER             *
*  /**                                                                *
*  /*******************************************************************
*  F2C2:;
*         R9 = R9 + 7                    /*POINT TO PARAMETER */;
F2C2     AH    @9,@D6                                             0217
*               CALL SCANOUT;            /*SCANS OUT PARAMETER*/
         BAL   @E,SCANOUT                                         0218
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER**
         BAL   @E,VALCHECK                                        0219
*               CALL CONVB;              /*CONVERTS NUMBER TO BINARY*/
         BAL   @E,CONVB                                           0220
*         FDLGTH = R6                    /*BINARY LGTH TO TABLE*/;
         L     @1,596(0,@5)        
         STH   @6,24(0,@1)                                        0221
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;
         BC    15,STEPPTR                                         0222
*  /******************************************************************/
*  /* STARTLOC IS PROCESSED HERE ************************************/
*  /**                                                                *
*  /**    THE SCAN POINTER IS STEPPED TO POINT AT PARAMETER.THE NUMBER*
*  /** IS SCANNED OUT,VALIDITY CHECKED,CONVERTED TO BINARY,ITS VALUE  *
*  /** MINUS ONE IS THEN PLACED AT FDOBUF IN THE TABLE.A VALE MINUS   *
*  /** ONE IS REQUIRED BY THE CREATE MODULE.A BRANCH IS THEN TAKEN TO *
*  /** STEP THE POINTER AND TEST FOR LAST PARAMETER.                  *
*  /** A LENGTH OF ZERO IS NOT ALLOWED.MESSAGE 3 ISSUED BY CONVB RT.  *
*  /**                                                                *
*  /******************************************************************/
*  F2D2:;
*         R9 = R9 + 9                    /*POINT TO PARAMETER*/;
F2D2     AH    @9,@D7                                             0224
*               CALL SCANOUT;            /*SCANS OUT PARAMETER */
         BAL   @E,SCANOUT                                         0225
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER**
         BAL   @E,VALCHECK                                        0226
*               CALL CONVB;              /*CONVERTS NUMBER TO BINARY*/
         BAL   @E,CONVB                                           0227
*               STRTLOC1 = '1'B /** TURN ON STARTLOC SWITCH **/;
         L     @1,596(0,@5)        
         OI    62(@1),B'10000000'                                 0228
*                              /**STARTLOC MINUS ONE REQD BY CREATE**/
*               FDOBUF = R6 - 1 /**STARTLOC MINUS ONE TO TABLE**/;
         LR    @F,@6                                              0229
         BCTR  @F,0                                               0229
         STH   @F,40(0,@1)                                        0229
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER */;
         BC    15,STEPPTR                                         0230
*  /******************************************************************/
*  /* PICTURE IS PROCESSED HERE AND AT F4A1 ***************************
*  /******************************************************************/
*  /**    THIS SECTION PROCESSES THE LENGTH SUB-PARAMETER OF PICTURE. *
*  /** PICTURE CANNOT BE PRESENT IF A FORMAT IS PRESENT.A FORMAT WILL *
*  /** HAVE SET THE FDFMTSW.IF THIS IS ON A MSG IS INDICATED AND A    *
*  /** BRANCH TAKEN TO EXIT ROUTINE.IF NO FORMAT IS PRESENT THE FDPLSW*
*  /** IS TURNED ON SO THAT FORMAT WILL BE EXCLUDED AND THE LENGTH    *
*  /** SCANNED OUT,VALIDITY CHECKED,CONVERTED TO BINARY AND THE VALUE *
*  /** PLACED AT FDPLGTH FOR FURTHER PROCESSING.A BRANCH IS THEN TAKEN*
*  /** TO SCAN OUT THE ACTUAL PICTURE.LENGTH MUST BE PRESENT FOR      *
*  /** PROPER SCAN OF PICTURE.AS WE MUST BE REENTRANT,THE LENGTH IS   *
*  /** REQUIRED BEFORE THE PICTURE AS IT MAY EXTEND OVER MANY CARDS.  *
*  /** WE SCAN THE PICTURE OUT DEPENDING UPON A LENGTH.THEREFORE EVERY*
*  /** CHARACTER BETWEEN THE DELIMITING QUOTES IS CONSIDERED PART OF  *
*  /** THE PICTURE.                                                   *
*  /**                                                                *
*  /*******************************************************************
*  F2E2:;
*         R9 = R9 + 8                    /*POINT TO LENGTH SUBPARA */;
F2E2     AH    @9,@D8                                             0232
*                         /* PICTURE AND FORMAT ARE EXCLUSIVE IF BOTH*/
*                         /* ARE PRESENT,INDICATED BY FDFMTSW AND */
*                         /* FDPLSW WE STOP WITH MESSAGE*/
*         IF FDFMTSW = ON THEN DO    /*IF FORMAT PRESENT DO FOLLOWING*/
         CLC   539(1,@5),ON                                       0233
         BC    07,@9F3                                            0233
*  F2F4:;
*               MS = 13              /*INDICATE MESSAGE */;
F2F4     LA    @F,13                                              0236
         STH   @F,406(0,@5)                                       0236
*               GO TO F1B4           /*BRANCH TO EXIT */;
         BC    15,F1B4                                            0237
*         END;
*         FDPLSW = ON                    /*TURN ON PICT LGHT SWITCH */;
@9F3     MVC   540(1,@5),ON                                       0239
*               CALL SCANOUT;            /*SCAN OUT LENGTH OF PARA*/;
         BAL   @E,SCANOUT                                         0240
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER**
         BAL   @E,VALCHECK                                        0242
*               CALL CONVB;              /*CONVERT LGTH */
         BAL   @E,CONVB                                           0243
*         FDPLGTH = R6                   /*SAVE LGTH FOR PICT SCAN */;
         STH   @6,588(0,@5)                                       0244
*               GO TO F4A1               /*BRANCH TO FINISH PICTURE*/;
         BC    15,F4A1                                            0245
*  /******************************************************************/
*  /* FORMAT IS PROCESSED HERE *************************************/
*  /*******************************************************************
*  /**    THE SCAN POINTER IS STEPPED TO POINT AT THE PARAMETER AND   *
*  /** THE FDPLSW IS CHECKED TO SEE IF THIS PARAMETER IS EXCLUDED.IF  *
*  /** EXCLUDED A BRANCH IS TAKEN TO INDICATE A MSG AND EXIT.IF NOT   *
*  /** EXCLUDED THE FORMAT IS SCANNED OUT,CHECKED FOR TWO CHARACTERS  *
*  /** (MSG INDICATED IF NOT TWO) AND PLACED AT FDFORMAT IN FD TABLE. *
*  /** A BRANCH IS THE TAKEN TO STEP THE POINTER AND TEST FOR LAST    *
*  /** PARAMETER.                                                     *
*  /**                                                                *
*  /*******************************************************************
*  F2F2:;
*         R9 = R9 + 7                    /*POINT TO PARAMETER*/;
F2F2     AH    @9,@D6                                             0247
*         IF FDPLSW = ON THEN GO TO F2F4 /*BRANCH IF EXCLUDED*/;
         CLC   540(1,@5),ON                                       0248
         BC    08,F2F4                                            0249
*               FDFMTSW = ON             /*TURN ON FORMAT SWITCH*/;
         MVC   539(1,@5),ON                                       0250
*               CALL SCANOUT             /*SCAN OUT PARAMETER*/;
         BAL   @E,SCANOUT                                         0251
*  /**IF RETURN IS TO THIS POINT PARA IS PRESENT.A VALUE OF 2 IN REG**/
*  /** SEVEN INDICATES A CORRECT LENGTH**/
*         IF R7 = 2 THEN GO TO F6F22 /**BRANCH IF CORRECT LENGTH**/;
         CH    @7,@D1                                             0252
         BC    08,F6F22                                           0253
*  F2F21:;
*               MS =  3                  /**INDICATE MESSAGE**/;
F2F21    LA    @F,3                                               0255
         STH   @F,406(0,@5)                                       0255
*               GO TO F1B4           /* BRANCH TO EXIT POINT*/;
         BC    15,F1B4                                            0256
*  F6F22:;
*         IF INBUF(1:2) = 'AN'         /* FORMAT VALUE VALID   OY01164*
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164*
F6F22    CLC   0(2,@9),@C21                                       0258
         BC    08,F6F24                                           0259
*         IF INBUF(1:2) = 'AL'         /* FORMAT VALUE VALID   OY01164*
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164*
         CLC   0(2,@9),@C22                                       0260
         BC    08,F6F24                                           0261
*         IF INBUF(1:2) = 'ZD'         /* FORMAT VALUE VALID   OY01164*
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164*
         CLC   0(2,@9),@C23                                       0262
         BC    08,F6F24                                           0263
*         IF INBUF(1:2) = 'PD'         /* FORMAT VALUE VALID   OY01164*
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164*
         CLC   0(2,@9),@C24                                       0264
         BC    08,F6F24                                           0265
*         IF INBUF(1:2) = 'CO'         /* FORMAT VALUE VALID   OY01164*
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164*
         CLC   0(2,@9),@C25                                       0266
         BC    08,F6F24                                           0267
*         IF INBUF(1:2) = 'BI'         /* FORMAT VALUE VALID   OY01164*
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164*
         CLC   0(2,@9),@C26                                       0268
         BC    08,F6F24                                           0269
*         IF INBUF(1:2) = 'RA'         /* FORMAT VALUE VALID   OY01164*
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164*
         CLC   0(2,@9),@C16                                       0270
         BC    08,F6F24                                           0271
*              ELSE MS = 3;             /* INVALID VALUE GIVE MOY01164*
         LA    @F,3                                               0272
         STH   @F,406(0,@5)                                       0272
*              GO TO F1B4;              /* PRINT ERROR MESSAGE OY01164*
         BC    15,F1B4                                            0273
* F6F24:;                               /* PUT VALUES IN TABLE OY01164*
*         FDFORMAT = INBUF(1:2)          /*PLACE FORMAT IN TABLE*/;
F6F24    L     @1,596(0,@5)        
         MVC   30(2,@1),0(@9)                                     0275
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;
         BC    15,STEPPTR                                         0276
*  /******************************************************************/
*  /* ACTION IS PROCESSED HERE **************************************/
*  /******************************************************************/
*  /**    THE SCAN POINTER IS STEPPED TO POINT TO THE PARAMETER AND   *
*  /** THE PARAMETER SCANNED OUT.IF THE PARAMETER LENGTH IS NOT TWO A *
*  /** BRANCH IS TAKEN TO INDICATE MSG.IF LENGTH IS CORRECT THE       *
*  /** PARAMETER IS PLACED AT FDACTION IN THE FD TABLE AND A BRANCH   *
*  /** TAKEN TO STEP THE POINTER PAST THE PARAMETER.                  *
*  /**                                                                *
*  /*******************************************************************
*  F2G2:;
*               R9 = R9 + 7              /*POINT AT PARAMETER*/;
F2G2     AH    @9,@D6                                             0278
*               CALL SCANOUT             /*SCAN OUT PARAMETER */;
         BAL   @E,SCANOUT                                         0279
*  /**IF RETURN IS TO THIS POINT PARA IS PRESENT.A VALUE OF 2 IN REG**/
*  /**SEVEN INDICATES A CORRECT LENGTH**/
*         IF R7 ^= 2 THEN GO TO F2F21 /**IF INCORRECT BR TO SEND MSG**/
         CH    @7,@D1                                             0280
         BC    07,F2F21                                           0281
*               FDACTION = INBUF(1:2)    /*PLACE ACTION IN TABLE */;
         L     @1,596(0,@5)        
         MVC   28(2,@1),0(@9)                                     0282
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;
         BC    15,STEPPTR                                         0283
*  /******************************************************************/
*  /* FILL IS PROCESSED HERE ****************************************/
*  /**                                                                *
*  /**    THE SCAN POINTER IS STEPPED TO POINT TO THE PARAMETER.      *
*  /** THE PARAMETER MAY BE PRESENT IN TWO FORMS.                     *
*  /**    1.---- EBCDIC CHARACTER--DELIMITED BY QUOTES FRONT AND REAR *
*  /**    2.---- TWO HEXADECIMAL DIGITS --DELIMITED BY X' AT FRONT    *
*  /**                                  --DELIMITED BY  ' AT REAR     *
*  /** IF THE ABOVE CONDITIONS ARE NOT MET A MSG IS INDICATED AND A   *
*  /** BRANCH TAKEN TO EXIT.IF THE CHARACTER IS EBCDIC IT IS PLACED   *
*  /** DIRECTLY INTO THE TABLE AT FDFILL.IF THE CHARACTER IS HEX      *
*  /** IT IS FIRST CONVERTED AND THEN PLACED IN THE TABLE.            *
*  /**    E.G.--- X'C1' INTERNALLY IS A3F1                            *
*  /**          THIS IS CONVERTED TO A C1 AND PLACED IN TABLE.        *
*  /**                                                                *
*  F2H2:;
*         R9 = R9 + 5                    /* POINT AT P&RAMETER */;
F2H2     AH    @9,@D4                                             0285
*         IF INBUF(1) = 'X' THEN DO      /*ARE HEX DIGITS PRESENT */;
         CLI   0(@9),C'X'                                         0286
         BC    07,@9F2                                            0286
*         IF INBUF(2) ^= '''' THEN GO TO F2H22 /**ERROR IF NO QUOTE**/;
         CLI   1(@9),C''''                                        0288
         BC    07,F2H22                                           0289
*        IF ADDR(INBUF(5)) > COUNTER THEN  /* PAST COL 72      A38710 *
         L     @F,232(0,@5)                                       0290
         LA    @0,4(0,@9)                                         0290
         SR    @F,@0                                              0290
         BC    10,@9F1                                            0290
*         DO;
* F2H21:
*         MS = 21;
F2H21    LA    @F,21                                              0292
         STH   @F,406(0,@5)                                       0292
*         GOTO F1B4;
         BC    15,F1B4                                            0293
*   END;
*        IF INBUF(5) = '''' THEN GO TO F2H3    /**BR IF QUOTE **/;
@9F1     CLI   4(@9),C''''                                        0295
         BC    08,F2H3                                            0296
*  F2H22:;
*  /* AT THIS POINT QUOTES WERE NO IN PROPER POSITION */
*               MS = 3                   /*INDICATE MESSAGE */;
F2H22    LA    @F,3                                               0298
         STH   @F,406(0,@5)                                       0298
*               GO TO F1B4               /*BRANCH TO EXIT */;
         BC    15,F1B4                                            0299
*         END;
*  /*AT THIS POINT FILL CHARACTER IS EBCDIC NOT HEX IT MAY BE MOVED */
*  /*DIRECTLY INTO TABLE IF IT MEETS REQUIREMENTS FOR QUOTES  */
*        IF INBUF(1) ^= '''' THEN GO TO F2H22 /**BR IF NOT QUOTE**/;
@9F2     CLI   0(@9),C''''                                        0301
         BC    07,F2H22                                           0302
*        IF INBUF(3) ^= '''' THEN GO TO F2H22 /**BR IF NOT QUOTE**/;
         CLI   2(@9),C''''                                        0303
         BC    07,F2H22                                           0304
*        IF ADDR(INBUF(3)) > COUNTER THEN  /* PAST COL 72      A38710 *
         L     @F,232(0,@5)                                       0305
         LA    @0,2(0,@9)                                         0305
         SR    @F,@0                                              0305
*         GOTO F2H21;
         BC    04,F2H21                                           0306
*               FDFILL = INBUF(2) /**FILL CHARACTER TO TABLE**/;
         L     @1,596(0,@5)        
         MVC   33(1,@1),1(@9)                                     0307
*               R9 = R9 + 3              /*POSITION POINTER */;
         AH    @9,@D9                                             0308
*               GO TO F2A1               /*BR TO CONTINUE PROCESSING */
         BC    15,F2A1                                            0309
*  /* AT THIS POINT HEX FILL IS PRESENT MUST CONVERT IT */
*  /* INTERNALLY THE VALID CHARS ALLOWED ARE:           */
*  /*                     F0 THRU F9                    */
*  /*                     C1 THRU C6                    */
*  /*                                                   */
*  F2H3:;
*               FILLSW = OFF             /*CLEAR FILL SWITCH*/;
F2H3     MVC   542(1,@5),OFF                                      0311
*  F2H4:;
*               /* R9 POINTS AT THE X PRECEDING 'CHARS' */
*               R6 = 0                   /*CLEAR WORK REGISTER*/;
F2H4     SR    @6,@6                                              0313
*         IF INBUF(3) => 'F0'X THEN DO   /*IF REQMT NOT MET GO TO F2H7*
         CLI   2(@9),X'F0'                                        0314
         BC    04,@9F0                                            0314
*         IF INBUF(3) =< 'F9'X THEN DO   /*IF REQMT NOT MET GO TO F2H6*
         CLI   2(@9),X'F9'                                        0316
         BC    02,@9EF                                            0316
*               R6 = R6  INBUF(3)       /* OR DIGIT TO REGISTER */;
         SR    @F,@F                                              0318
         IC    @F,2(0,@9)                                         0318
         OR    @6,@F                                              0318
*               R6 = R6 & '0F'X          /* AND OUT TOP 4 DIGITS */;
         LA    @F,X'0F'                                           0319
         NR    @6,@F                                              0319
*  F2H5:;
*         IF FILLSW = ON THEN GO TO F2H8 /*BR TO PROCESS LAST DIGIT */;
F2H5     CLC   542(1,@5),ON                                       0321
         BC    08,F2H8                                            0322
*               R6 = R6 * 16             /* SHIFT DIGIT TO PROPER POS*/
         SLA   @6,4                                               0323
*               FILLSW = ON              /* TURN ON FILL SWITCH */;
         MVC   542(1,@5),ON                                       0324
*               Q(1:4) = R6    /**STORE VALUE IN TEMPORARY AREA**/;
         ST    @6,@TEMP4                                          0325
         MVC   216(4,@5),@TEMP4                                   0325
*               FDFILL = Q(4)  /**PLACE FILL CHARACTER IN FD TABLE**/;
         L     @1,596(0,@5)        
         MVC   33(1,@1),219(@5)                                   0326
*               R9 = R9 + 1              /*INCREMENT POINTER */;
         AH    @9,@D3                                             0327
*               GO TO F2H4               /*BR TO PROCESS 2ND DIGIT*/;
         BC    15,F2H4                                            0328
*         END;
*  /*AT THIS POINT INVALID CHARACTERS WERE FOUND */
*  F2H6:;
@9EF     EQU   *                                                  0330
*               MS = 3                   /* INDICATE MSG */;
F2H6     LA    @F,3                                               0331
         STH   @F,406(0,@5)                                       0331
*               GO TO F1B4               /* BRANCH TO EXIT */;
         BC    15,F1B4                                            0332
*         END;
*  /*AT THIS POINT THE CHAR IS TESTED FOR C1 THRU C6 */
*  F2H7:;
@9F0     EQU   *                                                  0334
*         IF INBUF(3)  < 'C1'X THEN GO TO F2H6 /*BR IF INVALID */;
F2H7     CLI   2(@9),X'C1'                                        0335
         BC    04,F2H6                                            0336
*         IF INBUF(3)  > 'C6'X THEN GO TO F2H6 /*BR IF INVALID */;
         CLI   2(@9),X'C6'                                        0337
         BC    02,F2H6                                            0338
*  /* VALID DIGIT FOUND HERE */
*               R6 = R6  INBUF(3:3)     /* OR DIGIT TO REGISTER */;
         SR    @F,@F                                              0339
         IC    @F,2(0,@9)                                         0339
         OR    @6,@F                                              0339
*               R6 = R6 & '0F'X          /*  & OUT TOP 4 DIGITS */;
         LA    @F,X'0F'                                           0340
         NR    @6,@F                                              0340
*               R6 = R6 + 9              /*CREATE PROPER DIGIT*/;
         AH    @6,@D7                                             0341
*               GO TO F2H5               /* BR TO TEST FOR FIRST DIGIT*
         BC    15,F2H5                                            0342
*  /* ENTER HERE FOR SECOND DIGIT OF FILL */
*  F2H8:;
*               R6 = R6  FDFILL         /*CONSTRUCT FILL CHARACTER*/;
F2H8     L     @1,596(0,@5)        
         SR    @0,@0                                              0344
         IC    @0,33(0,@1)                                        0344
         OR    @6,@0                                              0344
*               Q(1:4) = R6    /**STORE VALUE IN TEMPORARY AREA**/;
         ST    @6,@TEMP4                                          0345
         MVC   216(4,@5),@TEMP4                                   0345
*               FDFILL = Q(4)  /**PLACE FILL CHARACTER IN FD TABLE**/;
         L     @1,596(0,@5)        
         MVC   33(1,@1),219(@5)                                   0346
*               R9 = R9 + 4              /* POSITION POINTER */;
         AH    @9,@D10                                            0347
*               GO TO F2A1               /*BR TO CONTINUE PROCESSING*/;
         BC    15,F2A1                                            0348
*  /******************************************************************/
*  /* CYCLE IS PROCESSED HERE ************************************/
*  /******************************************************************/
*  /******************************************************************/
*  /**                                                              **/
*  /**    CYCLE IS PROCESSED BY POSITIONING THE SCAN POINTER TO THE **/
*  /** DECIMAL NUMBER UPON THE CONTROL CARD.THE SCANOUT SUBROUTINE  **/
*  /** IS CALLED TO ESTABLISH POINTERS USED BY THE VALIDITY CHECK   **/
*  /** SUBROUTINE.AFTER THE NUMBER IS VALIDITY CHECKED,CONVB IS     **/
*  /** CALLED IN ORDER TO CONVERT THE NUMBER TO BINARY.THE BINARY   **/
*  /** VALUE OF CYCLE,FOUND IN REG 6 IS THEN PLACED INTO THE CYCLE  **/
*  /** LOCATION OF THE FD TABLE.A BRANCH IS THEN TAKEN TO STEPPTR   **/
*  /** TO STEP THE LOCATION POINTER TO THE NEXT PARAMETER IF PRESENT**/
*  /**                                                              **/
*  /******************************************************************/
*  F2J2:;
*               R9 = R9 + 6              /*POSITION POINTER*/;
F2J2     AH    @9,@D11                                            0350
*               CALL SCANOUT             /*SCAN OUT PARAMETER*/;
         BAL   @E,SCANOUT                                         0351
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER**
         BAL   @E,VALCHECK                                        0352
*               CALL CONVB               /* CONVERT NUMBER TO BINARY*/;
         BAL   @E,CONVB                                           0353
*               FDCYCLE = R6             /*NUMBER TO TABLE*/;
         L     @1,596(0,@5)        
         STH   @6,26(0,@1)                                        0354
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER */;
         BC    15,STEPPTR                                         0355
*  /******************************************************************/
*  /* RANGE IS PROCESSED HERE ************************************/
*  /******************************************************************/
*  /**    POSITION THE SCAN POINTER TO NUMBER AS FOUND ON INPUT     **/
*  /**CONTROL CARD.TURN ON THE RANGE SWITCH AND CALL THE SCANOUT    **/
*  /**SUBROUTINE TO ESTABLISH POINTERS USED FOR VALIDITY CHECKING.  **/
*  /**VALIDITY CHECK THE NUMBER FOR VALID DECIMAL DIGITS AND CONVERT**/
*  /**THE NUMBER TO BINARY BY CALLING THE CONVB SUBROUTINE.PLACE THE**/
*  /**BINARY VALUE OF THE DECIMAL NUMBER INTO THE RANGE LOCATION OF **/
*  /**THE FD TABLE.BRANCH TO STEPPTR TO PROCESS NEXT PARAMETER.     **/
*  /**                                                              **/
*  /******************************************************************/
*  F3A1:;
*               R9 = R9 + 6              /* POSITION POINTER*/;
F3A1     AH    @9,@D11                                            0357
*               RANGESW = ON             /* TURN ON RANGE SWITCH*/;
         MVC   541(1,@5),ON                                       0358
*               CALL SCANOUT             /* SCAN OUT PARAMETER*/;
         BAL   @E,SCANOUT                                         0359
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER**
         BAL   @E,VALCHECK                                        0360
*               CALL CONVB               /*CONVERT NUMBER TO BINARY*/;
         BAL   @E,CONVB                                           0361
*               FDRANGE = R6             /*RANGE TO TABLE*/;
         L     @1,596(0,@5)        
         ST    @6,36(0,@1)                                        0362
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;
         BC    15,STEPPTR                                         0363
*  /******************************************************************/
*  /* CHARACTER IS PROCESSED HERE ********************************/
*  /******************************************************************/
*  /**    THE SCAN POINTER IS STEPPED TO THE PARAMETER AND THE START  *
*  /** CHARACTER IS PLACED AT FDCHAR IN THE FDTABLE.THE POINTER IS    *
*  /** THEN POSITIONED AND A BRANCH TAKEN FOR FURTHER PROCESSING      *
*  /**                                                              **/
*  /******************************************************************/
*  F3C2:;
*               R9 = R9 + 10             /* POSITION POINTER*/;
F3C2     AH    @9,@D12                                            0365
*               FDCHAR = INBUF(1) /**STARTING CHARACTER TO TABLE**/;
         L     @1,596(0,@5)        
         MVC   35(1,@1),0(@9)                                     0366
*               R9 = R9 + 1        /** POSITION POINTER**/;
         AH    @9,@D3                                             0367
*               GO TO F2A1               /*BR TO FURTHER PROCESSING*/;
         BC    15,F2A1                                            0368
*  F3D2:;
*  /*******************************************************************
*  /* SIGN IS PROCESSED HERE *************************************/
*  /******************************************************************/
*  /** SIGN IS PROCESSED BY TESTING THE VALUE AS FOUND IN THE CONTROL *
*  /** CARD FOR PLUS OR MINUS,AND IF FOUND CORRECT PLACING THE VALUE  *
*  /** FROM THE CARD IN THE FD SIGN FIELD OF THE FD TABLE             *
*  /** AN IMPROPER VALUE WILL CAUSE A MESSAGE TO BE ISSUED            *
*  /** THE SCAN POINTER IS THEN INCREMENTED TO POINT AT THE BLANK OR  *
*  /** COMMA FOLLOWING THE SIGN. A BRANCH IS THEN TAKEN TO TEST FOR   *
*  /** LAST PARAMETER ON THE CARD                                     *
*  /**                                                                *
*  /*******************************************************************
*         IF INBUF(6) = '+' THEN GO TO F3D3 /**BR OK TO PROCESS SIGN**/
F3D2     CLI   5(@9),C'+'                                         0370
         BC    08,F3D3                                            0371
*         IF INBUF(6) = '-' THEN GO TO F3D3 /**BR OK TO PROCESS SIGN**/
         CLI   5(@9),C'-'                                         0372
         BC    08,F3D3                                            0373
*               R9 = R9 + 5    /** POINT AT ERROR PARAMETER***/;
         AH    @9,@D4                                             0374
*               GO TO F2F21    /**BRANCH TO SET MESSAGE**/;
         BC    15,F2F21                                           0375
*  F3D3:;
*         FDSIGN = INBUF(6) /** EBCDIC SIGN TO TABLE**/;
F3D3     L     @1,596(0,@5)        
         MVC   34(1,@1),5(@9)                                     0377
*               R9 = R9 + 6    /**POINT PAST PARAMETER**/;
         AH    @9,@D11                                            0378
*               GO TO F2A1               /*BRANCH TO CONTINUE */;
         BC    15,F2A1                                            0379
*  /******************************************************************/
*  /* INDEX IS PROCESSED HERE ************************************/
*  /******************************************************************/
*  /**    THE SCAN POINTER IS STEPPED TO THE PARAMETER. (REFER TO     *
*  /** EXPLANATION INDEX BY NAME AND REPLACE AT KEYWORD SCAN).INDEX   *
*  /** AND REPLACE ARE MUTUALLY EXCLUSIVE.SO ARE INDEX NAME AND NUMBER*
*  /** THE INDEX NUMBER IS SCANNED OUT,VALIDITY CHECKED,CONVERTED TO  *
*  /** BINARY AND PLACED AT FDINDNUM IN THE FD TABLE.A BRANCH IS THEN *
*  /** TAKEN TO STEP POINTER AND TEST FOR LAST PARAMETER.INDEX BY NAME*
*  /** WHEN FOUND WILL BE PLACED AT FDINDNM IN TABLE.                 *
*  /**                                                                *
*  /*******************************************************************
*  F3E2:;
*               R9 = R9 + 6              /* ADJUST POINTER*/;
F3E2     AH    @9,@D11                                            0381
*         IF REPSW = ON THEN DO          /* IS INDEX EXCLUDED */;
         CLC   543(1,@5),ON                                       0382
         BC    07,@9EE                                            0382
*  F3F2:        MS = 13                  /* YES SET MESSAGE*/;
F3F2     LA    @F,13                                              0384
         STH   @F,406(0,@5)                                       0384
*               GO TO F1B4               /* BRANCH TO EXIT*/;
         BC    15,F1B4                                            0385
*         END;
*  /* COME HERE IF INDEX NOT EXCLUDED */
*               INDEXSW = ON             /* INDICATE INDEXING*/;
@9EE     MVC   544(1,@5),ON                                       0387
*  /** CHANGE FOLLOWING INSTRUCTION TO GO TO F3F4 WHEN INDEXING BY **/
*  /** NAME IS ALLOWED**/
*         IF INBUF(1) =< 'Z' THEN GO TO F2H22 /**BRANCH NOT NUMBER**/;
         CLI   0(@9),C'Z'                                         0388
         BC    12,F2H22                                           0389
*  /* PROCESS NUMBER HERE NAME PROCESSED A F3F4*/
*               CALL SCANOUT             /*SCAN OUT PARAMETER*/;
         BAL   @E,SCANOUT                                         0390
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER**
         BAL   @E,VALCHECK                                        0391
*               CALL CONVB               /*CONVERT NUMBER TO BINARY*/;
         BAL   @E,CONVB                                           0392
*               FDINDNUM = R6            /*NUMBER TO TABLE*/;
         L     @1,596(0,@5)        
         ST    @6,20(0,@1)                                        0393
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;
         BC    15,STEPPTR                                         0394
*  /* INDEX BY NAME PROCESSED HERE */
*  F3F4:;
*               INDNMSW = ON   /**INDEX BY NAME SW ON**/;
F3F4     MVC   545(1,@5),ON                                       0396
*               INDBYNAM = '1'B /**FD INDEX BY NAME SWITCH ON**/;
         L     @1,596(0,@5)        
         OI    32(@1),B'10000000'                                 0397
*  F3G4:;
*               CALL SCANOUT             /*SCAN OUT PARAMETER*/;
F3G4     BAL   @E,SCANOUT                                         0399
*         IF INDNMSW = ON THEN DO        /*INDEXING BY NAME */;
         CLC   545(1,@5),ON                                       0400
         BC    07,@9ED                                            0400
*               FDINDNM = INBUF(1:R7)    /**YES-NAME TO TABLE**/;
         LR    @1,@7                                              0402
         BCTR  @1,0                                               0402
         LR    @E,@9                                              0402
         L     @2,596(0,@5)        
         LA    @A,16(0,@2)                                        0402
         MVI   0(@A),C' '                                         0402
         MVC   1(007,@A),0(@A)                                    0402
         EX    @1,@MVC                                            0402
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;
         BC    15,STEPPTR                                         0403
*         END;
*  /* REPLACING HERE */
*               FDREPNM = INBUF(1:R7)    /**REPNAME TO TABLE**/;
@9ED     LR    @1,@7                                              0405
         BCTR  @1,0                                               0405
         LR    @E,@9                                              0405
         L     @2,596(0,@5)        
         LA    @A,8(0,@2)                                         0405
         MVI   0(@A),C' '                                         0405
         MVC   1(007,@A),0(@A)                                    0405
         EX    @1,@MVC                                            0405
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;
         BC    15,STEPPTR                                         0406
*  /******************************************************************/
*  /* REPLACE IS PROCESSED HRRE **********************************/
*  /******************************************************************/
*  F3G2:;
*         IF INDEXSW = ON THEN GO TO F3F2 /*BR IF REPLACE EXCLUDED*/;
F3G2     CLC   544(1,@5),ON                                       0408
         BC    08,F3F2                                            0409
*               REPSW = ON               /*TURN ON REPLACE SWITCH*/;
         MVC   543(1,@5),ON                                       0410
*               R9 = R9 + 8              /**ADJUST POINTER**/;
         AH    @9,@D8                                             0411
*               GO TO F3G4               /*BR TO SCAN OUT NAME*/;
         BC    15,F3G4                                            0412
*  /*******************************************************************
*  /**  THIS SECTION PROCESSES THE INPUT KEYWORD FOR FIELD SELECTION  *
*  /** THE NAME IS PLACED IN FDTBL AT REPNAME AND THEN COMPARED TO SEE*
*  /** IF THE NAME WAS PRESENT UPON THE DSD CARD EXCEPT WHEN SYSIN    *
*  /** MESSAGE 4 ISSUED IF NO MATCH.                                  *
*  /*******************************************************************
*  F3H1:;
*               R9 = R9 + 6    /** POINT AT INPUT DDNAME    **/;
F3H1     AH    @9,@D11                                            0414
*               CALL SCANOUT   /**SCAN OUT NAME AND CHECK LENGTH**/;
         BAL   @E,SCANOUT                                         0415
*                              /**REG 9 POINTS AT START OF NAME**/
*                              /**REG 8 COMMA OR BLANK AFTER NAME**/
*                              /** REG 7 CONTAINS LENGTH **/
*         FDREPNM = INBUF(1:R7) /** MOVE DDNAME TO FD TABLE**/;
         LR    @1,@7                                              0416
         BCTR  @1,0                                               0416
         LR    @E,@9                                              0416
         L     @2,596(0,@5)        
         LA    @A,8(0,@2)                                         0416
         MVI   0(@A),C' '                                         0416
         MVC   1(007,@A),0(@A)                                    0416
         EX    @1,@MVC                                            0416
*         INPUTSW = ON;
         MVC   789(1,@5),ON                                       0417
*         IF INBUF(1:5) = 'SYSIN' THEN DO /** DO BELOW IF SYSIN**/;
         CLC   0(5,@9),@C36                                       0418
         BC    07,@9EC                                            0418
*               SYSINSEL = ON  /** TURN ON SYSIN SEL SWITCH**/;
         MVC   636(1,@5),ON                                       0420
*               DCBPTR = ADDR(SYSI) /** POINT AT SYSIN DCB**/;
         LA    @F,116(0,@5)                                       0421
         ST    @F,300(0,@5)                                       0421
*               GO TO STEPPTR  /** BR TO CONTINUE PROCESSING**/;
         BC    15,STEPPTR                                         0422
*         END;
* F3H3:
*         IF FIRSTGMI = 0 THEN DO /** IF NO INPUT DCB DO BELOW**/;
@9EC     EQU   *                                                  0424
F3H3     SR    @F,@F                                              0424
         C     @F,392(0,@5)                                       0424
         BC    07,@9EB                                            0424
*  F3H2:;
*               MS = 4         /** INDICATE MESSAGE 4 **/;
F3H2     LA    @F,4                                               0427
         STH   @F,406(0,@5)                                       0427
*               GO TO F1B4     /** BRANCH TO EXIT THIS ROUTINE**/;
         BC    15,F1B4                                            0428
*         END;
*               DCBPTR = FIRSTGMI /** PICK UP FIRST DCB ADDRESS**/;
@9EB     MVC   300(4,@5),392(@5)                                  0430
*  F3H5:;
*         IF DDNAME1 = FDREPNM THEN DO /**IF NAME MATCHES DO BELOW**/;
F3H5     L     @1,596(0,@5)        
         L     @2,300(0,@5)        
         CLC   260(8,@2),8(@1)                                    0432
         BC    07,@9EA                                            0432
*               FIELDSEL = ON  /**TURN ON FIELD SELECT SWITCH **/;
         MVC   278(1,@2),ON                                       0434
*        IF INPUTSW = ON THEN DO ;      /* TEST IF ENTRY IS FIRST35464*
         CLC   789(1,@5),ON                                       0435
         BC    07,@9E9                                            0435
*               FDFROMAD = INREC ;      /* SAVE INREC IN FDTBL A35464 *
         MVC   44(4,@1),272(@2)                                   0437
*               GO TO STEPPTR ;         /* END OF INPUT CHECK  A35464 *
         BC    15,STEPPTR                                         0438
*         END ;                                             /* A35464 *
*         GO TO F5F31 ;                 /* END OF FD CARD      A35464 *
*         END;
*         IF NEXTDCB = 0 THEN GO TO F3H2 /** IF NO MORE INPUT DCBS
@9EA     SR    @F,@F                                              0442
         L     @1,300(0,@5)        
         C     @F,256(0,@1)                                       0442
*                                             PRESENT FOR COMPARE-BR **
         BC    08,F3H2                                            0443
*               DCBPTR = NEXTDCB /**PICK UP NEXT DCB POINTER**/;
         MVC   300(4,@5),256(@1)                                  0444
*               GO TO F3H5     /**BR TO KEEP LOOKING FOR DCB MATCH**/;
         BC    15,F3H5                                            0445
*  /*******************************************************************
*  /** THIS SECTION PLACES THE FROM LOCATION IN THE FD TABLE AT **/
*  /**  FDMLGTH  **/
*  /*******************************************************************
*  F3J1:;
*               R9 = R9 + 8    /** POINT AT PARAMETER**/;
F3J1     AH    @9,@D8                                             0447
*               CALL SCANOUT   /** SCAN OUT PARAMETER**/;
         BAL   @E,SCANOUT                                         0448
*               CALL VALCHECK  /**VALIDITY CHECK THE NUMBER**/;
         BAL   @E,VALCHECK                                        0449
*               CALL CONVB     /** CONVERT TO BINARY**/;
         BAL   @E,CONVB                                           0450
*         FDMLGTH = R6 - 1 /**ADJ NO.AND PUT IN TEMP LOCATION**/;
         LR    @F,@6                                              0451
         BCTR  @F,0                                               0451
         L     @1,596(0,@5)        
         STH   @F,48(0,@1)                                        0451
*               GO TO STEPPTR  /** BRANCH TO STEP POINTER**/;
         BC    15,STEPPTR                                         0452
*  /******************************************************************/
*  /* PICTURE IS PROCESSED HERE **********************************/
*  /******************************************************************/
*  /**    THIS SECTION BETWEEN LABELS OF F4A1 AND F5D2 WILL SCAN A    *
*  /** PICTURE AS INPUT ON CONTROL CARDS AND PLACE IT INTO A TEMPORARY*
*  /** AREA OF STORAGE FOR FURTHER PROCESSING.A GETMAIN IS FIRST      *
*  /** ISSUED TO HOLD THE PICTURE.AFTER SETTING A SWITCH TO INDICATE  *
*  /** THE TYPE OF PICTURE(EBCDIC,BINARY OR PACKED DECIMAL) THE       *
*  /** PICTURE IS PLACED AT SGCADDR AS IT IS SCANNED.THE PICTURE MAY  *
*  /** EXTEND FROM COLUMN FOUR THROUGH COLUMN 71.WHEN CONTINUED IT IS *
*  /** PICKED UP FROM COLUMN FOUR OF THE NEXT CARD.                   *
*  /**                                                                *
*  /**                                                                *
*  /*******************************************************************
*  F4A1:;
*               /* THIS GET MAIN IS ISSUED TO OBTAIN CORE FOR PICTURE*/
*               R1 = ADDR(GETMLIST)      /** PICK UP LIST ADDRESS    **
F4A1     LA    @1,364(0,@5)                                       0454
*                              /*ISSUE GET MAIN MACRO*/
*               R7 = ADDR(GCADDR)        /** PICK UP GCADDR ADDRESS  **
         LA    @7,376(0,@5)                                       0455
*         GEN ( GETMAIN EC,LV=(R6),A=(R7),SP=0,MF=(E,(R1)));
          GETMAIN EC,LV=(R6),A=(R7),SP=0,MF=(E,(R1))
         DS    0H
*         IF R15 = 0 THEN GO TO F4A2     /*BRANCH ON SUCCESSFUL GM */;
         LTR   @F,@F                                              0457
         BC    08,F4A2                                            0458
*               MS = 10                  /*INDICATE MESSAGE*/;
         LA    @F,10                                              0459
         STH   @F,406(0,@5)                                       0459
*               GO TO F1B4               /*BRANCH TO EXIT */;
         BC    15,F1B4                                            0460
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION INITILIZES COUNTERS AND ADDRESSES AND POINTS AT*
*  /** COMMA FOLLOWING LENGTH.IF COMMA IS IN COLUMN 71 THE FDPSW IS   *
*  /** TURNED ON AND CONTROL RETURNED TO THE BASE MODULE.CONTROL WILL *
*  /** RETURN TO F4B5 TO TEST FOR TYPE OF PICTURE.IF COMMA HAPPENS TO *
*  /** BE PAST COLUMN 71 A MSG IS INDICATED AND A BRANCH TAKEN TO FREE*
*  /** CORE AND EXIT AS THIS IS AN ERROR                              *
*  /**                                                                *
*  /*******************************************************************
*  F4A2:;
*               LMOVED = 0     /**INITILIZE COUNTER***/;
F4A2     SR    @F,@F                                              0462
         STH   @F,620(0,@5)                                       0462
*         LREMAIN = FDPLGTH    /**INIT LREMAIN TO PICTURE LENGTH**/;
         LH    @F,588(0,@5)                                       0463
         ST    @F,612(0,@5)                                       0463
*         SGCADDR = GCADDR     /*SUCESSFUL GETMAIN HERE SAVE ADDRESS*/;
         MVC   592(4,@5),376(@5)                                  0464
*               FDPCSW = ON              /*TURN ON PIC SW */;
         MVC   538(1,@5),ON                                       0465
*               R9 = R8               /** POINT AT COMMA AFTER LENGTH**
         LR    @9,@8                                              0466
*         IF INBUF(1) ^= ',' THEN GO TO F2A2 /**BR TO SET MESSAGE**/;
         CLI   0(@9),C','                                         0467
         BC    07,F2A2                                            0468
*  /* IS PICTURE IS INTERRUPTED AFTER LENGTH PARA BECAUSE COMMA IS IN *
*  /* COLUMN 71 REST OF PARAMETERS MUST START IN COLUMN 4 */
*         IF R9 = COUNTER THEN DO        /*ARE WE AT COL 71*/;
         C     @9,232(0,@5)                                       0469
         BC    07,@9E8                                            0469
*               FDPSW = ON               /*YES-CONT PICT AFTER LGTH*/;
         MVC   549(1,@5),ON                                       0471
*               RETURN                   /*RETURN TO IEBDG*/;
         BC    15,@EL01                                           0472
*         END;
*         IF R9 > COUNTER THEN DO        /*ARE WE PAST COL 71*/;
@9E8     C     @9,232(0,@5)                                       0474
         BC    12,@9E7                                            0474
*               MS = 21                  /*YES SET MSG*/;
         LA    @F,21                                              0476
         STH   @F,406(0,@5)                                       0476
*               GO TO F4E1          /**BRANCH TO FREEMAIN**/;
         BC    15,F4E1                                            0477
*         END;
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION STEPS THE POINTER PAST THE COMMA FOLLOWING     *
*  /** LENGTH OR IN CASE PICTURE WAS CONTINUED AFTER THE LENGTH SUB-  *
*  /** PARAMETER TO COLUMN FOUR.THE TYPE OF PICTURE IS INDICATED BY   *
*  /** SETTING  EQUOTESW,BQUOTESW OR PQUOTESW.THE POINTER IS THEN     *
*  /** ADVANCED TO THE QUOTE.IF QUOTE IS IN COLUMN 71 CONTROL IS      *
*  /** RETURNED TO GET ANOTHER CARD.CONTROL WILL RETURN TO F4E3 TO SET*
*  /** UP FOR SCANNING PICTURE,OTHERWISE WE GO TO F4E3.               *
*  /**                                                                *
*  /*******************************************************************
*  F4B5:;
@9E7     EQU   *                                                  0479
*               R9 = R9 + 1              /*POINT PAST COMMA*/;
F4B5     AH    @9,@D3                                             0480
*        IF INBUF(1) = '''' THEN DO /**IF EBCDIC DO BELOW**/;
         CLI   0(@9),C''''                                        0481
         BC    07,@9E6                                            0481
*              EQUOTESW = ON        /**TURN ON EQUOTE SWITCH**/;
         MVC   548(1,@5),ON                                       0483
*               GO TO F4D3     /**BRANCH TO PROCESS EBCDIC PICTURE**/;
         BC    15,F4D3                                            0484
*        END ;
*         IF INBUF(1:2) = 'B''' THEN GO TO F4C2 /* BR IF B'*/;
@9E6     CLC   0(2,@9),@C37                                       0486
         BC    08,F4C2                                            0487
*         IF INBUF(1:2) = 'P''' THEN GO TO F4C5 /**BR IF P QUOTE**/;
         CLC   0(2,@9),@C38                                       0488
         BC    08,F4C5                                            0489
*         IF INBUF(1) = ' '         /* BLANK AFTER LENGTH PARAM A44355*
*            THEN DO ;              /* CHECK IF CONTINUATION    A44355*
         CLI   0(@9),C' '                                         0490
         BC    07,@9E5                                            0490
*            IF FDPSW = ON THEN DO; /*IS THIS A CONTINUATION  @ZA24045*
         CLC   549(1,@5),ON                                       0492
         BC    07,@9E4                                            0492
*                    /*THEN LOOK FOR A NON-BLANK IN THIS CARD @ZA24045*
*               IF R9 => COUNTER THEN DO; /*IF PAST COL 71    @ZA24045*
         C     @9,232(0,@5)                                       0494
*                                   /*CONTINUE WITH NEXT CARD @ZA24045*
*                  RETURN ;         /*RETURN TO IEBDG         @ZA24045*
         BC    11,@EL01                                           0496
*               END ;                                       /*@ZA24045*
*               GO TO F4B5;         /*LOOK FOR A NON-BLANK    @ZA24045*
         BC    15,F4B5                                            0498
*            END ;                                          /*@ZA24045*
*               IF COUNTER -> INBUF(2) ^= ' '               /*  A44355*
*                  THEN DO ;        /* CONTINUATION REQUIRED    A44355*
@9E4     L     @1,232(0,@5)        
         CLI   1(@1),C' '                                         0500
         BC    08,@9E2                                            0500
*                     FDPSW = ON ;  /* PICTURE CONT. SW ON      A44355*
         MVC   549(1,@5),ON                                       0502
*                     RETURN ;      /* RETURN TO IEBDG FOR NEXT A44355*
         BC    15,@EL01                                           0503
*               END ;               /* OTHERWISE THE BLANK IS   A44355*
*         END ;                     /* AN ERROR                 A44355*
@9E2     EQU   *                                                  0505
*               MS = 21                  /* NO PARA SET MSG*/;
@9E5     LA    @F,21                                              0506
         STH   @F,406(0,@5)                                       0506
*               GO TO F4E1               /*BR TO FREEMAIN */;
         BC    15,F4E1                                            0507
*  F4C2:;
*               FDPSW = OFF;        /*TURN OFF FDPSW          @ZA24045*
F4C2     MVC   549(1,@5),OFF                                      0509
*               BQUOTESW = ON            /*TURN ON BQUOTE SW */;
         MVC   546(1,@5),ON                                       0510
*  F4C21:;
*               R9 = R9 + 1              /*ADVANCE PTR TO QUOTE*/;
F4C21    AH    @9,@D3                                             0512
*               GO TO F4D3     /** BRANCH TO PROCESS NUMBER**/;
         BC    15,F4D3                                            0513
*  F4C5:;
*               FDPSW = OFF;             /*TURN OFF FDPSW     @ZA24045*
F4C5     MVC   549(1,@5),OFF                                      0515
*               PQUOTESW = ON            /*TURN ON PQUOTE SW */;
         MVC   547(1,@5),ON                                       0516
*               GO TO F4C21              /*BR TO ADVANCE PTR*/;
         BC    15,F4C21                                           0517
*  /*******************************************************************
*  /**                                                                *
*  /**    AT THIS POINT R9 SHOULD BE POINTING AT THE LEADING QUOTE IN *
*  /**THE PICTURE STRING.IF THE QUOTE HAPPENS TO BE IN COL 71,WHICH  **
*  /** IS INDICATED BY R9 AND COUNTER BEING EQUAL,THE FDPCSW WILL BE  *
*  /** SET ON AND A RETURN ISSUED TO GO BACK TO THE BASE MODULE.      *
*  /**                                                                *
*  /*******************************************************************
*  F4D3:;
*               FDPSW = OFF;      /*TURN OFF FDPSW            @ZA24045*
F4D3     MVC   549(1,@5),OFF                                      0519
*         IF R9 = COUNTER THEN DO /**IF POINTER NOT AT COL 71 BRANCH**/
         C     @9,232(0,@5)                                       0520
         BC    07,@9E1                                            0520
*               FDPCSW = ON    /**TURN ON FDPCSW**/;
         MVC   538(1,@5),ON                                       0522
*                              /**BRANCH TO RETURN POINT**/
*               RETURN;
         BC    15,@EL01                                           0523
*         END;
*  F4E3:;
@9E1     EQU   *                                                  0525
*               R7 = GCADDR + LMOVED /**PICTURE GOES INTO THIS AREA**/;
F4E3     LH    @7,620(0,@5)                                       0526
         A     @7,376(0,@5)                                       0526
*               FDPSW = OFF    /**TURN OFF FDPSW WE ARE PAST LENGTH**/;
         MVC   549(1,@5),OFF                                      0527
*               R9 = R9 + 1              /*POINT AT FIRST CHAR*/;
         AH    @9,@D3                                             0528
*               R8 = R9                  /*COPY POINTER*/;
         LR    @8,@9                                              0529
*  /*******************************************************************
*  /**                                                                *
*  /** THIS SECTION WILL TEST FOR ALL OF THE PICTURE BEING MOVED.THIS *
*  /** SECTION MAY BE ENTERED AS A RESULT OF THE FDPCSW BEING ON,WHICH*
*  /** ORDINARILY MEANS A NORMAL PICTURE CONTINUATION.THE ONE CASE NOT*
*  /** COVERED IS WHEN THE END OF THE PICTURE COINCIDES WITH COL 71.  *
*  /** IN THIS CASE COL 4 OF THE NEXT CARD SHOULD CONTAIN A QUOTE.AT  *
*  /** THIS TIME R6 SHOULD BE ZERO.IF ZERO,THE SCAN POINTER IS INC BY *
*  /** ONE AND A BRANCH IS TAKEN TO SCAN FOR MORE PARAMETERS.IF R6 IS *
*  /** ZERO AND NO QUOTE IS FOUND IN COL 4 A BRANCH IS TAKEN TO SET   *
*  /** MESSAGE NUMBER AND FREE CORE NO LONGER NEEDED FOR THE PICTURE  *
*  /**                                                                *
*  /*******************************************************************
*         IF R6 = 0 THEN DO    /**BRANCH IF R6 NOT ZERO**/;
         LTR   @6,@6                                              0530
         BC    07,@9E0                                            0530
*         IF INBUF(1) = '''' THEN DO /**IF QUOTE IN COL 4 DO BELOW**/;
         CLI   0(@9),C''''                                        0532
         BC    07,@9DF                                            0532
*               R9 = R9 + 1    /**INCREMENT SCAN POINTER BY ONE**/;
         AH    @9,@D3                                             0534
*               FDPCSW = OFF   /**TURN OFF FDPCSW**/;
         MVC   538(1,@5),OFF                                      0535
*               FDPSW = OFF    /**TURN OFF FDPSW**/;
         MVC   549(1,@5),OFF                                      0536
*               GO TO F2A1     /**BRANCH TO SCAN FOR MORE PARAMETERS**/
         BC    15,F2A1                                            0537
*         END;
*               GO TO F4G11    /**BRANCH TO SET MSG AND FREE CORE**/;
*         END;
*                              /**COME HERE IF R6 NOT ZERO **/
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION SCANS OUT THE ACTUAL PICTURE. REG6 IS USED TO  *
*  /** COUNT THE LENGTH. IT IS DECREMENTED BY ONE  IN THIS LOOP,IF IT *
*  /** BECOMES ZERO THIS INDICATES THE END OF THE PICTURE AND A BRANCH*
*  /** IS TAKEN TO F4G1 TO LOOK FOR THE QUOTE WHICH MUST FOLLOW THE   *
*  /** PICTURE. REG8 IS INCREMENTED BY ONE UNTIL COLUMN 71 IS REACHED.*
*  /**     IF COLUMN 71 IS ENCOUNTERED BEFORE THE COUNT BECOMES ZERO, *
*  /**  A BRANCH IS TAKEN TO MOVE THE CHARACTERS SCANNED.             *
*  /**                                                                *
*  /*******************************************************************
*  F4F3:;
@9E0     EQU   *                                                  0541
*               R8 = R8 + 1              /*ADVANCE POINTER*/;
F4F3     AH    @8,@D3                                             0542
*               R6 = R6 - 1              /*SUBT ONE FROM LENGTH*/;
         BCTR  @6,0                                               0543
*         IF R6 = 0 THEN GO TO F4G1      /*BR TO F4G1 IF LGTH NOW ZERO*
         LTR   @6,@6                                              0544
         BC    08,F4G1                                            0545
*         IF R8 ^= COUNTER THEN GO TO F4F3 /**BR NOT AT COL 71 **/;
         C     @8,232(0,@5)                                       0546
         BC    07,F4F3                                            0547
*               GO TO F4G4          /** BRANCH TO MOVE PICTURE**/;
         BC    15,F4G4                                            0548
*  F4G5:;
*                                   /**MOVE PICTURE TO HOLD AREA**/
*         GEN ( MVC 0(1,R7),0(R9));
F4G5      MVC 0(1,R7),0(R9)
         DS    0H
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION OBTAINS THE LENGTH TO MOVE AND ADDS THE LENGTH *
*  /** TO BE MOVED TO LMOVED( ZEROED AR START). LREMAIN IS CALCULATED *
*  /** AND PICTURE IS MOVED TO THE TEMPORARY HOLD AREA(SGCADDR). THE  *
*  /** FDPCSW IS TURNED ON(INDICATES MORE TO SCAN) AND CONTROL IS     *
*  /** RETURNED TO THE BASE MODULE.                                   *
*  /**                                                                *
*  /*******************************************************************
*  F4G4:;
*               R6 = R8 - R9 + 1 /**OBTAIN LENGTH TO MOVE **/;
F4G4     LA    @6,1                                               0552
         SR    @6,@9                                              0552
         AR    @6,@8                                              0552
*               LMOVED = LMOVED + R6 /**COUNT LENGTH MOVED**/;
         LR    @F,@6                                              0553
         AH    @F,620(0,@5)                                       0553
         STH   @F,620(0,@5)                                       0553
*         LREMAIN = LREMAIN - R6 /**DETERMINE LENGTH LEFT IN PICTURE**/
         LCR   @F,@6                                              0554
         A     @F,612(0,@5)                                       0554
         ST    @F,612(0,@5)                                       0554
*               R6 = R6 -1          /** CORRECT THE LENGTH TO MOVE**/;
         BCTR  @6,0                                               0555
*  /* THIS MOVES CHARACTERS SCANNED TO PICTURE AREA*/
*         GEN ( EX R6,F4G5);
          EX R6,F4G5
         DS    0H
*               FDPCSW = ON         /**TURN ON PICTURE CONT SWITCH**/;
         MVC   538(1,@5),ON                                       0557
*         RETURN;
         BC    15,@EL01                                           0558
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION TESTS FOR THE QUOTE FOLLOWING THE PICTURE AND  *
*  /** IF FOUND,A BRANCH IS TAKEN TO MOVE THE LAST OF THE PICTURE.    *
*  /** OTHERWISE, THE MESSAGE IS INDICATED, POINTER IS SET FOR        *
*  /** FLAGGING. CONTROL THEN GOES TO THE NEXT SECTION.               *
*  /**                                                                *
*  /*******************************************************************
*  F4G1:;
*         IF R8 -> INBUF(1) = '''' THEN GO TO F4H1 /**BR TO MOVE REST**
F4G1     CLI   0(@8),C''''                                        0560
         BC    08,F4H1                                            0561
*  /**    IF R8 IS GT COUNTER ALL OF PICTURE IS SCANNED**/
*         IF R8 > COUNTER THEN GO TO F4H1; /**BR PICTURE IS SCANNED**/
         C     @8,232(0,@5)                                       0562
         BC    02,F4H1                                            0563
*  F4G11:;
*               MS = 3                   /* INDICATE MESSAGE*/;
F4G11    LA    @F,3                                               0565
         STH   @F,406(0,@5)                                       0565
*               R9 = R8                  /*SET POINTER FOR FLAG*/;
         LR    @9,@8                                              0566
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION FREES CORE OBTAINED FOR TEMPORARY STORAGE OF   *
*  /** THE PICTURE. A BRANCH IS THEN TO EXIT THIS ROUTINE.            *
*  /* THIS WILL FREE CORE OBTAINED TO HOLD PICTURE IT IS IN ERROR*/
*  /**                                                                *
*  /*******************************************************************
*  F4E1:;
*               R6 = FDPLGTH             /*PICK UP AMOUNT TO FREE*/;
F4E1     LH    @6,588(0,@5)                                       0568
*               R7 = ADDR(GCADDR)   /**PICK UP ADDRESS**/;
         LA    @7,376(0,@5)                                       0569
*               R1 = ADDR(GETMLIST)      /*PICK UP LIST ADDR*/;
         LA    @1,364(0,@5)                                       0570
*  GEN ( FREEMAIN E,LV=(R6),A=(R7),SP=0,MF=(E,(1)));
          FREEMAIN E,LV=(R6),A=(R7),SP=0,MF=(E,(1))
         DS    0H
*               GO TO F1B4               /*BRANCH TO EXIT */;
         BC    15,F1B4                                            0572
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION MOVES REMAINING PART OF PICTURE OR ALL OF IT   *
*  /** IN CASE IT WAS CONTAINED ON  ONE CARD. THE PICTURE SWITCHES ARE*
*  /** THEN TURNED OFF,POINTER ADVANCED TO COLUMN PAST QUOTE  AND  A  *
*  /** BRANCH TAKEN TO CONTINUE PROCESSING.                           *
*  /**                                                                *
*  /*******************************************************************
*  F4H1:;
*               R6 = R8 - R9             /*OBTAIN LGTH TO MOVE*/;
F4H1     LCR   @6,@9                                              0574
         AR    @6,@8                                              0574
*               R6 = R6 - 1    /**TO CORRECT THE LENGTH**/;
         BCTR  @6,0                                               0575
*                                        /*MOVE REMAINING CHARACTERS*/
*          GEN ( EX R6,F4G5);
          EX R6,F4G5
         DS    0H
*               FDPSW  = OFF   /**TURN OFF PICTURE SWITCH**/;
         MVC   549(1,@5),OFF                                      0577
*  /** IF HOWEVER LAST CHARACTER OF PICTURE WAS IN COLUMN 71 WE MUST  *
*  /** EXPECT QUOTE IN COLUMN 4 OF NEXT CARD**/
*         IF R8 > COUNTER THEN DO; /**IS R8 PAST COLUMN 71**/
         C     @8,232(0,@5)                                       0578
         BC    12,@9DE                                            0578
*               LREMAIN = 0;   /** SET LENGTH REMAINING TO ZERO**/
         SR    @F,@F                                              0580
         ST    @F,612(0,@5)                                       0580
*               FDPCSW = ON;   /**TURN ON PICT CONT SWITCH**/
         MVC   538(1,@5),ON                                       0581
*               RETURN;        /** BRANCH TO RETURN TO BASE**/
         BC    15,@EL01                                           0582
*         END;
*               FDPCSW = OFF   /**TURN OFF PICTURE SWITCH**/;
@9DE     MVC   538(1,@5),OFF                                      0584
*               R9 = R8 + 1    /*POINTER TO COLUMN PAST QUOTE*/;
         LA    @9,1                                               0585
         AR    @9,@8                                              0585
*               GO TO F2A1     /*BRANCH TO CONTINUE PROCESSING*/;
         BC    15,F2A1                                            0586
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION STARTS THE PROCESSING OF THE FD TABLE AFTER    *
*  /** ALL PARAMETERS HAVE BEEN SCANNED FROM THE CARD. LENGTH AND NAME*
*  /** MUST BE PRESENT. IF EITHER ONE IS MISSING, A MESSAGE IS        *
*  /** INDICATED AND  A BRANCH TAKEN TO EXIT THE ROUTINE. A LINK      *
*  /** MACRO IS THEN ISSUED FOR IEBFDTBL TO COMPLETE THE PROCESSING   *
*  /** REQUIRED. UPON RETURN FROM THE TABLE PROCESSING ROUTINE,       *
*  /** CONTROL IS PASSED TO THE BASE MODULE.                          *
*  /**                                                                *
*  /*******************************************************************
*  F5D2:;
*         IF FDLGTH = '0000'X THEN DO /*IF NO LGTH DO FOLLOWING*/;
F5D2     L     @F,@X39                                            0588
         L     @1,596(0,@5)        
         CH    @F,24(0,@1)                                        0588
         BC    07,@9DD                                            0588
*  F5D3:        MS = 15                  /* SET MESSAGE */;
F5D3     LA    @F,15                                              0590
         STH   @F,406(0,@5)                                       0590
*               GO TO F1B4               /* BRANCH TO EXIT*/;
         BC    15,F1B4                                            0591
*         END;
*  F5E2:;
@9DD     EQU   *                                                  0593
*                                        /*BRANCH IF NAME IS MISSING*/
*         IF FDNAME = '0000000000000000'X THEN GO TO F5D3 ;
F5E2     L     @1,596(0,@5)        
         CLC   0(8,@1),@X40                                       0594
         BC    08,F5D3                                            0595
*  /** THIS SECTION WILL TEST FOR THE INPUT DDNAME BEING PRESENT      *
*  /** WHICH WILL INDICATE FIELD SELECTION IS TO BE PERFORMAD.        *
*  /** THE DDNAME WAS PLACED AT FDREPNM IN THE TABLE.IF PRESENT THE   *
*  /** DCBPTR SHOULD STILL BE POINTING AT THE PROPER INPUT DCB.       *
*  /** ACTION WILL BE MADE FIXED.IF RECFM IS 'V', FOUR IS ADDED TO THE*
*  /** FROM LOCATION.FROM LOCATION IS ACCESSED AT ITS TEMPORARY       *
*  /** LOCATION FDMLGTH AND PLACED IN FDFROMAD                        *
*  F5F1:;
*   IF FDREPNM(1) ^= '00'X THEN DO ;
F5F1     L     @1,596(0,@5)        
         CLI   8(@1),X'00'                                        0597
         BC    08,@9DC                                            0597
*               FXACTION = '1'B /** TURN ON FIXED ACTION SW **/;
         OI    32(@1),B'00100000'                                 0599
*    FDFROMAD = FDMLGTH + FDFROMAD /* ADD FROMLOC TO INPUT REC A35464*/
         L     @F,44(0,@1)                                        0600
         LH    @0,48(0,@1)                                        0600
         ALR   @F,@0                                              0600
         ST    @F,44(0,@1)                                        0600
*         IF FDREPNM(1:5) = 'SYSIN' THEN DO /**DO BELOW IF SYSIN**/;
         CLC   8(5,@1),@C36                                       0601
         BC    07,@9DB                                            0601
*         FDFROMAD = FDMLGTH + ADDR(INBUFA) /** INITILIZE FROM ADDRESS
*                                              FOR SYSIN ONLY**/;
         LA    @F,418(0,@5)                                       0603
         AH    @F,48(0,@1)                                        0603
         ST    @F,44(0,@1)                                        0603
*         IF FDLGTH + FDMLGTH > 80 THEN DO /**IS FIELD IN RECORD**/;
         LH    @F,48(0,@1)                                        0604
         AH    @F,24(0,@1)                                        0604
         CH    @F,@D13                                            0604
         BC    12,@9DA                                            0604
*  F5F3:;
*               MS = 16        /** NO-INDICATE MESSAGE 16 **/;
F5F3     LA    @F,16                                              0607
         STH   @F,406(0,@5)                                       0607
*               GO TO F1B411   /** BRANCH TO EXIT THIS ROUTINE**/;
         BC    15,F1B411                                          0608
*         END;
*               GO TO F5F4     /** BRANCH AROUND NEXT TEST**/;
*         END;
*         INPUTSW = OFF;
@9DB     MVC   789(1,@5),OFF                                      0612
*         GO TO F3H3;
         BC    15,F3H3                                            0613
* F5F31:
*         IF FDLGTH + FDMLGTH > GMLGTH THEN GO TO F5F3 /**IS FIELD IN
F5F31    L     @1,596(0,@5)        
         LH    @F,48(0,@1)                                        0614
         AH    @F,24(0,@1)                                        0614
         L     @2,300(0,@5)        
         CH    @F,276(0,@2)                                       0614
*                                                         RECORD     **
         BC    02,F5F3                                            0615
*  F5F4:;
*         IF RECFM(1) = '1'B THEN GO TO F5F6 /**BR ITS NOT 'V' FMT**/;
F5F4     L     @1,300(0,@5)        
         TM    36(@1),B'10000000'                                 0617
         BC    01,F5F6                                            0618
*         IF RECFM(2) ^= '1'B THEN GO TO F5F6 /**BR ITS NOT 'V' FMT**/;
         TM    36(@1),B'01000000'                                 0619
         BC    12,F5F6                                            0620
*         FDFROMAD = FDFROMAD + 4 /** ADJUST FR ADDRESS FOR 'V'**/;
         LA    @F,4                                               0621
         L     @2,596(0,@5)        
         AL    @F,44(0,@2)                                        0621
         ST    @F,44(0,@2)                                        0621
*  F5F6:;
*               FDMLGTH = FDLGTH  /** INIT MLGTH FOR CREATE**/;
F5F6     L     @1,596(0,@5)        
         MVC   48(2,@1),24(@1)                                    0623
*        SWITCH(1:14) = SWITCH(1:14) && SWITCH(1:14); /* SW OFF A48971*
         XC    536(14,@5),536(@5)                                 0624
*         RETURN;
         BC    15,@EL01                                           0625
*         END;
*               FDMLGTH = FDLGTH /**INIT MOVE LENGTH FOR CREATE**/;
@9DC     L     @1,596(0,@5)        
         MVC   48(2,@1),24(@1)                                    0627
*         GEN ( LINK EP=IEBFDTBL);
          LINK EP=IEBFDTBL
         DS    0H
*               RETURN;
*  SCANOUT: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);
@EL01    L     @D,4(0,@D)                                         0630
         LR    @1,@C                                              0630
         L     @0,@SIZ001                                         0630
         FREEMAIN R,LV=(0),A=(1)                                  0630
         L     @E,12(0,@D)                                        0630
         LM    @0,@8,20(@D)                                       0630
         LM    @A,@C,60(@D)                                       0630
         BCR   15,@E                                              0630
SCANOUT  EQU   *                                                  0630
*                              /***************************************
*                              /** THIS PROCEDURE WILL FIND THE LGTH **
*                              /** OF THE PARAMETER FOLLOWING THE    **
*                              /** EQUAL SIGN.UPON ENTRY REG 9 SHOULD**
*                              /** BE POINTING AT START OF PARAMETER **
*                              /** UPON EXIT REGISTERS ARE AS FOLLOWS**
*                              /**                                   **
*                              /** REG  7  EQUALS LENGTH OF PARA     **
*                              /** REG  8  COMMA OR BLANK AFTER PARA **
*                              /** REG  9  START OF PARAMETER        **
*                              /**                                   **
*                              /***************************************
*               R8 = R9                  /*COPY SCAN POINTER */;
         LR    @8,@9                                              0631
*       IF R8 -> INBUF(1) = ' ' THEN
         CLI   0(@8),C' '                                         0632
*         GO TO MESS3;
         BC    08,MESS3                                           0633
*  SCANOUT1:;
*         R8 = R8 + 1                    /*INC PTR BY ONE*/;
SCANOUT1 AH    @8,@D3                                             0635
*       IF R8 -> INBUF(1) = ' ' THEN GO TO SCANOUT2 /*BR IF BLANK*/;
         CLI   0(@8),C' '                                         0636
         BC    08,SCANOUT2                                        0637
*  /*                                                        */
* /* CHECK IF PAST COL 72                                      A38710 *
*        IF R8 > COUNTER +1 THEN  /*                           A38710 *
         LA    @F,1                                               0638
         A     @F,232(0,@5)                                       0638
         CR    @F,@8                                              0638
*         GO TO MESS21;
         BC    04,MESS21                                          0639
*       IF R8 -> INBUF(1) = ',' THEN GO TO SCANOUT2 /*BR IF COMMA*/;
         CLI   0(@8),C','                                         0640
         BC    08,SCANOUT2                                        0641
*         GO TO SCANOUT1;
         BC    15,SCANOUT1                                        0642
* MESS21:
*               MS  =  21                       /** INDICATE MESSAGE **
MESS21   LA    @F,21                                              0643
         STH   @F,406(0,@5)                                       0643
*               GO TO F1B4                /** BRANCH TO EXIT ROUTINE **
         BC    15,F1B4                                            0644
*  /*                                                        */
*  SCANOUT2:;
*               /* R8 SHOULD BE POINTING AT BLANK OR COMMA*/
*               R7 = R8 - R9           /** CALCULATE PARAMETER LENGTH**
SCANOUT2 LCR   @7,@9                                              0646
         AR    @7,@8                                              0646
*         IF R7 = 0 THEN DO    /**BR WHEN LENGTH IS NOT EQUAL TO ZERO**
         LTR   @7,@7                                              0647
         BC    07,@9D9                                            0647
*   MESS3:
*               MS = 3         /** INDICATE MESSAGE**/;
MESS3    LA    @F,3                                               0649
         STH   @F,406(0,@5)                                       0649
*               GO TO F1B4               /*BRANCH TO EXIT IEBFDANL*/;
         BC    15,F1B4                                            0650
*         END;
*                              /** LGTH GT EIGHT- NAME IS TOO LONG   **
*         IF R7 > 8 THEN DO    /** BR IF LENGTH LT,EQ TO 8           **
@9D9     CH    @7,@D8                                             0652
         BC    12,@9D8                                            0652
*               MS = 12        /** INDICATE MESSAGE NUMBER 12 **/;
         LA    @F,12                                              0654
         STH   @F,406(0,@5)                                       0654
*               GO TO F1B4               /** BRANCH TO EXIT ROUTINE  **
         BC    15,F1B4                                            0655
*         END;
*               RETURN    /* RETURN TO CALLER WITH REGISTERS SET*/;
*  END SCANOUT;
@EL02    BCR   15,@E                                              0658
*  /*                                    */
*  /*******************************************************************
*  /**                                                                *
*  /** THIS PROCEDURE WILL CONVERT AN EBCDIC NUMBER FROM THE INPUT    *
*  /** WORKAREA TO BINARY.THE NUMBER IS TESTED BEFORE CONVERSION FOR  *
*  /** 2147483647.THE LARGEST BINARY NUMBER A REGISTER CAN CONTAIN IS *
*  /** THIS NUMBER.THIS NUMBER MUST BE VALIDITY CHECKED BEFORE ENTRY  *
*  /** TO THIS ROUTINE OR THE CVB INSTRUCTION MAY FAIL.               *
*  /** UPON ENTRY REG 9 POINTS AT START OF EBCDIC NUMBER IN INBUF     *
*  /** UPON ENTRY REG 7 CONTAINS LENGTH OF NUMBER                     *
*  /** UPON EXIT REG9 AND REG7 ARE NOT CHANGED                        *
*  /** REG 6 CONTAINS THE BINARY EQUIVALENT OF NUMBER                 *
*  /** IF RANGESW IS NOT ON THE NUMBER IS TESTED FOR BEING LARGER THAN*
*  /** 32767 THE MAXIMUM VALUE ALLOWED FOR LRECL.                     *
*  /**                                                                *
*  /*******************************************************************
*  CONVB: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);
*                                   /*SAVE REG 14 IN COMMON AREA. */
*            SAVE14 = R14;
CONVB    ST    @E,360(0,@5)                                       0660
*               R6 = R7 - 1    /**CORRECT THE VALUE IN THE REGISTER**/;
         LH    @6,@D14                                            0661
         AR    @6,@7                                              0661
*                              /**PACK THE NUMBER IN Q AREA **/
*         GEN ( EX R6,CONVBP);
          EX R6,CONVBP
         DS    0H
*                              /**TEST FOR NUMBER BEING LARGER THEN**/
*                              /**2147483647 AND BRANCH IF NOT SO **/
*         IF Q(1:8) > '000002147483647F'X THEN DO /*BR IF NUMBER OK*/;
         CLC   216(8,@5),@X41                                     0663
*               GO TO CONVB1             /*BRANCH TO SET MSG*/;
         BC    03,CONVB1                                          0665
*         END;
*           GEN ( CVB R6,Q(0,R5));
@9D7     EQU   *                                                  0667
          CVB R6,Q(0,R5)
         DS    0H
*         IF R6 = 0 THEN GO TO F2H6 /** IF ZERO BR TO ISSUE MSG**/;
         LTR   @6,@6                                              0668
         BC    08,F2H6                                            0669
*         IF RANGESW = ON THEN DO /** IF RANGESW ON DO BELOW**/;
         CLC   541(1,@5),ON                                       0670
         BC    07,@9D6                                            0670
*               RANGESW = OFF  /**TURN OFF RANGE SW**/;
         MVC   541(1,@5),OFF                                      0672
*               RETURN;
         BC    15,@EL03                                           0673
*         END;
*         IF R6 <= 32767 THEN DO     /** BRANCH IF LARGER THAN 32767**/
@9D6     CH    @6,@D15                                            0675
         BC    02,@9D5                                            0675
*                                   /*RESTORE REG 14 FROM COMMON AREA.
*            R14 = SAVE14;
         L     @E,360(0,@5)                                       0677
*               RETURN                   /*RETURN TO CALLER*/;
         BC    15,@EL03                                           0678
*         END;
*  CONVB1:;
@9D5     EQU   *                                                  0680
*               MS = 6                   /*INDICATE MSG*/;
CONVB1   LA    @F,6                                               0681
         STH   @F,406(0,@5)                                       0681
*               GO TO F1B411   /**BRANCH TO EXIT **/;
         BC    15,F1B411                                          0682
*  CONVBP: GEN ( PACK Q(8,R5),0(1,R9));
CONVBP    PACK Q(8,R5),0(1,R9)
         DS    0H
*  END CONVB;
@EL03    BCR   15,@E                                              0684
*  /*******************************************************************
*  /**                                                                *
*  /** THIS PROCEDURE WILL MOVE ANY NUMBER OF CHARACTERS FOR THE      *
*  /** CALLER.EXPECTED CONTENTS OF REGISTERS UPON ENTRY ARE:          *
*  /** REG 9 = FROM ADDRESS                                           *
*  /** REG 8 = TO ADDRESS                                             *
*  /** REG 7 = LENGTH TO MOVE                                         *
*  /** REGISTER CONTENTS ARE DESTROYED UPON EXIT IF MOVE IS GT 256    *
*  /**                                                                *
*  /*******************************************************************
*  MOVEROUT: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);
MOVEROUT EQU   *                                                  0685
*  MOVE1:;
*         IF R7 = 0 THEN RETURN          /** RETURN IF ZERO LENGTH   **
MOVE1    LTR   @7,@7                                              0687
         BC    08,@EL04                                           0688
*         IF R7 < 256 THEN GO TO MOVE5   /** BR IF LT 256 TO MOVE    **
@9D4     CH    @7,@D16                                            0689
         BC    04,MOVE5                                           0690
*                                        /*MOVES 256 BYTES*/
*         GEN (MVC 0(256,R8),0(R9));
         MVC 0(256,R8),0(R9)
         DS    0H
*               R9 = R9 + 256            /*ADD 256 TO POSITION ADDR*/;
         AH    @9,@D16                                            0692
*               R8 = R8 + 256            /*ADD 256 TO POSITION ADDR*/;
         AH    @8,@D16                                            0693
*               R7 = R7 - 256            /*SUBT 256 TO CORRECT LENGTH*/
         SH    @7,@D16                                            0694
*          GO TO MOVE1                   /*BR TO CONTINUE PROCESSING*/;
         BC    15,MOVE1                                           0695
*  MOVE4 :;
*                                        /*MOVE REMAINING BYTES*/
*         GEN ( MVC 0(1,R8),0(R9));
MOVE4     MVC 0(1,R8),0(R9)
         DS    0H
*  MOVE5:;
*               R7 = R7 - 1              /*CORRECT THE LENGTH*/;
MOVE5    BCTR  @7,0                                               0699
*         GEN ( EX R7,MOVE4);
          EX R7,MOVE4
         DS    0H
*               R7 = R7 + 1 /**RESTORE REG 7 FOR EXIT WHEN LT 256 **/;
         AH    @7,@D3                                             0701
*               RETURN                   /*RETURN TO CALLER */;
*  END MOVEROUT;
@EL04    BCR   15,@E                                              0703
*  /*******************************************************************
*  /**                                                                *
*  /** THIS PROCEDURE WILL VALIDITY CHECK AN EBCDIC NUMBER AS IT IS   *
*  /** INPUT FROM THE CONTROL CARD.UPON ENTRY REG 9 SHOULD POINT AT   *
*  /** START OF NUMBER IN INBUF.REG 7 SHOULD CONTAIN LENGTH OF NUMBER**
*  /** A WORKAREA IS CLEARED TO BINARY ZERO AND ZONES FROM THE NUMBER *
*  /** ARE MOVED TO THE WORKAREA.A COMPARE IS THEN DONE AGAINST       *
*  /** FOXZEROEZ.IF ALL DIGITS DO NOT COMPARE THE NUMBER IS INVALID   *
*  /** AND A BRANCH IS TAKEN TO SET UP MESSAGE AND RETURN,OTHERWISE   *
*  /** RETURN IS TO THE CALLER.                                       *
*  /**                                                                *
*  /*******************************************************************
*  VALCHECK: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);
*                                   /*SAVE REG 14 IN COMMON AREA. */
*            SAVE14 = R14;
VALCHECK ST    @E,360(0,@5)                                       0705
*               Q  =  Q && Q             /*CLEAR Q TO ZEROS */;
         XC    216(16,@5),216(@5)                                 0706
*                              /* MOVE ZONES FROM NUMBER TO Q */
*         GEN ( EX R7,MOVEZONE);
          EX R7,MOVEZONE
         DS    0H
*  /**COMPARE FOXZEROS TO Q LOOKING FOR EQ.BR IF NO EQ COMPARE  **/
*         IF Q (1:R7) ^= FOXZEROS(1:R7) THEN DO /*BRANCH OUT IF VALID**
         LA    @E,FOXZEROS                                        0708
         LR    @1,@7                                              0708
         BCTR  @1,0                                               0708
         LA    @A,216(0,@5)                                       0708
         EX    @1,@CLC                                            0708
         BC    08,@9D3                                            0708
*               MS = 3         /**INDICATE MESSAGE **/;
         LA    @F,3                                               0710
         STH   @F,406(0,@5)                                       0710
*               GO TO F1B4     /**BRANCH TO LEAVE ROUTINE**/;
         BC    15,F1B4                                            0711
*         END;
*                                   /*RESTORE REG 14 FROM COMMON AREA.
*            R14 = SAVE14;
@9D3     L     @E,360(0,@5)                                       0713
*                              /* RETURN TO CALLER*/
*               RETURN;
         BC    15,@EL05                                           0714
*  MOVEZONE:;
*               /** MOVE ZONES TO Q FOR COMPARE **/
*         GEN ( MVZ Q(1,R5),0(R9));
MOVEZONE  MVZ Q(1,R5),0(R9)
         DS    0H
*    END VALCHECK;
@EL05    BCR   15,@E                                              0717
*  END IEBFDANL;
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D1      DC    H'2'
@D2      DC    H'-64'
@D3      DC    H'1'
@D4      DC    H'5'
@D5      DC    H'64'
@D6      DC    H'7'
@D7      DC    H'9'
@D8      DC    H'8'
@D9      DC    H'3'
@D10     DC    H'4'
@D11     DC    H'6'
@D12     DC    H'10'
@D13     DC    H'80'
@D14     DC    H'-1'
@D15     DC    H'32767'
@D16     DC    H'256'
@CLC     CLC   0(1,@A),0(@E)
@MVC     MVC   0(1,@A),0(@E)
         DS    0F
@SIZ001  DC    AL1(&SPN)
         DC    AL3(@DATEND-@DATD)
         DS    0F
@C2      DC    C'BADFIELD'
@C8      DC    C'FROMLOC='
@C11     DC    C'PICTURE='
@C20     DC    C'REPLACE='
@X39     DC    X'00000000'
@X40     DC    X'0000000000000000'
@X41     DC    X'000002147483647F'
@C7      DC    C'INPUT='
@C15     DC    C'CYCLE='
@C16     DC    C'RANGE='
@C17     DC    C'CHARACTER='
@C19     DC    C'INDEX='
@C21     DC    C'AN'
@C22     DC    C'AL'
@C23     DC    C'ZD'
@C24     DC    C'PD'
@C25     DC    C'CO'
@C26     DC    C'BI'
@C37     DC    C'B'''
@C38     DC    C'P'''
@C6      DC    C'NAME='
@C9      DC    C'LENGTH='
@C10     DC    C'STARTLOC='
@C12     DC    C'FORMAT='
@C13     DC    C'ACTION='
@C14     DC    C'FILL='
@C18     DC    C'SIGN='
@C36     DC    C'SYSIN'
         DS    0D
@DATA    EQU   *
R14      EQU   00000014            FULLWORD INTEGER REGISTER
R15      EQU   00000015            FULLWORD INTEGER REGISTER
R0       EQU   00000000            FULLWORD INTEGER REGISTER
R4       EQU   00000004            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD INTEGER REGISTER
R1       EQU   00000001            FULLWORD INTEGER REGISTER
R2       EQU   00000002            FULLWORD INTEGER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
R6       EQU   00000006            FULLWORD POINTER REGISTER
R7       EQU   00000007            FULLWORD POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
R9       EQU   00000009            FULLWORD POINTER REGISTER
COMMON   EQU   00000000            308 BYTE(S) ON DWORD
PAGENO   EQU   COMMON+00000000     4 BYTE(S)
LINECT   EQU   COMMON+00000004     FULLWORD INTEGER
LINECTR  EQU   COMMON+00000008     FULLWORD INTEGER
PARM     EQU   COMMON+00000012     FULLWORD POINTER
REPEATNO EQU   COMMON+00000016     HALFWORD INTEGER
CREATENO EQU   COMMON+00000018     HALFWORD INTEGER
SYSP     EQU   COMMON+00000020     96 BYTE(S)
SYSI     EQU   COMMON+00000116     96 BYTE(S)
Q        EQU   COMMON+00000216     16 BYTE(S) ON DWORD
QFILL    EQU   COMMON+00000216     7 BYTE(S)
QSIGN    EQU   COMMON+00000223     8 BIT(S)
QFILL1   EQU   COMMON+00000224     7 BYTE(S)
QSIGN1   EQU   COMMON+00000231     8 BIT(S)
COUNTER  EQU   COMMON+00000232     FULLWORD POINTER
OPENLIST EQU   COMMON+00000236     8 BYTE(S)
OPTBYTE1 EQU   COMMON+00000236     4 BYTE(S)
OPTBYTE2 EQU   COMMON+00000240     4 BYTE(S)
EXLST    EQU   COMMON+00000244     24 BYTE(S) ON WORD
INHDR    EQU   COMMON+00000244     1 BYTE(S)
INHDR1   EQU   COMMON+00000245     3  BYTE  POINTER ON WORD+1
OUTHDR   EQU   COMMON+00000248     1 BYTE(S)
OUTHDR1  EQU   COMMON+00000249     3  BYTE  POINTER ON WORD+1
INTRL    EQU   COMMON+00000252     1 BYTE(S)
INTRL1   EQU   COMMON+00000253     3  BYTE  POINTER ON WORD+1
OUTTRL   EQU   COMMON+00000256     1 BYTE(S)
OUTTRL1  EQU   COMMON+00000257     3  BYTE  POINTER ON WORD+1
EXITDCB  EQU   COMMON+00000260     1 BYTE(S)
EXITDCB1 EQU   COMMON+00000261     3  BYTE  POINTER ON WORD+1
TOTAL    EQU   COMMON+00000264     1 BYTE(S)
TOTAL1   EQU   COMMON+00000265     3  BYTE  POINTER ON WORD+1
EXLST1   EQU   COMMON+00000268     4 BYTE(S) ON WORD
EDCB1    EQU   COMMON+00000268     1 BYTE(S)
EDCB2    EQU   COMMON+00000269     3  BYTE  POINTER ON WORD+1
EXLST2   EQU   COMMON+00000272     4 BYTE(S) ON WORD
EDCB3    EQU   COMMON+00000272     1 BYTE(S)
EDCB4    EQU   COMMON+00000273     3  BYTE  POINTER ON WORD+1
EXLST3   EQU   COMMON+00000276     4 BYTE(S) ON WORD
EDCB5    EQU   COMMON+00000276     1 BYTE(S)
EDCB6    EQU   COMMON+00000277     3  BYTE  POINTER ON WORD+1
DLRECL   EQU   COMMON+00000280     HALFWORD INTEGER
DBLKSI   EQU   COMMON+00000282     HALFWORD INTEGER
DRECFM   EQU   COMMON+00000284     8 BIT(S)
LEFTOVER EQU   COMMON+00000288     FULLWORD INTEGER
OFFSET   EQU   COMMON+00000292     FULLWORD POINTER
LPTR     EQU   COMMON+00000296     FULLWORD POINTER
DCBPTR   EQU   COMMON+00000300     FULLWORD POINTER
DUMMY    EQU   COMMON+00000304     FULLWORD POINTER
COMMON1  EQU   00000304            236 BYTE(S) ON WORD
SAVEMS   EQU   COMMON1+00000000    HALFWORD INTEGER
CONCODE  EQU   COMMON1+00000002    HALFWORD INTEGER
OUTREC   EQU   COMMON1+00000004    FULLWORD POINTER
CRTABPT  EQU   COMMON1+00000008    FULLWORD POINTER
CURCRTE  EQU   COMMON1+00000012    FULLWORD POINTER
CURCRGM  EQU   COMMON1+00000016    FULLWORD POINTER
CURPIC   EQU   COMMON1+00000020    FULLWORD POINTER
PICCTR   EQU   COMMON1+00000024    FULLWORD INTEGER
EXITTAB  EQU   COMMON1+00000028    FULLWORD POINTER
EXITGM   EQU   COMMON1+00000032    FULLWORD POINTER
CUREXIT  EQU   COMMON1+00000036    FULLWORD POINTER
DELIM    EQU   COMMON1+00000040    4 BYTE(S)
RECREM   EQU   COMMON1+00000044    FULLWORD INTEGER
CURFD    EQU   COMMON1+00000048    FULLWORD POINTER
CUROUT   EQU   COMMON1+00000052    FULLWORD POINTER
SAVE14   EQU   COMMON1+00000056    FULLWORD POINTER
GETMLIST EQU   COMMON1+00000060    16 BYTE(S) ON WORD
GLENGTH  EQU   COMMON1+00000060    FULLWORD INTEGER
ADRLIST  EQU   COMMON1+00000064    FULLWORD POINTER
IND      EQU   COMMON1+00000068    4 BYTE(S)
GCODE    EQU   COMMON1+00000068    1 BYTE(S)
SPOOL    EQU   COMMON1+00000069    1 BYTE(S)
CCODE    EQU   COMMON1+00000070    2 BYTE(S)
GCADDR   EQU   COMMON1+00000072    FULLWORD POINTER
FIRSTGMO EQU   COMMON1+00000076    FULLWORD POINTER
CURRGMO  EQU   COMMON1+00000080    FULLWORD POINTER
LASTGMO  EQU   COMMON1+00000084    FULLWORD POINTER
FIRSTGMI EQU   COMMON1+00000088    FULLWORD POINTER
CURRGMI  EQU   COMMON1+00000092    FULLWORD POINTER
LASTGMI  EQU   COMMON1+00000096    FULLWORD POINTER
CONDCODE EQU   COMMON1+00000100    HALFWORD INTEGER
MS       EQU   COMMON1+00000102    HALFWORD INTEGER
INBUFA1  EQU   COMMON1+00000104    121 BYTE(S)
INFILL   EQU   COMMON1+00000104    10 BYTE(S)
INBUFA   EQU   COMMON1+00000114    111 BYTE(S)
DDPTR    EQU   COMMON1+00000228    FULLWORD POINTER
DUMMY1   EQU   COMMON1+00000232    FULLWORD POINTER
COMMON2  EQU   00000536            76 BYTE(S) ON WORD
SWITCH   EQU   COMMON2+00000000    52 BYTE(S)
FDCSW    EQU   COMMON2+00000000    1 BYTE(S)
FDNAMESW EQU   COMMON2+00000001    1 BYTE(S)
FDPCSW   EQU   COMMON2+00000002    1 BYTE(S)
FDFMTSW  EQU   COMMON2+00000003    1 BYTE(S)
FDPLSW   EQU   COMMON2+00000004    1 BYTE(S)
RANGESW  EQU   COMMON2+00000005    1 BYTE(S)
FILLSW   EQU   COMMON2+00000006    1 BYTE(S)
REPSW    EQU   COMMON2+00000007    1 BYTE(S)
INDEXSW  EQU   COMMON2+00000008    1 BYTE(S)
INDNMSW  EQU   COMMON2+00000009    1 BYTE(S)
BQUOTESW EQU   COMMON2+00000010    1 BYTE(S)
PQUOTESW EQU   COMMON2+00000011    1 BYTE(S)
EQUOTESW EQU   COMMON2+00000012    1 BYTE(S)
FDPSW    EQU   COMMON2+00000013    1 BYTE(S)
DSDSW    EQU   COMMON2+00000014    1 BYTE(S)
NOGOSW   EQU   COMMON2+00000015    1 BYTE(S)
CREATESW EQU   COMMON2+00000016    1 BYTE(S)
DSDCSW   EQU   COMMON2+00000017    1 BYTE(S)
CRCSW    EQU   COMMON2+00000018    1 BYTE(S)
EXITSW   EQU   COMMON2+00000019    1 BYTE(S)
EODSTOP  EQU   COMMON2+00000020    1 BYTE(S)
DSDNULSW EQU   COMMON2+00000021    1 BYTE(S)
DSDORGSW EQU   COMMON2+00000022    1 BYTE(S)
DSDDDSW  EQU   COMMON2+00000023    1 BYTE(S)
CRTBLK   EQU   COMMON2+00000024    1 BYTE(S)
NAMCSW   EQU   COMMON2+00000025    8 BIT(S)
PICCSW   EQU   COMMON2+00000026    8 BIT(S)
BUFPSW   EQU   COMMON2+00000027    1 BYTE(S)
ENDSW    EQU   COMMON2+00000028    1 BYTE(S)
COMCSW   EQU   COMMON2+00000029    1 BYTE(S)
FLAGSW   EQU   COMMON2+00000030    8 BIT(S)
PAGESW   EQU   COMMON2+00000031    1 BYTE(S)
EPSW     EQU   COMMON2+00000032    1  BYTE  POINTER
SYSISW   EQU   COMMON2+00000033    1 BYTE(S)
SYSPSW   EQU   COMMON2+00000034    1 BYTE(S)
OLDNEWSW EQU   COMMON2+00000035    1 BYTE(S)
FLUSHSW  EQU   COMMON2+00000036    1 BYTE(S)
FLUSHSW1 EQU   COMMON2+00000037    1 BYTE(S)
DSDOSW   EQU   COMMON2+00000038    1 BYTE(S)
DSDISW   EQU   COMMON2+00000039    1 BYTE(S)
QUANSW   EQU   COMMON2+00000040    1 BYTE(S)
PARENSW  EQU   COMMON2+00000041    1 BYTE(S)
REPEATSW EQU   COMMON2+00000042    1 BYTE(S)
FDPLGTH  EQU   COMMON2+00000052    HALFWORD INTEGER
SGCADDR  EQU   COMMON2+00000056    FULLWORD POINTER
FDPTR    EQU   COMMON2+00000060    FULLWORD POINTER
FDPTR1   EQU   COMMON2+00000064    FULLWORD POINTER
FDPTR2   EQU   COMMON2+00000068    FULLWORD POINTER
DUMMY2   EQU   COMMON2+00000072    FULLWORD POINTER
COMMON3  EQU   00000608            196 BYTE(S) ON WORD
FDCTR    EQU   COMMON3+00000000    HALFWORD POINTER
LREMAIN  EQU   COMMON3+00000004    FULLWORD POINTER
COMPCTR  EQU   COMMON3+00000008    FULLWORD POINTER
LMOVED   EQU   COMMON3+00000012    HALFWORD POINTER
U        EQU   COMMON3+00000016    FULLWORD POINTER
PICEND   EQU   COMMON3+00000020    HALFWORD POINTER
CURFDGM  EQU   COMMON3+00000024    FULLWORD POINTER
SWTCH    EQU   COMMON3+00000028    4 BYTE(S) ON WORD
SYSINSEL EQU   COMMON3+00000028    1 BYTE(S)
FIRSTSW  EQU   COMMON3+00000029    1 BYTE(S)
FRSTSW   EQU   COMMON3+00000030    1 BYTE(S)
STOPSW   EQU   COMMON3+00000031    1 BYTE(S)
COPYVAL  EQU   COMMON3+00000032    HALFWORD INTEGER
COPYFD   EQU   COMMON3+00000036    FULLWORD POINTER
COPYFDGM EQU   COMMON3+00000040    FULLWORD POINTER
NAMCTR   EQU   COMMON3+00000044    HALFWORD INTEGER
NAMCTR1  EQU   COMMON3+00000046    HALFWORD INTEGER
INRECSZ  EQU   COMMON3+00000048    HALFWORD POINTER
OUTRECSZ EQU   COMMON3+00000050    HALFWORD POINTER
INRECFM  EQU   COMMON3+00000052    1 BYTE(S)
RECOFFST EQU   COMMON3+00000053    1  BYTE  POINTER
OUTRECFM EQU   COMMON3+00000054    1 BYTE(S)
PICBASE  EQU   COMMON3+00000056    FULLWORD POINTER
MESSAGE  EQU   COMMON3+00000060    121 BYTE(S)
INPUTSW  EQU   COMMON3+00000181    1 BYTE(S)
HOLDNAME EQU   COMMON3+00000182    8 BYTE(S)
DUMMY3   EQU   COMMON3+00000192    FULLWORD POINTER
DCBD     EQU   00000000            280 BYTE(S) ON DWORD
FILL     EQU   DCBD+00000000       26 BYTE(S)
DSORG1   EQU   DCBD+00000026       2 BYTE(S)
DSORG    EQU   DCBD+00000026       8 BIT(S)
FILLER   EQU   DCBD+00000028       8 BYTE(S)
IOBAD    EQU   DCBD+00000028       4 BYTE(S)
BFTEK    EQU   DCBD+00000032       8 BIT(S)
EODAD    EQU   DCBD+00000033       3 BYTE(S)
RECFM    EQU   DCBD+00000036       8 BIT(S)
EXLIST   EQU   DCBD+00000037       3  BYTE  POINTER ON WORD+1
DDNAME   EQU   DCBD+00000040       8 BYTE(S)
DEBAD    EQU   DCBD+00000040       4 BYTE(S)
IFLGS    EQU   DCBD+00000040       8 BIT(S)
GETAD    EQU   DCBD+00000048       4 BYTE(S)
OFLGS    EQU   DCBD+00000048       8 BIT(S)
OFLGS1   EQU   DCBD+00000049       1 BYTE(S)
MACRF    EQU   DCBD+00000050       2 BYTE(S)
FILL2    EQU   DCBD+00000052       10 BYTE(S)
BLKSI    EQU   DCBD+00000062       HALFWORD INTEGER
FILL3    EQU   DCBD+00000064       18 BYTE(S)
LRECL    EQU   DCBD+00000082       HALFWORD INTEGER
FILL4    EQU   DCBD+00000084       172 BYTE(S)
NEXTDCB  EQU   DCBD+00000256       FULLWORD POINTER
DDNAME1  EQU   DCBD+00000260       8 BYTE(S)
EODSW    EQU   DCBD+00000268       1 BYTE(S)
DCBSW1   EQU   DCBD+00000269       1 BYTE(S)
DCBSW2   EQU   DCBD+00000270       1 BYTE(S)
DCBSW3   EQU   DCBD+00000271       8 BIT(S)
INREC    EQU   DCBD+00000272       FULLWORD POINTER
GMLGTH   EQU   DCBD+00000276       HALFWORD INTEGER
FIELDSEL EQU   DCBD+00000278       1 BYTE(S)
SPARE    EQU   DCBD+00000279       1 BYTE(S)
FDTBL    EQU   00000000            520 BYTE(S) ON WORD
FDNAME   EQU   FDTBL+00000000      8 BYTE(S)
FDREPNM  EQU   FDTBL+00000008      8 BYTE(S)
FDINDNM  EQU   FDTBL+00000016      8 BYTE(S) ON WORD
FDUMMY   EQU   FDTBL+00000016      4 BYTE(S)
FDINDNUM EQU   FDTBL+00000020      FULLWORD POINTER
FDLGTH   EQU   FDTBL+00000024      HALFWORD POINTER
FDCYCLE  EQU   FDTBL+00000026      HALFWORD POINTER
FDACTION EQU   FDTBL+00000028      2 BYTE(S)
FDFORMAT EQU   FDTBL+00000030      2 BYTE(S)
FDSWITCH EQU   FDTBL+00000032      8 BIT(S)
INDBYNAM EQU   FDTBL+00000032      1 BIT(S)
PASS     EQU   FDTBL+00000032      1 BIT(S)
FXACTION EQU   FDTBL+00000032      1 BIT(S)
RPACTION EQU   FDTBL+00000032      1 BIT(S)
ROACTION EQU   FDTBL+00000032      1 BIT(S)
WVACTION EQU   FDTBL+00000032      1 BIT(S)
STACTION EQU   FDTBL+00000032      1 BIT(S)
NUACTION EQU   FDTBL+00000032      1 BIT(S)
FDFILL   EQU   FDTBL+00000033      1 BYTE(S)
FDSIGN   EQU   FDTBL+00000034      1 BYTE(S)
FDCHAR   EQU   FDTBL+00000035      1 BYTE(S)
FDRANGE  EQU   FDTBL+00000036      4 BYTE(S)
FDOBUF   EQU   FDTBL+00000040      HALFWORD POINTER
FDFRINC  EQU   FDTBL+00000042      HALFWORD POINTER
FDFROMAD EQU   FDTBL+00000044      4 BYTE(S)
FDMLGTH  EQU   FDTBL+00000048      HALFWORD POINTER
FDTOINC  EQU   FDTBL+00000050      HALFWORD POINTER
FDCYCCNT EQU   FDTBL+00000052      HALFWORD POINTER
FDSLGTH  EQU   FDTBL+00000054      HALFWORD POINTER
FDSLGTHR EQU   FDTBL+00000056      HALFWORD POINTER
FDFRINCR EQU   FDTBL+00000058      1 BYTE(S)
FDTOINCR EQU   FDTBL+00000059      1 BYTE(S)
LTOFREE  EQU   FDTBL+00000060      HALFWORD POINTER
FDSW1    EQU   FDTBL+00000062      8 BIT(S)
STRTLOC1 EQU   FDTBL+00000062      1 BIT(S)
FOXZEROS EQU   *                   16 BYTE(S)
         DC    X'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'
INBUF    EQU   00000000            80 BYTE(S)
BUFFER   EQU   00000000            32767 BYTE(S)
ON       EQU   *                   1 BYTE(S)
         DC    X'FF'
OFF      EQU   *                   1 BYTE(S)
         DC    X'00'
WKADDR   EQU   00000000            32767 BYTE(S)
COPAT    EQU   *                   27 BYTE(S)
         DC    C' .<(+&&!$*);^-/,%_>?:#@''="'
ALPAT    EQU   *                   36 BYTE(S)
         DC    C'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'
OPTIONS  EQU   00000000            256 BYTE(S)
PAGE     EQU   00000000            256 BYTE(S)
DDLST    EQU   00000000            256 BYTE(S)
         ORG   @DATA
         DS    00000081C
@L       EQU   1
@DATD    DSECT
@SAV001  EQU   @DATD+00000000      72 BYTE(S) ON WORD
BUFPTR   EQU   @DATD+00000072      FULLWORD POINTER
RCODE    EQU   @DATD+00000076      FULLWORD INTEGER
OPTPTR   EQU   @DATD+00000080      FULLWORD POINTER
PGPTR    EQU   @DATD+00000084      FULLWORD POINTER
         DS    00000088C
@TEMPS   DS    0F
@TEMP4   DC    F'0'
@DATEND  EQU   *
IEBFDANL CSECT ,
@9E9     EQU   F5F31
@9E3     EQU   F4B5
@9DF     EQU   F4G11
@9DA     EQU   F5F4
@9D8     EQU   @EL02
         END   IEBFDANL

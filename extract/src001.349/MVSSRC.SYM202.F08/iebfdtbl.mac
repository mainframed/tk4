*    NEW MODULE, RELEASE 17.                                       DG0H
*                                                                A27778
*                                                                A29841
*A445410-445630                                                @YA02530
*C219800                                                       @ZA04231
*C219800                                                       @ZA07345
         LCLA  &T,&SPN                                            0002
.@001    ANOP                                                     0002
IEBFDTBL CSECT ,                                                  0002
         ST    @E,12(0,@D)                                        0002
         STM   @0,@8,20(@D)                                       0002
         STM   @A,@C,60(@D)                                       0002
         BALR  @B,0                                               0002
@PSTART  DS    0H                                                 0002
         USING @PSTART+00000,@B                                   0002
         LA    @3,4095(0,@B)                                      0002
         USING @PSTART+04095,@3                                   0002
         L     @0,@SIZ001                                         0002
         GETMAIN  R,LV=(0)                                        0002
         LR    @C,@1                                              0002
         USING @DATD+00000,@C                                     0002
         LM    @0,@1,20(@D)                                       0002
         XC    @TEMPS(@L),@TEMPS                                  0002
         ST    @D,@SAV001+4                                       0002
         LA    @F,@SAV001                                         0002
         ST    @F,8(0,@D)                                         0002
         LR    @D,@F                                              0002
         CLC   546(1,@5),ON                                       0044
*         IF BQUOTESW = ON THEN GO TO F5G3 /*BR IF BINARY PICTURE*/;
         BC    08,F5G3                                            0045
*         IF PQUOTESW ^= ON THEN GO TO F6A1 /*BR IF NOT PD PICTURE*/;
         CLC   547(1,@5),ON                                       0046
         BC    07,F6A1                                            0047
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION PICKS UP THE PICTURE LENGTH AND TEMPORARY      *
*  /** STORAGE ADDRESS(SGCADDR) AND VALIDITY CHECKS THE  NUMBER FOR A *
*  /** VALID DECIMAL VALUE. ACTION IS SET TO FIXED AS A NUMBER MAY    *
*  /** ONLY BE INCREMENTED(INDEXED).A BRANCH IS THEN TAKEN TO         *
*  /** PROCESS A PACKED DECIMAL NUMBER IF INDICATED. A DECIMAL NUMBER *
*  /** IS REQUIRED BETWEEN THE DELIMITING QUOTES OF THE INITIAL       *
*  /** PICTURE                                                        *
*  /**                                                                *
*  /*******************************************************************
*  F5G3:;
*               R7 = FDPLGTH             /**PICTURE LGTH FOR VALCHECK**
F5G3     LH    @7,588(0,@5)                                       0049
*                         /* VALIDITY CHECK B OR P PICTURE */
*               R9 = SGCADDR   /**PICK UP PICTURE ADDRESS**/;
         L     @9,592(0,@5)                                       0050
*               CALL VALCHECK;
         BAL   @E,VALCHECK                                        0051
*               FDACTION = 'FX' /**ACTION MUST BE FIXED**/;
         L     @1,596(0,@5)        
         MVC   28(2,@1),@C1                                       0052
*         IF PQUOTESW = ON THEN GO TO F5H4;
         CLC   547(1,@5),ON                                       0053
         BC    08,F5H4                                            0054
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION PROCESSES A BINARY PICTURE. THE RANGESW IS     *
*  /** TURNED ON SO THAT THE CONVB ROUTINE WHEN CALLED WILL ALLOW     *
*  /** THE MAXIMUM BINARY NUMBER THAT CAN BE HELD IN A REGISTER. ONCE *
*  /** CONVERTED, THE FIELD LENGTH IS PICKED UP AND A BRANCH TAKEN TO *
*  /** F6F4 TO GET CORE TO HOLD THE BINARY NUMBER.                    *
*  /**                                                                *
*  /*******************************************************************
*               RANGESW = ON             /*ALLOW MAX BINARY NUMBER*/;
         MVC   541(1,@5),ON                                       0055
*                         /* CONVERT PICTURE TO BINARY*/
*               CALL CONVB;
         BAL   @E,CONVB                                           0056
*               Q = R6         /**SAVE BINARY NO IN Q **/;
         ST    @6,@TEMP4                                          0057
         MVC   216(4,@5),@TEMP4                                   0057
         MVI   220(@5),C' '                                       0057
         MVC   221(11,@5),220(@5)                                 0057
*  /******************************************************************/
*  F5H3:;
*               R6 = FDLGTH    /**PICK UP FIELD LENGTH**/;
F5H3     L     @1,596(0,@5)        
         LH    @6,24(0,@1)                                        0059
*               GO TO F6F4     /** BR TO GET CORE**/;
         BC    15,F6F4                                            0060
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION WILL PROCESS A PACKED DECIMAL NUMBER. THE      *
*  /** MAXIMUM LENGTH WE CAN PACK IS 16 DIGITS. IF GREATER THAN 16,A  *
*  /** MESSAGE IS INDICATED AND A BRANCH IS TAKEN TO EXIT THE ROUTINE.*
*  /** OTHERWISE, THE TEMPORARY STORAGE IS PICKED UP, THE NUMBER IS   *
*  /** PACKED AND A BRANCH TAKEN TO PICK UP THE FIELD LENGTH AND GET  *
*  /** CORE AS FOR A BINARY NUMBER. BOTH PD AND BI NUMBERS WILL       *
*  /** EVENTUALLY BE MOVED INTO PERMANENT STORAGE AFTER GETTING CORE  *
*  /** TO HOLD THEM.                                                  *
*  /**                                                                *
*  /*******************************************************************
*  F5H4:;
*                         /* TEST NUMBER FOR MAX LENGTH*/
*         IF FDPLGTH =< 16 THEN GO TO F5J4 /*BR WE CAN PACK THIS NO.*/;
F5H4     LA    @F,16                                              0062
         CH    @F,588(0,@5)                                       0062
         BC    10,F5J4                                            0063
*                         /* LENGTH TOO LARGE*/
*               MS = 8                   /* SET MESSAGE INDICATION*/;
         LA    @F,8                                               0064
         STH   @F,406(0,@5)                                       0064
*               GO TO F1B411   /** BRANCH TO LEAVE ROUTINE**/;
         BC    15,F1B411                                          0065
*  F5F5:;
*         GEN ( PACK Q(16,R5),0(1,R7));
F5F5      PACK Q(16,R5),0(1,R7)
         DS    0H
*  F5J4:;
*               R7 = SGCADDR             /*PICK UP NUMBER ADDRESS*/;
F5J4     L     @7,592(0,@5)                                       0069
*               R6 = FDPLGTH - 1 /**RESOLVE LENGTH TO PACK**/;
         LH    @6,@D1                                             0070
         AH    @6,588(0,@5)                                       0070
*                                        /*  PACK NUMBER*/
*         GEN ( EX R6,F5F5);
          EX R6,F5F5
         DS    0H
*               GO TO F5H3     /** BRANCH**/;
         BC    15,F5H3                                            0072
*  /******************************************************************/
*  /**                                                                *
*  /** THIS SECTION SCANS FOR ACTION AND BRANCHES TO PROCESS.UNKNOWN  *
*  /** ACTION CAUSES A MESSAGE INDICATION.IF A USER ACTION IS EVER    *
*  /** ALLOWED IT IS PLANNED THAT THE KEYWORD WILL BE'US' WHEREUPON   *
*  /** A SPECIFIC NAME OF A ROUTINE FROM THE LINKLIB WOULD BE LOADED, *
*  /** ITS ADDRESS SAVED SO THAT IEBCREAT WHEN IT ACCESSED THE        *
*  /** PARTICULAR FD TABLE FOR PROCESSING NAME WOULD BRANCH AND LINK  *
*  /** TO THIS ROUTINE.A PARAMETER LIST WOULD CONTAIN ADDRESS OF      *
*  /** RECORD SEGMENT TO BE ACTED UPON BY USER,DCB ADDRESS AND SEGMENT*
*  /** LENGTH.PARAMETER LIST ADDRESS TO BE CONTAINED IN REGISTER ONE  *
*  /**                                                                *
*  /*******************************************************************
*  F6A1:;
*         IF FDFORMAT = 'RA' THEN GO TO F6F2 /** BR RANDOM FORMAT MUST
F6A1     L     @1,596(0,@5)        
         CLC   30(2,@1),@C2                                       0074
*                                                BE FIXED ACTION **/;
         BC    08,F6F2                                            0075
*         IF FDACTION = 'SL' THEN GO TO F6A2 /* IF SL BR TO SET INC*/;
         CLC   28(2,@1),@C3                                       0076
         BC    08,F6A2                                            0077
*         IF FDACTION = 'TL' THEN GO TO F6B2 /* IF TL BR TO SET INC*/;
         CLC   28(2,@1),@C4                                       0078
         BC    08,F6B2                                            0079
*         IF FDACTION = 'SR' THEN GO TO F6C2 /* IF SR BR TO SET INC*/;
         CLC   28(2,@1),@C5                                       0080
         BC    08,F6C2                                            0081
*         IF FDACTION = 'TR' THEN DO /**DO FOLLOWING IF TRUNC RIGHT**/;
         CLC   28(2,@1),@C6                                       0082
         BC    07,@9FF                                            0082
*               STACTION = '1'B          /**INDICATE SHIFT OR TRUNC**/;
         OI    32(@1),B'00000010'                                 0084
*               GO TO F8B4     /** BRANCH TO RESOLVE LENGTH**/;
         BC    15,F8B4                                            0085
*         END;
*         IF FDACTION = 'FX' THEN DO /**DO FOLLOWING IF FX ACTION**/;
@9FF     L     @1,596(0,@5)        
         CLC   28(2,@1),@C1                                       0087
         BC    07,@9FE                                            0087
*               FXACTION = '1'B          /**INDICATE FIXED ACTION**/;
         OI    32(@1),B'00100000'                                 0089
*               GO TO F8B4     /** BRANCH TO RESOLVE LENGTH**/;
         BC    15,F8B4                                            0090
*         END;
*         IF FDACTION = '0000'X THEN GO TO F6F2 /*BR TO ASSIGN DEFAULT*
@9FE     L     @1,596(0,@5)        
         CLC   28(2,@1),@X8                                       0092
         BC    08,F6F2                                            0093
*         IF FDACTION = 'RP' THEN DO /**DO FOLLOWING IF RIPPLE**/;
         CLC   28(2,@1),@C9                                       0094
         BC    07,@9FD                                            0094
*               RPACTION = '1'B          /**INDICATE RIPPLE ACTION**/;
         OI    32(@1),B'00010000'                                 0096
*               GO TO F6K2     /** BRANCH TO PROCESS**/;
         BC    15,F6K2                                            0097
*         END;
*         IF EQUOTESW = ON THEN DO /**DO BELOW IF E PICT**/;
@9FD     CLC   548(1,@5),ON                                       0099
         BC    07,@9FC                                            0099
*         IF FDACTION = 'RO' THEN DO /**DO FOLLOWING IF ROLL**/;
         L     @1,596(0,@5)        
         CLC   28(2,@1),@C10                                      0101
         BC    07,@9FB                                            0101
*               ROACTION = '1'B          /**INDICATE ROLL ACTION**/;
         OI    32(@1),B'00001000'                                 0103
*               GO TO F6H3     /**BR TO PROCESS**/;
         BC    15,F6H3                                            0104
*         END;
*         IF FDACTION = 'WV' THEN DO /**DO FOLLOWING IF WAVE**/;
@9FB     L     @1,596(0,@5)        
         CLC   28(2,@1),@C11                                      0106
         BC    07,@9FA                                            0106
*               WVACTION = '1'B          /**INDICATE WAVE ACTION**/;
         OI    32(@1),B'00000100'                                 0108
*               GO TO F6K2     /**BRANCH TO PROCESS**/;
         BC    15,F6K2                                            0109
*         END;
*         END;
@9FA     EQU   *                                                  0111
*                         /*ERROR-ACTION SPECIFIED NOT SUPPORTED*/
*         /*                                                          *
*         MS = 3                         /*SET MESSAGE 3 */;
@9FC     LA    @F,3                                               0112
         STH   @F,406(0,@5)                                       0112
*               GO TO F1B411   /**BRANCH TO EXIT ROUTINE**/;
         BC    15,F1B411                                          0113
*  F6A2:;
*               STACTION = '1'B /**INDICATE SHIFT,TRUNC ACTION**/;
F6A2     L     @1,596(0,@5)        
         OI    32(@1),B'00000010'                                 0115
*               FDFRINCR = '01'X         /*SET FROM INC RESTORE TO ONE*
         MVI   58(@1),X'01'                                       0116
*               GO TO F8B4     /** BRANCH TO RESOLVE LENGTH**/;
         BC    15,F8B4                                            0117
*  F6B2:;
*               FDFRINCR = '01'X         /*SET FROM INC RESTORE TO ONE*
F6B2     L     @1,596(0,@5)        
         MVI   58(@1),X'01'                                       0119
*  F6C2:;
*               STACTION = '1'B /**INDICATE SHIFT,TRUNC ACTION**/;
F6C2     L     @1,596(0,@5)        
         OI    32(@1),B'00000010'                                 0121
*               FDTOINCR = '01'X         /*SET TO INC RESTORE TO ONE*/;
         MVI   59(@1),X'01'                                       0122
*               GO TO F8B4     /** BRANCH TO RESOLVE LENGTH**/;
         BC    15,F8B4                                            0123
*  F6F2:;
*               FDACTION = 'FX'          /*DEFAULT ACTION TO FIXED*/;
F6F2     L     @1,596(0,@5)        
         MVC   28(2,@1),@C1                                       0125
*               FXACTION = '1'B          /**INDICATE FIXED ACTION**/;
         OI    32(@1),B'00100000'                                 0126
*               GO TO F8B4     /** BRANCH TO RESOLVE LENGTH**/;
         BC    15,F8B4                                            0127
*  F6K2:;
*               FDFRINCR = '01'X         /*SET FROM INC RESTORE TO ONE*
F6K2     L     @1,596(0,@5)        
         MVI   58(@1),X'01'                                       0129
*               GO TO F8A1               /*BR TO CONTINUE PROCESSING*/;
         BC    15,F8A1                                            0130
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION GETS CORE, LENGTH DEPENDING ON VALUE CONTAINED *
*  /** IN REG6. A MESSAGE IS INDICATED WHEN THE CONDITIONAL GETMAIN   *
*  /** WAS UNSUCCESSFUL. OTHERWISE, A BRANCH IS TAKEN TO SECTION F7A1.*
*  /** TO PROPAGATE THE FILL CHARACTER.                               *
*  /**                                                                *
*  /*******************************************************************
*  F6F4:;
*                         /*GET MAIN TO HOLD PATTERN*/
*               R1 = ADDR(GETMLIST)      /** PICK UP LIST ADDRESS    **
F6F4     LA    @1,364(0,@5)                                       0132
*               R7 = ADDR(GCADDR)        /** PICK UP GCADDR ADDRESS  **
         LA    @7,376(0,@5)                                       0133
*                              /*ISSUE GET MAIN MACRO*/
*         GEN ( GETMAIN EC,LV=(R6),A=(R7),SP=0,MF=(E,(R1)));
          GETMAIN EC,LV=(R6),A=(R7),SP=0,MF=(E,(R1))
         DS    0H
*               IF R15 = 0 THEN GO TO F7A1 /*BR IF GM SUCCESSFUL*/;
         LTR   @F,@F                                              0135
         BC    08,F7A1                                            0136
*                    MS = 10             /*SET MESSAGE FOR BAD GETMAIN*
         LA    @F,10                                              0137
         STH   @F,406(0,@5)                                       0137
*               GO TO F1B411   /** BRANCH TO LEAVE ROUTINE**/;
         BC    15,F1B411                                          0138
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION WILL TRIPLE THE FIELD LENGTH WHICH IS REQUIRED *
*  /** FOR THE ROLL PATTERN AND BRANCH TO GETMAIN BASED ON THE VALUE  *
*  /** OF REG6.                                                       *
*  /**                                                                *
*  /*******************************************************************
*  F6H3:;
*               FDFRINCR = '01'X         /*SET FROM INC RESTORE TO ONE*
F6H3     L     @1,596(0,@5)        
         MVI   58(@1),X'01'                                       0140
*               R6 = FDLGTH              /*PICK UP FIELD LENGTH*/;
         LH    @6,24(0,@1)                                        0141
*               R6 = R6 * 3              /*TRIPLE THE LENGTH*/;
         MH    @6,@D2                                             0142
*               GO TO F6F4               /*BR TO GET MAIN*/;
         BC    15,F6F4                                            0143
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION WILL INITIALIZE THE FDFROMAD TO THE ADDRESS    *
*  /** JUST OBTAINED AT F6F4. IT WILL THEN PROPAGATE THE FILL         *
*  /** CHARACTER THROUGHOUT THE FIELD.  IF A BI OF PD FORMAT IS       *
*  /** INDICATED, THE FIELD WILL BE FILLED WITH BINARY ZEROS.         *
*  /**                                                                *
*  /*******************************************************************
*  F7A1:;
*               LTOFREE = R6             /*SAVE LENGTH FOR FREEING*/;
F7A1     L     @1,596(0,@5)        
         STH   @6,60(0,@1)                                        0145
*               R8 = GCADDR              /*WORK ADDRESS TO REG */;
         L     @8,376(0,@5)                                       0146
*               FDFROMAD = R8  /**INITILIZE FD FROM ADDRESS*/;
         ST    @8,44(0,@1)                                        0147
*         IF FDFORMAT = 'BI' THEN DO /**BR IF NOT BI TO TEST FOR PD **/
         CLC   30(2,@1),@C13                                      0148
         BC    07,@9F9                                            0148
*              FDFILL = '00'X    /**INITILIZE FILL TO '00'X **/;
         MVI   33(@1),X'00'                                       0150
*        END;
*         IF FDFORMAT = 'PD' THEN DO /**BR IF NOT PD TO FILL FIELD **/;
@9F9     L     @1,596(0,@5)        
         CLC   30(2,@1),@C14                                      0152
         BC    07,@9F8                                            0152
*               FDFILL = '00'X       /**INITILIZE FILL TO '00'X **/;
         MVI   33(@1),X'00'                                       0154
*        END;
*         R8 -> INBUF(1) = FDFILL   /**FILL CHARACTER TO FIELD**/;
@9F8     L     @1,596(0,@5)        
         MVC   0(1,@8),33(@1)                                     0156
*         R6 = R6 - 1          /**CORRECT THE LENGTH**/;
         BCTR  @6,0                                               0157
*  F7A2:;
*         IF R6 = 0 THEN GO TO F7A5 /**BR FIELD IS FILLED**/;
F7A2     LTR   @6,@6                                              0159
         BC    08,F7A5                                            0160
*         IF R6 <= 256 THEN GO TO F7A4 /**BR LT OR EQ TO 256 TO MOVE**/
         CH    @6,@D3                                             0161
         BC    12,F7A4                                            0162
*                                   /**FILL 256 BYTES**/
*         GEN ( MVC 1(256,R8),0(R8));
          MVC 1(256,R8),0(R8)
         DS    0H
*               R6 = R6 - 256      /**DECREMENT LENGTH BY 256**/;
         SH    @6,@D3                                             0164
*               R8 = R8 + 256      /**INCREMENT ADDRESS BY 256**/;
         AH    @8,@D3                                             0165
*               GO TO F7A2         /**BRANCH MORE TO MOVE**/;
         BC    15,F7A2                                            0166
*                                  /**FILL OUT REST OF AREA**/
*  F7A3:;
*         GEN ( MVC 1(1,R8),0(R8));
F7A3      MVC 1(1,R8),0(R8)
         DS    0H
*  F7A4:;
*         R6 = R6 - 1          /**LENGTH FOR EXECUTE**/;
F7A4     BCTR  @6,0                                               0170
*         GEN ( EX R6,F7A3);
          EX R6,F7A3
         DS    0H
*  /*******************************************************************
*  /**                                                                *
*  /**    AT THIS POINT THE LENGTH REGISTER IS RESTORED AND IF A BI OR*
*  /** PD PICTURE IS PRESENT A BRANCH IS TAKEN FOR THEIR FINAL        *
*  /** INITIALIZATION.IF NOT AN EBCDIC PICTURE A BRANCH IS TAKEN TO   *
*  /** PROCESS IBM SUPPLIED NUMBER FORMATS.                           *
*  /**                                                                *
*  /*******************************************************************
*  F7A5:;
*         R6 = LTOFREE             /**RESTORE LENGTH REGISTER**/;
F7A5     L     @1,596(0,@5)        
         LH    @6,60(0,@1)                                        0173
*         IF PQUOTESW = ON THEN GO TO F10A2 /**BR IF PD NO**/;
         CLC   547(1,@5),ON                                       0174
         BC    08,F10A2                                           0175
*         IF BQUOTESW = ON THEN GO TO F10A4 /**BR IF BINARY NO**/;
         CLC   546(1,@5),ON                                       0176
         BC    08,F10A4                                           0177
*         IF EQUOTESW ^= ON THEN GO TO F8G1 /*BR NOT PICT-ITS IBM FMT*/
         CLC   548(1,@5),ON                                       0178
         BC    07,F8G1                                            0179
*  /******************************************************************/
*                         /*AT THIS POINT WE ARE PROCESSING A USER */
*                         /*DEFINED EBCDIC PICTURE WHICH WILL BE */
*                         /*ROLLED WAVED OR RIPPLED.THE PICTURE HAS*/
*                         /*BEEN SCANNED FROM THE FD CONTROL CARD AT*/
*                         /*WHICH TIME IT WAS PLACED AT SGCADDR*/
*                         /*ITS FINAL RESTING PLACE WILL BE GCADDR*/
*                         /*EQUALS FROM ADDR WHERE THE PICTURE WILL*/
*                         /*BE DOUBLED FOR WAVE AND RIPPLE-TRIPLED*/
*                         /*FOR ROLL.IT WILL BE MOVED BY SETTING UP*/
*                         /*TO AND FROM ADDRESSES AND CALLING MOVEROUT*
*                         /*THE REQUIRED NUMBER OF TIMES*/
*                         /*                                         */
*  /******************************************************************/
*                         /*                                         */
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION TESTS FOR PICTURE LENGTH BEING LONGER THAN FD  *
*  /** LENGTH.IF SO A MESSAGE IS INDICATED AND A BRANCH TAKEN TO EXIT.*
*  /**                                                                *
*  /*******************************************************************
*         IF FDLGTH >= FDPLGTH THEN GO TO F7A7 /**IF PLGTH OK BRANCH**/
         LH    @F,588(0,@5)                                       0180
         CH    @F,24(0,@1)                                        0180
         BC    12,F7A7                                            0181
*               MS = 16        /**INDICATE MESSAGE**/;
         LA    @F,16                                              0182
         STH   @F,406(0,@5)                                       0182
*               GO TO F1B411   /**BRANCH TO EXIT ROUTINE**/;
         BC    15,F1B411                                          0183
*  /*******************************************************************
*  /**                                                                *
*  /**    HERE THE FROM AND TOO ADDRESSES OF THE PICTURE AND LENGTH   *
*  /** ARE PICKED UP.IF ROLL ACTION A BRANCH IS TAKEN TO MOVE THE     *
*  /** PICTURE THREE TIMES.WAVE AND RIPPLE REQUIRE A DOUBLE PATTERN IN*
*  /** CORE.IF NOT ROLL,WAVE OR RIPPLE A BRANCH IS TAKEN TO MOVE      *
*  /** PICTURE ONCE.                                                  *
*  /**                                                                *
*  /*******************************************************************
*  F7A7:;
*                         /*RESOLVE THE FROM ADDRESS = SGCADDR*/
*               R9 = SGCADDR             /*FROM ADDRESS RESOLVED*/;
F7A7     L     @9,592(0,@5)                                       0185
*                         /*LENGTH TO MOVE = FDLGTH*/
*               R7 = FDPLGTH             /*PICK UP LGTH TO MOVE*/;
         LH    @7,588(0,@5)                                       0186
*                         /* TO ADDRESS = GCADDR*/
*               R8 = GCADDR              /*TO ADDRESS RESOLVED*/;
         L     @8,376(0,@5)                                       0187
*                         /*IF PATTERN IS A ROLL THE FDFROMAD MUST*/
*                         /*EQUAL THE SECOND PATTERN ADDR FOR WAVE OR*/
*                         /*RIPPLE IT EQUALS GCADDR*/
*               R6 = R8                  /* SAVE ADDRESS*/;
         LR    @6,@8                                              0188
*         IF FDACTION = 'RO' THEN GO TO F7C3 /**BR FOR ROLLING ACTION**
         L     @1,596(0,@5)        
         CLC   28(2,@1),@C10                                      0189
         BC    08,F7C3                                            0190
*         IF FDACTION = 'WV' THEN GO TO F7E3 /**BRANCH IF WAVE**/;
         CLC   28(2,@1),@C11                                      0191
         BC    08,F7E3                                            0192
*         IF FDACTION = 'RP' THEN GO TO F7E3 /**BRANCH IF ROLL**/;
         CLC   28(2,@1),@C9                                       0193
         BC    08,F7E3                                            0194
*               FDFROMAD = GCADDR /**INIT FD FROM ADDRESS**/;
         MVC   44(4,@1),376(@5)                                   0195
*               GO TO F7E4     /**BRANCH TO MOVE PICTURE ONCE**/;
         BC    15,F7E4                                            0196
*  /******************************************************************/
*                         /*RIPPLE AND WAVE HERE */
*                         /*MOVE THE PICTURE TO FDFROMAD */
*                         /*FOR USE OF THE CREATE MODULE*/
*  /** ENTRY HERE MOVES PICTURE TWICE INTO GCADDR                     *
*  /**                                                                *
*  /*******************************************************************
*  F7E3:;
*         CALL MOVEROUT;
F7E3     BAL   @E,MOVEROUT                                        0198
*                         /*ADDRESS WERE DESTROYED BY THE MOVE ROUTINE*
*               R9 = SGCADDR             /*FROM ADDRESS RESOLVED*/;
         L     @9,592(0,@5)                                       0199
*               R7 = FDPLGTH             /*LENGTH RESOLVED*/;
         LH    @7,588(0,@5)                                       0200
*         R8 = R6 + FDLGTH     /**RESOLVE TOO ADDRESS**/;
         L     @1,596(0,@5)        
         LH    @8,24(0,@1)                                        0201
         AR    @8,@6                                              0201
*  /*******************************************************************
*  /**                                                                *
*  /** ENTRY HERE MOVES PICTURE ONCE                                  *
*  /**                                                                *
*  /*******************************************************************
*  F7E4:;
*                         /* MOVE FOR THE LAST TIME*/
*         CALL MOVEROUT;
F7E4     BAL   @E,MOVEROUT                                        0203
*                         /*CORE MAY NOW BE FREED THAT HELD THE */
*                         /* ORIGINAL PICTURE*/
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION FREES CORE OBTAINED FOR TEMPORARY STORAGE.     *
*  /**    THIS SECTION IS ONE OF THE EXIT POINTS FROM THIS ROUTINE.IT *
*  /** WILL CLEAR ALL FD SWITCHES SET DURING THIS EXECUTION AND RETURN*
*  /** TO IEBFDANL                                                    *
*  /**                                                                *
*  /*******************************************************************
*  F7G3:;
*               R6 = FDPLGTH             /*PICK UP LENGTH TO FREE*/;
F7G3     LH    @6,588(0,@5)                                       0205
*               R7 = ADDR(SGCADDR) /**ADDRESS OF ADDRESS TO FREE**/;
         LA    @7,592(0,@5)                                       0206
*               R1 = ADDR(GETMLIST)      /*PICK UP LIST ADDR FOR MACRO*
         LA    @1,364(0,@5)                                       0207
*         GEN ( FREEMAIN E,LV=(R6),A=(R7),SP=0,MF=(E,(1)));
          FREEMAIN E,LV=(R6),A=(R7),SP=0,MF=(E,(1))
         DS    0H
*  F7H3:;
*                              /* CLEAR SWITCHES*/
*         SWITCH(1:14) = SWITCH(1:14) && SWITCH(1:14) /*FD SWIT OFF*/;
F7H3     XC    536(14,@5),536(@5)                                 0210
*                              /*RETURN TO BASE MODULE ONE ENTRY DONE*/
*               RETURN;
         BC    15,@EL01                                           0211
*  /*******************************************************************
*  /** ENTRY HERE CAUSES THE PICTURE TO BE MOVED THREE TIMES.         *
*  /*******************************************************************
*  F7C3:;
*                              /*MOVE FIRST PATTERN TO WKAREA*/
*                              /* ADDRESSES ARE RESOLVED*/
*               CALL MOVEROUT;
F7C3     BAL   @E,MOVEROUT                                        0213
*                              /*RESOLVE ADDRESSES AND LENGTH BEFORE*/
*                              /*BRANCH TO MOVE 2ND TIME*/
*               R9 = SGCADDR             /*FROM ADDRESS RESOLVED*/;
         L     @9,592(0,@5)                                       0214
*               R7 = FDPLGTH             /*LENGTH RESOLVED*/;
         LH    @7,588(0,@5)                                       0215
*         R8 = R6 + FDLGTH     /**RESOLVE TOO ADDRESS**/;
         L     @1,596(0,@5)        
         LH    @8,24(0,@1)                                        0216
         AR    @8,@6                                              0216
*               FDFROMAD = R8  /**INITILIZE CORRECT FROM ADDRESS**/;
         ST    @8,44(0,@1)                                        0217
*               R6 = R8                  /*SAVE ADDRESS*/;
         LR    @6,@8                                              0218
*               GO TO F7E3               /*BR TO MOVE 2ND TIME*/;
         BC    15,F7E3                                            0219
*  /*******************************************************************
*  /**                                                                *
*  /**    ENTRY IS TO THIS POINT WHEN AL,AN,CO OR USER PICTURE WANTED *
*  /**                                                                *
*  /**    THIS SECTION WILL TEST FOR FORMAT AND IF FOUND WILL BRANCH  *
*  /** TO SET UP SEQUENCE LENGTH AND SEQUENCE LENGTH RESTORES FOR THE *
*  /** CREATE MODULE.THE LENGTH THAT THE PATTERN NEEDS WILL ALSO BE   *
*  /** DETERMINED.IF NO FORMAT,A PICTURE IS PRESENT,A BRANCH WILL BE  *
*  /** TAKEN TO DOUBLE THE FIELD LENGTH.                              *
*  /**                                                                *
*  /*******************************************************************
*  F8A1:;
*         IF FDFORMAT = 'AL' THEN GO TO F8A4 /*BR IF AL FORMAT*/;
F8A1     L     @1,596(0,@5)        
         CLC   30(2,@1),@C15                                      0221
         BC    08,F8A4                                            0222
*         IF FDFORMAT = 'AN' THEN GO TO F8B3 /*BR IF AN FORMAT*/;
         CLC   30(2,@1),@C16                                      0223
         BC    08,F8B3                                            0224
*         IF FDFORMAT = 'CO' THEN GO TO F8D2 /*BR IF CO FORMAT*/;
         CLC   30(2,@1),@C17                                      0225
         BC    08,F8D2                                            0226
*                              /*USER PICTURE BR TO DOUBLE FIELD*/
*               GO TO F8B4               /*BRANCH TO DOUBLE FIELD*/;
         BC    15,F8B4                                            0227
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION IS ENTERED FOR AN ALPHABETIC SEQUENCE.IF THE   *
*  /** FIELD LENGTH IS GREATER THAN THE SEQUENCE LENGTH OF 26 A BRANCH*
*  /** IS TAKEN TO TEST FOR RIPPLE OR WAVE ACTION.                    *
*  /*******************************************************************
*  F8A4:;
*         IF FDLGTH > '001A'X THEN GO TO F8B4 /*BR WHEN OVER 26 LONG*/;
F8A4     L     @F,@X18                                            0229
         L     @1,596(0,@5)        
         CH    @F,24(0,@1)                                        0229
         BC    04,F8B4                                            0230
*               FDSLGTHR = '001A'X       /*SEQ LGTH RESTORE TO 26*/;
         MVC   56(2,@1),@X18+2                                    0231
*               FDSLGTH = FDSLGTHR /**INIT SEQ LGTH FOR RIPPLE**/;
         MVC   54(2,@1),56(@1)                                    0232
*               R6 = FDLGTH + 26         /*LGTH FOR GMAIN FOR PATTERN*/
         LA    @6,26                                              0233
         AH    @6,24(0,@1)                                        0233
*               GO TO F6F4               /*BR TO GET MAIN*/;
         BC    15,F6F4                                            0234
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION IS ENTERED FOR AN ALPHANUMERIC SEQUENCE.       *
*  /*******************************************************************
*  F8B3:;
*         IF FDLGTH < '0024'X THEN GO TO F8C3 /**BRANCH LT 36 **/;
F8B3     L     @F,@X19                                            0236
         L     @1,596(0,@5)        
         CH    @F,24(0,@1)                                        0236
         BC    02,F8C3                                            0237
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION WILL DOUBLE THE FIELD LENGTH FOR WAVE OR RIPPLE*
*  /** ACTION.A BRANCH IS TAKEN TO F6F4 TO GETMAIN TO HOLD THE PATTERN*
*  /** IF NOT RP OR WV.                                               *
*  /*******************************************************************
*  F8B4:;
*               FDSLGTHR = FDLGTH        /*SEQ RESTORE TO FIELD LGTH*/;
F8B4     L     @1,596(0,@5)        
         MVC   56(2,@1),24(@1)                                    0239
*         IF FDACTION = 'RP' THEN DO /**IF RIPPLE DO FOLLOWING**/;
         CLC   28(2,@1),@C9                                       0240
         BC    07,@9F7                                            0240
*               FDSLGTH = FDSLGTHR /**INIT SEQ LGTH FOR RIPPLE ONLY**/;
         MVC   54(2,@1),56(@1)                                    0242
*               GO TO F8B5     /**BRANCH TO DOUBLE FIELD LGTH**/;
         BC    15,F8B5                                            0243
*         END;
*         IF FDACTION ^= 'WV' THEN GO TO F6F4 /**BR NOT WAVE**/;
@9F7     L     @1,596(0,@5)        
         CLC   28(2,@1),@C11                                      0245
         BC    07,F6F4                                            0246
*  F8B5:;
*               R6 = FDLGTH * 2          /*DOUBLE THE FIELD LENGTH*/;
F8B5     LA    @E,2                                               0248
         L     @1,596(0,@5)        
         MH    @E,24(0,@1)                                        0248
         LR    @6,@E                                              0248
*               GO TO F6F4               /*BR TO GET MAIN*/;
         BC    15,F6F4                                            0249
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION IS ENTERED FOR AN ALPHANUMERIC SEQUENCE.IT WILL*
*  /** SET THE SEQUENCE LENGTH RESTORES AND DETERMINE THE LENGTH FOR  *
*  /** THE GETMAIN AT F6F4.                                           *
*  /*******************************************************************
*  F8C3:;
*               FDSLGTHR = '0024'X       /*SEQ LGTH RESTORE TO 36 */;
F8C3     L     @1,596(0,@5)        
         MVC   56(2,@1),@X19+2                                    0251
*               FDSLGTH = FDSLGTHR /**INIT SEQ LGTH FOR RIPPLE**/;
         MVC   54(2,@1),56(@1)                                    0252
*               R6 = FDLGTH + 36         /*LGTH FOR GM FOR PATTERN*/;
         LA    @6,36                                              0253
         AH    @6,24(0,@1)                                        0253
*               GO TO F6F4               /*BR TO GET MAIN*/;
         BC    15,F6F4                                            0254
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION IS ENTERED FOR A COLLATTING SEQUENCE.IT WILL   *
*  /** SET THE SEQUENCE LENGTH RESTORES AND DETERMINE THE LENGTH FOR  *
*  /** THE GETMAIN AT F6F4.                                           *
*  /*******************************************************************
*  F8D2:;
*         IF FDLGTH > '003F'X THEN GO TO F8B4 /*BRANCH GT 63 */;
F8D2     L     @F,@X20                                            0256
         L     @1,596(0,@5)        
         CH    @F,24(0,@1)                                        0256
         BC    04,F8B4                                            0257
*               FDSLGTHR = '003F'X       /*SEQ LGTH RESTORE TO 63 */;
         MVC   56(2,@1),@X20+2                                    0258
*               FDSLGTH = FDSLGTHR /**INIT SEQ LGTH FOR RIPPLE**/;
         MVC   54(2,@1),56(@1)                                    0259
*               R6 = FDLGTH + 63         /*LGTH FOR GM FOR PATTERN*/;
         LA    @6,63                                              0260
         AH    @6,24(0,@1)                                        0260
*               GO TO F6F4               /*BR TO GET MAIN*/;
         BC    15,F6F4                                            0261
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION WILL TEST FOR RANDOM FORMAT WHICH AT THIS TIME *
*  /** NEEDS NO FURTHER PROCESSING IN THIS MODULE.IF RANDOM A NUMBER  *
*  /** IS INDICATED AND A BRANCH IS TAKEN TO F7H3 TO EXIT THIS MODULE.*
*  /*******************************************************************
*  F8G1:;
*         IF FDFORMAT = 'RA' THEN DO /** DO BELOW IF RANDOM**/;
F8G1     L     @1,596(0,@5)        
         CLC   30(2,@1),@C2                                       0263
         BC    07,@9F6                                            0263
*         R6 = U ;                     /* PICK UP LAST RANDOM @YA02530*
         L     @6,624(0,@5)                                       0265
*         GENERATE ;
         LA    R7,1                    SET ALL FF IN R7        @YA02530
         LCR   R7,R7                   FOR SUBTRACTING         @YA02530
         SRDL  R6,8                    SHIFT TO RETAIN         @YA02530
         SLL   R6,8                    CLEAN NUMBER            @YA02530
         SLR   R7,R6                   SUBTRACT TO NUMBER      @YA02530
         SRL   R6,8                    SHIFT TO GET BYTE       @YA02530
         SLDL  R6,8                    PLACE IN                @YA02530
         DS    0H
*         R7 = 524293 ;                /* INIT MULTIPLIER     @YA02530*
         L     @7,@D4                                             0267
*         GENERATE ;
         MR    R6,R6                   MULTIPLY FOR NEW RANDOM @YA02530
         LA    R6,3201                 LOAD NUMBER FOR ADD     @YA02530
         ALR   R7,R6                   ADD VALUE RANDOMIZING   @YA02530
         LR    R6,R7                   SAVE NEW VALUE          @YA02530
         SLL   R7,24                   SHIFT TO ADD RANDOM #   @YA02530
         ALR   R7,R6                   ADD TO NEW # TO AVOID   @YA02530
         SRL   R6,8                    PAIR/UNPAIR SEQUENCE    @YA02530
         SLDL  R6,8                    RESULT RANDOM           @YA02530
         DS    0H                                              @YA02530
         DS    0H
*         U = R6 ;                     /* NEW RANDOM #        @YA02530*
         ST    @6,624(0,@5)                                       0269
*         FDMLGTH = FDLGTH     /**INITILIZE MOVE LENGTH**/;
         L     @1,596(0,@5)        
         MVC   48(2,@1),24(@1)                                    0270
*         IF FDLGTH > 4 THEN R6 = 4  /**IF LGTH GT 4 THEN MAKE MOVE REG
         LA    @F,4                                               0271
         CH    @F,24(0,@1)                                        0271
         BC    10,@9F5                                            0271
*                                       4 **/;
         LR    @6,@F                                              0272
         BC    15,@9F4                                            0273
*         ELSE R6 = FDLGTH     /** LGTH LT 4 REG EQ LGTH**/;
@9F5     LH    @6,24(0,@1)                                        0273
*         R9 = FDFROMAD + FDLGTH - R6 /**DERIVE ADDRESS FOR RANDOM NUMB
*                                        R**/;
@9F4     LCR   @9,@6                                              0274
         LH    @0,24(0,@1)                                        0274
         ALR   @9,@0                                              0274
         AL    @9,44(0,@1)                                        0274
*         R7 = ADDR(U)         /**PICK UP RANDOM NUMBER ADDRESS**/;
         LA    @7,624(0,@5)                                       0275
*         R7 = R7 - R6 + 4     /** ADDRESS PROPER PART OF U **/;
         LA    @F,4                                               0276
         SR    @F,@6                                              0276
         AR    @7,@F                                              0276
*         INBUF(1:R6) = R7 -> INBUF(1:R6) /**INIT RANDOM NUMBER**/;
         LR    @E,@7                                              0277
         LR    @2,@6                                              0277
         BCTR  @2,0                                               0277
         LR    @A,@9                                              0277
         EX    @2,@MVC                                            0277
*  F8G2:;
*         FDSWITCH = 'C0'X & FDSWITCH /**TURN OFF ACTION IND FOR CR**/;
F8G2     L     @1,596(0,@5)        
         NI    32(@1),X'C0'                                       0279
*               NUACTION = '1'B /**TURN ON NUMBER ACTION SWITCH**/;
         OI    32(@1),B'00000001'                                 0280
*               GO TO F7H3     /** BR TO EXIT ROUTINE**/;
         BC    15,F7H3                                            0281
*         END;
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION TESTS FOR REST OF FORMATS.IF NO FORMAT WAS     *
*  /** SPECIFIED,ACTION IS DEFAULTED TO FIXED.FORMAT DEFAULT IS THE   *
*  /** FILL CHARACTER,ALREADY PROPOGATED THROUGH THE FIELD.IF NO FILL *
*  /** THERE IS A DEFAULT OF BINARY ZERO.WHEN A FORMAT IS FOUND A     *
*  /** BRANCH IS TAKEN FOR FURTHER PROCESSING.                        *
*  /*******************************************************************
*         IF FDFORMAT = 'BI' THEN GO TO F8H2 /*BR ITS BI FORMAT*/;
@9F6     L     @1,596(0,@5)        
         CLC   30(2,@1),@C13                                      0283
         BC    08,F8H2                                            0284
*         IF FDFORMAT = 'PD' THEN GO TO F8J4 /*BR ITS PD FORMAT*/;
         CLC   30(2,@1),@C14                                      0285
         BC    08,F8J4                                            0286
*         IF FDFORMAT = 'ZD' THEN GO TO F8K2 /*BRANCH IF ZD FORMAT*/;
         CLC   30(2,@1),@C22                                      0287
         BC    08,F8K2                                            0288
*  /** IF FORMAT IS SPECIFIED BRANCH  **/
*         IF FDFORMAT ^= '0000'X THEN GO TO F9A1 /** BR A FORMAT**/;
         CLC   30(2,@1),@X8                                       0289
         BC    07,F9A1                                            0290
*  /** AT THIS POINT NO FORMAT WAS ASSIGNED - FILL CHAR HAS BEEN **/
*  /** MOVED THROUGH FIELD  SEE F7A1. A BRANCH WILL BE TAKEN TO **/
*               FXACTION = '1'B /** TURN ON FX ACTION SWITCH**/;
         OI    32(@1),B'00100000'                                 0291
*               GO TO F7H3     /**BRANCH TO FINISH UP**/;
         BC    15,F7H3                                            0292
*  /*******************************************************************
*  /**                                                                *
*  /**               BINARY FORMAT IS PROCESSED HERE                  *
*  /**                                                                *
*  /** IF THE SIGN WAS SPECIFIED AS NEGATIVE A BRANCH IS TAKEN TO NEXT*
*  /** SECTION.A POSITIVE BINARY FIELD IS INITILIZED BY LOCATING THE  *
*  /** RIGHTMOST BYTE IN THE FIELD AND PLACING A '01'X IN IT.A BRANCH *
*  /** IS THEN TAKEN TO TURN ON NUMBER ACTION SWITCH AND EXIT.        *
*  /*******************************************************************
*  F8H2:;
*         IF FDSIGN = '-' THEN GO TO F8H3 /*BR BI SIGN NEG*/;
F8H2     L     @1,596(0,@5)        
         CLI   34(@1),C'-'                                        0294
         BC    08,F8H3                                            0295
*                              /*POS BI SIGN HERE*/
*         R9 = FDFROMAD + FDLGTH - 1 /**POINT AT RIGHTMOST BYTE**/;
         L     @9,@D5                                             0296
         LH    @0,24(0,@1)                                        0296
         ALR   @9,@0                                              0296
         AL    @9,44(0,@1)                                        0296
*         R9 -> WKADDR(1) = '01'X        /*INIT FIELD TO POS ONE*/;
         MVI   0(@9),X'01'                                        0297
*               GO TO F8G2 /** BR TO TURN ON NU ACTION SWITCH**/;
         BC    15,F8G2                                            0298
*  /*******************************************************************
*  /**                                                                *
*  /**               NEGATIVE BINARY NUMBER HERE                      *
*  /** THE FIELD ADDRESS IS PICKED UP AND A 'FF'X IS PLACED IN THE    *
*  /** FIRST BYTE.IF THE FIELD LENGTH IS ONE A BRANCH IS TAKEN TO TURN*
*  /** ON NUMBER ACTION SWITCH AND EXIT.FOR A LENGTH GT ONE,ONE BITS  *
*  /** ARE PROPOGATED THROUGH THE FIELD.                              *
*  /*******************************************************************
*  F8H3:;
*               R9 = FDFROMAD            /*POINT AT START OF FIELD*/;
F8H3     L     @1,596(0,@5)        
         L     @9,44(0,@1)                                        0300
*                                        /*INITILIZE FIELD TO NEG ONE*/
*               INBUF(1) = 'FF'X         /*FIRST BYTE TO ONE BITS*/;
         MVI   0(@9),X'FF'                                        0301
*         IF FDLGTH = 1 THEN GO TO F8G2 /**BRANCH IF LENGTH IS ONE**/;
         LA    @F,1                                               0302
         CH    @F,24(0,@1)                                        0302
         BC    08,F8G2                                            0303
*               R6 = FDLGTH - 2 /**INITILIZE REG FOR EXECUTE INST**/;
         LH    @6,@D6                                             0304
         AH    @6,24(0,@1)                                        0304
*                                        /*FILL OUT REST OF FIELD*/
*         GEN ( EX R6,F8H4);
          EX R6,F8H4
         DS    0H
*               GO TO F8G2 /** BR TO TURN ON NU ACTION SWITCH**/;
         BC    15,F8G2                                            0306
*  F8H4:;
*               /*  MOVE CHARACTERS  */
*   GEN ( MVC 1(1,R9),0(R9));
F8H4      MVC 1(1,R9),0(R9)
         DS    0H
*  /*******************************************************************
*  /**                                                                *
*  /**                    PACKED DECIMAL FIELD HERE                   *
*  /**                                                                *
*  /** THE ADDRESS OF LAST BYTE OF THE FIELD IS PICKED UP.IF POSITIVE *
*  /** A '1C'X IS PLACED IN THIS POSITION.NEGATIVE REQUIRES A '1D'X.  *
*  /** A BRANCH IS THEN TAKEN TO TURN ON THE NUMBER ACTION SWITCH AND *
*  /** EXIT THIS ROUTINE.                                             *
*  /*******************************************************************
*  F8J4:;
*         R9 = FDFROMAD + FDLGTH - 1 /**ADDRESS LAST BYTE OF FIELD**/;
F8J4     L     @9,@D5                                             0310
         L     @1,596(0,@5)        
         LH    @0,24(0,@1)                                        0310
         ALR   @9,@0                                              0310
         AL    @9,44(0,@1)                                        0310
*         IF FDSIGN = '-' THEN GO TO F8J5 /*BR PD AND NEG*/;
         CLI   34(@1),C'-'                                        0311
         BC    08,F8J5                                            0312
*                              /*POS PD FIELD HERE*/
*         R9 -> WKADDR(1) = '1C'X        /*INIT TO POS ONE*/;
         MVI   0(@9),X'1C'                                        0313
*               GO TO F8G2 /** BR TO TURN ON NU ACTION SWITCH**/;
         BC    15,F8G2                                            0314
*  F8J5:;
*         R9 -> WKADDR(1) = '1D'X        /*INIT TO NEG ONE*/;
F8J5     MVI   0(@9),X'1D'                                        0316
*               GO TO F8G2 /** BR TO TURN ON NU ACTION SWITCH**/;
         BC    15,F8G2                                            0317
*  F8K2:;
*  /*******************************************************************
*  /**                                                                *
*  /**                    ZONED DECIMAL HERE                          *
*  /**                                                                *
*  /** THE FIELD IS INITILIZED BY FILLING THE FIRST BYTE WITH 'F0'X   *
*  /** AND PROPOGATING THIS CHARACTER THROUGH THE FIELD.THE LAST BYTE *
*  /** IS THEN MADE A 'F1'X,A ZONED DECIMAL CNE.                      *
*  /*******************************************************************
*               R9 = FDFROMAD            /*ADDRESS START OF FIELD*/;
F8K2     L     @1,596(0,@5)        
         L     @9,44(0,@1)                                        0319
*               INBUF(1) = 'F0'X         /*ZD ZERO TO FIRST BYTE*/;
         MVI   0(@9),X'F0'                                        0320
*         IF FDLGTH = 1 THEN DO /**IF LENGTH NOT ONE BR TO INIT LNG**/;
         LA    @F,1                                               0321
         CH    @F,24(0,@1)                                        0321
         BC    07,@9F3                                            0321
*               INBUF(1) = 'F1'X /**ONE CHARACTER FIELD TO ZD ONE**/;
         MVI   0(@9),X'F1'                                        0323
*               GO TO F8G2     /**BR TO TURN ON NUACTION SWITCH**/;
         BC    15,F8G2                                            0324
*         END;
*              R6 = FDLGTH - 2 /**INITILIZE REG FOR EXECUTE INST**/;
@9F3     LH    @6,@D6                                             0326
         L     @1,596(0,@5)        
         AH    @6,24(0,@1)                                        0326
*                             /*PROPOGATE ZEROES IN FIELD*/
*  F8K3:;
*         IF R6 = 0 THEN GO TO F8K5    /**NO MORE TO MOVE**/;
F8K3     LTR   @6,@6                                              0328
         BC    08,F8K5                                            0329
*         IF R6 < 256 THEN GO TO F8K4  /**BR LGTH LESS THAN 256**/;
         CH    @6,@D3                                             0330
         BC    04,F8K4                                            0331
*   GEN(  MVC 1(256,R9),0(R9));        /**MOVE 256 CHARACTERS**/
           MVC 1(256,R9),0(R9)
         DS    0H
*         R6 = R6 - 256                /**REDUCE COUNT BY 256**/;
         SH    @6,@D3                                             0333
*         R9 = R9 + 256                /**ADD 256 TO ADDRESS**/;
         AH    @9,@D3                                             0334
*         GO TO F8K3                   /**BR TO KEEP MOVING**/;
         BC    15,F8K3                                            0335
*  F8K4:;
*   GEN ( EX R6,F8H4);
F8K4      EX R6,F8H4
         DS    0H
*  F8K5:;
*         R9 = FDFROMAD + FDLGTH - 1   /**ADDRESS LAST BYTE OF FIELD**/
F8K5     L     @9,@D5                                             0339
         L     @1,596(0,@5)        
         LH    @0,24(0,@1)                                        0339
         ALR   @9,@0                                              0339
         AL    @9,44(0,@1)                                        0339
*         R9 -> WKADDR(1) = 'F1'X        /*INIT FIELD TO ONE*/;
         MVI   0(@9),X'F1'                                        0340
*               GO TO F8G2 /** BR TO TURN ON NU ACTION SWITCH**/;
         BC    15,F8G2                                            0341
*  /******************************************************************/
*  /**                                                                *
*  /**    THIS SECTION WILL SET UP AL,AN AND CO FORMATS FOR STARTING  *
*  /** CHARACTER.NO START CHARACTER DEFAULTS TO'A' FOR AL AND AN.     *
*  /** CO STARTING CHARACTER DEFAULT IS A BLANK- '40'X.IF CHARACTER   *
*  /** SPECIFIED IS NOT IN SEQUENCE A MSG IS ISSUED. E.G. A SEMI-COLON*
*  /** IS NOT PART OF AL FORMAT.WHEN CHARACTER IS RESOLVED,A LOOP IS  *
*  /** STARTED TO FILL FIELD WITH THE PATTERN.WE CAN ONLY MOVE IN     *
*  /** INCREMENTS OF 26 FOR AL,36 FOR AN,AND 63 FOR CO.A 63 DIGIT     *
*  /** PATTERN IS USED AT LABEL COPAT AND ALPAT.                      *
*  /**                                                                *
*  /**                                                                *
*  /** R9 WILL BE USED TO HOLD THE PATTERN ADDRESS-EQUALS FROM ADDRESS*
*  /** R8 WILL BE USED TO HOLD THE TOO ADDRESS-EQUALS FD FIELD ADDRESS*
*  /** R7 WILL BE USED TO HOLD THE LENGTH TO MOVE                     *
*  /**                                                                *
*  /******************************************************************/
*  F9A1:;
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION PICKS UP START OF AL PATTERN,CLEARS CTR1 AND   *
*  /** BRANCHES TO RESOLVE PATTERN.                                   *
*  /*******************************************************************
*                              /*PICK UP START OF AL AND AN FIELDS*/
*               R9 = ADDR(ALPAT)         /*PICKS UP START OF AL,AN*/;
F9A1     LA    @9,ALPAT                                           0343
*               R6 = 0                   /* CTR1 TO ZERO*/;
         SR    @6,@6                                              0344
*         IF FDFORMAT = 'AL' THEN GO TO F9A2 /* IF AL FORMAT-BRANCH*/;
         L     @1,596(0,@5)        
         CLC   30(2,@1),@C15                                      0345
         BC    08,F9A2                                            0346
*         IF FDFORMAT = 'CO' THEN GO TO F9F1 /**IF CO FORMAT BRANCH**/;
         CLC   30(2,@1),@C17                                      0347
         BC    08,F9F1                                            0348
*  /*******************************************************************
*  /**                                                                *
*  /**               ALPHANUMERIC PATTERN HERE                        *
*  /** THE SEQUENCE LENGTH OF 36 IS PICKED UP AND A BRANCH TAKEN IF   *
*  /** A START CHARACTER IS TO BE RESOLVED.IF NO START CHARACTER AND  *
*  /** LENGTH IS LESS THAN 36 A BRANCH IS TAKEN TO RESOLVE POINTERS   *
*  /** FOR FILLING FIELD WITH PATTERN,OTHERWISE A BRANCH IS TAKEN TO  *
*  /** FILL FIELD FROM PATTERN IN INCREMENTS OF 36.                   *
*  /*******************************************************************
*               COMPCTR = 36   /**COMPARE CTR TO SEQUENCE LENGTH**/;
         LA    @F,36                                              0349
         ST    @F,616(0,@5)                                       0349
*         IF FDCHAR ^= '00'X THEN GO TO F9A3 /*BR TO RESOLVE START*/;
         L     @1,596(0,@5)        
         CLI   35(@1),X'00'                                       0350
         BC    07,F9A3                                            0351
*         IF LTOFREE > '0024'X THEN GO TO F9C3 /*BR NO START CHARACTER*
         L     @F,@X19                                            0352
         CH    @F,60(0,@1)                                        0352
         BC    04,F9C3                                            0353
*               GO TO F9J2               /*BR TO RESOLVE PARA FOR MOVE*
         BC    15,F9J2                                            0354
*  /*******************************************************************
*  /**                                                                *
*  /**               COLLATTING SEQUENCE HERE                         *
*  /** THE SEQUENCE LENGTH OF 63 IS PICKED UP AND A BRANCH TAKEN IF   *
*  /** A START CHARACTER IS TO BE RESOLVED.IF NO START CHARACTER AND  *
*  /** LENGTH IS LESS THAN 63 THE NEXT SECTION IS ENTERED.IF LENGTH IS*
*  /** GREATER THAN 63 A BRANCH IS TAKEN TO MOVE PATTERN IN INCREMENTS*
*  /** OF 63.                                                         *
*  /*******************************************************************
*  F9F1:;
*               R9 = ADDR(COPAT)         /*PICK UP START OF CO FIELD*/;
F9F1     LA    @9,COPAT                                           0356
*               COMPCTR = 63   /**COMPARE CTR TO SEQUENCE LENGTH**/;
         LA    @F,63                                              0357
         ST    @F,616(0,@5)                                       0357
*         IF FDCHAR ^= '00'X THEN GO TO F9A3 /**BR TO RESOLVE START**/;
         L     @1,596(0,@5)        
         CLI   35(@1),X'00'                                       0358
         BC    07,F9A3                                            0359
*         IF LTOFREE > '003F'X THEN GO TO F9C3 /*BR NO START CHARACTER*
         L     @F,@X20                                            0360
         CH    @F,60(0,@1)                                        0360
         BC    04,F9C3                                            0361
*  /*******************************************************************
*  /**    THIS SECTION PICKS UP THE LENGTH AND ADDRESS OF FIELD TO BE *
*  /** FILLED AND BRANCHES TO MOVE THE PATTERN                        *
*  /*******************************************************************
*  F9J2:;
*               R8 = GCADDR              /* PICK UP WORK ADDRESS*/;
F9J2     L     @8,376(0,@5)                                       0363
*               R7 = LTOFREE             /**NO.OF BYTES TO MOVE**/;
         L     @1,596(0,@5)        
         LH    @7,60(0,@1)                                        0364
*               GO TO F9G5               /*BR TO MOVE PATTERN*/;
         BC    15,F9G5                                            0365
*  /*******************************************************************
*  /**                                                                *
*  /**               ALPHABETIC PATTERN HERE                          *
*  /** THE SEQUENCE LENGTH IS PICKED UP AND A BRANCH TAKEN IF A START *
*  /** CHARACTER IS TO BE RESOLVED.IF NO START CHAR AND LENGTH IS GT  *
*  /** 26 A BRANCH IS TAKEN TO FILL FIELD IN INCREMENTS OF 26,        *
*  /** OTHERWISE A BRANCH IS TAKEN TO FILL ALL OF FIELD.              *
*  /*******************************************************************
*  F9A2:;
*               COMPCTR = 26   /**COMPARE CTR TO SEQUENCE LENGTH**/;
F9A2     LA    @F,26                                              0367
         ST    @F,616(0,@5)                                       0367
*         IF FDCHAR ^= '00'X THEN GO TO F9A3 /*BR TO RESOLVE STARTAD*/;
         L     @1,596(0,@5)        
         CLI   35(@1),X'00'                                       0368
         BC    07,F9A3                                            0369
*         IF LTOFREE > '001A'X THEN GO TO F9C3 /*BR NO START CHARACTER*
         L     @F,@X18                                            0370
         CH    @F,60(0,@1)                                        0370
         BC    04,F9C3                                            0371
*               GO TO F9J2               /*BR TO READY FOR MOVE*/;
         BC    15,F9J2                                            0372
*                              /*TEST HERE FOR START CHARACTER*/
*  /*******************************************************************
*  /**               RESOLVE START CHARACTER HERE                     *
*  /** THIS SECTION CONSISTING OF TWO LABELS WILL PASS CHARACTER BY   *
*  /** CHARACTER THROUGH A SEQUENCE LOOKING FOR A MATCH ON FDCHAR.    *
*  /** THE COMPCTR CONTAINS THE LENGTH OF THE SEQUENCE.REG 6 IS USED  *
*  /** TO COUNT WHERE WE ARE IN THE SEQUENCE.REG 9 IS THE POINTER TO  *
*  /** THE SEQUENCE.IF A MATCH IS FOUND THE NEXT SECTION IS ENTERED.  *
*  /** NO MATCH CAUSES A MESSAGE INDICATION.                          *
*  /*******************************************************************
*  F9A3:;
*         IF INBUF(1) = FDCHAR THEN GO TO F9C3 /*BRANCH A MATCH*/;
F9A3     L     @1,596(0,@5)        
         CLC   0(1,@9),35(@1)                                     0374
         BC    08,F9C3                                            0375
*                              /*HAVE WE PASSED THROUGH ALL OF SEQ*/
*         IF R6 = COMPCTR THEN GO TO F9B5 /**BRANCH CHARACTER NO GOOD**
         C     @6,616(0,@5)                                       0376
         BC    08,F9B5                                            0377
*               R6 =R6 + 1               /*ADD 1 TO SEQ COUNT*/;
         AH    @6,@D7                                             0378
*               R9 =R9 + 1               /* INC COMPARE ADDR BY ONE*/;
         AH    @9,@D7                                             0379
*               GO TO F9A3               /*BR TO COMPARE AGAIN*/;
         BC    15,F9A3                                            0380
*  F9B5:;
*               MS = 3                   /*SET MESSAGE 3 */;
F9B5     LA    @F,3                                               0382
         STH   @F,406(0,@5)                                       0382
*               GO TO F1B411   /** BRANCH TO EXIT ROUTINE**/;
         BC    15,F1B411                                          0383
*                             /*AT THIS POINT THE STARTING ADDRESS */
*                              /*IN THE PATTERN HAS BEEN RESOLVED*/
*                              /*EITHER BY LOOP AT F9A3 OR DEFAULT*/
*  F9C3:;
*               R8 = GCADDR              /*PICK UP WORK ADDRESS*/;
F9C3     L     @8,376(0,@5)                                       0385
*  /*******************************************************************
*  /**    THIS SECTION PICKS UP LENGTH TO MOVE AND DETERMINES IF THE  *
*  /** FIELD CAN BE FILLED IN ONE MOVE OF IF MORE MOVES ARE NEEDED.   *
*  /*******************************************************************
*  F9C4:;
*         R7 = COMPCTR - R6    /**R7 EQUALS LENGTH TO MOVE**/;
F9C4     LCR   @7,@6                                              0387
         A     @7,616(0,@5)                                       0387
*         COMPCTR = LTOFREE    /** PICK UP TOTAL LENGTH TO MOVE**/;
         L     @1,596(0,@5)        
         LH    @F,60(0,@1)                                        0388
         ST    @F,616(0,@5)                                       0388
*  /*IF LENGTH TO MOVE IS EQ OR LESS THAN R7 THE FIELD CAN BE*/
*  /*FILLED DIRECTLY FROM THE SEQUENCE*/
*         IF COMPCTR =< R7 THEN DO /*CAN WHOLE FIELD BE INIT FROM SEQ**
         C     @7,616(0,@5)                                       0389
         BC    04,@9F2                                            0389
*                              /**YES REINIT CTR IN CASE FIELD LENGTH**
*                              /**IS LT LENGTH REMAINING IN SEQUENCE**/
*               R7 = LTOFREE   /**REINITILIZE COUNTER**/;
         L     @1,596(0,@5)        
         LH    @7,60(0,@1)                                        0391
*               GO TO F9G5     /**BRANCH TO FILL WHOLE FIELD**/;
         BC    15,F9G5                                            0392
*         END;
*               GO TO F9E5     /**BR TO MOVE PART OF SEQUENCE**/;
*  /*******************************************************************
*  /** THIS SECTION MOVES PART OF SEQUENCE AND RESOLVES NEW ADDRESSES *
*  /** AND LENGTH.A BRANCH IS THEN TAKEN TO PICK UP SEQUENCE LENGTH IF*
*  /** AL,AN AND CO.                                                  *
*  /*******************************************************************
*  F9E4:;
*         R7 = R6;
F9E4     LR    @7,@6                                              0396
*  F9E5:;
*         CALL MOVEROUT;
F9E5     BAL   @E,MOVEROUT                                        0398
*         R8 = R8 + R7      /**RESOLVE NEW ADDRESS**/;
         AR    @8,@7                                              0399
*        COMPCTR = COMPCTR - R7 /**COMPUTE AMOUNT REMAINING TO MOVE**/;
         LCR   @F,@7                                              0400
         A     @F,616(0,@5)                                       0400
         ST    @F,616(0,@5)                                       0400
*         IF FDFORMAT = 'AL' THEN GO TO F9F4 /*BR IF AL FORMAT*/;
         L     @1,596(0,@5)        
         CLC   30(2,@1),@C15                                      0401
         BC    08,F9F4                                            0402
*         IF FDFORMAT = 'AN' THEN GO TO F9G4 /*BR IF AN FORMAT*/;
         CLC   30(2,@1),@C16                                      0403
         BC    08,F9G4                                            0404
*  /*******************************************************************
*  /** PICK UP COLLATTING SEQUENCE ADDRESS AND LENGTH                 *
*  /*******************************************************************
*         R9 = ADDR(COPAT)               /*PICK UP CO ADDRESS*/;
         LA    @9,COPAT                                           0405
*         R6 = 63                        /*RENEW CTR1*/;
         LA    @6,63                                              0406
*  F9F5:;
*  /*******************************************************************
*  /** IF LENGTH REMAING IS GT SEQUENCE LENGTH BRANCH                 *
*  /*******************************************************************
*                                        /*TEST LENGTH LEFT*/
*         IF COMPCTR > R6 THEN GO TO F9E4 /**BRANCH TO MOVE MORE**/;
F9F5     C     @6,616(0,@5)                                       0408
         BC    04,F9E4                                            0409
*                              /* THIS IS LAST MOVE TO COMPLETE FIELD*/
*         R7 = COMPCTR         /**RESOLVE LENGTH FOR LAST MOVE**/;
         L     @7,616(0,@5)                                       0410
*  /*******************************************************************
*  /**                                                                *
*  /** THIS SECTION IS LAST MOVE TO FILL FIELD                        *
*  /**                                                                *
*  /*******************************************************************
*  F9G5:;
*         CALL MOVEROUT                  /*MOVE BYTES REMAINING*/;
F9G5     BAL   @E,MOVEROUT                                        0412
*               GO TO F7H3               /*BR NOT RIPPLE*/;
         BC    15,F7H3                                            0413
*  /*******************************************************************
*  /** PICK UP ALPHABETIC SEQUENCE ADDRESS AND LENGTH AND BRANCH TO   *
*  /** TEST LENGTH REMAINING TO MOVE.                                 *
*  /*******************************************************************
*  F9F4:;
*         R9 = ADDR(ALPAT)               /*PICK UP AL ADDRESS*/;
F9F4     LA    @9,ALPAT                                           0415
*         R6 = 26                        /*RENEW CTR1*/;
         LA    @6,26                                              0416
*               GO TO F9F5               /*BR TO TEST LGTH LEFT*/;
         BC    15,F9F5                                            0417
*  /*******************************************************************
*  /** PICK UP ALPHANUMERIC SEQUENCE ADDRESS AND LENGTH AND BRANCH TO *
*  /** TEST LENGTH REMAINING TO MOVE.                                 *
*  /*******************************************************************
*  F9G4:;
*         R9 = ADDR(ALPAT)               /*PICK UP AL ADDRESS*/;
F9G4     LA    @9,ALPAT                                           0419
*         R6 = 36                        /*RENEW CTR1*/;
         LA    @6,36                                              0420
*               GO TO F9F5               /*BR TO TEST LGTH LEFT*/;
         BC    15,F9F5                                            0421
*  F10A0:;
*                         /* THIS INST MOVES PICTURE*/
*  F10A1:;
F10A0    EQU   *                                                  0423
*         GEN ( MVC 0(1,R7),0(R8));
F10A1     MVC 0(1,R7),0(R8)
         DS    0H
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION WILL PLACE THE PACKED DECIMAL PICTURE INTO THE *
*  /** FIELD.IF THE PACKED LENGTH IS GREATER THAN THE FIELD LENGTH    *
*  /** IT IS SHORTENED UNTIL IT WILL FIT IN THE FIELD.SIGN IS HONORED.*
*  /** THE FORMAT IS MADE 'PD',NUMBER ACTION SWITCH TURNED ON AND THE *
*  /** LENGTH OF THE PACKED NUMBER IS RESOLVED.                       *
*  /**                                                                *
*  /*******************************************************************
*  F10A2:;
*               FDFORMAT = 'PD' /**FORMAT MUST BE PD**/;
F10A2    L     @1,596(0,@5)        
         MVC   30(2,@1),@C14                                      0426
*               NUACTION = '1'B    /**TURN ON NUMBER ACTION SWITCH**/;
         OI    32(@1),B'00000001'                                 0427
*               R6 = FDPLGTH / 2 + 1     /*PACKED LGTH= LGTH/2 PLUS 1 *
         LH    @E,588(0,@5)                                       0428
         SRDA  @E,32                                              0428
         LA    @0,2                                               0428
         DR    @E,@0                                              0428
         AH    @F,@D7                                             0428
         LR    @6,@F                                              0428
*  /*******************************************************************
*  /**AT THIS POINT LOCATION OF PACKED NUMBER IN Q MUST BE RESOLVED ***
*  /**RECEIVING ADDRESS MUST ALSO BE RESOLVED  ************************
*  /*******************************************************************
*                         /*FROM ADDR = ADDR Q + 16 - PACKED LGTH*/
*  F10A3:;
*               R8 = ADDR(Q)             /*PICK UP Q ADDR*/;
F10A3    LA    @8,216(0,@5)                                       0430
*               R8 = R8 -R6 + 16         /*RESOLVE FROM ADDRESS*/;
         LA    @F,16                                              0431
         SR    @F,@6                                              0431
         AR    @8,@F                                              0431
*               /*TO ADDR = WKADDR PLUS FLD LGTH-PLGTH*/
*         IF R6 <= FDLGTH THEN DO /**WILL NUMBER FIT IN FIELD**/;
         L     @1,596(0,@5)        
         CH    @6,24(0,@1)                                        0432
         BC    02,@9F1                                            0432
*                                 /**YES-RESOLVE FIELD ADDRESS**/
*         R7 = GCADDR - R6 + FDLGTH /** OBTAIN WORK ADDRESS**/;
         LH    @7,24(0,@1)                                        0434
         SR    @7,@6                                              0434
         A     @7,376(0,@5)                                       0434
*               R6 = R6 - 1   /** CORRECT THE LENGTH**/;
         BCTR  @6,0                                               0435
*               GO TO F10A5    /**BRANCH TO PROCESS**/;
         BC    15,F10A5                                           0436
*         END;
*               R6 = R6 - 1    /** DECREMENT LENGTH BY ONE**/;
@9F1     BCTR  @6,0                                               0438
*               GO TO F10A3    /**BRANCH TO TRY AGAIN**/;
         BC    15,F10A3                                           0439
*  /*******************************************************************
*  /**    IF SIGN IS NEGATIVE BRANCH TO MAKE SIGN DIGIT A 'FD'.       *
*  /*******************************************************************
*  F10A5:;
*         IF FDSIGN = '-' THEN GO TO F10E3 /*BR IF NEG SIGN */;
F10A5    L     @1,596(0,@5)        
         CLI   34(@1),C'-'                                        0441
         BC    08,F10E3                                           0442
*               GO TO F10F1    /**BR SIGN NOT NEG TO INIT TO POSITIVE**
         BC    15,F10F1                                           0443
*  /*******************************************************************
*  /**    THIS SECTION MOVES NUMBER TO FD FIELD,INITILIZES THE FIELD  *
*  /** ADDRESS IN THE FD TABLE AND BRANCHES TO FREEMAIN CORE USED TO  *
*  /** HOLD PICTURE WHEN IT WAS FIRST SCANNED FROM THE CONTROL CARD.  *
*  /*******************************************************************
*  F10H2:;
*                         /* MOVE PACKED NO TO FIELD ADDR RES ABOVE*/
*         GEN ( EX R6,F10A1);
F10H2     EX R6,F10A1
         DS    0H
*               FDFROMAD = GCADDR /** INIT FD FROM ADDRESS**/;
         L     @1,596(0,@5)        
         MVC   44(4,@1),376(@5)                                   0446
*               GO TO F7G3     /** BR TO FREEMAIN AND EXIT**/;
         BC    15,F7G3                                            0447
*  /*******************************************************************
*  /**    INITILIZE SIGN DIGIT TO 'FC' AND BRANCH TO MOVE NUMBER.     *
*  /*******************************************************************
*  F10E3:;
*         QSIGN1 = 'FD'X & QSIGN1 /**CHANGE SIGN TO NEG**/;
F10E3    NI    231(@5),X'FD'                                      0449
*               GO TO F10H2              /* BR TO MOVE NUMBER*/;
         BC    15,F10H2                                           0450
*  F10F1:;
*         QSIGN1 = 'FC'X & QSIGN1 /**CHANGE SIGN TO POS**/;
F10F1    NI    231(@5),X'FC'                                      0452
*               GO TO F10H2              /*BR TO MOVE NUMBER*/;
         BC    15,F10H2                                           0453
*  /*******************************************************************
*  /**                                                                *
*  /**    THIS SECTION WILL PLACE THE REQUIRED BINARY PICTURE IN THE  *
*  /** FIELD.AS FOR A PACKED DECIMAL NUMBER THE NUMBER IS RIGHT       *
*  /** ADJUSTED IN THE FIELD.                                         *
*  /**                                                                *
*  /**    THE FORMAT IS MADE 'BI',NUMBER ACTION SWITCH TURNED ON,LGTH *
*  /** AND ADDRESSES ARE THEN PICKED UP.IF SIGN IS TO BE POSITIVE A   *
*  /** BRANCH IS TAKEN OTHER WISE THE NUMBER IS CHANGED TO NEGATIVE.  *
*  /**                                                                *
*  /*******************************************************************
*  F10A4:;
*               FDFORMAT = 'BI'  /**FORMAT MIST BE BINARY**/;
F10A4    L     @1,596(0,@5)        
         MVC   30(2,@1),@C13                                      0455
*               NUACTION = '1'B    /**TURN ON NUMBER ACTION SWITCH**/;
         OI    32(@1),B'00000001'                                 0456
*               R7 = FDPLGTH             /* PICK UP NUMBER LENGTH*/;
         LH    @7,588(0,@5)                                       0457
*               R6 = Q(1:4)    /** PICK UP BINARY NUMBER**/;
         L     @6,216(0,@5)                                       0458
*         IF FDSIGN ^= '-' THEN GO TO F10B4 /*BR TO STORE NO.NOT NEG*/;
         CLI   34(@1),C'-'                                        0459
         BC    07,F10B4                                           0460
*                         /*CHANGE SIGN TO NEG AS REQD*/
*         GEN ( LCR R6,R6);
          LCR R6,R6
         DS    0H
*  /*******************************************************************
*  /**    IF FD LENGTH IS GT 4 WE WILL RIGHT ADJUST THE NUMBER IN THE *
*  /** FIELD.                                                         *
*  /*******************************************************************
*  F10B4:;
*               Q = R6                   /* STORE BINARY NUMBER*/;
F10B4    ST    @6,@TEMP4                                          0463
         MVC   216(4,@5),@TEMP4                                   0463
         MVI   220(@5),C' '                                       0463
         MVC   221(11,@5),220(@5)                                 0463
*                         /*IF FD FIELD LENGTH IS GREATER THAN 4 WE */
*                         /*MUST RIGHT ADJUST THE NUMBER IN THE FIELD.*
*                         /*ANYTHING LESS THAN THIS WE CAN MOVE */
*                         /*DIRECTLY INTO FIELD BUT MUST TEST FO FIELF*
*                         /* LENGTH*/
*         IF FDLGTH => '0004'X THEN GO TO F10C5 /*BR EQ OR GT FDLGTH*/;
         L     @F,@X31                                            0464
         L     @1,596(0,@5)        
         CH    @F,24(0,@1)                                        0464
         BC    12,F10C5                                           0465
*         IF FDLGTH = '0003'X THEN GO TO F10E5 /*BR LENGTH EQUALS 3 */;
         L     @F,@X32                                            0466
         CH    @F,24(0,@1)                                        0466
         BC    08,F10E5                                           0467
*         IF FDLGTH = '0002'X THEN GO TO F10G5 /*BR LENGTH EQUALS 2 */;
         L     @F,@X33                                            0468
         CH    @F,24(0,@1)                                        0468
         BC    08,F10G5                                           0469
*  /*******************************************************************
*  /**    HERE LENGTH EQUALS ONE,THE FROM AND TOO ADDRESSES ARE       *
*  /** RESOLVED AND A BRANCH TAKEN TO MOVE THE NUMBER.                *
*  /*******************************************************************
*               R6 = 0         /** LENGTH TO MOVE EQUALS ONE**/;
         SR    @6,@6                                              0470
*               R8 = ADDR(Q) + 3         /*RESOLVE FROM ADDRESS*/;
         LA    @8,219(0,@5)                                       0471
*         R7 = GCADDR + FDLGTH - 1 /** RESOLVE TOO ADDRESS**/;
         LH    @7,@D1                                             0472
         AH    @7,24(0,@1)                                        0472
         A     @7,376(0,@5)                                       0472
*               GO TO F10H2              /*BR TO MOVE NUMBER*/;
         BC    15,F10H2                                           0473
*  /*******************************************************************
*  /**    HERE THE LENGTH IS FOUR OR GREATER,ADDRESSES AND LENGTH IS  *
*  /** RESOLVED AND A BRANCH IS TAKEN TO MOVE THE NUMBER.             *
*  /*******************************************************************
*  F10C5:;
*                         /*RESOLVE ADDRESS LGTH EQ OR GR THAN 4*/
*         R7 = GCADDR + FDLGTH - 4 /** RESOLVE TOO ADDRESS**/;
F10C5    LH    @7,@D8                                             0475
         L     @1,596(0,@5)        
         AH    @7,24(0,@1)                                        0475
         A     @7,376(0,@5)                                       0475
*                                        /*FIELD LENGTH MINUS 4 */
*                         /* FROM ADDRESS = ADDRESS Q*/
*               R8 = ADDR(Q)   /** RESOLVE FROM ADDRESS**/;
         LA    @8,216(0,@5)                                       0476
*               R6 = 3         /** LENGTH TO MOVE EQUALS FOUR**/;
         LA    @6,3                                               0477
*               GO TO F10H2              /*BR TO MOVE LENGTH*/;
         BC    15,F10H2                                           0478
*  /*******************************************************************
*  /**    HERE LENGTH EQUALS THREE,ADDRESSES ARE RESOLVED AND A BRANCH*
*  /** TAKEN TO MOVE THE NUMBER.                                      *
*  /*******************************************************************
*  F10E5:;
*                         /*FROM ADDRESS = Q ADDRESS+ 1 */
*               R8 = ADDR(Q) + 1         /* RESOLVE FROM ADDRESS*/;
F10E5    LA    @8,217(0,@5)                                       0480
*                             /*         */
*         R7 = GCADDR + FDLGTH - 3 /** RESOLVE TOO ADDRESS**/;
         LH    @7,@D9                                             0481
         L     @1,596(0,@5)        
         AH    @7,24(0,@1)                                        0481
         A     @7,376(0,@5)                                       0481
*               R6 = 2         /** LENGTH TO MOVE EQUALS THREE**/;
         LA    @6,2                                               0482
*               GO TO F10H2              /*BR TO MOVE LENGTH*/;
         BC    15,F10H2                                           0483
*  /*******************************************************************
*  /**    HERE LENGTH EQUALS TWO,ADDRESSES ARE RESOLVED AND A BRANCH  *
*  /** TAKEN TO MOVE THE NUMBER.                                      *
*  /*******************************************************************
*  F10G5:;
*                         /*FROM ADDRESS = Q ADDRESS + 2 */
*               R8 = ADDR(Q) + 2         /*RESOLVE FROM ADDRESS*/;
F10G5    LA    @8,218(0,@5)                                       0485
*         R7 = GCADDR + FDLGTH - 2 /** RESOLVE TOO ADDRESS**/;
         LH    @7,@D6                                             0486
         L     @1,596(0,@5)        
         AH    @7,24(0,@1)                                        0486
         A     @7,376(0,@5)                                       0486
*               R6 = 1         /** LENGTH TO MOVE EQUALS TWO**/;
         LA    @6,1                                               0487
*               GO TO F10H2              /*BR TO MOVE NUMBER*/;
         BC    15,F10H2                                           0488
*  /******************************************************************/
*  /**                                                               **
*  /** THIS SECTION CONSISTING OF THREE LABELS WHICH ARE BRANCHED TO  *
*  /** FOR EXITING FROM THIS ROUTINE WHEN RETURN OF CONTROL IS NOT    *
*  /** REQUIRED.A BRANCH TO F1B41 CAUSES ALL FD SWITCHES TO BE TURNED**
*  /** OFF AND A NORMAL RETURN TO THE BASE MODULE.A BRANCH TO F1B411  *
*  /** CAUSES THE EPSW TO BE SET TO ONE(INDICATES NEED FOR MESSAGE)   *
*  /** SWITCHES OFF AND RETURN.A BRANCH TO F1B4 CAUSES FLAGSW(1) TO   *
*  /** BE SET INDICATING A NEED FOR ERROR FLAGGING A MESSAGE.EPSW IS  *
*  /** THEN SET,SWITCHES TURNED OFF AND A RETURN ISSUED.THUS F1B41    *
*  /** IS FOR A NORMAL RETURN.F1B411 INDICATES NEED FOR A MESSAGE AND *
*  /** RETURN.F1B4 INDICATES ERROR FLAGGING,MESSAGE AND RETURN.       *
*  /**                                                               **
*  /******************************************************************/
*  F1B4:;
*               FLAGSW(1) = '1'B         /*INDICATE ERROR FLAG WANTED*/
F1B4     OI    566(@5),B'10000000'                                0490
*  F1B411:;
*               EPSW = 1        /*INDICATE NEED FOR MESSAGE */;
F1B411   MVI   568(@5),1                                          0492
*  F1B41:;
*               SWITCH(1) = OFF          /**TURN OFF FIRST FD SWITCH**/
F1B41    MVC   536(1,@5),OFF                                      0494
*         SWITCH(2:14) = SWITCH(1:13) /** TURN OFF FD SWITCHES**/;
         MVC   537(13,@5),536(@5)                                 0495
*               RETURN;
*  SCANOUT: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);
@EL01    L     @D,4(0,@D)                                         0497
         LR    @1,@C                                              0497
         L     @0,@SIZ001                                         0497
         FREEMAIN R,LV=(0),A=(1)                                  0497
         L     @E,12(0,@D)                                        0497
         LM    @0,@8,20(@D)                                       0497
         LM    @A,@C,60(@D)                                       0497
         BCR   15,@E                                              0497
SCANOUT  EQU   *                                                  0497
*                              /***************************************
*                              /** THIS PROCEDURE WILL FIND THE LGTH **
*                              /** OF THE PARAMETER FOLLOWING THE    **
*                              /** EQUAL SIGN.UPON ENTRY REG 9 SHOULD**
*                              /** BE POINTING AT START OF PARAMETER **
*                              /** UPON EXIT REGISTERS ARE AS FOLLOWS**
*                              /**                                   **
*                              /** REG  7  EQUALS LENGTH OF PARA     **
*                              /** REG  8  COMMA OR BLANK AFTER PARA **
*                              /** REG  9  START OF PARAMETER        **
*                              /**                                   **
*                              /***************************************
*               R8 = R9                  /*COPY SCAN POINTER */;
         LR    @8,@9                                              0498
*  SCANOUT1:;
*  /*                                                        */
*       IF R8 -> INBUF(1) = ',' THEN GO TO SCANOUT2 /*BR IF COMMA*/;
SCANOUT1 CLI   0(@8),C','                                         0500
         BC    08,SCANOUT2                                        0501
*       IF R8 -> INBUF(1) = ' ' THEN GO TO SCANOUT2 /*BR IF BLANK*/;
         CLI   0(@8),C' '                                         0502
         BC    08,SCANOUT2                                        0503
*         R8 = R8 + 1                    /*INC PTR BY ONE*/;
         AH    @8,@D7                                             0504
*         IF R8 < COUNTER THEN GO TO SCANOUT1 /**BR NOT IN COL 72    **
         C     @8,232(0,@5)                                       0505
         BC    04,SCANOUT1                                        0506
*               MS  =  21                       /** INDICATE MESSAGE **
         LA    @F,21                                              0507
         STH   @F,406(0,@5)                                       0507
*               GO TO F1B411   /** BRANCH TO LEAVE ROUTINE**/;
         BC    15,F1B411                                          0508
*  /*                                                        */
*  SCANOUT2:;
*               /* R8 SHOULD BE POINTING AT BLANK OR COMMA*/
*               R7 = R8 - R9           /** CALCULATE PARAMETER LENGTH**
SCANOUT2 LCR   @7,@9                                              0510
         AR    @7,@8                                              0510
*         IF R7 = 0 THEN DO    /**BR WHEN LENGTH IS NOT EQUAL TO ZERO**
         LTR   @7,@7                                              0511
         BC    07,@9F0                                            0511
*               MS = 3         /** INDICATE MESSAGE**/;
         LA    @F,3                                               0513
         STH   @F,406(0,@5)                                       0513
*               GO TO F1B411   /** BRANCH TO LEAVE ROUTINE**/;
         BC    15,F1B411                                          0514
*         END;
*                              /** LGTH GT EIGHT- NAME IS TOO LONG   **
*         IF R7 > 8 THEN DO    /** BR IF LENGTH LT,EQ TO 8           **
@9F0     CH    @7,@D10                                            0516
         BC    12,@9EF                                            0516
*               MS  =  3                 /** INDICATE MESSAGE        **
         LA    @F,3                                               0518
         STH   @F,406(0,@5)                                       0518
*               GO TO F1B411   /** BRANCH TO LEAVE ROUTINE**/;
         BC    15,F1B411                                          0519
*         END;
*               RETURN    /* RETURN TO CALLER WITH REGISTERS SET*/;
*  END SCANOUT;
@EL02    BCR   15,@E                                              0522
*  /*                                    */
*  /*******************************************************************
*  /**                                                                *
*  /** THIS PROCEDURE WILL CONVERT AN EBCDIC NUMBER FROM THE INPUT    *
*  /** WORKAREA TO BINARY.THE NUMBER IS TESTED BEFORE CONVERSION FOR  *
*  /** 2147483647.THE LARGEST BINARY NUMBER A REGISTER CAN CONTAIN IS *
*  /** THIS NUMBER.THIS NUMBER MUST BE VALIDITY CHECKED BEFORE ENTRY  *
*  /** TO THIS ROUTINE OR THE CVB INSTRUCTION MAY FAIL.               *
*  /** UPON ENTRY REG 9 POINTS AT START OF EBCDIC NUMBER IN INBUF     *
*  /** UPON ENTRY REG 7 CONTAINS LENGTH OF NUMBER                     *
*  /** UPON EXIT REG9 AND REG7 ARE NOT CHANGED                        *
*  /** REG 6 CONTAINS THE BINARY EQUIVALENT OF NUMBER                 *
*  /** IF RANGESW IS NOT ON THE NUMBER IS TESTED FOR BEING LARGER THAN*
*  /** 32767 THE MAXIMUM VALUE ALLOWED FOR LRECL.                     *
*  /**                                                                *
*  /*******************************************************************
*  CONVB: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);
*                                   /*SAVE REG 14 IN COMMON AREA. */
*            SAVE14 = R14;
CONVB    ST    @E,360(0,@5)                                       0524
*               R6 = R7 - 1    /**CORRECT THE VALUE IN THE REGISTER**/;
         LH    @6,@D1                                             0525
         AR    @6,@7                                              0525
*                              /**PACK THE NUMBER IN Q AREA **/
*         GEN ( EX R6,CONVBP);
          EX R6,CONVBP
         DS    0H
*                              /**TEST FOR NUMBER BEING LARGER THEN**/
*                              /**2147483647 AND BRANCH IF NOT SO **/
*         IF Q(1:8) > '000002147483647F'X THEN DO /*BR IF NUMBER OK*/;
         CLC   216(8,@5),@X36                                     0527
*               GO TO CONVB1             /*BRANCH TO SET MSG*/;
         BC    03,CONVB1                                          0529
*         END;
*           GEN ( CVB R6,Q(0,R5));
@9EE     EQU   *                                                  0531
          CVB R6,Q(0,R5)
         DS    0H
*         IF RANGESW = ON THEN DO /** IF RANGESW ON DO BELOW**/;
         CLC   541(1,@5),ON                                       0532
         BC    07,@9ED                                            0532
*               RANGESW = OFF  /**TURN OFF RANGE SW**/;
         MVC   541(1,@5),OFF                                      0534
*               RETURN;
         BC    15,@EL03                                           0535
*         END;
*         IF R6 <= 32767 THEN DO     /** BRANCH IF LARGER THAN 32767**/
@9ED     CH    @6,@D11                                            0537
         BC    02,@9EC                                            0537
*                                   /*RESTORE REG 14 FROM COMMON AREA.
*            R14 = SAVE14;
         L     @E,360(0,@5)                                       0539
*               RETURN                   /*RETURN TO CALLER*/;
         BC    15,@EL03                                           0540
*         END;
*  CONVB1:;
@9EC     EQU   *                                                  0542
*               MS = 6                   /*INDICATE MSG*/;
CONVB1   LA    @F,6                                               0543
         STH   @F,406(0,@5)                                       0543
*               GO TO F1B411   /** BRANCH TO LEAVE ROUTINE**/;
         BC    15,F1B411                                          0544
*  CONVBP: GEN ( PACK Q(8,R5),0(1,R9));
CONVBP    PACK Q(8,R5),0(1,R9)
         DS    0H
*  END CONVB;
@EL03    BCR   15,@E                                              0546
*  /*******************************************************************
*  /**                                                                *
*  /** THIS PROCEDURE WILL MOVE ANY NUMBER OF CHARACTERS FOR THE      *
*  /** CALLER.EXPECTED CONTENTS OF REGISTERS UPON ENTRY ARE:          *
*  /** REG 9 = FROM ADDRESS                                           *
*  /** REG 8 = TO ADDRESS                                             *
*  /** REG 7 = LENGTH TO MOVE                                         *
*  /** REGISTER CONTENTS ARE DESTROYED UPON EXIT IF MOVE IS GT 256    *
*  /**                                                                *
*  /*******************************************************************
*  MOVEROUT: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);
MOVEROUT EQU   *                                                  0547
*  MOVE1:;
*         IF R7 = 0 THEN RETURN          /** RETURN IF ZERO LENGTH   **
MOVE1    LTR   @7,@7                                              0549
         BC    08,@EL04                                           0550
*         IF R7 < 256 THEN GO TO MOVE5   /** BR IF LT 256 TO MOVE    **
@9EB     CH    @7,@D3                                             0551
         BC    04,MOVE5                                           0552
*                                        /*MOVES 256 BYTES*/
*         GEN (MVC 0(256,R8),0(R9));
         MVC 0(256,R8),0(R9)
         DS    0H
*               R9 = R9 + 256            /*ADD 256 TO POSITION ADDR*/;
         AH    @9,@D3                                             0554
*               R8 = R8 + 256            /*ADD 256 TO POSITION ADDR*/;
         AH    @8,@D3                                             0555
*               R7 = R7 - 256            /*SUBT 256 TO CORRECT LENGTH*/
         SH    @7,@D3                                             0556
*          GO TO MOVE1                   /*BR TO CONTINUE PROCESSING*/;
         BC    15,MOVE1                                           0557
*  MOVE4 :;
*                                        /*MOVE REMAINING BYTES*/
*         GEN ( MVC 0(1,R8),0(R9));
MOVE4     MVC 0(1,R8),0(R9)
         DS    0H
*  MOVE5:;
*               R7 = R7 - 1              /*CORRECT THE LENGTH*/;
MOVE5    BCTR  @7,0                                               0561
*         GEN ( EX R7,MOVE4);
          EX R7,MOVE4
         DS    0H
*               R7 = R7 + 1 /**RESTORE REG 7 FOR EXIT WHEN LT 256 **/;
         AH    @7,@D7                                             0563
*               RETURN                   /*RETURN TO CALLER */;
*  END MOVEROUT;
@EL04    BCR   15,@E                                              0565
*  /*******************************************************************
*  /**                                                                *
*  /** THIS PROCEDURE WILL VALIDITY CHECK AN EBCDIC NUMBER AS IT IS   *
*  /** INPUT FROM THE CONTROL CARD.UPON ENTRY REG 9 SHOULD POINT AT   *
*  /** START OF NUMBER IN INBUF.REG 7 SHOULD CONTAIN LENGTH OF NUMBER**
*  /** A WORKAREA IS CLEARED TO BINARY ZERO AND ZONES FROM THE NUMBER *
*  /** ARE MOVED TO THE WORKAREA.A COMPARE IS THEN DONE AGAINST       *
*  /** FOXZEROEZ.IF ALL DIGITS DO NOT COMPARE THE NUMBER IS INVALID   *
*  /** AND A BRANCH IS TAKEN TO SET UP MESSAGE AND RETURN,OTHERWISE   *
*  /** RETURN IS TO THE CALLER.                                       *
*  /**                                                                *
*  /*******************************************************************
*  VALCHECK: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);
*                                   /*SAVE REG 14 IN COMMON AREA. */
*            SAVE14 = R14;
VALCHECK ST    @E,360(0,@5)                                       0567
*         R8 = R9 + R7 - 1              /**POINT AT END OF NUMBER**/;
         LH    @8,@D1                                             0568
         AR    @8,@7                                              0568
         AR    @8,@9                                              0568
*  VALCK1:;                             /** TEST ZONE FOR 'F' **/
*   GEN ( TM 0(R8),X'F0');
VALCK1    TM 0(R8),X'F0'
         DS    0H
*                                       /**BRANCH TO ISSUE MESSAGE 3
*                                          IF ZONE NOT 'F'       **/
*   GEN ( BC    14,MS3 );
          BC    14,MS3
         DS    0H
*         IF R8 ^= R9 THEN DO           /**DO BELOW IF R8 NOT EQ R9**/;
         CR    @8,@9                                              0572
         BC    08,@9EA                                            0572
*               R8 = R8 - 1             /**SUBT ONE FROM R8 **/;
         BCTR  @8,0                                               0574
*         GO TO VALCK1                  /** BR TO TEST NEXT ZONE**/;
         BC    15,VALCK1                                          0575
*  MS3:;
*         MS = 3                        /**INDICATE MESSAGE 3 **/;
MS3      LA    @F,3                                               0577
         STH   @F,406(0,@5)                                       0577
*         GO TO F1B411                  /** BR TO LEAVE ROUTINE**/;
         BC    15,F1B411                                          0578
*         END;
*                                   /*RESTORE REG 14 FROM COMMON AREA.
*            R14 = SAVE14;
@9EA     L     @E,360(0,@5)                                       0580
*                              /* RETURN TO CALLER*/
*               RETURN;
*    END VALCHECK;
@EL05    BCR   15,@E                                              0582
*         END IEBFDTBL;
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D4      DC    F'524293'
@D5      DC    F'-1'
@D1      DC    H'-1'
@D2      DC    H'3'
@D3      DC    H'256'
@D6      DC    H'-2'
@D7      DC    H'1'
@D8      DC    H'-4'
@D9      DC    H'-3'
@D10     DC    H'8'
@D11     DC    H'32767'
@MVC     MVC   0(1,@A),0(@E)
         DS    0F
@SIZ001  DC    AL1(&SPN)
         DC    AL3(@DATEND-@DATD)
         DS    0F
@X18     DC    X'0000001A'
@X19     DC    X'00000024'
@X20     DC    X'0000003F'
@X31     DC    X'00000004'
@X32     DC    X'00000003'
@X33     DC    X'00000002'
@X36     DC    X'000002147483647F'
@C1      DC    C'FX'
@C2      DC    C'RA'
@C3      DC    C'SL'
@C4      DC    C'TL'
@C5      DC    C'SR'
@C6      DC    C'TR'
@X8      DC    X'0000'
@C9      DC    C'RP'
@C10     DC    C'RO'
@C11     DC    C'WV'
@C13     DC    C'BI'
@C14     DC    C'PD'
@C15     DC    C'AL'
@C16     DC    C'AN'
@C17     DC    C'CO'
@C22     DC    C'ZD'
         DS    0D
@DATA    EQU   *
R14      EQU   00000014            FULLWORD INTEGER REGISTER
R15      EQU   00000015            FULLWORD INTEGER REGISTER
R0       EQU   00000000            FULLWORD INTEGER REGISTER
R1       EQU   00000001            FULLWORD INTEGER REGISTER
R2       EQU   00000002            FULLWORD INTEGER REGISTER
R3       EQU   00000003            FULLWORD INTEGER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
R6       EQU   00000006            FULLWORD POINTER REGISTER
R7       EQU   00000007            FULLWORD POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
R9       EQU   00000009            FULLWORD POINTER REGISTER
COMMON   EQU   00000000            308 BYTE(S) ON DWORD
PAGENO   EQU   COMMON+00000000     4 BYTE(S)
LINECT   EQU   COMMON+00000004     FULLWORD INTEGER
LINECTR  EQU   COMMON+00000008     FULLWORD INTEGER
PARM     EQU   COMMON+00000012     FULLWORD POINTER
REPEATNO EQU   COMMON+00000016     HALFWORD INTEGER
CREATENO EQU   COMMON+00000018     HALFWORD INTEGER
SYSP     EQU   COMMON+00000020     96 BYTE(S)
SYSI     EQU   COMMON+00000116     96 BYTE(S)
Q        EQU   COMMON+00000216     16 BYTE(S) ON DWORD
QFILL    EQU   COMMON+00000216     7 BYTE(S)
QSIGN    EQU   COMMON+00000223     8 BIT(S)
QFILL1   EQU   COMMON+00000224     7 BYTE(S)
QSIGN1   EQU   COMMON+00000231     8 BIT(S)
COUNTER  EQU   COMMON+00000232     FULLWORD POINTER
OPENLIST EQU   COMMON+00000236     8 BYTE(S)
OPTBYTE1 EQU   COMMON+00000236     4 BYTE(S)
OPTBYTE2 EQU   COMMON+00000240     4 BYTE(S)
EXLST    EQU   COMMON+00000244     24 BYTE(S) ON WORD
INHDR    EQU   COMMON+00000244     1 BYTE(S)
INHDR1   EQU   COMMON+00000245     3  BYTE  POINTER ON WORD+1
OUTHDR   EQU   COMMON+00000248     1 BYTE(S)
OUTHDR1  EQU   COMMON+00000249     3  BYTE  POINTER ON WORD+1
INTRL    EQU   COMMON+00000252     1 BYTE(S)
INTRL1   EQU   COMMON+00000253     3  BYTE  POINTER ON WORD+1
OUTTRL   EQU   COMMON+00000256     1 BYTE(S)
OUTTRL1  EQU   COMMON+00000257     3  BYTE  POINTER ON WORD+1
EXITDCB  EQU   COMMON+00000260     1 BYTE(S)
EXITDCB1 EQU   COMMON+00000261     3  BYTE  POINTER ON WORD+1
TOTAL    EQU   COMMON+00000264     1 BYTE(S)
TOTAL1   EQU   COMMON+00000265     3  BYTE  POINTER ON WORD+1
EXLST1   EQU   COMMON+00000268     4 BYTE(S) ON WORD
EDCB1    EQU   COMMON+00000268     1 BYTE(S)
EDCB2    EQU   COMMON+00000269     3  BYTE  POINTER ON WORD+1
EXLST2   EQU   COMMON+00000272     4 BYTE(S) ON WORD
EDCB3    EQU   COMMON+00000272     1 BYTE(S)
EDCB4    EQU   COMMON+00000273     3  BYTE  POINTER ON WORD+1
EXLST3   EQU   COMMON+00000276     4 BYTE(S) ON WORD
EDCB5    EQU   COMMON+00000276     1 BYTE(S)
EDCB6    EQU   COMMON+00000277     3  BYTE  POINTER ON WORD+1
DLRECL   EQU   COMMON+00000280     HALFWORD INTEGER
DBLKSI   EQU   COMMON+00000282     HALFWORD INTEGER
DRECFM   EQU   COMMON+00000284     8 BIT(S)
LEFTOVER EQU   COMMON+00000288     FULLWORD INTEGER
OFFSET   EQU   COMMON+00000292     FULLWORD POINTER
LPTR     EQU   COMMON+00000296     FULLWORD POINTER
DCBPTR   EQU   COMMON+00000300     FULLWORD POINTER
DUMMY    EQU   COMMON+00000304     FULLWORD POINTER
COMMON1  EQU   00000304            236 BYTE(S) ON WORD
SAVEMS   EQU   COMMON1+00000000    HALFWORD INTEGER
CONCODE  EQU   COMMON1+00000002    HALFWORD INTEGER
OUTREC   EQU   COMMON1+00000004    FULLWORD POINTER
CRTABPT  EQU   COMMON1+00000008    FULLWORD POINTER
CURCRTE  EQU   COMMON1+00000012    FULLWORD POINTER
CURCRGM  EQU   COMMON1+00000016    FULLWORD POINTER
CURPIC   EQU   COMMON1+00000020    FULLWORD POINTER
PICCTR   EQU   COMMON1+00000024    FULLWORD INTEGER
EXITTAB  EQU   COMMON1+00000028    FULLWORD POINTER
EXITGM   EQU   COMMON1+00000032    FULLWORD POINTER
CUREXIT  EQU   COMMON1+00000036    FULLWORD POINTER
DELIM    EQU   COMMON1+00000040    4 BYTE(S)
RECREM   EQU   COMMON1+00000044    FULLWORD INTEGER
CURFD    EQU   COMMON1+00000048    FULLWORD POINTER
CUROUT   EQU   COMMON1+00000052    FULLWORD POINTER
SAVE14   EQU   COMMON1+00000056    FULLWORD POINTER
GETMLIST EQU   COMMON1+00000060    16 BYTE(S) ON WORD
GLENGTH  EQU   COMMON1+00000060    FULLWORD INTEGER
ADRLIST  EQU   COMMON1+00000064    FULLWORD POINTER
IND      EQU   COMMON1+00000068    4 BYTE(S)
GCODE    EQU   COMMON1+00000068    1 BYTE(S)
SPOOL    EQU   COMMON1+00000069    1 BYTE(S)
CCODE    EQU   COMMON1+00000070    2 BYTE(S)
GCADDR   EQU   COMMON1+00000072    FULLWORD POINTER
FIRSTGMO EQU   COMMON1+00000076    FULLWORD POINTER
CURRGMO  EQU   COMMON1+00000080    FULLWORD POINTER
LASTGMO  EQU   COMMON1+00000084    FULLWORD POINTER
FIRSTGMI EQU   COMMON1+00000088    FULLWORD POINTER
CURRGMI  EQU   COMMON1+00000092    FULLWORD POINTER
LASTGMI  EQU   COMMON1+00000096    FULLWORD POINTER
CONDCODE EQU   COMMON1+00000100    HALFWORD INTEGER
MS       EQU   COMMON1+00000102    HALFWORD INTEGER
INBUFA1  EQU   COMMON1+00000104    121 BYTE(S)
INFILL   EQU   COMMON1+00000104    10 BYTE(S)
INBUFA   EQU   COMMON1+00000114    111 BYTE(S)
DDPTR    EQU   COMMON1+00000228    FULLWORD POINTER
DUMMY1   EQU   COMMON1+00000232    FULLWORD POINTER
COMMON2  EQU   00000536            76 BYTE(S) ON WORD
SWITCH   EQU   COMMON2+00000000    52 BYTE(S)
FDCSW    EQU   COMMON2+00000000    1 BYTE(S)
FDNAMESW EQU   COMMON2+00000001    1 BYTE(S)
FDPCSW   EQU   COMMON2+00000002    1 BYTE(S)
FDFMTSW  EQU   COMMON2+00000003    1 BYTE(S)
FDPLSW   EQU   COMMON2+00000004    1 BYTE(S)
RANGESW  EQU   COMMON2+00000005    1 BYTE(S)
FILLSW   EQU   COMMON2+00000006    1 BYTE(S)
REPSW    EQU   COMMON2+00000007    1 BYTE(S)
INDEXSW  EQU   COMMON2+00000008    1 BYTE(S)
INDNMSW  EQU   COMMON2+00000009    1 BYTE(S)
BQUOTESW EQU   COMMON2+00000010    1 BYTE(S)
PQUOTESW EQU   COMMON2+00000011    1 BYTE(S)
EQUOTESW EQU   COMMON2+00000012    1 BYTE(S)
FDSW     EQU   COMMON2+00000013    1 BYTE(S)
DSDSW    EQU   COMMON2+00000014    1 BYTE(S)
NOGOSW   EQU   COMMON2+00000015    1 BYTE(S)
CREATESW EQU   COMMON2+00000016    1 BYTE(S)
DSDCSW   EQU   COMMON2+00000017    1 BYTE(S)
CRCSW    EQU   COMMON2+00000018    1 BYTE(S)
EXITSW   EQU   COMMON2+00000019    1 BYTE(S)
EODSTOP  EQU   COMMON2+00000020    1 BYTE(S)
DSDNULSW EQU   COMMON2+00000021    1 BYTE(S)
DSDORGSW EQU   COMMON2+00000022    1 BYTE(S)
DSDDDSW  EQU   COMMON2+00000023    1 BYTE(S)
CRTBLK   EQU   COMMON2+00000024    1 BYTE(S)
NAMCSW   EQU   COMMON2+00000025    8 BIT(S)
PICCSW   EQU   COMMON2+00000026    8 BIT(S)
BUFPSW   EQU   COMMON2+00000027    1 BYTE(S)
ENDSW    EQU   COMMON2+00000028    1 BYTE(S)
COMCSW   EQU   COMMON2+00000029    1 BYTE(S)
FLAGSW   EQU   COMMON2+00000030    8 BIT(S)
PAGESW   EQU   COMMON2+00000031    1 BYTE(S)
EPSW     EQU   COMMON2+00000032    1  BYTE  POINTER
SYSISW   EQU   COMMON2+00000033    1 BYTE(S)
SYSPSW   EQU   COMMON2+00000034    1 BYTE(S)
OLDNEWSW EQU   COMMON2+00000035    1 BYTE(S)
FLUSHSW  EQU   COMMON2+00000036    1 BYTE(S)
FLUSHSW1 EQU   COMMON2+00000037    1 BYTE(S)
DSDOSW   EQU   COMMON2+00000038    1 BYTE(S)
DSDISW   EQU   COMMON2+00000039    1 BYTE(S)
QUANSW   EQU   COMMON2+00000040    1 BYTE(S)
PARENSW  EQU   COMMON2+00000041    1 BYTE(S)
REPEATSW EQU   COMMON2+00000042    1 BYTE(S)
FDPLGTH  EQU   COMMON2+00000052    HALFWORD INTEGER
SGCADDR  EQU   COMMON2+00000056    FULLWORD POINTER
FDPTR    EQU   COMMON2+00000060    FULLWORD POINTER
FDPTR1   EQU   COMMON2+00000064    FULLWORD POINTER
FDPTR2   EQU   COMMON2+00000068    FULLWORD POINTER
DUMMY2   EQU   COMMON2+00000072    FULLWORD POINTER
COMMON3  EQU   00000608            188 BYTE(S) ON WORD
FDCTR    EQU   COMMON3+00000000    HALFWORD POINTER
LREMAIN  EQU   COMMON3+00000004    FULLWORD POINTER
COMPCTR  EQU   COMMON3+00000008    FULLWORD POINTER
LMOVED   EQU   COMMON3+00000012    HALFWORD POINTER
U        EQU   COMMON3+00000016    FULLWORD POINTER
PICEND   EQU   COMMON3+00000020    HALFWORD POINTER
CURFDGM  EQU   COMMON3+00000024    FULLWORD POINTER
SWTCH    EQU   COMMON3+00000028    4 BYTE(S) ON WORD
SYSINSEL EQU   COMMON3+00000028    1 BYTE(S)
FIRSTSW  EQU   COMMON3+00000029    1 BYTE(S)
FRSTSW   EQU   COMMON3+00000030    1 BYTE(S)
STOPSW   EQU   COMMON3+00000031    1 BYTE(S)
COPYVAL  EQU   COMMON3+00000032    HALFWORD INTEGER
COPYFD   EQU   COMMON3+00000036    FULLWORD POINTER
COPYFDGM EQU   COMMON3+00000040    FULLWORD POINTER
NAMCTR   EQU   COMMON3+00000044    HALFWORD INTEGER
NAMCTR1  EQU   COMMON3+00000046    HALFWORD INTEGER
INRECSZ  EQU   COMMON3+00000048    HALFWORD POINTER
OUTRECSZ EQU   COMMON3+00000050    HALFWORD POINTER
INRECFM  EQU   COMMON3+00000052    1 BYTE(S)
RECOFFST EQU   COMMON3+00000053    1  BYTE  POINTER
OUTRECFM EQU   COMMON3+00000054    1 BYTE(S)
PICBASE  EQU   COMMON3+00000056    FULLWORD POINTER
MESSAGE  EQU   COMMON3+00000060    121 BYTE(S)
DUMMY3   EQU   COMMON3+00000184    FULLWORD POINTER
DCBD     EQU   00000000            280 BYTE(S) ON DWORD
FILL     EQU   DCBD+00000000       26 BYTE(S)
DSORG1   EQU   DCBD+00000026       2 BYTE(S)
DSORG    EQU   DCBD+00000026       8 BIT(S)
FILLER   EQU   DCBD+00000028       8 BYTE(S)
IOBAD    EQU   DCBD+00000028       4 BYTE(S)
BFTEK    EQU   DCBD+00000032       8 BIT(S)
EODAD    EQU   DCBD+00000033       3 BYTE(S)
RECFM    EQU   DCBD+00000036       8 BIT(S)
EXLIST   EQU   DCBD+00000037       3  BYTE  POINTER ON WORD+1
DDNAME   EQU   DCBD+00000040       8 BYTE(S)
DEBAD    EQU   DCBD+00000040       4 BYTE(S)
IFLGS    EQU   DCBD+00000040       8 BIT(S)
GETAD    EQU   DCBD+00000048       4 BYTE(S)
OFLGS    EQU   DCBD+00000048       8 BIT(S)
OFLGS1   EQU   DCBD+00000049       1 BYTE(S)
MACRF    EQU   DCBD+00000050       2 BYTE(S)
FILL2    EQU   DCBD+00000052       10 BYTE(S)
BLKSI    EQU   DCBD+00000062       HALFWORD INTEGER
FILL3    EQU   DCBD+00000064       18 BYTE(S)
LRECL    EQU   DCBD+00000082       HALFWORD INTEGER
FILL4    EQU   DCBD+00000084       172 BYTE(S)
NEXTDCB  EQU   DCBD+00000256       FULLWORD POINTER
DDNAME1  EQU   DCBD+00000260       8 BYTE(S)
EODSW    EQU   DCBD+00000268       1 BYTE(S)
DCBSW1   EQU   DCBD+00000269       1 BYTE(S)
DCBSW2   EQU   DCBD+00000270       1 BYTE(S)
DCBSW3   EQU   DCBD+00000271       8 BIT(S)
INREC    EQU   DCBD+00000272       FULLWORD POINTER
GMLGTH   EQU   DCBD+00000276       HALFWORD INTEGER
FIELDSEL EQU   DCBD+00000278       1 BYTE(S)
SPARE    EQU   DCBD+00000279       1 BYTE(S)
FDTBL    EQU   00000000            520 BYTE(S) ON WORD
FDNAME   EQU   FDTBL+00000000      8 BYTE(S)
FDREPNM  EQU   FDTBL+00000008      8 BYTE(S)
FDINDNM  EQU   FDTBL+00000016      8 BYTE(S) ON WORD
FDUMMY   EQU   FDTBL+00000016      4 BYTE(S)
FDINDNUM EQU   FDTBL+00000020      FULLWORD POINTER
FDLGTH   EQU   FDTBL+00000024      HALFWORD POINTER
FDCYCLE  EQU   FDTBL+00000026      HALFWORD POINTER
FDACTION EQU   FDTBL+00000028      2 BYTE(S)
FDFORMAT EQU   FDTBL+00000030      2 BYTE(S)
FDSWITCH EQU   FDTBL+00000032      8 BIT(S)
INDBYNAM EQU   FDTBL+00000032      1 BIT(S)
PASS     EQU   FDTBL+00000032      1 BIT(S)
FXACTION EQU   FDTBL+00000032      1 BIT(S)
RPACTION EQU   FDTBL+00000032      1 BIT(S)
ROACTION EQU   FDTBL+00000032      1 BIT(S)
WVACTION EQU   FDTBL+00000032      1 BIT(S)
STACTION EQU   FDTBL+00000032      1 BIT(S)
NUACTION EQU   FDTBL+00000032      1 BIT(S)
FDFILL   EQU   FDTBL+00000033      1 BYTE(S)
FDSIGN   EQU   FDTBL+00000034      1 BYTE(S)
FDCHAR   EQU   FDTBL+00000035      1 BYTE(S)
FDRANGE  EQU   FDTBL+00000036      4 BYTE(S)
FDOBUF   EQU   FDTBL+00000040      HALFWORD POINTER
FDFRINC  EQU   FDTBL+00000042      HALFWORD POINTER
FDFROMAD EQU   FDTBL+00000044      4 BYTE(S)
FDMLGTH  EQU   FDTBL+00000048      HALFWORD POINTER
FDTOINC  EQU   FDTBL+00000050      HALFWORD POINTER
FDCYCCNT EQU   FDTBL+00000052      HALFWORD POINTER
FDSLGTH  EQU   FDTBL+00000054      HALFWORD POINTER
FDSLGTHR EQU   FDTBL+00000056      HALFWORD POINTER
FDFRINCR EQU   FDTBL+00000058      1 BYTE(S)
FDTOINCR EQU   FDTBL+00000059      1 BYTE(S)
LTOFREE  EQU   FDTBL+00000060      HALFWORD POINTER
FDSW1    EQU   FDTBL+00000062      8 BIT(S)
STRTLOC1 EQU   FDTBL+00000062      1 BIT(S)
FOXZEROS EQU   *                   16 BYTE(S)
         DC    X'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'
INBUF    EQU   00000000            80 BYTE(S)
BUFFER   EQU   00000000            32767 BYTE(S)
ON       EQU   *                   1 BYTE(S)
         DC    X'FF'
OFF      EQU   *                   1 BYTE(S)
         DC    X'00'
WKADDR   EQU   00000000            32767 BYTE(S)
COPAT    EQU   *                   27 BYTE(S)
         DC    C' .<(+&&!$*);^-/,%_>?:#@''="'
ALPAT    EQU   *                   36 BYTE(S)
         DC    C'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'
OPTIONS  EQU   00000000            256 BYTE(S)
PAGE     EQU   00000000            256 BYTE(S)
DDLST    EQU   00000000            256 BYTE(S)
         ORG   @DATA
         DS    00000081C
@L       EQU   1
@DATD    DSECT
@SAV001  EQU   @DATD+00000000      72 BYTE(S) ON WORD
BUFPTR   EQU   @DATD+00000072      FULLWORD POINTER
RCODE    EQU   @DATD+00000076      FULLWORD INTEGER
OPTPTR   EQU   @DATD+00000080      FULLWORD POINTER
PGPTR    EQU   @DATD+00000084      FULLWORD POINTER
         DS    00000088C
@TEMPS   DS    0F
@TEMP4   DC    F'0'
@DATEND  EQU   *
IEBFDTBL CSECT ,
@9F2     EQU   F9E5
@9EF     EQU   @EL02
         END   IEBFDTBL

         TITLE 'IOESDKTO-3540 SETDISKT OUTPUT SERVICES                 *
                        '
IOESDKTO CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IOESDKTO  77.320'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @09,@01                                             0001
         USING @DATD,@09                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @09,8(,@13)                                         0001
         LR    @13,@09                                             0001
*   SETDSKPT=REG1;                  /* INIT SETDISKT POINTER @Y30OE6D*/
         LR    SETDSKPT,REG1                                       0108
*   RESPECIFY                                                      0109
*     REG1 UNRSTD;                  /* RELEASE REGISTER      @Y30OE6D*/
*   RFY                             /* ADDRESSABILITY TO IOB @Y30OE6D*/
*     IOBPREFX BASED(IOBPTR-LENGTH(IOBPREFX));/* PREFIX      @Y30OE6D*/
*   RFY                             /* ADDRESSABILITY TO IOB @Y30OE6D*/
*     IOBSTDRD BASED(IOBSTPTR);     /* STANDARD SECTION      @Y30OE6D*/
*   DCBPTR=SDKTDCB;                 /* SET POINTER TO DCB    @Y30OE6D*/
         L     @08,SDKTDCB(,SETDSKPT)                              0112
         LR    DCBPTR,@08                                          0112
*   DEBPTR=DCBDEBAD;                /* SET POINTER TO DEB    @Y30OE6D*/
         L     DEBPTR,DCBDEBAD+40(,DCBPTR)                         0113
*   AWORKPTR=DCBAMWKA;              /* GET PTR TO AM WORK    @Y30OE6D*/
         LA    @15,16                                              0114
         LR    @14,DCBPTR                                          0114
         ALR   @14,@15                                             0114
         L     AWORKPTR,DCBAMWKA-1(,@14)                           0114
         LA    AWORKPTR,0(,AWORKPTR)                               0114
*   IOBSTPTR=IOBPTR;                /* SET POINTER TO IOB    @Y30OE6D*/
         L     @14,IOBPTR-1(,AWORKPTR)                             0115
         LA    @14,0(,@14)                                         0115
         LR    IOBSTPTR,@14                                        0115
*   SAVEIOB=IOBSTPTR;               /* SAVE IOB POINTER      @Y30OE6D*/
         ST    IOBSTPTR,SAVEIOB(,AWORKPTR)                         0116
*   SAVEIOBX=IOBPTR-LENGTH(IOBPREFX);/* SAVE PREFIX PTR      @Y30OE6D*/
         SLR   @14,@15                                             0117
         ST    @14,SAVEIOBX(,AWORKPTR)                             0117
*   SAVEUCB=DEBSUCBB;               /* SAVE POINTER TO UCB   @Y30OE6D*/
         L     @15,DEBSUCBB-1(,DEBPTR)                             0118
         LA    @15,0(,@15)                                         0118
         ST    @15,SAVEUCB(,AWORKPTR)                              0118
*   CHNPGMPT=IOBSTRTB;              /* GET PTR TO CCW CHAIN  @Y30OE6D*/
         L     CHNPGMPT,IOBSTRTB-1(,IOBSTPTR)                      0119
         LA    CHNPGMPT,0(,CHNPGMPT)                               0119
*   MSGTYPCD=WTOCD;                 /* SET MSG TYPE TO WTO   @Y30OE6D*/
         MVI   MSGTYPCD(AWORKPTR),X'01'                            0120
*   JNAMETXT=ACBJOBID;              /* PUT JOBNAME IN MSG    @Y30OE6D*/
         MVC   JNAMETXT(8),ACBJOBID(AWORKPTR)                      0121
*   MSGDCBAD=SDKTDCB;               /* INIT DCB ADDR         @Y30OE6D*/
         ST    @08,MSGDCBAD(,AWORKPTR)                             0122
*   DSIDTXT=SDKTDSID;               /* PUT DSID IN MSG       @Y30OE6D*/
         MVC   DSIDTXT(8),SDKTDSID(SETDSKPT)                       0123
*   SETRETCD=''B;                   /* CLEAR SETDISKT RET CD @Y30OE6D*/
         XC    SETRETCD(2,SETDSKPT),SETRETCD(SETDSKPT)             0124
*                                                                  0125
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*                 SETDISKT OUTPUT SERVICES                 @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*                                                                  0125
*SETDIN:                                                           0125
*   DO;                             /* SETDIN:CASE(SETOPCDE)NAMES(OPE
*                                      NDS,EOV,CLOSEDS)              */
SETDIN   DS    0H                                                  0126
*     DCL                                                          0126
*       CL0001@ LABEL BASED(CP0001@(SETOPCDE)) VALUERANGE(OPENDS,EOV,
*           CLOSEDS);               /* BRANCH TARGET                 */
*     DCL                                                          0127
*       CP0001@(3) PTR(31) INIT(ADDR(OPENDS),ADDR(EOV),ADDR(CLOSEDS));
*     GOTO CL0001@;                 /* BRANCH TO SELECTED CASE     0128
*                                                            @Y30OE6D*/
         SLR   @11,@11                                             0128
         IC    @11,SETOPCDE(,SETDSKPT)                             0128
         SLA   @11,2                                               0128
         L     @11,CP0001@-4(@11)                                  0128
         BR    @11                                                 0128
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*                 OPEN AN OUTPUT DATA SET                  @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*  IF THIS IS THE 1ST OPEN AFTER OPENING THE DEVICE OR IF  @Y30OE6D*/
*/*  MULTI-DATASETS PER DISKETTE ARE NOT ALLOWED, THEN FIND  @Y30OE6D*/
*/*  A SCRATCH DISKETTE.                                     @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*                                                                  0129
*OPENDS:                                                           0129
*     DO;                           /* SUBCASE               @Y30OE6D*/
OPENDS   DS    0H                                                  0130
*       FIRSTTME=OFF;               /* INITIALIZE FLAG       @Y30OE95*/
         NI    FIRSTTME(AWORKPTR),B'01111111'                      0130
*       IF AMWBOE=ZEROS             /* IS THIS FIRST OPEN    @Y30OE6D*/
*         THEN                      /* YES                   @Y30OE95*/
         CLC   AMWBOE(4,AWORKPTR),ZEROS                            0131
         BNE   @RF00131                                            0131
*         DO;                       /* CONTINUE              @Y30OE95*/
*           FIRSTTME=ON;            /* INDICATE FIRST TIME   @Y30OE95*/
         OI    FIRSTTME(AWORKPTR),B'10000000'                      0133
*           AMWEXDTE(1)=ZERO;       /* RESET EXP. DATE       @Y30OE6D*/
         MVI   AMWEXDTE(AWORKPTR),X'00'                            0134
*           CALL FINDSCRT;          /* GO GET SCRATCH DSKT   @Y30OE95*/
         BAL   @14,FINDSCRT                                        0135
*         END;                      /*                       @Y30OE95*/
*       ELSE                        /*                       @Y30OE95*/
*         IF ACBFEED=ON             /* MULTI-D.S./DISKT ?    @Y30OE95*/
*           THEN                    /* NO                    @Y30OE95*/
         B     @RC00131                                            0137
@RF00131 TM    ACBFEED(AWORKPTR),B'10000000'                       0137
         BNO   @RF00137                                            0137
*           CALL FINDSCRT;          /* FIND A SCRATCH DISKT  @Y30OE95*/
         BAL   @14,FINDSCRT                                        0138
*         ELSE                      /*                       @Y30OE95*/
*                                                                  0139
*           /*********************************************************/
*           /*                                                       */
*           /* MAKE SURE THERE IS AN AVAILABLE HDR1 SLOT IF  @Y30OE95*/
*           /* MULTI-DATA SETS PER DISKETTE ARE ALLOWED.     @Y30OE95*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0139
*           DO;                     /* CONTINUE              @Y30OE95*/
         B     @RC00137                                            0139
@RF00137 DS    0H                                                  0140
*             FEEDCODE=OFF;         /* SET NOFEED INDICATOR  @Y30OE6D*/
         NI    FEEDCODE(AWORKPTR),B'10111111'                      0140
*             CALL RDLABTRK;        /* READ LABEL TRACK      @Y30OE95*/
         BAL   @14,RDLABTRK                                        0141
*             IF ERTNCDE=GOODRTN    /* IF NO ERRORS FROM     @Y30OE6D*/
*               THEN                /* RDLABTRK ROUTINE      @Y30OE6D*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0142
         BNE   @RF00142                                            0142
*               CALL FINDHDR1;      /* FIND HDR1 SLOT        @Y30OE6D*/
         BAL   @14,FINDHDR1                                        0143
*           END;                    /*                       @Y30OE6D*/
@RF00142 DS    0H                                                  0145
*       IF ERTNCDE=GOODRTN          /* IF NO ERRORS FROM     @Y30OE6D*/
*         THEN                      /* FINDSCRT ROUTINE      @Y30OE6D*/
@RC00137 DS    0H                                                  0145
@RC00131 CLI   ERTNCDE(SETDSKPT),X'00'                             0145
         BNE   @RF00145                                            0145
*         DO;                       /* CONTINUE              @Y30OE6D*/
*           CALL UPDEBIOB;          /* UPDATE THE DEB & IOB  @Y30OE6D*/
         BAL   @14,UPDEBIOB                                        0147
*           AMWDSOPN=ON;            /* IND DATA SET IS OPEN  @Y30OE6D*/
         OI    AMWDSOPN(AWORKPTR),B'01000000'                      0148
*         END;                      /* END OF OPEN DS ROUT.  @Y30OE6D*/
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                             0150
*     END OPENDS;                   /* END OF SUBCASE        @Y30OE6D*/
*                                                                  0152
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*               EOV  (END OF VOLUME) ROUTINE               @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*                                                                  0152
*EOV:                                                              0152
*     DO;                           /* SUBCASE               @Y30OE6D*/
EOV      DS    0H                                                  0153
*       EOVPROC=ON;                 /* IND. EOV PROCESSING   @Y30OE6D*/
         OI    EOVPROC(AWORKPTR),B'10000000'                       0153
*       CALL CLOSEOPN;              /* CLOSE OPENED DATA SET @Y30OE6D*/
         BAL   @14,CLOSEOPN                                        0154
*       IF ERTNCDE=GOODRTN          /* IF NO ERRORS,         @Y30OE95*/
*         THEN                      /* CONTINUE              @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0155
         BNE   @RF00155                                            0155
*         DO;                       /*                       @Y30OE95*/
*           FIRSTTME=OFF;           /* IND. NOT FIRST TIME   @Y30OE95*/
         NI    FIRSTTME(AWORKPTR),B'01111111'                      0157
*           AMWMLTVL=ON;            /* SET MULTI-VOL IND ON  @Y30OE6D*/
         OI    AMWMLTVL(AWORKPTR),B'00010000'                      0158
*           CALL FINDSCRT;          /* CALL FIND SCRTCH DSKT @Y30OE95*/
         BAL   @14,FINDSCRT                                        0159
*           IF ERTNCDE=GOODRTN      /* WAS ONE FOUND         @Y30OE95*/
*             THEN                  /* YES                   @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0160
         BNE   @RF00160                                            0160
*             DO;                   /*                       @Y30OE6D*/
*               CALL UPDEBIOB;      /* UPDATE DEB AND IOB    @Y30OE6D*/
         BAL   @14,UPDEBIOB                                        0162
*               AMWDSOPN=ON;        /* SET OPEN IND IN CASE  @Y30OE6D*/
*                                                                  0163
         OI    AMWDSOPN(AWORKPTR),B'01000000'                      0163
*               /*****************************************************/
*               /*                                                   */
*               /* OF PERM I/O ERROR                         @Y30OE6D*/
*               /* ON 1ST DISKETTE OPEN                      @Y30OE6D*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0164
*             END;                  /*                       @Y30OE6D*/
*           ELSE                    /*                       @Y30OE6D*/
*             DO;                   /*                       @Y30OE6D*/
         B     @RC00160                                            0165
@RF00160 DS    0H                                                  0166
*               IF ERTNCDE=IOERROR  /* IF PERM I/O ERROR     @Y30OE6D*/
*                 THEN              /* OCCURRED, THEN        @Y30OE6D*/
         CLI   ERTNCDE(SETDSKPT),X'10'                             0166
         BNE   @RF00166                                            0166
*                 ERTNCDQL=PIOE;    /* SET PERM IO QUALIFIER @Y30OE6D*/
         MVI   ERTNCDQL(SETDSKPT),X'04'                            0167
*             END;                  /*                       @Y30OE6D*/
@RF00166 DS    0H                                                  0169
*           EOVPROC=OFF;            /* RESET EOV PROC IND    @Y30OE6D*/
@RC00160 NI    EOVPROC(AWORKPTR),B'01111111'                       0169
*         END;                      /* END OF EOV ROUTINE    @Y30OE95*/
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                             0171
*     END EOV;                      /* END OF SUBCASE        @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*       CLOSE A PREVIOUSLY OPENED DATA SET ROUTINE.        @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*                                                                  0173
*CLOSEDS:                                                          0173
*     DO;                           /* SUBCASE               @Y30OE6D*/
CLOSEDS  DS    0H                                                  0174
*       CALL CLOSEOPN;              /* GO CLOSE THIS DATASET @Y30OE6D*/
         BAL   @14,CLOSEOPN                                        0174
*       AMWDSOPN=OFF;               /* SET DS OPEN FLAG OFF  @Y30OE6D*/
*       AMWMLTVL=OFF;               /* RESET MULTI-VOL IND,  @Y30OE6D*/
         NI    AMWDSOPN(AWORKPTR),B'10101111'                      0176
*       AMWVSEQU=ZERO;              /* ZERO VOL SEQ NO.      @Y30OE6D*/
         MVI   AMWVSEQU(AWORKPTR),X'00'                            0177
*       AMWWTPTI=ZERO;              /* WRITE PROTECT IND,    @Y30OE6D*/
         MVI   AMWWTPTI(AWORKPTR),X'00'                            0178
*       AMWDSSQL=ZERO;              /* DATA SET SECURITY IND @Y30OE6D*/
         MVI   AMWDSSQL(AWORKPTR),X'00'                            0179
*       AMWEXDTE(1)=ZERO;           /* AND EXPIRATION DATE   @Y30OE6D*/
         MVI   AMWEXDTE(AWORKPTR),X'00'                            0180
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                             0181
*     END CLOSEDS;                  /* END OF SUBCASE        @Y30OE6D*/
*CE0001@:                                                          0183
*   END SETDIN;                     /* END OF CASE           @Y30OE6D*/
*                                                                  0184
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*     THIS ROUTINE CLOSES AN OUTPUT DATA SET WHICH HAS     @Y30OE6D*/
*/*     BEEN PREVIOUSLY OPENED BY AN OPEN CALL OR CLOSE      @Y30OE6D*/
*/*     THE DATA SET WHEN EOV OCCURRS.                       @Y30OE6D*/
*/*     IF THE LAST BUFFER WRITTEN BEFORE THE CLOSE WAS NOT  @Y30OE6D*/
*/*     FULL, A NOOPECCW WILL BE SOMEWHERE IN THE MIDDLE OF  @Y30OE6D*/
*/*     THE CCW CHAIN AND MUST BE REPLACED WITH THE OLD      @Y30OE6D*/
*/*     RWCCW.                                               @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*                                                                  0184
*CLOSEOPN:                          /*                       @Y30OE6D*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
@EL00001 L     @13,4(,@13)                                         0184
@EF00001 L     @00,@SIZDATD                                        0184
         LR    @01,@09                                             0184
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0184
         BR    @14                                                 0184
CLOSEOPN ST    @14,@SA00002                                        0184
*   CHANPGM(1,1)=NOOP;              /* RESTORE NOOPBCCW      @Y30OE6D*/
         MVI   CHANPGM(CHNPGMPT),X'03'                             0185
*   I=((CCWPTR-CHNPGMPT)/EIGHT)+ONE;/*                       @Y30OE95*/
         L     @00,CCWPTR-1(,AWORKPTR)                             0186
         ICM   @00,8,@CB01893                                      0186
         SLR   @00,CHNPGMPT                                        0186
         SRDA  @00,32                                              0186
         D     @00,@CF01815                                        0186
         AL    @01,@CF01817                                        0186
         ST    @01,I(,AWORKPTR)                                    0186
*   IF I>=3&                        /* TEST IF A CCW NEEDS   @Z30OE73*/
*       CHANPGM(I,1)=NOOP           /* TO BE SWAPPED TO      @Z30OE73
*                                      RESTORE THE CCW CHAIN @Z30OE73*/
*     THEN                          /* THE 3 RD CCW, THEN    @Y30OE6D*/
         C     @01,@CF00217                                        0187
         BL    @RF00187                                            0187
         SLA   @01,3                                               0187
         ST    @01,@TF00001                                        0187
         ALR   @01,CHNPGMPT                                        0187
         AL    @01,@CF02104                                        0187
         CLI   CHANPGM(@01),X'03'                                  0187
         BNE   @RF00187                                            0187
*     DO;                           /* RESTORE CCW CHAIN     @Y30OE6D*/
*       NOOPESAV=CHANPGM(29);       /* SAVE NOOPE CCW        @Y30OE6D*/
         MVC   NOOPESAV(8,AWORKPTR),CHANPGM+224(CHNPGMPT)          0189
*       CHANPGM(29)=CHANPGM(I);     /* SAVE LAST CCW         @Y30OE6D*/
         LR    @11,CHNPGMPT                                        0190
         AL    @11,@TF00001                                        0190
         AL    @11,@CF02104                                        0190
         MVC   @TS00001(8),CHANPGM(@11)                            0190
         MVC   CHANPGM+224(8,CHNPGMPT),@TS00001                    0190
*       CHANPGM(I)=NOOPESAV;        /* REPLACE WITH NOOPE    @Y30OE6D*/
         LR    @11,CHNPGMPT                                        0191
         AL    @11,@TF00001                                        0191
         AL    @11,@CF02104                                        0191
         MVC   CHANPGM(8,@11),NOOPESAV(AWORKPTR)                   0191
*     END;                          /*                       @Y30OE6D*/
*                                                                  0192
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST THE DCB FOR A PERMANENT I/O ERROR. IF SAME       @Y30OE6D*/
*   /* OCCURRED ON THIS DISKETTE, BYPASS WRITING THE         @Y30OE6D*/
*   /* HDR1 LABEL FOR THIS DATA SET AS IT WILL BE RE-        @Y30OE6D*/
*   /* WRITTEN ON A NEW DISKETTE.                            @Y30OE6D*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0193
*   IF DCBIFEC^=PERMIOER            /* IF NO PERMANENT I/O   @Y30OE6D*/
*     THEN                          /* ERROR OCCURRED ON PUT @Y30OE6D*/
*                                                                  0193
@RF00187 TM    DCBIFEC+40(DCBPTR),B'11000000'                      0193
         BO    @RF00193                                            0193
*     /***************************************************************/
*     /*                                                             */
*     /* THEN CONTINUE                                       @Y30OE6D*/
*     /* FIND A HDR1 SLOT ON THE LABEL TRACK, THEN BUILD     @Y30OE6D*/
*     /* AND WRITE THE HDR1 LABEL IN THE EMPTY SLOT FOUND.   @Y30OE6D*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0194
*     CALL FORMHDR1;                /* GO BUILD HDR1 LABEL   @Y30OE6D*/
         BAL   @14,FORMHDR1                                        0194
*   ELSE                            /* PERM ERR OCCURED      @Z30OE73*/
*     DCBIFEC=OFF;                  /* RESET PERM I/O IND    @Y30OE6D*/
         B     @RC00193                                            0195
@RF00193 NI    DCBIFEC+40(DCBPTR),B'00111111'                      0195
*   END CLOSEOPN;                   /* END OF CLOSE ROUT.    @Y30OE95*/
@EL00002 DS    0H                                                  0196
@EF00002 DS    0H                                                  0196
@ER00002 L     @14,@SA00002                                        0196
         BR    @14                                                 0196
*                                                                  0197
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS PROCEDURE READS IN THE LABEL TRACK (TRACK 0) OF A  @Y30OE95*/
*/*  DISKETTE. IT MAY ALSO CAUSE ANOTHER DISKETTE TO BE FED  @Y30OE95*/
*/*  INTO THE READER. UPON ENTRY, THE 'FEEDCODE' BYTE OF THE @Y30OE95*/
*/*  WORKAREA CONTAINS EITHER A '00'X IF ONLY A READ IS      @Y30OE95*/
*/*  WANTED OR A '10'X IF A FEED/READ IS WANTED.             @Y30OE95*/
*/*                                                          @Y30OE95*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0197
*RDLABTRK:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
*                                                                  0197
RDLABTRK ST    @14,@SA00003                                        0197
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE NOOPCCWB TO A DFN OPS CCW                      @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0198
*   CHANPGM(1,1:8)=CCWD1;           /* PUT DFNOP CCW IN CHN  @Y30OE6D*/
         MVC   CHANPGM(8,CHNPGMPT),CCWD1                           0198
*   IOBSKADR=VOL1ADDR;              /* POINT TO TRK 0, REC 7 @Y30OE6D*/
*                                                                  0199
         MVC   IOBSKADR(4,IOBSTPTR),VOL1ADDR                       0199
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE THE CCW COUNT FIELD TO EIGHTY AND CHANGE THE   @Y30OE6D*/
*   /* CCW OPCODES TO READS.                                 @Y30OE6D*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0200
*   DO I=3 TO 22;                   /* SET LOOP FOR RWCCW1   @Y30OE95
*                                      TO RWCCW20            @Y30OE95*/
         LA    @11,3                                               0200
         ST    @11,I(,AWORKPTR)                                    0200
@DL00200 DS    0H                                                  0201
*     CHANPGM(I,7:8)=COUNT80;       /* SET BYTECOUNT = 80    @Y30OE6D*/
         L     @11,I(,AWORKPTR)                                    0201
         SLA   @11,3                                               0201
         LH    @08,COUNT80                                         0201
         ST    @11,@TF00001                                        0201
         ALR   @11,CHNPGMPT                                        0201
         BCTR  @11,0                                               0201
         BCTR  @11,0                                               0201
         STCM  @08,3,CHANPGM(@11)                                  0201
*     CHANPGM(I,1)=READOP;          /* CHNG OPCODE TO READ   @Y30OE6D*/
         LR    @11,CHNPGMPT                                        0202
         AL    @11,@TF00001                                        0202
         AL    @11,@CF02104                                        0202
         MVI   CHANPGM(@11),X'06'                                  0202
*   END;                            /*                       @Y30OE95*/
*                                                                  0203
         LA    @11,1                                               0203
         AL    @11,I(,AWORKPTR)                                    0203
         ST    @11,I(,AWORKPTR)                                    0203
         C     @11,@CF01653                                        0203
         BNH   @DL00200                                            0203
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE RWCCW21 TO DFNOPS CCW                          @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0204
*   CCW21SAV=CHANPGM(23);           /* SAVE RWCCW21          @Y30OE95*/
         MVC   CCW21SAV(8,AWORKPTR),CHANPGM+176(CHNPGMPT)          0204
*   CHANPGM(23,1:8)=CCWD2;          /* POINT TO OUTPUT CCW   @Y30OE6D*/
         MVC   CHANPGM+176(8,CHNPGMPT),CCWD2                       0205
*                                                                  0206
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THIS IS A READ/FEED REQUEST THEN CHANGE RWCCW26    @Y30OE95*/
*   /* TO A FEED CCW AND BUILD A TIC IN NOOPCCWE TO          @Y30OE95*/
*   /* NOOPCCWB                                              @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0206
*   IF FEEDCODE=ON                  /* READ/FEED REQUEST?    @Y30OE6D*/
*     THEN                          /* YES                   @Y30OE95*/
         TM    FEEDCODE(AWORKPTR),B'01000000'                      0206
         BNO   @RF00206                                            0206
*     DO;                           /* CONTINUE              @Y30OE95*/
*       SAVEVOL=''B;                /* ZERO VOL SER          @Y30OE6D*/
         XC    SAVEVOL(6,AWORKPTR),SAVEVOL(AWORKPTR)               0208
*       CALL UCBUPDAT;              /* GO UPDATE UCB         @Y30OE6D*/
         BAL   @14,UCBUPDAT                                        0209
*       CCW26SAV=CHANPGM(28);       /* SAVE RWCCW26          @Y30OE95*/
         MVC   CCW26SAV(8,AWORKPTR),CHANPGM+216(CHNPGMPT)          0210
*       NOOPESAV=CHANPGM(29);       /* SAVE NOOPCCWE         @Y30OE95*/
         MVC   NOOPESAV(8,AWORKPTR),CHANPGM+224(CHNPGMPT)          0211
*       CHANPGM(28,1)=FEEDOP;       /* CHANGE RWCCW26 TO A   @Y30OE6D
*                                      FEEDCCW               @Y30OE95*/
         MVI   CHANPGM+216(CHNPGMPT),X'17'                         0212
*       CHANPGM(28,5)=CCSILI;       /* CHAIN CCW'S           @Y30OE6D*/
         MVI   CHANPGM+220(CHNPGMPT),X'60'                         0213
*       CHANPGM(29,1:4)=ADDR(CHANPGM(1));/* NOOPB ADR        @Y30OE95
*                                      IN NOOPE              @Y30OE95*/
         STCM  CHNPGMPT,15,CHANPGM+224(CHNPGMPT)                   0214
*       CHANPGM(29,1)=TICOP;        /* TIC OPCODE            @Y30OE6D*/
         MVI   CHANPGM+224(CHNPGMPT),X'08'                         0215
*       IOBSTRTB=ADDR(CHANPGM(28)); /* CHANGE CHAN PGM       @Y30OE95
*                                      PTR IN IOB            @Y30OE95*/
         LA    @11,CHANPGM+216(,CHNPGMPT)                          0216
         STCM  @11,7,IOBSTRTB(IOBSTPTR)                            0216
*     END;                          /*                       @Y30OE95*/
*                                                                  0218
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE EXCP TO READ IN LABEL TRACK                     @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0218
*   CALL IOSBRTN;                   /* GO DO EXCP            @Y30OE95*/
*                                                                  0218
@RF00206 BAL   @14,IOSBRTN                                         0218
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE CCW CHAIN TO INITIAL FORM                     @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0219
*   IF FEEDCODE=ON                  /* READ/FEED REQUEST?    @Y30OE6D*/
*     THEN                          /* YES                   @Y30OE95*/
         TM    FEEDCODE(AWORKPTR),B'01000000'                      0219
         BNO   @RF00219                                            0219
*     DO;                           /* CONTINUE              @Y30OE95*/
*       CHANPGM(28)=CCW26SAV;       /* RESTORE RWCCW26       @Y30OE95*/
         MVC   CHANPGM+216(8,CHNPGMPT),CCW26SAV(AWORKPTR)          0221
*       CHANPGM(29)=NOOPESAV;       /* RESTORE NOOPCCWE      @Y30OE95*/
         MVC   CHANPGM+224(8,CHNPGMPT),NOOPESAV(AWORKPTR)          0222
*       IOBSTRTB=ADDR(CHANPGM(1));  /* RSTRE CHAN PGM        @Y30OE95*/
         STCM  CHNPGMPT,7,IOBSTRTB(IOBSTPTR)                       0223
*     END;                          /*                       @Y30OE95*/
*   CHANPGM(23)=CCW21SAV;           /* RESTORE RWCCW21       @Y30OE95*/
@RF00219 MVC   CHANPGM+176(8,CHNPGMPT),CCW21SAV(AWORKPTR)          0225
*   CHANPGM(1,1)=NOOP;              /* RESTORE NOOPB CCW     @Y30OE6D*/
         MVI   CHANPGM(CHNPGMPT),X'03'                             0226
*   DO I=3 TO 22;                   /* SET LOOP FOR RWCCW1   @Y30OE6D
*                                      TO RWCCW20            @Y30OE95*/
         LA    @11,3                                               0227
         ST    @11,I(,AWORKPTR)                                    0227
@DL00227 DS    0H                                                  0228
*     CHANPGM(I,1)=WRITEOP;         /* CHNG OPCODE TO WRITE  @Y30OE6D*/
         L     @11,I(,AWORKPTR)                                    0228
         SLA   @11,3                                               0228
         ALR   @11,CHNPGMPT                                        0228
         AL    @11,@CF02104                                        0228
         MVI   CHANPGM(@11),X'05'                                  0228
*   END;                            /*                       @Y30OE6D*/
         LA    @11,1                                               0229
         AL    @11,I(,AWORKPTR)                                    0229
         ST    @11,I(,AWORKPTR)                                    0229
         C     @11,@CF01653                                        0229
         BNH   @DL00227                                            0229
*   END RDLABTRK;                   /* END OF SUBROUTINE     @Y30OE6D*/
@EL00003 DS    0H                                                  0230
@EF00003 DS    0H                                                  0230
@ER00003 L     @14,@SA00003                                        0230
         BR    @14                                                 0230
*                                                                  0231
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS SECTION WILL FIND A SCRATCH DISKETTE BY FEEDING    @Y30OE95*/
*/*  DISKETTES UNTIL A SCRATCH DISKETTE IS FOUND OR UNTIL    @Y30OE95*/
*/*  END OF DISKETTE IS ENCOUNTERRED.  IF THIS ROUTINE IS    @Y30OE95*/
*/*  ENTERED FROM OPEN OUTPUT, A DISKETTE HAS ALREADY BEEN   @Y30OE6D*/
*/*  READ SO ANOTHER FEED/READ IS NOT NECESSARY UNLESS A     @Y30OE95*/
*/*  SECOND DISKETTE NEEDS TO BE CHECKED.                    @Y30OE95*/
*/*                                                          @Y30OE95*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0231
*FINDSCRT:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
FINDSCRT ST    @14,@SA00004                                        0231
*   SCRCHDSK=OFF;                   /* INIT SCRATCH DSKT OFF @Y30OE95*/
         NI    SCRCHDSK(AWORKPTR),B'11110111'                      0232
*   DO WHILE SCRCHDSK=OFF;          /* LOOP UNTIL SCRATCH    @Y30OE95
*                                      DSKT IS FOUND         @Y30OE95*/
         B     @DE00233                                            0233
@DL00233 DS    0H                                                  0234
*     IF FIRSTTME=OFF               /* IS THIS FIRST PASS    @Y30OE95*/
*       THEN                        /* NO                    @Y30OE6D*/
         TM    FIRSTTME(AWORKPTR),B'10000000'                      0234
         BNZ   @RF00234                                            0234
*       DO;                         /*                       @Y30OE6D*/
*         FEEDCODE=ON;              /* INDICATE FEED         @Y30OE6D*/
         OI    FEEDCODE(AWORKPTR),B'01000000'                      0236
*         IF AMWMLTVL=OFF           /* IF NOT PROCESSING     @Y30OE6D*/
*           THEN                    /* MULTI-VOLUME, THEN    @Y30OE6D*/
         TM    AMWMLTVL(AWORKPTR),B'00010000'                      0237
         BNZ   @RF00237                                            0237
*           DO;                     /*                       @Y30OE6D*/
*             AMWVOLAC=ZERO;        /* RESET VOL ACCESS IND  @Y30OE6D*/
         MVI   AMWVOLAC(AWORKPTR),X'00'                            0239
*             SECURVOL=OFF;         /* RESET SECURE VOL IND  @Y30OE6D*/
         NI    SECURVOL(AWORKPTR),B'11110111'                      0240
*           END;                    /*                       @Y30OE6D*/
*       END;                        /*                       @Y30OE6D*/
*     ELSE                          /*                       @Y30OE6D*/
*       FEEDCODE=OFF;               /* INDICATE NO FEED      @Y30OE6D*/
         B     @RC00234                                            0243
@RF00234 NI    FEEDCODE(AWORKPTR),B'10111111'                      0243
*     CALL RDLABTRK;                /* GO READ LABEL TRACK   @Y30OE6D*/
@RC00234 BAL   @14,RDLABTRK                                        0244
*     FIRSTTME=OFF;                 /* TURN OFF 1ST TIME IND @Y30OE95*/
         NI    FIRSTTME(AWORKPTR),B'01111111'                      0245
*     IF ERTNCDE=GOODRTN            /* ANY ERRORS            @Y30OE95*/
*       THEN                        /* NO                    @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0246
         BNE   @RF00246                                            0246
*       DO;                         /* CONTINUE              @Y30OE95*/
*                                                                  0247
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR VALID VOL1 LABEL AND FOR END-OF-DISKETTE      */
*         /*                                                 @Y30OE95*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0248
*         CALL VOL1LABL;            /* GO CHECK VOL1 LABEL   @Y30OE95*/
         BAL   @14,VOL1LABL                                        0248
*         IF ERTNCDE=GOODRTN        /* IS VOL1 LABEL OK      @Y30OE95*/
*           THEN                    /* YES                   @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0249
         BNE   @RF00249                                            0249
*                                                                  0250
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF DISKETTE IS SCRATCH                  @Y30OE95*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0250
*           CALL CKSCRDSK;          /* GO CHECK IF THIS IS A @Y30OE95
*                                      SCRATCH DISKETTE      @Y30OE95*/
         BAL   @14,CKSCRDSK                                        0250
*         ELSE                      /*                       @Y30OE95*/
*           IF ERTNCDE=ENDDISK      /* END OF DSKT?          @Y30OE6D*/
*             THEN                  /* YES                   @Y30OE95*/
         B     @RC00249                                            0251
@RF00249 CLI   ERTNCDE(SETDSKPT),X'14'                             0251
         BNE   @RF00251                                            0251
*             SCRCHDSK=ON;          /* TURN ON SCRATCH DSK   @Y30OE95*/
         OI    SCRCHDSK(AWORKPTR),B'00001000'                      0252
*           ELSE                    /*                       @Y30OE95*/
*             SETRETCD=''B;         /* SET CODE TO END LOOP  @Y30OE6D*/
         B     @RC00251                                            0253
@RF00251 XC    SETRETCD(2,SETDSKPT),SETRETCD(SETDSKPT)             0253
*       END;                        /*                       @Y30OE95*/
*     ELSE                          /*                       @Y30OE95*/
*       SCRCHDSK=ON;                /* TURN ON SCRATCH DSK   @Y30OE95
*                                      FLAG TO END LOOP      @Y30OE95*/
         B     @RC00246                                            0255
@RF00246 OI    SCRCHDSK(AWORKPTR),B'00001000'                      0255
*   END;                            /*                       @Y30OE95*/
@RC00246 DS    0H                                                  0256
@DE00233 TM    SCRCHDSK(AWORKPTR),B'00001000'                      0256
         BZ    @DL00233                                            0256
*   IF ERTNCDE=GOODRTN              /* ANY ERRORS            @Y30OE95*/
*     THEN                          /* NO                    @Y30OE95*/
*                                                                  0257
         CLI   ERTNCDE(SETDSKPT),X'00'                             0257
         BNE   @RF00257                                            0257
*     /***************************************************************/
*     /*                                                             */
*     /* BLANK OUT HDR1 LABEL OF THE SCRATCH DISKETTE FOR    @Y30OE95*/
*     /* SECURITY PURPOSES.                                  @Y30OE95*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0258
*     CALL BLANKHDR;                /* GO BLANK OUT HDR1     @Y30OE95*/
         BAL   @14,BLANKHDR                                        0258
*   END FINDSCRT;                   /* END OF SUBROUTINE     @Y30OE95*/
@EL00004 DS    0H                                                  0259
@EF00004 DS    0H                                                  0259
@ER00004 L     @14,@SA00004                                        0259
         BR    @14                                                 0259
*                                                                  0260
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS SECTION WILL DETERMINE IF THERE IS ENOUGH SPACE ON @Y30OE95*/
*/*  A DISKETTE AND IF THERE IS A BLANK HDR1 TO BE USED FOR  @Y30OE95*/
*/*  A DATA SET IF MULTI-DATA SETS PER DISKETTE ARE ALLOWED. @Y30OE95*/
*/*  SEARCH THROUGH HDR1 LABELS UNTIL A DELETED HDR1 IS      @Y30OE95*/
*/*  FOUND OR UNTIL ALL HDR1'S ARE CHECKED. IF A DELETED     @Y30OE95*/
*/*  DATA SET IS FOUND CHECK THAT THERE IS AT LEAST 1 FREE   @Y30OE95*/
*/*  TRACK TO BEGIN WRITING ON.                              @Y30OE95*/
*/*                                                          @Y30OE95*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0260
*FINDHDR1:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
FINDHDR1 ST    @14,@SA00005                                        0260
*   I=1;                            /* INITIALIZE I TO 1     @Y30OE95*/
         MVC   I(4,AWORKPTR),@CF00037                              0261
*   BLKHDRFG=OFF;                   /* SET BLANK HDR FLG OFF @Y30OE95*/
*   DUPDSID=OFF;                    /* SET DUP DSID IND OFF  @Y30OE6D*/
         NI    BLKHDRFG(AWORKPTR),B'11111100'                      0263
*   DO WHILE BLKHDRFG=OFF&          /* LOOP UNTIL BLANK HDR  @Y30OE95*/
*         I<=19;                    /* IS FOUND OR END.      @Y30OE95*/
         B     @DE00264                                            0264
@DL00264 DS    0H                                                  0265
*     HDR1PTR=CHANPGM(I+3,2:4);     /* GET PTR TO 1ST HDR1   @Y30OE95*/
         L     @11,I(,AWORKPTR)                                    0265
         SLA   @11,3                                               0265
         L     HDR1PTR,CHANPGM+16(@11,CHNPGMPT)                    0265
         LA    HDR1PTR,0(,HDR1PTR)                                 0265
*     IF HDRID=DDR1                 /* IS THIS A BLANK HDR1  @Y30OE95*/
*       THEN                        /* YES                   @Y30OE95*/
         CLC   HDRID(4,HDR1PTR),DDR1                               0266
         BNE   @RF00266                                            0266
*       BLKHDRFG=ON;                /* IND BLANK HDR FOUND   @Y30OE95*/
         OI    BLKHDRFG(AWORKPTR),B'00000010'                      0267
*     ELSE                          /*                       @Y30OE95*/
*       DO;                         /*                       @Y30OE6D*/
         B     @RC00266                                            0268
@RF00266 DS    0H                                                  0269
*         IF HDRDSID=SDKTDSID       /* DOES EQ DSIDS EXIST ? @Y30OE6D*/
*           THEN                    /*                       @Y30OE6D*/
         CLC   HDRDSID(8,HDR1PTR),SDKTDSID(SETDSKPT)               0269
         BNE   @RF00269                                            0269
*           DO;                     /* YES                   @Y30OE6D*/
*             DUPDSID=ON;           /* SET DUPLICATE DS IND  @Y30OE6D*/
*             BLKHDRFG=ON;          /* SET BLANK HDR IND ON  @Y30OE6D*/
         OI    DUPDSID(AWORKPTR),B'00000011'                       0272
*             MSGINDEX=DUPMSG;      /* SET INDEX FOR MSG 27  @Y30OE6D*/
         MVI   MSGINDEX(AWORKPTR),X'1B'                            0273
*             CALL MSGSUBRT;        /* CALL THE MSG SUBROUT. @Y30OE6D*/
         BAL   @14,MSGSUBRT                                        0274
*           END;                    /*                       @Y30OE6D*/
*         I=I+1;                    /* ADD 1 TO I            @Y30OE95*/
@RF00269 LA    @11,1                                               0276
         AL    @11,I(,AWORKPTR)                                    0276
         ST    @11,I(,AWORKPTR)                                    0276
*       END;                        /*                       @Y30OE6D*/
*   END;                            /*                       @Y30OE95*/
@RC00266 DS    0H                                                  0278
@DE00264 TM    BLKHDRFG(AWORKPTR),B'00000010'                      0278
         BNZ   @DC00264                                            0278
         CLC   I(4,AWORKPTR),@CF01976                              0278
         BNH   @DL00264                                            0278
@DC00264 DS    0H                                                  0279
*   IF I^=1                         /* IS 1ST HDR BLANK      @Y30OE95*/
*     THEN                          /* NO                    @Y30OE95*/
         L     @11,I(,AWORKPTR)                                    0279
         C     @11,@CF00037                                        0279
         BE    @RF00279                                            0279
*     DO;                           /* CONTINUE              @Y30OE95*/
*       HDR1PTR=CHANPGM(I+2,2:4);   /* POINT TO PREVIOUS     @Y30OE95
*                                      HDR1                  @Y30OE95*/
         LR    @08,@11                                             0281
         SLA   @08,3                                               0281
         L     HDR1PTR,CHANPGM+8(@08,CHNPGMPT)                     0281
         LA    HDR1PTR,0(,HDR1PTR)                                 0281
*       IF I>19                    /* IF NO BLANK HDRS      @Y30OE95*/
*           HDREOECC>=TRK73        /* FOUND OR PREV HDR     @Y30OE6D
*                                      DATA SET USED TRK 73  @Y30OE6D*/
*           DUPDSID=ON              /* OR DUP DSID FOUND     @Y30OE6D*/
*         THEN                      /* YES                   @Y30OE95*/
         C     @11,@CF01976                                        0282
         BH    @RT00282                                            0282
         CLC   HDREOECC(2,HDR1PTR),TRK73                           0282
         BNL   @RT00282                                            0282
         TM    DUPDSID(AWORKPTR),B'00000001'                       0282
         BNO   @RF00282                                            0282
@RT00282 DS    0H                                                  0283
*                                                                  0283
*         /***********************************************************/
*         /*                                                         */
*         /* IF THIS DISKETTE CONTAINS NO DELETED HDR1'S, NO @Y30OE6D*/
*         /* SPACE TO WRITE A DATA SET OR A DUPLICATE DATA   @Y30OE6D*/
*         /* SET WAS FOUND, THEN FIND A SCRATCH DISKETTE.    @Y30OE6D*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0283
*         CALL FINDSCRT;            /* GO FIND SCRATCH DISKT @Y30OE95*/
         BAL   @14,FINDSCRT                                        0283
*       ELSE                        /*                       @Y30OE95*/
*         HDR1PTR=CHANPGM(I+3,2:4); /* GET PTR TO HDR        @Y30OE95*/
         B     @RC00282                                            0284
@RF00282 L     @11,I(,AWORKPTR)                                    0284
         SLA   @11,3                                               0284
         L     HDR1PTR,CHANPGM+16(@11,CHNPGMPT)                    0284
         LA    HDR1PTR,0(,HDR1PTR)                                 0284
*     END;                          /*                       @Y30OE95*/
*   END FINDHDR1;                   /* END OF SUBROUTINE     @Y30OE95*/
@EL00005 DS    0H                                                  0286
@EF00005 DS    0H                                                  0286
@ER00005 L     @14,@SA00005                                        0286
         BR    @14                                                 0286
*                                                                  0287
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS SECTION WILL FIND A SLOT FOR THE HDR1 LABEL,       @Y30OE6D*/
*/*  THEN CREATE A HDR1 LABEL DESCRIBING THE DATA SET        @Y30OE6D*/
*/*  BEING CLOSED. IT WILL BE CREATED IN THE EMPTY           @Y30OE6D*/
*/*  SLOT FOUND AND POINTED TO BY HDR1PTR.                   @Y30OE6D*/
*/*                                                          @Y30OE95*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0287
*FORMHDR1:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
FORMHDR1 ST    @14,@SA00006                                        0287
*   SAVESEEK=IOBSKADR;              /* SAVE IOBSEEK FROM     @Y30OE95
*                                      LAST PUT              @Y30OE95*/
         MVC   SAVESEEK(4,AWORKPTR),IOBSKADR(IOBSTPTR)             0288
*   FEEDCODE=OFF;                   /* INDICATE NOFEED       @Y30OE6D*/
         NI    FEEDCODE(AWORKPTR),B'10111111'                      0289
*   CALL RDLABTRK;                  /* GO READ LABEL TRK     @Y30OE95*/
         BAL   @14,RDLABTRK                                        0290
*   IF ERTNCDE=GOODRTN              /* ANY ERRORS            @Y30OE95*/
*     THEN                          /* NO                    @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0291
         BNE   @RF00291                                            0291
*     DO;                           /* CONTINUE              @Y30OE95*/
*                                                                  0292
*       /*************************************************************/
*       /*                                                           */
*       /* GO THROUGH HDR1'S UNTIL ONE IS FOUND WITH "DDR1"  @Y30OE95*/
*       /* IN THE HDRID FIELD.                               @Y30OE95*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0293
*       HDR1PTR=CHANPGM(4,2:4);     /* GET PTR TO 1ST HDR1   @Y30OE6D*/
         SLR   HDR1PTR,HDR1PTR                                     0293
         ICM   HDR1PTR,7,CHANPGM+25(CHNPGMPT)                      0293
*       DO I=4 TO 22                /* SET LOOP FOR 19 HDR1S @Y30OE95*/
*             WHILE HDRID^=DDR1;    /* UNTIL SECTOR IS FOUND @Y30OE6D*/
         LA    @11,4                                               0294
         ST    @11,I(,AWORKPTR)                                    0294
@DL00294 CLC   HDRID(4,HDR1PTR),DDR1                               0294
         BE    @DC00294                                            0294
*         HDR1PTR=CHANPGM(I,2:4);   /* GET PTR TO HDR1       @Y30OE95*/
         L     @11,I(,AWORKPTR)                                    0295
         SLA   @11,3                                               0295
         AL    @11,@CF02104                                        0295
         L     HDR1PTR,CHANPGM(@11,CHNPGMPT)                       0295
         LA    HDR1PTR,0(,HDR1PTR)                                 0295
*       END;                        /*                       @Y30OE95*/
*                                                                  0296
         LA    @11,1                                               0296
         AL    @11,I(,AWORKPTR)                                    0296
         ST    @11,I(,AWORKPTR)                                    0296
         C     @11,@CF01653                                        0296
         BNH   @DL00294                                            0296
@DC00294 DS    0H                                                  0297
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE CCW CHAIN TO WRITE ONE TRACK.              @Y30OE6D*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0297
*       CHANPGM(1)=CCWD3;           /* PUT DFNOP CCW IN CHN  @Y30OE6D*/
         MVC   CHANPGM(8,CHNPGMPT),CCWD3                           0297
*       CCW21SAV=CHANPGM(23);       /* SAVE RWCCW23          @Y30OE6D*/
         MVC   CCW21SAV(8,AWORKPTR),CHANPGM+176(CHNPGMPT)          0298
*       CHANPGM(23)=CHANPGM(29);    /* SWAP CCW'S            @Y30OE6D*/
         MVC   CHANPGM+176(8,CHNPGMPT),CHANPGM+224(CHNPGMPT)       0299
*       HDR13540='';                /* BLANK HDR1 LABEL      @Y30OE6D*/
         MVI   HDR13540(HDR1PTR),C' '                              0300
         MVC   HDR13540+1(79,HDR1PTR),HDR13540(HDR1PTR)            0300
*       HDRID=HDR1;                 /* FILL IN 'HDR1'        @Y30OE95*/
         MVC   HDRID(4,HDR1PTR),HDR1                               0301
*       HDRDSID=SDKTDSID;           /* FILL IN DATA SET ID   @Y30OE95*/
         MVC   HDRDSID(8,HDR1PTR),SDKTDSID(SETDSKPT)               0302
*       IF AMWMLTVL=OFF             /* IF NOT MULTI-VOLUME   @Y30OE6D*/
*         THEN                      /* PROCESSING AND        @Y30OE6D*/
         TM    AMWMLTVL(AWORKPTR),B'00010000'                      0303
         BNZ   @RF00303                                            0303
*         IF ACBSECUR=ON            /* SECURITY PROCESSING   @Y30OE95*/
*           THEN                    /* SPECIFIED, THEN       @Y30OE95*/
         TM    ACBSECUR(AWORKPTR),B'01000000'                      0304
         BNO   @RF00304                                            0304
*           CALL SECRPROC;          /* CALL SECURITY PROC    @Y30OE95*/
         BAL   @14,SECRPROC                                        0305
*       IOBSKADR=SAVESEEK;          /* RESTORE LAST PUT SEEK @Y30OE95*/
@RF00304 DS    0H                                                  0306
@RF00303 MVC   IOBSKADR(4,IOBSTPTR),SAVESEEK(AWORKPTR)             0306
*       CVD(ACBLRECL,CONVERT);      /* GET PACKED REC LENGTH @Y30OE95*/
         LH    @11,ACBLRECL(,AWORKPTR)                             0307
         CVD   @11,@TS00001                                        0307
         MVC   CONVERT(4,AWORKPTR),@TS00001+4                      0307
*       UNPK(HDRBLKLN,CONVERT);     /* PUT EBCDIC REC LENGTH @Y30OE95
*                                      IN HDR1               @Y30OE95*/
         UNPK  HDRBLKLN(5,HDR1PTR),CONVERT(4,AWORKPTR)             0308
*       HDRBLKLN(5)=HDRBLKLN(5)CHAR0;/* CHANGE SIGN         @Y30OE6D*/
         OI    HDRBLKLN+4(HDR1PTR),C'0'                            0309
*                                                                  0310
*       /*************************************************************/
*       /*                                                           */
*       /* GO FIND EXTENTS (BOE,EOE,EOD) OF THE DATA SET.    @Y30OE95*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0310
*       CALL CALCEXTS;              /* CALC EXTENTS FOR HDR  @Y30OE95*/
*                                                                  0310
         BAL   @14,CALCEXTS                                        0310
*       /*************************************************************/
*       /*                                                           */
*       /* PUT IN VOLUME SEQUENCE NUMBER AND MULTI-VOLUME    @Y30OE95*/
*       /* INDICATOR IF EOV.                                 @Y30OE95*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0311
*       AMWVSEQU=AMWVSEQU+ONE;      /* ADD 1 TO VOL SEQ NUM  @Y30OE6D*/
         LA    @11,1                                               0311
         SLR   @08,@08                                             0311
         IC    @08,AMWVSEQU(,AWORKPTR)                             0311
         ALR   @11,@08                                             0311
         STC   @11,AMWVSEQU(,AWORKPTR)                             0311
*       CVD(AMWVSEQU,TEMP1);        /* PACK VOL SEQ NUM      @Y30OE6D*/
         CVD   @11,@TS00001                                        0312
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0312
*       UNPK(HDRVOLSQ,TEMP1);       /* PUT VOL SEQ NO.       @Y30OE95
*                                      IN HDR1               @Y30OE95*/
         UNPK  HDRVOLSQ(2,HDR1PTR),TEMP1(2,AWORKPTR)               0313
*       HDRVOLSQ(2)=HDRVOLSQ(2)CHAR0;/* CHANGE SIGN         @Y30OE6D*/
         OI    HDRVOLSQ+1(HDR1PTR),C'0'                            0314
*       IF EOVPROC=ON               /* THIS EOV PROCESSING   @Y30OE95*/
*         THEN                      /* YES                   @Y30OE95*/
         TM    EOVPROC(AWORKPTR),B'10000000'                       0315
         BNO   @RF00315                                            0315
*         HDRMVLI=C;                /* INDICATE CONTINUED DS @Y30OE95*/
         MVI   HDRMVLI(HDR1PTR),C'C'                               0316
*       ELSE                        /*                       @Y30OE6D*/
*         DO;                       /*                       @Y30OE6D*/
         B     @RC00315                                            0317
@RF00315 DS    0H                                                  0318
*           IF AMWVSEQU>ONE         /* IF LAST VOL OF A      @Y30OE6D*/
*             THEN                  /* MULTI-VOL DS, THEN    @Y30OE6D*/
         CLI   AMWVSEQU(AWORKPTR),1                                0318
         BNH   @RF00318                                            0318
*             HDRMVLI=CHARL;        /* SET LAST VOL CHAR.    @Y30OE6D*/
         MVI   HDRMVLI(HDR1PTR),C'L'                               0319
*         END;                      /*                       @Y30OE6D*/
@RF00318 DS    0H                                                  0321
*       IF AMWDSSQL^=ZERO           /* IF DS QUALIFIER WAS   @Y30OE6D*/
*         THEN                      /* SPECIFIED, THEN       @Y30OE6D*/
@RC00315 CLI   AMWDSSQL(AWORKPTR),X'00'                            0321
         BE    @RF00321                                            0321
*         HDRSECIN=AMWDSSQL;        /* MOVE SAME IN HDR1     @Y30OE6D*/
         MVC   HDRSECIN(1,HDR1PTR),AMWDSSQL(AWORKPTR)              0322
*       IF AMWWTPTI^=ZERO           /* IF WRITE PROTECT      @Y30OE6D*/
*         THEN                      /* WAS SPECIFIED,        @Y30OE6D*/
@RF00321 CLI   AMWWTPTI(AWORKPTR),X'00'                            0323
         BE    @RF00323                                            0323
*         HDRWTPTI=AMWWTPTI;        /* MOVE SAME IN HDR1     @Y30OE6D*/
         MVC   HDRWTPTI(1,HDR1PTR),AMWWTPTI(AWORKPTR)              0324
*       IF AMWVOLAC^=ZERO           /* WAS VOLUME SECURITY   @Y30OE6D*/
*         THEN                      /* SPECIFIED, IF SO      @Y30OE6D*/
@RF00323 CLI   AMWVOLAC(AWORKPTR),X'00'                            0325
         BE    @RF00325                                            0325
*         DO;                       /*                       @Y30OE6D*/
*           RESPECIFY                                              0327
*             VOL1PTR RSTD;         /* RESTRICT VOL1 PTR     @Y30OE95*/
*           VOL1PTR=CHANPGM(3,2:4); /* GET PTR TO VOL1 LABEL @Y30OE95*/
         SLR   VOL1PTR,VOL1PTR                                     0328
         ICM   VOL1PTR,7,CHANPGM+17(CHNPGMPT)                      0328
*           VOLACCIN=AMWVOLAC;      /* MOVE SAME IN VOL1     @Y30OE6D*/
         MVC   VOLACCIN(1,VOL1PTR),AMWVOLAC(AWORKPTR)              0329
*           RESPECIFY                                              0330
*             VOL1PTR UNRSTD;       /* RELEASE VOL1PTR       @Y30OE6D*/
*         END;                      /*                       @Y30OE6D*/
*       IF AMWMLTVL=OFF            /* IF NOT MULTI-VOLUME   @Y30OE6D*/
*           AMWEXDTE(1)=ZERO        /* OR NO SAVED EXP DATE  @Y30OE6D*/
*         THEN                      /*                       @Y30OE6D*/
@RF00325 TM    AMWMLTVL(AWORKPTR),B'00010000'                      0332
         BZ    @RT00332                                            0332
         CLI   AMWEXDTE(AWORKPTR),X'00'                            0332
         BNE   @RF00332                                            0332
@RT00332 DS    0H                                                  0333
*         DO;                       /*                       @Y30OE6D*/
*           RESPECIFY                                              0334
*             REG1 RSTD;            /* RESTRICT REG 1        @Y30OE95*/
*                                                                  0334
*           /*********************************************************/
*           /*                                                       */
*           /* PUT IN EXPIRATION DATE.                       @Y30OE95*/
*           /* EXPIRATION DATE = CREATION DATE + 1 DAY .     @Z30OEAD*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0335
*           GEN;                                                   0335
*                                 /* GENERATE ASSEMBLER     @Y30OE95*/
         TIME DEC                    GET SYSTEM DATE          @Y30OE95
*           SAVEDATE=REG1;          /* SAVE DATE             @Y30OE95*/
         ST    REG1,SAVEDATE(,AWORKPTR)                            0336
*           RESPECIFY                                              0337
*             REG1 UNRSTD;          /* UNRESTRICT REG 1      @Y30OE95*/
*           UNPK(UNPKDATE,SAVEDATE);/* CONVERT SYSTEM DATE   @Y30OE95*/
         UNPK  UNPKDATE(8,AWORKPTR),SAVEDATE(4,AWORKPTR)           0338
*           CVB(DAY1,SAVEDATE(3:4));/* TO BINARY             @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0339
         MVC   @TS00001+6(2),SAVEDATE+2(AWORKPTR)                  0339
         CVB   @11,@TS00001                                        0339
         STH   @11,DAY1(,AWORKPTR)                                 0339
*           DAY1=DAY1+ONE;          /* ADD 1 FOR NEW EXPIR-  @Z30OEAD
*                                      ATION DATE            @Y30OE95*/
         AL    @11,@CF01817                                        0340
         STH   @11,DAY1(,AWORKPTR)                                 0340
*           PACK(SYSYEAR,UNPKYEAR); /* GET PACKED SYS YEAR   @Y30OE95*/
         PACK  SYSYEAR(2,AWORKPTR),UNPKYEAR(2,AWORKPTR)            0341
*           CVB(YEAR,SYSYEAR);      /* GET BINARY SYS YEAR   @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0342
         MVC   @TS00001+6(2),SYSYEAR(AWORKPTR)                     0342
         CVB   @11,@TS00001                                        0342
         STC   @11,YEAR(,AWORKPTR)                                 0342
*           REMAIN=YEAR//FOUR;      /* GET REMAINDER OF YEAR @Y30OE95
*                                      DIVIDED BY FOUR       @Y30OE95*/
         LR    @00,@11                                             0343
         SRDA  @00,32                                              0343
         D     @00,@CF01897                                        0343
         STCM  @00,15,REMAIN(AWORKPTR)                             0343
*           IF REMAIN=ZEROS         /* IS THIS A LEAP YEAR   @Y30OE95*/
*             THEN                  /* YES                   @Y30OE95*/
         C     @00,ZEROS                                           0344
         BNE   @RF00344                                            0344
*             DO;                   /* CONTINUE              @Y30OE95*/
*               NUMDAY=NUM366;      /* SET NO. OF DAYS=366   @Y30OE95*/
         MVC   NUMDAY(2,AWORKPTR),NUM366                           0346
*               TABLE=TABLELYR;     /* GET LEAP YEAR TABLE   @Y30OE95*/
         MVC   TABLE(24,AWORKPTR),TABLELYR                         0347
*             END;                  /*                       @Y30OE95*/
*           ELSE                    /*                       @Y30OE95*/
*             DO;                   /* CONTINUE              @Y30OE95*/
         B     @RC00344                                            0349
@RF00344 DS    0H                                                  0350
*               NUMDAY=NUM365;      /* SET NUM OF DAYS = 365 @Y30OE95*/
         MVC   NUMDAY(2,AWORKPTR),NUM365                           0350
*               TABLE=TABLENLP;     /* GET NON-LEAP YEAR TBL @Y30OE95*/
         MVC   TABLE(24,AWORKPTR),TABLENLP                         0351
*             END;                  /*                       @Y30OE95*/
*           IF DAY1>NUMDAY          /* IF PAST END OF YEAR   @Y30OE95*/
*             THEN                  /* YES                   @Y30OE95*/
@RC00344 LH    @11,DAY1(,AWORKPTR)                                 0353
         SLR   @08,@08                                             0353
         ICM   @08,3,NUMDAY(AWORKPTR)                              0353
         CR    @11,@08                                             0353
         BNH   @RF00353                                            0353
*             DO;                   /* CONTINUE              @Y30OE95*/
*               DAY1=DAY1-NUMDAY;   /* GET DAY NUM OF NXT YR @Y30OE95*/
         SLR   @11,@08                                             0355
         STH   @11,DAY1(,AWORKPTR)                                 0355
*               YEAR=YEAR+ONE;      /* UPDATE YEAR BY ONE    @Y30OE95*/
         LA    @11,1                                               0356
         SLR   @08,@08                                             0356
         IC    @08,YEAR(,AWORKPTR)                                 0356
         ALR   @11,@08                                             0356
         STC   @11,YEAR(,AWORKPTR)                                 0356
*             END;                  /*                       @Y30OE95*/
*           I=TWELVE;               /* SET MONTH CTR TO 12   @Y30OE95*/
@RF00353 LA    @11,12                                              0358
         ST    @11,I(,AWORKPTR)                                    0358
*           DO WHILE TRANSTBL(I)-DAY1>=ZERO;/* SET LOOP      @Y30OE95
*                                      UNTIL CORRECT MONTH   @Y30OE95
*                                      IS FOUND              @Y30OE95*/
         B     @DE00359                                            0359
@DL00359 DS    0H                                                  0360
*             I=I-ONE;              /* DECREASE MONTH BY ONE @Y30OE95*/
         L     @11,I(,AWORKPTR)                                    0360
         BCTR  @11,0                                               0360
         ST    @11,I(,AWORKPTR)                                    0360
*           END;                    /*                       @Y30OE95*/
@DE00359 L     @11,I(,AWORKPTR)                                    0361
         LR    @08,@11                                             0361
         ALR   @08,@08                                             0361
         LH    @08,TRANSTBL-2(@08,AWORKPTR)                        0361
         LH    @15,DAY1(,AWORKPTR)                                 0361
         LR    @14,@08                                             0361
         SLR   @14,@15                                             0361
         LTR   @14,@14                                             0361
         BNM   @DL00359                                            0361
*           DAY1=DAY1-TRANSTBL(I);  /* GET CORRECT DAY       @Y30OE95*/
         SLR   @15,@08                                             0362
         STH   @15,DAY1(,AWORKPTR)                                 0362
*           CVD(I,HDRMTH1);         /* GET PACKED MONTH      @Y30OE95*/
         CVD   @11,@TS00001                                        0363
         MVC   HDRMTH1(2,AWORKPTR),@TS00001+6                      0363
*           UNPK(HDRMONTH,HDRMTH1); /* EBCDIC MONTH TO HDR1  @Y30OE95*/
         UNPK  HDRMONTH(2,HDR1PTR),HDRMTH1(2,AWORKPTR)             0364
*           HDRMONTH(2)=HDRMONTH(2)CHAR0;/* CHANGE SIGN     @Y30OE6D*/
         OI    HDRMONTH+1(HDR1PTR),C'0'                            0365
*           CVD(DAY1,HDRDAY1);      /* GET PACKED DAY        @Y30OE95*/
         CVD   @15,@TS00001                                        0366
         MVC   HDRDAY1(2,AWORKPTR),@TS00001+6                      0366
*           UNPK(HDRDAY,HDRDAY1);   /* EBCDIC DAY TO HDR1    @Y30OE95*/
         UNPK  HDRDAY(2,HDR1PTR),HDRDAY1(2,AWORKPTR)               0367
*           HDRDAY(2)=HDRDAY(2)CHAR0;/* CHANGE SIGN         @Y30OE6D*/
         OI    HDRDAY+1(HDR1PTR),C'0'                              0368
*           CVD(YEAR,HDRYEAR1);     /* GET PACKED YEAR       @Y30OE95*/
         SLR   @11,@11                                             0369
         IC    @11,YEAR(,AWORKPTR)                                 0369
         CVD   @11,@TS00001                                        0369
         MVC   HDRYEAR1(2,AWORKPTR),@TS00001+6                     0369
*           UNPK(HDRYEAR,HDRYEAR1); /* EBCDIC YEAR TO HDR1   @Y30OE95*/
         UNPK  HDRYEAR(2,HDR1PTR),HDRYEAR1(2,AWORKPTR)             0370
*           HDRYEAR(2)=HDRYEAR(2)CHAR0;/* CHANGE SIGN       @Y30OE6D*/
         OI    HDRYEAR+1(HDR1PTR),C'0'                             0371
*           IF HDREXDTE<AMWEXDTE    /* 1 DAY PAST TODAY ?    @Z30OEAD*/
*             THEN                  /* NO                    @Y30OE6D*/
         CLC   HDREXDTE(6,HDR1PTR),AMWEXDTE(AWORKPTR)              0372
         BNL   @RF00372                                            0372
*             HDREXDTE=AMWEXDTE;    /* PUT DATE IN HDR1      @Y30OE6D*/
         MVC   HDREXDTE(6,HDR1PTR),AMWEXDTE(AWORKPTR)              0373
*           ELSE                    /*                       @Y30OE6D*/
*             AMWEXDTE=HDREXDTE;    /* SAVE NEW EXP. DATE    @Y30OE6D*/
         B     @RC00372                                            0374
@RF00372 MVC   AMWEXDTE(6,AWORKPTR),HDREXDTE(HDR1PTR)              0374
*         END;                      /*                       @Y30OE6D*/
*       ELSE                        /*                       @Y30OE6D*/
*         HDREXDTE=AMWEXDTE;        /* MOVE EXP DATE TO HDR1 @Y30OE6D*/
         B     @RC00332                                            0376
@RF00332 MVC   HDREXDTE(6,HDR1PTR),AMWEXDTE(AWORKPTR)              0376
*       IOBSKADR=VOL1ADDR;          /* SET SEEK ADDR TO VOL1 @Y30OE6D*/
@RC00332 MVC   IOBSKADR(4,IOBSTPTR),VOL1ADDR                       0377
*       CALL IOSBRTN;               /* GO WRITE LABEL TRACK  @Y30OE6D*/
         BAL   @14,IOSBRTN                                         0378
*       CHANPGM(1,1)=NOOP;          /* RESTORE NOOPCCW       @Y30OE6D*/
         MVI   CHANPGM(CHNPGMPT),X'03'                             0379
*       CHANPGM(23)=CCW21SAV;       /* RESTORE RWCCW23       @Y30OE6D*/
         MVC   CHANPGM+176(8,CHNPGMPT),CCW21SAV(AWORKPTR)          0380
*     END;                          /*                       @Y30OE6D*/
*   END FORMHDR1;                   /* END OF SUBROUTINE     @Y30OE95*/
@EL00006 DS    0H                                                  0382
@EF00006 DS    0H                                                  0382
@ER00006 L     @14,@SA00006                                        0382
         BR    @14                                                 0382
*                                                                  0383
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS ROUTINE IS CALLED TO UPDATE THE DEB, IOB AND       @Y30OE95*/
*/*  THE CHANNEL PROGRAM TO PREPARE TO WRITE A NEW OPENED    @Y30OE95*/
*/*  DATA SET OR CONTINUE TO WRITE AN ALREADY OPENED DATA    @Y30OE95*/
*/*  SET ON A NEW DISKETTE.                                  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0383
*UPDEBIOB:                          /*                       @Y30OE95*/
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OE95*/
UPDEBIOB DS    0H                                                  0384
*   RFY                             /*                       @Y30OE6D*/
*    (REG14,                        /*                       @Y30OE6D*/
*     IOBPRPTR) RSTD;               /* RESTRICT REGISTERS    @Y30OE6D*/
*   AMWBOE=''B;                     /* ZERO DEB BOE RESERVED @Y30OE6D*/
         XC    AMWBOE(4,AWORKPTR),AMWBOE(AWORKPTR)                 0385
*   AMWBOESS=ONE;                   /* DEB BOE RECORD = 1    @Y30OE6D*/
         MVI   AMWBOESS(AWORKPTR),X'01'                            0386
*   IF HDR1PTR=CHANPGM(4,2:4)       /* IF 1ST HDR1           @Y30OE95*/
*     THEN                          /* YES                   @Y30OE95*/
         SLR   @15,@15                                             0387
         ICM   @15,7,CHANPGM+25(CHNPGMPT)                          0387
         CR    HDR1PTR,@15                                         0387
         BNE   @RF00387                                            0387
*     AMWBOETT=ONE;                 /* SET TRK NUM TO 1      @Y30OE6D*/
         MVI   AMWBOETT(AWORKPTR),X'01'                            0388
*   ELSE                            /*                       @Y30OE95*/
*     DO;                           /* CONTINUE              @Y30OE95*/
         B     @RC00387                                            0389
@RF00387 DS    0H                                                  0390
*       HDR1PTR=CHANPGM(I+2,2:4);   /* GET PTR TO PREV HDR   @Y30OE95*/
         L     @15,I(,AWORKPTR)                                    0390
         SLA   @15,3                                               0390
         L     HDR1PTR,CHANPGM+8(@15,CHNPGMPT)                     0390
         LA    HDR1PTR,0(,HDR1PTR)                                 0390
*       PACK(TEMP1,HDREOECC);       /* PACK EOE TRK NUM      @Y30OE95*/
         PACK  TEMP1(2,AWORKPTR),HDREOECC(2,HDR1PTR)               0391
*       TEMP1(2)=TEMP1(2)&PLUSSIGN; /* SET POSITIVE SIGN     @Y30OE6D*/
         NI    TEMP1+1(AWORKPTR),X'FC'                             0392
*       CVB(TEMP2,TEMP1);           /* CONVERT IT TO BINARY  @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0393
         MVC   @TS00001+6(2),TEMP1(AWORKPTR)                       0393
         CVB   @15,@TS00001                                        0393
         STH   @15,TEMP2(,AWORKPTR)                                0393
*       AMWBOETT=TEMP2+ONE;         /* ADD 1 AND PUT IN DEB  @Y30OE6D*/
         AL    @15,@CF01817                                        0394
         STC   @15,AMWBOETT(,AWORKPTR)                             0394
*     END;                          /*                       @Y30OE6D*/
*   IOBSKADR=AMWBOE;                /* UPDTE 1ST IOB SEEKADR @Y30OE6D*/
@RC00387 MVC   IOBSKADR(4,IOBSTPTR),AMWBOE(AWORKPTR)               0396
*   AMWBOETT=AMWBOETT-ONE;          /* SUBT 1 FROM TRK NUM   @Y30OE6D*/
         SLR   @15,@15                                             0397
         IC    @15,AMWBOETT(,AWORKPTR)                             0397
         BCTR  @15,0                                               0397
         STC   @15,AMWBOETT(,AWORKPTR)                             0397
*   IOBPRPTR=SAVEIOBX;              /* GET PTR TO IOB PREFIX @Y30OE95*/
         L     IOBPRPTR,SAVEIOBX(,AWORKPTR)                        0398
*   ECBCC=GOODIO;                   /* POST 1ST ECB GOOD     @Y30OE95*/
         L     @15,IOBECBPT(,IOBSTPTR)                             0399
         MVI   ECBCC(@15),X'7F'                                    0399
*   IF ACBLRECL<=HZERO             /* IF REC LNGTH <= 0 OR  @Y30OE6D*/
*       ACBLRECL>MAXLRECL           /* > 128                 @Y30OE6D*/
*     THEN                          /*                       @Y30OE6D*/
         LH    @15,ACBLRECL(,AWORKPTR)                             0400
         LH    @11,HZERO                                           0400
         N     @11,@CF02109                                        0400
         CR    @15,@11                                             0400
         BNH   @RT00400                                            0400
         CH    @15,MAXLRECL                                        0400
         BNH   @RF00400                                            0400
@RT00400 DS    0H                                                  0401
*     ACBLRECL=MAXLRECL;            /* SET LRECL TO 128      @Y30OE6D*/
         LH    @15,MAXLRECL                                        0401
         STH   @15,ACBLRECL(,AWORKPTR)                             0401
*   DO I=1 TO 2;                    /* SET LOOP FOR 2 IOB'S  @Y30OE95*/
@RF00400 LA    @15,1                                               0402
         ST    @15,I(,AWORKPTR)                                    0402
@DL00402 DS    0H                                                  0403
*     CHNPGMPT=IOBSTART;            /* GET PTR TO CHAN PGM   @Y30OE95*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0403
*     DO J=3 TO 28;                 /* SET LOOP FOR 26 CCWS  @Y30OE95*/
         LA    @15,3                                               0404
         ST    @15,J(,AWORKPTR)                                    0404
@DL00404 DS    0H                                                  0405
*       CHANPGM(J,7:8)=ACBLRECL;    /* SET RIGHT BYTECNT     @Y30OE95*/
         L     @15,J(,AWORKPTR)                                    0405
         SLA   @15,3                                               0405
         LH    @11,ACBLRECL(,AWORKPTR)                             0405
         ALR   @15,CHNPGMPT                                        0405
         BCTR  @15,0                                               0405
         BCTR  @15,0                                               0405
         STCM  @11,3,CHANPGM(@15)                                  0405
*     END;                          /*                       @Y30OE95*/
         LA    @15,1                                               0406
         AL    @15,J(,AWORKPTR)                                    0406
         ST    @15,J(,AWORKPTR)                                    0406
         C     @15,@CF01584                                        0406
         BNH   @DL00404                                            0406
*     IOBSTPTR=IOBNIOBA+LENGTH(IOBORG01);/* 2ND IOB          @Y30OE95*/
         L     @15,IOBPTR-1(,AWORKPTR)                             0407
         LA    IOBSTPTR,8                                          0407
         AL    @15,@CF02104                                        0407
         AL    IOBSTPTR,IOBNIOBA-8(,@15)                           0407
*     ECBCC=GOODIO;                 /* POST 2ND ECB GOOD     @Y30OE95*/
         L     @15,IOBECBPT(,IOBSTPTR)                             0408
         MVI   ECBCC(@15),X'7F'                                    0408
*   END;                            /*                       @Y30OE95*/
         LA    @15,1                                               0409
         AL    @15,I(,AWORKPTR)                                    0409
         ST    @15,I(,AWORKPTR)                                    0409
         C     @15,@CF00196                                        0409
         BNH   @DL00402                                            0409
*   IOBSKADR=AMWBOE;                /* UPDTE 2ND IOB SEEKADR @Y30OE6D*/
         MVC   IOBSKADR(4,IOBSTPTR),AMWBOE(AWORKPTR)               0410
*   IOBSTPTR=SAVEIOB;               /* RESTORE PTR TO IOB    @Y30OE95*/
         L     IOBSTPTR,SAVEIOB(,AWORKPTR)                         0411
*   CHNPGMPT=IOBSTART;              /* GET PTR TO CHAN PGM   @Y30OE95*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0412
*   CCWPTR=ADDR(CHANPGM(3));        /* CCWPTR PTS TO 1ST     @Y30OE95
*                                      WRITE CCW OF 1ST IOB  @Y30OE95*/
         LA    @15,CHANPGM+16(,CHNPGMPT)                           0413
         STCM  @15,7,CCWPTR(AWORKPTR)                              0413
*   AMWBOETT=AMWBOETT+ONE;          /* RESTORE DEB BOE       @Y30OE6D*/
         LA    @15,1                                               0414
         SLR   @11,@11                                             0414
         IC    @11,AMWBOETT(,AWORKPTR)                             0414
         ALR   @15,@11                                             0414
         STC   @15,AMWBOETT(,AWORKPTR)                             0414
*   RFY                             /*                       @Y30OE6D*/
*    (REG14,                        /*                       @Y30OE6D*/
*     IOBPRPTR) UNRSTD;             /* RELEASE REGISTERS     @Y30OE6D*/
*   END UPDEBIOB;                   /* END OF UPDATE ROUT.   @Y30OE95*/
@EL00007 DS    0H                                                  0416
@EF00007 DS    0H                                                  0416
@ER00007 BR    @14                                                 0416
*                                                                  0417
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS PROCEDURE VALIDITY CHECKS THE VOL1 LABEL.  THE     @Y30OE95*/
*/*  VOLID MUST BE LEFT JUSTIFIED, CONTAIN ONLY CHARACTERS   @Y30OE95*/
*/*  A-Z, 0-9 AND MUST CONTAIN NO IMBEDDED BLANKS.           @Y30OE95*/
*/*                                                          @Y30OE95*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0417
*VOL1LABL:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
VOL1LABL ST    @14,@SA00008                                        0417
*   RESPECIFY                                                      0418
*     VOL1PTR RSTD;                 /* RESTRICT VOL1 PTR     @Y30OE95*/
*   VOL1PTR=CHANPGM(3,2:4);         /* GET PTR TO VOL1 LABEL @Y30OE95*/
         SLR   VOL1PTR,VOL1PTR                                     0419
         ICM   VOL1PTR,7,CHANPGM+17(CHNPGMPT)                      0419
*   GOODVOL1=OFF;                   /* INITIALIZE FLAG       @Y30OE6D*/
         NI    GOODVOL1(AWORKPTR),B'10111111'                      0420
*   IF VOLLABID=VOL1                /* IS LABEL = VOL1       @Y30OE95*/
*     THEN                          /* YES                   @Y30OE95*/
         CLC   VOLLABID(4,VOL1PTR),VOL1                            0421
         BNE   @RF00421                                            0421
*     DO;                           /*                       @Y30OE6D*/
*       BLANKCHR=OFF;               /* INITIALIZE FLAGS      @Y30OE95*/
         NI    BLANKCHR(AWORKPTR),B'11101111'                      0423
*       BADVOLID=OFF;               /* INITIALIZE FLAGS      @Y30OE95*/
         NI    BADVOLID(AWORKPTR),B'11101111'                      0424
*       CHARPTR=ADDR(VOLID);        /* INIT CHAR PTR         @Y30OE95*/
         LA    CHARPTR,VOLID(,VOL1PTR)                             0425
*       IF VOLID(1)=BLANK           /* IF 1ST CHAR IS A      @Y30OE6D*/
*         THEN                      /* BLANK, THEN SET       @Y30OE6D*/
         CLI   VOLID(VOL1PTR),C' '                                 0426
         BNE   @RF00426                                            0426
*         BADVOLID=ON;              /* BAD VOLID IND         @Y30OE6D*/
         OI    BADVOLID(AWORKPTR),B'00010000'                      0427
*       ELSE                        /*                       @Y30OE6D*/
*         DO I=1 TO 6               /* SET LOOP FOR 6 CHARS  @Y30OE95*/
*               WHILE BADVOLID=OFF; /* TIL BAD ID FND        @Y30OE95*/
         B     @RC00426                                            0428
@RF00426 LA    @15,1                                               0428
         ST    @15,I(,AWORKPTR)                                    0428
@DL00428 TM    BADVOLID(AWORKPTR),B'00010000'                      0428
         BNZ   @DC00428                                            0428
*           IF^(CHARACTR>=CHARA&    /*                       @Y30OE6D*/
*               CHARACTR<=CHARI    /*                       @Y30OE6D*/
*               CHARACTR>=CHARJ&    /*                       @Y30OE6D*/
*               CHARACTR<=CHARR    /*                       @Y30OE6D*/
*               CHARACTR>=CHARS&    /*                       @Y30OE6D*/
*               CHARACTR<=CHARZ    /*                       @Y30OE6D*/
*               CHARACTR>=CHAR0&    /*                       @Y30OE6D*/
*               CHARACTR<=CHAR9)    /*                       @Y30OE6D*/
*             THEN                  /* NO                    @Y30OE95*/
         CLI   CHARACTR(CHARPTR),C'A'                              0429
         BL    @GL00009                                            0429
         CLI   CHARACTR(CHARPTR),C'I'                              0429
         BNH   @RF00429                                            0429
@GL00009 CLI   CHARACTR(CHARPTR),C'J'                              0429
         BL    @GL00008                                            0429
         CLI   CHARACTR(CHARPTR),C'R'                              0429
         BNH   @RF00429                                            0429
@GL00008 CLI   CHARACTR(CHARPTR),C'S'                              0429
         BL    @GL00007                                            0429
         CLI   CHARACTR(CHARPTR),C'Z'                              0429
         BNH   @RF00429                                            0429
@GL00007 CLI   CHARACTR(CHARPTR),C'0'                              0429
         BL    @RT00429                                            0429
         CLI   CHARACTR(CHARPTR),C'9'                              0429
         BNH   @RF00429                                            0429
@RT00429 DS    0H                                                  0430
*             IF CHARACTR=BLANK     /* BLANK CHAR?           @Y30OE95*/
*               THEN                /* YES                   @Y30OE95*/
         CLI   CHARACTR(CHARPTR),C' '                              0430
         BNE   @RF00430                                            0430
*               BLANKCHR=ON;        /* BLANK BIT ON          @Y30OE95*/
         OI    BLANKCHR(AWORKPTR),B'00010000'                      0431
*             ELSE                  /*                       @Y30OE95*/
*               BADVOLID=ON;        /* ERROR BIT ON          @Y30OE95*/
         B     @RC00430                                            0432
@RF00430 OI    BADVOLID(AWORKPTR),B'00010000'                      0432
*           ELSE                    /*                       @Y30OE95*/
*             IF BLANKCHR=ON        /* PREVIOUS BLANK?       @Y30OE95*/
*               THEN                /* YES                   @Y30OE95*/
         B     @RC00429                                            0433
@RF00429 TM    BLANKCHR(AWORKPTR),B'00010000'                      0433
         BNO   @RF00433                                            0433
*               BADVOLID=ON;        /* ERROR BIT ON          @Y30OE95*/
         OI    BADVOLID(AWORKPTR),B'00010000'                      0434
*           CHARPTR=CHARPTR+ONE;    /* PT NXT CHAR           @Y30OE95*/
@RF00433 DS    0H                                                  0435
@RC00429 AL    CHARPTR,@CF01817                                    0435
*         END;                      /*                       @Y30OE95*/
         LA    @15,1                                               0436
         AL    @15,I(,AWORKPTR)                                    0436
         ST    @15,I(,AWORKPTR)                                    0436
         C     @15,@CF00412                                        0436
         BNH   @DL00428                                            0436
@DC00428 DS    0H                                                  0437
*       IF BADVOLID=OFF             /* BAD VOLID?            @Y30OE95*/
*         THEN                      /* NO                    @Y30OE95*/
@RC00426 TM    BADVOLID(AWORKPTR),B'00010000'                      0437
         BNZ   @RF00437                                            0437
*         IF VOLLABVR=W             /* IS LBL VERSION=W      @Y30OE95*/
*           THEN                    /* YES                   @Y30OE95*/
         CLI   VOLLABVR(VOL1PTR),C'W'                              0438
         BNE   @RF00438                                            0438
*                                                                  0439
*           /*********************************************************/
*           /*                                                       */
*           /* IF VOL1 LABEL IS GOOD, THEN PUT VOLID IN      @Y30OE95*/
*           /* UCB. IF NOT GOOD, CHECK IF END OF DISKETTE.   @Y30OE95*/
*           /* IF SO, PUT END OF DISKETTE VOLID IN UCB.      @Y30OE95*/
*           /* OTHERWISE ZERO UCBVOLID FIELD AND ISSUE       @Y30OE95*/
*           /* ERROR MESSAGE.                                @Y30OE95*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0439
*           DO;                     /* CONTINUE              @Y30OE95*/
*             SAVEVOL=VOLID;        /* UPDATE VOL            @Y30OE6D*/
         MVC   SAVEVOL(6,AWORKPTR),VOLID(VOL1PTR)                  0440
*             CALL UCBUPDAT;        /* SER IN UCB            @Y30OE6D*/
         BAL   @14,UCBUPDAT                                        0441
*             GOODVOL1=ON;          /* IND GOOD VOL1         @Y30OE95*/
         OI    GOODVOL1(AWORKPTR),B'01000000'                      0442
*           END;                    /*                       @Y30OE95*/
*     END;                          /*                       @Y30OE95*/
@RF00438 DS    0H                                                  0444
@RF00437 DS    0H                                                  0445
*   IF GOODVOL1=OFF                 /* WAS VOL1 LABEL OK     @Y30OE95*/
*     THEN                          /* NO                    @Y30OE95*/
@RF00421 TM    GOODVOL1(AWORKPTR),B'01000000'                      0445
         BNZ   @RF00445                                            0445
*     IF VOLID^=ENDDSKT             /* IS THIS LAST DISKETTE @Y30OE6D*/
*       THEN                        /* NO                    @Y30OE95*/
         CLC   VOLID(6,VOL1PTR),ENDDSKT                            0446
         BE    @RF00446                                            0446
*       DO;                         /* CONTINUE              @Y30OE95*/
*         SAVEVOL=''B;              /* VOL SER = 0           @Y30OE6D*/
         XC    SAVEVOL(6,AWORKPTR),SAVEVOL(AWORKPTR)               0448
*         CALL UCBUPDAT;            /* GO UPDATE VOL SER     @Y30OE6D*/
         BAL   @14,UCBUPDAT                                        0449
*         ERTNCDE=BADVOL1;          /* SET BAD VOL1 RTN CODE @Y30OE6D*/
         MVI   ERTNCDE(SETDSKPT),X'08'                             0450
*         MSGINDEX=VOL1MSG;         /* INDEX FOR VOL1 MSG 14 @Y30OE6D*/
         MVI   MSGINDEX(AWORKPTR),X'0E'                            0451
*         CALL MSGSUBRT;            /* CALL THE MSG SUBROUT. @Y30OE6D*/
         BAL   @14,MSGSUBRT                                        0452
*       END;                        /*                       @Y30OE95*/
*     ELSE                          /*                       @Y30OE95*/
*       DO;                         /* CONTINUE              @Y30OE95*/
         B     @RC00446                                            0454
@RF00446 DS    0H                                                  0455
*         SAVEVOL=ENDDSKT;          /* UPDATE UCBVOLID       @Y30OE6D*/
         MVC   SAVEVOL(6,AWORKPTR),ENDDSKT                         0455
*         CALL UCBUPDAT;            /* GO UPDATE UCB         @Y30OE6D*/
         BAL   @14,UCBUPDAT                                        0456
*         ERTNCDE=ENDDISK;          /* SET END DISK R.C.     @Y30OE6D*/
         MVI   ERTNCDE(SETDSKPT),X'14'                             0457
*       END;                        /*                       @Y30OE95*/
*   ELSE                            /*                       @Y30OE95*/
*     DO;                           /* CONTINUE              @Y30OE95*/
         B     @RC00445                                            0459
@RF00445 DS    0H                                                  0460
*                                                                  0460
*       /*************************************************************/
*       /*                                                           */
*       /* SECURITY PROCESSING - A WTOR IS ISSUED TO WHICH   @Y30OE95*/
*       /* THE OPERATOR MUST REPLY WITH THE CORRECT ACCESS   @Y30OE95*/
*       /* CODE. IF MORE THAN ONE DATASET IS ON THE          @Y30OE95*/
*       /* DISKETTE, THE MESSAGE IS ISSUED ONLY FOR THE      @Y30OE95*/
*       /* FIRST DATA SET OPENED.                            @Y30OE95*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0460
*       IF VOLACCIN^=BLANK          /* IS ACCESS CODE REQD   @Y30OE95*/
*         THEN                      /* YES                   @Y30OE95*/
         CLI   VOLACCIN(VOL1PTR),C' '                              0460
         BE    @RF00460                                            0460
*         DO;                       /* CONTINUE              @Y30OE95*/
*           MSGINDEX=SECRMSG;       /* SET INDEX FOR MSG 17  @Y30OE6D*/
         MVI   MSGINDEX(AWORKPTR),X'11'                            0462
*           DSIDLOP=ON;             /* DONT USE DSID         @Z30OE78*/
         OI    DSIDLOP,B'10000000'                                 0463
*           JOBNMLOP=ON;            /* DONT USE JOBNAME      @Z30OE78*/
         OI    JOBNMLOP,B'10000000'                                0464
*           SETRETCD=SECUREVL;      /* SET SECURE VOL CODE   @Y30OE6D*/
         MVC   SETRETCD(2,SETDSKPT),SECUREVL                       0465
*           BADREPLY=ON;            /* SET BAD REPLY IND ON  @Y30OE6D*/
         OI    BADREPLY(AWORKPTR),B'00100000'                      0466
*           DO I=1 TO 3 WHILE       /* GIVE OPER. 3 CHANCES  @Y30OE6D*/
*                 BADREPLY=ON;      /* TO GIVE THE           @Y30OE6D
*                                      CORRECT REPLY         @Y30OE6D*/
         LA    @08,1                                               0467
         ST    @08,I(,AWORKPTR)                                    0467
@DL00467 TM    BADREPLY(AWORKPTR),B'00100000'                      0467
         BNO   @DC00467                                            0467
*             MSGTYPCD=WTORCD;      /* MSG TYPE IS WTOR      @Y30OE6D*/
         MVI   MSGTYPCD(AWORKPTR),X'02'                            0468
*             CALL MSGSUBRT;        /* CALL THE MSG SUBROUT. @Y30OE6D*/
         BAL   @14,MSGSUBRT                                        0469
*             IF REPLYARA=VOLACCIN  /* IS REPLY CORRECT      @Y30OE6D*/
*               THEN                /* YES                   @Y30OE95*/
         L     @08,MSGREPAD(,AWORKPTR)                             0470
         CLC   REPLYARA(1,@08),VOLACCIN(VOL1PTR)                   0470
         BNE   @RF00470                                            0470
*               DO;                 /*                       @Y30OE6D*/
*                 SETRETCD=''B;     /* SET RETURN CODE TO 0  @Y30OE6D*/
         XC    SETRETCD(2,SETDSKPT),SETRETCD(SETDSKPT)             0472
*                 BADREPLY=OFF;     /* INDICATE GOOD REPLY   @Y30OE6D*/
         NI    BADREPLY(AWORKPTR),B'11011111'                      0473
*               END;                /*                       @Y30OE6D*/
*             ELSE                  /*                       @Y30OE95*/
*               IF REPLYARA=BLANK   /* IF REPLY WAS BLANK    @Y30OE6D*/
*                 THEN              /*                       @Y30OE6D*/
         B     @RC00470                                            0475
@RF00470 L     @08,MSGREPAD(,AWORKPTR)                             0475
         CLI   REPLYARA(@08),C' '                                  0475
         BNE   @RF00475                                            0475
*                 BADREPLY=OFF;     /* THEN SET GOOD REPLY   @Y30OE6D*/
         NI    BADREPLY(AWORKPTR),B'11011111'                      0476
*           END;                    /*                       @Y30OE95*/
@RF00475 DS    0H                                                  0477
@RC00470 LA    @08,1                                               0477
         AL    @08,I(,AWORKPTR)                                    0477
         ST    @08,I(,AWORKPTR)                                    0477
         C     @08,@CF00217                                        0477
         BNH   @DL00467                                            0477
@DC00467 DS    0H                                                  0478
*           DSIDLOP=OFF;            /* MAKE DSID USEABLE     @Z30OE78*/
         NI    DSIDLOP,B'01111111'                                 0478
*           JOBNMLOP=OFF;           /* MAKE JOBNAME USEABLE  @Z30OE78*/
         NI    JOBNMLOP,B'01111111'                                0479
*           VOLACCIN=BLANK;         /* BLANK VOL SEC IND     @Y30OE95*/
         MVI   VOLACCIN(VOL1PTR),C' '                              0480
*         END;                      /*                       @Y30OE95*/
*     END;                          /*                       @Y30OE95*/
*   RESPECIFY                                                      0483
*     VOL1PTR UNRSTD;               /* RELEASE VOL1PTR       @Y30OE6D*/
*   END VOL1LABL;                   /* END OF SUBROUTINE     @Y30OE95*/
@EL00008 DS    0H                                                  0484
@EF00008 DS    0H                                                  0484
@ER00008 L     @14,@SA00008                                        0484
         BR    @14                                                 0484
*                                                                  0485
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS SECTION WILL CHECK IF A DISKETTE IS SCRATCH AND    @Y30OE95*/
*/*  CHECK ALL HDR1 LABELS FOR DELETED DATA SETS ('DDR1').   @Y30OE95*/
*/*  IF NOT DELETED, CHECK FOR EXPIRED EXPIRATION DATES. IF  @Y30OE95*/
*/*  ALL HDR1'S ARE EITHER DELETED OR EXPIRED, DISKETTE IS   @Y30OE95*/
*/*  CONSIDERED SCRATCH.                                     @Y30OE95*/
*/*                                                          @Y30OE95*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0485
*CKSCRDSK:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
CKSCRDSK ST    @14,@SA00009                                        0485
*   NOSRTCDS=OFF;                   /* SET NONSRTCH D.S. OFF @Y30OE95*/
*   GOODHDR1=ON;                    /* SET GOOD HDR1 IND ON  @Y30OE6D*/
         OI    GOODHDR1(AWORKPTR),B'00100000'                      0487
         NI    NOSRTCDS(AWORKPTR),B'11111011'                      0487
*   DO I=4 TO 22                    /* LOOP UNTIL A NON-     @Y30OE95*/
*         WHILE NOSRTCDS=OFF;       /* SCRATCH D.S. IS FOUND @Y30OE95*/
         LA    @11,4                                               0488
         ST    @11,I(,AWORKPTR)                                    0488
@DL00488 TM    NOSRTCDS(AWORKPTR),B'00000100'                      0488
         BNZ   @DC00488                                            0488
*     HDR1PTR=CHANPGM(I,2:4);       /* GET PTR TO HDR1       @Y30OE95*/
         L     @11,I(,AWORKPTR)                                    0489
         SLA   @11,3                                               0489
         AL    @11,@CF02104                                        0489
         L     HDR1PTR,CHANPGM(@11,CHNPGMPT)                       0489
         LA    HDR1PTR,0(,HDR1PTR)                                 0489
*     IF HDRID(1)^=DELETED          /* IS THIS A DELETED DS  @Y30OE95*/
*       THEN                        /* NO                    @Y30OE95*/
         CLI   HDRID(HDR1PTR),C'D'                                 0490
         BE    @RF00490                                            0490
*       DO;                         /*                       @Y30OE6D*/
*         IF HDREXDTE(1)^=BLANK     /* IS THERE AN EXP.      @Y30OE95*/
*           THEN                    /* DATE                  @Y30OE95*/
         CLI   HDREXDTE(HDR1PTR),C' '                              0492
         BE    @RF00492                                            0492
*           DO;                     /* YES, CONTINUE         @Y30OE95*/
*             DO J=1 TO 6           /* SET LOOP FOR 6 CHARS. @ZA00796*/
*                   WHILE GOODHDR1=ON;/* FOR VALIDATION      @Y30OE6D*/
         LA    @11,1                                               0494
         ST    @11,J(,AWORKPTR)                                    0494
@DL00494 TM    GOODHDR1(AWORKPTR),B'00100000'                      0494
         BNO   @DC00494                                            0494
*               IF HDREXDTE(J)<CHAR0/* DATE IS GOOD IF      @ZA04455*/
*                   HDREXDTE(J)>CHAR9/* RANGE IS BETWEEN     @ZA04455*/
*                 THEN              /* 0 AND 9               @Y30OE6D*/
         L     @11,J(,AWORKPTR)                                    0495
         ALR   @11,HDR1PTR                                         0495
         CLI   HDREXDTE-1(@11),C'0'                                0495
         BL    @RT00495                                            0495
         L     @11,J(,AWORKPTR)                                    0495
         ALR   @11,HDR1PTR                                         0495
         CLI   HDREXDTE-1(@11),C'9'                                0495
         BNH   @RF00495                                            0495
@RT00495 DS    0H                                                  0496
*                 GOODHDR1=OFF;     /* IND BAD HDR1          @Y30OE6D*/
         NI    GOODHDR1(AWORKPTR),B'11011111'                      0496
*             END;                  /*                       @Y30OE6D*/
@RF00495 LA    @11,1                                               0497
         AL    @11,J(,AWORKPTR)                                    0497
         ST    @11,J(,AWORKPTR)                                    0497
         C     @11,@CF00412                                        0497
         BNH   @DL00494                                            0497
@DC00494 DS    0H                                                  0498
*             IF GOODHDR1=ON&       /* IF EXP DATE OK,       @Y30OE6D*/
*                 (HDRMONTH>CHAR00& /* THEN CHECK FOR        @Y30OE6D*/
*                 HDRMONTH<=CHAR12)&/* VALID MONTH AND       @Y30OE6D*/
*                 (HDRDAY>CHAR00&   /* DAY ENTRIES           @Y30OE6D*/
*                 HDRDAY<=CHAR31)   /*                       @Y30OE6D*/
*               THEN                /*                       @Y30OE6D*/
         TM    GOODHDR1(AWORKPTR),B'00100000'                      0498
         BNO   @RF00498                                            0498
         CLC   HDRMONTH(2,HDR1PTR),CHAR00                          0498
         BNH   @RF00498                                            0498
         CLC   HDRMONTH(2,HDR1PTR),CHAR12                          0498
         BH    @RF00498                                            0498
         CLC   HDRDAY(2,HDR1PTR),CHAR00                            0498
         BNH   @RF00498                                            0498
         CLC   HDRDAY(2,HDR1PTR),CHAR31                            0498
         BH    @RF00498                                            0498
*               DO;                 /*                       @Y30OE6D*/
*                 RESPECIFY                                        0500
*                   REG1 RSTD;      /* RESTRICT REG 1        @Y30OE95*/
*                 GEN;                                             0501
*                                  /* GENERATE ASSEMBLER    @Y30OE95*/
               TIME DEC                ISSUE TIME MACRO       @Y30OE95
*                 SAVEDATE=REG1;    /* SAVE SYSTEM DATE      @Y30OE95*/
         ST    REG1,SAVEDATE(,AWORKPTR)                            0502
*                 RESPECIFY                                        0503
*                   REG1 UNRSTD;    /* UNRESTRICT REG1       @Y30OE95*/
*                 UNPK(UNPKDATE,SAVEDATE);/* CONV TO EBCDIC  @Y30OE95*/
         UNPK  UNPKDATE(8,AWORKPTR),SAVEDATE(4,AWORKPTR)           0504
*                 PACK(SYSYEAR,UNPKYEAR);/* PACK SYS YEAR    @Y30OE95*/
         PACK  SYSYEAR(2,AWORKPTR),UNPKYEAR(2,AWORKPTR)            0505
*                 SYSDAY=SAVEDATE(3:4);/* GET PACKED SYS DAY @Y30OE95*/
         MVC   SYSDAY(2,AWORKPTR),SAVEDATE+2(AWORKPTR)             0506
*                 PACK(HDRYEAR1,HDRYEAR);/* PACK HDR1 YEAR   @Y30OE95*/
         PACK  HDRYEAR1(2,AWORKPTR),HDRYEAR(2,HDR1PTR)             0507
*                 IF HDRYEAR1=SYSYEAR/* IS THE YEAR THE SAME @Y30OE95*/
*                   THEN            /* YES                   @Y30OE95*/
         CLC   HDRYEAR1(2,AWORKPTR),SYSYEAR(AWORKPTR)              0508
         BNE   @RF00508                                            0508
*                   DO;             /* CONTINUE              @Y30OE95*/
*                     PACK(HDRDAY1,HDRDAY);/* PACK HDR1 DAY  @Y30OE95*/
         PACK  HDRDAY1(2,AWORKPTR),HDRDAY(2,HDR1PTR)               0510
*                     PACK(HDRMTH1,HDRMONTH);/* PACK HDR1 MON      0511
*                                                            @Y30OE95*/
         PACK  HDRMTH1(2,AWORKPTR),HDRMONTH(2,HDR1PTR)             0511
*                     CVB(MONTH,HDRMTH1);/* GET BINARY MONTH @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0512
         MVC   @TS00001+6(2),HDRMTH1(AWORKPTR)                     0512
         CVB   @11,@TS00001                                        0512
         STC   @11,MONTH(,AWORKPTR)                                0512
*                     CVB(DAY,HDRDAY1);/* GET BINARY DAY     @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0513
         MVC   @TS00001+6(2),HDRDAY1(AWORKPTR)                     0513
         CVB   @08,@TS00001                                        0513
         STC   @08,DAY(,AWORKPTR)                                  0513
*                     CVB(YEAR,HDRYEAR1);/* GET BINARY YEAR  @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0514
         MVC   @TS00001+6(2),HDRYEAR1(AWORKPTR)                    0514
         CVB   @15,@TS00001                                        0514
         STC   @15,YEAR(,AWORKPTR)                                 0514
*                     REMAIN=YEAR//FOUR;/* DIVIDE YEAR BY 4  @Y30OE95
*                                      AND SAVE REMAINDER    @Y30OE95*/
         LR    @00,@15                                             0515
         SRDA  @00,32                                              0515
         D     @00,@CF01897                                        0515
         STCM  @00,15,REMAIN(AWORKPTR)                             0515
*                     IF REMAIN=ZEROS/* IS THIS A LEAP YEAR  @Y30OE95*/
*                       THEN        /* YES                   @Y30OE95*/
         C     @00,ZEROS                                           0516
         BNE   @RF00516                                            0516
*                       JULIANDY=LPYRTBL(MONTH)+DAY;/* GET   @Y30OE95
*                                      JULIAN DAY            @Y30OE95*/
         ALR   @11,@11                                             0517
         AH    @08,LPYRTBL-2(@11)                                  0517
         STH   @08,JULIANDY(,AWORKPTR)                             0517
*                     ELSE          /*                       @Y30OE95*/
*                       JULIANDY=NLPYRTBL(MONTH)+DAY;/* GET  @Y30OE95
*                                      JULIANDY FOR          @Y30OE95
*                                      NON-LEAP YEAR         @Y30OE95*/
         B     @RC00516                                            0518
@RF00516 SLR   @11,@11                                             0518
         IC    @11,MONTH(,AWORKPTR)                                0518
         ALR   @11,@11                                             0518
         SLR   @08,@08                                             0518
         IC    @08,DAY(,AWORKPTR)                                  0518
         AH    @08,NLPYRTBL-2(@11)                                 0518
         STH   @08,JULIANDY(,AWORKPTR)                             0518
*                     CVD(JULIANDY,JULIANDT);/* GET PACKED   @Y30OE95
*                                      JULIAN DAY            @Y30OE95*/
@RC00516 LH    @11,JULIANDY(,AWORKPTR)                             0519
         CVD   @11,@TS00001                                        0519
         MVC   JULIANDT(2,AWORKPTR),@TS00001+6                     0519
*                     IF SYSDAY<JULIANDT/* HAS EXPIRATION    @Y30OE95
*                                      DATE BEEN MET         @Y30OE95*/
*                       THEN        /* NO, D.S.IS STILL GOOD @Y30OE95*/
         CLC   SYSDAY(2,AWORKPTR),JULIANDT(AWORKPTR)               0520
         BNL   @RF00520                                            0520
*                       NOSRTCDS=ON;/* INDIC NONSCRATCH DS   @Y30OE95*/
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0521
*                   END;            /*                       @Y30OE95*/
*                 ELSE              /*                       @Y30OE95*/
*                   IF HDRYEAR1>SYSYEAR/* IS EXPIR YEAR >    @Y30OE95
*                                      THAN SYSTEM YEAR      @Y30OE95*/
*                     THEN          /* YES, D.S. STILL GOOD  @Y30OE95*/
         B     @RC00508                                            0523
@RF00508 CLC   HDRYEAR1(2,AWORKPTR),SYSYEAR(AWORKPTR)              0523
         BNH   @RF00523                                            0523
*                     NOSRTCDS=ON;  /* INDIC D.S. GOOD       @Y30OE95*/
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0524
*               END;                /*                       @Y30OE95*/
*             ELSE                  /*                       @Y30OE95*/
*               DO;                 /*                       @Y30OE95*/
         B     @RC00498                                            0526
@RF00498 DS    0H                                                  0527
*                 GOODHDR1=OFF;     /* IND BAD HDR1          @Y30OE95*/
*                 NOSRTCDS=ON;      /* IND NO SCRATCH DS     @Y30OE95*/
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0528
         NI    GOODHDR1(AWORKPTR),B'11011111'                      0528
*               END;                /*                       @Y30OE95*/
*           END;                    /*                       @Y30OE6D*/
@RC00498 DS    0H                                                  0531
*         IF HDRWTPTI^=BLANK        /* D.S. WRITE PROTECTED  @Y30OE95*/
*           THEN                    /* YES                   @Y30OE95*/
@RF00492 CLI   HDRWTPTI(HDR1PTR),C' '                              0531
         BE    @RF00531                                            0531
*           IF HDRWTPTI=P           /* IS IND EQUAL TO A 'P' @Y30OE95*/
*             THEN                  /*                       @Y30OE95*/
         CLI   HDRWTPTI(HDR1PTR),C'P'                              0532
         BNE   @RF00532                                            0532
*             NOSRTCDS=ON;          /* IND NOT SCRTCH D.S.   @Y30OE95*/
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0533
*           ELSE                    /*                       @Y30OE95*/
*             DO;                   /*                       @Y30OE95*/
         B     @RC00532                                            0534
@RF00532 DS    0H                                                  0535
*               GOODHDR1=OFF;       /* IND BAD HDR1          @Y30OE95*/
*               NOSRTCDS=ON;        /* IND NO SCRATCH DS     @Y30OE95*/
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0536
         NI    GOODHDR1(AWORKPTR),B'11011111'                      0536
*             END;                  /*                       @Y30OE95*/
*       END;                        /*                       @Y30OE6D*/
@RC00532 DS    0H                                                  0538
@RF00531 DS    0H                                                  0539
*   END;                            /*                       @Y30OE95*/
@RF00490 LA    @11,1                                               0539
         AL    @11,I(,AWORKPTR)                                    0539
         ST    @11,I(,AWORKPTR)                                    0539
         C     @11,@CF01653                                        0539
         BNH   @DL00488                                            0539
@DC00488 DS    0H                                                  0540
*                                                                  0540
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DISKETTE IS NON-SCRATCH, ISSUE MESSAGE AND         @Y30OE95*/
*   /* RETURN TO CHECK ANOTHER DISKETTE.                     @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0540
*   IF NOSRTCDS=OFF                 /* WERE ANY NON-SCRATCH  @Y30OE95
*                                      DATA SETS FOUND       @Y30OE95*/
*     THEN                          /* NO                    @Y30OE95*/
         TM    NOSRTCDS(AWORKPTR),B'00000100'                      0540
         BNZ   @RF00540                                            0540
*     SCRCHDSK=ON;                  /* IND SCRATCH DISKETTE  @Y30OE95*/
         OI    SCRCHDSK(AWORKPTR),B'00001000'                      0541
*   ELSE                            /*                       @Y30OE95*/
*     DO;                           /*                       @Y30OE6D*/
         B     @RC00540                                            0542
@RF00540 DS    0H                                                  0543
*       IF GOODHDR1=OFF             /* WAS BAD HDR1 FOUND    @Y30OE95*/
*         THEN                      /* YES                   @Y30OE95*/
         TM    GOODHDR1(AWORKPTR),B'00100000'                      0543
         BNZ   @RF00543                                            0543
*         DO;                       /*                       @Y30OE6D*/
*           MSGINDEX=HDR1MSG;       /* INDEX FOR HDR1 MSG 15 @Y30OE6D*/
         MVI   MSGINDEX(AWORKPTR),X'0F'                            0545
*           DSIDTXT=HDRDSID;        /* GET BAD HDR1 DSID     @Y30OE6D*/
         MVC   DSIDTXT(8),HDRDSID(HDR1PTR)                         0546
*         END;                      /*                       @Y30OE6D*/
*       ELSE                        /*                       @Y30OE95*/
*         MSGINDEX=NONSMSG;         /* SET INDEX FOR MSG 19  @Y30OE6D*/
         B     @RC00543                                            0548
@RF00543 MVI   MSGINDEX(AWORKPTR),X'13'                            0548
*       CALL MSGSUBRT;              /* CALL THE MSG SUBROUT. @Y30OE6D*/
@RC00543 BAL   @14,MSGSUBRT                                        0549
*       DSIDTXT=SDKTDSID;           /* RESTORE OPENING DSID  @Y30OE6D*/
         MVC   DSIDTXT(8),SDKTDSID(SETDSKPT)                       0550
*     END;                          /*                       @Y30OE95*/
*   END CKSCRDSK;                   /* END OF PROCEDURE      @Y30OE95*/
@EL00009 DS    0H                                                  0552
@EF00009 DS    0H                                                  0552
@ER00009 L     @14,@SA00009                                        0552
         BR    @14                                                 0552
*                                                                  0553
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS SECTION WILL BLANK OUT ALL THE HDR1 LABELS OF A    @Y30OE95*/
*/*  SCRATCH DISKETTE TO LOOK AS FOLLOWS:                    @Y30OE95*/
*/*    DDR1 NODATA (BLANKS TO COL 80).                       @Y30OE95*/
*/*  SET THE CCW CHAIN TO WRITE 20 RECORDS ON TRACK 0,       @Y30OE6D*/
*/*  RECORDS 7 TO 26.                                        @Y30OE6D*/
*/*                                                          @Y30OE95*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0553
*BLANKHDR:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
BLANKHDR ST    @14,@SA00010                                        0553
*   IOBSKSS=SEVEN;                  /* PT IOB TO TRK 0 REC 7 @Y30OE6D*/
         MVI   IOBSKSS(IOBSTPTR),X'07'                             0554
*   CHANPGM(1,1:8)=CCWD3;           /* PUT DFN CCW IN CHAIN  @Y30OE6D*/
         MVC   CHANPGM(8,CHNPGMPT),CCWD3                           0555
*   CCW21SAV=CHANPGM(23);           /* SAVE CCW21            @Y30OE6D*/
         MVC   CCW21SAV(8,AWORKPTR),CHANPGM+176(CHNPGMPT)          0556
*   CHANPGM(23,1:8)=CCWD2;          /* PUT DFN CCW IN CHAIN  @Y30OE6D*/
         MVC   CHANPGM+176(8,CHNPGMPT),CCWD2                       0557
*   DO I=3 TO 22;                   /* SET LOOP FOR 20 RECDS @Y30OE6D*/
         LA    @11,3                                               0558
         ST    @11,I(,AWORKPTR)                                    0558
@DL00558 DS    0H                                                  0559
*     CHANPGM(I,7:8)=COUNT80;       /* CHANGE COUNT TO 80    @Y30OE6D*/
         L     @11,I(,AWORKPTR)                                    0559
         SLA   @11,3                                               0559
         LH    @08,COUNT80                                         0559
         ALR   @11,CHNPGMPT                                        0559
         BCTR  @11,0                                               0559
         BCTR  @11,0                                               0559
         STCM  @08,3,CHANPGM(@11)                                  0559
*   END;                            /*                       @Y30OE95*/
*                                                                  0560
         LA    @11,1                                               0560
         AL    @11,I(,AWORKPTR)                                    0560
         ST    @11,I(,AWORKPTR)                                    0560
         C     @11,@CF01653                                        0560
         BNH   @DL00558                                            0560
*   /*****************************************************************/
*   /*                                                               */
*   /* POINT ALL CCW'S TO SAME BUFFER (I.E., BUFFER          @Y30OE95*/
*   /* POINTED TO BY RWCCW1.                                 @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0561
*   DO I=5 TO 22;                   /* SET LOOP FOR 18 HDR'S @Y30OE6D*/
         LA    @11,5                                               0561
         ST    @11,I(,AWORKPTR)                                    0561
@DL00561 DS    0H                                                  0562
*     SAVEADDR(I)=CHANPGM(I,1:4);   /* SAVE DATA ADDR OF     @Y30OE95
*                                      RWCCW3-20             @Y30OE6D*/
         L     @11,I(,AWORKPTR)                                    0562
         LR    @08,@11                                             0562
         SLA   @08,2                                               0562
         ALR   @08,AWORKPTR                                        0562
         SLA   @11,3                                               0562
         ST    @11,@TF00001                                        0562
         ALR   @11,CHNPGMPT                                        0562
         AL    @11,@CF02104                                        0562
         MVC   SAVEADDR-4(4,@08),CHANPGM(@11)                      0562
*     CHANPGM(I,1:4)=CHANPGM(4,1:4);/* POINT RWCCW'S         @Y30OE6D
*                                      TO SAME DATAAD        @Y30OE95*/
         LR    @11,CHNPGMPT                                        0563
         AL    @11,@TF00001                                        0563
         AL    @11,@CF02104                                        0563
         MVC   @TS00001(4),CHANPGM+24(CHNPGMPT)                    0563
         MVC   CHANPGM(4,@11),@TS00001                             0563
*     CHANPGM(I,1)=WRTCNTL;         /* CHANGE CMD CODE TO    @ZA28058*/
*                                                                  0564
         LR    @11,CHNPGMPT                                        0564
         AL    @11,@TF00001                                        0564
         AL    @11,@CF02104                                        0564
         MVI   CHANPGM(@11),X'21'                                  0564
*     /***************************************************************/
*     /*                                                             */
*     /* WRITE W/CONTROL                                     @ZA28058*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0565
*   END;                            /*                       @Y30OE95*/
*                                                                  0565
         LA    @11,1                                               0565
         AL    @11,I(,AWORKPTR)                                    0565
         ST    @11,I(,AWORKPTR)                                    0565
         C     @11,@CF01653                                        0565
         BNH   @DL00561                                            0565
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD BLANK HDR1 IN BUFFER POINED TO BY RWCCW1        @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0566
*   HDR1PTR=CHANPGM(4,2:4);         /* GET PTR TO 1ST HDR1   @Y30OE6D*/
         SLR   HDR1PTR,HDR1PTR                                     0566
         ICM   HDR1PTR,7,CHANPGM+25(CHNPGMPT)                      0566
*   HDR13540='';                    /* BLANK HDR1 LABEL      @Y30OE6D*/
         MVI   HDR13540(HDR1PTR),C' '                              0567
         MVC   HDR13540+1(79,HDR1PTR),HDR13540(HDR1PTR)            0567
*   HDRID=DDR1;                     /* INDICATE DELETED D.S. @Y30OE95*/
         MVC   HDRID(4,HDR1PTR),DDR1                               0568
*   HDRDSID(1:6)=NODATA;            /* DSID = 'NODATA'       @Y30OE95*/
         MVC   HDRDSID(6,HDR1PTR),NODATA                           0569
*                                                                  0570
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE BLANK HDR1'S AND RESTORE CCW CHAIN              @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0570
*   CALL IOSBRTN;                   /* GO DO I/O             @Y30OE95*/
         BAL   @14,IOSBRTN                                         0570
*   DO I=5 TO 22;                   /* SET LOOP FOR 18 HDR'S @Y30OE6D*/
         LA    @11,5                                               0571
         ST    @11,I(,AWORKPTR)                                    0571
@DL00571 DS    0H                                                  0572
*     CHANPGM(I,1:4)=SAVEADDR(I);   /* RESTORE DATAADR       @Y30OE95*/
         L     @11,I(,AWORKPTR)                                    0572
         LR    @08,@11                                             0572
         SLA   @08,3                                               0572
         ST    @08,@TF00001                                        0572
         ALR   @08,CHNPGMPT                                        0572
         AL    @08,@CF02104                                        0572
         SLA   @11,2                                               0572
         ALR   @11,AWORKPTR                                        0572
         MVC   CHANPGM(4,@08),SAVEADDR-4(@11)                      0572
*     CHANPGM(I,1)=WRITEOP;         /* RESTORE WRT CMD CODE  @ZA28058*/
         LR    @11,CHNPGMPT                                        0573
         AL    @11,@TF00001                                        0573
         AL    @11,@CF02104                                        0573
         MVI   CHANPGM(@11),X'05'                                  0573
*   END;                            /*                       @Y30OE95*/
         LA    @11,1                                               0574
         AL    @11,I(,AWORKPTR)                                    0574
         ST    @11,I(,AWORKPTR)                                    0574
         C     @11,@CF01653                                        0574
         BNH   @DL00571                                            0574
*   CHANPGM(23)=CCW21SAV;           /* RESTORE RWCCW21       @Y30OE6D*/
         MVC   CHANPGM+176(8,CHNPGMPT),CCW21SAV(AWORKPTR)          0575
*   CHANPGM(1,1)=NOOP;              /* RESTORE NOOPECCW      @Y30OE6D*/
         MVI   CHANPGM(CHNPGMPT),X'03'                             0576
*   IF ERTNCDE^=GOODRTN             /* DID I/O ERROR OCCUR   @Y30OE6D*/
*     THEN                          /*                       @Y30OE6D*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0577
         BE    @RF00577                                            0577
*     SETRETCD=IOERROR;             /* YES, SET I/O RTN CODE @Y30OE6D*/
         MVI   SETRETCD+1(SETDSKPT),X'00'                          0578
         MVI   SETRETCD(SETDSKPT),X'10'                            0578
*   END BLANKHDR;                   /* END OF SUBROUTINE     @Y30OE6D*/
@EL00010 DS    0H                                                  0579
@EF00010 DS    0H                                                  0579
@ER00010 L     @14,@SA00010                                        0579
         BR    @14                                                 0579
*                                                                  0580
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS SECTION CALCULATES THE BEGIN OF EXTENT (BOE), END  @Y30OE95*/
*/*  OF EXTENT (EOE) AND END OF DATA (EOD) OF THE DATA SET.  @Y30OE95*/
*/*                                                          @Y30OE95*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0580
*CALCEXTS:                          /*                       @Y30OE95*/
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OE6D*/
*                                                                  0580
CALCEXTS DS    0H                                                  0581
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE BOE                                         @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0581
*   RESPECIFY                                                      0581
*     REG14 RSTD;                   /* RESTRICT R14          @Y30OE6D*/
*   CVD(AMWBOETT,TEMP1);            /* GET PACKED TRK NUM    @Y30OE6D*/
         SLR   @15,@15                                             0582
         IC    @15,AMWBOETT(,AWORKPTR)                             0582
         CVD   @15,@TS00001                                        0582
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0582
*   UNPK(HDRBOECC,TEMP1);           /* CHANGE SAME TO EBCDIC @Y30OE95*/
         UNPK  HDRBOECC(2,HDR1PTR),TEMP1(2,AWORKPTR)               0583
*   HDRBOECC(2)=HDRBOECC(2)CHAR0;  /* CHANGE SIGN           @Y30OE6D*/
         OI    HDRBOECC+1(HDR1PTR),C'0'                            0584
*   CVD(AMWBOESS,TEMP1);            /* GET PACKED REC NUM    @Y30OE6D*/
         SLR   @15,@15                                             0585
         IC    @15,AMWBOESS(,AWORKPTR)                             0585
         CVD   @15,@TS00001                                        0585
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0585
*   UNPK(HDRBOERR,TEMP1);           /* CHANGE SAME TO EBCDIC @Y30OE95*/
         UNPK  HDRBOERR(2,HDR1PTR),TEMP1(2,AWORKPTR)               0586
*   HDRBOERR(2)=HDRBOERR(2)CHAR0;  /* CHANGE SIGN           @Y30OE6D*/
         OI    HDRBOERR+1(HDR1PTR),C'0'                            0587
*   HDRBOEH=CHAR0;                  /* PUT ZERO FOR HEADER   @Y30OE6D*/
*                                                                  0588
         MVI   HDRBOEH(HDR1PTR),C'0'                               0588
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE EOE                                         @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0589
*   I=((CCWPTR-CHNPGMPT)/EIGHT)-TWO;/*                       @Y30OE95*/
         L     @00,CCWPTR-1(,AWORKPTR)                             0589
         ICM   @00,8,@CB01893                                      0589
         SLR   @00,CHNPGMPT                                        0589
         SRDA  @00,32                                              0589
         D     @00,@CF01815                                        0589
         BCTR  @01,0                                               0589
         BCTR  @01,0                                               0589
         ST    @01,I(,AWORKPTR)                                    0589
*   IOBSKSS=IOBSKSS+I;              /* UPDATE IOB SEEKADR BY @Y30OE95
*                                      NUMBER OF REC WRITTEN @Y30OE95*/
         SLR   @15,@15                                             0590
         IC    @15,IOBSKSS(,IOBSTPTR)                              0590
         ALR   @01,@15                                             0590
         STC   @01,IOBSKSS(,IOBSTPTR)                              0590
*   CVD(IOBSKTT,TEMP1);             /* GET PACKED START TRK  @Y30OE95*/
         SLR   @15,@15                                             0591
         IC    @15,IOBSKTT(,IOBSTPTR)                              0591
         CVD   @15,@TS00001                                        0591
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0591
*   UNPK(HDREOECC,TEMP1);           /* GET HDR EOE TRACK     @Y30OE95*/
         UNPK  HDREOECC(2,HDR1PTR),TEMP1(2,AWORKPTR)               0592
*   HDREOECC(2)=HDREOECC(2)CHAR0;  /* CHANGE SIGN           @Y30OE6D*/
         OI    HDREOECC+1(HDR1PTR),C'0'                            0593
*   HDREOERR=CHAR26;                /* CHANGE REC NUM TO 26  @Y30OE6D*/
         MVC   HDREOERR(2,HDR1PTR),CHAR26                          0594
*   HDREOEH=CHAR0;                  /* HDR EOE HEADER = 0    @Y30OE6D*/
         MVI   HDREOEH(HDR1PTR),C'0'                               0595
*                                                                  0596
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE EOD. IF LAST BUFFER WRITTEN WAS FULL,       @Y30OE95*/
*   /* EOD WILL EQUAL RECORD 1 OF THE NEXT TRACK.            @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0596
*   IF IOBSKSS>TWNTYSIX             /* IS REC NUM > 26       @Y30OE95*/
*     THEN                          /* YES                   @Y30OE95*/
         CLI   IOBSKSS(IOBSTPTR),26                                0596
         BNH   @RF00596                                            0596
*     DO;                           /* CONTINUE              @Y30OE95*/
*       IOBSKTT=IOBSKTT+ONE;        /* UPDTE TRK NUM BY 1    @Y30OE95*/
         AL    @15,@CF01817                                        0598
         STC   @15,IOBSKTT(,IOBSTPTR)                              0598
*       CVD(IOBSKTT,TEMP1);         /* GET PACKED TRK NUM    @Y30OE95*/
         CVD   @15,@TS00001                                        0599
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0599
*       UNPK(HDREODCC,TEMP1);       /* EBCDIC TRK NO TO HDR  @Y30OE95*/
         UNPK  HDREODCC(2,HDR1PTR),TEMP1(2,AWORKPTR)               0600
*       HDREODCC(2)=HDREODCC(2)CHAR0;/* CHANGE SIGN         @Y30OE6D*/
         OI    HDREODCC+1(HDR1PTR),C'0'                            0601
*       HDREODH=CHAR0;              /* HDR EOD HEADER = ZERO @Y30OE6D*/
         MVI   HDREODH(HDR1PTR),C'0'                               0602
*       HDREODRR=CHAR01;            /* HDR EOD REC NUM = 1   @Y30OE6D*/
         MVC   HDREODRR(2,HDR1PTR),CHAR01                          0603
*     END;                          /*                       @Y30OE95*/
*   ELSE                            /*                       @Y30OE95*/
*     DO;                           /* CONTINUE              @Y30OE95*/
         B     @RC00596                                            0605
@RF00596 DS    0H                                                  0606
*       CVD(IOBSKSS,TEMP1);         /* GET PACKED REC NUM    @Y30OE95*/
         SLR   @15,@15                                             0606
         IC    @15,IOBSKSS(,IOBSTPTR)                              0606
         CVD   @15,@TS00001                                        0606
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0606
*       UNPK(HDREODRR,TEMP1);       /* CHANGE SAME TO EBCDIC @Y30OE95*/
         UNPK  HDREODRR(2,HDR1PTR),TEMP1(2,AWORKPTR)               0607
*       HDREODRR(2)=HDREODRR(2)CHAR0;/* CHANGE SIGN         @Y30OE6D*/
         OI    HDREODRR+1(HDR1PTR),C'0'                            0608
*       HDREODCC=HDREOECC;          /* HDR EOD TRK = EOE TRK @Y30OE95*/
         MVC   HDREODCC(2,HDR1PTR),HDREOECC(HDR1PTR)               0609
*       HDREODH=CHAR0;              /* HDR EOD HEADER = ZERO @Y30OE6D*/
         MVI   HDREODH(HDR1PTR),C'0'                               0610
*       RESPECIFY                                                  0611
*         REG14 UNRSTD;             /* RELEASE R14           @Y30OE6D*/
*     END;                          /*                       @Y30OE95*/
*   END CALCEXTS;                   /* END OF SUBROUTINE     @Y30OE95*/
@EL00011 DS    0H                                                  0613
@EF00011 DS    0H                                                  0613
@ER00011 BR    @14                                                 0613
*                                                                  0614
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*/*  THIS SUBROUTINE IS ENTERED WHENEVER THE USER SPECIFIES  @Y30OE6D*/
*/*  THE SECURITY PARAMETER ON THE START COMMAND FOR THE     @Y30OE6D*/
*/*  ERIC WRITER.  A MESSAGE IS ISSUED TO THE OPERATOR TO    @Y30OE6D*/
*/*  SPECIFY THE SECURITY INFORMATION FOR THE VOLUME AND     @Y30OE6D*/
*/*  DATA SET.  THE FORMAT OF THE REPLY IS 'YYMMDD,W,D,V'.   @Y30OE6D*/
*/*  WHERE YYMMDD IS THE EXPIRATION DATE OF THE DATA SET     @Y30OE6D*/
*/*  ENTERED IN THE FORM YEAR, MONTH AND DAY.  IF NOT        @Y30OE6D*/
*/*  SPECIFIED A DEFAULT 7 DAY EXPIRATION DATE WILL BE       @Y30OE6D*/
*/*  ASSIGNED.                                               @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*  W IS A ONE CHARACTER WRITE PROTECT INDICATOR FOR THE    @Y30OE6D*/
*/*  DATA SET AND CAN BE SPECIFIED WITH A 'P' FOR WRITE      @Y30OE6D*/
*/*  PROTECT OR A BLANK (' ') FOR NO WRITE PROTECT.  DEFAULT @Y30OE6D*/
*/*  IS NO WRITE PROTECT.                                    @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*  D IS A ONE CHARACTER SECURITY INDICATOR FOR THE DATA    @Y30OE6D*/
*/*  SET AND CAN BE SPECIFIED BY ANY CHARACTER EXCEPT A      @Y30OE6D*/
*/*  BLANK (' ').  DEFAULT IS NO DATA SECURITY.              @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*  V IS A ONE CHARACTER VOLUME ACCESSABILITY INDICATOR     @Y30OE6D*/
*/*  FOR THE VOLUME AND CAN BE SPECIFIED BY ANY CHARACTER    @Y30OE6D*/
*/*  EXCEPT A BLANK (' ').  DEFAULT IS NO VOLUME SECURITY.   @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*                                                                  0614
*SECRPROC:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
SECRPROC ST    @14,@SA00012                                        0614
*   BADREPLY=ON;                    /* INITIALIZE FLAG       @Y30OE6D*/
         OI    BADREPLY(AWORKPTR),B'00100000'                      0615
*   MSGINDEX=SSECMSG;               /* SET INDEX FOR MSG 24  @Y30OE6D*/
*                                                                  0616
         MVI   MSGINDEX(AWORKPTR),X'18'                            0616
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ANY SYNTAX OR LOGIC ERROR IS FOUND IN THE REPLY,   @Y30OE95*/
*   /* THE MESSAGE IS RE-ISSUED.                             @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0617
*   DO WHILE BADREPLY=ON;           /* ISSUE MSG UNTIL REPLY @Y30OE6D
*                                      IS CORRECT            @Y30OE95*/
         B     @DE00617                                            0617
@DL00617 DS    0H                                                  0618
*     BADREPLY=OFF;                 /* INITIALIZE FLAG       @Y30OE95*/
         NI    BADREPLY(AWORKPTR),B'11011111'                      0618
*     AMWEXDTE(1)=ZERO;             /* ZERO 1ST POS OF YEAR  @Y30OE6D*/
         MVI   AMWEXDTE(AWORKPTR),X'00'                            0619
*     AMWWTPTI=ZERO;                /* RESET WRITE PROT IND  @Y30OE6D*/
         MVI   AMWWTPTI(AWORKPTR),X'00'                            0620
*     AMWDSSQL=ZERO;                /* RESET D S SECUR IND   @Y30OE6D*/
         MVI   AMWDSSQL(AWORKPTR),X'00'                            0621
*     MSGTYPCD=WTORCD;              /* MSG TYPE IS WTOR      @Y30OE6D*/
         MVI   MSGTYPCD(AWORKPTR),X'02'                            0622
*     CALL MSGSUBRT;                /* CALL THE MSG SUBROUT. @Y30OE6D*/
         BAL   @14,MSGSUBRT                                        0623
*     RESPECIFY                                                    0624
*       REPLYPTR RSTD;              /* RESTRICT REPLY PTR    @Y30OE95*/
*     RESPECIFY                                                    0625
*       VOL1PTR RSTD;               /* RESTRICT VOL1 PTR     @Y30OE95*/
*     VOL1PTR=CHANPGM(3,2:4);       /* GET PTR TO VOL1 LABEL @Y30OE95*/
         SLR   VOL1PTR,VOL1PTR                                     0626
         ICM   VOL1PTR,7,CHANPGM+17(CHNPGMPT)                      0626
*     REPLYPTR=MSGREPAD;            /* ADDR OF REPLY AREA    @Y30OE6D*/
         L     REPLYPTR,MSGREPAD(,AWORKPTR)                        0627
*     IF REPLYCHR>BLANK             /* TEST FOR NULL REPLY   @Y30OE6D*/
*       THEN                        /* REPLY NORMALLY        @Y30OE6D*/
         CLI   REPLYCHR(REPLYPTR),C' '                             0628
         BNH   @RF00628                                            0628
*       DO;                         /*                       @Y30OE6D*/
*         IF REPLYCHR^=COMMA        /* IS CHARACTER A COMMA  @Y30OE95*/
*           THEN                    /* NO                    @Y30OE95*/
         CLI   REPLYCHR(REPLYPTR),C','                             0630
         BE    @RF00630                                            0630
*           DO;                     /* CONTINUE              @Y30OE95*/
*                                                                  0631
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK FOR THE PRESENCE OF AN EXPIRATION     @Y30OE6D*/
*             /* DATE AND PROCESS SAME IF ENTERED.           @Y30OE6D*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0632
*             REPLYPTR=REPLYPTR+SIX;/* POINT PAST EXP DATE   @Y30OE95*/
         AL    REPLYPTR,@CF01810                                   0632
*             DO I=1 TO 6           /* SET LOOP FOR 6 CHAR   @Y30OE6D*/
*                   WHILE BADREPLY=OFF;/* VALIDATION         @Y30OE6D*/
         LA    @15,1                                               0633
         ST    @15,I(,AWORKPTR)                                    0633
@DL00633 TM    BADREPLY(AWORKPTR),B'00100000'                      0633
         BNZ   @DC00633                                            0633
*               IF REPLYARA(I)<CHAR0/* CHARACTER RANGE MUST @Y30OE6D*/
*                   REPLYARA(I)>CHAR9/* BE BETWEEN 0 AND 9   @Y30OE6D*/
*                 THEN              /*                       @Y30OE6D*/
         L     @15,I(,AWORKPTR)                                    0634
         L     @14,MSGREPAD(,AWORKPTR)                             0634
         ALR   @15,@14                                             0634
         BCTR  @15,0                                               0634
         CLI   REPLYARA(@15),C'0'                                  0634
         BL    @RT00634                                            0634
         L     @15,I(,AWORKPTR)                                    0634
         ALR   @14,@15                                             0634
         BCTR  @14,0                                               0634
         CLI   REPLYARA(@14),C'9'                                  0634
         BNH   @RF00634                                            0634
@RT00634 DS    0H                                                  0635
*                 BADREPLY=ON;      /* IND BAD REPLY         @Y30OE6D*/
         OI    BADREPLY(AWORKPTR),B'00100000'                      0635
*             END;                  /*                       @Y30OE6D*/
@RF00634 LA    @15,1                                               0636
         AL    @15,I(,AWORKPTR)                                    0636
         ST    @15,I(,AWORKPTR)                                    0636
         C     @15,@CF00412                                        0636
         BNH   @DL00633                                            0636
@DC00633 DS    0H                                                  0637
*             IF BADREPLY=OFF       /* CHARACTER RANGE OK    @Y30OE6D*/
*               THEN                /* YES                   @Y30OE6D*/
         TM    BADREPLY(AWORKPTR),B'00100000'                      0637
         BNZ   @RF00637                                            0637
*               IF(REPLYMAP(3:4)>CHAR00&/* IS MONTH          @Y30OE6D*/
*                   REPLYMAP(3:4)<=CHAR12)&/* AND DAY        @Y30OE6D*/
*                   (REPLYMAP(5:6)>CHAR00&/* LIMIT           @Y30OE6D*/
*                   REPLYMAP(5:6)<=CHAR31)/* RANGE OK        @Y30OE6D*/
*                 THEN              /* YES                   @Y30OE95*/
         L     @15,MSGREPAD(,AWORKPTR)                             0638
         CLC   REPLYMAP+2(2,@15),CHAR00                            0638
         BNH   @RF00638                                            0638
         CLC   REPLYMAP+2(2,@15),CHAR12                            0638
         BH    @RF00638                                            0638
         CLC   REPLYMAP+4(2,@15),CHAR00                            0638
         BNH   @RF00638                                            0638
         CLC   REPLYMAP+4(2,@15),CHAR31                            0638
         BH    @RF00638                                            0638
*                 AMWEXDTE=REPLYMAP(1:6);/* SAVE EXPIR DATE  @Y30OE6D*/
         MVC   AMWEXDTE(6,AWORKPTR),REPLYMAP(@15)                  0639
*               ELSE                /*                       @Y30OE95*/
*                 BADREPLY=ON;      /* INDICATE BAD REPLY    @Y30OE95*/
         B     @RC00638                                            0640
@RF00638 OI    BADREPLY(AWORKPTR),B'00100000'                      0640
*           END;                    /*                       @Y30OE95*/
@RC00638 DS    0H                                                  0641
@RF00637 DS    0H                                                  0642
*         IF REPLYCHR=COMMA         /* IS CHAR A COMMA       @Y30OE95*/
*           THEN                    /* YES                   @Y30OE95*/
@RF00630 CLI   REPLYCHR(REPLYPTR),C','                             0642
         BNE   @RF00642                                            0642
*           DO;                     /* CONTINUE              @Y30OE95*/
*                                                                  0644
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK FOR AND PROCESS WRITE PROTECT.        @Y30OE6D*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0644
*             REPLYPTR=REPLYPTR+ONE;/* POINT TO NEXT CHAR    @Y30OE95*/
         LA    @15,1                                               0644
         ALR   REPLYPTR,@15                                        0644
*             IF REPLYCHR^=COMMA    /* IS CHAR A COMMA       @Y30OE95*/
*               THEN                /* NO                    @Y30OE95*/
         CLI   REPLYCHR(REPLYPTR),C','                             0645
         BE    @RF00645                                            0645
*               IF REPLYCHR=P       /* IS WRITE PROTECT SPEC @Y30OE95*/
*                 THEN              /* YES                   @Y30OE95*/
         CLI   REPLYCHR(REPLYPTR),C'P'                             0646
         BNE   @RF00646                                            0646
*                 DO;               /* CONTINUE              @Y30OE95*/
*                   AMWWTPTI=P;     /* PUT INTO HOLDAREA     @Y30OE6D*/
         MVI   AMWWTPTI(AWORKPTR),C'P'                             0648
*                   REPLYPTR=REPLYPTR+ONE;/* POINT NEXT CHAR @Y30OE95*/
         ALR   REPLYPTR,@15                                        0649
*                 END;              /*                       @Y30OE95*/
*               ELSE                /*                       @Y30OE95*/
*                 IF REPLYCHR^=BLANK/* WAS BLANK SPECIFIED   @Y30OE95
*                                      FOR WRITE PROTECT     @Y30OE95*/
*                   THEN            /* NO                    @Y30OE95*/
         B     @RC00646                                            0651
@RF00646 CLI   REPLYCHR(REPLYPTR),C' '                             0651
         BE    @RF00651                                            0651
*                   BADREPLY=ON;    /* INDICATE BAD REPLY    @Y30OE95*/
         OI    BADREPLY(AWORKPTR),B'00100000'                      0652
*                 ELSE              /*                       @Y30OE95*/
*                   REPLYPTR=REPLYPTR+ONE;/* POINT NEXT CHAR @Y30OE95*/
         B     @RC00651                                            0653
@RF00651 AL    REPLYPTR,@CF01817                                   0653
*             IF REPLYCHR=COMMA     /* IS CHAR A COMMA       @Y30OE95*/
*               THEN                /* THEN                  @Y30OE95*/
@RC00651 DS    0H                                                  0654
@RC00646 DS    0H                                                  0654
@RF00645 CLI   REPLYCHR(REPLYPTR),C','                             0654
         BNE   @RF00654                                            0654
*               DO;                 /* CONTINUE              @Y30OE95*/
*                                                                  0655
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK FOR AND PROCESS DATA SET SECURITY.        */
*                 /*                                         @Y30OE6D*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0656
*                 REPLYPTR=REPLYPTR+ONE;/* POINT NEXT CHAR   @Y30OE95*/
         LA    @15,1                                               0656
         ALR   REPLYPTR,@15                                        0656
*                 IF REPLYCHR^=COMMA/* IS CHAR A COMMA       @Y30OE95*/
*                   THEN            /* NO                    @Y30OE95*/
         CLI   REPLYCHR(REPLYPTR),C','                             0657
         BE    @RF00657                                            0657
*                   IF REPLYCHR>BLANK/* IS IT END OF REPLY   @Y30OE6D*/
*                     THEN          /* OR A BLANK CHAR.      @Y30OE6D*/
         CLI   REPLYCHR(REPLYPTR),C' '                             0658
         BNH   @RF00658                                            0658
*                     DO;           /* NO                    @Y30OE6D*/
*                       AMWDSSQL=REPLYCHR;/* SAVE D.S. SEC IND     0660
*                                                            @Y30OE95*/
         MVC   AMWDSSQL(1,AWORKPTR),REPLYCHR(REPLYPTR)             0660
*                       REPLYPTR=REPLYPTR+ONE;/* GET NEXT CHAR     0661
*                                                            @Y30OE95*/
         ALR   REPLYPTR,@15                                        0661
*                     END;          /*                       @Y30OE95*/
*                   ELSE            /*                       @Y30OE6D*/
*                     BADREPLY=ON;  /* INDICATE BAD REPLY    @Y30OE6D*/
         B     @RC00658                                            0663
@RF00658 OI    BADREPLY(AWORKPTR),B'00100000'                      0663
*                 IF REPLYCHR=COMMA /* IS CHAR A COMMA       @Y30OE95*/
*                   THEN            /* YES                   @Y30OE95*/
@RC00658 DS    0H                                                  0664
@RF00657 CLI   REPLYCHR(REPLYPTR),C','                             0664
         BNE   @RF00664                                            0664
*                   DO;             /* CONTINUE              @Y30OE95*/
*                                                                  0666
*                     /***********************************************/
*                     /*                                             */
*                     /* CHECK FOR AND PROCESS VOLUME SECURITY.      */
*                     /*                                     @Y30OE6D*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0666
*                     REPLYPTR=REPLYPTR+ONE;/* GET NEXT CHAR @Y30OE95*/
         AL    REPLYPTR,@CF01817                                   0666
*                     IF REPLYCHR<=BLANK/* IS CHAR A BLANK  @Y30OE95*/
*                         REPLYCHR=COMMA/* OR A COMMA OR A  @Y30OE95*/
*                         BADREPLY=ON/* BAD REPLY PENDING   @Y30OE6D*/
*                         SECURVOL=ON/* OR VOL ACCESS        @Y30OE6D
*                                      IND IS ON             @Y30OE6D*/
*                       THEN        /* YES                   @Y30OE95*/
         CLI   REPLYCHR(REPLYPTR),C' '                             0667
         BNH   @RT00667                                            0667
         CLI   REPLYCHR(REPLYPTR),C','                             0667
         BE    @RT00667                                            0667
         TM    BADREPLY(AWORKPTR),B'00101000'                      0667
         BZ    @RF00667                                            0667
@RT00667 DS    0H                                                  0668
*                       BADREPLY=ON;/* INDIC BAD REPLY       @Y30OE95*/
         OI    BADREPLY(AWORKPTR),B'00100000'                      0668
*                     ELSE          /*                       @Y30OE95*/
*                       DO;         /* CONTINUE              @Y30OE95*/
         B     @RC00667                                            0669
@RF00667 DS    0H                                                  0670
*                         AMWVOLAC=REPLYCHR;/* SAVE VOL SER  @Y30OE6D*/
         MVC   AMWVOLAC(1,AWORKPTR),REPLYCHR(REPLYPTR)             0670
*                         REPLYPTR=REPLYPTR+ONE;/* INDEX TO  @Y30OE95*/
         AL    REPLYPTR,@CF01817                                   0671
*                       END;        /* THE NEXT CHARACTER    @Y30OE95*/
*                   END;            /*                       @Y30OE95*/
@RC00667 DS    0H                                                  0674
*                 IF AMWDSSQL^=ZERO /* WAS D.S. SEC SPEC     @Y30OE6D*/
*                   THEN            /* YES                   @Y30OE95*/
@RF00664 CLI   AMWDSSQL(AWORKPTR),X'00'                            0674
         BE    @RF00674                                            0674
*                   IF AMWVOLAC=ZERO/* WAS VOL SECUR SPEC    @Y30OE6D*/
*                     THEN          /* NO                    @Y30OE95*/
         CLI   AMWVOLAC(AWORKPTR),X'00'                            0675
         BNE   @RF00675                                            0675
*                     BADREPLY=ON;  /* INDICATE BAD REPLY    @Y30OE95*/
         OI    BADREPLY(AWORKPTR),B'00100000'                      0676
*               END;                /*                       @Y30OE95*/
@RF00675 DS    0H                                                  0677
@RF00674 DS    0H                                                  0678
*           END;                    /*                       @Y30OE95*/
@RF00654 DS    0H                                                  0679
*         IF REPLYCHR^=ZERO         /* IS CHAR A HEX ZERO    @Y30OE95*/
*           THEN                    /* NO                    @Y30OE95*/
@RF00642 CLI   REPLYCHR(REPLYPTR),X'00'                            0679
         BE    @RF00679                                            0679
*           BADREPLY=ON;            /* INDICATE BAD REPLY    @Y30OE95*/
         OI    BADREPLY(AWORKPTR),B'00100000'                      0680
*         RESPECIFY                                                0681
*           REPLYPTR UNRSTD;        /* UNRESTRICT REPLY PTR  @Y30OE95*/
@RF00679 DS    0H                                                  0682
*         RESPECIFY                                                0682
*           VOL1PTR UNRSTD;         /* UNRESTRICT VOL1 PTR   @Y30OE95*/
*       END;                        /*                       @Y30OE95*/
*     ELSE                          /*                       @Y30OE6D*/
*       IF REPLYMAP(2)^=ZERO        /* IF SECOND CHAR IS NOT @Y30OE6D*/
*         THEN                      /* A ZERO FOR A NULL     @Y30OE6D*/
         B     @RC00628                                            0684
@RF00628 L     @11,MSGREPAD(,AWORKPTR)                             0684
         CLI   REPLYMAP+1(@11),X'00'                               0684
         BE    @RF00684                                            0684
*         BADREPLY=ON;              /* RESPONSE, THEN ERROR  @Y30OE6D*/
         OI    BADREPLY(AWORKPTR),B'00100000'                      0685
*     IF BADREPLY=ON                /* BAD REPLY ON ?        @ZA00797*/
*       THEN                        /* YES                   @ZA00797*/
@RF00684 DS    0H                                                  0686
@RC00628 TM    BADREPLY(AWORKPTR),B'00100000'                      0686
         BNO   @RF00686                                            0686
*       DO;                         /*                       @ZA00797*/
*         AMWDSSQL=ZERO;            /* CLEAR D.S. IND        @ZA00797*/
         MVI   AMWDSSQL(AWORKPTR),X'00'                            0688
*         IF SECURVOL=OFF           /* SECURE VOLUMN OFF     @ZA00797*/
*           THEN                    /* YES                   @ZA00797*/
         TM    SECURVOL(AWORKPTR),B'00001000'                      0689
         BNZ   @RF00689                                            0689
*           AMWVOLAC=ZERO;          /* CLEAR VOL SEC IND     @ZA00797*/
         MVI   AMWVOLAC(AWORKPTR),X'00'                            0690
*       END;                        /*                       @ZA00797*/
@RF00689 DS    0H                                                  0692
*   END;                            /*                       @Y30OE6D*/
@RF00686 DS    0H                                                  0692
@DE00617 TM    BADREPLY(AWORKPTR),B'00100000'                      0692
         BO    @DL00617                                            0692
*   SECURVOL=ON;                    /* SET SECURE VOL IND ON @Y30OE6D*/
         OI    SECURVOL(AWORKPTR),B'00001000'                      0693
*   END SECRPROC;                   /* END OF SUBROUTINE     @Y30OE95*/
@EL00012 DS    0H                                                  0694
@EF00012 DS    0H                                                  0694
@ER00012 L     @14,@SA00012                                        0694
         BR    @14                                                 0694
*                                                                  0695
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*  THIS SUBROUTINE UPDATES THE UCB USING THE VOL SER       @Y30OE6D*/
*/*  WHICH WAS SETUP IN SAVEVOL.                             @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*                                                                  0695
*UCBUPDAT:                          /*                       @Y30OE6D*/
*   PROC OPTIONS(SAVE(11,14));      /*                       @Y30OE6D*/
UCBUPDAT ST    @14,@SA00013                                        0695
         ST    @11,@SA00013+4                                      0695
*   RFY                             /*                       @Y30OE6D*/
*    (LOCKREG,                      /*                       @Y30OE6D*/
*     UCBPTR) RSTD;                 /* RESTRICT REGISTERS    @Y30OE6D*/
*   UCBPTR=SAVEUCB;                 /* GET POINTER TO THE UCB      0697
*                                                            @Y30OE6D*/
         L     UCBPTR,SAVEUCB(,AWORKPTR)                           0697
*   LOCKREG=ADDR(UCBLOCK);          /* GET DEVICE LOCKWORD   @Y30OE6D*/
         LR    LOCKREG,UCBPTR                                      0698
         AL    LOCKREG,@CF02104                                    0698
*   GENERATE;                                                      0699
*                                                         /*@Y30OE6D*/
        MODESET KEY=ZERO,MODE=SUP GET PGM IN KEY ZERO         @Y30OE6D
        SETLOCK OBTAIN,TYPE=IOSUCB,ADDR=(11),MODE=UNCOND,             XX
               REGS=USE,RELATED=(UCB,(IOESDKTO,UCBUPDAT))     @Y30OE6D
*   UCBVLSER=SAVEVOL;               /* UPDATE VOL SER IN UCB @Y30OE6D*/
         L     @01,UCBXTADR(,UCBPTR)                               0700
         MVC   UCBVLSER(6,@01),SAVEVOL(AWORKPTR)                   0700
*   LOCKREG=ADDR(UCBLOCK);          /* GET DEVICE LOCKWORD   @Y30OE6D*/
         LR    LOCKREG,UCBPTR                                      0701
         AL    LOCKREG,@CF02104                                    0701
*   GENERATE;                                                      0702
*                                                         /*@Y30OE6D*/
        SETLOCK RELEASE,TYPE=IOSUCB,ADDR=(11),                        XX
               REGS=USE,RELATED=(UCB,(IOESDKTO,UCBUPDAT))     @Y30OE6D
        MODESET KEY=NZERO,MODE=PROB RESTORE PROGRAM KEY       @Y30OE6D
*   RFY                             /*                       @Y30OE6D*/
*    (LOCKREG,                      /*                       @Y30OE6D*/
*     UCBPTR) UNRSTD;               /* RELEASE REGISTERS     @Y30OE6D*/
*   END UCBUPDAT;                   /* END OF UCBUPDAT ROUT. @Y30OE6D*/
@EL00013 DS    0H                                                  0704
@EF00013 DS    0H                                                  0704
@ER00013 L     @14,@SA00013                                        0704
         L     @11,@SA00013+4                                      0704
         BR    @14                                                 0704
*                                                                  0705
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/*  THIS SUBROUTINE SETS UP THE MESSAGE WRITER PARAMETER    @Y30OE6D*/
*/*  LIST AND CALLS THE MESSAGE WRITER TO ISSUE THE          @Y30OE6D*/
*/*  MESSAGES FOR THIS PROGRAM.                              @Y30OE6D*/
*/*                                                          @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/
*                                                                  0705
*MSGSUBRT:                          /*                       @Y30OE6D*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE6D*/
MSGSUBRT ST    @14,@SA00014                                        0705
*   RFY                             /*                       @Y30OE6D*/
*    (VOL1PTR,                      /*                       @Y30OE6D*/
*     UCBPTR,                       /*                       @Y30OE6D*/
*     REG1) RSTD;                   /* RESTRICT REGISTERS    @Y30OE6D*/
*   VOL1PTR=CHANPGM(3,2:4);         /* GET PTR TO VOL1 LABEL @Y30OE6D*/
         SLR   VOL1PTR,VOL1PTR                                     0707
         ICM   VOL1PTR,7,CHANPGM+17(CHNPGMPT)                      0707
*   UCBPTR=SAVEUCB;                 /* SET POINTER TO UCB    @Y30OE6D*/
         L     UCBPTR,SAVEUCB(,AWORKPTR)                           0708
*   DEVADTXT=UCBNAME;               /* GET DEVICE ADDRESS    @Y30OE6D*/
         MVC   DEVADTXT(3),UCBNAME(UCBPTR)                         0709
*   SERTXT=VOLID;                   /* GET VOLUME SERIAL     @Y30OE6D*/
         MVC   SERTXT(6),VOLID(VOL1PTR)                            0710
*   MSGTEXT=MSGOPT;                 /* GET MESSAGE OPTIONS   @Y30OE6D*/
         MVC   MSGTEXT(45,AWORKPTR),MSGOPT                         0711
*   REG1=ADDR(MSGAREA);             /* GET MSG LIST ADDRESS  @Y30OE6D*/
         LA    REG1,MSGAREA(,AWORKPTR)                             0712
*   CALL IOEDKMSG;                  /* CALL MESSAGE WRITER   @Y30OE6D*/
         L     @15,@CV01726                                        0713
         BALR  @14,@15                                             0713
*   MSGTYPCD=WTOCD;                 /* SET MSG TYPE TO WTO   @Y30OE6D*/
         MVI   MSGTYPCD(AWORKPTR),X'01'                            0714
*   RFY                             /*                       @Y30OE6D*/
*    (VOL1PTR,                      /*                       @Y30OE6D*/
*     UCBPTR,                       /*                       @Y30OE6D*/
*     REG1) UNRSTD;                 /* RELEASE REGISTERS     @Y30OE6D*/
*   END MSGSUBRT;                   /* END OF MSG SUB ROUT.  @Y30OE6D*/
@EL00014 DS    0H                                                  0716
@EF00014 DS    0H                                                  0716
@ER00014 L     @14,@SA00014                                        0716
         BR    @14                                                 0716
*                                                                  0717
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*/*                                                          @Y30OE6D*/
*/*   THIS SUBROUTINE ISSUES AN EXCP AND THEN WAITS          @Y30OE95*/
*/*   UNTIL THE I/O IS COMPLETED.                            @Y30OE95*/
*/*                                                          @Y30OE6D*/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/
*                                                                  0717
*IOSBRTN:                           /*                       @Y30OE95*/
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OE6D*/
IOSBRTN  DS    0H                                                  0718
*   RFY                             /*                       @Y30OE6D*/
*    (REG14,                        /*                       @Y30OE6D*/
*     REG15) RSTD;                  /* RESTRICT REGISTERS    @Y30OE6D*/
*   GEN(EXCP (IOBSTPTR));           /* EXECUTE CHANNEL PGM   @Y30OE6D*/
         EXCP (IOBSTPTR)
*   REG15=IOBECBPT;                 /* GET PTR TO ECB        @Y30OE6D*/
         L     REG15,IOBECBPT(,IOBSTPTR)                           0720
*   GEN(WAIT ECB=(REG15));          /* WAIT FOR I/O COMPLETE @Y30OE6D*/
         WAIT ECB=(REG15)
*   IF ECBCC^=GOODIO                /* ANY I/O ERRORS        @Y30OE6D*/
*     THEN                          /* YES                   @Y30OE6D*/
         L     @11,IOBECBPT(,IOBSTPTR)                             0722
         CLI   ECBCC(@11),X'7F'                                    0722
         BE    @RF00722                                            0722
*     ERTNCDE=IOERROR;              /* SET ERROR RETURN CODE @Y30OE6D*/
         MVI   ERTNCDE(SETDSKPT),X'10'                             0723
*   RFY                             /*                       @Y30OE6D*/
*    (REG14,                        /*                       @Y30OE6D*/
*     REG15) UNRSTD;                /* RELEASE REGISTERS     @Y30OE6D*/
*   END IOSBRTN;                    /* END OF I/O ROUTINE    @Y30OE95*/
@EL00015 DS    0H                                                  0725
@EF00015 DS    0H                                                  0725
@ER00015 BR    @14                                                 0725
*   END IOESDKTO                    /* END OF PROGRAM        @Y30OE6D*/
*                                                                  0726
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*                                                                  0726
*       ;                                                          0726
@DATA    DS    0H
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00004 DS    1F
@SA00003 DS    1F
@SA00005 DS    1F
@SA00002 DS    1F
@SA00006 DS    1F
@SA00013 DS    2F
@SA00008 DS    1F
@SA00009 DS    1F
@SA00010 DS    1F
@SA00012 DS    1F
@SA00014 DS    0F
         DS    1F
@TF00001 DS    F
IOESDKTO CSECT
         DS    0F
@CF00037 DC    F'1'
@CF00196 DC    F'2'
@CF00217 DC    F'3'
@CF00412 DC    F'6'
@CF01976 DC    F'19'
@CF01653 DC    F'22'
@CF01584 DC    F'28'
@CF02104 DC    F'-8'
@CF02109 DC    XL4'0000FFFF'
@CF01810 DC    XL4'06'
@CF01815 DC    XL4'08'
@CF01817 DC    XL4'01'
@CF01897 DC    XL4'04'
@DATD    DSECT
         DS    0D
DEBDAPTR DS    A
DEBEXPTR DS    A
DEBSBPTR DS    A
         DS    0D
@TS00001 DS    CL8
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IOESDKTO CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01726 DC    V(IOEDKMSG)
         DS    0D
ZEROS    DC    F'0'
MAXLRECL DC    H'128'
NUM365   DC    H'365'
NUM366   DC    H'366'
HZERO    DC    AL2(0)
COUNT80  DC    H'80'
@CB01893 DC    X'00'
MSGOPT   DS    CL45
         ORG   MSGOPT
MSGDSID  DS    CL10
         ORG   MSGDSID
DSIDLEN  DC    X'0A'
DSIDKEY  DC    X'06'
         ORG   DSIDKEY
DSIDLOP  DS    BL1
         ORG   MSGDSID+2
DSIDTXT  DS    CL8
         ORG   MSGOPT+10
MSGSER   DS    CL8
         ORG   MSGSER
SERLEN   DC    X'08'
SERKEY   DC    X'01'
SERTXT   DS    CL6
         ORG   MSGOPT+18
MSGVOLDS DS    CL10
         ORG   MSGVOLDS
VOLDSLEN DC    X'0A'
VOLDSKEY DC    X'0A'
VOLDSTXT DC    CL8'VOLUME  '
         ORG   MSGOPT+28
MSGDEVAD DS    CL5
         ORG   MSGDEVAD
DEVADLEN DC    X'05'
DEVADKEY DC    X'08'
DEVADTXT DS    CL3
         ORG   MSGOPT+33
MSGJNAME DS    CL10
         ORG   MSGJNAME
JNAMELEN DC    X'0A'
JNAMEKEY DC    X'0B'
         ORG   JNAMEKEY
JOBNMLOP DS    BL1
         ORG   MSGJNAME+2
JNAMETXT DS    CL8
         ORG   MSGOPT+43
MSGEND   DS    CL2
         ORG   MSGEND
ENDLEN   DC    X'02'
ENDKEY   DC    X'7F'
         ORG   MSGOPT+45
VOL1     DC    CL4'VOL1'
DDR1     DC    CL4'DDR1'
HDR1     DC    CL4'HDR1'
NODATA   DC    CL6'NODATA'
ENDDSKT  DC    CL6'/*DSKT'
CHAR00   DC    CL2'00'
CHAR01   DC    CL2'01'
CHAR12   DC    CL2'12'
CHAR26   DC    CL2'26'
CHAR31   DC    CL2'31'
TRK73    DC    CL2'73'
CCWD1    DS    CL8
         ORG   CCWD1
CCWOP1   DC    X'2F'
CCWADDR1 DC    AL3(DFNOP1)
CCWFLAG1 DC    X'60'
@NM00086 DC    X'00'
CCWCNT1  DC    X'0004'
         ORG   CCWD1+8
DFNOP1   DC    X'1AA00000'
CCWD2    DS    CL8
         ORG   CCWD2
CCWOP2   DC    X'2F'
CCWADDR2 DC    AL3(DFNOP2)
CCWFLAG2 DC    X'20'
@NM00087 DC    X'00'
CCWCNT2  DC    X'0004'
         ORG   CCWD2+8
DFNOP2   DC    X'1A400000'
CCWD3    DS    CL8
         ORG   CCWD3
CCWOP3   DC    X'2F'
CCWADDR3 DC    AL3(DFNOP3)
CCWFLAG3 DC    X'60'
@NM00088 DC    X'00'
CCWCNT3  DC    X'0004'
         ORG   CCWD3+8
DFNOP3   DC    X'14400000'
SECUREVL DC    X'040C'
VOL1ADDR DC    X'00000007'
TABLENLP DS    CL24
         ORG   TABLENLP
NLPYRTBL DC    H'0'
         DC    H'31'
         DC    H'59'
         DC    H'90'
         DC    H'120'
         DC    H'151'
         DC    H'181'
         DC    H'212'
         DC    H'243'
         DC    H'273'
         DC    H'304'
         DC    H'334'
         ORG   TABLENLP+24
TABLELYR DS    CL24
         ORG   TABLELYR
LPYRTBL  DC    H'0'
         DC    H'31'
         DC    H'60'
         DC    H'91'
         DC    H'121'
         DC    H'152'
         DC    H'182'
         DC    H'213'
         DC    H'244'
         DC    H'274'
         DC    H'305'
         DC    H'335'
         ORG   TABLELYR+24
MT3540AR DC    CL200' '
         DS    CL2
CP0001@  DC    AL4(OPENDS)
         DC    AL4(EOV)
         DC    AL4(CLOSEDS)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CHARPTR  EQU   @08
DEBPTR   EQU   @11
IOBPRPTR EQU   @08
IOBSTPTR EQU   @04
DCBPTR   EQU   @03
UCBPTR   EQU   @08
AWORKPTR EQU   @05
REG1     EQU   @01
SETDSKPT EQU   @02
CHNPGMPT EQU   @06
HDR1PTR  EQU   @07
REPLYPTR EQU   @08
VOL1PTR  EQU   @11
LOCKREG  EQU   @11
REG14    EQU   @14
REG15    EQU   @15
UCBDCPTR EQU   @11
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
IOBPREFX EQU   0
IOBCFLG1 EQU   IOBPREFX
IOBSTDRD EQU   0
IOBFLAG1 EQU   IOBSTDRD
IOBCYCCK EQU   IOBFLAG1
IOBRSTRT EQU   IOBFLAG1
IOBFLAG2 EQU   IOBSTDRD+1
IOBPURGE EQU   IOBFLAG2
IOBRDHA0 EQU   IOBFLAG2
IOBSENS0 EQU   IOBSTDRD+2
IOBS0B7  EQU   IOBSENS0
IOBSENS1 EQU   IOBSTDRD+3
IOBECBPT EQU   IOBSTDRD+4
IOBFLAG3 EQU   IOBSTDRD+8
IOBFL3   EQU   IOBFLAG3
IOBCSW   EQU   IOBSTDRD+9
IOBIOCSW EQU   IOBCSW
IOBSTART EQU   IOBSTDRD+16
IOBSTRTB EQU   IOBSTART+1
IOBDCBPT EQU   IOBSTDRD+20
IOBFLAG4 EQU   IOBDCBPT
IOBRESTR EQU   IOBSTDRD+24
IOBINCAM EQU   IOBSTDRD+28
IOBBTAMF EQU   IOBINCAM
DEBBASIC EQU   0
DEBTCBAD EQU   DEBBASIC
DEBDEBAD EQU   DEBBASIC+4
DEBIRBAD EQU   DEBBASIC+8
DEBOFLGS EQU   DEBIRBAD
DEBOPATB EQU   DEBBASIC+12
DEBFLGS1 EQU   DEBBASIC+14
DEBUSRPG EQU   DEBBASIC+16
DEBRRQ   EQU   DEBBASIC+20
DEBECBAD EQU   DEBRRQ
DEBDCBAD EQU   DEBBASIC+24
DEBPROTG EQU   DEBDCBAD
DEBAPPAD EQU   DEBBASIC+28
DEBBASND EQU   DEBBASIC+32
DEBDASD  EQU   0
DEBUCBAD EQU   DEBDASD
DEBACSMD EQU   0
DEBVOLSQ EQU   DEBACSMD
DEBVOLBT EQU   DEBVOLSQ
DEBDSNM  EQU   DEBACSMD+4
DEBUTSAA EQU   DEBDSNM
DEBACS01 EQU   0
DEBDSNAM EQU   DEBACS01
DEBACS02 EQU   0
DEBDBLK  EQU   DEBACS02
DEBACS03 EQU   0
DEBACS04 EQU   0
DEBTBFRA EQU   DEBACS04
DEBTCCWA EQU   DEBACS04+4
DEBACS05 EQU   0
DEBFUCBA EQU   DEBACS05
DEBLUCBA EQU   DEBACS05+4
DEBACS06 EQU   0
DEBACS07 EQU   0
DEBACS08 EQU   0
DEBSUBNM EQU   0
DEB      EQU   0
DEBAVT   EQU   DEB
DEBEOEA  EQU   DEBAVT
DEBEOEAB EQU   DEBEOEA
DEBSIOA  EQU   DEBAVT+4
DEBSIOAB EQU   DEBSIOA
DEBPCIA  EQU   DEBAVT+8
DEBPCIAB EQU   DEBPCIA
DEBCEA   EQU   DEBAVT+12
DEBCEAB  EQU   DEBCEA
DEBXCEA  EQU   DEBAVT+16
DEBXCEAB EQU   DEBXCEA
DEBPREFX EQU   DEB+20
DEBXTNP  EQU   DEBPREFX+8
DEBXTN   EQU   0
DEBXFLG1 EQU   DEBXTN+2
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFEC  EQU   DCBIFLGS
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00029 EQU   IHADCS40+12
DCBEROPT EQU   @NM00029
UCB      EQU   0
UCBLOCK  EQU   UCB+504
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBNAME  EQU   UCBOB+13
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00036 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBVLSER EQU   UCB3540X
UCBDKBYT EQU   UCB3540X+6
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
AMWORKAR EQU   0
JAMWKAR  EQU   AMWORKAR+4
IOBPTR   EQU   JAMWKAR+1
CCWPTR   EQU   JAMWKAR+5
WORKAREA EQU   JAMWKAR+16
AMW3540E EQU   AMWORKAR+120
AMWVOLAC EQU   AMW3540E
AMWDSSQL EQU   AMW3540E+1
AMWVSEQU EQU   AMW3540E+2
AMWEAMFG EQU   AMW3540E+3
AMWDSOPN EQU   AMWEAMFG
AMWMLTVL EQU   AMWEAMFG
AMWDSID  EQU   AMW3540E+4
AMWEXDTE EQU   AMWDSID
AMWWTPTI EQU   AMWDSID+6
AMWEOD   EQU   AMW3540E+12
AMWBOE   EQU   AMWEOD
AMWEODRV EQU   AMWBOE
AMWEODTT EQU   AMWBOE+1
AMWBOETT EQU   AMWEODTT
AMWEOD0  EQU   AMWBOE+2
AMWEODSS EQU   AMWBOE+3
AMWBOESS EQU   AMWEODSS
ACB35EXT EQU   AMWORKAR+136
ACBJOBID EQU   ACB35EXT+8
ACB35IND EQU   ACB35EXT+22
ACBFEED  EQU   ACB35IND
ACBSECUR EQU   ACB35IND
ACBLRECL EQU   AMWORKAR+162
EXLIST   EQU   AMWORKAR+164
RPLFIELD EQU   AMWORKAR+172
PRLOPTBT EQU   RPLFIELD+8
RPLFDBK  EQU   RPLFIELD+9
SETDLIST EQU   AMWORKAR+184
SETDWORK EQU   AMWORKAR+200
SAVEIOB  EQU   SETDWORK
SAVEIOBX EQU   SETDWORK+4
SAVEUCB  EQU   SETDWORK+8
I        EQU   SETDWORK+12
J        EQU   SETDWORK+16
SAVESEEK EQU   SETDWORK+20
CCW21SAV EQU   SETDWORK+24
CCW26SAV EQU   SETDWORK+32
NOOPESAV EQU   SETDWORK+40
SAVEADDR EQU   SETDWORK+48
TABLE    EQU   SETDWORK+136
TRANSTBL EQU   TABLE
MSGAREA  EQU   SETDWORK+160
MSGLIST  EQU   MSGAREA
MSGINDEX EQU   MSGLIST
MSGTYPCD EQU   MSGLIST+1
MSGDCBAD EQU   MSGLIST+4
MSGREPAD EQU   MSGLIST+8
MSGTEXT  EQU   MSGAREA+12
SAVEVOL  EQU   SETDWORK+218
CONVERT  EQU   SETDWORK+224
TEMP1    EQU   SETDWORK+230
TEMP2    EQU   SETDWORK+232
REMAIN   EQU   SETDWORK+234
JULIANDY EQU   SETDWORK+238
JULIANDT EQU   SETDWORK+240
DAY1     EQU   SETDWORK+242
SAVEDATE EQU   SETDWORK+244
UNPKDATE EQU   SETDWORK+248
UNPKYEAR EQU   UNPKDATE+3
SYSYEAR  EQU   SETDWORK+256
SYSDAY   EQU   SETDWORK+258
HDRYEAR1 EQU   SETDWORK+260
HDRDAY1  EQU   SETDWORK+262
DAY      EQU   SETDWORK+264
MONTH    EQU   SETDWORK+265
YEAR     EQU   SETDWORK+266
HDRMTH1  EQU   SETDWORK+267
NUMDAY   EQU   SETDWORK+269
WORKFLG1 EQU   SETDWORK+271
FIRSTTME EQU   WORKFLG1
GOODVOL1 EQU   WORKFLG1
GOODHDR1 EQU   WORKFLG1
BADVOLID EQU   WORKFLG1
SCRCHDSK EQU   WORKFLG1
NOSRTCDS EQU   WORKFLG1
BLKHDRFG EQU   WORKFLG1
DUPDSID  EQU   WORKFLG1
WORKFLG2 EQU   SETDWORK+272
EOVPROC  EQU   WORKFLG2
FEEDCODE EQU   WORKFLG2
BADREPLY EQU   WORKFLG2
BLANKCHR EQU   WORKFLG2
SECURVOL EQU   WORKFLG2
SETDISKT EQU   0
SETOPCDE EQU   SETDISKT
SETFLAGS EQU   SETDISKT+1
SETRETCD EQU   SETDISKT+2
ERTNCDE  EQU   SETRETCD
ERTNCDQL EQU   SETRETCD+1
SDKTDCB  EQU   SETDISKT+4
SDKTDSID EQU   SETDISKT+8
CHANPGM  EQU   0
ECBMAP   EQU   0
ECBCC    EQU   ECBMAP
REPLYMAP EQU   0
REPLYARA EQU   REPLYMAP
REPLYCHR EQU   0
CHARACTR EQU   0
VOL13540 EQU   0
VOLLABID EQU   VOL13540
VOLID    EQU   VOL13540+4
VOLACCIN EQU   VOL13540+10
VOLLABVR EQU   VOL13540+79
HDR13540 EQU   0
HDRID    EQU   HDR13540
HDRDSID  EQU   HDR13540+5
HDRBLKLN EQU   HDR13540+22
HDRBOE   EQU   HDR13540+28
HDRBOECC EQU   HDRBOE
HDRBOEH  EQU   HDRBOE+2
HDRBOERR EQU   HDRBOE+3
HDREOE   EQU   HDR13540+34
HDREOECC EQU   HDREOE
HDREOEH  EQU   HDREOE+2
HDREOERR EQU   HDREOE+3
HDRSECIN EQU   HDR13540+41
HDRWTPTI EQU   HDR13540+42
HDRMVLI  EQU   HDR13540+44
HDRVOLSQ EQU   HDR13540+45
HDREXDTE EQU   HDR13540+66
HDRYEAR  EQU   HDREXDTE
HDRMONTH EQU   HDREXDTE+2
HDRDAY   EQU   HDREXDTE+4
HDREOD   EQU   HDR13540+74
HDREODCC EQU   HDREOD
HDREODH  EQU   HDREOD+2
HDREODRR EQU   HDREOD+3
CL0001@  EQU   0
UCBBGN   EQU   0
IOBORG01 EQU   IOBPREFX+8
IOBNIOBA EQU   IOBORG01
IOBNFLG1 EQU   IOBNIOBA
IOBORG02 EQU   IOBPREFX+8
IOBDQADA EQU   IOBORG02
IOBDEQIN EQU   IOBDQADA
IOBORG03 EQU   IOBPREFX+12
IOBORG04 EQU   IOBINCAM
IOBORG12 EQU   IOBINCAM
IOBFL4   EQU   IOBORG12
IOBEXTEN EQU   IOBSTDRD+32
IOBSEEK  EQU   IOBEXTEN
IOBBB    EQU   IOBSEEK+1
IOBCC    EQU   IOBSEEK+3
IOBHH    EQU   IOBSEEK+5
IOBORG05 EQU   IOBEXTEN
IOBORG06 EQU   IOBEXTEN
IOBNXTPT EQU   IOBORG06+4
IOBSTATA EQU   IOBNXTPT
IOBORG07 EQU   IOBEXTEN+8
W1IEXTEN EQU   IOBORG07
IOBORG08 EQU   IOBEXTEN+8
IOBINDCT EQU   IOBORG08+4
IOBUNSQR EQU   IOBORG08+5
IOBFCHAD EQU   IOBORG08+8
IOBORG09 EQU   IOBEXTEN+8
IOBDPLAD EQU   IOBORG09+4
IOBDTYPE EQU   IOBORG09+8
IOBDTYP2 EQU   IOBORG09+9
IOBDSTAT EQU   IOBORG09+10
IOBSTAT1 EQU   IOBDSTAT
IOBORG10 EQU   IOBEXTEN+8
IOBSEEK2 EQU   IOBORG10
IOBORG11 EQU   IOBEXTEN
IOBERCT  EQU   IOBORG11
IOBUCBXV EQU   IOBERCT
IOBNAME  EQU   IOBORG11+4
IOBORG13 EQU   IOBEXTEN
IOBSKADR EQU   IOBORG13
IOBSKTT  EQU   IOBSKADR+1
IOBSKSS  EQU   IOBSKADR+3
DEBBAS02 EQU   DEBBASND
DEBDDS1  EQU   DEBBAS02
DEBSUCBA EQU   DEBDDS1
DEBSUCBB EQU   DEBSUCBA+1
DEBDEVED EQU   DEBDDS1+4
DEBRDCB  EQU   DEBDDS1+4
DEBPDCB  EQU   DEBDDS1+8
DEBWDCB  EQU   DEBDDS1+12
DEBACS09 EQU   DEBDEVED
DEBASC09 EQU   DEBACS09
DEBEAMFG EQU   DEBASC09+3
DEBDSID  EQU   DEBASC09+4
DEBEOD   EQU   DEBASC09+12
DEBBOE   EQU   DEBEOD
DEBEODRV EQU   DEBBOE
DEBEODTT EQU   DEBBOE+1
DEBEOD0  EQU   DEBBOE+2
DEBEODSS EQU   DEBBOE+3
DEBBAS01 EQU   DEBBASND
DEBISAM  EQU   DEBBAS01
DEBFIEAD EQU   DEBISAM
DEBFPEAD EQU   DEBISAM+4
DEBFOEAD EQU   DEBISAM+8
DEBEXPT  EQU   DEBISAM+12
DEBRPSID EQU   DEBEXPT
UCBOBS01 EQU   UCBDEV
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00035 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBOBS09 EQU   UCBDEV
PSARSVTE EQU   PSARSVT
DCBAMWRK EQU   DCBIOBAD
@NM00073 EQU   DCBAMWRK
DCBAMWKA EQU   DCBAMWRK+1
FLC      EQU   PSA
*                                      START UNREFERENCED COMPONENTS
DCBAMOUT EQU   @NM00073
DCBAMIN  EQU   @NM00073
DCB3540A EQU   @NM00073
@NM00074 EQU   @NM00073
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00035
UCBSKPFG EQU   @NM00035
UCBRIPND EQU   @NM00035
UCBRTIAC EQU   @NM00035
UCBRSV79 EQU   @NM00035
UCBRSV78 EQU   @NM00035
UCBRSV77 EQU   @NM00035
UCBOLTEP EQU   @NM00035
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00034 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
UCBVTOC  EQU   UCBOBS01
DEBEXPTA EQU   DEBEXPT+1
DEBRSV12 EQU   DEBRPSID
DEBRSV11 EQU   DEBRPSID
DEBRSV10 EQU   DEBRPSID
DEBRSV09 EQU   DEBRPSID
DEBRPSAP EQU   DEBRPSID
DEBRPSO  EQU   DEBRPSID
DEBRPSI  EQU   DEBRPSID
DEBRPSP  EQU   DEBRPSID
DEBFOEB  EQU   DEBFOEAD+1
DEBNOEE  EQU   DEBFOEAD
DEBFPEB  EQU   DEBFPEAD+1
DEBNPEE  EQU   DEBFPEAD
DEBFIEB  EQU   DEBFIEAD+1
DEBNIEE  EQU   DEBFIEAD
DEBBOESS EQU   DEBEODSS
DEBBOE0  EQU   DEBEOD0
DEBBOETT EQU   DEBEODTT
DEBBOERV EQU   DEBEODRV
DEBRV008 EQU   DEBDSID+7
DEBWTPTI EQU   DEBDSID+6
DEBEXDTE EQU   DEBDSID
DEBRV007 EQU   DEBEAMFG
DEBRV006 EQU   DEBEAMFG
DEBRV005 EQU   DEBEAMFG
DEBRV004 EQU   DEBEAMFG
DEBSECVL EQU   DEBEAMFG
DEBVAMSG EQU   DEBEAMFG
DEBDSOPN EQU   DEBEAMFG
DEBMULTI EQU   DEBEAMFG
DEBVSEQU EQU   DEBASC09+2
DEBDSSQL EQU   DEBASC09+1
DEBVOLAC EQU   DEBASC09
DEBWDCBA EQU   DEBWDCB+1
DEBRSV08 EQU   DEBWDCB
DEBPDCBA EQU   DEBPDCB+1
DEBRSV07 EQU   DEBPDCB
DEBRDCBA EQU   DEBRDCB+1
DEBRSV06 EQU   DEBRDCB
DEBSDVM  EQU   DEBSUCBA
IOBSK0   EQU   IOBSKADR+2
IOBSKRV  EQU   IOBSKADR
IOBCSWSV EQU   IOBORG11+17
IOBSENSV EQU   IOBORG11+16
IOBRCD   EQU   IOBORG11+12
IOBMDREC EQU   IOBORG11+8
IOBNAMEA EQU   IOBNAME+1
IOBNAMSZ EQU   IOBNAME
IOBERCTA EQU   IOBERCT+1
IOBRTYPE EQU   IOBUCBXV
IOBRDCHP EQU   IOBORG10+20
IOBNEXTA EQU   IOBORG10+16
IOBREADA EQU   IOBORG10+12
IOBBUFC  EQU   IOBORG10+8
IOBSK2R  EQU   IOBSEEK2+7
IOBSK2HH EQU   IOBSEEK2+5
IOBSK2CC EQU   IOBSEEK2+3
IOBSK2BB EQU   IOBSEEK2+1
IOBSK2M  EQU   IOBSEEK2
IOBCHNPR EQU   IOBORG09+40
IOBDNCRF EQU   IOBORG09+32
IOBRSV35 EQU   IOBORG09+24
IOBDQPTR EQU   IOBORG09+20
IOBRSV34 EQU   IOBORG09+18
IOBDBYTN EQU   IOBORG09+16
IOBDCPND EQU   IOBORG09+12
IOBSTAT2 EQU   IOBDSTAT+1
IOBSIORT EQU   IOBSTAT1
IOBADDVU EQU   IOBSTAT1
IOBBUFF  EQU   IOBSTAT1
IOBENQUE EQU   IOBSTAT1
IOBPASS2 EQU   IOBSTAT1
IOBSYNCH EQU   IOBSTAT1
IOBNEWVL EQU   IOBSTAT1
IOBABNRM EQU   IOBSTAT1
IOBRELEX EQU   IOBDTYP2
IOBADDTY EQU   IOBDTYP2
IOBTYPE  EQU   IOBDTYP2
IOBRQUST EQU   IOBDTYP2
IOBSUFFX EQU   IOBDTYP2
IOBSBLKL EQU   IOBDTYP2
IOBSKEY  EQU   IOBDTYP2
IOBRELBL EQU   IOBDTYPE
IOBRDEXC EQU   IOBDTYPE
IOBDYNBF EQU   IOBDTYPE
IOBACTAD EQU   IOBDTYPE
IOBFDBCK EQU   IOBDTYPE
IOBEXTSC EQU   IOBDTYPE
IOBOVFLO EQU   IOBDTYPE
IOBVERFY EQU   IOBDTYPE
IOBDPLB  EQU   IOBDPLAD+1
IOBDAYLI EQU   IOBDPLAD
IOBDIOBS EQU   IOBORG09+2
IOBDBYTR EQU   IOBORG09
IOBBCHAD EQU   IOBORG08+12
IOBFCHNB EQU   IOBFCHAD+1
IOBCOUNT EQU   IOBFCHAD
IOBASYN  EQU   IOBORG08+7
IOBAPP   EQU   IOBORG08+6
IOBRSV32 EQU   IOBUNSQR
IOBRSV31 EQU   IOBUNSQR
IOBRSV30 EQU   IOBUNSQR
IOBKNRWR EQU   IOBUNSQR
IOBKNWR  EQU   IOBUNSQR
IOBNTAV2 EQU   IOBUNSQR
IOBNTAV1 EQU   IOBUNSQR
IOBCPBSY EQU   IOBUNSQR
IOBCHNNL EQU   IOBINDCT
IOBRSV29 EQU   IOBINDCT
IOBRSV28 EQU   IOBINDCT
IOBRSV27 EQU   IOBINDCT
IOBKEYAD EQU   IOBINDCT
IOBOVPTR EQU   IOBINDCT
IOBUNSCH EQU   IOBINDCT
IOBDEQCP EQU   IOBINDCT
IOBCCWAD EQU   IOBORG08
W1OEXTEN EQU   W1IEXTEN
IOBCCW   EQU   IOBORG06+8
IOBNXTPB EQU   IOBNXTPT+1
IOBRSV26 EQU   IOBSTATA
IOBRSV25 EQU   IOBSTATA
IOBRSV24 EQU   IOBSTATA
IOBRSV23 EQU   IOBSTATA
IOBRSV22 EQU   IOBSTATA
IOBRSV21 EQU   IOBSTATA
IOBRSV20 EQU   IOBSTATA
IOBAVLFL EQU   IOBSTATA
IOBRSV37 EQU   IOBORG06+1
IOBUCBXG EQU   IOBORG06
IOBCPA   EQU   IOBORG05+32
IOBERINF EQU   IOBORG05+16
IOBERCCW EQU   IOBORG05+8
IOBSNDPT EQU   IOBORG05+7
IOBRCVPT EQU   IOBORG05+6
IOBWORK  EQU   IOBORG05+1
IOBUCBX  EQU   IOBORG05
IOBR     EQU   IOBSEEK+7
IOBHH2   EQU   IOBHH+1
IOBHH1   EQU   IOBHH
IOBCC2   EQU   IOBCC+1
IOBCC1   EQU   IOBCC
IOBBB2   EQU   IOBBB+1
IOBBB1   EQU   IOBBB
IOBM     EQU   IOBSEEK
IOBRSV46 EQU   IOBFL4
IOBRSV47 EQU   IOBFL4
IOBENT   EQU   IOBFL4
IOBEQP   EQU   IOBFL4
IOBBUS   EQU   IOBFL4
IOBDCK   EQU   IOBFL4
IOBREJ   EQU   IOBFL4
IOBOVR   EQU   IOBFL4
IOBCRILC EQU   IOBORG04+1
IOBCRDCC EQU   IOBORG04
IOBGQECB EQU   IOBORG03
IOBSWAP  EQU   IOBORG02+4
IOBDQADB EQU   IOBDQADA+1
IOBRSV13 EQU   IOBDEQIN
IOBRSV12 EQU   IOBDEQIN
IOBRSV11 EQU   IOBDEQIN
IOBRSV10 EQU   IOBDEQIN
IOBRSV09 EQU   IOBDEQIN
IOBRSV08 EQU   IOBDEQIN
IOBRSV07 EQU   IOBDEQIN
IOBDEQ   EQU   IOBDEQIN
IOBNECB  EQU   IOBORG01+4
IOBNIOBB EQU   IOBNIOBA+1
IOBFIRST EQU   IOBNFLG1
IOBUPERR EQU   IOBNFLG1
IOBSPAN  EQU   IOBNFLG1
IOBBKSPC EQU   IOBNFLG1
IOBUPDAT EQU   IOBNFLG1
IOBREAD  EQU   IOBNFLG1
IOBWRITE EQU   IOBNFLG1
IOBPRTOV EQU   IOBNFLG1
HDRCONTI EQU   HDR13540+79
@NM00085 EQU   HDR13540+73
HDRVERFY EQU   HDR13540+72
@NM00084 EQU   HDR13540+53
HDRDSCD  EQU   HDR13540+47
HDRINTCH EQU   HDR13540+43
HDRBYPAS EQU   HDR13540+40
@NM00083 EQU   HDR13540+39
@NM00082 EQU   HDR13540+33
@NM00081 EQU   HDR13540+27
HDRNRECS EQU   HDR13540+17
HDRRECLN EQU   HDR13540+13
@NM00080 EQU   HDR13540+4
@NM00079 EQU   VOL13540+78
VOLSEQ   EQU   VOL13540+76
VOLPHYRL EQU   VOL13540+75
@NM00078 EQU   VOL13540+51
VOLOWNID EQU   VOL13540+37
@NM00077 EQU   VOL13540+16
VOLADMLB EQU   VOL13540+11
@NM00076 EQU   REPLYMAP+1
ECBRBA   EQU   ECBMAP+1
@NM00075 EQU   SETFLAGS
SDKTVFYI EQU   SETFLAGS
BUFFER2  EQU   AMWORKAR+4488
CCWS2    EQU   AMWORKAR+4256
IOB2     EQU   AMWORKAR+4208
BUFFER1  EQU   AMWORKAR+880
CCWS1    EQU   AMWORKAR+648
IOB1     EQU   AMWORKAR+600
@NM00072 EQU   SETDWORK+273
@NM00071 EQU   WORKFLG2
UNPKDAY  EQU   UNPKDATE+5
@NM00070 EQU   UNPKDATE
CONVERT1 EQU   SETDWORK+228
@NM00069 EQU   SETDWORK+217
MSGRTCDE EQU   MSGLIST+2
SETDDSID EQU   SETDLIST+8
SETDDCB  EQU   SETDLIST+4
SETDRTNC EQU   SETDLIST+2
SETDVERY EQU   SETDLIST+1
SETDOPCD EQU   SETDLIST
RPLFDBK3 EQU   RPLFDBK+2
RPLFDBK2 EQU   RPLFDBK+1
RPLFDBK1 EQU   RPLFDBK
@NM00068 EQU   PRLOPTBT
RPLEODS  EQU   PRLOPTBT
RPLAREA  EQU   RPLFIELD+4
RPLRLEN  EQU   RPLFIELD
EXLEODP  EQU   EXLIST+4
EXLSYNP  EQU   EXLIST
@NM00067 EQU   AMWORKAR+160
@NM00066 EQU   ACB35IND
ACBVSSER EQU   ACB35EXT+16
ACBDSID  EQU   ACB35EXT
AMWBOE0  EQU   AMWEOD0
AMWBOERV EQU   AMWEODRV
@NM00065 EQU   AMWDSID+7
@NM00064 EQU   AMWEAMFG
AMWVAMSG EQU   AMWEAMFG
AMWMULTI EQU   AMWEAMFG
REGSAVE  EQU   WORKAREA+28
WORKBSL  EQU   WORKAREA
IOBBFLN  EQU   JAMWKAR+13
@NM00063 EQU   JAMWKAR+12
IOB1ADDR EQU   JAMWKAR+9
@NM00062 EQU   JAMWKAR+8
@NM00061 EQU   JAMWKAR+4
IOBNO    EQU   JAMWKAR
AMWLEN   EQU   AMWORKAR
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00036
UCBHALI  EQU   @NM00036
UCBRSV09 EQU   @NM00036
UCBRSV08 EQU   @NM00036
UCBRSV07 EQU   @NM00036
UCBRSV06 EQU   @NM00036
UCBRSV05 EQU   @NM00036
UCBRSV04 EQU   @NM00036
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBFLB7  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBPXST  EQU   UCB+504
@NM00033 EQU   UCB
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00032 EQU   IHADCS40+16
@NM00031 EQU   @NM00029+1
@NM00030 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
@NM00028 EQU   IHADCS40+10
@NM00027 EQU   IHADCS40+9
@NM00026 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00025 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
DCBLRECL EQU   IHADCS38+10
@NM00024 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00023 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00022 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00021 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00020 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBBLKSI EQU   IHADCS36+10
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00019 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00018 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
@NM00017 EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00016 EQU   DCBPUT
DCBREADA EQU   DCBWRITA
@NM00015 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00014 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00013 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBIBPCT EQU   DCBIFLG
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00012 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00011 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00010 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00009 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
DCBDSGMQ EQU   DCBDSRG1
DCBDSGCQ EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRBAL EQU   IHADCS01+6
@NM00008 EQU   IHADCS01+5
@NM00007 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00006 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00005 EQU   IHADCB
DEBXRV40 EQU   DEBXTN+28
DEBXRV39 EQU   DEBXTN+24
DEBXXARG EQU   DEBXTN+20
DEBXMCF2 EQU   DEBXTN+19
DEBXMCF1 EQU   DEBXTN+18
DEBXDSO2 EQU   DEBXTN+17
DEBXDSO1 EQU   DEBXTN+16
DEBXDBPR EQU   DEBXTN+12
DEBXDCBM EQU   DEBXTN+8
DEBXDSAB EQU   DEBXTN+4
DEBXRV48 EQU   DEBXTN+3
DEBXRV47 EQU   DEBXFLG1
DEBXRV46 EQU   DEBXFLG1
DEBXRV45 EQU   DEBXFLG1
DEBXRV44 EQU   DEBXFLG1
DEBXRV43 EQU   DEBXFLG1
DEBXRV42 EQU   DEBXFLG1
DEBXTSKC EQU   DEBXFLG1
DEBXCDCB EQU   DEBXFLG1
DEBXLNGH EQU   DEBXTN
DEBTBLOF EQU   DEBPREFX+14
DEBAMTYP EQU   DEBPREFX+13
DEBLNGTH EQU   DEBPREFX+12
DEBDCBMK EQU   DEBXTNP
DEBDSCBA EQU   DEBPREFX+1
DEBWKARA EQU   DEBPREFX
DEBXCEAD EQU   DEBXCEA+1
DEBXCENP EQU   DEBXCEAB
DEBRSV35 EQU   DEBXCEAB
DEBRSV34 EQU   DEBXCEAB
DEBRSV33 EQU   DEBXCEAB
DEBRSV32 EQU   DEBXCEAB
DEBCEAD  EQU   DEBCEA+1
DEBCENP  EQU   DEBCEAB
DEBRSV31 EQU   DEBCEAB
DEBRSV30 EQU   DEBCEAB
DEBRSV29 EQU   DEBCEAB
DEBRSV28 EQU   DEBCEAB
DEBPCIAD EQU   DEBPCIA+1
DEBPCINP EQU   DEBPCIAB
DEBRSV27 EQU   DEBPCIAB
DEBRSV26 EQU   DEBPCIAB
DEBRSV25 EQU   DEBPCIAB
DEBRSV24 EQU   DEBPCIAB
DEBSIOAD EQU   DEBSIOA+1
DEBSIONP EQU   DEBSIOAB
DEBFIX   EQU   DEBSIOAB
DEBIOVR  EQU   DEBSIOAB
DEBSIOX  EQU   DEBSIOAB
DEBPGFX  EQU   DEBSIOAB
DEBEOEAD EQU   DEBEOEA+1
DEBEOENP EQU   DEBEOEAB
DEBRSV22 EQU   DEBEOEAB
DEBRSV21 EQU   DEBEOEAB
DEBRSV20 EQU   DEBEOEAB
DEBRSV19 EQU   DEBEOEAB
DEBSUBID EQU   DEBSUBNM
DEBSIOA2 EQU   DEBACS08+24
DEBRPSIO EQU   DEBACS08+20
DEBFREED EQU   DEBACS08+16
@NM00004 EQU   DEBACS08+12
@NM00003 EQU   DEBACS08+8
DEBDISAD EQU   DEBACS08+4
@NM00002 EQU   DEBACS08
DEBRPSST EQU   DEBACS07+64
DEBARECK EQU   DEBACS07+60
DEBAREWT EQU   DEBACS07+56
DEBACHK  EQU   DEBACS07+52
DEBAWRIT EQU   DEBACS07+48
DEBASETL EQU   DEBACS07+44
DEBAREAD EQU   DEBACS07+40
DEBCRECK EQU   DEBACS07+36
DEBCREWT EQU   DEBACS07+32
DEBCCHK  EQU   DEBACS07+28
DEBCWRIT EQU   DEBACS07+24
DEBCSETL EQU   DEBACS07+20
DEBCREAD EQU   DEBACS07+16
DEBWKPT5 EQU   DEBACS07+12
DEBWKPT4 EQU   DEBACS07+8
DEBGET   EQU   DEBACS07+4
@NM00001 EQU   DEBACS07
DEBPUT   EQU   DEBACS06+4
DEBDCBFA EQU   DEBACS06
DEBLUCBB EQU   DEBLUCBA+1
DEBRSV18 EQU   DEBLUCBA
DEBFUCBB EQU   DEBFUCBA+1
DEBRSV17 EQU   DEBFUCBA
DEBTCCWB EQU   DEBTCCWA+1
DEBRSV16 EQU   DEBTCCWA
DEBTBFRB EQU   DEBTBFRA+1
DEBRSV15 EQU   DEBTBFRA
DEBDBPEF EQU   DEBACS03+8
DEBDBPP  EQU   DEBACS03+4
DEBDTPP  EQU   DEBACS03
DEBDBPE  EQU   DEBDBLK+1
DEBDBPT  EQU   DEBDBLK
DEBEXTNM EQU   DEBDSNAM
DEBRSV14 EQU   DEBDSNM+4
DEBUTSAB EQU   DEBUTSAA+1
DEBRSV13 EQU   DEBUTSAA
DEBVOLNM EQU   DEBACSMD+2
DEBVLSEQ EQU   DEBVOLSQ+1
DEBRSV42 EQU   DEBVOLBT
DEBRSV41 EQU   DEBVOLBT
DEBRSV40 EQU   DEBVOLBT
DEBRSV39 EQU   DEBVOLBT
DEBRSV38 EQU   DEBVOLBT
DEBRSV37 EQU   DEBVOLBT
DEBRSV36 EQU   DEBVOLBT
DEBEXFUL EQU   DEBVOLBT
DEBNMTRK EQU   DEBDASD+14
DEBENDHH EQU   DEBDASD+12
DEBENDCC EQU   DEBDASD+10
DEBSTRHH EQU   DEBDASD+8
DEBSTRCC EQU   DEBDASD+6
DEBBINUM EQU   DEBDASD+4
DEBUCBA  EQU   DEBUCBAD+1
DEBDVMOD EQU   DEBUCBAD
DEBAPPB  EQU   DEBAPPAD+1
DEBEXSCL EQU   DEBAPPAD
DEBDCBB  EQU   DEBDCBAD+1
DEBDEBID EQU   DEBPROTG
DEBECBB  EQU   DEBECBAD+1
DEBPRIOR EQU   DEBECBAD
DEBUSRPB EQU   DEBUSRPG+1
DEBNMEXT EQU   DEBUSRPG
DEBRSV05 EQU   DEBBASIC+15
DEBXTNIN EQU   DEBFLGS1
DEBAPFIN EQU   DEBFLGS1
DEBF1CEV EQU   DEBFLGS1
DEBCINDI EQU   DEBFLGS1
DEBRSV02 EQU   DEBFLGS1
DEBRSIOA EQU   DEBFLGS1
DEBEOFDF EQU   DEBFLGS1
DEBPWCKD EQU   DEBFLGS1
DEBQSCNT EQU   DEBBASIC+13
DEBACCS  EQU   DEBOPATB
DEBPOSIT EQU   DEBOPATB
DEBZERO  EQU   DEBOPATB
DEBABEND EQU   DEBOPATB
DEBIRBB  EQU   DEBIRBAD+1
DEBRERR  EQU   DEBOFLGS
DEBLABEL EQU   DEBOFLGS
DEBSPLIT EQU   DEBOFLGS
DEBDCB   EQU   DEBOFLGS
DEBRLSE  EQU   DEBOFLGS
DEBEOF   EQU   DEBOFLGS
DEBDISP  EQU   DEBOFLGS
DEBDEBB  EQU   DEBDEBAD+1
DEBAMLNG EQU   DEBDEBAD
DEBTCBB  EQU   DEBTCBAD+1
DEBNMSUB EQU   DEBTCBAD
IOBERRCT EQU   IOBSTDRD+30
IOBRSV19 EQU   IOBINCAM+1
IOBOLTST EQU   IOBBTAMF
IOBRFTMG EQU   IOBBTAMF
IOBRSV17 EQU   IOBBTAMF
IOBRSV16 EQU   IOBBTAMF
IOBRSV15 EQU   IOBBTAMF
IOBRSV14 EQU   IOBBTAMF
IOBINUSE EQU   IOBBTAMF
IOBPRMER EQU   IOBBTAMF
IOBRSTRB EQU   IOBRESTR+1
IOBREPOS EQU   IOBRESTR
IOBDCBPB EQU   IOBDCBPT+1
IOBRSV44 EQU   IOBFLAG4
IOBJES3I EQU   IOBFLAG4
IOBRSV42 EQU   IOBFLAG4
IOBRSV41 EQU   IOBFLAG4
IOBRSV40 EQU   IOBFLAG4
IOBPMERR EQU   IOBFLAG4
IOBCC3WE EQU   IOBFLAG4
IOBGDPOL EQU   IOBFLAG4
IOBSIOCC EQU   IOBSTART
IOBSTBYT EQU   IOBIOCSW+3
IOBCMDA  EQU   IOBIOCSW
IOBLOG   EQU   IOBFL3
IOBICL   EQU   IOBFL3
IOBMSG   EQU   IOBFL3
IOBCNC   EQU   IOBFL3
IOBACU   EQU   IOBFL3
IOBCDC   EQU   IOBFL3
IOBICC   EQU   IOBFL3
IOBCCC   EQU   IOBFL3
IOBECBPB EQU   IOBECBPT+1
IOBECBCC EQU   IOBECBPT
IOBS1B7  EQU   IOBSENS1
IOBS1B6  EQU   IOBSENS1
IOBS1B5  EQU   IOBSENS1
IOBS1B4  EQU   IOBSENS1
IOBS1B3  EQU   IOBSENS1
IOBS1B2  EQU   IOBSENS1
IOBS1B1  EQU   IOBSENS1
IOBS1B0  EQU   IOBSENS1
IOBSNSC9 EQU   IOBS0B7
IOBS0B6  EQU   IOBSENS0
IOBS0B5  EQU   IOBSENS0
IOBS0B4  EQU   IOBSENS0
IOBS0B3  EQU   IOBSENS0
IOBS0B2  EQU   IOBSENS0
IOBS0B1  EQU   IOBSENS0
IOBS0B0  EQU   IOBSENS0
IOBPNCH  EQU   IOBFLAG2
IOBSTATO EQU   IOBFLAG2
IOBSKUPD EQU   IOBFLAG2
IOBALTTR EQU   IOBFLAG2
IOBRRT2  EQU   IOBRDHA0
IOBRRT3  EQU   IOBPURGE
IOBSENSE EQU   IOBFLAG2
IOBHALT  EQU   IOBFLAG2
IOBSPSVC EQU   IOBRSTRT
IOBUNREL EQU   IOBFLAG1
IOBIOERR EQU   IOBFLAG1
IOBFCREX EQU   IOBCYCCK
IOBRPSTN EQU   IOBFLAG1
IOBERRTN EQU   IOBFLAG1
IOBCMDCH EQU   IOBFLAG1
IOBDATCH EQU   IOBFLAG1
IOBCNOPA EQU   IOBPREFX+12
IOBCICB  EQU   IOBPREFX+8
IOBCECB  EQU   IOBPREFX+4
IOBCONOP EQU   IOBPREFX+3
IOBCINOP EQU   IOBPREFX+2
IOBRSV05 EQU   IOBPREFX+1
IOBPCI   EQU   IOBCFLG1
IOBRSTCH EQU   IOBCFLG1
IOBABAPP EQU   IOBCFLG1
IOBPTST  EQU   IOBCFLG1
IOBRSV04 EQU   IOBCFLG1
IOBRSV03 EQU   IOBCFLG1
IOBRSV02 EQU   IOBCFLG1
IOBRSV01 EQU   IOBCFLG1
@NM00060 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00059 EQU   PSA+1040
PSAUSEND EQU   PSA+1040
PSARV062 EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSALITA  EQU   PSA+764
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00058 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00057 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSARV013 EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSARV011 EQU   PSASUP3
PSARV010 EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSAIPCRP EQU   PSASUP1
PSAIPCDR EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00056 EQU   FLCFSA
@NM00055 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00054 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00053 EQU   FLCIOA
@NM00052 EQU   FLCMCLA+15
@NM00051 EQU   FLCMCLA+14
@NM00050 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00049 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00048 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00047 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00046 EQU   FLCPER
@NM00045 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00044 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00043 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00042 EQU   FLCPIILC
@NM00041 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00040 EQU   FLCSVILC
@NM00039 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00038 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00037 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
*                                      END UNREFERENCED COMPONENTS
@RC00193 EQU   @EL00002
@RF00237 EQU   @RC00234
@RC00251 EQU   @RC00246
@RC00249 EQU   @RC00246
@RF00257 EQU   @EL00004
@RF00279 EQU   @EL00005
@RC00282 EQU   @EL00005
@RC00372 EQU   @RC00332
@RF00291 EQU   @EL00006
@RC00430 EQU   @RC00429
@RC00445 EQU   @EL00008
@RF00460 EQU   @EL00008
@RF00523 EQU   @RC00498
@RC00508 EQU   @RC00498
@RC00540 EQU   @EL00009
@RF00577 EQU   @EL00010
@RC00596 EQU   @EL00011
@RF00722 EQU   @EL00015
@PB00015 EQU   @EL00001
@RC00446 EQU   @RC00445
@RF00520 EQU   @RC00508
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
CE0001@  EQU   @PB00002
@RF00145 EQU   CE0001@
@RF00155 EQU   CE0001@
@ENDDATA EQU   *
         END   IOESDKTO,(C'PLS1312',0701,77320)

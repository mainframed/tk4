         TITLE 'IOESDKTI-3540 SETDISKT INPUT SERVICES                  *
                        '
IOESDKTI CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IOESDKTI  76.126'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0001
         USING @DATD,@08                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @08,8(,@13)                                         0001
         LR    @13,@08                                             0001
*   SETDSKPT=REG1;                  /* SET SETDISKT POINTER  @Y30OEAC*/
         LR    SETDSKPT,REG1                                       0096
*   DCBPTR=SDKTDCB;                 /* SET POINTER TO DCB    @Y30OEAC*/
         L     @03,SDKTDCB(,SETDSKPT)                              0097
         ST    @03,DCBPTR                                          0097
*   AMWRKPTR=DCBAMWKA;              /* SET AM WORK AREA PTR  @Y30OEAC*/
         SLR   AMWRKPTR,AMWRKPTR                                   0098
         ICM   AMWRKPTR,7,DCBAMWKA+16(@03)                         0098
*   DEBPTR=DCBDEBAD;                /* SET POINTER TO DEB    @Y30OEAC*/
         L     DEBPTR,DCBDEBAD+40(,@03)                            0099
*   UCBPTR=DEBSUCBA;                /* SET POINTER TO UCB    @Y30OEAC*/
         MVC   UCBPTR(4),DEBSUCBA(DEBPTR)                          0100
*   IOBSTPTR=IOBPTR;                /* SET POINTER TO IOB    @Y30OE95*/
         SLR   IOBSTPTR,IOBSTPTR                                   0101
         ICM   IOBSTPTR,7,IOBPTR(AMWRKPTR)                         0101
*   SIOB1PTR=IOBSTPTR;              /* SAVE IOB POINTER      @Y30OE95*/
         ST    IOBSTPTR,SIOB1PTR(,AMWRKPTR)                        0102
*   CHNPGMPT=IOBSTART;              /* PTR TO CHANNEL PGM    @Y30OEAC*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0103
*   VOL1PTR=CHANPGM(3,2:4);         /* SET VOL1 LABEL PTR    @Y30OEAC*/
         SLR   VOL1PTR,VOL1PTR                                     0104
         ICM   VOL1PTR,7,CHANPGM+17(CHNPGMPT)                      0104
*   SETRETCD=CLEAR;                 /* CLEAR RETURN CODE     @Y30OEAC*/
         MVC   SETRETCD(2,SETDSKPT),CLEAR                          0105
*   RFY                             /*                       @Y30OEAC*/
*    (DEBPTR,                       /*                       @Y30OEAC*/
*     REG1) UNRSTD;                 /* RELEASE REGISTER      @Y30OEAC*/
*                                                                  0107
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/* SETDISKT INPUT SERVICES                                  @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/********************************************************** @Y30OEAC*/
*                                                                  0107
*SETDIN:                                                           0107
*   DO;                             /* SETDIN:CASE(SETOPCDE)NAMES(OPE
*                                      NDS,EOV,CLOSEDS,FEED)         */
SETDIN   DS    0H                                                  0108
*     DCL                                                          0108
*       CL0001@ LABEL BASED(CP0001@(SETOPCDE)) VALUERANGE(OPENDS,EOV,
*           CLOSEDS,FEED);          /* BRANCH TARGET                 */
*     DCL                                                          0109
*       CP0001@(4) PTR(31) INIT(ADDR(OPENDS),ADDR(EOV),ADDR(CLOSEDS),
*           ADDR(FEED));                                           0109
*     GOTO CL0001@;                 /* BRANCH TO SELECTED CASE     0110
*                                                            @Y30OEAC*/
*                                                                  0110
         SLR   @11,@11                                             0110
         IC    @11,SETOPCDE(,SETDSKPT)                             0110
         SLA   @11,2                                               0110
         L     @11,CP0001@-4(@11)                                  0110
         BR    @11                                                 0110
*     /***************************************************************/
*     /*                                                             */
*     /* OPEN DATA SET                                       @Y30OEAC*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0111
*OPENDS:                                                           0111
*     DO;                           /* SUBCASE               @Y30OEAC*/
OPENDS   DS    0H                                                  0112
*LOOP1:                             /*                       @Y30OEAC*/
*       FEEDREAD=OFF;               /* NO FEED REQUEST       @Y30OE95*/
LOOP1    NI    FEEDREAD(AMWRKPTR),B'11111011'                      0112
*       CALL RDLABTRK;              /* READ THE LABEL TRACK  @Y30OE95*/
         BAL   @14,RDLABTRK                                        0113
*       IF ERTNCDE=GOODRTN          /* NO ERRORS ?           @Y30OE95*/
*         THEN                      /*                       @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0114
         BNE   @RF00114                                            0114
*         DO;                       /*                       @Y30OE95*/
*           CALL VOL1LABL;          /* PROCESS VOL1 LABEL    @Y30OE95*/
         BAL   @14,VOL1LABL                                        0116
*           IF ERTNCDE=GOODRTN      /* NO ERRORS ?           @Y30OE95*/
*             THEN                  /*                       @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0117
         BNE   @RF00117                                            0117
*             DO;                   /*                       @Y30OE95*/
*               AMWVOLAC=VOLACCIN;  /* PUT VOL ACC IND DEB   @Y30OEAC*/
         MVC   AMWVOLAC(1,AMWRKPTR),VOLACCIN(VOL1PTR)              0119
*               IF AMWVOLAC^=BLANK  /* ACCESS CODE REQUIRED? @Y30OEAC*/
*                 THEN              /*                       @Y30OE95*/
         CLI   AMWVOLAC(AMWRKPTR),C' '                             0120
         BE    @RF00120                                            0120
*                 IF AMWVAMSG=OFF   /* MESSAGE NOT ISSUED    @Y30OEAC*/
*                   THEN            /* FOR THIS VOLUME ?     @Y30OE95*/
         TM    AMWVAMSG(AMWRKPTR),B'00100000'                      0121
         BNZ   @RF00121                                            0121
*                   IF SDKTDSID^=BLNKDSID/* NON-BLANK DSID ? @Y30OEAC*/
*                     THEN          /*                       @Y30OEAC*/
         CLC   SDKTDSID(8,SETDSKPT),BLNKDSID                       0122
         BE    @RF00122                                            0122
*                     DO;           /* ISSUE SECURE VOL MSG  @Y30OEAC*/
*                       AMWVAMSG=ON;/* SET MSG ISSUED IND    @Y30OEAC*/
         OI    AMWVAMSG(AMWRKPTR),B'00100000'                      0124
*                       SECVOL=ON;  /* SET VOL SECURITY IND  @Y30OEAC*/
         OI    SECVOL(AMWRKPTR),B'00100000'                        0125
*                       CALL SECRPROC;/* SECURITY PROCESSING @Y30OEAC*/
         BAL   @14,SECRPROC                                        0126
*                     END;          /*                       @Y30OEAC*/
*               IF ERTNCDE=GOODRTN  /* NO ERRORS ?           @Y30OEAC*/
*                 THEN              /*                       @Y30OEAC*/
@RF00122 DS    0H                                                  0128
@RF00121 DS    0H                                                  0128
@RF00120 CLI   ERTNCDE(SETDSKPT),X'00'                             0128
         BNE   @RF00128                                            0128
*                 DO;               /*                       @Y30OEAC*/
*                   AMWVSEQU=ZERO;  /* ZERO DEB VOL SEQ NUM  @Y30OEAC*/
         MVI   AMWVSEQU(AMWRKPTR),X'00'                            0130
*                   CALL HDR1LABL;  /* PROCESS HDR1 LABEL    @Y30OE95*/
         BAL   @14,HDR1LABL                                        0131
*                   IF ERTNCDE=GOODRTN/* NO ERRORS ?         @Y30OE95*/
*                     THEN          /*                       @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0132
         BNE   @RF00132                                            0132
*                     DO;           /*                       @Y30OE95*/
*                       HDR1PTR=HDR1SAV;/* SET POINTER TO HDR1     0134
*                                                            @Y30OE95*/
         L     HDR1PTR,HDR1SAV(,AMWRKPTR)                          0134
*                       IF(HDRVOLSQ>=CHAR01&/* VOL SEQ NUMBER      0135
*                                                            @Y30OEAC*/
*                           HDRVOLSQ<=CHAR99&/* BETWEEN 01   @ZA04456*/
*                           HDRVOLSQ(2)>=NUMBER0&/* AND      @ZA04456*/
*                           HDRVOLSQ(2)<=NUMBER9)×/* 99 ?    @ZA04483*/
*                           (HDRMVLI=LASTVOL&/* LAST VOL IND AND   0135
*                                                            @Y30OEAC*/
*                           HDRVOLSQ=BLNKVLSQ)/* BLNK VOL SEQ ?    0135
*                                                            @Y30OEAC*/
*                         THEN      /*                       @Y30OE95*/
         CLC   HDRVOLSQ(2,HDR1PTR),CHAR01                          0135
         BL    @GL00001                                            0135
         CLC   HDRVOLSQ(2,HDR1PTR),CHAR99                          0135
         BH    @GL00001                                            0135
         CLI   HDRVOLSQ+1(HDR1PTR),C'0'                            0135
         BL    @GL00001                                            0135
         CLI   HDRVOLSQ+1(HDR1PTR),C'9'                            0135
         BNH   @RT00135                                            0135
@GL00001 CLI   HDRMVLI(HDR1PTR),C'L'                               0135
         BNE   @RF00135                                            0135
         CLC   HDRVOLSQ(2,HDR1PTR),BLNKVLSQ                        0135
         BNE   @RF00135                                            0135
@RT00135 DS    0H                                                  0136
*                         IF HDRVOLSQ^=CHAR01/* VOL SEQ NUMBER     0136
*                                                            @Y30OEAC*/
*                           THEN    /* NOT EQUAL TO 01 ?     @Y30OEAC*/
         CLC   HDRVOLSQ(2,HDR1PTR),CHAR01                          0136
         BE    @RF00136                                            0136
*                           DO;     /*                       @Y30OEAC*/
*                             CALL SEQERR;/* ISSUE SEQ ERROR MSG   0138
*                                                            @Y30OEAC*/
         BAL   @14,SEQERR                                          0138
*                             IF ERTNCDE^=OPERCNCL/* JOB NOT @Y30OEAC*/
*                               THEN/* CANCELED BY OPERATOR? @Y30OEAC*/
         CLI   ERTNCDE(SETDSKPT),X'18'                             0139
         BNE   @RT00139                                            0139
*                               GOTO LOOP1;/* RETRY          @Y30OEAC*/
*                           END;    /*                       @Y30OEAC*/
*                         ELSE      /* VOL SEQ NUM = 01      @Y30OEAC*/
*                           IF HDRMVLI=LASTVOL/* LAST VOL IND ?    0142
*                                                            @Y30OEAC*/
*                             THEN  /*                       @Y30OEAC*/
         B     @RC00136                                            0142
@RF00136 CLI   HDRMVLI(HDR1PTR),C'L'                               0142
         BNE   @RF00142                                            0142
*                             ERTNCDE=BADHDR1;/* BAD HDR1 RTN CD   0143
*                                                            @Y30OEAC*/
         MVI   ERTNCDE(SETDSKPT),X'0C'                             0143
*                       CALL VALIDHDR;/* CHECK FOR VALID HDR1      0144
*                                                            @Y30OE95*/
@RF00142 DS    0H                                                  0144
@RC00136 DS    0H                                                  0144
@RF00135 BAL   @14,VALIDHDR                                        0144
*                       IF ERTNCDE=GOODRTN/* NO ERRORS ?     @Y30OE95*/
*                         THEN      /*                       @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0145
         BNE   @RF00145                                            0145
*                         DO;       /*                       @Y30OE95*/
*                           AMWDSSQL=HDRSECIN;/* DS SEC IN DEB     0147
*                                                            @Y30OEAC*/
         MVC   AMWDSSQL(1,AMWRKPTR),HDRSECIN(HDR1PTR)              0147
*                           IF AMWDSOPN=OFF&/* DS NOT OPEN ? @Y30OEAC*/
*                               VOLACCIN^=BLANK&/* VOL ACC IND?    0148
*                                                            @Y30OE95*/
*                               HDRSECIN^=BLANK/* HDR1 SEC IND ?   0148
*                                                            @Y30OE95*/
*                             THEN  /*                       @Y30OE95*/
         TM    AMWDSOPN(AMWRKPTR),B'01000000'                      0148
         BNZ   @RF00148                                            0148
         CLI   VOLACCIN(VOL1PTR),C' '                              0148
         BE    @RF00148                                            0148
         CLI   HDRSECIN(HDR1PTR),C' '                              0148
         BE    @RF00148                                            0148
*                             DO;   /* ISSUE SECURE DS MSG   @Y30OE95*/
*                               SECVOL=OFF;/* SET SECUR VOL IND    0150
*                                                            @Y30OEAC*/
         NI    SECVOL(AMWRKPTR),B'11011111'                        0150
*                               CALL SECRPROC;/* SECUR PROCESS     0151
*                                                            @Y30OEAC*/
         BAL   @14,SECRPROC                                        0151
*                             END;  /*                       @Y30OE95*/
*                           IF ERTNCDE=GOODRTN/* NO ERRORS ? @Y30OEAC*/
*                             THEN  /*                       @Y30OEAC*/
@RF00148 CLI   ERTNCDE(SETDSKPT),X'00'                             0153
         BNE   @RF00153                                            0153
*                             DO;   /*                       @Y30OEAC*/
*                               CALL DEBIOB;/* UPDATE DEB/IOB      0155
*                                                            @Y30OE95*/
         BAL   @14,DEBIOB                                          0155
*                               CALL PRIMEBFR;/* PRIME BUFFER      0156
*                                                            @Y30OE95*/
         BAL   @14,PRIMEBFR                                        0156
*                               ACBLRECL=CONVERT1;/* PUT REC LEN   0157
*                                                            @Y30OE95
*                                      IN AM WORK AREA       @Y30OEAC*/
         MVC   ACBLRECL(2,AMWRKPTR),CONVERT1(AMWRKPTR)             0157
*                               AMWDSOPN=ON;/* SET DEB DS OPEN     0158
*                                                            @Y30OEAC
*                                      FLAG                  @Y30OEAC*/
         OI    AMWDSOPN(AMWRKPTR),B'01000000'                      0158
*                             END;  /*                       @Y30OEAC*/
*                         END;      /*                       @Y30OE95*/
*                       ELSE        /* ERRORS ENCOUNTERED    @Y30OEAC*/
*                         IF ERTNCDE=BADHDR1/* BAD HDR1 RTN CD ?   0161
*                                                            @Y30OEAC*/
*                           THEN    /*                       @Y30OEAC*/
         B     @RC00145                                            0161
@RF00145 CLI   ERTNCDE(SETDSKPT),X'0C'                             0161
         BNE   @RF00161                                            0161
*                           CALL MSGSBRTN;/* ISSUE HDR1 ERROR MSG  0162
*                                                            @Y30OEAC*/
         BAL   @14,MSGSBRTN                                        0162
*                     END;          /*                       @Y30OE95*/
*                 END;              /*                       @Y30OEAC*/
*             END;                  /*                       @Y30OE95*/
*         END;                      /*                       @Y30OE95*/
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                             0167
*     END OPENDS;                   /* END OF SUBCASE                */
*/* @Y30OEAC                                                         */
*                                                                  0169
*                                                                  0169
*     /***************************************************************/
*     /*                                                             */
*     /* END OF VOLUME                                       @Y30OEAC*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0169
*EOV:                                                              0169
*     DO;                           /* SUBCASE               @Y30OEAC*/
EOV      DS    0H                                                  0170
*       CALL PURGEIOB;              /* PURGE/RESTORE IOB'S   @Y30OEAC*/
         BAL   @14,PURGEIOB                                        0170
*       FEEDREAD=ON;                /* FEED AND READ REQUEST @Y30OEAC*/
*       RETRY=OFF;                  /* INITIALIZE RETRY FLAG @Y30OE95*/
         OI    FEEDREAD(AMWRKPTR),B'00000100'                      0172
         NI    RETRY(AMWRKPTR),B'10111111'                         0172
*LOOP:                              /*                       @Y30OE95*/
*       CALL RDLABTRK;              /* READ THE LABEL TRACK  @Y30OE95*/
LOOP     BAL   @14,RDLABTRK                                        0173
*       FEEDREAD=OFF;               /* NO FEED REQUEST       @Y30OE95*/
         NI    FEEDREAD(AMWRKPTR),B'11111011'                      0174
*       IF ERTNCDE=GOODRTN          /* NO ERRORS ?           @Y30OE95*/
*         THEN                      /*                       @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0175
         BNE   @RF00175                                            0175
*         DO;                       /*                       @Y30OE95*/
*           CALL VOL1LABL;          /* PROCESS VOL1 LABEL    @Y30OE95*/
         BAL   @14,VOL1LABL                                        0177
*           IF ERTNCDE=GOODRTN      /* NO ERRORS ?           @Y30OE95*/
*             THEN                  /*                       @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0178
         BNE   @RF00178                                            0178
*             DO;                   /*                       @Y30OE95*/
*               CALL HDR1LABL;      /* PROCESS HDR1 LABELS   @Y30OE95*/
         BAL   @14,HDR1LABL                                        0180
*               IF ERTNCDE=GOODRTN  /* NO ERRORS ?           @Y30OE95*/
*                 THEN              /*                       @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'00'                             0181
         BNE   @RF00181                                            0181
*                 DO;               /*                       @Y30OE95*/
*                   HDR1PTR=HDR1SAV;/* GET PTR TO RIGHT HDR1 @Y30OE95*/
         L     HDR1PTR,HDR1SAV(,AMWRKPTR)                          0183
*                   IF(HDRVOLSQ>=CHAR01&/* VOL SEQUENCE NUMBER     0184
*                                                            @Y30OEAC*/
*                       HDRVOLSQ<=CHAR99&/* BETWEEN 01 AND 99      0184
*                                                            @Y30OEAC*/
*                       HDRVOLSQ(2)>=NUMBER0&/* INCLUSIVE ?  @ZA04456*/
*                       HDRVOLSQ(2)<=NUMBER9)×/*             @ZA04483*/
*                       HDRVOLSQ=BLNKVLSQ/* OR IS IT BLANK ? @Y30OE95*/
*                     THEN          /*                       @Y30OEAC*/
         CLC   HDRVOLSQ(2,HDR1PTR),CHAR01                          0184
         BL    @GL00008                                            0184
         CLC   HDRVOLSQ(2,HDR1PTR),CHAR99                          0184
         BH    @GL00008                                            0184
         CLI   HDRVOLSQ+1(HDR1PTR),C'0'                            0184
         BL    @GL00008                                            0184
         CLI   HDRVOLSQ+1(HDR1PTR),C'9'                            0184
         BNH   @RT00184                                            0184
@GL00008 CLC   HDRVOLSQ(2,HDR1PTR),BLNKVLSQ                        0184
         BNE   @RF00184                                            0184
@RT00184 DS    0H                                                  0185
*                     IF AMWVSEQU^=ZERO/* PREVIOUS VOL SEQ NUM?    0185
*                                                            @Y30OEAC*/
*                       THEN        /*                       @Y30OE95*/
         CLI   AMWVSEQU(AMWRKPTR),0                                0185
         BE    @RF00185                                            0185
*                       DO;         /*                       @Y30OE95*/
*                         PACK(TEMP1,HDRVOLSQ);/* PACK VLSQ NUM    0187
*                                                            @Y30OE95*/
         PACK  TEMP1(2,AMWRKPTR),HDRVOLSQ(2,HDR1PTR)               0187
*                         TEMP1(2)=TEMP1(2)&NUMBER0;/* ZERO LOW    0188
*                                                            @Y30OEAC
*                                      ORDER BITS            @Y30OEAC*/
         NI    TEMP1+1(AMWRKPTR),C'0'                              0188
*                         TEMP1(2)=TEMP1(2)×PLUSSIGN;/* MAKE +     0189
*                                                            @Y30OEAC*/
         OI    TEMP1+1(AMWRKPTR),X'0C'                             0189
*                         CVB(TEMP2,TEMP1);/* CONVERT TO BINARY    0190
*                                                            @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0190
         MVC   @TS00001+6(2),TEMP1(AMWRKPTR)                       0190
         CVB   @11,@TS00001                                        0190
         STH   @11,TEMP2(,AMWRKPTR)                                0190
*                         IF TEMP2^=AMWVSEQU+ONE/* VOLSEQ NUM ^=   0191
*                                                            @Y30OEAC*/
*                           THEN    /* OLD VOLSEQ NUM + 1 ?  @Y30OE95*/
         LA    @03,1                                               0191
         SLR   @15,@15                                             0191
         IC    @15,AMWVSEQU(,AMWRKPTR)                             0191
         ALR   @03,@15                                             0191
         CR    @11,@03                                             0191
         BE    @RF00191                                            0191
*                           RETRY=ON;/* INDICATE RETRY       @Y30OE95*/
         OI    RETRY(AMWRKPTR),B'01000000'                         0192
*                       END;        /*                       @Y30OE95*/
*                 END;              /*                       @Y30OE95*/
*               ELSE                /* ERRORS ENCOUNTERED    @Y30OE95*/
*                 IF ERTNCDE=DSNOTFND/* DATA SET NOT FOUND ? @Y30OE95*/
*                   THEN            /*                       @Y30OE95*/
         B     @RC00181                                            0195
@RF00181 CLI   ERTNCDE(SETDSKPT),X'04'                             0195
         BNE   @RF00195                                            0195
*                   RETRY=ON;       /* INDICATE RETRY        @Y30OE95*/
         OI    RETRY(AMWRKPTR),B'01000000'                         0196
*             END;                  /*                       @Y30OE95*/
@RF00195 DS    0H                                                  0197
@RC00181 DS    0H                                                  0198
*         END;                      /*                       @Y30OE95*/
@RF00178 DS    0H                                                  0199
*       IF RETRY=ON                 /* RETRY INDICATED ?     @Y30OE95*/
*         THEN                      /*                       @Y30OE95*/
@RF00175 TM    RETRY(AMWRKPTR),B'01000000'                         0199
         BNO   @RF00199                                            0199
*         DO;                       /*                       @Y30OE95*/
*           CALL SEQERR;            /* SEQUENCE ERROR MSG    @Y30OE95*/
         BAL   @14,SEQERR                                          0201
*           IF ERTNCDE^=OPERCNCL    /* JOB NOT CANCELED ?    @Y30OE95*/
*             THEN                  /*                       @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'18'                             0202
         BNE   @RT00202                                            0202
*             GOTO LOOP;            /* RETRY                 @Y30OE95*/
*         END;                      /*                       @Y30OE95*/
*       IF ERTNCDE=GOODRTN          /* NO ERRORS ?           @Y30OE95*/
*         THEN                      /*                       @Y30OE95*/
@RF00199 CLI   ERTNCDE(SETDSKPT),X'00'                             0205
         BNE   @RF00205                                            0205
*         DO;                       /*                       @Y30OE95*/
*           CALL VALIDHDR;          /* CHECK FOR VALID HDR1  @Y30OE95*/
         BAL   @14,VALIDHDR                                        0207
*           IF^(HDRMVLI=LASTVOL×    /* MULTIVOLUME IND NOT   @Y30OEAC*/
*               HDRMVLI=CONTVOL)    /* 'L' (LAST) OR         @Y30OEAC*/
*             THEN                  /* 'C' (CONTINUED) ?     @Y30OEAC*/
         CLI   HDRMVLI(HDR1PTR),C'L'                               0208
         BE    @RF00208                                            0208
         CLI   HDRMVLI(HDR1PTR),C'C'                               0208
         BE    @RF00208                                            0208
*             ERTNCDE=BADHDR1;      /* SET BAD HDR1 RTN CD   @Y30OEAC*/
         MVI   ERTNCDE(SETDSKPT),X'0C'                             0209
*           IF ERTNCDE=GOODRTN      /* NO ERRORS ?           @Y30OE95*/
*             THEN                  /*                       @Y30OE95*/
@RF00208 CLI   ERTNCDE(SETDSKPT),X'00'                             0210
         BNE   @RF00210                                            0210
*             IF AMWVOLAC=VOLACCIN  /* VOL ACCESS INDICATOR  @Y30OEAC*/
*               THEN                /* SAME AS PREV VOLUME ? @Y30OE95*/
         CLC   AMWVOLAC(1,AMWRKPTR),VOLACCIN(VOL1PTR)              0211
         BNE   @RF00211                                            0211
*               IF AMWDSSQL=HDRSECIN/* DS SECURITY INDICATOR @Y30OEAC*/
*                 THEN              /* SAME AS PREV DS ?     @Y30OE95*/
         CLC   AMWDSSQL(1,AMWRKPTR),HDRSECIN(HDR1PTR)              0212
         BNE   @RF00212                                            0212
*                 IF ACBLRECL=CONVERT1/* SS RECL THE SAME ?  @Y30OE95*/
*                   THEN            /*                       @Y30OE95*/
         CLC   ACBLRECL(2,AMWRKPTR),CONVERT1(AMWRKPTR)             0213
         BNE   @RF00213                                            0213
*                   DO;             /*                       @Y30OE95*/
*                     CALL DEBIOB;  /* UPDATE THE DEB/IOB    @Y30OE95*/
         BAL   @14,DEBIOB                                          0215
*                     CALL PRIMEBFR;/* PRIME THE BUFFER      @Y30OE95*/
         BAL   @14,PRIMEBFR                                        0216
*                   END;            /*                       @Y30OE95*/
*                 ELSE              /* SS RECL NOT THE SAME  @Y30OE95*/
*                   ERTNCDE=BADHDR1;/* SET BAD HDR1 RTN CODE @Y30OE95*/
         B     @RC00213                                            0218
@RF00213 MVI   ERTNCDE(SETDSKPT),X'0C'                             0218
*               ELSE                /* SECURITY IND NOT SAME @Y30OE95*/
*                 ERTNCDE=BADHDR1;  /* SET BAD HDR1 RTN CODE @Y30OE95*/
         B     @RC00212                                            0219
@RF00212 MVI   ERTNCDE(SETDSKPT),X'0C'                             0219
*             ELSE                  /* ACCESS IND NOT SAME   @Y30OE95*/
*               ERTNCDE=BADVOL1;    /* SET BAD VOL1 RTN CODE @Y30OEAC*/
         B     @RC00211                                            0220
@RF00211 MVI   ERTNCDE(SETDSKPT),X'08'                             0220
*           IF ERTNCDE^=GOODRTN     /* BAD HDR1 OR VOL1 ?    @Y30OEAC*/
*             THEN                  /*                       @Y30OE95*/
@RC00211 DS    0H                                                  0221
@RF00210 CLI   ERTNCDE(SETDSKPT),X'00'                             0221
         BE    @RF00221                                            0221
*             CALL MSGSBRTN;        /* ISSUE HDR1/VOL1 ERROR @Y30OEAC*/
         BAL   @14,MSGSBRTN                                        0222
*         END;                      /* MESSAGE               @Y30OEAC*/
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                             0224
*     END EOV;                      /* END OF SUBCASE                */
*/* @Y30OEAC                                                         */
*                                                                  0226
*                                                                  0226
*     /***************************************************************/
*     /*                                                             */
*     /* FEED A DISKETTE                                     @Y30OEAC*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0226
*FEED:                                                             0226
*     DO;                           /* SUBCASE               @Y30OEAC*/
FEED     DS    0H                                                  0227
*       FEEDREAD=OFF;               /* NO FEED REQUEST       @Y30OE95*/
         NI    FEEDREAD(AMWRKPTR),B'11111011'                      0227
*       IF UCBVLSER^=ENDDSKT        /* VOLSER IN UCB NOT     @Y30OE95*/
*         THEN                      /* END-OF-DSKT ?         @Y30OE95*/
         L     @11,UCBPTR                                          0228
         L     @11,UCBXTADR(,@11)                                  0228
         CLC   UCBVLSER(6,@11),ENDDSKT                             0228
         BE    @RF00228                                            0228
*         FEEDREAD=ON;              /* FEED AND READ REQUEST @Y30OEAC*/
         OI    FEEDREAD(AMWRKPTR),B'00000100'                      0229
*       CALL RDLABTRK;              /* READ THE LABEL TRACK  @Y30OE95*/
@RF00228 BAL   @14,RDLABTRK                                        0230
*       IF ERTNCDE^=IOERROR         /* NO PERM I/O ERRORS ?  @Y30OE95*/
*         THEN                      /*                       @Y30OE95*/
         CLI   ERTNCDE(SETDSKPT),X'10'                             0231
         BE    @RF00231                                            0231
*         CALL VOL1LABL;            /* CHECK FOR VALID VOL1  @Y30OE95*/
         BAL   @14,VOL1LABL                                        0232
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                             0233
*     END FEED;                     /* END OF SUBCASE                */
*/* @Y30OEAC                                                         */
*                                                                  0235
*                                                                  0235
*     /***************************************************************/
*     /*                                                             */
*     /* CLOSE DATA SET                                      @Y30OEAC*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0235
*CLOSEDS:                                                          0235
*     DO;                           /* SUBCASE               @Y30OEAC*/
CLOSEDS  DS    0H                                                  0236
*       CALL PURGEIOB;              /* PURGE/RESTORE IOB'S   @Y30OEAC*/
*                                                                  0236
         BAL   @14,PURGEIOB                                        0236
*       /*************************************************************/
*       /*                                                           */
*       /* RESET DEB INDICATORS FOR NEXT DATA SET            @Y30OEAC*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0237
*       AMWVOLAC=BLANK;             /* BLANK VOL ACCESS IND  @Y30OEAC*/
         MVI   AMWVOLAC(AMWRKPTR),C' '                             0237
*       AMWDSSQL=BLANK;             /* BLANK DS SEC IND      @Y30OEAC*/
         MVI   AMWDSSQL(AMWRKPTR),C' '                             0238
*       AMWVSEQU=ZERO;              /* ZERO VOLSEQ NUMBER    @Y30OEAC*/
         MVI   AMWVSEQU(AMWRKPTR),X'00'                            0239
*       AMWDSOPN=OFF;               /* SET DSOPEN FLAG       @Y30OEAC*/
*       AMWMULTI=OFF;               /* SET MULTI VOLUME IND  @Y30OEAC*/
         NI    AMWDSOPN(AMWRKPTR),B'00111111'                      0241
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */
         B     CE0001@                                             0242
*     END CLOSEDS;                  /* END OF SUBCASE                */
*/* @Y30OEAC                                                         */
*                                                                  0244
*CE0001@:                                                          0244
*   END SETDIN;                     /* END OF CASE           @Y30OEAC*/
*RDLABTRK:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
@EL00001 L     @13,4(,@13)                                         0245
@EF00001 L     @00,@SIZDATD                                        0245
         LR    @01,@08                                             0245
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0245
         BR    @14                                                 0245
RDLABTRK ST    @14,@SA00002                                        0245
*/********************************************************** @Y30OE95*/
*/*                                                          @Y30OE95*/
*/*  THIS SUBROUTINE READS IN THE LABEL TRACK (TRACK 0) OF A @Y30OE95*/
*/*  DISKETTE. IT MAY ALSO CAUSE ANOTHER DISKETTE TO BE FED  @Y30OE95*/
*/*  INTO THE READER. UPON ENTRY, THE 'FEEDREAD' BIT OF THE  @Y30OE95*/
*/*  WORKAREA IS TURNED OFF IF ONLY A READ IS WANTED OR      @Y30OE95*/
*/*  TURNED ON IF A FEED AND READ IS WANTED.                 @Y30OE95*/
*/*                                                          @Y30OE95*/
*/********************************************************** @Y30OE95*/
*                                                                  0246
*   DCBIFEC=OFF;                    /* SET ERROR CORRECT IND @Y30OEAC*/
         L     @11,DCBPTR                                          0246
         NI    DCBIFEC+40(@11),B'00111111'                         0246
*   IF^(VOLLABID=VOL1&              /* LABID ^= 'VOL1' ?     @Y30OE95*/
*       VOLID=UCBVLSER&             /* VOLID ^= UCBVOLID ?   @Y30OE95*/
*       FEEDREAD=OFF)×              /* FEED-READ REQUEST ?   @Y30OE95*/
*       SDKTDSID=BLNKDSID           /* DSID NOT SPECIFIED ?  @Y30OE95*/
*     THEN                          /*                       @Y30OE95*/
         CLC   VOLLABID(4,VOL1PTR),VOL1                            0247
         BNE   @RT00247                                            0247
         L     @11,UCBPTR                                          0247
         L     @11,UCBXTADR(,@11)                                  0247
         CLC   VOLID(6,VOL1PTR),UCBVLSER(@11)                      0247
         BNE   @RT00247                                            0247
         TM    FEEDREAD(AMWRKPTR),B'00000100'                      0247
         BNZ   @RT00247                                            0247
         CLC   SDKTDSID(8,SETDSKPT),BLNKDSID                       0247
         BNE   @RF00247                                            0247
@RT00247 DS    0H                                                  0248
*     DO;                           /*                       @Y30OE95*/
*       CHANPGM(1)=CCWDFOP1;        /* CHANGE 1ST NOOP TO A  @Y30OEAC
*                                      DFN OPS CCW           @Y30OEAC*/
         MVC   CHANPGM(8,CHNPGMPT),CCWDFOP1                        0249
*       IOBSKADR=''B;               /* CLEAR IOB SEEK ADDR   @Y30OEAC*/
         XC    IOBSKADR(4,IOBSTPTR),IOBSKADR(IOBSTPTR)             0250
*       IOBSKSS=VOL1SECT;           /* POINT TO VOL1 LABEL   @Y30OEAC*/
         MVI   IOBSKSS(IOBSTPTR),X'07'                             0251
*       DO I=3 TO 22;               /* CHANGE BYTE COUNTS OF @Y30OEAC*/
         LA    @11,3                                               0252
         ST    @11,I(,AMWRKPTR)                                    0252
@DL00252 DS    0H                                                  0253
*         CHANPGM(I,7:8)=BYTCNT80;  /* READ CCW'S TO 80      @Y30OEAC*/
         L     @11,I(,AMWRKPTR)                                    0253
         SLA   @11,3                                               0253
         LH    @03,BYTCNT80                                        0253
         BCTR  @11,0                                               0253
         BCTR  @11,0                                               0253
         STH   @03,CHANPGM(@11,CHNPGMPT)                           0253
*       END;                        /*                       @Y30OE95*/
         LA    @11,1                                               0254
         AL    @11,I(,AMWRKPTR)                                    0254
         ST    @11,I(,AMWRKPTR)                                    0254
         CH    @11,@CH01998                                        0254
         BNH   @DL00252                                            0254
*       CCW21SAV=CHANPGM(23);       /* SAVE 21ST READ CCW    @Y30OE95*/
         MVC   CCW21SAV(8,AMWRKPTR),CHANPGM+176(CHNPGMPT)          0255
*       CHANPGM(23)=CCWDFOP2;       /* CHANGE 21ST READ      @Y30OEAC
*                                      CCW TO A DFN OPS CCW  @Y30OEAC*/
         MVC   CHANPGM+176(8,CHNPGMPT),CCWDFOP2                    0256
*       IF FEEDREAD=ON              /* FEED-READ REQUEST ?   @Y30OEAC*/
*         THEN                      /*                       @Y30OE95*/
         TM    FEEDREAD(AMWRKPTR),B'00000100'                      0257
         BNO   @RF00257                                            0257
*         DO;                       /*                       @Y30OE95*/
*           AMWVAMSG=OFF;           /* INDICATE NEW VOLUME   @Y30OEAC*/
         NI    AMWVAMSG(AMWRKPTR),B'11011111'                      0259
*           VOLSERID=''B;           /* VOL-SER OF ZEROS      @Y30OEAC*/
         XC    VOLSERID(6,AMWRKPTR),VOLSERID(AMWRKPTR)             0260
*           VOLUPDTE=ON;            /* SET VOL-SER UPDTE IND @Y30OEAC*/
         OI    VOLUPDTE(AMWRKPTR),B'00000010'                      0261
*           CALL UCBUPDTE;          /* UPDATE UCBVLSER       @Y30OEAC*/
         BAL   @14,UCBUPDTE                                        0262
*           CCW26SAV=CHANPGM(28);   /* SAVE 26TH READ CCW    @Y30OE95*/
         MVC   CCW26SAV(8,AMWRKPTR),CHANPGM+216(CHNPGMPT)          0263
*           CHANPGM(28,1)=FEEDCCW;  /* CHANGE 26TH READ CCW  @Y30OE95
*                                      TO A FEED CCW         @Y30OE95*/
         MVI   CHANPGM+216(CHNPGMPT),X'17'                         0264
*           CHANPGM(28,5)=COMCHAIN; /* CHAIN CCW'S           @Y30OEAC*/
         MVI   CHANPGM+220(CHNPGMPT),X'60'                         0265
*           CHANPGM(29,1:4)=ADDR(CHANPGM(1));/* ADDR OF 1ST  @Y30OE95
*                                      NOOP IN END NOOP      @Y30OE95*/
         ST    CHNPGMPT,CHANPGM+224(,CHNPGMPT)                     0266
*           CHANPGM(29,1)=TICCCW;   /* TIC CCW COMMAND CODE  @Y30OE95*/
         MVI   CHANPGM+224(CHNPGMPT),X'08'                         0267
*           IOBSTRTB=ADDR(CHANPGM(28));/* CHANGE CHAN PGM    @Y30OE95
*                                      PTR IN IOB            @Y30OE95*/
         LA    @11,CHANPGM+216(,CHNPGMPT)                          0268
         STCM  @11,7,IOBSTRTB(IOBSTPTR)                            0268
*         END;                      /*                       @Y30OE95*/
*       CALL IOSBRTN;               /* CALL I/O SUBROUTINE   @Y30OE95*/
@RF00257 BAL   @14,IOSBRTN                                         0270
*       IF FEEDREAD=ON              /* FEED-READ REQUEST ?   @Y30OEAC*/
*         THEN                      /*                       @Y30OE95*/
         TM    FEEDREAD(AMWRKPTR),B'00000100'                      0271
         BNO   @RF00271                                            0271
*         DO;                       /*                       @Y30OE95*/
*           CHANPGM(28)=CCW26SAV;   /* RESTORE 26TH READ CCW @Y30OE95*/
         MVC   CHANPGM+216(8,CHNPGMPT),CCW26SAV(AMWRKPTR)          0273
*           CHANPGM(29)=CCWNOOP;    /* RESTORE END NOOP CCW  @Y30OEAC*/
         MVC   CHANPGM+224(8,CHNPGMPT),CCWNOOP                     0274
*           IOBSTRTB=ADDR(CHANPGM(1));/* RSTRE CHAN PGM PTR  @Y30OE95*/
         STCM  CHNPGMPT,7,IOBSTRTB(IOBSTPTR)                       0275
*         END;                      /*                       @Y30OE95*/
*       CHANPGM(23)=CCW21SAV;       /* RESTORE 21ST READ CCW @Y30OE95*/
@RF00271 MVC   CHANPGM+176(8,CHNPGMPT),CCW21SAV(AMWRKPTR)          0277
*       CHANPGM(1)=CCWNOOP;         /* RESTORE 1ST NOOP CCW  @Y30OEAC*/
         MVC   CHANPGM(8,CHNPGMPT),CCWNOOP                         0278
*       CHANPGM(1,5)=COMCHAIN;      /* AND SET CHAIN FLAG    @Y30OEAC*/
         MVI   CHANPGM+4(CHNPGMPT),X'60'                           0279
*       IF ECBCC^=GOODIO            /* I/O ERRORS ?          @Y30OE95*/
*         THEN                      /*                       @Y30OE95*/
         ICM   @11,7,IOBECBPB(IOBSTPTR)                            0280
         CLI   ECBCC(@11),127                                      0280
         BE    @RF00280                                            0280
*         DO;                       /*                       @Y30OE95*/
*           ERTNCDE=IOERROR;        /* SET I/O ERROR RTN CD  @Y30OE95*/
         MVI   ERTNCDE(SETDSKPT),X'10'                             0282
*           VOLLABID=BLNKVLID;      /* BLANK VOL1 LABEL ID   @Y30OEAC*/
         MVC   VOLLABID(4,VOL1PTR),BLNKVLID                        0283
*         END;                      /*                       @Y30OE95*/
*     END;                          /*                       @Y30OE95*/
*   END RDLABTRK;                   /*                       @Y30OE95*/
@EL00002 DS    0H                                                  0286
@EF00002 DS    0H                                                  0286
@ER00002 L     @14,@SA00002                                        0286
         BR    @14                                                 0286
*VOL1LABL:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
VOL1LABL ST    @14,@SA00003                                        0287
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OE95*/
*/* THIS SUBROUTINE VALIDITY CHECKS THE VOL1 LABEL           @Y30OE95*/
*/*                                                          @Y30OE95*/
*/********************************************************** @Y30OEAC*/
*                                                                  0288
*   GOODVOL1=OFF;                   /* SET GOOD VOL1 IND     @Y30OE95*/
         NI    GOODVOL1(AMWRKPTR),B'11111110'                      0288
*   IF VOLLABID=VOL1                /* LABEL ID 'VOL1' ?     @Y30OE95*/
*     THEN                          /*                       @Y30OE95*/
         CLC   VOLLABID(4,VOL1PTR),VOL1                            0289
         BNE   @RF00289                                            0289
*     DO;                           /*                       @Y30OE95*/
*       BLANKCHR=OFF;               /* SET BLANK CHAR IND    @Y30OE95*/
*       BADVOLID=OFF;               /* SET BAD VOLID IND     @Y30OE95*/
         NI    BLANKCHR(AMWRKPTR),B'00111111'                      0292
*       RFY                         /*                       @Y30OEAC*/
*         CHARPTR RSTD;             /* RESTRICT CHARPTR      @Y30OEAC*/
*       CHARPTR=ADDR(VOLID);        /* PTR TO VOLUME SERIAL  @Y30OE95*/
         LA    CHARPTR,VOLID(,VOL1PTR)                             0294
*       IF VOLID(1)=BLANK           /* IF 1ST CHAR IS A      @Y30OE6D*/
*         THEN                      /* BLANK, THEN SET       @Y30OE6D*/
         CLI   VOLID(VOL1PTR),C' '                                 0295
         BNE   @RF00295                                            0295
*         BADVOLID=ON;              /* THE BAD VOLID IND ON  @Y30OE6D*/
         OI    BADVOLID(AMWRKPTR),B'01000000'                      0296
*       ELSE                        /*                       @Y30OE6D*/
*         DO I=1 TO 6 WHILE         /* SET LOOP FOR 6 CHARS  #Y30OEAC*/
*               BADVOLID=OFF;       /* TIL BAD ID IS FOUND   #Y30OE95*/
         B     @RC00295                                            0297
@RF00295 LA    @03,1                                               0297
         ST    @03,I(,AMWRKPTR)                                    0297
@DL00297 TM    BADVOLID(AMWRKPTR),B'01000000'                      0297
         BNZ   @DC00297                                            0297
*           IF^(CHARACTR>=CHARA&    /* VOLUME SERIAL CONSIST #Y30OEAC*/
*               CHARACTR<=CHARI×    /* OF CHARACTERS OTHER   #Y30OEAC*/
*               CHARACTR>=CHARJ&    /* THAN A-Z ?            #Y30OEAC*/
*               CHARACTR<=CHARR×    /*                       #Y30OEAC*/
*               CHARACTR>=CHARS&    /*                       #Y30OEAC*/
*               CHARACTR<=CHARZ×    /*                       @Y30OEAC*/
*               CHARACTR>=NUMBER0&  /* OR 0-9 ?              @Y30OE95*/
*               CHARACTR<=NUMBER9)  /*                       @Y30OE95*/
*             THEN                  /*                       @Y30OE95*/
         CLI   CHARACTR(CHARPTR),C'A'                              0298
         BL    @GL00018                                            0298
         CLI   CHARACTR(CHARPTR),C'I'                              0298
         BNH   @RF00298                                            0298
@GL00018 CLI   CHARACTR(CHARPTR),C'J'                              0298
         BL    @GL00017                                            0298
         CLI   CHARACTR(CHARPTR),C'R'                              0298
         BNH   @RF00298                                            0298
@GL00017 CLI   CHARACTR(CHARPTR),C'S'                              0298
         BL    @GL00016                                            0298
         CLI   CHARACTR(CHARPTR),C'Z'                              0298
         BNH   @RF00298                                            0298
@GL00016 CLI   CHARACTR(CHARPTR),C'0'                              0298
         BL    @RT00298                                            0298
         CLI   CHARACTR(CHARPTR),C'9'                              0298
         BNH   @RF00298                                            0298
@RT00298 DS    0H                                                  0299
*             IF CHARACTR=BLANK     /* BLANK CHARACTER ?     @Y30OE95*/
*               THEN                /*                       @Y30OE95*/
         CLI   CHARACTR(CHARPTR),C' '                              0299
         BNE   @RF00299                                            0299
*               BLANKCHR=ON;        /* SET BLANK CHAR IND    @Y30OE95*/
         OI    BLANKCHR(AMWRKPTR),B'10000000'                      0300
*             ELSE                  /* NOT A-Z, 0-9, OR BLNK @Y30OE95*/
*               BADVOLID=ON;        /* SET BAD VOL1 IND      @Y30OE95*/
         B     @RC00299                                            0301
@RF00299 OI    BADVOLID(AMWRKPTR),B'01000000'                      0301
*           ELSE                    /* A-Z OR 0-9            @Y30OE95*/
*             IF BLANKCHR=ON        /* PREVIOUS CHAR BLANK ? @Y30OE95*/
*               THEN                /*                       @Y30OE95*/
         B     @RC00298                                            0302
@RF00298 TM    BLANKCHR(AMWRKPTR),B'10000000'                      0302
         BNO   @RF00302                                            0302
*               BADVOLID=ON;        /* SET BAD VOL1 IND      @Y30OE95*/
         OI    BADVOLID(AMWRKPTR),B'01000000'                      0303
*           CHARPTR=CHARPTR+ONE;    /* POINT TO NEXT CHAR    @Y30OE95*/
@RF00302 DS    0H                                                  0304
@RC00298 AH    CHARPTR,@CH00050                                    0304
*         END;                      /*                       @Y30OE95*/
         LA    @03,1                                               0305
         AL    @03,I(,AMWRKPTR)                                    0305
         ST    @03,I(,AMWRKPTR)                                    0305
         CH    @03,@CH00422                                        0305
         BNH   @DL00297                                            0305
@DC00297 DS    0H                                                  0306
*       RFY                         /*                       @Y30OEAC*/
*         CHARPTR UNRSTD;           /* RELEASE CHARPTR       @Y30OEAC*/
@RC00295 DS    0H                                                  0307
*       IF BADVOLID=OFF             /* GOOD VOLUME SERIAL ?  @Y30OE95*/
*         THEN                      /*                       @Y30OE95*/
         TM    BADVOLID(AMWRKPTR),B'01000000'                      0307
         BNZ   @RF00307                                            0307
*         IF VOLLABVR=LBLVERS       /* LBL VERSION SPEC ?    @Y30OEAC*/
*           THEN                    /*                       @Y30OE95*/
         CLI   VOLLABVR(VOL1PTR),C'W'                              0308
         BNE   @RF00308                                            0308
*           DO;                     /*                       @Y30OE95*/
*             VOLSERID=VOLID;       /* GET VOLUME SERIAL     @Y30OEAC*/
         MVC   VOLSERID(6,AMWRKPTR),VOLID(VOL1PTR)                 0310
*             GOODVOL1=ON;          /* SET GOOD VOL1 IND     @Y30OE95*/
         OI    GOODVOL1(AMWRKPTR),B'00000001'                      0311
*           END;                    /*                       @Y30OE95*/
*     END;                          /*                       @Y30OE95*/
@RF00308 DS    0H                                                  0313
@RF00307 DS    0H                                                  0314
*   IF GOODVOL1=OFF                 /* BAD VOL1 LABEL ?      @Y30OE95*/
*     THEN                          /*                       @Y30OE95*/
@RF00289 TM    GOODVOL1(AMWRKPTR),B'00000001'                      0314
         BNZ   @RF00314                                            0314
*     IF VOLID^=ENDDSKT             /* NOT DELIMITER DSKT ?  @Y30OE95*/
*       THEN                        /*                       @Y30OE95*/
         CLC   VOLID(6,VOL1PTR),ENDDSKT                            0315
         BE    @RF00315                                            0315
*       DO;                         /*                       @Y30OE95*/
*         VOLSERID=''B;             /* VOL-SER OF ZEROS      @Y30OEAC*/
         XC    VOLSERID(6,AMWRKPTR),VOLSERID(AMWRKPTR)             0317
*         ERTNCDE=BADVOL1;          /* SET BAD VOL1 RTN CD   @Y30OEAC*/
         MVI   ERTNCDE(SETDSKPT),X'08'                             0318
*         CALL MSGSBRTN;            /* ISSUE VOL1 ERROR MSG  @Y30OEAC*/
         BAL   @14,MSGSBRTN                                        0319
*       END;                        /*                       @Y30OE95*/
*     ELSE                          /* DELIMITER DISKETTE    @Y30OE95*/
*       DO;                         /*                       @Y30OE95*/
         B     @RC00315                                            0321
@RF00315 DS    0H                                                  0322
*         VOLSERID=ENDDSKT;         /* DLM DSKT VOL-SER      @Y30OEAC*/
         MVC   VOLSERID(6,AMWRKPTR),ENDDSKT                        0322
*         ERTNCDE=ENDDSKCD;         /* SET END DSKT RTN CD   @Y30OE95*/
         MVI   ERTNCDE(SETDSKPT),X'14'                             0323
*         VOLLABID=BLNKVLID;        /* BLANK OUT VOL LABL ID @Y30OEAC*/
         MVC   VOLLABID(4,VOL1PTR),BLNKVLID                        0324
*       END;                        /*                       @Y30OE95*/
*   VOLUPDTE=ON;                    /* SET VOL-SER UPDTE IND @Y30OEAC*/
@RC00315 DS    0H                                                  0326
@RF00314 OI    VOLUPDTE(AMWRKPTR),B'00000010'                      0326
*   CALL UCBUPDTE;                  /* UPDATE UCBVLSER       @Y30OEAC*/
         BAL   @14,UCBUPDTE                                        0327
*   END VOL1LABL;                   /*                       @Y30OE95*/
@EL00003 DS    0H                                                  0328
@EF00003 DS    0H                                                  0328
@ER00003 L     @14,@SA00003                                        0328
         BR    @14                                                 0328
*HDR1LABL:                          /*                       @Y30OE95*/
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OEAC*/
HDR1LABL DS    0H                                                  0330
*/********************************************************** @Y30OE95*/
*/*                                                          @Y30OE95*/
*/* THIS SUBROUTINE WILL CHECK IF THE DATA SET IS LOCATED ON @Y30OE95*/
*/* THIS DISKETTE AND MAKE SURE THERE IS NOT MORE THAN ONE   @Y30OE95*/
*/* DATA SET WITH THE SAME NAME. IT WILL ALSO CHECK IF THIS  @Y30OE95*/
*/* IS A BLANK DISKETTE.                                     @Y30OE95*/
*/*                                                          @Y30OE95*/
*/********************************************************** @Y30OE95*/
*                                                                  0330
*   RFY                             /*                       @Y30OEAC*/
*     REG14 RSTD;                   /* RESTRICT REGISTER     @Y30OEAC*/
*   OVERLAP=OFF;                    /* SET OVERLAP IND       @Y30OE95*/
*   DSETFND=OFF;                    /* SET DATA SET FND IND  @Y30OE95*/
*   DUPDSID=OFF;                    /* SET DUPLICAT DSID IND @Y30OE95*/
*   BLNKDSKT=ON;                    /* SET BLANK DSKT IND    @Y30OEAC*/
*   ONLYDSET=ON;                    /* SET ONLY DATA SET IND @Y30OEAC*/
         OI    BLNKDSKT(AMWRKPTR),B'00000110'                      0335
         NI    OVERLAP(AMWRKPTR),B'11000111'                       0335
*   IF SDKTDSID^=BLNKDSID           /* DSID SPECIFIED ?      @Y30OEAC*/
*     THEN                          /*                       @Y30OE95*/
         CLC   SDKTDSID(8,SETDSKPT),BLNKDSID                       0336
         BE    @RF00336                                            0336
*     DO;                           /*                       @Y30OE95*/
*       DO I=4 TO 22;               /* SET LOOP FOR 2ND-20TH @Y30OEAC
*                                      READ CCW'S            @Y30OE95*/
         LA    @15,4                                               0338
         ST    @15,I(,AMWRKPTR)                                    0338
@DL00338 DS    0H                                                  0339
*         HDR1PTR=CHANPGM(I,2:4);   /* GET PTR TO HDR1       @Y30OEAC*/
         L     @15,I(,AMWRKPTR)                                    0339
         SLA   @15,3                                               0339
         AL    @15,@CF02069                                        0339
         L     HDR1PTR,CHANPGM(@15,CHNPGMPT)                       0339
         LA    HDR1PTR,0(,HDR1PTR)                                 0339
*         IF HDRID(1)^=DLTDSIND     /* NOT A DELETED DS ?    @Y30OEAC*/
*           THEN                    /*                       @Y30OEAC*/
         CLI   HDRID(HDR1PTR),C'D'                                 0340
         BE    @RF00340                                            0340
*           DO;                     /*                       @Y30OEAC*/
*             IF HDRDSID=SDKTDSID   /* CORRECT DATA SET ?    @Y30OEAC*/
*               THEN                /*                       @Y30OEAC*/
         CLC   HDRDSID(8,HDR1PTR),SDKTDSID(SETDSKPT)               0342
         BNE   @RF00342                                            0342
*               IF DSETFND=OFF      /* DATA SET NOT FOUND ?  @Y30OEAC*/
*                 THEN              /*                       @Y30OEAC*/
         TM    DSETFND(AMWRKPTR),B'00010000'                       0343
         BNZ   @RF00343                                            0343
*                 DO;               /*                       @Y30OEAC*/
*                   BLNKDSKT=OFF;   /* SET BLANK DSKT IND    @Y30OEAC*/
*                   DSETFND=ON;     /* SET DS FOUND IND      @Y30OEAC*/
         OI    DSETFND(AMWRKPTR),B'00010000'                       0346
         NI    BLNKDSKT(AMWRKPTR),B'11111011'                      0346
*                   HDR1SAV=HDR1PTR;/* SAVE THIS HDR1        @Y30OEAC*/
         ST    HDR1PTR,HDR1SAV(,AMWRKPTR)                          0347
*                 END;              /*                       @Y30OEAC*/
*               ELSE                /* DUPLICATE DSID FOUND  @Y30OEAC*/
*                 DUPDSID=ON;       /* SET DUPLICAT DSID IND @Y30OEAC*/
         B     @RC00343                                            0349
@RF00343 OI    DUPDSID(AMWRKPTR),B'00001000'                       0349
*             ELSE                  /* INCORRECT DATA SET    @Y30OEAC*/
*               DO;                 /*                       @Y30OEAC*/
         B     @RC00342                                            0350
@RF00342 DS    0H                                                  0351
*                 ONLYDSET=OFF;     /* IND MORE THAN ONE DS  @Y30OEAC*/
*                 BLNKDSKT=OFF;     /* SET BLANK DSKT IND    @Y30OEAC*/
         NI    ONLYDSET(AMWRKPTR),B'11111001'                      0352
*               END;                /*                       @Y30OEAC*/
*           END;                    /*                       @Y30OEAC*/
@RC00342 DS    0H                                                  0355
*       END;                        /*                       @Y30OE95*/
@RF00340 LA    @15,1                                               0355
         AL    @15,I(,AMWRKPTR)                                    0355
         ST    @15,I(,AMWRKPTR)                                    0355
         CH    @15,@CH01998                                        0355
         BNH   @DL00338                                            0355
*       IF DSETFND=OFF              /* DATA NOT SET FOUND ?  @Y30OE95*/
*         THEN                      /*                       @Y30OE95*/
         TM    DSETFND(AMWRKPTR),B'00010000'                       0356
         BNZ   @RF00356                                            0356
*         DO;                       /*                       @Y30OE95*/
*           VOLLABID=BLNKVLID;      /* BLANK OUT 'VOL1'      @Y30OEAC*/
         MVC   VOLLABID(4,VOL1PTR),BLNKVLID                        0358
*           IF BLNKDSKT=ON          /* BLANK DISKETTE ?      @Y30OEAC*/
*             THEN                  /*                       @Y30OE95*/
         TM    BLNKDSKT(AMWRKPTR),B'00000100'                      0359
         BNO   @RF00359                                            0359
*             SETRETCD=BLANKDSK;    /* SET BLANK DSKT RTN CD @Y30OE95*/
         MVC   SETRETCD(2,SETDSKPT),BLANKDSK                       0360
*           ELSE                    /* NOT A BLANK DISKETTE  @Y30OE95*/
*             ERTNCDE=DSNOTFND;     /* SET DS NOT FND RTN CD @Y30OE95*/
         B     @RC00359                                            0361
@RF00359 MVI   ERTNCDE(SETDSKPT),X'04'                             0361
*         END;                      /*                       @Y30OE95*/
*       ELSE                        /* DATA SET FOUND        @Y30OEAC*/
*         IF ONLYDSET=ON            /* ONE DS ON DSKT ?      @Y30OEAC*/
*           THEN                    /*                       @Y30OEAC*/
         B     @RC00356                                            0363
@RF00356 TM    ONLYDSET(AMWRKPTR),B'00000010'                      0363
         BNO   @RF00363                                            0363
*           ERTNCDQL=ONLYDS;        /* SET RTN CDE QUALIFIER @Y30OEAC*/
         MVI   ERTNCDQL(SETDSKPT),X'04'                            0364
*     END;                          /*                       @Y30OE95*/
*   ELSE                            /* DSID NOT SPECIFIED    @Y30OE95*/
*     ERTNCDE=DSNOTFND;             /* SET DS NOT FND RTN CD @Y30OEAC*/
         B     @RC00336                                            0366
@RF00336 MVI   ERTNCDE(SETDSKPT),X'04'                             0366
*   RFY                             /*                       @Y30OEAC*/
*     REG14 UNRSTD;                 /* RELEASE REGISTER      @Y30OEAC*/
*   END HDR1LABL;                   /*                       @Y30OE95*/
@EL00004 DS    0H                                                  0368
@EF00004 DS    0H                                                  0368
@ER00004 BR    @14                                                 0368
*VALIDHDR:                          /*                       @Y30OE95*/
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OEAC*/
VALIDHDR DS    0H                                                  0370
*/********************************************************** @Y30OE95*/
*/*                                                          @Y30OE95*/
*/* THIS SUBROUTINE VALIDITY CHECKS THE HDR1 LABEL.          @Y30OE95*/
*/*                                                          @Y30OE95*/
*/********************************************************** @Y30OE95*/
*                                                                  0370
*   RFY                             /*                       @Y30OEAC*/
*     REG14 RSTD;                   /* RESTRICT REGISTER     @Y30OEAC*/
*   BLANKCHR=ON;                    /* SET BLANK CHAR IND    @Y30OEAC*/
         OI    BLANKCHR(AMWRKPTR),B'10000000'                      0371
*   EXTNUM=OFF;                     /* SET NUMB IND OFF      @ZA00799*/
         NI    EXTNUM,B'01111111'                                  0372
*   BADBLKLN=OFF;                   /* SET INVAL BLK LEN IND @Y30OEAC*/
*   GOODHDR1=OFF;                   /* SET GOOD HDR1 IND     @Y30OE95*/
         NI    BADBLKLN(AMWRKPTR),B'01110111'                      0374
*   HDR1PTR=HDR1SAV;                /* PTR TO CORRECT HDR1   @Y30OE95*/
         L     HDR1PTR,HDR1SAV(,AMWRKPTR)                          0375
*   IF HDRID=HDR1&                  /* HDRID='HDR1' AND ANY  @Y30OE95*/
*       DUPDSID=OFF&                /* DUPL DATASET ID'S ?   @Y30OE95*/
*       (HDRMVLI=BLANK×             /* AND MULTIVOLUME IND   @Y30OE95*/
*       HDRMVLI=CONTVOL×            /* BLANK,'C'(CONT),OR    @Y30OEAC*/
*       HDRMVLI=LASTVOL)            /* 'L'(LAST) ?           @Y30OEAC*/
*     THEN                          /*                       @Y30OEAC*/
         CLC   HDRID(4,HDR1PTR),HDR1                               0376
         BNE   @RF00376                                            0376
         TM    DUPDSID(AMWRKPTR),B'00001000'                       0376
         BNZ   @RF00376                                            0376
         CLI   HDRMVLI(HDR1PTR),C' '                               0376
         BE    @RT00376                                            0376
         CLI   HDRMVLI(HDR1PTR),C'C'                               0376
         BE    @RT00376                                            0376
         CLI   HDRMVLI(HDR1PTR),C'L'                               0376
         BNE   @RF00376                                            0376
@RT00376 DS    0H                                                  0377
*     DO;                           /*                       @ZA00799*/
*       RFY                         /*                       @ZA00799*/
*         CHARPTR RSTD;             /* RESTRICT REGISTER     @ZA00799*/
*       CHARPTR=ADDR(HDRBOE);       /* GET BOE START ADDR    @ZA00799*/
         LA    CHARPTR,HDRBOE(,HDR1PTR)                            0379
*       DO I=1 TO 5 WHILE EXTNUM=OFF;/* SET LOOP CNT         @ZA00799*/
         LA    @15,1                                               0380
         ST    @15,I(,AMWRKPTR)                                    0380
@DL00380 TM    EXTNUM,B'10000000'                                  0380
         BNZ   @DC00380                                            0380
*         IF(BOECHAR>=NUMBER0&      /* BOE >= TO ZERO        @ZA00799*/
*             BOECHAR<=NUMBER9&     /* BOE <= TO NINE        @ZA00799*/
*             EOECHAR>=NUMBER0&     /* EOE >= TO ZERO        @ZA00799*/
*             EOECHAR<=NUMBER9&     /* EOE <= TO NINE        @ZA00799*/
*             EODCHAR>=NUMBER0&     /* EOD >= TO ZERO        @ZA00799*/
*             EODCHAR<=NUMBER9)     /* EOD <= TO NINE        @ZA00799*/
*           THEN                    /* YES                   @ZA00799*/
         CLI   BOECHAR(CHARPTR),C'0'                               0381
         BL    @RF00381                                            0381
         CLI   BOECHAR(CHARPTR),C'9'                               0381
         BH    @RF00381                                            0381
         LA    @15,6                                               0381
         ALR   @15,CHARPTR                                         0381
         CLI   EOECHAR(@15),C'0'                                   0381
         BL    @RF00381                                            0381
         CLI   EOECHAR(@15),C'9'                                   0381
         BH    @RF00381                                            0381
         LA    @15,46                                              0381
         ALR   @15,CHARPTR                                         0381
         CLI   EODCHAR(@15),C'0'                                   0381
         BL    @RF00381                                            0381
         CLI   EODCHAR(@15),C'9'                                   0381
         BH    @RF00381                                            0381
*           CHARPTR=CHARPTR+ONE;    /* POINT TO NEXT CHAR    @ZA00799*/
         AH    CHARPTR,@CH00050                                    0382
*         ELSE                      /*                       @ZA00799*/
*           EXTNUM=ON;              /* IND NON-NUMERIC       @ZA00799*/
         B     @RC00381                                            0383
@RF00381 OI    EXTNUM,B'10000000'                                  0383
*       END;                        /*                       @ZA00799*/
@RC00381 LA    @15,1                                               0384
         AL    @15,I(,AMWRKPTR)                                    0384
         ST    @15,I(,AMWRKPTR)                                    0384
         CH    @15,@CH00155                                        0384
         BNH   @DL00380                                            0384
@DC00380 DS    0H                                                  0385
*       IF(HDRBOECC>=CHAR01&        /* BOE TRK NUM >= 1 ?    @Y30OEAC*/
*           HDRBOECC<RSRVTRK&       /* BOE TRK NUM < 74 ?    @Y30OEAC*/
*           HDRBOEH=NUMBER0&        /* BOEH = 0 ?            @Y30OEAC*/
*           HDRBOERR>=CHAR01&       /* BOE SECTOR NUM >= 1 ? @Y30OEAC*/
*           HDRBOERR<=LASTSECT&     /* BOE SECTOR NUM <= 26? @Y30OEAC*/
*           HDREOECC>=CHAR01&       /* EOE TRK NUM >= 1 ?    @Y30OEAC*/
*           HDREOECC<RSRVTRK&       /* EOE TRK NUM < 74 ?    @Y30OEAC*/
*           HDREOEH=NUMBER0&        /* EOEH = 0 ?            @Y30OEAC*/
*           HDREOERR>=CHAR01&       /* EOE SECTOR NUM >= 1 ? @Y30OEAC*/
*           HDREOERR<=LASTSECT&     /* EOE SECTOR NUM <= 26? @Y30OEAC*/
*           HDREODCC>=CHAR01&       /* EOD TRK NUM >= 1 ?    @Y30OEAC*/
*           HDREODCC<=RSRVTRK&      /* EOD TRK NUM <= 74 ?   @Y30OEAC*/
*           HDREODH=NUMBER0&        /* EODH = 0 ?            @Y30OEAC*/
*           HDREODRR>=CHAR01&       /* EOD SECTOR NUM >= 1 ? @Y30OEAC*/
*           HDREODRR<=LASTSECT&     /* EOD SECTOR NUM <= 74? @ZA00799*/
*           EXTNUM=OFF)             /* NON-NUMERIC CHAR ?    @ZA00799*/
*         THEN                      /*                       @Y30OEAC*/
         CLC   HDRBOECC(2,HDR1PTR),CHAR01                          0385
         BL    @RF00385                                            0385
         CLC   HDRBOECC(2,HDR1PTR),RSRVTRK                         0385
         BNL   @RF00385                                            0385
         CLI   HDRBOEH(HDR1PTR),C'0'                               0385
         BNE   @RF00385                                            0385
         CLC   HDRBOERR(2,HDR1PTR),CHAR01                          0385
         BL    @RF00385                                            0385
         CLC   HDRBOERR(2,HDR1PTR),LASTSECT                        0385
         BH    @RF00385                                            0385
         CLC   HDREOECC(2,HDR1PTR),CHAR01                          0385
         BL    @RF00385                                            0385
         CLC   HDREOECC(2,HDR1PTR),RSRVTRK                         0385
         BNL   @RF00385                                            0385
         CLI   HDREOEH(HDR1PTR),C'0'                               0385
         BNE   @RF00385                                            0385
         CLC   HDREOERR(2,HDR1PTR),CHAR01                          0385
         BL    @RF00385                                            0385
         CLC   HDREOERR(2,HDR1PTR),LASTSECT                        0385
         BH    @RF00385                                            0385
         CLC   HDREODCC(2,HDR1PTR),CHAR01                          0385
         BL    @RF00385                                            0385
         CLC   HDREODCC(2,HDR1PTR),RSRVTRK                         0385
         BH    @RF00385                                            0385
         CLI   HDREODH(HDR1PTR),C'0'                               0385
         BNE   @RF00385                                            0385
         CLC   HDREODRR(2,HDR1PTR),CHAR01                          0385
         BL    @RF00385                                            0385
         CLC   HDREODRR(2,HDR1PTR),LASTSECT                        0385
         BH    @RF00385                                            0385
         TM    EXTNUM,B'10000000'                                  0385
         BNZ   @RF00385                                            0385
*         IF(^(HDREODCC=RSRVTRK&    /* EOD TRK NUM = 74 AND  @Y30OEAC*/
*             HDREODRR>CHAR01))&    /* EOD SECTOR NUM > 1 ?  @Y30OEAC*/
*             (HDRBOE<=HDREOE&      /* BOE <= TO EOE AND     @Y30OE95*/
*             HDRBOE<=HDREOD)       /* BOE <= TO EOD ?       @Y30OE95*/
*           THEN                    /*                       @Y30OE95*/
         CLC   HDREODCC(2,HDR1PTR),RSRVTRK                         0386
         BNE   @GL00047                                            0386
         CLC   HDREODRR(2,HDR1PTR),CHAR01                          0386
         BH    @RF00386                                            0386
@GL00047 CLC   HDRBOE(5,HDR1PTR),HDREOE(HDR1PTR)                   0386
         BH    @RF00386                                            0386
         CLC   HDRBOE(5,HDR1PTR),HDREOD(HDR1PTR)                   0386
         BH    @RF00386                                            0386
*           DO;                     /*                       @Y30OE95*/
*             SAVEEOE=HDREOE;       /* SAVE END OF EXTENT    @Y30OE95*/
         MVC   SAVEEOE(5,AMWRKPTR),HDREOE(HDR1PTR)                 0388
*             IF EOERR<LASTSECT     /* EOE SECTOR NUM < 26 ? @Y30OEAC*/
*               THEN                /*                       @Y30OE95*/
         CLC   EOERR(2,AMWRKPTR),LASTSECT                          0389
         BNL   @RF00389                                            0389
*               DO;                 /*                       @Y30OE95*/
*                 PACK(TEMP1,EOERR);/* PACK EOE SECTOR NUM   @Y30OE95*/
         PACK  TEMP1(2,AMWRKPTR),EOERR(2,AMWRKPTR)                 0391
*                 CVB(TEMP2,TEMP1); /* CONVERT IT TO BINARY  @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0392
         MVC   @TS00001+6(2),TEMP1(AMWRKPTR)                       0392
         CVB   @15,@TS00001                                        0392
         STH   @15,TEMP2(,AMWRKPTR)                                0392
*                 TEMP2=TEMP2+ONE;  /* ADD ONE TO IT         @Y30OE95*/
         AH    @15,@CH00050                                        0393
         STH   @15,TEMP2(,AMWRKPTR)                                0393
*                 CVD(TEMP2,TEMP1); /* CONVERT IT BACK       @Y30OE95*/
         CVD   @15,@TS00001                                        0394
         MVC   TEMP1(2,AMWRKPTR),@TS00001+6                        0394
*                 UNPK(EOERR,TEMP1);/* UNPACK IT             @Y30OE95*/
         UNPK  EOERR(2,AMWRKPTR),TEMP1(2,AMWRKPTR)                 0395
*                 EOERR(2)=EOERR(2)×NUMBER0;/* RESTORE SIGN  @Y30OEAC*/
         OI    EOERR+1(AMWRKPTR),C'0'                              0396
*               END;                /*                       @Y30OE95*/
*             ELSE                  /* EOE SECTOR NUM = 26   @Y30OE95*/
*               DO;                 /*                       @Y30OE95*/
         B     @RC00389                                            0398
@RF00389 DS    0H                                                  0399
*                 EOERR=CHAR01;     /* SET EOE SECTOR NUM= 1 @Y30OEAC*/
         MVC   EOERR(2,AMWRKPTR),CHAR01                            0399
*                 PACK(TEMP1,EOECC);/* PACK EOE TRK NUM      @Y30OE95*/
         PACK  TEMP1(2,AMWRKPTR),EOECC(2,AMWRKPTR)                 0400
*                 CVB(TEMP2,TEMP1); /* CONVERT IT TO BINARY  @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0401
         MVC   @TS00001+6(2),TEMP1(AMWRKPTR)                       0401
         CVB   @15,@TS00001                                        0401
         STH   @15,TEMP2(,AMWRKPTR)                                0401
*                 TEMP2=TEMP2+ONE;  /* ADD ONE TO IT         @Y30OE95*/
         AH    @15,@CH00050                                        0402
         STH   @15,TEMP2(,AMWRKPTR)                                0402
*                 CVD(TEMP2,TEMP1); /* CONVERT IT BACK       @Y30OE95*/
         CVD   @15,@TS00001                                        0403
         MVC   TEMP1(2,AMWRKPTR),@TS00001+6                        0403
*                 UNPK(EOECC,TEMP1);/* UNPACK IT             @Y30OE95*/
         UNPK  EOECC(2,AMWRKPTR),TEMP1(2,AMWRKPTR)                 0404
*                 EOECC(2)=EOECC(2)×NUMBER0;/* RESTORE SIGN  @Y30OE95*/
         OI    EOECC+1(AMWRKPTR),C'0'                              0405
*               END;                /*                       @Y30OE95*/
*             IF HDREOD<=SAVEEOE    /* EOD <= EOE ?          @Y30OE95*/
*               THEN                /*                       @Y30OE95*/
@RC00389 CLC   HDREOD(5,HDR1PTR),SAVEEOE(AMWRKPTR)                 0407
         BH    @RF00407                                            0407
*               IF HDRVOLSQ=BLNKVLSQ×/* VOL SEQ NUM BLANK ?  @Y30OEAC*/
*                   (HDRVOLSQ>=CHAR01&/* OR BETWEEN 01 AND 99      0408
*                                                            @Y30OEAC*/
*                   HDRVOLSQ<=CHAR99&/* INCLUSIVE ?          @Y30OEAC*/
*                   HDRVOLSQ(2)>=NUMBER0&/*                  @ZA04456*/
*                   HDRVOLSQ(2)<=NUMBER9)/*                  @ZA04483*/
*                 THEN              /*                       @Y30OE95*/
         CLC   HDRVOLSQ(2,HDR1PTR),BLNKVLSQ                        0408
         BE    @RT00408                                            0408
         CLC   HDRVOLSQ(2,HDR1PTR),CHAR01                          0408
         BL    @RF00408                                            0408
         CLC   HDRVOLSQ(2,HDR1PTR),CHAR99                          0408
         BH    @RF00408                                            0408
         CLI   HDRVOLSQ+1(HDR1PTR),C'0'                            0408
         BL    @RF00408                                            0408
         CLI   HDRVOLSQ+1(HDR1PTR),C'9'                            0408
         BH    @RF00408                                            0408
@RT00408 DS    0H                                                  0409
*                 DO;               /*                       @Y30OE95*/
*                   SAVEBOE=HDRBOE; /* SAVE BOE              @Y30OE95*/
         MVC   SAVEBOE(5,AMWRKPTR),HDRBOE(HDR1PTR)                 0410
*                   SAVEEOE=HDREOE; /* SAVE EOE              @Y30OE95*/
         MVC   SAVEEOE(5,AMWRKPTR),HDREOE(HDR1PTR)                 0411
*                   SAVEEOD=HDREOD; /* SAVE EOD              @Y30OE95*/
         MVC   SAVEEOD(5,AMWRKPTR),HDREOD(HDR1PTR)                 0412
*                   DO I=4 TO 22 WHILE OVERLAP=OFF;/*        @Y30OEAC*/
         LA    @15,4                                               0413
         ST    @15,I(,AMWRKPTR)                                    0413
@DL00413 TM    OVERLAP(AMWRKPTR),B'00100000'                       0413
         BNZ   @DC00413                                            0413
*                     HDR1PTR=CHANPGM(I,2:4);/* HDR1 PTR     @Y30OEAC*/
         L     @15,I(,AMWRKPTR)                                    0414
         SLA   @15,3                                               0414
         AL    @15,@CF02069                                        0414
         L     HDR1PTR,CHANPGM(@15,CHNPGMPT)                       0414
         LA    HDR1PTR,0(,HDR1PTR)                                 0414
*                     IF HDR1PTR^=HDR1SAV/* NEXT HDR1 ?      @Y30OE95*/
*                       THEN        /*                       @Y30OE95*/
         CL    HDR1PTR,HDR1SAV(,AMWRKPTR)                          0415
         BE    @RF00415                                            0415
*                       IF HDRID(1)^=DLTDSIND/* NOT A DELETED      0416
*                                                            @Y30OE95*/
*                         THEN      /* DATA SET ?            @Y30OE95*/
         CLI   HDRID(HDR1PTR),C'D'                                 0416
         BE    @RF00416                                            0416
*                         IF(HDRBOE>=SAVEBOE&/* OVERLAPPING  @Y30OE95*/
*                             HDRBOE<=SAVEEOE)×/* EXTENTS ?  @Y30OE95*/
*                             (HDREOE>=SAVEBOE&/*            @Y30OE95*/
*                             HDREOE<=SAVEEOE)/*             @Y30OE95*/
*                           THEN    /*                       @Y30OE95*/
         CLC   HDRBOE(5,HDR1PTR),SAVEBOE(AMWRKPTR)                 0417
         BL    @GL00054                                            0417
         CLC   HDRBOE(5,HDR1PTR),SAVEEOE(AMWRKPTR)                 0417
         BNH   @RT00417                                            0417
@GL00054 CLC   HDREOE(5,HDR1PTR),SAVEBOE(AMWRKPTR)                 0417
         BL    @RF00417                                            0417
         CLC   HDREOE(5,HDR1PTR),SAVEEOE(AMWRKPTR)                 0417
         BH    @RF00417                                            0417
@RT00417 DS    0H                                                  0418
*                           OVERLAP=ON;/* SET OVERLAP IND    @Y30OE95*/
         OI    OVERLAP(AMWRKPTR),B'00100000'                       0418
*                   END;            /*                       @Y30OE95*/
@RF00417 DS    0H                                                  0419
@RF00416 DS    0H                                                  0419
@RF00415 LA    @15,1                                               0419
         AL    @15,I(,AMWRKPTR)                                    0419
         ST    @15,I(,AMWRKPTR)                                    0419
         CH    @15,@CH01998                                        0419
         BNH   @DL00413                                            0419
@DC00413 DS    0H                                                  0420
*                   HDR1PTR=HDR1SAV;/* GET ORIGINAL HDR1 PTR @Y30OE95*/
         L     HDR1PTR,HDR1SAV(,AMWRKPTR)                          0420
*                   DO I=1 TO 5 WHILE BLANKCHR=ON;/*         @Y30OEAC*/
         LA    @15,1                                               0421
         ST    @15,I(,AMWRKPTR)                                    0421
@DL00421 TM    BLANKCHR(AMWRKPTR),B'10000000'                      0421
         BNO   @DC00421                                            0421
*                     IF HDRBLKLN(I)^=BLANK/* NO MORE LEADING      0422
*                                                            @Y30OEAC*/
*                       THEN        /* BLANKS ?              @Y30OEAC*/
         L     @15,I(,AMWRKPTR)                                    0422
         ALR   @15,HDR1PTR                                         0422
         CLI   HDRBLKLN-1(@15),C' '                                0422
         BE    @RF00422                                            0422
*                       DO J=I TO 5;/*                       @Y30OEAC*/
         L     @15,I(,AMWRKPTR)                                    0423
         B     @DE00423                                            0423
@DL00423 DS    0H                                                  0424
*                         BLANKCHR=OFF;/* SET BLNK CHAR IND  @Y30OEAC*/
         NI    BLANKCHR(AMWRKPTR),B'01111111'                      0424
*                         IF HDRBLKLN(J)<NUMBER0×/* INVALID BLK    0425
*                                                            @Y30OEAC*/
*                             HDRBLKLN(J)>NUMBER9/* LENGTH ? @Y30OEAC*/
*                           THEN    /*                       @Y30OEAC*/
         L     @15,J(,AMWRKPTR)                                    0425
         ALR   @15,HDR1PTR                                         0425
         CLI   HDRBLKLN-1(@15),C'0'                                0425
         BL    @RT00425                                            0425
         L     @15,J(,AMWRKPTR)                                    0425
         ALR   @15,HDR1PTR                                         0425
         CLI   HDRBLKLN-1(@15),C'9'                                0425
         BNH   @RF00425                                            0425
@RT00425 DS    0H                                                  0426
*                           BADBLKLN=ON;/* SET INVAL BLK LEN IND   0426
*                                                            @Y30OEAC*/
         OI    BADBLKLN(AMWRKPTR),B'00001000'                      0426
*                       END;        /*                       @Y30OEAC*/
@RF00425 LA    @15,1                                               0427
         AL    @15,J(,AMWRKPTR)                                    0427
@DE00423 ST    @15,J(,AMWRKPTR)                                    0427
         CH    @15,@CH00155                                        0427
         BNH   @DL00423                                            0427
*                   END;            /*                       @Y30OEAC*/
@RF00422 LA    @15,1                                               0428
         AL    @15,I(,AMWRKPTR)                                    0428
         ST    @15,I(,AMWRKPTR)                                    0428
         CH    @15,@CH00155                                        0428
         BNH   @DL00421                                            0428
@DC00421 DS    0H                                                  0429
*                   IF OVERLAP=OFF& /* NO OVERLAPPING EXTS ? @Y30OEAC*/
*                       BLANKCHR=OFF&/* BLOCK LEN GIVEN ?    @Y30OEAC*/
*                       BADBLKLN=OFF/* VALID BLOCK LENGTH ?  @Y30OEAC*/
*                     THEN          /*                       @Y30OEAC*/
         TM    OVERLAP(AMWRKPTR),B'10100000'                       0429
         BNZ   @RF00429                                            0429
         TM    BADBLKLN(AMWRKPTR),B'00001000'                      0429
         BNZ   @RF00429                                            0429
*                     DO;           /*                       @Y30OEAC*/
*                       PACK(CONVERT,HDRBLKLN);/* PACK REC LEN     0431
*                                                            @Y30OEAC*/
         PACK  CONVERT(4,AMWRKPTR),HDRBLKLN(5,HDR1PTR)             0431
*                       CVB(CONVERT1,CONVERT);/* CONV'T TO BIN     0432
*                                                            @Y30OEAC*/
         XC    @TS00001(8),@TS00001                                0432
         MVC   @TS00001+4(4),CONVERT(AMWRKPTR)                     0432
         CVB   @15,@TS00001                                        0432
         STH   @15,CONVERT1(,AMWRKPTR)                             0432
*                       IF(CONVERT1>CLEAR&/* BLOCK LENGTH > 0      0433
*                                                            @Y30OEAC*/
*                           CONVERT1<=MAXRECL)&/* AND <= 128 ?     0433
*                                                            @Y30OEAC*/
*                           HDRINTCH=BLANK&/* BLNK INTRCHG LVL ?   0433
*                                                            @Y30OEAC*/
*                           (HDRBYPAS=BYPASIND×/* BYPASS IND ON    0433
*                                                            @Y30OEAC*/
*                           HDRBYPAS=BLANK)/* OR BLANK ?     @Y30OEAC*/
*                         THEN      /*                       @Y30OEAC*/
         SLR   @03,@03                                             0433
         ICM   @03,3,CLEAR                                         0433
         CR    @15,@03                                             0433
         BNH   @RF00433                                            0433
         CH    @15,MAXRECL                                         0433
         BH    @RF00433                                            0433
         CLI   HDRINTCH(HDR1PTR),C' '                              0433
         BNE   @RF00433                                            0433
         CLI   HDRBYPAS(HDR1PTR),C'B'                              0433
         BE    @RT00433                                            0433
         CLI   HDRBYPAS(HDR1PTR),C' '                              0433
         BNE   @RF00433                                            0433
@RT00433 DS    0H                                                  0434
*                         IF(SDKTVFYI=ON&/* BOTH VERIFY IND  @Y30OEAC*/
*                             HDRVERFY=VFYIND)×/* ON OR      @Y30OEAC*/
*                             SDKTVFYI=OFF/* SETDISKT VFY IND      0434
*                                                            @Y30OEAC*/
*                           THEN    /* NOT SPECIFIED ?       @Y30OEAC*/
         TM    SDKTVFYI(SETDSKPT),B'10000000'                      0434
         BNO   @GL00063                                            0434
         CLI   HDRVERFY(HDR1PTR),C'V'                              0434
         BE    @RT00434                                            0434
@GL00063 TM    SDKTVFYI(SETDSKPT),B'10000000'                      0434
         BNZ   @RF00434                                            0434
@RT00434 DS    0H                                                  0435
*                           IF(HDRSECIN^=BLANK&/* SEC DATA SET     0435
*                                                            @Y30OEAC*/
*                               VOLACCIN^=BLANK)×/* AND SEC VOL    0435
*                                                            @Y30OEAC*/
*                               HDRSECIN=BLANK/* OR NO SEC DATA    0435
*                                                            @Y30OEAC*/
*                             THEN  /* SET ?                 @Y30OEAC*/
         CLI   HDRSECIN(HDR1PTR),C' '                              0435
         BE    @GL00065                                            0435
         CLI   VOLACCIN(VOL1PTR),C' '                              0435
         BNE   @RT00435                                            0435
@GL00065 CLI   HDRSECIN(HDR1PTR),C' '                              0435
         BNE   @RF00435                                            0435
@RT00435 DS    0H                                                  0436
*                             GOODHDR1=ON;/* SET GOOD HDR1 IND     0436
*                                                            @Y30OEAC*/
         OI    GOODHDR1(AMWRKPTR),B'10000000'                      0436
*                     END;          /*                       @Y30OEAC*/
@RF00435 DS    0H                                                  0437
@RF00434 DS    0H                                                  0437
@RF00433 DS    0H                                                  0438
*                 END;              /*                       @Y30OEAC*/
@RF00429 DS    0H                                                  0439
*           END;                    /*                       @Y30OEAC*/
@RF00408 DS    0H                                                  0439
@RF00407 DS    0H                                                  0440
*     END;                          /*                       @ZA00799*/
@RF00386 DS    0H                                                  0440
@RF00385 DS    0H                                                  0441
*   IF GOODHDR1=OFF                 /* INVALID HDR1 LABEL ?  @Y30OEAC*/
*     THEN                          /*                       @Y30OEAC*/
@RF00376 TM    GOODHDR1(AMWRKPTR),B'10000000'                      0441
         BNZ   @RF00441                                            0441
*     ERTNCDE=BADHDR1;              /* SET BAD HDR1 RTN CODE @Y30OEAC*/
         MVI   ERTNCDE(SETDSKPT),X'0C'                             0442
*   RFY                             /*                       @Y30OEAC*/
*     REG14 UNRSTD;                 /* RELEASE REGISTER      @Y30OEAC*/
*   END VALIDHDR;                   /*                       @Y30OE95*/
@EL00005 DS    0H                                                  0444
@EF00005 DS    0H                                                  0444
@ER00005 BR    @14                                                 0444
*DEBIOB:                            /*                       @Y30OE95*/
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OEAC*/
DEBIOB   DS    0H                                                  0446
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OE95*/
*/* THIS SUBROUTINE UPDATES THE DEB AND IOB'S IN PREPARATION @Y30OE95*/
*/* TO READ THE DATA SET.                                    @Y30OE95*/
*/*                                                          @Y30OE95*/
*/********************************************************** @Y30OEAC*/
*                                                                  0446
*   RFY                             /*                       @Y30OEAC*/
*     REG14 RSTD;                   /* RESTRICT REGISTER     @Y30OEAC*/
*   AMWEOD=''B;                     /* CLEAR EOD ADDRESS     @Y30OEAC*/
         XC    AMWEOD(4,AMWRKPTR),AMWEOD(AMWRKPTR)                 0447
*   IF HDREODRR>CHAR01              /* EOD SECTOR NUM > 1 ?  @Y30OEAC*/
*     THEN                          /*                       @Y30OE95*/
         CLC   HDREODRR(2,HDR1PTR),CHAR01                          0448
         BNH   @RF00448                                            0448
*     DO;                           /*                       @Y30OE95*/
*       PACK(TEMP1,HDREODRR);       /* PACK EOD SECTOR NUM   @Y30OE95*/
         PACK  TEMP1(2,AMWRKPTR),HDREODRR(2,HDR1PTR)               0450
*       CVB(TEMP2,TEMP1);           /* CONVERT IT TO BINARY  @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0451
         MVC   @TS00001+6(2),TEMP1(AMWRKPTR)                       0451
         CVB   @15,@TS00001                                        0451
         STH   @15,TEMP2(,AMWRKPTR)                                0451
*       AMWEODSS=TEMP2-ONE;         /* SUBTRT 1, PUT IN DEB  @Y30OEAC*/
         BCTR  @15,0                                               0452
         STC   @15,AMWEODSS(,AMWRKPTR)                             0452
*       PACK(TEMP1,HDREODCC);       /* PACK EOD TRK NUMBER   @Y30OE95*/
         PACK  TEMP1(2,AMWRKPTR),HDREODCC(2,HDR1PTR)               0453
*       CVB(AMWEODTT,TEMP1);        /* CVRT TO BIN AND STORE @Y30OEAC*/
         XC    @TS00001(8),@TS00001                                0454
         MVC   @TS00001+6(2),TEMP1(AMWRKPTR)                       0454
         CVB   @15,@TS00001                                        0454
         STC   @15,AMWEODTT(,AMWRKPTR)                             0454
*     END;                          /*                       @Y30OE95*/
*   ELSE                            /* EOD SECTOR NUM = 1    @Y30OE95*/
*     DO;                           /*                       @Y30OE95*/
         B     @RC00448                                            0456
@RF00448 DS    0H                                                  0457
*       PACK(TEMP1,HDREODCC);       /* PACK EOD TRK NUMBER   @Y30OE95*/
         PACK  TEMP1(2,AMWRKPTR),HDREODCC(2,HDR1PTR)               0457
*       CVB(TEMP2,TEMP1);           /* CONVERT IT TO BINARY  @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0458
         MVC   @TS00001+6(2),TEMP1(AMWRKPTR)                       0458
         CVB   @15,@TS00001                                        0458
         STH   @15,TEMP2(,AMWRKPTR)                                0458
*       AMWEODTT=TEMP2-ONE;         /* SUBT 1 AND PUT IN DEB @Y30OEAC*/
         BCTR  @15,0                                               0459
         STC   @15,AMWEODTT(,AMWRKPTR)                             0459
*       AMWEODSS=LASTREC;           /* EOD SECTOR NUM = 26   @Y30OEAC*/
         MVI   AMWEODSS(AMWRKPTR),X'1A'                            0460
*     END;                          /*                       @Y30OE95*/
*   IF HDRMVLI=CONTVOL              /* CONTINUED DATA SET ?  @Y30OEAC*/
*     THEN                          /*                       @Y30OE95*/
@RC00448 CLI   HDRMVLI(HDR1PTR),C'C'                               0462
         BNE   @RF00462                                            0462
*     AMWMULTI=ON;                  /* SET DEB MULTI VOL IND @Y30OEAC*/
         OI    AMWMULTI(AMWRKPTR),B'10000000'                      0463
*   ELSE                            /* NOT A CONT'D DATA SET @Y30OE95*/
*     AMWMULTI=OFF;                 /* SET DEB MUTLI VOL IND @Y30OEAC*/
         B     @RC00462                                            0464
@RF00462 NI    AMWMULTI(AMWRKPTR),B'01111111'                      0464
*   PACK(TEMP1,HDRVOLSQ);           /* PACK VOL SEQ NUM      @Y30OE95*/
@RC00462 PACK  TEMP1(2,AMWRKPTR),HDRVOLSQ(2,HDR1PTR)               0465
*   TEMP1(2)=TEMP1(2)&NUMBER0;      /* ZERO LOW 4 BITS       @Y30OEAC*/
         NI    TEMP1+1(AMWRKPTR),C'0'                              0466
*   TEMP1(2)=TEMP1(2)×PLUSSIGN;     /* MAKE SIGN POSTIVE     @Y30OEAC*/
         OI    TEMP1+1(AMWRKPTR),X'0C'                             0467
*   CVB(AMWVSEQU,TEMP1);            /* CONVERT TO BINARY AND @Y30OEAC
*                                      PLACE IN DEB          @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0468
         MVC   @TS00001+6(2),TEMP1(AMWRKPTR)                       0468
         CVB   @15,@TS00001                                        0468
         STC   @15,AMWVSEQU(,AMWRKPTR)                             0468
*   AMWDSID=HDRDSID;                /* PUT DSID IN DEB       @Y30OEAC*/
*                                                                  0469
         MVC   AMWDSID(8,AMWRKPTR),HDRDSID(HDR1PTR)                0469
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP IOB SEEK ADDRESSES OF BOTH IOB'S               @Y30OE95*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0470
*   IOBSKADR=''B;                   /* CLEAR IOB SEEK ADDR   @Y30OEAC*/
         XC    IOBSKADR(4,IOBSTPTR),IOBSKADR(IOBSTPTR)             0470
*   PACK(TEMP1,HDRBOERR);           /* PACK SECTOR NUMBER    @Y30OE95*/
         PACK  TEMP1(2,AMWRKPTR),HDRBOERR(2,HDR1PTR)               0471
*   CVB(IOBSKSS,TEMP1);             /* CONVERT TO BINARY AND @Y30OE95
*                                      STORE IT IN IOB       @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0472
         MVC   @TS00001+6(2),TEMP1(AMWRKPTR)                       0472
         CVB   @15,@TS00001                                        0472
         STC   @15,IOBSKSS(,IOBSTPTR)                              0472
*   PACK(TEMP1,HDRBOECC);           /* PACK TRACK NUMBER     @Y30OE95*/
         PACK  TEMP1(2,AMWRKPTR),HDRBOECC(2,HDR1PTR)               0473
*   CVB(TEMP2,TEMP1);               /* CONVERT IT TO BINARY  @Y30OE95*/
         XC    @TS00001(8),@TS00001                                0474
         MVC   @TS00001+6(2),TEMP1(AMWRKPTR)                       0474
         CVB   @15,@TS00001                                        0474
         STH   @15,TEMP2(,AMWRKPTR)                                0474
*   IOBSKTT=TEMP2;                  /* STORE IN IOB          @Y30OE95*/
         STC   @15,IOBSKTT(,IOBSTPTR)                              0475
*   DO I=1 TO IOBNO;                /* SET LOOP FOR # IOB'S  @Y30OEAC*/
         LA    @15,1                                               0476
         B     @DE00476                                            0476
@DL00476 DS    0H                                                  0477
*     CHNPGMPT=IOBSTART;            /* GET PTR TO CCW'S      @Y30OE95*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0477
*     DO J=3 TO 28;                 /* SET LOOP FOR 26 CCW'S @Y30OEAC*/
         LA    @15,3                                               0478
         ST    @15,J(,AMWRKPTR)                                    0478
@DL00478 DS    0H                                                  0479
*       CHANPGM(J,7:8)=CONVERT1;    /* PUT REC LNG IN CCW    @Y30OEAC*/
         L     @15,J(,AMWRKPTR)                                    0479
         SLA   @15,3                                               0479
         LH    @03,CONVERT1(,AMWRKPTR)                             0479
         BCTR  @15,0                                               0479
         BCTR  @15,0                                               0479
         STH   @03,CHANPGM(@15,CHNPGMPT)                           0479
*     END;                          /*                       @Y30OE95*/
         LA    @15,1                                               0480
         AL    @15,J(,AMWRKPTR)                                    0480
         ST    @15,J(,AMWRKPTR)                                    0480
         CH    @15,@CH01593                                        0480
         BNH   @DL00478                                            0480
*     IOBSTPTR=IOBNIOBA+LENGTH(IOBORG01);/* PTR TO NEXT IOB  @Y30OE95*/
         ICM   @15,7,IOBPTR(AMWRKPTR)                              0481
         LA    IOBSTPTR,8                                          0481
         AL    @15,@CF02069                                        0481
         AL    IOBSTPTR,IOBNIOBA-8(,@15)                           0481
*   END;                            /*                       @Y30OE95*/
         LA    @15,1                                               0482
         AL    @15,I(,AMWRKPTR)                                    0482
@DE00476 ST    @15,I(,AMWRKPTR)                                    0482
         SLR   @03,@03                                             0482
         IC    @03,IOBNO(,AMWRKPTR)                                0482
         CR    @15,@03                                             0482
         BNH   @DL00476                                            0482
*   IOBSKADR=''B;                   /* CLEAR IOB SEEK ADDR   @Y30OEAC*/
         XC    IOBSKADR(4,IOBSTPTR),IOBSKADR(IOBSTPTR)             0483
*   IOBSKTT=TEMP2-ONE;              /* SUBTRACT ONE FROM TRK @Y30OE95
*                                      NUM AND STORE IN IOB  @Y30OE95*/
         LH    @15,TEMP2(,AMWRKPTR)                                0484
         BCTR  @15,0                                               0484
         STC   @15,IOBSKTT(,IOBSTPTR)                              0484
*   IOBSKSS=ONE;                    /* SET SECTOR NUMBER = 1 @Y30OE95*/
         MVI   IOBSKSS(IOBSTPTR),X'01'                             0485
*   IOBSTPTR=SIOB1PTR;              /* RESTORE ORIG IOB PTR  @Y30OE95*/
         L     IOBSTPTR,SIOB1PTR(,AMWRKPTR)                        0486
*   CHNPGMPT=IOBSTART;              /* GET PTR TO CHAN PGM   @Y30OE95*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0487
*   RFY                             /*                       @Y30OEAC*/
*     REG14 UNRSTD;                 /* RELEASE REGISTER      @Y30OEAC*/
*   END DEBIOB;                     /*                       @Y30OE95*/
@EL00006 DS    0H                                                  0489
@EF00006 DS    0H                                                  0489
@ER00006 BR    @14                                                 0489
*PRIMEBFR:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
PRIMEBFR ST    @14,@SA00007                                        0490
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OE95*/
*/* THIS SUBROUTINE PRIMES THE BUFFERS, I.E., READS THE 1ST  @Y30OE95*/
*/* TRACK INTO THE 1ST I/O BUFFER AND, IF THE DATA SET       @Y30OE95*/
*/* BEGINS ON A NON-TRACK BOUNDARY (REC NUM > 1) AND         @Y30OE95*/
*/* EXTENDS OVER MORE THAN ONE TRACK, READS THE 2ND TRACK    @Y30OE95*/
*/* INTO THE SECOND I/O BUFFER.                              @Y30OE95*/
*/*                                                          @Y30OE95*/
*/********************************************************** @Y30OEAC*/
*                                                                  0491
*   IF HDRBOE^=HDREOD&              /* NOT NULL DATA SET AND @Y30OE95*/
*       HDRBYPAS^=BYPASIND          /* BYPASS INDIC OFF ?    @Y30OEAC*/
*     THEN                          /*                       @Y30OE95*/
         CLC   HDRBOE(5,HDR1PTR),HDREOD(HDR1PTR)                   0491
         BE    @RF00491                                            0491
         CLI   HDRBYPAS(HDR1PTR),C'B'                              0491
         BE    @RF00491                                            0491
*     DO;                           /*                       @Y30OE95*/
*       IF AMWEODTT=IOBSKTT         /* DS ENDS ON THIS TRK ? @Y30OEAC*/
*         THEN                      /*                       @Y30OE95*/
*                                                                  0493
         CLC   AMWEODTT(1,AMWRKPTR),IOBSKTT(IOBSTPTR)              0493
         BNE   @RF00493                                            0493
*         /***********************************************************/
*         /*                                                         */
*         /* ALTER THE CCW CHAIN TO DO A SHORT TRACK READ    @Y30OE95*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0494
*         DO;                       /*                       @Y30OE95*/
*           CHANPGM(29)=CHANPGM(AMWEODSS+OFFSET3);/* SAV CCW @Y30OEAC
*                                      OF LAST REC ON THIS   @Y30OE95
*                                      TRACK                 @Y30OEAC*/
         SLR   @03,@03                                             0495
         IC    @03,AMWEODSS(,AMWRKPTR)                             0495
         SLA   @03,3                                               0495
         ST    @03,@TF00001                                        0495
         ALR   @03,CHNPGMPT                                        0495
         MVC   @TS00001(8),CHANPGM+16(@03)                         0495
         MVC   CHANPGM+224(8,CHNPGMPT),@TS00001                    0495
*           CHANPGM(AMWEODSS+OFFSET3)=CCWNOOP;/* REPLACE     @Y30OEAC
*                                      WITH NOOP CCW         @Y30OE95*/
         LR    @03,CHNPGMPT                                        0496
         AL    @03,@TF00001                                        0496
         MVC   CHANPGM+16(8,@03),CCWNOOP                           0496
*         END;                      /*                       @Y30OE95*/
*       IF IOBSKSS^=ONE             /* DS NOT ON TRACK BDY ? @Y30OE95*/
*         THEN                      /*                       @Y30OE95*/
@RF00493 CLI   IOBSKSS(IOBSTPTR),1                                 0498
         BE    @RF00498                                            0498
*         CALL PRMBFNTK;            /* NON-TRK BDY BUFFR PRM @Y30OE95*/
         BAL   @14,PRMBFNTK                                        0499
*       ELSE                        /* DS ON TRACK BDY       @Y30OE95*/
*         DO;                       /*                       @Y30OE95*/
         B     @RC00498                                            0500
@RF00498 DS    0H                                                  0501
*           GEN(EXCP  (IOBSTPTR));  /* EXCP IOB              @Y30OEAC*/
         EXCP  (IOBSTPTR)
*           IOBSTPTR=IOBNIOBA+LENGTH(IOBORG01);/* NEXT IOB   @Y30OE95*/
         ICM   @03,7,IOBPTR(AMWRKPTR)                              0502
         LA    IOBSTPTR,8                                          0502
         AL    @03,@CF02069                                        0502
         AL    IOBSTPTR,IOBNIOBA-8(,@03)                           0502
*           CHNPGMPT=IOBSTART;      /* PTR TO NEXT CHNPGM    @Y30OE95*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0503
*           CCWPTR=ADDR(CHANPGM(29));/* PUT PTR TO NOOP CCW  @Y30OE95
*                                      IN CURRENT CCW PTR    @Y30OE95*/
         LA    @03,CHANPGM+224(,CHNPGMPT)                          0504
         STCM  @03,7,CCWPTR(AMWRKPTR)                              0504
*           IOBPTR=IOBSTPTR;        /* SET PTR TO NEXT IOB   @Y30OE95*/
         STCM  IOBSTPTR,7,IOBPTR(AMWRKPTR)                         0505
*         END;                      /*                       @Y30OE95*/
*     END;                          /*                       @Y30OE95*/
*   ELSE                            /* NULL DS, BYPAS IND ON @Y30OE95*/
*     DO;                           /*                       @Y30OE95*/
         B     @RC00491                                            0508
@RF00491 DS    0H                                                  0509
*       CCWPTR=ADDR(CHANPGM(29));   /* PUT PTR TO NOOP CCW   @Y30OE95
*                                      IN CURRENT CCW PTR    @Y30OE95*/
         LA    @03,CHANPGM+224(,CHNPGMPT)                          0509
         STCM  @03,7,CCWPTR(AMWRKPTR)                              0509
*       AMWEODTT=IOBSKTT;           /* SET EOD TRACK NUMBER  @Y30OEAC*/
         MVC   AMWEODTT(1,AMWRKPTR),IOBSKTT(IOBSTPTR)              0510
*     END;                          /*                       @Y30OE95*/
*   IOBSTPTR=SIOB1PTR;              /* RESTORE ORIG IOB PTR  @Y30OE95*/
@RC00491 L     IOBSTPTR,SIOB1PTR(,AMWRKPTR)                        0512
*   CHNPGMPT=IOBSTART;              /* GET PTR TO CHAN PGM   @Y30OE95*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0513
*   END PRIMEBFR;                   /*                       @Y30OE95*/
@EL00007 DS    0H                                                  0514
@EF00007 DS    0H                                                  0514
@ER00007 L     @14,@SA00007                                        0514
         BR    @14                                                 0514
*PRMBFNTK:                          /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
PRMBFNTK ST    @14,@SA00008                                        0515
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OE95*/
*/* THIS SUBROUTINE HANDLES BUFFER PRIMING OF DATA SETS NOT  @Y30OE95*/
*/* STARTING ON TRACK BOUNDARYS.                             @Y30OE95*/
*/*                                                          @Y30OE95*/
*/********************************************************** @Y30OEAC*/
*                                                                  0516
*   VOLLABID=BLNKVLID;              /* BLANK VOL1 LABEL ID   @Y30OEAC*/
         MVC   VOLLABID(4,VOL1PTR),BLNKVLID                        0516
*   CCW21SAV=CHANPGM(3);            /* SAVE 1ST READ CCW     @Y30OE95*/
         MVC   CCW21SAV(8,AMWRKPTR),CHANPGM+16(CHNPGMPT)           0517
*   CHANPGM(3,1:4)=ADDR(CHANPGM(IOBSKSS+TWO));/*             @Y30OE95*/
         SLR   @03,@03                                             0518
         IC    @03,IOBSKSS(,IOBSTPTR)                              0518
         SLA   @03,3                                               0518
         LA    @03,CHANPGM+8(@03,CHNPGMPT)                         0518
         ST    @03,CHANPGM+16(,CHNPGMPT)                           0518
*   CHANPGM(3,1)=TICCCW;            /* TIC CCW COMMAND CODE  @Y30OE95*/
         MVI   CHANPGM+16(CHNPGMPT),X'08'                          0519
*   CALL IOSBRTN;                   /* CALL I/O SUBROUTINE   @Y30OE95*/
         BAL   @14,IOSBRTN                                         0520
*   CHANPGM(3)=CCW21SAV;            /* RESTORE 1ST READ CCW  @Y30OE95*/
         MVC   CHANPGM+16(8,CHNPGMPT),CCW21SAV(AMWRKPTR)           0521
*   IF ECBCC=GOODIO                 /* NO I/O ERRORS ?       @Y30OE95*/
*     THEN                          /*                       @Y30OE95*/
         ICM   @03,7,IOBECBPB(IOBSTPTR)                            0522
         CLI   ECBCC(@03),127                                      0522
         BNE   @RF00522                                            0522
*     DO;                           /*                       @Y30OE95*/
*       CCWPTR=ADDR(CHANPGM(IOBSKSS+ONE));/* POINT CCWPTR TO @Y30OE95
*                                      1ST RECORD MINUS ONE  @Y30OE95*/
         SLR   @03,@03                                             0524
         IC    @03,IOBSKSS(,IOBSTPTR)                              0524
         SLA   @03,3                                               0524
         LA    @03,CHANPGM(@03,CHNPGMPT)                           0524
         STCM  @03,7,CCWPTR(AMWRKPTR)                              0524
*       IOBSKSS=ONE;                /* SET SEEK ADDR = REC 1 @Y30OE95*/
         MVI   IOBSKSS(IOBSTPTR),X'01'                             0525
*       IF AMWEODTT^=IOBSKTT        /* DS DOESN'T END ON 1ST @Y30OEAC*/
*         THEN                      /* TRACK ?               @Y30OE95*/
         CLC   AMWEODTT(1,AMWRKPTR),IOBSKTT(IOBSTPTR)              0526
         BE    @RF00526                                            0526
*         DO;                       /*                       @Y30OE95*/
*           IOBSTPTR=IOBNIOBA+LENGTH(IOBORG01);/* NEXT IOB   @Y30OE95*/
         ICM   @03,7,IOBPTR(AMWRKPTR)                              0528
         LA    IOBSTPTR,8                                          0528
         AL    @03,@CF02069                                        0528
         AL    IOBSTPTR,IOBNIOBA-8(,@03)                           0528
*           IOBSKTT=IOBSKTT+TWO;    /* UPDATE CYLINDER NUMBR @Y30OE95*/
         LA    @03,2                                               0529
         SLR   @15,@15                                             0529
         IC    @15,IOBSKTT(,IOBSTPTR)                              0529
         ALR   @03,@15                                             0529
         STC   @03,IOBSKTT(,IOBSTPTR)                              0529
*           IF IOBSKTT=AMWEODTT     /* DS END ON THIS TRACK? @Y30OEAC*/
*             THEN                  /*                       @Y30OE95*/
         CLC   IOBSKTT(1,IOBSTPTR),AMWEODTT(AMWRKPTR)              0530
         BNE   @RF00530                                            0530
*             DO;                   /*                       @Y30OE95*/
*               CHNPGMPT=IOBSTART;  /* POINT TO NEXT CHANNEL @Y30OE95
*                                      PROGRAM               @Y30OE95*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0532
*               CHANPGM(29)=CHANPGM(AMWEODSS+OFFSET3);/* SAV @Y30OEAC
*                                      CCW OF LAST RECORD    @Y30OE95
*                                      ON THIS TRACK         @Y30OE95*/
         SLR   @03,@03                                             0533
         IC    @03,AMWEODSS(,AMWRKPTR)                             0533
         SLA   @03,3                                               0533
         ST    @03,@TF00001                                        0533
         ALR   @03,CHNPGMPT                                        0533
         MVC   @TS00001(8),CHANPGM+16(@03)                         0533
         MVC   CHANPGM+224(8,CHNPGMPT),@TS00001                    0533
*               CHANPGM(AMWEODSS+OFFSET3)=CCWNOOP;/* REPLACE @Y30OEAC
*                                      WITH NOOP CCW         @Y30OE95*/
         LR    @03,CHNPGMPT                                        0534
         AL    @03,@TF00001                                        0534
         MVC   CHANPGM+16(8,@03),CCWNOOP                           0534
*             END;                  /*                       @Y30OE95*/
*           GEN(EXCP  (IOBSTPTR));  /* EXCP IOB              @Y30OEAC*/
@RF00530 DS    0H                                                  0536
         EXCP  (IOBSTPTR)
*         END;                      /*                       @Y30OE95*/
*     END;                          /*                       @Y30OE95*/
*   ELSE                            /* I/O ERRORS            @Y30OE95*/
*     DO;                           /*                       @Y30OE95*/
         B     @RC00522                                            0539
@RF00522 DS    0H                                                  0540
*       ERTNCDE=IOERROR;            /* SET I/O ERROR RTN CD  @Y30OE95*/
         MVI   ERTNCDE(SETDSKPT),X'10'                             0540
*       ERTNCDQL=BPIOERR;           /* SET I/O ERROR QUAL    @Y30OEAC*/
         MVI   ERTNCDQL(SETDSKPT),X'04'                            0541
*     END;                          /*                       @Y30OE95*/
*   IOBSTPTR=SIOB1PTR;              /* RESTORE IOB POINTER   @Y30OE95*/
@RC00522 L     IOBSTPTR,SIOB1PTR(,AMWRKPTR)                        0543
*   END PRMBFNTK;                   /*                       @Y30OE95*/
@EL00008 DS    0H                                                  0544
@EF00008 DS    0H                                                  0544
@ER00008 L     @14,@SA00008                                        0544
         BR    @14                                                 0544
*PURGEIOB:                          /*                       @Y30OEAC*/
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OEAC*/
PURGEIOB DS    0H                                                  0546
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/* THIS SUBROUTINE WILL BUILD A PURGE PARAMETER LIST AND    @Y30OEAC*/
*/* PURGE ANY I/O THAT MAYBE PENDING OR IN PROGRESS.         @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/********************************************************** @Y30OEAC*/
*                                                                  0546
*   RFY                             /*                       @Y30OEAC*/
*    (REG14,                        /*                       @Y30OEAC*/
*     REG1) RSTD;                   /* RESTRICT REGISTERS    @Y30OEAC*/
*   PURGELST=''B;                   /* CLEAR PURGE LIST      @Y30OEAC*/
         XC    PURGELST(16,AMWRKPTR),PURGELST(AMWRKPTR)            0547
*   PRGDEB=DCBDEBAD;                /* GET PTR TO DEB        @Y30OEAC*/
         L     @15,DCBPTR                                          0548
         MVC   PRGDEB(3,AMWRKPTR),DCBDEBAD+41(@15)                 0548
*   PRGOPT=PURGTXT;                 /* SET PURGE OPTION      @Y30OEAC*/
         MVI   PRGOPT(AMWRKPTR),X'94'                              0549
*   PURGEWPT=ADDR(PURGEWKA);        /* SET PURGE WRKAREA PTR @Y30OEAC*/
         LA    @15,PURGEWKA(,AMWRKPTR)                             0550
         ST    @15,PURGEWPT(,AMWRKPTR)                             0550
*   REG1=ADDR(PURGELST);            /* POINT TO PARM LIST    @Y30OE95*/
         LA    REG1,PURGELST(,AMWRKPTR)                            0551
*   GEN(PURGE (REG1));              /* ISSUE PURGE           @Y30OE95*/
         PURGE (REG1)
*   DO I=1 TO IOBNO;                /* SET LOOP FOR # IOB'S  @Y30OEAC*/
*                                                                  0553
         LA    @15,1                                               0553
         B     @DE00553                                            0553
@DL00553 DS    0H                                                  0554
*     /***************************************************************/
*     /*                                                             */
*     /* REBUILD CCW CHAIN THAT MAY HAVE BEEN ALTERED DURING @Y30OE95*/
*     /* GET PROCESSING BY A SHORT TRACK READ                @Y30OE95*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0554
*     IF CHANPGM(AMWEODSS+OFFSET3,1)=NOOPCCW/* NOOP CCW ?    @Y30OEAC*/
*       THEN                        /*                       @Y30OE95*/
         SLR   @15,@15                                             0554
         IC    @15,AMWEODSS(,AMWRKPTR)                             0554
         SLA   @15,3                                               0554
         ST    @15,@TF00001                                        0554
         ALR   @15,CHNPGMPT                                        0554
         CLI   CHANPGM+16(@15),X'03'                               0554
         BNE   @RF00554                                            0554
*       DO;                         /*                       @Y30OE95*/
*         CHANPGM(AMWEODSS+OFFSET3)=CHANPGM(29);/* REPLACE   @Y30OEAC
*                                      WITH READ CCW         @Y30OE95*/
         LR    @15,CHNPGMPT                                        0556
         AL    @15,@TF00001                                        0556
         MVC   @TS00001(8),CHANPGM+224(CHNPGMPT)                   0556
         MVC   CHANPGM+16(8,@15),@TS00001                          0556
*         CHANPGM(29)=CCWNOOP;      /* PUT NOOP CCW AT END   @Y30OEAC
*                                      OF CCW CHAIN          @Y30OE95*/
         MVC   CHANPGM+224(8,CHNPGMPT),CCWNOOP                     0557
*       END;                        /*                       @Y30OE95*/
*     IOBSTPTR=IOBNIOBA+LENGTH(IOBORG01);/* PTR TO NEXT IOB  @Y30OE95*/
@RF00554 ICM   @15,7,IOBPTR(AMWRKPTR)                              0559
         LA    IOBSTPTR,8                                          0559
         AL    @15,@CF02069                                        0559
         AL    IOBSTPTR,IOBNIOBA-8(,@15)                           0559
*     CHNPGMPT=IOBSTART;            /* NEXT CHANNEL PROGRAM  @Y30OE95*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0560
*   END;                            /*                       @Y30OE95*/
         LA    @15,1                                               0561
         AL    @15,I(,AMWRKPTR)                                    0561
@DE00553 ST    @15,I(,AMWRKPTR)                                    0561
         SLR   @03,@03                                             0561
         IC    @03,IOBNO(,AMWRKPTR)                                0561
         CR    @15,@03                                             0561
         BNH   @DL00553                                            0561
*   IOBSTPTR=SIOB1PTR;              /* RESTORE TO 1ST IOB    @Y30OE95*/
         L     IOBSTPTR,SIOB1PTR(,AMWRKPTR)                        0562
*   CHNPGMPT=IOBSTART;              /* 1ST CHANNEL PROGRAM   @Y30OE95*/
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0563
*   RFY                             /*                       @Y30OEAC*/
*    (REG14,                        /*                       @Y30OEAC*/
*     REG1) UNRSTD;                 /* RELEASE REGISTERS     @Y30OEAC*/
*   END PURGEIOB;                   /*                       @Y30OE95*/
@EL00009 DS    0H                                                  0565
@EF00009 DS    0H                                                  0565
@ER00009 BR    @14                                                 0565
*SEQERR:                            /*                       @Y30OE95*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/
SEQERR   ST    @14,@SA00010                                        0566
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/* THIS SUBROUTINE SETS UP THE MESSAGE WRITER PARAMETER     @Y30OEAC*/
*/* LIST AND CALLS THE MESSAGE WRITER TO ISSUE THE DISKETTE  @Y30OEAC*/
*/* SEQUENCE ERROR MESSAGE                                   @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/********************************************************** @Y30OEAC*/
*                                                                  0567
*   RFY                             /*                       @Y30OEAC*/
*     REG1 RSTD;                    /* RESTRICT REGISTER     @Y30OEAC*/
*   VOLLABID=BLNKVLID;              /* BLANK VOL1 LABEL ID   @Y30OEAC*/
         MVC   VOLLABID(4,VOL1PTR),BLNKVLID                        0568
*   RETRY=OFF;                      /* SET RETRY INDICATOR   @Y30OE95*/
*   NOTREADY=ON;                    /* SET ^READY BIT IND    @Y30OEAC*/
         OI    NOTREADY(AMWRKPTR),B'00000001'                      0570
         NI    RETRY(AMWRKPTR),B'10111111'                         0570
*   CALL UCBUPDTE;                  /* MAKE UCB NOT READY    @Y30OEAC*/
         BAL   @14,UCBUPDTE                                        0571
*   MSGINDEX=SEQMSG;                /* SET MESSAGE INDEX     @Y30OEAC*/
         MVI   MSGINDEX(AMWRKPTR),X'0D'                            0572
*   DO UNTIL REPLYAR=CANCEL×        /* LOOP UNTIL A REPLY OF @Y30OEAC*/
*         REPLYAR=RTRY;             /* 'C' OR 'R' IS GIVEN   @Y30OEAC*/
@DL00573 DS    0H                                                  0574
*     CALL MSGSBRTN;                /* CALL MESSAGE ROUTINE  @Y30OEAC*/
         BAL   @14,MSGSBRTN                                        0574
*     IF REPLYAR=CANCEL             /* REPLY CANCEL ?        @Y30OEAC*/
*       THEN                        /*                       @Y30OE95*/
         L     @03,MSGREPAD(,AMWRKPTR)                             0575
         CLI   REPLYAR(@03),C'C'                                   0575
         BNE   @RF00575                                            0575
*       DO;                         /*                       @Y30OE95*/
*         CALL UCBUPDTE;            /* MAKE UCB READY        @Y30OEAC*/
         BAL   @14,UCBUPDTE                                        0577
*         ERTNCDE=OPERCNCL;         /* SET OPER CANCL RTN CD @Y30OE95*/
         MVI   ERTNCDE(SETDSKPT),X'18'                             0578
*       END;                        /*                       @Y30OE95*/
*     ELSE                          /* REPLY NOT CANCEL      @Y30OE95*/
*       SETRETCD=CLEAR;             /* SET RETURN CODE TO 0  @Y30OEAC*/
         B     @RC00575                                            0580
@RF00575 MVC   SETRETCD(2,SETDSKPT),CLEAR                          0580
*   END;                            /*                       @Y30OE95*/
@RC00575 DS    0H                                                  0581
@DE00573 L     @03,MSGREPAD(,AMWRKPTR)                             0581
         CLI   REPLYAR(@03),C'C'                                   0581
         BE    @DC00573                                            0581
         CLI   REPLYAR(@03),C'R'                                   0581
         BNE   @DL00573                                            0581
@DC00573 DS    0H                                                  0582
*   RFY                             /*                       @Y30OEAC*/
*     REG1 UNRSTD;                  /* RELEASE REGISTER      @Y30OEAC*/
*   END SEQERR;                     /*                       @Y30OE95*/
@EL00010 DS    0H                                                  0583
@EF00010 DS    0H                                                  0583
@ER00010 L     @14,@SA00010                                        0583
         BR    @14                                                 0583
*SECRPROC:                          /*                       @Y30OEAC*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OEAC*/
SECRPROC ST    @14,@SA00011                                        0584
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/* THIS SUBROUTINE PERFORMS VOLUME SECURITY PROCESSING      @Y30OEAC*/
*/* AND DATA SET SECURITY PROCESSING                         @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/********************************************************** @Y30OEAC*/
*                                                                  0585
*   MSGINDEX=SECRMSG;               /* SET MESSAGE INDEX     @Y30OEAC*/
         MVI   MSGINDEX(AMWRKPTR),X'11'                            0585
*   VOLDSTXT=SER;                   /* SECURE VOLUME MSG     @Y30OEAC*/
         MVC   VOLDSTXT(8),SER                                     0586
*   SECURIN=VOLACCIN;               /* GET VOL ACCESS IND    @Y30OEAC*/
         MVC   SECURIN(1,AMWRKPTR),VOLACCIN(VOL1PTR)               0587
*   SECURCD=SECUREVL;               /* GET RETURN CODE       @Y30OEAC*/
         MVC   SECURCD(2,AMWRKPTR),SECUREVL                        0588
*   DSIDLOP=ON;                     /* DONT USE DSID         @Z30OE78*/
         OI    DSIDLOP,B'10000000'                                 0589
*   IF SECVOL=OFF                   /* DS SECURITY PROCESS ? @Y30OEAC*/
*     THEN                          /*                       @Y30OEAC*/
         TM    SECVOL(AMWRKPTR),B'00100000'                        0590
         BNZ   @RF00590                                            0590
*     DO;                           /*                       @Y30OEAC*/
*       DSIDLOP=OFF;                /* USE DSID IN MSG       @Z30OE78*/
         NI    DSIDLOP,B'01111111'                                 0592
*       VOLDSTXT=DSID;              /* SECURE DATA SET MSG   @Y30OEAC*/
         MVC   VOLDSTXT(8),DSID                                    0593
*       SECURIN=HDRSECIN;           /* GET DS SECURITY IND   @Y30OEAC*/
         MVC   SECURIN(1,AMWRKPTR),HDRSECIN(HDR1PTR)               0594
*       SECURCD=SECUREDS;           /* GET RETURN CODE       @Y30OEAC*/
         MVC   SECURCD(2,AMWRKPTR),SECUREDS                        0595
*     END;                          /*                       @Y30OEAC*/
*   JOBNMTXT=ACBJOBID;              /* GET JOBNAME FOR MSG   @Z30OE78*/
@RF00590 MVC   JOBNMTXT(8),ACBJOBID(AMWRKPTR)                      0597
*   VALIDREP=OFF;                   /* SET VALID REPLY IND   @Y30OEAC*/
         NI    VALIDREP(AMWRKPTR),B'11101111'                      0598
*   DO I=1 TO 3 WHILE VALIDREP=OFF; /* CORRECT REPLY OR BLNK @Y30OEAC*/
         LA    @03,1                                               0599
         ST    @03,I(,AMWRKPTR)                                    0599
@DL00599 TM    VALIDREP(AMWRKPTR),B'00010000'                      0599
         BNZ   @DC00599                                            0599
*     CALL MSGSBRTN;                /* CALL MESSAGE ROUTINE  @Y30OEAC*/
         BAL   @14,MSGSBRTN                                        0600
*     IF REPLYAR=SECURIN×           /* CORRECT SECURE IND ?  @Z30OE78*/
*         REPLYAR=BLANK             /* OR DENY ACCESS?       @Z30OE78*/
*       THEN                        /*                       @Y30OEAC*/
         L     @03,MSGREPAD(,AMWRKPTR)                             0601
         CLC   REPLYAR(1,@03),SECURIN(AMWRKPTR)                    0601
         BE    @RT00601                                            0601
         CLI   REPLYAR(@03),C' '                                   0601
         BNE   @RF00601                                            0601
@RT00601 DS    0H                                                  0602
*       VALIDREP=ON;                /* SET VALID REPLY IND   @Y30OEAC*/
         OI    VALIDREP(AMWRKPTR),B'00010000'                      0602
*   END;                            /*                       @Y30OE95*/
@RF00601 LA    @03,1                                               0603
         AL    @03,I(,AMWRKPTR)                                    0603
         ST    @03,I(,AMWRKPTR)                                    0603
         CH    @03,@CH00228                                        0603
         BNH   @DL00599                                            0603
@DC00599 DS    0H                                                  0604
*   DSIDLOP=OFF;                    /* MAKE DSID USEABLE     @Z30OE78*/
         NI    DSIDLOP,B'01111111'                                 0604
*   IF REPLYAR^=SECURIN THEN        /* IF SECURITY CODE NOT  @Z30OE78
*                                      SUPPLIED,             @Z30OE78*/
         L     @03,MSGREPAD(,AMWRKPTR)                             0605
         CLC   REPLYAR(1,@03),SECURIN(AMWRKPTR)                    0605
         BE    @RF00605                                            0605
*     SETRETCD=SECURCD;             /* SET SECURE PASSBACK   @Z30OE78*/
         MVC   SETRETCD(2,SETDSKPT),SECURCD(AMWRKPTR)              0606
*   END SECRPROC;                   /*                       @Y30OEAC*/
@EL00011 DS    0H                                                  0607
@EF00011 DS    0H                                                  0607
@ER00011 L     @14,@SA00011                                        0607
         BR    @14                                                 0607
*MSGSBRTN:                          /*                       @Y30OEAC*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OEAC*/
MSGSBRTN ST    @14,@SA00012                                        0608
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/* THIS SUBROUTINE SETS UP THE MESSAGE WRITER PARAMETER     @Y30OEAC*/
*/* LIST AND CALLS THE MESSAGE WRITER TO ISSUE THE           @Y30OEAC*/
*/* MESSAGE.                                                 @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/********************************************************** @Y30OEAC*/
*                                                                  0609
*   RFY                             /*                       @Y30OEAC*/
*     REG1 RSTD;                    /* RESTRICT REGISTER     @Y30OEAC*/
*   MSGTYPCD=WTORCD;                /* SET MESSAGE TYPE CODE @Y30OEAC*/
         MVI   MSGTYPCD(AMWRKPTR),X'02'                            0610
*   IF ERTNCDE=BADVOL1              /* VOL1 ERROR ?          @Y30OEAC*/
*     THEN                          /*                       @Y30OEAC*/
         CLI   ERTNCDE(SETDSKPT),X'08'                             0611
         BNE   @RF00611                                            0611
*     DO;                           /*                       @Y30OEAC*/
*       VOLLABID=BLNKVLID;          /* BLANK VOL1 LABEL ID   @Y30OEAC*/
         MVC   VOLLABID(4,VOL1PTR),BLNKVLID                        0613
*       MSGINDEX=VOL1MSG;           /* GET MESSAGE INDEX     @Y30OEAC*/
         MVI   MSGINDEX(AMWRKPTR),X'0E'                            0614
*       MSGTYPCD=WTOCD;             /* SET MESSAGE TYPE CODE @Y30OEAC*/
         MVI   MSGTYPCD(AMWRKPTR),X'01'                            0615
*     END;                          /*                       @Y30OEAC*/
*   ELSE                            /*                       @Y30OEAC*/
*     IF ERTNCDE=BADHDR1            /* HDR1 ERROR ?          @Y30OEAC*/
*       THEN                        /*                       @Y30OEAC*/
         B     @RC00611                                            0617
@RF00611 CLI   ERTNCDE(SETDSKPT),X'0C'                             0617
         BNE   @RF00617                                            0617
*       DO;                         /*                       @Y30OEAC*/
*         MSGINDEX=HDR1MSG;         /* SET MESSAGE INDEX     @Y30OEAC*/
         MVI   MSGINDEX(AMWRKPTR),X'0F'                            0619
*         MSGTYPCD=WTOCD;           /* SET MESSAGE TYPE CODE @Y30OEAC*/
         MVI   MSGTYPCD(AMWRKPTR),X'01'                            0620
*       END;                        /*                       @Y30OEAC*/
*   MSGDCBAD=SDKTDCB;               /* GET DCB ADDRESS       @Y30OEAC*/
@RF00617 DS    0H                                                  0622
@RC00611 MVC   MSGDCBAD(4,AMWRKPTR),SDKTDCB(SETDSKPT)              0622
*   DEVADTXT=UCBNAME;               /* GET DEVICE ADDRESS    @Y30OEAC*/
         L     @03,UCBPTR                                          0623
         MVC   DEVADTXT(3),UCBNAME(@03)                            0623
*   DSIDTXT=SDKTDSID;               /* GET DATA SET ID       @Y30OEAC*/
         MVC   DSIDTXT(8),SDKTDSID(SETDSKPT)                       0624
*   SERTXT=VOLID;                   /* GET VOLUME SERIAL     @Y30OEAC*/
         MVC   SERTXT(6),VOLID(VOL1PTR)                            0625
*   MSGTEXT=MSGOPT;                 /* GET MESSAGE OPTIONS   @Y30OEAC*/
         MVC   MSGTEXT(45,AMWRKPTR),MSGOPT                         0626
*   REG1=ADDR(MSGAREA);             /* GET MSG LIST ADDRESS  @Y30OEAC*/
         LA    REG1,MSGAREA(,AMWRKPTR)                             0627
*   CALL IOEDKMSG;                  /* CALL MESSAGE WRITER   @Y30OEAC*/
         L     @15,@CV01787                                        0628
         BALR  @14,@15                                             0628
*   RFY                             /*                       @Y30OEAC*/
*     REG1 UNRSTD;                  /* RELEASE REGISTER      @Y30OEAC*/
*   END MSGSBRTN;                   /*                       @Y30OEAC*/
@EL00012 DS    0H                                                  0630
@EF00012 DS    0H                                                  0630
@ER00012 L     @14,@SA00012                                        0630
         BR    @14                                                 0630
*UCBUPDTE:                          /*                       @Y30OEAC*/
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE6D*/
UCBUPDTE ST    @14,@SA00013                                        0631
*/********************************************************** @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/* THIS SUBROUTINE UPDATES THE UCB                          @Y30OEAC*/
*/*                                                          @Y30OEAC*/
*/********************************************************** @Y30OEAC*/
*                                                                  0632
*   RFY                             /*                       @Y30OEAC*/
*     LOCKREG RSTD;                 /* RESTRICT REGISTER     @Y30OE6D*/
*   LOCKREG=ADDR(UCBLOCK);          /* GET DEVICE LOCKWORD   @Y30OE6D*/
         L     LOCKREG,UCBPTR                                      0633
         AL    LOCKREG,@CF02069                                    0633
*   GENERATE;                                                      0634
*                                                         /*@Y30OE6D*/
        MODESET KEY=ZERO,MODE=SUP GET PGM IN KEY ZERO         @Y30OE6D
        SETLOCK OBTAIN,TYPE=IOSUCB,ADDR=(11),MODE=UNCOND,             XX
               REGS=USE,RELATED=(UCB,(IOESDKTI,UCBUPDTE))     @Y30OE6D
*   IF VOLUPDTE=ON                  /* VOL-SER UPDATE ?      @Y30OEAC*/
*     THEN                          /*                       @Y30OEAC*/
         TM    VOLUPDTE(AMWRKPTR),B'00000010'                      0635
         BNO   @RF00635                                            0635
*     UCBVLSER=VOLSERID;            /* UPDATE UCB VOL-SER    @Y30OEAC*/
         L     @03,UCBPTR                                          0636
         L     @03,UCBXTADR(,@03)                                  0636
         MVC   UCBVLSER(6,@03),VOLSERID(AMWRKPTR)                  0636
*   ELSE                            /* NOT READY BIT UPDATE  @Y30OEAC*/
*     IF NOTREADY=ON                /* ^READY BIT IND ON ?   @Y30OEAC*/
*       THEN                        /*                       @Y30OEAC*/
         B     @RC00635                                            0637
@RF00635 TM    NOTREADY(AMWRKPTR),B'00000001'                      0637
         BNO   @RF00637                                            0637
*       UCBNOTRD=ON;                /* MAKE UCB NOT READY    @Y30OEAC*/
         L     @03,UCBPTR                                          0638
         OI    UCBNOTRD(@03),B'01000000'                           0638
*     ELSE                          /* ^READY BIT IND OFF    @Y30OEAC*/
*       UCBNOTRD=OFF;               /* MAKE UCB READY        @Y30OEAC*/
         B     @RC00637                                            0639
@RF00637 L     @03,UCBPTR                                          0639
         NI    UCBNOTRD(@03),B'10111111'                           0639
*   VOLUPDTE=OFF;                   /* SET VOL-SER UPDTE IND @Y30OEAC*/
@RC00637 DS    0H                                                  0640
@RC00635 DS    0H                                                  0641
*   NOTREADY=OFF;                   /* SET ^READY BIT IND    @Y30OEAC*/
         NI    VOLUPDTE(AMWRKPTR),B'11111100'                      0641
*   LOCKREG=ADDR(UCBLOCK);          /* GET DEVICE LOCKWORD   @Y30OE6D*/
         L     LOCKREG,UCBPTR                                      0642
         AL    LOCKREG,@CF02069                                    0642
*   GENERATE;                                                      0643
*                                                         /*@Y30OE6D*/
        SETLOCK RELEASE,TYPE=IOSUCB,ADDR=(11),                        XX
               REGS=USE,RELATED=(UCB,(IOESDKT1,UCBUPDTE))     @Y30OE6D
        MODESET KEY=NZERO,MODE=PROB RESTORE PROGRAM KEY       @Y30OE6D
*   RFY                             /*                       #Y30OEAC*/
*     LOCKREG UNRSTD;               /* RELEASE REGISTER      @Y30OE6D*/
*   END UCBUPDTE;                   /*                       #Y30OEAC*/
@EL00013 DS    0H                                                  0645
@EF00013 DS    0H                                                  0645
@ER00013 L     @14,@SA00013                                        0645
         BR    @14                                                 0645
*IOSBRTN:                           /*                       #Y30OE95*/
*   PROC OPTIONS(NOSAVE);           /*                       #Y30OEAC*/
IOSBRTN  DS    0H                                                  0647
*/********************************************************** #Y30OEAC*/
*/*                                                          #Y30OEAC*/
*/* THIS SUBROUTINE ISSUES AN EXCP AND WAITS UNTIL           #Y30OEAC*/
*/* I/O IS COMPLETED                                         #Y30OEAC*/
*/*                                                          #Y30OEAC*/
*/********************************************************** #Y30OEAC*/
*                                                                  0647
*   RFY                             /*                       #Y30OEAC*/
*    (REG14,                        /*                       #Y30OEAC*/
*     REG15) RSTD;                  /* RESTRICT REGISTERS    #Y30OEAC*/
*   GEN(EXCP  (IOBSTPTR));          /* EXECUTE CHANNEL PGM   #Y30OE95*/
         EXCP  (IOBSTPTR)
*   REG15=IOBECBPT;                 /* SET POINTER TO ECB    #Y30OEAC*/
         L     REG15,IOBECBPT(,IOBSTPTR)                           0649
*   GEN(WAIT  ECB=(REG15));         /* WAIT FOR I/O COMPLETE #Y30OE95*/
         WAIT  ECB=(REG15)
*   RFY                             /*                       @Y30OEAC*/
*    (REG14,                        /*                       @Y30OEAC*/
*     REG15) UNRSTD;                /* RELEASE REGISTERS     @Y30OEAC*/
*   END IOSBRTN;                    /*                       @Y30OE95*/
@EL00014 DS    0H                                                  0652
@EF00014 DS    0H                                                  0652
@ER00014 BR    @14                                                 0652
*   END IOESDKTI                    /*                       @Y30OEAC*/
*                                                                  0653
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*                                                                  0653
*       ;                                                          0653
@DATA    DS    0H
@CH00050 DC    H'1'
@CH00228 DC    H'3'
@CH00155 DC    H'5'
@CH00422 DC    H'6'
@CH01998 DC    H'22'
@CH01593 DC    H'28'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    1F
@SA00003 DS    1F
@SA00011 DS    1F
@SA00010 DS    1F
@SA00007 DS    1F
@SA00013 DS    1F
@SA00008 DS    1F
@SA00012 DS    0F
         DS    1F
@TF00001 DS    F
IOESDKTI CSECT
         DS    0F
@CF02069 DC    F'-8'
@DATD    DSECT
         DS    0D
IOBPRPTR DS    A
DEBDAPTR DS    A
DEBEXPTR DS    A
DEBSBPTR DS    A
DCBPTR   DS    A
UCBPTR   DS    A
         DS    0D
@TS00001 DS    CL8
EXTNUM   DS    BL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IOESDKTI CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01787 DC    V(IOEDKMSG)
         DS    0D
BYTCNT80 DC    H'80'
MAXRECL  DC    H'128'
CLEAR    DC    AL2(0)
MSGOPT   DS    CL45
         ORG   MSGOPT
MSGDSID  DS    CL10
         ORG   MSGDSID
DSIDLEN  DC    X'0A'
DSIDKEY  DC    X'06'
         ORG   DSIDKEY
DSIDLOP  DS    BL1
         ORG   MSGDSID+2
DSIDTXT  DS    CL8
         ORG   MSGOPT+10
MSGSER   DS    CL8
         ORG   MSGSER
SERLEN   DC    X'08'
SERKEY   DC    X'01'
SERTXT   DS    CL6
         ORG   MSGOPT+18
MSGVOLDS DS    CL10
         ORG   MSGVOLDS
VOLDSLEN DC    X'0A'
VOLDSKEY DC    X'0A'
VOLDSTXT DS    CL8
         ORG   MSGOPT+28
MSGDEVAD DS    CL5
         ORG   MSGDEVAD
DEVADLEN DC    X'05'
DEVADKEY DC    X'08'
DEVADTXT DS    CL3
         ORG   MSGOPT+33
MSGJOBNM DS    CL10
         ORG   MSGJOBNM
JOBNMLEN DC    X'0A'
JOBNMKEY DC    X'0B'
         ORG   JOBNMKEY
JOBNMLOP DS    BL1
         ORG   MSGJOBNM+2
JOBNMTXT DS    CL8
         ORG   MSGOPT+43
MSGEND   DS    CL2
         ORG   MSGEND
ENDLEN   DC    X'02'
ENDKEY   DC    X'7F'
         ORG   MSGOPT+45
BLANKDSK DC    X'0404'
SECUREDS DC    X'0408'
SECUREVL DC    X'040C'
DFNOP2   DC    X'1A800000'
DFNOP1   DC    X'1AA00000'
         DS    CL3
CCWDFOP1 DS    CL8
         ORG   CCWDFOP1
CCWOP1   DC    X'2F'
CCWADDR1 DC    AL3(DFNOP1)
CCWFLAG1 DC    X'60'
@NM00083 DC    X'00'
CCWCNT1  DC    X'0004'
         ORG   CCWDFOP1+8
CCWDFOP2 DS    CL8
         ORG   CCWDFOP2
CCWOP2   DC    X'2F'
CCWADDR2 DC    AL3(DFNOP2)
CCWFLAG2 DC    X'20'
@NM00084 DC    X'00'
CCWCNT2  DC    X'0004'
         ORG   CCWDFOP2+8
CCWNOOP  DS    CL8
         ORG   CCWNOOP
CCWOP3   DC    X'03'
@NM00085 DC    AL3(0)
CCWFLAG3 DC    X'20'
@NM00086 DC    X'00'
CCWCNT3  DC    X'0001'
         ORG   CCWNOOP+8
SER      DC    CL8'VOLUME  '
DSID     DC    CL8'DATA SET'
ENDDSKT  DC    CL6'/*DSKT'
RSRVTRK  DC    CL2'74'
LASTSECT DC    CL2'26'
VOL1     DC    CL4'VOL1'
HDR1     DC    CL4'HDR1'
CHAR01   DC    CL2'01'
CHAR99   DC    CL2'99'
BLNKDSID DS    CL8
         ORG   BLNKDSID
BLNKVLID DC    CL6'      '
BLNKVLSQ DC    CL2'  '
         ORG   BLNKDSID+8
MT3540AR DC    CL200' '
         DS    CL2
CP0001@  DC    AL4(OPENDS)
         DC    AL4(EOV)
         DC    AL4(CLOSEDS)
         DC    AL4(FEED)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
REG1     EQU   @01
SETDSKPT EQU   @02
IOBSTPTR EQU   @04
CHNPGMPT EQU   @05
HDR1PTR  EQU   @06
AMWRKPTR EQU   @07
VOL1PTR  EQU   @09
CHARPTR  EQU   @11
LOCKREG  EQU   @11
DEBPTR   EQU   @11
REG14    EQU   @14
REG15    EQU   @15
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
IOBPREFX EQU   0
IOBCFLG1 EQU   IOBPREFX
IOBSTDRD EQU   0
IOBFLAG1 EQU   IOBSTDRD
IOBCYCCK EQU   IOBFLAG1
IOBRSTRT EQU   IOBFLAG1
IOBFLAG2 EQU   IOBSTDRD+1
IOBPURGE EQU   IOBFLAG2
IOBRDHA0 EQU   IOBFLAG2
IOBSENS0 EQU   IOBSTDRD+2
IOBS0B7  EQU   IOBSENS0
IOBSENS1 EQU   IOBSTDRD+3
IOBECBPT EQU   IOBSTDRD+4
IOBECBPB EQU   IOBECBPT+1
IOBFLAG3 EQU   IOBSTDRD+8
IOBFL3   EQU   IOBFLAG3
IOBCSW   EQU   IOBSTDRD+9
IOBIOCSW EQU   IOBCSW
IOBSTART EQU   IOBSTDRD+16
IOBSTRTB EQU   IOBSTART+1
IOBDCBPT EQU   IOBSTDRD+20
IOBFLAG4 EQU   IOBDCBPT
IOBRESTR EQU   IOBSTDRD+24
IOBINCAM EQU   IOBSTDRD+28
IOBBTAMF EQU   IOBINCAM
DEBBASIC EQU   0
DEBTCBAD EQU   DEBBASIC
DEBDEBAD EQU   DEBBASIC+4
DEBIRBAD EQU   DEBBASIC+8
DEBOFLGS EQU   DEBIRBAD
DEBOPATB EQU   DEBBASIC+12
DEBFLGS1 EQU   DEBBASIC+14
DEBUSRPG EQU   DEBBASIC+16
DEBRRQ   EQU   DEBBASIC+20
DEBECBAD EQU   DEBRRQ
DEBDCBAD EQU   DEBBASIC+24
DEBPROTG EQU   DEBDCBAD
DEBAPPAD EQU   DEBBASIC+28
DEBBASND EQU   DEBBASIC+32
DEBDASD  EQU   0
DEBUCBAD EQU   DEBDASD
DEBACSMD EQU   0
DEBVOLSQ EQU   DEBACSMD
DEBVOLBT EQU   DEBVOLSQ
DEBDSNM  EQU   DEBACSMD+4
DEBUTSAA EQU   DEBDSNM
DEBACS01 EQU   0
DEBDSNAM EQU   DEBACS01
DEBACS02 EQU   0
DEBDBLK  EQU   DEBACS02
DEBACS03 EQU   0
DEBACS04 EQU   0
DEBTBFRA EQU   DEBACS04
DEBTCCWA EQU   DEBACS04+4
DEBACS05 EQU   0
DEBFUCBA EQU   DEBACS05
DEBLUCBA EQU   DEBACS05+4
DEBACS06 EQU   0
DEBACS07 EQU   0
DEBACS08 EQU   0
DEBSUBNM EQU   0
DEB      EQU   0
DEBAVT   EQU   DEB
DEBEOEA  EQU   DEBAVT
DEBEOEAB EQU   DEBEOEA
DEBSIOA  EQU   DEBAVT+4
DEBSIOAB EQU   DEBSIOA
DEBPCIA  EQU   DEBAVT+8
DEBPCIAB EQU   DEBPCIA
DEBCEA   EQU   DEBAVT+12
DEBCEAB  EQU   DEBCEA
DEBXCEA  EQU   DEBAVT+16
DEBXCEAB EQU   DEBXCEA
DEBPREFX EQU   DEB+20
DEBXTNP  EQU   DEBPREFX+8
DEBXTN   EQU   0
DEBXFLG1 EQU   DEBXTN+2
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFEC  EQU   DCBIFLGS
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00029 EQU   IHADCS40+12
DCBEROPT EQU   @NM00029
UCB      EQU   0
UCBLOCK  EQU   UCB+504
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBNOTRD EQU   UCBNRY
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBNAME  EQU   UCBOB+13
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00036 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBVLSER EQU   UCB3540X
UCBDKBYT EQU   UCB3540X+6
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
AMWORKAR EQU   0
JAMWKAR  EQU   AMWORKAR+4
IOBNO    EQU   JAMWKAR
IOBPTR   EQU   JAMWKAR+1
CCWPTR   EQU   JAMWKAR+5
WORKAREA EQU   JAMWKAR+16
AMW3540E EQU   AMWORKAR+120
AMWVOLAC EQU   AMW3540E
AMWDSSQL EQU   AMW3540E+1
AMWVSEQU EQU   AMW3540E+2
AMWEAMFG EQU   AMW3540E+3
AMWMULTI EQU   AMWEAMFG
AMWDSOPN EQU   AMWEAMFG
AMWVAMSG EQU   AMWEAMFG
AMWDSID  EQU   AMW3540E+4
AMWEOD   EQU   AMW3540E+12
AMWBOE   EQU   AMWEOD
AMWEODRV EQU   AMWBOE
AMWEODTT EQU   AMWBOE+1
AMWEOD0  EQU   AMWBOE+2
AMWEODSS EQU   AMWBOE+3
ACB35EXT EQU   AMWORKAR+136
ACBJOBID EQU   ACB35EXT+8
ACB35IND EQU   ACB35EXT+22
ACBLRECL EQU   AMWORKAR+162
EXLIST   EQU   AMWORKAR+164
RPLFIELD EQU   AMWORKAR+172
PRLOPTBT EQU   RPLFIELD+8
RPLFDBK  EQU   RPLFIELD+9
SETDLIST EQU   AMWORKAR+184
SETDWORK EQU   AMWORKAR+200
SIOB1PTR EQU   SETDWORK
HDR1SAV  EQU   SETDWORK+4
CCW21SAV EQU   SETDWORK+8
CCW26SAV EQU   SETDWORK+16
I        EQU   SETDWORK+24
J        EQU   SETDWORK+28
PURGELST EQU   SETDWORK+32
PURGEDEB EQU   PURGELST
PRGOPT   EQU   PURGEDEB
PRGDEB   EQU   PURGEDEB+1
PURGEWPT EQU   PURGELST+8
PURGEWKA EQU   PURGELST+12
MSGAREA  EQU   SETDWORK+48
MSGLIST  EQU   MSGAREA
MSGINDEX EQU   MSGLIST
MSGTYPCD EQU   MSGLIST+1
MSGDCBAD EQU   MSGLIST+4
MSGREPAD EQU   MSGLIST+8
MSGTEXT  EQU   MSGAREA+12
SECURIN  EQU   SETDWORK+105
SECURCD  EQU   SETDWORK+106
WORKFLAG EQU   SETDWORK+108
BLANKCHR EQU   WORKFLAG
BADVOLID EQU   WORKFLAG
OVERLAP  EQU   WORKFLAG
DSETFND  EQU   WORKFLAG
DUPDSID  EQU   WORKFLAG
BLNKDSKT EQU   WORKFLAG
ONLYDSET EQU   WORKFLAG
GOODVOL1 EQU   WORKFLAG
GOODHDR1 EQU   WORKFLAG+1
RETRY    EQU   WORKFLAG+1
SECVOL   EQU   WORKFLAG+1
VALIDREP EQU   WORKFLAG+1
BADBLKLN EQU   WORKFLAG+1
FEEDREAD EQU   WORKFLAG+1
VOLUPDTE EQU   WORKFLAG+1
NOTREADY EQU   WORKFLAG+1
SAVEBOE  EQU   SETDWORK+110
SAVEEOD  EQU   SETDWORK+115
SAVEEOE  EQU   SETDWORK+120
EOECC    EQU   SAVEEOE
EOERR    EQU   SAVEEOE+3
CONVERT  EQU   SETDWORK+126
CONVERT1 EQU   SETDWORK+130
TEMP1    EQU   SETDWORK+132
TEMP2    EQU   SETDWORK+134
VOLSERID EQU   SETDWORK+136
REPLYAR  EQU   0
CHANPGM  EQU   0
CHARACTR EQU   0
ECBMAP   EQU   0
ECBCC    EQU   ECBMAP
SETDISKT EQU   0
SETOPCDE EQU   SETDISKT
SETFLAGS EQU   SETDISKT+1
SDKTVFYI EQU   SETFLAGS
SETRETCD EQU   SETDISKT+2
ERTNCDE  EQU   SETRETCD
ERTNCDQL EQU   SETRETCD+1
SDKTDCB  EQU   SETDISKT+4
SDKTDSID EQU   SETDISKT+8
VOL13540 EQU   0
VOLLABID EQU   VOL13540
VOLID    EQU   VOL13540+4
VOLACCIN EQU   VOL13540+10
VOLLABVR EQU   VOL13540+79
HDR13540 EQU   0
HDRID    EQU   HDR13540
HDRDSID  EQU   HDR13540+5
HDRBLKLN EQU   HDR13540+22
HDRBOE   EQU   HDR13540+28
HDRBOECC EQU   HDRBOE
HDRBOEH  EQU   HDRBOE+2
HDRBOERR EQU   HDRBOE+3
HDREOE   EQU   HDR13540+34
HDREOECC EQU   HDREOE
HDREOEH  EQU   HDREOE+2
HDREOERR EQU   HDREOE+3
HDRBYPAS EQU   HDR13540+40
HDRSECIN EQU   HDR13540+41
HDRINTCH EQU   HDR13540+43
HDRMVLI  EQU   HDR13540+44
HDRVOLSQ EQU   HDR13540+45
HDREXDTE EQU   HDR13540+66
HDRVERFY EQU   HDR13540+72
HDREOD   EQU   HDR13540+74
HDREODCC EQU   HDREOD
HDREODH  EQU   HDREOD+2
HDREODRR EQU   HDREOD+3
BOECHAR  EQU   0
EOECHAR  EQU   0
EODCHAR  EQU   0
CL0001@  EQU   0
UCBBGN   EQU   0
IOBORG01 EQU   IOBPREFX+8
IOBNIOBA EQU   IOBORG01
IOBNFLG1 EQU   IOBNIOBA
IOBORG02 EQU   IOBPREFX+8
IOBDQADA EQU   IOBORG02
IOBDEQIN EQU   IOBDQADA
IOBORG03 EQU   IOBPREFX+12
IOBORG04 EQU   IOBINCAM
IOBORG12 EQU   IOBINCAM
IOBFL4   EQU   IOBORG12
IOBEXTEN EQU   IOBSTDRD+32
IOBSEEK  EQU   IOBEXTEN
IOBBB    EQU   IOBSEEK+1
IOBCC    EQU   IOBSEEK+3
IOBHH    EQU   IOBSEEK+5
IOBORG05 EQU   IOBEXTEN
IOBORG06 EQU   IOBEXTEN
IOBNXTPT EQU   IOBORG06+4
IOBSTATA EQU   IOBNXTPT
IOBORG07 EQU   IOBEXTEN+8
W1IEXTEN EQU   IOBORG07
IOBORG08 EQU   IOBEXTEN+8
IOBINDCT EQU   IOBORG08+4
IOBUNSQR EQU   IOBORG08+5
IOBFCHAD EQU   IOBORG08+8
IOBORG09 EQU   IOBEXTEN+8
IOBDPLAD EQU   IOBORG09+4
IOBDTYPE EQU   IOBORG09+8
IOBDTYP2 EQU   IOBORG09+9
IOBDSTAT EQU   IOBORG09+10
IOBSTAT1 EQU   IOBDSTAT
IOBORG10 EQU   IOBEXTEN+8
IOBSEEK2 EQU   IOBORG10
IOBORG11 EQU   IOBEXTEN
IOBERCT  EQU   IOBORG11
IOBUCBXV EQU   IOBERCT
IOBNAME  EQU   IOBORG11+4
IOBORG13 EQU   IOBEXTEN
IOBSKADR EQU   IOBORG13
IOBSKTT  EQU   IOBSKADR+1
IOBSKSS  EQU   IOBSKADR+3
DEBBAS02 EQU   DEBBASND
DEBDDS1  EQU   DEBBAS02
DEBSUCBA EQU   DEBDDS1
DEBDEVED EQU   DEBDDS1+4
DEBRDCB  EQU   DEBDDS1+4
DEBPDCB  EQU   DEBDDS1+8
DEBWDCB  EQU   DEBDDS1+12
DEBACS09 EQU   DEBDEVED
DEBASC09 EQU   DEBACS09
DEBEAMFG EQU   DEBASC09+3
DEBDSID  EQU   DEBASC09+4
DEBEOD   EQU   DEBASC09+12
DEBBOE   EQU   DEBEOD
DEBEODRV EQU   DEBBOE
DEBEODTT EQU   DEBBOE+1
DEBEOD0  EQU   DEBBOE+2
DEBEODSS EQU   DEBBOE+3
DEBBAS01 EQU   DEBBASND
DEBISAM  EQU   DEBBAS01
DEBFIEAD EQU   DEBISAM
DEBFPEAD EQU   DEBISAM+4
DEBFOEAD EQU   DEBISAM+8
DEBEXPT  EQU   DEBISAM+12
DEBRPSID EQU   DEBEXPT
UCBOBS01 EQU   UCBDEV
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00035 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBOBS09 EQU   UCBDEV
PSARSVTE EQU   PSARSVT
DCBAMWRK EQU   DCBIOBAD
DCBFLAGS EQU   DCBAMWRK
DCBAMWKA EQU   DCBAMWRK+1
FLC      EQU   PSA
*                                      START UNREFERENCED COMPONENTS
DCBAMOUT EQU   DCBFLAGS
DCBAMIN  EQU   DCBFLAGS
DCB3540A EQU   DCBFLAGS
@NM00071 EQU   DCBFLAGS
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00035
UCBSKPFG EQU   @NM00035
UCBRIPND EQU   @NM00035
UCBRTIAC EQU   @NM00035
UCBRSV79 EQU   @NM00035
UCBRSV78 EQU   @NM00035
UCBRSV77 EQU   @NM00035
UCBOLTEP EQU   @NM00035
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00034 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
UCBVTOC  EQU   UCBOBS01
DEBEXPTA EQU   DEBEXPT+1
DEBRSV12 EQU   DEBRPSID
DEBRSV11 EQU   DEBRPSID
DEBRSV10 EQU   DEBRPSID
DEBRSV09 EQU   DEBRPSID
DEBRPSAP EQU   DEBRPSID
DEBRPSO  EQU   DEBRPSID
DEBRPSI  EQU   DEBRPSID
DEBRPSP  EQU   DEBRPSID
DEBFOEB  EQU   DEBFOEAD+1
DEBNOEE  EQU   DEBFOEAD
DEBFPEB  EQU   DEBFPEAD+1
DEBNPEE  EQU   DEBFPEAD
DEBFIEB  EQU   DEBFIEAD+1
DEBNIEE  EQU   DEBFIEAD
DEBBOESS EQU   DEBEODSS
DEBBOE0  EQU   DEBEOD0
DEBBOETT EQU   DEBEODTT
DEBBOERV EQU   DEBEODRV
DEBRV008 EQU   DEBDSID+7
DEBWTPTI EQU   DEBDSID+6
DEBEXDTE EQU   DEBDSID
DEBRV007 EQU   DEBEAMFG
DEBRV006 EQU   DEBEAMFG
DEBRV005 EQU   DEBEAMFG
DEBRV004 EQU   DEBEAMFG
DEBSECVL EQU   DEBEAMFG
DEBVAMSG EQU   DEBEAMFG
DEBDSOPN EQU   DEBEAMFG
DEBMULTI EQU   DEBEAMFG
DEBVSEQU EQU   DEBASC09+2
DEBDSSQL EQU   DEBASC09+1
DEBVOLAC EQU   DEBASC09
DEBWDCBA EQU   DEBWDCB+1
DEBRSV08 EQU   DEBWDCB
DEBPDCBA EQU   DEBPDCB+1
DEBRSV07 EQU   DEBPDCB
DEBRDCBA EQU   DEBRDCB+1
DEBRSV06 EQU   DEBRDCB
DEBSUCBB EQU   DEBSUCBA+1
DEBSDVM  EQU   DEBSUCBA
IOBSK0   EQU   IOBSKADR+2
IOBSKRV  EQU   IOBSKADR
IOBCSWSV EQU   IOBORG11+17
IOBSENSV EQU   IOBORG11+16
IOBRCD   EQU   IOBORG11+12
IOBMDREC EQU   IOBORG11+8
IOBNAMEA EQU   IOBNAME+1
IOBNAMSZ EQU   IOBNAME
IOBERCTA EQU   IOBERCT+1
IOBRTYPE EQU   IOBUCBXV
IOBRDCHP EQU   IOBORG10+20
IOBNEXTA EQU   IOBORG10+16
IOBREADA EQU   IOBORG10+12
IOBBUFC  EQU   IOBORG10+8
IOBSK2R  EQU   IOBSEEK2+7
IOBSK2HH EQU   IOBSEEK2+5
IOBSK2CC EQU   IOBSEEK2+3
IOBSK2BB EQU   IOBSEEK2+1
IOBSK2M  EQU   IOBSEEK2
IOBCHNPR EQU   IOBORG09+40
IOBDNCRF EQU   IOBORG09+32
IOBRSV35 EQU   IOBORG09+24
IOBDQPTR EQU   IOBORG09+20
IOBRSV34 EQU   IOBORG09+18
IOBDBYTN EQU   IOBORG09+16
IOBDCPND EQU   IOBORG09+12
IOBSTAT2 EQU   IOBDSTAT+1
IOBSIORT EQU   IOBSTAT1
IOBADDVU EQU   IOBSTAT1
IOBBUFF  EQU   IOBSTAT1
IOBENQUE EQU   IOBSTAT1
IOBPASS2 EQU   IOBSTAT1
IOBSYNCH EQU   IOBSTAT1
IOBNEWVL EQU   IOBSTAT1
IOBABNRM EQU   IOBSTAT1
IOBRELEX EQU   IOBDTYP2
IOBADDTY EQU   IOBDTYP2
IOBTYPE  EQU   IOBDTYP2
IOBRQUST EQU   IOBDTYP2
IOBSUFFX EQU   IOBDTYP2
IOBSBLKL EQU   IOBDTYP2
IOBSKEY  EQU   IOBDTYP2
IOBRELBL EQU   IOBDTYPE
IOBRDEXC EQU   IOBDTYPE
IOBDYNBF EQU   IOBDTYPE
IOBACTAD EQU   IOBDTYPE
IOBFDBCK EQU   IOBDTYPE
IOBEXTSC EQU   IOBDTYPE
IOBOVFLO EQU   IOBDTYPE
IOBVERFY EQU   IOBDTYPE
IOBDPLB  EQU   IOBDPLAD+1
IOBDAYLI EQU   IOBDPLAD
IOBDIOBS EQU   IOBORG09+2
IOBDBYTR EQU   IOBORG09
IOBBCHAD EQU   IOBORG08+12
IOBFCHNB EQU   IOBFCHAD+1
IOBCOUNT EQU   IOBFCHAD
IOBASYN  EQU   IOBORG08+7
IOBAPP   EQU   IOBORG08+6
IOBRSV32 EQU   IOBUNSQR
IOBRSV31 EQU   IOBUNSQR
IOBRSV30 EQU   IOBUNSQR
IOBKNRWR EQU   IOBUNSQR
IOBKNWR  EQU   IOBUNSQR
IOBNTAV2 EQU   IOBUNSQR
IOBNTAV1 EQU   IOBUNSQR
IOBCPBSY EQU   IOBUNSQR
IOBCHNNL EQU   IOBINDCT
IOBRSV29 EQU   IOBINDCT
IOBRSV28 EQU   IOBINDCT
IOBRSV27 EQU   IOBINDCT
IOBKEYAD EQU   IOBINDCT
IOBOVPTR EQU   IOBINDCT
IOBUNSCH EQU   IOBINDCT
IOBDEQCP EQU   IOBINDCT
IOBCCWAD EQU   IOBORG08
W1OEXTEN EQU   W1IEXTEN
IOBCCW   EQU   IOBORG06+8
IOBNXTPB EQU   IOBNXTPT+1
IOBRSV26 EQU   IOBSTATA
IOBRSV25 EQU   IOBSTATA
IOBRSV24 EQU   IOBSTATA
IOBRSV23 EQU   IOBSTATA
IOBRSV22 EQU   IOBSTATA
IOBRSV21 EQU   IOBSTATA
IOBRSV20 EQU   IOBSTATA
IOBAVLFL EQU   IOBSTATA
IOBRSV37 EQU   IOBORG06+1
IOBUCBXG EQU   IOBORG06
IOBCPA   EQU   IOBORG05+32
IOBERINF EQU   IOBORG05+16
IOBERCCW EQU   IOBORG05+8
IOBSNDPT EQU   IOBORG05+7
IOBRCVPT EQU   IOBORG05+6
IOBWORK  EQU   IOBORG05+1
IOBUCBX  EQU   IOBORG05
IOBR     EQU   IOBSEEK+7
IOBHH2   EQU   IOBHH+1
IOBHH1   EQU   IOBHH
IOBCC2   EQU   IOBCC+1
IOBCC1   EQU   IOBCC
IOBBB2   EQU   IOBBB+1
IOBBB1   EQU   IOBBB
IOBM     EQU   IOBSEEK
IOBRSV46 EQU   IOBFL4
IOBRSV47 EQU   IOBFL4
IOBENT   EQU   IOBFL4
IOBEQP   EQU   IOBFL4
IOBBUS   EQU   IOBFL4
IOBDCK   EQU   IOBFL4
IOBREJ   EQU   IOBFL4
IOBOVR   EQU   IOBFL4
IOBCRILC EQU   IOBORG04+1
IOBCRDCC EQU   IOBORG04
IOBGQECB EQU   IOBORG03
IOBSWAP  EQU   IOBORG02+4
IOBDQADB EQU   IOBDQADA+1
IOBRSV13 EQU   IOBDEQIN
IOBRSV12 EQU   IOBDEQIN
IOBRSV11 EQU   IOBDEQIN
IOBRSV10 EQU   IOBDEQIN
IOBRSV09 EQU   IOBDEQIN
IOBRSV08 EQU   IOBDEQIN
IOBRSV07 EQU   IOBDEQIN
IOBDEQ   EQU   IOBDEQIN
IOBNECB  EQU   IOBORG01+4
IOBNIOBB EQU   IOBNIOBA+1
IOBFIRST EQU   IOBNFLG1
IOBUPERR EQU   IOBNFLG1
IOBSPAN  EQU   IOBNFLG1
IOBBKSPC EQU   IOBNFLG1
IOBUPDAT EQU   IOBNFLG1
IOBREAD  EQU   IOBNFLG1
IOBWRITE EQU   IOBNFLG1
IOBPRTOV EQU   IOBNFLG1
HDRCONTI EQU   HDR13540+79
@NM00082 EQU   HDR13540+73
HDRDAY   EQU   HDREXDTE+4
HDRMONTH EQU   HDREXDTE+2
HDRYEAR  EQU   HDREXDTE
@NM00081 EQU   HDR13540+53
HDRDSCD  EQU   HDR13540+47
HDRWTPTI EQU   HDR13540+42
@NM00080 EQU   HDR13540+39
@NM00079 EQU   HDR13540+33
@NM00078 EQU   HDR13540+27
@NM00077 EQU   HDR13540+13
@NM00076 EQU   HDR13540+4
@NM00075 EQU   VOL13540+78
VOLRECSQ EQU   VOL13540+76
@NM00074 EQU   VOL13540+51
VOLOWNID EQU   VOL13540+37
@NM00073 EQU   VOL13540+11
@NM00072 EQU   SETFLAGS
ECBRBA   EQU   ECBMAP+1
BUFFER2  EQU   AMWORKAR+4488
CCWS2    EQU   AMWORKAR+4256
IOB2     EQU   AMWORKAR+4208
BUFFER1  EQU   AMWORKAR+880
CCWS1    EQU   AMWORKAR+648
IOB1     EQU   AMWORKAR+600
@NM00070 EQU   SETDWORK+142
@NM00069 EQU   SETDWORK+125
EOEH     EQU   SAVEEOE+2
MSGRTCDE EQU   MSGLIST+2
PURGETCB EQU   PURGELST+4
SETDDSID EQU   SETDLIST+8
SETDDCB  EQU   SETDLIST+4
SETDRTNC EQU   SETDLIST+2
SETDVERY EQU   SETDLIST+1
SETDOPCD EQU   SETDLIST
@NM00068 EQU   RPLFDBK+2
RPLFDBK2 EQU   RPLFDBK+1
RPLFDBK1 EQU   RPLFDBK
@NM00067 EQU   PRLOPTBT
RPLEODS  EQU   PRLOPTBT
RPLAREA  EQU   RPLFIELD+4
RPLRLEN  EQU   RPLFIELD
EXLEODP  EQU   EXLIST+4
EXLSYNP  EQU   EXLIST
@NM00066 EQU   AMWORKAR+160
@NM00065 EQU   ACB35IND
ACBSECUR EQU   ACB35IND
ACBFEED  EQU   ACB35IND
ACBVSSER EQU   ACB35EXT+16
ACBDSID  EQU   ACB35EXT
AMWBOESS EQU   AMWEODSS
AMWBOE0  EQU   AMWEOD0
AMWBOETT EQU   AMWEODTT
AMWBOERV EQU   AMWEODRV
@NM00064 EQU   AMWEAMFG
REGSAVE  EQU   WORKAREA+28
WORKBSL  EQU   WORKAREA
IOBBFLN  EQU   JAMWKAR+13
@NM00063 EQU   JAMWKAR+12
IOB1ADDR EQU   JAMWKAR+9
@NM00062 EQU   JAMWKAR+8
@NM00061 EQU   JAMWKAR+4
AMWLEN   EQU   AMWORKAR
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00036
UCBHALI  EQU   @NM00036
UCBRSV09 EQU   @NM00036
UCBRSV08 EQU   @NM00036
UCBRSV07 EQU   @NM00036
UCBRSV06 EQU   @NM00036
UCBRSV05 EQU   @NM00036
UCBRSV04 EQU   @NM00036
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBFLB7  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBPXST  EQU   UCB+504
@NM00033 EQU   UCB
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00032 EQU   IHADCS40+16
@NM00031 EQU   @NM00029+1
@NM00030 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
@NM00028 EQU   IHADCS40+10
@NM00027 EQU   IHADCS40+9
@NM00026 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00025 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
DCBLRECL EQU   IHADCS38+10
@NM00024 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00023 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00022 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00021 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00020 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBBLKSI EQU   IHADCS36+10
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00019 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00018 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
@NM00017 EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00016 EQU   DCBPUT
DCBREADA EQU   DCBWRITA
@NM00015 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00014 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00013 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBIBPCT EQU   DCBIFLG
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00012 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00011 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00010 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00009 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
DCBDSGMQ EQU   DCBDSRG1
DCBDSGCQ EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRBAL EQU   IHADCS01+6
@NM00008 EQU   IHADCS01+5
@NM00007 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00006 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00005 EQU   IHADCB
DEBXRV40 EQU   DEBXTN+28
DEBXRV39 EQU   DEBXTN+24
DEBXXARG EQU   DEBXTN+20
DEBXMCF2 EQU   DEBXTN+19
DEBXMCF1 EQU   DEBXTN+18
DEBXDSO2 EQU   DEBXTN+17
DEBXDSO1 EQU   DEBXTN+16
DEBXDBPR EQU   DEBXTN+12
DEBXDCBM EQU   DEBXTN+8
DEBXDSAB EQU   DEBXTN+4
DEBXRV48 EQU   DEBXTN+3
DEBXRV47 EQU   DEBXFLG1
DEBXRV46 EQU   DEBXFLG1
DEBXRV45 EQU   DEBXFLG1
DEBXRV44 EQU   DEBXFLG1
DEBXRV43 EQU   DEBXFLG1
DEBXRV42 EQU   DEBXFLG1
DEBXTSKC EQU   DEBXFLG1
DEBXCDCB EQU   DEBXFLG1
DEBXLNGH EQU   DEBXTN
DEBTBLOF EQU   DEBPREFX+14
DEBAMTYP EQU   DEBPREFX+13
DEBLNGTH EQU   DEBPREFX+12
DEBDCBMK EQU   DEBXTNP
DEBDSCBA EQU   DEBPREFX+1
DEBWKARA EQU   DEBPREFX
DEBXCEAD EQU   DEBXCEA+1
DEBXCENP EQU   DEBXCEAB
DEBRSV35 EQU   DEBXCEAB
DEBRSV34 EQU   DEBXCEAB
DEBRSV33 EQU   DEBXCEAB
DEBRSV32 EQU   DEBXCEAB
DEBCEAD  EQU   DEBCEA+1
DEBCENP  EQU   DEBCEAB
DEBRSV31 EQU   DEBCEAB
DEBRSV30 EQU   DEBCEAB
DEBRSV29 EQU   DEBCEAB
DEBRSV28 EQU   DEBCEAB
DEBPCIAD EQU   DEBPCIA+1
DEBPCINP EQU   DEBPCIAB
DEBRSV27 EQU   DEBPCIAB
DEBRSV26 EQU   DEBPCIAB
DEBRSV25 EQU   DEBPCIAB
DEBRSV24 EQU   DEBPCIAB
DEBSIOAD EQU   DEBSIOA+1
DEBSIONP EQU   DEBSIOAB
DEBFIX   EQU   DEBSIOAB
DEBIOVR  EQU   DEBSIOAB
DEBSIOX  EQU   DEBSIOAB
DEBPGFX  EQU   DEBSIOAB
DEBEOEAD EQU   DEBEOEA+1
DEBEOENP EQU   DEBEOEAB
DEBRSV22 EQU   DEBEOEAB
DEBRSV21 EQU   DEBEOEAB
DEBRSV20 EQU   DEBEOEAB
DEBRSV19 EQU   DEBEOEAB
DEBSUBID EQU   DEBSUBNM
DEBSIOA2 EQU   DEBACS08+24
DEBRPSIO EQU   DEBACS08+20
DEBFREED EQU   DEBACS08+16
@NM00004 EQU   DEBACS08+12
@NM00003 EQU   DEBACS08+8
DEBDISAD EQU   DEBACS08+4
@NM00002 EQU   DEBACS08
DEBRPSST EQU   DEBACS07+64
DEBARECK EQU   DEBACS07+60
DEBAREWT EQU   DEBACS07+56
DEBACHK  EQU   DEBACS07+52
DEBAWRIT EQU   DEBACS07+48
DEBASETL EQU   DEBACS07+44
DEBAREAD EQU   DEBACS07+40
DEBCRECK EQU   DEBACS07+36
DEBCREWT EQU   DEBACS07+32
DEBCCHK  EQU   DEBACS07+28
DEBCWRIT EQU   DEBACS07+24
DEBCSETL EQU   DEBACS07+20
DEBCREAD EQU   DEBACS07+16
DEBWKPT5 EQU   DEBACS07+12
DEBWKPT4 EQU   DEBACS07+8
DEBGET   EQU   DEBACS07+4
@NM00001 EQU   DEBACS07
DEBPUT   EQU   DEBACS06+4
DEBDCBFA EQU   DEBACS06
DEBLUCBB EQU   DEBLUCBA+1
DEBRSV18 EQU   DEBLUCBA
DEBFUCBB EQU   DEBFUCBA+1
DEBRSV17 EQU   DEBFUCBA
DEBTCCWB EQU   DEBTCCWA+1
DEBRSV16 EQU   DEBTCCWA
DEBTBFRB EQU   DEBTBFRA+1
DEBRSV15 EQU   DEBTBFRA
DEBDBPEF EQU   DEBACS03+8
DEBDBPP  EQU   DEBACS03+4
DEBDTPP  EQU   DEBACS03
DEBDBPE  EQU   DEBDBLK+1
DEBDBPT  EQU   DEBDBLK
DEBEXTNM EQU   DEBDSNAM
DEBRSV14 EQU   DEBDSNM+4
DEBUTSAB EQU   DEBUTSAA+1
DEBRSV13 EQU   DEBUTSAA
DEBVOLNM EQU   DEBACSMD+2
DEBVLSEQ EQU   DEBVOLSQ+1
DEBRSV42 EQU   DEBVOLBT
DEBRSV41 EQU   DEBVOLBT
DEBRSV40 EQU   DEBVOLBT
DEBRSV39 EQU   DEBVOLBT
DEBRSV38 EQU   DEBVOLBT
DEBRSV37 EQU   DEBVOLBT
DEBRSV36 EQU   DEBVOLBT
DEBEXFUL EQU   DEBVOLBT
DEBNMTRK EQU   DEBDASD+14
DEBENDHH EQU   DEBDASD+12
DEBENDCC EQU   DEBDASD+10
DEBSTRHH EQU   DEBDASD+8
DEBSTRCC EQU   DEBDASD+6
DEBBINUM EQU   DEBDASD+4
DEBUCBA  EQU   DEBUCBAD+1
DEBDVMOD EQU   DEBUCBAD
DEBAPPB  EQU   DEBAPPAD+1
DEBEXSCL EQU   DEBAPPAD
DEBDCBB  EQU   DEBDCBAD+1
DEBDEBID EQU   DEBPROTG
DEBECBB  EQU   DEBECBAD+1
DEBPRIOR EQU   DEBECBAD
DEBUSRPB EQU   DEBUSRPG+1
DEBNMEXT EQU   DEBUSRPG
DEBRSV05 EQU   DEBBASIC+15
DEBXTNIN EQU   DEBFLGS1
DEBAPFIN EQU   DEBFLGS1
DEBF1CEV EQU   DEBFLGS1
DEBCINDI EQU   DEBFLGS1
DEBRSV02 EQU   DEBFLGS1
DEBRSIOA EQU   DEBFLGS1
DEBEOFDF EQU   DEBFLGS1
DEBPWCKD EQU   DEBFLGS1
DEBQSCNT EQU   DEBBASIC+13
DEBACCS  EQU   DEBOPATB
DEBPOSIT EQU   DEBOPATB
DEBZERO  EQU   DEBOPATB
DEBABEND EQU   DEBOPATB
DEBIRBB  EQU   DEBIRBAD+1
DEBRERR  EQU   DEBOFLGS
DEBLABEL EQU   DEBOFLGS
DEBSPLIT EQU   DEBOFLGS
DEBDCB   EQU   DEBOFLGS
DEBRLSE  EQU   DEBOFLGS
DEBEOF   EQU   DEBOFLGS
DEBDISP  EQU   DEBOFLGS
DEBDEBB  EQU   DEBDEBAD+1
DEBAMLNG EQU   DEBDEBAD
DEBTCBB  EQU   DEBTCBAD+1
DEBNMSUB EQU   DEBTCBAD
IOBERRCT EQU   IOBSTDRD+30
IOBRSV19 EQU   IOBINCAM+1
IOBOLTST EQU   IOBBTAMF
IOBRFTMG EQU   IOBBTAMF
IOBRSV17 EQU   IOBBTAMF
IOBRSV16 EQU   IOBBTAMF
IOBRSV15 EQU   IOBBTAMF
IOBRSV14 EQU   IOBBTAMF
IOBINUSE EQU   IOBBTAMF
IOBPRMER EQU   IOBBTAMF
IOBRSTRB EQU   IOBRESTR+1
IOBREPOS EQU   IOBRESTR
IOBDCBPB EQU   IOBDCBPT+1
IOBRSV44 EQU   IOBFLAG4
IOBJES3I EQU   IOBFLAG4
IOBRSV42 EQU   IOBFLAG4
IOBRSV41 EQU   IOBFLAG4
IOBRSV40 EQU   IOBFLAG4
IOBPMERR EQU   IOBFLAG4
IOBCC3WE EQU   IOBFLAG4
IOBGDPOL EQU   IOBFLAG4
IOBSIOCC EQU   IOBSTART
IOBSTBYT EQU   IOBIOCSW+3
IOBCMDA  EQU   IOBIOCSW
IOBLOG   EQU   IOBFL3
IOBICL   EQU   IOBFL3
IOBMSG   EQU   IOBFL3
IOBCNC   EQU   IOBFL3
IOBACU   EQU   IOBFL3
IOBCDC   EQU   IOBFL3
IOBICC   EQU   IOBFL3
IOBCCC   EQU   IOBFL3
IOBECBCC EQU   IOBECBPT
IOBS1B7  EQU   IOBSENS1
IOBS1B6  EQU   IOBSENS1
IOBS1B5  EQU   IOBSENS1
IOBS1B4  EQU   IOBSENS1
IOBS1B3  EQU   IOBSENS1
IOBS1B2  EQU   IOBSENS1
IOBS1B1  EQU   IOBSENS1
IOBS1B0  EQU   IOBSENS1
IOBSNSC9 EQU   IOBS0B7
IOBS0B6  EQU   IOBSENS0
IOBS0B5  EQU   IOBSENS0
IOBS0B4  EQU   IOBSENS0
IOBS0B3  EQU   IOBSENS0
IOBS0B2  EQU   IOBSENS0
IOBS0B1  EQU   IOBSENS0
IOBS0B0  EQU   IOBSENS0
IOBPNCH  EQU   IOBFLAG2
IOBSTATO EQU   IOBFLAG2
IOBSKUPD EQU   IOBFLAG2
IOBALTTR EQU   IOBFLAG2
IOBRRT2  EQU   IOBRDHA0
IOBRRT3  EQU   IOBPURGE
IOBSENSE EQU   IOBFLAG2
IOBHALT  EQU   IOBFLAG2
IOBSPSVC EQU   IOBRSTRT
IOBUNREL EQU   IOBFLAG1
IOBIOERR EQU   IOBFLAG1
IOBFCREX EQU   IOBCYCCK
IOBRPSTN EQU   IOBFLAG1
IOBERRTN EQU   IOBFLAG1
IOBCMDCH EQU   IOBFLAG1
IOBDATCH EQU   IOBFLAG1
IOBCNOPA EQU   IOBPREFX+12
IOBCICB  EQU   IOBPREFX+8
IOBCECB  EQU   IOBPREFX+4
IOBCONOP EQU   IOBPREFX+3
IOBCINOP EQU   IOBPREFX+2
IOBRSV05 EQU   IOBPREFX+1
IOBPCI   EQU   IOBCFLG1
IOBRSTCH EQU   IOBCFLG1
IOBABAPP EQU   IOBCFLG1
IOBPTST  EQU   IOBCFLG1
IOBRSV04 EQU   IOBCFLG1
IOBRSV03 EQU   IOBCFLG1
IOBRSV02 EQU   IOBCFLG1
IOBRSV01 EQU   IOBCFLG1
@NM00060 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00059 EQU   PSA+1040
PSAUSEND EQU   PSA+1040
PSARV062 EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSALITA  EQU   PSA+764
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00058 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00057 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSARV013 EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSARV011 EQU   PSASUP3
PSARV010 EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSAIPCRP EQU   PSASUP1
PSAIPCDR EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00056 EQU   FLCFSA
@NM00055 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00054 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00053 EQU   FLCIOA
@NM00052 EQU   FLCMCLA+15
@NM00051 EQU   FLCMCLA+14
@NM00050 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00049 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00048 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00047 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00046 EQU   FLCPER
@NM00045 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00044 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00043 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00042 EQU   FLCPIILC
@NM00041 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00040 EQU   FLCSVILC
@NM00039 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00038 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00037 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
*                                      END UNREFERENCED COMPONENTS
@RT00139 EQU   LOOP1
@RF00185 EQU   @RC00181
@RF00184 EQU   @RC00181
@RF00191 EQU   @RC00181
@RT00202 EQU   LOOP
@RC00212 EQU   @RC00211
@RF00247 EQU   @EL00002
@RF00280 EQU   @EL00002
@RC00299 EQU   @RC00298
@RC00343 EQU   @RC00342
@RC00336 EQU   @EL00004
@RF00441 EQU   @EL00005
@RC00498 EQU   @RC00491
@RF00526 EQU   @RC00522
@RF00605 EQU   @EL00011
@PB00014 EQU   @EL00001
@RC00213 EQU   @RC00212
@RF00363 EQU   @RC00336
@RC00356 EQU   @RC00336
@PB00013 EQU   @PB00014
@RC00359 EQU   @RC00356
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
CE0001@  EQU   @PB00002
@RF00114 EQU   CE0001@
@RF00117 EQU   CE0001@
@RF00128 EQU   CE0001@
@RF00132 EQU   CE0001@
@RF00161 EQU   CE0001@
@RC00145 EQU   CE0001@
@RF00205 EQU   CE0001@
@RF00221 EQU   CE0001@
@RF00231 EQU   CE0001@
@RF00153 EQU   @RC00145
@ENDDATA EQU   *
         END   IOESDKTI,(C'PLS1328',0701,76126)

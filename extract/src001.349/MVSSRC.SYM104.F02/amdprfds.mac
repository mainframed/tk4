         TITLE 'AMDPRFDS -- FAST DUMP/SCAN MODULE                      *
                        '
AMDPRFDS CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'AMDPRFDS  76.265'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @10,4095(,@11)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*                                                          /*@Y30DI3D*/
   DCBD  DSORG=PS,DEVD=(DA)                                    @Y30DI3D
AMDPRFDS  CSECT                                                @Y30DI3D
   USING  IHADCB,R8                                            @Y30DI3D
*   IF RDRSW=ON THEN                /* IF OFF,BRANCH AROUND CODE   0038
*                                                            @Y30DI3D*/
         TM    RDRSW(COMBASE),B'00000001'                          0038
         BNO   @RF00038                                            0038
*     DO;                           /*                       @Y30DI3D*/
*       REG8=ARDRDCB;               /* GET ADDR OF SYSIN DCB FROM  0040
*                                      COMMON, MODIFY EODAD AND SYNAD
*                                      ROUTINES TO USE FDS BASE    0040
*                                      REGISTER                      */
         L     REG8,ARDRDCB(,COMBASE)                              0040
*       SAVE1=DCBEODA;              /* SAVE ADDRESS OF CALLER'S    0041
*                                      RDRDCB EODAD ROUTINE          */
         MVC   SAVE1(3),DCBEODA                                    0041
*       DCBEODA=ADDR(FDSEOF);       /* REPLACE WITH FDS'S EODAD    0042
*                                      ROUTINE               @Y30DI3D*/
         LA    @05,FDSEOF                                          0042
         STCM  @05,7,DCBEODA                                       0042
*       SAVE2=DCBSYNA;              /* SAVE ADDRESS OF CALLER'S    0043
*                                      RDRDCB SYNAD ROUTINE          */
         MVC   SAVE2(3),DCBSYNA                                    0043
*       DCBSYNA=ADDR(FDSYNAD);      /* REPLACE WITH FDS'S SYNAD    0044
*                                      ROUTINE                       */
         LA    @05,FDSYNAD                                         0044
         STCM  @05,7,DCBSYNA                                       0044
*     END;                          /*                       @Y30DI3D*/
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*      INITIALIZATIONS                                     @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0046
*   SYNTAXCD=GOOD;                  /* NO SYNTAX ERRORS YET  @Y30DI3D*/
@RF00038 MVI   SYNTAXCD,X'00'                                      0046
*   LASTASID=QASID;                 /* NEEDED FOR FIRST PASS @UZ08993*/
         MVC   LASTASID(2),QASID(COMBASE)                          0047
*   THISASID=QASID;                 /* INIT FOR LIST         @UZ08993*/
         MVC   THISASID(2),QASID(COMBASE)                          0048
*   FDSON=ON;                       /* INIT FOR READING ALL CONTROL
*                                      STATEMENTS                    */
*   HCOPYON=OFF;                    /*                       @Y30DI3D*/
         OI    FDSON,B'01000000'                                   0050
         NI    HCOPYON,B'01111111'                                 0050
*   OUTBUFAD=CURBUF;                /* INIT FOR BRWRITES     @Y30DI3D*/
         L     @00,CURBUF(,COMBASE)                                0051
         ST    @00,OUTBUFAD                                        0051
*   PREVSET=NO;                     /* INIT FOR HCOPY COMMENTS     0052
*                                      STARTING WITH 'ON'            */
         NI    PREVSET,B'11111101'                                 0052
*   CC=BLANK1;                      /* INIT CONTROL CHAR FOR BRWRITES
*                                                            @Y30DI3D*/
         LR    @15,@00                                             0053
         MVI   CC(@15),C' '                                        0053
*   THISMSG=BLANK80;                /* INIT FOR REPLY MESSAGE      0054
*                                                            @Y30DI3D*/
         MVC   THISMSG(80),BLANK80                                 0054
*   PREVADDR=ERRADDR;               /* SAVE PREVIOUS BRREAD ERROR  0055
*                                      ROUTINE               @Y30DI3D*/
         L     PREVADDR,ERRADDR(,COMBASE)                          0055
*/*  MODIFY NONBLNK TO SCAN FOR DELIMETERS,SET ZERO CODE TO '0'      */
*                                                                  0056
*   GEN REFS(NONBLNK);                                             0056
*                                                          /*@Y30DI3D*/
         OC    NONBLNK(256,COMBASE),DLIMTBL
         NI    NONBLNK+64(COMBASE),X'0'
*                                                                  0057
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*   OPEN ROUTINE FOR TSO TERMINAL                          @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0057
*   GEN REFS(TSODCB) FLOWS(TSOERR)(OPEN (TSODCB,OUTPUT));/*  @Y30DI3D*/
         OPEN (TSODCB,OUTPUT)
*   REG8=ADDR(TSODCB);              /* CHANGE BASE REG FOR DCBD    0058
*                                      REFERENCE                     */
         LA    @15,TSODCB                                          0058
         LR    REG8,@15                                            0058
*   IF DCBOPEN=ON THEN              /* TERMINAL IS AVAILABLE @Y30DI3D*/
         TM    DCBOPEN+48(@15),B'00010000'                         0059
         BNO   @RF00059                                            0059
*     TERMINAL=OPEN;                /*                       @Y30DI3D*/
         OI    TERMINAL,B'10000000'                                0060
*   ELSE                                                           0061
*     TERMINAL=CLOSED;              /* TERMINAL NOT AVAILABLE      0061
*                                                            @Y30DI3D*/
         B     @RC00059                                            0061
@RF00059 NI    TERMINAL,B'01111111'                                0061
*   GOTO FDSBGN;                    /*                       @Y30DI3D*/
         B     FDSBGN                                              0062
*TSOERR:                                                           0063
*   MSGAREA=BLANK80;                /*                       @Y30DI3D*/
TSOERR   L     @05,OUTBUFAD                                        0063
         MVC   MSGAREA(80,@05),BLANK80                             0063
*   MSGAREA(1:64)=IOMSG2;           /*                       @Y30DI3D*/
         MVI   MSGAREA+60(@05),C' '                                0064
         MVC   MSGAREA+61(3,@05),MSGAREA+60(@05)                   0064
         MVC   MSGAREA(60,@05),IOMSG2                              0064
*   GEN REFS(AEREXIT,AWRITE) EXIT NOSEQFLOW;                       0065
*                                                          /*@Y30DI3D*/
         BRWRITE 1         WRITE I/O ERROR MESSAGE
         L     R13,4(R13)  RESTORE REGISTERS
         LM    R14,R12,12(R13)
         LA    R1,4        LOAD CODE FOR NO I/O MESSAGE
         L     R15,AEREXIT(,COMBASE)  PROVIDE EXIT TO TERMINATE PGM
         BR    R15         BRANCH TO ERROR EXIT ROUTINE
*                                                                  0066
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*   MAIN CALLING ROUTINE - ALL SUBVERB SUBROUTINES ARE CALLED      */
*/*   FROM HERE AND FDS PASSES CONTROL BACK TO AMDPRCTL WHEN @Y30DI3D*/
*/*   'RETURN' IS ENCOUNTERED                                @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0066
*FDSBGN:                                                           0066
*   IF TERMINAL=OPEN THEN           /* WRITE REPLY MESSAGE TO      0066
*                                      TERMINAL              @Y30DI3D*/
FDSBGN   TM    TERMINAL,B'10000000'                                0066
         BNO   @RF00066                                            0066
*     DO;                           /*                       @Y30DI3D*/
*       THISMSG(1:37)=RPLYMSG;      /* LOAD MESSAGE BUFFER   @Y30DI3D*/
         MVC   THISMSG(37),RPLYMSG                                 0068
*       MSGADDR=ADDR(THISMSG);      /* LOAD ADDR OF MSG BUFFER     0069
*                                                            @Y30DI3D*/
         LA    MSGADDR,THISMSG                                     0069
*       CALL WRITRTN;               /*                       @Y30DI3D*/
         BAL   @14,WRITRTN                                         0070
*       MSGADDR=ADDR(BLANK80);      /* SKIP LINE AFTER MESSAGE     0071
*                                                            @Y30DI3D*/
         LA    MSGADDR,BLANK80                                     0071
*       CALL WRITRTN;               /*                       @Y30DI3D*/
         BAL   @14,WRITRTN                                         0072
*     END;                          /*                       @Y30DI3D*/
*   DO WHILE FDSON=ON;              /* EXEC UNTIL DISPLAY END      0074
*                                                            @Y30DI3D*/
@RF00066 B     @DE00074                                            0074
@DL00074 DS    0H                                                  0075
*     CALL READVERB;                /* READ NEXT DISPLAY STATEMENT 0075
*                                                            @Y30DI3D*/
         BAL   @14,READVERB                                        0075
*     CALL VERBTEST;                /* RETURN AND SCAN VERB  @Y30DI3D*/
         BAL   @14,VERBTEST                                        0076
*     IF SYNTAXCD=GOOD THEN         /* EXECUTE ROUTINE               */
         CLI   SYNTAXCD,X'00'                                      0077
         BNE   @RF00077                                            0077
*       IF SUBVERB=HCOPY THEN       /* GO EXECUTE DISPLAY HARDCOPY   */
         CLI   SUBVERB,X'01'                                       0078
         BNE   @RF00078                                            0078
*         CALL HCOPYRTN;            /*                       @Y30DI3D*/
         BAL   @14,HCOPYRTN                                        0079
*       ELSE                                                       0080
*         IF SUBVERB=ENDSVERB THEN  /* SVERB=END---END AMDPRFDS      */
         B     @RC00078                                            0080
@RF00078 CLI   SUBVERB,X'02'                                       0080
         BNE   @RF00080                                            0080
*           FDSON=OFF;              /*                       @Y30DI3D*/
         NI    FDSON,B'10111111'                                   0081
*         ELSE                                                     0082
*           IF SUBVERB=LISTVERB THEN/* EXECUTE DISPLAY STORAGE       */
         B     @RC00080                                            0082
@RF00080 CLI   SUBVERB,X'03'                                       0082
         BNE   @RF00082                                            0082
*             CALL STORTN;          /*                       @Y30DI3D*/
         BAL   @14,STORTN                                          0083
*           ELSE                                                   0084
*             IF SUBVERB=EQUAT THEN /* EXECUTE EQUATE        @Y30DI3D*/
         B     @RC00082                                            0084
@RF00082 CLI   SUBVERB,X'04'                                       0084
         BNE   @RF00084                                            0084
*               CALL EQUATRTN;      /*                       @Y30DI3D*/
         BAL   @14,EQUATRTN                                        0085
*             ELSE                                                 0086
*               CALL COMMRTN;       /* EXECUTE COMMENT       @Y30DI3D*/
         B     @RC00084                                            0086
@RF00084 BAL   @14,COMMRTN                                         0086
*     ELSE                                                         0087
*       ;                           /*                       @Y30DI3D*/
@RF00077 DS    0H                                                  0088
*     IF SYNTAXCD^=GOOD THEN        /* ERROR DURING EXECUTION      0088
*                                                            @Y30DI3D*/
@RC00077 CLI   SYNTAXCD,X'00'                                      0088
         BE    @RF00088                                            0088
*       CALL ERRORTN;               /* PRINT ERROR MESSAGE   @Y30DI3D*/
         BAL   @14,ERRORTN                                         0089
*     ELSE                                                         0090
*       ;                           /*                       @Y30DI3D*/
@RF00088 DS    0H                                                  0091
*   END;                            /*                       @Y30DI3D*/
@DE00074 TM    FDSON,B'01000000'                                   0091
         BO    @DL00074                                            0091
*   IF RDRSW=ON THEN                /* IF OFF,BRANCH AROUND CODE   0092
*                                                            @Y30DI3D*/
         TM    RDRSW(COMBASE),B'00000001'                          0092
         BNO   @RF00092                                            0092
*     DO;                           /*                       @Y30DI3D*/
*       REG8=ARDRDCB;               /* CHANGE BASE REG FOR DCBD    0094
*                                      REFERENCE             @Y30DI3D*/
         L     REG8,ARDRDCB(,COMBASE)                              0094
*       DCBEODA=SAVE1;              /* RESTORE CALLER'S EODAD ROUTINE
*                                                            @Y30DI3D*/
         MVC   DCBEODA(3),SAVE1                                    0095
*       DCBSYNA=SAVE2;              /* RESTORE CALLER'S SYNAD ROUTINE
*                                                            @Y30DI3D*/
         MVC   DCBSYNA(3),SAVE2                                    0096
*     END;                          /*                       @Y30DI3D*/
*   ERRADDR=PREVADDR;               /* RESTORE PREVIOUS BRREAD ERROR
*                                      ROUTINE                       */
@RF00092 ST    PREVADDR,ERRADDR(,COMBASE)                          0098
*/*  RESTORE NONBLNK                                         @Y30DI3D*/
*                                                                  0099
*   GEN REFS(NONBLNK);                                             0099
*                                                          /*@Y30DI3D*/
         OI    NONBLNK+64(COMBASE),X'0C'
         XC    NONBLNK(193,COMBASE),DLIMTBL
*   IF TERMINAL=OPEN THEN           /* CLOSE TERMINAL DCB    @Y30DI3D*/
         TM    TERMINAL,B'10000000'                                0100
         BNO   @RF00100                                            0100
*     GEN REFS(TSODCB)(CLOSE (TSODCB));/*                    @Y30DI3D*/
         CLOSE (TSODCB)
*   RETURN;                         /* RETURN TO AMDPRCTL    @Y30DI3D*/
@EL00001 L     @13,4(,@13)                                         0102
@EF00001 DS    0H                                                  0102
@ER00001 LM    @14,@12,12(@13)                                     0102
         BR    @14                                                 0102
*                                                                  0103
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*   FIND SOURCE OF DISPLAY VERB THEN READ INTO BUFFER      @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0103
*READVERB:                                                         0103
*   PROCEDURE;                      /*                       @Y30DI3D*/
         B     @EL00001                                            0103
READVERB STM   @14,@12,@SA00002                                    0103
*   RESPECIFY                                                      0104
*    (R2,                                                          0104
*     R3) RESTRICTED;               /*                       @Y30DI3D*/
*   IF RDRSW=ON THEN                /* READ FROM SYSIN       @Y30DI3D*/
         TM    RDRSW(COMBASE),B'00000001'                          0105
         BNO   @RF00105                                            0105
*     DO;                           /* READ STATEMENT INTO WTOR    0106
*                                      BUFFER                @Y30DI3D*/
*       GEN FLOWS(FDSYNAD,FDSEOF) REFS(ARDRDCB);                   0107
*                                                          /*@Y30DI3D*/
         L     R1,ARDRDCB(,COMBASE)        LOAD PARAMETER REG1 @Y30DI3D
         LA    R0,WTORMSG(,COMBASE)        LOAD PARAMETER REG0 @Y30DI3D
         L     R15,48(R0,R1)               LOAD GET ROUTINE ADDRESS
         BALR  R14,R15                     LINK TO GET ROUTINE @Y30DI3D
*       SAVEWTOR=ADDR(WTORMSG)+81;  /* SAVE ADDR OF END OF BUFFER    */
         LA    @05,WTORMSG(,COMBASE)                               0108
         AH    @05,@CH00152                                        0108
         ST    @05,SAVEWTOR                                        0108
*     END;                          /*                       @Y30DI3D*/
*   ELSE                            /* ASK OPERATOR FOR VERB @Y30DI3D*/
*     DO;                           /*                       @Y30DI3D*/
         B     @RC00105                                            0110
@RF00105 DS    0H                                                  0111
*       WTORMSG=BLANK4;             /* CLEAR BUFFER          @Y30DI3D*/
         MVC   WTORMSG(81,COMBASE),BLANK4                          0111
*       R2=ADDR(WTORMSG);           /* GET ADDRESS OF WTORMSG      0112
*                                                            @Y30DI3D*/
         LA    R2,WTORMSG(,COMBASE)                                0112
*       R3=ADDR(WTORECB1);          /* GET ADDRESS OF WTORECB1       */
         LA    R3,WTORECB1                                         0113
*       GEN;                                                       0114
*                                                          /*@Y30DI3D*/
             WTOR   'REPLY WITH DESIRED FUNCTION OR RETURN',   @Y30DI3DX
               (R2),71,(R3),ROUTCDE=(1),DESC=2                 @Y30DI3D
             WAIT   ECB=WTORECB1                               @Y30DI3D
         MVI   WTORECB1,0        CLEAR COMPLETION CODE
*       SAVEWTOR=ADDR(WTORMSG)+81;  /* SAVE ADDR OF END OF BUFFER    */
         LA    @05,WTORMSG(,COMBASE)                               0115
         AH    @05,@CH00152                                        0115
         ST    @05,SAVEWTOR                                        0115
*     END;                          /*                       @Y30DI3D*/
*   RESPECIFY                                                      0117
*    (R2,                                                          0117
*     R3) UNRESTRICTED;             /*                       @Y30DI3D*/
*   GOTO ENDRDVB;                   /*                       @Y30DI3D*/
         B     ENDRDVB                                             0118
*FDSEOF:                            /* FDS EODAD ROUTINE     @Y30DI3D*/
*   MSGAREA=BLANK80;                /* CLEAR MESSAGE BUFFER  @Y30DI3D*/
FDSEOF   L     @05,OUTBUFAD                                        0119
         MVC   MSGAREA(80,@05),BLANK80                             0119
*   MSGAREA(1:35)=EOFMSG;           /* INSERT EOF MESSAGE    @Y30DI3D*/
         MVC   MSGAREA(35,@05),EOFMSG                              0120
*   MSGADDR=ADDR(MSGAREA);          /*                       @Y30DI3D*/
         LA    MSGADDR,MSGAREA(,@05)                               0121
*   IF TERMINAL=OPEN THEN                                          0122
         TM    TERMINAL,B'10000000'                                0122
         BNO   @RF00122                                            0122
*     GEN REFS(TSODCB) FLOWS(TSOERR)(PUT TSODCB,(MSGADDR));/*      0123
*                                                            @Y30DI3D*/
         PUT TSODCB,(MSGADDR)
*   ELSE                                                           0124
*     GEN REFS(AWRITE)(BRWRITE 1);  /* PRINT MESSAGE ON PRINTER      */
         B     @RC00122                                            0124
@RF00122 DS    0H                                                  0124
         BRWRITE 1
*   GEN REFS(AEREXIT) EXIT NOSEQFLOW;                              0125
@RC00122 DS    0H                                                  0125
*                                                          /*@Y30DI3D*/
         L     R13,4(R13)        RESTORE REGISTERS
         LM    R14,R12,12(R13)
         LA    R1,4              LOAD CODE FOR NO MESSAGE
         L     R15,AEREXIT(,COMBASE)  PROVIDE EXIT TO TERMINATE PGM
         BR    R15               BRANCH TO ERROR EXIT ROUTINE
*FDSYNAD:                           /* FDS SYSIN SYNAD ROUTINE     0126
*                                                            @Y30DI3D*/
*   MSGAREA=BLANK80;                /* CLEAR MESSAGE BUFFER  @Y30DI3D*/
FDSYNAD  L     @05,OUTBUFAD                                        0126
         MVC   MSGAREA(80,@05),BLANK80                             0126
*   MSGAREA(1:60)=IOMSG1;           /* INSERT I/O ERROR MESSAGE    0127
*                                                            @Y30DI3D*/
         MVC   MSGAREA(60,@05),IOMSG1                              0127
*   MSGADDR=ADDR(MSGAREA);          /*                       @Y30DI3D*/
         LA    MSGADDR,MSGAREA(,@05)                               0128
*   IF TERMINAL=OPEN THEN                                          0129
         TM    TERMINAL,B'10000000'                                0129
         BNO   @RF00129                                            0129
*     GEN REFS(TSODCB) FLOWS(TSOERR)(PUT TSODCB,(MSGADDR));/*      0130
*                                                            @Y30DI3D*/
         PUT TSODCB,(MSGADDR)
*   ELSE                                                           0131
*     GEN REFS(AWRITE)(BRWRITE 1);  /*                       @Y30DI3D*/
         B     @RC00129                                            0131
@RF00129 DS    0H                                                  0131
         BRWRITE 1
*   GEN REFS(AEREXIT) EXIT NOSEQFLOW;                              0132
@RC00129 DS    0H                                                  0132
*                                                          /*@Y30DI3D*/
         L     R13,4(R13)        RESTORE REGISTERS
         LM    R14,R12,12(R13)
         LA    R1,4              LOAD CODE FOR NO MESSAGE
         L     R15,AEREXIT(,COMBASE)  PROVIDE EXIT TO TERMINATE PGM
         BR    R15               BRANCH TO ERROR EXIT ROUTINE
*ENDRDVB:                                                          0133
*   END READVERB;                   /*                       @Y30DI3D*/
@EL00002 DS    0H                                                  0133
@EF00002 DS    0H                                                  0133
@ER00002 LM    @14,@12,@SA00002                                    0133
         BR    @14                                                 0133
*                                                                  0134
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*    SCAN FOR CORRECT SYNTAX ON SUBVERBS                   @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0134
*VERBTEST:                                                         0134
*   PROCEDURE;                      /*                       @Y30DI3D*/
VERBTEST STM   @14,@12,@SA00003                                    0134
*   SYNTAXCD=GOOD;                  /*                       @Y30DI3D*/
         MVI   SYNTAXCD,X'00'                                      0135
*   R1=0;                           /*                       @Y30DI3D*/
         SLR   R1,R1                                               0136
*   TRT(WTORMSG,NONBLNK);           /* SCAN BUFFER FOR 1ST NONBLNK 0137
*                                      CHARACTER                     */
         TRT   WTORMSG(81,COMBASE),NONBLNK(COMBASE)                0137
*   BC(8,VERBEOF);                  /* BUFFER BLANK,PRINT MESSAGE  0138
*                                                            @Y30DI3D*/
         BC    8,VERBEOF                                           0138
*   VERBGN=R1;                      /* ADDRESS OF 1ST NONBLANK     0139
*                                      CHARACTER                     */
         ST    R1,VERBGN(,COMBASE)                                 0139
*   VERBEND=VERBGN-1;               /* INIT VERBEND FOR FIRST DELIM
*                                      SCAN                          */
         L     @15,VERBGN(,COMBASE)                                0140
         BCTR  @15,0                                               0140
         ST    @15,VERBEND(,COMBASE)                               0140
*   CALL DLIMSCAN;                  /*                       @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0141
*   IF DELIMCD=BLANK THEN           /* SCAN FOR VERB         @Y30DI3D*/
         CLC   DELIMCD(4,COMBASE),@CF00242                         0142
         BNE   @RF00142                                            0142
*     IF OPSIZE=3&OPERAND(1:3)='RET'/* VERB=RETURN                   */
*         ×OPSIZE=6&OPERAND(1:6)='RETURN' THEN                     0143
         CH    OPSIZE,@CH00150                                     0143
         BNE   @GL00001                                            0143
         L     @15,VERBGN(,COMBASE)                                0143
         CLC   OPERAND(3,@15),@CC00661                             0143
         BE    @RT00143                                            0143
@GL00001 CH    OPSIZE,@CH00387                                     0143
         BNE   @RF00143                                            0143
         L     @15,VERBGN(,COMBASE)                                0143
         CLC   OPERAND(6,@15),@CC00662                             0143
         BNE   @RF00143                                            0143
@RT00143 DS    0H                                                  0144
*       SUBVERB=ENDSVERB;           /*                       @Y30DI3D*/
         MVI   SUBVERB,X'02'                                       0144
*     ELSE                                                         0145
*       IF OPSIZE=2&OPERAND(1:2)='HC'×OPSIZE=8&OPERAND(1:8)='HARDCOPY'
*         THEN                                                     0145
         B     @RC00143                                            0145
@RF00143 CH    OPSIZE,@CH00165                                     0145
         BNE   @GL00004                                            0145
         L     @15,VERBGN(,COMBASE)                                0145
         CLC   OPERAND(2,@15),@CC00663                             0145
         BE    @RT00145                                            0145
@GL00004 CH    OPSIZE,@CH00044                                     0145
         BNE   @RF00145                                            0145
         L     @15,VERBGN(,COMBASE)                                0145
         CLC   OPERAND(8,@15),@CC00664                             0145
         BNE   @RF00145                                            0145
@RT00145 DS    0H                                                  0146
*         SUBVERB=HCOPY;            /* SUBVERB=HARDCOPY      @Y30DI3D*/
         MVI   SUBVERB,X'01'                                       0146
*       ELSE                                                       0147
*         IF OPSIZE=1&OPERAND(1:1)='L'/* VERB=                       */
*             ×OPSIZE=4&OPERAND(1:4)='LIST' THEN/* LIST              */
         B     @RC00145                                            0147
@RF00145 CH    OPSIZE,@CH00058                                     0147
         BNE   @GL00007                                            0147
         L     @15,VERBGN(,COMBASE)                                0147
         CLI   OPERAND(@15),C'L'                                   0147
         BE    @RT00147                                            0147
@GL00007 CH    OPSIZE,@CH00157                                     0147
         BNE   @RF00147                                            0147
         L     @15,VERBGN(,COMBASE)                                0147
         CLC   OPERAND(4,@15),@CC00666                             0147
         BNE   @RF00147                                            0147
@RT00147 DS    0H                                                  0148
*           SUBVERB=LISTVERB;       /*                       @Y30DI3D*/
         MVI   SUBVERB,X'03'                                       0148
*         ELSE                                                     0149
*           IF OPSIZE=2&OPERAND(1:2)='EQ'/* VERB=                    */
*               ×OPSIZE=6&OPERAND(1:6)='EQUATE' THEN/* EQUATE        */
         B     @RC00147                                            0149
@RF00147 CH    OPSIZE,@CH00165                                     0149
         BNE   @GL00010                                            0149
         L     @15,VERBGN(,COMBASE)                                0149
         CLC   OPERAND(2,@15),@CC00667                             0149
         BE    @RT00149                                            0149
@GL00010 CH    OPSIZE,@CH00387                                     0149
         BNE   @RF00149                                            0149
         L     @15,VERBGN(,COMBASE)                                0149
         CLC   OPERAND(6,@15),@CC00668                             0149
         BNE   @RF00149                                            0149
@RT00149 DS    0H                                                  0150
*             SUBVERB=EQUAT;        /*                       @Y30DI3D*/
         MVI   SUBVERB,X'04'                                       0150
*           ELSE                                                   0151
*             IF OPSIZE=1&OPERAND(1)='C' THEN/* VERB=                */
         B     @RC00149                                            0151
@RF00149 CH    OPSIZE,@CH00058                                     0151
         BNE   @RF00151                                            0151
         L     @15,VERBGN(,COMBASE)                                0151
         CLI   OPERAND(@15),C'C'                                   0151
         BNE   @RF00151                                            0151
*               SUBVERB=COMNT;      /* C                     @Y30DI3D*/
         MVI   SUBVERB,X'05'                                       0152
*             ELSE                                                 0153
*               SYNTAXCD=INVSVRB;   /* INVALID VERB OR DELIMETER     */
         B     @RC00151                                            0153
@RF00151 MVI   SYNTAXCD,X'01'                                      0153
*   ELSE                                                           0154
*     SYNTAXCD=INVDELIM;            /* INVALID DELIMETER FOLLOWING 0154
*                                      VERB                          */
         B     @RC00142                                            0154
@RF00142 MVI   SYNTAXCD,X'02'                                      0154
*   GOTO ENDVRBT;                   /*                       @Y30DI3D*/
         B     ENDVRBT                                             0155
*VERBEOF:                                                          0156
*   SYNTAXCD=NOPARMS;               /* INPUT ALL BLANKS      @Y30DI3D*/
VERBEOF  MVI   SYNTAXCD,X'03'                                      0156
*ENDVRBT:                                                          0157
*   END VERBTEST;                   /*                       @Y30DI3D*/
@EL00003 DS    0H                                                  0157
@EF00003 DS    0H                                                  0157
@ER00003 LM    @14,@12,@SA00003                                    0157
         BR    @14                                                 0157
*                                                                  0158
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*   THIS ROUTINE SCANS THE 'HARDCOPY' SUBVERB              @Y30DI3D*/
*/*   HARDCOPY ON - SETS SWITCH TO WRITE ALL DUMPS ON PRINTER        */
*/*   HARDCOPY OFF - TURNS OFF SWITCH - NO PRINTER OUTPUT    @Y30DI3D*/
*/*   HARDCOPY - WRITES PREVIOUS DUMP DISPLAYED ON PRINTER   @Y30DI3D*/
*/*   HARDCOPY 'COMMENT' - WRITES USER'S COMMENT ON PRINTER  @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0158
*HCOPYRTN:                                                         0158
*   PROCEDURE;                      /*                       @Y30DI3D*/
HCOPYRTN STM   @14,@12,@SA00004                                    0158
*   VERBGN=VERBEND+1;               /* POSITION AFTER LAST DELIMETER */
         LA    @05,1                                               0159
         AL    @05,VERBEND(,COMBASE)                               0159
         ST    @05,VERBGN(,COMBASE)                                0159
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/
         LCR   @05,@05                                             0160
         AL    @05,SAVEWTOR                                        0160
         ST    @05,WTORSIZE                                        0160
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON BLANK      */
         L     @03,VERBGN(,COMBASE)                                0161
         L     @05,WTORSIZE                                        0161
         BCTR  @05,0                                               0161
         EX    @05,@SB00761                                        0161
*   BC(8,HCOPYNUL);                 /* NO ADDITIONAL PARM-PRINT DUMP */
         BC    8,HCOPYNUL                                          0162
*   VERBGN=R1;                      /*                       @Y30DI3D*/
         ST    R1,VERBGN(,COMBASE)                                 0163
*   SAVEBGN=VERBGN;                 /* SAVE FOR HC COMMENT   @Y30DI3D*/
         L     @15,VERBGN(,COMBASE)                                0164
         ST    @15,SAVEBGN                                         0164
*   VERBEND=R1-1;                   /* INIT VERBEND FOR DLIMSCAN   0165
*                                                            @Y30DI3D*/
         LR    @00,R1                                              0165
         BCTR  @00,0                                               0165
         ST    @00,VERBEND(,COMBASE)                               0165
*   CALL DLIMSCAN;                  /*                       @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0166
*   IF HCOPYON=ON THEN              /* SET SWITCH FOR COMMENT BEG  0167
*                                      WITH 'ON'                     */
         TM    HCOPYON,B'10000000'                                 0167
         BNO   @RF00167                                            0167
*     PREVSET=YES;                  /*                       @Y30DI3D*/
         OI    PREVSET,B'00000010'                                 0168
*   ELSE                            /* FOR COMMENT BEG WITH 'OFF'  0169
*                                                            @Y30DI3D*/
*     PREVSET=NO;                   /*                       @Y30DI3D*/
         B     @RC00167                                            0169
@RF00167 NI    PREVSET,B'11111101'                                 0169
*   IF DELIMCD=BLANK THEN                                          0170
@RC00167 CLC   DELIMCD(4,COMBASE),@CF00242                         0170
         BNE   @RF00170                                            0170
*     IF OPSIZE=2&OPERAND(1:2)='ON' THEN                           0171
         CH    OPSIZE,@CH00165                                     0171
         BNE   @RF00171                                            0171
         L     @15,VERBGN(,COMBASE)                                0171
         CLC   OPERAND(2,@15),@CC00677                             0171
         BNE   @RF00171                                            0171
*       HCOPYON=ON;                 /* OUTPUT TO PRINTER     @Y30DI3D*/
         OI    HCOPYON,B'10000000'                                 0172
*     ELSE                                                         0173
*       IF OPSIZE=3&OPERAND(1:3)='OFF' THEN                        0173
         B     @RC00171                                            0173
@RF00171 CH    OPSIZE,@CH00150                                     0173
         BNE   @RF00173                                            0173
         L     @15,VERBGN(,COMBASE)                                0173
         CLC   OPERAND(3,@15),@CC00678                             0173
         BNE   @RF00173                                            0173
*         HCOPYON=OFF;              /* NO OUTPUT TO PRINTER  @Y30DI3D*/
         NI    HCOPYON,B'01111111'                                 0174
*   VERBGN=VERBEND+1;               /* POSITION AFTER LAST DELIMETER */
@RF00173 DS    0H                                                  0175
@RC00171 DS    0H                                                  0175
@RF00170 LA    @05,1                                               0175
         AL    @05,VERBEND(,COMBASE)                               0175
         ST    @05,VERBGN(,COMBASE)                                0175
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/
         LCR   @05,@05                                             0176
         AL    @05,SAVEWTOR                                        0176
         ST    @05,WTORSIZE                                        0176
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR ADDITIONAL CHARS    */
         L     @03,VERBGN(,COMBASE)                                0177
         L     @05,WTORSIZE                                        0177
         BCTR  @05,0                                               0177
         EX    @05,@SB00761                                        0177
*   BC(8,ENDHC);                    /* NO MORE PARMS-THIS IS NOT A 0178
*                                      COMMENT                       */
         BC    8,ENDHC                                             0178
*   IF PREVSET=YES THEN                                            0179
         TM    PREVSET,B'00000010'                                 0179
         BNO   @RF00179                                            0179
*     HCOPYON=ON;                   /* RESET FOR 1ST WORD 'OFF'    0180
*                                                            @Y30DI3D*/
         OI    HCOPYON,B'10000000'                                 0180
*   ELSE                                                           0181
*     HCOPYON=OFF;                  /* RESET FOR 1ST WORD 'ON'     0181
*                                                            @Y30DI3D*/
         B     @RC00179                                            0181
@RF00179 NI    HCOPYON,B'01111111'                                 0181
*   VERBGN=SAVEBGN;                 /* RESTORE ORIGINAL VERBGN     0182
*                                                            @Y30DI3D*/
@RC00179 L     @00,SAVEBGN                                         0182
         ST    @00,VERBGN(,COMBASE)                                0182
*   COMSIZE=SAVEWTOR-VERBGN;        /* SIZE OF COMMENT       @Y30DI3D*/
         L     COMSIZE,SAVEWTOR                                    0183
         SLR   COMSIZE,@00                                         0183
*   COMMAREA=BLANK80;               /* CLEAR OUTPUT BUFFER   @Y30DI3D*/
         L     @15,OUTBUFAD                                        0184
         MVC   COMMAREA(80,@15),BLANK80                            0184
*   COMMAREA(1:COMSIZE)=OPERAND(1:COMSIZE);/* COMMENT TO OUTPUT BUF  */
         LR    @14,COMSIZE                                         0185
         BCTR  @14,0                                               0185
         LR    @07,@00                                             0185
         EX    @14,@SM00764                                        0185
*   GEN REFS(AWRITE)(BRWRITE 1);    /* WRITE COMMENT TO PRINTER      */
         BRWRITE 1
*HCOPYNUL:                          /* WRITE DUMP TO PRINTER @Y30DI3D*/
*   IF LINE>0 THEN                  /* DUMP HAS BEEN MADE    @Y30DI3D*/
HCOPYNUL ICM   @05,15,LINE                                         0187
         BNP   @RF00187                                            0187
*     DO RITE=1 TO LINE;            /*                       @Y30DI3D*/
         LA    RITE,1                                              0188
         B     @DE00188                                            0188
@DL00188 DS    0H                                                  0189
*       DATAREA=HCOPYBUF(RITE);     /* PUT DUMP LINE IN OUTPUT BUFFER*/
         L     @15,OUTBUFAD                                        0189
         LR    @14,RITE                                            0189
         MH    @14,@CH00382                                        0189
         LA    @07,HCOPYBUF-80(@14)                                0189
         MVC   DATAREA(80,@15),0(@07)                              0189
*       GEN REFS(AWRITE)(BRWRITE 1);/*                       @Y30DI3D*/
         BRWRITE 1
*     END;                          /*                       @Y30DI3D*/
         AH    RITE,@CH00058                                       0191
@DE00188 C     RITE,LINE                                           0191
         BNH   @DL00188                                            0191
*   COMMAREA=BLANK80;               /*                       @Y30DI3D*/
@RF00187 L     @05,OUTBUFAD                                        0192
         MVC   COMMAREA(80,@05),BLANK80                            0192
*   GEN REFS(AWRITE)(BRWRITE 1);    /* SKIP LINE             @Y30DI3D*/
         BRWRITE 1
*ENDHC:                                                            0194
*   END HCOPYRTN;                   /*                       @Y30DI3D*/
@EL00004 DS    0H                                                  0194
@EF00004 DS    0H                                                  0194
@ER00004 LM    @14,@12,@SA00004                                    0194
         BR    @14                                                 0194
*                                                                  0195
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/* THIS ROUTINE SCANS AND EXECUTES THE 'LIST' SUBVERB       @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0195
*STORTN:                                                           0195
*   PROCEDURE;                      /*                       @Y30DI3D*/
STORTN   STM   @14,@12,@SA00005                                    0195
*   OPSCAN=ON;                      /*                       @Y30DI3D*/
*   SIGNSW=OFF;                     /*                       @Y30DI3D*/
         OI    OPSCAN,B'00010000'                                  0197
         NI    SIGNSW,B'11110111'                                  0197
*   NONAME=NO;                      /*                       @Y30DI3D*/
         NI    NONAME,B'11011111'                                  0198
*   LEN1=0;                         /* INIT FOR NO DEFAULT LENGTH  0199
*                                                            @Y30DI3D*/
         SLR   @05,@05                                             0199
         ST    @05,LEN1                                            0199
*   ASIDSW=OFF;                     /* NO DEFAULT LENGTH     @Y30DI3D*/
         NI    ASIDSW,B'11011111'                                  0200
*   THISNAME=BLANK8;                /* CLEAR NAME BUFFER     @Y30DI3D*/
         MVC   THISNAME(8),BLANK8                                  0201
*   VERBGN=VERBEND+1;               /* POSITION AFTER LAST DELIMETER */
         LA    @05,1                                               0202
         AL    @05,VERBEND(,COMBASE)                               0202
         ST    @05,VERBGN(,COMBASE)                                0202
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/
         LCR   @05,@05                                             0203
         AL    @05,SAVEWTOR                                        0203
         ST    @05,WTORSIZE                                        0203
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON BLANK      */
         L     @03,VERBGN(,COMBASE)                                0204
         L     @05,WTORSIZE                                        0204
         BCTR  @05,0                                               0204
         EX    @05,@SB00761                                        0204
*   BC(8,LISTEOF);                  /* NO PARMS AFTER 'LIST' @Y30DI3D*/
         BC    8,LISTEOF                                           0205
*   VERBEND=R1-1;                   /* INIT VERBEND FOR DLIMSCAN   0206
*                                                            @Y30DI3D*/
         LR    @00,R1                                              0206
         BCTR  @00,0                                               0206
         ST    @00,VERBEND(,COMBASE)                               0206
*   CALL DLIMSCAN;                  /* GET ADDRESS           @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0207
*   IF DELIMCD=PERIOD THEN          /* DIRECT ADDRESSING USED      0208
*                                                            @Y30DI3D*/
         CLC   DELIMCD(4,COMBASE),@CF00414                         0208
         BNE   @RF00208                                            0208
*     DO;                           /*                       @Y30DI3D*/
*       NONAME=YES;                 /* DO NOT SCAN NAME TABLE      0210
*                                                            @Y30DI3D*/
         OI    NONAME,B'00100000'                                  0210
*       IF OPSIZE>0&OPSIZE<7 THEN                                  0211
         LTR   OPSIZE,OPSIZE                                       0211
         BNP   @RF00211                                            0211
         CH    OPSIZE,@CH00686                                     0211
         BNL   @RF00211                                            0211
*         DO;                       /*                       @Y30DI3D*/
*           CALL DIGITSCN;          /* CHECK FOR DIRECT ADDRESSING 0213
*                                                            @Y30DI3D*/
         BAL   @14,DIGITSCN                                        0213
*           IF SYNTAXCD=GOOD THEN                                  0214
         CLI   SYNTAXCD,X'00'                                      0214
         BNE   @RF00214                                            0214
*             DO;                   /*                       @Y30DI3D*/
*               LOADDR=GOODNUM;     /* DIRECT ADDRESSING USED      0216
*                                                            @Y30DI3D*/
         MVC   LOADDR(4),GOODNUM                                   0216
*               CALL DLIMSCAN;      /* SCAN FOR PLUS,MINUS,OR BLANK  */
         BAL   @14,DLIMSCAN                                        0217
*             END;                  /*                       @Y30DI3D*/
*           ELSE                                                   0219
*             ;                     /*                       @Y30DI3D*/
@RF00214 DS    0H                                                  0220
*         END;                      /*                       @Y30DI3D*/
*       ELSE                                                       0221
*         SYNTAXCD=INVADDR;         /* INVALID LENGTH ON ADDRESS     */
         B     @RC00211                                            0221
@RF00211 MVI   SYNTAXCD,X'05'                                      0221
*     END;                          /*                       @Y30DI3D*/
@RC00211 DS    0H                                                  0223
*   IF SYNTAXCD=GOOD THEN                                          0223
@RF00208 CLI   SYNTAXCD,X'00'                                      0223
         BNE   @RF00223                                            0223
*     IF DELIMCD=BLANK THEN         /* NO OFFSET             @Y30DI3D*/
         CLC   DELIMCD(4,COMBASE),@CF00242                         0224
         BNE   @RF00224                                            0224
*       IF OPSIZE>0&OPSIZE<9&NONAME=NO THEN/* RELATIVE ADDRESS       */
         LTR   OPSIZE,OPSIZE                                       0225
         BNP   @RF00225                                            0225
         CH    OPSIZE,@CH00172                                     0225
         BNL   @RF00225                                            0225
         TM    NONAME,B'00100000'                                  0225
         BNZ   @RF00225                                            0225
*         DO;                       /*                       @Y30DI3D*/
*           CALL NAMESCAN;          /* SCAN NAME TABLE FOR MATCH   0227
*                                                            @Y30DI3D*/
         BAL   @14,NAMESCAN                                        0227
*           IF SYNTAXCD=GOOD THEN                                  0228
         CLI   SYNTAXCD,X'00'                                      0228
         BNE   @RF00228                                            0228
*             LOADDR=GOODNUM;       /* STARTING ADDRESS      @Y30DI3D*/
         MVC   LOADDR(4),GOODNUM                                   0229
*           ELSE                                                   0230
*             ;                     /*                       @Y30DI3D*/
@RF00228 DS    0H                                                  0231
*         END;                      /*                       @Y30DI3D*/
*       ELSE                                                       0232
*         IF OPSIZE=0&NONAME=YES THEN                              0232
         B     @RC00225                                            0232
@RF00225 LTR   OPSIZE,OPSIZE                                       0232
         BNZ   @RF00232                                            0232
         TM    NONAME,B'00100000'                                  0232
         BO    @RT00232                                            0232
*           ;                       /* DIRECT ADDRESS        @Y30DI3D*/
*         ELSE                                                     0234
*           SYNTAXCD=INVPARM;       /* INVALID PARAMETER     @Y30DI3D*/
@RF00232 MVI   SYNTAXCD,X'08'                                      0234
*     ELSE                                                         0235
*       IF DELIMCD=PLUS×DELIMCD=MINUS THEN/* OFFSET USED     @Y30DI3D*/
         B     @RC00224                                            0235
@RF00224 L     @15,DELIMCD(,COMBASE)                               0235
         CH    @15,@CH00224                                        0235
         BE    @RT00235                                            0235
         CH    @15,@CH00412                                        0235
         BNE   @RF00235                                            0235
@RT00235 DS    0H                                                  0236
*         DO;                       /*                       @Y30DI3D*/
*           SIGN=DELIMCD;           /* SAVE SIGN FOR OFFSET  @Y30DI3D*/
         MVC   SIGN(4),DELIMCD(COMBASE)                            0237
*           SIGNSW=ON;              /* SET TO SCAN FOR OFFSET      0238
*                                                            @Y30DI3D*/
         OI    SIGNSW,B'00001000'                                  0238
*           IF OPSIZE>0&OPSIZE<9&NONAME=NO THEN/* RELATIVE ADDR      */
         LTR   OPSIZE,OPSIZE                                       0239
         BNP   @RF00239                                            0239
         CH    OPSIZE,@CH00172                                     0239
         BNL   @RF00239                                            0239
         TM    NONAME,B'00100000'                                  0239
         BNZ   @RF00239                                            0239
*             DO;                   /*                       @Y30DI3D*/
*               CALL NAMESCAN;      /* SCAN NAME TABLE       @Y30DI3D*/
         BAL   @14,NAMESCAN                                        0241
*               IF SYNTAXCD=GOOD THEN                              0242
         CLI   SYNTAXCD,X'00'                                      0242
         BNE   @RF00242                                            0242
*                 LOADDR=GOODNUM;   /*                       @Y30DI3D*/
         MVC   LOADDR(4),GOODNUM                                   0243
*               ELSE                                               0244
*                 ;                 /*                       @Y30DI3D*/
@RF00242 DS    0H                                                  0245
*             END;                  /*                       @Y30DI3D*/
*           ELSE                                                   0246
*             IF OPSIZE=0&NONAME=YES THEN                          0246
         B     @RC00239                                            0246
@RF00239 LTR   OPSIZE,OPSIZE                                       0246
         BNZ   @RF00246                                            0246
         TM    NONAME,B'00100000'                                  0246
         BO    @RT00246                                            0246
*               ;                   /* DIRECT ADDRESS        @Y30DI3D*/
*             ELSE                                                 0248
*               SYNTAXCD=INVPARM;   /* INVALID OPERAND AFTER ADDRESS */
@RF00246 MVI   SYNTAXCD,X'08'                                      0248
*         END;                      /*                       @Y30DI3D*/
*       ELSE                                                       0250
*         SYNTAXCD=INVDELIM;        /* INVALID DELIMETER AFTER     0250
*                                      ADDRESS                       */
         B     @RC00235                                            0250
@RF00235 MVI   SYNTAXCD,X'02'                                      0250
*   IF SIGNSW=OFF&SYNTAXCD=GOOD THEN/* NO OFFSET,GET NEXT OPERAND    */
@RC00235 DS    0H                                                  0251
@RC00224 DS    0H                                                  0251
@RF00223 TM    SIGNSW,B'00001000'                                  0251
         BNZ   @RF00251                                            0251
         CLI   SYNTAXCD,X'00'                                      0251
         BNE   @RF00251                                            0251
*     DO;                           /*                       @Y30DI3D*/
*       VERBGN=VERBEND+1;           /* POSITION AFTER LAST DELIMETER */
         LA    @00,1                                               0253
         AL    @00,VERBEND(,COMBASE)                               0253
         ST    @00,VERBGN(,COMBASE)                                0253
*       WTORSIZE=SAVEWTOR-VERBGN;   /* REMAINING BUFFER AREA @Y30DI3D*/
         LCR   @00,@00                                             0254
         AL    @00,SAVEWTOR                                        0254
         ST    @00,WTORSIZE                                        0254
*       TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON BLANK  */
         L     @03,VERBGN(,COMBASE)                                0255
         L     @15,WTORSIZE                                        0255
         BCTR  @15,0                                               0255
         EX    @15,@SB00761                                        0255
*       BC(6,LENRTN);               /* SCAN FOR LENGTH       @Y30DI3D*/
         BC    6,LENRTN                                            0256
*       LEN1=4;                     /* USE DEFAULT LENGTH    @Y30DI3D*/
         MVC   LEN1(4),@CF00157                                    0257
*       THISASID=LASTASID;          /* USE DEFAULT ASID      @Y30DI3D*/
         MVC   THISASID(2),LASTASID                                0258
*       OPSCAN=OFF;                 /* END OF SCAN           @Y30DI3D*/
         NI    OPSCAN,B'11101111'                                  0259
*     END;                          /*                       @Y30DI3D*/
*                                                                  0261
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/* GET OFFSET, IF ANY AND ADD TO OR SUBTRACT FROM ADDRESS   @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0261
*   IF OPSCAN=ON&SYNTAXCD=GOOD&SIGNSW=ON THEN/* OFFSET USED          */
@RF00251 TM    OPSCAN,B'00010000'                                  0261
         BNO   @RF00261                                            0261
         CLI   SYNTAXCD,X'00'                                      0261
         BNE   @RF00261                                            0261
         TM    SIGNSW,B'00001000'                                  0261
         BNO   @RF00261                                            0261
*     DO;                           /*                       @Y30DI3D*/
*       CALL DLIMSCAN;              /*                       @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0263
*       IF DELIMCD=BLANK THEN       /* CORRECT DELIM AFTER OFFSET    */
         CLC   DELIMCD(4,COMBASE),@CF00242                         0264
         BNE   @RF00264                                            0264
*         IF OPSIZE=0 THEN                                         0265
         LTR   OPSIZE,OPSIZE                                       0265
         BNZ   @RF00265                                            0265
*           SYNTAXCD=NOPARMS;       /*                       @Y30DI3D*/
         MVI   SYNTAXCD,X'03'                                      0266
*         ELSE                                                     0267
*           IF OPSIZE>6 THEN                                       0267
         B     @RC00265                                            0267
@RF00265 CH    OPSIZE,@CH00387                                     0267
         BNH   @RF00267                                            0267
*             SYNTAXCD=INVOFST;     /*                       @Y30DI3D*/
         MVI   SYNTAXCD,X'07'                                      0268
*           ELSE                                                   0269
*             DO;                   /*                       @Y30DI3D*/
         B     @RC00267                                            0269
@RF00267 DS    0H                                                  0270
*               CALL DIGITSCN;      /* CHECK FOR VALID OFFSET        */
         BAL   @14,DIGITSCN                                        0270
*               IF SYNTAXCD=GOOD THEN/* CALCULATE ADDRESS            */
         CLI   SYNTAXCD,X'00'                                      0271
         BNE   @RF00271                                            0271
*                 DO;               /* CONVERT ADDR TO BINARY        */
*                   IF SIGN=PLUS THEN/* ADD OFFSET TO ADDRESS        */
         CLC   SIGN(4),@CF00224                                    0273
         BNE   @RF00273                                            0273
*                     LOADDR=LOADDR+GOODNUM;/*               @Y30DI3D*/
         L     @00,LOADDR                                          0274
         AL    @00,GOODNUM                                         0274
         ST    @00,LOADDR                                          0274
*                   ELSE            /* SUBTRACT OFFSET FROM ADDR     */
*                     LOADDR=LOADDR-GOODNUM;/*               @Y30DI3D*/
         B     @RC00273                                            0275
@RF00273 L     @00,LOADDR                                          0275
         SL    @00,GOODNUM                                         0275
         ST    @00,LOADDR                                          0275
*                   IF LOADDR>ADDRMAX THEN/* ADDRESS+OFFSET>FFFFFF 0276
*                                                            @Y30DI3D*/
@RC00273 CLC   LOADDR(4),@CF00432                                  0276
         BNH   @RF00276                                            0276
*                     SYNTAXCD=INVADDR;/* INVALID ADDRESS    @Y30DI3D*/
         MVI   SYNTAXCD,X'05'                                      0277
*                   VERBGN=VERBEND+1;/* POSITION AFTER LAST DELIM    */
@RF00276 LA    @00,1                                               0278
         AL    @00,VERBEND(,COMBASE)                               0278
         ST    @00,VERBGN(,COMBASE)                                0278
*                   WTORSIZE=SAVEWTOR-VERBGN;/* REMAINING BUFFER AREA*/
         LCR   @00,@00                                             0279
         AL    @00,SAVEWTOR                                        0279
         ST    @00,WTORSIZE                                        0279
*                   TRT(OPERAND(1:WTORSIZE),NONBLNK);/*      @Y30DI3D*/
         L     @03,VERBGN(,COMBASE)                                0280
         L     @15,WTORSIZE                                        0280
         BCTR  @15,0                                               0280
         EX    @15,@SB00761                                        0280
*                   BC(6,LENRTN);   /* GO TO LENGTH ROUTINE IF NOT 0281
*                                      BLNKS                         */
         BC    6,LENRTN                                            0281
*                   LEN1=4;         /* USE DEFAULT LENGTH            */
         MVC   LEN1(4),@CF00157                                    0282
*                   THISASID=LASTASID;/* USE DEFAULT ASID    @Y30DI3D*/
         MVC   THISASID(2),LASTASID                                0283
*                   OPSCAN=OFF;     /* END OF SCAN           @Y30DI3D*/
         NI    OPSCAN,B'11101111'                                  0284
*                 END;              /*                       @Y30DI3D*/
*             END;                  /*                       @Y30DI3D*/
*       ELSE                                                       0287
*         SYNTAXCD=INVDELIM;        /* NO BLANK AFTER OFFSET @Y30DI3D*/
         B     @RC00264                                            0287
@RF00264 MVI   SYNTAXCD,X'02'                                      0287
*     END;                          /*                       @Y30DI3D*/
@RC00264 DS    0H                                                  0289
*                                                                  0289
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/* GET LENGTH, IF SPECIFIED, AND CALCULATE HIGH ADDRESS     @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0289
*LENRTN:                                                           0289
*   VERBEND=R1-1;                   /* INIT VERBEND FOR DLIMSCAN   0289
*                                                            @Y30DI3D*/
@RF00261 DS    0H                                                  0289
LENRTN   LR    @00,R1                                              0289
         BCTR  @00,0                                               0289
         ST    @00,VERBEND(,COMBASE)                               0289
*   IF OPSCAN=ON&SYNTAXCD=GOOD THEN                                0290
         TM    OPSCAN,B'00010000'                                  0290
         BNO   @RF00290                                            0290
         CLI   SYNTAXCD,X'00'                                      0290
         BNE   @RF00290                                            0290
*     DO;                           /*                       @Y30DI3D*/
*       CALL DLIMSCAN;              /*                       @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0292
*       IF DELIMCD=LPAREN THEN      /* CHECK FOR LENGTH OR ASID    0293
*                                                            @Y30DI3D*/
         CLC   DELIMCD(4,COMBASE),@CF00185                         0293
         BNE   @RF00293                                            0293
*         IF OPSIZE=1&OPERAND(1)='L' THEN                          0294
         CH    OPSIZE,@CH00058                                     0294
         BNE   @RF00294                                            0294
         L     @15,VERBGN(,COMBASE)                                0294
         CLI   OPERAND(@15),C'L'                                   0294
         BNE   @RF00294                                            0294
*           DO;                     /*                       @Y30DI3D*/
*             CALL DLIMSCAN;        /* SCAN FOR RIGHT PAREN  @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0296
*             IF DELIMCD=RPAREN&OPSIZE>0&OPSIZE<4 THEN             0297
         CLC   DELIMCD(4,COMBASE),@CF00215                         0297
         BNE   @RF00297                                            0297
         LTR   OPSIZE,OPSIZE                                       0297
         BNP   @RF00297                                            0297
         CH    OPSIZE,@CH00157                                     0297
         BNL   @RF00297                                            0297
*               DO L=1 TO OPSIZE WHILE SYNTAXCD=GOOD;/*      @Y30DI3D*/
         LA    @00,1                                               0298
         B     @DE00298                                            0298
@DL00298 CLI   SYNTAXCD,X'00'                                      0298
         BNE   @DC00298                                            0298
*                 IF OPERAND(L)>='0'&OPERAND(L)<='9' THEN          0299
         L     @15,VERBGN(,COMBASE)                                0299
         LR    @14,@00                                             0299
         ALR   @14,@15                                             0299
         BCTR  @14,0                                               0299
         CLI   OPERAND(@14),C'0'                                   0299
         BL    @RF00299                                            0299
         ALR   @15,@00                                             0299
         BCTR  @15,0                                               0299
         CLI   OPERAND(@15),C'9'                                   0299
         BNH   @RT00299                                            0299
*                   ;               /*                       @Y30DI3D*/
*                 ELSE                                             0301
*                   SYNTAXCD=LNOTDEC;/* LENGTH NOT DECIMAL           */
@RF00299 MVI   SYNTAXCD,X'0C'                                      0301
*               END;                /*                       @Y30DI3D*/
@RT00299 LA    @00,1                                               0302
         AL    @00,L                                               0302
@DE00298 ST    @00,L                                               0302
         CR    @00,OPSIZE                                          0302
         BNH   @DL00298                                            0302
@DC00298 DS    0H                                                  0303
*             ELSE                                                 0303
*               SYNTAXCD=INVLEN;    /*                       @Y30DI3D*/
         B     @RC00297                                            0303
@RF00297 MVI   SYNTAXCD,X'0B'                                      0303
*             IF SYNTAXCD=GOOD THEN /* GET HIGH ADDR OF STORAGE REQ  */
@RC00297 CLI   SYNTAXCD,X'00'                                      0304
         BNE   @RF00304                                            0304
*               DO;                 /* CONVERT TO HEX        @Y30DI3D*/
*                 TR(OPERAND(1:OPSIZE),HEXTABL);/*           @Y30DI3D*/
         L     @15,VERBGN(,COMBASE)                                0306
         LR    @14,OPSIZE                                          0306
         BCTR  @14,0                                               0306
         EX    @14,@SB00770                                        0306
*                 CHARWORK=BLANK6;  /*                       @Y30DI3D*/
         MVC   CHARWORK(6),@CC00388                                0307
*                 CHARWORK((7-OPSIZE):6)=OPERAND(1:OPSIZE);/*      0308
*                                                            @Y30DI3D*/
         LA    @14,7                                               0308
         SLR   @14,OPSIZE                                          0308
         LA    @07,CHARWORK-1(@14)                                 0308
         LCR   @14,@14                                             0308
         AH    @14,@CH00387                                        0308
         EX    @14,@SM00772                                        0308
*                 PACK(LEN2,CHARWORK);/*                     @Y30DI3D*/
         PACK  LEN2(4),CHARWORK(6)                                 0309
*                 CVB(HEXCONV,LEN2);/*                       @Y30DI3D*/
         XC    @TS00001(8),@TS00001                                0310
         MVC   @TS00001+4(4),LEN2                                  0310
         CVB   @00,@TS00001                                        0310
         ST    @00,HEXCONV                                         0310
*                 IF HEXCONV=0×HEXCONV>LENMAX THEN                 0311
         LTR   @00,@00                                             0311
         BZ    @RT00311                                            0311
         CH    @00,@CH00174                                        0311
         BNH   @RF00311                                            0311
@RT00311 DS    0H                                                  0312
*                   SYNTAXCD=INVLEN;/* INVALID LENGTH        @Y30DI3D*/
         MVI   SYNTAXCD,X'0B'                                      0312
*                 ELSE                                             0313
*                   DO;             /*                       @Y30DI3D*/
         B     @RC00311                                            0313
@RF00311 DS    0H                                                  0314
*                     HIADDR=LOADDR+HEXCONV;/*               @Y30DI3D*/
         L     @00,LOADDR                                          0314
         AL    @00,HEXCONV                                         0314
         ST    @00,HIADDR                                          0314
*                     IF HIADDR>ADDRMAX THEN/* DEFAULT TO 'FFFFFF'   */
         L     @15,@CF00432                                        0315
         CR    @00,@15                                             0315
         BNH   @RF00315                                            0315
*                       HIADDR=ADDRMAX;/*                    @Y30DI3D*/
         ST    @15,HIADDR                                          0316
*                     ELSE                                         0317
*                       ;           /*                       @Y30DI3D*/
@RF00315 DS    0H                                                  0318
*                   END;            /*                       @Y30DI3D*/
*               END;                /*                       @Y30DI3D*/
*             ELSE                                                 0320
*               ;                   /*                       @Y30DI3D*/
@RF00304 DS    0H                                                  0321
*           END;                    /*                       @Y30DI3D*/
*         ELSE                                                     0322
*           IF OPSIZE=4&OPERAND(1:4)='ASID' THEN                   0322
         B     @RC00294                                            0322
@RF00294 LA    @15,4                                               0322
         CR    OPSIZE,@15                                          0322
         BNE   @RF00322                                            0322
         L     @14,VERBGN(,COMBASE)                                0322
         CLC   OPERAND(4,@14),@CC00696                             0322
         BNE   @RF00322                                            0322
*             DO;                   /*                       @Y30DI3D*/
*               ASIDSW=ON;          /*                       @Y30DI3D*/
         OI    ASIDSW,B'00100000'                                  0324
*               LEN1=4;             /* USE DEFAULT LENGTH    @Y30DI3D*/
         ST    @15,LEN1                                            0325
*             END;                  /*                       @Y30DI3D*/
*           ELSE                                                   0327
*             SYNTAXCD=INVPARM;     /* INVALID OPERAND       @Y30DI3D*/
         B     @RC00322                                            0327
@RF00322 MVI   SYNTAXCD,X'08'                                      0327
*       ELSE                                                       0328
*         SYNTAXCD=INVDELIM;        /* INVALID DELIMETER     @Y30DI3D*/
         B     @RC00293                                            0328
@RF00293 MVI   SYNTAXCD,X'02'                                      0328
*     END;                          /*                       @Y30DI3D*/
@RC00293 DS    0H                                                  0330
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*  NO LENGTH SPECIFIED,GET HIADDR USING DEFAULT LENGTH     @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0330
*   IF SYNTAXCD=GOOD THEN                                          0330
@RF00290 CLI   SYNTAXCD,X'00'                                      0330
         BNE   @RF00330                                            0330
*     DO;                           /*                       @Y30DI3D*/
*       IF OPSCAN=OFF×LEN1=4 THEN                                  0332
         TM    OPSCAN,B'00010000'                                  0332
         BZ    @RT00332                                            0332
         CLC   LEN1(4),@CF00157                                    0332
         BNE   @RF00332                                            0332
@RT00332 DS    0H                                                  0333
*         DO;                       /*                       @Y30DI3D*/
*           HIADDR=LOADDR+LEN1;     /*                       @Y30DI3D*/
         L     @00,LOADDR                                          0334
         AL    @00,LEN1                                            0334
         ST    @00,HIADDR                                          0334
*           IF HIADDR>ADDRMAX THEN  /* DEFAULT TO 'FFFFFF'   @Y30DI3D*/
         L     @15,@CF00432                                        0335
         CR    @00,@15                                             0335
         BNH   @RF00335                                            0335
*             HIADDR=ADDRMAX;       /*                       @Y30DI3D*/
         ST    @15,HIADDR                                          0336
*         END;                      /*                       @Y30DI3D*/
@RF00335 DS    0H                                                  0338
*       IF OPSCAN=ON&ASIDSW=OFF THEN/* SCAN FOR ASID         @Y30DI3D*/
@RF00332 TM    OPSCAN,B'00010000'                                  0338
         BNO   @RF00338                                            0338
         TM    ASIDSW,B'00100000'                                  0338
         BNZ   @RF00338                                            0338
*         DO;                       /*                       @Y30DI3D*/
*           VERBGN=VERBEND+1;       /*                       @Y30DI3D*/
         LA    @00,1                                               0340
         AL    @00,VERBEND(,COMBASE)                               0340
         ST    @00,VERBGN(,COMBASE)                                0340
*           WTORSIZE=SAVEWTOR-VERBGN;/* REMAINING BUFFER AREA      0341
*                                                            @Y30DI3D*/
         LCR   @00,@00                                             0341
         AL    @00,SAVEWTOR                                        0341
         ST    @00,WTORSIZE                                        0341
*           TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON  0342
*                                      BLANK                         */
         L     @03,VERBGN(,COMBASE)                                0342
         L     @15,WTORSIZE                                        0342
         BCTR  @15,0                                               0342
         EX    @15,@SB00761                                        0342
*           BC(6,ASIDRTN);          /* GO TO ASID ROUTINE    @Y30DI3D*/
         BC    6,ASIDRTN                                           0343
*           THISASID=LASTASID;      /* USE DEFAULT ASID      @Y30DI3D*/
         MVC   THISASID(2),LASTASID                                0344
*           OPSCAN=OFF;             /* END OF SCAN           @Y30DI3D*/
         NI    OPSCAN,B'11101111'                                  0345
*         END;                      /*                       @Y30DI3D*/
*     END;                          /*                       @Y30DI3D*/
@RF00338 DS    0H                                                  0348
*                                                                  0348
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/* GET ASID, IF SPECIFIED. ASID 0 AND FFFF ARE INVALID      @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0348
*ASIDRTN:                           /*                       @Y30DI3D
*                                                            @Y30DI3D*/
*   IF OPSCAN=ON&SYNTAXCD=GOOD THEN                                0348
@RF00330 DS    0H                                                  0348
ASIDRTN  TM    OPSCAN,B'00010000'                                  0348
         BNO   @RF00348                                            0348
         CLI   SYNTAXCD,X'00'                                      0348
         BNE   @RF00348                                            0348
*     DO;                           /*                       @Y30DI3D*/
*       IF ASIDSW=OFF THEN          /* SCAN FOR ASID         @Y30DI3D*/
         TM    ASIDSW,B'00100000'                                  0350
         BNZ   @RF00350                                            0350
*         DO;                       /*                       @Y30DI3D*/
*           VERBEND=R1-1;           /* INIT VERBEND FOR DLIMSCAN   0352
*                                                            @Y30DI3D*/
         LR    @00,R1                                              0352
         BCTR  @00,0                                               0352
         ST    @00,VERBEND(,COMBASE)                               0352
*           CALL DLIMSCAN;          /*                       @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0353
*         END;                      /*                       @Y30DI3D*/
*       ELSE                                                       0355
*         ;                         /* ASID ALREADY FOUND    @Y30DI3D*/
@RF00350 DS    0H                                                  0356
*       IF DELIMCD=LPAREN&OPSIZE=4&OPERAND(1:4)='ASID' THEN        0356
         CLC   DELIMCD(4,COMBASE),@CF00185                         0356
         BNE   @RF00356                                            0356
         CH    OPSIZE,@CH00157                                     0356
         BNE   @RF00356                                            0356
         L     @15,VERBGN(,COMBASE)                                0356
         CLC   OPERAND(4,@15),@CC00696                             0356
         BNE   @RF00356                                            0356
*         DO;                       /*                       @Y30DI3D*/
*           CALL DLIMSCAN;          /*                       @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0358
*           IF DELIMCD=RPAREN&OPSIZE>0&OPSIZE<5 THEN               0359
         CLC   DELIMCD(4,COMBASE),@CF00215                         0359
         BNE   @RF00359                                            0359
         LTR   OPSIZE,OPSIZE                                       0359
         BNP   @RF00359                                            0359
         CH    OPSIZE,@CH00155                                     0359
         BNL   @RF00359                                            0359
*             DO;                   /*                       @Y30DI3D*/
*               CALL DIGITSCN;      /* CHECK FOR VALID ASID  @Y30DI3D*/
         BAL   @14,DIGITSCN                                        0361
*               IF SYNTAXCD=GOOD THEN                              0362
         CLI   SYNTAXCD,X'00'                                      0362
         BNE   @RF00362                                            0362
*                 DO;               /*                       @Y30DI3D*/
*                   THISASID=GOODNUM;/*                      @Y30DI3D*/
         L     @05,GOODNUM                                         0364
         STH   @05,THISASID                                        0364
*                   LASTASID=THISASID;/* INIT FOR NEXT LIST  @Y30DI3D*/
         MVC   LASTASID(2),THISASID                                0365
*                   IF THISASID=0×THISASID=ASIDFFFF THEN           0366
         LTR   @05,@05                                             0366
         BZ    @RT00366                                            0366
         CLC   THISASID(2),@CB00436                                0366
         BNE   @RF00366                                            0366
@RT00366 DS    0H                                                  0367
*                     SYNTAXCD=INVASID;/*                    @Y30DI3D*/
         MVI   SYNTAXCD,X'09'                                      0367
*                   ELSE                                           0368
*                     ;             /*                       @Y30DI3D*/
@RF00366 DS    0H                                                  0369
*                 END;              /*                       @Y30DI3D*/
*               ELSE                                               0370
*                 ;                 /*                       @Y30DI3D*/
@RF00362 DS    0H                                                  0371
*             END;                  /*                       @Y30DI3D*/
*           ELSE                                                   0372
*             SYNTAXCD=INVDELIM;    /*                       @Y30DI3D*/
         B     @RC00359                                            0372
@RF00359 MVI   SYNTAXCD,X'02'                                      0372
*         END;                      /*                       @Y30DI3D*/
*       ELSE                                                       0374
*         SYNTAXCD=INVDELIM;        /*                       @Y30DI3D*/
         B     @RC00356                                            0374
@RF00356 MVI   SYNTAXCD,X'02'                                      0374
*     END;                          /*                       @Y30DI3D*/
@RC00356 DS    0H                                                  0376
*                                                                  0376
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*   THIS ROUTINE OBTAINS THE DATA REQUESTED FROM THE DUMP AND      */
*/*   FORMATS THE PRINTED DUMP OUTPUT                        @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0376
*   IF SYNTAXCD=GOOD THEN                                          0376
@RF00348 CLI   SYNTAXCD,X'00'                                      0376
         BNE   @RF00376                                            0376
*     DO;                           /*                       @Y30DI3D*/
*       LINE=0;                     /* INIT FOR HARDCOPY SAVE TABLE
*                                                            @Y30DI3D*/
         SLR   @15,@15                                             0378
         ST    @15,LINE                                            0378
*       NOMORE=NO;                  /* INIT FOR LOOP CONTROL @Y30DI3D*/
*       FRSTFAIL=NO;                /* FIRST BRREAD SUCCESSFUL     0380
*                                                            @Y30DI3D*/
         NI    NOMORE,B'11100111'                                  0380
*       READEND=0;                  /* END OF UNSUCCESSFUL READS   0381
*                                                            @Y30DI3D*/
         ST    @15,READEND                                         0381
*       CONTREAD=YES;               /* INIT FOR BRREAD LOOP  @Y30DI3D*/
         OI    CONTREAD,B'00000100'                                0382
*       PREVREAD=GOOD;              /* INIT FOR BRREAD LOOP  @Y30DI3D*/
         MVI   PREVREAD,X'00'                                      0383
*       READCTR=0;                  /* VALUE PRIOR TO FIRST BRREAD 0384
*                                                            @Y30DI3D*/
         MVI   READCTR,X'00'                                       0384
*       PRINTOUT=YES;               /* ALL BRREADS NOT BAD, PRINT  0385
*                                      SOME DUMP                     */
*       MSGSW=OFF;                  /* INIT FOR NO ERROR MSG IN DUMP
*                                                            @Y30DI3D*/
         OI    PRINTOUT,B'00000001'                                0386
         NI    MSGSW,B'11111011'                                   0386
*       BUFFAREA=BLANK256;          /* CLEAR BUFFER AREA     @Y30DI3D*/
         MVC   BUFFAREA(256),BLANK256                              0387
*       RESPECIFY                                                  0388
*         R13 RESTRICTED;           /*                       @Y30DI3D*/
*       FDSSAVEA=R13;               /* SAVE AREA FOR ASYNC ROUTINES
*                                                            @Y30DI3D*/
         ST    R13,FDSSAVEA                                        0389
*       RESPECIFY                                                  0390
*         R13 UNRESTRICTED;         /*                       @Y30DI3D*/
*       ERRADDR=ADDR(FDSREAD);      /* ADDR OF FDS BRREAD ERROR    0391
*                                      ROUTINE                       */
         LA    @00,FDSREAD                                         0391
         ST    @00,ERRADDR(,COMBASE)                               0391
*       THISLINE=LOADDR;            /* INIT FOR PRINTOUT LOOP CONTROL*/
         L     @00,LOADDR                                          0392
         ST    @00,THISLINE                                        0392
*       BLOCKEND=HIADDR;            /* INIT FOR BRREAD LOOP  @Y30DI3D*/
         MVC   BLOCKEND(4),HIADDR                                  0393
*       RESPECIFY                                                  0394
*         READADDR RESTRICTED;      /*                       @Y30DI3D*/
*       READADDR=THISLINE&READMASK; /* ROUND TO 4-BYTE BOUNDARY      */
         N     @00,READMASK                                        0395
         LR    READADDR,@00                                        0395
*       SAVEADDR=READADDR;          /* SAVE FIRST BRREAD ADDR FOR  0396
*                                      ERROR MSG                     */
         ST    READADDR,SAVEADDR                                   0396
*       RESPECIFY                                                  0397
*        (R1,                                                      0397
*         R6) RESTRICTED;           /*                       @Y30DI3D*/
*       R6=THISASID;                /* GET CURRENT ASID FOR BRREAD 0398
*                                                            @Y30DI3D*/
         SLR   R6,R6                                               0398
         ICM   R6,3,THISASID                                       0398
*       BUFFPTR=ADDR(BUFFAREA);     /* INIT BUFFER POINTER   @Y30DI3D*/
         LA    BUFFPTR,BUFFAREA                                    0399
*                                                                  0400
*       /*************************************************************/
*       /*                                                           */
*       /* READ 4 BYTES AT A TIME                            @Y30DI3D*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0400
*       DO READADDR=READADDR TO BLOCKEND-1 BY 4 WHILE CONTREAD=YES;
         B     @DE00400                                            0400
@DL00400 TM    CONTREAD,B'00000100'                                0400
         BNO   @DC00400                                            0400
*         GEN REFS(READADDR,BRRDDATA) FLOWS(FDSREAD)               0401
*             (BRREAD (READADDR),DATA,ASID=(6));/*           @Y30DI3D*/
         BRREAD (READADDR),DATA,ASID=(6)
*         BUFFADDR=R1;              /* ADDRESS RETURNED BY BRREAD  0402
*                                                            @Y30DI3D*/
         ST    R1,BUFFADDR                                         0402
*         IF PREVREAD=NOTGOOD THEN                                 0403
         CLI   PREVREAD,X'01'                                      0403
         BNE   @RF00403                                            0403
*           DO;                     /*                       @Y30DI3D*/
*             READEND=READADDR-1;   /* END OF BAD READ BLOCK         */
         LR    @07,READADDR                                        0405
         BCTR  @07,0                                               0405
         ST    @07,READEND                                         0405
*             THISLINE=READADDR;    /* RE-INIT FOR 1ST GOOD BRREAD   */
         ST    READADDR,THISLINE                                   0406
*             PREVREAD=GOOD;        /* RE-INIT FOR OTHER BRREADS     */
         MVI   PREVREAD,X'00'                                      0407
*           END;                    /*                       @Y30DI3D*/
*         MVC(BUFFER2,BUFFER1);     /* PUT STORAGE INTO BUFFAREA     */
@RF00403 L     @07,BUFFADDR                                        0409
         MVC   BUFFER2(4,BUFFPTR),BUFFER1(@07)                     0409
*         BUFFPTR=BUFFPTR+4;        /* NEXT POSITION IN BUFFAREA     */
         AL    BUFFPTR,@CF00157                                    0410
*         READCTR=1;                /* FIRST BRREAD WAS EXECUTED     */
         MVI   READCTR,X'01'                                       0411
*BRREND:                                                           0412
*       END;                        /* END OF BRREAD LOOP    @Y30DI3D*/
BRREND   AL    READADDR,@CF00157                                   0412
@DE00400 L     @07,BLOCKEND                                        0412
         BCTR  @07,0                                               0412
         CR    READADDR,@07                                        0412
         BNH   @DL00400                                            0412
@DC00400 DS    0H                                                  0413
*       IF FRSTFAIL=YES&READEND=0 THEN/* ALL BRREADS FAILED          */
         TM    FRSTFAIL,B'00001000'                                0413
         BNO   @RF00413                                            0413
         ICM   @07,15,READEND                                      0413
         BNZ   @RF00413                                            0413
*         PRINTOUT=NO;              /* NO DUMP IN OUTPUT     @Y30DI3D*/
         NI    PRINTOUT,B'11111110'                                0414
*       IF PRINTOUT=YES THEN        /* FORMAT AND PRINT OUTPUT       */
@RF00413 TM    PRINTOUT,B'00000001'                                0415
         BNO   @RF00415                                            0415
*         DO;                       /*                       @Y30DI3D*/
*           IF CONTREAD=YES THEN    /* LAST BRREAD WAS GOOD  @Y30DI3D*/
         TM    CONTREAD,B'00000100'                                0417
         BNO   @RF00417                                            0417
*             BUFFEND=HIADDR;       /*                       @Y30DI3D*/
         MVC   BUFFEND(4),HIADDR                                   0418
*           ELSE                                                   0419
*             BUFFEND=FAILADDR;     /* LAST BRREAD WAS BAD   @Y30DI3D
*                                                            @Y30DI3D*/
         B     @RC00417                                            0419
@RF00417 MVC   BUFFEND(4),FAILADDR                                 0419
*           THISOFST=THISLINE-SAVEADDR;/* OFFSET INTO BUFFER OF    0420
*                                      OUTPUT STARTING ADDRESS       */
@RC00417 L     @07,THISLINE                                        0420
         LR    @03,@07                                             0420
         SL    @03,SAVEADDR                                        0420
         ST    @03,THISOFST                                        0420
*           INLINE=ADDR(BUFFAREA);  /*                       @Y30DI3D*/
         LA    INLINE,BUFFAREA                                     0421
*           LOBYTE=THISLINE;        /* INIT FOR LOOP CONTROL         */
         ST    @07,LOBYTE                                          0422
*           HIBYTE=BUFFEND;         /* INIT FOR LOOP CONTROL         */
         MVC   HIBYTE(4),BUFFEND                                   0423
*           DATAPTR=ADDR(INDATA);   /* ADDRESS OF DATA LINE  @Y30DI3D*/
         ALR   @03,INLINE                                          0424
         ST    @03,DATAPTR                                         0424
*           DO THISLINE=THISLINE TO BUFFEND-1 BY LINELGT;/*  @Y30DI3D*/
         B     @DE00425                                            0425
@DL00425 DS    0H                                                  0426
*             DATAREA=BLANK80;      /* CLEAR OUTPUT BUFFER   @Y30DI3D*/
         L     @07,OUTBUFAD                                        0426
         MVC   DATAREA(80,@07),BLANK80                             0426
*             UNPK(DATAREA(1:7),ADDR1(2:5));/* CONVERT TO HEX        */
         UNPK  DATAREA(7,@07),ADDR1+1(4)                           0427
*             DATAREA(7)=BLANK1;    /* PUT 1 BLANK AFTER ADDRESS     */
         MVI   DATAREA+6(@07),C' '                                 0428
*             TR(ADDRESS,EBCTABL);  /* TRANSLATE ADDRESS     @Y30DI3D*/
         TR    ADDRESS(6,@07),EBCTABL(COMBASE)                     0429
*             FIELDPTR=ADDR(FIELD1);/* BUFFER LOCATION       @Y30DI3D*/
         LA    FIELDPTR,FIELD1(,@07)                               0430
*             DO HALF=1 TO 2 WHILE NOMORE=NO;/*              @Y30DI3D*/
         LA    @07,1                                               0431
         ST    @07,HALF                                            0431
@DL00431 TM    NOMORE,B'00010000'                                  0431
         BNZ   @DC00431                                            0431
*               DO WORD=1 TO 4 WHILE LOBYTE<HIBYTE;/*        @Y30DI3D*/
         LA    @07,1                                               0432
         ST    @07,WORD                                            0432
@DL00432 L     @07,LOBYTE                                          0432
         L     @03,HIBYTE                                          0432
         CR    @07,@03                                             0432
         BNL   @DC00432                                            0432
*                 UNPK(FLDWORK,DATAWORK);/* ONE WORD OF STORAGE      */
         L     @15,DATAPTR                                         0433
         UNPK  FLDWORK(9,FIELDPTR),DATAWORK(5,@15)                 0433
*                 FLDWORK(9)=BLANK1;/* BLANK BETWEEN WORDS           */
         MVI   FLDWORK+8(FIELDPTR),C' '                            0434
*                 TR(FLDWORK(1:8),EBCTABL);/* TRANSLATE STORAGE      */
         TR    FLDWORK(8,FIELDPTR),EBCTABL(COMBASE)                0435
*                 LOBYTE=LOBYTE+4;  /* INCR LOBYTE FOR NEXT WORD     */
         LA    @15,4                                               0436
         ALR   @07,@15                                             0436
         ST    @07,LOBYTE                                          0436
*                 IF LOBYTE^<HIBYTE THEN                           0437
         CR    @07,@03                                             0437
         BL    @RF00437                                            0437
*                   IF LOBYTE>HIBYTE THEN/* CLEAR REST OF WORD       */
         CR    @07,@03                                             0438
         BNH   @RF00438                                            0438
*                     DO;           /*                       @Y30DI3D*/
*                       BLANKPTR=LOBYTE-4;/*                 @Y30DI3D*/
         SLR   @07,@15                                             0440
         ST    @07,BLANKPTR                                        0440
*                       BYTEOFST=2*(HIBYTE-BLANKPTR);/*      @Y30DI3D*/
         SLR   @03,@07                                             0441
         ALR   @03,@03                                             0441
         ST    @03,BYTEOFST                                        0441
*                       FLDWORK((BYTEOFST+1):8)=BLANK8((BYTEOFST+1):8);
         ALR   @03,FIELDPTR                                        0442
         L     @07,BYTEOFST                                        0442
         LA    @15,7                                               0442
         SLR   @15,@07                                             0442
         LA    @14,BLANK8(@07)                                     0442
         EX    @15,@SM00776                                        0442
*                       NOMORE=YES; /* END OF DUMP           @Y30DI3D*/
         OI    NOMORE,B'00010000'                                  0443
*                     END;          /*                       @Y30DI3D*/
*                   ELSE            /* NO BYTES TO CLEAR     @Y30DI3D*/
*                     NOMORE=YES;   /* END OF DUMP           @Y30DI3D*/
         B     @RC00438                                            0445
@RF00438 OI    NOMORE,B'00010000'                                  0445
*                 ELSE                                             0446
*                   ;               /*                       @Y30DI3D*/
@RF00437 DS    0H                                                  0447
*                 FIELDPTR=FIELDPTR+LENGTH(FLDWORK);/*       @Y30DI3D*/
@RC00437 AH    FIELDPTR,@CH00172                                   0447
*                 DATAPTR=DATAPTR+4;/* NEXT WORD OF STORAGE          */
         LA    @07,4                                               0448
         AL    @07,DATAPTR                                         0448
         ST    @07,DATAPTR                                         0448
*               END;                /*                       @Y30DI3D*/
         LA    @07,1                                               0449
         AL    @07,WORD                                            0449
         ST    @07,WORD                                            0449
         CH    @07,@CH00157                                        0449
         BNH   @DL00432                                            0449
@DC00432 DS    0H                                                  0450
*               FIELDPTR=ADDR(FIELD2);/*                     @Y30DI3D*/
         L     FIELDPTR,OUTBUFAD                                   0450
         LA    FIELDPTR,FIELD2(,FIELDPTR)                          0450
*             END;                  /*                       @Y30DI3D*/
         LA    @07,1                                               0451
         AL    @07,HALF                                            0451
         ST    @07,HALF                                            0451
         CH    @07,@CH00165                                        0451
         BNH   @DL00431                                            0451
@DC00431 DS    0H                                                  0452
*             LINE=LINE+1;          /*                       @Y30DI3D*/
         LA    @07,1                                               0452
         AL    @07,LINE                                            0452
         ST    @07,LINE                                            0452
*             HCOPYBUF(LINE)=DATAREA;/* SAVE FOR HARDCOPY            */
         MH    @07,@CH00382                                        0453
         LA    @05,HCOPYBUF-80(@07)                                0453
         L     @07,OUTBUFAD                                        0453
         MVC   0(80,@05),DATAREA(@07)                              0453
*             DMPMSG03=DATAREA;     /* FOR CONSOLE OUTPUT    @Y30DI3D*/
         MVC   DMPMSG03(80),DATAREA(@07)                           0454
*             MSGADDR=ADDR(DATAREA);/* FOR TERMINAL OUTPUT   @Y30DI3D*/
         LA    MSGADDR,DATAREA(,@07)                               0455
*             CALL WRITRTN;         /* WRITE DUMP TO APPROPRIATE   0456
*                                      OUTPUT DEVICE                 */
         BAL   @14,WRITRTN                                         0456
*             IF HCOPYON=ON THEN    /* WRITE LINE TO PRINTER         */
         TM    HCOPYON,B'10000000'                                 0457
         BNO   @RF00457                                            0457
*               GEN REFS(AWRITE)(BRWRITE 1);/*               @Y30DI3D*/
         BRWRITE 1
*           END;                    /*                       @Y30DI3D*/
@RF00457 LA    @07,32                                              0459
         AL    @07,THISLINE                                        0459
         ST    @07,THISLINE                                        0459
@DE00425 L     @05,BUFFEND                                         0459
         BCTR  @05,0                                               0459
         CR    @07,@05                                             0459
         BNH   @DL00425                                            0459
*         END;                      /*                       @Y30DI3D*/
*       IF MSGSW=ON THEN            /* PRINT ERROR MESSAGE IN DUMP 0461
*                                                            @Y30DI3D*/
@RF00415 TM    MSGSW,B'00000100'                                   0461
         BNO   @RF00461                                            0461
*         CALL BRMSGRTN;            /* PRINT BRREAD ERROR MESSAGE  0462
*                                                            @Y30DI3D*/
         BAL   @14,BRMSGRTN                                        0462
*       RESPECIFY                                                  0463
*         READADDR UNRESTRICTED;    /*                       @Y30DI3D*/
@RF00461 DS    0H                                                  0464
*     END;                          /*                       @Y30DI3D*/
*   DMPMSG03=BLANK80;               /* SKIP LINE ON CONSOLE  @Y30DI3D*/
@RF00376 MVC   DMPMSG03(80),BLANK80                                0465
*   MSGADDR=ADDR(BLANK80);          /* SKIP LINE ON TERMINAL @Y30DI3D*/
         LA    MSGADDR,BLANK80                                     0466
*   CALL WRITRTN;                   /*                       @Y30DI3D*/
         BAL   @14,WRITRTN                                         0467
*   IF HCOPYON=ON THEN                                             0468
         TM    HCOPYON,B'10000000'                                 0468
         BNO   @RF00468                                            0468
*     DO;                           /*                       @Y30DI3D*/
*       DATAREA=BLANK80;            /*                       @Y30DI3D*/
         L     @07,OUTBUFAD                                        0470
         MVC   DATAREA(80,@07),BLANK80                             0470
*       GEN REFS(AWRITE)(BRWRITE 1);/* SKIP LINE             @Y30DI3D*/
         BRWRITE 1
*     END;                          /*                       @Y30DI3D*/
*   GOTO ENDSTOR;                   /*                       @Y30DI3D*/
         B     ENDSTOR                                             0473
*FDSREAD:                           /* BRREAD ERROR ROUTINE  @Y30DI3D*/
*   GEN REFS(FDSSAVEA,@PSTART);                                    0474
FDSREAD  DS    0H                                                  0474
*                                                          /*@Y30DI3D*/
         DROP  R10                                             @Y30DI3D
         USING *,R15         SET UP ADDRESSABILITY             @Y30DI3D
         L     R13,FDSSAVEA                                    @Y30DI3D
         LM    R14,R12,12(R13)                                 @Y30DI3D
         DROP  R15                                             @Y30DI3D
         USING @PSTART+4095,R10                                @Y30DI3D
*   MSGSW=ON;                       /* TURN ON SWITCH TO WRITE     0475
*                                      MESSAGE               @Y30DI3D*/
         OI    MSGSW,B'00000100'                                   0475
*   PREVREAD=NOTGOOD;               /*                       @Y30DI3D*/
         MVI   PREVREAD,X'01'                                      0476
*   IF READCTR=0 THEN               /* FIRST BRREAD FAILED   @Y30DI3D*/
         CLI   READCTR,0                                           0477
         BNE   @RF00477                                            0477
*     FRSTFAIL=YES;                 /*                       @Y30DI3D*/
         OI    FRSTFAIL,B'00001000'                                0478
*   ELSE                            /* ALL REMAINING BRREADS WILL BE
*                                      BAD                           */
*     DO;                           /*                       @Y30DI3D*/
         B     @RC00477                                            0479
@RF00477 DS    0H                                                  0480
*       CONTREAD=NO;                /* DROP OUT OF BRREAD LOOP     0480
*                                                            @Y30DI3D*/
         NI    CONTREAD,B'11111011'                                0480
*       RESPECIFY                                                  0481
*         READADDR RESTRICTED;      /*                       @Y30DI3D*/
*       FAILADDR=READADDR;          /* FIRST FAILING ADDRESS @Y30DI3D*/
         ST    READADDR,FAILADDR                                   0482
*       RESPECIFY                                                  0483
*         READADDR UNRESTRICTED;    /*                       @Y30DI3D*/
*     END;                          /*                       @Y30DI3D*/
*   BUFFPTR=BUFFPTR+4;              /*                       @Y30DI3D*/
@RC00477 AL    BUFFPTR,@CF00157                                    0485
*   GOTO BRREND;                    /*                       @Y30DI3D*/
         B     BRREND                                              0486
*LISTEOF:                                                          0487
*   SYNTAXCD=NOPARMS;               /* NO LIST OPERANDS      @Y30DI3D*/
LISTEOF  MVI   SYNTAXCD,X'03'                                      0487
*ENDSTOR:                                                          0488
*   END STORTN;                     /*                       @Y30DI3D*/
@EL00005 DS    0H                                                  0488
@EF00005 DS    0H                                                  0488
@ER00005 LM    @14,@12,@SA00005                                    0488
         BR    @14                                                 0488
*                                                                  0489
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/* THIS ROUTINE PRINTS THE BRREAD ERROR MESSAGE             @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0489
*BRMSGRTN:                                                         0489
*   PROCEDURE;                      /*                       @Y30DI3D*/
BRMSGRTN STM   @14,@12,@SA00006                                    0489
*   MSGAREA=BLANK80;                /* CLEAR MESSAGE BUFFER  @Y30DI3D*/
         L     @07,OUTBUFAD                                        0490
         MVC   MSGAREA(80,@07),BLANK80                             0490
*   IF CONTREAD=YES THEN                                           0491
         TM    CONTREAD,B'00000100'                                0491
         BNO   @RF00491                                            0491
*     MSGADDR1=LOADDR;              /* BAD ADDRESS WAS LOW ADDRESS 0492
*                                                            @Y30DI3D*/
         MVC   MSGADDR1(4),LOADDR                                  0492
*   ELSE                                                           0493
*     MSGADDR1=FAILADDR;            /* BAD ADDRESS WAS AFTER LOW   0493
*                                      ADDRESS                       */
         B     @RC00491                                            0493
@RF00491 MVC   MSGADDR1(4),FAILADDR                                0493
*   IF READEND=0 THEN                                              0494
@RC00491 ICM   @07,15,READEND                                      0494
         BNZ   @RF00494                                            0494
*     MSGADDR2=HIADDR;              /* BAD BRREADS AT END OF REQUEST */
         MVC   MSGADDR2(4),HIADDR                                  0495
*   ELSE                                                           0496
*     MSGADDR2=READEND;             /* GOOD BRREAD AFTER FAILURES    */
         B     @RC00494                                            0496
@RF00494 MVC   MSGADDR2(4),READEND                                 0496
*   UNPK(DATAREA(1:7),ADDR2(2:5));  /* FIRST FAILING ADDRESS         */
@RC00494 L     @07,OUTBUFAD                                        0497
         UNPK  DATAREA(7,@07),ADDR2+1(4)                           0497
*   MSGAREA(7:14)=THRU;             /*                       @Y30DI3D*/
         MVC   MSGAREA+6(8,@07),THRU                               0498
*   TR(ADDRESS,EBCTABL);            /*                       @Y30DI3D*/
         TR    ADDRESS(6,@07),EBCTABL(COMBASE)                     0499
*   UNPK(MSGAREA(16:22),ADDR3(2:5));/* END OF BAD ADDR RANGE         */
         UNPK  MSGAREA+15(7,@07),ADDR3+1(4)                        0500
*   MSGAREA(22:42)=REMNMSG;         /* REMAINDER OF MESSAGE          */
         MVC   MSGAREA+21(21,@07),REMNMSG                          0501
*   TR(MSGAREA(16:21),EBCTABL);     /*                       @Y30DI3D*/
         TR    MSGAREA+15(6,@07),EBCTABL(COMBASE)                  0502
*   LINE=LINE+1;                    /*                       @Y30DI3D*/
         LA    @05,1                                               0503
         AL    @05,LINE                                            0503
         ST    @05,LINE                                            0503
*   HCOPYBUF(LINE)=MSGAREA;         /* SAVE FOR HARDCOPY             */
         MH    @05,@CH00382                                        0504
         LA    @15,HCOPYBUF-80(@05)                                0504
         MVC   0(80,@15),MSGAREA(@07)                              0504
*   DMPMSG03=MSGAREA;               /* FOR CONSOLE OUTPUT            */
         MVC   DMPMSG03(80),MSGAREA(@07)                           0505
*   MSGADDR=ADDR(MSGAREA);          /* FOR TERMINAL OUTPUT           */
         LA    MSGADDR,MSGAREA(,@07)                               0506
*   CALL WRITRTN;                   /* WRITE MESSAGE TO APPROPRIATE
*                                      OUTPUT DEVICE                 */
         BAL   @14,WRITRTN                                         0507
*   IF HCOPYON=ON THEN              /* WRITE MESSAGE TO PRINTER    0508
*                                                            @Y30DI3D*/
         TM    HCOPYON,B'10000000'                                 0508
         BNO   @RF00508                                            0508
*     GEN REFS(AWRITE)(BRWRITE 1);  /*                       @Y30DI3D*/
         BRWRITE 1
*   END BRMSGRTN;                   /*                       @Y30DI3D*/
@EL00006 DS    0H                                                  0510
@EF00006 DS    0H                                                  0510
@ER00006 LM    @14,@12,@SA00006                                    0510
         BR    @14                                                 0510
*                                                                  0511
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/* THIS ROUTINE EQUATES AN ADDRESS TO A NAME                @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0511
*EQUATRTN:                                                         0511
*   PROCEDURE;                      /*                       @Y30DI3D*/
EQUATRTN STM   @14,@12,@SA00007                                    0511
*   RESPECIFY                                                      0512
*     R1 RESTRICTED;                /*                       @Y30DI3D*/
*   IF I>256 THEN                   /* NO MORE EQUATES       @Y30DI3D*/
         L     @07,I                                               0513
         CH    @07,@CH00174                                        0513
         BNH   @RF00513                                            0513
*     DO;                           /*                       @Y30DI3D*/
*       MSGHOLD=BLANK80;            /* CLEAR MESSAGE BUFFER          */
         MVC   MSGHOLD(80),BLANK80                                 0515
*       MSGHOLD(1:29)=NOMOREQ;      /*                       @Y30DI3D*/
         MVC   MSGHOLD(29),NOMOREQ                                 0516
*       DMPMSG03=MSGHOLD;           /* FOR CONSOLE OUTPUT            */
         MVC   DMPMSG03(80),MSGHOLD                                0517
*       MSGADDR=ADDR(MSGHOLD);      /* FOR TERMINAL OUTPUT           */
         LA    MSGADDR,MSGHOLD                                     0518
*       CALL WRITRTN;               /*                       @Y30DI3D*/
         BAL   @14,WRITRTN                                         0519
*       GOTO ENDEQUAT;              /*                       @Y30DI3D*/
         B     ENDEQUAT                                            0520
*     END;                          /*                       @Y30DI3D*/
*   THISNAME=BLANK8;                /* CLEAR TEMPORARY NAME BUFFER 0522
*                                                            @Y30DI3D*/
@RF00513 MVC   THISNAME(8),BLANK8                                  0522
*   DUPLNAME=NO;                    /* INIT FOR DUPLICATE NAME SCAN  */
         NI    DUPLNAME,B'11111110'                                0523
*   VERBGN=VERBEND+1;               /* POSITION AFTER VERB   @Y30DI3D*/
         LA    @07,1                                               0524
         AL    @07,VERBEND(,COMBASE)                               0524
         ST    @07,VERBGN(,COMBASE)                                0524
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/
         LCR   @07,@07                                             0525
         AL    @07,SAVEWTOR                                        0525
         ST    @07,WTORSIZE                                        0525
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON BLANK      */
         L     @03,VERBGN(,COMBASE)                                0526
         L     @07,WTORSIZE                                        0526
         BCTR  @07,0                                               0526
         EX    @07,@SB00761                                        0526
*   BC(8,EQEOF);                    /* NO PARMS              @Y30DI3D*/
         BC    8,EQEOF                                             0527
*   VERBEND=R1-1;                   /* INIT FOR DLIMSCAN     @Y30DI3D*/
         LR    @07,R1                                              0528
         BCTR  @07,0                                               0528
         ST    @07,VERBEND(,COMBASE)                               0528
*   CALL DLIMSCAN;                  /*                       @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0529
*   THISNAME=OPERAND(1:OPSIZE);     /* SAVE NAME             @Y30DI3D*/
         MVI   THISNAME+1,C' '                                     0530
         MVC   THISNAME+2(6),THISNAME+1                            0530
         LR    @07,OPSIZE                                          0530
         BCTR  @07,0                                               0530
         L     @15,VERBGN(,COMBASE)                                0530
         EX    @07,@SM00780                                        0530
*   IF DELIMCD=BLANK THEN           /* SCAN FOR VALID NAME   @Y30DI3D*/
         CLC   DELIMCD(4,COMBASE),@CF00242                         0531
         BNE   @RF00531                                            0531
*     IF I>1 THEN                   /* SCAN NAME TABLE FOR DUPLICATE
*                                      NAME                          */
         LA    @07,1                                               0532
         C     @07,I                                               0532
         BNL   @RF00532                                            0532
*       DO E=1 TO(I-1) WHILE DUPLNAME=NO;/*                  @Y30DI3D*/
         B     @DE00533                                            0533
@DL00533 TM    DUPLNAME,B'00000001'                                0533
         BNZ   @DC00533                                            0533
*         IF THISNAME=NAMES(E) THEN                                0534
         SLA   @07,3                                               0534
         LA    @15,NAMES-8(@07)                                    0534
         CLC   THISNAME(8),0(@15)                                  0534
         BNE   @RF00534                                            0534
*           DUPLNAME=YES;           /* MATCH FOUND           @Y30DI3D*/
         OI    DUPLNAME,B'00000001'                                0535
*         ELSE                                                     0536
*           ;                       /*                       @Y30DI3D*/
@RF00534 DS    0H                                                  0537
*       END;                        /*                       @Y30DI3D*/
         LA    @07,1                                               0537
         AL    @07,E                                               0537
@DE00533 ST    @07,E                                               0537
         L     @00,I                                               0537
         BCTR  @00,0                                               0537
         CR    @07,@00                                             0537
         BNH   @DL00533                                            0537
@DC00533 DS    0H                                                  0538
*     ELSE                                                         0538
*       ;                           /*                       @Y30DI3D*/
@RF00532 DS    0H                                                  0539
*   ELSE                                                           0539
*     SYNTAXCD=INVDELIM;            /* INVALID DELIMETER AFTER NAME  */
         B     @RC00531                                            0539
@RF00531 MVI   SYNTAXCD,X'02'                                      0539
*   IF SYNTAXCD=GOOD&DUPLNAME=NO THEN/* UNUSED NAME                  */
@RC00531 CLI   SYNTAXCD,X'00'                                      0540
         BNE   @RF00540                                            0540
         TM    DUPLNAME,B'00000001'                                0540
         BNZ   @RF00540                                            0540
*     IF OPSIZE>0&OPSIZE<9 THEN     /* SCAN FOR DIGITS       @Y30DI3D*/
         LTR   OPSIZE,OPSIZE                                       0541
         BNP   @RF00541                                            0541
         CH    OPSIZE,@CH00172                                     0541
         BNL   @RF00541                                            0541
*       DO N=1 TO OPSIZE WHILE SYNTAXCD=GOOD;/*              @Y30DI3D*/
         LA    @07,1                                               0542
         B     @DE00542                                            0542
@DL00542 CLI   SYNTAXCD,X'00'                                      0542
         BNE   @DC00542                                            0542
*         IF OPERAND(N)>='A'&OPERAND(N)<='I'×OPERAND(N)>='J'&OPERAND(N)
*             <='R'×OPERAND(N)>='S'&OPERAND(N)<='Z'×OPERAND(N)>='0'&
*             OPERAND(N)<='9' THEN                                 0543
         L     @15,VERBGN(,COMBASE)                                0543
         ALR   @07,@15                                             0543
         BCTR  @07,0                                               0543
         CLI   OPERAND(@07),C'A'                                   0543
         BL    @GL00046                                            0543
         L     @07,N                                               0543
         ALR   @15,@07                                             0543
         BCTR  @15,0                                               0543
         CLI   OPERAND(@15),C'I'                                   0543
         BNH   @RT00543                                            0543
@GL00046 L     @07,N                                               0543
         L     @15,VERBGN(,COMBASE)                                0543
         ALR   @07,@15                                             0543
         BCTR  @07,0                                               0543
         CLI   OPERAND(@07),C'J'                                   0543
         BL    @GL00045                                            0543
         L     @07,N                                               0543
         ALR   @15,@07                                             0543
         BCTR  @15,0                                               0543
         CLI   OPERAND(@15),C'R'                                   0543
         BNH   @RT00543                                            0543
@GL00045 L     @07,N                                               0543
         L     @15,VERBGN(,COMBASE)                                0543
         ALR   @07,@15                                             0543
         BCTR  @07,0                                               0543
         CLI   OPERAND(@07),C'S'                                   0543
         BL    @GL00044                                            0543
         L     @07,N                                               0543
         ALR   @15,@07                                             0543
         BCTR  @15,0                                               0543
         CLI   OPERAND(@15),C'Z'                                   0543
         BNH   @RT00543                                            0543
@GL00044 L     @07,N                                               0543
         L     @15,VERBGN(,COMBASE)                                0543
         ALR   @07,@15                                             0543
         BCTR  @07,0                                               0543
         CLI   OPERAND(@07),C'0'                                   0543
         BL    @RF00543                                            0543
         L     @07,N                                               0543
         ALR   @15,@07                                             0543
         BCTR  @15,0                                               0543
         CLI   OPERAND(@15),C'9'                                   0543
         BNH   @RT00543                                            0543
*           ;                       /*                       @Y30DI3D*/
*         ELSE                                                     0545
*           SYNTAXCD=INVNAME;       /* NAME NOT ALPHAMERIC   @Y30DI3D*/
@RF00543 MVI   SYNTAXCD,X'04'                                      0545
*       END;                        /*                       @Y30DI3D*/
@RT00543 LA    @07,1                                               0546
         AL    @07,N                                               0546
@DE00542 ST    @07,N                                               0546
         CR    @07,OPSIZE                                          0546
         BNH   @DL00542                                            0546
@DC00542 DS    0H                                                  0547
*     ELSE                          /* INVALID LENGTH ON NAME      0547
*                                                            @Y30DI3D*/
*       SYNTAXCD=INVNAME;           /*                       @Y30DI3D*/
         B     @RC00541                                            0547
@RF00541 MVI   SYNTAXCD,X'04'                                      0547
*   IF SYNTAXCD=GOOD THEN           /* SCAN FOR ADDRESS      @Y30DI3D*/
@RC00541 DS    0H                                                  0548
@RF00540 CLI   SYNTAXCD,X'00'                                      0548
         BNE   @RF00548                                            0548
*     DO;                           /*                       @Y30DI3D*/
*       VERBGN=VERBEND+1;           /* POSITION AFTER NAME   @Y30DI3D*/
         LA    @07,1                                               0550
         AL    @07,VERBEND(,COMBASE)                               0550
         ST    @07,VERBGN(,COMBASE)                                0550
*       WTORSIZE=SAVEWTOR-VERBGN;   /* REMAINING BUFFER AREA @Y30DI3D*/
         LCR   @07,@07                                             0551
         AL    @07,SAVEWTOR                                        0551
         ST    @07,WTORSIZE                                        0551
*       TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NONBLANK   */
         L     @03,VERBGN(,COMBASE)                                0552
         L     @07,WTORSIZE                                        0552
         BCTR  @07,0                                               0552
         EX    @07,@SB00761                                        0552
*       BC(8,EQEOF);                /* NO ADDITIONAL PARMS   @Y30DI3D*/
         BC    8,EQEOF                                             0553
*       VERBEND=R1-1;               /* INIT FOR DLIMSCAN     @Y30DI3D*/
         LR    @07,R1                                              0554
         BCTR  @07,0                                               0554
         ST    @07,VERBEND(,COMBASE)                               0554
*       CALL DLIMSCAN;              /*                       @Y30DI3D*/
         BAL   @14,DLIMSCAN                                        0555
*       IF DELIMCD=BLANK THEN                                      0556
         CLC   DELIMCD(4,COMBASE),@CF00242                         0556
         BNE   @RF00556                                            0556
*         IF OPSIZE>0&OPSIZE<9 THEN /* LENGTH IS OK          @Y30DI3D*/
         LTR   OPSIZE,OPSIZE                                       0557
         BNP   @RF00557                                            0557
         CH    OPSIZE,@CH00172                                     0557
         BNL   @RF00557                                            0557
*           DO;                     /*                       @Y30DI3D*/
*             CALL DIGITSCN;        /* SCAN FOR VALID ADDRESS      0559
*                                                            @Y30DI3D*/
         BAL   @14,DIGITSCN                                        0559
*             IF SYNTAXCD=GOOD THEN /* ADDRESS IS OK         @Y30DI3D*/
         CLI   SYNTAXCD,X'00'                                      0560
         BNE   @RF00560                                            0560
*               IF DUPLNAME=YES THEN/* UPDATE NAME AND ADDR TABLES   */
         TM    DUPLNAME,B'00000001'                                0561
         BNO   @RF00561                                            0561
*                 DO;               /*                       @Y30DI3D*/
*                   CALL EQMSGRTN;  /* ISSUE MESSAGE         @Y30DI3D*/
         BAL   @14,EQMSGRTN                                        0563
*                   ADDRSTOR(E-1)=NUM3;/* CHANGE ADDRESS     @Y30DI3D*/
         L     @07,E                                               0564
         MH    @07,@CH00155                                        0564
         LA    @05,ADDRSTOR-10(@07)                                0564
         MVC   0(5,@05),NUM3                                       0564
*                 END;              /*                       @Y30DI3D*/
*               ELSE                                               0566
*                 DO;               /*                       @Y30DI3D*/
         B     @RC00561                                            0566
@RF00561 DS    0H                                                  0567
*                   NAMES(I)=THISNAME;/* SAVE NEW NAME       @Y30DI3D*/
         L     @07,I                                               0567
         LR    @05,@07                                             0567
         SLA   @05,3                                               0567
         LA    @15,NAMES-8(@05)                                    0567
         MVC   0(8,@15),THISNAME                                   0567
*                   ADDRSTOR(I)=NUM3;/* SAVE ADDRESS         @Y30DI3D*/
         LR    @05,@07                                             0568
         MH    @05,@CH00155                                        0568
         LA    @15,ADDRSTOR-5(@05)                                 0568
         MVC   0(5,@15),NUM3                                       0568
*                   I=I+1;          /* INCR I FOR NEXT EQUATE        */
         AH    @07,@CH00058                                        0569
         ST    @07,I                                               0569
*                 END;              /*                       @Y30DI3D*/
*             ELSE                                                 0571
*               ;                   /*                       @Y30DI3D*/
@RF00560 DS    0H                                                  0572
*           END;                    /*                       @Y30DI3D*/
*         ELSE                                                     0573
*           SYNTAXCD=INVADDR;       /* INVALID ADDR AFTER NAME       */
         B     @RC00557                                            0573
@RF00557 MVI   SYNTAXCD,X'05'                                      0573
*       ELSE                                                       0574
*         SYNTAXCD=INVDELIM;        /* INVALID DELIM AFTER ADDR      */
         B     @RC00556                                            0574
@RF00556 MVI   SYNTAXCD,X'02'                                      0574
*     END;                          /*                       @Y30DI3D*/
*   GOTO ENDEQUAT;                  /*                       @Y30DI3D*/
         B     ENDEQUAT                                            0576
*EQEOF:                                                            0577
*   SYNTAXCD=NOPARMS;               /* MISSING PARMS ON EQUATE VERB
*                                                            @Y30DI3D*/
EQEOF    MVI   SYNTAXCD,X'03'                                      0577
*ENDEQUAT:                                                         0578
*   RESPECIFY                                                      0578
*     R1 UNRESTRICTED;              /*                       @Y30DI3D*/
*   END EQUATRTN;                   /*                       @Y30DI3D*/
@EL00007 DS    0H                                                  0579
@EF00007 DS    0H                                                  0579
@ER00007 LM    @14,@12,@SA00007                                    0579
         BR    @14                                                 0579
*                                                                  0580
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*    THIS ROUTINE WRITES THE MESSAGE FOR DUPLICATE EQUATES @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0580
*EQMSGRTN:                                                         0580
*   PROCEDURE;                      /*                       @Y30DI3D*/
EQMSGRTN STM   @14,@12,@SA00008                                    0580
*   THISMSG=BLANK80;                /*                       @Y30DI3D*/
         MVC   THISMSG(80),BLANK80                                 0581
*   ADDR4=NUM3;                     /* INIT FOR NEW ADDRESS  @Y30DI3D*/
         MVC   ADDR4(5),NUM3                                       0582
*   ADDR5=ADDRSTOR(E-1);            /* GET OLD ADDRESS       @Y30DI3D*/
         L     @07,E                                               0583
         LR    @05,@07                                             0583
         MH    @05,@CH00155                                        0583
         LA    @01,ADDRSTOR-10(@05)                                0583
         MVC   ADDR5(5),0(@01)                                     0583
*   UNPK(EQMSG(1:7),ADDR4(2:5));    /* TRANSLATE TO PRINTABLE HEX    */
         UNPK  EQMSG(7),ADDR4+1(4)                                 0584
*   TR(ADDRESS1,EBCTABL);           /*                       @Y30DI3D*/
         TR    ADDRESS1(6),EBCTABL(COMBASE)                        0585
*   EQMSG(7)=BLANK1;                /*                       @Y30DI3D*/
         MVI   EQMSG+6,C' '                                        0586
*   UNPK(EQMSG(17:23),ADDR5(2:5));  /*                       @Y30DI3D*/
         UNPK  EQMSG+16(7),ADDR5+1(4)                              0587
*   TR(ADDRESS2,EBCTABL);           /*                       @Y30DI3D*/
         TR    ADDRESS2(6),EBCTABL(COMBASE)                        0588
*   EQMSG(23)=BLANK1;               /*                       @Y30DI3D*/
         MVI   EQMSG+22,C' '                                       0589
*   NAMEHOLD=NAMES(E-1);            /* PUT DUPLICATE NAME IN MESSAGE */
         SLA   @07,3                                               0590
         LA    @05,NAMES-16(@07)                                   0590
         MVC   NAMEHOLD(8),0(@05)                                  0590
*   THISMSG(1:48)=EQMSG;            /*                       @Y30DI3D*/
         MVC   THISMSG(48),EQMSG                                   0591
*   DMPMSG03=THISMSG;               /* FOR CONSOLE OUTPUT    @Y30DI3D*/
         MVC   DMPMSG03(80),THISMSG                                0592
*   MSGADDR=ADDR(THISMSG);          /* FOR TERMINAL OUTPUT   @Y30DI3D*/
         LA    MSGADDR,THISMSG                                     0593
*   CALL WRITRTN;                   /* WRITE MESSAGE TO APPROPRIATE
*                                      DEVICE                        */
         BAL   @14,WRITRTN                                         0594
*   DMPMSG03=BLANK80;               /* SKIP LINE ON CONSOLE  @Y30DI3D*/
         MVC   DMPMSG03(80),BLANK80                                0595
*   MSGADDR=ADDR(BLANK80);          /* SKIP LINE ON TERMINAL @Y30DI3D*/
         LA    MSGADDR,BLANK80                                     0596
*   CALL WRITRTN;                   /*                       @Y30DI3D*/
         BAL   @14,WRITRTN                                         0597
*   END EQMSGRTN;                   /*                       @Y30DI3D*/
@EL00008 DS    0H                                                  0598
@EF00008 DS    0H                                                  0598
@ER00008 LM    @14,@12,@SA00008                                    0598
         BR    @14                                                 0598
*                                                                  0599
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*  THIS ROUTINE ALLOWS A COMMENT OF UP TO 78 CHARACTERS LONG       */
*/*  TO BE WRITTEN TO THE PRINTER                            @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0599
*COMMRTN:                                                          0599
*   PROCEDURE;                      /*                       @Y30DI3D*/
COMMRTN  STM   @14,@12,@SA00009                                    0599
*   RESPECIFY                                                      0600
*     R1 RESTRICTED;                /*                       @Y30DI3D*/
*   VERBGN=VERBEND+1;               /* POSITION AFTER LAST DELIMETER */
         LA    @07,1                                               0601
         AL    @07,VERBEND(,COMBASE)                               0601
         ST    @07,VERBGN(,COMBASE)                                0601
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/
         LCR   @07,@07                                             0602
         AL    @07,SAVEWTOR                                        0602
         ST    @07,WTORSIZE                                        0602
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SEARCH FOR START OF COMMENT  */
         L     @03,VERBGN(,COMBASE)                                0603
         L     @07,WTORSIZE                                        0603
         BCTR  @07,0                                               0603
         EX    @07,@SB00761                                        0603
*   VERBGN=R1;                      /* ADDRESS OF BEGINNING OF     0604
*                                      COMMENT                       */
         ST    R1,VERBGN(,COMBASE)                                 0604
*   COMMAREA=BLANK80;               /* CLEAR OUTPUT BUFFER   @Y30DI3D*/
         L     @07,OUTBUFAD                                        0605
         MVC   COMMAREA(80,@07),BLANK80                            0605
*   COMMAREA(1:WTORSIZE)=OPERAND(1:WTORSIZE);/*              @Y30DI3D*/
         L     @05,WTORSIZE                                        0606
         BCTR  @05,0                                               0606
         L     @15,VERBGN(,COMBASE)                                0606
         EX    @05,@SM00783                                        0606
*   GEN REFS(AWRITE)(BRWRITE 1);    /* WRITE COMMENT TO PRINTER      */
         BRWRITE 1
*   COMMAREA=BLANK80;               /*                       @Y30DI3D*/
         L     @07,OUTBUFAD                                        0608
         MVC   COMMAREA(80,@07),BLANK80                            0608
*   GEN REFS(AWRITE)(BRWRITE 1);    /* SKIP LINE             @Y30DI3D*/
         BRWRITE 1
*   RESPECIFY                                                      0610
*     R1 UNRESTRICTED;              /*                       @Y30DI3D*/
*   END COMMRTN;                    /*                       @Y30DI3D*/
@EL00009 DS    0H                                                  0611
@EF00009 DS    0H                                                  0611
@ER00009 LM    @14,@12,@SA00009                                    0611
         BR    @14                                                 0611
*                                                                  0612
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*  THIS ROUTINE WRITES AN ERROR MESSAGE TO THE OUTPUT DEVICE       */
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0612
*ERRORTN:                                                          0612
*   PROCEDURE;                      /*                       @Y30DI3D*/
ERRORTN  STM   @14,@12,@SA00010                                    0612
*   THISMSG=BLANK80;                /* CLEAR MESSAGE BUFFER  @Y30DI3D*/
         MVC   THISMSG(80),BLANK80                                 0613
*   IF SYNTAXCD=INVDELIM THEN                                      0614
         CLI   SYNTAXCD,X'02'                                      0614
         BNE   @RF00614                                            0614
*     THISMSG(1:17)=BADDLM;         /*                       @Y30DI3D*/
         MVC   THISMSG(17),BADDLM                                  0615
*   ELSE                                                           0616
*     IF SYNTAXCD=INVSVRB THEN                                     0616
         B     @RC00614                                            0616
@RF00614 CLI   SYNTAXCD,X'01'                                      0616
         BNE   @RF00616                                            0616
*       THISMSG(1:15)=BADSVB;       /*                       @Y30DI3D*/
         MVC   THISMSG(15),BADSVB                                  0617
*     ELSE                                                         0618
*       IF SYNTAXCD=INVOFST THEN                                   0618
         B     @RC00616                                            0618
@RF00616 CLI   SYNTAXCD,X'07'                                      0618
         BNE   @RF00618                                            0618
*         THISMSG(1:20)=BADOFT;     /*                       @Y30DI3D*/
         MVC   THISMSG(20),BADOFT                                  0619
*       ELSE                                                       0620
*         IF SYNTAXCD=LNOTDEC THEN                                 0620
         B     @RC00618                                            0620
@RF00618 CLI   SYNTAXCD,X'0C'                                      0620
         BNE   @RF00620                                            0620
*           THISMSG(1:18)=NOTDEC;   /*                       @Y30DI3D*/
         MVC   THISMSG(18),NOTDEC                                  0621
*         ELSE                                                     0622
*           IF SYNTAXCD=INVLEN THEN                                0622
         B     @RC00620                                            0622
@RF00620 CLI   SYNTAXCD,X'0B'                                      0622
         BNE   @RF00622                                            0622
*             THISMSG(1:14)=BADLEN; /*                       @Y30DI3D*/
         MVC   THISMSG(14),BADLEN                                  0623
*           ELSE                                                   0624
*             IF SYNTAXCD=INVASID THEN                             0624
         B     @RC00622                                            0624
@RF00622 CLI   SYNTAXCD,X'09'                                      0624
         BNE   @RF00624                                            0624
*               THISMSG(1:19)=BADASD;/*                      @Y30DI3D*/
         MVC   THISMSG(19),BADASD                                  0625
*             ELSE                                                 0626
*               IF SYNTAXCD=INVADDR THEN                           0626
         B     @RC00624                                            0626
@RF00624 CLI   SYNTAXCD,X'05'                                      0626
         BNE   @RF00626                                            0626
*                 THISMSG(1:52)=BADADR;/*                    @Y30DI3D*/
         MVC   THISMSG(52),BADADR                                  0627
*               ELSE                                               0628
*                 IF SYNTAXCD=INVNAME THEN                         0628
         B     @RC00626                                            0628
@RF00626 CLI   SYNTAXCD,X'04'                                      0628
         BNE   @RF00628                                            0628
*                   THISMSG(1:54)=BADNME;/*                  @Y30DI3D*/
         MVC   THISMSG(54),BADNME                                  0629
*                 ELSE                                             0630
*                   IF SYNTAXCD=INVDIGIT THEN                      0630
         B     @RC00628                                            0630
@RF00628 CLI   SYNTAXCD,X'06'                                      0630
         BNE   @RF00630                                            0630
*                     THISMSG(1:40)=BADDGT;/*                @Y30DI3D*/
         MVC   THISMSG(40),BADDGT                                  0631
*                   ELSE                                           0632
*                     IF SYNTAXCD=NOTINTBL THEN                    0632
         B     @RC00630                                            0632
@RF00630 CLI   SYNTAXCD,X'0A'                                      0632
         BNE   @RF00632                                            0632
*                       THISMSG(1:23)=NINTBL;/*              @Y30DI3D*/
         MVC   THISMSG(23),NINTBL                                  0633
*                     ELSE                                         0634
*                       IF SYNTAXCD=NOPARMS THEN                   0634
         B     @RC00632                                            0634
@RF00632 CLI   SYNTAXCD,X'03'                                      0634
         BNE   @RF00634                                            0634
*                         THISMSG(1:20)=NOPARM;/*            @Y30DI3D*/
         MVC   THISMSG(20),NOPARM                                  0635
*                       ELSE                                       0636
*                         THISMSG(1:17)=BADPRM;/*            @Y30DI3D*/
         B     @RC00634                                            0636
@RF00634 MVC   THISMSG(17),BADPRM                                  0636
*   DMPMSG03=THISMSG;               /* INIT FOR CONSOLE      @Y30DI3D*/
@RC00634 DS    0H                                                  0637
@RC00632 DS    0H                                                  0637
@RC00630 DS    0H                                                  0637
@RC00628 DS    0H                                                  0637
@RC00626 DS    0H                                                  0637
@RC00624 DS    0H                                                  0637
@RC00622 DS    0H                                                  0637
@RC00620 DS    0H                                                  0637
@RC00618 DS    0H                                                  0637
@RC00616 DS    0H                                                  0637
@RC00614 MVC   DMPMSG03(80),THISMSG                                0637
*   MSGADDR=ADDR(THISMSG);          /* INIT FOR TERMINAL OUTPUT    0638
*                                                            @Y30DI3D*/
         LA    MSGADDR,THISMSG                                     0638
*   CALL WRITRTN;                   /* WRITE MESSAGE TO OUTPUT DEVICE*/
         BAL   @14,WRITRTN                                         0639
*   DMPMSG03=BLANK80;               /* SKIP LINE ON CONSOLE  @Y30DI3D*/
         MVC   DMPMSG03(80),BLANK80                                0640
*   MSGADDR=ADDR(BLANK80);          /* SKIP LINE ON TERMINAL @Y30DI3D*/
         LA    MSGADDR,BLANK80                                     0641
*   CALL WRITRTN;                   /*                       @Y30DI3D*/
         BAL   @14,WRITRTN                                         0642
*   END ERRORTN;                    /*                       @Y30DI3D*/
@EL00010 DS    0H                                                  0643
@EF00010 DS    0H                                                  0643
@ER00010 LM    @14,@12,@SA00010                                    0643
         BR    @14                                                 0643
*                                                                  0644
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/* THIS ROUTINE WRITES OUTPUT TO THE TERMINAL OR CONSOLE.   @Y30DI3D*/
*/* IF NEITHER IS AVAILABLE AND ERROR MESSAGE IS WRITTEN TO SYSPRINT */
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0644
*WRITRTN:                                                          0644
*   PROCEDURE;                      /*                       @Y30DI3D*/
WRITRTN  STM   @14,@12,@SA00011                                    0644
*   RESPECIFY                                                      0645
*     R1 RESTRICTED;                /*                       @Y30DI3D*/
*   IF TERMINAL=OPEN THEN                                          0646
         TM    TERMINAL,B'10000000'                                0646
         BNO   @RF00646                                            0646
*     GEN REFS(TSODCB) FLOWS(TSOERR)(PUT TSODCB,(MSGADDR));        0647
         PUT TSODCB,(MSGADDR)
*   ELSE                                                           0648
*     IF RDRSW=OFF THEN                                            0648
         B     @RC00646                                            0648
@RF00646 TM    RDRSW(COMBASE),B'00000001'                          0648
         BNZ   @RF00648                                            0648
*       DO;                         /*                       @Y30DI3D*/
*         MSGADDR=ADDR(DMPMSG);     /*                       @Y30DI3D*/
         LA    MSGADDR,DMPMSG                                      0650
*         R1=MSGADDR;               /*                       @Y30DI3D*/
         LR    R1,MSGADDR                                          0651
*         GEN(WTO MF=(E,(R1)));     /* PRINT TO CONSOLE      @Y30DI3D*/
         WTO MF=(E,(R1))
*       END;                        /*                       @Y30DI3D*/
*     ELSE                          /* NO OUTPUT DEVICE AVAILABLE  0654
*                                                            @Y30DI3D*/
*       GEN REFS(APRTMSG)(BRPRTMSG NODEV,30);/*              @Y30DI3D*/
         B     @RC00648                                            0654
@RF00648 DS    0H                                                  0654
         BRPRTMSG NODEV,30
*   RESPECIFY                                                      0655
*     R1 UNRESTRICTED;              /*                       @Y30DI3D*/
*   END WRITRTN;                    /*                       @Y30DI3D*/
@EL00011 DS    0H                                                  0656
@EF00011 DS    0H                                                  0656
@ER00011 LM    @14,@12,@SA00011                                    0656
         BR    @14                                                 0656
*                                                                  0657
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*   ROUTINE TO SCAN FOR THE NEXT DELIMETER AND RETURN THE SIZE     */
*/*   AND ADDRESS OF THE OPERAND                             @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0657
*DLIMSCAN:                                                         0657
*   PROCEDURE;                      /*                       @Y30DI3D*/
DLIMSCAN STM   @14,@04,12(@13)                                     0657
         STM   @06,@12,44(@13)                                     0657
*   RESPECIFY                                                      0658
*    (R2,                                                          0658
*     R1) RESTRICTED;               /*                       @Y30DI3D*/
*   VERBGN=VERBEND+1;               /* START WITH CHAR AFTER LAST  0659
*                                      DELIM                         */
         LA    @07,1                                               0659
         AL    @07,VERBEND(,COMBASE)                               0659
         ST    @07,VERBGN(,COMBASE)                                0659
*   R1=0;                           /*                       @Y30DI3D*/
         SLR   R1,R1                                               0660
*   R2=0;                           /*                       @Y30DI3D*/
         SLR   R2,R2                                               0661
*   TRT(OPERAND,DLIMTBL);           /* SCAN FOR DELIMETER    @Y30DI3D*/
         L     @03,VERBGN(,COMBASE)                                0662
         TRT   OPERAND(78,@03),DLIMTBL                             0662
*   VERBEND=R1;                     /* ADDR OF DELIMETER     @Y30DI3D*/
         ST    R1,VERBEND(,COMBASE)                                0663
*   DELIMCD=R2;                     /* DELIMETER CODE NUMBER @Y30DI3D*/
         ST    R2,DELIMCD(,COMBASE)                                0664
*   OPSIZE=VERBEND-VERBGN;          /* SIZE OF OPERAND       @Y30DI3D*/
         L     @07,VERBEND(,COMBASE)                               0665
         SL    @07,VERBGN(,COMBASE)                                0665
         LR    OPSIZE,@07                                          0665
*   RESPECIFY                                                      0666
*    (R2,                                                          0666
*     R1) UNRESTRICTED;             /*                       @Y30DI3D*/
*   END DLIMSCAN;                   /*                       @Y30DI3D*/
@EL00012 DS    0H                                                  0667
@EF00012 DS    0H                                                  0667
@ER00012 LM    @14,@04,12(@13)                                     0667
         LM    @06,@12,44(@13)                                     0667
         BR    @14                                                 0667
*                                                                  0668
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*   THIS ROUTINE CHECKS TO SEE IF AN ADDRESS OR AN ASID IS A VALID */
*/*   NUMBER                                                 @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0668
*DIGITSCN:                                                         0668
*   PROCEDURE;                      /*                       @Y30DI3D*/
DIGITSCN STM   @14,@12,12(@13)                                     0668
*   DO N=1 TO OPSIZE WHILE SYNTAXCD=GOOD;/* CHECK EACH DIGIT         */
         LA    @07,1                                               0669
         B     @DE00669                                            0669
@DL00669 CLI   SYNTAXCD,X'00'                                      0669
         BNE   @DC00669                                            0669
*     IF OPERAND(N)>='0'&OPERAND(N)<='9'×OPERAND(N)>='A'&OPERAND(N)<='F
*       THEN                                                       0670
         L     @15,VERBGN(,COMBASE)                                0670
         ALR   @07,@15                                             0670
         BCTR  @07,0                                               0670
         CLI   OPERAND(@07),C'0'                                   0670
         BL    @GL00052                                            0670
         L     @07,N                                               0670
         ALR   @15,@07                                             0670
         BCTR  @15,0                                               0670
         CLI   OPERAND(@15),C'9'                                   0670
         BNH   @RT00670                                            0670
@GL00052 L     @07,N                                               0670
         L     @15,VERBGN(,COMBASE)                                0670
         ALR   @07,@15                                             0670
         BCTR  @07,0                                               0670
         CLI   OPERAND(@07),C'A'                                   0670
         BL    @RF00670                                            0670
         L     @07,N                                               0670
         ALR   @15,@07                                             0670
         BCTR  @15,0                                               0670
         CLI   OPERAND(@15),C'F'                                   0670
         BNH   @RT00670                                            0670
*       ;                           /* GOOD DIGIT                    */
*     ELSE                          /* INPUT NOT NUMERIC             */
*       SYNTAXCD=INVDIGIT;          /*                       @Y30DI3D*/
@RF00670 MVI   SYNTAXCD,X'06'                                      0672
*   END;                            /*                       @Y30DI3D*/
@RT00670 LA    @07,1                                               0673
         AL    @07,N                                               0673
@DE00669 ST    @07,N                                               0673
         CR    @07,OPSIZE                                          0673
         BNH   @DL00669                                            0673
@DC00669 DS    0H                                                  0674
*   IF SYNTAXCD=GOOD THEN           /* CONVERT TO BINARY             */
         CLI   SYNTAXCD,X'00'                                      0674
         BNE   @RF00674                                            0674
*     DO;                           /*                       @Y30DI3D*/
*       TR(OPERAND(1:OPSIZE),HEXTABL);/*                     @Y30DI3D*/
         L     @07,VERBGN(,COMBASE)                                0676
         LR    @15,OPSIZE                                          0676
         BCTR  @15,0                                               0676
         EX    @15,@SB00785                                        0676
*       CHARWORK=BLANK6;            /*                       @Y30DI3D*/
         MVC   CHARWORK(6),@CC00388                                0677
*       CHARWORK((7-OPSIZE):6)=OPERAND(1:OPSIZE);/*          @Y30DI3D*/
         LA    @15,7                                               0678
         SLR   @15,OPSIZE                                          0678
         LA    @14,CHARWORK-1(@15)                                 0678
         LCR   @15,@15                                             0678
         AH    @15,@CH00387                                        0678
         EX    @15,@SM00787                                        0678
*       PACK(NUM2,CHARWORK);        /*                       @Y30DI3D*/
         PACK  NUM2(4),CHARWORK(6)                                 0679
*       MVO(NUM3,NUM2);             /*                       @Y30DI3D*/
         MVO   NUM3(5),NUM2(4)                                     0680
*     END;                          /*                       @Y30DI3D*/
*   END DIGITSCN;                   /*                       @Y30DI3D*/
@EL00013 DS    0H                                                  0682
@EF00013 DS    0H                                                  0682
@ER00013 LM    @14,@12,12(@13)                                     0682
         BR    @14                                                 0682
*                                                                  0683
*/********************************************************************/
*/*                                                          @Y30DI3D*/
*/*   THIS ROUTINE SCANS THE NAME TABLE MADE IN EQUATRTN WHEN        */
*/* RELATIVE ADDRESSING IS USED IN THE 'LIST' SUBVERB        @Y30DI3D*/
*/*                                                          @Y30DI3D*/
*/********************************************************************/
*                                                                  0683
*NAMESCAN:                                                         0683
*   PROCEDURE;                      /*                       @Y30DI3D*/
NAMESCAN STM   @14,@12,12(@13)                                     0683
*   SEARCHON=YES;                   /*                       @Y30DI3D*/
         OI    SEARCHON,B'01000000'                                0684
*   THISNAME=OPERAND(1:OPSIZE);     /* GET NAME              @Y30DI3D*/
         MVI   THISNAME+1,C' '                                     0685
         MVC   THISNAME+2(6),THISNAME+1                            0685
         LR    @07,OPSIZE                                          0685
         BCTR  @07,0                                               0685
         L     @01,VERBGN(,COMBASE)                                0685
         EX    @07,@SM00790                                        0685
*   DO T=1 TO I WHILE SEARCHON=YES; /*                       @Y30DI3D*/
         LA    @07,1                                               0686
         B     @DE00686                                            0686
@DL00686 TM    SEARCHON,B'01000000'                                0686
         BNO   @DC00686                                            0686
*     IF THISNAME=NAMES(T) THEN                                    0687
         SLA   @07,3                                               0687
         LA    @01,NAMES-8(@07)                                    0687
         CLC   THISNAME(8),0(@01)                                  0687
         BNE   @RF00687                                            0687
*       SEARCHON=NO;                /* NAME FOUND,DISCONTINUE SCAN 0688
*                                                            @Y30DI3D*/
         NI    SEARCHON,B'10111111'                                0688
*     ELSE                                                         0689
*       ;                           /*                       @Y30DI3D*/
@RF00687 DS    0H                                                  0690
*   END;                            /*                       @Y30DI3D*/
         LA    @07,1                                               0690
         AL    @07,T                                               0690
@DE00686 ST    @07,T                                               0690
         C     @07,I                                               0690
         BNH   @DL00686                                            0690
@DC00686 DS    0H                                                  0691
*   IF SEARCHON=NO THEN                                            0691
         TM    SEARCHON,B'01000000'                                0691
         BNZ   @RF00691                                            0691
*     NUM3=ADDRSTOR(T-1);           /*                       @Y30DI3D*/
         L     @07,T                                               0692
         MH    @07,@CH00155                                        0692
         LA    @01,ADDRSTOR-10(@07)                                0692
         MVC   NUM3(5),0(@01)                                      0692
*   ELSE                                                           0693
*     SYNTAXCD=NOTINTBL;            /*                       @Y30DI3D*/
         B     @RC00691                                            0693
@RF00691 MVI   SYNTAXCD,X'0A'                                      0693
*   END NAMESCAN;                   /*                       @Y30DI3D*/
@EL00014 DS    0H                                                  0694
@EF00014 DS    0H                                                  0694
@ER00014 LM    @14,@12,12(@13)                                     0694
         BR    @14                                                 0694
*   END AMDPRFDS                    /*                       @Y30DI3D*/
*                                                                  0695
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (COMMON  )                                       */
*                                                                  0695
*       ;                                                          0695
@DATA    DS    0H
@CH00058 DC    H'1'
@CH00165 DC    H'2'
@CH00150 DC    H'3'
@CH00155 DC    H'5'
@CH00387 DC    H'6'
@CH00686 DC    H'7'
@CH00044 DC    H'8'
@CH00172 DC    H'9'
@CH00412 DC    H'28'
@CH00382 DC    H'80'
@CH00152 DC    H'81'
@CH00174 DC    H'256'
@SB00761 TRT   OPERAND(0,@03),NONBLNK(COMBASE)
@SM00764 MVC   COMMAREA(0,@15),OPERAND(@07)
@SB00770 TR    OPERAND(0,@15),HEXTABL(COMBASE)
@SM00772 MVC   0(0,@07),OPERAND(@15)
@SM00776 MVC   FLDWORK(0,@03),0(@14)
@SM00780 MVC   THISNAME(0),OPERAND(@15)
@SM00783 MVC   COMMAREA(0,@07),OPERAND(@15)
@SB00785 TR    OPERAND(0,@07),HEXTABL(COMBASE)
@SM00787 MVC   0(0,@14),OPERAND(@07)
@SM00790 MVC   THISNAME(0),OPERAND(@01)
         DS    0F
@SA00001 DS    18F
@SA00011 DS    15F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00005 DS    15F
@SA00007 DS    15F
@SA00009 DS    15F
@SA00010 DS    15F
@SA00006 DS    15F
@SA00008 DS    15F
         DS    0F
@CF00157 DC    F'4'
@CH00157 EQU   @CF00157+2
@CF00242 DC    F'12'
@CF00185 DC    F'16'
@CF00215 DC    F'20'
@CF00224 DC    F'24'
@CH00224 EQU   @CF00224+2
@CF00414 DC    F'32'
@CF00432 DC    F'16777216'
         DS    0D
I        DC    F'1'
L        DS    F
T        DS    F
WORD     DS    F
HALF     DS    F
LINE     DC    F'0'
E        DS    F
N        DS    F
SAVEWTOR DS    A
WTORSIZE DS    A
WTORECB1 DC    F'0'
SIGN     DS    F
GOODNUM  DS    AL4
         ORG   GOODNUM
NUM3     DS    CL5
         ORG   GOODNUM+5
         DS    CL3
HEXCONV  DS    A
LEN1     DS    A
LOADDR   DS    A
HIADDR   DS    A
OUTBUFAD DS    A
SAVEBGN  DS    A
MSGADDR1 DS    A
MSGADDR2 DS    A
BUFFADDR DS    A
SAVEADDR DS    A
DATAPTR  DS    A
THISLINE DS    A
LOBYTE   DS    A
HIBYTE   DS    A
FAILADDR DS    A
READEND  DS    A
BLANKPTR DS    A
BLOCKEND DS    A
FDSSAVEA DS    A
BYTEOFST DS    F
BUFFEND  DS    A
THISOFST DS    A
READMASK DC    XL4'FFFFFFFC'
READCTR  DS    FL1
SAVE1    DS    AL3
         DS    CL1
SAVE2    DS    AL3
         DS    0D
@TS00001 DS    CL8
@CC00664 DC    C'HARDCOPY'
@CC00388 DC    C'      '
@CC00662 DC    C'RETURN'
@CC00668 DC    C'EQUATE'
@CC00666 DC    C'LIST'
@CC00696 DC    C'ASID'
@CC00661 EQU   @CC00662
@CC00678 DC    C'OFF'
@CC00663 DC    C'HC'
@CC00667 EQU   @CC00668
@CC00677 DC    C'ON'
@CB00436 DC    X'FFFF'
SYNTAXCD DS    CL1
PREVREAD DS    CL1
SUBVERB  DS    CL1
SWITCHES DS    CL1
         ORG   SWITCHES
HCOPYON  DS    BL1
FDSON    EQU   SWITCHES+0
ASIDSW   EQU   SWITCHES+0
OPSCAN   EQU   SWITCHES+0
SIGNSW   EQU   SWITCHES+0
MSGSW    EQU   SWITCHES+0
PREVSET  EQU   SWITCHES+0
PRINTOUT EQU   SWITCHES+0
         ORG   SWITCHES+1
MORESWS  DS    CL1
         ORG   MORESWS
TERMINAL DS    BL1
SEARCHON EQU   MORESWS+0
NONAME   EQU   MORESWS+0
NOMORE   EQU   MORESWS+0
FRSTFAIL EQU   MORESWS+0
CONTREAD EQU   MORESWS+0
DUMPMADE EQU   MORESWS+0
DUPLNAME EQU   MORESWS+0
         ORG   MORESWS+1
BLANK4   DS    CL81
         ORG   BLANK4
@NM00048 DC    81CL1' '
         ORG   BLANK4+81
BLANK8   DC    CL8'        '
BLANK80  DS    CL80
         ORG   BLANK80
@NM00049 DC    80CL1' '
         ORG   BLANK80+80
BLANK256 DS    CL256
         ORG   BLANK256
@NM00050 DC    256CL1' '
         ORG   BLANK256+256
THISNAME DS    CL8
CHARWORK DS    CL6
LEN2     DS    CL4
NUM2     DS    CL4
         DS    CL1
THISASID DS    BL2
LASTASID DS    BL2
DLIMTBL  DS    CL256
         ORG   DLIMTBL
@NM00051 DC    64AL1(0)
@NM00052 DC    AL1(12)
@NM00053 DC    10AL1(0)
@NM00054 DC    AL1(32)
@NM00055 DC    AL1(0)
@NM00056 DC    AL1(16)
@NM00057 DC    AL1(24)
@NM00058 DC    14AL1(0)
@NM00059 DC    AL1(20)
@NM00060 DC    2AL1(0)
@NM00061 DC    AL1(28)
@NM00062 DC    10AL1(0)
@NM00063 DC    AL1(4)
@NM00064 DC    18AL1(0)
@NM00065 DC    AL1(8)
@NM00066 DC    129AL1(0)
         ORG   DLIMTBL+256
IOMSG1   DC    CL60'PERMANENT I/O ERROR ON SYSIN - EXECUTION      TERMIC
               NATED'
IOMSG2   DC    CL60'PERMANENT I/O ERROR ON SYSTERM - EXECUTION     TERMC
               INATED'
THRU     DC    CL8' THROUGH'
REMNMSG  DC    CL21' COULD NOT BE PRINTED'
EOFMSG   DC    CL35'EOF ON SYSIN - EXECUTION TERMINATED'
RPLYMSG  DC    CL37'REPLY WITH DESIRED FUNCTION OR RETURN'
NODEV    DC    CL32'NO DEVICE AVAILABLE FOR OUTPUT'
NOMOREQ  DC    CL29'NUMBER OF EQUATES EXCEEDS 256'
EQMSG    DS    CL48
         ORG   EQMSG
ADDRESS1 DS    CL6
REPL     DC    CL10' REPLACES '
ADDRESS2 DS    CL6
ATNAME   DC    CL18' AT SYMBOLIC NAME '
NAMEHOLD DS    CL8
         ORG   EQMSG+48
ADDR4    DS    CL5
ADDR5    DS    CL5
MSGHOLD  DS    CL80
BUFFAREA DS    CL256
BADSVB   DC    CL15'INVALID SUBVERB'
BADDLM   DC    CL17'INVALID DELIMETER'
BADOFT   DC    CL20'OFFSET OVER 6 DIGITS'
NOTDEC   DC    CL18'LENGTH NOT DECIMAL'
BADASD   DC    CL19'INVALID ASID NUMBER'
BADADR   DC    CL52'ADDRESS GREATER THAN 6 DIGITS OR LESS THAN 1 DIGIT'
BADNME   DC    CL54'SYMBOLIC NAME NOT ALPHAMERIC OR NOT 1 TO 8 DIGITS LC
               ONG'
BADDGT   DC    CL40'INVALID DIGIT IN ADDRESS,OFFSET, OR ASID'
NINTBL   DC    CL23'SYMBOLIC NAME NOT FOUND'
NOPARM   DC    CL20'MISSING PARAMETER(S)'
BADPRM   DC    CL17'INVALID PARAMETER'
BADLEN   DC    CL14'INVALID LENGTH'
THISMSG  DS    CL80
         DS    CL3
DMPMSG   DS    CL88
         ORG   DMPMSG
DMPMSG01 DC    H'84'
DMPMSG02 DC    B'1000000000000000'
DMPMSG03 DS    CL80
DMPMSG04 DC    B'0000001000000000'
DMPMSG05 DC    B'0100000000000000'
         ORG   DMPMSG+88
NAMES    DS    256CL8
ADDRSTOR DS    256CL5
HCOPYBUF DS    9CL80
PATCH    DC    70F'0'
AMDPRFDS CSECT
*
DTAE     EQU   32                  DATA EBCDIC BIT
DTAC     EQU   16                  DATA IN CORE BIT
DTAP     EQU   8                   DATA PTR BIT
DTA      EQU   4                   DATA INCLUDED BIT
LBLP     EQU   2                   LABEL PTR BIT
LBL      EQU   1                   LABEL INCLUDED BIT
AMDPRFDS CSECT
*                                                          /*@Y30DI3D*/
TSODCB   DCB   DSORG=PS,DDNAME=SYSTERM,MACRF=PM,               @Y30DI3DX
               RECFM=FB,LRECL=78,BLKSIZE=80,SYNAD=TSOERR  /* OZ13018 */
AMDPRFDS CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
INLINE   EQU   @05
PREVADDR EQU   @05
FIELDPTR EQU   @05
BUFFPTR  EQU   @05
COMSIZE  EQU   @05
OPSIZE   EQU   @05
RITE     EQU   @05
BASE1    EQU   @11
BASE2    EQU   @10
BASE3    EQU   @09
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R6       EQU   @06
R13      EQU   @13
COMBASE  EQU   @12
REG8     EQU   @08
MSGADDR  EQU   @04
READADDR EQU   @02
BUFREG   EQU   @06
CNTREG   EQU   @03
LINEREG  EQU   @08
PREG     EQU   @01
R0       EQU   @00
R10      EQU   @10
R11      EQU   @11
R12      EQU   @12
R14      EQU   @14
R15      EQU   @15
R4       EQU   @04
R5       EQU   @05
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
STOPBASE EQU   @05
COMMON   EQU   0
ERRADDR  EQU   COMMON
VERBGN   EQU   COMMON+4
VERBEND  EQU   COMMON+8
DELIMCD  EQU   COMMON+20
CURBUF   EQU   COMMON+48
SWA      EQU   COMMON+122
RDRSW    EQU   SWA
SWB      EQU   COMMON+123
SWC      EQU   COMMON+124
SWD      EQU   COMMON+125
SWE      EQU   COMMON+126
SWF      EQU   COMMON+127
BUFSW    EQU   COMMON+128
PRSW     EQU   COMMON+129
WTORMSG  EQU   COMMON+133
TABLE    EQU   COMMON+659
HEXTABL  EQU   TABLE+63
EBCTABL  EQU   HEXTABL+10
NONBLNK  EQU   COMMON+1244
AWRITE   EQU   COMMON+1500
APRTMSG  EQU   COMMON+1504
AEREXIT  EQU   COMMON+1536
DCBADDRS EQU   COMMON+1608
ARDRDCB  EQU   DCBADDRS+8
@NM00041 EQU   DCBADDRS+16
@NM00042 EQU   @NM00041
QASID    EQU   COMMON+1664
BRRDDATA EQU   COMMON+1984
OPERAND  EQU   0
OUTBUFR  EQU   0
CC       EQU   OUTBUFR
DATAREA  EQU   OUTBUFR+1
ADDRESS  EQU   DATAREA
FIELD1   EQU   DATAREA+7
FIELD2   EQU   DATAREA+43
BUFFER1  EQU   0
BUFFER2  EQU   0
FLDWORK  EQU   0
DATAWORK EQU   0
INDATA   EQU   0
DCBFLGS  EQU   0
DCBOPEN  EQU   DCBFLGS
COMMAREA EQU   DATAREA
MSGAREA  EQU   DATAREA
ADDR2    EQU   MSGADDR1
ADDR3    EQU   MSGADDR2
ADDR1    EQU   THISLINE
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00071 EQU   DCBFLGS
@NM00070 EQU   DCBFLGS
@NM00069 EQU   DATAREA+78
@NM00068 EQU   DATAREA+42
@NM00067 EQU   DATAREA+6
CSADDR   EQU   COMMON+2072
@NM00047 EQU   COMMON+2070
TOPICHDR EQU   COMMON+2060
DFLTCSA  EQU   COMMON+2056
LPAMAX   EQU   COMMON+2052
DNUCTOP  EQU   COMMON+2048
XLMAX    EQU   COMMON+2044
DQEMAX   EQU   COMMON+2042
ASCBMAX  EQU   COMMON+2040
TCBMAX   EQU   COMMON+2038
SRBMAX   EQU   COMMON+2036
DDMAX    EQU   COMMON+2034
DEBMAX   EQU   COMMON+2032
JPQMAX   EQU   COMMON+2030
LLEMAX   EQU   COMMON+2028
PQEMAX   EQU   COMMON+2026
RBMAX    EQU   COMMON+2024
@NM00046 EQU   COMMON+2023
EXITFLAG EQU   COMMON+2022
AUSRASID EQU   COMMON+2020
AUSRTCBA EQU   COMMON+2016
AUSRDEL  EQU   COMMON+2012
AUSREXIT EQU   COMMON+2008
AUSRINIT EQU   COMMON+2004
ASRBFMT  EQU   COMMON+2000
AASCBFMT EQU   COMMON+1996
BRRDADJ  EQU   COMMON+1992
BRRDINIT EQU   COMMON+1988
BUFERMAP EQU   COMMON+1980
ASCBMAP  EQU   COMMON+1976
CPUMAP   EQU   COMMON+1972
ASIDNDX  EQU   COMMON+1968
@NM00045 EQU   COMMON+1964
HDRTITLE EQU   COMMON+1864
HDRREGS  EQU   COMMON+1696
SACSWCAW EQU   COMMON+1684
ASVTADDR EQU   COMMON+1680
PREFXRGV EQU   COMMON+1676
PREFXRGR EQU   COMMON+1672
CURASCB  EQU   COMMON+1668
IPLCPU   EQU   COMMON+1666
QAPFT    EQU   COMMON+1660
@NM00044 EQU   COMMON+1656
REALMAX  EQU   COMMON+1652
SEGTABOR EQU   COMMON+1648
REALMAP  EQU   COMMON+1644
@NM00043 EQU   COMMON+1641
EDITER   EQU   COMMON+1640
AROOT    EQU   COMMON+1636
AEDITCB  EQU   COMMON+1632
TRCCOUNT EQU   COMMON+1628
ASYSUDCB EQU   @NM00041+1
ENDLIST  EQU   @NM00042
AINDCB   EQU   DCBADDRS+12
APTRDCB  EQU   DCBADDRS+4
AOUTDCB  EQU   DCBADDRS
ATCBSMRY EQU   COMMON+1604
ATCBSMFR EQU   COMMON+1600
ONGOPTR  EQU   COMMON+1596
AEND     EQU   COMMON+1592
AERRMSGA EQU   COMMON+1584
BUFREINT EQU   COMMON+1580
BUFSUM   EQU   COMMON+1576
APRTSTG  EQU   COMMON+1572
AFORMAT  EQU   COMMON+1568
ASTPROUT EQU   COMMON+1564
APCBENQ  EQU   COMMON+1560
ATCBRTRV EQU   COMMON+1556
ATCBREMV EQU   COMMON+1552
ATCBSAVE EQU   COMMON+1548
QATMERTN EQU   COMMON+1544
ALOADER  EQU   COMMON+1540
SYNMSGA  EQU   COMMON+1532
STOPEXIT EQU   COMMON+1528
ARGNBND  EQU   COMMON+1524
AWRDCNVT EQU   COMMON+1520
AADRCNVT EQU   COMMON+1516
AFMTLINE EQU   COMMON+1512
ASYNTAX  EQU   COMMON+1508
BLNK     EQU   COMMON+988
@NM00040 EQU   COMMON+972
@NM00039 EQU   COMMON+915
@NM00038 EQU   HEXTABL
@NM00037 EQU   TABLE
CAPTABL  EQU   COMMON+403
TITLEPGE EQU   COMMON+394
@NM00036 EQU   COMMON+392
TITLETME EQU   COMMON+379
@NM00035 EQU   COMMON+377
TITLEDTE EQU   COMMON+364
@NM00034 EQU   COMMON+362
TITLEMOD EQU   COMMON+347
TITLEMSG EQU   COMMON+283
MSG2     EQU   COMMON+257
MSG1     EQU   COMMON+231
STOP     EQU   COMMON+227
TITLE    EQU   COMMON+222
BLANKS   EQU   COMMON+214
@NM00033 EQU   COMMON+130
@NM00032 EQU   PRSW
@NM00031 EQU   PRSW
PRNTREAL EQU   PRSW
PRNTRL   EQU   PRSW
TTLSW    EQU   PRSW
@NM00030 EQU   PRSW
QSEGTBSW EQU   PRSW
@NM00029 EQU   PRSW
@NM00028 EQU   BUFSW
PREFM    EQU   BUFSW
@NM00027 EQU   BUFSW
@NM00026 EQU   BUFSW
@NM00025 EQU   BUFSW
@NM00024 EQU   BUFSW
@NM00023 EQU   BUFSW
@NM00022 EQU   BUFSW
@NM00021 EQU   SWF
QUT1LOD  EQU   SWF
@NM00020 EQU   SWF
PAGEOK   EQU   SWF
DMPIC    EQU   SWF
QSADMP   EQU   SWF
NUCTFRMC EQU   SWF
QPRDINIT EQU   SWF
@NM00019 EQU   SWE
@NM00018 EQU   SWE
@NM00017 EQU   SWE
BUILDMAP EQU   SWE
TITLESW  EQU   SWE
RESPC    EQU   SWE
@NM00016 EQU   SWE
STOPSW   EQU   SWE
@NM00015 EQU   SWD
GPRSFND  EQU   SWD
CONTSW   EQU   SWD
NOLOADSW EQU   SWD
NOSTDMG  EQU   SWD
@NM00014 EQU   SWD
@NM00013 EQU   SWD
FLSHMODE EQU   SWD
@NM00012 EQU   SWC
@NM00011 EQU   SWC
SEGRD    EQU   SWC
EDITSW   EQU   SWC
TREADIN  EQU   SWC
POSITSW  EQU   SWC
SETFLSH  EQU   SWC
MSTRSW   EQU   SWC
@NM00010 EQU   SWB
@NM00009 EQU   SWB
QSYSUT2  EQU   SWB
ENDSW    EQU   SWB
@NM00008 EQU   SWB
@NM00007 EQU   SWB
FMTERR   EQU   SWB
IOERR    EQU   SWB
SETCVTSW EQU   SWA
@NM00006 EQU   SWA
GOSW     EQU   SWA
@NM00005 EQU   SWA
@NM00004 EQU   SWA
@NM00003 EQU   SWA
@NM00002 EQU   SWA
LINENUM  EQU   COMMON+120
LINENUMB EQU   COMMON+118
SIXTEEN  EQU   COMMON+116
TWELVE   EQU   COMMON+114
ELEVEN   EQU   COMMON+112
HTEN     EQU   COMMON+110
EIGHT    EQU   COMMON+108
SEVEN    EQU   COMMON+106
FIVE     EQU   COMMON+104
FOUR     EQU   COMMON+102
THREE    EQU   COMMON+100
TWO      EQU   COMMON+98
ONEA     EQU   COMMON+96
READTM   EQU   COMMON+92
RDERCNT  EQU   COMMON+88
READNO   EQU   COMMON+84
RDENTRY  EQU   COMMON+80
@NM00001 EQU   COMMON+79
RETCODE  EQU   COMMON+78
FILESEQ  EQU   COMMON+76
INDD     EQU   COMMON+68
STORSIZE EQU   COMMON+64
PCBPTR   EQU   COMMON+60
CVTADDR  EQU   COMMON+56
TCBLIST  EQU   COMMON+52
PAGENUMB EQU   COMMON+44
LINECNT  EQU   COMMON+40
SIX      EQU   COMMON+36
NUCTOP   EQU   COMMON+32
WORK1    EQU   COMMON+24
KYWDEND  EQU   COMMON+16
KYWDBGN  EQU   COMMON+12
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00059 EQU   FDSBGN
@RC00084 EQU   @RC00077
@RC00082 EQU   @RC00077
@RC00080 EQU   @RC00077
@RC00078 EQU   @RC00077
@RF00100 EQU   @EL00001
ENDRDVB  EQU   @EL00002
ENDVRBT  EQU   @EL00003
ENDHC    EQU   @EL00004
@RT00232 EQU   @RC00224
@RC00225 EQU   @RC00224
@RT00246 EQU   @RC00235
@RC00239 EQU   @RC00235
@RC00267 EQU   @RC00264
@RC00265 EQU   @RC00264
@RF00271 EQU   @RC00264
@RC00322 EQU   @RC00293
@RC00294 EQU   @RC00293
@RC00359 EQU   @RC00356
@RC00438 EQU   @RC00437
ENDSTOR  EQU   @EL00005
@RF00508 EQU   @EL00006
ENDEQUAT EQU   @EL00007
@RC00648 EQU   @EL00011
@RC00646 EQU   @EL00011
@RF00674 EQU   @EL00013
@RC00691 EQU   @EL00014
@RC00105 EQU   ENDRDVB
@RC00142 EQU   ENDVRBT
@RC00304 EQU   @RC00294
@RF00468 EQU   ENDSTOR
@RF00548 EQU   ENDEQUAT
@RC00556 EQU   ENDEQUAT
@RC00151 EQU   @RC00142
@RC00149 EQU   @RC00142
@RC00147 EQU   @RC00142
@RC00145 EQU   @RC00142
@RC00143 EQU   @RC00142
@RC00311 EQU   @RC00304
@RC00557 EQU   @RC00556
@RC00560 EQU   @RC00557
@RC00561 EQU   @RC00560
@ENDDATA EQU   *
         END   AMDPRFDS,(C'PLS1941',0701,76265)

         TITLE 'AMDPRGCD - GENERAL CPUDATA EXECUTOR                    *
                        '
AMDPRGCD CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'AMDPRGCD  77.136'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @11,0                                            01S0001
@PSTART  LA    @10,4095(,@11)                                   01S0001
         LA    @09,4095(,@10)                                   01S0001
         LA    @08,4095(,@09)                                   01S0001
         USING @PSTART,@11                                      01S0001
         USING @PSTART+4095,@10                                 01S0001
         USING @PSTART+8190,@09                                 01S0001
         USING @PSTART+12285,@08                                01S0001
         ST    @13,@SA00001+4                                   01S0001
         LA    @14,@SA00001                                     01S0001
         ST    @14,8(,@13)                                      01S0001
         LR    @13,@14                                          01S0001
*   GCDSAVRG=R13;                   /* SAVE ADDR OF GCD SAVE AREA    */
         ST    R13,GCDSAVRG                                     01S0296
*   RESPECIFY                                                   01S0297
*     R13 UNRESTRICTED;                                         01S0297
*                                                               02S0298
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL INTERNAL SWITCHES AND WORK VALUES ARE SET TO ZERO, EXCEPT */
*   /* FOR THE CPUADDR, AND THE HEADER IS PRINTED                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0298
*   GCDERSAV=ERRADDR;               /* SAVE BRREAD ERROR RTN ADDR    */
         MVC   GCDERSAV(4),ERRADDR(COMBASE)                     02S0298
*   ERRADDR=ADDR(GCDERRTN);         /* PUT ADDR OF GCD BRREAD ERROR
*                                      RTN IN COMMON                 */
         LA    @03,GCDERRTN                                     02S0299
         ST    @03,ERRADDR(,COMBASE)                            02S0299
*   STPERSAV=STOPEXIT;              /* SAVE STOP RTN ADDR            */
         MVC   STPERSAV(4),STOPEXIT(COMBASE)                    02S0300
*   STOPEXIT=ADDR(GCDSTOP);         /* PUT ADDR OF GCD STOP RTN IN
*                                      COMMON                        */
         LA    @03,GCDSTOP                                      02S0301
         ST    @03,STOPEXIT(,COMBASE)                           02S0301
*   PSAVIRT=0;                                                  02S0302
         SLR   @03,@03                                          02S0302
         ST    @03,PSAVIRT                                      02S0302
*   LTABLPTR=0;                                                 02S0303
         SLR   LTABLPTR,LTABLPTR                                02S0303
*   PTABLPTR=0;                                                 02S0304
         ST    @03,PTABLPTR                                     02S0304
*   CTABLPTR=0;                                                 02S0305
         SLR   CTABLPTR,CTABLPTR                                02S0305
*   TABLPTR=0;                                                  02S0306
         SLR   TABLPTR,TABLPTR                                  02S0306
*   LCCAPTR=0;                                                  02S0307
         ST    @03,LCCAPTR                                      02S0307
*   PCCAPTR=0;                                                  02S0308
         ST    @03,PCCAPTR                                      02S0308
*   CVTPTR=0;                                                   02S0309
         ST    @03,CVTPTR                                       02S0309
*   CCAVTPTR=0;                                                 02S0310
         ST    @03,CCAVTPTR                                     02S0310
*   DSSPSAVT=0;                                                 02S0311
         ST    @03,DSSPSAVT                                     02S0311
*   LCACPUAD=0;                                                 02S0312
         SLR   LCACPUAD,LCACPUAD                                02S0312
*   PCACPUAD=0;                                                 02S0313
         SLR   PCACPUAD,PCACPUAD                                02S0313
*   CPUADRCK=0;                                                 02S0314
         SLR   CPUADRCK,CPUADRCK                                02S0314
*   CCACNT0=0;                                                  02S0315
         SLR   CCACNT0,CCACNT0                                  02S0315
*   CCACNTRD=0;                                                 02S0316
         SLR   CCACNTRD,CCACNTRD                                02S0316
*   J=0;                                                        02S0317
         MVI   J,X'00'                                          02S0317
*   CPUADDR='FF'X;                                              02S0318
         LA    @03,255                                          02S0318
         STH   @03,CPUADDR                                      02S0318
*   GCDSWS='00'X;                                               02S0319
         MVI   GCDSWS,X'00'                                     02S0319
*   SUBRTNSW='00'X;                                             02S0320
         MVI   SUBRTNSW,X'00'                                   02S0320
*   GEN REFS(AWRITE) FLOWS(GCDSTOP)(BRWRITE SKIP);/* SKIP TO A NEW
*                                      PAGE                          */
         BRWRITE SKIP
*   OUTPUT(45:44+LENGTH(GCDTITLE))=GCDTITLE;/* PRINT TITLE           */
         L     @03,CURBUF(,COMBASE)                             02S0322
         MVC   OUTPUT+44(32,@03),GCDTITLE                       02S0322
*   GEN(BRWRITE 3);                                             02S0323
         BRWRITE 3
*   IF CVTADDR=0 THEN               /* IS THERE A CVT                */
         ICM   @03,15,CVTADDR(COMBASE)                          01S0324
         BNZ   @RF00324                                         01S0324
*     DO;                           /* NO                            */
*                                                               02S0326
*       /*************************************************************/
*       /*                                                           */
*       /* ATTEMPT TO FORMAT THE LCCA AND PCCA FOR THE PSA AT VIRT 0,*/
*       /* ALSO FORMAT THE PSA AND THE REGISTERS                     */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0326
*       OUTPUT(2:1+LENGTH(MSG01))=MSG01;/* PRINT UNABLE TO ACCESS CVT
*                                      MSG                           */
         L     @01,CURBUF(,COMBASE)                             02S0326
         MVC   OUTPUT+1(58,@01),MSG01                           02S0326
*       CALL PRNTSKIP;              /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0327
*       LCASW=SWON;                 /* INDICATE NO LCCAVT            */
*       PCASW=SWON;                 /* INDICATE NO PCCAVT            */
         OI    LCASW,B'01100000'                                02S0329
*     END;                                                      01S0330
*   ELSE                                                        01S0331
*     DO;                           /* YES - CVT ADDR IS NON ZERO    */
         B     @RC00324                                         01S0331
@RF00324 DS    0H                                               01S0332
*       CVTPTR=CVTADDR;             /* ADDR FOR CVT MACRO            */
         MVC   CVTPTR(4),CVTADDR(COMBASE)                       01S0332
*                                                               02S0333
*       /*************************************************************/
*       /*                                                           */
*       /* GET STORAGE FOR INTERNAL TABLES AND INITIALIZE THEM       */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0333
*                                                               03S0333
*       /*************************************************************/
*       /*                                                           */
*       /* STORAGE IS GETMAINED FOR THE INTERNAL CCAV TABLES AND THE */
*       /* PHYSICAL CPU ADDR TABLE (INDICATES FOR WHICH CPU'S THE    */
*       /* REGISTERS HAVE BEEN PRINTED)                              */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0333
*       RESPECIFY                                               03S0333
*         R1 RESTRICTED;                                        03S0333
*       GEN(GETMAIN R,LV=160);                                  03S0334
         GETMAIN R,LV=160
*       LTABLPTR=R1;                /* ADDR OF BEGINNING OF GETMAINED
*                                      AREA - ALSO ADDR OF LCCA TABLE*/
         LR    LTABLPTR,R1                                      03S0335
*       RESPECIFY                                               03S0336
*         R1 UNRESTRICTED;                                      03S0336
*       PTABLPTR=LTABLPTR+CCAVSIZE; /* ADDR OF BEGINNING OF PCCA
*                                      TABLE                         */
         LA    @03,64                                           03S0337
         ALR   @03,LTABLPTR                                     03S0337
         ST    @03,PTABLPTR                                     03S0337
*       CTABLPTR=LTABLPTR+(2*CCAVSIZE);/* ADDR OF BEGINNING OF PHYS
*                                      CPU ADDR TABLE                */
         LA    CTABLPTR,128                                     03S0338
         ALR   CTABLPTR,LTABLPTR                                03S0338
*       TABINIT1=TABINIT1&&TABINIT1;/* IN CCA TABLES TO 0            */
         XC    TABINIT1(128,LTABLPTR),TABINIT1(LTABLPTR)        03S0339
*       TABINIT2(1)='FF'X;          /* INIT PHYS CPU ADDR TABLE TO
*                                      X'FF'                         */
         MVI   TABINIT2(CTABLPTR),X'FF'                         03S0340
*       EVAL(ADDR(TABINIT2(1)))->TABINIT2(2:LENGTH(TABINIT2))=TABINIT2(
*           1:LENGTH(TABINIT2)-1);                              03S0341
         MVC   TABINIT2+1(31,CTABLPTR),TABINIT2(CTABLPTR)       03S0341
*                                                               02S0342
*       /*************************************************************/
*       /*                                                           */
*       /* BEGIN PROCESSING BY ATTEMPTING TO GET CSD                 */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0342
*       BRNCHADR=ADDR(CSDERR);      /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @03,CSDERR                                       02S0342
         ST    @03,BRNCHADR                                     02S0342
*       RESPECIFY                                               02S0343
*         PREG RESTRICTED;                                      02S0343
*       PREG=ADDR(CVTCSD);          /* PTR TO CSD                    */
         L     PREG,CVTPTR                                      02S0344
         LA    PREG,CVTCSD(,PREG)                               02S0344
*       GEN REFS(BRRDDATA) FLOWS(GCDERRTN)(BRREAD (PREG));      02S0345
         BRREAD (PREG)
*       IF TEMPADR1^=0 THEN         /* IS PTR TO CSD NOT 0           */
         ICM   @00,7,TEMPADR1(PREG)                             02S0346
         BZ    @RF00346                                         02S0346
*         DO;                       /* YES                           */
*                                                               02S0347
*           /*********************************************************/
*           /*                                                       */
*           /* FORMAT THE CSD BY FIELDS                              */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0348
*                                                               03S0348
*           /*********************************************************/
*           /*                                                       */
*           /* VALIDITY CHECK THE CSD AND FORMAT IT ONE LINE AT A    */
*           /* TIME                                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0348
*           CSDPTR=TEMPADDR;        /* ADDR OF CSD IN DUMP           */
         L     @00,TEMPADDR(,PREG)                              03S0348
         ST    @00,CSDPTR                                       03S0348
*           PREG=CSDPTR;            /* GET CSD                       */
         LR    PREG,@00                                         03S0349
*           GEN(BRREAD (PREG));                                 03S0350
         BRREAD (PREG)
*           IF VALIDCK^='CSD ' THEN /* DOES CSD VALIDITY CHECK       */
         CLC   VALIDCK(4,PREG),@CC02813                         03S0351
         BE    @RF00351                                         03S0351
*             DO;                   /* NO                            */
*               RESPECIFY                                       03S0353
*                 PREG UNRESTRICTED;                            03S0353
*               OUTPUT(2:1+LENGTH(MSG3))=MSG3;/* PRINT VALIDITY CHECK
*                                      FAILED MSG                    */
         L     @01,CURBUF(,COMBASE)                             03S0354
         MVC   OUTPUT+1(25,@01),MSG3                            03S0354
*               CALL PRNTSKIP;                                  03S0355
         BAL   @14,PRNTSKIP                                     03S0355
*             END;                                              03S0356
*           BRNCHADR=ADDR(GMSG4);   /* ERROR RETURN POINT FOR BRREADS
*                                      BY GFR                        */
@RF00351 LA    @15,GMSG4                                        03S0357
         ST    @15,BRNCHADR                                     03S0357
*           RESPECIFY                                           03S0358
*            (R0,                                               03S0358
*             R1) RESTRICTED;                                   03S0358
*           R0=0;                   /* 0 ASID FOR RDC                */
         SLR   R0,R0                                            03S0359
*           DO I=1 TO DIM(FMTTABL1);/* CALL THE FORMAT RTN TO FORMAT
*                                      THE CSD ONE LINE AT A TIME    */
         LA    I,1                                              03S0360
@DL00360 DS    0H                                               03S0361
*             R1=FMTTABL1(I);       /* ADDR OF EACH LINE TO BE  03S0361
*                                      FORMATTED                     */
         LR    @05,I                                            03S0361
         SLA   @05,2                                            03S0361
         L     R1,FMTTABL1-4(@05)                               03S0361
*             CALL AMDPRGFR;        /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           03S0362
         BALR  @14,@15                                          03S0362
*             GEN SETS(R1,R14,R15)(BRWRITE 1);                  03S0363
         BRWRITE 1
*           END;                                                03S0364
         AH    I,@CH00050                                       03S0364
         CH    I,@CH00033                                       03S0364
         BNH   @DL00360                                         03S0364
*           CALL PRNTSKIP;          /* SKIP TWO LINES                */
         BAL   @14,PRNTSKIP                                     03S0365
*           RESPECIFY                                           03S0366
*            (R0,                                               03S0366
*             R1) UNRESTRICTED;                                 03S0366
*           GO TO CSDOUT;           /* ATTEMPT TO GET THE LCCAVT     */
*                                                               03S0367
         B     CSDOUT                                           03S0367
*           /*********************************************************/
*           /*                                                       */
*           /* THIS ROUTINE WILL GET CONTROL ONLY IF A BRREAD FAILS  */
*           /* WHILE FORMATTING THE CSD                              */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0368
*GMSG4:                                                         03S0368
*           GEN(BRWRITE 1);         /* PRINT PARTIALLY FILLED BUFFER */
GMSG4    BRWRITE 1
*           OUTPUT(2:1+LENGTH(MSG4))=MSG4;/* PRINT ERROR FORMATTING
*                                      CSD MSG                       */
         L     @01,CURBUF(,COMBASE)                             03S0369
         MVC   OUTPUT+1(26,@01),MSG4                            03S0369
*           CALL PRNTSKIP;          /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     03S0370
*CSDOUT:                                                        03S0371
*           ;                       /* ATTEMPT TO GET THE LCCAVT     */
CSDOUT   DS    0H                                               03S0372
*         END;                                                  02S0372
*       ELSE                        /* NO - PTR TO CSD IS 0          */
*         DO;                                                   02S0373
         B     @RC00346                                         02S0373
@RF00346 DS    0H                                               02S0374
*           OUTPUT(2:1+LENGTH(MSG5))=MSG5;/* PRINT CSD ADDR 0 MSG    */
         L     @01,CURBUF(,COMBASE)                             02S0374
         MVC   OUTPUT+1(19,@01),MSG5                            02S0374
*           CALL PRNTSKIP;          /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0375
*         END;                                                  02S0376
*       GO TO CSDEXIT;                                          02S0377
*                                                               02S0377
         B     CSDEXIT                                          02S0377
*       /*************************************************************/
*       /*                                                           */
*       /* THIS ROUTINE WILL GET CONTROL ONLY IF A BRREAD FAILS WHILE*/
*       /* GETTING THE CSD                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0378
*CSDERR:                                                        02S0378
*       OUTPUT(2:1+LENGTH(MSG02))=MSG02;/* PRINT ERROR FINDING CSD
*                                      MSG                           */
CSDERR   L     @01,CURBUF(,COMBASE)                             02S0378
         MVC   OUTPUT+1(17,@01),MSG02                           02S0378
*       CALL PRNTSKIP;              /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0379
*CSDEXIT:                                                       02S0380
*       ;                                                       02S0380
CSDEXIT  DS    0H                                               02S0381
*                                                               02S0381
*       /*************************************************************/
*       /*                                                           */
*       /* THE LCCAVT IS READ AND EACH NON-ZERO LCCA ADDR IS COPIED  */
*       /* TO THE SAME RELATIVE POSITION IN THE GETMAINED STORAGE    */
*       /* THUS CREATING AN INTERNAL LCCAVT                          */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0381
*       BRNCHADR=ADDR(LCAVTERR);    /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @15,LCAVTERR                                     02S0381
         ST    @15,BRNCHADR                                     02S0381
*       RESPECIFY                                               02S0382
*         PREG RESTRICTED;                                      02S0382
*       PREG=ADDR(CVTLCCAT);        /* ADDR OF LCCAVT - IN CVT       */
         L     PREG,CVTPTR                                      02S0383
         LA    PREG,CVTLCCAT(,PREG)                             02S0383
*       GEN(BRREAD (PREG));                                     02S0384
         BRREAD (PREG)
*       IF TEMPADR1^=0 THEN         /* IS LCCAVT ADDR NOT 0          */
         ICM   @00,7,TEMPADR1(PREG)                             02S0385
         BZ    @RF00385                                         02S0385
*         DO;                       /* YES                           */
*           CCAVTPTR=TEMPADDR;      /* ADDR OF LCCAVT                */
         MVC   CCAVTPTR(4),TEMPADDR(PREG)                       02S0387
*           RESPECIFY                                           02S0388
*             PREG UNRESTRICTED;                                02S0388
*           CCAVTSW=SWOFF;          /* INDICATE PROCESSING LCCAVT    */
         NI    CCAVTSW,B'01111111'                              02S0389
*           CALL CCAVTABL;          /* PROCESS THE LCCAVT FILLING THE
*                                      GETMAINED STORAGE             */
         BAL   @14,CCAVTABL                                     02S0390
*         END;                                                  02S0391
*       ELSE                                                    02S0392
*         DO;                       /* NO - LCCAVT ADDR IS 0         */
         B     @RC00385                                         02S0392
@RF00385 DS    0H                                               02S0393
*LCAVTERR:                                                      02S0393
*           OUTPUT(2:1+LENGTH(MSG10))=MSG10;/* PRINT ERROR FINDING
*                                      LCCAVT MSG                    */
LCAVTERR L     @01,CURBUF(,COMBASE)                             02S0393
         MVC   OUTPUT+1(20,@01),MSG10                           02S0393
*           CALL PRNTSKIP;          /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0394
*           LCASW=SWON;             /* INDICATE LCCAVT NOT AVAILABLE */
         OI    LCASW,B'01000000'                                02S0395
*         END;                                                  02S0396
*                                                               02S0397
*       /*************************************************************/
*       /*                                                           */
*       /* THE PCCAVT IS READ AND EACH NON-ZERO PCCA ADDR IS COPIED  */
*       /* TO THE SAME RELATIVE POSITION IN THE GETMAINED STORAGE    */
*       /* THUS CREATING AN INTERNAL PCCAVT                          */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0397
*       BRNCHADR=ADDR(PCAVTERR);    /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
@RC00385 LA    @15,PCAVTERR                                     02S0397
         ST    @15,BRNCHADR                                     02S0397
*       RESPECIFY                                               02S0398
*         PREG RESTRICTED;                                      02S0398
*       PREG=ADDR(CVTPCCAT);        /* ADDR OF PCCAVT - IN CVT       */
         L     PREG,CVTPTR                                      02S0399
         LA    PREG,CVTPCCAT(,PREG)                             02S0399
*       GEN(BRREAD (PREG));                                     02S0400
         BRREAD (PREG)
*       IF TEMPADR1^=0 THEN         /* IS PCCAVT ADDR NOT 0          */
         ICM   @00,7,TEMPADR1(PREG)                             02S0401
         BZ    @RF00401                                         02S0401
*         DO;                       /* YES                           */
*           CCAVTPTR=TEMPADDR;      /* ADDR OF PCCAVT                */
         MVC   CCAVTPTR(4),TEMPADDR(PREG)                       02S0403
*           RESPECIFY                                           02S0404
*             PREG UNRESTRICTED;                                02S0404
*           CCAVTSW=SWON;           /* INDICATE PROCESSING PCCAVT    */
         OI    CCAVTSW,B'10000000'                              02S0405
*           CALL CCAVTABL;          /* PROCESS THE PCCAVT FILLING THE
*                                      GETMAINED STORAGE             */
         BAL   @14,CCAVTABL                                     02S0406
*         END;                                                  02S0407
*       ELSE                                                    02S0408
*         DO;                       /* NO - PCCAVT ADDR IS 0         */
         B     @RC00401                                         02S0408
@RF00401 DS    0H                                               02S0409
*PCAVTERR:                                                      02S0409
*           OUTPUT(2:1+LENGTH(MSG17))=MSG17;/* PRINT ERROR FINDING
*                                      PCCAVT MSG                    */
PCAVTERR L     @01,CURBUF(,COMBASE)                             02S0409
         MVC   OUTPUT+1(20,@01),MSG17                           02S0409
*           CALL PRNTSKIP;          /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0410
*           PCASW=SWON;             /* INDICATE PCCAVT NOT AVAILABLE */
         OI    PCASW,B'00100000'                                02S0411
*         END;                                                  02S0412
*     END;                                                      01S0413
@RC00401 DS    0H                                               01S0414
*                                                               02S0414
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESSING THE PSA AT VIRTUAL 0, ATTEMPT TO PROCESS THE LCCA   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0414
*   BRNCHADR=ADDR(LCARDERR);        /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
@RC00324 LA    @15,LCARDERR                                     02S0414
         ST    @15,BRNCHADR                                     02S0414
*   RESPECIFY                                                   02S0415
*     PREG RESTRICTED;                                          02S0415
*   PREG=ADDR(PSALCCAV);            /* VIRT ADDR OF LCCA IN PSA      */
         L     PREG,PSAVIRT                                     02S0416
         LA    PREG,PSALCCAV(,PREG)                             02S0416
*   GEN(BRREAD (PREG));                                         02S0417
         BRREAD (PREG)
*   LCCAPTR=TEMPADDR;               /* VIRT ADDR OF LCCA             */
         MVC   LCCAPTR(4),TEMPADDR(PREG)                        02S0418
*   RESPECIFY                                                   02S0419
*     PREG UNRESTRICTED;                                        02S0419
*   IF LCCAPTR1=0 THEN              /* IS LCCA ADDR 0                */
         ICM   @15,7,LCCAPTR1                                   02S0420
         BNZ   @RF00420                                         02S0420
*     DO;                           /* YES                           */
*       OUTPUT(2:1+LENGTH(MSG23))=MSG23;/* PRINT LCCA ADDR 0 MSG     */
         L     @01,CURBUF(,COMBASE)                             02S0422
         MVC   OUTPUT+1(28,@01),MSG23                           02S0422
*       CALL PRNTSKIP;              /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0423
*       IF LCASW=SWOFF THEN         /* IS LCCAVT AVAILABLE           */
         TM    LCASW,B'01000000'                                02S0424
         BZ    @RT00424                                         02S0424
*         GO TO LTABSCH2;           /* YES - TRY TO FIND LCCA FOR
*                                      THIS PSA BY SEARCHING LCCAVT  */
*       ELSE                                                    02S0426
*         GO TO LCCAOUT;            /* GET PCCA FROM PSA AT VIRT 0   */
         B     LCCAOUT                                          02S0426
*     END;                                                      02S0427
*   ELSE                                                        02S0428
*     DO;                           /* LCCA ADDR WAS NOT 0           */
@RF00420 DS    0H                                               02S0429
*       IF LCASW=SWON THEN          /* IS LCCAVT AVAILABLE           */
         TM    LCASW,B'01000000'                                02S0429
         BO    @RT00429                                         02S0429
*         GO TO LCAVALID;           /* NO - PROCESS THIS LCCA        */
*       ELSE                                                    02S0431
*         DO;                       /* YES                           */
*                                                               02S0431
*           /*********************************************************/
*           /*                                                       */
*           /* ATTEMPT TO FIND MATCHING LCCA IN LCCAVT               */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0432
*                                                               03S0432
*           /*********************************************************/
*           /*                                                       */
*           /* SEARCH THE LCCAVT FOR THE LCCA ADDRESS THAT MATCHES   */
*           /* THE LCCA ADDRESS READ FROM THIS PSA                   */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0432
*LTABSCH2:                                                      03S0432
*           BRNCHADR=ADDR(LCPUFAIL);/* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
LTABSCH2 LA    @15,LCPUFAIL                                     03S0432
         ST    @15,BRNCHADR                                     03S0432
*           RESPECIFY                                           03S0433
*             PREG RESTRICTED;                                  03S0433
*           PREG=ADDR(PSACPULA);    /* LOG CPU ADDR FROM PSA         */
         L     PREG,PSAVIRT                                     03S0434
         LA    PREG,PSACPULA(,PREG)                             03S0434
*           GEN(BRREAD (PREG));                                 03S0435
         BRREAD (PREG)
*           CPUADDR=CPUTMPRY;       /* LOG CPU ADDR FOR COMPARE      */
         MVC   CPUADDR(2),CPUTMPRY(PREG)                        03S0436
*           RESPECIFY                                           03S0437
*             PREG UNRESTRICTED;                                03S0437
*LTABSRCH:                                                      03S0438
*           BRNCHADR=ADDR(LTABSCH1);/* ERROR RETURN POINT FOR THESE
*                                      BRREADS                       */
LTABSRCH LA    @04,LTABSCH1                                     03S0438
         ST    @04,BRNCHADR                                     03S0438
*           TABLPTR=LTABLPTR;       /* ADDR OF INTERNAL LCCAVT       */
         LR    TABLPTR,LTABLPTR                                 03S0439
*           DO J=0 TO NUMENTRY BY LENGTH(CCAENTRY);/* SEARCH LCCAVT
*                                      FOR NON-ZERO ADDRS            */
         SLR   @04,@04                                          03S0440
         STC   @04,J                                            03S0440
@DL00440 DS    0H                                               03S0441
*             IF ENTRY1^=0 THEN     /* IS THIS LCCA ADDR NOT 0       */
         ICM   @04,7,ENTRY1(TABLPTR)                            03S0441
         BZ    @RF00441                                         03S0441
*               DO;                 /* YES                           */
*                 IF LCCAPTR1^=0 THEN/* WAS LCCA ADDR IN PSA NOT 0   */
         ICM   @04,7,LCCAPTR1                                   03S0443
         BZ    @RF00443                                         03S0443
*                   DO;             /* YES                           */
*                     IF ENTRY1=LCCAPTR1 THEN/* IS THIS THE LCCA FOR
*                                      THIS PSA                      */
         CLC   ENTRY1(3,TABLPTR),LCCAPTR1                       03S0445
         BE    @RT00445                                         03S0445
*                       GO TO LPTRESET;/* YES - RESET PTR IN TABLE
*                                      AND PROCESS LCCA              */
*                   END;                                        03S0447
*                 ELSE                                          03S0448
*                   DO;             /* THIS LCCA ADDR IS NOT 0       */
         B     @RC00443                                         03S0448
@RF00443 DS    0H                                               03S0449
*                     RESPECIFY                                 03S0449
*                       PREG RESTRICTED;                        03S0449
*                     PREG=ADDR(LCCACPUA);/* LOGICAL CPU ADDR        */
         L     PREG,LCCAPTR                                     03S0450
         LA    PREG,LCCACPUA(,PREG)                             03S0450
*                     GEN(BRREAD (PREG));                       03S0451
         BRREAD (PREG)
*                     IF CPUADDR=CPUTMPRY THEN/* DO THE LOG CPU ADDRS
*                                      MATCH                         */
         SLR   @04,@04                                          03S0452
         ICM   @04,3,CPUADDR                                    03S0452
         CH    @04,CPUTMPRY(,PREG)                              03S0452
         BNE   @RF00452                                         03S0452
*                       DO;         /* YES - THIS IS THE LCCA FOR
*                                      THIS PSA                      */
*                         LCCAPTR=CCAENTRY;/* PROCESS THIS LCCA      */
         MVC   LCCAPTR(4),CCAENTRY(TABLPTR)                     03S0454
*LPTRESET:                                                      03S0455
*                         CCAENTRY=0;/* ZERO ADDR TO PREVENT    03S0455
*                                      REFORMATTING IT LATER         */
LPTRESET SLR   @04,@04                                          03S0455
         ST    @04,CCAENTRY(,TABLPTR)                           03S0455
*                         GO TO LCAVALID;/* PROCESS THIS LCCA        */
         B     LCAVALID                                         03S0456
*                       END;                                    03S0457
*                     RESPECIFY                                 03S0458
*                       PREG UNRESTRICTED;                      03S0458
@RF00452 DS    0H                                               03S0459
*                   END;                                        03S0459
*               END;                                            03S0460
@RC00443 DS    0H                                               03S0461
*LTABSCH1:                                                      03S0461
*             TABLPTR=TABLPTR+LENGTH(CCAENTRY);/* INCREMENT PTR TO
*                                      REFERENCE NEXT ENTRY IN LCCAVT*/
@RF00441 DS    0H                                               03S0461
LTABSCH1 AH    TABLPTR,@CH00039                                 03S0461
*           END;                                                03S0462
         LA    @04,4                                            03S0462
         SLR   @15,@15                                          03S0462
         IC    @15,J                                            03S0462
         ALR   @04,@15                                          03S0462
         STC   @04,J                                            03S0462
         CH    @04,@CH02093                                     03S0462
         BNH   @DL00440                                         03S0462
*           GO TO LCCADRCK;         /* IS THERE AN LCCA TO FORMAT    */
*                                                               03S0463
         B     LCCADRCK                                         03S0463
*           /*********************************************************/
*           /*                                                       */
*           /* THIS ROUTINE WILL GET CONTROL ONLY IF THE BRREAD FAILS*/
*           /* WHILE GETTING THE LOGICAL CPU ADDRESS FROM THE PSA    */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0464
*LCPUFAIL:                                                      03S0464
*           CPUADDR='FFFF'X;        /* PREVENT MATCHING THE LOG CPU
*                                      ADDR IN LCCA                  */
LCPUFAIL MVC   CPUADDR(2),@CH02834                              03S0464
*           IF LCCAPTR^=0 THEN      /* IS LCCA AVAILABLE             */
         ICM   @15,15,LCCAPTR                                   03S0465
         BNZ   @RT00465                                         03S0465
*             GO TO LTABSRCH;       /* YES - FIND THE MATCHING LCCA
*                                      IN LCCAVT                     */
*           ELSE                                                03S0467
*             GO TO LCCAOUT;        /* NO - LCCA IS UNAVAILABLE      */
         B     LCCAOUT                                          03S0467
*LCCADRCK:                                                      02S0468
*           IF LCCAPTR1^=0 THEN     /* IS THERE AN LCCA TO PROCESS   */
LCCADRCK ICM   @15,7,LCCAPTR1                                   02S0468
         BZ    @RF00468                                         02S0468
*             DO;                   /* YES                           */
*                                                               02S0469
*               /*****************************************************/
*               /*                                                   */
*               /* VALIDITY CHECK AND ATTEMPT TO FORMAT THIS LCCA    */
*               /*                                                   */
*               /*****************************************************/
*                                                               02S0470
*LCAVALID:                                                      02S0470
*               BRNCHADR=ADDR(GMSG20A);/* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
LCAVALID LA    @15,GMSG20A                                      02S0470
         ST    @15,BRNCHADR                                     02S0470
*               RESPECIFY                                       02S0471
*                 PREG RESTRICTED;                              02S0471
*               PREG=LCCAPTR;       /* ADDR OF THE LCCA              */
         L     PREG,LCCAPTR                                     02S0472
*               GEN(BRREAD (PREG));                             02S0473
         BRREAD (PREG)
*               IF VALIDCK^='LCCA' THEN/* DOES THE LCCA VALIDITY
*                                      CHECK                         */
         CLC   VALIDCK(4,PREG),@CC02838                         02S0474
         BE    @RF00474                                         02S0474
*                 DO;               /* NO                            */
*                   RESPECIFY                                   02S0476
*                     PREG UNRESTRICTED;                        02S0476
*                   OUTPUT(2:1+LENGTH(MSG21))=MSG21;/* PRINT VALIDITY
*                                      CHECK FAILED MSG              */
         L     @01,CURBUF(,COMBASE)                             02S0477
         MVC   OUTPUT+1(26,@01),MSG21                           02S0477
*                   CALL PRNTSKIP;                              02S0478
         BAL   @14,PRNTSKIP                                     02S0478
*                 END;                                          02S0479
*               BRNCHADR=ADDR(GMSG22C);/* ERROR RETURN POINT FOR
*                                      BRREADS BY GFR                */
@RF00474 LA    @15,GMSG22C                                      02S0480
         ST    @15,BRNCHADR                                     02S0480
*               RESPECIFY                                       02S0481
*                (R0,                                           02S0481
*                 R1) RESTRICTED;                               02S0481
*               R0=0;               /* 0 ASID FOR RDC                */
         SLR   R0,R0                                            02S0482
*               DO I=1 TO DIM(FMTTABL2);/* CALL THE FORMAT RTN TO
*                                      FORMAT THE LCCA ONE LINE AT A
*                                      TIME                          */
         LA    I,1                                              02S0483
@DL00483 DS    0H                                               02S0484
*                 R1=FMTTABL2(I);   /* ADDR OF EACH LINE TO BE  02S0484
*                                      FORMATTED                     */
         LR    @05,I                                            02S0484
         SLA   @05,2                                            02S0484
         L     R1,FMTTABL2-4(@05)                               02S0484
*                 CALL AMDPRGFR;    /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S0485
         BALR  @14,@15                                          02S0485
*                 GEN SETS(R1,R14,R15)(BRWRITE 1);              02S0486
         BRWRITE 1
*               END;                                            02S0487
         AH    I,@CH00050                                       02S0487
         CH    I,@CH01928                                       02S0487
         BNH   @DL00483                                         02S0487
*               CALL PRNTSKIP;      /* SKIP TWO LINES                */
         BAL   @14,PRNTSKIP                                     02S0488
*               RESPECIFY                                       02S0489
*                (R0,                                           02S0489
*                 R1) UNRESTRICTED;                             02S0489
*             END;                                              02S0490
*           GO TO LCCAOUT;          /* GET PCCA FROM PSA AT VIRT 0   */
         B     LCCAOUT                                          02S0491
*         END;                                                  02S0492
*     END;                                                      02S0493
*                                                               02S0493
*   /*****************************************************************/
*   /*                                                               */
*   /* THESE ROUTINES WILL GET CONTROL ONLY IF THE BRREADS FAIL WHILE*/
*   /* FINDING OR FORMATTING THE LCCA                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0494
*LCARDERR:                                                      02S0494
*   OUTPUT(2:1+LENGTH(MSG24))=MSG24;/* PRINT ERROR FINDING LCCA PTR
*                                      MSG                           */
LCARDERR L     @01,CURBUF(,COMBASE)                             02S0494
         MVC   OUTPUT+1(34,@01),MSG24                           02S0494
*   CALL PRNTSKIP;                  /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0495
*   IF LCASW=SWOFF THEN             /* IS LCCAVT AVAILABLE           */
         TM    LCASW,B'01000000'                                02S0496
         BZ    @RT00496                                         02S0496
*     GO TO LTABSCH2;               /* YES - TRY TO FIND LCCA FOR
*                                      THIS PSA BY SEARCHING LCCAVT  */
*   ELSE                                                        02S0498
*     GO TO LCCAOUT;                /* GET PCCA FROM PSA AT VIRT 0   */
         B     LCCAOUT                                          02S0498
*GMSG20A:                                                       02S0499
*                                                               02S0499
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE LCCA ADDRESS TO PRINTABLE HEX FOR MESSAGE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0499
*   RESPECIFY                                                   02S0499
*    (R1,                                                       02S0499
*     R4) RESTRICTED;                                           02S0499
GMSG20A  DS    0H                                               02S0500
*   R1=ADDR(LCCAPTR);               /* ADDR TO CONVERT               */
         LA    R1,LCCAPTR                                       02S0500
*   R4=ADDR(ADDR20);                /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR20                                        02S0501
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           02S0502
         BALR  @14,@15                                          02S0502
*   RESPECIFY                                                   02S0503
*    (R1,                                                       02S0503
*     R4) UNRESTRICTED;                                         02S0503
*   OUTPUT(2:1+LENGTH(MSG20))=MSG20;/* PRINT ERROR FINDING LCCA MSG  */
         L     @01,CURBUF(,COMBASE)                             02S0504
         MVC   OUTPUT+1(26,@01),MSG20                           02S0504
*   CALL PRNTSKIP;                  /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0505
*   GO TO LCCAOUT;                  /* GET PCCA FROM PSA AT VIRT 0   */
         B     LCCAOUT                                          02S0506
*GMSG22C:                                                       02S0507
*   GEN(BRWRITE 1);                 /* PRINT PARTIALLY FILLED BUFFER */
GMSG22C  BRWRITE 1
*   OUTPUT(2:1+LENGTH(MSG22))=MSG22;/* PRINT ERROR FORMATTING LCCA
*                                      MSG                           */
         L     @01,CURBUF(,COMBASE)                             02S0508
         MVC   OUTPUT+1(27,@01),MSG22                           02S0508
*   CALL PRNTSKIP;                  /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0509
*LCCAOUT:                                                       02S0510
*   ;                               /* GET PCCA FROM PSA AT VIRT 0   */
LCCAOUT  DS    0H                                               02S0511
*                                                               02S0511
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESSING THE PSA AT VIRTUAL 0, ATTEMPT TO PROCESS THE PCCA   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0511
*   BRNCHADR=ADDR(PCARDERR);        /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @15,PCARDERR                                     02S0511
         ST    @15,BRNCHADR                                     02S0511
*   RESPECIFY                                                   02S0512
*     PREG RESTRICTED;                                          02S0512
*   PREG=ADDR(PSAPCCAV);            /* VIRT ADDR OF PCCA IN PSA      */
         L     PREG,PSAVIRT                                     02S0513
         LA    PREG,PSAPCCAV(,PREG)                             02S0513
*   GEN(BRREAD (PREG));                                         02S0514
         BRREAD (PREG)
*   PCCAPTR=TEMPADDR;               /* VIRT ADDR OF PCCA             */
         MVC   PCCAPTR(4),TEMPADDR(PREG)                        02S0515
*   RESPECIFY                                                   02S0516
*     PREG UNRESTRICTED;                                        02S0516
*   IF PCCAPTR1=0 THEN              /* IS PCCA ADDR 0                */
         ICM   @15,7,PCCAPTR1                                   02S0517
         BNZ   @RF00517                                         02S0517
*     DO;                           /* YES                           */
*       OUTPUT(2:1+LENGTH(MSG33))=MSG33;/* PRINT PCCA ADDR 0 MSG     */
         L     @01,CURBUF(,COMBASE)                             02S0519
         MVC   OUTPUT+1(28,@01),MSG33                           02S0519
*       CALL PRNTSKIP;              /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0520
*       IF PCASW=SWOFF THEN         /* IS PCCAVT AVAILABLE           */
         TM    PCASW,B'00100000'                                02S0521
         BZ    @RT00521                                         02S0521
*         GO TO PTABSCH2;           /* YES - TRY TO FIND PCCA FOR
*                                      THIS PSA BY SEARCHING PCCAVT  */
*       ELSE                                                    02S0523
*         GO TO SADSWCK3;           /* CHECK INPUT TYPE              */
         B     SADSWCK3                                         02S0523
*     END;                                                      02S0524
*   ELSE                                                        02S0525
*     DO;                           /* PCCA ADDR WAS NOT 0           */
@RF00517 DS    0H                                               02S0526
*       IF PCASW=SWON THEN          /* IS PCCAVT AVAILABLE           */
         TM    PCASW,B'00100000'                                02S0526
         BO    @RT00526                                         02S0526
*         GO TO PCAVALID;           /* NO - PROCESS THIS PCCA        */
*       ELSE                                                    02S0528
*         DO;                       /* YES                           */
*                                                               02S0528
*           /*********************************************************/
*           /*                                                       */
*           /* ATTEMPT TO FIND MATCHING PCCA IN PCCAVT               */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0529
*                                                               03S0529
*           /*********************************************************/
*           /*                                                       */
*           /* SEARCH THE PCCAVT FOR THE PCCA ADDRESS THAT MATCHES   */
*           /* THE PCCA ADDRESS READ FROM THIS PSA                   */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0529
*PTABSCH2:                                                      03S0529
*           BRNCHADR=ADDR(PCPUFAIL);/* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
PTABSCH2 LA    @15,PCPUFAIL                                     03S0529
         ST    @15,BRNCHADR                                     03S0529
*           RESPECIFY                                           03S0530
*             PREG RESTRICTED;                                  03S0530
*           PREG=ADDR(PSACPUSA);    /* PHYS CPU ADDR FROM PSA   03S0531
*                                                            @YM03489*/
         L     PREG,PSAVIRT                                     03S0531
         LA    PREG,PSACPUSA(,PREG)                             03S0531
*           GEN(BRREAD (PREG));                                 03S0532
         BRREAD (PREG)
*           RESPECIFY                                           03S0533
*             PREG UNRESTRICTED;                                03S0533
*PTABSRCH:                                                      03S0534
*           BRNCHADR=ADDR(PTABSCH1);/* ERROR RETURN POINT FOR THESE
*                                      BRREADS                       */
PTABSRCH LA    @04,PTABSCH1                                     03S0534
         ST    @04,BRNCHADR                                     03S0534
*           TABLPTR=PTABLPTR;       /* ADDR OF INTERNAL PCCAVT       */
         L     TABLPTR,PTABLPTR                                 03S0535
*           DO J=0 TO NUMENTRY BY LENGTH(CCAENTRY);/* SEARCH PCCAVT
*                                      FOR NON-ZERO ADDRS            */
         SLR   @04,@04                                          03S0536
         STC   @04,J                                            03S0536
@DL00536 DS    0H                                               03S0537
*             IF ENTRY1^=0 THEN     /* IS THIS PCCA ADDR NOT 0       */
         ICM   @04,7,ENTRY1(TABLPTR)                            03S0537
         BZ    @RF00537                                         03S0537
*               DO;                 /* YES                           */
*                 IF PCCAPTR1^=0 THEN/* WAS PCCA ADDR IN PSA NOT 0   */
         ICM   @04,7,PCCAPTR1                                   03S0539
         BZ    @RF00539                                         03S0539
*                   DO;             /* YES                           */
*                     IF ENTRY1=PCCAPTR1 THEN/* IS THIS THE PCCA FOR
*                                      THIS PSA                      */
         CLC   ENTRY1(3,TABLPTR),PCCAPTR1                       03S0541
         BE    @RT00541                                         03S0541
*                       GO TO PPTRESET;/* YES - RESET PTR IN TABLE
*                                      AND PROCESS PCCA              */
*                   END;                                        03S0543
*                 ELSE                                          03S0544
*                   DO;             /* THIS PCCA ADDR IS NOT 0       */
         B     @RC00539                                         03S0544
@RF00539 DS    0H                                               03S0545
*                     RESPECIFY                                 03S0545
*                       PREG RESTRICTED;                        03S0545
*                     PREG=ADDR(PCCACPUA);/* PHYSICAL CPU ADDR       */
         L     PREG,PCCAPTR                                     03S0546
         LA    PREG,PCCACPUA(,PREG)                             03S0546
*                     GEN(BRREAD (PREG));                       03S0547
         BRREAD (PREG)
*                     IF CPUADDR=CPUTMPRY THEN/* DO THE PHYS CPU
*                                      ADDRS MATCH                   */
         SLR   @04,@04                                          03S0548
         ICM   @04,3,CPUADDR                                    03S0548
         CH    @04,CPUTMPRY(,PREG)                              03S0548
         BNE   @RF00548                                         03S0548
*                       DO;         /* YES - THIS IS THE PCCA FOR
*                                      THIS PSA                      */
*                         PCCAPTR=CCAENTRY;/* PROCESS THIS PCCA      */
         MVC   PCCAPTR(4),CCAENTRY(TABLPTR)                     03S0550
*PPTRESET:                                                      03S0551
*                         CCAENTRY=0;/* ZERO ADDR TO PREVENT    03S0551
*                                      REFORMATTING IT LATER         */
PPTRESET SLR   @04,@04                                          03S0551
         ST    @04,CCAENTRY(,TABLPTR)                           03S0551
*                         GO TO PCAVALID;/* PROCESS THIS PCCA        */
         B     PCAVALID                                         03S0552
*                       END;                                    03S0553
*                     RESPECIFY                                 03S0554
*                       PREG UNRESTRICTED;                      03S0554
@RF00548 DS    0H                                               03S0555
*                   END;                                        03S0555
*               END;                                            03S0556
@RC00539 DS    0H                                               03S0557
*PTABSCH1:                                                      03S0557
*             TABLPTR=TABLPTR+LENGTH(CCAENTRY);/* INCREMENT PTR TO
*                                      REFERENCE NEXT ENTRY IN PCCAVT*/
@RF00537 DS    0H                                               03S0557
PTABSCH1 AH    TABLPTR,@CH00039                                 03S0557
*           END;                                                03S0558
         LA    @04,4                                            03S0558
         SLR   @15,@15                                          03S0558
         IC    @15,J                                            03S0558
         ALR   @04,@15                                          03S0558
         STC   @04,J                                            03S0558
         CH    @04,@CH02093                                     03S0558
         BNH   @DL00536                                         03S0558
*           GO TO PCCADRCK;         /* IS THERE A PCCA TO FORMAT     */
*                                                               03S0559
         B     PCCADRCK                                         03S0559
*           /*********************************************************/
*           /*                                                       */
*           /* THIS ROUTINE WILL GET CONTROL ONLY IF THE BRREAD FAILS*/
*           /* WHILE GETTING THE PHYSICAL CPU ADDRESS FROM THE PSA   */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0560
*PCPUFAIL:                                                      03S0560
*           CPUADDR='FFFF'X;        /* PREVENT MATCHING THE PHYS CPU
*                                      ADDR IN PCCA                  */
PCPUFAIL MVC   CPUADDR(2),@CH02834                              03S0560
*           IF PCCAPTR^=0 THEN      /* IS PCCA AVAILABLE             */
         ICM   @15,15,PCCAPTR                                   03S0561
         BNZ   @RT00561                                         03S0561
*             GO TO PTABSRCH;       /* YES - FIND THE MATCHING PCCA
*                                      IN PCCAVT                     */
*           ELSE                                                03S0563
*             GO TO SADSWCK3;       /* NO - PCCA IS UNAVAILABLE      */
         B     SADSWCK3                                         03S0563
*PCCADRCK:                                                      02S0564
*           IF PCCAPTR1^=0 THEN     /* IS THERE A PCCA TO PROCESS    */
PCCADRCK ICM   @15,7,PCCAPTR1                                   02S0564
         BZ    @RF00564                                         02S0564
*             DO;                   /* YES                           */
*                                                               02S0565
*               /*****************************************************/
*               /*                                                   */
*               /* VALIDITY CHECK AND ATTEMPT TO FORMAT THIS PCCA    */
*               /*                                                   */
*               /*****************************************************/
*                                                               02S0566
*PCAVALID:                                                      02S0566
*               BRNCHADR=ADDR(GMSG30A);/* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
PCAVALID LA    @15,GMSG30A                                      02S0566
         ST    @15,BRNCHADR                                     02S0566
*               RESPECIFY                                       02S0567
*                 PREG RESTRICTED;                              02S0567
*               PREG=PCCAPTR;       /* ADDR OF THE PCCA              */
         L     PREG,PCCAPTR                                     02S0568
*               GEN(BRREAD (PREG));                             02S0569
         BRREAD (PREG)
*               IF VALIDCK^='PCCA' THEN/* DOES THE PCCA VALIDITY
*                                      CHECK                         */
         CLC   VALIDCK(4,PREG),@CC02856                         02S0570
         BE    @RF00570                                         02S0570
*                 DO;               /* NO                            */
*                   RESPECIFY                                   02S0572
*                     PREG UNRESTRICTED;                        02S0572
*                   OUTPUT(2:1+LENGTH(MSG31))=MSG31;/* PRINT VALIDITY
*                                      CHECK FAILED MSG              */
         L     @01,CURBUF(,COMBASE)                             02S0573
         MVC   OUTPUT+1(26,@01),MSG31                           02S0573
*                   CALL PRNTSKIP;                              02S0574
         BAL   @14,PRNTSKIP                                     02S0574
*                 END;                                          02S0575
*               BRNCHADR=ADDR(GMSG32A);/* ERROR RETURN POINT FOR
*                                      BRREADS BY GFR                */
@RF00570 LA    @15,GMSG32A                                      02S0576
         ST    @15,BRNCHADR                                     02S0576
*               RESPECIFY                                       02S0577
*                (R0,                                           02S0577
*                 R1) RESTRICTED;                               02S0577
*               R0=0;               /* 0 ASID FOR RDC                */
         SLR   R0,R0                                            02S0578
*               DO I=1 TO DIM(FMTTABL3);/* CALL THE FORMAT RTN TO
*                                      FORMAT THE PCCA ONE LINE AT A
*                                      TIME                          */
         LA    I,1                                              02S0579
@DL00579 DS    0H                                               02S0580
*                 R1=FMTTABL3(I);   /* ADDR OF EACH LINE TO BE  02S0580
*                                      FORMATTED                     */
         LR    @05,I                                            02S0580
         SLA   @05,2                                            02S0580
         L     R1,FMTTABL3-4(@05)                               02S0580
*                 CALL AMDPRGFR;    /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S0581
         BALR  @14,@15                                          02S0581
*                 GEN SETS(R1,R14,R15)(BRWRITE 1);              02S0582
         BRWRITE 1
*               END;                                            02S0583
         AH    I,@CH00050                                       02S0583
         CH    I,@CH01967                                       02S0583
         BNH   @DL00579                                         02S0583
*               CALL PRNTSKIP;      /* SKIP TWO LINES                */
         BAL   @14,PRNTSKIP                                     02S0584
*               RESPECIFY                                       02S0585
*                (R0,                                           02S0585
*                 R1) UNRESTRICTED;                             02S0585
*                                                               02S0585
*               /*****************************************************/
*               /*                                                   */
*               /* GET VIRTUAL ADDRESS OF PSA TO USE LATER TO GET AND*/
*               /* FORMAT UNPREFIXED 0-4K. (FOR DSS OR SVCDUMP INPUT */
*               /* ONLY)                                             */
*               /*                                                   */
*               /*****************************************************/
*                                                               02S0586
*GETUNPFX:                                                      02S0586
*               IF QSADMP=SWOFF THEN/* IS INPUT DSS OR SVCDUMP       */
GETUNPFX TM    QSADMP(COMBASE),B'00100000'                      02S0586
         BNZ   @RF00586                                         02S0586
*                 DO;               /* YES                           */
*                   BRNCHADR=ADDR(UNPREADR);/* ERROR RETURN POINT FOR
*                                      THIS BRREAD                   */
         LA    @15,UNPREADR                                     02S0588
         ST    @15,BRNCHADR                                     02S0588
*                   RESPECIFY                                   02S0589
*                     PREG RESTRICTED;                          02S0589
*                   PREG=ADDR(PCCAPSAV);/* ADDR OF VIRT ADDR OF PSA -
*                                      IN PCCA                       */
         L     PREG,PCCAPTR                                     02S0590
         LA    PREG,PCCAPSAV(,PREG)                             02S0590
*                   GEN(BRREAD (PREG));                         02S0591
         BRREAD (PREG)
*                   DSSPSAVT=TEMPADDR;/* VIRT ADDR OF PSA            */
         MVC   DSSPSAVT(4),TEMPADDR(PREG)                       02S0592
*                   RESPECIFY                                   02S0593
*                     PREG UNRESTRICTED;                        02S0593
*                   IF VIRTADDR=0 THEN/* IS THERE A VIRT PSA ADDR    */
         ICM   @15,7,VIRTADDR                                   02S0594
         BNZ   @RF00594                                         02S0594
*                     DO;           /* NO                            */
*                       OUTPUT(2:1+LENGTH(MSG48))=MSG48;/* PRINT PSA
*                                      ADDR IS 0 MSG                 */
         L     @01,CURBUF(,COMBASE)                             02S0596
         MVC   OUTPUT+1(69,@01),MSG48                           02S0596
*                       CALL PRNTSKIP;/* PRINT THE MESSAGE           */
         BAL   @14,PRNTSKIP                                     02S0597
*                     END;                                      02S0598
*                 END;                                          02S0599
*             END;                                              02S0600
*           ELSE                                                02S0601
*             DO;                   /* NO - THERE IS NO PCCA TO 02S0601
*                                      PROCESS                       */
         B     @RC00564                                         02S0601
@RF00564 DS    0H                                               02S0602
*SADSWCK3:                                                      02S0602
*               IF QSADMP=SWOFF THEN/* IS INPUT DSS/SVC DUMP         */
SADSWCK3 TM    QSADMP(COMBASE),B'00100000'                      02S0602
         BNZ   @RF00602                                         02S0602
*                 DO;               /* YES                           */
*                   DSSPSAVT=0;     /* INDICATE UNPREFIXED 0-4K 02S0604
*                                      UNAVAILABLE                   */
         SLR   @15,@15                                          02S0604
         ST    @15,DSSPSAVT                                     02S0604
*                   OUTPUT(2:1+LENGTH(MSG49))=MSG49;/* PRINT PCCA
*                                      UNAVAIL MSG                   */
         L     @01,CURBUF(,COMBASE)                             02S0605
         MVC   OUTPUT+1(58,@01),MSG49                           02S0605
*                   CALL PRNTSKIP;                              02S0606
         BAL   @14,PRNTSKIP                                     02S0606
*                 END;                                          02S0607
*               ELSE                                            02S0608
*                 DO;               /* NO - SADMP INPUT              */
         B     @RC00602                                         02S0608
@RF00602 DS    0H                                               02S0609
*                   IF LCASW=SWOFFPCASW=SWOFF THEN/* IS CPU ADDR
*                                      TABLE BEING USED              */
         TM    LCASW,B'01100000'                                02S0609
         BO    @RF00609                                         02S0609
*                     REGENTRY='0040'X;/* YES - INDICATES IPL'ED CPU
*                                      ADDR NOT FOUND                */
         MVC   REGENTRY(2,CTABLPTR),@CH02860                    02S0610
*                 END;                                          02S0611
*             END;                                              02S0612
*           GO TO SADSWCK1;         /* DETERMINE INPUT TYPE          */
         B     SADSWCK1                                         02S0613
*         END;                                                  02S0614
*     END;                                                      02S0615
*                                                               02S0615
*   /*****************************************************************/
*   /*                                                               */
*   /* THESE ROUTINES WILL GET CONTROL ONLY IF THE BRREADS FAIL WHILE*/
*   /* ACCESSING OR FORMATTING THE PCCA, OR WHILE GETTING THE VIRTUAL*/
*   /* PSA ADDRESS FROM THE PCCA                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0616
*PCARDERR:                                                      02S0616
*   OUTPUT(2:1+LENGTH(MSG34))=MSG34;/* PRINT ERROR FINDING PCCA PTR
*                                      MSG                           */
PCARDERR L     @01,CURBUF(,COMBASE)                             02S0616
         MVC   OUTPUT+1(34,@01),MSG34                           02S0616
*   CALL PRNTSKIP;                  /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0617
*   IF PCASW=SWOFF THEN             /* IS PCCAVT AVAILABLE           */
         TM    PCASW,B'00100000'                                02S0618
         BZ    @RT00618                                         02S0618
*     GO TO PTABSCH2;               /* YES - TRY TO FIND PCCA FOR
*                                      THIS PSA BY SEARCHING PCCAVT  */
*   ELSE                                                        02S0620
*     GO TO SADSWCK3;               /* CHECK INPUT TYPE              */
         B     SADSWCK3                                         02S0620
*GMSG30A:                                                       02S0621
*                                                               02S0621
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE PCCA ADDRESS TO PRINTABLE HEX FOR MESSAGE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0621
*   RESPECIFY                                                   02S0621
*    (R1,                                                       02S0621
*     R4) RESTRICTED;                                           02S0621
GMSG30A  DS    0H                                               02S0622
*   R1=ADDR(PCCAPTR);               /* ADDR TO CONVERT               */
         LA    R1,PCCAPTR                                       02S0622
*   R4=ADDR(ADDR30);                /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR30                                        02S0623
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           02S0624
         BALR  @14,@15                                          02S0624
*   RESPECIFY                                                   02S0625
*    (R1,                                                       02S0625
*     R4) UNRESTRICTED;                                         02S0625
*   OUTPUT(2:1+LENGTH(MSG30))=MSG30;/* PRINT ERROR FINDING PCCA MSG  */
         L     @01,CURBUF(,COMBASE)                             02S0626
         MVC   OUTPUT+1(26,@01),MSG30                           02S0626
*   CALL PRNTSKIP;                  /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0627
*   GO TO GETUNPFX;                 /* GET VIRT PSA ADDR FROM PCCA   */
         B     GETUNPFX                                         02S0628
*GMSG32A:                                                       02S0629
*   GEN(BRWRITE 1);                 /* PRINT PARTIALLY FILLED BUFFER */
GMSG32A  BRWRITE 1
*   OUTPUT(2:1+LENGTH(MSG32))=MSG32;/* PRINT ERROR FORMATTING PCCA
*                                      MSG                           */
         L     @01,CURBUF(,COMBASE)                             02S0630
         MVC   OUTPUT+1(27,@01),MSG32                           02S0630
*   CALL PRNTSKIP;                  /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0631
*   GO TO GETUNPFX;                 /* GET VIRT PSA ADDR FROM PCCA   */
         B     GETUNPFX                                         02S0632
*UNPREADR:                                                      02S0633
*   DSSPSAVT=0;                     /* INDICATE UNPREFX 0-4K    02S0633
*                                      UNAVAILABLE                   */
UNPREADR SLR   @15,@15                                          02S0633
         ST    @15,DSSPSAVT                                     02S0633
*   OUTPUT(2:1+LENGTH(MSG57))=MSG57;/* PRINT ERROR FINDING PSA ADDR
*                                      MSG                           */
         L     @01,CURBUF(,COMBASE)                             02S0634
         MVC   OUTPUT+1(75,@01),MSG57                           02S0634
*   CALL PRNTSKIP;                  /* PRINT THE MESSAGE             */
         BAL   @14,PRNTSKIP                                     02S0635
*SADSWCK1:                                                      02S0636
*   ;                               /* DETERMINE INPUT TYPE          */
SADSWCK1 DS    0H                                               02S0637
*   IF QSADMP=SWON THEN             /* IS INPUT SADMP                */
         TM    QSADMP(COMBASE),B'00100000'                      01S0637
         BNO   @RF00637                                         01S0637
*     DO;                           /* YES                           */
*                                                               02S0639
*       /*************************************************************/
*       /*                                                           */
*       /* IF RDC IS NOT PREFIXING PROCESSING CONTINUES BY           */
*       /* DETERMINING IF ANY MORE CCAS CAN BE FORMATTED. IF RDC IS  */
*       /* PREFIXING AND IF THE PCCA IS AVAILABLE, THE PHYSICAL CPU  */
*       /* ADDRESS IS READ FROM IT. IF THE PCCA IS NOT A VAILABLE,   */
*       /* AND THE LCCA IS, THE LOGICAL CPU ADDRESS IS READ AND      */
*       /* CONVERTED TO THE PHYSICAL CPU ADDRESS, BY SUBTRACTING     */
*       /* X'40'. IF NEITHER THE PCCA OR THE LCCA IS AVAILABLE, OR   */
*       /* ACCESSING THEM CAUSES A BRREAD ERROR, THE PHYSICAL CPU    */
*       /* ADDRESS IS READ FROM THE PSA FOR THIS PCCA.               */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0639
*       IF PREFXRGV=0 THEN          /* IS RDC PREFIXING              */
         ICM   @15,15,PREFXRGV(COMBASE)                         02S0639
         BNZ   @RF00639                                         02S0639
*         DO;                       /* NO                            */
*           IF LCASW=SWOFFPCASW=SWOFF THEN/* IS CPU ADDR TABLE BEING
*                                      USED                          */
         TM    LCASW,B'01100000'                                02S0641
         BO    @RF00641                                         02S0641
*             REGENTRY='0040'X;     /* YES - INDICATES IPL'ED CPU
*                                      ADDR NOT FOUND                */
         MVC   REGENTRY(2,CTABLPTR),@CH02860                    02S0642
*           GO TO SADMPOUT;         /* CHECK IF ANY MORE PROCESSING
*                                      CAN BE DONE                   */
         B     SADMPOUT                                         02S0643
*         END;                                                  02S0644
*       ELSE                                                    02S0645
*         DO;                       /* YES - GET PHYS CPU ADDR       */
@RF00639 DS    0H                                               02S0646
*           IF PCCAPTR1^=0 THEN     /* IS THERE A PCCA FOR THIS PSA  */
         ICM   @15,7,PCCAPTR1                                   02S0646
         BZ    @RF00646                                         02S0646
*             DO;                   /* YES                           */
*               BRNCHADR=ADDR(LOGCPUAD);/* ERROR RETURN POINT FOR
*                                      THIS BRREAD                   */
         LA    @15,LOGCPUAD                                     02S0648
         ST    @15,BRNCHADR                                     02S0648
*               RESPECIFY                                       02S0649
*                 PREG RESTRICTED;                              02S0649
*               PREG=ADDR(PCCACPUA);/* GET PHYS CPU ADDR FROM PCCA   */
         L     PREG,PCCAPTR                                     02S0650
         LA    PREG,PCCACPUA(,PREG)                             02S0650
*               GEN(BRREAD (PREG));                             02S0651
         BRREAD (PREG)
*               CPUADDR=CPUTMPRY;   /* PHYS CPU ADDR USED IN BRREAD
*                                      FOR 'CPUDATA'                 */
         MVC   CPUADDR(2),CPUTMPRY(PREG)                        02S0652
*               RESPECIFY                                       02S0653
*                 PREG UNRESTRICTED;                            02S0653
*             END;                                              02S0654
*           ELSE                                                02S0655
*             DO;                   /* NO PCCA - GET LCCA - ALSO
*                                      RETURN POINT SHOULD BRREAD
*                                      FAIL FOR PHYS CPU ADDR IN PCCA*/
         B     @RC00646                                         02S0655
@RF00646 DS    0H                                               02S0656
*LOGCPUAD:                                                      02S0656
*               IF LCCAPTR1^=0 THEN /* IS THERE AN LCCA FOR THIS PSA */
LOGCPUAD ICM   @15,7,LCCAPTR1                                   02S0656
         BZ    @RF00656                                         02S0656
*                 DO;               /* YES - GET LOG CPU ADDR        */
*                   PCARTNSW=SWOFF; /* INDICATE PROCESSING PSA AT
*                                      VITR 0                        */
*                                                               02S0658
         NI    PCARTNSW,B'11111011'                             02S0658
*                   /*************************************************/
*                   /*                                               */
*                   /* ATTEMPT TO GET LOGICAL CPU ADDRESS FROM LCCA  */
*                   /*                                               */
*                   /*************************************************/
*                                                               02S0659
*                   CALL LOGCLCPU;                              02S0659
         BAL   @14,LOGCLCPU                                     02S0659
*                   GO TO SADMPOUT;                             02S0660
         B     SADMPOUT                                         02S0660
*                 END;                                          02S0661
*               ELSE                                            02S0662
*                 DO;               /* NO LCCA - GET PHYS CPU ADDR
*                                      FROM PSA IF RDC IS PREFIXING  */
@RF00656 DS    0H                                               02S0663
*                   BRNCHADR=ADDR(GMSG51C);/* ERROR RETURN POINT FOR
*                                      THIS BRREAD                   */
         LA    @15,GMSG51C                                      02S0663
         ST    @15,BRNCHADR                                     02S0663
*                   RESPECIFY                                   02S0664
*                     PREG RESTRICTED;                          02S0664
*                   PREG=ADDR(PSACPUSA);/* GET PHY CPU ADDR  @YM03489*/
         L     PREG,PSAVIRT                                     02S0665
         LA    PREG,PSACPUSA(,PREG)                             02S0665
*                   GEN(BRREAD (PREG));                         02S0666
         BRREAD (PREG)
*                   CPUADDR=CPUTMPRY;/* PHYS CPU ADDR                */
         MVC   CPUADDR(2),CPUTMPRY(PREG)                        02S0667
*                   RESPECIFY                                   02S0668
*                     PREG UNRESTRICTED;                        02S0668
*                 END;                                          02S0669
*             END;                                              02S0670
*         END;                                                  02S0671
*                                                               02S0671
@RC00646 DS    0H                                               02S0672
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF THIS PHYSICAL CPU ADDRESS SHOULD BE PUT IN   */
*       /* THE PHYSICAL CPU ADDRESS TABLE                            */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0672
*       IF LCASW=SWOFFPCASW=SWOFF THEN/* IS CPU ADDR TABLE BEING
*                                      USED                          */
         TM    LCASW,B'01100000'                                02S0672
         BO    @RF00672                                         02S0672
*         REGENTRY=CPUADDR;         /* YES - PUT THIS CPU ADDR IN
*                                      TABLE                         */
*                                                               02S0673
         MVC   REGENTRY(2,CTABLPTR),CPUADDR                     02S0673
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT THE PSW, REGS, AND STORE-STATUS DATA                */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0674
*       CALL REGPRINT;                                          02S0674
@RF00672 BAL   @14,REGPRINT                                     02S0674
*       GO TO SADMPOUT;             /* GET LCCA FROM PSA AT VIRT 0   */
*                                                               02S0675
         B     SADMPOUT                                         02S0675
*       /*************************************************************/
*       /*                                                           */
*       /* THIS ROUTINE WILL GET CONTROL ONLY IF THE BRREAD FAILS    */
*       /* WHILE GETTING THE PHYSICAL CPU ADDRESS FROM THE PSA       */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0676
*GMSG51C:                                                       02S0676
*       IF LCASW=SWOFFPCASW=SWOFF THEN/* IS CPU ADDR TABLE BEING
*                                      USED                          */
GMSG51C  TM    LCASW,B'01100000'                                02S0676
         BO    @RF00676                                         02S0676
*         REGENTRY='0040'X;         /* YES - INDICATES IPL'ED CPU
*                                      ADDR NOT FOUND                */
         MVC   REGENTRY(2,CTABLPTR),@CH02860                    02S0677
*       OUTPUT(2:1+LENGTH(MSG51))=MSG51;/* PRINT UNABLE TO DETERMINE
*                                      CPU ADDR MSG                  */
@RF00676 L     @01,CURBUF(,COMBASE)                             02S0678
         MVC   OUTPUT+1(72,@01),MSG51                           02S0678
*       CALL PRNTSKIP;                                          02S0679
         BAL   @14,PRNTSKIP                                     02S0679
*SADMPOUT:                                                      02S0680
*       ;                           /* GET LCCA FROM PSA AT VIRT 0   */
SADMPOUT DS    0H                                               02S0681
*     END;                                                      01S0681
*   ELSE                                                        01S0682
*     DO;                           /* NO - DSS OR SVCDUMP INPUT     */
         B     @RC00637                                         01S0682
@RF00637 DS    0H                                               01S0683
*                                                               02S0683
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT THE PSW AND REGISTERS USING THE IPLCPU ADDRESS IN   */
*       /* COMMON FOR THE BRREAD                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0683
*       FPREGS=SWOFF;               /* RESET TO ALLOW PROCESSING OF
*                                      GPRS AND CTRS FIRST           */
         NI    FPREGS,B'11011111'                               02S0683
*       RESPECIFY                                               02S0684
*         PREG RESTRICTED;                                      02S0684
*       PREG=IPLCPU;                /* PHYS CPU ADDR FOR BRREAD      */
         SLR   PREG,PREG                                        02S0685
         ICM   PREG,3,IPLCPU(COMBASE)                           02S0685
*       GEN(BRREAD (PREG),CPU);                                 02S0686
         BRREAD (PREG),CPU
*       STATSPTR=PREG;              /* ADDR OF BEGINNING OF STATUS
*                                      RECORDS                       */
         LR    STATSPTR,PREG                                    02S0687
*       RESPECIFY                                               02S0688
*         PREG UNRESTRICTED;                                    02S0688
*                                                               02S0688
*       /*************************************************************/
*       /*                                                           */
*       /* CONVERT THE PHYSICAL CPU ADDRESS FOR THE IPLCPU           */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0689
*       UNPAKADR=IPLCPU;            /* PHYS CPU ADDR TO BE CONVERTED */
         MVC   UNPAKADR(2),IPLCPU(COMBASE)                      02S0689
*       UNPK(UNPAKTO,UNPAKFRM);     /* UNPACK ADDR                   */
         UNPK  UNPAKTO(5),UNPAKFRM(3)                           02S0690
*       TR(TRANSTO,EBCTABL);        /* TRANS TO PRINTABLE HEX        */
         TR    TRANSTO(4),EBCTABL(COMBASE)                      02S0691
*       CNVTCPU=TRANSTO;            /* PUT ADDR IN HEADER            */
         MVC   CNVTCPU(4),TRANSTO                               02S0692
*       OUTPUT(44:43+LENGTH(REGTITL1))=REGTITL1;/* PRINT HEADER      */
         L     @03,CURBUF(,COMBASE)                             02S0693
         MVC   OUTPUT+43(21,@03),REGTITL1                       02S0693
*       OUTPUT(LENGTH(REGTITL1)+45:44+LENGTH(REGTITL1)+LENGTH(CPUHDR))=
*           CPUHDR;                                             02S0694
         MVC   OUTPUT+65(18,@03),CPUHDR                         02S0694
*       GEN(BRWRITE 3);                                         02S0695
*                                                               02S0695
         BRWRITE 3
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT THE PSW AND REGISTERS                              */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0696
*       CALL PSWFOMAT;              /* FORMAT THE PSW                */
         BAL   @14,PSWFOMAT                                     02S0696
*       REGSW=SWOFF;                /* INDICATE GP REGS ARE TO BE
*                                      FORMATTED                     */
         NI    REGSW,B'10111111'                                02S0697
*       CALL REGFOMAT;              /* FORMAT THE GP REGS            */
         BAL   @14,REGFOMAT                                     02S0698
*       REGSW=SWON;                 /* INDICATE CT REGS ARE TO BE
*                                      FORMATTED                     */
         OI    REGSW,B'01000000'                                02S0699
*       CALL REGFOMAT;              /* FORMAT THE CT REGS            */
         BAL   @14,REGFOMAT                                     02S0700
*       FPREGS=SWON;                /* INDICATE TO FORMAT FP REGS    */
         OI    FPREGS,B'00100000'                               02S0701
*       CALL REGFOMAT;              /* FORMAT THE FP REGS            */
         BAL   @14,REGFOMAT                                     02S0702
*       CALL PRNTSKIP;              /* SKIP TWO LINES                */
         BAL   @14,PRNTSKIP                                     02S0703
*     END;                                                      01S0704
*                                                               02S0705
*   /*****************************************************************/
*   /*                                                               */
*   /* THE TYPE OF INPUT IS FIRST DETERMINED. IF DSS OR SVCDUMP THE  */
*   /* PSA AT VIRTUAL ADDRESS 0 IS VALIDITY CHECKED AND FORMATTED. IF*/
*   /* SADMP INPUT, IT IS FIRST DETERMINED IF RDC IS PREFIXING       */
*   /* BRREADS. IF PREFIXING IS NOT BEING DONE THE PSA AT LOCATION 0 */
*   /* IS ACTUALLY THE UNPREFIXED 0-4K BLOCK, AND PROCESSING         */
*   /* CONTINUES BY GETTING THE NEXT GROUP OF CONTROL BLOCKS TO BE   */
*   /* FORMATTED. IF PREFIXING IS BEING DONE RDC WILL RETURN THE     */
*   /* VIRTUAL ADDRESS OF THE CPU'S PSA, AND IT WILL BE VALIDITY     */
*   /* CHECKED AND FORMATTED.                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0705
*   IF QSADMP=SWON THEN             /* IS INPUT SADMP                */
@RC00637 TM    QSADMP(COMBASE),B'00100000'                      02S0705
         BNO   @RF00705                                         02S0705
*     DO;                           /* YES                           */
*       IF PREFXRGV=0 THEN          /* IS RDC PREFIXING              */
         ICM   @15,15,PREFXRGV(COMBASE)                         02S0707
         BNZ   @RF00707                                         02S0707
*         DO;                       /* NO                            */
*           OUTPUT(2:1+LENGTH(MSG45))=MSG45;/* PRINT PREFIX VALUE
*                                      UNAVAILABLE MSG               */
         L     @01,CURBUF(,COMBASE)                             02S0709
         MVC   OUTPUT+1(66,@01),MSG45                           02S0709
*           CALL PRNTSKIP;                                      02S0710
         BAL   @14,PRNTSKIP                                     02S0710
*           IF LCASW=SWON&PCASW=SWON THEN/* IS ANY MORE PROCESSING
*                                      POSSIBLE                      */
         TM    LCASW,B'01100000'                                02S0711
         BNO   @RF00711                                         02S0711
*             DO;                   /* NO                            */
*               CALL CSTAUSPT;                                  02S0713
         BAL   @14,CSTAUSPT                                     02S0713
*               GEN(BRWRITE SKIP);                              02S0714
         BRWRITE SKIP
*               OUTPUT(45:44+LENGTH(UNPRHDR))=UNPRHDR;/* PRINT HEADER*/
         L     @01,CURBUF(,COMBASE)                             02S0715
         MVC   OUTPUT+44(35,@01),UNPRHDR                        02S0715
*               GEN(BRWRITE 3);                                 02S0716
         BRWRITE 3
*             END;                                              02S0717
*           ELSE                                                02S0718
*             GO TO NXTGROUP;       /* YES - GET NEXT GROUP          */
*         END;                                                  02S0719
*     END;                                                      02S0720
@RF00707 DS    0H                                               02S0721
*   BRNCHADR=ADDR(GMSG41);          /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
@RF00705 LA    @15,GMSG41                                       02S0721
         ST    @15,BRNCHADR                                     02S0721
*   RESPECIFY                                                   02S0722
*     PREG RESTRICTED;                                          02S0722
*   PREG=PSAVIRT;                   /* VIRT ADDR OF PSA IN DUMP      */
         L     PREG,PSAVIRT                                     02S0723
*   GEN(BRREAD (PREG));                                         02S0724
         BRREAD (PREG)
*   STGADPSA=PREG;                  /* ADDR OF PSA IN STORAGE - FOR
*                                      FMTPTRNS                      */
         ST    PREG,STGADPSA                                    02S0725
*   PREG=PREG+(ADDR(PSAPSA)-ADDR(PSA));/* DISPLACEMENT IN PSA OF
*                                      EBCDIC NAME 'PSA'             */
         AH    PREG,@CH03000                                    02S0726
*   IF VALIDCK^='PSA ' THEN         /* DOES THE PSA VALIDITY CHECK   */
         CLC   VALIDCK(4,PREG),@CC02879                         02S0727
         BE    @RF00727                                         02S0727
*     DO;                           /* NO                            */
*       RESPECIFY                                               02S0729
*         PREG UNRESTRICTED;                                    02S0729
*       OUTPUT(2:1+LENGTH(MSG43))=MSG43;/* PRINT VALIDITY CKECK 02S0730
*                                      FAILED MSG                    */
         L     @01,CURBUF(,COMBASE)                             02S0730
         MVC   OUTPUT+1(25,@01),MSG43                           02S0730
*       CALL PRNTSKIP;                                          02S0731
         BAL   @14,PRNTSKIP                                     02S0731
*     END;                                                      02S0732
*   CALL PSAFORMT;                  /* FORMAT THE PSA ONE LINE AT A
*                                      TIME                          */
@RF00727 BAL   @14,PSAFORMT                                     02S0733
*   GO TO NXTGROUP;                 /* CHECK FOR MORE CCAS AND PSAS
*                                      TO PROCESS                    */
*                                                               02S0734
         B     NXTGROUP                                         02S0734
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL GET CONTROL ONLY IF THE BRREAD FAILS WHILE  */
*   /* GETTING THE PSA                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0735
*GMSG41:                                                        02S0735
*                                                               02S0735
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE VIRTUAL PSA ADDRESS TO PRINTABLE HEX FOR MESSAGE  */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0735
*   RESPECIFY                                                   02S0735
*    (R1,                                                       02S0735
*     R4) RESTRICTED;                                           02S0735
GMSG41   DS    0H                                               02S0736
*   R1=ADDR(PSAVIRT);               /* ADDR TO CONVERT               */
         LA    R1,PSAVIRT                                       02S0736
*   R4=ADDR(ADDR41);                /* ADDR OF PUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR41                                        02S0737
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           02S0738
         BALR  @14,@15                                          02S0738
*   RESPECIFY                                                   02S0739
*    (R1,                                                       02S0739
*     R4) UNRESTRICTED;                                         02S0739
*   OUTPUT(2:1+LENGTH(MSG41))=MSG41;/* PRINT ERROR FINDING PSA MSG   */
         L     @01,CURBUF(,COMBASE)                             02S0740
         MVC   OUTPUT+1(52,@01),MSG41                           02S0740
*   CALL PRNTSKIP;                                              02S0741
         BAL   @14,PRNTSKIP                                     02S0741
*NXTGROUP:                                                      02S0742
*   ;                                                           02S0742
NXTGROUP DS    0H                                               02S0743
*                                                               02S0743
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF THERE ARE ANY MORE PSAS TO BE PROCESSED. IF A    */
*   /* UNI-PROCESSOR ALL REMAINING POINTERS SHOULD BE ZERO AND       */
*   /* PROCESSING WILL TERMINATE.                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0743
*   IF LCASW=SWOFF THEN             /* IS THE LCCAVT AVAILABLE       */
         TM    LCASW,B'01000000'                                02S0743
         BNZ   @RF00743                                         02S0743
*     DO;                           /* YES                           */
*       TABLPTR=LTABLPTR;           /* ADDR OF INTERNAL LCCAVT       */
         LR    TABLPTR,LTABLPTR                                 02S0745
*       DO J=0 TO NUMENTRY BY LENGTH(CCAENTRY);/* SEARCH THE LCCAVT
*                                      FOR NON- ZERO ADDRS           */
         SLR   @04,@04                                          02S0746
         STC   @04,J                                            02S0746
@DL00746 DS    0H                                               02S0747
*         IF ENTRY1^=0 THEN         /* IS THIS LCCA PTR NOT 0        */
         ICM   @04,7,ENTRY1(TABLPTR)                            02S0747
         BZ    @RF00747                                         02S0747
*           DO;                     /* YES - CHECK FOR BRREAD ERROR  */
*             GEN(BRWRITE SKIP);    /* SKIP TO A NEW PAGE            */
         BRWRITE SKIP
*             IF ENTRY1='FFFFFF'X THEN/* WAS THIS ENTRY READ    02S0750
*                                      SUCCESSFULLY                  */
         CLC   ENTRY1(3,TABLPTR),@CF02883+1                     02S0750
         BNE   @RF00750                                         02S0750
*               DO;                 /* NO                            */
*                 IF PCASW=SWOFF THEN/* IS THE PCCAVT AVAILABLE      */
         TM    PCASW,B'00100000'                                02S0752
         BNZ   @RF00752                                         02S0752
*                   DO;             /* YES                           */
*                     LCCAPTR='00FFFFFF'X;/* INDICATE READ FAILED FOR
*                                      LCCA                          */
         MVC   LCCAPTR(4),@CF02884                              02S0754
*                     CALL PCAMATCH;/* ATTEMPT TO GET THE PCCA FOR
*                                      THIS CPU                      */
         BAL   @14,PCAMATCH                                     02S0755
*                   END;                                        02S0756
*                 ELSE                                          02S0757
*                   DO;             /* NO - PCCA IS UNAVAILABLE      */
         B     @RC00752                                         02S0757
@RF00752 DS    0H                                               02S0758
*                     OUTPUT(2:1+LENGTH(MSG55))=MSG55;/* PRINT UNABLE
*                                      TO FORMAT LCCA,PCCA AND PSA
*                                      MSG                           */
         L     @04,CURBUF(,COMBASE)                             02S0758
         MVC   OUTPUT+1(36,@04),MSG55                           02S0758
*                     CALL PRNTSKIP;                            02S0759
         BAL   @14,PRNTSKIP                                     02S0759
*                   END;                                        02S0760
*               END;                                            02S0761
*             ELSE                                              02S0762
*               DO;                 /* YES - ATTEMPT TO GET LCCA     */
         B     @RC00750                                         02S0762
@RF00750 DS    0H                                               02S0763
*                 LCCAPTR=CCAENTRY; /* ADDR OF THIS LCCA             */
         L     @04,CCAENTRY(,TABLPTR)                           02S0763
         ST    @04,LCCAPTR                                      02S0763
*                                                               03S0764
*                 /***************************************************/
*                 /*                                                 */
*                 /* SEARCH BOTH CCAVTS BEGINNING WITH THE LCCA FOR  */
*                 /* CPU 0, FOR ALL NON -ZERO CCA POINTERS, AND      */
*                 /* FORMAT THEM - IE. - GET THE LCCA POINTER FOR CPU*/
*                 /* 0 AND PROCESS IT. THEN GET THE PCCA PTR FOR CPU */
*                 /* 0 AND PROCESS IT. ALSO, FOR EACH PCCA, PROCESS  */
*                 /* THE PSA FOR THAT CPU. IF SADMP INPUT, ALSO      */
*                 /* PROCESS THE STORE-STATUS DATA.                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0764
*                 BRNCHADR=ADDR(GMSG20C);/* ERROR RETURN POINT FOR
*                                      THIS BRREAD                   */
         LA    @15,GMSG20C                                      03S0764
         ST    @15,BRNCHADR                                     03S0764
*                 RESPECIFY                                     03S0765
*                   PREG RESTRICTED;                            03S0765
*                 PREG=LCCAPTR;     /* ADDR OF THE LCCA              */
         LR    PREG,@04                                         03S0766
*                 GEN(BRREAD (PREG));                           03S0767
         BRREAD (PREG)
*                 IF VALIDCK^='LCCA' THEN/* DOES THE LCCA VALIDITY
*                                      CHECK                         */
         CLC   VALIDCK(4,PREG),@CC02838                         03S0768
         BE    @RF00768                                         03S0768
*                   DO;             /* NO                            */
*                     RESPECIFY                                 03S0770
*                       PREG UNRESTRICTED;                      03S0770
*                     OUTPUT(2:1+LENGTH(MSG21))=MSG21;/* PRINT  03S0771
*                                      VALIDITY CHECK FAILED MSG     */
         L     @04,CURBUF(,COMBASE)                             03S0771
         MVC   OUTPUT+1(26,@04),MSG21                           03S0771
*                     CALL PRNTSKIP;                            03S0772
         BAL   @14,PRNTSKIP                                     03S0772
*                   END;                                        03S0773
*                 BRNCHADR=ADDR(GMSG22A);/* ERROR RETURN POINT FOR
*                                      BRREADS BY GFR                */
@RF00768 LA    @04,GMSG22A                                      03S0774
         ST    @04,BRNCHADR                                     03S0774
*                 RESPECIFY                                     03S0775
*                  (R0,                                         03S0775
*                   R1) RESTRICTED;                             03S0775
*                 R0=0;             /* 0 ASID FOR RDC                */
         SLR   R0,R0                                            03S0776
*                 DO I=1 TO DIM(FMTTABL2);/* CALL THE FORMAT RTN TO
*                                      FORMAT THE LCCA ONE LINE AT A
*                                      TIME                          */
         LA    I,1                                              03S0777
@DL00777 DS    0H                                               03S0778
*                   R1=FMTTABL2(I); /* ADDR OF EACH LINE TO BE  03S0778
*                                      FORMATTED                     */
         LR    @15,I                                            03S0778
         SLA   @15,2                                            03S0778
         L     R1,FMTTABL2-4(@15)                               03S0778
*                   CALL AMDPRGFR;  /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           03S0779
         BALR  @14,@15                                          03S0779
*                   GEN SETS(R1,R14,R15)(BRWRITE 1);            03S0780
         BRWRITE 1
*                 END;                                          03S0781
         AH    I,@CH00050                                       03S0781
         CH    I,@CH01928                                       03S0781
         BNH   @DL00777                                         03S0781
*                 CALL PRNTSKIP;    /* SKIP TWO LINES                */
         BAL   @14,PRNTSKIP                                     03S0782
*                 RESPECIFY                                     03S0783
*                  (R0,                                         03S0783
*                   R1) UNRESTRICTED;                           03S0783
*PCASWCK1:                                                      03S0784
*                 IF PCASW=SWOFF THEN/* IS PCCAVT AVAILABLE          */
PCASWCK1 TM    PCASW,B'00100000'                                03S0784
         BNZ   @RF00784                                         03S0784
*                   DO;             /* YES                           */
*                     CALL PCAMATCH;/* GET THE PCCA FOR THIS CPU     */
         BAL   @14,PCAMATCH                                     03S0786
*                     IF NOPCCA=SWON THEN/* IS THERE A PCCA FOR THIS
*                                      LCCA                          */
         TM    NOPCCA,B'00000010'                               03S0787
         BO    @RT00787                                         03S0787
*                       GO TO SADSWCK2;/* NO - CHECK INPUT TYPE      */
*                     ELSE                                      03S0789
*                       DO;         /* YES - THERE IS A PCCA         */
*                         IF GETCPUAD=SWON THEN/* WAS THE STATUS
*                                      FORMATTED - IF DSS OR SVCDMP
*                                      CHECK WILL FAIL               */
         TM    GETCPUAD,B'00000001'                             03S0790
         BO    @RT00790                                         03S0790
*                           GO TO GETSTAUS;/* NO - GET THE LOG CPU
*                                      ADDR                          */
*                         ELSE                                  03S0792
*                           GO TO TABLSRCH;/* YES - GET THE NEXT
*                                      ENTRY IN THE LCCAVT           */
         B     TABLSRCH                                         03S0792
*                       END;                                    03S0793
*                   END;                                        03S0794
*                 ELSE                                          03S0795
*                   DO;             /* NO - PCCAVT IS NOT AVAILABLE  */
*                                                               03S0795
@RF00784 DS    0H                                               03S0796
*                     /***********************************************/
*                     /*                                             */
*                     /* CONVERT THE LCCA ADDRESS TO PRINTABLE HEX   */
*                     /* FOR MESSAGE                                 */
*                     /*                                             */
*                     /***********************************************/
*                                                               03S0796
*                     RESPECIFY                                 03S0796
*                      (R1,                                     03S0796
*                       R4) RESTRICTED;                         03S0796
*                     R1=ADDR(LCCAPTR);/* ADDR TO CONVERT            */
         LA    R1,LCCAPTR                                       03S0797
*                     R4=ADDR(ADDR50);/* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR50                                        03S0798
*                     CALL ADRCNVT; /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           03S0799
         BALR  @14,@15                                          03S0799
*                     RESPECIFY                                 03S0800
*                      (R1,                                     03S0800
*                       R4) UNRESTRICTED;                       03S0800
*                     OUTPUT(2:1+LENGTH(MSG50))=MSG50;/* PRINT UNABLE
*                                      TO FORMAT PCCA AND PSA MSG    */
         L     @04,CURBUF(,COMBASE)                             03S0801
         MVC   OUTPUT+1(46,@04),MSG50                           03S0801
*                     CALL PRNTSKIP;                            03S0802
         BAL   @14,PRNTSKIP                                     03S0802
*SADSWCK2:                                                      03S0803
*                     IF QSADMP=SWON THEN/* IS INPUT SADMP           */
SADSWCK2 TM    QSADMP(COMBASE),B'00100000'                      03S0803
         BNO   @RF00803                                         03S0803
*                       DO;         /* YES                           */
*GETSTAUS:                                                      03S0805
*                         BRNCHADR=ADDR(PCCAGOOD);/* ERROR RETURN
*                                      POINT FOR THIS BRREAD         */
GETSTAUS LA    @04,PCCAGOOD                                     03S0805
         ST    @04,BRNCHADR                                     03S0805
*                         RESPECIFY                             03S0806
*                           PREG RESTRICTED;                    03S0806
*                         PREG=ADDR(LCCACPUA);/* ADDR OF LOG CPU ADDR
*                                      - IN LCCA                     */
         L     PREG,LCCAPTR                                     03S0807
         LA    PREG,LCCACPUA(,PREG)                             03S0807
*                         GEN(BRREAD (PREG));                   03S0808
         BRREAD (PREG)
*                         CPUADDR=CPUTMPRY;/* LOG CPU ADDR           */
         LH    @04,CPUTMPRY(,PREG)                              03S0809
         STH   @04,CPUADDR                                      03S0809
*                         RESPECIFY                             03S0810
*                           PREG UNRESTRICTED;                  03S0810
*                         CPUADDR=CPUADDR-'40'X;/* CONVERT TO PHYS
*                                      CPU ADDR                      */
         SH    @04,@CH01767                                     03S0811
         STH   @04,CPUADDR                                      03S0811
*                         CALL SAVCPUAD;/* PUT THIS CPU ADDR IN 03S0812
*                                      TABLE, FORMAT STATUS DATA, GET
*                                      AND FORMAT THE PSA            */
         BAL   @14,SAVCPUAD                                     03S0812
*                       END;                                    03S0813
*                   END;                                        03S0814
*                 GO TO TABLSRCH;   /* GET NEXT ENTRY IN LCCAVT      */
*                                                               03S0815
         B     TABLSRCH                                         03S0815
*                 /***************************************************/
*                 /*                                                 */
*                 /* THESE ROUTINES WILL GET CONTROL ONLY IF THE     */
*                 /* BRREADS FAIL WHILE ACCESSING OR FORMATTING THE  */
*                 /* LCCA                                            */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0816
*GMSG20C:                                                       03S0816
*                                                               03S0816
*                 /***************************************************/
*                 /*                                                 */
*                 /* CONVERT THE LCCA ADDRESS TO PRINTABLE HEX FOR   */
*                 /* MESSAGE                                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0816
*                 RESPECIFY                                     03S0816
*                  (R1,                                         03S0816
*                   R4) RESTRICTED;                             03S0816
GMSG20C  DS    0H                                               03S0817
*                 R1=ADDR(LCCAPTR); /* ADDR TO CONVERT               */
         LA    R1,LCCAPTR                                       03S0817
*                 R4=ADDR(ADDR20);  /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR20                                        03S0818
*                 CALL ADRCNVT;     /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           03S0819
         BALR  @14,@15                                          03S0819
*                 RESPECIFY                                     03S0820
*                  (R1,                                         03S0820
*                   R4) UNRESTRICTED;                           03S0820
*                 OUTPUT(2:1+LENGTH(MSG20))=MSG20;/* PRINT ERROR
*                                      FINDING LCCA MSG              */
         L     @04,CURBUF(,COMBASE)                             03S0821
         MVC   OUTPUT+1(26,@04),MSG20                           03S0821
*                 CALL PRNTSKIP;                                03S0822
         BAL   @14,PRNTSKIP                                     03S0822
*                 GO TO PCASWCK1;   /* IS THERE A PCCA               */
         B     PCASWCK1                                         03S0823
*GMSG22A:                                                       03S0824
*                 GEN(BRWRITE 1);   /* PRINT PARTIALLY FILLED BUFFER */
GMSG22A  BRWRITE 1
*                 OUTPUT(2:1+LENGTH(MSG22))=MSG22;/* PRINT ERROR
*                                      FORMATTING LCCA MSG           */
         L     @04,CURBUF(,COMBASE)                             03S0825
         MVC   OUTPUT+1(27,@04),MSG22                           03S0825
*                 CALL PRNTSKIP;                                03S0826
         BAL   @14,PRNTSKIP                                     03S0826
*                 GO TO PCASWCK1;   /* IS THERE A PCCA               */
*                                                               03S0827
         B     PCASWCK1                                         03S0827
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS ROUTINE WILL GET CONTROL ONLY IF THE BRREAD*/
*                 /* FAILS WHILE GETTING THE LOGICAL CPU ADDRESS FROM*/
*                 /* THE LCCA                                        */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0828
*PCCAGOOD:                                                      03S0828
*                 IF PCAGOSW=SWON THEN/* IS THE PCCA AVAILABLE       */
PCCAGOOD TM    PCAGOSW,B'00010000'                              03S0828
         BNO   @RF00828                                         03S0828
*                   DO;             /* YES                           */
*                     BRNCHADR=ADDR(GMSG51A);/* ERROR RETURN POINT
*                                      FOR THIS BRREAD               */
         LA    @04,GMSG51A                                      03S0830
         ST    @04,BRNCHADR                                     03S0830
*                     RESPECIFY                                 03S0831
*                       PREG RESTRICTED;                        03S0831
*                     PREG=ADDR(PCCACPUA);/* ADDR OF PHYS CPU ADDR -
*                                      IN PCCA                       */
         L     PREG,PCCAPTR                                     03S0832
         LA    PREG,PCCACPUA(,PREG)                             03S0832
*                     GEN(BRREAD (PREG));                       03S0833
         BRREAD (PREG)
*                     CPUADDR=CPUTMPRY;/* PHYS CPU ADDR              */
         MVC   CPUADDR(2),CPUTMPRY(PREG)                        03S0834
*                     RESPECIFY                                 03S0835
*                       PREG UNRESTRICTED;                      03S0835
*                     CALL SAVCPUAD;/* PUT THIS CPU ADDR IN THE 03S0836
*                                      TABLE, FORMAT STATUS DATA, GET
*                                      AND FORMAT THE PSA            */
         BAL   @14,SAVCPUAD                                     03S0836
*                   END;                                        03S0837
*                 ELSE                                          03S0838
*                   DO;             /* NO - THE PCCA IS UNAVAILABLE  */
         B     @RC00828                                         03S0838
@RF00828 DS    0H                                               03S0839
*                     OUTPUT(2:1+LENGTH(MSG51))=MSG51;/* PRINT UNABLE
*                                      TO DETERMINE CPU ADDR MSG     */
         L     @04,CURBUF(,COMBASE)                             03S0839
         MVC   OUTPUT+1(72,@04),MSG51                           03S0839
*                     CALL PRNTSKIP;                            03S0840
         BAL   @14,PRNTSKIP                                     03S0840
*                   END;                                        03S0841
*                 GO TO TABLSRCH;   /* GET NEXT ENTRY IN LCCAVT      */
         B     TABLSRCH                                         03S0842
*GMSG51A:                                                       03S0843
*                 OUTPUT(2:1+LENGTH(MSG51))=MSG51;/* PRINT UNABLE TO
*                                      DETERMINE CPU ADDR MSG        */
GMSG51A  L     @04,CURBUF(,COMBASE)                             03S0843
         MVC   OUTPUT+1(72,@04),MSG51                           03S0843
*                 CALL PRNTSKIP;                                03S0844
         BAL   @14,PRNTSKIP                                     03S0844
*                 CALL PSAREAD1;    /* GET AND FORMAT THE PSA        */
         BAL   @14,PSAREAD1                                     03S0845
*TABLSRCH:                                                      03S0846
*                 ;                                             03S0846
TABLSRCH DS    0H                                               03S0847
*               END;                                            02S0847
*           END;                                                02S0848
*         ELSE                                                  02S0849
*           DO;                     /* NO - LCCA ADDR IS 0           */
         B     @RC00747                                         02S0849
@RF00747 DS    0H                                               02S0850
*             IF PCASW=SWOFF THEN   /* IS THE PCCAVT AVAILABLE       */
         TM    PCASW,B'00100000'                                02S0850
         BNZ   @RF00850                                         02S0850
*               DO;                 /* YES                           */
*                 GEN(BRWRITE SKIP);/* SKIP TO A NEW PAGE            */
         BRWRITE SKIP
*                 LCCAPTR=0;        /* INDICATE NO LCCA FOR THIS PSA */
         SLR   @04,@04                                          02S0853
         ST    @04,LCCAPTR                                      02S0853
*                 CALL PCAMATCH;    /* ATTEMPT TO GET THE PCCA FOR
*                                      THIS CPU                      */
         BAL   @14,PCAMATCH                                     02S0854
*               END;                                            02S0855
*           END;                                                02S0856
@RF00850 DS    0H                                               02S0857
*         TABLPTR=TABLPTR+LENGTH(CCAENTRY);/* INCREMENT PTR TO  02S0857
*                                      REFERENCE NEXT ENTRY IN THE
*                                      LCCAVT                        */
@RC00747 AH    TABLPTR,@CH00039                                 02S0857
*       END;                                                    02S0858
         LA    @04,4                                            02S0858
         SLR   @15,@15                                          02S0858
         IC    @15,J                                            02S0858
         ALR   @04,@15                                          02S0858
         STC   @04,J                                            02S0858
         CH    @04,@CH02093                                     02S0858
         BNH   @DL00746                                         02S0858
*     END;                                                      02S0859
*   ELSE                                                        02S0860
*     DO;                           /* NO - THE LCCAVT IS UNAVAILABLE*/
         B     @RC00743                                         02S0860
@RF00743 DS    0H                                               02S0861
*       IF PCASW=SWOFF THEN         /* IS PCCAVT AVAILABLE           */
         TM    PCASW,B'00100000'                                03S0861
         BNZ   @RF00861                                         03S0861
*         DO;                       /* YES                           */
*                                                               03S0862
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE PCCAVT IS AVAILABLE, CONTINUE PROCESSING.      */
*           /* OTHERWISE ATTEMPT TO PROCESS THE UNPREFIXED 0-4K      */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0863
*                                                               04S0863
*           /*********************************************************/
*           /*                                                       */
*           /* ALL LCCA POINTERS IN THE LCCAVT ARE INVALID OR ZERO.  */
*           /* PROCESSING WILL CONTINUE AS FOLLOWS. THE PCCAVT WILL  */
*           /* BE SEARCHED AND FOR EACH NON -ZERO ADDRESS THE        */
*           /* FOLLOWING WILL OCCURR. THE PCCA WILL BE VALIDITY      */
*           /* CHECKED AND FORMATTED. THE LCCA POINTER WILL BE READ  */
*           /* FROM THE PSA AND THE LCCA WILL BE FORMATTED. IF SADMP */
*           /* INPUT, THE STORE-STATUS DATA WILL BE FORMATTED. THE   */
*           /* PSA WILL THE BE FORMATTED.                            */
*           /*                                                       */
*           /*********************************************************/
*                                                               04S0863
*           GEN(BRWRITE SKIP);      /* SKIP TO A NEW PAGE            */
         BRWRITE SKIP
*           TABLPTR=PTABLPTR;       /* ADDR OF INTERNAL PCCAVT       */
         L     TABLPTR,PTABLPTR                                 04S0864
*           DO J=0 TO NUMENTRY BY LENGTH(CCAENTRY);/* SEARCH THE
*                                      PCCAVT FOR NON- ZERO PCCA
*                                      ADDRS                         */
         SLR   @04,@04                                          04S0865
         STC   @04,J                                            04S0865
@DL00865 DS    0H                                               04S0866
*             IF ENTRY1^=0 THEN     /* IS THIS PCCA PTR NOT 0        */
         ICM   @04,7,ENTRY1(TABLPTR)                            04S0866
         BZ    @RF00866                                         04S0866
*               DO;                 /* YES - CHECK FOR BRREAD ERROR  */
*                 GEN(BRWRITE SKIP);/* SKIP TO A NEW PAGE            */
         BRWRITE SKIP
*                 IF ENTRY1='FFFFFF'X THEN/* WAS THIS ENTRY READ
*                                      SUCCESSFULLY                  */
         CLC   ENTRY1(3,TABLPTR),@CF02883+1                     04S0869
         BNE   @RF00869                                         04S0869
*                   DO;             /* NO                            */
*                     OUTPUT(2:1+LENGTH(MSG55))=MSG55;/* PRINT UNABLE
*                                      TO FORMAT LCCA,PCCA, AND PSA
*                                      MSG                           */
         L     @04,CURBUF(,COMBASE)                             04S0871
         MVC   OUTPUT+1(36,@04),MSG55                           04S0871
*                     CALL PRNTSKIP;                            04S0872
         BAL   @14,PRNTSKIP                                     04S0872
*                   END;                                        04S0873
*                 ELSE                                          04S0874
*                   DO;             /* YES - ATTEMPT TO GET PCCA     */
         B     @RC00869                                         04S0874
@RF00869 DS    0H                                               04S0875
*                     PCCAPTR=CCAENTRY;/* PCCA ADDR                  */
         MVC   PCCAPTR(4),CCAENTRY(TABLPTR)                     04S0875
*                     CALL PCAFIRST;/* FORMAT PCCA,LCCA AND PSA      */
         BAL   @14,PCAFIRST                                     04S0876
*                   END;                                        04S0877
*               END;                                            04S0878
@RC00869 DS    0H                                               04S0879
*             TABLPTR=TABLPTR+LENGTH(CCAENTRY);/* INCREMENT PTR TO
*                                      REFERENCE NEXT ENTRY IN PCCAVT*/
@RF00866 AH    TABLPTR,@CH00039                                 04S0879
*           END;                                                04S0880
         LA    @04,4                                            04S0880
         SLR   @15,@15                                          04S0880
         IC    @15,J                                            04S0880
         ALR   @04,@15                                          04S0880
         STC   @04,J                                            04S0880
         CH    @04,@CH02093                                     04S0880
         BNH   @DL00865                                         04S0880
*           GO TO WRAPUP;           /* ATTEMPT TO FORMAT UNPREFIXED
*                                      0-4K                          */
         B     WRAPUP                                           04S0881
*         END;                                                  03S0882
*       ELSE                                                    03S0883
*         DO;                       /* NO - PCCAVT IS UNAVAILABLE    */
@RF00861 DS    0H                                               03S0884
*           IF QSADMP=SWON THEN     /* IS INPUT SADMP                */
         TM    QSADMP(COMBASE),B'00100000'                      03S0884
         BO    @RT00884                                         03S0884
*             GO TO GCDEXIT;        /* YES - REMAINING STATUS DATA
*                                      AND UNPREFX 0-4K HAS BEEN
*                                      FORMATTED                     */
*           ELSE                                                03S0886
*             DO;                   /* NO - INPUT IS DSS OR SVCDUMP  */
*               IF VIRTADDR^=0 THEN /* IS UNPREFX 0-4K AVAILABLE     */
         ICM   @06,7,VIRTADDR                                   03S0887
         BZ    @RF00887                                         03S0887
*                 DO;               /* YES                           */
*                   PSAVIRT=DSSPSAVT;/* VIRT ADDR OF 0-4K            */
         MVC   PSAVIRT(4),DSSPSAVT                              03S0889
*                   GO TO BNDRYCK;  /* VALIDITY CHECK VIRT PSA ADDR  */
         B     BNDRYCK                                          03S0890
*                 END;                                          03S0891
*               ELSE                                            03S0892
*                 GO TO GCDEXIT;    /* UNPREFX IS UNAVAILABLE - 03S0892
*                                      PREPARE TO RETURN             */
*             END;                                              03S0893
*         END;                                                  03S0894
*     END;                                                      02S0895
*                                                               02S0896
*   /*****************************************************************/
*   /*                                                               */
*   /* IF INPUT IS SADMP THE PHYSICAL CPU ADDRESS TABLE IS SEARCHED  */
*   /* AND THE STORE STATUS DATA NOT PREVIOUSLY PROCESSED IS         */
*   /* FORMATTED NOW.                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0896
*WRAPUP:                                                        02S0896
*   IF QSADMP=SWON THEN             /* IS INPUT SADMP                */
@RC00743 DS    0H                                               02S0896
WRAPUP   TM    QSADMP(COMBASE),B'00100000'                      02S0896
         BNO   @RF00896                                         02S0896
*     DO;                           /* YES                           */
*       CALL CSTAUSPT;              /* PRINT REMAINING STORE STATUS
*                                      DATA                          */
         BAL   @14,CSTAUSPT                                     02S0898
*       PSAVIRT=PREFXRGV;           /* ADDR OF UNPREFX 0-4K          */
         MVC   PSAVIRT(4),PREFXRGV(COMBASE)                     02S0899
*     END;                                                      02S0900
*   ELSE                                                        02S0901
*     DO;                           /* NO - INPUT IS DSS/SVC DUMP    */
         B     @RC00896                                         02S0901
@RF00896 DS    0H                                               02S0902
*       IF VIRTADDR=0 THEN          /* IS THE UNPREFIXED 0-4K   02S0902
*                                      AVAILABLE                     */
         ICM   @06,7,VIRTADDR                                   02S0902
         BZ    @RT00902                                         02S0902
*         GO TO GCDEXIT;            /* NO - PREPARE TO RETURN        */
*       ELSE                        /* YES - UNPREFIXED 0-4K    02S0904
*                                      AVAILABLE                     */
*         PSAVIRT=DSSPSAVT;         /* VIRT ADDR OF 0-4K             */
         MVC   PSAVIRT(4),DSSPSAVT                              02S0904
*     END;                                                      02S0905
*                                                               02S0906
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE UNPREFIXED 0-4K STORAGE HAS NOT BEEN FORMATTED IT IS   */
*   /* FORMATTED NOW. IF IT HAS BEEN FORMATTED, PROCESSING           */
*   /* TERMINATES. IF INPUT IS DSS OR SVCDUMP, AND THE UNPREFIXED    */
*   /* STORAGE IS AVAILABLE IT IS FORMATTED NOW.                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0906
*BNDRYCK:                                                       02S0906
*   IF PSAVIRT//4096^=0 THEN        /* IS VIRT PSA ADDR VALID        */
@RC00896 DS    0H                                               02S0906
BNDRYCK  L     @00,PSAVIRT                                      02S0906
         SRDA  @00,32                                           02S0906
         D     @00,@CF02905                                     02S0906
         LTR   @00,@00                                          02S0906
         BZ    @RF00906                                         02S0906
*     DO;                           /* NO                            */
*       OUTPUT(2:1+LENGTH(MSG44))=MSG44;/* PRINT 4K BNDRY ERROR MSG  */
         L     @06,CURBUF(,COMBASE)                             02S0908
         MVC   OUTPUT+1(56,@06),MSG44                           02S0908
*       CALL PRNTSKIP;                                          02S0909
         BAL   @14,PRNTSKIP                                     02S0909
*     END;                                                      02S0910
*   ELSE                                                        02S0911
*     DO;                           /* YES - VIRT PSA ADDR IS VALID  */
         B     @RC00906                                         02S0911
@RF00906 DS    0H                                               02S0912
*       GEN(BRWRITE SKIP);          /* SKIP TO A NEW PAGE            */
         BRWRITE SKIP
*       OUTPUT(45:44+LENGTH(UNPRHDR))=UNPRHDR;/* PRINT HEADER        */
         L     @06,CURBUF(,COMBASE)                             02S0913
         MVC   OUTPUT+44(35,@06),UNPRHDR                        02S0913
*       GEN(BRWRITE 3);                                         02S0914
         BRWRITE 3
*       BRNCHADR=ADDR(GMSG46);      /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @06,GMSG46                                       02S0915
         ST    @06,BRNCHADR                                     02S0915
*       RESPECIFY                                               02S0916
*         PREG RESTRICTED;                                      02S0916
*       PREG=PSAVIRT;               /* VIRT ADDR OF PSA IN DUMP      */
         L     PREG,PSAVIRT                                     02S0917
*       GEN(BRREAD (PREG));                                     02S0918
         BRREAD (PREG)
*       STGADPSA=PREG;              /* ADDR OF PSA IN STORAGE - FOR
*                                      FMTPTRNS                      */
         ST    PREG,STGADPSA                                    02S0919
*       PREG=PREG+(ADDR(PSAPSA)-ADDR(PSA));/* DISPLACEMENT IN PSA OF
*                                      EBCDIC NAME 'PSA'             */
         AH    PREG,@CH03000                                    02S0920
*       IF VALIDCK^='PSA ' THEN     /* DOES THE PSA VALIDITY CHECK   */
         CLC   VALIDCK(4,PREG),@CC02879                         02S0921
         BE    @RF00921                                         02S0921
*         DO;                       /* NO                            */
*           RESPECIFY                                           02S0923
*             PREG UNRESTRICTED;                                02S0923
*           OUTPUT(2:1+LENGTH(MSG43))=MSG43;/* PRINT VALIDITY CKECK
*                                      FAILED MSG                    */
         L     @06,CURBUF(,COMBASE)                             02S0924
         MVC   OUTPUT+1(25,@06),MSG43                           02S0924
*           CALL PRNTSKIP;                                      02S0925
         BAL   @14,PRNTSKIP                                     02S0925
*         END;                                                  02S0926
*       CALL PSAFORMT;              /* FORMAT UNPREFIXED 0-4K        */
@RF00921 BAL   @14,PSAFORMT                                     02S0927
*     END;                                                      02S0928
*   GO TO BNDRYOUT;                 /* PREPARE TO RETURN             */
*                                                               02S0929
         B     BNDRYOUT                                         02S0929
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL GET CONTROL ONLY IF THE BRREAD FAILS WHILE  */
*   /* TRYING TO ACCESS THE UNPREFIXED 0-4K STORAGE CONVERT THE      */
*   /* VIRTUAL UNPREFIXED STORAGE ADDRESS TO PRINTABLE HEX FOR       */
*   /* MESSAGE                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0930
*   RESPECIFY                                                   02S0930
*    (R1,                                                       02S0930
*     R4) RESTRICTED;                                           02S0930
*GMSG46:                                                        02S0931
*   R1=ADDR(PSAVIRT);               /* ADDR TO CONVERT               */
GMSG46   LA    R1,PSAVIRT                                       02S0931
*   R4=ADDR(ADDR46);                /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR46                                        02S0932
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           02S0933
         BALR  @14,@15                                          02S0933
*   RESPECIFY                                                   02S0934
*    (R1,                                                       02S0934
*     R4) UNRESTRICTED;                                         02S0934
*   OUTPUT(2:1+LENGTH(MSG46))=MSG46;/* PRINT UNABLE TO FORMAT   02S0935
*                                      UNPREFIXED STORAGE MSG        */
         L     @06,CURBUF(,COMBASE)                             02S0935
         MVC   OUTPUT+1(64,@06),MSG46                           02S0935
*   CALL PRNTSKIP;                                              02S0936
         BAL   @14,PRNTSKIP                                     02S0936
*BNDRYOUT:                                                      02S0937
*   ;                               /* PREPARE TO RETURN             */
BNDRYOUT DS    0H                                               02S0938
*                                                               02S0938
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF A FREEMAIN IS NECESSARY AND RESTORE THE BRREAD   */
*   /* AND STOP ERROR ROUTINE ADDRESSES PREVIOUSLY SAVED. IF NORMAL  */
*   /* TERMINATION, RETURN TO CALLER. IF IN 'STOP' PROCESSING MODE,  */
*   /* BRANCH TO THE NEXT STOP ROUTINE.                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0938
*GCDEXIT:                                                       02S0938
*   IF LTABLPTR^=0 THEN             /* WAS A GETMAIN DONE            */
GCDEXIT  LTR   LTABLPTR,LTABLPTR                                02S0938
         BZ    @RF00938                                         02S0938
*     DO;                           /* YES                           */
*       RESPECIFY                                               02S0940
*         PREG RESTRICTED;                                      02S0940
*       PREG=LTABLPTR;              /* BEGINNING ADDR OF GETMAINED
*                                      AREA                          */
         LR    PREG,LTABLPTR                                    02S0941
*       GEN(FREEMAIN R,LV=160,A=(1));                           02S0942
         FREEMAIN R,LV=160,A=(1)
*       RESPECIFY                                               02S0943
*         PREG UNRESTRICTED;                                    02S0943
*     END;                                                      02S0944
*   ERRADDR=GCDERSAV;               /* PREVIOUS BRREAD ERROR RTN ADDR*/
@RF00938 MVC   ERRADDR(4,COMBASE),GCDERSAV                      02S0945
*   STOPEXIT=STPERSAV;              /* PREVIOUS STOP RTN ADDR        */
         L     @15,STPERSAV                                     02S0946
         ST    @15,STOPEXIT(,COMBASE)                           02S0946
*   IF GCDSTPSW=SWON THEN           /* HAS 'STOP' BEEN REQUESTED     */
         TM    GCDSTPSW,B'10000000'                             02S0947
         BNO   @RF00947                                         02S0947
*     DO;                           /* YES                           */
*       RESPECIFY                                               02S0949
*         R15 RESTRICTED;                                       02S0949
*       R15=STPERSAV;               /* ADDR OF NEXT STOP RTN TO GET
*                                      CONTROL                       */
         L     @14,STPERSAV                                     02S0950
         LR    R15,@14                                          02S0950
*       GO TO NEXTSTOP;             /* BRANCH TO NEXT STOP RTN       */
         BR    R15                                              02S0951
*       RESPECIFY                                               02S0952
*         R15 UNRESTRICTED;                                     02S0952
*     END;                                                      02S0953
*   ELSE                                                        02S0954
*     RETURN;                       /* RETURN TO CALLER OF GCD       */
*                                                               02S0955
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL GET CONTROL ONLY IF THE OPERATOR REPLIES    */
*   /* 'STOP' TO MESSAGE AMD156I.                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0955
*GCDSTOP:                           /* REESTABLISH ADDRESSABILITY    */
*   GEN;                                                        02S0955
GCDSTOP  DS    0H                                               02S0955
         DROP  R11,R10,R9,R8
         USING *,R15
         L     R13,GCDSAVRG
         LM    R14,R12,12(R13)
         DROP  R15
         USING @PSTART,R11
         USING @PSTART+4095,R10
         USING @PSTART+8190,R9
         USING @PSTART+12285,R8
*   GCDSTPSW=SWON;                  /* INDICATE 'STOP' MODE     02S0956
*                                      PROCESSING                    */
         OI    GCDSTPSW,B'10000000'                             02S0956
*   GO TO GCDEXIT;                  /* PREPARE TO GO TO NEXT STOP RTN*/
         B     GCDEXIT                                          02S0957
*                                                               02S0958
*   /*****************************************************************/
*   /*                                                               */
*   /* BRREAD ERROR ROUTINE - REESTABLISH ADDRESSABILITY AND BRANCH  */
*   /* TO THE ADDRESS PUT IN BRNCHADR PRIOR TO BRREAD                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0958
*GCDERRTN:                          /* REESTABLISH ADDRESSABILITY    */
*   GEN REFS(GCDSAVRG);                                         02S0958
GCDERRTN DS    0H                                               02S0958
         DROP  R11,R10,R9,R8
         USING *,R15
         B     LOADREG
GCDSAVRG DC    F'0'
LOADREG  L     R13,GCDSAVRG
         LM    R14,R12,12(R13)
         DROP  R15
         USING @PSTART,R11
         USING @PSTART+4095,R10
         USING @PSTART+8190,R9
         USING @PSTART+12285,R8
*   GO TO BREADERR;                 /* BRANCH TO SPECIFIC FUNCTION   */
         L     @03,BRNCHADR                                     02S0959
         BR    @03                                              02S0959
*CCAVTABL:                                                      02S0960
*   PROC;                                                       02S0960
*                                                               02S0960
@EL00001 L     @13,4(,@13)                                      02S0960
@EF00001 DS    0H                                               02S0960
@ER00001 LM    @14,@12,12(@13)                                  02S0960
         BR    @14                                              02S0960
CCAVTABL STM   @14,@12,@SA00002                                 02S0960
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE REMOVES ALL THE NON-ZERO CCA ADDRESSES FROM THE*/
*   /* CCAV TABLES AND PUTS THEM IN THE SAME RELATIVE POSITION IN THE*/
*   /* GETMAINED STORAGE - THEREBY CREATING INTERNAL CCAVTS. IF ALL  */
*   /* THE CCA ADDRESSES IN EITHER TABLE ARE ZERO, OR IF NO NON-ZERO */
*   /* ADDRESSES ARE FOUND DUE TO BRREAD ERRORS THE APPROPIATE SWITCH*/
*   /* IS TURNED ON (LCASW/PCASW).                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0961
*   BRNCHADR=ADDR(CTRBADD);         /* ERROR RETURN POINT FOR THESE
*                                      BRREADS                       */
         LA    @06,CTRBADD                                      02S0961
         ST    @06,BRNCHADR                                     02S0961
*   CCACNT0=0;                      /* INITIALIZE ERROR COUNTER VALUE*/
         SLR   CCACNT0,CCACNT0                                  02S0962
*   CCACNTRD=0;                     /* INITIALIZE ERROR COUNTER VALUE*/
         SLR   CCACNTRD,CCACNTRD                                02S0963
*   IF CCAVTSW=SWOFF THEN           /* IS LCCAVT BEING PROCESSED     */
         TM    CCAVTSW,B'10000000'                              02S0964
         BNZ   @RF00964                                         02S0964
*     TABLPTR=LTABLPTR;             /* YES - ADDR OF STORAGE FOR
*                                      LCCAVT                        */
         LR    TABLPTR,LTABLPTR                                 02S0965
*   ELSE                                                        02S0966
*     TABLPTR=PTABLPTR;             /* NO - ADDR OF STORAGE FOR 02S0966
*                                      PCCAVT                        */
         B     @RC00964                                         02S0966
@RF00964 L     TABLPTR,PTABLPTR                                 02S0966
*   DO J=0 TO NUMENTRY BY LENGTH(CCAENTRY);/* SEARCH CCAVT FOR  02S0967
*                                      NON-ZERO ADDRS                */
@RC00964 SLR   @06,@06                                          02S0967
         STC   @06,J                                            02S0967
@DL00967 DS    0H                                               02S0968
*     RESPECIFY                                                 02S0968
*       PREG RESTRICTED;                                        02S0968
*     PREG=CCAVTPTR+J;              /* GET THIS ENTRY IN SYSTEM CCAVT*/
         AL    @06,CCAVTPTR                                     02S0969
         LR    PREG,@06                                         02S0969
*     GEN(BRREAD (PREG));                                       02S0970
         BRREAD (PREG)
*     IF TEMPADR1^=0 THEN           /* IS THIS CCA ADDR NOT 0        */
         ICM   @06,7,TEMPADR1(PREG)                             02S0971
         BZ    @RF00971                                         02S0971
*       DO;                         /* YES                           */
*         CCAENTRY=TEMPADDR;        /* PUT CCA ADDR IN GETMAINED
*                                      TABLE AT SAME RELATIVE   02S0973
*                                      POSITION                      */
         MVC   CCAENTRY(4,TABLPTR),TEMPADDR(PREG)               02S0973
*         RESPECIFY                                             02S0974
*           PREG UNRESTRICTED;                                  02S0974
*       END;                                                    02S0975
*     ELSE                          /* CCA ADDR IS 0                 */
*       CCACNT0=CCACNT0+1;          /* INDICATES THIS CCA ADDR WAS
*                                      ZERO                          */
         B     @RC00971                                         02S0976
@RF00971 LA    CCACNT0,1(,CCACNT0)                              02S0976
*NXTENTRY:                                                      02S0977
*     TABLPTR=TABLPTR+LENGTH(CCAENTRY);/* INCREMENT PTR TO REFERENCE
*                                      NEXT ENTRY IN CCAVT           */
@RC00971 DS    0H                                               02S0977
NXTENTRY AH    TABLPTR,@CH00039                                 02S0977
*   END;                                                        02S0978
         LA    @06,4                                            02S0978
         SLR   @03,@03                                          02S0978
         IC    @03,J                                            02S0978
         ALR   @06,@03                                          02S0978
         STC   @06,J                                            02S0978
         CH    @06,@CH02093                                     02S0978
         BNH   @DL00967                                         02S0978
*   IF CCACNT0=16(CCACNT0+CCACNTRD)=16 THEN/* ARE ALL CCA ADDRS ZERO
*                                      OR SOME ZERO AND REMAINING HAD
*                                      BRREAD ERRORS                 */
         LA    @06,16                                           02S0979
         CR    CCACNT0,@06                                      02S0979
         BE    @RT00979                                         02S0979
         LR    @05,CCACNT0                                      02S0979
         ALR   @05,CCACNTRD                                     02S0979
         CR    @05,@06                                          02S0979
         BNE   @RF00979                                         02S0979
@RT00979 DS    0H                                               02S0980
*     DO;                           /* YES                           */
*       IF CCAVTSW=SWOFF THEN       /* IS LCCAVT BEING PROCESSED     */
         TM    CCAVTSW,B'10000000'                              02S0981
         BNZ   @RF00981                                         02S0981
*         DO;                       /* YES                           */
*           LCASW=SWON;             /* INDICATE LCCAVT IS NOT USEFUL */
         OI    LCASW,B'01000000'                                02S0983
*           OUTPUT(2:1+LENGTH(MSG11))=MSG11;/* PRINT ALL LCCA PTRS
*                                      ARE UNAVAILABLE MSG           */
         L     @06,CURBUF(,COMBASE)                             02S0984
         MVC   OUTPUT+1(46,@06),MSG11                           02S0984
*         END;                                                  02S0985
*       ELSE                                                    02S0986
*         DO;                       /* NO - PCCAVT IS BEING PROCESSED*/
         B     @RC00981                                         02S0986
@RF00981 DS    0H                                               02S0987
*           PCASW=SWON;             /* INDICATE PCCAVT IS NOT USEFUL */
         OI    PCASW,B'00100000'                                02S0987
*           OUTPUT(2:1+LENGTH(MSG18))=MSG18;/* PRINT ALL PCCA PTRS
*                                      ARE UNAVAILABLE MSG           */
         L     @06,CURBUF(,COMBASE)                             02S0988
         MVC   OUTPUT+1(46,@06),MSG18                           02S0988
*         END;                                                  02S0989
*       CALL PRNTSKIP;                                          02S0990
@RC00981 BAL   @14,PRNTSKIP                                     02S0990
*     END;                                                      02S0991
*   ELSE                                                        02S0992
*     DO;                           /* NO - ALL CCA ADDRS WERE NOT
*                                      ZERO                          */
         B     @RC00979                                         02S0992
@RF00979 DS    0H                                               02S0993
*       IF CCACNTRD=16 THEN         /* DID ALL READS FAIL WITH BRREAD
*                                      ERROR                         */
         CH    CCACNTRD,@CH00041                                02S0993
         BNE   @RF00993                                         02S0993
*         DO;                       /* YES                           */
*           IF CCAVTSW=SWOFF THEN   /* IS LCCAVT BEING PROCESSED     */
         TM    CCAVTSW,B'10000000'                              02S0995
         BNZ   @RF00995                                         02S0995
*             DO;                   /* YES                           */
*               LCASW=SWON;         /* INDICATE LCCAVT IS NOT USEFUL */
         OI    LCASW,B'01000000'                                02S0997
*               OUTPUT(2:1+LENGTH(MSG12))=MSG12;/* PRINT ERROR  02S0998
*                                      ACCESSING LCCAVT MSG          */
         L     @06,CURBUF(,COMBASE)                             02S0998
         MVC   OUTPUT+1(22,@06),MSG12                           02S0998
*             END;                                              02S0999
*           ELSE                                                02S1000
*             DO;                   /* NO - PCCAVT IS BEING PROCESSED*/
         B     @RC00995                                         02S1000
@RF00995 DS    0H                                               02S1001
*               PCASW=SWON;         /* INDICATE PCCAVT IS NOT USEFUL */
         OI    PCASW,B'00100000'                                02S1001
*               OUTPUT(2:1+LENGTH(MSG19))=MSG19;/* PRINT ERROR  02S1002
*                                      ACCESSING PCCAVT MSG          */
         L     @06,CURBUF(,COMBASE)                             02S1002
         MVC   OUTPUT+1(22,@06),MSG19                           02S1002
*             END;                                              02S1003
*           CALL PRNTSKIP;                                      02S1004
@RC00995 BAL   @14,PRNTSKIP                                     02S1004
*         END;                                                  02S1005
*     END;                                                      02S1006
*   RETURN;                         /* RETURN TO CALLER              */
*                                                               02S1007
@EL00002 DS    0H                                               02S1007
@EF00002 DS    0H                                               02S1007
@ER00002 LM    @14,@12,@SA00002                                 02S1007
         BR    @14                                              02S1007
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL GET CONTROL ONLY IF A BRREAD FAILS WHILE    */
*   /* READING AN ENTRY IN A CCAVT                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1008
*CTRBADD:                                                       02S1008
*   CCACNTRD=CCACNTRD+1;            /* INDICATES BRREAD FAILED FOR
*                                      THIS CCA ADDR                 */
CTRBADD  LA    CCACNTRD,1(,CCACNTRD)                            02S1008
*   CCAENTRY='FFFFFFFF'X;           /* INDICATE BRREAD FAILED FOR
*                                      THIS CCA ADDR                 */
         MVC   CCAENTRY(4,TABLPTR),@CF02919                     02S1009
*   GO TO NXTENTRY;                 /* GET NEXT ENTRY IN CCAVT       */
         B     NXTENTRY                                         02S1010
*   END CCAVTABL;                                               02S1011
         B     @EL00002                                         02S1011
*PSAFORMT:                                                      02S1012
*   PROC;                                                       02S1012
*                                                               02S1012
PSAFORMT STM   @14,@12,@SA00003                                 02S1012
*   /*****************************************************************/
*   /*                                                               */
*   /* THE PSA IS FORMATTED ONE LINE AT A TIME AND THEN THE REMAINDER*/
*   /* OF THE 4K IS PRINTED IN HEX. NO BRREADS ARE DONE AS ALL OF PSA*/
*   /* IS IN STORAGE.                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1013
*   RESPECIFY                                                   02S1013
*     R1 RESTRICTED;                                            02S1013
*   DO I=1 TO DIM(FMTTABL4);        /* CALL THE FORMAT RTN TO FORMAT
*                                      THE PSA ONE LINE AT A TIME    */
         LA    I,1                                              02S1014
@DL01014 DS    0H                                               02S1015
*     R1=FMTTABL4(I);               /* ADDR OF EACH LINE TO BE  02S1015
*                                      FORMATTED                     */
         LR    @05,I                                            02S1015
         SLA   @05,2                                            02S1015
         L     R1,FMTTABL4-4(@05)                               02S1015
*     CALL AMDPRGFR;                /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S1016
         BALR  @14,@15                                          02S1016
*     GEN SETS(R1,R14,R15)(BRWRITE 1);                          02S1017
         BRWRITE 1
*   END;                                                        02S1018
         AH    I,@CH00050                                       02S1018
         CH    I,@CH00234                                       02S1018
         BNH   @DL01014                                         02S1018
*   RESPECIFY                                                   02S1019
*     R1 UNRESTRICTED;                                          02S1019
*                                                               02S1019
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE PCB TO HAVE THE STORAGE UP TO THE FRR STACK PRINTED */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1020
*   PCBPBGN=ADDR(PSAUSEND);         /* LOW ADDR OF BLOCK             */
         L     @15,PSAVIRT                                      02S1020
         LA    @14,PSAUSEND(,@15)                               02S1020
         ST    @14,PCBPBGN                                      02S1020
*   PCBPEND=ADDR(PSASTAK);          /* HIGH ADDR OF BLOCK            */
         LA    @15,PSASTAK(,@15)                                02S1021
         ST    @15,PCBPEND                                      02S1021
*   PCBPASID=0;                     /* ASID FOR RDC                  */
         SLR   @15,@15                                          02S1022
         STH   @15,PCBPASID                                     02S1022
*   PCBPFLG1='00'X;                 /* RESET OPTION FLAGS            */
         MVI   PCBPFLG1,X'00'                                   02S1023
*   PCBPVIRT=SWON;                  /* INDICATE VIRTUAL REQUEST      */
         OI    PCBPVIRT,B'10000000'                             02S1024
*   PCBPFUNC=PCBPENQ;               /* INDICATE ENQUEUE FUNCTION     */
         NI    PCBPFUNC,B'01111111'                             02S1025
*   RESPECIFY                                                   02S1026
*     PREG RESTRICTED;                                          02S1026
*   PREG=ADDR(PCBPL);               /* ADDR OF PARM LIST             */
         LA    PREG,PCBPL                                       02S1027
*   CALL GPCBENQ;                   /* ENQUEUE THIS PCB              */
         L     @15,APCBENQ(,COMBASE)                            02S1028
         BALR  @14,@15                                          02S1028
*   RESPECIFY                                                   02S1029
*     PREG UNRESTRICTED;                                        02S1029
*   CALL AMDPRDPS;                  /* CALL DPS TO PRINT THE STORAGE */
*                                                               02S1030
         L     @15,APRTSTG(,COMBASE)                            02S1030
         BALR  @14,@15                                          02S1030
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT FRR STACK                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1031
*   FRRSTACK=STGADPSA+(ADDR(PSASTAK)-ADDR(PSA));/* ADDR OF FRR STACK
*                                      IN STORAGE                    */
         LA    @15,3072                                         02S1031
         AL    @15,STGADPSA                                     02S1031
         ST    @15,FRRSTACK                                     02S1031
*   GEN(BRWRITE 1);                 /* SKIP ONE LINE                 */
         BRWRITE 1
*   RESPECIFY                                                   02S1033
*     R1 RESTRICTED;                                            02S1033
*   DO I=1 TO DIM(FMTTABL5);        /* CALL THE FORMAT RTN TO FORMAT
*                                      THE PSA ONE LINE AT A TIME    */
         LA    I,1                                              02S1034
@DL01034 DS    0H                                               02S1035
*     R1=FMTTABL5(I);               /* ADDR OF EACH LINE TO BE  02S1035
*                                      FORMATTED                     */
         LR    @05,I                                            02S1035
         SLA   @05,2                                            02S1035
         L     R1,FMTTABL5-4(@05)                               02S1035
*     CALL AMDPRGFR;                                            02S1036
         L     @15,AFMTLINE(,COMBASE)                           02S1036
         BALR  @14,@15                                          02S1036
*     GEN SETS(R1,R14,R15)(BRWRITE 1);                          02S1037
         BRWRITE 1
*   END;                                                        02S1038
         AH    I,@CH00050                                       02S1038
         CH    I,@CH00043                                       02S1038
         BNH   @DL01034                                         02S1038
*   RESPECIFY                                                   02S1039
*     R1 UNRESTRICTED;                                          02S1039
*                                                               02S1039
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE PCB TO HAVE THE REMAINING STORAGE PRINTED           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1040
*   PCBPBGN=ADDR(PSASTAK)+608;      /* LOW ADDR OF BLOCK - THREE
*                                      WORDS OF THE RESERVED AREA
*                                      FOLLOWING THE STACK ARE  02S1040
*                                      FORMATTED TO ACHEIVE A 32 BYTE
*                                      MULTIPLE FOR DPS      @YM23252*/
         L     @15,PSAVIRT                                      02S1040
         LA    @14,PSASTAK(,@15)                                02S1040
         AH    @14,@CH02923                                     02S1040
         ST    @14,PCBPBGN                                      02S1040
*   PCBPEND=4096+PSAVIRT;           /* HIGH ADDR OF BLOCK            */
         AL    @15,@CF02905                                     02S1041
         ST    @15,PCBPEND                                      02S1041
*   PCBPASID=0;                     /* ASID FOR RDC                  */
         SLR   @15,@15                                          02S1042
         STH   @15,PCBPASID                                     02S1042
*   PCBPFLG1='00'X;                 /* RESET OPTION FLAGS            */
         MVI   PCBPFLG1,X'00'                                   02S1043
*   PCBPVIRT=SWON;                  /* INDICATE VIRTUAL REQUEST      */
         OI    PCBPVIRT,B'10000000'                             02S1044
*   PCBPFUNC=PCBPENQ;               /* INDICATE ENQUEUE FUNCTION     */
         NI    PCBPFUNC,B'01111111'                             02S1045
*   RESPECIFY                                                   02S1046
*     PREG RESTRICTED;                                          02S1046
*   PREG=ADDR(PCBPL);               /* ADDR OF PARM LIST             */
         LA    PREG,PCBPL                                       02S1047
*   CALL GPCBENQ;                   /* ENQUEUE THIS PCB              */
         L     @15,APCBENQ(,COMBASE)                            02S1048
         BALR  @14,@15                                          02S1048
*   RESPECIFY                                                   02S1049
*     PREG UNRESTRICTED;                                        02S1049
*   CALL AMDPRDPS;                  /* CALL DPS TO PRINT THE STORAGE */
         L     @15,APRTSTG(,COMBASE)                            02S1050
         BALR  @14,@15                                          02S1050
*   RETURN;                                                     02S1051
@EL00003 DS    0H                                               02S1051
@EF00003 DS    0H                                               02S1051
@ER00003 LM    @14,@12,@SA00003                                 02S1051
         BR    @14                                              02S1051
*   END PSAFORMT;                                               02S1052
*SAVCPUAD:                                                      02S1053
*   PROC;                                                       02S1053
*                                                               02S1053
SAVCPUAD STM   @14,@05,@SA00004                                 02S1053
         STM   @07,@12,@SA00004+32                              02S1053
*   /*****************************************************************/
*   /*                                                               */
*   /* THE PHYSICAL CPU ADDRESS IS PUT IN THE PHYSICAL CPU ADDRESS   */
*   /* TABLE AT THE NEXT AVAILABLE ENTRY.                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1054
*   CTABLPTR=CTABLPTR+LENGTH(REGENTRY);/* ADDR OF NEXT ENTRY IN PHYS
*                                      CPU ADDR TABLE                */
         AH    CTABLPTR,@CH00107                                02S1054
*   IF CPUADDR='FFFF'X THEN         /* WAS ADDR IN CCA F'S           */
         CLC   CPUADDR(2),@CH02834                              02S1055
         BNE   @RF01055                                         02S1055
*     CPUADDR='0050'X;              /* YES - INDICATES ADDR IN CCA
*                                      WAS F'S                       */
         MVC   CPUADDR(2),@CH02927                              02S1056
*   REGENTRY=CPUADDR;               /* PUT THIS CPU ADDR IN TABLE    */
@RF01055 MVC   REGENTRY(2,CTABLPTR),CPUADDR                     02S1057
*   CALL REGPRINT;                  /* PRINT THE REGS                */
         BAL   @14,REGPRINT                                     02S1058
*   IF PCAGOSW=SWON THEN            /* IS THE PCCA AVAILABLE         */
         TM    PCAGOSW,B'00010000'                              02S1059
         BNO   @RF01059                                         02S1059
*     DO;                           /* YES                           */
*       CALL PSAREAD1;              /* GET AND FORMAT THE PSA        */
         BAL   @14,PSAREAD1                                     02S1061
*     END;                                                      02S1062
*   RETURN;                                                     02S1063
@EL00004 DS    0H                                               02S1063
@EF00004 DS    0H                                               02S1063
@ER00004 LM    @14,@05,@SA00004                                 02S1063
         LM    @07,@12,@SA00004+32                              02S1063
         BR    @14                                              02S1063
*   END SAVCPUAD;                                               02S1064
         B     @EL00004                                         02S1064
*PSAREAD1:                                                      02S1065
*   PROC;                                                       02S1065
*                                                               02S1065
PSAREAD1 STM   @14,@12,@SA00005                                 02S1065
*   /*****************************************************************/
*   /*                                                               */
*   /* THE PSA FOR THIS PCCA IS VALIDITY CHECKED AND FORMATTED       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1066
*   PCAGOSW=SWOFF;                  /* RESET SWITCH FOR NEXT PCCA    */
         NI    PCAGOSW,B'11101111'                              02S1066
*   BRNCHADR=ADDR(PSAMSG1);         /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @15,PSAMSG1                                      02S1067
         ST    @15,BRNCHADR                                     02S1067
*   RESPECIFY                                                   02S1068
*     PREG RESTRICTED;                                          02S1068
*   PREG=ADDR(PCCAPSAV);            /* ADDR OF VIRT PSA ADDR - IN
*                                      PCCA                          */
         L     PREG,PCCAPTR                                     02S1069
         LA    PREG,PCCAPSAV(,PREG)                             02S1069
*   GEN(BRREAD (PREG));                                         02S1070
         BRREAD (PREG)
*   IF TEMPADR1^=0 THEN             /* IS VIRT PSA ADDR NOT 0        */
         ICM   @00,7,TEMPADR1(PREG)                             02S1071
         BZ    @RF01071                                         02S1071
*     DO;                           /* YES                           */
*       PSAVIRT=TEMPADDR;           /* VIRT ADDR OF PSA              */
         L     @00,TEMPADDR(,PREG)                              02S1073
         ST    @00,PSAVIRT                                      02S1073
*       RESPECIFY                                               02S1074
*         PREG UNRESTRICTED;                                    02S1074
*       IF PSAVIRT//4096=0 THEN     /* IS PSA ADDR VALID             */
         LR    @02,@00                                          02S1075
         SRDA  @02,32                                           02S1075
         D     @02,@CF02905                                     02S1075
         LTR   @02,@02                                          02S1075
         BNZ   @RF01075                                         02S1075
*         DO;                       /* YES                           */
*           BRNCHADR=ADDR(PSAERR2); /* ERROR REUTRN POINT FOR THIS
*                                      BRREAD                        */
         LA    @01,PSAERR2                                      02S1077
         ST    @01,BRNCHADR                                     02S1077
*           RESPECIFY                                           02S1078
*             PREG RESTRICTED;                                  02S1078
*           PREG=PSAVIRT;           /* VIRT ADDR OF PSA IN DUMP      */
         LR    PREG,@00                                         02S1079
*           GEN(BRREAD (PREG));                                 02S1080
         BRREAD (PREG)
*           STGADPSA=PREG;          /* ADDR OF PSA IN STORAGE - FOR
*                                      FMTPTRNS                      */
         ST    PREG,STGADPSA                                    02S1081
*           PREG=PREG+(ADDR(PSAPSA)-ADDR(PSA));/* DISPLACEMENT IN PSA
*                                      OF EBCDIC NAME 'PSA'          */
         AH    PREG,@CH03000                                    02S1082
*           IF VALIDCK^='PSA ' THEN /* DOES THE PSA VALIDITY CHECK   */
         CLC   VALIDCK(4,PREG),@CC02879                         02S1083
         BE    @RF01083                                         02S1083
*             DO;                   /* NO                            */
*               RESPECIFY                                       02S1085
*                 PREG UNRESTRICTED;                            02S1085
*               OUTPUT(2:1+LENGTH(MSG43))=MSG43;/* PRINT VALIDITY
*                                      CKECK FAILED MSG              */
         L     @01,CURBUF(,COMBASE)                             02S1086
         MVC   OUTPUT+1(25,@01),MSG43                           02S1086
*               CALL PRNTSKIP;                                  02S1087
         BAL   @14,PRNTSKIP                                     02S1087
*             END;                                              02S1088
*           CALL PSAFORMT;          /* FORMAT THIS PSA               */
@RF01083 BAL   @14,PSAFORMT                                     02S1089
*         END;                                                  02S1090
*       ELSE                                                    02S1091
*         DO;                       /* NO - PSA ADDR IS INVALID      */
         B     @RC01075                                         02S1091
@RF01075 DS    0H                                               02S1092
*           OUTPUT(2:1+LENGTH(MSG44))=MSG44;/* PRINT PSA NOT ON 4K
*                                      BNDRY MSG                     */
         L     @01,CURBUF(,COMBASE)                             02S1092
         MVC   OUTPUT+1(56,@01),MSG44                           02S1092
*           CALL PRNTSKIP;                                      02S1093
         BAL   @14,PRNTSKIP                                     02S1093
*         END;                                                  02S1094
*     END;                                                      02S1095
*   ELSE                                                        02S1096
*     DO;                           /* NO - VIRT PSA ADDR IS 0       */
         B     @RC01071                                         02S1096
@RF01071 DS    0H                                               02S1097
*       OUTPUT(2:1+LENGTH(MSG47))=MSG47;/* PRINT PSA ADDR IS 0 MSG   */
         L     @01,CURBUF(,COMBASE)                             02S1097
         MVC   OUTPUT+1(54,@01),MSG47                           02S1097
*       CALL PRNTSKIP;                                          02S1098
         BAL   @14,PRNTSKIP                                     02S1098
*     END;                                                      02S1099
*PAGESKIP:                                                      02S1100
*   GEN(BRWRITE SKIP);              /* SKIP TO A NEW PAGE            */
@RC01071 DS    0H                                               02S1100
PAGESKIP BRWRITE SKIP
*   RETURN;                         /* RETURN TO CALLER              */
*                                                               02S1101
@EL00005 DS    0H                                               02S1101
@EF00005 DS    0H                                               02S1101
@ER00005 LM    @14,@12,@SA00005                                 02S1101
         BR    @14                                              02S1101
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL GET CONTROL IF THE BRREAD FAILS WHILE       */
*   /* GETTING THE PSA POINTER FROM HTE PCCA OR WHILE GETTING THE PSA*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1102
*PSAMSG1:                                                       02S1102
*   OUTPUT(2:1+LENGTH(MSG42))=MSG42;/* PRINT ERROR FINDING PSA MSG   */
PSAMSG1  L     @01,CURBUF(,COMBASE)                             02S1102
         MVC   OUTPUT+1(60,@01),MSG42                           02S1102
*   CALL PRNTSKIP;                                              02S1103
         BAL   @14,PRNTSKIP                                     02S1103
*   GO TO PAGESKIP;                 /* SKIP TO A NEW PAGE            */
         B     PAGESKIP                                         02S1104
*PSAERR2:                                                       02S1105
*                                                               02S1105
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE PCCA ADDRESS TO PRINTABLE HEX FOR MESSAGE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1105
*   RESPECIFY                                                   02S1105
*    (R1,                                                       02S1105
*     R4) RESTRICTED;                                           02S1105
PSAERR2  DS    0H                                               02S1106
*   R1=ADDR(PCCAPTR);               /* ADDR TO CONVERT               */
         LA    R1,PCCAPTR                                       02S1106
*   R4=ADDR(ADDR40);                /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR40                                        02S1107
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           02S1108
         BALR  @14,@15                                          02S1108
*   RESPECIFY                                                   02S1109
*    (R1,                                                       02S1109
*     R4) UNRESTRICTED;                                         02S1109
*   OUTPUT(2:1+LENGTH(MSG40))=MSG40;/* PRINT ERROR FINDING PSA MSG   */
         L     @01,CURBUF(,COMBASE)                             02S1110
         MVC   OUTPUT+1(61,@01),MSG40                           02S1110
*   CALL PRNTSKIP;                                              02S1111
         BAL   @14,PRNTSKIP                                     02S1111
*   GO TO PAGESKIP;                 /* SKIP PAGE AND PROCESS NEXT
*                                      GROUP                         */
         B     PAGESKIP                                         02S1112
*   END PSAREAD1;                                               02S1113
*PCAMATCH:                                                      02S1114
*   PROC;                                                       02S1114
*                                                               02S1114
PCAMATCH STM   @14,@04,@SA00006                                 02S1114
         STM   @07,@12,@SA00006+28                              02S1114
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCESS THE INTERNAL PCCAVT AND DETERMINE IF THERE IS A PCCA   */
*   /* FOR THIS CPU                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1115
*   TABLPTR=TABLPTR+CCAVSIZE;       /* POINT TO SAME RELATIVE   02S1115
*                                      POSITION IN PCCAVT            */
         AH    TABLPTR,@CH00753                                 02S1115
*   NOPCCA=SWOFF;                   /* RESET SW FOR THIS ENTRY       */
*   GETCPUAD=SWON;                  /* INDICATE TO GET LOG CPU ADDR
*                                      FROM LCCA                     */
         OI    GETCPUAD,B'00000001'                             02S1117
         NI    NOPCCA,B'11111101'                               02S1117
*   IF ENTRY1^=0 THEN               /* IS THIS PCCA PTR NOT 0        */
         ICM   @07,7,ENTRY1(TABLPTR)                            02S1118
         BZ    @RF01118                                         02S1118
*     DO;                           /* YES                           */
*       IF ENTRY1='FFFFFF'X THEN    /* WAS THIS PCCA ENTRY READ 02S1120
*                                      SUCCESSFULLY                  */
         CLC   ENTRY1(3,TABLPTR),@CF02883+1                     02S1120
         BNE   @RF01120                                         02S1120
*         DO;                       /* NO                            */
*           IF LCCAPTR1=0LCCAPTR1='FFFFFF'X THEN/* IS LCCA AVAILABLE*/
         ICM   @07,7,LCCAPTR1                                   02S1122
         BZ    @RT01122                                         02S1122
         CLC   LCCAPTR1(3),@CF02883+1                           02S1122
         BNE   @RF01122                                         02S1122
@RT01122 DS    0H                                               02S1123
*             OUTPUT(2:1+LENGTH(MSG55))=MSG55;/* NO - PRINT LCCA,
*                                      PCCA, PSA NOT FORMATTED MSG   */
         L     @07,CURBUF(,COMBASE)                             02S1123
         MVC   OUTPUT+1(36,@07),MSG55                           02S1123
*           ELSE                                                02S1124
*             DO;                   /* YES - LCCA IS AVAILABLE       */
*                                                               02S1124
         B     @RC01122                                         02S1124
@RF01122 DS    0H                                               02S1125
*               /*****************************************************/
*               /*                                                   */
*               /* CONVERT THE LCCA ADDRESS TO PRINTABLE HEX FOR     */
*               /* MESSAGE                                           */
*               /*                                                   */
*               /*****************************************************/
*                                                               02S1125
*               RESPECIFY                                       02S1125
*                (R1,                                           02S1125
*                 R4) RESTRICTED;                               02S1125
*               R1=ADDR(LCCAPTR);   /* ADDR TO CONVERT               */
         LA    R1,LCCAPTR                                       02S1126
*               R4=ADDR(ADDR50);    /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR50                                        02S1127
*               CALL ADRCNVT;       /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           02S1128
         BALR  @14,@15                                          02S1128
*               RESPECIFY                                       02S1129
*                (R1,                                           02S1129
*                 R4) UNRESTRICTED;                             02S1129
*               OUTPUT(2:1+LENGTH(MSG50))=MSG50;/* PRINT UNABLE TO
*                                      FORMAT PCCA,PSA MSG           */
         L     @07,CURBUF(,COMBASE)                             02S1130
         MVC   OUTPUT+1(46,@07),MSG50                           02S1130
*             END;                                              02S1131
*           CALL PRNTSKIP;                                      02S1132
@RC01122 BAL   @14,PRNTSKIP                                     02S1132
*           NOPCCA=SWON;            /* INDICATE NO PCCA FOR THIS LCCA*/
         OI    NOPCCA,B'00000010'                               02S1133
*           TABLPTR=TABLPTR-CCAVSIZE;/* RESET PTR TO ACCESS LCCAVT   */
         SH    TABLPTR,@CH00753                                 02S1134
*           RETURN;                 /* RETURN TO CALLER              */
@EL00006 DS    0H                                               02S1135
@EF00006 DS    0H                                               02S1135
@ER00006 LM    @14,@04,@SA00006                                 02S1135
         LM    @07,@12,@SA00006+28                              02S1135
         BR    @14                                              02S1135
*         END;                                                  02S1136
*       ELSE                                                    02S1137
*         DO;                       /* YES - PCCA ENTRY WAS READ
*                                      SUCCESSFULLY                  */
@RF01120 DS    0H                                               02S1138
*           PCCAPTR=CCAENTRY;       /* ADDR OF THIS PCCA             */
         MVC   PCCAPTR(4),CCAENTRY(TABLPTR)                     02S1138
*           TABLPTR=TABLPTR-CCAVSIZE;/* RESET PTR TO ACCESS LCCAVT   */
         SH    TABLPTR,@CH00753                                 02S1139
*                                                               03S1140
*           /*********************************************************/
*           /*                                                       */
*           /* GET THE PCCA FOR THIS CPU AND FORMAT IT ONE LINE AT A */
*           /* TIME. IF LCCA HAS NOT BEEN FORMATTED ATTEMPTED TO GET */
*           /* IT THROUGH THE PSA AND FORMAT IT.                     */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S1140
*           IF LCCAPTR1=0LCCAPTR1='FFFFFF'X THEN/* IS LCCA AVAILABLE*/
         ICM   @07,7,LCCAPTR1                                   03S1140
         BZ    @RT01140                                         03S1140
         CLC   LCCAPTR1(3),@CF02883+1                           03S1140
         BNE   @RF01140                                         03S1140
@RT01140 DS    0H                                               03S1141
*             DO;                   /* NO                            */
*               CALL PCAFIRST;      /* ATTEMPT TO GET LCCA THRU PSA  */
         BAL   @14,PCAFIRST                                     03S1142
*               RETURN;             /* RETURN TO CALLER              */
         B     @EL00006                                         03S1143
*             END;                                              03S1144
*           ELSE                                                03S1145
*             DO;                   /* YES - LCCA IS AVAILABLE       */
@RF01140 DS    0H                                               03S1146
*               PCAGOSW=SWON;       /* INDICATE PROCESSING A PCCA    */
         OI    PCAGOSW,B'00010000'                              03S1146
*               BRNCHADR=ADDR(GMSG30B);/* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @07,GMSG30B                                      03S1147
         ST    @07,BRNCHADR                                     03S1147
*               RESPECIFY                                       03S1148
*                 PREG RESTRICTED;                              03S1148
*               PREG=PCCAPTR;       /* ADDR OF THE PCCA              */
         L     PREG,PCCAPTR                                     03S1149
*               GEN(BRREAD (PREG));                             03S1150
         BRREAD (PREG)
*               IF VALIDCK^='PCCA' THEN/* DOES THE PCCA VALIDITY
*                                      CHECK                         */
         CLC   VALIDCK(4,PREG),@CC02856                         03S1151
         BE    @RF01151                                         03S1151
*                 DO;               /* NO                            */
*                   RESPECIFY                                   03S1153
*                     PREG UNRESTRICTED;                        03S1153
*                   OUTPUT(2:1+LENGTH(MSG31))=MSG31;/* PRINT VALIDITY
*                                      CHECK FAILED MSG              */
         L     @07,CURBUF(,COMBASE)                             03S1154
         MVC   OUTPUT+1(26,@07),MSG31                           03S1154
*                   CALL PRNTSKIP;                              03S1155
         BAL   @14,PRNTSKIP                                     03S1155
*                 END;                                          03S1156
*               BRNCHADR=ADDR(GMSG32C);/* ERROR RETURN POINT FOR
*                                      BRREADS BY GFR                */
@RF01151 LA    @07,GMSG32C                                      03S1157
         ST    @07,BRNCHADR                                     03S1157
*               RESPECIFY                                       03S1158
*                (R0,                                           03S1158
*                 R1) RESTRICTED;                               03S1158
*               R0=0;               /* 0 ASID FOR RDC                */
         SLR   R0,R0                                            03S1159
*               DO I=1 TO DIM(FMTTABL3);/* CALL THE FORMAT RTN TO
*                                      FORMAT THE PCCA ONE LINE AT A
*                                      TIME                          */
         LA    I,1                                              03S1160
@DL01160 DS    0H                                               03S1161
*                 R1=FMTTABL3(I);   /* ADDR OF EACH LINE TO BE  03S1161
*                                      FORMATTED                     */
         LR    @07,I                                            03S1161
         SLA   @07,2                                            03S1161
         L     R1,FMTTABL3-4(@07)                               03S1161
*                 CALL AMDPRGFR;    /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           03S1162
         BALR  @14,@15                                          03S1162
*                 GEN SETS(R1,R14,R15)(BRWRITE 1);              03S1163
         BRWRITE 1
*               END;                                            03S1164
         AH    I,@CH00050                                       03S1164
         CH    I,@CH01967                                       03S1164
         BNH   @DL01160                                         03S1164
*               CALL PRNTSKIP;      /* SKIP TWO LINES                */
         BAL   @14,PRNTSKIP                                     03S1165
*               RESPECIFY                                       03S1166
*                (R0,                                           03S1166
*                 R1) UNRESTRICTED;                             03S1166
*             END;                                              03S1167
*           GO TO PCCAOUT;          /* DETERMINE INPUT TYPE          */
*                                                               03S1168
         B     PCCAOUT                                          03S1168
*           /*********************************************************/
*           /*                                                       */
*           /* THESE ROUTINES WILL GET CONTROL ONLY IF THE BRREADS   */
*           /* FAIL WHILE GETTING OR FORMATTING THE PCCA             */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S1169
*GMSG30B:                                                       03S1169
*                                                               03S1169
*           /*********************************************************/
*           /*                                                       */
*           /* CONVERT THE PCCA ADDRESS TO PRINTABLE HEX FOR MESSAGE */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S1169
*           RESPECIFY                                           03S1169
*            (R1,                                               03S1169
*             R4) RESTRICTED;                                   03S1169
GMSG30B  DS    0H                                               03S1170
*           R1=ADDR(PCCAPTR);       /* ADDR TO CONVERT               */
         LA    R1,PCCAPTR                                       03S1170
*           R4=ADDR(ADDR30);        /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR30                                        03S1171
*           CALL ADRCNVT;           /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           03S1172
         BALR  @14,@15                                          03S1172
*           RESPECIFY                                           03S1173
*            (R1,                                               03S1173
*             R4) UNRESTRICTED;                                 03S1173
*           OUTPUT(2:1+LENGTH(MSG30))=MSG30;/* PRINT ERROR FINDING
*                                      PCCA MSG                      */
         L     @07,CURBUF(,COMBASE)                             03S1174
         MVC   OUTPUT+1(26,@07),MSG30                           03S1174
*           CALL PRNTSKIP;                                      03S1175
         BAL   @14,PRNTSKIP                                     03S1175
*           GO TO PCCAOUT;          /* DETERMINE INPUT TYPE          */
         B     PCCAOUT                                          03S1176
*GMSG32C:                                                       03S1177
*           GEN(BRWRITE 1);         /* PRINT PARTIALLY FILLED BUFFER */
GMSG32C  BRWRITE 1
*           OUTPUT(2:1+LENGTH(MSG32))=MSG32;/* PRINT ERROR FORMATTING
*                                      PCCA MSG                      */
         L     @07,CURBUF(,COMBASE)                             03S1178
         MVC   OUTPUT+1(27,@07),MSG32                           03S1178
*           CALL PRNTSKIP;                                      03S1179
         BAL   @14,PRNTSKIP                                     03S1179
*PCCAOUT:                                                       03S1180
*           ;                       /* DETERMINE INPUT TYPE          */
PCCAOUT  DS    0H                                               03S1181
*                                                               02S1181
*           /*********************************************************/
*           /*                                                       */
*           /* DETERMINE IF THERE IS A PSA TO BE PROCESSED           */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1181
*           IF QSADMP=SWOFF THEN    /* IS INPUT DSS OR SVCDUMP       */
         TM    QSADMP(COMBASE),B'00100000'                      02S1181
         BNZ   @RF01181                                         02S1181
*             DO;                   /* YES                           */
*               GETCPUAD=SWOFF;     /* INDICATE NOT TO GET LOG CPU
*                                      ADDR FROM LCCA                */
         NI    GETCPUAD,B'11111110'                             02S1183
*               CALL PSAREAD1;      /* GET AND FORMAT THE PSA        */
         BAL   @14,PSAREAD1                                     02S1184
*             END;                                              02S1185
*         END;                                                  02S1186
@RF01181 DS    0H                                               02S1187
*     END;                                                      02S1187
*   ELSE                                                        02S1188
*     DO;                           /* PCCA ADDR IS 0                */
         B     @RC01118                                         02S1188
@RF01118 DS    0H                                               02S1189
*       TABLPTR=TABLPTR-CCAVSIZE;   /* RESET PTR TO ACCESS LCCAVT    */
         SH    TABLPTR,@CH00753                                 02S1189
*       NOPCCA=SWON;                /* INDICATE NO PCCA FOR THIS LCCA*/
         OI    NOPCCA,B'00000010'                               02S1190
*       IF LCCAPTR^=0 THEN          /* IS LCCA AVAILABLE             */
         ICM   @07,15,LCCAPTR                                   02S1191
         BZ    @RF01191                                         02S1191
*         DO;                       /* YES                           */
*           IF LCCAPTR1='FFFFFF'X THEN/* WAS LCCA READ SUCCESSFULY   */
         CLC   LCCAPTR1(3),@CF02883+1                           02S1193
         BNE   @RF01193                                         02S1193
*             OUTPUT(2:1+LENGTH(MSG55))=MSG55;/* NO - PRINT LCCA,
*                                      PCCA, PSA NOT FORMATTED MSG   */
         L     @07,CURBUF(,COMBASE)                             02S1194
         MVC   OUTPUT+1(36,@07),MSG55                           02S1194
*           ELSE                                                02S1195
*             DO;                   /* YES - LCCA WAS READ      02S1195
*                                      SUCCESSFULLY                  */
*                                                               02S1195
         B     @RC01193                                         02S1195
@RF01193 DS    0H                                               02S1196
*               /*****************************************************/
*               /*                                                   */
*               /* CONVERT THE LCCA ADDRESS TO PRINTABLE HEX FOR     */
*               /* MESSAGE                                           */
*               /*                                                   */
*               /*****************************************************/
*                                                               02S1196
*               RESPECIFY                                       02S1196
*                (R1,                                           02S1196
*                 R4) RESTRICTED;                               02S1196
*               R1=ADDR(LCCAPTR);   /* ADDR TO CONVERT               */
         LA    R1,LCCAPTR                                       02S1197
*               R4=ADDR(ADDR50);    /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR50                                        02S1198
*               CALL ADRCNVT;       /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           02S1199
         BALR  @14,@15                                          02S1199
*               RESPECIFY                                       02S1200
*                (R1,                                           02S1200
*                 R4) UNRESTRICTED;                             02S1200
*               OUTPUT(2:1+LENGTH(MSG50))=MSG50;/* PRINT UNABLE TO
*                                      FORMAT PCCA,PSA M SG          */
         L     @07,CURBUF(,COMBASE)                             02S1201
         MVC   OUTPUT+1(46,@07),MSG50                           02S1201
*             END;                                              02S1202
*           CALL PRNTSKIP;                                      02S1203
@RC01193 BAL   @14,PRNTSKIP                                     02S1203
*         END;                                                  02S1204
*     END;                                                      02S1205
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00006                                         02S1206
*   END PCAMATCH;                                               02S1207
         B     @EL00006                                         02S1207
*LOGCLCPU:                                                      02S1208
*   PROC;                                                       02S1208
*                                                               02S1208
LOGCLCPU STM   @14,@05,@SA00007                                 02S1208
         STM   @07,@12,@SA00007+32                              02S1208
*   /*****************************************************************/
*   /*                                                               */
*   /* THE LOGICAL CPU ADDRESS FOR THIS PSA IS READ FROM THE LCCA. IF*/
*   /* THE READ FAILS THE PHYSICAL CPU ADDRESS IS READ FROM THE PSA  */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1209
*   BRNCHADR=ADDR(PYSCPUAD);        /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @15,PYSCPUAD                                     02S1209
         ST    @15,BRNCHADR                                     02S1209
*   RESPECIFY                                                   02S1210
*     PREG RESTRICTED;                                          02S1210
*   PREG=ADDR(LCCACPUA);            /* GET LOG CPU ADDR FROM LCCA FOR
*                                      THIS PSA                      */
         L     PREG,LCCAPTR                                     02S1211
         LA    PREG,LCCACPUA(,PREG)                             02S1211
*   GEN(BRREAD (PREG));                                         02S1212
         BRREAD (PREG)
*   CPUADDR=CPUTMPRY;               /* LOG CPU ADDR                  */
         LH    @00,CPUTMPRY(,PREG)                              02S1213
         STH   @00,CPUADDR                                      02S1213
*   CPUADDR=CPUADDR-'40'X;          /* CONVERT TO PHYS CPU ADDR      */
*                                                               02S1214
         SH    @00,@CH01767                                     02S1214
         STH   @00,CPUADDR                                      02S1214
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF THE PHYSICAL CPU ADDRESS SHOULD BE PUT IN THE    */
*   /* PHYSICAL CPU TABLE                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1215
*CPUADSAV:                                                      02S1215
*   IF LTABLPTR^=0 THEN             /* IS THERE A CPU ADDR TABLE     */
CPUADSAV LTR   LTABLPTR,LTABLPTR                                02S1215
         BZ    @RF01215                                         02S1215
*     DO;                           /* YES                           */
*       IF PCARTNSW=SWON THEN       /* PROCESSING PSA AT VIRT 0      */
         TM    PCARTNSW,B'00000100'                             02S1217
         BNO   @RF01217                                         02S1217
*         CTABLPTR=CTABLPTR+LENGTH(REGENTRY);/* NO - ADDR OF NEXT
*                                      ENTRY IN PHYS CPU ADDR TABLE  */
         AH    CTABLPTR,@CH00107                                02S1218
*       IF CPUADDR='FFFF'X THEN     /* WAS ADDR IN CCA F'S           */
@RF01217 CLC   CPUADDR(2),@CH02834                              02S1219
         BNE   @RF01219                                         02S1219
*         CPUADDR='0050'X;          /* YES - INDICATES ADDR IN CCA
*                                      WAS F'S                       */
         MVC   CPUADDR(2),@CH02927                              02S1220
*       REGENTRY=CPUADDR;           /* PUT THIS CPU ADDR IN TABLE    */
@RF01219 MVC   REGENTRY(2,CTABLPTR),CPUADDR                     02S1221
*     END;                                                      02S1222
*                                                               02S1222
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE REGS, PSA, AND STORE STATUS INFO                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1223
*   GEN(BRWRITE SKIP);              /* SKIP TO A NEW PAGE            */
@RF01215 DS    0H                                               02S1223
         BRWRITE SKIP
*   CALL REGPRINT;                                              02S1224
         BAL   @14,REGPRINT                                     02S1224
*   RETURN;                         /* RETURN TO CALLER              */
*                                                               02S1225
@EL00007 DS    0H                                               02S1225
@EF00007 DS    0H                                               02S1225
@ER00007 LM    @14,@05,@SA00007                                 02S1225
         LM    @07,@12,@SA00007+32                              02S1225
         BR    @14                                              02S1225
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL GET CONTROL ONLY IF THE BRREAD FAILS WHILE  */
*   /* GETTING THE LOGICAL CPU ADDRESS FROM THE LCCA                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1226
*PYSCPUAD:                                                      02S1226
*   BRNCHADR=ADDR(GMSG51D);         /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
PYSCPUAD LA    @00,GMSG51D                                      02S1226
         ST    @00,BRNCHADR                                     02S1226
*   RESPECIFY                                                   02S1227
*     PREG RESTRICTED;                                          02S1227
*   PREG=ADDR(PSACPUSA);            /* PHYS CPU ADDR FROM PSA   02S1228
*                                                            @YM03489*/
         L     PREG,PSAVIRT                                     02S1228
         LA    PREG,PSACPUSA(,PREG)                             02S1228
*   CPUADDR=CPUTMPRY;               /* PHYS CPU ADDR                 */
         MVC   CPUADDR(2),CPUTMPRY(PREG)                        02S1229
*   RESPECIFY                                                   02S1230
*     PREG UNRESTRICTED;                                        02S1230
*   GO TO CPUADSAV;                 /* SAVE CPU ADDR IN TABLE        */
*                                                               02S1231
         B     CPUADSAV                                         02S1231
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL GET CONTROL ONLY IF THE BRREAD FAILS WHILE  */
*   /* GETTING THE PHYSICAL CPU ADDRESS FROM THE PSA                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1232
*GMSG51D:                                                       02S1232
*   IF LCASW=SWOFFPCASW=SWOFF THEN /* IS CPU ADDR TABLE BEING USED  */
GMSG51D  TM    LCASW,B'01100000'                                02S1232
         BO    @RF01232                                         02S1232
*     REGENTRY='0040'X;             /* YES - INDICATES IPL'ED CPU
*                                      ADDR NOT FOUND                */
         MVC   REGENTRY(2,CTABLPTR),@CH02860                    02S1233
*   OUTPUT(2:1+LENGTH(MSG51))=MSG51;/* PRINT UNABLE TO DETERMINE CPU
*                                      ADD R MSG                     */
@RF01232 L     @01,CURBUF(,COMBASE)                             02S1234
         MVC   OUTPUT+1(72,@01),MSG51                           02S1234
*   CALL PRNTSKIP;                                              02S1235
         BAL   @14,PRNTSKIP                                     02S1235
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00007                                         02S1236
*   END LOGCLCPU;                                               02S1237
*PCAFIRST:                                                      02S1238
*   PROC;                                                       02S1238
*                                                               02S1238
PCAFIRST STM   @14,@05,@SA00008                                 02S1238
         STM   @07,@12,@SA00008+32                              02S1238
*   /*****************************************************************/
*   /*                                                               */
*   /* THE PCCA WILL BE VALIDITY CHECKED AND FORMATTED. THE VIRTUAL  */
*   /* ADDRESS OF THE PSA IS READ FROM THE PCCA. IF IT IS NON-ZERO   */
*   /* THE VIRTUAL ADDRESS OF THE LCCA IS READ FROM THE PSA. THE LCCA*/
*   /* IS VALIDITY CHECKED AND FORMATTED. IF INPUT IS SADMP, THE     */
*   /* STORE-STATUS DATA IS FORMATTED AND THEN THE PSA IS FORMATTED. */
*   /* IF INPUT IS DSS OR SVCDUMP THE PSA IS FORMATTED NEXT. IF THE  */
*   /* VIRTUAL PSA ADDRESS READ FROM THE PCCA IS ZERO AN ERROR       */
*   /* MESSAGE IS PRINTED AND PROCESSING CONTINUES BY CHECKING THE   */
*   /* TYPE OF IN PUT, AS ABOVE. THE ONLY EXCEPTION IS THAT THE PSA  */
*   /* WILL NOT BE FORMATTED.                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1239
*   BRNCHADR=ADDR(GMSG30C);         /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @07,GMSG30C                                      02S1239
         ST    @07,BRNCHADR                                     02S1239
*   RESPECIFY                                                   02S1240
*     PREG RESTRICTED;                                          02S1240
*   PREG=PCCAPTR;                   /* ADDR OF THE PCCA              */
         L     PREG,PCCAPTR                                     02S1241
*   GEN(BRREAD (PREG));                                         02S1242
         BRREAD (PREG)
*   IF VALIDCK^='PCCA' THEN         /* DOES THE PCCA VALIDITY CHECK  */
         CLC   VALIDCK(4,PREG),@CC02856                         02S1243
         BE    @RF01243                                         02S1243
*     DO;                           /* NO                            */
*       RESPECIFY                                               02S1245
*         PREG UNRESTRICTED;                                    02S1245
*       OUTPUT(2:1+LENGTH(MSG31))=MSG31;/* PRINT VALIDITY CHECK 02S1246
*                                      FAILED MSG                    */
         L     @07,CURBUF(,COMBASE)                             02S1246
         MVC   OUTPUT+1(26,@07),MSG31                           02S1246
*       CALL PRNTSKIP;                                          02S1247
         BAL   @14,PRNTSKIP                                     02S1247
*     END;                                                      02S1248
*   BRNCHADR=ADDR(GMSG32B);         /* ERROR RETURN POINT FOR BRREADS
*                                      BY GFR                        */
@RF01243 LA    @07,GMSG32B                                      02S1249
         ST    @07,BRNCHADR                                     02S1249
*   RESPECIFY                                                   02S1250
*    (R0,                                                       02S1250
*     R1) RESTRICTED;                                           02S1250
*   R0=0;                           /* 0 ASID FOR RDC                */
         SLR   R0,R0                                            02S1251
*   DO I=1 TO DIM(FMTTABL3);        /* CALL THE FORMAT RTN TO FORMAT
*                                      THE PCCA ONE LINE AT A TIME   */
         LA    I,1                                              02S1252
@DL01252 DS    0H                                               02S1253
*     R1=FMTTABL3(I);               /* ADDR OF EACH LINE TO BE  02S1253
*                                      FORMATTED                     */
         LR    @07,I                                            02S1253
         SLA   @07,2                                            02S1253
         L     R1,FMTTABL3-4(@07)                               02S1253
*     CALL AMDPRGFR;                /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S1254
         BALR  @14,@15                                          02S1254
*     GEN SETS(R1,R14,R15)(BRWRITE 1);                          02S1255
         BRWRITE 1
*   END;                                                        02S1256
         AH    I,@CH00050                                       02S1256
         CH    I,@CH01967                                       02S1256
         BNH   @DL01252                                         02S1256
*   CALL PRNTSKIP;                  /* SKIP TWO LINES                */
         BAL   @14,PRNTSKIP                                     02S1257
*   RESPECIFY                                                   02S1258
*    (R0,                                                       02S1258
*     R1) UNRESTRICTED;                                         02S1258
*                                                               02S1258
*   /*****************************************************************/
*   /*                                                               */
*   /* ATTEMPT TO GET THE PSA FOR THIS PCCA                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1259
*LCARETRY:                                                      03S1259
*   BRNCHADR=ADDR(PSAERR5);         /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
LCARETRY LA    @07,PSAERR5                                      03S1259
         ST    @07,BRNCHADR                                     03S1259
*   LCCAPTR=0;                      /* INDICATE LCCA IS UNAVAILABLE
*                                      FOR THIS PSA                  */
         SLR   @07,@07                                          03S1260
         ST    @07,LCCAPTR                                      03S1260
*   RESPECIFY                                                   03S1261
*     PREG RESTRICTED;                                          03S1261
*   PREG=ADDR(PCCAPSAV);            /* ADDR OF VIRT ADDR OF PSA - IN
*                                      PCCA                          */
         L     PREG,PCCAPTR                                     03S1262
         LA    PREG,PCCAPSAV(,PREG)                             03S1262
*   GEN(BRREAD (PREG));                                         03S1263
         BRREAD (PREG)
*   IF TEMPADR1^=0 THEN             /* IS VIRT PSA ADDR NOT 0        */
         ICM   @07,7,TEMPADR1(PREG)                             03S1264
         BZ    @RF01264                                         03S1264
*     DO;                           /* YES                           */
*       PSAVIRT=TEMPADDR;           /* VIRT PSA ADDR                 */
         L     @07,TEMPADDR(,PREG)                              03S1266
         ST    @07,PSAVIRT                                      03S1266
*       BRNCHADR=ADDR(GMSG25);      /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @00,GMSG25                                       03S1267
         ST    @00,BRNCHADR                                     03S1267
*       PREG=ADDR(PSALCCAV);        /* ADDR OF VIRT ADDR OF LCCA - IN
*                                      PSA                           */
         LA    PREG,PSALCCAV(,@07)                              03S1268
*       GEN(BRREAD (PREG));                                     03S1269
         BRREAD (PREG)
*       IF TEMPADR1^=0 THEN         /* IS VIRT LCCA ADDR NOT 0       */
         ICM   @07,7,TEMPADR1(PREG)                             03S1270
         BZ    @RF01270                                         03S1270
*         DO;                       /* YES                           */
*           LCCAPTR=TEMPADDR;       /* VIRT LCCA ADDR                */
         L     @07,TEMPADDR(,PREG)                              03S1272
         ST    @07,LCCAPTR                                      03S1272
*           RESPECIFY                                           03S1273
*             PREG UNRESTRICTED;                                03S1273
*           BRNCHADR=ADDR(GMSG20B); /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @15,GMSG20B                                      03S1274
         ST    @15,BRNCHADR                                     03S1274
*           RESPECIFY                                           03S1275
*             PREG RESTRICTED;                                  03S1275
*           PREG=LCCAPTR;           /* ADDR OF THE LCCA              */
         LR    PREG,@07                                         03S1276
*           GEN(BRREAD (PREG));                                 03S1277
         BRREAD (PREG)
*           IF VALIDCK^='LCCA' THEN /* DOES THE LCCA VALIDITY CHECK  */
         CLC   VALIDCK(4,PREG),@CC02838                         03S1278
         BE    @RF01278                                         03S1278
*             DO;                   /* NO                            */
*               RESPECIFY                                       03S1280
*                 PREG UNRESTRICTED;                            03S1280
*               OUTPUT(2:1+LENGTH(MSG21))=MSG21;/* PRINT VALIDITY
*                                      CHECK FAILED MSG              */
         L     @07,CURBUF(,COMBASE)                             03S1281
         MVC   OUTPUT+1(26,@07),MSG21                           03S1281
*               CALL PRNTSKIP;                                  03S1282
         BAL   @14,PRNTSKIP                                     03S1282
*             END;                                              03S1283
*           BRNCHADR=ADDR(GMSG22B); /* ERROR RETURN POINT FOR BRREADS
*                                      BY GFR                        */
@RF01278 LA    @07,GMSG22B                                      03S1284
         ST    @07,BRNCHADR                                     03S1284
*           RESPECIFY                                           03S1285
*            (R0,                                               03S1285
*             R1) RESTRICTED;                                   03S1285
*           R0=0;                   /* 0 ASID FOR RDC                */
         SLR   R0,R0                                            03S1286
*           DO I=1 TO DIM(FMTTABL2);/* CALL THE FORMAT RTN TO FORMAT
*                                      THE LCCA ONE LINE AT A TIME   */
         LA    I,1                                              03S1287
@DL01287 DS    0H                                               03S1288
*             R1=FMTTABL2(I);       /* ADDR OF EACH LINE TO BE  03S1288
*                                      FORMATTED                     */
         LR    @07,I                                            03S1288
         SLA   @07,2                                            03S1288
         L     R1,FMTTABL2-4(@07)                               03S1288
*             CALL AMDPRGFR;        /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           03S1289
         BALR  @14,@15                                          03S1289
*             GEN SETS(R1,R14,R15)(BRWRITE 1);                  03S1290
         BRWRITE 1
*           END;                                                03S1291
         AH    I,@CH00050                                       03S1291
         CH    I,@CH01928                                       03S1291
         BNH   @DL01287                                         03S1291
*           CALL PRNTSKIP;          /* SKIP TWO LINES                */
         BAL   @14,PRNTSKIP                                     03S1292
*           RESPECIFY                                           03S1293
*            (R0,                                               03S1293
*             R1) UNRESTRICTED;                                 03S1293
*           GO TO RETRYOUT;         /* IS THERE A PSA TO BE PROCESSED*/
         B     RETRYOUT                                         03S1294
*         END;                                                  03S1295
*       ELSE                                                    03S1296
*         DO;                       /* NO - VIRT LCCA ADDR IS 0      */
@RF01270 DS    0H                                               03S1297
*GMSG25:                                                        03S1297
*                                                               03S1297
*           /*********************************************************/
*           /*                                                       */
*           /* CONVERT THE PCCA ADDRESS TO PRINTABLE HEX             */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S1297
*           RESPECIFY                                           03S1297
*            (R1,                                               03S1297
*             R4) RESTRICTED;                                   03S1297
GMSG25   DS    0H                                               03S1298
*           R1=ADDR(PCCAPTR);       /* ADDR TO CONVERT               */
         LA    R1,PCCAPTR                                       03S1298
*           R4=ADDR(ADDR25);        /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR25                                        03S1299
*           CALL ADRCNVT;           /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           03S1300
         BALR  @14,@15                                          03S1300
*           RESPECIFY                                           03S1301
*            (R1,                                               03S1301
*             R4) UNRESTRICTED;                                 03S1301
*           OUTPUT(2:1+LENGTH(MSG25))=MSG25;/* PRINT ERROR FINDING
*                                      LCCA MSG                      */
         L     @07,CURBUF(,COMBASE)                             03S1302
         MVC   OUTPUT+1(38,@07),MSG25                           03S1302
*           CALL PRNTSKIP;                                      03S1303
         BAL   @14,PRNTSKIP                                     03S1303
*           GO TO RETRYOUT;         /* IS THERE A PSA TO BE PROCESSED*/
         B     RETRYOUT                                         03S1304
*         END;                                                  03S1305
*     END;                                                      03S1306
*   ELSE                                                        03S1307
*     DO;                           /* NO - VIRT PSA ADDR IS 0       */
@RF01264 DS    0H                                               03S1308
*       PSABADSW=SWON;              /* INDICATE PSA IS UNAVAILABLE
*                                      FOR THIS PCCA                 */
         OI    PSABADSW,B'00001000'                             03S1308
*       PSAVIRT=0;                  /* INDICATES PSA ADDR IN PCCA IS
*                                      0                             */
         SLR   @07,@07                                          03S1309
         ST    @07,PSAVIRT                                      03S1309
*       GO TO GMSG25;               /* PRINT ERROR MESSAGE           */
         B     GMSG25                                           03S1310
*     END;                                                      03S1311
*                                                               03S1311
*   /*****************************************************************/
*   /*                                                               */
*   /* THESE ROUTINES WILL GET CONTROL ONLY IF THE BRREADS FAIL WHILE*/
*   /* ACCESSING THE PSA, OR ACCESSING OR FORMATTING THE LCCA        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S1312
*PSAERR5:                                                       03S1312
*   PSABADSW=SWON;                  /* INDICATE PSA UNAVAILABLE      */
PSAERR5  OI    PSABADSW,B'00001000'                             03S1312
*   PSAVIRT='FFFFFFFF'X;            /* INDICATE BRREAD ERROR GETTING
*                                      PSA ADDR FROM PCCA            */
         MVC   PSAVIRT(4),@CF02919                              03S1313
*   GO TO GMSG25;                   /* PRINT ERROR MESSAGE           */
         B     GMSG25                                           03S1314
*GMSG20B:                                                       03S1315
*                                                               03S1315
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE LCCA ADDRESS TO PRINTABLE HEX FOR MESSAGE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S1315
*   RESPECIFY                                                   03S1315
*    (R1,                                                       03S1315
*     R4) RESTRICTED;                                           03S1315
GMSG20B  DS    0H                                               03S1316
*   R1=ADDR(LCCAPTR);               /* ADDR TO CONVERT               */
         LA    R1,LCCAPTR                                       03S1316
*   R4=ADDR(ADDR20);                /* ADDR OF OUTPUT LOCATION FOR
*                                      CVNT RTN                      */
         LA    R4,ADDR20                                        03S1317
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           03S1318
         BALR  @14,@15                                          03S1318
*   RESPECIFY                                                   03S1319
*    (R1,                                                       03S1319
*     R4) UNRESTRICTED;                                         03S1319
*   OUTPUT(2:1+LENGTH(MSG20))=MSG20;/* PRINT ERROR FINDING LCCA MSG  */
         L     @07,CURBUF(,COMBASE)                             03S1320
         MVC   OUTPUT+1(26,@07),MSG20                           03S1320
*   CALL PRNTSKIP;                                              03S1321
         BAL   @14,PRNTSKIP                                     03S1321
*   GO TO RETRYOUT;                 /* IS THERE A PSA TO BE PROCESSED*/
         B     RETRYOUT                                         03S1322
*GMSG22B:                                                       03S1323
*   GEN(BRWRITE 1);                 /* PRINT PARTIALLY FILLED BUFFER */
GMSG22B  BRWRITE 1
*   OUTPUT(2:1+LENGTH(MSG22))=MSG22;/* PRINT ERROR FORMATTING LCCA
*                                      MSG                           */
         L     @07,CURBUF(,COMBASE)                             03S1324
         MVC   OUTPUT+1(27,@07),MSG22                           03S1324
*   CALL PRNTSKIP;                                              03S1325
         BAL   @14,PRNTSKIP                                     03S1325
*RETRYOUT:                                                      03S1326
*   ;                               /* IS THERE A PSA TO BE PROCESSED*/
RETRYOUT DS    0H                                               03S1327
*                                                               02S1327
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE INPUT TYPE                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1327
*   IF QSADMP=SWON THEN             /* IS INPUT SADMP                */
         TM    QSADMP(COMBASE),B'00100000'                      02S1327
         BNO   @RF01327                                         02S1327
*     DO;                           /* YES                           */
*       BRNCHADR=ADDR(LCPUADDR);    /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @07,LCPUADDR                                     02S1329
         ST    @07,BRNCHADR                                     02S1329
*       RESPECIFY                                               02S1330
*         PREG RESTRICTED;                                      02S1330
*       PREG=ADDR(PCCACPUA);        /* ADDR OF PHYS CPU ADDR - IN
*                                      PCCA                          */
         L     PREG,PCCAPTR                                     02S1331
         LA    PREG,PCCACPUA(,PREG)                             02S1331
*       GEN(BRREAD (PREG));                                     02S1332
         BRREAD (PREG)
*       CPUADDR=CPUTMPRY;           /* PHYS CPU ADDR                 */
         LH    @07,CPUTMPRY(,PREG)                              02S1333
         STH   @07,CPUADDR                                      02S1333
*       RESPECIFY                                               02S1334
*         PREG UNRESTRICTED;                                    02S1334
*       CTABLPTR=CTABLPTR+LENGTH(REGENTRY);/* ADDR OF NEXT ENTRY IN
*                                      PHYS CPU ADDR TABLE           */
         AH    CTABLPTR,@CH00107                                02S1335
*       IF CPUADDR='FFFF'X THEN     /* WAS ADDR IN CCA F'S           */
         C     @07,@CF02834                                     02S1336
         BNE   @RF01336                                         02S1336
*         CPUADDR='0050'X;          /* YES - INDICATES ADDR IN CCA
*                                      WAS F'S                       */
         MVC   CPUADDR(2),@CH02927                              02S1337
*       REGENTRY=CPUADDR;           /* PUT THIS CPU ADDR IN TABLE    */
@RF01336 MVC   REGENTRY(2,CTABLPTR),CPUADDR                     02S1338
*       CALL REGPRINT;              /* FORMAT THE STORE STATUS DATA  */
         BAL   @14,REGPRINT                                     02S1339
*     END;                                                      02S1340
*PSAREAD2:                                                      02S1341
*   IF PSABADSW=SWON THEN           /* IS PSA AVAILABLE              */
@RF01327 DS    0H                                               02S1341
PSAREAD2 TM    PSABADSW,B'00001000'                             02S1341
         BNO   @RF01341                                         02S1341
*     DO;                           /* NO                            */
*PSAMSG2:                                                       02S1343
*       PSABADSW=SWOFF;             /* RESET SW FOR NEXT PCCA        */
PSAMSG2  NI    PSABADSW,B'11110111'                             02S1343
*       IF PSAVIRT^=0 THEN          /* IS PSA AVAILABLE              */
         ICM   @07,15,PSAVIRT                                   02S1344
         BZ    @RF01344                                         02S1344
*         OUTPUT(2:1+LENGTH(MSG42))=MSG42;/* YES - PRINT ERROR  02S1345
*                                      FINDING PSA MSG               */
         L     @07,CURBUF(,COMBASE)                             02S1345
         MVC   OUTPUT+1(60,@07),MSG42                           02S1345
*       ELSE                                                    02S1346
*         OUTPUT(2:1+LENGTH(MSG47))=MSG47;/* NO - PRINT PSA ADDR IS 0
*                                      MSG                           */
         B     @RC01344                                         02S1346
@RF01344 L     @07,CURBUF(,COMBASE)                             02S1346
         MVC   OUTPUT+1(54,@07),MSG47                           02S1346
*       CALL PRNTSKIP;                                          02S1347
@RC01344 BAL   @14,PRNTSKIP                                     02S1347
*     END;                                                      02S1348
*   ELSE                                                        02S1349
*     DO;                           /* YES - PSA IS AVAILABLE        */
         B     @RC01341                                         02S1349
@RF01341 DS    0H                                               02S1350
*       IF PSAVIRT//4096=0 THEN     /* IS VIRT PSA ADDR VALID        */
         L     @07,PSAVIRT                                      02S1350
         LR    @00,@07                                          02S1350
         SRDA  @00,32                                           02S1350
         D     @00,@CF02905                                     02S1350
         LTR   @00,@00                                          02S1350
         BNZ   @RF01350                                         02S1350
*         DO;                       /* YES                           */
*           BRNCHADR=ADDR(PSAERR3); /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @15,PSAERR3                                      02S1352
         ST    @15,BRNCHADR                                     02S1352
*           RESPECIFY                                           02S1353
*             PREG RESTRICTED;                                  02S1353
*           PREG=PSAVIRT;           /* VIRT ADDR OF PSA IN DUMP      */
         LR    PREG,@07                                         02S1354
*           GEN(BRREAD (PREG));                                 02S1355
         BRREAD (PREG)
*           STGADPSA=PREG;          /* ADDR OF PSA IN STORAGE - FOR
*                                      FMTPTRNS                      */
         ST    PREG,STGADPSA                                    02S1356
*           PREG=PREG+(ADDR(PSAPSA)-ADDR(PSA));/* DISPLACEMENT IN PSA
*                                      OF EBCDIC NAME 'PSA'          */
         AH    PREG,@CH03000                                    02S1357
*           IF VALIDCK^='PSA ' THEN /* DOES THE PSA VALIDITY CHECK   */
         CLC   VALIDCK(4,PREG),@CC02879                         02S1358
         BE    @RF01358                                         02S1358
*             DO;                   /* NO                            */
*               RESPECIFY                                       02S1360
*                 PREG UNRESTRICTED;                            02S1360
*               OUTPUT(2:1+LENGTH(MSG43))=MSG43;/* PRINT VALIDITY
*                                      CKECK FAILED MSG              */
         L     @07,CURBUF(,COMBASE)                             02S1361
         MVC   OUTPUT+1(25,@07),MSG43                           02S1361
*               CALL PRNTSKIP;                                  02S1362
         BAL   @14,PRNTSKIP                                     02S1362
*             END;                                              02S1363
*           CALL PSAFORMT;          /* FORMAT THIS PSA               */
@RF01358 BAL   @14,PSAFORMT                                     02S1364
*         END;                                                  02S1365
*       ELSE                                                    02S1366
*         DO;                       /* NO - VIRT PSA ADDR IS INVALID */
         B     @RC01350                                         02S1366
@RF01350 DS    0H                                               02S1367
*           OUTPUT(2:1+LENGTH(MSG44))=MSG44;/* PRINT PSA NOT ON 4K
*                                      BNDRY MSG                     */
         L     @07,CURBUF(,COMBASE)                             02S1367
         MVC   OUTPUT+1(56,@07),MSG44                           02S1367
*           CALL PRNTSKIP;                                      02S1368
         BAL   @14,PRNTSKIP                                     02S1368
*         END;                                                  02S1369
*     END;                                                      02S1370
*   RETURN;                         /* RETURN TO CALLER              */
*                                                               02S1371
@EL00008 DS    0H                                               02S1371
@EF00008 DS    0H                                               02S1371
@ER00008 LM    @14,@05,@SA00008                                 02S1371
         LM    @07,@12,@SA00008+32                              02S1371
         BR    @14                                              02S1371
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR RETURN POINT IF BRREAD FAILS FOR THIS PHYSICAL CPU      */
*   /* ADDRESS IN THE PCCA CURRENTLY BEING PROCESSED.                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1372
*                                                               03S1372
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE GETS CONTROL ONLY IF THE BRREAD FAILS FOR THE    */
*   /* PHYSICAL CPU ADDRESS IN THE CURRENT PCCA                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S1372
*LCPUADDR:                                                      03S1372
*   IF LCCAPTR^=0 THEN              /* IS LCCA FOR THIS PSA AVAILABLE*/
LCPUADDR ICM   @15,15,LCCAPTR                                   03S1372
         BZ    @RF01372                                         03S1372
*     DO;                           /* YES                           */
*       PCARTNSW=SWON;              /* INDICATE PCCA AVAILABLE       */
*                                                               03S1374
         OI    PCARTNSW,B'00000100'                             03S1374
*       /*************************************************************/
*       /*                                                           */
*       /* ATTEMPT TO GET LOGICAL CPU ADDRESS FROM LCCA              */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S1375
*       CALL LOGCLCPU;                                          03S1375
         BAL   @14,LOGCLCPU                                     03S1375
*     END;                                                      03S1376
*   ELSE                                                        03S1377
*     DO;                           /* NO - LCCA IS UNAVAILABLE      */
         B     @RC01372                                         03S1377
@RF01372 DS    0H                                               03S1378
*       IF PSABADSW=SWOFF THEN      /* IS PSA FOR PCCA AVAILABLE     */
         TM    PSABADSW,B'00001000'                             03S1378
         BNZ   @RF01378                                         03S1378
*         DO;                       /* YES                           */
*           BRNCHADR=ADDR(GMSG51B); /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @07,GMSG51B                                      03S1380
         ST    @07,BRNCHADR                                     03S1380
*           RESPECIFY                                           03S1381
*             PREG RESTRICTED;                                  03S1381
*           PREG=ADDR(PSACPUSA);    /* GET PHY CPU ADDR      @YM03489*/
         L     PREG,PSAVIRT                                     03S1382
         LA    PREG,PSACPUSA(,PREG)                             03S1382
*           GEN(BRREAD (PREG));                                 03S1383
         BRREAD (PREG)
*           CPUADDR=CPUTMPRY;       /* PHYS CPU ADDR                 */
         LH    @07,CPUTMPRY(,PREG)                              03S1384
         STH   @07,CPUADDR                                      03S1384
*           RESPECIFY                                           03S1385
*             PREG UNRESTRICTED;                                03S1385
*           CTABLPTR=CTABLPTR+LENGTH(REGENTRY);/* ADDR OF NEXT ENTRY
*                                      IN PHYS CPU ADDR TABLE        */
         AH    CTABLPTR,@CH00107                                03S1386
*           IF CPUADDR='FFFF'X THEN /* WAS ADDR IN CCA F'S           */
         C     @07,@CF02834                                     03S1387
         BNE   @RF01387                                         03S1387
*             CPUADDR='0050'X;      /* YES - INDICATES ADDR IN CCA
*                                      WAS F'S                       */
         MVC   CPUADDR(2),@CH02927                              03S1388
*           REGENTRY=CPUADDR;       /* PUT THIS CPU ADDR IN TABLE    */
@RF01387 MVC   REGENTRY(2,CTABLPTR),CPUADDR                     03S1389
*           CALL REGPRINT;          /* FORMAT THE STORE STATUS DATA  */
         BAL   @14,REGPRINT                                     03S1390
*         END;                                                  03S1391
*       ELSE                                                    03S1392
*         DO;                       /* NO - PSA IS UNAVAILABLE       */
         B     @RC01378                                         03S1392
@RF01378 DS    0H                                               03S1393
*GMSG51B:                                                       03S1393
*           OUTPUT(2:1+LENGTH(MSG51))=MSG51;/* PRINT UNABLE TO  03S1393
*                                      DETERMINE CPU ADDR MSG        */
GMSG51B  L     @07,CURBUF(,COMBASE)                             03S1393
         MVC   OUTPUT+1(72,@07),MSG51                           03S1393
*           CALL PRNTSKIP;                                      03S1394
         BAL   @14,PRNTSKIP                                     03S1394
*           GO TO PSAMSG2;          /* PRINT MESSAGE AND GET NEXT
*                                      PCCA                          */
         B     PSAMSG2                                          03S1395
*         END;                                                  03S1396
*     END;                                                      03S1397
*   GO TO PSAREAD2;                 /* ATTEMPT TO FORMAT THE PSA     */
         B     PSAREAD2                                         03S1398
*                                                               02S1399
*   /*****************************************************************/
*   /*                                                               */
*   /* THESE ROUTINES WILL GET CONTROL ONLY IF THE BRREADS FAIL WHILE*/
*   /* GETTING OR FORMATTING THE PCCA.                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1399
*GMSG30C:                                                       02S1399
*                                                               02S1399
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE PCCA ADDRESS TO PRINTABLE HEX FOR MESSAGE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1399
*   RESPECIFY                                                   02S1399
*    (R1,                                                       02S1399
*     R4) RESTRICTED;                                           02S1399
GMSG30C  DS    0H                                               02S1400
*   R1=ADDR(PCCAPTR);               /* ADDR TO CONVERT               */
         LA    R1,PCCAPTR                                       02S1400
*   R4=ADDR(ADDR30);                /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR30                                        02S1401
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           02S1402
         BALR  @14,@15                                          02S1402
*   RESPECIFY                                                   02S1403
*    (R1,                                                       02S1403
*     R4) UNRESTRICTED;                                         02S1403
*   OUTPUT(2:1+LENGTH(MSG30))=MSG30;/* PRINT ERROR FINDING PCCA MSG  */
         L     @07,CURBUF(,COMBASE)                             02S1404
         MVC   OUTPUT+1(26,@07),MSG30                           02S1404
*   CALL PRNTSKIP;                                              02S1405
         BAL   @14,PRNTSKIP                                     02S1405
*   GO TO LCARETRY;                 /* GET LCCA FOR THIS PCCA        */
         B     LCARETRY                                         02S1406
*GMSG32B:                                                       02S1407
*   GEN(BRWRITE 1);                 /* PRINT PARTIALLY FILLED BUFFER */
GMSG32B  BRWRITE 1
*   OUTPUT(2:1+LENGTH(MSG32))=MSG32;/* PRINT ERROR FORMATTING PCCA
*                                      MSG                           */
         L     @07,CURBUF(,COMBASE)                             02S1408
         MVC   OUTPUT+1(27,@07),MSG32                           02S1408
*   CALL PRNTSKIP;                                              02S1409
         BAL   @14,PRNTSKIP                                     02S1409
*   GO TO LCARETRY;                 /* GET LCCA FOR THIS PCCA        */
         B     LCARETRY                                         02S1410
*PSAERR3:                                                       02S1411
*                                                               02S1411
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE PCCA ADDRESS TO PRINTABLE HEX FOR MESSAGE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1411
*   RESPECIFY                                                   02S1411
*    (R1,                                                       02S1411
*     R4) RESTRICTED;                                           02S1411
PSAERR3  DS    0H                                               02S1412
*   R1=ADDR(PCCAPTR);               /* ADDR TO CONVERT               */
         LA    R1,PCCAPTR                                       02S1412
*   R4=ADDR(ADDR40);                /* ADDR OF OUTPUT LOCATION FOR
*                                      CNVT RTN                      */
         LA    R4,ADDR40                                        02S1413
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */
         L     @15,AADRCNVT(,COMBASE)                           02S1414
         BALR  @14,@15                                          02S1414
*   RESPECIFY                                                   02S1415
*    (R1,                                                       02S1415
*     R4) UNRESTRICTED;                                         02S1415
*   OUTPUT(2:1+LENGTH(MSG40))=MSG40;/* PRINT ERROR FINDING PSA MSG   */
         L     @07,CURBUF(,COMBASE)                             02S1416
         MVC   OUTPUT+1(61,@07),MSG40                           02S1416
*   CALL PRNTSKIP;                                              02S1417
         BAL   @14,PRNTSKIP                                     02S1417
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00008                                         02S1418
*   END PCAFIRST;                                               02S1419
         B     @EL00008                                         02S1419
*CSTAUSPT:                                                      02S1420
*   PROC;                                                       02S1420
*                                                               02S1420
CSTAUSPT STM   @14,@05,@SA00009                                 02S1420
         STM   @07,@12,@SA00009+32                              02S1420
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CVT IS UNAVAILABLE OR THE CCAVTS ARE UNAVAILABLE THE   */
*   /* PHYSICAL CPU ADDRESS TABLE IS NOT SEARCHED, BUT A LOOP IS     */
*   /* EXECUTED ATTEMPTING TO READ AND FORMAT ANY STORE-STATUS DATA  */
*   /* THAT MIGHT EXIST. IF THE CVT IS AVAILABLE THE TABLE IS        */
*   /* SEARCHED AND AN ATTEMPT IS MADE TO READ AND FORMAT THE        */
*   /* STORE-STATUS DATA FOR EACH CPU ADDRESS NOT IN THE TABLE.      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1421
*   STATUSW=SWON;                   /* INDICATE PROCESSING CPU ADDRS
*                                      FROM TABLE                    */
         OI    STATUSW,B'00010000'                              02S1421
*   IF LCASW^=SWON&PCASW^=SWON THEN /* IS CPU ADDR TABLE BEING USED  */
         TM    LCASW,B'01100000'                                02S1422
         BNZ   @RF01422                                         02S1422
*     DO;                           /* YES                           */
*       DO CPUADRCK=0 TO POSIBLAD;  /* ADDR TO COMPARE AGAINST TABLE
*                                      ENTRIES                       */
         SLR   CPUADRCK,CPUADRCK                                02S1424
@DL01424 DS    0H                                               02S1425
*         CTABLPTR=LTABLPTR+(2*CCAVSIZE);/* ADDR OF BEGINNING OF
*                                      TABLE                         */
         LA    CTABLPTR,128                                     02S1425
         ALR   CTABLPTR,LTABLPTR                                02S1425
*         DO K=0 TO NUMBCPUS;       /* SEARCH THE TABLE TO DETERMINE
*                                      WHICH ADDRS ARE MISSING       */
         SLR   K,K                                              02S1426
@DL01426 DS    0H                                               02S1427
*           IF CPUADRCK^=REGENTRY THEN/* IS THIS ADDR IN TABLE       */
         SLR   @15,@15                                          02S1427
         ICM   @15,3,REGENTRY(CTABLPTR)                         02S1427
         CR    CPUADRCK,@15                                     02S1427
         BE    @RF01427                                         02S1427
*             DO;                   /* NO                            */
*               IF REGENTRY='FFFF'X THEN/* IS THIS THE END OF TABLE  */
         C     @15,@CF02834                                     02S1429
         BE    @RT01429                                         02S1429
*                 GO TO GOFORMAT;   /* YES - FORMAT THE STATUS DATA
*                                      FOR THIS CPU                  */
*               ELSE                /* NO - INCREMENT POINTER TO NEXT
*                                      ENTRY                         */
*                 CTABLPTR=CTABLPTR+LENGTH(REGENTRY);/* UPDATE PTR TO
*                                      REFERENCE NEXT ENTRY          */
         AH    CTABLPTR,@CH00107                                02S1431
*             END;                                              02S1432
*           ELSE                                                02S1433
*             GO TO NEXTVALU;       /* UPDATE COMPARE ADDR           */
*         END;                                                  02S1434
         AH    K,@CH00050                                       02S1434
         CH    K,@CH00043                                       02S1434
         BNH   @DL01426                                         02S1434
*GOFORMAT:                                                      02S1435
*         CPUADDR=CPUADRCK;         /* CPU ADDR FOR BRREAD           */
GOFORMAT STH   CPUADRCK,CPUADDR                                 02S1435
*         GEN(BRWRITE SKIP);        /* SKIP TO THE NEXT PAGE         */
         BRWRITE SKIP
*         CALL REGPRINT;            /* PRINT THE STORE STATUS DATA   */
         BAL   @14,REGPRINT                                     02S1437
*NEXTVALU:                                                      02S1438
*       END;                                                    02S1438
NEXTVALU AH    CPUADRCK,@CH00050                                02S1438
         CH    CPUADRCK,@CH01648                                02S1438
         BNH   @DL01424                                         02S1438
*     END;                                                      02S1439
*   ELSE                                                        02S1440
*     DO;                           /* NO - CPU ADDR TABLE IS NOT
*                                      BEING USED                    */
         B     @RC01422                                         02S1440
@RF01422 DS    0H                                               02S1441
*       CPUADRCK=CPUADDR;           /* CPU ADDR OF REGS ALREADY 02S1441
*                                      FORMATTED                     */
         SLR   CPUADRCK,CPUADRCK                                02S1441
         ICM   CPUADRCK,3,CPUADDR                               02S1441
*       DO CPUADDR=0 TO POSIBLAD;   /* COMPARE THIS ADDR TO THE ONE
*                                      FOR THE REGS ALREADY PRINTED  */
         SLR   @03,@03                                          02S1442
         STH   @03,CPUADDR                                      02S1442
@DL01442 DS    0H                                               02S1443
*         IF CPUADDR^=CPUADRCK THEN /* HAS DATA FOR THIS ADDR BEEN
*                                      PROCESSED                     */
         CR    @03,CPUADRCK                                     02S1443
         BE    @RF01443                                         02S1443
*           DO;                     /* NO                            */
*             GEN(BRWRITE SKIP);    /* SKIP TO THE NEXT PAGE         */
         BRWRITE SKIP
*             CALL REGPRINT;        /* ATTEMPT TO FORMAT THE DATA    */
         BAL   @14,REGPRINT                                     02S1446
*           END;                                                02S1447
*       END;                                                    02S1448
@RF01443 LA    @03,1                                            02S1448
         SLR   @15,@15                                          02S1448
         ICM   @15,3,CPUADDR                                    02S1448
         ALR   @03,@15                                          02S1448
         STH   @03,CPUADDR                                      02S1448
         CH    @03,@CH01648                                     02S1448
         BNH   @DL01442                                         02S1448
*     END;                                                      02S1449
*   RETURN;                                                     02S1450
@EL00009 DS    0H                                               02S1450
@EF00009 DS    0H                                               02S1450
@ER00009 LM    @14,@05,@SA00009                                 02S1450
         LM    @07,@12,@SA00009+32                              02S1450
         BR    @14                                              02S1450
*   END CSTAUSPT;                                               02S1451
         B     @EL00009                                         02S1451
*REGPRINT:                                                      02S1452
*   PROC;                                                       02S1452
*                                                               02S1452
REGPRINT STM   @14,@12,@SA00010                                 02S1452
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE CONVERTS THE PHYSICAL CPU ADDRESS TO PRINTABLE   */
*   /* HEX, PRINTS A HEADER, AND FORMATS THE STORE-STATUS DATA. IF   */
*   /* THE PHYSICAL CPU ADDRESS IS GREATER THAN 63 IT IS INVALID AND */
*   /* CONTROL IS IMMEDIATELY RE TURNED TO THE CALLER. OTHERWISE A   */
*   /* BRREAD IS DONE FOR THAT STATUS RECORD .                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1453
*   IF CPUADDR1<0CPUADDR>=64 THEN  /* IS THIS A VALID CPU ADDR      */
         ICM   @15,3,CPUADDR1                                   02S1453
         BM    @RT01453                                         02S1453
         CLC   CPUADDR(2),@CH00753                              02S1453
         BL    @RF01453                                         02S1453
@RT01453 DS    0H                                               02S1454
*     DO;                           /* NO                            */
*       OUTPUT(2:1+LENGTH(MSG56))=MSG56;/* PRINT INVALID CPU ADDR MSG*/
         L     @01,CURBUF(,COMBASE)                             02S1455
         MVC   OUTPUT+1(60,@01),MSG56                           02S1455
*       CALL PRNTSKIP;                                          02S1456
         BAL   @14,PRNTSKIP                                     02S1456
*       RETURN;                     /* RETURN TO CALLER              */
@EL00010 DS    0H                                               02S1457
@EF00010 DS    0H                                               02S1457
@ER00010 LM    @14,@12,@SA00010                                 02S1457
         BR    @14                                              02S1457
*     END;                                                      02S1458
*                                                               02S1458
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CPU ADDRESS IS VALID - ATTEMPT TO PROCESS THE STATUS      */
*   /* RECORDS                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1459
*   FPREGS=SWOFF;                   /* RESET TO ALLOW PROCESSING OF
*                                      GPRS AND CTRS FIRST           */
@RF01453 NI    FPREGS,B'11011111'                               02S1459
*   BRNCHADR=ADDR(IOERRCK);         /* ERROR RETURN POINT FOR THIS
*                                      BRREAD                        */
         LA    @03,IOERRCK                                      02S1460
         ST    @03,BRNCHADR                                     02S1460
*   RESPECIFY                                                   02S1461
*     PREG RESTRICTED;                                          02S1461
*   PREG=CPUADDR;                   /* PHYS CPU ADDR FOR BRREAD      */
         SLR   PREG,PREG                                        02S1462
         ICM   PREG,3,CPUADDR                                   02S1462
*   GEN(BRREAD (PREG),CPU);                                     02S1463
         BRREAD (PREG),CPU
*   STATSPTR=PREG;                  /* ADDR OF BEGINNING OF STATUS
*                                      RECORDS                       */
         LR    STATSPTR,PREG                                    02S1464
*   RESPECIFY                                                   02S1465
*     PREG UNRESTRICTED;                                        02S1465
*                                                               02S1465
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE PHYSICAL CPU ADDRESS TO PRINTABLE HEX AND PRINT   */
*   /* HEADER                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1466
*   UNPAKADR=CPUADDR;               /* PHYS CPU ADDR TO BE CONVERTED */
         MVC   UNPAKADR(2),CPUADDR                              02S1466
*   UNPK(UNPAKTO,UNPAKFRM);         /* UNPACK ADDR                   */
         UNPK  UNPAKTO(5),UNPAKFRM(3)                           02S1467
*   TR(TRANSTO,EBCTABL);            /* TRANS TO PRINTABLE HEX        */
         TR    TRANSTO(4),EBCTABL(COMBASE)                      02S1468
*   CNVTCPU=TRANSTO;                /* PUT IN TITLE                  */
         MVC   CNVTCPU(4),TRANSTO                               02S1469
*   OUTPUT(41:40+LENGTH(REGTITL2))=REGTITL2;/* PRINT HEADER          */
         L     @03,CURBUF(,COMBASE)                             02S1470
         MVC   OUTPUT+40(42,@03),REGTITL2                       02S1470
*   CALL PRNTSKIP;                                              02S1471
*                                                               02S1471
         BAL   @14,PRNTSKIP                                     02S1471
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF STATUS IN 4K IS VALID                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1472
*   IF INVALID=SWON THEN            /* IS DATA INVALID               */
         TM    INVALID(STATSPTR),B'01000000'                    02S1472
         BNO   @RF01472                                         02S1472
*     DO;                           /* YES                           */
*       IF GPREGS=SWON THEN         /* IS THIS THE IPL'D CPU         */
         TM    GPREGS(STATSPTR),B'00100000'                     02S1474
         BNO   @RF01474                                         02S1474
*         DO;                       /* YES - ONLY GEN PURPOSE REGS
*                                      ARE VALID                     */
*           OUTPUT(2:1+LENGTH(MSG54))=MSG54;/* PRINT ONLY GPRS ARE
*                                      VALID MSG                     */
         L     @03,CURBUF(,COMBASE)                             02S1476
         MVC   OUTPUT+1(40,@03),MSG54                           02S1476
*           CALL PRNTSKIP;                                      02S1477
         BAL   @14,PRNTSKIP                                     02S1477
*           REGSW=SWOFF;            /* INDICATE GPRS ARE TO BE  02S1478
*                                      FORMATTED                     */
         NI    REGSW,B'10111111'                                02S1478
*           CALL REGFOMAT;          /* ATTEMPT TO FORMAT THE GPRS    */
         BAL   @14,REGFOMAT                                     02S1479
*           CALL PRNTSKIP;          /* SKIP TWO LINES                */
         BAL   @14,PRNTSKIP                                     02S1480
*         END;                                                  02S1481
*       ELSE                                                    02S1482
*         DO;                       /* NO - THIS ISN'T THE IPL'D CPU */
         B     @RC01474                                         02S1482
@RF01474 DS    0H                                               02S1483
*           OUTPUT(2:1+LENGTH(MSG53))=MSG53;/* PRINT STATUS DATA MAY
*                                      BE INVALID MSG                */
         L     @03,CURBUF(,COMBASE)                             02S1483
         MVC   OUTPUT+1(32,@03),MSG53                           02S1483
*           CALL PRNTSKIP;                                      02S1484
         BAL   @14,PRNTSKIP                                     02S1484
*           GO TO FOMATALL;                                     02S1485
         B     FOMATALL                                         02S1485
*         END;                                                  02S1486
*     END;                                                      02S1487
*   ELSE                                                        02S1488
*     DO;                           /* NO - STATUS DATA IS VALID     */
         B     @RC01472                                         02S1488
@RF01472 DS    0H                                               02S1489
*FOMATALL:                                                      02S1489
*       CALL PSWFOMAT;              /* FORMAT THE PSW                */
FOMATALL BAL   @14,PSWFOMAT                                     02S1489
*       REGSW=SWOFF;                /* INDICATE GPRS ARE TO BE  02S1490
*                                      FORMATTED                     */
         NI    REGSW,B'10111111'                                02S1490
*       CALL REGFOMAT;              /* FORMAT THE GPRS               */
         BAL   @14,REGFOMAT                                     02S1491
*       REGSW=SWON;                 /* INDICATE CTRS ARE TO BE  02S1492
*                                      FORMATTED                     */
         OI    REGSW,B'01000000'                                02S1492
*       CALL REGFOMAT;              /* FORMAT THE CTRS               */
         BAL   @14,REGFOMAT                                     02S1493
*       FPREGS=SWON;                /* INDICATE TO FORMAT FP REGS    */
         OI    FPREGS,B'00100000'                               02S1494
*       CALL REGFOMAT;              /* FORMAT THE FPREGS             */
         BAL   @14,REGFOMAT                                     02S1495
*                                                               03S1496
*       /*************************************************************/
*       /*                                                           */
*       /* THIS ROUTINE WILL FORMAT THE FOLLOWING FIELDS FROM THE    */
*       /* LOGOUT AREA OF A STORE-STATUS: CPU TIMER, CLOCK           */
*       /* COMPARATOR, AND PREFIX VALUE.                             */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S1496
*       RESPECIFY                                               03S1496
*         R1 RESTRICTED;                                        03S1496
*       STAT8=ADDR(STATIMER);       /* ADDR OF CPU TIMER IN STORAGE  */
         LA    @03,STATIMER(,STATSPTR)                          03S1497
         ST    @03,STAT8                                        03S1497
*       R1=ADDR(PSTATL8);           /* ADDR OF PATTERN FOR THIS LINE */
         LA    R1,PSTATL8                                       03S1498
*       CALL AMDPRGFR;              /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           03S1499
         BALR  @14,@15                                          03S1499
*       GEN SETS(R1,R14,R15)(BRWRITE 1);                        03S1500
         BRWRITE 1
*       STAT9=ADDR(STATCKCP);       /* ADDR OF CLOCK COMPARATOR IN
*                                      STORAGE                       */
         LA    @03,STATCKCP(,STATSPTR)                          03S1501
         ST    @03,STAT9                                        03S1501
*       R1=ADDR(PSTATL9);           /* ADDR OF PATTERN FOR THIS LINE */
         LA    R1,PSTATL9                                       03S1502
*       CALL AMDPRGFR;              /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           03S1503
         BALR  @14,@15                                          03S1503
*       GEN SETS(R1,R14,R15)(BRWRITE 1);                        03S1504
         BRWRITE 1
*       STAT10=ADDR(STATPRFX);      /* ADDR OF PREFIX VALUE IN  03S1505
*                                      STORAGE                       */
         LA    @03,STATPRFX(,STATSPTR)                          03S1505
         ST    @03,STAT10                                       03S1505
*       R1=ADDR(PSTATL10);          /* ADDR OF PATTERN FOR THIS LINE */
         LA    R1,PSTATL10                                      03S1506
*       CALL AMDPRGFR;              /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           03S1507
         BALR  @14,@15                                          03S1507
*       GEN SETS(R1,R14,R15)(BRWRITE 1);                        03S1508
         BRWRITE 1
*       RESPECIFY                                               03S1509
*         R1 UNRESTRICTED;                                      03S1509
*       IF STATUSW=SWOFF THEN       /* CAN ANYTHING ELSE BE PRINTED
*                                      ON THIS PAGE                  */
         TM    STATUSW,B'00010000'                              02S1510
         BNZ   @RF01510                                         02S1510
*         CALL PRNTSKIP;            /* YES - SKIP TWO LINES          */
         BAL   @14,PRNTSKIP                                     02S1511
*     END;                                                      02S1512
*   RETURN;                         /* RETURN TO CALLER              */
*                                                               02S1513
         B     @EL00010                                         02S1513
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE WILL GET CONTROL ONLY IF THE BRREAD     */
*   /* FAILS FOR THE 'CPU' RECORD                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1514
*IOERRCK:                                                       02S1514
*   IF IOERR=SWOFF THEN             /* DID AN I/O ERROR OCCURR       */
IOERRCK  TM    IOERR(COMBASE),B'10000000'                       02S1514
         BNZ   @RF01514                                         02S1514
*     DO;                           /* NO                            */
*       IF STATUSW=SWON THEN        /* SHOULD ERROR MSG BE PRINTED   */
         TM    STATUSW,B'00010000'                              02S1516
         BO    @RT01516                                         02S1516
*         RETURN;                   /* NO - REUTRN TO CALLER         */
*     END;                                                      02S1518
*                                                               02S1518
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE PHYSICAL CPU ADDRESS TO PRINTABLE HEX AND PRINT   */
*   /* HEADER                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1519
*   UNPAKADR=CPUADDR;               /* PHYS CPU ADDR TO BE CONVERTED */
@RF01514 MVC   UNPAKADR(2),CPUADDR                              02S1519
*   UNPK(UNPAKTO,UNPAKFRM);         /* UNPACK ADDR                   */
         UNPK  UNPAKTO(5),UNPAKFRM(3)                           02S1520
*   TR(TRANSTO,EBCTABL);            /* TRANS TO PRINTABLE HEX        */
         TR    TRANSTO(4),EBCTABL(COMBASE)                      02S1521
*   CNVTCPU=TRANSTO;                /* PUT IN TITLE                  */
         MVC   CNVTCPU(4),TRANSTO                               02S1522
*   ADDR52=TRANSTO;                 /* PUT IN MSG                    */
         MVC   ADDR52(4),TRANSTO                                02S1523
*   OUTPUT(41:40+LENGTH(REGTITL2))=REGTITL2;/* PRINT HEADER          */
         L     @01,CURBUF(,COMBASE)                             02S1524
         MVC   OUTPUT+40(42,@01),REGTITL2                       02S1524
*   CALL PRNTSKIP;                                              02S1525
         BAL   @14,PRNTSKIP                                     02S1525
*   OUTPUT(2:1+LENGTH(MSG52))=MSG52;/* PRINT UNABLE TO FORMAT STATUS
*                                      MSG                           */
         L     @01,CURBUF(,COMBASE)                             02S1526
         MVC   OUTPUT+1(47,@01),MSG52                           02S1526
*   CALL PRNTSKIP;                                              02S1527
         BAL   @14,PRNTSKIP                                     02S1527
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00010                                         02S1528
*   END REGPRINT;                                               02S1529
         B     @EL00010                                         02S1529
*PSWFOMAT:                                                      02S1530
*   PROC;                                                       02S1530
*                                                               02S1530
PSWFOMAT STM   @14,@12,@SA00011                                 02S1530
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL FORMAT THE PSW FOR BOTH SADMPS AND DSS OR   */
*   /* SVCDUMP                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1531
*   RESPECIFY                                                   02S1531
*     R1 RESTRICTED;                                            02S1531
*   STAT1=ADDR(STATPSW);            /* ADDR OF PSW IN STORAGE        */
         LA    @03,STATPSW(,STATSPTR)                           02S1532
         ST    @03,STAT1                                        02S1532
*   R1=ADDR(PSTATL1);               /* ADDR OF PATTERN FOR THIS LINE */
         LA    R1,PSTATL1                                       02S1533
*   CALL AMDPRGFR;                  /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S1534
         BALR  @14,@15                                          02S1534
*   CALL PRNTSKIP;                  /* PRINT THE LINE AND SKIP A LINE*/
         BAL   @14,PRNTSKIP                                     02S1535
*   RESPECIFY                                                   02S1536
*     R1 UNRESTRICTED;                                          02S1536
*   RETURN;                         /* RETURN TO CALLER              */
@EL00011 DS    0H                                               02S1537
@EF00011 DS    0H                                               02S1537
@ER00011 LM    @14,@12,@SA00011                                 02S1537
         BR    @14                                              02S1537
*   END PSWFOMAT;                                               02S1538
*REGFOMAT:                                                      02S1539
*   PROC;                                                       02S1539
*                                                               02S1539
REGFOMAT STM   @14,@12,@SA00012                                 02S1539
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL FORMAT THE GENERAL PURPOSE, CONTROL, AND    */
*   /* FLOATING POINT REGISTERS                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1540
*   RESPECIFY                                                   02S1540
*     R1 RESTRICTED;                                            02S1540
*   IF FPREGS=SWOFF THEN            /* ARE FP REGS REQUESTED         */
         TM    FPREGS,B'00100000'                               02S1541
         BNZ   @RF01541                                         02S1541
*     DO;                           /* NO                            */
*       IF REGSW=SWOFF THEN         /* ARE GP REGS REQUESTED         */
         TM    REGSW,B'01000000'                                02S1543
         BNZ   @RF01543                                         02S1543
*         DO;                       /* YES                           */
*           STAT2=ADDR(GENRLREG);   /* ADDR OF GP REGS IN STORAGE    */
         LA    @03,GENRLREG(,STATSPTR)                          02S1545
         ST    @03,STAT2                                        02S1545
*           R1=ADDR(PSTATL2);       /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R1,PSTATL2                                       02S1546
*           CALL AMDPRGFR;          /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S1547
         BALR  @14,@15                                          02S1547
*           GEN SETS(R1,R14,R15)(BRWRITE 1);                    02S1548
         BRWRITE 1
*           R1=ADDR(PSTATL3);       /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R1,PSTATL3                                       02S1549
*           CALL AMDPRGFR;          /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S1550
         BALR  @14,@15                                          02S1550
*           CALL PRNTSKIP;          /* PRINT THE LINE AND SKIP A LINE*/
         BAL   @14,PRNTSKIP                                     02S1551
*         END;                                                  02S1552
*       ELSE                                                    02S1553
*         DO;                       /* NO - CT REGS ARE REQUESTED    */
         B     @RC01543                                         02S1553
@RF01543 DS    0H                                               02S1554
*           STAT4=ADDR(CNTRLREG);   /* ADDR OF CT REGS IN STORAGE    */
         LA    @03,CNTRLREG(,STATSPTR)                          02S1554
         ST    @03,STAT4                                        02S1554
*           R1=ADDR(PSTATL4);       /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R1,PSTATL4                                       02S1555
*           CALL AMDPRGFR;          /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S1556
         BALR  @14,@15                                          02S1556
*           GEN SETS(R1,R14,R15)(BRWRITE 1);                    02S1557
         BRWRITE 1
*           R1=ADDR(PSTATL5);       /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R1,PSTATL5                                       02S1558
*           CALL AMDPRGFR;          /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S1559
         BALR  @14,@15                                          02S1559
*           CALL PRNTSKIP;          /* PRINT THE LINE AND SKIP A LINE*/
         BAL   @14,PRNTSKIP                                     02S1560
*         END;                                                  02S1561
*     END;                                                      02S1562
*   ELSE                                                        02S1563
*     DO;                           /* YES - FP REGS ARE REQUESTED   */
         B     @RC01541                                         02S1563
@RF01541 DS    0H                                               02S1564
*       STAT6=ADDR(FLOATREG);       /* ADDR OF FP REGS IN STORAGE    */
         LA    @03,FLOATREG(,STATSPTR)                          02S1564
         ST    @03,STAT6                                        02S1564
*       R1=ADDR(PSTATL6);           /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R1,PSTATL6                                       02S1565
*       CALL AMDPRGFR;              /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S1566
         BALR  @14,@15                                          02S1566
*       GEN SETS(R1,R14,R15)(BRWRITE 1);                        02S1567
         BRWRITE 1
*       R1=ADDR(PSTATL7);           /* ADDR OF PATTERNS FOR THIS LINE*/
         LA    R1,PSTATL7                                       02S1568
*       CALL AMDPRGFR;              /* FORMAT THE LINE               */
         L     @15,AFMTLINE(,COMBASE)                           02S1569
         BALR  @14,@15                                          02S1569
*       CALL PRNTSKIP;              /* PRINT THE LINE AND SKIP A LINE*/
         BAL   @14,PRNTSKIP                                     02S1570
*     END;                                                      02S1571
*   RESPECIFY                                                   02S1572
*     R1 UNRESTRICTED;                                          02S1572
*   RETURN;                         /* RETURN TO CALLER              */
@EL00012 DS    0H                                               02S1573
@EF00012 DS    0H                                               02S1573
@ER00012 LM    @14,@12,@SA00012                                 02S1573
         BR    @14                                              02S1573
*   END REGFOMAT;                                               02S1574
         B     @EL00012                                         02S1574
*PRNTSKIP:                                                      02S1575
*   PROC;                                                       02S1575
*                                                               02S1575
PRNTSKIP STM   @14,@12,@SA00013                                 02S1575
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL PRINT TWO LINES AND RETURN TO CALLER        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1576
*   GEN(BRWRITE 2);                 /* PRINT A LINE AND SKIP A LINE  */
         BRWRITE 2
*   RETURN;                         /* RETURN TO CALLER              */
@EL00013 DS    0H                                               02S1577
@EF00013 DS    0H                                               02S1577
@ER00013 LM    @14,@12,@SA00013                                 02S1577
         BR    @14                                              02S1577
*   END PRNTSKIP;                                               02S1578
*   END AMDPRGCD                                                01S1579
*                                                               01S1579
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHACSD  )                                       */
*/*%INCLUDE SYSLIB  (IHALCCA )                                       */
*/*%INCLUDE SYSLIB  (IHAPCCA )                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (COMMON  )                                       */
*/*%INCLUDE SYSLIB  (AMDPCBPL)                                       */
*/*%INCLUDE SYSUT5  (DECLARES)                                       */
*/*%INCLUDE SYSUT5  (FOMATDCL)                                       */
*/*%INCLUDE SYSUT5  (INIT    )                                       */
*/*%INCLUDE SYSUT5  (MINPROC )                                       */
*/*%INCLUDE SYSUT5  (CSDSEGMT)                                       */
*/*%INCLUDE SYSUT5  (GETABLES)                                       */
*/*%INCLUDE SYSUT5  (FORMTCSD)                                       */
*/*%INCLUDE SYSUT5  (LCAVTSEG)                                       */
*/*%INCLUDE SYSUT5  (PCAVTSEG)                                       */
*/*%INCLUDE SYSUT5  (LCCARTN )                                       */
*/*%INCLUDE SYSUT5  (LCVTSRCH)                                       */
*/*%INCLUDE SYSUT5  (PCCARTN )                                       */
*/*%INCLUDE SYSUT5  (PCVTSRCH)                                       */
*/*%INCLUDE SYSUT5  (SADMPIN )                                       */
*/*%INCLUDE SYSUT5  (DSSVCDMP)                                       */
*/*%INCLUDE SYSUT5  (PSAFMTV0)                                       */
*/*%INCLUDE SYSUT5  (NXTGROUP)                                       */
*/*%INCLUDE SYSUT5  (NEXTLCCA)                                       */
*/*%INCLUDE SYSUT5  (PCCAVAIL)                                       */
*/*%INCLUDE SYSUT5  (PCABEGIN)                                       */
*/*%INCLUDE SYSUT5  (WRAPUP  )                                       */
*/*%INCLUDE SYSUT5  (BNDRYCK )                                       */
*/*%INCLUDE SYSUT5  (GCDEXIT )                                       */
*/*%INCLUDE SYSUT5  (GCDSTOP )                                       */
*/*%INCLUDE SYSUT5  (GCDERRTN)                                       */
*/*%INCLUDE SYSUT5  (CCAVTABL)                                       */
*/*%INCLUDE SYSUT5  (PSAFORMT)                                       */
*/*%INCLUDE SYSUT5  (SAVCPUAD)                                       */
*/*%INCLUDE SYSUT5  (PSAREAD1)                                       */
*/*%INCLUDE SYSUT5  (PCAMATCH)                                       */
*/*%INCLUDE SYSUT5  (NEXTPCCA)                                       */
*/*%INCLUDE SYSUT5  (LOGCLCPU)                                       */
*/*%INCLUDE SYSUT5  (PCAFIRST)                                       */
*/*%INCLUDE SYSUT5  (LCARETRY)                                       */
*/*%INCLUDE SYSUT5  (LCPUADDR)                                       */
*/*%INCLUDE SYSUT5  (CSTAUSPT)                                       */
*/*%INCLUDE SYSUT5  (REGPRINT)                                       */
*/*%INCLUDE SYSUT5  (TIMERETC)                                       */
*/*%INCLUDE SYSUT5  (PSWFOMAT)                                       */
*/*%INCLUDE SYSUT5  (REGFOMAT)                                       */
*/*%INCLUDE SYSUT5  (PRNTSKIP)                                       */
*                                                               01S1579
*       ;                                                       01S1579
@DATA    DS    0H
@CH00050 DC    H'1'
@CH00107 DC    H'2'
@CH00039 DC    H'4'
@CH00033 DC    H'10'
@CH00043 DC    H'15'
@CH00041 DC    H'16'
@CH01967 DC    H'25'
@CH01928 DC    H'37'
@CH00234 DC    H'48'
@CH02093 DC    H'60'
@CH01648 DC    H'63'
@CH00753 DC    H'64'
@CH03000 DC    H'512'
@CH02923 DC    H'608'
@CH02860 DC    XL2'0040'
@CH02927 DC    XL2'0050'
@CH01767 DC    XL2'40'
         DS    0F
@SA00001 DS    18F
@SA00013 DS    15F
@SA00002 DS    15F
@SA00007 DS    14F
@SA00010 DS    15F
@SA00011 DS    15F
@SA00012 DS    15F
@SA00009 DS    14F
@SA00003 DS    15F
@SA00006 DS    13F
@SA00004 DS    14F
@SA00005 DS    15F
@SA00008 DS    14F
         DS    0F
@CF02905 DC    F'4096'
@CF02884 DC    XL4'00FFFFFF'
@CF02919 DC    XL4'FFFFFFFF'
@CF02883 DC    XL4'FFFFFF'
@CF02834 DC    XL4'FFFF'
@CH02834 EQU   @CF02834+2
         DS    0D
PSAVIRT  DS    A
CVTPTR   DS    A
DSSPSAVT DS    AL4
         ORG   DSSPSAVT
@NM00085 DS    AL1
VIRTADDR DS    AL3
         ORG   DSSPSAVT+4
GCDERSAV DC    A(0)
STPERSAV DC    A(0)
BRNCHADR DC    A(0)
PTABLPTR DS    A
CCAVTPTR DS    A
CPUADDR  DS    H
J        DS    AL1
@CC02813 DC    C'CSD '
@CC02838 DC    C'LCCA'
@CC02856 DC    C'PCCA'
@CC02879 DC    C'PSA '
         DS    CL1
PCBPL    DS    CL12
         ORG   PCBPL
PCBPBGN  DS    AL4
PCBPEND  DS    AL4
PCBPASID DS    BL2
PCBPFLG1 DS    CL1
         ORG   PCBPFLG1
PCBPVIRT DS    BL1
PCBPREAL EQU   PCBPFLG1+0
PCBPLOWC EQU   PCBPFLG1+0
PCBPTOPC EQU   PCBPFLG1+0
@NM00083 EQU   PCBPFLG1+0
         ORG   PCBPL+11
PCBPFLG2 DS    CL1
         ORG   PCBPFLG2
PCBPFUNC DS    BL1
@NM00084 EQU   PCBPFLG2+0
         ORG   PCBPL+12
UNPAKFRM DS    CL3
         ORG   UNPAKFRM
UNPAKADR DS    CL2
@NM00094 DS    CL1
         ORG   UNPAKFRM+3
UNPAKTO  DS    CL5
         ORG   UNPAKTO
TRANSTO  DS    CL4
@NM00095 DS    CL1
         ORG   UNPAKTO+5
GCDSWS   DS    BL1
         ORG   GCDSWS
GCDSTPSW DS    BL1
LCASW    EQU   GCDSWS+0
PCASW    EQU   GCDSWS+0
PCAGOSW  EQU   GCDSWS+0
PSABADSW EQU   GCDSWS+0
PCARTNSW EQU   GCDSWS+0
NOPCCA   EQU   GCDSWS+0
GETCPUAD EQU   GCDSWS+0
         ORG   GCDSWS+1
SUBRTNSW DS    BL1
         ORG   SUBRTNSW
CCAVTSW  DS    BL1
REGSW    EQU   SUBRTNSW+0
FPREGS   EQU   SUBRTNSW+0
STATUSW  EQU   SUBRTNSW+0
@NM00096 EQU   SUBRTNSW+0
         ORG   SUBRTNSW+1
GCDTITLE DC    CL32'* * * *  C P U  D A T A  * * * *'
REGTITL1 DC    CL21'***** PSW - REGISTERS'
REGTITL2 DS    CL42
         ORG   REGTITL2
@NM00097 DC    CL24'***** STORE-STATUS DATA '
CPUHDR   DS    CL18
         ORG   CPUHDR
@NM00098 DC    CL8'FOR CPU '
CNVTCPU  DS    CL4
@NM00099 DC    CL6' *****'
         ORG   REGTITL2+42
UNPRHDR  DC    CL35'***** UNPREFIXED 0-4K STORAGE *****'
MSG01    DC    CL58'UNABLE TO ACCESS CVT, MINIMUM FORMATTING WILL BE ATC
               TEMPTED'
MSG02    DC    CL17'ERROR FINDING CSD'
MSG3     DC    CL25'CSD FAILED VALIDITY CHECK'
MSG4     DC    CL26'ERROR WHILE FORMATTING CSD'
MSG5     DC    CL19'CSD ADDRESS IS ZERO'
MSG10    DC    CL20'ERROR FINDING LCCAVT'
MSG11    DC    CL46'ALL POINTERS IN LCCAVT ARE UNAVAILABLE OR ZERO'
MSG12    DC    CL22'ERROR ACCESSING LCCAVT'
MSG17    DC    CL20'ERROR FINDING PCCAVT'
MSG18    DC    CL46'ALL POINTERS IN PCCAVT ARE UNAVAILABLE OR ZERO'
MSG19    DC    CL22'ERROR ACCESSING PCCAVT'
MSG20    DS    CL26
         ORG   MSG20
@NM00100 DC    CL19'ERROR FINDING LCCA '
ADDR20   DS    CL6
@NM00101 DS    CL1
         ORG   MSG20+26
MSG21    DC    CL26'LCCA FAILED VALIDITY CHECK'
MSG22    DC    CL27'ERROR WHILE FORMATTING LCCA'
MSG23    DC    CL28'VIRTUAL LCCA ADDRESS IS ZERO'
MSG24    DC    CL34'ERROR FINDING VIRTUAL LCCA ADDRESS'
MSG25    DS    CL38
         ORG   MSG25
@NM00102 DC    CL31'UNABLE TO FORMAT LCCA FOR PCCA '
ADDR25   DS    CL6
@NM00103 DS    CL1
         ORG   MSG25+38
MSG30    DS    CL26
         ORG   MSG30
@NM00104 DC    CL19'ERROR FINDING PCCA '
ADDR30   DS    CL6
@NM00105 DS    CL1
         ORG   MSG30+26
MSG31    DC    CL26'PCCA FAILED VALIDITY CHECK'
MSG32    DC    CL27'ERROR WHILE FORMATTING PCCA'
MSG33    DC    CL28'VIRUTAL PCCA ADDRESS IS ZERO'
MSG34    DC    CL34'ERROR FINDING VIRTUAL PCCA ADDRESS'
MSG40    DS    CL61
         ORG   MSG40
@NM00106 DC    CL27'ERROR FINDING PSA FOR PCCA '
ADDR40   DS    CL6
@NM00107 DS    CL1
@NM00108 DC    CL27'- PSA WILL NOT BE FORMATTED'
         ORG   MSG40+61
MSG41    DS    CL52
         ORG   MSG41
@NM00109 DC    CL18'ERROR FINDING PSA '
ADDR41   DS    CL6
@NM00110 DS    CL1
@NM00111 DC    CL27'- PSA WILL NOT BE FORMATTED'
         ORG   MSG41+52
MSG42    DC    CL60'ERROR FINDING VIRTUAL PSA ADDRESS, PSA WILL NOT BE C
               FORMATTED'
MSG43    DC    CL25'PSA FAILED VALIDITY CHECK'
MSG44    DC    CL56'PSA ADDRESS IS NOT ON A 4K BOUNDARY, FORMATTING BYPC
               ASSED'
MSG45    DC    CL66'PREFIX VALUE UNAVAILABLE FOR IPL''ED CPU, PSA WILL C
               NOT BE FORMATTED'
MSG46    DS    CL64
         ORG   MSG46
@NM00112 DC    CL36'ERROR FINDING UNPREFIXED STORAGE AT '
ADDR46   DS    CL6
@NM00113 DS    CL1
@NM00114 DC    CL21'- FORMATTING BYPASSED'
         ORG   MSG46+64
MSG47    DC    CL54'VIRTUAL PSA ADDRESS IS ZERO, PSA WILL NOT BE FORMATC
               TED'
MSG48    DC    CL69'VIRTUAL PSA ADDRESS IS ZERO, UNPREFIXED STORAGE WILC
               L NOT BE FORMATTED'
MSG49    DC    CL58'PCCA UNAVAILABLE, UNPREFIXED STORAGE WILL NOT BE FOC
               RMATTED'
MSG50    DS    CL46
         ORG   MSG50
@NM00115 DC    CL39'UNABLE TO FORMAT PCCA AND PSA FOR LCCA '
ADDR50   DS    CL6
@NM00116 DS    CL1
         ORG   MSG50+46
MSG51    DC    CL72'UNABLE TO DETERMINE CPU ADDRESS, STORE-STATUS DATA C
               WILL NOT BE FORMATTED'
MSG52    DS    CL47
         ORG   MSG52
@NM00117 DC    CL43'UNABLE TO FORMAT STORE-STATUS DATA FOR CPU '
ADDR52   DS    CL4
         ORG   MSG52+47
MSG53    DC    CL32'STORE-STATUS DATA MAY BE INVALID'
MSG54    DC    CL40'ONLY GENERAL PURPOSE REGISTERS ARE VALID'
MSG55    DC    CL36'UNABLE TO FORMAT LCCA, PCCA, AND PSA'
MSG56    DC    CL60'INVALID CPU ADDRESS, STORE-STATUS DATA WILL NOT BE C
               FORMATTED'
MSG57    DC    CL75'ERROR FINDING VIRTUAL PSA ADDRESS, UNPREFIXED STORAC
               GE WILL NOT BE FORMATTED'
CSDLBLS  DS    CL148
         ORG   CSDLBLS
LCSDL1   DC    CL44'CSD+0  CSDCPUJSCHADCPUALCPUOLSCFL1SCFL2SCFL3'
LCSDL2   DC    CL27'+F  SCFL4RV043MF1CPACRFLAGS'
LCSDL3   DC    CL9'+18  MAFF'
LCSDL4   DC    CL3'+40'
LCSDL5   DC    CL33'+68  RV044DDRCTGDCCGDINTGDTODTCNT'
LCSDL6   DC    CL13'+7C  UCNTMASK'
LCSDL7   DC    CL9'+A0  RESV'
LCSDL8   DC    CL3'+C8'
LCSDL9   DC    CL3'+F0'
LCSDL10  DC    CL4'+118'
         ORG   CSDLBLS+148
LCCALBLS DS    CL493
         ORG   LCCALBLS
LLCCAL1  DC    CL20'LCCA+0  LCCACPUARV77'
LLCCAL2  DC    CL8'+8  PGR1'
LLCCAL3  DC    CL3'+28'
LLCCAL4  DC    CL9'+48  PGR2'
LLCCAL5  DC    CL3'+68'
LLCCAL6  DC    CL24'+88  PPSWPINTPVADMCR1CR0'
LLCCAL7  DC    CL9'+A0  XGR1'
LLCCAL8  DC    CL3'+C0'
LLCCAL9  DC    CL9'+E0  XGR2'
LLCCAL10 DC    CL4'+100'
LLCCAL11 DC    CL10'+120  XGR3'
LLCCAL12 DC    CL4'+140'
LLCCAL13 DC    CL10'+160  RSGR'
LLCCAL14 DC    CL4'+180'
LLCCAL15 DC    CL10'+1A0  RESV'
LLCCAL16 DC    CL10'+1C0  GPGR'
LLCCAL17 DC    CL4'+1E0'
LLCCAL18 DC    CL26'+200  IOPSIHR1IHR2IHR3IHR4'
LLCCAL19 DC    CL30'+20C  SPN1SPN2SPN3SPN4ESSAASCP'
LLCCAL20 DC    CL26'+218  CPUSDSF1DSF2PSMKRV68'
LLCCAL21 DC    CL18'+220  DSR2-5RPR2-5'
LLCCAL22 DC    CL20'+240  RIR2-5STODDTOD'
LLCCAL23 DC    CL18'+260  ITODWTIMDSS1'
LLCCAL24 DC    CL14'+27C  DSS2DSS3'
LLCCAL25 DC    CL26'+294  DSSCDSSRSRBJDCPURCPU'
LLCCAL26 DC    CL30'+2AC  CRLCLCR0CRFLCREXLKFGRV88'
LLCCAL27 DC    CL26'+2B8  PINVRV78LWTMICR0ECSA'
LLCCAL28 DC    CL22'+2D0  SAFNPGTARV89ASID'
LLCCAL29 DC    CL9'+2E0  IRT'
LLCCAL30 DC    CL4'+300'
LLCCAL31 DC    CL4'+320'
LLCCAL32 DC    CL4'+340'
LLCCAL33 DC    CL30'+360  SMQJSPLJR102R103R104R105'
LLCCAL34 DC    CL14'+378  R106R107'
LLCCAL35 DC    CL10'+380  SGPR'
LLCCAL36 DC    CL4'+3A0'
LLCCAL37 DC    CL14'+3C0  R124R125'
         ORG   LCCALBLS+493
PCCALBLS DS    CL503
         ORG   PCCALBLS
LPCCAL1  DC    CL28'PCCA+0  PCCACPIDCPUACAFMTQEP'
LPCCAL2  DC    CL29'+18  PSAVPSARRV81RV82RV83RV84'
LPCCAL3  DC    CL29'+30  RV85RV86RV87RV88RV89RV90'
LPCCAL4  DC    CL29'+48  RV91RV92RV93RV94RV95RV96'
LPCCAL5  DC    CL29'+60  RV97RV98RV99RV9ARV9BRV9C'
LPCCAL6  DC    CL28'+78  RV9DRV9ETMFLTODECCEINTE'
LPCCAL7  DC    CL28'+84  RPBRISPEMS2EMS3RMSBEMSP'
LPCCAL8  DC    CL29'+90  EMSEEMSAPWAVPWARLRBVLRBR'
LPCCAL9  DC    CL21'+A8  ELADELBACCHMSRB '
LPCCAL10 DC    CL11'+C4CHANSRBL'
LPCCAL11 DC    CL9'+E2  RESV'
LPCCA11A DC    CL4'+108'
LPCCAL12 DC    CL30'+118  CHUBCHPFCHBLCHVACHTSCHS1'
LPCCAL13 DC    CL30'+121  CHS2CHRBIOSICHW1CHW2LOGL'
LPCCAL14 DC    CL30'+12E  CELLLGP1LGP2CHPBRESVCHF1'
LPCCAL15 DC    CL22'+135  CHF2CHF3CHF4CHSV'
LPCCAL16 DC    CL26'+144  CHIDLOGARV54RV55RV56'
LPCCAL17 DC    CL30'+15C  RV57RV58RV59RV60RV61RV62'
LPCCAL18 DC    CL26'+174  RV63CPUMRV01RV35RV36'
LPCCAL19 DC    CL9'+180  CAT'
LPCCAL20 DC    CL4'+1A8'
LPCCAL21 DC    CL4'+1D0'
LPCCAL22 DC    CL4'+1F8'
LPCCAL23 DC    CL10'+200  RESV'
LPCCAL24 DC    CL4'+228'
         ORG   PCCALBLS+503
LSTATL1  DC    CL3'PSW'
LSTATL2  DC    CL8'GPRS 0-7'
LSTATL3  DC    CL9'GPRS 8-15'
LSTATL4  DC    CL8'CTRS 0-7'
LSTATL5  DC    CL9'CTRS 8-15'
LSTATL6  DC    CL8'FPRS 0-2'
LSTATL7  DC    CL8'FPRS 4-6'
LSTATL8  DC    CL9'CPU-TIMER'
LSTATL9  DC    CL10'CLOCK-COMP'
LSTATL10 DC    CL6'PREFIX'
PSALBLS  DS    CL1031
         ORG   PSALBLS
LPSAL1   DC    CL24'PSA+0  RNPSWROPSWCVTRESV'
LPSAL2   DC    CL20'+18  EOPSWSOPSWPOPSW'
LPSAL3   DC    CL21'+30  MOPSWIOPSWCSWCAW'
LPSAL4   DC    CL24'+4C  CVT2TIMERTRACEENPSW'
LPSAL5   DC    CL20'+60  SNPSWPNPSWMNPSW'
LPSAL6   DC    CL27'+78  INPSWRESVSPADEICODRESV'
LPSAL7   DC    CL33'+89  SVILCSVCNRESVPIILCRV049PICOD'
LPSAL8   DC    CL29'+90  TEARESVMCNUMPERCDRESVPER'
LPSAL9   DC    CL23'+9C  RESVMTRCDRESVCHNID'
LPSAL10  DC    CL27'+AC  IOELLCLRESVRESVRESVIOA'
LPSAL11  DC    CL9'+BC  RESV'
LPSAL12  DC    CL7'+E0MCIC'
LPSAL13  DC    CL25'+F0  RESVMEDCRESVFSARGNCD'
LPSAL14  DC    CL9'+100  FLA'
LPSAL15  DC    CL4'+120'
LPSAL16  DC    CL4'+140'
LPSAL17  DC    CL11'+160  FPSAV'
LPSAL18  DC    CL11'+180  GRSAV'
LPSAL19  DC    CL4'+1A0'
LPSAL20  DC    CL11'+1C0  CRSAV'
LPSAL21  DC    CL4'+1E0'
LPSAL22  DC    CL29'+200  PSACPUPACPULAPCCAVPCCAR'
LPSAL23  DC    CL28'+210  LCCAVLCCARTNEWTOLDANEW'
LPSAL24  DC    CL26'+224  AOLDSUP1SUP2SUP3SUP4'
LPSAL25  DC    CL26'+22C  GPREGRSREGPIREGEXPS1'
LPSAL26  DC    CL20'+248  EXPS2MPSWMCHEX'
LPSAL27  DC    CL32'+260  IPCRIPCRMRESVIPCDIPCDMRESV'
LPSAL28  DC    CL35'+270  IPCSAHLHISRECURDSSGORV050SRSA'
LPSAL29  DC    CL30'+280  DISPLASMLSALCLIOSSLIOSCL'
LPSAL30  DC    CL31'+294  IOSULIOSLLTPNCLTPDNLTPACL'
LPSAL31  DC    CL24'+2A8  OPTLCMSLLOCALRV023'
LPSAL32  DC    CL10'+2B8  LKSA'
LPSAL33  DC    CL4'+2D8'
LPSAL34  DC    CL22'+2F8  HLHILITAPSWSVCR0'
LPSAL35  DC    CL31'+30C  MCHFLSYMSKACTCDMCHICWKRAP'
LPSAL36  DC    CL30'+314  WKVAPVSTAPCPUSASTORDSSRS'
LPSAL37  DC    CL26'+324  DSSR2DSSR3DSSWKDSSTS'
LPSAL38  DC    CL24'+340DSSF1DSSF2DSSF3DSSF4'
LPSAL39  DC    CL26'+348  DSSRPDSSPPDSS14DSSFW'
LPSAL40  DC    CL31'+360  DSSPRRV025RV040RV041RV042'
LPSAL41  DC    CL29'+374  RV043RV044RV045CSTKNSTK'
LPSAL42  DC    CL26'+388  SSTKSSAVMSTKMSAVPSTK'
LPSAL43  DC    CL30'+39C  PSAVESTK1ESAV1ESTK2ESAV2'
LPSAL44  DC    CL29'+3B0  ESTK3ESAV3RSTKRSAVSRPSW'
LPSAL45  DC    CL20'+3C8  RSPSWSTARTSTOP'
LPSAL46  DC    CL28'+3E8SFACCLSFCCSVC13RV059PIR2'
LPSAL47  DC    CL26'+400  PCPSWATCVTWTCODCDAL '
LPSAL48  DC    CL11'+418  USEND'
         ORG   PSALBLS+1031
PSALBLS2 DS    CL66
         ORG   PSALBLS2
LPSAL200 DC    CL10'+C00  STAK'
LPSAL201 DC    CL4'+C28'
LPSAL202 DC    CL4'+C50'
LPSAL203 DC    CL4'+C78'
LPSAL204 DC    CL4'+CA0'
LPSAL205 DC    CL4'+CC8'
LPSAL206 DC    CL4'+CF0'
LPSAL207 DC    CL4'+D18'
LPSAL208 DC    CL4'+D40'
LPSAL209 DC    CL4'+D68'
LPSAL210 DC    CL4'+D90'
LPSAL211 DC    CL4'+DB8'
LPSAL212 DC    CL4'+DE0'
LPSAL213 DC    CL4'+E08'
LPSAL214 DC    CL4'+E30'
         ORG   PSALBLS2+66
         DS    CL3
FMTTABL1 DC    AL4(PCSDL1)
         DC    AL4(PCSDL2)
         DC    AL4(PCSDL3)
         DC    AL4(PCSDL4)
         DC    AL4(PCSDL5)
         DC    AL4(PCSDL6)
         DC    AL4(PCSDL7)
         DC    AL4(PCSDL8)
         DC    AL4(PCSDL9)
         DC    AL4(PCSDL10)
FMTTABL2 DC    AL4(PLCCAL1)
         DC    AL4(PLCCAL2)
         DC    AL4(PLCCAL3)
         DC    AL4(PLCCAL4)
         DC    AL4(PLCCAL5)
         DC    AL4(PLCCAL6)
         DC    AL4(PLCCAL7)
         DC    AL4(PLCCAL8)
         DC    AL4(PLCCAL9)
         DC    AL4(PLCCAL10)
         DC    AL4(PLCCAL11)
         DC    AL4(PLCCAL12)
         DC    AL4(PLCCAL13)
         DC    AL4(PLCCAL14)
         DC    AL4(PLCCAL15)
         DC    AL4(PLCCAL16)
         DC    AL4(PLCCAL17)
         DC    AL4(PLCCAL18)
         DC    AL4(PLCCAL19)
         DC    AL4(PLCCAL20)
         DC    AL4(PLCCAL21)
         DC    AL4(PLCCAL22)
         DC    AL4(PLCCAL23)
         DC    AL4(PLCCAL24)
         DC    AL4(PLCCAL25)
         DC    AL4(PLCCAL26)
         DC    AL4(PLCCAL27)
         DC    AL4(PLCCAL28)
         DC    AL4(PLCCAL29)
         DC    AL4(PLCCAL30)
         DC    AL4(PLCCAL31)
         DC    AL4(PLCCAL32)
         DC    AL4(PLCCAL33)
         DC    AL4(PLCCAL34)
         DC    AL4(PLCCAL35)
         DC    AL4(PLCCAL36)
         DC    AL4(PLCCAL37)
FMTTABL3 DC    AL4(PPCCAL1)
         DC    AL4(PPCCAL2)
         DC    AL4(PPCCAL3)
         DC    AL4(PPCCAL4)
         DC    AL4(PPCCAL5)
         DC    AL4(PPCCAL6)
         DC    AL4(PPCCAL7)
         DC    AL4(PPCCAL8)
         DC    AL4(PPCCAL9)
         DC    AL4(PPCCAL10)
         DC    AL4(PPCCAL11)
         DC    AL4(PPCCA11A)
         DC    AL4(PPCCAL12)
         DC    AL4(PPCCAL13)
         DC    AL4(PPCCAL14)
         DC    AL4(PPCCAL15)
         DC    AL4(PPCCAL16)
         DC    AL4(PPCCAL17)
         DC    AL4(PPCCAL18)
         DC    AL4(PPCCAL19)
         DC    AL4(PPCCAL20)
         DC    AL4(PPCCAL21)
         DC    AL4(PPCCAL22)
         DC    AL4(PPCCAL23)
         DC    AL4(PPCCAL24)
FMTTABL4 DC    AL4(PPSAL1)
         DC    AL4(PPSAL2)
         DC    AL4(PPSAL3)
         DC    AL4(PPSAL4)
         DC    AL4(PPSAL5)
         DC    AL4(PPSAL6)
         DC    AL4(PPSAL7)
         DC    AL4(PPSAL8)
         DC    AL4(PPSAL9)
         DC    AL4(PPSAL10)
         DC    AL4(PPSAL11)
         DC    AL4(PPSAL12)
         DC    AL4(PPSAL13)
         DC    AL4(PPSAL14)
         DC    AL4(PPSAL15)
         DC    AL4(PPSAL16)
         DC    AL4(PPSAL17)
         DC    AL4(PPSAL18)
         DC    AL4(PPSAL19)
         DC    AL4(PPSAL20)
         DC    AL4(PPSAL21)
         DC    AL4(PPSAL22)
         DC    AL4(PPSAL23)
         DC    AL4(PPSAL24)
         DC    AL4(PPSAL25)
         DC    AL4(PPSAL26)
         DC    AL4(PPSAL27)
         DC    AL4(PPSAL28)
         DC    AL4(PPSAL29)
         DC    AL4(PPSAL30)
         DC    AL4(PPSAL31)
         DC    AL4(PPSAL32)
         DC    AL4(PPSAL33)
         DC    AL4(PPSAL34)
         DC    AL4(PPSAL35)
         DC    AL4(PPSAL36)
         DC    AL4(PPSAL37)
         DC    AL4(PPSAL38)
         DC    AL4(PPSAL39)
         DC    AL4(PPSAL40)
         DC    AL4(PPSAL41)
         DC    AL4(PPSAL42)
         DC    AL4(PPSAL43)
         DC    AL4(PPSAL44)
         DC    AL4(PPSAL45)
         DC    AL4(PPSAL46)
         DC    AL4(PPSAL47)
         DC    AL4(PPSAL48)
FMTTABL5 DC    AL4(PPSAL200)
         DC    AL4(PPSAL201)
         DC    AL4(PPSAL202)
         DC    AL4(PPSAL203)
         DC    AL4(PPSAL204)
         DC    AL4(PPSAL205)
         DC    AL4(PPSAL206)
         DC    AL4(PPSAL207)
         DC    AL4(PPSAL208)
         DC    AL4(PPSAL209)
         DC    AL4(PPSAL210)
         DC    AL4(PPSAL211)
         DC    AL4(PPSAL212)
         DC    AL4(PPSAL213)
         DC    AL4(PPSAL214)
GCDPATCH DC    60F'0'
AMDPRGCD CSECT
*
DTAE     EQU   32                  DATA EBCDIC BIT
DTAC     EQU   16                  DATA IN CORE BIT
DTAP     EQU   8                   DATA PTR BIT
DTA      EQU   4                   DATA INCLUDED BIT
LBLP     EQU   2                   LABEL PTR BIT
LBL      EQU   1                   LABEL INCLUDED BIT
AMDPRGCD CSECT
*                                   /* COMMENT DELIMITERS PREVENT
*                                      MACRO PHASE MODIFICATION
***********************************************************************
*                                                                     *
*   THE FOLLOWING ARE THE FORMAT PATTERNS FOR THE CSD                 *
*                                                                     *
***********************************************************************
     SPACE
PCSDL1   FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),3,3,0,6,CSDLBLS,CSDPTR+1
         FMTPTRN (LBL,DTA,DTAP),7,4,17,27,,(CSDPTR,0)
         FMTPTRN (LBL,DTA),5,2,36,42
         FMTPTRN (LBL,DTA),4,2,48,53
         FMTPTRN (LBL,DTA),5,2,60,66
         FMTPTRN (LBL,DTA),5,2,73,79
         FMTPTRN (LBL,DTA),5,1,86,92
         FMTPTRN (LBL,DTA),5,1,97,103
         FMTPTRN (LBL,DTA),5,1,108,114,,,LAST
PCSDL2   FMTPTRN (LBL,DTA),9,1,17,27
         FMTPTRN (LBL,DTA),5,4,36,42
         FMTPTRN (LBL,DTA),5,2,60,66
         FMTPTRN (LBL,DTA),3,1,73,79
         FMTPTRN (LBL,DTA),5,1,86,92,,,LAST
PCSDL3   FMTPTRN (LBL,DTA),9,16,16,27
         FMTPTRN (DTA),,16,,63
         FMTPTRN (DTA),,8,,99,,,LAST
PCSDL4   FMTPTRN (LBL,DTA),3,16,16,27
         FMTPTRN (DTA),,16,,63
         FMTPTRN (DTA),,8,,99,,,LAST
PCSDL5   FMTPTRN (LBL,DTA),10,2,16,27
         FMTPTRN (LBL,DTA),5,2,36,42
         FMTPTRN (LBL,DTA),4,4,48,53
         FMTPTRN (LBL,DTA),5,4,64,70
         FMTPTRN (LBL,DTA),5,4,81,87
         FMTPTRN (LBL,DTA),4,4,97,103,,,LAST
PCSDL6   FMTPTRN (LBL,DTA),9,4,16,27
         FMTPTRN (LBL,DTA),4,16,40,45
         FMTPTRN (DTA),,16,,81,,,LAST
PCSDL7   FMTPTRN (LBL,DTA),9,16,16,27
         FMTPTRN (DTA),,16,,63
         FMTPTRN (DTA),,8,,99,,,LAST
PCSDL8   FMTPTRN (LBL,DTA),3,16,16,27
         FMTPTRN (DTA),,16,,63
         FMTPTRN (DTA),,8,,99,,,LAST
PCSDL9   FMTPTRN (LBL,DTA),3,16,16,27
         FMTPTRN (DTA),,16,,63
         FMTPTRN (DTA),,8,,99,,,LAST
PCSDL10  FMTPTRN (LBL,DTA),4,16,15,27
         FMTPTRN (DTA),,16,,63,,,LAST
AMDPRGCD CSECT
*                                   /* COMMENT DELIMITERS PREVENT
*                                      MACRO PHASE MODIFICATION
***********************************************************************
*                                                                     *
*   THE FOLLOWING ARE THE FORMAT PATTERNS FOR THE LCCA                *
*                                                                     *
***********************************************************************
     SPACE
PLCCAL1  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),4,3,0,6,LCCALBLS,LCCAPTR+1
         FMTPTRN (LBL,DTA,DTAP),8,4,17,26,,(LCCAPTR,0)
         FMTPTRN (LBL,DTA),4,2,36,41
         FMTPTRN (LBL,DTA),4,2,48,53,,,LAST
PLCCAL2  FMTPTRN (LBL,DTA),8,4,17,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL3  FMTPTRN (LBL,DTA),3,4,16,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL4  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL5  FMTPTRN (LBL,DTA),3,4,16,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL6  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (DTA),,4,,35
         FMTPTRN (LBL,DTA),4,4,48,53
         FMTPTRN (LBL,DTA),4,4,64,70
         FMTPTRN (LBL,DTA),4,4,81,86
         FMTPTRN (LBL,DTA),3,4,98,103,,,LAST
PLCCAL7  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL8  FMTPTRN (LBL,DTA),3,4,16,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL9  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL10 FMTPTRN (LBL,DTA),4,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL11 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL12 FMTPTRN (LBL,DTA),4,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL13 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL14 FMTPTRN (LBL,DTA),4,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL15 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL16 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL17 FMTPTRN (LBL,DTA),4,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL18 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (DTA),,4,,35
         FMTPTRN (LBL,DTA),4,1,48,53
         FMTPTRN (LBL,DTA),4,1,64,70
         FMTPTRN (LBL,DTA),4,1,81,86
         FMTPTRN (LBL,DTA),4,1,98,103,,,LAST
PLCCAL19 FMTPTRN (LBL,DTA),10,1,15,26
         FMTPTRN (LBL,DTA),4,1,35,40
         FMTPTRN (LBL,DTA),4,1,48,53
         FMTPTRN (LBL,DTA),4,1,64,70
         FMTPTRN (LBL,DTA),4,4,81,86
         FMTPTRN (LBL,DTA),4,4,98,103,,,LAST
PLCCAL20 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (LBL,DTA),4,1,35,40
         FMTPTRN (LBL,DTA),4,1,48,53
         FMTPTRN (LBL,DTA),4,1,64,70
         FMTPTRN (LBL,DTA),4,1,81,86,,,LAST
PLCCAL21 FMTPTRN (LBL,DTA),12,16,15,28
         FMTPTRN (LBL,DTA),6,16,68,76,,,LAST
PLCCAL22 FMTPTRN (LBL,DTA),12,16,15,28
         FMTPTRN (LBL,DTA),4,8,64,70
         FMTPTRN (LBL,DTA),4,8,89,94,,,LAST
PLCCAL23 FMTPTRN (LBL,DTA),10,8,15,26
         FMTPTRN (LBL,DTA),4,8,50,55
         FMTPTRN (LBL,DTA),4,4,76,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL24 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (LBL,DTA),4,4,64,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92,,,LAST
PLCCAL25 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (LBL,DTA),4,4,50,55
         FMTPTRN (LBL,DTA),4,4,64,70
         FMTPTRN (LBL,DTA),4,4,81,86
         FMTPTRN (LBL,DTA),4,4,98,103,,,LAST
PLCCAL26 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (LBL,DTA),4,4,35,40
         FMTPTRN (LBL,DTA),4,1,50,55
         FMTPTRN (LBL,DTA),4,1,64,70
         FMTPTRN (LBL,DTA),4,1,81,86
         FMTPTRN (LBL,DTA),4,1,98,103,,,LAST
PLCCAL27 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (LBL,DTA),4,4,35,40
         FMTPTRN (LBL,DTA),4,8,50,55
         FMTPTRN (LBL,DTA),4,4,81,86
         FMTPTRN (LBL,DTA),4,4,98,103,,,LAST
PLCCAL28 FMTPTRN (LBL,DTA),10,2,15,26
         FMTPTRN (LBL,DTA),4,6,35,40
         FMTPTRN (LBL,DTA),4,4,64,70
         FMTPTRN (LBL,DTA),4,4,81,86,,,LAST
PLCCAL29 FMTPTRN (LBL,DTA),9,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL30 FMTPTRN (LBL,DTA),4,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL31 FMTPTRN (LBL,DTA),4,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL32 FMTPTRN (LBL,DTA),4,4,15,26
         FMTPTRN (DTA),,4,,37
         FMTPTRN (DTA),,4,,48
         FMTPTRN (DTA),,4,,59
         FMTPTRN (DTA),,4,,70
         FMTPTRN (DTA),,4,,81
         FMTPTRN (DTA),,4,,92
         FMTPTRN (DTA),,4,,103,,,LAST
PLCCAL33 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (LBL,DTA),4,4,36,41
         FMTPTRN (LBL,DTA),4,4,51,56
         FMTPTRN (LBL,DTA),4,4,66,71
         FMTPTRN (LBL,DTA),4,4,81,86
         FMTPTRN (LBL,DTA),4,4,96,101,,,LAST
PLCCAL34 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (LBL,DTA),4,4,36,41,,,LAST                    @ZA02789
PLCCAL35 FMTPTRN (LBL,DTA),10,4,15,26                          @ZA02789
         FMTPTRN (DTA),,4,,37                                  @ZA02789
         FMTPTRN (DTA),,4,,48                                  @ZA02789
         FMTPTRN (DTA),,4,,59                                  @ZA02789
         FMTPTRN (DTA),,4,,70                                  @ZA02789
         FMTPTRN (DTA),,4,,81                                  @ZA02789
         FMTPTRN (DTA),,4,,92                                  @ZA02789
         FMTPTRN (DTA),,4,,103,,,LAST                          @ZA02789
PLCCAL36 FMTPTRN (LBL,DTA),4,4,15,26                           @ZA02789
         FMTPTRN (DTA),,4,,37                                  @ZA02789
         FMTPTRN (DTA),,4,,48                                  @ZA02789
         FMTPTRN (DTA),,4,,59                                  @ZA02789
         FMTPTRN (DTA),,4,,70                                  @ZA02789
         FMTPTRN (DTA),,4,,81                                  @ZA02789
         FMTPTRN (DTA),,4,,92                                  @ZA02789
         FMTPTRN (DTA),,4,,103,,,LAST                          @ZA02789
PLCCAL37 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (LBL,DTA),4,4,36,41,,,LAST
AMDPRGCD CSECT
*                                   /* COMMENT DELIMITERS PREVENT
*                                      MACRO PHASE MODIFICATION
***********************************************************************
*                                                                     *
*   THE FOLLOWING ARE THE FORMAT PATTERNS FOR THE PCCA                *
*                                                                     *
***********************************************************************
     SPACE
PPCCAL1  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),4,3,0,6,PCCALBLS,PCCAPTR+1
         FMTPTRN (LBL,DTA,DTAP),8,4,17,26,,(PCCAPTR,0)
         FMTPTRN (LBL,DTA),4,12,37,42
         FMTPTRN (LBL,DTA),4,2,69,74
         FMTPTRN (LBL,DTA),4,2,85,90
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST
PPCCAL2  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (LBL,DTA),4,4,37,42
         FMTPTRN (LBL,DTA),4,4,53,58
         FMTPTRN (LBL,DTA),4,4,69,74
         FMTPTRN (LBL,DTA),4,4,85,90
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST
PPCCAL3  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (LBL,DTA),4,4,37,42
         FMTPTRN (LBL,DTA),4,4,53,58
         FMTPTRN (LBL,DTA),4,4,69,74
         FMTPTRN (LBL,DTA),4,4,85,90
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST
PPCCAL4  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (LBL,DTA),4,4,37,42
         FMTPTRN (LBL,DTA),4,4,53,58
         FMTPTRN (LBL,DTA),4,4,69,74
         FMTPTRN (LBL,DTA),4,4,85,90
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST
PPCCAL5  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (LBL,DTA),4,4,37,42
         FMTPTRN (LBL,DTA),4,4,53,58
         FMTPTRN (LBL,DTA),4,4,69,74
         FMTPTRN (LBL,DTA),4,4,85,90
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST
PPCCAL6  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (LBL,DTA),4,4,37,42
         FMTPTRN (LBL,DTA),4,1,53,58
         FMTPTRN (LBL,DTA),4,1,69,74
         FMTPTRN (LBL,DTA),3,1,85,90
         FMTPTRN (LBL,DTA),4,1,101,106,,,LAST
PPCCAL7  FMTPTRN (LBL,DTA),8,4,16,26
         FMTPTRN (LBL,DTA),4,1,37,42
         FMTPTRN (LBL,DTA),4,1,53,58
         FMTPTRN (LBL,DTA),4,1,69,74
         FMTPTRN (LBL,DTA),4,1,85,90
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST
PPCCAL8  FMTPTRN (LBL,DTA),9,4,16,26
         FMTPTRN (LBL,DTA),4,4,37,42
         FMTPTRN (LBL,DTA),4,4,53,58
         FMTPTRN (LBL,DTA),4,4,69,74
         FMTPTRN (LBL,DTA),4,4,85,90
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST
PPCCAL9  FMTPTRN (LBL,DTA),9,4,16,26                         @G51BGTM
         FMTPTRN (LBL,DTA),4,4,37,42                         @G51BGTM
         FMTPTRN (LBL,DTA),4,4,53,58                         @G51BGTM
         FMTPTRN (LBL,DTA),4,16,75,80,,,LAST                 @G51BGTM
PPCCAL10 FMTPTRN (LBL,DTA),3,16,16,26
         FMTPTRN (DTA),,12,,62                               @G51BGTM
         FMTPTRN (LBL,DTA),4,1,91,96                         @G51BGTM
         FMTPTRN (LBL,DTA),4,1,101,106,,,LAST                @G51BGTM
PPCCAL11 FMTPTRN (LBL,DTA),9,2,16,26                         @G51BGTM
         FMTPTRN (DTA),,16,,35                               @G51BGTM
         FMTPTRN (DTA),,16,,71                               @G51BGTM
         FMTPTRN (DTA),,04,,107,,,LAST                       @G51BGTM
PPCCA11A FMTPTRN (LBL,DTA),4,16,15,26,,,LAST                 @G51BGTM
PPCCAL12 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (LBL,DTA),4,1,37,42
         FMTPTRN (LBL,DTA),4,1,53,58
         FMTPTRN (LBL,DTA),4,1,69,74
         FMTPTRN (LBL,DTA),4,1,85,90
         FMTPTRN (LBL,DTA),4,1,101,106,,,LAST
PPCCAL13 FMTPTRN (LBL,DTA),10,1,15,26
         FMTPTRN (LBL,DTA),4,1,37,42
         FMTPTRN (LBL,DTA),4,1,53,58
         FMTPTRN (LBL,DTA),4,4,69,74
         FMTPTRN (LBL,DTA),4,4,85,90
         FMTPTRN (LBL,DTA),4,2,101,106,,,LAST
PPCCAL14 FMTPTRN (LBL,DTA),10,2,15,26                        @G51BGTM
         FMTPTRN (LBL,DTA),4,1,37,42
         FMTPTRN (LBL,DTA),4,1,53,58
         FMTPTRN (LBL,DTA),4,1,69,74
         FMTPTRN (LBL,DTA),4,1,85,90                         @G51BGTM
         FMTPTRN (LBL,DTA),4,1,101,106,,,LAST
PPCCAL15 FMTPTRN (LBL,DTA),10,1,15,26
         FMTPTRN (LBL,DTA),4,1,37,42
         FMTPTRN (LBL,DTA),4,1,53,58
         FMTPTRN (LBL,DTA),4,4,69,74
         FMTPTRN (DTA),,4,,85
         FMTPTRN (DTA),,4,,96,,,LAST
PPCCAL16 FMTPTRN (LBL,DTA),10,8,15,26
         FMTPTRN (LBL,DTA),4,4,53,58
         FMTPTRN (LBL,DTA),4,4,69,74
         FMTPTRN (LBL,DTA),4,4,85,90
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST
PPCCAL17 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (LBL,DTA),4,4,37,42
         FMTPTRN (LBL,DTA),4,4,53,58
         FMTPTRN (LBL,DTA),4,4,69,74
         FMTPTRN (LBL,DTA),4,4,85,90
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST
PPCCAL18 FMTPTRN (LBL,DTA),10,4,15,26
         FMTPTRN (LBL,DTA),4,1,37,42
         FMTPTRN (LBL,DTA),4,1,53,58
         FMTPTRN (LBL,DTA),4,2,69,74
         FMTPTRN (LBL,DTA),4,4,85,90,,,LAST
PPCCAL19 FMTPTRN (LBL,DTA),9,16,15,26
         FMTPTRN (DTA),,16,,62
         FMTPTRN (DTA),,8,,98,,,LAST
PPCCAL20 FMTPTRN (LBL,DTA),4,16,15,26
         FMTPTRN (DTA),,16,,62
         FMTPTRN (DTA),,8,,98,,,LAST
PPCCAL21 FMTPTRN (LBL,DTA),4,16,15,26
         FMTPTRN (DTA),,16,,62
         FMTPTRN (DTA),,8,,98,,,LAST
PPCCAL22 FMTPTRN (LBL,DTA),4,8,15,26,,,LAST
PPCCAL23 FMTPTRN (LBL,DTA),10,16,15,26
         FMTPTRN (DTA),,16,,62
         FMTPTRN (DTA),,8,,98,,,LAST
PPCCAL24 FMTPTRN (LBL,DTA),4,16,15,26
         FMTPTRN (DTA),,16,,62,,,LAST
AMDPRGCD CSECT
*                                   /* COMMENT DELIMITERS PREVENT
*                                      MACRO PHASE MODIFICATION
***********************************************************************
*                                                                     *
* THE FOLLOWING ARE THE FORMAT PATTERNS FOR THE PSW, AND STATUS DATA  *
*                                                                     *
***********************************************************************
     SPACE
PSTATL1  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),3,8,21,32,LSTATL1,           X
               (STAT1,0),LAST
PSTATL2  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),8,4,21,32,LSTATL2,(STAT2,0)
         FMTPTRN (DTA,DTAC),,4,,43
         FMTPTRN (DTA,DTAC),,4,,54
         FMTPTRN (DTA,DTAC),,4,,65
         FMTPTRN (DTA,DTAC),,4,,76
         FMTPTRN (DTA,DTAC),,4,,87
         FMTPTRN (DTA,DTAC),,4,,98
         FMTPTRN (DTA,DTAC),,4,,109,,,LAST
PSTATL3  FMTPTRN (LBL,DTA,LBLP,DTAC),9,4,21,32,LSTATL3
         FMTPTRN (DTA,DTAC),,4,,43
         FMTPTRN (DTA,DTAC),,4,,54
         FMTPTRN (DTA,DTAC),,4,,65
         FMTPTRN (DTA,DTAC),,4,,76
         FMTPTRN (DTA,DTAC),,4,,87
         FMTPTRN (DTA,DTAC),,4,,98
         FMTPTRN (DTA,DTAC),,4,,109,,,LAST
PSTATL4  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),8,4,21,32,LSTATL4,(STAT4,0)
         FMTPTRN (DTA,DTAC),,4,,43
         FMTPTRN (DTA,DTAC),,4,,54
         FMTPTRN (DTA,DTAC),,4,,65
         FMTPTRN (DTA,DTAC),,4,,76
         FMTPTRN (DTA,DTAC),,4,,87
         FMTPTRN (DTA,DTAC),,4,,98
         FMTPTRN (DTA,DTAC),,4,,109,,,LAST
PSTATL5  FMTPTRN (LBL,DTA,LBLP,DTAC),9,4,21,32,LSTATL5
         FMTPTRN (DTA,DTAC),,4,,43
         FMTPTRN (DTA,DTAC),,4,,54
         FMTPTRN (DTA,DTAC),,4,,65
         FMTPTRN (DTA,DTAC),,4,,76
         FMTPTRN (DTA,DTAC),,4,,87
         FMTPTRN (DTA,DTAC),,4,,98
         FMTPTRN (DTA,DTAC),,4,,109,,,LAST
PSTATL6  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),8,16,21,32,LSTATL6,          X
               (STAT6,0),LAST
PSTATL7  FMTPTRN (LBL,DTA,LBLP,DTAC),8,16,21,32,LSTATL7,,LAST
PSTATL8  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),9,8,21,32,LSTATL8,           X
               (STAT8,0),LAST
PSTATL9  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),10,8,21,32,LSTATL9,          X
               (STAT9,0),LAST
PSTATL10 FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),6,4,21,32,LSTATL10,          X
               (STAT10,0),LAST
AMDPRGCD CSECT
*                                   /* COMMENT DELIMITERS PREVENT
*                                      MACRO PHASE MODIFICATION
***********************************************************************
*                                                                     *
*   THE FOLLOWING ARE THE FORMAT PATTERNS FOR THE PSA                 *
*                                                                     *
***********************************************************************
     SPACE
PPSAL1   FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),3,3,0,6,PSALBLS,PSAVIRT+1
         FMTPTRN (LBL,DTA,DTAP,DTAC),9,8,17,27,,(STGADPSA,0)
         FMTPTRN (LBL,DTA,DTAC),5,8,47,53
         FMTPTRN (LBL,DTA,DTAC),3,4,72,78
         FMTPTRN (LBL,DTA,DTAC),4,4,89,95,,,LAST
PPSAL2   FMTPTRN (LBL,DTA,DTAC),10,8,16,27
         FMTPTRN (LBL,DTA,DTAC),5,8,47,53
         FMTPTRN (LBL,DTA,DTAC),5,8,72,78,,,LAST
PPSAL3   FMTPTRN (LBL,DTA,DTAC),10,8,16,27
         FMTPTRN (LBL,DTA,DTAC),5,8,47,53
         FMTPTRN (LBL,DTA,DTAC),3,8,72,78
         FMTPTRN (LBL,DTA,DTAC),3,4,101,107,,,LAST
PPSAL4   FMTPTRN (LBL,DTA,DTAC),9,4,16,27
         FMTPTRN (LBL,DTA,DTAC),5,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,4,56,62
         FMTPTRN (LBL,DTA,DTAC),5,8,72,78,,,LAST
PPSAL5   FMTPTRN (LBL,DTA,DTAC),10,8,16,27
         FMTPTRN (LBL,DTA,DTAC),5,8,47,53
         FMTPTRN (LBL,DTA,DTAC),5,8,72,78,,,LAST
PPSAL6   FMTPTRN (LBL,DTA,DTAC),10,8,16,27
         FMTPTRN (LBL,DTA,DTAC),4,4,47,53
         FMTPTRN (LBL,DTA,DTAC),4,2,72,78
         FMTPTRN (LBL,DTA,DTAC),5,2,89,95               /*   @OZ16959*/
         FMTPTRN (LBL,DTA,DTAC),4,1,101,107,,,LAST
PPSAL7   FMTPTRN (LBL,DTA,DTAC),10,1,16,27
         FMTPTRN (LBL,DTA,DTAC),4,2,38,44
         FMTPTRN (LBL,DTA,DTAC),4,1,56,62
         FMTPTRN (LBL,DTA,DTAC),5,1,72,78
         FMTPTRN (LBL,DTA,DTAC),5,1,89,95
         FMTPTRN (LBL,DTA,DTAC),5,1,101,107,,,LAST
PPSAL8   FMTPTRN (LBL,DTA,DTAC),8,4,16,27
         FMTPTRN (LBL,DTA,DTAC),4,1,38,44
         FMTPTRN (LBL,DTA,DTAC),5,1,56,62
         FMTPTRN (LBL,DTA,DTAC),5,1,72,78
         FMTPTRN (LBL,DTA,DTAC),4,1,89,95
         FMTPTRN (LBL,DTA,DTAC),3,4,101,107,,,LAST
PPSAL9   FMTPTRN (LBL,DTA,DTAC),9,1,16,27
         FMTPTRN (LBL,DTA,DTAC),5,3,38,44
         FMTPTRN (LBL,DTA,DTAC),4,8,56,62
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95,,,LAST
PPSAL10  FMTPTRN (LBL,DTA,DTAC),9,4,16,27
         FMTPTRN (LBL,DTA,DTAC),3,4,38,44
         FMTPTRN (LBL,DTA,DTAC),4,2,56,62
         FMTPTRN (LBL,DTA,DTAC),4,1,72,78
         FMTPTRN (LBL,DTA,DTAC),4,1,89,95
         FMTPTRN (LBL,DTA,DTAC),3,4,101,107,,,LAST
PPSAL11  FMTPTRN (LBL,DTA,DTAC),9,16,16,27
         FMTPTRN (DTA,DTAC),,16,,63
         FMTPTRN (DTA,DTAC),,4,,99,,,LAST
PPSAL12  FMTPTRN (LBL,DTA,DTAC),3,8,16,27                    @G51BGTM
         FMTPTRN (LBL,DTA,DTAC),4,8,56,62,,,LAST             @G51BGTM
PPSAL13  FMTPTRN (LBL,DTA,DTAC),9,4,16,27                    @G51BGTM
         FMTPTRN (LBL,DTA,DTAC),4,1,38,44                    @G51BGTM
         FMTPTRN (LBL,DTA,DTAC),4,3,56,62                    @G51BGTM
         FMTPTRN (LBL,DTA,DTAC),3,4,72,78                    @G51BGTM
         FMTPTRN (LBL,DTA,DTAC),5,4,101,107,,,LAST           @G51BGTM
PPSAL14  FMTPTRN (LBL,DTA,DTAC),9,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL15  FMTPTRN (LBL,DTA,DTAC),4,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL16  FMTPTRN (LBL,DTA,DTAC),4,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL17  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL18  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL19  FMTPTRN (LBL,DTA,DTAC),4,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL20  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL21  FMTPTRN (LBL,DTA,DTAC),4,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL22  FMTPTRN (LBL,DTA,DTAC),9,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,2,38,44
         FMTPTRN (LBL,DTA,DTAC),5,2,54,60
         FMTPTRN (LBL,DTA,DTAC),5,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95,,,LAST
PPSAL23  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,38,44
         FMTPTRN (LBL,DTA,DTAC),4,4,54,60
         FMTPTRN (LBL,DTA,DTAC),4,4,72,78
         FMTPTRN (LBL,DTA,DTAC),4,4,89,95,,,LAST
PPSAL24  FMTPTRN (LBL,DTA,DTAC),10,4,15,27
         FMTPTRN (LBL,DTA,DTAC),4,1,38,44
         FMTPTRN (LBL,DTA,DTAC),4,1,54,60
         FMTPTRN (LBL,DTA,DTAC),4,1,72,78
         FMTPTRN (LBL,DTA,DTAC),4,1,89,95,,,LAST
PPSAL25  FMTPTRN (LBL,DTA,DTAC),11,12,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,54,60
         FMTPTRN (LBL,DTA,DTAC),5,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,8,89,95,,,LAST
PPSAL26  FMTPTRN (LBL,DTA,DTAC),11,8,15,27
         FMTPTRN (LBL,DTA,DTAC),4,8,45,51
         FMTPTRN (LBL,DTA,DTAC),5,8,72,78,,,LAST
PPSAL27  FMTPTRN (LBL,DTA,DTAC),10,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,1,38,44
         FMTPTRN (LBL,DTA,DTAC),4,3,54,60
         FMTPTRN (LBL,DTA,DTAC),4,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,1,89,95
         FMTPTRN (LBL,DTA,DTAC),4,3,101,107,,,LAST
PPSAL28  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,1,54,60
         FMTPTRN (LBL,DTA,DTAC),5,1,72,78
         FMTPTRN (LBL,DTA,DTAC),5,2,89,95
         FMTPTRN (LBL,DTA,DTAC),4,4,101,107,,,LAST
PPSAL29  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (LBL,DTA,DTAC),4,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,4,54,60
         FMTPTRN (LBL,DTA,DTAC),5,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95,,,LAST
PPSAL30  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,4,54,60
         FMTPTRN (LBL,DTA,DTAC),5,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95,,,LAST
PPSAL31  FMTPTRN (LBL,DTA,DTAC),10,4,15,27
         FMTPTRN (LBL,DTA,DTAC),4,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,4,54,60
         FMTPTRN (LBL,DTA,DTAC),5,4,72,78,,,LAST
PPSAL32  FMTPTRN (LBL,DTA,DTAC),10,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL33  FMTPTRN (LBL,DTA,DTAC),4,4,15,27
         FMTPTRN (DTA,DTAC),,4,,38
         FMTPTRN (DTA,DTAC),,4,,49
         FMTPTRN (DTA,DTAC),,4,,60
         FMTPTRN (DTA,DTAC),,4,,71
         FMTPTRN (DTA,DTAC),,4,,82
         FMTPTRN (DTA,DTAC),,4,,93
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL34  FMTPTRN (LBL,DTA,DTAC),10,4,15,27
         FMTPTRN (LBL,DTA,DTAC),4,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,4,54,60
         FMTPTRN (DTA,DTAC),,4,,70
         FMTPTRN (LBL,DTA,DTAC),3,4,89,95,,,LAST
PPSAL35  FMTPTRN (LBL,DTA,DTAC),11,1,15,27
         FMTPTRN (LBL,DTA,DTAC),5,1,38,44
         FMTPTRN (LBL,DTA,DTAC),5,1,54,60               /*   @OZ16959*/
         FMTPTRN (LBL,DTA,DTAC),5,1,72,78
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95,,,LAST
PPSAL36  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,2,38,44
         FMTPTRN (LBL,DTA,DTAC),5,2,54,60
         FMTPTRN (LBL,DTA,DTAC),4,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95,,,LAST
PPSAL37  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,4,54,60
         FMTPTRN (LBL,DTA,DTAC),5,16,72,78,,,LAST
PPSAL38  FMTPTRN (LBL,DTA,DTAC),4,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,1,38,44
         FMTPTRN (LBL,DTA,DTAC),5,1,54,60
         FMTPTRN (LBL,DTA,DTAC),5,1,72,78
         FMTPTRN (LBL,DTA,DTAC),5,1,89,95,,,LAST
PPSAL39  FMTPTRN (LBL,DTA,DTAC),11,8,15,27
         FMTPTRN (LBL,DTA,DTAC),5,8,45,51
         FMTPTRN (LBL,DTA,DTAC),5,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95,,,LAST
PPSAL40  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,4,54,60
         FMTPTRN (LBL,DTA,DTAC),5,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95,,,LAST
PPSAL41  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,4,54,60
         FMTPTRN (LBL,DTA,DTAC),4,4,72,78
         FMTPTRN (LBL,DTA,DTAC),4,4,89,95,,,LAST
PPSAL42  FMTPTRN (LBL,DTA,DTAC),10,4,15,27
         FMTPTRN (LBL,DTA,DTAC),4,4,38,44
         FMTPTRN (LBL,DTA,DTAC),4,4,54,60
         FMTPTRN (LBL,DTA,DTAC),4,4,72,78
         FMTPTRN (LBL,DTA,DTAC),4,4,89,95,,,LAST
PPSAL43  FMTPTRN (LBL,DTA,DTAC),10,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,38,44
         FMTPTRN (LBL,DTA,DTAC),5,4,54,60
         FMTPTRN (LBL,DTA,DTAC),5,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95,,,LAST
PPSAL44  FMTPTRN (LBL,DTA,DTAC),11,4,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,38,44
         FMTPTRN (LBL,DTA,DTAC),4,4,54,60
         FMTPTRN (LBL,DTA,DTAC),4,4,72,78
         FMTPTRN (LBL,DTA,DTAC),5,4,89,95
         FMTPTRN (DTA,DTAC),,4,,104,,,LAST
PPSAL45  FMTPTRN (LBL,DTA,DTAC),11,8,15,27
         FMTPTRN (LBL,DTA,DTAC),5,16,46,52
         FMTPTRN (LBL,DTA,DTAC),4,8,89,95,,,LAST
PPSAL46  FMTPTRN (LBL,DTA,DTAC),4,8,15,27
         FMTPTRN (LBL,DTA,DTAC),5,4,46,52
         FMTPTRN (LBL,DTA,DTAC),5,4,62,68
         FMTPTRN (LBL,DTA,DTAC),5,2,77,83
         FMTPTRN (LBL,DTA,DTAC),5,2,89,95
         FMTPTRN (LBL,DTA,DTAC),4,4,101,107,,,LAST             @ZA02797
PPSAL47  FMTPTRN (LBL,DTA,DTAC),11,8,15,27                     @Z498006
         FMTPTRN (LBL,DTA,DTAC),5,4,46,52                      @Z498006
         FMTPTRN (LBL,DTA,DTAC),5,4,62,68                      @Z498006
         FMTPTRN (LBL,DTA,DTAC),5,8,77,83,,,LAST               @Z498006
PPSAL48  FMTPTRN (LBL,DTA,DTAC),11,4,15,27,,,LAST       /*   @OZ16959*/
PPSAL200 FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),10,16,15,27,PSALBLS2,        X
               (FRRSTACK,0)
         FMTPTRN (DTA,DTAC),,16,,63
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST
PPSAL201 FMTPTRN (LBL,DTA,DTAC),4,16,15,27
         FMTPTRN (DTA,DTAC),,16,,63
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST
PPSAL202 FMTPTRN (LBL,DTA,DTAC),4,16,15,27
         FMTPTRN (DTA,DTAC),,16,,63
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST
PPSAL203 FMTPTRN (LBL,DTA,DTAC),4,16,15,27
         FMTPTRN (DTA,DTAC),,16,,63
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST
PPSAL204 FMTPTRN (LBL,DTA,DTAC),4,16,15,27
         FMTPTRN (DTA,DTAC),,16,,63
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST
PPSAL205 FMTPTRN (LBL,DTA,DTAC),4,16,15,27
         FMTPTRN (DTA,DTAC),,16,,63
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST
PPSAL206 FMTPTRN (LBL,DTA,DTAC),4,16,15,27
         FMTPTRN (DTA,DTAC),,16,,63
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST
PPSAL207 FMTPTRN (LBL,DTA,DTAC),4,16,15,27
         FMTPTRN (DTA,DTAC),,16,,63
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST
PPSAL208 FMTPTRN (LBL,DTA,DTAC),4,16,15,27
         FMTPTRN (DTA,DTAC),,16,,63                            @ZA02797
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST                      @ZA02797
PPSAL209 FMTPTRN (LBL,DTA,DTAC),4,16,15,27                     @ZA02797
         FMTPTRN (DTA,DTAC),,16,,63                            @ZA02797
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST                      @ZA02797
PPSAL210 FMTPTRN (LBL,DTA,DTAC),4,16,15,27                     @ZA02797
         FMTPTRN (DTA,DTAC),,16,,63                            @ZA02797
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST                      @ZA02797
PPSAL211 FMTPTRN (LBL,DTA,DTAC),4,16,15,27                     @ZA02797
         FMTPTRN (DTA,DTAC),,16,,63                            @ZA02797
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST                      @ZA02797
PPSAL212 FMTPTRN (LBL,DTA,DTAC),4,16,15,27                     @ZA02797
         FMTPTRN (DTA,DTAC),,16,,63                            @ZA02797
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST                      @ZA02797
PPSAL213 FMTPTRN (LBL,DTA,DTAC),4,16,15,27                     @ZA02797
         FMTPTRN (DTA,DTAC),,16,,63                            @ZA02797
         FMTPTRN (DTA,DTAC),,8,,99,,,LAST                      @ZA02797
PPSAL214 FMTPTRN (LBL,DTA,DTAC),4,16,15,27                     @ZA02797
         FMTPTRN (DTA,DTAC),,16,,63                            @ZA02797
         FMTPTRN (DTA,DTAC),,4,,99,,,LAST                      @ZA02797
AMDPRGCD CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCACNTRD EQU   @02
CCACNT0  EQU   @04
CPUADRCK EQU   @02
K        EQU   @03
I        EQU   @04
TABLPTR  EQU   @05
CTABLPTR EQU   @06
LTABLPTR EQU   @07
PCACPUAD EQU   @02
LCACPUAD EQU   @02
STATSPTR EQU   @02
R0       EQU   @00
R1       EQU   @01
R4       EQU   @04
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
COMBASE  EQU   @12
PREG     EQU   @01
BASE1    EQU   @11
BASE2    EQU   @10
BASE3    EQU   @09
BUFREG   EQU   @06
CNTREG   EQU   @03
LINEREG  EQU   @08
R10      EQU   @10
R11      EQU   @11
R12      EQU   @12
R2       EQU   @02
R3       EQU   @03
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
STOPBASE EQU   @05
CSD      EQU   0
CSDCPUAL EQU   CSD+8
CSDSCWRD EQU   CSD+12
CSDSCFL1 EQU   CSDSCWRD
CSDSCFL2 EQU   CSDSCWRD+1
CSDSCFL3 EQU   CSDSCWRD+2
CSDSCFL4 EQU   CSDSCWRD+3
CSDFLAGS EQU   CSD+23
LCCA     EQU   0
LCCACPUA EQU   LCCA+4
LCCAIHRC EQU   LCCA+520
LCCAIHR1 EQU   LCCAIHRC
LCCAIHR2 EQU   LCCAIHRC+1
LCCAIHR3 EQU   LCCAIHRC+2
LCCAIHR4 EQU   LCCAIHRC+3
LCCASPIN EQU   LCCA+524
LCCASPN1 EQU   LCCASPIN
LCCASPN2 EQU   LCCASPIN+1
LCCASPN3 EQU   LCCASPIN+2
LCCASPN4 EQU   LCCASPIN+3
LCCADSF1 EQU   LCCA+540
LCCADSF2 EQU   LCCA+541
LCCASPSA EQU   LCCA+544
LCCACRFL EQU   LCCA+692
LCCACREX EQU   LCCA+693
LCCALKFG EQU   LCCA+694
LCCASRBF EQU   LCCA+720
PCCA     EQU   0
PCCACPUA EQU   PCCA+16
PCCAPSAV EQU   PCCA+24
PCCATMST EQU   PCCA+128
PCCATMFL EQU   PCCATMST
PCCATODE EQU   PCCATMST+1
PCCACCE  EQU   PCCATMST+2
PCCAINTE EQU   PCCATMST+3
PCCAEMSB EQU   PCCA+136
PCCAEMSI EQU   PCCAEMSB
PCCARISP EQU   PCCAEMSI
PCCAEMS2 EQU   PCCAEMSI+1
PCCAEMS3 EQU   PCCAEMSI+2
PCCARMSB EQU   PCCAEMSI+3
PCCACHAN EQU   PCCA+224
PCCAWERP EQU   PCCA+280
PCCACHPF EQU   PCCAWERP+4
PCCACHBL EQU   PCCAWERP+5
PCCACHVA EQU   PCCAWERP+6
PCCACHTS EQU   PCCAWERP+7
PCCACHS1 EQU   PCCA+288
PCCACHS2 EQU   PCCA+289
PCCACHRB EQU   PCCA+290
PCCACHF1 EQU   PCCA+308
PCCACHF2 EQU   PCCA+309
PCCACHF3 EQU   PCCA+310
PCCACHF4 EQU   PCCA+311
PCCAATTR EQU   PCCA+376
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCCHNID EQU   FLCMCLA
FLCCHTM  EQU   FLCCHNID
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
PSAMEDC  EQU   FLCMCLA+76
FLCFSA   EQU   FLCMCLA+80
PSAPSA   EQU   PSA+512
PSACPULA EQU   PSA+518
PSAPCCAV EQU   PSA+520
PSALCCAV EQU   PSA+528
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSACPUSA EQU   PSA+794
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
PSAUSEND EQU   PSA+1048
PSASTAK  EQU   PSA+3072
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
COMMON   EQU   0
ERRADDR  EQU   COMMON
CURBUF   EQU   COMMON+48
CVTADDR  EQU   COMMON+56
SWA      EQU   COMMON+122
SWB      EQU   COMMON+123
IOERR    EQU   SWB
SWC      EQU   COMMON+124
SWD      EQU   COMMON+125
SWE      EQU   COMMON+126
SWF      EQU   COMMON+127
QSADMP   EQU   SWF
BUFSW    EQU   COMMON+128
PRSW     EQU   COMMON+129
TABLE    EQU   COMMON+659
HEXTABL  EQU   TABLE+63
EBCTABL  EQU   HEXTABL+10
AWRITE   EQU   COMMON+1500
AFMTLINE EQU   COMMON+1512
AADRCNVT EQU   COMMON+1516
STOPEXIT EQU   COMMON+1528
APCBENQ  EQU   COMMON+1560
APRTSTG  EQU   COMMON+1572
DCBADDRS EQU   COMMON+1608
@NM00071 EQU   DCBADDRS+16
@NM00072 EQU   @NM00071
IPLCPU   EQU   COMMON+1666
PREFXRGV EQU   COMMON+1676
BRRDDATA EQU   COMMON+1984
I3800SW  EQU   COMMON+2076
TITLEKEY EQU   COMMON+2077
AMDPRGFR EQU   0
GPCBENQ  EQU   0
AMDPRDPS EQU   0
ADRCNVT  EQU   0
CPUDATA  EQU   0
STATUS   EQU   CPUDATA
INVALID  EQU   STATUS
GPREGS   EQU   STATUS
FLOATREG EQU   CPUDATA+4
GENRLREG EQU   CPUDATA+36
CNTRLREG EQU   CPUDATA+100
STATPSW  EQU   CPUDATA+164
STATPRFX EQU   CPUDATA+172
STATIMER EQU   CPUDATA+176
STATCKCP EQU   CPUDATA+184
OUTPUT   EQU   0
BREADERR EQU   0
NEXTSTOP EQU   0
CPUTMPRY EQU   0
TEMPADDR EQU   0
TEMPADR1 EQU   TEMPADDR+1
CCAENTRY EQU   0
ENTRY1   EQU   CCAENTRY+1
REGENTRY EQU   0
TABINIT1 EQU   0
TABINIT2 EQU   0
VALIDCK  EQU   0
LCCAPTR1 EQU   LCCAPTR+1
PCCAPTR1 EQU   PCCAPTR+1
PSARSVTE EQU   PSARSVT
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTCSD   EQU   CVTS01+312
CVTPCCAT EQU   CVTS01+416
CVTLCCAT EQU   CVTS01+420
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
CPUADDR1 EQU   CPUADDR
FLC      EQU   PSA
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
@NM00087 EQU   PCCAPTR
@NM00086 EQU   LCCAPTR
@NM00093 EQU   CCAENTRY
@NM00092 EQU   TEMPADDR
@NM00091 EQU   CPUDATA+2
@NM00090 EQU   CPUDATA+1
@NM00089 EQU   STATUS
@NM00088 EQU   STATUS
Z9ERRID  EQU   COMMON+2116
Z9SUFLG  EQU   COMMON+2115
Z9SUBITS EQU   COMMON+2100
Z9SVCBUF EQU   COMMON+2096
TITLESTK EQU   TITLEKEY+12
@NM00082 EQU   TITLEKEY
I3800204 EQU   I3800SW
I380080  EQU   I3800SW
I3800ULN EQU   I3800SW
I3800KEY EQU   I3800SW
@NM00081 EQU   I3800SW
@NM00080 EQU   I3800SW
@NM00079 EQU   I3800SW
@NM00078 EQU   I3800SW
CSADDR   EQU   COMMON+2072
@NM00077 EQU   COMMON+2070
TOPICHDR EQU   COMMON+2060
DFLTCSA  EQU   COMMON+2056
LPAMAX   EQU   COMMON+2052
DNUCTOP  EQU   COMMON+2048
XLMAX    EQU   COMMON+2044
DQEMAX   EQU   COMMON+2042
ASCBMAX  EQU   COMMON+2040
TCBMAX   EQU   COMMON+2038
SRBMAX   EQU   COMMON+2036
DDMAX    EQU   COMMON+2034
DEBMAX   EQU   COMMON+2032
JPQMAX   EQU   COMMON+2030
LLEMAX   EQU   COMMON+2028
PQEMAX   EQU   COMMON+2026
RBMAX    EQU   COMMON+2024
@NM00076 EQU   COMMON+2023
EXITFLAG EQU   COMMON+2022
AUSRASID EQU   COMMON+2020
AUSRTCBA EQU   COMMON+2016
AUSRDEL  EQU   COMMON+2012
AUSREXIT EQU   COMMON+2008
AUSRINIT EQU   COMMON+2004
ASRBFMT  EQU   COMMON+2000
AASCBFMT EQU   COMMON+1996
BRRDADJ  EQU   COMMON+1992
BRRDINIT EQU   COMMON+1988
BUFERMAP EQU   COMMON+1980
ASCBMAP  EQU   COMMON+1976
CPUMAP   EQU   COMMON+1972
ASIDNDX  EQU   COMMON+1968
@NM00075 EQU   COMMON+1964
HDRTITLE EQU   COMMON+1864
HDRREGS  EQU   COMMON+1696
SACSWCAW EQU   COMMON+1684
ASVTADDR EQU   COMMON+1680
PREFXRGR EQU   COMMON+1672
CURASCB  EQU   COMMON+1668
QASID    EQU   COMMON+1664
QAPFT    EQU   COMMON+1660
@NM00074 EQU   COMMON+1656
REALMAX  EQU   COMMON+1652
SEGTABOR EQU   COMMON+1648
REALMAP  EQU   COMMON+1644
@NM00073 EQU   COMMON+1641
EDITER   EQU   COMMON+1640
AROOT    EQU   COMMON+1636
AEDITCB  EQU   COMMON+1632
TRCCOUNT EQU   COMMON+1628
ASYSUDCB EQU   @NM00071+1
ENDLIST  EQU   @NM00072
AINDCB   EQU   DCBADDRS+12
ARDRDCB  EQU   DCBADDRS+8
APTRDCB  EQU   DCBADDRS+4
AOUTDCB  EQU   DCBADDRS
ATCBSMRY EQU   COMMON+1604
ATCBSMFR EQU   COMMON+1600
ONGOPTR  EQU   COMMON+1596
AEND     EQU   COMMON+1592
AERRMSGA EQU   COMMON+1584
BUFREINT EQU   COMMON+1580
BUFSUM   EQU   COMMON+1576
AFORMAT  EQU   COMMON+1568
ASTPROUT EQU   COMMON+1564
ATCBRTRV EQU   COMMON+1556
ATCBREMV EQU   COMMON+1552
ATCBSAVE EQU   COMMON+1548
QATMERTN EQU   COMMON+1544
ALOADER  EQU   COMMON+1540
AEREXIT  EQU   COMMON+1536
SYNMSGA  EQU   COMMON+1532
ARGNBND  EQU   COMMON+1524
AWRDCNVT EQU   COMMON+1520
ASYNTAX  EQU   COMMON+1508
APRTMSG  EQU   COMMON+1504
NONBLNK  EQU   COMMON+1244
BLNK     EQU   COMMON+988
@NM00070 EQU   COMMON+972
@NM00069 EQU   COMMON+915
@NM00068 EQU   HEXTABL
@NM00067 EQU   TABLE
CAPTABL  EQU   COMMON+403
TITLEPGE EQU   COMMON+394
@NM00066 EQU   COMMON+392
TITLETME EQU   COMMON+379
@NM00065 EQU   COMMON+377
TITLEDTE EQU   COMMON+364
@NM00064 EQU   COMMON+362
TITLEMOD EQU   COMMON+347
TITLEMSG EQU   COMMON+283
MSG2     EQU   COMMON+257
MSG1     EQU   COMMON+231
STOP     EQU   COMMON+227
TITLE    EQU   COMMON+222
BLANKS   EQU   COMMON+214
WTORMSG  EQU   COMMON+133
@NM00063 EQU   COMMON+130
@NM00062 EQU   PRSW
@NM00061 EQU   PRSW
PRNTREAL EQU   PRSW
PRNTRL   EQU   PRSW
TTLSW    EQU   PRSW
@NM00060 EQU   PRSW
QSEGTBSW EQU   PRSW
@NM00059 EQU   PRSW
@NM00058 EQU   BUFSW
PREFM    EQU   BUFSW
@NM00057 EQU   BUFSW
@NM00056 EQU   BUFSW
@NM00055 EQU   BUFSW
@NM00054 EQU   BUFSW
@NM00053 EQU   BUFSW
@NM00052 EQU   BUFSW
@NM00051 EQU   SWF
QUT1LOD  EQU   SWF
@NM00050 EQU   SWF
PAGEOK   EQU   SWF
DMPIC    EQU   SWF
NUCTFRMC EQU   SWF
QPRDINIT EQU   SWF
@NM00049 EQU   SWE
@NM00048 EQU   SWE
@NM00047 EQU   SWE
BUILDMAP EQU   SWE
TITLESW  EQU   SWE
RESPC    EQU   SWE
@NM00046 EQU   SWE
STOPSW   EQU   SWE
@NM00045 EQU   SWD
GPRSFND  EQU   SWD
CONTSW   EQU   SWD
NOLOADSW EQU   SWD
NOSTDMG  EQU   SWD
@NM00044 EQU   SWD
@NM00043 EQU   SWD
FLSHMODE EQU   SWD
@NM00042 EQU   SWC
@NM00041 EQU   SWC
SEGRD    EQU   SWC
EDITSW   EQU   SWC
TREADIN  EQU   SWC
POSITSW  EQU   SWC
SETFLSH  EQU   SWC
MSTRSW   EQU   SWC
@NM00040 EQU   SWB
@NM00039 EQU   SWB
QSYSUT2  EQU   SWB
ENDSW    EQU   SWB
@NM00038 EQU   SWB
@NM00037 EQU   SWB
FMTERR   EQU   SWB
RDRSW    EQU   SWA
SETCVTSW EQU   SWA
@NM00036 EQU   SWA
GOSW     EQU   SWA
@NM00035 EQU   SWA
@NM00034 EQU   SWA
@NM00033 EQU   SWA
@NM00032 EQU   SWA
LINENUM  EQU   COMMON+120
LINENUMB EQU   COMMON+118
SIXTEEN  EQU   COMMON+116
TWELVE   EQU   COMMON+114
ELEVEN   EQU   COMMON+112
HTEN     EQU   COMMON+110
EIGHT    EQU   COMMON+108
SEVEN    EQU   COMMON+106
FIVE     EQU   COMMON+104
FOUR     EQU   COMMON+102
THREE    EQU   COMMON+100
TWO      EQU   COMMON+98
ONEA     EQU   COMMON+96
READTM   EQU   COMMON+92
RDERCNT  EQU   COMMON+88
READNO   EQU   COMMON+84
RDENTRY  EQU   COMMON+80
@NM00031 EQU   COMMON+79
RETCODE  EQU   COMMON+78
FILESEQ  EQU   COMMON+76
INDD     EQU   COMMON+68
STORSIZE EQU   COMMON+64
PCBPTR   EQU   COMMON+60
TCBLIST  EQU   COMMON+52
PAGENUMB EQU   COMMON+44
LINECNT  EQU   COMMON+40
SIX      EQU   COMMON+36
NUCTOP   EQU   COMMON+32
WORK1    EQU   COMMON+24
DELIMCD  EQU   COMMON+20
KYWDEND  EQU   COMMON+16
KYWDBGN  EQU   COMMON+12
VERBEND  EQU   COMMON+8
VERBGN   EQU   COMMON+4
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00030 EQU   CVTFIX+248
@NM00029 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTBAH   EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTVS1A  EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
@NM00028 EQU   PSA+3668
@NM00027 EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSAACTCD EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSALITA  EQU   PSA+764
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00026 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00025 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSARV013 EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSAPCCAR EQU   PSA+524
PSACPUPA EQU   PSA+516
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00024 EQU   FLCFSA
@NM00023 EQU   FLCMCLA+77
PSAMDISC EQU   PSAMEDC
PSAMINTR EQU   PSAMEDC
PSAMINST EQU   PSAMEDC
PSAMCCF  EQU   PSAMEDC
PSAMCNOP EQU   PSAMEDC
PSAMEXSR EQU   PSAMEDC
PSAMCOPR EQU   PSAMEDC
@NM00022 EQU   PSAMEDC
@NM00021 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00020 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00019 EQU   FLCIOA
@NM00018 EQU   FLCMCLA+15
@NM00017 EQU   FLCMCLA+14
@NM00016 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00015 EQU   FLCIOEL
FLCCHIL  EQU   FLCCHNID+2
FLCCHMOD EQU   FLCCHTM
FLCCHTYP EQU   FLCCHTM
@NM00014 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00013 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00012 EQU   FLCPER
@NM00011 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00010 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00009 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00008 EQU   FLCPIILC
@NM00007 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00006 EQU   FLCSVILC
@NM00005 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00004 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00003 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
@NM00002 EQU   PCCA+512
PCCACAT  EQU   PCCA+384
PCCARV36 EQU   PCCA+380
PCCARV35 EQU   PCCA+378
PCCARV01 EQU   PCCA+377
PCCAR105 EQU   PCCAATTR
PCCAR104 EQU   PCCAATTR
PCCAR103 EQU   PCCAATTR
PCCAR102 EQU   PCCAATTR
PCCAR101 EQU   PCCAATTR
PCCAR100 EQU   PCCAATTR
PCCAIO   EQU   PCCAATTR
PCCACPUM EQU   PCCAATTR
PCCARV63 EQU   PCCA+372
PCCARV62 EQU   PCCA+368
PCCARV61 EQU   PCCA+364
PCCARV60 EQU   PCCA+360
PCCARV59 EQU   PCCA+356
PCCARV58 EQU   PCCA+352
PCCARV57 EQU   PCCA+348
PCCARV56 EQU   PCCA+344
PCCARV55 EQU   PCCA+340
PCCARV54 EQU   PCCA+336
PCCALOGA EQU   PCCA+332
PCCACHID EQU   PCCA+324
PCCACHSV EQU   PCCA+312
PCCARV79 EQU   PCCACHF4
PCCARV78 EQU   PCCACHF4
PCCARV77 EQU   PCCACHF4
PCCARV76 EQU   PCCACHF4
PCCARV75 EQU   PCCACHF4
PCCARV74 EQU   PCCACHF4
PCCARV73 EQU   PCCACHF4
PCCARV72 EQU   PCCACHF4
PCCARV71 EQU   PCCACHF3
PCCARV70 EQU   PCCACHF3
PCCARV69 EQU   PCCACHF3
PCCARV68 EQU   PCCACHF3
PCCARV67 EQU   PCCACHF3
PCCARV66 EQU   PCCACHF3
PCCASLCK EQU   PCCACHF3
PCCAISRB EQU   PCCACHF3
PCCACF28 EQU   PCCACHF2
PCCACF27 EQU   PCCACHF2
PCCACF26 EQU   PCCACHF2
PCCACF25 EQU   PCCACHF2
PCCACF24 EQU   PCCACHF2
PCCACF23 EQU   PCCACHF2
PCCACF22 EQU   PCCACHF2
PCCACF21 EQU   PCCACHF2
PCCACF18 EQU   PCCACHF1
PCCACF17 EQU   PCCACHF1
PCCACF16 EQU   PCCACHF1
PCCACF15 EQU   PCCACHF1
PCCACF14 EQU   PCCACHF1
PCCACF13 EQU   PCCACHF1
PCCACF12 EQU   PCCACHF1
PCCACF11 EQU   PCCACHF1
PCCARV05 EQU   PCCA+307
PCCACHPB EQU   PCCA+306
PCCALGP2 EQU   PCCA+305
PCCALGP1 EQU   PCCA+304
PCCACELL EQU   PCCA+302
PCCALOGL EQU   PCCA+300
PCCACHW2 EQU   PCCA+296
PCCACHW1 EQU   PCCA+292
PCCAIOSI EQU   PCCA+291
PCCACNRB EQU   PCCACHRB
PCCACCVB EQU   PCCACHRB
PCCACSNB EQU   PCCACHRB
PCCARV52 EQU   PCCACHRB
PCCACHIB EQU   PCCACHRB
PCCACTIB EQU   PCCACHRB
PCCACINB EQU   PCCACHRB
PCCACSIB EQU   PCCACHRB
PCCARV51 EQU   PCCACHS2
PCCARV50 EQU   PCCACHS2
PCCACCRA EQU   PCCACHS2
PCCACURC EQU   PCCACHS2
PCCACNLG EQU   PCCACHS2
PCCACMOD EQU   PCCACHS2
PCCACALT EQU   PCCACHS2
PCCACIOR EQU   PCCACHS2
PCCARV47 EQU   PCCACHS1
PCCACUCB EQU   PCCACHS1
PCCACIBC EQU   PCCACHS1
PCCACAND EQU   PCCACHS1
PCCACNLS EQU   PCCACHS1
PCCACFRR EQU   PCCACHS1
PCCACNRE EQU   PCCACHS1
PCCACCMP EQU   PCCACHS1
PCCACSEQ EQU   PCCACHTS
PCCACDIN EQU   PCCACHTS
PCCARV44 EQU   PCCACHTS
PCCARV43 EQU   PCCACHTS
PCCACTEC EQU   PCCACHTS
PCCACDAV EQU   PCCACHVA
PCCACCHV EQU   PCCACHVA
PCCACCMD EQU   PCCACHVA
PCCACUNS EQU   PCCACHVA
PCCACSQV EQU   PCCACHVA
PCCARV42 EQU   PCCACHVA
PCCARV41 EQU   PCCACHVA
PCCACITF EQU   PCCACHVA
PCCARV40 EQU   PCCACHBL
PCCARV39 EQU   PCCACHBL
PCCARV38 EQU   PCCACHBL
PCCACCUE EQU   PCCACHBL
PCCACSTG EQU   PCCACHBL
PCCACSCU EQU   PCCACHBL
PCCACCHA EQU   PCCACHBL
PCCACCPU EQU   PCCACHBL
PCCACNOR EQU   PCCACHPF
PCCACCNT EQU   PCCACHPF
PCCACSNS EQU   PCCACHPF
PCCARV37 EQU   PCCACHPF
PCCACHIO EQU   PCCACHPF
PCCACTIO EQU   PCCACHPF
PCCACINT EQU   PCCACHPF
PCCACSIO EQU   PCCACHPF
PCCACHUB EQU   PCCAWERP
PCCAR106 EQU   PCCA+228
PCCAR113 EQU   PCCA+226
PCCASRBL EQU   PCCA+225
PCCAR112 EQU   PCCACHAN
PCCAR111 EQU   PCCACHAN
PCCAR110 EQU   PCCACHAN
PCCAR109 EQU   PCCACHAN
PCCAR108 EQU   PCCACHAN
PCCAR107 EQU   PCCACHAN
PCCAEXDM EQU   PCCACHAN
PCCAIRST EQU   PCCACHAN
PCCASRB  EQU   PCCA+180
PCCACCHM EQU   PCCA+176
PCCAELBA EQU   PCCA+172
PCCAELAD EQU   PCCA+168
PCCALRBR EQU   PCCA+164
PCCALRBV EQU   PCCA+160
PCCAPWAR EQU   PCCA+156
PCCAPWAV EQU   PCCA+152
PCCAEMSA EQU   PCCAEMSB+12
PCCAEMSE EQU   PCCAEMSB+8
PCCAEMSP EQU   PCCAEMSB+4
PCCARMS  EQU   PCCARMSB
PCCARV34 EQU   PCCARMSB
PCCARV33 EQU   PCCARMSB
PCCARV32 EQU   PCCARMSB
PCCARV31 EQU   PCCARMSB
PCCARV30 EQU   PCCARMSB
PCCARV29 EQU   PCCARMSB
PCCARV28 EQU   PCCARMSB
PCCARV27 EQU   PCCAEMS3
PCCARV26 EQU   PCCAEMS3
PCCARV25 EQU   PCCAEMS3
PCCARV24 EQU   PCCAEMS3
PCCARV23 EQU   PCCAEMS3
PCCARV22 EQU   PCCAEMS3
PCCARV21 EQU   PCCAEMS3
PCCARV20 EQU   PCCAEMS3
PCCARV19 EQU   PCCAEMS2
PCCARV18 EQU   PCCAEMS2
PCCARV17 EQU   PCCAEMS2
PCCARV16 EQU   PCCAEMS2
PCCARV15 EQU   PCCAEMS2
PCCARV14 EQU   PCCAEMS2
PCCARV13 EQU   PCCAEMS2
PCCARV12 EQU   PCCAEMS2
PCCARV11 EQU   PCCARISP
PCCARV10 EQU   PCCARISP
PCCARV09 EQU   PCCARISP
PCCARV08 EQU   PCCARISP
PCCARV07 EQU   PCCARISP
PCCARV06 EQU   PCCARISP
PCCASERL EQU   PCCARISP
PCCAPARL EQU   PCCARISP
PCCARPB  EQU   PCCA+132
PCCACTIN EQU   PCCAINTE
PCCANFIN EQU   PCCAINTE
PCCANUIN EQU   PCCAINTE
PCCACTCC EQU   PCCACCE
PCCANFCC EQU   PCCACCE
PCCANUCC EQU   PCCACCE
PCCACTTD EQU   PCCATODE
PCCANFTD EQU   PCCATODE
PCCANUTD EQU   PCCATODE
PCCARV04 EQU   PCCATMFL
PCCARV03 EQU   PCCATMFL
PCCARV02 EQU   PCCATMFL
PCCAMINT EQU   PCCATMFL
PCCAMCC  EQU   PCCATMFL
PCCAVKIL EQU   PCCATMFL
PCCASYNC EQU   PCCATMFL
PCCAINIT EQU   PCCATMFL
PCCARV9E EQU   PCCA+124
PCCARV9D EQU   PCCA+120
PCCARV9C EQU   PCCA+116
PCCARV9B EQU   PCCA+112
PCCARV9A EQU   PCCA+108
PCCARV99 EQU   PCCA+104
PCCARV98 EQU   PCCA+100
PCCARV97 EQU   PCCA+96
PCCARV96 EQU   PCCA+92
PCCARV95 EQU   PCCA+88
PCCARV94 EQU   PCCA+84
PCCARV93 EQU   PCCA+80
PCCARV92 EQU   PCCA+76
PCCARV91 EQU   PCCA+72
PCCARV90 EQU   PCCA+68
PCCARV89 EQU   PCCA+64
PCCARV88 EQU   PCCA+60
PCCARV87 EQU   PCCA+56
PCCARV86 EQU   PCCA+52
PCCARV85 EQU   PCCA+48
PCCARV84 EQU   PCCA+44
PCCARV83 EQU   PCCA+40
PCCARV82 EQU   PCCA+36
PCCARV81 EQU   PCCA+32
PCCAPSAR EQU   PCCA+28
PCCATQEP EQU   PCCA+20
PCCACAFM EQU   PCCA+18
PCCACPID EQU   PCCA+4
PCCAPCCA EQU   PCCA
LCCAR125 EQU   LCCA+964
LCCAR124 EQU   LCCA+960
LCCASGPR EQU   LCCA+896
LCCADRT2 EQU   LCCA+888
LCCADRT1 EQU   LCCA+880
LCCAR103 EQU   LCCA+876
LCCAESS2 EQU   LCCA+872
LCCASPLJ EQU   LCCA+868
LCCASMQJ EQU   LCCA+864
LCCAIRT  EQU   LCCA+736
LCCAASID EQU   LCCA+732
LCCARV89 EQU   LCCA+728
LCCAPGTA EQU   LCCASRBF+2
LCCASAFN EQU   LCCASRBF
LCCAECSA EQU   LCCA+716
LCCAICR0 EQU   LCCA+712
LCCALWTM EQU   LCCA+704
LCCARV78 EQU   LCCA+700
LCCAPINV EQU   LCCA+696
LCCARV88 EQU   LCCA+695
LCCARV87 EQU   LCCALKFG
LCCARV86 EQU   LCCALKFG
LCCARV85 EQU   LCCALKFG
LCCARV84 EQU   LCCALKFG
LCCALKRD EQU   LCCALKFG
LCCALKAQ EQU   LCCALKFG
LCCALKSA EQU   LCCALKFG
LCCALKDP EQU   LCCALKFG
LCCACRST EQU   LCCACREX
LCCACRDP EQU   LCCACREX
LCCACRLM EQU   LCCACREX
LCCACRIN EQU   LCCACREX
LCCACRRT EQU   LCCACREX
LCCACRLE EQU   LCCACREX
LCCACRRM EQU   LCCACREX
LCCACREF EQU   LCCACREX
LCCAVARY EQU   LCCACRFL
LCCARV73 EQU   LCCACRFL
LCCARV72 EQU   LCCACRFL
LCCARV71 EQU   LCCACRFL
LCCARV70 EQU   LCCACRFL
LCCARV69 EQU   LCCACRFL
LCCACLMS EQU   LCCACRFL
LCCACRTM EQU   LCCACRFL
LCCALCR0 EQU   LCCA+688
LCCACRLC EQU   LCCA+684
LCCARCPU EQU   LCCA+680
LCCADCPU EQU   LCCA+676
LCCASRBJ EQU   LCCA+672
LCCADSSR EQU   LCCA+668
LCCADSSC EQU   LCCA+660
LCCADSS3 EQU   LCCA+648
LCCADSS2 EQU   LCCA+636
LCCADSS1 EQU   LCCA+624
LCCAWTIM EQU   LCCA+616
LCCAITOD EQU   LCCA+608
LCCADTOD EQU   LCCA+600
LCCASTOD EQU   LCCA+592
LCCARIR5 EQU   LCCASPSA+44
LCCARIR4 EQU   LCCASPSA+40
LCCARIR3 EQU   LCCASPSA+36
LCCARIR2 EQU   LCCASPSA+32
LCCARPR5 EQU   LCCASPSA+28
LCCARPR4 EQU   LCCASPSA+24
LCCARPR3 EQU   LCCASPSA+20
LCCARPR2 EQU   LCCASPSA+16
LCCADSR5 EQU   LCCASPSA+12
LCCADSR4 EQU   LCCASPSA+8
LCCADSR3 EQU   LCCASPSA+4
LCCADSR2 EQU   LCCASPSA
LCCARV68 EQU   LCCA+543
LCCAPSMK EQU   LCCA+542
LCCARV67 EQU   LCCADSF2
LCCARV66 EQU   LCCADSF2
LCCARV65 EQU   LCCADSF2
LCCARV64 EQU   LCCADSF2
LCCADSRW EQU   LCCADSF2
LCCADSPL EQU   LCCADSF2
LCCAGSRB EQU   LCCADSF2
LCCASRBM EQU   LCCADSF2
LCCARV61 EQU   LCCADSF1
LCCARV60 EQU   LCCADSF1
LCCARV59 EQU   LCCADSF1
LCCARV58 EQU   LCCADSF1
LCCATIMR EQU   LCCADSF1
LCCADSS  EQU   LCCADSF1
LCCAVCPU EQU   LCCADSF1
LCCAACR  EQU   LCCADSF1
LCCACPUS EQU   LCCA+536
LCCAASCP EQU   LCCA+532
LCCAESSA EQU   LCCA+528
LCCARV55 EQU   LCCASPN4
LCCARV54 EQU   LCCASPN4
LCCARV53 EQU   LCCASPN4
LCCARV52 EQU   LCCASPN4
LCCARV51 EQU   LCCASPN4
LCCARV50 EQU   LCCASPN4
LCCARV49 EQU   LCCASPN4
LCCARV48 EQU   LCCASPN4
LCCARV47 EQU   LCCASPN3
LCCARV46 EQU   LCCASPN3
LCCARV45 EQU   LCCASPN3
LCCARV44 EQU   LCCASPN3
LCCARV43 EQU   LCCASPN3
LCCARV42 EQU   LCCASPN3
LCCARV41 EQU   LCCASPN3
LCCARV40 EQU   LCCASPN3
LCCARV39 EQU   LCCASPN2
LCCARV38 EQU   LCCASPN2
LCCARV37 EQU   LCCASPN2
LCCARV36 EQU   LCCASPN2
LCCARV35 EQU   LCCASPN2
LCCARV34 EQU   LCCASPN2
LCCARV33 EQU   LCCASPN2
LCCARV32 EQU   LCCASPN2
LCCARV31 EQU   LCCASPN1
LCCARV30 EQU   LCCASPN1
LCCAMFIO EQU   LCCASPN1
LCCARSTR EQU   LCCASPN1
LCCATSPN EQU   LCCASPN1
LCCALOCK EQU   LCCASPN1
LCCASIGP EQU   LCCASPN1
LCCAPTLB EQU   LCCASPN1
LCCARV27 EQU   LCCAIHR4
LCCARV26 EQU   LCCAIHR4
LCCARV25 EQU   LCCAIHR4
LCCARV24 EQU   LCCAIHR4
LCCARV23 EQU   LCCAIHR4
LCCARV22 EQU   LCCAIHR4
LCCARV21 EQU   LCCAIHR4
LCCARV20 EQU   LCCAIHR4
LCCARV19 EQU   LCCAIHR3
LCCARV18 EQU   LCCAIHR3
LCCARV17 EQU   LCCAIHR3
LCCARV16 EQU   LCCAIHR3
LCCARV15 EQU   LCCAIHR3
LCCARV14 EQU   LCCAIHR3
LCCARV13 EQU   LCCAIHR3
LCCARV12 EQU   LCCAIHR3
LCCARV11 EQU   LCCAIHR2
LCCARV10 EQU   LCCAIHR2
LCCARV09 EQU   LCCAIHR2
LCCARV08 EQU   LCCAIHR2
LCCARV07 EQU   LCCAIHR2
LCCARV06 EQU   LCCAIHR2
LCCARV05 EQU   LCCAIHR2
LCCARV04 EQU   LCCAIHR2
LCCARV03 EQU   LCCAIHR1
LCCARV02 EQU   LCCAIHR1
LCCARV01 EQU   LCCAIHR1
LCCAPPIE EQU   LCCAIHR1
LCCAPSG1 EQU   LCCAIHR1
LCCAPDAT EQU   LCCAIHR1
LCCAXRC2 EQU   LCCAIHR1
LCCAXRC1 EQU   LCCAIHR1
LCCAIOPS EQU   LCCA+512
LCCAGPGR EQU   LCCA+448
LCCAR133 EQU   LCCA+444
LCCAR132 EQU   LCCA+440
LCCAR131 EQU   LCCA+436
LCCAR130 EQU   LCCA+432
LCCAR129 EQU   LCCA+428
LCCAR128 EQU   LCCA+424
LCCAR127 EQU   LCCA+420
LCCAR126 EQU   LCCA+416
LCCARSGR EQU   LCCA+352
LCCAXGR3 EQU   LCCA+288
LCCAXGR2 EQU   LCCA+224
LCCAXGR1 EQU   LCCA+160
LCCACR0  EQU   LCCA+156
LCCAMCR1 EQU   LCCA+152
LCCAPVAD EQU   LCCA+148
LCCAPINT EQU   LCCA+144
LCCAPPSW EQU   LCCA+136
LCCAPGR2 EQU   LCCA+72
LCCAPGR1 EQU   LCCA+8
LCCARV77 EQU   LCCA+6
LCCALCCA EQU   LCCA
@NM00001 EQU   CSD+160
CSDMASK  EQU   CSD+128
CSDUCNT  EQU   CSD+124
CSDTCNT  EQU   CSD+120
CSDGDTOD EQU   CSD+116
CSDGDINT EQU   CSD+112
CSDGDCC  EQU   CSD+108
CSDDDRCT EQU   CSD+106
CSDRV044 EQU   CSD+104
CSDMAFF  EQU   CSD+24
CSDRV038 EQU   CSDFLAGS
CSDRV037 EQU   CSDFLAGS
CSDRV036 EQU   CSDFLAGS
CSDRV035 EQU   CSDFLAGS
CSDRV034 EQU   CSDFLAGS
CSDRV033 EQU   CSDFLAGS
CSDRV032 EQU   CSDFLAGS
CSDMP    EQU   CSDFLAGS
CSDACR   EQU   CSD+22
CSDMF1CP EQU   CSD+20
CSDRV043 EQU   CSD+16
CSDRV030 EQU   CSDSCFL4
CSDRV029 EQU   CSDSCFL4
CSDRV028 EQU   CSDSCFL4
CSDRV027 EQU   CSDSCFL4
CSDRV026 EQU   CSDSCFL4
CSDRV025 EQU   CSDSCFL4
CSDRV024 EQU   CSDSCFL4
CSDRV023 EQU   CSDSCFL4
CSDRV022 EQU   CSDSCFL3
CSDRV021 EQU   CSDSCFL3
CSDRV020 EQU   CSDSCFL3
CSDRV019 EQU   CSDSCFL3
CSDRV018 EQU   CSDSCFL3
CSDRV017 EQU   CSDSCFL3
CSDRV016 EQU   CSDSCFL3
CSDRV015 EQU   CSDSCFL3
CSDRV014 EQU   CSDSCFL2
CSDRV013 EQU   CSDSCFL2
CSDRV012 EQU   CSDSCFL2
CSDRV011 EQU   CSDSCFL2
CSDRV010 EQU   CSDSCFL2
CSDRV009 EQU   CSDSCFL2
CSDRV008 EQU   CSDSCFL2
CSDRV007 EQU   CSDSCFL2
CSDRV006 EQU   CSDSCFL1
CSDRV005 EQU   CSDSCFL1
CSDRV004 EQU   CSDSCFL1
CSDRV003 EQU   CSDSCFL1
CSDRV002 EQU   CSDSCFL1
CSDRV001 EQU   CSDSCFL1
CSDSYSND EQU   CSDSCFL1
CSDRV042 EQU   CSDSCFL1
CSDCPUOL EQU   CSD+10
CSDSAFF  EQU   CSDCPUAL
CSDCHAD  EQU   CSD+6
CSDCPUJS EQU   CSD+4
CSDCSD   EQU   CSD
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00346 EQU   CSDEXIT
@RT00424 EQU   LTABSCH2
@RF00424 EQU   LCCAOUT
@RT00429 EQU   LCAVALID
@RT00445 EQU   LPTRESET
@RT00465 EQU   LTABSRCH
@RF00465 EQU   LCCAOUT
@RF00468 EQU   LCCAOUT
@RT00496 EQU   LTABSCH2
@RF00496 EQU   LCCAOUT
@RT00521 EQU   PTABSCH2
@RF00521 EQU   SADSWCK3
@RT00526 EQU   PCAVALID
@RT00541 EQU   PPTRESET
@RT00561 EQU   PTABSRCH
@RF00561 EQU   SADSWCK3
@RC00564 EQU   SADSWCK1
@RC00602 EQU   SADSWCK1
@RF00609 EQU   SADSWCK1
@RT00618 EQU   PTABSCH2
@RF00618 EQU   SADSWCK3
@RF00641 EQU   SADMPOUT
@RF00711 EQU   NXTGROUP
@RT00787 EQU   SADSWCK2
@RT00790 EQU   GETSTAUS
@RF00790 EQU   TABLSRCH
@RF00803 EQU   TABLSRCH
@RC00828 EQU   TABLSRCH
@RC00750 EQU   @RC00747
@RT00884 EQU   GCDEXIT
@RF00887 EQU   GCDEXIT
@RT00902 EQU   GCDEXIT
@RC00906 EQU   BNDRYOUT
@RF00947 EQU   @EL00001
@RC00979 EQU   @EL00002
@RF00993 EQU   @EL00002
@RF01059 EQU   @EL00004
@RC01075 EQU   @RC01071
@RC01118 EQU   @EL00006
@RF01191 EQU   @EL00006
@RC01341 EQU   @EL00008
@RC01350 EQU   @EL00008
@RC01372 EQU   PSAREAD2
@RC01378 EQU   PSAREAD2
@RT01429 EQU   GOFORMAT
@RF01427 EQU   NEXTVALU
@RC01422 EQU   @EL00009
@RC01472 EQU   @EL00010
@RF01510 EQU   @EL00010
@RT01516 EQU   @EL00010
@RC01541 EQU   @EL00012
@RF00586 EQU   @RC00564
@RF00594 EQU   @RC00564
@RC00752 EQU   @RC00750
@RC01474 EQU   @RC01472
@RC01543 EQU   @RC01541
@ENDDATA EQU   *
         END   AMDPRGCD,(C'PLS1747',0701,77136)

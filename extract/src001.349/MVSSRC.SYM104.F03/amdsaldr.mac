         TITLE 'AMDSALDR, LOADER MAKER PROGRAM FOR AMDSADMP            *
                       '
AMDSALDR CSECT ,                                                   0001
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @12,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@12                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*                                                                  0051
*/********************************************************************/
*/*                                                                  */
*/*                 BEGINNING OF AMDSALDR PROCESSING                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0052
*   PLISTPTR=PLISTADR;              /* INIT PTR TO PARMLST           */
         L     PLISTPTR,PLISTADR(,PARMGR1)                         0052
         LA    PLISTPTR,0(,PLISTPTR)                               0052
*   OTBUFADD=0;                     /* ZERO OUTPUT BUF PTR           */
         SLR   @10,@10                                             0053
         ST    @10,OTBUFADD                                        0053
*   INBUFADD=0;                     /* ZERO INPUT BUF PTR            */
*                                                                  0054
         ST    @10,INBUFADD                                        0054
*/********************************************************************/
*/*                                                                  */
*/*            OPEN SYSUT1, SYSUT3, AND SYSPRINT DCB'S               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0055
*   DCBPTR=ADDR(SYS3DCB);           /* POINT TO SYSUT3 DCB           */
         LA    DCBPTR,SYS3DCB                                      0055
*   DCBBLKSI=OTBUFSIZ/2;            /* INIT SYSUT3 BLKSIZE           */
         L     @06,OTBUFSIZ                                        0056
         SRDA  @06,32                                              0056
         D     @06,@CF00185                                        0056
         STH   @07,DCBBLKSI+62(,DCBPTR)                            0056
*   GENERATE;                       /* OPEN THE DCB'S                */
*                                                                  0057
      OPEN (PRINTDCB,(OUTPUT),SYS1DCB,(INPUT),SYS3DCB,(OUTPUT))
*/********************************************************************/
*/*                                                                  */
*/*                CHECK IF SYSPRINT OPENED SUCCESSFULLY             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0058
*   DCBPTR=ADDR(PRINTDCB);          /* POINT TO SYSPRINT DCB         */
         LA    DCBPTR,PRINTDCB                                     0058
*   IF (DCBOFLGS & '10'X)= 0 THEN      /* TEST OPEN FLAG             */
         SLR   @10,@10                                             0059
         LA    @09,16                                              0059
         LA    @15,48                                              0059
         LR    @14,DCBPTR                                          0059
         AR    @14,@15                                             0059
         SLR   @00,@00                                             0059
         IC    @00,DCBOFLGS(,@14)                                  0059
         NR    @00,@09                                             0059
         CR    @00,@10                                             0059
         BE    @RT00059                                            0059
*     GOTO AMD035I;                 /* NOT OPEN -- WRITE ERR MSG     */
*                                                                  0060
*/********************************************************************/
*/*                                                                  */
*/*                CHECK IF SYSUT1 OPENED SUCCESSFULLY               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0061
*   DCBPTR=ADDR(SYS1DCB);           /* POINT TO SYSUT1 DCB           */
         LA    DCBPTR,SYS1DCB                                      0061
*   IF (DCBOFLGS & '10'X)= 0 THEN      /* TEST OPEN FLAG             */
         LR    @14,DCBPTR                                          0062
         AR    @14,@15                                             0062
         SLR   @00,@00                                             0062
         IC    @00,DCBOFLGS(,@14)                                  0062
         NR    @00,@09                                             0062
         CR    @00,@10                                             0062
         BE    @RT00062                                            0062
*     GOTO AMD035I;                 /* NOT OPEN -- WRITE ERR MSG     */
*                                                                  0063
*/********************************************************************/
*/*                                                                  */
*/*                CHECK IF SYSUT3 OPENED SUCCESSFULLY               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0064
*   DCBPTR=ADDR(SYS3DCB);           /* POINT TO SYSUT3 DCB           */
         LA    DCBPTR,SYS3DCB                                      0064
*   IF (DCBOFLGS & '10'X) = 0 THEN      /* TEST OPEN FLAG            */
         AR    @15,DCBPTR                                          0065
         MVC   @ZT00003+3(1),DCBOFLGS(@15)                         0065
         N     @09,@ZT00003                                        0065
         CR    @09,@10                                             0065
         BE    @RT00065                                            0065
*     GOTO AMD035I;                 /* NOT OPEN -- WRITE ERR MSG     */
*                                                                  0066
*/********************************************************************/
*/*                                                                  */
*/*        PROCESS THE PARM= PARAMETERS FROM THE EXEC STATEMENT      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0067
*   IF PLISTLNG ^= 15 THEN          /* TEST IF LNG OF PLIST IS 15    */
         CLC   PLISTLNG(2,PLISTPTR),@CH00121                       0067
         BNE   @RT00067                                            0067
*     GOTO AMD038I;                 /* NOT 15 - WRITE PARM ERR MSG   */
*   RESPECIFY (TYPE2PTR,IPL2PTR) RESTRICTED;                       0069
*                                                                  0069
*/********************************************************************/
*/*             CHECK FOR THE IPL2 PARM BEING FIRST IN               */
*/*             THE LIST. THERE SHOULD BE A COMMA AS THE             */
*/*             SEVENTH CHARACTER OF THE LIST.                       */
*/*             IF A COMMA IS NOT THE SEVENTH CHARACTER              */
*/*             THEN THE TYPE2 PARM MUST BE FIRST IN                 */
*/*             THE LIST.                                            */
*/********************************************************************/
*                                                                  0070
*   IF PARMS(6 + 1) = ',' THEN         /* 7TH CHAR A COMMA?          */
         CLI   PARMS+6(PLISTPTR),C','                              0070
         BNE   @RF00070                                            0070
*     DO;                           /* YES, DO FOLLOWING             */
*       IPL2PTR = PLISTPTR+2;       /* SET IPL2 PTR TO 1ST CHAR OF 0072
*                                      LST                           */
         LA    IPL2PTR,2                                           0072
         AR    IPL2PTR,PLISTPTR                                    0072
*       TYPE2PTR= IPL2PTR + 6 + 1;         /* SET TYPE2 PTR TO CHAR
*                                      AFT ER COMMA                  */
         LA    TYPE2PTR,7                                          0073
         AR    TYPE2PTR,IPL2PTR                                    0073
*     END;                                                         0074
*   ELSE                                                           0075
*     DO;                           /* TYPE2 PARM 1ST IN LST         */
         B     @RC00070                                            0075
@RF00070 DS    0H                                                  0076
*       TYPE2PTR=PLISTPTR + 2;      /* POINT TO TYPE2 PARM           */
         LA    TYPE2PTR,2                                          0076
         AR    TYPE2PTR,PLISTPTR                                   0076
*       IPL2PTR= TYPE2PTR + 8 + 1;          /* POINT TO IPL2 PARM    */
         LA    IPL2PTR,9                                           0077
         AR    IPL2PTR,TYPE2PTR                                    0077
*     END;                                                         0078
*   LCAFLAGS='00'X;                 /* CLEAR FUNC INDICATORS         */
*                                                                  0079
@RC00070 MVI   LCAFLAGS,X'00'                                      0079
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF TYPE2=HI WAS SPECIFIED. IF SO CHECK FOR TAPE OR D.A.  */
*   /* INITIALIZATION.                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0080
*   IF TYPEPARM=TYPE2HI THEN        /* TYPE2=HI ?                    */
         CLC   TYPEPARM(8,TYPE2PTR),TYPE2HI                        0080
         BNE   @RF00080                                            0080
*     DO;                                                          0081
*       LCATYPE='1'B;               /* INDICATE TYPE2=HI             */
*                                                                  0082
         OI    LCATYPE,B'01000000'                                 0082
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IPL2 PARM FOR TAPE INITIALIZATION.                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0083
*       IF IPL2PARM=IPL2T THEN      /* IPL2=T ?                      */
         CLC   IPL2PARM(6,IPL2PTR),IPL2T                           0083
         BNE   @RF00083                                            0083
*         DO;                                                      0084
*           LCAIPL='0'B;            /* INDICATE TAPE INIT            */
         NI    LCAIPL,B'11011111'                                  0085
*           GOTO AMDOPEN;           /* GO OPEN SYSUT2                */
         B     AMDOPEN                                             0086
*         END;                                                     0087
*                                                                  0087
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IPL2 PARM FOR D.A. INITIALIZATION                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0088
*       IF IPL2PARM=IPL2D THEN      /* IPL2=D SPECIFIED?             */
@RF00083 CLC   IPL2PARM(6,IPL2PTR),IPL2D                           0088
         BNE   @RF00088                                            0088
*         LCAIPL='1'B;              /* YES, INDICATE D.A. INIT       */
*                                                                  0089
         OI    LCAIPL,B'00100000'                                  0089
*   /*****************************************************************/
*   /*                                                               */
*   /* IPL2 PARM DOES NOT INDICATE TAPE OR D.A.-- WRITE PARM ERR MSG */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0090
*       ELSE                                                       0090
*         GOTO AMD038I;             /* GO WRITE PARM ERR MSG         */
*                                                                  0090
*   /*****************************************************************/
*   /*                                                               */
*   /* IF IPL2=D IS SPECIFIED OPEN SYSUT4 D.S.                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0091
*                                                                  0091
*OPENSYS4:                                                         0091
*       GENERATE;                                                  0091
*                                                                  0091
OPENSYS4 DS    0H                                                  0091
          OPEN (SYS4DCB,(OUTPUT))
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF SYSUT4 WAS OPENED SUCCESSFULLY                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0092
*       DCBPTR=ADDR(SYS4DCB);       /* POINT TO SYSUT4 DCB           */
         LA    DCBPTR,SYS4DCB                                      0092
*       IF (DCBOFLGS & '10'X)= 0 THEN      /* OPEN FLG ON?           */
         LA    @10,16                                              0093
         MVC   @ZT00003+3(1),DCBOFLGS+48(DCBPTR)                   0093
         N     @10,@ZT00003                                        0093
         LTR   @10,@10                                             0093
         BZ    @RT00093                                            0093
*         GOTO AMD035I;             /* NO, GOTO WRITE OPEN ERR MSG   */
*                                                                  0094
*   /*****************************************************************/
*   /*                                                               */
*   /* OPEN SYSUT2 DCB                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0095
*                                                                  0095
*AMDOPEN:                                                          0095
*       GENERATE;                                                  0095
*                                                                  0095
AMDOPEN  DS    0H                                                  0095
          OPEN (SYS2DCB,(INPUT))
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF SYSUT2 DCB OPENED SUCCESSFULLY                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0096
*       DCBPTR=ADDR(SYS2DCB);       /* POINT TO SYSUT2 DCB           */
         LA    DCBPTR,SYS2DCB                                      0096
*       IF (DCBOFLGS & '10'X) = 0 THEN      /* OPEN FLG ON?          */
         LA    @10,16                                              0097
         MVC   @ZT00003+3(1),DCBOFLGS+48(DCBPTR)                   0097
         N     @10,@ZT00003                                        0097
         LTR   @10,@10                                             0097
         BZ    @RT00097                                            0097
*         GOTO AMD035I;             /* NO, WRITE OPEN ERR MSG        */
*     END;                                                         0099
*                                                                  0099
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT TYPE2=HI CHECK FOR TYPE2=LO. IF LO WAS SPECIFIED THEN  */
*   /* IPL2 MUST BE D.A.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0100
*   ELSE                                                           0100
*     DO;                                                          0100
*                                                                  0100
         B     @RC00080                                            0100
@RF00080 DS    0H                                                  0101
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT TYPE2=LO THEN THE TYPE2 PARM IS IN ERR                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0101
*       IF TYPEPARM ^= TYPE2LO THEN /* TYPE2=LO?                     */
         CLC   TYPEPARM(8,TYPE2PTR),TYPE2LO                        0101
         BNE   @RT00101                                            0101
*         GOTO AMD038I;             /* NO, GO WRITE PARM ERR MSG     */
*       LCATYPE='0'B;               /* YES, INDICATE TYPE2=LO IN LCA */
*                                                                  0103
         NI    LCATYPE,B'10111111'                                 0103
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF IPL2=D WAS SPECIFIED WITH TYPE2=LO                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0104
*       IF IPL2PARM=IPL2D THEN                                     0104
         CLC   IPL2PARM(6,IPL2PTR),IPL2D                           0104
         BNE   @RF00104                                            0104
*         DO;                                                      0105
*           LCAIPL='1'B;            /* INDICATE IPL2=D               */
         OI    LCAIPL,B'00100000'                                  0106
*           GOTO OPENSYS4;          /* OPEN SYSUT4             Y02006*/
         B     OPENSYS4                                            0107
*         END;                                                     0108
*       ELSE                        /* NOT IPL2=D, WRITE PARM ERR MSG*/
*         GOTO AMD038I;                                            0109
*     END;                                                         0110
*   RESPECIFY (TYPE2PTR,IPL2PTR) UNRESTRICTED;                     0111
@RC00080 DS    0H                                                  0112
*   RESPECIFY (WKREG) RESTRICTED;                                  0112
*                                                                  0112
*   /*****************************************************************/
*   /*                                                               */
*   /* GET CORE FOR THE OUTPUT BUFFER                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0113
*   WKREG=OTBUFSIZ;                 /* GET SIZE OF OUT BUF           */
         L     WKREG,OTBUFSIZ                                      0113
*   GENERATE SETS(OTBUFADD);                                       0114
*                                                                  0114
    GETMAIN EC,LV=(WKREG),A=OTBUFADD
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF GETMAIN WAS SUCCESSFUL. IF NOT WRITE MSG AMD042I      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0115
*   RESPECIFY REG15 RESTRICTED;                                    0115
*   IF REG15^= 0 THEN                                              0116
         LTR   REG15,REG15                                         0116
         BNZ   @RT00116                                            0116
*     GO TO AMD042I;                                               0117
*   RESPECIFY REG15 UNRESTRICTED;                                  0118
*                                                                  0118
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE INPUT BUFFER SIZE EQUAL TO SYSUT2 DCB BLKSIZE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0119
*   DCBPTR=ADDR(SYS2DCB);           /* POINT TO SYSUT2 DCB           */
         LA    DCBPTR,SYS2DCB                                      0119
*   INBUFSIZ= DCBBLKSI;             /* SET INPUT BUF SIZE            */
*                                                                  0120
         LA    @10,62                                              0120
         LR    @09,DCBPTR                                          0120
         AR    @09,@10                                             0120
         LH    @09,DCBBLKSI(,@09)                                  0120
         STH   @09,INBUFSIZ                                        0120
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPARE THE SYSUT2 AND SYSUT1 BLKSIZES AND USE THE LARGER FOR */
*   /* THE SIZE OF THE INPUT BUFFER                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0121
*   DCBPTR=ADDR(SYS1DCB);           /* POINT TO SYSUT1 DCB           */
         LA    DCBPTR,SYS1DCB                                      0121
*   IF INBUFSIZ < DCBBLKSI THEN     /* TEST IF SYSUT1 BLKSIZE LARGER
*                                      THAN S YSUT2'S                */
         AR    @10,DCBPTR                                          0122
         LH    @10,DCBBLKSI(,@10)                                  0122
         CR    @09,@10                                             0122
         BNL   @RF00122                                            0122
*     INBUFSIZ=DCBBLKSI;            /* YES, SET INPUT BUF SIZE TO  0123
*                                      SYSUT1 BLKSI ZE               */
*                                                                  0123
         STH   @10,INBUFSIZ                                        0123
*   /*****************************************************************/
*   /*                                                               */
*   /* GET CORE FOR THE INPUT BUFFER                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0124
*   WKREG=INBUFSIZ * 2;             /* GET INPUT BUF SIZE      Y02006*/
@RF00122 LH    WKREG,INBUFSIZ                                      0124
         AR    WKREG,WKREG                                         0124
*   GENERATE SETS(INBUFADD);                                       0125
*                                                                  0125
    GETMAIN EC,LV=(WKREG),A=INBUFADD
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF GETMAIN FOR INPUT BUFFER WAS SUCCESSFUL. IF NOT WRITE */
*   /* MESSAGE AMD042I                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0126
*   RESPECIFY REG15 RESTRICTED;                                    0126
*   IF REG15 ^= 0 THEN              /* RETURN CODE = ZERO?           */
         LTR   REG15,REG15                                         0127
         BNZ   @RT00127                                            0127
*     GOTO AMD042I;                 /* NO, GO WRITE ERR MSG          */
*   RESPECIFY REG15 UNRESTRICTED;                                  0129
*   INBUFAD2 = INBUFADD + WKREG/2;  /* ADDRESS OF 2ND INPUT BUFFER 0130
*                                                              Y02006*/
*                                                                  0130
         L     @10,INBUFADD                                        0130
         LR    @09,WKREG                                           0130
         SRL   @09,1                                               0130
         AR    @09,@10                                             0130
         ST    @09,INBUFAD2                                        0130
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE LOADER CONTROL AREA FOR PROCESSING AMDSAIP1 (IPL1  */
*   /* RECORD)                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0131
*   RESPECIFY (WKREG) UNRESTRICTED;                                0131
*   LCAINDCB = ADDR(SYS1DCB);       /* SET INPUT DCB ADDR            */
         LA    @00,SYS1DCB                                         0132
         ST    @00,LCAINDCB                                        0132
*   LCAOTDCB = ADDR(SYS3DCB);       /* SET OUTPUT DCB ADDR           */
         LA    @00,SYS3DCB                                         0133
         ST    @00,LCAOTDCB                                        0133
*   LCAOTPUT = OTBUFADD;            /* SET POINTER TO OUTPUT BUFFER  */
         L     @00,OTBUFADD                                        0134
         ST    @00,LCAOTPUT                                        0134
*   LCAINPUT = INBUFADD;            /* SET POINTER TO INPUT BUFFER   */
         ST    @10,LCAINPUT                                        0135
*   LCAOTEOR = LCAOTPUT;            /* SET END OF RCD PTR TO BEGIN OF
*                                      OUTPUT BUF                    */
         ST    @00,LCAOTEOR                                        0136
*   LCAFUNC = '0'B;                 /* INDICATE OBJ CSECT            */
         NI    LCAFUNC,B'01111111'                                 0137
*   LCAMODUL = BLANKS;              /* CLEAR MODULE NAME FIELD       */
         MVC   LCAMODUL(8),BLANKS                                  0138
*   LCACSECT = AMDSAIP1;            /* INDICATE CSECT TO BE        0139
*                                      PROCCESSED                    */
*                                                                  0139
         MVC   LCACSECT(8),AMDSAIP1                                0139
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL TEXT SUBROUTINE----PROCESS AMDSAIP1 TEXT                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0140
*   CALL AMDSATXT;                                                 0140
*                                                                  0140
         BAL   @14,AMDSATXT                                        0140
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF TEXT PROCESSED SUCCESSFULLY. IF NOT USE ERR CODE AS   */
*   /* INDEX INTO BRNCH TABLE AND GOTO WRITE ERROR MSG               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0141
*   RESPECIFY REG15 RESTRICTED;                                    0141
*   IF REG15 ^= 0 THEN              /* TEST FOR ERROR RETURN CODE    */
         LTR   REG15,REG15                                         0142
         BZ    @RF00142                                            0142
*     GOTO AMDMSGX(REG15);          /* YES, GO WRITE ERROR MSG       */
         LR    @14,REG15                                           0143
         SLA   @14,2                                               0143
         L     @14,AMDMSGX-4(@14)                                  0143
         BR    @14                                                 0143
*   RESPECIFY REG15 UNRESTRICTED;                                  0144
*                                                                  0144
@RF00142 DS    0H                                                  0145
*   /*****************************************************************/
*   /*                                                               */
*   /* THE IPL1 RECORD MUST BE EXACTLY 24 BYTES LONG                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0145
*   LCAOTEOR = LCAOTPUT + 24;       /* SET IPL1 LNG TO EXACTLY 24  0145
*                                      BYTES                         */
*                                                                  0145
         LA    @10,24                                              0145
         A     @10,LCAOTPUT                                        0145
         ST    @10,LCAOTEOR                                        0145
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR TAPE INITIALIZATION. IF SO, SET OUTPUT BUFFER PTR TO */
*   /* END OF IPL1 TXTAND GO GET DMP PGM TXT                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0146
*   IF LCAIPL= '0'B THEN            /* TEST FOR TAPE IPL             */
         TM    LCAIPL,B'00100000'                                  0146
         BNZ   @RF00146                                            0146
*     DO;                                                          0147
*       LCAOTPUT = LCAOTEOR;        /* YES, SET OUTPUT BUF ADDR TO 0148
*                                      END OF IPL 1 TXT              */
         ST    @10,LCAOTPUT                                        0148
*       GOTO AMDHSR;                /* GO PROC HI SPED DMP TXT       */
         B     AMDHSR                                              0149
*     END;                                                         0150
*                                                                  0150
*   /*****************************************************************/
*   /*                                                               */
*   /* IF D.A. INITIALIZATION WRITE THE IPL1 RECORD TO SYSUT3 D.S.   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0151
*   ELSE                                                           0151
*     DO;                                                          0151
@RF00146 DS    0H                                                  0152
*       CALL AMDWRITE;              /* GOTO THE WRITE SUBROUTINE     */
*                                                                  0152
         BAL   @14,AMDWRITE                                        0152
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE LOADER CONTROL AREA FOR PROCESSING AMDSAIP2 (IPL2  */
*   /* RECORD) TEXT                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0153
*                                                                  0153
*AMDIPL2:                                                          0153
*       LCACSECT = AMDSAIP2;        /* INDICATE CSECT TO BE PROCESSED*/
AMDIPL2  MVC   LCACSECT(8),AMDSAIP2                                0153
*       LCAMODUL = BLANKS;          /* CLEAR MODULE NAME FIELD       */
         MVC   LCAMODUL(8),BLANKS                                  0154
*       LCAFUNC = '0'B;             /* INDICATE OBJ CSECT TO BE    0155
*                                      PROCESSED                     */
*                                                                  0155
         NI    LCAFUNC,B'01111111'                                 0155
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL TEXT SUBROUTINE ----- PROCESS AMDSAIP2 TEXT              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0156
*       CALL AMDSATXT;                                             0156
*                                                                  0156
         BAL   @14,AMDSATXT                                        0156
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF TEXT PROCESSED PROPERLY. IF NOT, USE ERR CODE TO     */
*   /* INDEX INTO BRANCH TABLE AND GO WRITE ERR MESSAGE              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0157
*       RESPECIFY REG15 RESTRICTED;                                0157
*       IF REG15 ^= 0 THEN          /* TEST FOR ERR RETURN CODE      */
         LTR   REG15,REG15                                         0158
         BZ    @RF00158                                            0158
*         GOTO AMDMSGX(REG15);      /* YES, GO WRITE ERR MSG         */
         LR    @14,REG15                                           0159
         SLA   @14,2                                               0159
         L     @14,AMDMSGX-4(@14)                                  0159
         BR    @14                                                 0159
*       RESPECIFY REG15 UNRESTRICTED;                              0160
*                                                                  0160
@RF00158 DS    0H                                                  0161
*   /*****************************************************************/
*   /*                                                               */
*   /* THE IPL2 RECORD HAS A SIZE LIMIT OF 144 BYTES                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0161
*       LCAOTEOR = LCAOTPUT + 144;      /* SET IPL2 RCD LNG TO     0161
*                                      EXACTLY 1 44 BYTES            */
*                                                                  0161
         LA    @10,144                                             0161
         A     @10,LCAOTPUT                                        0161
         ST    @10,LCAOTEOR                                        0161
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE IPL2 RECORD TO SYSUT3                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0162
*       CALL AMDWRITE;                                             0162
         BAL   @14,AMDWRITE                                        0162
*     END;                                                         0163
*                                                                  0163
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE LCA FOR PROCESSING AMDSALSR ( LOW SPEED DUMP   */
*   /* PGM) TEXT                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0164
*                                                                  0164
*AMDHSR:                                                           0164
*   LCACSECT = AMDSALSR;            /* INDICATE NAME OF OBJ CSECT    */
*                                                                  0164
AMDHSR   MVC   LCACSECT(8),AMDSALSR                                0164
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR HIGHSPEED INITIALIZATION. IF SO, INITIALIZE THE LCA */
*   /* FOR PROCESSING AMDSAHSR (HIGH SPEED DUMP PROGRAM)             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0165
*   IF LCATYPE = '1'B THEN          /* TEST FOR TYPE2=HI             */
         TM    LCATYPE,B'01000000'                                 0165
         BNO   @RF00165                                            0165
*     LCACSECT = AMDSAHSR;          /* YES, INIT HIGH SPEED PGM NAME */
*                                                                  0166
         MVC   LCACSECT(8),AMDSAHSR                                0166
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL TEXT SUBROUTINE ----- PROCESS CORE DUMP PROGRAM TEXT     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0167
*   CALL AMDSATXT;                                                 0167
*                                                                  0167
@RF00165 BAL   @14,AMDSATXT                                        0167
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DUMP PGM TEXT PROCESSED SUCCESSFULLY. IF NOT, USE ERR*/
*   /* CODE TO INDEX BRANCH TABLE AND GO WRITE ERROR MSG             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0168
*   RESPECIFY REG15 RESTRICTED;                                    0168
*   IF REG15 ^= 0 THEN              /* TEST FOR ERR RETURN CODE      */
         LTR   REG15,REG15                                         0169
         BZ    @RF00169                                            0169
*     GOTO AMDMSGX(REG15);          /* GO WRITE ERR MSG              */
         LR    @14,REG15                                           0170
         SLA   @14,2                                               0170
         L     @14,AMDMSGX-4(@14)                                  0170
         BR    @14                                                 0170
*   RESPECIFY REG15 UNRESTRICTED;                                  0171
*                                                                  0171
@RF00169 DS    0H                                                  0172
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CORE DUMP PGM HAS A SIZE LIMIT OF 4K BYTES          Y02006*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0172
*   LCAOTEOR = LCAOTPUT + 4096;       /* SET PGM LNG TO EXACTLY 4K 0172
*                                                              Y02006*/
*                                                                  0172
         LH    @10,@CH00202                                        0172
         A     @10,LCAOTPUT                                        0172
         ST    @10,LCAOTEOR                                        0172
*   /*****************************************************************/
*   /*                                                               */
*   /* IF TAPE INITIALIZATION SET OUTPUT BUFFER PTR TO END OF DMP PGM*/
*   /* TEXT AND GO PROCESS THE PRECURSOR PGM TEXT.                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0173
*   IF LCAIPL = '0'B THEN           /* TAPE IPL?                     */
         TM    LCAIPL,B'00100000'                                  0173
         BNZ   @RF00173                                            0173
*     LCAOTPUT = LCAOTEOR;          /* SET OUTPUT BUF PTR TO END OF
*                                      DMP PGM TXT                   */
*                                                                  0174
         ST    @10,LCAOTPUT                                        0174
*   /*****************************************************************/
*   /*                                                               */
*   /* DIRECT ACCESS INITIALIZATION --                         Y02006*/
*   /* WRITE THE DMP PGM TEXT TO SYSUT4(SYS1.PAGEDUMP)         Y02006*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0175
*   ELSE                                                           0175
*     DO;                                                          0175
         B     @RC00173                                            0175
@RF00173 DS    0H                                                  0176
*         LCAOTDCB = ADDR(SYS4DCB); /* POINT TO SYSUT4 FOR OUTPUT  0176
*                                                              Y02006*/
         LA    @10,SYS4DCB                                         0176
         ST    @10,LCAOTDCB                                        0176
*         DCBPTR = LCAOTDCB;        /* PUT DCB ADDR IN DCB REG Y02006*/
         LR    DCBPTR,@10                                          0177
*         LCAOTPUT = LCAOTPUT + 32;       /* SKIP PASSED MINIMUM   0178
*                                      CCT                     Y02006*/
         LA    @10,32                                              0178
         A     @10,LCAOTPUT                                        0178
         ST    @10,LCAOTPUT                                        0178
*         LCAOTEOR = LCAOTPUT + 6144;     /* MAKE RECORD X'1800'   0179
*                                      BYTES LONG              Y02006*/
         AH    @10,@CH00204                                        0179
         ST    @10,LCAOTEOR                                        0179
*         CALL AMDWRITE;            /* WRITE RECORD TO SYSUT4  Y02006*/
         BAL   @14,AMDWRITE                                        0180
*         LCAOTPUT = LCAOTPUT - 32;         /* POINT TO BEGINNING OF
*                                      BUFFER                  Y02006*/
*                                                                  0181
         L     @10,LCAOTPUT                                        0181
         SH    @10,@CH00203                                        0181
         ST    @10,LCAOTPUT                                        0181
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR LOW SPEED DUMP INITIALIZATION. IF SO SKIP            */
*   /* INITIALIZATION OF AMDSAPGE.                             Y02006*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0182
*       IF LCATYPE = '0'B THEN      /* TYPE2=LO?                     */
         TM    LCATYPE,B'01000000'                                 0182
         BZ    @RT00182                                            0182
*         GOTO AMDPROP;             /* GO GET PRECURSOR        Y02006*/
*     END;                                                         0184
*                                                                  0184
*   /*****************************************************************/
*   /*                                                         Y02006*/
*   /* INITIALIZE FOR PROCESSING THE PAGE DMP PGM -- AMDSAPGE  Y02006*/
*   /*                                                         Y02006*/
*   /*****************************************************************/
*                                                                  0185
*   LCAMODUL = AMDSAPGE;            /* SET THE MODUL NAME Y02006     */
@RC00173 MVC   LCAMODUL(8),AMDSAPGE                                0185
*   LCACSECT = LCAMODUL;            /* INIT THE CSECT NAME Y02006    */
         MVC   LCACSECT(8),LCAMODUL                                0186
*   LCARELOC = '8000'X;             /* SET RELOCATION VALUE FOR    0187
*                                      AMDSAPGE Y02006               */
         L     @10,@CF00206                                        0187
         ST    @10,LCARELOC                                        0187
*   LCAFUNC = '1'B;                 /* LOAD MODULE TO PROCESS  Y02006*/
         OI    LCAFUNC,B'10000000'                                 0188
*   LCAINDCB = ADDR(SYS2DCB);       /* POINT TO SYSUT2         Y02006*/
         LA    @10,SYS2DCB                                         0189
         ST    @10,LCAINDCB                                        0189
*   DCBPTR = LCAINDCB;              /* SET UP DCB ADDRESS      Y02006*/
*                                                                  0190
         LR    DCBPTR,@10                                          0190
*   /*****************************************************************/
*   /*                                                         Y02006*/
*   /* CALL TEXT SUBROUTINE --- PROCESS AMDSAPGE               Y02006*/
*   /*                                                         Y02006*/
*   /*****************************************************************/
*                                                                  0191
*   CALL AMDSATXT;                  /* *CHECK IF AMDSAPGE TEXT     0191
*                                      PROCESSED SUCCESSFULLY Y02006 */
         BAL   @14,AMDSATXT                                        0191
*   RESPECIFY REG15 RESTRICTED;                                    0192
*   IF REG15 ^= 0 THEN              /* TEST ERR RETURN CODE Y02006   */
         LTR   REG15,REG15                                         0193
         BZ    @RF00193                                            0193
*     GOTO AMDMSGX(REG15);          /* YES, WRITE ERROR MSG Y02006   */
         LR    @14,REG15                                           0194
         SLA   @14,2                                               0194
         L     @14,AMDMSGX-4(@14)                                  0194
         BR    @14                                                 0194
*   RESPECIFY REG15 UNRESTRICTED;                                  0195
*                                                                  0195
@RF00193 DS    0H                                                  0196
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AMDSAPGE TEXT PROCESSED OK CHECK FOR D.A. INITIALIZATION.  */
*   /* IF D.A. SET UP TO WRITE AMDSAPGE TXT TO SYSUT4                */
*   /*                                                         Y02006*/
*   /*****************************************************************/
*                                                                  0196
*   LCACOUNT = 0;                   /* INITIALIZE AMDSAPGE RECORD  0196
*                                      COUNT Y02006                  */
         MVI   LCACOUNT,X'00'                                      0196
*   IF LCAIPL = '1'B THEN           /* D.A. IPL? Y02006              */
         TM    LCAIPL,B'00100000'                                  0197
         BNO   @RF00197                                            0197
*     DO;                                                          0198
*       LCAOTDCB = ADDR(SYS4DCB);   /* SET OUTPUT DCB PTR TO SYSUT4  */
         LA    @10,SYS4DCB                                         0199
         ST    @10,LCAOTDCB                                        0199
*       DCBPTR = LCAOTDCB;          /* PUT DCB ADDR IN DCB REG Y02006*/
         LR    DCBPTR,@10                                          0200
*       RCDPTR = LCAOTEOR;          /* END ADDR OF PGE TXT Y02006    */
*                                                                  0201
         L     RCDPTR,LCAOTEOR                                     0201
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING LOGIC IS EXECUTED FOR D.A. INITIALIZATION ONLY. */
*   /* AMDSAPGE TEXT IN THE OUTPUT BUFFER IS SEGMENTED INTO RECORDS  */
*   /* EQUAL TO THE SYSUT4 BLKSIZE AND WRITTEN TO THE SYSUT4 DATA SET*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0202
*                                                                  0202
*AMDIOPGE:                                                         0202
*       LCAOTEOR = LCAOTPUT + 4096 + 2048;         /* SET PTR TO END
*                                      OF RECORD Y02006              */
AMDIOPGE L     @10,LCAOTPUT                                        0202
         LH    @00,@CH00204                                        0202
         AR    @00,@10                                             0202
         ST    @00,LCAOTEOR                                        0202
*       IF LCAOTPUT < RCDPTR THEN   /* IS BEG OF RCD LESS THAN END OF
*                                      BUF ? Y02006                  */
         CR    @10,RCDPTR                                          0203
         BNL   @RF00203                                            0203
*         DO;                       /* YES, DO FOLLOWING Y02006      */
*           CALL AMDWRITE;          /* WRITE THE RECORD Y02006       */
         BAL   @14,AMDWRITE                                        0205
*           LCACOUNT = LCACOUNT + 1; /* INCREMENT AMDSAPGE RECORD  0206
*                                      COUNT Y02006                  */
         LA    @10,1                                               0206
         MVC   @ZT00003+3(1),LCACOUNT                              0206
         A     @10,@ZT00003                                        0206
         STC   @10,LCACOUNT                                        0206
*           LCAOTPUT = LCAOTEOR;    /* POINT TO NEXT RECORD Y02006   */
         L     @10,LCAOTEOR                                        0207
         ST    @10,LCAOTPUT                                        0207
*           GOTO AMDIOPGE;          /* GO INITIALIZE PTR TO END OF 0208
*                                      RCD Y02006                    */
         B     AMDIOPGE                                            0208
*         END;                                                     0209
*       RETRNCOD = 0;               /* SUCCESSFUL RETURN CODE Y02006 */
@RF00203 SLR   RETRNCOD,RETRNCOD                                   0210
*       GOTO AMDPROP;               /* PGE INIT COMPLETE - GO PROCESS
*                                      AMDSAPRO Y02006               */
         B     AMDPROP                                             0211
*     END;                                                         0212
*                                                                  0212
*   /*****************************************************************/
*   /*                                                               */
*   /* IF TAPE INITIALIZATION AND AMDSAPGE TEXT PROCESSED OK THEN    */
*   /* WRITE OUT BUFFER CONTAINING IPL1, AMDSAHSR, AND AMDSAPGE TEXT.*/
*   /* WHEN FINISHED GOTO PROCESS IPL2 TEXT AND REMAINDER OF AMDSAPGE*/
*   /* TEXT. Y02006                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*   ELSE                                                           0213
*     DO;                                                          0213
@RF00197 DS    0H                                                  0214
*       LCAOTPUT = OTBUFADD;        /* POINT TO BEGIN OF BUFFER    0214
*                                      Y02006                        */
         L     @10,OTBUFADD                                        0214
         ST    @10,LCAOTPUT                                        0214
*       LCAOTDCB = ADDR(SYS3DCB);   /* SET UP DCB ADDRESS Y02006     */
         LA    @00,SYS3DCB                                         0215
         ST    @00,LCAOTDCB                                        0215
*       DCBPTR = LCAOTDCB;          /* PUT DCB ADDR IN DCB REG Y02006*/
         LR    DCBPTR,@00                                          0216
*       LCAOTEOR = OTBUFADD + DCBBLKSI; /* POINT TO END OF RECORD  0217
*                                      Y02006                        */
         AH    @10,DCBBLKSI+62(,DCBPTR)                            0217
         ST    @10,LCAOTEOR                                        0217
*       CALL AMDWRITE;              /* GO WRITE THE RECORD Y02006    */
         BAL   @14,AMDWRITE                                        0218
*       LCAINDCB = ADDR(SYS1DCB);   /* SET INPUT DCB TO SYSUT1 DCB 0219
*                                      FOR IPL2 PROCESSING Y02006    */
         LA    @10,SYS1DCB                                         0219
         ST    @10,LCAINDCB                                        0219
*       LCAOTPUT = OTBUFADD + DCBBLKSI - 144;      /* LOCATION FOR 0220
*                                      IPL2 AHEAD OF REMAINING PGE 0220
*                                      CODE Y02006                   */
         LH    @10,DCBBLKSI+62(,DCBPTR)                            0220
         A     @10,OTBUFADD                                        0220
         SH    @10,@CH00200                                        0220
         ST    @10,LCAOTPUT                                        0220
*       LCACSECT = AMDSAIP2;        /* INDICATE CSECT TO BE PROCESSED
*                                      Y02006                        */
         MVC   LCACSECT(8),AMDSAIP2                                0221
*       LCAMODUL = BLANKS;          /* CLEAR MODULE NAME FIELD Y02006*/
         MVC   LCAMODUL(8),BLANKS                                  0222
*       LCAFUNC = '0'B;             /* INDICATE OBJ CSECT TO BE    0223
*                                      PROCESSED Y02006              */
*                                                                  0223
         NI    LCAFUNC,B'01111111'                                 0223
*   /*****************************************************************/
*   /*                                                         Y02006*/
*   /* CALL TEXT SUBROUTINE ----- PROCESS AMDSAIP2 TEXT        Y02006*/
*   /*                                                         Y02006*/
*   /*****************************************************************/
*                                                                  0224
*       CALL AMDSATXT;              /* Y02006                        */
*                                                                  0224
         BAL   @14,AMDSATXT                                        0224
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF TEXT PROCESSED PROPERLY. IF NOT, USE ERR CODE TO     */
*   /* INDEX INTO BRANCH TABLE AND GO WRITE ERR MESSAGE        Y02006*/
*   /*                                                         Y02006*/
*   /*****************************************************************/
*                                                                  0225
*       RESPECIFY REG15 RESTRICTED;                                0225
*       IF REG15 ^= 0 THEN          /* TEST ERR RETURN CODE Y02006   */
         LTR   REG15,REG15                                         0226
         BZ    @RF00226                                            0226
*         GOTO AMDMSGX(REG15);      /* YES, GO WRITE ERR MSG Y02006  */
         LR    @14,REG15                                           0227
         SLA   @14,2                                               0227
         L     @14,AMDMSGX-4(@14)                                  0227
         BR    @14                                                 0227
*       RESPECIFY REG15 UNRESTRICTED;                              0228
@RF00226 DS    0H                                                  0229
*       DCBPTR = ADDR(SYS3DCB);     /* POINT TO SYSUT3 DCB Y02006    */
         LA    DCBPTR,SYS3DCB                                      0229
*       LCAOTEOR = LCAOTPUT + DCBBLKSI; /* END OF RECORD Y02006      */
         LH    @10,DCBBLKSI+62(,DCBPTR)                            0230
         A     @10,LCAOTPUT                                        0230
         ST    @10,LCAOTEOR                                        0230
*       CALL AMDWRITE;              /* WRITE REMAINDER OF PGE CODE 0231
*                                      AND IPL2 Y02006               */
         BAL   @14,AMDWRITE                                        0231
*       RETRNCOD = 0;               /* SET RETURN CODE OF 0 Y02006   */
         SLR   RETRNCOD,RETRNCOD                                   0232
*       GO TO AMDCLNUP;             /* PREPARE TO EXIT Y02006        */
         B     AMDCLNUP                                            0233
*     END;                                                         0234
*                                                                  0234
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE FOR PRECURSOR PROCESSING                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0235
*                                                                  0235
*AMDPROP:                                                          0235
*   LCAOTPUT = OTBUFADD;            /* POINT TO OUTPUT BUFFER  Y02006*/
AMDPROP  L     @10,OTBUFADD                                        0235
         ST    @10,LCAOTPUT                                        0235
*   LCAINDCB = ADDR(SYS2DCB);       /* SET INPUT DCB TO SYSUT2 Y02006*/
         LA    @10,SYS2DCB                                         0236
         ST    @10,LCAINDCB                                        0236
*   DCBPTR = LCAINDCB;              /* SET UP DCB ADDRESS Y02006     */
         LR    DCBPTR,@10                                          0237
*   LCAMODUL = AMDSAPRO;            /* INDICATE PRECURSOR CSECT      */
         MVC   LCAMODUL(8),AMDSAPRO                                0238
*   LCACSECT = AMDSAPR2;            /* INDICATE MOD NAME Y02006      */
         MVC   LCACSECT(8),AMDSAPR2                                0239
*   LCAFUNC = '1'B;                 /* INDICATE LOD MOD TXT TO BE  0240
*                                      PROC Y02006                   */
*   LCAPGECT = '1'B;                /* SET PGERCDCT RETURN SWITCH  0241
*                                      Y02006                        */
*                                                                  0241
         OI    LCAFUNC,B'10010000'                                 0241
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL TEXT SUBROUTINE ---- FIND PGERCDCT LD IN AMDSAPRO  Y02006*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0242
*   CALL AMDSATXT;                  /* Y02006                        */
*                                                                  0242
         BAL   @14,AMDSATXT                                        0242
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF PRECURSOR TEXT PROCESSED SUCCESSFULLY                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0243
*   RESPECIFY REG15 RESTRICTED;                                    0243
*   IF REG15 ^= 0 THEN              /* TEST ERR RETURN CODE Y02006   */
         LTR   REG15,REG15                                         0244
         BZ    @RF00244                                            0244
*     GOTO AMDMSGX(REG15);          /* YES, GO WRITE ERR MSG Y02006  */
         LR    @14,REG15                                           0245
         SLA   @14,2                                               0245
         L     @14,AMDMSGX-4(@14)                                  0245
         BR    @14                                                 0245
*   RESPECIFY REG15 UNRESTRICTED;                                  0246
@RF00244 DS    0H                                                  0247
*   LCACSECT = AMDSAPRO;            /* INDICATE MOD NAME Y02006      */
         MVC   LCACSECT(8),AMDSAPRO                                0247
*   LCAFUNC = '1'B;                 /* INDICATE LOD MOD TXT TO BE  0248
*                                      PROC Y02006                   */
*   LCAPGECT = '0'B;                /* RESET RETURN SWITCH Y02006    */
         OI    LCAFUNC,B'10000000'                                 0249
         NI    LCAPGECT,B'11101111'                                0249
*   LCARELOC = '7800'X;             /* SET RELOCATION VALUE FOR    0250
*                                      AMDSAPRO Y02006               */
*                                                                  0250
         LH    @10,@CH00212                                        0250
         ST    @10,LCARELOC                                        0250
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL TEXT SUBROUTINE ---- PROCESS AMDSAPRO (PRECURSOR) TEXT   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0251
*   CALL AMDSATXT;                  /* Y02006                        */
*                                                                  0251
         BAL   @14,AMDSATXT                                        0251
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF PRECURSOR TEXT PROCESSED SUCCESSFULLY                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0252
*   RESPECIFY REG15 RESTRICTED;                                    0252
*   IF REG15 ^= 0 THEN              /* TEST ERR RETURN CODE Y02006   */
         LTR   REG15,REG15                                         0253
         BZ    @RF00253                                            0253
*     GOTO AMDMSGX(REG15);          /* YES, GO WRITE ERR MSG Y02006  */
         LR    @14,REG15                                           0254
         SLA   @14,2                                               0254
         L     @14,AMDMSGX-4(@14)                                  0254
         BR    @14                                                 0254
*   RESPECIFY REG15 UNRESTRICTED;                                  0255
*                                                                  0255
@RF00253 DS    0H                                                  0256
*   /*****************************************************************/
*   /*                                                               */
*   /* THE PRECURSOR PGM HAS A SIZE LIMIT OF 2K BYTES                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0256
*   LCAOTEOR = LCAOTPUT + 2048;     /* SET PRECURSOR LNG TO EXACTLY
*                                      2K Y02006                     */
*                                                                  0256
         LA    @10,2048                                            0256
         A     @10,LCAOTPUT                                        0256
         ST    @10,LCAOTEOR                                        0256
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE PRECURSOR PGM TEXT TO SYSUT3                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0257
*   PGERCDCT = LCACOUNT;            /* UPDATE COUNT OF AMDSAPGE    0257
*                                      RECORDS Y02006                */
         L     @10,LCAPROLD                                        0257
         MVC   PGERCDCT(1,@10),LCACOUNT                            0257
*   LCAOTDCB = ADDR(SYS3DCB);       /* ADDRESS OF SYSUT3 DCB Y02006  */
         LA    @10,SYS3DCB                                         0258
         ST    @10,LCAOTDCB                                        0258
*   DCBPTR = LCAOTDCB;              /* DCB ADDR IN DCB REGISTER    0259
*                                      Y02006                        */
         LR    DCBPTR,@10                                          0259
*   CALL AMDWRITE;                  /* WRITE DUMMY WORK RECORD Y02006*/
         BAL   @14,AMDWRITE                                        0260
*   CALL AMDWRITE;                  /* WRITE AMDSAPRO          Y02006*/
         BAL   @14,AMDWRITE                                        0261
*   CALL AMDWRITE;                  /* WRITE DUMMY WORK RECORD Y02006*/
         BAL   @14,AMDWRITE                                        0262
*   RETRNCOD = 0;                   /* SET UP RETURN CODE OF 0 Y02006*/
         SLR   RETRNCOD,RETRNCOD                                   0263
*   GO TO AMDCLNUP;                 /* PREPARE TO TERMINATE    Y02006*/
*                                                                  0264
         B     AMDCLNUP                                            0264
*   /*****************************************************************/
*   /*                                                               */
*   /* SYNAD ROUTINE FOR SYSPRINT, SYSUT3, AND SYSUT4 DCB'S          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0265
*                                                                  0265
*AMDSYND1:                                                         0265
*   GENERATE;                       /* I/O ERROR ON SYSUT3 OR SYSUT4 */
AMDSYND1 DS    0H                                                  0265
              SYNADAF ACSMETH=BSAM
*   GOTO AMDMOVIT;                  /* GO MOVE I/O ERR MSG INTO    0266
*                                      BUFFER                        */
*                                                                  0266
         B     AMDMOVIT                                            0266
*AMDSYND2:                                                         0267
*   GENERATE;                       /* ANALYZE I/O ERROR FOR SYSPRINT*/
*                                                                  0267
AMDSYND2 DS    0H                                                  0267
               SYNADAF ACSMETH=QSAM
*AMDMOVIT:                                                         0268
*   MSGBUF1(1:102)=SYNADMSG(5:106); /* MOVE I/O ERR MSG INTO BUF     */
AMDMOVIT MVC   MSGBUF1(102),SYNADMSG+4(PARMGR1)                    0268
*   GENERATE(SYNADRLS);             /* RELEASE SYNADAF WORKAREA      */
         SYNADRLS
*   MSGBUF1(1:2)='0066'X;           /* SET LENGTH OF MESSAGE         */
         MVC   MSGBUF1(2),@CB00221                                 0270
*   DCBPTR= ADDR(PRINTDCB);         /* SET DCB POINTER TO ADDR OF  0271
*                                      SYSPRINT DCB F OR ERROR     0271
*                                      MESSAGE PROCESSING            */
         LA    DCBPTR,PRINTDCB                                     0271
*   GOTO AMD041I;                   /* GO WRITE MSG AMD041I          */
*                                                                  0272
         B     AMD041I                                             0272
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MESSAGE AMD035I -- OPEN FAILED                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0273
*                                                                  0273
*AMD035I:                                                          0273
*   RCDPTR=AD1;                     /* SET POINTER TO MSG AMD035I    */
AMD035I  L     @10,@CA00146                                        0273
         L     RCDPTR,AD1-AMDMSGTB(,@10)                           0273
*   MSGBUF1(1:MSGLNG)=MESSAGE(1:MSGLNG);     /* MOVE MSG             */
         LH    @10,MSGLNG(,RCDPTR)                                 0274
         BCTR  @10,0                                               0274
         EX    @10,@SM00438                                        0274
*   MSGBUF1(19:26) = DCBDDNAM;      /* PUT DDNAME INTO MSG. DCBPTR 0275
*                                      MUST BE PR EVIOUSLY SET BEFORE
*                                      THIS CODE IS ENTERED          */
*                                                                  0275
         MVC   MSGBUF1+18(8),DCBDDNAM+40(DCBPTR)                   0275
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SYSPRINT OPEN FAILED THEN GO ISSUE A WTO TO SYSOUT         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0276
*   IF DCBPTR = ADDR(PRINTDCB) THEN /* SYSPRINT DCB FAIL?            */
         LA    @10,PRINTDCB                                        0276
         CR    DCBPTR,@10                                          0276
         BE    @RT00276                                            0276
*     GOTO AMDSAWTO;                /* YES GOTO SET UP FOR A WTO   0277
*                                      OPERATION                     */
*                                                                  0277
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A DCB OTHER THAN SYSPRINT FAILED TO OPEN WRITE MSG AMD035I */
*   /* TO SYSPRINT                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0278
*   ELSE                                                           0278
*     DO;                                                          0278
*       BUFPTR= ADDR(MSGBUF1);      /* SET POINTER TO MSG BUFFER     */
         LA    BUFPTR,MSGBUF1                                      0279
*       CALL AMDPRINT;              /* GO WRITE THE ERROR MESSAGE    */
         BAL   @14,AMDPRINT                                        0280
*       GOTO AMDERXIT;              /* BRANCH TO ERROR EXIT          */
         B     AMDERXIT                                            0281
*     END;                                                         0282
*                                                                  0282
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD036I ERROR EXPLANATION 1 -- OBJ CSECT  */
*   /* NOT FOUND                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0283
*                                                                  0283
*AMD036I1:                                                         0283
*   RCDPTR = AD3;                   /* SET POINTER TO THE ERROR MSG  */
AMD036I1 L     @10,@CA00146                                        0283
         L     RCDPTR,AD3-AMDMSGTB(,@10)                           0283
*   MSGBUF2(1:MSGLNG)=MESSAGE(1:MSGLNG);     /* MOVE MSG             */
         LH    @10,MSGLNG(,RCDPTR)                                 0284
         BCTR  @10,0                                               0284
         EX    @10,@SM00440                                        0284
*   MSGBUF2(28:35)=LCACSECT;        /* PUT CSECT NAME IN MSG         */
         MVC   MSGBUF2+27(8),LCACSECT                              0285
*   GOTO AMD036I;                   /* GO GET THE MAIN MSG TEXT      */
*                                                                  0286
         B     AMD036I                                             0286
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD036I ERROR EXPLANATION 2 -- RCDS OUT OF*/
*   /* SEQUENCE                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0287
*                                                                  0287
*AMD036I2:                                                         0287
*   RCDPTR = AD4;                   /* GET ADDRESS OF MSG            */
AMD036I2 L     @10,@CA00146                                        0287
         L     RCDPTR,AD4-AMDMSGTB(,@10)                           0287
*   MSGBUF2(1:MSGLNG)=MESSAGE(1:MSGLNG);     /* MOVE MSG             */
         LH    @10,MSGLNG(,RCDPTR)                                 0288
         BCTR  @10,0                                               0288
         EX    @10,@SM00440                                        0288
*   GOTO AMD036I;                   /* GO GET THE MAIN MSG TXT       */
*                                                                  0289
         B     AMD036I                                             0289
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD036I ERROR EXPLANATION 3 -- END        */
*   /* STATEMENT NOT FOUND                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0290
*                                                                  0290
*AMD036I3:                                                         0290
*   RCDPTR = AD5;                   /* GET ADDRESS OF MSG            */
AMD036I3 L     @10,@CA00146                                        0290
         L     RCDPTR,AD5-AMDMSGTB(,@10)                           0290
*   MSGBUF2(1:MSGLNG)=MESSAGE(1:MSGLNG);     /* MOVE MSG             */
         LH    @10,MSGLNG(,RCDPTR)                                 0291
         BCTR  @10,0                                               0291
         EX    @10,@SM00440                                        0291
*   GOTO AMD036I;                   /* GO GET THE MAIN TXT           */
*                                                                  0292
         B     AMD036I                                             0292
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD036I ERROR EXPLANATION 4 --            */
*   /* UNIDENTIFIABLE RECORD                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0293
*                                                                  0293
*AMD036I4:                                                         0293
*   RCDPTR = AD6;                   /* GET ADDRESS OF MSG            */
AMD036I4 L     @10,@CA00146                                        0293
         L     RCDPTR,AD6-AMDMSGTB(,@10)                           0293
*   MSGBUF2(1:MSGLNG) = MESSAGE(1:MSGLNG);     /* MOVE MSG           */
         LH    @10,MSGLNG(,RCDPTR)                                 0294
         BCTR  @10,0                                               0294
         EX    @10,@SM00440                                        0294
*   GOTO AMD036I;                   /* GO GET THE MAIN TXT           */
*                                                                  0295
         B     AMD036I                                             0295
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE ERROR MESSAGE AMD036I AND ERROR EXPLANATION             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0296
*                                                                  0296
*AMD036I:                                                          0296
*   RCDPTR = AD2;                   /* GET ADDR OF MSG AMD036I       */
AMD036I  L     @10,@CA00146                                        0296
         L     RCDPTR,AD2-AMDMSGTB(,@10)                           0296
*   MSGBUF1(1:MSGLNG)=MESSAGE(1:MSGLNG);     /* MOVE AMD036I         */
         LH    @10,MSGLNG(,RCDPTR)                                 0297
         BCTR  @10,0                                               0297
         EX    @10,@SM00438                                        0297
*   BUFPTR=ADDR(MSGBUF1);           /* POINT TO MSG AMD036I BUFFER   */
         LA    BUFPTR,MSGBUF1                                      0298
*   CALL AMDPRINT;                  /* WRITE AMD036I                 */
         BAL   @14,AMDPRINT                                        0299
*   BUFPTR=ADDR(MSGBUF2);           /* POINT TO EXPLANATION IN BUF2  */
         LA    BUFPTR,MSGBUF2                                      0300
*   CALL AMDPRINT;                  /* WRITE THE ERROR EXPLANATION   */
         BAL   @14,AMDPRINT                                        0301
*   GOTO AMDERXIT;                  /* GO TO THE ERROR EXIT          */
*                                                                  0302
         B     AMDERXIT                                            0302
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD037I --LOAD MODULE NOT FOUND           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0303
*                                                                  0303
*AMD037I:                                                          0303
*   RCDPTR = AD7;                   /* GET MSG AMD037I ADDR          */
AMD037I  L     @10,@CA00146                                        0303
         L     RCDPTR,AD7-AMDMSGTB(,@10)                           0303
*   MSGBUF1(1:MSGLNG)=MESSAGE(1:MSGLNG);     /* MOVE MSG             */
         LH    @10,MSGLNG(,RCDPTR)                                 0304
         BCTR  @10,0                                               0304
         EX    @10,@SM00438                                        0304
*   MSGBUF1(58:65)=LCAMODUL;        /* PUT MODULE NAME IN MSG        */
         MVC   MSGBUF1+57(8),LCAMODUL                              0305
*   BUFPTR=ADDR(MSGBUF1);           /* POINT MESSAGE BUFFER          */
         LA    BUFPTR,MSGBUF1                                      0306
*   CALL AMDPRINT;                  /* GO WRITE THE MESSAGE          */
         BAL   @14,AMDPRINT                                        0307
*   GOTO AMDERXIT;                  /* GO TO ERROR EXIT              */
*                                                                  0308
         B     AMDERXIT                                            0308
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD038I - INVALID PARM= PARAMETER         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0309
*                                                                  0309
*AMD038I:                                                          0309
*   RCDPTR=AD8;                     /* GET ADDR OF MSG AMD038I       */
AMD038I  L     @10,@CA00146                                        0309
         L     RCDPTR,AD8-AMDMSGTB(,@10)                           0309
*   GOTO AMDMGCOM;                  /* GO MOVE MSG INTO BUF          */
*                                                                  0310
         B     AMDMGCOM                                            0310
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD039I -- LOAD MODULE CSECT NOT FOUND    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0311
*                                                                  0311
*AMD039I:                                                          0311
*   RCDPTR=AD9;                     /* GET ADDR OF MSG AMD039I       */
AMD039I  L     @10,@CA00146                                        0311
         L     RCDPTR,AD9-AMDMSGTB(,@10)                           0311
*   MSGBUF1(1:MSGLNG)=MESSAGE(1:MSGLNG);     /* MOVE MSG             */
         LH    @10,MSGLNG(,RCDPTR)                                 0312
         BCTR  @10,0                                               0312
         EX    @10,@SM00438                                        0312
*   MSGBUF1(29:36)=LCAMODUL;        /* PUT MODULE NAME IN MSG        */
         MVC   MSGBUF1+28(8),LCAMODUL                              0313
*   MSGBUF1(61:68)=LCACSECT;        /* PUT CSECT NAME IN MSG         */
         MVC   MSGBUF1+60(8),LCACSECT                              0314
*   BUFPTR=ADDR(MSGBUF1);           /* SET POINTER TO BUFFER         */
         LA    BUFPTR,MSGBUF1                                      0315
*   CALL AMDPRINT;                  /* GO WRITE MSG AMD039I          */
         BAL   @14,AMDPRINT                                        0316
*   GOTO AMDERXIT;                  /* GO TO ERROR EXIT              */
*                                                                  0317
         B     AMDERXIT                                            0317
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD040I -- BLDL I/O ERROR                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0318
*                                                                  0318
*AMD040I:                                                          0318
*   RCDPTR=AD10;                    /* GET ADDR OF MSG AMD040I       */
AMD040I  L     @10,@CA00146                                        0318
         L     RCDPTR,AD10-AMDMSGTB(,@10)                          0318
*   MSGBUF1(1:MSGLNG) = MESSAGE(1:MSGLNG);     /* MOVE MSG           */
         LH    @10,MSGLNG(,RCDPTR)                                 0319
         BCTR  @10,0                                               0319
         EX    @10,@SM00438                                        0319
*   MSGBUF1(62:69) = LCAMODUL;      /* PUT MODULE NAME IN MSG  Y02006*/
         MVC   MSGBUF1+61(8),LCAMODUL                              0320
*   BUFPTR = ADDR(MSGBUF1);         /* SET POINTER TO MSG BUFFER     */
         LA    BUFPTR,MSGBUF1                                      0321
*   CALL AMDPRINT;                  /* GO WRITE THE MSG              */
         BAL   @14,AMDPRINT                                        0322
*   GOTO AMDERXIT;                  /* GO TO ERROR EXIT              */
*                                                                  0323
         B     AMDERXIT                                            0323
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD044I -- RLD ERROR                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0324
*                                                                  0324
*AMD044I1:                                                         0324
*   RCDPTR=AD14;                    /* GET ADDR OF MSG AMD044I Y02006*/
AMD044I1 L     @10,@CA00146                                        0324
         L     RCDPTR,AD14-AMDMSGTB(,@10)                          0324
*   MSGBUF1(1:MSGLNG) = MESSAGE(1:MSGLNG);     /* MOVE MSG Y02006    */
         LH    @10,MSGLNG(,RCDPTR)                                 0325
         BCTR  @10,0                                               0325
         EX    @10,@SM00438                                        0325
*   MSGBUF1(34:41) = LCAMODUL;      /* PUT MODULE NAME IN MSG Y02006 */
         MVC   MSGBUF1+33(8),LCAMODUL                              0326
*   BUFPTR = ADDR(MSGBUF1);         /* SET POINTER TO MSG BUFFER     */
         LA    BUFPTR,MSGBUF1                                      0327
*   CALL AMDPRINT;                  /* GO WRITE THE MSG Y02006       */
         BAL   @14,AMDPRINT                                        0328
*   GOTO AMDERXIT;                  /* GO TO ERROR EXIT Y02006       */
*                                                                  0329
         B     AMDERXIT                                            0329
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD044I -- ENTRY POINT NOT ZERO           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0330
*                                                                  0330
*AMD044I2:                                                         0330
*   RCDPTR=AD14;                    /* GET ADDR OF MSG AMD044I Y02006*/
AMD044I2 L     @10,@CA00146                                        0330
         L     RCDPTR,AD14-AMDMSGTB(,@10)                          0330
*   MSGBUF1(1:MSGLNG) = MESSAGE(1:MSGLNG);     /* MOVE MSG Y02006    */
         LH    @15,MSGLNG(,RCDPTR)                                 0331
         BCTR  @15,0                                               0331
         EX    @15,@SM00438                                        0331
*   MSGBUF1(34:41) = LCAMODUL;      /* PUT MODULE NAME IN MSG Y02006 */
         MVC   MSGBUF1+33(8),LCAMODUL                              0332
*   RCDPTR=AD15;                    /* GET ADDR OF ERROR INDICATOR   */
         L     RCDPTR,AD15-AMDMSGTB(,@10)                          0333
*   MSGBUF1(45:44+MSGLNG) = MESSAGE(5:MSGLNG-4); /* MOVE MSG   Y02006*/
         LH    @10,MSGLNG(,RCDPTR)                                 0334
         BCTR  @10,0                                               0334
         EX    @10,@SM00442                                        0334
*   BUFPTR = ADDR(MSGBUF1);         /* SET POINTER TO MSG BUFFER     */
         LA    BUFPTR,MSGBUF1                                      0335
*   CALL AMDPRINT;                  /* GO WRITE THE MSG Y02006       */
         BAL   @14,AMDPRINT                                        0336
*   GOTO AMDERXIT;                  /* GO TO ERROR EXIT Y02006       */
*                                                                  0337
         B     AMDERXIT                                            0337
*   /*****************************************************************/
*   /*                                                               */
*   /* SYNADAF MESSAGE TXT IS ALREADY IN MSG BUFFER, BUT MUST GET MSG*/
*   /* ID AND MAIN TEXT                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0338
*                                                                  0338
*AMD041I:                                                          0338
*   RCDPTR = AD11;                  /* GET ADDR OF MSG AMD041I       */
AMD041I  L     @10,@CA00146                                        0338
         L     RCDPTR,AD11-AMDMSGTB(,@10)                          0338
*   MSGBUF1(5:MSGLNG) = MESSAGE(5:MSGLNG); /* MOVE MSG               */
*                                                                  0339
         LH    @10,MSGLNG(,RCDPTR)                                 0339
         SH    @10,@CH00219                                        0339
         EX    @10,@SM00444                                        0339
*   /*****************************************************************/
*   /*                                                               */
*   /* IF I/O ERROR OCURRED ON SYSPRINT GO SET UP TO WRITE I/O ERROR */
*   /* MSG TO SYSOUT VIA A WTO                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0340
*   IF DCBPTR = ADDR(PRINTDCB) THEN /* ERROR DCB SYSPRINT?           */
         LA    @10,PRINTDCB                                        0340
         CR    DCBPTR,@10                                          0340
         BE    @RT00340                                            0340
*     GOTO AMDSAWTO;                /* YES GO SET UP FOR WTO TO    0341
*                                      SYSOUT                        */
*   ELSE                                                           0342
*                                                                  0342
*   /*****************************************************************/
*   /*                                                               */
*   /* IF I/O ERROR OCCURRED ON OTHER THAN SYSPRINT DATA SET THEN    */
*   /* WRITE MSG AMD041I TO SYSPRINT                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0342
*     DO;                                                          0342
*       BUFPTR=ADDR(MSGBUF1);       /* SET POINTER TO MSG BUFFER     */
         LA    BUFPTR,MSGBUF1                                      0343
*       CALL AMDPRINT;              /* GO WRITE MSG AMD041I          */
         BAL   @14,AMDPRINT                                        0344
*       GOTO AMDERXIT;              /* GO TO ERROR EXIT              */
         B     AMDERXIT                                            0345
*     END;                                                         0346
*                                                                  0346
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO WRITE MSG AMD042I -- GETMAIN FAILED                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0347
*                                                                  0347
*AMD042I:                                                          0347
*   RCDPTR = AD12;                  /* GET ADDR OF MSG AMD042I       */
AMD042I  L     @10,@CA00146                                        0347
         L     RCDPTR,AD12-AMDMSGTB(,@10)                          0347
*   GOTO AMDMGCOM;                  /* GO TO MOVE MSG                */
*                                                                  0348
         B     AMDMGCOM                                            0348
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR ISSUING A WTO TO SYSOUT. ERROR MSG IS ALREADY IN   */
*   /* THE BUFFER                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0349
*                                                                  0349
*AMDSAWTO:                                                         0349
*   RCDPTR= ADDR(MSGBUF1);          /* POINT TO MSG BUFFER           */
AMDSAWTO LA    RCDPTR,MSGBUF1                                      0349
*   MSGBUF1(5:MSGLNG-1) = MSGBUF1(6:MSGLNG); /* REMOVE CNTRL CHAR    */
         LH    @10,MSGLNG(,RCDPTR)                                 0350
         LR    @15,@10                                             0350
         SH    @15,@CH00102                                        0350
         MVC   @TS00001(125),MSGBUF1+5                             0350
         EX    @15,@SM00446                                        0350
*   MSGLNG= MSGLNG-1;               /* DECREMENT LNG BY 1            */
         BCTR  @10,0                                               0351
         STH   @10,MSGLNG(,RCDPTR)                                 0351
*   MSGBUF1(3)= '80'X;              /* INDICATE RTE & DESCR CODES  0352
*                                      PRESENT                       */
         MVI   MSGBUF1+2,X'80'                                     0352
*   MSGBUF1(MSGLNG+1:MSGLNG+4) = WTOCODES; /* MOVE IN RTE & DESCR  0353
*                                      CODES                         */
         LA    @15,MSGBUF1(@10)                                    0353
         MVC   0(4,@15),WTOCODES                                   0353
*   RESPECIFY PARMGR1 RESTRICTED;                                  0354
*   PARMGR1 = RCDPTR;               /* PUT BUF ADDR IN PARMREG Y02006*/
         LR    PARMGR1,RCDPTR                                      0355
*   GENERATE(WTO MF=(E,(1)));       /* ISSUE WRITE TO PROGRAMMER     */
         WTO MF=(E,(1))
*   GOTO AMDERXIT;                  /* GO TO ERROR EXIT              */
         B     AMDERXIT                                            0357
*   RESPECIFY PARMGR1 UNRESTRICTED;                                0358
*                                                                  0358
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON MESSAGE MOVING CODE. RCDPTR CONTAINS ADDR OF MESSAGE   */
*   /* TXT UPON ENTRY TO THIS CODE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0359
*                                                                  0359
*AMDMGCOM:                                                         0359
*   MSGBUF1(1:MSGLNG) = MESSAGE(1:MSGLNG);     /* MOVE MSG INTO    0359
*                                      BUFFER                        */
AMDMGCOM LH    @10,MSGLNG(,RCDPTR)                                 0359
         BCTR  @10,0                                               0359
         EX    @10,@SM00438                                        0359
*   BUFPTR = ADDR(MSGBUF1);         /* SET POINTER TO MSG BUFFER     */
         LA    BUFPTR,MSGBUF1                                      0360
*   CALL AMDPRINT;                  /* GO WRITE THE MESSAGE          */
*                                                                  0361
         BAL   @14,AMDPRINT                                        0361
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDSALDR ERROR EXIT                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0362
*                                                                  0362
*AMDERXIT:                                                         0362
*   RETRNCOD= 4;                    /* SET ERROR CODE TO BE RETURNED
*                                      TO THE SYSTEM                 */
*                                                                  0362
AMDERXIT LA    RETRNCOD,4                                          0362
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDSALDR CLEANUP PROCESSING PRIOR TO EXITING                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0363
*                                                                  0363
*AMDCLNUP:                                                         0363
*   IF RETRNCOD = 0 THEN            /* LOADER MAKER COMPLETE NORMALLY*/
AMDCLNUP LTR   RETRNCOD,RETRNCOD                                   0363
         BNZ   @RF00363                                            0363
*     DO;                           /* FOR SUCCESSFUL MSG ?          */
*       RCDPTR = AD13;              /* MOVE IN SUCCESS MSG           */
         L     @10,@CA00146                                        0365
         L     RCDPTR,AD13-AMDMSGTB(,@10)                          0365
*       MSGBUF1(1:MSGLNG) = MESSAGE(1:MSGLNG);     /* MOVE MSG INTO
*                                      BUFFER                        */
         LH    @10,MSGLNG(,RCDPTR)                                 0366
         BCTR  @10,0                                               0366
         EX    @10,@SM00438                                        0366
*       BUFPTR = ADDR(MSGBUF1);     /* SET POINTER TO MSG BUFFER     */
         LA    BUFPTR,MSGBUF1                                      0367
*       CALL AMDPRINT;              /* GO WRITE THE MESSAGE          */
         BAL   @14,AMDPRINT                                        0368
*     END;                          /* CLOSE ALL DATA SETS           */
*   GENERATE;                       /* UNCONDITIONALLY CLOSE ALL DCBS*/
*                                                                  0370
@RF00363 DS    0H                                                  0370
         CLOSE  (PRINTDCB,,SYS1DCB,,SYS2DCB,,SYS3DCB,,SYS4DCB)
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CORE WAS OBTAINED FOR AN OUTPUT BUFFER FREE THE CORE       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0371
*   RESPECIFY (WKREG) RESTRICTED;                                  0371
*   IF OTBUFADD ^= 0 THEN                                          0372
         L     @10,OTBUFADD                                        0372
         LTR   @10,@10                                             0372
         BZ    @RF00372                                            0372
*     DO;                           /* TEST FOR AN OUTPUT BUFFER ADDR*/
*       WKREG = OTBUFSIZ;           /* YES, GET BUFSIZE AND FREE IT  */
         L     WKREG,OTBUFSIZ                                      0374
*       GENERATE;                                                  0375
          FREEMAIN   E,LV=(WKREG),A=OTBUFADD
*     END;                                                         0376
*                                                                  0376
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CORE WAS OBTAINED FOR AN INPUT BUFFER FREE THE CORE        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0377
*   IF INBUFADD ^= 0 THEN                                          0377
@RF00372 L     @10,INBUFADD                                        0377
         LTR   @10,@10                                             0377
         BZ    @RF00377                                            0377
*     DO;                           /* TEST FOR AN INPUT BUFFER ADDR */
*       WKREG=INBUFSIZ * 2;         /* YES, GET BUFSIZE AND FREE IT
*                                      Y02006                        */
         LH    WKREG,INBUFSIZ                                      0379
         AR    WKREG,WKREG                                         0379
*       GENERATE;                                                  0380
          FREEMAIN E,LV=(WKREG),A=INBUFADD
*     END;                                                         0381
*   RESPECIFY (WKREG) UNRESTRICTED;                                0382
*                                                                  0382
@RF00377 DS    0H                                                  0383
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDSALDR EXIT TO SYSTEM                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0383
*   RETURN CODE(RETRNCOD);                                         0383
*                                                                  0383
         LR    @15,RETRNCOD                                        0383
         L     @13,4(,@13)                                         0383
         L     @14,12(,@13)                                        0383
         LM    @00,@12,20(@13)                                     0383
         BR    @14                                                 0383
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDSALDR WRITE ROUTINES:                                      */
*   /*                                                               */
*   /*       THE FOLLOWING PROCEDURE CONTAINS TWO WRITE ROUTINES. ONE*/
*   /*       ROUTINE IS FOR WRITING TO SYSUT3 AND SYSUT4. THE OTHER  */
*   /*       ROUTINE IS FOR WRITING ERROR MESSAGES TO SYSPRINT.      */
*   /*                                                               */
*   /* ENTRYS:                                                       */
*   /*                                                               */
*   /*       AMDWRITE IS THE ENTRY POINT FOR WRITING TO SYSUT3 OR    */
*   /*       SYSUT4 LCAOTPUT MUST POINT TO THE BEGINNING OF THE      */
*   /*       RECORD AND LCAOTEOR MUST POINT TO THE END OF THE RECORD */
*   /*       TO BE WRITTEN. ALSO LCAOTDCB MUST CONTAIN THE ADDRESS OF*/
*   /*       THE DCB FOR THE DATA SET TO WHICH THE RECORD IS TO BE   */
*   /*       WRITTEN. AMDPRINT IS THE ENTRY POINT FOR WRITING ERROR  */
*   /*       MESSAGES TO SYSPRINT. BUFPTR MUST CONTAIN THE ADDRESS OF*/
*   /*       THE MESSAGE BUFFER WHEN CONTROL IS PASSED TO THIS ENTRY */
*   /*       POINT.                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0384
*                                                                  0384
*AMDSAIO:                                                          0384
*   PROCEDURE OPTIONS(DONTSAVE,NOSAVEAREA);                        0384
AMDSAIO  DS    0H                                                  0385
*   RESPECIFY (DCBPTR,BUFPTR,WKREG) RESTRICTED;                    0385
*   DCL                                                            0386
*         IOSAV14 FIXED(31);        /* SAVEAREA FOR REG 14           */
*                                                                  0386
*   /*****************************************************************/
*   /*                                                               */
*   /* SYSUT3 AND SYSUT4 WRITE PROCESSING                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0387
*                                                                  0387
*AMDWRITE:                                                         0387
*   ENTRY;                                                         0387
         B     @EC00387                                            0387
AMDWRITE DS    0H                                                  0387
@EC00387 DS    0H                                                  0388
*   RESPECIFY (PARMGR1,RETRNREG) RESTRICTED;                       0388
*   IOSAV14 = RETRNREG;             /* SAVE REG 14                   */
         LR    IOSAV14,RETRNREG                                    0389
*   RESPECIFY RETRNREG UNRESTRICTED;                               0390
*   DCBPTR = LCAOTDCB;              /* GET DCB ADDRESS FOR WRITE     */
         L     DCBPTR,LCAOTDCB                                     0391
*   BUFPTR =LCAOTPUT;               /* GET ADDR OF BEGIN OF RCD      */
         L     @10,LCAOTPUT                                        0392
         LR    BUFPTR,@10                                          0392
*   WKREG = LCAOTEOR - LCAOTPUT;    /* CALCULATE RCD LNG             */
         LCR   @10,@10                                             0393
         A     @10,LCAOTEOR                                        0393
         LR    WKREG,@10                                           0393
*   PARMGR1 = ADDR(SYSDECB);        /* GET DECB ADDR Y02006          */
         LA    PARMGR1,SYSDECB                                     0394
*   GENERATE FLOWS(AMDSYND1);       /* WRITE THE RCD                 */
          WRITE (PARMGR1),SF,(DCBPTR),(BUFPTR),(WKREG),,,MF=E    Y02006
          CHECK (PARMGR1)                                        Y02006
*   GOTO AMDIOXIT;                  /* RETURN BACK TO CALLER         */
*                                                                  0396
         B     AMDIOXIT                                            0396
*   /*****************************************************************/
*   /*                                                               */
*   /* SYSPRINT I/O PROCESSING                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0397
*                                                                  0397
*AMDPRINT:                                                         0397
*   ENTRY;                                                         0397
AMDPRINT DS    0H                                                  0398
*   RESPECIFY RETRNREG RESTRICTED;                                 0398
*   IOSAV14 = RETRNREG;             /* SAVE REG 14                   */
         LR    IOSAV14,RETRNREG                                    0399
*   GENERATE FLOWS(AMDSYND2);       /* WRITE THE MSG                 */
    PUT PRINTDCB,(BUFPTR)
*   RESPECIFY (DCBPTR,BUFPTR,WKREG) UNRESTRICTED;                  0401
*                                                                  0401
*AMDIOXIT:                                                         0402
*   RETRNREG= IOSAV14;              /* RESTORE REG 14                */
AMDIOXIT LR    RETRNREG,IOSAV14                                    0402
*   RESPECIFY RETRNREG UNRESTRICTED;                               0403
*   RETURN;                         /* RETURN BACK TO CALLER         */
@EL00002 DS    0H                                                  0404
@EF00002 DS    0H                                                  0404
@ER00002 BR    @14                                                 0404
*   END AMDSAIO;                                                   0405
*                                                                  0405
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDSATXT:                                                     */
*   /*                                                               */
*   /*       THIS SUBROUTINE OF AMDSALDR DOES THE ACTUAL REMOVAL OF  */
*   /*       CONTROL INFORMATION FROM OBJ CSECTS OR LOAD MODULES SO  */
*   /*       THAT ONLY THE TEXT REMAINS. WHEN IT IS ENTERED THE      */
*   /*       LCAFUNC BIT MUST INDICATE WHETHER A LOAD MODULE CSECT OR*/
*   /*       OBJECT CSECT IS TO BE PROCESSED. ALSO LCAINDCB MUST     */
*   /*       CONTAIN THE ADDRESS OF THE DCB FOR THE INPUT DATA SET,  */
*   /*       LCAINPUT MUST POINT TO AN INPUT BUFFER, AND LCAOTPUT    */
*   /*       MUST POINT TO A BUFFER IN WHICH THE TEXT IS TO BE MOVED.*/
*   /*       IF A LOAD MODULE IS TO BE PROCESSED THEN ITS NAME AND   */
*   /*       THE CSECT MUST BE IN LCAMODUL AND LCACSECT RESPECTIVELY.*/
*   /*       IF AN OBJECT CSECT IS TO BE PROCESSED ONLY THE LCACSECT */
*   /*       FIELD IS REQUIRED TO CONTAIN THE CSECT NAME. WHEN       */
*   /*       AMDSATXT EXITS LCAOTPUT WILL POINT TO THE BEGINNING OF  */
*   /*       THE TEXT THAT WAS MOVED INTO THE THE BUFFER AND LCAOTEOR*/
*   /*       WILL POINT TO THE END OF THE TEXT.                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0406
*                                                                  0406
*AMDSATXT:                                                         0406
*   PROCEDURE;                      /* STANDARD LINKAGE CONVENTIONS
*                                      ARE USED                      */
AMDSATXT STM   @14,@12,@SA00003                                    0406
*   DCL                                                            0407
*         CTLSTART PTR(31);         /* PTR TO CNTRL ENTRIES IN A MOD
*                                      CNTRL RCD                     */
*   DCL                                                            0408
*         CTLEND PTR(31);           /* PTR TO END OF CONTRL ENTRIES
*                                      IN MOD CNTRL R CD             */
*   DCL                                                            0409
*         ENTRYPTR PTR(31) REG(6);  /* USED AS PTR TO ESD ENTRIES    */
*   DCL                                                            0410
*                                   /* POINTER TO INPUT IOB          */
*         IOBPTR PTR(31) BASED(DECBPTR+16);                        0410
*   DCL                                                            0411
*                                   /* RESIDUAL CNT IN INPUT CSW     */
*         CSWRESID FIXED(15) BASED(IOBPTR+14);                     0411
*   DCL                                                            0412
*                                   /* USED TO REF. OBJ AND MOD RCD
*                                      ID'S                          */
*         RCDID CHAR(1) BASED(RCDPTR);                             0412
*   DCL                                                            0413
*                                   /* USED TO REF. OBJ RCD TYPES --
*                                      ESD, TXT , ETC.               */
*         RCDTYPE CHAR(3) BASED(RCDPTR+1);                         0413
*   DCL                                                            0414
*         BLKEND FIXED(31);         /* USED WHEN DEBLOCKING OBJ INPUT
*                                      -- POINTS TO END OF PHYSICAL
*                                      RECORD IN BUFFER              */
*   DCL                                                            0415
*         OBJID CHAR(1) INIT('02'X);/* OBJ RCD ID                    */
*   DCL                                                            0416
*         BUFNDX1 FIXED(31);        /* BUFFER INDEX FOR MOVING IN TXT*/
*   DCL                                                            0417
*         BUFNDX2 FIXED(31);        /* BUFERR INDEX FOR MOVING IN TXT*/
*   DCL                                                            0418
*         CSECTORG FIXED(31);       /* SAVEAREA FOR START ADDR OF  0418
*                                      CSECT                         */
*   DCL                                                            0419
*         CSECTEND FIXED(31);       /* SAVEAREA FOR END ADDR OF CSECT*/
*   DCL                                                            0420
*                                   /* USED TO REF. ESD RCD COUNT  0420
*                                      FIELD FOR NUMBER OF ESD     0420
*                                      ENTRIES                       */
*         ESDCNT FIXED(15) BASED(RCDPTR+10);                       0420
*   DCL                                                            0421
*                                   /* USED TO REF. CESD RCD COUNT 0421
*                                      FIELD FOR NUMBER OF CESD    0421
*                                      ENTRIES                       */
*         CESDCNT FIXED(15) BASED(RCDPTR+6);                       0421
*   DCL                                                            0422
*         OFFSET1 FIXED(31);        /* OFFSET OF FIRST BYTE OF TXT 0422
*                                      DATA IN INPU T BUFFER TO BE 0422
*                                      MOVED                         */
*   DCL                                                            0423
*         OFFSET2 FIXED(31);        /* OFFSET OF LAST BYTE OF TXT IN
*                                      INPUT BUF FER TO BE MOVED     */
*   DCL                                                            0424
*         LMRCDLNG FIXED(31);       /* LOAD MODULE RCD LENGTH  YM0651*/
*   DCL                                                            0425
*         IOBCSWCT FIXED(15) BASED(DCBIOBA+22); /* RESIDUAL COUNT IN
*                                      CSW                     YM0651*/
*   DCL                                                            0426
*         DCBIOBA PTR(31) BASED(DCBPTR+68); /* ADDRESS OF IOB  YM0651*/
*   DCL                                                            0427
*         I FIXED(31);              /* USED IN DO LOOPS FOR COUNTER  */
*   DCL                                                            0428
*         RLDBUF1 PTR(31);          /* ADDR OF FIRST BUFFER    Y02006*/
*   DCL                                                            0429
*         RLDBUF2 PTR(31);          /* ADDR OF SECOND BUFFER Y02006  */
*   DCL                                                            0430
*         1 BLDLAREA BDY(HWORD),    /* BLDL PARAMETER LIST     Y02006*/
*           3 * FIXED(15) INIT(1),  /* 1 ENTRY IN LIST         Y02006*/
*           3 * FIXED(15) INIT(32), /* LENGTH OF LIST          Y02006*/
*           3 BLDLNAME CHAR(8),     /* MODULE NAME             Y02006*/
*           3 BLDLTTRK CHAR(4),     /* STARTING TTR            Y02006*/
*           3 * CHAR(12),           /* UNUSED                  Y02006*/
*           3 BLDLMLEN CHAR(3),     /* VIRTUAL STORAGE         Y02006
*                                      REQUIRED BY MODULE      Y02006*/
*           3 BLDLTXT1 CHAR(2),     /* LENGTH OF TEXT RECORDS  Y02006*/
*           3 * CHAR(3);            /* UNUSED                  Y02006*/
*                                                                  0430
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING TABLE DEFINES ALL THE POSSIBLE OBJ RECORD TYPES */
*   /* THAT ARE PROCESSED BY AMDSATXT                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0431
*   DCL                                                            0431
*         1 OBJTYPS,                                               0431
*             3 ESD CHAR(3) INIT('ESD'),                           0431
*             3 TXT CHAR(3) INIT('TXT'),                           0431
*             3 ENDD CHAR(3) INIT('END'),                          0431
*             3 RLD CHAR(3) INIT('RLD');                           0431
*                                                                  0431
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE DEFINES THE FIRST 14 BYTES OF A LOAD  */
*   /* MODULE CONTROL RECORD                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0432
*   DCL                                                            0432
*         1 CTLPREFX BASED(RCDPTR),                                0432
*             3 CTLID CHAR(1),      /* CNTRL RCD ID                  */
*                 5 NOTCHKED BIT(7),                               0432
*                 5 CTLIDBIT BIT(1), /* INDICATES CNTRL RCD          */
*             3 CTLRSRVD CHAR(3),                                  0432
*             3 CTLCNT FIXED(15),   /* NUMBER OF BYTES OF CNTRL DATA */
*             3 CTLRLDCT FIXED(15), /* NUMBER FO BYTES OF RLD DATA   */
*             3 CTLCCW CHAR(8);     /* CNTRL RCD CCW FIELD           */
*                                                                  0432
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE DEFINES THE FORMAT OF A CONTROL ENTRY */
*   /* IN A CONTROL RECORD                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0433
*   DCL                                                            0433
*         1 CTLENTRY BASED(ENTRYPTR),                              0433
*             3 ENTRYID FIXED(15),  /* IDENTIFIES CSECT THIS ENTRY IS
*                                      FO R                          */
*             3 TXTSIZE FIXED(15);  /* NUMBER OF BYTES IN FOLLOWING
*                                      TXT R CD FOR THE CSECT      0433
*                                      IDENTIFIEDBY THE ENTRY ID     */
*                                                                  0433
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE DEFINES THE FORMAT OF AN OBJ TXT      */
*   /* RECORD                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0434
*   DCL                                                            0434
*         1 TXTFMT BASED(RCDPTR),                                  0434
*             3 TXTIDENT CHAR(1),   /* TXT OBJ ID - X'02'            */
*             3 TXTTYPE CHAR(3),    /* TYPE OF TXT RCD               */
*             3 TXTBLNK1 CHAR(1),   /* UNUSED                        */
*             3 TXTADDR PTR(24),    /* CSECT ADDR FOR FIRST BYTE OF
*                                      DATA I N THIS TXT             */
*             3 TXTBLNK2 CHAR(2),   /* NOT USED                      */
*             3 TXTLNG FIXED(15),   /* NUMBER OF BYTES OF TXT DATA   */
*             3 TXTBLNK3 CHAR(2),   /* UNUSED                        */
*             3 TXTSDID CHAR(2),    /* SECTION DEF. ID               */
*             3 TXTDATA CHAR(56);   /* TXT DATA BYTES                */
*                                                                  0434
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE DEFINES THE FORMAT OF AN ESD/CESD     */
*   /* ENTRY                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0435
*   DCL                                                            0435
*         1 ESDENTRY BASED(ENTRYPTR),                              0435
*             3 ESDNAME CHAR(8),    /* CSECT NAME                    */
*             3 * BIT(4),           /* UNUSED ESD IDENTIFIER FOR LE  */
*             3 ESDTYPE BIT(4),     /* ESD TYPE                      */
*             3 ESDADDR PTR(24),    /* START ADDR OF CSECT           */
*             3 ESDSEG CHAR(1),     /* NOT USED BY AMDSATXT          */
*             3 ESDLNG PTR(24);     /* LENGTH OF CSECT               */
*                                                                  0435
*   /*****************************************************************/
*   /*                                                               */
*   /* BEGIN TEXT PROCESSING                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0436
*   RESPECIFY (DCBPTR,BUFPTR,DECBPTR,RCDPTR) RESTRICTED;           0436
*   DCBPTR=LCAINDCB;                /* SET POINTER TO INPUT DCB      */
         L     DCBPTR,LCAINDCB                                     0437
*   DECBPTR=ADDR(SYSDECB);          /* SET POINTER TO THE DECB       */
         LA    DECBPTR,SYSDECB                                     0438
*   BUFPTR=LCAOTPUT;                /* SET POINTER TO OUTPUT BUFFER  */
         L     BUFPTR,LCAOTPUT                                     0439
*   LCAWKFLG='00'X;                 /* CLEAR WORK FLAGS              */
*                                                                  0440
         MVI   LCAWKFLG,X'00'                                      0440
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF OBJ CSECT OR LOAD MODULE CSECT IS TO BE PROCESSED*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0441
*   IF LCAFUNC='1'B THEN            /* MODULE TO BE PROC ?           */
         TM    LCAFUNC,B'10000000'                                 0441
         BO    @RT00441                                            0441
*     GOTO AMDFIND;                 /* YES, GO TO FIND MODULE        */
*   RESPECIFY (ENTRYPTR) RESTRICTED;                               0443
*                                                                  0443
*   /*****************************************************************/
*   /*                                                               */
*   /* READ AN OBJECT RECORD FOR ESD PROCESSING                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0444
*                                                                  0444
*AMDOBJ:                                                           0444
*   RCDPTR=LCAINPUT;                /* POINT TO INPUT BUFFER         */
AMDOBJ   L     RCDPTR,LCAINPUT                                     0444
*   GENERATE FLOWS(AMDSYND3,AMDOBEOD); /* READ A PHYSICAL BLOCK      */
          READ (DECBPTR),SF,(DCBPTR),(RCDPTR),'S',,,MF=E
          CHECK (DECBPTR)
*   BLKEND = RCDPTR + (DCBBLKSI - CSWRESID); /* POINT TO END FO BLK  */
*                                                                  0446
         L     @10,IOBPTR+16(,DECBPTR)                             0446
         LH    BLKEND,DCBBLKSI+62(,DCBPTR)                         0446
         SH    BLKEND,CSWRESID+14(,@10)                            0446
         AR    BLKEND,RCDPTR                                       0446
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LOGICAL RECORD IS A VALID OBJ RECORD AND THEN IF IT'S*/
*   /* AN ESD TYPE SEARCH THE ESD ENTRIES FOR A MATCH ON THE CSECT   */
*   /* NAME IN THE LCACSECT FIELD                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0447
*                                                                  0447
*AMDESD:                                                           0447
*   IF RCDID=OBJID THEN             /* IS RCD AN OBJ ESD RCD?        */
AMDESD   CLC   RCDID(1,RCDPTR),OBJID                               0447
         BNE   @RF00447                                            0447
*     IF RCDTYPE=ESD THEN                                          0448
         CLC   RCDTYPE+1(3,RCDPTR),ESD                             0448
         BNE   @RF00448                                            0448
*       DO;                         /* YES, DO FOLLOWING             */
*         ENTRYPTR= RCDPTR + 16;      /* POSITION TO ESD ENTRIES     */
*                                                                  0450
         LA    ENTRYPTR,16                                         0450
         AR    ENTRYPTR,RCDPTR                                     0450
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH ESD ENTRIES                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0451
*         DO I=ESDCNT TO 0 BY -16;                                 0451
         LH    I,ESDCNT+10(,RCDPTR)                                0451
         B     @DE00451                                            0451
@DL00451 DS    0H                                                  0452
*           IF ESDTYPE='0000'B THEN /* IS ESD A SECTION DEF. ?       */
         TM    ESDTYPE(ENTRYPTR),B'00001111'                       0452
         BNZ   @RF00452                                            0452
*             IF ESDNAME=LCACSECT THEN /* IS THIS THE ENTRY FOR THE
*                                      CSEC T?                       */
         CLC   ESDNAME(8,ENTRYPTR),LCACSECT                        0453
         BE    @RT00453                                            0453
*               GOTO AMDOBTXT;      /* YES, GO PROCESS TXT DATA      */
*           ENTRYPTR = ENTRYPTR +16;      /* NO, POINT TO NEXT ENTRY */
@RF00452 AH    ENTRYPTR,@CH00280                                   0455
*         END;                                                     0456
*                                                                  0456
         AH    I,@CH00358                                          0456
@DE00451 LTR   I,I                                                 0456
         BNM   @DL00451                                            0456
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ESD RECORD DOESN'T CONTAIN THE ESD ENTRY FOR THE CSECT GET */
*   /* NEXT LOGICAL RECORD AND GO CHECK IT                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0457
*         RCDPTR= RCDPTR + DCBLRECL; /* POINT TO NEXT LOGICAL RCD    */
         AH    RCDPTR,DCBLRECL+82(,DCBPTR)                         0457
*         IF RCDPTR >= BLKEND THEN  /* END OF BLOCK REACHED?         */
         CR    RCDPTR,BLKEND                                       0458
         BNL   @RT00458                                            0458
*           GOTO AMDOBJ;            /* YES, GO READ A PHYSICAL RECORD*/
*         ELSE                                                     0460
*           GOTO AMDESD;            /* NO, GO CHECK FOR AN ESD RECORD*/
         B     AMDESD                                              0460
*       END;                                                       0461
*     ELSE                                                         0462
*                                                                  0462
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A NON ESD TYPE OBJ RECORD IS ENCOUNTERED BEFORE FINDING THE*/
*   /* ESD ENTRY FOR THE CSECT THEN THE CSECT NAME MUST BE INVALID OR*/
*   /* ELSE WRONG OBJECT DECK                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0462
*       RETRNCOD = 3;               /* SET OBJ CSECT NOT FND ERR CODE*/
@RF00448 LA    RETRNCOD,3                                          0462
*   ELSE                                                           0463
*                                                                  0463
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LOGICAL RECORD DOESN'T HAVE AN OBJ ID THEN SET RETURN CODE */
*   /* AND EXIT                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0463
*     RETRNCOD = 6;                 /* SET UNIDENTIFIABLE RCD ERR  0463
*                                      CODE                          */
         B     @RC00447                                            0463
@RF00447 LA    RETRNCOD,6                                          0463
*   GOTO AMDEXIT;                   /* RETURN TO MAINLINE ROUTINE    */
*                                                                  0464
         B     AMDEXIT                                             0464
*   /*****************************************************************/
*   /*                                                               */
*   /* ESD ENTRY FOUND --- PROCESS TXT FOR CSECT                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0465
*                                                                  0465
*AMDOBTXT:                                                         0465
*   LCANMFND='1'B;                  /* INDICATE NAME FOUND           */
AMDOBTXT OI    LCANMFND,B'00010000'                                0465
*   CSECTORG=ESDADDR;               /* SAVE START ADDR OF CSECT      */
         L     @10,ESDADDR-1(,ENTRYPTR)                            0466
         LA    @10,0(,@10)                                         0466
         ST    @10,CSECTORG                                        0466
*   CSECTEND = ESDADDR + ESDLNG;    /* SAVE ADDR OF END OF CSECT     */
         MVC   @ZT00001+1(3),ESDLNG(ENTRYPTR)                      0467
         A     @10,@ZT00001                                        0467
         ST    @10,CSECTEND                                        0467
*   RESPECIFY (ENTRYPTR) UNRESTRICTED;                             0468
*                                                                  0468
*AMDTXT:                                                           0469
*   RCDPTR= RCDPTR+DCBLRECL;        /* POINT TO NEXT LOGICAL RCD     */
AMDTXT   AH    RCDPTR,DCBLRECL+82(,DCBPTR)                         0469
*   IF RCDPTR >= BLKEND THEN        /* END OF BLOCK?                 */
         CR    RCDPTR,BLKEND                                       0470
         BL    @RF00470                                            0470
*     DO;                           /* YES DO FOLLOWING              */
*       RCDPTR=LCAINPUT;            /* POINT TO INPUT BUFFER         */
         L     RCDPTR,LCAINPUT                                     0472
*       GENERATE FLOWS(AMDSYND3,AMDOBEOD); /* READ A PHYSICAL RECORD */
          READ (DECBPTR),SF,(DCBPTR),(RCDPTR),'S',,,MF=E
          CHECK (DECBPTR)
*       BLKEND =RCDPTR + (DCBBLKSI-CSWRESID); /* POINT TO END OF   0474
*                                      BLOCK                         */
         L     @10,IOBPTR+16(,DECBPTR)                             0474
         LH    BLKEND,DCBBLKSI+62(,DCBPTR)                         0474
         SH    BLKEND,CSWRESID+14(,@10)                            0474
         AR    BLKEND,RCDPTR                                       0474
*     END;                                                         0475
*                                                                  0475
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LOGICAL RECORD IS AN OBJECT RECORD                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0476
*   IF RCDID ^= OBJID THEN          /* IS RCD AN OBJ RCD?            */
@RF00470 CLC   RCDID(1,RCDPTR),OBJID                               0476
         BE    @RF00476                                            0476
*     DO;                           /* NO, DO FOLLOWING              */
*       RETRNCOD = 6;               /* SET UNIDENTIFIABLE RCD ERR  0478
*                                      CODE                          */
         LA    RETRNCOD,6                                          0478
*       GOTO AMDEXIT;               /* RETURN TO THE MAINLINE ROUTINE*/
         B     AMDEXIT                                             0479
*     END;                                                         0480
*                                                                  0480
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF OBJECT RECORD IS AN END STATEMENT. IF SO SET END     */
*   /* SWITCH AND GET NEXT RECORD                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0481
*   IF RCDTYPE=ENDD THEN            /* IS OBJ RCD AN END RCD?        */
@RF00476 CLC   RCDTYPE+1(3,RCDPTR),ENDD                            0481
         BNE   @RF00481                                            0481
*     DO;                           /* YES DO FOLLOWING              */
*       LCAENDSW = '1'B;            /* SET END SWITCH ON             */
         OI    LCAENDSW,B'00100000'                                0483
*       GOTO AMDTXT;                /* GO GET NEXT LOGICAL RCD       */
         B     AMDTXT                                              0484
*     END;                                                         0485
*                                                                  0485
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF OBJECT RECORD IS A TEXT RECORD                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0486
*   IF RCDTYPE = TXT THEN           /* OBJ RCD A TXT RCD?            */
@RF00481 CLC   RCDTYPE+1(3,RCDPTR),TXT                             0486
         BNE   @RF00486                                            0486
*     DO;                           /* YES DO FOLLOWING              */
*                                                                  0487
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE END RCD HAS BEEN READ PRIOR TO READING THE TEXT RECORD */
*   /* THE RECORDS MUST BE OUT OF SEQUENCE                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0488
*       IF LCAENDSW='1'B THEN       /* HAS THE END RCD BEEN READ?    */
         TM    LCAENDSW,B'00100000'                                0488
         BNO   @RF00488                                            0488
*         DO;                                                      0489
*           RETRNCOD=4;             /* YES, SET RCDS OUT OF SEQNCE 0490
*                                      ERR CODE                      */
         LA    RETRNCOD,4                                          0490
*           GOTO AMDEXIT;           /* RETURN TO MAINLINE ROUTINE    */
         B     AMDEXIT                                             0491
*         END;                                                     0492
*                                                                  0492
*   /*****************************************************************/
*   /*                                                               */
*   /* TXT OBJECT RECORD HAS BEEN FOUND AND IS OK FOR PROCESSING     */
*   /*                                                               */
*   /*****************************************************************/
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF TXT RECORD CONTAINS START ADDRESS OF CSECT           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0493
*       IF CSECTORG>=TXTADDR THEN                                  0493
@RF00488 L     @10,CSECTORG                                        0493
         L     @08,TXTADDR-1(,RCDPTR)                              0493
         LA    @08,0(,@08)                                         0493
         CR    @10,@08                                             0493
         BL    @RF00493                                            0493
*         IF CSECTORG < (TXTADDR+TXTLNG) THEN                      0494
         LH    @00,TXTLNG(,RCDPTR)                                 0494
         AR    @00,@08                                             0494
         CR    @10,@00                                             0494
         BNL   @RF00494                                            0494
*           DO;                                                    0495
*                                                                  0495
*   /*****************************************************************/
*   /*                                                               */
*   /* IF TXT RECORD CONTAINS START ADDR OF CSECT SET THE OUTPUT     */
*   /* BUFFER INDEX TO THE FIRST BYTE OF THE BUFFER AND DETERMINE THE*/
*   /* OFFSET INTO THE TXT RECORD FOR THE FIRST BYTE OF DATA TO BE   */
*   /* MOVED FOR THE CSECT                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0496
*             LCASOC='1'B;          /* INDICATE START OF CSECT FND   */
         OI    LCASOC,B'10000000'                                  0496
*             OFFSET1 = (CSECTORG - TXTADDR) + 1;   /* SET INDX INTO
*                                      TEX T DATA                    */
         LA    @15,1                                               0497
         L     @14,TXTADDR-1(,RCDPTR)                              0497
         LA    @14,0(,@14)                                         0497
         SR    @10,@14                                             0497
         AR    @10,@15                                             0497
         LR    OFFSET1,@10                                         0497
*             BUFNDX1 = 1;          /* SET OUTPUT BUFFER INDEX       */
         LR    BUFNDX1,@15                                         0498
*             GOTO AMDENDCK;        /* GO CHECK FOR END OF CSECT IN
*                                      TXT RCD                       */
         B     AMDENDCK                                            0499
*           END;                                                   0500
*                                                                  0500
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ADDR OF START OF CSECT IS LESS THAN ADDR OF FIRST    */
*   /* BYTE OF DATA IN TXT RCD                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0501
*       IF CSECTORG < TXTADDR THEN                                 0501
@RF00494 DS    0H                                                  0501
@RF00493 L     @10,CSECTORG                                        0501
         MVC   @ZT00001+1(3),TXTADDR(RCDPTR)                       0501
         C     @10,@ZT00001                                        0501
         BNL   @RF00501                                            0501
*         DO;                                                      0502
*                                                                  0502
*   /*****************************************************************/
*   /*                                                               */
*   /* IF IF ADDRESS OF FIRST TXT BYTE IS GREATER THAN ADDRESS FO    */
*   /* START OF CSECT AND YET THE TEXT RCD CONTAINING THE START OF   */
*   /* CSECT HAS NOT BEEN FOUND THEN RECORDS MUST BE OUT OF SEQUENCE */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0503
*           IF LCASOC = '0'B THEN   /* HAS START OF CSECT BEEN FND?  */
         TM    LCASOC,B'10000000'                                  0503
         BNZ   @RF00503                                            0503
*             DO;                   /* NO, DO FOLLOWING              */
*               RETRNCOD=4;         /* SET RCDS OUT OF SEQNCE ERR  0505
*                                      CODE                          */
         LA    RETRNCOD,4                                          0505
*               GOTO AMDEXIT;       /* RETURN TO MAINLINE ROUTINE    */
         B     AMDEXIT                                             0506
*             END;                                                 0507
*                                                                  0507
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDR OF FIRST TXT BYTE IS GREATER THAN START OF CSECT.        */
*   /* DETERMINE RELATIVE OFFSET OF TXT DATA FROM START OF CSECT AND */
*   /* ADD ONE. USE THIS VALUE AS INDEX INTO OUTPUT BUFFER FOR MOVING*/
*   /* DATA. SET TXT DATA INDEX TO FIRST BYTE OF TEXT                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0508
*           OFFSET1 = 1;            /* SET TXT DATA INDEX TO 1ST BYTE*/
@RF00503 LA    @10,1                                               0508
         LR    OFFSET1,@10                                         0508
*           BUFNDX1 = (TXTADDR - CSECTORG) + 1;   /* SET BUF INDX    */
         L     BUFNDX1,TXTADDR-1(,RCDPTR)                          0509
         LA    BUFNDX1,0(,BUFNDX1)                                 0509
         S     BUFNDX1,CSECTORG                                    0509
         AR    BUFNDX1,@10                                         0509
*           GOTO AMDENDCK;          /* GO CHECK FOR END OF CSECT IN
*                                      TEXT                          */
         B     AMDENDCK                                            0510
*         END;                                                     0511
*                                                                  0511
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDR OF START OF CSECT IS GREATER THAN THE HIGHEST TXT DATA   */
*   /* ADDR . CHECK IF START OF CSECT HAS BEEN FOUND PREVIOUSLY. IF  */
*   /* SO THE OBJ RECORDS MUST BE OUT OF SEQUENCE. IF NOT, THEN GO   */
*   /* GET NEXT TXT RECORD                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0512
*       IF LCASOC = '1'B THEN       /* START OF CSECT FND PREVIOUSLY?*/
@RF00501 TM    LCASOC,B'10000000'                                  0512
         BNO   @RF00512                                            0512
*         DO;                       /* YES DO FOLLOWING              */
*           RETRNCOD = 4;           /* SET RCDS OUT OF SEQNCE ERR  0514
*                                      CODE                          */
         LA    RETRNCOD,4                                          0514
*           GOTO AMDEXIT;           /* RETURN TO MAINLINE ROUTINE    */
         B     AMDEXIT                                             0515
*         END;                                                     0516
*       ELSE                                                       0517
*         GOTO AMDTXT;              /* NO, GO GET NEXT TXT RCD       */
*                                                                  0517
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF END OF CSECT IS CONTAINED WITHIN THE TXT RECORD DATA */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0518
*                                                                  0518
*AMDENDCK:                                                         0518
*       IF CSECTEND>TXTADDR THEN                                   0518
AMDENDCK L     @10,CSECTEND                                        0518
         L     @06,TXTADDR-1(,RCDPTR)                              0518
         LA    @06,0(,@06)                                         0518
         CR    @10,@06                                             0518
         BNH   @RF00518                                            0518
*         IF CSECTEND <= (TXTADDR+TXTLNG) THEN                     0519
*                                                                  0519
         LH    @00,TXTLNG(,RCDPTR)                                 0519
         AR    @00,@06                                             0519
         CR    @10,@00                                             0519
         BH    @RF00519                                            0519
*   /*****************************************************************/
*   /*                                                               */
*   /* TXT RECORD CONTAINS END OF CSECT. DETERMINE OFFSET INTO TXT   */
*   /* DATA OF LAST BYTE OF DATA TO BE MOVED.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0520
*           DO;                                                    0520
*             LCAEOC='1'B;          /* INDICATE END OF CSECT FND     */
         OI    LCAEOC,B'01000000'                                  0521
*             OFFSET2=CSECTEND-TXTADDR; /* SET OFFSET INTO TXT DAT OF
*                                      LA ST BYTE TO BE MOVED        */
         L     @15,TXTADDR-1(,RCDPTR)                              0522
         LA    @15,0(,@15)                                         0522
         LCR   @15,@15                                             0522
         AR    @15,@10                                             0522
         LR    OFFSET2,@15                                         0522
*             BUFNDX2=CSECTEND - CSECTORG; /* SET BUF INDEX OF WHERE
*                                      LAS T TXT BYTE WILL BE MOVED  */
         S     @10,CSECTORG                                        0523
         ST    @10,BUFNDX2                                         0523
*             GOTO AMDMOVE;         /* GO TO MOVE TXT DATA INTO    0524
*                                      BUFFER                        */
         B     AMDMOVE                                             0524
*           END;                                                   0525
*                                                                  0525
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF CSECT IS NOT CONTAINED IN THE TXT DATA. CHECK IF ADDR  */
*   /* OF END OF CSECT IS GREATER THAN ADDR OF LAST BYTE IN TXT DATA.*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0526
*       IF CSECTEND > (TXTADDR + TXTLNG) THEN                      0526
@RF00519 DS    0H                                                  0526
@RF00518 L     @10,TXTADDR-1(,RCDPTR)                              0526
         LA    @10,0(,@10)                                         0526
         AH    @10,TXTLNG(,RCDPTR)                                 0526
         C     @10,CSECTEND                                        0526
         BNL   @RF00526                                            0526
*         DO;                                                      0527
*                                                                  0527
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDR OF END OF CSECT IS GREATER THAN ADDR OF LAST BYTE IN TXT */
*   /* DATA. CHECK IF END OF CSECT HAS ALREADY BEEN ENCOUNTERED. IF  */
*   /* SO RECORDS ARE OUT OF SEQUENCE                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0528
*           IF LCAEOC='1'B THEN     /* END OF CSECT FND PREVIOUSLY?  */
         TM    LCAEOC,B'01000000'                                  0528
         BNO   @RF00528                                            0528
*             DO;                                                  0529
*               RETRNCOD=4;         /* YES, SET RCDS OUT OF SEQNCE 0530
*                                      ERR C ODE                     */
         LA    RETRNCOD,4                                          0530
*               GOTO AMDEXIT;       /* RETURN TO MAINLINE ROUTINE    */
         B     AMDEXIT                                             0531
*             END;                                                 0532
*                                                                  0532
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF CSECT NOT PREVIOUSLY FOUND. SET UP INDEXES FOR MOVING  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0533
*           OFFSET2=TXTLNG;         /* SET TXT DATA OFFSET TO LAST 0533
*                                      BYTE OF TXT                   */
@RF00528 LH    @10,TXTLNG(,RCDPTR)                                 0533
         LR    OFFSET2,@10                                         0533
*           BUFNDX2= (TXTADDR+TXTLNG) -CSECTORG; /* SET BUFFER INDX
*                                      TO W HERE LAST BYTE OF TEXT 0534
*                                      WILL BE MOVED                 */
         MVC   @ZT00001+1(3),TXTADDR(RCDPTR)                       0534
         A     @10,@ZT00001                                        0534
         S     @10,CSECTORG                                        0534
         ST    @10,BUFNDX2                                         0534
*           GOTO AMDMOVE;           /* GO TO MOVE THE TXT DATA       */
         B     AMDMOVE                                             0535
*         END;                                                     0536
*                                                                  0536
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDR OF END OF CSECT IS LESS THAN ADDRESS OF FIRST BYTE IN TXT*/
*   /* DATA.                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0537
*       LCAEOC='1'B;                /* INDICATE END OF CSECT ADDR HAS
*                                      BEEN PASSED                   */
@RF00526 OI    LCAEOC,B'01000000'                                  0537
*       GOTO AMDTXT;                /* GO GET NEXT TXT RECORD        */
         B     AMDTXT                                              0538
*     END;                                                         0539
*                                                                  0539
*   /*****************************************************************/
*   /*                                                               */
*   /* OBJECT RECORD WAS NOT AN END RECORD OR A TEXT RECORD. IGNORE  */
*   /* ALL OTHER RECORDS                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0540
*   GOTO AMDTXT;                    /* YES, IGNORE. GET NEXT OBJ RCD.*/
*                                                                  0540
         B     AMDTXT                                              0540
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE TEXT DATA INTO OUTPUT BUFFER                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0541
*                                                                  0541
*AMDMOVE:                                                          0541
*   OTPUTBUF(BUFNDX1:BUFNDX2) = TXTDATA(OFFSET1:OFFSET2);          0541
AMDMOVE  LR    @10,BUFPTR                                          0541
         ALR   @10,BUFNDX1                                         0541
         AL    @10,@CF00449                                        0541
         L     @15,BUFNDX2                                         0541
         SR    @15,BUFNDX1                                         0541
         LR    @14,RCDPTR                                          0541
         ALR   @14,OFFSET1                                         0541
         EX    @15,@SM00450                                        0541
*   GOTO AMDTXT;                    /* GO GET NEXT OBJECT RECORD     */
*                                                                  0542
         B     AMDTXT                                              0542
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDSATXT MODULE PROCESSING                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0543
*                                                                  0543
*AMDFIND:                                                          0543
*   BLDLNAME = LCAMODUL;            /* PUT NAME IN BLDL LIST   Y02006*/
AMDFIND  MVC   BLDLNAME(8),LCAMODUL                                0543
*   GENERATE;                       /* ISSUE BLDL              Y02006*/
*                                                                  0544
       BLDL  (DCBPTR),BLDLAREA
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF MODULE FOUND                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0545
*   RESPECIFY REG15 RESTRICTED;                                    0545
*   IF REG15 ^= 0 THEN              /* TEST FOR NONZERO RETURN CODE  */
         LTR   REG15,REG15                                         0546
         BZ    @RF00546                                            0546
*     DO;                           /* YES, WHAT CODE IS IT?         */
*       IF REG15=4 THEN             /* IS IT MODULE NOT FND?         */
         CH    REG15,@CH00062                                      0548
         BNE   @RF00548                                            0548
*         RETRNCOD=1;               /* YES, SET MOD NOT FND ERR CODE */
         LA    RETRNCOD,1                                          0549
*       ELSE                        /* NO, IT MUST BE BLDL I/O ERROR */
*         RETRNCOD=2;               /* SET BLDL I/O ERR CODE         */
         B     @RC00548                                            0550
@RF00548 LA    RETRNCOD,2                                          0550
*       GOTO AMDEXIT;               /* RETURN TO MAINLINE ROUTINE    */
         B     AMDEXIT                                             0551
*     END;                                                         0552
*   GENERATE;                       /* ISSUE FIND              Y02006*/
@RF00546 DS    0H                                                  0553
       FIND  (DCBPTR),BLDLTTRK,C
*   RESPECIFY REG15 UNRESTRICTED;                                  0554
*                                                                  0554
*   /*****************************************************************/
*   /*                                                               */
*   /* MODULE FOUND --- READ CESD RECORD                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0555
*                                                                  0555
*AMDCESD:                                                          0555
*   RCDPTR=LCAINPUT;                /* SET POINTER TO INPUT BUFFER   */
AMDCESD  L     RCDPTR,LCAINPUT                                     0555
*   INPUTBUF(1) = '00'X;            /* CLEAR FIRST BYTE OF BUFFER FOR
*                                      ID CHK                        */
         MVI   INPUTBUF(RCDPTR),X'00'                              0556
*   GENERATE FLOWS(AMDSYND3,AMDMDEOD); /* READ A RECORD              */
*                                                                  0557
          READ (DECBPTR),SF,(DCBPTR),(RCDPTR),'S',,,MF=E
          CHECK (DECBPTR)
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RECORD IS A CESD RECORD SEARCH CESD ENTRIES FOR MATCH ON   */
*   /* LCACSECT NAME                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0558
*   IF RCDID = '20'X THEN           /* IS RCD A CESD RCD?            */
         CLI   RCDID(RCDPTR),X'20'                                 0558
         BNE   @RF00558                                            0558
*     DO;                           /* YES SRCH CESD ENTRIES         */
*       RESPECIFY (ENTRYPTR) RESTRICTED;                           0560
*       ENTRYPTR = RCDPTR + 8;        /* POINT TO 1ST CESD ENTRY     */
         LA    ENTRYPTR,8                                          0561
         AR    ENTRYPTR,RCDPTR                                     0561
*       DO I=CESDCNT TO 0 BY -16;        /* BEGIN CESD SRCH          */
         LH    I,CESDCNT+6(,RCDPTR)                                0562
         B     @DE00562                                            0562
@DL00562 DS    0H                                                  0563
*         IF ESDTYPE='0000'B  ESDTYPE = '0011'B THEN/*            0563
*                                              IS THIS A SECTION OR
*                                      LABEL DEF. ENTRY? Y02006      */
         TM    ESDTYPE(ENTRYPTR),B'00001111'                       0563
         BZ    @RT00563                                            0563
         TM    ESDTYPE(ENTRYPTR),B'00000011'                       0563
         BNO   @RF00563                                            0563
         TM    ESDTYPE(ENTRYPTR),B'00001100'                       0563
         BNZ   @RF00563                                            0563
@RT00563 DS    0H                                                  0564
*           IF LCACSECT=ESDNAME THEN /* DOES ENTRY CONTAIN CSECT   0564
*                                      NAME?                         */
         CLC   LCACSECT(8),ESDNAME(ENTRYPTR)                       0564
         BE    @RT00564                                            0564
*             GOTO AMDNMFND;        /* YES, YES. THIS THE ENTRY GO 0565
*                                      SAVE CSEC T START ADDR        */
*         ENTRYPTR = ENTRYPTR + 16;      /* NOT THIS ENTRY. POINT TO
*                                      NEX T ENTRY                   */
@RF00563 AH    ENTRYPTR,@CH00280                                   0566
*       END;                                                       0567
         AH    I,@CH00358                                          0567
@DE00562 LTR   I,I                                                 0567
         BNM   @DL00562                                            0567
*       GOTO AMDCESD;               /* NO MORE ENTRIES IN THIS RCD.
*                                      GO GET ANOTHER CESD RCD       */
         B     AMDCESD                                             0568
*     END;                                                         0569
*                                                                  0569
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RECORD IS A SYM RCD IGNORE IT AND GO READ ANOTHER RECORD   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0570
*   IF RCDID = '40'X THEN           /* IS RCD A SYM RCD              */
@RF00558 CLI   RCDID(RCDPTR),X'40'                                 0570
         BE    @RT00570                                            0570
*     GOTO AMDCESD;                 /* YES-IGNORE IT GO READ NEXT RCD*/
*                                                                  0571
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CSECT NOT FOUND AND NO MORE CESD RECORDS TO BE PROCESSED   */
*   /* THEN SET ERROR CODE AND EXIT                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0572
*   ELSE                                                           0572
*     DO;                                                          0572
*       RETRNCOD=7;                 /* SET MOD CSECT NOT FND ERR CODE*/
         LA    RETRNCOD,7                                          0573
*       GOTO AMDEXIT;               /* RETURN TO MAINLINE ROUTINE    */
         B     AMDEXIT                                             0574
*     END;                                                         0575
*                                                                  0575
*   /*****************************************************************/
*   /*                                                               */
*   /* CESD ENTRY FOUND FOR CSECT -- SET UP TO READ CONTROL RECORDS  */
*   /* AND TEXT                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0576
*                                                                  0576
*AMDNMFND:                                                         0576
*   IF LCAPGECT = '1'B THEN         /* RETURN SWITCH ON Y02006       */
AMDNMFND TM    LCAPGECT,B'00010000'                                0576
         BNO   @RF00576                                            0576
*     DO;                           /* YES Y02006                    */
*       LCAPROLD = ESDADDR + OTBUFADD; /* ADDRESS OF LD ENTRY Y02006 */
         L     @10,ESDADDR-1(,ENTRYPTR)                            0578
         LA    @10,0(,@10)                                         0578
         A     @10,OTBUFADD                                        0578
         ST    @10,LCAPROLD                                        0578
*       GO TO AMDMDEOD;             /* MODULE END OF DATA Y02006     */
         B     AMDMDEOD                                            0579
*     END;                                                         0580
*   IF ESDADDR ^= 0 THEN            /* MODULE ORIGIN AT ZERO Y02006  */
@RF00576 L     @10,ESDADDR-1(,ENTRYPTR)                            0581
         LA    @10,0(,@10)                                         0581
         LTR   @10,@10                                             0581
         BZ    @RF00581                                            0581
*     DO;                           /* NO - ERROR Y02006             */
*       RETRNCOD = 10;              /* SET RETURN CODE FOR MESSAGE 0583
*                                      AMD044I Y02006                */
         LA    RETRNCOD,10                                         0583
*       GO TO AMDEXIT;              /* RETURN Y02006                 */
         B     AMDEXIT                                             0584
*     END;                                                         0585
*   LCANMFND='1'B;                  /* INDICATE CSECT NAME FOUND     */
@RF00581 OI    LCANMFND,B'00010000'                                0586
*   CSECTORG=ESDADDR;               /* SAVE START ADDR OF CSECT      */
         L     @10,ESDADDR-1(,ENTRYPTR)                            0587
         LA    @10,0(,@10)                                         0587
         ST    @10,CSECTORG                                        0587
*   CSECTEND=ESDADDR+BLDLMLEN;      /* CALCULATE AND SAVE MODULE END
*                                      ADDR                    Y02006*/
         MVC   @ZT00001+1(3),BLDLMLEN                              0588
         A     @10,@ZT00001                                        0588
         ST    @10,CSECTEND                                        0588
*   LCAOTEOR=LCAOTPUT;              /* SET END OF RECORD PTR TO BEGIN
*                                      OF BUF                        */
*                                                                  0589
         L     @10,LCAOTPUT                                        0589
         ST    @10,LCAOTEOR                                        0589
*   /*****************************************************************/
*   /*                                                               */
*   /* READ A CONTROL RECORD                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0590
*                                                                  0590
*AMDCNTRL:                                                         0590
*   RCDPTR=LCAINPUT;                /* SET PTR TO INPUT BUFFER       */
AMDCNTRL L     RCDPTR,LCAINPUT                                     0590
*   INPUTBUF(1) = '00'X;            /* CLEAR 1ST BYTE OF BUF FOR ID
*                                      CHECK                         */
         MVI   INPUTBUF(RCDPTR),X'00'                              0591
*   GENERATE FLOWS(AMDSYND3,AMDMDEOD); /* READ A RECORD              */
*                                                                  0592
          READ (DECBPTR),SF,(DCBPTR),(RCDPTR),'S',,,MF=E
          CHECK (DECBPTR)
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF RLD RCD                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0593
*   IF RCDID = '02'X THEN           /* IS THIS AN RLD RECORD   Y02006*/
         CLI   RCDID(RCDPTR),X'02'                                 0593
         BNE   @RF00593                                            0593
*     DO;                           /* YES                     Y02006*/
*       CALL AMDSARLD;              /* PROCESS RLD RECORD      Y02006*/
         BAL   @14,AMDSARLD                                        0595
*       RESPECIFY REG15 RESTRICTED;                                0596
*       RETRNCOD = REG15;           /* SAVE RETURN CODE Y02006       */
         LR    RETRNCOD,REG15                                      0597
*       IF REG15 ^= 0 THEN          /* ERROR DURING RLD PROCESSING 0598
*                                      Y02006                        */
         LTR   REG15,REG15                                         0598
         BNZ   @RT00598                                            0598
*         GO TO AMDEXIT;            /* YES - RETURN Y02006           */
*       GO TO AMDCNTRL;             /* GET NEXT RECORD Y02006        */
         B     AMDCNTRL                                            0600
*     END;                                                         0601
*   RESPECIFY REG15 UNRESTRICTED;                                  0602
@RF00593 DS    0H                                                  0603
*   IF RCDID='0E'X THEN             /* IS RCD AN RLD?                */
         CLI   RCDID(RCDPTR),X'0E'                                 0603
         BNE   @RF00603                                            0603
*     DO;                           /* YES, DO FOLLOWING             */
*       CALL AMDSARLD;              /* PROCESS RLD RECORD Y02006     */
         BAL   @14,AMDSARLD                                        0605
*       RESPECIFY REG15 RESTRICTED;                                0606
*       RETRNCOD = REG15;           /* SAVE RETURN CODE Y02006       */
         LR    RETRNCOD,REG15                                      0607
*       IF REG15 ^= 0 THEN          /* ERROR DURING RLD PROCESSING 0608
*                                      Y02006                        */
         LTR   REG15,REG15                                         0608
         BNZ   @RT00608                                            0608
*         GO TO AMDEXIT;            /* YES - RETURN Y02006           */
*       RESPECIFY REG15 UNRESTRICTED;                              0610
*       LCAENDSW='1'B;              /* SET END SWITCH                */
         OI    LCAENDSW,B'00100000'                                0611
*       GOTO AMDMDEOD;              /* GO TO MODULE END OF DATA      */
         B     AMDMDEOD                                            0612
*     END;                                                         0613
*                                                                  0613
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF CONTROL RCD-- IF NOT GO BACK AND GET ANOTHER RECORD  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0614
*   IF CTLIDBIT = '0'B THEN         /* IS THE CNTRL BIT OFF IN THE ID
*                                      BYTE?                         */
@RF00603 TM    CTLIDBIT(RCDPTR),B'00000001'                        0614
         BZ    @RT00614                                            0614
*     GOTO AMDCNTRL;                /* YES, GO READ NEXT RECORD      */
*                                                                  0615
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CONTROL/RLD RECORD Y02006                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0616
*   IF RCDID = '03'X THEN           /* CONTROL/RLD RECORD Y02006     */
         CLI   RCDID(RCDPTR),X'03'                                 0616
         BE    @RT00616                                            0616
*     GO TO AMDRLD1;                /* YES - PROCESS RLD RECORD    0617
*                                      Y02006                        */
*                                                                  0617
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CONTROL/RLD RECORD PRECEEDING LAST TEXT OF A SEGMENT*/
*   /* AND IF SO SET END SWITCH TO STOP PROCESSING AFTER THE TEXT    */
*   /* RCD.                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0618
*   IF RCDID ='0D'X THEN                                           0618
         CLI   RCDID(RCDPTR),X'0D'                                 0618
         BNE   @RF00618                                            0618
*     LCAENDSW='1'B;                                               0619
*                                                                  0619
         OI    LCAENDSW,B'00100000'                                0619
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CONTROL/RLD RECORD PRECEEDING LAST TEXT OF A MODULE */
*   /* AND IF SO SET END SWITCH TO STOP PROCESSING AFTER THE TEXT    */
*   /* RCD.                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0620
*   IF RCDID = '0F'X THEN                                          0620
@RF00618 CLI   RCDID(RCDPTR),X'0F'                                 0620
         BNE   @RF00620                                            0620
*     DO;                                                          0621
*       LCAENDSW= '1'B;                                            0622
*                                                                  0622
         OI    LCAENDSW,B'00100000'                                0622
*AMDRLD1:                                                          0623
*       LCARLD = '1'B;              /* SET RLD INDICATOR Y02006      */
AMDRLD1  OI    LCARLD,B'00001000'                                  0623
*       RLDBUF1 = RCDPTR;           /* SAVE ADDRESS OF RECORD Y02006 */
         LR    RLDBUF1,RCDPTR                                      0624
*       RLDBUF2 = INBUFAD2;         /* ADDRESS OF SECOND BUFFER    0625
*                                      Y02006                        */
         L     RLDBUF2,INBUFAD2                                    0625
*       OFFSET1 = DCBBLKSI;         /* GET DCB BLOCKSIZE Y02006      */
*                                                                  0626
         LH    OFFSET1,DCBBLKSI+62(,DCBPTR)                        0626
*AMDRLDMV:                                                         0627
*       IF OFFSET1 > 256 THEN       /* MORE THAN 1 MOVE REQUIRED   0627
*                                      Y02006                        */
AMDRLDMV LA    @10,256                                             0627
         CR    OFFSET1,@10                                         0627
         BNH   @RF00627                                            0627
*         DO;                       /* YES - MOVE 256 BYTES Y02006   */
*           RLDBUF2 -> INPUTBUF(1:256) = INPUTBUF(1:256); /* MOVE 256
*                                      BYTES Y02006                  */
         MVC   INPUTBUF(256,RLDBUF2),INPUTBUF(RCDPTR)              0629
*           RLDBUF2 = RLDBUF2 + 256; /* INCREMENT 2ND BUFFER PTR   0630
*                                      Y02006                        */
         AR    RLDBUF2,@10                                         0630
*           RCDPTR = RCDPTR + 256;  /* INCREMENT 1ST BUFFER PTR    0631
*                                      Y02006                        */
         AR    RCDPTR,@10                                          0631
*           OFFSET1 = OFFSET1 - 256; /* DECREMENT REMAINING LENGTH 0632
*                                      Y02006                        */
         SR    OFFSET1,@10                                         0632
*           GO TO AMDRLDMV;         /* CONTINUE MOVE Y02006          */
         B     AMDRLDMV                                            0633
*         END;                                                     0634
*       RLDBUF2 -> INPUTBUF(1:OFFSET1) = INPUTBUF(1:OFFSET1); /* MOVE
*                                      REMAINING BYTES Y02006        */
@RF00627 LR    @10,OFFSET1                                         0635
         BCTR  @10,0                                               0635
         EX    @10,@SM00453                                        0635
*       RCDPTR = RLDBUF1;           /* RESTORE BUFFER POINTER Y02006 */
         LR    RCDPTR,RLDBUF1                                      0636
*     END;                                                         0637
*   RESPECIFY (ENTRYPTR) UNRESTRICTED;                             0638
*                                                                  0638
@RF00620 DS    0H                                                  0639
*   /*****************************************************************/
*   /*                                                               */
*   /* READ TEXT RECORD                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0639
*                                                                  0639
*AMDMDTXT:                                                         0639
*   RCDPTR=LCAINPUT;                /* POINT TO INPUT BUFFER         */
AMDMDTXT L     RCDPTR,LCAINPUT                                     0639
*   GENERATE FLOWS(AMDSYND3,AMDMDEOD); /* READ RECORD                */
*                                                                  0640
          READ (DECBPTR),SF,(DCBPTR),(RCDPTR),'S',,,MF=E
          CHECK (DECBPTR)
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE TEXT DATA INTO OUTPUT BUFFER                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0641
*   LMRCDLNG = DCBBLKSI - IOBCSWCT; /* LENGTH OF TEXT RECORD   YM0651*/
         L     @10,DCBIOBA+68(,DCBPTR)                             0641
         LH    LMRCDLNG,DCBBLKSI+62(,DCBPTR)                       0641
         SH    LMRCDLNG,IOBCSWCT+22(,@10)                          0641
*   OFFSET2 = LMRCDLNG;             /* LENGTH OF TEXT RECORD   YM0651*/
         LR    OFFSET2,LMRCDLNG                                    0642
*   BUFPTR = LCAOTEOR;              /* POSITION BUF PTR TO END OF  0643
*                                      LAST TXT IN OUT BUF           */
         L     BUFPTR,LCAOTEOR                                     0643
*   LCAOTEOR = BUFPTR + OFFSET2;    /* POINT TO END OF TXT IN OUTBUF */
*                                                                  0644
         LR    @10,BUFPTR                                          0644
         AR    @10,OFFSET2                                         0644
         ST    @10,LCAOTEOR                                        0644
*   /*****************************************************************/
*   /*                                                               */
*   /*  IF THE LENGTH OF TEXT TO BE MOVED IS GREATER THAN 256 BYTES  */
*   /*  THE TEXT MUST BE MOVED IN 256 BYTE SEGMENTS UNTIL THERE ARE  */
*   /*  ONLY 256 BYTES OR LESS REMAINING TO BE MOVED.                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0645
*                                                                  0645
*AMDTXTMV:                                                         0645
*   IF OFFSET2 > 256 THEN           /* CHK IF MORE THAN 256          */
AMDTXTMV LA    @10,256                                             0645
         CR    OFFSET2,@10                                         0645
         BNH   @RF00645                                            0645
*     DO;                           /* YES, MOVE 256 BYTES AT A TIME */
*       OTPUTBUF(1:256) = INPUTBUF(1:256);     /* MOVE THE TEXT      */
         MVC   OTPUTBUF(256,BUFPTR),INPUTBUF(RCDPTR)               0647
*       BUFPTR = BUFPTR + 256;      /* POINT TO END OF TXT IN OUTBUF */
         AR    BUFPTR,@10                                          0648
*       RCDPTR = RCDPTR + 256;      /* POINT TO NEXT TXT TO BE MOVED */
         AR    RCDPTR,@10                                          0649
*       OFFSET2 = OFFSET2 - 256;    /* DECREMENT THE OFFSET          */
         SR    OFFSET2,@10                                         0650
*       GO TO AMDTXTMV;             /* GO CHECK IF 256 BYTES TO MOVE */
         B     AMDTXTMV                                            0651
*     END;                                                         0652
*                                                                  0652
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE THE LAST SEGMENT OF TEXT (LNGH<=256) INTO OUTPUT BUFFER. */
*   /* PROCESS RLD RECORD IN SECOND BUFFER, IF ONE EXISTS.           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0653
*   OTPUTBUF(1:OFFSET2) = INPUTBUF(1:OFFSET2);     /* MOVE THE TEXT  */
@RF00645 LR    @10,OFFSET2                                         0653
         BCTR  @10,0                                               0653
         EX    @10,@SM00455                                        0653
*   IF LCARLD = '1'B THEN           /* RLD RECORD TO BE PROCESSED  0654
*                                      Y02006                        */
         TM    LCARLD,B'00001000'                                  0654
         BNO   @RF00654                                            0654
*     DO;                           /* YES Y02006                    */
*       CALL AMDSARLD;              /* PROCESS RLD RECORD Y02006     */
         BAL   @14,AMDSARLD                                        0656
*       RESPECIFY REG15 RESTRICTED;                                0657
*       RETRNCOD = REG15;           /* SAVE RETURN CODE Y02006       */
         LR    RETRNCOD,REG15                                      0658
*       IF REG15 ^= 0 THEN          /* ERROR DURING RLD PROCESSING 0659
*                                      Y02006                        */
         LTR   REG15,REG15                                         0659
         BNZ   @RT00659                                            0659
*         GO TO AMDEXIT;            /* YES - RETURN Y02006           */
*       RESPECIFY REG15 UNRESTRICTED;                              0661
*     END;                                                         0662
*   LCASOC = '1'B;                  /* INDICATE TXT WAS MOVED INTO 0663
*                                      OUT BUF                       */
@RF00654 DS    0H                                                  0664
*   LCARLD = '0'B;                  /* RESET RLD SWITCH        Y02006*/
         OI    LCASOC,B'10000000'                                  0664
         NI    LCARLD,B'11110111'                                  0664
*   IF LCAENDSW = '1'B THEN         /* CHK IF THIS WAS LAST RCD      */
         TM    LCAENDSW,B'00100000'                                0665
         BO    @RT00665                                            0665
*     GOTO AMDMDEOD;                /* YES, GO TO MOD END PROCESSING */
*   ELSE                                                           0667
*     GOTO AMDCNTRL;                /* NO, GO READ A CONTROL RCD     */
*                                                                  0667
         B     AMDCNTRL                                            0667
*   /*****************************************************************/
*   /*                                                               */
*   /* SYNAD ROUTINE FOR SYSUT1 AND SYSUT2 DATA SETS                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0668
*                                                                  0668
*AMDSYND3:                                                         0668
*   GENERATE;                       /* ANALYZE THE I/O ERROR         */
AMDSYND3 DS    0H                                                  0668
          SYNADAF ACSMETH=BSAM
*   RESPECIFY PARMGR1 RESTRICTED;                                  0669
*   MSGBUF1(1:102)=SYNADMSG(5:106); /* MOVE ERR DESCRP TO BUF        */
         MVC   MSGBUF1(102),SYNADMSG+4(PARMGR1)                    0670
*   GENERATE;                       /* RELEASE SYNADAF WORKAREA      */
          SYNADRLS
*   RESPECIFY PARMGR1 UNRESTRICTED;                                0672
*   MSGBUF1(1:2) = '0066'X;         /* SET LNG OF ERR MSG            */
         MVC   MSGBUF1(2),@CB00221                                 0673
*   RETRNCOD=8;                     /* SET I/O ERR RETURN CODE       */
         LA    RETRNCOD,8                                          0674
*   GOTO AMDEXIT;                   /* RETURN TO MAINLINE ROUTINE    */
*                                                                  0675
         B     AMDEXIT                                             0675
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF DATA PROCESSING FOR SYSUT1 --- OBJECT DECK INPUT       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0676
*                                                                  0676
*AMDOBEOD:                                                         0676
*   RETRNCOD=3;                     /* SET CSECT NOT FND ERR RETRN 0676
*                                      CODE                          */
AMDOBEOD LA    RETRNCOD,3                                          0676
*   IF LCANMFND='0'B THEN           /* WAS CSECT FOUND?              */
         TM    LCANMFND,B'00010000'                                0677
         BZ    @RT00677                                            0677
*     GOTO AMDEXIT;                 /* NO, GOTO EXIT                 */
*   RETRNCOD=4;                     /* SET SEQNCE ERR RETRN CODE     */
         LA    RETRNCOD,4                                          0679
*   IF LCASOC = '0'B THEN           /* WAS START OF CSECT FOUND?     */
         TM    LCASOC,B'10000000'                                  0680
         BZ    @RT00680                                            0680
*     GOTO AMDEXIT;                 /* NO, GOTO EXIT                 */
*   RETRNCOD=5;                     /* SET END CARD NOT FND ERR RETRN
*                                      CODE                          */
         LA    RETRNCOD,5                                          0682
*   IF LCAENDSW='0'B THEN           /* WAS END STATEMENT FND?        */
         TM    LCAENDSW,B'00100000'                                0683
         BZ    @RT00683                                            0683
*     GOTO AMDEXIT;                 /* NO, GOTO EXIT                 */
*                                                                  0684
*   /*****************************************************************/
*   /*                                                               */
*   /* OBJECT TEXT PROCESSED SUCCESSFULLY                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0685
*   LCAOTEOR= LCAOTPUT + (CSECTEND-CSECTORG); /* RETURN POINTER TO 0685
*                                      END OF TXT IN BUF             */
*                                                                  0685
         L     @10,CSECTEND                                        0685
         S     @10,CSECTORG                                        0685
         A     @10,LCAOTPUT                                        0685
         ST    @10,LCAOTEOR                                        0685
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEANUP FOR SUCCESSFUL TEXT PROCESSING                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0686
*                                                                  0686
*AMDMDEOD:                                                         0686
*   RETRNCOD = 0;                   /* INDICATE SUCCESSFUL COMPLETION*/
AMDMDEOD SLR   RETRNCOD,RETRNCOD                                   0686
*   GENERATE;                       /* CLOSE INPUT DATA SET (REREAD) */
*                                                                  0687
          CLOSE ((DCBPTR),REREAD),TYPE=T
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT FROM AMDSATXT BACK TO MAINLINE ROUTINE                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0688
*                                                                  0688
*AMDEXIT:                                                          0688
*   RETURN CODE(RETRNCOD);          /* RETURN TO AMDSALDR            */
AMDEXIT  LR    @15,RETRNCOD                                        0688
         L     @14,@SA00003                                        0688
         LM    @00,@12,@SA00003+8                                  0688
         BR    @14                                                 0688
*   END AMDSATXT;                                                  0689
*                                                                  0690
*   /*****************************************************************/
*   /*                                                               */
*   /* PERFORM RELOCATION OF LOAD MODULES USING RLD RECORDS          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0690
*AMDSARLD:                                                         0690
*   PROC OPTIONS(NOSAVEAREA);                                      0690
AMDSARLD STM   @14,@12,12(@13)                                     0690
*   DCL                                                            0691
*         RLDBUFAD PTR(31);         /* RLD BUFFER ADDRESS Y02006     */
*   DCL                                                            0692
*         RLDLENG FIXED(15);        /* LENGTH OF RLD DATA Y02006     */
*   DCL                                                            0693
*         RLDCONSZ FIXED(15);       /* SIZE OF RLD ENTRY TO BE     0693
*                                      UPDATED Y02006                */
*   DCL                                                            0694
*         RLDPTR PTR(31);           /* POINTER TO ADCON Y02006       */
*   DCL                                                            0695
*         RLDWORK FIXED(31) BASED(RLDPTR) BDY(HWORD); /* ADCON Y02006*/
*   DCL                                                            0696
*         LLMASK BIT(8) INIT('00001100'B); /* MASK TO ISOLATE 'LL' 0696
*                                      FIELD Y02006                  */
*   DCL                                                            0697
*         1 RLDFORM BASED(RLDBUFAD), /* FORMAT OF RLD RECORD Y02006  */
*             3 RLDIDEN PTR(8),     /* RLD IDENTIFIER Y02006         */
*             3 * CHAR(3),                                         0697
*             3 RLDCNT1 FIXED(15),  /* COUNT - UNUSED Y02006         */
*             3 RLDCNT2 FIXED(15),  /* LENGTH OF RLD DATA Y02006     */
*             3 * CHAR(12),                                        0697
*             3 RLDDATA1 CHAR(1);   /* BEGINNING OF USEFUL RLD DATA
*                                      Y02006                        */
*   DCL                                                            0698
*         1 RLDDATA BASED(RLDBUFAD), /* FORMAT OF RLD DATA Y02006    */
*             3 RLDF BIT(8),        /* 'F' FIELD Y02006              */
*                 5 RLDTYPE BIT(4), /* TYPE OF RLD ITEM Y02006       */
*                 5 RLDLL BIT(2),   /* LENGTH OF ADCON Y02006        */
*                 5 RLDS BIT(1),    /* DIRECTION OF RELOCATION Y02006*/
*                 5 RLDT BIT(1),    /* SKIP 'RP' FIELD Y02006        */
*             3 RLDA PTR(24);       /* OFFSET INTO MODULE Y02006     */
*   RLDBUFAD = LCAINPUT;            /* POINT TO FIRST BUFFER Y02006  */
         L     RLDBUFAD,LCAINPUT                                   0699
*   IF LCARLD = '1'B THEN           /* PROCESSING CONTROL/RLD RECORD
*                                      Y02006                        */
         TM    LCARLD,B'00001000'                                  0700
         BNO   @RF00700                                            0700
*     RLDBUFAD = INBUFAD2;          /* YES - RLD IN 2ND BUFFER Y02006*/
         L     RLDBUFAD,INBUFAD2                                   0701
*   RLDLENG = RLDCNT2;              /* LENGTH OF RLDDATA Y02006      */
@RF00700 LH    RLDLENG,RLDCNT2(,RLDBUFAD)                          0702
*   RLDBUFAD = ADDR(RLDDATA1);      /* POINT TO RLDDATA Y02006       */
         LA    @10,RLDDATA1(,RLDBUFAD)                             0703
         LR    RLDBUFAD,@10                                        0703
*   RLDLENG = RLDLENG - 4;          /* DECREMENT LENGTH PASSED 'RP'
*                                      Y02006                        */
         SH    RLDLENG,@CH00062                                    0704
*   DO RLDBUFAD = RLDBUFAD BY 4 WHILE (RLDLENG > 0);               0705
         B     @DE00705                                            0705
@DL00705 DS    0H                                                  0706
*     IF RLDTYPE ^= '0000'B & RLDTYPE ^= '0001'B THEN /* VALID RLD ITEM
*                                                              Y02006*/
         TM    RLDTYPE(RLDBUFAD),B'11110000'                       0706
         BZ    @RF00706                                            0706
         TM    RLDTYPE(RLDBUFAD),B'00010000'                       0706
         BNO   @RT00706                                            0706
         TM    RLDTYPE(RLDBUFAD),B'11100000'                       0706
         BZ    @RF00706                                            0706
@RT00706 DS    0H                                                  0707
*       RETURN CODE(9);             /* NO - SET RETURN CODE 9  Y02006*/
         LA    @15,9                                               0707
         L     @14,12(,@13)                                        0707
         LM    @00,@12,20(@13)                                     0707
         BR    @14                                                 0707
*     RLDCONSZ = (RLDF&LLMASK) / 4 + 1; /* GET SIZE OF ADCON   Y02006*/
@RF00706 SLR   @00,@00                                             0708
         IC    @00,RLDF(,RLDBUFAD)                                 0708
         MVC   @ZT00003+3(1),LLMASK                                0708
         N     @00,@ZT00003                                        0708
         SRL   @00,2                                               0708
         AH    @00,@CH00050                                        0708
         LR    RLDCONSZ,@00                                        0708
*     RESPECIFY WKREG RESTRICTED;                                  0709
*     WKREG = LCAOTPUT + RLDA;      /* ADDRESS OF ENTRY TO RELOCATED
*                                      Y02006                        */
         L     WKREG,RLDA-1(,RLDBUFAD)                             0710
         LA    WKREG,0(,WKREG)                                     0710
         A     WKREG,LCAOTPUT                                      0710
*     RESPECIFY OTPUTBUF BASED(WKREG);                             0711
*     RLDPTR = WKREG - 4 + RLDCONSZ; /* ADDRESS OF 4 BYTES, WITH   0712
*                                      ADCON RIGHT JUSTIFIED IN THE
*                                      WORK Y02006                   */
         LR    RLDPTR,WKREG                                        0712
         SH    RLDPTR,@CH00062                                     0712
         AR    RLDPTR,RLDCONSZ                                     0712
*     IF RLDS = '0'B THEN           /* POSITIVE RELOCATION Y02006    */
         TM    RLDS(RLDBUFAD),B'00000010'                          0713
         BNZ   @RF00713                                            0713
*       RLDWORK = RLDWORK + LCARELOC; /* YES Y02006                  */
         MVC   @TF00001(4),RLDWORK(RLDPTR)                         0714
         L     @10,@TF00001                                        0714
         A     @10,LCARELOC                                        0714
         ST    @10,@TF00001                                        0714
         MVC   RLDWORK(4,RLDPTR),@TF00001                          0714
*     ELSE                          /* NO Y02006                     */
*       RLDWORK = RLDWORK - LCARELOC;                              0715
         B     @RC00713                                            0715
@RF00713 MVC   @TF00001(4),RLDWORK(RLDPTR)                         0715
         L     @10,@TF00001                                        0715
         S     @10,LCARELOC                                        0715
         ST    @10,@TF00001                                        0715
         MVC   RLDWORK(4,RLDPTR),@TF00001                          0715
*     RESPECIFY WKREG UNRESTRICTED;                                0716
@RC00713 DS    0H                                                  0717
*     RLDLENG = RLDLENG - 4;        /* DECREMENT LENGTH PASSED 'FA'
*                                      Y02006                        */
         LA    @10,4                                               0717
         SR    RLDLENG,@10                                         0717
*     IF RLDT = '0'B THEN           /* SKIP 'RP' REQUIRED Y02006     */
         TM    RLDT(RLDBUFAD),B'00000001'                          0718
         BNZ   @RF00718                                            0718
*       DO;                         /* YES Y02006                    */
*         RLDBUFAD = RLDBUFAD + 4;  /* SKIP 'RP' Y02006              */
         AR    RLDBUFAD,@10                                        0720
*         RLDLENG = RLDLENG - 4;    /* DECREMENT LENGTH PASSED 'RP'
*                                      Y02006                        */
         SR    RLDLENG,@10                                         0721
*       END;                                                       0722
*   END;                                                           0723
@RF00718 AH    RLDBUFAD,@CH00062                                   0723
@DE00705 SLR   @10,@10                                             0723
         CR    RLDLENG,@10                                         0723
         BH    @DL00705                                            0723
*   RETURN CODE(0);                                                0724
         LR    @15,@10                                             0724
         L     @14,12(,@13)                                        0724
         LM    @00,@12,20(@13)                                     0724
         BR    @14                                                 0724
*   END AMDSARLD;                                                  0725
*   END AMDSALDR;                                                  0726
@EL00001 L     @13,4(,@13)                                         0726
@EF00001 DS    0H                                                  0726
@ER00001 LM    @14,@12,12(@13)                                     0726
         BR    @14                                                 0726
@DATA    DS    0H
@CH00358 DC    H'-16'
@CH00050 DC    H'1'
@CH00062 DC    H'4'
@CH00219 DC    H'5'
@CH00102 DC    H'6'
@CH00121 DC    H'15'
@CH00280 DC    H'16'
@CH00203 DC    H'32'
@CH00200 DC    H'144'
@CH00202 DC    H'4096'
@CH00204 DC    H'6144'
@CH00212 DC    XL2'7800'
@SM00438 MVC   MSGBUF1(0),MESSAGE(RCDPTR)
@SM00440 MVC   MSGBUF2(0),MESSAGE(RCDPTR)
@SM00442 MVC   MSGBUF1+44(0),MESSAGE+4(RCDPTR)
@SM00444 MVC   MSGBUF1+4(0),MESSAGE+4(RCDPTR)
@SM00446 MVC   MSGBUF1+4(0),@TS00001
@SM00450 MVC   OTPUTBUF(0,@10),TXTDATA-1(@14)
@SM00453 MVC   INPUTBUF(0,RLDBUF2),INPUTBUF(RCDPTR)
@SM00455 MVC   OTPUTBUF(0,BUFPTR),INPUTBUF(RCDPTR)
         DS    0F
@SA00001 DS    18F
@SA00003 DS    15F
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00001 DC    F'0'
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
         DS    0F
@CF00449 DC    F'-1'
@CF00185 DC    F'2'
@CF00206 DC    XL4'8000'
@CA00146 DC    A(AMDMSGTB)
         DS    0D
INBUFADD DS    A
INBUFAD2 DS    A
OTBUFADD DS    A
OTBUFSIZ DC    F'49152'
BUFNDX2  DS    F
CSECTORG DS    F
CSECTEND DS    F
CTLEND   DS    A
CTLSTART DS    A
INBUFSIZ DC    H'0'
@TS00001 DS    CL125
@CB00221 DC    X'0066'
         DS    CL3
LCA      DS    CL48
         ORG   LCA
LCAMODUL DS    CL8
LCACSECT DS    CL8
LCAFLAGS DS    CL1
         ORG   LCAFLAGS
LCAFUNC  DS    BL1
LCATYPE  EQU   LCAFLAGS+0
LCAIPL   EQU   LCAFLAGS+0
LCAPGECT EQU   LCAFLAGS+0
LCAUNUSD EQU   LCAFLAGS+0
         ORG   LCA+17
LCAWKFLG DS    CL1
         ORG   LCAWKFLG
LCASOC   DS    BL1
LCAEOC   EQU   LCAWKFLG+0
LCAENDSW EQU   LCAWKFLG+0
LCANMFND EQU   LCAWKFLG+0
LCARLD   EQU   LCAWKFLG+0
LCANULL  EQU   LCAWKFLG+0
         ORG   LCA+18
LCACOUNT DS    CL1
LCARSRVD DC    X'00'
LCAINDCB DS    FL4
LCAOTDCB DS    FL4
LCAINPUT DS    AL4
LCAOTPUT DS    AL4
LCAOTEOR DS    AL4
LCAPROLD DS    AL4
LCARELOC DC    F'0'
         ORG   LCA+48
CSECTS   DS    CL56
         ORG   CSECTS
AMDSAIP1 DC    CL8'AMDSAIP1'
AMDSAIP2 DC    CL8'AMDSAIP2'
AMDSAHSR DC    CL8'AMDSAHSR'
AMDSALSR DC    CL8'AMDSALSR'
AMDSAPGE DC    CL8'AMDSAPGE'
AMDSAPRO DC    CL8'AMDSAPRO'
AMDSAPR2 DC    CL8'PGERCDCT'
         ORG   CSECTS+56
LDRPARMS DS    CL28
         ORG   LDRPARMS
TYPE2HI  DC    CL8'TYPE2=HI'
TYPE2LO  DC    CL8'TYPE2=LO'
IPL2D    DC    CL6'IPL2=D'
IPL2T    DC    CL6'IPL2=T'
         ORG   LDRPARMS+28
BLANKS   DC    CL8' '
MSGBUF1  DC    CL125' '
         DS    CL3
MSGBUF2  DC    CL125' '
WTOCODES DC    X'02000020'
PATCH    DC    CL10'PATCH AREA'
LDRPATCH DC    X'00'
         DC    XL256'0'
         DC    XL243'0'
OBJID    DC    X'02'
BLDLAREA DS    CL36
         ORG   BLDLAREA
@NM00001 DC    H'1'
@NM00002 DC    H'32'
BLDLNAME DS    CL8
BLDLTTRK DS    CL4
@NM00003 DS    CL12
BLDLMLEN DS    CL3
BLDLTXT1 DS    CL2
@NM00004 DS    CL3
         ORG   BLDLAREA+36
OBJTYPS  DS    CL12
         ORG   OBJTYPS
ESD      DC    CL3'ESD'
TXT      DC    CL3'TXT'
ENDD     DC    CL3'END'
RLD      DC    CL3'RLD'
         ORG   OBJTYPS+12
LLMASK   DC    B'00001100'
         DS    CL3
AMDMSGX  DC    AL4(AMD037I)
         DC    AL4(AMD040I)
         DC    AL4(AMD036I1)
         DC    AL4(AMD036I2)
         DC    AL4(AMD036I3)
         DC    AL4(AMD036I4)
         DC    AL4(AMD039I)
         DC    AL4(AMD041I)
         DC    AL4(AMD044I1)
         DC    AL4(AMD044I2)
AMDSALDR CSECT
         READ SYSDECB,SF,,,,,,MF=L
SYS1DCB  DCB   MACRF=(RP),DDNAME=SYSUT1,DSORG=PS,RECFM=FB,             C
               SYNAD=AMDSYND3,EODAD=AMDOBEOD,LRECL=80
SYS2DCB  DCB   MACRF=(RP),DDNAME=SYSUT2,DSORG=PS,RECFM=U,              C
               SYNAD=AMDSYND3,EODAD=AMDMDEOD
SYS3DCB  DCB   MACRF=(W),DDNAME=SYSUT3,DSORG=PS,RECFM=U,               C
               SYNAD=AMDSYND1
SYS4DCB  DCB   MACRF=(W),DDNAME=SYSUT4,DSORG=PS,RECFM=U,               C
               SYNAD=AMDSYND1,BLKSIZE=6144                       Y02006
PRINTDCB DCB   MACRF=(PM),DDNAME=SYSPRINT,DSORG=PS,RECFM=VA,           C
               LRECL=125,BLKSIZE=129,SYNAD=AMDSYND2
AMDSALDR CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RLDPTR   EQU   @09
RLDCONSZ EQU   @10
RLDLENG  EQU   @07
RLDBUFAD EQU   @06
RLDBUF2  EQU   @08
RLDBUF1  EQU   @09
I        EQU   @07
LMRCDLNG EQU   @07
OFFSET2  EQU   @06
OFFSET1  EQU   @07
BUFNDX1  EQU   @08
BLKEND   EQU   @09
IOSAV14  EQU   @06
RETRNCOD EQU   @07
PLISTPTR EQU   @08
PARMGR1  EQU   @01
DCBPTR   EQU   @02
DECBPTR  EQU   @03
RCDPTR   EQU   @04
BUFPTR   EQU   @05
TYPE2PTR EQU   @06
IPL2PTR  EQU   @07
WKREG    EQU   @08
RETRNREG EQU   @14
REG15    EQU   @15
ENTRYPTR EQU   @06
         EXTRN AMDMSGTB
PGERCDCT EQU   0
TYPEPARM EQU   0
IPL2PARM EQU   0
DCBOFLGS EQU   0
DCBDDNAM EQU   0
DCBBLKSI EQU   0
DCBLRECL EQU   0
INPUTBUF EQU   0
OTPUTBUF EQU   0
PLIST    EQU   0
PLISTLNG EQU   PLIST
PARMS    EQU   PLIST+2
PLISTADR EQU   0
SYNADMSG EQU   0
MESSAGE  EQU   0
MSGLNG   EQU   0
IOBPTR   EQU   0
CSWRESID EQU   0
RCDID    EQU   0
RCDTYPE  EQU   0
ESDCNT   EQU   0
CESDCNT  EQU   0
IOBCSWCT EQU   0
DCBIOBA  EQU   0
CTLPREFX EQU   0
CTLID    EQU   CTLPREFX
CTLIDBIT EQU   CTLID
CTLENTRY EQU   0
TXTFMT   EQU   0
TXTADDR  EQU   TXTFMT+5
TXTLNG   EQU   TXTFMT+10
TXTDATA  EQU   TXTFMT+16
ESDENTRY EQU   0
ESDNAME  EQU   ESDENTRY
ESDTYPE  EQU   ESDENTRY+8
ESDADDR  EQU   ESDENTRY+9
ESDLNG   EQU   ESDENTRY+13
RLDWORK  EQU   0
RLDFORM  EQU   0
RLDCNT2  EQU   RLDFORM+6
RLDDATA1 EQU   RLDFORM+20
RLDDATA  EQU   0
RLDF     EQU   RLDDATA
RLDTYPE  EQU   RLDF
RLDS     EQU   RLDF
RLDT     EQU   RLDF
RLDA     EQU   RLDDATA+1
AD1      EQU   AMDMSGTB
AD2      EQU   AMDMSGTB+4
AD3      EQU   AMDMSGTB+8
AD4      EQU   AMDMSGTB+12
AD5      EQU   AMDMSGTB+16
AD6      EQU   AMDMSGTB+20
AD7      EQU   AMDMSGTB+24
AD8      EQU   AMDMSGTB+28
AD9      EQU   AMDMSGTB+32
AD10     EQU   AMDMSGTB+36
AD11     EQU   AMDMSGTB+40
AD12     EQU   AMDMSGTB+44
AD13     EQU   AMDMSGTB+48
AD14     EQU   AMDMSGTB+52
AD15     EQU   AMDMSGTB+56
*                                      START UNREFERENCED COMPONENTS
RLDLL    EQU   RLDF
@NM00007 EQU   RLDFORM+8
RLDCNT1  EQU   RLDFORM+4
@NM00006 EQU   RLDFORM+1
RLDIDEN  EQU   RLDFORM
ESDSEG   EQU   ESDENTRY+12
@NM00005 EQU   ESDENTRY+8
TXTSDID  EQU   TXTFMT+14
TXTBLNK3 EQU   TXTFMT+12
TXTBLNK2 EQU   TXTFMT+8
TXTBLNK1 EQU   TXTFMT+4
TXTTYPE  EQU   TXTFMT+1
TXTIDENT EQU   TXTFMT
TXTSIZE  EQU   CTLENTRY+2
ENTRYID  EQU   CTLENTRY
CTLCCW   EQU   CTLPREFX+8
CTLRLDCT EQU   CTLPREFX+6
CTLCNT   EQU   CTLPREFX+4
CTLRSRVD EQU   CTLPREFX+1
NOTCHKED EQU   CTLID
*                                      END UNREFERENCED COMPONENTS
@RT00059 EQU   AMD035I
@RT00062 EQU   AMD035I
@RT00065 EQU   AMD035I
@RT00067 EQU   AMD038I
@RF00088 EQU   AMD038I
@RT00093 EQU   AMD035I
@RT00097 EQU   AMD035I
@RT00101 EQU   AMD038I
@RF00104 EQU   AMD038I
@RT00116 EQU   AMD042I
@RT00127 EQU   AMD042I
@RT00182 EQU   AMDPROP
@RT00276 EQU   AMDSAWTO
@RT00340 EQU   AMDSAWTO
@RT00441 EQU   AMDFIND
@RT00453 EQU   AMDOBTXT
@RT00458 EQU   AMDOBJ
@RF00458 EQU   AMDESD
@RC00447 EQU   AMDEXIT
@RF00512 EQU   AMDTXT
@RF00486 EQU   AMDTXT
@RC00548 EQU   AMDEXIT
@RT00564 EQU   AMDNMFND
@RT00570 EQU   AMDCESD
@RT00598 EQU   AMDEXIT
@RT00608 EQU   AMDEXIT
@RT00614 EQU   AMDCNTRL
@RT00616 EQU   AMDRLD1
@RT00659 EQU   AMDEXIT
@RT00665 EQU   AMDMDEOD
@RF00665 EQU   AMDCNTRL
@RT00677 EQU   AMDEXIT
@RT00680 EQU   AMDEXIT
@RT00683 EQU   AMDEXIT
@PB00004 EQU   @EL00001
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   AMDSALDR

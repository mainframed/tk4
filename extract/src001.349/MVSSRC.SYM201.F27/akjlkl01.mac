         TITLE 'AKJLKL01 - LINK/LOADGO PROMPTER'
         LCLA  &T,&SPN                                            0001
.@001    ANOP                                                     0001
AKJLKL01 CSECT ,                                                  0001
         STM   @E,@C,12(@D)                                       0001
         BALR  @8,0                                               0001
@PSTART  DS    0H                                                 0001
         USING @PSTART+00000,@8                                   0001
         LA    @9,4095(0,@8)                                      0001
         USING @PSTART+04095,@9                                   0001
         LA    @B,4095(0,@9)                                      0001
         USING @PSTART+08190,@B                                   0001
         L     @0,@SIZ001                                         0001
         GETMAIN  R,LV=(0)                                        0001
         LR    @C,@1                                              0001
         USING @DATD+00000,@C                                     0001
         LM    @0,@1,20(@D)                                       0001
         XC    @TEMPS(@L),@TEMPS                                  0001
         ST    @D,@SAV001+4                                       0001
         LA    @F,@SAV001                                         0001
         ST    @F,8(0,@D)                                         0001
         LR    @D,@F                                              0001
         L     @1,4(@D)
         L     @1,24(@1)
         DS    0H
*         CPPLPTR = R1;
         ST    @1,MSGPARM+104                                     0067
*         GENERATE;
         GETMAIN R,LV=296,SP=0         STORAGE FOR PASSED PARMS Y01018
         DS    0H
*         BASE=R1;
         ST    @1,BASE                                            0069
*         PTR1=ADDR(VALREG);
         LA    @F,VALREG                                          0070
         ST    @F,MSGPARM+96                                      0070
*         PTR1->BASEREG(1)=R8;          /* SAVE 1ST BASE REG.  ZA02180*
         LR    @1,@F               MSGPARM                        0071
         ST    @8,0(0,@1)                                         0071
*         PTR1->BASEREG(2)=R9;          /* SAVE 2ND BASE REG.  ZA02180*
         ST    @9,4(0,@1)                                         0072
*         PTR1->BASEREG(3)=R11;         /* SAVE 3RD BASE REG.  ZA02180*
         ST    @B,8(0,@1)                                         0073
*         PTR1->DATAREG=R12;            /* SAVE DATA BASE REGISTER.   *
         ST    @C,12(0,@1)                                        0074
*         DDNMS(1)='00'X;               /* ZERO DDNAMES               *
         L     @3,BASE                                            0075
         MVI   18(@3),X'00'                                       0075
*         DDNMS(2:96)=DDNMS(1:95);      /* ZERO DDNAMES               *
         MVC   19(95,@3),18(@3)                                   0076
*         DDPTR=ADDR(DDLEN);            /* SET POINTER TO DDNAMELIST  *
         LA    @F,16(0,@3)                                        0077
         ST    @F,292(0,@3)                                       0077
*         DDLEN=96;                     /* SET LENGTH OF DDNAMELIST   *
         LA    @F,96                                              0078
         STH   @F,16(0,@3)                                        0078
*         ENDBIT='1'B;                  /* SET END INDICATOR          *
         OI    292(@3),B'10000000'                                0079
*         OPTPTR=ADDR(OPLEN);           /* SET POINTER TO OPTIONLIST  *
         LA    @F,114(0,@3)                                       0080
         ST    @F,288(0,@3)                                       0080
*         OPLIST=' ';                   /* INIT. OPTION LIST          *
         MVI   116(@3),C' '                                       0081
         MVC   117(159,@3),116(@3)                                0081
*         CONCAT=ADDR(DSCONC);          /* SET POINTER TO CONCAT.LIST *
         ST    @3,284(0,@3)                                       0082
*         INPT=BLANKS;                  /* INIT.INPUT DDNAME TO BLANK *
         MVC   0(8,@3),BLANKS                                     0083
*         LIBY=BLANKS;                  /* INIT. LIB DDNAME TO BLANK  *
         MVC   8(8,@3),BLANKS                                     0084
*         LKLD='LINK';                  /* SET CODE FOR LINK. EDITOR  *
         MVC   276(4,@3),@C4                                      0085
*         IF CODEBYT='FF'X              /* WAS LOADGO ENTERED?        *
*            THEN DO;                   /* YES - RESET CODE           *
         CLI   MSGPARM+104,X'FF'                                  0086
         BC    07,@9FF                                            0086
*                 LKLD='LOAD';          /* SET CODE FOR LOADER        *
         MVC   276(4,@3),@C6                                      0088
*                 CODEBYT='00'X;        /* ZERO OUT HIGH BYTE         *
         MVI   MSGPARM+104,X'00'                                  0089
*                 END;
*         CPECB=0;
@9FF     SR    @F,@F                                              0091
         ST    @F,MSGPARM+100                                     0091
*         DOT='.';                      /* SET PERIOD IN QUALIFIER    *
         MVI   A00001,C'.'                                        0092
*         TMPPTR=CPPLPTR;               /* SET POINTER FROM TMP       *
         L     @1,BASE                                            0093
         MVC   280(4,@1),MSGPARM+104                              0093
*         DEFNME=' ';                   /* INIT. DEFAULT DSNAME       *
         MVI   DEFAULT+2,C' '                                     0094
         MVC   DEFAULT+3(43),DEFAULT+2                            0094
*         DEFLEN=0;                     /* INIT. DEFAULT      A43146
*                                          DSNAME LENGTH              *
         SR    @F,@F                                              0095
         STH   @F,DEFAULT                                         0095
*         DEFMEM=' ';                   /* INIT. DEFAULT      A43146
*                                          MEMBER NAME                *
         MVI   DEFAULT+46,C' '                                    0096
         MVC   DEFAULT+47(7),DEFAULT+46                           0096
*         LSTPTR=ADDR(MSGPARM);         /* SET PARM. LIST POINTER     *
         LA    @F,MSGPARM                                         0097
         ST    @F,LSTPTR                                          0097
*         CSNAME='&CS0';                /* SET L.E. CON. NAME         *
         MVC   CSNAME(4),@C8                                      0098
*         EXADD=ADDR(ABEX);             /* SET ADDRESS OF EXIT        *
         LA    @F,ABEX                                            0099
         ST    @F,STAEL                                           0099
*         PRMADD=ADDR(VALREG);          /* SET PTR. TO SAVE PARMS     *
         LA    @F,VALREG                                          0100
         ST    @F,STAEL+4                                         0100
*         GEN(ESTAE MF=(E,STAEL));      /* CREATE STAE BLOCK  ZM02759 *
         ESTAE MF=(E,STAEL)
         DS    0H
*         /* ******************************************************** *
*         /* SET UP STANDARD DAIR PARAMETERS                          *
*         /* ******************************************************** *
*         DAPLPTR=ADDR(DAIRL);          /* SET LIST POINTER           *
         LA    @F,DAIRL                                           0102
         ST    @F,DAPLPTR                                         0102
*         DAPLUPT=CPPLUPT;              /* SET UPT POINTER IN LIST    *
         L     @1,MSGPARM+104      MSGPARM                        0103
         LR    @3,@F                                              0103
         MVC   0(4,@3),4(@1)                                      0103
*         DAPLECT=CPPLECT;              /* SET ECT POINTER IN LIST    *
         MVC   4(4,@3),12(@1)                                     0104
*         DAPLECB=ADDR(CPECB);          /* SET ECB POINTER IN LIST    *
         LA    @F,MSGPARM+100                                     0105
         ST    @F,8(0,@3)                                         0105
*         DAPLPSCB=CPPLPSCB;            /* SET POINTER TO PSCB        *
         MVC   12(4,@3),8(@1)                                     0106
*         DAPB0PTR=ADDR(DAIR08);        /* SET POINTER TO X'08' BLOCK *
         LA    @F,DAIR08                                          0107
         ST    @F,MSGPARM                                         0107
*         DA08CD='0008'X;               /* SET X'08' CODE - ALLOCATION*
         LR    @6,@F                                              0108
         MVC   0(2,@6),@X9                                        0108
*         DAPB0PTR=ADDR(DAIR0C);        /* SET POINTER TO X'0C' BLOCK *
         LA    @F,DAIR0C                                          0109
         ST    @F,MSGPARM                                         0109
*         GEN(XC  DAIR0C(212),DAIR0C);  /* ZERO OUT BLOCK             *
         XC  DAIR0C(212),DAIR0C
         DS    0H
*         DA0CCD='000C'X;               /* SET X'0C' CODE - CONCAT.   *
         L     @1,MSGPARM                                         0111
         MVC   0(2,@1),@X10                                       0111
*         DAPB1PTR=ADDR(DAIR1C);        /* SET POINTER TO X'1C' BLOCK *
         LA    @F,DAIR1C                                          0112
         ST    @F,DAPB1PTR                                        0112
*         GEN(XC DAIR1C(24),DAIR1C);    /* ZERO OUT BLOCK     OY00691 *
         XC DAIR1C(24),DAIR1C
         DS    0H
*         DA1CCD='001C'X;               /* SET X'1C' CODE - TERM. ALL.*
         L     @1,DAPB1PTR                                        0114
         MVC   0(2,@1),@X11                                       0114
*         DA1CDDN=BLANKS;               /* BLANK OUT DDNAME           *
         MVC   8(8,@1),BLANKS                                     0115
*         DA1CALN=BLANKS;                /*BLNK OUT ATTR NAME OY00691 *
         MVC   16(8,@1),BLANKS                                    0116
*         DAPB0PTR=ADDR(DAIR04);        /* SET POINTER TO X'04' BLOCK *
         LA    @F,DAIR04                                          0117
         ST    @F,MSGPARM                                         0117
*         DA04CD='0004'X;               /* SET X'04' CODE - SEARCH DSE*
         LR    @6,@F                                              0118
         MVC   0(2,@6),@X12                                       0118
*         DAPB1PTR=ADDR(DAIR18);        /* SET POINTER TO X'18' BLOCK *
         LA    @F,DAIR18                                          0119
         ST    @F,DAPB1PTR                                        0119
*         DA18CD='0018'X;               /* SET X'18' CODE - UNALLOC.  *
         LR    @1,@F                                              0120
         MVC   0(2,@1),@X13                                       0120
*         DAPB2PTR=ADDR(DAIR28);        /* PTR TO X'28' BLK   OY00691 *
         LA    @F,DAIR28                                          0121
         ST    @F,DAPB2PTR                                        0121
*         GEN(XC DAIR28(16),DAIR28);    /* CLEAR BLOCK        OY00691 *
         XC DAIR28(16),DAIR28
         DS    0H
*         DA28CD='0028'X;               /* SET X'28' CODE     OY00691 *
         L     @1,DAPB2PTR                                        0123
         MVC   0(2,@1),@X14                                       0123
*                                       /*  - MULTIPLE OPS    OY00691 *
*         DA28NOP='0002'X;              /* SET 2 OPS          OY00691 *
         MVC   2(2,@1),@X15+2                                     0124
*         DA28OPTR(1)=ADDR(DAIR34);     /* PT TO X'34' BLOCK  OY00691 *
         LA    @F,DAIR34                                          0125
         ST    @F,8(0,@1)                                         0125
*         DA28OPTR(2)=ADDR(DAIR1C);     /* PT TO X'1C' BLOCK  OY00691 *
         LA    @F,DAIR1C                                          0126
         ST    @F,12(0,@1)                                        0126
*         DAPB3PTR=ADDR(DAIR34);        /* PTR TO X'34' BLK   OY00691 *
         LA    @F,DAIR34                                          0127
         ST    @F,DAPB3PTR                                        0127
*         GEN(XC DAIR34(20),DAIR34);    /* CLEAR BLOCK        OY00691 *
         XC DAIR34(20),DAIR34
         DS    0H
*         DA34CD='0034'X;               /* SET X'34' CODE     OY00691 *
         L     @1,DAPB3PTR                                        0129
         MVC   0(2,@1),@X16                                       0129
*                                       /*  - ASSIGN ATTRS    OY00691 *
*         DA34CHN='1'B;                 /* INDICATE ASSIGN    OY00691 *
         OI    6(@1),B'01000000'                                  0130
*         DA34NAME='LKLDATTR';          /* SET ATTR NAME      OY00691 *
         MVC   8(8,@1),@C17                                       0131
*         DA34ADDR=ADDR(DAIRATCB);      /* PT TO ATTR BLK     OY00691 *
         LA    @F,DAIRATCB                                        0132
         ST    @F,16(0,@1)                                        0132
*         DACBPTR=ADDR(DAIRATCB);       /* PTR TO ATTR BLK    OY00691 *
         LA    @F,DAIRATCB                                        0133
         ST    @F,DACBPTR                                         0133
*         GEN(XC DAIRATCB(47),DAIRATCB);  /* CLEAR BLOCK      OY00691 *
         XC DAIRATCB(47),DAIRATCB
         DS    0H
*         DAIBUFNO='02'X;               /* 2 BUFFERS          OY00691 *
         L     @1,DACBPTR                                         0135
         MVI   24(@1),X'02'                                       0135
*         DAIBUFL=81;                   /* 81 BYTE BUFFERS    OY00691 *
         LA    @F,81                                              0136
         STH   @F,26(0,@1)                                        0136
*         DAIRECFM='9C'X;               /* REC FORMAT FBSA    OY00691 *
         MVI   36(@1),X'9C'                                       0137
*         DAIBLKSI=81;                  /* 81 BYTE BLOCKS     OY00691 *
         LA    @F,81                                              0138
         STH   @F,38(0,@1)                                        0138
*         DAILRECL=81;                  /* 81 BYTE RECORDS    OY00691 *
         STH   @F,40(0,@1)                                        0139
*         DAINCP='02'X;                 /* 2 CHAN PGMS        OY00691 *
         MVI   42(@1),X'02'                                       0140
*         /* ******************************************************** *
*         /*  SET UP PARSE PARAMETERS AND GO TO PARSE.                *
*         /* ******************************************************** *
*         PPLPTR = ADDR(PARSEL);
         LA    @F,PARSEL                                          0141
         ST    @F,PPLPTR                                          0141
*         PPLUPT = CPPLUPT;
         L     @7,MSGPARM+104      MSGPARM                        0142
         LR    @4,@F                                              0142
         MVC   0(4,@4),4(@7)                                      0142
*         PPLECT= CPPLECT;
         MVC   4(4,@4),12(@7)                                     0143
*         PPLCBUF = CPPLCBUF;
         MVC   20(4,@4),0(@7)                                     0144
*         PPLECB = ADDR(CPECB);
         LA    @F,MSGPARM+100                                     0145
         ST    @F,8(0,@4)                                         0145
*         PPLUWA = ADDR(VALREG);
         LA    @F,VALREG                                          0146
         ST    @F,24(0,@4)                                        0146
*         IF LKLD='LINK'                /* LINK INVOKED       OY00686 *
*            THEN PPLPCL=LKADCON;       /* SET UP FOR LINK    OY00686 *
         L     @5,BASE                                            0147
         CLC   276(4,@5),@C4                                      0147
         BC    07,@9FE                                            0147
         MVC   12(4,@4),LKADCON                                   0148
         BC    15,@9FD                                            0149
*            ELSE PPLPCL=LDADCON;       /* SET UP FOR LOAD    OY00686 *
@9FE     MVC   12(4,@4),LDADCON                                   0149
*         PPLANS=ADDR(PDLPTR);
@9FD     LA    @F,PDLPTR                                          0150
         ST    @F,16(0,@4)                                        0150
*         GEN(LOAD EP=IKJDAIR);         /* LOAD THE DAIR ALLOCATION   *
         LOAD EP=IKJDAIR
         DS    0H
*                                       /* ROUTINE                    *
*         R1 = PPLPTR;
         L     @1,PPLPTR                                          0152
*         PROMPTM=1;                    /* SET INDICATOR TO PROMPT    *
         LA    @F,1                                               0153
         STH   @F,MSGPARM+4                                       0153
*                                       /* MODE                       *
*         GEN(LINK  EP=IKJPARS);        /* GO TO PARSE                *
         LINK  EP=IKJPARS
         DS    0H
*         RCODE=R15;                    /* SET RETURN CODE            *
         STH   @F,MSGPARM+6                                       0155
*         IF RCODE ^= 0                 /* RETURN CODE =0 ?           *
*            THEN DO;
         SR    @F,@F                                              0156
         CH    @F,MSGPARM+6                                       0156
         BC    08,@9FC                                            0156
*                 ERRCODE=2;            /* SET TERMINAL ERROR CODE    *
         LA    @F,2                                               0158
         STH   @F,MSGPARM+8                                       0158
*                 GO TO FINIS;          /* TERMINATE                  *
         BC    15,FINIS                                           0159
*                 END;
*         PROMPTM=0;                    /* SET PRMPT MODE EQUAL TO NO *
@9FC     SR    @F,@F                                              0161
         STH   @F,MSGPARM+4                                       0161
*         R2=PDLPTR;
         L     @2,PDLPTR                                          0162
*         /*   PROCESS LOADGO PDL                                     *
*         IF LKLD='LOAD' THEN DO;       /* LOADGO INVOKED             *
         L     @1,BASE                                            0163
         CLC   276(4,@1),@C6                                      0163
         BC    07,@9FB                                            0163
*               /* PROCESS LOADGO PRINT OPTION/DATA SET       OY00686 *
*                             IF LDPRINT=2 /* IF NOPRINT      OY00686 *
*                                THEN LDMAP=0; /* NOMAP ALSO  OY00686 *
         L     @3,PDLPTR                                          0165
         CLC   64(2,@3),@D1                                       0165
         BC    07,@9FA                                            0165
         MVC   66(2,@3),@D2                                       0166
*                             IF LDPRINT=0 /* IF NOT SPEC'D   OY00686 *
*                                THEN IF LDMAP^=1 /*AND NOMAP OY00686 *
@9FA     CLC   64(2,@3),@D2                                       0167
         BC    07,@9F9                                            0167
*                                        THEN LDPRINT=2;
         CLC   66(2,@3),@D3                                       0168
         BC    08,@9F8                                            0168
         MVC   64(2,@3),@D1                                       0169
*                                          /* SAME AS NOPRINT OY00686 *
*                             IF LDPRINT=1 /* IF PRINT        OY00686 *
*                                THEN DO;  /* EXAMINE PDE     OY00686 *
@9F8     EQU   *                                                  0170
@9F9     L     @1,PDLPTR                                          0170
         CLC   64(2,@1),@D3                                       0170
         BC    07,@9F7                                            0170
*                                     PTR1=ADDR(LDPRNTDS);
         LA    @F,76(0,@1)                                        0172
         ST    @F,MSGPARM+96                                      0172
*                                          /* GET TO DSN PDE  OY00686 *
*                                     IF DSF(1)='0'B &
*                                          /* IF NO NAME      OY00686 *
*                                        MEMF(1)='0'B
*                                          /* AND NO MEMBER   OY00686 *
*                                        THEN LDPRINT=0;
         LR    @3,@F               MSGPARM                        0173
         TM    6(@3),B'10000000'                                  0173
         BC    05,@9F6                                            0173
         TM    14(@3),B'10000000'                                 0173
         BC    05,@9F5                                            0173
         MVC   64(2,@1),@D2                                       0174
*                                          /* SAME AS NOPRINT OY00686 *
*                                     END; /*                 OY00686 *
@9F5     EQU   *                                                  0175
@9F6     EQU   *                                                  0175
*                             PRINT=LDPRINT; /* SET GBL PRINT OY00686 *
@9F7     L     @1,PDLPTR                                          0176
         MVC   PRINT(2),64(@1)                                    0176
*               /* PROCESS LOADGO LIBRARY OPTION/DATA SET     OY00686 *
*                             IF LDLIB=1 /* IF LIB            OY00686 *
*                                THEN DO; /* EXAMINE PDE      OY00686 *
         CLC   44(2,@1),@D3                                       0177
         BC    07,@9F4                                            0177
*                                     PTR1=ADDR(LDLIBRDS);
         LA    @F,100(0,@1)                                       0179
         ST    @F,MSGPARM+96                                      0179
*                                         /* GET TO DSN PDE   OY00686 *
*                                     IF DSF(1)='0'B
*                                         /* IF NO NAME       OY00686 *
*                                        THEN LDLIB=0;
         LR    @3,@F               MSGPARM                        0180
         TM    6(@3),B'10000000'                                  0180
         BC    05,@9F3                                            0180
         MVC   44(2,@1),@D2                                       0181
*                                         /* SAME AS NOLIB    OY00686 *
*                                     END; /*                 OY00686 *
@9F3     EQU   *                                                  0182
*                             LIB=LDLIB; /* SET GBL LIB       OY00686 *
@9F4     L     @1,PDLPTR                                          0183
         MVC   LIB(2),44(@1)                                      0183
*               /* PROCESS LOADGO TERM OPTION                 OY00686 *
*                             TERM=LDTERM; /* SET GBL TERM    OY00686 *
         MVC   TERM(2),70(@1)                                     0184
         BC    15,@9F2                                            0186
*                             END;
*         /* PROCESS LINK PDL                                 OY00686 *
*                        ELSE DO; /* LINK INVOKED             OY00686 *
*               /* PROCESS LINK PRINT OPTION/DATA SET         OY00686 *
*                             IF LKPRINT=2 /* IF NOPRINT      OY00686 *
*                                THEN DO; /* RESET ALL PRINT  OY00686 *
@9FB     L     @1,PDLPTR                                          0187
         CLC   58(2,@1),@D1                                       0187
         BC    07,@9F1                                            0187
*                                     LKMAP=0; /* NOMAP       OY00686 *
         MVC   60(2,@1),@D2                                       0189
*                                     LKXREF=0; /* NOXREF     OY00686 *
         MVC   62(2,@1),@D2                                       0190
*                                     LKLIST=0; /* NOLIST     OY00686 *
         MVC   64(2,@1),@D2                                       0191
*                                     END; /*                 OY00686 *
*                             IF LKPRINT=0 /* IF NOT SPEC'D   OY00686 *
*                                THEN IF LKMAP^=1 &
@9F1     L     @1,PDLPTR                                          0193
         CLC   58(2,@1),@D2                                       0193
         BC    07,@9F0                                            0193
*                                          /* AND NOMAP       OY00686 *
*                                        LKXREF^=1 &
*                                          /* AND NOXREF      OY00686 *
*                                        LKLIST^=1
*                                          /* AND NOLIST      OY00686 *
*                                        THEN LKPRINT=2;
         CLC   60(2,@1),@D3                                       0194
         BC    08,@9EF                                            0194
         CLC   62(2,@1),@D3                                       0194
         BC    08,@9EE                                            0194
         CLC   64(2,@1),@D3                                       0194
         BC    08,@9ED                                            0194
         MVC   58(2,@1),@D1                                       0195
*                                          /* SAME AS NOPRINT OY00686 *
*                             IF LKPRINT=1 /* IF PRINT        OY00686 *
*                                THEN DO; /* EXAMINE PDE      OY00686 *
@9ED     EQU   *                                                  0196
@9EE     EQU   *                                                  0196
@9EF     EQU   *                                                  0196
@9F0     L     @1,PDLPTR                                          0196
         CLC   58(2,@1),@D3                                       0196
         BC    07,@9EC                                            0196
*                                     PTR1=ADDR(LKPRNTDS);
         LA    @F,120(0,@1)                                       0198
         ST    @F,MSGPARM+96                                      0198
*                                         /* GET TO DSN PDE   OY00686 *
*                                     IF DSF(1)='0'B &
*                                         /* IF NO NAME       OY00686 *
*                                        MEMF(1)='0'B
*                                         /* AND NO MEMBER    OY00686 *
*                                        THEN LKPRINT=0;
         LR    @3,@F               MSGPARM                        0199
         TM    6(@3),B'10000000'                                  0199
         BC    05,@9EB                                            0199
         TM    14(@3),B'10000000'                                 0199
         BC    05,@9EA                                            0199
         MVC   58(2,@1),@D2                                       0200
*                                         /* SAME AS NOPRINT  OY00686 *
*                                     END; /*                 OY00686 *
@9EA     EQU   *                                                  0201
@9EB     EQU   *                                                  0201
*                             PRINT=LKPRINT; /* SET GBL PRINT OY00686 *
@9EC     L     @1,PDLPTR                                          0202
         MVC   PRINT(2),58(@1)                                    0202
*                             LKPRINT=0; /* RESET LINK PRINT  OY00686 *
         MVC   58(2,@1),@D2                                       0203
*               /* PROCESS LINK LIBRARY OPTION/DATA SET       OY00686 *
*                             IF LKLIB=1 /* IF LIB            OY00686 *
*                                THEN DO; /* EXAMINE PDE      OY00686 *
         CLC   38(2,@1),@D3                                       0204
         BC    07,@9E9                                            0204
*                                     PTR1=ADDR(LKLIBRDS);
         LA    @F,144(0,@1)                                       0206
         ST    @F,MSGPARM+96                                      0206
*                                         /* GET TO DSN PDE   OY00686 *
*                                     IF DSF(1)='0'B
*                                         /* IF NO NAME       OY00686 *
*                                        THEN LKLIB=0;
         LR    @3,@F               MSGPARM                        0207
         TM    6(@3),B'10000000'                                  0207
         BC    05,@9E8                                            0207
         MVC   38(2,@1),@D2                                       0208
*                                         /* SAME AS NOLIB    OY00686 *
*                                     END; /*                 OY00686 *
@9E8     EQU   *                                                  0209
*                             LIB=LKLIB; /* SET GBL LIB       OY00686 *
@9E9     L     @1,PDLPTR                                          0210
         MVC   LIB(2),38(@1)                                      0210
*               /* PROCESS LINK LOAD OPTION/DATA SET          OY00686 *
*                             IF LKLOAD=1 /* IF LOAD          OY00686 *
*                                THEN DO; /* EXAMINE PDE      OY00686 *
         CLC   36(2,@1),@D3                                       0211
         BC    07,@9E7                                            0211
*                                     PTR1=ADDR(LKLOADDS);
         LA    @F,96(0,@1)                                        0213
         ST    @F,MSGPARM+96                                      0213
*                                         /* GET TO DSN PDE   OY00686 *
*                                     IF DSF(1)='0'B &
*                                         /* IF NO NAME       OY00686 *
*                                        MEMF(1)='0'B
*                                         /* AND NO MEMBER    OY00686 *
*                                        THEN LKLOAD=0;
         LR    @3,@F               MSGPARM                        0214
         TM    6(@3),B'10000000'                                  0214
         BC    05,@9E6                                            0214
         TM    14(@3),B'10000000'                                 0214
         BC    05,@9E5                                            0214
         MVC   36(2,@1),@D2                                       0215
*                                         /* SAME AS NOLOAD   OY00686 *
*                                     END; /*                 OY00686 *
@9E5     EQU   *                                                  0216
@9E6     EQU   *                                                  0216
*               /* PROCESS LINK DCBS OPTION                   OY00686 *
*                             IF LKDCBS=1 /* IF DCBS          OY00686 *
*                                THEN DO; /* EXAMINE PDE      OY00686 *
@9E7     L     @1,PDLPTR                                          0217
         CLC   56(2,@1),@D3                                       0217
         BC    07,@9E4                                            0217
*                                     PTR1=ADDR(LKDCBSSF);
         LA    @F,184(0,@1)                                       0219
         ST    @F,MSGPARM+96                                      0219
*                                         /* GET TO IDT PDE   OY00686 *
*                                     BEG=6-STRL;
         LR    @3,@F               MSGPARM                        0220
         LH    @F,4(0,@3)                                         0220
         LCR   @F,@F                                              0220
         AH    @F,@D4                                             0220
         STH   @F,BEG                                             0220
*                                       /* GET NO. OF CHARS.          *
*                                     BLK1=0;
         MVC   BLK1(4),@D5                                        0221
         MVI   BLK1+4,C' '                                        0221
*                                       /* INIT. TO ZEROS             *
*                                     BLK1(BEG:5)=STR->CHARST(1:STRL);
         L     @6,MSGPARM+96       MSGPARM                        0222
         L     @6,0(0,@6)          STRING                         0222
         LR    @E,@6                                              0222
         LA    @7,5                                               0222
         LH    @4,BEG                                             0222
         SR    @7,@4                                              0222
         LA    @A,BLK1-1(@4)                                      0222
         EX    @7,@MVC                                            0222
*                                       /* MOVE IN                    *
*         GENERATE;                     /* GET BLOCKSIZE IN BINARY FOR*
         PACK  BLK2(8),BLK1(5)
         CVB    @1,BLK2                     GET IN BINARY FORM
         ST    @1,DCBSBLK
         DS    0H
*                                     END;
*               /* PROCESS LINK TERM OPTION                   OY00686 *
*                             TERM=LKTERM; /* SET GBL TERM    OY00686 *
@9E4     L     @1,PDLPTR                                          0225
         MVC   TERM(2),90(@1)                                     0225
*                             END; /*                         OY00686 *
*         /* ******************************************************** *
*         /*            ALLOCATE ALL DATA SETS                        *
*         /* ******************************************************** *
*         /* IF NECESSARY, CONCATENATE INPUT DATA SETS.               *
*         /* ******************************************************** *
*         DAPB0PTR=ADDR(DAIR0C);        /* GET ADDRESS OF 0C BLOCK    *
@9F2     LA    @F,DAIR0C                                          0227
         ST    @F,MSGPARM                                         0227
*         IF DA0CNUMB > 1 THEN DO;
         LA    @F,1                                               0228
         L     @1,MSGPARM                                         0228
         CH    @F,8(0,@1)                                         0228
         BC    10,@9E3                                            0228
*                              DAPLDAPB=DAPB0PTR;
         L     @3,DAPLPTR                                         0230
         MVC   16(4,@3),MSGPARM                                   0230
*                              R1=DAPLPTR;
         L     @1,DAPLPTR                                         0231
*                              GEN(LINK  EP=IKJDAIR);
         LINK  EP=IKJDAIR
         DS    0H
*                              RCODE=R15;
         STH   @F,MSGPARM+6                                       0233
*                              IF RCODE^=0 /* ERROR OCCURRED?         *
*                                 THEN DO; /* ERROR IN CONCAT'ING     *
         SR    @F,@F                                              0234
         CH    @F,MSGPARM+6                                       0234
         BC    08,@9E2                                            0234
*                                      CALL AKJLKMSG(LSTPTR,25);
         LA    @F,LSTPTR                                          0236
         ST    @F,@PL001                                          0236
         LA    @F,@D6                                             0236
         ST    @F,@PL001+4                                        0236
         L     @F,@V1              ADDRESS OF AKJLKMSG            0236
         LA    @1,@PL001                                          0236
         BALR  @E,@F                                              0236
*                                      GO TO FINIS;
         BC    15,FINIS                                           0237
*                                      END;
*                              INPT=DA0CDDN(1);
@9E2     L     @1,BASE                                            0239
         MVC   0(8,@1),DAIR0C+12                                  0239
*                              END;
*         /* ******************************************************** *
*         /* MOVE IN SYSLIN DDNAME.                                   *
*         /* ******************************************************** *
*         SYSLIN=DA0CDDN(1);
@9E3     L     @1,BASE                                            0241
         MVC   18(8,@1),DAIR0C+12                                 0241
*         GEN(XC DAIR0C+2(210),DAIR0C+2); /* ZERO OUT CONCAT. BLOCK   *
         XC DAIR0C+2(210),DAIR0C+2
         DS    0H
*         /* ******************************************************** *
*         /* CHECK FOR PRINT DATA SET (SYSPRINT)                      *
*         /* ******************************************************** *
* PRNTCH: IF PRINT=2 THEN DO;                  /* NOPRINT SPECIFIED   *
PRNTCH   LA    @F,2                                               0243
         CH    @F,PRINT                                           0243
         BC    07,@9DF                                            0243
*                         IF LKLD='LOAD'       /* GOING TO LOADER?    *
*                            THEN GO TO LDCH;  /* YES - SKIP SYSPRINT *
         L     @1,BASE                                            0245
         CLC   276(4,@1),@C6                                      0245
         BC    08,LDCH                                            0246
*                         /* **************************************** *
*                         /* ALLOCATE DUMMY DATA SET FOR SYSPRINT     *
*                         /* **************************************** *
*                         DAPB0PTR=ADDR(DAIR08);
         LA    @F,DAIR08                                          0247
         ST    @F,MSGPARM                                         0247
*                         DAPLDAPB=DAPB0PTR;
         L     @3,DAPLPTR                                         0248
         MVC   16(4,@3),MSGPARM                                   0248
*                         GEN(XC DAIR08+2(74),DAIR08+2);
         XC DAIR08+2(74),DAIR08+2
         DS    0H
*                         DA08DDN=BLANKS;      /* SET DDNAME TO BLANKS*
         L     @1,MSGPARM                                         0250
         MVC   12(8,@1),BLANKS                                    0250
*                         DA08SER=BLANKS;      /* SET SER TO BLANKS   *
         MVC   28(8,@1),BLANKS                                    0251
*                         DA08UNIT=BLANKS;     /* SET UNIT TO BLANKS  *
         MVC   20(8,@1),BLANKS                                    0252
*                         DA08PSWD=BLANKS;
         MVC   60(8,@1),BLANKS                                    0253
*                         DA08MNM=BLANKS; /* BLANK MEMBER NAME YM4355 *
         MVC   52(8,@1),BLANKS                                    0254
*                         DA08DMMY='1'B;        /* GET DUMMY DATA SET *
         OI    71(@1),B'00000100'                                 0255
*                         DA08NEW='1'B;         /* ALLOCATE AS NEW,   *
         OI    68(@1),B'00000100'                                 0256
*                         DA08DEL='1'B;         /* DELETE,            *
         OI    69(@1),B'00000100'                                 0257
*                         DA08DELE='1'B;        /* DELETE.            *
         OI    70(@1),B'00000100'                                 0258
*                         R1=DAPLPTR;           /* SET PARM. LIST PTR *
         L     @1,DAPLPTR                                         0259
*                         GEN(LINK EP=IKJDAIR); /* GO TO DAIR         *
         LINK EP=IKJDAIR
         DS    0H
*                         IF R15^=0    /* CHECK RTN CDE       ZM02759 *
*                            THEN DO;  /* FOR ALLOC FAILURE   ZM02759 *
         LTR   @F,@F                                              0261
         BC    08,@9DE                                            0261
*                            MSG34: RCODE=R15;
MSG34    STH   @F,MSGPARM+6                                       0263
*                                      /* SAVE RTN CDE        ZM02759 *
*                                   CALL AKJLKMSG(LSTPTR,34);
         LA    @F,LSTPTR                                          0264
         ST    @F,@PL001                                          0264
         LA    @F,@D7                                             0264
         ST    @F,@PL001+4                                        0264
         L     @F,@V1              ADDRESS OF AKJLKMSG            0264
         LA    @1,@PL001                                          0264
         BALR  @E,@F                                              0264
*                                      /* LOG MSG ON ERROR    ZM02759 *
*                                   GO TO FINIS;
         BC    15,FINIS                                           0265
*                                      /* THEN TERMINATE      ZM02759 *
*                                 END; /*                     ZM02759 *
*                         SYSPRNT=DA08DDN;      /*  MOVE IN SYSPRINT  *
@9DE     L     @1,MSGPARM                                         0267
         L     @3,BASE                                            0267
         MVC   58(8,@3),12(@1)                                    0267
*                         GO TO LDCH;
         BC    15,LDCH                                            0268
*                         END;
*         LQUAL=8;
@9DF     LA    @F,8                                               0270
         STH   @F,LQUAL                                           0270
*         IF LKLD='LOAD' THEN QUAL='LOADLIST';  /* SET LOADER NAME    *
         L     @1,BASE                                            0271
         CLC   276(4,@1),@C6                                      0271
         BC    07,@9DB                                            0271
         MVC   A00001+1(8),@C21                                   0272
         BC    15,@9DA                                            0273
*                        ELSE QUAL='LINKLIST';  /* SET L. E. NAME     *
@9DB     MVC   A00001+1(8),@C22                                   0273
*         IF PRINT=0
*            /* ***************************************************** *
*            /* ALLOCATE DEFAULT PRINT DATA SET NAME                  *
*            /* ***************************************************** *
*            THEN CALL ALLOCDS('PRNT','DEFL');
@9DA     SR    @F,@F                                              0274
         CH    @F,PRINT                                           0274
         BC    07,@9D9                                            0274
         LA    @F,@C23                                            0275
         ST    @F,@PL001                                          0275
         LA    @F,@C24                                            0275
         ST    @F,@PL001+4                                        0275
         LA    @1,@PL001                                          0275
         BAL   @E,ALLOCDS                                         0275
*         IF PRINT=1 THEN DO;
@9D9     LA    @F,1                                               0276
         CH    @F,PRINT                                           0276
         BC    07,@9D6                                            0276
*                         /* **************************************** *
*                         /* PRINT DATA SET WAS SPECIFIED             *
*                         /* **************************************** *
*                         IF LKLD='LOAD' /* LOADGO INVOKED    OY00686 *
*                            THEN PTR1=ADDR(LDPRNTDS);
         L     @1,BASE                                            0278
         CLC   276(4,@1),@C6                                      0278
         BC    07,@9D5                                            0278
         L     @3,PDLPTR                                          0279
         LA    @F,76(0,@3)                                        0279
         ST    @F,MSGPARM+96                                      0279
         BC    15,@9D4                                            0280
*                                        /* GET TO LOADGO PDE OY00686 *
*                            ELSE PTR1=ADDR(LKPRNTDS);
@9D5     L     @3,PDLPTR                                          0280
         LA    @F,120(0,@3)                                       0280
         ST    @F,MSGPARM+96                                      0280
*                                        /* GET TO LINK PDE   OY00686 *
*                         IF DSN>0 & DSN->CHARST(1)='*'
*                            THEN DO;
@9D4     SR    @F,@F                                              0281
         L     @6,MSGPARM+96       MSGPARM                        0281
         C     @F,0(0,@6)                                         0281
         BC    10,@9D3                                            0281
         L     @7,MSGPARM+96       MSGPARM                        0281
         L     @7,0(0,@7)          DATASET                        0281
         CLI   0(@7),C'*'                                         0281
         BC    07,@9D2                                            0281
*                                 /* ******************************** *
*                                 /* ALLOCATE SYSPRINT TO TERMINAL    *
*                                 /* ******************************** *
*                                 DAPB1PTR=ADDR(DAIR1C);  /* SET PTR  *
         LA    @F,DAIR1C                                          0283
         ST    @F,DAPB1PTR                                        0283
*                                 DA1CALN='LKLDATTR';     /*  OY00691 *
         LR    @4,@F                                              0284
         MVC   16(8,@4),@C17                                      0284
*                                       /* ASSIGN ATTR NAME   OY00691 *
*                                 DA1CATRL='1'B; /* INDIC ATTR LIST   *
         OI    7(@4),B'00000010'                                  0285
*                                                /* PRESENT   OY00691 *
*                                 DAPLDAPB=ADDR(DAIR28);  /*  OY00691 *
         LA    @F,DAIR28                                          0286
         L     @5,DAPLPTR                                         0286
         ST    @F,16(0,@5)                                        0286
*                                       /* SET DAIR POINTER   OY00691 *
*                                 R1=DAPLPTR;             /* LIST PTR *
         L     @1,DAPLPTR                                         0287
*                                 GEN(LINK EP=IKJDAIR);   /*GO TO DAIR*
         LINK EP=IKJDAIR
         DS    0H
*                                 IF R15^=0 /* IF ALLOC FAILS ZM02759 *
*                                    THEN GO TO MSG34;
         LTR   @F,@F                                              0289
         BC    07,MSG34                                           0290
*                                           /* GO LOG MSG     ZM02759 *
*                                 DAPB3PTR=ADDR(DAIR34);  /*  OY00691 *
         LA    @F,DAIR34                                          0291
         ST    @F,DAPB3PTR                                        0291
*                                       /* PT TO X'34' BLK    OY00691 *
*                                 DA34UNCH='1'B;          /*  OY00691 *
         LR    @1,@F                                              0292
         OI    6(@1),B'00100000'                                  0292
*                                       /* INDICATE UNASSIGN  OY00691 *
*                                 DA34CHN='0'B;           /*  OY00691 *
         NI    6(@1),B'10111111'                                  0293
*                                       /* DEINDICATE ASSIGN  OY00691 *
*                                 DAPLDAPB=ADDR(DAIR34);  /*  OY00691 *
         LA    @F,DAIR34                                          0294
         ST    @F,16(0,@5)                                        0294
*                                      /* SET DAIR PTR        OY00691 *
*                                 R1=DAPLPTR;             /*  OY00691 *
         L     @1,DAPLPTR                                         0295
*                                       /* SET PARAM REG      OY00691 *
*                                 GEN(LINK EP=IKJDAIR);   /*  OY00691 *
         LINK EP=IKJDAIR
         DS    0H
*                                       /* CALL DAIR          OY00691 *
*                                 SYSPRNT=DA1CDDN;        /* SYSPRINT *
         L     @1,BASE                                            0297
         MVC   58(8,@1),8(@4)                                     0297
*                                 /* CANCEL TERM OPTION IF    OY00686 *
*                                 /* SYSPRINT IS TERMINAL     OY00686 *
*                                 TERM=0;                  /* ZM00619 *
         SR    @F,@F                                              0298
         STH   @F,TERM                                            0298
*                                 IF LKLD='LOAD' /* IF LOADGO OY00686 *
*                                    THEN LDTERM=0;
         CLC   276(4,@1),@C6                                      0299
         BC    07,@9D1                                            0299
         MVC   70(2,@3),@D2                                       0300
         BC    15,@9D0                                            0301
*                                         /* RESET LOADGO OPT OY00686 *
*                                    ELSE LKTERM=0;
@9D1     MVC   90(2,@3),@D2                                       0301
*                                         /* RESET LINK OPT   OY00686 *
*                                 GO TO LDCH;             /* NEXT DS. *
         BC    15,LDCH                                            0302
*                                 END;
*                         /* **************************************** *
*                         /* ALLOCATE SPECIFIED PRINT DATA SET.       *
*                         /* **************************************** *
*                         CALL ALLOCDS('PRNT','NODF');
@9D2     EQU   *                                                  0304
@9D3     LA    @F,@C23                                            0304
         ST    @F,@PL001                                          0304
         LA    @F,@C26                                            0304
         ST    @F,@PL001+4                                        0304
         LA    @1,@PL001                                          0304
         BAL   @E,ALLOCDS                                         0304
*                         END;
*         /* ******************************************************** *
*         /* MOVE IN SYSPRINT DDNAME                                  *
*         /* ******************************************************** *
*         SYSPRNT=DA08DDN;
@9D6     L     @1,MSGPARM                                         0306
         L     @3,BASE                                            0306
         MVC   58(8,@3),12(@1)                                    0306
*         /* ******************************************************** *
*         /*   CHECK FOR LOAD DATA SET   ( SYSLMOD)                   *
*         /* ******************************************************** *
* LDCH:   QUAL='LOAD    ';              /* SET LOAD MODULE QULIFIER   *
LDCH     MVC   A00001+1(8),@C27                                   0307
*         LQUAL=4;                      /* SET LENGTH OF QUALIFIER    *
         LA    @F,4                                               0308
         STH   @F,LQUAL                                           0308
*         IF LKLD='LOAD'                /* GOING TO LOADER?           *
*            THEN GO TO LIBCH;          /* YES - GO DO LIBRARY DS.    *
         L     @1,BASE                                            0309
         CLC   276(4,@1),@C6                                      0309
         BC    08,LIBCH                                           0310
*         IF LKLOAD=1 THEN DO;          /*                    OY00686 *
         L     @3,PDLPTR                                          0311
         CLC   36(2,@3),@D3                                       0311
         BC    07,@9CD                                            0311
*                        /* ***************************************** *
*                        /* ALLOCATE SPECIFIED LOAD DATA SET          *
*                        /* ***************************************** *
*                        PTR1=ADDR(LKLOADDS); /*              OY00686 *
         LA    @F,96(0,@3)                                        0313
         ST    @F,MSGPARM+96                                      0313
*                        CALL ALLOCDS('LOAD','NODF');
         LA    @F,@C6                                             0314
         ST    @F,@PL001                                          0314
         LA    @F,@C26                                            0314
         ST    @F,@PL001+4                                        0314
         LA    @1,@PL001                                          0314
         BAL   @E,ALLOCDS                                         0314
*                        END;
*         IF LKLOAD=0                         /*              OY00686 *
*                        /* ***************************************** *
*                        /* DEFAULT NAME FOR SYSLMOD REQUIRED.        *
*                        /* ***************************************** *
*                        /* SET DSNAME, DSLENGTH,MEMBERNAME FOR ALLOC *
*                        /*                                           *
*            THEN DO;    /* SET UP DEFAULT SYSLMOD NAME               *
@9CD     L     @1,PDLPTR                                          0316
         CLC   36(2,@1),@D2                                       0316
         BC    07,@9CA                                            0316
*                 PTR1=ADDR(LKLOADDS);  /* NULL PDE ENTRY ADDR        *
         LA    @F,96(0,@1)                                        0318
         ST    @F,MSGPARM+96                                      0318
*                                       /*            OY00686,SA50095 *
*                 CALL ALLOCDS('LOAD','DEFL');
         LA    @F,@C6                                             0319
         ST    @F,@PL001                                          0319
         LA    @F,@C24                                            0319
         ST    @F,@PL001+4                                        0319
         LA    @1,@PL001                                          0319
         BAL   @E,ALLOCDS                                         0319
*                 END;
*         /* ******************************************************** *
*         /* MOVE IN SYSLMOD DDNAME AND MEMBER NAME                   *
*         /* ******************************************************** *
*         SYSLMOD=DA08DDN;
@9CA     L     @1,MSGPARM                                         0321
         L     @3,BASE                                            0321
         MVC   34(8,@3),12(@1)                                    0321
*         MEMBER=DA08MNM;
         MVC   26(8,@3),52(@1)                                    0322
*         /* ******************************************************** *
*         /* ALLOCATE SYSUT1 AND MOVE IN DDNAME                       *
*         /* ******************************************************** *
* SYSUT:  DSNLNGTH=7;                   /* SET DATA SET LENGTH        *
SYSUT    LA    @F,7                                               0323
         L     @1,MSGPARM+92       MSGPARM                        0323
         STH   @F,0(0,@1)                                         0323
*         DSNM=' ';
         MVI   2(@1),C' '                                         0324
         MVC   3(43,@1),2(@1)                                     0324
*         DSNM(1:7)='&SYSUT1';
         MVC   2(7,@1),@C28                                       0325
*         CALL ALLOCDS('UTIL','UTIL');  /* GO ALLOCATE DATA SET       *
         LA    @F,@C29                                            0326
         ST    @F,@PL001                                          0326
         ST    @F,@PL001+4                                        0326
         LA    @1,@PL001                                          0326
         BAL   @E,ALLOCDS                                         0326
*         SYSUT1=DA08DDN;               /* MOVE IN UTILITY DATA SET   *
         L     @1,MSGPARM                                         0327
         L     @3,BASE                                            0327
         MVC   74(8,@3),12(@1)                                    0327
*         /* ******************************************************** *
*         /*     CHECK FOR LIBRARY DATA SETS  (SYSLIB)                *
*         /* ******************************************************** *
* LIBCH:  DAPB0PTR=ADDR(DAIR0C);
LIBCH    LA    @F,DAIR0C                                          0328
         ST    @F,MSGPARM                                         0328
*         IF LIB=1 THEN DO;
         LA    @F,1                                               0329
         CH    @F,LIB                                             0329
         BC    07,@9C5                                            0329
*                       /* ****************************************** *
*                       /* LIBRARY DATA SET(S) SPECIFIED.             *
*                       /* ****************************************** *
*                       IF LKLD='LOAD' /* IF LOADGO           OY00686 *
*                          THEN PTR1=ADDR(LDLIBRDS);
         L     @1,BASE                                            0331
         CLC   276(4,@1),@C6                                      0331
         BC    07,@9C4                                            0331
         L     @3,PDLPTR                                          0332
         LA    @F,100(0,@3)                                       0332
         ST    @F,MSGPARM+96                                      0332
         BC    15,@9C3                                            0333
*                                      /* GET TO LOADGO PDE   OY00686 *
*                          ELSE PTR1=ADDR(LKLIBRDS);
@9C4     L     @3,PDLPTR                                          0333
         LA    @F,144(0,@3)                                       0333
         ST    @F,MSGPARM+96                                      0333
*                                      /* GET TO LINK PDE     OY00686 *
*                  NXT: CALL ALLOCDS('LIBR','NODF');
@9C3     EQU   *                                                  0334
NXT      LA    @F,@C30                                            0334
         ST    @F,@PL001                                          0334
         LA    @F,@C26                                            0334
         ST    @F,@PL001+4                                        0334
         LA    @1,@PL001                                          0334
         BAL   @E,ALLOCDS                                         0334
*                       PTR1=NEXT;
         L     @1,MSGPARM+96       MSGPARM                        0335
         MVC   MSGPARM+96(4),24(@1)                               0335
*                       IF PTR1^='FF000000'X THEN GO TO NXT;
         L     @F,@X31                                            0336
         C     @F,MSGPARM+96                                      0336
         BC    07,NXT                                             0337
*                       END;
*         /* ******************************************************** *
*         /* ALLOCATE SYSTEM LIBRARIES                                *
*         /* ******************************************************** *
*         IF LKLD='LOAD'                /* LOADGO INVOKED     OY00686 *
*            THEN DO;                   /* SET UP LOAD PARMS  OY00686 *
@9C5     L     @1,BASE                                            0339
         CLC   276(4,@1),@C6                                      0339
         BC    07,@9C0                                            0339
*                 PTR1=ADDR(LDLIBRDS);  /* PT TO DUMMY PDE    OY00686 *
         L     @3,PDLPTR                                          0341
         LA    @F,100(0,@3)                                       0341
         ST    @F,MSGPARM+96                                      0341
*                 PTR3=ADDR(LDPLI);     /* GET TO LOADGO PDE  OY00686 *
         LA    @F,46(0,@3)                                        0342
         ST    @F,PTR3                                            0342
         BC    15,@9BF                                            0344
*                 END;                  /*                    OY00686 *
*            ELSE DO;                   /* SET UP LINK PARMS  OY00686 *
*                 PTR1=ADDR(LKLIBRDS);  /* PT TO DUMMY PDE    OY00686 *
@9C0     L     @1,PDLPTR                                          0345
         LA    @F,144(0,@1)                                       0345
         ST    @F,MSGPARM+96                                      0345
*                 PTR3=ADDR(LKPLI);     /* GET TO LINK PDE    OY00686 *
         LA    @F,40(0,@1)                                        0346
         ST    @F,PTR3                                            0346
*                 END;                  /*                    OY00686 *
*         DSF(2)='0'B;                  /* SET NOT QUALIFIED FLAG     *
@9BF     L     @1,MSGPARM+96       MSGPARM                        0348
         NI    6(@1),B'10111111'                                  0348
*         DO I=1 TO 6;                  /* CHECK FOR EACH LIB OY00686 *
         LA    @F,1                                               0349
         STH   @F,I                                               0349
*         IF LIBS(I)=1                  /* I-TH LIBRARY SPEC.?        *
*            THEN DO;                   /* YES - ALLOCATE IT          *
@DO9BE   LA    @F,1                                               0350
         LH    @1,I                                               0350
         BCTR  @1,0                                               0350
         SLA   @1,1                                               0350
         L     @3,PTR3                                            0350
         CH    @F,0(@1,@3)                                        0350
         BC    07,@9BA                                            0350
*                 IF I=1  I=3  I=6    /* PL1LIB OR COBLIB?  OY00686 *
*                    THEN DSNLNGTH=11;  /* YES - SET LENGTH           *
         CH    @F,I                                               0352
         BC    08,@9B9                                            0352
         LA    @F,3                                               0352
         CH    @F,I                                               0352
         BC    08,@9B8                                            0352
         LA    @F,6                                               0352
         CH    @F,I                                               0352
         BC    07,@9B7                                            0352
@9B8     EQU   *                                                  0353
@9B9     LA    @F,11                                              0353
         L     @1,MSGPARM+92       MSGPARM                        0353
         STH   @F,0(0,@1)                                         0353
         BC    15,@9B6                                            0354
*                    ELSE DSNLNGTH=12;  /* NO -  SET LENGTH           *
@9B7     LA    @F,12                                              0354
         L     @1,MSGPARM+92       MSGPARM                        0354
         STH   @F,0(0,@1)                                         0354
*                 DSNM=' ';
@9B6     L     @1,MSGPARM+92       MSGPARM                        0355
         MVI   2(@1),C' '                                         0355
         MVC   3(43,@1),2(@1)                                     0355
*                 DSNM(1:5)='SYS1.';    /* SET FIRST PART OF NAME     *
         MVC   2(5,@1),@C32                                       0356
*                 DSNM(6:12)=LIBNMS(I); /* SET LAST PART OF NAME      *
         LH    @3,I                                               0357
         MH    @3,@D8                                             0357
         LA    @E,LIBNMS-7(@3)                                    0357
         MVC   7(7,@1),0(@E)                                      0357
*                 CALL ALLOCDS('LIBR','SYSL');  /* ALLOCATE LIBRARY   *
         LA    @F,@C30                                            0358
         ST    @F,@PL001                                          0358
         LA    @F,@C33                                            0358
         ST    @F,@PL001+4                                        0358
         LA    @1,@PL001                                          0358
         BAL   @E,ALLOCDS                                         0358
*                 END;
*         END;                          /* END OF LOOP                *
*         DAPB0PTR=ADDR(DAIR0C);
@9BA     LH    @F,I                                               0360
         AH    @F,@D3                                             0360
@DO9BD   STH   @F,I                                               0360
         CH    @F,@D4                                             0360
         BC    12,@DO9BE                                          0360
         LA    @F,DAIR0C                                          0361
         ST    @F,MSGPARM                                         0361
*         IF DA0CNUMB>1 THEN DO;
         LA    @F,1                                               0362
         L     @1,MSGPARM                                         0362
         CH    @F,8(0,@1)                                         0362
         BC    10,@9B3                                            0362
*                            /* ************************************* *
*                            /*  CONCATENATE LIBRARY DATA SETS        *
*                            /* ************************************* *
*                            DAPLDAPB=DAPB0PTR;
         L     @3,DAPLPTR                                         0364
         MVC   16(4,@3),MSGPARM                                   0364
*                            R1=DAPLPTR;
         L     @1,DAPLPTR                                         0365
*                            GEN(LINK  EP=IKJDAIR);
         LINK  EP=IKJDAIR
         DS    0H
*                            RCODE=R15;
         STH   @F,MSGPARM+6                                       0367
*                            IF RCODE > 0
*                               THEN DO; /* ERROR IN CONCAT'ING       *
         SR    @F,@F                                              0368
         CH    @F,MSGPARM+6                                       0368
         BC    10,@9B2                                            0368
*                                    CALL AKJLKMSG(LSTPTR,26);
         LA    @F,LSTPTR                                          0370
         ST    @F,@PL001                                          0370
         LA    @F,@D9                                             0370
         ST    @F,@PL001+4                                        0370
         L     @F,@V1              ADDRESS OF AKJLKMSG            0370
         LA    @1,@PL001                                          0370
         BALR  @E,@F                                              0370
*                                    GO TO FINIS;
         BC    15,FINIS                                           0371
*                                    END;
*                            LIBY=DA0CDDN(1);
@9B2     L     @1,BASE                                            0373
         MVC   8(8,@1),DAIR0C+12                                  0373
*                            END;
*         /* ******************************************************** *
*         /*   MOVE IN DDNAME FOR SYSLIB IF ANY LIBRARY DATA SETS     *
*         /*   WERE SPECIFIED.                                        *
*         /* ******************************************************** *
*         IF DA0CNUMB^=0 THEN SYSLIB=DA0CDDN(1);
@9B3     SR    @F,@F                                              0375
         L     @1,MSGPARM                                         0375
         CH    @F,8(0,@1)                                         0375
         BC    08,@9AF                                            0375
         L     @3,BASE                                            0376
         MVC   42(8,@3),DAIR0C+12                                 0376
*         /* ******************************************************** *
*         /* ALLOCATE SYSTERM IF TERM WAS SPECIFIED                   *
*         /* ******************************************************** *
*         IF TERM=1                     /* TERM SPECIFIED?            *
*            THEN DO;                   /* YES - ALLOC. SYSTERM       *
@9AF     LA    @F,1                                               0377
         CH    @F,TERM                                            0377
         BC    07,@9AE                                            0377
*                 DAPB1PTR=ADDR(DAIR1C); /* SET PARM. BLOCK POINTER   *
         LA    @F,DAIR1C                                          0379
         ST    @F,DAPB1PTR                                        0379
*                 DAPLDAPB=ADDR(DAIR1C); /* SET PARM. BLOCK POINTER   *
         LA    @F,DAIR1C                                          0380
         L     @3,DAPLPTR                                         0380
         ST    @F,16(0,@3)                                        0380
*                 R1=DAPLPTR;           /* SET PARM. LIST POINTER     *
         L     @1,DAPLPTR                                         0381
*                 GEN(LINK  EP=IKJDAIR); /* GO TO DAIR                *
         LINK  EP=IKJDAIR
         DS    0H
*                 IF R15^=0              /* IF ALLOC FAILURE  ZM02759 *
*                    THEN GO TO MSG34;   /* GO LOG MSG        ZM02759 *
         LTR   @F,@F                                              0383
         BC    07,MSG34                                           0384
*                 SYSTERM=DA1CDDN;
         L     @1,DAPB1PTR                                        0385
         L     @6,BASE                                            0385
         MVC   106(8,@6),8(@1)                                    0385
*                 END;
*         /* ******************************************************** *
*         /*         GATHER OPTIONS                                   *
*         /* ******************************************************** *
*         BEG=1;                        /* SET BEGINNING OF STRING    *
@9AE     LA    @F,1                                               0387
         STH   @F,BEG                                             0387
*         IF LKLD='LOAD'                /* LOADGO INVOKED     OY00686 *
*            THEN DO;                   /* SET FOR LOADGO     OY00686 *
         L     @1,BASE                                            0388
         CLC   276(4,@1),@C6                                      0388
         BC    07,@9AD                                            0388
*                 K=9;                  /* PARAM COUNT        OY00686 *
         LA    @F,9                                               0390
         STH   @F,K                                               0390
*                 PTR3=ADDR(LDSIZE);    /* PDE PARAM ARRAY    OY00686 *
         L     @3,PDLPTR                                          0391
         LA    @F,58(0,@3)                                        0391
         ST    @F,PTR3                                            0391
         BC    15,@9AC                                            0393
*                 END;                  /*                    OY00686 *
*            ELSE DO;                   /* SET FOR LINK       OY00686 *
*                 K=22;                 /* PARAM COUNT        OY00686 *
@9AD     LA    @F,22                                              0394
         STH   @F,K                                               0394
*                 PTR3=ADDR(LKSIZE);    /* PDE PARAM ARRAY    OY00686 *
         L     @1,PDLPTR                                          0395
         LA    @F,52(0,@1)                                        0395
         ST    @F,PTR3                                            0395
*                 END;                  /*                    OY00686 *
*         DO J=1 TO K;                  /* LOOK AT OPTIONS    OY00686 *
@9AC     LA    @F,1                                               0397
         BC    15,@DO9AA                                          0397
*         I=J;                          /* GET OPTION INDEX           *
@DO9AB   MVC   I(2),J                                             0398
*         IF PARMS(I)=0                 /* IS OPTION SPECIFIED?       *
*            THEN GO TO EL1;            /* NO - CONTINUE LOOP         *
         SR    @F,@F                                              0399
         LH    @1,I                                               0399
         BCTR  @1,0                                               0399
         SLA   @1,1                                               0399
         L     @3,PTR3                                            0399
         CH    @F,0(@1,@3)                                        0399
         BC    08,EL1                                             0400
*         IF PARMS(I)=2                 /* OBVERSE OPTION SPEC.?      *
*            THEN DO;                   /* YES                        *
         LA    @F,2                                               0401
         CH    @F,0(@1,@3)                                        0401
         BC    07,@9A7                                            0401
*                 IF LKLD='LINK'        /* LINK. ED. SPEC.?           *
*                    THEN GO TO EL1;    /* YES - CONTINUE LOOP        *
         L     @6,BASE                                            0403
         CLC   276(4,@6),@C4                                      0403
         BC    08,EL1                                             0404
*                 OPLIST(BEG:BEG+1)='NO'; /* ADD NO TO LIST           *
         LH    @7,BEG                                             0405
         LA    @A,115(@7,@6)                                      0405
         MVC   0(2,@A),@C26                                       0405
*                 BEG=BEG+2;            /* RESET BEGINNING OF STRING  *
         LA    @F,2                                               0406
         AH    @F,BEG                                             0406
         STH   @F,BEG                                             0406
*                 END;
* MOPT:   IF LKLD='LOAD'                /*  LOADGO INVOKED    OY00686 *
*             THEN DO;                  /* SET FOR LOADGO     OY00686 *
@9A7     EQU   *                                                  0408
MOPT     L     @1,BASE                                            0408
         CLC   276(4,@1),@C6                                      0408
         BC    07,@9A6                                            0408
*                  OPTSTPTR=ADDR(LDOPTS(I)); /* PT TO CHARS   OY00686 *
         LH    @3,I                                               0410
         MH    @3,@D10                                            0410
         LA    @F,LDOPTS-5(@3)                                    0410
         ST    @F,OPTSTPTR                                        0410
*                  N=LDLNGTHO(I);       /* GET OPTION LENGTH          *
         LH    @6,I                                               0411
         SLA   @6,1                                               0411
         LH    @F,LDLNGTHO-2(@6)                                  0411
         STH   @F,N                                               0411
         BC    15,@9A5                                            0413
*                                       /*            OY00691,OY00686 *
*                  END;                 /*                    OY00686 *
*             ELSE DO;                  /* SET FOR LINK       OY00686 *
*                  OPTSTPTR=ADDR(LKOPTS(I)); /* PT TO CHARS   OY00686 *
@9A6     LH    @1,I                                               0414
         MH    @1,@D4                                             0414
         LA    @F,LKOPTS-6(@1)                                    0414
         ST    @F,OPTSTPTR                                        0414
*                  N=LKLNGTHO(I);       /* GET OPTION LENGTH          *
         LH    @3,I                                               0415
         SLA   @3,1                                               0415
         LH    @F,LKLNGTHO-2(@3)                                  0415
         STH   @F,N                                               0415
*                                       /*            OY00691,OY00686 *
*                  END;                 /*                    OY00686 *
*         ENDD=BEG+N-1;                 /* GET END OF STRING          *
@9A5     LH    @F,@D11                                            0417
         AH    @F,N                                               0417
         AH    @F,BEG                                             0417
         STH   @F,ENDD                                            0417
*         OPLIST(BEG:ENDD)=OPTSTPTR->CHARST(1:N);
         L     @1,OPTSTPTR                                        0418
         LR    @E,@1                                              0418
         LR    @3,@F                                              0418
         LH    @6,BEG                                             0418
         SR    @3,@6                                              0418
         L     @7,BASE                                            0418
         LA    @A,115(@6,@7)                                      0418
         EX    @3,@MVC                                            0418
*                                       /* MOVE IN OPTION     OY00686 *
*         BEG=ENDD+1;                   /* RESET BEGINNING OF STRING  *
         LA    @F,1                                               0419
         AH    @F,ENDD                                            0419
         STH   @F,BEG                                             0419
*         IF I > 3                      /* PARAMETER NEEDED?          *
*            THEN GO TO COMM;           /* NO - ADD COMMA & CONTINUE  *
         LA    @F,3                                               0420
         CH    @F,I                                               0420
         BC    04,COMM                                            0421
*         IF I=1                        /* SIZE OPTION?               *
*            THEN DO;                   /* YES - ADD PARAMETER        *
         LA    @F,1                                               0422
         CH    @F,I                                               0422
         BC    07,@9A4                                            0422
*                 IF LKLD='LINK'        /* LINK. ED. SPECIFIED?       *
*                    THEN DO;           /* YES - ADD PAREN.           *
         CLC   276(4,@7),@C4                                      0424
         BC    07,@9A3                                            0424
*                         PTR1=ADDR(LKSIZESF);
         L     @3,PDLPTR                                          0426
         LA    @F,172(0,@3)                                       0426
         ST    @F,MSGPARM+96                                      0426
*                                       /* GET ADDRESS OF PDE OY00686 *
*                         OPLIST(BEG)='(';
         LH    @6,BEG                                             0427
         LA    @A,115(@6,@7)                                      0427
         MVI   0(@A),C'('                                         0427
*                         BEG=BEG+1;    /* RESET BEGINNING OF STRING  *
         LA    @F,1                                               0428
         AH    @F,BEG                                             0428
         STH   @F,BEG                                             0428
         BC    15,@9A2                                            0430
*                         END;
*                    ELSE PTR1=ADDR(LDSIZESF);
@9A3     L     @1,PDLPTR                                          0430
         LA    @F,128(0,@1)                                       0430
         ST    @F,MSGPARM+96                                      0430
*                                       /* GET ADDRESS OF PDE OY00686 *
*                 END;
@9A2     EQU   *                                                  0431
*         IF I=2                        /* EP SPECIFIED?      OY00686 *
*            THEN IF LKLD='LOAD'        /* AC SPECIFIED?       Y01018 *
@9A4     LA    @F,2                                               0432
         CH    @F,I                                               0432
         BC    07,@9A1                                            0432
*                 THEN PTR1=ADDR(LDEPSF);
         L     @1,BASE                                            0433
         CLC   276(4,@1),@C6                                      0433
         BC    07,@9A0                                            0433
         L     @3,PDLPTR                                          0434
         LA    @F,136(0,@3)                                       0434
         ST    @F,MSGPARM+96                                      0434
         BC    15,@99F                                            0435
*                                       /* GET ADDR OF STR    OY00686 *
*                 ELSE PTR1=ADDR(LKACSF);
@9A0     L     @3,PDLPTR                                          0435
         LA    @F,192(0,@3)                                       0435
         ST    @F,MSGPARM+96                                      0435
*                                       /* GET ADDR OF STR     Y01018 *
*            ELSE;
@9A1     EQU   *                                                  0436
*         IF I=3           /* NAME OR DCBS SPECIFIED? OY00686,OZ01255 *
*           THEN IF LKLD='LOAD'         /* SEPARATE BY CMD    OZ01255 *
@99E     LA    @F,3                                               0437
         CH    @F,I                                               0437
         BC    07,@99D                                            0437
*            THEN PTR1=ADDR(LDNAMESF);  /* GET ADDR OF STR    OY00686 *
         L     @1,BASE                                            0438
         CLC   276(4,@1),@C6                                      0438
         BC    07,@99C                                            0438
         L     @3,PDLPTR                                          0439
         LA    @F,144(0,@3)                                       0439
         ST    @F,MSGPARM+96                                      0439
*            ELSE GO TO COMM;           /* TAKE DCBS  OZ01255,OZ02521 *
* INS:    ENDD=BEG+STRL-1;              /* GET END OF STRING          *
@99B     EQU   *                                                  0441
@99D     EQU   *                                                  0441
INS      LH    @F,@D11                                            0441
         L     @1,MSGPARM+96       MSGPARM                        0441
         AH    @F,4(0,@1)                                         0441
         AH    @F,BEG                                             0441
         STH   @F,ENDD                                            0441
*         OPLIST(BEG:ENDD)=STR->CHARST(1:STRL);  /* MOVE PARAMETER    *
         L     @3,MSGPARM+96       MSGPARM                        0442
         L     @3,0(0,@3)          STRING                         0442
         LR    @E,@3                                              0442
         LR    @6,@F                                              0442
         LH    @7,BEG                                             0442
         SR    @6,@7                                              0442
         L     @4,BASE                                            0442
         LA    @A,115(@7,@4)                                      0442
         EX    @6,@MVC                                            0442
*         BEG=ENDD+1;                   /* RESET BEGINNING OF STRING  *
         LA    @F,1                                               0443
         AH    @F,ENDD                                            0443
         STH   @F,BEG                                             0443
*         IF I=1 & LKLD='LINK'          /* SIZE FOR LINK. ED.?        *
*            THEN DO;                   /* YES - ADD PAREN.           *
         LA    @F,1                                               0444
         CH    @F,I                                               0444
         BC    07,@99A                                            0444
         CLC   276(4,@4),@C4                                      0444
         BC    07,@999                                            0444
*                 IF NSTRNG^='FF000000'X /* ANOTHER ITEM?             *
*                    THEN DO;
         L     @F,@X31                                            0446
         C     @F,8(0,@1)                                         0446
         BC    08,@998                                            0446
*                         OPLIST(BEG)=','; /* ADD COMMA               *
         LH    @5,BEG                                             0448
         LA    @A,115(@5,@4)                                      0448
         MVI   0(@A),C','                                         0448
*                         BEG=BEG+1;
         LA    @F,1                                               0449
         AH    @F,BEG                                             0449
         STH   @F,BEG                                             0449
*                         PTR1=NSTRNG;
         MVC   MSGPARM+96(4),8(@1)                                0450
*                         GO TO INS;
         BC    15,INS                                             0451
*                         END;
*                 OPLIST(BEG)=')';
@998     LH    @1,BEG                                             0453
         L     @3,BASE                                            0453
         LA    @A,115(@1,@3)                                      0453
         MVI   0(@A),C')'                                         0453
*                 BEG=BEG+1;            /* RESET BEGINNING OF STRING  *
         LA    @F,1                                               0454
         AH    @F,BEG                                             0454
         STH   @F,BEG                                             0454
*                 END;
* COMM:   OPLIST(BEG)=',';              /* ADD COMMA AFTER OPTION     *
@999     EQU   *                                                  0456
@99A     EQU   *                                                  0456
COMM     LH    @1,BEG                                             0456
         L     @3,BASE                                            0456
         LA    @A,115(@1,@3)                                      0456
         MVI   0(@A),C','                                         0456
*         BEG=BEG+1;
         LA    @F,1                                               0457
         AH    @F,BEG                                             0457
         STH   @F,BEG                                             0457
* EL1:    END;                          /* END OF OPTION LOOP         *
*         IF LKLD='LOAD'                /* LOADER TO BE INVOKED?      *
*            THEN DO;                   /* YES - SEE IF PROG. PARMS.  *
EL1      LH    @F,J                                               0458
         AH    @F,@D3                                             0458
@DO9AA   STH   @F,J                                               0458
         CH    @F,K                                               0458
         BC    12,@DO9AB                                          0458
         L     @1,BASE                                            0459
         CLC   276(4,@1),@C6                                      0459
         BC    07,@997                                            0459
*                 PTR1=ADDR(LDPARAM);   /* GET ADDR OF PARAM  OY00686 *
         L     @3,PDLPTR                                          0461
         LA    @F,36(0,@3)                                        0461
         ST    @F,MSGPARM+96                                      0461
*                 IF STRF(1)='0'B      /* PARM PRESENT OR    ZA01419 *
*                    STRL=0             /* PARM NULL          ZA01419 *
*                    THEN GO TO EL2;    /* NO - CONTINUE              *
         LR    @6,@F               MSGPARM                        0462
         TM    6(@6),B'10000000'                                  0462
         BC    08,@996                                            0462
         SR    @F,@F                                              0462
         CH    @F,4(0,@6)                                         0462
         BC    08,EL2                                             0463
*                 BEG=BEG-1;            /* REMOVE COMMA               *
@995     LH    @F,BEG                                             0464
         BCTR  @F,0                                               0464
         STH   @F,BEG                                             0464
*                 OPLIST(BEG)='/';      /* ADD SLASH BEFORE PARMS.    *
         LR    @1,@F                                              0465
         L     @3,BASE                                            0465
         LA    @A,115(@1,@3)                                      0465
         MVI   0(@A),C'/'                                         0465
*                 IF STRL>100           /* IS PARM FIELD > 100?       *
*                   THEN DO;            /* YES -                      *
         LA    @F,100                                             0466
         L     @6,MSGPARM+96       MSGPARM                        0466
         CH    @F,4(0,@6)                                         0466
         BC    10,@994                                            0466
*                        STRL=100;      /* TRUNCATE PARM FIELD TO 100 *
         STH   @F,4(0,@6)                                         0468
*                        CALL AKJLKMSG(LSTPTR,33); /* TO GIVE WARNING
*                                                     MESSAGE         *
         LA    @F,LSTPTR                                          0469
         ST    @F,@PL001                                          0469
         LA    @F,@D12                                            0469
         ST    @F,@PL001+4                                        0469
         L     @F,@V1              ADDRESS OF AKJLKMSG            0469
         LA    @1,@PL001                                          0469
         BALR  @E,@F                                              0469
*                        END;
*                 ENDD=BEG+STRL;        /* GET END OF STRING          *
@994     L     @1,MSGPARM+96       MSGPARM                        0471
         LH    @F,4(0,@1)                                         0471
         AH    @F,BEG                                             0471
         STH   @F,ENDD                                            0471
*                 OPLIST(BEG+1:ENDD)=STR->CHARST(1:STRL); /* MOVE IN  *
         L     @3,MSGPARM+96       MSGPARM                        0472
         L     @3,0(0,@3)          STRING                         0472
         LR    @E,@3                                              0472
         LR    @6,@F                                              0472
         LA    @7,1                                               0472
         AH    @7,BEG                                             0472
         SR    @6,@7                                              0472
         L     @4,BASE                                            0472
         LA    @A,115(@7,@4)                                      0472
         EX    @6,@MVC                                            0472
*                 BEG=ENDD+2;           /* RESET BEGINNING OF STRING  *
         LA    @F,2                                               0473
         AH    @F,ENDD                                            0473
         STH   @F,BEG                                             0473
*                 END;
* EL2:    OPLEN=BEG-2;                  /* SET LENGTH OF OPTION LIST  *
@997     EQU   *                                                  0475
EL2      LH    @F,BEG                                             0475
         SH    @F,@D1                                             0475
         L     @1,BASE                                            0475
         STH   @F,114(0,@1)                                       0475
*         IF BEG=1                      /* NO  PARAMETERS?            *
*           THEN OPLEN=0;
         LA    @F,1                                               0476
         CH    @F,BEG                                             0476
         BC    07,@991                                            0476
         SR    @F,@F                                              0477
         STH   @F,114(0,@1)                                       0477
*         OPLIST(OPLEN+1)=' ';          /* REMOVE TRAILING COMMA      *
@991     LA    @3,1                                               0478
         AH    @3,114(0,@1)                                       0478
         LA    @A,115(@3,@1)                                      0478
         MVI   0(@A),C' '                                         0478
* FINIS:  GEN(DELETE EP=IKJDAIR);       /* DELETE DAIR                *
FINIS    DELETE EP=IKJDAIR
         DS    0H
*         /* ******************************************************** *
*         /* XCTL TO MODULE IKJLKL02                                  *
*         /* ******************************************************** *
*         IF ERRCODE > 0                /* ERROR DETECTED?            *
*            THEN LKLD='    ';          /* YES - SET NO LINK REQUIRED *
         SR    @F,@F                                              0480
         CH    @F,MSGPARM+8                                       0480
         BC    10,@990                                            0480
         L     @1,BASE                                            0481
         MVC   276(4,@1),@C38                                     0481
*         RESTRICT (3);                 /*                    OY00691 *
*         R3=ADDR(OUTPARM);             /* SAVE PARM. ADDRESS FOR XCTL*
@990     L     @1,BASE                                            0483
         LA    @3,276(0,@1)                                       0483
*         GEN;                          /* FREE DYNAMIC AREA AND XCTL *
         L     @D,4(@D)                RESTORE SAVE AREA PTR.
         LR    @1,@C                   GET ADDRESS OF DYN. AREA
         L     @0,@SIZ001              GET LENGTH OF AREA
         FREEMAIN R,LV=(0),A=(1)
         LR    @1,@3                   RESTORE PARM. PTR. TO REG. 1
         XCTL  (2,12),EP=AKJLKL02,MF=(E,(1))
         DS    0H
*         GENERATE;
LKPARSE  IKJPARM DSECT=LKPARMD
LK1      IKJPOSIT DSTHING,LIST,PROMPT='INPUT DATA SET(S)',VALIDCK=INCHK
LK2      IKJKEYWD
         IKJNAME    'LOAD',SUBFLD=LKSFLOAD
LK3      IKJKEYWD
         IKJNAME    'LIB',SUBFLD=LKSFLIBR
LK4      IKJKEYWD
         IKJNAME    'PLILIB'
LK5      IKJKEYWD
         IKJNAME    'FORTLIB'
LK6      IKJKEYWD
         IKJNAME    'COBLIB'
LK7      IKJKEYWD
         IKJNAME    'PLIBASE'
LK8      IKJKEYWD
         IKJNAME    'PLICMIX'
LK9      IKJKEYWD
         IKJNAME    'PL1LIB'
LK10     IKJKEYWD
         IKJNAME    'SIZE',SUBFLD=LKSFSIZE
LK101    IKJKEYWD
         IKJNAME    'AC',SUBFLD=LKSFAC                          Y01018
LK11     IKJKEYWD
         IKJNAME    'DCBS',SUBFLD=LKSFDCBS
LK12     IKJKEYWD
         IKJNAME    'PRINT',SUBFLD=LKSFPRNT
         IKJNAME    'NOPRINT'
LK13     IKJKEYWD
         IKJNAME    'MAP'
         IKJNAME    'NOMAP'
LK14     IKJKEYWD
         IKJNAME    'XREF'
         IKJNAME    'NOXREF'
LK15     IKJKEYWD
         IKJNAME    'LIST'
         IKJNAME    'NOLIST'
LK16     IKJKEYWD
         IKJNAME    'LET'
         IKJNAME    'NOLET'
LK17     IKJKEYWD
         IKJNAME    'XCAL'
         IKJNAME    'NOXCAL'
LK18     IKJKEYWD
         IKJNAME    'SCTR'
         IKJNAME    'NOSCTR'
LK19     IKJKEYWD
         IKJNAME    'OVLY'
         IKJNAME    'NOOVLY'
LK20     IKJKEYWD
         IKJNAME    'RENT'
         IKJNAME    'NORENT'
LK21     IKJKEYWD
         IKJNAME    'REUS'
         IKJNAME    'NOREUS'
LK22     IKJKEYWD
         IKJNAME    'REFR'
         IKJNAME    'NOREFR'
LK23     IKJKEYWD
         IKJNAME    'NE'
         IKJNAME    'NONE'
LK24     IKJKEYWD
         IKJNAME    'OL'
         IKJNAME    'NOOL'
LK25     IKJKEYWD
         IKJNAME    'DC'
         IKJNAME    'NODC'
LK26     IKJKEYWD
         IKJNAME    'TEST'
         IKJNAME    'NOTEST'
LK27     IKJKEYWD
         IKJNAME    'HIAR'
         IKJNAME    'NOHIAR'
LK28     IKJKEYWD   DEFAULT='TERM'
         IKJNAME    'TERM'
         IKJNAME    'NOTERM'
LK29     IKJKEYWD
         IKJNAME    'NCAL'
         IKJNAME    'NONCAL'
LK291    IKJKEYWD
         IKJNAME    'ALIGN2'                                    Y01018
         IKJNAME    'NOALIGN2'                                  Y01018
LKSFLOAD IKJSUBF
LK30     IKJPOSIT   DSNAME
LKSFPRNT IKJSUBF
LK31     IKJPOSIT   DSTHING
LKSFLIBR IKJSUBF
LK32     IKJPOSIT   DSNAME,LIST
LKSFSIZE IKJSUBF
LK33     IKJIDENT   'SIZE PARAMETER',LIST,FIRST=NUMERIC,               X
               OTHER=ALPHANUM,PROMPT='SIZE PARAMETER'
LKSFDCBS IKJSUBF
LK34     IKJIDENT  'BLOCKSIZE',FIRST=NUMERIC,OTHER=NUMERIC,MAXLNTH=5,  X
               PROMPT='LOAD MODULE BLOCKSIZE'
LKSFAC   IKJSUBF
LK35     IKJIDENT   'APF CODE',FIRST=NUMERIC,OTHER=NUMERIC,    Y01018  X
               PROMPT='AUTHORIZATION CODE',MAXLNTH=3           Y01018
         IKJENDP
LDPARSE  IKJPARM   DSECT=LDPARMD
LD1      IKJPOSIT DSTHING,LIST,PROMPT='INPUT DATA SET(S)',VALIDCK=INCHK
LD2      IKJPOSIT   QSTRING
LD3      IKJKEYWD
         IKJNAME    'LIB',SUBFLD=LDSFLIBR
LD4      IKJKEYWD
         IKJNAME    'PLILIB'
LD5      IKJKEYWD
         IKJNAME    'FORTLIB'
LD6      IKJKEYWD
         IKJNAME    'COBLIB'
LD7      IKJKEYWD
         IKJNAME    'PLIBASE'
LD8      IKJKEYWD
         IKJNAME    'PLICMIX'
LD9      IKJKEYWD
         IKJNAME    'PL1LIB'
LD10     IKJKEYWD
         IKJNAME    'SIZE',SUBFLD=LDSFSIZE
LD11     IKJKEYWD
         IKJNAME    'EP',SUBFLD=LDSFEP
LD12     IKJKEYWD
         IKJNAME    'NAME',SUBFLD=LDSFNAME
LD13     IKJKEYWD
         IKJNAME    'PRINT',SUBFLD=LDSFPRNT
         IKJNAME    'NOPRINT'
LD14     IKJKEYWD   DEFAULT='NOMAP'
         IKJNAME    'MAP'
         IKJNAME    'NOMAP'
LD15     IKJKEYWD   DEFAULT='NOLET'
         IKJNAME    'LET'
         IKJNAME    'NOLET'
LD16     IKJKEYWD   DEFAULT='TERM'
         IKJNAME    'TERM'
         IKJNAME    'NOTERM'
LD17     IKJKEYWD    DEFAULT='RES'
         IKJNAME    'RES'
         IKJNAME    'NORES'
LD18     IKJKEYWD    DEFAULT='CALL'
         IKJNAME    'CALL'
         IKJNAME    'NOCALL'
LDSFPRNT IKJSUBF
LD19     IKJPOSIT   DSTHING
LDSFLIBR IKJSUBF
LD20     IKJPOSIT   DSNAME,LIST
LDSFSIZE IKJSUBF
LD21     IKJIDENT   'SIZE PARAMETER',FIRST=NUMERIC,                    X
               OTHER=ALPHANUM,PROMPT='SIZE PARAMETER'
LDSFEP   IKJSUBF
LD22     IKJIDENT   'ENTRY POINT NAME',FIRST=ALPHA,OTHER=ALPHANUM,     X
               PROMPT='ENTRY POINT NAME',MAXLNTH=8
LDSFNAME IKJSUBF
LD23     IKJIDENT   'PROGRAM NAME',FIRST=ALPHA,OTHER=ALPHANUM,         X
               PROMPT='PROGRAM NAME',MAXLNTH=8
         IKJENDP
         DS    0H
* /* **************************************************************** *
* /*                                                                  *
* /* THIS PROCEDURE IS ENTERED FROM PARSE ONE TIME FOR EACH INPUT     *
* /* DATA SET.  ON ENTRY, REGISTER 1 POINTS TO THE STRUCTURE DEFINED  *
* /* BY PARML.  THE DATA SET BEING PROCESSED IS DESCRIBED BY THE      *
* /* STRUCTURE NAMED DATASET.  IF THE DATA SET NAME IS '*', THIS      *
* /* ROUTINE WILL CREATE A DATA SET FOR LINKAGE EDITOR CONTROL        *
* /* STATEMENTS WHICH THE USER ENTERS FROM THE TERMINAL.  ON RETURN   *
* /* TO PARSE REGISTER 15 WILL CONTAIN 0 IF NO ERROR OCCURRED, 8 IF   *
* /* AN ERROR OCCURRED AND THE USER CAN REENTER THE DATA SET NAME, OR *
* /* 12 IF AN UNRECOVERABLE ERROR OCCURRED.                           *
* /*                                                                  *
* /* **************************************************************** *
* INCHK:  PROC OPTIONS(NOSAVEAREA,DONTSAVE(15));
@EL01    L     @D,4(0,@D)                                         0486
         LR    @1,@C                                              0486
         L     @0,@SIZ001                                         0486
         FREEMAIN R,LV=(0),A=(1)                                  0486
         LM    @E,@C,12(@D)                                       0486
         BCR   15,@E                                              0486
INCHK    ST    @E,12(0,@D)                                        0486
         STM   @0,@C,20(@D)                                       0486
*         /* ******************************************************** *
*         /* MAPS                                                     *
*         /* ******************************************************** *
*         DCL   1 PARML BASED(R1),
*                 2 PDE PTR,            /* PTR. TO DESCPT. OF DATA SET*
*                 2 USERAREA PTR;       /* PTR. TO BASE & DATA REG.   *
*                                       /* CONTENTS                   *
*         DCL FPTR POINTER BASED(R13+8);
*         /* ******************************************************** *
*         /* DATA IN GETMAIN SPACE                                    *
*         /* ******************************************************** *
*         DCL SAVEAR(18) FIXED(31);     /* LOCAL SAVE AREA            *
*         DCL Q04(2) FIXED(15);         /* CODE FOR QUALIFIERS        *
*         RESTRICT(1,2,3);
*         /* ******************************************************** *
*         /* ESTABLISH ADDRESSABILITY                                 *
*         /* ******************************************************** *
*         R8=USERAREA->BASEREG(1);    /* RESTORE 1ST BASE REG. ZA02180*
         L     @6,4(0,@1)          
         L     @8,0(0,@6)                                         0492
*         R9=USERAREA->BASEREG(2);    /* RESTORE 2ND BASE REG. ZA02180*
         L     @9,4(0,@6)                                         0493
*         R11=USERAREA->BASEREG(3);   /* RESTORE 3RD BASE REG. ZA02180*
         L     @B,8(0,@6)                                         0494
*         R12=USERAREA->DATAREG;
         L     @C,12(0,@6)                                        0495
*         /* ******************************************************** *
*         /* DO SAVE AREA CHAINING                                    *
*         /* ******************************************************** *
*         SAVEAR(2)=R13;                /* SAVE BACKWARD POINTER      *
         ST    @D,SAVEAR+4                                        0496
*         FPTR=ADDR(SAVEAR);            /* SAVE FORWARD POINTER IN    *
         LA    @F,SAVEAR                                          0497
         ST    @F,8(0,@D)                                         0497
*                                       /* CALLING ROUTINE            *
*         R13=ADDR(SAVEAR);             /* PUT SAVEAREA ADD.IN REG.13 *
         LA    @D,SAVEAR                                          0498
*         PTR1=PDE;                     /* SET POINTER TO DESCRIPTOR  *
         MVC   MSGPARM+96(4),0(@1)                                0499
*                                       /* ELEMENT                    *
*         IF DSL=1 & DSN->CHARST(1)='*' /* CONTROL STMTS. REQUESTED   *
*            THEN DO;
         LA    @F,1                                               0500
         L     @7,MSGPARM+96       MSGPARM                        0500
         CH    @F,4(0,@7)                                         0500
         BC    07,@98F                                            0500
         L     @4,MSGPARM+96       MSGPARM                        0500
         L     @4,0(0,@4)          DATASET                        0500
         CLI   0(@4),C'*'                                         0500
         BC    07,@98E                                            0500
*                 /* ************************************************ *
*                 /* CREATE DATA SET WITH L.E. CONTROL STATEMENTS     *
*                 /* ************************************************ *
*                 DSPTR=ADDR(NM(1));    /* SET POINTER TO DSNAME      *
         LA    @F,NM                                              0502
         ST    @F,MSGPARM+92                                      0502
*                 DSNM=CSNAME;          /* SET DATA SET NAME          *
         LR    @5,@F               MSGPARM                        0503
         MVC   2(4,@5),CSNAME                                     0503
         MVI   6(@5),C' '                                         0503
         MVC   7(39,@5),6(@5)                                     0503
*                 CSNAME=CSNAME+1;      /* PREPARE NEXT L.E. CON. NAME*
         LA    @F,1                                               0504
         A     @F,CSNAME                                          0504
         ST    @F,CSNAME                                          0504
*                 DSNLNGTH=7;           /* SET LENGTH OF NAME         *
         LA    @F,7                                               0505
         STH   @F,0(0,@5)                                         0505
*                 CALL ALLOCDS('INPT','UTIL');  /* ALLOCATE DATA SET  *
         LA    @F,@C39                                            0506
         ST    @F,@PL002                                          0506
         LA    @F,@C29                                            0506
         ST    @F,@PL002+4                                        0506
         LA    @1,@PL002                                          0506
         BAL   @E,ALLOCDS                                         0506
*                 IF ERRCODE > 0        /* ERROR IN ALLOCATION?       *
*                    THEN GO TO ERR;    /* YES - CHECK WHAT KIND      *
         SR    @F,@F                                              0507
         CH    @F,MSGPARM+8                                       0507
         BC    04,ERR                                             0508
*                 R3=ADDR(INDCB);       /* SET REG. FOR DCBD          *
         LA    @3,INDCB                                           0509
*                 GEN;
                 USING IHADCB,R3
                 MVC   IHADCB(DCBSIZ2),CST  /* MOVE IN DCB INFO.     */
         DS    0H
*                 DAPB0PTR=ADDR(DAIR08);
         LA    @F,DAIR08                                          0511
         ST    @F,MSGPARM                                         0511
*                 DCBDDNAM=DA08DDN;     /* MOVE IN DDNAME             *
         LR    @6,@F                                              0512
         MVC   DCBDDNAM(8),12(@6)                                 0512
*                 OPTBYT='8F'X;         /* SET OUTPUT FLAG            *
         MVI   DMLIST,X'8F'                                       0513
*                 R1=ADDR(DMLIST);      /* SET PTR. TO REMOTE LIST    *
         LA    @1,DMLIST                                          0514
*                 GEN;                  /* OPEN AND TEST FOR SUCCESS  *
                 OPEN  ((3)),MF=(E,(1))
                 TM    DCBOFLGS,X'10'  CORRECT OPEN?
                 BO    GETS            YES - GO GET INPUT
         DS    0H
*                 CALL AKJLKMSG(LSTPTR,12);  /* OPEN ERROR            *
         LA    @F,LSTPTR                                          0516
         ST    @F,@PL002                                          0516
         LA    @F,@D13                                            0516
         ST    @F,@PL002+4                                        0516
         L     @F,@V1              ADDRESS OF AKJLKMSG            0516
         LA    @1,@PL002                                          0516
         BALR  @E,@F                                              0516
*                 GO TO ERR;            /* RETURN TO PARSE            *
         BC    15,ERR                                             0517
* GETS:
*                 CALL AKJLKMSG(LSTPTR,13);/* ENTER CONTROL STATMENTS *
GETS     LA    @F,LSTPTR                                          0518
         ST    @F,@PL002                                          0518
         LA    @F,@D14                                            0518
         ST    @F,@PL002+4                                        0518
         L     @F,@V1              ADDRESS OF AKJLKMSG            0518
         LA    @1,@PL002                                          0518
         BALR  @E,@F                                              0518
* LP1:            IF ERRCODE > 0  BUFLN=0  /* ERROR OR NO INPUT?     *
*                    THEN GO TO CLS;    /* CLOSE DARA SET AND END     *
LP1      SR    @F,@F                                              0519
         CH    @F,MSGPARM+8                                       0519
         BC    04,@987                                            0519
         CH    @F,MSGPARM+10                                      0519
         BC    08,CLS                                             0520
*                 IF BUFLN > 70         /* CHECK FOR MAX OF 70        *
*                                       /* CHARS/LINE                 *
*                    THEN DO;
@986     LA    @F,70                                              0521
         CH    @F,MSGPARM+10                                      0521
         BC    10,@985                                            0521
*                         CALL AKJLKMSG(LSTPTR,14); /* PRINT ERROR MSG*
         LA    @F,LSTPTR                                          0523
         ST    @F,@PL002                                          0523
         LA    @F,@D15                                            0523
         ST    @F,@PL002+4                                        0523
         L     @F,@V1              ADDRESS OF AKJLKMSG            0523
         LA    @1,@PL002                                          0523
         BALR  @E,@F                                              0523
*                                       /* TO CHECK                   *
*                         GO TO LP1;    /* SYNTAX OF CORRECTED        *
         BC    15,LP1                                             0524
*                                       /* CONTROL STATEMENT          *
*                         END;
*                 DO I = 2 TO BUFLN;    /* FIND FIRST NON-BLANK CHAR  *
@985     LA    @F,2                                               0526
         BC    15,@DO981                                          0526
*                 IF INBUF(I) ^= BLANKS(1) /* IF FIND NON-BLANK       *
*                    THEN GO TO CNTRLCK; /* BRANCH TO CHECK FOR       *
@DO982   LH    @6,I                                               0527
         LA    @A,MSGPARM+11(@6)                                  0527
         CLC   0(1,@A),BLANKS                                     0527
         BC    07,CNTRLCK                                         0528
*                                       /* VALID CONTROL STATEMENT    *
*                 END;
*                 GO TO NXTGET;         /* ALL BLANKS, GET NEXT STMT  *
         LH    @F,I                                               0529
         AH    @F,@D3                                             0529
@DO981   STH   @F,I                                               0529
         CH    @F,MSGPARM+10                                      0529
         BC    12,@DO982                                          0529
         BC    15,NXTGET                                          0530
* CNTRLCK:        DO J=1 TO 15;         /* CHECK FOR VALID      S21016
*                                          CONTROL STATEMENT          *
CNTRLCK  LA    @F,1                                               0531
         STH   @F,J                                               0531
*                 CHAREND = NCHAR(J);   /*LNGTH OF CNTRL STMT IN ARRAY*
@DO97E   LH    @6,J                                               0532
         SLA   @6,1                                               0532
         LH    @F,NCHAR-2(@6)                                     0532
         STH   @F,CHAREND                                         0532
*                 IF INBUF(I:I+CHAREND-1) = CARDS(J,1:CHAREND)
*                    THEN GO TO RITEDAT; /* MATCH - CONTINUE          *
         LH    @7,J                                               0533
         MH    @7,@D16                                            0533
         LA    @E,CARDS-9(@7)                                     0533
         LH    @4,@D11                                            0533
         AH    @4,CHAREND                                         0533
         AH    @4,I                                               0533
         LH    @5,I                                               0533
         SR    @4,@5                                              0533
         LA    @A,MSGPARM+11(@5)                                  0533
         EX    @4,@CLC                                            0533
         BC    08,RITEDAT                                         0534
*                 END;
*                 CALL AKJLKMSG(LSTPTR,15); /* PRINT ERROR MESSAGE:   *
         LH    @F,J                                               0535
         AH    @F,@D3                                             0535
@DO97D   STH   @F,J                                               0535
         CH    @F,@D17                                            0535
         BC    12,@DO97E                                          0535
         LA    @F,LSTPTR                                          0536
         ST    @F,@PL002                                          0536
         LA    @F,@D18                                            0536
         ST    @F,@PL002+4                                        0536
         L     @F,@V1              ADDRESS OF AKJLKMSG            0536
         LA    @1,@PL002                                          0536
         BALR  @E,@F                                              0536
*                 GO TO LP1;            /* RETURN TO CHECK CORRECTED  *
         BC    15,LP1                                             0537
*                                       /* CONTROL STATEMENT          *
* RITEDAT:        GEN(PUT INDCB,INBUF); /* WRITE TO DATA SET          *
RITEDAT  PUT INDCB,INBUF
         DS    0H
* NXTGET:         CALL AKJLKMSG(LSTPTR,0); /* GET NEXT STATEMENT      *
NXTGET   LA    @F,LSTPTR                                          0539
         ST    @F,@PL002                                          0539
         LA    @F,@D5                                             0539
         ST    @F,@PL002+4                                        0539
         L     @F,@V1              ADDRESS OF AKJLKMSG            0539
         LA    @1,@PL002                                          0539
         BALR  @E,@F                                              0539
*                 GO TO LP1;            /* CONTINUE                   *
         BC    15,LP1                                             0540
* SYNADD:         CALL AKJLKMSG(LSTPTR,11);  /* I/O ERROR             *
SYNADD   LA    @F,LSTPTR                                          0541
         ST    @F,@PL002                                          0541
         LA    @F,@D19                                            0541
         ST    @F,@PL002+4                                        0541
         L     @F,@V1              ADDRESS OF AKJLKMSG            0541
         LA    @1,@PL002                                          0541
         BALR  @E,@F                                              0541
* CLS:
*                 R1=ADDR(DMLIST);      /* SET PTR TO REMOTE LIST     *
CLS      LA    @1,DMLIST                                          0542
*                 GEN(CLOSE ((3)),MF=(E,(1)));  /* CLOSE DATA SET     *
         CLOSE ((3)),MF=(E,(1))
         DS    0H
*                 IF BUFLN=0
*                    THEN CALL AKJLKMSG(LSTPTR,17); /* END OF STMTS.  *
         SR    @F,@F                                              0544
         CH    @F,MSGPARM+10                                      0544
         BC    07,@974                                            0544
         LA    @F,LSTPTR                                          0545
         ST    @F,@PL002                                          0545
         LA    @F,@D20                                            0545
         ST    @F,@PL002+4                                        0545
         L     @F,@V1              ADDRESS OF AKJLKMSG            0545
         LA    @1,@PL002                                          0545
         BALR  @E,@F                                              0545
*                 GO TO ERR;            /* RETURN TO PARSE            *
         BC    15,ERR                                             0546
*                 GEN;
CST      DCB   DSORG=PS,MACRF=(PM),LRECL=80,BLKSIZE=80,RECFM=F,        X
               SYNAD=SYNADD
DCBSIZ2  EQU   *-CST
         DS    0H
*                 END;
*         DAPLDAPB=ADDR(DAIR04);        /* SET PARM. BLOCK POINTER    *
@98E     EQU   *                                                  0549
@98F     LA    @F,DAIR04                                          0549
         L     @6,DAPLPTR                                         0549
         ST    @F,16(0,@6)                                        0549
*         DAPB0PTR=ADDR(DAIR04);        /* SET DSECT POINTER          *
         LA    @F,DAIR04                                          0550
         ST    @F,MSGPARM                                         0550
*         /* ******************************************************** *
*         /* IF NOT FULLY QUALIFIED, THE INPUT DATA SET MAY HAVE ONE  *
*         /* OF TWO QUALIFIERS.  CHECK TO SEE IF USER HAS SPECIFIED   *
*         /* WHICH ONE HE WANTS. IF NOT, CHECK TO SEE IF BOTH DATA    *
*         /* SETS EXIST. IF SO, PROMPT USER FOR CORRECT QUALIFIER.    *
*         /* IF BOTH DO NOT EXIST, USE ONE WHICH DOES.                *
*         /* ******************************************************** *
*         DO I=1 TO 2;                  /* CHECK EACH QUALIFIER       *
         LA    @F,1                                               0551
         STH   @F,I                                               0551
*         DSPTR=ADDR(NM(I));            /* SET DSNAME PTR. TO I-TH NM *
@DO971   LH    @6,I                                               0552
         MH    @6,@D21                                            0552
         LA    @F,NM-46(@6)                                       0552
         ST    @F,MSGPARM+92                                      0552
*         DSNLNGTH=DSL;                 /* INIT. DATA SET LENGTH      *
         L     @7,MSGPARM+96       MSGPARM                        0553
         LR    @4,@F               MSGPARM                        0553
         MVC   0(2,@4),4(@7)                                      0553
*         IF DSN^=0                     /* DATA SET NAME SPECIFIED.   *
*              THEN DSNM(1:DSL)=DSN->CHARST(1:DSL); /* MOVE IN NAME   *
         SR    @F,@F                                              0554
         C     @F,0(0,@7)                                         0554
         BC    08,@96D                                            0554
         L     @5,MSGPARM+96       MSGPARM                        0555
         L     @5,0(0,@5)          DATASET                        0555
         LR    @E,@5                                              0555
         LH    @6,4(0,@7)                                         0555
         BCTR  @6,0                                               0555
         LA    @A,2(0,@4)                                         0555
         EX    @6,@MVC                                            0555
*         IF DSF(2)='1'B                /* DATA SET FULLY QUALIFIED?  *
*            THEN GO TO ALLOC3;         /* YES - GO ALLOCATE NAME     *
@96D     L     @6,MSGPARM+96       MSGPARM                        0556
         TM    6(@6),B'01000000'                                  0556
         BC    01,ALLOC3                                          0557
*         GEN(XC DAIR04+2(14),DAIR04+2); /* ZERO X'04' BLOCK          *
         XC DAIR04+2(14),DAIR04+2
         DS    0H
*         DA04UID='1'B;                 /* PREFIX USERID              *
         L     @7,MSGPARM                                         0559
         OI    12(@7),B'00100000'                                 0559
*         Q04(I)=0;                     /* SET QUAL. I NOT SPECIFIED  *
         SR    @F,@F                                              0560
         LH    @4,I                                               0560
         SLA   @4,1                                               0560
         STH   @F,Q04-2(@4)                                       0560
*         IF I=1                        /*FIRST DEF. QUAL. TO BE TRIED*
*            THEN DO;                   /* YES - USE OBJ              *
         LA    @F,1                                               0561
         CH    @F,I                                               0561
         BC    07,@96C                                            0561
*                 LQUAL=3;              /* SET LENGTH OF QUAL.        *
         LA    @F,3                                               0563
         STH   @F,LQUAL                                           0563
*                 QUAL='OBJ     ';      /* SET QUALIFIER              *
         MVC   A00001+1(8),@C41                                   0564
         BC    15,@96B                                            0566
*                 END;
*            ELSE DO;                   /* NO - USE LOAD OR DATA      *
*                 LQUAL=4;              /* SET LENGTH OF QUALIFIER    *
@96C     LA    @F,4                                               0567
         STH   @F,LQUAL                                           0567
*                 QUAL='DATA    ';      /* SET QUAL.=DATA FOR LINK. ED*
         MVC   A00001+1(8),@C42                                   0568
*                 IF LKLD='LOAD'        /* GOING TO LOADER?           *
*                    THEN QUAL='LOAD    '; /* YES - CHANGE QUALIFIER  *
         L     @6,BASE                                            0569
         CLC   276(4,@6),@C6                                      0569
         BC    07,@96A                                            0569
         MVC   A00001+1(8),@C27                                   0570
*                 END;
@96A     EQU   *                                                  0571
*         CALL QCHECK('CADD');          /* SEE IF QUAL. ALREADY IN    *
@96B     LA    @F,@C43                                            0572
         ST    @F,@PL002                                          0572
         LA    @1,@PL002                                          0572
         BAL   @E,QCHECK                                          0572
*                                       /* NAME. IF NOT, ADD QUAL.    *
*         IF RCODE=1                    /* QUALIFIER SPEC. BY USER?   *
*            THEN GO TO ALLOC3;         /* YES - GO ALLOCATE DATA SET *
         LA    @F,1                                               0573
         CH    @F,MSGPARM+6                                       0573
         BC    08,ALLOC3                                          0574
*         DA04PDSN=DSPTR;               /* SET POINTER TO DSNAME      *
         L     @6,MSGPARM                                         0575
         MVC   8(4,@6),MSGPARM+92                                 0575
*         R1=DAPLPTR;                   /* NO - SEE IF DATA SET EXISTS*
         L     @1,DAPLPTR                                         0576
*         GEN(LINK  EP=IKJDAIR);        /* DAIR CHECKS CAT. AND DSE   *
         LINK  EP=IKJDAIR
         DS    0H
*         IF DA04CAT='1'B              /* NAME IN CATALOG?           *
*            DA04DSE='1'B               /* NAME IN DSE?               *
*            THEN Q04(I)=1;             /* SET - SET QUAL. PRESENT    *
         TM    2(@6),B'00000100'                                  0578
         BC    01,@967                                            0578
         TM    2(@6),B'00000010'                                  0578
         BC    12,@966                                            0578
@967     LA    @F,1                                               0579
         LH    @6,I                                               0579
         SLA   @6,1                                               0579
         STH   @F,Q04-2(@6)                                       0579
*         END;
*         IF Q04(1)=1 &                 /* FIRST DATA SET EXISTS?     *
*            Q04(2)=1                   /* AND SEC. DATA SET EXISTS?  *
*            THEN DO;                   /* YES - SEE WHICH ONE IS OK  *
@966     LH    @F,I                                               0580
         AH    @F,@D3                                             0580
@DO970   STH   @F,I                                               0580
         CH    @F,@D1                                             0580
         BC    12,@DO971                                          0580
         LA    @F,1                                               0581
         CH    @F,Q04                                             0581
         BC    07,@965                                            0581
         CH    @F,Q04+2                                           0581
         BC    07,@964                                            0581
*            ERR4: IF LKLD='LINK'
*                     THEN MES=22;      /* GIVE L.E. MESSAGE          *
ERR4     L     @6,BASE                                            0583
         CLC   276(4,@6),@C4                                      0583
         BC    07,@963                                            0583
         LA    @F,22                                              0584
         ST    @F,MES                                             0584
         BC    15,@962                                            0585
*                     ELSE MES=27;      /* GIVE LOADER MESSAGE        *
@963     LA    @F,27                                              0585
         ST    @F,MES                                             0585
*                 DSNLNGTH=DSL;         /* GET ORIG. LNG. FOR MESSAGE *
@962     L     @7,MSGPARM+96       MSGPARM                        0586
         L     @4,MSGPARM+92       MSGPARM                        0586
         MVC   0(2,@4),4(@7)                                      0586
*                 DSNM(DSNLNGTH+1)=' '; /* BLANK OUT '.'              *
         LA    @5,1                                               0587
         AH    @5,0(0,@4)                                         0587
         LA    @A,1(@5,@4)                                        0587
         MVI   0(@A),C' '                                         0587
*                 CALL AKJLKMSG(LSTPTR,MES); /* ISSUE MESSAGE         *
         LA    @F,LSTPTR                                          0588
         ST    @F,@PL002                                          0588
         LA    @F,MES                                             0588
         ST    @F,@PL002+4                                        0588
         L     @F,@V1              ADDRESS OF AKJLKMSG            0588
         LA    @1,@PL002                                          0588
         BALR  @E,@F                                              0588
*                 CALL AKJLKMSG(LSTPTR,23);  /* PROMPT FOR REPLY      *
         LA    @F,LSTPTR                                          0589
         ST    @F,@PL002                                          0589
         LA    @F,@D22                                            0589
         ST    @F,@PL002+4                                        0589
         L     @F,@V1              ADDRESS OF AKJLKMSG            0589
         LA    @1,@PL002                                          0589
         BALR  @E,@F                                              0589
*                 IF ERRCODE > 0        /* NO RETURN FROM PUT-GET?    *
*                    THEN GOTO ERR;
         SR    @F,@F                                              0590
         CH    @F,MSGPARM+8                                       0590
         BC    04,ERR                                             0591
*                 IF INBUF(2:4)='OBJ'   /* RESPONSE WAS OBJ?          *
*                    THEN GO TO ALLOC3A; /* YES - ALLOCATE IT         *
         CLC   MSGPARM+13(3),@C41                                 0592
         BC    08,ALLOC3A                                         0593
*                 IF INBUF(2:5)=QUAL(1:4)  /* RESPONSE LOAD OR DATA?  *
*                    THEN GO TO ALLOC3; /* YES - GO ALLOCATE IT.      *
         CLC   MSGPARM+13(4),A00001+1                             0594
         BC    08,ALLOC3                                          0595
*                 GO TO ERR4;           /* ANS. NO GOOD - ASK AGAIN.  *
         BC    15,ERR4                                            0596
*                 END;
*         IF Q04(2)=1                   /* LOAD OR DATA DSNAME NEEDED?*
*            THEN GO TO ALLOC3;         /* YES - GO ALLOCATE IT.      *
@964     EQU   *                                                  0598
@965     LA    @F,1                                               0598
         CH    @F,Q04+2                                           0598
         BC    08,ALLOC3                                          0599
* ALLOC3A: DSPTR=ADDR(NM(1));           /* SET PTR. TO NAME WITH OBJ. *
ALLOC3A  LA    @F,NM                                              0600
         ST    @F,MSGPARM+92                                      0600
*         LQUAL=3;                      /* RESET LENGTH OF QUAL.      *
         LA    @F,3                                               0601
         STH   @F,LQUAL                                           0601
*         QUAL='OBJ     ';              /* RESET QUALIFIER            *
         MVC   A00001+1(8),@C41                                   0602
* ALLOC3: CALL ALLOCDS('INPT','NODF');  /* ALLOCATE DATA SET - NO DEF.*
ALLOC3   LA    @F,@C39                                            0603
         ST    @F,@PL002                                          0603
         LA    @F,@C26                                            0603
         ST    @F,@PL002+4                                        0603
         LA    @1,@PL002                                          0603
         BAL   @E,ALLOCDS                                         0603
* ERR:    IF ERRCODE=0                  /* NO ERROR?                  *
*            THEN R15=0;                /* YES - PARSE WILL CONTINUE  *
ERR      SR    @F,@F                                              0604
         CH    @F,MSGPARM+8                                       0604
         BC    08,@95A                                            0606
*            ELSE IF ERRCODE=1          /* NO - PROMTP MESSAGE?       *
*                    THEN R15=8;        /* YES - PARSE PROMPTS        *
@95B     LA    @F,1                                               0606
         CH    @F,MSGPARM+8                                       0606
         BC    07,@959                                            0606
         LA    @F,8                                               0607
         BC    15,@958                                            0608
*                    ELSE R15=12;       /* NO - PARSE ENDS            *
@959     LA    @F,12                                              0608
*         R13=SAVEAR(2);                /* GET SAVE AREA OF CALLER    *
@958     EQU   *                                                  0609
@95A     L     @D,SAVEAR+4                                        0609
*         END INCHK;
@EL02    L     @E,12(0,@D)                                        0610
         LM    @0,@C,20(@D)                                       0610
         BCR   15,@E                                              0610
* /* **************************************************************** *
* /*                                                                  *
* /* THIS ROUTINE IS USED TO CHECK THE DESCRIPTIVE QUALIFIER FOR A    *
* /* DATA SET.  IT MAY ALSO ADD OR REMOVE THIS QUALIFIER.  ON ENTRY,  *
* /* THE PARAMETER 'TYPE' TELLS WHETHER TO ADD THE QUALIFIER IF NOT   *
* /* ALREADY PRESENT, UNCONDITIONALLY ADD THE QUALIFIER, OR REMOVE THE*
* /* QUALIFIER IF PRESENT.  ALSO ON ENTRY, THE FOLLOWING DATA ITEMS   *
* /* MUST BE SET:                                                     *
* /*    DSPTR - POINTS TO THE DATA SET NAME.                          *
* /*    QUAL  - CONTAINS DESCRIPTIVE QUALIFIER.                       *
* /*    LQUAL - CONTAINS THE LENGTH OF THE QUALIFIER.                 *
* /* BEFORE EXIT, THE DATA ITEM RCODE IS SET TO 0 IF THE DATA SET     *
* /* NAME DID NOT CONTAIN THE QUALIFIER, AND IT IS SET TO 1 IF THE    *
* /* DATA SET NAME DID CONTAIN THE QUALIFIER.                         *
* /*                                                                  *
* /* **************************************************************** *
* QCHECK: PROC(TYPE) OPTIONS(NOSAVEAREA);
QCHECK   STM   @E,@C,12(@D)                                       0611
*         /* ******************************************************** *
*         /* DATA IN GETMAIN SPACE                                    *
*         /* ******************************************************** *
*         DCL TYPE CHAR(4),             /* TELLS WHETHER TO COND. ADD *
*                                       /* QUALIFIER(CADD), UNCOND.   *
*                                       /* ADD QUALIFIER(UADD), OR    *
*                                       /* REMOVE QUALIFIER FOR       *
*                                       /* DEFAULT DSNAME(SUBT).      *
*             LNG FIXED(15),            /* LENGTH OF ADDED QUAL.      *
*             PTR POINTER;              /* PTR. TO BEG. OF ADDED QUAL.*
*         RCODE=0;
         SR    @F,@F                                              0613
         STH   @F,MSGPARM+6                                       0613
*         LNG=LQUAL+1;                  /* ADD ONE TO LENGTH FOR '.'  *
         LA    @F,1                                               0614
         AH    @F,LQUAL                                           0614
         STH   @F,LNG                                             0614
*         PTR=ADDR(DOT);                /* SET POINTER                *
         LA    @F,A00001                                          0615
         ST    @F,PTR                                             0615
*         IF TYPE='UADD'                /* UNCONDITIONALLY ADD QUAL?  *
*            THEN GO TO ADD;            /* YES - DO IT                *
         L     @6,0(0,@1)          ADDRESS OF TYPE                0616
         CLC   0(4,@6),@C44                                       0616
         BC    08,ADD                                             0617
*         N=DSNLNGTH-LNG+1;             /* CALC. BEGINNING OF QUAL.   *
         LA    @F,1                                               0618
         SH    @F,LNG                                             0618
         L     @7,MSGPARM+92       MSGPARM                        0618
         AH    @F,0(0,@7)                                         0618
         STH   @F,N                                               0618
*         IF N>1                        /* CAN THERE BE A QUAL.?      *
*            THEN IF DSNM(N:DSNLNGTH)=PTR->CHARST(1:LNG)  /* PRESENT? *
         LA    @F,1                                               0619
         CH    @F,N                                               0619
         BC    10,@957                                            0619
*                 THEN RCODE=1;         /* YES  - SET CODE            *
         L     @4,PTR                                             0620
         LR    @E,@4                                              0620
         LH    @5,0(0,@7)                                         0620
         LH    @2,N                                               0620
         SR    @5,@2                                              0620
         LA    @A,1(@2,@7)                                        0620
         EX    @5,@CLC                                            0620
         BC    07,@956                                            0620
         LA    @F,1                                               0621
         STH   @F,MSGPARM+6                                       0621
*         IF RCODE=1                    /* QUAL. PART OF DSNAME?      *
*            THEN DO;                   /* YES                        *
@956     EQU   *                                                  0622
@957     LA    @F,1                                               0622
         CH    @F,MSGPARM+6                                       0622
         BC    07,@955                                            0622
*                 IF TYPE='SUBT'        /* NEED TO BE REMOVED?        *
*                    THEN DSNLNGTH=N-1; /* YES - ADJUST LENGTH        *
         L     @6,0(0,@1)          ADDRESS OF TYPE                0624
         CLC   0(4,@6),@C45                                       0624
         BC    07,@954                                            0624
         LH    @F,N                                               0625
         BCTR  @F,0                                               0625
         L     @7,MSGPARM+92       MSGPARM                        0625
         STH   @F,0(0,@7)                                         0625
*                 GO TO EQCH;           /* FINISHED                   *
         BC    15,EQCH                                            0626
*                 END;
* ADD:    IF DSNLNGTH=0                 /* NO DATA SET NAME GIVEN?    *
*            THEN DO;                   /* DONT USE '.'               *
@955     EQU   *                                                  0628
ADD      SR    @F,@F                                              0628
         L     @6,MSGPARM+92       MSGPARM                        0628
         CH    @F,0(0,@6)                                         0628
         BC    07,@953                                            0628
*                 LNG=LQUAL;            /* RESET LENGTH               *
         MVC   LNG(2),LQUAL                                       0630
*                 PTR=ADDR(QUAL);
         LA    @F,A00001+1                                        0631
         ST    @F,PTR                                             0631
*                 END;
*         N=DSNLNGTH+LNG;               /* CALC. NEW LENGTH           *
@953     LH    @F,LNG                                             0633
         L     @6,MSGPARM+92       MSGPARM                        0633
         AH    @F,0(0,@6)                                         0633
         STH   @F,N                                               0633
*         DSNM(DSNLNGTH+1:N)=PTR->CHARST(1:LNG);  /* MOVE IN QUAL.    *
         L     @7,PTR                                             0634
         LR    @E,@7                                              0634
         LR    @4,@F                                              0634
         LA    @5,1                                               0634
         AH    @5,0(0,@6)                                         0634
         SR    @4,@5                                              0634
         LA    @A,1(@5,@6)                                        0634
         EX    @4,@MVC                                            0634
*         DSNLNGTH=N;                   /* RESET LENGTH               *
         MVC   0(2,@6),N                                          0635
* EQCH:   END QCHECK;
EQCH     EQU   *                                                  0636
@EL03    LM    @E,@C,12(@D)                                       0636
         BCR   15,@E                                              0636
* ALLOCDS: PROC;
ALLOCDS  STM   @E,@C,12(@D)                                       0637
         ST    @D,@SAV004+4                                       0637
         LA    @F,@SAV004                                         0637
         ST    @F,8(0,@D)                                         0637
         LR    @D,@F                                              0637
*         /* ******************************************************** *
*         /* THIS PROCEDURE ALLOCATES THE PRINT, LOAD, LIB, INPUT, AND*
*         /* UTILITY DATA SETS. ALL DATA SETS EXCEPT THE UTILITY ONE  *
*         /* ARE FIRST ALLOCATED AS OLD.  IF THE DATA SET DOES NOT    *
*         /* EXIST, THE PRINT AND LOAD DATA SETS ARE RE-ALLOCATED AS  *
*         /* NEW.  TWO ARGUMENTS ARE PASSED TO THIS PROC. AND ARE     *
*         /* MOVED INTO LOCAL STORAGE FOR ITS USE.                    *
*         /* TYPE1 (FIRST ARGUMENT) HAS THE VALUE 'INPT','LOAD',      *
*         /* 'PRNT', 'LIBR', OR 'UTIL' TO INDICATE WHICH DATA SET IS  *
*         /* BEING ALLOCATED.                                         *
*         /* TYPE2 (SEC. ARGUMENT) HAS THE FOLLOWING VALUES TO        *
*         /* INDICATE WHAT NAME IS TO BE USED:                        *
*         /*    'DEFL' - USE THE DEFAULT DSNAME.                      *
*         /*    'NODF' - DO NOT USE THE DEFAULT NAME.                 *
*         /*    'UTIL' - USE THE TEMPORARY DSNAME SINCE IT IS A       *
*         /*             UTILITY DATA SET.                            *
*         /*    'SYSL' - USE THE SYSTEM LIBRARY NAME.                 *
*         /* IF A LIBRARY OR INPUT DATA SET IS ALLOCATED, THE DDNAME  *
*         /* IS ADDED TO THE LIST OF DDNAMES TO BE CONCATENATED.      *
*         /* ******************************************************** *
*         /* ******************************************************** *
*         /* DATA IN GETMAIN SPACE                                    *
*         /* ******************************************************** *
*         DCL PARMPTR POINTER;          /* POINTER TO PARMS.          *
*         DCL (TYPE1,                   /* LOCAL VARIABLE FOR 1ST ARG.*
*              TYPE2) CHAR(4);          /* LOCAL VARIABLE FOR 2ND ARG.*
*         DCL TADD CHAR(4);             /* USED TO TELL WHETHER TO    *
*                                       /* CONDITIONALLY OR UNCOND.   *
*                                       /* ADD A DEFAULT QUALIFIER.   *
*         DCL PTR2 PTR;                 /* INTERMEDIATE POINTER       *
*         DECLARE
*           1 BLDLST,                   /* BUILD L LIST               *
*             2 FF FIXED(15),           /* NUMBER OF ENTRIES          *
*             2 LLL FIXED(15),          /* LENGTH OF ENTRIES          *
*             2 NAME1 CHAR(8),          /* MEMBER NAME TO SEARCH FOR  *
*             2 * CHAR(2),
*             2 R CHAR(1),              /* TRACK ADD. OF FOUND MEMBER *
*             2 * CHAR(3);
*         /* ******************************************************** *
*         /* MAPS                                                     *
*         /* ******************************************************** *
*         DCL 1 PARMA BASED(PARMPTR),   /* INCOMING PARMS             *
*               2 P1 POINTER,           /* POINTER TO FIRST PARM.     *
*               2 P2 POINTER;           /* POINTER TO SEC. PARM.      *
*         RESTRICT(2,3);
*         PARMPTR=R1;                   /* SET POINTER TO PARMS.      *
         ST    @1,PARMPTR                                         0645
*         TYPE1=P1->CHARST(1:4);        /* GET FIRST PARM.            *
         L     @1,PARMPTR                                         0646
         L     @1,0(0,@1)          PARMA                          0646
         MVC   TYPE1(4),0(@1)                                     0646
*         TYPE2=P2->CHARST(1:4);        /* GET SECOND PARM.           *
         L     @6,PARMPTR                                         0647
         L     @6,4(0,@6)          PARMA                          0647
         MVC   TYPE2(4),0(@6)                                     0647
*         ERRCODE=0;                    /* INIT. ERROR CODE           *
         SR    @F,@F                                              0648
         STH   @F,MSGPARM+8                                       0648
*         DAPB0PTR=ADDR(DAIR08);        /* SET ADDRESS OF CODE 08     *
         LA    @F,DAIR08                                          0649
         ST    @F,MSGPARM                                         0649
*         GEN(XC DAIR08+2(74),DAIR08+2); /* ZERO OUT X'08' BLOCK      *
         XC DAIR08+2(74),DAIR08+2
         DS    0H
*         DA08MNM=BLANKS;               /* INIT. MEMBER NAME          *
         L     @1,MSGPARM                                         0651
         MVC   52(8,@1),BLANKS                                    0651
*         DA08PSWD=BLANKS;              /* INIT. PASSWORD             *
         MVC   60(8,@1),BLANKS                                    0652
*         DA08UNIT=BLANKS;              /* INIT. UNIT FIELD           *
         MVC   20(8,@1),BLANKS                                    0653
*         DA08SER=BLANKS;               /* INIT. VOL.-SER. FIELD      *
         MVC   28(8,@1),BLANKS                                    0654
*         IF TYPE2='UTIL'               /* UTILITY DATA SET?          *
*            THEN DO;                   /* YES                        *
         CLC   TYPE2(4),@C29                                      0655
         BC    07,@952                                            0655
*                 DA08NEW='1'B;         /* ALLOCATE AS (NEW,          *
         OI    68(@1),B'00000100'                                 0657
*                 DA08DEL='1'B;         /*              DELETE,       *
         OI    69(@1),B'00000100'                                 0658
*                 DA08DELE='1'B;        /*              DELETE)       *
         OI    70(@1),B'00000100'                                 0659
*                 GO TO ALLOC2;         /* ALLOCATE DATA SET          *
         BC    15,ALLOC2                                          0660
*                 END;
*         IF TYPE1='INPT'        /* SYSLIN (READ ONLY)       OY00595 *
*            TYPE1='LIBR'        /* SYSLIB/LIB (READ ONLY)   OY00595 *
*            TYPE1='LOAD'         /* SYSLMOD (ENQ'D BY LE )   OY00595 *
*            THEN DA08SHR='1'B;         /* YES - ALLOC. AS SHR        *
@952     CLC   TYPE1(4),@C39                                      0662
         BC    08,@951                                            0662
         CLC   TYPE1(4),@C30                                      0662
         BC    08,@950                                            0662
         CLC   TYPE1(4),@C6                                       0662
         BC    07,@94F                                            0662
@950     EQU   *                                                  0663
@951     L     @1,MSGPARM                                         0663
         OI    68(@1),B'00001000'                                 0663
         BC    15,@94E                                            0664
*            ELSE DA08OLD='1'B;         /* NO - ALLOC. AS OLD         *
@94F     L     @1,MSGPARM                                         0664
         OI    68(@1),B'00000001'                                 0664
*         DA08KEEP='1'B;                /*              KEEP,         *
@94E     L     @1,MSGPARM                                         0665
         OI    69(@1),B'00001000'                                 0665
*         DA08KEP='1'B;                 /*              KEEP)         *
         OI    70(@1),B'00001000'                                 0666
*         TADD='CADD';                  /* SET CODE TO COND. ADD      *
         MVC   TADD(4),@C43                                       0667
*         IF TYPE2='SYSL'               /* IS DATA SET A SYSLIB D.SET *
*            THEN DO;
         CLC   TYPE2(4),@C33                                      0668
         BC    07,@94D                                            0668
*                 /* ************************************************ *
*                 /* A SYSTEM LIBRARY (SYS1.FORTLIB,ETC.) IS TO BE    *
*                 /* ALLOCATED.  NAME IS ALREADY SET UP FOR ALLOCATION*
*                 /* ************************************************ *
*                 DA08UID='0'B;         /* DONT PREFIX USERID         *
         NI    71(@1),B'11011111'                                 0670
*                 GO TO ALLOC;
         BC    15,ALLOC                                           0671
*                 END;
*         IF TYPE2='DEFL'               /* USE DEFAULT NAME?          *
*            THEN DO;
@94D     CLC   TYPE2(4),@C24                                      0673
         BC    07,@94C                                            0673
*                 /* ************************************************ *
*                 /* USE DEFAULT DATA SET NAME.                       *
*                 /* ************************************************ *
*                 DSNLNGTH=DEFLEN;      /* GET LENGTH                 *
         L     @1,MSGPARM+92       MSGPARM                        0675
         MVC   0(2,@1),DEFAULT                                    0675
*                 DSNM=' ';
         MVI   2(@1),C' '                                         0676
         MVC   3(43,@1),2(@1)                                     0676
*                 IF DEFLEN^=0          /* IS LENGTH NON-ZERO?        *
*                    /* GET DATA SET NAME.                            *
*                    THEN DSNM(1:DEFLEN)=DEFNME(1:DEFLEN);
         SR    @F,@F                                              0677
         CH    @F,DEFAULT                                         0677
         BC    08,@94B                                            0677
         LA    @E,DEFAULT+2                                       0678
         LH    @6,DEFAULT                                         0678
         BCTR  @6,0                                               0678
         LA    @A,2(0,@1)                                         0678
         EX    @6,@MVC                                            0678
*                 DA08MNM=DEFMEM;       /* GET DEFAULT MEMBER NAME    *
@94B     L     @1,MSGPARM                                         0679
         MVC   52(8,@1),DEFAULT+46                                0679
*                 TADD='UADD';          /* SET CODE TO UNCOND. ADD    *
         MVC   TADD(4),@C44                                       0680
*                 GO TO ADDQ;           /* GO ADD QUALIFIER           *
         BC    15,ADDQ                                            0681
*                 END;
*            ELSE DO;
*                 /* ************************************************ *
*                 /* USE DATA SET NAME FROM PDE - NO DEFAULTS.        *
*                 /* ************************************************ *
*                 DSNLNGTH=DSL;         /* GET LENGTH                 *
@94C     L     @1,MSGPARM+96       MSGPARM                        0684
         L     @6,MSGPARM+92       MSGPARM                        0684
         MVC   0(2,@6),4(@1)                                      0684
*                 DSNM=' ';
         MVI   2(@6),C' '                                         0685
         MVC   3(43,@6),2(@6)                                     0685
*                 /* IF DS. LENGTH NOT ZERO, MOVE IN DATA SET NAME.   *
*                 IF DSN^=0 THEN DSNM(1:DSL)=DSN->CHARST(1:DSL);
         SR    @F,@F                                              0686
         C     @F,0(0,@1)                                         0686
         BC    08,@949                                            0686
         L     @7,MSGPARM+96       MSGPARM                        0687
         L     @7,0(0,@7)          DATASET                        0687
         LR    @E,@7                                              0687
         LH    @4,4(0,@1)                                         0687
         BCTR  @4,0                                               0687
         LA    @A,2(0,@6)                                         0687
         EX    @4,@MVC                                            0687
*                 /* IF MEMBER SPECIFIED, MOVE IN MEMBER NAME         *
*                 IF MEM^=0 THEN DA08MNM=MEM->CHARST(1:MEML);
@949     SR    @F,@F                                              0688
         L     @1,MSGPARM+96       MSGPARM                        0688
         C     @F,8(0,@1)                                         0688
         BC    08,@948                                            0688
         LH    @6,12(0,@1)                                        0689
         BCTR  @6,0                                               0689
         L     @7,MSGPARM+96       MSGPARM                        0689
         L     @7,8(0,@7)          DATASET                        0689
         LR    @E,@7                                              0689
         L     @4,MSGPARM                                         0689
         LA    @A,52(0,@4)                                        0689
         MVI   0(@A),C' '                                         0689
         MVC   1(007,@A),0(@A)                                    0689
         EX    @6,@MVC                                            0689
*                 /* IF PASSWORD SPECIFIED, MOVE IN PASSWORD          *
*                 IF PASS^=0 THEN DA08PSWD=PASS->CHARST(1:PASSL);
@948     SR    @F,@F                                              0690
         L     @1,MSGPARM+96       MSGPARM                        0690
         C     @F,16(0,@1)                                        0690
         BC    08,@947                                            0690
         LH    @6,20(0,@1)                                        0691
         BCTR  @6,0                                               0691
         L     @7,MSGPARM+96       MSGPARM                        0691
         L     @7,16(0,@7)         DATASET                        0691
         LR    @E,@7                                              0691
         L     @4,MSGPARM                                         0691
         LA    @A,60(0,@4)                                        0691
         MVI   0(@A),C' '                                         0691
         MVC   1(007,@A),0(@A)                                    0691
         EX    @6,@MVC                                            0691
*                 IF DSF(2)='1'B        /* DATA SET FULLY QUALIFIED?  *
*                    THEN DO;
@947     L     @1,MSGPARM+96       MSGPARM                        0692
         TM    6(@1),B'01000000'                                  0692
         BC    12,@946                                            0692
*                         /* **************************************** *
*                         /* DATA SET FULLY QUALIFIED                 *
*                         /* **************************************** *
*                         DA08UID='0'B; /* DON'T ADD USERID           *
         L     @6,MSGPARM                                         0694
         NI    71(@6),B'11011111'                                 0694
*                         GO TO ALLOC;  /* GO ALLOCATE DATA SET       *
         BC    15,ALLOC                                           0695
*                         END;
*                 END;
@946     EQU   *                                                  0697
*         /* ******************************************************** *
*         /* ADD DESCRIPTIVE QUALIFIER AND SET USERID BIT.            *
*         /* ******************************************************** *
* ADDQ:   CALL QCHECK(TADD);            /* ADD QUALIFIER TO DSNAME    *
@94A     EQU   *                                                  0698
ADDQ     LA    @F,TADD                                            0698
         ST    @F,@PL004                                          0698
         LA    @1,@PL004                                          0698
         BAL   @E,QCHECK                                          0698
*         DA08UID='1'B;      /* ADD USERID TO NAME                    *
         L     @1,MSGPARM                                         0699
         OI    71(@1),B'00100000'                                 0699
*         /* ******************************************************** *
*         /* ALLOCAT%E DATA SETS VIA DAIR.                            *
*         /* ******************************************************** *
* ALLOC:  IF TYPE1='LOAD'               /* LOAD MODULE BEING ALLOC.?  *
*            THEN DO;                   /* YES                        *
ALLOC    CLC   TYPE1(4),@C6                                       0700
         BC    07,@943                                            0700
*                 IF DA08MNM=BLANKS     /* MEMBER NAME GIVEN?         *
*                    THEN DA08MNM='TEMPNAME';  /* NO - USE TEMPNAME   *
         L     @1,MSGPARM                                         0702
         CLC   52(8,@1),BLANKS                                    0702
         BC    07,@942                                            0702
         MVC   52(8,@1),@C46                                      0703
*                 IF LKDCBS=1           /* DCBS SPECIFIED?    OY00686 *
*                    THEN DA08BLK=DCBSBLK;   /* YES - USE BLOCKSIZE   *
@942     L     @6,PDLPTR                                          0704
         CLC   56(2,@6),@D3                                       0704
         BC    07,@941                                            0704
         MVC   36(4,@1),DCBSBLK                                   0705
*                 END;
@941     EQU   *                                                  0706
*         IF TYPE1='LIBR' THEN DA08MNM=BLANKS;    /* LIB DATA SET HAS *
@943     CLC   TYPE1(4),@C30                                      0707
         BC    07,@940                                            0707
         L     @1,MSGPARM                                         0708
         MVC   52(8,@1),BLANKS                                    0708
*                                                 /* NO MEMBER NAME   *
*         IF TYPE1='INPT' THEN DO;
@940     CLC   TYPE1(4),@C39                                      0709
         BC    07,@93F                                            0709
*                              /* INPUT DATA SETS MUST BE ALLOCATED   *
*                              /* FIRST WITH NO MEMBER NAME.          *
*                              NAME1=DA08MNM;     /* SAVE MEMBER NAME *
         L     @1,MSGPARM                                         0711
         MVC   BLDLST+4(8),52(@1)                                 0711
*                              DA08MNM=BLANKS;    /* BLANK OUT MEMBER *
         MVC   52(8,@1),BLANKS                                    0712
*                              END;
* ALLOC2: DA08PDSN=ADDR(DSNAME);        /* SET DSNAME POINTER         *
@93F     EQU   *                                                  0714
ALLOC2   L     @1,MSGPARM+92       MSGPARM                        0714
         L     @6,MSGPARM                                         0714
         ST    @1,8(0,@6)                                         0714
* LNK:    DAPLDAPB=ADDR(DAIR08);        /* SET POINTER TO BLOCK       *
LNK      LA    @F,DAIR08                                          0715
         L     @1,DAPLPTR                                         0715
         ST    @F,16(0,@1)                                        0715
*         DA08DDN=BLANKS;               /* BLANK OUT DDNAME.          *
         L     @6,MSGPARM                                         0716
         MVC   12(8,@6),BLANKS                                    0716
*         DA08FLG=0;                    /* ZERO OUT FLAGS     ZA00136 *
         MVC   2(2,@6),@D2                                        0717
*         DA08DARC=0;                   /* ZERO OUT DYN. ALL. RETURN  *
         SR    @F,@F                                              0718
         STH   @F,4(0,@6)                                         0718
*         DA08CTRC=0;                   /* ZERO OUT CATLG. RETURN CD. *
         STH   @F,6(0,@6)                                         0719
*         DA08DSO='00'X;                /* ZERO OUT DSORG FIELD       *
         MVI   75(@6),X'00'                                       0720
*         R1=DAPLPTR;                   /* SET PTR. TO DAIR PARM-LIST *
         L     @1,DAPLPTR                                         0721
*         GEN(LINK EP=IKJDAIR);         /* GO TO DAIR                 *
         LINK EP=IKJDAIR
         DS    0H
*         RCODE=R15;
         STH   @F,MSGPARM+6                                       0723
*         IF RCODE=0 & TYPE1='LIBR'     /* LIBRARY DATA SET           *
*            THEN IF DA08DSO='02'X      /*   A PDS?                   *
         SR    @F,@F                                              0724
         CH    @F,MSGPARM+6                                       0724
         BC    07,@93E                                            0724
         CLC   TYPE1(4),@C30                                      0724
         BC    07,@93D                                            0724
*                    THEN GO TO LST;    /* YES - ADD DDNAME TO LIST   *
         CLI   75(@6),X'02'                                       0725
         BC    08,LST                                             0726
*                    ELSE DO;
*                         MES=20;       /* LIBRARY NOT A PDS          *
         LA    @F,20                                              0728
         ST    @F,MES                                             0728
*                         GO TO PRNTM;  /* PRINT MESSAGE              *
         BC    15,PRNTM                                           0729
*                         END;
*         IF RCODE=0 & DA08DSO='02'X    /* DATA SET A PDS?            *
*            THEN IF DA08MNM=BLANKS     /* NO MEMBER NAME GIVEN       *
@93D     EQU   *                                                  0731
@93E     SR    @F,@F                                              0731
         CH    @F,MSGPARM+6                                       0731
         BC    07,@93C                                            0731
         L     @1,MSGPARM                                         0731
         CLI   75(@1),X'02'                                       0731
         BC    07,@93B                                            0731
*                    THEN IF TYPE1='INPT' /* INPUT DATA SET?          *
         CLC   52(8,@1),BLANKS                                    0732
         BC    07,@93A                                            0732
*                            THEN GO TO INP;  /* SEE IF MEMBER EXISTS.*
         CLC   TYPE1(4),@C39                                      0733
         BC    08,INP                                             0734
*                            ELSE DO;
*                                 /* ******************************** *
*                                 /* ALLOCATE WITH MEMBER 'TEMPNAME'  *
*                                 /* ******************************** *
*                                 DA08MNM='TEMPNAME';
         MVC   52(8,@1),@C46                                      0736
*                       UNALLOC: DAPB1PTR=ADDR(DAIR18);
UNALLOC  LA    @F,DAIR18                                          0737
         ST    @F,DAPB1PTR                                        0737
*                                GEN(XC DAIR18+2(38),DAIR18+2);
         XC DAIR18+2(38),DAIR18+2
         DS    0H
*                                IF DA08UID='1'B /*ADD USERID?        *
*                                   THEN DA18UID='1'B; /* YES         *
         L     @1,MSGPARM                                         0739
         TM    71(@1),B'00100000'                                 0739
         BC    12,@939                                            0739
         L     @6,DAPB1PTR                                        0740
         OI    31(@6),B'00100000'                                 0740
*                                DA18DDN=DA08DDN;  /* SET DDNAME      *
@939     L     @6,DAPB1PTR                                        0741
         MVC   12(8,@6),12(@1)                                    0741
*                                DA18MNM=BLANKS;   /* CLEAR   ZA00136 *
         MVC   20(8,@6),BLANKS                                    0742
*                                    /* MEMBER NAME TO BLANKS ZA00136 *
*                                DA18SCLS=BLANKS;  /* CLEAR   ZA00136 *
         MVC   28(2,@6),BLANKS                                    0743
*                                  /* SYSOUT CLASSS TO BLANKS ZA00136 *
*                                DAPLDAPB=ADDR(DAIR18); /* SET POINTER*
         LA    @F,DAIR18                                          0744
         L     @7,DAPLPTR                                         0744
         ST    @F,16(0,@7)                                        0744
*                                R1=DAPLPTR;  /* SET LIST POINTER     *
         L     @1,DAPLPTR                                         0745
*                                GEN(LINK  EP=IKJDAIR);  /* GO UNALLO.*
         LINK  EP=IKJDAIR
         DS    0H
*                                 GO TO LNK;
         BC    15,LNK                                             0747
*                                 END;
*                    ELSE IF TYPE1='INPT'    /* INPUT DATA SET?       *
*                            THEN GO TO LST;  /* YES - ADD TO LIST    *
@93A     CLC   TYPE1(4),@C39                                      0749
         BC    08,LST                                             0750
*                            ELSE GO TO ENDAL; /* NO - FINISHED       *
         BC    15,ENDAL                                           0751
*         IF RCODE=0                    /* RETURN CODE = 0 ?          *
*            THEN IF TYPE1='INPT'       /* INPUT DATA SET?            *
@938     EQU   *                                                  0752
@93B     EQU   *                                                  0752
@93C     SR    @F,@F                                              0752
         CH    @F,MSGPARM+6                                       0752
         BC    07,@937                                            0752
*                    THEN GO TO LST;    /* YES - ADD TO INPUT LIST    *
         CLC   TYPE1(4),@C39                                      0753
         BC    08,LST                                             0754
*                    ELSE GO TO ENDAL;  /* NO - FINISHED              *
         BC    15,ENDAL                                           0755
*         MES=0;                        /* INITIALIZE MESSAGE NUMBER  *
@937     SR    @F,@F                                              0756
         ST    @F,MES                                             0756
*         IF RCODE=4                    /* NAME GT. 44 CHARACTERS?    *
*            THEN DO;                   /* YES                        *
         LA    @F,4                                               0757
         CH    @F,MSGPARM+6                                       0757
         BC    07,@936                                            0757
*                 MES=18;               /* SET MESSAGE CODE           *
         LA    @F,18                                              0759
         ST    @F,MES                                             0759
*                 GO TO PRNTM;          /* PRINT MESSAGE              *
         BC    15,PRNTM                                           0760
*                 END;
*         IF RCODE=8                    /* CATALOG ERROR?             *
*            THEN DO;                   /* YES - WHICH ONE            *
@936     LA    @F,8                                               0762
         CH    @F,MSGPARM+6                                       0762
         BC    07,@935                                            0762
*                 IF DA08CTRC=4
*                    THEN MES=5;        /* VOLUME NOT MOUNTED         *
         LA    @F,4                                               0764
         L     @1,MSGPARM                                         0764
         CH    @F,6(0,@1)                                         0764
         BC    07,@934                                            0764
         LA    @F,5                                               0765
         ST    @F,MES                                             0765
*                 IF DA08CTRC=8         /* DATA SET NOT FOUND OY00595 *
*                    THEN IF TYPE1='PRNT' & /* ALLOCATE PRINT OY00595 *
@934     LA    @F,8                                               0766
         CH    @F,6(0,@1)                                         0766
         BC    07,@933                                            0766
*                            DA08OLD='1'B   /* DATA SET NEW   OY00595 *
*                            THEN GO TO NW;
         CLC   TYPE1(4),@C23                                      0767
         BC    07,@932                                            0767
         TM    68(@1),B'00000001'                                 0767
         BC    03,NW                                              0768
*                            ELSE IF TYPE1='LOAD' &
*                                           /* ALLOC LOAD     OY00595 *
*                                    DA08SHR='1'B
*                                           /* DATA SET NEW   OY00595 *
*                                    THEN GO TO NW;
@931     EQU   *                                                  0769
@932     CLC   TYPE1(4),@C6                                       0769
         BC    07,@930                                            0769
         L     @1,MSGPARM                                         0769
         TM    68(@1),B'00001000'                                 0769
         BC    03,NW                                              0770
*                    ELSE MES=1;         /* NOT IN CATALOG            *
@92F     EQU   *                                                  0771
@930     LA    @F,1                                               0771
         ST    @F,MES                                             0771
*                 IF DA08CTRC=12 
*                    DA08CTRC=16       /* 8, 12 OR 16 MEANS INVALID  *
*                    DA08CTRC=8
*                    THEN IF TYPE1='PRNT' 
@933     LA    @F,12                                              0772
         L     @1,MSGPARM                                         0772
         CH    @F,6(0,@1)                                         0772
         BC    08,@92E                                            0772
         LA    @F,16                                              0772
         CH    @F,6(0,@1)                                         0772
         BC    08,@92D                                            0772
         LA    @F,8                                               0772
         CH    @F,6(0,@1)                                         0772
         BC    07,@92C                                            0772
*                            TYPE1='LOAD'
*                            THEN MES=31; /* CATALOG STRUCTURE        *
@92D     EQU   *                                                  0773
@92E     CLC   TYPE1(4),@C23                                      0773
         BC    08,@92B                                            0773
         CLC   TYPE1(4),@C6                                       0773
         BC    07,@92A                                            0773
@92B     LA    @F,31                                              0774
         ST    @F,MES                                             0774
         BC    15,@929                                            0775
*                            ELSE MES=1;
@92A     LA    @F,1                                               0775
         ST    @F,MES                                             0775
*                 IF DA08CTRC=28
*                    THEN MES=9;        /* CATALOG I/O ERROR          *
@929     EQU   *                                                  0776
@92C     LA    @F,28                                              0776
         L     @1,MSGPARM                                         0776
         CH    @F,6(0,@1)                                         0776
         BC    07,@928                                            0776
         LA    @F,9                                               0777
         ST    @F,MES                                             0777
*                 IF MES=0              /* NO ERROR FOUND             *
*                    THEN MES=7;        /* GIVE CATALOG RETURN CODE   *
@928     SR    @F,@F                                              0778
         C     @F,MES                                             0778
         BC    07,@927                                            0778
         LA    @F,7                                               0779
         ST    @F,MES                                             0779
*                 END;
@927     EQU   *                                                  0780
*         IF RCODE=12                   /* RETURN CODE IS 12?         *
*            THEN DO;                   /* YES - FIND WHAT IS WRONG   *
@935     LA    @F,12                                              0781
         CH    @F,MSGPARM+6                                       0781
         BC    07,@926                                            0781
*                 IF DA08DARC='6708'X
*                    THEN MES=4;        /* DATA SET NOT ON VOLUME     *
         L     @F,@X47                                            0783
         L     @1,MSGPARM                                         0783
         CH    @F,4(0,@1)                                         0783
         BC    07,@925                                            0783
         LA    @F,4                                               0784
         ST    @F,MES                                             0784
*                 IF DA08DARC='0218'X
*                    THEN MES=5;        /* VOLUME NOT MOUNTED         *
@925     L     @F,@X48                                            0785
         CH    @F,4(0,@1)                                         0785
         BC    07,@924                                            0785
         LA    @F,5                                               0786
         ST    @F,MES                                             0786
*                 IF DA08DARC='0210'X
*                    THEN MES=10;       /* DATA SET IN USE            *
@924     L     @F,@X49                                            0787
         CH    @F,4(0,@1)                                         0787
         BC    07,@923                                            0787
         LA    @F,10                                              0788
         ST    @F,MES                                             0788
*                 IF DA08DARC='0330'X    /* MEMBER GIVEN FOR NON-PDS  *
*                    THEN IF TYPE1='LOAD' /* LOAD MOD. DATA SET?      *
@923     L     @F,@X50                                            0789
         CH    @F,4(0,@1)                                         0789
         BC    07,@922                                            0789
*                         THEN MES=19;  /* LOAD MODULE NOT PARTITIONED*
         CLC   TYPE1(4),@C6                                       0790
         BC    07,@921                                            0790
         LA    @F,19                                              0791
         ST    @F,MES                                             0791
         BC    15,@920                                            0792
*                         ELSE MES=24;  /* MEMBER FOR SEQ. DATA SET   *
@921     LA    @F,24                                              0792
         ST    @F,MES                                             0792
*                 IF DA08DARC>'4700'X & /* DADSM ERROR?               *
*                    DA08DARC<='47FF'X
*                    THEN DO;           /* YES - SEE WHICH            *
@920     EQU   *                                                  0793
@922     L     @F,@X51                                            0793
         L     @1,MSGPARM                                         0793
         CH    @F,4(0,@1)                                         0793
         BC    10,@91F                                            0793
         L     @F,@X52                                            0793
         CH    @F,4(0,@1)                                         0793
         BC    04,@91E                                            0793
*                         IF TYPE2='UTIL'
*                            THEN MES=29; /* DADSM ON UTILITY         *
         CLC   TYPE2(4),@C29                                      0795
         BC    07,@91D                                            0795
         LA    @F,29                                              0796
         ST    @F,MES                                             0796
         BC    15,@91C                                            0797
*                            ELSE MES=28; /* DADSM ON DATA SET        *
@91D     LA    @F,28                                              0797
         ST    @F,MES                                             0797
*                         IF DA08DARC='4714'X
*                            THEN MES=32; /* NOT ENOUGH SPACE         *
@91C     L     @F,@X53                                            0798
         CH    @F,4(0,@1)                                         0798
         BC    07,@91B                                            0798
         LA    @F,32                                              0799
         ST    @F,MES                                             0799
*                         END;
@91B     EQU   *                                                  0800
*                 IF MES=0              /* NONE OF THESE ERRORS?      *
*                    THEN DO;           /* NO - DYNAMIC ALLOC. ERROR  *
@91E     EQU   *                                                  0801
@91F     SR    @F,@F                                              0801
         C     @F,MES                                             0801
         BC    07,@91A                                            0801
*                         IF TYPE2='UTIL' /* UTILITY DATA SET?        *
*                            THEN MES=8;/* YES                        *
         CLC   TYPE2(4),@C29                                      0803
         BC    07,@919                                            0803
         LA    @F,8                                               0804
         ST    @F,MES                                             0804
         BC    15,@918                                            0805
*                            ELSE MES=6;/* NO                         *
@919     LA    @F,6                                               0805
         ST    @F,MES                                             0805
*                         END;
@918     EQU   *                                                  0806
*                 END;
@91A     EQU   *                                                  0807
*         IF RCODE=16                   /* NO MORE ROOM IN TABLES     *
*            THEN IF TYPE2='UTIL'       /* UTILITY DATA SET?          *
@926     LA    @F,16                                              0808
         CH    @F,MSGPARM+6                                       0808
         BC    07,@917                                            0808
*                    THEN MES=3;        /* YES                        *
         CLC   TYPE2(4),@C29                                      0809
         BC    07,@916                                            0809
         LA    @F,3                                               0810
         ST    @F,MES                                             0810
         BC    15,@915                                            0811
*                    ELSE MES=2;        /* NO                         *
@916     LA    @F,2                                               0811
         ST    @F,MES                                             0811
*         IF MES=0                      /* MESSAGE STILL UNDEFINED?   *
*            THEN MES=30;               /* GIVE COMMAND SYSTEM ERROR  *
@915     EQU   *                                                  0812
@917     SR    @F,@F                                              0812
         C     @F,MES                                             0812
         BC    07,@914                                            0812
         LA    @F,30                                              0813
         ST    @F,MES                                             0813
*         GO TO PRNTM;                  /* PRINT MESSAGE              *
         BC    15,PRNTM                                           0814
*         /* ******************************************************** *
*         /* ALLOCATE A NEW DATA SET.                                 *
*         /* ******************************************************** *
* NW:     DA08DSP1='00'X; DA08NEW='1'B; /* ALLOCATE AS (NEW,          *
NW       L     @1,MSGPARM                                         0815
         MVI   68(@1),X'00'                                       0815
         OI    68(@1),B'00000100'                                 0816
*         DA08DPS2='00'X; DA08CAT='1'B; /*              CATL,         *
         MVI   69(@1),X'00'                                       0817
         OI    69(@1),B'00000010'                                 0818
*         DA08DPS3='00'X; DA08CATL='1'B;/*              CATL)         *
         MVI   70(@1),X'00'                                       0819
         OI    70(@1),B'00000010'                                 0820
*         IF DA08MNM=BLANKS THEN DA08DQTY=0; /* ALLOC. SEQUENTIAL     *
         CLC   52(8,@1),BLANKS                                    0821
         BC    07,@913                                            0821
         MVC   48(4,@1),@D5                                       0822
         BC    15,@912                                            0823
*                           ELSE DA08DQTY=2; /* ALLOC. A PDS          *
@913     MVC   48(4,@1),@D23                                      0823
*         GO TO LNK;                    /* GO TO ALLOCATE THE D. SET  *
         BC    15,LNK                                             0824
*         /* ******************************************************** *
*         /* SEE IF INPUT DATA SET MEMBER EXISTS.                     *
*         /* ******************************************************** *
* INP:    FF=1;                         /* ONE BLDL ENTRY             *
INP      LA    @F,1                                               0825
         STH   @F,BLDLST                                          0825
*         LLL=14;                       /* 14 BYTE ENTRIES            *
         LA    @F,14                                              0826
         STH   @F,BLDLST+2                                        0826
*         IF NAME1=BLANKS               /* MEMBER NAME GIVEN?         *
*            THEN NAME1='TEMPNAME';     /* NO - USE TEMPNAME          *
         CLC   BLDLST+4(8),BLANKS                                 0827
         BC    07,@911                                            0827
         MVC   BLDLST+4(8),@C46                                   0828
*         R3=ADDR(INDCB);
@911     LA    @3,INDCB                                           0829
*         GENERATE;
         USING IHADCB,R3          USE REG. 3 FOR DSECT BASE
         MVC IHADCB(DCBSIZE),INSET  MOVE DCB INFO INTO DYN. STORAGE
         DS    0H
*         DCBDDNAM=DA08DDN;             /* MOVE DDNAME TO DCB         *
         L     @1,MSGPARM                                         0831
         MVC   DCBDDNAM(8),12(@1)                                 0831
*         OPTBYT='80'X;                 /* SET INPUT FLAG             *
         MVI   DMLIST,X'80'                                       0832
*         R1=ADDR(DMLIST);              /* SET DATA MAN. LIST ADDR.   *
         LA    @1,DMLIST                                          0833
*         GENERATE;                     /* LOOK FOR SPEC. MEMBER      *
         OPEN  ((3)),MF=(E,(1))
         BLDL  INDCB,BLDLST
         DS    0H
*         RCODE=R15;                    /* SAVE BLDL RETURN CODE      *
         STH   @F,MSGPARM+6                                       0835
*         R1=ADDR(DMLIST);              /* GET ADDR. OF DATA MAN. LST.*
         LA    @1,DMLIST                                          0836
*         GEN(CLOSE  ((3)),MF=(E,(1)));
         CLOSE  ((3)),MF=(E,(1))
         DS    0H
*         DA08MNM=NAME1;                /* SET DAIR MEMBER NAME       *
         L     @1,MSGPARM                                         0838
         MVC   52(8,@1),BLDLST+4                                  0838
*         IF RCODE=0                    /* MEMBER NAME FOUND?         *
*            THEN GO TO UNALLOC;        /* YES - UNALLOCATE           *
         SR    @F,@F                                              0839
         CH    @F,MSGPARM+6                                       0839
         BC    08,UNALLOC                                         0840
*            ELSE DO;                   /* NO - GIVE MESSAGE          *
*                 MES=21;               /* MEMBER NOT FOUND           *
         LA    @F,21                                              0842
         ST    @F,MES                                             0842
*                 GO TO PRNTM;          /* GO PRINT                   *
         BC    15,PRNTM                                           0843
*                 END;
*         GO TO ENDAL;
*         /* ******************************************************** *
*         /* ADD DDNAME TO LIST OF DATA SETS TO BE CONCATENATED       *
*         /* ******************************************************** *
* LST:    DAPB0PTR=ADDR(DAIR0C);        /* GET ADDRESS OF BLOCK       *
LST      LA    @F,DAIR0C                                          0846
         ST    @F,MSGPARM                                         0846
*         IF DA0CNUMB=25                /* CHECK FOR LIMIT    OY00686 *
*            THEN DO;                   /* DIAGNOSE ERROR     OY00686 *
         LA    @F,25                                              0847
         L     @1,MSGPARM                                         0847
         CH    @F,8(0,@1)                                         0847
         BC    07,@910                                            0847
*                 IF TYPE1='INPT'       /* INPUT DATA SET     OY00686 *
*                    THEN CALL AKJLKMSG(LSTPTR,25);
         CLC   TYPE1(4),@C39                                      0849
         BC    07,@90F                                            0849
         LA    @F,LSTPTR                                          0850
         ST    @F,@PL004                                          0850
         LA    @F,@D6                                             0850
         ST    @F,@PL004+4                                        0850
         L     @F,@V1              ADDRESS OF AKJLKMSG            0850
         LA    @1,@PL004                                          0850
         BALR  @E,@F                                              0850
         BC    15,@90C                                            0851
*                                       /* LOG INPUT MSG      OY00686 *
*                    ELSE CALL AKJLKMSG(LSTPTR,26);
@90F     LA    @F,LSTPTR                                          0851
         ST    @F,@PL004                                          0851
         LA    @F,@D9                                             0851
         ST    @F,@PL004+4                                        0851
         L     @F,@V1              ADDRESS OF AKJLKMSG            0851
         LA    @1,@PL004                                          0851
         BALR  @E,@F                                              0851
*                                       /* LOG LIBRARY MSG    OY00686 *
*                    GO TO ENDAL;       /* CANCEL CONCATEN    OY00686 *
         BC    15,ENDAL                                           0852
*                 END;                  /*                    OY00686 *
*         DA0CNUMB=DA0CNUMB+1;          /* ADD TO COUNT OF DDNAMES    *
@910     LA    @F,1                                               0854
         L     @1,MSGPARM                                         0854
         AH    @F,8(0,@1)                                         0854
         STH   @F,8(0,@1)                                         0854
*         IF DEFNME(1)=' ' & TYPE1='INPT' /* FIRST INPUT DATA SET     *
*            & TYPE2 ^= 'UTIL'          /* NOT UTILITY DATA SET       *
*            THEN DO;                   /* YES - GET NAME FOR DEFAULTS*
         CLI   DEFAULT+2,C' '                                     0855
         BC    07,@909                                            0855
         CLC   TYPE1(4),@C39                                      0855
         BC    07,@908                                            0855
         CLC   TYPE2(4),@C29                                      0855
         BC    08,@907                                            0855
*                 IF DSF(2)='1'B        /* DSNAME IN QUOTES  @ZA28304 *
*                    THEN GO TO LST1;   /* NO QUAL           @ZA28304 *
         L     @6,MSGPARM+96       MSGPARM                        0857
         TM    6(@6),B'01000000'                                  0857
         BC    01,LST1                                            0858
*                    ELSE DO;           /*                   @ZA28304 *
*                       IF DSNLNGTH<5   /* CAN THERE BE QUAL @ZA28304 *
*                          THEN DO;                       /* @ZA28304 *
         LA    @F,5                                               0860
         L     @7,MSGPARM+92       MSGPARM                        0860
         CH    @F,0(0,@7)                                         0860
         BC    12,@906                                            0860
*                               DEFLEN=0;       /*ZERO LENGTH @ZA28304*
         SR    @F,@F                                              0862
         STH   @F,DEFAULT                                         0862
*                               DEFNME=' ';     /*BLANK NAME  @ZA28304*
         MVI   DEFAULT+2,C' '                                     0863
         MVC   DEFAULT+3(43),DEFAULT+2                            0863
         BC    15,@905                                            0865
*                               END;                      /* @ZA28304 *
*                          ELSE DO;     /*REMOVE QUAL     /* @ZA28304 *
*                               CALL QCHECK('SUBT');      /* @ZA28304 *
@906     LA    @F,@C45                                            0866
         ST    @F,@PL004                                          0866
         LA    @1,@PL004                                          0866
         BAL   @E,QCHECK                                          0866
*                               DEFLEN=DSNLNGTH;          /* @ZA28304 *
         L     @1,MSGPARM+92       MSGPARM                        0867
         MVC   DEFAULT(2),0(@1)                                   0867
*                               DEFNME(1:DEFLEN)=DSNM(1:DEFLEN);
         LA    @E,2(0,@1)                                         0868
         LH    @6,DEFAULT                                         0868
         BCTR  @6,0                                               0868
         LA    @A,DEFAULT+2                                       0868
         EX    @6,@MVC                                            0868
*                               END;                      /* @ZA28304 *
*                         END;                            /* @ZA28304 *
*                 IF MEMF(1)='1'B       /* MEMBER NAME GIVEN?         *
*                    THEN DEFMEM=MEM->CHARST(1:MEML); /* MOVE IN      *
@905     L     @1,MSGPARM+96       MSGPARM                        0871
         TM    14(@1),B'10000000'                                 0871
         BC    12,@902                                            0871
         LH    @6,12(0,@1)                                        0872
         BCTR  @6,0                                               0872
         L     @7,MSGPARM+96       MSGPARM                        0872
         L     @7,8(0,@7)          DATASET                        0872
         LR    @E,@7                                              0872
         LA    @A,DEFAULT+46                                      0872
         MVI   0(@A),C' '                                         0872
         MVC   1(007,@A),0(@A)                                    0872
         EX    @6,@MVC                                            0872
*                 END;
@902     EQU   *                                                  0873
* LST1:                                 /*                    ZA03672 *
*         PTR2=ADDR(DAIR08);            /* GET POINTER TO 08 BLOCK    *
@907     EQU   *                                                  0874
@908     EQU   *                                                  0874
@909     EQU   *                                                  0874
LST1     LA    @F,DAIR08                                          0874
         ST    @F,PTR2                                            0874
*         DA0CDDN(DA0CNUMB)=PTR2->DA08DDN; /* MOVE DDNAME TO LIST     *
         LR    @1,@F                                              0875
         L     @7,MSGPARM                                         0875
         LH    @6,8(0,@7)                                         0875
         SLA   @6,3                                               0875
         LA    @A,DAIR0C+4(@6)                                    0875
         MVC   0(8,@A),12(@1)                                     0875
*         GO TO ENDAL;
         BC    15,ENDAL                                           0876
*         GENERATE;
INSET    DCB   DSORG=PO,MACRF=(R)
DCBSIZE  EQU *-INSET
         DCBD  DSORG=PO
AKJLKL01 CSECT
         DS    0H
* PRNTM:  CALL AKJLKMSG(LSTPTR,MES);    /* GO TO MESSAGE PROCESSOR    *
PRNTM    LA    @F,LSTPTR                                          0878
         ST    @F,@PL004                                          0878
         LA    @F,MES                                             0878
         ST    @F,@PL004+4                                        0878
         L     @F,@V1              ADDRESS OF AKJLKMSG            0878
         LA    @1,@PL004                                          0878
         BALR  @E,@F                                              0878
*         IF PROMPTM=0                  /* NOT PROMPTING?             *
*            THEN RETURN TO FINIS;      /* TERMINATE PROCESSING       *
         SR    @F,@F                                              0879
         CH    @F,MSGPARM+4                                       0879
         BC    07,@8FF                                            0879
         L     @D,4(0,@D)                                         0880
         LA    @E,FINIS                                           0880
         LM    @F,@C,16(@D)                                       0880
         BCR   15,@E                                              0880
* ENDAL:  END ALLOCDS;
@8FF     EQU   *                                                  0881
ENDAL    EQU   *                                                  0881
@EL04    L     @D,4(0,@D)                                         0881
         LM    @E,@C,12(@D)                                       0881
         BCR   15,@E                                              0881
* /* **************************************************************** *
* /*                                                                  *
* /* THIS ROUTINE RECEIVES CONTROL WHEN AN ABEND OCCURS.  THE ABEND   *
* /* CODE IS STORED IN THE ECT AND THE ABEND FLAG IN THE ECT IS SET.  *
* /* ANY CONCATENATED DATA SETS ARE DECONCATENATED.  A RETURN CODE OF *
* /* 0 IS PLACED IN REGISTER 15.  A RETURN IS ISSUED AND CONTROL GOES *
* /* BACK TO ABEND PROCESSING.                                        *
* /*                                                                  *
* /* **************************************************************** *
* ABEX:   PROC OPTIONS(NOSAVEAREA,DONTSAVE);
ABEX     EQU   *                                                  0882
*         /* ******************************************************** *
*         /* MAPS                                                     *
*         /* ******************************************************** *
*         DCL 1 WORKAREA BASED(R1),     /* STAE WORK AREA             *
*               2 PARMSREG PTR,         /* POINTER TO BASE,DYNAM. REGS*
*               2 ABCODE FIXED(31);     /* ABEND CODE                 *
*         DCL 1 ECTBLK BASED(PTR1),     /* STRUCTURE FOR ECT          *
*               2 ECTRTCD FIXED(31),    /* ABEND CODE                 *
*                 3 ECTRCDF BIT(1);     /* FLAGS                      *
*         DCL  FPTR2 PTR BASED(R13+8);  /* FORWARD POINTER            *
*         /* ******************************************************** *
*         /* DATA IN GETMAIN SPACE                                    *
*         /* ******************************************************** *
*         DCL SAVEAR2(18) FIXED(31);    /* INTERNAL SAVE AREA         *
*         DCL DAIR10 CHAR(16) BDY(WORD); /* DAIR DECONC BLK   ZM00614 *
*         /* ******************************************************** *
*         /* MISCELLANEOUS                                            *
*         /* ******************************************************** *
*         DCL R0 REG(0) FIXED(31);      /* INDICATES WHERE ABEND CODE *
*                                       /* IS.                        *
*         RESTRICT(1);                 /* DONT DESTROY REG 1  @ZA18262*
*         GEN;                        /*                      @ZA31176*
         DROP  R8,R9,R11             /* ESTABLISH            @ZA31176*/
         USING ABEX,R15              /* BASE REGISTER        @ZA31176*/
         DS    0H
*         IF R0=12 THEN               /* RETURN TO RTM IF     @ZA31176*
         C     @0,@D13                                            0891
*            GO TO ENDAB1;            /* NO SDWA IS PRESENT   @ZA31176*
         BC    08,ENDAB1                                          0892
*         GEN;                        /*                      @ZA31176*
         DROP  R15                   /* SDWA IS PRESENT -    @ZA31176*/
         USING @PSTART,@8            /* RESET BASE REGS AND  @ZA31176*/
         USING @PSTART+4095,@9       /* SAVE RTM REGISTERS.  @ZA31176*/
         USING @PSTART+8190,@B       /*                      @ZA31176*/
         ST    @E,12(0,@D)           /*                      @ZA31176*/
         STM   @0,@C,20(@D)          /*                      @ZA31176*/
         DS    0H
*         R8=PARMSREG->BASEREG(1);    /* RESTORE 1ST BASE REG. ZA02180*
         L     @6,0(0,@1)          
         L     @8,0(0,@6)                                         0894
*         R9=PARMSREG->BASEREG(2);    /* RESTORE 2ND BASE REG. ZA02180*
         L     @9,4(0,@6)                                         0895
*         R11=PARMSREG->BASEREG(3);   /* RESTORE 3RD BASE REG. ZA02180*
         L     @B,8(0,@6)                                         0896
*         R12=PARMSREG->DATAREG;        /* RESTORE DATA REG.          *
         L     @C,12(0,@6)                                        0897
*         SAVEAR2(2)=R13;               /* SET SAVE AREA PTR.         *
         ST    @D,SAVEAR2+4                                       0898
*         FPTR2=ADDR(SAVEAR2);          /* SET FORWARD POINTER.       *
         LA    @F,SAVEAR2                                         0899
         ST    @F,8(0,@D)                                         0899
*         R13=FPTR2;                    /* POINT REG. 13 TO SAVE AREA *
         L     @D,8(0,@D)                                         0900
*         PTR1=CPPLECT;                 /* SET POINTER TO ECT         *
         L     @7,MSGPARM+104      MSGPARM                        0901
         MVC   MSGPARM+96(4),12(@7)                               0901
*         ECTRTCD=ABCODE;               /* GET ABEND CODE     @ZA31176*
         L     @4,MSGPARM+96       MSGPARM                        0902
         MVC   0(4,@4),4(@1)                                      0902
*                                       /* FROM STAE WORKAREA.        *
*         ECTRCDF='1'B;                 /* SET ABEND FLAG             *
         OI    0(@4),B'10000000'                                  0903
*         /* ******************************************************** *
*         /* DECONCATENATE INPUT AND LIBRARY DDNAMES IF NECESSARY     *
*         /* ******************************************************** *
*         DAPB1PTR=ADDR(DAIR10);        /* SET BLK PTR        ZM00614 *
         LA    @F,DAIR10                                          0904
         ST    @F,DAPB1PTR                                        0904
*         GEN(XC    DAIR10(16),DAIR10); /* ZERO BLK           ZM00614 *
         XC    DAIR10(16),DAIR10
         DS    0H
*         DA10CD='0010'X;               /* SET FUNC CDE       ZM00614 *
         L     @5,DAPB1PTR                                        0906
         MVC   0(2,@5),@X55                                       0906
*         DAPLPTR=ADDR(DAIRL);          /* SET LIST PTR       ZM00614 *
         LA    @F,DAIRL                                           0907
         ST    @F,DAPLPTR                                         0907
*         DAPLUPT=CPPLUPT;              /* SET UPT PTR        ZM00614 *
         LR    @2,@F                                              0908
         MVC   0(4,@2),4(@7)                                      0908
*         DAPLECT=CPPLECT;              /* SET ECT PTR        ZM00614 *
         MVC   4(4,@2),12(@7)                                     0909
*         DAPLECB=ADDR(CPECB);          /* SET ECB PTR        ZM00614 *
         LA    @F,MSGPARM+100                                     0910
         ST    @F,8(0,@2)                                         0910
*         DAPLPSCB=CPPLPSCB;            /* SET PSCB PTR       ZM00614 *
         MVC   12(4,@2),8(@7)                                     0911
*         DAPLDAPB=DAPB1PTR;            /* SET DAIR BLK PTR   ZM00614 *
         MVC   16(4,@2),DAPB1PTR                                  0912
*         DO I=1 TO 2;                  /* LOOP ON DDNAMES            *
         LA    @F,1                                               0913
         STH   @F,I                                               0913
*         IF DDNAME(I)='        '       /* IS DDNAME BLANK?           *
*            THEN GO TO EL3;            /* YES - DONT DECONCATENATE   *
@DO8FE   LH    @6,I                                               0914
         BCTR  @6,0                                               0914
         SLA   @6,3                                               0914
         L     @7,BASE                                            0914
         L     @7,284(0,@7)        DYNAM                          0914
         LA    @A,0(@6,@7)                                        0914
         CLC   0(8,@A),@C56                                       0914
         BC    08,EL3                                             0915
*         DA10DDN=DDNAME(I);            /* SET DDNAME IN BLK  ZM00614 *
         LA    @E,0(@6,@7)                                        0916
         L     @4,DAPB1PTR                                        0916
         MVC   8(8,@4),0(@E)                                      0916
*         R1=DAPLPTR;                   /* SET LIST PTR       ZM00614 *
         L     @1,DAPLPTR                                         0917
*         GEN(LINK  EP=IKJDAIR);        /* GO DECONCATENATE   ZM00614 *
         LINK  EP=IKJDAIR
         DS    0H
* EL3:    END;                          /* END OF LOOP ON DDNAMES     *
*         R13=SAVEAR2(2);               /* RESTORE REG. 13            *
EL3      LH    @F,I                                               0919
         AH    @F,@D3                                             0919
@DO8FD   STH   @F,I                                               0919
         CH    @F,@D1                                             0919
         BC    12,@DO8FE                                          0919
         L     @D,SAVEAR2+4                                       0920
*         GEN;                          /*                    @ZA31176*
         L     @E,12(0,@D)             /* RESTORE REGS       @ZA31176*/
         LM    @0,@C,20(@D)            /*                    @ZA31176*/
         DS    0H
* ENDAB1: R15=0;                        /* CONTINUE ABEND     @ZA31176*
ENDAB1   SR    @F,@F                                              0922
*         END ABEX;
@EL05    BCR   15,@E                                              0923
* FNL:    END AKJLKL01
* /* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.
* /*%INCLUDE SYSLIB  (IKJPPL  )
* /*%INCLUDE SYSLIB  (IKJDAPL )
* /*%INCLUDE SYSLIB  (IKJCPPL )
* /*%INCLUDE SYSLIB  (IKJDAP04)
* /*%INCLUDE SYSLIB  (IKJDAP08)
* /*%INCLUDE SYSLIB  (IKJDAP0C)
* /*%INCLUDE SYSLIB  (IKJDAP10)
* /*%INCLUDE SYSLIB  (IKJDAP18)
* /*%INCLUDE SYSLIB  (IKJDAP1C)
* /*%INCLUDE SYSLIB  (IKJDAP28)
* /*%INCLUDE SYSLIB  (IKJDAP34)
* /*%INCLUDE SYSLIB  (IKJDACB )
* ;
         BC    15,@EL01                                           0924
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D5      DC    F'0'
@D6      DC    F'25'
@D7      DC    F'34'
@D9      DC    F'26'
@D12     DC    F'33'
@D13     DC    F'12'
@D14     DC    F'13'
@D15     DC    F'14'
@D18     DC    F'15'
@D19     DC    F'11'
@D20     DC    F'17'
@D22     DC    F'23'
@D23     DC    F'2'
@D1      DC    H'2'
@D2      DC    H'0'
@D3      DC    H'1'
@D4      DC    H'6'
@D8      DC    H'7'
@D10     DC    H'5'
@D11     DC    H'-1'
@D16     DC    H'9'
@D17     DC    H'15'
@D21     DC    H'46'
@CLC     CLC   0(1,@A),0(@E)
@MVC     MVC   0(1,@A),0(@E)
@V1      DC    V(AKJLKMSG)
         DS    0F
@SIZ001  DC    AL1(&SPN)
         DC    AL3(@DATEND-@DATD)
         DS    0F
@C4      DC    C'LINK'
@C6      DC    C'LOAD'
@C8      DC    C'&&CS0'
@X15     DC    X'00000002'
@C17     DC    C'LKLDATTR'
@C21     DC    C'LOADLIST'
@C22     DC    C'LINKLIST'
@C23     DC    C'PRNT'
@C24     DC    C'DEFL'
@C26     DC    C'NODF'
@C27     DC    C'LOAD    '
@C29     DC    C'UTIL'
@C30     DC    C'LIBR'
@X31     DC    X'FF000000'
@C33     DC    C'SYSL'
@C38     DC    C'    '
@C39     DC    C'INPT'
@C41     DC    C'OBJ     '
@C42     DC    C'DATA    '
@C43     DC    C'CADD'
@C44     DC    C'UADD'
@C45     DC    C'SUBT'
@C46     DC    C'TEMPNAME'
@X47     DC    X'00006708'
@X48     DC    X'00000218'
@X49     DC    X'00000210'
@X50     DC    X'00000330'
@X51     DC    X'00004700'
@X52     DC    X'000047FF'
@X53     DC    X'00004714'
@C56     DC    C'        '
@X9      DC    X'0008'
@X10     DC    X'000C'
@X11     DC    X'001C'
@X12     DC    X'0004'
@X13     DC    X'0018'
@X14     DC    X'0028'
@X16     DC    X'0034'
@X55     DC    X'0010'
@C28     DC    C'&&SYSUT1'
@C32     DC    C'SYS1.'
         DS    0D
@DATA    EQU   *
BLANKS   EQU   *                   8 BYTE(S)
         DC    C' '
         DC    00007C' '
LKADCON  EQU   *                   FULLWORD POINTER
         DC    AL4(LKPARSE)
LDADCON  EQU   *                   FULLWORD POINTER
         DC    AL4(LDPARSE)
LDLNGTHO EQU   *                   9*HALFWORD INTEGER
         DC    FL2'5'
         DC    FL2'3'
         DC    00002FL2'5'
         DC    00002FL2'3'
         DC    FL2'4'
         DC    FL2'3'
         DC    FL2'4'
NCHAR    EQU   *                   15*HALFWORD INTEGER
         DC    FL2'6'
         DC    FL2'7'
         DC    FL2'6'
         DC    FL2'8'
         DC    FL2'7'
         DC    FL2'8'
         DC    FL2'5'
         DC    FL2'8'
         DC    FL2'8'
         DC    FL2'7'
         DC    FL2'9'
         DC    FL2'5'
         DC    FL2'6'
         DC    FL2'8'
         DC    FL2'7'
LIBNMS   EQU   *                   6*7 BYTE(S)
         DC    C'PL1LIB'
         DC    00001C' '
         DC    C'FORTLIB'
         DC    C'COBLIB'
         DC    00001C' '
         DC    C'PLIBASE'
         DC    C'PLICMIX'
         DC    C'PL1LIB'
         DC    00001C' '
LDOPTS   EQU   *                   9*5 BYTE(S)
         DC    C'SIZE='
         DC    C'EP='
         DC    00002C' '
         DC    C'NAME='
         DC    C'PRINT'
         DC    C'MAP'
         DC    00002C' '
         DC    C'LET'
         DC    00002C' '
         DC    C'TERM'
         DC    00001C' '
         DC    C'RES'
         DC    00002C' '
         DC    C'CALL'
         DC    00001C' '
         ORG   @DATA+00000152
LKLNGTHO EQU   *                   22*HALFWORD INTEGER
         DC    FL2'5'
         DC    FL2'3'
         DC    FL2'4'
         DC    FL2'5'
         DC    FL2'3'
         DC    00002FL2'4'
         DC    FL2'3'
         DC    00006FL2'4'
         DC    00003FL2'2'
         DC    00004FL2'4'
         DC    FL2'6'
LKOPTS   EQU   *                   22*6 BYTE(S)
         DC    C'SIZE='
         DC    00001C' '
         DC    C'AC='
         DC    00003C' '
         DC    C'DCBS'
         DC    00002C' '
         DC    C'PRINT'
         DC    00001C' '
         DC    C'MAP'
         DC    00003C' '
         DC    C'XREF'
         DC    00002C' '
         DC    C'LIST'
         DC    00002C' '
         DC    C'LET'
         DC    00003C' '
         DC    C'XCAL'
         DC    00002C' '
         DC    C'SCTR'
         DC    00002C' '
         DC    C'OVLY'
         DC    00002C' '
         DC    C'RENT'
         DC    00002C' '
         DC    C'REUS'
         DC    00002C' '
         DC    C'REFR'
         DC    00002C' '
         DC    C'NE'
         DC    00004C' '
         DC    C'OL'
         DC    00004C' '
         DC    C'DC'
         DC    00004C' '
         DC    C'TEST'
         DC    00002C' '
         DC    C'HIAR'
         DC    00002C' '
         DC    C'TERM'
         DC    00002C' '
         DC    C'NCAL'
         DC    00002C' '
         DC    C'ALIGN2'
CARDS    EQU   *                   15*9 BYTE(S)
         DC    C'ALIAS'
         DC    00004C' '
         DC    C'CHANGE'
         DC    00003C' '
         DC    C'ENTRY'
         DC    00004C' '
         DC    C'INCLUDE'
         DC    00002C' '
         DC    C'INSERT'
         DC    00003C' '
         DC    C'LIBRARY'
         DC    00002C' '
         DC    C'NAME'
         DC    00005C' '
         DC    C'OVERLAY'
         DC    00002C' '
         DC    C'REPLACE'
         DC    00002C' '
         DC    C'SETSSI'
         DC    00003C' '
         DC    C'IDENTIFY'
         DC    00001C' '
         DC    C'PAGE'
         DC    00005C' '
         DC    C'ORDER'
         DC    00004C' '
         DC    C'SETCODE'
         DC    00002C' '
         DC    C'EXPAND'
         DC    00003C' '
PATCH    EQU   @DATA+00000463      500 BYTE(S)
LKPDL    EQU   00000000            200 BYTE(S) ON WORD
A00004   EQU   LKPDL+00000000      8 BYTE(S)
LKINPUT  EQU   LKPDL+00000008      28 BYTE(S)
LKLOAD   EQU   LKPDL+00000036      2 BYTE(S)
LKLIB    EQU   LKPDL+00000038      2 BYTE(S)
LKPLI    EQU   LKPDL+00000040      2 BYTE(S)
LKFORT   EQU   LKPDL+00000042      2 BYTE(S)
LKCOB    EQU   LKPDL+00000044      2 BYTE(S)
LKPLIB   EQU   LKPDL+00000046      2 BYTE(S)
LKPLIC   EQU   LKPDL+00000048      2 BYTE(S)
LKPL1    EQU   LKPDL+00000050      2 BYTE(S)
LKSIZE   EQU   LKPDL+00000052      2 BYTE(S)
LKAC     EQU   LKPDL+00000054      2 BYTE(S)
LKDCBS   EQU   LKPDL+00000056      2 BYTE(S)
LKPRINT  EQU   LKPDL+00000058      2 BYTE(S)
LKMAP    EQU   LKPDL+00000060      2 BYTE(S)
LKXREF   EQU   LKPDL+00000062      2 BYTE(S)
LKLIST   EQU   LKPDL+00000064      2 BYTE(S)
LKLET    EQU   LKPDL+00000066      2 BYTE(S)
LKXCAL   EQU   LKPDL+00000068      2 BYTE(S)
LKSCTR   EQU   LKPDL+00000070      2 BYTE(S)
LKOVLY   EQU   LKPDL+00000072      2 BYTE(S)
LKRENT   EQU   LKPDL+00000074      2 BYTE(S)
LKREUS   EQU   LKPDL+00000076      2 BYTE(S)
LKREFR   EQU   LKPDL+00000078      2 BYTE(S)
LKNE     EQU   LKPDL+00000080      2 BYTE(S)
LKOL     EQU   LKPDL+00000082      2 BYTE(S)
LKDC     EQU   LKPDL+00000084      2 BYTE(S)
LKTEST   EQU   LKPDL+00000086      2 BYTE(S)
LKHIAR   EQU   LKPDL+00000088      2 BYTE(S)
LKTERM   EQU   LKPDL+00000090      2 BYTE(S)
LKNCAL   EQU   LKPDL+00000092      2 BYTE(S)
LKALIGN2 EQU   LKPDL+00000094      2 BYTE(S)
LKLOADDS EQU   LKPDL+00000096      24 BYTE(S)
LKPRNTDS EQU   LKPDL+00000120      24 BYTE(S)
LKLIBRDS EQU   LKPDL+00000144      28 BYTE(S)
LKSIZESF EQU   LKPDL+00000172      12 BYTE(S)
LKDCBSSF EQU   LKPDL+00000184      8 BYTE(S)
LKACSF   EQU   LKPDL+00000192      8 BYTE(S)
LDPDL    EQU   00000000            152 BYTE(S) ON WORD
A00005   EQU   LDPDL+00000000      8 BYTE(S)
LDINPUT  EQU   LDPDL+00000008      28 BYTE(S)
LDPARAM  EQU   LDPDL+00000036      8 BYTE(S)
LDLIB    EQU   LDPDL+00000044      2 BYTE(S)
LDPLI    EQU   LDPDL+00000046      2 BYTE(S)
LDFORT   EQU   LDPDL+00000048      2 BYTE(S)
LDCOB    EQU   LDPDL+00000050      2 BYTE(S)
LDPLIB   EQU   LDPDL+00000052      2 BYTE(S)
LDPLIC   EQU   LDPDL+00000054      2 BYTE(S)
LDPL1    EQU   LDPDL+00000056      2 BYTE(S)
LDSIZE   EQU   LDPDL+00000058      2 BYTE(S)
LDEP     EQU   LDPDL+00000060      2 BYTE(S)
LDNAME   EQU   LDPDL+00000062      2 BYTE(S)
LDPRINT  EQU   LDPDL+00000064      2 BYTE(S)
LDMAP    EQU   LDPDL+00000066      2 BYTE(S)
LDLET    EQU   LDPDL+00000068      2 BYTE(S)
LDTERM   EQU   LDPDL+00000070      2 BYTE(S)
LDRES    EQU   LDPDL+00000072      2 BYTE(S)
LDCALL   EQU   LDPDL+00000074      2 BYTE(S)
LDPRNTDS EQU   LDPDL+00000076      24 BYTE(S)
LDLIBRDS EQU   LDPDL+00000100      28 BYTE(S)
LDSIZESF EQU   LDPDL+00000128      8 BYTE(S)
LDEPSF   EQU   LDPDL+00000136      8 BYTE(S)
LDNAMESF EQU   LDPDL+00000144      8 BYTE(S)
LIBS     EQU   00000000            6*HALFWORD INTEGER
PARMS    EQU   00000000            22*HALFWORD INTEGER
PPL      EQU   00000000            28 BYTE(S) ON WORD
PPLUPT   EQU   PPL+00000000        FULLWORD POINTER
PPLECT   EQU   PPL+00000004        FULLWORD POINTER
PPLECB   EQU   PPL+00000008        FULLWORD POINTER
PPLPCL   EQU   PPL+00000012        FULLWORD POINTER
PPLANS   EQU   PPL+00000016        FULLWORD POINTER
PPLCBUF  EQU   PPL+00000020        FULLWORD POINTER
PPLUWA   EQU   PPL+00000024        FULLWORD POINTER
DAPL     EQU   00000000            20 BYTE(S) ON WORD
DAPLUPT  EQU   DAPL+00000000       FULLWORD POINTER
DAPLECT  EQU   DAPL+00000004       FULLWORD POINTER
DAPLECB  EQU   DAPL+00000008       FULLWORD POINTER
DAPLPSCB EQU   DAPL+00000012       FULLWORD POINTER
DAPLDAPB EQU   DAPL+00000016       FULLWORD POINTER
CPPL     EQU   00000000            16 BYTE(S) ON WORD
CPPLCBUF EQU   CPPL+00000000       FULLWORD POINTER
CPPLUPT  EQU   CPPL+00000004       FULLWORD POINTER
CPPLPSCB EQU   CPPL+00000008       FULLWORD POINTER
CPPLECT  EQU   CPPL+00000012       FULLWORD POINTER
DAPB04   EQU   00000000            16 BYTE(S) ON WORD
DA04CD   EQU   DAPB04+00000000     2 BYTE(S)
DA04FLG  EQU   DAPB04+00000002     2 BYTE(S)
A00006   EQU   DAPB04+00000002     1 BIT(S)
A00007   EQU   DAPB04+00000002     1 BIT(S)
A00008   EQU   DAPB04+00000002     1 BIT(S)
A00009   EQU   DAPB04+00000002     1 BIT(S)
A00010   EQU   DAPB04+00000002     1 BIT(S)
DA04CAT  EQU   DAPB04+00000002     1 BIT(S)
DA04DSE  EQU   DAPB04+00000002     1 BIT(S)
A00011   EQU   DAPB04+00000002     1 BIT(S)
A00012   EQU   DAPB04+00000004     2 BYTE(S)
DA04CTRC EQU   DAPB04+00000006     HALFWORD INTEGER
DA04PDSN EQU   DAPB04+00000008     FULLWORD POINTER
DA04CTL  EQU   DAPB04+00000012     1 BYTE(S)
A00013   EQU   DAPB04+00000012     1 BIT(S)
A00014   EQU   DAPB04+00000012     1 BIT(S)
DA04UID  EQU   DAPB04+00000012     1 BIT(S)
A00015   EQU   DAPB04+00000012     1 BIT(S)
A00016   EQU   DAPB04+00000012     1 BIT(S)
A00017   EQU   DAPB04+00000012     1 BIT(S)
A00018   EQU   DAPB04+00000012     1 BIT(S)
A00019   EQU   DAPB04+00000012     1 BIT(S)
A00020   EQU   DAPB04+00000013     2 BYTE(S)
DA04DSO  EQU   DAPB04+00000015     1 BYTE(S)
DAPB08   EQU   00000000            84 BYTE(S) ON WORD
DA08CD   EQU   DAPB08+00000000     2 BYTE(S)
DA08FLG  EQU   DAPB08+00000002     2 BYTE(S)
DA08FPE  EQU   DAPB08+00000002     1 BIT(S)
A00021   EQU   DAPB08+00000002     1 BIT(S)
A00022   EQU   DAPB08+00000002     1 BIT(S)
A00023   EQU   DAPB08+00000002     1 BIT(S)
A00024   EQU   DAPB08+00000002     1 BIT(S)
A00025   EQU   DAPB08+00000002     1 BIT(S)
A00026   EQU   DAPB08+00000002     1 BIT(S)
A00027   EQU   DAPB08+00000002     1 BIT(S)
DA08DARC EQU   DAPB08+00000004     HALFWORD INTEGER
DA08CTRC EQU   DAPB08+00000006     HALFWORD INTEGER
DA08PDSN EQU   DAPB08+00000008     FULLWORD POINTER
DA08DDN  EQU   DAPB08+00000012     8 BYTE(S)
DA08UNIT EQU   DAPB08+00000020     8 BYTE(S)
DA08SER  EQU   DAPB08+00000028     8 BYTE(S)
DA08BLK  EQU   DAPB08+00000036     4 BYTE(S)
DA08PQTY EQU   DAPB08+00000040     4 BYTE(S)
DA08SQTY EQU   DAPB08+00000044     4 BYTE(S)
DA08DQTY EQU   DAPB08+00000048     4 BYTE(S)
DA08MNM  EQU   DAPB08+00000052     8 BYTE(S)
DA08PSWD EQU   DAPB08+00000060     8 BYTE(S)
DA08DSP1 EQU   DAPB08+00000068     1 BYTE(S)
A00028   EQU   DAPB08+00000068     1 BIT(S)
A00029   EQU   DAPB08+00000068     1 BIT(S)
A00030   EQU   DAPB08+00000068     1 BIT(S)
A00031   EQU   DAPB08+00000068     1 BIT(S)
DA08SHR  EQU   DAPB08+00000068     1 BIT(S)
DA08NEW  EQU   DAPB08+00000068     1 BIT(S)
DA08MOD  EQU   DAPB08+00000068     1 BIT(S)
DA08OLD  EQU   DAPB08+00000068     1 BIT(S)
DA08DPS2 EQU   DAPB08+00000069     1 BYTE(S)
A00032   EQU   DAPB08+00000069     1 BIT(S)
A00033   EQU   DAPB08+00000069     1 BIT(S)
A00034   EQU   DAPB08+00000069     1 BIT(S)
A00035   EQU   DAPB08+00000069     1 BIT(S)
DA08KEEP EQU   DAPB08+00000069     1 BIT(S)
DA08DEL  EQU   DAPB08+00000069     1 BIT(S)
DA08CAT  EQU   DAPB08+00000069     1 BIT(S)
DA08UCAT EQU   DAPB08+00000069     1 BIT(S)
DA08DPS3 EQU   DAPB08+00000070     1 BYTE(S)
A00036   EQU   DAPB08+00000070     1 BIT(S)
A00037   EQU   DAPB08+00000070     1 BIT(S)
A00038   EQU   DAPB08+00000070     1 BIT(S)
A00039   EQU   DAPB08+00000070     1 BIT(S)
DA08KEP  EQU   DAPB08+00000070     1 BIT(S)
DA08DELE EQU   DAPB08+00000070     1 BIT(S)
DA08CATL EQU   DAPB08+00000070     1 BIT(S)
DA08UNCT EQU   DAPB08+00000070     1 BIT(S)
DA08CTL  EQU   DAPB08+00000071     1 BYTE(S)
DA08TRKS EQU   DAPB08+00000071     1 BIT(S)
DA08ABKL EQU   DAPB08+00000071     1 BIT(S)
DA08UID  EQU   DAPB08+00000071     1 BIT(S)
DA08RLSE EQU   DAPB08+00000071     1 BIT(S)
DA08PERM EQU   DAPB08+00000071     1 BIT(S)
DA08DMMY EQU   DAPB08+00000071     1 BIT(S)
DA08ATRL EQU   DAPB08+00000071     1 BIT(S)
A00040   EQU   DAPB08+00000071     1 BIT(S)
A00041   EQU   DAPB08+00000072     3 BYTE(S)
DA08DSO  EQU   DAPB08+00000075     1 BYTE(S)
DA08ALN  EQU   DAPB08+00000076     8 BYTE(S)
DAPB0C   EQU   00000000            12 BYTE(S) ON WORD
DA0CCD   EQU   DAPB0C+00000000     2 BYTE(S)
DA0CFLG  EQU   DAPB0C+00000002     2 BYTE(S)
DA0CDARC EQU   DAPB0C+00000004     HALFWORD INTEGER
A00042   EQU   DAPB0C+00000006     2 BYTE(S)
DA0CNUMB EQU   DAPB0C+00000008     HALFWORD INTEGER
A00043   EQU   DAPB0C+00000010     2 BYTE(S)
DAPB10   EQU   00000000            16 BYTE(S) ON WORD
DA10CD   EQU   DAPB10+00000000     2 BYTE(S)
DA10FLG  EQU   DAPB10+00000002     2 BYTE(S)
DA10DARC EQU   DAPB10+00000004     HALFWORD INTEGER
A00044   EQU   DAPB10+00000006     2 BYTE(S)
DA10DDN  EQU   DAPB10+00000008     8 BYTE(S)
DAPB18   EQU   00000000            40 BYTE(S) ON WORD
DA18CD   EQU   DAPB18+00000000     2 BYTE(S)
DA18FLG  EQU   DAPB18+00000002     2 BYTE(S)
DA18FPE  EQU   DAPB18+00000002     1 BIT(S)
A00045   EQU   DAPB18+00000002     1 BIT(S)
A00046   EQU   DAPB18+00000002     1 BIT(S)
A00047   EQU   DAPB18+00000002     1 BIT(S)
A00048   EQU   DAPB18+00000002     1 BIT(S)
A00049   EQU   DAPB18+00000002     1 BIT(S)
A00050   EQU   DAPB18+00000002     1 BIT(S)
A00051   EQU   DAPB18+00000002     1 BIT(S)
DA18DARC EQU   DAPB18+00000004     HALFWORD INTEGER
DA18CTRC EQU   DAPB18+00000006     HALFWORD INTEGER
DA18PDSN EQU   DAPB18+00000008     FULLWORD POINTER
DA18DDN  EQU   DAPB18+00000012     8 BYTE(S)
DA18MNM  EQU   DAPB18+00000020     8 BYTE(S)
DA18SCLS EQU   DAPB18+00000028     2 BYTE(S)
DA18DPS2 EQU   DAPB18+00000030     1 BYTE(S)
A00052   EQU   DAPB18+00000030     1 BIT(S)
A00053   EQU   DAPB18+00000030     1 BIT(S)
A00054   EQU   DAPB18+00000030     1 BIT(S)
A00055   EQU   DAPB18+00000030     1 BIT(S)
DA18KEEP EQU   DAPB18+00000030     1 BIT(S)
DA18DEL  EQU   DAPB18+00000030     1 BIT(S)
DA18CAT  EQU   DAPB18+00000030     1 BIT(S)
DA18UCAT EQU   DAPB18+00000030     1 BIT(S)
DA18CTL  EQU   DAPB18+00000031     1 BYTE(S)
A00056   EQU   DAPB18+00000031     1 BIT(S)
A00057   EQU   DAPB18+00000031     1 BIT(S)
DA18UID  EQU   DAPB18+00000031     1 BIT(S)
DA18PERM EQU   DAPB18+00000031     1 BIT(S)
A00058   EQU   DAPB18+00000031     1 BIT(S)
A00059   EQU   DAPB18+00000031     1 BIT(S)
A00060   EQU   DAPB18+00000031     1 BIT(S)
A00061   EQU   DAPB18+00000031     1 BIT(S)
DA18JBNM EQU   DAPB18+00000032     8 BYTE(S)
DAPB1C   EQU   00000000            24 BYTE(S) ON WORD
DA1CCD   EQU   DAPB1C+00000000     2 BYTE(S)
DA1CFLG  EQU   DAPB1C+00000002     2 BYTE(S)
DA1CDARC EQU   DAPB1C+00000004     HALFWORD INTEGER
A00062   EQU   DAPB1C+00000006     1 BYTE(S)
DA1CCTL  EQU   DAPB1C+00000007     1 BYTE(S)
A00063   EQU   DAPB1C+00000007     4 BIT(S)
DA1CPERM EQU   DAPB1C+00000007     1 BIT(S)
A00064   EQU   DAPB1C+00000007     1 BIT(S)
DA1CATRL EQU   DAPB1C+00000007     1 BIT(S)
A00065   EQU   DAPB1C+00000007     1 BIT(S)
DA1CDDN  EQU   DAPB1C+00000008     8 BYTE(S)
DA1CALN  EQU   DAPB1C+00000016     8 BYTE(S)
DAPB28   EQU   00000000            8 BYTE(S) ON WORD
DA28CD   EQU   DAPB28+00000000     2 BYTE(S)
DA28NOP  EQU   DAPB28+00000002     HALFWORD INTEGER
DA28PFOP EQU   DAPB28+00000004     FULLWORD POINTER
DA28OPTR EQU   00000008            2*FULLWORD POINTER
DAPB34   EQU   00000000            20 BYTE(S) ON WORD
DA34CD   EQU   DAPB34+00000000     2 BYTE(S)
DA34FLG  EQU   DAPB34+00000002     2 BYTE(S)
DA34FIND EQU   DAPB34+00000002     1 BIT(S)
DA34DARC EQU   DAPB34+00000004     HALFWORD INTEGER
DA34CTRL EQU   DAPB34+00000006     1 BYTE(S)
DA34SRCH EQU   DAPB34+00000006     1 BIT(S)
DA34CHN  EQU   DAPB34+00000006     1 BIT(S)
DA34UNCH EQU   DAPB34+00000006     1 BIT(S)
A00066   EQU   DAPB34+00000007     1 BYTE(S)
DA34NAME EQU   DAPB34+00000008     8 BYTE(S)
DA34ADDR EQU   DAPB34+00000016     FULLWORD POINTER
DAIRACB  EQU   00000000            47 BYTE(S) ON WORD
A00067   EQU   DAIRACB+00000000    8 BYTE(S)
DAIMASK  EQU   DAIRACB+00000008    8 BYTE(S)
A00068   EQU   DAIRACB+00000008    6 BYTE(S)
DAILABEL EQU   DAIRACB+00000014    1 BYTE(S)
DAIINOUT EQU   DAIRACB+00000014    1 BIT(S)
DAIOUTIN EQU   DAIRACB+00000014    1 BIT(S)
A00069   EQU   DAIRACB+00000015    1 BYTE(S)
A00070   EQU   DAIRACB+00000016    3 BYTE(S)
DAIEXPDT EQU   DAIRACB+00000019    3 BYTE(S)
DAIYEAR  EQU   DAIRACB+00000019    1  BYTE  POINTER
DAIDAY   EQU   DAIRACB+00000020    2  BYTE  INTEGER
A00071   EQU   DAIRACB+00000022    2 BYTE(S)
DAIBUFNO EQU   DAIRACB+00000024    1 BYTE(S)
DAIBFTEK EQU   DAIRACB+00000025    1 BYTE(S)
DAIBFALN EQU   DAIRACB+00000025    1 BYTE(S)
A00072   EQU   DAIRACB+00000025    1 BIT(S)
DAIAUTO  EQU   DAIRACB+00000025    2 BIT(S)
DAISIMPL EQU   DAIRACB+00000025    1 BIT(S)
DAIRECRD EQU   DAIRACB+00000025    1 BIT(S)
DAIEXC   EQU   DAIRACB+00000025    1 BIT(S)
A00073   EQU   DAIRACB+00000025    2 BIT(S)
DAIDOUBL EQU   DAIRACB+00000025    1 BIT(S)
DAIFULL  EQU   DAIRACB+00000025    1 BIT(S)
DAIBUFL  EQU   DAIRACB+00000026    HALFWORD INTEGER
DAIEROPT EQU   DAIRACB+00000028    1 BYTE(S)
DAIACEPT EQU   DAIRACB+00000028    1 BIT(S)
DAISKIP  EQU   DAIRACB+00000028    1 BIT(S)
DAIABNOR EQU   DAIRACB+00000028    1 BIT(S)
DAIKEYLE EQU   DAIRACB+00000029    1 BYTE(S)
A00074   EQU   DAIRACB+00000030    6 BYTE(S)
DAIRECFM EQU   DAIRACB+00000036    1 BYTE(S)
DAIUNDEF EQU   DAIRACB+00000036    2 BIT(S)
DAIFIXED EQU   DAIRACB+00000036    1 BIT(S)
DAIVARIB EQU   DAIRACB+00000036    1 BIT(S)
DAITRKOV EQU   DAIRACB+00000036    1 BIT(S)
DAIBLOCK EQU   DAIRACB+00000036    1 BIT(S)
DAISTAND EQU   DAIRACB+00000036    1 BIT(S)
DAIASA   EQU   DAIRACB+00000036    1 BIT(S)
DAIMACH  EQU   DAIRACB+00000036    1 BIT(S)
DAIOPTCD EQU   DAIRACB+00000037    1 BYTE(S)
DAIWRTCK EQU   DAIRACB+00000037    1 BIT(S)
A00075   EQU   DAIRACB+00000037    1 BIT(S)
DAISCHED EQU   DAIRACB+00000037    1 BIT(S)
A00076   EQU   DAIRACB+00000037    1 BIT(S)
DAIANSI  EQU   DAIRACB+00000037    1 BIT(S)
A00077   EQU   DAIRACB+00000037    1 BIT(S)
DAIUSERT EQU   DAIRACB+00000037    1 BIT(S)
DAIBLKSI EQU   DAIRACB+00000038    HALFWORD INTEGER
DAILRECL EQU   DAIRACB+00000040    HALFWORD INTEGER
DAINCP   EQU   DAIRACB+00000042    1 BYTE(S)
A00078   EQU   DAIRACB+00000043    4 BYTE(S)
DSNAME   EQU   00000000            46 BYTE(S) ON WORD
DSNLNGTH EQU   DSNAME+00000000     HALFWORD INTEGER
DSNM     EQU   DSNAME+00000002     44 BYTE(S)
DATASET  EQU   00000000            28 BYTE(S) ON WORD
DSN      EQU   DATASET+00000000    FULLWORD POINTER
DSL      EQU   DATASET+00000004    HALFWORD INTEGER
DSF      EQU   DATASET+00000006    16 BIT(S)
MEM      EQU   DATASET+00000008    FULLWORD POINTER
MEML     EQU   DATASET+00000012    HALFWORD INTEGER
MEMF     EQU   DATASET+00000014    16 BIT(S)
PASS     EQU   DATASET+00000016    FULLWORD POINTER
PASSL    EQU   DATASET+00000020    HALFWORD INTEGER
PASSF    EQU   DATASET+00000022    16 BIT(S)
NEXT     EQU   DATASET+00000024    FULLWORD POINTER
CBUF     EQU   00000000            5 BYTE(S) ON WORD
CBUGLNG  EQU   CBUF+00000000       HALFWORD POINTER
CBUFOFF  EQU   CBUF+00000002       HALFWORD POINTER
CBUFDATA EQU   CBUF+00000004       1 BYTE(S)
SAVEPRM  EQU   00000000            16 BYTE(S) ON WORD
BASEREG  EQU   SAVEPRM+00000000    3*FULLWORD INTEGER
DATAREG  EQU   SAVEPRM+00000012    FULLWORD INTEGER
CHARST   EQU   00000000            80 BYTE(S)
STRING   EQU   00000000            12 BYTE(S) ON WORD
STR      EQU   STRING+00000000     FULLWORD POINTER
STRL     EQU   STRING+00000004     HALFWORD INTEGER
STRF     EQU   STRING+00000006     16 BIT(S)
NSTRNG   EQU   STRING+00000008     FULLWORD POINTER
DYNAM    EQU   00000000            296 BYTE(S) ON WORD
DSCONC   EQU   DYNAM+00000000      16 BYTE(S) ON WORD
INPT     EQU   DYNAM+00000000      8 BYTE(S)
LIBY     EQU   DYNAM+00000008      8 BYTE(S)
DDLEN    EQU   DYNAM+00000016      HALFWORD INTEGER
DDNMS    EQU   DYNAM+00000018      96 BYTE(S)
SYSLIN   EQU   DYNAM+00000018      8 BYTE(S)
MEMBER   EQU   DYNAM+00000026      8 BYTE(S)
SYSLMOD  EQU   DYNAM+00000034      8 BYTE(S)
SYSLIB   EQU   DYNAM+00000042      8 BYTE(S)
A00079   EQU   DYNAM+00000050      8 BYTE(S)
SYSPRNT  EQU   DYNAM+00000058      8 BYTE(S)
A00080   EQU   DYNAM+00000066      8 BYTE(S)
SYSUT1   EQU   DYNAM+00000074      8 BYTE(S)
A00081   EQU   DYNAM+00000082      8 BYTE(S)
A00082   EQU   DYNAM+00000090      8 BYTE(S)
A00083   EQU   DYNAM+00000098      8 BYTE(S)
SYSTERM  EQU   DYNAM+00000106      8 BYTE(S)
OPLEN    EQU   DYNAM+00000114      HALFWORD INTEGER
OPLIST   EQU   DYNAM+00000116      160 BYTE(S)
OUTPARM  EQU   DYNAM+00000276      20 BYTE(S) ON WORD
LKLD     EQU   DYNAM+00000276      4 BYTE(S)
TMPPTR   EQU   DYNAM+00000280      FULLWORD POINTER
CONCAT   EQU   DYNAM+00000284      FULLWORD POINTER
OPTPTR   EQU   DYNAM+00000288      FULLWORD POINTER
DDPTR    EQU   DYNAM+00000292      FULLWORD POINTER
ENDBIT   EQU   DYNAM+00000292      1 BIT(S)
DDNAME   EQU   00000000            2*8 BYTE(S)
R9       EQU   00000009            FULLWORD POINTER REGISTER
R8       EQU   00000008            FULLWORD POINTER REGISTER
R11      EQU   00000011            FULLWORD POINTER REGISTER
R1       EQU   00000001            FULLWORD POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD POINTER REGISTER
R12      EQU   00000012            FULLWORD POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
R15      EQU   00000015            FULLWORD POINTER REGISTER
PARML    EQU   00000000            8 BYTE(S) ON WORD
PDE      EQU   PARML+00000000      FULLWORD POINTER
USERAREA EQU   PARML+00000004      FULLWORD POINTER
FPTR     EQU   00000008            FULLWORD POINTER
TYPE     EQU   00000000            4 BYTE(S)
PARMA    EQU   00000000            8 BYTE(S) ON WORD
P1       EQU   PARMA+00000000      FULLWORD POINTER
P2       EQU   PARMA+00000004      FULLWORD POINTER
WORKAREA EQU   00000000            8 BYTE(S) ON WORD
PARMSREG EQU   WORKAREA+00000000   FULLWORD POINTER
ABCODE   EQU   WORKAREA+00000004   FULLWORD INTEGER
ECTBLK   EQU   00000000            4 BYTE(S) ON WORD
ECTRTCD  EQU   ECTBLK+00000000     FULLWORD INTEGER
ECTRCDF  EQU   ECTBLK+00000000     1 BIT(S)
FPTR2    EQU   00000008            FULLWORD POINTER
R0       EQU   00000000            FULLWORD INTEGER REGISTER
         ORG   @DATA
         DS    00000963C
@L       EQU   1
@DATD    DSECT
@SAV001  EQU   @DATD+00000000      72 BYTE(S) ON WORD
DAPB1PTR EQU   @DATD+00000072      FULLWORD POINTER
DAPB2PTR EQU   @DATD+00000076      FULLWORD POINTER
DAPB3PTR EQU   @DATD+00000080      FULLWORD POINTER
DACBPTR  EQU   @DATD+00000084      FULLWORD POINTER
PPLPTR   EQU   @DATD+00000088      FULLWORD POINTER
DAPLPTR  EQU   @DATD+00000092      FULLWORD POINTER
CBUFPTR  EQU   @DATD+00000096      FULLWORD POINTER
PRINT    EQU   @DATD+00000100      HALFWORD INTEGER
LIB      EQU   @DATD+00000102      HALFWORD INTEGER
TERM     EQU   @DATD+00000104      HALFWORD INTEGER
MSGPARM  EQU   @DATD+00000108      108 BYTE(S) ON WORD
DAPB0PTR EQU   MSGPARM+00000000    FULLWORD POINTER
PROMPTM  EQU   MSGPARM+00000004    HALFWORD INTEGER
RCODE    EQU   MSGPARM+00000006    HALFWORD INTEGER
ERRCODE  EQU   MSGPARM+00000008    HALFWORD INTEGER
BUFLN    EQU   MSGPARM+00000010    HALFWORD INTEGER
INBUF    EQU   MSGPARM+00000012    80 BYTE(S)
DSPTR    EQU   MSGPARM+00000092    FULLWORD POINTER
PTR1     EQU   MSGPARM+00000096    FULLWORD POINTER
CPECB    EQU   MSGPARM+00000100    FULLWORD INTEGER
CPPLPTR  EQU   MSGPARM+00000104    FULLWORD POINTER
CODEBYT  EQU   MSGPARM+00000104    1 BYTE(S)
DAIR04   EQU   @DATD+00000216      16 BYTE(S) ON WORD
DAIR08   EQU   @DATD+00000232      84 BYTE(S) ON WORD
DAIR18   EQU   @DATD+00000316      40 BYTE(S) ON WORD
DAIR1C   EQU   @DATD+00000356      24 BYTE(S) ON WORD
DAIR28   EQU   @DATD+00000380      16 BYTE(S) ON WORD
DAIR34   EQU   @DATD+00000396      20 BYTE(S) ON WORD
DAIRATCB EQU   @DATD+00000416      47 BYTE(S) ON WORD
DAIR0C   EQU   @DATD+00000464      212 BYTE(S) ON WORD
A00000   EQU   DAIR0C+00000000     12 BYTE(S)
DA0CDDN  EQU   DAIR0C+00000012     25*8 BYTE(S)
DAIRL    EQU   @DATD+00000676      20 BYTE(S) ON WORD
PARSEL   EQU   @DATD+00000696      28 BYTE(S) ON WORD
NM       EQU   @DATD+00000724      2*46 BYTE(S) ON HWORD
DEFAULT  EQU   @DATD+00000816      54 BYTE(S) ON WORD
DEFLEN   EQU   DEFAULT+00000000    HALFWORD INTEGER
DEFNME   EQU   DEFAULT+00000002    44 BYTE(S)
DEFMEM   EQU   DEFAULT+00000046    8 BYTE(S)
A00001   EQU   @DATD+00000872      9 BYTE(S) ON WORD
DOT      EQU   A00001+00000000     1 BYTE(S)
QUAL     EQU   A00001+00000001     8 BYTE(S)
LQUAL    EQU   @DATD+00000882      HALFWORD INTEGER
MES      EQU   @DATD+00000884      FULLWORD INTEGER
LSTPTR   EQU   @DATD+00000888      FULLWORD POINTER
INDCB    EQU   @DATD+00000892      100 BYTE(S) ON WORD
BASE     EQU   @DATD+00000992      FULLWORD POINTER
BEG      EQU   @DATD+00000996      HALFWORD INTEGER
ENDD     EQU   @DATD+00000998      HALFWORD INTEGER
I        EQU   @DATD+00001000      HALFWORD INTEGER
K        EQU   @DATD+00001002      HALFWORD INTEGER
J        EQU   @DATD+00001004      HALFWORD INTEGER
N        EQU   @DATD+00001006      HALFWORD INTEGER
VALREG   EQU   @DATD+00001008      16 BYTE(S) ON WORD
OPTSTPTR EQU   @DATD+00001024      FULLWORD POINTER
PTR3     EQU   @DATD+00001028      FULLWORD POINTER
PDLPTR   EQU   @DATD+00001032      FULLWORD POINTER
DMLIST   EQU   @DATD+00001036      4 BYTE(S) ON WORD
OPTBYT   EQU   DMLIST+00000000     1 BYTE(S)
DCBADDR  EQU   DMLIST+00000001     3  BYTE  POINTER ON WORD+1
BLK1     EQU   @DATD+00001040      5 BYTE(S)
BLK2     EQU   @DATD+00001048      4  BYTE  INTEGER ON DWORD
DCBSBLK  EQU   @DATD+00001052      FULLWORD INTEGER
CSNAME   EQU   @DATD+00001056      FULLWORD INTEGER
CHAREND  EQU   @DATD+00001060      HALFWORD INTEGER
STAEL    EQU   @DATD+00001064      16 BYTE(S) ON WORD
EXADD    EQU   STAEL+00000000      FULLWORD POINTER
PRMADD   EQU   STAEL+00000004      FULLWORD POINTER
A00002   EQU   STAEL+00000008      FULLWORD POINTER
A00003   EQU   STAEL+00000012      FULLWORD POINTER
SAVEAR   EQU   @DATD+00001080      18*FULLWORD INTEGER
Q04      EQU   @DATD+00001152      2*HALFWORD INTEGER
LNG      EQU   @DATD+00001156      HALFWORD INTEGER
PTR      EQU   @DATD+00001160      FULLWORD POINTER
@SAV004  EQU   @DATD+00001164      72 BYTE(S) ON WORD
PARMPTR  EQU   @DATD+00001236      FULLWORD POINTER
TYPE1    EQU   @DATD+00001240      4 BYTE(S)
TYPE2    EQU   @DATD+00001244      4 BYTE(S)
TADD     EQU   @DATD+00001248      4 BYTE(S)
PTR2     EQU   @DATD+00001252      FULLWORD POINTER
BLDLST   EQU   @DATD+00001256      18 BYTE(S) ON WORD
FF       EQU   BLDLST+00000000     HALFWORD INTEGER
LLL      EQU   BLDLST+00000002     HALFWORD INTEGER
NAME1    EQU   BLDLST+00000004     8 BYTE(S)
A00084   EQU   BLDLST+00000012     2 BYTE(S)
R        EQU   BLDLST+00000014     1 BYTE(S)
A00085   EQU   BLDLST+00000015     3 BYTE(S)
SAVEAR2  EQU   @DATD+00001276      18*FULLWORD INTEGER
DAIR10   EQU   @DATD+00001348      16 BYTE(S) ON WORD
         DS    00001364C
@TEMPS   DS    0F
         DS    C
@PL001   DS    02F
@PL002   DS    02F
@PL004   DS    02F
STAKBLK  STACK MF=L
AKJLKL01 CSECT
@DATD    DSECT
@DATEND  EQU   *
AKJLKL01 CSECT ,
@9D0     EQU   LDCH
@99F     EQU   @99E
@99C     EQU   COMM
@996     EQU   EL2
@987     EQU   CLS
@974     EQU   ERR
@954     EQU   EQCH
@914     EQU   PRNTM
@912     EQU   LNK
@90C     EQU   ENDAL
FNL      EQU   @EL01
         END   AKJLKL01,(C'PL/S',1400,78207)

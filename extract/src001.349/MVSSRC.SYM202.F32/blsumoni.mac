MONI     TITLE 'BLSUMONI--IPCS TERMINAL ATTENTION (STAX) EXIT          *
                        '
*/* CHANGE ACTIVITY -------------------------------------------------*/
*/*   THIS MODULE WAS WRITTEN FOR @G57LPJM                           */
*/*   THIS MODULE WAS CHANGED FOR @ZA31999                   @ZA31999*/
*/*------------------------------------------------------------------*/
BLSUMONI CSECT ,                                                01S0002
@MAINENT DS    0H                                               01S0002
         USING *,@15                                            01S0002
         B     @PROLOG                                          01S0002
         DC    AL1(16)                                          01S0002
         DC    C'BLSUMONI  78.117'                              01S0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0002
         BALR  @12,0                                            01S0002
@PSTART  DS    0H                                               01S0002
         USING @PSTART,@12                                      01S0002
         L     @00,@SIZDATD                                     01S0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                          01S0002
         USING @DATD,@11                                        01S0002
         ST    @13,@SA00001+4                                   01S0002
         LM    @00,@01,20(@13)                                  01S0002
         ST    @11,8(,@13)                                      01S0002
         LR    @13,@11                                          01S0002
*   R9=PARMZZ2;                     /* ->ZZ2 (MACRO BLSUZZ2)         */
         L     R9,PARMZZ2(,R1)                                  01S0086
*   RESPECIFY                                                   01S0087
*    (R1) UNRESTRICTED;             /* ->PARAMETER LIST              */
*   RA=ZZ2ZZ1P;                     /* ->ZZ1 (MACRO BLSUZZ1)         */
         L     RA,ZZ2ZZ1P(,R9)                                  01S0088
*                                                               02S0089
*/*------------------------------------------------------------------*/
*/* BLSUMON1--MONITOR INITIALIZATION                                 */
*/*------------------------------------------------------------------*/
*                                                               02S0089
*   DO;                             /* MONITOR INITIALIZATION        */
*     FLAG='00'X;                   /* PROCESSING CONTROL FLAGS      */
         MVI   FLAG,X'00'                                       02S0090
*     IOPLUPT=ADDR(UPT);            /* ADDR OF USER PROFILE TABLE    */
         MVC   IOPLUPT(4),CPPLUPT(R9)                           02S0091
*     IOPLECT=ADDR(ECT);            /* ADDR OF ENVIRONMENT CNTRL TBL */
         MVC   IOPLECT(4),CPPLECT(R9)                           02S0092
*     CSPLOA=ADDR(CSOA);            /* ->COMMAND SCAN OUTPUT AREA    */
         LA    @08,CSOA                                         02S0093
         ST    @08,CSPLOA                                       02S0093
*     GENERATE CODE(MVC   ADATA(ADATAEND-ADATA),SDATA);         02S0094
         MVC   ADATA(ADATAEND-ADATA),SDATA
*     CMDP=ZZZNULL;                 /* NO COMMAND BUFFER             */
         L     CMDP,@CF00058                                    02S0095
*   END;                            /* END OF BLSUMON1               */
*   RESPECIFY                                                   01S0097
*     CMD BASED(CMDP);              /* COMMAND BUFFER                */
*   RESPECIFY                                                   01S0098
*    (R0,                           /* TGET/TPUT INTERFACE REGISTER  */
*     R1,                           /* TGET/TPUT INTERFACE REGISTER  */
*     RF) RESTRICTED;               /* TGET/TPUT INTERFACE REGISTER  */
*   IF ZZ2AFFS=ZZZ1 THEN            /* FULL SCREEN MODE      @ZA31999*/
*                                                               01S0099
         TM    ZZ2AFFS(R9),B'00100000'                          01S0099
         BNO   @RF00099                                         01S0099
*     /***************************************************************/
*     /*                                                             */
*     /* FULL SCREEN MODE                                    @ZA31999*/
*     /*                                                             */
*     /***************************************************************/
*                                                               01S0100
*     DO;                           /* FULL SCREEN MODE      @ZA31999*/
*       FLAGFFS=ZZZ1;               /* SAVE FULL SCREEN INDICATOR    */
         OI    FLAGFFS,B'00100000'                              01S0101
*       ZZ2AFFS=ZZZ0;               /* RESET FULL SCREEN INDICATOR   */
         NI    ZZ2AFFS(R9),B'11011111'                          01S0102
*       LM(R0,R1,TPUTEXIT);         /* REGISTERS FOR TEXIT MESSAGE   */
         LM    R0,R1,TPUTEXIT                                   01S0103
*       GENERATE CODE(TPUT  (1),(0),R);/* TRANSMIT TEXIT MESSAGE     */
         TPUT  (1),(0),R
*       IF RF^=0 THEN               /* MESSAGE NOT TRANSMITTED       */
*                                                               01S0105
         LTR   RF,RF                                            01S0105
         BZ    @RF00105                                         01S0105
*         /***********************************************************/
*         /*                                                         */
*         /* MESSAGE NOT TRANSMITTED                         @ZA31999*/
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0106
*         DO;                       /* MESSAGE NOT TRANSMITTED       */
*           IF RF^=8 THEN           /* ATTENTION IS NOT AN ERROR     */
         CH    RF,@CH00046                                      01S0107
         BE    @RF00107                                         01S0107
*             FLAGERR=ZZZ1;         /* MONITOR ERROR CONDITION       */
         OI    FLAGERR,B'01000000'                              01S0108
*           GO TO EXIT;             /* COMMON EXIT PATH      @ZA31999*/
         B     EXIT                                             01S0109
*         END;                      /* MESSAGE NOT TRANSMITTED       */
*       IF                          /* STLINENO REQUIRED     @ZA31999*/
*           ZZ1FACCM=ZZZ0×          /* ACCESS METHOD NOT DETERMINED  */
*           ZZ1FTCAM=ZZZ0 THEN      /* VTAM/TIOC ACCESS METHOD       */
*                                                               01S0111
@RF00105 TM    ZZ1FACCM(RA),B'11000000'                         01S0111
         BO    @RF00111                                         01S0111
*         /***********************************************************/
*         /*                                                         */
*         /* STLINENO REQUIRED                               @ZA31999*/
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0112
*         DO;                       /* STLINENO REQUIRED     @ZA31999*/
*           LM(R0,R1,STLINENO);     /* REGISTERS FOR STLINENO        */
         LM    R0,R1,STLINENO                                   01S0113
*           SVC(94);                /* STLINENO LINE=2,MODE=OFF      */
         SVC   94                                               01S0114
*           IF RF=0 THEN            /* VTAM/TIOC ACCESS METHOD       */
*                                                               01S0115
         LTR   RF,RF                                            01S0115
         BNZ   @RF00115                                         01S0115
*             /*******************************************************/
*             /*                                                     */
*             /* VTAM/TIOC ACCESS METHOD                     @ZA31999*/
*             /*                                                     */
*             /*******************************************************/
*                                                               01S0116
*             DO;                   /* VTAM/TIOC ACCESS METHOD       */
*               ZZ1FACCM=ZZZ1;      /* ACCESS METHOD DETERMINED      */
*               ZZ1FTCAM=ZZZ0;      /* VTAM/TIOC ACCESS METHOD       */
         OI    ZZ1FACCM(RA),B'10000000'                         01S0118
         NI    ZZ1FTCAM(RA),B'10111111'                         01S0118
*             END;                  /* VTAM/TIOC ACCESS METHOD       */
*           ELSE                    /* STLINENO NOT SUCCESSFUL       */
*             IF RF=8 THEN          /* TCAM/TIOC ACCESS METHOD       */
*                                                               01S0120
         B     @RC00115                                         01S0120
@RF00115 CH    RF,@CH00046                                      01S0120
         BNE   @RF00120                                         01S0120
*               /*****************************************************/
*               /*                                                   */
*               /* TCAM/TIOC ACCESS METHOD                   @ZA31999*/
*               /*                                                   */
*               /*****************************************************/
*                                                               01S0121
*               DO;                 /* TCAM/TIOC ACCESS METHOD       */
*                 ZZ1FACCM=ZZZ1;    /* ACCESS METHOD DETERMINED      */
*                 ZZ1FTCAM=ZZZ1;    /* TCAM/TIOC ACCESS METHOD       */
         OI    ZZ1FACCM(RA),B'11000000'                         01S0123
*               END;                /* TCAM/TIOC ACCESS METHOD       */
*             ELSE                  /* STLINENO ERROR        @ZA31999*/
*                                                               01S0125
*               /*****************************************************/
*               /*                                                   */
*               /* STLINENO ERROR                            @ZA31999*/
*               /*                                                   */
*               /*****************************************************/
*                                                               01S0125
*               DO;                 /* STLINENO ERROR        @ZA31999*/
         B     @RC00120                                         01S0125
@RF00120 DS    0H                                               01S0126
*                 FLAGERR=ZZZ1;     /* MONITOR ERROR CONDITION       */
         OI    FLAGERR,B'01000000'                              01S0126
*                 GO TO EXIT;       /* COMMON EXIT PATH      @ZA31999*/
         B     EXIT                                             01S0127
*               END;                /* STLINENO ERROR        @ZA31999*/
*         END;                      /* STLINENO REQUIRED     @ZA31999*/
@RC00120 DS    0H                                               01S0129
@RC00115 DS    0H                                               01S0130
*     END;                          /* FULL SCREEN MODE      @ZA31999*/
@RF00111 DS    0H                                               01S0131
*   LM(R0,R1,TPUTMODE);             /* REGISTERS FOR MODE MESSAGE    */
@RF00099 LM    R0,R1,TPUTMODE                                   01S0131
*   GENERATE CODE(TPUT  (1),(0),R); /* TRANSMIT MODE MESSAGE @ZA31999*/
         TPUT  (1),(0),R
*   IF RF^=0 THEN                   /* MESSAGE NOT TRANSMITTED       */
         LTR   RF,RF                                            01S0133
         BNZ   @RT00133                                         01S0133
*     GO TO EXIT;                   /* COMMON EXIT PATH      @ZA31999*/
*   LM(R0,R1,TGETRESP);             /* REGISTERS FOR RESPONSE        */
         LM    R0,R1,TGETRESP                                   01S0135
*   R1=R1×ADDR(TGETBUF);            /* ->DUMMY INPUT BUFFER  @ZA31999*/
         LA    @14,TGETBUF                                      01S0136
         OR    R1,@14                                           01S0136
*   GENERATE CODE(TGET  (1),(0),R); /* VERIFY NON-NULL RESPONSE      */
         TGET  (1),(0),R
*   IF RF^=12 THEN                  /* NULL OR ERROR RESPONSE        */
*                                                               01S0138
         CH    RF,@CH00033                                      01S0138
         BE    @RF00138                                         01S0138
*     /***************************************************************/
*     /*                                                             */
*     /* NULL OR ERROR RESPONSE                              @ZA31999*/
*     /*                                                             */
*     /***************************************************************/
*                                                               01S0139
*     DO;                           /* NULL OR ERROR RESPONSE        */
*       IF RF=0 THEN                /* NULL LINE REQUIRES TCLEARQ    */
         LTR   RF,RF                                            01S0140
         BNZ   @RF00140                                         01S0140
*         GENERATE CODE(TCLEARQ INPUT);/* ELIMINATE RESIDUAL INPUT   */
         TCLEARQ INPUT
*       ELSE                        /* MONITOR ERROR CONDITION       */
*         IF RF^=8 THEN             /* ATTENTION IS NOT AN ERROR     */
         B     @RC00140                                         01S0142
@RF00140 CH    RF,@CH00046                                      01S0142
         BE    @RF00142                                         01S0142
*           FLAGERR=ZZZ1;           /* MONITOR ERROR CONDITION       */
         OI    FLAGERR,B'01000000'                              01S0143
*       GO TO EXIT;                 /* COMMON EXIT PATH      @ZA31999*/
         B     EXIT                                             01S0144
*     END;                          /* NULL OR ERROR RESPONSE        */
*   RESPECIFY                       /*                       @ZA31999*/
*    (R0,                           /* TGET/TPUT INTERFACE REGISTER  */
*     R1,                           /* TGET/TPUT INTERFACE REGISTER  */
*     RF) UNRESTRICTED;             /* TGET/TPUT INTERFACE REGISTER  */
@RF00138 DS    0H                                               01S0147
*/*------------------------------------------------------------------*/
*/* ITERATIVELY GET LOGICAL LINES FROM THE TERMINAL UNTIL A          */
*/* WELL-FORMED REQUEST IS DETECTED                                  */
*/*------------------------------------------------------------------*/
*                                                               01S0147
*   DO WHILE(FLAGEND=ZZZ0);         /* ITERATIVELY GET COMMANDS      */
         B     @DE00147                                         01S0147
@DL00147 DS    0H                                               01S0148
*     IOPLECB=ADDR(0);              /* INITIALIZE IOPL               */
         LA    @08,@CF00043                                     01S0148
         ST    @08,IOPLECB                                      01S0148
*     IOPLIOPB=ADDR(PGPB);          /* ->PUTGET PARAMETER BLOCK      */
         LA    @08,PGPB                                         01S0149
         ST    @08,IOPLIOPB                                     01S0149
*                                                               02S0150
*/********************************************************************/
*/*                                                                  */
*/* BLSUMONO--PUT MODE MESSAGE, GET COMMAND                          */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0150
*   DO;                             /* BLSUMONO                      */
*     RESPECIFY                                                 02S0151
*      (R1) RESTRICTED;             /* ->IOPL                        */
*     R1=ADDR(IOPL);                /* ->IOPL                        */
         LA    R1,IOPL                                          02S0152
*     RESPECIFY                                                 02S0153
*      (RF) RESTRICTED;             /* RETURN CODE                   */
*     CALL IKJPTGT;                 /* PUTGET TSO SERVICE ROUTINE    */
         L     @15,ZZ2PTGTP(,R9)                                02S0154
         BALR  @14,@15                                          02S0154
*     RESPECIFY                                                 02S0155
*      (R1) UNRESTRICTED;           /* ->IOPL                        */
*     RETCPTGT=RF;                  /* IKJPTGT RETURN CODE           */
         LR    RETCPTGT,RF                                      02S0156
*     RESPECIFY                                                 02S0157
*      (RF) UNRESTRICTED;           /* RETURN CODE                   */
*     CMDP=PGPBIBUF;                /* ->COMMAND BUFFER              */
         L     CMDP,PGPBIBUF                                    02S0158
*   END;                            /* END OF BLSUMONO               */
*                                                               02S0160
*/*------------------------------------------------------------------*/
*/* BLSUMONS--SCAN COMMAND BUFFER                                    */
*/*------------------------------------------------------------------*/
*                                                               02S0160
*   DO;                             /* BLSUMONS                      */
*     FLAGSCAN='0'B;                /* ANTICIPATE INVALID COMMAND    */
         NI    FLAGSCAN,B'11101111'                             02S0161
*     IF RETCPTGT>12 THEN           /* SERIOUS IKJPTGT ERROR         */
*                                                               02S0162
         CH    RETCPTGT,@CH00033                                02S0162
         BNH   @RF00162                                         02S0162
*       /*************************************************************/
*       /*                                                           */
*       /* SERIOUS IKJPTGT ERROR                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0163
*       DO;                         /* SERIOUS IKJPTGT ERROR         */
*         FLAGEND='1'B;             /* TERMINATE                     */
*         FLAGERR='1'B;             /* ERROR                         */
         OI    FLAGEND,B'11000000'                              02S0165
*       END;                        /* SERIOUS IKJPTGT ERROR         */
*     IF RETCPTGT=12 THEN           /* 2ND LEVEL MSGS WILL NOT BE
*                                      AVAILABLE TO THE USER         */
@RF00162 CH    RETCPTGT,@CH00033                                02S0167
         BNE   @RF00167                                         02S0167
*       ECTMSGF=ECTMSGF×'80'X;      /* SCHEDULE 2ND LEVEL MSG PURGE  */
         L     @08,CPPLECT(,R9)                                 02S0168
         OI    ECTMSGF(@08),X'80'                               02S0168
*     IF RETCPTGT<8 THEN            /* COMMAND LINE OBTAINED         */
*                                                               02S0169
@RF00167 CH    RETCPTGT,@CH00046                                02S0169
         BNL   @RF00169                                         02S0169
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESS COMMAND THROUGH TSO COMMAND SCAN SERVICE ROUTINE  */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0170
*       DO;                         /* COMMAND LINE OBTAINED         */
*         CSPLCBUF=CMDP;            /* ->COMMAND BUFFER              */
         ST    CMDP,CSPLCBUF                                    02S0171
*         CALL BLSUMON2(ZZ2,CSPL);  /* SCAN COMMAND BUFFER           */
         ST    R9,@AL00001                                      02S0172
         LA    @08,CSPL                                         02S0172
         ST    @08,@AL00001+4                                   02S0172
         L     @08,ZZ2BVTP(,R9)                                 02S0172
         L     @15,BVTMON2P(,@08)                               02S0172
         LA    @01,@AL00001                                     02S0172
         BALR  @14,@15                                          02S0172
*         RESPECIFY                                             02S0173
*          (RF) RESTRICTED;         /* BLSUMON2 RETURN CODE          */
*         IF RF=ZZZFLAGI THEN       /* VALID COMMAND SCAN RESULT     */
         LTR   RF,RF                                            02S0174
         BNZ   @RF00174                                         02S0174
*           FLAGSCAN='1'B;          /* VALID COMMAND SCAN RESULT     */
         OI    FLAGSCAN,B'00010000'                             02S0175
*         ELSE                      /* UNSUCCESSFUL COMMAND SCAN     */
*           IF RF=ZZZFLAGT THEN     /* COMMAND SCAN ERROR            */
*                                                               02S0176
         B     @RC00174                                         02S0176
@RF00174 CH    RF,@CH00049                                      02S0176
         BNE   @RF00176                                         02S0176
*             /*******************************************************/
*             /*                                                     */
*             /* COMMAND SCAN ERROR                                  */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0177
*             DO;                   /* COMMAND SCAN ERROR            */
*               FLAGEND='1'B;       /* TERMINATE                     */
*               FLAGERR='1'B;       /* ERROR                         */
         OI    FLAGEND,B'11000000'                              02S0179
*             END;                  /* COMMAND SCAN ERROR            */
*         RESPECIFY                                             02S0181
*          (RF) UNRESTRICTED;       /* BLSUMON2 RETURN CODE          */
@RF00176 DS    0H                                               02S0181
@RC00174 DS    0H                                               02S0182
*       END;                        /* COMMAND LINE OBTAINED         */
*     ELSE                          /* ATTENTION INTERRUPTED IKJPTGT */
*       CMDP=ZZZNULL;               /* NO SUBCOMMAND BUFFER          */
         B     @RC00169                                         02S0183
@RF00169 L     CMDP,@CF00058                                    02S0183
*   END;                            /* END OF BLSUMONS               */
@RC00169 DS    0H                                               02S0185
*     IF FLAGSCAN=ZZZ1 THEN         /* COMMAND LINE OBTAINED         */
*                                                               01S0185
         TM    FLAGSCAN,B'00010000'                             01S0185
         BNO   @RF00185                                         01S0185
*       /*************************************************************/
*       /*                                                           */
*       /* COMMAND LINE OBTAINED                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                               01S0186
*       DO;                         /* COMMAND LINE OBTAINED         */
*         IF CSOANOC=ZZZ0 THEN      /* IS IT A NON-NULL LINE?        */
*                                                               01S0187
         TM    CSOANOC,B'00010000'                              01S0187
         BNZ   @RF00187                                         01S0187
*           /*********************************************************/
*           /*                                                       */
*           /* NON-NULL LINE                                         */
*           /*                                                       */
*           /*********************************************************/
*                                                               01S0188
*           DO;                     /* NON-NULL LINE                 */
*             IF                    /* TIME COMMAND                  */
*                 CSOAEXEC=ZZZ0&    /* NOT PREFIXED BY PERCENT SIGN  */
*                 CSOALNM=LENGTH('ABEND')&CSOACN(1:LENGTH('ABEND'))=
*                 'ABEND' THEN      /* ABEND COMMAND                 */
*                                                               01S0189
         TM    CSOAEXEC,B'00000100'                             01S0189
         BNZ   @RF00189                                         01S0189
         CLC   CSOALNM(2),@CH00090                              01S0189
         BNE   @RF00189                                         01S0189
         L     @08,CSOACNM                                      01S0189
         CLC   CSOACN(5,@08),@CC00803                           01S0189
         BNE   @RF00189                                         01S0189
*               /*****************************************************/
*               /*                                                   */
*               /* ABEND COMMAND                                     */
*               /*                                                   */
*               /*****************************************************/
*                                                               01S0190
*               DO;                 /* ABEND COMMAND                 */
*                 ZZ1FM='0'B;       /* MONITOR NO LONGER READY       */
         NI    ZZ1FM(RA),B'11011111'                            01S0191
*                  DO; /*ABEND(114) DUMP */                     01S0192
*                  RESPECIFY (GPR01F) RESTRICTED;               01S0193
*                  GPR01F = 114; /*COMP CODE IN REG 1*/         01S0194
         LA    GPR01F,114                                       01S0194
*                  GPR01F = GPR01F × '80000000'X; /*DUMP/STEP/DUMPOPTS
*LAG*/             SVC (13);/*ISSUE ABEND SVC*/                 01S0195
         O     GPR01F,@CF00058                                  01S0195
         SVC   13                                               01S0196
*                  RESPECIFY (GPR01F) UNRESTRICTED;             01S0197
*                  END; /*ABEND(114) DUMP */                    01S0198
*               END;                /* ABEND COMMAND                 */
*             IF                    /* TIME COMMAND                  */
*                 CSOAEXEC=ZZZ0&    /* NOT PREFIXED BY PERCENT SIGN  */
*                 CSOALNM=LENGTH('TIME')&CSOACN(1:LENGTH('TIME'))='TIME
*               THEN                /* TIME COMMAND                  */
@RF00189 TM    CSOAEXEC,B'00000100'                             01S0200
         BNZ   @RF00200                                         01S0200
         CLC   CSOALNM(2),@CH00036                              01S0200
         BNE   @RF00200                                         01S0200
         L     @08,CSOACNM                                      01S0200
         CLC   CSOACN(4,@08),@CC00806                           01S0200
         BNE   @RF00200                                         01S0200
*               CALL IKJEFT25(CMD,UPT,PSCB,ECT);/* DISPLAY TIME DATA */
         ST    CMDP,@AL00001                                    01S0201
         L     @08,CPPLUPT(,R9)                                 01S0201
         ST    @08,@AL00001+4                                   01S0201
         L     @08,CPPLPSCB(,R9)                                01S0201
         ST    @08,@AL00001+8                                   01S0201
         L     @08,CPPLECT(,R9)                                 01S0201
         ST    @08,@AL00001+12                                  01S0201
         L     @15,ZZ2FT25P(,R9)                                01S0201
         LA    @01,@AL00001                                     01S0201
         BALR  @14,@15                                          01S0201
*             ELSE                  /* NOT A TIME COMMAND            */
*                                                               01S0202
*               /*****************************************************/
*               /*                                                   */
*               /* NOT A TIME COMMAND                                */
*               /*                                                   */
*               /*****************************************************/
*                                                               01S0202
*               DO;                 /* NOT A TIME COMMAND            */
         B     @RC00200                                         01S0202
@RF00200 DS    0H                                               01S0203
*                 CMDO=0;           /* MONITOR WILL RESCAN COMMAND   */
         SLR   @08,@08                                          01S0203
         STH   @08,CMDO(,CMDP)                                  01S0203
*                 CMDP=ZZZNULL;     /* NO COMMAND BUFFER             */
         L     @08,@CF00058                                     01S0204
         LR    CMDP,@08                                         01S0204
*                 RESPECIFY                                     01S0205
*                  (R0,             /* UPDATE VALUE REGISTER PAIR    */
*                   R1,                                         01S0205
*                   R2,             /* COMPARATOR REGISTER PAIR      */
*                   R3) RESTRICTED;                             01S0205
*                 R0=ZZZNULL;       /* PRIME UPDATE REGISTER PAIR    */
         LR    R0,@08                                           01S0206
*                 R1=0;                                         01S0207
         SLR   R1,R1                                            01S0207
*                 R2=R0;            /* PRIME COMPARATOR REGISTER PAIR*/
         LR    R2,R0                                            01S0208
*                 R3=0;                                         01S0209
*                                                               01S0209
         SLR   R3,R3                                            01S0209
*                 /***************************************************/
*                 /*                                                 */
*                 /* DEQUEUE ATTENTION SUBCOMMANDS UNTIL THE POINTER */
*                 /* TO SUCH SUBCOMMANDS INDICATES WE ARE PROCESSING */
*                 /* THE MOST RECENT                                 */
*                 /*                                                 */
*                 /***************************************************/
*                                                               01S0210
*                 DO UNTIL(R2=R0);  /* REPLACE ZZ1ATTN               */
@DL00210 DS    0H                                               01S0211
*                   IF R2^=CMDP THEN/* ATTENTION SUBCOMMAND SELECTED */
*                                                               01S0211
         CR    R2,CMDP                                          01S0211
         BE    @RF00211                                         01S0211
*                     /***********************************************/
*                     /*                                             */
*                     /* ATTENTION SUBCOMMAND SELECTED               */
*                     /*                                             */
*                     /***********************************************/
*                                                               01S0212
*                     DO;           /* ATTENTION SUBCOMMAND SELECTED */
*                       CALL BLSUMONF;/* FREE COMMAND BUFFER         */
         BAL   @14,BLSUMONF                                     01S0213
*                       CMDP=R2;    /* ->COMMAND BUFFER              */
         LR    CMDP,R2                                          01S0214
*                     END;          /* ATTENTION SUBCOMMAND SELECTED */
*                   CDS(R2,R0,ZZ1ATTN);/* UPDATE ZZ1ATTN OR R2××R3   */
@RF00211 CDS   R2,R0,ZZ1ATTN(RA)                                01S0216
*                   R1=R3;          /* DO NOT ZERO ZZ1EVE            */
         LR    R1,R3                                            01S0217
*                 END;              /* REPLACE ZZ1ATTN               */
@DE00210 CR    R2,R0                                            01S0218
         BNE   @DL00210                                         01S0218
*                 RESPECIFY                                     01S0219
*                  (R0,             /* UPDATE VALUE REGISTER PAIR    */
*                   R1,                                         01S0219
*                   R2,             /* COMPARATOR REGISTER PAIR      */
*                   R3) UNRESTRICTED;                           01S0219
*                 ZZ1ACMP=PGPBIBUF; /* ->NEW ATTN COMMAND            */
         MVC   ZZ1ACMP(4,RA),PGPBIBUF                           01S0220
*                 FLAGEND=ZZZ1;     /* TERMINATE ATTENTION EXIT      */
*                 FLAGFFS=ZZZ0;     /* DO NOT ENTER FULL SCREEN MODE */
         OI    FLAGEND,B'10000000'                              01S0222
         NI    FLAGFFS,B'11011111'                              01S0222
*                  DO; /*POST (ZZ1EVE,ZZZFLAGW)*/               01S0223
*                    RESPECIFY (GPR00F,GPR01P) RESTRICTED;      01S0224
*                    GPR00F = ZZZFLAGW; /* POST CODE IN R0*/    01S0225
         LA    GPR00F,4                                         01S0225
*                    GPR01P = ADDR(ZZ1EVE); /*ECB ADDRESS*/     01S0226
         LA    GPR01P,ZZ1EVE(,RA)                               01S0226
*                    SVC (2); /*ISSUE POST SVC*/                01S0227
         SVC   2                                                01S0227
*                    RESPECIFY (GPR00F,GPR01P) UNRESTRICTED;    01S0228
*                  END; /*POST (ZZ1EVE,ZZZFLAGW)*/              01S0229
*               END;                /* NOT A TIME COMMAND            */
*           END;                    /* NON-NULL LINE                 */
*         ELSE                      /* NULL LINE                     */
*           FLAGEND=ZZZ1;           /* TERMINATE ON NULL LINE        */
         B     @RC00187                                         01S0232
@RF00187 OI    FLAGEND,B'10000000'                              01S0232
*       END;                        /* COMMAND LINE OBTAINED         */
@RC00187 DS    0H                                               01S0234
*     CALL BLSUMONF;                /* FREE COMMAND BUFFER           */
@RF00185 BAL   @14,BLSUMONF                                     01S0234
*     PGPBOPUT=ADDR(OIPCS);         /* PREPARE MODE MESSAGE DISPLAY  */
         LA    @08,OIPCS                                        01S0235
         ST    @08,PGPBOPUT                                     01S0235
*   END;                            /* ITERATIVELY GET COMMANDS      */
@DE00147 TM    FLAGEND,B'10000000'                              01S0236
         BZ    @DL00147                                         01S0236
*EXIT:                              /* COMMON EXIT PATH              */
*   IF FLAGFFS=ZZZ1 THEN            /* REENTER FULL SCREEN MODE      */
*                                                               01S0237
EXIT     TM    FLAGFFS,B'00100000'                              01S0237
         BNO   @RF00237                                         01S0237
*     /***************************************************************/
*     /*                                                             */
*     /* REENTER FULL SCREEN MODE                            @ZA31999*/
*     /*                                                             */
*     /***************************************************************/
*                                                               01S0238
*     DO;                           /* REENTER FULL SCREEN MODE      */
*       IF                          /* STFSMODE REQUIRED     @ZA31999*/
*           ZZ1FACCM=ZZZ0×          /* ACCESS METHOD DETERMINED      */
*           ZZ1FTCAM=ZZZ0 THEN      /* TCAM/TIOC ACCESS METHOD       */
*                                                               01S0239
         TM    ZZ1FACCM(RA),B'11000000'                         01S0239
         BO    @RF00239                                         01S0239
*         /***********************************************************/
*         /*                                                         */
*         /* STFSMODE REQUIRED                               @ZA31999*/
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0240
*         DO;                       /* STFSMODE REQUIRED     @ZA31999*/
*           LM(R0,R1,STFSMODE);     /* REGISTERS FOR STFSMODE        */
         LM    R0,R1,STFSMODE                                   01S0241
*           SVC(94);                /* STFSMODE ON,INITIAL=YES       */
         SVC   94                                               01S0242
*         END;                      /* STFSMODE REQUIRED     @ZA31999*/
*       LM(R0,R1,TPUT3270);         /* REGISTERS FOR T3270 MESSAGE   */
@RF00239 LM    R0,R1,TPUT3270                                   01S0244
*       GENERATE CODE(TPUT  (1),(0),R);/* TRANSMIT T3270 MESSAGE     */
         TPUT  (1),(0),R
*       ZZ2AFFS=ZZZ1;               /* SET FULL SCREEN INDICATOR     */
         OI    ZZ2AFFS(R9),B'00100000'                          01S0246
*     END;                          /* REENTER FULL SCREEN MODE      */
*   IF FLAGERR=ZZZ0 THEN            /* NO ERROR(S) DETECTED          */
@RF00237 TM    FLAGERR,B'01000000'                              01S0248
         BNZ   @RF00248                                         01S0248
*     RETC=ZZZFLAGI;                /* RETURN CODE                   */
         SLR   RETC,RETC                                        01S0249
*   ELSE                            /* ERROR(S) DETECTED             */
*     RETC=ZZZFLAGW;                /* RETURN CODE                   */
         B     @RC00248                                         01S0250
@RF00248 LA    RETC,4                                           01S0250
*   RETURN CODE(RETC);                                          01S0251
@RC00248 L     @13,4(,@13)                                      01S0251
         L     @00,@SIZDATD                                     01S0251
         LR    @01,@11                                          01S0251
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@02                                          01S0251
         L     @14,12(,@13)                                     01S0251
         LM    @00,@12,20(@13)                                  01S0251
         BR    @14                                              01S0251
*                                                               02S0252
*/*------------------------------------------------------------------*/
*/* BLSUMONF--FREE SUBCOMMAND BUFFER                                 */
*/*------------------------------------------------------------------*/
*                                                               02S0252
*BLSUMONF:                          /* FREE SUBCOMMAND BUFFER        */
*   PROCEDURE OPTIONS(NOSAVEAREA);                              02S0252
BLSUMONF STM   @14,@12,12(@13)                                  02S0252
*   IF CMDP^=ZZZNULL THEN           /* SUBCOMMAND BUFFER EXISTS      */
         CL    CMDP,@CF00058                                    02S0253
         BE    @RF00253                                         02S0253
*      DO; /*FREEMAIN(RU) LV(CMDP->CMDL)A(CMDP->CMD) SP(ZZZSPEXC)*/
*      RESPECIFY (GPR01F,GPR15F,GPR00F) RESTRICTED;             02S0255
*      GPR01F = 0; /* REG 1 MUST BE ZERO*/                      02S0256
         SLR   GPR01F,GPR01F                                    02S0256
*      GPR15F=3; /*SET TYPE*/                                   02S0257
         LA    GPR15F,3                                         02S0257
*      GPR00F = CMDP->CMDL; /* LENGTH REQUESTED*/               02S0258
         SLR   GPR00F,GPR00F                                    02S0258
         ICM   GPR00F,3,CMDL(CMDP)                              02S0258
*      GPR01F=ADDR(CMDP->CMD); /*SET REGISTER ONE*/             02S0259
         LR    GPR01F,CMDP                                      02S0259
*      GPR15F=GPR15F+((ZZZSPEXC)*256); /* SUBPOOL VALUE*/       02S0260
         AH    GPR15F,@CH00173                                  02S0260
*      SVC(120); /*RC/RU-FORM OF GETMAIN*/                      02S0261
         SVC   120                                              02S0261
*      RESPECIFY (GPR01F,GPR15F,GPR00F) UNRESTRICTED;           02S0262
*      END; /*FREEMAIN(RU) LV(CMDP->CMDL)A(CMDP->CMD) SP(ZZZSPEXC)*/
*   RETURN;                                                     02S0264
@EL00002 DS    0H                                               02S0264
@EF00002 DS    0H                                               02S0264
@ER00002 LM    @14,@12,12(@13)                                  02S0264
         BR    @14                                              02S0264
*   END BLSUMONF;                   /* END OF BLSUMONF               */
         B     @EL00002                                         02S0265
*                                                               01S0266
*/*BLSUPEND--MVS IPCS MODULE*/                                  01S0266
*                                                               01S0266
*                                                               01S0266
*                                                               01S0266
*    DECLARE /*GENERAL PURPOSE REGISTERS */                     01S0266
*      GPR00F FIXED(31) REG(0),                                 01S0266
*      GPR01F FIXED(31) REG(1),                                 01S0266
*      GPR15F FIXED(31) REG(15),                                01S0266
*      GPR01P PTR(31) REG(1);                                   01S0266
*                                                               01S0266
*    DECLARE /* COMMON VARIABLES */                             01S0267
*      I256C CHAR(256) BASED,                                   01S0267
*      I031F FIXED(31) BASED,                                   01S0267
*      I031P PTR(31)   BASED,                                   01S0267
*      I015F FIXED(15) BASED,                                   01S0267
*      I015P PTR(15)   BASED,                                   01S0267
*      I008P PTR(8)    BASED,                                   01S0267
*      I001C CHAR(1)   BASED;                                   01S0267
*    GENERATE NODEFS NOREFS DATA;                               01S0268
*   END BLSUMONI /*BLRPEND(BLSUMONI) */                         01S0269
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (BLSUZZZ )                                        *
*/*%INCLUDE SYSLIB  (BLRFULL )                                        *
*/*%INCLUDE SYSLIB  (IKJCPPL )                                        *
*/*%INCLUDE SYSLIB  (IKJPSCB )                                        *
*/*%INCLUDE SYSLIB  (IKJECT  )                                        *
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        *
*/*%INCLUDE SYSLIB  (BLSUSERV)                                        *
*/*%INCLUDE SYSLIB  (BLRSERV )                                        *
*/*%INCLUDE SYSLIB  (BLRSERVD)                                        *
*/*%INCLUDE SYSLIB  (IKJCSPL )                                        *
*/*%INCLUDE SYSLIB  (IKJIOPL )                                        *
*/*%INCLUDE SYSLIB  (IKJCSOA )                                        *
*/*%INCLUDE SYSLIB  (IKJPGPB )                                        *
*/*%INCLUDE SYSLIB  (BLSUMON1)                                        *
*/*%INCLUDE SYSLIB  (BLSUMONO)                                        *
*/*%INCLUDE SYSLIB  (BLSUMONS)                                        *
*/*%INCLUDE SYSLIB  (BLSUMONF)                                        *
*;                                                              01S0269
@EL00001 L     @13,4(,@13)                                      01S0269
@EF00001 L     @00,@SIZDATD                                     01S0269
         LR    @01,@11                                          01S0269
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                  01S0269
         BR    @14                                              01S0269
@DATA    DS    0H
@CH00036 DC    H'4'
@CH00090 DC    H'5'
@CH00046 DC    H'8'
@CH00033 DC    H'12'
@CH00049 DC    H'16'
@CH00173 DC    H'256'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@AL00001 DS    4A
BLSUMONI CSECT
         DS    0F
@CF00043 DC    F'0'
@CF00058 DC    XL4'80000000'
@DATD    DSECT
         DS    0D
CSPL     DS    CL24
         ORG   CSPL
CSPLUPT  DS    AL4
CSPLECT  DS    AL4
CSPLECB  DS    AL4
CSPLFLG  DS    AL4
CSPLOA   DS    AL4
CSPLCBUF DS    AL4
         ORG   CSPL+24
IOPL     DS    CL16
         ORG   IOPL
IOPLUPT  DS    AL4
IOPLECT  DS    AL4
IOPLECB  DS    AL4
IOPLIOPB DS    AL4
         ORG   IOPL+16
CSOA     DS    CL8
         ORG   CSOA
CSOACNM  DS    AL4
CSOALNM  DS    FL2
CSOAFLG  DS    CL1
         ORG   CSOAFLG
CSOAVWP  DS    BL1
CSOAVNP  EQU   CSOAFLG+0
CSOAQM   EQU   CSOAFLG+0
CSOANOC  EQU   CSOAFLG+0
CSOABAD  EQU   CSOAFLG+0
CSOAEXEC EQU   CSOAFLG+0
@NM00072 EQU   CSOAFLG+0
@NM00073 EQU   CSOAFLG+0
         ORG   CSOA+7
@NM00074 DS    CL1
         ORG   CSOA+8
FLAG     DS    BL1
         ORG   FLAG
FLAGEND  DS    BL1
FLAGERR  EQU   FLAG+0
FLAGFFS  EQU   FLAG+0
FLAGSCAN EQU   FLAG+0
@NM00113 EQU   FLAG+0
         ORG   FLAG+1
TGETBUF  DS    CL1
BLSUMONI CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00803 DC    C'ABEND'
@CC00806 DC    C'TIME'
         DS    CL3
OIPCS    DS    CL8
         ORG   OIPCS
OIPCSN   DC    A(1)
OIPCSP   DC    AL4(MIPCS)
         ORG   OIPCS+8
MIPCS    DS    CL9
         ORG   MIPCS
MIPCSL   DC    AL2(9)
@NM00076 DC    X'0000'
MIPCST   DS    CL5
         ORG   MIPCST
MIPCSTA  DC    CL1' '
MIPCSTB  DC    CL4'IPCS'
         ORG   MIPCS+9
TEXIT    DS    CL21
         ORG   TEXIT
TEXITA   DC    X'27F540'
TEXITB   DC    X'115D7E'
TEXITC   DC    X'11C150'
TEXITD   DC    X'114040'
TEXITE   DC    X'1DF8'
TEXITF   DC    CL1'×'
TEXITG   DC    X'1D40'
TEXITH   DC    X'3C404000'
         ORG   TEXIT+21
T3270    DS    CL15
         ORG   T3270
T3270A   DC    X'27F540'
T3270B   DC    X'115D7F'
T3270C   DC    X'114040'
T3270D   DC    X'1D40'
T3270E   DC    X'3C404000'
         ORG   T3270+15
         DS    CL3
TPUTEXIT DS    CL8
         ORG   TPUTEXIT
@NM00077 DS    BL4
         ORG   @NM00077
@NM00078 DC    X'0000'
@NM00079 DC    AL2(21)
         ORG   TPUTEXIT+4
@NM00080 DS    BL4
         ORG   @NM00080
@NM00081 DC    X'0B'
@NM00082 DC    AL3(TEXIT)
         ORG   TPUTEXIT+8
STLINENO DS    CL8
         ORG   STLINENO
@NM00083 DS    BL4
         ORG   @NM00083
@NM00084 DC    X'13'
@NM00085 DC    X'000000'
         ORG   STLINENO+4
@NM00086 DS    BL4
         ORG   @NM00086
@NM00087 DC    X'00'
@NM00088 DC    AL3(2)
         ORG   STLINENO+8
TPUTMODE DS    CL8
         ORG   TPUTMODE
@NM00089 DS    BL4
         ORG   @NM00089
@NM00090 DC    X'0000'
@NM00091 DC    AL2(4)
         ORG   TPUTMODE+4
@NM00092 DS    BL4
         ORG   @NM00092
@NM00093 DC    X'00'
@NM00094 DC    AL3(MIPCSTB)
         ORG   TPUTMODE+8
STFSMODE DS    CL8
         ORG   STFSMODE
@NM00095 DS    BL4
         ORG   @NM00095
@NM00096 DC    X'12'
@NM00097 DC    X'000000'
         ORG   STFSMODE+4
@NM00098 DS    BL4
         ORG   @NM00098
@NM00099 DC    X'C0'
@NM00100 DC    AL3(0)
         ORG   STFSMODE+8
TPUT3270 DS    CL8
         ORG   TPUT3270
@NM00101 DS    BL4
         ORG   @NM00101
@NM00102 DC    X'0000'
@NM00103 DC    AL2(15)
         ORG   TPUT3270+4
@NM00104 DS    BL4
         ORG   @NM00104
@NM00105 DC    X'0B'
@NM00106 DC    AL3(T3270)
         ORG   TPUT3270+8
TGETRESP DS    CL8
         ORG   TGETRESP
@NM00107 DS    BL4
         ORG   @NM00107
@NM00108 DC    X'0000'
@NM00109 DC    AL2(0)
         ORG   TGETRESP+4
@NM00110 DS    BL4
         ORG   @NM00110
@NM00111 DC    X'80'
@NM00112 DC    AL3(0)
         ORG   TGETRESP+8
@DATD    DSECT
         SPACE 2
***********************************************************************
* THE FOLLOWING AREA, BLRPATCH, IS RESERVED FOR PATCH APPLICATION     *
* TO OBTAIN PATCH ROOM IN THE @DATD AUTOMATIC STORAGE AREA, MODIFY    *
* CONSTANT @SIZDATD TO REFLECT THE DESIRED @DATD SIZE                 *
***********************************************************************
         SPACE
BLSUMONI CSECT
         ORG
         DS    0D
BLRPATCH DC    CL8'ZAPAREA',(((*-BLSUMONI+19)/20+7)/8)CL8'BLSUMONI'
@DATD    DSECT
         SPACE
*------- IMAGES OF PARAMETER LISTS -----------------------------------*
BLSUMONI CSECT
SDATA    DS    0D                      STATIC STORAGE DATA
SPGPB    PUTGET OUTPUT=(0,SINGLE,TERM),MF=L
SDATAEND DS    0F                      END OF SDATA
         SPACE
*------- PARAMETER LISTS ---------------------------------------------*
@DATD    DSECT
ADATA    DS    0D                      AUTOMATIC STORAGE DATA
PGPB     PUTGET OUTPUT=(0,SINGLE,TERM),MF=L
ADATAEND DS    0F                      END OF ADATA
@DATD    DSECT
         SPACE 2
***********************************************************************
* ALIGN END OF DATA ON A DOUBLEWORD BOUNDARY                          *
***********************************************************************
         SPACE
         DS    0D
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
BLSUMONI CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RETC     EQU   @02
RETCPTGT EQU   @04
CMDP     EQU   @06
RA       EQU   @10
R9       EQU   @09
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
RB       EQU   @11
RD       EQU   @13
RE       EQU   @14
RF       EQU   @15
GPR01F   EQU   @01
GPR00F   EQU   @00
GPR01P   EQU   @01
GPR15F   EQU   @15
RC       EQU   @12
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
ZZ1      EQU   0
ZZ1ATTN  EQU   ZZ1+360
ZZ1ACMP  EQU   ZZ1ATTN
ZZ1EVE   EQU   ZZ1ATTN+4
ZZ1F     EQU   ZZ1+368
ZZ1FM    EQU   ZZ1F
ZZ1FACCM EQU   ZZ1F+1
ZZ1FTCAM EQU   ZZ1F+1
ZZ1N     EQU   ZZ1+1116
ZZ2      EQU   0
ZZ2AMD   EQU   ZZ2
@NM00015 EQU   ZZ2AMD+7
ZZ2PRT   EQU   ZZ2+138
ZZ2PRTT  EQU   ZZ2PRT+4
ZZ2PRTT1 EQU   ZZ2PRTT+1
ZZ2A     EQU   ZZ2+272
ZZ2AF    EQU   ZZ2A+16
ZZ2AFFS  EQU   ZZ2AF
ZZ2APID  EQU   ZZ2A+64
ZZ2AD    EQU   ZZ2A+74
ZZ2ADD   EQU   ZZ2AD
ZZ2ADDT  EQU   ZZ2ADD+2
ZZ2ADM   EQU   ZZ2AD+46
ZZ2ADMT  EQU   ZZ2ADM+2
ZZ2ADP   EQU   ZZ2AD+56
ZZ2ADPT  EQU   ZZ2ADP+2
ZZ2AQAS  EQU   ZZ2A+144
ZZ2AQD   EQU   ZZ2A+160
ZZ2AQDT  EQU   ZZ2AQD+10
ZZ2AQDF  EQU   ZZ2AQD+52
ZZ2STG   EQU   ZZ2+960
ZZ2ALLOP EQU   ZZ2+992
ZZ2FREEP EQU   ZZ2+996
ZZ2FF19P EQU   ZZ2+1000
ZZ2FRE1P EQU   ZZ2+1004
ZZ2FF18P EQU   ZZ2+1008
ZZ2DYNAP EQU   ZZ2+1012
ZZ2ZZ2CP EQU   ZZ2+1016
ZZ2ZZ2DP EQU   ZZ2+1020
ZZ2STAIP EQU   ZZ2+1024
ZZ2FF02P EQU   ZZ2+1028
ZZ2GETLP EQU   ZZ2+1032
ZZ2PARSP EQU   ZZ2+1036
ZZ2PTGTP EQU   ZZ2+1040
ZZ2PUTLP EQU   ZZ2+1044
ZZ2SCANP EQU   ZZ2+1048
ZZ2STCKP EQU   ZZ2+1052
ZZ2TRMOP EQU   ZZ2+1064
ZZ2TRMVP EQU   ZZ2+1068
ZZ2FT25P EQU   ZZ2+1072
ZZ2PUTNP EQU   ZZ2+1084
ZZ2TRMNP EQU   ZZ2+1088
ZZ2ZZ1P  EQU   ZZ2+1264
ZZ2BVTP  EQU   ZZ2+1280
ZZ2CPPL  EQU   ZZ2+1292
ZZ2CPPLC EQU   ZZ2CPPL
ZZ2F     EQU   ZZ2+2824
ZZ2ITR   EQU   ZZ2+2840
ZZ2ITRE  EQU   ZZ2ITR+16
ZZ2ITSE  EQU   ZZ2+2864
ZZ2ES    EQU   ZZ2+2872
ZZ2AMDX  EQU   ZZ2+7160
ZZ2AXO   EQU   ZZ2+7934
ZZ2AXOT  EQU   ZZ2AXO+2
CMD      EQU   0
CMDL     EQU   CMD
CMDO     EQU   CMD+2
CMDT     EQU   CMD+4
PSCB     EQU   0
PSCBATR1 EQU   PSCB+16
ECT      EQU   0
ECTMSGF  EQU   ECT+8
ECTSWS   EQU   ECT+28
ECTSWS2  EQU   ECT+40
ECTSWS21 EQU   ECTSWS2
UPT      EQU   0
UPTSWS   EQU   UPT+12
SA       EQU   0
SA1      EQU   SA
SAR      EQU   SA+12
IKJPTGT  EQU   0
BLSUMON2 EQU   0
BVT      EQU   0
BVTPUTLP EQU   BVT+4
BVTPUTOP EQU   BVT+12
BVTPUTTP EQU   BVT+16
BVTPUTVP EQU   BVT+20
BVTPUTAP EQU   BVT+24
BVTPRTTP EQU   BVT+28
BVTPRTAP EQU   BVT+32
BVTPUTDP EQU   BVT+36
BVTMONP  EQU   BVT+40
BVTMON2P EQU   BVT+44
BVTVSARP EQU   BVT+48
BVTVSENP EQU   BVT+64
BVTVSERP EQU   BVT+68
BVTVSGEP EQU   BVT+72
BVTVSGUP EQU   BVT+76
BVTVSPOP EQU   BVT+80
BVTVSPUP EQU   BVT+84
BVTMPKNP EQU   BVT+104
BVTMONLP EQU   BVT+108
BVTPUTCP EQU   BVT+132
BVTMPK1P EQU   BVT+136
BVTZZ2RP EQU   BVT+140
BVTPGMRP EQU   BVT+144
BVTMONAP EQU   BVT+148
BVTBLDDP EQU   BVT+152
BVTBLDLP EQU   BVT+156
BVTPGMCP EQU   BVT+160
BVTPGMDP EQU   BVT+164
BVTPGMLP EQU   BVT+168
BVTMONCP EQU   BVT+180
BVTMONDP EQU   BVT+184
BVTMONTP EQU   BVT+188
BVTPARIP EQU   BVT+192
BVTPARUP EQU   BVT+196
BVTPRTNP EQU   BVT+204
BVTVSCRP EQU   BVT+208
BVTVSMRP EQU   BVT+212
BVTMONXP EQU   BVT+216
BVTTRMAP EQU   BVT+228
PARM     EQU   0
PARMZZ2  EQU   PARM+8
IKJEFT25 EQU   0
CSOACN   EQU   0
BLSUALLO EQU   0
BLSUBLDD EQU   0
BLSUBLDL EQU   0
BLSUDYNA EQU   0
BLSUFREE EQU   0
BLSUFRE1 EQU   0
BLSUMON  EQU   0
BLSUMONA EQU   0
BLSUMONC EQU   0
BLSUMOND EQU   0
BLSUMONL EQU   0
BLSUMONT EQU   0
BLSUMONX EQU   0
BLSUMPKN EQU   0
BLSUMPK1 EQU   0
BLSUPARI EQU   0
BLSUPARU EQU   0
BLSUPGMC EQU   0
BLSUPGMD EQU   0
BLSUPGML EQU   0
BLSUPGMR EQU   0
BLSUPRTA EQU   0
BLSUPRTN EQU   0
BLSUPRTT EQU   0
BLSUPUTA EQU   0
BLSUPUTC EQU   0
BLSUPUTD EQU   0
BLSUPUTL EQU   0
BLSUPUTN EQU   0
BLSUPUTO EQU   0
BLSUPUTT EQU   0
BLSUPUTV EQU   0
BLSUSTAI EQU   0
BLSUTRMA EQU   0
BLSUTRMN EQU   0
BLSUTRMO EQU   0
BLSUTRMV EQU   0
BLSUVSAR EQU   0
BLSUVSCR EQU   0
BLSUVSEN EQU   0
BLSUVSER EQU   0
BLSUVSGE EQU   0
BLSUVSGU EQU   0
BLSUVSMR EQU   0
BLSUVSPO EQU   0
BLSUVSPU EQU   0
BLSUZZ2C EQU   0
BLSUZZ2D EQU   0
BLSUZZ2R EQU   0
IKJEFF02 EQU   0
IKJEFF18 EQU   0
IKJEFF19 EQU   0
IKJGETL  EQU   0
IKJPARS  EQU   0
IKJPUTL  EQU   0
IKJSCAN  EQU   0
IKJSTCK  EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
PGPBIBUF EQU   PGPB+12
CPPL     EQU   ZZ2CPPL
CPPLUPT  EQU   CPPL+4
CPPLPSCB EQU   CPPL+8
CPPLECT  EQU   CPPL+12
PGPBOPUT EQU   PGPB+4
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CPPLCBUF EQU   CPPL
@NM00075 EQU   PGPB
PARMNULL EQU   PARM+4
PARMTAIE EQU   PARM
BVT99999 EQU   BVT+256
BVT0064P EQU   BVT+252
BVT0063P EQU   BVT+248
BVT0062P EQU   BVT+244
BVT0061P EQU   BVT+240
BVT0060P EQU   BVT+236
BVT0059P EQU   BVT+232
BVT0057P EQU   BVT+224
BVT0056P EQU   BVT+220
BVTSTBLP EQU   BVT+200
BVT0045P EQU   BVT+176
BVT0044P EQU   BVT+172
BVT0033P EQU   BVT+128
BVT0032P EQU   BVT+124
BVT0031P EQU   BVT+120
BVT0030P EQU   BVT+116
BVT0029P EQU   BVT+112
BVT0026P EQU   BVT+100
BVT0025P EQU   BVT+96
BVT0024P EQU   BVT+92
BVT0023P EQU   BVT+88
BVT0016P EQU   BVT+60
BVT0015P EQU   BVT+56
BVT0014P EQU   BVT+52
BVT0003P EQU   BVT+8
BVT0001P EQU   BVT
SA99     EQU   SA+72
SARC     EQU   SAR+56
SARB     EQU   SAR+52
SARA     EQU   SAR+48
SAR9     EQU   SAR+44
SAR8     EQU   SAR+40
SAR7     EQU   SAR+36
SAR6     EQU   SAR+32
SAR5     EQU   SAR+28
SAR4     EQU   SAR+24
SAR3     EQU   SAR+20
SAR2     EQU   SAR+16
SAR1     EQU   SAR+12
SAR0     EQU   SAR+8
SARF     EQU   SAR+4
SARE     EQU   SAR
SAFWD    EQU   SA+8
SABAK    EQU   SA+4
SA1L     EQU   SA1+1
SA1P     EQU   SA1
UPTPREFL EQU   UPT+23
UPTPREFX EQU   UPT+16
@NM00071 EQU   UPT+15
UPTLDEL  EQU   UPT+14
UPTCDEL  EQU   UPT+13
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTMID   EQU   UPTSWS
UPTNPRM  EQU   UPTSWS
UPTRCVR  EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00070 EQU   UPT
@NM00069 EQU   ECT+52
@NM00068 EQU   ECT+48
@NM00067 EQU   ECT+44
@NM00066 EQU   ECTSWS2+1
@NM00065 EQU   ECTSWS21
ECTTABND EQU   ECTSWS21
ECTDEFCS EQU   ECTSWS21
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTATTN  EQU   ECTSWS
ECTBKGRD EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTNMAL  EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
@NM00064 EQU   ECTSWS
ECTNOPD  EQU   ECTSWS
ECTSCMD  EQU   ECT+20
ECTPCMD  EQU   ECT+12
ECTSMSG  EQU   ECT+9
ECTIOWA  EQU   ECT+4
ECTRTCD  EQU   ECT+1
ECTRCDF  EQU   ECT
PSCBU    EQU   PSCB+64
PSCBRSZ  EQU   PSCB+60
PSCBLINE EQU   PSCB+59
PSCBCHAR EQU   PSCB+58
PSCBUPTL EQU   PSCB+56
PSCBUPT  EQU   PSCB+52
PSCBRLGB EQU   PSCB+48
PSCBDEST EQU   PSCB+40
@NM00063 EQU   PSCB+36
@NM00062 EQU   PSCB+32
@NM00061 EQU   PSCB+28
PSCBLTI2 EQU   PSCB+24
PSCBLTIM EQU   PSCB+20
PSCBATR2 EQU   PSCB+18
@NM00060 EQU   PSCBATR1
@NM00059 EQU   PSCBATR1
@NM00058 EQU   PSCBATR1
PSCBATTN EQU   PSCBATR1
PSCBVMNT EQU   PSCBATR1
PSCBJCL  EQU   PSCBATR1
PSCBACCT EQU   PSCBATR1
PSCBCTRL EQU   PSCBATR1
PSCBGPNM EQU   PSCB+8
PSCBUSRL EQU   PSCB+7
PSCBUSER EQU   PSCB
CMDT1    EQU   CMDT
ZZ299999 EQU   ZZ2+8192
ZZ2AXOT1 EQU   ZZ2AXOT
ZZ2AXOL  EQU   ZZ2AXO
@NM00057 EQU   ZZ2+7288
@NM00056 EQU   ZZ2AMDX+4
ZZ2AMDXC EQU   ZZ2AMDX
ZZ2HSD   EQU   ZZ2+3056
@NM00055 EQU   ZZ2ES
@NM00054 EQU   ZZ2+2868
ZZ2ITSEC EQU   ZZ2ITSE+1
@NM00053 EQU   ZZ2ITSE
ZZ2ITSEP EQU   ZZ2ITSE
ZZ2ITSEW EQU   ZZ2ITSE
@NM00052 EQU   ZZ2ITR+20
ZZ2ITREC EQU   ZZ2ITRE+1
@NM00051 EQU   ZZ2ITRE
ZZ2ITREP EQU   ZZ2ITRE
ZZ2ITREW EQU   ZZ2ITRE
@NM00050 EQU   ZZ2ITR+9
ZZ2ITRRC EQU   ZZ2ITR+8
ZZ2ITR2P EQU   ZZ2ITR+4
ZZ2ITRPP EQU   ZZ2ITR
@NM00049 EQU   ZZ2F
ZZ2F3270 EQU   ZZ2F
@NM00048 EQU   ZZ2+1544
ZZ2PGM   EQU   ZZ2+1536
@NM00047 EQU   ZZ2+1526
ZZ2CW    EQU   ZZ2+1524
@NM00046 EQU   ZZ2+1504
@NM00045 EQU   ZZ2+1352
ZZ2FFSYP EQU   ZZ2+1348
ZZ2SASYP EQU   ZZ2+1344
ZZ2RDSYP EQU   ZZ2+1340
ZZ2RASYP EQU   ZZ2+1336
ZZ2PHSYP EQU   ZZ2+1332
ZZ2ESSYP EQU   ZZ2+1328
ZZ200SYP EQU   ZZ2+1324
ZZ2SCWP  EQU   ZZ2+1320
ZZ2TTLP  EQU   ZZ2+1316
ZZ2LOADP EQU   ZZ2+1312
ZZ2VRESP EQU   ZZ2+1308
ZZ2CPPLE EQU   ZZ2CPPL+12
ZZ2CPPLP EQU   ZZ2CPPL+8
ZZ2CPPLU EQU   ZZ2CPPL+4
ZZ2VRSAP EQU   ZZ2+1288
ZZ2RVTP  EQU   ZZ2+1284
ZZ2DVTP  EQU   ZZ2+1276
@NM00044 EQU   ZZ2+1272
@NM00043 EQU   ZZ2+1268
ZZ2RPLP  EQU   ZZ2+1260
ZZ2TCBP  EQU   ZZ2+1256
@NM00042 EQU   ZZ2+1252
ZZ2ZZ2P  EQU   ZZ2+1248
@NM00041 EQU   ZZ2+1112
ZZ2FPDRP EQU   ZZ2+1108
ZZ2FDSDP EQU   ZZ2+1104
ZZ2APDRP EQU   ZZ2+1100
ZZ2ADSDP EQU   ZZ2+1096
ZZ2ENQ0P EQU   ZZ2+1092
@NM00040 EQU   ZZ2+1080
ZZ2MSG0P EQU   ZZ2+1076
ZZ2MSGSP EQU   ZZ2+1060
ZZ2ALOCP EQU   ZZ2+1056
@NM00039 EQU   ZZ2+976
ZZ2TOD   EQU   ZZ2+968
ZZ2STGN  EQU   ZZ2STG+4
ZZ2STGP  EQU   ZZ2STG
@NM00038 EQU   ZZ2+952
ZZ2SCMDE EQU   ZZ2+944
ZZ2SCMDN EQU   ZZ2+936
ZZ2IDENT EQU   ZZ2+928
ZZ2A9999 EQU   ZZ2A+656
@NM00037 EQU   ZZ2A+224
@NM00036 EQU   ZZ2A+220
ZZ2AQD99 EQU   ZZ2AQD+60
@NM00035 EQU   ZZ2AQD+56
@NM00034 EQU   ZZ2AQDF
ZZ2AQDFA EQU   ZZ2AQDF
ZZ2AQDIL EQU   ZZ2AQD+48
ZZ2AQDIM EQU   ZZ2AQD+44
ZZ2AQDT9 EQU   ZZ2AQDT+34
ZZ2AQDTE EQU   ZZ2AQDT+33
ZZ2AQDTD EQU   ZZ2AQDT+2
@NM00033 EQU   ZZ2AQDT+1
ZZ2AQDTY EQU   ZZ2AQDT
ZZ2AQDT0 EQU   ZZ2AQDT
ZZ2AQDLB EQU   ZZ2AQD+9
ZZ2AQDOB EQU   ZZ2AQD+8
ZZ2AQDLE EQU   ZZ2AQD+4
ZZ2AQDOF EQU   ZZ2AQD
ZZ2AQD00 EQU   ZZ2AQD
ZZ2AQAS9 EQU   ZZ2AQAS+16
@NM00032 EQU   ZZ2AQAS+12
ZZ2AQAS2 EQU   ZZ2AQAS+8
ZZ2AQAS1 EQU   ZZ2AQAS+4
@NM00031 EQU   ZZ2AQAS+2
ZZ2AQAST EQU   ZZ2AQAS
ZZ2AQAS0 EQU   ZZ2AQAS
ZZ2AZZ6P EQU   ZZ2A+140
ZZ2ADPTA EQU   ZZ2ADPT
ZZ2ADPL  EQU   ZZ2ADP
ZZ2ADMTA EQU   ZZ2ADMT
ZZ2ADML  EQU   ZZ2ADM
ZZ2ADDTA EQU   ZZ2ADDT
ZZ2ADDL  EQU   ZZ2ADD
@NM00030 EQU   ZZ2A+72
ZZ2APIDB EQU   ZZ2APID+3
ZZ2APIDA EQU   ZZ2APID
@NM00029 EQU   ZZ2A+24
@NM00028 EQU   ZZ2AF+5
ZZ2AFX   EQU   ZZ2AF+5
@NM00027 EQU   ZZ2AF+3
ZZ2AFS   EQU   ZZ2AF+2
ZZ2AFD   EQU   ZZ2AF+2
ZZ2AFQ   EQU   ZZ2AF+2
ZZ2AF$   EQU   ZZ2AF+2
@NM00026 EQU   ZZ2AF+2
ZZ2AFM   EQU   ZZ2AF+2
@NM00025 EQU   ZZ2AF+2
@NM00024 EQU   ZZ2AF+1
ZZ2AFV   EQU   ZZ2AF+1
@NM00023 EQU   ZZ2AF+1
ZZ2AFC   EQU   ZZ2AF+1
@NM00022 EQU   ZZ2AF
ZZ2AFT   EQU   ZZ2AF
ZZ2AFP   EQU   ZZ2AF
@NM00021 EQU   ZZ2A+8
ZZ2ALINE EQU   ZZ2A+4
@NM00020 EQU   ZZ2A+3
ZZ2ASE   EQU   ZZ2A+2
ZZ2ACH   EQU   ZZ2A
@NM00019 EQU   ZZ2+264
@NM00018 EQU   ZZ2+263
ZZ2PRTT0 EQU   ZZ2PRTT
ZZ2PRTO  EQU   ZZ2PRT+2
ZZ2PRTL  EQU   ZZ2PRT
@NM00017 EQU   ZZ2AMD+56
ZZ2AMDXP EQU   ZZ2AMD+52
ZZ2AMDD  EQU   ZZ2AMD+48
ZZ2AMDL  EQU   ZZ2AMD+44
ZZ2AMDU  EQU   ZZ2AMD+28
ZZ2AMDF  EQU   ZZ2AMD+24
ZZ2AMDS  EQU   ZZ2AMD+20
ZZ2AMDC  EQU   ZZ2AMD+16
ZZ2AMDP  EQU   ZZ2AMD+12
ZZ2AMDB  EQU   ZZ2AMD+8
@NM00016 EQU   @NM00015
ZZ2AMD2  EQU   @NM00015
ZZ2AMD1  EQU   @NM00015
ZZ2AMD0  EQU   ZZ2AMD+6
ZZ2AMDA  EQU   ZZ2AMD+4
ZZ2AMDT  EQU   ZZ2AMD
ZZ199999 EQU   ZZ1+3072
@NM00014 EQU   ZZ1+2160
ZZ1TRTAS EQU   ZZ1+1904
ZZ1TRUPC EQU   ZZ1+1648
ZZ1TRCTX EQU   ZZ1+1392
ZZ1NASID EQU   ZZ1N+274
ZZ1NSTRL EQU   ZZ1N+272
ZZ1NOFF  EQU   ZZ1N+268
ZZ1NBDY  EQU   ZZ1N+264
ZZ1NADE  EQU   ZZ1N+260
ZZ1NADB  EQU   ZZ1N+256
ZZ1NSTR  EQU   ZZ1N
@NM00013 EQU   ZZ1+1080
ZZ1TREBC EQU   ZZ1+824
ZZ1TRHEX EQU   ZZ1+568
@NM00012 EQU   ZZ1+377
ZZ1USTAE EQU   ZZ1+376
@NM00011 EQU   ZZ1F+3
@NM00010 EQU   ZZ1F+2
ZZ1FPRNT EQU   ZZ1F+2
@NM00009 EQU   ZZ1F+1
@NM00008 EQU   ZZ1F
ZZ1FX    EQU   ZZ1F
ZZ1FU    EQU   ZZ1F
ZZ1EVEC  EQU   ZZ1EVE+1
@NM00007 EQU   ZZ1EVE
ZZ1EVEP  EQU   ZZ1EVE
ZZ1EVEW  EQU   ZZ1EVE
@NM00006 EQU   ZZ1+144
ZZ1FPP   EQU   ZZ1+140
ZZ1ZZ6P  EQU   ZZ1+136
@NM00005 EQU   ZZ1+84
ZZ1PLINE EQU   ZZ1+80
ZZ1PGSZ  EQU   ZZ1+76
ZZ1PCNT  EQU   ZZ1+72
@NM00004 EQU   ZZ1+68
ZZ1TPAGE EQU   ZZ1+64
ZZ1TLINE EQU   ZZ1+60
@NM00003 EQU   ZZ1+52
ZZ1DMCBP EQU   ZZ1+48
ZZ1DSDP  EQU   ZZ1+44
ZZ1PDRP  EQU   ZZ1+40
ZZ1ZZ2P  EQU   ZZ1+36
ZZ1327WP EQU   ZZ1+32
ZZ1ACBP  EQU   ZZ1+28
@NM00002 EQU   ZZ1+24
ZZ1PDCBP EQU   ZZ1+20
ZZ1BLRBL EQU   ZZ1+16
@NM00001 EQU   ZZ1+12
ZZ1PNULL EQU   ZZ1+8
ZZ1NULL  EQU   ZZ1+4
ZZ1IDE   EQU   ZZ1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00107 EQU   EXIT
@RT00133 EQU   EXIT
@RF00142 EQU   EXIT
@RC00140 EQU   EXIT
@RC00200 EQU   @RC00187
@RF00253 EQU   @EL00002
@ENDDATA EQU   *
         END   BLSUMONI,(C'PLS1850',0701,78117)

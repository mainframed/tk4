         TITLE 'ISTINCPH - PARAMETER HANDLER ROUTINE                   *
                        '
*REGS(0,1,2,3,4,15)LINKREGS(5,6,7,12)INCLUDES(ISTPHROA)*/          0001
ISTINCPH CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISTINCPH  78.009'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
*    DO;                                                           0002
*/* ATBUILD (ISTPHROA)  */                                         0003
*/*       VTAM  PARAMETER HANDLER (ISTINCPH) OUTPUT AREA              *
*/*  INITIAL LEVEL                                     001 08/02/74  */
*DECLARE 1 ISTPHROA BASED BDY(WORD),                               0003
*         2 PHROALEN FIXED(31),        /* TOTAL LENGTH OF PHR OUTPUT
*                                         AREA                        *
*         2 PHROADTA CHAR(*) BDY(WORD); /* PHR OUTPUT AREA DATA       *
*                                                                  0003
*DECLARE 1 PHRFN1OA DEFINED(PHROADTA),   /* FUNCTION 1 OUTPUT      0004
*                                          AREA                       *
*         2 PHRF1SAD PTR(31),            /* POINTER TO SUB-PARAMETER  *
*         2 PHRF1SLN FIXED(31);          /* LENGTH OF SUB-PARAMETER   *
*                                                                  0004
*DECLARE 1 PHRFN2OA DEFINED(PHROADTA),   /* FUNCTION 2 OUTPUT AREA    *
*         2 PHRF2NVL FIXED(31),          /* NUMBER OF OUTPUT VALUES   *
*         2 PHRF2VAL(*) FIXED(31),       /* ARRAY OF OUTPUT VALUES    *
*          3 PHRF2OFS FIXED(15),         /* OFFSET INTO SIFT AREA     *
*          3 PHRF2FLG BIT(8),            /* FLAG BYTE                 *
*           4 PHRF2GP BIT(1),            /* USE MLCPTR0 AS BASE       *
*           4 PHRF2LN BIT(1),            /* USE MLCPTR1 AS BASE       *
*           4 PHRF2CL BIT(1),            /* USE MLCPTR2 AS BASE       *
*           4 PHRF2TR BIT(1),            /* USE MLCPTR3 AS BASE       *
*           4 *       BIT(1),            /* RESERVED                  *
*           4 PHRF2ON BIT(1),            /* SET ON UNDER PHRF2MSK     *
*           4 PHRF2OFF BIT(1),           /* SET OFF UNDER PHRF2MSK    *
*           4 PHRF2MV BIT(1),            /* MOVE PHRF2MSK TO AREA     *
*          3 PHRF2MSK BIT(8);            /* BIT PATTERN TO PROCESS    *
*                                                                  0005
*DECLARE 1 PHRF34OA DEFINED(PHROADTA),   /* FUNCTIONS 3+4 OUTPUT AREA *
*         2 PHRF34NS FIXED(31),          /* NUMBER OF SUB-PARAMETERS  *
*         2 PHRF34EN(*),                 /* OUTPUT AREA ARRAY ENTRY   *
*          3 PHRF34VF BIT(8),            /* VALIDITY FLAGS            *
*          3 * BIT(8),                   /* RESERVED                  *
*          3 PHRF34SL FIXED(15),         /* LENGTH OF SUBPARAMETER    *
*          3 PHRF34SP CHAR(8);           /* SUBPARAMETER STRING       *
*                                                                  0006
*DECLARE 1 PHRFN5OA DEFINED(PHROADTA),   /* FUNCTION 5 OUTPUT AREA    *
*         2 PHRF5NSP FIXED(31),          /* NUMBER OF SUB-PARAMETERS  *
*         2 PHRF5ENT(*),                 /* OUTPUT AREA ARRAY ENTRY   *
*          3 PHRF5VF BIT(8),             /* VALIDITY FLAGS            *
*          3 * BIT(8),                   /* RESERVED                  *
*          3 PHRF5SL FIXED(15),          /* LENGTH OF SUB-PARAMETER   *
*          3 PHRF5SPT PTR(31);           /* POINTER TO SUB-PARAMETER  *
*                                                                  0007
*DECLARE 1 PHRFN7OA DEFINED(PHROADTA),   /* FUNCTION 7 OUTPUT AREA    *
*         2 PHRF7NSP FIXED(31),          /* NUMBER OF SUB-PARAMETERS  *
*         2 PHRF7NUM(*) BIN(8);         /* ARRAY OF ONE-BYTE VALUES  */
*                                                                  0008
*DECLARE 1 PHRFN8OA DEFINED(PHROADTA),   /* FUNCTION 8 OUTPUT AREA    *
*          2 PHRF8NSP FIXED(31),         /* NUMBER OF SUB PARAMETERS  *
*          2 PHRF8ENT(*),                /* OUTPUT AREA ARRAY ENTRY   *
*            3 PHRF8FLG BIT(8),          /* FLAG BYTE                 *
*              4 PHRF8DFT BIT(1),        /* SUB-PARM DEFAULTED        *
*              4 *        BIT(7),        /* RESERVED                  *
*            3 PHRF8NUM BIN(8);          /* ONE-BYTE VALUE            *
*                                                                  0009
*/*       VALIDITY ERROR FLAGS SET BY FUNCTIONS IN OUTPUT AREA        *
*DECLARE PHRVFAOK BIT(8) CONSTANT('00'X);/* NO ERRORS IN SUB-PARAMETER*
*DECLARE PHRVFNA1 BIT(8) CONSTANT('10'X);/* FIRST CHAR. NOT ALPHABETIC*
*DECLARE PHRVFNAN BIT(8) CONSTANT('20'X);/* ALL CHARS. NOT ALPHANUM   *
*DECLARE PHRVFNNN BIT(8) CONSTANT('40'X);/* ALL CHARS. NOT NUMERIC    *
*/* END OF ATBUILD */                                              0014
*   DCL GPR05F FIXED(31) REG(05);                                  0014
*   DCL GPR05P PTR(31)   REG(05);                                  0015
*   DCL GPR06F FIXED(31) REG(06);                                  0016
*   DCL GPR06P PTR(31)   REG(06);                                  0017
*   DCL GPR07F FIXED(31) REG(07);                                  0018
*   DCL GPR07P PTR(31)   REG(07);                                  0019
*   DCL GPR12F FIXED(31) REG(12);                                  0020
*   DCL GPR12P PTR(31)   REG(12);                                  0021
*   DCL GPR14F FIXED(31) REG(14);                                  0022
*   DCL GPR14P PTR(31)   REG(14);                                  0023
*   DCL GPR00F FIXED(31) REG(00);                                  0024
*   DCL GPR00P PTR(31)   REG(00);                                  0025
*   DCL GPR01F FIXED(31) REG(01);                                  0026
*   DCL GPR01P PTR(31)   REG(01);                                  0027
*   DCL GPR02F FIXED(31) REG(02);                                  0028
*   DCL GPR02P PTR(31)   REG(02);                                  0029
*   DCL GPR03F FIXED(31) REG(03);                                  0030
*   DCL GPR03P PTR(31)   REG(03);                                  0031
*   DCL GPR04F FIXED(31) REG(04);                                  0032
*   DCL GPR04P PTR(31)   REG(04);                                  0033
*   DCL GPR15F FIXED(31) REG(15);                                  0034
*   DCL GPR15P PTR(31)   REG(15);                                  0035
*   RFY (GPR00P,GPR01P,GPR02P,GPR03P,GPR04P,GPR05P,GPR06P,GPR07P,GPR12P
*GPR14P,GPR15P) RSTD;                                              0036
*                                                                  0036
*   END ;                                                          0037
*/*A-000000-999999                                           @DL29HBN*/
*   RFY                                                            0038
*     ISTPHROA BASED(GPR02P);                                      0038
*                                                                  0039
*/*      KEYWORD TABLE INPUT FORMAT                                  */
*                                                                  0039
*                                                                  0039
*   DCL                                                            0039
*     1 CPHKWDTB BDY(BYTE)BASED(CPHTABAD),                         0039
*     (2 CPHENTNO,                  /* NUMBER OF ENTRIES             */
*      2 CPHENTLN)                  /* LENGTH OF 1 ENTRY             */
*            FIXED(15)BDY(BYTE),                                   0039
*      2 CPHTABEN(*),               /* TABLE ENTRY FORMAT            */
*       3 CPHKEYWD CHAR(8),         /* KEYWORD NAME                  */
*       3 CPHFUNBT CHAR(5);         /* FUNCTION BYTE/VALUE           */
*   DCL                                                            0040
*     1 CPHSUBVL CHAR(5)BDY(BYTE),  /* SUB-TABLE VALUE               */
*      2 CPHVALBT BIT(8),           /* VALIDITY FLAGS & FUNCT. NO    */
*       3 * BIT(1),                 /* RESERVED                      */
*       3 CPHFUNNU BIT(1),          /* CHECK NUMERIC CHAR            */
*       3 CPHFUNAN BIT(1),          /* CHECK ALPHANUM CHS            */
*       3 CPHFUNFC BIT(1),          /* CHECK ALPHA 1ST CH            */
*       3 CPHFUNNO BIT(4),          /* FUNCTION NUMBER               */
*      2 CPHVALUE PTR(31)BDY(BYTE); /* VALUE                         */
*                                                                  0040
*   DCL CPHF2VAL (*) BIT(32) DEFINED(PHRF2VAL);  /*TO ALLOW MVC  */
*   DCL CPHSBVL1 BIT(32) DEFINED(CPHSUBVL);  /*ALSO TO ALLOW MVC*/ 0042
*                                                                  0042
*/*      FUNCTION NUMBER VALUES                                      */
*                                                                  0043
*   DCL                                                            0043
*    (CPHFUN01 CONSTANT('0001'B),   /* FUNCTION NO. 1                */
*     CPHFUN02 CONSTANT('0010'B),   /* FUNCTION NO. 2                */
*     CPHFUN03 CONSTANT('0011'B),   /* FUNCTION NO. 3                */
*     CPHFUN04 CONSTANT('0100'B),   /* FUNCTION NO. 4                */
*     CPHFUN05 CONSTANT('0101'B),   /* FUNCTION NO. 5                */
*     CPHFUN06 CONSTANT('0110'B),   /* FUNCTION NO. 6                */
*     CPHFUN07 CONSTANT('0111'B),   /* FUNCTION NO. 7                */
*     CPHFUN08 CONSTANT('1000'B))  /*FUNCTION 8              @D32CKKA*/
*         BIT(4);                                                  0043
*                                                                  0043
*/*         TRANSLATE-AND-TEST TABLE USED TO SCAN FOR DELIMITERS     */
*                                                                  0044
*   DCL                                                            0044
*     CPHTRTB STATIC LOCAL CHAR(256)GENERATED;             /*@DM39361*/
*   GEN DATA DEFS(CPHTRTB);                                        0045
*                                                                  0045
*/*         TRT TABLE FOR VALIDITY CHECK SUBROUTINE                  */
*                                                                  0046
*   DCL                                                            0046
*     CPHVTRTB STATIC LOCAL CHAR(256)GENERATED;            /*@DM39361*/
*   GEN DATA DEFS(CPHVTRTB);                                       0047
*                                                                  0047
*/*      TRANSITION MATRIX FOR CONTEXT SUB-PROCESSORS                */
*                                                                  0048
*   DCL                                                            0048
*     CPHSCNTB(7,7)PTR(31) STATIC LOCAL /*TABLE STORAGE      @DM39361*/
*         INIT                      /* SEE DESCRIPTION OF TABLE IN 0048
*                                      CHARTS                        */
*         (ADDR(CPHCSP13),ADDR(CPHCSP01),ADDR(CPHCSP01),ADDR(CPHCSP01),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP01),ADDR(CPHCSP02),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP12),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP10),ADDR(CPHCSP10),
*         ADDR(CPHCSP04),ADDR(CPHCSP04),ADDR(CPHCSP05),ADDR(CPHCSP13),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP06),ADDR(CPHCSP06),
*         ADDR(CPHCSP06),ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP12),
*         ADDR(CPHCSP07),ADDR(CPHCSP12),ADDR(CPHCSP07),ADDR(CPHCSP12),
*         ADDR(CPHCSP08),ADDR(CPHCSP08),ADDR(CPHCSP12),ADDR(CPHCSP12),
*         ADDR(CPHCSP09),ADDR(CPHCSP09),ADDR(CPHCSP09),ADDR(CPHCSP12),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP10),ADDR(CPHCSP10),
*         ADDR(CPHCSP10),ADDR(CPHCSP12),ADDR(CPHCSP14),ADDR(CPHCSP10),
*         ADDR(CPHCSP13));                                         0048
*                                                                  0048
*/*   SUB-PARAMTER POINTER BLOCK FOR FUNCTION 2                      */
*                                                                  0049
*   DCL                                                            0049
*     1 CPHPNTBK BASED(CPHVALUE)BDY(BYTE),                         0049
*      2 CPHSBVAL FIXED(31)BDY(BYTE),/* KWD RTN. ADDRESS             */
*      2 CPHSBTAB PTR(31)BDY(BYTE); /* SUBPARM TBL                   */
*                                                                  0049
*/*      INLINE DATA AREA AND LOCK                           @DM39361*/
*   DCL                                                            0050
*     CPHLOCK BIT(8) INIT(0) STATIC LOCAL;                 /*@DM39361*/
*   DCL                                                            0051
*     STATICFD BDY(WORD) CHAR(116) STATIC LOCAL;           /*@ZA27161*/
*                                                                  0051
*                                                                  0051
*/*      SUB-PROCESSOR ENTRY POINT LOCATOR                           */
*                                                                  0052
*   DCL                                                            0052
*     CPHSCNPT PTR(31);                                            0052
*                                                                  0052
*/*     LOCAL POINTERS USED FOR WORKING STORAGE                      */
*                                                                  0053
*                                                                  0053
*   DCL                                                            0053
*    (CPHOANDX,                     /* OUTPUT AREA ENTRY INDEX       */
*     CPHOALIM)FIXED(31);           /* MAX NO. OF OUTPUT AREA ENT    */
*   DCL CPHINSVA PTR(31);           /* SVA FOR INPUT SVADDR  @DM39361*/
*   DCL CPHSCN00 PTR(31);           /* CPHSUBSC R00 SVA      @ZA27161*/
*   DCL CPHSCN02 PTR(31);           /* CPHSUBSC R02 SVA      @ZA27161*/
*   DCL CPHVCK01 PTR(31);           /* CPHVALCK R01 SVA      @ZA27161*/
*   DCL CPHVCK02 PTR(31);           /* CPHVALCK R02 SVA      @ZA27161*/
*   DCL                                                            0059
*    (CPHTCHAR,                     /* TRT CODE FOR LAST CHAR.       */
*     CPHLCHAR)FIXED(8);            /* TRT CODE FOR PREVIOUS CHAR    */
*   DCL                                                            0060
*    (CPHSPLEN,                     /* SUB-PARAMETER LENGTH          */
*     CPHKWLEN,                     /* KEYWORD LENGTH                */
*     CPHPARCT,                     /* PARENTHESES COUNT             */
*     CPHSBPAR,                     /* SUBPARM START PARENS. COUNT   */
*     CPHENCTR)FIXED(15);           /* TABLE SEARCH ENTRY COUNT      */
*   DCL                                                            0061
*     CPHSBYTE CHAR(*)BASED;        /* (A) BYTE(S) IN SCANNED STR    */
*   DCL                                                            0062
*     CPHARGUM CHAR(8);             /* SEARCH ARGUMENT (CPHTBLSC)    */
*   DCL                                                            0063
*     CPHDECHX CHAR(3);             /*HOLD AREA FOR CPHSUB07 @DM39361*/
*   DCL                                                            0064
*     1 CPHVALFG BIT(8),            /* VALIDITY ERROR FLAGS          */
*      2 * BIT(1),                  /* RESERVED                      */
*      2 CPHVALNU BIT(1),           /* CHARACTERS NOT NUMERIC        */
*      2 CPHVALAN BIT(1),           /* CHARS. NOT ALPHANUMERIC       */
*      2 CPHVALFC BIT(1),           /* 1ST CHAR. NOT ALPHANUMERIC    */
*      2 * BIT(4);                  /* RESERVED                      */
*   DCL                                                            0065
*    (CPHTABAD,                     /* POINTER TO KWD TABLE ENTRY    */
*     CPHTABSV)PTR(31);             /* POINTER TO KWD TABLE START    */
*   DCL                                                            0066
*    (CPHKWPTR,                     /* POINTER TO START OF KEYWD     */
*     CPHTRTSV,                     /* POINTER TO START OF    SUBPARM*/
*     CPHVALPS,                     /* VALCHK SAVE AREA FOR PTR      */
*     CPHSPPTR)PTR(31);             /* SUB-PARAMETER POINTER         */
*   DCL                                                            0067
*     1 CPHFLAGS BIT(8),            /* ** PHR LOGIC CONTROL FLAGS*   */
*      2 * BIT(1),                  /* RESERVED                      */
*      2 CPHCONT BIT(1),            /* TRT CONTINUE FLAG             */
*      2 CPHKWSCN BIT(1),           /* SCANNING STRING FOR KWD       */
*      2 CPHENDST BIT(1),           /* END OF STRING WAS HIT         */
*      2 CPHENDSP BIT(1),           /* END OF SUB-PARM WAS HIT       */
*      2 CPHLSTSP BIT(1),           /* LAST SUB-PARAMETER WAS HIT    */
*      2 CPHSLIST BIT(1),           /* SUB PARM LIST ENCOUNTERED     */
*      2 CPHSYNER BIT(1);           /* SYNTAX ERROR HAS OCCURRED     */
*   DCL                                                            0068
*     1 CPHFLAG2 BIT(8),            /* ADDITIONAL CONTROL FLAGS      */
*      2 CPHOFLOW BIT(1),           /* OUTPUT AREA OVERFLOW          */
*      2 CPHFUNER BIT(1),           /* FUNCTION ERROR                */
*      2 CPHARGNF BIT(1),           /* ARGUMENT NOT FOUND-TBL SCH    */
*      2 * BIT(5);                  /* RESERVED                      */
*   DCL GPR13P PTR(31) REG(13) RSTD; /*                      @ZA27161*/
*                                                                  0070
*/*         EXECUTABLE CODE SECTION                                  */
*         GPR03P=GPR13P;                 /*SAVE CALLER'S SVA @DM30219*/
         LR    GPR03P,GPR13P                                       0070
*         GPR13P=ADDR(STATICFD);         /*USE INLINE SVA    @DM39361*/
         LA    GPR13P,STATICFD                                     0071
*         GEN REFS(CPHLOCK)(TS CPHLOCK); /*INLINE DATA AREA IN     0072
*                                          USE ?             @DM39361*/
         TS CPHLOCK
*         BC(8,USEINLIN);                /* NO-USE INLINE AREA     0073
*                                                            @DM39361*/
         BC    8,USEINLIN                                          0073
*GEN SETS(GPR00P,GPR01P,GPR04P,GPR15F,GPR05P,GPR06P,GPR07P)        0074
*    REFS(GPR03P);                                         /*@VS45824*/
          LM   4,7,36(3)
          L    0,@SIZDATD
          LA   1,48(3)
          ST   1,40(3)
          LA   1,36(3)
          GETMAIN EC,LV=(0),SP=0,MF=(E,(1))
*        IF GPR15F=0                                               0075
*              THEN DO;                                    /*@DM39361*/
         LTR   GPR15F,GPR15F                                       0075
         BNZ   @RF00075                                            0075
*        GEN SETS(GPR13P,GPR00P,GPR01P)                            0077
*            REFS(GPR04P,GPR05P,GPR06P,GPR07P,GPR03P);     /*@VS45113*/
          LM   0,1,20(3)
          L   13,48(3)
          STM 4,7,36(3)
          USING @DATD,13
*USEINLIN:                                                         0078
*CPHINSVA=GPR03P;                   /* SAVE INPUT SAVE AREA  @DM39361*/
*                                                                  0078
USEINLIN ST    GPR03P,CPHINSVA                                     0078
*CPHPARCT=0;         /*INIT. PARENS. COUNT (CPHPARCT) TO 0        */
         SLR   @10,@10                                             0079
         STH   @10,CPHPARCT                                        0079
*/*   R0=TABLE ADDR R1=KEYWORD ADDR R2=OUTPUT AREA ADDR              */
*CPHFLAGS='00'X;            /*  RESET CPHFLAGS*/                   0080
         MVI   CPHFLAGS,X'00'                                      0080
*CPHFLAG2='00'X;                                                   0081
         MVI   CPHFLAG2,X'00'                                      0081
*CPHKWSCN='1'B;             /*   SET CPHKWSCN = 1*/                0082
         OI    CPHKWSCN,B'00100000'                                0082
*CPHLCHAR='06'X;            /*   CPHLCHAR = X'06' (START OF KWD)*/ 0083
         MVI   CPHLCHAR,X'06'                                      0083
* /*ICALL(CPHSUBSC)*/                                              0084
*  DO;                                                             0084
* CALL CPHSUBSC;                                                   0085
*                                                                  0085
         BAL   @14,CPHSUBSC                                        0085
* END ;           /*   GO TO LOCATE KEYWORD */                     0086
*                   /* KWD ADD IN CPHKWPTR, KWD LENGTH IN CPHKWLEN   */
*IF CPHSYNER='1'B            /*SYNTAX ERR */                       0087
*   THEN                        /*YES */                           0087
         TM    CPHSYNER,B'00000001'                                0087
         BNO   @RF00087                                            0087
*     GPR01P=GPR01P+1;           /*UPDATE REG1*/                   0088
         AL    GPR01P,@CF00048                                     0088
*   ELSE DO;                     /*NOT SYNTAX ERR */               0089
         B     @RC00087                                            0089
@RF00087 DS    0H                                                  0090
*     IF CPHENDST='1'B       /*END OF STRING*/                     0090
*        THEN;               /*YES END OF STRING*/                 0090
         TM    CPHENDST,B'00010000'                                0090
         BO    @RT00090                                            0090
*        ELSE DO;            /*NOT END OF STRING*/                 0092
*         IF CPHKWLEN>8           /*KWD LONGER THAN 8*/            0093
*          THEN                  /*YES */                          0093
         LH    @10,CPHKWLEN                                        0093
         C     @10,@CF00046                                        0093
         BNH   @RF00093                                            0093
*             CPHARGNF='1'B;         /*  SET ARGUMENT NOT FOUND*/  0094
         OI    CPHARGNF,B'00100000'                                0094
*          ELSE DO;                  /*NOT LONGER THAN 8*/         0095
         B     @RC00093                                            0095
@RF00093 DS    0H                                                  0096
*             CPHARGUM=' ';         /*CLEAR SEARCH ARG*/           0096
         MVI   CPHARGUM+1,C' '                                     0096
         MVC   CPHARGUM+2(6),CPHARGUM+1                            0096
         MVI   CPHARGUM,C' '                                       0096
*                               /* MOVE KWD TO CPHARGUM (SEARCH ARG)*/
*             CPHARGUM(1:CPHKWLEN)=CPHKWPTR->CPHSBYTE(1:CPHKWLEN); 0097
         LH    @10,CPHKWLEN                                        0097
         BCTR  @10,0                                               0097
         L     @09,CPHKWPTR                                        0097
         EX    @10,@SM00427                                        0097
*             CPHTABAD=GPR00P;  /*GET ADDR OF KWD TABLE*/          0098
         ST    GPR00P,CPHTABAD                                     0098
*              /*ICALL(CPHTBLSC)*/                                 0099
*               DO;                                                0099
*              CALL CPHTBLSC;                                      0100
*                                                                  0100
         BAL   @14,CPHTBLSC                                        0100
*              END ;  /* SEARCH KWD TABLE FOR KWD */               0101
*             IF CPHARGNF='0'B    /*WAS ARG FOUND*/                0102
*                THEN DO;         /*YES */                         0102
         TM    CPHARGNF,B'00100000'                                0102
         BNZ   @RF00102                                            0102
*                                 /* WAS IT  FUNCT. 0 WITH PARMS*/ 0104
*                  IF CPHFUNNO='0000'B&CPHTCHAR='01'X              0104
*                     THEN       /*YES*/                           0104
         TM    CPHFUNNO,B'00001111'                                0104
         BNZ   @RF00104                                            0104
         CLI   CPHTCHAR,1                                          0104
         BNE   @RF00104                                            0104
*                        CPHFUNER='1'B;    /* SET FUNCTION ERROR FLAG*/
         OI    CPHFUNER,B'01000000'                                0105
*                     ELSE DO;       /*NOT FUNC 0 WITH PARMS*/     0106
         B     @RC00104                                            0106
@RF00104 DS    0H                                                  0107
*                             /* NOT FUNCT. 0 AND POSITIONAL KEYWD   */
*                        IF CPHFUNNO^='0000'B&CPHTCHAR^='01'X      0107
*                           THEN      /*YES*/                      0107
         TM    CPHFUNNO,B'00001111'                                0107
         BZ    @RF00107                                            0107
         CLI   CPHTCHAR,1                                          0107
         BE    @RF00107                                            0107
*                             CPHSYNER='1'B; /* SET SYNTAX ERROR */
         OI    CPHSYNER,B'00000001'                                0108
*                           ELSE DO;/*NOT SYNTAX ERROR*/           0109
         B     @RC00107                                            0109
@RF00107 DS    0H                                                  0110
*                            GPR00F=CPHVALUE; /*GET ENT VALUE*/    0110
         ICM   GPR00F,15,CPHVALUE                                  0110
*                            IF CPHFUNNO=CPHFUN01 /*FUNCT 1*/      0111
*                               THEN   /*YES FUNC 1*/              0111
         TM    CPHFUNNO,B'00000001'                                0111
         BNO   @RF00111                                            0111
         TM    CPHFUNNO,B'00001110'                                0111
         BNZ   @RF00111                                            0111
*                                  /*ICALL(CPHSUB01)*/             0112
*                                   DO;                            0112
*                                  CALL CPHSUB01;                  0113
*                                                                  0113
         BAL   @14,CPHSUB01                                        0113
*                                  END ;/*CALL FUNCT 1 RTN*/       0114
*                               ELSE DO;   /*NOT FUNCT 1*/         0115
         B     @RC00111                                            0115
@RF00111 DS    0H                                                  0116
*                                 IF CPHFUNNO=CPHFUN02 /*FUNCT 2*/ 0116
*                                  THEN  /*YES FUNC2*/             0116
         TM    CPHFUNNO,B'00000010'                                0116
         BNO   @RF00116                                            0116
         TM    CPHFUNNO,B'00001101'                                0116
         BNZ   @RF00116                                            0116
*                                    /*ICALL(CPHSUB02)*/           0117
*                                     DO;                          0117
*                                    CALL CPHSUB02;                0118
*                                                                  0118
         BAL   @14,CPHSUB02                                        0118
*                                    END ;/*CALL FUNCT2 */         0119
*                                  ELSE DO;  /*NOT FUNCT 2*/       0120
         B     @RC00116                                            0120
@RF00116 DS    0H                                                  0121
*                                    IF CPHFUNNO=CPHFUN03 × /*FUNCT 3*/
*                                       CPHFUNNO=CPHFUN04   /*OR 4*/
*                                     THEN     /*YES 3 OR 4*/      0121
         TM    CPHFUNNO,B'00000011'                                0121
         BNO   @GL00003                                            0121
         TM    CPHFUNNO,B'00001100'                                0121
         BZ    @RT00121                                            0121
@GL00003 TM    CPHFUNNO,B'00000100'                                0121
         BNO   @RF00121                                            0121
         TM    CPHFUNNO,B'00001011'                                0121
         BNZ   @RF00121                                            0121
@RT00121 DS    0H                                                  0122
*                                            /*CALL FUNCT 3/4 RTN*/
*                                         /*ICALL(CPHSUB34)*/      0122
*                                          DO;                     0122
*                                         CALL CPHSUB34;           0123
*                                                                  0123
         BAL   @14,CPHSUB34                                        0123
*                                         END ;                    0124
*                                     ELSE DO;  /*NOT 3/4*/        0125
         B     @RC00121                                            0125
@RF00121 DS    0H                                                  0126
*                                        IF CPHFUNNO=CPHFUN05/*FUNC 5*/
*                                           THEN  /*YES CALL FUNC 5*/
         TM    CPHFUNNO,B'00000101'                                0126
         BNO   @RF00126                                            0126
         TM    CPHFUNNO,B'00001010'                                0126
         BNZ   @RF00126                                            0126
*                                               /*ICALL(CPHSUB05)*/
*                                                DO;               0127
*                                               CALL CPHSUB05;     0128
*                                                                  0128
         BAL   @14,CPHSUB05                                        0128
*                                               END ;              0129
*                                           ELSE DO;/*NOT FUNC5*/  0130
         B     @RC00126                                            0130
@RF00126 DS    0H                                                  0131
*                                           /*IF IT FUNC6*/        0131
*                                              IF CPHFUNNO=CPHFUN06
*                                                 THEN /*YES*/     0131
         TM    CPHFUNNO,B'00000110'                                0131
         BNO   @RF00131                                            0131
         TM    CPHFUNNO,B'00001001'                                0131
         BNZ   @RF00131                                            0131
*                                         /*CALL FUNCT 6 RTN*/     0132
*                                                     /*ICALL(CPHSUB06)
*/                                                                 0132
*                                                      DO;         0132
*                                                     CALL CPHSUB06;
*                                                                  0133
         BAL   @14,CPHSUB06                                        0133
*                                                     END ;        0134
*                                                 ELSE DO; /*NOT 6*/
         B     @RC00131                                            0135
@RF00131 DS    0H                                                  0136
*                                                 /*IS IT FUNC 7 OR 8*/
*                                                 IF CPHFUNNO=CPHFUN07
*                                                 × CPHFUNNO=CPHFUN08
*                                                          /*@D32CKKA*/
*                                                    THEN /*YES*/  0136
         TM    CPHFUNNO,B'00000111'                                0136
         BNO   @GL00004                                            0136
         TM    CPHFUNNO,B'00001000'                                0136
         BZ    @RT00136                                            0136
@GL00004 TM    CPHFUNNO,B'00001000'                                0136
         BNO   @RF00136                                            0136
         TM    CPHFUNNO,B'00000111'                                0136
         BNZ   @RF00136                                            0136
@RT00136 DS    0H                                                  0137
*                                                /*CALL FUNC 7/8 */
*                                                      /*ICALL(CPHSUB07
**/                                                                0137
*                                                       DO;        0137
*                                                      CALL CPHSUB07;
*                                                                  0138
         BAL   @14,CPHSUB07                                        0138
*                                                      END ;       0139
*                                                     ELSE;/*NOT 7,8*/
@RF00136 DS    0H                                                  0141
*                                                 END; /*END NOT 6*/
*                                           END;  /*END NOT FUNC 5*/
*                                     END;  /*END NOT FUNCT 3/4*/  0143
*                                 END;      /*END NOT FUNCT2*/     0144
*                                END;       /*END NOT FUNCT 1*/    0145
*                            END;          /*END NOT SYNTAX ERROR*/
*                     END;                 /*END NOT FUNCT ERROR*/ 0147
*                END;                      /*END ARG FOUND*/       0148
*                ELSE;                     /*ARG NOT FOUND*/       0149
@RF00102 DS    0H                                                  0150
*          END;              /*END NOT LONGER THAN 8*/             0150
@RC00102 DS    0H                                                  0151
*        END;                /*END NOT END OF STRING*/             0151
@RC00093 DS    0H                                                  0152
*    END;                  /*END NOT SYNTAX ERROR */               0152
@RT00090 DS    0H                                                  0153
*   IF CPHARGNF='1'B×CPHFUNER='1'B×CPHOFLOW='1'B /*NON-TERM ERRORS*/
*     THEN DO;               /*YES NON TERMINATING ERRORS*/        0153
@RC00087 TM    CPHARGNF,B'11100000'                                0153
         BZ    @RF00153                                            0153
*                              /* DO WHILE ERROR AND END NOT HIT     */
*       DO WHILE(CPHLSTSP='0'B&CPHSYNER='0'B&CPHENDST='0'B);       0155
         B     @DE00155                                            0155
@DL00155 DS    0H                                                  0156
*          /*ICALL(CPHSUBSC)*/                                     0156
*           DO;                                                    0156
*          CALL CPHSUBSC;                                          0157
*                                                                  0157
         BAL   @14,CPHSUBSC                                        0157
*          END ;   /* SCAN OVER PARAMETER LIST            */       0158
*       END;                  /*END DO WHILE */                    0159
@DE00155 TM    CPHLSTSP,B'00010101'                                0159
         BZ    @DL00155                                            0159
*     END;                    /*END ERRORS CODE*/                  0160
*     ELSE;                   /*NO NON-TERMINATING ERRORS*/        0161
@RF00153 DS    0H                                                  0162
*   IF CPHSYNER='1'B          /*SYNTAX ERROR*/                     0162
*     THEN                     /*YES */                            0162
         TM    CPHSYNER,B'00000001'                                0162
         BNO   @RF00162                                            0162
*        GPR15F=12;            /*SET RTN CODE */                   0163
         LA    GPR15F,12                                           0163
*     ELSE DO;                 /*NOT SYNTAX ERROR*/                0164
         B     @RC00162                                            0164
@RF00162 DS    0H                                                  0165
*       IF CPHARGNF='1'B       /*ARG NOT FOUND ERROR*/             0165
*          THEN                /*YES */                            0165
         TM    CPHARGNF,B'00100000'                                0165
         BNO   @RF00165                                            0165
*             GPR15F=4;        /*SET RETURN CODE*/                 0166
         LA    GPR15F,4                                            0166
*          ELSE DO;            /*NOT ARG NOT FOUND ERROR*/         0167
         B     @RC00165                                            0167
@RF00165 DS    0H                                                  0168
*             IF CPHFUNER='1'B /*FUNCT ERROR*/                     0168
*                THEN          /*YES*/                             0168
         TM    CPHFUNER,B'01000000'                                0168
         BNO   @RF00168                                            0168
*                   GPR15F=16;  /*SET RETURN CODE*/                0169
         LA    GPR15F,16                                           0169
*                ELSE DO;      /*NOT FUNCT ERROR*/                 0170
         B     @RC00168                                            0170
@RF00168 DS    0H                                                  0171
*                   IF CPHOFLOW='1'B /*OVERFLOW*/                  0171
*                      THEN    /*YES*/                             0171
         TM    CPHOFLOW,B'10000000'                                0171
         BNO   @RF00171                                            0171
*                         GPR15F=20;  /*SET RETURN CODE*/          0172
         LA    GPR15F,20                                           0172
*                      ELSE DO;  /*NOT OVER FLOW*/                 0173
         B     @RC00171                                            0173
@RF00171 DS    0H                                                  0174
*                         IF CPHENDST='1'B /*END OF STRING*/       0174
*                            THEN   /*YES*/                        0174
         TM    CPHENDST,B'00010000'                                0174
         BNO   @RF00174                                            0174
*                               GPR15F=8; /*SET RETURN CODE*/      0175
         LA    GPR15F,8                                            0175
*                            ELSE   /*NO ERRORS*/                  0176
*                               GPR15F=0; /*SET RETURN CODE*/      0176
         B     @RC00174                                            0176
@RF00174 SLR   GPR15F,GPR15F                                       0176
*                      END;   /*END NOT OVERFLOW*/                 0177
@RC00174 DS    0H                                                  0178
*                END;    /*END NOT FUNCTION ERROR*/                0178
@RC00171 DS    0H                                                  0179
*          END;          /*END NOT ARG NOT FOUND ERROR*/           0179
@RC00168 DS    0H                                                  0180
*     END;               /*END NOT SYNTAX ERROR*/                  0180
@RC00165 DS    0H                                                  0181
*        GPR03P=CPHINSVA;  /*PICK UP CALLER'S SVA ADDRESS    @DM39361*/
@RC00162 L     GPR03P,CPHINSVA                                     0181
*   GEN REFS(GPR15F,GPR00P,GPR01P,GPR13P)                          0182
*       (STM  15,1,16(3));  /*STORE OUTPUT REGS FOR CALLER   @DM39361*/
         STM  15,1,16(3)
*        IF GPR13P=ADDR(STATICFD)                                  0183
*          THEN CPHLOCK='00'X; /*RESET INLINE DATA LOCK      @DM39361*/
         LA    @10,STATICFD                                        0183
         CR    GPR13P,@10                                          0183
         BNE   @RF00183                                            0183
         MVI   CPHLOCK,X'00'                                       0184
*          ELSE DO;            /*ELSE RELEASE DYN DATA AREA  @DM39361*/
         B     @RC00183                                            0185
@RF00183 DS    0H                                                  0186
*        GEN SETS(GPR00P) SETS(GPR13P);                    /*@DM39361*/
         L    0,@SIZDATD
         FREEMAIN  R,LV=(0),A=(13)
*          END;                                            /*@DM39361*/
*        GPR13P=GPR03P;    /*PUT CALLER'S SVA ADDR IN R13    @DM39361*/
@RC00183 LR    GPR13P,GPR03P                                       0188
* END;                   /*SAVE AREA GOTTEN OK               @DM39361*/
* ELSE DO;               /*SAVE AREA NOT OBTAINED            @DM39361*/
         B     @RC00075                                            0190
@RF00075 DS    0H                                                  0191
*   GPR15F=20;           /* OVERFLOW RETURN CODE             @DM39361*/
         LA    GPR15F,20                                           0191
*   GPR13P=GPR03P;       /*RESTORE CALLER'S SVA ADDR         @DM39361*/
         LR    GPR13P,GPR03P                                       0192
* GEN REFS(GPR15P,GPR13P)                                          0193
*     (ST 15,16(13));    /*SAVE RETURN CODE FOR CALLER       @DM39361*/
         ST 15,16(13)
* GEN REFS(GPR04P,GPR05P,GPR13P,GPR06P,GPR07P);            /*@VS45113*/
         STM 4,7,36(13)
* END;                   /*SAVE AREA NOT OBTAINED            @DM39361*/
*/*CPHSUB01:03A2 E                                 */              0196
*/*******************************************************************/
*/*                                                                 */
*/*   CPHSUB01: FUNCTION 1 ROUTINE                                  */
*/*                                                                 */
*/*******************************************************************/
*   CPHSUB01: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0196
         B     @PB00002                                            0196
CPHSUB01 DS    0H                                                  0197
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0197
*    DO;                                                           0197
*   CMZX9904 = GPR14P;                                             0198
*                                                                  0198
         LR    CMZX9904,GPR14P                                     0198
*   END ;                                                          0199
*      /*   R1=PARM STRING POINTER R2=OUTPUT AREA ADDRESS       */ 0200
*    /*ICALL(CPHSUBSC)*/                                           0200
*     DO;                                                          0200
*    CALL CPHSUBSC;                                                0201
*                                                                  0201
         BAL   @14,CPHSUBSC                                        0201
*    END ;     /*LOCATE NEXT SUBPARAMETER*/                        0202
*          /* CPHSPPTR= SUBPARAM PTR CPHSPLEN= SUBPARAM LENGTH*/   0203
*   IF CPHSYNER='1'B      /*SYNTAX ERROR */                        0203
*      THEN;              /*YES */                                 0203
         TM    CPHSYNER,B'00000001'                                0203
         BO    @RT00203                                            0203
*      ELSE DO;           /*NOT SYNTAX ERROR*/                     0205
*         PHRF1SAD=CPHSPPTR;/*SUBPARM PTR IN OUTPUT AREA*/         0206
         L     @10,CPHSPPTR                                        0206
         ST    @10,PHRF1SAD(,GPR02P)                               0206
*         PHRF1SLN=CPHSPLEN;/*SUBPARM LENGTH IN OUTPUT AREA*/      0207
         LH    @09,CPHSPLEN                                        0207
         ST    @09,PHRF1SLN(,GPR02P)                               0207
*         IF EVAL(CPHSPPTR-1)->CPHSBYTE(1)='(' /*LAST CHAR '('*/   0208
*            THEN DO;          /*YES LEFT PAREN*/                  0208
         LR    @09,@10                                             0208
         BCTR  @09,0                                               0208
         CLI   CPHSBYTE(@09),C'('                                  0208
         BNE   @RF00208                                            0208
*                /* GET ADDRESS OF LAST CHAR (CPHSPPTR MINUS 1)*/  0210
*               EVAL(CPHSPPTR-1)->CPHSBYTE(1)=' ';/*SET TO BLANK*/ 0210
         BCTR  @10,0                                               0210
         MVI   CPHSBYTE(@10),C' '                                  0210
*            END;            /*END LEFT PAREN CODE*/               0211
*            ELSE;           /*NOT LEFT PAREN*/                    0212
@RF00208 DS    0H                                                  0213
*FUN1LOOP:                                                         0213
*         DO WHILE(CPHSYNER='0'B&CPHLSTSP='0'B);/*LOOK FOR ','*/   0213
FUN1LOOP B     @DE00213                                            0213
@DL00213 DS    0H                                                  0214
*            IF GPR01P->CPHSBYTE(1) = ','   /* COMMA FOUND? */     0214
*               THEN   /* YES */                                   0214
         CLI   CPHSBYTE(GPR01P),C','                               0214
         BNE   @RF00214                                            0214
*                  PHRF1SLN = PHRF1SLN + 1;  /*ACCOUNT FOR COMMA */
         LA    @10,1                                               0215
         AL    @10,PHRF1SLN(,GPR02P)                               0215
         ST    @10,PHRF1SLN(,GPR02P)                               0215
*               ELSE;           /* NO STRING COUNT UPDATE */       0216
@RF00214 DS    0H                                                  0217
*             /*ICALL(CPHSUBSC)*/                                  0217
*              DO;                                                 0217
*             CALL CPHSUBSC;                                       0218
*                                                                  0218
         BAL   @14,CPHSUBSC                                        0218
*             END ;    /* LOCATE NEXT SUBPARAMETER*/               0219
*            PHRF1SLN=PHRF1SLN+CPHSPLEN; /*ADD SUBPARM LENGTH*/    0220
         LH    @10,CPHSPLEN                                        0220
         AL    @10,PHRF1SLN(,GPR02P)                               0220
         ST    @10,PHRF1SLN(,GPR02P)                               0220
*            CPHSPLEN = 0; /* ZAP COUNT TO AVOID DOUBLE UPDATES */ 0221
         SLR   @10,@10                                             0221
         STH   @10,CPHSPLEN                                        0221
*         END FUN1LOOP;                                            0222
@DE00213 TM    CPHSYNER,B'00000101'                                0222
         BZ    @DL00213                                            0222
*         IF CPHSYNER='1'B /*SYNTAX ERROR*/                        0223
*            THEN;         /*YES*/                                 0223
         TM    CPHSYNER,B'00000001'                                0223
         BO    @RT00223                                            0223
*            ELSE DO;      /*NOT SYNTAX ERROR*/                    0225
*                       /* CHECK LAST BYTE OF PARM LIST SCANNED */ 0226
*              IF EVAL(PHRF1SAD+PHRF1SLN)->CPHSBYTE(1)=')'/*LAST ')'*/
*                 THEN DO;      /*YES LAST CAHR IS RT PAREN*/      0226
         L     @10,PHRF1SAD(,GPR02P)                               0226
         L     @09,PHRF1SLN(,GPR02P)                               0226
         LR    @08,@10                                             0226
         ALR   @08,@09                                             0226
         CLI   CPHSBYTE(@08),C')'                                  0226
         BNE   @RF00226                                            0226
*            /*GET ADDRESS OF LAST CHAR (SUBPARM PTR PLUS STRING LEN)*/
*                     /*   MOVE 'BLANK' INTO THAT CHAR OF PARM STRING*/
*                    EVAL(PHRF1SAD+PHRF1SLN)->CPHSBYTE(1)=' ';     0228
         ALR   @10,@09                                             0228
         MVI   CPHSBYTE(@10),C' '                                  0228
*                 END;    /*END RT PAREN CODE*/                    0229
*                 ELSE;   /*NOT RT PAREN*/                         0230
@RF00226 DS    0H                                                  0231
*            END;         /*END NOT SYNTAX ERROR FROM COMMA SCAN*/ 0231
*      END;               /*END NOT SYNTAX ERROR FROM NXT PARM*/   0232
@RT00223 DS    0H                                                  0233
*    /*CMZPEND*/                                                   0233
*     DO;                                                          0233
@RT00203 DS    0H                                                  0234
*    GPR14P = CMZX9904;                                            0234
*                                                                  0234
         LR    GPR14P,CMZX9904                                     0234
*    END ;                                                         0235
*    END CPHSUB01;                                                 0236
@EL00002 DS    0H                                                  0236
@EF00002 DS    0H                                                  0236
@ER00002 BR    @14                                                 0236
*/********************************************************************/
*/*                                                                  */
*/*      CPHSUB02: FUNCTION 2 ROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*   CPHSUB02: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0237
CPHSUB02 DS    0H                                                  0238
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0238
*    DO;                                                           0238
*   CMZX9905 = GPR14P;                                             0239
*                                                                  0239
         LR    CMZX9905,GPR14P                                     0239
*   END ;                                                          0240
*  /* R0=PTR BLK ADDRESS R1=PARM STRING POINTER R2=OUTPUT AREA PTR*/
*   PHRF2NVL=0;                 /* RESET COUNT FIELD  */           0241
         SLR   @10,@10                                             0241
         ST    @10,PHRF2NVL(,GPR02P)                               0241
*                               /* RESET COUNT LIMIT  */           0242
*   CPHOALIM=(PHROALEN-(ADDR(PHRF2VAL(1))-GPR02P))/LENGTH(PHRF2VAL(1));
         LA    @10,PHRF2VAL(,GPR02P)                               0242
         SLR   @10,GPR02P                                          0242
         LR    @08,@10                                             0242
         LCR   @08,@08                                             0242
         AL    @08,PHROALEN(,GPR02P)                               0242
         SRDA  @08,32                                              0242
         D     @08,@CF00128                                        0242
         ST    @09,CPHOALIM                                        0242
*LOOP2:                                                            0243
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHSYNER='0'B&   0243
*         CPHFUNER='0'B);    /*GET ALL SUBPARMS WHILE NOT A SYNTAX*/
LOOP2    LA    @10,1                                               0243
         B     @DE00243                                            0243
@DL00243 TM    CPHLSTSP,B'00000101'                                0243
         BNZ   @DC00243                                            0243
         TM    CPHFUNER,B'01000000'                                0243
         BNZ   @DC00243                                            0243
*                                       /*ERROR AND NOT END OF STRING*/
*      /*ICALL(CPHSUBSC)*/                                         0244
*      F2LOOP: DO;                                                 0244
F2LOOP   DS    0H                                                  0245
*      CALL CPHSUBSC;                                              0245
*                                                                  0245
         BAL   @14,CPHSUBSC                                        0245
*      END F2LOOP;           /*LOCATE NEXT SUBPARAM */             0246
*                 /* CPHSPPTR= SUBPARAM PTR, CPHSPLEN= SUBPARAM LNGTH*/
*      IF CPHSYNER='1'B           /*SYNTAX ERROR*/                 0247
*          THEN;                  /*YES*/                          0247
         TM    CPHSYNER,B'00000001'                                0247
         BO    @RT00247                                            0247
*          ELSE DO;               /*NOT SYNTAX ERROR*/             0249
*             CPHTABAD=GPR00P->CPHSBTAB;  /*GET TABLE ADDR*/       0250
         LR    @10,GPR00P                                          0250
         MVC   CPHTABAD(4),CPHSBTAB(@10)                           0250
*             IF CPHSPLEN>8 /*SUB PARM TOO LONG*/                  0251
*                THEN        /*YES*/                               0251
         LH    @10,CPHSPLEN                                        0251
         C     @10,@CF00046                                        0251
         BNH   @RF00251                                            0251
*                   CPHFUNER='1'B;    /*SET FUNCTION ERROR*/       0252
         OI    CPHFUNER,B'01000000'                                0252
*                ELSE DO;         /*NOT TOO LONG*/                 0253
         B     @RC00251                                            0253
@RF00251 DS    0H                                                  0254
*                   IF CPHSPLEN=0   /*WAS SUB PARM DEFAULTED*/     0254
*                      THEN       /*YES*/                          0254
         SLR   @10,@10                                             0254
         CH    @10,CPHSPLEN                                        0254
         BNE   @RF00254                                            0254
*                         PHRF2VAL(CPHOANDX)=0;/*NEXT ENTRY EQUAL ZERO*
         L     @09,CPHOANDX                                        0255
         SLA   @09,2                                               0255
         ST    @10,PHRF2VAL-4(@09,GPR02P)                          0255
*                       ELSE DO;   /*NOT DEFAULTED*/               0256
         B     @RC00254                                            0256
@RF00254 DS    0H                                                  0257
*                                      /*PUT PARM IN SEARCH ARG*/  0257
*                          CPHARGUM=CPHSPPTR->CPHSBYTE(1:CPHSPLEN);
         MVI   CPHARGUM+1,C' '                                     0257
         MVC   CPHARGUM+2(6),CPHARGUM+1                            0257
         LH    @10,CPHSPLEN                                        0257
         BCTR  @10,0                                               0257
         L     @09,CPHSPPTR                                        0257
         EX    @10,@SM00427                                        0257
*                           /*ICALL(CPHTBLSC)*/                    0258
*                            DO;                                   0258
*                           CALL CPHTBLSC;                         0259
*                                                                  0259
         BAL   @14,CPHTBLSC                                        0259
*                           END ;  /*SEARCH SUBPARM TABLE*/        0260
*                          IF CPHARGNF='0'B     /*WAS ARG FOUND*/  0261
*                             THEN          /*YES*/                0261
         TM    CPHARGNF,B'00100000'                                0261
         BNZ   @RF00261                                            0261
*                                /* STORE TABLE ENTRY INTO OUTPUT AREA*
*                                MVC(CPHF2VAL(CPHOANDX),CPHSBVL1); 0262
         L     @10,CPHOANDX                                        0262
         SLA   @10,2                                               0262
         ALR   @10,GPR02P                                          0262
         MVC   CPHF2VAL-4(4,@10),CPHSBVL1                          0262
*                             ELSE DO;   /*ARG NOT FOUND*/         0263
         B     @RC00261                                            0263
@RF00261 DS    0H                                                  0264
*                          /*  STORE 'FF'S IN NEXT WORD OF OUTPUT AREA*
*                                PHRF2VAL(CPHOANDX)=-1;            0264
         L     @10,CPHOANDX                                        0264
         SLA   @10,2                                               0264
         SLR   @09,@09                                             0264
         BCTR  @09,0                                               0264
         ST    @09,PHRF2VAL-4(@10,GPR02P)                          0264
*                                CPHARGNF='0'B; /*RESET ARG NOT FOUND*/
         NI    CPHARGNF,B'11011111'                                0265
*                             END;       /*END ARG NOT FOUND*/     0266
*                       END;             /*END NOT DEFAULTED*/     0267
@RC00261 DS    0H                                                  0268
*                   PHRF2NVL=PHRF2NVL+1;/*INCR COUNT*/             0268
@RC00254 LA    @10,1                                               0268
         AL    @10,PHRF2NVL(,GPR02P)                               0268
         ST    @10,PHRF2NVL(,GPR02P)                               0268
*                END;             /*END NOT TOO LONG*/             0269
*          END;                   /*END NOT SYNTAX ERROR*/         0270
@RC00251 DS    0H                                                  0271
*   END LOOP2;                    /*END DO WHILE*/                 0271
@RT00247 LA    @10,1                                               0271
         AL    @10,CPHOANDX                                        0271
@DE00243 ST    @10,CPHOANDX                                        0271
         C     @10,CPHOALIM                                        0271
         BNH   @DL00243                                            0271
@DC00243 DS    0H                                                  0272
*   IF CPHOANDX>CPHOALIM&CPHLSTSP='0'B /*OVER FLOW AND NOT END*/   0272
*      THEN                                     /*YES*/            0272
         L     @10,CPHOANDX                                        0272
         C     @10,CPHOALIM                                        0272
         BNH   @RF00272                                            0272
         TM    CPHLSTSP,B'00000100'                                0272
         BNZ   @RF00272                                            0272
*         CPHOFLOW='1'B;           /*SET OVERFLOW */               0273
         OI    CPHOFLOW,B'10000000'                                0273
*      ELSE DO;                    /*NOT OVERFLOW*/                0274
         B     @RC00272                                            0274
@RF00272 DS    0H                                                  0275
*         IF CPHSYNER='0'B&CPHFUNER='0'B /*SYNTAX OR FUNCT ERR*/   0275
*            THEN                  /*NO*/                          0275
         TM    CPHSYNER,B'00000001'                                0275
         BNZ   @RF00275                                            0275
         TM    CPHFUNER,B'01000000'                                0275
         BNZ   @RF00275                                            0275
*               GPR00P=GPR00P->CPHSBVAL; /*SET R0 =ADDR OF RTN*/   0276
         LR    @10,GPR00P                                          0276
         ICM   GPR00P,15,CPHSBVAL(@10)                             0276
*            ELSE;                 /*YES SYNTAX OR FUNCT ERR*/     0277
@RF00275 DS    0H                                                  0278
*      END;                         /*END NOT OVERFLOW*/           0278
*    /*CMZPEND*/                                                   0279
*     DO;                                                          0279
@RC00272 DS    0H                                                  0280
*    GPR14P = CMZX9905;                                            0280
*                                                                  0280
         LR    GPR14P,CMZX9905                                     0280
*    END ;                                                         0281
*    END CPHSUB02;                                                 0282
@EL00003 DS    0H                                                  0282
@EF00003 DS    0H                                                  0282
@ER00003 BR    @14                                                 0282
*/********************************************************************/
*/*                                                                  */
*/*      CPHSUB34: FUNCTION 3, 4 ROUTINE                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0283
*   CPHSUB34: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0283
CPHSUB34 DS    0H                                                  0284
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0284
*    DO;                                                           0284
*   CMZX9906 = GPR14P;                                             0285
*                                                                  0285
         LR    CMZX9906,GPR14P                                     0285
*   END ;                                                          0286
*                   /*  R1=PARM STRING PTR R2=OUTPUT AREA PTR*/    0287
*            /*RESET COUNT FIELD AND LIMIT OF OUTPUT AREA AND CPHOALIM*
*   PHRF34NS=0;                                                    0287
         SLR   @10,@10                                             0287
         ST    @10,PHRF34NS(,GPR02P)                               0287
*   CPHOALIM=(PHROALEN-(ADDR(PHRF34EN(1))-GPR02P))/LENGTH(PHRF34EN);
         LA    @10,PHRF34EN(,GPR02P)                               0288
         SLR   @10,GPR02P                                          0288
         LR    @08,@10                                             0288
         LCR   @08,@08                                             0288
         AL    @08,PHROALEN(,GPR02P)                               0288
         SRDA  @08,32                                              0288
         D     @08,@CF00237                                        0288
         ST    @09,CPHOALIM                                        0288
*             /*PROCESS ENTRIES WHILE NO ERRORS*/                  0289
*LOOP34:                                                           0289
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHFUNER='0'B&   0289
*         CPHSYNER='0'B);                                          0289
LOOP34   LA    @10,1                                               0289
         B     @DE00289                                            0289
@DL00289 TM    CPHLSTSP,B'00000100'                                0289
         BNZ   @DC00289                                            0289
         TM    CPHFUNER,B'01000000'                                0289
         BNZ   @DC00289                                            0289
         TM    CPHSYNER,B'00000001'                                0289
         BNZ   @DC00289                                            0289
*      /*ICALL(CPHSUBSC)*/                                         0290
*      F34LOOP: DO;                                                0290
F34LOOP  DS    0H                                                  0291
*      CALL CPHSUBSC;                                              0291
*                                                                  0291
         BAL   @14,CPHSUBSC                                        0291
*      END F34LOOP;            /*  LOCATE NEXT SUBPARAM*/          0292
*      IF CPHSYNER='1'B         /* SYNTAX ERROR*/                  0293
*         THEN;                   /*YES*/                          0293
         TM    CPHSYNER,B'00000001'                                0293
         BO    @RT00293                                            0293
*         ELSE DO;                 /*NOT SYNTAX ERROR*/            0295
*            IF CPHSPLEN>8         /*PARM TOO LONG*/               0296
*               THEN               /*YES*/                         0296
         LH    @10,CPHSPLEN                                        0296
         C     @10,@CF00046                                        0296
         BNH   @RF00296                                            0296
*                  CPHFUNER='1'B;  /*SET FUNCTION ERROR*/          0297
         OI    CPHFUNER,B'01000000'                                0297
*               ELSE DO;           /*NOT TOO LONG*/                0298
         B     @RC00296                                            0298
@RF00296 DS    0H                                                  0299
*                  IF CPHSPLEN=0   /*WAS PARM DEFAULTED*/          0299
*                     THEN DO;     /*YES*/                         0299
         LH    @10,CPHSPLEN                                        0299
         LTR   @10,@10                                             0299
         BNZ   @RF00299                                            0299
*                        IF CPHFUNNO=CPHFUN03 /*FUNCT 3*/          0301
*                           THEN    /*YES*/                        0301
         TM    CPHFUNNO,B'00000011'                                0301
         BNO   @RF00301                                            0301
         TM    CPHFUNNO,B'00001100'                                0301
         BNZ   @RF00301                                            0301
*                              PHRF34SP(CPHOANDX)=' ';/*SET TO BLANKS*/
         L     @10,CPHOANDX                                        0302
         MH    @10,@CH00237                                        0302
         ALR   @10,GPR02P                                          0302
         MVI   PHRF34SP-11(@10),C' '                               0302
         MVC   PHRF34SP-10(6,@10),PHRF34SP-11(@10)                 0302
         MVI   PHRF34SP-12(@10),C' '                               0302
*                           ELSE    /*NO NOT FUNCT 3*/             0303
*                              PHRF34SP(CPHOANDX)='00000000';/*ST TO 0*
         B     @RC00301                                            0303
@RF00301 L     @10,CPHOANDX                                        0303
         MH    @10,@CH00237                                        0303
         ALR   @10,GPR02P                                          0303
         MVC   PHRF34SP-12(8,@10),@CC00269                         0303
*                     END;    /*END DEFAULTED*/                    0304
*                     ELSE DO;     /*NOT DEFAULTED*/               0305
         B     @RC00299                                            0305
@RF00299 DS    0H                                                  0306
*                         /*ICALL(CPHVALCK)*/                      0306
*                          DO;                                     0306
*                         CALL CPHVALCK;                           0307
*                                                                  0307
         BAL   @14,CPHVALCK                                        0307
*                         END ; /*CK VALIDITY OF PARM*/            0308
*                        PHRF34VF(CPHOANDX)=CPHVALFG;/*SET VAL FLG*/
         L     @10,CPHOANDX                                        0309
         MH    @10,@CH00237                                        0309
         ST    @10,@TF00001                                        0309
         ALR   @10,GPR02P                                          0309
         AL    @10,@CF00433                                        0309
         MVC   PHRF34VF-8(1,@10),CPHVALFG                          0309
*                        IF CPHFUNNO=CPHFUN03 /*FUNCT 3*/          0310
*                           THEN DO;          /*YES*/              0310
         TM    CPHFUNNO,B'00000011'                                0310
         BNO   @RF00310                                            0310
         TM    CPHFUNNO,B'00001100'                                0310
         BNZ   @RF00310                                            0310
*                              PHRF34SP(CPHOANDX)=' ';/*INIT TO BLANK*/
         LR    @10,GPR02P                                          0312
         AL    @10,@TF00001                                        0312
         MVI   PHRF34SP-11(@10),C' '                               0312
         MVC   PHRF34SP-10(6,@10),PHRF34SP-11(@10)                 0312
         MVI   PHRF34SP-12(@10),C' '                               0312
*                    /* MOVE SUBPARAM TO PHRF34SP(*) LEFT JUSTIFIED*/
*                                     /*PADDED WITH BLANKS (8 CHAR) */
*                              PHRF34SP(CPHOANDX,1:CPHSPLEN)=      0313
*                                CPHSPPTR->CPHSBYTE(1:CPHSPLEN);   0313
         LR    @10,GPR02P                                          0313
         AL    @10,@TF00001                                        0313
         LH    @09,CPHSPLEN                                        0313
         BCTR  @09,0                                               0313
         L     @08,CPHSPPTR                                        0313
         EX    @09,@SM00434                                        0313
*                           END;              /*END FUNCT 3*/      0314
*                           ELSE DO;   /*NOT FUNCT 3*/             0315
         B     @RC00310                                            0315
@RF00310 DS    0H                                                  0316
*                              /*  INIT PHRF34SP(*) TO EBCDIC ZEROS*/
*                              PHRF34SP(CPHOANDX)='00000000';      0316
         L     @10,CPHOANDX                                        0316
         MH    @10,@CH00237                                        0316
         ST    @10,@TF00001                                        0316
         ALR   @10,GPR02P                                          0316
         MVC   PHRF34SP-12(8,@10),@CC00269                         0316
*               /* MOVE SUBPARAM TO PHRF34SP(*) RIGHT JUSTIFIED PADDED*
*                                        /*WITH ZEROS (8 CHARS)*/  0317
*                              PHRF34SP(CPHOANDX,9-CPHSPLEN:8)=    0317
*                              CPHSPPTR->CPHSBYTE(1:CPHSPLEN);     0317
         LA    @10,9                                               0317
         SH    @10,CPHSPLEN                                        0317
         L     @09,@TF00001                                        0317
         ALR   @09,@10                                             0317
         ALR   @09,GPR02P                                          0317
         AL    @09,@CF00260                                        0317
         LCR   @10,@10                                             0317
         AL    @10,@CF00046                                        0317
         L     @08,CPHSPPTR                                        0317
         EX    @10,@SM00436                                        0317
*                           END;        /*END NOT FUNCT 3*/        0318
*                     END;              /*END NOT DEFAULTED*/      0319
@RC00310 DS    0H                                                  0320
*                  PHRF34SL(CPHOANDX)=CPHSPLEN;/*PUT LEN IN OUT AREA*/
@RC00299 L     @10,CPHOANDX                                        0320
         MH    @10,@CH00237                                        0320
         LH    @09,CPHSPLEN                                        0320
         AL    @10,@CF00438                                        0320
         STH   @09,PHRF34SL-10(@10,GPR02P)                         0320
*                  PHRF34NS=PHRF34NS+1;       /*INC NO. SUBPARM*/  0321
         LA    @10,1                                               0321
         AL    @10,PHRF34NS(,GPR02P)                               0321
         ST    @10,PHRF34NS(,GPR02P)                               0321
*               END;           /*END NOT TOO LONG*/                0322
*         END;                 /*END NOT SYNTAX ERROR*/            0323
@RC00296 DS    0H                                                  0324
*   END LOOP34;                /*END DO WHILE*/                    0324
@RT00293 LA    @10,1                                               0324
         AL    @10,CPHOANDX                                        0324
@DE00289 ST    @10,CPHOANDX                                        0324
         C     @10,CPHOALIM                                        0324
         BNH   @DL00289                                            0324
@DC00289 DS    0H                                                  0325
*   IF CPHOANDX>CPHOALIM&CPHLSTSP='0'B /*OVERFLOW AND NOT END*/    0325
*      THEN                    /*YES*/                             0325
         L     @10,CPHOANDX                                        0325
         C     @10,CPHOALIM                                        0325
         BNH   @RF00325                                            0325
         TM    CPHLSTSP,B'00000100'                                0325
         BNZ   @RF00325                                            0325
*         CPHOFLOW='1'B;       /*SET OVERFLOW FLG*/                0326
         OI    CPHOFLOW,B'10000000'                                0326
*      ELSE;                   /*NOT OVER FLOW*/                   0327
@RF00325 DS    0H                                                  0328
*    /*CMZPEND*/                                                   0328
*     DO;                                                          0328
*    GPR14P = CMZX9906;                                            0329
*                                                                  0329
         LR    GPR14P,CMZX9906                                     0329
*    END ;                                                         0330
*    END CPHSUB34;                                                 0331
@EL00004 DS    0H                                                  0331
@EF00004 DS    0H                                                  0331
@ER00004 BR    @14                                                 0331
*/********************************************************************/
*/*                                                                  */
*/*        CPHSUB05: FUNCTION 5 ROUTINE                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0332
*  CPHSUB05: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                   0332
CPHSUB05 DS    0H                                                  0333
*  /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                        0333
*   DO;                                                            0333
*  CMZX9907 = GPR14P;                                              0334
*                                                                  0334
         LR    CMZX9907,GPR14P                                     0334
*  END ;                                                           0335
*                      /* R1=PARM STRING PTR R2=OUTPUT AREA PTR*/  0336
*/*  RESET COUNT FIELD AND LIMIT OF OUTPUT AREA (PHRF5NSP & CPHOALIM)*/
*   PHRF5NSP=0;                                                    0336
         SLR   @10,@10                                             0336
         ST    @10,PHRF5NSP(,GPR02P)                               0336
*   CPHOALIM=(PHROALEN-(ADDR(PHRF5ENT(1))-GPR02P))/LENGTH(PHRF5ENT);
         LA    @10,PHRF5ENT(,GPR02P)                               0337
         SLR   @10,GPR02P                                          0337
         LR    @08,@10                                             0337
         LCR   @08,@08                                             0337
         AL    @08,PHROALEN(,GPR02P)                               0337
         SRDA  @08,32                                              0337
         D     @08,@CF00046                                        0337
         ST    @09,CPHOALIM                                        0337
*             /*PROCESS ENTRIES WHILE NO ERRORS*/                  0338
*LOOP5:                                                            0338
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHSYNER='0'B);  0338
LOOP5    LA    @10,1                                               0338
         B     @DE00338                                            0338
@DL00338 TM    CPHLSTSP,B'00000101'                                0338
         BNZ   @DC00338                                            0338
*      /*ICALL(CPHSUBSC)*/                                         0339
*      F5LOOP: DO;                                                 0339
F5LOOP   DS    0H                                                  0340
*      CALL CPHSUBSC;                                              0340
*                                                                  0340
         BAL   @14,CPHSUBSC                                        0340
*      END F5LOOP;     /* LOCATE NEXT SUBPARAM*/                   0341
*                  /*CPHSPPTR= SUBPARAM PTR CPHSPLEN= SUBPARAM LENGTH*/
*      IF CPHSYNER='1'B         /* SYNTAX ERROR */                 0342
*         THEN;                 /*YES  */                          0342
         TM    CPHSYNER,B'00000001'                                0342
         BO    @RT00342                                            0342
*         ELSE DO;            /* NOT SYNTAX ERROR*/                0344
*            IF CPHSPPTR=0     /*PARM DEFAULTED*/                  0345
*               THEN;          /*YES*/                             0345
         L     @10,CPHSPPTR                                        0345
         LTR   @10,@10                                             0345
         BZ    @RT00345                                            0345
*               ELSE DO;             /*NOT DEFAULTED*/             0347
*                   /*ICALL(CPHVALCK)*/                            0348
*                    DO;                                           0348
*                   CALL CPHVALCK;                                 0349
*                                                                  0349
         BAL   @14,CPHVALCK                                        0349
*                   END ;  /* CHECK SUBPARAM VALIDITY*/            0350
*                  PHRF5VF(CPHOANDX)=CPHVALFG;/*SET VAL FLGS IN OUTARA*
         L     @10,CPHOANDX                                        0351
         SLA   @10,3                                               0351
         ALR   @10,GPR02P                                          0351
         MVC   PHRF5VF-8(1,@10),CPHVALFG                           0351
*               END;                 /*END NOT DEFAULTED*/         0352
*            PHRF5SL(CPHOANDX)=CPHSPLEN;/*SET LENGTH IN OUT AREA*/ 0353
@RT00345 L     @10,CPHOANDX                                        0353
         SLA   @10,3                                               0353
         LH    @09,CPHSPLEN                                        0353
         STH   @09,PHRF5SL-8(@10,GPR02P)                           0353
*            PHRF5SPT(CPHOANDX)=CPHSPPTR;/*PUT PTR IN OUT AREA*/   0354
         L     @09,CPHSPPTR                                        0354
         ST    @09,PHRF5SPT-8(@10,GPR02P)                          0354
*            PHRF5NSP=PHRF5NSP+1;   /*INCR COUNT*/                 0355
         LA    @10,1                                               0355
         AL    @10,PHRF5NSP(,GPR02P)                               0355
         ST    @10,PHRF5NSP(,GPR02P)                               0355
*         END;                  /*END NOT SYNTAX ERROR*/           0356
*   END LOOP5;                  /*END DO WHILE*/                   0357
@RT00342 LA    @10,1                                               0357
         AL    @10,CPHOANDX                                        0357
@DE00338 ST    @10,CPHOANDX                                        0357
         C     @10,CPHOALIM                                        0357
         BNH   @DL00338                                            0357
@DC00338 DS    0H                                                  0358
*   IF CPHOANDX>CPHOALIM /*OVER FLOW AND NOT END OF LIST*/         0358
*      THEN                     /*YES */                           0358
         L     @10,CPHOANDX                                        0358
         C     @10,CPHOALIM                                        0358
         BNH   @RF00358                                            0358
*         CPHOFLOW='1'B;        /*SET OVERFLOW FLAG*/              0359
         OI    CPHOFLOW,B'10000000'                                0359
*      ELSE;                    /*NOT OVERFLOW*/                   0360
@RF00358 DS    0H                                                  0361
*    /*CMZPEND*/                                                   0361
*     DO;                                                          0361
*    GPR14P = CMZX9907;                                            0362
*                                                                  0362
         LR    GPR14P,CMZX9907                                     0362
*    END ;                                                         0363
*    END CPHSUB05;                                                 0364
@EL00005 DS    0H                                                  0364
@EF00005 DS    0H                                                  0364
@ER00005 BR    @14                                                 0364
*/********************************************************************/
*/*                                                                  */
*/*        CPHSUB06: FUNCTION 6 ROUTINE                              */
*/*                                                                  */
*/********************************************************************/
*   CPHSUB06: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0365
CPHSUB06 DS    0H                                                  0366
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0366
*    DO;                                                           0366
*   CMZX9908 = GPR14P;                                             0367
*                                                                  0367
         LR    CMZX9908,GPR14P                                     0367
*   END ;                                                          0368
*                            /* R1=PARM STRING POINTER */          0369
*   DO WHILE (CPHLSTSP='0'B & CPHSYNER='0'B);    /*PROCESS PARMS*/ 0369
         B     @DE00369                                            0369
@DL00369 DS    0H                                                  0370
*     /*ICALL(CPHSUBSC)*/                                          0370
*     F6LOOP: DO;                                                  0370
F6LOOP   DS    0H                                                  0371
*     CALL CPHSUBSC;                                               0371
*                                                                  0371
         BAL   @14,CPHSUBSC                                        0371
*     END F6LOOP;   /*LOCATE NEXT SUBPARAM              */         0372
*   END;                   /*END DO WHILE*/                        0373
@DE00369 TM    CPHLSTSP,B'00000101'                                0373
         BZ    @DL00369                                            0373
*    /*CMZPEND*/                                                   0374
*     DO;                                                          0374
*    GPR14P = CMZX9908;                                            0375
*                                                                  0375
         LR    GPR14P,CMZX9908                                     0375
*    END ;                                                         0376
*    END CPHSUB06;                                                 0377
@EL00006 DS    0H                                                  0377
@EF00006 DS    0H                                                  0377
@ER00006 BR    @14                                                 0377
*/*******************************************************************/
*/*                                                                  */
*/*       CPHSUB07: FUNCTIONS 7 AND 8 ROUTINE                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0378
*   CPHSUB07: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0378
CPHSUB07 DS    0H                                                  0379
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0379
*    DO;                                                           0379
*   CMZX9909 = GPR14P;                                             0380
*                                                                  0380
         LR    CMZX9909,GPR14P                                     0380
*   END ;                                                          0381
* /*RESET COUNT FIELD AND LIMIT IN OUTPUT AREA (PHRF7NSP & CPHOALIM)*/
* IF CPHFUNNO=CPHFUN07 THEN DO;                            /*@D32CKKA*/
         TM    CPHFUNNO,B'00000111'                                0382
         BNO   @RF00382                                            0382
         TM    CPHFUNNO,B'00001000'                                0382
         BNZ   @RF00382                                            0382
*   PHRF7NSP=0;                                                    0384
         SLR   @10,@10                                             0384
         ST    @10,PHRF7NSP(,GPR02P)                               0384
*   CPHOALIM=(PHROALEN-(ADDR(PHRF7NUM(1))-GPR02P))/LENGTH(PHRF7NUM);
         LA    @10,PHRF7NUM(,GPR02P)                               0385
         SLR   @10,GPR02P                                          0385
         LCR   @10,@10                                             0385
         AL    @10,PHROALEN(,GPR02P)                               0385
         ST    @10,CPHOALIM                                        0385
*    END;                                                  /*@D32CKKA*/
* ELSE DO;                          /*DO SAME FOR FUNCTION 8 @D32CKKA*/
         B     @RC00382                                            0387
@RF00382 DS    0H                                                  0388
*   PHRF8NSP=0;                                            /*@D32CKKA*/
         SLR   @10,@10                                             0388
         ST    @10,PHRF8NSP(,GPR02P)                               0388
*   CPHOALIM=(PHROALEN-(ADDR(PHRF8ENT(1))-GPR02P))/LENGTH(PHRF8ENT);
         LA    @10,PHRF8ENT(,GPR02P)                               0389
         SLR   @10,GPR02P                                          0389
         LR    @08,@10                                             0389
         LCR   @08,@08                                             0389
         AL    @08,PHROALEN(,GPR02P)                               0389
         SRDA  @08,32                                              0389
         D     @08,@CF00313                                        0389
         ST    @09,CPHOALIM                                        0389
*    END;                                                  /*@D32CKKA*/
*                      /*  R1=PARM STRING PTR R2=OUTPUT AREA PTR*/ 0391
*LOOP7:                                                            0391
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHFUNER='0'B&   0391
*         CPHSYNER='0'B);/*PROCESS ENTRIES*/                       0391
@RC00382 DS    0H                                                  0391
LOOP7    LA    @10,1                                               0391
         B     @DE00391                                            0391
@DL00391 TM    CPHLSTSP,B'00000100'                                0391
         BNZ   @DC00391                                            0391
         TM    CPHFUNER,B'01000000'                                0391
         BNZ   @DC00391                                            0391
         TM    CPHSYNER,B'00000001'                                0391
         BNZ   @DC00391                                            0391
*      /*ICALL(CPHSUBSC)*/                                         0392
*      F7LOOP: DO;                                                 0392
F7LOOP   DS    0H                                                  0393
*      CALL CPHSUBSC;                                              0393
*                                                                  0393
         BAL   @14,CPHSUBSC                                        0393
*      END F7LOOP;            /* LOCATE NEXT SUBPARAM*/            0394
*                  /* CPHSPPTR= SUBPARAM PTR CPHSPLEN= SUBPARAM LENGTH*
*      IF CPHSYNER='1'B              /*SYNTAX ERROR*/              0395
*         THEN;                     /*YES */                       0395
         TM    CPHSYNER,B'00000001'                                0395
         BO    @RT00395                                            0395
*         ELSE DO;                   /*NOT SYNTAX ERROR*/          0397
*            CPHVALBT=CPHVALBT×'40'X;   /*CHECK FOR NUMERICS @DM12920*/
         OI    CPHVALBT,X'40'                                      0398
*            IF CPHSPPTR*CPHSPLEN=0 /*SUB PARM DEFAULTED*/         0399
*             THEN IF CPHFUNNO=CPHFUN07  /*DEFAULTED AND F7  @D32CKKA*/
         L     @10,CPHSPPTR                                        0399
         MH    @10,CPHSPLEN                                        0399
         LTR   @10,@10                                             0399
         BNZ   @RF00399                                            0399
*               THEN CPHFUNER='1'B;  /*SET FUNCTION ERROR    @D32CKKA*/
         TM    CPHFUNNO,B'00000111'                                0400
         BNO   @RF00400                                            0400
         TM    CPHFUNNO,B'00001000'                                0400
         BNZ   @RF00400                                            0400
         OI    CPHFUNER,B'01000000'                                0401
*               ELSE DO;               /*DEFAULTED AND FUNC8 @D32CKKA*/
         B     @RC00400                                            0402
@RF00400 DS    0H                                                  0403
*                 PHRF8DFT(CPHOANDX)='1'B;  /*DEFAULT FLG ON @D32CKKA*/
         L     @10,CPHOANDX                                        0403
         ALR   @10,@10                                             0403
         ST    @10,@TF00001                                        0403
         ALR   @10,GPR02P                                          0403
         OI    PHRF8DFT-2(@10),B'10000000'                         0403
*                 PHRF8NSP=PHRF8NSP+1;   /*INC SUBPARM COUNT @D32CKKA*/
         LA    @10,1                                               0404
         AL    @10,PHRF8NSP(,GPR02P)                               0404
         ST    @10,PHRF8NSP(,GPR02P)                               0404
*                 PHRF8NUM(CPHOANDX)='00'X;    /*CLEAR VALUE @D32CKKA*/
         SLR   @10,@10                                             0405
         L     @09,@TF00001                                        0405
         STC   @10,PHRF8NUM-2(@09,GPR02P)                          0405
*                 END;                                     /*@D32CKKA*/
*               ELSE DO;       /*NOT DEFAULTED*/                   0407
         B     @RC00399                                            0407
@RF00399 DS    0H                                                  0408
*                   /*ICALL(CPHVALCK)*/                            0408
*                    DO;                                           0408
*                   CALL CPHVALCK;                                 0409
*                                                                  0409
         BAL   @14,CPHVALCK                                        0409
*                   END ;     /*CHECK SUBPARAM FOR NUMERIC*/       0410
*                  IF CPHVALNU='1'B ×  /*NOT NUMERIC         @DM10621*/
*                     CPHVALAN='1'B /*OR NOT ALPHA NUMERIC   @DM10621*/
*                     THEN               /*YES*/                   0411
         TM    CPHVALNU,B'01100000'                                0411
         BZ    @RF00411                                            0411
*                        CPHFUNER='1'B;   /*SET FUNCTION ERROR*/   0412
         OI    CPHFUNER,B'01000000'                                0412
*                     ELSE DO;   /*NOT AN ERROR*/                  0413
         B     @RC00411                                            0413
@RF00411 DS    0H                                                  0414
*                        IF CPHSPLEN>3 /*GR THAN 3 CHAR*/          0414
*                           THEN      /*YES*/                      0414
         LH    @10,CPHSPLEN                                        0414
         C     @10,@CF00193                                        0414
         BNH   @RF00414                                            0414
*                              CPHFUNER='1'B;  /*SET FUNCT ERROR*/ 0415
         OI    CPHFUNER,B'01000000'                                0415
*                           ELSE DO;  /*NOT GR TAHN 3*/            0416
         B     @RC00414                                            0416
@RF00414 DS    0H                                                  0417
*                               /* CONVERT DECIMAL SUBPARAM TO HEX*/
*                              CPHDECHX='000';/* INIT HOLD AREA     */
         MVC   CPHDECHX(3),@CC00294                                0417
*                              CPHDECHX(4-CPHSPLEN:3)=     /*MOVE NO.*/
*                              CPHSPPTR->CPHSBYTE(1:CPHSPLEN);     0418
         LA    @10,4                                               0418
         SH    @10,CPHSPLEN                                        0418
         LA    @09,CPHDECHX-1(@10)                                 0418
         LCR   @10,@10                                             0418
         AL    @10,@CF00193                                        0418
         L     @08,CPHSPPTR                                        0418
         EX    @10,@SM00439                                        0418
*                              PACK(CPHDECHX,CPHDECHX);            0419
         PACK  CPHDECHX(3),CPHDECHX(3)                             0419
*                                     /* PACK EBCDIC TO DIGITS + SIGN*/
*                              CVB(GPR15F,CPHDECHX);               0420
         XC    @TS00001(8),@TS00001                                0420
         MVC   @TS00001+5(3),CPHDECHX                              0420
         CVB   GPR15F,@TS00001                                     0420
*                                     /* PUT HEX VALUE IN REGISTER 1*/
*                              IF GPR15F>255 /*PARM GR THAN 255*/  0421
*                                 THEN    /*YES*/                  0421
         C     GPR15F,@CF00297                                     0421
         BNH   @RF00421                                            0421
*                                    CPHFUNER='1'B;/*SET FUNCTION ERR*/
         OI    CPHFUNER,B'01000000'                                0422
*                                   ELSE IF CPHFUNNO=CPHFUN07      0423
*                                    THEN DO;             /*@D32CKKA*/
         B     @RC00421                                            0423
@RF00421 TM    CPHFUNNO,B'00000111'                                0423
         BNO   @RF00423                                            0423
         TM    CPHFUNNO,B'00001000'                                0423
         BNZ   @RF00423                                            0423
*                                   /* MOVE HEX BYTE TO OUTPUT AREA*/
*                                     PHRF7NUM(CPHOANDX)=GPR15F;   0425
         L     @10,CPHOANDX                                        0425
         STC   GPR15F,PHRF7NUM-1(@10,GPR02P)                       0425
*                                     PHRF7NSP=PHRF7NSP+1;/*INCR CNT*/
         LA    @10,1                                               0426
         AL    @10,PHRF7NSP(,GPR02P)                               0426
         ST    @10,PHRF7NSP(,GPR02P)                               0426
*                                     END;  /*END FUNC 7 @D32CKKA*/
*                                    ELSE DO; /*FUNC 8 @D32CKKA*/  0428
         B     @RC00423                                            0428
@RF00423 DS    0H                                                  0429
*                                      /*MOVE DATA TO OUTPUT AREA*/
*                                     PHRF8NUM(CPHOANDX)=GPR15F;   0429
         L     @10,CPHOANDX                                        0429
         ALR   @10,@10                                             0429
         STC   GPR15F,PHRF8NUM-2(@10,GPR02P)                       0429
*                                     PHRF8NSP=PHRF8NSP+1; /*@D32CKKA*/
         LA    @09,1                                               0430
         AL    @09,PHRF8NSP(,GPR02P)                               0430
         ST    @09,PHRF8NSP(,GPR02P)                               0430
*                                     PHRF8DFT(CPHOANDX)='0'B;     0431
         ALR   @10,GPR02P                                          0431
         NI    PHRF8DFT-2(@10),B'01111111'                         0431
*                                     /*INC NUMBER OF PARMS AND CLEAR*/
*                                     /*DEFAULT FLAG        @D32CKKA*/
*                                     END; /*END FUNC 8 @D32CKKA*/ 0432
*                           END;         /*END NOT GR THAN 3*/     0433
@RC00423 DS    0H                                                  0433
@RC00421 DS    0H                                                  0434
*                     END;               /*END NO ERRORS*/         0434
@RC00414 DS    0H                                                  0435
*               END;                     /*END NOT DEFAULTED*/     0435
@RC00411 DS    0H                                                  0436
*         END;                           /*END NOT SYNTAX ERROR*/  0436
@RC00399 DS    0H                                                  0437
*   END LOOP7;                            /*END DO WHILE*/         0437
@RT00395 LA    @10,1                                               0437
         AL    @10,CPHOANDX                                        0437
@DE00391 ST    @10,CPHOANDX                                        0437
         C     @10,CPHOALIM                                        0437
         BNH   @DL00391                                            0437
@DC00391 DS    0H                                                  0438
*   IF CPHOANDX>CPHOALIM                 /*OVERFLOW*/              0438
*      THEN                             /*YES*/                    0438
         L     @10,CPHOANDX                                        0438
         C     @10,CPHOALIM                                        0438
         BNH   @RF00438                                            0438
*         CPHOFLOW='1'B;                /*SET OVERFLOW FLG*/       0439
         OI    CPHOFLOW,B'10000000'                                0439
*      ELSE;                            /*NOT OVERFLOW*/           0440
@RF00438 DS    0H                                                  0441
*  /*CMZPEND*/                                                     0441
*   DO;                                                            0441
*  GPR14P = CMZX9909;                                              0442
*                                                                  0442
         LR    GPR14P,CMZX9909                                     0442
*  END ;                                                           0443
*  END CPHSUB07;                                                   0444
@EL00007 DS    0H                                                  0444
@EF00007 DS    0H                                                  0444
@ER00007 BR    @14                                                 0444
*/********************************************************************/
*/*                                                                  */
*/*      CPHTBLSC: TABLE SEARCH ROUTINE                              */
*/*                                                                  */
*/********************************************************************/
*   CPHTBLSC: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0445
CPHTBLSC DS    0H                                                  0446
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0446
*    DO;                                                           0446
*   CMZX9903 = GPR14P;                                             0447
*                                                                  0447
         LR    CMZX9903,GPR14P                                     0447
*   END ;                                                          0448
*   CPHTABSV=CPHTABAD;         /*SAVE TABLE PTR IN CPHTABSV*/      0449
         L     @10,CPHTABAD                                        0449
         ST    @10,CPHTABSV                                        0449
*   CPHARGNF='1'B;          /*INIT ARG NOT FOUND ON*/              0450
         OI    CPHARGNF,B'00100000'                                0450
*TBLOOP:                    /*SEARCH FOR ARG*/                     0451
*   DO CPHENCTR=1 TO CPHTABSV->CPHENTNO WHILE(CPHARGNF='1'B);      0451
TBLOOP   LA    @10,1                                               0451
         B     @DE00451                                            0451
@DL00451 TM    CPHARGNF,B'00100000'                                0451
         BNO   @DC00451                                            0451
*      IF CPHKEYWD(1)=CPHARGUM /*IS THIS THE CORRECT ONE*/         0452
*         THEN DO;             /*YES*/                             0452
         L     @10,CPHTABAD                                        0452
         CLC   CPHKEYWD(8,@10),CPHARGUM                            0452
         BNE   @RF00452                                            0452
*            CPHSUBVL(1:CPHTABSV->CPHENTLN-8)=CPHFUNBT(1,1:CPHTABSV->
*             CPHENTLN-8);    /*MOVE ENTRY MINUS FIRST 8*/         0454
         L     @09,CPHTABSV                                        0454
         ICM   @09,12,CPHENTLN(@09)                                0454
         SRA   @09,16                                              0454
         SL    @09,@CF00271                                        0454
         EX    @09,@SM00442                                        0454
*            CPHARGNF='0'B;    /*RESET ARG NOT FOUND FLG*/         0455
         NI    CPHARGNF,B'11011111'                                0455
*         END;                 /*END CORRECT ENTRY*/               0456
*         ELSE                 /*NOT CORRECT ENTRY*/               0457
*            CPHTABAD=CPHTABSV->CPHENTLN+CPHTABAD;/*GET NEXT ENTRY*/
         B     @RC00452                                            0457
@RF00452 L     @10,CPHTABSV                                        0457
         ICM   @10,12,CPHENTLN(@10)                                0457
         SRA   @10,16                                              0457
         AL    @10,CPHTABAD                                        0457
         ST    @10,CPHTABAD                                        0457
*   END TBLOOP;                                                    0458
@RC00452 LA    @10,1                                               0458
         AH    @10,CPHENCTR                                        0458
@DE00451 STH   @10,CPHENCTR                                        0458
         L     @09,CPHTABSV                                        0458
         ICM   @09,12,CPHENTNO(@09)                                0458
         SRA   @09,16                                              0458
         CR    @10,@09                                             0458
         BNH   @DL00451                                            0458
@DC00451 DS    0H                                                  0459
*   /*CMZPEND*/                                                    0459
*   TBR: DO;                                                       0459
TBR      DS    0H                                                  0460
*   GPR14P = CMZX9903;                                             0460
*                                                                  0460
         LR    GPR14P,CMZX9903                                     0460
*   END TBR;                                                       0461
*   END CPHTBLSC;                                                  0462
@EL00008 DS    0H                                                  0462
@EF00008 DS    0H                                                  0462
@ER00008 BR    @14                                                 0462
*/********************************************************************/
*/*                                                                  */
*/*      CPHVALCK: VALIDITY CHECK ROUTINE                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0463
*   CPHVALCK: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0463
CPHVALCK DS    0H                                                  0464
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0464
*    DO;                                                           0464
*   CMZX9910 = GPR14P;                                             0465
*                                                                  0465
         LR    CMZX9910,GPR14P                                     0465
*   END ;                  /*@ZA27161*/                            0466
*   CPHVCK01=GPR01P;           /* SAVE REG01                 @ZA27161*/
         ST    GPR01P,CPHVCK01                                     0467
*   CPHVCK02=GPR02P;           /* SAVE REG02                 @ZA27161*/
         ST    GPR02P,CPHVCK02                                     0468
*   CPHVALFG='00'X;            /* RESET ERROR INDICATORS*/         0469
         MVI   CPHVALFG,X'00'                                      0469
*   IF CPHVALBT(1:4)='0000'B   /*VAL CHECKING CALLED FOR*/         0470
*      THEN;                   /*NO*/                              0470
         TM    CPHVALBT,B'11110000'                                0470
         BZ    @RT00470                                            0470
*      ELSE DO;                /*YES*/                             0472
*         CPHVALPS=1;           /*INIT SUBPARAM STRING POINTER*/   0473
         MVC   CPHVALPS(4),@CF00048                                0473
*         IF CPHFUNFC='1'B   /*CK 1ST CHAR ALPHA*/                 0474
*            THEN DO;           /*YES*/                            0474
         TM    CPHFUNFC,B'00010000'                                0474
         BNO   @RF00474                                            0474
*                          /* TRT CHAR. TO CLASSIFY TYPE*/         0476
*               GPR02F=0;     /* INIT TRT CODE REGISTER TO ZERO*/  0476
         SLR   GPR02F,GPR02F                                       0476
*               TRT(CPHSPPTR->CPHSBYTE(1),CPHVTRTB);               0477
         L     @10,CPHSPPTR                                        0477
         TRT   CPHSBYTE(1,@10),CPHVTRTB                            0477
*               IF GPR02F=1    /*IS CHAR ALPHA*/                   0478
*                  THEN DO;             /*YES*/                    0478
         LA    @10,1                                               0478
         CR    GPR02F,@10                                          0478
         BNE   @RF00478                                            0478
*                     IF CPHFUNAN='1'B /*CK ALPHA NUMERIC*/        0480
*                        THEN                 /*YES*/              0480
         TM    CPHFUNAN,B'00100000'                                0480
         BNO   @RF00480                                            0480
*                           CPHVALPS=CPHVALPS+1;/*INCR CHAR PTR*/  0481
         AL    @10,CPHVALPS                                        0481
         ST    @10,CPHVALPS                                        0481
*                         ELSE   /*NOT CK ALPHA NUMERIC*/          0482
*                            CPHVALPS=CPHSPLEN+1; /*SET END*/      0482
         B     @RC00480                                            0482
@RF00480 LA    @10,1                                               0482
         AH    @10,CPHSPLEN                                        0482
         ST    @10,CPHVALPS                                        0482
*                  END;        /*END CHAR ALPHA*/                  0483
*                  ELSE        /*NOT ALPHA*/                       0484
*                     CPHVALFC='1'B;         /* SET ERROR INDICATOR*/
         B     @RC00478                                            0484
@RF00478 OI    CPHVALFC,B'00010000'                                0484
*            END;               /*END CK FIRST CHAR ALPHA*/        0485
*            ELSE;              /*NOT CK FIRST ALPHA*/             0486
@RF00474 DS    0H                                                  0487
*                             /*VAL CK ENTRY*/                     0487
*VALLOOP:                                                          0487
*       DO CPHVALPS=CPHVALPS TO CPHSPLEN WHILE(CPHVALFG='00'X);    0487
@RC00474 DS    0H                                                  0487
VALLOOP  L     @10,CPHVALPS                                        0487
         B     @DE00487                                            0487
@DL00487 CLI   CPHVALFG,X'00'                                      0487
         BNE   @DC00487                                            0487
*          /* TRT CHAR. AT CPHVALPS USING CPHVTRTB TO FIND TYPE   */
*         GPR02F=0;             /*INIT TRT CODE REG TO 0*/         0488
         SLR   GPR02F,GPR02F                                       0488
*         TRT(CPHSPPTR->CPHSBYTE(CPHVALPS),CPHVTRTB);              0489
         L     @10,CPHSPPTR                                        0489
         AL    @10,CPHVALPS                                        0489
         AL    @10,@CF00260                                        0489
         TRT   CPHSBYTE(1,@10),CPHVTRTB                            0489
*         IF GPR02F=1           /*IS CHAR ALPHA*/                  0490
*             THEN DO;          /*YES*/                            0490
         C     GPR02F,@CF00048                                     0490
         BNE   @RF00490                                            0490
*                IF CPHFUNNU='1'B /*CHECK NUMERIC*/                0492
*                   THEN                /*YES*/                    0492
         TM    CPHFUNNU,B'01000000'                                0492
         BNO   @RF00492                                            0492
*                      CPHVALNU='1'B;   /*SET ERROR FLG*/          0493
         OI    CPHVALNU,B'01000000'                                0493
*                    ELSE;          /*NOT CHECK NUMERIC*/          0494
@RF00492 DS    0H                                                  0495
*             END;                 /*END CHAR ALPHA*/              0495
*             ELSE DO;           /*CHAR NOT ALPHA*/                0496
         B     @RC00490                                            0496
@RF00490 DS    0H                                                  0497
*                IF GPR02F=2  /*IS CHAR NUMERIC*/                  0497
*                   THEN;       /*YES*/                            0497
         C     GPR02F,@CF00313                                     0497
         BE    @RT00497                                            0497
*                   ELSE        /*NO*/                             0499
*                      CPHVALAN='1'B; /*SET ERROR FLG*/            0499
         OI    CPHVALAN,B'00100000'                                0499
*             END;              /*END CHAR NOT ALPHA*/             0500
@RT00497 DS    0H                                                  0501
*       END VALLOOP;                                               0501
@RC00490 LA    @10,1                                               0501
         AL    @10,CPHVALPS                                        0501
         ST    @10,CPHVALPS                                        0501
@DE00487 CH    @10,CPHSPLEN                                        0501
         BNH   @DL00487                                            0501
@DC00487 DS    0H                                                  0502
*     END;                                                         0502
*   GPR01P=CPHVCK01;           /* RESTORE REG01              @ZA27161*/
@RT00470 L     GPR01P,CPHVCK01                                     0503
*   GPR02P=CPHVCK02;           /* RESTORE REG02              @ZA27161*/
         L     GPR02P,CPHVCK02                                     0504
*   /*CMZPEND*/                                                    0505
*   VALR: DO;                                                      0505
VALR     DS    0H                                                  0506
*   GPR14P = CMZX9910;                                             0506
*                                                                  0506
         LR    GPR14P,CMZX9910                                     0506
*   END VALR;                                                      0507
*   END CPHVALCK;                                                  0508
@EL00009 DS    0H                                                  0508
@EF00009 DS    0H                                                  0508
@ER00009 BR    @14                                                 0508
*/********************************************************************/
*/*                                                                  */
*/*       CPHSUBSC: SUBPARAMETER SCAN ROUTINE                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0509
*   CPHSUBSC: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0509
CPHSUBSC DS    0H                                                  0510
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0510
*    DO;                                                           0510
*   CMZX9902 = GPR14P;                                             0511
*                                                                  0511
         LR    CMZX9902,GPR14P                                     0511
*   END ;                  /*@ZA27161*/                            0512
*   CPHSCN00=GPR00P;           /* SAVE REG00                 @ZA27161*/
         ST    GPR00P,CPHSCN00                                     0513
*   CPHSCN02=GPR02P;           /* SAVE REG02                 @ZA27161*/
         ST    GPR02P,CPHSCN02                                     0514
*                              /*  REG1= ADDR OF PARM STRING*/     0515
*   CPHTCHAR=0;                /*   SET CPHTCHAR = X'00'*/         0515
         MVI   CPHTCHAR,X'00'                                      0515
*                 /* RESET CPHENDSP, CPHSPLEN, CPHSBPAR, AND CPHSPPTR*/
*   CPHSPLEN=0;                                                    0516
         SLR   @10,@10                                             0516
         STH   @10,CPHSPLEN                                        0516
*   CPHSPPTR=0;                                                    0517
         ST    @10,CPHSPPTR                                        0517
*   CPHENDSP='0'B;                                                 0518
         NI    CPHENDSP,B'11110111'                                0518
*   CPHSBPAR=0;                                                    0519
         STH   @10,CPHSBPAR                                        0519
*   IF GPR01P->CPHSBYTE(1)=' '&CPHKWSCN='1'B /*BLNK IN SCAN*/      0520
*      THEN                  /*YES BLANK WHILE SCANNING*/          0520
         CLI   CPHSBYTE(GPR01P),C' '                               0520
         BNE   @RF00520                                            0520
         TM    CPHKWSCN,B'00100000'                                0520
         BNO   @RF00520                                            0520
*         CPHENDST='1'B;     /*SET STRING EXHAUSTED*/              0521
         OI    CPHENDST,B'00010000'                                0521
*      ELSE DO;              /*NOT STRING EXHAUSTED*/              0522
         B     @RC00520                                            0522
@RF00520 DS    0H                                                  0523
*SS1:                                                              0523
*         IF CPHKWSCN='1'B   /*ARE WE SCANNING A KWD*/             0523
*            THEN            /*YES*/                               0523
SS1      TM    CPHKWSCN,B'00100000'                                0523
         BNO   @RF00523                                            0523
*               CPHKWPTR=GPR01P; /*PUT STRING PTR IN WKPTR*/       0524
         ST    GPR01P,CPHKWPTR                                     0524
*            ELSE;               /*NOT KWD SCAN*/                  0525
@RF00523 DS    0H                                                  0526
*SS5:                                       /*DOWHILE NOT END OF SCAN*/
*         DO WHILE(CPHENDSP='0'B&CPHSYNER='0'B)×(CPHLSTSP='1'B &   0526
*             CPHSLIST='1'B&CPHSYNER='0'B);                        0526
SS5      B     @DE00526                                            0526
@DL00526 DS    0H                                                  0527
*            /*ICALL(CPHSBTRT)*/                                   0527
*             DO;                                                  0527
*            CALL CPHSBTRT;                                        0528
*                                                                  0528
         BAL   @14,CPHSBTRT                                        0528
*            END ;          /* TRT:SCAN TO NEXT DELIMITER*/        0529
*            CPHTCHAR=GPR02F;       /*SAVE CHAR CODE IN TCHAR*/    0530
         STC   GPR02F,CPHTCHAR                                     0530
*                  /* CALCULATE TABLE INDEX FROM CPHTCHAR & CPHLCHAR*/
*            CPHSCNPT=CPHSCNTB(CPHTCHAR+1,CPHLCHAR+1);             0531
         SLR   @10,@10                                             0531
         IC    @10,CPHTCHAR                                        0531
         MH    @10,@CH00080                                        0531
         SLR   @09,@09                                             0531
         IC    @09,CPHLCHAR                                        0531
         ALR   @10,@09                                             0531
         SLA   @10,2                                               0531
         L     @10,CPHSCNTB(@10)                                   0531
         ST    @10,CPHSCNPT                                        0531
*             /*ICALL(CPHSCNPT)FLOWS(CPHCSP01,CPHCSP02,CPHCSP03,CPHCSP0
*,CPHCSP05,CPHCSP06,CPHCSP07,CPHCSP08,CPHCSP13,CPHCSP09,CPHCSP10,CPHCSP
*2,CPHCSP14)*/                                                     0532
*              DO;                                                 0532
*             DCL CMZP0157 BASED ENTRY VALRG (CPHCSP01,CPHCSP02,CPHCSP0
*,CPHCSP04,CPHCSP05,CPHCSP06,CPHCSP07,CPHCSP08,CPHCSP13,CPHCSP09,CPHCSP
*0,CPHCSP12,CPHCSP14) ;                                            0533
*             CALL CPHSCNPT-> CMZP0157 ;                           0534
*                                                                  0534
         LR    @15,@10                                             0534
         BALR  @14,@15                                             0534
*             END ;  /* GO TO SUB-PROCESSOR*/                      0535
*            IF CPHSYNER='1'B×CPHTCHAR=6 /*SYNTAX ERR OR BLNK CHAR*/
*               THEN;                /*YES*/                       0536
         TM    CPHSYNER,B'00000001'                                0536
         BO    @RT00536                                            0536
         CLI   CPHTCHAR,6                                          0536
         BE    @RT00536                                            0536
*               ELSE DO;             /*NOT SYNTAX OR BLANK*/       0538
*                  CPHLCHAR=CPHTCHAR; /*PUT CURRENT  CHAR IN LAST CHAR*
         MVC   CPHLCHAR(1),CPHTCHAR                                0539
*                  GPR01P=GPR01P+1;   /*INCREMENT STRING PTR*/     0540
         AL    GPR01P,@CF00048                                     0540
*                END;                 /*END NOT SYNTAX OR BLANK*/  0541
*         END SS5;                    /*END DO WHILE*/             0542
@RT00536 DS    0H                                                  0542
@DE00526 TM    CPHENDSP,B'00001001'                                0542
         BZ    @DL00526                                            0542
         TM    CPHLSTSP,B'00000110'                                0542
         BNO   @DC00526                                            0542
         TM    CPHSYNER,B'00000001'                                0542
         BZ    @DL00526                                            0542
@DC00526 DS    0H                                                  0543
*      END;                           /*END NOT STRING EXHAUSTED*/ 0543
*/*******************************************************************/
*/*                                                                 */
*/*      CPHSBTRT: TRANSLATE AND TEST ROUTINE                       */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0544
*   CPHSBTRT: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0544
         B     @PB00011                                            0544
CPHSBTRT DS    0H                                                  0545
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0545
*    DO;                                                           0545
*   CMZX9911 = GPR14P;                                             0546
*                                                                  0546
         LR    CMZX9911,GPR14P                                     0546
*   END ;                                                          0547
*   CPHCONT='1'B;               /* SET CONTINUE FLAG*/             0548
         OI    CPHCONT,B'01000000'                                 0548
*   CPHTRTSV=GPR01P;              /*    SAVE START PTR   */        0549
         ST    GPR01P,CPHTRTSV                                     0549
*   GPR03P=GPR01P;               /*  SET R3 = INPUT PARM STRING PTR*/
         LR    GPR03P,GPR01P                                       0550
*TR3:                                                              0551
*   DO WHILE(CPHCONT='1'B);       /* SCAN 256 BYTES FOR A DELIMITER*/
TR3      B     @DE00551                                            0551
@DL00551 DS    0H                                                  0552
*      GPR02F=0;                  /*CLEAR OUTPUT CODE REG*/        0552
         SLR   GPR02F,GPR02F                                       0552
*      TRT(GPR03P->CPHSBYTE(1:256),CPHTRTB);     /*TRANSLATE AND TEST*/
         TRT   CPHSBYTE(256,GPR03P),CPHTRTB                        0553
*                                    /* NOTE: DELIMITERS ARE  )(,= */
*                              /*QUOTE OR BLANK CODE IN REG2 AFTER TRT*
*       IF GPR02F^=0                  /*  DELIMITER FOUND */       0554
*          THEN                         /*YES*/                    0554
         LTR   GPR02F,GPR02F                                       0554
         BZ    @RF00554                                            0554
*             CPHCONT='0'B;            /*RESET CONTINUE FLAG*/     0555
         NI    CPHCONT,B'10111111'                                 0555
*          ELSE                        /*NO DELIMITER YET*/        0556
*             GPR03P=GPR03P+256;     /* PREPARE TO SCAN NEXT 256 BYTES*
         B     @RC00554                                            0556
@RF00554 AL    GPR03P,@CF00150                                     0556
*   END TR3;                          /*END DO WHILE*/             0557
@RC00554 DS    0H                                                  0557
@DE00551 TM    CPHCONT,B'01000000'                                 0557
         BO    @DL00551                                            0557
*                                      /* R1= DELIM ADDR*/         0558
*   GPR04P=GPR01P-CPHTRTSV;             /*SET R4 = LEN OF SUB PARM*/
         L     @10,CPHTRTSV                                        0558
         LR    GPR04P,GPR01P                                       0558
         SLR   GPR04P,@10                                          0558
*   GPR03P=CPHTRTSV;                     /* RESTORE START PTR*/    0559
         LR    GPR03P,@10                                          0559
*   IF GPR01P^=CPHTRTSV                  /*WAS DELIMITER FIRST CHAR*/
*      THEN DO;                          /*NO*/                    0560
         CR    GPR01P,@10                                          0560
         BE    @RF00560                                            0560
*         GPR02F=0;                      /*SET NON DILIMITER CODE*/
         SLR   GPR02F,GPR02F                                       0562
*         GPR01P=GPR01P-1;           /*DECREMENT STRING PTR*/      0563
         BCTR  GPR01P,0                                            0563
*      END;                           /*END NOT FIRST SCANNED*/    0564
*      ELSE;                          /*YES FIRST CHAR WAS DELIMITER*/
@RF00560 DS    0H                                                  0566
*   /*CMZPEND*/                                                    0566
*   TR5: DO;                                                       0566
TR5      DS    0H                                                  0567
*   GPR14P = CMZX9911;                                             0567
*                                                                  0567
         LR    GPR14P,CMZX9911                                     0567
*   END TR5;                                                       0568
*   END CPHSBTRT;                                                  0569
@EL00011 DS    0H                                                  0569
@EF00011 DS    0H                                                  0569
@ER00011 BR    @14                                                 0569
*/********************************************************************/
*/*                                                                  */
*/*        CPHCSP01: STORE SUBPARM PTR & LENGTH                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0570
*   CPHCSP01: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0570
CPHCSP01 DS    0H                                                  0571
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0571
*    DO;                                                           0571
*   CMZX9912 = GPR14P;                                             0572
*                                                                  0572
         LR    CMZX9912,GPR14P                                     0572
*   END ;                                                          0573
*   IF CPHSPPTR^=0           /* START SUBPARM PTR ALREADY SET*/    0574
*       THEN;                /* YES */                             0574
         L     @10,CPHSPPTR                                        0574
         LTR   @10,@10                                             0574
         BNZ   @RT00574                                            0574
*       ELSE                 /*NO*/                                0576
*          CPHSPPTR=GPR03P;  /*SAVE PARM STRING PTR*/              0576
         ST    GPR03P,CPHSPPTR                                     0576
*   CPHSPLEN=GPR04P+CPHSPLEN;  /*ADD LENGTH OF SUB PARM */         0577
@RT00574 LR    @10,GPR04P                                          0577
         AH    @10,CPHSPLEN                                        0577
         STH   @10,CPHSPLEN                                        0577
*    /*CMZPEND*/                                                   0578
*     DO;                                                          0578
*    GPR14P = CMZX9912;                                            0579
*                                                                  0579
         LR    GPR14P,CMZX9912                                     0579
*    END ;                                                         0580
*    END CPHCSP01;                                                 0581
@EL00012 DS    0H                                                  0581
@EF00012 DS    0H                                                  0581
@ER00012 BR    @14                                                 0581
*/********************************************************************/
*/*                                                                  */
*/*        CPHCSP02: END OF KEYWORD A                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0582
*   CPHCSP02: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0582
CPHCSP02 DS    0H                                                  0583
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0583
*    DO;                                                           0583
*   CMZX9913 = GPR14P;                                             0584
*                                                                  0584
         LR    CMZX9913,GPR14P                                     0584
*   END ;                                                          0585
*   IF CPHKWSCN='1'B                  /*KWD SCAN ON*/              0586
*      THEN DO;                       /*YES */                     0586
         TM    CPHKWSCN,B'00100000'                                0586
         BNO   @RF00586                                            0586
*         CPHKWLEN=CPHSPLEN;          /*SET KWD LEN = SUB PARM LEN*/
         LH    @10,CPHSPLEN                                        0588
         STH   @10,CPHKWLEN                                        0588
*         CPHKWSCN='0'B;              /*   RESET KWD SCAN FLAG*/   0589
*         CPHENDSP='1'B;               /*    SET END OF SUBPARM*/  0590
         OI    CPHENDSP,B'00001000'                                0590
         NI    CPHKWSCN,B'11011111'                                0590
*      END;                            /*END KWD SCAN*/            0591
*      ELSE DO;                        /*NOT KWD SCAN*/            0592
         B     @RC00586                                            0592
@RF00586 DS    0H                                                  0593
*P2A:                                                              0593
*         IF CPHPARCT=0                /*BALANCED PARENS*/         0593
*            THEN                      /* YES */                   0593
P2A      LH    @10,CPHPARCT                                        0593
         LTR   @10,@10                                             0593
         BNZ   @RF00593                                            0593
*               CPHSYNER='1'B;         /*SET SYNTAX ERROR*/        0594
         OI    CPHSYNER,B'00000001'                                0594
*            ELSE                      /*NOT BALANCED PARENS*/     0595
*               CPHSPLEN=CPHSPLEN+1;   /*UP SUB PARM LEN BY 1*/    0595
         B     @RC00593                                            0595
@RF00593 LA    @10,1                                               0595
         AH    @10,CPHSPLEN                                        0595
         STH   @10,CPHSPLEN                                        0595
*      END;                            /*END NOT KWD SCAN*/        0596
@RC00593 DS    0H                                                  0597
*   /*CMZPEND*/                                                    0597
*   P2C: DO;                                                       0597
@RC00586 DS    0H                                                  0597
P2C      DS    0H                                                  0598
*   GPR14P = CMZX9913;                                             0598
*                                                                  0598
         LR    GPR14P,CMZX9913                                     0598
*   END P2C;                                                       0599
*   END CPHCSP02;                                                  0600
@EL00013 DS    0H                                                  0600
@EF00013 DS    0H                                                  0600
@ER00013 BR    @14                                                 0600
*/********************************************************************/
*/*                                                                  */
*/*         CPHCSP03: CHECK FOR LAST SUBPARM                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0601
*   CPHCSP03: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0601
CPHCSP03 DS    0H                                                  0602
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0602
*    DO;                                                           0602
*   CMZX9914 = GPR14P;                                             0603
*                                                                  0603
         LR    CMZX9914,GPR14P                                     0603
*   END ;                                                          0604
*    /*ICALL(CPHCSP13)*/                                           0605
*     DO;                                                          0605
*    CALL CPHCSP13;                                                0606
*                                                                  0606
         BAL   @14,CPHCSP13                                        0606
*    END ;                 /*CHECK FOR END OF SUBPARM*/            0607
*   IF CPHPARCT=0                     /*BALANCED PARENS*/          0608
*      THEN                           /* YES */                    0608
         LH    @10,CPHPARCT                                        0608
         LTR   @10,@10                                             0608
         BNZ   @RF00608                                            0608
*         CPHLSTSP='1'B;              /*SET LAST SUB PARM */       0609
         OI    CPHLSTSP,B'00000100'                                0609
*      ELSE;                          /*NOT LAST SUB PARM*/        0610
@RF00608 DS    0H                                                  0611
*   /*CMZPEND*/                                                    0611
*   P3A: DO;                                                       0611
P3A      DS    0H                                                  0612
*   GPR14P = CMZX9914;                                             0612
*                                                                  0612
         LR    GPR14P,CMZX9914                                     0612
*   END P3A;                                                       0613
*   END CPHCSP03;                                                  0614
@EL00014 DS    0H                                                  0614
@EF00014 DS    0H                                                  0614
@ER00014 BR    @14                                                 0614
*/********************************************************************/
*/*                                                                  */
*/*     CPHCSP04: END OF SUBPARM A                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0615
*   CPHCSP04: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0615
CPHCSP04 DS    0H                                                  0616
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0616
*    DO;                                                           0616
*   CMZX9915 = GPR14P;                                             0617
*                                                                  0617
         LR    CMZX9915,GPR14P                                     0617
*   END ;                                                          0618
*   IF CPHPARCT=0               /*BALANCED PARENS*/                0619
*      THEN                      /* YES */                         0619
         LH    @10,CPHPARCT                                        0619
         LTR   @10,@10                                             0619
         BNZ   @RF00619                                            0619
*         CPHSYNER='1'B;         /*SET SYNTAX ERROR*/              0620
         OI    CPHSYNER,B'00000001'                                0620
*      ELSE DO;                  /*NOT BALANCED PARENS*/           0621
         B     @RC00619                                            0621
@RF00619 DS    0H                                                  0622
*          /*ICALL(CPHCSP13)*/                                     0622
*           DO;                                                    0622
*          CALL CPHCSP13;                                          0623
*                                                                  0623
         BAL   @14,CPHCSP13                                        0623
*          END ;       /*  CHECK FOR END OF SUBPARM*/              0624
*         /*ICALL(CPHCSP01)*/                                      0625
*         P4A: DO;                                                 0625
P4A      DS    0H                                                  0626
*         CALL CPHCSP01;                                           0626
*                                                                  0626
         BAL   @14,CPHCSP01                                        0626
*         END P4A;            /*  STORE PTR AND LENGTH*/           0627
*      END;                        /*END NOT BALANCED PARENS*/     0628
*   /*CMZPEND*/                                                    0629
*   P4B: DO;                                                       0629
@RC00619 DS    0H                                                  0629
P4B      DS    0H                                                  0630
*   GPR14P = CMZX9915;                                             0630
*                                                                  0630
         LR    GPR14P,CMZX9915                                     0630
*   END P4B;                                                       0631
*   END CPHCSP04;                                                  0632
@EL00015 DS    0H                                                  0632
@EF00015 DS    0H                                                  0632
@ER00015 BR    @14                                                 0632
*/********************************************************************/
*/*                                                                  */
*/*      CPHCSP05: END OF SUBPARM LIST                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0633
*   CPHCSP05: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0633
CPHCSP05 DS    0H                                                  0634
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0634
*    DO;                                                           0634
*   CMZX9916 = GPR14P;                                             0635
*                                                                  0635
         LR    CMZX9916,GPR14P                                     0635
*   END ;                                                          0636
*   IF CPHPARCT=0                 /*PARENS. BALANCED*/             0637
*      THEN                           /* YES */                    0637
         LH    @10,CPHPARCT                                        0637
         LTR   @10,@10                                             0637
         BNZ   @RF00637                                            0637
*         CPHSLIST='0'B;               /* RESET SUBPARM. LIST FLAG*/
         NI    CPHSLIST,B'11111101'                                0638
*      ELSE;                           /* NO */                    0639
@RF00637 DS    0H                                                  0640
*   /*CMZPEND*/                                                    0640
*   P5A: DO;                                                       0640
P5A      DS    0H                                                  0641
*   GPR14P = CMZX9916;                                             0641
*                                                                  0641
         LR    GPR14P,CMZX9916                                     0641
*   END P5A;                                                       0642
*   END CPHCSP05;                                                  0643
@EL00016 DS    0H                                                  0643
@EF00016 DS    0H                                                  0643
@ER00016 BR    @14                                                 0643
*/********************************************************************/
*/*                                                                  */
*/*         CPHCSP06: INCREASE PAREN COUNTER                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0644
*   CPHCSP06: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0644
CPHCSP06 DS    0H                                                  0645
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0645
*    DO;                                                           0645
*   CMZX9917 = GPR14P;                                             0646
*                                                                  0646
         LR    CMZX9917,GPR14P                                     0646
*   END ;                                                          0647
*   IF CPHPARCT>0&CPHSBPAR=0 /*PAREN CNT GT 0 AND SUB PAREN CNT 0*/
*      THEN DO;               /* YES */                            0648
         LH    @10,CPHPARCT                                        0648
         SLR   @09,@09                                             0648
         CR    @10,@09                                             0648
         BNH   @RF00648                                            0648
         CH    @09,CPHSBPAR                                        0648
         BNE   @RF00648                                            0648
*         CPHSBPAR=CPHPARCT;  /*SET SUBPARM START PARENS. COUNT*/  0650
         STH   @10,CPHSBPAR                                        0650
*         CPHSPPTR=GPR01P;       /* FLAG LEFT PARENTHESIS AS START */
         ST    GPR01P,CPHSPPTR                                     0651
*                                /*    OF SUBPARM                    */
*      END;                   /*END PAREN CNT GT 0*/               0652
*      ELSE;                  /*PAREN CNT NOT GT 0 */              0653
@RF00648 DS    0H                                                  0654
*   CPHPARCT=CPHPARCT+1;       /* INCREASE PAREN COUNTER BY 1*/    0654
         LA    @10,1                                               0654
         AH    @10,CPHPARCT                                        0654
         STH   @10,CPHPARCT                                        0654
*   CPHSLIST='1'B;             /*   SET SUBPARM LIST FLAG*/        0655
         OI    CPHSLIST,B'00000010'                                0655
*    /*CMZPEND*/                                                   0656
*     DO;                                                          0656
*    GPR14P = CMZX9917;                                            0657
*                                                                  0657
         LR    GPR14P,CMZX9917                                     0657
*    END ;                                                         0658
*    END CPHCSP06;                                                 0659
@EL00017 DS    0H                                                  0659
@EF00017 DS    0H                                                  0659
@ER00017 BR    @14                                                 0659
*/********************************************************************/
*/*                                                                  */
*/*         CPHCSP07: END OF SUBPARM C                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0660
*   CPHCSP07: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0660
CPHCSP07 DS    0H                                                  0661
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0661
*    DO;                                                           0661
*   CMZX9918 = GPR14P;                                             0662
*                                                                  0662
         LR    CMZX9918,GPR14P                                     0662
*   END ;                                                          0663
*    /*ICALL(CPHCSP08)*/                                           0664
*     DO;                                                          0664
*    CALL CPHCSP08;                                                0665
*                                                                  0665
         BAL   @14,CPHCSP08                                        0665
*    END ;                /* CHECK FOR BALANCED PARENS*/           0666
*   IF CPHSYNER='1'B                 /*SYNTAX ERROR*/              0667
*      THEN ;                        /* YES */                     0667
         TM    CPHSYNER,B'00000001'                                0667
         BO    @RT00667                                            0667
*      ELSE                          /* NO */                      0669
*         /*ICALL(CPHCSP03)*/                                      0669
*          DO;                                                     0669
*         CALL CPHCSP03;                                           0670
*                                                                  0670
         BAL   @14,CPHCSP03                                        0670
*         END ;           /*   CHECK FOR LAST SUB-PARM*/           0671
*   /*CMZPEND*/                                                    0672
*   P7A: DO;                                                       0672
@RT00667 DS    0H                                                  0672
P7A      DS    0H                                                  0673
*   GPR14P = CMZX9918;                                             0673
*                                                                  0673
         LR    GPR14P,CMZX9918                                     0673
*   END P7A;                                                       0674
*   END CPHCSP07;                                                  0675
@EL00018 DS    0H                                                  0675
@EF00018 DS    0H                                                  0675
@ER00018 BR    @14                                                 0675
*/********************************************************************/
*/*                                                                  */
*/*          CPHCSP08: DECREASE PAREN COUNTER                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0676
*   CPHCSP08: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0676
CPHCSP08 DS    0H                                                  0677
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0677
*    DO;                                                           0677
*   CMZX9919 = GPR14P;                                             0678
*                                                                  0678
         LR    CMZX9919,GPR14P                                     0678
*   END ;                                                          0679
*   CPHPARCT=CPHPARCT-1;      /*DECREMENT PAREN CNT*/              0680
         LH    @10,CPHPARCT                                        0680
         BCTR  @10,0                                               0680
         STH   @10,CPHPARCT                                        0680
*   IF CPHPARCT<0            /*CPHPARCT LESS THAN 0*/              0681
*      THEN                   /* YES */                            0681
         LTR   @10,@10                                             0681
         BNM   @RF00681                                            0681
*         CPHSYNER='1'B;      /*SET SYNTAX ERROR*/                 0682
         OI    CPHSYNER,B'00000001'                                0682
*      ELSE;                  /* NO */                             0683
@RF00681 DS    0H                                                  0684
*   IF CPHSBPAR=0             /*SUB PAREN CNT 0*/                  0684
*      THEN DO;               /*YES */                             0684
         SLR   @10,@10                                             0684
         CH    @10,CPHSBPAR                                        0684
         BNE   @RF00684                                            0684
*         CPHENDSP='1'B;        /*SET END OF SUBPARM */            0686
         OI    CPHENDSP,B'00001000'                                0686
*         IF CPHSPPTR=0       /*SUB PARM PTR 0 */                  0687
*            THEN;            /*YES */                             0687
         C     @10,CPHSPPTR                                        0687
         BE    @RT00687                                            0687
*            ELSE             /* NO */                             0689
*               CPHSPLEN=GPR01P-CPHSPPTR;  /*SET TOTAL SUBPARM LENGTH*/
         LR    @10,GPR01P                                          0689
         SL    @10,CPHSPPTR                                        0689
         STH   @10,CPHSPLEN                                        0689
*      END;                   /*END SUB PAREN CNT 0*/              0690
*      ELSE DO;               /*SUB PAREN CNT NOT 0*/              0691
         B     @RC00684                                            0691
@RF00684 DS    0H                                                  0692
*         IF CPHSBPAR=CPHPARCT    /*SUBPARM START COUNT EQUAL CURRENT*/
*            THEN DO;                                              0692
         CLC   CPHSBPAR(2),CPHPARCT                                0692
         BNE   @RF00692                                            0692
*               CPHSBPAR=0;     /*SET SUB APREN CNT TO 0*/         0694
         SLR   @10,@10                                             0694
         STH   @10,CPHSBPAR                                        0694
*               CPHENDSP='1'B;    /* SET END OF SUBPARM*/          0695
         OI    CPHENDSP,B'00001000'                                0695
*               CPHSPLEN=GPR01P-CPHSPPTR+1; /*SET TOTAL SUBPARM LENGTH*
         LR    @10,GPR01P                                          0696
         SL    @10,CPHSPPTR                                        0696
         AL    @10,@CF00048                                        0696
         STH   @10,CPHSPLEN                                        0696
*            END;                 /*END SUB PARM STRT =CURRENT*/   0697
*            ELSE;                /*NOT  EQUAL*/                   0698
@RF00692 DS    0H                                                  0699
*      END;                    /*END SUB PAREN CNT NOT 0*/         0699
*   /*CMZPEND*/                                                    0700
*   P8A: DO;                                                       0700
@RC00684 DS    0H                                                  0700
P8A      DS    0H                                                  0701
*   GPR14P = CMZX9919;                                             0701
*                                                                  0701
         LR    GPR14P,CMZX9919                                     0701
*   END P8A;                                                       0702
*   END CPHCSP08;                                                  0703
@EL00019 DS    0H                                                  0703
@EF00019 DS    0H                                                  0703
@ER00019 BR    @14                                                 0703
*/********************************************************************/
*/*                                                                  */
*/*         CPHCSP09: SCAN TO NEXT QUOTE                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0704
*   CPHCSP09: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0704
CPHCSP09 DS    0H                                                  0705
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0705
*    DO;                                                           0705
*   CMZX9921 = GPR14P;                                             0706
*                                                                  0706
         LR    CMZX9921,GPR14P                                     0706
*   END ;                                                          0707
*   GPR03P=GPR03P+1;          /* INCREASE PARM STRING PTR BY 1*/   0708
         AL    GPR03P,@CF00048                                     0708
*   CPHSPPTR=GPR03P;             /*   STORE IN CPHSPPTR*/          0709
         ST    GPR03P,CPHSPPTR                                     0709
*   GPR02F=0;                       /* INITIALIZE TRT CODE REGISTER  */
         SLR   GPR02F,GPR02F                                       0710
*   DO WHILE GPR02F^=5;            /*SCAN FOR QUOTE*/              0711
         B     @DE00711                                            0711
@DL00711 DS    0H                                                  0712
*     /*ICALL(CPHSBTRT)*/                                          0712
*     P9A: DO;                                                     0712
P9A      DS    0H                                                  0713
*     CALL CPHSBTRT;                                               0713
*                                                                  0713
         BAL   @14,CPHSBTRT                                        0713
*     END P9A;            /*   TRT:SCAN TO NEXT DELIMITER*/        0714
*   END;                            /*END DO WHILE*/               0715
@DE00711 C     GPR02F,@CF00120                                     0715
         BNE   @DL00711                                            0715
*   CPHSPLEN=GPR01P-CPHSPPTR;      /*SAVE SUB PARM LENGTH*/        0716
         LR    @10,GPR01P                                          0716
         SL    @10,CPHSPPTR                                        0716
         STH   @10,CPHSPLEN                                        0716
*   CPHTCHAR=5;                   /*SET TCHAR = QUOTE CODE*/       0717
         MVI   CPHTCHAR,X'05'                                      0717
*   /*CMZPEND*/                                                    0718
*   P9B: DO;                                                       0718
P9B      DS    0H                                                  0719
*   GPR14P = CMZX9921;                                             0719
*                                                                  0719
         LR    GPR14P,CMZX9921                                     0719
*   END P9B;                                                       0720
*   END CPHCSP09;                                                  0721
@EL00020 DS    0H                                                  0721
@EF00020 DS    0H                                                  0721
@ER00020 BR    @14                                                 0721
*/********************************************************************/
*/*                                                                  */
*/*       CPHCSP10: END OF KEYWORD B OR SUBPARM                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0722
*   CPHCSP10: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0722
CPHCSP10 DS    0H                                                  0723
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0723
*    DO;                                                           0723
*   CMZX9922 = GPR14P;                                             0724
*                                                                  0724
         LR    CMZX9922,GPR14P                                     0724
*   END ;                                                          0725
*    /*ICALL(CPHCSP03)*/                                           0726
*     DO;                                                          0726
*    CALL CPHCSP03;                                                0727
*                                                                  0727
         BAL   @14,CPHCSP03                                        0727
*    END ;              /* CHECK FOR LAST SUBPARM */               0728
*   IF CPHLSTSP='1'B               /*LAST SUB PARM*/               0729
*      THEN DO;                    /* YES */                       0729
         TM    CPHLSTSP,B'00000100'                                0729
         BNO   @RF00729                                            0729
*         CPHENDSP='1'B;            /*   SET END OF SUBPARM */     0731
*         CPHKWSCN='0'B;            /*    RESET KWD SCAN FLAG*/    0732
         OI    CPHENDSP,B'00001000'                                0732
         NI    CPHKWSCN,B'11011111'                                0732
*         CPHKWLEN=CPHSPLEN;        /*SET KWD LENGTH*/             0733
         LH    @10,CPHSPLEN                                        0733
         STH   @10,CPHKWLEN                                        0733
*      END;                         /*END LAST SUB PARM*/          0734
*      ELSE DO;                     /*NOT LAST SUB PARM*/          0735
         B     @RC00729                                            0735
@RF00729 DS    0H                                                  0736
*         IF CPHKWSCN='1'B × CPHTCHAR=6 /*IN KWD SCAN OR BLAKN CHAR*/
*            THEN                 /* YES */                        0736
         TM    CPHKWSCN,B'00100000'                                0736
         BO    @RT00736                                            0736
         CLI   CPHTCHAR,6                                          0736
         BNE   @RF00736                                            0736
@RT00736 DS    0H                                                  0737
*               CPHSYNER='1'B;    /*SET SYNTAX ERROR*/             0737
         OI    CPHSYNER,B'00000001'                                0737
*            ELSE;                /*NOT KWD SCAN MODE*/            0738
@RF00736 DS    0H                                                  0739
*      END;                        /*END NOT LAST SUB PARM*/       0739
*   /*CMZPEND*/                                                    0740
*   P10B: DO;                                                      0740
@RC00729 DS    0H                                                  0740
P10B     DS    0H                                                  0741
*   GPR14P = CMZX9922;                                             0741
*                                                                  0741
         LR    GPR14P,CMZX9922                                     0741
*   END P10B;                                                      0742
*   END CPHCSP10;                                                  0743
@EL00021 DS    0H                                                  0743
@EF00021 DS    0H                                                  0743
@ER00021 BR    @14                                                 0743
*/********************************************************************/
*/*                                                                  */
*/*          CPHCSP12: SYNTAX ERROR                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0744
*   CPHCSP12: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0744
CPHCSP12 DS    0H                                                  0745
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0745
*    DO;                                                           0745
*   CMZX9923 = GPR14P;                                             0746
*                                                                  0746
         LR    CMZX9923,GPR14P                                     0746
*   END ;                                                          0747
*   CPHSYNER='1'B;                       /*SET SYNTAX ERROR FLAG*/ 0748
         OI    CPHSYNER,B'00000001'                                0748
*    /*CMZPEND*/                                                   0749
*     DO;                                                          0749
*    GPR14P = CMZX9923;                                            0750
*                                                                  0750
         LR    GPR14P,CMZX9923                                     0750
*    END ;                                                         0751
*    END CPHCSP12;                                                 0752
@EL00022 DS    0H                                                  0752
@EF00022 DS    0H                                                  0752
@ER00022 BR    @14                                                 0752
*/********************************************************************/
*/*                                                                  */
*/*           CPHCSP13: CHECK FOR END OF SUBPARM                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0753
*   CPHCSP13: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0753
CPHCSP13 DS    0H                                                  0754
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0754
*    DO;                                                           0754
*   CMZX9920 = GPR14P;                                             0755
*                                                                  0755
         ST    GPR14P,CMZX9920                                     0755
*   END ;                                                          0756
*   IF CPHSBPAR=0                   /*IN NESTED SUB PARM*/         0757
*      THEN                          /* NO */                      0757
         LH    @10,CPHSBPAR                                        0757
         LTR   @10,@10                                             0757
         BNZ   @RF00757                                            0757
*         CPHENDSP='1'B;             /*SET END OF SUBPARM*/        0758
         OI    CPHENDSP,B'00001000'                                0758
*      ELSE;                         /*IN NESTED SUB PARM*/        0759
@RF00757 DS    0H                                                  0760
*   /*CMZPEND*/                                                    0760
*   P13A: DO;                                                      0760
P13A     DS    0H                                                  0761
*   GPR14P = CMZX9920;                                             0761
*                                                                  0761
         L     GPR14P,CMZX9920                                     0761
*   END P13A;                                                      0762
*   END CPHCSP13;                                                  0763
@EL00023 DS    0H                                                  0763
@EF00023 DS    0H                                                  0763
@ER00023 BR    @14                                                 0763
*/********************************************************************/
*/*                                                                  */
*/*        CPHCSP14: END OF LAST SUBPARM LIST                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0764
*   CPHCSP14: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0764
CPHCSP14 DS    0H                                                  0765
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0765
*    DO;                                                           0765
*   CMZX9924 = GPR14P;                                             0766
*                                                                  0766
         LR    CMZX9924,GPR14P                                     0766
*   END ;                                                          0767
*   CPHSLIST='0'B;                   /*  RESET SUBPARM LIST FLAG */
         NI    CPHSLIST,B'11111101'                                0768
*    /*ICALL(CPHCSP03)*/                                           0769
*     DO;                                                          0769
*    CALL CPHCSP03;                                                0770
*                                                                  0770
         BAL   @14,CPHCSP03                                        0770
*    END ;                 /*  CHECK FOR END OF SUBPARMS*/         0771
*   IF CPHPARCT=0                  /*   BALANCED PARENS.*/         0772
*      THEN;                       /* YES */                       0772
         LH    @10,CPHPARCT                                        0772
         LTR   @10,@10                                             0772
         BZ    @RT00772                                            0772
*      ELSE                         /*NOT BALANCED PARENS*/        0774
*         CPHSYNER='1'B;             /* SET SYNTAX ERROR FLAG*/    0774
         OI    CPHSYNER,B'00000001'                                0774
*   /*CMZPEND*/                                                    0775
*   P14A: DO;                                                      0775
@RT00772 DS    0H                                                  0775
P14A     DS    0H                                                  0776
*   GPR14P = CMZX9924;                                             0776
*                                                                  0776
         LR    GPR14P,CMZX9924                                     0776
*   END P14A;                                                      0777
*   END CPHCSP14;                                                  0778
@EL00024 DS    0H                                                  0778
@EF00024 DS    0H                                                  0778
@ER00024 BR    @14                                                 0778
@PB00024 DS    0H                                                  0779
*   GPR00P=CPHSCN00;           /* RESTORE REG00              @ZA27161*/
         L     GPR00P,CPHSCN00                                     0779
*   GPR02P=CPHSCN02;           /* RESTORE REG02              @ZA27161*/
         L     GPR02P,CPHSCN02                                     0780
*   /*CMZPEND*/                                                    0781
*    DO;                                                           0781
*   GPR14P = CMZX9902;                                             0782
*                                                                  0782
         LR    GPR14P,CMZX9902                                     0782
*   END ;                                                          0783
*   END CPHSUBSC;                                                  0784
*                                                                  0784
@EL00010 DS    0H                                                  0784
@EF00010 DS    0H                                                  0784
@ER00010 BR    @14                                                 0784
@PB00010 DS    0H                                                  0785
*/* TPEPILOG   */                                                  0785
* GEN (PRINT OFF);                                                 0785
*                                                                  0785
         PRINT OFF
* GEN (PRINT ON);                                                  0786
         PRINT ON
*/* END OF TPEPILOG */                                             0787
*/* ATDSPLY   INVOKED. */                                          0787
*/********************************************************************/
*/* THE FOLLOWING ATBUILD INCLUSIONS HAVE BEEN MADE IN THIS          */
*/* COMPILATION:                                                     */
*/*             ISTPHROA                                             */
*/********************************************************************/
*/* END OF ATDSPLY. */                                             0787
*  /*CMZPEND*/                                                     0787
*   DO;                                                            0787
*  DCL CMZX9902 REG(6) PTR(31);                                    0788
*  DCL CMZX9903 REG(6) PTR(31);                                    0789
*  DCL CMZX9904 REG(5) PTR(31);                                    0790
*  DCL CMZX9905 REG(5) PTR(31);                                    0791
*  DCL CMZX9906 REG(5) PTR(31);                                    0792
*  DCL CMZX9907 REG(5) PTR(31);                                    0793
*  DCL CMZX9908 REG(5) PTR(31);                                    0794
*  DCL CMZX9909 REG(5) PTR(31);                                    0795
*  DCL CMZX9910 REG(6) PTR(31);                                    0796
*  DCL CMZX9911 REG(12) PTR(31);                                   0797
*  DCL CMZX9912 REG(12) PTR(31);                                   0798
*  DCL CMZX9913 REG(7) PTR(31);                                    0799
*  DCL CMZX9914 REG(12) PTR(31);                                   0800
*  DCL CMZX9915 REG(7) PTR(31);                                    0801
*  DCL CMZX9916 REG(7) PTR(31);                                    0802
*  DCL CMZX9917 REG(7) PTR(31);                                    0803
*  DCL CMZX9918 REG(7) PTR(31);                                    0804
*  DCL CMZX9919 REG(12) PTR(31);                                   0805
*  /*PROC0012 INSUFFICIENT LINK REGISTERS*/                        0806
*  DCL CMZX9920 PTR(31);                                           0806
*  DCL CMZX9921 REG(7) PTR(31);                                    0807
*  DCL CMZX9922 REG(7) PTR(31);                                    0808
*  DCL CMZX9923 REG(7) PTR(31);                                    0809
*  DCL CMZX9924 REG(7) PTR(31);                                    0810
*  RFY (GPR00P,GPR01P,GPR02P,GPR03P,GPR04P,GPR05P,GPR06P,GPR07P,GPR12P,
*PR14P,GPR15P) UNRSTD;                                             0811
*  END ;                                                           0812
*  END ISTINCPH;                                                   0813
@EL00001 DS    0H                                                  0813
@EF00001 DS    0H                                                  0813
@ER00001 LM    @14,@12,12(@13)                                     0813
         BR    @14                                                 0813
@DATA    DS    0H
@CH00080 DC    H'7'
@SM00427 MVC   CPHARGUM(0),CPHSBYTE(@09)
@SM00434 MVC   PHRF34SP-12(0,@10),CPHSBYTE(@08)
@SM00436 MVC   PHRF34SP-12(0,@09),CPHSBYTE(@08)
@SM00439 MVC   0(0,@09),CPHSBYTE(@08)
@SM00442 MVC   CPHSUBVL(0),CPHFUNBT(@10)
@DATD    DSECT
         DS    0F
@TF00001 DS    F
ISTINCPH CSECT
         DS    0F
@CF00048 DC    F'1'
@CF00313 DC    F'2'
@CF00193 DC    F'3'
@CF00128 DC    F'4'
@CF00120 DC    F'5'
@CF00046 DC    F'8'
@CF00271 DC    F'9'
@CF00237 DC    F'12'
@CH00237 EQU   @CF00237+2
@CF00297 DC    F'255'
@CF00150 DC    F'256'
@CF00433 DC    F'-4'
@CF00438 DC    F'-2'
@CF00260 DC    F'-1'
@DATD    DSECT
         DS    0D
CPHTABAD DS    A
CPHSCNPT DS    A
CPHOANDX DS    F
CPHOALIM DS    F
CPHINSVA DS    A
CPHSCN00 DS    A
CPHSCN02 DS    A
CPHVCK01 DS    A
CPHVCK02 DS    A
CPHTABSV DS    A
CPHKWPTR DS    A
CPHTRTSV DS    A
CPHVALPS DS    A
CPHSPPTR DS    A
CMZX9920 DS    A
CPHSPLEN DS    H
CPHKWLEN DS    H
CPHPARCT DS    H
CPHSBPAR DS    H
CPHENCTR DS    H
CPHTCHAR DS    FL1
CPHLCHAR DS    FL1
         DS    0D
@TS00001 DS    CL8
CPHSUBVL DS    CL5
         ORG   CPHSUBVL
CPHVALBT DS    BL1
         ORG   CPHVALBT
@NM00005 DS    BL1
CPHFUNNU EQU   CPHVALBT+0
CPHFUNAN EQU   CPHVALBT+0
CPHFUNFC EQU   CPHVALBT+0
CPHFUNNO EQU   CPHVALBT+0
         ORG   CPHSUBVL+1
CPHVALUE DS    AL4
         ORG   CPHSUBVL+5
CPHARGUM DS    CL8
CPHDECHX DS    CL3
CPHVALFG DS    BL1
         ORG   CPHVALFG
@NM00006 DS    BL1
CPHVALNU EQU   CPHVALFG+0
CPHVALAN EQU   CPHVALFG+0
CPHVALFC EQU   CPHVALFG+0
@NM00007 EQU   CPHVALFG+0
         ORG   CPHVALFG+1
CPHFLAGS DS    BL1
         ORG   CPHFLAGS
@NM00008 DS    BL1
CPHCONT  EQU   CPHFLAGS+0
CPHKWSCN EQU   CPHFLAGS+0
CPHENDST EQU   CPHFLAGS+0
CPHENDSP EQU   CPHFLAGS+0
CPHLSTSP EQU   CPHFLAGS+0
CPHSLIST EQU   CPHFLAGS+0
CPHSYNER EQU   CPHFLAGS+0
         ORG   CPHFLAGS+1
CPHFLAG2 DS    BL1
         ORG   CPHFLAG2
CPHOFLOW DS    BL1
CPHFUNER EQU   CPHFLAG2+0
CPHARGNF EQU   CPHFLAG2+0
@NM00009 EQU   CPHFLAG2+0
         ORG   CPHFLAG2+1
ISTINCPH CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00269 DC    C'00000000'
@CC00294 EQU   @CC00269
CPHLOCK  DC    AL1(0)
         DS    CL3
STATICFD DS    CL116
CPHSCNTB DC    AL4(CPHCSP13)
         DC    AL4(CPHCSP01)
         DC    AL4(CPHCSP01)
         DC    AL4(CPHCSP01)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP01)
         DC    AL4(CPHCSP02)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP04)
         DC    AL4(CPHCSP04)
         DC    AL4(CPHCSP05)
         DC    AL4(CPHCSP13)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP06)
         DC    AL4(CPHCSP06)
         DC    AL4(CPHCSP06)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP07)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP07)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP08)
         DC    AL4(CPHCSP08)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP09)
         DC    AL4(CPHCSP09)
         DC    AL4(CPHCSP09)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP14)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP13)
ISTINCPH CSECT
CPHTRTB    DC    XL256'00'          INIT ALL CODES TO NON-DELIMITER
            ORG   CPHTRTB+C' '       RE-ORIGIN TO BLANK
            DC    X'06'              SCAN CODE = '06'X
            ORG   CPHTRTB+C','       RE-ORIGIN TO COMMA
            DC    X'02'              SCAN CODE = '02'X
            ORG   CPHTRTB+C'('       RE-ORIGIN TO LEFT PARENTHESIS
            DC    X'03'              SCAN CODE = '03'X
            ORG   CPHTRTB+C')'       RE-ORIGIN TO RIGHT PARENTHESIS
            DC    X'04'              SCAN CODE = '04'X
            ORG   CPHTRTB+C''''      RE-ORIGIN TO QUOTE MARK
            DC    X'05'              SCAN CODE = '05'X
            ORG   CPHTRTB+C'='       RE-ORIGIN TO EQUAL SIGN
            DC    X'01'              SCAN CODE = '01'X
            ORG             ,        CONTINUE WITH STORAGE DEFINITION
ISTINCPH CSECT
CPHVTRTB  DC    XL256'04'           DEFAULT CODE = '04'X
           ORG   CPHVTRTB+C'A'       RE-ORIGIN TO ALPHABETICS
           DC    9X'01'              A-I CODE = '01'X
           ORG   CPHVTRTB+C'J'       RE-ORIGIN TO NEXT ALPHA GROUP
           DC    9X'01'              J-R CODE = '01'X
           ORG   CPHVTRTB+C'S'       RE-ORIGIN TO LAST ALPHA GROUP
           DC    8X'01'              S-Z CODE = '01'X
           ORG   CPHVTRTB+C'$'       RE-ORIGIN TO NATIONAL CHARACTERS
           DC    X'01'               ALPHA CODE = '01'X
           ORG   CPHVTRTB+C'@'       ANOTHER NATIONAL CHARACTER
           DC    X'01'               ALPHA CODE = '01'X
           ORG   CPHVTRTB+X'7B'      RE-ORIGIN TO POUND SIGN
           DC    X'01'               ALPHA CODE = '01'X
           ORG   CPHVTRTB+C'0'       RE-ORIGIN TO NUMERICS
           DC    10X'02'             NUMERIC CODE = '02'X
           ORG         ,             CONTINUE STORAGE DEFINITION
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISTINCPH CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
GPR05P   EQU   @05
GPR06P   EQU   @06
GPR07P   EQU   @07
GPR12P   EQU   @12
GPR14P   EQU   @14
GPR00F   EQU   @00
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR02F   EQU   @02
GPR02P   EQU   @02
GPR03P   EQU   @03
GPR04P   EQU   @04
GPR15F   EQU   @15
GPR15P   EQU   @15
GPR13P   EQU   @13
CMZX9904 EQU   @05
CMZX9905 EQU   @05
CMZX9906 EQU   @05
CMZX9907 EQU   @05
CMZX9908 EQU   @05
CMZX9909 EQU   @05
CMZX9903 EQU   @06
CMZX9910 EQU   @06
CMZX9902 EQU   @06
CMZX9911 EQU   @12
CMZX9912 EQU   @12
CMZX9913 EQU   @07
CMZX9914 EQU   @12
CMZX9915 EQU   @07
CMZX9916 EQU   @07
CMZX9917 EQU   @07
CMZX9918 EQU   @07
CMZX9919 EQU   @12
CMZX9921 EQU   @07
CMZX9922 EQU   @07
CMZX9923 EQU   @07
CMZX9924 EQU   @07
GPR01F   EQU   @01
GPR03F   EQU   @03
GPR04F   EQU   @04
GPR05F   EQU   @05
GPR06F   EQU   @06
GPR07F   EQU   @07
GPR12F   EQU   @12
GPR14F   EQU   @14
ISTPHROA EQU   0
PHROALEN EQU   ISTPHROA
PHROADTA EQU   ISTPHROA+4
CPHKWDTB EQU   0
CPHENTNO EQU   CPHKWDTB
CPHENTLN EQU   CPHKWDTB+2
CPHTABEN EQU   CPHKWDTB+4
CPHKEYWD EQU   CPHTABEN
CPHFUNBT EQU   CPHTABEN+8
CPHPNTBK EQU   0
CPHSBVAL EQU   CPHPNTBK
CPHSBTAB EQU   CPHPNTBK+4
CPHSBYTE EQU   0
CMZP0157 EQU   0
PHRFN1OA EQU   PHROADTA
PHRF1SAD EQU   PHRFN1OA
PHRF1SLN EQU   PHRFN1OA+4
PHRFN2OA EQU   PHROADTA
PHRF2NVL EQU   PHRFN2OA
PHRF2VAL EQU   PHRFN2OA+4
PHRF2FLG EQU   PHRF2VAL+2
PHRF34OA EQU   PHROADTA
PHRF34NS EQU   PHRF34OA
PHRF34EN EQU   PHRF34OA+4
PHRF34VF EQU   PHRF34EN
PHRF34SL EQU   PHRF34EN+2
PHRF34SP EQU   PHRF34EN+4
PHRFN5OA EQU   PHROADTA
PHRF5NSP EQU   PHRFN5OA
PHRF5ENT EQU   PHRFN5OA+4
PHRF5VF  EQU   PHRF5ENT
PHRF5SL  EQU   PHRF5ENT+2
PHRF5SPT EQU   PHRF5ENT+4
PHRFN7OA EQU   PHROADTA
PHRF7NSP EQU   PHRFN7OA
PHRF7NUM EQU   PHRFN7OA+4
PHRFN8OA EQU   PHROADTA
PHRF8NSP EQU   PHRFN8OA
PHRF8ENT EQU   PHRFN8OA+4
PHRF8FLG EQU   PHRF8ENT
PHRF8DFT EQU   PHRF8FLG
PHRF8NUM EQU   PHRF8ENT+1
CPHF2VAL EQU   PHRF2VAL
CPHSBVL1 EQU   CPHSUBVL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00004 EQU   PHRF8FLG
@NM00003 EQU   PHRF5ENT+1
@NM00002 EQU   PHRF34EN+1
PHRF2MSK EQU   PHRF2VAL+3
PHRF2MV  EQU   PHRF2FLG
PHRF2OFF EQU   PHRF2FLG
PHRF2ON  EQU   PHRF2FLG
@NM00001 EQU   PHRF2FLG
PHRF2TR  EQU   PHRF2FLG
PHRF2CL  EQU   PHRF2FLG
PHRF2LN  EQU   PHRF2FLG
PHRF2GP  EQU   PHRF2FLG
PHRF2OFS EQU   PHRF2VAL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00104 EQU   @RC00102
@RC00107 EQU   @RC00102
@RC00111 EQU   @RC00102
@RC00116 EQU   @RC00102
@RC00121 EQU   @RC00102
@RC00126 EQU   @RC00102
@RC00131 EQU   @RC00102
@RC00301 EQU   @RC00299
@RC00400 EQU   @RC00399
@RC00478 EQU   @RC00474
@PB00009 EQU   @PB00010
@RT00687 EQU   @RC00684
@PB00023 EQU   @PB00024
@PB00008 EQU   @PB00009
@RC00480 EQU   @RC00478
@PB00022 EQU   @PB00023
@PB00007 EQU   @PB00008
@PB00021 EQU   @PB00022
@PB00006 EQU   @PB00007
@PB00020 EQU   @PB00021
@PB00005 EQU   @PB00006
@PB00019 EQU   @PB00020
@PB00004 EQU   @PB00005
@PB00018 EQU   @PB00019
@PB00003 EQU   @PB00004
@PB00017 EQU   @PB00018
@PB00002 EQU   @PB00003
@PB00016 EQU   @PB00017
@RC00075 EQU   @PB00002
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@RC00520 EQU   @PB00011
@ENDDATA EQU   *
         END   ISTINCPH,(C'PLS1705',0603,78009)

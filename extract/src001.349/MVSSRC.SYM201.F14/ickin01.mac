         TITLE '**********  ICKIN01:  INITIALIZE COMMAND CONTROLLER  ***
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
ICKIN01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'ICKIN01   78.192'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @09,0                                               0002
@PSTART  LA    @10,4095(,@09)                                      0002
         LA    @11,4095(,@10)                                      0002
         LA    @12,4095(,@11)                                      0002
         LA    @08,4095(,@12)                                      0002
         USING @PSTART,@09                                         0002
         USING @PSTART+4095,@10                                    0002
         USING @PSTART+8190,@11                                    0002
         USING @PSTART+12285,@12                                   0002
         USING @PSTART+16380,@08                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @07,@01                                             0002
         USING @DATD,@07                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @07,8(,@13)                                         0002
         LR    @13,@07                                             0002
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0208
         EJECT
*                                                                  0209
*/*****  B E G I N    E X E C U T I O N  *****************************/
*                                                                  0209
*    IF GDTDBG = NULLPTR                                           0209
*      THEN;                                                       0209
         L     @06,@PC00001                                        0209
         L     @06,GDTDBG(,@06)                                    0209
         LTR   @06,@06                                             0209
         BZ    @RT00209                                            0209
*      ELSE                                                        0211
*        CALL ICKDB010 (GDTTBL, 'IN00');                           0211
*                                                                  0211
*                                                                  0211
         L     @06,@PC00001                                        0211
         ST    @06,@AL00001                                        0211
         LA    @15,@CC00754                                        0211
         ST    @15,@AL00001+4                                      0211
         MVI   @AL00001+4,X'80'                                    0211
         L     @15,GDTDBG(,@06)                                    0211
         LA    @01,@AL00001                                        0211
         BALR  @14,@15                                             0211
*/*  ESTABLISH UPRINT ARGUMENT LIST                                  */
*    PRTHDR = 'DARGLIST';                                          0212
@RT00209 MVC   PRTHDR(8),@CC00755                                  0212
*    PRTARGS = ''B;                                                0213
         XC    PRTARGS(52),PRTARGS                                 0213
*    DDSTRU = ADDR(PRTARGS);                                       0214
         LA    @06,PRTARGS                                         0214
         ST    @06,DDSTRU                                          0214
*    DARGSMOD = MSGMODZ;                                           0215
         MVC   DARGSMOD(3,@06),@CC00533                            0215
*/*  SET THE LASTCOND INITIALLY TO INDICATE SUCCESSFUL COMPLETION    */
*    LASTCOND = LASTCC00;                                          0216
         L     @06,@PC00001+8                                      0216
         SLR   @15,@15                                             0216
         STH   @15,LASTCOND(,@06)                                  0216
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0217
*/*    THEN ISSUE_OPEN_VOLUME                                        */
*      THEN DO;    CALL OPENVOL; END;                              0217
         CH    @15,@CH00265                                        0217
         BNL   @RF00217                                            0217
         BAL   @14,OPENVOL                                         0219
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0221
*/*    THEN                                                          */
*      THEN DO;                                                    0221
*                                                                  0221
@RF00217 L     @06,@PC00001+8                                      0221
         LH    @06,LASTCOND(,@06)                                  0221
         CH    @06,@CH00265                                        0221
         BNL   @RF00221                                            0221
*/*      OBTAIN_VOLUME_AUTHORIZATION                                 */
*        CALL ICKVA01                                              0223
*              (GDTTBL                                             0223
*              ,VOLIB                                              0223
*              ,RETCODE);                                          0223
         L     @06,@PC00001                                        0223
         ST    @06,@AL00001                                        0223
         LA    @06,VOLIB                                           0223
         ST    @06,@AL00001+4                                      0223
         LA    @06,RETCODE                                         0223
         ST    @06,@AL00001+8                                      0223
         L     @15,@CV00759                                        0223
         LA    @01,@AL00001                                        0223
         BALR  @14,@15                                             0223
*/*      IF AUTHORIZATION IS NOT GRANTED                             */
*        IF RETCODE = FAILURE                                      0224
*/*        THEN INDICATE A SEVERE ERROR (LASTCOND = 12)              */
*          THEN DO;    LASTCOND = LASTCC12; END;                   0224
         CLC   RETCODE(4),@CF00165                                 0224
         BNE   @RF00224                                            0224
         L     @06,@PC00001+8                                      0226
         MVC   LASTCOND(2,@06),@CH00265                            0226
*/*      END-THEN                                                    */
*        END;                                                      0228
@RF00224 DS    0H                                                  0229
         EJECT
*/*  IF NO SEVERE ERRORS AND VERIFICATION IS REQUESTED               */
*    IF (LASTCOND < LASTCC12) & (ADDR(VERFY) ^= NULLPTR)           0229
*/*    THEN                                                          */
*      THEN DO;                                                    0229
*                                                                  0229
@RF00221 L     @06,@PC00001+8                                      0229
         LH    @06,LASTCOND(,@06)                                  0229
         CH    @06,@CH00265                                        0229
         BNL   @RF00229                                            0229
         SLR   @06,@06                                             0229
         L     @15,@PC00001+4                                      0229
         C     @06,FDTPTR+64(,@15)                                 0229
         BE    @RF00229                                            0229
*/*      IF THE OWNER ID IS TO BE VERIFIED                           */
*        IF ADDR(VOWN) ^= NULLPTR                                  0231
*/*        THEN SET UP THE PROPER VALUE TO BE PASSED                 */
*          THEN DO;    VALVOWN = VOWNVAL; END;                     0231
         L     @15,FDTPTR+72(,@15)                                 0231
         CR    @15,@06                                             0231
         BE    @RF00231                                            0231
         MVC   VALVOWN(14),VOWNVAL(@15)                            0233
*/*        ELSE INDICATE THAT THE OWNER ID NEED NOT BE VERIFIED      */
*          ELSE DO;    VALVOWN = ' '; END;                         0235
         B     @RC00231                                            0235
@RF00231 DS    0H                                                  0236
         MVI   VALVOWN+1,C' '                                      0236
         MVC   VALVOWN+2(12),VALVOWN+1                             0236
         MVI   VALVOWN,C' '                                        0236
*/*      VERIFY_VOLUME_LABEL                                         */
*        CALL   ICKVV01                                            0238
*               (GDTTBL                                            0238
*               ,VOLIB                                             0238
*               ,VSERVAL                                           0238
*               ,VALVOWN                                           0238
*               ,RETCODE);                                         0238
@RC00231 L     @06,@PC00001                                        0238
         ST    @06,@AL00001                                        0238
         LA    @06,VOLIB                                           0238
         ST    @06,@AL00001+4                                      0238
         L     @06,@PC00001+4                                      0238
         L     @06,FDTPTR+68(,@06)                                 0238
         LA    @06,VSERVAL(,@06)                                   0238
         ST    @06,@AL00001+8                                      0238
         LA    @06,VALVOWN                                         0238
         ST    @06,@AL00001+12                                     0238
         LA    @06,RETCODE                                         0238
         ST    @06,@AL00001+16                                     0238
         L     @15,@CV00761                                        0238
         LA    @01,@AL00001                                        0238
         BALR  @14,@15                                             0238
*/*      IF VERIFICATION FAILS                                       */
*        IF RETCODE = FAILURE                                      0239
*/*        THEN INDICATE A SEVERE ERROR (LASTCOND = 12)              */
*          THEN DO;    LASTCOND = LASTCC12; END;                   0239
         CLC   RETCODE(4),@CF00165                                 0239
         BNE   @RF00239                                            0239
         L     @06,@PC00001+8                                      0241
         MVC   LASTCOND(2,@06),@CH00265                            0241
*/*      IF VOLUME LABEL DOES NOT EXIST                              */
*        IF RETCODE = NOLABEL                                      0243
*/*        THEN                                                      */
*          THEN DO;                                                0243
*                                                                  0243
@RF00239 CLC   RETCODE(4),@CF00116                                 0243
         BNE   @RF00243                                            0243
*/*          ISSUE ERROR MESSAGE (MSGURVOL) (UPRINT)                 */
*            DARGSENT = MSGURVOL;                                  0245
         L     @06,DDSTRU                                          0245
         MVI   DARGSENT(@06),X'10'                                 0245
*            CALL ICKTPPR0 (GDTTBL                                 0246
*                   ,PRTFILE                                       0246
*                   ,DDSTRU);                                      0246
         L     @06,@PC00001                                        0246
         ST    @06,@AL00001                                        0246
         LA    @15,@CF00094                                        0246
         ST    @15,@AL00001+4                                      0246
         LA    @15,DDSTRU                                          0246
         ST    @15,@AL00001+8                                      0246
         MVI   @AL00001+8,X'80'                                    0246
         L     @15,GDTPRT(,@06)                                    0246
         LA    @01,@AL00001                                        0246
         BALR  @14,@15                                             0246
*/*          INDICATE SEVERE ERROR (LASTCOND = 12)                   */
*            LASTCOND = LASTCC12;                                  0247
         L     @06,@PC00001+8                                      0247
         MVC   LASTCOND(2,@06),@CH00265                            0247
*/*          END-THEN                                                */
*            END;                                                  0248
*/*      END-THEN                                                    */
*        END;                                                      0249
@RF00243 DS    0H                                                  0250
         EJECT
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0250
*/*    THEN                                                          */
*      THEN DO;                                                    0250
*                                                                  0250
@RF00229 L     @06,@PC00001+8                                      0250
         LH    @06,LASTCOND(,@06)                                  0250
         CH    @06,@CH00265                                        0250
         BNL   @RF00250                                            0250
*        VOLIMAGE = ' ';                                           0252
         MVI   VOLIMAGE+1,C' '                                     0252
         MVC   VOLIMAGE+2(78),VOLIMAGE+1                           0252
         MVI   VOLIMAGE,C' '                                       0252
*/*      READ_VOLUME_LABEL                                           */
*        CALL ICKRL01                                              0253
*             (GDTTBL                                              0253
*             ,VOLIB                                               0253
*             ,VOLIMAGE                                            0253
*             ,LABELS                                              0253
*             ,RETCODE);                                           0253
         L     @06,@PC00001                                        0253
         ST    @06,@AL00001                                        0253
         LA    @06,VOLIB                                           0253
         ST    @06,@AL00001+4                                      0253
         LA    @06,VOLIMAGE                                        0253
         ST    @06,@AL00001+8                                      0253
         LA    @06,LABELS                                          0253
         ST    @06,@AL00001+12                                     0253
         LA    @06,RETCODE                                         0253
         ST    @06,@AL00001+16                                     0253
         L     @15,@CV00762                                        0253
         LA    @01,@AL00001                                        0253
         BALR  @14,@15                                             0253
*        RESPECIFY VOL1 BASED( ADDR(VOLIMAGE) );                   0254
*/*      IF READ OPERATION SUCCEEDS                                  */
*        IF RETCODE = SUCCESS                                      0255
*/*        THEN                                                      */
*          THEN DO;                                                0255
*                                                                  0255
         SLR   @06,@06                                             0255
         C     @06,RETCODE                                         0255
         BNE   @RF00255                                            0255
*/*          INDICATE VOLUME LABEL EXISTS                            */
*            LABFLAG = LABYES;                                     0257
         OI    LABFLAG,B'10000000'                                 0257
*/*          SAVE OLD VOLUME-SERIAL, OWNER-ID AND VTOC LOCATION      */
*            OLDVSER = VOL1SER;                                    0258
         LA    @15,VOLIMAGE                                        0258
         MVC   OLDVSER(6),VOL1SER(@15)                             0258
*            OLDOWNER = VOL1OWNR;                                  0259
         MVC   OLDOWNER(14),VOL1OWNR(@15)                          0259
*            OLDVTOC = VOL1VTOC(1:4);                              0260
         MVC   OLDVTOC(4),VOL1VTOC(@15)                            0260
*/*          VERIFY_DATA_SET_PURGING                                 */
*            IF ADDR(PURGE) ^= NULLPTR                             0261
*              THEN DO;    PRGFLG = ON; END;                       0261
         L     @15,@PC00001+4                                      0261
         C     @06,FDTPTR+4(,@15)                                  0261
         BE    @RF00261                                            0261
         OI    PRGFLG,B'10000000'                                  0263
*              ELSE DO;    PRGFLG = OFF; END;                      0265
         B     @RC00261                                            0265
@RF00261 DS    0H                                                  0266
         NI    PRGFLG,B'01111111'                                  0266
*            CALL ICKVP01                                          0268
*                 (GDTTBL                                          0268
*                 ,VOLIB                                           0268
*                 ,PRGFLG                                          0268
*                 ,OLDVSER                                         0268
*                 ,RETCODE);                                       0268
@RC00261 L     @06,@PC00001                                        0268
         ST    @06,@AL00001                                        0268
         LA    @06,VOLIB                                           0268
         ST    @06,@AL00001+4                                      0268
         LA    @06,PRGFLG                                          0268
         ST    @06,@AL00001+8                                      0268
         LA    @06,OLDVSER                                         0268
         ST    @06,@AL00001+12                                     0268
         LA    @06,RETCODE                                         0268
         ST    @06,@AL00001+16                                     0268
         L     @15,@CV00765                                        0268
         LA    @01,@AL00001                                        0268
         BALR  @14,@15                                             0268
*/*          IF DATA SETS ARE NOT TO BE PURGED                       */
*            IF RETCODE = NOPURGE                                  0269
*/*            THEN INDICATE SEVERE ERROR (LASTCOND = 12)            */
*              THEN DO;    LASTCOND = LASTCC12; END;               0269
         CLC   RETCODE(4),@CF00165                                 0269
         BNE   @RF00269                                            0269
         L     @06,@PC00001+8                                      0271
         MVC   LASTCOND(2,@06),@CH00265                            0271
*/*          IF UNABLE TO READ VTOC                                  */
*            IF RETCODE = NOVTOC                                   0273
*/*            THEN                                                  */
*              THEN DO;                                            0273
*                                                                  0273
@RF00269 CLC   RETCODE(4),@CF00116                                 0273
         BNE   @RF00273                                            0273
*/*              ISSUE WARNING MESSAGE (MSGVTOCD) (UPRINT)           */
*                DARGSENT = MSGVTOCD;                              0275
         L     @06,DDSTRU                                          0275
         MVI   DARGSENT(@06),X'06'                                 0275
*                CALL ICKTPPR0 (GDTTBL                             0276
*                       ,PRTFILE                                   0276
*                       ,DDSTRU);                                  0276
         L     @06,@PC00001                                        0276
         ST    @06,@AL00001                                        0276
         LA    @15,@CF00094                                        0276
         ST    @15,@AL00001+4                                      0276
         LA    @15,DDSTRU                                          0276
         ST    @15,@AL00001+8                                      0276
         MVI   @AL00001+8,X'80'                                    0276
         L     @15,GDTPRT(,@06)                                    0276
         LA    @01,@AL00001                                        0276
         BALR  @14,@15                                             0276
*/*              INDICATE MINOR ERROR                                */
*                LASTCOND = MAX(LASTCC04,LASTCOND);                0277
         L     @06,@PC00001+8                                      0277
         LH    @15,LASTCOND(,@06)                                  0277
         LA    @14,4                                               0277
         CR    @15,@14                                             0277
         BNL   *+6
         LR    @15,@14                                             0277
         STH   @15,LASTCOND(,@06)                                  0277
*                END;                                              0278
*/*          END-THEN                                                */
*            END;                                                  0279
*/*        ELSE INDICATE VOLUME LABEL DOES NOT EXIST                 */
*          ELSE DO;    LABFLAG = LABNO; END;                       0280
         B     @RC00255                                            0280
@RF00255 DS    0H                                                  0281
         NI    LABFLAG,B'01111111'                                 0281
*/*      END-THEN                                                    */
*        END;                                                      0283
@RC00255 DS    0H                                                  0284
         EJECT
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0284
*/*    THEN OBTAIN_PACK_INFORMATION                                  */
*      THEN DO;    CALL PACKINFO; END;                             0284
@RF00250 L     @06,@PC00001+8                                      0284
         LH    @06,LASTCOND(,@06)                                  0284
         CH    @06,@CH00265                                        0284
         BNL   @RF00284                                            0284
         BAL   @14,PACKINFO                                        0286
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0288
*/*    THEN                                                          */
*      THEN DO;                                                    0288
*                                                                  0288
@RF00284 L     @06,@PC00001+8                                      0288
         LH    @06,LASTCOND(,@06)                                  0288
         CH    @06,@CH00265                                        0288
         BNL   @RF00288                                            0288
*/*      INDICATE INITIALLY THAT ALTERNATE TRACKS ARE AVAILABLE      */
*        ALTFLAG = MOREYES;                                        0290
         NI    ALTFLAG,B'01111111'                                 0290
*/*      SET THE NUMBER OF AVAIL ALTERNATE TRACKS TO MAX (ALTCOUNT)  */
*        ALTCOUNT = TOTALALT;                                      0291
         L     @06,INFOPTR+36                                      0291
         MVC   ALTCOUNT(4),TOTALALT(@06)                           0291
*/*      SET THE NEXT AVAIL ALT TRK PTR TO FIRST AVAILABLE (ALTPTR)  */
*        ALTPTR = FIRSTAL;                                         0292
         L     @06,INFOPTR+48                                      0292
         MVC   ALTPTR(4),FIRSTAL(@06)                              0292
*/*      SET COUNT OF UNRECOVERABLE TRACKS TO ZERO (COUNTUTR)        */
*        COUNTUTR = 0;                                             0293
         SLR   @06,@06                                             0293
         ST    @06,COUNTUTR                                        0293
*/*      SET COUNT OF AVAIL ALTERNATE TRACKS FOUND TO ZERO (AVAILCNT)*/
*        AVAILCNT = 0;                                             0294
         ST    @06,AVAILCNT                                        0294
*/*      SET FLAG INITIALLY TO INDICATE THERE IS STORAGE AVAILABLE   */
*/*       FOR A PACK MAP ENTRY                                       */
*        PACKENT = STORYES;                                        0295
         NI    PACKENT,B'01111111'                                 0295
*/*      END-THEN                                                    */
*        END;                                                      0296
         EJECT
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0297
*/*    THEN CHECK_PARAMETERS                                         */
*      THEN  DO;    CALL CHEKPARM; END;                            0297
@RF00288 L     @06,@PC00001+8                                      0297
         LH    @06,LASTCOND(,@06)                                  0297
         CH    @06,@CH00265                                        0297
         BNL   @RF00297                                            0297
         BAL   @14,CHEKPARM                                        0299
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0301
*/*    THEN                                                          */
*      THEN DO;                                                    0301
*                                                                  0301
@RF00297 L     @06,@PC00001+8                                      0301
         LH    @06,LASTCOND(,@06)                                  0301
         CH    @06,@CH00265                                        0301
         BNL   @RF00301                                            0301
*/*      IF NOCHECK AND NOVALIDATE ARE SPECIFIED (MIN INITIALIZATION)*/
*        IF (ADDR(NOCHK) ^= NULLPTR) & (ADDR(NOVAL) ^= NULLPTR)    0303
*/*        THEN                                                      */
*          THEN DO;                                                0303
*                                                                  0303
         SLR   @06,@06                                             0303
         L     @15,@PC00001+4                                      0303
         C     @06,FDTPTR+16(,@15)                                 0303
         BE    @RF00303                                            0303
         C     @06,FDTPTR+60(,@15)                                 0303
         BE    @RF00303                                            0303
*/*          IF MSS IS BEING MIMICKED                                */
*            IF ADDR(MIMIC) ^= NULLPTR & ADDR(MSS) ^= NULLPTR      0305
*/*            THEN                                                  */
*              THEN DO;                                            0305
*                                                                  0305
         C     @06,FDTPTR+88(,@15)                                 0305
         BE    @RF00305                                            0305
         C     @06,FDTPTR+92(,@15)                                 0305
         BE    @RF00305                                            0305
*/*              ISSUE ERROR MESSAGE (MSGMSSMI)                      */
*                DARGSENT = MSGMSSMI;                              0307
         L     @06,DDSTRU                                          0307
         MVI   DARGSENT(@06),X'34'                                 0307
*                CALL ICKTPPR0 (GDTTBL                             0308
*                       ,PRTFILE                                   0308
*                       ,DDSTRU);                                  0308
         L     @06,@PC00001                                        0308
         ST    @06,@AL00001                                        0308
         LA    @15,@CF00094                                        0308
         ST    @15,@AL00001+4                                      0308
         LA    @15,DDSTRU                                          0308
         ST    @15,@AL00001+8                                      0308
         MVI   @AL00001+8,X'80'                                    0308
         L     @15,GDTPRT(,@06)                                    0308
         LA    @01,@AL00001                                        0308
         BALR  @14,@15                                             0308
*/*              INDICATE A SEVERE ERROR                             */
*                LASTCOND = LASTCC12;                              0309
         L     @06,@PC00001+8                                      0309
         MVC   LASTCOND(2,@06),@CH00265                            0309
*/*              END-THEN                                            */
*                END;                                              0310
*/*            ELSE EXAMINE_ALTERNATE_TRACKS                         */
*              ELSE DO;    CALL EXALTRA; END;                      0311
         B     @RC00305                                            0311
@RF00305 DS    0H                                                  0312
         BAL   @14,EXALTRA                                         0312
*/*          END-THEN                                                */
*            END;                                                  0314
*/*        ELSE (MEDIAL OR MAXIMAL INITIALIZATION)                   */
*          ELSE DO;                                                0315
*                                                                  0315
         B     @RC00303                                            0315
@RF00303 DS    0H                                                  0316
*/*          INITIALIZE_ALTERNATE_TRACKS                             */
*            CALL INALTRA;                                         0316
         BAL   @14,INALTRA                                         0316
*/*          IF NO SEVERE ERRORS                                     */
*            IF LASTCOND < LASTCC12                                0317
*/*            THEN INITIALIZE_PRIMARY_TRACKS                        */
*              THEN DO;    CALL INITPRIM; END;                     0317
         L     @06,@PC00001+8                                      0317
         LH    @06,LASTCOND(,@06)                                  0317
         CH    @06,@CH00265                                        0317
         BNL   @RF00317                                            0317
         BAL   @14,INITPRIM                                        0319
*/*          END-ELSE                                                */
*            END;                                                  0321
@RF00317 DS    0H                                                  0322
*/*      END-THEN                                                    */
*        END;                                                      0322
@RC00303 DS    0H                                                  0323
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0323
*/*    THEN PREPARE_VOLUME_LABELS                                    */
*      THEN  DO;    CALL PREPVOL; END;                             0323
@RF00301 L     @06,@PC00001+8                                      0323
         LH    @06,LASTCOND(,@06)                                  0323
         CH    @06,@CH00265                                        0323
         BNL   @RF00323                                            0323
         BAL   @14,PREPVOL                                         0325
         EJECT
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0327
*/*    THEN PREPARE_VOLUME_TABLE_OF_CONTENTS                         */
*      THEN DO;    CALL PREPVTOC; END;                             0327
@RF00323 L     @06,@PC00001+8                                      0327
         LH    @06,LASTCOND(,@06)                                  0327
         CH    @06,@CH00265                                        0327
         BNL   @RF00327                                            0327
         BAL   @14,PREPVTOC                                        0329
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0331
*/*    THEN                                                          */
*      THEN DO;                                                    0331
*                                                                  0331
@RF00327 L     @06,@PC00001+8                                      0331
         LH    @06,LASTCOND(,@06)                                  0331
         CH    @06,@CH00265                                        0331
         BNL   @RF00331                                            0331
*/*      IF IPL PROGRAM IS SUPPLIED                                  */
*        IF ADDR(IPLDD) ^= NULLPTR                                 0333
*/*        THEN                                                      */
*          THEN DO;                                                0333
*                                                                  0333
         SLR   @06,@06                                             0333
         L     @15,@PC00001+4                                      0333
         C     @06,FDTPTR+52(,@15)                                 0333
         BE    @RF00333                                            0333
*/*          IF MSS IS NOT BEING MIMICKED                            */
*            IF ADDR(MIMIC) = NULLPTR & ADDR(MSS) = NULLPTR        0335
*/*            THEN                                                  */
*              THEN DO;                                            0335
*                                                                  0335
         C     @06,FDTPTR+88(,@15)                                 0335
         BNE   @RF00335                                            0335
         C     @06,FDTPTR+92(,@15)                                 0335
         BNE   @RF00335                                            0335
*/*              SPECIFY THE NOPURGE OPTION                          */
*                PRGFLG = OFF;                                     0337
         NI    PRGFLG,B'01111111'                                  0337
*/*              IF BOOTSTRAP RECORDS ARE SUPPLIED BY THE USER       */
*                IF ADDR (BOOTS) ^= NULLPTR                        0338
*/*                THEN INDICATE THAT THE BOOTSTRAP RECS ARE SUPPLIED*/
*                  THEN DO;    BOOTFLG = BOOTYES; END;             0338
         C     @06,FDTPTR+108(,@15)                                0338
         BE    @RF00338                                            0338
         OI    BOOTFLG,B'10000000'                                 0340
*/*                ELSE INDICATE THAT THEY ARE NOT SUPPLIED          */
*                  ELSE DO;    BOOTFLG = BOOTNO; END;              0342
         B     @RC00338                                            0342
@RF00338 DS    0H                                                  0343
         NI    BOOTFLG,B'01111111'                                 0343
*/*              WRITE_IPL_RECORDS                                   */
*                CALL ICKWI01                                      0345
*                     (GDTTBL                                      0345
*                     ,VOLIB                                       0345
*                     ,IPLDDVAL                                    0345
*                     ,PRGFLG                                      0345
*                     ,BOOTFLG                                     0345
*                     ,RETCODE);                                   0345
@RC00338 L     @06,@PC00001                                        0345
         ST    @06,@AL00001                                        0345
         LA    @06,VOLIB                                           0345
         ST    @06,@AL00001+4                                      0345
         L     @06,@PC00001+4                                      0345
         L     @06,FDTPTR+52(,@06)                                 0345
         LA    @06,IPLDDVAL(,@06)                                  0345
         ST    @06,@AL00001+8                                      0345
         LA    @06,PRGFLG                                          0345
         ST    @06,@AL00001+12                                     0345
         LA    @06,BOOTFLG                                         0345
         ST    @06,@AL00001+16                                     0345
         LA    @06,RETCODE                                         0345
         ST    @06,@AL00001+20                                     0345
         L     @15,@CV00774                                        0345
         LA    @01,@AL00001                                        0345
         BALR  @14,@15                                             0345
*/*              IF WRITE OPERATION FAILS                            */
*                IF RETCODE = FAILURE                              0346
*/*                THEN                                              */
*                  THEN DO;                                        0346
*                                                                  0346
         CLC   RETCODE(4),@CF00165                                 0346
         BNE   @RF00346                                            0346
*/*                  ISSUE ERROR MESSAGE (MSGIPLA) (UPRINT)          */
*                    DARGSENT = MSGIPLA;                           0348
         L     @06,DDSTRU                                          0348
         MVI   DARGSENT(@06),X'09'                                 0348
*                    CALL ICKTPPR0 (GDTTBL                         0349
*                           ,PRTFILE                               0349
*                           ,DDSTRU);                              0349
         L     @06,@PC00001                                        0349
         ST    @06,@AL00001                                        0349
         LA    @15,@CF00094                                        0349
         ST    @15,@AL00001+4                                      0349
         LA    @15,DDSTRU                                          0349
         ST    @15,@AL00001+8                                      0349
         MVI   @AL00001+8,X'80'                                    0349
         L     @15,GDTPRT(,@06)                                    0349
         LA    @01,@AL00001                                        0349
         BALR  @14,@15                                             0349
*/*                  INDICATE AN ERROR (LASTCOND = 8)                */
*                    LASTCOND = MAX (LASTCC08,LASTCOND);           0350
         L     @06,@PC00001+8                                      0350
         LH    @15,LASTCOND(,@06)                                  0350
         LA    @14,8                                               0350
         CR    @15,@14                                             0350
         BNL   *+6
         LR    @15,@14                                             0350
         STH   @15,LASTCOND(,@06)                                  0350
*/*                  END-THEN                                        */
*                    END;                                          0351
*/*              END-THEN (MSS NOT BEING MIMICKED)                   */
*                END;                                              0352
*/*            ELSE ( MSS IS BEING MIMICKED)                         */
*              ELSE DO;                                            0353
*                                                                  0353
         B     @RC00335                                            0353
@RF00335 DS    0H                                                  0354
*/*              ISSUE WARNING MESSAGE (MSGIPLB) (UPRINT)            */
*                DARGSENT = MSGIPLB;                               0354
         L     @06,DDSTRU                                          0354
         MVI   DARGSENT(@06),X'0A'                                 0354
*                CALL ICKTPPR0 (GDTTBL                             0355
*                       ,PRTFILE                                   0355
*                       ,DDSTRU);                                  0355
         L     @06,@PC00001                                        0355
         ST    @06,@AL00001                                        0355
         LA    @15,@CF00094                                        0355
         ST    @15,@AL00001+4                                      0355
         LA    @15,DDSTRU                                          0355
         ST    @15,@AL00001+8                                      0355
         MVI   @AL00001+8,X'80'                                    0355
         L     @15,GDTPRT(,@06)                                    0355
         LA    @01,@AL00001                                        0355
         BALR  @14,@15                                             0355
*/*              INDICATE MINOR ERROR                                */
*                LASTCOND = MAX(LASTCC04,LASTCOND);                0356
         L     @06,@PC00001+8                                      0356
         LH    @15,LASTCOND(,@06)                                  0356
         LA    @14,4                                               0356
         CR    @15,@14                                             0356
         BNL   *+6
         LR    @15,@14                                             0356
         STH   @15,LASTCOND(,@06)                                  0356
*/*              END-ELSE                                            */
*                END;                                              0357
*/*          END-THEN (IPL PROGRAM IS SUPPLIED)                      */
*            END;                                                  0358
@RC00335 DS    0H                                                  0359
*/*      END-THEN                                                    */
*        END;                                                      0359
@RF00333 DS    0H                                                  0360
         EJECT
*/*  PRODUCE_PACK_MAP                                                */
*    IF LASTCOND < LASTCC12                                        0360
*      THEN DO;                                                    0360
*                                                                  0360
@RF00331 L     @06,@PC00001+8                                      0360
         LH    @06,LASTCOND(,@06)                                  0360
         CH    @06,@CH00265                                        0360
         BNL   @RF00360                                            0360
*        IF ADDR(MAP) ^= NULLPTR                                   0362
*          THEN DO;    PRTFLG = PRINT; END;                        0362
         L     @06,@PC00001+4                                      0362
         L     @06,FDTPTR+80(,@06)                                 0362
         LTR   @06,@06                                             0362
         BZ    @RF00362                                            0362
         OI    PRTFLG,B'10000000'                                  0364
*          ELSE DO;    PRTFLG = NOPRINT; END;                      0366
         B     @RC00362                                            0366
@RF00362 DS    0H                                                  0367
         NI    PRTFLG,B'01111111'                                  0367
*        IF ADDR(CHECK) ^= NULLPTR                                 0369
*          THEN DO;    CHKFLG = ON; END;                           0369
@RC00362 L     @06,@PC00001+4                                      0369
         L     @06,FDTPTR+12(,@06)                                 0369
         LTR   @06,@06                                             0369
         BZ    @RF00369                                            0369
         OI    CHKFLG,B'10000000'                                  0371
*          ELSE DO;    CHKFLG = OFF; END;                          0373
         B     @RC00369                                            0373
@RF00369 DS    0H                                                  0374
         NI    CHKFLG,B'01111111'                                  0374
*        END;                                                      0376
*      ELSE DO;    PRTFLG = NOPRINT; END;                          0377
         B     @RC00360                                            0377
@RF00360 DS    0H                                                  0378
         NI    PRTFLG,B'01111111'                                  0378
*    CALL ICKPP01                                                  0380
*         (GDTTBL                                                  0380
*         ,VOLIB                                                   0380
*         ,PRTFLG                                                  0380
*         ,CHKFLG                                                  0380
*         ,VTOCLOC                                                 0380
*         ,VTOCEXT                                                 0380
*         ,ALTCOUNT                                                0380
*         ,RETCODE);                                               0380
@RC00360 L     @06,@PC00001                                        0380
         ST    @06,@AL00001                                        0380
         LA    @06,VOLIB                                           0380
         ST    @06,@AL00001+4                                      0380
         LA    @06,PRTFLG                                          0380
         ST    @06,@AL00001+8                                      0380
         LA    @06,CHKFLG                                          0380
         ST    @06,@AL00001+12                                     0380
         LA    @06,VTOCLOC                                         0380
         ST    @06,@AL00001+16                                     0380
         LA    @06,VTOCEXT                                         0380
         ST    @06,@AL00001+20                                     0380
         LA    @06,ALTCOUNT                                        0380
         ST    @06,@AL00001+24                                     0380
         LA    @06,RETCODE                                         0380
         ST    @06,@AL00001+28                                     0380
         L     @15,@CV00775                                        0380
         LA    @01,@AL00001                                        0380
         BALR  @14,@15                                             0380
*/*  CLOSE THE VOLUME (UDEVCLSE)                                     */
*    CALL ICKDVCL0 (GDTTBL                                         0381
*             ,VOLIB                                               0381
*             ,RETCODE);                                           0381
         L     @06,@PC00001                                        0381
         ST    @06,@AL00001                                        0381
         LA    @15,VOLIB                                           0381
         ST    @15,@AL00001+4                                      0381
         LA    @15,RETCODE                                         0381
         ST    @15,@AL00001+8                                      0381
         L     @15,GDTDVC(,@06)                                    0381
         LA    @01,@AL00001                                        0381
         BALR  @14,@15                                             0381
*/*  IF UNABLE TO CLOSE THE VOLUME                                   */
*    IF RETCODE = FAILURE                                          0382
*/*    THEN                                                          */
*      THEN DO;                                                    0382
*                                                                  0382
         CLC   RETCODE(4),@CF00165                                 0382
         BNE   @RF00382                                            0382
*/*      ISSUE WARNING MESSAGE (MSGCLSEA) (UPRINT)                   */
*        DARGSENT = MSGCLSEA;                                      0384
         L     @06,DDSTRU                                          0384
         MVI   DARGSENT(@06),X'0B'                                 0384
*        CALL ICKTPPR0 (GDTTBL                                     0385
*               ,PRTFILE                                           0385
*               ,DDSTRU);                                          0385
         L     @06,@PC00001                                        0385
         ST    @06,@AL00001                                        0385
         LA    @15,@CF00094                                        0385
         ST    @15,@AL00001+4                                      0385
         LA    @15,DDSTRU                                          0385
         ST    @15,@AL00001+8                                      0385
         MVI   @AL00001+8,X'80'                                    0385
         L     @15,GDTPRT(,@06)                                    0385
         LA    @01,@AL00001                                        0385
         BALR  @14,@15                                             0385
*/*      INDICATE MINOR ERROR UNLESS PREVIOUS ERROR WAS SEVERE       */
*        LASTCOND = MAX (LASTCOND,LASTCC04);                       0386
         L     @06,@PC00001+8                                      0386
         LH    @15,LASTCOND(,@06)                                  0386
         LA    @14,4                                               0386
         CR    @15,@14                                             0386
         BNL   *+6
         LR    @15,@14                                             0386
         STH   @15,LASTCOND(,@06)                                  0386
*/*      END-THEN                                                    */
*        END;                                                      0387
*/*  RETURN                                                          */
*    DARGSMOD = MSGUNIV;                                           0388
@RF00382 L     @06,DDSTRU                                          0388
         MVC   DARGSMOD(3,@06),@CC00573                            0388
*    IF LASTCOND >= LASTCC12                                       0389
*      THEN DO;    DARGSENT = MSGUNIVB; END;                       0389
         L     @15,@PC00001+8                                      0389
         LH    @15,LASTCOND(,@15)                                  0389
         CH    @15,@CH00265                                        0389
         BL    @RF00389                                            0389
         MVI   DARGSENT(@06),X'03'                                 0391
*      ELSE DO;    DARGSENT = MSGUNIVA; END;                       0393
         B     @RC00389                                            0393
@RF00389 DS    0H                                                  0394
         L     @06,DDSTRU                                          0394
         MVI   DARGSENT(@06),X'01'                                 0394
*    DARGDBP = ADDR (LASTCOND);                                    0396
@RC00389 L     @06,DDSTRU                                          0396
         L     @15,@PC00001+8                                      0396
         ST    @15,DARGDBP(,@06)                                   0396
*    DARGILP = LENGTH (LASTCOND);                                  0397
         MVC   DARGILP(2,@06),@CH00116                             0397
*    CALL ICKTPPR0 (GDTTBL                                         0398
*           ,PRTFILE                                               0398
*           ,DDSTRU);                                              0398
         L     @06,@PC00001                                        0398
         ST    @06,@AL00001                                        0398
         LA    @15,@CF00094                                        0398
         ST    @15,@AL00001+4                                      0398
         LA    @15,DDSTRU                                          0398
         ST    @15,@AL00001+8                                      0398
         MVI   @AL00001+8,X'80'                                    0398
         L     @15,GDTPRT(,@06)                                    0398
         LA    @01,@AL00001                                        0398
         BALR  @14,@15                                             0398
*    CALL ICKSAFP0 (GDTTBL                                         0399
*           ,POOLID);                                              0399
         L     @06,@PC00001                                        0399
         ST    @06,@AL00001                                        0399
         LA    @15,POOLID                                          0399
         ST    @15,@AL00001+4                                      0399
         MVI   @AL00001+4,X'80'                                    0399
         L     @15,GDTFPL(,@06)                                    0399
         LA    @01,@AL00001                                        0399
         BALR  @14,@15                                             0399
*    IF GDTDBG = NULLPTR                                           0400
*      THEN;                                                       0400
         L     @06,@PC00001                                        0400
         L     @06,GDTDBG(,@06)                                    0400
         LTR   @06,@06                                             0400
         BZ    @RT00400                                            0400
*      ELSE                                                        0402
*        CALL ICKDB010 (GDTTBL                                     0402
*          ,'IN99');                                               0402
         L     @06,@PC00001                                        0402
         ST    @06,@AL00001                                        0402
         LA    @15,@CC00776                                        0402
         ST    @15,@AL00001+4                                      0402
         MVI   @AL00001+4,X'80'                                    0402
         L     @15,GDTDBG(,@06)                                    0402
         LA    @01,@AL00001                                        0402
         BALR  @14,@15                                             0402
*     CALL ICKSAEP0(GDTTBL,MODID);                                 0403
*                                                                  0403
@RT00400 L     @06,@PC00001                                        0403
         ST    @06,@AL00001                                        0403
         LA    @15,MODID                                           0403
         ST    @15,@AL00001+4                                      0403
         MVI   @AL00001+4,X'80'                                    0403
         L     @15,GDTEPL(,@06)                                    0403
         LA    @01,@AL00001                                        0403
         BALR  @14,@15                                             0403
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  OPENVOL                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE OPEN VOLUME                            */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUBPROCEDURE INVOKES THE DEVICE ADAPTER MODULE THAT      */
*/*    OPENS THE VOLUME FOR SUBSEQUENT PROCESSING. IT ALSO ENSURES   */
*/*    THAT THE VOLUME IS MOUNTED PRIVATE WHEN THE VOLUME IS ON-LINE.*/
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0404
*                                                                  0404
*/*  SUB-PROCEDURE ISSUE_OPEN_VOLUME                                 */
*    OPENVOL:                                                      0404
*      PROCEDURE;                                                  0404
OPENVOL  STM   @14,@12,@SA00002                                    0404
*    OLDERID2 = NEWERID2;                                          0405
         L     @06,@PC00001                                        0405
         L     @06,GDTTR2(,@06)                                    0405
         MVC   @TS00001(95),NEWERID2(@06)                          0405
         MVC   OLDERID2(95,@06),@TS00001                           0405
*    NEWID2 =  'INOP';                                             0406
         MVC   NEWID2(4,@06),@CC00780                              0406
*/*  OPEN THE VOLUME FOR PROCESSING (UDEVOPEN)                       */
*/*  SET UP THE MSS PARAMETER                                        */
*    IF (ADDR(MIMIC) ^= NULLPTR) & (ADDR(MSS) ^= NULLPTR)          0407
*      THEN DO;    MSSDEV = 'MSS'; END;                            0407
         SLR   @06,@06                                             0407
         L     @15,@PC00001+4                                      0407
         C     @06,FDTPTR+88(,@15)                                 0407
         BE    @RF00407                                            0407
         C     @06,FDTPTR+92(,@15)                                 0407
         BE    @RF00407                                            0407
         MVI   MSSDEV+3,C' '                                       0409
         MVC   MSSDEV+4(4),MSSDEV+3                                0409
         MVC   MSSDEV(3),@CC00781                                  0409
*      ELSE DO;    MSSDEV = ' '; END;                              0411
         B     @RC00407                                            0411
@RF00407 DS    0H                                                  0412
         MVI   MSSDEV+1,C' '                                       0412
         MVC   MSSDEV+2(6),MSSDEV+1                                0412
         MVI   MSSDEV,C' '                                         0412
*/*  SET UP THE CUU OR DD-NAME PARAMETER                             */
*    IF (ADDR(DEVIC) ^= NULLPTR) & (ADDR(DNAME) = NULLPTR)         0414
*      THEN DO;                                                    0414
*                                                                  0414
@RC00407 SLR   @06,@06                                             0414
         L     @15,@PC00001+4                                      0414
         L     @14,FDTPTR(,@15)                                    0414
         CR    @14,@06                                             0414
         BE    @RF00414                                            0414
         C     @06,FDTPTR+100(,@15)                                0414
         BNE   @RF00414                                            0414
*        VIBNAME = DEVICVAL;                                       0416
         MVI   VIBNAME+3,C' '                                      0416
         MVC   VIBNAME+4(4),VIBNAME+3                              0416
         MVC   VIBNAME(3),DEVICVAL(@14)                            0416
*        VIBTYPE = CUUVAL;                                         0417
         ST    @06,VIBTYPE                                         0417
*        END;                                                      0418
*      ELSE DO;                                                    0419
*                                                                  0419
         B     @RC00414                                            0419
@RF00414 DS    0H                                                  0420
*        VIBNAME = DNAMEVAL;                                       0420
         L     @06,@PC00001+4                                      0420
         L     @06,FDTPTR+100(,@06)                                0420
         MVC   VIBNAME(8),DNAMEVAL(@06)                            0420
*        VIBTYPE = DDNVAL;                                         0421
         MVC   VIBTYPE(4),@CF00165                                 0421
*        END;                                                      0422
*/*  IF DEVICETYPE IS SUPPLIED                                       */
*    IF ADDR (DEVTY) ^= NULLPTR                                    0423
*/*    THEN PASS THE DEVICE TYPE                                     */
*      THEN DO;    DEVTYPE = DEVTYVAL; END;                        0423
@RC00414 L     @06,@PC00001+4                                      0423
         L     @06,FDTPTR+104(,@06)                                0423
         LTR   @06,@06                                             0423
         BZ    @RF00423                                            0423
         MVC   DEVTYPE(8),DEVTYVAL(@06)                            0425
*/*    ELSE INDICATE NO DEVICE TYPE SUPPLIED                         */
*      ELSE DO;    DEVTYPE = ' '; END;                             0427
         B     @RC00423                                            0427
@RF00423 DS    0H                                                  0428
         MVI   DEVTYPE+1,C' '                                      0428
         MVC   DEVTYPE+2(6),DEVTYPE+1                              0428
         MVI   DEVTYPE,C' '                                        0428
*    CALL ICKDVON0 (GDTTBL                                         0430
*             ,VIBNAME                                             0430
*             ,VIBTYPE                                             0430
*             ,DEVTYPE                                             0430
*             ,MSSDEV                                              0430
*             ,VOLIB                                               0430
*             ,RETCODE);                                           0430
@RC00423 L     @06,@PC00001                                        0430
         ST    @06,@AL00001                                        0430
         LA    @15,VIBNAME                                         0430
         ST    @15,@AL00001+4                                      0430
         LA    @15,VIBTYPE                                         0430
         ST    @15,@AL00001+8                                      0430
         LA    @15,DEVTYPE                                         0430
         ST    @15,@AL00001+12                                     0430
         LA    @15,MSSDEV                                          0430
         ST    @15,@AL00001+16                                     0430
         LA    @15,VOLIB                                           0430
         ST    @15,@AL00001+20                                     0430
         LA    @15,RETCODE                                         0430
         ST    @15,@AL00001+24                                     0430
         L     @15,GDTDVO(,@06)                                    0430
         LA    @01,@AL00001                                        0430
         BALR  @14,@15                                             0430
*/*  IF CUU OR DD-NAME IS INVALID                                    */
*    IF RETCODE = INVALCUU                                         0431
*/*    THEN                                                          */
*      THEN DO;                                                    0431
*                                                                  0431
         CLC   RETCODE(4),@CF00165                                 0431
         BNE   @RF00431                                            0431
*/*      ISSUE ERROR MESSAGE (MSGINCUU) (UPRINT)                     */
*        DARGSENT = MSGINCUU;                                      0433
         L     @06,DDSTRU                                          0433
         MVI   DARGSENT(@06),X'18'                                 0433
*        CALL ICKTPPR0 (GDTTBL                                     0434
*               ,PRTFILE                                           0434
*               ,DDSTRU);                                          0434
         L     @06,@PC00001                                        0434
         ST    @06,@AL00001                                        0434
         LA    @15,@CF00094                                        0434
         ST    @15,@AL00001+4                                      0434
         LA    @15,DDSTRU                                          0434
         ST    @15,@AL00001+8                                      0434
         MVI   @AL00001+8,X'80'                                    0434
         L     @15,GDTPRT(,@06)                                    0434
         LA    @01,@AL00001                                        0434
         BALR  @14,@15                                             0434
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      0435
         L     @06,@PC00001+8                                      0435
         MVC   LASTCOND(2,@06),@CH00265                            0435
*/*      END-THEN                                                    */
*        END;                                                      0436
*/*  IF NO ERRORS FOUND SO FAR                                       */
*    IF LASTCOND < LASTCC12                                        0437
*/*    THEN                                                          */
*      THEN DO;                                                    0437
*                                                                  0437
@RF00431 L     @06,@PC00001+8                                      0437
         LH    @06,LASTCOND(,@06)                                  0437
         CH    @06,@CH00265                                        0437
         BNL   @RF00437                                            0437
*/*      IF UNABLE TO OPEN VOLUME                                    */
*        IF RETCODE = NOOPEN                                       0439
*/*        THEN                                                      */
*          THEN DO;                                                0439
*                                                                  0439
         CLC   RETCODE(4),@CF00116                                 0439
         BNE   @RF00439                                            0439
*/*          ISSUE ERROR MESSAGE (MSGNOPEN) (UPRINT)                 */
*            DARGSENT = MSGNOPEN;                                  0441
         L     @06,DDSTRU                                          0441
         MVI   DARGSENT(@06),X'19'                                 0441
*            CALL ICKTPPR0 (GDTTBL                                 0442
*                   ,PRTFILE                                       0442
*                   ,DDSTRU);                                      0442
         L     @06,@PC00001                                        0442
         ST    @06,@AL00001                                        0442
         LA    @15,@CF00094                                        0442
         ST    @15,@AL00001+4                                      0442
         LA    @15,DDSTRU                                          0442
         ST    @15,@AL00001+8                                      0442
         MVI   @AL00001+8,X'80'                                    0442
         L     @15,GDTPRT(,@06)                                    0442
         LA    @01,@AL00001                                        0442
         BALR  @14,@15                                             0442
*/*          INDICATE SEVERE ERROR (LASTCOND = 12)                   */
*            LASTCOND = LASTCC12;                                  0443
         L     @06,@PC00001+8                                      0443
         MVC   LASTCOND(2,@06),@CH00265                            0443
*/*          END-THEN                                                */
*            END;                                                  0444
*/*      END-THEN                                                    */
*        END;                                                      0445
@RF00439 DS    0H                                                  0446
*/*  IF NO ERRORS FOUND SO FAR                                       */
*    IF LASTCOND < LASTCC12                                        0446
*/*    THEN                                                          */
*      THEN DO;                                                    0446
*                                                                  0446
@RF00437 L     @06,@PC00001+8                                      0446
         LH    @06,LASTCOND(,@06)                                  0446
         CH    @06,@CH00265                                        0446
         BNL   @RF00446                                            0446
*/*      IF CUU WAS SPECIFIED FOR AN ON-LINE VOLUME                  */
*        IF RETCODE = RCCUUONL                                     0448
*/*        THEN                                                      */
*          THEN DO;                                                0448
*                                                                  0448
         CLC   RETCODE(4),@CF00136                                 0448
         BNE   @RF00448                                            0448
*/*          ISSUE AN ERROR MESSAGE (MSGLINE)                        */
*            DARGSENT = MSGLINE;                                   0450
         L     @06,DDSTRU                                          0450
         MVI   DARGSENT(@06),X'31'                                 0450
*            CALL ICKTPPR0 (GDTTBL                                 0451
*                   ,PRTFILE                                       0451
*                   ,DDSTRU);                                      0451
         L     @06,@PC00001                                        0451
         ST    @06,@AL00001                                        0451
         LA    @15,@CF00094                                        0451
         ST    @15,@AL00001+4                                      0451
         LA    @15,DDSTRU                                          0451
         ST    @15,@AL00001+8                                      0451
         MVI   @AL00001+8,X'80'                                    0451
         L     @15,GDTPRT(,@06)                                    0451
         LA    @01,@AL00001                                        0451
         BALR  @14,@15                                             0451
*/*          INDICATE A SEVERE ERROR                                 */
*            LASTCOND = LASTCC12;                                  0452
         L     @06,@PC00001+8                                      0452
         MVC   LASTCOND(2,@06),@CH00265                            0452
*/*          END-THEN                                                */
*            END;                                                  0453
*/*      END-THEN                                                    */
*        END;                                                      0454
@RF00448 DS    0H                                                  0455
*/*  IF NO ERRORS FOUND SO FAR                                       */
*    IF LASTCOND < LASTCC12                                        0455
*/*    THEN                                                          */
*      THEN DO;                                                    0455
*                                                                  0455
@RF00446 L     @06,@PC00001+8                                      0455
         LH    @06,LASTCOND(,@06)                                  0455
         CH    @06,@CH00265                                        0455
         BNL   @RF00455                                            0455
*/*      IF SUCCESSFUL IN OPENING THE VOLUME                         */
*        IF RETCODE = SUCCESS                                      0457
*/*        THEN                                                      */
*          THEN DO;                                                0457
*                                                                  0457
         L     @06,RETCODE                                         0457
         LTR   @06,@06                                             0457
         BNZ   @RF00457                                            0457
*/*          OBTAIN INFORMATION ABOUT TYPE OF MOUNTING (UDEVINFO)    */
*            CALL ICKDVIN0 (GDTTBL                                 0459
*                     ,VOLIB                                       0459
*                     ,VOLPRVOL                                    0459
*                     ,POOLID                                      0459
*                     ,VIBPTR                                      0459
*                     ,VIBLEN                                      0459
*                     ,RETCODE);                                   0459
         L     @06,@PC00001                                        0459
         ST    @06,@AL00001                                        0459
         LA    @15,VOLIB                                           0459
         ST    @15,@AL00001+4                                      0459
         LA    @15,@CF00161                                        0459
         ST    @15,@AL00001+8                                      0459
         LA    @15,POOLID                                          0459
         ST    @15,@AL00001+12                                     0459
         LA    @15,VIBPTR                                          0459
         ST    @15,@AL00001+16                                     0459
         LA    @15,VIBLEN                                          0459
         ST    @15,@AL00001+20                                     0459
         LA    @15,RETCODE                                         0459
         ST    @15,@AL00001+24                                     0459
         L     @15,GDTDIN(,@06)                                    0459
         LA    @01,@AL00001                                        0459
         BALR  @14,@15                                             0459
*/*          IF THE VOLUME IS NOT MOUNTED PRIVATE AND DD-NAME        */
*/*           IS SPECIFIED                                           */
*            IF VIBPFLAG = OFF & VIBTYPE = DDNVAL                  0460
*/*            THEN                                                  */
*              THEN DO;                                            0460
*                                                                  0460
         L     @06,VIBPTR                                          0460
         TM    VIBPFLAG(@06),B'10000000'                           0460
         BNZ   @RF00460                                            0460
         CLC   VIBTYPE(4),@CF00165                                 0460
         BNE   @RF00460                                            0460
*/*              ISSUE ERROR MESSAGE (MSGNPRIV) (UPRINT)             */
*                DARGSENT = MSGNPRIV;                              0462
         L     @06,DDSTRU                                          0462
         MVI   DARGSENT(@06),X'1A'                                 0462
*                CALL ICKTPPR0 (GDTTBL                             0463
*                       ,PRTFILE                                   0463
*                       ,DDSTRU);                                  0463
         L     @06,@PC00001                                        0463
         ST    @06,@AL00001                                        0463
         LA    @15,@CF00094                                        0463
         ST    @15,@AL00001+4                                      0463
         LA    @15,DDSTRU                                          0463
         ST    @15,@AL00001+8                                      0463
         MVI   @AL00001+8,X'80'                                    0463
         L     @15,GDTPRT(,@06)                                    0463
         LA    @01,@AL00001                                        0463
         BALR  @14,@15                                             0463
*/*              INDICATE SEVERE ERROR (LASTCOND = 12)               */
*                LASTCOND = LASTCC12;                              0464
         L     @06,@PC00001+8                                      0464
         MVC   LASTCOND(2,@06),@CH00265                            0464
*/*              END-THEN                                            */
*                END;                                              0465
*/*          END-THEN (OPEN WAS SUCCESSFUL)                          */
*            END;                                                  0466
*/*      END-THEN                                                    */
*        END;                                                      0467
*/*  END-SUB-PROCEDURE ISSUE_OPEN_VOLUME                             */
*    END OPENVOL;                                                  0468
@EL00002 DS    0H                                                  0468
@EF00002 DS    0H                                                  0468
@ER00002 LM    @14,@12,@SA00002                                    0468
         BR    @14                                                 0468
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  PACKINFO                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  OBTAIN PACK INFORMATION                      */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE OBTAINS DEVICE INFORMATION FROM THE        */
*/*    DEVICE INFORMATION TABLE (DIT) VIA A DEVICE ADAPTER FACILITY  */
*/*    (UDEVINFO). ALL THE PACK INFORMATION REQUIRED BY THE COMMAND  */
*/*    CONTROLLER IS OBTAINED BY THIS SUB-PROCEDURE.                 */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0469
*                                                                  0469
*/*  SUB-PROCEDURE OBTAIN_PACK_INFORMATION                           */
*    PACKINFO:                                                     0469
*      PROCEDURE;                                                  0469
PACKINFO STM   @14,@12,@SA00003                                    0469
*    OLDERID2 = NEWERID2;                                          0470
         L     @06,@PC00001                                        0470
         L     @06,GDTTR2(,@06)                                    0470
         MVC   @TS00001(95),NEWERID2(@06)                          0470
         MVC   OLDERID2(95,@06),@TS00001                           0470
*    NEWID2 =  'INPI';                                             0471
         MVC   NEWID2(4,@06),@CC00785                              0471
*/*  OBTAIN FOLLOWING INFORMATION FROM DIT (UDEVINFO):               */
*/*   1. THRESHOLD                                                   */
*/*   2. NUMBER OF TRACKS PER CYLINDER                               */
*/*   3. TOTAL NUMBER OF PRIMARY TRACKS                              */
*/*   4. TOTAL NUMBER OF ALTERNATE TRACKS                            */
*/*   5. ADDRESS OF THE FIRST ALTERNATE TRACK                        */
*/*   6. ADDRESS OF THE LAST ALTERNATE TRACK                         */
*/*   7. ADDRESS OF THE LAST PRIMARY TRACK                           */
*/*   8. DEFAULT VTOC LOCATION                                       */
*/*   9. DEFAULT EXTENT FOR THE VTOC                                 */
*/*   10. FIRST TIME INITIALIZATION FLAG.                            */
*    DO I = 1 TO INFOSET;                                          0472
*                                                                  0472
         LA    I,1                                                 0472
@DL00472 DS    0H                                                  0473
*    CALL ICKDVIN0 (GDTTBL                                         0473
*             ,VOLIB                                               0473
*             ,INFOVECT (I)                                        0473
*             ,POOLID                                              0473
*             ,INFOPTR (I)                                         0473
*             ,INFOLEN (I)                                         0473
*             ,CONDCODE (I));                                      0473
         L     @06,@PC00001                                        0473
         ST    @06,@AL00001                                        0473
         LA    @03,VOLIB                                           0473
         ST    @03,@AL00001+4                                      0473
         LR    @03,I                                               0473
         SLA   @03,2                                               0473
         LA    @03,INFOVECT-4(@03)                                 0473
         ST    @03,@AL00001+8                                      0473
         LA    @03,POOLID                                          0473
         ST    @03,@AL00001+12                                     0473
         LR    @03,I                                               0473
         MH    @03,@CH00265                                        0473
         LA    @15,INFOPTR-12(@03)                                 0473
         ST    @15,@AL00001+16                                     0473
         LA    @15,INFOLEN-12(@03)                                 0473
         ST    @15,@AL00001+20                                     0473
         LA    @03,CONDCODE-12(@03)                                0473
         ST    @03,@AL00001+24                                     0473
         L     @15,GDTDIN(,@06)                                    0473
         LA    @01,@AL00001                                        0473
         BALR  @14,@15                                             0473
*    END;                                                          0474
         AL    I,@CF00165                                          0474
         CH    I,@CH00260                                          0474
         BNH   @DL00472                                            0474
*/*  END-SUB-PROCEDURE OBTAIN_PACK_INFORMATION                       */
*    END PACKINFO;                                                 0475
*                                                                  0475
@EL00003 DS    0H                                                  0475
@EF00003 DS    0H                                                  0475
@ER00003 LM    @14,@12,@SA00003                                    0475
         BR    @14                                                 0475
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  CHEKPARM                                  */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  CHECK_PARAMETERS                             */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE CHECKS THE PARAMETERS FOR THE FIRST TRACK  */
*/*    ON THE PACK AND ESTABLISHES IF PROCESSING CAN CONTINUE.       */
*/*    IF A VOLUME LABEL DOES NOT EXIST AND VOLID IS NOT SPECIFIED   */
*/*    PROCESSING IS TERMINATED.                                     */
*/*    IF AN MSS STAGING PACK IS BEING CREATED AND VOLID IS NOT      */
*/*    SPECIFIED THE PROCESSING IS TERMINATED.                       */
*/*    THE VTOC LOCATION AND EXTENT IS ALSO DETERMINED HERE SO       */
*/*    THAT THIS INFORMATION IS AVAILABLE READILY IF NEEDED BY OTHER */
*/*    SUB-PROCEDURES.                                               */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0476
*                                                                  0476
*/*  SUB-PROCEDURE CHECK_PARAMETERS                                  */
*    CHEKPARM:                                                     0476
*      PROCEDURE;                                                  0476
CHEKPARM STM   @14,@12,@SA00004                                    0476
*    OLDERID2 = NEWERID2;                                          0477
         L     @06,@PC00001                                        0477
         L     @15,GDTTR2(,@06)                                    0477
         MVC   @TS00001(95),NEWERID2(@15)                          0477
         MVC   OLDERID2(95,@15),@TS00001                           0477
*    NEWID2 =  'INCP';                                             0478
         MVC   NEWID2(4,@15),@CC00789                              0478
*/*  IF VOLUME LABEL DOES NOT EXIST                                  */
*    IF LABFLAG = LABNO                                            0479
*/*    THEN                                                          */
*      THEN DO;                                                    0479
*                                                                  0479
         TM    LABFLAG,B'10000000'                                 0479
         BNZ   @RF00479                                            0479
*/*      IF VOLID IS NOT SUPPLIED                                    */
*        IF ADDR(VOLID) = NULLPTR                                  0481
*/*        THEN                                                      */
*          THEN DO;                                                0481
*                                                                  0481
         L     @15,@PC00001+4                                      0481
         L     @15,FDTPTR+40(,@15)                                 0481
         LTR   @15,@15                                             0481
         BNZ   @RF00481                                            0481
*/*          ISSUE ERROR MESSAGE (MSGVOLA) (UPRINT)                  */
*            DARGSENT = MSGVOLA;                                   0483
         L     @01,DDSTRU                                          0483
         MVI   DARGSENT(@01),X'0D'                                 0483
*            CALL ICKTPPR0 (GDTTBL                                 0484
*                   ,PRTFILE                                       0484
*                   ,DDSTRU);                                      0484
         ST    @06,@AL00001                                        0484
         LA    @15,@CF00094                                        0484
         ST    @15,@AL00001+4                                      0484
         LA    @15,DDSTRU                                          0484
         ST    @15,@AL00001+8                                      0484
         MVI   @AL00001+8,X'80'                                    0484
         L     @15,GDTPRT(,@06)                                    0484
         LA    @01,@AL00001                                        0484
         BALR  @14,@15                                             0484
*/*          INDICATE SEVERE ERROR (LASTCOND = 12)                   */
*            LASTCOND = LASTCC12;                                  0485
         L     @06,@PC00001+8                                      0485
         MVC   LASTCOND(2,@06),@CH00265                            0485
*/*          END-THEN (VOLID NOT SUPPLIED)                           */
*            END;                                                  0486
*/*      END-THEN (VOLUME LABEL DOES NOT EXIST)                      */
*        END;                                                      0487
@RF00481 DS    0H                                                  0488
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0488
*/*    THEN                                                          */
*      THEN DO;                                                    0488
*                                                                  0488
@RF00479 L     @06,@PC00001+8                                      0488
         LH    @06,LASTCOND(,@06)                                  0488
         CH    @06,@CH00265                                        0488
         BNL   @RF00488                                            0488
*/*      IF VTOC LOCATION IS NOT SPECIFIED                           */
*        IF ADDR(VTOC) = NULLPTR                                   0490
*/*        THEN SET VTOC LOCATION TO DEFAULT                         */
*          THEN DO;                                                0490
*                                                                  0490
         L     @06,@PC00001+4                                      0490
         L     @06,FDTPTR+28(,@06)                                 0490
         LTR   @06,@06                                             0490
         BNZ   @RF00490                                            0490
*            VTOCLOCC = DEFVTOCC;                                  0492
         L     @06,INFOPTR+84                                      0492
         MVC   VTOCLOCC(2),DEFVTOCC(@06)                           0492
*            VTOCLOCT = DEFVTOCT;                                  0493
         MVC   VTOCLOCT(2),DEFVTOCT(@06)                           0493
*            END;                                                  0494
*/*        ELSE                                                      */
*          ELSE DO;                                                0495
         B     @RC00490                                            0495
@RF00490 DS    0H                                                  0496
*/*          IF MIMIC IS SPECIFIED AND DEVICE IS MSS                 */
*            IF (ADDR(MIMIC) ^= NULLPTR) & (ADDR(MSS) ^= NULLPTR)  0496
*/*            THEN                                                  */
*              THEN DO;                                            0496
*                                                                  0496
         SLR   @06,@06                                             0496
         L     @15,@PC00001+4                                      0496
         C     @06,FDTPTR+88(,@15)                                 0496
         BE    @RF00496                                            0496
         C     @06,FDTPTR+92(,@15)                                 0496
         BE    @RF00496                                            0496
*/*              ISSUE MESSAGE (MSGMSSV)                             */
*                DARGSENT = MSGMSSV;                               0498
         L     @06,DDSTRU                                          0498
         MVI   DARGSENT(@06),X'32'                                 0498
*                CALL ICKTPPR0 (GDTTBL                             0499
*                       ,PRTFILE                                   0499
*                       ,DDSTRU);                                  0499
         L     @06,@PC00001                                        0499
         ST    @06,@AL00001                                        0499
         LA    @15,@CF00094                                        0499
         ST    @15,@AL00001+4                                      0499
         LA    @15,DDSTRU                                          0499
         ST    @15,@AL00001+8                                      0499
         MVI   @AL00001+8,X'80'                                    0499
         L     @15,GDTPRT(,@06)                                    0499
         LA    @01,@AL00001                                        0499
         BALR  @14,@15                                             0499
*/*              FORCE VTOC LOCATION TO THE DEFAULT LOCATION         */
*                VTOCLOCC = DEFVTOCC;                              0500
         L     @06,INFOPTR+84                                      0500
         MVC   VTOCLOCC(2),DEFVTOCC(@06)                           0500
*                VTOCLOCT = DEFVTOCT;                              0501
         MVC   VTOCLOCT(2),DEFVTOCT(@06)                           0501
*/*              END-THEN                                            */
*                END;                                              0502
*/*            ELSE SET VTOC LOCATION AS SPECIFIED                   */
*              ELSE DO;                                            0503
*                                                                  0503
         B     @RC00496                                            0503
@RF00496 DS    0H                                                  0504
*                CALL DCVTPROC                                     0504
*                     (TRACKVAL                                    0504
*                     ,VTOCLOC                                     0504
*                     ,LEGAL);                                     0504
         L     @06,@PC00001+4                                      0504
         L     @06,FDTPTR+32(,@06)                                 0504
         LA    @06,TRACKVAL(,@06)                                  0504
         ST    @06,@AL00001                                        0504
         LA    @06,VTOCLOC                                         0504
         ST    @06,@AL00001+4                                      0504
         LA    @06,LEGAL                                           0504
         ST    @06,@AL00001+8                                      0504
         LA    @01,@AL00001                                        0504
         BAL   @14,DCVTPROC                                        0504
*                IF LEGAL = NO                                     0505
*                  THEN DO;                                        0505
*                                                                  0505
         TM    LEGAL,B'10000000'                                   0505
         BNZ   @RF00505                                            0505
*                    DARGSENT = MSGVTOCA;                          0507
         L     @06,DDSTRU                                          0507
         MVI   DARGSENT(@06),X'03'                                 0507
*                    DARGCNT = 1;                                  0508
         LA    @15,1                                               0508
         STH   @15,DARGCNT(,@06)                                   0508
*                    DARGINS (1) = 1;                              0509
         STH   @15,DARGINS(,@06)                                   0509
*                    DARGINL (1) = LENGTH (TRACKVAL);              0510
         MVC   DARGINL(2,@06),@CH00260                             0510
*                    DARGDTM (1) = ADDR (TRACKVAL);                0511
         L     @15,@PC00001+4                                      0511
         L     @01,FDTPTR+32(,@15)                                 0511
         LA    @15,TRACKVAL(,@01)                                  0511
         ST    @15,DARGDTM(,@06)                                   0511
*                    CALL ICKTPPR0 (GDTTBL                         0512
*                           ,PRTFILE                               0512
*                           ,DDSTRU);                              0512
         L     @06,@PC00001                                        0512
         ST    @06,@AL00001                                        0512
         LA    @15,@CF00094                                        0512
         ST    @15,@AL00001+4                                      0512
         LA    @15,DDSTRU                                          0512
         ST    @15,@AL00001+8                                      0512
         MVI   @AL00001+8,X'80'                                    0512
         L     @15,GDTPRT(,@06)                                    0512
         LA    @01,@AL00001                                        0512
         BALR  @14,@15                                             0512
*                    LASTCOND = LASTCC12;                          0513
         L     @06,@PC00001+8                                      0513
         MVC   LASTCOND(2,@06),@CH00265                            0513
*                    END;                                          0514
*                END;                                              0515
@RF00505 DS    0H                                                  0516
*/*          END-ELSE                                                */
*            END;                                                  0516
@RC00496 DS    0H                                                  0517
*/*      IF EXTENT IS NOT SPECIFIED                                  */
*        IF ADDR(EXTEN) = NULLPTR                                  0517
*/*        THEN SET EXTENT TO THE DEFAULT VALUE                      */
*          THEN DO;    VTOCEXT = DEFEXTEN; END;                    0517
@RC00490 L     @06,@PC00001+4                                      0517
         L     @06,FDTPTR+36(,@06)                                 0517
         LTR   @06,@06                                             0517
         BNZ   @RF00517                                            0517
         L     @06,INFOPTR+96                                      0519
         MVC   VTOCEXT(4),DEFEXTEN(@06)                            0519
*/*        ELSE                                                      */
*          ELSE DO;                                                0521
*                                                                  0521
         B     @RC00517                                            0521
@RF00517 DS    0H                                                  0522
*/*          IF MIMIC IS SPECIFIED AND DEVICE IS MSS                 */
*            IF (ADDR(MIMIC) ^= NULLPTR) & (ADDR(MSS) ^= NULLPTR)  0522
*/*            THEN FORCE EXTENT TO THE DEFAULT VALUE                */
*              THEN DO;    VTOCEXT = DEFEXTEN; END;                0522
         SLR   @06,@06                                             0522
         L     @15,@PC00001+4                                      0522
         C     @06,FDTPTR+88(,@15)                                 0522
         BE    @RF00522                                            0522
         C     @06,FDTPTR+92(,@15)                                 0522
         BE    @RF00522                                            0522
         L     @06,INFOPTR+96                                      0524
         MVC   VTOCEXT(4),DEFEXTEN(@06)                            0524
*/*            ELSE SET EXTENT AS SPECIFIED BY USER                  */
*              ELSE DO;    VTOCEXT = EXTENVAL; END;                0526
         B     @RC00522                                            0526
@RF00522 DS    0H                                                  0527
         L     @06,@PC00001+4                                      0527
         L     @06,FDTPTR+36(,@06)                                 0527
         MVC   VTOCEXT(4),EXTENVAL(@06)                            0527
*/*          END-ELSE                                                */
*            END;                                                  0529
@RC00522 DS    0H                                                  0530
*/*        COMPUTE THE VALUE OF LAST TRACK OF THE VTOC               */
*          VTOCRTAL = (VTOCLOCC * TRKSPCYL) + (VTOCLOCT -1);       0530
@RC00517 L     @06,INFOPTR+12                                      0530
         L     @06,TRKSPCYL(,@06)                                  0530
         MVC   @ZT00002+2(2),VTOCLOCC                              0530
         L     @01,@ZT00002                                        0530
         MR    @00,@06                                             0530
         LH    VTOCRTAL,VTOCLOCT                                   0530
         BCTR  VTOCRTAL,0                                          0530
         ALR   @01,VTOCRTAL                                        0530
         LR    VTOCRTAL,@01                                        0530
*          VTOCRTAH = VTOCEXT + VTOCRTAL - 1;                      0531
         LR    VTOCRTAH,VTOCRTAL                                   0531
         AL    VTOCRTAH,VTOCEXT                                    0531
         BCTR  VTOCRTAH,0                                          0531
*          VTOCHIC = VTOCRTAH/TRKSPCYL;                            0532
         LR    @00,VTOCRTAH                                        0532
         SRDA  @00,32                                              0532
         DR    @00,@06                                             0532
         STH   @01,VTOCHIC                                         0532
*          VTOCHIT = VTOCRTAH//TRKSPCYL;                           0533
         LR    @00,VTOCRTAH                                        0533
         SRDA  @00,32                                              0533
         DR    @00,@06                                             0533
         STH   @00,VTOCHIT                                         0533
*/*      END-THEN (NO SEVERE ERRORS)                                 */
*        END;                                                      0534
*/*  END-SUB-PROCEDURE CHECK_PARAMETERS                              */
*    END CHEKPARM;                                                 0535
*                                                                  0535
@EL00004 DS    0H                                                  0535
@EF00004 DS    0H                                                  0535
@ER00004 LM    @14,@12,@SA00004                                    0535
         BR    @14                                                 0535
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  EXALTRA                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  EXAMINE ALTERNATE TRACKS                     */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE EXAMINES THE ALTERNATE TRACKS FOR          */
*/*    MINIMAL INITIALIZATION OF THE PACK.                           */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0536
*                                                                  0536
*/*  SUB-PROCEDURE EXAMINE_ALTERNATE_TRACKS                          */
*    EXALTRA:                                                      0536
*      PROCEDURE;                                                  0536
EXALTRA  STM   @14,@12,@SA00005                                    0536
*    OLDERID2 = NEWERID2;                                          0537
         L     @06,@PC00001                                        0537
         L     @06,GDTTR2(,@06)                                    0537
         MVC   @TS00001(95),NEWERID2(@06)                          0537
         MVC   OLDERID2(95,@06),@TS00001                           0537
*    NEWID2 =  'INEA';                                             0538
         MVC   NEWID2(4,@06),@CC00794                              0538
*    CTRADDR = FIRSTAL;                                            0539
         L     @06,INFOPTR+48                                      0539
         MVC   CTRADDR(4),FIRSTAL(@06)                             0539
*    TRACKTYP = ALTTRACK;                                          0540
         NI    TRACKTYP,B'01111111'                                0540
*/*  DO-UNTIL ALL ALTERNATE TRACKS ARE EXHAUSTED                     */
*    DO UNTIL (CTRADDR > FINALT);                                  0541
*                                                                  0541
@DL00541 DS    0H                                                  0542
*/*    SET FLAG TO INDICATE TRACK CURRENTLY RECOVERABLE              */
*      RCVRFLAG = RECOVER;                                         0542
         OI    RCVRFLAG,B'10000000'                                0542
*/*    OBTAIN_TRACK_STATUS                                           */
*      CALL OBTTRST (CTRADDR                                       0543
*                   ,DFLAGC                                        0543
*                   ,RZCCHH                                        0543
*                   ,TRACKTYP);                                    0543
         LA    @06,CTRADDR                                         0543
         ST    @06,@AL00001                                        0543
         LA    @06,DFLAGC                                          0543
         ST    @06,@AL00001+4                                      0543
         LA    @06,RZCCHH                                          0543
         ST    @06,@AL00001+8                                      0543
         LA    @06,TRACKTYP                                        0543
         ST    @06,@AL00001+12                                     0543
         LA    @01,@AL00001                                        0543
         BAL   @14,OBTTRST                                         0543
*/*    IF NO SEVERE ERRORS AND TRACK RECOVERABLE                     */
*      IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)             0544
*/*      THEN                                                        */
*        THEN DO;                                                  0544
*                                                                  0544
         L     @06,@PC00001+8                                      0544
         LH    @06,LASTCOND(,@06)                                  0544
         CH    @06,@CH00265                                        0544
         BNL   @RF00544                                            0544
         TM    RCVRFLAG,B'10000000'                                0544
         BNO   @RF00544                                            0544
*/*        IF DEFECT-FLAG IS FOUND TO BE SET                         */
*          IF DFLAGC = DEFECTIV                                    0546
*/*          THEN                                                    */
*            THEN DO;                                              0546
*                                                                  0546
         TM    DFLAGC,B'10000000'                                  0546
         BNO   @RF00546                                            0546
*/*            DECREMENT COUNT OF AVAILABLE ALTERNATE TRKS(ALTCOUNT) */
*              ALTCOUNT = ALTCOUNT - 1;                            0548
         L     @06,ALTCOUNT                                        0548
         BCTR  @06,0                                               0548
         ST    @06,ALTCOUNT                                        0548
*/*            ISSUE_BUILD_PACK_MAP                                  */
*              PACKDEF  = DEFECTIV;                                0549
         OI    PACKDEF,B'10000000'                                 0549
*              PACKCHEK = NODEFECT;                                0550
         NI    PACKCHEK,B'01111111'                                0550
*              PACKRCVR = RCVRYES;                                 0551
         NI    PACKRCVR,B'01111111'                                0551
*              PACKTRAK = CTRADDR;                                 0552
         MVC   PACKTRAK(4),CTRADDR                                 0552
*              PACKTRK = ALTTRACK;                                 0553
         NI    PACKTRK,B'01111111'                                 0553
*              PACKASC = RZCCHH;                                   0554
         MVC   PACKASC(4),RZCCHH                                   0554
*              CALL BILDPACK;                                      0555
         BAL   @14,BILDPACK                                        0555
*/*            IF TRACK IS ASSOCIATED WITH A PRIMARY                 */
*              IF (RZCCHHC <= FINPRIC) & (RZCCHHT <= FINPRIT)      0556
*               & (RZCCHH >= 0)                                    0556
*/*              THEN                                                */
*                THEN DO;                                          0556
*                                                                  0556
         L     @06,INFOPTR+72                                      0556
         CLC   RZCCHHC(2),FINPRIC(@06)                             0556
         BH    @RF00556                                            0556
         CLC   RZCCHHT(2),FINPRIT(@06)                             0556
         BH    @RF00556                                            0556
         CLC   RZCCHH(4),@CF00094                                  0556
         BL    @RF00556                                            0556
*/*                OBTAIN_TRACK_STATUS (OF THE PRIMARY)              */
*                  CALL OBTTRST (RZCCHH                            0558
*                               ,DFLAGA                            0558
*                               ,RZACCHH                           0558
*                               ,PRITRACK);                        0558
         LA    @06,RZCCHH                                          0558
         ST    @06,@AL00001                                        0558
         LA    @06,DFLAGA                                          0558
         ST    @06,@AL00001+4                                      0558
         LA    @06,RZACCHH                                         0558
         ST    @06,@AL00001+8                                      0558
         LA    @06,@CB00466                                        0558
         ST    @06,@AL00001+12                                     0558
         LA    @01,@AL00001                                        0558
         BAL   @14,OBTTRST                                         0558
*/*                IF NO SEVERE ERRORS AND TRACK RECOVERABLE         */
*                  IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER) 0559
*/*                  THEN                                            */
*                    THEN DO;                                      0559
*                                                                  0559
         L     @06,@PC00001+8                                      0559
         LH    @06,LASTCOND(,@06)                                  0559
         CH    @06,@CH00265                                        0559
         BNL   @RF00559                                            0559
         TM    RCVRFLAG,B'10000000'                                0559
         BNO   @RF00559                                            0559
*/*                    IF PRIMARY IS ASSOCIATED WITH ALTERNATE       */
*                      IF (RZACCHH = CTRADDR)                      0561
*/*                      THEN                                        */
*                        THEN DO;                                  0561
*                                                                  0561
         CLC   RZACCHH(4),CTRADDR                                  0561
         BNE   @RF00561                                            0561
*/*                        IF DEFECT-FLAG OF THE PRIMARY IS SET      */
*                          IF DFLAGA = DEFECTIV                    0563
*/*                          THEN                                    */
*                            THEN DO;                              0563
         TM    DFLAGA,B'10000000'                                  0563
         BNO   @RF00563                                            0563
*/*                            VALIDATE_HOME-ADDRESS (OF PRIMARY)    */
*                              CALL VALHOME                        0565
*                                   (RZCCHH                        0565
*                                   ,DFLAGA                        0565
*                                   ,PRITRACK);                    0565
         LA    @06,RZCCHH                                          0565
         ST    @06,@AL00001                                        0565
         LA    @06,DFLAGA                                          0565
         ST    @06,@AL00001+4                                      0565
         LA    @06,@CB00466                                        0565
         ST    @06,@AL00001+8                                      0565
         LA    @01,@AL00001                                        0565
         BAL   @14,VALHOME                                         0565
*/*                            IF NO SEVERE ERRORS                   */
*                              IF LASTCOND < LASTCC12              0566
*/*                              THEN                                */
*                                THEN DO;                          0566
         L     @06,@PC00001+8                                      0566
         LH    @06,LASTCOND(,@06)                                  0566
         CH    @06,@CH00265                                        0566
         BNL   @RF00566                                            0566
*/*                                ISSUE_RE-ASSIGN_ALTERNATE_TRACK   */
*                                  CALL RASGNALT;                  0568
         BAL   @14,RASGNALT                                        0568
*/*                                IF NEW ALTERNATE IS BEYOND OLD    */
*                                  IF ALTRACK > CTRADDR            0569
*/*                                  THEN INCREMENT COUNT OF         */
*/*                                   AVAILABLE ALTERNATE TRACKS     */
*/*                                   AS IT WILL BE DECREMENTED LATER*/
*                                    THEN DO;                      0569
         CLC   ALTRACK(4),CTRADDR                                  0569
         BNH   @RF00569                                            0569
*                                      ALTCOUNT = ALTCOUNT + 1;    0571
         LA    @06,1                                               0571
         AL    @06,ALTCOUNT                                        0571
         ST    @06,ALTCOUNT                                        0571
*                                      END;                        0572
*/*                                END-THEN                          */
*                                  END;                            0573
*/*                            END-THEN                              */
*                              END;                                0574
*/*                          ELSE                                    */
*                            ELSE DO;                              0575
*                                                                  0575
         B     @RC00563                                            0575
@RF00563 DS    0H                                                  0576
*/*                            ISSUE ERROR MESSAGE (MSGMEDAL)        */
*                              DARGSENT = MSGMEDAL;                0576
         L     @06,DDSTRU                                          0576
         MVI   DARGSENT(@06),X'08'                                 0576
*                              DARGCNT = 8;                        0577
         MVC   DARGCNT(2,@06),@CH00161                             0577
*                              IF DFLAGA = DEFECTIV                0578
*                                THEN DO;                          0578
         TM    DFLAGA,B'10000000'                                  0578
         BNO   @RF00578                                            0578
*                                  DARGINS (1) = 1;                0580
         LA    @15,1                                               0580
         STH   @15,DARGINS(,@06)                                   0580
*                                  DARGINL (1) = 1;                0581
         STH   @15,DARGINL(,@06)                                   0581
*                                  DARGDTM (1) = ADDR ('D');       0582
         LA    @15,@CC00799                                        0582
         ST    @15,DARGDTM(,@06)                                   0582
*                                  END;                            0583
*                                ELSE DO;                          0584
         B     @RC00578                                            0584
@RF00578 DS    0H                                                  0585
*                                  DARGINS (1) = 1;                0585
         LA    @06,1                                               0585
         L     @15,DDSTRU                                          0585
         STH   @06,DARGINS(,@15)                                   0585
*                                  DARGINL (1) = 1;                0586
         STH   @06,DARGINL(,@15)                                   0586
*                                  DARGDTM (1) = ADDR ('N');       0587
         LA    @06,@CC00800                                        0587
         ST    @06,DARGDTM(,@15)                                   0587
*                                  END;                            0588
*                              DARGINS (2) = 2;                    0589
@RC00578 LA    @06,2                                               0589
         L     @15,DDSTRU                                          0589
         STH   @06,DARGINS+8(,@15)                                 0589
*                              DARGINL (2) = LENGTH (RZCCHHC);     0590
         STH   @06,DARGINL+8(,@15)                                 0590
*                              DARGDTM (2) = ADDR (RZCCHHC);       0591
         LA    @14,RZCCHHC                                         0591
         ST    @14,DARGDTM+8(,@15)                                 0591
*                              DARGINS (3) = 3;                    0592
         MVC   DARGINS+16(2,@15),@CH00136                          0592
*                              DARGINL (3) = LENGTH (RZCCHHT);     0593
         STH   @06,DARGINL+16(,@15)                                0593
*                              DARGDTM (3) = ADDR (RZCCHHT);       0594
         LA    @14,RZCCHHT                                         0594
         ST    @14,DARGDTM+16(,@15)                                0594
*                              DARGINS (4) = 4;                    0595
         MVC   DARGINS+24(2,@15),@CH00044                          0595
*                              DARGINL (4) = LENGTH (RZACCHHC);    0596
         STH   @06,DARGINL+24(,@15)                                0596
*                              DARGDTM (4) = ADDR (RZACCHHC);      0597
         LA    @14,RZACCHHC                                        0597
         ST    @14,DARGDTM+24(,@15)                                0597
*                              DARGINS (5) = 5;                    0598
         MVC   DARGINS+32(2,@15),@CH00255                          0598
*                              DARGINL (5) = LENGTH (RZACCHHT);    0599
         STH   @06,DARGINL+32(,@15)                                0599
*                              DARGDTM (5) = ADDR (RZACCHHT);      0600
         LA    @06,RZACCHHT                                        0600
         ST    @06,DARGDTM+32(,@15)                                0600
*                              IF DFLAGC = DEFECTIV                0601
*                                THEN DO;                          0601
         TM    DFLAGC,B'10000000'                                  0601
         BNO   @RF00601                                            0601
*                                  DARGINS (6) = 6;                0603
         MVC   DARGINS+40(2,@15),@CH00119                          0603
*                                  DARGINL (6) = 1;                0604
         MVC   DARGINL+40(2,@15),@CH00165                          0604
*                                  DARGDTM (6) = ADDR ('D');       0605
         LA    @06,@CC00799                                        0605
         ST    @06,DARGDTM+40(,@15)                                0605
*                                  END;                            0606
*                                ELSE DO;                          0607
         B     @RC00601                                            0607
@RF00601 DS    0H                                                  0608
*                                  DARGINS (6) = 6;                0608
         L     @06,DDSTRU                                          0608
         MVC   DARGINS+40(2,@06),@CH00119                          0608
*                                  DARGINL (6) = 1;                0609
         MVC   DARGINL+40(2,@06),@CH00165                          0609
*                                  DARGDTM (6) = ADDR ('N');       0610
         LA    @15,@CC00800                                        0610
         ST    @15,DARGDTM+40(,@06)                                0610
*                                  END;                            0611
*                              DARGINS (7) = 7;                    0612
@RC00601 L     @06,DDSTRU                                          0612
         MVC   DARGINS+48(2,@06),@CH00185                          0612
*                              DARGINL (7) = LENGTH (CTRADDRC);    0613
         LA    @15,2                                               0613
         STH   @15,DARGINL+48(,@06)                                0613
*                              DARGDTM (7) = ADDR (CTRADDRC);      0614
         LA    @14,CTRADDRC                                        0614
         ST    @14,DARGDTM+48(,@06)                                0614
*                              DARGINS (8) = 8;                    0615
         MVC   DARGINS+56(2,@06),@CH00161                          0615
*                              DARGINL (8) = LENGTH (CTRADDRT);    0616
         STH   @15,DARGINL+56(,@06)                                0616
*                              DARGDTM (8) = ADDR (CTRADDRT);      0617
         LA    @15,CTRADDRT                                        0617
         ST    @15,DARGDTM+56(,@06)                                0617
*                              CALL ICKTPPR0 (GDTTBL               0618
*                                     ,PRTFILE                     0618
*                                     ,DDSTRU);                    0618
         L     @06,@PC00001                                        0618
         ST    @06,@AL00001                                        0618
         LA    @15,@CF00094                                        0618
         ST    @15,@AL00001+4                                      0618
         LA    @15,DDSTRU                                          0618
         ST    @15,@AL00001+8                                      0618
         MVI   @AL00001+8,X'80'                                    0618
         L     @15,GDTPRT(,@06)                                    0618
         LA    @01,@AL00001                                        0618
         BALR  @14,@15                                             0618
*/*                            INDICATE AN ERROR                     */
*                              LASTCOND = MAX (LASTCOND,LASTCC08); 0619
         L     @06,@PC00001+8                                      0619
         LH    @15,LASTCOND(,@06)                                  0619
         LA    @14,8                                               0619
         CR    @15,@14                                             0619
         BNL   *+6
         LR    @15,@14                                             0619
         STH   @15,LASTCOND(,@06)                                  0619
*/*                            IF THE TRACK IS A CRITICAL TRACK      */
*                              IF (RZCCHH = 0)                    0620
*                               (RZCCHH >= VTOCLOC & RZCCHH <= VTOCHI)
*/*                              THEN                                */
*                                THEN DO;                          0620
         L     @06,RZCCHH                                          0620
         LTR   @06,@06                                             0620
         BZ    @RT00620                                            0620
         CL    @06,VTOCLOC                                         0620
         BL    @RF00620                                            0620
         CL    @06,VTOCHI                                          0620
         BH    @RF00620                                            0620
@RT00620 DS    0H                                                  0621
*/*                                ISSUE A SEVERE ERROR MESSAGE      */
*                                  DARGSENT = MSGMINV;             0622
         L     @06,DDSTRU                                          0622
         MVI   DARGSENT(@06),X'0C'                                 0622
*                                  DARGCNT = 2;                    0623
         LA    @15,2                                               0623
         STH   @15,DARGCNT(,@06)                                   0623
*                                  DARGINS (1) = 1;                0624
         MVC   DARGINS(2,@06),@CH00165                             0624
*                                  DARGINL (1) = LENGTH (RZCCHHC); 0625
         STH   @15,DARGINL(,@06)                                   0625
*                                  DARGDTM (1) = ADDR (RZCCHHC);   0626
         LA    @14,RZCCHHC                                         0626
         ST    @14,DARGDTM(,@06)                                   0626
*                                  DARGINS (2) = 2;                0627
         STH   @15,DARGINS+8(,@06)                                 0627
*                                  DARGINL (2) = LENGTH (RZCCHHT); 0628
         STH   @15,DARGINL+8(,@06)                                 0628
*                                  DARGDTM (2) = ADDR (RZCCHHT);   0629
         LA    @15,RZCCHHT                                         0629
         ST    @15,DARGDTM+8(,@06)                                 0629
*                                  CALL ICKTPPR0 (GDTTBL           0630
*                                         ,PRTFILE                 0630
*                                         ,DDSTRU);                0630
         L     @06,@PC00001                                        0630
         ST    @06,@AL00001                                        0630
         LA    @15,@CF00094                                        0630
         ST    @15,@AL00001+4                                      0630
         LA    @15,DDSTRU                                          0630
         ST    @15,@AL00001+8                                      0630
         MVI   @AL00001+8,X'80'                                    0630
         L     @15,GDTPRT(,@06)                                    0630
         LA    @01,@AL00001                                        0630
         BALR  @14,@15                                             0630
*/*                                INDICATE A SEVERE ERROR           */
*                                  LASTCOND = LASTCC12;            0631
         L     @06,@PC00001+8                                      0631
         MVC   LASTCOND(2,@06),@CH00265                            0631
*/*                                END-THEN                          */
*                                  END;                            0632
*/*                            END-ELSE                              */
*                              END;                                0633
*/*                        END-THEN (PRIMARY ASSOCIATED WITH ALT)    */
*                          END;                                    0634
*/*                      ELSE                                        */
*                        ELSE DO;                                  0635
*                                                                  0635
*                                                                  0635
*                                                                  0635
         B     @RC00561                                            0635
@RF00561 DS    0H                                                  0636
*/*                        IF PRIMARY IS INCORRECTLY ASSOCIATED OR   */
*/*                         FLAGGED DEFECTIVE                        */
*                          IF (RZACCHH ^= RZCCHH)  (DFLAGA = DEFECTIV)
*/*                          THEN                                    */
*                            THEN DO;                              0636
*                                                                  0636
         CLC   RZACCHH(4),RZCCHH                                   0636
         BNE   @RT00636                                            0636
         TM    DFLAGA,B'10000000'                                  0636
         BNO   @RF00636                                            0636
@RT00636 DS    0H                                                  0637
*/*                            ISSUE ERROR MESSAGE (MSGMEDAL)        */
*                              DARGSENT = MSGMEDAL;                0638
         L     @06,DDSTRU                                          0638
         MVI   DARGSENT(@06),X'08'                                 0638
*                              DARGCNT = 8;                        0639
         MVC   DARGCNT(2,@06),@CH00161                             0639
*                              IF DFLAGA = DEFECTIV                0640
*                                THEN DO;                          0640
         TM    DFLAGA,B'10000000'                                  0640
         BNO   @RF00640                                            0640
*                                  DARGINS (1) = 1;                0642
         LA    @15,1                                               0642
         STH   @15,DARGINS(,@06)                                   0642
*                                  DARGINL (1) = 1;                0643
         STH   @15,DARGINL(,@06)                                   0643
*                                  DARGDTM (1) = ADDR ('D');       0644
         LA    @15,@CC00799                                        0644
         ST    @15,DARGDTM(,@06)                                   0644
*                                  END;                            0645
*                                ELSE DO;                          0646
         B     @RC00640                                            0646
@RF00640 DS    0H                                                  0647
*                                  DARGINS (1) = 1;                0647
         LA    @06,1                                               0647
         L     @15,DDSTRU                                          0647
         STH   @06,DARGINS(,@15)                                   0647
*                                  DARGINL (1) = 1;                0648
         STH   @06,DARGINL(,@15)                                   0648
*                                  DARGDTM (1) = ADDR ('N');       0649
         LA    @06,@CC00800                                        0649
         ST    @06,DARGDTM(,@15)                                   0649
*                                  END;                            0650
*                              DARGINS (2) = 2;                    0651
@RC00640 LA    @06,2                                               0651
         L     @15,DDSTRU                                          0651
         STH   @06,DARGINS+8(,@15)                                 0651
*                              DARGINL (2) = LENGTH (RZCCHHC);     0652
         STH   @06,DARGINL+8(,@15)                                 0652
*                              DARGDTM (2) = ADDR (RZCCHHC);       0653
         LA    @14,RZCCHHC                                         0653
         ST    @14,DARGDTM+8(,@15)                                 0653
*                              DARGINS (3) = 3;                    0654
         MVC   DARGINS+16(2,@15),@CH00136                          0654
*                              DARGINL (3) = LENGTH (RZCCHHT);     0655
         STH   @06,DARGINL+16(,@15)                                0655
*                              DARGDTM (3) = ADDR (RZCCHHT);       0656
         LA    @14,RZCCHHT                                         0656
         ST    @14,DARGDTM+16(,@15)                                0656
*                              DARGINS (4) = 4;                    0657
         MVC   DARGINS+24(2,@15),@CH00044                          0657
*                              DARGINL (4) = LENGTH (RZACCHHC);    0658
         STH   @06,DARGINL+24(,@15)                                0658
*                              DARGDTM (4) = ADDR (RZACCHHC);      0659
         LA    @14,RZACCHHC                                        0659
         ST    @14,DARGDTM+24(,@15)                                0659
*                              DARGINS (5) = 5;                    0660
         MVC   DARGINS+32(2,@15),@CH00255                          0660
*                              DARGINL (5) = LENGTH (RZACCHHT);    0661
         STH   @06,DARGINL+32(,@15)                                0661
*                              DARGDTM (5) = ADDR (RZACCHHT);      0662
         LA    @06,RZACCHHT                                        0662
         ST    @06,DARGDTM+32(,@15)                                0662
*                              IF DFLAGC = DEFECTIV                0663
*                                THEN DO;                          0663
         TM    DFLAGC,B'10000000'                                  0663
         BNO   @RF00663                                            0663
*                                  DARGINS (6) = 6;                0665
         MVC   DARGINS+40(2,@15),@CH00119                          0665
*                                  DARGINL (6) = 1;                0666
         MVC   DARGINL+40(2,@15),@CH00165                          0666
*                                  DARGDTM (6) = ADDR ('D');       0667
         LA    @06,@CC00799                                        0667
         ST    @06,DARGDTM+40(,@15)                                0667
*                                  END;                            0668
*                                ELSE DO;                          0669
         B     @RC00663                                            0669
@RF00663 DS    0H                                                  0670
*                                  DARGINS (6) = 6;                0670
         L     @06,DDSTRU                                          0670
         MVC   DARGINS+40(2,@06),@CH00119                          0670
*                                  DARGINL (6) = 1;                0671
         MVC   DARGINL+40(2,@06),@CH00165                          0671
*                                  DARGDTM (6) = ADDR ('N');       0672
         LA    @15,@CC00800                                        0672
         ST    @15,DARGDTM+40(,@06)                                0672
*                                  END;                            0673
*                              DARGINS (7) = 7;                    0674
@RC00663 L     @06,DDSTRU                                          0674
         MVC   DARGINS+48(2,@06),@CH00185                          0674
*                              DARGINL (7) = LENGTH (CTRADDRC);    0675
         LA    @15,2                                               0675
         STH   @15,DARGINL+48(,@06)                                0675
*                              DARGDTM (7) = ADDR (CTRADDRC);      0676
         LA    @14,CTRADDRC                                        0676
         ST    @14,DARGDTM+48(,@06)                                0676
*                              DARGINS (8) = 8;                    0677
         MVC   DARGINS+56(2,@06),@CH00161                          0677
*                              DARGINL (8) = LENGTH (CTRADDRT);    0678
         STH   @15,DARGINL+56(,@06)                                0678
*                              DARGDTM (8) = ADDR (CTRADDRT);      0679
         LA    @15,CTRADDRT                                        0679
         ST    @15,DARGDTM+56(,@06)                                0679
*                              CALL ICKTPPR0 (GDTTBL               0680
*                                     ,PRTFILE                     0680
*                                     ,DDSTRU);                    0680
         L     @06,@PC00001                                        0680
         ST    @06,@AL00001                                        0680
         LA    @15,@CF00094                                        0680
         ST    @15,@AL00001+4                                      0680
         LA    @15,DDSTRU                                          0680
         ST    @15,@AL00001+8                                      0680
         MVI   @AL00001+8,X'80'                                    0680
         L     @15,GDTPRT(,@06)                                    0680
         LA    @01,@AL00001                                        0680
         BALR  @14,@15                                             0680
*/*                            INDICATE AN ERROR                     */
*                              LASTCOND = MAX(LASTCOND,LASTCC08);  0681
         L     @06,@PC00001+8                                      0681
         LH    @15,LASTCOND(,@06)                                  0681
         LA    @14,8                                               0681
         CR    @15,@14                                             0681
         BNL   *+6
         LR    @15,@14                                             0681
         STH   @15,LASTCOND(,@06)                                  0681
*/*                            IF THE TRACK IS A CRITICAL TRACK      */
*                              IF (RZCCHH = 0)                    0682
*                               (RZCCHH >= VTOCLOC & RZCCHH <= VTOCHI)
*/*                              THEN                                */
*                                THEN DO;                          0682
         L     @06,RZCCHH                                          0682
         LTR   @06,@06                                             0682
         BZ    @RT00682                                            0682
         CL    @06,VTOCLOC                                         0682
         BL    @RF00682                                            0682
         CL    @06,VTOCHI                                          0682
         BH    @RF00682                                            0682
@RT00682 DS    0H                                                  0683
*/*                                ISSUE A SEVERE ERROR MESSAGE      */
*                                  DARGSENT = MSGMINV;             0684
         L     @06,DDSTRU                                          0684
         MVI   DARGSENT(@06),X'0C'                                 0684
*                                  DARGCNT = 2;                    0685
         LA    @15,2                                               0685
         STH   @15,DARGCNT(,@06)                                   0685
*                                  DARGINS (1) = 1;                0686
         MVC   DARGINS(2,@06),@CH00165                             0686
*                                  DARGINL (1) = LENGTH (RZCCHHC); 0687
         STH   @15,DARGINL(,@06)                                   0687
*                                  DARGDTM (1) = ADDR (RZCCHHC);   0688
         LA    @14,RZCCHHC                                         0688
         ST    @14,DARGDTM(,@06)                                   0688
*                                  DARGINS (2) = 2;                0689
         STH   @15,DARGINS+8(,@06)                                 0689
*                                  DARGINL (2) = LENGTH (RZCCHHT); 0690
         STH   @15,DARGINL+8(,@06)                                 0690
*                                  DARGDTM (2) = ADDR (RZCCHHT);   0691
         LA    @15,RZCCHHT                                         0691
         ST    @15,DARGDTM+8(,@06)                                 0691
*                                  CALL ICKTPPR0 (GDTTBL           0692
*                                         ,PRTFILE                 0692
*                                         ,DDSTRU);                0692
         L     @06,@PC00001                                        0692
         ST    @06,@AL00001                                        0692
         LA    @15,@CF00094                                        0692
         ST    @15,@AL00001+4                                      0692
         LA    @15,DDSTRU                                          0692
         ST    @15,@AL00001+8                                      0692
         MVI   @AL00001+8,X'80'                                    0692
         L     @15,GDTPRT(,@06)                                    0692
         LA    @01,@AL00001                                        0692
         BALR  @14,@15                                             0692
*/*                                INDICATE A SEVERE ERROR           */
*                                  LASTCOND = LASTCC12;            0693
         L     @06,@PC00001+8                                      0693
         MVC   LASTCOND(2,@06),@CH00265                            0693
*/*                                END-THEN                          */
*                                  END;                            0694
*/*                            END-THEN                              */
*                              END;                                0695
*/*                        END-ELSE                                  */
*                          END;                                    0696
*/*                    END-THEN (NO SEVERE ERRORS)                   */
*                      END;                                        0697
*/*                END-THEN (TRACK ASSOCIATED WITH PRIMARY)          */
*                  END;                                            0698
*/*            END-THEN (DEFECT-FLAG FOUND TO BE SET)                */
*              END;                                                0699
*/*          ELSE (DEFECT FLAG FOUND NOT TO BE SET)                  */
*            ELSE DO;                                              0700
*                                                                  0700
         B     @RC00546                                            0700
@RF00546 DS    0H                                                  0701
*/*            IF TRACK IS ASSOCIATED WITH PRIMARY                   */
*              IF (RZCCHHC <= FINPRIC) & (RZCCHHT <= FINPRIT)      0701
*               & (RZCCHH >= 0)                                    0701
*/*              THEN                                                */
*                THEN DO;                                          0701
*                                                                  0701
         L     @06,INFOPTR+72                                      0701
         CLC   RZCCHHC(2),FINPRIC(@06)                             0701
         BH    @RF00701                                            0701
         CLC   RZCCHHT(2),FINPRIT(@06)                             0701
         BH    @RF00701                                            0701
         CLC   RZCCHH(4),@CF00094                                  0701
         BL    @RF00701                                            0701
*/*                OBTAIN_TRACK_STATUS ( FOR THE PRIMARY)            */
*                  CALL OBTTRST (RZCCHH                            0703
*                               ,DFLAGA                            0703
*                               ,RZACCHH                           0703
*                               ,PRITRACK);                        0703
         LA    @06,RZCCHH                                          0703
         ST    @06,@AL00001                                        0703
         LA    @06,DFLAGA                                          0703
         ST    @06,@AL00001+4                                      0703
         LA    @06,RZACCHH                                         0703
         ST    @06,@AL00001+8                                      0703
         LA    @06,@CB00466                                        0703
         ST    @06,@AL00001+12                                     0703
         LA    @01,@AL00001                                        0703
         BAL   @14,OBTTRST                                         0703
*/*                IF NO SEVERE ERRORS AND TRACK RECOVERABLE         */
*                  IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER) 0704
*/*                  THEN                                            */
*                    THEN DO;                                      0704
*                                                                  0704
         L     @06,@PC00001+8                                      0704
         LH    @06,LASTCOND(,@06)                                  0704
         CH    @06,@CH00265                                        0704
         BNL   @RF00704                                            0704
         TM    RCVRFLAG,B'10000000'                                0704
         BNO   @RF00704                                            0704
*/*                    IF PRIMARY IS ASSOCIATED WITH ALTERNATE       */
*                      IF (RZACCHH = CTRADDR)                      0706
*/*                      THEN                                        */
*                        THEN DO;                                  0706
*                                                                  0706
         L     @06,CTRADDR                                         0706
         CL    @06,RZACCHH                                         0706
         BNE   @RF00706                                            0706
*/*                        IF DEFECT-FLAG OF THE PRIMARY IS SET      */
*                          IF DFLAGA = DEFECTIV                    0708
*/*                          THEN                                    */
*                            THEN DO;                              0708
         TM    DFLAGA,B'10000000'                                  0708
         BNO   @RF00708                                            0708
*/*                            IF ALTERNATE TRACK BEYOND THE NEXT    */
*/*                             AVAILABLE ALTERNATE TRACK WHEN ONE   */
*/*                             WAS FOUND                            */
*                              IF CTRADDR > ALTPTR &               0710
*                               AVAILCNT > 0                       0710
*/*                              THEN                                */
*                                THEN DO;                          0710
         CL    @06,ALTPTR                                          0710
         BNH   @RF00710                                            0710
         L     @06,AVAILCNT                                        0710
         LTR   @06,@06                                             0710
         BNP   @RF00710                                            0710
*/*                                ISSUE_RE-ASSIGN_ALTERNATE_TRACK   */
*                                  CALL RASGNALT;                  0712
         BAL   @14,RASGNALT                                        0712
*/*                                END-THEN                          */
*                                  END;                            0713
*/*                              ELSE                                */
*                                ELSE DO;                          0714
         B     @RC00710                                            0714
@RF00710 DS    0H                                                  0715
*/*                                DECREMENT COUNT OF AVAILABLE      */
*/*                                 ALTERNATE TRACKS                 */
*                                  ALTCOUNT = ALTCOUNT - 1;        0715
         L     @06,ALTCOUNT                                        0715
         BCTR  @06,0                                               0715
         ST    @06,ALTCOUNT                                        0715
*/*                                IF ALTERNATE TRACK AT NEXT        */
*/*                                 AVAILABLE ALTERNATE TRACK        */
*                                  IF CTRADDR = ALTPTR             0716
*/*                                  THEN (POINT TO NEXT TRACK)      */
*                                    THEN DO;                      0716
         CLC   CTRADDR(4),ALTPTR                                   0716
         BNE   @RF00716                                            0716
*                                      IF ALTPTRT = TRKSPCYL - 1   0718
*                                        THEN DO;                  0718
         L     @06,INFOPTR+12                                      0718
         L     @06,TRKSPCYL(,@06)                                  0718
         BCTR  @06,0                                               0718
         MVC   @ZT00002+2(2),ALTPTRT                               0718
         C     @06,@ZT00002                                        0718
         BNE   @RF00718                                            0718
*                                          ALTPTRC = ALTPTRC + 1;  0720
         MVC   @ZT00002+2(2),ALTPTRC                               0720
         L     @06,@ZT00002                                        0720
         LA    @06,1(,@06)                                         0720
         STH   @06,ALTPTRC                                         0720
*                                          ALTPTRT = 0;            0721
         SLR   @06,@06                                             0721
         STH   @06,ALTPTRT                                         0721
*                                          END;                    0722
*                                        ELSE DO;                  0723
         B     @RC00718                                            0723
@RF00718 DS    0H                                                  0724
*                                          ALTPTRT = ALTPTRT + 1;  0724
         MVC   @ZT00002+2(2),ALTPTRT                               0724
         L     @06,@ZT00002                                        0724
         LA    @06,1(,@06)                                         0724
         STH   @06,ALTPTRT                                         0724
*                                          END;                    0725
*/*                                    END-THEN                      */
*                                      END;                        0726
*/*                                END-ELSE                          */
*                                  END;                            0727
*/*                            END-THEN                              */
*                              END;                                0728
*/*                          ELSE                                    */
*                            ELSE DO;                              0729
*                                                                  0729
         B     @RC00708                                            0729
@RF00708 DS    0H                                                  0730
*/*                            VALIDATE_HOME-ADDRESS                 */
*                              CALL VALHOME                        0730
*                                   (CTRADDR                       0730
*                                   ,DFLAGC                        0730
*                                   ,TRACKTYP);                    0730
         LA    @06,CTRADDR                                         0730
         ST    @06,@AL00001                                        0730
         LA    @06,DFLAGC                                          0730
         ST    @06,@AL00001+4                                      0730
         LA    @06,TRACKTYP                                        0730
         ST    @06,@AL00001+8                                      0730
         LA    @01,@AL00001                                        0730
         BAL   @14,VALHOME                                         0730
*/*                            IF NO SEVERE ERRORS AND DEFECT FLAG   */
*/*                             NOT SET AND TRACK RECOVERABLE        */
*                              IF LASTCOND < LASTCC12 &            0731
*                               DFLAGC = NODEFECT &                0731
*                               RCVRFLAG = RECOVER                 0731
*/*                              THEN DISSOCIATE_TRACK               */
*                                THEN DO;    CALL DISTRACK; END;   0731
         L     @06,@PC00001+8                                      0731
         LH    @06,LASTCOND(,@06)                                  0731
         CH    @06,@CH00265                                        0731
         BNL   @RF00731                                            0731
         TM    DFLAGC,B'10000000'                                  0731
         BNZ   @RF00731                                            0731
         TM    RCVRFLAG,B'10000000'                                0731
         BNO   @RF00731                                            0731
         BAL   @14,DISTRACK                                        0733
*/*                              ELSE                                */
*                                ELSE DO;                          0735
         B     @RC00731                                            0735
@RF00731 DS    0H                                                  0736
*/*                                IF NO SEVERE ERRORS AND           */
*/*                                 DEFECT-FLAG SET                  */
*                                  IF LASTCOND < LASTCC12 &        0736
*                                   DFLAGC = DEFECTIV              0736
*/*                                  THEN                            */
*                                    THEN DO;                      0736
         L     @06,@PC00001+8                                      0736
         LH    @06,LASTCOND(,@06)                                  0736
         CH    @06,@CH00265                                        0736
         BNL   @RF00736                                            0736
         TM    DFLAGC,B'10000000'                                  0736
         BNO   @RF00736                                            0736
*/*                                    DECREMENT NUMBER OF           */
*/*                                     AVAILABLE ALTERNATE TRACKS   */
*                                      ALTCOUNT = ALTCOUNT - 1;    0738
         L     @06,ALTCOUNT                                        0738
         BCTR  @06,0                                               0738
         ST    @06,ALTCOUNT                                        0738
*/*                                    ISSUE_BUILD_PACK_MAP          */
*                                      PACKDEF = DEFECTIV;         0739
         OI    PACKDEF,B'10000000'                                 0739
*                                      PACKCHEK = NODEFECT;        0740
         NI    PACKCHEK,B'01111111'                                0740
*                                      PACKRCVR = RCVRYES;         0741
         NI    PACKRCVR,B'01111111'                                0741
*                                      PACKTRAK = CTRADDR;         0742
         L     @06,CTRADDR                                         0742
         ST    @06,PACKTRAK                                        0742
*                                      PACKTRK = ALTTRACK;         0743
         NI    PACKTRK,B'01111111'                                 0743
*                                      PACKASC = CTRADDR;          0744
         ST    @06,PACKASC                                         0744
*                                      CALL BILDPACK;              0745
         BAL   @14,BILDPACK                                        0745
*/*                                    END-THEN                      */
*                                      END;                        0746
*/*                                END-ELSE                          */
*                                  END;                            0747
*/*                            END-ELSE                              */
*                              END;                                0748
*/*                        END-THEN                                  */
*                          END;                                    0749
*/*                      ELSE                                        */
*                        ELSE DO;                                  0750
*                                                                  0750
         B     @RC00706                                            0750
@RF00706 DS    0H                                                  0751
*/*                        VALIDATE_HOME-ADDRESS                     */
*                          CALL VALHOME                            0751
*                               (CTRADDR                           0751
*                               ,DFLAGC                            0751
*                               ,TRACKTYP);                        0751
         LA    @06,CTRADDR                                         0751
         ST    @06,@AL00001                                        0751
         LA    @06,DFLAGC                                          0751
         ST    @06,@AL00001+4                                      0751
         LA    @06,TRACKTYP                                        0751
         ST    @06,@AL00001+8                                      0751
         LA    @01,@AL00001                                        0751
         BAL   @14,VALHOME                                         0751
*/*                        IF NO SEVERE ERRORS AND DEFECT FLAG       */
*/*                         NOT SET AND TRACK IS RECOVERABLE         */
*                          IF LASTCOND < LASTCC12 &                0752
*                           DFLAGC = NODEFECT & RCVRFLAG = RECOVER 0752
*/*                          THEN DISSOCIATE_TRACK                   */
*                            THEN DO;    CALL DISTRACK; END    ;   0752
         L     @06,@PC00001+8                                      0752
         LH    @06,LASTCOND(,@06)                                  0752
         CH    @06,@CH00265                                        0752
         BNL   @RF00752                                            0752
         TM    DFLAGC,B'10000000'                                  0752
         BNZ   @RF00752                                            0752
         TM    RCVRFLAG,B'10000000'                                0752
         BNO   @RF00752                                            0752
         BAL   @14,DISTRACK                                        0754
*/*                          ELSE                                    */
*                            ELSE DO;                              0756
         B     @RC00752                                            0756
@RF00752 DS    0H                                                  0757
*/*                            IF NO SEVERE ERRORS AND               */
*/*                             DEFECT-FLAG SET                      */
*                              IF LASTCOND < LASTCC12 &            0757
*                               DFLAGC = DEFECTIV                  0757
*/*                              THEN                                */
*                                THEN DO;                          0757
         L     @06,@PC00001+8                                      0757
         LH    @06,LASTCOND(,@06)                                  0757
         CH    @06,@CH00265                                        0757
         BNL   @RF00757                                            0757
         TM    DFLAGC,B'10000000'                                  0757
         BNO   @RF00757                                            0757
*/*                                DECREMENT NUMBER OF               */
*/*                                 AVAILABLE ALTERNATE TRACKS       */
*                                  ALTCOUNT = ALTCOUNT - 1;        0759
         L     @06,ALTCOUNT                                        0759
         BCTR  @06,0                                               0759
         ST    @06,ALTCOUNT                                        0759
*/*                                ISSUE_BUILD_PACK_MAP              */
*                                  PACKDEF = DEFECTIV;             0760
         OI    PACKDEF,B'10000000'                                 0760
*                                  PACKCHEK = NODEFECT;            0761
         NI    PACKCHEK,B'01111111'                                0761
*                                  PACKRCVR = RCVRYES;             0762
         NI    PACKRCVR,B'01111111'                                0762
*                                  PACKTRAK = CTRADDR;             0763
         L     @06,CTRADDR                                         0763
         ST    @06,PACKTRAK                                        0763
*                                  PACKTRK = ALTTRACK;             0764
         NI    PACKTRK,B'01111111'                                 0764
*                                  PACKASC = CTRADDR;              0765
         ST    @06,PACKASC                                         0765
*                                  CALL BILDPACK;                  0766
         BAL   @14,BILDPACK                                        0766
*/*                                END-THEN                          */
*                                  END;                            0767
*/*                            END-ELSE                              */
*                              END;                                0768
@RF00757 DS    0H                                                  0769
*/*                        IF PRIMARY IS INCORRECTLY ASSOCIATED OR   */
*/*                         FLAGGED DEFECTIVE                        */
*                          IF (RZACCHH ^= RZCCHH)  (DFLAGA = DEFECTIV)
*/*                          THEN                                    */
*                            THEN DO;                              0769
*                                                                  0769
@RC00752 CLC   RZACCHH(4),RZCCHH                                   0769
         BNE   @RT00769                                            0769
         TM    DFLAGA,B'10000000'                                  0769
         BNO   @RF00769                                            0769
@RT00769 DS    0H                                                  0770
*/*                            ISSUE ERROR MESSAGE (MSGMEDAL)        */
*                              DARGSENT = MSGMEDAL;                0771
         L     @06,DDSTRU                                          0771
         MVI   DARGSENT(@06),X'08'                                 0771
*                              DARGCNT = 8;                        0772
         MVC   DARGCNT(2,@06),@CH00161                             0772
*                              IF DFLAGA = DEFECTIV                0773
*                                THEN DO;                          0773
         TM    DFLAGA,B'10000000'                                  0773
         BNO   @RF00773                                            0773
*                                  DARGINS (1) = 1;                0775
         LA    @15,1                                               0775
         STH   @15,DARGINS(,@06)                                   0775
*                                  DARGINL (1) = 1;                0776
         STH   @15,DARGINL(,@06)                                   0776
*                                  DARGDTM (1) = ADDR ('D');       0777
         LA    @15,@CC00799                                        0777
         ST    @15,DARGDTM(,@06)                                   0777
*                                  END;                            0778
*                                ELSE DO;                          0779
         B     @RC00773                                            0779
@RF00773 DS    0H                                                  0780
*                                  DARGINS (1) = 1;                0780
         LA    @06,1                                               0780
         L     @15,DDSTRU                                          0780
         STH   @06,DARGINS(,@15)                                   0780
*                                  DARGINL (1) = 1;                0781
         STH   @06,DARGINL(,@15)                                   0781
*                                  DARGDTM (1) = ADDR ('N');       0782
         LA    @06,@CC00800                                        0782
         ST    @06,DARGDTM(,@15)                                   0782
*                                  END;                            0783
*                              DARGINS (2) = 2;                    0784
@RC00773 LA    @06,2                                               0784
         L     @15,DDSTRU                                          0784
         STH   @06,DARGINS+8(,@15)                                 0784
*                              DARGINL (2) = LENGTH (RZCCHHC);     0785
         STH   @06,DARGINL+8(,@15)                                 0785
*                              DARGDTM (2) = ADDR (RZCCHHC);       0786
         LA    @14,RZCCHHC                                         0786
         ST    @14,DARGDTM+8(,@15)                                 0786
*                              DARGINS (3) = 3;                    0787
         MVC   DARGINS+16(2,@15),@CH00136                          0787
*                              DARGINL (3) = LENGTH (RZCCHHT);     0788
         STH   @06,DARGINL+16(,@15)                                0788
*                              DARGDTM (3) = ADDR (RZCCHHT);       0789
         LA    @14,RZCCHHT                                         0789
         ST    @14,DARGDTM+16(,@15)                                0789
*                              DARGINS (4) = 4;                    0790
         MVC   DARGINS+24(2,@15),@CH00044                          0790
*                              DARGINL (4) = LENGTH (RZACCHHC);    0791
         STH   @06,DARGINL+24(,@15)                                0791
*                              DARGDTM (4) = ADDR (RZACCHHC);      0792
         LA    @14,RZACCHHC                                        0792
         ST    @14,DARGDTM+24(,@15)                                0792
*                              DARGINS (5) = 5;                    0793
         MVC   DARGINS+32(2,@15),@CH00255                          0793
*                              DARGINL (5) = LENGTH (RZACCHHT);    0794
         STH   @06,DARGINL+32(,@15)                                0794
*                              DARGDTM (5) = ADDR (RZACCHHT);      0795
         LA    @06,RZACCHHT                                        0795
         ST    @06,DARGDTM+32(,@15)                                0795
*                              IF DFLAGC = DEFECTIV                0796
*                                THEN DO;                          0796
         TM    DFLAGC,B'10000000'                                  0796
         BNO   @RF00796                                            0796
*                                  DARGINS (6) = 6;                0798
         MVC   DARGINS+40(2,@15),@CH00119                          0798
*                                  DARGINL (6) = 1;                0799
         MVC   DARGINL+40(2,@15),@CH00165                          0799
*                                  DARGDTM (6) = ADDR ('D');       0800
         LA    @06,@CC00799                                        0800
         ST    @06,DARGDTM+40(,@15)                                0800
*                                  END;                            0801
*                                ELSE DO;                          0802
         B     @RC00796                                            0802
@RF00796 DS    0H                                                  0803
*                                  DARGINS (6) = 6;                0803
         L     @06,DDSTRU                                          0803
         MVC   DARGINS+40(2,@06),@CH00119                          0803
*                                  DARGINL (6) = 1;                0804
         MVC   DARGINL+40(2,@06),@CH00165                          0804
*                                  DARGDTM (6) = ADDR ('N');       0805
         LA    @15,@CC00800                                        0805
         ST    @15,DARGDTM+40(,@06)                                0805
*                                  END;                            0806
*                              DARGINS (7) = 7;                    0807
@RC00796 L     @06,DDSTRU                                          0807
         MVC   DARGINS+48(2,@06),@CH00185                          0807
*                              DARGINL (7) = LENGTH (CTRADDRC);    0808
         LA    @15,2                                               0808
         STH   @15,DARGINL+48(,@06)                                0808
*                              DARGDTM (7) = ADDR (CTRADDRC);      0809
         LA    @14,CTRADDRC                                        0809
         ST    @14,DARGDTM+48(,@06)                                0809
*                              DARGINS (8) = 8;                    0810
         MVC   DARGINS+56(2,@06),@CH00161                          0810
*                              DARGINL (8) = LENGTH (CTRADDRT);    0811
         STH   @15,DARGINL+56(,@06)                                0811
*                              DARGDTM (8) = ADDR (CTRADDRT);      0812
         LA    @15,CTRADDRT                                        0812
         ST    @15,DARGDTM+56(,@06)                                0812
*                              CALL ICKTPPR0 (GDTTBL               0813
*                                     ,PRTFILE                     0813
*                                     ,DDSTRU);                    0813
         L     @06,@PC00001                                        0813
         ST    @06,@AL00001                                        0813
         LA    @15,@CF00094                                        0813
         ST    @15,@AL00001+4                                      0813
         LA    @15,DDSTRU                                          0813
         ST    @15,@AL00001+8                                      0813
         MVI   @AL00001+8,X'80'                                    0813
         L     @15,GDTPRT(,@06)                                    0813
         LA    @01,@AL00001                                        0813
         BALR  @14,@15                                             0813
*/*                            INDICATE AN ERROR                     */
*                              LASTCOND = MAX(LASTCOND,LASTCC08);  0814
         L     @06,@PC00001+8                                      0814
         LH    @15,LASTCOND(,@06)                                  0814
         LA    @14,8                                               0814
         CR    @15,@14                                             0814
         BNL   *+6
         LR    @15,@14                                             0814
         STH   @15,LASTCOND(,@06)                                  0814
*/*                            IF THE TRACK IS A CRITICAL TRACK      */
*                              IF (RZCCHH = 0)                    0815
*                               (RZCCHH >= VTOCLOC & RZCCHH <= VTOCHI)
*/*                              THEN                                */
*                                THEN DO;                          0815
         L     @06,RZCCHH                                          0815
         LTR   @06,@06                                             0815
         BZ    @RT00815                                            0815
         CL    @06,VTOCLOC                                         0815
         BL    @RF00815                                            0815
         CL    @06,VTOCHI                                          0815
         BH    @RF00815                                            0815
@RT00815 DS    0H                                                  0816
*/*                                ISSUE A SEVERE ERROR MESSAGE      */
*                                  DARGSENT = MSGMINV;             0817
         L     @06,DDSTRU                                          0817
         MVI   DARGSENT(@06),X'0C'                                 0817
*                                  DARGCNT = 2;                    0818
         LA    @15,2                                               0818
         STH   @15,DARGCNT(,@06)                                   0818
*                                  DARGINS (1) = 1;                0819
         MVC   DARGINS(2,@06),@CH00165                             0819
*                                  DARGINL (1) = LENGTH (RZCCHHC); 0820
         STH   @15,DARGINL(,@06)                                   0820
*                                  DARGDTM (1) = ADDR (RZCCHHC);   0821
         LA    @14,RZCCHHC                                         0821
         ST    @14,DARGDTM(,@06)                                   0821
*                                  DARGINS (2) = 2;                0822
         STH   @15,DARGINS+8(,@06)                                 0822
*                                  DARGINL (2) = LENGTH (RZCCHHT); 0823
         STH   @15,DARGINL+8(,@06)                                 0823
*                                  DARGDTM (2) = ADDR (RZCCHHT);   0824
         LA    @15,RZCCHHT                                         0824
         ST    @15,DARGDTM+8(,@06)                                 0824
*                                  CALL ICKTPPR0 (GDTTBL           0825
*                                         ,PRTFILE                 0825
*                                         ,DDSTRU);                0825
         L     @06,@PC00001                                        0825
         ST    @06,@AL00001                                        0825
         LA    @15,@CF00094                                        0825
         ST    @15,@AL00001+4                                      0825
         LA    @15,DDSTRU                                          0825
         ST    @15,@AL00001+8                                      0825
         MVI   @AL00001+8,X'80'                                    0825
         L     @15,GDTPRT(,@06)                                    0825
         LA    @01,@AL00001                                        0825
         BALR  @14,@15                                             0825
*/*                                INDICATE A SEVERE ERROR           */
*                                  LASTCOND = LASTCC12;            0826
         L     @06,@PC00001+8                                      0826
         MVC   LASTCOND(2,@06),@CH00265                            0826
*/*                                END-THEN                          */
*                                  END;                            0827
*/*                            END-THEN                              */
*                              END;                                0828
*/*                        END-ELSE                                  */
*                          END;                                    0829
*/*                    END-THEN                                      */
*                      END;                                        0830
*/*                END-THEN (TRACK ASSOCIATED WITH PRIMARY)          */
*                  END;                                            0831
*/*              ELSE                                                */
*                ELSE DO;                                          0832
         B     @RC00701                                            0832
@RF00701 DS    0H                                                  0833
*/*                IF TRACK IS NOT ASSOCIATED TO ITSELF              */
*                  IF RZCCHH ^= CTRADDR                            0833
*/*                  THEN                                            */
*                    THEN DO;                                      0833
         CLC   RZCCHH(4),CTRADDR                                   0833
         BE    @RF00833                                            0833
*/*                    VALIDATE_HOME-ADDRESS                         */
*                      CALL VALHOME                                0835
*                           (CTRADDR                               0835
*                           ,DFLAGC                                0835
*                           ,TRACKTYP);                            0835
         LA    @06,CTRADDR                                         0835
         ST    @06,@AL00001                                        0835
         LA    @06,DFLAGC                                          0835
         ST    @06,@AL00001+4                                      0835
         LA    @06,TRACKTYP                                        0835
         ST    @06,@AL00001+8                                      0835
         LA    @01,@AL00001                                        0835
         BAL   @14,VALHOME                                         0835
*/*                    IF NO SEVERE ERRORS AND DEFECT FLAG           */
*/*                     NOT SET AND TRACK IS RECOVERABLE             */
*                      IF LASTCOND < LASTCC12 &                    0836
*                       DFLAGC = NODEFECT & RCVRFLAG = RECOVER     0836
*/*                      THEN DISSOCIATE_TRACK                       */
*                        THEN DO;    CALL DISTRACK; END        ;   0836
         L     @06,@PC00001+8                                      0836
         LH    @06,LASTCOND(,@06)                                  0836
         CH    @06,@CH00265                                        0836
         BNL   @RF00836                                            0836
         TM    DFLAGC,B'10000000'                                  0836
         BNZ   @RF00836                                            0836
         TM    RCVRFLAG,B'10000000'                                0836
         BNO   @RF00836                                            0836
         BAL   @14,DISTRACK                                        0838
*/*                      ELSE                                        */
*                        ELSE DO;                                  0840
         B     @RC00836                                            0840
@RF00836 DS    0H                                                  0841
*/*                        IF NO SEVERE ERRORS AND                   */
*/*                         DEFECT-FLAG SET                          */
*                          IF LASTCOND < LASTCC12 &                0841
*                           DFLAGC = DEFECTIV                      0841
*/*                          THEN                                    */
*                            THEN DO;                              0841
         L     @06,@PC00001+8                                      0841
         LH    @06,LASTCOND(,@06)                                  0841
         CH    @06,@CH00265                                        0841
         BNL   @RF00841                                            0841
         TM    DFLAGC,B'10000000'                                  0841
         BNO   @RF00841                                            0841
*/*                            DECREMENT NUMBER OF                   */
*/*                             AVAILABLE ALTERNATE TRACKS           */
*                              ALTCOUNT = ALTCOUNT - 1;            0843
         L     @06,ALTCOUNT                                        0843
         BCTR  @06,0                                               0843
         ST    @06,ALTCOUNT                                        0843
*/*                            ISSUE_BUILD_PACK_MAP                  */
*                              PACKDEF = DEFECTIV;                 0844
         OI    PACKDEF,B'10000000'                                 0844
*                              PACKCHEK = NODEFECT;                0845
         NI    PACKCHEK,B'01111111'                                0845
*                              PACKRCVR = RCVRYES;                 0846
         NI    PACKRCVR,B'01111111'                                0846
*                              PACKTRAK = CTRADDR;                 0847
         L     @06,CTRADDR                                         0847
         ST    @06,PACKTRAK                                        0847
*                              PACKTRK = ALTTRACK;                 0848
         NI    PACKTRK,B'01111111'                                 0848
*                              PACKASC = CTRADDR;                  0849
         ST    @06,PACKASC                                         0849
*                              CALL BILDPACK;                      0850
         BAL   @14,BILDPACK                                        0850
*/*                            END-THEN                              */
*                              END;                                0851
*/*                        END-ELSE                                  */
*                          END;                                    0852
*/*                    END-THEN                                      */
*                      END;                                        0853
*/*                  ELSE INCREMENT NUMBER OF AVAILABLE ALTERNATE    */
*/*                   TRACKS FOUND                                   */
*                    ELSE DO;    AVAILCNT = AVAILCNT + 1; END;     0854
         B     @RC00833                                            0854
@RF00833 DS    0H                                                  0855
         LA    @06,1                                               0855
         AL    @06,AVAILCNT                                        0855
         ST    @06,AVAILCNT                                        0855
*/*                END-ELSE                                          */
*                  END;                                            0857
@RC00833 DS    0H                                                  0858
*/*            END-ELSE (DEFECT FLAG FOUND NOT TO BE SET)            */
*              END;                                                0858
@RC00701 DS    0H                                                  0859
*/*        IF NO SEVERE ERRORS AND TRACK IS RECOVERABLE              */
*          IF LASTCOND < LASTCC12 & RCVRFLAG = RECOVER             0859
*/*          THEN                                                    */
*            THEN DO;                                              0859
@RC00546 L     @06,@PC00001+8                                      0859
         LH    @06,LASTCOND(,@06)                                  0859
         CH    @06,@CH00265                                        0859
         BNL   @RF00859                                            0859
         TM    RCVRFLAG,B'10000000'                                0859
         BNO   @RF00859                                            0859
*/*            IF FIRST AVAILABLE TRACK (AVAILCNT = 1)               */
*              IF AVAILCNT = 1                                     0861
*/*              THEN UPDATE POINTER TO THE NEXT AVAILABLE ALTERNATE */
*/*               TRACK TO POINT TO THIS TRACK (ALTPTR)              */
*                THEN DO;                                          0861
*                                                                  0861
         L     @06,AVAILCNT                                        0861
         LA    @15,1                                               0861
         CR    @06,@15                                             0861
         BNE   @RF00861                                            0861
*                  ALTPTRC = CTRADDRC;                             0863
         MVC   ALTPTRC(2),CTRADDRC                                 0863
*                  ALTPTRT = CTRADDRT;                             0864
         MVC   ALTPTRT(2),CTRADDRT                                 0864
*                  AVAILCNT = AVAILCNT + 1;                        0865
         ALR   @06,@15                                             0865
         ST    @06,AVAILCNT                                        0865
*                  END;                                            0866
*/*            END-THEN                                              */
*              END;                                                0867
@RF00861 DS    0H                                                  0868
*/*        END-THEN (NO SEVERE ERRORS)                               */
*          END;                                                    0868
@RF00859 DS    0H                                                  0869
*/*    IF LASTCOND >= 12                                             */
*      IF LASTCOND >= LASTCC12                                     0869
*        THEN RETURN;                                              0869
@RF00544 L     @06,@PC00001+8                                      0869
         LH    @06,LASTCOND(,@06)                                  0869
         CH    @06,@CH00265                                        0869
         BNL   @RT00869                                            0869
*/*      ELSE INCREMENT CURRENT TRACK ADDRESS                        */
*        ELSE DO;                                                  0871
*                                                                  0871
*          IF CTRADDRT = TRKSPCYL - 1                              0872
*            THEN DO;                                              0872
*                                                                  0872
         L     @06,INFOPTR+12                                      0872
         L     @06,TRKSPCYL(,@06)                                  0872
         BCTR  @06,0                                               0872
         MVC   @ZT00002+2(2),CTRADDRT                              0872
         C     @06,@ZT00002                                        0872
         BNE   @RF00872                                            0872
*              CTRADDRC = CTRADDRC + 1;                            0874
         MVC   @ZT00002+2(2),CTRADDRC                              0874
         L     @06,@ZT00002                                        0874
         LA    @06,1(,@06)                                         0874
         STH   @06,CTRADDRC                                        0874
*              CTRADDRT = 0;                                       0875
         SLR   @06,@06                                             0875
         STH   @06,CTRADDRT                                        0875
*              END;                                                0876
*            ELSE DO;    CTRADDRT = CTRADDRT + 1; END;             0877
         B     @RC00872                                            0877
@RF00872 DS    0H                                                  0878
         MVC   @ZT00002+2(2),CTRADDRT                              0878
         L     @06,@ZT00002                                        0878
         LA    @06,1(,@06)                                         0878
         STH   @06,CTRADDRT                                        0878
*          END;                                                    0880
@RC00872 DS    0H                                                  0881
*/*  END-UNTIL (ALL ALTERNATE TRACKS ARE EXHAUSTED)                  */
*    END;                                                          0881
@DE00541 L     @06,INFOPTR+60                                      0881
         CLC   CTRADDR(4),FINALT(@06)                              0881
         BNH   @DL00541                                            0881
*/*  END-SUB-PROCEDURE EXAMINE_ALTERNATE_TRACKS                      */
*    END EXALTRA;                                                  0882
*                                                                  0882
@EL00005 DS    0H                                                  0882
@EF00005 DS    0H                                                  0882
@ER00005 LM    @14,@12,@SA00005                                    0882
         BR    @14                                                 0882
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  INALTRA                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  INITIALIZE ALTERNATE TRACKS                  */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL INITIALIZE ALL THE ALTERNATE TRACKS   */
*/*    ON A PACK FOR MEDIAL AND MAXIMAL INITIALIZATION.              */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0883
*                                                                  0883
*/*  SUB-PROCEDURE INITIALIZE_ALTERNATE_TRACKS                       */
*    INALTRA:                                                      0883
*      PROCEDURE;                                                  0883
INALTRA  STM   @14,@12,@SA00006                                    0883
*    OLDERID2 = NEWERID2;                                          0884
         L     @06,@PC00001                                        0884
         L     @06,GDTTR2(,@06)                                    0884
         MVC   @TS00001(95),NEWERID2(@06)                          0884
         MVC   OLDERID2(95,@06),@TS00001                           0884
*    NEWID2 =  'INIA';                                             0885
         MVC   NEWID2(4,@06),@CC00805                              0885
*    CTRADDR = FIRSTAL;                                            0886
         L     @06,INFOPTR+48                                      0886
         MVC   CTRADDR(4),FIRSTAL(@06)                             0886
*    TRACKTYP = ALTTRACK;                                          0887
         NI    TRACKTYP,B'01111111'                                0887
*/*  DO-UNTIL ALL ALTERNATE TRACKS ARE EXHAUSTED                     */
*    DO UNTIL (CTRADDR > FINALT);                                  0888
*                                                                  0888
@DL00888 DS    0H                                                  0889
*/*    SET FLAG TO INDICATE TRACK CURRENTLY RECOVERABLE              */
*      RCVRFLAG = RECOVER;                                         0889
         OI    RCVRFLAG,B'10000000'                                0889
*/*    VALIDATE_TRACK                                                */
*      CALL VALTRACK;                                              0890
         BAL   @14,VALTRACK                                        0890
*/*    IF NO SEVERE ERRORS AND TRACK RECOVERABLE                     */
*      IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)             0891
*/*      THEN                                                        */
*        THEN DO;                                                  0891
*                                                                  0891
         L     @06,@PC00001+8                                      0891
         LH    @06,LASTCOND(,@06)                                  0891
         CH    @06,@CH00265                                        0891
         BNL   @RF00891                                            0891
         TM    RCVRFLAG,B'10000000'                                0891
         BNO   @RF00891                                            0891
*/*        IF DEFECT-FLAG IS FOUND TO BE SET                         */
*          IF DFLAGC = DEFECTIV                                    0893
*/*          THEN                                                    */
*            THEN DO;                                              0893
*                                                                  0893
         TM    DFLAGC,B'10000000'                                  0893
         BNO   @RF00893                                            0893
*/*            DECREMENT COUNT OF AVAILABLE ALT. TRACKS (ALTCOUNT)   */
*              ALTCOUNT = ALTCOUNT - 1;                            0895
         L     @06,ALTCOUNT                                        0895
         BCTR  @06,0                                               0895
         ST    @06,ALTCOUNT                                        0895
*/*            IF MEDIAL INITIALIZATION WAS REQUESTED                */
*              IF (ADDR(VALID) ^= NULLPTR) & (ADDR(NOCHK) ^= NULLPTR)
*/*              THEN ISSUE_BUILD_PACK_MAP                           */
*                THEN DO;                                          0896
*                                                                  0896
         SLR   @06,@06                                             0896
         L     @15,@PC00001+4                                      0896
         C     @06,FDTPTR+56(,@15)                                 0896
         BE    @RF00896                                            0896
         C     @06,FDTPTR+16(,@15)                                 0896
         BE    @RF00896                                            0896
*                  PACKDEF  = DEFECTIV;                            0898
         OI    PACKDEF,B'10000000'                                 0898
*                  PACKCHEK = NODEFECT;                            0899
         NI    PACKCHEK,B'01111111'                                0899
*                  PACKRCVR = RCVRYES;                             0900
         NI    PACKRCVR,B'01111111'                                0900
*                  PACKTRK  = ALTTRACK;                            0901
         NI    PACKTRK,B'01111111'                                 0901
*                  PACKTRAK = CTRADDR;                             0902
         L     @06,CTRADDR                                         0902
         ST    @06,PACKTRAK                                        0902
*                  PACKASC = CTRADDR;                              0903
         ST    @06,PACKASC                                         0903
*                  CALL BILDPACK;                                  0904
         BAL   @14,BILDPACK                                        0904
*                  END;                                            0905
*/*            END-THEN                                              */
*              END;                                                0906
*/*          ELSE (DEFECT-FLAG FOUND NOT TO BE SET)                  */
*            ELSE DO;                                              0907
*                                                                  0907
         B     @RC00893                                            0907
@RF00893 DS    0H                                                  0908
*/*            INCREMENT COUNT OF AVAILABLE TRACKS FOUND             */
*              AVAILCNT = AVAILCNT + 1;                            0908
         LA    @06,1                                               0908
         AL    @06,AVAILCNT                                        0908
         ST    @06,AVAILCNT                                        0908
*/*            END-ELSE (DEFECT-FLAG FOUND NOT TO BE SET)            */
*              END;                                                0909
*/*        END-THEN (NO SEVERE ERRORS)                               */
*          END;                                                    0910
@RC00893 DS    0H                                                  0911
*/*    IF NO SEVERE ERRORS AND TRACK RECOVERABLE                     */
*      IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)             0911
*/*      THEN                                                        */
*        THEN DO;                                                  0911
*                                                                  0911
@RF00891 L     @06,@PC00001+8                                      0911
         LH    @06,LASTCOND(,@06)                                  0911
         CH    @06,@CH00265                                        0911
         BNL   @RF00911                                            0911
         TM    RCVRFLAG,B'10000000'                                0911
         BNO   @RF00911                                            0911
*/*        IF CHECK(N) IS SPECIFIED                                  */
*          IF ADDR (CHECK) ^= NULLPTR                              0913
*/*          THEN                                                    */
*            THEN DO;                                              0913
*                                                                  0913
         L     @06,@PC00001+4                                      0913
         L     @06,FDTPTR+12(,@06)                                 0913
         LTR   @06,@06                                             0913
         BZ    @RF00913                                            0913
*/*            ISSUE_CHECK_TRACK_SURFACE                             */
*              CALL CHTRACK;                                       0915
         BAL   @14,CHTRACK                                         0915
*/*            IF NO SEVERE ERRORS AND TRACK RECOVERABLE             */
*              IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)     0916
*/*              THEN                                                */
*                THEN DO;                                          0916
*                                                                  0916
         L     @06,@PC00001+8                                      0916
         LH    @06,LASTCOND(,@06)                                  0916
         CH    @06,@CH00265                                        0916
         BNL   @RF00916                                            0916
         TM    RCVRFLAG,B'10000000'                                0916
         BNO   @RF00916                                            0916
*/*                IF TRACK CHECKS OUT NON-DEFECTIVE                 */
*                  IF TRSTATUS = TSCGOOD                           0918
*/*                  THEN                                            */
*                    THEN DO;                                      0918
*                                                                  0918
         TM    TRSTATUS,B'10000000'                                0918
         BNO   @RF00918                                            0918
*/*                    IF DEFECT-FLAG IS FOUND TO BE SET             */
*                      IF DFLAGC = DEFECTIV                        0920
*/*                      THEN                                        */
*                        THEN DO;                                  0920
*                                                                  0920
         TM    DFLAGC,B'10000000'                                  0920
         BNO   @RF00920                                            0920
*/*                        IF RECLAIM IS SPECIFIED                   */
*                          IF ADDR (RECLA) ^= NULLPTR              0922
*/*                          THEN ISSUE_RECLAIM_ALTERNATE_TRACK      */
*                            THEN DO;    CALL REATRACK; END;       0922
         L     @06,@PC00001+4                                      0922
         L     @06,FDTPTR+20(,@06)                                 0922
         LTR   @06,@06                                             0922
         BZ    @RF00922                                            0922
         BAL   @14,REATRACK                                        0924
*/*                          ELSE ISSUE_BUILD_PACK_MAP (FLAGGED DEF.)*/
*                            ELSE DO;                              0926
*                                                                  0926
         B     @RC00922                                            0926
@RF00922 DS    0H                                                  0927
*                              PACKDEF  = DEFECTIV;                0927
         OI    PACKDEF,B'10000000'                                 0927
*                              PACKCHEK = NODEFECT;                0928
         NI    PACKCHEK,B'01111111'                                0928
*                              PACKRCVR = RCVRYES;                 0929
         NI    PACKRCVR,B'01111111'                                0929
*                              PACKTRK  = ALTTRACK;                0930
         NI    PACKTRK,B'01111111'                                 0930
*                              PACKTRAK = CTRADDR;                 0931
         L     @06,CTRADDR                                         0931
         ST    @06,PACKTRAK                                        0931
*                              PACKASC = CTRADDR;                  0932
         ST    @06,PACKASC                                         0932
*                              CALL BILDPACK;                      0933
         BAL   @14,BILDPACK                                        0933
*                              END;                                0934
*/*                        END-THEN (DEFECT-FLAG IS SET)             */
*                          END;                                    0935
*/*                    END-THEN (TRACK CHECKS OUT NON-DEFECTIVE)     */
*                      END;                                        0936
*/*                  ELSE (TRACK CHECKS OUT DEFECTIVE)               */
*                    ELSE DO;                                      0937
*                                                                  0937
         B     @RC00918                                            0937
@RF00918 DS    0H                                                  0938
*/*                    IF DEFECT-FLAG IS FOUND TO BE SET             */
*                      IF DFLAGC = DEFECTIV                        0938
*/*                      THEN                                        */
*                        THEN DO;                                  0938
*                                                                  0938
         TM    DFLAGC,B'10000000'                                  0938
         BNO   @RF00938                                            0938
*/*                        ISSUE_BUILD_PACK_MAP (FLAGGED DEFECTIVE)  */
*                          PACKDEF  = DEFECTIV;                    0940
         OI    PACKDEF,B'10000000'                                 0940
*                          PACKCHEK = NODEFECT;                    0941
         NI    PACKCHEK,B'01111111'                                0941
*                          PACKRCVR = RCVRYES;                     0942
         NI    PACKRCVR,B'01111111'                                0942
*                          PACKTRK  = ALTTRACK;                    0943
         NI    PACKTRK,B'01111111'                                 0943
*                          PACKTRAK = CTRADDR;                     0944
         L     @06,CTRADDR                                         0944
         ST    @06,PACKTRAK                                        0944
*                          PACKASC = CTRADDR;                      0945
         ST    @06,PACKASC                                         0945
*                          CALL BILDPACK;                          0946
         BAL   @14,BILDPACK                                        0946
*/*                        ISSUE_BUILD_PACK_MAP (TRACK DEFECTIVE)    */
*                          PACKDEF  = NODEFECT;                    0947
         NI    PACKDEF,B'01111111'                                 0947
*                          PACKCHEK = DEFECTIV;                    0948
         OI    PACKCHEK,B'10000000'                                0948
*                          CALL BILDPACK;                          0949
         BAL   @14,BILDPACK                                        0949
*/*                        END-THEN                                  */
*                          END;                                    0950
*/*                      ELSE (DEFECT-FLAG FOUND NOT TO BE SET)      */
*                        ELSE DO;                                  0951
*                                                                  0951
         B     @RC00938                                            0951
@RF00938 DS    0H                                                  0952
*/*                        DECREMENT COUNT OF AVAILABLE ALT TRACKS   */
*                          ALTCOUNT = ALTCOUNT - 1;                0952
         L     @06,ALTCOUNT                                        0952
         BCTR  @06,0                                               0952
         ST    @06,ALTCOUNT                                        0952
*/*                        ISSUE_BUILD_PACK_MAP (TRACK DEFECTIVE)    */
*                          PACKDEF  = NODEFECT;                    0953
         NI    PACKDEF,B'01111111'                                 0953
*                          PACKCHEK = DEFECTIV;                    0954
         OI    PACKCHEK,B'10000000'                                0954
*                          PACKRCVR = RCVRYES;                     0955
         NI    PACKRCVR,B'01111111'                                0955
*                          PACKTRK  = ALTTRACK;                    0956
         NI    PACKTRK,B'01111111'                                 0956
*                          PACKTRAK = CTRADDR;                     0957
         L     @06,CTRADDR                                         0957
         ST    @06,PACKTRAK                                        0957
*                          PACKASC = CTRADDR;                      0958
         ST    @06,PACKASC                                         0958
*                          CALL BILDPACK;                          0959
         BAL   @14,BILDPACK                                        0959
*/*                        ISSUE_MARK_TRACK_DEFECTIVE                */
*                          CALL WRIHARZD;                          0960
         BAL   @14,WRIHARZD                                        0960
*/*                        END-ELSE (DEFECT-FLAG NOT SET)            */
*                          END;                                    0961
*/*                    END-ELSE (TRACK CHECKS OUT DEFECTIVE)         */
*                      END;                                        0962
@RC00938 DS    0H                                                  0963
*/*                IF FIRST AVAILABLE TRACK (AVAILCNT = 1)           */
*                  IF AVAILCNT = 1                                 0963
*/*                  THEN SET POINTER TO THE NEXT AVAILABLE ALTERNATE*/
*/*                   TRACK TO POINT TO THIS TRACK                   */
*                    THEN DO;                                      0963
*                                                                  0963
@RC00918 L     @06,AVAILCNT                                        0963
         LA    @15,1                                               0963
         CR    @06,@15                                             0963
         BNE   @RF00963                                            0963
*                      ALTPTR = CTRADDR;                           0965
         MVC   ALTPTR(4),CTRADDR                                   0965
*                      AVAILCNT = AVAILCNT + 1;                    0966
         ALR   @06,@15                                             0966
         ST    @06,AVAILCNT                                        0966
*                      END;                                        0967
*/*                END-THEN (NO SEVERE ERRORS)                       */
*                  END;                                            0968
@RF00963 DS    0H                                                  0969
*/*            END-THEN (CHECK (N) IS SPECIFIED)                     */
*              END;                                                0969
@RF00916 DS    0H                                                  0970
*/*        END-THEN (NO SEVERE ERRORS)                               */
*          END;                                                    0970
@RF00913 DS    0H                                                  0971
*/*    IF LASTCOND >= 12                                             */
*      IF LASTCOND >= LASTCC12                                     0971
*/*      THEN RETURN                                                 */
*        THEN DO;    RETURN; END;                                  0971
@RF00911 L     @06,@PC00001+8                                      0971
         LH    @06,LASTCOND(,@06)                                  0971
         CH    @06,@CH00265                                        0971
         BL    @RF00971                                            0971
@EL00006 DS    0H                                                  0973
@EF00006 DS    0H                                                  0973
@ER00006 LM    @14,@12,@SA00006                                    0973
         BR    @14                                                 0973
*/*      ELSE INCREMENT CURRENT TRACK ADDRESS                        */
*        ELSE DO;                                                  0975
*                                                                  0975
@RF00971 DS    0H                                                  0976
*          IF CTRADDRT = TRKSPCYL - 1                              0976
*            THEN DO;                                              0976
*                                                                  0976
         L     @06,INFOPTR+12                                      0976
         L     @06,TRKSPCYL(,@06)                                  0976
         BCTR  @06,0                                               0976
         MVC   @ZT00002+2(2),CTRADDRT                              0976
         C     @06,@ZT00002                                        0976
         BNE   @RF00976                                            0976
*              CTRADDRC = CTRADDRC + 1;                            0978
         MVC   @ZT00002+2(2),CTRADDRC                              0978
         L     @06,@ZT00002                                        0978
         LA    @06,1(,@06)                                         0978
         STH   @06,CTRADDRC                                        0978
*              CTRADDRT = 0;                                       0979
         SLR   @06,@06                                             0979
         STH   @06,CTRADDRT                                        0979
*              END;                                                0980
*            ELSE DO;    CTRADDRT = CTRADDRT + 1; END;             0981
         B     @RC00976                                            0981
@RF00976 DS    0H                                                  0982
         MVC   @ZT00002+2(2),CTRADDRT                              0982
         L     @06,@ZT00002                                        0982
         LA    @06,1(,@06)                                         0982
         STH   @06,CTRADDRT                                        0982
*          END;                                                    0984
@RC00976 DS    0H                                                  0985
*/*  END-UNTIL (ALL THE ALTERNATE TRACKS)                            */
*    END;                                                          0985
@DE00888 L     @06,INFOPTR+60                                      0985
         CLC   CTRADDR(4),FINALT(@06)                              0985
         BNH   @DL00888                                            0985
*/*  END-SUB-PROCEDURE INITIALIZE_ALTERNATE_TRACKS                   */
*    END INALTRA;                                                  0986
*                                                                  0986
         B     @EL00006                                            0986
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  INITPRIM                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  INITIALIZE PRIMARY TRACKS                    */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INITIALIZES ALL THE PRIMARY TRACKS ON      */
*/*    THE PACK FOR MEDIAL AND MAXIMAL INITIALIZATION.               */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0987
*                                                                  0987
*/*  SUB-PROCEDURE INITIALIZE_PRIMARY_TRACKS                         */
*    INITPRIM:                                                     0987
*      PROCEDURE;                                                  0987
INITPRIM STM   @14,@12,@SA00007                                    0987
*    OLDERID2 = NEWERID2;                                          0988
         L     @06,@PC00001                                        0988
         L     @06,GDTTR2(,@06)                                    0988
         MVC   @TS00001(95),NEWERID2(@06)                          0988
         MVC   OLDERID2(95,@06),@TS00001                           0988
*    NEWID2 =  'INIP';                                             0989
         MVC   NEWID2(4,@06),@CC00813                              0989
*    CTRADDR = 0;                                                  0990
         SLR   @06,@06                                             0990
         ST    @06,CTRADDR                                         0990
*    TRACKTYP = PRITRACK;                                          0991
         OI    TRACKTYP,B'10000000'                                0991
*    FTRKFLG = NODEFECT;                                           0992
         NI    FTRKFLG,B'01111111'                                 0992
*/*  DO-UNTIL ALL THE PRIMARY TRACKS ARE EXHAUSTED                   */
*    DO UNTIL (CTRADDR > FINPRI);                                  0993
*                                                                  0993
@DL00993 DS    0H                                                  0994
*/*    SET FLAG TO INDICATE TRACK IS CURRENTLY RECOVERABLE           */
*      RCVRFLAG = RECOVER;                                         0994
         OI    RCVRFLAG,B'10000000'                                0994
*/*    VALIDATE_TRACK                                                */
*      CALL VALTRACK;                                              0995
         BAL   @14,VALTRACK                                        0995
*/*    IF NO SEVERE ERRORS AND TRACK RECOVERABLE                     */
*      IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)             0996
*/*      THEN                                                        */
*        THEN DO;                                                  0996
*                                                                  0996
         L     @06,@PC00001+8                                      0996
         LH    @06,LASTCOND(,@06)                                  0996
         CH    @06,@CH00265                                        0996
         BNL   @RF00996                                            0996
         TM    RCVRFLAG,B'10000000'                                0996
         BNO   @RF00996                                            0996
*/*        IF VALIDATE AND NOCHECK ARE SPECIFIED(MED. INITIALIZATION)*/
*          IF (ADDR(VALID) ^= NULLPTR) & (ADDR(NOCHK) ^= NULLPTR)  0998
*/*          THEN                                                    */
*            THEN DO;                                              0998
*                                                                  0998
         SLR   @06,@06                                             0998
         L     @15,@PC00001+4                                      0998
         C     @06,FDTPTR+56(,@15)                                 0998
         BE    @RF00998                                            0998
         C     @06,FDTPTR+16(,@15)                                 0998
         BE    @RF00998                                            0998
*/*            IF DEFECT-FLAG IS FOUND TO BE SET                     */
*              IF DFLAGC = DEFECTIV                                1000
*/*              THEN                                                */
*                  THEN DO;                                        1000
*                                                                  1000
         TM    DFLAGC,B'10000000'                                  1000
         BNO   @RF01000                                            1000
*/*                IF FIRST TRACK ON PACK                            */
*                  IF CTRADDR = 0                                  1002
*/*                  THEN INDICATE THAT IT IS DEFECTIVE              */
*                    THEN DO;    FTRKFLG = DEFECTIV; END;          1002
         CL    @06,CTRADDR                                         1002
         BNE   @RF01002                                            1002
         OI    FTRKFLG,B'10000000'                                 1004
*/*                ISSUE_BUILD_PACK_MAP (TRACK DEFECT-FLAG IS SET)   */
*                  PACKDEF  = DEFECTIV;                            1006
@RF01002 OI    PACKDEF,B'10000000'                                 1006
*                  PACKCHEK = NODEFECT;                            1007
         NI    PACKCHEK,B'01111111'                                1007
*                  PACKRCVR = RCVRYES;                             1008
         NI    PACKRCVR,B'01111111'                                1008
*                  PACKTRK  = PRITRACK;                            1009
         OI    PACKTRK,B'10000000'                                 1009
*                  PACKTRAK = CTRADDR;                             1010
         L     @06,CTRADDR                                         1010
         ST    @06,PACKTRAK                                        1010
*                  PACKASC = CTRADDR;                              1011
         ST    @06,PACKASC                                         1011
*                  CALL BILDPACK;                                  1012
         BAL   @14,BILDPACK                                        1012
*/*                IF NO SEVERE ERRORS AND TRACK RECOVERABLE         */
*                  IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER) 1013
*/*                  THEN ISSUE_ASSIGN_ALTERNATE_TRACK               */
*                    THEN DO;    CALL ASSGNALT; END;               1013
         L     @06,@PC00001+8                                      1013
         LH    @06,LASTCOND(,@06)                                  1013
         CH    @06,@CH00265                                        1013
         BNL   @RF01013                                            1013
         TM    RCVRFLAG,B'10000000'                                1013
         BNO   @RF01013                                            1013
         BAL   @14,ASSGNALT                                        1015
*/*                END-THEN (DEFECT-FLAG SET)                        */
*                  END;                                            1017
*/*            END-THEN (VALIDATE AND NOCHECK ARE SPECIFIED)         */
*              END;                                                1018
*/*          ELSE (CHECK(N) IS SPECIFIED) (MAXIMAL INITIALIZATION)   */
*            ELSE DO;                                              1019
*                                                                  1019
         B     @RC00998                                            1019
@RF00998 DS    0H                                                  1020
*/*            ISSUE_CHECK_TRACK_SURFACE                             */
*              CALL CHTRACK;                                       1020
         BAL   @14,CHTRACK                                         1020
*/*            IF NO SEVERE ERRORS AND TRACK RECOVERABLE             */
*              IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)     1021
*/*              THEN                                                */
*                THEN DO;                                          1021
*                                                                  1021
         L     @06,@PC00001+8                                      1021
         LH    @06,LASTCOND(,@06)                                  1021
         CH    @06,@CH00265                                        1021
         BNL   @RF01021                                            1021
         TM    RCVRFLAG,B'10000000'                                1021
         BNO   @RF01021                                            1021
*/*                IF TRACK CHECKS OUT OKAY                          */
*                  IF TRSTATUS = TSCGOOD                           1023
*/*                  THEN                                            */
*                    THEN DO;                                      1023
*                                                                  1023
         TM    TRSTATUS,B'10000000'                                1023
         BNO   @RF01023                                            1023
*/*                    IF DEFECT-FLAG IS FOUND TO BE SET             */
*                      IF DFLAGC = DEFECTIV                        1025
*/*                      THEN                                        */
*                        THEN DO;                                  1025
*                                                                  1025
         TM    DFLAGC,B'10000000'                                  1025
         BNO   @RF01025                                            1025
*/*                        IF RECLAIM IS SPECIFIED                   */
*                          IF ADDR(RECLA) ^= NULLPTR               1027
*/*                          THEN ISSUE_RECLAIM_PRIMARY_TRACK        */
*                            THEN DO;    CALL REPTRACK; END;       1027
         L     @06,@PC00001+4                                      1027
         L     @06,FDTPTR+20(,@06)                                 1027
         LTR   @06,@06                                             1027
         BZ    @RF01027                                            1027
         BAL   @14,REPTRACK                                        1029
*/*                          ELSE (NORECLAIM IS SPECIFIED)           */
*                            ELSE DO;                              1031
*                                                                  1031
         B     @RC01027                                            1031
@RF01027 DS    0H                                                  1032
*/*                            IF FIRST TRACK ON PACK                */
*                              IF CTRADDR = 0                      1032
*/*                              THEN INDICATE THAT IT IS DEFECTIVE  */
*                                THEN DO;                          1032
*                                                                  1032
         L     @06,CTRADDR                                         1032
         LTR   @06,@06                                             1032
         BNZ   @RF01032                                            1032
*                                  FTRKFLG = DEFECTIV;             1034
         OI    FTRKFLG,B'10000000'                                 1034
*                                  END;                            1035
*/*                            ISSUE_BUILD_PACK_MAP (FLAGGED DEF.)   */
*                              PACKDEF  = DEFECTIV;                1036
@RF01032 OI    PACKDEF,B'10000000'                                 1036
*                              PACKCHEK = NODEFECT;                1037
         NI    PACKCHEK,B'01111111'                                1037
*                              PACKRCVR = RCVRYES;                 1038
         NI    PACKRCVR,B'01111111'                                1038
*                              PACKTRK  = PRITRACK;                1039
         OI    PACKTRK,B'10000000'                                 1039
*                              PACKTRAK = CTRADDR;                 1040
         L     @06,CTRADDR                                         1040
         ST    @06,PACKTRAK                                        1040
*                              PACKASC = CTRADDR;                  1041
         ST    @06,PACKASC                                         1041
*                              CALL BILDPACK;                      1042
         BAL   @14,BILDPACK                                        1042
*/*                            IF NO SEVERE ERRORS AND TRACK         */
*/*                             RECOVERABLE                          */
*                              IF (LASTCOND < LASTCC12) &          1043
*                               (RCVRFLAG = RECOVER)               1043
*/*                              THEN ISSUE_ASSIGN_ALTERNATE_TRACK   */
*                                THEN DO;    CALL ASSGNALT; END;   1043
         L     @06,@PC00001+8                                      1043
         LH    @06,LASTCOND(,@06)                                  1043
         CH    @06,@CH00265                                        1043
         BNL   @RF01043                                            1043
         TM    RCVRFLAG,B'10000000'                                1043
         BNO   @RF01043                                            1043
         BAL   @14,ASSGNALT                                        1045
*/*                            END-ELSE (NORECLAIM IS SPECIFIED)     */
*                              END;                                1047
*/*                        END-THEN (DEFECT-FLAG IS SET)             */
*                          END;                                    1048
*/*                    END-THEN (TRACK CHECKS OUT OKAY)              */
*                      END;                                        1049
*/*                  ELSE (TRACK CHECKS OUT DEFECTIVE)               */
*                    ELSE DO;                                      1050
*                                                                  1050
         B     @RC01023                                            1050
@RF01023 DS    0H                                                  1051
*/*                    IF DEFECT-FLAG IS FOUND TO BE SET             */
*                      IF DFLAGC = DEFECTIV                        1051
*/*                      THEN                                        */
*                        THEN DO;                                  1051
*                                                                  1051
         TM    DFLAGC,B'10000000'                                  1051
         BNO   @RF01051                                            1051
*/*                        IF FIRST TRACK ON PACK                    */
*                          IF CTRADDR = 0                          1053
*/*                          THEN INDICATE THAT IT IS DEFECTIVE      */
*                            THEN DO;                              1053
*                                                                  1053
         L     @06,CTRADDR                                         1053
         LTR   @06,@06                                             1053
         BNZ   @RF01053                                            1053
*                              FTRKFLG = DEFECTIV;                 1055
         OI    FTRKFLG,B'10000000'                                 1055
*                              END;                                1056
*/*                        ISSUE_BUILD_PACK_MAP (FLAGGED DEFECTIVE)  */
*                          PACKDEF  = DEFECTIV;                    1057
@RF01053 OI    PACKDEF,B'10000000'                                 1057
*                          PACKCHEK = NODEFECT;                    1058
         NI    PACKCHEK,B'01111111'                                1058
*                          PACKRCVR = RCVRYES;                     1059
         NI    PACKRCVR,B'01111111'                                1059
*                          PACKTRK  = PRITRACK;                    1060
         OI    PACKTRK,B'10000000'                                 1060
*                          PACKTRAK = CTRADDR;                     1061
         L     @06,CTRADDR                                         1061
         ST    @06,PACKTRAK                                        1061
*                          PACKASC = CTRADDR;                      1062
         ST    @06,PACKASC                                         1062
*                          CALL BILDPACK;                          1063
         BAL   @14,BILDPACK                                        1063
*/*                        ISSUE_BUILD_PACK_MAP (FOUND DEFECTIVE)    */
*                          PACKDEF  = NODEFECT;                    1064
         NI    PACKDEF,B'01111111'                                 1064
*                          PACKCHEK = DEFECTIV;                    1065
         OI    PACKCHEK,B'10000000'                                1065
*                          CALL BILDPACK;                          1066
         BAL   @14,BILDPACK                                        1066
*                          END;                                    1067
*/*                      ELSE (DEFECT-FLAG FOUND NOT TO BE SET)      */
*                        ELSE DO;                                  1068
*                                                                  1068
         B     @RC01051                                            1068
@RF01051 DS    0H                                                  1069
*/*                        ISSUE_BUILD_PACK_MAP (FOUND DEFECTIVE)    */
*                          PACKDEF  = NODEFECT;                    1069
         NI    PACKDEF,B'01111111'                                 1069
*                          PACKCHEK = DEFECTIV;                    1070
         OI    PACKCHEK,B'10000000'                                1070
*                          PACKTRK  = PRITRACK;                    1071
         OI    PACKTRK,B'10000000'                                 1071
*                          PACKTRAK = CTRADDR;                     1072
         L     @06,CTRADDR                                         1072
         ST    @06,PACKTRAK                                        1072
*                          PACKASC = CTRADDR;                      1073
         ST    @06,PACKASC                                         1073
*                          CALL BILDPACK;                          1074
         BAL   @14,BILDPACK                                        1074
*/*                        ISSUE_MARK_TRACK_DEFECTIVE                */
*                          CALL WRIHARZD;                          1075
         BAL   @14,WRIHARZD                                        1075
*/*                        IF FIRST TRACK ON PACK                    */
*                          IF CTRADDR = 0                          1076
*/*                          THEN INDICATE THAT IT IS DEFECTIVE      */
*                            THEN DO;    FTRKFLG = DEFECTIV; END;  1076
         L     @06,CTRADDR                                         1076
         LTR   @06,@06                                             1076
         BNZ   @RF01076                                            1076
         OI    FTRKFLG,B'10000000'                                 1078
*/*                        END-ELSE                                  */
*                          END;                                    1080
@RF01076 DS    0H                                                  1081
*/*                    IF NO SEVERE ERRORS AND TRACK RECOVERABLE     */
*                      IF (LASTCOND < LASTCC12) &                  1081
*                       (RCVRFLAG = RECOVER)                       1081
*/*                      THEN ISSUE_ASSIGN_ALTERNATE_TRACK           */
*                        THEN DO;    CALL ASSGNALT; END;           1081
@RC01051 L     @06,@PC00001+8                                      1081
         LH    @06,LASTCOND(,@06)                                  1081
         CH    @06,@CH00265                                        1081
         BNL   @RF01081                                            1081
         TM    RCVRFLAG,B'10000000'                                1081
         BNO   @RF01081                                            1081
         BAL   @14,ASSGNALT                                        1083
*/*                    END-ELSE (TRACK CHECKS OUT DEFECTIVE)         */
*                      END;                                        1085
@RF01081 DS    0H                                                  1086
*/*                END-THEN (NO SEVERE ERRORS)                       */
*                  END;                                            1086
@RC01023 DS    0H                                                  1087
*/*            END-ELSE (CHECK(N) IS SPECIFIED)                      */
*              END;                                                1087
@RF01021 DS    0H                                                  1088
*/*        END-THEN (NO SEVERE ERRORS)                               */
*          END;                                                    1088
@RC00998 DS    0H                                                  1089
*/*    IF LASTCOND >= 12                                             */
*      IF LASTCOND >= LASTCC12                                     1089
*/*      THEN RETURN                                                 */
*        THEN DO;    RETURN; END;                                  1089
@RF00996 L     @06,@PC00001+8                                      1089
         LH    @06,LASTCOND(,@06)                                  1089
         CH    @06,@CH00265                                        1089
         BL    @RF01089                                            1089
@EL00007 DS    0H                                                  1091
@EF00007 DS    0H                                                  1091
@ER00007 LM    @14,@12,@SA00007                                    1091
         BR    @14                                                 1091
*/*      ELSE INCREMENT CURRENT TRACK ADDRESS                        */
*        ELSE DO;                                                  1093
*                                                                  1093
@RF01089 DS    0H                                                  1094
*          IF CTRADDRT = TRKSPCYL - 1                              1094
*            THEN DO;                                              1094
*                                                                  1094
         L     @06,INFOPTR+12                                      1094
         L     @06,TRKSPCYL(,@06)                                  1094
         BCTR  @06,0                                               1094
         MVC   @ZT00002+2(2),CTRADDRT                              1094
         C     @06,@ZT00002                                        1094
         BNE   @RF01094                                            1094
*              CTRADDRC = CTRADDRC + 1;                            1096
         MVC   @ZT00002+2(2),CTRADDRC                              1096
         L     @06,@ZT00002                                        1096
         LA    @06,1(,@06)                                         1096
         STH   @06,CTRADDRC                                        1096
*              CTRADDRT = 0;                                       1097
         SLR   @06,@06                                             1097
         STH   @06,CTRADDRT                                        1097
*              END;                                                1098
*            ELSE DO;    CTRADDRT = CTRADDRT + 1; END;             1099
         B     @RC01094                                            1099
@RF01094 DS    0H                                                  1100
         MVC   @ZT00002+2(2),CTRADDRT                              1100
         L     @06,@ZT00002                                        1100
         LA    @06,1(,@06)                                         1100
         STH   @06,CTRADDRT                                        1100
*          END;                                                    1102
@RC01094 DS    0H                                                  1103
*/*  END-UNTIL (ALL THE PRIMARY TRACKS)                              */
*    END;                                                          1103
@DE00993 L     @06,INFOPTR+72                                      1103
         CLC   CTRADDR(4),FINPRI(@06)                              1103
         BNH   @DL00993                                            1103
*/*  END-SUB-PROCEDURE INITIALIZE_PRIMARY_TRACKS                     */
*    END INITPRIM;                                                 1104
*                                                                  1104
         B     @EL00007                                            1104
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  PREPVOL                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  PREPARE VOLUME LABELS                        */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE PROCESSES THE FIRST TRACK ON THE PACK.     */
*/*    THE BOOTSTRAP RECORDS, VOLUME LABEL AND USER VOLUME LABELS    */
*/*    AS SPECIFIED ARE WRITTEN ON THIS TRACK. IPL PROGRAM RECORDS   */
*/*    ARE NOT WRITTEN ON THIS TRACK BY THIS SUB-PROCEDURE. IF AN    */
*/*    AN IPL PROGRAM IS SUPPLIED IT IS WRITTEN ON THIS TRACK LATER  */
*/*    BY ANOTHER SUB-PROCEDURE                                      */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1105
*                                                                  1105
*/*  SUB-PROCEDURE PREPARE_VOLUME_LABELS                             */
*    PREPVOL:                                                      1105
*      PROCEDURE;                                                  1105
PREPVOL  STM   @14,@12,@SA00008                                    1105
*    OLDERID2 = NEWERID2;                                          1106
         L     @06,@PC00001                                        1106
         L     @06,GDTTR2(,@06)                                    1106
         MVC   @TS00001(95),NEWERID2(@06)                          1106
         MVC   OLDERID2(95,@06),@TS00001                           1106
*    NEWID2 =  'INVL';                                             1107
         MVC   NEWID2(4,@06),@CC00819                              1107
*/*  SET CURRENT ADDRESS TO POINT TO THE FIRST TRACK                 */
*    CTRADDR = 0;                                                  1108
         SLR   @06,@06                                             1108
         ST    @06,CTRADDR                                         1108
*/*  INDICATE THAT THE FIRST TRACK IS A PRIMARY TRACK                */
*    TRACKTYP = PRITRACK;                                          1109
         OI    TRACKTYP,B'10000000'                                1109
*/*  IF MINIMAL INITIALIZATION SPECIFIED                             */
*    IF ADDR(NOCHK) ^= NULLPTR & ADDR(NOVAL) ^= NULLPTR            1110
*/*    THEN                                                          */
*      THEN DO;                                                    1110
*                                                                  1110
         L     @15,@PC00001+4                                      1110
         C     @06,FDTPTR+16(,@15)                                 1110
         BE    @RF01110                                            1110
         C     @06,FDTPTR+60(,@15)                                 1110
         BE    @RF01110                                            1110
*/*      OBTAIN_TRACK_STATUS                                         */
*        CALL OBTTRST (CTRADDR                                     1112
*                     ,DFLAGC                                      1112
*                     ,RZCCHH                                      1112
*                     ,TRACKTYP);                                  1112
         LA    @06,CTRADDR                                         1112
         ST    @06,@AL00001                                        1112
         LA    @06,DFLAGC                                          1112
         ST    @06,@AL00001+4                                      1112
         LA    @06,RZCCHH                                          1112
         ST    @06,@AL00001+8                                      1112
         LA    @06,TRACKTYP                                        1112
         ST    @06,@AL00001+12                                     1112
         LA    @01,@AL00001                                        1112
         BAL   @14,OBTTRST                                         1112
*/*      IF NO SEVERE ERRORS                                         */
*        IF LASTCOND < LASTCC12                                    1113
*/*        THEN                                                      */
*          THEN DO;                                                1113
*                                                                  1113
         L     @06,@PC00001+8                                      1113
         LH    @06,LASTCOND(,@06)                                  1113
         CH    @06,@CH00265                                        1113
         BNL   @RF01113                                            1113
*/*          IF THE DEFECT-FLAG IS FOUND TO BE SET                   */
*            IF DFLAGC = DEFECTIV                                  1115
*/*            THEN RETAIN THE DEFECTIVE CONDITION                   */
*              THEN DO;    FTRKFLG = DEFECTIV; END;                1115
         TM    DFLAGC,B'10000000'                                  1115
         BNO   @RF01115                                            1115
         OI    FTRKFLG,B'10000000'                                 1117
*/*            ELSE RETAIN THE NO-DEFECT CONDITION                   */
*              ELSE DO;    FTRKFLG = NODEFECT; END;                1119
         B     @RC01115                                            1119
@RF01115 DS    0H                                                  1120
         NI    FTRKFLG,B'01111111'                                 1120
*/*          END-THEN                                                */
*            END;                                                  1122
@RC01115 DS    0H                                                  1123
*/*      END-THEN (MINIMAL INITIALIZATION)                           */
*        END;                                                      1123
@RF01113 DS    0H                                                  1124
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        1124
*/*    THEN                                                          */
*      THEN DO;                                                    1124
*                                                                  1124
@RF01110 L     @06,@PC00001+8                                      1124
         LH    @06,LASTCOND(,@06)                                  1124
         CH    @06,@CH00265                                        1124
         BNL   @RF01124                                            1124
*/*      IF THE DEFECT-FLAG IS SET.                                  */
*        IF FTRKFLG = DEFECTIV                                     1126
*/*        THEN                                                      */
*          THEN DO;                                                1126
*                                                                  1126
         TM    FTRKFLG,B'10000000'                                 1126
         BNO   @RF01126                                            1126
*/*          ISSUE MESSAGE (MSGFTRAK) (UPRINT)                       */
*            DARGSENT = MSGFTRAK;                                  1128
         L     @06,DDSTRU                                          1128
         MVI   DARGSENT(@06),X'30'                                 1128
*            CALL ICKTPPR0 (GDTTBL                                 1129
*                   ,PRTFILE                                       1129
*                   ,DDSTRU);                                      1129
         L     @06,@PC00001                                        1129
         ST    @06,@AL00001                                        1129
         LA    @15,@CF00094                                        1129
         ST    @15,@AL00001+4                                      1129
         LA    @15,DDSTRU                                          1129
         ST    @15,@AL00001+8                                      1129
         MVI   @AL00001+8,X'80'                                    1129
         L     @15,GDTPRT(,@06)                                    1129
         LA    @01,@AL00001                                        1129
         BALR  @14,@15                                             1129
*/*          END-THEN                                                */
*            END;                                                  1130
*/*      END-THEN (NO SEVERE ERRORS)                                 */
*        END;                                                      1131
@RF01126 DS    0H                                                  1132
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        1132
*/*    THEN ISSUE_CREATE_VOLUME_LABEL                                */
*      THEN DO;    CALL CREATLAB; END;                             1132
@RF01124 L     @06,@PC00001+8                                      1132
         LH    @06,LASTCOND(,@06)                                  1132
         CH    @06,@CH00265                                        1132
         BNL   @RF01132                                            1132
         BAL   @14,CREATLAB                                        1134
*/*  END-SUB-PROCEDURE PREPARE_VOLUME_LABELS                         */
*                                                                  1136
*                                                                  1136
*    END PREPVOL;                                                  1136
*                                                                  1136
@EL00008 DS    0H                                                  1136
@EF00008 DS    0H                                                  1136
@ER00008 LM    @14,@12,@SA00008                                    1136
         BR    @14                                                 1136
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  PREPVTOC                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  PREPARE VOLUME TABLE OF CONTENTS             */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE EFFECTS THE CREATION OF A VOLUME TABLE     */
*/*    OF CONTENTS ON A PACK.                                        */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1137
*                                                                  1137
*/*  SUB-PROCEDURE PREPARE_VOLUME_TABLE_OF_CONTENTS                  */
*    PREPVTOC:                                                     1137
*      PROCEDURE;                                                  1137
PREPVTOC STM   @14,@12,@SA00009                                    1137
*    OLDERID2 = NEWERID2;                                          1138
         L     @06,@PC00001                                        1138
         L     @06,GDTTR2(,@06)                                    1138
         MVC   @TS00001(95),NEWERID2(@06)                          1138
         MVC   OLDERID2(95,@06),@TS00001                           1138
*    NEWID2 =  'INVT';                                             1139
         MVC   NEWID2(4,@06),@CC00824                              1139
*/*  IF NO AVAILABLE ALTERNATE TRACKS WERE FOUND                     */
*    IF AVAILCNT = 0                                               1140
*/*    THEN RESET POINTER TO THE NEXT AVAILABLE ALTERNATE TRACK      */
*/*     ZERO                                                         */
*      THEN DO;    ALTPTR = 0; END;                                1140
         SLR   @06,@06                                             1140
         C     @06,AVAILCNT                                        1140
         BNE   @RF01140                                            1140
         ST    @06,ALTPTR                                          1142
*/*  CREATE_VOLUME_TABLE_OF_CONTENTS                                 */
*    CALL ICKWV01                                                  1144
*         (GDTTBL                                                  1144
*         ,VOLIB                                                   1144
*         ,VTOCLOC                                                 1144
*         ,VTOCEXT                                                 1144
*         ,ALTCOUNT                                                1144
*         ,ALTPTR                                                  1144
*         ,RETCODE);                                               1144
@RF01140 L     @06,@PC00001                                        1144
         ST    @06,@AL00001                                        1144
         LA    @06,VOLIB                                           1144
         ST    @06,@AL00001+4                                      1144
         LA    @06,VTOCLOC                                         1144
         ST    @06,@AL00001+8                                      1144
         LA    @06,VTOCEXT                                         1144
         ST    @06,@AL00001+12                                     1144
         LA    @06,ALTCOUNT                                        1144
         ST    @06,@AL00001+16                                     1144
         LA    @06,ALTPTR                                          1144
         ST    @06,@AL00001+20                                     1144
         LA    @06,RETCODE                                         1144
         ST    @06,@AL00001+24                                     1144
         L     @15,@CV00825                                        1144
         LA    @01,@AL00001                                        1144
         BALR  @14,@15                                             1144
*/*  IF VTOC CREATION FAILS                                          */
*    IF RETCODE = FAILURE                                          1145
*/*    THEN                                                          */
*      THEN DO;                                                    1145
*                                                                  1145
         CLC   RETCODE(4),@CF00165                                 1145
         BNE   @RF01145                                            1145
*/*      ISSUE ERROR MESSAGE (MSGVTOCC) (UPRINT)                     */
*        DARGSENT = MSGVTOCC;                                      1147
         L     @06,DDSTRU                                          1147
         MVI   DARGSENT(@06),X'05'                                 1147
*        CALL ICKTPPR0 (GDTTBL                                     1148
*               ,PRTFILE                                           1148
*               ,DDSTRU);                                          1148
         L     @06,@PC00001                                        1148
         ST    @06,@AL00001                                        1148
         LA    @15,@CF00094                                        1148
         ST    @15,@AL00001+4                                      1148
         LA    @15,DDSTRU                                          1148
         ST    @15,@AL00001+8                                      1148
         MVI   @AL00001+8,X'80'                                    1148
         L     @15,GDTPRT(,@06)                                    1148
         LA    @01,@AL00001                                        1148
         BALR  @14,@15                                             1148
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      1149
         L     @06,@PC00001+8                                      1149
         MVC   LASTCOND(2,@06),@CH00265                            1149
*/*      END-THEN (VTOC CREATION FAILS)                              */
*        END;                                                      1150
*/*  IF SPECIFIED VTOC LOCATION IS INVALID                           */
*    IF RETCODE = INVTOC                                           1151
*/*    THEN                                                          */
*      THEN DO;                                                    1151
*                                                                  1151
@RF01145 CLC   RETCODE(4),@CF00116                                 1151
         BNE   @RF01151                                            1151
*/*      ISSUE ERROR MESSAGE (MSGVTOCA) (UPRINT)                     */
*        DARGSENT = MSGVTOCA;                                      1153
         L     @06,DDSTRU                                          1153
         MVI   DARGSENT(@06),X'03'                                 1153
*        DARGCNT = 1;                                              1154
         LA    @15,1                                               1154
         STH   @15,DARGCNT(,@06)                                   1154
*        DARGINS (1) = 1;                                          1155
         STH   @15,DARGINS(,@06)                                   1155
*        DARGINL (1) = LENGTH (TRACKVAL);                          1156
         MVC   DARGINL(2,@06),@CH00260                             1156
*        DARGDTM (1) = ADDR (TRACKVAL);                            1157
         L     @15,@PC00001+4                                      1157
         L     @01,FDTPTR+32(,@15)                                 1157
         LA    @15,TRACKVAL(,@01)                                  1157
         ST    @15,DARGDTM(,@06)                                   1157
*        CALL ICKTPPR0 (GDTTBL                                     1158
*               ,PRTFILE                                           1158
*               ,DDSTRU);                                          1158
         L     @06,@PC00001                                        1158
         ST    @06,@AL00001                                        1158
         LA    @15,@CF00094                                        1158
         ST    @15,@AL00001+4                                      1158
         LA    @15,DDSTRU                                          1158
         ST    @15,@AL00001+8                                      1158
         MVI   @AL00001+8,X'80'                                    1158
         L     @15,GDTPRT(,@06)                                    1158
         LA    @01,@AL00001                                        1158
         BALR  @14,@15                                             1158
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      1159
         L     @06,@PC00001+8                                      1159
         MVC   LASTCOND(2,@06),@CH00265                            1159
*/*      END-THEN (VTOC LOCATION INVALID)                            */
*        END;                                                      1160
*/*  IF SPECIFIED EXTENT IS INVALID                                  */
*    IF RETCODE = INEXTENT                                         1161
*/*    THEN                                                          */
*      THEN DO;                                                    1161
*                                                                  1161
@RF01151 CLC   RETCODE(4),@CF00136                                 1161
         BNE   @RF01161                                            1161
*/*      ISSUE ERROR MESSAGE (MSGVTOCB) (UPRINT)                     */
*        DARGSENT = MSGVTOCB;                                      1163
         L     @06,DDSTRU                                          1163
         MVI   DARGSENT(@06),X'04'                                 1163
*        DARGCNT = 1;                                              1164
         LA    @15,1                                               1164
         STH   @15,DARGCNT(,@06)                                   1164
*        DARGINS (1) = 1;                                          1165
         STH   @15,DARGINS(,@06)                                   1165
*        DARGINL (1) = LENGTH (VTOCEXT);                           1166
         MVC   DARGINL(2,@06),@CH00044                             1166
*        DARGDTM (1) = ADDR (VTOCEXT);                             1167
         LA    @15,VTOCEXT                                         1167
         ST    @15,DARGDTM(,@06)                                   1167
*        CALL ICKTPPR0 (GDTTBL                                     1168
*               ,PRTFILE                                           1168
*               ,DDSTRU);                                          1168
         L     @06,@PC00001                                        1168
         ST    @06,@AL00001                                        1168
         LA    @15,@CF00094                                        1168
         ST    @15,@AL00001+4                                      1168
         LA    @15,DDSTRU                                          1168
         ST    @15,@AL00001+8                                      1168
         MVI   @AL00001+8,X'80'                                    1168
         L     @15,GDTPRT(,@06)                                    1168
         LA    @01,@AL00001                                        1168
         BALR  @14,@15                                             1168
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      1169
         L     @06,@PC00001+8                                      1169
         MVC   LASTCOND(2,@06),@CH00265                            1169
*/*      END-THEN (SPECIFIED EXTENT INVALID)                         */
*        END;                                                      1170
*/*  IF UNABLE TO WRITE THE VOLUME LABEL                             */
*    IF RETCODE = NOWLABEL                                         1171
*/*    THEN                                                          */
*      THEN DO;                                                    1171
*                                                                  1171
@RF01161 CLC   RETCODE(4),@CF00044                                 1171
         BNE   @RF01171                                            1171
*/*      ISSUE ERROR MESSAGE (MSGNLAB) (UPRINT)                      */
*        DARGSENT = MSGNLAB;                                       1173
         L     @06,DDSTRU                                          1173
         MVI   DARGSENT(@06),X'1C'                                 1173
*        CALL ICKTPPR0 (GDTTBL                                     1174
*               ,PRTFILE                                           1174
*               ,DDSTRU);                                          1174
         L     @06,@PC00001                                        1174
         ST    @06,@AL00001                                        1174
         LA    @15,@CF00094                                        1174
         ST    @15,@AL00001+4                                      1174
         LA    @15,DDSTRU                                          1174
         ST    @15,@AL00001+8                                      1174
         MVI   @AL00001+8,X'80'                                    1174
         L     @15,GDTPRT(,@06)                                    1174
         LA    @01,@AL00001                                        1174
         BALR  @14,@15                                             1174
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      1175
         L     @06,@PC00001+8                                      1175
         MVC   LASTCOND(2,@06),@CH00265                            1175
*/*      END-THEN (UNABLE TO WRITE THE VOLUME LABEL)                 */
*        END;                                                      1176
*/*  END-SUB-PROCEDURE PREPARE_VOLUME_TABLE_OF_CONTENTS              */
*    END PREPVTOC;                                                 1177
*                                                                  1177
*                                                                  1177
@EL00009 DS    0H                                                  1177
@EF00009 DS    0H                                                  1177
@ER00009 LM    @14,@12,@SA00009                                    1177
         BR    @14                                                 1177
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  COUNTRKS                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  COUNT UNRECOVERABLE TRACKS                   */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE KEEPS TRACK OF THE NUMBER OF UNRECOVERABLE */
*/*    TRACKS ENCOUNTERED. IT WILL CAUSE A TERMINATION IF THE NUMBER */
*/*    OF TRACKS FOUND UNRECOVERABLE EXCEEDS A DESIGN THRESHOLD.     */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1178
*                                                                  1178
*/*  SUB-PROCEDURE COUNT_UNRECOVERABLE_TRACKS                        */
*    COUNTRKS:                                                     1178
*      PROCEDURE;                                                  1178
COUNTRKS STM   @14,@12,@SA00010                                    1178
*    OLDERID2 = NEWERID2;                                          1179
         L     @06,@PC00001                                        1179
         L     @06,GDTTR2(,@06)                                    1179
         MVC   @TS00001(95),NEWERID2(@06)                          1179
         MVC   OLDERID2(95,@06),@TS00001                           1179
*    NEWID2 =  'INUT';                                             1180
*                                                                  1180
         MVC   NEWID2(4,@06),@CC00830                              1180
*/*  IF THE UNRECOVERABLE TRACK IS THE ONE THAT IS BEING PROCESSED   */
*/*   CURRENTLY                                                      */
*    IF UNTRACK = CTRADDR                                          1181
*/*    THEN                                                          */
*      THEN DO;                                                    1181
*                                                                  1181
         CLC   UNTRACK(4),CTRADDR                                  1181
         BNE   @RF01181                                            1181
*/*      SET FLAG TO INDICATE TRACK WAS FOUND TO BE UNRECOVERABLE    */
*        RCVRFLAG = NORCVR;                                        1183
         NI    RCVRFLAG,B'01111111'                                1183
*/*      END-THEN                                                    */
*        END;                                                      1184
*/*  IF TRACK IS THE FIRST TRACK ON THE PACK                         */
*    IF UNTRACK = 0                                                1185
*/*    THEN INDICATE A SEVERE ERROR                                  */
*      THEN DO;    LASTCOND = LASTCC12; END;                       1185
@RF01181 L     @06,UNTRACK                                         1185
         LTR   @06,@06                                             1185
         BNZ   @RF01185                                            1185
         L     @06,@PC00001+8                                      1187
         MVC   LASTCOND(2,@06),@CH00265                            1187
*/*  IF TRACK IS AN ALTERNATE                                        */
*    IF UNTRTYPE = ALTTRACK                                        1189
*/*    THEN                                                          */
*      THEN DO;                                                    1189
*                                                                  1189
@RF01185 TM    UNTRTYPE,B'10000000'                                1189
         BNZ   @RF01189                                            1189
*/*      WRITE ALTERNATE HA WITH DEFECT-FLAG SET                     */
*        CALL ICKDVOP0 (GDTTBL                                     1191
*               ,VOLIB                                             1191
*               ,ACTWAHAD                                          1191
*               ,UNTRACK                                           1191
*               ,RECNUM                                            1191
*               ,POOLID                                            1191
*               ,DATAPTR                                           1191
*               ,DATALEN                                           1191
*               ,RETCODE);                                         1191
         L     @06,@PC00001                                        1191
         ST    @06,@AL00001                                        1191
         LA    @15,VOLIB                                           1191
         ST    @15,@AL00001+4                                      1191
         LA    @15,@CF00255                                        1191
         ST    @15,@AL00001+8                                      1191
         LA    @15,UNTRACK                                         1191
         ST    @15,@AL00001+12                                     1191
         LA    @15,RECNUM                                          1191
         ST    @15,@AL00001+16                                     1191
         LA    @15,POOLID                                          1191
         ST    @15,@AL00001+20                                     1191
         LA    @15,DATAPTR                                         1191
         ST    @15,@AL00001+24                                     1191
         LA    @15,DATALEN                                         1191
         ST    @15,@AL00001+28                                     1191
         LA    @15,RETCODE                                         1191
         ST    @15,@AL00001+32                                     1191
         L     @15,GDTDOP(,@06)                                    1191
         LA    @01,@AL00001                                        1191
         BALR  @14,@15                                             1191
*/*      IF WRITE OPERATION IS SUCCESSFUL                            */
*        IF RETCODE = SUCCESS                                      1192
*/*        THEN                                                      */
*          THEN DO;                                                1192
*                                                                  1192
         SLR   @06,@06                                             1192
         C     @06,RETCODE                                         1192
         BNE   @RF01192                                            1192
*/*          ISSUE_BUILD_PACK_MAP (TRACK WITH DEFECT-FLAG SET)       */
*            PACKDEF  = DEFECTIV;                                  1194
         OI    PACKDEF,B'10000000'                                 1194
*            PACKCHEK = NODEFECT;                                  1195
         NI    PACKCHEK,B'01111111'                                1195
*            PACKRCVR = RCVRYES;                                   1196
         NI    PACKRCVR,B'01111111'                                1196
*            PACKTRK  = ALTTRACK;                                  1197
         NI    PACKTRK,B'01111111'                                 1197
*            PACKTRAK = UNTRACK;                                   1198
         MVC   PACKTRAK(4),UNTRACK                                 1198
*            PACKASC = 0;                                          1199
         ST    @06,PACKASC                                         1199
*            CALL BILDPACK;                                        1200
         BAL   @14,BILDPACK                                        1200
*/*          RETURN                                                  */
*            RETURN;                                               1201
@EL00010 DS    0H                                                  1201
@EF00010 DS    0H                                                  1201
@ER00010 LM    @14,@12,@SA00010                                    1201
         BR    @14                                                 1201
*/*          END-THEN                                                */
*            END;                                                  1202
*/*      END-THEN                                                    */
*        END;                                                      1203
@RF01192 DS    0H                                                  1204
*/*  ISSUE_BUILD_PACK_MAP (TRACK IS UNRECOVERABLE)                   */
*    PACKDEF  = NODEFECT;                                          1204
@RF01189 NI    PACKDEF,B'01111111'                                 1204
*    PACKCHEK = NODEFECT;                                          1205
         NI    PACKCHEK,B'01111111'                                1205
*    PACKRCVR = RCVRNO;                                            1206
         OI    PACKRCVR,B'10000000'                                1206
*    IF UNTRTYPE = PRITRACK                                        1207
*      THEN DO;    PACKTRK = PRITRACK; END;                        1207
         TM    UNTRTYPE,B'10000000'                                1207
         BNO   @RF01207                                            1207
         OI    PACKTRK,B'10000000'                                 1209
*      ELSE DO;    PACKTRK = ALTTRACK; END;                        1211
         B     @RC01207                                            1211
@RF01207 DS    0H                                                  1212
         NI    PACKTRK,B'01111111'                                 1212
*    PACKTRAK = UNTRACK;                                           1214
@RC01207 MVC   PACKTRAK(4),UNTRACK                                 1214
*    PACKASC = 0;                                                  1215
         SLR   @06,@06                                             1215
         ST    @06,PACKASC                                         1215
*    CALL BILDPACK;                                                1216
         BAL   @14,BILDPACK                                        1216
*/*  INCREMENT COUNT OF UNRECOVERABLE TRACKS (COUNTUTR)              */
*    COUNTUTR = COUNTUTR + 1;                                      1217
         LA    @06,1                                               1217
         AL    @06,COUNTUTR                                        1217
         ST    @06,COUNTUTR                                        1217
*/*  WRITE AN ERROR MESSAGE (MSGAUTRK OR MSGPUTRK) (UPRINT)          */
*    IF UNTRTYPE = PRITRACK                                        1218
*      THEN DO;    DARGSENT = MSGPUTRK; END;                       1218
         TM    UNTRTYPE,B'10000000'                                1218
         BNO   @RF01218                                            1218
         L     @06,DDSTRU                                          1220
         MVI   DARGSENT(@06),X'02'                                 1220
*      ELSE DO;    DARGSENT = MSGAUTRK; END;                       1222
         B     @RC01218                                            1222
@RF01218 DS    0H                                                  1223
         L     @06,DDSTRU                                          1223
         MVI   DARGSENT(@06),X'01'                                 1223
*    DARGCNT = 2;                                                  1225
@RC01218 LA    @06,2                                               1225
         L     @15,DDSTRU                                          1225
         STH   @06,DARGCNT(,@15)                                   1225
*    DARGINS (1) = 1;                                              1226
         MVC   DARGINS(2,@15),@CH00165                             1226
*    DARGINL (1) = LENGTH (UNTRACKC);                              1227
         STH   @06,DARGINL(,@15)                                   1227
*    DARGDTM (1) = ADDR (UNTRACKC);                                1228
         LA    @14,UNTRACKC                                        1228
         ST    @14,DARGDTM(,@15)                                   1228
*    DARGINS (2) = 2;                                              1229
         STH   @06,DARGINS+8(,@15)                                 1229
*    DARGINL (2) = LENGTH (UNTRACKT);                              1230
         STH   @06,DARGINL+8(,@15)                                 1230
*    DARGDTM (2) = ADDR (UNTRACKT);                                1231
         LA    @06,UNTRACKT                                        1231
         ST    @06,DARGDTM+8(,@15)                                 1231
*    CALL ICKTPPR0 (GDTTBL                                         1232
*           ,PRTFILE                                               1232
*           ,DDSTRU);                                              1232
         L     @06,@PC00001                                        1232
         ST    @06,@AL00001                                        1232
         LA    @15,@CF00094                                        1232
         ST    @15,@AL00001+4                                      1232
         LA    @15,DDSTRU                                          1232
         ST    @15,@AL00001+8                                      1232
         MVI   @AL00001+8,X'80'                                    1232
         L     @15,GDTPRT(,@06)                                    1232
         LA    @01,@AL00001                                        1232
         BALR  @14,@15                                             1232
*/*  INDICATE AN ERROR                                               */
*    LASTCOND = MAX(LASTCC08,LASTCOND);                            1233
         L     @06,@PC00001+8                                      1233
         LH    @15,LASTCOND(,@06)                                  1233
         LA    @14,8                                               1233
         CR    @15,@14                                             1233
         BNL   *+6
         LR    @15,@14                                             1233
         STH   @15,LASTCOND(,@06)                                  1233
*/*  IF COUNT OF UNRECOVERABLE TRACKS MEETS THRESHOLD                */
*    IF COUNTUTR >= THRESHLD                                       1234
*/*    THEN                                                          */
*      THEN DO;                                                    1234
*                                                                  1234
         L     @06,COUNTUTR                                        1234
         L     @01,INFOPTR                                         1234
         C     @06,THRESHLD(,@01)                                  1234
         BL    @RF01234                                            1234
*/*      ISSUE ERROR MESSAGE (MSGTHRSH) (UPRINT)                     */
*        DARGSENT = MSGTHRSH;                                      1236
         L     @06,DDSTRU                                          1236
         MVI   DARGSENT(@06),X'0E'                                 1236
*        CALL ICKTPPR0 (GDTTBL                                     1237
*               ,PRTFILE                                           1237
*               ,DDSTRU);                                          1237
         L     @06,@PC00001                                        1237
         ST    @06,@AL00001                                        1237
         LA    @15,@CF00094                                        1237
         ST    @15,@AL00001+4                                      1237
         LA    @15,DDSTRU                                          1237
         ST    @15,@AL00001+8                                      1237
         MVI   @AL00001+8,X'80'                                    1237
         L     @15,GDTPRT(,@06)                                    1237
         LA    @01,@AL00001                                        1237
         BALR  @14,@15                                             1237
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      1238
         L     @06,@PC00001+8                                      1238
         MVC   LASTCOND(2,@06),@CH00265                            1238
*/*      END-THEN                                                    */
*        END;                                                      1239
*/*  END-SUB-PROCEDURE COUNT_UNRECOVERABLE_TRACKS                    */
*    END COUNTRKS;                                                 1240
*                                                                  1240
         B     @EL00010                                            1240
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  OBTTRST                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  OBTAIN TRACK STATUS                          */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL OBTAIN THE STATUS OF THE TRACK        */
*/*    AS INDICATED BY THE HOME-ADDRESS AND THE STANDARD-LENGTH      */
*/*    RECORD-ZERO. THIS STATUS IS OBTAINED BY INVOKING A DEVICE     */
*/*    ADAPTER FACILITY (UDEVOP).                                    */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1241
*                                                                  1241
*/*  SUB-PROCEDURE OBTAIN_TRACK_STATUS                               */
*    OBTTRST:                                                      1241
*      PROCEDURE                                                   1241
*        (                                                         1241
*        TRKADDR,                                                  1241
*        DFLAG,                                                    1241
*        RZADDR,                                                   1241
*        OBTRTYPE                                                  1241
*        );                                                        1241
OBTTRST  STM   @14,@12,@SA00011                                    1241
         MVC   @PC00011(16),0(@01)                                 1241
*    OLDERID2 = NEWERID2;                                          1242
         L     @06,@PC00001                                        1242
         L     @15,GDTTR2(,@06)                                    1242
         MVC   @TS00001(95),NEWERID2(@15)                          1242
         MVC   OLDERID2(95,@15),@TS00001                           1242
*    NEWID2 =  'INOT';                                             1243
*                                                                  1243
         MVC   NEWID2(4,@15),@CC00842                              1243
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/
*                                                                  1244
*      1 TRKADDR,            /* ADDRESS OF TRACK TO BE EXAMINED      */
*                                                                  1244
*        2 TRKADDRC          /* CYLINDER NUMBER                      */
*                            FIXED (16),                           1244
*                                                                  1244
*        2 TRKADDRH          /* TRACK NUMBER                         */
*                            FIXED (16),                           1244
*                                                                  1244
*      DFLAG                 /* DEFECT-FLAG INDICATOR                */
*                            /* DEFECTIV: DEFECT-FLAG SET            */
*                            /* NODEFECT: DEFECT-FLAG NOT SET        */
*                            BIT (1),                              1244
*                                                                  1244
*      RFLAG                 /* FLAG TO INDICATE IF TRACK IS         */
*                            /* RECOVERABLE OR NOT                   */
*                            /* RECOVER: RECOVERABLE                 */
*                            /* NORCVR: UNRECOVERABLE                */
*                            BIT (1),                              1244
*                                                                  1244
*      OBTRCODE              /* RETURN CODE FROM CALLED PROGRAMS     */
*                            /* WHEN SAVED FOR FURTHER PROCESSING    */
*                            FIXED (31),                           1244
*                                                                  1244
*      OBTRTYPE              /* FLAG TO INDICATE IF THE TRACK IS     */
*                            /* A PRIMARY OR AN ALTERNATE            */
*                            /* PRITRACK: PRIMARY                    */
*                            /* ALTTRACK: ALTERNATE                  */
*                            BIT (1),                              1244
*                                                                  1244
*      RZADDR                /* CCHH FROM R0 COUNT FIELD             */
*                            CHAR(4);                              1244
*                                                                  1244
*/*  SET FLAG TO INDICATE THE TRACK IS CURRENTLY RECOVERABLE         */
*    RFLAG = RECOVER;                                              1245
         OI    RFLAG,B'10000000'                                   1245
*/*  READ HOME-ADDRESS (TO OBTAIN THE DEFECT-FLAG) (UDEVOP)          */
*    CALL ICKDVOP0 (GDTTBL                                         1246
*           ,VOLIB                                                 1246
*           ,ACTRDHA                                               1246
*           ,TRKADDR                                               1246
*           ,RECNUM                                                1246
*           ,POOLID                                                1246
*           ,HAPTR                                                 1246
*           ,HALEN                                                 1246
*           ,OBTRCODE);                                            1246
         ST    @06,@AL00001                                        1246
         LA    @15,VOLIB                                           1246
         ST    @15,@AL00001+4                                      1246
         LA    @15,@CF00165                                        1246
         ST    @15,@AL00001+8                                      1246
         L     @15,@PC00011                                        1246
         ST    @15,@AL00001+12                                     1246
         LA    @15,RECNUM                                          1246
         ST    @15,@AL00001+16                                     1246
         LA    @15,POOLID                                          1246
         ST    @15,@AL00001+20                                     1246
         LA    @15,HAPTR                                           1246
         ST    @15,@AL00001+24                                     1246
         LA    @15,HALEN                                           1246
         ST    @15,@AL00001+28                                     1246
         LA    @15,OBTRCODE                                        1246
         ST    @15,@AL00001+32                                     1246
         L     @15,GDTDOP(,@06)                                    1246
         LA    @01,@AL00001                                        1246
         BALR  @14,@15                                             1246
*/*  IF READ OPERATION FAILS                                         */
*    IF OBTRCODE = CPFAILS                                         1247
*/*    THEN                                                          */
*      THEN DO;                                                    1247
*                                                                  1247
         CLC   OBTRCODE(4),@CF00044                                1247
         BNE   @RF01247                                            1247
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        UNTRACK = TRKADDR;                                        1249
         L     @06,@PC00011                                        1249
         MVC   UNTRACK(4),TRKADDR(@06)                             1249
*        IF OBTRTYPE = PRITRACK                                    1250
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1250
         L     @06,@PC00011+12                                     1250
         TM    OBTRTYPE(@06),B'10000000'                           1250
         BNO   @RF01250                                            1250
         OI    UNTRTYPE,B'10000000'                                1252
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1254
         B     @RC01250                                            1254
@RF01250 DS    0H                                                  1255
         NI    UNTRTYPE,B'01111111'                                1255
*        CALL COUNTRKS;                                            1257
@RC01250 BAL   @14,COUNTRKS                                        1257
*/*      IF TRACK IS AN ALTERNATE                                    */
*        IF OBTRTYPE = ALTTRACK                                    1258
*/*        THEN DECREMENT NUMBER OF AVAILABLE ALTERNATE TRACKS       */
*/*         BY ONE (ALTCOUNT)                                        */
*          THEN DO;    ALTCOUNT = ALTCOUNT - 1; END;               1258
         L     @06,@PC00011+12                                     1258
         TM    OBTRTYPE(@06),B'10000000'                           1258
         BNZ   @RF01258                                            1258
         L     @06,ALTCOUNT                                        1260
         BCTR  @06,0                                               1260
         ST    @06,ALTCOUNT                                        1260
*/*      END-THEN                                                    */
*        END;                                                      1262
*/*    ELSE (TRACK WAS NOT UNRECOVERABLE)                            */
*      ELSE DO;                                                    1263
*                                                                  1263
         B     @RC01247                                            1263
@RF01247 DS    0H                                                  1264
*/*      IF THE DEFECT-FLAG WAS FOUND TO BE SET                      */
*        IF OBTRCODE = DFLAGONP  OBTRCODE = DFLAGONA              1264
*/*        THEN SAVE THE DEFECT-FLAG SETTING                         */
*          THEN DO;    DFLAG = DEFECTIV; END;                      1264
         L     @06,OBTRCODE                                        1264
         CH    @06,@CH00116                                        1264
         BE    @RT01264                                            1264
         CH    @06,@CH00119                                        1264
         BNE   @RF01264                                            1264
@RT01264 DS    0H                                                  1265
         L     @06,@PC00011+4                                      1266
         OI    DFLAG(@06),B'10000000'                              1266
*/*        ELSE INDICATE THAT THE DEFECT-FLAG IS NOT SET             */
*          ELSE DO;    DFLAG = NODEFECT; END;                      1268
         B     @RC01264                                            1268
@RF01264 DS    0H                                                  1269
         L     @06,@PC00011+4                                      1269
         NI    DFLAG(@06),B'01111111'                              1269
*/*      READ STANDARD-LENGTH R0 (TO OBTAIN ASSOCIATION)             */
*        CALL ICKDVOP0 (GDTTBL                                     1271
*               ,VOLIB                                             1271
*               ,ACTRDRZ                                           1271
*               ,TRKADDR                                           1271
*               ,RECNUM                                            1271
*               ,'INRZ'                                            1271
*               ,RZPTR                                             1271
*               ,RZLEN                                             1271
*               ,RETCODE);                                         1271
@RC01264 L     @06,@PC00001                                        1271
         ST    @06,@AL00001                                        1271
         LA    @15,VOLIB                                           1271
         ST    @15,@AL00001+4                                      1271
         LA    @15,@CF00116                                        1271
         ST    @15,@AL00001+8                                      1271
         L     @15,@PC00011                                        1271
         ST    @15,@AL00001+12                                     1271
         LA    @15,RECNUM                                          1271
         ST    @15,@AL00001+16                                     1271
         LA    @15,@CC00847                                        1271
         ST    @15,@AL00001+20                                     1271
         LA    @15,RZPTR                                           1271
         ST    @15,@AL00001+24                                     1271
         LA    @15,RZLEN                                           1271
         ST    @15,@AL00001+28                                     1271
         LA    @15,RETCODE                                         1271
         ST    @15,@AL00001+32                                     1271
         L     @15,GDTDOP(,@06)                                    1271
         LA    @01,@AL00001                                        1271
         BALR  @14,@15                                             1271
*/*      IF READ OPERATION FAILS                                     */
*        IF RETCODE = CPFAILS                                      1272
*/*        THEN                                                      */
*          THEN DO;                                                1272
*                                                                  1272
         CLC   RETCODE(4),@CF00044                                 1272
         BNE   @RF01272                                            1272
*/*          COUNT_UNRECOVERABLE_TRACKS                              */
*            UNTRACK = TRKADDR;                                    1274
         L     @06,@PC00011                                        1274
         MVC   UNTRACK(4),TRKADDR(@06)                             1274
*            IF OBTRTYPE = PRITRACK                                1275
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1275
         L     @06,@PC00011+12                                     1275
         TM    OBTRTYPE(@06),B'10000000'                           1275
         BNO   @RF01275                                            1275
         OI    UNTRTYPE,B'10000000'                                1277
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1279
         B     @RC01275                                            1279
@RF01275 DS    0H                                                  1280
         NI    UNTRTYPE,B'01111111'                                1280
*            CALL COUNTRKS;                                        1282
@RC01275 BAL   @14,COUNTRKS                                        1282
*/*          IF TRACK IS AN ALTERNATE                                */
*            IF OBTRTYPE = ALTTRACK                                1283
*/*            THEN DECREMENT COUNT OF AVAILABLE ALTERNATE TRACKS    */
*/*             BY ONE (ALTCOUNT)                                    */
*              THEN DO;    ALTCOUNT = ALTCOUNT - 1; END;           1283
         L     @06,@PC00011+12                                     1283
         TM    OBTRTYPE(@06),B'10000000'                           1283
         BNZ   @RF01283                                            1283
         L     @06,ALTCOUNT                                        1285
         BCTR  @06,0                                               1285
         ST    @06,ALTCOUNT                                        1285
*/*          END-THEN                                                */
*            END;                                                  1287
*/*        ELSE                                                      */
*          ELSE DO;                                                1288
*                                                                  1288
         B     @RC01272                                            1288
@RF01272 DS    0H                                                  1289
*/*          SAVE THE ASSOCIATION ADDRESS                            */
*            RZADDR = RZADDROB;                                    1289
         L     @06,@PC00011+8                                      1289
         L     @01,RZPTR                                           1289
         MVC   RZADDR(4,@06),RZADDROB(@01)                         1289
*/*          IF THE DEFECT-FLAG IS SET DUE TO RECOVERY               */
*            IF (RETCODE = DFLAGONP)  (RETCODE = DFLAGONA)        1290
*/*            THEN SAVE THE DEFECT-FLAG SETTING                     */
*              THEN DO;    DFLAG = DEFECTIV; END;                  1290
         L     @06,RETCODE                                         1290
         CH    @06,@CH00116                                        1290
         BE    @RT01290                                            1290
         CH    @06,@CH00119                                        1290
         BNE   @RF01290                                            1290
@RT01290 DS    0H                                                  1291
         L     @06,@PC00011+4                                      1292
         OI    DFLAG(@06),B'10000000'                              1292
*/*          IF PHYSICAL STATE OF TRACK ON PACK DOES NOT AGREE WITH  */
*/*           THE THEORETICAL STATE                                  */
*            IF ((OBTRTYPE = PRITRACK) & (OBTRCODE = DFLAGONA     1294
*             OBTRCODE = DFLAGOFA))  ((OBTRTYPE = ALTTRACK) &     1294
*             (OBTRCODE = DFLAGONP  OBTRCODE = DFLAGOFP))         1294
*/*            THEN                                                  */
*              THEN DO;                                            1294
*                                                                  1294
@RF01290 L     @06,@PC00011+12                                     1294
         TM    OBTRTYPE(@06),B'10000000'                           1294
         BNO   @GL00049                                            1294
         L     @06,OBTRCODE                                        1294
         CH    @06,@CH00119                                        1294
         BE    @RT01294                                            1294
         CH    @06,@CH00185                                        1294
         BE    @RT01294                                            1294
@GL00049 L     @06,@PC00011+12                                     1294
         TM    OBTRTYPE(@06),B'10000000'                           1294
         BNZ   @RF01294                                            1294
         L     @06,OBTRCODE                                        1294
         CH    @06,@CH00116                                        1294
         BE    @RT01294                                            1294
         CH    @06,@CH00136                                        1294
         BNE   @RF01294                                            1294
@RT01294 DS    0H                                                  1295
*/*              ESTABLISH_TRACK_INTEGRITY                           */
*                CALL ESTTRINT (TRKADDR                            1296
*                              ,RZADDR                             1296
*                              ,DFLAG                              1296
*                              ,RFLAG                              1296
*                              ,OBTRCODE                           1296
*                              ,OBTRTYPE);                         1296
         L     @06,@PC00011                                        1296
         ST    @06,@AL00001                                        1296
         L     @06,@PC00011+8                                      1296
         ST    @06,@AL00001+4                                      1296
         L     @06,@PC00011+4                                      1296
         ST    @06,@AL00001+8                                      1296
         LA    @06,RFLAG                                           1296
         ST    @06,@AL00001+12                                     1296
         LA    @06,OBTRCODE                                        1296
         ST    @06,@AL00001+16                                     1296
         L     @06,@PC00011+12                                     1296
         ST    @06,@AL00001+20                                     1296
         LA    @01,@AL00001                                        1296
         BAL   @14,ESTTRINT                                        1296
*/*              END-THEN                                            */
*                END;                                              1297
*/*          END-ELSE                                                */
*            END;                                                  1298
@RF01294 DS    0H                                                  1299
*/*      FREE THE STORAGE OBTAINED BY UDEVOP                         */
*        CALL ICKSAFP0 (GDTTBL                                     1299
*               ,'INRZ');                                          1299
@RC01272 L     @06,@PC00001                                        1299
         ST    @06,@AL00001                                        1299
         LA    @15,@CC00847                                        1299
         ST    @15,@AL00001+4                                      1299
         MVI   @AL00001+4,X'80'                                    1299
         L     @15,GDTFPL(,@06)                                    1299
         LA    @01,@AL00001                                        1299
         BALR  @14,@15                                             1299
*/*      END-ELSE (READ HA WAS SUCCESSFUL)                           */
*        END;                                                      1300
*/*  END-SUB-PROCEDURE OBTAIN_TRACK_STATUS                           */
*    END OBTTRST;                                                  1301
*                                                                  1301
@EL00011 DS    0H                                                  1301
@EF00011 DS    0H                                                  1301
@ER00011 LM    @14,@12,@SA00011                                    1301
         BR    @14                                                 1301
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  VALTRACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  VALIDATE TRACK                               */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE CHECKS THE VALIDITY OF THE HOME-ADDRESS    */
*/*    AND THE STANDARD-LENGTH RECORD-ZERO.                          */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1302
*                                                                  1302
*/*  SUB-PROCEDURE VALIDATE_TRACK                                    */
*    VALTRACK:                                                     1302
*      PROCEDURE;                                                  1302
VALTRACK STM   @14,@12,@SA00012                                    1302
*    OLDERID2 = NEWERID2;                                          1303
         L     @06,@PC00001                                        1303
         L     @06,GDTTR2(,@06)                                    1303
         MVC   @TS00001(95),NEWERID2(@06)                          1303
         MVC   OLDERID2(95,@06),@TS00001                           1303
*    NEWID2 =  'INVA';                                             1304
         MVC   NEWID2(4,@06),@CC00852                              1304
*/*  IF TRACK IS A PRIMARY                                           */
*    IF TRACKTYP = PRITRACK                                        1305
*/*    THEN SET ACTION KEY FOR VALIDATION OF PRIMARY TRACK           */
*      THEN DO;    VAACTION = ACTVPHA; END;                        1305
         TM    TRACKTYP,B'10000000'                                1305
         BNO   @RF01305                                            1305
         MVC   VAACTION(4),@CF00267                                1307
*/*    ELSE SET ACTION KEY FOR VALIDATION OF ALTERNATE TRACK         */
*      ELSE DO;    VAACTION = ACTVAHA; END;                        1309
         B     @RC01305                                            1309
@RF01305 DS    0H                                                  1310
         MVC   VAACTION(4),@CF00274                                1310
*/*  VALIDATE HOME-ADDRESS (UDEVOP)                                  */
*    CALL ICKDVOP0 (GDTTBL                                         1312
*           ,VOLIB                                                 1312
*           ,VAACTION                                              1312
*           ,CTRADDR                                               1312
*           ,RECNUM                                                1312
*           ,POOLID                                                1312
*           ,HAPTR                                                 1312
*           ,HALEN                                                 1312
*           ,RETCODE);                                             1312
@RC01305 L     @06,@PC00001                                        1312
         ST    @06,@AL00001                                        1312
         LA    @15,VOLIB                                           1312
         ST    @15,@AL00001+4                                      1312
         LA    @15,VAACTION                                        1312
         ST    @15,@AL00001+8                                      1312
         LA    @15,CTRADDR                                         1312
         ST    @15,@AL00001+12                                     1312
         LA    @15,RECNUM                                          1312
         ST    @15,@AL00001+16                                     1312
         LA    @15,POOLID                                          1312
         ST    @15,@AL00001+20                                     1312
         LA    @15,HAPTR                                           1312
         ST    @15,@AL00001+24                                     1312
         LA    @15,HALEN                                           1312
         ST    @15,@AL00001+28                                     1312
         LA    @15,RETCODE                                         1312
         ST    @15,@AL00001+32                                     1312
         L     @15,GDTDOP(,@06)                                    1312
         LA    @01,@AL00001                                        1312
         BALR  @14,@15                                             1312
*/*  IF VALIDATION FAILS                                             */
*    IF RETCODE = CPFAILS                                          1313
*/*    THEN                                                          */
*      THEN DO;                                                    1313
*                                                                  1313
         CLC   RETCODE(4),@CF00044                                 1313
         BNE   @RF01313                                            1313
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        IF TRACKTYP = PRITRACK                                    1315
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1315
         TM    TRACKTYP,B'10000000'                                1315
         BNO   @RF01315                                            1315
         OI    UNTRTYPE,B'10000000'                                1317
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1319
         B     @RC01315                                            1319
@RF01315 DS    0H                                                  1320
         NI    UNTRTYPE,B'01111111'                                1320
*        UNTRACK = CTRADDR;                                        1322
@RC01315 MVC   UNTRACK(4),CTRADDR                                  1322
*        CALL COUNTRKS;                                            1323
         BAL   @14,COUNTRKS                                        1323
*/*      IF TRACK IS AN ALTERNATE                                    */
*        IF TRACKTYP = ALTTRACK                                    1324
*/*        THEN DECREMENT ALTCOUNT BY ONE                            */
*          THEN DO;    ALTCOUNT = ALTCOUNT - 1; END;               1324
         TM    TRACKTYP,B'10000000'                                1324
         BNZ   @RF01324                                            1324
         L     @06,ALTCOUNT                                        1326
         BCTR  @06,0                                               1326
         ST    @06,ALTCOUNT                                        1326
*/*      END-THEN (VALIDATION FAILS)                                 */
*        END;                                                      1328
*/*    ELSE (HOME-ADDRESS IS VALID)                                  */
*      ELSE DO;                                                    1329
*                                                                  1329
         B     @RC01313                                            1329
@RF01313 DS    0H                                                  1330
*/*      IF TRACK IS STILL RECOVERABLE                               */
*        IF RCVRFLAG = RECOVER                                     1330
*/*        THEN                                                      */
*          THEN DO;                                                1330
*                                                                  1330
         TM    RCVRFLAG,B'10000000'                                1330
         BNO   @RF01330                                            1330
*/*          IF THE DEFECT-FLAG WAS FOUND TO BE SET                  */
*            IF RETCODE = DFLAGONP  RETCODE = DFLAGONA            1332
*/*            THEN SAVE THE DEFECT-FLAG SETTING                     */
*              THEN DO;    DFLAGC = DEFECTIV; END;                 1332
         L     @06,RETCODE                                         1332
         CH    @06,@CH00116                                        1332
         BE    @RT01332                                            1332
         CH    @06,@CH00119                                        1332
         BNE   @RF01332                                            1332
@RT01332 DS    0H                                                  1333
         OI    DFLAGC,B'10000000'                                  1334
*/*            ELSE INDICATE THAT THE DEFECT-FLAG IS NOT SET         */
*              ELSE DO;    DFLAGC = NODEFECT; END;                 1336
         B     @RC01332                                            1336
@RF01332 DS    0H                                                  1337
         NI    DFLAGC,B'01111111'                                  1337
*/*          IF MEDIAL INITIALIZATION WAS REQUESTED                  */
*            IF ADDR(CHECK) = NULLPTR                              1339
*/*            THEN (MEDIAL INITIALIZATION)                          */
*              THEN DO;                                            1339
@RC01332 L     @06,@PC00001+4                                      1339
         L     @06,FDTPTR+12(,@06)                                 1339
         LTR   @06,@06                                             1339
         BNZ   @RF01339                                            1339
*/*              WRITE A STANDARD-LENGTH RECORD ZERO                 */
*                CALL ICKDVOP0 (GDTTBL                             1341
*                       ,VOLIB                                     1341
*                       ,ACTWRZS                                   1341
*                       ,CTRADDR                                   1341
*                       ,RECNUM                                    1341
*                       ,POOLID                                    1341
*                       ,ADDR(CTRADDR)                             1341
*                       ,LENGTH (CTRADDR)                          1341
*                       ,RETCODE);                                 1341
         L     @06,@PC00001                                        1341
         ST    @06,@AL00001                                        1341
         LA    @15,VOLIB                                           1341
         ST    @15,@AL00001+4                                      1341
         LA    @15,@CF00161                                        1341
         ST    @15,@AL00001+8                                      1341
         LA    @15,CTRADDR                                         1341
         ST    @15,@AL00001+12                                     1341
         LA    @15,RECNUM                                          1341
         ST    @15,@AL00001+16                                     1341
         LA    @15,POOLID                                          1341
         ST    @15,@AL00001+20                                     1341
         LA    @15,CTRADDR                                         1341
         ST    @15,@AFTEMPS                                        1341
         LA    @15,@AFTEMPS                                        1341
         ST    @15,@AL00001+24                                     1341
         LA    @15,@CF00044                                        1341
         ST    @15,@AL00001+28                                     1341
         LA    @15,RETCODE                                         1341
         ST    @15,@AL00001+32                                     1341
         L     @15,GDTDOP(,@06)                                    1341
         LA    @01,@AL00001                                        1341
         BALR  @14,@15                                             1341
*/*              IF VALIDATION FAILS                                 */
*                IF RETCODE = CPFAILS                              1342
*/*                THEN                                              */
*                  THEN DO;                                        1342
*                                                                  1342
         CLC   RETCODE(4),@CF00044                                 1342
         BNE   @RF01342                                            1342
*/*                  COUNT_UNRECOVERABLE_TRACKS                      */
*                    IF TRACKTYP = PRITRACK                        1344
*                      THEN UNTRTYPE = PRITRACK;                   1344
         TM    TRACKTYP,B'10000000'                                1344
         BNO   @RF01344                                            1344
         OI    UNTRTYPE,B'10000000'                                1345
*                      ELSE UNTRTYPE = ALTTRACK;                   1346
         B     @RC01344                                            1346
@RF01344 NI    UNTRTYPE,B'01111111'                                1346
*                    UNTRACK = CTRADDR;                            1347
@RC01344 MVC   UNTRACK(4),CTRADDR                                  1347
*                    CALL COUNTRKS;                                1348
         BAL   @14,COUNTRKS                                        1348
*/*                  IF TRACK IS AN ALTERNATE                        */
*                    IF TRACKTYP = ALTTRACK                        1349
*/*                    THEN DECREMENT COUNT OF AVAILABLE ALTERNATE   */
*/*                     TRACKS BY ONE (ALTCOUNT)                     */
*                      THEN DO;    ALTCOUNT = ALTCOUNT - 1;        1349
         TM    TRACKTYP,B'10000000'                                1349
         BNZ   @RF01349                                            1349
         L     @06,ALTCOUNT                                        1351
         BCTR  @06,0                                               1351
         ST    @06,ALTCOUNT                                        1351
*                        END;                                      1352
*/*                  END-THEN (VALIDATION FAILS)                     */
*                    END;                                          1353
*/*                ELSE                                              */
*                  ELSE DO;                                        1354
*                                                                  1354
         B     @RC01342                                            1354
@RF01342 DS    0H                                                  1355
*/*                  IF THE DEFECT-FLAG IS SET DUE TO RECOVERY       */
*                    IF RETCODE = DFLAGONP  RETCODE = DFLAGONA    1355
*/*                    THEN SAVE THE DEFECT-FLAG SETTING             */
*                      THEN DO;    DFLAGC = DEFECTIV; END;         1355
         L     @06,RETCODE                                         1355
         CH    @06,@CH00116                                        1355
         BE    @RT01355                                            1355
         CH    @06,@CH00119                                        1355
         BNE   @RF01355                                            1355
@RT01355 DS    0H                                                  1356
         OI    DFLAGC,B'10000000'                                  1357
*/*                  END-ELSE                                        */
*                    END;                                          1359
*/*              END-THEN  (MEDIAL INITIALIZATION)                   */
*                END;                                              1360
*/*          END-THEN (TRACK IS RECOVERABLE)                         */
*            END;                                                  1361
*/*      END-ELSE (HOME-ADDRESS IS VALID)                            */
*        END;                                                      1362
*/*  END-SUB-PROCEDURE VALIDATE_TRACK                                */
*    END VALTRACK;                                                 1363
*                                                                  1363
@EL00012 DS    0H                                                  1363
@EF00012 DS    0H                                                  1363
@ER00012 LM    @14,@12,@SA00012                                    1363
         BR    @14                                                 1363
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  VALHOME                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  VALIDATE_HOME-ADDRESS                        */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE CHECKS THE VALIDITY OF THE HOME-ADDRESS    */
*/*    ONLY FOR MINIMAL INITIALIZATION AND RETURNS THE DEFECT-FLAG   */
*/*    SETTING.                                                      */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1364
*                                                                  1364
*/*  SUB-PROCEDURE VALIDATE_HOME-ADDRESS                             */
*    VALHOME:                                                      1364
*      PROCEDURE                                                   1364
*        (VALADDR                                                  1364
*        ,DFLAGV                                                   1364
*        ,VALTRTYP);                                               1364
VALHOME  STM   @14,@12,@SA00013                                    1364
         MVC   @PC00013(12),0(@01)                                 1364
*    OLDERID2 = NEWERID2;                                          1365
         L     @06,@PC00001                                        1365
         L     @06,GDTTR2(,@06)                                    1365
         MVC   @TS00001(95),NEWERID2(@06)                          1365
         MVC   OLDERID2(95,@06),@TS00001                           1365
*    NEWID2 =  'INVA';                                             1366
         MVC   NEWID2(4,@06),@CC00852                              1366
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/
*                                                                  1367
*      1 VALADDR,            /* ADDRESS OF TRACK TO BE EXAMINED      */
*                                                                  1367
*        2 VALADDRC          /* CYLINDER NUMBER                      */
*                            FIXED (16),                           1367
*                                                                  1367
*        2 VALADDRH          /* TRACK NUMBER                         */
*                            FIXED (16),                           1367
*                                                                  1367
*      DFLAGV                /* DEFECT-FLAG INDICATOR                */
*                            /* DEFECTIV: DEFECT-FLAG SET            */
*                            /* NODEFECT: DEFECT-FLAG NOT SET        */
*                            BIT (1),                              1367
*                                                                  1367
*      VALTRTYP              /* FLAG TO INDICATE IF THE TRACK IS     */
*                            /* A PRIMARY OR AN ALTERNATE            */
*                            /* PRITRACK: PRIMARY                    */
*                            /* ALTTRACK: ALTERNATE                  */
*                            BIT (1);                              1367
*                                                                  1367
*/*  IF TRACK IS A PRIMARY                                           */
*    IF VALTRTYP = PRITRACK                                        1368
*/*    THEN SET ACTION KEY FOR VALIDATION OF PRIMARY TRACK           */
*      THEN DO;    VAACTION = ACTVPHA; END;                        1368
         L     @06,@PC00013+8                                      1368
         TM    VALTRTYP(@06),B'10000000'                           1368
         BNO   @RF01368                                            1368
         MVC   VAACTION(4),@CF00267                                1370
*/*    ELSE SET ACTION KEY FOR VALIDATION OF ALTERNATE TRACK         */
*      ELSE DO;    VAACTION = ACTVAHA; END;                        1372
         B     @RC01368                                            1372
@RF01368 DS    0H                                                  1373
         MVC   VAACTION(4),@CF00274                                1373
*/*  VALIDATE HOME-ADDRESS (UDEVOP)                                  */
*    CALL ICKDVOP0 (GDTTBL                                         1375
*           ,VOLIB                                                 1375
*           ,VAACTION                                              1375
*           ,VALADDR                                               1375
*           ,RECNUM                                                1375
*           ,POOLID                                                1375
*           ,HAPTR                                                 1375
*           ,HALEN                                                 1375
*           ,RETCODE);                                             1375
@RC01368 L     @06,@PC00001                                        1375
         ST    @06,@AL00001                                        1375
         LA    @15,VOLIB                                           1375
         ST    @15,@AL00001+4                                      1375
         LA    @15,VAACTION                                        1375
         ST    @15,@AL00001+8                                      1375
         L     @15,@PC00013                                        1375
         ST    @15,@AL00001+12                                     1375
         LA    @15,RECNUM                                          1375
         ST    @15,@AL00001+16                                     1375
         LA    @15,POOLID                                          1375
         ST    @15,@AL00001+20                                     1375
         LA    @15,HAPTR                                           1375
         ST    @15,@AL00001+24                                     1375
         LA    @15,HALEN                                           1375
         ST    @15,@AL00001+28                                     1375
         LA    @15,RETCODE                                         1375
         ST    @15,@AL00001+32                                     1375
         L     @15,GDTDOP(,@06)                                    1375
         LA    @01,@AL00001                                        1375
         BALR  @14,@15                                             1375
*/*  IF VALIDATION FAILS                                             */
*    IF RETCODE = CPFAILS                                          1376
*/*    THEN                                                          */
*      THEN DO;                                                    1376
*                                                                  1376
         CLC   RETCODE(4),@CF00044                                 1376
         BNE   @RF01376                                            1376
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        IF VALTRTYP = PRITRACK                                    1378
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1378
         L     @06,@PC00013+8                                      1378
         TM    VALTRTYP(@06),B'10000000'                           1378
         BNO   @RF01378                                            1378
         OI    UNTRTYPE,B'10000000'                                1380
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1382
         B     @RC01378                                            1382
@RF01378 DS    0H                                                  1383
         NI    UNTRTYPE,B'01111111'                                1383
*        UNTRACK = CTRADDR;                                        1385
@RC01378 MVC   UNTRACK(4),CTRADDR                                  1385
*        CALL COUNTRKS;                                            1386
         BAL   @14,COUNTRKS                                        1386
*/*      IF TRACK IS AN ALTERNATE                                    */
*        IF VALTRTYP = ALTTRACK                                    1387
*/*        THEN DECREMENT ALTCOUNT BY ONE                            */
*          THEN DO;    ALTCOUNT = ALTCOUNT - 1; END;               1387
         L     @06,@PC00013+8                                      1387
         TM    VALTRTYP(@06),B'10000000'                           1387
         BNZ   @RF01387                                            1387
         L     @06,ALTCOUNT                                        1389
         BCTR  @06,0                                               1389
         ST    @06,ALTCOUNT                                        1389
*/*      END-THEN (VALIDATION FAILS)                                 */
*        END;                                                      1391
*/*    ELSE (HOME-ADDRESS IS VALID)                                  */
*      ELSE DO;                                                    1392
*                                                                  1392
         B     @RC01376                                            1392
@RF01376 DS    0H                                                  1393
*/*      IF THE DEFECT-FLAG WAS FOUND TO BE SET                      */
*        IF RETCODE = DFLAGONP  RETCODE = DFLAGONA                1393
*/*        THEN SAVE THE DEFECT-FLAG SETTING                         */
*          THEN DO;    DFLAGV = DEFECTIV; END;                     1393
         L     @06,RETCODE                                         1393
         CH    @06,@CH00116                                        1393
         BE    @RT01393                                            1393
         CH    @06,@CH00119                                        1393
         BNE   @RF01393                                            1393
@RT01393 DS    0H                                                  1394
         L     @06,@PC00013+4                                      1395
         OI    DFLAGV(@06),B'10000000'                             1395
*/*        ELSE INDICATE THAT THE DEFECT-FLAG IS NOT SET             */
*          ELSE DO;    DFLAGV = NODEFECT; END;                     1397
         B     @RC01393                                            1397
@RF01393 DS    0H                                                  1398
         L     @06,@PC00013+4                                      1398
         NI    DFLAGV(@06),B'01111111'                             1398
*/*      END-ELSE (HOME-ADDRESS IS VALID)                            */
*        END;                                                      1400
*/*  END-SUB-PROCEDURE VALIDATE_HOME-ADDRESS                         */
*    END VALHOME;                                                  1401
*                                                                  1401
@EL00013 DS    0H                                                  1401
@EF00013 DS    0H                                                  1401
@ER00013 LM    @14,@12,@SA00013                                    1401
         BR    @14                                                 1401
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  DISTRACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  DISSOCIATE TRACK                             */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL DE-LINK AN ALTERNATE TRACK WHOSE      */
*/*    COUNT FIELD POINTS TO A PRIMARY TRACK.                        */
*/*    IT THUS MAKES THE ALTERNATE TRACK AVAILABLE FOR ASSIGNMENT.   */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1402
*                                                                  1402
*/*  SUB-PROCEDURE DISSOCIATE_TRACK                                  */
*    DISTRACK:                                                     1402
*      PROCEDURE;                                                  1402
DISTRACK STM   @14,@12,@SA00014                                    1402
*    OLDERID2 = NEWERID2;                                          1403
         L     @06,@PC00001                                        1403
         L     @15,GDTTR2(,@06)                                    1403
         MVC   @TS00001(95),NEWERID2(@15)                          1403
         MVC   OLDERID2(95,@15),@TS00001                           1403
*    NEWID2 =  'INDT';                                             1404
         MVC   NEWID2(4,@15),@CC00867                              1404
*/*  DISSOCIATE TRACK FROM ASSOCIATED TRACK (UDEVOP)                 */
*    CALL ICKDVOP0 (GDTTBL                                         1405
*           ,VOLIB                                                 1405
*           ,ACTWRZS                                               1405
*           ,CTRADDR                                               1405
*           ,RECNUM                                                1405
*           ,POOLID                                                1405
*           ,ADDR (CTRADDR)                                        1405
*           ,LENGTH (CTRADDR)                                      1405
*           ,RETCODE);                                             1405
         ST    @06,@AL00001                                        1405
         LA    @15,VOLIB                                           1405
         ST    @15,@AL00001+4                                      1405
         LA    @15,@CF00161                                        1405
         ST    @15,@AL00001+8                                      1405
         LA    @15,CTRADDR                                         1405
         ST    @15,@AL00001+12                                     1405
         LA    @15,RECNUM                                          1405
         ST    @15,@AL00001+16                                     1405
         LA    @15,POOLID                                          1405
         ST    @15,@AL00001+20                                     1405
         LA    @15,CTRADDR                                         1405
         ST    @15,@AFTEMPS+4                                      1405
         LA    @15,@AFTEMPS+4                                      1405
         ST    @15,@AL00001+24                                     1405
         LA    @15,@CF00044                                        1405
         ST    @15,@AL00001+28                                     1405
         LA    @15,RETCODE                                         1405
         ST    @15,@AL00001+32                                     1405
         L     @15,GDTDOP(,@06)                                    1405
         LA    @01,@AL00001                                        1405
         BALR  @14,@15                                             1405
*/*  IF DISSOCIATION FAILS                                           */
*    IF RETCODE = CPFAILS                                          1406
*/*    THEN                                                          */
*      THEN DO;                                                    1406
*                                                                  1406
         CLC   RETCODE(4),@CF00044                                 1406
         BNE   @RF01406                                            1406
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        UNTRTYPE = ALTTRACK;                                      1408
         NI    UNTRTYPE,B'01111111'                                1408
*        UNTRACK = CTRADDR;                                        1409
         MVC   UNTRACK(4),CTRADDR                                  1409
*        CALL COUNTRKS;                                            1410
         BAL   @14,COUNTRKS                                        1410
*/*      DECREMENT COUNT OF AVAILABLE ALTERNATE TRACKS               */
*        ALTCOUNT = ALTCOUNT - 1;                                  1411
         L     @06,ALTCOUNT                                        1411
         BCTR  @06,0                                               1411
         ST    @06,ALTCOUNT                                        1411
*/*      END-THEN                                                    */
*        END;                                                      1412
*/*    ELSE                                                          */
*      ELSE DO;                                                    1413
*                                                                  1413
         B     @RC01406                                            1413
@RF01406 DS    0H                                                  1414
*/*      IF DEFECT-FLAG IS FOUND TO BE SET DUE TO RECOVERY           */
*        IF (RETCODE = DFLAGONP)  (RETCODE = DFLAGONA)            1414
*/*        THEN                                                      */
*          THEN DO;                                                1414
*                                                                  1414
         L     @06,RETCODE                                         1414
         CH    @06,@CH00116                                        1414
         BE    @RT01414                                            1414
         CH    @06,@CH00119                                        1414
         BNE   @RF01414                                            1414
@RT01414 DS    0H                                                  1415
*/*          ISSUE_BUILD_PACK_MAP                                    */
*            PACKDEF = DEFECTIV;                                   1416
         OI    PACKDEF,B'10000000'                                 1416
*            PACKCHEK = NODEFECT;                                  1417
         NI    PACKCHEK,B'01111111'                                1417
*            PACKRCVR = RCVRYES;                                   1418
         NI    PACKRCVR,B'01111111'                                1418
*            IF TRACKTYP = PRITRACK                                1419
*              THEN DO;    PACKTRK = PRITRACK; END;                1419
         TM    TRACKTYP,B'10000000'                                1419
         BNO   @RF01419                                            1419
         OI    PACKTRK,B'10000000'                                 1421
*              ELSE DO;    PACKTRK = ALTTRACK; END;                1423
         B     @RC01419                                            1423
@RF01419 DS    0H                                                  1424
         NI    PACKTRK,B'01111111'                                 1424
*            PACKTRAK = CTRADDR;                                   1426
@RC01419 L     @06,CTRADDR                                         1426
         ST    @06,PACKTRAK                                        1426
*            PACKASC = CTRADDR;                                    1427
         ST    @06,PACKASC                                         1427
*            CALL BILDPACK;                                        1428
         BAL   @14,BILDPACK                                        1428
*/*          DECREMENT COUNT OF AVAILABLE ALTERNATE TRACKS           */
*            ALTCOUNT = ALTCOUNT - 1;                              1429
         L     @06,ALTCOUNT                                        1429
         BCTR  @06,0                                               1429
         ST    @06,ALTCOUNT                                        1429
*/*          END-THEN                                                */
*            END;                                                  1430
*/*        ELSE INCREMENT NUMBER OF AVAILABLE ALTERNATE TRACKS       */
*/*         FOUND (AVAILCNT)                                         */
*          ELSE DO;    AVAILCNT = AVAILCNT + 1; END;               1431
         B     @RC01414                                            1431
@RF01414 DS    0H                                                  1432
         LA    @06,1                                               1432
         AL    @06,AVAILCNT                                        1432
         ST    @06,AVAILCNT                                        1432
*/*      END-ELSE                                                    */
*        END;                                                      1434
*/*  END-SUB-PROCEDURE DISSOCIATE_TRACK                              */
*    END DISTRACK;                                                 1435
*                                                                  1435
@EL00014 DS    0H                                                  1435
@EF00014 DS    0H                                                  1435
@ER00014 LM    @14,@12,@SA00014                                    1435
         BR    @14                                                 1435
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  CHTRACK                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE CHECK TRACK SURFACE                    */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL EFFECT THE INVOCATION OF THE          */
*/*    TRACK SURFACE CHECKING FUNCTION. ALL THE CONDITION CODE       */
*/*    PROCESSING AFTER THE INVOCATION IS HANDLED BY THIS            */
*/*    SUB-PROCEDURE. THE STATUS OF THE TRACK IS THEN MADE           */
*/*    AVAILABLE TO THE MAIN PROCEDURE.                              */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1436
*                                                                  1436
*/*  SUB-PROCEDURE ISSUE_CHECK_TRACK_SURFACE                         */
*    CHTRACK:                                                      1436
*      PROCEDURE;                                                  1436
CHTRACK  STM   @14,@12,@SA00015                                    1436
*    OLDERID2 = NEWERID2;                                          1437
         L     @06,@PC00001                                        1437
         L     @15,GDTTR2(,@06)                                    1437
         MVC   @TS00001(95),NEWERID2(@15)                          1437
         MVC   OLDERID2(95,@15),@TS00001                           1437
*    NEWID2 =  'INCH';                                             1438
         MVC   NEWID2(4,@15),@CC00871                              1438
*/*  CHECK_TRACK_SURFACE                                             */
*    CALL ICKTA01                                                  1439
*         (GDTTBL                                                  1439
*         ,VOLIB                                                   1439
*         ,CTRADDR                                                 1439
*         ,CHECKVAL                                                1439
*         ,RETCODE);                                               1439
         ST    @06,@AL00001                                        1439
         LA    @06,VOLIB                                           1439
         ST    @06,@AL00001+4                                      1439
         LA    @06,CTRADDR                                         1439
         ST    @06,@AL00001+8                                      1439
         L     @06,@PC00001+4                                      1439
         L     @06,FDTPTR+12(,@06)                                 1439
         ST    @06,@AL00001+12                                     1439
         LA    @06,RETCODE                                         1439
         ST    @06,@AL00001+16                                     1439
         L     @15,@CV00872                                        1439
         LA    @01,@AL00001                                        1439
         BALR  @14,@15                                             1439
*/*  IF SURFACE CHECKING FUNCTION FAILS                              */
*    IF RETCODE = TSCFAILS                                         1440
*/*    THEN                                                          */
*      THEN DO;                                                    1440
*                                                                  1440
         LA    @06,2                                               1440
         C     @06,RETCODE                                         1440
         BNE   @RF01440                                            1440
*/*      ISSUE WARNING MESSAGE (MSGCHECK) (UPRINT)                   */
*        DARGSENT = MSGCHECK;                                      1442
         L     @15,DDSTRU                                          1442
         MVI   DARGSENT(@15),X'0F'                                 1442
*        DARGCNT = 2;                                              1443
         STH   @06,DARGCNT(,@15)                                   1443
*        DARGINS (1) = 1;                                          1444
         MVC   DARGINS(2,@15),@CH00165                             1444
*        DARGINL (1) = LENGTH (CTRADDRC);                          1445
         STH   @06,DARGINL(,@15)                                   1445
*        DARGDTM (1) = ADDR (CTRADDRC);                            1446
         LA    @14,CTRADDRC                                        1446
         ST    @14,DARGDTM(,@15)                                   1446
*        DARGINS (2) = 2;                                          1447
         STH   @06,DARGINS+8(,@15)                                 1447
*        DARGINL (2) = LENGTH (CTRADDRT);                          1448
         STH   @06,DARGINL+8(,@15)                                 1448
*        DARGDTM (2) = ADDR (CTRADDRT);                            1449
         LA    @06,CTRADDRT                                        1449
         ST    @06,DARGDTM+8(,@15)                                 1449
*        CALL ICKTPPR0 (GDTTBL                                     1450
*               ,PRTFILE                                           1450
*               ,DDSTRU);                                          1450
         L     @06,@PC00001                                        1450
         ST    @06,@AL00001                                        1450
         LA    @15,@CF00094                                        1450
         ST    @15,@AL00001+4                                      1450
         LA    @15,DDSTRU                                          1450
         ST    @15,@AL00001+8                                      1450
         MVI   @AL00001+8,X'80'                                    1450
         L     @15,GDTPRT(,@06)                                    1450
         LA    @01,@AL00001                                        1450
         BALR  @14,@15                                             1450
*/*      INDICATE MINOR ERROR (LASTCOND = 4)                         */
*        LASTCOND = MAX(LASTCC04,LASTCOND);                        1451
         L     @06,@PC00001+8                                      1451
         LH    @15,LASTCOND(,@06)                                  1451
         LA    @14,4                                               1451
         CR    @15,@14                                             1451
         BNL   *+6
         LR    @15,@14                                             1451
         STH   @15,LASTCOND(,@06)                                  1451
*/*      INDICATE THE TRACK CHECKS OUT DEFECTIVE                     */
*        TRSTATUS = TSCBAD;                                        1452
         NI    TRSTATUS,B'01111111'                                1452
*/*      END-THEN                                                    */
*        END;                                                      1453
*/*    ELSE                                                          */
*      ELSE DO;                                                    1454
*                                                                  1454
         B     @RC01440                                            1454
@RF01440 DS    0H                                                  1455
*/*      IF UNABLE TO OBTAIN STORAGE FOR BUFFER                      */
*        IF RETCODE = TSCNOSTO                                     1455
*/*        THEN INDICATE SEVERE ERROR                                */
*          THEN DO;    LASTCOND = LASTCC12; END;                   1455
         CLC   RETCODE(4),@CF00136                                 1455
         BNE   @RF01455                                            1455
         L     @06,@PC00001+8                                      1457
         MVC   LASTCOND(2,@06),@CH00265                            1457
*/*      IF TRACK CHECKS OUT GOOD                                    */
*        IF RETCODE = TRACKOK                                      1459
*/*        THEN SAVE THE TRACK STATUS                                */
*          THEN DO;    TRSTATUS = TSCGOOD; END;                    1459
@RF01455 L     @06,RETCODE                                         1459
         LTR   @06,@06                                             1459
         BNZ   @RF01459                                            1459
         OI    TRSTATUS,B'10000000'                                1461
*/*      IF TRACK CHECKS OUT DEFECTIVE                               */
*        IF RETCODE = TRACKDEF                                     1463
*/*        THEN SAVE THE TRACK STATUS                                */
*          THEN DO;    TRSTATUS = TSCBAD; END;                     1463
@RF01459 CLC   RETCODE(4),@CF00165                                 1463
         BNE   @RF01463                                            1463
         NI    TRSTATUS,B'01111111'                                1465
*/*      END-ELSE                                                    */
*        END;                                                      1467
@RF01463 DS    0H                                                  1468
*/*  WRITE STANDARD-LENGTH RECORD-ZERO (UDEVOP)                      */
*    CALL ICKDVOP0 (GDTTBL                                         1468
*           ,VOLIB                                                 1468
*           ,ACTWRZS                                               1468
*           ,CTRADDR                                               1468
*           ,RECNUM                                                1468
*           ,POOLID                                                1468
*           ,ADDR (CTRADDR)                                        1468
*           ,LENGTH (CTRADDR)                                      1468
*           ,RETCODE);                                             1468
@RC01440 L     @06,@PC00001                                        1468
         ST    @06,@AL00001                                        1468
         LA    @15,VOLIB                                           1468
         ST    @15,@AL00001+4                                      1468
         LA    @15,@CF00161                                        1468
         ST    @15,@AL00001+8                                      1468
         LA    @15,CTRADDR                                         1468
         ST    @15,@AL00001+12                                     1468
         LA    @15,RECNUM                                          1468
         ST    @15,@AL00001+16                                     1468
         LA    @15,POOLID                                          1468
         ST    @15,@AL00001+20                                     1468
         LA    @15,CTRADDR                                         1468
         ST    @15,@AFTEMPS+8                                      1468
         LA    @15,@AFTEMPS+8                                      1468
         ST    @15,@AL00001+24                                     1468
         LA    @15,@CF00044                                        1468
         ST    @15,@AL00001+28                                     1468
         LA    @15,RETCODE                                         1468
         ST    @15,@AL00001+32                                     1468
         L     @15,GDTDOP(,@06)                                    1468
         LA    @01,@AL00001                                        1468
         BALR  @14,@15                                             1468
*/*  IF DEFECT-FLAG SET DUE TO RECOVERY                              */
*    IF RETCODE = DFLAGONA  RETCODE = DFLAGONP                    1469
*/*    THEN INDICATE THAT THE TRACK CHECKS OUT DEFECTIVE ANYWAY      */
*      THEN DO;    TRSTATUS = TSCBAD; END;                         1469
         L     @06,RETCODE                                         1469
         CH    @06,@CH00119                                        1469
         BE    @RT01469                                            1469
         CH    @06,@CH00116                                        1469
         BNE   @RF01469                                            1469
@RT01469 DS    0H                                                  1470
         NI    TRSTATUS,B'01111111'                                1471
*/*    ELSE                                                          */
*      ELSE DO;                                                    1473
*                                                                  1473
         B     @RC01469                                            1473
@RF01469 DS    0H                                                  1474
*/*      IF UNABLE TO WRITE THE RECORD 0                             */
*        IF RETCODE = CPFAILS                                      1474
*/*        THEN                                                      */
*          THEN DO;                                                1474
*                                                                  1474
         CLC   RETCODE(4),@CF00044                                 1474
         BNE   @RF01474                                            1474
*/*          COUNT_UNRECOVERABLE_TRACKS                              */
*            UNTRACK = CTRADDR;                                    1476
         MVC   UNTRACK(4),CTRADDR                                  1476
*            IF TRACKTYP = PRITRACK                                1477
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1477
         TM    TRACKTYP,B'10000000'                                1477
         BNO   @RF01477                                            1477
         OI    UNTRTYPE,B'10000000'                                1479
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1481
         B     @RC01477                                            1481
@RF01477 DS    0H                                                  1482
         NI    UNTRTYPE,B'01111111'                                1482
*            CALL COUNTRKS;                                        1484
@RC01477 BAL   @14,COUNTRKS                                        1484
*/*          IF TRACK IS AN ALTERNATE TRACK                          */
*            IF TRACKTYP = ALTTRACK                                1485
*/*            THEN DECREMENT COUNT OF AVAILABLE ALTERNATE TRACKS    */
*              THEN DO;    ALTCOUNT = ALTCOUNT - 1; END;           1485
         TM    TRACKTYP,B'10000000'                                1485
         BNZ   @RF01485                                            1485
         L     @06,ALTCOUNT                                        1487
         BCTR  @06,0                                               1487
         ST    @06,ALTCOUNT                                        1487
*/*          END-THEN                                                */
*            END;                                                  1489
*/*      END-ELSE                                                    */
*        END;                                                      1490
*                                                                  1490
*                                                                  1490
*/*  END-SUB-PROCEDURE ISSUE_CHECK_TRACK_SURFACE                     */
*    END CHTRACK;                                                  1491
*                                                                  1491
*                                                                  1491
@EL00015 DS    0H                                                  1491
@EF00015 DS    0H                                                  1491
@ER00015 LM    @14,@12,@SA00015                                    1491
         BR    @14                                                 1491
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  REATRACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE RECLAIM ALTERNATE TRACK                */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION WHICH      */
*/*    RECLAIMS AN ALTERNATE TRACK WHICH WAS FOUND TO BE WITHOUT     */
*/*    DEFECT. THE CONDITION CODE PROCESSING AFTER THE INVOCATION    */
*/*    IS ALSO HANDLED IN THIS SUB-PROCEDURE. APPROPRIATE MESSAGES   */
*/*    ARE WRITTEN TO INDICATE THE RESULT OF THE RECLAMATION ATTEMPT.*/
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1492
*                                                                  1492
*/*  SUB-PROCEDURE ISSUE_RECLAIM_ALTERNATE_TRACK                     */
*    REATRACK:                                                     1492
*      PROCEDURE;                                                  1492
REATRACK STM   @14,@12,@SA00016                                    1492
*    OLDERID2 = NEWERID2;                                          1493
         L     @06,@PC00001                                        1493
         L     @15,GDTTR2(,@06)                                    1493
         MVC   @TS00001(95),NEWERID2(@15)                          1493
         MVC   OLDERID2(95,@15),@TS00001                           1493
*    NEWID2 =  'INRA';                                             1494
         MVC   NEWID2(4,@15),@CC00876                              1494
*/*  RECLAIM_ALTERNATE_TRACK                                         */
*    CALL ICKRT01                                                  1495
*         (GDTTBL                                                  1495
*         ,VOLIB                                                   1495
*         ,CTRADDR                                                 1495
*         ,ALTCOUNT                                                1495
*         ,ALTPTR                                                  1495
*         ,RETCODE);                                               1495
         ST    @06,@AL00001                                        1495
         LA    @06,VOLIB                                           1495
         ST    @06,@AL00001+4                                      1495
         LA    @06,CTRADDR                                         1495
         ST    @06,@AL00001+8                                      1495
         LA    @06,ALTCOUNT                                        1495
         ST    @06,@AL00001+12                                     1495
         LA    @06,ALTPTR                                          1495
         ST    @06,@AL00001+16                                     1495
         LA    @06,RETCODE                                         1495
         ST    @06,@AL00001+20                                     1495
         L     @15,@CV00877                                        1495
         LA    @01,@AL00001                                        1495
         BALR  @14,@15                                             1495
*/*  IF RECLAMATION FAILS AND THE TRACK WAS FOUND TO BE UNRECOVERABLE*/
*    IF RETCODE = REAFAIL                                          1496
*/*    THEN                                                          */
*      THEN DO;                                                    1496
*                                                                  1496
         CLC   RETCODE(4),@CF00116                                 1496
         BNE   @RF01496                                            1496
*/*      ISSUE_BUILD_PACK_MAP (TRACK FLAGGED DEFECTIVE)              */
*        PACKDEF  = DEFECTIV;                                      1498
         OI    PACKDEF,B'10000000'                                 1498
*        PACKCHEK = NODEFECT;                                      1499
         NI    PACKCHEK,B'01111111'                                1499
*        PACKRCVR = RCVRYES;                                       1500
         NI    PACKRCVR,B'01111111'                                1500
*        PACKTRK  = ALTTRACK;                                      1501
         NI    PACKTRK,B'01111111'                                 1501
*        PACKTRAK = CTRADDR;                                       1502
         MVC   PACKTRAK(4),CTRADDR                                 1502
*        PACKASC = 0;                                              1503
         SLR   @06,@06                                             1503
         ST    @06,PACKASC                                         1503
*        CALL BILDPACK;                                            1504
         BAL   @14,BILDPACK                                        1504
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        UNTRACK = CTRADDR;                                        1505
         MVC   UNTRACK(4),CTRADDR                                  1505
*        UNTRTYPE = ALTTRACK;                                      1506
         NI    UNTRTYPE,B'01111111'                                1506
*        CALL COUNTRKS;                                            1507
         BAL   @14,COUNTRKS                                        1507
*/*      END-THEN (RECLAMATION FAILS)                                */
*        END;                                                      1508
*/*    ELSE                                                          */
*      ELSE DO;                                                    1509
*                                                                  1509
         B     @RC01496                                            1509
@RF01496 DS    0H                                                  1510
*/*      IF RECLAMATION IS SUCCESSFUL                                */
*        IF RETCODE = SUCCESS                                      1510
*/*        THEN                                                      */
*          THEN DO;                                                1510
*                                                                  1510
         L     @06,RETCODE                                         1510
         LTR   @06,@06                                             1510
         BNZ   @RF01510                                            1510
*/*          INDICATE THAT ALTERNATE TRACKS ARE AVAILABLE            */
*            ALTFLAG = MOREYES;                                    1512
         NI    ALTFLAG,B'01111111'                                 1512
*/*          SET ARGUMENT FOR PROPER MESSAGE (MSGRCLA)               */
*            DARGSENT = MSGRCLA;                                   1513
         L     @06,DDSTRU                                          1513
         MVI   DARGSENT(@06),X'15'                                 1513
*/*          SAVE INDICATION THAT THE DEFECT-FLAG IS NOT SET         */
*            DFLAGC = NODEFECT;                                    1514
         NI    DFLAGC,B'01111111'                                  1514
*/*          INCREMENT NUMBER OF AVAILABLE ALTERNATE TRACKS FOUND    */
*/*           BY ONE (AVAILCNT)                                      */
*            AVAILCNT = AVAILCNT + 1;                              1515
         LA    @06,1                                               1515
         AL    @06,AVAILCNT                                        1515
         ST    @06,AVAILCNT                                        1515
*/*          END-THEN                                                */
*            END;                                                  1516
*/*        ELSE (RECLAMATION FAILS BUT TRACK RECOVERABLE)            */
*          ELSE DO;                                                1517
*                                                                  1517
         B     @RC01510                                            1517
@RF01510 DS    0H                                                  1518
*/*          SET ARGUMENT FOR PROPER MESSAGE (MSGRCLAF)              */
*            DARGSENT = MSGRCLAF;                                  1518
         L     @06,DDSTRU                                          1518
         MVI   DARGSENT(@06),X'1F'                                 1518
*/*          SAVE INDICATION THAT THE DEFECT-FLAG IS SET DUE TO      */
*/*           RECOVERY                                               */
*            DFLAGC = DEFECTIV;                                    1519
         OI    DFLAGC,B'10000000'                                  1519
*/*          ISSUE_BUILD_PACK_MAP                                    */
*            PACKDEF = DEFECTIV;                                   1520
         OI    PACKDEF,B'10000000'                                 1520
*            PACKCHEK = NODEFECT;                                  1521
         NI    PACKCHEK,B'01111111'                                1521
*            PACKRCVR = RCVRYES;                                   1522
         NI    PACKRCVR,B'01111111'                                1522
*            PACKTRK = ALTTRACK;                                   1523
         NI    PACKTRK,B'01111111'                                 1523
*            PACKTRAK = CTRADDR;                                   1524
         L     @06,CTRADDR                                         1524
         ST    @06,PACKTRAK                                        1524
*            PACKASC = CTRADDR;                                    1525
         ST    @06,PACKASC                                         1525
*            CALL BILDPACK;                                        1526
         BAL   @14,BILDPACK                                        1526
*/*          INDICATE AN ERROR                                       */
*            LASTCOND = MAX(LASTCC08,LASTCOND);                    1527
         L     @06,@PC00001+8                                      1527
         LH    @15,LASTCOND(,@06)                                  1527
         LA    @14,8                                               1527
         CR    @15,@14                                             1527
         BNL   *+6
         LR    @15,@14                                             1527
         STH   @15,LASTCOND(,@06)                                  1527
*/*          END-ELSE                                                */
*            END;                                                  1528
*/*      ISSUE MESSAGE (UPRINT)                                      */
*        DARGCNT = 2;                                              1529
@RC01510 LA    @06,2                                               1529
         L     @15,DDSTRU                                          1529
         STH   @06,DARGCNT(,@15)                                   1529
*        DARGINS (1) = 1;                                          1530
         MVC   DARGINS(2,@15),@CH00165                             1530
*        DARGINL (1) = LENGTH (CTRADDRC);                          1531
         STH   @06,DARGINL(,@15)                                   1531
*        DARGDTM (1) = ADDR (CTRADDRC);                            1532
         LA    @14,CTRADDRC                                        1532
         ST    @14,DARGDTM(,@15)                                   1532
*        DARGINS (2) = 2;                                          1533
         STH   @06,DARGINS+8(,@15)                                 1533
*        DARGINL (2) = LENGTH (CTRADDRT);                          1534
         STH   @06,DARGINL+8(,@15)                                 1534
*        DARGDTM (2) = ADDR (CTRADDRT);                            1535
         LA    @06,CTRADDRT                                        1535
         ST    @06,DARGDTM+8(,@15)                                 1535
*        CALL ICKTPPR0 (GDTTBL                                     1536
*               ,PRTFILE                                           1536
*               ,DDSTRU);                                          1536
         L     @06,@PC00001                                        1536
         ST    @06,@AL00001                                        1536
         LA    @15,@CF00094                                        1536
         ST    @15,@AL00001+4                                      1536
         LA    @15,DDSTRU                                          1536
         ST    @15,@AL00001+8                                      1536
         MVI   @AL00001+8,X'80'                                    1536
         L     @15,GDTPRT(,@06)                                    1536
         LA    @01,@AL00001                                        1536
         BALR  @14,@15                                             1536
*/*      END-ELSE                                                    */
*        END;                                                      1537
*/*  END-SUB-PROCEDURE ISSUE_RECLAIM_ALTERNATE_TRACK                 */
*    END REATRACK;                                                 1538
*                                                                  1538
@EL00016 DS    0H                                                  1538
@EF00016 DS    0H                                                  1538
@ER00016 LM    @14,@12,@SA00016                                    1538
         BR    @14                                                 1538
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  WRIHARZD                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE MARK TRACK DEFECTIVE                   */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL MARK THE CURRENT TRACK THAT IS BEING  */
*/*    PROCESSED, DEFECTIVE BY SETTING THE DEFECT-FLAG IN THE        */
*/*    HOME-ADDRESS. IN ADDITION IT WILL ALSO WRITE THE STANDARD-    */
*/*    LENGTH RECORD-ZERO AND CREATE THE PROPER PACK MAP ENTRY.      */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1539
*                                                                  1539
*/*  SUB-PROCEDURE ISSUE_MARK_TRACK_DEFECTIVE                        */
*    WRIHARZD:                                                     1539
*      PROCEDURE;                                                  1539
WRIHARZD STM   @14,@12,@SA00017                                    1539
*    OLDERID2 = NEWERID2;                                          1540
         L     @06,@PC00001                                        1540
         L     @06,GDTTR2(,@06)                                    1540
         MVC   @TS00001(95),NEWERID2(@06)                          1540
         MVC   OLDERID2(95,@06),@TS00001                           1540
*    NEWID2 = 'INWD';                                              1541
         MVC   NEWID2(4,@06),@CC00881                              1541
*/*  IF TRACK IS PRIMARY                                             */
*    IF TRACKTYP = PRITRACK                                        1542
*/*    THEN SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */
*/*     DEFECT-FLAG SET ON A PRIMARY TRACK                           */
*      THEN DO;    HAACTION = ACTWPHAD; END;                       1542
         TM    TRACKTYP,B'10000000'                                1542
         BNO   @RF01542                                            1542
         MVC   HAACTION(4),@CF00136                                1544
*/*    ELSE SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */
*/*     DEFECT-FLAG SET ON AN ALTERNATE TRACK                        */
*      ELSE DO;    HAACTION = ACTWAHAD; END;                       1546
         B     @RC01542                                            1546
@RF01542 DS    0H                                                  1547
         MVC   HAACTION(4),@CF00255                                1547
*/*  ISSUE CALL TO UDEVOP FOR THE PROPER ACTION                      */
*    CALL ICKDVOP0 (GDTTBL                                         1549
*           ,VOLIB                                                 1549
*           ,HAACTION                                              1549
*           ,CTRADDR                                               1549
*           ,RECNUM                                                1549
*           ,POOLID                                                1549
*           ,DATAPTR                                               1549
*           ,DATALEN                                               1549
*           ,RETCODE);                                             1549
@RC01542 L     @06,@PC00001                                        1549
         ST    @06,@AL00001                                        1549
         LA    @15,VOLIB                                           1549
         ST    @15,@AL00001+4                                      1549
         LA    @15,HAACTION                                        1549
         ST    @15,@AL00001+8                                      1549
         LA    @15,CTRADDR                                         1549
         ST    @15,@AL00001+12                                     1549
         LA    @15,RECNUM                                          1549
         ST    @15,@AL00001+16                                     1549
         LA    @15,POOLID                                          1549
         ST    @15,@AL00001+20                                     1549
         LA    @15,DATAPTR                                         1549
         ST    @15,@AL00001+24                                     1549
         LA    @15,DATALEN                                         1549
         ST    @15,@AL00001+28                                     1549
         LA    @15,RETCODE                                         1549
         ST    @15,@AL00001+32                                     1549
         L     @15,GDTDOP(,@06)                                    1549
         LA    @01,@AL00001                                        1549
         BALR  @14,@15                                             1549
*/*  IF WRITE OPERATION FAILS                                        */
*    IF RETCODE = CPFAILS                                          1550
*/*    THEN                                                          */
*      THEN DO;                                                    1550
*                                                                  1550
         CLC   RETCODE(4),@CF00044                                 1550
         BNE   @RF01550                                            1550
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        IF TRACKTYP = PRITRACK                                    1552
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1552
         TM    TRACKTYP,B'10000000'                                1552
         BNO   @RF01552                                            1552
         OI    UNTRTYPE,B'10000000'                                1554
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1556
         B     @RC01552                                            1556
@RF01552 DS    0H                                                  1557
         NI    UNTRTYPE,B'01111111'                                1557
*        UNTRACK = CTRADDR;                                        1559
@RC01552 MVC   UNTRACK(4),CTRADDR                                  1559
*        CALL COUNTRKS;                                            1560
         BAL   @14,COUNTRKS                                        1560
*/*      END-THEN (WRITE OPERATION FAILS)                            */
*        END;                                                      1561
*/*    ELSE (WRITE OPERATION SUCCESSFUL)                             */
*      ELSE DO;                                                    1562
*                                                                  1562
         B     @RC01550                                            1562
@RF01550 DS    0H                                                  1563
*/*      IF TRACK IS AN ALTERNATE TRACK                              */
*        IF TRACKTYP = ALTTRACK                                    1563
*/*        THEN                                                      */
*          THEN DO;                                                1563
*                                                                  1563
         TM    TRACKTYP,B'10000000'                                1563
         BNZ   @RF01563                                            1563
*/*          INDICATE ALTERNATE TRACK FOR PACK MAP ENTRY             */
*            PACKTRK = ALTTRACK;                                   1565
         NI    PACKTRK,B'01111111'                                 1565
*/*          END-THEN                                                */
*            END;                                                  1566
*/*        ELSE INDICATE PRIMARY TRACK FOR PACK MAP ENTRY            */
*          ELSE DO;    PACKTRK = PRITRACK; END;                    1567
         B     @RC01563                                            1567
@RF01563 DS    0H                                                  1568
         OI    PACKTRK,B'10000000'                                 1568
*/*      ISSUE_BUILD_PACK_MAP                                        */
*        PACKDEF = DEFECTIV;                                       1570
@RC01563 OI    PACKDEF,B'10000000'                                 1570
*        PACKCHEK = NODEFECT;                                      1571
         NI    PACKCHEK,B'01111111'                                1571
*        PACKRCVR = RCVRYES;                                       1572
         NI    PACKRCVR,B'01111111'                                1572
*        PACKTRAK = CTRADDR;                                       1573
         L     @06,CTRADDR                                         1573
         ST    @06,PACKTRAK                                        1573
*        PACKASC = CTRADDR;                                        1574
         ST    @06,PACKASC                                         1574
*        CALL BILDPACK;                                            1575
         BAL   @14,BILDPACK                                        1575
*/*      WRITE THE STANDARD-LENGTH RECORD-ZERO (UDEVOP)              */
*        CALL ICKDVOP0 (GDTTBL                                     1576
*               ,VOLIB                                             1576
*               ,ACTWRZS                                           1576
*               ,CTRADDR                                           1576
*               ,RECNUM                                            1576
*               ,POOLID                                            1576
*               ,ADDR(CTRADDR)                                     1576
*               ,LENGTH(CTRADDR)                                   1576
*               ,RETCODE);                                         1576
         L     @06,@PC00001                                        1576
         ST    @06,@AL00001                                        1576
         LA    @15,VOLIB                                           1576
         ST    @15,@AL00001+4                                      1576
         LA    @15,@CF00161                                        1576
         ST    @15,@AL00001+8                                      1576
         LA    @15,CTRADDR                                         1576
         ST    @15,@AL00001+12                                     1576
         LA    @15,RECNUM                                          1576
         ST    @15,@AL00001+16                                     1576
         LA    @15,POOLID                                          1576
         ST    @15,@AL00001+20                                     1576
         LA    @15,CTRADDR                                         1576
         ST    @15,@AFTEMPS+12                                     1576
         LA    @15,@AFTEMPS+12                                     1576
         ST    @15,@AL00001+24                                     1576
         LA    @15,@CF00044                                        1576
         ST    @15,@AL00001+28                                     1576
         LA    @15,RETCODE                                         1576
         ST    @15,@AL00001+32                                     1576
         L     @15,GDTDOP(,@06)                                    1576
         LA    @01,@AL00001                                        1576
         BALR  @14,@15                                             1576
*/*      IF WRITE OPERATION FAILS                                    */
*        IF RETCODE = CPFAILS                                      1577
*/*        THEN                                                      */
*          THEN DO;                                                1577
*                                                                  1577
         CLC   RETCODE(4),@CF00044                                 1577
         BNE   @RF01577                                            1577
*/*          COUNT_UNRECOVERABLE_TRACKS                              */
*            UNTRACK = CTRADDR;                                    1579
         MVC   UNTRACK(4),CTRADDR                                  1579
*            IF TRACKTYP = PRITRACK                                1580
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1580
         TM    TRACKTYP,B'10000000'                                1580
         BNO   @RF01580                                            1580
         OI    UNTRTYPE,B'10000000'                                1582
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1584
         B     @RC01580                                            1584
@RF01580 DS    0H                                                  1585
         NI    UNTRTYPE,B'01111111'                                1585
*            CALL COUNTRKS;                                        1587
@RC01580 BAL   @14,COUNTRKS                                        1587
*/*          END-THEN                                                */
*            END;                                                  1588
*/*      END-ELSE (WRITE HOME-ADDRESS SUCCESSFUL)                    */
*        END;                                                      1589
*/*  END-SUB-PROCEDURE ISSUE_MARK_TRACK_DEFECTIVE                    */
*    END WRIHARZD;                                                 1590
*                                                                  1590
@EL00017 DS    0H                                                  1590
@EF00017 DS    0H                                                  1590
@ER00017 LM    @14,@12,@SA00017                                    1590
         BR    @14                                                 1590
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  BILDPACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE BUILD PACK MAP                         */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION THAT       */
*/*    BUILDS A PACK MAP ENTRY.                                      */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1591
*                                                                  1591
*/*  SUB-PROCEDURE ISSUE_BUILD_PACK_MAP                              */
*    BILDPACK:                                                     1591
*      PROCEDURE;                                                  1591
BILDPACK STM   @14,@12,@SA00018                                    1591
*    OLDERID2 = NEWERID2;                                          1592
         L     @06,@PC00001                                        1592
         L     @06,GDTTR2(,@06)                                    1592
         MVC   @TS00001(95),NEWERID2(@06)                          1592
         MVC   OLDERID2(95,@06),@TS00001                           1592
*    NEWID2 =  'INBP';                                             1593
         MVC   NEWID2(4,@06),@CC00885                              1593
*/*  IF THERE IS NO STORAGE AVAILABLE TO BUILD ANOTHER ENTRY         */
*    IF PACKENT = STORNO                                           1594
*/*    THEN RETURN                                                   */
*      THEN DO;    RETURN; END;                                    1594
         TM    PACKENT,B'10000000'                                 1594
         BNO   @RF01594                                            1594
@EL00018 DS    0H                                                  1596
@EF00018 DS    0H                                                  1596
@ER00018 LM    @14,@12,@SA00018                                    1596
         BR    @14                                                 1596
*/*  BUILD_PACK_MAP                                                  */
*    CALL ICKBM01                                                  1598
*         (GDTTBL                                                  1598
*         ,VOLIB                                                   1598
*         ,PACKTRAK                                                1598
*         ,PACKASC                                                 1598
*         ,PACKTRK                                                 1598
*         ,PACKDEF                                                 1598
*         ,PACKCHEK                                                1598
*         ,PACKRCVR                                                1598
*         ,RETCODE);                                               1598
@RF01594 L     @06,@PC00001                                        1598
         ST    @06,@AL00001                                        1598
         LA    @06,VOLIB                                           1598
         ST    @06,@AL00001+4                                      1598
         LA    @06,PACKTRAK                                        1598
         ST    @06,@AL00001+8                                      1598
         LA    @06,PACKASC                                         1598
         ST    @06,@AL00001+12                                     1598
         LA    @06,PACKTRK                                         1598
         ST    @06,@AL00001+16                                     1598
         LA    @06,PACKDEF                                         1598
         ST    @06,@AL00001+20                                     1598
         LA    @06,PACKCHEK                                        1598
         ST    @06,@AL00001+24                                     1598
         LA    @06,PACKRCVR                                        1598
         ST    @06,@AL00001+28                                     1598
         LA    @06,RETCODE                                         1598
         ST    @06,@AL00001+32                                     1598
         L     @15,@CV00886                                        1598
         LA    @01,@AL00001                                        1598
         BALR  @14,@15                                             1598
*/*  IF STORAGE IS NOT AVAILABLE                                     */
*    IF RETCODE = FAILURE                                          1599
*/*    THEN                                                          */
*      THEN DO;                                                    1599
*                                                                  1599
         CLC   RETCODE(4),@CF00165                                 1599
         BNE   @RF01599                                            1599
*/*      SET FLAG TO INDICATE NO STORAGE IS AVAILABLE                */
*        PACKENT = STORNO;                                         1601
         OI    PACKENT,B'10000000'                                 1601
*/*      INDICATE AN ERROR (LASTCOND = 8)                            */
*        LASTCOND = MAX(LASTCC08,LASTCOND);                        1602
         L     @06,@PC00001+8                                      1602
         LH    @15,LASTCOND(,@06)                                  1602
         LA    @14,8                                               1602
         CR    @15,@14                                             1602
         BNL   *+6
         LR    @15,@14                                             1602
         STH   @15,LASTCOND(,@06)                                  1602
*/*      END-THEN                                                    */
*        END;                                                      1603
*/*  END-SUB-PROCEDURE ISSUE_BUILD_PACK_MAP                          */
*    END BILDPACK;                                                 1604
*                                                                  1604
         B     @EL00018                                            1604
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  ASSGNALT                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE ASSIGN ALTERNATE TRACK                 */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION THAT       */
*/*    ASSIGNS AN ALTERNATE TRACK FOR A PRIMARY TRACK WHICH HAS      */
*/*    BEEN FOUND TO BE DEFECTIVE.                                   */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1605
*                                                                  1605
*/*  SUB-PROCEDURE ISSUE_ASSIGN_ALTERNATE_TRACK                      */
*    ASSGNALT:                                                     1605
*      PROCEDURE;                                                  1605
ASSGNALT STM   @14,@12,@SA00019                                    1605
*    OLDERID2 = NEWERID2;                                          1606
         L     @06,@PC00001                                        1606
         L     @06,GDTTR2(,@06)                                    1606
         MVC   @TS00001(95),NEWERID2(@06)                          1606
         MVC   OLDERID2(95,@06),@TS00001                           1606
*    NEWID2 =  'INAA';                                             1607
         MVC   NEWID2(4,@06),@CC00890                              1607
*/*  IF NO ALTERNATE TRACKS ARE AVAILABLE                            */
*    IF ALTFLAG = MORENO                                           1608
*/*    THEN RETURN                                                   */
*      THEN DO;    RETURN; END;                                    1608
         TM    ALTFLAG,B'10000000'                                 1608
         BNO   @RF01608                                            1608
@EL00019 DS    0H                                                  1610
@EF00019 DS    0H                                                  1610
@ER00019 LM    @14,@12,@SA00019                                    1610
         BR    @14                                                 1610
*/*  DO-UNTIL ASSIGNMENT IS SUCCESSFUL                               */
*    DO UNTIL (RETCODE = SUCCESS);                                 1612
*                                                                  1612
@RF01608 DS    0H                                                  1612
@DL01612 DS    0H                                                  1613
*/*    ASSIGN_ALTERNATE_TRACK                                        */
*      CALL ICKAA01                                                1613
*           (GDTTBL                                                1613
*           ,VOLIB                                                 1613
*           ,CTRADDR                                               1613
*           ,ALTCOUNT                                              1613
*           ,ALTPTR                                                1613
*           ,ALTRACK                                               1613
*           ,UNTRACK                                               1613
*           ,RETCODE);                                             1613
         L     @06,@PC00001                                        1613
         ST    @06,@AL00001                                        1613
         LA    @06,VOLIB                                           1613
         ST    @06,@AL00001+4                                      1613
         LA    @06,CTRADDR                                         1613
         ST    @06,@AL00001+8                                      1613
         LA    @06,ALTCOUNT                                        1613
         ST    @06,@AL00001+12                                     1613
         LA    @06,ALTPTR                                          1613
         ST    @06,@AL00001+16                                     1613
         LA    @06,ALTRACK                                         1613
         ST    @06,@AL00001+20                                     1613
         LA    @06,UNTRACK                                         1613
         ST    @06,@AL00001+24                                     1613
         LA    @06,RETCODE                                         1613
         ST    @06,@AL00001+28                                     1613
         L     @15,@CV00891                                        1613
         LA    @01,@AL00001                                        1613
         BALR  @14,@15                                             1613
*/*    IF ASSIGNMENT IS SUCCESSFUL                                   */
*      IF RETCODE = SUCCESS                                        1614
*/*      THEN                                                        */
*        THEN DO;                                                  1614
*                                                                  1614
         L     @06,RETCODE                                         1614
         LTR   @06,@06                                             1614
         BNZ   @RF01614                                            1614
*/*        ISSUE MESSAGE ABOUT THE ASSIGNMENT (MSGALTA) (UPRINT)     */
*          DARGSENT = MSGALTA;                                     1616
         L     @06,DDSTRU                                          1616
         MVI   DARGSENT(@06),X'11'                                 1616
*          DARGCNT = 4;                                            1617
         LA    @15,4                                               1617
         STH   @15,DARGCNT(,@06)                                   1617
*          DARGINS (1) = 1;                                        1618
         MVC   DARGINS(2,@06),@CH00165                             1618
*          DARGINL (1) = LENGTH (ALTRACKC);                        1619
         LA    @14,2                                               1619
         STH   @14,DARGINL(,@06)                                   1619
*          DARGDTM (1) = ADDR (ALTRACKC);                          1620
         LA    @05,ALTRACKC                                        1620
         ST    @05,DARGDTM(,@06)                                   1620
*          DARGINS (2) = 2;                                        1621
         STH   @14,DARGINS+8(,@06)                                 1621
*          DARGINL (2) = LENGTH (ALTRACKT);                        1622
         STH   @14,DARGINL+8(,@06)                                 1622
*          DARGDTM (2) = ADDR (ALTRACKT);                          1623
         LA    @05,ALTRACKT                                        1623
         ST    @05,DARGDTM+8(,@06)                                 1623
*          DARGINS (3) = 3;                                        1624
         MVC   DARGINS+16(2,@06),@CH00136                          1624
*          DARGINL (3) = LENGTH (CTRADDRC);                        1625
         STH   @14,DARGINL+16(,@06)                                1625
*          DARGDTM (3) = ADDR (CTRADDRC);                          1626
         LA    @05,CTRADDRC                                        1626
         ST    @05,DARGDTM+16(,@06)                                1626
*          DARGINS (4) = 4;                                        1627
         STH   @15,DARGINS+24(,@06)                                1627
*          DARGINL (4) = LENGTH (CTRADDRT);                        1628
         STH   @14,DARGINL+24(,@06)                                1628
*          DARGDTM (4) = ADDR (CTRADDRT);                          1629
         LA    @15,CTRADDRT                                        1629
         ST    @15,DARGDTM+24(,@06)                                1629
*          CALL ICKTPPR0 (GDTTBL                                   1630
*                 ,PRTFILE                                         1630
*                 ,DDSTRU);                                        1630
         L     @06,@PC00001                                        1630
         ST    @06,@AL00001                                        1630
         LA    @15,@CF00094                                        1630
         ST    @15,@AL00001+4                                      1630
         LA    @15,DDSTRU                                          1630
         ST    @15,@AL00001+8                                      1630
         MVI   @AL00001+8,X'80'                                    1630
         L     @15,GDTPRT(,@06)                                    1630
         LA    @01,@AL00001                                        1630
         BALR  @14,@15                                             1630
*/*        ISSUE_BUILD_PACK_MAP                                      */
*          PACKDEF  = DEFECTIV;                                    1631
         OI    PACKDEF,B'10000000'                                 1631
*          PACKCHEK = NODEFECT;                                    1632
         NI    PACKCHEK,B'01111111'                                1632
*          PACKRCVR = RCVRYES;                                     1633
         NI    PACKRCVR,B'01111111'                                1633
*          PACKTRAK = CTRADDR;                                     1634
         MVC   PACKTRAK(4),CTRADDR                                 1634
*          PACKTRK = PRITRACK;                                     1635
         OI    PACKTRK,B'10000000'                                 1635
*          PACKASC = ALTRACK;                                      1636
         MVC   PACKASC(4),ALTRACK                                  1636
*          CALL BILDPACK;                                          1637
         BAL   @14,BILDPACK                                        1637
*/*        LEAVE                                                     */
*          GOTO ENDLOOP1;                                          1638
         B     ENDLOOP1                                            1638
*/*        END-THEN                                                  */
*          END;                                                    1639
*/*      ELSE                                                        */
*        ELSE DO;                                                  1640
*                                                                  1640
@RF01614 DS    0H                                                  1641
*/*        IF AN UNRECOVERABLE TRACK HAS BEEN FOUND                  */
*          IF RETCODE = UNTRAAFF                                   1641
*/*          THEN                                                    */
*            THEN DO;                                              1641
*                                                                  1641
         CLC   RETCODE(4),@CF00044                                 1641
         BNE   @RF01641                                            1641
*/*            COUNT_UNRECOVERABLE_TRACKS                            */
*              UNTRTYPE = ALTTRACK;                                1643
         NI    UNTRTYPE,B'01111111'                                1643
*              CALL COUNTRKS;                                      1644
         BAL   @14,COUNTRKS                                        1644
*/*            IF A SEVERE ERROR HAS OCCURRED                        */
*              IF LASTCOND >= LASTCC12                             1645
*/*              THEN LEAVE                                          */
*                THEN DO;    GOTO ENDLOOP1; END;                   1645
         L     @06,@PC00001+8                                      1645
         LH    @06,LASTCOND(,@06)                                  1645
         CH    @06,@CH00265                                        1645
         BL    @RF01645                                            1645
         B     ENDLOOP1                                            1647
*/*            END-THEN                                              */
*              END;                                                1649
@RF01645 DS    0H                                                  1650
*/*        IF THERE ARE NO ALTERNATES LEFT                           */
*          IF RETCODE = NOALTS                                     1650
*/*          THEN                                                    */
*            THEN DO;                                              1650
*                                                                  1650
@RF01641 CLC   RETCODE(4),@CF00165                                 1650
         BNE   @RF01650                                            1650
*/*            ISSUE ERROR MESSAGE (MSGALTB) (UPRINT)                */
*              DARGSENT = MSGALTB;                                 1652
         L     @06,DDSTRU                                          1652
         MVI   DARGSENT(@06),X'12'                                 1652
*              CALL ICKTPPR0 (GDTTBL                               1653
*                     ,PRTFILE                                     1653
*                     ,DDSTRU);                                    1653
         L     @06,@PC00001                                        1653
         ST    @06,@AL00001                                        1653
         LA    @15,@CF00094                                        1653
         ST    @15,@AL00001+4                                      1653
         LA    @15,DDSTRU                                          1653
         ST    @15,@AL00001+8                                      1653
         MVI   @AL00001+8,X'80'                                    1653
         L     @15,GDTPRT(,@06)                                    1653
         LA    @01,@AL00001                                        1653
         BALR  @14,@15                                             1653
*/*            INDICATE AN ERROR (LASTCOND = 8)                      */
*              LASTCOND = MAX(LASTCOND,LASTCC08);                  1654
         L     @06,@PC00001+8                                      1654
         LH    @15,LASTCOND(,@06)                                  1654
         LA    @14,8                                               1654
         CR    @15,@14                                             1654
         BNL   *+6
         LR    @15,@14                                             1654
         STH   @15,LASTCOND(,@06)                                  1654
*/*            INDICATE NO MORE ALTERNATES ARE AVAILABLE             */
*              ALTFLAG = MORENO;                                   1655
         OI    ALTFLAG,B'10000000'                                 1655
*/*            LEAVE                                                 */
*              GOTO ENDLOOP1;                                      1656
         B     ENDLOOP1                                            1656
*/*            END-THEN                                              */
*              END;                                                1657
*/*        IF ASSOCIATION OF THE ALTERNATE TO THE PRIMARY FAILS      */
*          IF RETCODE = NOPASSOC                                   1658
*/*          THEN                                                    */
*            THEN DO;                                              1658
*                                                                  1658
@RF01650 CLC   RETCODE(4),@CF00116                                 1658
         BNE   @RF01658                                            1658
*/*            COUNT_UNRECOVERABLE_TRACKS                            */
*              UNTRACK = CTRADDR;                                  1660
         MVC   UNTRACK(4),CTRADDR                                  1660
*              UNTRTYPE = PRITRACK;                                1661
         OI    UNTRTYPE,B'10000000'                                1661
*              CALL COUNTRKS;                                      1662
         BAL   @14,COUNTRKS                                        1662
*/*            LEAVE                                                 */
*              GOTO ENDLOOP1;                                      1663
         B     ENDLOOP1                                            1663
*/*            END-THEN                                              */
*              END;                                                1664
*/*        IF ASSOCIATION OF THE PRIMARY TO THE ALTERNATE FAILS      */
*          IF RETCODE = NOAASSOC                                   1665
*/*          THEN                                                    */
*            THEN DO;                                              1665
*                                                                  1665
@RF01658 CLC   RETCODE(4),@CF00136                                 1665
         BNE   @RF01665                                            1665
*/*            COUNT_UNRECOVERABLE_TRACKS                            */
*              UNTRTYPE = ALTTRACK;                                1667
         NI    UNTRTYPE,B'01111111'                                1667
*              CALL COUNTRKS;                                      1668
         BAL   @14,COUNTRKS                                        1668
*/*            IF A SEVERE ERROR HAS OCCURRED                        */
*              IF LASTCOND >= LASTCC12                             1669
*/*              THEN LEAVE                                          */
*                THEN DO;    GOTO ENDLOOP1; END;                   1669
         L     @06,@PC00001+8                                      1669
         LH    @06,LASTCOND(,@06)                                  1669
         CH    @06,@CH00265                                        1669
         BL    @RF01669                                            1669
         B     ENDLOOP1                                            1671
*/*            END-THEN                                              */
*              END;                                                1673
@RF01669 DS    0H                                                  1674
*/*      END-ELSE (ASSIGNMENT UNSUCCESSFUL)                          */
*        END;                                                      1674
@RF01665 DS    0H                                                  1675
*/*  END-UNTIL                                                       */
*    END;                                                          1675
@DE01612 L     @06,RETCODE                                         1675
         LTR   @06,@06                                             1675
         BNZ   @DL01612                                            1675
*/*  END-SUB-PROCEDURE ISSUE_ASSIGN_ALTERNATE_TRACK                  */
*    ENDLOOP1:                                                     1676
*    END ASSGNALT;                                                 1676
*                                                                  1676
         B     @EL00019                                            1676
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  RASGNALT                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE RE-ASSIGN ALTERNATE TRACK              */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION WHICH      */
*/*    RE-ASSIGNS AN ALTERNATE TRACK FOR A SUSPECT PRIMARY TRACK     */
*/*    WHEN  IT HAS BEEN ESTABLISHED THAT THE ALTERNATE TRACK        */
*/*    THAT IS CURRENTLY ASSIGNED TO THE PRIMARY TRACK IS ITSELF     */
*/*    DEFECTIVE.                                                    */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1677
*                                                                  1677
*/*  SUB-PROCEDURE ISSUE_RE-ASSIGN_ALTERNATE_TRACK                   */
*    RASGNALT:                                                     1677
*      PROCEDURE;                                                  1677
RASGNALT STM   @14,@12,@SA00020                                    1677
*    OLDERID2 = NEWERID2;                                          1678
         L     @06,@PC00001                                        1678
         L     @06,GDTTR2(,@06)                                    1678
         MVC   @TS00001(95),NEWERID2(@06)                          1678
         MVC   OLDERID2(95,@06),@TS00001                           1678
*    NEWID2 =  'INRS';                                             1679
         MVC   NEWID2(4,@06),@CC00897                              1679
*/*  IF NO MORE ALTERNATE TRACKS ARE AVAILABLE                       */
*    IF ALTFLAG = MORENO                                           1680
*/*    THEN RETURN                                                   */
*      THEN DO;    RETURN; END;                                    1680
         TM    ALTFLAG,B'10000000'                                 1680
         BNO   @RF01680                                            1680
@EL00020 DS    0H                                                  1682
@EF00020 DS    0H                                                  1682
@ER00020 LM    @14,@12,@SA00020                                    1682
         BR    @14                                                 1682
*/*  DO-UNTIL RE-ASSIGNMENT IS SUCCESSFUL                            */
*    DO UNTIL (RETCODE = SUCCESS);                                 1684
@RF01680 DS    0H                                                  1684
@DL01684 DS    0H                                                  1685
*/*    RE-ASSIGN_ALTERNATE_TRACK                                     */
*      CALL ICKRA01                                                1685
*           (GDTTBL                                                1685
*           ,VOLIB                                                 1685
*           ,RZCCHH                                                1685
*           ,CTRADDR                                               1685
*           ,ALTCOUNT                                              1685
*           ,ALTPTR                                                1685
*           ,ALTRACK                                               1685
*           ,UNTRACK                                               1685
*           ,RETCODE);                                             1685
         L     @06,@PC00001                                        1685
         ST    @06,@AL00001                                        1685
         LA    @06,VOLIB                                           1685
         ST    @06,@AL00001+4                                      1685
         LA    @06,RZCCHH                                          1685
         ST    @06,@AL00001+8                                      1685
         LA    @06,CTRADDR                                         1685
         ST    @06,@AL00001+12                                     1685
         LA    @06,ALTCOUNT                                        1685
         ST    @06,@AL00001+16                                     1685
         LA    @06,ALTPTR                                          1685
         ST    @06,@AL00001+20                                     1685
         LA    @06,ALTRACK                                         1685
         ST    @06,@AL00001+24                                     1685
         LA    @06,UNTRACK                                         1685
         ST    @06,@AL00001+28                                     1685
         LA    @06,RETCODE                                         1685
         ST    @06,@AL00001+32                                     1685
         L     @15,@CV00898                                        1685
         LA    @01,@AL00001                                        1685
         BALR  @14,@15                                             1685
*/*    IF RE-ASSIGNMENT IS SUCCESSFUL                                */
*      IF RETCODE = SUCCESS                                        1686
*/*      THEN                                                        */
*        THEN DO;                                                  1686
*                                                                  1686
         L     @06,RETCODE                                         1686
         LTR   @06,@06                                             1686
         BNZ   @RF01686                                            1686
*/*        ISSUE MESSAGE ABOUT THE RE-ASSIGNMENT (MSGALTC) (UPRINT)  */
*          DARGSENT = MSGALTC;                                     1688
         L     @06,DDSTRU                                          1688
         MVI   DARGSENT(@06),X'13'                                 1688
*          DARGCNT = 4;                                            1689
         LA    @15,4                                               1689
         STH   @15,DARGCNT(,@06)                                   1689
*          DARGINS (1) = 1;                                        1690
         MVC   DARGINS(2,@06),@CH00165                             1690
*          DARGINL (1) = LENGTH (ALTRACKC);                        1691
         LA    @14,2                                               1691
         STH   @14,DARGINL(,@06)                                   1691
*          DARGDTM (1) = ADDR (ALTRACKC);                          1692
         LA    @05,ALTRACKC                                        1692
         ST    @05,DARGDTM(,@06)                                   1692
*          DARGINS (2) = 2;                                        1693
         STH   @14,DARGINS+8(,@06)                                 1693
*          DARGINL (2) = LENGTH (ALTRACKT);                        1694
         STH   @14,DARGINL+8(,@06)                                 1694
*          DARGDTM (2) = ADDR (ALTRACKT);                          1695
         LA    @05,ALTRACKT                                        1695
         ST    @05,DARGDTM+8(,@06)                                 1695
*          DARGINS (3) = 3;                                        1696
         MVC   DARGINS+16(2,@06),@CH00136                          1696
*          DARGINL (3) = LENGTH (RZCCHHC);                         1697
         STH   @14,DARGINL+16(,@06)                                1697
*          DARGDTM (3) = ADDR (RZCCHHC);                           1698
         LA    @05,RZCCHHC                                         1698
         ST    @05,DARGDTM+16(,@06)                                1698
*          DARGINS (4) = 4;                                        1699
         STH   @15,DARGINS+24(,@06)                                1699
*          DARGINL (4) = LENGTH (RZCCHHT);                         1700
         STH   @14,DARGINL+24(,@06)                                1700
*          DARGDTM (4) = ADDR (RZCCHHT);                           1701
         LA    @15,RZCCHHT                                         1701
         ST    @15,DARGDTM+24(,@06)                                1701
*          CALL ICKTPPR0 (GDTTBL                                   1702
*                 ,PRTFILE                                         1702
*                 ,DDSTRU);                                        1702
         L     @06,@PC00001                                        1702
         ST    @06,@AL00001                                        1702
         LA    @15,@CF00094                                        1702
         ST    @15,@AL00001+4                                      1702
         LA    @15,DDSTRU                                          1702
         ST    @15,@AL00001+8                                      1702
         MVI   @AL00001+8,X'80'                                    1702
         L     @15,GDTPRT(,@06)                                    1702
         LA    @01,@AL00001                                        1702
         BALR  @14,@15                                             1702
*/*        ISSUE_BUILD_PACK_MAP (FOR THE PRIMARY TRACK)              */
*          PACKDEF  = DEFECTIV;                                    1703
         OI    PACKDEF,B'10000000'                                 1703
*          PACKCHEK = NODEFECT;                                    1704
         NI    PACKCHEK,B'01111111'                                1704
*          PACKRCVR = RCVRYES;                                     1705
         NI    PACKRCVR,B'01111111'                                1705
*          PACKTRAK = RZCCHH;                                      1706
         MVC   PACKTRAK(4),RZCCHH                                  1706
*          PACKTRK = PRITRACK;                                     1707
         OI    PACKTRK,B'10000000'                                 1707
*          PACKASC = ALTRACK;                                      1708
         MVC   PACKASC(4),ALTRACK                                  1708
*          CALL BILDPACK;                                          1709
         BAL   @14,BILDPACK                                        1709
*/*        IF THE OLD ALTERNATE WAS FLAGGED DEFECTIVE                */
*          IF DFLAGC = DEFECTIV                                    1710
*/*          THEN                                                    */
*            THEN DO;                                              1710
         TM    DFLAGC,B'10000000'                                  1710
         BNO   @RF01710                                            1710
*/*            ISSUE_BUILD_PACK_MAP (FOR THE OLD ALTERNATE TRACK)    */
*              PACKDEF = DEFECTIV;                                 1712
         OI    PACKDEF,B'10000000'                                 1712
*              PACKCHEK = NODEFECT;                                1713
         NI    PACKCHEK,B'01111111'                                1713
*              PACKRCVR = RCVRYES;                                 1714
         NI    PACKRCVR,B'01111111'                                1714
*              PACKTRAK = CTRADDR;                                 1715
         L     @06,CTRADDR                                         1715
         ST    @06,PACKTRAK                                        1715
*              PACKTRK = ALTTRACK;                                 1716
         NI    PACKTRK,B'01111111'                                 1716
*              PACKASC = CTRADDR;                                  1717
         ST    @06,PACKASC                                         1717
*              CALL BILDPACK;                                      1718
         BAL   @14,BILDPACK                                        1718
*/*            END-THEN                                              */
*              END;                                                1719
*/*        LEAVE                                                     */
*          GOTO ENDLOOP2;                                          1720
         B     ENDLOOP2                                            1720
*/*        END-THEN                                                  */
*          END;                                                    1721
*/*      ELSE (RE-ASSIGNMENT UNSUCCESSFUL)                           */
*        ELSE DO;                                                  1722
*                                                                  1722
@RF01686 DS    0H                                                  1723
*/*        IF AN UNRECOVERABLE TRACK HAS BEEN FOUND                  */
*          IF RETCODE = UNTRRAFF                                   1723
*/*          THEN                                                    */
*            THEN DO;                                              1723
*                                                                  1723
         CLC   RETCODE(4),@CF00255                                 1723
         BNE   @RF01723                                            1723
*/*            COUNT_UNRECOVERABLE_TRACKS                            */
*              UNTRTYPE = ALTTRACK;                                1725
         NI    UNTRTYPE,B'01111111'                                1725
*              CALL COUNTRKS;                                      1726
         BAL   @14,COUNTRKS                                        1726
*/*            IF A SEVERE ERROR HAS OCCURRED                        */
*              IF LASTCOND >= LASTCC12                             1727
*/*              THEN LEAVE                                          */
*                THEN DO;    GOTO ENDLOOP2; END;                   1727
         L     @06,@PC00001+8                                      1727
         LH    @06,LASTCOND(,@06)                                  1727
         CH    @06,@CH00265                                        1727
         BL    @RF01727                                            1727
         B     ENDLOOP2                                            1729
*/*            END-THEN                                              */
*              END;                                                1731
@RF01727 DS    0H                                                  1732
*/*        IF THERE ARE NO MORE ALTERNATES                           */
*          IF RETCODE = NOALTS                                     1732
*/*          THEN                                                    */
*            THEN DO;                                              1732
*                                                                  1732
@RF01723 CLC   RETCODE(4),@CF00165                                 1732
         BNE   @RF01732                                            1732
*/*            ISSUE ERROR MESSAGE (MSGALTB) (UPRINT)                */
*              DARGSENT = MSGALTB;                                 1734
         L     @06,DDSTRU                                          1734
         MVI   DARGSENT(@06),X'12'                                 1734
*              CALL ICKTPPR0 (GDTTBL                               1735
*                     ,PRTFILE                                     1735
*                     ,DDSTRU);                                    1735
         L     @06,@PC00001                                        1735
         ST    @06,@AL00001                                        1735
         LA    @15,@CF00094                                        1735
         ST    @15,@AL00001+4                                      1735
         LA    @15,DDSTRU                                          1735
         ST    @15,@AL00001+8                                      1735
         MVI   @AL00001+8,X'80'                                    1735
         L     @15,GDTPRT(,@06)                                    1735
         LA    @01,@AL00001                                        1735
         BALR  @14,@15                                             1735
*/*            INDICATE AN ERROR (LASTCOND = 8)                      */
*              LASTCOND = MAX(LASTCOND,LASTCC08);                  1736
         L     @06,@PC00001+8                                      1736
         LH    @15,LASTCOND(,@06)                                  1736
         LA    @14,8                                               1736
         CR    @15,@14                                             1736
         BNL   *+6
         LR    @15,@14                                             1736
         STH   @15,LASTCOND(,@06)                                  1736
*/*            INDICATE NO MORE ALTERNATES LEFT                      */
*              ALTFLAG = MORENO;                                   1737
         OI    ALTFLAG,B'10000000'                                 1737
*/*            LEAVE                                                 */
*              GOTO ENDLOOP2;                                      1738
         B     ENDLOOP2                                            1738
*/*            END-THEN                                              */
*              END;                                                1739
*/*        IF ASSOCIATION OF THE NEW ALTERNATE TO THE PRIMARY FAILS  */
*          IF RETCODE = NOPASSOC                                   1740
*/*          THEN                                                    */
*            THEN DO;                                              1740
*                                                                  1740
@RF01732 CLC   RETCODE(4),@CF00116                                 1740
         BNE   @RF01740                                            1740
*/*            COUNT_UNRECOVERABLE_TRACKS                            */
*              UNTRACK = CTRADDR;                                  1742
         MVC   UNTRACK(4),CTRADDR                                  1742
*              UNTRTYPE = PRITRACK;                                1743
         OI    UNTRTYPE,B'10000000'                                1743
*              CALL COUNTRKS;                                      1744
         BAL   @14,COUNTRKS                                        1744
*/*            LEAVE                                                 */
*              GOTO ENDLOOP2;                                      1745
         B     ENDLOOP2                                            1745
*/*            END-THEN                                              */
*              END;                                                1746
*/*        IF ASSOCIATION OF THE PRIMARY TO THE NEW ALTERNATE FAILS  */
*          IF RETCODE = NOAASSOC                                   1747
*/*          THEN                                                    */
*            THEN DO;                                              1747
*                                                                  1747
@RF01740 CLC   RETCODE(4),@CF00136                                 1747
         BNE   @RF01747                                            1747
*/*            COUNT_UNRECOVERABLE_TRACKS                            */
*              UNTRTYPE = ALTTRACK;                                1749
         NI    UNTRTYPE,B'01111111'                                1749
*              CALL COUNTRKS;                                      1750
         BAL   @14,COUNTRKS                                        1750
*/*            IF A  SEVERE ERROR HAS OCCURRED                       */
*              IF LASTCOND >= LASTCC12                             1751
*/*              THEN LEAVE                                          */
*                THEN DO;    GOTO ENDLOOP2; END;                   1751
         L     @06,@PC00001+8                                      1751
         LH    @06,LASTCOND(,@06)                                  1751
         CH    @06,@CH00265                                        1751
         BL    @RF01751                                            1751
         B     ENDLOOP2                                            1753
*/*            END-THEN                                              */
*              END;                                                1755
@RF01751 DS    0H                                                  1756
*/*        IF DISSOCIATION OF THE OLD ALTERNATE FROM THE PRIM. FAILS */
*          IF RETCODE = NODISSOC                                   1756
*/*          THEN                                                    */
*            THEN DO;                                              1756
*                                                                  1756
@RF01747 CLC   RETCODE(4),@CF00044                                 1756
         BNE   @RF01756                                            1756
*/*            COUNT_UNRECOVERABLE_TRACKS                            */
*              UNTRACK = RZCCHH;                                   1758
         MVC   UNTRACK(4),RZCCHH                                   1758
*              UNTRTYPE = ALTTRACK;                                1759
         NI    UNTRTYPE,B'01111111'                                1759
*              CALL COUNTRKS;                                      1760
         BAL   @14,COUNTRKS                                        1760
*/*            IF A SEVERE ERROR HAS OCCURRED                        */
*              IF LASTCOND >= LASTCC12                             1761
*/*              THEN LEAVE                                          */
*                THEN DO;    GOTO ENDLOOP2; END;                   1761
         L     @06,@PC00001+8                                      1761
         LH    @06,LASTCOND(,@06)                                  1761
         CH    @06,@CH00265                                        1761
         BL    @RF01761                                            1761
         B     ENDLOOP2                                            1763
*/*            END-THEN                                              */
*              END;                                                1765
@RF01761 DS    0H                                                  1766
*/*        END-ELSE (RE-ASSIGNMENT UNSUCCESSFUL)                     */
*          END;                                                    1766
@RF01756 DS    0H                                                  1767
*/*  END-UNTIL                                                       */
*    END;                                                          1767
@DE01684 L     @06,RETCODE                                         1767
         LTR   @06,@06                                             1767
         BNZ   @DL01684                                            1767
*/*  END-SUB-PROCEDURE ISSUE_RE-ASSIGN_ALTERNATE_TRACK               */
*    ENDLOOP2:                                                     1768
*    END RASGNALT;                                                 1768
*                                                                  1768
         B     @EL00020                                            1768
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  REPTRACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE RECLAIM PRIMARY TRACK                  */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION WHICH      */
*/*    RECLAIMS A PRIMARY TRACK THAT HAS BEEN DETERMINED TO BE A     */
*/*    USABLE TRACK. ALL THE CONDITION CODE PROCESSING AFTER THE     */
*/*    INVOCATION IS HANDLED HERE.                                   */
*/*    IN THE EVENT THAT AN ALTERNATE TRACK, ASSOCIATED WITH THIS    */
*/*    PRIMARY TRACK, IS NOT SUCCESSFULLY DISSOCIATED BUT HAS ITS    */
*/*    DEFECT-FLAG SET DUE TO ERROR RECOVERY, A WARNING MESSAGE      */
*/*    ABOUT THAT TRACK IS POSTED AND PROCESSING CONTINUED.          */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1769
*                                                                  1769
*/*  SUB-PROCEDURE ISSUE_RECLAIM_PRIMARY_TRACK                       */
*    REPTRACK:                                                     1769
*      PROCEDURE;                                                  1769
REPTRACK STM   @14,@12,@SA00021                                    1769
*    OLDERID2 = NEWERID2;                                          1770
         L     @06,@PC00001                                        1770
         L     @15,GDTTR2(,@06)                                    1770
         MVC   @TS00001(95),NEWERID2(@15)                          1770
         MVC   OLDERID2(95,@15),@TS00001                           1770
*    NEWID2 =  'INRP';                                             1771
         MVC   NEWID2(4,@15),@CC00904                              1771
*/*  SET UP THE COUNT OF AVAILABLE ALTERNATE TRACKS                  */
*    ALTPCNT = ALTCOUNT;                                           1772
         MVC   ALTPCNT(4),ALTCOUNT                                 1772
*/*  RECLAIM_PRIMARY_TRACK                                           */
*    CALL ICKRP01                                                  1773
*         (GDTTBL                                                  1773
*         ,VOLIB                                                   1773
*         ,CTRADDR                                                 1773
*         ,CTRADDR                                                 1773
*         ,ALTPCNT                                                 1773
*         ,ALTPTR                                                  1773
*         ,RETCODE);                                               1773
         ST    @06,@AL00001                                        1773
         LA    @06,VOLIB                                           1773
         ST    @06,@AL00001+4                                      1773
         LA    @06,CTRADDR                                         1773
         ST    @06,@AL00001+8                                      1773
         LA    @06,CTRADDR                                         1773
         ST    @06,@AL00001+12                                     1773
         LA    @06,ALTPCNT                                         1773
         ST    @06,@AL00001+16                                     1773
         LA    @06,ALTPTR                                          1773
         ST    @06,@AL00001+20                                     1773
         LA    @06,RETCODE                                         1773
         ST    @06,@AL00001+24                                     1773
         L     @15,@CV00905                                        1773
         LA    @01,@AL00001                                        1773
         BALR  @14,@15                                             1773
*/*  IF RECLAMATION SUCCEEDS                                         */
*    IF RETCODE = SUCCESS                                          1774
*/*    THEN                                                          */
*      THEN DO;                                                    1774
*                                                                  1774
         L     @06,RETCODE                                         1774
         LTR   @06,@06                                             1774
         BNZ   @RF01774                                            1774
*/*      SET MESSAGE ARGUMENT (MSGRCLP)                              */
*        DARGSENT = MSGRCLP;                                       1776
         L     @06,DDSTRU                                          1776
         MVI   DARGSENT(@06),X'16'                                 1776
*/*      SAVE THE DEFECT-FLAG RESETTING                              */
*        DFLAGC = NODEFECT;                                        1777
         NI    DFLAGC,B'01111111'                                  1777
*/*      END-THEN                                                    */
*        END;                                                      1778
*/*    ELSE                                                          */
*      ELSE DO;                                                    1779
*                                                                  1779
         B     @RC01774                                            1779
@RF01774 DS    0H                                                  1780
*/*      IF RECLAMATION FAILS AND TRACK IS UNRECOVERABLE             */
*        IF RETCODE = REPFAIL                                      1780
*/*        THEN COUNT_UNRECOVERABLE_TRACKS (PRIMARY TRACK)           */
*          THEN DO;                                                1780
*                                                                  1780
         CLC   RETCODE(4),@CF00116                                 1780
         BNE   @RF01780                                            1780
*            UNTRACK = CTRADDR;                                    1782
         MVC   UNTRACK(4),CTRADDR                                  1782
*            UNTRTYPE = PRITRACK;                                  1783
         OI    UNTRTYPE,B'10000000'                                1783
*            CALL COUNTRKS;                                        1784
         BAL   @14,COUNTRKS                                        1784
*            END;                                                  1785
*/*      IF DISSOCIATION FAILS AND TRACK IS UNRECOVERABLE            */
*        IF RETCODE = DISFAILU                                     1786
*/*        THEN COUNT_UNRECOVERABLE_TRACKS (ALTERNATE TRACK)         */
*          THEN DO;                                                1786
*                                                                  1786
@RF01780 CLC   RETCODE(4),@CF00044                                 1786
         BNE   @RF01786                                            1786
*            UNTRACK = CTRADDR;                                    1788
         MVC   UNTRACK(4),CTRADDR                                  1788
*            UNTRTYPE = ALTTRACK;                                  1789
         NI    UNTRTYPE,B'01111111'                                1789
*            CALL COUNTRKS;                                        1790
         BAL   @14,COUNTRKS                                        1790
*            END;                                                  1791
*/*      IF RECLAMATION FAILS BUT TRACK IS RECOVERED                 */
*        IF RETCODE = REPFAILR                                     1792
*/*        THEN                                                      */
*          THEN DO;                                                1792
*                                                                  1792
@RF01786 CLC   RETCODE(4),@CF00165                                 1792
         BNE   @RF01792                                            1792
*/*          SET MESSAGE ARGUMENT (MSGRCLPF)                         */
*            DARGSENT = MSGRCLPF;                                  1794
         L     @06,DDSTRU                                          1794
         MVI   DARGSENT(@06),X'20'                                 1794
*/*          ISSUE_BUILD_PACK_MAP (TRACK DEFECT-FLAG STILL SET)      */
*            PACKDEF  = DEFECTIV;                                  1795
         OI    PACKDEF,B'10000000'                                 1795
*            PACKCHEK = NODEFECT;                                  1796
         NI    PACKCHEK,B'01111111'                                1796
*            PACKRCVR = RCVRYES;                                   1797
         NI    PACKRCVR,B'01111111'                                1797
*            PACKTRK  = PRITRACK;                                  1798
         OI    PACKTRK,B'10000000'                                 1798
*            PACKTRAK = CTRADDR;                                   1799
         L     @06,CTRADDR                                         1799
         ST    @06,PACKTRAK                                        1799
*            PACKASC = CTRADDR;                                    1800
         ST    @06,PACKASC                                         1800
*            CALL BILDPACK;                                        1801
         BAL   @14,BILDPACK                                        1801
*/*          INDICATE AN ERROR                                       */
*            LASTCOND = MAX(LASTCC08,LASTCOND);                    1802
         L     @06,@PC00001+8                                      1802
         LH    @15,LASTCOND(,@06)                                  1802
         LA    @14,8                                               1802
         CR    @15,@14                                             1802
         BNL   *+6
         LR    @15,@14                                             1802
         STH   @15,LASTCOND(,@06)                                  1802
*/*          SAVE THE DEFECT-FLAG RESETTING                          */
*            DFLAGC = DEFECTIV;                                    1803
         OI    DFLAGC,B'10000000'                                  1803
*/*          IF FIRST TRACK ON PACK                                  */
*            IF CTRADDR = 0                                        1804
*/*            THEN INDICATE THAT IT IS DEFECTIVE                    */
*              THEN DO;    FTRKFLG = DEFECTIV; END;                1804
         L     @06,CTRADDR                                         1804
         LTR   @06,@06                                             1804
         BNZ   @RF01804                                            1804
         OI    FTRKFLG,B'10000000'                                 1806
*/*          END-THEN                                                */
*            END;                                                  1808
@RF01804 DS    0H                                                  1809
*/*      IF DISSOCIATION FAILS BUT TRACK RECOVERED                   */
*        IF RETCODE = DISFAILR                                     1809
*/*        THEN                                                      */
*          THEN DO;                                                1809
*                                                                  1809
@RF01792 CLC   RETCODE(4),@CF00136                                 1809
         BNE   @RF01809                                            1809
*/*          SAVE THE DEFECT-FLAG RESETTING                          */
*            DFLAGC = NODEFECT;                                    1811
         NI    DFLAGC,B'01111111'                                  1811
*/*          SET WARNING MESSAGE ARGUMENT (MSGDISPF)                 */
*            DARGSENT = MSGDISPF;                                  1812
         L     @06,DDSTRU                                          1812
         MVI   DARGSENT(@06),X'21'                                 1812
*/*          ISSUE_BUILD_PACK_MAP (ALTERNATE TRACK DEFECT-FLAG SET)  */
*            PACKDEF  = DEFECTIV;                                  1813
         OI    PACKDEF,B'10000000'                                 1813
*            PACKCHEK = NODEFECT;                                  1814
         NI    PACKCHEK,B'01111111'                                1814
*            PACKRCVR = RCVRYES;                                   1815
         NI    PACKRCVR,B'01111111'                                1815
*            PACKTRK  = ALTTRACK;                                  1816
         NI    PACKTRK,B'01111111'                                 1816
*            PACKTRAK = CTRADDR;                                   1817
         L     @06,CTRADDR                                         1817
         ST    @06,PACKTRAK                                        1817
*            PACKASC = CTRADDR;                                    1818
         ST    @06,PACKASC                                         1818
*            CALL BILDPACK;                                        1819
         BAL   @14,BILDPACK                                        1819
*/*          INDICATE MINOR ERROR (LASTCOND = 4)                     */
*            LASTCOND = MAX(LASTCC04,LASTCOND);                    1820
         L     @06,@PC00001+8                                      1820
         LH    @15,LASTCOND(,@06)                                  1820
         LA    @14,4                                               1820
         CR    @15,@14                                             1820
         BNL   *+6
         LR    @15,@14                                             1820
         STH   @15,LASTCOND(,@06)                                  1820
*/*          END-THEN                                                */
*            END;                                                  1821
*/*      END-ELSE (RECLAMATION UNSUCCESSFUL)                         */
*        END;                                                      1822
@RF01809 DS    0H                                                  1823
*/*  IF A MESSAGE ARGUMENT WAS SET                                   */
*    IF (DARGSENT = MSGRCLP)  (DARGSENT = MSGRCLPF)               1823
*      (DARGSENT = MSGDISPF)                                      1823
*/*    THEN ISSUE MESSAGE (UPRINT)                                   */
*      THEN DO;                                                    1823
*                                                                  1823
@RC01774 L     @06,DDSTRU                                          1823
         CLI   DARGSENT(@06),22                                    1823
         BE    @RT01823                                            1823
         CLI   DARGSENT(@06),32                                    1823
         BE    @RT01823                                            1823
         CLI   DARGSENT(@06),33                                    1823
         BNE   @RF01823                                            1823
@RT01823 DS    0H                                                  1824
*        DARGCNT = 2;                                              1825
         LA    @06,2                                               1825
         L     @15,DDSTRU                                          1825
         STH   @06,DARGCNT(,@15)                                   1825
*        DARGINS (1) = 1;                                          1826
         MVC   DARGINS(2,@15),@CH00165                             1826
*        DARGINL (1) = LENGTH (CTRADDRC);                          1827
         STH   @06,DARGINL(,@15)                                   1827
*        DARGDTM (1) = ADDR (CTRADDRC);                            1828
         LA    @14,CTRADDRC                                        1828
         ST    @14,DARGDTM(,@15)                                   1828
*        DARGINS (2) = 2;                                          1829
         STH   @06,DARGINS+8(,@15)                                 1829
*        DARGINL (2) = LENGTH (CTRADDRT);                          1830
         STH   @06,DARGINL+8(,@15)                                 1830
*        DARGDTM (2) = ADDR (CTRADDRT);                            1831
         LA    @06,CTRADDRT                                        1831
         ST    @06,DARGDTM+8(,@15)                                 1831
*        CALL ICKTPPR0 (GDTTBL                                     1832
*               ,PRTFILE                                           1832
*               ,DDSTRU);                                          1832
         L     @06,@PC00001                                        1832
         ST    @06,@AL00001                                        1832
         LA    @15,@CF00094                                        1832
         ST    @15,@AL00001+4                                      1832
         LA    @15,DDSTRU                                          1832
         ST    @15,@AL00001+8                                      1832
         MVI   @AL00001+8,X'80'                                    1832
         L     @15,GDTPRT(,@06)                                    1832
         LA    @01,@AL00001                                        1832
         BALR  @14,@15                                             1832
*        END;                                                      1833
*/*  END-SUB-PROCEDURE ISSUE_RECLAIM_PRIMARY_TRACK                   */
*    END REPTRACK;                                                 1834
*                                                                  1834
@EL00021 DS    0H                                                  1834
@EF00021 DS    0H                                                  1834
@ER00021 LM    @14,@12,@SA00021                                    1834
         BR    @14                                                 1834
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  CREATLAB                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE CREATE VOLUME LABEL                    */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL INVOKE THE ELEMENTARY FUNCTION        */
*/*    THAT WILL CREATE A VOLUME LABEL ON THE FIRST TRACK OF A       */
*/*    VOLUME AS PER USER SPECIFICATIONS. ALL THE CONDITION CODE     */
*/*    PROCESSING AFTER THE INVOCATION IS ALSO DONE HERE.            */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1835
*                                                                  1835
*/*  SUB-PROCEDURE ISSUE_CREATE_VOLUME_LABEL                         */
*    CREATLAB:                                                     1835
*      PROCEDURE;                                                  1835
CREATLAB STM   @14,@12,@SA00022                                    1835
*    OLDERID2 = NEWERID2;                                          1836
         L     @06,@PC00001                                        1836
         L     @06,GDTTR2(,@06)                                    1836
         MVC   @TS00001(95),NEWERID2(@06)                          1836
         MVC   OLDERID2(95,@06),@TS00001                           1836
*    NEWID2 =  'INCL';                                             1837
         MVC   NEWID2(4,@06),@CC00909                              1837
*/*  CREATE_VOLUME_LABEL                                             */
*    IF ADDR(VOLID) ^= NULLPTR                                     1838
*      THEN DO;    VLNSER = VOLIDVAL; END;                         1838
         L     @06,@PC00001+4                                      1838
         L     @06,FDTPTR+40(,@06)                                 1838
         LTR   @06,@06                                             1838
         BZ    @RF01838                                            1838
         MVC   VLNSER(6),VOLIDVAL(@06)                             1840
*      ELSE IF OLDVSER ^= ' '                                      1842
*             THEN DO;                                             1842
*                                                                  1842
         B     @RC01838                                            1842
@RF01838 CLI   OLDVSER,C' '                                        1842
         BE    @RF01842                                            1842
*               VLNSER = OLDVSER;                                  1844
         MVC   VLNSER(6),OLDVSER                                   1844
*               END;                                               1845
*             ELSE DO;    VLNSER = ' '; END;                       1846
         B     @RC01842                                            1846
@RF01842 DS    0H                                                  1847
         MVI   VLNSER+1,C' '                                       1847
         MVC   VLNSER+2(4),VLNSER+1                                1847
         MVI   VLNSER,C' '                                         1847
*    IF ADDR(OWNER) ^= NULLPTR                                     1849
*      THEN DO;    OWNERID = OWNERVAL; END;                        1849
@RC01842 DS    0H                                                  1849
@RC01838 L     @06,@PC00001+4                                      1849
         L     @06,FDTPTR+44(,@06)                                 1849
         LTR   @06,@06                                             1849
         BZ    @RF01849                                            1849
         MVC   OWNERID(14),OWNERVAL(@06)                           1851
*      ELSE IF OLDOWNER ^= ' '                                     1853
*             THEN DO;                                             1853
*                                                                  1853
         B     @RC01849                                            1853
@RF01849 CLI   OLDOWNER,C' '                                       1853
         BE    @RF01853                                            1853
*               OWNERID = OLDOWNER;                                1855
         MVC   OWNERID(14),OLDOWNER                                1855
*               END;                                               1856
*             ELSE DO;    OWNERID = ' '; END;                      1857
         B     @RC01853                                            1857
@RF01853 DS    0H                                                  1858
         MVI   OWNERID+1,C' '                                      1858
         MVC   OWNERID+2(12),OWNERID+1                             1858
         MVI   OWNERID,C' '                                        1858
*    IF ADDR(LBL) ^= NULLPTR                                       1860
*      THEN DO;                                                    1860
*                                                                  1860
@RC01853 DS    0H                                                  1860
@RC01849 SLR   @06,@06                                             1860
         L     @15,@PC00001+4                                      1860
         C     @06,FDTPTR+48(,@15)                                 1860
         BE    @RF01860                                            1860
*        IF ADDR(MIMIC) ^= NULLPTR & ADDR(MSS) ^= NULLPTR          1862
*          THEN DO;                                                1862
*                                                                  1862
         C     @06,FDTPTR+88(,@15)                                 1862
         BE    @RF01862                                            1862
         C     @06,FDTPTR+92(,@15)                                 1862
         BE    @RF01862                                            1862
*            DARGSENT = MSGMSSL;                                   1864
         L     @06,DDSTRU                                          1864
         MVI   DARGSENT(@06),X'33'                                 1864
*            CALL ICKTPPR0 (GDTTBL                                 1865
*                   ,PRTFILE                                       1865
*                   ,DDSTRU);                                      1865
         L     @06,@PC00001                                        1865
         ST    @06,@AL00001                                        1865
         LA    @15,@CF00094                                        1865
         ST    @15,@AL00001+4                                      1865
         LA    @15,DDSTRU                                          1865
         ST    @15,@AL00001+8                                      1865
         MVI   @AL00001+8,X'80'                                    1865
         L     @15,GDTPRT(,@06)                                    1865
         LA    @01,@AL00001                                        1865
         BALR  @14,@15                                             1865
*            LABELS = 0;                                           1866
         SLR   @06,@06                                             1866
         ST    @06,LABELS                                          1866
*/*          INDICATE A MINOR ERROR                                  */
*            LASTCOND = MAX(LASTCOND,LASTCC04);                    1867
         L     @06,@PC00001+8                                      1867
         LH    @15,LASTCOND(,@06)                                  1867
         LA    @14,4                                               1867
         CR    @15,@14                                             1867
         BNL   *+6
         LR    @15,@14                                             1867
         STH   @15,LASTCOND(,@06)                                  1867
*            END;                                                  1868
*          ELSE DO;                                                1869
*                                                                  1869
         B     @RC01862                                            1869
@RF01862 DS    0H                                                  1870
*            LABELS = LBLVAL;                                      1870
         L     @06,@PC00001+4                                      1870
         L     @06,FDTPTR+48(,@06)                                 1870
         MVC   LABELS(4),LBLVAL(@06)                               1870
*            END;                                                  1871
*        END;                                                      1872
*      ELSE DO;    LABELS = 0; END;                                1873
         B     @RC01860                                            1873
@RF01860 DS    0H                                                  1874
         SLR   @06,@06                                             1874
         ST    @06,LABELS                                          1874
*    CALL ICKCL01                                                  1876
*         (GDTTBL                                                  1876
*         ,VOLIB                                                   1876
*         ,VLNSER                                                  1876
*         ,OWNERID                                                 1876
*         ,OLDVTOC                                                 1876
*         ,LABELS                                                  1876
*         ,RETCODE);                                               1876
@RC01860 L     @06,@PC00001                                        1876
         ST    @06,@AL00001                                        1876
         LA    @06,VOLIB                                           1876
         ST    @06,@AL00001+4                                      1876
         LA    @06,VLNSER                                          1876
         ST    @06,@AL00001+8                                      1876
         LA    @06,OWNERID                                         1876
         ST    @06,@AL00001+12                                     1876
         LA    @06,OLDVTOC                                         1876
         ST    @06,@AL00001+16                                     1876
         LA    @06,LABELS                                          1876
         ST    @06,@AL00001+20                                     1876
         LA    @06,RETCODE                                         1876
         ST    @06,@AL00001+24                                     1876
         L     @15,@CV00910                                        1876
         LA    @01,@AL00001                                        1876
         BALR  @14,@15                                             1876
*/*  IF VOLUME LABEL CREATION FAILS                                  */
*    IF RETCODE = FAILURE                                          1877
*/*    THEN                                                          */
*      THEN DO;                                                    1877
*                                                                  1877
         CLC   RETCODE(4),@CF00165                                 1877
         BNE   @RF01877                                            1877
*/*      ISSUE ERROR MESSAGE (MSGLBLSB) (UPRINT)                     */
*        DARGSENT = MSGLBLSB;                                      1879
         L     @06,DDSTRU                                          1879
         MVI   DARGSENT(@06),X'07'                                 1879
*        CALL ICKTPPR0 (GDTTBL                                     1880
*               ,PRTFILE                                           1880
*               ,DDSTRU);                                          1880
         L     @06,@PC00001                                        1880
         ST    @06,@AL00001                                        1880
         LA    @15,@CF00094                                        1880
         ST    @15,@AL00001+4                                      1880
         LA    @15,DDSTRU                                          1880
         ST    @15,@AL00001+8                                      1880
         MVI   @AL00001+8,X'80'                                    1880
         L     @15,GDTPRT(,@06)                                    1880
         LA    @01,@AL00001                                        1880
         BALR  @14,@15                                             1880
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      1881
         L     @06,@PC00001+8                                      1881
         MVC   LASTCOND(2,@06),@CH00265                            1881
*/*      END-THEN (VOLUME LABEL CREATION FAILS)                      */
*        END;                                                      1882
*/*  END-SUB-PROCEDURE ISSUE_CREATE_VOLUME_LABEL                     */
*    END CREATLAB;                                                 1883
*                                                                  1883
@EL00022 DS    0H                                                  1883
@EF00022 DS    0H                                                  1883
@ER00022 LM    @14,@12,@SA00022                                    1883
         BR    @14                                                 1883
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  ESTTRINT                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ESTABLISH TRACK INTEGRITY                    */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL CHECK THE PHYSICAL STATE OF THE       */
*/*    TRACK (ALTERNATE OR PRIMARY) AGAINST THE ACTUAL STATE THAT    */
*/*    IS EXPECTED FOR THE TRACK. IF THERE IS A DISPARITY THIS       */
*/*    SUB-PROCEDURE WILL CORRECT THE DISPARITY.                     */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1884
*                                                                  1884
*/*  SUB-PROCEDURE ESTABLISH_TRACK_INTEGRITY                         */
*    ESTTRINT:                                                     1884
*      PROCEDURE                                                   1884
*        (                                                         1884
*        ESTADDR,                                                  1884
*        ESTASSOC,                                                 1884
*        ESTDFLAG,                                                 1884
*        ESTRFLAG,                                                 1884
*        ESTCODE,                                                  1884
*        ESTTYPE                                                   1884
*        );                                                        1884
ESTTRINT STM   @14,@12,@SA00023                                    1884
         MVC   @PC00023(24),0(@01)                                 1884
*    OLDERID2 = NEWERID2;                                          1885
         L     @06,@PC00001                                        1885
         L     @06,GDTTR2(,@06)                                    1885
         MVC   @TS00001(95),NEWERID2(@06)                          1885
         MVC   OLDERID2(95,@06),@TS00001                           1885
*    NEWID2 =  'INET';                                             1886
*                                                                  1886
         MVC   NEWID2(4,@06),@CC00926                              1886
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/
*                                                                  1887
*      1 ESTADDR             /* ADDRESS OF TRACK TO BE EXAMINED      */
*                            FIXED (32),                           1887
*                                                                  1887
*        2 ESTADDRC          /* CYLINDER NUMBER                      */
*                            FIXED (16),                           1887
*                                                                  1887
*        2 ESTADDRH          /* TRACK NUMBER                         */
*                            FIXED (16),                           1887
*                                                                  1887
*      ESTASSOC              /* ASSOCIATION ADDRESS IN RECORD ZERO   */
*                            FIXED (32),                           1887
*                                                                  1887
*      ESTDFLAG              /* DEFECT-FLAG INDICATOR                */
*                            /* ON DEFECT-FLAG IS SET  OFF NOT SET   */
*                            BIT (1),                              1887
*                                                                  1887
*      ESTRCODE              /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31),                           1887
*                                                                  1887
*      ESTRFLAG              /* FLAG TO INDICATE IF TRACK IS         */
*                            /* RECOVERABLE OR NOT                   */
*                            /* ON: UNRECOVERABLE; OFF: RECOVERABLE  */
*                            BIT (1),                              1887
*                                                                  1887
*      ESTCODE               /* RETURN CODE THAT INDICATES THE       */
*                            /* PHYSICAL STATE OF THE TRACK          */
*                            FIXED (31),                           1887
*                                                                  1887
*      ESTTYPE               /* FLAG TO INDICATE IF THE TRACK IS     */
*                            /* A PRIMARY OR AN ALTERNATE            */
*                            /* PRITRACK: PRIMARY; ALTTRACK:ALTERNATE*/
*                            BIT (1);                              1887
*                                                                  1887
*/*  INITIALIZE ACTION KEY TO ZERO (HAACTION)                        */
*    HAACTION = 0;                                                 1888
         SLR   @06,@06                                             1888
         ST    @06,HAACTION                                        1888
*/*  IF TRACK IS A PRIMARY                                           */
*    IF ESTTYPE = PRITRACK                                         1889
*/*    THEN                                                          */
*      THEN DO;                                                    1889
*                                                                  1889
         L     @06,@PC00023+20                                     1889
         TM    ESTTYPE(@06),B'10000000'                            1889
         BNO   @RF01889                                            1889
*/*      IF READ OPERATION INDICATES AN ALTERNATE TRACK              */
*        IF (ESTCODE = DFLAGONA)  (ESTCODE = DFLAGOFA)            1891
*/*        THEN                                                      */
*          THEN DO;                                                1891
*                                                                  1891
         L     @06,@PC00023+16                                     1891
         L     @06,ESTCODE(,@06)                                   1891
         CH    @06,@CH00119                                        1891
         BE    @RT01891                                            1891
         CH    @06,@CH00185                                        1891
         BNE   @RF01891                                            1891
@RT01891 DS    0H                                                  1892
*/*          IF THE DEFECT-FLAG WAS FOUND TO BE SET                  */
*            IF ESTCODE = DFLAGONA                                 1893
*/*            THEN                                                  */
*              THEN DO;                                            1893
*                                                                  1893
         L     @06,@PC00023+16                                     1893
         CLC   ESTCODE(4,@06),@CF00119                             1893
         BNE   @RF01893                                            1893
*/*              SET ACTION KEY TO WRITE A PRIMARY HA WITH           */
*/*               DEFECT-FLAG SET                                    */
*                HAACTION = ACTWPHAD;                              1895
         MVC   HAACTION(4),@CF00136                                1895
*/*              SAVE THE SETTING OF DEFECT-FLAG                     */
*                ESTDFLAG = DEFECTIV;                              1896
         L     @06,@PC00023+8                                      1896
         OI    ESTDFLAG(@06),B'10000000'                           1896
*/*              END-THEN                                            */
*                END;                                              1897
*/*            ELSE                                                  */
*              ELSE DO;                                            1898
*                                                                  1898
         B     @RC01893                                            1898
@RF01893 DS    0H                                                  1899
*/*              SET ACTION KEY TO WRITE A PRIMARY HA WITH           */
*/*               DEFECT-FLAG NOT SET                                */
*                HAACTION = ACTWPHA;                               1899
         MVC   HAACTION(4),@CF00044                                1899
*/*              SAVE THE SETTING OF DEFECT-FLAG                     */
*                ESTDFLAG = NODEFECT;                              1900
         L     @06,@PC00023+8                                      1900
         NI    ESTDFLAG(@06),B'01111111'                           1900
*/*              END-ELSE                                            */
*                END;                                              1901
*/*          END-THEN (TRACK IS AN ALTERNATE)                        */
*            END;                                                  1902
*/*      END-THEN (TRACK IS A PRIMARY)                               */
*        END;                                                      1903
*/*    ELSE (TRACK IS AN ALTERNATE TRACK)                            */
*      ELSE DO;                                                    1904
*                                                                  1904
         B     @RC01889                                            1904
@RF01889 DS    0H                                                  1905
*/*      IF READ OPERATION INDICATES A PRIMARY TRACK                 */
*        IF (ESTCODE = DFLAGONP)  (ESTCODE = DFLAGOFP)            1905
*/*        THEN                                                      */
*          THEN DO;                                                1905
*                                                                  1905
         L     @06,@PC00023+16                                     1905
         L     @06,ESTCODE(,@06)                                   1905
         CH    @06,@CH00116                                        1905
         BE    @RT01905                                            1905
         CH    @06,@CH00136                                        1905
         BNE   @RF01905                                            1905
@RT01905 DS    0H                                                  1906
*/*          IF THE DEFECT-FLAG WAS FOUND TO BE SET                  */
*            IF ESTCODE = DFLAGONP                                 1907
*/*            THEN                                                  */
*              THEN DO;                                            1907
*                                                                  1907
         L     @06,@PC00023+16                                     1907
         CLC   ESTCODE(4,@06),@CF00116                             1907
         BNE   @RF01907                                            1907
*/*              SET ACTION KEY TO WRITE AN ALTERNATE HA WITH        */
*/*               DEFECT-FLAG SET                                    */
*                HAACTION = ACTWAHAD;                              1909
         MVC   HAACTION(4),@CF00255                                1909
*/*              SAVE THE SETTING OF DEFECT-FLAG                     */
*                ESTDFLAG = DEFECTIV;                              1910
         L     @06,@PC00023+8                                      1910
         OI    ESTDFLAG(@06),B'10000000'                           1910
*/*              END-THEN                                            */
*                END;                                              1911
*/*            ELSE                                                  */
*              ELSE DO;                                            1912
*                                                                  1912
         B     @RC01907                                            1912
@RF01907 DS    0H                                                  1913
*/*              SET ACTION KEY TO WRITE AN ALTERNATE HA WITH        */
*/*               DEFECT-FLAG NOT SET                                */
*                HAACTION = ACTWAHA;                               1913
         MVC   HAACTION(4),@CF00119                                1913
*/*              SAVE THE SETTING OF DEFECT-FLAG                     */
*                ESTDFLAG = NODEFECT;                              1914
         L     @06,@PC00023+8                                      1914
         NI    ESTDFLAG(@06),B'01111111'                           1914
*/*              END-ELSE                                            */
*                END;                                              1915
*/*          END-THEN (TRACK IS A PRIMARY)                           */
*            END;                                                  1916
@RC01907 DS    0H                                                  1917
*/*      END-ELSE (TRACK IS AN ALTERNATE)                            */
*        END;                                                      1917
@RF01905 DS    0H                                                  1918
*/*  IF ACTION KEY IS NOT ZERO (HAACTION)                            */
*    IF HAACTION ^= 0                                              1918
*/*    THEN                                                          */
*      THEN DO;                                                    1918
*                                                                  1918
@RC01889 L     @06,HAACTION                                        1918
         LTR   @06,@06                                             1918
         BZ    @RF01918                                            1918
*/*      WRITE THE APPROPRIATE HOME-ADDRESS ON THE TRACK             */
*        CALL ICKDVOP0 (GDTTBL                                     1920
*               ,VOLIB                                             1920
*               ,HAACTION                                          1920
*               ,ESTADDR                                           1920
*               ,RECNUM                                            1920
*               ,POOLID                                            1920
*               ,HAPTR                                             1920
*               ,HALEN                                             1920
*               ,ESTRCODE);                                        1920
         L     @06,@PC00001                                        1920
         ST    @06,@AL00001                                        1920
         LA    @15,VOLIB                                           1920
         ST    @15,@AL00001+4                                      1920
         LA    @15,HAACTION                                        1920
         ST    @15,@AL00001+8                                      1920
         L     @15,@PC00023                                        1920
         ST    @15,@AL00001+12                                     1920
         LA    @15,RECNUM                                          1920
         ST    @15,@AL00001+16                                     1920
         LA    @15,POOLID                                          1920
         ST    @15,@AL00001+20                                     1920
         LA    @15,HAPTR                                           1920
         ST    @15,@AL00001+24                                     1920
         LA    @15,HALEN                                           1920
         ST    @15,@AL00001+28                                     1920
         LA    @15,ESTRCODE                                        1920
         ST    @15,@AL00001+32                                     1920
         L     @15,GDTDOP(,@06)                                    1920
         LA    @01,@AL00001                                        1920
         BALR  @14,@15                                             1920
*/*      IF WRITE OPERATION FAILS                                    */
*        IF ESTRCODE = CPFAILS                                     1921
*/*        THEN                                                      */
*          THEN DO;                                                1921
*                                                                  1921
         CLC   ESTRCODE(4),@CF00044                                1921
         BNE   @RF01921                                            1921
*/*          SET FLAG TO INDICATE THE TRACK IS UNRECOVERABLE         */
*            ESTRFLAG = NORCVR;                                    1923
         L     @06,@PC00023+12                                     1923
         NI    ESTRFLAG(@06),B'01111111'                           1923
*/*          COUNT_UNRECOVERABLE_TRACKS                              */
*            UNTRACK = ESTADDR;                                    1924
         L     @06,@PC00023                                        1924
         MVC   UNTRACK(4),ESTADDR(@06)                             1924
*            IF ESTTYPE = PRITRACK                                 1925
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1925
         L     @06,@PC00023+20                                     1925
         TM    ESTTYPE(@06),B'10000000'                            1925
         BNO   @RF01925                                            1925
         OI    UNTRTYPE,B'10000000'                                1927
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1929
         B     @RC01925                                            1929
@RF01925 DS    0H                                                  1930
         NI    UNTRTYPE,B'01111111'                                1930
*            CALL COUNTRKS;                                        1932
@RC01925 BAL   @14,COUNTRKS                                        1932
*/*          IF TRACK IS AN ALTERNATE                                */
*            IF ESTTYPE = ALTTRACK                                 1933
*/*            THEN DECREMENT NUMBER OF AVAILABLE ALTERNATE          */
*/*             TRACKS BY ONE (ALTCOUNT)                             */
*              THEN DO;    ALTCOUNT = ALTCOUNT - 1; END;           1933
         L     @06,@PC00023+20                                     1933
         TM    ESTTYPE(@06),B'10000000'                            1933
         BNZ   @RF01933                                            1933
         L     @06,ALTCOUNT                                        1935
         BCTR  @06,0                                               1935
         ST    @06,ALTCOUNT                                        1935
*/*          END-THEN                                                */
*            END;                                                  1937
*/*        ELSE                                                      */
*          ELSE DO;                                                1938
*                                                                  1938
         B     @RC01921                                            1938
@RF01921 DS    0H                                                  1939
*/*          IF THE DEFECT-FLAG IS SET DUE TO RECOVERY               */
*            IF (ESTRCODE = DFLAGONP)  (ESTRCODE = DFLAGONA)      1939
*/*            THEN SAVE THE DEFECT-FLAG SETTING                     */
*              THEN DO;    ESTDFLAG = DEFECTIV; END;               1939
         L     @06,ESTRCODE                                        1939
         CH    @06,@CH00116                                        1939
         BE    @RT01939                                            1939
         CH    @06,@CH00119                                        1939
         BNE   @RF01939                                            1939
@RT01939 DS    0H                                                  1940
         L     @06,@PC00023+8                                      1941
         OI    ESTDFLAG(@06),B'10000000'                           1941
*/*          IF TRACK IS ASSOCIATED WITH ANOTHER TRACK               */
*            IF ESTASSOC ^= ESTADDR                                1943
*/*            THEN SET ACTION TO SAVE THE ASSOCIATION ADDRESS       */
*              THEN DO;                                            1943
@RF01939 L     @06,@PC00023+4                                      1943
         L     @15,@PC00023                                        1943
         CLC   ESTASSOC(4,@06),ESTADDR(@15)                        1943
         BE    @RF01943                                            1943
*                RZACTION = ACTWRZSL;                              1945
         MVC   RZACTION(4),@CF00276                                1945
*                DATAPTR = ADDR(ESTASSOC);                         1946
         ST    @06,DATAPTR                                         1946
*                DATALEN = LENGTH(ESTASSOC);                       1947
         MVC   DATALEN(4),@CF00044                                 1947
*                END;                                              1948
*/*            ELSE ASSOCIATE TRACK TO ITSELF                        */
*              ELSE DO;                                            1949
         B     @RC01943                                            1949
@RF01943 DS    0H                                                  1950
*                RZACTION = ACTWRZS;                               1950
         MVC   RZACTION(4),@CF00161                                1950
*                DATAPTR = ADDR(ESTADDR);                          1951
         L     @06,@PC00023                                        1951
         ST    @06,DATAPTR                                         1951
*                DATALEN = LENGTH(ESTADDR);                        1952
         MVC   DATALEN(4),@CF00044                                 1952
*                END;                                              1953
*/*          WRITE A STANDARD-LENGTH RECORD-ZERO (UDEVOP)            */
*            CALL ICKDVOP0 (GDTTBL                                 1954
*                   ,VOLIB                                         1954
*                   ,RZACTION                                      1954
*                   ,ESTADDR                                       1954
*                   ,RECNUM                                        1954
*                   ,POOLID                                        1954
*                   ,DATAPTR                                       1954
*                   ,DATALEN                                       1954
*                   ,ESTRCODE);                                    1954
@RC01943 L     @06,@PC00001                                        1954
         ST    @06,@AL00001                                        1954
         LA    @15,VOLIB                                           1954
         ST    @15,@AL00001+4                                      1954
         LA    @15,RZACTION                                        1954
         ST    @15,@AL00001+8                                      1954
         L     @15,@PC00023                                        1954
         ST    @15,@AL00001+12                                     1954
         LA    @15,RECNUM                                          1954
         ST    @15,@AL00001+16                                     1954
         LA    @15,POOLID                                          1954
         ST    @15,@AL00001+20                                     1954
         LA    @15,DATAPTR                                         1954
         ST    @15,@AL00001+24                                     1954
         LA    @15,DATALEN                                         1954
         ST    @15,@AL00001+28                                     1954
         LA    @15,ESTRCODE                                        1954
         ST    @15,@AL00001+32                                     1954
         L     @15,GDTDOP(,@06)                                    1954
         LA    @01,@AL00001                                        1954
         BALR  @14,@15                                             1954
*/*          IF WRITE OPERATION FAILS                                */
*            IF ESTRCODE = CPFAILS                                 1955
*/*            THEN                                                  */
*              THEN DO;                                            1955
*                                                                  1955
         CLC   ESTRCODE(4),@CF00044                                1955
         BNE   @RF01955                                            1955
*/*              SET FLAG TO INDICATE TRACK IS UNRECOVERABLE         */
*                ESTRFLAG = NORCVR;                                1957
         L     @06,@PC00023+12                                     1957
         NI    ESTRFLAG(@06),B'01111111'                           1957
*/*              COUNT_UNRECOVERABLE_TRACKS                          */
*                UNTRACK = ESTADDR;                                1958
         L     @06,@PC00023                                        1958
         MVC   UNTRACK(4),ESTADDR(@06)                             1958
*                IF ESTTYPE = PRITRACK                             1959
*                  THEN DO;    UNTRTYPE = PRITRACK; END;           1959
         L     @06,@PC00023+20                                     1959
         TM    ESTTYPE(@06),B'10000000'                            1959
         BNO   @RF01959                                            1959
         OI    UNTRTYPE,B'10000000'                                1961
*                  ELSE DO;    UNTRTYPE = ALTTRACK; END;           1963
         B     @RC01959                                            1963
@RF01959 DS    0H                                                  1964
         NI    UNTRTYPE,B'01111111'                                1964
*                CALL COUNTRKS;                                    1966
@RC01959 BAL   @14,COUNTRKS                                        1966
*/*              IF THE TRACK IS AN ALTERNATE                        */
*                IF ESTTYPE = ALTTRACK                             1967
*/*                THEN DECREMENT NUMBER OF AVAILABLE ALTERNATE      */
*/*                 TRACKS BY ONE (ALTCOUNT)                         */
*                  THEN DO;    ALTCOUNT = ALTCOUNT - 1; END;       1967
         L     @06,@PC00023+20                                     1967
         TM    ESTTYPE(@06),B'10000000'                            1967
         BNZ   @RF01967                                            1967
         L     @06,ALTCOUNT                                        1969
         BCTR  @06,0                                               1969
         ST    @06,ALTCOUNT                                        1969
*/*              END-THEN                                            */
*                END;                                              1971
*/*            ELSE                                                  */
*              ELSE DO;                                            1972
*                                                                  1972
         B     @RC01955                                            1972
@RF01955 DS    0H                                                  1973
*/*              IF THE DEFECT-FLAG IS SET DUE TO RECOVERY           */
*                IF (ESTRCODE = DFLAGONP)  (ESTRCODE = DFLAGONA)  1973
*/*                THEN SAVE THE DEFECT-FLAG SETTING                 */
*                  THEN DO;    ESTDFLAG = DEFECTIV; END;           1973
         L     @06,ESTRCODE                                        1973
         CH    @06,@CH00116                                        1973
         BE    @RT01973                                            1973
         CH    @06,@CH00119                                        1973
         BNE   @RF01973                                            1973
@RT01973 DS    0H                                                  1974
         L     @06,@PC00023+8                                      1975
         OI    ESTDFLAG(@06),B'10000000'                           1975
*/*              END-ELSE                                            */
*                END;                                              1977
*/*          END-ELSE                                                */
*            END;                                                  1978
*/*      END-THEN                                                    */
*        END;                                                      1979
*/*  END-SUB-PROCEDURE ESTABLISH_TRACK_INTEGRITY                     */
*    END ESTTRINT;                                                 1980
*                                                                  1980
@EL00023 DS    0H                                                  1980
@EF00023 DS    0H                                                  1980
@ER00023 LM    @14,@12,@SA00023                                    1980
         BR    @14                                                 1980
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  DCVTPROC                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  DISCRETE-TRACK ADDRESS CONVERTOR             */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    CONVERTS A HEXADECIMAL DISCRETE-TRACK ADDRESS IN CHARACTER    */
*/*    STRING FORM (9 BYTES LONG) TO INTERNAL HEXADECIMAL            */
*/*    REPRESENTATION.                                               */
*/*                                                                  */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1981
*                                                                  1981
*DCVTPROC:                                                         1981
*  PROCEDURE                                                       1981
*    (                                                             1981
*    DCVTSRCE,                                                     1981
*    DCVTCCHH,                                                     1981
*    DCVTLEGL                                                      1981
*    );                                                            1981
*                                                                  1981
DCVTPROC STM   @14,@12,@SA00024                                    1981
         MVC   @PC00024(12),0(@01)                                 1981
*DECLARE                                                           1982
*  DCVTSRCE                   CHAR(9),                             1982
*  1 DCVTCCHH                 FIXED(32),                           1982
*    2 DCVTCC                 FIXED(16),                           1982
*    2 DCVTHH                 FIXED(16),                           1982
*  DCVTLEGL                   BIT(1);                              1982
*                                                                  1982
*DECLARE                                                           1983
*  DCVTHEXC(16)               CHAR(1)  INIT                        1983
*                             ('0','1','2','3','4','5','6','7',    1983
*                                  '8','9','A','B','C','D','E','F'),
*  DCVTHEXN(16)               FIXED(8)  INIT                       1983
*                             (0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15),
*  DCVTSTR                    CHAR(9),                             1983
*  DCVTI                      FIXED(15);                           1983
*                                                                  1983
*OLDERID2 = NEWERID2;                                              1984
         L     @06,@PC00001                                        1984
         L     @06,GDTTR2(,@06)                                    1984
         MVC   @TS00001(95),NEWERID2(@06)                          1984
         MVC   OLDERID2(95,@06),@TS00001                           1984
*NEWID2 = 'INDC';                                                  1985
*                                                                  1985
         MVC   NEWID2(4,@06),@CC00960                              1985
*DO DCVTI = 1 TO 9 WHILE(DCVTSRCE(DCVTI:DCVTI) ^= ':');            1986
         LA    DCVTI,1                                             1986
@DL01986 L     @06,@PC00024                                        1986
         ALR   @06,DCVTI                                           1986
         BCTR  @06,0                                               1986
         CLI   DCVTSRCE(@06),C':'                                  1986
         BE    @DC01986                                            1986
*END;                                                              1987
*                                                                  1987
         AL    DCVTI,@CF00165                                      1987
         CH    DCVTI,@CH00260                                      1987
         BNH   @DL01986                                            1987
@DC01986 DS    0H                                                  1988
*IF DCVTI = 1    DCVTI >= 9                                       1988
*  THEN DCVTLEGL = NO;                                             1988
         CH    DCVTI,@CH00165                                      1988
         BE    @RT01988                                            1988
         CH    DCVTI,@CH00260                                      1988
         BL    @RF01988                                            1988
@RT01988 DS    0H                                                  1989
         L     @06,@PC00024+8                                      1989
         NI    DCVTLEGL(@06),B'01111111'                           1989
*  ELSE DO;                                                        1990
         B     @RC01988                                            1990
@RF01988 DS    0H                                                  1991
*    DCVTSTR = DCVTSRCE(1:DCVTI-1);                                1991
         MVI   DCVTSTR+1,C' '                                      1991
         MVC   DCVTSTR+2(7),DCVTSTR+1                              1991
         LR    @06,DCVTI                                           1991
         BCTR  @06,0                                               1991
         BCTR  @06,0                                               1991
         L     @03,@PC00024                                        1991
         EX    @06,@SM00991                                        1991
*    CALL DCVTCNVT (DCVTSTR,DCVTCC);                               1992
         LA    @06,DCVTSTR                                         1992
         ST    @06,@AL00001                                        1992
         L     @06,@PC00024+4                                      1992
         ST    @06,@AL00001+4                                      1992
         LA    @01,@AL00001                                        1992
         BAL   @14,DCVTCNVT                                        1992
*    IF DCVTLEGL = YES                                             1993
*      THEN DO;                                                    1993
         L     @06,@PC00024+8                                      1993
         TM    DCVTLEGL(@06),B'10000000'                           1993
         BNO   @RF01993                                            1993
*        DCVTSTR = DCVTSRCE(DCVTI+1:9);                            1995
         MVI   DCVTSTR+1,C' '                                      1995
         MVC   DCVTSTR+2(7),DCVTSTR+1                              1995
         LA    @06,8                                               1995
         SLR   @06,DCVTI                                           1995
         L     @03,@PC00024                                        1995
         ALR   @03,DCVTI                                           1995
         EX    @06,@SM00991                                        1995
*        CALL DCVTCNVT (DCVTSTR,DCVTHH);                           1996
         LA    @06,DCVTSTR                                         1996
         ST    @06,@AL00001                                        1996
         L     @06,@PC00024+4                                      1996
         LA    @06,DCVTHH(,@06)                                    1996
         ST    @06,@AL00001+4                                      1996
         LA    @01,@AL00001                                        1996
         BAL   @14,DCVTCNVT                                        1996
*        END;                                                      1997
*    END;                                                          1998
*                                                                  1998
*DCVTCNVT:                                                         1999
*  PROCEDURE                                                       1999
*    (                                                             1999
*    DCVTCHRS,                                                     1999
*    DCVTNUM                                                       1999
*    );                                                            1999
*                                                                  1999
         B     @PB00025                                            1999
DCVTCNVT STM   @14,@12,12(@13)                                     1999
         MVC   @PC00025(8),0(@01)                                  1999
*DECLARE                                                           2000
*  DCVTCHRS                       CHAR(9),                         2000
*  DCVTNUM                        FIXED(16);                       2000
*                                                                  2000
*DECLARE                                                           2001
*  DCVTMULT                       FIXED(16),                       2001
*  (DCVTII,DCVTJJ)                FIXED(15);                       2001
*                                                                  2001
*DCVTNUM = 0;                                                      2002
         L     @06,@PC00025+4                                      2002
         SLR   @03,@03                                             2002
         STH   @03,DCVTNUM(,@06)                                   2002
*DCVTMULT = 1;                                                     2003
         LA    DCVTMULT,1                                          2003
*DO DCVTII = 9 TO 1 BY -1;                                         2004
         LA    DCVTII,9                                            2004
@DL02004 DS    0H                                                  2005
*  DCVTLEGL = NO;                                                  2005
         L     @06,@PC00024+8                                      2005
         NI    DCVTLEGL(@06),B'01111111'                           2005
*  IF DCVTCHRS(DCVTII:DCVTII) ^= ' '                               2006
*    THEN DO;                                                      2006
         L     @06,@PC00025                                        2006
         ALR   @06,DCVTII                                          2006
         BCTR  @06,0                                               2006
         CLI   DCVTCHRS(@06),C' '                                  2006
         BE    @RF02006                                            2006
*      DO DCVTJJ = 1 TO 16 WHILE (DCVTLEGL = NO);                  2008
         LA    DCVTJJ,1                                            2008
@DL02008 L     @06,@PC00024+8                                      2008
         TM    DCVTLEGL(@06),B'10000000'                           2008
         BNZ   @DC02008                                            2008
*        IF DCVTCHRS(DCVTII:DCVTII) = DCVTHEXC(DCVTJJ)             2009
*          THEN IF DCVTMULT <= 4096                                2009
         L     @05,@PC00025                                        2009
         ALR   @05,DCVTII                                          2009
         BCTR  @05,0                                               2009
         LA    @01,DCVTHEXC-1(DCVTJJ)                              2009
         CLC   DCVTCHRS(1,@05),0(@01)                              2009
         BNE   @RF02009                                            2009
*            THEN DO;                                              2010
         CL    DCVTMULT,@CF00974                                   2010
         BH    @RF02010                                            2010
*              DCVTNUM = DCVTNUM + (DCVTMULT * DCVTHEXN(DCVTJJ));  2012
         L     @05,@PC00025+4                                      2012
         SLR   @01,@01                                             2012
         IC    @01,DCVTHEXN-1(DCVTJJ)                              2012
         MR    @00,DCVTMULT                                        2012
         MVC   @ZT00002+2(2),DCVTNUM(@05)                          2012
         AL    @01,@ZT00002                                        2012
         STH   @01,DCVTNUM(,@05)                                   2012
*              DCVTMULT = DCVTMULT * 16;                           2013
         SLL   DCVTMULT,4                                          2013
*              DCVTLEGL = YES;                                     2014
         OI    DCVTLEGL(@06),B'10000000'                           2014
*              END;                                                2015
*      END;                                                        2016
@RF02010 DS    0H                                                  2016
@RF02009 AL    DCVTJJ,@CF00165                                     2016
         CH    DCVTJJ,@CH00272                                     2016
         BNH   @DL02008                                            2016
@DC02008 DS    0H                                                  2017
*      IF DCVTLEGL = NO                                            2017
*        THEN RETURN;                                              2017
         L     @06,@PC00024+8                                      2017
         TM    DCVTLEGL(@06),B'10000000'                           2017
         BZ    @RT02017                                            2017
*      END;                                                        2019
*END;                                                              2020
*                                                                  2020
@RF02006 BCTR  DCVTII,0                                            2020
         LTR   DCVTII,DCVTII                                       2020
         BP    @DL02004                                            2020
*END DCVTCNVT;                                                     2021
*                                                                  2021
@EL00025 DS    0H                                                  2021
@EF00025 DS    0H                                                  2021
@ER00025 LM    @14,@12,12(@13)                                     2021
         BR    @14                                                 2021
*END DCVTPROC;                                                     2022
*                                                                  2022
@EL00024 DS    0H                                                  2022
@EF00024 DS    0H                                                  2022
@ER00024 LM    @14,@12,@SA00024                                    2022
         BR    @14                                                 2022
@PB00024 DS    0H                                                  2022
*/*  END-PROCEDURE INITIALIZE_COMMAND_CONTROLLER                     */
*                                                                  2023
*    END ICKIN01                                                   2023
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (ICKCSIN )                                        *
*/*%INCLUDE SYSLIB  (DMSDF08 )                                        *
*;                                                                 2023
@DATA    DS    0H
@CH00185 DC    H'7'
@CH00260 DC    H'9'
@CH00265 DC    H'12'
@CH00272 DC    H'16'
@SM00991 MVC   DCVTSTR(0),DCVTSRCE(@03)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00009 DS    15F
@SA00024 DS    15F
@PC00024 DS    3F
@SA00011 DS    15F
@PC00011 DS    4F
@SA00013 DS    15F
@PC00013 DS    3F
@SA00020 DS    15F
@SA00014 DS    15F
@SA00012 DS    15F
@SA00015 DS    15F
@SA00016 DS    15F
@SA00017 DS    15F
@SA00019 DS    15F
@SA00021 DS    15F
@SA00022 DS    15F
@SA00010 DS    15F
@SA00023 DS    15F
@PC00023 DS    6F
@PC00025 DS    2F
@SA00018 DS    0F
         DS    15F
@AL00001 DS    9A
@AFTEMPS DS    4F
@ZTEMPS  DS    0F
@ZT00002 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICKIN01  CSECT
         DS    0F
@CF00094 DC    F'0'
@CF00165 DC    F'1'
@CH00165 EQU   @CF00165+2
@CF00116 DC    F'2'
@CH00116 EQU   @CF00116+2
@CF00136 DC    F'3'
@CH00136 EQU   @CF00136+2
@CF00044 DC    F'4'
@CH00044 EQU   @CF00044+2
@CF00255 DC    F'5'
@CH00255 EQU   @CF00255+2
@CF00119 DC    F'6'
@CH00119 EQU   @CF00119+2
@CF00161 DC    F'8'
@CH00161 EQU   @CF00161+2
@CF00267 DC    F'13'
@CF00274 DC    F'17'
@CF00276 DC    F'18'
@CF00974 DC    F'4096'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
RETCODE  DS    F
VIBPTR   DS    A
VIBLEN   DS    F
RECNUM   DS    F
DATAPTR  DS    A
DATALEN  DS    F
RZPTR    DS    A
RZLEN    DS    F
HAPTR    DS    A
HALEN    DS    F
VAACTION DS    F
PACKTRAK DS    F
PACKASC  DS    F
VOLIB    DS    A
OLDVTOC  DS    F
LABELS   DS    F
ALTCOUNT DS    F
ALTPCNT  DS    F
ALTPTR   DS    FL4
         ORG   ALTPTR
ALTPTRC  DS    FL2
ALTPTRT  DS    FL2
         ORG   ALTPTR+4
VTOCLOC  DS    FL4
         ORG   VTOCLOC
VTOCLOCC DS    FL2
VTOCLOCT DS    FL2
         ORG   VTOCLOC+4
VTOCHI   DS    FL4
         ORG   VTOCHI
VTOCHIC  DS    FL2
VTOCHIT  DS    FL2
         ORG   VTOCHI+4
VTOCEXT  DS    F
UNTRACK  DS    FL4
         ORG   UNTRACK
UNTRACKC DS    FL2
UNTRACKT DS    FL2
         ORG   UNTRACK+4
COUNTUTR DS    F
AVAILCNT DS    F
CTRADDR  DS    FL4
         ORG   CTRADDR
CTRADDRC DS    FL2
CTRADDRT DS    FL2
         ORG   CTRADDR+4
RZCCHH   DS    FL4
         ORG   RZCCHH
RZCCHHC  DS    FL2
RZCCHHT  DS    FL2
         ORG   RZCCHH+4
RZACCHH  DS    FL4
         ORG   RZACCHH
RZACCHHC DS    FL2
RZACCHHT DS    FL2
         ORG   RZACCHH+4
HAACTION DS    F
RZACTION DS    F
VIBTYPE  DS    F
ALTRACK  DS    FL4
         ORG   ALTRACK
ALTRACKC DS    FL2
ALTRACKT DS    FL2
         ORG   ALTRACK+4
OBTRCODE DS    F
ESTRCODE DS    F
LISTPTR  DS    A
SETRC    DS    H
TESTRC   DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
PRTSTR   DS    CL60
         ORG   PRTSTR
PRTHDR   DS    CL8
PRTARGS  DS    CL52
         ORG   PRTSTR+60
FTRKFLG  DS    BL1
ALTFLAG  DS    BL1
CHKFLG   DS    BL1
LEGAL    DS    BL1
TRACKTYP DS    BL1
UNTRTYPE DS    BL1
PRTFLG   DS    BL1
PACKENT  DS    BL1
DFLAGC   DS    BL1
DFLAGA   DS    BL1
RCVRFLAG DS    BL1
TRSTATUS DS    BL1
PRGFLG   DS    BL1
LABFLAG  DS    BL1
BOOTFLG  DS    BL1
PACKDEF  DS    BL1
PACKCHEK DS    BL1
PACKRCVR DS    BL1
PACKTRK  DS    BL1
VLNSER   DS    CL6
OWNERID  DS    CL14
VALVOWN  DS    CL14
VOLIMAGE DS    CL80
OLDVSER  DS    CL6
OLDOWNER DS    CL14
MSSDEV   DS    CL8
VIBNAME  DS    CL8
DEVTYPE  DS    CL8
RFLAG    DS    BL1
DCVTSTR  DS    CL9
         DS    CL1
INFO     DS    CL12
         ORG   INFO+0
INFOPTR  DS    AL4
INFOLEN  DS    FL4
CONDCODE DS    FL4
         ORG   INFO+108
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKIN01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00759 DC    V(ICKVA01)
@CV00761 DC    V(ICKVV01)
@CV00762 DC    V(ICKRL01)
@CV00765 DC    V(ICKVP01)
@CV00774 DC    V(ICKWI01)
@CV00775 DC    V(ICKPP01)
@CV00825 DC    V(ICKWV01)
@CV00872 DC    V(ICKTA01)
@CV00877 DC    V(ICKRT01)
@CV00886 DC    V(ICKBM01)
@CV00891 DC    V(ICKAA01)
@CV00898 DC    V(ICKRA01)
@CV00905 DC    V(ICKRP01)
@CV00910 DC    V(ICKCL01)
         DS    0D
@CC00755 DC    C'DARGLIST'
@CC00754 DC    C'IN00'
@CC00776 DC    C'IN99'
@CC00780 DC    C'INOP'
@CC00785 DC    C'INPI'
@CC00789 DC    C'INCP'
@CC00794 DC    C'INEA'
@CC00805 DC    C'INIA'
@CC00813 DC    C'INIP'
@CC00819 DC    C'INVL'
@CC00824 DC    C'INVT'
@CC00830 DC    C'INUT'
@CC00842 DC    C'INOT'
@CC00847 DC    C'INRZ'
@CC00852 DC    C'INVA'
@CC00867 DC    C'INDT'
@CC00871 DC    C'INCH'
@CC00876 DC    C'INRA'
@CC00881 DC    C'INWD'
@CC00885 DC    C'INBP'
@CC00890 DC    C'INAA'
@CC00897 DC    C'INRS'
@CC00904 DC    C'INRP'
@CC00909 DC    C'INCL'
@CC00926 DC    C'INET'
@CC00960 DC    C'INDC'
@CC00533 DC    C'CC0'
@CC00573 DC    C'UV0'
@CC00781 DC    C'MSS'
@CC00799 EQU   @CC00755
@CC00800 DC    C'N'
@CB00466 DC    B'10000000'
MODID    DC    CL4'IN01'
POOLID   DC    CL4'IN01'
PTCHIN01 DS    CL512
         ORG   PTCHIN01
@NM00020 DC    256X'00'
@NM00021 DC    256X'00'
         ORG   PTCHIN01+512
         DS    CL1
INFOVECT DC    F'208'
         DC    F'204'
         DC    F'201'
         DC    F'202'
         DC    F'206'
         DC    F'207'
         DC    F'205'
         DC    F'213'
         DC    F'214'
DCVTHEXC DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
DCVTHEXN DC    AL1(0)
         DC    AL1(1)
         DC    AL1(2)
         DC    AL1(3)
         DC    AL1(4)
         DC    AL1(5)
         DC    AL1(6)
         DC    AL1(7)
         DC    AL1(8)
         DC    AL1(9)
         DC    AL1(10)
         DC    AL1(11)
         DC    AL1(12)
         DC    AL1(13)
         DC    AL1(14)
         DC    AL1(15)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
DCVTJJ   EQU   @04
DCVTII   EQU   @03
DCVTMULT EQU   @02
DCVTI    EQU   @02
VTOCRTAH EQU   @02
VTOCRTAL EQU   @03
I        EQU   @02
REG9     EQU   @09
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG8     EQU   @08
REG0     EQU   @00
REG1     EQU   @01
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
RTNREG   EQU   @15
ICKSAEP0 EQU   0
ICKSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
ICKDVON0 EQU   0
ICKDVIN0 EQU   0
ICKDVOP0 EQU   0
ICKDVCL0 EQU   0
ICKTPPR0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
DEVIC    EQU   0
DEVICVAL EQU   DEVIC+1
PURGE    EQU   0
CHECK    EQU   0
CHECKVAL EQU   CHECK
NOCHK    EQU   0
RECLA    EQU   0
VTOC     EQU   0
TRACK    EQU   0
TRACKVAL EQU   TRACK+1
EXTEN    EQU   0
EXTENVAL EQU   EXTEN
VOLID    EQU   0
VOLIDVAL EQU   VOLID+1
OWNER    EQU   0
OWNERVAL EQU   OWNER+1
LBL      EQU   0
LBLVAL   EQU   LBL
IPLDD    EQU   0
IPLDDVAL EQU   IPLDD+1
VALID    EQU   0
NOVAL    EQU   0
VERFY    EQU   0
VSER     EQU   0
VSERVAL  EQU   VSER+1
VOWN     EQU   0
VOWNVAL  EQU   VOWN+1
MAP      EQU   0
MIMIC    EQU   0
MSS      EQU   0
MINI     EQU   0
DNAME    EQU   0
DNAMEVAL EQU   DNAME+1
DEVTY    EQU   0
DEVTYVAL EQU   DEVTY+1
BOOTS    EQU   0
THRESHLD EQU   0
TRKSPCYL EQU   0
TOTALALT EQU   0
FIRSTAL  EQU   0
FINALT   EQU   0
FINPRI   EQU   0
FINPRIC  EQU   FINPRI
FINPRIT  EQU   FINPRI+2
DEFVTOC  EQU   0
DEFVTOCC EQU   DEFVTOC
DEFVTOCT EQU   DEFVTOC+2
DEFEXTEN EQU   0
VIBPFLAG EQU   0
RZADDROB EQU   0
VOL1     EQU   0
VOL1SER  EQU   VOL1+4
VOL1VTOC EQU   VOL1+11
VOL1OWNR EQU   VOL1+37
DMPTRM   EQU   0
HAIMAGE  EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOOP0 EQU   0
ICKIOPT0 EQU   0
ICKIOTM0 EQU   0
ICKSACL0 EQU   0
ICKSADE0 EQU   0
ICKSAFS0 EQU   0
ICKSAGP0 EQU   0
ICKSAGS0 EQU   0
ICKSALD0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NOBTS    EQU   0
NOMAP    EQU   0
NOPRG    EQU   0
NOREC    EQU   0
NOVER    EQU   0
TOTALPRI EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
TRKADDR  EQU   0
DFLAG    EQU   0
RZADDR   EQU   0
OBTRTYPE EQU   0
VALADDR  EQU   0
DFLAGV   EQU   0
VALTRTYP EQU   0
ESTADDR  EQU   0
ESTASSOC EQU   0
ESTDFLAG EQU   0
ESTRFLAG EQU   0
ESTCODE  EQU   0
ESTTYPE  EQU   0
DCVTSRCE EQU   0
DCVTCCHH EQU   0
DCVTCC   EQU   DCVTCCHH
DCVTHH   EQU   DCVTCCHH+2
DCVTLEGL EQU   0
DCVTCHRS EQU   0
DCVTNUM  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ESTADDRH EQU   ESTADDR+2
ESTADDRC EQU   ESTADDR
VALADDRH EQU   VALADDR+2
VALADDRC EQU   VALADDR
TRKADDRH EQU   TRKADDR+2
TRKADDRC EQU   TRKADDR
FDTVERB  EQU   FDTTBL
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
VOL1STDV EQU   VOL1+79
@NM00019 EQU   VOL1+51
VOL1OLDO EQU   VOL1OWNR+4
VOL1OEXT EQU   VOL1OWNR
@NM00018 EQU   VOL1+16
VOL1ACC  EQU   VOL1+10
VOL1NUM  EQU   VOL1+3
VOL1ID   EQU   VOL1
FINALTT  EQU   FINALT+2
FINALTC  EQU   FINALT
FIRSTALT EQU   FIRSTAL+2
FIRSTALC EQU   FIRSTAL
DEVTYLEN EQU   DEVTY
DNAMELEN EQU   DNAME
MINIVAL  EQU   MINI
VOWNLEN  EQU   VOWN
VSERLEN  EQU   VSER
IPLDDLEN EQU   IPLDD
OWNERLEN EQU   OWNER
VOLIDLEN EQU   VOLID
TRACKLEN EQU   TRACK
DEVICLEN EQU   DEVIC
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCPNM   EQU   IOCSTR+28
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00273 EQU   @RC00255
@RC00305 EQU   @RC00303
@RF00346 EQU   @RC00335
@RC00369 EQU   @RC00360
@RF00455 EQU   @EL00002
@RF00457 EQU   @EL00002
@RF00460 EQU   @EL00002
@RF00488 EQU   @EL00004
@RF00556 EQU   @RC00546
@RF00559 EQU   @RC00546
@RC00561 EQU   @RC00546
@RF00636 EQU   @RC00546
@RF00682 EQU   @RC00546
@RF00704 EQU   @RC00701
@RC00706 EQU   @RC00701
@RF00769 EQU   @RC00701
@RF00815 EQU   @RC00701
@RC00836 EQU   @RC00833
@RF00841 EQU   @RC00833
@RT00869 EQU   @EL00005
@RF00896 EQU   @RC00893
@RF00920 EQU   @RC00918
@RC00922 EQU   @RC00918
@RF01000 EQU   @RC00998
@RF01013 EQU   @RC00998
@RF01025 EQU   @RC01023
@RC01027 EQU   @RC01023
@RF01043 EQU   @RC01023
@RF01132 EQU   @EL00008
@RF01171 EQU   @EL00009
@RF01234 EQU   @EL00010
@RF01283 EQU   @RC01272
@RC01247 EQU   @EL00011
@RC01313 EQU   @EL00012
@RF01330 EQU   @EL00012
@RF01339 EQU   @EL00012
@RC01342 EQU   @EL00012
@RF01355 EQU   @EL00012
@RC01376 EQU   @EL00013
@RC01393 EQU   @EL00013
@RC01406 EQU   @EL00014
@RC01414 EQU   @EL00014
@RC01469 EQU   @EL00015
@RF01474 EQU   @EL00015
@RF01485 EQU   @EL00015
@RC01496 EQU   @EL00016
@RC01550 EQU   @EL00017
@RF01577 EQU   @EL00017
@RF01599 EQU   @EL00018
ENDLOOP1 EQU   @EL00019
ENDLOOP2 EQU   @EL00020
@RF01823 EQU   @EL00021
@RC01862 EQU   @RC01860
@RF01877 EQU   @EL00022
@RF01891 EQU   @RC01889
@RC01893 EQU   @RC01889
@RF01918 EQU   @EL00023
@RC01921 EQU   @EL00023
@RC01955 EQU   @EL00023
@RF01973 EQU   @EL00023
@PB00023 EQU   @PB00024
@RT02017 EQU   @EL00025
@PB00025 EQU   @EL00024
@RC00563 EQU   @RC00561
@RF00620 EQU   @RC00561
@RC00708 EQU   @RC00706
@RC00731 EQU   @RC00706
@RF00736 EQU   @RC00706
@RF01258 EQU   @RC01247
@RF01324 EQU   @RC01313
@RF01349 EQU   @RC01342
@RF01387 EQU   @RC01376
@RF01710 EQU   ENDLOOP2
@PB00022 EQU   @PB00023
@RF01933 EQU   @RC01921
@RF01967 EQU   @RC01955
@RC01988 EQU   @PB00025
@RF01993 EQU   @PB00025
@RF00566 EQU   @RC00563
@RF00569 EQU   @RC00563
@RC00710 EQU   @RC00708
@RF00716 EQU   @RC00708
@RC00718 EQU   @RC00708
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   ICKIN01,(C'PLS1847',0701,78192)

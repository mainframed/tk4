         TITLE '*********  ICKRA01:  RE-ASSIGN ALTERNATE TRACK  ********
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
ICKRA01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'ICKRA01   78.192'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(36),0(@01)                                 0002
*                                                                  0176
*/*****  B E G I N    E X E C U T I O N  *****************************/
*                                                                  0177
*    IF GDTDBG = NULLPTR                                           0177
*      THEN;                                                       0177
         L     @10,@PC00001                                        0177
         L     @10,GDTDBG(,@10)                                    0177
         LTR   @10,@10                                             0177
         BZ    @RT00177                                            0177
*      ELSE                                                        0179
*        CALL ICKDB010 (GDTTBL, 'RA00');                           0179
*                                                                  0179
*                                                                  0179
         L     @10,@PC00001                                        0179
         ST    @10,@AL00001                                        0179
         LA    @15,@CC00543                                        0179
         ST    @15,@AL00001+4                                      0179
         MVI   @AL00001+4,X'80'                                    0179
         L     @15,GDTDBG(,@10)                                    0179
         LA    @01,@AL00001                                        0179
         BALR  @14,@15                                             0179
*/*  OBTAIN THE ADDRESSES OF THE LAST PRIMARY AND ALTERNATE          */
*/*   TRACKS AND ALSO THE NUMBER OF TRACKS PER CYLINDER              */
*    DO I = 1 TO INFOSET;                                          0180
@RT00177 LA    I,1                                                 0180
@DL00180 DS    0H                                                  0181
*      CALL ICKDVIN0 (GDTTBL                                       0181
*               ,VOLIB                                             0181
*               ,INFOVECT (I)                                      0181
*               ,POOLID                                            0181
*               ,INFOPTR (I)                                       0181
*               ,INFOLEN (I)                                       0181
*               ,RETCODE);                                         0181
         L     @10,@PC00001                                        0181
         ST    @10,@AL00001                                        0181
         L     @03,@PC00001+4                                      0181
         ST    @03,@AL00001+4                                      0181
         LR    @03,I                                               0181
         SLA   @03,2                                               0181
         LA    @03,INFOVECT-4(@03)                                 0181
         ST    @03,@AL00001+8                                      0181
         LA    @03,POOLID                                          0181
         ST    @03,@AL00001+12                                     0181
         LR    @03,I                                               0181
         SLA   @03,3                                               0181
         LA    @15,INFOPTR-8(@03)                                  0181
         ST    @15,@AL00001+16                                     0181
         LA    @03,INFOLEN-8(@03)                                  0181
         ST    @03,@AL00001+20                                     0181
         LA    @03,RETCODE                                         0181
         ST    @03,@AL00001+24                                     0181
         L     @15,GDTDIN(,@10)                                    0181
         LA    @01,@AL00001                                        0181
         BALR  @14,@15                                             0181
*    END;                                                          0182
         AH    I,@CH00173                                          0182
         CH    I,@CH00144                                          0182
         BNH   @DL00180                                            0182
*/*  INDICATE INITIALLY THAT ASSIGNMENT IS NOT COMPLETE              */
*    ASSGNCOM = NOTCOMP;                                           0183
         NI    ASSGNCOM,B'01111111'                                0183
*/*  DO-WHILE ASSIGNMENT IS NOT COMPLETE                             */
*    DO WHILE ASSGNCOM = NOTCOMP;                                  0184
         B     @DE00184                                            0184
@DL00184 DS    0H                                                  0185
*/*    INITIALIZE THE UNRECOVERABLE TRACK ADDRESS TO ZERO            */
*      UNTRADDR = 0;                                               0185
         SLR   @10,@10                                             0185
         L     @15,@PC00001+28                                     0185
         ST    @10,UNTRADDR(,@15)                                  0185
*/*    SET CONDITION CODE INITIALLY TO INDICATE SUCCESSFUL COMPLETION*/
*      CONDCODE = SUCCEEDS;                                        0186
         L     @15,@PC00001+32                                     0186
         ST    @10,CONDCODE(,@15)                                  0186
*/*    INDICATE INITIALLY THAT THE ALTERNATE FLAG IS SET ON          */
*      TRACKTYP = ALTTRACK;                                        0187
         OI    TRACKTYP,B'10000000'                                0187
*/*    INDICATE INITIALLY THAT AN ASSIGNABLE ALTERNATE NOT FOUND     */
*      ASSGNFLG = NOASSIGN;                                        0188
         NI    ASSGNFLG,B'01111111'                                0188
*/*    IF THERE ARE NO AVAILABLE ALTERNATE TRACKS (ALTCOUNT)         */
*      IF ALTCOUNT = 0                                             0189
*/*      THEN INDICATE NO AVAILABLE ALTERNATE TRACKS LEFT            */
*        THEN DO;    CONDCODE = NOALTS;  END;                      0189
         L     @14,@PC00001+16                                     0189
         C     @10,ALTCOUNT(,@14)                                  0189
         BNE   @RF00189                                            0189
         MVC   CONDCODE(4,@15),@CF00173                            0191
*/*    IF NO ERRORS FOUND (CONDCODE = 0)                             */
*      IF CONDCODE = SUCCEEDS                                      0193
*/*      THEN                                                        */
*        THEN DO;                                                  0193
*                                                                  0193
@RF00189 L     @10,@PC00001+32                                     0193
         L     @10,CONDCODE(,@10)                                  0193
         LTR   @10,@10                                             0193
         BNZ   @RF00193                                            0193
*/*        DO-WHILE LAST ALTERNATE TRACK IS NOT CHECKED              */
*          DO WHILE  ALTPTR <= LASTALT;                            0195
*                                                                  0195
         B     @DE00195                                            0195
@DL00195 DS    0H                                                  0196
*/*          READ HOME-ADDRESS (OF THE ALT TRACK TO OBTAIN           */
*/*           DEFECT-FLAG) (UDEVOP)                                  */
*            CALL ICKDVOP0 (GDTTBL                                 0196
*                   ,VOLIB                                         0196
*                   ,ACTRDHA                                       0196
*                   ,ALTPTR                                        0196
*                   ,RECNUM                                        0196
*                   ,POOLID                                        0196
*                   ,HAPTR                                         0196
*                   ,HALEN                                         0196
*                   ,RETCODE);                                     0196
         L     @10,@PC00001                                        0196
         ST    @10,@AL00001                                        0196
         L     @15,@PC00001+4                                      0196
         ST    @15,@AL00001+4                                      0196
         LA    @15,@CF00173                                        0196
         ST    @15,@AL00001+8                                      0196
         L     @15,@PC00001+20                                     0196
         ST    @15,@AL00001+12                                     0196
         LA    @15,RECNUM                                          0196
         ST    @15,@AL00001+16                                     0196
         LA    @15,POOLID                                          0196
         ST    @15,@AL00001+20                                     0196
         LA    @15,HAPTR                                           0196
         ST    @15,@AL00001+24                                     0196
         LA    @15,HALEN                                           0196
         ST    @15,@AL00001+28                                     0196
         LA    @15,RETCODE                                         0196
         ST    @15,@AL00001+32                                     0196
         L     @15,GDTDOP(,@10)                                    0196
         LA    @01,@AL00001                                        0196
         BALR  @14,@15                                             0196
*/*          IF THE READ OPERATION WAS UNSUCCESSFUL                  */
*            IF RETCODE = CPFAILS                                  0197
*/*            THEN                                                  */
*              THEN DO;                                            0197
*                                                                  0197
         CLC   RETCODE(4),@CF00052                                 0197
         BNE   @RF00197                                            0197
*/*              SET FLAG TO INDICATE TRACK CANNOT BE ASSIGNED       */
*                ASSGNFLG = NOASSIGN;                              0199
         NI    ASSGNFLG,B'01111111'                                0199
*/*              SET ADDRESS OF THE UNRECOVERABLE TRACK              */
*                UNTRADDR = ALTPTR;                                0200
         L     @10,@PC00001+28                                     0200
         L     @15,@PC00001+20                                     0200
         MVC   UNTRADDR(4,@10),ALTPTR(@15)                         0200
*/*              INDICATE THAT AN UNRECOVERABLE TRACK WAS FOUND      */
*                CONDCODE = UNTRFND;                               0201
         L     @10,@PC00001+32                                     0201
         MVC   CONDCODE(4,@10),@CF00263                            0201
*/*              SET POINTER TO NEXT AVAILABLE ALTERNATE TRACK       */
*/*               (ALTPTR)                                           */
*                IF ALTPTRT = TRKSPCYL - 1                         0202
*                  THEN DO;                                        0202
*                                                                  0202
         L     @10,INFOPTR+8                                       0202
         L     @10,TRKSPCYL(,@10)                                  0202
         BCTR  @10,0                                               0202
         MVC   @ZT00002+2(2),ALTPTRT(@15)                          0202
         C     @10,@ZT00002                                        0202
         BNE   @RF00202                                            0202
*                    ALTPTRC = ALTPTRC + 1;                        0204
         LA    @10,1                                               0204
         MVC   @ZT00002+2(2),ALTPTRC(@15)                          0204
         AL    @10,@ZT00002                                        0204
         STH   @10,ALTPTRC(,@15)                                   0204
*                    ALTPTRT = 0;                                  0205
         SLR   @10,@10                                             0205
         STH   @10,ALTPTRT(,@15)                                   0205
*                    END;                                          0206
*                  ELSE DO;    ALTPTRT = ALTPTRT + 1; END;         0207
         B     @RC00202                                            0207
@RF00202 DS    0H                                                  0208
         L     @10,@PC00001+20                                     0208
         LA    @15,1                                               0208
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0208
         AL    @15,@ZT00002                                        0208
         STH   @15,ALTPTRT(,@10)                                   0208
*/*              LEAVE                                               */
*                GOTO ENDLOOP;                                     0210
         B     ENDLOOP                                             0210
*/*              END-THEN                                            */
*                END;                                              0211
*/*            ELSE (UNRECOVERABLE TRACK NOT FOUND)                  */
*              ELSE DO;                                            0212
*                                                                  0212
@RF00197 DS    0H                                                  0213
*/*              IF ALTERNATE TRACK IS FLAGGED DEFECTIVE             */
*                IF RETCODE = DFLAGONA × RETCODE = DFLAGONP        0213
*/*                THEN                                              */
*                  THEN DO;                                        0213
*                                                                  0213
         L     @10,RETCODE                                         0213
         CH    @10,@CH00127                                        0213
         BE    @RT00213                                            0213
         CH    @10,@CH00124                                        0213
         BNE   @RF00213                                            0213
@RT00213 DS    0H                                                  0214
*/*                  SET FLAG TO INDICATE TRACK CANNOT BE ASSIGNED   */
*                    ASSGNFLG = NOASSIGN;                          0215
         NI    ASSGNFLG,B'01111111'                                0215
*/*                  SET POINTER TO NEXT AVAILABLE ALTERNATE TRACK   */
*/*                   (ALTPTR)                                       */
*                    IF ALTPTRT = TRKSPCYL - 1                     0216
*                      THEN DO;                                    0216
*                                                                  0216
         L     @10,@PC00001+20                                     0216
         L     @01,INFOPTR+8                                       0216
         L     @15,TRKSPCYL(,@01)                                  0216
         BCTR  @15,0                                               0216
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0216
         C     @15,@ZT00002                                        0216
         BNE   @RF00216                                            0216
*                        ALTPTRC = ALTPTRC + 1;                    0218
         LA    @15,1                                               0218
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0218
         AL    @15,@ZT00002                                        0218
         STH   @15,ALTPTRC(,@10)                                   0218
*                        ALTPTRT = 0;                              0219
         SLR   @15,@15                                             0219
         STH   @15,ALTPTRT(,@10)                                   0219
*                        END;                                      0220
*                      ELSE DO;    ALTPTRT = ALTPTRT + 1; END;     0221
         B     @RC00216                                            0221
@RF00216 DS    0H                                                  0222
         L     @10,@PC00001+20                                     0222
         LA    @15,1                                               0222
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0222
         AL    @15,@ZT00002                                        0222
         STH   @15,ALTPTRT(,@10)                                   0222
*/*                  END-THEN                                        */
*                    END;                                          0224
*/*                ELSE (ALTERNATE TRACK IS NOT FLAGGED DEFECTIVE)   */
*                  ELSE DO;                                        0225
*                                                                  0225
         B     @RC00213                                            0225
@RF00213 DS    0H                                                  0226
*/*                  IF THE ALTERNATE FLAG IS NOT TURNED ON          */
*                    IF RETCODE = DFLAGOFP                         0226
*/*                    THEN SAVE THIS INFORMATION                    */
*                      THEN DO;    TRACKTYP = PRITRACK; END;       0226
         CLC   RETCODE(4),@CF00144                                 0226
         BNE   @RF00226                                            0226
         NI    TRACKTYP,B'01111111'                                0228
*/*                    ELSE RESET THE FLAG TO INDICATE THE ALTERNATE */
*/*                     FLAG IS SET ON                               */
*                      ELSE DO;    TRACKTYP = ALTTRACK; END;       0230
         B     @RC00226                                            0230
@RF00226 DS    0H                                                  0231
         OI    TRACKTYP,B'10000000'                                0231
*/*                  READ RECORD-ZERO (OF THE ALTERNATE TRACK TO     */
*/*                   CHECK THAT IS IS NOT ASSIGNED TO A             */
*/*                   PRIMARY TRACK)                                 */
*                    CALL ICKDVOP0 (GDTTBL                         0233
*                           ,VOLIB                                 0233
*                           ,ACTRDRZ                               0233
*                           ,ALTPTR                                0233
*                           ,RECNUM                                0233
*                           ,POOLID                                0233
*                           ,RZPTR                                 0233
*                           ,RZLEN                                 0233
*                           ,RETCODE);                             0233
@RC00226 L     @10,@PC00001                                        0233
         ST    @10,@AL00001                                        0233
         L     @15,@PC00001+4                                      0233
         ST    @15,@AL00001+4                                      0233
         LA    @15,@CF00124                                        0233
         ST    @15,@AL00001+8                                      0233
         L     @15,@PC00001+20                                     0233
         ST    @15,@AL00001+12                                     0233
         LA    @15,RECNUM                                          0233
         ST    @15,@AL00001+16                                     0233
         LA    @15,POOLID                                          0233
         ST    @15,@AL00001+20                                     0233
         LA    @15,RZPTR                                           0233
         ST    @15,@AL00001+24                                     0233
         LA    @15,RZLEN                                           0233
         ST    @15,@AL00001+28                                     0233
         LA    @15,RETCODE                                         0233
         ST    @15,@AL00001+32                                     0233
         L     @15,GDTDOP(,@10)                                    0233
         LA    @01,@AL00001                                        0233
         BALR  @14,@15                                             0233
*/*                  IF THE READ OPERATION WAS UNSUCCESSFUL          */
*                    IF RETCODE = CPFAILS                          0234
*/*                    THEN                                          */
*                      THEN DO;                                    0234
*                                                                  0234
         CLC   RETCODE(4),@CF00052                                 0234
         BNE   @RF00234                                            0234
*/*                      SET FLAG TO INDICATE TRK CANNOT BE ASSIGNED */
*                        ASSGNFLG = NOASSIGN;                      0236
         NI    ASSGNFLG,B'01111111'                                0236
*/*                      SET ADDRESS OF THE UNRECOVERABLE TRACK      */
*                        UNTRADDR = ALTPTR;                        0237
         L     @10,@PC00001+28                                     0237
         L     @15,@PC00001+20                                     0237
         MVC   UNTRADDR(4,@10),ALTPTR(@15)                         0237
*/*                      INDICATE THAT AN UNRECOVERABLE TRK WAS FOUND*/
*                        CONDCODE = UNTRFND;                       0238
         L     @10,@PC00001+32                                     0238
         MVC   CONDCODE(4,@10),@CF00263                            0238
*/*                      SET POINTER TO NEXT AVAILABLE ALTERNATE TRK */
*                        IF ALTPTRT = TRKSPCYL - 1                 0239
*                          THEN DO;                                0239
*                                                                  0239
         L     @10,INFOPTR+8                                       0239
         L     @10,TRKSPCYL(,@10)                                  0239
         BCTR  @10,0                                               0239
         MVC   @ZT00002+2(2),ALTPTRT(@15)                          0239
         C     @10,@ZT00002                                        0239
         BNE   @RF00239                                            0239
*                            ALTPTRC = ALTPTRC + 1;                0241
         LA    @10,1                                               0241
         MVC   @ZT00002+2(2),ALTPTRC(@15)                          0241
         AL    @10,@ZT00002                                        0241
         STH   @10,ALTPTRC(,@15)                                   0241
*                            ALTPTRT = 0;                          0242
         SLR   @10,@10                                             0242
         STH   @10,ALTPTRT(,@15)                                   0242
*                            END;                                  0243
*                          ELSE DO;    ALTPTRT = ALTPTRT + 1;      0244
         B     @RC00239                                            0244
@RF00239 DS    0H                                                  0245
         L     @10,@PC00001+20                                     0245
         LA    @15,1                                               0245
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0245
         AL    @15,@ZT00002                                        0245
         STH   @15,ALTPTRT(,@10)                                   0245
*                            END;                                  0246
*/*                      LEAVE                                       */
*                        GOTO ENDLOOP;                             0247
         B     ENDLOOP                                             0247
*/*                      END-THEN                                    */
*                        END;                                      0248
*/*                    ELSE (RECOVERABLE TRACK FOUND)                */
*                      ELSE DO;                                    0249
*                                                                  0249
@RF00234 DS    0H                                                  0250
*/*                      IF ALTERNATE TRACK IS FLAGGED DEFECTIVE     */
*                        IF RETCODE = DFLAGONA × RETCODE = DFLAGONP
*/*                        THEN                                      */
*                          THEN DO;                                0250
*                                                                  0250
         L     @10,RETCODE                                         0250
         CH    @10,@CH00127                                        0250
         BE    @RT00250                                            0250
         CH    @10,@CH00124                                        0250
         BNE   @RF00250                                            0250
@RT00250 DS    0H                                                  0251
*/*                          SET FLAG TO INDICATE TRACK CANNOT BE    */
*/*                           ASSIGNED                               */
*                            ASSGNFLG = NOASSIGN;                  0252
         NI    ASSGNFLG,B'01111111'                                0252
*/*                          SET POINTER TO NEXT AVAILABLE ALTERNATE */
*/*                           TRACK (ALTPTR)                         */
*                            IF ALTPTRT = TRKSPCYL - 1             0253
*                              THEN DO;                            0253
*                                                                  0253
         L     @10,@PC00001+20                                     0253
         L     @01,INFOPTR+8                                       0253
         L     @15,TRKSPCYL(,@01)                                  0253
         BCTR  @15,0                                               0253
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0253
         C     @15,@ZT00002                                        0253
         BNE   @RF00253                                            0253
*                                ALTPTRC = ALTPTRC + 1;            0255
         LA    @15,1                                               0255
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0255
         AL    @15,@ZT00002                                        0255
         STH   @15,ALTPTRC(,@10)                                   0255
*                                ALTPTRT = 0;                      0256
         SLR   @15,@15                                             0256
         STH   @15,ALTPTRT(,@10)                                   0256
*                                END;                              0257
*                              ELSE DO;                            0258
*                                                                  0258
         B     @RC00253                                            0258
@RF00253 DS    0H                                                  0259
*                                ALTPTRT = ALTPTRT + 1;            0259
         L     @10,@PC00001+20                                     0259
         LA    @15,1                                               0259
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0259
         AL    @15,@ZT00002                                        0259
         STH   @15,ALTPTRT(,@10)                                   0259
*                                END;                              0260
*/*                          END-THEN                                */
*                            END;                                  0261
*/*                        ELSE (TRACK NOT FLAGGED DEFECTIVE)        */
*                          ELSE DO;                                0262
*                                                                  0262
         B     @RC00250                                            0262
@RF00250 DS    0H                                                  0263
*/*                          IF ALTERNATE TRACK POINTING TO PRIMARY  */
*                            IF RZCCHHC <= FINPRIC &               0263
*                             RZCCHHT <= FINPRIT & RZCCHH >= 0     0263
*/*                            THEN (ALTERNATE POINTING TO PRIMARY)  */
*                              THEN DO;                            0263
         L     @10,RZPTR                                           0263
         L     @15,INFOPTR+16                                      0263
         CLC   RZCCHHC(2,@10),FINPRIC(@15)                         0263
         BH    @RF00263                                            0263
         CLC   RZCCHHT(2,@10),FINPRIT(@15)                         0263
         BH    @RF00263                                            0263
         CLC   RZCCHH(4,@10),@CF00102                              0263
         BL    @RF00263                                            0263
*/*                              READ PRIMARY TRACK RECORD-ZERO      */
*                                CALL ICKDVOP0 (GDTTBL             0265
*                                       ,VOLIB                     0265
*                                       ,ACTRDRZ                   0265
*                                       ,RZCCHH                    0265
*                                       ,RECNUM                    0265
*                                       ,POOLID                    0265
*                                       ,RZAPTR                    0265
*                                       ,RZLEN                     0265
*                                       ,RETCODE);                 0265
         L     @15,@PC00001                                        0265
         ST    @15,@AL00001                                        0265
         L     @14,@PC00001+4                                      0265
         ST    @14,@AL00001+4                                      0265
         LA    @14,@CF00124                                        0265
         ST    @14,@AL00001+8                                      0265
         ST    @10,@AL00001+12                                     0265
         LA    @10,RECNUM                                          0265
         ST    @10,@AL00001+16                                     0265
         LA    @10,POOLID                                          0265
         ST    @10,@AL00001+20                                     0265
         LA    @10,RZAPTR                                          0265
         ST    @10,@AL00001+24                                     0265
         LA    @10,RZLEN                                           0265
         ST    @10,@AL00001+28                                     0265
         LA    @10,RETCODE                                         0265
         ST    @10,@AL00001+32                                     0265
         L     @15,GDTDOP(,@15)                                    0265
         LA    @01,@AL00001                                        0265
         BALR  @14,@15                                             0265
*/*                              READ PRIMARY TRACK HOME-ADDRESS     */
*                                CALL ICKDVOP0 (GDTTBL             0266
*                                       ,VOLIB                     0266
*                                       ,ACTRDHA                   0266
*                                       ,RZCCHH                    0266
*                                       ,RECNUM                    0266
*                                       ,POOLID                    0266
*                                       ,HAPTR                     0266
*                                       ,HALEN                     0266
*                                       ,RETCODE1);                0266
         L     @10,@PC00001                                        0266
         ST    @10,@AL00001                                        0266
         L     @15,@PC00001+4                                      0266
         ST    @15,@AL00001+4                                      0266
         LA    @15,@CF00173                                        0266
         ST    @15,@AL00001+8                                      0266
         L     @01,RZPTR                                           0266
         ST    @01,@AL00001+12                                     0266
         LA    @15,RECNUM                                          0266
         ST    @15,@AL00001+16                                     0266
         LA    @15,POOLID                                          0266
         ST    @15,@AL00001+20                                     0266
         LA    @15,HAPTR                                           0266
         ST    @15,@AL00001+24                                     0266
         LA    @15,HALEN                                           0266
         ST    @15,@AL00001+28                                     0266
         LA    @15,RETCODE1                                        0266
         ST    @15,@AL00001+32                                     0266
         L     @15,GDTDOP(,@10)                                    0266
         LA    @01,@AL00001                                        0266
         BALR  @14,@15                                             0266
*/*                              IF READ FAILS                       */
*                                IF RETCODE = CPFAILS ×            0267
*                                 RETCODE1 = CPFAILS               0267
*/*                                THEN                              */
*                                  THEN DO;                        0267
*                                                                  0267
         LA    @10,4                                               0267
         C     @10,RETCODE                                         0267
         BE    @RT00267                                            0267
         C     @10,RETCODE1                                        0267
         BNE   @RF00267                                            0267
@RT00267 DS    0H                                                  0268
*/*                                  INDICATE TRACK UNASSIGNABLE     */
*                                    ASSGNFLG = NOASSIGN;          0269
         NI    ASSGNFLG,B'01111111'                                0269
*/*                                  SAVE UNRECOVERABLE TRACK        */
*                                    UNTRADDR = RZCCHH;            0270
         L     @10,@PC00001+28                                     0270
         L     @01,RZPTR                                           0270
         MVC   UNTRADDR(4,@10),RZCCHH(@01)                         0270
*/*                                  STATE UNRECOVERABLE TRACK FOUND */
*                                    CONDCODE = UNTRFND;           0271
         L     @10,@PC00001+32                                     0271
         MVC   CONDCODE(4,@10),@CF00263                            0271
*/*                                  POINT TO NEXT TRACK             */
*                                    IF ALTPTRT = TRKSPCYL - 1     0272
*                                      THEN DO;                    0272
*                                                                  0272
         L     @10,@PC00001+20                                     0272
         L     @01,INFOPTR+8                                       0272
         L     @15,TRKSPCYL(,@01)                                  0272
         BCTR  @15,0                                               0272
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0272
         C     @15,@ZT00002                                        0272
         BNE   @RF00272                                            0272
*                                        ALTPTRC = ALTPTRC + 1;    0274
         LA    @15,1                                               0274
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0274
         AL    @15,@ZT00002                                        0274
         STH   @15,ALTPTRC(,@10)                                   0274
*                                        ALTPTRT = 0;              0275
         SLR   @15,@15                                             0275
         STH   @15,ALTPTRT(,@10)                                   0275
*                                        END;                      0276
*                                      ELSE DO;                    0277
         B     @RC00272                                            0277
@RF00272 DS    0H                                                  0278
*                                        ALTPTRT = ALTPTRT + 1;    0278
         L     @10,@PC00001+20                                     0278
         LA    @15,1                                               0278
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0278
         AL    @15,@ZT00002                                        0278
         STH   @15,ALTPTRT(,@10)                                   0278
*                                        END;                      0279
*/*                                  LEAVE                           */
*                                    GOTO ENDLOOP;                 0280
         B     ENDLOOP                                             0280
*/*                                  END-THEN                        */
*                                    END;                          0281
*/*                                ELSE (PRIMARY R0 AVAILABLE)       */
*                                  ELSE DO;                        0282
@RF00267 DS    0H                                                  0283
*/*                                  IF PRIMARY POINTING TO ALTERNATE*/
*/*                                   AND IS DEFECTIVE               */
*                                    IF RZACCHH = ALTPTR &         0283
*                                     (RETCODE = DFLAGONP ×        0283
*                                     RETCODE = DFLAGONA) ×        0283
*                                     (RETCODE1 = DFLAGONP ×       0283
*                                     RETCODE1 = DFLAGONA)         0283
*/*                                    THEN (TRACK ASSIGNED)         */
*                                      THEN DO;                    0283
         L     @10,@PC00001+20                                     0283
         L     @01,RZAPTR                                          0283
         CLC   RZACCHH(4,@01),ALTPTR(@10)                          0283
         BNE   @GL00006                                            0283
         L     @10,RETCODE                                         0283
         CH    @10,@CH00124                                        0283
         BE    @RT00283                                            0283
         CH    @10,@CH00127                                        0283
         BE    @RT00283                                            0283
@GL00006 L     @10,RETCODE1                                        0283
         CH    @10,@CH00124                                        0283
         BE    @RT00283                                            0283
         CH    @10,@CH00127                                        0283
         BNE   @RF00283                                            0283
@RT00283 DS    0H                                                  0284
*/*                                      INDICATE TRACK NOT          */
*/*                                       ASSIGNABLE                 */
*                                        ASSGNFLG = NOASSIGN;      0285
         NI    ASSGNFLG,B'01111111'                                0285
*/*                                      POINT TO NEXT AVAILABLE     */
*/*                                       TRACK (ALTPTR)             */
*                                        IF ALTPTRT = TRKSPCYL - 1 0286
*                                          THEN DO;                0286
*                                                                  0286
         L     @10,@PC00001+20                                     0286
         L     @01,INFOPTR+8                                       0286
         L     @15,TRKSPCYL(,@01)                                  0286
         BCTR  @15,0                                               0286
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0286
         C     @15,@ZT00002                                        0286
         BNE   @RF00286                                            0286
*                                            ALTPTRC = ALTPTRC + 1;
         LA    @15,1                                               0288
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0288
         AL    @15,@ZT00002                                        0288
         STH   @15,ALTPTRC(,@10)                                   0288
*                                            ALTPTRT = 0;          0289
         SLR   @15,@15                                             0289
         STH   @15,ALTPTRT(,@10)                                   0289
*                                            END;                  0290
*                                          ELSE DO;                0291
*                                                                  0291
         B     @RC00286                                            0291
@RF00286 DS    0H                                                  0292
*                                            ALTPTRT = ALTPTRT + 1;
         L     @10,@PC00001+20                                     0292
         LA    @15,1                                               0292
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0292
         AL    @15,@ZT00002                                        0292
         STH   @15,ALTPTRT(,@10)                                   0292
*                                            END;                  0293
*/*                                      END-THEN (TRACK ASSIGNED)   */
*                                        END;                      0294
*/*                                    ELSE (TRACK ASSIGNABLE)       */
*                                      ELSE DO;                    0295
         B     @RC00283                                            0295
@RF00283 DS    0H                                                  0296
*/*                                      INDICATE TRACK ASSIGNABLE   */
*                                        ASSGNFLG = ASSIGN;        0296
         OI    ASSGNFLG,B'10000000'                                0296
*/*                                      LEAVE                       */
*                                        GOTO ENDLOOP;             0297
         B     ENDLOOP                                             0297
*/*                                      END-ELSE (TRACK ASSIGNABLE) */
*                                        END;                      0298
*/*                                  END-ELSE (PRIMARY R0 AVAILABLE) */
*                                    END;                          0299
@RC00283 DS    0H                                                  0300
*/*                              END-THEN (TRACK POINTING TO PRIMARY)*/
*                                END;                              0300
*/*                            ELSE (TRACK NOT POINTING TO PRIMARY)  */
*                              ELSE DO;                            0301
*                                                                  0301
         B     @RC00263                                            0301
@RF00263 DS    0H                                                  0302
*/*                              INDICATE TRACK ASSIGNABLE           */
*                                ASSGNFLG = ASSIGN;                0302
         OI    ASSGNFLG,B'10000000'                                0302
*/*                              LEAVE                               */
*                                GOTO ENDLOOP;                     0303
         B     ENDLOOP                                             0303
*/*                              END-ELSE                            */
*                                END;                              0304
*/*                          END-ELSE (TRACK NOT FLAGGED DEFECTIVE)  */
*                            END;                                  0305
@RC00263 DS    0H                                                  0306
*/*                      END-ELSE (TRACK WAS RECOVERABLE)            */
*                        END;                                      0306
@RC00250 DS    0H                                                  0307
*/*                  END-ELSE                                        */
*                    END;                                          0307
*/*              END-ELSE                                            */
*                END;                                              0308
@RC00213 DS    0H                                                  0309
*/*        END-WHILE                                                 */
*          END;                                                    0309
@DE00195 L     @10,@PC00001+20                                     0309
         L     @01,INFOPTR                                         0309
         CLC   ALTPTR(4,@10),LASTALT(@01)                          0309
         BNH   @DL00195                                            0309
*          ENDLOOP:                                                0310
*/*        IF NO ERRORS FOUND                                        */
*          IF CONDCODE = SUCCEEDS                                  0310
*/*          THEN                                                    */
*            THEN DO;                                              0310
*                                                                  0310
ENDLOOP  L     @10,@PC00001+32                                     0310
         L     @15,CONDCODE(,@10)                                  0310
         LTR   @15,@15                                             0310
         BNZ   @RF00310                                            0310
*/*            IF AN ASSIGNABLE TRACK HAS NOT BEEN FOUND             */
*              IF ASSGNFLG = NOASSIGN                              0312
*/*              THEN INDICATE THERE ARE NO AVAILABLE ALTERNATE TRKS */
*                THEN DO;    CONDCODE = NOALTS; END;               0312
         TM    ASSGNFLG,B'10000000'                                0312
         BNZ   @RF00312                                            0312
         MVC   CONDCODE(4,@10),@CF00173                            0314
*/*              ELSE                                                */
*                ELSE DO;                                          0316
*                                                                  0316
         B     @RC00312                                            0316
@RF00312 DS    0H                                                  0317
*/*                SAVE THE CURRENT TRACK ADDRESS                    */
*                  CTRADDR = ALTPTR;                               0317
         L     @10,@PC00001+20                                     0317
         MVC   CTRADDR(4),ALTPTR(@10)                              0317
*/*                IF THE ALTERNATE FLAG IS NOT SET ON               */
*                  IF TRACKTYP = PRITRACK                          0318
*/*                  THEN                                            */
*                    THEN DO;                                      0318
*                                                                  0318
         TM    TRACKTYP,B'10000000'                                0318
         BNZ   @RF00318                                            0318
*/*                    WRITE ALTERNATE HOME-ADDRESS (UDEVOP)         */
*                      CALL ICKDVOP0 (GDTTBL                       0320
*                             ,VOLIB                               0320
*                             ,ACTWAHA                             0320
*                             ,ALTPTR                              0320
*                             ,RECNUM                              0320
*                             ,POOLID                              0320
*                             ,HAPTR                               0320
*                             ,HALEN                               0320
*                             ,RETCODE);                           0320
         L     @15,@PC00001                                        0320
         ST    @15,@AL00001                                        0320
         L     @14,@PC00001+4                                      0320
         ST    @14,@AL00001+4                                      0320
         LA    @14,@CF00127                                        0320
         ST    @14,@AL00001+8                                      0320
         ST    @10,@AL00001+12                                     0320
         LA    @10,RECNUM                                          0320
         ST    @10,@AL00001+16                                     0320
         LA    @10,POOLID                                          0320
         ST    @10,@AL00001+20                                     0320
         LA    @10,HAPTR                                           0320
         ST    @10,@AL00001+24                                     0320
         LA    @10,HALEN                                           0320
         ST    @10,@AL00001+28                                     0320
         LA    @10,RETCODE                                         0320
         ST    @10,@AL00001+32                                     0320
         L     @15,GDTDOP(,@15)                                    0320
         LA    @01,@AL00001                                        0320
         BALR  @14,@15                                             0320
*/*                    IF WRITE OPERATION FAILS                      */
*                      IF RETCODE = CPFAILS                        0321
*/*                      THEN                                        */
*                        THEN DO;                                  0321
*                                                                  0321
         CLC   RETCODE(4),@CF00052                                 0321
         BNE   @RF00321                                            0321
*/*                        INDICATE FAILURE                          */
*                          CONDCODE = NOAASSOC;                    0323
         L     @10,@PC00001+32                                     0323
         MVC   CONDCODE(4,@10),@CF00144                            0323
*/*                        SAVE THE TRACK ADDRESS                    */
*                          UNTRADDR = ALTPTR;                      0324
         L     @10,@PC00001+28                                     0324
         L     @15,@PC00001+20                                     0324
         MVC   UNTRADDR(4,@10),ALTPTR(@15)                         0324
*/*                        END-THEN                                  */
*                          END;                                    0325
*/*                    END-THEN                                      */
*                      END;                                        0326
@RF00321 DS    0H                                                  0327
*/*                END-ELSE                                          */
*                  END;                                            0327
@RF00318 DS    0H                                                  0328
*/*            END-THEN                                              */
*              END;                                                0328
@RC00312 DS    0H                                                  0329
*/*        END-THEN                                                  */
*          END;                                                    0329
@RF00310 DS    0H                                                  0330
*/*    IF NO ERRORS FOUND                                            */
*      IF CONDCODE = SUCCEEDS                                      0330
*/*      THEN                                                        */
*        THEN DO;                                                  0330
*                                                                  0330
@RF00193 L     @10,@PC00001+32                                     0330
         L     @10,CONDCODE(,@10)                                  0330
         LTR   @10,@10                                             0330
         BNZ   @RF00330                                            0330
*/*        WRITE STANDARD-LENGTH RECORD-ZERO (ON THE PRIMARY TRACK   */
*/*         ASSOCIATING IT TO THE NEW ALTERNATE TRACK) (UDEVOP)      */
*          CALL ICKDVOP0 (GDTTBL                                   0332
*                 ,VOLIB                                           0332
*                 ,ACTWRZS                                         0332
*                 ,PRCCHH                                          0332
*                 ,RECNUM                                          0332
*                 ,POOLID                                          0332
*                 ,ADDR (ALTPTR)                                   0332
*                 ,LENGTH (ALTPTR)                                 0332
*                 ,RETCODE);                                       0332
         L     @10,@PC00001                                        0332
         ST    @10,@AL00001                                        0332
         L     @15,@PC00001+4                                      0332
         ST    @15,@AL00001+4                                      0332
         LA    @15,@CF00169                                        0332
         ST    @15,@AL00001+8                                      0332
         L     @15,@PC00001+8                                      0332
         ST    @15,@AL00001+12                                     0332
         LA    @15,RECNUM                                          0332
         ST    @15,@AL00001+16                                     0332
         LA    @15,POOLID                                          0332
         ST    @15,@AL00001+20                                     0332
         L     @15,@PC00001+20                                     0332
         ST    @15,@AFTEMPS                                        0332
         LA    @15,@AFTEMPS                                        0332
         ST    @15,@AL00001+24                                     0332
         LA    @15,@CF00052                                        0332
         ST    @15,@AL00001+28                                     0332
         LA    @15,RETCODE                                         0332
         ST    @15,@AL00001+32                                     0332
         L     @15,GDTDOP(,@10)                                    0332
         LA    @01,@AL00001                                        0332
         BALR  @14,@15                                             0332
*/*        IF WRITE OPERATION FAILS                                  */
*          IF RETCODE = CPFAILS                                    0333
*/*          THEN INDICATE ASSOCIATION OF THE NEW ALTERNATE TO THE   */
*/*           PRIMARY TRACK FAILS                                    */
*            THEN DO;    CONDCODE = NOPASSOC; END;                 0333
         CLC   RETCODE(4),@CF00052                                 0333
         BNE   @RF00333                                            0333
         L     @10,@PC00001+32                                     0335
         MVC   CONDCODE(4,@10),@CF00124                            0335
*/*        END-THEN                                                  */
*          END;                                                    0337
@RF00333 DS    0H                                                  0338
*/*    IF NO ERRORS FOUND                                            */
*      IF CONDCODE = SUCCEEDS                                      0338
*/*      THEN                                                        */
*        THEN DO;                                                  0338
*                                                                  0338
@RF00330 L     @10,@PC00001+32                                     0338
         L     @10,CONDCODE(,@10)                                  0338
         LTR   @10,@10                                             0338
         BNZ   @RF00338                                            0338
*/*        WRITE STANDARD-LENGTH RECORD-ZERO (ON THE NEW ALTERNATE   */
*/*         TRACK ASSOCIATING IT TO THE PRIMARY TRACK) (UDEVOP)      */
*          CALL ICKDVOP0 (GDTTBL                                   0340
*                 ,VOLIB                                           0340
*                 ,ACTWRZS                                         0340
*                 ,ALTPTR                                          0340
*                 ,RECNUM                                          0340
*                 ,POOLID                                          0340
*                 ,ADDR (PRCCHH)                                   0340
*                 ,LENGTH (PRCCHH)                                 0340
*                 ,RETCODE);                                       0340
         L     @10,@PC00001                                        0340
         ST    @10,@AL00001                                        0340
         L     @15,@PC00001+4                                      0340
         ST    @15,@AL00001+4                                      0340
         LA    @15,@CF00169                                        0340
         ST    @15,@AL00001+8                                      0340
         L     @15,@PC00001+20                                     0340
         ST    @15,@AL00001+12                                     0340
         LA    @15,RECNUM                                          0340
         ST    @15,@AL00001+16                                     0340
         LA    @15,POOLID                                          0340
         ST    @15,@AL00001+20                                     0340
         L     @15,@PC00001+8                                      0340
         ST    @15,@AFTEMPS                                        0340
         LA    @15,@AFTEMPS                                        0340
         ST    @15,@AL00001+24                                     0340
         LA    @15,@CF00052                                        0340
         ST    @15,@AL00001+28                                     0340
         LA    @15,RETCODE                                         0340
         ST    @15,@AL00001+32                                     0340
         L     @15,GDTDOP(,@10)                                    0340
         LA    @01,@AL00001                                        0340
         BALR  @14,@15                                             0340
*/*        SAVE THE ADDRESS OF THE ALTERNATE TRACK THAT WAS ASSIGNED */
*          ALTRACK = ALTPTR;                                       0341
         L     @10,@PC00001+24                                     0341
         L     @15,@PC00001+20                                     0341
         MVC   ALTRACK(4,@10),ALTPTR(@15)                          0341
*/*        DECREMENT ALTERNATE TRACK COUNT (ALTCOUNT)                */
*          ALTCOUNT = ALTCOUNT - 1;                                0342
         L     @10,@PC00001+16                                     0342
         L     @14,ALTCOUNT(,@10)                                  0342
         BCTR  @14,0                                               0342
         ST    @14,ALTCOUNT(,@10)                                  0342
*/*        SET POINTER TO NEXT AVAILABLE ALTERNATE TRACK (ALTPTR)    */
*          IF ALTPTRT = TRKSPCYL - 1                               0343
*            THEN DO;                                              0343
*                                                                  0343
         L     @10,INFOPTR+8                                       0343
         L     @10,TRKSPCYL(,@10)                                  0343
         BCTR  @10,0                                               0343
         MVC   @ZT00002+2(2),ALTPTRT(@15)                          0343
         C     @10,@ZT00002                                        0343
         BNE   @RF00343                                            0343
*                ALTPTRC = ALTPTRC + 1;                            0345
         LA    @10,1                                               0345
         MVC   @ZT00002+2(2),ALTPTRC(@15)                          0345
         AL    @10,@ZT00002                                        0345
         STH   @10,ALTPTRC(,@15)                                   0345
*                ALTPTRT = 0;                                      0346
         SLR   @10,@10                                             0346
         STH   @10,ALTPTRT(,@15)                                   0346
*                END;                                              0347
*              ELSE DO;    ALTPTRT = ALTPTRT + 1; END;             0348
         B     @RC00343                                            0348
@RF00343 DS    0H                                                  0349
         L     @10,@PC00001+20                                     0349
         LA    @15,1                                               0349
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0349
         AL    @15,@ZT00002                                        0349
         STH   @15,ALTPTRT(,@10)                                   0349
*/*        IF WRITE OPERATION FAILS                                  */
*          IF RETCODE = CPFAILS                                    0351
*/*          THEN                                                    */
*            THEN DO;                                              0351
*                                                                  0351
@RC00343 CLC   RETCODE(4),@CF00052                                 0351
         BNE   @RF00351                                            0351
*/*            INDICATE ASSOCIATION OF THE PRIMARY TO THE NEW        */
*/*             ALTERNATE TRACK FAILS                                */
*              CONDCODE = NOAASSOC;                                0353
         L     @10,@PC00001+32                                     0353
         MVC   CONDCODE(4,@10),@CF00144                            0353
*/*            SAVE THE TRACK ADDRESS FOR THE CALLER                 */
*              UNTRADDR = CTRADDR;                                 0354
         L     @10,@PC00001+28                                     0354
         MVC   UNTRADDR(4,@10),CTRADDR                             0354
*/*            END-THEN                                              */
*              END;                                                0355
*/*          ELSE                                                    */
*            ELSE DO;                                              0356
*                                                                  0356
         B     @RC00351                                            0356
@RF00351 DS    0H                                                  0357
*/*            IF WRITE OPERATION IS SUCCESSFUL                      */
*              IF (RETCODE = SUCCESS) × (RETCODE = DFLAGOFA)       0357
*/*              THEN INDICATE THAT ASSIGNMENT IS COMPLETE           */
*                THEN DO;    ASSGNCOM = COMPLETE; END;             0357
         L     @10,RETCODE                                         0357
         LTR   @10,@10                                             0357
         BZ    @RT00357                                            0357
         CH    @10,@CH00193                                        0357
         BNE   @RF00357                                            0357
@RT00357 DS    0H                                                  0358
         OI    ASSGNCOM,B'10000000'                                0359
*/*            END-ELSE                                              */
*              END;                                                0361
@RF00357 DS    0H                                                  0362
*/*          END-THEN                                                */
*            END;                                                  0362
@RC00351 DS    0H                                                  0363
*/*    IF NO ERRORS FOUND                                            */
*      IF CONDCODE = SUCCEEDS                                      0363
*/*      THEN                                                        */
*        THEN DO;                                                  0363
*                                                                  0363
@RF00338 L     @10,@PC00001+32                                     0363
         L     @10,CONDCODE(,@10)                                  0363
         LTR   @10,@10                                             0363
         BNZ   @RF00363                                            0363
*/*        WRITE STANDARD-LENGTH RECORD-ZERO (OF THE OLD ALTERNATE   */
*/*         TRACK TO DISSOCIATE IT FROM THE PRIMARY TRACK) (UDEVOP)  */
*          CALL ICKDVOP0 (GDTTBL                                   0365
*                 ,VOLIB                                           0365
*                 ,ACTWRZS                                         0365
*                 ,ALCCHH                                          0365
*                 ,RECNUM                                          0365
*                 ,POOLID                                          0365
*                 ,ADDR (ALCCHH)                                   0365
*                 ,LENGTH (ALCCHH)                                 0365
*                 ,RETCODE);                                       0365
         L     @10,@PC00001                                        0365
         ST    @10,@AL00001                                        0365
         L     @15,@PC00001+4                                      0365
         ST    @15,@AL00001+4                                      0365
         LA    @15,@CF00169                                        0365
         ST    @15,@AL00001+8                                      0365
         L     @15,@PC00001+12                                     0365
         ST    @15,@AL00001+12                                     0365
         LA    @14,RECNUM                                          0365
         ST    @14,@AL00001+16                                     0365
         LA    @14,POOLID                                          0365
         ST    @14,@AL00001+20                                     0365
         ST    @15,@AFTEMPS                                        0365
         LA    @15,@AFTEMPS                                        0365
         ST    @15,@AL00001+24                                     0365
         LA    @15,@CF00052                                        0365
         ST    @15,@AL00001+28                                     0365
         LA    @15,RETCODE                                         0365
         ST    @15,@AL00001+32                                     0365
         L     @15,GDTDOP(,@10)                                    0365
         LA    @01,@AL00001                                        0365
         BALR  @14,@15                                             0365
*/*        IF WRITE OPERATION FAILS                                  */
*          IF RETCODE = CPFAILS                                    0366
*/*          THEN INDICATE DISSOCIATION OF THE OLD ALTERNATE FROM    */
*/*           THE PRIMARY TRACK FAILS                                */
*            THEN DO;    CONDCODE = NODISSOC; END;                 0366
         LA    @10,4                                               0366
         C     @10,RETCODE                                         0366
         BNE   @RF00366                                            0366
         L     @15,@PC00001+32                                     0368
         ST    @10,CONDCODE(,@15)                                  0368
*/*      END-THEN                                                    */
*        END;                                                      0370
@RF00366 DS    0H                                                  0371
*/*    IF ERRORS WERE FOUND                                          */
*      IF CONDCODE > SUCCEEDS                                      0371
*/*      THEN INDICATE THAT ASSIGNMENT IS COMPLETE (WITH ERROR)      */
*        THEN DO;    ASSGNCOM = COMPLETE; END;                     0371
@RF00363 L     @10,@PC00001+32                                     0371
         L     @10,CONDCODE(,@10)                                  0371
         LTR   @10,@10                                             0371
         BNP   @RF00371                                            0371
         OI    ASSGNCOM,B'10000000'                                0373
*/*  END-WHILE (ASSIGNMENT NOT COMPLETE)                             */
*    END;                                                          0375
@RF00371 DS    0H                                                  0375
@DE00184 TM    ASSGNCOM,B'10000000'                                0375
         BZ    @DL00184                                            0375
*/*  END-PROCEDURE RE-ASSIGN_ALTERNATE_TRACK                         */
*    CALL ICKSAFP0 (GDTTBL                                         0376
*           ,POOLID);                                              0376
         L     @10,@PC00001                                        0376
         ST    @10,@AL00001                                        0376
         LA    @15,POOLID                                          0376
         ST    @15,@AL00001+4                                      0376
         MVI   @AL00001+4,X'80'                                    0376
         L     @15,GDTFPL(,@10)                                    0376
         LA    @01,@AL00001                                        0376
         BALR  @14,@15                                             0376
*    IF GDTDBG = NULLPTR                                           0377
*      THEN;                                                       0377
         L     @10,@PC00001                                        0377
         L     @10,GDTDBG(,@10)                                    0377
         LTR   @10,@10                                             0377
         BZ    @RT00377                                            0377
*      ELSE                                                        0379
*        CALL ICKDB010 (GDTTBL                                     0379
*          ,'RA99');                                               0379
         L     @10,@PC00001                                        0379
         ST    @10,@AL00001                                        0379
         LA    @15,@CC00548                                        0379
         ST    @15,@AL00001+4                                      0379
         MVI   @AL00001+4,X'80'                                    0379
         L     @15,GDTDBG(,@10)                                    0379
         LA    @01,@AL00001                                        0379
         BALR  @14,@15                                             0379
*    CALL ICKSAEP0(GDTTBL,MODID);                                  0380
*                                                                  0380
*                                                                  0380
@RT00377 L     @10,@PC00001                                        0380
         ST    @10,@AL00001                                        0380
         LA    @15,MODID                                           0380
         ST    @15,@AL00001+4                                      0380
         MVI   @AL00001+4,X'80'                                    0380
         L     @15,GDTEPL(,@10)                                    0380
         LA    @01,@AL00001                                        0380
         BALR  @14,@15                                             0380
*    END ICKRA01                                                   0381
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*;                                                                 0381
@DATA    DS    0H
@CH00193 DC    H'7'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    9F
@AL00001 DS    9A
@AFTEMPS DS    1F
@ZTEMPS  DS    0F
@ZT00002 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICKRA01  CSECT
         DS    0F
@CF00102 DC    F'0'
@CF00173 DC    F'1'
@CH00173 EQU   @CF00173+2
@CF00124 DC    F'2'
@CH00124 EQU   @CF00124+2
@CF00144 DC    F'3'
@CH00144 EQU   @CF00144+2
@CF00052 DC    F'4'
@CF00263 DC    F'5'
@CF00127 DC    F'6'
@CH00127 EQU   @CF00127+2
@CF00169 DC    F'8'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
RETCODE  DS    F
RETCODE1 DS    F
RECNUM   DS    F
HAPTR    DS    A
HALEN    DS    F
RZAPTR   DS    A
RZPTR    DS    A
RZLEN    DS    F
CTRADDR  DS    F
LISTPTR  DS    A
SETRC    DS    H
TESTRC   DS    H
LISTLN   DS    FL1
ASSGNFLG DS    BL1
ASSGNCOM DS    BL1
TRACKTYP DS    BL1
INFO     DS    CL8
         ORG   INFO+0
INFOPTR  DS    AL4
INFOLEN  DS    FL4
         ORG   INFO+24
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKRA01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00543 DC    C'RA00'
@CC00548 DC    C'RA99'
MODID    DC    CL4'RA01'
POOLID   DC    CL4'RA01'
PTCHRA01 DS    CL256
         ORG   PTCHRA01
@NM00018 DC    256X'00'
         ORG   PTCHRA01+256
INFOVECT DC    F'207'
         DC    F'204'
         DC    F'205'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
I        EQU   @02
REG12    EQU   @12
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
RTNREG   EQU   @15
ICKSAEP0 EQU   0
ICKSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
ICKDVIN0 EQU   0
ICKDVOP0 EQU   0
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
LASTALT  EQU   0
TRKSPCYL EQU   0
FINPRI   EQU   0
FINPRIC  EQU   FINPRI
FINPRIT  EQU   FINPRI+2
RZCCHH   EQU   0
RZCCHHC  EQU   RZCCHH
RZCCHHT  EQU   RZCCHH+2
RZACCHH  EQU   0
DMPTRM   EQU   0
ICKDVCL0 EQU   0
ICKDVON0 EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOOP0 EQU   0
ICKIOPT0 EQU   0
ICKIOTM0 EQU   0
ICKSACL0 EQU   0
ICKSADE0 EQU   0
ICKSAFS0 EQU   0
ICKSAGP0 EQU   0
ICKSAGS0 EQU   0
ICKSALD0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPPR0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NEWERID2 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
VOLIB    EQU   0
PRCCHH   EQU   0
ALCCHH   EQU   0
ALTCOUNT EQU   0
ALTPTR   EQU   0
ALTPTRC  EQU   ALTPTR
ALTPTRT  EQU   ALTPTR+2
ALTRACK  EQU   0
UNTRADDR EQU   0
CONDCODE EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
RZACCHHT EQU   RZACCHH+2
RZACCHHC EQU   RZACCHH
LASTALTT EQU   LASTALT+2
LASTALTC EQU   LASTALT
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCPNM   EQU   IOCSTR+28
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID2   EQU   TRACE2+95
OLDERID2 EQU   TRACE2
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00202 EQU   ENDLOOP
@RC00216 EQU   @RC00213
@RC00239 EQU   ENDLOOP
@RC00253 EQU   @RC00250
@RC00272 EQU   ENDLOOP
@RC00286 EQU   @RC00283
@ENDDATA EQU   *
         END   ICKRA01,(C'PLS1721',0701,78192)

         TITLE '**********  ICKIT01:  INSPECT COMMAND CONTROLLER  ******
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
ICKIT01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'ICKIT01   78.198'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @09,0                                               0002
@PSTART  LA    @10,4095(,@09)                                      0002
         LA    @11,4095(,@10)                                      0002
         LA    @12,4095(,@11)                                      0002
         LA    @08,4095(,@12)                                      0002
         USING @PSTART,@09                                         0002
         USING @PSTART+4095,@10                                    0002
         USING @PSTART+8190,@11                                    0002
         USING @PSTART+12285,@12                                   0002
         USING @PSTART+16380,@08                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @07,@01                                             0002
         USING @DATD,@07                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @07,8(,@13)                                         0002
         LR    @13,@07                                             0002
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0199
         EJECT
*                                                                  0200
*/*****  B E G I N    E X E C U T I O N  *****************************/
*                                                                  0200
*    IF GDTDBG = NULLPTR                                           0200
*      THEN;                                                       0200
         L     @06,@PC00001                                        0200
         L     @06,GDTDBG(,@06)                                    0200
         LTR   @06,@06                                             0200
         BZ    @RT00200                                            0200
*      ELSE                                                        0202
*        CALL ICKDB010 (GDTTBL                                     0202
*          ,'IT00');                                               0202
*                                                                  0202
         L     @06,@PC00001                                        0202
         ST    @06,@AL00001                                        0202
         LA    @15,@CC00832                                        0202
         ST    @15,@AL00001+4                                      0202
         MVI   @AL00001+4,X'80'                                    0202
         L     @15,GDTDBG(,@06)                                    0202
         LA    @01,@AL00001                                        0202
         BALR  @14,@15                                             0202
*/*  ESTABLISH UPRINT ARGUMENT LIST                                  */
*    PRTHDR = 'DARGLIST';                                          0203
@RT00200 MVC   PRTHDR(4),@CC00833                                  0203
*    PRTARGS = ''B;                                                0204
         XC    PRTARGS(52),PRTARGS                                 0204
*    DDSTRU = ADDR(PRTARGS);                                       0205
         LA    @06,PRTARGS                                         0205
         ST    @06,DDSTRU                                          0205
*    DARGSMOD = MSGMODZ;                                           0206
         MVC   DARGSMOD(3,@06),@CC00567                            0206
*/*  INDICATE INITIALLY A SUCCESSFUL COMPLETION (LASTCOND = 0)       */
*    LASTCOND = LASTCC00;                                          0207
         L     @06,@PC00001+8                                      0207
         SLR   @15,@15                                             0207
         STH   @15,LASTCOND(,@06)                                  0207
*/*  CHECK_PARAMETERS                                                */
*    CALL CHEKPARM;                                                0208
         BAL   @14,CHEKPARM                                        0208
*/*  IF NO SEVERE ERRORS FOUND                                       */
*    IF LASTCOND < LASTCC12                                        0209
*/*    THEN ISSUE_OPEN_VOLUME                                        */
*      THEN DO;    CALL OPENVOL; END;                              0209
         L     @06,@PC00001+8                                      0209
         LH    @06,LASTCOND(,@06)                                  0209
         CH    @06,@CH00265                                        0209
         BNL   @RF00209                                            0209
         BAL   @14,OPENVOL                                         0211
*/*  IF NO SEVERE ERRORS ENCOUNTERED                                 */
*    IF LASTCOND < LASTCC12                                        0213
*/*    THEN                                                          */
*      THEN DO;                                                    0213
*                                                                  0213
@RF00209 L     @06,@PC00001+8                                      0213
         LH    @06,LASTCOND(,@06)                                  0213
         CH    @06,@CH00265                                        0213
         BNL   @RF00213                                            0213
*/*      OBTAIN SETTING OF FIRST TIME INITIALIZATION FLAG (UDEVINFO) */
*        CALL ICKDVIN0 (GDTTBL                                     0215
*                 ,VOLIB                                           0215
*                 ,VOLFINIT                                        0215
*                 ,POOLID                                          0215
*                 ,VIBPTR                                          0215
*                 ,VIBLEN                                          0215
*                 ,RETCODE);                                       0215
         L     @06,@PC00001                                        0215
         ST    @06,@AL00001                                        0215
         LA    @15,VOLIB                                           0215
         ST    @15,@AL00001+4                                      0215
         LA    @15,@CF00260                                        0215
         ST    @15,@AL00001+8                                      0215
         LA    @15,POOLID                                          0215
         ST    @15,@AL00001+12                                     0215
         LA    @15,VIBPTR                                          0215
         ST    @15,@AL00001+16                                     0215
         LA    @15,VIBLEN                                          0215
         ST    @15,@AL00001+20                                     0215
         LA    @15,RETCODE                                         0215
         ST    @15,@AL00001+24                                     0215
         L     @15,GDTDIN(,@06)                                    0215
         LA    @01,@AL00001                                        0215
         BALR  @14,@15                                             0215
*/*      IF THE VOLUME IS BEING INITIALIZED FOR THE FIRST TIME       */
*        IF VIBFLAG = ON                                           0216
*/*        THEN                                                      */
*          THEN DO;                                                0216
*                                                                  0216
         L     @06,VIBPTR                                          0216
         TM    VIBFLAG(@06),B'10000000'                            0216
         BNO   @RF00216                                            0216
*/*          ISSUE AN ERROR MESSAGE                                  */
*            DARGSENT = MSGRTIN;                                   0218
         L     @06,DDSTRU                                          0218
         MVI   DARGSENT(@06),X'1B'                                 0218
*            CALL ICKTPPR0 (GDTTBL                                 0219
*                   ,PRTFILE                                       0219
*                   ,DDSTRU);                                      0219
         L     @06,@PC00001                                        0219
         ST    @06,@AL00001                                        0219
         LA    @15,@CF00094                                        0219
         ST    @15,@AL00001+4                                      0219
         LA    @15,DDSTRU                                          0219
         ST    @15,@AL00001+8                                      0219
         MVI   @AL00001+8,X'80'                                    0219
         L     @15,GDTPRT(,@06)                                    0219
         LA    @01,@AL00001                                        0219
         BALR  @14,@15                                             0219
*/*          INDICATE A SEVERE ERROR                                 */
*            LASTCOND = LASTCC12;                                  0220
         L     @06,@PC00001+8                                      0220
         MVC   LASTCOND(2,@06),@CH00265                            0220
*/*          END-THEN                                                */
*            END;                                                  0221
*/*      END-THEN                                                    */
*        END;                                                      0222
@RF00216 DS    0H                                                  0223
         EJECT
*/*  IF NO SEVERE ERRORS FOUND                                       */
*    IF LASTCOND < LASTCC12                                        0223
*/*    THEN                                                          */
*      THEN DO;                                                    0223
*                                                                  0223
@RF00213 L     @06,@PC00001+8                                      0223
         LH    @06,LASTCOND(,@06)                                  0223
         CH    @06,@CH00265                                        0223
         BNL   @RF00223                                            0223
*/*      OBTAIN_VOLUME_AUTHORIZATION                                 */
*        CALL ICKVA01                                              0225
*              (GDTTBL                                             0225
*              ,VOLIB                                              0225
*              ,RETCODE);                                          0225
         L     @06,@PC00001                                        0225
         ST    @06,@AL00001                                        0225
         LA    @06,VOLIB                                           0225
         ST    @06,@AL00001+4                                      0225
         LA    @06,RETCODE                                         0225
         ST    @06,@AL00001+8                                      0225
         L     @15,@CV00837                                        0225
         LA    @01,@AL00001                                        0225
         BALR  @14,@15                                             0225
*/*      IF AUTHORIZATION IS NOT GRANTED                             */
*        IF RETCODE = FAILURE                                      0226
*/*        THEN INDICATE A SEVERE ERROR (LASTCOND = 12)              */
*          THEN DO;    LASTCOND = LASTCC12; END;                   0226
         CLC   RETCODE(4),@CF00165                                 0226
         BNE   @RF00226                                            0226
         L     @06,@PC00001+8                                      0228
         MVC   LASTCOND(2,@06),@CH00265                            0228
*/*      END-THEN                                                    */
*        END;                                                      0230
@RF00226 DS    0H                                                  0231
         EJECT
*/*  IF NO SEVERE ERRORS FOUND AND VERIFICATION IS REQUESTED         */
*    IF (LASTCOND < LASTCC12) & (ADDR(VERFY) ^= NULLPTR)           0231
*/*    THEN                                                          */
*      THEN DO;                                                    0231
*                                                                  0231
@RF00223 L     @06,@PC00001+8                                      0231
         LH    @06,LASTCOND(,@06)                                  0231
         CH    @06,@CH00265                                        0231
         BNL   @RF00231                                            0231
         SLR   @06,@06                                             0231
         L     @15,@PC00001+4                                      0231
         C     @06,FDTPTR+28(,@15)                                 0231
         BE    @RF00231                                            0231
*/*      IF THE OWNER ID IS TO BE VERIFIED                           */
*        IF ADDR(VOWN) ^= NULLPTR                                  0233
*/*        THEN SET UP THE PROPER VALUE TO BE PASSED                 */
*          THEN DO;    VALVOWN = VOWNVAL; END;                     0233
         L     @15,FDTPTR+36(,@15)                                 0233
         CR    @15,@06                                             0233
         BE    @RF00233                                            0233
         MVC   VALVOWN(14),VOWNVAL(@15)                            0235
*/*        ELSE INDICATE THAT THE OWNER ID NEED NOT BE VERIFIED      */
*          ELSE DO;    VALVOWN = ' '; END;                         0237
         B     @RC00233                                            0237
@RF00233 DS    0H                                                  0238
         MVI   VALVOWN+1,C' '                                      0238
         MVC   VALVOWN+2(12),VALVOWN+1                             0238
         MVI   VALVOWN,C' '                                        0238
*/*      VERIFY_VOLUME_LABEL                                         */
*        CALL   ICKVV01                                            0240
*               (GDTTBL                                            0240
*               ,VOLIB                                             0240
*               ,VSERVAL                                           0240
*               ,VALVOWN                                           0240
*               ,RETCODE);                                         0240
@RC00233 L     @06,@PC00001                                        0240
         ST    @06,@AL00001                                        0240
         LA    @06,VOLIB                                           0240
         ST    @06,@AL00001+4                                      0240
         L     @06,@PC00001+4                                      0240
         L     @06,FDTPTR+32(,@06)                                 0240
         LA    @06,VSERVAL(,@06)                                   0240
         ST    @06,@AL00001+8                                      0240
         LA    @06,VALVOWN                                         0240
         ST    @06,@AL00001+12                                     0240
         LA    @06,RETCODE                                         0240
         ST    @06,@AL00001+16                                     0240
         L     @15,@CV00839                                        0240
         LA    @01,@AL00001                                        0240
         BALR  @14,@15                                             0240
*/*      IF VERIFICATION FAILS                                       */
*        IF RETCODE = FAILURE                                      0241
*/*        THEN INDICATE A SEVERE ERROR (LASTCOND = 12)              */
*          THEN DO;    LASTCOND = LASTCC12; END;                   0241
         CLC   RETCODE(4),@CF00165                                 0241
         BNE   @RF00241                                            0241
         L     @06,@PC00001+8                                      0243
         MVC   LASTCOND(2,@06),@CH00265                            0243
*/*      IF VOLUME LABEL DOES NOT EXIST                              */
*        IF RETCODE = NOLABEL                                      0245
*/*        THEN                                                      */
*          THEN DO;                                                0245
*                                                                  0245
@RF00241 CLC   RETCODE(4),@CF00116                                 0245
         BNE   @RF00245                                            0245
*/*          ISSUE ERROR MESSAGE (MSGURVOL) (UPRINT)                 */
*            DARGSENT = MSGURVOL;                                  0247
         L     @06,DDSTRU                                          0247
         MVI   DARGSENT(@06),X'10'                                 0247
*            CALL ICKTPPR0 (GDTTBL                                 0248
*                   ,PRTFILE                                       0248
*                   ,DDSTRU);                                      0248
         L     @06,@PC00001                                        0248
         ST    @06,@AL00001                                        0248
         LA    @15,@CF00094                                        0248
         ST    @15,@AL00001+4                                      0248
         LA    @15,DDSTRU                                          0248
         ST    @15,@AL00001+8                                      0248
         MVI   @AL00001+8,X'80'                                    0248
         L     @15,GDTPRT(,@06)                                    0248
         LA    @01,@AL00001                                        0248
         BALR  @14,@15                                             0248
*/*          INDICATE A SEVERE ERROR (LASTCOND = 12)                 */
*            LASTCOND = LASTCC12;                                  0249
         L     @06,@PC00001+8                                      0249
         MVC   LASTCOND(2,@06),@CH00265                            0249
*/*          END-THEN                                                */
*            END;                                                  0250
*/*      END-THEN                                                    */
*        END;                                                      0251
@RF00245 DS    0H                                                  0252
         EJECT
*/*  IF NO SEVERE ERRORS FOUND                                       */
*    IF LASTCOND < LASTCC12                                        0252
*/*    THEN SET_NUMBER_OF_TRACKS                                     */
*      THEN DO;    CALL SETTRACK; END;                             0252
@RF00231 L     @06,@PC00001+8                                      0252
         LH    @06,LASTCOND(,@06)                                  0252
         CH    @06,@CH00265                                        0252
         BNL   @RF00252                                            0252
         BAL   @14,SETTRACK                                        0254
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0256
*/*    THEN                                                          */
*      THEN DO;                                                    0256
@RF00252 L     @06,@PC00001+8                                      0256
         LH    @06,LASTCOND(,@06)                                  0256
         CH    @06,@CH00265                                        0256
         BNL   @RF00256                                            0256
*/*      INITIALIZE COUNT OF UNRECOVERABLE TRACKS TO 0               */
*        COUNTUTR = 0;                                             0258
         SLR   @06,@06                                             0258
         ST    @06,COUNTUTR                                        0258
*/*      INITIALIZE COUNT OF AVAILABLE ALTERNATE TRACKS TO           */
*/*      TO VALUE IN THE VTOC                                        */
*        ALTCOUNT = TALCNT;                                        0259
         MVC   ALTCOUNT(4),TALCNT                                  0259
*/*      INITIALIZE POINTER TO NEXT AVAILABLE ALTERNATE TRACK TO     */
*/*       THE FIRST ALTERNATE TRACK ON THE PACK                      */
*        ALTPTR = FIRSTAL;                                         0260
         L     @06,INFOPTR+48                                      0260
         MVC   ALTPTR(4),FIRSTAL(@06)                              0260
*/*      END-THEN                                                    */
*        END;                                                      0261
*/*  IF NO SEVERE ERRORS FOUND                                       */
*    IF LASTCOND < LASTCC12                                        0262
*/*    THEN INSPECT_THE_TRACKS                                       */
*      THEN DO;    CALL INSTRACK; END;                             0262
@RF00256 L     @06,@PC00001+8                                      0262
         LH    @06,LASTCOND(,@06)                                  0262
         CH    @06,@CH00265                                        0262
         BNL   @RF00262                                            0262
         BAL   @14,INSTRACK                                        0264
*/*  IF NO SEVERE ERRORS FOUND                                       */
*    IF LASTCOND < LASTCC12                                        0266
*/*    THEN UPDATE_VTOC                                              */
*      THEN DO;    CALL UPDVTOC; END;                              0266
@RF00262 L     @06,@PC00001+8                                      0266
         LH    @06,LASTCOND(,@06)                                  0266
         CH    @06,@CH00265                                        0266
         BNL   @RF00266                                            0266
         BAL   @14,UPDVTOC                                         0268
*/*  IF NO SEVERE ERRORS FOUND THUS FAR                              */
*    IF LASTCOND < LASTCC12                                        0270
*/*    THEN PRODUCE_PACK_MAP                                         */
*      THEN DO;                                                    0270
*                                                                  0270
@RF00266 L     @06,@PC00001+8                                      0270
         LH    @06,LASTCOND(,@06)                                  0270
         CH    @06,@CH00265                                        0270
         BNL   @RF00270                                            0270
*        IF ADDR(MAP) ^= NULLPTR                                   0272
*          THEN DO;    PRTFLG = ON; END;                           0272
         L     @06,@PC00001+4                                      0272
         L     @06,FDTPTR+44(,@06)                                 0272
         LTR   @06,@06                                             0272
         BZ    @RF00272                                            0272
         OI    PRTFLG,B'10000000'                                  0274
*          ELSE DO;    PRTFLG = OFF; END;                          0276
         B     @RC00272                                            0276
@RF00272 DS    0H                                                  0277
         NI    PRTFLG,B'01111111'                                  0277
*        IF ADDR (CHECK) ^= NULLPTR                                0279
*          THEN DO;    CHKFLG = ON; END;                           0279
@RC00272 L     @06,@PC00001+4                                      0279
         L     @06,FDTPTR+12(,@06)                                 0279
         LTR   @06,@06                                             0279
         BZ    @RF00279                                            0279
         OI    CHKFLG,B'10000000'                                  0281
*          ELSE DO;    CHKFLG = OFF; END;                          0283
         B     @RC00279                                            0283
@RF00279 DS    0H                                                  0284
         NI    CHKFLG,B'01111111'                                  0284
*        CALL ICKPP01                                              0286
*             (GDTTBL                                              0286
*             ,VOLIB                                               0286
*             ,PRTFLG                                              0286
*             ,CHKFLG                                              0286
*             ,VTOCLOC                                             0286
*             ,VTOCEXT                                             0286
*             ,TALCNT                                              0286
*             ,RETCODE);                                           0286
@RC00279 L     @06,@PC00001                                        0286
         ST    @06,@AL00001                                        0286
         LA    @06,VOLIB                                           0286
         ST    @06,@AL00001+4                                      0286
         LA    @06,PRTFLG                                          0286
         ST    @06,@AL00001+8                                      0286
         LA    @06,CHKFLG                                          0286
         ST    @06,@AL00001+12                                     0286
         LA    @06,VTOCLOC                                         0286
         ST    @06,@AL00001+16                                     0286
         LA    @06,VTOCEXT                                         0286
         ST    @06,@AL00001+20                                     0286
         LA    @06,TALCNT                                          0286
         ST    @06,@AL00001+24                                     0286
         LA    @06,RETCODE                                         0286
         ST    @06,@AL00001+28                                     0286
         L     @15,@CV00843                                        0286
         LA    @01,@AL00001                                        0286
         BALR  @14,@15                                             0286
*/*      END-THEN                                                    */
*        END;                                                      0287
*/*  IF VOLUME WAS OPENED                                            */
*    IF VOLIB ^= NULLPTR                                           0288
*/*    THEN CLOSE THE VOLUME (UDEVCLSE)                              */
*      THEN DO;                                                    0288
*                                                                  0288
@RF00270 L     @06,VOLIB                                           0288
         LTR   @06,@06                                             0288
         BZ    @RF00288                                            0288
*        CALL ICKDVCL0 (GDTTBL                                     0290
*                 ,VOLIB                                           0290
*                 ,RETCODE);                                       0290
         L     @06,@PC00001                                        0290
         ST    @06,@AL00001                                        0290
         LA    @15,VOLIB                                           0290
         ST    @15,@AL00001+4                                      0290
         LA    @15,RETCODE                                         0290
         ST    @15,@AL00001+8                                      0290
         L     @15,GDTDVC(,@06)                                    0290
         LA    @01,@AL00001                                        0290
         BALR  @14,@15                                             0290
*/*      IF UNABLE TO CLOSE THE VOLUME                               */
*        IF RETCODE = FAILURE                                      0291
*/*        THEN                                                      */
*          THEN DO;                                                0291
*                                                                  0291
         CLC   RETCODE(4),@CF00165                                 0291
         BNE   @RF00291                                            0291
*/*          ISSUE ERROR MESSAGE (MSGCLSEA) (UPRINT)                 */
*            DARGSENT = MSGCLSEA;                                  0293
         L     @06,DDSTRU                                          0293
         MVI   DARGSENT(@06),X'0B'                                 0293
*            CALL ICKTPPR0 (GDTTBL                                 0294
*                   ,PRTFILE                                       0294
*                   ,DDSTRU);                                      0294
         L     @06,@PC00001                                        0294
         ST    @06,@AL00001                                        0294
         LA    @15,@CF00094                                        0294
         ST    @15,@AL00001+4                                      0294
         LA    @15,DDSTRU                                          0294
         ST    @15,@AL00001+8                                      0294
         MVI   @AL00001+8,X'80'                                    0294
         L     @15,GDTPRT(,@06)                                    0294
         LA    @01,@AL00001                                        0294
         BALR  @14,@15                                             0294
*/*          INDICATE MINOR ERROR                                    */
*            LASTCOND = MAX (LASTCOND,LASTCC04);                   0295
         L     @06,@PC00001+8                                      0295
         LH    @15,LASTCOND(,@06)                                  0295
         LA    @14,4                                               0295
         CR    @15,@14                                             0295
         BNL   *+6
         LR    @15,@14                                             0295
         STH   @15,LASTCOND(,@06)                                  0295
*/*          END-THEN                                                */
*            END;                                                  0296
*/*      END-THEN                                                    */
*        END;                                                      0297
@RF00291 DS    0H                                                  0298
         EJECT
*/*  RETURN TO THE EXECUTIVE                                         */
*    DARGSMOD = MSGUNIV;                                           0298
@RF00288 L     @06,DDSTRU                                          0298
         MVC   DARGSMOD(3,@06),@CC00617                            0298
*    IF LASTCOND >= LASTCC12                                       0299
*      THEN DO;    DARGSENT = MSGUNIVB; END;                       0299
         L     @15,@PC00001+8                                      0299
         LH    @15,LASTCOND(,@15)                                  0299
         CH    @15,@CH00265                                        0299
         BL    @RF00299                                            0299
         MVI   DARGSENT(@06),X'03'                                 0301
*      ELSE DO;    DARGSENT = MSGUNIVA; END;                       0303
         B     @RC00299                                            0303
@RF00299 DS    0H                                                  0304
         L     @06,DDSTRU                                          0304
         MVI   DARGSENT(@06),X'01'                                 0304
*    DARGDBP = ADDR (LASTCOND);                                    0306
@RC00299 L     @06,DDSTRU                                          0306
         L     @15,@PC00001+8                                      0306
         ST    @15,DARGDBP(,@06)                                   0306
*    DARGILP = LENGTH (LASTCOND);                                  0307
         MVC   DARGILP(2,@06),@CH00116                             0307
*    CALL ICKTPPR0 (GDTTBL                                         0308
*           ,PRTFILE                                               0308
*           ,DDSTRU);                                              0308
         L     @06,@PC00001                                        0308
         ST    @06,@AL00001                                        0308
         LA    @15,@CF00094                                        0308
         ST    @15,@AL00001+4                                      0308
         LA    @15,DDSTRU                                          0308
         ST    @15,@AL00001+8                                      0308
         MVI   @AL00001+8,X'80'                                    0308
         L     @15,GDTPRT(,@06)                                    0308
         LA    @01,@AL00001                                        0308
         BALR  @14,@15                                             0308
*    IF GDTDBG = NULLPTR                                           0309
*      THEN;                                                       0309
         L     @06,@PC00001                                        0309
         L     @06,GDTDBG(,@06)                                    0309
         LTR   @06,@06                                             0309
         BZ    @RT00309                                            0309
*      ELSE                                                        0311
*        CALL ICKDB010 (GDTTBL                                     0311
*          ,'IT99');                                               0311
         L     @06,@PC00001                                        0311
         ST    @06,@AL00001                                        0311
         LA    @15,@CC00845                                        0311
         ST    @15,@AL00001+4                                      0311
         MVI   @AL00001+4,X'80'                                    0311
         L     @15,GDTDBG(,@06)                                    0311
         LA    @01,@AL00001                                        0311
         BALR  @14,@15                                             0311
*    CALL ICKSAFP0 (GDTTBL                                         0312
*           ,POOLID);                                              0312
@RT00309 L     @06,@PC00001                                        0312
         ST    @06,@AL00001                                        0312
         LA    @15,POOLID                                          0312
         ST    @15,@AL00001+4                                      0312
         MVI   @AL00001+4,X'80'                                    0312
         L     @15,GDTFPL(,@06)                                    0312
         LA    @01,@AL00001                                        0312
         BALR  @14,@15                                             0312
*    CALL ICKSAEP0(GDTTBL,MODID);                                  0313
         L     @06,@PC00001                                        0313
         ST    @06,@AL00001                                        0313
         LA    @15,MODID                                           0313
         ST    @15,@AL00001+4                                      0313
         MVI   @AL00001+4,X'80'                                    0313
         L     @15,GDTEPL(,@06)                                    0313
         LA    @01,@AL00001                                        0313
         BALR  @14,@15                                             0313
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  CHEKPARM                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  CHECK PARAMETERS                             */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE CHECKS FOR INVALID COMBINATIONS OF         */
*/*    KEYWORDS SUCH AS (NOCHECK, ASSIGN, AND ALLTRACKS).            */
*/*    IT ALSO SETS PROPER VALUES FOR A TRACK SURFACE CHECK          */
*/*    WHEN THE WHOLE PACK IS TO BE PROCESSED.                       */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0314
*                                                                  0314
*/*  SUB-PROCEDURE CHECK_PARAMETERS                                  */
*    CHEKPARM:                                                     0314
*      PROCEDURE;                                                  0314
CHEKPARM STM   @14,@12,@SA00002                                    0314
*    OLDERID2 = NEWERID2;                                          0315
         L     @06,@PC00001                                        0315
         L     @15,GDTTR2(,@06)                                    0315
         MVC   @TS00001(95),NEWERID2(@15)                          0315
         MVC   OLDERID2(95,@15),@TS00001                           0315
*    NEWID2 = 'ITCP';                                              0316
         MVC   NEWID2(4,@15),@CC00849                              0316
*/*  IF NOCHECK, ASSIGN AND 'ALLTRACKS' ARE SPECIFIED                */
*    IF (ADDR(NOCHK) ^= NULLPTR) & (ADDR(ASSGN) ^= NULLPTR) &      0317
*     (ADDR(ALLTK) ^= NULLPTR)                                     0317
*/*    THEN                                                          */
*      THEN DO;                                                    0317
*                                                                  0317
         SLR   @15,@15                                             0317
         L     @14,@PC00001+4                                      0317
         C     @15,FDTPTR+16(,@14)                                 0317
         BE    @RF00317                                            0317
         C     @15,FDTPTR+56(,@14)                                 0317
         BE    @RF00317                                            0317
         C     @15,FDTPTR+68(,@14)                                 0317
         BE    @RF00317                                            0317
*/*      ISSUE ERROR MESSAGE (MSGNCATA) (UPRINT)                     */
*        DARGSENT = MSGNCATA;                                      0319
         L     @01,DDSTRU                                          0319
         MVI   DARGSENT(@01),X'22'                                 0319
*        CALL ICKTPPR0 (GDTTBL                                     0320
*               ,PRTFILE                                           0320
*               ,DDSTRU);                                          0320
         ST    @06,@AL00001                                        0320
         LA    @15,@CF00094                                        0320
         ST    @15,@AL00001+4                                      0320
         LA    @15,DDSTRU                                          0320
         ST    @15,@AL00001+8                                      0320
         MVI   @AL00001+8,X'80'                                    0320
         L     @15,GDTPRT(,@06)                                    0320
         LA    @01,@AL00001                                        0320
         BALR  @14,@15                                             0320
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      0321
         L     @06,@PC00001+8                                      0321
         MVC   LASTCOND(2,@06),@CH00265                            0321
*/*      END-THEN                                                    */
*        END;                                                      0322
*/*  IF CHECK (N) AND 'ALLTRACKS' ARE SPECIFIED                      */
*    IF (ADDR(CHECK) ^= NULLPTR) & (ADDR(ALLTK) ^= NULLPTR)        0323
*/*    THEN                                                          */
*      THEN DO;                                                    0323
*                                                                  0323
@RF00317 SLR   @06,@06                                             0323
         L     @15,@PC00001+4                                      0323
         L     @14,FDTPTR+12(,@15)                                 0323
         CR    @14,@06                                             0323
         BE    @RF00323                                            0323
         C     @06,FDTPTR+68(,@15)                                 0323
         BE    @RF00323                                            0323
*/*      SET MAXIMUM NUMBER OF CYCLES AS REQUESTED OR TO LIMIT       */
*        CYCLES = MIN (CHECKVAL, CYCMAXAL);                        0325
         L     @06,CHECKVAL(,@14)                                  0325
         LA    @15,10                                              0325
         CR    @06,@15                                             0325
         BNH   *+6
         LR    @06,@15                                             0325
         ST    @06,CYCLES                                          0325
*/*      END-THEN                                                    */
*        END;                                                      0326
*/*    ELSE NOT ALLTRACKS, SO USE REQUESTED VALUE                    */
*      ELSE DO;    CYCLES = CHECKVAL; END;                         0327
         B     @RC00323                                            0327
@RF00323 DS    0H                                                  0328
         L     @06,@PC00001+4                                      0328
         L     @06,FDTPTR+12(,@06)                                 0328
         MVC   CYCLES(4),CHECKVAL(@06)                             0328
*/*  END-SUB-PROCEDURE CHECK_PARAMETERS                              */
*    END CHEKPARM;                                                 0330
*                                                                  0330
@EL00002 DS    0H                                                  0330
@EF00002 DS    0H                                                  0330
@ER00002 LM    @14,@12,@SA00002                                    0330
         BR    @14                                                 0330
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  OPENVOL                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE OPEN VOLUME                            */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUBPROCEDURE INVOKES THE DEVICE ADAPTER MODULE THAT      */
*/*    OPENS THE VOLUME FOR SUBSEQUENT PROCESSING. IT ALSO ENSURES   */
*/*    THAT THE VOLUME IS MOUNTED PRIVATE WHEN THE VOLUME IS ON-LINE.*/
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0331
*                                                                  0331
*/*  SUB-PROCEDURE ISSUE_OPEN_VOLUME                                 */
*    OPENVOL:                                                      0331
*      PROCEDURE;                                                  0331
OPENVOL  STM   @14,@12,@SA00003                                    0331
*    OLDERID2 = NEWERID2;                                          0332
         L     @06,@PC00001                                        0332
         L     @06,GDTTR2(,@06)                                    0332
         MVC   @TS00001(95),NEWERID2(@06)                          0332
         MVC   OLDERID2(95,@06),@TS00001                           0332
*    NEWID2 =  'ITOP';                                             0333
         MVC   NEWID2(4,@06),@CC00854                              0333
*/*  SET UP THE MSS PARAMETER AS A BLANK FIELD AS THIS COMMAND DOES  */
*/*   NOT SUPPORT MSS STAGING PACK                                   */
*    MSSDEV = ' ';                                                 0334
         MVI   MSSDEV+1,C' '                                       0334
         MVC   MSSDEV+2(6),MSSDEV+1                                0334
         MVI   MSSDEV,C' '                                         0334
*/*  SET UP THE CUU OR DD-NAME PARAMETER                             */
*    IF (ADDR(DEVIC) ^= NULLPTR) & (ADDR(DNAME) = NULLPTR)         0335
*      THEN DO;                                                    0335
*                                                                  0335
         SLR   @06,@06                                             0335
         L     @15,@PC00001+4                                      0335
         L     @14,FDTPTR(,@15)                                    0335
         CR    @14,@06                                             0335
         BE    @RF00335                                            0335
         C     @06,FDTPTR+64(,@15)                                 0335
         BNE   @RF00335                                            0335
*        VIBNAME = DEVICVAL;                                       0337
         MVI   VIBNAME+3,C' '                                      0337
         MVC   VIBNAME+4(4),VIBNAME+3                              0337
         MVC   VIBNAME(3),DEVICVAL(@14)                            0337
*        VIBTYPE = CUUVAL;                                         0338
         ST    @06,VIBTYPE                                         0338
*        END;                                                      0339
*      ELSE DO;                                                    0340
*                                                                  0340
         B     @RC00335                                            0340
@RF00335 DS    0H                                                  0341
*        VIBNAME = DNAMEVAL;                                       0341
         L     @06,@PC00001+4                                      0341
         L     @06,FDTPTR+64(,@06)                                 0341
         MVC   VIBNAME(8),DNAMEVAL(@06)                            0341
*        VIBTYPE = DDNVAL;                                         0342
         MVC   VIBTYPE(4),@CF00165                                 0342
*        END;                                                      0343
*/*  IF DEVICETYPE IS SUPPLIED                                       */
*    IF ADDR (DEVTY) ^= NULLPTR                                    0344
*/*    THEN PASS THE DEVICE TYPE                                     */
*      THEN DO;    DEVTYPE = DEVTYVAL; END;                        0344
@RC00335 L     @06,@PC00001+4                                      0344
         L     @06,FDTPTR+72(,@06)                                 0344
         LTR   @06,@06                                             0344
         BZ    @RF00344                                            0344
         MVC   DEVTYPE(8),DEVTYVAL(@06)                            0346
*/*    ELSE INDICATE NO DEVICE TYPE SUPPLIED                         */
*      ELSE DO;    DEVTYPE = ' '; END;                             0348
         B     @RC00344                                            0348
@RF00344 DS    0H                                                  0349
         MVI   DEVTYPE+1,C' '                                      0349
         MVC   DEVTYPE+2(6),DEVTYPE+1                              0349
         MVI   DEVTYPE,C' '                                        0349
*/*  OPEN THE VOLUME FOR PROCESSING (UDEVOPEN)                       */
*    CALL ICKDVON0 (GDTTBL                                         0351
*             ,VIBNAME                                             0351
*             ,VIBTYPE                                             0351
*             ,DEVTYPE                                             0351
*             ,MSSDEV                                              0351
*             ,VOLIB                                               0351
*             ,RETCODE);                                           0351
@RC00344 L     @06,@PC00001                                        0351
         ST    @06,@AL00001                                        0351
         LA    @15,VIBNAME                                         0351
         ST    @15,@AL00001+4                                      0351
         LA    @15,VIBTYPE                                         0351
         ST    @15,@AL00001+8                                      0351
         LA    @15,DEVTYPE                                         0351
         ST    @15,@AL00001+12                                     0351
         LA    @15,MSSDEV                                          0351
         ST    @15,@AL00001+16                                     0351
         LA    @15,VOLIB                                           0351
         ST    @15,@AL00001+20                                     0351
         LA    @15,RETCODE                                         0351
         ST    @15,@AL00001+24                                     0351
         L     @15,GDTDVO(,@06)                                    0351
         LA    @01,@AL00001                                        0351
         BALR  @14,@15                                             0351
*/*  IF CUU OR DD-NAME IS INVALID                                    */
*    IF RETCODE = INVALCUU                                         0352
*/*    THEN                                                          */
*      THEN DO;                                                    0352
*                                                                  0352
         CLC   RETCODE(4),@CF00165                                 0352
         BNE   @RF00352                                            0352
*/*      ISSUE ERROR MESSAGE (MSGINCUU) (UPRINT)                     */
*        DARGSENT = MSGINCUU;                                      0354
         L     @06,DDSTRU                                          0354
         MVI   DARGSENT(@06),X'18'                                 0354
*        CALL ICKTPPR0 (GDTTBL                                     0355
*               ,PRTFILE                                           0355
*               ,DDSTRU);                                          0355
         L     @06,@PC00001                                        0355
         ST    @06,@AL00001                                        0355
         LA    @15,@CF00094                                        0355
         ST    @15,@AL00001+4                                      0355
         LA    @15,DDSTRU                                          0355
         ST    @15,@AL00001+8                                      0355
         MVI   @AL00001+8,X'80'                                    0355
         L     @15,GDTPRT(,@06)                                    0355
         LA    @01,@AL00001                                        0355
         BALR  @14,@15                                             0355
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      0356
         L     @06,@PC00001+8                                      0356
         MVC   LASTCOND(2,@06),@CH00265                            0356
*/*      END-THEN                                                    */
*        END;                                                      0357
*/*  IF NO ERRORS FOUND SO FAR                                       */
*    IF LASTCOND < LASTCC12                                        0358
*/*    THEN                                                          */
*      THEN DO;                                                    0358
*                                                                  0358
@RF00352 L     @06,@PC00001+8                                      0358
         LH    @06,LASTCOND(,@06)                                  0358
         CH    @06,@CH00265                                        0358
         BNL   @RF00358                                            0358
*/*      IF UNABLE TO OPEN VOLUME                                    */
*        IF RETCODE = NOOPEN                                       0360
*/*        THEN                                                      */
*          THEN DO;                                                0360
*                                                                  0360
         CLC   RETCODE(4),@CF00116                                 0360
         BNE   @RF00360                                            0360
*/*          ISSUE ERROR MESSAGE (MSGNOPEN) (UPRINT)                 */
*            DARGSENT = MSGNOPEN;                                  0362
         L     @06,DDSTRU                                          0362
         MVI   DARGSENT(@06),X'19'                                 0362
*            CALL ICKTPPR0 (GDTTBL                                 0363
*                   ,PRTFILE                                       0363
*                   ,DDSTRU);                                      0363
         L     @06,@PC00001                                        0363
         ST    @06,@AL00001                                        0363
         LA    @15,@CF00094                                        0363
         ST    @15,@AL00001+4                                      0363
         LA    @15,DDSTRU                                          0363
         ST    @15,@AL00001+8                                      0363
         MVI   @AL00001+8,X'80'                                    0363
         L     @15,GDTPRT(,@06)                                    0363
         LA    @01,@AL00001                                        0363
         BALR  @14,@15                                             0363
*/*          INDICATE SEVERE ERROR (LASTCOND = 12)                   */
*            LASTCOND = LASTCC12;                                  0364
         L     @06,@PC00001+8                                      0364
         MVC   LASTCOND(2,@06),@CH00265                            0364
*/*          END-THEN                                                */
*            END;                                                  0365
*/*      END-THEN                                                    */
*        END;                                                      0366
@RF00360 DS    0H                                                  0367
*/*  IF NO ERRORS FOUND SO FAR                                       */
*    IF LASTCOND < LASTCC12                                        0367
*/*    THEN                                                          */
*      THEN DO;                                                    0367
*                                                                  0367
@RF00358 L     @06,@PC00001+8                                      0367
         LH    @06,LASTCOND(,@06)                                  0367
         CH    @06,@CH00265                                        0367
         BNL   @RF00367                                            0367
*/*      IF CUU WAS SPECIFIED FOR AN ON-LINE VOLUME                  */
*        IF RETCODE = RCCUUONL                                     0369
*/*        THEN                                                      */
*          THEN DO;                                                0369
*                                                                  0369
         CLC   RETCODE(4),@CF00136                                 0369
         BNE   @RF00369                                            0369
*/*          ISSUE AN ERROR MESSAGE (MSGLINE)                        */
*            DARGSENT = MSGLINE;                                   0371
         L     @06,DDSTRU                                          0371
         MVI   DARGSENT(@06),X'31'                                 0371
*            CALL ICKTPPR0 (GDTTBL                                 0372
*                   ,PRTFILE                                       0372
*                   ,DDSTRU);                                      0372
         L     @06,@PC00001                                        0372
         ST    @06,@AL00001                                        0372
         LA    @15,@CF00094                                        0372
         ST    @15,@AL00001+4                                      0372
         LA    @15,DDSTRU                                          0372
         ST    @15,@AL00001+8                                      0372
         MVI   @AL00001+8,X'80'                                    0372
         L     @15,GDTPRT(,@06)                                    0372
         LA    @01,@AL00001                                        0372
         BALR  @14,@15                                             0372
*/*          INDICATE A SEVERE ERROR                                 */
*            LASTCOND = LASTCC12;                                  0373
         L     @06,@PC00001+8                                      0373
         MVC   LASTCOND(2,@06),@CH00265                            0373
*/*          END-THEN                                                */
*            END;                                                  0374
*/*      END-THEN                                                    */
*        END;                                                      0375
@RF00369 DS    0H                                                  0376
*/*  IF NO ERRORS FOUND SO FAR                                       */
*    IF LASTCOND < LASTCC12                                        0376
*/*    THEN                                                          */
*      THEN DO;                                                    0376
*                                                                  0376
@RF00367 L     @06,@PC00001+8                                      0376
         LH    @06,LASTCOND(,@06)                                  0376
         CH    @06,@CH00265                                        0376
         BNL   @RF00376                                            0376
*/*      IF SUCCESSFUL IN OPENING THE VOLUME                         */
*        IF RETCODE = SUCCESS                                      0378
*/*        THEN                                                      */
*          THEN DO;                                                0378
*                                                                  0378
         L     @06,RETCODE                                         0378
         LTR   @06,@06                                             0378
         BNZ   @RF00378                                            0378
*/*          OBTAIN INFORMATION ABOUT TYPE OF MOUNTING (UDEVINFO)    */
*            CALL ICKDVIN0 (GDTTBL                                 0380
*                     ,VOLIB                                       0380
*                     ,VOLPRVOL                                    0380
*                     ,POOLID                                      0380
*                     ,VIBPTR                                      0380
*                     ,VIBLEN                                      0380
*                     ,RETCODE);                                   0380
         L     @06,@PC00001                                        0380
         ST    @06,@AL00001                                        0380
         LA    @15,VOLIB                                           0380
         ST    @15,@AL00001+4                                      0380
         LA    @15,@CF00161                                        0380
         ST    @15,@AL00001+8                                      0380
         LA    @15,POOLID                                          0380
         ST    @15,@AL00001+12                                     0380
         LA    @15,VIBPTR                                          0380
         ST    @15,@AL00001+16                                     0380
         LA    @15,VIBLEN                                          0380
         ST    @15,@AL00001+20                                     0380
         LA    @15,RETCODE                                         0380
         ST    @15,@AL00001+24                                     0380
         L     @15,GDTDIN(,@06)                                    0380
         LA    @01,@AL00001                                        0380
         BALR  @14,@15                                             0380
*/*          IF THE VOLUME IS NOT MOUNTED PRIVATE AND DD-NAME        */
*/*           IS SPECIFIED                                           */
*            IF VIBPFLAG = OFF & VIBTYPE = DDNVAL                  0381
*/*            THEN                                                  */
*              THEN DO;                                            0381
*                                                                  0381
         L     @06,VIBPTR                                          0381
         TM    VIBPFLAG(@06),B'10000000'                           0381
         BNZ   @RF00381                                            0381
         CLC   VIBTYPE(4),@CF00165                                 0381
         BNE   @RF00381                                            0381
*/*              ISSUE ERROR MESSAGE (MSGNPRIV) (UPRINT)             */
*                DARGSENT = MSGNPRIV;                              0383
         L     @06,DDSTRU                                          0383
         MVI   DARGSENT(@06),X'1A'                                 0383
*                CALL ICKTPPR0 (GDTTBL                             0384
*                       ,PRTFILE                                   0384
*                       ,DDSTRU);                                  0384
         L     @06,@PC00001                                        0384
         ST    @06,@AL00001                                        0384
         LA    @15,@CF00094                                        0384
         ST    @15,@AL00001+4                                      0384
         LA    @15,DDSTRU                                          0384
         ST    @15,@AL00001+8                                      0384
         MVI   @AL00001+8,X'80'                                    0384
         L     @15,GDTPRT(,@06)                                    0384
         LA    @01,@AL00001                                        0384
         BALR  @14,@15                                             0384
*/*              INDICATE SEVERE ERROR (LASTCOND = 12)               */
*                LASTCOND = LASTCC12;                              0385
         L     @06,@PC00001+8                                      0385
         MVC   LASTCOND(2,@06),@CH00265                            0385
*/*              END-THEN                                            */
*                END;                                              0386
*/*          END-THEN (OPEN WAS SUCCESSFUL)                          */
*            END;                                                  0387
*/*      END-THEN                                                    */
*        END;                                                      0388
*/*  END-SUB-PROCEDURE ISSUE_OPEN_VOLUME                             */
*    END OPENVOL;                                                  0389
@EL00003 DS    0H                                                  0389
@EF00003 DS    0H                                                  0389
@ER00003 LM    @14,@12,@SA00003                                    0389
         BR    @14                                                 0389
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  SETTRACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  SET NUMBER OF TRACKS                         */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE OBTAINS THE PERTINENT INFORMATION ABOUT    */
*/*    THE VOLUME AND DETERMINES THE ADDRESSES AND VALIDITY OF THE   */
*/*    TRACKS THAT ARE TO BE PROCESSED FOR THIS INVOCATION OF THE    */
*/*    INSPECT COMMAND.                                              */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0390
*                                                                  0390
*/*  SUB-PROCEDURE SET_NUMBER_OF_TRACKS                              */
*    SETTRACK:                                                     0390
*      PROCEDURE;                                                  0390
*                                                                  0390
SETTRACK STM   @14,@12,@SA00004                                    0390
*    DECLARE                                                       0391
*      I1                             FIXED(31),                   0391
*      I5                             FIXED(31);                   0391
*                                                                  0391
*    OLDERID2 = NEWERID2;                                          0392
         L     @06,@PC00001                                        0392
         L     @06,GDTTR2(,@06)                                    0392
         MVC   @TS00001(95),NEWERID2(@06)                          0392
         MVC   OLDERID2(95,@06),@TS00001                           0392
*    NEWID2 = 'ITST';                                              0393
         MVC   NEWID2(4,@06),@CC00860                              0393
*/*  OBTAIN THE FOLLOWING INFORMATION FROM THE DIT (UDEVINFO):       */
*/*   1. THRESHOLD                                                   */
*/*   2. NUMBER OF TRACKS PER CYLINDER                               */
*/*   3. TOTAL NUMBER OF PRIMARY TRACKS                              */
*/*   4. TOTAL NUMBER OF ALTERNATE TRACKS                            */
*/*   5. ADDRESS OF THE FIRST ALTERNATE TRACK                        */
*/*   6. ADDRESS OF THE LAST ALTERNATE TRACK                         */
*/*   7. ADDRESS OF THE LAST PRIMARY TRACK                           */
*/*   8. MAXIMUM NUMBER OF POSSIBLE RECORDS ON A TRACK               */
*    DO I1 = 1 TO INFOSET;                                         0394
*                                                                  0394
         LA    I1,1                                                0394
@DL00394 DS    0H                                                  0395
*      CALL ICKDVIN0 (GDTTBL                                       0395
*               ,VOLIB                                             0395
*               ,INFOVECT (I1)                                     0395
*               ,POOLID                                            0395
*               ,INFOPTR (I1)                                      0395
*               ,INFOLEN (I1)                                      0395
*               ,CONDCODE (I1));                                   0395
         L     @06,@PC00001                                        0395
         ST    @06,@AL00001                                        0395
         LA    @02,VOLIB                                           0395
         ST    @02,@AL00001+4                                      0395
         LR    @02,I1                                              0395
         SLA   @02,2                                               0395
         LA    @02,INFOVECT-4(@02)                                 0395
         ST    @02,@AL00001+8                                      0395
         LA    @02,POOLID                                          0395
         ST    @02,@AL00001+12                                     0395
         LR    @02,I1                                              0395
         MH    @02,@CH00265                                        0395
         LA    @15,INFOPTR-12(@02)                                 0395
         ST    @15,@AL00001+16                                     0395
         LA    @15,INFOLEN-12(@02)                                 0395
         ST    @15,@AL00001+20                                     0395
         LA    @02,CONDCODE-12(@02)                                0395
         ST    @02,@AL00001+24                                     0395
         L     @15,GDTDIN(,@06)                                    0395
         LA    @01,@AL00001                                        0395
         BALR  @14,@15                                             0395
*    END;                                                          0396
         AL    I1,@CF00165                                         0396
         CH    I1,@CH00161                                         0396
         BNH   @DL00394                                            0396
*/*  READ_VOLUME_LABEL (FOR THE VTOC LOCATION)                       */
*    CALL ICKRL01                                                  0397
*         (GDTTBL                                                  0397
*         ,VOLIB                                                   0397
*         ,VOL1P                                                   0397
*         ,LABELS                                                  0397
*         ,RETCODE);                                               0397
         L     @06,@PC00001                                        0397
         ST    @06,@AL00001                                        0397
         LA    @06,VOLIB                                           0397
         ST    @06,@AL00001+4                                      0397
         LA    @06,VOL1P                                           0397
         ST    @06,@AL00001+8                                      0397
         LA    @06,LABELS                                          0397
         ST    @06,@AL00001+12                                     0397
         LA    @06,RETCODE                                         0397
         ST    @06,@AL00001+16                                     0397
         L     @15,@CV00861                                        0397
         LA    @01,@AL00001                                        0397
         BALR  @14,@15                                             0397
*    RESPECIFY VOL1 BASED (ADDR (VOL1P));                          0398
*/*  IF UNABLE TO READ THE VOLUME LABEL                              */
*    IF RETCODE = NORVOLL                                          0399
*/*    THEN                                                          */
*      THEN DO;                                                    0399
*                                                                  0399
         CLC   RETCODE(4),@CF00165                                 0399
         BNE   @RF00399                                            0399
*/*      ISSUE ERROR MESSAGE (MSGURVOL) (UPRINT)                     */
*        DARGSENT = MSGURVOL;                                      0401
         L     @06,DDSTRU                                          0401
         MVI   DARGSENT(@06),X'10'                                 0401
*        CALL ICKTPPR0 (GDTTBL                                     0402
*               ,PRTFILE                                           0402
*               ,DDSTRU);                                          0402
         L     @06,@PC00001                                        0402
         ST    @06,@AL00001                                        0402
         LA    @15,@CF00094                                        0402
         ST    @15,@AL00001+4                                      0402
         LA    @15,DDSTRU                                          0402
         ST    @15,@AL00001+8                                      0402
         MVI   @AL00001+8,X'80'                                    0402
         L     @15,GDTPRT(,@06)                                    0402
         LA    @01,@AL00001                                        0402
         BALR  @14,@15                                             0402
*/*      INDICATE A SEVERE ERROR (LASTCOND = 12)                     */
*        LASTCOND = LASTCC12;                                      0403
         L     @06,@PC00001+8                                      0403
         MVC   LASTCOND(2,@06),@CH00265                            0403
*/*      END-THEN                                                    */
*        END;                                                      0404
*/*    ELSE SAVE THE VTOC LOCATION                                   */
*      ELSE DO;    VTOCLOC = VOL1VTOC (1:4); END;                  0405
         B     @RC00399                                            0405
@RF00399 DS    0H                                                  0406
         LA    @06,VOL1P                                           0406
         MVC   VTOCLOC(4),VOL1VTOC(@06)                            0406
*/*  IF NO SEVERE ERRORS ENCOUNTERED (LASTCOND < 12)                 */
*    IF LASTCOND < LASTCC12                                        0408
*/*    THEN                                                          */
*      THEN DO;                                                    0408
*                                                                  0408
@RC00399 L     @06,@PC00001+8                                      0408
         LH    @06,LASTCOND(,@06)                                  0408
         CH    @06,@CH00265                                        0408
         BNL   @RF00408                                            0408
*/*      READ FORMAT4 DSCB (FOR VTOC EXTENT, TALCNT, TALPTR)         */
*        RECNUM = 1;                                               0410
         MVC   RECNUM(4),@CF00165                                  0410
*        CALL ICKDVOP0 (GDTTBL                                     0411
*               ,VOLIB                                             0411
*               ,ACTRDN                                            0411
*               ,VTOCLOC                                           0411
*               ,RECNUM                                            0411
*               ,POOLID                                            0411
*               ,DATAPTR                                           0411
*               ,DATALEN                                           0411
*               ,RETCODE);                                         0411
         L     @06,@PC00001                                        0411
         ST    @06,@AL00001                                        0411
         LA    @15,VOLIB                                           0411
         ST    @15,@AL00001+4                                      0411
         LA    @15,@CF00265                                        0411
         ST    @15,@AL00001+8                                      0411
         LA    @15,VTOCLOC                                         0411
         ST    @15,@AL00001+12                                     0411
         LA    @15,RECNUM                                          0411
         ST    @15,@AL00001+16                                     0411
         LA    @15,POOLID                                          0411
         ST    @15,@AL00001+20                                     0411
         LA    @15,DATAPTR                                         0411
         ST    @15,@AL00001+24                                     0411
         LA    @15,DATALEN                                         0411
         ST    @15,@AL00001+28                                     0411
         LA    @15,RETCODE                                         0411
         ST    @15,@AL00001+32                                     0411
         L     @15,GDTDOP(,@06)                                    0411
         LA    @01,@AL00001                                        0411
         BALR  @14,@15                                             0411
*        F4PTR = DATAPTR;                                          0412
         MVC   F4PTR(4),DATAPTR                                    0412
*/*      IF READ OPERATION FAILS                                     */
*        IF RETCODE = CPFAILS  RETCODE = NORECFND                 0413
*/*        THEN                                                      */
*          THEN DO;                                                0413
*                                                                  0413
         L     @06,RETCODE                                         0413
         CH    @06,@CH00044                                        0413
         BE    @RT00413                                            0413
         CH    @06,@CH00165                                        0413
         BNE   @RF00413                                            0413
@RT00413 DS    0H                                                  0414
*/*          ISSUE ERROR MESSAGE (MSGRDSCB) (UPRINT)                 */
*            DARGSENT = MSGRDSCB;                                  0415
         L     @06,DDSTRU                                          0415
         MVI   DARGSENT(@06),X'23'                                 0415
*            DARGCNT = 2;                                          0416
         LA    @15,2                                               0416
         STH   @15,DARGCNT(,@06)                                   0416
*            DARGINS (1) = 1;                                      0417
         MVC   DARGINS(2,@06),@CH00165                             0417
*            DARGINL (1) = LENGTH (VTOCLOCC);                      0418
         STH   @15,DARGINL(,@06)                                   0418
*            DARGDTM (1) = ADDR (VTOCLOCC);                        0419
         LA    @14,VTOCLOCC                                        0419
         ST    @14,DARGDTM(,@06)                                   0419
*            DARGINS (2) = 2;                                      0420
         STH   @15,DARGINS+8(,@06)                                 0420
*            DARGINL (2) = LENGTH (VTOCLOCT);                      0421
         STH   @15,DARGINL+8(,@06)                                 0421
*            DARGDTM (2) = ADDR (VTOCLOCT);                        0422
         LA    @15,VTOCLOCT                                        0422
         ST    @15,DARGDTM+8(,@06)                                 0422
*            CALL ICKTPPR0 (GDTTBL                                 0423
*                   ,PRTFILE                                       0423
*                   ,DDSTRU);                                      0423
         L     @06,@PC00001                                        0423
         ST    @06,@AL00001                                        0423
         LA    @15,@CF00094                                        0423
         ST    @15,@AL00001+4                                      0423
         LA    @15,DDSTRU                                          0423
         ST    @15,@AL00001+8                                      0423
         MVI   @AL00001+8,X'80'                                    0423
         L     @15,GDTPRT(,@06)                                    0423
         LA    @01,@AL00001                                        0423
         BALR  @14,@15                                             0423
*/*          INDICATE A SEVERE ERROR (LASTCOND = 12)                 */
*            LASTCOND = LASTCC12;                                  0424
         L     @06,@PC00001+8                                      0424
         MVC   LASTCOND(2,@06),@CH00265                            0424
*/*          END-THEN                                                */
*            END;                                                  0425
*/*        ELSE                                                      */
*          ELSE DO;                                                0426
*                                                                  0426
         B     @RC00413                                            0426
@RF00413 DS    0H                                                  0427
*/*          SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS           */
*            TALCNT = DS4NOATK;                                    0427
         L     @06,F4PTR                                           0427
         MVC   @ZT00002+2(2),DS4NOATK(@06)                         0427
         L     @15,@ZT00002                                        0427
         ST    @15,TALCNT                                          0427
*/*          SAVE THE ADDRESS OF THE NEXT AVAILABLE ALTERNATE TRACK  */
*            TALPTR = DS4HCCHH;                                    0428
         MVC   TALPTR(4),DS4HCCHH(@06)                             0428
*/*          COMPUTE THE VTOC EXTENT                                 */
*            LOWRTA = (VTLOEXC * TRKSPCYL) + VTLOEXT;              0429
         L     @01,INFOPTR+12                                      0429
         L     @14,TRKSPCYL(,@01)                                  0429
         MVC   @ZT00002+2(2),VTLOEXC(@06)                          0429
         L     @01,@ZT00002                                        0429
         MR    @00,@14                                             0429
         MVC   @ZT00002+2(2),VTLOEXT(@06)                          0429
         AL    @01,@ZT00002                                        0429
         LR    LOWRTA,@01                                          0429
*            HIGHRTA = (VTHIEXC * TRKSPCYL) + VTHIEXT;             0430
         LR    @01,@14                                             0430
         MVC   @ZT00002+2(2),VTHIEXC(@06)                          0430
         M     @00,@ZT00002                                        0430
         MVC   @ZT00002+2(2),VTHIEXT(@06)                          0430
         AL    @01,@ZT00002                                        0430
         LR    HIGHRTA,@01                                         0430
*            VTOCEXT = (HIGHRTA - LOWRTA) + 1;                     0431
         LR    @06,HIGHRTA                                         0431
         SLR   @06,LOWRTA                                          0431
         AL    @06,@CF00165                                        0431
         ST    @06,VTOCEXT                                         0431
*/*          CHECK VALIDITY OF THE POINTER TO NEXT AVAILABLE         */
*/*           ALTERNATE TRACK (TALPTR) AND THE NUMBER OF AVAILABLE   */
*/*           ALTERNATE TRACKS (TALCNT)                              */
*            IF (TALPTRC >= FIRSTALC & TALPTRT >= FIRSTALT &       0432
*             TALPTRC <= FINALTC & TALPTRT <= FINALTT) &           0432
*             (TALCNT <= TOTALALT & TALCNT >= 0)                   0432
*              THEN DO;    END;                                    0432
         L     @06,INFOPTR+48                                      0432
         CLC   TALPTRC(2),FIRSTALC(@06)                            0432
         BL    @RF00432                                            0432
         CLC   TALPTRT(2),FIRSTALT(@06)                            0432
         BL    @RF00432                                            0432
         L     @06,INFOPTR+60                                      0432
         CLC   TALPTRC(2),FINALTC(@06)                             0432
         BH    @RF00432                                            0432
         CLC   TALPTRT(2),FINALTT(@06)                             0432
         BH    @RF00432                                            0432
         L     @06,INFOPTR+36                                      0432
         C     @15,TOTALALT(,@06)                                  0432
         BH    @RF00432                                            0432
         LTR   @15,@15                                             0432
         BM    @RF00432                                            0432
*              ELSE DO;                                            0435
         B     @RC00432                                            0435
@RF00432 DS    0H                                                  0436
*/*              DETERMINE WHETHER MERELY NO MORE ALTERNATES LEFT    */
*                IF TALCNT = 0  &  TALPTR = 0                      0436
*                  THEN DO;   /* NO MORE ALTERNATES                  */
         SLR   @06,@06                                             0436
         C     @06,TALCNT                                          0436
         BNE   @RF00436                                            0436
         CL    @06,TALPTR                                          0436
         BNE   @RF00436                                            0436
*                    DARGSENT = MSGALTB;                           0438
         L     @06,DDSTRU                                          0438
         MVI   DARGSENT(@06),X'12'                                 0438
*                    LASTCOND = MAX(LASTCOND, LASTCC08);           0439
         L     @06,@PC00001+8                                      0439
         LH    @15,LASTCOND(,@06)                                  0439
         LA    @14,8                                               0439
         CR    @15,@14                                             0439
         BNL   *+6
         LR    @15,@14                                             0439
         STH   @15,LASTCOND(,@06)                                  0439
*                    CALL ICKTPPR0 (GDTTBL                         0440
*                           ,PRTFILE                               0440
*                           ,DDSTRU);                              0440
         L     @06,@PC00001                                        0440
         ST    @06,@AL00001                                        0440
         LA    @15,@CF00094                                        0440
         ST    @15,@AL00001+4                                      0440
         LA    @15,DDSTRU                                          0440
         ST    @15,@AL00001+8                                      0440
         MVI   @AL00001+8,X'80'                                    0440
         L     @15,GDTPRT(,@06)                                    0440
         LA    @01,@AL00001                                        0440
         BALR  @14,@15                                             0440
*                    END;                                          0441
*                DARGSENT = MSGALTIP;                              0442
@RF00436 L     @06,DDSTRU                                          0442
         MVI   DARGSENT(@06),X'14'                                 0442
*                LASTCOND = LASTCC12;                              0443
         L     @06,@PC00001+8                                      0443
         MVC   LASTCOND(2,@06),@CH00265                            0443
*                CALL ICKTPPR0 (GDTTBL                             0444
*                       ,PRTFILE                                   0444
*                       ,DDSTRU);                                  0444
         L     @06,@PC00001                                        0444
         ST    @06,@AL00001                                        0444
         LA    @15,@CF00094                                        0444
         ST    @15,@AL00001+4                                      0444
         LA    @15,DDSTRU                                          0444
         ST    @15,@AL00001+8                                      0444
         MVI   @AL00001+8,X'80'                                    0444
         L     @15,GDTPRT(,@06)                                    0444
         LA    @01,@AL00001                                        0444
         BALR  @14,@15                                             0444
*                END;                                              0445
*/*          END-ELSE                                                */
*            END;                                                  0446
@RC00432 DS    0H                                                  0447
*/*      END-THEN                                                    */
*        END;                                                      0447
@RC00413 DS    0H                                                  0448
*/*  IF NO SEVERE ERRORS ENCOUNTERED (LASTCOND <12)                  */
*    IF LASTCOND < LASTCC12                                        0448
*/*    THEN                                                          */
*      THEN DO;                                                    0448
*                                                                  0448
@RF00408 L     @06,@PC00001+8                                      0448
         LH    @06,LASTCOND(,@06)                                  0448
         CH    @06,@CH00265                                        0448
         BNL   @RF00448                                            0448
*/*      IF ALLTRACKS IS SPECIFIED                                   */
*        IF ADDR (ALLTK) ^= NULLPTR                                0450
*/*        THEN                                                      */
*          THEN DO;                                                0450
*                                                                  0450
         L     @06,@PC00001+4                                      0450
         L     @06,FDTPTR+68(,@06)                                 0450
         LTR   @06,@06                                             0450
         BZ    @RF00450                                            0450
*/*          SET NUMBER OF TRACKS = TOTAL TRACKS ON PACK             */
*            TRKNUMB = TOTALPRI + TOTALALT;                        0452
         L     @06,INFOPTR+24                                      0452
         L     @01,INFOPTR+36                                      0452
         L     @06,TOTALPRI(,@06)                                  0452
         AL    @06,TOTALALT(,@01)                                  0452
         ST    @06,TRKNUMB                                         0452
*/*          SET FLAG TO INDICATE THAT ALL THE TRACKS ARE TO BE      */
*/*           INSPECTED                                              */
*            TRKFLAG = ALLTRKS;                                    0453
         OI    TRKFLAG,B'10000000'                                 0453
*/*          END-THEN                                                */
*            END;                                                  0454
*/*        ELSE (DISCRETE TRACKS ARE SPECIFIED)                      */
*          ELSE DO;                                                0455
*                                                                  0455
         B     @RC00450                                            0455
@RF00450 DS    0H                                                  0456
*/*          SET FLAG TO INDICATE DISCRETE NUMBER OF TRACKS          */
*/*           WERE SPECIFIED                                         */
*            TRKFLAG = DISCRETE;                                   0456
         NI    TRKFLAG,B'01111111'                                 0456
*/*          SET UP A RUNNING COUNT OF TRACKS TO BE PROCESSED        */
*            TRKCOUNT = TRACKCNT;                                  0457
         L     @06,@PC00001+4                                      0457
         L     @06,FDTPTR+52(,@06)                                 0457
         LH    TRKCOUNT,TRACKCNT(,@06)                             0457
*/*          INITIALIZE INDEX FOR VECTOR OF TRACK ADDRESSES TO BE    */
*/*           PROCESSED                                              */
*            J = 0;                                                0458
         SLR   J,J                                                 0458
*/*          DO-FOR THE NUMBER OF TRACKS SPECIFIED                   */
*            DO I1 = 1 TO TRACKCNT;                                0459
*                                                                  0459
         LA    I1,1                                                0459
         B     @DE00459                                            0459
@DL00459 DS    0H                                                  0460
*/*            INCREMENT INDEX FOR VECTOR OF TRACKS TO BE BUILT FOR  */
*/*             PROCESSING                                           */
*              J = J + 1;                                          0460
         AL    J,@CF00165                                          0460
*/*            CONVERT THE TRACK ADDRESS TO BINARY (CCHH)            */
*              CALL DCVTPROC (TRACKVAL (I1)                        0461
*                            ,TRKVECT (J)                          0461
*                            ,TRKLEGL);                            0461
         LR    @06,I1                                              0461
         MH    @06,@CH00246                                        0461
         L     @05,@PC00001+4                                      0461
         L     @05,FDTPTR+52(,@05)                                 0461
         AL    @05,@CF01067                                        0461
         LA    @06,TRACKVAL-3(@06,@05)                             0461
         ST    @06,@AL00001                                        0461
         LR    @06,J                                               0461
         SLA   @06,2                                               0461
         LA    @06,TRKVECT-4(@06)                                  0461
         ST    @06,@AL00001+4                                      0461
         LA    @06,TRKLEGL                                         0461
         ST    @06,@AL00001+8                                      0461
         LA    @01,@AL00001                                        0461
         BAL   @14,DCVTPROC                                        0461
*/*            IF TRACK ADDRESS IS LEGAL                             */
*              IF TRKLEGL = LEGAL                                  0462
*/*              THEN                                                */
*                THEN DO;                                          0462
*                                                                  0462
         TM    TRKLEGL,B'10000000'                                 0462
         BNO   @RF00462                                            0462
*/*                IF TRACK ADDRESS IS BEYOND LAST TRACK OF PACK     */
*                  IF (TRKVECTC (J) > FINALTC)                    0464
*                     (TRKVECTC(J)<=FINPRIC & TRKVECTT(J)>FINPRIT) 
*                     (TRKVECTC(J)>=FIRSTALC & TRKVECTT(J)>FINALTT)
*/*                  THEN                                            */
*                    THEN DO;                                      0464
*                                                                  0464
         LR    @06,J                                               0464
         SLA   @06,2                                               0464
         L     @05,INFOPTR+60                                      0464
         LA    @01,TRKVECTC-4(@06)                                 0464
         CLC   0(2,@01),FINALTC(@05)                               0464
         BH    @RT00464                                            0464
         L     @05,INFOPTR+72                                      0464
         LA    @01,TRKVECTC-4(@06)                                 0464
         CLC   0(2,@01),FINPRIC(@05)                               0464
         BH    @GL00014                                            0464
         LA    @01,TRKVECTT-4(@06)                                 0464
         CLC   0(2,@01),FINPRIT(@05)                               0464
         BH    @RT00464                                            0464
@GL00014 LR    @06,J                                               0464
         SLA   @06,2                                               0464
         L     @05,INFOPTR+48                                      0464
         LA    @01,TRKVECTC-4(@06)                                 0464
         CLC   0(2,@01),FIRSTALC(@05)                              0464
         BL    @RF00464                                            0464
         L     @05,INFOPTR+60                                      0464
         LA    @01,TRKVECTT-4(@06)                                 0464
         CLC   0(2,@01),FINALTT(@05)                               0464
         BNH   @RF00464                                            0464
@RT00464 DS    0H                                                  0465
*/*                    ISSUE ERROR MESSAGE (MSGILLTR) (UPRINT)       */
*                      DARGSENT = MSGILLTR;                        0466
         L     @06,DDSTRU                                          0466
         MVI   DARGSENT(@06),X'25'                                 0466
*                      DARGCNT = 1;                                0467
         LA    @05,1                                               0467
         STH   @05,DARGCNT(,@06)                                   0467
*                      DARGINS (1) = 1;                            0468
         STH   @05,DARGINS(,@06)                                   0468
*                      DARGINL (1) = LENGTH (TRACKVAL (I1));       0469
         MVC   DARGINL(2,@06),@CH00260                             0469
*                      DARGDTM (1) = ADDR (TRACKVAL (I1));         0470
         LR    @05,I1                                              0470
         MH    @05,@CH00246                                        0470
         L     @15,@PC00001+4                                      0470
         L     @01,FDTPTR+52(,@15)                                 0470
         AL    @01,@CF01067                                        0470
         LA    @05,TRACKVAL-3(@05,@01)                             0470
         ST    @05,DARGDTM(,@06)                                   0470
*                      CALL ICKTPPR0 (GDTTBL                       0471
*                             ,PRTFILE                             0471
*                             ,DDSTRU);                            0471
         L     @06,@PC00001                                        0471
         ST    @06,@AL00001                                        0471
         LA    @05,@CF00094                                        0471
         ST    @05,@AL00001+4                                      0471
         LA    @05,DDSTRU                                          0471
         ST    @05,@AL00001+8                                      0471
         MVI   @AL00001+8,X'80'                                    0471
         L     @15,GDTPRT(,@06)                                    0471
         LA    @01,@AL00001                                        0471
         BALR  @14,@15                                             0471
*/*                    INDICATE ERROR (LASTCOND = 8)                 */
*                      LASTCOND = MAX(LASTCC08,LASTCOND);          0472
         L     @06,@PC00001+8                                      0472
         LH    @05,LASTCOND(,@06)                                  0472
         LA    @15,8                                               0472
         CR    @05,@15                                             0472
         BNL   *+6
         LR    @05,@15                                             0472
         STH   @05,LASTCOND(,@06)                                  0472
*/*                    REDUCE TRACK-COUNT AND VECTOR-INDEX           */
*                      TRKCOUNT = TRKCOUNT - 1;                    0473
         BCTR  TRKCOUNT,0                                          0473
*                      J = J - 1;                                  0474
         BCTR  J,0                                                 0474
*/*                    END-THEN                                      */
*                      END;                                        0475
*/*                IF TRACK ADDRESS IS REPEATED                      */
*/*                  THEN ELIMINATE FROM VECTOR OF TRACKS            */
*                  DO I5 = 1 TO (J - 1);                           0476
@RF00464 LA    I5,1                                                0476
         B     @DE00476                                            0476
@DL00476 DS    0H                                                  0477
*                    IF TRKVECT (J) = TRKVECT (I5)                 0477
*                      THEN DO;                                    0477
         LR    @06,J                                               0477
         SLA   @06,2                                               0477
         LR    @15,I5                                              0477
         SLA   @15,2                                               0477
         L     @06,TRKVECT-4(@06)                                  0477
         CL    @06,TRKVECT-4(@15)                                  0477
         BNE   @RF00477                                            0477
*                        TRKCOUNT = TRKCOUNT - 1;                  0479
         BCTR  TRKCOUNT,0                                          0479
*                        J = J - 1;                                0480
         BCTR  J,0                                                 0480
*                        END;                                      0481
*                  END;                                            0482
@RF00477 AL    I5,@CF00165                                         0482
@DE00476 LR    @06,J                                               0482
         BCTR  @06,0                                               0482
         CR    I5,@06                                              0482
         BNH   @DL00476                                            0482
*/*                END-THEN (TRACK ADDRESS IS LEGAL)                 */
*                  END;                                            0483
*/*              ELSE (TRACK ADDRESS IS ILLEGAL)                     */
*                ELSE DO;                                          0484
*                                                                  0484
         B     @RC00462                                            0484
@RF00462 DS    0H                                                  0485
*/*                ISSUE ERROR MESSAGE (MSGILLTR) (UPRINT)           */
*                  DARGSENT = MSGILLTR;                            0485
         L     @06,DDSTRU                                          0485
         MVI   DARGSENT(@06),X'25'                                 0485
*                  DARGCNT = 1;                                    0486
         LA    @05,1                                               0486
         STH   @05,DARGCNT(,@06)                                   0486
*                  DARGINS (1) = 1;                                0487
         STH   @05,DARGINS(,@06)                                   0487
*                  DARGINL (1) = LENGTH (TRACKVAL (I1));           0488
         MVC   DARGINL(2,@06),@CH00260                             0488
*                  DARGDTM (1) = ADDR (TRACKVAL (I1));             0489
         LR    @05,I1                                              0489
         MH    @05,@CH00246                                        0489
         L     @15,@PC00001+4                                      0489
         L     @01,FDTPTR+52(,@15)                                 0489
         AL    @01,@CF01067                                        0489
         LA    @05,TRACKVAL-3(@05,@01)                             0489
         ST    @05,DARGDTM(,@06)                                   0489
*                  CALL ICKTPPR0 (GDTTBL                           0490
*                         ,PRTFILE                                 0490
*                         ,DDSTRU);                                0490
         L     @06,@PC00001                                        0490
         ST    @06,@AL00001                                        0490
         LA    @05,@CF00094                                        0490
         ST    @05,@AL00001+4                                      0490
         LA    @05,DDSTRU                                          0490
         ST    @05,@AL00001+8                                      0490
         MVI   @AL00001+8,X'80'                                    0490
         L     @15,GDTPRT(,@06)                                    0490
         LA    @01,@AL00001                                        0490
         BALR  @14,@15                                             0490
*/*                INDICATE ERROR (LASTCOND = 8)                     */
*                  LASTCOND = MAX(LASTCC08,LASTCOND);              0491
         L     @06,@PC00001+8                                      0491
         LH    @05,LASTCOND(,@06)                                  0491
         LA    @15,8                                               0491
         CR    @05,@15                                             0491
         BNL   *+6
         LR    @05,@15                                             0491
         STH   @05,LASTCOND(,@06)                                  0491
*/*                REDUCE TRACK-COUNT AND VECTOR-INDEX               */
*                  TRKCOUNT = TRKCOUNT - 1;                        0492
         BCTR  TRKCOUNT,0                                          0492
*                  J = J - 1;                                      0493
         BCTR  J,0                                                 0493
*/*                END-ELSE                                          */
*                  END;                                            0494
*/*          END-FOR                                                 */
*            END;                                                  0495
@RC00462 AL    I1,@CF00165                                         0495
@DE00459 L     @06,@PC00001+4                                      0495
         L     @06,FDTPTR+52(,@06)                                 0495
         CH    I1,TRACKCNT(,@06)                                   0495
         BNH   @DL00459                                            0495
*/*          IF NO SEVERE ERRORS ENCOUNTERED                         */
*            IF LASTCOND < LASTCC12                                0496
*/*            THEN                                                  */
*              THEN DO;                                            0496
*                                                                  0496
         L     @06,@PC00001+8                                      0496
         LH    @06,LASTCOND(,@06)                                  0496
         CH    @06,@CH00265                                        0496
         BNL   @RF00496                                            0496
*/*              IF RUNNING COUNT OF TRACKS TO BE PROCESSED IS ZERO  */
*                IF TRKCOUNT = 0                                   0498
*/*                THEN                                              */
*                  THEN DO;                                        0498
*                                                                  0498
         LTR   TRKCOUNT,TRKCOUNT                                   0498
         BNZ   @RF00498                                            0498
*/*                  ISSUE MESSAGE (MSGNOTRK) (UPRINT)               */
*                    DARGSENT = MSGNOTRK;                          0500
         L     @06,DDSTRU                                          0500
         MVI   DARGSENT(@06),X'26'                                 0500
*                    CALL ICKTPPR0 (GDTTBL                         0501
*                           ,PRTFILE                               0501
*                           ,DDSTRU);                              0501
         L     @06,@PC00001                                        0501
         ST    @06,@AL00001                                        0501
         LA    @05,@CF00094                                        0501
         ST    @05,@AL00001+4                                      0501
         LA    @05,DDSTRU                                          0501
         ST    @05,@AL00001+8                                      0501
         MVI   @AL00001+8,X'80'                                    0501
         L     @15,GDTPRT(,@06)                                    0501
         LA    @01,@AL00001                                        0501
         BALR  @14,@15                                             0501
*/*                  INDICATE A SEVERE ERROR (LASTCOND = 12)         */
*                    LASTCOND = LASTCC12;                          0502
         L     @06,@PC00001+8                                      0502
         MVC   LASTCOND(2,@06),@CH00265                            0502
*/*                  END-THEN                                        */
*                    END;                                          0503
*/*              SET NUMBER OF TRACKS TO BE PROCESSED = RUNNING      */
*/*               COUNT OF TRACKS                                    */
*                TRKNUMB = TRKCOUNT;                               0504
@RF00498 ST    TRKCOUNT,TRKNUMB                                    0504
*/*              END-THEN                                            */
*                END;                                              0505
*/*          END-ELSE (DISCRETE NUMBER OF TRACKS SPECIFIED)          */
*            END;                                                  0506
*/*      END-THEN                                                    */
*        END;                                                      0507
*/*  END-SUB-PROCEDURE SET_NUMBER_OF_TRACKS                          */
*    END SETTRACK;                                                 0508
*                                                                  0508
@EL00004 DS    0H                                                  0508
@EF00004 DS    0H                                                  0508
@ER00004 LM    @14,@12,@SA00004                                    0508
         BR    @14                                                 0508
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  INSTRACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  INSPECT THE TRACKS                           */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL INSPECT THE SET OF TRACKS THAT ARE    */
*/*    TO BE PROCESSED AS PER USER SPECIFICATIONS. EACH TRACK IS     */
*/*    HANDLED SEPARATELY AND THE NECESSARY 'REPAIR' ACTION IS       */
*/*    PERFORMED ON IT.                                              */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0509
*                                                                  0509
*/*  SUB-PROCEDURE INSPECT_THE_TRACKS                                */
*    INSTRACK:                                                     0509
*      PROCEDURE;                                                  0509
*                                                                  0509
INSTRACK STM   @14,@12,@SA00005                                    0509
*    DECLARE                                                       0510
*      I2                         FIXED(31);                       0510
*                                                                  0510
*    OLDERID2 = NEWERID2;                                          0511
         L     @06,@PC00001                                        0511
         L     @15,GDTTR2(,@06)                                    0511
         MVC   @TS00001(95),NEWERID2(@15)                          0511
         MVC   OLDERID2(95,@15),@TS00001                           0511
*    NEWID2 = 'ITIN';                                              0512
*                                                                  0512
         MVC   NEWID2(4,@15),@CC00869                              0512
*/*  IF THERE ARE NO AVAILABLE ALTERNATE TRACKS                      */
*    IF ALTCOUNT <= 0                                              0513
*/*    THEN (ASSIGNMENT NOT POSSIBLE)                                */
*      THEN DO;                                                    0513
         L     @15,ALTCOUNT                                        0513
         LTR   @15,@15                                             0513
         BP    @RF00513                                            0513
*/*      INDICATE ASSIGNMENT NOT POSSIBLE                            */
*        ALTFLAG = MORENO;                                         0515
         OI    ALTFLAG,B'10000000'                                 0515
*/*      ISSUE ERROR MESSAGE                                         */
*        DARGSENT = MSGALTB;                                       0516
         L     @01,DDSTRU                                          0516
         MVI   DARGSENT(@01),X'12'                                 0516
*        CALL ICKTPPR0 (GDTTBL                                     0517
*               ,PRTFILE                                           0517
*               ,DDSTRU);                                          0517
         ST    @06,@AL00001                                        0517
         LA    @15,@CF00094                                        0517
         ST    @15,@AL00001+4                                      0517
         LA    @15,DDSTRU                                          0517
         ST    @15,@AL00001+8                                      0517
         MVI   @AL00001+8,X'80'                                    0517
         L     @15,GDTPRT(,@06)                                    0517
         LA    @01,@AL00001                                        0517
         BALR  @14,@15                                             0517
*/*      INDICATE AN ERROR                                           */
*        LASTCOND = MAX (LASTCOND,LASTCC08);                       0518
         L     @06,@PC00001+8                                      0518
         LH    @15,LASTCOND(,@06)                                  0518
         LA    @14,8                                               0518
         CR    @15,@14                                             0518
         BNL   *+6
         LR    @15,@14                                             0518
         STH   @15,LASTCOND(,@06)                                  0518
*/*      END-THEN                                                    */
*        END;                                                      0519
*/*    ELSE INDICATE ASSIGNMENT POSSIBLE                             */
*      ELSE DO;    ALTFLAG = MOREYES; END;                         0520
         B     @RC00513                                            0520
@RF00513 DS    0H                                                  0521
         NI    ALTFLAG,B'01111111'                                 0521
*/*  INDICATE INITIALLY THAT SPACE HAS NOT BEEN OBTAINED FOR RECORD  */
*/*   TABLE                                                          */
*    SPACEFLG = SPACENO;                                           0523
@RC00513 NI    SPACEFLG,B'01111111'                                0523
*/*  IF ALLTRACKS WAS SPECIFIED                                      */
*    IF ADDR(ALLTK) ^= NULLPTR                                     0524
*/*    THEN SET UP THE CURRENT TRACK ADDRESS AS THE FIRST TRACK      */
*/*     ON THE PACK                                                  */
*      THEN DO;    CTRADDR = 0; END;                               0524
         SLR   @06,@06                                             0524
         L     @15,@PC00001+4                                      0524
         C     @06,FDTPTR+68(,@15)                                 0524
         BE    @RF00524                                            0524
         ST    @06,CTRADDR                                         0526
*/*    ELSE SET UP THE CURRENT TRACK ADDRESS AS THE FIRST            */
*/*     OF THE VECTOR OF TRACK ADDRESSES ALREADY SET UP              */
*      ELSE DO;    CTRADDR = TRKVECT(1); END;                      0528
         B     @RC00524                                            0528
@RF00524 DS    0H                                                  0529
         MVC   CTRADDR(4),TRKVECT                                  0529
*/*  DO-FOR ALL THE TRACKS TO BE PROCESSED                           */
*    DO I2 = 1 TO TRKNUMB;                                         0531
*                                                                  0531
@RC00524 LA    I2,1                                                0531
         B     @DE00531                                            0531
@DL00531 DS    0H                                                  0532
*/*    IF THIS IS NOT THE FIRST TRACK IN THE LOOP                    */
*      IF I2 > 1                                                   0532
*/*      THEN                                                        */
*        THEN DO;                                                  0532
*                                                                  0532
         LA    @06,1                                               0532
         CR    I2,@06                                              0532
         BNH   @RF00532                                            0532
*/*        IF ALLTRACKS WAS SPECIFIED                                */
*          IF ADDR(ALLTK) ^= NULLPTR                               0534
*/*          THEN INCREMENT TRACK ADDRESS                            */
*            THEN DO;                                              0534
*                                                                  0534
         SLR   @03,@03                                             0534
         L     @15,@PC00001+4                                      0534
         C     @03,FDTPTR+68(,@15)                                 0534
         BE    @RF00534                                            0534
*              IF CTRADDRT = TRKSPCYL - 1                          0536
*                THEN DO;                                          0536
*                                                                  0536
         L     @01,INFOPTR+12                                      0536
         L     @15,TRKSPCYL(,@01)                                  0536
         BCTR  @15,0                                               0536
         MVC   @ZT00002+2(2),CTRADDRT                              0536
         C     @15,@ZT00002                                        0536
         BNE   @RF00536                                            0536
*                  CTRADDRC = CTRADDRC + 1;                        0538
         MVC   @ZT00002+2(2),CTRADDRC                              0538
         AL    @06,@ZT00002                                        0538
         STH   @06,CTRADDRC                                        0538
*                  CTRADDRT = 0;                                   0539
         STH   @03,CTRADDRT                                        0539
*                  END;                                            0540
*                ELSE DO;    CTRADDRT = CTRADDRT + 1; END;         0541
         B     @RC00536                                            0541
@RF00536 DS    0H                                                  0542
         MVC   @ZT00002+2(2),CTRADDRT                              0542
         L     @06,@ZT00002                                        0542
         LA    @06,1(,@06)                                         0542
         STH   @06,CTRADDRT                                        0542
*              END;                                                0544
*/*          ELSE OBTAIN NEXT TRACK ADDRESS FROM VECTOR              */
*            ELSE DO;    CTRADDR = TRKVECT (I2); END;              0545
         B     @RC00534                                            0545
@RF00534 DS    0H                                                  0546
         LR    @06,I2                                              0546
         SLA   @06,2                                               0546
         L     @06,TRKVECT-4(@06)                                  0546
         ST    @06,CTRADDR                                         0546
*/*        END-THEN                                                  */
*          END;                                                    0548
*                                                                  0548
*                                                                  0548
@RC00534 DS    0H                                                  0549
*/*    IF TRACK IS A PRIMARY TRACK                                   */
*      IF CTRADDR <= FINPRI                                        0549
*/*      THEN SET FLAG TO INDICATE A PRIMARY TRACK                   */
*        THEN DO;    TRACKTYP = PRITRACK; END;                     0549
@RF00532 L     @06,INFOPTR+72                                      0549
         CLC   CTRADDR(4),FINPRI(@06)                              0549
         BH    @RF00549                                            0549
         OI    TRACKTYP,B'10000000'                                0551
*/*      ELSE SET FLAG TO INDICATE AN ALTERNATE TRACK                */
*        ELSE DO;    TRACKTYP = ALTTRACK; END;                     0553
         B     @RC00549                                            0553
@RF00549 DS    0H                                                  0554
         NI    TRACKTYP,B'01111111'                                0554
*/*    INDICATE INITIALLY THAT THE TRACK IS RECOVERABLE              */
*      RCVRFLAG = RECOVER;                                         0556
@RC00549 OI    RCVRFLAG,B'10000000'                                0556
*/*    INDICATE INITIALLY THAT PROCESSING TO CONTINUE ON THIS TRACK  */
*      CNTFLAG = CONTINUE;                                         0557
         OI    CNTFLAG,B'10000000'                                 0557
*/*    INDICATE INITIALLY THE TRACK CONTENTS NOT READ                */
*      TRKREAD = READNO;                                           0558
         NI    TRKREAD,B'01111111'                                 0558
*/*    OBTAIN_TRACK_STATUS                                           */
*      CALL OBTTRST (CTRADDR                                       0559
*                   ,DFLAGC                                        0559
*                   ,RZCCHH                                        0559
*                   ,TRACKTYP);                                    0559
         LA    @06,CTRADDR                                         0559
         ST    @06,@AL00001                                        0559
         LA    @06,DFLAGC                                          0559
         ST    @06,@AL00001+4                                      0559
         LA    @06,RZCCHH                                          0559
         ST    @06,@AL00001+8                                      0559
         LA    @06,TRACKTYP                                        0559
         ST    @06,@AL00001+12                                     0559
         LA    @01,@AL00001                                        0559
         BAL   @14,OBTTRST                                         0559
*/*    IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE            */
*      IF (LASTCOND < 12) & (RCVRFLAG = RECOVER)                   0560
*       & (CNTFLAG = CONTINUE)                                     0560
*/*      THEN                                                        */
*        THEN DO;                                                  0560
*                                                                  0560
         L     @06,@PC00001+8                                      0560
         LH    @06,LASTCOND(,@06)                                  0560
         CH    @06,@CH00265                                        0560
         BNL   @RF00560                                            0560
         TM    RCVRFLAG,B'10000000'                                0560
         BNO   @RF00560                                            0560
         TM    CNTFLAG,B'10000000'                                 0560
         BNO   @RF00560                                            0560
*/*        INDICATE INITIALLY TRACK IS NOT ASSOCIATED                */
*          ASSOCFLG = ASSOCNO;                                     0562
         NI    ASSOCFLG,B'01111111'                                0562
*/*        CHECK_ASSOCIATION                                         */
*          CALL CHASSOC;                                           0563
         BAL   @14,CHASSOC                                         0563
*/*        END-THEN                                                  */
*          END;                                                    0564
*/*    IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE            */
*      IF (LASTCOND < 12) & (RCVRFLAG = RECOVER)                   0565
*       & (CNTFLAG = CONTINUE)                                     0565
*/*      THEN                                                        */
*        THEN DO;                                                  0565
*                                                                  0565
@RF00560 L     @06,@PC00001+8                                      0565
         LH    @06,LASTCOND(,@06)                                  0565
         CH    @06,@CH00265                                        0565
         BNL   @RF00565                                            0565
         TM    RCVRFLAG,B'10000000'                                0565
         BNO   @RF00565                                            0565
         TM    CNTFLAG,B'10000000'                                 0565
         BNO   @RF00565                                            0565
*/*        IF PRESERVE IS SPECIFIED AND CHECK OR ASSIGN IS SPECIFIED */
*          IF ADDR(PRESV) ^= NULLPTR &                             0567
*           ^ (ADDR(CHECK) = NULLPTR & ADDR(ASSGN) = NULLPTR)      0567
*/*          THEN                                                    */
*            THEN DO;                                              0567
*                                                                  0567
         SLR   @06,@06                                             0567
         L     @03,@PC00001+4                                      0567
         C     @06,FDTPTR+4(,@03)                                  0567
         BE    @RF00567                                            0567
         C     @06,FDTPTR+12(,@03)                                 0567
         BNE   @RT00567                                            0567
         C     @06,FDTPTR+56(,@03)                                 0567
         BE    @RF00567                                            0567
@RT00567 DS    0H                                                  0568
*/*            IF DEFECTIVE PRIMARY TRACK THAT IS ASSOCIATED         */
*/*             OR A NONDEFECTIVE PRIMARY THAT IS NOT ASSOCIATED     */
*              IF TRACKTYP = PRITRACK &                            0569
*               ((DFLAGC = DEFECTIV & ASSOCFLG = ASSOCYES)        0569
*               (DFLAGC = NODEFECT & ASSOCFLG = ASSOCNO))          0569
*/*              THEN                                                */
*                THEN DO;                                          0569
         TM    TRACKTYP,B'10000000'                                0569
         BNO   @RF00569                                            0569
         TM    DFLAGC,B'10000000'                                  0569
         BNO   @GL00025                                            0569
         TM    ASSOCFLG,B'10000000'                                0569
         BO    @RT00569                                            0569
@GL00025 TM    DFLAGC,B'10000000'                                  0569
         BNZ   @RF00569                                            0569
         TM    ASSOCFLG,B'10000000'                                0569
         BNZ   @RF00569                                            0569
@RT00569 DS    0H                                                  0570
*/*                READ_TRACK_CONTENTS                               */
*                  CALL REATRACK                                   0571
*                       (CTRADDR                                   0571
*                       ,DFLAGC                                    0571
*                       ,TRKREAD);                                 0571
         LA    @06,CTRADDR                                         0571
         ST    @06,@AL00001                                        0571
         LA    @06,DFLAGC                                          0571
         ST    @06,@AL00001+4                                      0571
         LA    @06,TRKREAD                                         0571
         ST    @06,@AL00001+8                                      0571
         LA    @01,@AL00001                                        0571
         BAL   @14,REATRACK                                        0571
*/*                END-THEN                                          */
*                  END;                                            0572
*/*            IF NON-DEFECTIVE ALTERNATE TRACK THAT IS ASSOCIATED   */
*              IF TRACKTYP = ALTTRACK & DFLAGC = NODEFECT          0573
*               & ASSOCFLG = ASSOCYES                              0573
*/*              THEN                                                */
*                THEN DO;                                          0573
@RF00569 TM    TRACKTYP,B'10000000'                                0573
         BNZ   @RF00573                                            0573
         TM    DFLAGC,B'10000000'                                  0573
         BNZ   @RF00573                                            0573
         TM    ASSOCFLG,B'10000000'                                0573
         BNO   @RF00573                                            0573
*                  CALL REATRACK                                   0575
*                       (RZCCHH                                    0575
*                       ,DFLAGC                                    0575
*                       ,TRKREAD);                                 0575
         LA    @06,RZCCHH                                          0575
         ST    @06,@AL00001                                        0575
         LA    @06,DFLAGC                                          0575
         ST    @06,@AL00001+4                                      0575
         LA    @06,TRKREAD                                         0575
         ST    @06,@AL00001+8                                      0575
         LA    @01,@AL00001                                        0575
         BAL   @14,REATRACK                                        0575
*/*                END-THEN                                          */
*                  END;                                            0576
*/*            END-THEN                                              */
*              END;                                                0577
@RF00573 DS    0H                                                  0578
*/*        END-THEN                                                  */
*          END;                                                    0578
@RF00567 DS    0H                                                  0579
*/*    IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE            */
*      IF (LASTCOND < 12) & (RCVRFLAG = RECOVER)                   0579
*       & (CNTFLAG = CONTINUE)                                     0579
*/*      THEN                                                        */
*        THEN DO;                                                  0579
*                                                                  0579
@RF00565 L     @06,@PC00001+8                                      0579
         LH    @06,LASTCOND(,@06)                                  0579
         CH    @06,@CH00265                                        0579
         BNL   @RF00579                                            0579
         TM    RCVRFLAG,B'10000000'                                0579
         BNO   @RF00579                                            0579
         TM    CNTFLAG,B'10000000'                                 0579
         BNO   @RF00579                                            0579
*/*        IF CHECK (N) IS SPECIFIED                                 */
*          IF ADDR(CHECK) ^= NULLPTR                               0581
*/*          THEN                                                    */
*            THEN DO;                                              0581
*                                                                  0581
         L     @06,@PC00001+4                                      0581
         L     @06,FDTPTR+12(,@06)                                 0581
         LTR   @06,@06                                             0581
         BZ    @RF00581                                            0581
*/*            VALIDATE_HOME-ADDRESS                                 */
*              CALL VALHOME;                                       0583
         BAL   @14,VALHOME                                         0583
*/*            IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE    */
*              IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)     0584
*               & (CNTFLAG = CONTINUE)                             0584
*/*              THEN                                                */
*                THEN DO;                                          0584
*                                                                  0584
         L     @06,@PC00001+8                                      0584
         LH    @06,LASTCOND(,@06)                                  0584
         CH    @06,@CH00265                                        0584
         BNL   @RF00584                                            0584
         TM    RCVRFLAG,B'10000000'                                0584
         BNO   @RF00584                                            0584
         TM    CNTFLAG,B'10000000'                                 0584
         BNO   @RF00584                                            0584
*/*                ISSUE_CHECK_TRACK_SURFACE                         */
*                  CALL CHEKTRAK;                                  0586
         BAL   @14,CHEKTRAK                                        0586
*/*                END-THEN                                          */
*                  END;                                            0587
*/*            IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE    */
*              IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)     0588
*               & (CNTFLAG = CONTINUE)                             0588
*/*              THEN                                                */
*                THEN DO;                                          0588
*                                                                  0588
@RF00584 L     @06,@PC00001+8                                      0588
         LH    @06,LASTCOND(,@06)                                  0588
         CH    @06,@CH00265                                        0588
         BNL   @RF00588                                            0588
         TM    RCVRFLAG,B'10000000'                                0588
         BNO   @RF00588                                            0588
         TM    CNTFLAG,B'10000000'                                 0588
         BNO   @RF00588                                            0588
*/*                IF TRACK CHECKS OUT NON-DEFECTIVE                 */
*                  IF TRSTATUS = TSCGOOD                           0590
*/*                  THEN                                            */
*                    THEN DO;                                      0590
*                                                                  0590
         TM    TRSTATUS,B'10000000'                                0590
         BNO   @RF00590                                            0590
*/*                    IF DEFECT-FLAG IS FOUND TO BE SET             */
*                      IF DFLAGC = DEFECTIV                        0592
*/*                      THEN                                        */
*                        THEN DO;                                  0592
*                                                                  0592
         TM    DFLAGC,B'10000000'                                  0592
         BNO   @RF00592                                            0592
*/*                        IF RECLAIM IS SPECIFIED                   */
*                          IF ADDR(RECLA) ^= NULLPTR               0594
*/*                          THEN                                    */
*                            THEN DO;                              0594
*                                                                  0594
         L     @06,@PC00001+4                                      0594
         L     @06,FDTPTR+20(,@06)                                 0594
         LTR   @06,@06                                             0594
         BZ    @RF00594                                            0594
*/*                            IF TRACK IS AN ALTERNATE              */
*                              IF TRACKTYP = ALTTRACK              0596
*/*                              THEN ISSUE_RECLAIM_ALTERNATE_TRACK  */
*                                THEN DO;                          0596
*                                                                  0596
         TM    TRACKTYP,B'10000000'                                0596
         BNZ   @RF00596                                            0596
*                                  CALL RECATRAK;                  0598
         BAL   @14,RECATRAK                                        0598
*                                  END;                            0599
*/*                              ELSE ISSUE_RECLAIM_PRIMARY_TRACK    */
*                                ELSE DO;                          0600
*                                                                  0600
         B     @RC00596                                            0600
@RF00596 DS    0H                                                  0601
*                                  CALL RECPTRAK;                  0601
         BAL   @14,RECPTRAK                                        0601
*                                  END;                            0602
*/*                            END-THEN (RECLAIM IS SPECIFIED)       */
*                              END;                                0603
*/*                          ELSE (NORECLAIM IS SPECIFIED)           */
*                            ELSE DO;                              0604
*                                                                  0604
         B     @RC00594                                            0604
@RF00594 DS    0H                                                  0605
*/*                            ISSUE_BUILD_PACK_MAP (FLAGGED         */
*/*                             DEFECTIVE)                           */
*                              PACKDEF = DEFECTIV;                 0605
         OI    PACKDEF,B'10000000'                                 0605
*                              PACKCHEK = NODEFECT;                0606
         NI    PACKCHEK,B'01111111'                                0606
*                              PACKRCVR = RCVRYES;                 0607
         NI    PACKRCVR,B'01111111'                                0607
*                              IF TRACKTYP = ALTTRACK              0608
*                                THEN DO;                          0608
*                                                                  0608
         TM    TRACKTYP,B'10000000'                                0608
         BNZ   @RF00608                                            0608
*                                  PACKTRK = ALTTRACK;             0610
         NI    PACKTRK,B'01111111'                                 0610
*                                  END;                            0611
*                                ELSE DO;                          0612
*                                                                  0612
         B     @RC00608                                            0612
@RF00608 DS    0H                                                  0613
*                                  PACKTRK = PRITRACK;             0613
         OI    PACKTRK,B'10000000'                                 0613
*                                  END;                            0614
*                              PACKTRAK = CTRADDR;                 0615
@RC00608 MVC   PACKTRAK(4),CTRADDR                                 0615
*                              PACKASC = RZCCHH;                   0616
         MVC   PACKASC(4),RZCCHH                                   0616
*                              CALL BILDPACK;                      0617
         BAL   @14,BILDPACK                                        0617
*/*                            IF ASSIGN IS SPECIFIED                */
*/*                             AND ALTERNATE TRACKS AVAILABLE       */
*/*                             AND UNASSOCIATED PRIMARY TRACK       */
*                              IF ADDR(ASSGN) ^= NULLPTR &         0618
*                               ALTFLAG = MOREYES &                0618
*                               TRACKTYP = PRITRACK &              0618
*                               ASSOCFLG = ASSOCNO                 0618
*/*                              THEN (ASSIGNMENT ACCOMPLISHED)      */
*                                THEN DO;                          0618
*                                                                  0618
         L     @06,@PC00001+4                                      0618
         L     @06,FDTPTR+56(,@06)                                 0618
         LTR   @06,@06                                             0618
         BZ    @RF00618                                            0618
         TM    ALTFLAG,B'10000000'                                 0618
         BNZ   @RF00618                                            0618
         TM    TRACKTYP,B'10000000'                                0618
         BNO   @RF00618                                            0618
         TM    ASSOCFLG,B'10000000'                                0618
         BNZ   @RF00618                                            0618
*/*                                ISSUE_ASSIGN_ALTERNATE_TRACK      */
*                                  CALL ASSGNALT;                  0620
         BAL   @14,ASSGNALT                                        0620
*/*                                END-THEN (ASSIGN SPECIFIED)       */
*                                  END;                            0621
*/*                              ELSE (ASSIGNMENT NOT COMPLETE)      */
*                                ELSE DO;                          0622
         B     @RC00618                                            0622
@RF00618 DS    0H                                                  0623
*/*                                IF UN-ASSOCIATED PRIMARY TRACK    */
*                                  IF TRACKTYP = PRITRACK &        0623
*                                   ASSOCFLG = ASSOCNO             0623
*/*                                  THEN                            */
*                                    THEN DO;                      0623
         TM    TRACKTYP,B'10000000'                                0623
         BNO   @RF00623                                            0623
         TM    ASSOCFLG,B'10000000'                                0623
         BNZ   @RF00623                                            0623
*/*                                    ISSUE_DESCRIPTOR_MESSAGE      */
*                                      CALL DESCMESS;              0625
         BAL   @14,DESCMESS                                        0625
*/*                                    END-THEN                      */
*                                      END;                        0626
*/*                                IF TRACK CONTENTS WERE READ       */
*                                  IF TRKREAD = READYES            0627
*/*                                  THEN WRITE_TRACK_CONTENTS       */
*                                    THEN DO;                      0627
*                                                                  0627
@RF00623 TM    TRKREAD,B'10000000'                                 0627
         BNO   @RF00627                                            0627
*/*                                    IF ASSOCIATED ALTERNATE       */
*                                      IF TRACKTYP = ALTTRACK &    0629
*                                       ASSOCFLG = ASSOCYES        0629
*/*                                      THEN                        */
*                                        THEN DO;                  0629
         TM    TRACKTYP,B'10000000'                                0629
         BNZ   @RF00629                                            0629
         TM    ASSOCFLG,B'10000000'                                0629
         BNO   @RF00629                                            0629
*                                          CALL WRITRACK           0631
*                                               (RZCCHH);          0631
         LA    @06,RZCCHH                                          0631
         ST    @06,@AL00001                                        0631
         LA    @01,@AL00001                                        0631
         BAL   @14,WRITRACK                                        0631
*                                          END;                    0632
*                                        ELSE DO;                  0633
         B     @RC00629                                            0633
@RF00629 DS    0H                                                  0634
*                                          CALL WRITRACK           0634
*                                               (CTRADDR);         0634
         LA    @06,CTRADDR                                         0634
         ST    @06,@AL00001                                        0634
         LA    @01,@AL00001                                        0634
         BAL   @14,WRITRACK                                        0634
*                                          END;                    0635
*/*                                    END-THEN                      */
*                                      END;                        0636
*/*                                END-ELSE                          */
*                                  END;                            0637
*/*                            END-ELSE (NORECLAIM SPECIFIED)        */
*                              END;                                0638
*/*                        END-THEN (DEFECT-FLAG IS FOUND TO BE SET) */
*                          END;                                    0639
*/*                      ELSE (DEFECT-FLAG FOUND NOT TO BE SET)      */
*                        ELSE DO;                                  0640
*                                                                  0640
         B     @RC00592                                            0640
@RF00592 DS    0H                                                  0641
*/*                        IF PRIMARY TRACK WITH INVALID R0          */
*                          IF TRACKTYP = PRITRACK &                0641
*                           CTRADDR ^= RZCCHH                      0641
*/*                          THEN ISSUE_DESCRIPTOR_MESSAGE           */
*                            THEN DO;                              0641
         TM    TRACKTYP,B'10000000'                                0641
         BNO   @RF00641                                            0641
         CLC   CTRADDR(4),RZCCHH                                   0641
         BE    @RF00641                                            0641
*                              RZACCHHX = 'FFFFFFFF'X;             0643
         MVC   RZACCHHX(4),@CB00881                                0643
*                              CALL DESCMESS;                      0644
         BAL   @14,DESCMESS                                        0644
*                              END;                                0645
*/*                        IF TRACK CONTENTS WERE READ               */
*                          IF TRKREAD = READYES                    0646
*/*                          THEN WRITE_TRACK_CONTENTS               */
*                            THEN DO;                              0646
*                                                                  0646
@RF00641 TM    TRKREAD,B'10000000'                                 0646
         BNO   @RF00646                                            0646
*/*                            IF AN ASSOCIATED ALTERNATE TRACK      */
*                              IF TRACKTYP = ALTTRACK &            0648
*                               ASSOCFLG = ASSOCYES                0648
*/*                              THEN                                */
*                                THEN DO;                          0648
         TM    TRACKTYP,B'10000000'                                0648
         BNZ   @RF00648                                            0648
         TM    ASSOCFLG,B'10000000'                                0648
         BNO   @RF00648                                            0648
*                                  CALL WRITRACK                   0650
*                                       (RZCCHH);                  0650
         LA    @06,RZCCHH                                          0650
         ST    @06,@AL00001                                        0650
         LA    @01,@AL00001                                        0650
         BAL   @14,WRITRACK                                        0650
*                                  END;                            0651
*                                ELSE DO;                          0652
         B     @RC00648                                            0652
@RF00648 DS    0H                                                  0653
*                                  CALL WRITRACK                   0653
*                                       (CTRADDR);                 0653
         LA    @06,CTRADDR                                         0653
         ST    @06,@AL00001                                        0653
         LA    @01,@AL00001                                        0653
         BAL   @14,WRITRACK                                        0653
*                                  END;                            0654
*/*                            END-THEN                              */
*                              END;                                0655
*/*                        END-ELSE                                  */
*                          END;                                    0656
*/*                    END-THEN (TRACK CHECKS OUT NON-DEFECTIVE)     */
*                      END;                                        0657
*/*                  ELSE (TRACK CHECKS OUT DEFECTIVE)               */
*                    ELSE DO;                                      0658
*                                                                  0658
         B     @RC00590                                            0658
@RF00590 DS    0H                                                  0659
*/*                    IF DEFECT-FLAG IS FOUND TO BE SET             */
*                      IF DFLAGC = DEFECTIV                        0659
*/*                      THEN                                        */
*                        THEN DO;                                  0659
*                                                                  0659
         TM    DFLAGC,B'10000000'                                  0659
         BNO   @RF00659                                            0659
*/*                        ISSUE_BUILD_PACK_MAP (FLAGGED DEFECTIVE)  */
*                          PACKDEF = DEFECTIV;                     0661
         OI    PACKDEF,B'10000000'                                 0661
*                          PACKCHEK = NODEFECT;                    0662
         NI    PACKCHEK,B'01111111'                                0662
*                          PACKRCVR = RCVRYES;                     0663
         NI    PACKRCVR,B'01111111'                                0663
*                          PACKTRAK = CTRADDR;                     0664
         MVC   PACKTRAK(4),CTRADDR                                 0664
*                          PACKASC = RZCCHH;                       0665
         MVC   PACKASC(4),RZCCHH                                   0665
*                          IF TRACKTYP = ALTTRACK                  0666
*                            THEN DO;                              0666
*                                                                  0666
         TM    TRACKTYP,B'10000000'                                0666
         BNZ   @RF00666                                            0666
*                              PACKTRK = ALTTRACK;                 0668
         NI    PACKTRK,B'01111111'                                 0668
*                              END;                                0669
*                            ELSE DO;                              0670
*                                                                  0670
         B     @RC00666                                            0670
@RF00666 DS    0H                                                  0671
*                              PACKTRK = PRITRACK;                 0671
         OI    PACKTRK,B'10000000'                                 0671
*                              END;                                0672
*                          CALL BILDPACK;                          0673
@RC00666 BAL   @14,BILDPACK                                        0673
*/*                        ISSUE_BUILD_PACK_MAP (FOUND DEFECTIVE)    */
*                          PACKDEF = NODEFECT;                     0674
         NI    PACKDEF,B'01111111'                                 0674
*                          PACKCHEK = DEFECTIV;                    0675
         OI    PACKCHEK,B'10000000'                                0675
*                          CALL BILDPACK;                          0676
         BAL   @14,BILDPACK                                        0676
*/*                        IF ASSIGN IS SPECIFIED                    */
*/*                         AND ALTERNATES ARE AVAILABLE             */
*                          IF ADDR(ASSGN) ^= NULLPTR &             0677
*                           ALTFLAG = MOREYES &                    0677
*                           TRACKTYP = PRITRACK &                  0677
*                           ASSOCFLG = ASSOCNO                     0677
*/*                          THEN (ASSIGNMENT ACCOMPLISHED)          */
*                            THEN DO;                              0677
*                                                                  0677
         L     @06,@PC00001+4                                      0677
         L     @06,FDTPTR+56(,@06)                                 0677
         LTR   @06,@06                                             0677
         BZ    @RF00677                                            0677
         TM    ALTFLAG,B'10000000'                                 0677
         BNZ   @RF00677                                            0677
         TM    TRACKTYP,B'10000000'                                0677
         BNO   @RF00677                                            0677
         TM    ASSOCFLG,B'10000000'                                0677
         BNZ   @RF00677                                            0677
*/*                            ISSUE_ASSIGN_ALTERNATE_TRACK          */
*                              CALL ASSGNALT;                      0679
         BAL   @14,ASSGNALT                                        0679
*/*                            END-THEN (ASSIGN SPECIFIED)           */
*                              END;                                0680
*/*                          ELSE (ASSIGNMENT NOT COMPLETE)          */
*                            ELSE DO;                              0681
         B     @RC00677                                            0681
@RF00677 DS    0H                                                  0682
*/*                            IF UN-ASSOCIATED PRIMARY TRACK        */
*                              IF TRACKTYP = PRITRACK &            0682
*                               ASSOCFLG = ASSOCNO                 0682
*/*                              THEN                                */
*                                THEN DO;                          0682
         TM    TRACKTYP,B'10000000'                                0682
         BNO   @RF00682                                            0682
         TM    ASSOCFLG,B'10000000'                                0682
         BNZ   @RF00682                                            0682
*/*                                ISSUE_DESCRIPTOR_MESSAGE          */
*                                  CALL DESCMESS;                  0684
         BAL   @14,DESCMESS                                        0684
*/*                                END-THEN                          */
*                                  END;                            0685
*/*                            IF TRACK CONTENTS WERE READ           */
*                              IF TRKREAD = READYES                0686
*/*                              THEN WRITE_TRACK_CONTENTS           */
*                                THEN DO;                          0686
*                                                                  0686
@RF00682 TM    TRKREAD,B'10000000'                                 0686
         BNO   @RF00686                                            0686
*/*                                IF AN ASSOCIATED ALTERNATE TRACK  */
*                                  IF TRACKTYP = ALTTRACK &        0688
*                                   ASSOCFLG = ASSOCYES            0688
*/*                                  THEN                            */
*                                    THEN DO;                      0688
         TM    TRACKTYP,B'10000000'                                0688
         BNZ   @RF00688                                            0688
         TM    ASSOCFLG,B'10000000'                                0688
         BNO   @RF00688                                            0688
*                                      CALL WRITRACK               0690
*                                           (RZCCHH);              0690
         LA    @06,RZCCHH                                          0690
         ST    @06,@AL00001                                        0690
         LA    @01,@AL00001                                        0690
         BAL   @14,WRITRACK                                        0690
*                                      END;                        0691
*                                    ELSE DO;                      0692
         B     @RC00688                                            0692
@RF00688 DS    0H                                                  0693
*                                      CALL WRITRACK               0693
*                                           (CTRADDR);             0693
         LA    @06,CTRADDR                                         0693
         ST    @06,@AL00001                                        0693
         LA    @01,@AL00001                                        0693
         BAL   @14,WRITRACK                                        0693
*                                      END;                        0694
*/*                                END-THEN                          */
*                                  END;                            0695
*/*                            END-ELSE                              */
*                              END;                                0696
*/*                        END-THEN (DEFECT-FLAG FOUND TO BE SET)    */
*                          END;                                    0697
*/*                      ELSE (DEFECT-FLAG FOUND NOT TO BE SET)      */
*                        ELSE DO;                                  0698
*                                                                  0698
         B     @RC00659                                            0698
@RF00659 DS    0H                                                  0699
*/*                        ISSUE_BUILD_PACK_MAP (FOUND DEFECTIVE)    */
*                          PACKTRAK = CTRADDR;                     0699
         MVC   PACKTRAK(4),CTRADDR                                 0699
*                          PACKASC = RZCCHH;                       0700
         MVC   PACKASC(4),RZCCHH                                   0700
*                          PACKDEF = NODEFECT;                     0701
         NI    PACKDEF,B'01111111'                                 0701
*                          PACKCHEK = DEFECTIV;                    0702
         OI    PACKCHEK,B'10000000'                                0702
*                          PACKRCVR = RCVRYES;                     0703
         NI    PACKRCVR,B'01111111'                                0703
*                          IF TRACKTYP = ALTTRACK                  0704
*                            THEN DO;                              0704
*                                                                  0704
         TM    TRACKTYP,B'10000000'                                0704
         BNZ   @RF00704                                            0704
*                              PACKTRK = ALTTRACK;                 0706
         NI    PACKTRK,B'01111111'                                 0706
*                              END;                                0707
*                            ELSE DO;                              0708
*                                                                  0708
         B     @RC00704                                            0708
@RF00704 DS    0H                                                  0709
*                              PACKTRK = PRITRACK;                 0709
         OI    PACKTRK,B'10000000'                                 0709
*                              END;                                0710
*                          CALL BILDPACK;                          0711
@RC00704 BAL   @14,BILDPACK                                        0711
*/*                        IF ASSIGN IS SPECIFIED                    */
*                          IF ADDR(ASSGN) ^= NULLPTR &             0712
*                           ALTFLAG = MOREYES                      0712
*/*                          THEN                                    */
*                            THEN DO;                              0712
*                                                                  0712
         L     @06,@PC00001+4                                      0712
         L     @06,FDTPTR+56(,@06)                                 0712
         LTR   @06,@06                                             0712
         BZ    @RF00712                                            0712
         TM    ALTFLAG,B'10000000'                                 0712
         BNZ   @RF00712                                            0712
*/*                            ISSUE_MARK_TRACK_DEFECTIVE            */
*                              CALL WRIHARZD(CTRADDR,TRACKTYP);    0714
         LA    @06,CTRADDR                                         0714
         ST    @06,@AL00001                                        0714
         LA    @06,TRACKTYP                                        0714
         ST    @06,@AL00001+4                                      0714
         LA    @01,@AL00001                                        0714
         BAL   @14,WRIHARZD                                        0714
*/*                            IF TRACK IS AN UNASSOCIATED ALTERNATE */
*                              IF TRACKTYP = ALTTRACK &            0715
*                                 ASSOCFLG = ASSOCNO               0715
*/*                              THEN DECREMENT COUNT OF AVAILABLE   */
*/*                               ALTERNATE TRACKS                   */
*                                THEN DO;                          0715
         TM    TRACKTYP,B'10000000'                                0715
         BNZ   @RF00715                                            0715
         TM    ASSOCFLG,B'10000000'                                0715
         BNZ   @RF00715                                            0715
*                                  ALTCOUNT = ALTCOUNT - 1;        0717
         L     @06,ALTCOUNT                                        0717
         BCTR  @06,0                                               0717
         ST    @06,ALTCOUNT                                        0717
*                                  TALCNT = TALCNT - 1;            0718
         L     @06,TALCNT                                          0718
         BCTR  @06,0                                               0718
         ST    @06,TALCNT                                          0718
*                                  END;                            0719
*/*                            IF NO SEVERE ERRORS FOUND AND         */
*/*                             TRACK IS RECOVERABLE                 */
*                              IF (LASTCOND < LASTCC12) &          0720
*                               (RCVRFLAG = RECOVER) &             0720
*                               (CNTFLAG = CONTINUE)               0720
*/*                              THEN                                */
*                                THEN DO;                          0720
*                                                                  0720
@RF00715 L     @06,@PC00001+8                                      0720
         LH    @06,LASTCOND(,@06)                                  0720
         CH    @06,@CH00265                                        0720
         BNL   @RF00720                                            0720
         TM    RCVRFLAG,B'10000000'                                0720
         BNO   @RF00720                                            0720
         TM    CNTFLAG,B'10000000'                                 0720
         BNO   @RF00720                                            0720
*/*                                IF TRACK IS AN ALTERNATE          */
*                                  IF TRACKTYP = ALTTRACK          0722
*                                   & ASSOCFLG = ASSOCYES          0722
*/*                                  THEN                            */
*/*                                   ISSUE_RE-ASSIGN_ALTERNATE_TRACK*/
*                                    THEN DO;                      0722
*                                                                  0722
         TM    TRACKTYP,B'10000000'                                0722
         BNZ   @RF00722                                            0722
         TM    ASSOCFLG,B'10000000'                                0722
         BNO   @RF00722                                            0722
*                                      CALL RASGNALT;              0724
         BAL   @14,RASGNALT                                        0724
*                                      END;                        0725
*/*                                  ELSE                            */
*                                    ELSE DO;                      0726
*                                                                  0726
         B     @RC00722                                            0726
@RF00722 DS    0H                                                  0727
*/*                                    IF TRACK IS A PRIMARY         */
*                                      IF TRACKTYP = PRITRACK      0727
*/*                                      THEN                        */
*                                        THEN DO;                  0727
         TM    TRACKTYP,B'10000000'                                0727
         BNO   @RF00727                                            0727
*/*                                        ISSUE_ASSIGN_ALTERNATE    */
*/*                                         _TRACK                   */
*                                          CALL ASSGNALT;          0729
         BAL   @14,ASSGNALT                                        0729
*/*                                        END-THEN                  */
*                                          END;                    0730
*/*                                    END-ELSE                      */
*                                      END;                        0731
*/*                                END-THEN                          */
*                                  END;                            0732
*/*                            END-THEN (ASSIGN IS SPECIFIED)        */
*                              END;                                0733
*/*                          ELSE (ASSIGNMENT NOT COMPLETE)          */
*                            ELSE DO;                              0734
*                                                                  0734
         B     @RC00712                                            0734
@RF00712 DS    0H                                                  0735
*/*                            IF PRIMARY TRACK WITH INVALID R0      */
*                              IF TRACKTYP = PRITRACK &            0735
*                               CTRADDR ^= RZCCHH                  0735
*/*                              THEN ISSUE_DESCRIPTOR_MESSAGE       */
*                                THEN DO;                          0735
         TM    TRACKTYP,B'10000000'                                0735
         BNO   @RF00735                                            0735
         CLC   CTRADDR(4),RZCCHH                                   0735
         BE    @RF00735                                            0735
*                                  RZACCHHX = 'FFFFFFFF'X;         0737
         MVC   RZACCHHX(4),@CB00881                                0737
*                                  CALL DESCMESS;                  0738
         BAL   @14,DESCMESS                                        0738
*                                  END;                            0739
*/*                            IF TRACK CONTENTS WERE READ           */
*                              IF TRKREAD = READYES                0740
*/*                              THEN WRITE_TRACK_CONTENTS           */
*                                THEN DO;                          0740
*                                                                  0740
@RF00735 TM    TRKREAD,B'10000000'                                 0740
         BNO   @RF00740                                            0740
*/*                                IF AN ASSOCIATED ALTERNATE TRACK  */
*                                  IF TRACKTYP = ALTTRACK &        0742
*                                   ASSOCFLG = ASSOCYES            0742
*/*                                  THEN                            */
*                                    THEN DO;                      0742
         TM    TRACKTYP,B'10000000'                                0742
         BNZ   @RF00742                                            0742
         TM    ASSOCFLG,B'10000000'                                0742
         BNO   @RF00742                                            0742
*                                      CALL WRITRACK               0744
*                                           (RZCCHH);              0744
         LA    @06,RZCCHH                                          0744
         ST    @06,@AL00001                                        0744
         LA    @01,@AL00001                                        0744
         BAL   @14,WRITRACK                                        0744
*                                      END;                        0745
*                                    ELSE DO;                      0746
         B     @RC00742                                            0746
@RF00742 DS    0H                                                  0747
*                                      CALL WRITRACK               0747
*                                           (CTRADDR);             0747
         LA    @06,CTRADDR                                         0747
         ST    @06,@AL00001                                        0747
         LA    @01,@AL00001                                        0747
         BAL   @14,WRITRACK                                        0747
*                                      END;                        0748
*/*                                END-THEN                          */
*                                  END;                            0749
*/*                            END-ELSE                              */
*                              END;                                0750
*/*                        END-ELSE (DEFECT-FLAG NOT SET)            */
*                          END;                                    0751
*/*                    END-ELSE (TRACK CHECKS OUT DEFECTIVE)         */
*                      END;                                        0752
*/*                END-THEN (NO SEVERE ERRORS FOUND)                 */
*                  END;                                            0753
*/*            END-THEN (CHECK IS SPECIFIED)                         */
*              END;                                                0754
*/*          ELSE (NOCHECK IS SPECIFIED)                             */
*            ELSE DO;                                              0755
*                                                                  0755
         B     @RC00581                                            0755
@RF00581 DS    0H                                                  0756
*/*            IF DEFECT-FLAG IS FOUND TO BE SET                     */
*              IF DFLAGC = DEFECTIV                                0756
*/*              THEN                                                */
*                THEN DO;                                          0756
*                                                                  0756
         TM    DFLAGC,B'10000000'                                  0756
         BNO   @RF00756                                            0756
*/*                ISSUE_BUILD_PACK_MAP (FLAGGED DEFECTIVE)          */
*                  PACKDEF = DEFECTIV;                             0758
         OI    PACKDEF,B'10000000'                                 0758
*                  PACKCHEK = NODEFECT;                            0759
         NI    PACKCHEK,B'01111111'                                0759
*                  PACKRCVR = RCVRYES;                             0760
         NI    PACKRCVR,B'01111111'                                0760
*                  PACKTRAK = CTRADDR;                             0761
         MVC   PACKTRAK(4),CTRADDR                                 0761
*                  PACKASC = RZCCHH;                               0762
         MVC   PACKASC(4),RZCCHH                                   0762
*                  IF TRACKTYP = ALTTRACK                          0763
*                    THEN DO;                                      0763
*                                                                  0763
         TM    TRACKTYP,B'10000000'                                0763
         BNZ   @RF00763                                            0763
*                      PACKTRK = ALTTRACK;                         0765
         NI    PACKTRK,B'01111111'                                 0765
*                      END;                                        0766
*                    ELSE DO;                                      0767
*                                                                  0767
         B     @RC00763                                            0767
@RF00763 DS    0H                                                  0768
*                      PACKTRK = PRITRACK;                         0768
         OI    PACKTRK,B'10000000'                                 0768
*                      END;                                        0769
*                  CALL BILDPACK;                                  0770
@RC00763 BAL   @14,BILDPACK                                        0770
*/*                IF ASSIGN IS SPECIFIED                            */
*/*                 (UN-CONDITIONAL ASSIGNMENT)                      */
*                  IF ADDR(ASSGN) ^= NULLPTR & ALTFLAG = MOREYES   0771
*                   & TRACKTYP = PRITRACK                          0771
*/*                  THEN                                            */
*                    THEN DO;                                      0771
*                                                                  0771
         L     @06,@PC00001+4                                      0771
         L     @06,FDTPTR+56(,@06)                                 0771
         LTR   @06,@06                                             0771
         BZ    @RF00771                                            0771
         TM    ALTFLAG,B'10000000'                                 0771
         BNZ   @RF00771                                            0771
         TM    TRACKTYP,B'10000000'                                0771
         BNO   @RF00771                                            0771
*/*                    VALIDATE_HOME-ADDRESS                         */
*                      CALL VALHOME;                               0773
         BAL   @14,VALHOME                                         0773
*/*                    IF NO SEVERE ERRORS AND TRACK RECOVERABLE     */
*                      IF LASTCOND < LASTCC12 & RCVRFLAG = RECOVER 0774
*                       & CNTFLAG = CONTINUE                       0774
*/*                      THEN                                        */
*                        THEN DO;                                  0774
         L     @06,@PC00001+8                                      0774
         LH    @06,LASTCOND(,@06)                                  0774
         CH    @06,@CH00265                                        0774
         BNL   @RF00774                                            0774
         TM    RCVRFLAG,B'10000000'                                0774
         BNO   @RF00774                                            0774
         TM    CNTFLAG,B'10000000'                                 0774
         BNO   @RF00774                                            0774
*/*                        IF PRIMARY TRACK ASSOCIATED ALREADY       */
*                          IF ASSOCFLG = ASSOCYES                  0776
*/*                          THEN                                    */
*                            THEN DO;                              0776
         TM    ASSOCFLG,B'10000000'                                0776
         BNO   @RF00776                                            0776
*/*                            ISSUE_MARK_TRACK_DEFECTIVE            */
*                              CALL WRIHARZD (RZCCHH,ALTTRACK);    0778
         LA    @06,RZCCHH                                          0778
         ST    @06,@AL00001                                        0778
         LA    @06,@CB00468                                        0778
         ST    @06,@AL00001+4                                      0778
         LA    @01,@AL00001                                        0778
         BAL   @14,WRIHARZD                                        0778
*/*                            END-THEN                              */
*                              END;                                0779
*/*                        IF NO SEVERE ERRORS AND TRACK RECOVERABLE */
*                          IF LASTCOND < LASTCC12 &                0780
*                           RCVRFLAG = RECOVER &                   0780
*                           CNTFLAG = CONTINUE                     0780
*/*                          THEN ISSUE_ASSIGN_ALTERNATE_TRACK       */
*                            THEN DO;    CALL ASSGNALT; END;       0780
@RF00776 L     @06,@PC00001+8                                      0780
         LH    @06,LASTCOND(,@06)                                  0780
         CH    @06,@CH00265                                        0780
         BNL   @RF00780                                            0780
         TM    RCVRFLAG,B'10000000'                                0780
         BNO   @RF00780                                            0780
         TM    CNTFLAG,B'10000000'                                 0780
         BNO   @RF00780                                            0780
         BAL   @14,ASSGNALT                                        0782
*/*                        END-THEN                                  */
*                          END;                                    0784
*/*                    END-THEN (ASSIGN SPECIFIED)                   */
*                      END;                                        0785
*/*                  ELSE                                            */
*                    ELSE DO;                                      0786
         B     @RC00771                                            0786
@RF00771 DS    0H                                                  0787
*/*                    IF UN-ASSOCIATED PRIMARY TRACK                */
*                      IF TRACKTYP = PRITRACK &                    0787
*                       ASSOCFLG = ASSOCNO                         0787
*/*                      THEN                                        */
*                        THEN DO;                                  0787
         TM    TRACKTYP,B'10000000'                                0787
         BNO   @RF00787                                            0787
         TM    ASSOCFLG,B'10000000'                                0787
         BNZ   @RF00787                                            0787
*/*                        ISSUE_DESCRIPTOR_MESSAGE                  */
*                          CALL DESCMESS;                          0789
         BAL   @14,DESCMESS                                        0789
*/*                        END-THEN                                  */
*                          END;                                    0790
*/*                    IF TRACK CONTENTS WERE READ                   */
*                      IF TRKREAD = READYES                        0791
*/*                      THEN WRITE_TRACK_CONTENTS                   */
*                        THEN DO;                                  0791
*                                                                  0791
@RF00787 TM    TRKREAD,B'10000000'                                 0791
         BNO   @RF00791                                            0791
*/*                        IF AN ASSOCIATED ALTERNATE TRACK          */
*                          IF TRACKTYP = ALTTRACK &                0793
*                           ASSOCFLG = ASSOCYES                    0793
*/*                          THEN                                    */
*                            THEN DO;                              0793
         TM    TRACKTYP,B'10000000'                                0793
         BNZ   @RF00793                                            0793
         TM    ASSOCFLG,B'10000000'                                0793
         BNO   @RF00793                                            0793
*                              CALL WRITRACK                       0795
*                                   (RZCCHH);                      0795
         LA    @06,RZCCHH                                          0795
         ST    @06,@AL00001                                        0795
         LA    @01,@AL00001                                        0795
         BAL   @14,WRITRACK                                        0795
*                              END;                                0796
*                            ELSE DO;                              0797
         B     @RC00793                                            0797
@RF00793 DS    0H                                                  0798
*                              CALL WRITRACK                       0798
*                                   (CTRADDR);                     0798
         LA    @06,CTRADDR                                         0798
         ST    @06,@AL00001                                        0798
         LA    @01,@AL00001                                        0798
         BAL   @14,WRITRACK                                        0798
*                              END;                                0799
*/*                        END-THEN                                  */
*                          END;                                    0800
*/*                    END-ELSE                                      */
*                      END;                                        0801
*/*                END-THEN (DEFECT-FLAG FOUND TO BE SET)            */
*                  END;                                            0802
*/*              ELSE (DEFECT-FLAG FOUND NOT TO BE SET)              */
*                ELSE DO;                                          0803
*                                                                  0803
         B     @RC00756                                            0803
@RF00756 DS    0H                                                  0804
*/*                IF ASSIGN IS SPECIFIED                            */
*/*                 (UN-CONDITIONAL (RE-)ASSIGNMENT)                 */
*                  IF ADDR(ASSGN) ^= NULLPTR & ALTFLAG = MOREYES   0804
*/*                  THEN                                            */
*                    THEN DO;                                      0804
*                                                                  0804
         L     @06,@PC00001+4                                      0804
         L     @06,FDTPTR+56(,@06)                                 0804
         LTR   @06,@06                                             0804
         BZ    @RF00804                                            0804
         TM    ALTFLAG,B'10000000'                                 0804
         BNZ   @RF00804                                            0804
*/*                    ISSUE_MARK_TRACK_DEFECTIVE                    */
*                      CALL WRIHARZD(CTRADDR,TRACKTYP);            0806
         LA    @06,CTRADDR                                         0806
         ST    @06,@AL00001                                        0806
         LA    @06,TRACKTYP                                        0806
         ST    @06,@AL00001+4                                      0806
         LA    @01,@AL00001                                        0806
         BAL   @14,WRIHARZD                                        0806
*/*                    IF TRACK IS AN UNASSOCIATED ALTERNATE         */
*                      IF TRACKTYP = ALTTRACK & ASSOCFLG = ASSOCNO 0807
*/*                      THEN DECREMENT THE COUNT OF AVAILABLE       */
*/*                       ALTERNATE TRACKS                           */
*                        THEN DO;                                  0807
         TM    TRACKTYP,B'10000000'                                0807
         BNZ   @RF00807                                            0807
         TM    ASSOCFLG,B'10000000'                                0807
         BNZ   @RF00807                                            0807
*                          ALTCOUNT = ALTCOUNT - 1;                0809
         L     @06,ALTCOUNT                                        0809
         BCTR  @06,0                                               0809
         ST    @06,ALTCOUNT                                        0809
*                          TALCNT = TALCNT - 1;                    0810
         L     @06,TALCNT                                          0810
         BCTR  @06,0                                               0810
         ST    @06,TALCNT                                          0810
*                          END;                                    0811
*/*                    IF NO SEVERE ERRORS FOUND AND TRACK IS        */
*/*                     FOUND TO BE RECOVERABLE                      */
*                      IF (LASTCOND < LASTCC12)                    0812
*                       & (RCVRFLAG = RECOVER)                     0812
*                       & (CNTFLAG = CONTINUE)                     0812
*/*                      THEN                                        */
*                        THEN DO;                                  0812
@RF00807 L     @06,@PC00001+8                                      0812
         LH    @06,LASTCOND(,@06)                                  0812
         CH    @06,@CH00265                                        0812
         BNL   @RF00812                                            0812
         TM    RCVRFLAG,B'10000000'                                0812
         BNO   @RF00812                                            0812
         TM    CNTFLAG,B'10000000'                                 0812
         BNO   @RF00812                                            0812
*/*                        IF TRACK IS AN ASSOCIATED ALTERNATE       */
*                          IF TRACKTYP = ALTTRACK                  0814
*                           & ASSOCFLG = ASSOCYES                  0814
*/*                          THEN ISSUE_RE-ASSIGN_ALTERNATE_TRACK    */
*                            THEN DO;                              0814
*                                                                  0814
         TM    TRACKTYP,B'10000000'                                0814
         BNZ   @RF00814                                            0814
         TM    ASSOCFLG,B'10000000'                                0814
         BNO   @RF00814                                            0814
*                              CALL RASGNALT;                      0816
         BAL   @14,RASGNALT                                        0816
*                              END;                                0817
*/*                          ELSE (PRIMARY TRACK)                    */
*                            ELSE DO;                              0818
*                                                                  0818
         B     @RC00814                                            0818
@RF00814 DS    0H                                                  0819
*/*                            IF TRACK IS A PRIMARY TRACK           */
*                              IF TRACKTYP = PRITRACK              0819
*/*                              THEN                                */
*                                THEN DO;                          0819
         TM    TRACKTYP,B'10000000'                                0819
         BNO   @RF00819                                            0819
*/*                                ISSUE_ASSIGN_ALTERNATE_TRACK      */
*                                  CALL ASSGNALT;                  0821
         BAL   @14,ASSGNALT                                        0821
*/*                                END-THEN                          */
*                                  END;                            0822
*/*                            END-ELSE (PRIMARY TRACK)              */
*                              END;                                0823
*/*                        END-THEN                                  */
*                          END;                                    0824
*/*                    END-THEN (ASSIGN IS SPECIFIED)                */
*                      END;                                        0825
*/*                  ELSE (ASSIGNMENT NOT COMPLETE)                  */
*                    ELSE DO;                                      0826
         B     @RC00804                                            0826
@RF00804 DS    0H                                                  0827
*/*                    IF PRIMARY TRACK WITH INVALID R0              */
*                      IF TRACKTYP = PRITRACK &                    0827
*                       CTRADDR ^= RZCCHH                          0827
*/*                      THEN ISSUE_DESCRIPTOR_MESSAGE               */
*                        THEN DO;                                  0827
         TM    TRACKTYP,B'10000000'                                0827
         BNO   @RF00827                                            0827
         CLC   CTRADDR(4),RZCCHH                                   0827
         BE    @RF00827                                            0827
*                          RZACCHHX = 'FFFFFFFF'X;                 0829
         MVC   RZACCHHX(4),@CB00881                                0829
*                          CALL DESCMESS;                          0830
         BAL   @14,DESCMESS                                        0830
*                          END;                                    0831
*/*                    IF TRACK CONTENTS WERE READ                   */
*                      IF TRKREAD = READYES                        0832
*/*                      THEN WRITE_TRACK_CONTENTS                   */
*                        THEN DO;                                  0832
*                                                                  0832
@RF00827 TM    TRKREAD,B'10000000'                                 0832
         BNO   @RF00832                                            0832
*/*                        IF AN ASSOCIATED ALTERNATE TRACK          */
*                          IF TRACKTYP = ALTTRACK &                0834
*                           ASSOCFLG = ASSOCYES                    0834
*/*                          THEN                                    */
*                            THEN DO;                              0834
         TM    TRACKTYP,B'10000000'                                0834
         BNZ   @RF00834                                            0834
         TM    ASSOCFLG,B'10000000'                                0834
         BNO   @RF00834                                            0834
*                              CALL WRITRACK                       0836
*                                   (RZCCHH);                      0836
         LA    @06,RZCCHH                                          0836
         ST    @06,@AL00001                                        0836
         LA    @01,@AL00001                                        0836
         BAL   @14,WRITRACK                                        0836
*                              END;                                0837
*                            ELSE DO;                              0838
         B     @RC00834                                            0838
@RF00834 DS    0H                                                  0839
*                              CALL WRITRACK                       0839
*                                   (CTRADDR);                     0839
         LA    @06,CTRADDR                                         0839
         ST    @06,@AL00001                                        0839
         LA    @01,@AL00001                                        0839
         BAL   @14,WRITRACK                                        0839
*                              END;                                0840
*/*                        END-THEN                                  */
*                          END;                                    0841
*/*                    END-ELSE                                      */
*                      END;                                        0842
*/*                END-ELSE (DEFECT-FLAG FOUND NOT TO BE SET)        */
*                  END;                                            0843
*/*            END-ELSE (NOCHECK IS SPECIFIED)                       */
*              END;                                                0844
*/*        END-THEN (NO SEVERE ERRORS FOUND)                         */
*          END;                                                    0845
*/*      ELSE                                                        */
*        ELSE DO;                                                  0846
*                                                                  0846
         B     @RC00579                                            0846
@RF00579 DS    0H                                                  0847
*/*        IF A SEVERE ERROR FOUND                                   */
*          IF LASTCOND >= LASTCC12                                 0847
*/*          THEN RETURN                                             */
*            THEN DO;    RETURN; END;                              0847
         L     @06,@PC00001+8                                      0847
         LH    @06,LASTCOND(,@06)                                  0847
         CH    @06,@CH00265                                        0847
         BL    @RF00847                                            0847
@EL00005 DS    0H                                                  0849
@EF00005 DS    0H                                                  0849
@ER00005 LM    @14,@12,@SA00005                                    0849
         BR    @14                                                 0849
*/*        END-ELSE                                                  */
*          END;                                                    0851
@RF00847 DS    0H                                                  0852
*/*  END-FOR (ALL THE TRACKS ARE EXHAUSTED)                          */
*    END;                                                          0852
@RC00579 AL    I2,@CF00165                                         0852
@DE00531 C     I2,TRKNUMB                                          0852
         BNH   @DL00531                                            0852
*/*  END-SUB-PROCEDURE INSPECT_THE_TRACKS                            */
*    END INSTRACK;                                                 0853
*                                                                  0853
         B     @EL00005                                            0853
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  UPDVTOC                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  UPDATE VTOC                                  */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL UPDATE THE VTOC WITH THE CURRENT      */
*/*    VALUES OF THE POINTER TO THE NEXT AVAILABLE ALTERNATE TRACK   */
*/*    AND ALSO THE NUMBER OF AVAILABLE ALTERNATE TRACKS.            */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0854
*                                                                  0854
*/*  SUB-PROCEDURE UPDATE_VTOC                                       */
*    UPDVTOC:                                                      0854
*      PROCEDURE;                                                  0854
UPDVTOC  STM   @14,@12,@SA00006                                    0854
*    DCL RETCODE1            FIXED (31);                           0855
*    OLDERID2 = NEWERID2;                                          0856
         L     @06,@PC00001                                        0856
         L     @06,GDTTR2(,@06)                                    0856
         MVC   @TS00001(95),NEWERID2(@06)                          0856
         MVC   OLDERID2(95,@06),@TS00001                           0856
*    NEWID2 = 'ITUV';                                              0857
         MVC   NEWID2(4,@06),@CC00888                              0857
*/*  IF NO MORE ALTERNATE TRACKS WERE LEFT                           */
*    IF ALTFLAG = MORENO                                           0858
*/*    THEN ZERO OUT THE FIELDS THAT CONTAIN NUMBER OF AVAILABLE     */
*/*     ALTERNATE TRACKS AND POINTER TO THE NEXT AVAILABLE ALTERNATE */
*/*     ALTERNATE TRACK                                              */
*      THEN DO;                                                    0858
*                                                                  0858
         TM    ALTFLAG,B'10000000'                                 0858
         BNO   @RF00858                                            0858
*        TALPTR = 0;                                               0860
         SLR   @06,@06                                             0860
         ST    @06,TALPTR                                          0860
*        TALCNT = 0;                                               0861
         ST    @06,TALCNT                                          0861
*        END;                                                      0862
*/*  IF THE CURRENT POINTER TO THE NEXT AVAILABLE ALTERNATE TRACK    */
*/*   POINTS BEYOND OR AT AN ALTERNATE TRACK WHOSE POINTER APPEARS   */
*/*   IN THE VTOC                                                    */
*    IF ALTPTR >= TALPTR & ALTFLAG = MOREYES                       0863
*/*    THEN UPDATE THE VALUES IN THE VTOC                            */
*      THEN DO;                                                    0863
@RF00858 L     @06,ALTPTR                                          0863
         CL    @06,TALPTR                                          0863
         BL    @RF00863                                            0863
         TM    ALTFLAG,B'10000000'                                 0863
         BNZ   @RF00863                                            0863
*        TALPTR = ALTPTR;                                          0865
         ST    @06,TALPTR                                          0865
*        END;                                                      0866
*/*  IF THE NUMBER OF AVAILABLE ALTERNATE TRACKS IS LESSER THAN VTOC */
*/*   VALUE                                                          */
*    IF ALTCOUNT < TALCNT                                          0867
*/*    THEN UPDATE THE VTOC VALUE                                    */
*      THEN DO;    TALCNT = ALTCOUNT; END;                         0867
@RF00863 L     @06,ALTCOUNT                                        0867
         C     @06,TALCNT                                          0867
         BNL   @RF00867                                            0867
         ST    @06,TALCNT                                          0869
*/*  SET THE NUMBER OF AVAILABLE ALTERNATE TRACKS                    */
*    DS4NOATK = TALCNT;                                            0871
@RF00867 L     @06,F4PTR                                           0871
         MVC   DS4NOATK(2,@06),TALCNT+2                            0871
*/*  SET THE ADDRESS OF THE NEXT AVAILABLE ALTERNATE TRACK           */
*    DS4HCCHH = TALPTR;                                            0872
         MVC   DS4HCCHH(4,@06),TALPTR                              0872
*/*  WRITE FORMAT4 DSCB (WITH THE UPDATED VALUES OF TALPTR,TALCNT)   */
*    RECNUM = 1;                                                   0873
         MVC   RECNUM(4),@CF00165                                  0873
*    CALL ICKDVOP0 (GDTTBL                                         0874
*           ,VOLIB                                                 0874
*           ,ACTWDN                                                0874
*           ,VTOCLOC                                               0874
*           ,RECNUM                                                0874
*           ,POOLID                                                0874
*           ,F4PTR                                                 0874
*           ,LENGTH(FOR4DSCB)                                      0874
*           ,RETCODE1);                                            0874
         L     @06,@PC00001                                        0874
         ST    @06,@AL00001                                        0874
         LA    @15,VOLIB                                           0874
         ST    @15,@AL00001+4                                      0874
         LA    @15,@CF00298                                        0874
         ST    @15,@AL00001+8                                      0874
         LA    @15,VTOCLOC                                         0874
         ST    @15,@AL00001+12                                     0874
         LA    @15,RECNUM                                          0874
         ST    @15,@AL00001+16                                     0874
         LA    @15,POOLID                                          0874
         ST    @15,@AL00001+20                                     0874
         LA    @15,F4PTR                                           0874
         ST    @15,@AL00001+24                                     0874
         LA    @15,@CF00488                                        0874
         ST    @15,@AL00001+28                                     0874
         LA    @15,RETCODE1                                        0874
         ST    @15,@AL00001+32                                     0874
         L     @15,GDTDOP(,@06)                                    0874
         LA    @01,@AL00001                                        0874
         BALR  @14,@15                                             0874
*/*  IF WRITE OPERATION FAILS                                        */
*    IF RETCODE1 = CPFAILS                                         0875
*/*    THEN                                                          */
*      THEN DO;                                                    0875
*                                                                  0875
         CLC   RETCODE1(4),@CF00044                                0875
         BNE   @RF00875                                            0875
*/*      ISSUE ERROR MESSAGE (MSGWDSCB) (UPRINT)                     */
*        DARGSENT = MSGWDSCB;                                      0877
         L     @06,DDSTRU                                          0877
         MVI   DARGSENT(@06),X'2E'                                 0877
*        DARGCNT = 2;                                              0878
         LA    @15,2                                               0878
         STH   @15,DARGCNT(,@06)                                   0878
*        DARGINS (1) = 1;                                          0879
         MVC   DARGINS(2,@06),@CH00165                             0879
*        DARGINL (1) = LENGTH (VTOCLOCC);                          0880
         STH   @15,DARGINL(,@06)                                   0880
*        DARGDTM (1) = ADDR (VTOCLOCC);                            0881
         LA    @14,VTOCLOCC                                        0881
         ST    @14,DARGDTM(,@06)                                   0881
*        DARGINS (2) = 2;                                          0882
         STH   @15,DARGINS+8(,@06)                                 0882
*        DARGINL (2) = LENGTH (VTOCLOCT);                          0883
         STH   @15,DARGINL+8(,@06)                                 0883
*        DARGDTM (2) = ADDR (VTOCLOCT);                            0884
         LA    @15,VTOCLOCT                                        0884
         ST    @15,DARGDTM+8(,@06)                                 0884
*        CALL ICKTPPR0 (GDTTBL                                     0885
*               ,PRTFILE                                           0885
*               ,DDSTRU);                                          0885
         L     @06,@PC00001                                        0885
         ST    @06,@AL00001                                        0885
         LA    @15,@CF00094                                        0885
         ST    @15,@AL00001+4                                      0885
         LA    @15,DDSTRU                                          0885
         ST    @15,@AL00001+8                                      0885
         MVI   @AL00001+8,X'80'                                    0885
         L     @15,GDTPRT(,@06)                                    0885
         LA    @01,@AL00001                                        0885
         BALR  @14,@15                                             0885
*/*      INDICATE A SEVERE ERROR (LASTCOND = 12)                     */
*        LASTCOND = LASTCC12;                                      0886
         L     @06,@PC00001+8                                      0886
         MVC   LASTCOND(2,@06),@CH00265                            0886
*/*      END-THEN                                                    */
*        END;                                                      0887
*/*  END-SUB-PROCEDURE UPDATE_VTOC                                   */
*    END UPDVTOC;                                                  0888
*                                                                  0888
*                                                                  0888
@EL00006 DS    0H                                                  0888
@EF00006 DS    0H                                                  0888
@ER00006 LM    @14,@12,@SA00006                                    0888
         BR    @14                                                 0888
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  REATRACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  READ TRACK CONTENTS                          */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE ISSUES SEVERAL CALLS TO THE DEVICE         */
*/*    OPERATIONS FACILITY (UDEVOP) IN ORDER TO READ ALL THE         */
*/*    RECORDS FROM THE TRACK. THESE RECORDS ARE PRESERVED IN        */
*/*    MAIN STORAGE. IF AN ERROR IS ENCOUNTERED IN READING ANY       */
*/*    RECORD THE READING PROCESS IS TERMINATED AND A SEVERE ERROR   */
*/*    IS INDICATED.                                                 */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0889
*                                                                  0889
*/*  SUB-PROCEDURE READ_TRACK_CONTENTS                               */
*    REATRACK:                                                     0889
*      PROCEDURE                                                   0889
*        (                                                         0889
*        RTRADDR,                                                  0889
*        DFLAG1,                                                   0889
*        STATE                                                     0889
*        );                                                        0889
REATRACK STM   @14,@12,@SA00007                                    0889
         MVC   @PC00007(12),0(@01)                                 0889
*    OLDERID2 = NEWERID2;                                          0890
         L     @06,@PC00001                                        0890
         L     @15,GDTTR2(,@06)                                    0890
         MVC   @TS00001(95),NEWERID2(@15)                          0890
         MVC   OLDERID2(95,@15),@TS00001                           0890
*    NEWID2 = 'ITRE';                                              0891
*                                                                  0891
         MVC   NEWID2(4,@15),@CC00898                              0891
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/
*                                                                  0892
*      IREAD                 FIXED(31),                            0892
*                                                                  0892
*      1 RTRADDR,            /* ADDRESS OF TRACK TO BE READ          */
*                                                                  0892
*        2 RTRADDRC          /* CYLINDER NUMBER                      */
*                            FIXED (16),                           0892
*                                                                  0892
*        2 RTRADDRT          /* TRACK NUMBER                         */
*                            FIXED (16),                           0892
*                                                                  0892
*      DFLAG1                 /* DEFECT-FLAG INDICATOR               */
*                            /* DEFECTIV: DEFECT-FLAG SET            */
*                            /* NODEFECT: DEFECT-FLAG NOT SET        */
*                            BIT (1),                              0892
*                                                                  0892
*      RETCODE2              /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31),                           0892
*                                                                  0892
*      STATE                 /* FLAG TO INDICATE IF THE TRACK        */
*                            /* CONTENTS WERE READ OR NOT.           */
*                            /* READYES: CONTENTS WERE READ          */
*                            /* READNO: CONTENTS WERE NOT READ       */
*                            BIT (1);                              0892
*                                                                  0892
*/*  IF SPACE HAS NOT BEEN OBTAINED FOR A RECORD TABLE               */
*    IF SPACEFLG = SPACENO                                         0893
*/*    THEN                                                          */
*      THEN DO;                                                    0893
*                                                                  0893
         TM    SPACEFLG,B'10000000'                                0893
         BNZ   @RF00893                                            0893
*/*      COMPUTE THE LENGTH OF THE TABLE TO HOLD THE POINTERS TO THE */
*/*      RECORDS READ FROM A TRACK                                   */
*        RTABLEN = RTABLENS * MAXREC;                              0895
         L     @03,INFOPTR+84                                      0895
         L     @03,MAXREC(,@03)                                    0895
         MH    @03,@CH00265                                        0895
         ST    @03,RTABLEN                                         0895
*/*      GET STORAGE FOR THE TABLE THAT WILL HOLD THE POINTERS TO THE*/
*/*       RECORDS AS THEY ARE READ INTO MAIN STORAGE                 */
*        CALL ICKSAGP0 (GDTTBL                                     0896
*               ,RTABLEN                                           0896
*               ,RECPTR                                            0896
*               ,POOLID                                            0896
*               ,SETZERO);                                         0896
         ST    @06,@AL00001                                        0896
         LA    @03,RTABLEN                                         0896
         ST    @03,@AL00001+4                                      0896
         LA    @03,RECPTR                                          0896
         ST    @03,@AL00001+8                                      0896
         LA    @03,POOLID                                          0896
         ST    @03,@AL00001+12                                     0896
         LA    @03,@CC00145                                        0896
         ST    @03,@AL00001+16                                     0896
         MVI   @AL00001+16,X'80'                                   0896
         L     @15,GDTGPL(,@06)                                    0896
         LA    @01,@AL00001                                        0896
         BALR  @14,@15                                             0896
*        RESPECIFY RTNREG RSTD;                                    0897
*        TESTRC = RTNREG;                                          0898
         LR    TESTRC,RTNREG                                       0898
*        RESPECIFY RTNREG UNRSTD;                                  0899
*/*      IF UNABLE TO OBTAIN STORAGE                                 */
*        IF TESTRC = 4                                             0900
*/*        THEN                                                      */
*          THEN DO;                                                0900
*                                                                  0900
         CH    TESTRC,@CH00044                                     0900
         BNE   @RF00900                                            0900
*/*          ISSUE AN ERROR MESSAGE (MSGRTNOS) (UPRINT)              */
*            DARGSENT = MSGRTNOS;                                  0902
         L     @06,DDSTRU                                          0902
         MVI   DARGSENT(@06),X'2B'                                 0902
*            CALL ICKTPPR0 (GDTTBL                                 0903
*                   ,PRTFILE                                       0903
*                   ,DDSTRU);                                      0903
         L     @06,@PC00001                                        0903
         ST    @06,@AL00001                                        0903
         LA    @15,@CF00094                                        0903
         ST    @15,@AL00001+4                                      0903
         LA    @15,DDSTRU                                          0903
         ST    @15,@AL00001+8                                      0903
         MVI   @AL00001+8,X'80'                                    0903
         L     @15,GDTPRT(,@06)                                    0903
         LA    @01,@AL00001                                        0903
         BALR  @14,@15                                             0903
*/*          INDICATE A SEVERE ERROR                                 */
*            LASTCOND = LASTCC12;                                  0904
         L     @06,@PC00001+8                                      0904
         MVC   LASTCOND(2,@06),@CH00265                            0904
*/*          END-THEN                                                */
*            END;                                                  0905
*/*        ELSE INDICATE THAT THE SPACE HAS BEEN OBTAINED            */
*          ELSE DO;    SPACEFLG = SPACEYES; END;                   0906
         B     @RC00900                                            0906
@RF00900 DS    0H                                                  0907
         OI    SPACEFLG,B'10000000'                                0907
*/*      END-THEN                                                    */
*        END;                                                      0909
@RC00900 DS    0H                                                  0910
*/*  IF NO SEVERE ERRORS                                             */
*    IF LASTCOND < LASTCC12                                        0910
*/*    THEN                                                          */
*      THEN DO;                                                    0910
*                                                                  0910
@RF00893 L     @06,@PC00001+8                                      0910
         LH    @06,LASTCOND(,@06)                                  0910
         CH    @06,@CH00265                                        0910
         BNL   @RF00910                                            0910
*/*      INITIALIZE RECORD NUMBER AND COUNT TO ZERO                  */
*        IREAD = 0;                                                0912
         SLR   IREAD,IREAD                                         0912
*        RCDCNT = 0;                                               0913
         SLR   @06,@06                                             0913
         ST    @06,RCDCNT                                          0913
*/*      DO-UNTIL THERE IS NO DATA ON THE TRACK OR AN OVERFLOW       */
*/*       RECORD WAS ENCOUNTERED                                     */
*        CALL ICKSAFP0 (GDTTBL                                     0914
*               ,'ITRT');                                          0914
         L     @06,@PC00001                                        0914
         ST    @06,@AL00001                                        0914
         LA    @03,@CC00903                                        0914
         ST    @03,@AL00001+4                                      0914
         MVI   @AL00001+4,X'80'                                    0914
         L     @15,GDTFPL(,@06)                                    0914
         LA    @01,@AL00001                                        0914
         BALR  @14,@15                                             0914
*        DO UNTIL (RETCODE2 = NORECFND  RETCODE2 = OVERFLOW);     0915
*                                                                  0915
@DL00915 DS    0H                                                  0916
*/*        INCREMENT LOOP COUNTER                                    */
*          IREAD = IREAD + 1;                                      0916
         LA    @06,1                                               0916
         ALR   IREAD,@06                                           0916
*/*        SET UP RECORD NUMBER FOR SEARCH ARGUMENT                  */
*          IF IREAD = 1                                            0917
*            THEN DO;    RECNUM = IREAD; END;                      0917
         CR    IREAD,@06                                           0917
         BNE   @RF00917                                            0917
         ST    IREAD,RECNUM                                        0919
*            ELSE DO;    RECNUM = PRECNUM + 1; END;                0921
         B     @RC00917                                            0921
@RF00917 DS    0H                                                  0922
         LA    @06,1                                               0922
         AL    @06,PRECNUM                                         0922
         ST    @06,RECNUM                                          0922
*/*        READ RECORD N (N IS THE RECORD NUMBER) (UDEVOP)           */
*          CALL ICKDVOP0 (GDTTBL                                   0924
*                 ,VOLIB                                           0924
*                 ,ACTRCKDN                                        0924
*                 ,RTRADDR                                         0924
*                 ,RECNUM                                          0924
*                 ,'ITRT'                                          0924
*                 ,DATAPTR                                         0924
*                 ,DATALEN                                         0924
*                 ,RETCODE2);                                      0924
@RC00917 L     @06,@PC00001                                        0924
         ST    @06,@AL00001                                        0924
         LA    @03,VOLIB                                           0924
         ST    @03,@AL00001+4                                      0924
         LA    @03,@CF00246                                        0924
         ST    @03,@AL00001+8                                      0924
         L     @03,@PC00007                                        0924
         ST    @03,@AL00001+12                                     0924
         LA    @03,RECNUM                                          0924
         ST    @03,@AL00001+16                                     0924
         LA    @03,@CC00903                                        0924
         ST    @03,@AL00001+20                                     0924
         LA    @03,DATAPTR                                         0924
         ST    @03,@AL00001+24                                     0924
         LA    @03,DATALEN                                         0924
         ST    @03,@AL00001+28                                     0924
         LA    @03,RETCODE2                                        0924
         ST    @03,@AL00001+32                                     0924
         L     @15,GDTDOP(,@06)                                    0924
         LA    @01,@AL00001                                        0924
         BALR  @14,@15                                             0924
*/*        IF READ OPERATION IS SUCCESSFUL                           */
*          IF RETCODE2 ^= CPFAILS                                  0925
*/*          THEN (READ OPERATION SUCCESSFUL)                        */
*            THEN DO;                                              0925
*                                                                  0925
         L     @06,RETCODE2                                        0925
         CH    @06,@CH00044                                        0925
         BE    @RF00925                                            0925
*/*            IF A RECORD EXISTS                                    */
*              IF (RETCODE2 = SUCCESS)  (RETCODE2 = OVERFLOW)     0927
*/*              THEN                                                */
*                THEN DO;                                          0927
*                                                                  0927
         LTR   @06,@06                                             0927
         BZ    @RT00927                                            0927
         CH    @06,@CH00260                                        0927
         BNE   @RF00927                                            0927
@RT00927 DS    0H                                                  0928
*                  RESPECIFY RTRECORD BASED (DATAPTR);             0929
*/*                IF FIRST RECORD READ                              */
*                  IF IREAD = 1                                    0930
*/*                  THEN SAVE THE RECORD NUMBER                     */
*                    THEN DO;    FRECNUM = RCNTR; END;             0930
         CH    IREAD,@CH00165                                      0930
         BNE   @RF00930                                            0930
         L     @06,DATAPTR                                         0932
         SLR   @03,@03                                             0932
         IC    @03,RCNTR(,@06)                                     0932
         ST    @03,FRECNUM                                         0932
*/*                  ELSE (NOT FIRST RECORD)                         */
*                    ELSE DO;                                      0934
         B     @RC00930                                            0934
@RF00930 DS    0H                                                  0935
*/*                    IF WRAPAROUND OCCURED                         */
*                      IF FRECNUM = RCNTR                          0935
*/*                      THEN LEAVE                                  */
*                        THEN DO;    GOTO ENDLOOPI; END;           0935
         L     @06,FRECNUM                                         0935
         L     @03,DATAPTR                                         0935
         MVC   @ZT00003+3(1),RCNTR(@03)                            0935
         C     @06,@ZT00003                                        0935
         BNE   @RF00935                                            0935
         B     ENDLOOPI                                            0937
*/*                    END-ELSE (NOT FIRST RECORD)                   */
*                      END;                                        0939
@RF00935 DS    0H                                                  0940
*/*                INCREMENT NUMBER OF RECORDS READ                  */
*                  RCDCNT = RCDCNT + 1;                            0940
@RC00930 LA    @06,1                                               0940
         L     @03,RCDCNT                                          0940
         ALR   @03,@06                                             0940
         ST    @03,RCDCNT                                          0940
*/*                SAVE THE RECORD NUMBER OF THE RECORD READ         */
*                  PRECNUM = RCNTR;                                0941
         L     @15,DATAPTR                                         0941
         SLR   @14,@14                                             0941
         IC    @14,RCNTR(,@15)                                     0941
         ST    @14,PRECNUM                                         0941
*/*                SET UP POINTER TO RECORD IN THE RECORD TABLE      */
*                  RECTAPTR (RCDCNT) = DATAPTR;                    0942
         L     @14,RECPTR                                          0942
         MH    @03,@CH00265                                        0942
         LA    @01,0(@03,@14)                                      0942
         AL    @01,@CF01068                                        0942
         ST    @15,RECTAPTR(,@01)                                  0942
*/*                SET UP LENGTH OF RECORD IN THE RECORD TABLE       */
*                  RECTALEN (RCDCNT) = DATALEN;                    0943
         L     @15,DATALEN                                         0943
         LA    @01,0(@03,@14)                                      0943
         AL    @01,@CF01069                                        0943
         ST    @15,RECTALEN-4(,@01)                                0943
*/*                IF TRACK IS AN OVERFLOW RECORD                    */
*                  IF RETCODE2 = OVERFLOW                          0944
*/*                  THEN INDICATE OVERFLOW RECORD                   */
*                    THEN DO;                                      0944
*                                                                  0944
         CLC   RETCODE2(4),@CF00260                                0944
         BNE   @RF00944                                            0944
*                      RECTAOFL(RCDCNT) = 1;                       0946
         AL    @14,@CF01070                                        0946
         STC   @06,RECTAOFL-8(@03,@14)                             0946
*                      END;                                        0947
*/*                  ELSE INDICATE A NORMAL RECORD                   */
*                    ELSE DO;                                      0948
*                                                                  0948
         B     @RC00944                                            0948
@RF00944 DS    0H                                                  0949
*                      RECTAOFL(RCDCNT) = 0;                       0949
         L     @06,RCDCNT                                          0949
         MH    @06,@CH00265                                        0949
         SLR   @03,@03                                             0949
         L     @01,RECPTR                                          0949
         AL    @01,@CF01070                                        0949
         STC   @03,RECTAOFL-8(@06,@01)                             0949
*                      END;                                        0950
*/*                END-THEN                                          */
*                  END;                                            0951
*/*            END-THEN                                              */
*              END;                                                0952
*/*          ELSE                                                    */
*            ELSE DO;                                              0953
*                                                                  0953
         B     @RC00925                                            0953
@RF00925 DS    0H                                                  0954
*/*            ISSUE ERROR MESSAGE (MSGNOREA) (UPRINT)               */
*              DARGSENT = MSGNOREA;                                0954
         L     @06,DDSTRU                                          0954
         MVI   DARGSENT(@06),X'2C'                                 0954
*              DARGCNT = 3;                                        0955
         LA    @15,3                                               0955
         STH   @15,DARGCNT(,@06)                                   0955
*              DARGINS (1) = 1;                                    0956
         MVC   DARGINS(2,@06),@CH00165                             0956
*              DARGINL (1) = LENGTH (RTRADDRC);                    0957
         LA    @14,2                                               0957
         STH   @14,DARGINL(,@06)                                   0957
*              DARGDTM (1) = ADDR (RTRADDRC);                      0958
         L     @05,@PC00007                                        0958
         ST    @05,DARGDTM(,@06)                                   0958
*              DARGINS (2) = 2;                                    0959
         STH   @14,DARGINS+8(,@06)                                 0959
*              DARGINL (2) = LENGTH (RTRADDRT);                    0960
         STH   @14,DARGINL+8(,@06)                                 0960
*              DARGDTM (2) = ADDR (RTRADDRT);                      0961
         LA    @14,RTRADDRT(,@05)                                  0961
         ST    @14,DARGDTM+8(,@06)                                 0961
*              DARGINS (3) = 3;                                    0962
         STH   @15,DARGINS+16(,@06)                                0962
*              DARGINL (3) = LENGTH (RECNUM);                      0963
         MVC   DARGINL+16(2,@06),@CH00044                          0963
*              DARGDTM (3) = ADDR (RECNUM);                        0964
         LA    @15,RECNUM                                          0964
         ST    @15,DARGDTM+16(,@06)                                0964
*              CALL ICKTPPR0 (GDTTBL                               0965
*                     ,PRTFILE                                     0965
*                     ,DDSTRU);                                    0965
         L     @06,@PC00001                                        0965
         ST    @06,@AL00001                                        0965
         LA    @15,@CF00094                                        0965
         ST    @15,@AL00001+4                                      0965
         LA    @15,DDSTRU                                          0965
         ST    @15,@AL00001+8                                      0965
         MVI   @AL00001+8,X'80'                                    0965
         L     @15,GDTPRT(,@06)                                    0965
         LA    @01,@AL00001                                        0965
         BALR  @14,@15                                             0965
*/*            INDICATE AN ERROR (LASTCOND = 8)                      */
*              LASTCOND = MAX(LASTCC08,LASTCOND);                  0966
         L     @06,@PC00001+8                                      0966
         LH    @15,LASTCOND(,@06)                                  0966
         LA    @14,8                                               0966
         CR    @15,@14                                             0966
         BNL   *+6
         LR    @15,@14                                             0966
         STH   @15,LASTCOND(,@06)                                  0966
*/*            INDICATE PROCESSING SHOULD NOT CONTINUE ON THIS TRACK */
*              CNTFLAG = NOCONT;                                   0967
         NI    CNTFLAG,B'01111111'                                 0967
*/*            RETURN                                                */
*              RETURN;                                             0968
@EL00007 DS    0H                                                  0968
@EF00007 DS    0H                                                  0968
@ER00007 LM    @14,@12,@SA00007                                    0968
         BR    @14                                                 0968
*/*            END-ELSE                                              */
*              END;                                                0969
*/*      END-UNTIL                                                   */
*        END;                                                      0970
@RC00925 DS    0H                                                  0970
@DE00915 L     @06,RETCODE2                                        0970
         CH    @06,@CH00165                                        0970
         BE    @DC00915                                            0970
         CH    @06,@CH00260                                        0970
         BNE   @DL00915                                            0970
@DC00915 DS    0H                                                  0971
*        ENDLOOPI:                                                 0971
*/*      SET FLAG TO INDICATE THE TRACK CONTENTS WERE READ           */
*        STATE = READYES;                                          0971
ENDLOOPI L     @06,@PC00007+8                                      0971
         OI    STATE(@06),B'10000000'                              0971
*/*      END-THEN (NO SEVERE ERRORS)                                 */
*        END;                                                      0972
*/*  END-SUB-PROCEDURE READ_TRACK_CONTENTS                           */
*    END REATRACK;                                                 0973
*                                                                  0973
         B     @EL00007                                            0973
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  WRITRACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  WRITE TRACK CONTENTS                         */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE ISSUES SEVERAL CALLS TO THE DEVICE         */
*/*    OPERATIONS FACILITY (UDEVOP) IN ORDER TO WRITE BACK ON A      */
*/*    TRACK ALL THE RECORDS THAT HAVE BEEN PRESERVED IN MAIN        */
*/*    STORAGE. IF AN ERROR IS ENCOUNTERED IN WRITING BACK ANY       */
*/*    RECORD THE WRITING PROCESS IS TERMINATED AND A SEVERE ERROR   */
*/*    IS INDICATED.                                                 */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  0974
*                                                                  0974
*/*  SUB-PROCEDURE WRITE_TRACK_CONTENTS                              */
*    WRITRACK:                                                     0974
*      PROCEDURE                                                   0974
*        (                                                         0974
*        WTRADDR                                                   0974
*        );                                                        0974
WRITRACK STM   @14,@12,@SA00008                                    0974
         MVC   @PC00008(4),0(@01)                                  0974
*    OLDERID2 = NEWERID2;                                          0975
         L     @06,@PC00001                                        0975
         L     @06,GDTTR2(,@06)                                    0975
         MVC   @TS00001(95),NEWERID2(@06)                          0975
         MVC   OLDERID2(95,@06),@TS00001                           0975
*    NEWID2 = 'ITWI';                                              0976
*                                                                  0976
         MVC   NEWID2(4,@06),@CC00912                              0976
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/
*                                                                  0977
*      I4                    FIXED(31),                            0977
*                                                                  0977
*      RETCODE3              FIXED (31),                           0977
*                                                                  0977
*      1 WTRADDR,            /* ADDRESS OF TRACK ON WHICH RECORDS    */
*                            /* ARE TO BE WRITTEN                    */
*                                                                  0977
*        2 WTRADDRC          /* CYLINDER NUMBER                      */
*                            FIXED (16),                           0977
*                                                                  0977
*        2 WTRADDRT          /* TRACK NUMBER                         */
*                            FIXED (16);                           0977
*                                                                  0977
*/*  DO-FOR ALL THE RECORDS THAT WERE PRESERVED                      */
*    DO I4 = 1 TO RCDCNT;                                          0978
*                                                                  0978
         LA    I4,1                                                0978
         B     @DE00978                                            0978
@DL00978 DS    0H                                                  0979
*/*    SET UP RECORD NUMBER FOR SEARCH ARGUMENT                      */
*      IF I4 = 1                                                   0979
*        THEN DO;    RECNUM = I4; END;                             0979
         CH    I4,@CH00165                                         0979
         BNE   @RF00979                                            0979
         ST    I4,RECNUM                                           0981
*        ELSE DO;    RECNUM = PRECNUM + 1; END;                    0983
         B     @RC00979                                            0983
@RF00979 DS    0H                                                  0984
         LA    @06,1                                               0984
         AL    @06,PRECNUM                                         0984
         ST    @06,RECNUM                                          0984
*/*    IF THE RECORD TO BE WRITTEN IS AN OVERFLOW RECORD             */
*      IF RECTAOFL(I4) = 1                                         0986
*/*      THEN SET ACTION KEY TO WRITE THE OVERFLOW RECORD ON TRACK   */
*        THEN DO;    WRACTION = ACTSCKDN; END;                     0986
@RC00979 LR    @06,I4                                              0986
         MH    @06,@CH00265                                        0986
         L     @03,RECPTR                                          0986
         AL    @03,@CF01070                                        0986
         SLR   @15,@15                                             0986
         IC    @15,RECTAOFL-8(@06,@03)                             0986
         CH    @15,@CH00165                                        0986
         BNE   @RF00986                                            0986
         MVC   WRACTION(4),@CF00278                                0988
*/*      ELSE SET ACTION KEY TO WRITE A NORMAL RECORD ON TRACK       */
*        ELSE DO;    WRACTION = ACTWCKDN; END;                     0990
         B     @RC00986                                            0990
@RF00986 DS    0H                                                  0991
         MVC   WRACTION(4),@CF00260                                0991
*/*    WRITE RECORD N ( WHERE N IS THE RECORD NUMBER) (UDEVOP)       */
*      CALL ICKDVOP0 (GDTTBL                                       0993
*             ,VOLIB                                               0993
*             ,WRACTION                                            0993
*             ,WTRADDR                                             0993
*             ,RECNUM                                              0993
*             ,'ITRT'                                              0993
*             ,RECTAPTR (I4)                                       0993
*             ,RECTALEN (I4)                                       0993
*             ,RETCODE3);                                          0993
@RC00986 L     @06,@PC00001                                        0993
         ST    @06,@AL00001                                        0993
         LA    @03,VOLIB                                           0993
         ST    @03,@AL00001+4                                      0993
         LA    @03,WRACTION                                        0993
         ST    @03,@AL00001+8                                      0993
         L     @03,@PC00008                                        0993
         ST    @03,@AL00001+12                                     0993
         LA    @03,RECNUM                                          0993
         ST    @03,@AL00001+16                                     0993
         LA    @03,@CC00903                                        0993
         ST    @03,@AL00001+20                                     0993
         L     @03,RECPTR                                          0993
         LR    @15,I4                                              0993
         MH    @15,@CH00265                                        0993
         LA    @01,0(@15,@03)                                      0993
         AL    @01,@CF01068                                        0993
         ST    @01,@AL00001+24                                     0993
         AL    @03,@CF01069                                        0993
         LA    @03,RECTALEN-4(@15,@03)                             0993
         ST    @03,@AL00001+28                                     0993
         LA    @03,RETCODE3                                        0993
         ST    @03,@AL00001+32                                     0993
         L     @15,GDTDOP(,@06)                                    0993
         LA    @01,@AL00001                                        0993
         BALR  @14,@15                                             0993
*/*    IF WRITE OPERATION FAILS                                      */
*      IF RETCODE3 = CPFAILS                                       0994
*/*      THEN                                                        */
*        THEN DO;                                                  0994
*                                                                  0994
         CLC   RETCODE3(4),@CF00044                                0994
         BNE   @RF00994                                            0994
*/*        ISSUE ERROR MESSAGE (MSGNOWRI) (UPRINT)                   */
*          DARGSENT = MSGNOWRI;                                    0996
         L     @06,DDSTRU                                          0996
         MVI   DARGSENT(@06),X'2F'                                 0996
*          DARGCNT = 2;                                            0997
         LA    @15,2                                               0997
         STH   @15,DARGCNT(,@06)                                   0997
*          DARGINS (1) = 1;                                        0998
         MVC   DARGINS(2,@06),@CH00165                             0998
*          DARGINL (1) = LENGTH (WTRADDRC);                        0999
         STH   @15,DARGINL(,@06)                                   0999
*          DARGDTM (1) = ADDR (WTRADDRC);                          1000
         L     @14,@PC00008                                        1000
         ST    @14,DARGDTM(,@06)                                   1000
*          DARGINS (2) = 2;                                        1001
         STH   @15,DARGINS+8(,@06)                                 1001
*          DARGINL (2) = LENGTH (WTRADDRT);                        1002
         STH   @15,DARGINL+8(,@06)                                 1002
*          DARGDTM (2) = ADDR (WTRADDRT);                          1003
         LA    @15,WTRADDRT(,@14)                                  1003
         ST    @15,DARGDTM+8(,@06)                                 1003
*          CALL ICKTPPR0 (GDTTBL                                   1004
*                 ,PRTFILE                                         1004
*                 ,DDSTRU);                                        1004
         L     @06,@PC00001                                        1004
         ST    @06,@AL00001                                        1004
         LA    @15,@CF00094                                        1004
         ST    @15,@AL00001+4                                      1004
         LA    @15,DDSTRU                                          1004
         ST    @15,@AL00001+8                                      1004
         MVI   @AL00001+8,X'80'                                    1004
         L     @15,GDTPRT(,@06)                                    1004
         LA    @01,@AL00001                                        1004
         BALR  @14,@15                                             1004
*/*        INDICATE AN ERROR (LASTCOND = 8)                          */
*          LASTCOND = MAX(LASTCC08,LASTCOND);                      1005
         L     @06,@PC00001+8                                      1005
         LH    @15,LASTCOND(,@06)                                  1005
         LA    @14,8                                               1005
         CR    @15,@14                                             1005
         BNL   *+6
         LR    @15,@14                                             1005
         STH   @15,LASTCOND(,@06)                                  1005
*/*        INDICATE THE PROCESSING FOR THIS TRACK IS NOT TO CONTINUE */
*          CNTFLAG = NOCONT;                                       1006
         NI    CNTFLAG,B'01111111'                                 1006
*          CALL ICKSAFP0 (GDTTBL                                   1007
*                 ,'ITRT');                                        1007
         L     @06,@PC00001                                        1007
         ST    @06,@AL00001                                        1007
         LA    @15,@CC00903                                        1007
         ST    @15,@AL00001+4                                      1007
         MVI   @AL00001+4,X'80'                                    1007
         L     @15,GDTFPL(,@06)                                    1007
         LA    @01,@AL00001                                        1007
         BALR  @14,@15                                             1007
*/*        RETURN                                                    */
*          RETURN;                                                 1008
@EL00008 DS    0H                                                  1008
@EF00008 DS    0H                                                  1008
@ER00008 LM    @14,@12,@SA00008                                    1008
         BR    @14                                                 1008
*/*        END-THEN                                                  */
*          END;                                                    1009
*/*      ELSE (WRITE OPERATION SUCCESSFUL)                           */
*        ELSE DO;                                                  1010
@RF00994 DS    0H                                                  1011
*          RESPECIFY RTRECORD BASED (RECTAPTR(I4));                1011
*/*        SAVE THE RECORD NUMBER FOR SEARCH ARGUMENT FOR NEXT WRITE */
*          PRECNUM = RCNTR;                                        1012
         LR    @06,I4                                              1012
         MH    @06,@CH00265                                        1012
         L     @03,RECPTR                                          1012
         AL    @03,@CF01068                                        1012
         L     @06,RECTAPTR(@06,@03)                               1012
         SLR   @03,@03                                             1012
         IC    @03,RCNTR(,@06)                                     1012
         ST    @03,PRECNUM                                         1012
*/*        END-ELSE (WRITE OPERATION SUCCESSFUL)                     */
*          END;                                                    1013
*/*  END-FOR                                                         */
*    END;                                                          1014
         AL    I4,@CF00165                                         1014
@DE00978 C     I4,RCDCNT                                           1014
         BNH   @DL00978                                            1014
*/*  END-SUB-PROCEDURE WRITE_TRACK_CONTENTS                          */
*    END WRITRACK;                                                 1015
*                                                                  1015
         B     @EL00008                                            1015
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  OBTTRST                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  OBTAIN TRACK STATUS                          */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL OBTAIN THE STATUS OF THE TRACK        */
*/*    AS INDICATED BY THE HOME-ADDRESS AND THE STANDARD-LENGTH      */
*/*    RECORD-ZERO. THIS STATUS IS OBTAINED BY INVOKING A DEVICE     */
*/*    ADAPTER FACILITY (UDEVOP).                                    */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1016
*                                                                  1016
*/*  SUB-PROCEDURE OBTAIN_TRACK_STATUS                               */
*    OBTTRST:                                                      1016
*      PROCEDURE                                                   1016
*        (                                                         1016
*        TRKADDR,                                                  1016
*        DFLAG,                                                    1016
*        RZADDR,                                                   1016
*        OBTRTYPE                                                  1016
*        );                                                        1016
OBTTRST  STM   @14,@12,@SA00009                                    1016
         MVC   @PC00009(16),0(@01)                                 1016
*    OLDERID2 = NEWERID2;                                          1017
         L     @06,@PC00001                                        1017
         L     @15,GDTTR2(,@06)                                    1017
         MVC   @TS00001(95),NEWERID2(@15)                          1017
         MVC   OLDERID2(95,@15),@TS00001                           1017
*    NEWID2 =  'ITOT';                                             1018
*                                                                  1018
         MVC   NEWID2(4,@15),@CC00930                              1018
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/
*                                                                  1019
*      1 TRKADDR,            /* ADDRESS OF TRACK TO BE EXAMINED      */
*                                                                  1019
*        2 TRKADDRC          /* CYLINDER NUMBER                      */
*                            FIXED (16),                           1019
*                                                                  1019
*        2 TRKADDRH          /* TRACK NUMBER                         */
*                            FIXED (16),                           1019
*                                                                  1019
*      DFLAG                 /* DEFECT-FLAG INDICATOR                */
*                            /* DEFECTIV: DEFECT-FLAG SET            */
*                            /* NODEFECT: DEFECT-FLAG NOT SET        */
*                            BIT (1),                              1019
*                                                                  1019
*      OBTRTYPE              /* FLAG TO INDICATE IF THE TRACK IS     */
*                            /* A PRIMARY OR AN ALTERNATE            */
*                            /* PRITRACK: PRIMARY                    */
*                            /* ALTTRACK: ALTERNATE                  */
*                            BIT (1),                              1019
*                                                                  1019
*      RETCODE4              /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31),                           1019
*                                                                  1019
*      RZADDR                /* CCHH FROM R0 COUNT FIELD             */
*                            CHAR(4);                              1019
*                                                                  1019
*/*  READ HOME-ADDRESS (TO OBTAIN THE DEFECT-FLAG) (UDEVOP)          */
*    CALL ICKDVOP0 (GDTTBL                                         1020
*           ,VOLIB                                                 1020
*           ,ACTRDHA                                               1020
*           ,TRKADDR                                               1020
*           ,RECNUM                                                1020
*           ,POOLID                                                1020
*           ,HAPTR                                                 1020
*           ,HALEN                                                 1020
*           ,RETCODE4);                                            1020
         ST    @06,@AL00001                                        1020
         LA    @15,VOLIB                                           1020
         ST    @15,@AL00001+4                                      1020
         LA    @15,@CF00165                                        1020
         ST    @15,@AL00001+8                                      1020
         L     @15,@PC00009                                        1020
         ST    @15,@AL00001+12                                     1020
         LA    @15,RECNUM                                          1020
         ST    @15,@AL00001+16                                     1020
         LA    @15,POOLID                                          1020
         ST    @15,@AL00001+20                                     1020
         LA    @15,HAPTR                                           1020
         ST    @15,@AL00001+24                                     1020
         LA    @15,HALEN                                           1020
         ST    @15,@AL00001+28                                     1020
         LA    @15,RETCODE4                                        1020
         ST    @15,@AL00001+32                                     1020
         L     @15,GDTDOP(,@06)                                    1020
         LA    @01,@AL00001                                        1020
         BALR  @14,@15                                             1020
*/*  IF READ OPERATION FAILS                                         */
*    IF RETCODE4 = CPFAILS                                         1021
*/*    THEN                                                          */
*      THEN DO;                                                    1021
*                                                                  1021
         CLC   RETCODE4(4),@CF00044                                1021
         BNE   @RF01021                                            1021
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        UNTRACK = TRKADDR;                                        1023
         L     @06,@PC00009                                        1023
         MVC   UNTRACK(4),TRKADDR(@06)                             1023
*        IF OBTRTYPE = PRITRACK                                    1024
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1024
         L     @06,@PC00009+12                                     1024
         TM    OBTRTYPE(@06),B'10000000'                           1024
         BNO   @RF01024                                            1024
         OI    UNTRTYPE,B'10000000'                                1026
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1028
         B     @RC01024                                            1028
@RF01024 DS    0H                                                  1029
         NI    UNTRTYPE,B'01111111'                                1029
*        CALL COUNTRKS;                                            1031
@RC01024 BAL   @14,COUNTRKS                                        1031
*/*      END-THEN                                                    */
*        END;                                                      1032
*/*    ELSE (TRACK WAS NOT UNRECOVERABLE)                            */
*      ELSE DO;                                                    1033
*                                                                  1033
         B     @RC01021                                            1033
@RF01021 DS    0H                                                  1034
*/*      IF THE DEFECT-FLAG IS FOUND TO BE SET                       */
*        IF (RETCODE4 = DFLAGONP)  (RETCODE4 = DFLAGONA)          1034
*/*        THEN SAVE THE DEFECT-FLAG SETTING                         */
*          THEN DO;    DFLAG = DEFECTIV; END;                      1034
         L     @06,RETCODE4                                        1034
         CH    @06,@CH00116                                        1034
         BE    @RT01034                                            1034
         CH    @06,@CH00119                                        1034
         BNE   @RF01034                                            1034
@RT01034 DS    0H                                                  1035
         L     @06,@PC00009+4                                      1036
         OI    DFLAG(@06),B'10000000'                              1036
*/*      IF THE DEFECT-FLAG IS FOUND NOT TO BE SET                   */
*        IF (RETCODE4 = DFLAGOFP)  (RETCODE4 = DFLAGOFA)          1038
*/*        THEN SAVE THE DEFECT-FLAG RE-SETTING                      */
*          THEN DO;    DFLAG = NODEFECT; END;                      1038
@RF01034 L     @06,RETCODE4                                        1038
         CH    @06,@CH00136                                        1038
         BE    @RT01038                                            1038
         CH    @06,@CH00185                                        1038
         BNE   @RF01038                                            1038
@RT01038 DS    0H                                                  1039
         L     @06,@PC00009+4                                      1040
         NI    DFLAG(@06),B'01111111'                              1040
*/*      READ STANDARD-LENGTH R0 (TO OBTAIN ASSOCIATION)             */
*        CALL ICKDVOP0 (GDTTBL                                     1042
*               ,VOLIB                                             1042
*               ,ACTRDRZ                                           1042
*               ,TRKADDR                                           1042
*               ,RECNUM                                            1042
*               ,'ITRZ'                                            1042
*               ,RZPTR                                             1042
*               ,RZLEN                                             1042
*               ,RETCODE4);                                        1042
@RF01038 L     @06,@PC00001                                        1042
         ST    @06,@AL00001                                        1042
         LA    @15,VOLIB                                           1042
         ST    @15,@AL00001+4                                      1042
         LA    @15,@CF00116                                        1042
         ST    @15,@AL00001+8                                      1042
         L     @15,@PC00009                                        1042
         ST    @15,@AL00001+12                                     1042
         LA    @15,RECNUM                                          1042
         ST    @15,@AL00001+16                                     1042
         LA    @15,@CC00935                                        1042
         ST    @15,@AL00001+20                                     1042
         LA    @15,RZPTR                                           1042
         ST    @15,@AL00001+24                                     1042
         LA    @15,RZLEN                                           1042
         ST    @15,@AL00001+28                                     1042
         LA    @15,RETCODE4                                        1042
         ST    @15,@AL00001+32                                     1042
         L     @15,GDTDOP(,@06)                                    1042
         LA    @01,@AL00001                                        1042
         BALR  @14,@15                                             1042
*/*      IF READ OPERATION FAILS                                     */
*        IF RETCODE4 = CPFAILS                                     1043
*/*        THEN                                                      */
*          THEN DO;                                                1043
*                                                                  1043
         CLC   RETCODE4(4),@CF00044                                1043
         BNE   @RF01043                                            1043
*/*          COUNT_UNRECOVERABLE_TRACKS                              */
*            UNTRACK = TRKADDR;                                    1045
         L     @06,@PC00009                                        1045
         MVC   UNTRACK(4),TRKADDR(@06)                             1045
*            IF OBTRTYPE = PRITRACK                                1046
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1046
         L     @06,@PC00009+12                                     1046
         TM    OBTRTYPE(@06),B'10000000'                           1046
         BNO   @RF01046                                            1046
         OI    UNTRTYPE,B'10000000'                                1048
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1050
         B     @RC01046                                            1050
@RF01046 DS    0H                                                  1051
         NI    UNTRTYPE,B'01111111'                                1051
*            CALL COUNTRKS;                                        1053
@RC01046 BAL   @14,COUNTRKS                                        1053
*/*          END-THEN                                                */
*            END;                                                  1054
*/*        ELSE                                                      */
*          ELSE DO;                                                1055
*                                                                  1055
         B     @RC01043                                            1055
@RF01043 DS    0H                                                  1056
*/*          SAVE THE ASSOCIATION ADDRESS                            */
*            RZADDR = RZADDROB;                                    1056
         L     @06,@PC00009+8                                      1056
         L     @01,RZPTR                                           1056
         MVC   RZADDR(4,@06),RZADDROB(@01)                         1056
*/*          IF THE DEFECT-FLAG IS SET DUE TO RECOVERY               */
*            IF (RETCODE4 = DFLAGONP)  (RETCODE4 = DFLAGONA)      1057
*/*            THEN SAVE THE DEFECT-FLAG SETTING                     */
*              THEN DO;    DFLAG = DEFECTIV; END;                  1057
         L     @06,RETCODE4                                        1057
         CH    @06,@CH00116                                        1057
         BE    @RT01057                                            1057
         CH    @06,@CH00119                                        1057
         BNE   @RF01057                                            1057
@RT01057 DS    0H                                                  1058
         L     @06,@PC00009+4                                      1059
         OI    DFLAG(@06),B'10000000'                              1059
*/*          END-ELSE                                                */
*            END;                                                  1061
@RF01057 DS    0H                                                  1062
*/*      FREE THE STORAGE OBTAINED BY UDEVOP                         */
*        CALL ICKSAFP0 (GDTTBL                                     1062
*               ,'ITRZ');                                          1062
@RC01043 L     @06,@PC00001                                        1062
         ST    @06,@AL00001                                        1062
         LA    @15,@CC00935                                        1062
         ST    @15,@AL00001+4                                      1062
         MVI   @AL00001+4,X'80'                                    1062
         L     @15,GDTFPL(,@06)                                    1062
         LA    @01,@AL00001                                        1062
         BALR  @14,@15                                             1062
*/*      END-ELSE (READ HA WAS SUCCESSFUL)                           */
*        END;                                                      1063
*/*  END-SUB-PROCEDURE OBTAIN_TRACK_STATUS                           */
*    END OBTTRST;                                                  1064
*                                                                  1064
*                                                                  1064
*                                                                  1064
@EL00009 DS    0H                                                  1064
@EF00009 DS    0H                                                  1064
@ER00009 LM    @14,@12,@SA00009                                    1064
         BR    @14                                                 1064
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  ASSGNALT                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE ASSIGN ALTERNATE TRACK                 */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION THAT       */
*/*    ASSIGNS AN ALTERNATE TRACK FOR A PRIMARY TRACK WHICH HAS      */
*/*    BEEN FOUND TO BE DEFECTIVE. HOWEVER, BEFORE THE INVOCATION    */
*/*    IT IS ASSURED THAT THE DEFECTIVE PRIMARY TRACK IS NOT         */
*/*    ALREADY ASSIGNED AN ALTERNATE TRACK.                          */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1065
*/*  SUB-PROCEDURE ISSUE_ASSIGN_ALTERNATE_TRACK                      */
*    ASSGNALT:                                                     1065
*      PROCEDURE;                                                  1065
*                                                                  1065
ASSGNALT STM   @14,@12,@SA00010                                    1065
*      DCL RETCODE5          /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31);                           1066
*                                                                  1066
*    OLDERID2 = NEWERID2;                                          1067
         L     @06,@PC00001                                        1067
         L     @06,GDTTR2(,@06)                                    1067
         MVC   @TS00001(95),NEWERID2(@06)                          1067
         MVC   OLDERID2(95,@06),@TS00001                           1067
*    NEWID2 =  'ITAA';                                             1068
         MVC   NEWID2(4,@06),@CC00940                              1068
*/*  IF NO SEVERE ERRORS WERE FOUND (LASTCOND < 12)                  */
*    IF LASTCOND < LASTCC12                                        1069
*/*    THEN                                                          */
*      THEN DO;                                                    1069
*                                                                  1069
         L     @06,@PC00001+8                                      1069
         LH    @06,LASTCOND(,@06)                                  1069
         CH    @06,@CH00265                                        1069
         BNL   @RF01069                                            1069
*/*      SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS               */
*        SALTCNT = ALTCOUNT;                                       1071
         L     SALTCNT,ALTCOUNT                                    1071
*/*      DO-UNTIL ASSIGNMENT IS SUCCESSFUL                           */
*        DO UNTIL (RETCODE5 = SUCCESS);                            1072
*                                                                  1072
@DL01072 DS    0H                                                  1073
*/*        ASSIGN_ALTERNATE_TRACK                                    */
*          CALL ICKAA01                                            1073
*               (GDTTBL                                            1073
*               ,VOLIB                                             1073
*               ,CTRADDR                                           1073
*               ,ALTCOUNT                                          1073
*               ,ALTPTR                                            1073
*               ,ALTRACK                                           1073
*               ,UNTRACK                                           1073
*               ,RETCODE5);                                        1073
         L     @06,@PC00001                                        1073
         ST    @06,@AL00001                                        1073
         LA    @06,VOLIB                                           1073
         ST    @06,@AL00001+4                                      1073
         LA    @06,CTRADDR                                         1073
         ST    @06,@AL00001+8                                      1073
         LA    @06,ALTCOUNT                                        1073
         ST    @06,@AL00001+12                                     1073
         LA    @06,ALTPTR                                          1073
         ST    @06,@AL00001+16                                     1073
         LA    @06,ALTRACK                                         1073
         ST    @06,@AL00001+20                                     1073
         LA    @06,UNTRACK                                         1073
         ST    @06,@AL00001+24                                     1073
         LA    @06,RETCODE5                                        1073
         ST    @06,@AL00001+28                                     1073
         L     @15,@CV00941                                        1073
         LA    @01,@AL00001                                        1073
         BALR  @14,@15                                             1073
*/*        IF ASSIGNMENT IS SUCCESSFUL                               */
*          IF RETCODE5 = SUCCESS                                   1074
*/*          THEN                                                    */
*            THEN DO;                                              1074
*                                                                  1074
         L     @06,RETCODE5                                        1074
         LTR   @06,@06                                             1074
         BNZ   @RF01074                                            1074
*/*            ISSUE MESSAGE ABOUT THE ASSIGNMENT (MSGALTA) (UPRINT) */
*              DARGSENT = MSGALTA;                                 1076
         L     @06,DDSTRU                                          1076
         MVI   DARGSENT(@06),X'11'                                 1076
*              DARGCNT = 4;                                        1077
         LA    @03,4                                               1077
         STH   @03,DARGCNT(,@06)                                   1077
*              DARGINS (1) = 1;                                    1078
         MVC   DARGINS(2,@06),@CH00165                             1078
*              DARGINL (1) = LENGTH (ALTRACKC);                    1079
         LA    @15,2                                               1079
         STH   @15,DARGINL(,@06)                                   1079
*              DARGDTM (1) = ADDR (ALTRACKC);                      1080
         LA    @14,ALTRACKC                                        1080
         ST    @14,DARGDTM(,@06)                                   1080
*              DARGINS (2) = 2;                                    1081
         STH   @15,DARGINS+8(,@06)                                 1081
*              DARGINL (2) = LENGTH (ALTRACKT);                    1082
         STH   @15,DARGINL+8(,@06)                                 1082
*              DARGDTM (2) = ADDR (ALTRACKT);                      1083
         LA    @14,ALTRACKT                                        1083
         ST    @14,DARGDTM+8(,@06)                                 1083
*              DARGINS (3) = 3;                                    1084
         MVC   DARGINS+16(2,@06),@CH00136                          1084
*              DARGINL (3) = LENGTH (CTRADDRC);                    1085
         STH   @15,DARGINL+16(,@06)                                1085
*              DARGDTM (3) = ADDR (CTRADDRC);                      1086
         LA    @14,CTRADDRC                                        1086
         ST    @14,DARGDTM+16(,@06)                                1086
*              DARGINS (4) = 4;                                    1087
         STH   @03,DARGINS+24(,@06)                                1087
*              DARGINL (4) = LENGTH (CTRADDRT);                    1088
         STH   @15,DARGINL+24(,@06)                                1088
*              DARGDTM (4) = ADDR (CTRADDRT);                      1089
         LA    @03,CTRADDRT                                        1089
         ST    @03,DARGDTM+24(,@06)                                1089
*              CALL ICKTPPR0 (GDTTBL                               1090
*                     ,PRTFILE                                     1090
*                     ,DDSTRU);                                    1090
         L     @06,@PC00001                                        1090
         ST    @06,@AL00001                                        1090
         LA    @03,@CF00094                                        1090
         ST    @03,@AL00001+4                                      1090
         LA    @03,DDSTRU                                          1090
         ST    @03,@AL00001+8                                      1090
         MVI   @AL00001+8,X'80'                                    1090
         L     @15,GDTPRT(,@06)                                    1090
         LA    @01,@AL00001                                        1090
         BALR  @14,@15                                             1090
*/*            ISSUE_BUILD_PACK_MAP                                  */
*              PACKDEF = DEFECTIV;                                 1091
         OI    PACKDEF,B'10000000'                                 1091
*              PACKCHEK = NODEFECT;                                1092
         NI    PACKCHEK,B'01111111'                                1092
*              PACKRCVR = RCVRYES;                                 1093
         NI    PACKRCVR,B'01111111'                                1093
*              PACKTRK = PRITRACK;                                 1094
         OI    PACKTRK,B'10000000'                                 1094
*              PACKTRAK = CTRADDR;                                 1095
         MVC   PACKTRAK(4),CTRADDR                                 1095
*              PACKASC = ALTRACK;                                  1096
         MVC   PACKASC(4),ALTRACK                                  1096
*              CALL BILDPACK;                                      1097
         BAL   @14,BILDPACK                                        1097
*/*            IF THE TRACK CONTENTS WERE READ                       */
*              IF TRKREAD = READYES                                1098
*/*              THEN WRITE_TRACK_CONTENTS (ON THE ASSIGNED ALT)     */
*                THEN DO;                                          1098
*                                                                  1098
         TM    TRKREAD,B'10000000'                                 1098
         BNO   @RF01098                                            1098
*                  CALL WRITRACK                                   1100
*                       (CTRADDR);                                 1100
         LA    @06,CTRADDR                                         1100
         ST    @06,@AL00001                                        1100
         LA    @01,@AL00001                                        1100
         BAL   @14,WRITRACK                                        1100
*                  END;                                            1101
*/*            IF NO MORE ALTERNATE TRACKS ARE AVAILABLE             */
*              IF ALTCOUNT <= 0                                    1102
*/*              THEN (NO MORE ASSIGNMENTS ARE POSSIBLE)             */
*                THEN DO;                                          1102
@RF01098 L     @06,ALTCOUNT                                        1102
         LTR   @06,@06                                             1102
         BP    @RF01102                                            1102
*/*                INDICATE NO MORE ASSIGNMENT ARE POSSIBLE          */
*                  ALTFLAG = MORENO;                               1104
         OI    ALTFLAG,B'10000000'                                 1104
*/*                ISSUE ERROR MESSAGE                               */
*                  DARGSENT = MSGALTB;                             1105
         L     @06,DDSTRU                                          1105
         MVI   DARGSENT(@06),X'12'                                 1105
*                  CALL ICKTPPR0 (GDTTBL                           1106
*                         ,PRTFILE                                 1106
*                         ,DDSTRU);                                1106
         L     @06,@PC00001                                        1106
         ST    @06,@AL00001                                        1106
         LA    @03,@CF00094                                        1106
         ST    @03,@AL00001+4                                      1106
         LA    @03,DDSTRU                                          1106
         ST    @03,@AL00001+8                                      1106
         MVI   @AL00001+8,X'80'                                    1106
         L     @15,GDTPRT(,@06)                                    1106
         LA    @01,@AL00001                                        1106
         BALR  @14,@15                                             1106
*/*                INDICATE AN ERROR (LASTCOND = 8)                  */
*                  LASTCOND = MAX(LASTCOND,LASTCC08);              1107
         L     @06,@PC00001+8                                      1107
         LH    @03,LASTCOND(,@06)                                  1107
         LA    @15,8                                               1107
         CR    @03,@15                                             1107
         BNL   *+6
         LR    @03,@15                                             1107
         STH   @03,LASTCOND(,@06)                                  1107
*/*                END-THEN                                          */
*                  END;                                            1108
*/*            IF PRIMARY TRACK WAS CYL 0 HEAD 0                     */
*              IF CTRADDR = 0                                      1109
*/*              THEN ISSUE MESSAGE                                  */
*                THEN DO;                                          1109
@RF01102 L     @06,CTRADDR                                         1109
         LTR   @06,@06                                             1109
         BNZ   @RF01109                                            1109
*                  DARGSENT = MSGFTRAK;                            1111
         L     @06,DDSTRU                                          1111
         MVI   DARGSENT(@06),X'30'                                 1111
*                  CALL ICKTPPR0 (GDTTBL                           1112
*                         ,PRTFILE                                 1112
*                         ,DDSTRU);                                1112
         L     @06,@PC00001                                        1112
         ST    @06,@AL00001                                        1112
         LA    @03,@CF00094                                        1112
         ST    @03,@AL00001+4                                      1112
         LA    @03,DDSTRU                                          1112
         ST    @03,@AL00001+8                                      1112
         MVI   @AL00001+8,X'80'                                    1112
         L     @15,GDTPRT(,@06)                                    1112
         LA    @01,@AL00001                                        1112
         BALR  @14,@15                                             1112
*                  END;                                            1113
*/*            LEAVE                                                 */
*              GOTO ENDLOOP1;                                      1114
         B     ENDLOOP1                                            1114
*/*            END-THEN                                              */
*              END;                                                1115
*/*          ELSE                                                    */
*            ELSE DO;                                              1116
*                                                                  1116
@RF01074 DS    0H                                                  1117
*/*            IF AN UNRECOVERABLE TRACK HAS BEEN FOUND              */
*              IF RETCODE5 = UNTRAAFF                              1117
*/*              THEN                                                */
*                THEN DO;                                          1117
*                                                                  1117
         CLC   RETCODE5(4),@CF00044                                1117
         BNE   @RF01117                                            1117
*/*                COUNT_UNRECOVERABLE_TRACKS                        */
*                  UNTRTYPE = ALTTRACK;                            1119
         NI    UNTRTYPE,B'01111111'                                1119
*                  CALL COUNTRKS;                                  1120
         BAL   @14,COUNTRKS                                        1120
*/*                IF A SEVERE ERROR HAS OCCURRED                    */
*                  IF LASTCOND >= LASTCC12                         1121
*/*                  THEN LEAVE                                      */
*                    THEN DO;    GOTO ENDLOOP1; END;               1121
         L     @06,@PC00001+8                                      1121
         LH    @06,LASTCOND(,@06)                                  1121
         CH    @06,@CH00265                                        1121
         BL    @RF01121                                            1121
         B     ENDLOOP1                                            1123
*/*                END-THEN                                          */
*                  END;                                            1125
@RF01121 DS    0H                                                  1126
*/*            IF THERE ARE NO ALTERNATES LEFT                       */
*              IF RETCODE5 = NOALTS                                1126
*/*              THEN                                                */
*                THEN DO;                                          1126
*                                                                  1126
@RF01117 CLC   RETCODE5(4),@CF00165                                1126
         BNE   @RF01126                                            1126
*/*                ISSUE ERROR MESSAGE (MSGALTB) (UPRINT)            */
*                  DARGSENT = MSGALTB;                             1128
         L     @06,DDSTRU                                          1128
         MVI   DARGSENT(@06),X'12'                                 1128
*                  CALL ICKTPPR0 (GDTTBL                           1129
*                         ,PRTFILE                                 1129
*                         ,DDSTRU);                                1129
         L     @06,@PC00001                                        1129
         ST    @06,@AL00001                                        1129
         LA    @03,@CF00094                                        1129
         ST    @03,@AL00001+4                                      1129
         LA    @03,DDSTRU                                          1129
         ST    @03,@AL00001+8                                      1129
         MVI   @AL00001+8,X'80'                                    1129
         L     @15,GDTPRT(,@06)                                    1129
         LA    @01,@AL00001                                        1129
         BALR  @14,@15                                             1129
*/*                INDICATE AN ERROR (LASTCOND = 8)                  */
*                  LASTCOND = MAX(LASTCOND,LASTCC08);              1130
         L     @06,@PC00001+8                                      1130
         LH    @03,LASTCOND(,@06)                                  1130
         LA    @15,8                                               1130
         CR    @03,@15                                             1130
         BNL   *+6
         LR    @03,@15                                             1130
         STH   @03,LASTCOND(,@06)                                  1130
*/*                INDICATE THERE ARE NO MORE ALTERNATES AVAILABLE   */
*                  ALTFLAG = MORENO;                               1131
         OI    ALTFLAG,B'10000000'                                 1131
*/*                LEAVE                                             */
*                  GOTO ENDLOOP1;                                  1132
         B     ENDLOOP1                                            1132
*/*                END-THEN                                          */
*                  END;                                            1133
*/*            IF ASSOCIATION OF THE ALTERNATE TO THE PRIMARY FAILS  */
*              IF RETCODE5 = NOPASSOC                              1134
*/*              THEN                                                */
*                THEN DO;                                          1134
*                                                                  1134
@RF01126 CLC   RETCODE5(4),@CF00116                                1134
         BNE   @RF01134                                            1134
*/*                COUNT_UNRECOVERABLE_TRACKS                        */
*                  UNTRACK = CTRADDR;                              1136
         MVC   UNTRACK(4),CTRADDR                                  1136
*                  UNTRTYPE = PRITRACK;                            1137
         OI    UNTRTYPE,B'10000000'                                1137
*                  CALL COUNTRKS;                                  1138
         BAL   @14,COUNTRKS                                        1138
*/*                LEAVE                                             */
*                  GOTO ENDLOOP1;                                  1139
         B     ENDLOOP1                                            1139
*/*                END-THEN                                          */
*                  END;                                            1140
*/*            IF ASSOCIATION OF THE PRIMARY TO THE ALTERNATE FAILS  */
*              IF RETCODE5 = NOAASSOC                              1141
*/*              THEN                                                */
*                THEN DO;                                          1141
*                                                                  1141
@RF01134 CLC   RETCODE5(4),@CF00136                                1141
         BNE   @RF01141                                            1141
*/*                COUNT_UNRECOVERABLE_TRACKS                        */
*                  UNTRTYPE = ALTTRACK;                            1143
         NI    UNTRTYPE,B'01111111'                                1143
*                  CALL COUNTRKS;                                  1144
         BAL   @14,COUNTRKS                                        1144
*/*                IF A SEVERE ERROR HAS OCCURRED                    */
*                  IF LASTCOND >= LASTCC12                         1145
*/*                  THEN LEAVE                                      */
*                    THEN DO;    GOTO ENDLOOP1; END;               1145
         L     @06,@PC00001+8                                      1145
         LH    @06,LASTCOND(,@06)                                  1145
         CH    @06,@CH00265                                        1145
         BL    @RF01145                                            1145
         B     ENDLOOP1                                            1147
*/*                END-THEN                                          */
*                  END;                                            1149
@RF01145 DS    0H                                                  1150
*/*          END-ELSE (ASSIGNMENT UNSUCCESSFUL)                      */
*            END;                                                  1150
@RF01141 DS    0H                                                  1151
*/*      END-UNTIL                                                   */
*        END;                                                      1151
@DE01072 L     @06,RETCODE5                                        1151
         LTR   @06,@06                                             1151
         BNZ   @DL01072                                            1151
*        ENDLOOP1:                                                 1152
*/*      IF THE NUMBER OF AVAILABLE ALTERNATE TRACKS WAS DECREMENTED */
*        IF ALTCOUNT = SALTCNT - 1                                 1152
*/*        THEN UPDATE THE VTOC VALUE ALSO                           */
*          THEN DO;    TALCNT = TALCNT - 1; END;                   1152
ENDLOOP1 LR    @06,SALTCNT                                         1152
         BCTR  @06,0                                               1152
         C     @06,ALTCOUNT                                        1152
         BNE   @RF01152                                            1152
         L     @06,TALCNT                                          1154
         BCTR  @06,0                                               1154
         ST    @06,TALCNT                                          1154
*/*      IF ASSIGNMENT WAS UNSUCCESSFUL BUT THE PRIMARY TRACK IS     */
*/*       STILL RECOVERABLE                                          */
*        IF ((RETCODE5 = NOALTS)  (RETCODE5 = NOAASSOC))          1156
*/*        THEN                                                      */
*          THEN DO;                                                1156
*                                                                  1156
@RF01152 L     @06,RETCODE5                                        1156
         CH    @06,@CH00165                                        1156
         BE    @RT01156                                            1156
         CH    @06,@CH00136                                        1156
         BNE   @RF01156                                            1156
@RT01156 DS    0H                                                  1157
*/*          IF TRACK CONTENTS WERE READ                             */
*            IF TRKREAD = READYES                                  1158
*/*            THEN                                                  */
*              THEN DO;                                            1158
*                                                                  1158
         TM    TRKREAD,B'10000000'                                 1158
         BNO   @RF01158                                            1158
*/*              ISSUE_MARK_TRACK_NON-DEFECTIVE                      */
*                CALL WRIHARZ;                                     1160
         BAL   @14,WRIHARZ                                         1160
*/*              IF SUB-PROCEDURE WAS SUCCESSFUL                     */
*                IF SPROCODE = SUCCESS                             1161
*/*                THEN                                              */
*                  THEN DO;                                        1161
*                                                                  1161
         LTR   SPROCODE,SPROCODE                                   1161
         BNZ   @RF01161                                            1161
*/*                  WRITE_TRACK_CONTENTS (BACK ON THE PRIMARY)      */
*                    CALL WRITRACK (CTRADDR);                      1163
         LA    @06,CTRADDR                                         1163
         ST    @06,@AL00001                                        1163
         LA    @01,@AL00001                                        1163
         BAL   @14,WRITRACK                                        1163
*/*                  ISSUE MESSAGE (MSGALTE) (UPRINT)                */
*                    DARGSENT = MSGALTE;                           1164
         L     @06,DDSTRU                                          1164
         MVI   DARGSENT(@06),X'27'                                 1164
*                    DARGCNT = 2;                                  1165
         LA    @15,2                                               1165
         STH   @15,DARGCNT(,@06)                                   1165
*                    DARGINS (1) = 1;                              1166
         MVC   DARGINS(2,@06),@CH00165                             1166
*                    DARGINL (1) = LENGTH (CTRADDRC);              1167
         STH   @15,DARGINL(,@06)                                   1167
*                    DARGDTM (1) = ADDR (CTRADDRC);                1168
         LA    @14,CTRADDRC                                        1168
         ST    @14,DARGDTM(,@06)                                   1168
*                    DARGINS (2) = 2;                              1169
         STH   @15,DARGINS+8(,@06)                                 1169
*                    DARGINL (2) = LENGTH (CTRADDRT);              1170
         STH   @15,DARGINL+8(,@06)                                 1170
*                    DARGDTM (2) = ADDR (CTRADDRT);                1171
         LA    @15,CTRADDRT                                        1171
         ST    @15,DARGDTM+8(,@06)                                 1171
*                    CALL ICKTPPR0 (GDTTBL                         1172
*                           ,PRTFILE                               1172
*                           ,DDSTRU);                              1172
         L     @06,@PC00001                                        1172
         ST    @06,@AL00001                                        1172
         LA    @15,@CF00094                                        1172
         ST    @15,@AL00001+4                                      1172
         LA    @15,DDSTRU                                          1172
         ST    @15,@AL00001+8                                      1172
         MVI   @AL00001+8,X'80'                                    1172
         L     @15,GDTPRT(,@06)                                    1172
         LA    @01,@AL00001                                        1172
         BALR  @14,@15                                             1172
*/*                  RETURN                                          */
*                    RETURN;                                       1173
@EL00010 DS    0H                                                  1173
@EF00010 DS    0H                                                  1173
@ER00010 LM    @14,@12,@SA00010                                    1173
         BR    @14                                                 1173
*/*                  END-THEN                                        */
*                    END;                                          1174
*/*                ELSE                                              */
*                  ELSE DO;                                        1175
*                                                                  1175
@RF01161 DS    0H                                                  1176
*/*                  IF SUB-PROCEDURE FAILS BUT TRACK RECOVERED      */
*                    IF SPROCODE = FAILRCV                         1176
*/*                    THEN                                          */
*                      THEN DO;                                    1176
*                                                                  1176
         LA    @06,1                                               1176
         CR    SPROCODE,@06                                        1176
         BNE   @RF01176                                            1176
*/*                      ISSUE ERROR MESSAGE (MSGALTF) (UPRINT)      */
*                        DARGSENT = MSGALTF;                       1178
         L     @15,DDSTRU                                          1178
         MVI   DARGSENT(@15),X'28'                                 1178
*                        DARGCNT = 2;                              1179
         LA    @14,2                                               1179
         STH   @14,DARGCNT(,@15)                                   1179
*                        DARGINS (1) = 1;                          1180
         STH   @06,DARGINS(,@15)                                   1180
*                        DARGINL (1) = LENGTH (CTRADDRC);          1181
         STH   @14,DARGINL(,@15)                                   1181
*                        DARGDTM (1) = ADDR (CTRADDRC);            1182
         LA    @06,CTRADDRC                                        1182
         ST    @06,DARGDTM(,@15)                                   1182
*                        DARGINS (2) = 2;                          1183
         STH   @14,DARGINS+8(,@15)                                 1183
*                        DARGINL (2) = LENGTH (CTRADDRT);          1184
         STH   @14,DARGINL+8(,@15)                                 1184
*                        DARGDTM (2) = ADDR (CTRADDRT);            1185
         LA    @06,CTRADDRT                                        1185
         ST    @06,DARGDTM+8(,@15)                                 1185
*                        CALL ICKTPPR0 (GDTTBL                     1186
*                               ,PRTFILE                           1186
*                               ,DDSTRU);                          1186
         L     @06,@PC00001                                        1186
         ST    @06,@AL00001                                        1186
         LA    @15,@CF00094                                        1186
         ST    @15,@AL00001+4                                      1186
         LA    @15,DDSTRU                                          1186
         ST    @15,@AL00001+8                                      1186
         MVI   @AL00001+8,X'80'                                    1186
         L     @15,GDTPRT(,@06)                                    1186
         LA    @01,@AL00001                                        1186
         BALR  @14,@15                                             1186
*/*                      RETURN                                      */
*                        RETURN;                                   1187
         B     @EL00010                                            1187
*/*                      END-THEN                                    */
*                        END;                                      1188
*/*                  END-ELSE                                        */
*                    END;                                          1189
@RF01176 DS    0H                                                  1190
*/*              END-THEN (TRACK CONTENTS WERE READ)                 */
*                END;                                              1190
*/*          END-THEN (ASSIGNMENT UNSUCCESSFUL BUT PRIMARY OKAY)     */
*            END;                                                  1191
*/*      END-THEN                                                    */
*        END;                                                      1192
*/*  END-SUB-PROCEDURE ISSUE_ASSIGN_ALTERNATE_TRACK                  */
*    END ASSGNALT;                                                 1193
*                                                                  1193
*                                                                  1193
         B     @EL00010                                            1193
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  RASGNALT                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE RE-ASSIGN ALTERNATE TRACK              */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION WHICH      */
*/*    RE-ASSIGNS AN ALTERNATE TRACK FOR A SUSPECT PRIMARY TRACK     */
*/*    WHEN  IT HAS BEEN ESTABLISHED THAT THE ALTERNATE TRACK        */
*/*    THAT IS CURRENTLY ASSIGNED TO THE PRIMARY TRACK IS ITSELF     */
*/*    DEFECTIVE. HOWEVER, THIS IS DONE ONLY IF THE ALTERNATE TRACK  */
*/*    IS INDEED ASSOCIATED WITH A PRIMARY TRACK.                    */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1194
*/*  SUB-PROCEDURE ISSUE_RE-ASSIGN_ALTERNATE_TRACK                   */
*    RASGNALT:                                                     1194
*      PROCEDURE;                                                  1194
*                                                                  1194
RASGNALT STM   @14,@12,@SA00011                                    1194
*      DCL RETCODE6          /* RETUIRN CODE FROM CALLED PROGRAMS    */
*                            FIXED (31);                           1195
*                                                                  1195
*    OLDERID2 = NEWERID2;                                          1196
         L     @06,@PC00001                                        1196
         L     @06,GDTTR2(,@06)                                    1196
         MVC   @TS00001(95),NEWERID2(@06)                          1196
         MVC   OLDERID2(95,@06),@TS00001                           1196
*    NEWID2 =  'ITRS';                                             1197
         MVC   NEWID2(4,@06),@CC00949                              1197
*/*  IF NO SEVERE ERRORS WERE FOUND (LASTCOND < 12)                  */
*    IF LASTCOND < LASTCC12                                        1198
*/*    THEN                                                          */
*      THEN DO;                                                    1198
*                                                                  1198
         L     @06,@PC00001+8                                      1198
         LH    @06,LASTCOND(,@06)                                  1198
         CH    @06,@CH00265                                        1198
         BNL   @RF01198                                            1198
*/*      SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS               */
*        SALTCNT = ALTCOUNT;                                       1200
         L     SALTCNT,ALTCOUNT                                    1200
*/*      DO-UNTIL RE-ASSIGNMENT IS SUCCESSFUL                        */
*        DO UNTIL (RETCODE6 = SUCCESS);                            1201
*                                                                  1201
@DL01201 DS    0H                                                  1202
*/*        RE-ASSIGN_ALTERNATE_TRACK                                 */
*          CALL ICKRA01                                            1202
*               (GDTTBL                                            1202
*               ,VOLIB                                             1202
*               ,RZCCHH                                            1202
*               ,CTRADDR                                           1202
*               ,ALTCOUNT                                          1202
*               ,ALTPTR                                            1202
*               ,ALTRACK                                           1202
*               ,UNTRACK                                           1202
*               ,RETCODE6);                                        1202
         L     @06,@PC00001                                        1202
         ST    @06,@AL00001                                        1202
         LA    @06,VOLIB                                           1202
         ST    @06,@AL00001+4                                      1202
         LA    @06,RZCCHH                                          1202
         ST    @06,@AL00001+8                                      1202
         LA    @06,CTRADDR                                         1202
         ST    @06,@AL00001+12                                     1202
         LA    @06,ALTCOUNT                                        1202
         ST    @06,@AL00001+16                                     1202
         LA    @06,ALTPTR                                          1202
         ST    @06,@AL00001+20                                     1202
         LA    @06,ALTRACK                                         1202
         ST    @06,@AL00001+24                                     1202
         LA    @06,UNTRACK                                         1202
         ST    @06,@AL00001+28                                     1202
         LA    @06,RETCODE6                                        1202
         ST    @06,@AL00001+32                                     1202
         L     @15,@CV00950                                        1202
         LA    @01,@AL00001                                        1202
         BALR  @14,@15                                             1202
*/*        IF RE-ASSIGNMENT IS SUCCESSFUL                            */
*          IF RETCODE6 = SUCCESS                                   1203
*/*          THEN                                                    */
*            THEN DO;                                              1203
*                                                                  1203
         L     @06,RETCODE6                                        1203
         LTR   @06,@06                                             1203
         BNZ   @RF01203                                            1203
*/*            ISSUE MESSAGE ABOUT THE RE-ASSIGNMENT (MSGALTC)       */
*/*             (UPRINT)                                             */
*              DARGSENT = MSGALTC;                                 1205
         L     @06,DDSTRU                                          1205
         MVI   DARGSENT(@06),X'13'                                 1205
*              DARGCNT = 4;                                        1206
         LA    @03,4                                               1206
         STH   @03,DARGCNT(,@06)                                   1206
*              DARGINS (1) = 1;                                    1207
         MVC   DARGINS(2,@06),@CH00165                             1207
*              DARGINL (1) = LENGTH (ALTRACKC);                    1208
         LA    @15,2                                               1208
         STH   @15,DARGINL(,@06)                                   1208
*              DARGDTM (1) = ADDR (ALTRACKC);                      1209
         LA    @14,ALTRACKC                                        1209
         ST    @14,DARGDTM(,@06)                                   1209
*              DARGINS (2) = 2;                                    1210
         STH   @15,DARGINS+8(,@06)                                 1210
*              DARGINL (2) = LENGTH (ALTRACKT);                    1211
         STH   @15,DARGINL+8(,@06)                                 1211
*              DARGDTM (2) = ADDR (ALTRACKT);                      1212
         LA    @14,ALTRACKT                                        1212
         ST    @14,DARGDTM+8(,@06)                                 1212
*              DARGINS (3) = 3;                                    1213
         MVC   DARGINS+16(2,@06),@CH00136                          1213
*              DARGINL (3) = LENGTH (RZCCHHC);                     1214
         STH   @15,DARGINL+16(,@06)                                1214
*              DARGDTM (3) = ADDR (RZCCHHC);                       1215
         LA    @14,RZCCHHC                                         1215
         ST    @14,DARGDTM+16(,@06)                                1215
*              DARGINS (4) = 4;                                    1216
         STH   @03,DARGINS+24(,@06)                                1216
*              DARGINL (4) = LENGTH (RZCCHHT);                     1217
         STH   @15,DARGINL+24(,@06)                                1217
*              DARGDTM (4) = ADDR (RZCCHHT);                       1218
         LA    @03,RZCCHHT                                         1218
         ST    @03,DARGDTM+24(,@06)                                1218
*              CALL ICKTPPR0 (GDTTBL                               1219
*                     ,PRTFILE                                     1219
*                     ,DDSTRU);                                    1219
         L     @06,@PC00001                                        1219
         ST    @06,@AL00001                                        1219
         LA    @03,@CF00094                                        1219
         ST    @03,@AL00001+4                                      1219
         LA    @03,DDSTRU                                          1219
         ST    @03,@AL00001+8                                      1219
         MVI   @AL00001+8,X'80'                                    1219
         L     @15,GDTPRT(,@06)                                    1219
         LA    @01,@AL00001                                        1219
         BALR  @14,@15                                             1219
*/*            ISSUE_BUILD_PACK_MAP                                  */
*              PACKDEF = DEFECTIV;                                 1220
         OI    PACKDEF,B'10000000'                                 1220
*              PACKCHEK = NODEFECT;                                1221
         NI    PACKCHEK,B'01111111'                                1221
*              PACKRCVR = RCVRYES;                                 1222
         NI    PACKRCVR,B'01111111'                                1222
*              PACKTRK = PRITRACK;                                 1223
         OI    PACKTRK,B'10000000'                                 1223
*              PACKTRAK = RZCCHH;                                  1224
         MVC   PACKTRAK(4),RZCCHH                                  1224
*              PACKASC = ALTRACK;                                  1225
         MVC   PACKASC(4),ALTRACK                                  1225
*              CALL BILDPACK;                                      1226
         BAL   @14,BILDPACK                                        1226
*/*            IF NO MORE ALTERNATE TRACKS ARE AVAILABLE             */
*              IF ALTCOUNT <= 0                                    1227
*/*              THEN ( NO MORE ASSIGNMENTS ARE POSSIBLE )           */
*                THEN DO;                                          1227
         L     @06,ALTCOUNT                                        1227
         LTR   @06,@06                                             1227
         BP    @RF01227                                            1227
*/*                INDICATE NO MORE ASSIGNMENT ARE POSSIBLE          */
*                  ALTFLAG = MORENO;                               1229
         OI    ALTFLAG,B'10000000'                                 1229
*/*                ISSUE ERROR MESSAGE                               */
*                  DARGSENT = MSGALTB;                             1230
         L     @06,DDSTRU                                          1230
         MVI   DARGSENT(@06),X'12'                                 1230
*                  CALL ICKTPPR0 (GDTTBL                           1231
*                         ,PRTFILE                                 1231
*                         ,DDSTRU);                                1231
         L     @06,@PC00001                                        1231
         ST    @06,@AL00001                                        1231
         LA    @03,@CF00094                                        1231
         ST    @03,@AL00001+4                                      1231
         LA    @03,DDSTRU                                          1231
         ST    @03,@AL00001+8                                      1231
         MVI   @AL00001+8,X'80'                                    1231
         L     @15,GDTPRT(,@06)                                    1231
         LA    @01,@AL00001                                        1231
         BALR  @14,@15                                             1231
*/*                INDICATE AN ERROR (LASTCOND = 8)                  */
*                  LASTCOND = MAX(LASTCOND,LASTCC08);              1232
         L     @06,@PC00001+8                                      1232
         LH    @03,LASTCOND(,@06)                                  1232
         LA    @15,8                                               1232
         CR    @03,@15                                             1232
         BNL   *+6
         LR    @03,@15                                             1232
         STH   @03,LASTCOND(,@06)                                  1232
*/*                END-THEN                                          */
*                  END;                                            1233
*/*            IF PRIMARY TRACK WAS CYL 0 HEAD 0                     */
*              IF RZCCHH = 0                                       1234
*/*              THEN ISSUE MESSAGE                                  */
*                THEN DO;                                          1234
@RF01227 L     @06,RZCCHH                                          1234
         LTR   @06,@06                                             1234
         BNZ   @RF01234                                            1234
*                  DARGSENT = MSGFTRAK;                            1236
         L     @06,DDSTRU                                          1236
         MVI   DARGSENT(@06),X'30'                                 1236
*                  CALL ICKTPPR0 (GDTTBL                           1237
*                         ,PRTFILE                                 1237
*                         ,DDSTRU);                                1237
         L     @06,@PC00001                                        1237
         ST    @06,@AL00001                                        1237
         LA    @03,@CF00094                                        1237
         ST    @03,@AL00001+4                                      1237
         LA    @03,DDSTRU                                          1237
         ST    @03,@AL00001+8                                      1237
         MVI   @AL00001+8,X'80'                                    1237
         L     @15,GDTPRT(,@06)                                    1237
         LA    @01,@AL00001                                        1237
         BALR  @14,@15                                             1237
*                  END;                                            1238
*/*            LEAVE                                                 */
*              GOTO ENDLOOP2;                                      1239
         B     ENDLOOP2                                            1239
*/*            END-THEN                                              */
*              END;                                                1240
*/*          ELSE (RE-ASSIGNMENT UNSUCCESSFUL)                       */
*            ELSE DO;                                              1241
*                                                                  1241
@RF01203 DS    0H                                                  1242
*/*            IF AN UNRECOVERABLE TRACK HAS BEEN FOUND              */
*              IF RETCODE6 = UNTRRAFF                              1242
*/*              THEN                                                */
*                THEN DO;                                          1242
*                                                                  1242
         CLC   RETCODE6(4),@CF00255                                1242
         BNE   @RF01242                                            1242
*/*                COUNT_UNRECOVERABLE_TRACKS                        */
*                  UNTRTYPE = ALTTRACK;                            1244
         NI    UNTRTYPE,B'01111111'                                1244
*                  CALL COUNTRKS;                                  1245
         BAL   @14,COUNTRKS                                        1245
*/*                IF A SEVERE ERROR HAS OCCURRED                    */
*                  IF LASTCOND >= LASTCC12                         1246
*/*                  THEN LEAVE                                      */
*                    THEN DO;    GOTO ENDLOOP2; END;               1246
         L     @06,@PC00001+8                                      1246
         LH    @06,LASTCOND(,@06)                                  1246
         CH    @06,@CH00265                                        1246
         BL    @RF01246                                            1246
         B     ENDLOOP2                                            1248
*/*                END-THEN                                          */
*                  END;                                            1250
@RF01246 DS    0H                                                  1251
*/*            IF THERE ARE NO MORE ALTERNATES                       */
*              IF RETCODE6 = NOALTS                                1251
*/*              THEN                                                */
*                THEN DO;                                          1251
*                                                                  1251
@RF01242 CLC   RETCODE6(4),@CF00165                                1251
         BNE   @RF01251                                            1251
*/*                ISSUE ERROR MESSAGE (MSGALTB) (UPRINT)            */
*                  DARGSENT = MSGALTB;                             1253
         L     @06,DDSTRU                                          1253
         MVI   DARGSENT(@06),X'12'                                 1253
*                  CALL ICKTPPR0 (GDTTBL                           1254
*                         ,PRTFILE                                 1254
*                         ,DDSTRU);                                1254
         L     @06,@PC00001                                        1254
         ST    @06,@AL00001                                        1254
         LA    @03,@CF00094                                        1254
         ST    @03,@AL00001+4                                      1254
         LA    @03,DDSTRU                                          1254
         ST    @03,@AL00001+8                                      1254
         MVI   @AL00001+8,X'80'                                    1254
         L     @15,GDTPRT(,@06)                                    1254
         LA    @01,@AL00001                                        1254
         BALR  @14,@15                                             1254
*/*                INDICATE AN ERROR (LASTCOND = 8)                  */
*                  LASTCOND = MAX(LASTCOND,LASTCC08);              1255
         L     @06,@PC00001+8                                      1255
         LH    @03,LASTCOND(,@06)                                  1255
         LA    @15,8                                               1255
         CR    @03,@15                                             1255
         BNL   *+6
         LR    @03,@15                                             1255
         STH   @03,LASTCOND(,@06)                                  1255
*/*                INDICATE THERE ARE NO MORE ALTERNATES AVAILABLE   */
*                  ALTFLAG = MORENO;                               1256
         OI    ALTFLAG,B'10000000'                                 1256
*/*                LEAVE                                             */
*                  GOTO ENDLOOP2;                                  1257
         B     ENDLOOP2                                            1257
*/*                END-THEN                                          */
*                  END;                                            1258
*/*            IF ASSOCIATION OF THE NEW ALTERNATE TO THE PRIMARY FAI*/
*              IF RETCODE6 = NOPASSOC                              1259
*/*              THEN                                                */
*                THEN DO;                                          1259
*                                                                  1259
@RF01251 CLC   RETCODE6(4),@CF00116                                1259
         BNE   @RF01259                                            1259
*/*                COUNT_UNRECOVERABLE_TRACKS                        */
*                  UNTRACK = RZCCHH;                               1261
         MVC   UNTRACK(4),RZCCHH                                   1261
*                  UNTRTYPE = PRITRACK;                            1262
         OI    UNTRTYPE,B'10000000'                                1262
*                  CALL COUNTRKS;                                  1263
         BAL   @14,COUNTRKS                                        1263
*/*                LEAVE                                             */
*                  GOTO ENDLOOP2;                                  1264
         B     ENDLOOP2                                            1264
*/*                END-THEN                                          */
*                  END;                                            1265
*/*            IF ASSOCIATION OF THE PRIMARY TO THE NEW ALTERNATE FAI*/
*              IF RETCODE6 = NOAASSOC                              1266
*/*              THEN                                                */
*                THEN DO;                                          1266
*                                                                  1266
@RF01259 CLC   RETCODE6(4),@CF00136                                1266
         BNE   @RF01266                                            1266
*/*                COUNT_UNRECOVERABLE_TRACKS                        */
*                  UNTRTYPE = ALTTRACK;                            1268
         NI    UNTRTYPE,B'01111111'                                1268
*                  CALL COUNTRKS;                                  1269
         BAL   @14,COUNTRKS                                        1269
*/*                IF A  SEVERE ERROR HAS OCCURRED                   */
*                  IF LASTCOND >= LASTCC12                         1270
*/*                  THEN LEAVE                                      */
*                    THEN DO;    GOTO ENDLOOP2; END;               1270
         L     @06,@PC00001+8                                      1270
         LH    @06,LASTCOND(,@06)                                  1270
         CH    @06,@CH00265                                        1270
         BL    @RF01270                                            1270
         B     ENDLOOP2                                            1272
*/*                END-THEN                                          */
*                  END;                                            1274
@RF01270 DS    0H                                                  1275
*/*            IF DISSOCIATION OF THE OLD ALTERNATE                  */
*/*             FROM THE PRIMARY FAILS                               */
*              IF RETCODE6 = NODISSOC                              1275
*/*              THEN                                                */
*                THEN DO;                                          1275
*                                                                  1275
@RF01266 CLC   RETCODE6(4),@CF00044                                1275
         BNE   @RF01275                                            1275
*/*                COUNT_UNRECOVERABLE_TRACKS                        */
*                  UNTRACK = CTRADDR;                              1277
         MVC   UNTRACK(4),CTRADDR                                  1277
*                  UNTRTYPE = ALTTRACK;                            1278
         NI    UNTRTYPE,B'01111111'                                1278
*                  CALL COUNTRKS;                                  1279
         BAL   @14,COUNTRKS                                        1279
*/*                IF A SEVERE ERROR HAS OCCURRED                    */
*                  IF LASTCOND >= LASTCC12                         1280
*/*                  THEN LEAVE                                      */
*                  THEN DO;    GOTO ENDLOOP2; END;                 1280
         L     @06,@PC00001+8                                      1280
         LH    @06,LASTCOND(,@06)                                  1280
         CH    @06,@CH00265                                        1280
         BL    @RF01280                                            1280
         B     ENDLOOP2                                            1282
*/*                END-THEN                                          */
*                  END;                                            1284
@RF01280 DS    0H                                                  1285
*/*            END-ELSE (RE-ASSIGNMENT UNSUCCESSFUL)                 */
*              END;                                                1285
@RF01275 DS    0H                                                  1286
*/*      END-UNTIL                                                   */
*        END;                                                      1286
@DE01201 L     @06,RETCODE6                                        1286
         LTR   @06,@06                                             1286
         BNZ   @DL01201                                            1286
*        ENDLOOP2:                                                 1287
*/*      IF THE NUMBER OF AVAILABLE ALTERNATE TRACKS WAS DECREMENTED */
*        IF ALTCOUNT = SALTCNT - 1                                 1287
*/*        THEN UPDATE THE VTOC VALUE ALSO                           */
*          THEN DO;    TALCNT = TALCNT - 1; END;                   1287
ENDLOOP2 LR    @06,SALTCNT                                         1287
         BCTR  @06,0                                               1287
         C     @06,ALTCOUNT                                        1287
         BNE   @RF01287                                            1287
         L     @06,TALCNT                                          1289
         BCTR  @06,0                                               1289
         ST    @06,TALCNT                                          1289
*/*      IF ASSIGNMENT WAS UNSUCCESSFUL BUT THE OLD ALTERNATE TRACK  */
*/*       IS STILL RECOVERABLE                                       */
*        IF (RETCODE6 = NOALTS)  (RETCODE6 = NOAASSOC)            1291
*/*        THEN                                                      */
*          THEN DO;                                                1291
*                                                                  1291
@RF01287 L     @06,RETCODE6                                        1291
         CH    @06,@CH00165                                        1291
         BE    @RT01291                                            1291
         CH    @06,@CH00136                                        1291
         BNE   @RF01291                                            1291
@RT01291 DS    0H                                                  1292
*/*          IF TRACK CONTENTS WERE READ                             */
*            IF TRKREAD = READYES                                  1293
*/*            THEN                                                  */
*              THEN DO;                                            1293
*                                                                  1293
         TM    TRKREAD,B'10000000'                                 1293
         BNO   @RF01293                                            1293
*/*              ISSUE_MARK_TRACK_NON-DEFECTIVE                      */
*                CALL WRIHARZ;                                     1295
         BAL   @14,WRIHARZ                                         1295
*/*              IF SUCCESSFUL IN MARKING TRACK NON-DEFECTIVE        */
*                IF SPROCODE = SUCCESS                             1296
*/*                THEN                                              */
*                  THEN DO;                                        1296
*                                                                  1296
         LTR   SPROCODE,SPROCODE                                   1296
         BNZ   @RF01296                                            1296
*/*                  WRITE_TRACK_CONTENTS (BACK ON THE ALTERNATE)    */
*                    CALL WRITRACK (RZCCHH);                       1298
         LA    @06,RZCCHH                                          1298
         ST    @06,@AL00001                                        1298
         LA    @01,@AL00001                                        1298
         BAL   @14,WRITRACK                                        1298
*/*                  ISSUE MESSAGE (MSGALTG) (UPRINT)                */
*                    DARGSENT = MSGALTG;                           1299
         L     @06,DDSTRU                                          1299
         MVI   DARGSENT(@06),X'29'                                 1299
*                    DARGCNT = 2;                                  1300
         LA    @15,2                                               1300
         STH   @15,DARGCNT(,@06)                                   1300
*                    DARGINS (1) = 1;                              1301
         MVC   DARGINS(2,@06),@CH00165                             1301
*                    DARGINL (1) = LENGTH (CTRADDRC);              1302
         STH   @15,DARGINL(,@06)                                   1302
*                    DARGDTM (1) = ADDR (CTRADDRC);                1303
         LA    @14,CTRADDRC                                        1303
         ST    @14,DARGDTM(,@06)                                   1303
*                    DARGINS (2) = 2;                              1304
         STH   @15,DARGINS+8(,@06)                                 1304
*                    DARGINL (2) = LENGTH (CTRADDRT);              1305
         STH   @15,DARGINL+8(,@06)                                 1305
*                    DARGDTM (2) = ADDR (CTRADDRT);                1306
         LA    @15,CTRADDRT                                        1306
         ST    @15,DARGDTM+8(,@06)                                 1306
*                    CALL ICKTPPR0 (GDTTBL                         1307
*                           ,PRTFILE                               1307
*                           ,DDSTRU);                              1307
         L     @06,@PC00001                                        1307
         ST    @06,@AL00001                                        1307
         LA    @15,@CF00094                                        1307
         ST    @15,@AL00001+4                                      1307
         LA    @15,DDSTRU                                          1307
         ST    @15,@AL00001+8                                      1307
         MVI   @AL00001+8,X'80'                                    1307
         L     @15,GDTPRT(,@06)                                    1307
         LA    @01,@AL00001                                        1307
         BALR  @14,@15                                             1307
*/*                  RETURN                                          */
*                    RETURN;                                       1308
@EL00011 DS    0H                                                  1308
@EF00011 DS    0H                                                  1308
@ER00011 LM    @14,@12,@SA00011                                    1308
         BR    @14                                                 1308
*/*                  END-THEN                                        */
*                    END;                                          1309
*/*                ELSE                                              */
*                  ELSE DO;                                        1310
*                                                                  1310
@RF01296 DS    0H                                                  1311
*/*                  IF DEFECT-FLAG IS SET DUE TO RECOVERY           */
*                    IF SPROCODE = FAILRCV                         1311
*/*                    THEN                                          */
*                      THEN DO;                                    1311
*                                                                  1311
         LA    @06,1                                               1311
         CR    SPROCODE,@06                                        1311
         BNE   @RF01311                                            1311
*/*                      ISSUE ERROR MESSAGE (MSGALTH) (UPRINT)      */
*                        DARGSENT = MSGALTH;                       1313
         L     @15,DDSTRU                                          1313
         MVI   DARGSENT(@15),X'2A'                                 1313
*                        DARGCNT = 2;                              1314
         LA    @14,2                                               1314
         STH   @14,DARGCNT(,@15)                                   1314
*                        DARGINS (1) = 1;                          1315
         STH   @06,DARGINS(,@15)                                   1315
*                        DARGINL (1) = LENGTH (CTRADDRC);          1316
         STH   @14,DARGINL(,@15)                                   1316
*                        DARGDTM (1) = ADDR (CTRADDRC);            1317
         LA    @06,CTRADDRC                                        1317
         ST    @06,DARGDTM(,@15)                                   1317
*                        DARGINS (2) = 2;                          1318
         STH   @14,DARGINS+8(,@15)                                 1318
*                        DARGINL (2) = LENGTH (CTRADDRT);          1319
         STH   @14,DARGINL+8(,@15)                                 1319
*                        DARGDTM (2) = ADDR (CTRADDRT);            1320
         LA    @06,CTRADDRT                                        1320
         ST    @06,DARGDTM+8(,@15)                                 1320
*                        CALL ICKTPPR0 (GDTTBL                     1321
*                               ,PRTFILE                           1321
*                               ,DDSTRU);                          1321
         L     @06,@PC00001                                        1321
         ST    @06,@AL00001                                        1321
         LA    @15,@CF00094                                        1321
         ST    @15,@AL00001+4                                      1321
         LA    @15,DDSTRU                                          1321
         ST    @15,@AL00001+8                                      1321
         MVI   @AL00001+8,X'80'                                    1321
         L     @15,GDTPRT(,@06)                                    1321
         LA    @01,@AL00001                                        1321
         BALR  @14,@15                                             1321
*/*                      RETURN                                      */
*                        RETURN;                                   1322
         B     @EL00011                                            1322
*/*                      END-THEN                                    */
*                        END;                                      1323
*/*                  END-ELSE                                        */
*                    END;                                          1324
@RF01311 DS    0H                                                  1325
*/*              END-THEN (TRACK CONTENTS WERE READ)                 */
*                END;                                              1325
*/*          END-THEN (RE-ASSIGNMENT UNSUCCESSFUL BUT ALTERNATE OKAY)*/
*            END;                                                  1326
*/*        ELSE                                                      */
*          ELSE DO;                                                1327
*                                                                  1327
         B     @RC01291                                            1327
@RF01291 DS    0H                                                  1328
*/*          IF RE-ASSIGNMENT SUCCESSFUL OR DISSOCIATION OF THE OLD  */
*/*           ALTERNATE FAILS AND TRACK CONTENTS WERE READ           */
*            IF (RETCODE6 = SUCCESS  RETCODE6 = NODISSOC) &       1328
*             TRKREAD = READYES                                    1328
*/*            THEN WRITE_TRACK_CONTENTS (ON THE NEW ALTERNATE )     */
*              THEN DO;                                            1328
*                                                                  1328
         L     @06,RETCODE6                                        1328
         LTR   @06,@06                                             1328
         BZ    @GL00078                                            1328
         CH    @06,@CH00044                                        1328
         BNE   @RF01328                                            1328
@GL00078 TM    TRKREAD,B'10000000'                                 1328
         BNO   @RF01328                                            1328
*                CALL WRITRACK                                     1330
*                     (RZCCHH);                                    1330
         LA    @06,RZCCHH                                          1330
         ST    @06,@AL00001                                        1330
         LA    @01,@AL00001                                        1330
         BAL   @14,WRITRACK                                        1330
*                END;                                              1331
*/*          END-ELSE                                                */
*            END;                                                  1332
*/*      END-THEN                                                    */
*        END;                                                      1333
*/*  END-SUB-PROCEDURE ISSUE_RE-ASSIGN_ALTERNATE_TRACK               */
*    END RASGNALT;                                                 1334
*                                                                  1334
         B     @EL00011                                            1334
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  CHEKTRAK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE CHECK TRACK SURFACE                    */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL EFFECT THE INVOCATION OF THE          */
*/*    TRACK SURFACE CHECKING FUNCTION. ALL THE CONDITION CODE       */
*/*    PROCESSING AFTER THE INVOCATION IS HANDLED BY THIS            */
*/*    SUB-PROCEDURE. THE STATUS OF THE TRACK IS THEN MADE           */
*/*    AVAILABLE TO THE MAIN PROCEDURE.                              */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1335
*                                                                  1335
*/*  SUB-PROCEDURE ISSUE_CHECK_TRACK_SURFACE                         */
*    CHEKTRAK:                                                     1335
*      PROCEDURE;                                                  1335
*                                                                  1335
CHEKTRAK STM   @14,@12,@SA00012                                    1335
*      DCL RETCODE7          /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31);                           1336
*    OLDERID2 = NEWERID2;                                          1337
         L     @06,@PC00001                                        1337
         L     @15,GDTTR2(,@06)                                    1337
         MVC   @TS00001(95),NEWERID2(@15)                          1337
         MVC   OLDERID2(95,@15),@TS00001                           1337
*    NEWID2 =  'ITCK';                                             1338
         MVC   NEWID2(4,@15),@CC00957                              1338
*/*  CHECK_TRACK_SURFACE                                             */
*    CALL ICKTA01                                                  1339
*         (GDTTBL                                                  1339
*         ,VOLIB                                                   1339
*         ,CTRADDR                                                 1339
*         ,CYCLES                                                  1339
*         ,RETCODE7);                                              1339
         ST    @06,@AL00001                                        1339
         LA    @06,VOLIB                                           1339
         ST    @06,@AL00001+4                                      1339
         LA    @06,CTRADDR                                         1339
         ST    @06,@AL00001+8                                      1339
         LA    @06,CYCLES                                          1339
         ST    @06,@AL00001+12                                     1339
         LA    @06,RETCODE7                                        1339
         ST    @06,@AL00001+16                                     1339
         L     @15,@CV00958                                        1339
         LA    @01,@AL00001                                        1339
         BALR  @14,@15                                             1339
*/*  IF SURFACE CHECKING FUNCTION FAILS                              */
*    IF RETCODE7 = TSCFAILS                                        1340
*/*    THEN                                                          */
*      THEN DO;                                                    1340
*                                                                  1340
         LA    @06,2                                               1340
         C     @06,RETCODE7                                        1340
         BNE   @RF01340                                            1340
*/*      ISSUE WARNING MESSAGE (MSGCHECK) (UPRINT)                   */
*        DARGSENT = MSGCHECK;                                      1342
         L     @15,DDSTRU                                          1342
         MVI   DARGSENT(@15),X'0F'                                 1342
*        DARGCNT = 2;                                              1343
         STH   @06,DARGCNT(,@15)                                   1343
*        DARGINS (1) = 1;                                          1344
         MVC   DARGINS(2,@15),@CH00165                             1344
*        DARGINL (1) = LENGTH (CTRADDRC);                          1345
         STH   @06,DARGINL(,@15)                                   1345
*        DARGDTM (1) = ADDR (CTRADDRC);                            1346
         LA    @14,CTRADDRC                                        1346
         ST    @14,DARGDTM(,@15)                                   1346
*        DARGINS (2) = 2;                                          1347
         STH   @06,DARGINS+8(,@15)                                 1347
*        DARGINL (2) = LENGTH (CTRADDRT);                          1348
         STH   @06,DARGINL+8(,@15)                                 1348
*        DARGDTM (2) = ADDR (CTRADDRT);                            1349
         LA    @06,CTRADDRT                                        1349
         ST    @06,DARGDTM+8(,@15)                                 1349
*        CALL ICKTPPR0 (GDTTBL                                     1350
*               ,PRTFILE                                           1350
*               ,DDSTRU);                                          1350
         L     @06,@PC00001                                        1350
         ST    @06,@AL00001                                        1350
         LA    @15,@CF00094                                        1350
         ST    @15,@AL00001+4                                      1350
         LA    @15,DDSTRU                                          1350
         ST    @15,@AL00001+8                                      1350
         MVI   @AL00001+8,X'80'                                    1350
         L     @15,GDTPRT(,@06)                                    1350
         LA    @01,@AL00001                                        1350
         BALR  @14,@15                                             1350
*/*      INDICATE MINOR ERROR (LASTCOND = 4)                         */
*        LASTCOND = MAX (LASTCOND,LASTCC04);                       1351
         L     @06,@PC00001+8                                      1351
         LH    @15,LASTCOND(,@06)                                  1351
         LA    @14,4                                               1351
         CR    @15,@14                                             1351
         BNL   *+6
         LR    @15,@14                                             1351
         STH   @15,LASTCOND(,@06)                                  1351
*/*      INDICATE THE TRACK CHECKS OUT DEFECTIVE                     */
*        TRSTATUS = TSCBAD;                                        1352
         NI    TRSTATUS,B'01111111'                                1352
*/*      END-THEN                                                    */
*        END;                                                      1353
*/*    ELSE                                                          */
*      ELSE DO;                                                    1354
*                                                                  1354
         B     @RC01340                                            1354
@RF01340 DS    0H                                                  1355
*/*      IF UNABLE TO OBTAIN STORAGE FOR BUFFER                      */
*        IF RETCODE7 = TSCNOSTO                                    1355
*/*        THEN INDICATE SEVERE ERROR                                */
*          THEN DO;    LASTCOND = LASTCC12; END;                   1355
         CLC   RETCODE7(4),@CF00136                                1355
         BNE   @RF01355                                            1355
         L     @06,@PC00001+8                                      1357
         MVC   LASTCOND(2,@06),@CH00265                            1357
*/*      IF TRACK CHECKS OUT GOOD                                    */
*        IF RETCODE7 = TRACKOK                                     1359
*/*        THEN SAVE THE TRACK STATUS                                */
*          THEN DO;    TRSTATUS = TSCGOOD; END;                    1359
@RF01355 L     @06,RETCODE7                                        1359
         LTR   @06,@06                                             1359
         BNZ   @RF01359                                            1359
         OI    TRSTATUS,B'10000000'                                1361
*/*      IF TRACK CHECKS OUT DEFECTIVE                               */
*        IF RETCODE7 = TRACKDEF                                    1363
*/*        THEN SAVE THE TRACK STATUS                                */
*          THEN DO;    TRSTATUS = TSCBAD; END;                     1363
@RF01359 CLC   RETCODE7(4),@CF00165                                1363
         BNE   @RF01363                                            1363
         NI    TRSTATUS,B'01111111'                                1365
*/*      END-ELSE                                                    */
*        END;                                                      1367
@RF01363 DS    0H                                                  1368
*/*  WRITE STANDARD-LENGTH RECORD-ZERO (UDEVOP)                      */
*    IF RZCCHH = CTRADDR                                           1368
*      THEN DO;    RZACTION = ACTWRZS; END;                        1368
@RC01340 CLC   RZCCHH(4),CTRADDR                                   1368
         BNE   @RF01368                                            1368
         MVC   RZACTION(4),@CF00161                                1370
*      ELSE DO;    RZACTION = ACTWRZSL; END;                       1372
         B     @RC01368                                            1372
@RF01368 DS    0H                                                  1373
         MVC   RZACTION(4),@CF00276                                1373
*    CALL ICKDVOP0 (GDTTBL                                         1375
*           ,VOLIB                                                 1375
*           ,RZACTION                                              1375
*           ,CTRADDR                                               1375
*           ,RECNUM                                                1375
*           ,POOLID                                                1375
*           ,ADDR (RZCCHH)                                         1375
*           ,LENGTH (RZCCHH)                                       1375
*           ,RETCODE7);                                            1375
@RC01368 L     @06,@PC00001                                        1375
         ST    @06,@AL00001                                        1375
         LA    @15,VOLIB                                           1375
         ST    @15,@AL00001+4                                      1375
         LA    @15,RZACTION                                        1375
         ST    @15,@AL00001+8                                      1375
         LA    @15,CTRADDR                                         1375
         ST    @15,@AL00001+12                                     1375
         LA    @15,RECNUM                                          1375
         ST    @15,@AL00001+16                                     1375
         LA    @15,POOLID                                          1375
         ST    @15,@AL00001+20                                     1375
         LA    @15,RZCCHH                                          1375
         ST    @15,@AFTEMPS                                        1375
         LA    @15,@AFTEMPS                                        1375
         ST    @15,@AL00001+24                                     1375
         LA    @15,@CF00044                                        1375
         ST    @15,@AL00001+28                                     1375
         LA    @15,RETCODE7                                        1375
         ST    @15,@AL00001+32                                     1375
         L     @15,GDTDOP(,@06)                                    1375
         LA    @01,@AL00001                                        1375
         BALR  @14,@15                                             1375
*/*  IF DEFECT-FLAG SET DUE TO RECOVERY                              */
*    IF RETCODE7 = DFLAGONA  RETCODE7 = DFLAGONP                  1376
*/*    THEN INDICATE THAT THE TRACK CHECKS OUT DEFECTIVE ANYWAY      */
*      THEN DO;    TRSTATUS = TSCBAD; END;                         1376
         L     @06,RETCODE7                                        1376
         CH    @06,@CH00119                                        1376
         BE    @RT01376                                            1376
         CH    @06,@CH00116                                        1376
         BNE   @RF01376                                            1376
@RT01376 DS    0H                                                  1377
         NI    TRSTATUS,B'01111111'                                1378
*/*    ELSE                                                          */
*      ELSE DO;                                                    1380
*                                                                  1380
         B     @RC01376                                            1380
@RF01376 DS    0H                                                  1381
*/*      IF UNABLE TO WRITE THE RECORD 0                             */
*        IF RETCODE7 = CPFAILS                                     1381
*/*        THEN COUNT_UNRECOVERABLE_TRACKS                           */
*          THEN DO;                                                1381
*                                                                  1381
         CLC   RETCODE7(4),@CF00044                                1381
         BNE   @RF01381                                            1381
*            UNTRACK = CTRADDR;                                    1383
         MVC   UNTRACK(4),CTRADDR                                  1383
*            IF TRACKTYP = PRITRACK                                1384
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1384
         TM    TRACKTYP,B'10000000'                                1384
         BNO   @RF01384                                            1384
         OI    UNTRTYPE,B'10000000'                                1386
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1388
         B     @RC01384                                            1388
@RF01384 DS    0H                                                  1389
         NI    UNTRTYPE,B'01111111'                                1389
*            CALL COUNTRKS;                                        1391
@RC01384 BAL   @14,COUNTRKS                                        1391
*            END;                                                  1392
*/*      END-ELSE                                                    */
*        END;                                                      1393
*/*  END-SUB-PROCEDURE ISSUE_CHECK_TRACK_SURFACE                     */
*                                                                  1394
*                                                                  1394
*    END CHEKTRAK;                                                 1394
*                                                                  1394
@EL00012 DS    0H                                                  1394
@EF00012 DS    0H                                                  1394
@ER00012 LM    @14,@12,@SA00012                                    1394
         BR    @14                                                 1394
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  RECATRAK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  RECLAIM ALTERNATE TRACK                      */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION WHICH      */
*/*    RECLAIMS AN ALTERNATE TRACK WHICH WAS FOUND TO BE WITHOUT     */
*/*    DEFECT. THE CONDITION CODE PROCESSING AFTER THE INVOCATION    */
*/*    IS ALSO HANDLED IN THIS SUB-PROCEDURE. APPROPRIATE MESSAGES   */
*/*    ARE WRITTEN TO INDICATE THE RESULT OF THE RECLAMATION ATTEMPT.*/
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1395
*                                                                  1395
*/*  SUB-PROCEDURE ISSUE_RECLAIM_ALTERNATE_TRACK                     */
*    RECATRAK:                                                     1395
*      PROCEDURE;                                                  1395
*                                                                  1395
RECATRAK STM   @14,@12,@SA00013                                    1395
*      DCL RETCODE8          /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31);                           1396
*                                                                  1396
*    OLDERID2 = NEWERID2;                                          1397
         L     @06,@PC00001                                        1397
         L     @03,GDTTR2(,@06)                                    1397
         MVC   @TS00001(95),NEWERID2(@03)                          1397
         MVC   OLDERID2(95,@03),@TS00001                           1397
*    NEWID2 = 'ITRA';                                              1398
         MVC   NEWID2(4,@03),@CC00963                              1398
*/*  SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS                   */
*    SALTCNT = ALTCOUNT;                                           1399
         L     SALTCNT,ALTCOUNT                                    1399
*/*  RECLAIM_ALTERNATE_TRACK                                         */
*    CALL ICKRT01                                                  1400
*         (GDTTBL                                                  1400
*         ,VOLIB                                                   1400
*         ,CTRADDR                                                 1400
*         ,ALTCOUNT                                                1400
*         ,ALTPTR                                                  1400
*         ,RETCODE8);                                              1400
         ST    @06,@AL00001                                        1400
         LA    @06,VOLIB                                           1400
         ST    @06,@AL00001+4                                      1400
         LA    @06,CTRADDR                                         1400
         ST    @06,@AL00001+8                                      1400
         LA    @06,ALTCOUNT                                        1400
         ST    @06,@AL00001+12                                     1400
         LA    @06,ALTPTR                                          1400
         ST    @06,@AL00001+16                                     1400
         LA    @06,RETCODE8                                        1400
         ST    @06,@AL00001+20                                     1400
         L     @15,@CV00964                                        1400
         LA    @01,@AL00001                                        1400
         BALR  @14,@15                                             1400
*/*  IF RECLAMATION FAILS AND THE TRACK WAS FOUND TO BE UNRECOVERABLE*/
*    IF RETCODE8 = REAFAIL                                         1401
*/*    THEN                                                          */
*      THEN DO;                                                    1401
*                                                                  1401
         CLC   RETCODE8(4),@CF00116                                1401
         BNE   @RF01401                                            1401
*/*      ISSUE_BUILD_PACK_MAP (TRACK FLAGGED DEFECTIVE)              */
*        PACKDEF  = DEFECTIV;                                      1403
         OI    PACKDEF,B'10000000'                                 1403
*        PACKCHEK = NODEFECT;                                      1404
         NI    PACKCHEK,B'01111111'                                1404
*        PACKRCVR = RCVRYES;                                       1405
         NI    PACKRCVR,B'01111111'                                1405
*        PACKTRK  = ALTTRACK;                                      1406
         NI    PACKTRK,B'01111111'                                 1406
*        PACKTRAK = CTRADDR;                                       1407
         MVC   PACKTRAK(4),CTRADDR                                 1407
*        PACKASC = RZCCHH;                                         1408
         MVC   PACKASC(4),RZCCHH                                   1408
*        CALL BILDPACK;                                            1409
         BAL   @14,BILDPACK                                        1409
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        UNTRACK = CTRADDR;                                        1410
         MVC   UNTRACK(4),CTRADDR                                  1410
*        UNTRTYPE = ALTTRACK;                                      1411
         NI    UNTRTYPE,B'01111111'                                1411
*        CALL COUNTRKS;                                            1412
         BAL   @14,COUNTRKS                                        1412
*/*      END-THEN (RECLAMATION FAILS)                                */
*        END;                                                      1413
*/*    ELSE                                                          */
*      ELSE DO;                                                    1414
*                                                                  1414
         B     @RC01401                                            1414
@RF01401 DS    0H                                                  1415
*/*      IF RECLAMATION IS SUCCESSFUL                                */
*        IF RETCODE8 = SUCCESS                                     1415
*/*        THEN                                                      */
*          THEN DO;                                                1415
*                                                                  1415
         L     @06,RETCODE8                                        1415
         LTR   @06,@06                                             1415
         BNZ   @RF01415                                            1415
*/*          SET ARGUMENT FOR PROPER MESSAGE (MSGRCLA)               */
*            DARGSENT = MSGRCLA;                                   1417
         L     @06,DDSTRU                                          1417
         MVI   DARGSENT(@06),X'15'                                 1417
*/*          INDICATE THAT AN ALTERNATE TRACK IS AVAILABLE           */
*            ALTFLAG = MOREYES;                                    1418
         NI    ALTFLAG,B'01111111'                                 1418
*/*          SAVE INDICATION THAT THE DEFECT-FLAG IS NOT SET         */
*            DFLAGC = NODEFECT;                                    1419
         NI    DFLAGC,B'01111111'                                  1419
*/*          END-THEN                                                */
*            END;                                                  1420
*/*        ELSE (RECLAMATION FAILS BUT TRACK RECOVERABLE)            */
*          ELSE DO;                                                1421
*                                                                  1421
         B     @RC01415                                            1421
@RF01415 DS    0H                                                  1422
*/*          SET ARGUMENT FOR PROPER MESSAGE (MSGRCLAF)              */
*            DARGSENT = MSGRCLAF;                                  1422
         L     @06,DDSTRU                                          1422
         MVI   DARGSENT(@06),X'1F'                                 1422
*/*          SAVE INDICATION THAT THE DEFECT-FLAG IS SET DUE TO      */
*/*           RECOVERY                                               */
*            DFLAGC = DEFECTIV;                                    1423
         OI    DFLAGC,B'10000000'                                  1423
*/*          ISSUE_BUILD_PACK_MAP                                    */
*            PACKDEF = DEFECTIV;                                   1424
         OI    PACKDEF,B'10000000'                                 1424
*            PACKCHEK = NODEFECT;                                  1425
         NI    PACKCHEK,B'01111111'                                1425
*            PACKRCVR = RCVRYES;                                   1426
         NI    PACKRCVR,B'01111111'                                1426
*            PACKTRK = ALTTRACK;                                   1427
         NI    PACKTRK,B'01111111'                                 1427
*            PACKTRAK = CTRADDR;                                   1428
         MVC   PACKTRAK(4),CTRADDR                                 1428
*            PACKASC = RZCCHH;                                     1429
         MVC   PACKASC(4),RZCCHH                                   1429
*            CALL BILDPACK;                                        1430
         BAL   @14,BILDPACK                                        1430
*/*          END-ELSE                                                */
*            END;                                                  1431
*/*      ISSUE MESSAGE (UPRINT)                                      */
*        DARGCNT = 2;                                              1432
@RC01415 LA    @06,2                                               1432
         L     @03,DDSTRU                                          1432
         STH   @06,DARGCNT(,@03)                                   1432
*        DARGINS (1) = 1;                                          1433
         MVC   DARGINS(2,@03),@CH00165                             1433
*        DARGINL (1) = LENGTH (CTRADDRC);                          1434
         STH   @06,DARGINL(,@03)                                   1434
*        DARGDTM (1) = ADDR (CTRADDRC);                            1435
         LA    @15,CTRADDRC                                        1435
         ST    @15,DARGDTM(,@03)                                   1435
*        DARGINS (2) = 2;                                          1436
         STH   @06,DARGINS+8(,@03)                                 1436
*        DARGINL (2) = LENGTH (CTRADDRT);                          1437
         STH   @06,DARGINL+8(,@03)                                 1437
*        DARGDTM (2) = ADDR (CTRADDRT);                            1438
         LA    @06,CTRADDRT                                        1438
         ST    @06,DARGDTM+8(,@03)                                 1438
*        CALL ICKTPPR0 (GDTTBL                                     1439
*               ,PRTFILE                                           1439
*               ,DDSTRU);                                          1439
         L     @06,@PC00001                                        1439
         ST    @06,@AL00001                                        1439
         LA    @03,@CF00094                                        1439
         ST    @03,@AL00001+4                                      1439
         LA    @03,DDSTRU                                          1439
         ST    @03,@AL00001+8                                      1439
         MVI   @AL00001+8,X'80'                                    1439
         L     @15,GDTPRT(,@06)                                    1439
         LA    @01,@AL00001                                        1439
         BALR  @14,@15                                             1439
*/*      END-ELSE                                                    */
*        END;                                                      1440
*/*  ADJUST THE NUMBER OF AVAILABLE ALTERNATE TRACKS                 */
*    IF ALTCOUNT > SALTCNT                                         1441
*      THEN DO;                                                    1441
@RC01401 C     SALTCNT,ALTCOUNT                                    1441
         BNL   @RF01441                                            1441
*        IF CTRADDR >= TALPTR                                      1443
*          THEN DO;    TALCNT = TALCNT + 1; END;                   1443
         CLC   CTRADDR(4),TALPTR                                   1443
         BL    @RF01443                                            1443
         LA    @06,1                                               1445
         AL    @06,TALCNT                                          1445
         ST    @06,TALCNT                                          1445
*        IF (TALPTRT > 0 & CTRADDRC = TALPTRC &                    1447
*                          CTRADDRT = TALPTRT - 1)                1447
*           (TALPTRT = 0 & CTRADDRC = TALPTRC - 1 &                1447
*                          CTRADDRT = TRKSPCYL - 1)                1447
*          THEN DO;                                                1447
@RF01443 MVC   @ZT00002+2(2),TALPTRT                               1447
         L     @06,@ZT00002                                        1447
         LTR   @06,@06                                             1447
         BNP   @GL00081                                            1447
         CLC   CTRADDRC(2),TALPTRC                                 1447
         BNE   @GL00081                                            1447
         BCTR  @06,0                                               1447
         MVC   @ZT00002+2(2),CTRADDRT                              1447
         C     @06,@ZT00002                                        1447
         BE    @RT01447                                            1447
@GL00081 MVC   @ZT00002+2(2),TALPTRT                               1447
         L     @06,@ZT00002                                        1447
         LTR   @06,@06                                             1447
         BNZ   @RF01447                                            1447
         MVC   @ZT00002+2(2),TALPTRC                               1447
         L     @06,@ZT00002                                        1447
         BCTR  @06,0                                               1447
         MVC   @ZT00002+2(2),CTRADDRC                              1447
         C     @06,@ZT00002                                        1447
         BNE   @RF01447                                            1447
         L     @06,INFOPTR+12                                      1447
         L     @06,TRKSPCYL(,@06)                                  1447
         BCTR  @06,0                                               1447
         MVC   @ZT00002+2(2),CTRADDRT                              1447
         C     @06,@ZT00002                                        1447
         BNE   @RF01447                                            1447
@RT01447 DS    0H                                                  1448
*            TALPTR = CTRADDR;                                     1449
         MVC   TALPTR(4),CTRADDR                                   1449
*            TALCNT = TALCNT + 1;                                  1450
         LA    @06,1                                               1450
         AL    @06,TALCNT                                          1450
         ST    @06,TALCNT                                          1450
*            END;                                                  1451
*        END;                                                      1452
*/*  END-SUB-PROCEDURE ISSUE_RECLAIM_ALTERNATE_TRACK                 */
*    END RECATRAK;                                                 1453
*                                                                  1453
@EL00013 DS    0H                                                  1453
@EF00013 DS    0H                                                  1453
@ER00013 LM    @14,@12,@SA00013                                    1453
         BR    @14                                                 1453
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  RECPTRAK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE RECLAIM PRIMARY TRACK                  */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION WHICH      */
*/*    RECLAIMS A PRIMARY TRACK THAT HAS BEEN DETERMINED TO BE A     */
*/*    USABLE TRACK. ALL THE CONDITION CODE PROCESSING AFTER THE     */
*/*    INVOCATION IS HANDLED HERE.                                   */
*/*    IN THE EVENT THAT AN ALTERNATE TRACK, ASSOCIATED WITH THIS    */
*/*    PRIMARY TRACK, IS NOT SUCCESSFULLY DISSOCIATED BUT HAS ITS    */
*/*    DEFECT-FLAG SET DUE TO ERROR RECOVERY, A WARNING MESSAGE      */
*/*    ABOUT THAT TRACK IS POSTED AND PROCESSING CONTINUED, BUT      */
*/*    NOTE THAT THE DATA WILL BE LOST IN THIS CASE.                 */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1454
*                                                                  1454
*/*  SUB-PROCEDURE ISSUE_RECLAIM_PRIMARY_TRACK                       */
*    RECPTRAK:                                                     1454
*      PROCEDURE;                                                  1454
*                                                                  1454
RECPTRAK STM   @14,@12,@SA00014                                    1454
*      DCL RETCODE9          /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31);                           1455
*                                                                  1455
*    OLDERID2 = NEWERID2;                                          1456
         L     @06,@PC00001                                        1456
         L     @15,GDTTR2(,@06)                                    1456
         MVC   @TS00001(95),NEWERID2(@15)                          1456
         MVC   OLDERID2(95,@15),@TS00001                           1456
*    NEWID2 = 'ITRP';                                              1457
         MVC   NEWID2(4,@15),@CC00969                              1457
*/*  IF NO SEVERE ERRORS FOUND, TRACK RECOVERABLE                    */
*    IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)               1458
*/*    THEN                                                          */
*      THEN DO;                                                    1458
*                                                                  1458
         L     @15,@PC00001+8                                      1458
         LH    @15,LASTCOND(,@15)                                  1458
         CH    @15,@CH00265                                        1458
         BNL   @RF01458                                            1458
         TM    RCVRFLAG,B'10000000'                                1458
         BNO   @RF01458                                            1458
*/*      SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS               */
*        SALTCNT = ALTCOUNT;                                       1460
         L     SALTCNT,ALTCOUNT                                    1460
*/*      RECLAIM_PRIMARY_TRACK                                       */
*        CALL ICKRP01                                              1461
*             (GDTTBL                                              1461
*             ,VOLIB                                               1461
*             ,CTRADDR                                             1461
*             ,RZCCHH                                              1461
*             ,ALTCOUNT                                            1461
*             ,ALTPTR                                              1461
*             ,RETCODE9);                                          1461
         ST    @06,@AL00001                                        1461
         LA    @06,VOLIB                                           1461
         ST    @06,@AL00001+4                                      1461
         LA    @06,CTRADDR                                         1461
         ST    @06,@AL00001+8                                      1461
         LA    @06,RZCCHH                                          1461
         ST    @06,@AL00001+12                                     1461
         LA    @06,ALTCOUNT                                        1461
         ST    @06,@AL00001+16                                     1461
         LA    @06,ALTPTR                                          1461
         ST    @06,@AL00001+20                                     1461
         LA    @06,RETCODE9                                        1461
         ST    @06,@AL00001+24                                     1461
         L     @15,@CV00970                                        1461
         LA    @01,@AL00001                                        1461
         BALR  @14,@15                                             1461
*/*      IF RECLAMATION SUCCEEDS                                     */
*        IF RETCODE9 = SUCCESS                                     1462
*/*        THEN                                                      */
*          THEN DO;                                                1462
*                                                                  1462
         L     @06,RETCODE9                                        1462
         LTR   @06,@06                                             1462
         BNZ   @RF01462                                            1462
*/*          SET MESSAGE ARGUMENT (MSGRCLP)                          */
*            DARGSENT = MSGRCLP;                                   1464
         L     @06,DDSTRU                                          1464
         MVI   DARGSENT(@06),X'16'                                 1464
*/*          SAVE THE DEFECT-FLAG RESETTING                          */
*            DFLAGC = NODEFECT;                                    1465
         NI    DFLAGC,B'01111111'                                  1465
*/*          IF THE PRIMARY WAS ASSOCIATED WITH AN ALTERNATE         */
*            IF ASSOCFLG = ASSOCYES                                1466
*/*            THEN                                                  */
*              THEN DO;                                            1466
         TM    ASSOCFLG,B'10000000'                                1466
         BNO   @RF01466                                            1466
*/*              INDICATE AN ALTERNATE TRACK EXISTS                  */
*                ALTFLAG = MOREYES;                                1468
         NI    ALTFLAG,B'01111111'                                 1468
*/*              END-THEN                                            */
*                END;                                              1469
*/*          IF PRESERVE IS SPECIFIED                                */
*            IF ADDR(PRESV) ^= NULLPTR                             1470
*/*            THEN                                                  */
*              THEN DO;                                            1470
*                                                                  1470
@RF01466 L     @06,@PC00001+4                                      1470
         L     @06,FDTPTR+4(,@06)                                  1470
         LTR   @06,@06                                             1470
         BZ    @RF01470                                            1470
*/*              IF TRACK WAS ASSOCIATED WITH AN ALTERNATE AND       */
*/*               TRACK CONTENTS WERE READ                           */
*                IF ASSOCFLG = ASSOCYES & TRKREAD = READYES        1472
*/*                THEN WRITE_TRACK_CONTENTS (ON THE PRIMARY)        */
*                  THEN DO;                                        1472
*                                                                  1472
         TM    ASSOCFLG,B'10000000'                                1472
         BNO   @RF01472                                            1472
         TM    TRKREAD,B'10000000'                                 1472
         BNO   @RF01472                                            1472
*                    CALL WRITRACK                                 1474
*                         (CTRADDR);                               1474
         LA    @06,CTRADDR                                         1474
         ST    @06,@AL00001                                        1474
         LA    @01,@AL00001                                        1474
         BAL   @14,WRITRACK                                        1474
*                    END;                                          1475
*/*              END-THEN                                            */
*                END;                                              1476
*/*          END-THEN                                                */
*            END;                                                  1477
*/*        ELSE                                                      */
*          ELSE DO;                                                1478
         B     @RC01462                                            1478
@RF01462 DS    0H                                                  1479
*/*          IF RECLAMATION FAILS AND TRACK IS UNRECOVERABLE         */
*            IF RETCODE9 = REPFAIL                                 1479
*/*            THEN COUNT_UNRECOVERABLE_TRACKS (PRIMARY TRACK)       */
*              THEN DO;                                            1479
*                                                                  1479
         CLC   RETCODE9(4),@CF00116                                1479
         BNE   @RF01479                                            1479
*                UNTRACK = CTRADDR;                                1481
         MVC   UNTRACK(4),CTRADDR                                  1481
*                UNTRTYPE = PRITRACK;                              1482
         OI    UNTRTYPE,B'10000000'                                1482
*                CALL COUNTRKS;                                    1483
         BAL   @14,COUNTRKS                                        1483
*                END;                                              1484
*/*          IF DISSOCIATION FAILS AND TRACK IS UNRECOVERABLE        */
*            IF RETCODE9 = DISFAILU                                1485
*/*            THEN COUNT_UNRECOVERABLE_TRACKS (ALTERNATE TRACK)     */
*              THEN DO;                                            1485
*                                                                  1485
@RF01479 CLC   RETCODE9(4),@CF00044                                1485
         BNE   @RF01485                                            1485
*                UNTRACK = RZCCHH;                                 1487
         MVC   UNTRACK(4),RZCCHH                                   1487
*                UNTRTYPE = ALTTRACK;                              1488
         NI    UNTRTYPE,B'01111111'                                1488
*                CALL COUNTRKS;                                    1489
         BAL   @14,COUNTRKS                                        1489
*                END;                                              1490
*/*          IF RECLAMATION FAILS BUT TRACK IS RECOVERED             */
*            IF RETCODE9 = REPFAILR                                1491
*/*            THEN                                                  */
*              THEN DO;                                            1491
*                                                                  1491
@RF01485 CLC   RETCODE9(4),@CF00165                                1491
         BNE   @RF01491                                            1491
*/*              SET MESSAGE ARGUMENT (MSGRCLPF)                     */
*                DARGSENT = MSGRCLPF;                              1493
         L     @06,DDSTRU                                          1493
         MVI   DARGSENT(@06),X'20'                                 1493
*/*              ISSUE_BUILD_PACK_MAP (TRACK DEFECT-FLAG STILL SET)  */
*                PACKDEF  = DEFECTIV;                              1494
         OI    PACKDEF,B'10000000'                                 1494
*                PACKCHEK = NODEFECT;                              1495
         NI    PACKCHEK,B'01111111'                                1495
*                PACKRCVR = RCVRYES;                               1496
         NI    PACKRCVR,B'01111111'                                1496
*                PACKTRK  = PRITRACK;                              1497
         OI    PACKTRK,B'10000000'                                 1497
*                PACKTRAK = CTRADDR;                               1498
         MVC   PACKTRAK(4),CTRADDR                                 1498
*                PACKASC = RZCCHH;                                 1499
         MVC   PACKASC(4),RZCCHH                                   1499
*                CALL BILDPACK;                                    1500
         BAL   @14,BILDPACK                                        1500
*/*              SAVE THE DEFECT-FLAG RESETTING                      */
*                DFLAGC = DEFECTIV;                                1501
         OI    DFLAGC,B'10000000'                                  1501
*/*              END-THEN                                            */
*                END;                                              1502
*/*          IF DISSOCIATION FAILS BUT TRACK RECOVERED               */
*            IF RETCODE9 = DISFAILR                                1503
*/*            THEN                                                  */
*              THEN DO;                                            1503
*                                                                  1503
@RF01491 CLC   RETCODE9(4),@CF00136                                1503
         BNE   @RF01503                                            1503
*/*              SAVE THE DEFECT-FLAG RESETTING                      */
*                DFLAGC = NODEFECT;                                1505
         NI    DFLAGC,B'01111111'                                  1505
*/*              SET WARNING MESSAGE ARGUMENT (MSGDISPF)             */
*                DARGSENT = MSGDISPF;                              1506
         L     @06,DDSTRU                                          1506
         MVI   DARGSENT(@06),X'21'                                 1506
*/*              ISSUE_BUILD_PACK_MAP (ALTERNATE TRACK DEF-FLAG SET) */
*                PACKDEF  = DEFECTIV;                              1507
         OI    PACKDEF,B'10000000'                                 1507
*                PACKCHEK = NODEFECT;                              1508
         NI    PACKCHEK,B'01111111'                                1508
*                PACKRCVR = RCVRYES;                               1509
         NI    PACKRCVR,B'01111111'                                1509
*                PACKTRK  = ALTTRACK;                              1510
         NI    PACKTRK,B'01111111'                                 1510
*                PACKTRAK = RZCCHH;                                1511
         L     @06,RZCCHH                                          1511
         ST    @06,PACKTRAK                                        1511
*                PACKASC = RZCCHH;                                 1512
         ST    @06,PACKASC                                         1512
*                CALL BILDPACK;                                    1513
         BAL   @14,BILDPACK                                        1513
*/*              INDICATE MINOR ERROR (LASTCOND = 4)                 */
*                LASTCOND = MAX (LASTCOND,LASTCC04);               1514
         L     @06,@PC00001+8                                      1514
         LH    @03,LASTCOND(,@06)                                  1514
         LA    @15,4                                               1514
         CR    @03,@15                                             1514
         BNL   *+6
         LR    @03,@15                                             1514
         STH   @03,LASTCOND(,@06)                                  1514
*/*              END-THEN                                            */
*                END;                                              1515
*/*          END-ELSE (RECLAMATION UNSUCCESSFUL)                     */
*            END;                                                  1516
@RF01503 DS    0H                                                  1517
*/*      IF A MESSAGE ARGUMENT WAS SET                               */
*        IF (DARGSENT = MSGRCLP)  (DARGSENT = MSGRCLPF)           1517
*          (DARGSENT = MSGDISPF)                                  1517
*/*        THEN ISSUE MESSAGE (UPRINT)                               */
*          THEN DO;                                                1517
*                                                                  1517
@RC01462 L     @06,DDSTRU                                          1517
         CLI   DARGSENT(@06),22                                    1517
         BE    @RT01517                                            1517
         CLI   DARGSENT(@06),32                                    1517
         BE    @RT01517                                            1517
         CLI   DARGSENT(@06),33                                    1517
         BNE   @RF01517                                            1517
@RT01517 DS    0H                                                  1518
*            DARGCNT = 2;                                          1519
         LA    @06,2                                               1519
         L     @03,DDSTRU                                          1519
         STH   @06,DARGCNT(,@03)                                   1519
*            DARGINS (1) = 1;                                      1520
         MVC   DARGINS(2,@03),@CH00165                             1520
*            DARGINL (1) = LENGTH (CTRADDRC);                      1521
         STH   @06,DARGINL(,@03)                                   1521
*            DARGDTM (1) = ADDR (CTRADDRC);                        1522
         LA    @15,CTRADDRC                                        1522
         ST    @15,DARGDTM(,@03)                                   1522
*            DARGINS (2) = 2;                                      1523
         STH   @06,DARGINS+8(,@03)                                 1523
*            DARGINL (2) = LENGTH (CTRADDRT);                      1524
         STH   @06,DARGINL+8(,@03)                                 1524
*            DARGDTM (2) = ADDR (CTRADDRT);                        1525
         LA    @06,CTRADDRT                                        1525
         ST    @06,DARGDTM+8(,@03)                                 1525
*            CALL ICKTPPR0 (GDTTBL                                 1526
*                   ,PRTFILE                                       1526
*                   ,DDSTRU);                                      1526
         L     @06,@PC00001                                        1526
         ST    @06,@AL00001                                        1526
         LA    @03,@CF00094                                        1526
         ST    @03,@AL00001+4                                      1526
         LA    @03,DDSTRU                                          1526
         ST    @03,@AL00001+8                                      1526
         MVI   @AL00001+8,X'80'                                    1526
         L     @15,GDTPRT(,@06)                                    1526
         LA    @01,@AL00001                                        1526
         BALR  @14,@15                                             1526
*            END;                                                  1527
*/*      ADJUST THE NUMBER OF AVAILABLE ALTERNATE TRACKS             */
*        IF ALTCOUNT > SALTCNT                                     1528
*          THEN DO;                                                1528
@RF01517 C     SALTCNT,ALTCOUNT                                    1528
         BNL   @RF01528                                            1528
*            IF RZCCHH >= TALPTR                                   1530
*              THEN DO;    TALCNT = TALCNT + 1; END;               1530
         CLC   RZCCHH(4),TALPTR                                    1530
         BL    @RF01530                                            1530
         LA    @06,1                                               1532
         AL    @06,TALCNT                                          1532
         ST    @06,TALCNT                                          1532
*            IF (TALPTRT > 0 & RZCCHHC = TALPTRC &                 1534
*                              RZCCHHT = TALPTRT - 1)             1534
*               (TALPTRT = 0 & RZCCHHC = TALPTRC - 1 &             1534
*                              RZCCHHT = TRKSPCYL - 1)             1534
*              THEN DO;                                            1534
@RF01530 MVC   @ZT00002+2(2),TALPTRT                               1534
         L     @06,@ZT00002                                        1534
         LTR   @06,@06                                             1534
         BNP   @GL00090                                            1534
         CLC   RZCCHHC(2),TALPTRC                                  1534
         BNE   @GL00090                                            1534
         BCTR  @06,0                                               1534
         MVC   @ZT00002+2(2),RZCCHHT                               1534
         C     @06,@ZT00002                                        1534
         BE    @RT01534                                            1534
@GL00090 MVC   @ZT00002+2(2),TALPTRT                               1534
         L     @06,@ZT00002                                        1534
         LTR   @06,@06                                             1534
         BNZ   @RF01534                                            1534
         MVC   @ZT00002+2(2),TALPTRC                               1534
         L     @06,@ZT00002                                        1534
         BCTR  @06,0                                               1534
         MVC   @ZT00002+2(2),RZCCHHC                               1534
         C     @06,@ZT00002                                        1534
         BNE   @RF01534                                            1534
         L     @06,INFOPTR+12                                      1534
         L     @06,TRKSPCYL(,@06)                                  1534
         BCTR  @06,0                                               1534
         MVC   @ZT00002+2(2),RZCCHHT                               1534
         C     @06,@ZT00002                                        1534
         BNE   @RF01534                                            1534
@RT01534 DS    0H                                                  1535
*                TALPTR = RZCCHH;                                  1536
         MVC   TALPTR(4),RZCCHH                                    1536
*                TALCNT = TALCNT + 1;                              1537
         LA    @06,1                                               1537
         AL    @06,TALCNT                                          1537
         ST    @06,TALCNT                                          1537
*                END;                                              1538
*            END;                                                  1539
*/*      END-THEN                                                    */
*        END;                                                      1540
*/*  END-SUB-PROCEDURE ISSUE_RECLAIM_PRIMARY_TRACK                   */
*    END RECPTRAK;                                                 1541
*                                                                  1541
@EL00014 DS    0H                                                  1541
@EF00014 DS    0H                                                  1541
@ER00014 LM    @14,@12,@SA00014                                    1541
         BR    @14                                                 1541
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  WRIHARZD                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE MARK TRACK DEFECTIVE                   */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL MARK THE CURRENT TRACK THAT IS BEING  */
*/*    PROCESSED, DEFECTIVE BY SETTING THE DEFECT-FLAG IN THE        */
*/*    HOME-ADDRESS. IN ADDITION IT WILL ALSO WRITE THE STANDARD-    */
*/*    LENGTH RECORD-ZERO AND CREATE THE PROPER PACK MAP ENTRY.      */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1542
*                                                                  1542
*/*  SUB-PROCEDURE ISSUE_MARK_TRACK_DEFECTIVE                        */
*    WRIHARZD:                                                     1542
*      PROCEDURE                                                   1542
*        (                                                         1542
*        WRIADDR,                                                  1542
*        WRITRTYP                                                  1542
*        );                                                        1542
*                                                                  1542
WRIHARZD STM   @14,@12,@SA00015                                    1542
         MVC   @PC00015(8),0(@01)                                  1542
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/
*                                                                  1543
*      1 WRIADDR,            /* ADDRESS OF TRACK TO BE EXAMINED      */
*                                                                  1543
*        2 WRIADDRC          /* CYLINDER NUMBER                      */
*                            FIXED (16),                           1543
*                                                                  1543
*        2 WRIADDRH          /* TRACK NUMBER                         */
*                            FIXED (16),                           1543
*                                                                  1543
*                                                                  1543
*      WRITRTYP              /* FLAG TO INDICATE IF THE TRACK IS     */
*                            /* A PRIMARY OR AN ALTERNATE            */
*                            /* PRITRACK: PRIMARY                    */
*                            /* ALTTRACK: ALTERNATE                  */
*                            BIT (1),                              1543
*                                                                  1543
*      RETCODEA              /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31);                           1543
*                                                                  1543
*    OLDERID2 = NEWERID2;                                          1544
         L     @06,@PC00001                                        1544
         L     @06,GDTTR2(,@06)                                    1544
         MVC   @TS00001(95),NEWERID2(@06)                          1544
         MVC   OLDERID2(95,@06),@TS00001                           1544
*    NEWID2 = 'ITWD';                                              1545
         MVC   NEWID2(4,@06),@CC00981                              1545
*/*  IF TRACK IS PRIMARY                                             */
*    IF WRITRTYP = PRITRACK                                        1546
*/*    THEN SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */
*/*     DEFECT-FLAG SET ON A PRIMARY TRACK                           */
*      THEN DO;    HAACTION = ACTWPHAD; END;                       1546
         L     @06,@PC00015+4                                      1546
         TM    WRITRTYP(@06),B'10000000'                           1546
         BNO   @RF01546                                            1546
         MVC   HAACTION(4),@CF00136                                1548
*/*    ELSE SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */
*/*     DEFECT-FLAG SET ON AN ALTERNATE TRACK                        */
*      ELSE DO;    HAACTION = ACTWAHAD; END;                       1550
         B     @RC01546                                            1550
@RF01546 DS    0H                                                  1551
         MVC   HAACTION(4),@CF00255                                1551
*/*  ISSUE CALL TO UDEVOP FOR THE PROPER ACTION                      */
*    CALL ICKDVOP0 (GDTTBL                                         1553
*           ,VOLIB                                                 1553
*           ,HAACTION                                              1553
*           ,WRIADDR                                               1553
*           ,RECNUM                                                1553
*           ,POOLID                                                1553
*           ,DATAPTR                                               1553
*           ,DATALEN                                               1553
*           ,RETCODEA);                                            1553
@RC01546 L     @06,@PC00001                                        1553
         ST    @06,@AL00001                                        1553
         LA    @15,VOLIB                                           1553
         ST    @15,@AL00001+4                                      1553
         LA    @15,HAACTION                                        1553
         ST    @15,@AL00001+8                                      1553
         L     @15,@PC00015                                        1553
         ST    @15,@AL00001+12                                     1553
         LA    @15,RECNUM                                          1553
         ST    @15,@AL00001+16                                     1553
         LA    @15,POOLID                                          1553
         ST    @15,@AL00001+20                                     1553
         LA    @15,DATAPTR                                         1553
         ST    @15,@AL00001+24                                     1553
         LA    @15,DATALEN                                         1553
         ST    @15,@AL00001+28                                     1553
         LA    @15,RETCODEA                                        1553
         ST    @15,@AL00001+32                                     1553
         L     @15,GDTDOP(,@06)                                    1553
         LA    @01,@AL00001                                        1553
         BALR  @14,@15                                             1553
*/*  IF WRITE OPERATION FAILS                                        */
*    IF RETCODEA = CPFAILS                                         1554
*/*    THEN                                                          */
*      THEN DO;                                                    1554
*                                                                  1554
         CLC   RETCODEA(4),@CF00044                                1554
         BNE   @RF01554                                            1554
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        IF WRITRTYP = PRITRACK                                    1556
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1556
         L     @06,@PC00015+4                                      1556
         TM    WRITRTYP(@06),B'10000000'                           1556
         BNO   @RF01556                                            1556
         OI    UNTRTYPE,B'10000000'                                1558
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1560
         B     @RC01556                                            1560
@RF01556 DS    0H                                                  1561
         NI    UNTRTYPE,B'01111111'                                1561
*        UNTRACK = WRIADDR;                                        1563
@RC01556 L     @06,@PC00015                                        1563
         MVC   UNTRACK(4),WRIADDR(@06)                             1563
*        CALL COUNTRKS;                                            1564
         BAL   @14,COUNTRKS                                        1564
*/*      END-THEN (WRITE OPERATION FAILS)                            */
*        END;                                                      1565
*/*    ELSE (WRITE OPERATION SUCCESSFUL)                             */
*      ELSE DO;                                                    1566
*                                                                  1566
         B     @RC01554                                            1566
@RF01554 DS    0H                                                  1567
*/*      IF TRACK IS AN ALTERNATE TRACK                              */
*        IF WRITRTYP = ALTTRACK                                    1567
*/*        THEN                                                      */
*          THEN DO;                                                1567
*                                                                  1567
         L     @06,@PC00015+4                                      1567
         TM    WRITRTYP(@06),B'10000000'                           1567
         BNZ   @RF01567                                            1567
*/*          INDICATE ALTERNATE TRACK FOR PACK MAP ENTRY             */
*            PACKTRK = ALTTRACK;                                   1569
         NI    PACKTRK,B'01111111'                                 1569
*/*          END-THEN                                                */
*            END;                                                  1570
*/*        ELSE INDICATE PRIMARY TRACK FOR PACK MAP ENTRY            */
*          ELSE DO;    PACKTRK = PRITRACK; END;                    1571
         B     @RC01567                                            1571
@RF01567 DS    0H                                                  1572
         OI    PACKTRK,B'10000000'                                 1572
*/*      ISSUE_BUILD_PACK_MAP                                        */
*        PACKDEF = DEFECTIV;                                       1574
@RC01567 OI    PACKDEF,B'10000000'                                 1574
*        PACKCHEK = NODEFECT;                                      1575
         NI    PACKCHEK,B'01111111'                                1575
*        PACKRCVR = RCVRYES;                                       1576
         NI    PACKRCVR,B'01111111'                                1576
*        PACKTRAK = WRIADDR;                                       1577
         L     @06,@PC00015                                        1577
         MVC   @TF00001(4),WRIADDR(@06)                            1577
         L     @06,@TF00001                                        1577
         ST    @06,PACKTRAK                                        1577
*        PACKASC = WRIADDR;                                        1578
         ST    @06,PACKASC                                         1578
*        CALL BILDPACK;                                            1579
         BAL   @14,BILDPACK                                        1579
*/*      WRITE THE STANDARD-LENGTH RECORD-ZERO (UDEVOP)              */
*        CALL ICKDVOP0 (GDTTBL                                     1580
*               ,VOLIB                                             1580
*               ,ACTWRZS                                           1580
*               ,WRIADDR                                           1580
*               ,RECNUM                                            1580
*               ,POOLID                                            1580
*               ,ADDR(WRIADDR)                                     1580
*               ,LENGTH(WRIADDR)                                   1580
*               ,RETCODEA);                                        1580
         L     @06,@PC00001                                        1580
         ST    @06,@AL00001                                        1580
         LA    @15,VOLIB                                           1580
         ST    @15,@AL00001+4                                      1580
         LA    @15,@CF00161                                        1580
         ST    @15,@AL00001+8                                      1580
         L     @15,@PC00015                                        1580
         ST    @15,@AL00001+12                                     1580
         LA    @14,RECNUM                                          1580
         ST    @14,@AL00001+16                                     1580
         LA    @14,POOLID                                          1580
         ST    @14,@AL00001+20                                     1580
         ST    @15,@AFTEMPS+4                                      1580
         LA    @15,@AFTEMPS+4                                      1580
         ST    @15,@AL00001+24                                     1580
         LA    @15,@CF00044                                        1580
         ST    @15,@AL00001+28                                     1580
         LA    @15,RETCODEA                                        1580
         ST    @15,@AL00001+32                                     1580
         L     @15,GDTDOP(,@06)                                    1580
         LA    @01,@AL00001                                        1580
         BALR  @14,@15                                             1580
*/*      IF WRITE OPERATION FAILS                                    */
*        IF RETCODEA = CPFAILS                                     1581
*/*        THEN                                                      */
*          THEN DO;                                                1581
*                                                                  1581
         CLC   RETCODEA(4),@CF00044                                1581
         BNE   @RF01581                                            1581
*/*          COUNT_UNRECOVERABLE_TRACKS                              */
*            UNTRACK = WRIADDR;                                    1583
         L     @06,@PC00015                                        1583
         MVC   UNTRACK(4),WRIADDR(@06)                             1583
*            IF WRITRTYP = PRITRACK                                1584
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1584
         L     @06,@PC00015+4                                      1584
         TM    WRITRTYP(@06),B'10000000'                           1584
         BNO   @RF01584                                            1584
         OI    UNTRTYPE,B'10000000'                                1586
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1588
         B     @RC01584                                            1588
@RF01584 DS    0H                                                  1589
         NI    UNTRTYPE,B'01111111'                                1589
*            CALL COUNTRKS;                                        1591
@RC01584 BAL   @14,COUNTRKS                                        1591
*/*          END-THEN                                                */
*            END;                                                  1592
*/*      END-ELSE (WRITE HOME-ADDRESS SUCCESSFUL)                    */
*        END;                                                      1593
*/*  END-SUB-PROCEDURE ISSUE_MARK_TRACK_DEFECTIVE                    */
*    END WRIHARZD;                                                 1594
*                                                                  1594
@EL00015 DS    0H                                                  1594
@EF00015 DS    0H                                                  1594
@ER00015 LM    @14,@12,@SA00015                                    1594
         BR    @14                                                 1594
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  WRIHARZ                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE MARK TRACK NON-DEFECTIVE               */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE WILL MARK THE CURRENT TRACK THAT IS BEING  */
*/*    PROCESSED, NON-DEFECTIVE BY RESETTING THE DEFECT-FLAG IN THE  */
*/*    HOME-ADDRESS. IN ADDITION IT WILL ALSO WRITE THE STANDARD-    */
*/*    LENGTH RECORD-ZERO.                                           */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1595
*                                                                  1595
*/*  SUB-PROCEDURE ISSUE_MARK_TRACK_NON-DEFECTIVE                    */
*    WRIHARZ:                                                      1595
*      PROCEDURE;                                                  1595
WRIHARZ  STM   @14,@01,@SA00016                                    1595
         STM   @03,@12,@SA00016+16                                 1595
*    DCL RETCODEB            /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31);                           1596
*                                                                  1596
*    OLDERID2 = NEWERID2;                                          1597
         L     @06,@PC00001                                        1597
         L     @06,GDTTR2(,@06)                                    1597
         MVC   @TS00001(95),NEWERID2(@06)                          1597
         MVC   OLDERID2(95,@06),@TS00001                           1597
*    NEWID2 = 'ITWN';                                              1598
         MVC   NEWID2(4,@06),@CC00986                              1598
*/*  IF TRACK IS PRIMARY                                             */
*    IF TRACKTYP = PRITRACK                                        1599
*/*    THEN SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */
*/*     DEFECT-FLAG NOT SET ON A PRIMARY TRACK                       */
*      THEN DO;    HAACTION = ACTWPHA; END;                        1599
         TM    TRACKTYP,B'10000000'                                1599
         BNO   @RF01599                                            1599
         MVC   HAACTION(4),@CF00044                                1601
*/*    ELSE SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */
*/*     DEFECT-FLAG NOT SET ON AN ALTERNATE TRACK                    */
*      ELSE DO;    HAACTION = ACTWAHA; END;                        1603
         B     @RC01599                                            1603
@RF01599 DS    0H                                                  1604
         MVC   HAACTION(4),@CF00119                                1604
*/*  ISSUE CALL TO UDEVOP FOR THE PROPER ACTION                      */
*    CALL ICKDVOP0 (GDTTBL                                         1606
*           ,VOLIB                                                 1606
*           ,HAACTION                                              1606
*           ,CTRADDR                                               1606
*           ,RECNUM                                                1606
*           ,POOLID                                                1606
*           ,DATAPTR                                               1606
*           ,DATALEN                                               1606
*           ,RETCODEB);                                            1606
@RC01599 L     @06,@PC00001                                        1606
         ST    @06,@AL00001                                        1606
         LA    @15,VOLIB                                           1606
         ST    @15,@AL00001+4                                      1606
         LA    @15,HAACTION                                        1606
         ST    @15,@AL00001+8                                      1606
         LA    @15,CTRADDR                                         1606
         ST    @15,@AL00001+12                                     1606
         LA    @15,RECNUM                                          1606
         ST    @15,@AL00001+16                                     1606
         LA    @15,POOLID                                          1606
         ST    @15,@AL00001+20                                     1606
         LA    @15,DATAPTR                                         1606
         ST    @15,@AL00001+24                                     1606
         LA    @15,DATALEN                                         1606
         ST    @15,@AL00001+28                                     1606
         LA    @15,RETCODEB                                        1606
         ST    @15,@AL00001+32                                     1606
         L     @15,GDTDOP(,@06)                                    1606
         LA    @01,@AL00001                                        1606
         BALR  @14,@15                                             1606
*/*  IF WRITE OPERATION FAILS                                        */
*    IF RETCODEB = CPFAILS                                         1607
*/*    THEN                                                          */
*      THEN DO;                                                    1607
*                                                                  1607
         CLC   RETCODEB(4),@CF00044                                1607
         BNE   @RF01607                                            1607
*/*      INDICATE SUB-PROCEDURE FAILS                                */
*        SPROCODE = FAILED;                                        1609
         LA    SPROCODE,2                                          1609
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        IF TRACKTYP = PRITRACK                                    1610
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1610
         TM    TRACKTYP,B'10000000'                                1610
         BNO   @RF01610                                            1610
         OI    UNTRTYPE,B'10000000'                                1612
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1614
         B     @RC01610                                            1614
@RF01610 DS    0H                                                  1615
         NI    UNTRTYPE,B'01111111'                                1615
*        UNTRACK = CTRADDR;                                        1617
@RC01610 MVC   UNTRACK(4),CTRADDR                                  1617
*        CALL COUNTRKS;                                            1618
         BAL   @14,COUNTRKS                                        1618
*/*      END-THEN (WRITE OPERATION FAILS)                            */
*        END;                                                      1619
*/*    ELSE (WRITE OPERATION SUCCESSFUL OR TRACK RECOVERED)          */
*      ELSE DO;                                                    1620
*                                                                  1620
         B     @RC01607                                            1620
@RF01607 DS    0H                                                  1621
*/*      IF DEFECT-FLAG SET DUE TO RECOVERY                          */
*        IF RETCODEB = DFLAGONA  RETCODEB = DFLAGONP              1621
*/*        THEN INDICATE SUB-PROCEDURE FOUND TRACK RECOVERED         */
*          THEN DO;    SPROCODE = FAILRCV; END;                    1621
         L     @06,RETCODEB                                        1621
         CH    @06,@CH00119                                        1621
         BE    @RT01621                                            1621
         CH    @06,@CH00116                                        1621
         BNE   @RF01621                                            1621
@RT01621 DS    0H                                                  1622
         LA    SPROCODE,1                                          1623
*/*        ELSE INDICATE SUB-PROCEDURE SUCCEEDED                     */
*          ELSE DO;    SPROCODE = SUCCESS; END;                    1625
         B     @RC01621                                            1625
@RF01621 DS    0H                                                  1626
         SLR   SPROCODE,SPROCODE                                   1626
*/*      WRITE THE STANDARD-LENGTH RECORD-ZERO (UDEVOP)              */
*        IF RZCCHH = CTRADDR                                       1628
*          THEN DO;    RZACTION = ACTWRZS; END;                    1628
@RC01621 CLC   RZCCHH(4),CTRADDR                                   1628
         BNE   @RF01628                                            1628
         MVC   RZACTION(4),@CF00161                                1630
*          ELSE DO;    RZACTION = ACTWRZSL; END;                   1632
         B     @RC01628                                            1632
@RF01628 DS    0H                                                  1633
         MVC   RZACTION(4),@CF00276                                1633
*        CALL ICKDVOP0 (GDTTBL                                     1635
*               ,VOLIB                                             1635
*               ,RZACTION                                          1635
*               ,CTRADDR                                           1635
*               ,RECNUM                                            1635
*               ,POOLID                                            1635
*               ,ADDR(RZCCHH)                                      1635
*               ,LENGTH(RZCCHH)                                    1635
*               ,RETCODEB);                                        1635
@RC01628 L     @06,@PC00001                                        1635
         ST    @06,@AL00001                                        1635
         LA    @15,VOLIB                                           1635
         ST    @15,@AL00001+4                                      1635
         LA    @15,RZACTION                                        1635
         ST    @15,@AL00001+8                                      1635
         LA    @15,CTRADDR                                         1635
         ST    @15,@AL00001+12                                     1635
         LA    @15,RECNUM                                          1635
         ST    @15,@AL00001+16                                     1635
         LA    @15,POOLID                                          1635
         ST    @15,@AL00001+20                                     1635
         LA    @15,RZCCHH                                          1635
         ST    @15,@AFTEMPS+8                                      1635
         LA    @15,@AFTEMPS+8                                      1635
         ST    @15,@AL00001+24                                     1635
         LA    @15,@CF00044                                        1635
         ST    @15,@AL00001+28                                     1635
         LA    @15,RETCODEB                                        1635
         ST    @15,@AL00001+32                                     1635
         L     @15,GDTDOP(,@06)                                    1635
         LA    @01,@AL00001                                        1635
         BALR  @14,@15                                             1635
*/*      IF WRITE OPERATION FAILS                                    */
*        IF RETCODEB = CPFAILS                                     1636
*/*        THEN                                                      */
*          THEN DO;                                                1636
*                                                                  1636
         CLC   RETCODEB(4),@CF00044                                1636
         BNE   @RF01636                                            1636
*/*          INDICATE SUB-PROCEDURE FAILS                            */
*            SPROCODE = FAILED;                                    1638
         LA    SPROCODE,2                                          1638
*/*          COUNT_UNRECOVERABLE_TRACKS                              */
*            UNTRACK = CTRADDR;                                    1639
         MVC   UNTRACK(4),CTRADDR                                  1639
*            IF TRACKTYP = PRITRACK                                1640
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1640
         TM    TRACKTYP,B'10000000'                                1640
         BNO   @RF01640                                            1640
         OI    UNTRTYPE,B'10000000'                                1642
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1644
         B     @RC01640                                            1644
@RF01640 DS    0H                                                  1645
         NI    UNTRTYPE,B'01111111'                                1645
*            CALL COUNTRKS;                                        1647
@RC01640 BAL   @14,COUNTRKS                                        1647
*/*          END-THEN                                                */
*            END;                                                  1648
*/*        ELSE (WRITE R0 SUCCESSFUL OR TRACK RECOVERED)             */
*          ELSE DO;                                                1649
*                                                                  1649
         B     @RC01636                                            1649
@RF01636 DS    0H                                                  1650
*/*          IF DEFECT-FLAG SET DUE TO RECOVERY                      */
*            IF RETCODEB = DFLAGONA  RETCODEB = DFLAGONP          1650
*/*            THEN INDICATE SUB-PROCEDURE FOUND TRACK RECOVERED     */
*              THEN DO;    SPROCODE = FAILRCV; END;                1650
         L     @06,RETCODEB                                        1650
         CH    @06,@CH00119                                        1650
         BE    @RT01650                                            1650
         CH    @06,@CH00116                                        1650
         BNE   @RF01650                                            1650
@RT01650 DS    0H                                                  1651
         LA    SPROCODE,1                                          1652
*/*            ELSE INDICATE SUB-PROCEDURE SUCCEEDED                 */
*              ELSE DO;    SPROCODE = SUCCESS; END;                1654
         B     @RC01650                                            1654
@RF01650 DS    0H                                                  1655
         SLR   SPROCODE,SPROCODE                                   1655
*/*          END-ELSE (WRITE R0 SUCCESSFUL OR TRACK RECOVERED)       */
*            END;                                                  1657
*/*      END-ELSE (WRITE HOME-ADDRESS SUCCESSFUL OR TRACK RECOVERED) */
*        END;                                                      1658
*/*  END-SUB-PROCEDURE ISSUE_MARK_TRACK_NON-DEFECTIVE                */
*    END WRIHARZ;                                                  1659
*                                                                  1659
@EL00016 DS    0H                                                  1659
@EF00016 DS    0H                                                  1659
@ER00016 LM    @14,@01,@SA00016                                    1659
         LM    @03,@12,@SA00016+16                                 1659
         BR    @14                                                 1659
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  COUNTRKS                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  COUNT UNRECOVERABLE TRACKS                   */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE KEEPS TRACK OF THE NUMBER OF UNRECOVERABLE */
*/*    TRACKS ENCOUNTERED. IT WILL CAUSE A TERMINATION IF THE NUMBER */
*/*    OF TRACKS FOUND UNRECOVERABLE EXCEEDS A DESIGN THRESHOLD.     */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1660
*                                                                  1660
*/*  SUB-PROCEDURE COUNT_UNRECOVERABLE_TRACKS                        */
*    COUNTRKS:                                                     1660
*      PROCEDURE;                                                  1660
COUNTRKS STM   @14,@12,@SA00017                                    1660
*      DCL RETCODEC          /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31);                           1661
*                                                                  1661
*    OLDERID2 = NEWERID2;                                          1662
         L     @06,@PC00001                                        1662
         L     @06,GDTTR2(,@06)                                    1662
         MVC   @TS00001(95),NEWERID2(@06)                          1662
         MVC   OLDERID2(95,@06),@TS00001                           1662
*    NEWID2 =  'ITUT';                                             1663
         MVC   NEWID2(4,@06),@CC00991                              1663
*/*  IF THE UNRECOVERABLE TRACK IS THE ONE THAT IS BEING PROCESSED   */
*/*   CURRENTLY                                                      */
*    IF UNTRACK = CTRADDR                                          1664
*/*    THEN                                                          */
*      THEN DO;                                                    1664
*                                                                  1664
         L     @06,CTRADDR                                         1664
         CL    @06,UNTRACK                                         1664
         BNE   @RF01664                                            1664
*/*      SET FLAG TO INDICATE TRACK WAS FOUND TO BE UNRECOVERABLE    */
*        RCVRFLAG = NORCVR;                                        1666
         NI    RCVRFLAG,B'01111111'                                1666
*/*      IF THE TRACK IS THE FIRST ON PACK                           */
*        IF CTRADDR = 0                                            1667
*/*        THEN INDICATE A SEVERE ERROR                              */
*          THEN DO;    LASTCOND = LASTCC12; END;                   1667
         LTR   @06,@06                                             1667
         BNZ   @RF01667                                            1667
         L     @06,@PC00001+8                                      1669
         MVC   LASTCOND(2,@06),@CH00265                            1669
*/*      END-THEN                                                    */
*        END;                                                      1671
@RF01667 DS    0H                                                  1672
*/*  IF TRACK IS AN ALTERNATE                                        */
*    IF UNTRTYPE = ALTTRACK                                        1672
*/*    THEN                                                          */
*      THEN DO;                                                    1672
*                                                                  1672
@RF01664 TM    UNTRTYPE,B'10000000'                                1672
         BNZ   @RF01672                                            1672
*/*      WRITE ALTERNATE HA WITH DEFECT-FLAG SET                     */
*        CALL ICKDVOP0 (GDTTBL                                     1674
*               ,VOLIB                                             1674
*               ,ACTWAHAD                                          1674
*               ,UNTRACK                                           1674
*               ,RECNUM                                            1674
*               ,POOLID                                            1674
*               ,DATAPTR                                           1674
*               ,DATALEN                                           1674
*               ,RETCODEC);                                        1674
         L     @06,@PC00001                                        1674
         ST    @06,@AL00001                                        1674
         LA    @15,VOLIB                                           1674
         ST    @15,@AL00001+4                                      1674
         LA    @15,@CF00255                                        1674
         ST    @15,@AL00001+8                                      1674
         LA    @15,UNTRACK                                         1674
         ST    @15,@AL00001+12                                     1674
         LA    @15,RECNUM                                          1674
         ST    @15,@AL00001+16                                     1674
         LA    @15,POOLID                                          1674
         ST    @15,@AL00001+20                                     1674
         LA    @15,DATAPTR                                         1674
         ST    @15,@AL00001+24                                     1674
         LA    @15,DATALEN                                         1674
         ST    @15,@AL00001+28                                     1674
         LA    @15,RETCODEC                                        1674
         ST    @15,@AL00001+32                                     1674
         L     @15,GDTDOP(,@06)                                    1674
         LA    @01,@AL00001                                        1674
         BALR  @14,@15                                             1674
*/*      IF WRITE OPERATION IS SUCCESSFUL                            */
*        IF RETCODEC = SUCCESS                                     1675
*/*        THEN                                                      */
*          THEN DO;                                                1675
*                                                                  1675
         SLR   @06,@06                                             1675
         C     @06,RETCODEC                                        1675
         BNE   @RF01675                                            1675
*/*          ISSUE_BUILD_PACK_MAP (TRACK WITH DEFECT-FLAG SET)       */
*            PACKDEF  = DEFECTIV;                                  1677
         OI    PACKDEF,B'10000000'                                 1677
*            PACKCHEK = NODEFECT;                                  1678
         NI    PACKCHEK,B'01111111'                                1678
*            PACKRCVR = RCVRYES;                                   1679
         NI    PACKRCVR,B'01111111'                                1679
*            PACKTRK  = ALTTRACK;                                  1680
         NI    PACKTRK,B'01111111'                                 1680
*            PACKTRAK = UNTRACK;                                   1681
         MVC   PACKTRAK(4),UNTRACK                                 1681
*            PACKASC = 0;                                          1682
         ST    @06,PACKASC                                         1682
*            CALL BILDPACK;                                        1683
         BAL   @14,BILDPACK                                        1683
*/*          RETURN                                                  */
*            RETURN;                                               1684
@EL00017 DS    0H                                                  1684
@EF00017 DS    0H                                                  1684
@ER00017 LM    @14,@12,@SA00017                                    1684
         BR    @14                                                 1684
*/*          END-THEN                                                */
*            END;                                                  1685
*/*      END-THEN                                                    */
*        END;                                                      1686
@RF01675 DS    0H                                                  1687
*/*  ISSUE_BUILD_PACK_MAP (TRACK IS UNRECOVERABLE)                   */
*    PACKDEF  = NODEFECT;                                          1687
@RF01672 NI    PACKDEF,B'01111111'                                 1687
*    PACKCHEK = NODEFECT;                                          1688
         NI    PACKCHEK,B'01111111'                                1688
*    PACKRCVR = RCVRNO;                                            1689
         OI    PACKRCVR,B'10000000'                                1689
*    IF UNTRTYPE = PRITRACK                                        1690
*      THEN DO;    PACKTRK = PRITRACK; END;                        1690
         TM    UNTRTYPE,B'10000000'                                1690
         BNO   @RF01690                                            1690
         OI    PACKTRK,B'10000000'                                 1692
*      ELSE DO;    PACKTRK = ALTTRACK; END;                        1694
         B     @RC01690                                            1694
@RF01690 DS    0H                                                  1695
         NI    PACKTRK,B'01111111'                                 1695
*    PACKTRAK = UNTRACK;                                           1697
@RC01690 MVC   PACKTRAK(4),UNTRACK                                 1697
*    PACKASC = 0;                                                  1698
         SLR   @06,@06                                             1698
         ST    @06,PACKASC                                         1698
*    CALL BILDPACK;                                                1699
         BAL   @14,BILDPACK                                        1699
*/*  INCREMENT COUNT OF UNRECOVERABLE TRACKS (COUNTUTR)              */
*    COUNTUTR = COUNTUTR + 1;                                      1700
         LA    @06,1                                               1700
         AL    @06,COUNTUTR                                        1700
         ST    @06,COUNTUTR                                        1700
*/*  WRITE A WARNING MESSAGE (MSGAUTRK OR MSGPUTRK) (UPRINT)         */
*    IF UNTRTYPE = PRITRACK                                        1701
*      THEN DO;    DARGSENT = MSGPUTRK; END;                       1701
         TM    UNTRTYPE,B'10000000'                                1701
         BNO   @RF01701                                            1701
         L     @06,DDSTRU                                          1703
         MVI   DARGSENT(@06),X'02'                                 1703
*      ELSE DO;    DARGSENT = MSGAUTRK; END;                       1705
         B     @RC01701                                            1705
@RF01701 DS    0H                                                  1706
         L     @06,DDSTRU                                          1706
         MVI   DARGSENT(@06),X'01'                                 1706
*    DARGCNT = 2;                                                  1708
@RC01701 LA    @06,2                                               1708
         L     @15,DDSTRU                                          1708
         STH   @06,DARGCNT(,@15)                                   1708
*    DARGINS (1) = 1;                                              1709
         MVC   DARGINS(2,@15),@CH00165                             1709
*    DARGINL (1) = LENGTH (UNTRACKC);                              1710
         STH   @06,DARGINL(,@15)                                   1710
*    DARGDTM (1) = ADDR (UNTRACKC);                                1711
         LA    @14,UNTRACKC                                        1711
         ST    @14,DARGDTM(,@15)                                   1711
*    DARGINS (2) = 2;                                              1712
         STH   @06,DARGINS+8(,@15)                                 1712
*    DARGINL (2) = LENGTH (UNTRACKT);                              1713
         STH   @06,DARGINL+8(,@15)                                 1713
*    DARGDTM (2) = ADDR (UNTRACKT);                                1714
         LA    @06,UNTRACKT                                        1714
         ST    @06,DARGDTM+8(,@15)                                 1714
*    CALL ICKTPPR0 (GDTTBL                                         1715
*           ,PRTFILE                                               1715
*           ,DDSTRU);                                              1715
         L     @06,@PC00001                                        1715
         ST    @06,@AL00001                                        1715
         LA    @15,@CF00094                                        1715
         ST    @15,@AL00001+4                                      1715
         LA    @15,DDSTRU                                          1715
         ST    @15,@AL00001+8                                      1715
         MVI   @AL00001+8,X'80'                                    1715
         L     @15,GDTPRT(,@06)                                    1715
         LA    @01,@AL00001                                        1715
         BALR  @14,@15                                             1715
*/*  INDICATE A MINOR ERROR                                          */
*    LASTCOND = MAX (LASTCOND,LASTCC04);                           1716
         L     @06,@PC00001+8                                      1716
         LH    @15,LASTCOND(,@06)                                  1716
         LA    @14,4                                               1716
         CR    @15,@14                                             1716
         BNL   *+6
         LR    @15,@14                                             1716
         STH   @15,LASTCOND(,@06)                                  1716
*/*  IF COUNT OF UNRECOVERABLE TRACKS MEETS THRESHOLD                */
*    IF COUNTUTR >= THRESHLD                                       1717
*/*    THEN                                                          */
*      THEN DO;                                                    1717
*                                                                  1717
         L     @06,COUNTUTR                                        1717
         L     @01,INFOPTR                                         1717
         C     @06,THRESHLD(,@01)                                  1717
         BL    @RF01717                                            1717
*/*      ISSUE ERROR MESSAGE (MSGTHRSH) (UPRINT)                     */
*        DARGSENT = MSGTHRSH;                                      1719
         L     @06,DDSTRU                                          1719
         MVI   DARGSENT(@06),X'0E'                                 1719
*        CALL ICKTPPR0 (GDTTBL                                     1720
*               ,PRTFILE                                           1720
*               ,DDSTRU);                                          1720
         L     @06,@PC00001                                        1720
         ST    @06,@AL00001                                        1720
         LA    @15,@CF00094                                        1720
         ST    @15,@AL00001+4                                      1720
         LA    @15,DDSTRU                                          1720
         ST    @15,@AL00001+8                                      1720
         MVI   @AL00001+8,X'80'                                    1720
         L     @15,GDTPRT(,@06)                                    1720
         LA    @01,@AL00001                                        1720
         BALR  @14,@15                                             1720
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */
*        LASTCOND = LASTCC12;                                      1721
         L     @06,@PC00001+8                                      1721
         MVC   LASTCOND(2,@06),@CH00265                            1721
*/*      END-THEN                                                    */
*        END;                                                      1722
*/*  END-SUB-PROCEDURE COUNT_UNRECOVERABLE_TRACKS                    */
*    END COUNTRKS;                                                 1723
*                                                                  1723
         B     @EL00017                                            1723
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  BILDPACK                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE BUILD PACK MAP                         */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION THAT       */
*/*    BUILDS A PACK MAP ENTRY.                                      */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1724
*                                                                  1724
*/*  SUB-PROCEDURE ISSUE_BUILD_PACK_MAP                              */
*    BILDPACK:                                                     1724
*      PROCEDURE;                                                  1724
BILDPACK STM   @14,@12,@SA00018                                    1724
*    OLDERID2 = NEWERID2;                                          1725
         L     @06,@PC00001                                        1725
         L     @06,GDTTR2(,@06)                                    1725
         MVC   @TS00001(95),NEWERID2(@06)                          1725
         MVC   OLDERID2(95,@06),@TS00001                           1725
*    NEWID2 =  'ITBP';                                             1726
         MVC   NEWID2(4,@06),@CC00995                              1726
*/*  IF THERE IS NO STORAGE AVAILABLE TO BUILD ANOTHER ENTRY         */
*    IF PACKENT = STORNO                                           1727
*/*    THEN RETURN                                                   */
*      THEN DO;    RETURN; END;                                    1727
         TM    PACKENT,B'10000000'                                 1727
         BNO   @RF01727                                            1727
@EL00018 DS    0H                                                  1729
@EF00018 DS    0H                                                  1729
@ER00018 LM    @14,@12,@SA00018                                    1729
         BR    @14                                                 1729
*/*  BUILD_PACK_MAP                                                  */
*    CALL ICKBM01                                                  1731
*         (GDTTBL                                                  1731
*         ,VOLIB                                                   1731
*         ,PACKTRAK                                                1731
*         ,PACKASC                                                 1731
*         ,PACKTRK                                                 1731
*         ,PACKDEF                                                 1731
*         ,PACKCHEK                                                1731
*         ,PACKRCVR                                                1731
*         ,RETCODE);                                               1731
@RF01727 L     @06,@PC00001                                        1731
         ST    @06,@AL00001                                        1731
         LA    @06,VOLIB                                           1731
         ST    @06,@AL00001+4                                      1731
         LA    @06,PACKTRAK                                        1731
         ST    @06,@AL00001+8                                      1731
         LA    @06,PACKASC                                         1731
         ST    @06,@AL00001+12                                     1731
         LA    @06,PACKTRK                                         1731
         ST    @06,@AL00001+16                                     1731
         LA    @06,PACKDEF                                         1731
         ST    @06,@AL00001+20                                     1731
         LA    @06,PACKCHEK                                        1731
         ST    @06,@AL00001+24                                     1731
         LA    @06,PACKRCVR                                        1731
         ST    @06,@AL00001+28                                     1731
         LA    @06,RETCODE                                         1731
         ST    @06,@AL00001+32                                     1731
         L     @15,@CV00996                                        1731
         LA    @01,@AL00001                                        1731
         BALR  @14,@15                                             1731
*/*  IF STORAGE IS NOT AVAILABLE                                     */
*    IF RETCODE = FAILURE                                          1732
*/*    THEN                                                          */
*      THEN DO;                                                    1732
*                                                                  1732
         CLC   RETCODE(4),@CF00165                                 1732
         BNE   @RF01732                                            1732
*/*      SET FLAG TO INDICATE NO STORAGE IS AVAILABLE                */
*        PACKENT = STORNO;                                         1734
         OI    PACKENT,B'10000000'                                 1734
*/*      INDICATE AN ERROR (LASTCOND = 8)                            */
*        LASTCOND = MAX(LASTCC08,LASTCOND);                        1735
         L     @06,@PC00001+8                                      1735
         LH    @15,LASTCOND(,@06)                                  1735
         LA    @14,8                                               1735
         CR    @15,@14                                             1735
         BNL   *+6
         LR    @15,@14                                             1735
         STH   @15,LASTCOND(,@06)                                  1735
*/*      END-THEN                                                    */
*        END;                                                      1736
*/*  END-SUB-PROCEDURE ISSUE_BUILD_PACK_MAP                          */
*    END BILDPACK;                                                 1737
*                                                                  1737
         B     @EL00018                                            1737
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  CHASSOC                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  CHECK_ASSOCIATION                            */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE SETS THE ASSOCIATION FLAG TO INDICATE      */
*/*    IF A TRACK IS ASSOCIATED WITH ANOTHER TRACK.                  */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1738
*                                                                  1738
*/*  SUB-PROCEDURE CHECK_ASSOCIATION                                 */
*    CHASSOC:                                                      1738
*      PROCEDURE;                                                  1738
CHASSOC  STM   @14,@12,@SA00019                                    1738
*    OLDERID2 = NEWERID2;                                          1739
         L     @06,@PC00001                                        1739
         L     @06,GDTTR2(,@06)                                    1739
         MVC   @TS00001(95),NEWERID2(@06)                          1739
         MVC   OLDERID2(95,@06),@TS00001                           1739
*    NEWID2 =  'ITCA';                                             1740
         MVC   NEWID2(4,@06),@CC01000                              1740
*/*  IF DEFECTIVE PRIMARY TRACK                                      */
*    IF TRACKTYP = PRITRACK & DFLAGC = DEFECTIV                    1741
*/*    THEN                                                          */
*      THEN DO;                                                    1741
*                                                                  1741
         TM    TRACKTYP,B'10000000'                                1741
         BNO   @RF01741                                            1741
         TM    DFLAGC,B'10000000'                                  1741
         BNO   @RF01741                                            1741
*/*      IF THE TRACK ASSOCIATION ADDRESS IS POINTING TO AN ALTERNATE*/
*        IF (RZCCHHC >= FIRSTALC) & (RZCCHHC <= FINALTC)           1743
*         & (RZCCHHT >= FIRSTALT) & (RZCCHHT <= FINALTT)           1743
*/*        THEN                                                      */
*          THEN DO;                                                1743
*                                                                  1743
         L     @06,INFOPTR+48                                      1743
         CLC   RZCCHHC(2),FIRSTALC(@06)                            1743
         BL    @RF01743                                            1743
         L     @15,INFOPTR+60                                      1743
         CLC   RZCCHHC(2),FINALTC(@15)                             1743
         BH    @RF01743                                            1743
         CLC   RZCCHHT(2),FIRSTALT(@06)                            1743
         BL    @RF01743                                            1743
         CLC   RZCCHHT(2),FINALTT(@15)                             1743
         BH    @RF01743                                            1743
*/*          OBTAIN_TRACK_STATUS (OF THE ALTERNATE TRACK)            */
*            CALL OBTTRST (RZCCHH                                  1745
*                         ,DFLAGA                                  1745
*                         ,RZACCHH                                 1745
*                         ,ALTTRACK);                              1745
         LA    @06,RZCCHH                                          1745
         ST    @06,@AL00001                                        1745
         LA    @06,DFLAGA                                          1745
         ST    @06,@AL00001+4                                      1745
         LA    @06,RZACCHH                                         1745
         ST    @06,@AL00001+8                                      1745
         LA    @06,@CB00468                                        1745
         ST    @06,@AL00001+12                                     1745
         LA    @01,@AL00001                                        1745
         BAL   @14,OBTTRST                                         1745
*/*          IF NO SEVERE ERRORS FOUND (LASTCOND < 12)               */
*            IF LASTCOND < LASTCC12                                1746
*/*            THEN                                                  */
*              THEN DO;                                            1746
*                                                                  1746
         L     @06,@PC00001+8                                      1746
         LH    @06,LASTCOND(,@06)                                  1746
         CH    @06,@CH00265                                        1746
         BNL   @RF01746                                            1746
*/*              IF ASSOCIATION ADDRESS OF THE ALTERNATE IS POINTING */
*/*               TO THE PRIMARY TRACK IN QUESTION AND THE ALTERNATE */
*/*               TRACK IS NOT FLAGGED DEFECTIVE                     */
*                IF (RZACCHH = CTRADDR) & (DFLAGA = NODEFECT)      1748
*/*                THEN INDICATE TRACK IS ASSOCIATED                 */
*                  THEN DO;    ASSOCFLG = ASSOCYES; END;           1748
         CLC   RZACCHH(4),CTRADDR                                  1748
         BNE   @RF01748                                            1748
         TM    DFLAGA,B'10000000'                                  1748
         BNZ   @RF01748                                            1748
         OI    ASSOCFLG,B'10000000'                                1750
*/*                ELSE INDICATE TRACK IS NOT ASSOCIATED             */
*                  ELSE DO;    ASSOCFLG = ASSOCNO; END;            1752
         B     @RC01748                                            1752
@RF01748 DS    0H                                                  1753
         NI    ASSOCFLG,B'01111111'                                1753
*/*              END-THEN (NO SEVERE ERRORS)                         */
*                END;                                              1755
*/*          END-THEN (PRIMARY ASSOCIATED TO ALTERNATE)              */
*            END;                                                  1756
*/*        ELSE INDICATE NO BACKWARD ASSOCIATION EXISTS              */
*          ELSE DO;    RZACCHHX = 'FFFFFFFF'X; END;                1757
         B     @RC01743                                            1757
@RF01743 DS    0H                                                  1758
         MVC   RZACCHHX(4),@CB00881                                1758
*/*      END-THEN (DEFECTIVE PRIMARY TRACK)                          */
*        END;                                                      1760
@RC01743 DS    0H                                                  1761
*/*  IF NON-DEFECTIVE ALTERNATE TRACK                                */
*    IF TRACKTYP = ALTTRACK & DFLAGC = NODEFECT                    1761
*/*    THEN                                                          */
*      THEN DO;                                                    1761
*                                                                  1761
@RF01741 TM    TRACKTYP,B'10000000'                                1761
         BNZ   @RF01761                                            1761
         TM    DFLAGC,B'10000000'                                  1761
         BNZ   @RF01761                                            1761
*/*      IF THE TRACK ASSOCIATION ADDRESS IS POINTING TO A PRIMARY   */
*        IF (RZCCHHC <= FINPRIC) & (RZCCHHT <= FINPRIT)            1763
*         & (RZCCHHT >= 0)                                         1763
*/*        THEN                                                      */
*          THEN DO;                                                1763
*                                                                  1763
         L     @06,INFOPTR+72                                      1763
         CLC   RZCCHHC(2),FINPRIC(@06)                             1763
         BH    @RF01763                                            1763
         CLC   RZCCHHT(2),FINPRIT(@06)                             1763
         BH    @RF01763                                            1763
*/*          OBTAIN_TRACK_STATUS (OF THE PRIMARY TRACK)              */
*            CALL OBTTRST (RZCCHH                                  1765
*                         ,DFLAGA                                  1765
*                         ,RZACCHH                                 1765
*                         ,PRITRACK);                              1765
         LA    @06,RZCCHH                                          1765
         ST    @06,@AL00001                                        1765
         LA    @06,DFLAGA                                          1765
         ST    @06,@AL00001+4                                      1765
         LA    @06,RZACCHH                                         1765
         ST    @06,@AL00001+8                                      1765
         LA    @06,@CB00466                                        1765
         ST    @06,@AL00001+12                                     1765
         LA    @01,@AL00001                                        1765
         BAL   @14,OBTTRST                                         1765
*/*          IF NO SEVERE ERRORS FOUND (LASTCOND < 12)               */
*            IF LASTCOND < LASTCC12                                1766
*/*            THEN                                                  */
*              THEN DO;                                            1766
*                                                                  1766
         L     @06,@PC00001+8                                      1766
         LH    @06,LASTCOND(,@06)                                  1766
         CH    @06,@CH00265                                        1766
         BNL   @RF01766                                            1766
*/*              IF ASSOCIATION ADDRESS OF THE PRIMARY IS POINTING   */
*/*               TO THE ALTERNATE TRACK IN QUESTION AND THE PRIMARY */
*/*               TRACK IS FLAGGED DEFECTIVE                         */
*                IF (RZACCHH = CTRADDR) & (DFLAGA = DEFECTIV)      1768
*/*                THEN INDICATE TRACK IS ASSOCIATED                 */
*                  THEN DO;    ASSOCFLG = ASSOCYES; END;           1768
         CLC   RZACCHH(4),CTRADDR                                  1768
         BNE   @RF01768                                            1768
         TM    DFLAGA,B'10000000'                                  1768
         BNO   @RF01768                                            1768
         OI    ASSOCFLG,B'10000000'                                1770
*/*                ELSE INDICATE TRACK IS NOT ASSOCIATED             */
*                  ELSE DO;    ASSOCFLG = ASSOCNO; END;            1772
         B     @RC01768                                            1772
@RF01768 DS    0H                                                  1773
         NI    ASSOCFLG,B'01111111'                                1773
*/*              END-THEN (NO SEVERE ERRORS)                         */
*                END;                                              1775
*/*          END-THEN (ALTERNATE ASSOCIATED WITH PRIMARY)            */
*            END;                                                  1776
*/*      END-THEN (NON-DEFECTIVE ALTERNATE TRACK)                    */
*        END;                                                      1777
*/*  END-SUB-PROCEDURE CHECK_ASSOCIATION                             */
*    END CHASSOC;                                                  1778
*                                                                  1778
@EL00019 DS    0H                                                  1778
@EF00019 DS    0H                                                  1778
@ER00019 LM    @14,@12,@SA00019                                    1778
         BR    @14                                                 1778
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  DESCMESS                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  ISSUE DESCRIPTOR MESSAGE                     */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE ISSUES A WARNING MESSAGE ABOUT A TRACK     */
*/*    DESCRIPTOR WHICH IS IMPROPERLY ASSOCIATED OR HAS ITS DEFECT   */
*/*    FLAG SET ON WITHOUT A PROPER ASSOCIATION.                     */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1779
*                                                                  1779
*/*  SUB-PROCEDURE ISSUE_DESCRIPTOR_MESSAGE                          */
*    DESCMESS:                                                     1779
*      PROCEDURE;                                                  1779
DESCMESS STM   @14,@12,@SA00020                                    1779
*    OLDERID2 = NEWERID2;                                          1780
         L     @06,@PC00001                                        1780
         L     @06,GDTTR2(,@06)                                    1780
         MVC   @TS00001(95),NEWERID2(@06)                          1780
         MVC   OLDERID2(95,@06),@TS00001                           1780
*    NEWID2 =  'ITDM';                                             1781
         MVC   NEWID2(4,@06),@CC01004                              1781
*/*  ISSUE ERROR MESSAGE (MSGMEDAL)                                  */
*    DARGSENT = MSGMEDAL;                                          1782
         L     @06,DDSTRU                                          1782
         MVI   DARGSENT(@06),X'08'                                 1782
*    DARGCNT = 8;                                                  1783
         MVC   DARGCNT(2,@06),@CH00161                             1783
*    IF DFLAGC = DEFECTIV                                          1784
*      THEN DO;                                                    1784
         TM    DFLAGC,B'10000000'                                  1784
         BNO   @RF01784                                            1784
*        DARGINS (1) = 1;                                          1786
         LA    @15,1                                               1786
         STH   @15,DARGINS(,@06)                                   1786
*        DARGINL (1) = LENGTH ('D');                               1787
         STH   @15,DARGINL(,@06)                                   1787
*        DARGDTM (1) = ADDR ('D');                                 1788
         LA    @15,@CC01005                                        1788
         ST    @15,DARGDTM(,@06)                                   1788
*        END;                                                      1789
*      ELSE DO;                                                    1790
         B     @RC01784                                            1790
@RF01784 DS    0H                                                  1791
*        DARGINS (1) = 1;                                          1791
         LA    @06,1                                               1791
         L     @15,DDSTRU                                          1791
         STH   @06,DARGINS(,@15)                                   1791
*        DARGINL (1) = LENGTH ('N');                               1792
         STH   @06,DARGINL(,@15)                                   1792
*        DARGDTM (1) = ADDR ('N');                                 1793
         LA    @06,@CC01006                                        1793
         ST    @06,DARGDTM(,@15)                                   1793
*        END;                                                      1794
*    DARGINS (2) = 2;                                              1795
@RC01784 LA    @06,2                                               1795
         L     @15,DDSTRU                                          1795
         STH   @06,DARGINS+8(,@15)                                 1795
*    DARGINL (2) = LENGTH (CTRADDRC);                              1796
         STH   @06,DARGINL+8(,@15)                                 1796
*    DARGDTM (2) = ADDR (CTRADDRC);                                1797
         LA    @14,CTRADDRC                                        1797
         ST    @14,DARGDTM+8(,@15)                                 1797
*    DARGINS (3) = 3;                                              1798
         MVC   DARGINS+16(2,@15),@CH00136                          1798
*    DARGINL (3) = LENGTH (CTRADDRT);                              1799
         STH   @06,DARGINL+16(,@15)                                1799
*    DARGDTM (3) = ADDR (CTRADDRT);                                1800
         LA    @14,CTRADDRT                                        1800
         ST    @14,DARGDTM+16(,@15)                                1800
*    DARGINS (4) = 4;                                              1801
         MVC   DARGINS+24(2,@15),@CH00044                          1801
*    DARGINL (4) = LENGTH (RZCCHHC);                               1802
         STH   @06,DARGINL+24(,@15)                                1802
*    DARGDTM (4) = ADDR (RZCCHHC);                                 1803
         LA    @14,RZCCHHC                                         1803
         ST    @14,DARGDTM+24(,@15)                                1803
*    DARGINS (5) = 5;                                              1804
         MVC   DARGINS+32(2,@15),@CH00255                          1804
*    DARGINL (5) = LENGTH (RZCCHHT);                               1805
         STH   @06,DARGINL+32(,@15)                                1805
*    DARGDTM (5) = ADDR (RZCCHHT);                                 1806
         LA    @06,RZCCHHT                                         1806
         ST    @06,DARGDTM+32(,@15)                                1806
*    IF DFLAGA = DEFECTIV                                          1807
*      THEN DO;                                                    1807
         TM    DFLAGA,B'10000000'                                  1807
         BNO   @RF01807                                            1807
*        DARGINS (6) = 6;                                          1809
         MVC   DARGINS+40(2,@15),@CH00119                          1809
*        DARGINL (6) = LENGTH ('D');                               1810
         MVC   DARGINL+40(2,@15),@CH00165                          1810
*        DARGDTM (6) = ADDR ('D');                                 1811
         LA    @06,@CC01005                                        1811
         ST    @06,DARGDTM+40(,@15)                                1811
*        END;                                                      1812
*      ELSE DO;                                                    1813
         B     @RC01807                                            1813
@RF01807 DS    0H                                                  1814
*        DARGINS (6) = 6;                                          1814
         L     @06,DDSTRU                                          1814
         MVC   DARGINS+40(2,@06),@CH00119                          1814
*        DARGINL (6) = LENGTH ('N');                               1815
         MVC   DARGINL+40(2,@06),@CH00165                          1815
*        DARGDTM (6) = ADDR ('N');                                 1816
         LA    @15,@CC01006                                        1816
         ST    @15,DARGDTM+40(,@06)                                1816
*        END;                                                      1817
*    DARGINS (7) = 7;                                              1818
@RC01807 L     @06,DDSTRU                                          1818
         MVC   DARGINS+48(2,@06),@CH00185                          1818
*    DARGINL (7) = LENGTH (RZACCHHC);                              1819
         LA    @15,2                                               1819
         STH   @15,DARGINL+48(,@06)                                1819
*    DARGDTM (7) = ADDR (RZACCHHC);                                1820
         LA    @14,RZACCHHC                                        1820
         ST    @14,DARGDTM+48(,@06)                                1820
*    DARGINS (8) = 8;                                              1821
         MVC   DARGINS+56(2,@06),@CH00161                          1821
*    DARGINL (8) = LENGTH (RZACCHHT);                              1822
         STH   @15,DARGINL+56(,@06)                                1822
*    DARGDTM (8) = ADDR (RZACCHHT);                                1823
         LA    @15,RZACCHHT                                        1823
         ST    @15,DARGDTM+56(,@06)                                1823
*    CALL ICKTPPR0 (GDTTBL                                         1824
*           ,PRTFILE                                               1824
*           ,DDSTRU);                                              1824
         L     @06,@PC00001                                        1824
         ST    @06,@AL00001                                        1824
         LA    @15,@CF00094                                        1824
         ST    @15,@AL00001+4                                      1824
         LA    @15,DDSTRU                                          1824
         ST    @15,@AL00001+8                                      1824
         MVI   @AL00001+8,X'80'                                    1824
         L     @15,GDTPRT(,@06)                                    1824
         LA    @01,@AL00001                                        1824
         BALR  @14,@15                                             1824
*/*  INDICATE AN ERROR                                               */
*    LASTCOND = MAX(LASTCOND,LASTCC08);                            1825
         L     @06,@PC00001+8                                      1825
         LH    @15,LASTCOND(,@06)                                  1825
         LA    @14,8                                               1825
         CR    @15,@14                                             1825
         BNL   *+6
         LR    @15,@14                                             1825
         STH   @15,LASTCOND(,@06)                                  1825
*/*  IF TRACK IS A CRITICAL TRACK                                    */
*    IF CTRADDR = 0  (CTRADDR >= VTLOEX & CTRADDR <= VTHIEX)      1826
*/*    THEN (CRITICAL TRACK)                                         */
*      THEN DO;                                                    1826
         L     @06,CTRADDR                                         1826
         LTR   @06,@06                                             1826
         BZ    @RT01826                                            1826
         L     @15,F4PTR                                           1826
         MVC   @TF00001(4),VTLOEX(@15)                             1826
         CL    @06,@TF00001                                        1826
         BL    @RF01826                                            1826
         MVC   @TF00001(4),VTHIEX(@15)                             1826
         CL    @06,@TF00001                                        1826
         BH    @RF01826                                            1826
@RT01826 DS    0H                                                  1827
*/*      ISSUE SEVERE ERROR MESSAGE                                  */
*        DARGSENT = MSGMINV;                                       1828
         L     @06,DDSTRU                                          1828
         MVI   DARGSENT(@06),X'0C'                                 1828
*        DARGCNT = 2;                                              1829
         LA    @15,2                                               1829
         STH   @15,DARGCNT(,@06)                                   1829
*        DARGINS (1) = 1;                                          1830
         MVC   DARGINS(2,@06),@CH00165                             1830
*        DARGINL (1) = LENGTH (CTRADDRC);                          1831
         STH   @15,DARGINL(,@06)                                   1831
*        DARGDTM (1) = ADDR (CTRADDRC);                            1832
         LA    @14,CTRADDRC                                        1832
         ST    @14,DARGDTM(,@06)                                   1832
*        DARGINS (2) = 2;                                          1833
         STH   @15,DARGINS+8(,@06)                                 1833
*        DARGINL (2) = LENGTH (CTRADDRT);                          1834
         STH   @15,DARGINL+8(,@06)                                 1834
*        DARGDTM (2) = ADDR (CTRADDRT);                            1835
         LA    @15,CTRADDRT                                        1835
         ST    @15,DARGDTM+8(,@06)                                 1835
*        CALL ICKTPPR0 (GDTTBL                                     1836
*               ,PRTFILE                                           1836
*               ,DDSTRU);                                          1836
         L     @06,@PC00001                                        1836
         ST    @06,@AL00001                                        1836
         LA    @15,@CF00094                                        1836
         ST    @15,@AL00001+4                                      1836
         LA    @15,DDSTRU                                          1836
         ST    @15,@AL00001+8                                      1836
         MVI   @AL00001+8,X'80'                                    1836
         L     @15,GDTPRT(,@06)                                    1836
         LA    @01,@AL00001                                        1836
         BALR  @14,@15                                             1836
*/*      END-THEN                                                    */
*        END;                                                      1837
*/*  END-SUB-PROCEDURE ISSUE_DESCRIPTOR_MESSAGE                      */
*    END DESCMESS;                                                 1838
*                                                                  1838
@EL00020 DS    0H                                                  1838
@EF00020 DS    0H                                                  1838
@ER00020 LM    @14,@12,@SA00020                                    1838
         BR    @14                                                 1838
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  VALHOME                                    */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  VALIDATE HOME-ADDRESS                        */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    THIS SUB-PROCEDURE VALIDATES THE HOME-ADDRESS ON A TRACK      */
*/*    BEFORE ANY FORMATTING WRITE OPERATION IS PERFORMED ON THE     */
*/*    TRACK.                                                        */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1839
*                                                                  1839
*/*  SUB-PROCEDURE VALIDATE_HOME-ADDRESS                             */
*    VALHOME:                                                      1839
*      PROCEDURE;                                                  1839
VALHOME  STM   @14,@12,@SA00021                                    1839
*      DCL RETCODED          /* RETURN CODE FROM CALLED PROGRAMS     */
*                            FIXED (31);                           1840
*                                                                  1840
*    OLDERID2 = NEWERID2;                                          1841
         L     @06,@PC00001                                        1841
         L     @06,GDTTR2(,@06)                                    1841
         MVC   @TS00001(95),NEWERID2(@06)                          1841
         MVC   OLDERID2(95,@06),@TS00001                           1841
*    NEWID2 =  'ITVH';                                             1842
         MVC   NEWID2(4,@06),@CC01011                              1842
*/*  IF TRACK IS A PRIMARY TRACK                                     */
*    IF TRACKTYP = PRITRACK                                        1843
*/*    THEN SET ACTION KEY FOR PRIMARY TRACK                         */
*      THEN DO;    VAACTION = ACTVPHA; END;                        1843
         TM    TRACKTYP,B'10000000'                                1843
         BNO   @RF01843                                            1843
         MVC   VAACTION(4),@CF00267                                1845
*/*    ELSE SET ACTION KEY FOR ALTERNATE TRACK                       */
*      ELSE DO;    VAACTION = ACTVAHA; END;                        1847
         B     @RC01843                                            1847
@RF01843 DS    0H                                                  1848
         MVC   VAACTION(4),@CF00274                                1848
*/*  VALIDATE HOME-ADDRESS (UDEVOP)                                  */
*    CALL ICKDVOP0 (GDTTBL                                         1850
*           ,VOLIB                                                 1850
*           ,VAACTION                                              1850
*           ,CTRADDR                                               1850
*           ,RECNUM                                                1850
*           ,POOLID                                                1850
*           ,HAPTR                                                 1850
*           ,HALEN                                                 1850
*           ,RETCODED);                                            1850
@RC01843 L     @06,@PC00001                                        1850
         ST    @06,@AL00001                                        1850
         LA    @15,VOLIB                                           1850
         ST    @15,@AL00001+4                                      1850
         LA    @15,VAACTION                                        1850
         ST    @15,@AL00001+8                                      1850
         LA    @15,CTRADDR                                         1850
         ST    @15,@AL00001+12                                     1850
         LA    @15,RECNUM                                          1850
         ST    @15,@AL00001+16                                     1850
         LA    @15,POOLID                                          1850
         ST    @15,@AL00001+20                                     1850
         LA    @15,HAPTR                                           1850
         ST    @15,@AL00001+24                                     1850
         LA    @15,HALEN                                           1850
         ST    @15,@AL00001+28                                     1850
         LA    @15,RETCODED                                        1850
         ST    @15,@AL00001+32                                     1850
         L     @15,GDTDOP(,@06)                                    1850
         LA    @01,@AL00001                                        1850
         BALR  @14,@15                                             1850
*/*  IF VALIDATION FAILS                                             */
*    IF RETCODED = CPFAILS                                         1851
*/*    THEN                                                          */
*      THEN DO;                                                    1851
         CLC   RETCODED(4),@CF00044                                1851
         BNE   @RF01851                                            1851
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */
*        IF TRACKTYP = PRITRACK                                    1853
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1853
         TM    TRACKTYP,B'10000000'                                1853
         BNO   @RF01853                                            1853
         OI    UNTRTYPE,B'10000000'                                1855
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1857
         B     @RC01853                                            1857
@RF01853 DS    0H                                                  1858
         NI    UNTRTYPE,B'01111111'                                1858
*        UNTRACK = CTRADDR;                                        1860
@RC01853 MVC   UNTRACK(4),CTRADDR                                  1860
*        CALL COUNTRKS;                                            1861
         BAL   @14,COUNTRKS                                        1861
*/*      END-THEN                                                    */
*        END;                                                      1862
*/*    ELSE                                                          */
*      ELSE DO;                                                    1863
         B     @RC01851                                            1863
@RF01851 DS    0H                                                  1864
*/*      IF DEFECT FLAG IS SET                                       */
*        IF RETCODED = DFLAGONP  RETCODED = DFLAGONA              1864
*/*        THEN SAVE THE DEFECT-FLAG SETTING                         */
*          THEN DO;    DFLAGC = DEFECTIV; END;                     1864
         L     @06,RETCODED                                        1864
         CH    @06,@CH00116                                        1864
         BE    @RT01864                                            1864
         CH    @06,@CH00119                                        1864
         BNE   @RF01864                                            1864
@RT01864 DS    0H                                                  1865
         OI    DFLAGC,B'10000000'                                  1866
*/*        ELSE INDICATE THE DEFECT-FLAG IS NOT SET                  */
*          ELSE DO;    DFLAGC = NODEFECT; END;                     1868
         B     @RC01864                                            1868
@RF01864 DS    0H                                                  1869
         NI    DFLAGC,B'01111111'                                  1869
*/*      END-ELSE                                                    */
*        END;                                                      1871
*/*  END-SUB-PROCEDURE VALIDATE_HOME-ADDRESS                         */
*    END VALHOME;                                                  1872
*                                                                  1872
@EL00021 DS    0H                                                  1872
@EF00021 DS    0H                                                  1872
@ER00021 LM    @14,@12,@SA00021                                    1872
         BR    @14                                                 1872
         EJECT
*/*****  START OF SPECIFICATIONS  ************************************/
*/*                                                                  */
*/*  SUB-PROCEDURE NAME:  DCVTPROC                                   */
*/*                                                                  */
*/*  DESCRIPTIVE NAME:  DISCRETE-TRACK ADDRESS CONVERTOR             */
*/*                                                                  */
*/*  FUNCTION:                                                       */
*/*                                                                  */
*/*    CONVERTS A HEXADECIMAL DISCRETE-TRACK ADDRESS IN CHARACTER    */
*/*    STRING FORM (9 BYTES LONG) TO INTERNAL HEXADECIMAL            */
*/*    REPRESENTATION.                                               */
*/*                                                                  */
*/*                                                                  */
*/*****  END OF SPECIFICATIONS  **************************************/
*                                                                  1873
*                                                                  1873
*DCVTPROC:                                                         1873
*  PROCEDURE                                                       1873
*    (                                                             1873
*    DCVTSRCE,                                                     1873
*    DCVTCCHH,                                                     1873
*    DCVTLEGL                                                      1873
*    );                                                            1873
*                                                                  1873
DCVTPROC STM   @14,@12,@SA00022                                    1873
         MVC   @PC00022(12),0(@01)                                 1873
*DECLARE                                                           1874
*  DCVTSRCE                   CHAR(9),                             1874
*  1 DCVTCCHH                 FIXED(32),                           1874
*    2 DCVTCC                 FIXED(16),                           1874
*    2 DCVTHH                 FIXED(16),                           1874
*  DCVTLEGL                   BIT(1);                              1874
*                                                                  1874
*DECLARE                                                           1875
*  DCVTHEXC(16)               CHAR(1)  INIT                        1875
*                             ('0','1','2','3','4','5','6','7',    1875
*                                  '8','9','A','B','C','D','E','F'),
*  DCVTHEXN(16)               FIXED(8)  INIT                       1875
*                             (0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15),
*  DCVTSTR                    CHAR(9),                             1875
*  DCVTI                      FIXED(15);                           1875
*                                                                  1875
*OLDERID2 = NEWERID2;                                              1876
         L     @06,@PC00001                                        1876
         L     @06,GDTTR2(,@06)                                    1876
         MVC   @TS00001(95),NEWERID2(@06)                          1876
         MVC   OLDERID2(95,@06),@TS00001                           1876
*NEWID2 = 'ITDC';                                                  1877
*                                                                  1877
         MVC   NEWID2(4,@06),@CC01042                              1877
*DO DCVTI = 1 TO 9 WHILE(DCVTSRCE(DCVTI:DCVTI) ^= ':');            1878
         LA    DCVTI,1                                             1878
@DL01878 L     @06,@PC00022                                        1878
         ALR   @06,DCVTI                                           1878
         BCTR  @06,0                                               1878
         CLI   DCVTSRCE(@06),C':'                                  1878
         BE    @DC01878                                            1878
*END;                                                              1879
*                                                                  1879
         AL    DCVTI,@CF00165                                      1879
         CH    DCVTI,@CH00260                                      1879
         BNH   @DL01878                                            1879
@DC01878 DS    0H                                                  1880
*IF DCVTI = 1    DCVTI >= 9                                       1880
*  THEN DCVTLEGL = NO;                                             1880
         CH    DCVTI,@CH00165                                      1880
         BE    @RT01880                                            1880
         CH    DCVTI,@CH00260                                      1880
         BL    @RF01880                                            1880
@RT01880 DS    0H                                                  1881
         L     @06,@PC00022+8                                      1881
         NI    DCVTLEGL(@06),B'01111111'                           1881
*  ELSE DO;                                                        1882
         B     @RC01880                                            1882
@RF01880 DS    0H                                                  1883
*    DCVTSTR = DCVTSRCE(1:DCVTI-1);                                1883
         MVI   DCVTSTR+1,C' '                                      1883
         MVC   DCVTSTR+2(7),DCVTSTR+1                              1883
         LR    @06,DCVTI                                           1883
         BCTR  @06,0                                               1883
         BCTR  @06,0                                               1883
         L     @03,@PC00022                                        1883
         EX    @06,@SM01071                                        1883
*    CALL DCVTCNVT (DCVTSTR,DCVTCC);                               1884
         LA    @06,DCVTSTR                                         1884
         ST    @06,@AL00001                                        1884
         L     @06,@PC00022+4                                      1884
         ST    @06,@AL00001+4                                      1884
         LA    @01,@AL00001                                        1884
         BAL   @14,DCVTCNVT                                        1884
*    IF DCVTLEGL = YES                                             1885
*      THEN DO;                                                    1885
         L     @06,@PC00022+8                                      1885
         TM    DCVTLEGL(@06),B'10000000'                           1885
         BNO   @RF01885                                            1885
*        DCVTSTR = DCVTSRCE(DCVTI+1:9);                            1887
         MVI   DCVTSTR+1,C' '                                      1887
         MVC   DCVTSTR+2(7),DCVTSTR+1                              1887
         LA    @06,8                                               1887
         SLR   @06,DCVTI                                           1887
         L     @03,@PC00022                                        1887
         ALR   @03,DCVTI                                           1887
         EX    @06,@SM01071                                        1887
*        CALL DCVTCNVT (DCVTSTR,DCVTHH);                           1888
         LA    @06,DCVTSTR                                         1888
         ST    @06,@AL00001                                        1888
         L     @06,@PC00022+4                                      1888
         LA    @06,DCVTHH(,@06)                                    1888
         ST    @06,@AL00001+4                                      1888
         LA    @01,@AL00001                                        1888
         BAL   @14,DCVTCNVT                                        1888
*        END;                                                      1889
*    END;                                                          1890
*                                                                  1890
*DCVTCNVT:                                                         1891
*  PROCEDURE                                                       1891
*    (                                                             1891
*    DCVTCHRS,                                                     1891
*    DCVTNUM                                                       1891
*    );                                                            1891
*                                                                  1891
         B     @PB00023                                            1891
DCVTCNVT STM   @14,@12,12(@13)                                     1891
         MVC   @PC00023(8),0(@01)                                  1891
*DECLARE                                                           1892
*  DCVTCHRS                       CHAR(9),                         1892
*  DCVTNUM                        FIXED(16);                       1892
*                                                                  1892
*DECLARE                                                           1893
*  DCVTMULT                       FIXED(16),                       1893
*  (DCVTII,DCVTJJ)                FIXED(15);                       1893
*                                                                  1893
*DCVTNUM = 0;                                                      1894
         L     @06,@PC00023+4                                      1894
         SLR   @03,@03                                             1894
         STH   @03,DCVTNUM(,@06)                                   1894
*DCVTMULT = 1;                                                     1895
         LA    DCVTMULT,1                                          1895
*DO DCVTII = 9 TO 1 BY -1;                                         1896
         LA    DCVTII,9                                            1896
@DL01896 DS    0H                                                  1897
*  DCVTLEGL = NO;                                                  1897
         L     @06,@PC00022+8                                      1897
         NI    DCVTLEGL(@06),B'01111111'                           1897
*  IF DCVTCHRS(DCVTII:DCVTII) ^= ' '                               1898
*    THEN DO;                                                      1898
         L     @06,@PC00023                                        1898
         ALR   @06,DCVTII                                          1898
         BCTR  @06,0                                               1898
         CLI   DCVTCHRS(@06),C' '                                  1898
         BE    @RF01898                                            1898
*      DO DCVTJJ = 1 TO 16 WHILE (DCVTLEGL = NO);                  1900
         LA    DCVTJJ,1                                            1900
@DL01900 L     @06,@PC00022+8                                      1900
         TM    DCVTLEGL(@06),B'10000000'                           1900
         BNZ   @DC01900                                            1900
*        IF DCVTCHRS(DCVTII:DCVTII) = DCVTHEXC(DCVTJJ)             1901
*          THEN IF DCVTMULT <= 4096                                1901
         L     @05,@PC00023                                        1901
         ALR   @05,DCVTII                                          1901
         BCTR  @05,0                                               1901
         LA    @01,DCVTHEXC-1(DCVTJJ)                              1901
         CLC   DCVTCHRS(1,@05),0(@01)                              1901
         BNE   @RF01901                                            1901
*            THEN DO;                                              1902
         CL    DCVTMULT,@CF01056                                   1902
         BH    @RF01902                                            1902
*              DCVTNUM = DCVTNUM + (DCVTMULT * DCVTHEXN(DCVTJJ));  1904
         L     @05,@PC00023+4                                      1904
         SLR   @01,@01                                             1904
         IC    @01,DCVTHEXN-1(DCVTJJ)                              1904
         MR    @00,DCVTMULT                                        1904
         MVC   @ZT00002+2(2),DCVTNUM(@05)                          1904
         AL    @01,@ZT00002                                        1904
         STH   @01,DCVTNUM(,@05)                                   1904
*              DCVTMULT = DCVTMULT * 16;                           1905
         SLL   DCVTMULT,4                                          1905
*              DCVTLEGL = YES;                                     1906
         OI    DCVTLEGL(@06),B'10000000'                           1906
*              END;                                                1907
*      END;                                                        1908
@RF01902 DS    0H                                                  1908
@RF01901 AL    DCVTJJ,@CF00165                                     1908
         CH    DCVTJJ,@CH00272                                     1908
         BNH   @DL01900                                            1908
@DC01900 DS    0H                                                  1909
*      IF DCVTLEGL = NO                                            1909
*        THEN RETURN;                                              1909
         L     @06,@PC00022+8                                      1909
         TM    DCVTLEGL(@06),B'10000000'                           1909
         BZ    @RT01909                                            1909
*      END;                                                        1911
*END;                                                              1912
*                                                                  1912
@RF01898 BCTR  DCVTII,0                                            1912
         LTR   DCVTII,DCVTII                                       1912
         BP    @DL01896                                            1912
*END DCVTCNVT;                                                     1913
*                                                                  1913
@EL00023 DS    0H                                                  1913
@EF00023 DS    0H                                                  1913
@ER00023 LM    @14,@12,12(@13)                                     1913
         BR    @14                                                 1913
*END DCVTPROC;                                                     1914
*                                                                  1914
*                                                                  1914
@EL00022 DS    0H                                                  1914
@EF00022 DS    0H                                                  1914
@ER00022 LM    @14,@12,@SA00022                                    1914
         BR    @14                                                 1914
@PB00022 DS    0H                                                  1914
*/*  END-PROCEDURE INSPECT_COMMAND_CONTROLLER                        */
*                                                                  1915
*    END ICKIT01                                                   1915
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF08 )                                        *
*/*%INCLUDE SYSLIB  (IECSDSL1)                                        *
*/*%INCLUDE SYSLIB  (ICKCSIT )                                        *
*;                                                                 1915
@DATA    DS    0H
@CH00185 DC    H'7'
@CH00272 DC    H'16'
@SM01071 MVC   DCVTSTR(0),DCVTSRCE(@03)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00022 DS    15F
@PC00022 DS    3F
@SA00009 DS    15F
@PC00009 DS    4F
@SA00019 DS    15F
@SA00007 DS    15F
@PC00007 DS    3F
@SA00021 DS    15F
@SA00012 DS    15F
@SA00013 DS    15F
@SA00014 DS    15F
@SA00010 DS    15F
@SA00020 DS    15F
@SA00008 DS    15F
@PC00008 DS    1F
@SA00015 DS    15F
@PC00015 DS    2F
@SA00011 DS    15F
@SA00017 DS    15F
@SA00016 DS    14F
@PC00023 DS    2F
@SA00018 DS    0F
         DS    15F
@AL00001 DS    9A
@TF00001 DS    F
@AFTEMPS DS    3F
@ZTEMPS  DS    0F
@ZT00002 DC    F'0'
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICKIT01  CSECT
         DS    0F
@CF00094 DC    F'0'
@CF00165 DC    F'1'
@CH00165 EQU   @CF00165+2
@CF00116 DC    F'2'
@CH00116 EQU   @CF00116+2
@CF00136 DC    F'3'
@CH00136 EQU   @CF00136+2
@CF00044 DC    F'4'
@CH00044 EQU   @CF00044+2
@CF00255 DC    F'5'
@CH00255 EQU   @CF00255+2
@CF00119 DC    F'6'
@CH00119 EQU   @CF00119+2
@CF00161 DC    F'8'
@CH00161 EQU   @CF00161+2
@CF00260 DC    F'9'
@CH00260 EQU   @CF00260+2
@CF00246 DC    F'10'
@CH00246 EQU   @CF00246+2
@CF00265 DC    F'12'
@CH00265 EQU   @CF00265+2
@CF00267 DC    F'13'
@CF00274 DC    F'17'
@CF00276 DC    F'18'
@CF00278 DC    F'19'
@CF00298 DC    F'29'
@CF00488 DC    F'96'
@CF01056 DC    F'4096'
@CF01068 DC    F'-12'
@CF01069 DC    F'-8'
@CF01067 DC    F'-7'
@CF01070 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
F4PTR    DS    A
RETCODE  DS    F
TALCNT   DS    F
TALPTR   DS    FL4
         ORG   TALPTR
TALPTRC  DS    FL2
TALPTRT  DS    FL2
         ORG   TALPTR+4
ALTCOUNT DS    F
ALTPTR   DS    FL4
         ORG   ALTPTR
ALTPTRC  DS    FL2
ALTPTRT  DS    FL2
         ORG   ALTPTR+4
VIBPTR   DS    A
VIBLEN   DS    F
RECNUM   DS    F
DATAPTR  DS    A
DATALEN  DS    F
RZPTR    DS    A
RZLEN    DS    F
HAPTR    DS    A
HALEN    DS    F
VAACTION DS    F
PACKTRAK DS    F
PACKASC  DS    F
PRECNUM  DS    F
FRECNUM  DS    F
VOLIB    DS    A
COUNTUTR DS    F
CTRADDR  DS    FL4
         ORG   CTRADDR
CTRADDRC DS    FL2
CTRADDRT DS    FL2
         ORG   CTRADDR+4
LABELS   DS    F
VTOCEXT  DS    F
UNTRACK  DS    FL4
         ORG   UNTRACK
UNTRACKC DS    FL2
UNTRACKT DS    FL2
         ORG   UNTRACK+4
RZCCHH   DS    FL4
         ORG   RZCCHH
RZCCHHC  DS    FL2
RZCCHHT  DS    FL2
         ORG   RZCCHH+4
RZACCHH  DS    FL4
         ORG   RZACCHH
RZACCHHC DS    FL2
RZACCHHT DS    FL2
         ORG   RZACCHH+4
HAACTION DS    F
RZACTION DS    F
WRACTION DS    F
CYCLES   DS    F
TRKNUMB  DS    F
RECPTR   DS    A
RTABLEN  DS    F
RCDCNT   DS    F
ALTRACK  DS    FL4
         ORG   ALTRACK
ALTRACKC DS    FL2
ALTRACKT DS    FL2
         ORG   ALTRACK+4
VIBTYPE  DS    F
RETCODE1 DS    F
RETCODE2 DS    F
RETCODE3 DS    F
RETCODE4 DS    F
RETCODE5 DS    F
RETCODE6 DS    F
RETCODE7 DS    F
RETCODE8 DS    F
RETCODE9 DS    F
RETCODEA DS    F
RETCODEB DS    F
RETCODEC DS    F
RETCODED DS    F
I        DS    F
LISTPTR  DS    A
VOL1PTR  DS    A
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL2
PRTSTR   DS    CL56
         ORG   PRTSTR
PRTHDR   DS    CL4
PRTARGS  DS    CL52
         ORG   PRTSTR+56
FOR4DSCB DS    CL96
VOL1P    DS    CL80
CHKFLG   DS    BL1
ASSOCFLG DS    BL1
SPACEFLG DS    BL1
CNTFLAG  DS    BL1
ALTFLAG  DS    BL1
TRKLEGL  DS    BL1
TRACKTYP DS    BL1
UNTRTYPE DS    BL1
PRTFLG   DS    BL1
PACKENT  DS    BL1
DFLAGC   DS    BL1
DFLAGA   DS    BL1
RCVRFLAG DS    BL1
TRSTATUS DS    BL1
TRKFLAG  DS    BL1
TRKREAD  DS    BL1
PACKDEF  DS    BL1
PACKCHEK DS    BL1
PACKRCVR DS    BL1
PACKTRK  DS    BL1
VALVOWN  DS    CL14
VTOCLOC  DS    CL4
         ORG   VTOCLOC
VTOCLOCC DS    FL2
VTOCLOCT DS    FL2
         ORG   VTOCLOC+4
MSSDEV   DS    CL8
VIBNAME  DS    CL8
DEVTYPE  DS    CL8
DCVTSTR  DS    CL9
ASSGNTYP DS    BL1
ATRKREAD DS    BL1
PRGFLG   DS    BL1
         DS    CL2
INFO     DS    CL12
         ORG   INFO+0
INFOPTR  DS    AL4
INFOLEN  DS    FL4
CONDCODE DS    FL4
         ORG   INFO+96
TRKVECT  DS    FL4
         ORG   TRKVECT+0
TRKVECTC DS    FL2
TRKVECTT DS    FL2
         ORG   TRKVECT+80
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKIT01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00837 DC    V(ICKVA01)
@CV00839 DC    V(ICKVV01)
@CV00843 DC    V(ICKPP01)
@CV00861 DC    V(ICKRL01)
@CV00941 DC    V(ICKAA01)
@CV00950 DC    V(ICKRA01)
@CV00958 DC    V(ICKTA01)
@CV00964 DC    V(ICKRT01)
@CV00970 DC    V(ICKRP01)
@CV00996 DC    V(ICKBM01)
         DS    0D
@CC00833 DC    C'DARGLIST'
@CC00145 DC    C'ZERO'
@CC00832 DC    C'IT00'
@CC00845 DC    C'IT99'
@CC00849 DC    C'ITCP'
@CC00854 DC    C'ITOP'
@CC00860 DC    C'ITST'
@CC00869 DC    C'ITIN'
@CC00888 DC    C'ITUV'
@CC00898 DC    C'ITRE'
@CC00903 DC    C'ITRT'
@CC00912 DC    C'ITWI'
@CC00930 DC    C'ITOT'
@CC00935 DC    C'ITRZ'
@CC00940 DC    C'ITAA'
@CC00949 DC    C'ITRS'
@CC00957 DC    C'ITCK'
@CC00963 DC    C'ITRA'
@CC00969 DC    C'ITRP'
@CC00981 DC    C'ITWD'
@CC00986 DC    C'ITWN'
@CC00991 DC    C'ITUT'
@CC00995 DC    C'ITBP'
@CC01000 DC    C'ITCA'
@CC01004 DC    C'ITDM'
@CC01011 DC    C'ITVH'
@CC01042 DC    C'ITDC'
@CC00567 DC    C'CC0'
@CC00617 DC    C'UV0'
@CC01005 EQU   @CC00833
@CC01006 DC    C'N'
@CB00881 DC    X'FFFFFFFF'
@CB00466 DC    B'10000000'
@CB00468 DC    B'00000000'
MODID    DC    CL4'IT01'
POOLID   DC    CL4'IT01'
PTCHIT01 DS    CL512
         ORG   PTCHIT01
@NM00027 DC    256X'00'
@NM00028 DC    256X'00'
         ORG   PTCHIT01+512
         DS    CL3
INFOVECT DC    F'208'
         DC    F'204'
         DC    F'201'
         DC    F'202'
         DC    F'206'
         DC    F'207'
         DC    F'205'
         DC    F'218'
DCVTHEXC DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
DCVTHEXN DC    AL1(0)
         DC    AL1(1)
         DC    AL1(2)
         DC    AL1(3)
         DC    AL1(4)
         DC    AL1(5)
         DC    AL1(6)
         DC    AL1(7)
         DC    AL1(8)
         DC    AL1(9)
         DC    AL1(10)
         DC    AL1(11)
         DC    AL1(12)
         DC    AL1(13)
         DC    AL1(14)
         DC    AL1(15)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
DCVTJJ   EQU   @04
DCVTII   EQU   @03
DCVTMULT EQU   @02
DCVTI    EQU   @02
I4       EQU   @02
IREAD    EQU   @02
I2       EQU   @02
I5       EQU   @05
I1       EQU   @03
HIGHRTA  EQU   @03
LOWRTA   EQU   @02
J        EQU   @02
TRKCOUNT EQU   @04
SALTCNT  EQU   @02
SPROCODE EQU   @02
TESTRC   EQU   @02
REG9     EQU   @09
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG8     EQU   @08
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
ICKSAEP0 EQU   0
ICKSAGP0 EQU   0
ICKSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
ICKDVON0 EQU   0
ICKDVIN0 EQU   0
ICKDVOP0 EQU   0
ICKDVCL0 EQU   0
ICKTPPR0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
VOL1     EQU   0
VOL1VTOC EQU   VOL1+11
VOL1OWNR EQU   VOL1+37
IECSDSF4 EQU   0
IECSDSL4 EQU   0
DS4HCCHH EQU   IECSDSL4+8
DS4NOATK EQU   IECSDSL4+12
DS4DEVCT EQU   IECSDSL4+18
DS4DEVOV EQU   DS4DEVCT+6
DS4AMCAT EQU   IECSDSL4+40
DS4VSIND EQU   DS4AMCAT
DS4VTOCE EQU   IECSDSL4+61
DEVIC    EQU   0
DEVICVAL EQU   DEVIC+1
PRESV    EQU   0
CHECK    EQU   0
CHECKVAL EQU   CHECK
NOCHK    EQU   0
RECLA    EQU   0
VERFY    EQU   0
VSER     EQU   0
VSERVAL  EQU   VSER+1
VOWN     EQU   0
VOWNVAL  EQU   VOWN+1
MAP      EQU   0
TRACK    EQU   0
TRACKCNT EQU   TRACK
@NM00025 EQU   TRACK+2
TRACKVAL EQU   @NM00025+1
ASSGN    EQU   0
DNAME    EQU   0
DNAMEVAL EQU   DNAME+1
ALLTK    EQU   0
DEVTY    EQU   0
DEVTYVAL EQU   DEVTY+1
THRESHLD EQU   0
TRKSPCYL EQU   0
TOTALPRI EQU   0
TOTALALT EQU   0
FIRSTAL  EQU   0
FIRSTALC EQU   FIRSTAL
FIRSTALT EQU   FIRSTAL+2
FINALT   EQU   0
FINALTC  EQU   FINALT
FINALTT  EQU   FINALT+2
FINPRI   EQU   0
FINPRIC  EQU   FINPRI
FINPRIT  EQU   FINPRI+2
MAXREC   EQU   0
VIBFLAG  EQU   0
VIBPFLAG EQU   0
RZADDROB EQU   0
RECTABLE EQU   0
RECTAPTR EQU   RECTABLE
RECTALEN EQU   RECTABLE+4
RECTAOFL EQU   RECTABLE+8
RTRECORD EQU   0
RTCOUNT  EQU   RTRECORD
RCNTR    EQU   RTCOUNT+4
DMPTRM   EQU   0
HAIMAGE  EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOOP0 EQU   0
ICKIOPT0 EQU   0
ICKIOTM0 EQU   0
ICKSACL0 EQU   0
ICKSADE0 EQU   0
ICKSAFS0 EQU   0
ICKSAGS0 EQU   0
ICKSALD0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NOAGN    EQU   0
NOMAP    EQU   0
NOPRE    EQU   0
NOREC    EQU   0
NOVER    EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
RTRADDR  EQU   0
RTRADDRC EQU   RTRADDR
RTRADDRT EQU   RTRADDR+2
DFLAG1   EQU   0
STATE    EQU   0
WTRADDR  EQU   0
WTRADDRC EQU   WTRADDR
WTRADDRT EQU   WTRADDR+2
TRKADDR  EQU   0
DFLAG    EQU   0
RZADDR   EQU   0
OBTRTYPE EQU   0
WRIADDR  EQU   0
WRITRTYP EQU   0
DCVTSRCE EQU   0
DCVTCCHH EQU   0
DCVTCC   EQU   DCVTCCHH
DCVTHH   EQU   DCVTCCHH+2
DCVTLEGL EQU   0
DCVTCHRS EQU   0
DCVTNUM  EQU   0
RZACCHHX EQU   RZACCHH
VTOCEDS4 EQU   DS4VTOCE
VTLOEX   EQU   VTOCEDS4+2
VTLOEXC  EQU   VTLOEX
VTLOEXT  EQU   VTLOEX+2
VTHIEX   EQU   VTOCEDS4+6
VTHIEXC  EQU   VTHIEX
VTHIEXT  EQU   VTHIEX+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00026 EQU   VTOCEDS4
WRIADDRH EQU   WRIADDR+2
WRIADDRC EQU   WRIADDR
TRKADDRH EQU   TRKADDR+2
TRKADDRC EQU   TRKADDR
FDTVERB  EQU   FDTTBL
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
RTDATA   EQU   RTRECORD+12
RTKEY    EQU   RTRECORD+8
RCNTDL   EQU   RTCOUNT+6
RCNTKL   EQU   RTCOUNT+5
RCNTCCHH EQU   RTCOUNT
DEVTYLEN EQU   DEVTY
DNAMELEN EQU   DNAME
TRACKLEN EQU   @NM00025
VOWNLEN  EQU   VOWN
VSERLEN  EQU   VSER
DEVICLEN EQU   DEVIC
DS4END   EQU   IECSDSL4+96
@NM00024 EQU   IECSDSL4+71
DS4F6PTR EQU   IECSDSL4+56
@NM00023 EQU   IECSDSL4+51
DS4R2TIM EQU   IECSDSL4+43
DS4VSCRA EQU   DS4AMCAT+1
@NM00022 EQU   DS4VSIND
DS4VSBAD EQU   DS4VSIND
DS4VSREF EQU   DS4VSIND
DS4AMTIM EQU   IECSDSL4+32
DS4DEVDB EQU   DS4DEVCT+13
DS4DEVDT EQU   DS4DEVCT+12
DS4DEVTL EQU   DS4DEVCT+10
DS4DEVFG EQU   DS4DEVCT+9
DS4DEVK  EQU   DS4DEVCT+8
DS4DEVL  EQU   DS4DEVOV+1
DS4DEVI  EQU   DS4DEVOV
DS4DEVTK EQU   DS4DEVCT+4
DS4DEVSZ EQU   DS4DEVCT
@NM00021 EQU   IECSDSL4+16
DS4NOEXT EQU   IECSDSL4+15
DS4VTOCI EQU   IECSDSL4+14
DS4DSREC EQU   IECSDSL4+6
DS4HPCHR EQU   IECSDSL4+1
DS4IDFMT EQU   IECSDSL4
@NM00020 EQU   IECSDSF4
VOL1STDV EQU   VOL1+79
@NM00019 EQU   VOL1+51
VOL1OLDO EQU   VOL1OWNR+4
VOL1OEXT EQU   VOL1OWNR
@NM00018 EQU   VOL1+16
VOL1ACC  EQU   VOL1+10
VOL1SER  EQU   VOL1+4
VOL1NUM  EQU   VOL1+3
VOL1ID   EQU   VOL1
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCPNM   EQU   IOCSTR+28
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00323 EQU   @EL00002
@RF00376 EQU   @EL00003
@RF00378 EQU   @EL00003
@RF00381 EQU   @EL00003
@RF00448 EQU   @EL00004
@RC00450 EQU   @EL00004
@RF00496 EQU   @EL00004
@RC00536 EQU   @RC00534
@RC00581 EQU   @RC00579
@RC00756 EQU   @RC00579
@RC00804 EQU   @RC00579
@RF00832 EQU   @RC00579
@RC00834 EQU   @RC00579
@RF00875 EQU   @EL00006
@RF00927 EQU   @RC00925
@RC00944 EQU   @RC00925
@RF00910 EQU   @EL00007
@RC01021 EQU   @EL00009
@RF01109 EQU   ENDLOOP1
@RF01069 EQU   @EL00010
@RF01156 EQU   @EL00010
@RF01158 EQU   @EL00010
@RF01234 EQU   ENDLOOP2
@RF01198 EQU   @EL00011
@RC01291 EQU   @EL00011
@RF01328 EQU   @EL00011
@RC01376 EQU   @EL00012
@RF01381 EQU   @EL00012
@RF01441 EQU   @EL00013
@RF01447 EQU   @EL00013
@RF01470 EQU   @RC01462
@RF01472 EQU   @RC01462
@RF01458 EQU   @EL00014
@RF01528 EQU   @EL00014
@RF01534 EQU   @EL00014
@RC01554 EQU   @EL00015
@RF01581 EQU   @EL00015
@RC01607 EQU   @EL00016
@RC01636 EQU   @EL00016
@RC01650 EQU   @EL00016
@RF01717 EQU   @EL00017
@RF01732 EQU   @EL00018
@RF01746 EQU   @RC01743
@RC01748 EQU   @RC01743
@RF01761 EQU   @EL00019
@RF01763 EQU   @EL00019
@RF01766 EQU   @EL00019
@RC01768 EQU   @EL00019
@RF01826 EQU   @EL00020
@RC01851 EQU   @EL00021
@RC01864 EQU   @EL00021
@PB00021 EQU   @PB00022
@RT01909 EQU   @EL00023
@PB00023 EQU   @EL00022
@RF00588 EQU   @RC00581
@RC00590 EQU   @RC00581
@RC00659 EQU   @RC00581
@RC00712 EQU   @RC00581
@RF00740 EQU   @RC00581
@RC00742 EQU   @RC00581
@RC00771 EQU   @RC00756
@RF00791 EQU   @RC00756
@RC00793 EQU   @RC00756
@RF00812 EQU   @RC00804
@RC00814 EQU   @RC00804
@RF00819 EQU   @RC00804
@RF01293 EQU   @RC01291
@PB00020 EQU   @PB00021
@RC01880 EQU   @PB00023
@RF01885 EQU   @PB00023
@RC00592 EQU   @RC00590
@RF00646 EQU   @RC00590
@RC00648 EQU   @RC00590
@RC00677 EQU   @RC00659
@RF00686 EQU   @RC00659
@RC00688 EQU   @RC00659
@RF00720 EQU   @RC00712
@RC00722 EQU   @RC00712
@RF00727 EQU   @RC00712
@RF00774 EQU   @RC00771
@RF00780 EQU   @RC00771
@PB00019 EQU   @PB00020
@RC00594 EQU   @RC00592
@RC00618 EQU   @RC00592
@RF00627 EQU   @RC00592
@RC00629 EQU   @RC00592
@PB00018 EQU   @PB00019
@RC00596 EQU   @RC00594
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   ICKIT01,(C'PLS0842',0701,78198)

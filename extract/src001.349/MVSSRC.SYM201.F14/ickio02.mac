         TITLE '*************     ICKIO02  OPEN-CLOSE ROUTINES     *****
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
ICKIO02  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'ICKIO02   78.192'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @09,0                                               0002
@PSTART  LA    @10,4095(,@09)                                      0002
         LA    @12,4095(,@10)                                      0002
         USING @PSTART,@09                                         0002
         USING @PSTART+4095,@10                                    0002
         USING @PSTART+8190,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(8),0(@01)                                  0002
*                                                                  0249
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE THE RETURN CODE THAT IS RETURNED TO IO01.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0250
*        TESTRC = 0;                                               0250
*                                                                  0250
         SLR   @08,@08                                             0250
         STH   @08,TESTRC                                          0250
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE THE EXIT LIST FOR   DATA SETS                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0251
*        DCBTLIST = DCBTLSTA;                                      0251
*                                                                  0251
         MVC   DCBTLIST(8),DCBTLSTA                                0251
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE ERROR MESSAGE ARGUMENT LIST                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0252
*        DDSTRU = ADDR (DMSGARG);                                  0252
         LA    @08,DMSGARG                                         0252
         ST    @08,DDSTRU                                          0252
*        DMSGARG = ''B;                                            0253
         XC    DMSGARG(44),DMSGARG                                 0253
*        DARGSMOD = 'IO0';                                         0254
*                                                                  0254
         MVC   DARGSMOD(3,@08),@CC00957                            0254
*        /************************************************************/
*        /*                                                          */
*        /* IF THE REQUEST IS OPEN, CONTROL BLOCKS ARE BUILT AND     */
*        /* THE DATA SETS ARE OPENED.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0255
*        IF OCATYP = OCATYPOP                                      0255
*          THEN                                                    0255
         L     @08,@PC00001+4                                      0255
         CLI   OCATYP(@08),1                                       0255
         BNE   @RF00255                                            0255
*            DO;                                                   0256
*              CALL OPENRTN;                                       0257
         BAL   @14,OPENRTN                                         0257
*              RESPECIFY RTNREG RSTD;                              0258
*              TESTRC = RTNREG;                                    0259
         STH   RTNREG,TESTRC                                       0259
*              RESPECIFY RTNREG UNRSTD;                            0260
*            END;                                                  0261
*                                                                  0261
*        /************************************************************/
*        /*                                                          */
*        /* IF THE REQUEST IS CLOSE, THE CONTROL BLOCK AND WORKAREA  */
*        /* STORAGE IS RELEASED AND THE DATA SETS ARE CLOSED.        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0262
*        IF OCATYP = OCATYPCL                                      0262
*          THEN                                                    0262
@RF00255 L     @08,@PC00001+4                                      0262
         CLI   OCATYP(@08),2                                       0262
         BNE   @RF00262                                            0262
*            DO;                                                   0263
*              CALL CLOSERTN;                                      0264
         BAL   @14,CLOSERTN                                        0264
*              RESPECIFY RTNREG RSTD;                              0265
*              TESTRC = RTNREG;                                    0266
         STH   RTNREG,TESTRC                                       0266
*              RESPECIFY RTNREG UNRSTD;                            0267
*            END;                                                  0268
*                                                                  0268
*        /************************************************************/
*        /*                                                          */
*        /* CONTROL RETURNS TO THE MAIN I/O ROUTINE WITH HIGHEST     */
*        /* ERROR CODE ENCOUNTERED RETURNED.                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0269
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0269
@RF00262 L     @08,@PC00001                                        0269
         ST    @08,@AL00001                                        0269
         LA    @15,MODID                                           0269
         ST    @15,@AL00001+4                                      0269
         LA    @15,TESTRC                                          0269
         ST    @15,@AL00001+8                                      0269
         MVI   @AL00001+8,X'80'                                    0269
         L     @15,GDTEPL(,@08)                                    0269
         LA    @01,@AL00001                                        0269
         BALR  @14,@15                                             0269
*                                                                  0270
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - OPENRTN                                 */
*        /*                                                          */
*        /* FUNCTION - THIS PROCEDURE BUILDS THE IOCSTR AND          */
*        /*            RETURNS THE ADDRESS TO THE CALLER.  CALLS     */
*        /*            ARE ISSUED TO OTHER INTERNAL PROCEDURES TO    */
*        /*            BUILD ALL REQUIRED OPEN CONTROL BLOCKS.       */
*        /*            THE DATA SETS ARE THEN OPENED AND OPEN        */
*        /*            CHECKING IS PERFORMED.                        */
*        /*                                                          */
*        /* INPUT -     OCARRAY DEFINING THE DATES TO BE OPENED.     */
*        /*                                                          */
*        /* OUTPUT -   CONTROL BLOCKS ARE BUILT, DATA SETS ARE       */
*        /*            OPENED, ERROR DATE IS SET AND A RETURNED      */
*        /*            IS RETURNED TO THE MAIN PROCEDURE.            */
*        /*                                                          */
*        /* ERRORS -   1. NO STORAGE FOR IOCSTR.                     */
*        /*            2. ERROR FROM EXTERNAL DATE SET OPEN.         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0270
*OPENRTN:  PROC;                                                   0270
*                                                                  0270
         B     @PB00002                                            0270
OPENRTN  STM   @14,@12,@SA00002                                    0270
*        /************************************************************/
*        /*                                                          */
*        /* DECLARES USED ONLY BY THIS PROCEDURE                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0271
*        /* RETURN CODE                                              */
*        DCL OPENRC FIXED (15);                                    0271
*                                                                  0271
*        /* OPEN FLAGS                                               */
*        DCL 1 OFLAGS BIT (8),                                     0272
*              2 ALROPEN BIT (1),      /* DATA SET ALREADY OPEN      */
*              2 CKSYSIN BIT (1),      /* SYSTEM INPUT DNAME         */
*              2 CKSYSOT BIT (1);      /* SYSTEM OUTPUT DNAME        */
*                                                                  0272
*        /* COUNTER FOR EXTERNAL DATA SET SEARCH                     */
*        DCL CKXTN FIXED (15);                                     0273
*                                                                  0273
*        /* EXTERNAL DATA SET ARGUMENT LIST                          */
*        DCL 1 XTNLIST BASED (IODXTN),                             0274
*              2 XTNNUM FIXED (31),    /* NUMBER OF ENTRIES          */
*              2 XTNENT (*),                                       0274
*                3 XDPTR PTR (31),     /* NAME POINTER               */
*                3 XTNADR PTR (31),    /* ENTRY POINT ADDRESS        */
*                3 XTNPRM FIXED (31);  /* PARAMETER                  */
*                                                                  0274
*        /* POINTER TO THE NAME FIELD FOR OPEN                       */
*        DCL XDADDR PTR (31);                                      0275
*                                                                  0275
*        /* EXTERNAL NAME TO BE PROCESSED BY EXTERNAL ROUTINE        */
*        DCL 1 XTFIELD BDY (WORD) BASED (XDADDR),                  0276
*              2 XTFTYPE CHAR (2),     /* TYPE OF NAME               */
*              2 XTNAME CHAR (8);      /* EXTERNAL PROCESSES DDNAME  */
*                                                                  0276
*        /* ARGUMENT LIST PASSED TO OPEN SVC                         */
*        DCL 1 OPENLIST BDY (WORD) BIT (128),                      0277
*              2 OPCBADDR (4) PTR (31),/* CONTROL BLOCK ADDRESS      */
*                3 OPLEND BIT (1);     /* END OF LIST INDICATOR      */
*                                                                  0277
*                                                                  0277
*        /* OPEN TYPE J ARGUMENT LIST                                */
*        DCL 1 TJOPLIST BDY(WORD) BIT(128),                        0278
*              2 TJCBAD (4) PTR (31),                              0278
*                3 TJLEND BIT(1);                                  0278
*                                                                  0278
*        /* COUNTER OF NUMBER OF DATA SETS TO OPEN TYPE=J            */
*        DCL TJNUMOP FIXED(15);                                    0279
*                                                                  0279
*        /* DATA CONTROL BLOCK (DCB) ADDRESS                         */
*        DCL RETCBADR PTR(31);                                     0280
*        /* INITIALIZE DATA SET NAME IN IOCSTR TO BLANKS             */
*        DCL BLANKDSN CHAR (44) BASED (IOCDSN);                    0281
*                                                                  0281
*        /* LENGTH OF STORAGE REQUIRED FOR IOCSTR PREFIX, IOCSTR     */
*        /* IOCSEX AND DATA SET NAME                                 */
*        DCL SIZEIOCS FIXED (31)                                   0282
*          INIT (LENGTH (IOCSPRE) + LENGTH (IOCSTR) +              0282
*                LENGTH (IOCSEX) + LENGTH (BLANKDSN));             0282
*                                                                  0282
*        /* IOCS PRE FIX  - CONTAINS CHARACTER STRING IOCS           */
*        DCL IOCSPRE CHAR (4) BASED (IOCSPTR);                     0283
*                                                                  0283
*        /* OFFSET OF THE DATA SET NAME FROM BEGINNING OF IOCSTR     */
*        DCL LENTODSN FIXED (15)                                   0284
*          INIT(LENGTH(IOCSTR) + LENGTH(IOCSEX));                  0284
*                                                                  0284
*        /* COUNTER OF NUMBER OF DATA SET TO OPEN                    */
*        DCL NUMOPEN FIXED (15);                                   0285
*                                                                  0285
*        /* COUNTER OF CONTROL BLOCKS                                */
*        DCL OPNCTR FIXED (15);                                    0286
*                                                                  0286
*        /* RETURN IOCS ADDRESS TO USER STORAGE                      */
*        DCL RETIOCS PTR (31) BASED (OPNIOC);                      0287
*                                                                  0287
*        /* DNAME SUPPLIED BY THE USER                               */
*        DCL OPDNAME CHAR (8) BASED (OPNDDN);                      0288
*                                                                  0288
*        /* DNAME OF DATA SET TO OPEN                                */
*        DCL DTOOPEN CHAR (8);                                     0289
*                                                                  0289
*        /* ADDRESS OF NEXT IOCS TO BE PLACED IN CHAIN               */
*        DCL NEXTADDR PTR (31);                                    0290
*                                                                  0290
*        /* SAVE RETURN CODE FROM THE OPEN SVC                       */
*        DCL OPAMRC FIXED (15);                                    0291
*                                                                  0292
*        /************************************************************/
*        /*                                                          */
*        /* OPEN ALL DATA SETS DEFINED BY OPNAGL S                   */
*        /*                                                          */
*        /***********************************************************/
*                                                                  0292
*        OPENRC = 0;                                               0292
         SLR   @08,@08                                             0292
         STH   @08,OPENRC                                          0292
*        NUMOPEN = 0;                                              0293
         SLR   NUMOPEN,NUMOPEN                                     0293
*        TJNUMOP = 0;                                              0294
*                                                                  0294
         STH   @08,TJNUMOP                                         0294
*CKOLIST:                                                          0295
*        DO OPNCTR = 1 TO OCANUM;                                  0295
*                                                                  0295
CKOLIST  LA    @08,1                                               0295
         B     @DE00295                                            0295
@DL00295 DS    0H                                                  0296
*          /**********************************************************/
*          /*                                                        */
*          /* SET ADDRESSIBILITY TO THE OPNAGL.                      */
*          /* INITIALIZE RETURN CODE USED FOR THIS DATA SET ONLY.    */
*          /* INIT FLAG THAT DATA SET IS NOT ALREADY OPEN.           */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0296
*          OPNPTR = OCADDR (OPNCTR);                               0296
         SLA   @08,2                                               0296
         L     @15,@PC00001+4                                      0296
         L     OPNPTR,OCADDR-4(@08,@15)                            0296
*          TESTRC = 0;                                             0297
         SLR   @08,@08                                             0297
         STH   @08,TESTRC                                          0297
*          OFLAGS = '00'X;                                         0298
*                                                                  0298
         MVI   OFLAGS,X'00'                                        0298
*          /**********************************************************/
*          /*                                                        */
*          /* IF THE SYSTEM DNAME FOR INPUT (SYSIN/SYSIPT) OR        */
*          /* OUTPUT (SYSPRINT/SYSLST) IS SPECIFIED THE DATA         */
*          /* WILL BE READ TO OR WRITTEN FROM THE SYSTEM DATA SET.   */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0299
*          IF OPNDDN ^= NULLPTR                                    0299
*            THEN                                                  0299
         L     @15,OPNDDN(,OPNPTR)                                 0299
         CR    @15,@08                                             0299
         BE    @RF00299                                            0299
*              DO;                                                 0300
*                                                                  0300
*                IF OPDNAME (1:8) = INFILE (1:8)                   0301
*                  THEN                                            0301
         CLC   OPDNAME(8,@15),INFILE                               0301
         BNE   @RF00301                                            0301
*                    CKSYSIN = ON;                                 0302
         OI    CKSYSIN,B'01000000'                                 0302
*                IF OPDNAME (1:8) = OUTFILE (1:8)                  0303
*                  THEN                                            0303
@RF00301 L     @08,OPNDDN(,OPNPTR)                                 0303
         CLC   OPDNAME(8,@08),OUTFILE                              0303
         BNE   @RF00303                                            0303
*                    CKSYSOT = ON;                                 0304
*                                                                  0304
         OI    CKSYSOT,B'00100000'                                 0304
*              END;                                                0305
*                                                                  0305
@RF00303 DS    0H                                                  0306
*          /**********************************************************/
*          /*                                                        */
*          /* IF DATA SET IS SYSTEM INPUT CHECK IF ALREADY OPEN.     */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0306
*          IF OPNTYPSI = ON × CKSYSIN = ON                         0306
*            THEN                                                  0306
@RF00299 TM    OPNTYPSI(OPNPTR),B'10000000'                        0306
         BO    @RT00306                                            0306
         TM    CKSYSIN,B'01000000'                                 0306
         BNO   @RF00306                                            0306
@RT00306 DS    0H                                                  0307
*SYSINPUT:     DO;                                                 0307
*                                                                  0307
SYSINPUT DS    0H                                                  0308
*                IF IODICS ^= NULLPTR                              0308
*                  THEN                                            0308
*                                                                  0308
         L     @08,@PC00001                                        0308
         L     @08,GDTIOH(,@08)                                    0308
         L     @08,IODICS(,@08)                                    0308
         LTR   @08,@08                                             0308
         BZ    @RF00308                                            0308
*                    /************************************************/
*                    /*                                              */
*                    /* IF DATA SET IS ALREADY OPEN RETURN IOCS ADD  */
*                    /* TO CALLER AND SET OPEN INDICATOR.            */
*                    /*                                              */
*                    /************************************************/
*                                                                  0309
*                    DO;                                           0309
*                      RETIOCS = IODICS;                           0310
         L     @01,OPNIOC(,OPNPTR)                                 0310
         ST    @08,RETIOCS(,@01)                                   0310
*                      ALROPEN = ON;                               0311
         OI    ALROPEN,B'10000000'                                 0311
*                    END;                                          0312
*                                                                  0312
*                  ELSE                                            0313
*                                                                  0313
*                    /************************************************/
*                    /*                                              */
*                    /* NOT OPEN - SET INPUT OPTION AND DEFAULT DNAME*/
*                    /*                                              */
*                    /************************************************/
*                                                                  0313
*                    DTOOPEN (1:8) = INFILE (1:8);                 0313
*                                                                  0313
         B     @RC00308                                            0313
@RF00308 MVC   DTOOPEN(8),INFILE                                   0313
*              END SYSINPUT;                                       0314
*                                                                  0314
@RC00308 DS    0H                                                  0315
*          /**********************************************************/
*          /*                                                        */
*          /* IF DATA SET SYSTEM OUTPUT CHECK IF ALREADY OPEN.       */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0315
*          IF OPNTYPSO = ON × CKSYSOT = ON                         0315
*            THEN                                                  0315
@RF00306 TM    OPNTYPSO(OPNPTR),B'01000000'                        0315
         BO    @RT00315                                            0315
         TM    CKSYSOT,B'00100000'                                 0315
         BNO   @RF00315                                            0315
@RT00315 DS    0H                                                  0316
*SYSOTPUT:     DO;                                                 0316
*                                                                  0316
SYSOTPUT DS    0H                                                  0317
*                IF IODOCS ^= NULLPTR                              0317
*                  THEN                                            0317
*                                                                  0317
         L     @08,@PC00001                                        0317
         L     @08,GDTIOH(,@08)                                    0317
         L     @08,IODOCS(,@08)                                    0317
         LTR   @08,@08                                             0317
         BZ    @RF00317                                            0317
*                    /************************************************/
*                    /*                                              */
*                    /* IF DATA SET ALREADY OPEN RETURN IOCS         */
*                    /* ADDRESS TO CALLER AND SET OPENED INDICATOR   */
*                    /*                                              */
*                    /************************************************/
*                                                                  0318
*                    DO;                                           0318
*                      RETIOCS = IODOCS;                           0319
         L     @01,OPNIOC(,OPNPTR)                                 0319
         ST    @08,RETIOCS(,@01)                                   0319
*                      ALROPEN = ON;                               0320
         OI    ALROPEN,B'10000000'                                 0320
*                    END;                                          0321
*                                                                  0321
*                  ELSE                                            0322
*                                                                  0322
*                    /************************************************/
*                    /*                                              */
*                    /* DATA SET NOT OPEN - SET OUTPUT OPTION        */
*                    /* AND DEFAULT DNAME.                           */
*                    /*                                              */
*                    /************************************************/
*                                                                  0322
*                    DTOOPEN (1:8) = OUTFILE (1:8);                0322
*                                                                  0322
         B     @RC00317                                            0322
@RF00317 MVC   DTOOPEN(8),OUTFILE                                  0322
*              END SYSOTPUT;                                       0323
*                                                                  0323
@RC00317 DS    0H                                                  0324
*          /**********************************************************/
*          /*                                                        */
*          /* IF DATA SET NOT ALREADY OPEN THEN AN IOCS MUST BE BUILT*/
*          /*                                                        */
*          /**********************************************************/
*                                                                  0324
*          IF ALROPEN = OFF                                        0324
*            THEN                                                  0324
@RF00315 TM    ALROPEN,B'10000000'                                 0324
         BNZ   @RF00324                                            0324
*BLDIOCS:      DO;                                                 0325
*                                                                  0325
BLDIOCS  DS    0H                                                  0326
*                /****************************************************/
*                /*                                                  */
*                /* SAVE DNAME IF IT HAS NOT ALREADY BEEN SAVED      */
*                /*                                                  */
*                /****************************************************/
*                                                                  0326
*                IF OPNTYPSI = OFF & OPNTYPSO = OFF                0326
*                  THEN                                            0326
         TM    OPNTYPSI(OPNPTR),B'11000000'                        0326
         BNZ   @RF00326                                            0326
*                    DTOOPEN (1:8) = OPDNAME (1:8);                0327
*                                                                  0327
         L     @08,OPNDDN(,OPNPTR)                                 0327
         MVC   DTOOPEN(8),OPDNAME(@08)                             0327
*                /****************************************************/
*                /*                                                  */
*                /* SET IOCSPTR TO ZERO.  IF NO STORAGE IS           */
*                /* AVAILABLE THE PRINT ROUTINE WILL PRINT THE       */
*                /* DNAME SINCE THERE IS NO DATA SET NAME YET.       */
*                /*                                                  */
*                /****************************************************/
*                                                                  0328
*                IOCSPTR = NULLPTR;                                0328
*                                                                  0328
@RF00326 SLR   @08,@08                                             0328
         ST    @08,IOCSPTR                                         0328
*                /****************************************************/
*                /*                                                  */
*                /* GET A STORAGE POOL WITH A UNIQUE POOL ID.        */
*                /*                                                  */
*                /****************************************************/
*                                                                  0329
*                IODINC = IODINC + 1;                              0329
*                                                                  0329
         L     @08,@PC00001                                        0329
         L     @15,GDTIOH(,@08)                                    0329
         LA    @14,1                                               0329
         AH    @14,IODINC(,@15)                                    0329
         STH   @14,IODINC(,@15)                                    0329
*                CALL ICKSAGP0 (GDTTBL,SIZEIOCS,IOCSPTR,IODSID,SETZERO)
         ST    @08,@AL00001                                        0330
         LA    @14,SIZEIOCS                                        0330
         ST    @14,@AL00001+4                                      0330
         LA    @14,IOCSPTR                                         0330
         ST    @14,@AL00001+8                                      0330
         LA    @15,IODSID(,@15)                                    0330
         ST    @15,@AL00001+12                                     0330
         LA    @15,@CC00141                                        0330
         ST    @15,@AL00001+16                                     0330
         MVI   @AL00001+16,X'80'                                   0330
         L     @15,GDTGPL(,@08)                                    0330
         LA    @01,@AL00001                                        0330
         BALR  @14,@15                                             0330
*                RESPECIFY RTNREG RSTD;                            0331
*                TESTRC = RTNREG;                                  0332
         STH   RTNREG,TESTRC                                       0332
*                RESPECIFY RTNREG UNRSTD;                          0333
*                                                                  0333
*                IF TESTRC = 4                                     0334
*                  THEN                                            0334
*                                                                  0334
         LH    @08,TESTRC                                          0334
         C     @08,@CF00040                                        0334
         BNE   @RF00334                                            0334
*                    /************************************************/
*                    /*                                              */
*                    /* IF STORAGE WAS NOT AVAILABLE SET ERROR DATA  */
*                    /* PRINT MESSAGE AND RETURN                     */
*                    /*                                              */
*                    /************************************************/
*                                                                  0335
*                    DO;                                           0335
*                      DARGSMOD = 'UV0';                           0336
         L     @08,DDSTRU                                          0336
         MVC   DARGSMOD(3,@08),@CC01006                            0336
*                      DARGSENT = NOCRSTID;                        0337
         MVI   DARGSENT(@08),X'04'                                 0337
*                      CALL BLDOCMSG (DTOOPEN);                    0338
         LA    @08,DTOOPEN                                         0338
         ST    @08,@AL00001                                        0338
         LA    @01,@AL00001                                        0338
         BAL   @14,BLDOCMSG                                        0338
*                      RETURN CODE (4);                            0339
         LA    @15,4                                               0339
         L     @14,@SA00002                                        0339
         LM    @00,@12,@SA00002+8                                  0339
         BR    @14                                                 0339
*                    END;                                          0340
*                                                                  0340
*                /****************************************************/
*                /*                                                  */
*                /* SET IOCS PREFIX CHARACTER STRING AND             */
*                /* ADDRESSIBILITY TO IOCSTR.                        */
*                /*                                                  */
*                /****************************************************/
*                                                                  0341
*                IOCSPRE = 'IOCS';                                 0341
@RF00334 L     @08,IOCSPTR                                         0341
         MVC   IOCSPRE(4,@08),@CC01008                             0341
*                IOCSPTR = IOCSPTR + LENGTH (IOCSPRE);             0342
*                                                                  0342
         AL    @08,@CF00040                                        0342
         ST    @08,IOCSPTR                                         0342
*                /****************************************************/
*                /*                                                  */
*                /* IOCS IS BUILT AND INITIALIZED TO ZERO.           */
*                /* SET ADDRESSIBILITY TO EXTENTION, RETURN THE      */
*                /* IOCS ADDRESS TO THE CALLER AND SAVE POOL ID.     */
*                /*                                                  */
*                /****************************************************/
*                                                                  0343
*                RETIOCS = IOCSPTR;                                0343
         L     @01,OPNIOC(,OPNPTR)                                 0343
         ST    @08,RETIOCS(,@01)                                   0343
*                IOCEXT = IOCSPTR + LENGTH (IOCSTR);               0344
         LA    @15,40                                              0344
         ALR   @15,@08                                             0344
         ST    @15,IOCEXT(,@08)                                    0344
*                IOCDSN = IOCSPTR + LENTODSN;                      0345
         LH    @14,LENTODSN                                        0345
         ALR   @14,@08                                             0345
         ST    @14,IOCDSN(,@08)                                    0345
*                BLANKDSN = ' ';                                   0346
         MVI   BLANKDSN+1(@14),C' '                                0346
         MVC   BLANKDSN+2(42,@14),BLANKDSN+1(@14)                  0346
         MVI   BLANKDSN(@14),C' '                                  0346
*                IOCSID (1:4) = IODSID (1:4);                      0347
*                                                                  0347
         L     @14,@PC00001                                        0347
         L     @14,GDTIOH(,@14)                                    0347
         MVC   IOCSID(4,@15),IODSID(@14)                           0347
*                /****************************************************/
*                /*                                                  */
*                /* IF DATA SET IS SYSTEM INPUT,  SAVE IOCS ADDRESS  */
*                /*                                                  */
*                /****************************************************/
*                                                                  0348
*                IF OPNTYPSI = ON                                  0348
*                  THEN                                            0348
         TM    OPNTYPSI(OPNPTR),B'10000000'                        0348
         BNO   @RF00348                                            0348
*                    DO;                                           0349
*                      IODICS = IOCSPTR;                           0350
         ST    @08,IODICS(,@14)                                    0350
*                      IOCINFND = ON;                              0351
         OI    IOCINFND(@15),B'00100000'                           0351
*                    END;                                          0352
*                                                                  0352
*                /****************************************************/
*                /*                                                  */
*                /* IF DATA SET IS SYSTEM OUTPUT, SAVE IOCS ADDRESS  */
*                /*                                                  */
*                /****************************************************/
*                                                                  0353
*                IF OPNTYPSO = ON                                  0353
*                  THEN                                            0353
@RF00348 TM    OPNTYPSO(OPNPTR),B'01000000'                        0353
         BNO   @RF00353                                            0353
*                    DO;                                           0354
*                      IODOCS = IOCSPTR;                           0355
         L     @08,IOCSPTR                                         0355
         L     @15,@PC00001                                        0355
         L     @01,GDTIOH(,@15)                                    0355
         ST    @08,IODOCS(,@01)                                    0355
*                      IOCFLGSP = ON;                              0356
         L     @08,IOCEXT(,@08)                                    0356
         OI    IOCFLGSP(@08),B'00000010'                           0356
*                    END;                                          0357
*                                                                  0357
*                /****************************************************/
*                /*                                                  */
*                /* UPDATE IOCS CONTROL BLOCK CHAIN.                 */
*                /* IF FIRST IOCS BUILT - SET ADDRESS IN IODATA.     */
*                /*                                                  */
*                /****************************************************/
*                                                                  0358
*                IF IODIOC = NULLPTR                               0358
*                  THEN                                            0358
@RF00353 L     @08,@PC00001                                        0358
         L     @08,GDTIOH(,@08)                                    0358
         L     @15,IODIOC(,@08)                                    0358
         LTR   @15,@15                                             0358
         BNZ   @RF00358                                            0358
*                    IODIOC = IOCSPTR;                             0359
*                                                                  0359
         L     @15,IOCSPTR                                         0359
         ST    @15,IODIOC(,@08)                                    0359
*                  ELSE                                            0360
*                                                                  0360
*                    /************************************************/
*                    /*                                              */
*                    /* FIND LAST IOCS IN CHAIN.                     */
*                    /*                                              */
*                    /************************************************/
*                                                                  0360
*                    DO;                                           0360
         B     @RC00358                                            0360
@RF00358 DS    0H                                                  0361
*                      NEXTADDR = IOCSPTR;                         0361
         L     @08,IOCSPTR                                         0361
         ST    @08,NEXTADDR                                        0361
*                      IOCSPTR = IODIOC;                           0362
*                                                                  0362
         L     @08,@PC00001                                        0362
         L     @08,GDTIOH(,@08)                                    0362
         L     @08,IODIOC(,@08)                                    0362
         ST    @08,IOCSPTR                                         0362
*                      DO WHILE IOCNIO ^= NULLPTR;                 0363
         B     @DE00363                                            0363
@DL00363 DS    0H                                                  0364
*                        IOCSPTR = IOCNIO;                         0364
         L     @08,IOCSPTR                                         0364
         L     @08,IOCEXT(,@08)                                    0364
         L     @08,IOCNIO(,@08)                                    0364
         ST    @08,IOCSPTR                                         0364
*                      END;                                        0365
*                                                                  0365
@DE00363 L     @08,IOCSPTR                                         0365
         L     @08,IOCEXT(,@08)                                    0365
         L     @15,IOCNIO(,@08)                                    0365
         LTR   @15,@15                                             0365
         BNZ   @DL00363                                            0365
*                      /**********************************************/
*                      /*                                            */
*                      /* SET ADDRESS OF NEW IOCS IN CHAIN.          */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0366
*                      IOCNIO = NEXTADDR;                          0366
         L     @15,NEXTADDR                                        0366
         ST    @15,IOCNIO(,@08)                                    0366
*                      IOCSPTR = NEXTADDR;                         0367
         ST    @15,IOCSPTR                                         0367
*                    END;                                          0368
*                                                                  0368
*                /****************************************************/
*                /*                                                  */
*                /* SET INPUT, OUTPUT OR UPDATE IN IOCS - DETERMINED */
*                /* FROM THE OPNAGL OPTION FLAGS.                    */
*                /* SET OPEN FOR INPUT AS DEFAULT                    */
*                /****************************************************/
*                                                                  0369
*                IF OPNOPTOT = ON × OPNTYPSO = ON                  0369
*                  THEN                                            0369
@RC00358 TM    OPNOPTOT(OPNPTR),B'01000000'                        0369
         BO    @RT00369                                            0369
         TM    OPNTYPSO(OPNPTR),B'01000000'                        0369
         BNO   @RF00369                                            0369
@RT00369 DS    0H                                                  0370
*                    IOCMACOT = ON;                                0370
*                                                                  0370
         L     @08,IOCSPTR                                         0370
         OI    IOCMACOT(@08),B'01000000'                           0370
*                  ELSE                                            0371
*                    DO;                                           0371
*                                                                  0371
         B     @RC00369                                            0371
@RF00369 DS    0H                                                  0372
*                      IF OPNOPTUP = ON                            0372
*                        THEN                                      0372
         TM    OPNOPTUP(OPNPTR),B'00100000'                        0372
         BNO   @RF00372                                            0372
*                          IOCMACUP = ON;                          0373
         L     @08,IOCSPTR                                         0373
         OI    IOCMACUP(@08),B'00100000'                           0373
*                        ELSE                                      0374
*                          IOCMACIN = ON;                          0374
*                                                                  0374
         B     @RC00372                                            0374
@RF00372 L     @08,IOCSPTR                                         0374
         OI    IOCMACIN(@08),B'10000000'                           0374
*                    END;                                          0375
*                                                                  0375
@RC00372 DS    0H                                                  0376
*        IF IODXTN ^= NULLPTR                                      0376
*          THEN                                                    0376
*                                                                  0376
@RC00369 L     @08,@PC00001                                        0376
         L     @08,GDTIOH(,@08)                                    0376
         L     @08,IODXTN(,@08)                                    0376
         LTR   @08,@08                                             0376
         BZ    @RF00376                                            0376
*            /********************************************************/
*            /*                                                      */
*            /* IF THERE IS AN EXTERNAL DATA SET LIST - CHECK        */
*            /* IF THIS DATA SET IS EXTERNALLY CONTROLLED.           */
*            /*                                                      */
*            /********************************************************/
*                                                                  0377
*CKEXLIST:   DO CKXTN = 1 TO XTNNUM;                               0377
*                                                                  0377
CKEXLIST LA    @08,1                                               0377
         B     @DE00377                                            0377
@DL00377 DS    0H                                                  0378
*              XDADDR = XDPTR (CKXTN);                             0378
*                                                                  0378
         MH    @08,@CH00036                                        0378
         L     @15,@PC00001                                        0378
         L     @01,GDTIOH(,@15)                                    0378
         L     @01,IODXTN(,@01)                                    0378
         AL    @01,@CF01493                                        0378
         L     @08,XDPTR-4(@08,@01)                                0378
         ST    @08,XDADDR                                          0378
*              IF XTFTYPE = 'DD'                                   0379
*                THEN                                              0379
*                                                                  0379
         CLC   XTFTYPE(2,@08),@CC01012                             0379
         BNE   @RF00379                                            0379
*                  /**************************************************/
*                  /*                                                */
*                  /* NAME IN LIST IS DDNAME                         */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0380
*EXISDD:           DO;                                             0380
*                                                                  0380
EXISDD   DS    0H                                                  0381
*                    IF XTNAME = DTOOPEN                           0381
*                      THEN                                        0381
*                                                                  0381
         L     @08,XDADDR                                          0381
         CLC   XTNAME(8,@08),DTOOPEN                               0381
         BNE   @RF00381                                            0381
*                        /********************************************/
*                        /*                                          */
*                        /* CALL EXTERNAL OPEN ROUTINE               */
*                        /*                                          */
*                        /********************************************/
*                                                                  0382
*SETEXT:                 DO;                                       0382
SETEXT   DS    0H                                                  0383
*                          IOCFLGEX = ON;                          0383
         L     @08,IOCSPTR                                         0383
         L     @15,IOCEXT(,@08)                                    0383
         OI    IOCFLGEX(@15),B'10000000'                           0383
*                          IOCXAD = XTNADR (CKXTN);                0384
         LH    @14,CKXTN                                           0384
         MH    @14,@CH00036                                        0384
         L     @07,@PC00001                                        0384
         L     @01,GDTIOH(,@07)                                    0384
         L     @07,IODXTN(,@01)                                    0384
         LA    @01,0(@14,@07)                                      0384
         AL    @01,@CF01494                                        0384
         L     @06,XTNADR-8(,@01)                                  0384
         ST    @06,IOCXAD(,@15)                                    0384
*                          IOCXPM = XTNPRM (CKXTN);                0385
         L     @14,XTNPRM-12(@14,@07)                              0385
         ST    @14,IOCXPM(,@15)                                    0385
*                          BLANKDSN (1:8) = DTOOPEN (1:8);         0386
*                                                                  0386
         L     @01,IOCDSN(,@08)                                    0386
         MVC   BLANKDSN(8,@01),DTOOPEN                             0386
*                          EXTFLGFD = 0;                           0387
*                                                                  0387
         SLR   @15,@15                                             0387
         ST    @15,EXTFLGFD                                        0387
*                          IF IOCMACOT = ON                        0388
*                            THEN                                  0388
         TM    IOCMACOT(@08),B'01000000'                           0388
         BNO   @RF00388                                            0388
*                              EXTOPTOT = ON;                      0389
         OI    EXTOPTOT,B'01000000'                                0389
*                            ELSE                                  0390
*                              EXTOPTIN = ON;                      0390
*                                                                  0390
         B     @RC00388                                            0390
@RF00388 OI    EXTOPTIN,B'10000000'                                0390
*                          EXTTYPE = EXOPREQ;                      0391
@RC00388 MVI   EXTTYPE,X'00'                                       0391
*                          EXTOPTDD = ON;                          0392
*                                                                  0392
         OI    EXTOPTDD,B'00100000'                                0392
*                          CALL EXTRTN                             0393
*                            (IOEXPARM,EXTFLGFD,DTOOPEN);          0393
         L     @08,IOCSPTR                                         0393
         L     @08,IOCEXT(,@08)                                    0393
         L     @01,IOCXPM(,@08)                                    0393
         ST    @01,@AL00001                                        0393
         LA    @15,EXTFLGFD                                        0393
         ST    @15,@AL00001+4                                      0393
         LA    @15,DTOOPEN                                         0393
         ST    @15,@AL00001+8                                      0393
         MVI   @AL00001+8,X'80'                                    0393
         L     @15,IOCXAD(,@08)                                    0393
         LA    @01,@AL00001                                        0393
         BALR  @14,@15                                             0393
*                          RESPECIFY RTNREG RSTD;                  0394
*                          TESTRC = RTNREG;                        0395
         STH   RTNREG,TESTRC                                       0395
*                          RESPECIFY RTNREG UNRSTD;                0396
*                                                                  0396
*                          IF TESTRC = EXTOK                       0397
*                            THEN                                  0397
*                                                                  0397
         LH    @08,TESTRC                                          0397
         LTR   @08,@08                                             0397
         BNZ   @RF00397                                            0397
*                              /**************************************/
*                              /*                                    */
*                              /* SET IOCSTR VALUES                  */
*                              /*                                    */
*                              /**************************************/
*                                                                  0398
*                              DO;                                 0398
*                                IOCMSGOP = ON;                    0399
         L     @08,IOCSPTR                                         0399
         OI    IOCMSGOP(@08),B'10000000'                           0399
*                                IOCDSOPS = ON;                    0400
         OI    IOCDSOPS(@08),B'10000000'                           0400
*                                IOCRFMVR = ON;                    0401
         OI    IOCRFMVR(@08),B'01000000'                           0401
*                                IOCTRN = 32760;                   0402
         MVC   IOCTRN(4,@08),@CF01017                              0402
*                              END;                                0403
*                            ELSE                                  0404
*                              OPENRC = 4;                         0404
*                                                                  0404
         B     @RC00397                                            0404
@RF00397 MVC   OPENRC(2),@CH00040                                  0404
*                        END SETEXT;                               0405
*                                                                  0405
@RC00397 DS    0H                                                  0406
*                  END EXISDD;                                     0406
*                                                                  0406
@RF00381 DS    0H                                                  0407
*            END CKEXLIST;                                         0407
*                                                                  0407
@RF00379 LA    @08,1                                               0407
         AH    @08,CKXTN                                           0407
@DE00377 STH   @08,CKXTN                                           0407
         L     @15,@PC00001                                        0407
         L     @01,GDTIOH(,@15)                                    0407
         L     @01,IODXTN(,@01)                                    0407
         C     @08,XTNNUM(,@01)                                    0407
         BNH   @DL00377                                            0407
*                IF IOCFLGEX = OFF                                 0408
*                  THEN                                            0408
*                                                                  0408
@RF00376 L     @08,IOCSPTR                                         0408
         L     @08,IOCEXT(,@08)                                    0408
         TM    IOCFLGEX(@08),B'10000000'                           0408
         BNZ   @RF00408                                            0408
*                    /************************************************/
*                    /*                                              */
*                    /* IF DATA SET IS NOT EXTERNALLY CONTROLLED A   */
*                    /* CONTROL BLOCK MUST BE BUILT.                 */
*                    /*                                              */
*                    /************************************************/
*                                                                  0409
*NOTEXT:             DO;                                           0409
*                                                                  0409
NOTEXT   DS    0H                                                  0410
*                      /**********************************************/
*                      /*                                            */
*                      /* GET DATA SET INFORMATION FROM JCL CARD AND */
*                      /* OPNAGL.                                    */
*                      /*                                            */
*                      /* INFORMATION FOUND IN THE CALLED ROUTINE    */
*                      /* IS SAVED IN THE IOCSTR AND IS USED TO      */
*                      /* BUILD THE PROPER CONTROL BLOCKS FOR OPEN.  */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0410
*                      CALL DSDATA (DTOOPEN);                      0410
*                                                                  0410
         LA    @08,DTOOPEN                                         0410
         ST    @08,@AL00001                                        0410
         LA    @01,@AL00001                                        0410
         BAL   @14,DSDATA                                          0410
*                      /**********************************************/
*                      /*                                            */
*                      /* SAVE THE RETURN CODE FROM THE DATA SET     */
*                      /* INFORMATION ROUTINE.                       */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0411
*                      RESPECIFY RTNREG RSTD;                      0411
*                      TESTRC = RTNREG;                            0412
         STH   RTNREG,TESTRC                                       0412
*                      RESPECIFY RTNREG UNRSTD;                    0413
*                                                                  0413
*                                                                  0413
*                      IF TESTRC = 0                               0414
*                        THEN                                      0414
*                                                                  0414
         LH    @08,TESTRC                                          0414
         LTR   @08,@08                                             0414
         BNZ   @RF00414                                            0414
*                        /********************************************/
*                        /*                                          */
*                        /* NO ERRORS HAVE BEEN DETECTED,            */
*                        /* A DCB MUST BE BUILT                      */
*                        /*                                          */
*                        /********************************************/
*                                                                  0415
*BLDCB:                  DO;                                       0415
*                                                                  0415
BLDCB    DS    0H                                                  0416
*                          CALL BUILDDBK(RETCBADR,DTOOPEN);        0416
*                                                                  0416
         LA    @08,RETCBADR                                        0416
         ST    @08,@AL00001                                        0416
         LA    @08,DTOOPEN                                         0416
         ST    @08,@AL00001+4                                      0416
         LA    @01,@AL00001                                        0416
         BAL   @14,BUILDDBK                                        0416
*                          RESPECIFY RTNREG RSTD;                  0417
*                          TESTRC = RTNREG;                        0418
         STH   RTNREG,TESTRC                                       0418
*                          RESPECIFY RTNREG UNRSTD;                0419
*                                                                  0419
*                          IF TESTRC = 0                           0420
*                            THEN                                  0420
*                                                                  0420
         LH    @08,TESTRC                                          0420
         LTR   @08,@08                                             0420
         BNZ   @RF00420                                            0420
*                              /**************************************/
*                              /*                                    */
*                              /* SET INFORMATION FOR OPEN           */
*                              /*                                    */
*                              /**************************************/
*                                                                  0421
*                              DO;                                 0421
*                                IF OPNOPTJM = ON                  0422
*                                  THEN                            0422
         TM    OPNOPTJM(OPNPTR),B'00000100'                        0422
         BNO   @RF00422                                            0422
*                                    DO;                           0423
*                                     TJNUMOP = TJNUMOP + 1;       0424
         LA    @08,1                                               0424
         AH    @08,TJNUMOP                                         0424
         STH   @08,TJNUMOP                                         0424
*                                     TJIOCSAD(TJNUMOP) = IOCSPTR; 0425
         SLA   @08,2                                               0425
         L     @02,IOCSPTR                                         0425
         ST    @02,TJIOCSAD-4(@08)                                 0425
*                                     TJCBAD(TJNUMOP) = RETCBADR;  0426
         L     @02,RETCBADR                                        0426
         ST    @02,TJCBAD-4(@08)                                   0426
*                                    END;                          0427
*                                  ELSE                            0428
*                                    DO;                           0428
         B     @RC00422                                            0428
@RF00422 DS    0H                                                  0429
*                                     NUMOPEN = NUMOPEN + 1;       0429
         AL    NUMOPEN,@CF00161                                    0429
*                                     IOCSADDR (NUMOPEN) = IOCSPTR;
         LR    @08,NUMOPEN                                         0430
         SLA   @08,2                                               0430
         L     @02,IOCSPTR                                         0430
         ST    @02,IOCSADDR-4(@08)                                 0430
*                                     OPCBADDR (NUMOPEN) = RETCBADR;
         L     @02,RETCBADR                                        0431
         ST    @02,OPCBADDR-4(@08)                                 0431
*                                    END;                          0432
*                                                                  0432
*                              END;                                0433
*                                                                  0433
@RC00422 DS    0H                                                  0434
*                        END BLDCB;                                0434
*                                                                  0434
@RF00420 DS    0H                                                  0435
*                    END NOTEXT;                                   0435
*                                                                  0435
@RF00414 DS    0H                                                  0436
*              END BLDIOCS;                                        0436
*                                                                  0436
@RF00408 DS    0H                                                  0437
*          /**********************************************************/
*          /*                                                        */
*          /* IF AN ERROR WAS DETECTED BEFORE OPEN, PRINT MESSAGE    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0437
*          IF TESTRC ^= 0                                          0437
*            THEN                                                  0437
@RF00324 LH    @08,TESTRC                                          0437
         LTR   @08,@08                                             0437
         BZ    @RF00437                                            0437
*              DO;                                                 0438
*                                                                  0438
*                /****************************************************/
*                /*                                                  */
*                /* IF MESSAGE TO PRINT - CALL PRINT ROUTINE         */
*                /*                                                  */
*                /****************************************************/
*                                                                  0439
*                IF DARGSENT ^= 0                                  0439
*                  THEN                                            0439
         L     @08,DDSTRU                                          0439
         CLI   DARGSENT(@08),0                                     0439
         BE    @RF00439                                            0439
*                    CALL BLDOCMSG (DTOOPEN);                      0440
*                                                                  0440
*                                                                  0440
         LA    @08,DTOOPEN                                         0440
         ST    @08,@AL00001                                        0440
         LA    @01,@AL00001                                        0440
         BAL   @14,BLDOCMSG                                        0440
*                OPENRC = 4;                                       0441
*                                                                  0441
@RF00439 MVC   OPENRC(2),@CH00040                                  0441
*              END;                                                0442
*                                                                  0442
*        END CKOLIST;                                              0443
*                                                                  0443
@RF00437 LA    @08,1                                               0443
         AH    @08,OPNCTR                                          0443
@DE00295 STH   @08,OPNCTR                                          0443
         L     @02,@PC00001+4                                      0443
         SLR   @15,@15                                             0443
         IC    @15,OCANUM(,@02)                                    0443
         CR    @08,@15                                             0443
         BNH   @DL00295                                            0443
*        /************************************************************/
*        /*                                                          */
*        /* OPENLIST CONTAINS THE ADDRESSES OF ALL CONTROL BLOCKS    */
*        /* TO BE OPENED.  OPEN AND SAVE RETURN CODE.                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0444
*        IF GDTDBG = NULLPTR                                       0444
*          THEN;                                                   0444
         L     @08,@PC00001                                        0444
         L     @08,GDTDBG(,@08)                                    0444
         LTR   @08,@08                                             0444
         BZ    @RT00444                                            0444
*          ELSE                                                    0446
*            CALL ICKDB010 (GDTTBL,'IO1O');                        0446
*                                                                  0446
         L     @08,@PC00001                                        0446
         ST    @08,@AL00001                                        0446
         LA    @02,@CC01024                                        0446
         ST    @02,@AL00001+4                                      0446
         MVI   @AL00001+4,X'80'                                    0446
         L     @15,GDTDBG(,@08)                                    0446
         LA    @01,@AL00001                                        0446
         BALR  @14,@15                                             0446
*        IF NUMOPEN ^= 0                                           0447
*          THEN                                                    0447
@RT00444 LTR   NUMOPEN,NUMOPEN                                     0447
         BZ    @RF00447                                            0447
*            DO;                                                   0448
*                                                                  0448
*                                                                  0448
*              OPLEND (NUMOPEN) = ON;                              0449
*                                                                  0449
*                                                                  0449
         LR    @08,NUMOPEN                                         0449
         SLA   @08,2                                               0449
         LA    @02,OPLEND-4(@08)                                   0449
         OI    0(@02),B'10000000'                                  0449
*              REG1 = ADDR (OPENLIST);                             0450
         LA    REG1,OPENLIST                                       0450
*LOPEN1:       GEN(OPEN  MF=(E,(REG1)));                           0451
LOPEN1   OPEN  MF=(E,(REG1))
*              RESPECIFY RTNREG RSTD;                              0452
*              TESTRC = RTNREG;                                    0453
         STH   RTNREG,TESTRC                                       0453
*              RESPECIFY RTNREG UNRSTD;                            0454
*              OPAMRC = TESTRC;                                    0455
*                                                                  0455
*                                                                  0455
         LH    @08,TESTRC                                          0455
         STH   @08,OPAMRC                                          0455
*              IF GDTDBG = NULLPTR                                 0456
*                THEN;                                             0456
         L     @08,@PC00001                                        0456
         L     @08,GDTDBG(,@08)                                    0456
         LTR   @08,@08                                             0456
         BZ    @RT00456                                            0456
*                ELSE                                              0458
*                  CALL ICKDB010 (GDTTBL,'IO20');                  0458
*                                                                  0458
         L     @08,@PC00001                                        0458
         ST    @08,@AL00001                                        0458
         LA    @02,@CC01027                                        0458
         ST    @02,@AL00001+4                                      0458
         MVI   @AL00001+4,X'80'                                    0458
         L     @15,GDTDBG(,@08)                                    0458
         LA    @01,@AL00001                                        0458
         BALR  @14,@15                                             0458
*            END;                                                  0459
*                                                                  0459
@RT00456 DS    0H                                                  0460
*        /************************************************************/
*        /*                                                          */
*        /* APPEND THE OPEN TYPE=J CONTROL BLOCKS LIST               */
*        /* TO THE OPEN CONTROL BLOCKS LIST.                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0460
*              DO OPNCTR = 1 TO TJNUMOP;                           0460
@RF00447 LA    @08,1                                               0460
         B     @DE00460                                            0460
@DL00460 DS    0H                                                  0461
*                  NUMOPEN = NUMOPEN + 1;                          0461
         AL    NUMOPEN,@CF00161                                    0461
*                  IOCSADDR(NUMOPEN) = TJIOCSAD(OPNCTR);           0462
         LR    @02,NUMOPEN                                         0462
         SLA   @02,2                                               0462
         LR    @15,@08                                             0462
         SLA   @15,2                                               0462
         L     @14,TJIOCSAD-4(@15)                                 0462
         ST    @14,IOCSADDR-4(@02)                                 0462
*                  OPCBADDR(NUMOPEN) = TJCBAD(OPNCTR);             0463
         L     @15,TJCBAD-4(@15)                                   0463
         ST    @15,OPCBADDR-4(@02)                                 0463
*              END;                                                0464
*                                                                  0464
         AL    @08,@CF00161                                        0464
@DE00460 STH   @08,OPNCTR                                          0464
         CH    @08,TJNUMOP                                         0464
         BNH   @DL00460                                            0464
*        /************************************************************/
*        /*                                                          */
*        /* TJOPLIST CONTAINS THE ADDRESSES OF ALL                   */
*        /* CONTROL BLOCKS TO BE OPENED WITH A MODIFIED              */
*        /* JFCB. OPEN TYPE=J AND SAVE RETURN CODE                   */
*        /* ONLY IF OPEN RETURN CODE WAS RCOK                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0465
*        IF TJNUMOP ^= 0                                           0465
*          THEN                                                    0465
         LH    @08,TJNUMOP                                         0465
         LTR   @08,@08                                             0465
         BZ    @RF00465                                            0465
*            DO;                                                   0466
*              TJLEND(TJNUMOP) = ON;                               0467
         SLA   @08,2                                               0467
         LA    @02,TJLEND-4(@08)                                   0467
         OI    0(@02),B'10000000'                                  0467
*              REG1 = ADDR(TJOPLIST);                              0468
*                                                                  0468
         LA    REG1,TJOPLIST                                       0468
*LOPENJ:       GEN (OPEN TYPE=J,MF=(E,(REG1)));                    0469
*                                                                  0469
LOPENJ   OPEN TYPE=J,MF=(E,(REG1))
*              RESPECIFY RTNREG RSTD;                              0470
*              TESTRC = RTNREG;                                    0471
         STH   RTNREG,TESTRC                                       0471
*              RESPECIFY RTNREG UNRSTD;                            0472
*                                                                  0472
*              IF OPAMRC = 0                                       0473
*                THEN OPAMRC = TESTRC;                             0473
*                                                                  0473
         LH    @08,OPAMRC                                          0473
         LTR   @08,@08                                             0473
         BNZ   @RF00473                                            0473
         LH    @08,TESTRC                                          0474
         STH   @08,OPAMRC                                          0474
*              IF GDTDBG = NULLPTR                                 0475
*                THEN;                                             0475
@RF00473 L     @08,@PC00001                                        0475
         L     @08,GDTDBG(,@08)                                    0475
         LTR   @08,@08                                             0475
         BZ    @RT00475                                            0475
*                ELSE                                              0477
*                  CALL ICKDB010 (GDTTBL,'IO3O');                  0477
*                                                                  0477
         L     @08,@PC00001                                        0477
         ST    @08,@AL00001                                        0477
         LA    @02,@CC01030                                        0477
         ST    @02,@AL00001+4                                      0477
         MVI   @AL00001+4,X'80'                                    0477
         L     @15,GDTDBG(,@08)                                    0477
         LA    @01,@AL00001                                        0477
         BALR  @14,@15                                             0477
*            END;                                                  0478
*                                                                  0478
@RT00475 DS    0H                                                  0479
*        /************************************************************/
*        /*                                                          */
*        /*       CHECK ALL CONTROL BLOCKS TO INSURE THAT THEY WERE  */
*        /*       OPENED.                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0479
*CKOPEN: DO OPNCTR = 1 TO NUMOPEN;                                 0479
*                                                                  0479
@RF00465 DS    0H                                                  0479
CKOPEN   LA    @08,1                                               0479
         B     @DE00479                                            0479
@DL00479 DS    0H                                                  0480
*          IOCSPTR = IOCSADDR (OPNCTR);                            0480
*                                                                  0480
         SLA   @08,2                                               0480
         L     @08,IOCSADDR-4(@08)                                 0480
         ST    @08,IOCSPTR                                         0480
*          /**********************************************************/
*          /*                                                        */
*          /* CHECK IF OPENED SUCCESSFULLY AND OBTAIN INPUT          */
*          /* WORK AREA, IF REQUIRED.                                */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0481
*          CALL CKNONOP;                                           0481
*                                                                  0481
         BAL   @14,CKNONOP                                         0481
*          IF IOCMSGOP = OFF                                       0482
*            THEN                                                  0482
         L     @08,IOCSPTR                                         0482
         TM    IOCMSGOP(@08),B'10000000'                           0482
         BNZ   @RF00482                                            0482
*              OPENRC = 4;                                         0483
*                                                                  0483
         MVC   OPENRC(2),@CH00040                                  0483
*        /************************************************************/
*        /*                                                          */
*        /* IF ERROR DETECTED PRINT ERROR MESSAGE AND SET ERROR RC   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0484
*        IF DARGSENT ^= 0                                          0484
*          THEN                                                    0484
@RF00482 L     @08,DDSTRU                                          0484
         CLI   DARGSENT(@08),0                                     0484
         BE    @RF00484                                            0484
*            CALL BLDOCMSG (DTOOPEN);                              0485
*                                                                  0485
         LA    @08,DTOOPEN                                         0485
         ST    @08,@AL00001                                        0485
         LA    @01,@AL00001                                        0485
         BAL   @14,BLDOCMSG                                        0485
*        END CKOPEN;                                               0486
*                                                                  0486
@RF00484 LA    @08,1                                               0486
         AH    @08,OPNCTR                                          0486
@DE00479 STH   @08,OPNCTR                                          0486
         CR    @08,NUMOPEN                                         0486
         BNH   @DL00479                                            0486
*        IF GDTDBG = NULLPTR                                       0487
*          THEN;                                                   0487
         L     @08,@PC00001                                        0487
         L     @08,GDTDBG(,@08)                                    0487
         LTR   @08,@08                                             0487
         BZ    @RT00487                                            0487
*          ELSE                                                    0489
*            CALL ICKDB010 (GDTTBL,'IO21');                        0489
*                                                                  0489
         L     @08,@PC00001                                        0489
         ST    @08,@AL00001                                        0489
         LA    @15,@CC01034                                        0489
         ST    @15,@AL00001+4                                      0489
         MVI   @AL00001+4,X'80'                                    0489
         L     @15,GDTDBG(,@08)                                    0489
         LA    @01,@AL00001                                        0489
         BALR  @14,@15                                             0489
*        RETURN CODE (OPENRC);                                     0490
*                                                                  0490
@RT00487 LH    @15,OPENRC                                          0490
         L     @14,@SA00002                                        0490
         LM    @00,@12,@SA00002+8                                  0490
         BR    @14                                                 0490
*        END OPENRTN;                                              0491
*                                                                  0492
*                                                                  0492
*                                                                  0492
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - CKNONOP                                 */
*        /*                                                          */
*        /* FUNCTION - THIS PROCEDURE CHECKS IF THE  AOS             */
*        /*            DATA SET WAS SUCCESSFULLY OPENED.             */
*        /*            IT ALSO GETS STORAGE TO BE USED AS A WORKAREA */
*        /*            FOR ISAM DATA SET WITH FIXED UNBLOCKED RECORDS*/
*        /*            AND RKP  = 0.                                 */
*        /*                                                          */
*        /* INPUT -    IOCSTR - CONTAINING THE DATA SET INFORMATION  */
*        /*                                                          */
*        /* OUTPUT -   IOCSTR - UPDATED TO REFLECT OPEN CHECKING     */
*        /*                     AND WORKAREA STORAGE OBTAINED.       */
*        /*            DMSGARG - SET WHEN AN ERROR IS DETECTED.      */
*        /*                                                          */
*        /* ERRORS -   1. ABEND EXIT WAS TAKEN DURING OPEN.          */
*        /*            2. DCB OPEN FLAG NOT SET AFTER THE OPEN.      */
*        /*            3. STORAGE NOT AVAILABLE FOR WORKAREA.        */
*        /*            4. RECORD SIZE GREATER THAN 32767.            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0492
*CKNONOP:  PROC;                                                   0492
*                                                                  0492
CKNONOP  STM   @14,@12,@SA00003                                    0492
*        DCBPTR = IOCCBA;                                          0493
         L     @08,IOCSPTR                                         0493
         L     @15,IOCEXT(,@08)                                    0493
         L     @14,IOCCBA(,@15)                                    0493
         ST    @14,DCBPTR                                          0493
*        DCBEXLSA = NULLPTR;                                       0494
*                                                                  0494
         SLR   @07,@07                                             0494
         STCM  @07,7,DCBEXLSA+28(@14)                              0494
*        IF DCBOFOPN = ON                                          0495
*          THEN                                                    0495
*                                                                  0495
         TM    DCBOFOPN+40(@14),B'00010000'                        0495
         BNO   @RF00495                                            0495
*            /********************************************************/
*            /*                                                      */
*            /* IF DCB IS OPEN SET OPEN FLAGS IN IOCS                */
*            /*                                                      */
*            /********************************************************/
*                                                                  0496
*            DO;                                                   0496
*                                                                  0496
*              IOCMSGOP = ON;                                      0497
         OI    IOCMSGOP(@08),B'10000000'                           0497
*              IOCFLGOP = ON;                                      0498
*                                                                  0498
         OI    IOCFLGOP(@15),B'00001000'                           0498
*              IF LRECLX = ON                                      0499
*                THEN                                              0499
         TM    LRECLX+72(@14),B'10000000'                          0499
         BNO   @RF00499                                            0499
*                  /**************************************************/
*                  /*                                                */
*                  /* RECORD SIZE IS GREATER THAN 32767.             */
*                  /* PRINT MESSAGE AND TURN OFF USER OPEN FLAG      */
*                  /*                                                */
*                  /**************************************************/
*                  DO;                                             0500
*                    DARGSENT = RSZID;                             0501
         L     @01,DDSTRU                                          0501
         MVI   DARGSENT(@01),X'2C'                                 0501
*                    IOCMSGOP = OFF;                               0502
         NI    IOCMSGOP(@08),B'01111111'                           0502
*                    RETURN;                                       0503
@EL00003 DS    0H                                                  0503
@EF00003 DS    0H                                                  0503
@ER00003 LM    @14,@12,@SA00003                                    0503
         BR    @14                                                 0503
*                  END;                                            0504
*                                                                  0504
*              /******************************************************/
*              /*                                                    */
*              /* OBTAIN STORAGE IF INPUT WORKAREA REQUIRED          */
*              /*                                                    */
*              /******************************************************/
*                                                                  0505
*              IF IOCMACIN = ON & IOCMACBK = ON ×                  0505
*                 IOCMACUP = ON & IOCMACBK = ON                    0505
*                THEN                                              0505
@RF00499 L     @08,IOCSPTR                                         0505
         TM    IOCMACIN(@08),B'10010000'                           0505
         BO    @RT00505                                            0505
         TM    IOCMACUP(@08),B'00110000'                           0505
         BNO   @RF00505                                            0505
@RT00505 DS    0H                                                  0506
*                  DO;                                             0506
*                                                                  0506
*                    CALL ICKSAGP0 (GDTTBL,IOCTRN,IOCWKA,IOCSID);  0507
         L     @08,@PC00001                                        0507
         ST    @08,@AL00001                                        0507
         L     @15,IOCSPTR                                         0507
         LA    @14,IOCTRN(,@15)                                    0507
         ST    @14,@AL00001+4                                      0507
         L     @15,IOCEXT(,@15)                                    0507
         LA    @14,IOCWKA(,@15)                                    0507
         ST    @14,@AL00001+8                                      0507
         LA    @15,IOCSID(,@15)                                    0507
         ST    @15,@AL00001+12                                     0507
         MVI   @AL00001+12,X'80'                                   0507
         L     @15,GDTGPL(,@08)                                    0507
         LA    @01,@AL00001                                        0507
         BALR  @14,@15                                             0507
*                    RESPECIFY RTNREG RSTD;                        0508
*                    TESTRC = RTNREG;                              0509
         STH   RTNREG,TESTRC                                       0509
*                    RESPECIFY RTNREG UNRSTD;                      0510
*                                                                  0510
*                    /************************************************/
*                    /*                                              */
*                    /* IF STORAGE WAS NOT AVAILABLE PRINT ERROR     */
*                    /* MESSAGE AND TURN OFF USER OPEN FLAG          */
*                    /*                                              */
*                    /************************************************/
*                                                                  0511
*                    IF TESTRC = 4                                 0511
*                      THEN                                        0511
         LH    @08,TESTRC                                          0511
         C     @08,@CF00040                                        0511
         BNE   @RF00511                                            0511
*                        DO;                                       0512
*                                                                  0512
*                          DARGSMOD = 'UV0';                       0513
         L     @08,DDSTRU                                          0513
         MVC   DARGSMOD(3,@08),@CC01006                            0513
*                          DARGSENT = NOCRSTID;                    0514
         MVI   DARGSENT(@08),X'04'                                 0514
*                          IOCMSGOP = OFF;                         0515
*                                                                  0515
         L     @08,IOCSPTR                                         0515
         NI    IOCMSGOP(@08),B'01111111'                           0515
*                        END;                                      0516
*                  END;                                            0517
*            END;                                                  0518
*                                                                  0518
*          ELSE                                                    0519
*                                                                  0519
*            /********************************************************/
*            /*                                                      */
*            /* DCB OPEN FLAG NOT SET.  SET ERROR ID                 */
*            /*                                                      */
*            /********************************************************/
*                                                                  0519
*            DO;                                                   0519
         B     @RC00495                                            0519
@RF00495 DS    0H                                                  0520
*              IF IOCINFAE = ON                                    0520
*                THEN                                              0520
         L     @08,IOCSPTR                                         0520
         L     @08,IOCEXT(,@08)                                    0520
         TM    IOCINFAE(@08),B'01000000'                           0520
         BNO   @RF00520                                            0520
*                  DO;                                             0521
*                    DARGSENT = ABEXSTID;                          0522
         L     @01,DDSTRU                                          0522
         MVI   DARGSENT(@01),X'18'                                 0522
*                    IOCINFAE = OFF;                               0523
         NI    IOCINFAE(@08),B'10111111'                           0523
*                  END;                                            0524
*                ELSE                                              0525
*                  DARGSENT = DOFGSTID;                            0525
         B     @RC00520                                            0525
@RF00520 L     @08,DDSTRU                                          0525
         MVI   DARGSENT(@08),X'0F'                                 0525
*            END;                                                  0526
*                                                                  0526
*        END CKNONOP;                                              0527
*                                                                  0527
         B     @EL00003                                            0527
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - CLOSERTN                                */
*        /*                                                          */
*        /* FUNCTION - THIS PROCEDURE WILL CLOSE  DATA SETS          */
*        /*            THAT WERE OPENED BY THE I/O ADAPER OPEN       */
*        /*            ROUTINE.  STORAGE OBTAINED FOR THE DATA SET   */
*        /*            WHETHER IT WAS OPENED OR NOT IS RELEASED.     */
*        /*                                                          */
*        /* INPUT -    OCARRAY - DEFINES THE DATA SETS THAT ARE TO   */
*        /*                      ARE TO BE CLOSED.                   */
*        /*                                                          */
*        /* OUTPUT -   RETURN CODE IS SET FOR THE MAIN ROUTINE.      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0528
*CLOSERTN: PROC;                                                   0528
*                                                                  0528
CLOSERTN STM   @14,@12,@SA00004                                    0528
*        /* CLOSE RETURN CODE                                        */
*        DCL CLOSERC FIXED (15);                                   0529
*        /* FLAGS USED IN CLOSE ROUTINE                              */
*        DCL 1 CFLAGS CHAR (1),                                    0530
*              2 CSKIP BIT (1);        /* DO NOT CLOSE THIS FILE     */
*        /* NUMBER DATA SETS TO CLOSE                                */
*        DCL NUMCLOSE FIXED (15);                                  0531
*        /* NUMBER OF IOCS S TO BE FREED                             */
*        DCL NUMFREE FIXED (15);                                   0532
*        /* ARGUMENT LIST SUPPLIED TO THE CLOSE SVC                  */
*        DCL 1 CLOSLIST BDY (WORD),                                0533
*              2 CLCBADDR (4) PTR (31),/* CONTROL BLOCK ADDRESS      */
*                3 CLOPT CHAR(1),      /* CLOSE OPTION               */
*                  4 CLLEND BIT (1);   /* END OF LIST                */
*        /* CLOSE DATA SET FREE IOCS COUNTER                         */
*        DCL CLOCTR FIXED (15);                                    0534
*        /* ADDRESS OF IOCS TO BE DELETED                            */
*        DCL DELEIOCS PTR (31);                                    0535
*        /* ADDRESS OF NEXT IOCS IN LIST                             */
*        DCL NEXTIOCS PTR (31);                                    0536
*        /* VARIABLE TEXT FOR CLOSE MESSAGES                         */
*        DCL CLVTEXT CHAR (8);                                     0537
*        /* RETURN CODE FROM CLOSE SVC                               */
*        DCL AMCLRC FIXED (15);                                    0538
*        /* COUNTER USED TO FIND THE CORRECT IOCSTR BEING CLOSED     */
*        DCL CLIOCTR FIXED (15);                                   0539
*        /* AREA TO PUT STORAGE IDENTIFIER                           */
*        DCL IOCSID2 CHAR (4);                                     0540
*                                                                  0540
*        /* CLOSE ERROR CODE                                         */
*        DCL CLREASON FIXED(15);                                   0541
*                                                                  0541
*        /* MACRO VARIABLE FOR CLOSE REWIND OPTION                   */
*                                                                  0542
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE COUNTERS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0542
*        NUMFREE = 0;                                              0542
         SLR   @08,@08                                             0542
         STH   @08,NUMFREE                                         0542
*        NUMCLOSE = 0;                                             0543
         SLR   NUMCLOSE,NUMCLOSE                                   0543
*        CLOSERC = 0;                                              0544
         STH   @08,CLOSERC                                         0544
*        IOCSPTR = IODIOC;                                         0545
*                                                                  0545
         L     @08,@PC00001                                        0545
         L     @08,GDTIOH(,@08)                                    0545
         L     @08,IODIOC(,@08)                                    0545
         ST    @08,IOCSPTR                                         0545
*        /************************************************************/
*        /*                                                          */
*        /* A MAXIMUM OF FOUR DATA SETS ARE CLOSED AT ONE TIME.      */
*        /* IOCSPTR HAS BEEN SET TO POINT TO THE FIRST IOCS IN THE   */
*        /* CHAIN FOR A CLOSE ALL REQUEST.  IF REQUEST IS NOT        */
*        /* CLOSE ALL IOCSPTR IS RESET.                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0546
*BLDCLOSE:                                                         0546
*                                                                  0546
*        DO CLOCTR = 1 TO 4;                                       0546
*                                                                  0546
BLDCLOSE LA    CLOCTR,1                                            0546
@DL00546 DS    0H                                                  0547
*          TESTRC = 0;                                             0547
         SLR   @08,@08                                             0547
         STH   @08,TESTRC                                          0547
*          CSKIP = OFF;                                            0548
*                                                                  0548
         NI    CSKIP,B'01111111'                                   0548
*          /**********************************************************/
*          /*                                                        */
*          /* SET ADDRESS OF A POSSIBLE IOCS.  FOR A CLOSE ALL       */
*          /* REQUEST IOCSPTR ALREADY POINTS TO AN IOCS.  IF         */
*          /* REQUEST IS NOT CLOSE ALL, CLOCTR IS USED AS AN INDEX   */
*          /* TO OBTAIN IOCS ADDRESS FROM OCARRAY.                   */
*          /*                                                        */
*          /* IF THE DATA SET IS THE DMS PRINT DATA SET AND CLOSE    */
*          /* WAS NOT INITIATED BY TERMINATION  THEN THE DATA SET    */
*          /* IS NOT CLOSED.                                         */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0549
*          IF OCAOPTCA = OFF                                       0549
*            THEN                                                  0549
         L     @15,@PC00001+4                                      0549
         TM    OCAOPTCA(@15),B'10000000'                           0549
         BNZ   @RF00549                                            0549
*              DO;                                                 0550
*                IOCSPTR = OCADDR (CLOCTR);                        0551
*                                                                  0551
         LR    @14,CLOCTR                                          0551
         SLA   @14,2                                               0551
         L     @15,OCADDR-4(@14,@15)                               0551
         ST    @15,IOCSPTR                                         0551
*                IF IOCSPTR ^= NULLPTR                             0552
*                  THEN                                            0552
         CR    @15,@08                                             0552
         BE    @RF00552                                            0552
*                    DO;                                           0553
*                                                                  0553
*                      IF IOCFLGSP = ON × IOCINFND = ON            0554
*                        THEN                                      0554
         L     @08,IOCEXT(,@15)                                    0554
         TM    IOCFLGSP(@08),B'00000010'                           0554
         BO    @RT00554                                            0554
         TM    IOCINFND(@08),B'00100000'                           0554
         BNO   @RF00554                                            0554
@RT00554 DS    0H                                                  0555
*                          CSKIP = ON;                             0555
*                                                                  0555
         OI    CSKIP,B'10000000'                                   0555
*                    END;                                          0556
*                                                                  0556
@RF00554 DS    0H                                                  0557
*              END;                                                0557
*                                                                  0557
@RF00552 DS    0H                                                  0558
*          /**********************************************************/
*          /*                                                        */
*          /* IF THE IOCS ADDRESS IS NOT ZERO THERE IS AN IOCS TO    */
*          /* FREE.                                                  */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0558
*          IF IOCSPTR ^= NULLPTR & CSKIP = OFF                     0558
*            THEN                                                  0558
@RF00549 L     @08,IOCSPTR                                         0558
         LTR   @08,@08                                             0558
         BZ    @RF00558                                            0558
         TM    CSKIP,B'10000000'                                   0558
         BNZ   @RF00558                                            0558
*INOTZERO:     DO;                                                 0559
*                                                                  0559
INOTZERO DS    0H                                                  0560
*              /******************************************************/
*              /*                                                    */
*              /* THE ADDRESS OF THE IOCS IS SAVED.  THIS ADDRESS    */
*              /* WILL BE USED AGAIN WHEN STORAGE IS FREED.          */
*              /*                                                    */
*              /******************************************************/
*                                                                  0560
*              NUMFREE = NUMFREE + 1;                              0560
         LA    @08,1                                               0560
         AH    @08,NUMFREE                                         0560
         STH   @08,NUMFREE                                         0560
*              IOCSADDR (NUMFREE) = IOCSPTR;                       0561
*                                                                  0561
*                                                                  0561
         L     @15,IOCSPTR                                         0561
         SLA   @08,2                                               0561
         ST    @15,IOCSADDR-4(@08)                                 0561
*                IF IOCFLGOP = ON                                  0562
*                  THEN                                            0562
*                                                                  0562
         L     @08,IOCEXT(,@15)                                    0562
         TM    IOCFLGOP(@08),B'00001000'                           0562
         BNO   @RF00562                                            0562
*                    /************************************************/
*                    /*                                              */
*                    /* THE CLOSE MACRO MUST BE ISSUED FOR THE       */
*                    /* DATA SET DEFINED BY THIS IOCSTR.             */
*                    /*                                              */
*                    /************************************************/
*                                                                  0563
*DSTCLOSE:           DO;                                           0563
*                                                                  0563
DSTCLOSE DS    0H                                                  0564
*                      NUMCLOSE = NUMCLOSE + 1;                    0564
         AL    NUMCLOSE,@CF00161                                   0564
*                      CLCBADDR (NUMCLOSE) = IOCCBA;               0565
*                                                                  0565
         LR    @08,NUMCLOSE                                        0565
         SLA   @08,2                                               0565
         L     @15,IOCSPTR                                         0565
         L     @01,IOCEXT(,@15)                                    0565
         L     @14,IOCCBA(,@01)                                    0565
         ST    @14,CLCBADDR-4(@08)                                 0565
*                      /**********************************************/
*                      /*                                            */
*                      /* RESET  CONTROL BLOCK VALUES                */
*                      /*                                            */
*                      /**********************************************/
*                        DCBPTR = IOCCBA;                          0566
         ST    @14,DCBPTR                                          0566
*                        DCBSYNAD = 0;                             0567
         LA    @08,52                                              0567
         ALR   @08,@14                                             0567
         SLR   @07,@07                                             0567
         ST    @07,DCBSYNAD(,@08)                                  0567
*                        DCBEXLSA = ADDR (DCBTLIST);               0568
*                                                                  0568
         LA    @07,DCBTLIST                                        0568
         STCM  @07,7,DCBEXLSA+28(@14)                              0568
*                        /********************************************/
*                        /*                                          */
*                        /* FOR BLOCKED PROCESSING SET               */
*                        /* MAXIMUM BLOCKSIZE IN DCB                 */
*                        /* BEFORE CLOSING DATA SET                  */
*                        /*                                          */
*                        /********************************************/
*                                                                  0569
*                        IF IOCMACBK = ON                          0569
*                          THEN                                    0569
         TM    IOCMACBK(@15),B'00010000'                           0569
         BNO   @RF00569                                            0569
*                            DCBBLKSI = IOCTRN;                    0570
*                                                                  0570
         L     @15,IOCTRN(,@15)                                    0570
         STH   @15,DCBBLKSI(,@08)                                  0570
*                    END DSTCLOSE;                                 0571
*                                                                  0571
*                  ELSE                                            0572
*NOCAM:              DO;                                           0572
*                                                                  0572
         B     @RC00562                                            0572
@RF00562 DS    0H                                                  0572
NOCAM    DS    0H                                                  0573
*                      IF IOCFLGEX = ON                            0573
*                        THEN                                      0573
*                                                                  0573
         L     @08,IOCSPTR                                         0573
         L     @01,IOCEXT(,@08)                                    0573
         TM    IOCFLGEX(@01),B'10000000'                           0573
         BNO   @RF00573                                            0573
*                          /******************************************/
*                          /*                                        */
*                          /* USERS EXTERNAL ROUTINE IS CALLED TO    */
*                          /* CLOSE THE DATA SET.                    */
*                          /*                                        */
*                          /******************************************/
*                                                                  0574
*                          DO;                                     0574
*                                                                  0574
*                            EXTFLGFD = 0;                         0575
         SLR   @15,@15                                             0575
         ST    @15,EXTFLGFD                                        0575
*                            EXTOPTDD = ON;                        0576
         OI    EXTOPTDD,B'00100000'                                0576
*                            IF IOCMACOT = ON                      0577
*                              THEN                                0577
         TM    IOCMACOT(@08),B'01000000'                           0577
         BNO   @RF00577                                            0577
*                                EXTOPTOT = ON;                    0578
         OI    EXTOPTOT,B'01000000'                                0578
*                              ELSE                                0579
*                                EXTOPTIN = ON;                    0579
*                                                                  0579
         B     @RC00577                                            0579
@RF00577 OI    EXTOPTIN,B'10000000'                                0579
*                            EXTTYPE = EXCLREQ;                    0580
@RC00577 MVI   EXTTYPE,X'04'                                       0580
*                            CALL EXTRTN (IOEXPARM,EXTFLGFD,IOCDSN);
         L     @08,IOCSPTR                                         0581
         L     @15,IOCEXT(,@08)                                    0581
         L     @01,IOCXPM(,@15)                                    0581
         ST    @01,@AL00001                                        0581
         LA    @14,EXTFLGFD                                        0581
         ST    @14,@AL00001+4                                      0581
         LA    @08,IOCDSN(,@08)                                    0581
         ST    @08,@AL00001+8                                      0581
         MVI   @AL00001+8,X'80'                                    0581
         L     @15,IOCXAD(,@15)                                    0581
         LA    @01,@AL00001                                        0581
         BALR  @14,@15                                             0581
*                            RESPECIFY RTNREG RSTD;                0582
*                            TESTRC = RTNREG;                      0583
         STH   RTNREG,TESTRC                                       0583
*                            RESPECIFY RTNREG UNRSTD;              0584
*                                                                  0584
*                            IF TESTRC ^= 0                        0585
*                              THEN                                0585
*                                                                  0585
         LH    @08,TESTRC                                          0585
         LTR   @08,@08                                             0585
         BZ    @RF00585                                            0585
*                                /************************************/
*                                /*                                  */
*                                /* NON-ZERO RETURN CODE FROM        */
*                                /* EXTERNAL ROUTINE.  SET ERROR CODE*/
*                                /*                                  */
*                                /************************************/
*                                CLOSERC = 4;                      0586
*                                                                  0586
         MVC   CLOSERC(2),@CH00040                                 0586
*                          END;                                    0587
*                                                                  0587
@RF00585 DS    0H                                                  0588
*                    END NOCAM;                                    0588
*                                                                  0588
@RF00573 DS    0H                                                  0589
*              END INOTZERO;                                       0589
*                                                                  0589
@RC00562 DS    0H                                                  0590
*          /**********************************************************/
*          /*                                                        */
*          /* CHECK FOR MORE IOCSS DEFINING DATA SETS TO CLOSE       */
*          /* IF CLOSE ALL HAS BEEN REQUESTED AND THERE ARE NO       */
*          /* MORE IOCSS IN THE CHAIN THE LOOP IS ENDED.             */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0590
*          IF OCAOPTCA = ON                                        0590
*            THEN                                                  0590
@RF00558 L     @08,@PC00001+4                                      0590
         TM    OCAOPTCA(@08),B'10000000'                           0590
         BNO   @RF00590                                            0590
*              DO;                                                 0591
*                                                                  0591
*                /****************************************************/
*                /*                                                  */
*                /*       IF ALL DATA SETS IN CHAIN ARE BEING CLOSED */
*                /*       THE NEXT IOCS ADDRESS IS OBTAINED.  IF     */
*                /*       THIS ADDRESS IS ZERO ALL IOCSS HAVE        */
*                /*       BEEN FOUND                                 */
*                /*                                                  */
*                /****************************************************/
*                                                                  0592
*                IOCSPTR = IOCNIO;                                 0592
         L     @08,IOCSPTR                                         0592
         L     @08,IOCEXT(,@08)                                    0592
         L     @08,IOCNIO(,@08)                                    0592
         ST    @08,IOCSPTR                                         0592
*                IF IOCSPTR = NULLPTR                              0593
*                  THEN                                            0593
         LTR   @08,@08                                             0593
         BNZ   @RF00593                                            0593
*                    CLOCTR = 4;                                   0594
*                                                                  0594
         LA    CLOCTR,4                                            0594
*              END;                                                0595
*                                                                  0595
@RF00593 DS    0H                                                  0596
*        END BLDCLOSE;                                             0596
@RF00590 AL    CLOCTR,@CF00161                                     0596
         C     CLOCTR,@CF00040                                     0596
         BNH   @DL00546                                            0596
*        /************************************************************/
*        /*                                                          */
*        /*       THE END OF THE CLOSE LIST IS SET,  THE CLOSE       */
*        /*       MACRO IS ISSUED AND THE RETURN CODE IS SAVED       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0597
*        IF NUMCLOSE ^= 0                                          0597
*          THEN                                                    0597
         SLR   @08,@08                                             0597
         CR    NUMCLOSE,@08                                        0597
         BE    @RF00597                                            0597
*            DO;                                                   0598
*                                                                  0598
*              IF GDTDBG = NULLPTR                                 0599
*                THEN;                                             0599
         L     @03,@PC00001                                        0599
         C     @08,GDTDBG(,@03)                                    0599
         BE    @RT00599                                            0599
*                ELSE                                              0601
*                  CALL ICKDB010 (GDTTBL,'IO1C');                  0601
*                                                                  0601
*                                                                  0601
*                                                                  0601
         L     @08,@PC00001                                        0601
         ST    @08,@AL00001                                        0601
         LA    @03,@CC01066                                        0601
         ST    @03,@AL00001+4                                      0601
         MVI   @AL00001+4,X'80'                                    0601
         L     @15,GDTDBG(,@08)                                    0601
         LA    @01,@AL00001                                        0601
         BALR  @14,@15                                             0601
*              CLLEND (NUMCLOSE) = ON;                             0602
@RT00599 LR    @08,NUMCLOSE                                        0602
         SLA   @08,2                                               0602
         LA    @03,CLLEND-4(@08)                                   0602
         OI    0(@03),B'10000000'                                  0602
*              REG1 = ADDR (CLOSLIST);                             0603
         LA    REG1,CLOSLIST                                       0603
*LCLOSE1:      GEN(CLOSE   MF=(E,(REG1)));                         0604
LCLOSE1  CLOSE   MF=(E,(REG1))
*              RESPECIFY RTNREG RSTD;                              0605
*              TESTRC = RTNREG;                                    0606
         STH   RTNREG,TESTRC                                       0606
*              RESPECIFY RTNREG UNRSTD;                            0607
*              AMCLRC = TESTRC;                                    0608
*                                                                  0608
         LH    @08,TESTRC                                          0608
         LR    AMCLRC,@08                                          0608
*            END;                                                  0609
*                                                                  0609
*        /************************************************************/
*        /*                                                          */
*        /* ALL DATA SETS ARE CHECKED TO SEE THAT THEY               */
*        /* WERE SUCCESSFULLY CLOSED.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0610
*CKCLOSE:                                                          0610
*        DO CLOCTR = 1 TO NUMFREE;                                 0610
*                                                                  0610
@RF00597 DS    0H                                                  0610
CKCLOSE  LA    CLOCTR,1                                            0610
         B     @DE00610                                            0610
@DL00610 DS    0H                                                  0611
*          IOCSPTR = IOCSADDR (CLOCTR);                            0611
*                                                                  0611
         LR    @08,CLOCTR                                          0611
         SLA   @08,2                                               0611
         L     @08,IOCSADDR-4(@08)                                 0611
         ST    @08,IOCSPTR                                         0611
*          /**********************************************************/
*          /*                                                        */
*          /* FREE STORAGE UNIQUE TO THE ENVIRONMENT                 */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0612
*          CALL ENVFREE;                                           0612
*                                                                  0612
         BAL   @14,ENVFREE                                         0612
*          /**********************************************************/
*          /*                                                        */
*          /* PRINT ANY CLOSE ERROR MESSAGES                         */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0613
*          IF DARGSENT ^= 0                                        0613
*            THEN                                                  0613
         L     @08,DDSTRU                                          0613
         CLI   DARGSENT(@08),0                                     0613
         BE    @RF00613                                            0613
*              DO;                                                 0614
*                CLOSERC = 4;                                      0615
         MVC   CLOSERC(2),@CH00040                                 0615
*                CALL BLDOCMSG (CLVTEXT);                          0616
         LA    @08,CLVTEXT                                         0616
         ST    @08,@AL00001                                        0616
         LA    @01,@AL00001                                        0616
         BAL   @14,BLDOCMSG                                        0616
*              END;                                                0617
*                                                                  0617
*          /**********************************************************/
*          /*                                                        */
*          /* THE IOCS STORAGE AND ANY OTHER STORAGE THE DATA SET    */
*          /* USED THAT WAS OBTAINED BY THE UGPOOL IS RELEASED AND   */
*          /* THE IOCS CHAIN IS UPDATED.                             */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0618
*          DELEIOCS = IOCSPTR;                                     0618
@RF00613 L     @08,IOCSPTR                                         0618
         LR    DELEIOCS,@08                                        0618
*          NEXTIOCS = IOCNIO;                                      0619
*                                                                  0619
         L     @08,IOCEXT(,@08)                                    0619
         L     @15,IOCNIO(,@08)                                    0619
         ST    @15,NEXTIOCS                                        0619
*          /**********************************************************/
*          /*                                                        */
*          /* FREE THE STORAGE USED                                  */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0620
*          IOCSID2 = IOCSID;                                       0620
         MVC   IOCSID2(4),IOCSID(@08)                              0620
*          CALL ICKSAFP0 (GDTTBL,IOCSID2);                         0621
*                                                                  0621
         L     @08,@PC00001                                        0621
         ST    @08,@AL00001                                        0621
         LA    @15,IOCSID2                                         0621
         ST    @15,@AL00001+4                                      0621
         MVI   @AL00001+4,X'80'                                    0621
         L     @15,GDTFPL(,@08)                                    0621
         LA    @01,@AL00001                                        0621
         BALR  @14,@15                                             0621
*          /**********************************************************/
*          /*                                                        */
*          /*     UPDATE THE IOCS CHAIN POINTER.                     */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0622
*          IF IODIOC = DELEIOCS                                    0622
*            THEN                                                  0622
         L     @08,@PC00001                                        0622
         L     @08,GDTIOH(,@08)                                    0622
         C     DELEIOCS,IODIOC(,@08)                               0622
         BNE   @RF00622                                            0622
*              IODIOC = NEXTIOCS;                                  0623
*                                                                  0623
         L     @02,NEXTIOCS                                        0623
         ST    @02,IODIOC(,@08)                                    0623
*            ELSE                                                  0624
*              DO;                                                 0624
*                                                                  0624
         B     @RC00622                                            0624
@RF00622 DS    0H                                                  0625
*                IOCSPTR = IODIOC;                                 0625
*                                                                  0625
         L     @08,@PC00001                                        0625
         L     @08,GDTIOH(,@08)                                    0625
         L     @08,IODIOC(,@08)                                    0625
         ST    @08,IOCSPTR                                         0625
*                DO WHILE IOCNIO ^= DELEIOCS;                      0626
         B     @DE00626                                            0626
@DL00626 DS    0H                                                  0627
*                  IOCSPTR = IOCNIO;                               0627
         L     @08,IOCSPTR                                         0627
         L     @08,IOCEXT(,@08)                                    0627
         L     @08,IOCNIO(,@08)                                    0627
         ST    @08,IOCSPTR                                         0627
*                END;                                              0628
*                                                                  0628
@DE00626 L     @08,IOCSPTR                                         0628
         L     @08,IOCEXT(,@08)                                    0628
         C     DELEIOCS,IOCNIO(,@08)                               0628
         BNE   @DL00626                                            0628
*                IOCNIO = NEXTIOCS;                                0629
*                                                                  0629
         L     @02,NEXTIOCS                                        0629
         ST    @02,IOCNIO(,@08)                                    0629
*              END;                                                0630
*                                                                  0630
*        END CKCLOSE;                                              0631
*                                                                  0631
@RC00622 AL    CLOCTR,@CF00161                                     0631
@DE00610 CH    CLOCTR,NUMFREE                                      0631
         BNH   @DL00610                                            0631
*        IF GDTDBG = NULLPTR                                       0632
*          THEN;                                                   0632
         L     @08,@PC00001                                        0632
         L     @08,GDTDBG(,@08)                                    0632
         LTR   @08,@08                                             0632
         BZ    @RT00632                                            0632
*          ELSE                                                    0634
*            CALL ICKDB010 (GDTTBL,'IO2C');                        0634
*                                                                  0634
         L     @08,@PC00001                                        0634
         ST    @08,@AL00001                                        0634
         LA    @15,@CC01072                                        0634
         ST    @15,@AL00001+4                                      0634
         MVI   @AL00001+4,X'80'                                    0634
         L     @15,GDTDBG(,@08)                                    0634
         LA    @01,@AL00001                                        0634
         BALR  @14,@15                                             0634
*        RETURN CODE (CLOSERC);                                    0635
@RT00632 LH    @15,CLOSERC                                         0635
         L     @14,@SA00004                                        0635
         LM    @00,@12,@SA00004+8                                  0635
         BR    @14                                                 0635
*        END CLOSERTN;                                             0636
*                                                                  0636
*          /**********************************************************/
*          /*                                                        */
*          /* PROCEDURE NAME - ENVFREE                               */
*          /*                                                        */
*          /* FUNCTION - THIS PROCEDURE IS CALLED TO FREE            */
*          /*            STORAGE USED FOR THE DATA SET THAT WAS NOT  */
*          /*            OBTAINED WITH THE UGPOOL.                   */
*          /*                                                        */
*          /*            A CHECK IS MADE IF A CLOSE ABEND EXIT WAS   */
*          /*            TAKEN.                                      */
*          /*                                                        */
*          /* INPUT -    IOCSTR DEFINING THE DATA SET.               */
*          /*                                                        */
*          /* OUTPUT -   DMSGARG - SET IF ERROR DETECTED.            */
*          /*                                                        */
*          /* ERRORS -   1. CLOSE ABEND EXIT TAKEN.                  */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0637
*ENVFREE:  PROC;                                                   0637
*                                                                  0637
ENVFREE  STM   @14,@12,@SA00005                                    0637
*          IF IOCINFAE = ON                                        0638
*            THEN                                                  0638
*                                                                  0638
         L     @08,IOCSPTR                                         0638
         L     @08,IOCEXT(,@08)                                    0638
         TM    IOCINFAE(@08),B'01000000'                           0638
         BNO   @RF00638                                            0638
*              /******************************************************/
*              /*                                                    */
*              /* ABEND EXIT TAKEN DURING CLOSE.  SET MESSAGE ID     */
*              /*                                                    */
*              /******************************************************/
*                                                                  0639
*              DARGSENT = ABEXSTID;                                0639
*                                                                  0639
         L     @08,DDSTRU                                          0639
         MVI   DARGSENT(@08),X'18'                                 0639
*            /********************************************************/
*            /*                                                      */
*            /* THE IOCS DEFINES A  DATA SET.  IF THE                */
*            /* DATA SET WAS OPENED (NOT EXTERNAL) THE BUFFER        */
*            /* POOL STORAGE IS FREED.                               */
*            /* POOL NOT FREED FOR BSAM DATA SET OR IF               */
*            /* SOME ERROR CAUSED AREA NOT TO BE GOTTEN.             */
*            /*                                                      */
*            /********************************************************/
*                                                                  0640
*          IF IOCFLGOP = ON & IOCMACBK = OFF & IOCCBUFF = OFF      0640
*            THEN                                                  0640
@RF00638 L     @08,IOCSPTR                                         0640
         L     @15,IOCEXT(,@08)                                    0640
         TM    IOCFLGOP(@15),B'00001000'                           0640
         BNO   @RF00640                                            0640
         TM    IOCMACBK(@08),B'00010000'                           0640
         BNZ   @RF00640                                            0640
         L     @08,DCBPTR                                          0640
         TM    IOCCBUFF+16(@08),B'00000001'                        0640
         BNZ   @RF00640                                            0640
*              DO;                                                 0641
*                                                                  0641
*                REG7 = IOCCBA;                                    0642
         L     REG7,IOCCBA(,@15)                                   0642
*LFREEP1:        GEN(FREEPOOL (REG7));                             0643
*                                                                  0643
LFREEP1  FREEPOOL (REG7)
*              END;                                                0644
*                                                                  0644
*        END ENVFREE;                                              0645
*                                                                  0645
*                                                                  0645
@EL00005 DS    0H                                                  0645
@EF00005 DS    0H                                                  0645
@ER00005 LM    @14,@12,@SA00005                                    0645
         BR    @14                                                 0645
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - DSDATA                                          */
*/*                                                                  */
*/* FUNCTION - THIS PROCEDURE CHECKS FOR AN ALTERNATE DDNAME,        */
*/*            ISSUES THE DEVTYPE MACRO TO DETERMINE IF DATA SET     */
*/*            RESIDES ON DIRECT ACCESS AND ISSUES THE RDJFCB MACRO  */
*/*            TO DETERMINE THE DATA SET NAME AND IF THE DATA SET    */
*/*            CLASS IS SYSOUT OR DD *.                              */
*/*                                                                  */
*/* INPUT -    THE OPNAGL BUILT BY THE CALLER DEFINING THE DATA SET  */
*/*            TO OPEN.                                              */
*/*                                                                  */
*/* OUTPUT   - THE DATA FROM THE CONTROL BLOCKS READ IS PLACED       */
*/*            IN THE IOCS.                                          */
*/*                                                                  */
*/* ERRORS   -   1. MISSING DD CARD.                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0646
*DSDATA: PROC (JFCDNAME) OPTIONS (SAVEAREA);                       0646
*                                                                  0646
DSDATA   STM   @14,@12,12(@13)                                     0646
         ST    @13,@SA00006+4                                      0646
         LA    @14,@SA00006                                        0646
         ST    @14,8(,@13)                                         0646
         LR    @13,@14                                             0646
         MVC   @PC00006(4),0(@01)                                  0646
*        /* RETURN CODE FROM THIS ROUTINE                            */
*        DCL DSDRC FIXED (15);                                     0647
*                                                                  0647
*        /* DNAME ON JCL CARD TO LOCATE JCL DATA                     */
*        DCL JFCDNAME CHAR (8);                                    0648
*                                                                  0648
*        /* SAVE THE DATA SET NAME FOR THE USER                      */
*        DCL DSNAME CHAR (44) BASED (IOCDSN);                      0649
*                                                                  0649
*        /* COUNTER USED IN CHECKING FOR ALTERNATE DDNAMES           */
*        DCL DDN FIXED (15);                                       0650
*        DCL CKDD FIXED (15);                                      0651
*                                                                  0651
*        /* THE ALTERNATE DD LIST PASSED AS ARGUMENT                 */
*        DCL 1 ALTDLIST BASED (IODADD),                            0652
*              2 DDLLEN CHAR (2),      /* LIST LENGTH                */
*              2 ALTDD (10) CHAR (8);  /* ALTERNATE DDNAMES          */
*                                                                  0652
*        /* DDNAMES THAT MAY HAVE ALTERNATES (POSITIONAL)            */
*        DCL DEFDD (10) CHAR (8) INIT ('SYSLIN ','        ',       0653
*        'SYSLMOD ','SYSLIB  ','SYSIN   ','SYSPRINT','SYSPUNCH',   0653
*        'SYSUT1  ','SYSUT2  ','SYSUT3  ');                        0653
*                                                                  0653
*        /* DCB USED FOR THE RDJFCB                                  */
*        DCL READDCB CHAR (96) BASED (ADDR (WORKAREA) + 176);      0654
*                                                                  0654
*        DCL JFCBPTR PTR (31);         /* ADDRESS OF JFCB            */
*                                                                  0655
*        /* EXIT LIST USED TO READ THE JFCB                          */
*        DCL 1 DCBRLIST BDY (WORD),    /* DCB EXIT LIST              */
*              2 DCBRLID CHAR (1),     /* LIST IDENTIFIER            */
*              2 DCBRLPTR PTR (24);    /* BLOCK ADDRESS              */
*                                                                  0656
*        DCL 1 DCBEXWRD PTR (31),      /* EXIT ARG LIST              */
*              2 DCBEXEND BIT (1);     /* END OF LIST                */
*                                                                  0657
*        DCL 1 DEVAREA BDY (WORD),     /* DEVTYPE AREA               */
*              2 * CHAR (2),           /* NOT REFERENCED             */
*              2 DEVWORD CHAR (1),     /* DEVIVE BYTE                */
*                3 DEVTAPE BIT (1),    /* DEVICE IS TAPE             */
*                3 * BIT (1),                                      0658
*                3 DEVTDA BIT (1),     /* DIRECT ACCESS              */
*                3 * BIT (1),                                      0658
*                3 DEVTUR BIT (1),     /* UNIT RECORD DEVICE         */
*              2 * CHAR (5);           /* NOT REFERENCED             */
*                                                                  0658
*        /* DSNAME AND VOLSERS FOR JFCB MODFICATION                  */
*        DCL MODJNM CHAR(44) BASED (OPNDSN);                       0659
*                                                                  0659
*        DCL 1 MODJVL BASED (OPNVOL),                              0660
*              2 MODJCNT FIXED(8),                                 0660
*              2 MODJSERS CHAR(30);                                0660
*                                                                  0660
*        /* INHIBIT JFCB WRITE BACK INDICATOR                        */
*        DCL JFINHWB CHAR(1) INIT('08'X);                          0661
*                                                                  0661
*        /* VOLUME SERIAL NAME LENGTH                                */
*        DCL VLSRL FIXED(15) CONSTANT(6);                          0662
*                                                                  0662
*        /* INCLUDE THE JFCB PLS DECLARE                             */
*                                                                  0663
*                                                                  0663
*/* **************************************************************** */
*/*                                                                  */
*/*                    JOB FILE CONTROL BLOCK                        */
*/*                                                                  */
*/*  OS/VS2 RELEASE 3.0 AND 3.7 PTF, 03/16/77, LEVEL=1               */
*/*                                                                  */
*/*  METHOD OF ACCESS                                                */
*/*      BAL  - A DSECT CARD SHOULD PRECEDE MACRO CALL.  USING ON    */
*/*             INFMJFCB GIVES ADDRESSABILITY FOR ALL SYMBOLS.       */
*/*      PL/S - DCL JFCBPTR PTR                                      */
*/*                                                                  */
*/*  F.E.'S                                                          */
*/*      MICROFICHE LISTING - IEFJFCBN                               */
*/*                                                                  */
*/*  DEVELOPERS                                                      */
*/*      BAL LISTING  - SPECIFY LIST=YES ON MACRO CALL.              */
*/*      PL/S LISTING - SPECIFY %IHALIST='YES' BEFORE INCLUDE.       */
*/*                                                                  */
*/*      FOR INTEGRATION A LISTING SHOULD NOT BE REQUESTED.          */
*/* **************************************************************** */
*                                                                  0663
*DECLARE                                                           0663
*  1 INFMJFCB BASED(JFCBPTR) BDY(WORD),                            0663
*   2 JFCBDSNM CHAR(44) BDY(WORD), /* DATA SET NAME                  */
*    3 JFCBQNAM CHAR(8) BDY(WORD), /* PROCESS QUEUE NAME SPECIFIED BY
*                                     THE QNAME KEYWORD  (TCAM)      */
*   2 JFCBELNM CHAR(8) BDY(WORD),  /* ELEMENT NAME OR RELATIVE     0663
*                                     GENERATION NUMBER.  TYPE OF  0663
*                                     AREA (INDEX, PRIME OR OVERFLOW)
*                                     FOR AN INDEXED SEQUENTIAL DATA
*                                     SET ONLY.                      */
*    3 JFCIPLTX CHAR(7) BDY(WORD), /* MODULE NAME OF NETWORK CONTROL
*                                     PROGRAM  (TCAM)          ICB391*/
*   2 JFCBTSDM BIT(8),             /* JOB MANAGEMENT/DATA MANAGEMENT
*                                     INTERFACE                      */
*    3 JFCCAT   BIT(1),            /* DATA SET IS CATALOGED          */
*    3 JFCVSL   BIT(1),            /* VOLUME SERIAL LIST HAS BEEN  0663
*                                     CHANGED                        */
*    3 JFCSDS   BIT(1),            /* DATA SET IS A SYSIN OR SYSOUT
*                                     DATA SET                       */
*    3 JFCTTR   BIT(1),            /* A JOB STEP IS TO BE RESTARTED.
*                                     USE JFCBOTTR INSTEAD OF      0663
*                                     DS1LSTAR FIELD TO REPOSITION 0663
*                                     DATA SET IF AUTOMATIC STEP   0663
*                                     RESTART OCCURS.  (THIS JOB HAD
*                                     ABEND PROCESSING FOR A DATA SET
*                                     OPENED FOR MOD.)               */
*    3 JFCNWRIT BIT(1),            /* DO NOT WRITE BACK THE JFCB   0663
*                                     DURING OPEN PROCESSING         */
*    3 JFCNDSCB BIT(1),            /* DO NOT MERGE DSCB OR LABEL   0663
*                                     FIELDS INTO THIS JFCB          */
*    3 JFCNDCB  BIT(1),            /* DO NOT MERGE DCB FIELDS INTO 0663
*                                     THIS JFCB                      */
*    3 JFCPAT   BIT(1),            /* THE PATTERNING DSCB IS COMPLETE*/
*   2 JFCBDSCB CHAR(3) BDY(WORD,2),/* TTR ADDRESS OF THE FORMAT 1  0663
*                                     DSCB FOR DATA SET PART ON THE
*                                     FIRST VOLUME OF THE DATA SET 0663
*                                                              ICB398*/
*   2 JFCFCBID CHAR(4) BDY(WORD),  /* FORMS CONTROL BUFFER IMAGE   0663
*                                     IDENTIFICATION FOR THE 3211  0663
*                                     PRINTER OR DATA PROTECTION   0663
*                                     IMAGE IDENTIFICATION FOR THE 0663
*                                     3525 CARD PUNCH WITH THE READ
*                                     AND PRINT FEATURES OR FORMAT 0663
*                                     RECORD ID                MDC007*/
*    3 JFCBFRID CHAR(4) BDY(WORD), /* LAST 4 CHARACTERS OF A PDS   0663
*                                     MEMBER TO BE USED IN THE     0663
*                                     INTERPRETATION OF DOCUMENTS  0663
*                                     READ BY 3886 DEVICE FOR THIS 0663
*                                     STEP                     MDC024*/
*     4 JFCAMCRO CHAR(2) BDY(WORD), /* VSAM CHECKPOINT/RESTART OPTION
*                                     INDICATORS               ICB438*/
*     4 JFCAMSTR FIXED(15) BDY(WORD,3), /* NUMBER OF STRINGS   ICB438*/
*   2 JFCBADBF FIXED(15) BDY(WORD), /* NUMBER OF DATA BUFFERS  ICB438*/
*   2 JFCNLREC FIXED(15) BDY(WORD,3), /* LOGICAL RECORD LENGTH FOR 0663
*                                     VSAM                     ICB438*/
*   2 JFCVINDX FIXED(15) BDY(WORD), /* MASS STORAGE SYSTEM         0663
*                                     COMMUNICATOR (MSSC) VOLUME   0663
*                                     SELECTION INDEX              0663
*                                     (MDC308)               @Z30LP9A*/
*   2 JFCBLTYP BIT(8) BDY(WORD,3), /* LABEL TYPE                     */
*    3 JFCRSV38 BIT(1),            /* RESERVED                       */
*    3 JFCBAL   BIT(1),            /* AMERICAN NATIONAL STANDARD TAPE
*                                     LABELS (AL OR IF BIT 4 IS ALSO
*                                     ON, AUL)                       */
*    3 JFCBLTM  BIT(1),            /* UNLABELLED TAPE CREATED BY DOS
*                                     MAY HAVE LEADING TAPE MARK.  0663
*                                     OPEN/CLOSE/EOV AND RESTART MUST
*                                     SPACE OVER A TAPE MARK IF ONE
*                                     EXISTS.                  ICB398*/
*    3 JFCBLP   BIT(1),            /* BYPASS LABEL PROCESSING        */
*    3 JFCSUL   BIT(1),            /* USER LABEL                     */
*    3 JFCNSL   BIT(1),            /* NONSTANDARD LABEL              */
*    3 JFCSL    BIT(1),            /* STANDARD LABEL                 */
*    3 JFCNL    BIT(1),            /* NO LABEL                       */
*   2 JFCBOTTR CHAR(3) BDY(WORD,4),/* DASD MOD DATA SET - IF AUTOMATIC
*                                     STEP RESTART WAS REQUESTED, TTR
*                                     OF THE END-OF-DATA INDICATOR 0663
*                                     EXISTING WHEN THE DATA SET WAS
*                                     FIRST OPENED DURING THE      0663
*                                     ORIGINAL EXECUTION OF THE    0663
*                                     CURRENT STEP                   */
*    3 JFCBUFOF PTR(8),            /* TAPE DATA SET - THIS FIELD   0663
*                                     CONTAINS THE BUFFER OFFSET (DCB
*                                     SUBPARAMETER VALUE)            */
*     4 JFCBFOFL BIT(1),           /* IF 1, THE OFFSET EQUALS FOUR 0663
*                                     AND THE BUFFER OFFSET FIELD OF
*                                     EACH BLOCK (D-FORMAT RECORDS)
*                                     CONTAINS THE BLOCK LENGTH    0663
*                                     (SPECIFIED BY BUFOFF=L).     0663
*                                     IF 0, THE OFFSET IS AS       0663
*                                     SPECIFIED IN THE REMAINING   0663
*                                     SEVEN BITS AND THE BUFFER    0663
*                                     OFFSET FIELD OF EACH BLOCK DOES
*                                     NOT CONTAIN THE BLOCK LENGTH.  */
*    3 JFCBFLSQ FIXED(15),         /* FOR MAGNETIC TAPE DEVICES,   0663
*                                     FILE SEQUENCE NUMBER           */
*     4 JFCFUNC  BIT(8),           /* FUNCTION INDICATORS FOR THE  0663
*                                     3525 CARD PUNCH (SPECIFIED BY
*                                     THE FUNC PARAMETER)      ICB392*/
*      5 JFCFNCBI BIT(1),          /* I - INTERPRET (PUNCH AND PRINT
*                                     TWO LINES)               ICB392*/
*      5 JFCFNCBR BIT(1),          /* R - READ                 ICB392*/
*      5 JFCFNCBP BIT(1),          /* P - PUNCH                ICB392*/
*      5 JFCFNCBW BIT(1),          /* W - PRINT                ICB392*/
*      5 JFCFNCBD BIT(1),          /* D - DATA PROTECTION      ICB392*/
*      5 JFCFNCBX BIT(1),          /* X - THIS DATA SET IS TO BE   0663
*                                     PRINTED.  THIS MAY BE CODED  0663
*                                     WITH PW OR RPW TO DISTINGUISH
*                                     THE DATA SET TO BE PRINTED FROM
*                                     THE DATA SET TO BE PUNCHED.  0663
*                                                              ICB392*/
*      5 JFCFNCBT BIT(1),          /* T - TWO-LINE PRINT SUPPORT   0663
*                                     REQUEST.  THE SECOND PRINT LINE
*                                     IS LOCATED ON CARD LINE THREE.
*                                                              ICB392*/
*      5 JFCRSV31 BIT(1),          /* RESERVED                 ICB392*/
*   2 JFCBVLSQ FIXED(15),          /* VOLUME SEQUENCE NUMBER         */
*   2 JFCBMASK CHAR(8) BDY(WORD),  /* DATA MANAGEMENT TASK           */
*    3 JFCBOPS1 CHAR(5),           /* OPEN ROUTINE INTERNAL SWITCHES */
*    3 JFCBFLG1 BIT(8),            /* FLAG BYTE                      */
*     4 JFCSTAND BIT(1),           /* VOLUME LABEL PROCESSING      0663
*                                     STANDARD                       */
*     4 JFCSLCRE BIT(1),           /* CREATION OF A STANDARD LABEL 0663
*                                     IS NECESSARY                   */
*     4 JFCSLDES BIT(1),           /* DESTRUCTION OF A STANDARD LABEL
*                                     IS NECESSARY                   */
*     4 JFCDUAL  BIT(1),           /* DUAL-DENSITY CHECK DETECTED    */
*     4 JFCOPEN  BIT(4),           /* OPEN ROUTINE INTERNAL SWITCHES */
*      5 *        BIT(3),          /* OPEN ROUTINE INTERNAL SWITCHES */
*      5 JFCBPWBP BIT(1),          /* PASSWORD BYPASS INDICATOR    0663
*                                                              MDC010*/
*    3 JFCBFLG2 BIT(8),            /* FLAG BYTE OF OPEN SWITCHES     */
*     4 JFCINOP  BIT(1),           /* TREAT THE INOUT OPTION OF OPEN
*                                     AS INPUT                       */
*     4 JFCOUTOP BIT(1),           /* TREAT THE OUTIN OPTION OF OPEN
*                                     AS OUTPUT                      */
*     4 JFCDEFER BIT(1),           /* SET ONLY IN A JFCB RECORDED IN
*                                     A DATA SET DESCRIPTOR RECORD 0663
*                                     (DSDR) BY THE CHECKPOINT     0663
*                                     ROUTINE.  INDICATES THAT THE 0663
*                                     DATA SET RELATED TO THE JFCB IS
*                                     BEING PROCESSED SEQUENTIALLY,
*                                     AT THE CHECKPOINT, ON A VOLUME
*                                     OTHER THAN THE VOLUME ON WHICH
*                                     PROCESSING BEGAN IN THE CURRENT
*                                     STEP.  WHEN RESTART OCCURS,  0663
*                                     THIS BIT CAUSES DEFERRED VOLUME
*                                     MOUNTING.                      */
*      5 JFCNRPS  BIT(1),          /* USE BY OPEN ROUTINES - SET TO
*                                     INDICATE THAT THIS DATA SET  0663
*                                     RESIDES ON A NON-RPS DEVICE. 0663
*                                     RESET TO ZERO WHEN OPEN      0663
*                                     PROCESSING IS COMPLETED. ICB495*/
*     4 JFCMODNW BIT(1),           /* DISPOSITION OF THIS DATA SET 0663
*                                     HAS BEEN CHANGED FROM MOD TO 0663
*                                     NEW.  DISPOSITION (IN JFCBIND2)
*                                     WILL BE RESTORED TO MOD AFTER
*                                     OPEN.                          */
*     4 JFCSDRPS BIT(1),           /* USE SEARCH DIRECT FOR        0663
*                                     ROTATIONAL POSITION SENSING  0663
*                                     (RPS) DEVICES            ICB398*/
*     4 JFCTRACE BIT(1),           /* GTF TRACE IS TO OCCUR DURING 0663
*                                     OPEN/CLOSE/EOV AND DYNAMIC   0663
*                                     ALLOCATION PROCESSING OF DCB 0663
*                                                              ICB392*/
*     4 JFCBBUFF BIT(1),           /* INDICATOR TO OPEN THAT A     0663
*                                     NON-ZERO VALUE IN JFCBOTTR IS
*                                     NOT TO PREVENT THE NORMAL    0663
*                                     STORING BY OPEN OF A TTR IN  0663
*                                     JFCBOTTR.  BEFORE OPEN -     0663
*                                     JFCBUFOF (OFFSET 67) CONTAINS
*                                     A BUFFER OFFSET OR INVALID   0663
*                                     INFORMATION RESULTING FROM A 0663
*                                     JFCB-TO-JFCB MERGE.  AFTER   0663
*                                     OPEN - OPEN MAY HAVE STORED A
*                                     TTR IN JFCBOTTR (OFFSET 67), IN
*                                     WHICH CASE OPEN WILL HAVE SET
*                                     THIS BIT TO ZERO.              */
*     4 JFCRCTLG BIT(1),           /* OPEN HAS UPDATED THE TTR.    0663
*                                     SCHEDULER STEP TERMINATION   0663
*                                     ROUTINE IS TO RECATALOG THIS 0663
*                                     DATA SET AND PLACE IN THE    0663
*                                     CATALOG ENTRY THE DSCB TTR   0663
*                                     CONTAINED IN JFCBDSCB IF THIS
*                                     DATA SET IS CATALOGED.   ICB398*/
*    3 JFCBOPS2 BIT(8),            /* OPEN ROUTINE INTERNAL SWITCHES */
*   2 JFCBCRDT CHAR(3) BDY(WORD),  /* DATA SET CREATION DATE (YDD, 0663
*                                     Y=YEAR AND DD=DAY)             */
*   2 JFCBXPDT CHAR(3) BDY(WORD,4),/* DATA SET EXPIRATION DATE (YDD) */
*   2 JFCBIND1 BIT(8),             /* INDICATOR BYTE 1               */
*    3 JFCRLSE  BIT(2),            /* RELEASE EXTERNAL STORAGE       */
*    3 JFCLOC   BIT(2),            /* DATA SET HAS BEEN LOCATED      */
*    3 JFCADDED BIT(2),            /* NEW VOLUME HAS BEEN ADDED TO 0663
*                                     THE DATA SET                   */
*    3 JFCGDG   BIT(1),            /* DATA SET IS A MEMBER OF A    0663
*                                     GENERATION DATA GROUP          */
*    3 JFCPDS   BIT(1),            /* DATA SET IS A MEMBER OF A    0663
*                                     PARTITIONED DATA SET           */
*   2 JFCBIND2 BIT(8),             /* INDICATOR BYTE 2               */
*    3 JFCDISP  BIT(2),            /* BIT PATTERN FOR NEW, MOD, OLD  */
*    3 JFCSECUR BIT(2),            /* DATA SET SECURITY              */
*    3 JFCSHARE BIT(1),            /* SHARED DATA SET                */
*    3 JFCENT   BIT(1),            /* DELETE THIS JFCB BEFORE      0663
*                                     ALLOCATION FOR A RESTARTED   0663
*                                     GENERATION DATA GROUP          */
*    3 JFCREQ   BIT(1),            /* STORAGE VOLUME REQUESTED       */
*    3 JFCTEMP  BIT(1),            /* TEMPORARY DATA SET             */
*   2 JFCAMPTR PTR(31),            /* POINTER TO AMPBLK FOR        0663
*                                     ADDITIONAL VSAM PARAMETERS   0663
*                                                              ICB438*/
*    3 JFCBUFRQ CHAR(1),           /* NUMBER OF BUFFERS REQUIRED FOR
*                                     EACH LINE (QTAM)               */
*     4 JFCBUFNO CHAR(1),          /* NUMBER OF BUFFERS REQUIRED FOR
*                                     THIS DATA SET (ACCESS METHODS
*                                     OTHER THAN TCAM AND QTAM)      */
*      5 JFCBUFIN BIT(4),          /* THE NUMBER OF BUFFERS ASSIGNED
*                                     INITIALLY FOR RECEIVING      0663
*                                     OPERATIONS FOR EACH LINE IN A
*                                     LINE GROUP  (TCAM)       MDC021*/
*      5 JFCBFOUT BIT(4),          /* THE NUMBER OF BUFFERS ASSIGNED
*                                     INITIALLY FOR SENDING        0663
*                                     OPERATIONS FOR EACH LINE IN A
*                                     LINE GROUP  (TCAM)       MDC022*/
*    3 JFCBGNCP PTR(8),            /* FOR GAM, THIS FIELD IS USED FOR
*                                     THE NUMBER OF IOB'S CONSTRUCTED
*                                     BY THE OPEN ROUTINE.  MAXIMUM
*                                     NUMBER IS 99.            MDC025*/
*     4 JFCBHIAR CHAR(1),          /* BUFFER POOL LOCATION IN MAIN 0663
*                                     STORAGE (HIERARCHY)            */
*      5 JFCBFALN CHAR(1),         /* BUFFER ALIGNMENT               */
*       6 JFCBFTEK BIT(8),         /* BUFFERING TECHNIQUE            */
*        7 JFCHIER  BIT(1),        /* BITS 0 AND 5 DESCRIBE MAIN   0663
*                                     STORAGE HIERARCHY.  BOTH BITS
*                                     OFF, HIERARCHY 0.  BIT 0 OFF 0663
*                                     AND BIT 5 ON, HIERARCHY 1.     */
*        7 JFCBBFTA BIT(2),        /* A - FOR QSAM LOCATE MODE     0663
*                                     PROCESSING OF SPANNED RECORDS,
*                                     AUTOMATIC RECORD AREA        0663
*                                     CONSTRUCTION DURING LOGICAL  0663
*                                     RECORD INTERFACE PROCESSING. 0663
*                                     OPEN IS TO CONSTRUCT A RECORD
*                                     AREA IF IT AUTOMATICALLY     0663
*                                     CONSTRUCTS BUFFERS.            */
*         8 JFCSIM   BIT(1),       /* S - SIMPLE BUFFERING           */
*         8 JFCBBFTR BIT(1),       /* R - FOR BSAM CREATE BDAM     0663
*                                     PROCESSING OR BDAM PROCESSING
*                                     OF UNBLOCKED SPANNED RECORDS,
*                                     SOFTWARE TRACK OVERFLOW.  OPEN
*                                     FORMS A SEGMENT WORK AREA POOL
*                                     AND STORES THE ADDRESS OF THE
*                                     SEGMENT WORK AREA CONTROL BLOCK
*                                     IN THE DCBEOBW FIELD OF THE  0663
*                                     DATA CONTROL BLOCK.  WRITE USES
*                                     A SEGMENT WORK AREA TO WRITE A
*                                     RECORD AS ONE OR MORE SEGMENTS.
*                                     FOR BSAM INPUT PROCESSING OF 0663
*                                     UNBLOCKED SPANNED RECORDS WITH
*                                     KEYS, RECORD OFFSET PROCESSING.
*                                     READ READS ONE RECORD SEGMENT
*                                     INTO THE RECORD AREA.  THE   0663
*                                     FIRST SEGMENT OF A RECORD IS 0663
*                                     PRECEDED IN THE RECORD AREA BY
*                                     THE KEY.  SUBSEQUENT SEGMENTS
*                                     ARE AT AN OFFSET EQUAL TO THE
*                                     KEY LENGTH.                    */
*        7 JFCEXC   BIT(1),        /* E - EXCHANGE BUFFERING         */
*        7 JFCDYN   BIT(1),        /* DYNAMIC BUFFERING              */
*        7 JFCHIER1 BIT(1),        /* HIERARCHY 1 MAIN STORAGE       */
*        7 JFCDWORD BIT(1),        /* D - DOUBLE WORD BOUNDARY       */
*        7 JFCFWORD BIT(1),        /* F - FULL WORD NOT A DOUBLE   0663
*                                     WORD BOUNDARY                  */
*    3 JFCBUFL  FIXED(15) BDY(WORD,3), /* BUFFER LENGTH              */
*   2 JFCEROPT BIT(8),             /* ERROR OPTION.  DISPOSITION OF
*                                     PERMANENT ERRORS IF USER     0663
*                                     RETURNS FROM A SYNCHRONOUS   0663
*                                     ERROR EXIT  (QSAM)             */
*    3 JFCACC   BIT(1),            /* ACCEPT                         */
*    3 JFCSKP   BIT(1),            /* SKIP                           */
*    3 JFCABN   BIT(1),            /* ABNORMAL END OF TASK           */
*    3 JFCTOPT  BIT(1),            /* ON-LINE TERMINAL TEST        0663
*                                     (BTAM)                   ICB349*/
*    3 JFCRSV02 BIT(1),            /* RESERVED                       */
*    3 JFCRSV03 BIT(1),            /* RESERVED                       */
*    3 JFCRSV04 BIT(1),            /* RESERVED                       */
*    3 JFCRSV05 BIT(1),            /* RESERVED                       */
*   2 JFCTRTCH CHAR(1) BDY(WORD,2);/* TAPE RECORDING TECHNIQUE     0663
*                                     FOR 7-TRACK TAPE               */
*                                                                  0663
*DECLARE                                                           0664
*  1 JFCKEYLE CHAR(1) DEF(JFCTRTCH) BDY(WORD,2),                   0664
*                                  /* DIRECT ACCESS KEY LENGTH       */
*   2 JFCCODE  BIT(8) BDY(BYTE),   /* CONVERSION CODE (PAPER TAPE)   */
*    3 JFCNOCON BIT(1),            /* N - NO CONVERSION              */
*    3 JFCBCD   BIT(1),            /* I - IBM BCD                    */
*    3 JFCFRI   BIT(1),            /* F - FRIDEN                     */
*    3 JFCBUR   BIT(1),            /* B - BURROUGHS                  */
*    3 JFCNCR   BIT(1),            /* C - NATIONAL CASH REGISTER     */
*    3 JFCASCII BIT(1),            /* A - ASCII (8-TRACK)            */
*    3 JFCTTY   BIT(1),            /* T - TELETYPE                   */
*    3 JFCRSV32 BIT(1);            /* RESERVED                       */
*                                                                  0664
*DECLARE                                                           0665
*  1 JFCSTACK BIT(8) DEF(JFCTRTCH) BDY(WORD,2),                    0665
*                                  /* STACKER SELECTION (CARD READER,
*                                     (CARD PUNCH)                   */
*   2 JFCMODE  BIT(8) BDY(WORD,2), /* MODE OF OPERATION (CARD READER,
*                                     (CARD PUNCH)             ICB394*/
*    3 JFCBIN   BIT(1),            /* C - COLUMN BINARY MODE         */
*    3 JFCEBCD  BIT(1),            /* E - EBCDIC MODE                */
*    3 JFCMODEO BIT(1),            /* O - OPTICAL MARK READ MODE   0665
*                                     (3505 ONLY)              ICB394*/
*    3 JFCMODER BIT(1),            /* R - READ COLUMN ELIMINATE MODE
*                                     (3505 AND 3525 WITH READ     0665
*                                     FEATURE)                 ICB394*/
*    3 JFCRSV06 BIT(1),            /* RESERVED                       */
*    3 JFCRSV07 BIT(1),            /* RESERVED                       */
*    3 JFCTWO   BIT(1),            /* 2 - STACKER TWO                */
*    3 JFCONE   BIT(1);            /* 1 - STACKER ONE                */
*                                                                  0665
*DECLARE                                                           0666
*  1 JFCSPPRT DEF(JFCTRTCH) BDY(WORD,2),                           0666
*   2 JFCPRTSP BIT(8) BDY(WORD,2), /* NORMAL PRINTER SPACING         */
*   2 JFCDEN   BIT(8),             /* TAPE DENSITY - 2400/3400 SERIES
*                                     MAGNETIC TAPE UNITS            */
*   2 JFCBABFS PTR(24) BDY(WORD,4),/* TOTAL BUFFER SIZE FOR ALL VSAM
*                                     BUFFERS                  ICB438*/
*    3 JFCLIMCT CHAR(3) BDY(WORD,4),/* SEARCH LIMIT (BDAM)           */
*     4 *        CHAR(1),          /* RESERVED                       */
*     4 JFCTRKBL CHAR(2) BDY(WORD),/* DATA SET OPENED FOR MOD - IF 0666
*                                     AUTOMATIC STEP RESTART WAS   0666
*                                     REQUESTED, TRACK BALANCE     0666
*                                     EXISTING WHEN THE DATA SET WAS
*                                     FIRST OPENED DURING THE      0666
*                                     ORIGINAL EXECUTION OF THE    0666
*                                     CURRENT STEP                   */
*   2 JFCDSORG BIT(16) BDY(WORD,3),/* DATA SET ORGANIZATION BEING  0666
*                                     USED                           */
*    3 JFCDSRG1 BIT(8),            /* BYTE 1 OF JFCDSORG             */
*     4 JFCORGIS BIT(1),           /* INDEXED SEQUENTIAL             */
*     4 JFCORGPS BIT(1),           /* PHYSICAL SEQUENTIAL            */
*     4 JFCORGDA BIT(1),           /* DIRECT                         */
*     4 JFCORGCX BIT(1),           /* BTAM OR QTAM LINE GROUP  MDC011*/
*     4 JFCORGCQ BIT(1),           /* QTAM DIRECT ACCESS MESSAGE   0666
*                                     QUEUE                    MDC012*/
*     4 JFCORGMQ BIT(1),           /* QTAM PROBLEM PROGRAM MESSAGE 0666
*                                     QUEUE                    MDC013*/
*     4 JFCORGPO BIT(1),           /* PARTITIONED                    */
*     4 JFCORGU  BIT(1),           /* UNMOVABLE - THE DATA CONTAINS
*                                     LOCATION DEPENDENT INFORMATION */
*    3 JFCDSRG2 BIT(8),            /* BYTE 2 OF JFCDSORG             */
*     4 JFCORGGS BIT(1),           /* GRAPHICS                       */
*     4 JFCORGTX BIT(1),           /* TCAM LINE GROUP          MDC014*/
*     4 JFCORGTQ BIT(1),           /* TCAM MESSAGE QUEUE       MDC015*/
*     4 JFCRSV13 BIT(1),           /* RESERVED, BINARY ZERO          */
*     4 JFCORGAM BIT(1),           /* VSAM                     ICB438*/
*     4 JFCORGTR BIT(1),           /* TCAM 3705                MDC016*/
*     4 JFCRSV15 BIT(1),           /* RESERVED, BINARY ZERO          */
*     4 JFCRSV16 BIT(1),           /* RESERVED, BINARY ZERO          */
*   2 JFCRECFM BIT(8) BDY(WORD),   /* RECORD FORMAT                  */
*    3 JFCRCFM  BIT(3),            /* RECORD FORMAT (USASI/USASCII)
*                                                              MDC023*/
*     4 JFCFMREC BIT(2),           /* BITS INDICATING RECORD FORMAT  */
*     4 JFCRFO   BIT(1),           /* T - TRACK OVERFLOW             */
*    3 JFCRFB   BIT(1),            /* B - BLOCKED - MAY NOT OCCUR  0666
*                                     WITH UNDEFINED                 */
*    3 JFCRFS   BIT(1),            /* S - FOR FIXED LENGTH RECORD  0666
*                                     FORMAT, STANDARD BLOCKS.  NO 0666
*                                     TRUNCATED BLOCKS OR UNFILLED 0666
*                                     TRACKS ARE EMBEDDED IN THE DATA
*                                     SET.                         0666
*                                     FOR VARIABLE LENGTH RECORD   0666
*                                     FORMAT, SPANNED RECORDS.       */
*    3 JFCCHAR  BIT(2),            /* CONTROL CHARACTER              */
*    3 *        BIT(1),            /* RESERVED                       */
*   2 JFCOPTCD BIT(8) BDY(WORD,2), /* OPTION CODES                   */
*    3 JFCWVCSP BIT(1),            /* QSAM-BSAM-BPAM - W - WRITE   0666
*                                     VALIDITY CHECK                 */
*     4 JFCWVCIS BIT(1),           /* BISAM-QISAM - W - WRITE      0666
*                                     VALIDITY CHECK                 */
*      5 JFCWVCBD BIT(1),          /* BDAM - W - WRITE VALIDITY    0666
*                                     CHECK                          */
*       6 JFCSDNAM BIT(1),         /* TCAM - SOURCE OR DESTINATION 0666
*                                     NAME PRECEDES MESSAGE (AFTER 0666
*                                     CONTROL BYTE)                  */
*    3 JFCALLOW BIT(1),            /* QSAM-BSAM-BPAM - U - ALLOW A 0666
*                                     DATA CHECK CAUSED BY AN      0666
*                                     INVALID CHARACTER (1403      0666
*                                     PRINTER WITH UCS FEATURE)      */
*     4 JFCRSV17 BIT(1),           /* RESERVED                       */
*      5 JFCOVER  BIT(1),          /* BDAM - TRACK OVERFLOW          */
*       6 JFCWUMSG BIT(1),         /* TCAM - WORK UNIT IS A MESSAGE
*                                     (DEFAULT WORK UNIT IS A RECORD)*/
*    3 JFCPCIBT BIT(1),            /* QSAM-BSAM-BPAM - C - CHAINED 0666
*                                     SCHEDULING USING THE PROGRAM 0666
*                                     CONTROLLED INTERRUPTION        */
*     4 JFCMAST  BIT(1),           /* BISAM-QISAM - M - MASTER     0666
*                                     INDEXES                        */
*      5 JFCEXT   BIT(1),          /* BDAM - E - EXTENDED SEARCH     */
*       6 JFCCBWU  BIT(1),         /* TCAM - CONTROL BYTE PRECEDES 0666
*                                     WORK UNIT                      */
*    3 JFCBCKPT BIT(1),            /* QSAM-BSAM-BPAM - BYPASS      0666
*                                     EMBEDDED DOS CHECKPOINT      0666
*                                     RECORDS ON TAPE         ICB398*/
*     4 JFCIND   BIT(1),           /* BISAM-QISAM - I - INDEPENDENT
*                                     OVERFLOW AREA                  */
*      5 JFCFEED  BIT(1),          /* BDAM - F - FEEDBACK            */
*    3 JFCRSV18 BIT(1),            /* RESERVED                       */
*     4 JFCCYL   BIT(1),           /* BISAM-QISAM - Y - CYLINDER   0666
*                                     OVERFLOW AREA                  */
*      5 JFCACT   BIT(1),          /* BDAM - A - ACTUAL ADRESSING    */
*       6 JFCOPTQ  BIT(1),         /* USASI/USASCII - EBCDIC TO ASCII
*                                     OR ASCII TO EBCDIC TRANSLATION
*                                     REQUIRED                       */
*    3 JFCREDUC BIT(1),            /* QSAM-BSAM-BPAM-EXCP - Z -    0666
*                                     USE REDUCED ERROR RECOVERY   0666
*                                     PROCEDURE (MAGNETIC TAPE)      */
*     4 JFCRSV19 BIT(1),           /* RESERVED                       */
*      5 JFCRSV20 BIT(1),          /* RESERVED                       */
*       6 JFCSRCHD BIT(1),         /* QSAM-BSAM-BPAM - USE SEARCH  0666
*                                     DIRECT (SD) INSTEAD OF SEARCH
*                                     PREVIOUS ON ROTATIONAL POSITION
*                                     SENSING (RPS) DEVICE.  (DIRECT
*                                     ACCESS)                        */
*    3 JFCRSV21 BIT(1),            /* RESERVED                       */
*     4 JFCDEL   BIT(1),           /* BISAM-QISAM - L - DELETE     0666
*                                     OPTION                         */
*      5 JFCRSV22 BIT(1),          /* RESERVED                       */
*    3 JFCOPTJ  BIT(1),            /* QSAM-BSAM-BPAM - J - 3800    0666
*                                     CONTROL CHARACTER            0666
*                                     (MDC301)               @Z40MP9A*/
*     4 JFCREORG BIT(1),           /* BISAM-QISAM - R -            0666
*                                     REORGANIZATION CRITERIA        */
*      5 JFCREL   BIT(1),          /* BDAM - R - RELATIVE BLOCK    0666
*                                     ADDRESSING                     */
*   2 JFCBLKSI FIXED(15) BDY(WORD,3), /* MAXIMUM BLOCK SIZE          */
*    3 JFCBUFSI FIXED(15) BDY(WORD,3), /* MAXIMUM BUFFER SIZE        */
*     4 JFCBAXBF FIXED(15) BDY(WORD,3), /* NUMBER OF INDEX BUFFERS 0666
*                                     (VSAM)                   ICB438*/
*   2 JFCAMSYN CHAR(8) BDY(WORD),  /* MODULE NAME FOR SYNAD ROUTINE
*                                     FOR VSAM                 ICB438*/
*    3 JFCLRECL FIXED(15) BDY(WORD), /* LOGICAL RECORD LENGTH        */
*    3 JFCNCP   CHAR(1) BDY(WORD,3), /* NUMBER OF CHANNEL PROGRAMS.
*                                     NUMBER OF READ OR WRITE      0666
*                                     REQUESTS WHICH MAY BE ISSUED 0666
*                                     PRIOR TO A CHECK.  NUMBER OF 0666
*                                     IOB'S GENERATED.  (MAXIMUM   0666
*                                     NUMBER IS 99.)               0666
*                                     NOTE - GAM USES JFCBFTEK FOR 0666
*                                     THIS INFORMATION AND DOES    0666
*                                     NOT USE THIS FIELD AT ALL.     */
*     4 JFCBUFMX CHAR(1),          /* THE MAXIMUM NUMBER OF BUFFERS
*                                     TO BE USED FOR DATA TRANSFER 0666
*                                     FOR EACH LINE IN THIS LINE   0666
*                                     GROUP  (TCAM)                  */
*    3 JFCNTM   CHAR(1) BDY(WORD,4), /* THE NUMBER OF TRACKS THAT  0666
*                                     DETERMINE THE DEVELOPMENT OF A
*                                     MASTER INDEX.  MAXIMUM NUMBER
*                                     IS 99.  (ISAM)                 */
*     4 JFCBFSEQ PTR(8),           /* TAPE POSITIONING INFORMATION 0666
*                                     FOR CHECKPOINT RESTART.  THIS
*                                     FIELD IS USED TO PASS A      0666
*                                     PHYSICAL FILE SEQUENCE COUNT 0666
*                                     FROM CHECKPOINT TO RESTART.  0666
*                                     THE COUNT TELLS THE PHYSICAL 0666
*                                     POSITION OF THE TAPE VOLUME  0666
*                                     THAT WAS BEING PROCESSED WHEN
*                                     THE CHECKPOINT WAS TAKEN.    0666
*                                                             SA60703*/
*      5 JFCPCI   BIT(8),          /* PROGRAM-CONTROLLED INTERRUPTION
*                                     (PCI) FLAG BYTE (TCAM)         */
*       6 JFCPCIX1 BIT(1),         /* PCI=(X,) RECEIVE OPERATIONS  0666
*                                                              ICB473*/
*       6 JFCPCIX2 BIT(1),         /* PCI=(,X) SEND OPERATIONS     0666
*                                     X INDICATES THAT AFTER THE   0666
*                                     FIRST BUFFER IS FILLED (ON   0666
*                                     RECEIVE OPERATIONS) OR EMPTIED
*                                     (ON SEND OPERATIONS), A PCI  0666
*                                     OCCURS DURING THE FILLING OR 0666
*                                     EMPTYING OF THE NEXT BUFFER. 0666
*                                     THE FIRST BUFFER REMAINS     0666
*                                     ALLOCATED AND ANOTHER IS     0666
*                                     ALLOCATED.               ICB473*/
*       6 JFCPCIA1 BIT(1),         /* PCI=(A,) RECEIVE OPERATIONS    */
*       6 JFCPCIA2 BIT(1),         /* PCI=(,A) SEND OPERATIONS     0666
*                                     A INDICATES THAT AFTER THE   0666
*                                     FIRST BUFFER IS FILLED (ON   0666
*                                     RECEIVE OPERATIONS) OR EMPTIED
*                                     (ON SEND OPERATIONS), A PCI  0666
*                                     OCCURS DURING THE FILLING OR 0666
*                                     EMPTYING OF THE NEXT BUFFER. 0666
*                                     THE FIRST BUFFER IS DEALLOCATED.
*                                     A BUFFER IS ALLOCATED IN PLACE
*                                     OF THE DEALLOCATED BUFFER.     */
*       6 JFCPCIN1 BIT(1),         /* PCI=(N,) RECEIVE OPERATIONS    */
*       6 JFCPCIN2 BIT(1),         /* PCI=(,N) SEND OPERATIONS     0666
*                                     N INDICATES THAT NO PCI'S ARE
*                                     TAKEN DURING FILLING (ON     0666
*                                     RECEIVE OPERATIONS) OR EMPTYING
*                                     (ON SEND OPERATIONS) OF BUFFERS.
*                                     BUFFERS ARE DEALLOCATED AT THE
*                                     END OF TRANSMISSION.           */
*       6 JFCPCIR1 BIT(1),         /* PCI=(R,) RECEIVE OPERATIONS    */
*       6 JFCPCIR2 BIT(1),         /* PCI=(,R) SEND OPERATIONS     0666
*                                     R INDICATES THAT AFTER THE   0666
*                                     FIRST BUFFER IS FILLED (ON   0666
*                                     RECEIVE OPERATIONS) OR EMPTIED
*                                     (ON SEND OPERATIONS), A PCI  0666
*                                     OCCURS DURING THE FILLING OR 0666
*                                     EMPTYING OF EACH SUCCEEDING  0666
*                                     BUFFER.  THE COMPLETED BUFFER
*                                     IS DEALLOCATED, BUT NO NEW   0666
*                                     BUFFER IS ALLOCATED TO TAKE  0666
*                                     ITS PLACE.                     */
*                                                                  0666
* /*******************************************************************/
* /*                                                                 */
* /*                     NORMAL 108 SEGMENT                          */
* /*                                                                 */
* /*******************************************************************/
*                                                                  0666
*    3 JFCRESRV CHAR(4) BDY(WORD), /* FIRST BYTE CONTAINS NUMBER OF
*                                     BYTES FOR TIME OF DAY.  SECOND
*                                     BYTE CONTAINS NUMBER OF BYTES
*                                     FOR DATE.  THIRD BYTE CONTAINS
*                                     NUMBER OF BYTES FOR OUTSEQ.  0666
*                                     FOURTH BYTE CONTAINS NUMBER OF
*                                     BYTES IN.  (TCAM)              */
*     4 JFCRKP   FIXED(15) BDY(WORD), /* THE RELATIVE POSITION OF THE
*                                     FIRST BYTE OF THE KEY WITHIN 0666
*                                     EACH LOGICAL RECORD.  MAXIMUM
*                                     VALUE IS LOGICAL RECORD LENGTH
*                                     MINUS KEY LENGTH.              */
*     4 JFCCYLOF CHAR(1),          /* THE NUMBER OF TRACKS TO BE   0666
*                                     RESERVED ON EACH CYLINDER TO 0666
*                                     HOLD RECORDS THAT OVERFLOW   0666
*                                     FROM OTHER TRACKS ON THAT    0666
*                                     CYLINDER.  MAXIMUM VALUE IS  0666
*                                     99.                            */
*     4 JFCDBUFN CHAR(1),          /* RESERVED                       */
*   2 JFCINTVL CHAR(1) BDY(WORD);  /* INTENTIONAL DELAY, IN SECONDS,
*                                     BETWEEN PASSES THROUGH A     0666
*                                     POLLING LIST (QTAM)            */
*                                                                  0666
* /*******************************************************************/
* /*                                                                 */
* /*                     END OF NORMAL 108 SEGMENT                   */
* /*                                                                 */
* /*******************************************************************/
*                                                                  0667
* /*******************************************************************/
* /*                                                                 */
* /*                     108 PRINTER SEGMENT                         */
* /*                                                                 */
* /*     NOTE  THIS SEGMENT REPLACES THE NORMAL 108 SEGMENT IF       */
* /*           THE DD STATEMENT USES THE UCS PARAMETER.              */
* /*                                                                 */
* /*******************************************************************/
*                                                                  0667
*DECLARE                                                           0667
*  1 JFCUCSEG DEF(JFCRESRV) BDY(WORD),                             0667
*   2 JFCUCSID CHAR(4) BDY(WORD),  /* NAME OF THE UCS IMAGE TO BE  0667
*                                     LOADED                         */
*   2 JFCUCSOP BIT(8),             /* OPERATION OF THE UCS IMAGE TO
*                                     BE LOADED                      */
*    3 JFCBEXTP BIT(1),            /* JFCB EXTENSION PRESENT FOR 3800
*                                     DEVICE  (MDC302)       @Z40MP9A*/
*    3 JFCFOLD  BIT(1),            /* UCS IMAGE IS TO BE LOADED IN 0667
*                                     THE FOLD MODE                  */
*    3 JFCRSV25 BIT(1),            /* RESERVED                       */
*    3 JFCVER   BIT(1),            /* UCS IMAGE IS TO BE VERIFIED    */
*    3 JFCFCBAL BIT(1),            /* FORMS ARE TO BE ALIGNED        */
*    3 JFCFCBVR BIT(1),            /* FORMS CONTROL BUFFER (FCB)   0667
*                                     IMAGE IS TO BE VERIFIED        */
*    3 JFCRSV26 BIT(1),            /* RESERVED                       */
*    3 JFCRSV27 BIT(1),            /* RESERVED                       */
*                                                                  0667
* /*******************************************************************/
* /*                                                                 */
* /*                     END OF 108 PRINTER SEGMENT                  */
* /*                                                                 */
* /*******************************************************************/
*                                                                  0667
*   2 JFCOUTLI PTR(24) BDY(WORD,2),/* SMF - SYSOUT LIMIT.  BINARY  0667
*                                     REPRESENTATION OF THE OUTLIM=
*                                     PARAMETER ON THE SYSOUT DD   0667
*                                     STATEMENT.  THE MAXIMUM NUMBER
*                                     OF LOGICAL RECORDS SPECIFIED 0667
*                                     FOR THIS OUTPUT DATA SET.      */
*    3 JFCTHRSH CHAR(1),           /* RECORDS TO BE USED             */
*     4 JFCCPRI  BIT(8),           /* PRIORITY BETWEEN SEND AND    0667
*                                     RECEIVE OPERATIONS (TCAM)      */
*      5 JFCRSV53 BIT(1),          /* RESERVED                 MDC020*/
*      5 JFCRSV54 BIT(1),          /* RESERVED                 MDC019*/
*      5 JFCRSV55 BIT(1),          /* RESERVED                 MDC018*/
*      5 JFCRSV33 BIT(1),          /* RESERVED                       */
*      5 JFCRSV34 BIT(1),          /* RESERVED                       */
*      5 JFCRECV  BIT(1),          /* RECEIVE PRIORITY         MDC018*/
*      5 JFCEQUAL BIT(1),          /* EQUAL PRIORITY           MDC019*/
*      5 JFCSEND  BIT(1),          /* SEND PRIORITY            MDC020*/
*    3 JFCSOWA  FIXED(15),         /* LENGTH, IN BYTES, OF THE USER-
*                                     PROVIDED WORK AREA (QTAM)      */
*   2 JFCBNTCS CHAR(1),            /* NUMBER OF OVERFLOW TRACKS      */
*   2 JFCBNVOL CHAR(1),            /* NUMBER OF VOLUME SERIAL NUMBERS*/
*   2 JFCBVOLS CHAR(30) BDY(WORD,3),/* THE FIRST FIVE VOLUME SERIAL
*                                     NUMBERS                        */
*    3 JFCAVOLS (5) CHAR(6);       /* THE FIRST FIVE VOLUME SERIAL 0667
*                                     NUMBERS                @Z30LP9A*/
*                                                                  0667
*DECLARE                                                           0668
*  1 JFCBS001 DEF(JFCBVOLS) BDY(WORD,3), /*                  @Z30LP9A*/
*   2 *        CHAR(22),           /* FIRST 22 BYTES OF            0668
*                                     JFCBVOLS               @Z30LP9A*/
*   2 JFCMSVGP CHAR(8) BDY(WORD),  /* MASS STORAGE VOLUME GROUP FROM
*                                     WHICH TO SELECT A VOLUME     0668
*                                     (MDC306)               @Z30LP9A*/
*   2 JFCBEXTL CHAR(1),            /* LENGTH OF BLOCK OF EXTRA VOLUME
*                                     SERIAL NUMBERS (BEYOND FIVE)   */
*   2 JFCBEXAD CHAR(3),            /* RELATIVE TRACK ADDRESS (TTR) 0668
*                                     OF FIRST JFCB EXTENSION BLOCK
*                                     FOR VOLUME SERIAL NUMBERS OR 0668
*                                     TTR OF JFCB EXTENSION BLOCK  0668
*                                     FOR 3800  (MDC303)     @Z40MP9A*/
*   2 JFCBPQTY CHAR(3) BDY(WORD),  /* PRIMARY QUANTITY OF DIRECT   0668
*                                     ACCESS STORAGE REQUIRED        */
*    3 JFCRUNIT CHAR(3),           /* UNIT TYPE (EBCDIC) OF A DEVICE
*                                     AT A REMOTE TERMINAL.  THE   0668
*                                     FIRST TWO CHARACTERS ARE RD  0668
*                                     (READER), PR (PRINTER) OR PU 0668
*                                     (PUNCH).  THE THIRD CHARACTER
*                                     IS A NUMBER FROM 1 TO 9. ICB387*/
*   2 JFCBCTRI BIT(8),             /* SPACE PARAMETERS               */
*    3 JFCBSPAC BIT(2),            /* SPACE MASK BITS                */
*    3 JFCBMSGP BIT(1),            /* REQUEST IS FOR A MASS STORAGE
*                                     VOLUME GROUP (MSVGP) VOLUME  0668
*                                     (MDC307)               @Z30LP9A*/
*    3 JFCRSV29 BIT(1),            /* RESERVED                       */
*    3 JFCONTIG BIT(1),            /* CONTIG REQUEST                 */
*    3 JFCMIXG  BIT(1),            /* MXIG REQUEST                   */
*    3 JFCALX   BIT(1),            /* ALX REQUEST                    */
*    3 JFCROUND BIT(1),            /* ROUND REQUEST                  */
*   2 JFCBSQTY CHAR(3) BDY(WORD),  /* SECONDARY QUANTITY OF DIRECT 0668
*                                     ACCESS STORAGE REQUIRED        */
*    3 JFCRQID  FIXED(15),         /* QUEUE IDENTIFICATION (QID) USED
*                                     BY ACCESS METHOD TO DETERMINE
*                                     THE REMOTE TERMINAL LOCATION 0668
*                                     FOR THIS JOB.            ICB387*/
*   2 JFCFLGS1 BIT(8),             /* FLAG BYTE (ICB488)      SA53458*/
*    3 JFCBDLET BIT(1),            /* IF ONE, DELETE THE DATA SET  0668
*                                     USED WHEN EXTENDING THE JOB  0668
*                                     QUEUE OR SPOOL DATA SETS     0668
*                                     (OS/VS1)  (MDC305)     @XM05457*/
*    3 JFCTOPEN BIT(1),            /* TAPE DATA SET HAS BEEN OPENED
*                                                              MDC026*/
*    3 JFCBADSP BIT(1),            /* AUTOMATIC DATA SET PROTECTION
*                                     INDICATOR  (MDC310)    @Z40RP9A*/
*    3 JFCRSV42 BIT(1),            /* RESERVED  (MDC311)             */
*    3 JFCBCEOV BIT(1),            /* IF ONE, CHKPT=EOV SPECIFIED FOR
*                                     THIS DATA SET (MDC312) @Z30JP9A*/
*    3 JFCVRDS  BIT(1),            /* VIO DATA SET             MDC006*/
*    3 JFCRSV45 BIT(1),            /* RESERVED                       */
*    3 JFCBUAFF BIT(1),            /* UNIT AFFINITY SPECIFIED FOR  0668
*                                     THIS DATA SET (ICB488)  SA53458*/
*   2 JFCBDQTY CHAR(3) BDY(WORD),  /* QUANTITY OF DIRECT ACCESS    0668
*                                     STORAGE REQUIRED FOR A       0668
*                                     DIRECTORY OR AN EMBEDDED INDEX
*                                     AREA                           */
*   2 JFCBSPNM PTR(24) BDY(WORD,4),/* MAIN STORAGE ADDRESS OF THE  0668
*                                     JFCB WITH WHICH CYLINDERS ARE
*                                     SPLIT (OS/VS1)               0668
*                                     (MDC315)               @ZA18180*/
*    3 JFCBFLG3 BIT(8),            /* FLAG BYTE (OS/VS2)           0668
*                                     (MDC316)               @ZA18180*/
*     4 JFCDQDSP BIT(1),           /* REQUEST DEQUEUE OF TAPE VOLUME
*                                     WHEN DEMOUNTED               0668
*                                     (MDC317)               @ZA18180*/
*     4 JFCBRV01 BIT(1),           /* RESERVED               @ZA18180*/
*     4 JFCBRV02 BIT(1),           /* RESERVED               @ZA18180*/
*     4 JFCBRV03 BIT(1),           /* RESERVED               @ZA18180*/
*     4 JFCBRV04 BIT(1),           /* RESERVED               @ZA18180*/
*     4 JFCBRV05 BIT(1),           /* RESERVED               @ZA18180*/
*     4 JFCBRV06 BIT(1),           /* RESERVED               @ZA18180*/
*     4 JFCBRV07 BIT(1),           /* RESERVED               @ZA18180*/
*    3 JFCBRV08 FIXED(15),         /* RESERVED (OS/VS2)      @ZA18180*/
*   2 JFCBABST FIXED(15),          /* RELATIVE ADDRESS OF FIRST TRACK
*                                     TO BE ALLOCATED                */
*   2 JFCBSBNM PTR(24) BDY(WORD),  /* MAIN STORAGE ADDRESS OF THE  0668
*                                     JFCB FROM WHICH SPACE IS TO  0668
*                                     BE SUBALLOCATED                */
*   2 JFCBDRLH CHAR(3) BDY(WORD,4),/* AVERAGE DATA BLOCK LENGTH      */
*   2 JFCBVLCT CHAR(1),            /* VOLUME COUNT                   */
*   2 JFCBSPTN CHAR(1),            /* NUMBER OF TRACKS PER CYLINDER
*                                     TO BE USED BY THIS DATA SET  0668
*                                     WHEN SPLIT CYLINDER IS       0668
*                                     INDICATED                      */
*   2 JFCBEND  CHAR(0) BDY(WORD);                                  0668
*                                                                  0669
*        /* MACRO DECLARES USED BY THIS PROCEDURE                    */
*                                                                  0669
*        /************************************************************/
*        /*                                                          */
*        /* THE RETURN CODE IS INITIALIZED.  IF AN ERROR IS DETECTED */
*        /* IN THIS PROCEDURE AN ERROR CODE IS SET.  THIS RETURN     */
*        /* CODE IS RETURNED TO THE CALLING PROCEDURE.               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0669
*        DSDRC = 0;                                                0669
*                                                                  0669
         SLR   @08,@08                                             0669
         STH   @08,DSDRC                                           0669
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IF AN ALTERNATE DDNAME LIST HAS BEEN PROVIDED      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0670
*        IF IODADD ^= NULLPTR                                      0670
*          THEN                                                    0670
         L     @03,@PC00001                                        0670
         L     @03,GDTIOH(,@03)                                    0670
         C     @08,IODADD(,@03)                                    0670
         BE    @RF00670                                            0670
*DSCKALT:    DO;                                                   0671
*                                                                  0671
DSCKALT  DS    0H                                                  0672
*              /******************************************************/
*              /*                                                    */
*              /* AN ALTERNATE DDNAME LIST HAS BEEN PROVIDED.        */
*              /* CALCULATE THE LENGTH OF THE LIST AND CHECK THE     */
*              /* LIST OF DEFINED DDNAMES THAT MAY HAVE ALTERNATES.  */
*              /*                                                    */
*              /******************************************************/
*                                                                  0672
*              DDN = DDLLEN/8;                                     0672
*                                                                  0672
         L     @08,@PC00001                                        0672
         L     @08,GDTIOH(,@08)                                    0672
         L     @08,IODADD(,@08)                                    0672
         SLR   @03,@03                                             0672
         ICM   @03,3,DDLLEN(@08)                                   0672
         SRL   @03,3                                               0672
         STH   @03,DDN                                             0672
*              DO CKDD = 1 TO DDN;                                 0673
*                                                                  0673
         LA    CKDD,1                                              0673
         B     @DE00673                                            0673
@DL00673 DS    0H                                                  0674
*                IF JFCDNAME = DEFDD (CKDD)                        0674
*                  THEN                                            0674
         L     @08,@PC00006                                        0674
         LR    @15,CKDD                                            0674
         SLA   @15,3                                               0674
         LA    @14,DEFDD-8(@15)                                    0674
         CLC   JFCDNAME(8,@08),0(@14)                              0674
         BNE   @RF00674                                            0674
*                    DO;                                           0675
*                                                                  0675
*                      /**********************************************/
*                      /*                                            */
*                      /* DDNAME MAY HAVE AN ALTERNATE.              */
*                      /* IF CORRESPONDING DDNAME IN USER SUPPLIED   */
*                      /* LIST IS NOT ZERO USE THE NEW DDNAME.       */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0676
*                      IF ALTDD (CKDD) ^= '0000000000000000'X      0676
*                        THEN                                      0676
         L     @14,@PC00001                                        0676
         L     @01,GDTIOH(,@14)                                    0676
         L     @14,IODADD(,@01)                                    0676
         ST    @15,@TF00001                                        0676
         ALR   @15,@14                                             0676
         AL    @15,@CF01498                                        0676
         CLC   ALTDD-2(8,@15),@CB01413                             0676
         BE    @RF00676                                            0676
*                          JFCDNAME = ALTDD (CKDD);                0677
*                                                                  0677
*                                                                  0677
         AL    @14,@TF00001                                        0677
         AL    @14,@CF01498                                        0677
         MVC   JFCDNAME(8,@08),ALTDD-2(@14)                        0677
*                    END;                                          0678
*                                                                  0678
@RF00676 DS    0H                                                  0679
*              END;                                                0679
*                                                                  0679
@RF00674 AL    CKDD,@CF00161                                       0679
@DE00673 CH    CKDD,DDN                                            0679
         BNH   @DL00673                                            0679
*            END DSCKALT;                                          0680
*                                                                  0680
*        /************************************************************/
*        /*                                                          */
*        /* GET DEVTYPE INFORMATION.  IF THE MACRO IS NOT            */
*        /* SUCCESSFUL NO DD CARD WAS PRESENT.  SET ERROR CODES      */
*        /* AND RETURN TO CALLING PROC IF NO DD CARD PRESENT.        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0681
*        REG6 = ADDR (JFCDNAME);                                   0681
@RF00670 L     REG6,@PC00006                                       0681
*        REG7 = ADDR (DEVAREA);                                    0682
         LA    REG7,DEVAREA                                        0682
*LDEVT1: GEN(DEVTYPE (REG6),(REG7));                               0683
LDEVT1   DEVTYPE (REG6),(REG7)
*        RESPECIFY RTNREG RSTD;                                    0684
*        TESTRC = RTNREG;                                          0685
         STH   RTNREG,TESTRC                                       0685
*        RESPECIFY RTNREG UNRSTD;                                  0686
*                                                                  0686
*        IF TESTRC ^= 0                                            0687
*          THEN                                                    0687
         LH    @08,TESTRC                                          0687
         LTR   @08,@08                                             0687
         BZ    @RF00687                                            0687
*            DO;                                                   0688
*                                                                  0688
*              DSDRC = 4;                                          0689
         MVC   DSDRC(2),@CH00040                                   0689
*              DARGSENT = NODDSTID;                                0690
         L     @08,DDSTRU                                          0690
         MVI   DARGSENT(@08),X'05'                                 0690
*              DSNAME (1:8) = JFCDNAME (1:8);                      0691
*                                                                  0691
         L     @08,IOCSPTR                                         0691
         L     @08,IOCDSN(,@08)                                    0691
         L     @03,@PC00006                                        0691
         MVC   DSNAME(8,@08),JFCDNAME(@03)                         0691
*            END;                                                  0692
*                                                                  0692
*          ELSE                                                    0693
*                                                                  0693
*            /********************************************************/
*            /*                                                      */
*            /* DD CARD DEFINING THE DATA SET TO OPEN FOUND          */
*            /*                                                      */
*            /********************************************************/
*                                                                  0693
*RDJOK:      DO;                                                   0693
*                                                                  0693
         B     @RC00687                                            0693
@RF00687 DS    0H                                                  0693
RDJOK    DS    0H                                                  0694
*              /******************************************************/
*              /*                                                    */
*              /* IF DATA SET RESIDES ON DIRECT ACCESS DEVICE SET    */
*              /* THE DIRECT ACCESS FLAG IN THE IOCS.                */
*              /*                                                    */
*              /******************************************************/
*                                                                  0694
*              IF DEVTDA = ON                                      0694
*                THEN                                              0694
         TM    DEVTDA,B'00100000'                                  0694
         BNO   @RF00694                                            0694
*                  IOCDEVDA = ON;                                  0695
*                                                                  0695
         L     @08,IOCSPTR                                         0695
         L     @08,IOCEXT(,@08)                                    0695
         OI    IOCDEVDA(@08),B'10000000'                           0695
*              IF DEVTUR = ON                                      0696
*                THEN                                              0696
@RF00694 TM    DEVTUR,B'00001000'                                  0696
         BNO   @RF00696                                            0696
*                  IOCDEVUR = ON;                                  0697
*                                                                  0697
         L     @08,IOCSPTR                                         0697
         L     @08,IOCEXT(,@08)                                    0697
         OI    IOCDEVUR(@08),B'00100000'                           0697
*              /******************************************************/
*              /*                                                    */
*              /* READ THE JFCB AND SAVE THE VOLUME SERIAL NUMBER.   */
*              /* A QSAM DCB IS MOVED TO A GETMAIN AREA.  THE DDNAME */
*              /* OF THE JCL STATEMENT AND THE ADDRESS OF A          */
*              /* EXIT LIST ARE PLACED                               */
*              /* IN THE DCB.  THE ADDRESS OF THE DCB IS PLACED      */
*              /* IN THE EXIT LIST AND THE EXECUTE FORM OF THE       */
*              /* RDJFCB MACRO IS ISSUED.                            */
*              /*                                                    */
*              /******************************************************/
*                                                                  0698
*              DCBPTR = ADDR (READDCB);                            0698
@RF00696 LA    @08,WORKAREA                                        0698
         LA    @03,176                                             0698
         ALR   @03,@08                                             0698
         ST    @03,DCBPTR                                          0698
*              GENADDR = ADDR (QSAMDCB);                           0699
         LA    @15,QSAMDCB                                         0699
         ST    @15,GENADDR                                         0699
*              READDCB (1:SIZEQSAM) = GENAREA (1:SIZEQSAM);        0700
         MVC   READDCB(96,@03),GENAREA(@15)                        0700
*              DCBEXLSA = ADDR (DCBRLIST);                         0701
         LA    @15,DCBRLIST                                        0701
         STCM  @15,7,DCBEXLSA+28(@03)                              0701
*              DCBDDNAM (1:8) = JFCDNAME (1:8);                    0702
         L     @15,@PC00006                                        0702
         MVC   DCBDDNAM+40(8,@03),JFCDNAME(@15)                    0702
*              DCBRLPTR = ADDR (WORKAREA);                         0703
         STCM  @08,7,DCBRLPTR                                      0703
*              DCBRLID = '87'X;                                    0704
         MVI   DCBRLID,X'87'                                       0704
*              DCBEXWRD = ADDR (READDCB);                          0705
         ST    @03,DCBEXWRD                                        0705
*              DCBEXEND = ON;                                      0706
*                                                                  0706
         OI    DCBEXEND,B'10000000'                                0706
*LRDJF1:       GEN(RDJFCB  MF=(E,DCBEXWRD));                       0707
*                                                                  0707
LRDJF1   RDJFCB  MF=(E,DCBEXWRD)
*              JFCBPTR = ADDR (WORKAREA);                          0708
*                                                                  0708
         LA    JFCBPTR,WORKAREA                                    0708
*              /******************************************************/
*              /*                                                    */
*              /* IF OPEN IS TO BE DONE WITH A MODIFIED              */
*              /* JFCB, MOVE THE DSNAME AND VOLSERS FROM             */
*              /* THE OPNAGL TO THE JFCB. SET FLAG TO                */
*              /* INHIBIT WRITING THE JFCB BACK.                     */
*              /*                                                    */
*              /******************************************************/
*                                                                  0709
*              IF OPNOPTJM = ON                                    0709
*                THEN                                              0709
         TM    OPNOPTJM(OPNPTR),B'00000100'                        0709
         BNO   @RF00709                                            0709
*                  DO;                                             0710
*                        JFCBDSNM = MODJNM;                        0711
         L     @08,OPNDSN(,OPNPTR)                                 0711
         MVC   JFCBDSNM(44,JFCBPTR),MODJNM(@08)                    0711
*                        JFCBNVOL = MODJCNT;                       0712
         L     @08,OPNVOL(,OPNPTR)                                 0712
         SLR   @15,@15                                             0712
         IC    @15,MODJCNT(,@08)                                   0712
         STC   @15,JFCBNVOL(,JFCBPTR)                              0712
*                        JFCBVOLS(1:MODJCNT*VLSRL) =               0713
*                          MODJSERS(1:MODJCNT*VLSRL);              0713
         MH    @15,@CH00115                                        0713
         BCTR  @15,0                                               0713
         EX    @15,@SM01499                                        0713
*                        JFCBTSDM = JFINHWB;                       0714
         MVC   JFCBTSDM(1,JFCBPTR),JFINHWB                         0714
*                  END;                                            0715
*                                                                  0715
*              /******************************************************/
*              /*                                                    */
*              /* SAVE THE DATA SET NAME IN THE IOCSTR.              */
*              /*                                                    */
*              /******************************************************/
*                                                                  0716
*              DSNAME = JFCBDSNM;                                  0716
*                                                                  0716
@RF00709 L     @08,IOCSPTR                                         0716
         L     @01,IOCDSN(,@08)                                    0716
         MVC   DSNAME(44,@01),JFCBDSNM(JFCBPTR)                    0716
*              IF JFCSDS = ON                                      0717
*                THEN                                              0717
*                                                                  0717
         TM    JFCSDS(JFCBPTR),B'00100000'                         0717
         BNO   @RF00717                                            0717
*                  /**************************************************/
*                  /*                                                */
*                  /* SET IOCSTR VALUES FOR DD  / SYSOUT = A DATA SET*/
*                  /*                                                */
*                  /**************************************************/
*                                                                  0718
*                  DO;                                             0718
*                    IOCDSOPS = ON;                                0719
         OI    IOCDSOPS(@08),B'10000000'                           0719
*                    IOCFLGIO = ON;                                0720
         L     @08,IOCEXT(,@08)                                    0720
         OI    IOCFLGIO(@08),B'00010000'                           0720
*                  END;                                            0721
*                                                                  0721
*            END RDJOK;                                            0722
*                                                                  0722
@RF00717 DS    0H                                                  0723
*        IF GDTDBG = NULLPTR                                       0723
*          THEN;                                                   0723
@RC00687 L     @08,@PC00001                                        0723
         L     @08,GDTDBG(,@08)                                    0723
         LTR   @08,@08                                             0723
         BZ    @RT00723                                            0723
*          ELSE                                                    0725
*            CALL ICKDB010 (GDTTBL,'IODS');                        0725
*                                                                  0725
         L     @08,@PC00001                                        0725
         ST    @08,@AL00001                                        0725
         LA    @03,@CC01422                                        0725
         ST    @03,@AL00001+4                                      0725
         MVI   @AL00001+4,X'80'                                    0725
         L     @15,GDTDBG(,@08)                                    0725
         LA    @01,@AL00001                                        0725
         BALR  @14,@15                                             0725
*        RETURN CODE (DSDRC);                                      0726
*                                                                  0726
@RT00723 LH    @15,DSDRC                                           0726
         L     @13,4(,@13)                                         0726
         L     @14,12(,@13)                                        0726
         LM    @00,@12,20(@13)                                     0726
         BR    @14                                                 0726
*        END DSDATA;                                               0727
*                                                                  0727
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - BUILDDBK                                        */
*/*                                                                  */
*/* FUNCTION - THIS PROCEDURE WILL BUILD A DCB FOR A  DATA           */
*/*            SET AND PLACE ITS ADDRESS IN THE ARGUMENT LIST        */
*/*            SUPPLIED TO THE OPEN SVC.  QSAM OR BSAM               */
*/*            DCBS MAY BE BUILT USING THIS PROC.                    */
*/*                                                                  */
*/* INPUT -    THE IOCS POINTED TO BY IOCSPTR CONTAINS THE           */
*/*            INFORMATION REQUIRED TO BUILD THE DCB.                */
*/*                                                                  */
*/* OUTPUT -   A DCB IS BUILT AND ITS ADDRESS IS PLACED IN THE OPEN  */
*/*            ARGUMENT LIST.                                        */
*/*                                                                  */
*/* ERRORS -   IF NOT ENOUGH STORAGE IS AVAILABLE FOR THE DCB        */
*/*            AN ERROR CONDITION IS SET.                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0728
*BUILDDBK: PROC (RETDCBAD,DDDNAME) OPTIONS (SAVEAREA);             0728
*                                                                  0728
BUILDDBK STM   @14,@12,12(@13)                                     0728
         ST    @13,@SA00007+4                                      0728
         LA    @14,@SA00007                                        0728
         ST    @14,8(,@13)                                         0728
         LR    @13,@14                                             0728
         MVC   @PC00007(8),0(@01)                                  0728
*        /* RETURN CODE FROM THIS PROCEDURE                          */
*        DCL BLDDRC FIXED (15);                                    0729
*                                                                  0729
*        /* DDNAME OF THE DATA SET TO BE OPENED                      */
*        DCL DDDNAME CHAR (8);                                     0730
*                                                                  0730
*        /* AREA TO RETURN DCB ADDRESS AND OPEN OPTIONS              */
*        DCL 1 RETDCBAD PTR (31),                                  0731
*              2 OPOPTION CHAR (1);    /* OPEN OPTIONS               */
*                                                                  0731
*        /* OPEN TYPE J AREA FOR EXIT LIST AND JFCB                  */
*        DCL 1 TYPJWA BASED (TYPJPTR) BDY(WORD),                   0732
*              2 TYPJEXLN,                                         0732
*                3 TYPJEX CHAR(1),                                 0732
*                3 TYPJEPT PTR (24),                               0732
*              2 TYPJEXLO CHAR (8),                                0732
*              2 TYPJFCB CHAR (176);                               0732
*                                                                  0732
*        /* JFCB EXIT LIST ENTRY INDICATOR                           */
*        DCL TYPJEXON FIXED(8) INIT ('07'X);                       0733
*                                                                  0733
*        /* OPEN TYPE J AREA SIZE                                    */
*        DCL TYPJWASZ FIXED(31) CONSTANT(196);                     0734
*                                                                  0734
*        /* UPDATE DECB LENGTH                                       */
*        DCL DECBL FIXED(31) CONSTANT(24);                         0735
*                                                                  0735
*        /* LRECL=X RECORD SIZE                                      */
*        DCL SZ32K FIXED(31) CONSTANT(32768);                      0736
*                                                                  0736
*        /* MACRO VARIABLES USED BY THIS PROCEDURE                   */
*                                                                  0737
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE RETURN CODE SET BY THIS PROCEDURE.            */
*        /* IF AN ERROR IS DETECTED BY THIS PROCEDURE THE RCDATA     */
*        /* STRUCTURE IS INITIALIZE AND AN ERROR RETURN CODE IS SET. */
*        /*                                                          */
*        /************************************************************/
*                                                                  0737
*        BLDDRC = 0;                                               0737
*                                                                  0737
         SLR   BLDDRC,BLDDRC                                       0737
*        /************************************************************/
*        /*                                                          */
*        /* SET THE LENGTH AND THE ADDRESS OF THE DCB TO BE CREATED. */
*        /* BSAM OR QSAM DCBS MAY BE BUILT.                          */
*        /*                                                          */
*        /************************************************************/
*        RESPECIFY (REG5) RSTD;                                    0738
*                                                                  0738
*          IOCDSOPS = ON;                                          0739
*                                                                  0739
*                                                                  0739
         L     @08,IOCSPTR                                         0739
         OI    IOCDSOPS(@08),B'10000000'                           0739
*          /**********************************************************/
*          /*                                                        */
*          /* SET DCB SIZE AND DCB POINTER. MAY BE BSAM OR QSAM.     */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0740
*          IF OPNOPTBK = ON                                        0740
*            THEN                                                  0740
         TM    OPNOPTBK(OPNPTR),B'00010000'                        0740
         BNO   @RF00740                                            0740
*              DO;                                                 0741
*                POOLSIZE = SIZEBSAM;                              0742
         MVC   POOLSIZE(4),@CF00955                                0742
*                GENADDR = ADDR(BSAMDCB);                          0743
         LA    @04,BSAMDCB                                         0743
         ST    @04,GENADDR                                         0743
*                IOCMACBK = ON;                                    0744
         OI    IOCMACBK(@08),B'00010000'                           0744
*              END;                                                0745
*                                                                  0745
*            ELSE                                                  0746
*              DO;                                                 0746
         B     @RC00740                                            0746
@RF00740 DS    0H                                                  0747
*                POOLSIZE = SIZEQSAM;                              0747
         MVC   POOLSIZE(4),@CF00953                                0747
*                GENADDR = ADDR(QSAMDCB);                          0748
         LA    @08,QSAMDCB                                         0748
         ST    @08,GENADDR                                         0748
*              END;                                                0749
*                                                                  0749
*        RESPECIFY (REG5) UNRSTD;                                  0750
*                                                                  0750
@RC00740 DS    0H                                                  0751
*        /************************************************************/
*        /*                                                          */
*        /* IF OPEN TYPE J IS REQUIRED, GET SPACE                    */
*        /* FOR A COPY OF THE EXIT LIST AND JFCB. IF                 */
*        /* NOT ENOUGH SPACE IS AVAILABLE, SET ERROR                 */
*        /* CONDITION AND RETURN TO CALLING PROCEDURE                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0751
*        IF OPNOPTJM = ON                                          0751
*          THEN                                                    0751
         TM    OPNOPTJM(OPNPTR),B'00000100'                        0751
         BNO   @RF00751                                            0751
*            DO;                                                   0752
*                                                                  0752
*              CALL ICKSAGP0  (GDTTBL,TYPJWASZ,TYPJPTR,IOCSID);    0753
*                                                                  0753
         L     @08,@PC00001                                        0753
         ST    @08,@AL00001                                        0753
         LA    @15,@CF01441                                        0753
         ST    @15,@AL00001+4                                      0753
         LA    @15,TYPJPTR                                         0753
         ST    @15,@AL00001+8                                      0753
         L     @01,IOCSPTR                                         0753
         L     @01,IOCEXT(,@01)                                    0753
         LA    @15,IOCSID(,@01)                                    0753
         ST    @15,@AL00001+12                                     0753
         MVI   @AL00001+12,X'80'                                   0753
         L     @15,GDTGPL(,@08)                                    0753
         LA    @01,@AL00001                                        0753
         BALR  @14,@15                                             0753
*              RESPECIFY RTNREG RSTD;                              0754
*              TESTRC = RTNREG;                                    0755
         STH   RTNREG,TESTRC                                       0755
*              RESPECIFY RTNREG UNRSTD;                            0756
*                                                                  0756
*              IF TESTRC = 4                                       0757
*                THEN                                              0757
         LH    @08,TESTRC                                          0757
         LA    @15,4                                               0757
         CR    @08,@15                                             0757
         BNE   @RF00757                                            0757
*                  DO;                                             0758
*                    DARGSMOD = 'UV0';                             0759
         L     @08,DDSTRU                                          0759
         MVC   DARGSMOD(3,@08),@CC01006                            0759
*                    BLDDRC = 4;                                   0760
         LR    BLDDRC,@15                                          0760
*                    DARGSENT = NOCRSTID;                          0761
         MVI   DARGSENT(@08),X'04'                                 0761
*                    RETURN CODE(BLDDRC);                          0762
         LR    @15,BLDDRC                                          0762
         L     @13,4(,@13)                                         0762
         L     @14,12(,@13)                                        0762
         LM    @00,@12,20(@13)                                     0762
         BR    @14                                                 0762
*                  END;                                            0763
*                                                                  0763
*              /******************************************************/
*              /*                                                    */
*              /* COPY MODIFIED JFCB AND EXIT LIST TO                */
*              /* THE WORKAREA TO BE POINTED TO BY THE               */
*              /* DCB EXIT LIST ADDRESS                              */
*              /*                                                    */
*              /******************************************************/
*                                                                  0764
*              TYPJEX = TYPJEXON;                                  0764
@RF00757 L     @08,TYPJPTR                                         0764
         IC    @15,TYPJEXON                                        0764
         STC   @15,TYPJEX(,@08)                                    0764
*              TYPJEPT = ADDR(TYPJFCB);                            0765
         LA    @15,TYPJFCB(,@08)                                   0765
         STCM  @15,7,TYPJEPT(@08)                                  0765
*              TYPJEXLO = DCBTLIST;                                0766
         MVC   TYPJEXLO(8,@08),DCBTLIST                            0766
*              TYPJFCB = WORKAREA(1:LENGTH(TYPJFCB));              0767
*                                                                  0767
         MVC   TYPJFCB(176,@08),WORKAREA                           0767
*            END;                                                  0768
*                                                                  0768
*        /************************************************************/
*        /*                                                          */
*        /* GET STORAGE FOR THE DCB.  IF NOT ENOUGH STORAGE IS       */
*        /* IS AVAILABLE, SET ERROR CONDITION AND RETURN TO CALLER.  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0769
*        CALL ICKSAGP0 (GDTTBL,POOLSIZE,DCBPTR,IOCSID);            0769
@RF00751 L     @08,@PC00001                                        0769
         ST    @08,@AL00001                                        0769
         LA    @15,POOLSIZE                                        0769
         ST    @15,@AL00001+4                                      0769
         LA    @15,DCBPTR                                          0769
         ST    @15,@AL00001+8                                      0769
         L     @01,IOCSPTR                                         0769
         L     @01,IOCEXT(,@01)                                    0769
         LA    @15,IOCSID(,@01)                                    0769
         ST    @15,@AL00001+12                                     0769
         MVI   @AL00001+12,X'80'                                   0769
         L     @15,GDTGPL(,@08)                                    0769
         LA    @01,@AL00001                                        0769
         BALR  @14,@15                                             0769
*        RESPECIFY RTNREG RSTD;                                    0770
*        TESTRC = RTNREG;                                          0771
         STH   RTNREG,TESTRC                                       0771
*        RESPECIFY RTNREG UNRSTD;                                  0772
*                                                                  0772
*        IF TESTRC = 4                                             0773
*          THEN                                                    0773
         LH    @08,TESTRC                                          0773
         LA    @15,4                                               0773
         CR    @08,@15                                             0773
         BNE   @RF00773                                            0773
*            DO;                                                   0774
*              DARGSMOD = 'UV0';                                   0775
         L     @08,DDSTRU                                          0775
         MVC   DARGSMOD(3,@08),@CC01006                            0775
*              BLDDRC = 4;                                         0776
         LR    BLDDRC,@15                                          0776
*              DARGSENT = NOCRSTID;                                0777
         MVI   DARGSENT(@08),X'04'                                 0777
*            END;                                                  0778
*                                                                  0778
*          /**********************************************************/
*          /*                                                        */
*          /* STORAGE FOR THE DCB HAS BEEN OBTAINED.  MOVE THE       */
*          /* DEFINED DCB TO THE OBTAINED STORAGE.                   */
*          /* UPDATE THE NUMBER OF CONTROL BLOCKS BUILT AND          */
*          /* SET DCB ADDRESS IN OPEN LIST.                          */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0779
*          ELSE                                                    0779
*SETDCB:                                                           0779
*            DO;                                                   0779
*                                                                  0779
         B     @RC00773                                            0779
@RF00773 DS    0H                                                  0779
SETDCB   DS    0H                                                  0780
*              IOCCBA = DCBPTR;                                    0780
         L     @08,IOCSPTR                                         0780
         L     @15,IOCEXT(,@08)                                    0780
         L     @14,DCBPTR                                          0780
         ST    @14,IOCCBA(,@15)                                    0780
*              RETDCBAD = IOCCBA;                                  0781
*                                                                  0781
         L     @07,@PC00007                                        0781
         ST    @14,RETDCBAD(,@07)                                  0781
*              IOCCBL = POOLSIZE;                                  0782
*                                                                  0782
         L     @07,POOLSIZE                                        0782
         STH   @07,IOCCBL(,@15)                                    0782
*              /******************************************************/
*              /*                                                    */
*              /* SET DCB ADDR IN IOCSTR IF REQUESTED.               */
*              /*                                                    */
*              /******************************************************/
*                                                                  0783
*              IF OPNMODRC = ON                                    0783
*                THEN                                              0783
         TM    OPNMODRC(OPNPTR),B'01000000'                        0783
         BNO   @RF00783                                            0783
*                  IOCCBP = IOCCBA;                                0784
*                                                                  0784
         ST    @14,IOCCBP(,@08)                                    0784
*              IHADCB (1:POOLSIZE) = GENAREA (1:POOLSIZE);         0785
*                                                                  0785
@RF00783 L     @08,DCBPTR                                          0785
         L     @15,POOLSIZE                                        0785
         BCTR  @15,0                                               0785
         L     @01,GENADDR                                         0785
         EX    @15,@SM01502                                        0785
*              DCBDDNAM (1:8) = DDDNAME (1:8);                     0786
*                                                                  0786
         L     @15,@PC00007+4                                      0786
         MVC   DCBDDNAM+40(8,@08),DDDNAME(@15)                     0786
*              /******************************************************/
*              /*                                                    */
*              /* EXIT LIST ADDRESS.                                 */
*              /*                                                    */
*              /******************************************************/
*                                                                  0787
*              IF OPNOPTJM = ON                                    0787
*                THEN                                              0787
         TM    OPNOPTJM(OPNPTR),B'00000100'                        0787
         BNO   @RF00787                                            0787
*                 DCBEXLSA = TYPJPTR;                              0788
         MVC   DCBEXLSA+28(3,@08),TYPJPTR+1                        0788
*                ELSE                                              0789
*                 DCBEXLSA = ADDR (DCBTLIST);                      0789
*                                                                  0789
         B     @RC00787                                            0789
@RF00787 LA    @08,DCBTLIST                                        0789
         L     @01,DCBPTR                                          0789
         STCM  @08,7,DCBEXLSA+28(@01)                              0789
*              /******************************************************/
*              /*                                                    */
*              /* THE MACRF FLAGS ARE SET ACCORDING TO               */
*              /* THE USAGE INDICATED AS FOLLOWS:                    */
*              /*  QSAM OUTPUT - PUT/LOCATE                          */
*              /*  BSAM OUTPUT - READ/POINT                          */
*              /*                                                    */
*              /******************************************************/
*                                                                  0790
*              IF IOCMACOT = ON                                    0790
*                THEN                                              0790
@RC00787 L     @08,IOCSPTR                                         0790
         TM    IOCMACOT(@08),B'01000000'                           0790
         BNO   @RF00790                                            0790
*                  DO;                                             0791
*                                                                  0791
*                    IF OPNMODAC = ON                              0792
*                      THEN                                        0792
         TM    OPNMODAC(OPNPTR),B'10000000'                        0792
         BNO   @RF00792                                            0792
*                        IOCINFAC = ON;                            0793
*                                                                  0793
         L     @08,IOCEXT(,@08)                                    0793
         OI    IOCINFAC(@08),B'00001000'                           0793
*                    DCBSYN = IODOSOS;                             0794
*                                                                  0794
@RF00792 L     @08,DCBPTR                                          0794
         L     @15,@PC00001                                        0794
         L     @01,GDTIOH(,@15)                                    0794
         MVC   DCBSYN+52(3,@08),IODOSOS(@01)                       0794
*                    IF IOCMACBK = ON                              0795
*                      THEN                                        0795
         L     @01,IOCSPTR                                         0795
         TM    IOCMACBK(@01),B'00010000'                           0795
         BNO   @RF00795                                            0795
*                        DO;                                       0796
*                          OPOPTION = '0F'X;                       0797
         L     @15,@PC00007                                        0797
         MVI   OPOPTION(@15),X'0F'                                 0797
*                          DCBMRRD = OFF;                          0798
         AL    @08,@CF00669                                        0798
         NI    DCBMRRD(@08),B'11011111'                            0798
*                          DCBMRWRT = ON;                          0799
         OI    DCBMRWRT(@08),B'00100000'                           0799
*                          DCBMRPT1 = OFF;                         0800
         NI    DCBMRPT1(@08),B'11111011'                           0800
*                          DCBMRPT2 = ON;                          0801
         OI    DCBMRPT2(@08),B'00000100'                           0801
*                        END;                                      0802
*                      ELSE                                        0803
*                        DO;                                       0803
         B     @RC00795                                            0803
@RF00795 DS    0H                                                  0804
*                          OPOPTION = '0F'X;                       0804
         L     @08,@PC00007                                        0804
         MVI   OPOPTION(@08),X'0F'                                 0804
*                          DCBMRGET = OFF;                         0805
         LA    @08,40                                              0805
         AL    @08,DCBPTR                                          0805
         NI    DCBMRGET(@08),B'10111111'                           0805
*                          DCBMRPUT = ON;                          0806
         OI    DCBMRPUT(@08),B'01000000'                           0806
*                          DCBMRLCG = OFF;                         0807
         NI    DCBMRLCG(@08),B'11110111'                           0807
*                          DCBMRLCP = ON;                          0808
         OI    DCBMRLCP(@08),B'00001000'                           0808
*                        END;                                      0809
*                  END;                                            0810
*                                                                  0810
*                /****************************************************/
*                /*                                                  */
*                /* DATA SET USED FOR INPUT SET EODAD ADDRESS.       */
*                /* SET INPUT SYNAD ROUTINE ADDRESS IN DCB.          */
*                /*                                                  */
*                /****************************************************/
*                                                                  0811
*                ELSE                                              0811
*                  DO;                                             0811
         B     @RC00790                                            0811
@RF00790 DS    0H                                                  0812
*                    DCBEODA = IODEOD;                             0812
         L     @08,DCBPTR                                          0812
         L     @15,@PC00001                                        0812
         L     @15,GDTIOH(,@15)                                    0812
         MVC   DCBEODA+28(3,@08),IODEOD+1(@15)                     0812
*                    DCBSYN = IODOSSS;                             0813
         MVC   DCBSYN+52(3,@08),IODOSSS(@15)                       0813
*                  END;                                            0814
*                                                                  0814
*              /******************************************************/
*              /*                                                    */
*              /* SET DCB ERROPT FIELD.  -SKIP- FOR INPUT,           */
*              /* AND -ABEND- FOR ALL OTHERS.                        */
*              /*                                                    */
*              /******************************************************/
*                                                                  0815
*              IF IOCMACIN = ON                                    0815
*                THEN                                              0815
@RC00790 L     @08,IOCSPTR                                         0815
         TM    IOCMACIN(@08),B'10000000'                           0815
         BNO   @RF00815                                            0815
*                  DO;                                             0816
*                    DCBERABE = OFF;                               0817
*                    DCBERSKP = ON;                                0818
         L     @08,DCBPTR                                          0818
         OI    DCBERSKP+72(@08),B'01000000'                        0818
         NI    DCBERABE+72(@08),B'11011111'                        0818
*                  END;                                            0819
*                ELSE                                              0820
*                  DCBERABE = ON;                                  0820
*                                                                  0820
         B     @RC00815                                            0820
@RF00815 L     @08,DCBPTR                                          0820
         OI    DCBERABE+72(@08),B'00100000'                        0820
*              /******************************************************/
*              /*                                                    */
*              /* SET VALUES SET IN THE OPNAGL IN ANY DCB            */
*              /*                                                    */
*              /******************************************************/
*                                                                  0821
*              /*   SAVE BLOCKSIZE FOR DEFAULT IN                    */
*              /*   OPEN EXIT - WILL ONLY BE USED                    */
*              /*   IF DCBBLKSI NOT PROVIDED BY                      */
*              /*   OTHER MEANS                                      */
*              IOCDLN = OPNBLK;                                    0821
*                                                                  0821
@RC00815 L     @08,OPNBLK(,OPNPTR)                                 0821
         L     @01,IOCSPTR                                         0821
         ST    @08,IOCDLN(,@01)                                    0821
*              IF OPNREC > SZ32K                                   0822
*                THEN                                              0822
         L     @08,OPNREC(,OPNPTR)                                 0822
         C     @08,@CF01444                                        0822
         BNH   @RF00822                                            0822
*                   /*************************************************/
*                   /*                                               */
*                   /* RECORD SIZE IS GREATER THAN                   */
*                   /* MAXIMUM ALLOWED. SET LRECL=X                  */
*                   /*                                               */
*                   /*************************************************/
*                   LRECLX = ON;                                   0823
         L     @08,DCBPTR                                          0823
         OI    LRECLX+72(@08),B'10000000'                          0823
*                ELSE                                              0824
*                  DO;                                             0824
*                                                                  0824
         B     @RC00822                                            0824
@RF00822 DS    0H                                                  0825
*                    /*   SET LRECL - WILL BE ZERO                   */
*                    /*   IF NONE SPECIFIED BY CALLER.               */
*                    DCBLRECL = OPNREC;                            0825
         L     @08,OPNREC(,OPNPTR)                                 0825
         L     @01,DCBPTR                                          0825
         STH   @08,DCBLRECL+72(,@01)                               0825
*                  END;                                            0826
*                                                                  0826
*              /* SET FIXED LENGTH RECFM IN DCB IF REQUESTED         */
*              IF OPNRFMFX = ON                                    0827
*                THEN                                              0827
@RC00822 TM    OPNRFMFX(OPNPTR),B'10000000'                        0827
         BNO   @RF00827                                            0827
*                  DCBRECL = '10'B;                                0828
*                                                                  0828
         L     @08,DCBPTR                                          0828
         NI    DCBRECL+28(@08),B'10111111'                         0828
         OI    DCBRECL+28(@08),B'10000000'                         0828
*              /* SET VAR RECFM IN DCB IF REQUESTED.                 */
*              IF OPNRFMVR = ON                                    0829
*                THEN                                              0829
@RF00827 TM    OPNRFMVR(OPNPTR),B'01000000'                        0829
         BNO   @RF00829                                            0829
*                  DCBRECL = '01'B;                                0830
*                                                                  0830
         L     @08,DCBPTR                                          0830
         NI    DCBRECL+28(@08),B'01111111'                         0830
         OI    DCBRECL+28(@08),B'01000000'                         0830
*              /* SET UND RECFM IN DCB IF REQUESTED.                 */
*              IF OPNRFMUN = ON                                    0831
*                THEN                                              0831
@RF00829 TM    OPNRFMUN(OPNPTR),B'00100000'                        0831
         BNO   @RF00831                                            0831
*                  DCBRECL = '11'B;                                0832
*                                                                  0832
         L     @08,DCBPTR                                          0832
         OI    DCBRECL+28(@08),B'11000000'                         0832
*              /* SET VBS RECFM IN DCB IF REQUESTED.                 */
*              IF OPNRFMSF = ON                                    0833
*                THEN                                              0833
@RF00831 TM    OPNRFMSF(OPNPTR),B'00010000'                        0833
         BNO   @RF00833                                            0833
*                  DO;                                             0834
*                    DCBRECL = '01'B;                              0835
         LA    @08,28                                              0835
         AL    @08,DCBPTR                                          0835
         NI    DCBRECL(@08),B'01111111'                            0835
         OI    DCBRECL(@08),B'01000000'                            0835
*                    DCBRECSB = ON;                                0836
         OI    DCBRECSB(@08),B'00001000'                           0836
*                  END;                                            0837
*                                                                  0837
*              /* SET BLOCKED RECFM IN DCB IF REQUESTED.             */
*              IF OPNRFMBK = ON                                    0838
*                THEN                                              0838
@RF00833 TM    OPNRFMBK(OPNPTR),B'00001000'                        0838
         BNO   @RF00838                                            0838
*                  DCBRECBR = ON;                                  0839
*                                                                  0839
         L     @08,DCBPTR                                          0839
         OI    DCBRECBR+28(@08),B'00010000'                        0839
*            END SETDCB;                                           0840
*                                                                  0840
@RF00838 DS    0H                                                  0841
*        RETURN CODE (BLDDRC);                                     0841
*                                                                  0841
@RC00773 LR    @15,BLDDRC                                          0841
         L     @13,4(,@13)                                         0841
         L     @14,12(,@13)                                        0841
         LM    @00,@12,20(@13)                                     0841
         BR    @14                                                 0841
*        END BUILDDBK;                                             0842
*                                                                  0842
*                                                                  0842
@PB00007 DS    0H                                                  0843
*/********************************************************************/
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS CALLED BY OPEN OR CLOSE IF AN         */
*/*            ABEND OCCURS DURING THE SVC.                          */
*/*                                                                  */
*/* INPUT -    ABEND ARGUMENT LIST IS ADDRESSED BY REG 1.            */
*/*                                                                  */
*/* OUTPUT -   IGNORE RETURN CODE SET IN LIST AND ABEND EXIT FLAG SET*/
*/*            IN THE IOCS DEFINING THE DATA SET.                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0843
*ABEXRTN:                                                          0843
*                                                                  0843
*        SAVE14 = REG14;                                           0843
*                                                                  0843
ABEXRTN  LR    SAVE14,REG14                                        0843
*        ABEXPTR = REG1;                                           0844
         ST    REG1,ABEXPTR                                        0844
*        DCBPTR = ABDCBAD;                                         0845
         L     @08,ABEXPTR                                         0845
         L     @08,ABDCBAD(,@08)                                   0845
         ST    @08,DCBPTR                                          0845
*        DCB00 = '00'X;                                            0846
*                                                                  0846
         MVI   DCB00,X'00'                                         0846
*        DO EXITCTR = 1 TO 4;                                      0847
         LA    EXITCTR,1                                           0847
@DL00847 DS    0H                                                  0848
*          IOCSPTR = IOCSADDR (EXITCTR);                           0848
         LR    @08,EXITCTR                                         0848
         SLA   @08,2                                               0848
         L     @08,IOCSADDR-4(@08)                                 0848
         ST    @08,IOCSPTR                                         0848
*          IF IOCCBA = DCBPTR                                      0849
*            THEN                                                  0849
         L     @08,IOCEXT(,@08)                                    0849
         CLC   IOCCBA(4,@08),DCBPTR                                0849
         BNE   @RF00849                                            0849
*              DO;                                                 0850
*                IOCINFAE = ON;                                    0851
         OI    IOCINFAE(@08),B'01000000'                           0851
*                EXITCTR = 5;                                      0852
         LA    EXITCTR,5                                           0852
*              END;                                                0853
*        END;                                                      0854
*                                                                  0854
@RF00849 AL    EXITCTR,@CF00161                                    0854
         C     EXITCTR,@CF00040                                    0854
         BNH   @DL00847                                            0854
*        ABOPT = RCIGNORE;                                         0855
*                                                                  0855
         L     @08,ABEXPTR                                         0855
         MVI   ABOPT(@08),X'04'                                    0855
*        REG14 = SAVE14;                                           0856
         LR    REG14,SAVE14                                        0856
*        GEN(RETURN);                                              0857
*                                                                  0857
*                                                                  0857
         RETURN
*/********************************************************************/
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS CALLED BY THE OPEN SVC.               */
*/*            IT CHECKS TO INSURE THAT VALID SYSIN AND SYSOUT       */
*/*            DCB PARAMETERS HAVE BEEN SPECIFIED.                   */
*/*            THE VALUES SUPPLIED BY THE JCL OR VTOC ARE EXTRACTED  */
*/*            FROM THE DCB AND SAVED IN THE IOCSTR.                 */
*/*                                                                  */
*/* INPUT -    REG1 - ADDRESS OF DCB BEING OPENED.                   */
*/*                                                                  */
*/* OUTPUT -   IOCSTR IS UPDATED TO REFLECT INFORMATION EXTRACTED    */
*/*            FROM THE DCB.                                         */
*/*                                                                  */
*/*            DCB IS UPDATED IF INVALID BLOCKSIZES WERE SPECIFIED.  */
*/*                                                                  */
*/*            DCB IS UPDATED IF THE DATA SET RECORD FORMAT IS       */
*/*            VARIABLE SPANNED.  IF SPANNED INPUT THE FLAG IS SET   */
*/*            TO HAVE OPEN OBTAIN A HIDDEN BUFFER,                  */
*/*            UNLESS THE RECORD SIZE IS GREATER                     */
*/*            THAN 32767. FOR SPANNED                               */
*/*            OUTPUT THE MACRO FORM IS CHANGED TO DATA MODE         */
*/*            PROCESSING.                                           */
*/*                                                                  */
*/* ERRORS - NONE                                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0858
*IRTOPEX:                                                          0858
*                                                                  0858
*        SAVE14 = REG14;                                           0858
IRTOPEX  LR    SAVE14,REG14                                        0858
*        DCBPTR = REG1;                                            0859
         ST    REG1,DCBPTR                                         0859
*        DCB00 = '00'X;                                            0860
*                                                                  0860
         MVI   DCB00,X'00'                                         0860
*        /************************************************************/
*        /*                                                          */
*        /* SEARCH THE IOCSBLT LIST TO FIND THE ADDRESS OF THE       */
*        /* IOCS THAT MATCHES THE DCB BEING OPENED.                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0861
*        DO EXITCTR = 1 TO 4;                                      0861
*                                                                  0861
         LA    EXITCTR,1                                           0861
@DL00861 DS    0H                                                  0862
*          IOCSPTR = IOCSADDR (EXITCTR);                           0862
*                                                                  0862
         LR    @08,EXITCTR                                         0862
         SLA   @08,2                                               0862
         L     @08,IOCSADDR-4(@08)                                 0862
         ST    @08,IOCSPTR                                         0862
*          IF IOCCBA = DCBPTR                                      0863
*            THEN                                                  0863
         L     @08,IOCEXT(,@08)                                    0863
         CLC   IOCCBA(4,@08),DCBPTR                                0863
         BNE   @RF00863                                            0863
*              EXITCTR = 5;                                        0864
*                                                                  0864
         LA    EXITCTR,5                                           0864
*        END;                                                      0865
*                                                                  0865
@RF00863 AL    EXITCTR,@CF00161                                    0865
         C     EXITCTR,@CF00040                                    0865
         BNH   @DL00861                                            0865
*        IF DCBBLKSI = 0                                           0866
*          THEN                                                    0866
         SLR   @08,@08                                             0866
         LA    @02,52                                              0866
         AL    @02,DCBPTR                                          0866
         CH    @08,DCBBLKSI(,@02)                                  0866
         BNE   @RF00866                                            0866
*            /********************************************************/
*            /*                                                      */
*            /* DCBBLKSI HAS NOT BEEN MERGED FROM THE JCL OR         */
*            /* THE DATA SET LABEL - USE DEFAULT VALUE               */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   0867
*              DCBBLKSI = IOCDLN;                                  0868
         L     @15,IOCSPTR                                         0868
         L     @14,IOCDLN(,@15)                                    0868
         STH   @14,DCBBLKSI(,@02)                                  0868
*              IOCDLN = 0;                                         0869
         ST    @08,IOCDLN(,@15)                                    0869
*            END;                                                  0870
*                                                                  0870
*        IF IOCFLGIO = ON × IOCFLGSP = ON                          0871
*          THEN                                                    0871
*                                                                  0871
@RF00866 L     @08,IOCSPTR                                         0871
         L     @08,IOCEXT(,@08)                                    0871
         TM    IOCFLGIO(@08),B'00010010'                           0871
         BZ    @RF00871                                            0871
*            /********************************************************/
*            /*                                                      */
*            /* DATA SET IS DD * OR SYSOUT = A.  INSURE THAT         */
*            /* DATA SET WILL OPEN SUCCESSFULLY.                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0872
*CKIODCB:    DO;                                                   0872
*                                                                  0872
CKIODCB  DS    0H                                                  0873
*              /******************************************************/
*              /*                                                    */
*              /* SET RECORD FORMAT TO BLOCKED RECORDS               */
*              /*                                                    */
*              /******************************************************/
*                                                                  0873
*              DCBRECBR = ON;                                      0873
*                                                                  0873
         L     @08,DCBPTR                                          0873
         OI    DCBRECBR+28(@08),B'00010000'                        0873
*              IF IOCMACIN = ON                                    0874
*                THEN                                              0874
*                                                                  0874
         L     @08,IOCSPTR                                         0874
         TM    IOCMACIN(@08),B'10000000'                           0874
         BNO   @RF00874                                            0874
*                  /**************************************************/
*                  /*                                                */
*                  /* DD * HAS FIXED LENGTH RECORDS.  INSURE THAT    */
*                  /* BLOCKSIZE IS A MULTIPLE OF LRECL.              */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0875
*IOISIN:           DO;                                             0875
*                                                                  0875
IOISIN   DS    0H                                                  0876
*                    IOCRFMFX = ON;                                0876
*                                                                  0876
         L     @08,IOCSPTR                                         0876
         OI    IOCRFMFX(@08),B'10000000'                           0876
*                    IF DCBBLKSI = 0 × DCBBLKSI//DCBLRECL ^= 0     0877
*                      THEN                                        0877
         SLR   @08,@08                                             0877
         L     @02,DCBPTR                                          0877
         LH    @15,DCBBLKSI+52(,@02)                               0877
         CR    @15,@08                                             0877
         BE    @RT00877                                            0877
         LR    @00,@15                                             0877
         SRDA  @00,32                                              0877
         LH    @02,DCBLRECL+72(,@02)                               0877
         DR    @00,@02                                             0877
         CR    @00,@08                                             0877
         BE    @RF00877                                            0877
@RT00877 DS    0H                                                  0878
*                        DCBBLKSI = DCBLRECL;                      0878
*                                                                  0878
         L     @08,DCBPTR                                          0878
         LH    @02,DCBLRECL+72(,@08)                               0878
         STH   @02,DCBBLKSI+52(,@08)                               0878
*                  END IOISIN;                                     0879
*                                                                  0879
*                ELSE                                              0880
*                                                                  0880
*                  /**************************************************/
*                  /*                                                */
*                  /* DATA SET IS SYSOUT = A.  CHECK ATTRIBUTES.     */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0880
*IOISOUT:          DO;                                             0880
*                                                                  0880
*                                                                  0880
         B     @RC00874                                            0880
@RF00874 DS    0H                                                  0880
IOISOUT  DS    0H                                                  0881
*                    IF IOCDEVUR = ON                              0881
*                      THEN                                        0881
*                                                                  0881
         L     @08,IOCSPTR                                         0881
         L     @08,IOCEXT(,@08)                                    0881
         TM    IOCDEVUR(@08),B'00100000'                           0881
         BNO   @RF00881                                            0881
*                        /********************************************/
*                        /*                                          */
*                        /* SET ERROPT = ACCEPT FOR UNIT RECORD      */
*                        /*                                          */
*                        /********************************************/
*                                                                  0882
*                        DO;                                       0882
*                          DCBERABE = OFF;                         0883
*                          DCBERACC = ON;                          0884
         L     @08,DCBPTR                                          0884
         OI    DCBERACC+72(@08),B'10000000'                        0884
         NI    DCBERABE+72(@08),B'11011111'                        0884
*                        END;                                      0885
*                                                                  0885
*                    IF DCBRECL = '11'B                            0886
*                      THEN                                        0886
*                                                                  0886
@RF00881 L     @08,DCBPTR                                          0886
         TM    DCBRECL+28(@08),B'11000000'                         0886
         BNO   @RF00886                                            0886
*                        /********************************************/
*                        /*                                          */
*                        /* TURN OFF BLOCKED INDICATOR.  DEFAULT     */
*                        /* BLOCK SIZE FOR RECFM=U IS 121.           */
*                        /*                                          */
*                        /********************************************/
*                                                                  0887
*OUTISU:                 DO;                                       0887
*                                                                  0887
OUTISU   DS    0H                                                  0888
*                          DCBRECBR = OFF;                         0888
         L     @08,DCBPTR                                          0888
         NI    DCBRECBR+28(@08),B'11101111'                        0888
*                          IF DCBBLKSI < 121                       0889
*                            THEN                                  0889
         LA    @02,121                                             0889
         AL    @08,@CF00584                                        0889
         CH    @02,DCBBLKSI(,@08)                                  0889
         BNH   @RF00889                                            0889
*                              DCBBLKSI = 121;                     0890
*                                                                  0890
         STH   @02,DCBBLKSI(,@08)                                  0890
*                        END OUTISU;                               0891
*                                                                  0891
*                      /**********************************************/
*                      /*                                            */
*                      /* RECORD FORMAT OF DATA SET MUST BE V        */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0892
*                      ELSE                                        0892
*OUTISV:                 DO;                                       0892
*                                                                  0892
         B     @RC00886                                            0892
@RF00886 DS    0H                                                  0892
OUTISV   DS    0H                                                  0893
*                          IOCRFMVR = ON;                          0893
         L     @08,IOCSPTR                                         0893
         OI    IOCRFMVR(@08),B'01000000'                           0893
*                          DCBRECL = '01'B;                        0894
*                                                                  0894
         L     @08,DCBPTR                                          0894
         NI    DCBRECL+28(@08),B'01111111'                         0894
         OI    DCBRECL+28(@08),B'01000000'                         0894
*                          IF DCBLRECL < 125                       0895
*                            THEN                                  0895
         LA    @02,125                                             0895
         AL    @08,@CF00878                                        0895
         CH    @02,DCBLRECL(,@08)                                  0895
         BNH   @RF00895                                            0895
*                              DCBLRECL = 125;                     0896
*                                                                  0896
         STH   @02,DCBLRECL(,@08)                                  0896
*                          IF DCBBLKSI < DCBLRECL + 4              0897
*                            THEN                                  0897
@RF00895 L     @08,DCBPTR                                          0897
         LA    @02,52                                              0897
         ALR   @02,@08                                             0897
         LA    @15,4                                               0897
         AH    @15,DCBLRECL+72(,@08)                               0897
         CH    @15,DCBBLKSI(,@02)                                  0897
         BNH   @RF00897                                            0897
*                              DCBBLKSI = 629;                     0898
*                                                                  0898
         MVC   DCBBLKSI(2,@02),@CH01465                            0898
*                        END OUTISV;                               0899
*                                                                  0899
@RF00897 DS    0H                                                  0900
*                  END IOISOUT;                                    0900
*                                                                  0900
@RC00886 DS    0H                                                  0901
*            END CKIODCB;                                          0901
*                                                                  0901
@RC00874 DS    0H                                                  0902
*        /************************************************************/
*        /*                                                          */
*        /* IF BLOCK PROCESSING IS REQUESTED SET BLOCKED RECFM.      */
*        /* IF ASA CONTROL REQUESTED,  SET THIS RECFM IN DCB.        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0902
*        IF DCBRECBR = ON                                          0902
*          THEN                                                    0902
@RF00871 L     @08,DCBPTR                                          0902
         TM    DCBRECBR+28(@08),B'00010000'                        0902
         BNO   @RF00902                                            0902
*            IOCRFMBK = ON;                                        0903
*                                                                  0903
         L     @08,IOCSPTR                                         0903
         OI    IOCRFMBK(@08),B'00001000'                           0903
*        IF IOCINFAC = ON                                          0904
*          THEN                                                    0904
@RF00902 L     @08,IOCSPTR                                         0904
         L     @08,IOCEXT(,@08)                                    0904
         TM    IOCINFAC(@08),B'00001000'                           0904
         BNO   @RF00904                                            0904
*            DCBRECCC = '10'B;                                     0905
*                                                                  0905
         L     @08,DCBPTR                                          0905
         NI    DCBRECCC+28(@08),B'11111101'                        0905
         OI    DCBRECCC+28(@08),B'00000100'                        0905
*        /************************************************************/
*        /*                                                          */
*        /* IF THE RECORD FORMAT IS UNDEFINED THE UNDEFINED RECFM    */
*        /* FLAG ANS THE BLOCKSIZE ARE SET IN THE IOCS.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0906
*        IF DCBRECL = '11'B                                        0906
*          THEN                                                    0906
@RF00904 L     @08,DCBPTR                                          0906
         TM    DCBRECL+28(@08),B'11000000'                         0906
         BNO   @RF00906                                            0906
*            DO;                                                   0907
*                                                                  0907
*              IOCTRN = DCBBLKSI;                                  0908
         L     @02,IOCSPTR                                         0908
         LH    @08,DCBBLKSI+52(,@08)                               0908
         ST    @08,IOCTRN(,@02)                                    0908
*              IOCRFMUN = ON;                                      0909
*                                                                  0909
         OI    IOCRFMUN(@02),B'00100000'                           0909
*            END;                                                  0910
*                                                                  0910
*                                                                  0910
*        /************************************************************/
*        /*                                                          */
*        /* IF RECORD FORMAT IS FIXED SET FIXED RECFM AND            */
*        /* LRECL IN IOCS.                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0911
*        IF DCBRECL = '10'B                                        0911
*          THEN                                                    0911
@RF00906 L     @08,DCBPTR                                          0911
         TM    DCBRECL+28(@08),B'10000000'                         0911
         BNO   @RF00911                                            0911
         TM    DCBRECL+28(@08),B'01000000'                         0911
         BNZ   @RF00911                                            0911
*            DO;                                                   0912
*                                                                  0912
*              IF DCBLRECL = 0                                     0913
*                THEN                                              0913
         LA    @02,72                                              0913
         ALR   @02,@08                                             0913
         LH    @15,DCBLRECL(,@02)                                  0913
         LTR   @15,@15                                             0913
         BNZ   @RF00913                                            0913
*                  DCBLRECL = DCBBLKSI;                            0914
*                                                                  0914
         LH    @08,DCBBLKSI+52(,@08)                               0914
         STH   @08,DCBLRECL(,@02)                                  0914
*              IOCTRN = DCBLRECL;                                  0915
@RF00913 L     @08,IOCSPTR                                         0915
         L     @02,DCBPTR                                          0915
         LH    @02,DCBLRECL+72(,@02)                               0915
         ST    @02,IOCTRN(,@08)                                    0915
*              IOCRFMFX = ON;                                      0916
*                                                                  0916
         OI    IOCRFMFX(@08),B'10000000'                           0916
*            END;                                                  0917
*                                                                  0917
*        /************************************************************/
*        /*                                                          */
*        /* IF DATA SET RECFM IS VARIABLE SET VARIABLE FLAG IN IOCS. */
*        /* SET LENGTH OF DATA (LRECL MINUS RDW) IN IOCS.            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0918
*        IF DCBRECL = '01'B                                        0918
*          THEN                                                    0918
@RF00911 L     @08,DCBPTR                                          0918
         TM    DCBRECL+28(@08),B'01000000'                         0918
         BNO   @RF00918                                            0918
         TM    DCBRECL+28(@08),B'10000000'                         0918
         BNZ   @RF00918                                            0918
*            DO;                                                   0919
*                                                                  0919
*              IF DCBLRECL = 0                                     0920
*                THEN                                              0920
         LA    @02,72                                              0920
         ALR   @02,@08                                             0920
         LH    @15,DCBLRECL(,@02)                                  0920
         LTR   @15,@15                                             0920
         BNZ   @RF00920                                            0920
*                  DCBLRECL = DCBBLKSI - 4;                        0921
*                                                                  0921
         LH    @08,DCBBLKSI+52(,@08)                               0921
         SL    @08,@CF00040                                        0921
         STH   @08,DCBLRECL(,@02)                                  0921
*              IOCRFMVR = ON;                                      0922
@RF00920 L     @08,IOCSPTR                                         0922
         OI    IOCRFMVR(@08),B'01000000'                           0922
*              IOCTRN = DCBLRECL - 4;                              0923
*                                                                  0923
         L     @02,DCBPTR                                          0923
         LA    @15,72                                              0923
         ALR   @15,@02                                             0923
         LH    @14,DCBLRECL(,@15)                                  0923
         SL    @14,@CF00040                                        0923
         ST    @14,IOCTRN(,@08)                                    0923
*              /******************************************************/
*              /*                                                    */
*              /* A HIDDEN BUFFER IS OBTAINED BY THE OPEN SVC        */
*              /* FOR SPANNED RECORDS, UNLESS THE RECORD             */
*              /* SIZE IS GREATER THAN 32767                         */
*              /*                                                    */
*              /******************************************************/
*                                                                  0924
*              IF DCBRECSB = ON                                    0924
*                THEN                                              0924
         AL    @02,@CF00289                                        0924
         TM    DCBRECSB(@02),B'00001000'                           0924
         BNO   @RF00924                                            0924
*                  DO;                                             0925
*                                                                  0925
*                    IOCRFMSF = ON;                                0926
         OI    IOCRFMSF(@08),B'00010000'                           0926
*                    IF IOCMACBK = OFF & LRECLX = OFF              0927
*                      THEN                                        0927
         TM    IOCMACBK(@08),B'00010000'                           0927
         BNZ   @RF00927                                            0927
         TM    LRECLX(@15),B'10000000'                             0927
         BNZ   @RF00927                                            0927
*                         DCBBFT = '110'B;                         0928
*                                                                  0928
         NI    DCBBFT(@02),B'11101111'                             0928
         OI    DCBBFT(@02),B'01100000'                             0928
*                  END;                                            0929
*                                                                  0929
@RF00927 DS    0H                                                  0930
*            END;                                                  0930
*                                                                  0930
@RF00924 DS    0H                                                  0931
*        /************************************************************/
*        /*                                                          */
*        /* FOR BSAM PROCESSING, SET BLOCKSIZE AS IOCTRN             */
*        /* AND SET LENGTH OF BLOCK TO PROCESS TO BLOCKSIZE          */
*        /* IF DIFFERENT LENGTH, USER IS RESPONSIBLE TO              */
*        /* UPDATE.                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0931
*        IF IOCMACBK = ON                                          0931
*          THEN                                                    0931
@RF00918 L     @08,IOCSPTR                                         0931
         TM    IOCMACBK(@08),B'00010000'                           0931
         BNO   @RF00931                                            0931
*            DO;                                                   0932
*              IOCTRN = DCBBLKSI + DCBKEYLE;                       0933
         L     @02,DCBPTR                                          0933
         LH    @15,DCBBLKSI+52(,@02)                               0933
         SLR   @14,@14                                             0933
         IC    @14,DCBKEYLE+16(,@02)                               0933
         LR    @02,@15                                             0933
         ALR   @02,@14                                             0933
         ST    @02,IOCTRN(,@08)                                    0933
*              IOCDLN = DCBBLKSI;                                  0934
         ST    @15,IOCDLN(,@08)                                    0934
*              IOCKYL = DCBKEYLE;                                  0935
         STC   @14,IOCKYL(,@08)                                    0935
*            END;                                                  0936
*                                                                  0936
*        REG14 = SAVE14;                                           0937
@RF00931 LR    REG14,SAVE14                                        0937
*        GEN(BR    REG14);                                         0938
*                                                                  0938
*                                                                  0938
*                                                                  0938
         BR    REG14
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - BLDOCMSG                                */
*        /*                                                          */
*        /* FUNCTION - THIS PROCEDURE IS CALLED WHEN AN ERROR HAS    */
*        /*            DETECTED AND AN ERROR IS TO BE WRITTEN.       */
*        /*                                                          */
*        /*            THE DATA ARGUMENT FOR THE TEXT PROCESSOR      */
*        /*            IS BUILT AND PASSED TO A ROUTINE THAT WILL    */
*        /*            CALL THE TEXT PROCESSOR.                      */
*        /*                                                          */
*        /* INPUT -    SAVESTID - STID OF MESSAGE TO PRINT           */
*        /*            OPCTYP - TYPE OF OPERATION (OPEN/CLOSE)       */
*        /*                                                          */
*        /* OUTPUT -   DARGLIST - SET WITH MESSAGE INFORMATION       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0939
*BLDOCMSG: PROC (VARTEXT);                                         0939
*                                                                  0939
         B     @PB00008                                            0939
BLDOCMSG STM   @14,@12,@SA00008                                    0939
         MVC   @PC00008(4),0(@01)                                  0939
*        /* VARIABLE TEXT IF DATA SET NAME IS NOT PRESENT            */
*        DCL VARTEXT CHAR (8);                                     0940
*                                                                  0940
*        /* AREA TO BUILD FIRST ERROR MESSAGE                        */
*        DCL DMSGHEAD CHAR (28) BDY(WORD);                         0941
*                                                                  0941
*        /* DSNAME AREA                                              */
*        DCL DSNCMP CHAR(44) BASED (IOCDSN);                       0942
*                                                                  0942
*        DCL VTOC CHAR(44) GENERATED; /* SPECIAL VTOC NAME           */
*                                                                  0943
*        /* VTOC DSNAME AREA                                         */
*        DCL DSNVTOC CHAR(44) INIT ('VTOC');                       0944
*                                                                  0944
*        /* VTOC DSNAME AREA ADDRESS                                 */
*        DCL DSNVTOCP PTR(31) INIT (ADDR(DSNVTOC));                0945
*                                                                  0945
*        /************************************************************/
*        /*                                                          */
*        /* IF SYSPRINT/SYSLST IS NOT OPEN PROCESSING IS TERMINATED. */
*        /*                                                          */
*        /************************************************************/
*                                                                  0946
*        IF IODOCS = NULLPTR × IODOCS -> IOCMSGOP = OFF &          0946
*         OCATYP = OCATYPOP                                        0946
*          THEN                                                    0946
         L     @08,@PC00001                                        0946
         L     @08,GDTIOH(,@08)                                    0946
         L     @08,IODOCS(,@08)                                    0946
         LTR   @08,@08                                             0946
         BZ    @RT00946                                            0946
         TM    IOCMSGOP(@08),B'10000000'                           0946
         BNZ   @RF00946                                            0946
         L     @08,@PC00001+4                                      0946
         CLI   OCATYP(@08),1                                       0946
         BNE   @RF00946                                            0946
@RT00946 DS    0H                                                  0947
*            DO;                                                   0947
*                                                                  0947
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF UABORT IS FOR NO SPACE OR OTHER ERROR     */
*              /* RESULTING IN SYSPRINT/SYSLST NOT BEING OPEN AND    */
*              /* SET CORRESPONDING RETURN CODE.                     */
*              /*                                                    */
*              /******************************************************/
*                                                                  0948
*              IF DARGSMOD = 'UV0' & DARGSENT = NOCRSTID           0948
*                THEN                                              0948
*                                                                  0948
         L     @08,DDSTRU                                          0948
         CLC   DARGSMOD(3,@08),@CC01006                            0948
         BNE   @RF00948                                            0948
         CLI   DARGSENT(@08),4                                     0948
         BNE   @RF00948                                            0948
*                  DO;                                             0949
*                    RESPECIFY(REG13,REG14,REG15) RSTD;            0950
*                    REG15 = 28;                                   0951
         LA    REG15,28                                            0951
*                    REG14 = GDTABT;                               0952
         L     @08,@PC00001                                        0952
         L     REG14,GDTABT(,@08)                                  0952
*                    REG13 = GDTABH;                               0953
         L     REG13,GDTABH(,@08)                                  0953
*                    GEN(BR    REG14);                             0954
         BR    REG14
*                    RESPECIFY(REG13,REG14,REG15)UNRSTD;           0955
*                  END;                                            0956
*                ELSE                                              0957
*                                                                  0957
*                  DO;                                             0957
         B     @RC00948                                            0957
@RF00948 DS    0H                                                  0958
*                    RESPECIFY(REG13,REG14,REG15) RSTD;            0958
*                    REG15 = 36;                                   0959
         LA    REG15,36                                            0959
*                    REG14 = GDTABT;                               0960
         L     @08,@PC00001                                        0960
         L     REG14,GDTABT(,@08)                                  0960
*                    REG13 = GDTABH;                               0961
         L     REG13,GDTABH(,@08)                                  0961
*                    GEN(BR    REG14);                             0962
         BR    REG14
*                    RESPECIFY(REG13,REG14,REG15)UNRSTD;           0963
*                  END;                                            0964
*                                                                  0964
*            END;                                                  0965
*                                                                  0965
@RC00948 DS    0H                                                  0966
*        /************************************************************/
*        /*                                                          */
*        /* PRINT THE MAIN ERROR MESSAGE LINE                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0966
*        DDSTRU = ADDR (DMSGHEAD);                                 0966
@RF00946 LA    @08,DMSGHEAD                                        0966
         ST    @08,DDSTRU                                          0966
*        DMSGHEAD = ''B;                                           0967
         XC    DMSGHEAD(28),DMSGHEAD                               0967
*        DARGSMOD = 'IO0';                                         0968
*                                                                  0968
         MVC   DARGSMOD(3,@08),@CC00957                            0968
*        IF OCATYP = OCATYPOP                                      0969
*          THEN                                                    0969
         L     @15,@PC00001+4                                      0969
         CLI   OCATYP(@15),1                                       0969
         BNE   @RF00969                                            0969
*            DARGSENT = OPENSTID;                                  0970
         MVI   DARGSENT(@08),X'01'                                 0970
*          ELSE                                                    0971
*            DARGSENT = CLOSSTID;                                  0971
*                                                                  0971
         B     @RC00969                                            0971
@RF00969 L     @08,DDSTRU                                          0971
         MVI   DARGSENT(@08),X'02'                                 0971
*        /************************************************************/
*        /*                                                          */
*        /* IF ERROR OCCURRED BEFORE DATA SET NAME WAS FOUND         */
*        /* PRINT DNAME AS VARIABLE TEXT.  IF DSN PRESENT PRINT      */
*        /* IT AS VARIABLE TEXT.                                     */
*        /* IF DSNAME IS ALL X'04'S, USE 'VTOC' INSTEAD.             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0972
*        IF IOCSPTR = NULLPTR                                      0972
*          THEN                                                    0972
@RC00969 L     @08,IOCSPTR                                         0972
         LTR   @08,@08                                             0972
         BNZ   @RF00972                                            0972
*            DO;                                                   0973
*              DARGDBP = ADDR (VARTEXT);                           0974
         L     @08,DDSTRU                                          0974
         L     @15,@PC00008                                        0974
         ST    @15,DARGDBP(,@08)                                   0974
*              DARGILP = 8;                                        0975
         MVC   DARGILP(2,@08),@CH00157                             0975
*            END;                                                  0976
*          ELSE                                                    0977
*            DO;                                                   0977
         B     @RC00972                                            0977
@RF00972 DS    0H                                                  0978
*              IF DSNCMP = VTOC                                    0978
*                THEN                                              0978
         L     @08,IOCSPTR                                         0978
         L     @08,IOCDSN(,@08)                                    0978
         CLC   DSNCMP(44,@08),VTOC                                 0978
         BNE   @RF00978                                            0978
*                 DARGDBP = DSNVTOCP;                              0979
         L     @08,DSNVTOCP                                        0979
         L     @01,DDSTRU                                          0979
         ST    @08,DARGDBP(,@01)                                   0979
*                ELSE                                              0980
*                 DARGDBP = IOCDSN;                                0980
         B     @RC00978                                            0980
@RF00978 L     @08,IOCSPTR                                         0980
         L     @08,IOCDSN(,@08)                                    0980
         L     @01,DDSTRU                                          0980
         ST    @08,DARGDBP(,@01)                                   0980
*              DARGILP = 44;                                       0981
@RC00978 L     @08,DDSTRU                                          0981
         MVC   DARGILP(2,@08),@CH00516                             0981
*            END;                                                  0982
*                                                                  0982
*        CALL PRINTMSG;                                            0983
*                                                                  0983
@RC00972 BAL   @14,PRINTMSG                                        0983
*        /************************************************************/
*        /*                                                          */
*        /* SET SECONDARY ERROR MESSAGE DATA                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0984
*        DDSTRU = ADDR (DMSGARG);                                  0984
*                                                                  0984
         LA    @08,DMSGARG                                         0984
         ST    @08,DDSTRU                                          0984
*        CALL PRINTMSG;                                            0985
*                                                                  0985
         BAL   @14,PRINTMSG                                        0985
*        /************************************************************/
*        /*                                                          */
*        /* SET NO ERROR INDICATOR AND SET DEFAULT MODULE ID         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0986
*        DMSGARG = ''B;                                            0986
         XC    DMSGARG(44),DMSGARG                                 0986
*        DARGSMOD = 'IO0';                                         0987
*                                                                  0987
         L     @08,DDSTRU                                          0987
         MVC   DARGSMOD(3,@08),@CC00957                            0987
*        END BLDOCMSG;                                             0988
*                                                                  0988
@EL00008 DS    0H                                                  0988
@EF00008 DS    0H                                                  0988
@ER00008 LM    @14,@12,@SA00008                                    0988
         BR    @14                                                 0988
*                                                                  0989
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - PRINTMSG                                */
*        /*                                                          */
*        /* FUNCTION - THIS PROCEDURE CALLS THE TEXT PROCESSOR TO    */
*        /*            PRINT A MESSAGE.                              */
*        /*                                                          */
*        /* INPUT -    DDSTRU CONTAINS THE ADDRESS OF THE ARGUMENT   */
*        /*            CONTAINING THE MESSAGE DATA.                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0989
*PRINTMSG: PROC;                                                   0989
*                                                                  0989
PRINTMSG STM   @14,@12,@SA00009                                    0989
*        /************************************************************/
*        /*                                                          */
*        /* CALL TEXT PROCESSOR TO HAVE MESSAGE PRINTED              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0990
*        CALL ICKTPPR0 (GDTTBL,PRTFILE,DDSTRU);                    0990
*                                                                  0990
         L     @08,@PC00001                                        0990
         ST    @08,@AL00001                                        0990
         LA    @15,@CF00090                                        0990
         ST    @15,@AL00001+4                                      0990
         LA    @15,DDSTRU                                          0990
         ST    @15,@AL00001+8                                      0990
         MVI   @AL00001+8,X'80'                                    0990
         L     @15,GDTPRT(,@08)                                    0990
         LA    @01,@AL00001                                        0990
         BALR  @14,@15                                             0990
*        /************************************************************/
*        /*                                                          */
*        /* REINITIALIZE ERROR MESSAGE TEXT ARGUMENT LIST            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0991
*        END PRINTMSG;                                             0991
*                                                                  0991
@EL00009 DS    0H                                                  0991
@EF00009 DS    0H                                                  0991
@ER00009 LM    @14,@12,@SA00009                                    0991
         BR    @14                                                 0991
*        END ICKIO02                                               0992
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF03 )                                        *
*/*%INCLUDE SYSLIB  (IHADCBDF)                                        *
*/*%INCLUDE SYSLIB  (IHADCB  )                                        *
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        *
*;                                                                 0992
@EL00001 L     @13,4(,@13)                                         0992
@EF00001 L     @00,@SIZDATD                                        0992
         LR    @01,@11                                             0992
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0992
         BR    @14                                                 0992
@DATA    DS    0H
@CH00115 DC    H'6'
@CH00157 DC    H'8'
@CH00036 DC    H'12'
@CH00516 DC    H'44'
@CH01465 DC    H'629'
@SM01499 MVC   JFCBVOLS(0,JFCBPTR),MODJSERS(@08)
@SM01502 MVC   IHADCB(0,@08),GENAREA(@01)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@SA00002 DS    15F
@SA00004 DS    15F
@SA00008 DS    15F
@PC00008 DS    1F
@SA00006 DS    18F
@PC00006 DS    1F
@SA00007 DS    18F
@PC00007 DS    2F
@SA00003 DS    15F
@SA00005 DS    15F
@SA00009 DS    15F
@AL00001 DS    5A
@TF00001 DS    F
ICKIO02  CSECT
         DS    0F
@CF00090 DC    F'0'
@CF00161 DC    F'1'
@CF00040 DC    F'4'
@CH00040 EQU   @CF00040+2
@CF00289 DC    F'28'
@CF00669 DC    F'40'
@CF00584 DC    F'52'
@CF00878 DC    F'72'
@CF00955 DC    F'88'
@CF00953 DC    F'96'
@CF01441 DC    F'196'
@CF01017 DC    F'32760'
@CF01444 DC    F'32768'
@CF01493 DC    F'-8'
@CF01498 DC    F'-6'
@CF01494 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
POOLSIZE DS    F
EXTFLGFD DS    FL4
         ORG   EXTFLGFD
EXTTYPE  DS    FL1
EXTOPT   DS    BL1
         ORG   EXTOPT
EXTOPTIN DS    BL1
EXTOPTOT EQU   EXTOPT+0
EXTOPTDD EQU   EXTOPT+0
EXTOPTDS EQU   EXTOPT+0
@NM00027 EQU   EXTOPT+0
         ORG   EXTFLGFD+2
EXTPUTID DS    FL2
         ORG   EXTFLGFD+4
DCBPTR   DS    AL4
         ORG   DCBPTR
DCB00    DS    CL1
         ORG   DCBPTR+4
ABEXPTR  DS    A
TYPJPTR  DS    A
GENADDR  DS    A
XDADDR   DS    A
RETCBADR DS    A
NEXTADDR DS    A
NEXTIOCS DS    A
DCBEXWRD DS    AL4
         ORG   DCBEXWRD
DCBEXEND DS    BL1
         ORG   DCBEXWRD+4
LISTPTR  DS    A
TEMPADDR DS    A
TEMPLEN  DS    F
TESTRC   DS    H
OPENRC   DS    H
CKXTN    DS    H
TJNUMOP  DS    H
OPNCTR   DS    H
OPAMRC   DS    H
CLOSERC  DS    H
NUMFREE  DS    H
DSDRC    DS    H
DDN      DS    H
CLIOCTR  DS    H
CLREASON DS    H
SETRC    DS    H
LISTLN   DS    FL1
         DS    CL1
DMSGARG  DS    CL44
IOCSBLT  DS    BL16
         ORG   IOCSBLT
IOCSADDR DS    4A
         ORG   IOCSBLT+16
TJIOCSBL DS    BL16
         ORG   TJIOCSBL
TJIOCSAD DS    4A
         ORG   TJIOCSBL+16
WORKAREA DS    CL400
DCBTLIST DS    CL8
OFLAGS   DS    BL1
         ORG   OFLAGS
ALROPEN  DS    BL1
CKSYSIN  EQU   OFLAGS+0
CKSYSOT  EQU   OFLAGS+0
         ORG   OFLAGS+1
         DS    CL3
OPENLIST DS    BL16
         ORG   OPENLIST
OPCBADDR DS    AL4
         ORG   OPCBADDR+0
OPLEND   DS    BL1
         ORG   OPENLIST+16
TJOPLIST DS    BL16
         ORG   TJOPLIST
TJCBAD   DS    AL4
         ORG   TJCBAD+0
TJLEND   DS    BL1
         ORG   TJOPLIST+16
DTOOPEN  DS    CL8
CFLAGS   DS    CL1
         ORG   CFLAGS
CSKIP    DS    BL1
         ORG   CFLAGS+1
         DS    CL3
CLOSLIST DS    CL16
         ORG   CLOSLIST
CLCBADDR DS    AL4
         ORG   CLCBADDR+0
CLOPT    DS    CL1
         ORG   CLOPT+0
CLLEND   DS    BL1
         ORG   CLOSLIST+16
CLVTEXT  DS    CL8
IOCSID2  DS    CL4
DCBRLIST DS    CL4
         ORG   DCBRLIST
DCBRLID  DS    CL1
DCBRLPTR DS    AL3
         ORG   DCBRLIST+4
DEVAREA  DS    CL8
         ORG   DEVAREA
@NM00067 DS    CL2
DEVWORD  DS    CL1
         ORG   DEVWORD
DEVTAPE  DS    BL1
@NM00068 EQU   DEVWORD+0
DEVTDA   EQU   DEVWORD+0
@NM00069 EQU   DEVWORD+0
DEVTUR   EQU   DEVWORD+0
         ORG   DEVAREA+3
@NM00070 DS    CL5
         ORG   DEVAREA+8
DMSGHEAD DS    CL28
ICKIO02  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
SIZEIOCS DC    AL4(4+40+36+44)
DSNVTOCP DC    AL4(DSNVTOC)
LENTODSN DC    AL2(40+36)
TYPJEXON DC    XL1'07'
@CC00141 DC    C'ZERO'
@CC01008 DC    C'IOCS'
@CC01024 DC    C'IO1O'
@CC01027 DC    C'IO20'
@CC01030 DC    C'IO3O'
@CC01034 DC    C'IO21'
@CC01066 DC    C'IO1C'
@CC01072 DC    C'IO2C'
@CC01422 DC    C'IODS'
@CC00957 DC    C'IO0'
@CC01006 DC    C'UV0'
@CC01012 DC    C'DD'
@CB01413 DC    X'0000000000000000'
         DS    CL1
INITID   DS    CL4
         ORG   INITID
@NM00024 DC    CL2'IO'
@NM00025 DC    H'0'
         ORG   INITID+4
MODID    DC    CL4'IO02'
FIXAREA  DS    CL400
         ORG   FIXAREA
@NM00026 DC    400X'00'
         ORG   FIXAREA+400
OPENTEXT DC    CL5'OPEN'
CLTEXT   DC    CL5'CLOSE'
         DS    CL2
DCBTLSTA DS    CL8
         ORG   DCBTLSTA
@NM00060 DC    X'05'
@NM00061 DC    AL3(IRTOPEX)
@NM00062 DC    X'91'
@NM00063 DC    AL3(ABEXRTN)
         ORG   DCBTLSTA+8
INFILE   DC    CL8'SYSIN   '
OUTFILE  DC    CL8'SYSPRINT'
JFINHWB  DC    X'08'
DSNVTOC  DC    CL44'VTOC'
DEFDD    DC    CL8'SYSLIN '
         DC    CL8'        '
         DC    CL8'SYSLMOD '
         DC    CL8'SYSLIB  '
         DC    CL8'SYSIN   '
         DC    CL8'SYSPRINT'
         DC    CL8'SYSPUNCH'
         DC    CL8'SYSUT1  '
         DC    CL8'SYSUT2  '
         DC    CL8'SYSUT3  '
@DATD    DSECT
ICKIO02 CSECT
QSAMDCB DCB   DSORG=PS,MACRF=(GL)
BSAMDCB DCB   DSORG=PS,MACRF=(RP)
DUMAD   DC    AL4(0)
@DATD    DSECT
ICKIO02 CSECT
VTOC    DC    44X'04'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKIO02  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
BLDDRC   EQU   @03
JFCBPTR  EQU   @03
CKDD     EQU   @03
AMCLRC   EQU   @02
DELEIOCS EQU   @02
CLOCTR   EQU   @03
NUMCLOSE EQU   @02
NUMOPEN  EQU   @03
SAVE14   EQU   @03
EXITCTR  EQU   @02
OPNPTR   EQU   @02
RTNREG   EQU   @15
REG1     EQU   @01
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG0     EQU   @00
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG8     EQU   @08
REG9     EQU   @09
ICKSAEP0 EQU   0
ICKSAGP0 EQU   0
ICKSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
IOCSTR   EQU   0
IOCDLN   EQU   IOCSTR+4
IOCTRN   EQU   IOCSTR+8
IOCKYL   EQU   IOCSTR+12
IOCDSO   EQU   IOCSTR+13
IOCDSOPS EQU   IOCDSO
IOCRFM   EQU   IOCSTR+14
IOCRFMFX EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCMAC   EQU   IOCSTR+15
IOCMACIN EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMSG   EQU   IOCSTR+16
IOCMSGOP EQU   IOCMSG
IOCDSN   EQU   IOCSTR+20
IOCCBP   EQU   IOCSTR+24
IOCEXT   EQU   IOCSTR+36
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTOT EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNRFMFX EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNTYP   EQU   OPNAGL+2
OPNTYPSI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNMODAC EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNDSN   EQU   OPNAGL+12
OPNREC   EQU   OPNAGL+16
OPNBLK   EQU   OPNAGL+20
OPNVOL   EQU   OPNAGL+24
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
ICKTPPR0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
IODATA   EQU   0
IODIOC   EQU   IODATA
IODADD   EQU   IODATA+8
IODXTN   EQU   IODATA+12
IODSID   EQU   IODATA+16
IODINC   EQU   IODSID+2
IODEOD   EQU   IODATA+20
IODOSS   EQU   IODATA+24
IODOSO   EQU   IODATA+28
IODICS   EQU   IODATA+32
IODOCS   EQU   IODATA+36
IOCSEX   EQU   0
IOCCBA   EQU   IOCSEX
IOCCBL   EQU   IOCSEX+8
IOCWKA   EQU   IOCSEX+12
IOCXAD   EQU   IOCSEX+16
IOCXPM   EQU   IOCSEX+20
IOCNIO   EQU   IOCSEX+24
IOCSID   EQU   IOCSEX+28
IOCFLG   EQU   IOCSEX+32
IOCFLGEX EQU   IOCFLG
IOCFLGIO EQU   IOCFLG
IOCFLGOP EQU   IOCFLG
IOCFLGSP EQU   IOCFLG
IOCDEV   EQU   IOCSEX+33
IOCDEVDA EQU   IOCDEV
IOCDEVUR EQU   IOCDEV
IOCINF   EQU   IOCSEX+34
IOCINFAE EQU   IOCINF
IOCINFND EQU   IOCINF
IOCINFAC EQU   IOCINF
EXTRTN   EQU   0
IOEXPARM EQU   0
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS02 EQU   0
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBKEYLE EQU   DCBRELB
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEODA  EQU   DCBEODAD+1
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
DCBRECL  EQU   DCBRECLA
DCBRECBR EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBEXLSA EQU   DCBEXLST+1
IHADCS24 EQU   0
DCBDDNAM EQU   IHADCS24
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBIBPCT EQU   DCBIFLG
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFPCT EQU   DCBIFLGS
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBBLKSI EQU   IHADCS36+10
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBLRECL EQU   IHADCS38+10
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00056 EQU   IHADCS40+12
DCBEROPT EQU   @NM00056
DCBERACC EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
ABEXLIST EQU   0
ABOPT    EQU   ABEXLIST+3
ABDCBAD  EQU   ABEXLIST+4
GENAREA  EQU   0
XTNLIST  EQU   0
XTNNUM   EQU   XTNLIST
XTNENT   EQU   XTNLIST+4
XDPTR    EQU   XTNENT
XTNADR   EQU   XTNENT+4
XTNPRM   EQU   XTNENT+8
XTFIELD  EQU   0
XTFTYPE  EQU   XTFIELD
XTNAME   EQU   XTFIELD+2
BLANKDSN EQU   0
IOCSPRE  EQU   0
RETIOCS  EQU   0
OPDNAME  EQU   0
DSNAME   EQU   0
ALTDLIST EQU   0
DDLLEN   EQU   ALTDLIST
ALTDD    EQU   ALTDLIST+2
READDCB  EQU   0
MODJNM   EQU   0
MODJVL   EQU   0
MODJCNT  EQU   MODJVL
MODJSERS EQU   MODJVL+1
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCSDS   EQU   JFCBTSDM
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
TYPJWA   EQU   0
TYPJEXLN EQU   TYPJWA
TYPJEX   EQU   TYPJEXLN
TYPJEPT  EQU   TYPJEXLN+1
TYPJEXLO EQU   TYPJWA+4
TYPJFCB  EQU   TYPJWA+12
DSNCMP   EQU   0
DMPTRM   EQU   0
ICKDVCL0 EQU   0
ICKDVIN0 EQU   0
ICKDVON0 EQU   0
ICKDVOP0 EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOOP0 EQU   0
ICKIOPT0 EQU   0
ICKIOTM0 EQU   0
ICKSACL0 EQU   0
ICKSADE0 EQU   0
ICKSAFS0 EQU   0
ICKSAGS0 EQU   0
ICKSALD0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NEWERID2 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTIOH   EQU   GDTTBL+36
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
OCARRAY  EQU   0
OCATYP   EQU   OCARRAY
OCAOPT   EQU   OCARRAY+1
OCAOPTCA EQU   OCAOPT
OCANUM   EQU   OCARRAY+2
OCADDR   EQU   OCARRAY+4
JFCDNAME EQU   0
RETDCBAD EQU   0
OPOPTION EQU   RETDCBAD
DDDNAME  EQU   0
VARTEXT  EQU   0
LRECLX   EQU   DCBLRECL
DCBSYN   EQU   DCBSYNAD+1
IODOSOS  EQU   IODOSO+1
IODOSSS  EQU   IODOSS+1
IOCCBUF  EQU   DCBBUFCB
IOCCBUFF EQU   IOCCBUF
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBNVOL EQU   JFCUCSEG+9
JFCBVOLS EQU   JFCUCSEG+10
JFCBS001 EQU   JFCBVOLS
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JFCBSPNM EQU   JFCBS001+45
JFCBFLG3 EQU   JFCBSPNM
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBRV08 EQU   JFCBSPNM+1
JFCBRV07 EQU   JFCBFLG3
JFCBRV06 EQU   JFCBFLG3
JFCBRV05 EQU   JFCBFLG3
JFCBRV04 EQU   JFCBFLG3
JFCBRV03 EQU   JFCBFLG3
JFCBRV02 EQU   JFCBFLG3
JFCBRV01 EQU   JFCBFLG3
JFCDQDSP EQU   JFCBFLG3
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00074 EQU   JFCBS001
JFCAVOLS EQU   JFCBVOLS
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00073 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00072 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
@NM00064 EQU   IOCCBUF
@NM00023 EQU   OCARRAY+3
@NM00022 EQU   OCAOPT
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00071 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
ABRECAD  EQU   ABEXLIST+13
@NM00066 EQU   ABEXLIST+12
ABWKAREA EQU   ABEXLIST+8
ABOPTDLY EQU   ABOPT
ABOPTIGN EQU   ABOPT
ABOPTREC EQU   ABOPT
@NM00065 EQU   ABOPT
ABRTCD   EQU   ABEXLIST+2
ABSYSCD  EQU   ABEXLIST
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00059 EQU   IHADCS40+16
@NM00058 EQU   @NM00056+1
@NM00057 EQU   DCBEROPT
@NM00055 EQU   IHADCS40+10
@NM00054 EQU   IHADCS40+9
@NM00053 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00052 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
@NM00051 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00050 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00049 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00048 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00047 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00046 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00045 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
DCBOPTJ  EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00044 EQU   DCBPUT
DCBREADA EQU   DCBWRITA
@NM00043 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00042 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBCH12  EQU   DCBIFPCT
DCBCH9   EQU   DCBIFPCT
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00041 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBICH12 EQU   DCBIBPCT
DCBICH9  EQU   DCBIBPCT
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBRECKL EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00040 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00039 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00038 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00037 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
@NM00036 EQU   DCBDSRG1
@NM00035 EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
@NM00034 EQU   IHADCS02+19
DCBDEN   EQU   IHADCS02+18
@NM00033 EQU   IHADCS02+17
DCBTRTCH EQU   IHADCS02+16
DCBBLKCT EQU   IHADCS02+12
@NM00032 EQU   IHADCS02
DCBTRBAL EQU   IHADCS01+6
@NM00031 EQU   IHADCS01+5
@NM00030 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00029 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00028 EQU   IHADCB
@NM00021 EQU   IOCSEX+35
IOCINFR1 EQU   IOCINF
IOCINFQX EQU   IOCINF
IOCINFPT EQU   IOCINF
@NM00020 EQU   IOCDEV
IOCDEVMT EQU   IOCDEV
@NM00019 EQU   IOCFLG
IOCFLGOE EQU   IOCFLG
IOCFLGEF EQU   IOCFLG
IOCFLGDF EQU   IOCFLG
@NM00018 EQU   IOCSEX+10
IOCDEC   EQU   IOCSEX+4
IODMID   EQU   IODSID
IODMSG   EQU   IODATA+4
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
@NM00011 EQU   OPNMOD
@NM00010 EQU   OPNTYP
@NM00009 EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCPNM   EQU   IOCSTR+28
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
@NM00003 EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDAD   EQU   IOCSTR
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID2   EQU   TRACE2+95
OLDERID2 EQU   TRACE2
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00495 EQU   @EL00003
@RC00520 EQU   @EL00003
@RF00569 EQU   @RC00562
@RF00640 EQU   @EL00005
@PB00006 EQU   @PB00007
@RC00795 EQU   @RC00790
@RF00877 EQU   @RC00874
@RF00889 EQU   @RC00886
@PB00009 EQU   @EL00001
@RF00505 EQU   @RC00495
@RF00511 EQU   @RC00495
@PB00005 EQU   @PB00006
@PB00008 EQU   @PB00009
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   ICKIO02,(C'PLS1715',0701,78192)

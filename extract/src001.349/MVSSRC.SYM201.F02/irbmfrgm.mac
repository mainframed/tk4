         TITLE '*/* IRBMFRGM - REPORT GENERATOR CONTROL MODULE         *
                       '
IRBMFRGM CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IRBMFRGM  74.087'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MVC   @PC00001(12),0(@01)                                 0001
*                                                                  0032
*/* STATIC TO AUTOMATIC INITIALIZATION  -  THIS INITIALIZATION MOVES
*   COPIES OF STATIC VARIABLES INTO AUTOMATIC STORAGE WHICH WAS    0032
*   OBTAINED ON ENTRY TO THIS MODULE                                 */
*                                                                  0032
*   RGCLOSPL=RGCLSSPL;              /* STATIC CLOSE PARAMETER LIST 0032
*                                      MOVED TO AUTOMATIC STORAGE    */
         MVC   RGCLOSPL(4),RGCLSSPL                                0032
*   RGDCB=RGSDCB;                   /* STATIC DCB MOVED TO AUTOMATIC
*                                      STORAGE                       */
         MVC   RGDCB(96),RGSDCB                                    0033
*   RGESTAPL=RGESTSPL;              /* STATIC ESTAE PARAMETER LIST 0034
*                                      MOVED TO AUTOMATIC STORAGE    */
         MVC   RGESTAPL(16),RGESTSPL                               0034
*   RGOPENPL=RGOPNSPL;              /* STATIC OPEN PARAMETER LIST  0035
*                                      MOVED TO AUTOMATIC STORAGE    */
         MVC   RGOPENPL(4),RGOPNSPL                                0035
*                                                                  0036
*/* GENERAL INITIALIZATION                                           */
*                                                                  0036
*   /*****************************************************************/
*   /*                                                               */
*   /* LOAD BINARY TO CHARACTER CONVERSION ROUTINE                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0036
*   RESPECIFY                                                      0036
*    (GPR00F,                                                      0036
*     GPR01F,                                                      0036
*     GPR14F,                                                      0036
*     GPR15F)RESTRICTED;                                           0036
*   GENERATE;                                                      0037
RGLOAD1  LOAD  EP=IRBMFCNV,RELATED=(MFRGLCNV,IRBMFRGM(RGLOAD8))
*   RGVECTAB(1)=GPR00P;             /* SAVE ENTRY POINT TO PASS TO 0038
*                                      REPORT GENERATORS             */
         ST    GPR00P,RGVECTAB                                     0038
*   RESPECIFY                                                      0039
*    (GPR00F,                                                      0039
*     GPR01F,                                                      0039
*     GPR14F,                                                      0039
*     GPR15F)UNRESTRICTED;                                         0039
*                                                                  0039
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE REST OF VECTOR TABLE                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0040
*   RGVECTAB(2)=ADDR(MFHDRISR);                                    0040
         LA    @10,MFHDRISR                                        0040
         ST    @10,RGVECTAB+4                                      0040
*   RGVECTAB(3)=ADDR(MFISRTXT);                                    0041
         LA    @10,MFISRTXT                                        0041
         ST    @10,RGVECTAB+8                                      0041
*   RGVECTAB(4)=ADDR(MFWRTPAG);                                    0042
*                                                                  0042
         LA    @10,MFWRTPAG                                        0042
         ST    @10,RGVECTAB+12                                     0042
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ESTAE PARAMETER LIST DO NOT ALLOW REPORT RETRY UNTIL   */
*   /* SYSOUT IS OPENED.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0043
*   MFSERTRY='1'B;                                                 0043
         L     @10,@PC00001                                        0043
         OI    MFSERTRY(@10),B'00000001'                           0043
*   RGESTSEL=ADDR(MFSEL);           /* ADDRESS OF SUBTASK ELEMENT    */
         ST    @10,RGESTSEL                                        0044
*   RGESTALL=ADDR(RGALLARG);        /* ADDRESS OF ALLOCATION MODULE
*                                      ARGUMENTS                     */
         LA    @15,RGALLARG                                        0045
         ST    @15,RGESTALL                                        0045
*   RGESTDCB=ADDR(RGDCB);           /* ADDRESS OF REPORT DCB         */
         LA    @15,RGDCB                                           0046
         ST    @15,RGESTDCB                                        0046
*   RGESTDCM=MFSEMDCB;              /* ADDRESS OF MESSAGE DCB        */
         MVC   RGESTDCM(4),MFSEMDCB(@10)                           0047
*   RGESTRTY=ADDR(RGRETRY);         /* RETRY ADDRESS FOR ESTAE       */
         LA    @10,RGRETRY                                         0048
         ST    @10,RGESTRTY                                        0048
*   RGESTPAG=ADDR(RGPAGE);          /* ADDRESS OF INTERNAL PAGE IMAGE*/
         LA    @10,RGPAGE                                          0049
         ST    @10,RGESTPAG                                        0049
*   RGESTOPN=ADDR(RGOPENPL);        /* ADDRESS OF OPEN PARM LIST     */
         LA    @10,RGOPENPL                                        0050
         ST    @10,RGESTOPN                                        0050
*   RGESTCLS=ADDR(RGCLOSPL);        /* ADDRESS OF CLOSE PARM LIST    */
         LA    @10,RGCLOSPL                                        0051
         ST    @10,RGESTCLS                                        0051
*   RGESTCNV=RGVECTAB(1);           /* ADDRESS OF CONVERSION ROUTINE */
         MVC   RGESTCNV(4),RGVECTAB                                0052
*   RGESTREG=ADDR(RGRTYREG);        /* ADDRESS OF REGISTER SAVE AREA.*/
*                                                                  0053
         LA    @10,RGRTYREG                                        0053
         ST    @10,RGESTREG                                        0053
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH ESTAE ENVIRONMENT TO PROCEDURE IRBMFSAR             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0054
*   RESPECIFY                                                      0054
*    (GPR00F,                                                      0054
*     GPR01F,                                                      0054
*     GPR02P,                                                      0054
*     GPR03P,                                                      0054
*     GPR14F,                                                      0054
*     GPR15F)RESTRICTED;                                           0054
*                                                                  0054
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ESTAE PARAMETER LIST ADDRESS INTO REGISTER FOR ESTAE      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0055
*   GPR02P=ADDR(RGESTPRM);                                         0055
         LA    GPR02P,RGESTPRM                                     0055
*   GPR03P=ADDR(IRBMFSAR);          /* GET ADDRESS OF RECOVERY     0056
*                                      ROUTINE                       */
         L     GPR03P,@CV00592                                     0056
*   GENERATE REFS(RGESTPRM)SETS(RGESTAPL);                         0057
         ESTAE (3),PARAM=(2),MF=(E,RGESTAPL),RECORD=YES
*   IF GPR15F^=0 THEN               /* IF IMPOSSIBLE RETURN CODE     */
         LTR   GPR15F,GPR15F                                       0058
         BZ    @RF00058                                            0058
*     DO;                                                          0059
*       RGERRCDE=2;                 /* IMPOSSIBLE RETURN CODE FROM 0060
*                                      ESTAE                         */
         MVC   RGERRCDE(2),@CH00089                                0060
*       GO TO RGERR2;               /* ABEND                         */
         B     RGERR2                                              0061
*     END;                                                         0062
*   RESPECIFY                                                      0063
*    (GPR00F,                                                      0063
*     GPR01F,                                                      0063
*     GPR02P,                                                      0063
*     GPR03P,                                                      0063
*     GPR14F,                                                      0063
*     GPR15F)UNRESTRICTED;                                         0063
*                                                                  0063
@RF00058 DS    0H                                                  0064
*   /*****************************************************************/
*   /*                                                               */
*   /* POINT DCB LABEL STRUCTURE TO AUTOMATIC DCB                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0064
*   DCBPTR=ADDR(RGDCB);                                            0064
         LA    DCBPTR,RGDCB                                        0064
*   DCBSYNA=ADDR(MFSYNAD);          /* SET ADDRESS OF SYNAD ROUTINE
*                                      INTO DCB                      */
*                                                                  0065
         LA    @10,MFSYNAD                                         0065
         STCM  @10,7,DCBSYNA+52(DCBPTR)                            0065
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL PAGE IMAGE                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0066
*   RGLASTLN=RGNOPAGE;              /* NO LINES CONTAIN NON-BLANK  0066
*                                      CHARACTERS. (BLANK PAGE)      */
         SR    @10,@10                                             0066
         STH   @10,RGLASTLN                                        0066
*   DO RGLOOP=1 TO RGMAXLN;                                        0067
         LA    RGLOOP,1                                            0067
@DL00067 DS    0H                                                  0068
*     RGLENGTH(RGLOOP)=RGNOLINE;    /* INDICATES LINE IS BLANK.      */
         SR    @10,@10                                             0068
         LR    @07,RGLOOP                                          0068
         MH    @07,@CH00789                                        0068
         STH   @10,RGLENGTH-126(@07)                               0068
*     RGFILL(RGLOOP)=RGNOFILL;      /* FILL ZEROS FOR VARIABLE LENGTH
*                                      RECORD                        */
         STH   @10,RGFILL-126(@07)                                 0069
*     RGCARCTL(RGLOOP)=' ';         /* CARRIAGE CONTROL CHARACTER    */
         LA    @10,RGCARCTL-126(@07)                               0070
         MVI   0(@10),C' '                                         0070
*     RGLINE(RGLOOP)=' ';           /* BLANK LINE                    */
         LA    @10,RGLINE-126(@07)                                 0071
         MVI   1(@10),C' '                                         0071
         MVC   2(118,@10),1(@10)                                   0071
         MVI   0(@10),C' '                                         0071
*   END;                                                           0072
         AH    RGLOOP,@CH00072                                     0072
         CH    RGLOOP,@CH00339                                     0072
         BNH   @DL00067                                            0072
*                                                                  0073
*/* BEGIN MAINLINE PROCESSING                                        */
*                                                                  0073
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBTASK MAY ONLY EXECUTE IF ALL OTHER SUBTASKS HAVE      */
*   /* COMPLETED                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0073
*   DO WHILE(MFSESTID^=(MFPCALST+1));/* WAIT IF THIS IS NOT THE NEXT
*                                      SUBTASK TO GO                 */
*                                                                  0073
         B     @DE00073                                            0073
@DL00073 DS    0H                                                  0074
*     /***************************************************************/
*     /*                                                             */
*     /* WAIT FOR ONE SECOND                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0074
*     RESPECIFY                                                    0074
*      (GPR00F,                                                    0074
*       GPR01F,                                                    0074
*       GPR14F,                                                    0074
*       GPR15F)RESTRICTED;                                         0074
*     GENERATE REFS(RGONESEC);                                     0075
         STIMER WAIT,DINTVL=RGONESEC
*     RESPECIFY                                                    0076
*      (GPR00F,                                                    0076
*       GPR01F,                                                    0076
*       GPR14F,                                                    0076
*       GPR15F)UNRESTRICTED;                                       0076
*   END;                                                           0077
*                                                                  0077
@DE00073 L     @10,@PC00001                                        0077
         L     @07,@PC00001+4                                      0077
         LA    @15,1                                               0077
         A     @15,MFPCALST(,@07)                                  0077
         CL    @15,MFSESTID(,@10)                                  0077
         BNE   @DL00073                                            0077
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE UNIQUE DDNAME FROM SUBTASK ID TO USE IN ALLOCATING  */
*   /* SYSOUT DATA SET                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0078
*   CALL IRBMFCNV(MFSESTID,         /* PARAMETER 1 - SUBTASK ID TO BE
*                                      CONVERTED                     */
*       0,                          /* PARAMETER 2 - SCALE FACTOR ON
*                                      THE INPUT VALUE               */
*       RGDDNAME(4:8),              /* PARAMETER 3 - OUTPUT STRING IN
*                                      FORM NNNNN WHERE N IS A     0078
*                                      DECIMAL DIGIT OR BLANK      0078
*                                      (LEADING ZEROS SUPPRESSED)    */
*       5,                          /* PARAMETER 4 - OUTPUT STRING 0078
*                                      LENGTH                        */
*       0,                          /* PARAMETER 5 - DIGITS TO THE 0078
*                                      RIGHT OF THE DECIMAL POINT IN
*                                      THE OUTPUT STRING             */
*       '0'B,                       /* PARAMETER 6 - NO COMMAS TO BE
*                                      INSERTED                      */
*       '0'B);                      /* PARAMETER 7 - NO FLOATING OF
*                                      NUMBER IN OUTPUT FIELD FOR  0078
*                                      MAXIMUM PRECISION.            */
         MVC   @AL00001+4(24),@AL00078                             0078
         LA    @10,MFSESTID(,@10)                                  0078
         ST    @10,@AL00001                                        0078
         LA    @10,RGDDNAME+3                                      0078
         ST    @10,@AL00001+8                                      0078
         L     @15,RGVECTAB                                        0078
         LA    @01,@AL00001                                        0078
         BALR  @14,@15                                             0078
*   RESPECIFY                                                      0079
*    (GPR15F)RESTRICTED;                                           0079
*   IF GPR15F^=0 THEN               /* TEST FOR IMPOSSIBLE RETURN  0080
*                                      CODE                          */
         LTR   GPR15F,GPR15F                                       0080
         BZ    @RF00080                                            0080
*     DO;                                                          0081
*       RGERRCDE=1;                 /* IMPOSSIBLE RETURN CODE FROM 0082
*                                      CONVERSION ROUTINE            */
         MVC   RGERRCDE(2),@CH00072                                0082
*       GO TO RGERR2;               /* ABEND                         */
         B     RGERR2                                              0083
*     END;                                                         0084
*   RESPECIFY                                                      0085
*    (GPR15F)UNRESTRICTED;                                         0085
*                                                                  0085
@RF00080 DS    0H                                                  0086
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT LEADING ZEROS                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0086
*   DO RGLOOP=4 TO LENGTH(RGDDNAME);                               0086
         LA    RGLOOP,4                                            0086
@DL00086 DS    0H                                                  0087
*     IF RGDDNAME(RGLOOP)=' ' THEN  /* INSERT ZERO IN PLACE OF BLANK */
         LA    @10,RGDDNAME-1(RGLOOP)                              0087
         CLI   0(@10),C' '                                         0087
         BNE   @RF00087                                            0087
*       RGDDNAME(RGLOOP)='0';                                      0088
         LA    @10,RGDDNAME-1(RGLOOP)                              0088
         MVI   0(@10),C'0'                                         0088
*   END;                                                           0089
@RF00087 AH    RGLOOP,@CH00072                                     0089
         CH    RGLOOP,@CH00052                                     0089
         BNH   @DL00086                                            0089
*   RGDDNAME(1:3)='MFR';            /* COMPLETE DDNAME               */
         MVC   RGDDNAME(3),@CC00656                                0090
*   DCBDDNAM=RGDDNAME;              /* SET INTO DCB                  */
*                                                                  0091
         LA    @10,40                                              0091
         AR    @10,DCBPTR                                          0091
         MVC   DCBDDNAM(8,@10),RGDDNAME                            0091
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLOCATE DATA SET                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0092
*   RGALLDDN=DCBDDNAM;              /* DDNAME TO TEMPORARY ARGUMENT  */
         MVC   RGALLDDN(8),DCBDDNAM(@10)                           0092
*   RGALLSOU=MFCOOUTV;              /* SYSOUT CLASS TO TEMPORARY   0093
*                                      ARGUMENT FROM COMMON OPTION 0093
*                                      AREA                          */
*                                                                  0093
         L     @10,@PC00001                                        0093
         L     @10,MFSECOA(,@10)                                   0093
         MVC   RGALLSOU(1),MFCOOUTV(@10)                           0093
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TEMPORARY ARGUMENT FOR UNALLOCATION AT CLOSE. UNALLOCATE  */
*   /* ONLY IF REALTIME REPORTS ARE DESIRED                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0094
*   IF MFCOREPV=RGREALTM THEN                                      0094
         TM    MFCOREPV(@10),B'00000010'                           0094
         BNO   @RF00094                                            0094
         TM    MFCOREPV(@10),B'00000001'                           0094
         BNZ   @RF00094                                            0094
*     RGALLUNA='1'B;                /* UNALLOCATE REALTIME REPORTS   */
         OI    RGALLUNA,B'10000000'                                0095
*   ELSE                                                           0096
*     RGALLUNA='0'B;                /* DONT UNALLOCATE DEFERRED    0096
*                                      REPORTS                       */
*                                                                  0096
         B     @RC00094                                            0096
@RF00094 NI    RGALLUNA,B'01111111'                                0096
*   /*****************************************************************/
*   /*                                                               */
*   /* LOAD ALLOCATION MODULE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0097
*   RGMODULE='IRBMFALL';            /* MODULE NAME TO RECEIVE CONTROL*/
@RC00094 MVC   RGMODULE(8),@CC00657                                0097
*   RESPECIFY                                                      0098
*    (GPR00F,                                                      0098
*     GPR01F,                                                      0098
*     GPR14F,                                                      0098
*     GPR15F)RESTRICTED;                                           0098
*   GENERATE REFS(RGMODULE);                                       0099
RGLOAD2  LOAD  EPLOC=RGMODULE,RELATED=(MFRGLALL,IRBMFRGM(RGLOAD3))
*   RGENTRYP=GPR00P;                /* SAVE ENTRY POINT FOR CALL     */
         LR    RGENTRYP,GPR00P                                     0100
*   RESPECIFY                                                      0101
*    (GPR00F,                                                      0101
*     GPR01F,                                                      0101
*     GPR14F,                                                      0101
*     GPR15F)UNRESTRICTED;                                         0101
*                                                                  0101
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ALLOCATION MODULE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0102
*   CALL IRBMFALL(RGALLDDN,         /* DDNAME                        */
*       RGALLSOU,                   /* SYSOUT CLASS                  */
*       RGALLUNA);                  /* UNALLOCATION AT CLOSE FLAG    */
*                                                                  0102
         LA    @10,RGALLDDN                                        0102
         ST    @10,@AL00001                                        0102
         LA    @10,RGALLSOU                                        0102
         ST    @10,@AL00001+4                                      0102
         LA    @10,RGALLUNA                                        0102
         ST    @10,@AL00001+8                                      0102
         LR    @15,RGENTRYP                                        0102
         LA    @01,@AL00001                                        0102
         BALR  @14,@15                                             0102
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE ALLOCATION MODULE                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0103
*   RESPECIFY                                                      0103
*    (GPR00F,                                                      0103
*     GPR01F,                                                      0103
*     GPR14F,                                                      0103
*     GPR15F)RESTRICTED;                                           0103
*   GENERATE REFS(RGMODULE);                                       0104
RGLOAD3  DELETE EPLOC=RGMODULE,RELATED=(MFRGLALL,IRBMFRGM(RGLOAD2))
*   RESPECIFY                                                      0105
*    (GPR00F,                                                      0105
*     GPR01F,                                                      0105
*     GPR14F,                                                      0105
*     GPR15F)UNRESTRICTED;                                         0105
*                                                                  0105
*   /*****************************************************************/
*   /*                                                               */
*   /* DATA SET IS NOW ALLOCATED. OPEN IT                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0106
*   RESPECIFY                                                      0106
*    (GPR00F,                                                      0106
*     GPR01F,                                                      0106
*     GPR14F,                                                      0106
*     GPR15F)RESTRICTED;                                           0106
*   GENERATE REFS(RGDCB)SETS(RGOPENPL);                            0107
         OPEN  (RGDCB,(OUTPUT)),MF=(E,RGOPENPL)
*   RESPECIFY                                                      0108
*    (GPR00F,                                                      0108
*     GPR01F,                                                      0108
*     GPR14F,                                                      0108
*     GPR15F)UNRESTRICTED;                                         0108
*   IF DCBOFOPN='0'B THEN           /* TEST FOR OPEN ERROR           */
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0109
         BZ    @RT00109                                            0109
*     GO TO RGERR1;                 /* GENERATE ABEND DUE TO OPEN  0110
*                                      ERROR                         */
*                                                                  0110
*   /*****************************************************************/
*   /*                                                               */
*   /* LOAD, CALL, AND DELETE THE REPORT GENERATOR FOR EACH ACTIVE   */
*   /* MEASUREMENT OPTION SAVE REGISTERS FOR RETRY ON ERROR          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0111
*   GENERATE(STM  @02,@13,RGRTYREG);                               0111
*                                                                  0111
         STM  @02,@13,RGRTYREG
*   /*****************************************************************/
*   /*                                                               */
*   /* REPORT RETRY IS NOW ALLOWED.                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0112
*   MFSERTRY='0'B;                                                 0112
         L     @10,@PC00001                                        0112
         NI    MFSERTRY(@10),B'11111110'                           0112
*RGRETRY:                           /* RETRY POINT FROM ESTAE      0113
*                                      RECOVERY EXIT                 */
*   DO RGLOOP=1 TO MFMVNUM;         /* LOOP THROUGH MEASUREMENT    0113
*                                      VECTOR TABLE                  */
RGRETRY  LA    RGLOOP,1                                            0113
         B     @DE00113                                            0113
@DL00113 DS    0H                                                  0114
*     IF MFMVADD(RGLOOP)->MFPMOPT=0 THEN                           0114
         LR    @10,RGLOOP                                          0114
         SLA   @10,2                                               0114
         L     @05,@PC00001+8                                      0114
         L     @10,MFMVADD-4(@10,@05)                              0114
         ICM   @05,15,MFPMOPT(@10)                                 0114
         BZ    @RT00114                                            0114
*       GO TO RGLAB2;               /* BYPASS IF OPTION NOT ACTIVE   */
*     RGMODULE=MFMVADD(RGLOOP)->    /* ADDRESS PROPER PMA            */
*         MFPMSARG;                 /* SET REPORT GENERATOR NAME INTO
*                                      TEMPORARY ARGUMENT FOR LOAD   */
*                                                                  0116
         MVC   RGMODULE(8),MFPMSARG(@10)                           0116
*     /***************************************************************/
*     /*                                                             */
*     /* LOAD REPORT GENERATOR                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0117
*     RESPECIFY                                                    0117
*      (GPR00F,                                                    0117
*       GPR01F,                                                    0117
*       GPR14F,                                                    0117
*       GPR15F)RESTRICTED;                                         0117
*     GENERATE REFS(RGMODULE);                                     0118
RGLOAD4  LOAD  EPLOC=RGMODULE,RELATED=(MFRGLRXR,IRBMFRGM,(RGLOAD5))
*     RGENTRYP=GPR00P;              /* SAVE ENTRY POINT FOR CALL     */
         LR    RGENTRYP,GPR00P                                     0119
*     RESPECIFY                                                    0120
*      (GPR00F,                                                    0120
*       GPR01F,                                                    0120
*       GPR14F,                                                    0120
*       GPR15F)UNRESTRICTED;                                       0120
*                                                                  0120
*     /***************************************************************/
*     /*                                                             */
*     /* CALL REPORT GENERATOR                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0121
*     CALL IRBMFRXR(                /* REPORT FORMATTER PROGRAM      */
*         DTMVADD(RGLOOP),          /* ADDRESS OF DATA TO BE       0121
*                                      FORMATTED AND PRINTED.        */
*         RGVECTAB,                 /* VECTOR TABLE OF COMMON      0121
*                                      SUBROUTINES                   */
*         MFMVADD(RGLOOP)           /* ADDRESS OF PMA FOR THIS REPORT*/
*         );                                                       0121
*                                                                  0121
         LR    @10,RGLOOP                                          0121
         SLA   @10,2                                               0121
         L     @15,@PC00001                                        0121
         L     @01,MFSEDTMV(,@15)                                  0121
         LA    @15,DTMVADD-4(@10,@01)                              0121
         ST    @15,@AL00001                                        0121
         LA    @15,RGVECTAB                                        0121
         ST    @15,@AL00001+4                                      0121
         L     @15,@PC00001+8                                      0121
         LA    @10,MFMVADD-4(@10,@15)                              0121
         ST    @10,@AL00001+8                                      0121
         LR    @15,RGENTRYP                                        0121
         LA    @01,@AL00001                                        0121
         BALR  @14,@15                                             0121
*     /***************************************************************/
*     /*                                                             */
*     /* DELETE REPORT GENERATOR                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0122
*     RESPECIFY                                                    0122
*      (GPR00F,                                                    0122
*       GPR01F,                                                    0122
*       GPR14F,                                                    0122
*       GPR15F)RESTRICTED;                                         0122
*     GENERATE REFS(RGMODULE);                                     0123
RGLOAD5  DELETE EPLOC=RGMODULE,RELATED=(MFRGLRXR,IRBMFRGM(RGLOAD4))
*     RESPECIFY                                                    0124
*      (GPR00F,                                                    0124
*       GPR01F,                                                    0124
*       GPR14F,                                                    0124
*       GPR15F)UNRESTRICTED;                                       0124
*RGLAB2:                            /* END OF MEASUREMENT VECTOR   0125
*                                      TABLE LOOP                    */
*   END;                                                           0125
*                                                                  0125
RGLAB2   AH    RGLOOP,@CH00072                                     0125
@DE00113 L     @10,@PC00001+8                                      0125
         C     RGLOOP,MFMVNUM(,@10)                                0125
         BNH   @DL00113                                            0125
*   /*****************************************************************/
*   /*                                                               */
*   /* DO NOT ALLOW REPORT RETRY.                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0126
*   MFSERTRY='1'B;                                                 0126
*                                                                  0126
         L     @10,@PC00001                                        0126
         OI    MFSERTRY(@10),B'00000001'                           0126
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE SYSOUT DATA SET. IF THIS IS A REALTIME DATA SET IT WILL */
*   /* BE UNALLOCATED AND PRINTED IMMEDIATELY. OTHERWISE, IT WILL BE */
*   /* PRINTED FOLLOWING MF/1 TERMINATION.                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0127
*   RESPECIFY                                                      0127
*    (GPR00F,                                                      0127
*     GPR01F,                                                      0127
*     GPR14F,                                                      0127
*     GPR15F)RESTRICTED;                                           0127
*   GENERATE REFS(RGDCB)SETS(RGCLOSPL);                            0128
         CLOSE (RGDCB,DISP),MF=(E,RGCLOSPL)
*   RESPECIFY                                                      0129
*    (GPR00F,                                                      0129
*     GPR01F,                                                      0129
*     GPR14F,                                                      0129
*     GPR15F)UNRESTRICTED;                                         0129
*   MFPCALST=MFSESTID;              /* INDICATE THAT THIS SUBTASK IS
*                                      THE LAST ONE TO COMPLETE    0130
*                                      PROCESSING                    */
*                                                                  0130
         L     @10,@PC00001+4                                      0130
         L     @15,@PC00001                                        0130
         MVC   MFPCALST(4,@10),MFSESTID(@15)                       0130
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE INTERVAL DATA STORAGE AREAS AND THE INTERVAL DATA        */
*   /* MEASUREMENT VECTOR TABLE                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0131
*   DO RGLOOP=1 TO DTMVNUM;                                        0131
         LA    RGLOOP,1                                            0131
         B     @DE00131                                            0131
@DL00131 DS    0H                                                  0132
*     IF DTMVADD(RGLOOP)=0 THEN     /* BYPASS IF NO DATA             */
         LR    @10,RGLOOP                                          0132
         SLA   @10,2                                               0132
         L     @05,@PC00001                                        0132
         L     @05,MFSEDTMV(,@05)                                  0132
         L     @10,DTMVADD-4(@10,@05)                              0132
         LTR   @10,@10                                             0132
         BZ    @RT00132                                            0132
*       GO TO RGLAB3;               /* FREE MEASUREMENT VECTOR TABLE */
*     RESPECIFY                                                    0134
*      (GPR00F,                                                    0134
*       GPR01F,                                                    0134
*       GPR14F,                                                    0134
*       GPR15F)RESTRICTED;                                         0134
*                                                                  0134
*     /***************************************************************/
*     /*                                                             */
*     /* ADDRESS PROPER DATA AREA                                    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0135
*     GPR00F=(DTMVADD(RGLOOP)-LENGTH(RGSBPLLN))->RGSBPLLN;/* SUBPOOL
*                                      AND LENGTH TO REGISTER 0      */
*                                                                  0135
         SH    @10,@CH00065                                        0135
         L     GPR00F,RGSBPLLN(,@10)                               0135
*     /***************************************************************/
*     /*                                                             */
*     /* ADDRESS OF AREA TO BE FREED TO REGISTER 1                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0136
*     GPR01P=(DTMVADD(RGLOOP)-LENGTH(RGSBPLLN));                   0136
*                                                                  0136
         LR    GPR01P,@10                                          0136
*     /***************************************************************/
*     /*                                                             */
*     /* FREE INTERVAL DATA AREA                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0137
*     GENERATE;                                                    0137
RGFREES1 FREEMAIN R,LV=(0),A=(1)
*     RESPECIFY                                                    0138
*      (GPR00F,                                                    0138
*       GPR01F,                                                    0138
*       GPR14F,                                                    0138
*       GPR15F)UNRESTRICTED;                                       0138
*RGLAB3:                            /* END OF ROUTINE TO FREE      0139
*                                      INTERVAL DATA STORAGE AREA    */
*   END;                                                           0139
*                                                                  0139
RGLAB3   AH    RGLOOP,@CH00072                                     0139
@DE00131 L     @10,@PC00001                                        0139
         L     @10,MFSEDTMV(,@10)                                  0139
         C     RGLOOP,DTMVNUM(,@10)                                0139
         BNH   @DL00131                                            0139
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE DATA MEASUREMENT VECTOR TABLE                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0140
*   RESPECIFY                                                      0140
*    (GPR00F,                                                      0140
*     GPR01F,                                                      0140
*     GPR14F,                                                      0140
*     GPR15F)RESTRICTED;                                           0140
*                                                                  0140
*   /*****************************************************************/
*   /*                                                               */
*   /* SET SUBPOOL AND LENGTH INTO REGISTER ZERO. THESE EXIST IN WORD*/
*   /* PRECEDING DTMVT                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0141
*   GPR00F=(ADDR(DTMVT)-LENGTH(RGSBPLLN))->RGSBPLLN;               0141
         L     @10,@PC00001                                        0141
         L     @10,MFSEDTMV(,@10)                                  0141
         SH    @10,@CH00065                                        0141
         L     GPR00F,RGSBPLLN(,@10)                               0141
*   GPR01P=ADDR(DTMVT)-LENGTH(RGSBPLLN);/* ADDRESS TO REG 1          */
         LR    GPR01P,@10                                          0142
*   GENERATE;                                                      0143
         FREEMAIN R,LV=(0),A=(1)
*   RESPECIFY                                                      0144
*    (GPR00F,                                                      0144
*     GPR01F,                                                      0144
*     GPR14F,                                                      0144
*     GPR15F)UNRESTRICTED;                                         0144
*                                                                  0144
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE MESSAGE IRB101I MF/1 REPORT AVAILABLE FOR PRINTING IF   */
*   /* THIS IS A REALTIME REPORT.                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0145
*   IF MFCOREPV=RGREALTM THEN       /* IF REPORT OPTION IS REALTIME  */
         L     @10,@PC00001                                        0145
         L     @10,MFSECOA(,@10)                                   0145
         TM    MFCOREPV(@10),B'00000010'                           0145
         BNO   @RF00145                                            0145
         TM    MFCOREPV(@10),B'00000001'                           0145
         BNZ   @RF00145                                            0145
*     DO;                                                          0146
*                                                                  0146
*       /*************************************************************/
*       /*                                                           */
*       /* LOAD MESSAGE MODULE                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0147
*       RGMODULE='IRBMFMPR';        /* MODULE TO LOAD                */
         MVC   RGMODULE(8),@CC00664                                0147
*       RESPECIFY                                                  0148
*        (GPR00F,                                                  0148
*         GPR01F,                                                  0148
*         GPR14F,                                                  0148
*         GPR15F)RESTRICTED;                                       0148
*       GENERATE REFS(RGMODULE);                                   0149
RGLOAD6  LOAD  EPLOC=RGMODULE,RELATED=(MFRGLMPR,IRBMFRGM(RGLOAD7))
*       RGENTRYP=GPR00P;            /* SAVE ENTRY POINT FOR CALL     */
         LR    RGENTRYP,GPR00P                                     0150
*       RESPECIFY                                                  0151
*        (GPR00F,                                                  0151
*         GPR01F,                                                  0151
*         GPR14F,                                                  0151
*         GPR15F)UNRESTRICTED;                                     0151
*                                                                  0151
*       /*************************************************************/
*       /*                                                           */
*       /* CALL MESSAGE MODULE                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0152
*       CALL IRBMFMPR(MID101I,      /* MESSAGE INDEX NUMBER          */
*           RGSADDR,                /* DUMMY VARIABLE TEXT/PART LIST */
*           RGSADDR,                /* DUMMY REPLY BUFFER ADDRESS    */
*           RGSADDR);               /* DUMMY DCB ADDRESS             */
*                                                                  0152
         LR    @15,RGENTRYP                                        0152
         LA    @01,@AL00152                                        0152
         BALR  @14,@15                                             0152
*       /*************************************************************/
*       /*                                                           */
*       /* DELETE MESSAGE MODULE                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0153
*       RESPECIFY                                                  0153
*        (GPR00F,                                                  0153
*         GPR01F,                                                  0153
*         GPR14F,                                                  0153
*         GPR15F)RESTRICTED;                                       0153
*       GENERATE REFS(RGMODULE);                                   0154
RGLOAD7  DELETE EPLOC=RGMODULE,RELATED=(MFRGLMPR,IRBMFRGM(RGLOAD6))
*       RESPECIFY                                                  0155
*        (GPR00F,                                                  0155
*         GPR01F,                                                  0155
*         GPR14F,                                                  0155
*         GPR15F)UNRESTRICTED;                                     0155
*     END;                                                         0156
*                                                                  0156
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE CONVERSION MODULE                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0157
*   RGMODULE='IRBMFCNV';                                           0157
@RF00145 MVC   RGMODULE(8),@CC00665                                0157
*   RESPECIFY                                                      0158
*    (GPR00F,                                                      0158
*     GPR01F,                                                      0158
*     GPR14F,                                                      0158
*     GPR15F)RESTRICTED;                                           0158
*   GENERATE REFS(RGMODULE);                                       0159
RGLOAD8  DELETE EPLOC=RGMODULE,RELATED=(MFRGLCNV,IRBMFRGM(RGLOAD1))
*   RESPECIFY                                                      0160
*    (GPR00F,                                                      0160
*     GPR01F,                                                      0160
*     GPR14F,                                                      0160
*     GPR15F)UNRESTRICTED;                                         0160
*                                                                  0160
*   /*****************************************************************/
*   /*                                                               */
*   /* CANCEL ESTAE ENVIRONMENT                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0161
*   RESPECIFY                                                      0161
*    (GPR00F,                                                      0161
*     GPR01F,                                                      0161
*     GPR14F,                                                      0161
*     GPR15F)RESTRICTED;                                           0161
*   GENERATE SETS(RGESTAPL);                                       0162
         ESTAE 0,MF=(E,RGESTAPL)
*   IF GPR15F^=0 THEN               /* IMPOSSIBLE RETURN CODE        */
         LTR   GPR15F,GPR15F                                       0163
         BZ    @RF00163                                            0163
*     DO;                                                          0164
*       RGERRCDE=3;                 /* IMPOSSIBLE RETURN CODE FROM 0165
*                                      ESTAE CANCEL                  */
         MVC   RGERRCDE(2),@CH00127                                0165
*       GO TO RGERR2;               /* ABEND                         */
         B     RGERR2                                              0166
*     END;                                                         0167
*   RESPECIFY                                                      0168
*    (GPR00F,                                                      0168
*     GPR01F,                                                      0168
*     GPR14F,                                                      0168
*     GPR15F)UNRESTRICTED;                                         0168
@RF00163 DS    0H                                                  0169
*   RETURN CODE(0);                 /* TERMINATE MF1 REPORT SUBTASK. */
*                                                                  0169
         L     @13,4(,@13)                                         0169
         L     @00,@SIZDATD                                        0169
         LR    @01,@11                                             0169
         FREEMAIN R,LV=(0),A=(1)
         SR    @15,@15                                             0169
         L     @14,12(,@13)                                        0169
         LM    @00,@12,20(@13)                                     0169
         BR    @14                                                 0169
*   /*****************************************************************/
*   /*                                                               */
*   /* OPEN ERROR COMES HERE                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0170
*RGERR1:                                                           0170
*   GENERATE(ABEND 1300,DUMP);                                     0170
*                                                                  0170
RGERR1   ABEND 1300,DUMP
*   /*****************************************************************/
*   /*                                                               */
*   /* UNEXPECTED RETURN CODES COME HERE                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0171
*RGERR2:                                                           0171
*                                                                  0171
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0171
*   RESPECIFY                                                      0171
*    (GPR15P)RESTRICTED;                                           0171
RGERR2   DS    0H                                                  0172
*   GPR15P=RGERRCDE;                /* CODE TO REGISTER              */
*                                                                  0172
         LH    GPR15P,RGERRCDE                                     0172
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0173
*   RESPECIFY                                                      0173
*    (GPR15P)UNRESTRICTED;                                         0173
*   GENERATE(ABEND 1301,DUMP);                                     0174
         ABEND 1301,DUMP
*                                                                  0175
*/*                                                                  */
*/*** START OF SPECIFICATIONS ****************************************
*                                                                    */
*/*                                                                  */
*/* SUBROUTINE-NAME = MFISRTXT                                       */
*/*                                                                  */
*/* DESCRIPTIVE-NAME = REPORT INSERT TEXT ROUTINE                    */
*/*                                                                  */
*/* FUNCTION = INSERTS TEXT INTO THE INTERNAL PAGE IMAGE.            */
*/*                                                                  */
*/* ENTRY-POINT = MFISRTXT                                           */
*/*                                                                  */
*/*    PURPOSE = SEE FUNCTION                                        */
*/*                                                                  */
*/*    LINKAGE = R1 - PARAMETER LIST ADDRESS                         */
*/*                                                                  */
*/* INPUT = PARAMETER 1 - TEXT TO INSERT                             */
*/*         PARAMETER 2 - LENGTH OF TEXT TO INSERT                   */
*/*         PARAMETER 3 - BEGINNING LINE                             */
*/*         PARAMETER 4 - BEGINNING COLUMN                           */
*/*                                                                  */
*/**** END OF SPECIFICATIONS *****************************************
*                                                                    */
*/*                                                                  */
*/* INSERT TEXT PROCEDURE                                            */
*                                                                  0175
*MFISRTXT:                                                         0175
*   PROCEDURE(ISTEXT,               /* TEXT TO BE INSERTED INTO THE
*                                      INTERNAL PAGE IMAGE           */
*       ISTXTLEN,                   /* LENGTH OF TEXT                */
*       ISBEGLIN,                   /* BEGINNING LINE                */
*       ISBEGCOL)                   /* BEGINNING COLUMN              */
*       ;                                                          0175
         B     @PB00002                                            0175
MFISRTXT STM   @14,@12,12(@13)                                     0175
         MVC   @PC00002(16),0(@01)                                 0175
*                                                                  0176
*/* BEGIN MISCELLANEOUS DECLARATION                                  */
*                                                                  0176
*   DECLARE                                                        0176
*     ISTEXT                        /* PARAMETER 1 - TEXT TO BE    0176
*                                      INSERTED INTO THE INTERNAL  0176
*                                      PAGE IMAGE                    */
*         CHARACTER(*),                                            0176
*     ISTXTLEN                      /* PARAMETER 2 - TEXT LENGTH     */
*         FIXED BINARY(31),                                        0176
*     ISBEGLIN                      /* PARAMETER 3 - LINE ON WHICH TO
*                                      BEGIN INSERTING TEXT          */
*         FIXED BINARY(31),                                        0176
*     ISBEGCOL                      /* PARAMETER 4 - COLUMN ON WHICH
*                                      TO BEGIN INSERTING TEXT       */
*         FIXED BINARY(31),                                        0176
*     ISLSTCOL                      /* LAST COLUMN - TEMPORARY VBL.  */
*         FIXED BINARY(31);                                        0176
*                                                                  0177
*/* BEGIN MAINLINE PROCESSING                                        */
*                                                                  0177
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK PARAMETERS FOR VALIDITY                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0177
*   ISLSTCOL=ISBEGCOL+ISTXTLEN-1;                                  0177
*                                                                  0177
         L     @10,@PC00002+12                                     0177
         L     @10,ISBEGCOL(,@10)                                  0177
         L     @15,@PC00002+4                                      0177
         L     @15,ISTXTLEN(,@15)                                  0177
         LR    ISLSTCOL,@10                                        0177
         AR    ISLSTCOL,@15                                        0177
         BCTR  ISLSTCOL,0                                          0177
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TEMPORARY VARIABLE FOR LAST COLUMN IN WHICH TO INSERT  */
*   /* TEXT                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0178
*   IF ISTXTLEN<=0                 /* NO TEXT TO INSERT             */
*       ISBEGLIN<=0                /* BEGINNING LINE NEGATIVE OR  0178
*                                      ZERO                          */
*       ISBEGCOL<=0                /* BEGINNING COLUMN NEGATIVE OR
*                                      ZERO                          */
*       ISBEGLIN>RGMAXLN           /* BEGINNING LINE HIGHER THAN  0178
*                                      MAXIMUM LINE NUMBER           */
*       ISLSTCOL>RGMAXCOL THEN      /* TEXT WILL NOT FIT ON LINE     */
         SR    @05,@05                                             0178
         CR    @15,@05                                             0178
         BNH   @RT00178                                            0178
         L     @15,@PC00002+8                                      0178
         L     @15,ISBEGLIN(,@15)                                  0178
         CR    @15,@05                                             0178
         BNH   @RT00178                                            0178
         CR    @10,@05                                             0178
         BNH   @RT00178                                            0178
         CH    @15,@CH00339                                        0178
         BH    @RT00178                                            0178
         CH    ISLSTCOL,@CH00372                                   0178
         BNH   @RF00178                                            0178
@RT00178 DS    0H                                                  0179
*     RETURN CODE(4);               /* RETURN TO REPORT GENERATOR.   */
         LA    @15,4                                               0179
         L     @14,12(,@13)                                        0179
         LM    @00,@12,20(@13)                                     0179
         BR    @14                                                 0179
*   RGLINE(ISBEGLIN,ISBEGCOL:ISLSTCOL)=ISTEXT(1:ISTXTLEN);/* INSERT
*                                      TEXT                          */
@RF00178 L     @10,@PC00002+8                                      0180
         L     @10,ISBEGLIN(,@10)                                  0180
         LR    @05,@10                                             0180
         MH    @05,@CH00789                                        0180
         L     @15,@PC00002+12                                     0180
         L     @15,ISBEGCOL(,@15)                                  0180
         LR    @14,@05                                             0180
         AR    @14,@15                                             0180
         LA    @01,RGLINE-127(@14)                                 0180
         LCR   @15,@15                                             0180
         AR    @15,ISLSTCOL                                        0180
         L     @14,@PC00002                                        0180
         EX    @15,@SM00796                                        0180
*   RGLENGTH(ISBEGLIN)=MAX(RGLENGTH(ISBEGLIN),ISLSTCOL);/* SET NEW 0181
*                                      LENGTH FOR RECORD             */
         LH    @15,RGLENGTH-126(@05)                               0181
         CR    @15,ISLSTCOL                                        0181
         BNL   *+6
         LR    @15,ISLSTCOL                                        0181
         STH   @15,RGLENGTH-126(@05)                               0181
*   RGLASTLN=MAX(RGLASTLN,ISBEGLIN);/* SET NEW LAST LINE CONTAINING
*                                      NON-BLANK CHARACTERS          */
         LH    @15,RGLASTLN                                        0182
         CR    @15,@10                                             0182
         BNL   *+6
         LR    @15,@10                                             0182
         STH   @15,RGLASTLN                                        0182
*   RETURN CODE(0);                 /* RETURN TO REPORT GENERATOR.   */
         SR    @15,@15                                             0183
         L     @14,12(,@13)                                        0183
         LM    @00,@12,20(@13)                                     0183
         BR    @14                                                 0183
*   END;                                                           0184
*                                                                  0185
*/*                                                                  */
*/*** START OF SPECIFICATIONS ****************************************
*                                                                    */
*/*                                                                  */
*/* SUBROUTINE-NAME = MFHRDISR                                       */
*/*                                                                  */
*/* DESCRIPTIVE-NAME = REPORT HEADER INSERTION ROUTINE               */
*/*                                                                  */
*/* FUNCTION = BUILDS AND INSERTS A STANDARD REPORT HEADER INTO THE  */
*/*            INTERNAL PAGE IMAGE.  DATA IS OBTAINED FROM AN SMF    */
*/*            RECORD HEADER WHICH IS PASSED ON INPUT.               */
*/*                                                                  */
*/* ENTRY-POINT = MFHDRISR                                           */
*/*                                                                  */
*/*    PURPOSE = SEE FUNCTION                                        */
*/*                                                                  */
*/*    LINKAGE = R1 - PARAMETER LIST ADDRESS                         */
*/*                                                                  */
*/* INPUT = PARAMETER 1 - ADDRESS OF SMF RECORD HEADER AND MF/1      */
*/*                       COMMON CONTROL DATA AREA                   */
*/*         PARAMETER 2 - TITLE TEXT                                 */
*/*         PARAMETER 3 - TITLE LENGTH                               */
*/*         PARAMETER 4 - PAGE NUMBER                                */
*/*                                                                  */
*/**** END OF SPECIFICATIONS *****************************************
*                                                                    */
*/*                                                                  */
*/* HEADER SUBROUTINE                                                */
*                                                                  0185
*MFHDRISR:                                                         0185
*   PROCEDURE(HDRECPTR,             /* POINTER TO INTERNAL IMAGE OF
*                                      AN SMF RECRD                  */
*       HDTITLE,                    /* TITLE TEXT                    */
*       HDTITLEN,                   /* TITLE LENGTH                  */
*       HDPAGE)                     /* PAGE NUMBER                   */
*       ;                                                          0185
MFHDRISR STM   @14,@12,@SA00003                                    0185
         MVC   @PC00003(16),0(@01)                                 0185
*                                                                  0186
*/* BEGIN MACRO DECLARATIONS                                         */
*                                                                  0186
*   /*****************************************************************/
*   /*                                                               */
*   /* INCLUDE A DECLARATION FOR THE SMF HEADER AND COMMON MF/1      */
*   /* CONTROL DATA. ANY MF/1-GENERATED SMF RECORD WILL DO           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0186
*/*                                                                  */
*/*  MACMEAN IFASMFR MEANS SYSTEM MANAGEMENT FACILITY RECORD MAPPING */
*/*  MACCOMP Y-2 SC102/BL27P                                         */
*/*  MACSTAT Y-2 73298/42020                                         */
*/*  METHOD OF ACCESS                                                */
*/*   PL/S - USER DEFINES MACRO VARIABLE IFARXX WHERE XX=RECORD NUM  */
*/*          DECLARE SMFXXPTR PTR(31) OR RESPECIFY FOR BASE          */
*/*          INCLUDE MACRO FROM LIBRARY                              */
*/*           EXAMPLE %IFAR08 = 'YES',           NOTE. THE COMMA REP-*/
*/*                   DCL SMF08PTR PTR(31),      RESENTS A SEMI-COLON*/
*/*                   %INCLUDE SYSLIB(IFASMFR),  BUT ISN'T TO AVIOD  */
*/*                                              A DIAGNOSTIC.       */
*/*           ALLOWABLE RECORD TYPES ARE 00,02-11,14,17-22,26,       */
*/*           31,34,35,40,43,45,47-49,62,64,68-74.                   */
*/*           15 CAN BE SPECIFIED BUT TYPE 14 IS CREATED FOR IT.     */
*                                                                  0186
*   DCL                                                            0186
*     1 SMFRCD70 BASED(SMF70PTR)BDY(WORD),                         0186
*                                                                  0186
*/* RECORD TYPE 70 - CPU ACTIVITY                                    */
*                                                                  0186
*       3 SMF70LEN FIXED(15),       /* RDW RECORD LENGTH             */
*       3 SMF70SEG FIXED(15),       /* RDW SEGMENT DESCRIPTOR        */
*       3 SMF70FLG BIT(8),          /* OPERATING ENVIRONMENT         */
*       3 SMF70RTY FIXED(8),        /* RECORD TYPE 70                */
*       3 SMF70TME FIXED(31)BDY(BYTE),/* TOD RECORD WRITTEN          */
*       3 SMF70DTE CHAR(4),         /* DATE RECORD WRITTEN           */
*       3 SMF70SID CHAR(4),         /* SYSTEM ID FROM INSTALLATION   */
*                                                                  0186
*         /***********************************************************/
*         /*                                                         */
*         /* COMMON CONTROL DATA                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0186
*       3 SMF70SIZ PTR(15),         /* SIZE OF COMMON CONTROL DATA 0186
*                                      AREA                          */
*       3 SMF70IST CHAR(4),         /* TOD INTERVAL START 0HHMMSSF   */
*       3 SMF70DAT CHAR(4),         /* DATE INTERVAL START 00YYDDDF  */
*       3 SMF70INT CHAR(4),         /* DURATION OF INTERVAL MMSSTTTF */
*       3 SMF70CYC CHAR(2),         /* RESV                          */
*       3 SMF70SUB CHAR(2),         /* RESV                          */
*       3 SMF70SAM FIXED(32),       /* RESV                          */
*       3 SMF70MFV CHAR(2),         /* MF/1 VERSION #                */
*       3 SMF70RV1 CHAR(2),         /* RESV                          */
*       3 SMF70RLS CHAR(4);         /* OP SYS REL # & LEVEL NNLL     */
*                                                                  0186
*/* CPU CONTROL AREA VARIABLES                                       */
*                                                                  0187
*   DCL                                                            0187
*     1 SMF70A BASED(ADDR(SMF70SIZ)+SMF70SIZ)BDY(WORD),            0187
*       3 SMF70SCC PTR(15),         /* SIZE OF CPU CONTROL AREA      */
*       3 SMF70CPU FIXED(15),       /* # CPU MEASUREMENTS IN CPU DATA*/
*       3 SMF70SCD FIXED(15),       /* SIZE OF EACH CPU DATA AREA    */
*       3 SMF70RV2 CHAR(2);         /* RESV                          */
*                                                                  0187
*/* CPU DATA AREA VARIABLES                                          */
*                                                                  0188
*   DCL                                                            0188
*     1 SMF70B(*)BASED(ADDR(SMF70SCC)+SMF70SCC)BDY(WORD),          0188
*       3 SMF70WAT CHAR(8),         /* CPU WAIT, TOD CLOCK FORMAT    */
*       3 SMF70CID FIXED(15),       /* CPU IDENTIFIER                */
*       3 SMF70RV3 CHAR(1),         /* RESV                          */
*       3 SMF70CNF BIT(8),          /* CONFIGURATION ACTIVITY        */
*         5 * BIT(6),               /* RESV                          */
*         5 SMF70VAC BIT(1),        /* DATA INVALID, VARIED ON OR OFF*/
*         5 SMF70STA BIT(1),        /* =1 FOR ONLINE AT END OF     0188
*                                      INTERVAL                      */
*       3 SMF70RV4 CHAR(1),         /* RESV                          */
*       3 SMF70SER CHAR(3);         /* CPU SERIAL # FORM HHHHHH      */
*                                                                  0189
*/* BEGIN MISCELLANEOUS DECLARATIONS                                 */
*                                                                  0189
*   DECLARE                                                        0189
*     HDRECPTR                      /* PARAMETER 1 - POINTER TO    0189
*                                      INTERNAL SMF RECORD IMAGE     */
*         POINTER(31),                                             0189
*     HDTITLE                       /* PARAMETER 2 - TITLE TEXT TO BE
*                                      INSERTED                      */
*         CHARACTER(*),                                            0189
*     HDTITLEN                      /* PARAMETER 3 - TITLE LENGTH    */
*         FIXED BINARY(31),                                        0189
*     HDPAGE                        /* PARAMETER 4 - PAGE NUMBER     */
*         FIXED BINARY(31),                                        0189
*     SMF70PTR                      /* UNUSED SMF RECORD POINTER     */
*         POINTER(31)BASED,                                        0189
*     HDWRKSTR                      /* WORKING STRING                */
*         CHARACTER(20),                                           0189
*     HDUNPKST                      /* STRING USED TO UNPACK PACKED
*                                      DECIMAL DATA                  */
*         CHARACTER(7),                                            0189
*     HDDAYS                        /* DAYS IN MONTH                 */
*         (12)FIXED BINARY(15)INITIAL(31,/* JANUARY                  */
*         28,                       /* FEBRUARY                      */
*         31,                       /* MARCH                         */
*         30,                       /* APRIL                         */
*         31,                       /* MAY                           */
*         30,                       /* JUNE                          */
*         31,                       /* JULY                          */
*         31,                       /* AUGUST                        */
*         30,                       /* SEPTEMBER                     */
*         31,                       /* OCTOBER                       */
*         30,                       /* NOVEMBER                      */
*         31),                      /* DECEMBER                      */
*     HDRELEAS                      /* FIXED BINARY OS/VS SYSTEM   0189
*                                      NUMBER                        */
*         FIXED BINARY(8)DEFINED(SMF70FLG),                        0189
*     HDTOTDAY                      /* USED TO CALCULATE MONTH AND 0189
*                                      DAY FROM THE JULIAN DATE      */
*         FIXED BINARY(31),                                        0189
*     HDBINDAY                      /* BINARY DAY OF MONTH           */
*         FIXED BINARY(31),                                        0189
*     HDBINYR                       /* BINARY YEAR                   */
*         FIXED BINARY(31),                                        0189
*     HDCVBSRC                      /* CONVERT TO BINARY INSTRUCTION
*                                      SOURCE FIELD                  */
*         CHARACTER(2),                                            0189
*     HDLOOPV                       /* LOOP VARIABLE                 */
*         FIXED BINARY(31),                                        0189
*     HDBINMO                       /* MONTH OF YEAR IN BINARY       */
*         FIXED BINARY(31),                                        0189
*     IRBMFLTV                      /* LANGUAGE PART VECTOR TABLE    */
*         (*)POINTER(31)EXTERNAL NONLOCAL;                         0189
*                                                                  0190
*/* MACRO DECLARATIONS                                               */
*/*  LANGUAGE PARTS TABLE                                            */
*/**** START OF SPECIFICATIONS ***************************************/
*/*                                                                  */
*/* MACCOMP Y-2 SC1CQ/GAM20                                          */
*/* MACSTAT Y-2 73121/Y02150                                         */
*/* MACMEAN MFLNG MEANS LANGUAGE PARTS                               */
*/*                                                                  */
*/* MODULE-NAME = IRBMFLNG                                           */
*/*                                                                  */
*/* DESCRIPTIVE-NAME = LANGUAGE PARTS                                */
*/*                                                                  */
*/* COPYRIGHT = NONE                                                 */
*/*                                                                  */
*/* STATUS = RELEASE 2, VERSION 0                                    */
*/*                                                                  */
*/* FUNCTION = MAPPING MACRO FOR THE MFLNG.  IT DEFINES THE LOCATION */
*/*            AND SIZE OF MF/1 COMMON-LANGUAGE PARTS.               */
*/*                                                                  */
*/* NOTES = SEE BELOW                                                */
*/*                                                                  */
*/* MODULE-TYPE = PLS MAPPING MACRO                                  */
*/*                                                                  */
*/* CHANGE-ACTIVITY =                                                */
*/*                                                                  */
*/* A000000-999999                                             Y02150*/
*/*                                                                  */
*/* METHOD-OF-INVOCATION = SEE BELOW                                 */
*/*                                                                  */
*/*    PLS - .QUESTION MARK.IRBMFLNG ATTRIBUT(ATTRIBUTES)            */
*/*          WHERE ATTRIBUTES ARE ANY ACCEPTABLE PLS ATTRIBUTES      */
*/*          FOR STRUCTURE DECLARATIONS.                             */
*/*                                                                  */
*/**** END OF SPECIFICATIONS *****************************************/
*                                                                  0190
*   /*****************************************************************/
*   /*                                                               */
*   /* ?IRBMFLNG ATTRIBUT(DEFINED(IRBMFLTV))                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0190
*   DECLARE                                                        0190
*     1 LNG                         /* LANGUAGE PARTS                */
*           DEFINED(IRBMFLTV)BDY(WORD),                            0190
*      2 LNGTPTR                    /* TEXT POINTER                  */
*            (*)PTR(31),                                           0190
*     1 LNGTXT                      /* TEXT                          */
*           BDY(WORD)BASED,                                        0190
*      2 LNGTXTL                    /* TEXT LENGTH                   */
*            FIXED(31),                                            0190
*      2 LNGTXTD                    /* TEXT DATA                     */
*            CHAR(*);                                              0190
*                                                                  0190
*/*  LANGUAGE PARTS CONSTANTS                                        */
*/*                                                                  */
*/**** START OF SPECIFICATIONS ***************************************/
*/*                                                                  */
*/* MACCOMP Y-2 SC1CQ/GAM20                                          */
*/* MACSTAT Y-2 73114/Y02150                                         */
*/*                                                                  */
*/* MODULE-NAME = IRBMFLTM                                           */
*/*                                                                  */
*/* DESCRIPTIVE-NAME = LANGUAGE PART INDEX CONSTANTS FOR LANGUAGE    */
*/*                    PARTS MODULE IRBMFLTV                         */
*/*                                                                  */
*/* COPYRIGHT = NONE                                                 */
*/*                                                                  */
*/* STATUS = RELEASE 2 / VERSION 0                                   */
*/*                                                                  */
*/* FUNCTION = PROVIDES SYMBOLIC NAMES FOR REFERENCES TO LANGUAGE    */
*/*            PARTS                                                 */
*/*                                                                  */
*/* NOTES = NONE                                                     */
*/*                                                                  */
*/* MODULE-TYPE = PLS MACRO                                          */
*/*                                                                  */
*/* CHANGE-ACTIVITY = SEE BELOW                                      */
*/*                                                                  */
*/* A000000-999999                                             Y02150*/
*/*                                                                  */
*/* METHOD-OF-INVOCATION = SEE BELOW                                 */
*/*                                                                  */
*/*    PLS - %INCLUDE DDNAME(IRBMFLTM)                               */
*/*                                                                  */
*/**** END OF SPECIFICATIONS *****************************************/
*/*                                                                  */
*                                                                  0191
*   DECLARE                                                        0191
*     LTPART1                       /* 'PAGE '                       */
*         FIXED BINARY(31)CONSTANT(1),                             0191
*     LTPART2                       /* 'OS/VS'                       */
*         FIXED BINARY(31)CONSTANT(2),                             0191
*     LTPART3                       /* 'RELEASE '                    */
*         FIXED BINARY(31)CONSTANT(3),                             0191
*     LTPART4                       /* 'SYSTEM ID '                  */
*         FIXED BINARY(31)CONSTANT(4),                             0191
*     LTPART5                       /* 'MF/1 VERSION '               */
*         FIXED BINARY(31)CONSTANT(5),                             0191
*     LTPART6                       /* 'DATE '                       */
*         FIXED BINARY(31)CONSTANT(6),                             0191
*     LTPART7                       /* 'TIME '                       */
*         FIXED BINARY(31)CONSTANT(7),                             0191
*     LTPART8                       /* 'INTERVAL '                   */
*         FIXED BINARY(31)CONSTANT(8),                             0191
*     LTPART9                       /* 'CYCLE '                      */
*         FIXED BINARY(31)CONSTANT(9),                             0191
*     LTPART10                      /* ' SECONDS'                    */
*         FIXED BINARY(31)CONSTANT(10);                            0191
*                                                                  0192
*/* BEGIN CONSTANTS DECLARATIONS                                     */
*                                                                  0192
*   DECLARE                                                        0192
*     HDDALEAP                      /* EXTRA DAY IN LEAP YEAR CYCLE. */
*         CONSTANT(1),                                             0192
*     HDMONFEB                      /* MONTH NUMBER OF FEBRUARY.     */
*         CONSTANT(2),                                             0192
*     HDYRLEAP                      /* YEARS IN LEAP YEAR CYCLE.     */
*         CONSTANT(4),                                             0192
*     HDNOSAMP                      /* SMF CYCLE FIELD VALUE WHEN  0192
*                                      SAMPLING IS NOT USED - CYCLE=0*/
*         BIT(16)CONSTANT('000F'X);                                0192
*                                                                  0193
*/* BEGIN GENERAL INITIALIZATION                                     */
*                                                                  0193
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDE ADDRESSABILITY FOR SMF RECORD INTERNAL HEADER         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0193
*   RESPECIFY                                                      0193
*     SMFRCD70 BASED(HDRECPTR);                                    0193
*                                                                  0194
*/* BEGIN MAINLINE PROCESSING                                        */
*                                                                  0194
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT TITLE UP TO MAXIMUM LENGTH OF RGMAXCOL COLUMN          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0194
*   IF HDTITLEN>0 THEN              /* IF A TITLE IS DESIRED         */
         L     @10,@PC00003+8                                      0194
         L     @10,HDTITLEN(,@10)                                  0194
         LTR   @10,@10                                             0194
         BNP   @RF00194                                            0194
*     CALL MFISRTXT(                /* TEXT INSERTION ROUTINE        */
*                                                                  0195
*     /***************************************************************/
*     /*                                                             */
*     /* TITLE TO INSERT                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0195
*         HDTITLE,                                                 0195
*                                                                  0195
*     /***************************************************************/
*     /*                                                             */
*     /* TITLE LENGTH                                                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0195
*         MIN(HDTITLEN,RGMAXCOL),                                  0195
*                                                                  0195
*     /***************************************************************/
*     /*                                                             */
*     /* INSERTION LINE                                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0195
*         RGHDR1,                                                  0195
*                                                                  0195
*     /***************************************************************/
*     /*                                                             */
*     /* INSERTION COLUMN (CENTERED)                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0195
*         (RGMAXCOL-MIN(HDTITLEN,RGMAXCOL))/2+1);                  0195
*                                                                  0195
         L     @15,@PC00003+4                                      0195
         ST    @15,@AL00001                                        0195
         LA    @15,120                                             0195
         CR    @10,@15                                             0195
         BNH   *+6
         LR    @10,@15                                             0195
         ST    @10,@AFTEMPS                                        0195
         LA    @14,@AFTEMPS                                        0195
         ST    @14,@AL00001+4                                      0195
         LA    @14,@CF00072                                        0195
         ST    @14,@AL00001+8                                      0195
         LR    @00,@15                                             0195
         SR    @00,@10                                             0195
         SRDA  @00,32                                              0195
         D     @00,@CF00089                                        0195
         AH    @01,@CH00072                                        0195
         ST    @01,@AFTEMPS+4                                      0195
         LA    @10,@AFTEMPS+4                                      0195
         ST    @10,@AL00001+12                                     0195
         LA    @01,@AL00001                                        0195
         BAL   @14,MFISRTXT                                        0195
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT PAGE XXXX                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0196
*   HDWRKSTR(1:5)=LNGTPTR(LTPART1)->LNGTXTD(1:LNGTPTR(LTPART1)->LNGTXTL
*       );                                                         0196
@RF00194 MVI   HDWRKSTR+1,C' '                                     0196
         MVC   HDWRKSTR+2(3),HDWRKSTR+1                            0196
         L     @10,@CA00736                                        0196
         L     @10,LNGTPTR-IRBMFLTV(,@10)                          0196
         L     @15,LNGTXTL(,@10)                                   0196
         BCTR  @15,0                                               0196
         EX    @15,@SM00798                                        0196
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */
*       HDPAGE,                     /* BINARY INPUT                  */
*       0,                          /* INPUT SCALE FACTOR            */
*       HDWRKSTR(6:9),              /* OUTPUT STRING                 */
*       4,                          /* OUTPUT STRING LENGTH          */
*       0,                          /* DIGITS TO THE RIGHT OF THE  0197
*                                      DECIMAL POINT ON OUTPUT       */
*       '0'B,                       /* NO COMMAS                     */
*       '0'B);                      /* NO FLOAT                      */
         MVC   @AL00001+4(24),@AL00197                             0197
         L     @10,@PC00003+12                                     0197
         ST    @10,@AL00001                                        0197
         LA    @10,HDWRKSTR+5                                      0197
         ST    @10,@AL00001+8                                      0197
         L     @15,RGVECTAB                                        0197
         LA    @01,@AL00001                                        0197
         BALR  @14,@15                                             0197
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */
*       HDWRKSTR,                   /* TEXT                          */
*       9,                          /* LENGTH                        */
*       2,                          /* START LINE                    */
*       RGMAXCOL-8);                /* START COLUMN                  */
*                                                                  0198
         MVC   @AL00001+4(12),@AL00198                             0198
         LA    @10,HDWRKSTR                                        0198
         ST    @10,@AL00001                                        0198
         LA    @01,@AL00001                                        0198
         BAL   @14,MFISRTXT                                        0198
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT OS/VSN                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0199
*   HDWRKSTR(1:5)=LNGTPTR(LTPART2)->LNGTXTD(1:LNGTPTR(LTPART2)->LNGTXTL
*       );                                                         0199
         MVI   HDWRKSTR+1,C' '                                     0199
         MVC   HDWRKSTR+2(3),HDWRKSTR+1                            0199
         L     @10,@CA00736                                        0199
         L     @10,LNGTPTR-IRBMFLTV+4(,@10)                        0199
         L     @15,LNGTXTL(,@10)                                   0199
         BCTR  @15,0                                               0199
         EX    @15,@SM00798                                        0199
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */
*       EVAL(HDRELEAS),             /* SYSTEM NUMBER IN FULLWORD     */
*       0,                          /* INTEGER INPUT                 */
*       HDWRKSTR(6),                /* OUTPUT STRING                 */
*       1,                          /* OUTPUT LENGTH                 */
*       0,                          /* INTEGER OUTPUT                */
*       '0'B,                       /* NO COMMAS                     */
*       '0'B);                      /* NO FLOAT                      */
         MVC   @AL00001+4(24),@AL00200                             0200
         L     @10,@PC00003                                        0200
         L     @10,HDRECPTR(,@10)                                  0200
         SR    @15,@15                                             0200
         IC    @15,HDRELEAS(,@10)                                  0200
         ST    @15,@AFTEMPS                                        0200
         LA    @10,@AFTEMPS                                        0200
         ST    @10,@AL00001                                        0200
         LA    @10,HDWRKSTR+5                                      0200
         ST    @10,@AL00001+8                                      0200
         L     @15,RGVECTAB                                        0200
         LA    @01,@AL00001                                        0200
         BALR  @14,@15                                             0200
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       HDWRKSTR,                   /* STRING TO INSERT              */
*       6,                          /* LENGTH                        */
*       RGHDR3,                     /* START LINE                    */
*       RGCOLA);                    /* START COLUMN                  */
*                                                                  0201
         MVC   @AL00001+4(12),@AL00201                             0201
         LA    @10,HDWRKSTR                                        0201
         ST    @10,@AL00001                                        0201
         LA    @01,@AL00001                                        0201
         BAL   @14,MFISRTXT                                        0201
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT RELEASE NN.NN                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0202
*   HDWRKSTR(1:8)=LNGTPTR(LTPART3)->LNGTXTD(1:LNGTPTR(LTPART3)->LNGTXTL
*       );                                                         0202
         MVI   HDWRKSTR+1,C' '                                     0202
         MVC   HDWRKSTR+2(6),HDWRKSTR+1                            0202
         L     @10,@CA00736                                        0202
         L     @10,LNGTPTR-IRBMFLTV+8(,@10)                        0202
         L     @15,LNGTXTL(,@10)                                   0202
         BCTR  @15,0                                               0202
         EX    @15,@SM00798                                        0202
*   HDWRKSTR(9:10)=SMF70RLS(1:2);                                  0203
         L     @10,@PC00003                                        0203
         L     @10,HDRECPTR(,@10)                                  0203
         MVC   HDWRKSTR+8(2),SMF70RLS(@10)                         0203
*   HDWRKSTR(11)='.';               /* INSERT SEPARATOR              */
         MVI   HDWRKSTR+10,C'.'                                    0204
*   HDWRKSTR(12:13)=SMF70RLS(3:4);                                 0205
         MVC   HDWRKSTR+11(2),SMF70RLS+2(@10)                      0205
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       HDWRKSTR,                   /* STRING TO INSERT              */
*       13,                         /* LENGTH                        */
*       RGHDR4,                     /* START LINE                    */
*       RGCOLA);                    /* START COLUMN                  */
*                                                                  0206
         MVC   @AL00001+4(12),@AL00206                             0206
         LA    @10,HDWRKSTR                                        0206
         ST    @10,@AL00001                                        0206
         LA    @01,@AL00001                                        0206
         BAL   @14,MFISRTXT                                        0206
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT SYSTEM ID XXXX                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0207
*   HDWRKSTR(1:10)=LNGTPTR(LTPART4)->LNGTXTD(1:LNGTPTR(LTPART4)->  0207
*       LNGTXTL);                                                  0207
         MVI   HDWRKSTR+1,C' '                                     0207
         MVC   HDWRKSTR+2(8),HDWRKSTR+1                            0207
         L     @10,@CA00736                                        0207
         L     @10,LNGTPTR-IRBMFLTV+12(,@10)                       0207
         L     @15,LNGTXTL(,@10)                                   0207
         BCTR  @15,0                                               0207
         EX    @15,@SM00798                                        0207
*   HDWRKSTR(11:14)=SMF70SID;       /* SYSTEM ID                     */
         L     @10,@PC00003                                        0208
         L     @10,HDRECPTR(,@10)                                  0208
         MVC   HDWRKSTR+10(4),SMF70SID(@10)                        0208
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */
*       HDWRKSTR,                   /* TEXT                          */
*       14,                         /* LENGTH                        */
*       RGHDR3,                     /* START LINE                    */
*       RGCOLB);                    /* START COLUMN                  */
*                                                                  0209
         MVC   @AL00001+4(12),@AL00209                             0209
         LA    @10,HDWRKSTR                                        0209
         ST    @10,@AL00001                                        0209
         LA    @01,@AL00001                                        0209
         BAL   @14,MFISRTXT                                        0209
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT MF/1 VERSION NN                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0210
*   HDWRKSTR(1:13)=LNGTPTR(LTPART5)->LNGTXTD(1:LNGTPTR(LTPART5)->  0210
*       LNGTXTL);                                                  0210
         MVI   HDWRKSTR+1,C' '                                     0210
         MVC   HDWRKSTR+2(11),HDWRKSTR+1                           0210
         L     @10,@CA00736                                        0210
         L     @10,LNGTPTR-IRBMFLTV+16(,@10)                       0210
         L     @15,LNGTXTL(,@10)                                   0210
         BCTR  @15,0                                               0210
         EX    @15,@SM00798                                        0210
*   HDWRKSTR(14:15)=SMF70MFV;       /* MF/1 VERSION                  */
         L     @10,@PC00003                                        0211
         L     @10,HDRECPTR(,@10)                                  0211
         MVC   HDWRKSTR+13(2),SMF70MFV(@10)                        0211
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */
*       HDWRKSTR,                   /* TEXT                          */
*       15,                         /* LENGTH                        */
*       RGHDR4,                     /* START LINE                    */
*       RGCOLB);                    /* START COLUMN                  */
*                                                                  0212
         MVC   @AL00001+4(12),@AL00212                             0212
         LA    @10,HDWRKSTR                                        0212
         ST    @10,@AL00001                                        0212
         LA    @01,@AL00001                                        0212
         BAL   @14,MFISRTXT                                        0212
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT DATE MM/DD/YY. SOURCE IS JULIAN DATE IN FORM 00YYDDDF  */
*   /* FIRST CONVERT JULIAN DAY (DDD) INTO MONTH-DAY NOTATION (MMDD) */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*   CVB(HDBINDAY,SMF70DAT(3:4));    /* CONVERT DAY (DDDF) INTO BINARY*/
         L     @10,@PC00003                                        0213
         L     @10,HDRECPTR(,@10)                                  0213
         XC    @TS00001(8),@TS00001                                0213
         MVC   @TS00001+6(2),SMF70DAT+2(@10)                       0213
         CVB   @10,@TS00001                                        0213
         ST    @10,HDBINDAY                                        0213
*   HDCVBSRC='000F'X;               /* INITIALIZE CVB SOURCE FIELD   */
         MVC   HDCVBSRC(2),@CB00756                                0214
*   HDCVBSRC(1)=SMF70DAT(2);        /* MOVE IN YEAR TO GET FORMAT  0215
*                                      YY0F                          */
         L     @10,@PC00003                                        0215
         L     @10,HDRECPTR(,@10)                                  0215
         MVC   HDCVBSRC(1),SMF70DAT+1(@10)                         0215
*   CVB(HDBINYR,HDCVBSRC);          /* GET YEARS TIMES TEN IN BINARY */
         XC    @TS00001(8),@TS00001                                0216
         MVC   @TS00001+6(2),HDCVBSRC                              0216
         CVB   @10,@TS00001                                        0216
         ST    @10,HDBINYR                                         0216
*   HDBINYR=HDBINYR/10;             /* GET BINARY YEARS              */
*                                                                  0217
         L     @00,HDBINYR                                         0217
         SRDA  @00,32                                              0217
         D     @00,@CF00512                                        0217
         ST    @01,HDBINYR                                         0217
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW HAVE BINARY NUMBERS TO WORK WITH. SUM DAYS IN MONTH       */
*   /* ADJUSTING FOR LEAP YEAR UNTIL GREATER THAN JULIAN DAY.        */
*   /* (INDEX-1) WILL THEN BE THE MONTH                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0218
*   HDTOTDAY=0;                     /* SET ACCUMULATOR TO ZERO       */
         SR    HDTOTDAY,HDTOTDAY                                   0218
*   DO HDLOOPV=1 TO 12 WHILE(HDTOTDAY<HDBINDAY);                   0219
*                                                                  0219
         LA    HDLOOPV,1                                           0219
@DL00219 C     HDTOTDAY,HDBINDAY                                   0219
         BNL   @DC00219                                            0219
*     /***************************************************************/
*     /*                                                             */
*     /* TEST FOR FEBRUARY AND LEAP YEAR - FOR THE TWENTIETH CENTURY,*/
*     /* THE LEAP YEAR WILL BE DIVISIBLE BY 4                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0220
*     IF HDLOOPV=HDMONFEB&          /* TRUE = FEBRUARY               */
*         HDBINYR//HDYRLEAP=0 THEN  /* TRUE = LEAP YEAR              */
         CH    HDLOOPV,@CH00089                                    0220
         BNE   @RF00220                                            0220
         L     @00,HDBINYR                                         0220
         SRDA  @00,32                                              0220
         D     @00,@CF00065                                        0220
         LTR   @00,@00                                             0220
         BNZ   @RF00220                                            0220
*       HDTOTDAY=HDTOTDAY+HDDALEAP; /* INCREMENT FEBRUARY FOR LEAP 0221
*                                      YEAR                          */
         AH    HDTOTDAY,@CH00072                                   0221
*     HDTOTDAY=HDTOTDAY+HDDAYS(HDLOOPV);/* INCREMENT FOR DAYS IN   0222
*                                      MONTH                         */
@RF00220 LR    @10,HDLOOPV                                         0222
         AR    @10,@10                                             0222
         AH    HDTOTDAY,HDDAYS-2(@10)                              0222
*   END;                                                           0223
*                                                                  0223
         AH    HDLOOPV,@CH00072                                    0223
         CH    HDLOOPV,@CH00516                                    0223
         BNH   @DL00219                                            0223
@DC00219 DS    0H                                                  0224
*   /*****************************************************************/
*   /*                                                               */
*   /* (INDEX-1) IS NOW MONTH AND THE DAY OF MONTH MAY NOW BE        */
*   /* CALCULATED AND SAVED                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0224
*   HDBINMO=HDLOOPV-1;              /* INDEX-1 IS MONTH              */
         LR    @10,HDLOOPV                                         0224
         BCTR  @10,0                                               0224
         ST    @10,HDBINMO                                         0224
*   HDBINDAY=HDDAYS(HDBINMO)-(HDTOTDAY-HDBINDAY);                  0225
*                                                                  0225
         LR    @05,@10                                             0225
         AR    @05,@05                                             0225
         LR    @15,HDTOTDAY                                        0225
         S     @15,HDBINDAY                                        0225
         LCR   @15,@15                                             0225
         AH    @15,HDDAYS-2(@05)                                   0225
         ST    @15,HDBINDAY                                        0225
*   /*****************************************************************/
*   /*                                                               */
*   /* ADJUST DAY OF MONTH FOR LEAP YEAR                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0226
*   IF HDBINMO=HDMONFEB&            /* TRUE = FEBRUARY               */
*       HDBINYR//HDYRLEAP=0 THEN    /* TRUE =LEAP YEAR               */
         CH    @10,@CH00089                                        0226
         BNE   @RF00226                                            0226
         L     @00,HDBINYR                                         0226
         SRDA  @00,32                                              0226
         D     @00,@CF00065                                        0226
         LTR   @00,@00                                             0226
         BNZ   @RF00226                                            0226
*     HDBINDAY=HDBINDAY+HDDALEAP;                                  0227
*                                                                  0227
         AH    @15,@CH00072                                        0227
         ST    @15,HDBINDAY                                        0227
*   /*****************************************************************/
*   /*                                                               */
*   /* HDBINDAY NOW CONTAINS DAY OF MONTH. HDBINMO CONTAINS MONTH.   */
*   /* HDBINYR CONTAINS YEAR. BUILD STRING TO INSERT INTO PAGE IMAGE.*/
*   /* INSERT 'DATE '                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0228
*   HDWRKSTR(1:5)=LNGTPTR(LTPART6)->LNGTXTD(1:LNGTPTR(LTPART6)->LNGTXTL
*       );                                                         0228
@RF00226 MVI   HDWRKSTR+1,C' '                                     0228
         MVC   HDWRKSTR+2(3),HDWRKSTR+1                            0228
         L     @10,@CA00736                                        0228
         L     @10,LNGTPTR-IRBMFLTV+20(,@10)                       0228
         L     @15,LNGTXTL(,@10)                                   0228
         BCTR  @15,0                                               0228
         EX    @15,@SM00798                                        0228
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */
*       HDBINMO,                    /* INPUT MONTH IN BINARY         */
*       0,                          /* SCALE FACTOR FOR INPUT        */
*       HDWRKSTR(6:7),              /* OUTPUT STRING                 */
*       2,                          /* LENGTH                        */
*       0,                          /* DIGITS TO RIGHT OF DECIMAL IN
*                                      OUTPUT                        */
*       '0'B,                       /* NO COMMAS                     */
*       '0'B);                      /* NO FLOAT                      */
         MVC   @AL00001+4(24),@AL00229                             0229
         LA    @10,HDBINMO                                         0229
         ST    @10,@AL00001                                        0229
         LA    @10,HDWRKSTR+5                                      0229
         ST    @10,@AL00001+8                                      0229
         L     @15,RGVECTAB                                        0229
         LA    @01,@AL00001                                        0229
         BALR  @14,@15                                             0229
*   HDWRKSTR(8)='/';                /* INSERT SEPARATOR              */
         MVI   HDWRKSTR+7,C'/'                                     0230
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */
*       HDBINDAY,                   /* INPUT BINARY DAY              */
*       0,                          /* INPUT SCALE FACTOR            */
*       HDWRKSTR(9:10),             /* OUTPUT STRING                 */
*       2,                          /* LENGTH                        */
*       0,                          /* NO DIGITS TO RIGHT OF DECIMAL
*                                      ON OUTPUT                     */
*       '0'B,                       /* NO COMMAS                     */
*       '0'B);                      /* NO FLOAT                      */
         MVC   @AL00001+4(24),@AL00231                             0231
         LA    @10,HDBINDAY                                        0231
         ST    @10,@AL00001                                        0231
         LA    @10,HDWRKSTR+8                                      0231
         ST    @10,@AL00001+8                                      0231
         L     @15,RGVECTAB                                        0231
         LA    @01,@AL00001                                        0231
         BALR  @14,@15                                             0231
*   IF HDWRKSTR(9)=' ' THEN                                        0232
         CLI   HDWRKSTR+8,C' '                                     0232
         BNE   @RF00232                                            0232
*     HDWRKSTR(9)='0';              /* FILL IN LEADING ZERO          */
         MVI   HDWRKSTR+8,C'0'                                     0233
*   HDWRKSTR(11)='/';               /* INSERT SEPARATOR              */
@RF00232 MVI   HDWRKSTR+10,C'/'                                    0234
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */
*       HDBINYR,                    /* INPUT BINARY YEAR             */
*       0,                          /* INPUT SCALE FACTOR            */
*       HDWRKSTR(12:13),            /* OUTPUT STRING                 */
*       2,                          /* LENGTH                        */
*       0,                          /* DIGITS TO RIGHT OF DECIMAL  0235
*                                      POINT IN OUTPUT               */
*       '0'B,                       /* NO COMMAS                     */
*       '0'B);                      /* NO FLOAT                      */
         MVC   @AL00001+4(24),@AL00235                             0235
         LA    @10,HDBINYR                                         0235
         ST    @10,@AL00001                                        0235
         LA    @10,HDWRKSTR+11                                     0235
         ST    @10,@AL00001+8                                      0235
         L     @15,RGVECTAB                                        0235
         LA    @01,@AL00001                                        0235
         BALR  @14,@15                                             0235
*   IF HDWRKSTR(12)=' ' THEN        /* INSERT LEADING ZERO           */
         CLI   HDWRKSTR+11,C' '                                    0236
         BNE   @RF00236                                            0236
*     HDWRKSTR(12)='0';                                            0237
         MVI   HDWRKSTR+11,C'0'                                    0237
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */
*       HDWRKSTR,                   /* TEXT                          */
*       13,                         /* LENGTH                        */
*       RGHDR3,                     /* START LINE                    */
*       RGCOLC);                    /* START COLUMN                  */
*                                                                  0238
@RF00236 MVC   @AL00001+4(12),@AL00238                             0238
         LA    @10,HDWRKSTR                                        0238
         ST    @10,@AL00001                                        0238
         LA    @01,@AL00001                                        0238
         BAL   @14,MFISRTXT                                        0238
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT TIME HH/MM/SS                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0239
*   UNPK(HDUNPKST(1:6),SMF70IST);   /* UNPACK INTERVAL START TIME  0239
*                                      FROM 0HHMMSSF TO EBCDIC       */
*                                                                  0239
         L     @10,@PC00003                                        0239
         L     @10,HDRECPTR(,@10)                                  0239
         UNPK  HDUNPKST(6),SMF70IST(4,@10)                         0239
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT 'TIME '                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*   HDWRKSTR(1:5)=LNGTPTR(LTPART7)->LNGTXTD(1:LNGTPTR(LTPART7)->LNGTXTL
*       );                                                         0240
         MVI   HDWRKSTR+1,C' '                                     0240
         MVC   HDWRKSTR+2(3),HDWRKSTR+1                            0240
         L     @10,@CA00736                                        0240
         L     @10,LNGTPTR-IRBMFLTV+24(,@10)                       0240
         L     @15,LNGTXTL(,@10)                                   0240
         BCTR  @15,0                                               0240
         EX    @15,@SM00798                                        0240
*   HDWRKSTR(6:7)=HDUNPKST(1:2);    /* MOVE HH                       */
         MVC   HDWRKSTR+5(2),HDUNPKST                              0241
*   HDWRKSTR(8)='.';                /* INSERT SEPARATOR              */
         MVI   HDWRKSTR+7,C'.'                                     0242
*   HDWRKSTR(9:10)=HDUNPKST(3:4);   /* MOVE MM                       */
         MVC   HDWRKSTR+8(2),HDUNPKST+2                            0243
*   HDWRKSTR(11)='.';               /* INSERT SEPARATOR              */
         MVI   HDWRKSTR+10,C'.'                                    0244
*   HDWRKSTR(12:13)=HDUNPKST(5:6);  /* MOVE SS                       */
         MVC   HDWRKSTR+11(2),HDUNPKST+4                           0245
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */
*       HDWRKSTR,                   /* TEXT                          */
*       13,                         /* LENGTH                        */
*       RGHDR4,                     /* START LINE                    */
*       RGCOLC);                    /* START COLUMN                  */
*                                                                  0246
         MVC   @AL00001+4(12),@AL00246                             0246
         LA    @10,HDWRKSTR                                        0246
         ST    @10,@AL00001                                        0246
         LA    @01,@AL00001                                        0246
         BAL   @14,MFISRTXT                                        0246
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT INTERVAL MM/SS.TTT                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0247
*   UNPK(HDUNPKST,SMF70INT);        /* UNPACK INTERVAL LENGTH FROM 0247
*                                      MMSSTTTF FORM TO EBCDIC       */
*                                                                  0247
         L     @10,@PC00003                                        0247
         L     @10,HDRECPTR(,@10)                                  0247
         UNPK  HDUNPKST(7),SMF70INT(4,@10)                         0247
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT 'INTERVAL '                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0248
*   HDWRKSTR(1:9)=LNGTPTR(LTPART8)->LNGTXTD(1:LNGTPTR(LTPART8)->LNGTXTL
*       );                                                         0248
         MVI   HDWRKSTR+1,C' '                                     0248
         MVC   HDWRKSTR+2(7),HDWRKSTR+1                            0248
         L     @10,@CA00736                                        0248
         L     @10,LNGTPTR-IRBMFLTV+28(,@10)                       0248
         L     @15,LNGTXTL(,@10)                                   0248
         BCTR  @15,0                                               0248
         EX    @15,@SM00798                                        0248
*   HDWRKSTR(10:11)=HDUNPKST(1:2);  /* MOVE MM                       */
         MVC   HDWRKSTR+9(2),HDUNPKST                              0249
*   HDWRKSTR(12)='.';               /* INSERT SEPARATOR              */
         MVI   HDWRKSTR+11,C'.'                                    0250
*   HDWRKSTR(13:14)=HDUNPKST(3:4);  /* MOVE SS                       */
         MVC   HDWRKSTR+12(2),HDUNPKST+2                           0251
*   HDWRKSTR(15)='.';               /* INSERT PERIOD                 */
         MVI   HDWRKSTR+14,C'.'                                    0252
*   HDWRKSTR(16:18)=HDUNPKST(5:7);  /* MOVE TTT                      */
         MVC   HDWRKSTR+15(3),HDUNPKST+4                           0253
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */
*       HDWRKSTR,                   /* TEXT                          */
*       18,                         /* LENGTH                        */
*       RGHDR3,                     /* START LINE                    */
*       RGCOLD);                    /* START COLUMN                  */
*                                                                  0254
         MVC   @AL00001+4(12),@AL00254                             0254
         LA    @10,HDWRKSTR                                        0254
         ST    @10,@AL00001                                        0254
         LA    @01,@AL00001                                        0254
         BAL   @14,MFISRTXT                                        0254
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT CYCLE 0.TTT, IF NECESSARY                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0255
*   IF SMF70CYC^=HDNOSAMP THEN      /* SAMPLING IS DESIRED           */
         L     @10,@PC00003                                        0255
         L     @10,HDRECPTR(,@10)                                  0255
         CLC   SMF70CYC(2,@10),@CB00756                            0255
         BE    @RF00255                                            0255
*     DO;                                                          0256
*       UNPK(HDUNPKST(1:3),SMF70CYC);/* UNPACK SAMPLING CYCLE LENGTH
*                                      FROM FORM TTTF TO EBCDIC      */
*                                                                  0257
         L     @10,@PC00003                                        0257
         L     @10,HDRECPTR(,@10)                                  0257
         UNPK  HDUNPKST(3),SMF70CYC(2,@10)                         0257
*       /*************************************************************/
*       /*                                                           */
*       /* INSERT 'CYCLE '                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0258
*       HDWRKSTR(1:6)=LNGTPTR(LTPART9)->LNGTXTD(1:LNGTPTR(LTPART9)->
*           LNGTXTL);                                              0258
         MVI   HDWRKSTR+1,C' '                                     0258
         MVC   HDWRKSTR+2(4),HDWRKSTR+1                            0258
         L     @10,@CA00736                                        0258
         L     @15,LNGTPTR-IRBMFLTV+32(,@10)                       0258
         L     @14,LNGTXTL(,@15)                                   0258
         BCTR  @14,0                                               0258
         EX    @14,@SM00800                                        0258
*       HDWRKSTR(7:8)='0.';                                        0259
         MVC   HDWRKSTR+6(2),@CC00764                              0259
*       HDWRKSTR(9:11)=HDUNPKST(1:3);/* INSERT TTT                   */
*                                                                  0260
         MVC   HDWRKSTR+8(3),HDUNPKST                              0260
*       /*************************************************************/
*       /*                                                           */
*       /* INSERT ' SECONDS'                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0261
*       HDWRKSTR(12:19)=LNGTPTR(LTPART10)->LNGTXTD(1:LNGTPTR(LTPART10)
*           ->LNGTXTL);                                            0261
         MVI   HDWRKSTR+12,C' '                                    0261
         MVC   HDWRKSTR+13(6),HDWRKSTR+12                          0261
         L     @10,LNGTPTR-IRBMFLTV+36(,@10)                       0261
         L     @15,LNGTXTL(,@10)                                   0261
         BCTR  @15,0                                               0261
         EX    @15,@SM00802                                        0261
*       CALL MFISRTXT(              /* INSERT TEXT PROGRAM           */
*           HDWRKSTR,               /* TEXT                          */
*           19,                     /* LENGTH                        */
*           RGHDR4,                 /* START LINE                    */
*           RGCOLD);                /* START COLUMN                  */
         MVC   @AL00001+4(12),@AL00262                             0262
         LA    @10,HDWRKSTR                                        0262
         ST    @10,@AL00001                                        0262
         LA    @01,@AL00001                                        0262
         BAL   @14,MFISRTXT                                        0262
*     END;                                                         0263
*   RETURN;                         /* RETURN TO CALLER              */
@EL00003 DS    0H                                                  0264
@EF00003 DS    0H                                                  0264
@ER00003 LM    @14,@12,@SA00003                                    0264
         BR    @14                                                 0264
*   END;                                                           0265
         B     @EL00003                                            0265
*                                                                  0266
*/*                                                                  */
*/*** START OF SPECIFICATIONS ****************************************
*                                                                    */
*/*                                                                  */
*/* SUBROUTINE-NAME = MFWRTPAG                                       */
*/*                                                                  */
*/* DESCRIPTIVE-NAME = REPORT WRITE INTERNAL PAGE IMAGE ROUTINE      */
*/*                                                                  */
*/* FUNCTION = WRITES THE INTERNAL PAGE IMAGE, LINE BY LINE, TO A    */
*/*            SYSOUT DATA SET.                                      */
*/*                                                                  */
*/* ENTRY-POINT = MFWRTPAG                                           */
*/*                                                                  */
*/*    PURPOSE = SEE FUNCTION                                        */
*/*                                                                  */
*/**** END OF SPECIFICATIONS *****************************************
*                                                                    */
*/*                                                                  */
*/* WRITE INTERNAL PAGE IMAGE SUBROUTINE                             */
*                                                                  0266
*MFWRTPAG:                                                         0266
*   PROCEDURE;                                                     0266
MFWRTPAG STM   @14,@12,@SA00004                                    0266
*                                                                  0267
*/* BEGIN MISCELLANEOUS DECLARATIONS                                 */
*                                                                  0267
*   DECLARE                                                        0267
*     WRSKIPLN                      /* LINES TO SKIP BEFORE PRINTING */
*         FIXED BINARY(15),                                        0267
*     WRLOOPV                       /* LOOP VARIABLE                 */
*         FIXED BINARY(15),                                        0267
*     WRCARCC                       /* POSSIBLE CARRIAGE CONTROL   0267
*                                      CHARACTERS                    */
*         CHARACTER(3)STATIC LOCAL INITIAL(' 0-');                 0267
*                                                                  0268
*/* BEGIN MAINLINE PROCESSING                                        */
*                                                                  0268
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SOMETHING TO WRITE                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0268
*   IF RGLASTLN=RGNOPAGE THEN       /* NO NON-BLANK LINES IN PAGE.   */
         ICM   @10,3,RGLASTLN                                      0268
         BZ    @RT00268                                            0268
*     RETURN;                       /* RETURN TO REPORT GENERATOR.   */
*                                                                  0269
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE PAGE TO SYSOUT DATA SET                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0270
*   WRSKIPLN=1;                     /* SKIP ONE LINE BEFORE PRINTING */
         LA    @10,1                                               0270
         LR    WRSKIPLN,@10                                        0270
*   DO WRLOOPV=1 TO RGLASTLN;       /* DO FOR ALL LINES UP TO LAST   */
*                                                                  0271
         LR    WRLOOPV,@10                                         0271
         B     @DE00271                                            0271
@DL00271 DS    0H                                                  0272
*     /***************************************************************/
*     /*                                                             */
*     /* MUST WRITE FIRST LINE                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0272
*     IF WRLOOPV=1 THEN             /* FIRST LINE                    */
         CH    WRLOOPV,@CH00072                                    0272
         BNE   @RF00272                                            0272
*       RGCARCTL(WRLOOPV)='1';      /* SET SKIP TO TOP OF PAGE       */
*                                                                  0273
         LR    @10,WRLOOPV                                         0273
         MH    @10,@CH00789                                        0273
         LA    @05,RGCARCTL-126(@10)                               0273
         MVI   0(@05),C'1'                                         0273
*     /***************************************************************/
*     /*                                                             */
*     /* THIS IS NOT THE FIRST LINE                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0274
*     ELSE                                                         0274
*       DO;                                                        0274
         B     @RC00272                                            0274
@RF00272 DS    0H                                                  0275
*         IF WRSKIPLN<3&            /* HAVE NOT FOUND 2 PREVIOUS   0275
*                                      BLANK LINES                   */
*             RGLENGTH(WRLOOPV)=RGNOLINE/* THIS IS A BLANK LINE. THIS
*                                      WILL NEVER BE TRUE FOR LAST 0275
*                                      LINE (RGLASTLN).              */
*           THEN                                                   0275
         CH    WRSKIPLN,@CH00127                                   0275
         BNL   @RF00275                                            0275
         LR    @10,WRLOOPV                                         0275
         MH    @10,@CH00789                                        0275
         LH    @10,RGLENGTH-126(@10)                               0275
         LTR   @10,@10                                             0275
         BNZ   @RF00275                                            0275
*           DO;                                                    0276
*             WRSKIPLN=WRSKIPLN+1;  /* INCREMENT NUMBER OF BLANK   0277
*                                      LINES TO SKIP OVER            */
         AH    WRSKIPLN,@CH00072                                   0277
*             GO TO WRLAB1;         /* CONTINUE IN LOOP              */
         B     WRLAB1                                              0278
*           END;                                                   0279
*         RGCARCTL(WRLOOPV)=WRCARCC(WRSKIPLN);/* SET UP CARRIAGE   0280
*                                      CONTROL CHAR                  */
@RF00275 LR    @10,WRLOOPV                                         0280
         MH    @10,@CH00789                                        0280
         LA    @01,RGCARCTL-126(@10)                               0280
         LA    @10,WRCARCC-1(WRSKIPLN)                             0280
         MVC   0(1,@01),0(@10)                                     0280
*       END;                                                       0281
*                                                                  0281
*     /***************************************************************/
*     /*                                                             */
*     /* WRITE OUT LINE. FIRST SET UP RECORD LENGTH                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0282
*     IF RGLENGTH(WRLOOPV)=RGNOLINE THEN/* IF NO NON-BLANK DATA      */
*                                                                  0282
@RC00272 LR    @10,WRLOOPV                                         0282
         MH    @10,@CH00789                                        0282
         LH    @05,RGLENGTH-126(@10)                               0282
         LTR   @05,@05                                             0282
         BNZ   @RF00282                                            0282
*       /*************************************************************/
*       /*                                                           */
*       /* SET LENGTH TO INCLUDE RDW,CCC, AND ONE BLANK              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0283
*       RGLENGTH(WRLOOPV)=LENGTH(RGLINCTL)+1;                      0283
         LA    @05,6                                               0283
         STH   @05,RGLENGTH-126(@10)                               0283
*     ELSE                                                         0284
*       RGLENGTH(WRLOOPV)=RGLENGTH(WRLOOPV)+LENGTH(RGLINCTL);/* SET
*                                      LENGTH TO INCLUDE RDW,CCC, AND
*                                      ALL CHARACTERS UP TO THE LAST
*                                      NON-BLANK CHARACTER           */
         B     @RC00282                                            0284
@RF00282 LR    @10,WRLOOPV                                         0284
         MH    @10,@CH00789                                        0284
         LA    @05,5                                               0284
         AH    @05,RGLENGTH-126(@10)                               0284
         STH   @05,RGLENGTH-126(@10)                               0284
*     WRSKIPLN=1;                   /* RESET VARIABLE TO SKIP ONE  0285
*                                      LINE BEFORE PRINTING ON NEXT
*                                      PASS                          */
@RC00282 LA    WRSKIPLN,1                                          0285
*     RESPECIFY                                                    0286
*      (GPR00P,                                                    0286
*       GPR01P,                                                    0286
*       GPR14P,                                                    0286
*       GPR15P)RESTRICTED;                                         0286
*                                                                  0286
*     /***************************************************************/
*     /*                                                             */
*     /* REGISTER ZERO CONTAINS ADDRESS OF BUFFER TO WRITE           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0287
*     GPR00P=ADDR(RGPAGIMG(WRLOOPV));                              0287
         LR    GPR00P,WRLOOPV                                      0287
         MH    GPR00P,@CH00789                                     0287
         LR    @10,GPR00P                                          0287
         LA    GPR00P,RGPAGIMG-126(@10)                            0287
*     GENERATE SETS(RGDCB)FLOWS(MFSYNAD)(PUT RGDCB);/* WRITE LINE    */
         PUT RGDCB
*     RESPECIFY                                                    0289
*      (GPR00P,                                                    0289
*       GPR01P,                                                    0289
*       GPR14P,                                                    0289
*       GPR15P)UNRESTRICTED;                                       0289
*WRLAB1:                            /* END OF LOOP FOR ALL LINES.    */
*   END;                                                           0290
*                                                                  0290
WRLAB1   AH    WRLOOPV,@CH00072                                    0290
@DE00271 CH    WRLOOPV,RGLASTLN                                    0290
         BNH   @DL00271                                            0290
*   /*****************************************************************/
*   /*                                                               */
*   /* REINITIALIZE PAGE IMAGE                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0291
*   DO WRLOOPV=1 TO RGLASTLN;                                      0291
         LA    WRLOOPV,1                                           0291
         B     @DE00291                                            0291
@DL00291 DS    0H                                                  0292
*     RGLENGTH(WRLOOPV)=RGNOLINE;   /* INDICATES LINE IS BLANK.      */
         SR    @10,@10                                             0292
         LR    @05,WRLOOPV                                         0292
         MH    @05,@CH00789                                        0292
         STH   @10,RGLENGTH-126(@05)                               0292
*     RGFILL(WRLOOPV)=RGNOFILL;     /* FILL CHARACTER.               */
         STH   @10,RGFILL-126(@05)                                 0293
*     RGCARCTL(WRLOOPV)=' ';        /* SKIP ONE LINE BEFORE PRINTING */
         LA    @10,RGCARCTL-126(@05)                               0294
         MVI   0(@10),C' '                                         0294
*     RGLINE(WRLOOPV)=' ';          /* BLANK LINE                    */
         LA    @10,RGLINE-126(@05)                                 0295
         MVI   1(@10),C' '                                         0295
         MVC   2(118,@10),1(@10)                                   0295
         MVI   0(@10),C' '                                         0295
*   END;                                                           0296
         AH    WRLOOPV,@CH00072                                    0296
@DE00291 CH    WRLOOPV,RGLASTLN                                    0296
         BNH   @DL00291                                            0296
*   RGLASTLN=RGNOPAGE;              /* INDICATE BLANK PAGE.          */
         SR    @10,@10                                             0297
         STH   @10,RGLASTLN                                        0297
*   RETURN;                         /* RETURN TO CALLER              */
@EL00004 DS    0H                                                  0298
@EF00004 DS    0H                                                  0298
@ER00004 LM    @14,@12,@SA00004                                    0298
         BR    @14                                                 0298
*   END;                                                           0299
*                                                                  0299
         B     @EL00004                                            0299
*/*                                                                  */
*/*** START OF SPECIFICATIONS ****************************************
*                                                                    */
*/*                                                                  */
*/* SUBROUTINE-NAME = MFSYNAD                                        */
*/*                                                                  */
*/* DESCRIPTIVE-NAME = SYNAD ROUTINE FOR I/O ERRORS TO REPORT SYSOUT */
*/*                    DATA SETS                                     */
*/*                                                                  */
*/* FUNCTION = HANDLES ERRORS OCCURRING WHILE WRITING THE INTERNAL   */
*/*            PAGE IMAGE TO THE SYSOUT DATA SET.                    */
*/*                                                                  */
*/* ENTRY-POINT = MFSYNAD                                            */
*/*                                                                  */
*/*    PURPOSE = SEE FUNCTION                                        */
*/*                                                                  */
*/*    LINKAGE = R2 - R13 AS THEY EXISTED PRIOR TO PUT MACRO.        */
*/*              R14 - RETURN ADDRESS                                */
*/*              ALL REGISTERS TRANSPARENT                           */
*/*                                                                  */
*/**** END OF SPECIFICATIONS *****************************************
*                                                                    */
*/*                                                                  */
*/* SYNAD ROUTINE FOR MFWRTPAG PROCEDURE                             */
*                                                                  0300
*MFSYNAD:                                                          0300
*   PROCEDURE OPTIONS(NOSAVE NOSAVEAREA);                          0300
MFSYNAD  DS    0H                                                  0301
*                                                                  0301
*/* BEGIN MISCELLANEOUS DECLARATIONS                                 */
*                                                                  0301
*   DECLARE                                                        0301
*     SYSAVEA                       /* PROGRAM SAVE AREA FOR       0301
*                                      REGISTERS ON ENTRY            */
*         CHARACTER(64)BOUNDARY(WORD),                             0301
*     SYBUFPTR                      /* POINTER TO MESSAGE            */
*         POINTER(31),                                             0301
*     SYMESSAG                      /* MESSAGE                       */
*         CHARACTER(128)BASED(SYBUFPTR),                           0301
*     SYLOOPV                       /* LOOP VARIABLE                 */
*         FIXED BINARY(15),                                        0301
*     SYMSGPRM                      /* VARIABLE TEXT ADDRESS LIST TO
*                                      PASS TO MESSAGE PROCESSOR     */
*         POINTER(31);                                             0301
*                                                                  0302
*/* BEGIN MISCELLANEOUS STRUCTURE DECLARATIONS                       */
*                                                                  0302
*   DECLARE                                                        0302
*     1 SYVSEG,                     /* REPRESENTS SYNAD TEXT WHEN  0302
*                                      PASSED TO MESSAGE PROCESSOR   */
*      2 SYVPART                    /* WILL BE ZERO INDICATING THAT
*                                      THIS STRUCTURE CONTAINS TEXT  */
*            FIXED BINARY(15),                                     0302
*      2 SYVLEN                     /* LENGTH OF TEXT                */
*            FIXED BINARY(15),                                     0302
*      2 SYVTEXT                    /* TEXT                          */
*            CHARACTER(128);                                       0302
*                                                                  0303
*/* BEGIN PROCESSING                                                 */
*                                                                  0303
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE REGISTERS AND ISSUE SYNADAF MACRO TO GET ERROR MESSAGE   */
*   /* AND ESTABLISH NEW SAVE AREA. REGISTERS 2-13 ARE TRANSPARENT   */
*   /* FROM THE PUT MACRO IN MFWRTPAG                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0303
*   GENERATE SETS(SYSAVEA);                                        0303
*                                                                  0303
         STM   @00,@15,SYSAVEA      SAVE REGISTERS
         SYNADAF ACSMETH=QSAM       ISSUE SYNAD MACRO
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTER 13 NOW POINTS TO A SAVE AREA OBTAINED BY SYNADAF     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0304
*   RESPECIFY                                                      0304
*    (GPR01P)RESTRICTED;                                           0304
*   SYBUFPTR=GPR01P;                /* SAVE POINTER TO MESSAGE       */
         LR    SYBUFPTR,GPR01P                                     0305
*   RESPECIFY                                                      0306
*    (GPR01P)UNRESTRICTED;                                         0306
*                                                                  0306
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE VARIABLE PART LISTS AND THEN WRITE MESSAGE IRB401I */
*   /* I/O ERROR ON MF/1 WRITE. THE SYNAD TEXT FOLLOWS. 'SYNAD TEXT' */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0307
*   SYMSGPRM=ADDR(SYVSEG);          /* ADDRESS LIST POINTS TO      0307
*                                      VARIABLE MESSAGE SEGMENT      */
         LA    @10,SYVSEG                                          0307
         ST    @10,SYMSGPRM                                        0307
*   SYVPART=0;                      /* INDICATES TEXT                */
         SR    @10,@10                                             0308
         STH   @10,SYVPART                                         0308
*   SYVLEN=LENGTH(SYVTEXT);         /* LENGTH OF SYNAD TEXT          */
         MVC   SYVLEN(2),@CH00782                                  0309
*   SYVTEXT=SYMESSAG;               /* MOVE MESSAGE INTO PARM LIST   */
*                                                                  0310
         MVC   SYVTEXT(128),SYMESSAG(SYBUFPTR)                     0310
*   /*****************************************************************/
*   /*                                                               */
*   /* LOAD MESSAGE PROCESSOR                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0311
*   RESPECIFY                                                      0311
*    (GPR00P,                                                      0311
*     GPR01P,                                                      0311
*     GPR14P,                                                      0311
*     GPR15P)RESTRICTED;                                           0311
*   GENERATE;                                                      0312
SYLOAD1  LOAD  EP=IRBMFMPR,RELATED=(MFSYLMPR,MFSYNAD(SYLOAD2))
*   RGENTRYP=GPR00P;                                               0313
         LR    RGENTRYP,GPR00P                                     0313
*   RESPECIFY                                                      0314
*    (GPR00P,                                                      0314
*     GPR01P,                                                      0314
*     GPR14P,                                                      0314
*     GPR15P)UNRESTRICTED;                                         0314
*                                                                  0314
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL MESSAGE MODULE                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0315
*   CALL IRBMFMPR(                  /* MESSAGE MODULE                */
*       MID400I,                    /* MESSAGE INDEX                 */
*       SYMSGPRM,                   /* VARIABLE SEGMENT LIST         */
*       0,                          /* DUMMY REPLY BUFFER            */
*       MFSEMDCB);                  /* MESSAGE DATA SET DCB ADDRESS  */
*                                                                  0315
         LA    @10,@CF00525                                        0315
         ST    @10,@AL00001                                        0315
         LA    @10,SYMSGPRM                                        0315
         ST    @10,@AL00001+4                                      0315
         LA    @10,@CF00500                                        0315
         ST    @10,@AL00001+8                                      0315
         L     @10,@PC00001                                        0315
         LA    @10,MFSEMDCB(,@10)                                  0315
         ST    @10,@AL00001+12                                     0315
         LR    @15,RGENTRYP                                        0315
         LA    @01,@AL00001                                        0315
         BALR  @14,@15                                             0315
*   /*****************************************************************/
*   /*                                                               */
*   /* RELEASE SAVE AREA AND BUFFER. DELETE MESSAGE MODULE AND AND   */
*   /* RELOAD REGISTERS. THEN ABEND.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0316
*   RESPECIFY                                                      0316
*    (GPR00P,                                                      0316
*     GPR01P,                                                      0316
*     GPR14P,                                                      0316
*     GPR15P)RESTRICTED;                                           0316
*   GENERATE REFS(SYSAVEA);                                        0317
SYLOAD2  DELETE EP=IRBMFMPR,RELATED=(MFSYLMPR,MFSYNAD(SYLOAD1))
         SYNADRLS
         LM    @00,@15,SYSAVEA      RESTORE REGISTERS
         ABEND 1310,DUMP
*   RESPECIFY                                                      0318
*    (GPR00P,                                                      0318
*     GPR01P,                                                      0318
*     GPR14P,                                                      0318
*     GPR15P)UNRESTRICTED;                                         0318
*   END;                                                           0319
@EL00005 DS    0H                                                  0319
@EF00005 DS    0H                                                  0319
@ER00005 BR    @14                                                 0319
*   END                                                            0320
*                                                                  0320
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*/*%INCLUDE SYSLIB  (IRBRGCON)                                       */
*/*%INCLUDE SYSLIB  (IRBMFMID)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */
*/*%INCLUDE SYSLIB  (IRBMFLTM)                                       */
*                                                                  0320
*       ;                                                          0320
@EL00001 L     @13,4(,@13)                                         0320
@EF00001 L     @00,@SIZDATD                                        0320
         LR    @01,@11                                             0320
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0320
         BR    @14                                                 0320
@DATA    DS    0H
@CH00052 DC    H'8'
@CH00516 DC    H'12'
@CH00339 DC    H'60'
@CH00372 DC    H'120'
@CH00789 DC    H'126'
@CH00782 DC    H'128'
@SM00796 MVC   0(0,@01),ISTEXT(@14)
@SM00798 MVC   HDWRKSTR(0),LNGTXTD(@10)
@SM00800 MVC   HDWRKSTR(0),LNGTXTD(@15)
@SM00802 MVC   HDWRKSTR+11(0),LNGTXTD(@10)
         DS    0F
@AL00078 DC    A(@CF00500)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00366)
         DC    A(@CF00500)
         DC    A(@CB00653)
         DC    A(@CB00653)
@AL00152 DC    A(@CF00089)             LIST WITH   4 ARGUMENT(S)
         DC    A(RGSADDR)
         DC    A(RGSADDR)
         DC    A(RGSADDR)
@AL00197 DC    A(@CF00500)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00065)
         DC    A(@CF00500)
         DC    A(@CB00653)
         DC    A(@CB00653)
@AL00198 DC    A(@CF00510)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00089)
         DC    A(@CF00791)
@AL00200 DC    A(@CF00500)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00072)
         DC    A(@CF00500)
         DC    A(@CB00653)
         DC    A(@CB00653)
@AL00201 DC    A(@CF00344)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00127)
         DC    A(@CF00375)
@AL00206 DC    A(@CF00375)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00065)
         DC    A(@CF00375)
@AL00209 DC    A(@CF00519)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00127)
         DC    A(@CF00377)
@AL00212 DC    A(@CF00055)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00065)
         DC    A(@CF00377)
@AL00229 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL00231 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL00235 DC    A(@CF00500)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00089)
         DC    A(@CF00500)
         DC    A(@CB00653)
         DC    A(@CB00653)
@AL00238 DC    A(@CF00375)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00127)
         DC    A(@CF00379)
@AL00246 DC    A(@CF00375)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00065)
         DC    A(@CF00379)
@AL00254 DC    A(@CF00525)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00127)
         DC    A(@CF00381)
@AL00262 DC    A(@CF00527)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00065)
         DC    A(@CF00381)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00003 DS    15F
@PC00003 DS    4F
@PC00002 DS    4F
@SA00004 DS    15F
@AL00001 DS    7A
@AFTEMPS DS    2F
IRBMFRGM CSECT
         DS    0F
@CF00500 DC    F'0'
@CF00072 DC    F'1'
@CH00072 EQU   @CF00072+2
@CF00089 DC    F'2'
@CH00089 EQU   @CF00089+2
@CF00127 DC    F'3'
@CH00127 EQU   @CF00127+2
@CF00065 DC    F'4'
@CH00065 EQU   @CF00065+2
@CF00366 DC    F'5'
@CF00344 DC    F'6'
@CF00510 DC    F'9'
@CF00512 DC    F'10'
@CF00375 DC    F'13'
@CF00519 DC    F'14'
@CF00055 DC    F'15'
@CF00525 DC    F'18'
@CF00527 DC    F'19'
@CF00377 DC    F'38'
@CF00379 DC    F'65'
@CF00381 DC    F'90'
@CF00791 DC    F'112'
@DATD    DSECT
         DS    0D
HDBINDAY DS    F
HDBINYR  DS    F
HDBINMO  DS    F
SYMSGPRM DS    A
RGERRCDE DS    H
SYLOOPV  DS    H
         DS    0D
@TS00001 DS    CL8
RGCLOSPL DS    CL4
RGDCB    DS    CL96
RGESTAPL DS    CL16
RGOPENPL DS    CL4
RGDDNAME DS    CL8
RGMODULE DS    CL8
RGRTYREG DS    CL48
RGALLARG DS    CL10
         ORG   RGALLARG
RGALLDDN DS    CL8
RGALLSOU DS    CL1
RGALLUNA DS    BL1
         ORG   RGALLARG+10
         DS    CL2
RGESTPRM DS    CL40
         ORG   RGESTPRM
RGESTALL DS    AL4
RGESTDCB DS    AL4
RGESTDCM DS    AL4
RGESTSEL DS    AL4
RGESTRTY DS    AL4
RGESTPAG DS    AL4
RGESTOPN DS    AL4
RGESTCLS DS    AL4
RGESTCNV DS    AL4
RGESTREG DS    AL4
         ORG   RGESTPRM+40
HDWRKSTR DS    CL20
HDUNPKST DS    CL7
HDCVBSRC DS    CL2
         DS    CL3
SYSAVEA  DS    CL64
SYVSEG   DS    CL132
         ORG   SYVSEG
SYVPART  DS    FL2
SYVLEN   DS    FL2
SYVTEXT  DS    CL128
         ORG   SYVSEG+132
RGVECTAB DS    4A
IRBMFRGM CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00592 DC    V(IRBMFSAR)
@CA00736 DC    A(IRBMFLTV)
         DS    0D
RGSADDR  DC    A(0)
@CC00764 DC    C'0.'
@CC00656 DC    C'MFR'
@CC00657 DC    C'IRBMFALL'
@CC00664 DC    C'IRBMFMPR'
@CC00665 DC    C'IRBMFCNV'
@CB00756 DC    X'000F'
@CB00653 DC    B'00000000'
         DS    CL4
RGONESEC DC    CL8'00000100'
WRCARCC  DC    CL3' 0-'
RGPATCH  DS    CL200
         DS    CL1
HDDAYS   DC    H'31'
         DC    H'28'
         DC    H'31'
         DC    H'30'
         DC    H'31'
         DC    H'30'
         DC    H'31'
         DC    H'31'
         DC    H'30'
         DC    H'31'
         DC    H'30'
         DC    H'31'
IRBMFRGM CSECT
RGCLSSPL CLOSE (RGSDCB,DISP),MF=L
IRBMFRGM CSECT
RGSDCB   DCB   DDNAME=MFR00000,                                        X
               DSORG=PS,                                               X
               MACRF=PM,                                               X
               RECFM=VBA,                                              X
               LRECL=125,                                              X
               BLKSIZE=1693
IRBMFRGM CSECT
RGESTSPL ESTAE RGSADDR,PARAM=RGSADDR,MF=L
IRBMFRGM CSECT
RGOPNSPL OPEN  (RGSDCB,(OUTPUT)),MF=L
@DATD    DSECT
         DS    0F                   FULLWORD BOUNDARY
RGGENPAG DS    CL7562              STORAGE FOR PAGE TABLE
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IRBMFRGM CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SYBUFPTR EQU   @04
WRLOOPV  EQU   @04
WRSKIPLN EQU   @05
HDLOOPV  EQU   @05
HDTOTDAY EQU   @04
ISLSTCOL EQU   @04
RGLOOP   EQU   @04
RGENTRYP EQU   @05
DCBPTR   EQU   @06
GPR12P   EQU   @12
GPR11P   EQU   @11
GPR00F   EQU   @00
GPR01F   EQU   @01
GPR14F   EQU   @14
GPR15F   EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR14P   EQU   @14
GPR15P   EQU   @15
GPR02P   EQU   @02
GPR03P   EQU   @03
         EXTRN IRBMFLTV
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBDDNAM EQU   IHADCS24
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBSYNA  EQU   DCBSYNAD+1
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
DCBCNTRL EQU   IHADCS40+12
DCBEROPT EQU   DCBCNTRL
DTMVT    EQU   0
DTMVNUM  EQU   DTMVT
DTMVOPT  EQU   DTMVT+4
MFCOA    EQU   0
MFCOTCE  EQU   MFCOA
MFCOTCEF EQU   MFCOTCE
MFCOTCEL EQU   MFCOTCE+3
MFCOCYC  EQU   MFCOA+4
MFCOCYCF EQU   MFCOCYC
MFCOOUT  EQU   MFCOA+8
MFCOOUTF EQU   MFCOOUT
MFCOOUTV EQU   MFCOOUT+3
MFCOINT  EQU   MFCOA+12
MFCOINTF EQU   MFCOINT
MFCOREP  EQU   MFCOA+16
MFCOREPF EQU   MFCOREP
MFCOREPL EQU   MFCOREP+3
MFCOREPV EQU   MFCOREPL
MFCOSTP  EQU   MFCOA+20
MFCOSTPF EQU   MFCOSTP
MFCOOPI  EQU   MFCOA+24
MFCOOPIF EQU   MFCOOPI
MFCOOPIL EQU   MFCOOPI+3
MFCOMEM  EQU   MFCOA+28
MFCOMEMF EQU   MFCOMEM
MFPMA    EQU   0
MFPMOPT  EQU   MFPMA
@NM00036 EQU   MFPMOPT+3
MFPMSARG EQU   MFPMA+4
IRBMFALL EQU   0
IRBMFCNV EQU   0
IRBMFMPR EQU   0
IRBMFRXR EQU   0
RGSBPLLN EQU   0
SMFRCD70 EQU   0
SMF70FLG EQU   SMFRCD70+4
SMF70SID EQU   SMFRCD70+14
SMF70SIZ EQU   SMFRCD70+18
SMF70IST EQU   SMFRCD70+20
SMF70DAT EQU   SMFRCD70+24
SMF70INT EQU   SMFRCD70+28
SMF70CYC EQU   SMFRCD70+32
SMF70MFV EQU   SMFRCD70+40
SMF70RLS EQU   SMFRCD70+44
SMF70PTR EQU   0
SMF70A   EQU   0
SMF70SCC EQU   SMF70A
SMF70B   EQU   0
SMF70CNF EQU   SMF70B+11
LNGTXT   EQU   0
LNGTXTL  EQU   LNGTXT
LNGTXTD  EQU   LNGTXT+4
SYMESSAG EQU   0
IKEBC    EQU   0
IKEBF15  EQU   0
IKEBF31  EQU   0
IKEBP15  EQU   0
IKEBP31  EQU   0
IKEBP8   EQU   0
MFSEL    EQU   0
MFSEPARM EQU   MFSEL+4
MFSESECB EQU   MFSEL+20
MFSECOA  EQU   MFSEL+24
MFSEDTMV EQU   MFSEL+28
MFSESTID EQU   MFSEL+32
MFSEFLAG EQU   MFSEL+47
MFSERTRY EQU   MFSEFLAG
MFSEMDCB EQU   MFSEL+48
MFPCALST EQU   0
MFMVT    EQU   0
MFMVNUM  EQU   MFMVT
MFMVOPT  EQU   MFMVT+4
ISTEXT   EQU   0
ISTXTLEN EQU   0
ISBEGLIN EQU   0
ISBEGCOL EQU   0
HDRECPTR EQU   0
HDTITLE  EQU   0
HDTITLEN EQU   0
HDPAGE   EQU   0
DTMVADD  EQU   DTMVOPT
MFCOOPTN EQU   MFCOA
MFMVADD  EQU   MFMVOPT
MFPMB    EQU   MFPMOPT
@NM00039 EQU   MFPMB+2
MFPMDEVF EQU   @NM00039
MFPMC    EQU   MFPMOPT
@NM00041 EQU   MFPMC+3
RGPAGE   EQU   RGGENPAG
RGLASTLN EQU   RGPAGE
RGPAGIMG EQU   RGPAGE+2
RGLINCTL EQU   RGPAGIMG
RGLENGTH EQU   RGLINCTL
RGFILL   EQU   RGLINCTL+2
RGCARCTL EQU   RGLINCTL+4
RGLINE   EQU   RGPAGIMG+5
HDRELEAS EQU   SMF70FLG
LNG      EQU   IRBMFLTV
LNGTPTR  EQU   LNG
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
MFPMWKLD EQU   @NM00041
@NM00042 EQU   @NM00041
@NM00040 EQU   MFPMC
MFPMCRDR EQU   MFPMDEVF
MFPMUNIT EQU   MFPMDEVF
MFPMGRAP EQU   MFPMDEVF
MFPMDA   EQU   MFPMDEVF
MFPMTP   EQU   MFPMDEVF
MFPMTAPE EQU   MFPMDEVF
@NM00038 EQU   MFPMB
MFCOCTRL EQU   MFCOOPTN
MFMVDEV  EQU   MFMVOPT+16
MFMVCHA  EQU   MFMVOPT+12
MFMVWKL  EQU   MFMVOPT+8
MFMVPAG  EQU   MFMVOPT+4
MFMVCPU  EQU   MFMVOPT
@NM00045 EQU   MFSEFLAG
@NM00044 EQU   MFSEL+44
MFSEITOD EQU   MFSEL+36
MFSESCOD EQU   MFSESECB+1
@NM00043 EQU   MFSESECB
MFSESTAD EQU   MFSEL+16
MFSEMFMV EQU   MFSEPARM+8
MFSEALST EQU   MFSEPARM+4
MFSESEL  EQU   MFSEPARM
MFSENEXT EQU   MFSEL
SMF70SER EQU   SMF70B+13
SMF70RV4 EQU   SMF70B+12
SMF70STA EQU   SMF70CNF
SMF70VAC EQU   SMF70CNF
@NM00046 EQU   SMF70CNF
SMF70RV3 EQU   SMF70B+10
SMF70CID EQU   SMF70B+8
SMF70WAT EQU   SMF70B
SMF70RV2 EQU   SMF70A+6
SMF70SCD EQU   SMF70A+4
SMF70CPU EQU   SMF70A+2
SMF70RV1 EQU   SMFRCD70+42
SMF70SAM EQU   SMFRCD70+36
SMF70SUB EQU   SMFRCD70+34
SMF70DTE EQU   SMFRCD70+10
SMF70TME EQU   SMFRCD70+6
SMF70RTY EQU   SMFRCD70+5
SMF70SEG EQU   SMFRCD70+2
SMF70LEN EQU   SMFRCD70
MFPMSTA  EQU   @NM00036
@NM00037 EQU   @NM00036
@NM00035 EQU   MFPMOPT
MFPMCON  EQU   MFPMOPT
MFCOMEMV EQU   MFCOMEM+2
@NM00034 EQU   MFCOMEM+1
MFCOMEMC EQU   MFCOMEMF
MFCOOPIV EQU   MFCOOPIL
@NM00033 EQU   MFCOOPIL
@NM00032 EQU   MFCOOPI+1
MFCOOPIC EQU   MFCOOPIF
MFCOSTPV EQU   MFCOSTP+2
@NM00031 EQU   MFCOSTP+1
MFCOSTPU EQU   MFCOSTPF
MFCOSTPS EQU   MFCOSTPF
MFCOSTPC EQU   MFCOSTPF
@NM00030 EQU   MFCOREPL
@NM00029 EQU   MFCOREP+1
MFCOREPC EQU   MFCOREPF
MFCOINTV EQU   MFCOINT+2
@NM00028 EQU   MFCOINT+1
MFCOINTC EQU   MFCOINTF
@NM00027 EQU   MFCOOUT+1
MFCOOUTC EQU   MFCOOUTF
MFCOCYCV EQU   MFCOCYC+2
@NM00026 EQU   MFCOCYC+1
MFCOCYCC EQU   MFCOCYCF
MFCOTCEV EQU   MFCOTCEL
@NM00025 EQU   MFCOTCEL
@NM00024 EQU   MFCOTCE+1
MFCOTCEC EQU   MFCOTCEF
DTMVDEV  EQU   DTMVOPT+16
DTMVCHA  EQU   DTMVOPT+12
DTMVWKL  EQU   DTMVOPT+8
DTMVPAG  EQU   DTMVOPT+4
DTMVCPU  EQU   DTMVOPT
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00023 EQU   IHADCS40+16
DCBCNTRA EQU   DCBCNTRL+1
@NM00022 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
DCBLRECL EQU   IHADCS40+10
@NM00021 EQU   IHADCS40+9
@NM00020 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00019 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
@NM00018 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00017 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00016 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00015 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBBLKSI EQU   IHADCS36+10
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00014 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00013 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
@NM00012 EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00011 EQU   DCBPUT
DCBDEBA  EQU   DCBDEBAD+1
@NM00010 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00009 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBIBPCT EQU   DCBIFLG
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00008 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00007 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00006 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00005 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
DCBDSGMQ EQU   DCBDSRG1
DCBDSGCQ EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRBAL EQU   IHADCS01+6
@NM00004 EQU   IHADCS01+5
@NM00003 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00002 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00001 EQU   IHADCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00109 EQU   RGERR1
@RT00114 EQU   RGLAB2
@RT00132 EQU   RGLAB3
@RF00255 EQU   @EL00003
@RT00268 EQU   @EL00004
@PB00005 EQU   @EL00001
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IRBMFRGM,(C'PL/S-II',0502,74087)

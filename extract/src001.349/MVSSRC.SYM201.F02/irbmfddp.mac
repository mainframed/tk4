         TITLE '*/* IRBMFDDP - DEVICE INTERVAL MEASUREMENT GATHERING MO*
               ODULE    '
IRBMFDDP CSECT ,                                                   0001
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MVC   @PC00001(36),0(@01)                                 0001
*   STSMSAVE=GPR13P;                                               0038
*                                                                  0038
         L     @10,@PC00001                                        0038
         L     @10,DDSMAPTR(,@10)                                  0038
         ST    GPR13P,STSMSAVE(,@10)                               0038
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0039
*   RESPECIFY                                                      0039
*    (GPR13P) UNRESTRICTED;                                        0039
*                                                                  0040
*/* BEGIN MAINLINE PROCESSING.  THIS MODULE IS EXECUTED IN THREE   0040
*       SECTIONS: PROLOG, MOVE, AND EPILOG.  ALL PROLOG SECTIONS IN
*       ALL INTERVAL-DRIVEN MG ROUTINES ARE GIVEN CONTROL BY ESVC14
*       FIRST, THEN ALL MOVE SECTIONS GET CONTROL, ETC.  THIS      0040
*       NECESSITATES RETURN LINKAGE TO ESVC14 AFTER EACH SECTION     */
*                                                                  0040
*   /*****************************************************************/
*   /*                                                               */
*   /* PROLOG. THIS SECTION OBTAINS AND FIXES INTERVAL DATA STORAGE. */
*   /* IT ALSO FIXES THE MOVE SECTION AND ALL DATA WHICH THAT SECTION*/
*   /* OF CODE REFERENCES.                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0040
*   DDDTAPTR=STSMIADD;              /* LAST WRAP VALUES TO OUTPUT  0040
*                                      POINTER                       */
*                                                                  0040
         L     @10,STSMIADD(,@10)                                  0040
         ST    @10,DDDTAPTR                                        0040
*   /*****************************************************************/
*   /*                                                               */
*   /* FIX PROGRAM AND LOCAL STATIC DATA                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0041
*   DDPAGECB=ECBRST;                /* RESET ECB                     */
*                                                                  0041
         SLR   @10,@10                                             0041
         ST    @10,DDPAGECB                                        0041
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0042
*   RESPECIFY                                                      0042
*    (GPR00P,                                                      0042
*     GPR01P,                                                      0042
*     GPR14P,                                                      0042
*     GPR15P) RESTRICTED;                                          0042
*   GENERATE SETS(DDPAGECB);                                       0043
*                                                                  0043
         LA    GPR00P,DDPAGECB      ECB ADDRESS
DDPAGFX1 PGFIX R,A=IRBMFDDP,EA=@ENDDATA,ECB=(GPR00P),LONG=N,           X
               RELATED=(MFDDPGFX,IRBMFDDP(DDPAGFX4),IRBMFTRM(TR0110))
         WAIT  ECB=DDPAGECB
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0044
*   RESPECIFY                                                      0044
*    (GPR00P,                                                      0044
*     GPR01P,                                                      0044
*     GPR14P,                                                      0044
*     GPR15P) UNRESTRICTED;                                        0044
*                                                                  0044
*   /*****************************************************************/
*   /*                                                               */
*   /* FIX AUTOMATIC DATA STORAGE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0045
*   DDPAGECB=ECBRST;                /* RESET ECB                     */
*                                                                  0045
         SLR   @10,@10                                             0045
         ST    @10,DDPAGECB                                        0045
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0046
*   RESPECIFY                                                      0046
*    (GPR00P,                                                      0046
*     GPR01P,                                                      0046
*     GPR14P,                                                      0046
*     GPR15P) RESTRICTED;                                          0046
*   GENERATE SETS(DDPAGECB);                                       0047
*                                                                  0047
         LA    GPR15P,@ENDDATD      END ADDRESS
         LA    GPR00P,DDPAGECB      ECB ADDRESS
         LA    GPR01P,@DATD         BEGINNING ADDRESS
DDPAGFX2 PGFIX R,A=(GPR01P),EA=(GPR15P),ECB=(GPR00P),LONG=N,           X
               RELATED=(MFDDATFX,IRBMFDDP(DDPAGFX5),IRBMFTRM(TR0210))
         WAIT  ECB=DDPAGECB
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0048
*   RESPECIFY                                                      0048
*    (GPR00P,                                                      0048
*     GPR01P,                                                      0048
*     GPR14P,                                                      0048
*     GPR15P) UNRESTRICTED;                                        0048
*                                                                  0048
*   /*****************************************************************/
*   /*                                                               */
*   /* ADD ENTRY TO STORAGE RESOURCE TABLE FOR AUTOMATIC DATA MACDATE*/
*   /* Y-2 73018                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0049
*   RESPECIFY                                                      0049
*    (GPR00P,                                                      0049
*     GPR01P) RESTRICTED;                                          0049
*   GENERATE;                                                      0050
         L     GPR00P,@SIZDATD      SUBPOOL AND LENGTH
         LA    GPR01P,@DATD         ADDRESS
*   STSGFREE(STRVNSGT)=GPR00P;      /* SUBPOOL AND LENGTH            */
         L     @10,@PC00001                                        0051
         L     @10,DDSMAPTR(,@10)                                  0051
         L     @06,STSMRVT(,@10)                                   0051
         L     @15,STRVNSGT(,@06)                                  0051
         LR    @14,@15                                             0051
         SLA   @14,3                                               0051
         L     @09,STRVSSGT(,@06)                                  0051
         LA    @08,0(@14,@09)                                      0051
         AL    @08,@CF00647                                        0051
         ST    GPR00P,STSGFREE(,@08)                               0051
*   STSGADD(STRVNSGT)=GPR01P;       /* ADDRESS                       */
*                                                                  0052
         AL    @09,@CF00648                                        0052
         ST    GPR01P,STSGADD-4(@14,@09)                           0052
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0053
*   RESPECIFY                                                      0053
*    (GPR00P,                                                      0053
*     GPR01P) UNRESTRICTED;                                        0053
*   STRVNSGT=STRVNSGT+1;            /* POINT TO NEXT SGT SLOT        */
*                                                                  0054
         AL    @15,@CF00060                                        0054
         ST    @15,STRVNSGT(,@06)                                  0054
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLOCATE STORAGE IN THE USERS KEY FOR A DEVICE VECTOR TABLE   */
*   /* AND INTERVAL DATA MACDATE Y-2 73018                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0055
*   RESPECIFY                                                      0055
*    (GPR00P,                                                      0055
*     GPR01P,                                                      0055
*     GPR14P,                                                      0055
*     GPR15P) RESTRICTED;                                          0055
*   GPR00P=STSMIGMC;                /* SET SUBPOOL AND LENGTH INTO 0056
*                                      REG                           */
         L     GPR00P,STSMIGMC(,@10)                               0056
*   GENERATE;                                                      0057
DDGETMN1 GETMAIN R,LV=(0),RELATED=(MFDDISGM,IRBMFRGM(RGFREES1),        X
               IRBMFTRM(TR0220),IRBMFDTA(DT200))
*   STSMIADD=GPR01P+LENGTH(STSMIGMC);/* BEGINNING ADDRESS OF STORAGE */
*                                                                  0058
         L     @10,@PC00001                                        0058
         L     @10,DDSMAPTR(,@10)                                  0058
         LA    @06,4                                               0058
         LR    @09,GPR01P                                          0058
         ALR   @09,@06                                             0058
         ST    @09,STSMIADD(,@10)                                  0058
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0059
*   RESPECIFY                                                      0059
*    (GPR00P,                                                      0059
*     GPR01P,                                                      0059
*     GPR14P,                                                      0059
*     GPR15P) UNRESTRICTED;                                        0059
*   DDSMIADD=STSMIADD;              /* MOVE TO TEMPORARY STORAGE     */
*                                                                  0060
         LR    DDSMIADD,@09                                        0060
*   /*****************************************************************/
*   /*                                                               */
*   /* FIX INTERVAL DATA STORAGE AREA MACDATE Y-2 73018              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0061
*   RESPECIFY                                                      0061
*    (GPR00P,                                                      0061
*     GPR01P,                                                      0061
*     GPR14P,                                                      0061
*     GPR15P) RESTRICTED;                                          0061
*   GPR01P=DDSMIADD-LENGTH(STSMIGMC);/* BEGINNING ADDRESS            */
         LCR   @06,@06                                             0062
         ALR   @06,DDSMIADD                                        0062
         LR    GPR01P,@06                                          0062
*   GPR15P=GPR01P+STSMILEN;         /* DATA END ADDRESS+1            */
         LR    GPR15P,GPR01P                                       0063
         L     @10,STSMILEN-1(,@10)                                0063
         LA    @10,0(,@10)                                         0063
         ALR   GPR15P,@10                                          0063
*   DDPAGECB=0;                     /* RESET ECB                     */
         SLR   @10,@10                                             0064
         ST    @10,DDPAGECB                                        0064
*   GENERATE SETS(DDPAGECB);                                       0065
*                                                                  0065
         LA    GPR00P,DDPAGECB      ECB ADDRESS
DDPAGFX3 PGFIX R,A=(GPR01P),EA=(GPR15P),ECB=(GPR00P),LONG=N,           X
               RELATED=(MFDDISFX,IRBMFDDP(DDPAGFX6),IRBMFTRM(TR0210))
         WAIT  ECB=DDPAGECB
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0066
*   RESPECIFY                                                      0066
*    (GPR00P,                                                      0066
*     GPR01P,                                                      0066
*     GPR14P,                                                      0066
*     GPR15P) UNRESTRICTED;                                        0066
*                                                                  0066
*   /*****************************************************************/
*   /*                                                               */
*   /* SET SUBPOOL AND LENGTH INTO FIRST WORD OF GOTTEN AREA         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0067
*   EVAL(DDSMIADD-LENGTH(STSMIGMC))->DDDTAGMC=STSMIGMC;            0067
*                                                                  0067
         LR    @10,DDSMIADD                                        0067
         SL    @10,@CF00175                                        0067
         L     @06,@PC00001                                        0067
         L     @06,DDSMAPTR(,@06)                                  0067
         MVC   DDDTAGMC(4,@10),STSMIGMC(@06)                       0067
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER BY SPECIAL RETURN SEQUENCE WHICH DOES NOT    */
*   /* FREE AUTOMATIC DATA OR INVALIDATE ADDRESSABILITY. THE PURPOSE */
*   /* IS TO ALLOW ALL PROLOGS TO EXECUTE TOGETHER. THEN ALL MOVES,  */
*   /* ETC. THE EFFECT IN ANY ONE INTERVAL MG ROUTINE IS AS IF THE   */
*   /* PROLOG, MOVE, AND EPILOG EXECUTED AS SEQUENTIAL CODE DDMOVE:  */
*   /* IRBBREAK MACDATE Y-2 73018                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0068
*DDMOVE:                                                           0068
*                                                                  0068
*   /*****************************************************************/
*   /*                                                               */
*   /* INDICATE NEXT ROUTINE ADDRESS TO SVC MAINLINE FOR REENTRY     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0068
*   STSMENTR=ADDR(DDRT0021);                                       0068
DDMOVE   L     @10,@PC00001                                        0068
         L     @10,DDSMAPTR(,@10)                                  0068
         LA    @06,DDRT0021                                        0068
         ST    @06,STSMENTR(,@10)                                  0068
*   RESPECIFY                                                      0069
*    (GPR00P,                                                      0069
*     GPR01P,                                                      0069
*     GPR14P,                                                      0069
*     GPR15P) RESTRICTED;                                          0069
*   GENERATE;                                                      0070
         STM   @02,@12,28(@13)     SAVE REGISTERS FOR NEXT SEGMENT
         L     @13,4(,@13)         BACK CHAIN TO CALLERS SAVEAREA
         LM    @14,@12,12(@13)     RESTORE CALLERS REGISTERS
         BR    @14                 RETURN TO CALLER
*                                                                  0071
*   /*****************************************************************/
*   /*                                                               */
*   /* REENTRY POINT FROM CALLER, IGX00014.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0071
*DDRT0021:                                                         0071
*   GENERATE;                                                      0071
DDRT0021 DS    0H                                                  0071
         STM   @14,@12,12(@13)     SAVE CALLERS REGISTERS
         L     @01,0(,@01)         GET ADDRESS OF SAVE AREA ADDRESS
         L     @01,0(,@01)         GET SAVE AREA ADDRESS
         LM    @02,@12,28(@01)     RELOAD REGISTERS
         ST    @13,4(,@01)         BACK CHAIN NEW SAVEAREA TO OLD
         ST    @01,8(,@13)         FORWARD CHAIN FROM OLD TO NEW
         LR    @13,@01             R13 NOW POINTS TO NEW SAVEAREA
*   RESPECIFY                                                      0072
*    (GPR00P,                                                      0072
*     GPR01P,                                                      0072
*     GPR14P,                                                      0072
*     GPR15P) UNRESTRICTED;                                        0072
*                                                                  0072
*/* BEGIN MOVE SEGMENT.  THIS CODE IS ENTERED DISABLED AND EXECUTES
*       WITH NO PAGE FAULTS.  THE FUNCTION IS TO MOVE DATA INTO    0073
*       STORAGE OBTAINED BY THE PROLOG                               */
*                                                                  0073
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH DEVICE CLASSES AND MOVE DATA FROM EVENT DRIVEN   */
*   /* DATA COLLECTION AREAS INTO TEMPORARILY FIXED INTERVAL DATA    */
*   /* AREAS POINT TO POSITION OF FIRST SMF RECORD                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0073
*   DDSMFPTR=DDSMIADD+LENGTH(DDDVADD)*DIM(DDDVADD);                0073
         LA    DDSMFPTR,24                                         0073
         ALR   DDSMFPTR,DDSMIADD                                   0073
*   DO DDDCDIDX=1 TO DIM(EDDCDT);   /* LOOP THROUGH DEVICE CLASSES   */
         LA    DDDCDIDX,1                                          0074
@DL00074 DS    0H                                                  0075
*     IF EDDCDNUM(DDDCDIDX)=0 THEN  /* IF NO DATA EXISTS FOR THIS  0075
*                                      CLASS                         */
         SLR   @10,@10                                             0075
         LR    @06,DDDCDIDX                                        0075
         SLA   @06,3                                               0075
         L     @05,@PC00001                                        0075
         L     @05,DDSMAPTR(,@05)                                  0075
         L     @05,STSMEDAD(,@05)                                  0075
         L     @05,EDDEDCDT(,@05)                                  0075
         AL    @05,@CF00648                                        0075
         CH    @10,EDDCDNUM-4(@06,@05)                             0075
         BNE   @RF00075                                            0075
*       DO;                                                        0076
*                                                                  0076
*         /***********************************************************/
*         /*                                                         */
*         /* INDICATE NO SMF RECORD BECAUSE NO DEVICES EXIST IN THIS */
*         /* CLASS                                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0077
*         DDSMIADD->DDDVADD(DDDCDIDX)=0;                           0077
         LR    @06,DDDCDIDX                                        0077
         SLA   @06,2                                               0077
         AL    @06,@CF00648                                        0077
         ST    @10,DDDVADD(@06,DDSMIADD)                           0077
*         GO TO DDLAB2;             /* CONTINUE LOOPING THROUGH    0078
*                                      CLASSES                       */
         B     DDLAB2                                              0078
*       END;                                                       0079
*                                                                  0079
*     /***************************************************************/
*     /*                                                             */
*     /* POINT DVT ENTRY TO SMF RECORD                               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0080
*     DDSMIADD->DDDVADD(DDDCDIDX)=DDSMFPTR;                        0080
*                                                                  0080
@RF00075 LR    @10,DDDCDIDX                                        0080
         SLA   @10,2                                               0080
         AL    @10,@CF00648                                        0080
         ST    DDSMFPTR,DDDVADD(@10,DDSMIADD)                      0080
*     /***************************************************************/
*     /*                                                             */
*     /* MOVE IN STANDARD SMF HEADER                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0081
*     SMFRCD74=DDSMFHDR(1:LENGTH(SMFRCD74));                       0081
*                                                                  0081
         L     @10,@PC00001+16                                     0081
         MVC   SMFRCD74(48,DDSMFPTR),DDSMFHDR(@10)                 0081
*     /***************************************************************/
*     /*                                                             */
*     /* FILL IN UNSET FIELDS                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0082
*     SMF74RTY=DDRCDTYP;            /* RECORD TYPE                   */
         MVI   SMF74RTY(DDSMFPTR),X'4A'                            0082
*     SMF74SUB(2)=DDUCBTYP(DDDCDIDX);/* SET DEVICE CLASS BYTE        */
         LA    @10,DDUCBTYP-1(DDDCDIDX)                            0083
         MVC   SMF74SUB+1(1,DDSMFPTR),0(@10)                       0083
*     SMF74SAM=EDDESAMP;            /* NUMBER OF SAMPLES             */
         L     @10,@PC00001                                        0084
         L     @10,DDSMAPTR(,@10)                                  0084
         L     @10,STSMEDAD(,@10)                                  0084
         L     @06,EDDESAMP(,@10)                                  0084
         ST    @06,SMF74SAM(,DDSMFPTR)                             0084
*     SMF74A=SMF74A&&SMF74A;        /* ZERO DEVICE CONTROL AREA      */
         LA    @06,SMF74SIZ(,DDSMFPTR)                             0085
         AH    @06,SMF74SIZ(,DDSMFPTR)                             0085
         XC    SMF74A(8,@06),SMF74A(@06)                           0085
*     SMF74SDC=LENGTH(SMF74A);      /* SIZE OF DEVICE CONTROL AREA   */
         MVC   SMF74SDC(2,@06),@CH00056                            0086
*     SMF74SDD=LENGTH(SMF74B);      /* SIZE OF EACH DEVICE DATA AREA */
*                                                                  0087
         LA    @05,28                                              0087
         STH   @05,SMF74SDD(,@06)                                  0087
*     /***************************************************************/
*     /*                                                             */
*     /* SET DEVICE COUNT AND RECORD LENGTH                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0088
*     SMF74DEV=EDDCDNUM(DDDCDIDX);                                 0088
         LR    @03,DDDCDIDX                                        0088
         SLA   @03,3                                               0088
         L     @10,EDDEDCDT(,@10)                                  0088
         AL    @10,@CF00648                                        0088
         LH    @10,EDDCDNUM-4(@03,@10)                             0088
         STH   @10,SMF74DEV(,@06)                                  0088
*     SMF74LEN=LENGTH(SMFRCD74)+LENGTH(SMF74A)+LENGTH(SMF74B)*SMF74DEV;
*                                                                  0089
         LR    @01,@10                                             0089
         MR    @00,@05                                             0089
         AL    @01,@CF00643                                        0089
         STH   @01,SMF74LEN(,DDSMFPTR)                             0089
*     /***************************************************************/
*     /*                                                             */
*     /* LOOP THROUGH ALL DDBS IN TABLE                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0090
*     DO DDDDBIDX=1 TO EDDCDNUM(DDDCDIDX);                         0090
*                                                                  0090
         LA    DDDDBIDX,1                                          0090
         B     @DE00090                                            0090
@DL00090 DS    0H                                                  0091
*       /*************************************************************/
*       /*                                                           */
*       /* ZERO STORAGE                                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0091
*       SMF74B(DDDDBIDX)=SMF74B(DDDDBIDX)&&SMF74B(DDDDBIDX);       0091
*                                                                  0091
         LR    @10,DDDDBIDX                                        0091
         MH    @10,@CH00642                                        0091
         LA    @06,SMF74SIZ(,DDSMFPTR)                             0091
         AH    @06,SMF74SIZ(,DDSMFPTR)                             0091
         LH    @05,SMF74SDC(,@06)                                  0091
         ALR   @05,@06                                             0091
         ST    @10,@TF00001                                        0091
         ALR   @10,@05                                             0091
         AL    @10,@CF00649                                        0091
         XC    SMF74B(28,@10),SMF74B(@10)                          0091
*       /*************************************************************/
*       /*                                                           */
*       /* ANTICIPATE AND INDICATE AN INVALID ENTRY                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0092
*       SMF74TYP(DDDDBIDX)=DDNOTVLD;                               0092
*                                                                  0092
         AL    @05,@TF00001                                        0092
         AL    @05,@CF00650                                        0092
         MVC   SMF74TYP-4(4,@05),@CB00607                          0092
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEVICE ENTRY IS INVALID THEN SKIP PROCESSING           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0093
*       IF EDDDVALD(DDDDBIDX)='0'B THEN                            0093
         LR    @10,DDDDBIDX                                        0093
         MH    @10,@CH00644                                        0093
         LR    @06,DDDCDIDX                                        0093
         SLA   @06,3                                               0093
         L     @05,@PC00001                                        0093
         L     @05,DDSMAPTR(,@05)                                  0093
         L     @05,STSMEDAD(,@05)                                  0093
         L     @05,EDDEDCDT(,@05)                                  0093
         AL    @05,@CF00647                                        0093
         L     @06,EDDCDDBQ(@06,@05)                               0093
         ST    @10,@TF00001                                        0093
         ALR   @10,@06                                             0093
         AL    @10,@CF00651                                        0093
         TM    EDDDVALD(@10),B'00000100'                           0093
         BZ    @RT00093                                            0093
*         GO TO DDLAB1;             /* MOVE PTR TO NEXT SMF SLOT     */
*                                                                  0094
*       /*************************************************************/
*       /*                                                           */
*       /* USE COMPARE AND SWAP LOGIC IN THE FOLLOWING CODE MACDATE  */
*       /* Y-2 73018                                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0095
*       RESPECIFY                                                  0095
*        (GPR00P,                                                  0095
*         GPR05P) RESTRICTED;                                      0095
*       GPR05P=ADDR(EDDDFLGS(DDDDBIDX));                           0096
         L     GPR05P,@TF00001                                     0096
         AL    @06,@CF00651                                        0096
         LA    GPR05P,EDDDFLGS(GPR05P,@06)                         0096
*DDLAB0:                                                           0097
*                                                                  0097
*       /*************************************************************/
*       /*                                                           */
*       /* GET WORD CONTAINING FLAGS                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0097
*       GENERATE(L  GPR00P,0(,GPR05P));                            0097
*                                                                  0097
DDLAB0   L  GPR00P,0(,GPR05P)
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATE AND PACK UCB ADDRESS FROM EBCDIC INTO PACKED    */
*       /* FORM HHHF WHERE H IS HEXIDECIMAL AND F IS A ZONE FIELD GET*/
*       /* EBCDIC DEVICE ADDRESS. USE UNSET FIELD IN SMF RECORD FOR  */
*       /* WORKING STORAGE                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0098
*       SMF74IST(1:3)=EDDDADDR(DDDDBIDX);                          0098
         LR    @10,DDDDBIDX                                        0098
         MH    @10,@CH00644                                        0098
         LR    @06,DDDCDIDX                                        0098
         SLA   @06,3                                               0098
         L     @01,@PC00001                                        0098
         L     @01,DDSMAPTR(,@01)                                  0098
         L     @01,STSMEDAD(,@01)                                  0098
         L     @01,EDDEDCDT(,@01)                                  0098
         AL    @01,@CF00647                                        0098
         L     @06,EDDCDDBQ(@06,@01)                               0098
         ST    @10,@TF00001                                        0098
         ALR   @10,@06                                             0098
         AL    @10,@CF00652                                        0098
         MVC   SMF74IST(3,DDSMFPTR),EDDDADDR-1(@10)                0098
*       TR(SMF74IST(1:3),DDTRTAB);  /* TRANSLATE                     */
*                                                                  0099
         TR    SMF74IST(3,DDSMFPTR),DDTRTAB                        0099
*       /*************************************************************/
*       /*                                                           */
*       /* PACK INTO PROPER POSITION IN SMF RECORD                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0100
*       PACK(SMF74ADD(DDDDBIDX),SMF74IST(1:3));                    0100
*                                                                  0100
         LR    @10,DDDDBIDX                                        0100
         MH    @10,@CH00642                                        0100
         LA    @01,SMF74SIZ(,DDSMFPTR)                             0100
         AH    @01,SMF74SIZ(,DDSMFPTR)                             0100
         LH    @15,SMF74SDC(,@01)                                  0100
         ALR   @15,@01                                             0100
         ST    @10,@TF00002                                        0100
         ALR   @10,@15                                             0100
         AL    @10,@CF00649                                        0100
         PACK  SMF74ADD(2,@10),SMF74IST(3,DDSMFPTR)                0100
*       /*************************************************************/
*       /*                                                           */
*       /* SET DEVICE TYPE INFORMATION                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0101
*       SMF74TYP(DDDDBIDX)=UCBTYP;                                 0101
*                                                                  0101
         LR    @10,@15                                             0101
         AL    @10,@TF00002                                        0101
         AL    @10,@CF00650                                        0101
         L     @01,@TF00001                                        0101
         AL    @01,@CF00653                                        0101
         LH    @01,EDDDUCBA-4(@01,@06)                             0101
         N     @01,@CF00654                                        0101
         MVC   SMF74TYP-4(4,@10),UCBTYP(@01)                       0101
*       /*************************************************************/
*       /*                                                           */
*       /* SET VOLUME SERIAL NUMBER IF DASD OR TAPE. OTHERWISE, BLANK*/
*       /* OUT FIELD                                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0102
*       IF(UCB3TAPE='1'B×UCB3DACC='1'B)&EDDDALIV(DDDDBIDX)='1'B THEN
         TM    UCB3TAPE(@01),B'10100000'                           0102
         BZ    @RF00102                                            0102
         AL    @06,@TF00001                                        0102
         AL    @06,@CF00651                                        0102
         TM    EDDDALIV(@06),B'00000001'                           0102
         BNO   @RF00102                                            0102
*         DO;                                                      0103
*           IF UCBMTPXP='0'B        /* IF NOT MULTIPLE EXPOSURE DEV  */
*             THEN                  /* GET VOL SER FROM THIS UCB     */
         TM    UCBMTPXP(@01),B'00001000'                           0104
         BNZ   @RF00104                                            0104
*             SMF74SER(DDDDBIDX)=UCBVOLI;                          0105
         AL    @15,@TF00002                                        0105
         AL    @15,@CF00651                                        0105
         MVC   SMF74SER-8(6,@15),UCBVOLI(@01)                      0105
*           ELSE                    /* GET VOL SER FROM BASE UCB     */
*             SMF74SER(DDDDBIDX)=(UCBBASE+LENGTH(UCB))->UCBVOLI;   0106
         B     @RC00104                                            0106
@RF00104 LR    @10,DDDDBIDX                                        0106
         MH    @10,@CH00642                                        0106
         LA    @06,SMF74SIZ(,DDSMFPTR)                             0106
         AH    @06,SMF74SIZ(,DDSMFPTR)                             0106
         LH    @01,SMF74SDC(,@06)                                  0106
         ALR   @01,@06                                             0106
         ALR   @01,@10                                             0106
         AL    @01,@CF00651                                        0106
         LR    @10,DDDDBIDX                                        0106
         MH    @10,@CH00644                                        0106
         LR    @06,DDDCDIDX                                        0106
         SLA   @06,3                                               0106
         L     @15,@PC00001                                        0106
         L     @15,DDSMAPTR(,@15)                                  0106
         L     @15,STSMEDAD(,@15)                                  0106
         L     @15,EDDEDCDT(,@15)                                  0106
         AL    @15,@CF00647                                        0106
         L     @06,EDDCDDBQ(@06,@15)                               0106
         AL    @06,@CF00653                                        0106
         LH    @10,EDDDUCBA-4(@10,@06)                             0106
         N     @10,@CF00654                                        0106
         L     @10,UCBBASE(,@10)                                   0106
         MVC   SMF74SER-8(6,@01),UCBVOLI+512(@10)                  0106
*         END;                                                     0107
*       ELSE                                                       0108
*         SMF74SER(DDDDBIDX)=' ';                                  0108
*                                                                  0108
         B     @RC00102                                            0108
@RF00102 LR    @10,DDDDBIDX                                        0108
         MH    @10,@CH00642                                        0108
         LA    @06,SMF74SIZ(,DDSMFPTR)                             0108
         AH    @06,SMF74SIZ(,DDSMFPTR)                             0108
         LH    @01,SMF74SDC(,@06)                                  0108
         ALR   @01,@06                                             0108
         ALR   @01,@10                                             0108
         AL    @01,@CF00651                                        0108
         MVI   SMF74SER-7(@01),C' '                                0108
         MVC   SMF74SER-6(4,@01),SMF74SER-7(@01)                   0108
         MVI   SMF74SER-8(@01),C' '                                0108
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEVICE IS ONLINE                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0109
*       IF EDDDALIV(DDDDBIDX)='1'B THEN                            0109
@RC00102 LR    @10,DDDDBIDX                                        0109
         MH    @10,@CH00644                                        0109
         LR    @06,DDDCDIDX                                        0109
         SLA   @06,3                                               0109
         L     @01,@PC00001                                        0109
         L     @01,DDSMAPTR(,@01)                                  0109
         L     @01,STSMEDAD(,@01)                                  0109
         L     @01,EDDEDCDT(,@01)                                  0109
         AL    @01,@CF00647                                        0109
         L     @06,EDDCDDBQ(@06,@01)                               0109
         ST    @10,@TF00001                                        0109
         ALR   @10,@06                                             0109
         AL    @10,@CF00651                                        0109
         TM    EDDDALIV(@10),B'00000001'                           0109
         BNO   @RF00109                                            0109
*         DO;                       /* INSERT DATA (SIOS,BUSY      0110
*                                      SAMPLES, AND ENQUEUED SRB   0110
*                                      COUNT) AND INDICATE ONLINE    */
*           SMF74CNT(DDDDBIDX)=EDDDSIOS(DDDDBIDX);                 0111
         LR    @10,DDDDBIDX                                        0111
         MH    @10,@CH00642                                        0111
         LA    @01,SMF74SIZ(,DDSMFPTR)                             0111
         AH    @01,SMF74SIZ(,DDSMFPTR)                             0111
         LH    @15,SMF74SDC(,@01)                                  0111
         ALR   @15,@01                                             0111
         L     @01,@TF00001                                        0111
         AL    @01,@CF00655                                        0111
         L     @01,EDDDSIOS-8(@01,@06)                             0111
         LA    @14,0(@10,@15)                                      0111
         AL    @14,@CF00655                                        0111
         ST    @01,SMF74CNT-16(,@14)                               0111
*           SMF74ACT(DDDDBIDX)=EDDDBUSY(DDDDBIDX);                 0112
         L     @01,@TF00001                                        0112
         AL    @01,@CF00647                                        0112
         L     @01,EDDDBUSY-12(@01,@06)                            0112
         LA    @14,0(@10,@15)                                      0112
         AL    @14,@CF00647                                        0112
         ST    @01,SMF74ACT-20(,@14)                               0112
*           SMF74QUE(DDDDBIDX)=EDDDNENQ(DDDDBIDX);                 0113
         L     @01,@TF00001                                        0113
         AL    @06,@CF00648                                        0113
         L     @06,EDDDNENQ-16(@01,@06)                            0113
         LA    @01,0(@10,@15)                                      0113
         AL    @01,@CF00648                                        0113
         ST    @06,SMF74QUE-24(,@01)                               0113
*           SMF74STA(DDDDBIDX)='1'B;                               0114
         ALR   @15,@10                                             0114
         AL    @15,@CF00656                                        0114
         OI    SMF74STA-3(@15),B'00000001'                         0114
*         END;                                                     0115
*       ELSE                        /* OFFLINE                       */
*         DO;                       /* ZERO DATA AND INDICATE OFFLINE*/
         B     @RC00109                                            0116
@RF00109 DS    0H                                                  0117
*           SMF74CNT(DDDDBIDX)=0;                                  0117
         SLR   @10,@10                                             0117
         LR    @06,DDDDBIDX                                        0117
         MH    @06,@CH00642                                        0117
         LA    @01,SMF74SIZ(,DDSMFPTR)                             0117
         AH    @01,SMF74SIZ(,DDSMFPTR)                             0117
         LH    @15,SMF74SDC(,@01)                                  0117
         ALR   @15,@01                                             0117
         LA    @01,0(@06,@15)                                      0117
         AL    @01,@CF00655                                        0117
         ST    @10,SMF74CNT-16(,@01)                               0117
*           SMF74ACT(DDDDBIDX)=0;                                  0118
         LA    @01,0(@06,@15)                                      0118
         AL    @01,@CF00647                                        0118
         ST    @10,SMF74ACT-20(,@01)                               0118
*           SMF74QUE(DDDDBIDX)=0;                                  0119
         LA    @01,0(@06,@15)                                      0119
         AL    @01,@CF00648                                        0119
         ST    @10,SMF74QUE-24(,@01)                               0119
*           SMF74STA(DDDDBIDX)='0'B;                               0120
         ALR   @15,@06                                             0120
         AL    @15,@CF00656                                        0120
         NI    SMF74STA-3(@15),B'11111110'                         0120
*         END;                                                     0121
*                                                                  0121
*       /*************************************************************/
*       /*                                                           */
*       /* SET CONFIGURATION CHANGED FLAG                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0122
*       IF EDDDCCHG(DDDDBIDX)='1'B THEN                            0122
@RC00109 LR    @10,DDDDBIDX                                        0122
         MH    @10,@CH00644                                        0122
         LR    @06,DDDCDIDX                                        0122
         SLA   @06,3                                               0122
         L     @01,@PC00001                                        0122
         L     @01,DDSMAPTR(,@01)                                  0122
         L     @01,STSMEDAD(,@01)                                  0122
         L     @01,EDDEDCDT(,@01)                                  0122
         AL    @01,@CF00647                                        0122
         L     @01,EDDCDDBQ(@06,@01)                               0122
         ALR   @01,@10                                             0122
         AL    @01,@CF00651                                        0122
         TM    EDDDCCHG(@01),B'00000010'                           0122
         BNO   @RF00122                                            0122
*         SMF74VAC(DDDDBIDX)='1'B;                                 0123
         LR    @10,DDDDBIDX                                        0123
         MH    @10,@CH00642                                        0123
         LA    @06,SMF74SIZ(,DDSMFPTR)                             0123
         AH    @06,SMF74SIZ(,DDSMFPTR)                             0123
         LH    @01,SMF74SDC(,@06)                                  0123
         ALR   @01,@06                                             0123
         ALR   @01,@10                                             0123
         AL    @01,@CF00656                                        0123
         OI    SMF74VAC-3(@01),B'00000010'                         0123
*       ELSE                                                       0124
*         SMF74VAC(DDDDBIDX)='0'B;                                 0124
*                                                                  0124
         B     @RC00122                                            0124
@RF00122 LR    @10,DDDDBIDX                                        0124
         MH    @10,@CH00642                                        0124
         LA    @06,SMF74SIZ(,DDSMFPTR)                             0124
         AH    @06,SMF74SIZ(,DDSMFPTR)                             0124
         LH    @01,SMF74SDC(,@06)                                  0124
         ALR   @01,@06                                             0124
         ALR   @01,@10                                             0124
         AL    @01,@CF00656                                        0124
         NI    SMF74VAC-3(@01),B'11111101'                         0124
*       /*************************************************************/
*       /*                                                           */
*       /* MACDATE Y-2 73018                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0125
*       RESPECIFY                                                  0125
*        (GPR06P) RESTRICTED;                                      0125
@RC00122 DS    0H                                                  0126
*       GPR06P=GPR00P&EDDDCCOF;     /* TURN OFF CONFIGURATION CHANGED
*                                      FLAG                          */
         LR    GPR06P,GPR00P                                       0126
         N     GPR06P,@CF00137                                     0126
*       GENERATE(CS GPR00P,GPR06P,0(GPR05P));                      0127
         CS GPR00P,GPR06P,0(GPR05P)
*       BC(7,DDLAB0);               /* TRY AGAIN IF UNSUCCESSFUL     */
*                                                                  0128
         BC    7,DDLAB0                                            0128
*       /*************************************************************/
*       /*                                                           */
*       /* MACDATE Y-2 73018                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0129
*       RESPECIFY                                                  0129
*        (GPR00P,                                                  0129
*         GPR06P,                                                  0129
*         GPR05P) UNRESTRICTED;                                    0129
*DDLAB1:                                                           0130
*     END;                          /* END OF A DEVICE CLASS CHECK   */
*                                                                  0130
DDLAB1   AL    DDDDBIDX,@CF00060                                   0130
@DE00090 LR    @10,DDDCDIDX                                        0130
         SLA   @10,3                                               0130
         L     @06,@PC00001                                        0130
         L     @06,DDSMAPTR(,@06)                                  0130
         L     @06,STSMEDAD(,@06)                                  0130
         L     @06,EDDEDCDT(,@06)                                  0130
         AL    @06,@CF00648                                        0130
         CH    DDDDBIDX,EDDCDNUM-4(@10,@06)                        0130
         BNH   @DL00090                                            0130
*     /***************************************************************/
*     /*                                                             */
*     /* POINT TO NEXT SMF RECORD SLOT                               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0131
*     DDSMFPTR=DDSMFPTR+SMF74LEN;                                  0131
         AH    DDSMFPTR,SMF74LEN(,DDSMFPTR)                        0131
*DDLAB2:                                                           0132
*   END;                            /* END OF A DEVICE CLASS CHECK   */
*                                                                  0132
DDLAB2   AL    DDDCDIDX,@CF00060                                   0132
         C     DDDCDIDX,@CF00080                                   0132
         BNH   @DL00074                                            0132
*   /*****************************************************************/
*   /*                                                               */
*   /* DDEPILOG: IRBBREAK MACDATE Y-2 73018                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0133
*DDEPILOG:                                                         0133
*                                                                  0133
*   /*****************************************************************/
*   /*                                                               */
*   /* INDICATE NEXT ROUTINE ADDRESS TO SVC MAINLINE FOR REENTRY     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0133
*   STSMENTR=ADDR(DDRT0025);                                       0133
DDEPILOG L     @10,@PC00001                                        0133
         L     @10,DDSMAPTR(,@10)                                  0133
         LA    @06,DDRT0025                                        0133
         ST    @06,STSMENTR(,@10)                                  0133
*   RESPECIFY                                                      0134
*    (GPR00P,                                                      0134
*     GPR01P,                                                      0134
*     GPR14P,                                                      0134
*     GPR15P) RESTRICTED;                                          0134
*   GENERATE;                                                      0135
         STM   @02,@12,28(@13)     SAVE REGISTERS FOR NEXT SEGMENT
         L     @13,4(,@13)         BACK CHAIN TO CALLERS SAVEAREA
         LM    @14,@12,12(@13)     RESTORE CALLERS REGISTERS
         BR    @14                 RETURN TO CALLER
*                                                                  0136
*   /*****************************************************************/
*   /*                                                               */
*   /* REENTRY POINT FROM CALLER, IGX00014.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0136
*DDRT0025:                                                         0136
*   GENERATE;                                                      0136
DDRT0025 DS    0H                                                  0136
         STM   @14,@12,12(@13)     SAVE CALLERS REGISTERS
         L     @01,0(,@01)         GET ADDRESS OF SAVE AREA ADDRESS
         L     @01,0(,@01)         GET SAVE AREA ADDRESS
         LM    @02,@12,28(@01)     RELOAD REGISTERS
         ST    @13,4(,@01)         BACK CHAIN NEW SAVEAREA TO OLD
         ST    @01,8(,@13)         FORWARD CHAIN FROM OLD TO NEW
         LR    @13,@01             R13 NOW POINTS TO NEW SAVEAREA
*   RESPECIFY                                                      0137
*    (GPR00P,                                                      0137
*     GPR01P,                                                      0137
*     GPR14P,                                                      0137
*     GPR15P) UNRESTRICTED;                                        0137
*                                                                  0137
*/* BEGIN EPILOG PROCESSING.  THIS CODE IS ENTERED ENABLED.  ITS   0138
*   FUNCTION IS TO FREE FIXED PROGRAMS AND DATA AND TO TRACE IF    0138
*   DESIRED                                                          */
*                                                                  0138
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE PROGRAM AND LOCAL STATIC DATA MACDATE Y-2 73018          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0138
*   RESPECIFY                                                      0138
*    (GPR00P,                                                      0138
*     GPR01P,                                                      0138
*     GPR14P,                                                      0138
*     GPR15P) RESTRICTED;                                          0138
*   GENERATE;                                                      0139
*                                                                  0139
DDPAGFX4 PGFREE  R,A=IRBMFDDP,EA=@ENDDATA,RELATED=(MFDDPGFX,           X
               IRBMFDDP(DDPAGFX1))
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0140
*   RESPECIFY                                                      0140
*    (GPR00P,                                                      0140
*     GPR01P,                                                      0140
*     GPR14P,                                                      0140
*     GPR15P) UNRESTRICTED;                                        0140
*                                                                  0140
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE AUTOMATIC STORAGE MACDATE Y-2 73018                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0141
*   RESPECIFY                                                      0141
*    (GPR00P,                                                      0141
*     GPR01P,                                                      0141
*     GPR14P,                                                      0141
*     GPR15P) RESTRICTED;                                          0141
*   GENERATE;                                                      0142
*                                                                  0142
         LA    GPR15P,@ENDDATD      END ADDRESS
         LA    GPR01P,@DATD         BEGINNING ADDRESS
DDPAGFX5 PGFREE R,A=(GPR01P),EA=(GPR15P),RELATED=(MFDDATFX,            X
               IRBMFDDP(DDPAGFX2))
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0143
*   RESPECIFY                                                      0143
*    (GPR00P,                                                      0143
*     GPR01P,                                                      0143
*     GPR14P,                                                      0143
*     GPR15P) UNRESTRICTED;                                        0143
*   STRVNSGT=STRVNSGT-1;            /* REMOVE ENTRY FOR AUTO STORAGE */
*                                                                  0144
         L     @10,@PC00001                                        0144
         L     @10,DDSMAPTR(,@10)                                  0144
         L     @06,STSMRVT(,@10)                                   0144
         L     @15,STRVNSGT(,@06)                                  0144
         BCTR  @15,0                                               0144
         ST    @15,STRVNSGT(,@06)                                  0144
*   /*****************************************************************/
*   /*                                                               */
*   /* UNFIX INTERVAL DATA STORAGE MACDATE Y-2 73018                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0145
*   RESPECIFY                                                      0145
*    (GPR00P,                                                      0145
*     GPR01P,                                                      0145
*     GPR14P,                                                      0145
*     GPR15P) RESTRICTED;                                          0145
*   GPR01P=DDSMIADD-LENGTH(STSMIGMC);/* BEGINNING ADDRESS            */
         LR    GPR01P,DDSMIADD                                     0146
         SL    GPR01P,@CF00175                                     0146
*   GPR15P=GPR01P+STSMILEN;                                        0147
         LR    GPR15P,GPR01P                                       0147
         L     @10,STSMILEN-1(,@10)                                0147
         LA    @10,0(,@10)                                         0147
         ALR   GPR15P,@10                                          0147
*   GENERATE;                                                      0148
*                                                                  0148
DDPAGFX6 PGFREE  R,A=(GPR01P),EA=(GPR15P),RELATED=(MFDDISFX,           X
               IRBMFDDP(DDPAGFX3))
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0149
*   RESPECIFY                                                      0149
*    (GPR00P,                                                      0149
*     GPR01P,                                                      0149
*     GPR14P,                                                      0149
*     GPR15P) UNRESTRICTED;                                        0149
*   IF DDFSTCLL='1'B THEN           /* RETURN IF FIRST CALL, RETURN  */
         L     @10,@PC00001+8                                      0150
         TM    DDFSTCLL(@10),B'10000000'                           0150
         BO    @RT00150                                            0150
*     RETURN;                       /* RETURN TO MFDATA SVC PROCESSOR*/
*                                                                  0151
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW HAVE TWO PARTIALLY COMPLETED SETS OF SMF RECORDS. EACH    */
*   /* TIED TOGETHER WITH A DVT. ONE SET CONTAINS DATA FROM THE LAST */
*   /* INTERVAL (POINTED TO BY DDDTAPTR). THE OTHER SET CONTAINS DATA*/
*   /* COLLECTED AT THIS INTERVAL (POINTED TO BY DDSMIADD). COMPLETE */
*   /* THE SMF RECORDS POINTED TO BY DDDTAPTR. PROVIDE DEFAULT       */
*   /* ADDRESSABILITY TO THIS OF OUTPUT RECORDS. THE OTHER SET WILL  */
*   /* BE EXPLICITLY POINTER QUALIFIED. LOOP THROUGH DEVICE CLASSES. */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0152
*   DDSMFTOT=0;                     /* INITIALIZE ACTUAL TOTAL SMF 0152
*                                      RECORD LENGTH FOR ALL CLASSES */
         SLR   @10,@10                                             0152
         ST    @10,DDSMFTOT                                        0152
*   DO DDDVTIDX=1 TO DIM(DDDVADD);                                 0153
         LA    @10,1                                               0153
         ST    @10,DDDVTIDX                                        0153
@DL00153 DS    0H                                                  0154
*     IF DDDVADD(DDDVTIDX)^=0 THEN  /* IF SMF RECORD EXISTS          */
         SLA   @10,2                                               0154
         L     @06,DDDTAPTR                                        0154
         AL    @06,@CF00648                                        0154
         L     @06,DDDVADD(@10,@06)                                0154
         LTR   @06,@06                                             0154
         BZ    @RF00154                                            0154
*       DO;                                                        0155
*                                                                  0155
*         /***********************************************************/
*         /*                                                         */
*         /* ESTABLISH POINTER TO THIS RECORD SMF74B ARRAY           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0156
*         RESPECIFY                                                0156
*           DDDVT BASED(DDSMIADD);                                 0156
*         RESPECIFY                                                0157
*           SMFRCD74 BASED(DDDVADD(DDDVTIDX));                     0157
*         DDSMFB=ADDR(SMF74B);                                     0158
*                                                                  0158
         AL    @10,@CF00648                                        0158
         L     @10,DDDVADD(@10,DDSMIADD)                           0158
         LA    DDSMFB,SMF74SIZ(,@10)                               0158
         AH    DDSMFB,SMF74SIZ(,@10)                               0158
         LH    @10,SMF74SDC(,DDSMFB)                               0158
         ALR   @10,DDSMFB                                          0158
         LR    DDSMFB,@10                                          0158
*         /***********************************************************/
*         /*                                                         */
*         /* REESTABLISH ADDRESSABILITY TO SUPERVISOR OUTPUT SET OF  */
*         /* SMF DATA                                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0159
*         RESPECIFY                                                0159
*           DDDVT BASED(DDDTAPTR);                                 0159
*         RESPECIFY                                                0160
*           SMFRCD74 BASED(DDSMFPTR);                              0160
*                                                                  0160
*         /***********************************************************/
*         /*                                                         */
*         /* ESTABLISH ADDRESSABILITY TO OUTPUT SMF RECORD.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0161
*         DDSMFPTR=DDDVADD(DDDVTIDX);                              0161
*                                                                  0161
         LR    DDSMFPTR,@06                                        0161
*         /***********************************************************/
*         /*                                                         */
*         /* COMPLETE SMF RECORD                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0162
*         SMF74IST=DDINTSRT;        /* INTERVAL START TIME           */
         L     @10,@PC00001+24                                     0162
         MVC   SMF74IST(4,DDSMFPTR),DDINTSRT(@10)                  0162
*         SMF74DAT=DDINTDAT;        /* INTERVAL START DATE           */
         L     @10,@PC00001+28                                     0163
         MVC   SMF74DAT(4,DDSMFPTR),DDINTDAT(@10)                  0163
*         SMF74INT=DDINTLEN;        /* INTERVAL DURATION             */
         L     @10,@PC00001+32                                     0164
         MVC   SMF74INT(4,DDSMFPTR),DDINTLEN(@10)                  0164
*         DDDEVCNT=1;               /* COUNT OF VALID OUTPUT DEVICE
*                                      ENTRIES                       */
*                                                                  0165
         LA    @10,1                                               0165
         LR    DDDEVCNT,@10                                        0165
*         /***********************************************************/
*         /*                                                         */
*         /* LOOP THROUGH DEVICES IN THIS CLASS                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0166
*         DO DDDEVIX1=1 TO SMF74DEV;                               0166
*                                                                  0166
         LR    DDDEVIX1,@10                                        0166
         B     @DE00166                                            0166
@DL00166 DS    0H                                                  0167
*           /*********************************************************/
*           /*                                                       */
*           /* IF THIS DEVICE IS VALID NOW                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0167
*           IF DDSMFB->SMF74TYP(DDDEVIX1)^=DDNOTVLD THEN           0167
         LR    @10,DDDEVIX1                                        0167
         MH    @10,@CH00642                                        0167
         ST    @10,@TF00001                                        0167
         ALR   @10,DDSMFB                                          0167
         AL    @10,@CF00650                                        0167
         CLC   SMF74TYP-4(4,@10),@CB00607                          0167
         BE    @RF00167                                            0167
*             DO;                                                  0168
*                                                                  0168
*               /*****************************************************/
*               /*                                                   */
*               /* AND IF IT WAS INVALID LAST INTERVAL               */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0169
*               IF SMF74TYP(DDDEVIX1)=DDNOTVLD THEN                0169
         LA    @10,SMF74SIZ(,DDSMFPTR)                             0169
         AH    @10,SMF74SIZ(,DDSMFPTR)                             0169
         LH    @09,SMF74SDC(,@10)                                  0169
         ALR   @09,@10                                             0169
         LR    @10,@09                                             0169
         AL    @10,@TF00001                                        0169
         AL    @10,@CF00650                                        0169
         CLC   SMF74TYP-4(4,@10),@CB00607                          0169
         BNE   @RF00169                                            0169
*                 DO;                                              0170
*                                                                  0170
*                   /*************************************************/
*                   /*                                               */
*                   /* MOVE ENTRY TO OUTPUT RECORD.                  */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0171
*                   SMF74B(DDDEVIX1)=DDSMFB->SMF74B(DDDEVIX1);     0171
*                                                                  0171
         LR    @10,@09                                             0171
         AL    @10,@TF00001                                        0171
         AL    @10,@CF00649                                        0171
         LR    @06,DDSMFB                                          0171
         AL    @06,@TF00001                                        0171
         AL    @06,@CF00649                                        0171
         MVC   SMF74B(28,@10),SMF74B(@06)                          0171
*                   /*************************************************/
*                   /*                                               */
*                   /* SET VARY ACTIVITY FLAG AND ZERO SIOS, BUSY    */
*                   /* SAMPLES, AND ENQUEUED SRBS.                   */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0172
*                   SMF74VAC(DDDEVIX1)='1'B;                       0172
         LR    @10,@09                                             0172
         AL    @10,@TF00001                                        0172
         AL    @10,@CF00656                                        0172
         OI    SMF74VAC-3(@10),B'00000010'                         0172
*                   SMF74CNT(DDDEVIX1)=0;                          0173
         SLR   @10,@10                                             0173
         L     @06,@TF00001                                        0173
         AL    @06,@CF00655                                        0173
         ST    @10,SMF74CNT-16(@06,@09)                            0173
*                   SMF74ACT(DDDEVIX1)=0;                          0174
         L     @06,@TF00001                                        0174
         AL    @06,@CF00647                                        0174
         ST    @10,SMF74ACT-20(@06,@09)                            0174
*                   SMF74QUE(DDDEVIX1)=0;                          0175
         L     @06,@TF00001                                        0175
         AL    @09,@CF00648                                        0175
         ST    @10,SMF74QUE-24(@06,@09)                            0175
*                 END;                                             0176
*               ELSE                /* THIS DEVICE WAS VALID LAST  0177
*                                      INTERVAL ALSO.                */
*                 DO;                                              0177
*                                                                  0177
         B     @RC00169                                            0177
@RF00169 DS    0H                                                  0178
*                   /*************************************************/
*                   /*                                               */
*                   /* MOVE OVER DEVICE ADDRESS AND VOLUME SERIAL    */
*                   /* NUMBER                                        */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0178
*                   SMF74ADD(DDDEVIX1)=DDSMFB->SMF74ADD(DDDEVIX1); 0178
         LR    @10,DDDEVIX1                                        0178
         MH    @10,@CH00642                                        0178
         LA    @09,SMF74SIZ(,DDSMFPTR)                             0178
         AH    @09,SMF74SIZ(,DDSMFPTR)                             0178
         LH    @06,SMF74SDC(,@09)                                  0178
         ALR   @06,@09                                             0178
         ST    @10,@TF00001                                        0178
         ALR   @10,@06                                             0178
         AL    @10,@CF00649                                        0178
         LR    @09,DDSMFB                                          0178
         AL    @09,@TF00001                                        0178
         AL    @09,@CF00649                                        0178
         MVC   SMF74ADD(2,@10),SMF74ADD(@09)                       0178
*                   SMF74SER(DDDEVIX1)=DDSMFB->SMF74SER(DDDEVIX1); 0179
*                                                                  0179
         LR    @10,@06                                             0179
         AL    @10,@TF00001                                        0179
         AL    @10,@CF00651                                        0179
         LR    @09,DDSMFB                                          0179
         AL    @09,@TF00001                                        0179
         AL    @09,@CF00651                                        0179
         MVC   SMF74SER-8(6,@10),SMF74SER-8(@09)                   0179
*                   /*************************************************/
*                   /*                                               */
*                   /* MOVE OVER STATUS AND VARY FLAGS               */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0180
*                   IF DDSMFB->SMF74VAC(DDDEVIX1)='1'B THEN        0180
         LR    @10,DDSMFB                                          0180
         AL    @10,@TF00001                                        0180
         AL    @10,@CF00656                                        0180
         TM    SMF74VAC-3(@10),B'00000010'                         0180
         BNO   @RF00180                                            0180
*                     SMF74VAC(DDDEVIX1)='1'B;                     0181
         AL    @06,@TF00001                                        0181
         AL    @06,@CF00656                                        0181
         OI    SMF74VAC-3(@06),B'00000010'                         0181
*                   ELSE            /* NO VARY ACTIVITY              */
*                     SMF74VAC(DDDEVIX1)='0'B;                     0182
         B     @RC00180                                            0182
@RF00180 LR    @10,DDDEVIX1                                        0182
         MH    @10,@CH00642                                        0182
         LA    @09,SMF74SIZ(,DDSMFPTR)                             0182
         AH    @09,SMF74SIZ(,DDSMFPTR)                             0182
         LH    @06,SMF74SDC(,@09)                                  0182
         ALR   @06,@09                                             0182
         ALR   @06,@10                                             0182
         AL    @06,@CF00656                                        0182
         NI    SMF74VAC-3(@06),B'11111101'                         0182
*                   IF DDSMFB->SMF74STA(DDDEVIX1)='1'B THEN/* DEVICE
*                                      ONLINE                        */
@RC00180 LR    @10,DDDEVIX1                                        0183
         MH    @10,@CH00642                                        0183
         ST    @10,@TF00001                                        0183
         ALR   @10,DDSMFB                                          0183
         AL    @10,@CF00656                                        0183
         TM    SMF74STA-3(@10),B'00000001'                         0183
         BNO   @RF00183                                            0183
*                     SMF74STA(DDDEVIX1)='1'B;                     0184
         LA    @10,SMF74SIZ(,DDSMFPTR)                             0184
         AH    @10,SMF74SIZ(,DDSMFPTR)                             0184
         LH    @09,SMF74SDC(,@10)                                  0184
         ALR   @09,@10                                             0184
         AL    @09,@TF00001                                        0184
         AL    @09,@CF00656                                        0184
         OI    SMF74STA-3(@09),B'00000001'                         0184
*                   ELSE            /* OFFLINE                       */
*                     SMF74STA(DDDEVIX1)='0'B;                     0185
*                                                                  0185
         B     @RC00183                                            0185
@RF00183 LR    @10,DDDEVIX1                                        0185
         MH    @10,@CH00642                                        0185
         LA    @09,SMF74SIZ(,DDSMFPTR)                             0185
         AH    @09,SMF74SIZ(,DDSMFPTR)                             0185
         LH    @06,SMF74SDC(,@09)                                  0185
         ALR   @06,@09                                             0185
         ALR   @06,@10                                             0185
         AL    @06,@CF00656                                        0185
         NI    SMF74STA-3(@06),B'11111110'                         0185
*                   /*************************************************/
*                   /*                                               */
*                   /* IF VARY ACTIVITY WAS DETECTED OR IF CHANNEL IS*/
*                   /* OFFLINE, THEN ZERO DATA                       */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0186
*                   IF SMF74VAC(DDDEVIX1)='1'B×SMF74STA(DDDEVIX1)='0'B
*                     THEN                                         0186
@RC00183 LR    @10,DDDEVIX1                                        0186
         MH    @10,@CH00642                                        0186
         LA    @09,SMF74SIZ(,DDSMFPTR)                             0186
         AH    @09,SMF74SIZ(,DDSMFPTR)                             0186
         LH    @06,SMF74SDC(,@09)                                  0186
         ALR   @06,@09                                             0186
         ALR   @06,@10                                             0186
         AL    @06,@CF00656                                        0186
         TM    SMF74VAC-3(@06),B'00000010'                         0186
         BNZ   @RT00186                                            0186
         TM    SMF74STA-3(@06),B'00000001'                         0186
         BO    @RF00186                                            0186
@RT00186 DS    0H                                                  0187
*                     DO;                                          0187
*                       SMF74CNT(DDDEVIX1)=0;                      0188
         SLR   @10,@10                                             0188
         LR    @09,DDDEVIX1                                        0188
         MH    @09,@CH00642                                        0188
         LA    @06,SMF74SIZ(,DDSMFPTR)                             0188
         AH    @06,SMF74SIZ(,DDSMFPTR)                             0188
         LH    @05,SMF74SDC(,@06)                                  0188
         ALR   @05,@06                                             0188
         LA    @06,0(@09,@05)                                      0188
         AL    @06,@CF00655                                        0188
         ST    @10,SMF74CNT-16(,@06)                               0188
*                       SMF74ACT(DDDEVIX1)=0;                      0189
         LA    @06,0(@09,@05)                                      0189
         AL    @06,@CF00647                                        0189
         ST    @10,SMF74ACT-20(,@06)                               0189
*                       SMF74QUE(DDDEVIX1)=0;                      0190
         AL    @05,@CF00648                                        0190
         ST    @10,SMF74QUE-24(@09,@05)                            0190
*                     END;                                         0191
*                   ELSE            /* NO VARY ACTIVITY WAS DETECTED
*                                      AND CHANNEL IS ONLINE. MOVE 0192
*                                      DATA                          */
*                     DO;                                          0192
*                                                                  0192
         B     @RC00186                                            0192
@RF00186 DS    0H                                                  0193
*                       /*********************************************/
*                       /*                                           */
*                       /* SIOS                                      */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0193
*                       SMF74CNT(DDDEVIX1)=DDSMFB->SMF74CNT(DDDEVIX1)-
*                           SMF74CNT(DDDEVIX1);                    0193
*                                                                  0193
         LR    @10,DDDEVIX1                                        0193
         MH    @10,@CH00642                                        0193
         LA    @09,SMF74SIZ(,DDSMFPTR)                             0193
         AH    @09,SMF74SIZ(,DDSMFPTR)                             0193
         LH    @06,SMF74SDC(,@09)                                  0193
         ALR   @06,@09                                             0193
         LR    @09,DDSMFB                                          0193
         AL    @09,@CF00655                                        0193
         L     @09,SMF74CNT-16(@10,@09)                            0193
         LA    @05,0(@10,@06)                                      0193
         AL    @05,@CF00655                                        0193
         SL    @09,SMF74CNT-16(,@05)                               0193
         LA    @05,0(@10,@06)                                      0193
         AL    @05,@CF00655                                        0193
         ST    @09,SMF74CNT-16(,@05)                               0193
*                       /*********************************************/
*                       /*                                           */
*                       /* BUSY SAMPLES                              */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0194
*                       SMF74ACT(DDDEVIX1)=DDSMFB->SMF74ACT(DDDEVIX1)-
*                           SMF74ACT(DDDEVIX1);                    0194
*                                                                  0194
         LR    @09,DDSMFB                                          0194
         AL    @09,@CF00647                                        0194
         L     @09,SMF74ACT-20(@10,@09)                            0194
         LA    @05,0(@10,@06)                                      0194
         AL    @05,@CF00647                                        0194
         SL    @09,SMF74ACT-20(,@05)                               0194
         LA    @05,0(@10,@06)                                      0194
         AL    @05,@CF00647                                        0194
         ST    @09,SMF74ACT-20(,@05)                               0194
*                       /*********************************************/
*                       /*                                           */
*                       /* CUMULATIVE ENQUEUED SRBS                  */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0195
*                       SMF74QUE(DDDEVIX1)=DDSMFB->SMF74QUE(DDDEVIX1)-
*                           SMF74QUE(DDDEVIX1);                    0195
         LR    @09,DDSMFB                                          0195
         AL    @09,@CF00648                                        0195
         L     @09,SMF74QUE-24(@10,@09)                            0195
         LA    @05,0(@10,@06)                                      0195
         AL    @05,@CF00648                                        0195
         SL    @09,SMF74QUE-24(,@05)                               0195
         AL    @06,@CF00648                                        0195
         ST    @09,SMF74QUE-24(@10,@06)                            0195
*                     END;                                         0196
*                 END;                                             0197
*                                                                  0197
@RC00186 DS    0H                                                  0198
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE ENTRY INTO PROPER SLOT (IF NEEDED) AND       */
*               /* INCREMENT SLOT COUNTER                            */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0198
*               IF DDDEVCNT^=DDDEVIX1 THEN                         0198
@RC00169 CR    DDDEVCNT,DDDEVIX1                                   0198
         BE    @RF00198                                            0198
*                 DO;                                              0199
*                   DDSMFPR1=ADDR(SMF74B(DDDEVCNT));               0200
         LA    @10,28                                              0200
         LR    @01,DDDEVCNT                                        0200
         MR    @00,@10                                             0200
         LA    DDSMFPR1,SMF74SIZ(,DDSMFPTR)                        0200
         AH    DDSMFPR1,SMF74SIZ(,DDSMFPTR)                        0200
         LH    @09,SMF74SDC(,DDSMFPR1)                             0200
         ALR   @09,DDSMFPR1                                        0200
         AL    @01,@CF00649                                        0200
         LA    DDSMFPR1,SMF74B(@01,@09)                            0200
*                   DDSMFPR2=ADDR(SMF74B(DDDEVIX1));               0201
         LR    @01,@10                                             0201
         MR    @00,DDDEVIX1                                        0201
         AL    @09,@CF00649                                        0201
         LA    DDSMFPR2,SMF74B(@01,@09)                            0201
*                   DDSMFPR1->DDSMF74B=DDSMFPR2->DDSMF74B;         0202
         MVC   DDSMF74B(28,DDSMFPR1),DDSMF74B(DDSMFPR2)            0202
*                 END;                                             0203
*               DDDEVCNT=DDDEVCNT+1;                               0204
@RF00198 AL    DDDEVCNT,@CF00060                                   0204
*             END;                                                 0205
*         END;                                                     0206
*                                                                  0206
@RF00167 AL    DDDEVIX1,@CF00060                                   0206
@DE00166 LA    @10,SMF74SIZ(,DDSMFPTR)                             0206
         AH    @10,SMF74SIZ(,DDSMFPTR)                             0206
         CH    DDDEVIX1,SMF74DEV(,@10)                             0206
         BNH   @DL00166                                            0206
*         /***********************************************************/
*         /*                                                         */
*         /* SET NUMBER OF DEVICE ENTRIES                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0207
*         SMF74DEV=DDDEVCNT-1;                                     0207
         LA    @10,SMF74SIZ(,DDSMFPTR)                             0207
         AH    @10,SMF74SIZ(,DDSMFPTR)                             0207
         LR    @09,DDDEVCNT                                        0207
         BCTR  @09,0                                               0207
         STH   @09,SMF74DEV(,@10)                                  0207
*         IF DDDEVCNT=1 THEN        /* NO VALID DEVICES IN CLASS     */
         C     DDDEVCNT,@CF00060                                   0208
         BNE   @RF00208                                            0208
*           DO;                                                    0209
*             DDDVADD(DDDVTIDX)=0;  /* INDICATE NO SMF RECORD        */
         L     @10,DDDVTIDX                                        0210
         SLA   @10,2                                               0210
         SLR   @06,@06                                             0210
         L     @01,DDDTAPTR                                        0210
         AL    @01,@CF00648                                        0210
         ST    @06,DDDVADD(@10,@01)                                0210
*             GO TO DDLAB5;         /* TRY NEXT DEVICE CLASS         */
         B     DDLAB5                                              0211
*           END;                                                   0212
*                                                                  0212
*         /***********************************************************/
*         /*                                                         */
*         /* SET NUMBER OF SAMPLES                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0213
*         SMF74SAM=DDSMFNOW->SMF74SAM-SMF74SAM;                    0213
*                                                                  0213
@RF00208 L     @10,DDDVTIDX                                        0213
         SLA   @10,2                                               0213
         AL    @10,@CF00648                                        0213
         LA    @10,DDDVADD(@10,DDSMIADD)                           0213
         L     @10,DDSMFNOW(,@10)                                  0213
         L     @10,SMF74SAM(,@10)                                  0213
         SL    @10,SMF74SAM(,DDSMFPTR)                             0213
         ST    @10,SMF74SAM(,DDSMFPTR)                             0213
*         /***********************************************************/
*         /*                                                         */
*         /* SET ACTUAL RECORD LENGTH                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0214
*         SMF74LEN=LENGTH(SMFRCD74)+LENGTH(SMF74A)+SMF74DEV*LENGTH(
*             SMF74B);                                             0214
*                                                                  0214
         LA    @10,SMF74SIZ(,DDSMFPTR)                             0214
         AH    @10,SMF74SIZ(,DDSMFPTR)                             0214
         LH    @10,SMF74DEV(,@10)                                  0214
         MH    @10,@CH00642                                        0214
         AL    @10,@CF00643                                        0214
         STH   @10,SMF74LEN(,DDSMFPTR)                             0214
*         /***********************************************************/
*         /*                                                         */
*         /* INCREMENT TOTAL SMF SPACE REQUIRED                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0215
*         DDSMFTOT=DDSMFTOT+SMF74LEN;                              0215
*                                                                  0215
         AL    @10,DDSMFTOT                                        0215
         ST    @10,DDSMFTOT                                        0215
*         /***********************************************************/
*         /*                                                         */
*         /* START OF SCAN INDEX LOOP                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0216
*         DO DDDEVIX1=1 TO SMF74DEV-1;                             0216
         LA    DDDEVIX1,1                                          0216
         B     @DE00216                                            0216
@DL00216 DS    0H                                                  0217
*           DDMINIDX=DDDEVIX1;      /* FIRST MINIMUM INDEX           */
*                                                                  0217
         LR    DDMINIDX,DDDEVIX1                                   0217
*           /*********************************************************/
*           /*                                                       */
*           /* FIRST MINIMUM DEVICE ADDRESS                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0218
*           DDMINDEV=SMF74ADD(DDDEVIX1);                           0218
*                                                                  0218
         LR    @10,DDDEVIX1                                        0218
         MH    @10,@CH00642                                        0218
         LA    @04,SMF74SIZ(,DDSMFPTR)                             0218
         AH    @04,SMF74SIZ(,DDSMFPTR)                             0218
         LH    @15,SMF74SDC(,@04)                                  0218
         ALR   @15,@04                                             0218
         ALR   @15,@10                                             0218
         AL    @15,@CF00649                                        0218
         SLR   DDMINDEV,DDMINDEV                                   0218
         ICM   DDMINDEV,3,SMF74ADD(@15)                            0218
*           /*********************************************************/
*           /*                                                       */
*           /* SCAN FOR MINIMUM DEVICE ADDRESS                       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0219
*           DO DDDEVIX2=DDDEVIX1+1 TO SMF74DEV;                    0219
         LA    DDDEVIX2,1                                          0219
         ALR   DDDEVIX2,DDDEVIX1                                   0219
         B     @DE00219                                            0219
@DL00219 DS    0H                                                  0220
*             IF SMF74ADD(DDDEVIX2)<DDMINDEV THEN                  0220
*                                                                  0220
         LR    @10,DDDEVIX2                                        0220
         MH    @10,@CH00642                                        0220
         LA    @15,SMF74SIZ(,DDSMFPTR)                             0220
         AH    @15,SMF74SIZ(,DDSMFPTR)                             0220
         LH    @14,SMF74SDC(,@15)                                  0220
         ALR   @14,@15                                             0220
         ALR   @14,@10                                             0220
         AL    @14,@CF00649                                        0220
         SLR   @10,@10                                             0220
         ICM   @10,3,SMF74ADD(@14)                                 0220
         CLR   @10,DDMINDEV                                        0220
         BNL   @RF00220                                            0220
*               /*****************************************************/
*               /*                                                   */
*               /* NEW MINIMUM FOUND                                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0221
*               DO;                                                0221
*                                                                  0221
*                 /***************************************************/
*                 /*                                                 */
*                 /* NEW MINIMUM INDEX                               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0222
*                 DDMINIDX=DDDEVIX2;                               0222
*                                                                  0222
         LR    DDMINIDX,DDDEVIX2                                   0222
*                 /***************************************************/
*                 /*                                                 */
*                 /* NEW MINIMUM DEVICE ADDRESS                      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0223
*                 DDMINDEV=SMF74ADD(DDDEVIX2);                     0223
         LR    DDMINDEV,@10                                        0223
*               END;                                               0224
*           END;                                                   0225
*                                                                  0225
@RF00220 AL    DDDEVIX2,@CF00060                                   0225
@DE00219 LA    @10,SMF74SIZ(,DDSMFPTR)                             0225
         AH    @10,SMF74SIZ(,DDSMFPTR)                             0225
         CH    DDDEVIX2,SMF74DEV(,@10)                             0225
         BNH   @DL00219                                            0225
*           /*********************************************************/
*           /*                                                       */
*           /* SWITCH FIRST AND MINIMUM ENTRIES. IF NEW MINIMUM WAS  */
*           /* FOUND                                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0226
*           IF DDMINIDX^=DDDEVIX1 THEN                             0226
*                                                                  0226
         CR    DDMINIDX,DDDEVIX1                                   0226
         BE    @RF00226                                            0226
*             /*******************************************************/
*             /*                                                     */
*             /* NEW MINIMUM WAS FOUND                               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0227
*             DO;                                                  0227
*                                                                  0227
*               /*****************************************************/
*               /*                                                   */
*               /* EXCHANGE ENTRIES                                  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0228
*               DDSMFPR1=ADDR(SMF74B(DDMINIDX));                   0228
         LA    @10,28                                              0228
         LR    @01,DDMINIDX                                        0228
         MR    @00,@10                                             0228
         LA    DDSMFPR1,SMF74SIZ(,DDSMFPTR)                        0228
         AH    DDSMFPR1,SMF74SIZ(,DDSMFPTR)                        0228
         LH    @04,SMF74SDC(,DDSMFPR1)                             0228
         ALR   @04,DDSMFPR1                                        0228
         AL    @01,@CF00649                                        0228
         LA    DDSMFPR1,SMF74B(@01,@04)                            0228
*               DDSMFPR2=ADDR(SMF74B(DDDEVIX1));                   0229
         LR    @01,@10                                             0229
         MR    @00,DDDEVIX1                                        0229
         AL    @04,@CF00649                                        0229
         LA    DDSMFPR2,SMF74B(@01,@04)                            0229
*               DDSMFPR1->DDSMF74B=DDSMFPR1->DDSMF74B&&DDSMFPR2->  0230
*                   DDSMF74B;                                      0230
         XC    DDSMF74B(28,DDSMFPR1),DDSMF74B(DDSMFPR2)            0230
*               DDSMFPR2->DDSMF74B=DDSMFPR1->DDSMF74B&&DDSMFPR2->  0231
*                   DDSMF74B;                                      0231
         XC    DDSMF74B(28,DDSMFPR2),DDSMF74B(DDSMFPR1)            0231
*               DDSMFPR1->DDSMF74B=DDSMFPR1->DDSMF74B&&DDSMFPR2->  0232
*                   DDSMF74B;                                      0232
         XC    DDSMF74B(28,DDSMFPR1),DDSMF74B(DDSMFPR2)            0232
*             END;                                                 0233
*         END;                                                     0234
@RF00226 AL    DDDEVIX1,@CF00060                                   0234
@DE00216 LA    @10,SMF74SIZ(,DDSMFPTR)                             0234
         AH    @10,SMF74SIZ(,DDSMFPTR)                             0234
         LH    @10,SMF74DEV(,@10)                                  0234
         BCTR  @10,0                                               0234
         CR    DDDEVIX1,@10                                        0234
         BNH   @DL00216                                            0234
*       END;                                                       0235
*DDLAB5:                            /* LOOP ON DEVICE CLASSES        */
*   END;                                                           0236
*                                                                  0236
@RF00154 DS    0H                                                  0236
DDLAB5   LA    @10,1                                               0236
         AL    @10,DDDVTIDX                                        0236
         ST    @10,DDDVTIDX                                        0236
         C     @10,@CF00080                                        0236
         BNH   @DL00153                                            0236
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE TO SMF DATA SET IF DIRECTED TO DO SO                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0237
*   IF DDTRACE='1'B THEN            /* IF TRACE IS DESIRED           */
         L     @10,@PC00001+12                                     0237
         TM    DDTRACE(@10),B'10000000'                            0237
         BNO   @RF00237                                            0237
*     DO DDDVTIDX=1 TO DIM(DDDVADD);                               0238
         LA    @10,1                                               0238
         ST    @10,DDDVTIDX                                        0238
@DL00238 DS    0H                                                  0239
*       IF DDDVADD(DDDVTIDX)^=0 THEN                               0239
*                                                                  0239
         SLA   @10,2                                               0239
         L     @01,DDDTAPTR                                        0239
         AL    @01,@CF00648                                        0239
         L     @10,DDDVADD(@10,@01)                                0239
         LTR   @10,@10                                             0239
         BZ    @RF00239                                            0239
*         /***********************************************************/
*         /*                                                         */
*         /* SMF RECORD EXISTS                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0240
*         DO;                                                      0240
*                                                                  0240
*           /*********************************************************/
*           /*                                                       */
*           /* SMF RECORD ADDRESS TO REGISTER MACDATE Y-2 73018      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0241
*           RESPECIFY                                              0241
*            (GPR00P,                                              0241
*             GPR01P,                                              0241
*             GPR14P,                                              0241
*             GPR15P) RESTRICTED;                                  0241
*           GPR01P=DDDVADD(DDDVTIDX);                              0242
         LR    GPR01P,@10                                          0242
*           GENERATE(SMFWTM (GPR01P));                             0243
*                                                                  0243
         SMFWTM (GPR01P)
*           /*********************************************************/
*           /*                                                       */
*           /* MACDATE Y-2 73018                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0244
*           RESPECIFY                                              0244
*            (GPR00P,                                              0244
*             GPR01P,                                              0244
*             GPR14P,                                              0244
*             GPR15P) UNRESTRICTED;                                0244
*         END;                                                     0245
*     END;                                                         0246
*                                                                  0246
@RF00239 LA    @10,1                                               0246
         AL    @10,DDDVTIDX                                        0246
         ST    @10,DDDVTIDX                                        0246
         C     @10,@CF00080                                        0246
         BNH   @DL00238                                            0246
*   /*****************************************************************/
*   /*                                                               */
*   /* GET USER STORAGE FOR THE RETURN SMF RECORD DATA, MOVE THE DATA*/
*   /* IN AND FREE THE SUPERVISOR COPY. THE RETURN PARAMETER WILL    */
*   /* POINT TO THE USER STORAGE SMF DATA AREA. THE SUBPOOL AND      */
*   /* LENGTH WILL PREFIX THE DATA AREA. THIS STORAGE WILL BE FREED  */
*   /* BY THE USER                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0247
*   DDSMFSBP=STSMSSP;               /* SMF RECORD USER STORAGE SBPOOL*/
@RF00237 L     @10,@PC00001                                        0247
         L     @10,DDSMAPTR(,@10)                                  0247
         IC    @15,STSMSSP(,@10)                                   0247
         STC   @15,DDSMFSBP                                        0247
*   DDSMFLEN=LENGTH(DDDVADD)*DIM(DDDVADD)+DDSMFTOT+LENGTH(DDSMFGMC);
         L     @10,DDSMFTOT                                        0248
         LA    @10,28(,@10)                                        0248
         STCM  @10,7,DDSMFLEN                                      0248
*                                   /* ACTUAL LENGTH OF RECORD PLUS
*                                      ROOM FOR SUBPOOL AND LENGTH   */
*                                                                  0249
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0249
*   RESPECIFY                                                      0249
*    (GPR00P,                                                      0249
*     GPR01P,                                                      0249
*     GPR14P,                                                      0249
*     GPR15P) RESTRICTED;                                          0249
*   GPR00P=DDSMFGMC;                /* GETMAIN CONTROL WORD TO REG   */
         L     GPR00P,DDSMFGMC                                     0250
*   GENERATE(GETMAIN R,LV=(0));                                    0251
         GETMAIN R,LV=(0)
*   DDRETDTA=GPR01P+LENGTH(DDSMFGMC);/* POINT PARM TO RETURN RECORD  */
*                                                                  0252
         L     @10,@PC00001+4                                      0252
         LA    @09,4                                               0252
         LR    @08,GPR01P                                          0252
         ALR   @08,@09                                             0252
         ST    @08,DDRETDTA(,@10)                                  0252
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0253
*   RESPECIFY                                                      0253
*    (GPR00P,                                                      0253
*     GPR01P,                                                      0253
*     GPR14P,                                                      0253
*     GPR15P) UNRESTRICTED;                                        0253
*                                                                  0253
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH DEVICE CLASSES AND MOVE ONLY PERTINENT SMF DATA  */
*   /* INTO USER STORAGE MACDATE Y-2 73018                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0254
*   RESPECIFY                                                      0254
*    (GPR00P,                                                      0254
*     GPR01P,                                                      0254
*     GPR05P,                                                      0254
*     GPR06P,                                                      0254
*     GPR07P,                                                      0254
*     GPR14P,                                                      0254
*     GPR15P) RESTRICTED;                                          0254
*   GPR05P=DDSMFGMC;                /* GETMAIN CONTROL WORD TO REG   */
         L     GPR05P,DDSMFGMC                                     0255
*   GPR06P=DDRETDTA-LENGTH(DDSMFGMC);/* PREFIX ADDRESS               */
         LCR   @09,@09                                             0256
         ALR   @09,@08                                             0256
         LR    GPR06P,@09                                          0256
*   GPR07P=DDRETDTA;                /* POINT TO OUTPUT DVT           */
*                                                                  0257
         LR    GPR07P,@08                                          0257
*   /*****************************************************************/
*   /*                                                               */
*   /* POINT TO FIRST SMF RECORD SLOT                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0258
*   GPR00P=GPR07P+LENGTH(DDDVADD)*DIM(DDDVADD);                    0258
         LA    GPR00P,24                                           0258
         ALR   GPR00P,GPR07P                                       0258
*   DO DDDVTIDX=1 TO DIM(DDDVADD);                                 0259
         LA    @10,1                                               0259
         ST    @10,DDDVTIDX                                        0259
@DL00259 DS    0H                                                  0260
*     GPR14P=DDDVADD(DDDVTIDX);     /* DVT ENTRY TO REGISTER         */
         SLA   @10,2                                               0260
         L     @04,DDDTAPTR                                        0260
         AL    @04,@CF00648                                        0260
         L     GPR14P,DDDVADD(@10,@04)                             0260
*     IF GPR14P^=0 THEN             /* SMF RECORD EXISTS             */
         LTR   GPR14P,GPR14P                                       0261
         BZ    @RF00261                                            0261
*       DO;                         /* SET UP LENGTHS                */
*         GPR15P=GPR14P->SMF74LEN;                                 0263
         LH    GPR15P,SMF74LEN(,GPR14P)                            0263
*         GPR01P=GPR15P;                                           0264
         LR    GPR01P,GPR15P                                       0264
*       END;                                                       0265
*     ELSE                          /* NO RECORD EXISTS              */
*       DO;                         /* ZERO LENGTHS                  */
         B     @RC00261                                            0266
@RF00261 DS    0H                                                  0267
*         GPR15P=0;                                                0267
         SLR   GPR15P,GPR15P                                       0267
*         GPR01P=0;                                                0268
         SLR   GPR01P,GPR01P                                       0268
*       END;                                                       0269
*                                                                  0269
*     /***************************************************************/
*     /*                                                             */
*     /* CHANGE TO USERS KEY MACDATE Y-2 73018                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0270
*     RESPECIFY                                                    0270
*      (GPR02P,                                                    0270
*       GPR03P,                                                    0270
*       GPR04P) RESTRICTED;                                        0270
@RC00261 DS    0H                                                  0271
*     GPR03P=DDTCBADR;                                             0271
         L     @10,@PC00001+20                                     0271
         L     GPR03P,DDTCBADR(,@10)                               0271
*     GENERATE SETS(DDSAVKEY);                                     0272
*                                                                  0272
         USING TCB,GPR03P
DDMODES1 MODESET EXTKEY=TCB,SAVEKEY=DDSAVKEY,WORKREG=4,                X
               RELATED=(MFDDUKEY,IRBMFDDP(DDMODES2))
         DROP  GPR03P
*     /***************************************************************/
*     /*                                                             */
*     /* MACDATE Y-2 73018                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0273
*     RESPECIFY                                                    0273
*      (GPR02P,                                                    0273
*       GPR03P,                                                    0273
*       GPR04P) UNRESTRICTED;                                      0273
*     GENERATE;                                                    0274
*                                                                  0274
         LTR   GPR14P,GPR14P        TEST DVT ENTRY
         BNZ   DDLAB3               BRANCH IF SMF RECORD EXISTS
         ST    GPR14P,0(,GPR07P)    ZERO OUTPUT DVT ENTRY
         B     DDLAB4               DONT MOVE ANY DATA
DDLAB3   ST    GPR00P,0(,GPR07P)    ADDR OF RETURN SMF REC TO DVT
         MVCL  GPR00P,GPR14P        MOVE SMF RECORD TO USER STORAGE
DDLAB4   ST    GPR05P,0(,GPR06P)    STORE GETMAIN CONTROL WORD
*                                   INTO PREFIX
*     /***************************************************************/
*     /*                                                             */
*     /* CHANGE BACK TO SYSTEM KEY MACDATE Y-2 73018                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0275
*     RESPECIFY                                                    0275
*      (GPR02P,                                                    0275
*       GPR04P) RESTRICTED;                                        0275
*     GENERATE REFS(DDSAVKEY);                                     0276
*                                                                  0276
DDMODES2 MODESET KEYADDR=DDSAVKEY,WORKREG=4,                           X
               RELATED=(MFDDUKEY,IRBMFDDP(DDMODES1))
*     /***************************************************************/
*     /*                                                             */
*     /* MACDATE Y-2 73018                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0277
*     RESPECIFY                                                    0277
*      (GPR02P,                                                    0277
*       GPR04P) UNRESTRICTED;                                      0277
*                                                                  0277
*     /***************************************************************/
*     /*                                                             */
*     /* UPDATE POINTERS                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0278
*     GPR07P=GPR07P+LENGTH(DDDVADD);/* POINT TO NEXT OUTPUT DVT SLOT */
         AL    GPR07P,@CF00175                                     0278
*     GPR00P=GPR00P+GPR15P;         /* POINT TO NEXT SMF RECORD SLOT */
         ALR   GPR00P,GPR15P                                       0279
*   END;                                                           0280
*                                                                  0280
         LA    @10,1                                               0280
         AL    @10,DDDVTIDX                                        0280
         ST    @10,DDDVTIDX                                        0280
         C     @10,@CF00080                                        0280
         BNH   @DL00259                                            0280
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0281
*   RESPECIFY                                                      0281
*    (GPR00P,                                                      0281
*     GPR01P,                                                      0281
*     GPR05P,                                                      0281
*     GPR06P,                                                      0281
*     GPR07P,                                                      0281
*     GPR14P,                                                      0281
*     GPR15P) UNRESTRICTED;                                        0281
*                                                                  0281
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW FREE SYSTEM SMF RECORD STORAGE MACDATE Y-2 73018          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0282
*   RESPECIFY                                                      0282
*    (GPR00P,                                                      0282
*     GPR01P,                                                      0282
*     GPR14P,                                                      0282
*     GPR15P) RESTRICTED;                                          0282
*   GPR00P=STSMIGMC;                /* GETMAIN CONTROL WORD TO REG   */
         L     @10,@PC00001                                        0283
         L     @10,DDSMAPTR(,@10)                                  0283
         L     GPR00P,STSMIGMC(,@10)                               0283
*   GPR01P=DDDTAPTR-LENGTH(STSMIGMC);/* POINT TO BEGINNING OF STORAGE*/
         L     GPR01P,DDDTAPTR                                     0284
         SL    GPR01P,@CF00175                                     0284
*   GENERATE;                                                      0285
*                                                                  0285
DDGETMN2 FREEMAIN R,LV=(0),A=(1),RELATED=(MFDDISGM,IRBMFDDP(DDGETMN1))
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0286
*   RESPECIFY                                                      0286
*    (GPR00P,                                                      0286
*     GPR01P,                                                      0286
*     GPR14P,                                                      0286
*     GPR15P) UNRESTRICTED;                                        0286
*   RETURN;                         /* RETURN TO CALLER              */
@EL00001 L     @13,4(,@13)                                         0287
@EF00001 L     @00,@SIZDATD                                        0287
         LR    @01,@11                                             0287
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0287
         BR    @14                                                 0287
*   END                                                            0288
*                                                                  0288
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*                                                                  0288
*       ;                                                          0288
         B     @EL00001                                            0288
@DATA    DS    0H
@CH00056 DC    H'8'
@CH00644 DC    H'20'
@CH00642 DC    H'28'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    9F
@TF00001 DS    F
@TF00002 DS    F
IRBMFDDP CSECT
         DS    0F
@CF00060 DC    F'1'
@CF00175 DC    F'4'
@CF00080 DC    F'6'
@CF00643 DC    F'56'
@CF00649 DC    F'-28'
@CF00656 DC    F'-25'
@CF00650 DC    F'-24'
@CF00651 DC    F'-20'
@CF00652 DC    F'-19'
@CF00653 DC    F'-16'
@CF00655 DC    F'-12'
@CF00647 DC    F'-8'
@CF00648 DC    F'-4'
@CF00137 DC    XL4'FDFFFFFF'
@CF00654 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
DDDTAPTR DS    A
DDSMFTOT DS    F
DDDVTIDX DS    F
DDPAGECB DS    F
DDSAVKEY DS    CL1
         DS    CL3
DDSMFGMC DS    CL4
         ORG   DDSMFGMC
DDSMFSBP DS    FL1
DDSMFLEN DS    FL3
         ORG   DDSMFGMC+4
IRBMFDDP CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CB00607 DC    X'FFFFFFFF'
DDUCBTYP DC    X'804020100804'
DDPATCH  DS    CL200
IRBMFDDP CSECT
         IKJTCB
IRBMFDDP CSECT
IRBMFDDP CSECT
DDTRTAB  DS    0D
         ORG   DDTRTAB+C'A'
         DC    X'FAFBFCFDFEFF'         HEX DATA FOR TRANSLATE TABLE
         ORG   DDTRTAB+C'0'
         DC    C'0123456789'           HEX DATA FOR TRANSLATE TABLE
         ORG   DDTRTAB+256
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IRBMFDDP CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
DDMINDEV EQU   @06
DDMINIDX EQU   @05
DDDEVIX2 EQU   @04
DDDEVIX1 EQU   @03
DDSMFPR2 EQU   @05
DDSMFPR1 EQU   @06
DDDEVCNT EQU   @08
DDDDBIDX EQU   @03
DDSMFPTR EQU   @02
DDSMFB   EQU   @04
DDSMIADD EQU   @07
DDDCDIDX EQU   @04
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR14P   EQU   @14
GPR15P   EQU   @15
GPR13P   EQU   @13
GPR02P   EQU   @02
GPR03P   EQU   @03
GPR04P   EQU   @04
GPR05P   EQU   @05
GPR06P   EQU   @06
GPR07P   EQU   @07
GPR00F   EQU   @00
GPR01F   EQU   @01
GPR14F   EQU   @14
GPR15F   EQU   @15
STSMA    EQU   0
STSMOPT  EQU   STSMA
STSMOFLG EQU   STSMOPT+3
STSMSAVE EQU   STSMA+24
STSMENTR EQU   STSMA+28
STSMEDAD EQU   STSMA+32
STSMIGMC EQU   STSMA+36
STSMILEN EQU   STSMIGMC+1
STSMIADD EQU   STSMA+40
STSMRVT  EQU   STSMA+44
STSMSSP  EQU   STSMA+52
DDDVT    EQU   0
EDDEDT   EQU   0
EDDEDCDT EQU   EDDEDT
EDDESAMP EQU   EDDEDT+8
EDDCDT   EQU   0
EDDCDDBQ EQU   EDDCDT
EDDCDNUM EQU   EDDCDT+4
EDDDB    EQU   0
EDDDFLGS EQU   EDDDB
EDDDVALD EQU   EDDDFLGS
EDDDCCHG EQU   EDDDFLGS
EDDDALIV EQU   EDDDFLGS
EDDDADDR EQU   EDDDB+1
EDDDUCBA EQU   EDDDB+4
EDDDSIOS EQU   EDDDB+8
EDDDBUSY EQU   EDDDB+12
EDDDNENQ EQU   EDDDB+16
STRVT    EQU   0
STRVSSGT EQU   STRVT+8
STRVNSGT EQU   STRVT+12
STSGT    EQU   0
STSGFREE EQU   STSGT
STSGADD  EQU   STSGT+4
SMFRCD74 EQU   0
SMF74LEN EQU   SMFRCD74
SMF74RTY EQU   SMFRCD74+5
SMF74SIZ EQU   SMFRCD74+18
SMF74IST EQU   SMFRCD74+20
SMF74DAT EQU   SMFRCD74+24
SMF74INT EQU   SMFRCD74+28
SMF74SUB EQU   SMFRCD74+34
SMF74SAM EQU   SMFRCD74+36
SMF74PTR EQU   0
SMF74A   EQU   0
SMF74SDC EQU   SMF74A
SMF74DEV EQU   SMF74A+2
SMF74SDD EQU   SMF74A+4
SMF74B   EQU   0
SMF74ADD EQU   SMF74B
SMF74CNF EQU   SMF74B+3
SMF74VAC EQU   SMF74CNF
SMF74STA EQU   SMF74CNF
SMF74TYP EQU   SMF74B+4
SMF74SER EQU   SMF74B+8
SMF74CNT EQU   SMF74B+16
SMF74ACT EQU   SMF74B+20
SMF74QUE EQU   SMF74B+24
UCB      EQU   0
UCBPTR   EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBMTPXP EQU   UCBWGT
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCB3TAPE EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00012 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
DDSMFNOW EQU   0
DDDTAGMC EQU   0
DDSMF74B EQU   0
IKEBC    EQU   0
IKEBF15  EQU   0
IKEBF31  EQU   0
IKEBP15  EQU   0
IKEBP31  EQU   0
IKEBP8   EQU   0
UCBBGN   EQU   0
DDSMAPTR EQU   0
DDRETDTA EQU   0
DDFSTCLL EQU   0
DDTRACE  EQU   0
DDSMFHDR EQU   0
DDTCBADR EQU   0
DDINTSRT EQU   0
DDINTDAT EQU   0
DDINTLEN EQU   0
STSMB    EQU   STSMOPT
@NM00004 EQU   STSMB+3
STSMDEVF EQU   @NM00004
STSMC    EQU   STSMOPT
@NM00006 EQU   STSMC+3
DDDVADD  EQU   DDDVT
UCBOBS01 EQU   UCBDEV
UCBVOLI  EQU   UCBOBS01+4
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBBASE  EQU   UCBOBS01+16
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00011 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBOBS09 EQU   UCBDEV
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00011
UCBSKPFG EQU   @NM00011
UCBRIPND EQU   @NM00011
UCBRTIAC EQU   @NM00011
UCBRSV79 EQU   @NM00011
UCBRSV78 EQU   @NM00011
UCBRSV77 EQU   @NM00011
UCBOLTEP EQU   @NM00011
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00010 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVTOC  EQU   UCBOBS01
STSMWKLD EQU   @NM00006
@NM00007 EQU   @NM00006
@NM00005 EQU   STSMC
STSMCRDR EQU   STSMDEVF
STSMUNIT EQU   STSMDEVF
STSMGRAP EQU   STSMDEVF
STSMDA   EQU   STSMDEVF
STSMTP   EQU   STSMDEVF
STSMTAPE EQU   STSMDEVF
@NM00003 EQU   STSMB
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00012
UCBHALI  EQU   @NM00012
UCBRSV09 EQU   @NM00012
UCBRSV08 EQU   @NM00012
UCBRSV07 EQU   @NM00012
UCBRSV06 EQU   @NM00012
UCBRSV05 EQU   @NM00012
UCBRSV04 EQU   @NM00012
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBFLB7  EQU   UCBFLB
UCBFLB6  EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00009 EQU   UCB
SMF74RV4 EQU   SMF74B+14
@NM00008 EQU   SMF74CNF
SMF74RV3 EQU   SMF74B+2
SMF74RV2 EQU   SMF74A+6
SMF74RLS EQU   SMFRCD74+44
SMF74RV1 EQU   SMFRCD74+42
SMF74MFV EQU   SMFRCD74+40
SMF74CYC EQU   SMFRCD74+32
SMF74SID EQU   SMFRCD74+14
SMF74DTE EQU   SMFRCD74+10
SMF74TME EQU   SMFRCD74+6
SMF74FLG EQU   SMFRCD74+4
SMF74SEG EQU   SMFRCD74+2
STSGLEN  EQU   STSGFREE+1
STSGSP   EQU   STSGFREE
STRVNPRT EQU   STRVT+4
STRVSPRT EQU   STRVT
EDDDLSIO EQU   EDDDB+6
EDDDRS01 EQU   EDDDFLGS
EDDCRS01 EQU   EDDCDT+6
EDDECCHK EQU   EDDEDT+12
EDDECLAS EQU   EDDEDT+7
EDDERS01 EQU   EDDEDT+4
DDDVCRDR EQU   DDDVT+20
DDDVTAPE EQU   DDDVT+16
DDDVTP   EQU   DDDVT+12
DDDVDA   EQU   DDDVT+8
DDDVGRAP EQU   DDDVT+4
DDDVUNIT EQU   DDDVT
STSMRSV1 EQU   STSMA+53
STSMLCOM EQU   STSMA+48
STSMISP  EQU   STSMIGMC
STSMINTP EQU   STSMA+20
STSMTERM EQU   STSMA+12
STSMINIT EQU   STSMA+4
STSMSTA  EQU   STSMOFLG
@NM00002 EQU   STSMOFLG
@NM00001 EQU   STSMOPT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00093 EQU   DDLAB1
@RC00104 EQU   @RC00102
@RT00150 EQU   @EL00001
@ENDDATA EQU   *
         END   IRBMFDDP,(C'PLS0616',0700,74213)

         TITLE ' /* IRBMFRCR - CPU ACTIVITY REPORT                     *
                       '
IRBMFRCR CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IRBMFRCR  74.087'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@10                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @09,@01                                             0001
         USING @DATD,@09                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @09,8(,@13)                                         0001
         LR    @13,@09                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(8),0(@01)                                  0001
*                                                                  0011
*   /*****************************************************************/
*   /*                                                               */
*   /* GENERAL INITIALIZATION                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0011
*   RCPAGE=1;                       /* 1ST PAGE OF REPORT            */
         MVC   RCPAGE(4),@CF00071                                  0011
*   CALL MFRCHEAD;                  /* SET UP PAGE HEADER            */
*                                                                  0012
         BAL   @14,MFRCHEAD                                        0012
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT HEADINGS FOR CPU REPORT                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0013
*MFRCHEAD:                                                         0013
*   PROCEDURE;                                                     0013
*                                                                  0013
         B     @PB00002                                            0013
MFRCHEAD STM   @14,@12,@SA00002                                    0013
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT CPU ACTIVITY HEADER                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0014
*   CALL MFHDRISR(RCDATPTR,         /* PTR TO SMF RECORD             */
*       IRBMFLCV(LCPART1)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART1)->RCLENGTH,/* LENGTH                        */
*       RCPAGE);                    /* PAGE NUMBER                   */
*                                                                  0014
         L     @08,@PC00001                                        0014
         ST    @08,@AL00001                                        0014
         L     @08,@CA00125                                        0014
         L     @08,IRBMFLCV-IRBMFLCV(,@08)                         0014
         LA    @15,RCTEXT(,@08)                                    0014
         ST    @15,@AL00001+4                                      0014
         ST    @08,@AL00001+8                                      0014
         LA    @08,RCPAGE                                          0014
         ST    @08,@AL00001+12                                     0014
         L     @08,@PC00001+4                                      0014
         L     @15,RCVECTAB+4(,@08)                                0014
         LA    @01,@AL00001                                        0014
         BALR  @14,@15                                             0014
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT COLUMN HEADINGS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0015
*   RCLINE=RCCON9CL;                /* BEGIN COLUMN HEADINGS         */
*                                                                  0015
         MVC   RCLINE(4),@CF00107                                  0015
*/* CPU HEADING                                                      */
*                                                                  0016
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0016
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       IRBMFLCV(LCPART2)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART2)->RCLENGTH,/* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLA                      /* START COLUMN                  */
*       );                                                         0016
*                                                                  0016
         L     @08,@CA00125                                        0016
         L     @08,IRBMFLCV-IRBMFLCV+4(,@08)                       0016
         LA    @15,RCTEXT(,@08)                                    0016
         ST    @15,@AL00001                                        0016
         ST    @08,@AL00001+4                                      0016
         LA    @08,RCLINE                                          0016
         ST    @08,@AL00001+8                                      0016
         LA    @08,@CF00071                                        0016
         ST    @08,@AL00001+12                                     0016
         L     @08,@PC00001+4                                      0016
         L     @15,RCVECTAB+8(,@08)                                0016
         LA    @01,@AL00001                                        0016
         BALR  @14,@15                                             0016
*/* WAIT TIME HEADING                                                */
*                                                                  0017
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0017
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       IRBMFLCV(LCPART4)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART4)->RCLENGTH,/* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLB                      /* START COLUMN                  */
*       );                                                         0017
*                                                                  0017
         L     @08,@CA00125                                        0017
         L     @08,IRBMFLCV-IRBMFLCV+12(,@08)                      0017
         LA    @15,RCTEXT(,@08)                                    0017
         ST    @15,@AL00001                                        0017
         ST    @08,@AL00001+4                                      0017
         LA    @08,RCLINE                                          0017
         ST    @08,@AL00001+8                                      0017
         LA    @08,@CF00133                                        0017
         ST    @08,@AL00001+12                                     0017
         L     @08,@PC00001+4                                      0017
         L     @15,RCVECTAB+8(,@08)                                0017
         LA    @01,@AL00001                                        0017
         BALR  @14,@15                                             0017
*/* WAIT TIME (PERCENTAGE) HEADING                                   */
*                                                                  0018
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0018
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       IRBMFLCV(LCPART4)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART4)->RCLENGTH,/* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLC                      /* START COLUMN                  */
*       );                                                         0018
*                                                                  0018
         L     @08,@CA00125                                        0018
         L     @08,IRBMFLCV-IRBMFLCV+12(,@08)                      0018
         LA    @15,RCTEXT(,@08)                                    0018
         ST    @15,@AL00001                                        0018
         ST    @08,@AL00001+4                                      0018
         LA    @08,RCLINE                                          0018
         ST    @08,@AL00001+8                                      0018
         LA    @08,@CF00135                                        0018
         ST    @08,@AL00001+12                                     0018
         L     @08,@PC00001+4                                      0018
         L     @15,RCVECTAB+8(,@08)                                0018
         LA    @01,@AL00001                                        0018
         BALR  @14,@15                                             0018
*/* CPU SERIAL HEADING                                               */
*                                                                  0019
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0019
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       IRBMFLCV(LCPART5)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART5)->RCLENGTH,/* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLD                      /* START COLUMN                  */
*       );                                                         0019
         L     @08,@CA00125                                        0019
         L     @08,IRBMFLCV-IRBMFLCV+16(,@08)                      0019
         LA    @15,RCTEXT(,@08)                                    0019
         ST    @15,@AL00001                                        0019
         ST    @08,@AL00001+4                                      0019
         LA    @08,RCLINE                                          0019
         ST    @08,@AL00001+8                                      0019
         LA    @08,@CF00083                                        0019
         ST    @08,@AL00001+12                                     0019
         L     @08,@PC00001+4                                      0019
         L     @15,RCVECTAB+8(,@08)                                0019
         LA    @01,@AL00001                                        0019
         BALR  @14,@15                                             0019
*   RCLINE=RCLINE+1;                /* GO TO NEXT LINE               */
*                                                                  0020
         LA    @08,1                                               0020
         A     @08,RCLINE                                          0020
         ST    @08,RCLINE                                          0020
*/* NUMBER (CPU) HEADING                                             */
*                                                                  0021
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0021
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       IRBMFLCV(LCPART3)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART3)->RCLENGTH,/* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLA                      /* START COLUMN                  */
*       );                                                         0021
*                                                                  0021
         L     @08,@CA00125                                        0021
         L     @08,IRBMFLCV-IRBMFLCV+8(,@08)                       0021
         LA    @15,RCTEXT(,@08)                                    0021
         ST    @15,@AL00001                                        0021
         ST    @08,@AL00001+4                                      0021
         LA    @08,RCLINE                                          0021
         ST    @08,@AL00001+8                                      0021
         LA    @08,@CF00071                                        0021
         ST    @08,@AL00001+12                                     0021
         L     @08,@PC00001+4                                      0021
         L     @15,RCVECTAB+8(,@08)                                0021
         LA    @01,@AL00001                                        0021
         BALR  @14,@15                                             0021
*/* HH.MM.SS.TTT HEADING                                             */
*                                                                  0022
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0022
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       IRBMFLCV(LCPART8)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART8)->RCLENGTH,/* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLB                      /* START COLUMN                  */
*       );                                                         0022
*                                                                  0022
         L     @08,@CA00125                                        0022
         L     @08,IRBMFLCV-IRBMFLCV+28(,@08)                      0022
         LA    @15,RCTEXT(,@08)                                    0022
         ST    @15,@AL00001                                        0022
         ST    @08,@AL00001+4                                      0022
         LA    @08,RCLINE                                          0022
         ST    @08,@AL00001+8                                      0022
         LA    @08,@CF00133                                        0022
         ST    @08,@AL00001+12                                     0022
         L     @08,@PC00001+4                                      0022
         L     @15,RCVECTAB+8(,@08)                                0022
         LA    @01,@AL00001                                        0022
         BALR  @14,@15                                             0022
*/* PERCENTAGE (WAIT TIME) HEADING                                   */
*                                                                  0023
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0023
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       IRBMFLCV(LCPART6)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART6)->RCLENGTH,/* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLC                      /* START COLUMN                  */
*       );                                                         0023
*                                                                  0023
         L     @08,@CA00125                                        0023
         L     @08,IRBMFLCV-IRBMFLCV+20(,@08)                      0023
         LA    @15,RCTEXT(,@08)                                    0023
         ST    @15,@AL00001                                        0023
         ST    @08,@AL00001+4                                      0023
         LA    @08,RCLINE                                          0023
         ST    @08,@AL00001+8                                      0023
         LA    @08,@CF00135                                        0023
         ST    @08,@AL00001+12                                     0023
         L     @08,@PC00001+4                                      0023
         L     @15,RCVECTAB+8(,@08)                                0023
         LA    @01,@AL00001                                        0023
         BALR  @14,@15                                             0023
*/* NUMBER (CPU SERIAL) HEADING                                      */
*                                                                  0024
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0024
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       IRBMFLCV(LCPART3)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART3)->RCLENGTH,/* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLD                      /* START COLUMN                  */
*       );                                                         0024
         L     @08,@CA00125                                        0024
         L     @08,IRBMFLCV-IRBMFLCV+8(,@08)                       0024
         LA    @15,RCTEXT(,@08)                                    0024
         ST    @15,@AL00001                                        0024
         ST    @08,@AL00001+4                                      0024
         LA    @08,RCLINE                                          0024
         ST    @08,@AL00001+8                                      0024
         LA    @08,@CF00083                                        0024
         ST    @08,@AL00001+12                                     0024
         L     @08,@PC00001+4                                      0024
         L     @15,RCVECTAB+8(,@08)                                0024
         LA    @01,@AL00001                                        0024
         BALR  @14,@15                                             0024
*   RETURN;                         /* RETRUN TO MAIN LINE OF PROGRAM*/
@EL00002 DS    0H                                                  0025
@EF00002 DS    0H                                                  0025
@ER00002 LM    @14,@12,@SA00002                                    0025
         BR    @14                                                 0025
*   END MFRCHEAD;                                                  0026
@PB00002 DS    0H                                                  0027
*                                                                  0027
*   /*****************************************************************/
*   /*                                                               */
*   /* RETRIVE DATA FOR EVERY CPU AND INSERT INTO PAGE               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0027
*   RCWTPTOT=0;                     /* TOTAL WAIT PERCENT INIT.      */
         SR    @08,@08                                             0027
         ST    @08,RCWTPTOT                                        0027
*   RCCPUTOT=0;                     /* TOTAL ONLINE CPUS             */
         LR    RCCPUTOT,@08                                        0028
*   DO RCCPUIDX=1 TO SMF70CPU;                                     0029
         LA    RCCPUIDX,1                                          0029
         B     @DE00029                                            0029
@DL00029 DS    0H                                                  0030
*     RCLINE=RCLINE+RCCON3DT;       /* SKIP THREE LINES              */
         LA    @08,3                                               0030
         A     @08,RCLINE                                          0030
         ST    @08,RCLINE                                          0030
*     IF RCLINE>RGMAXLN THEN        /* END OF PAGE?                  */
         CH    @08,@CH00083                                        0031
         BNH   @RF00031                                            0031
*       DO;                         /* SET UP PAGE HEADINGS          */
*         CALL MFWRTPAG;            /* WRITE OUT PAGE                */
         L     @08,@PC00001+4                                      0033
         L     @15,RCVECTAB+12(,@08)                               0033
         BALR  @14,@15                                             0033
*         RCPAGE=RCPAGE+1;          /* NEXT PAGE                     */
         LA    @08,1                                               0034
         A     @08,RCPAGE                                          0034
         ST    @08,RCPAGE                                          0034
*         CALL MFRCHEAD;            /* INSERT HEADINGS               */
         BAL   @14,MFRCHEAD                                        0035
*         RCLINE=RCLINE+RCCON3DT;   /* NEXT DATA LINE                */
         LA    @08,3                                               0036
         A     @08,RCLINE                                          0036
         ST    @08,RCLINE                                          0036
*       END;                                                       0037
*                                                                  0037
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS CPU ID NUMBER                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0038
*/*  MACDATE Y-2 73018                                               */
*                                                                  0038
*     CALL IRBMFCNV(                /* CONVERSION ROUTINE            */
*         EVAL(SMF70CID(RCCPUIDX)), /* INPUT VALUE                   */
*         RCDATSCF,                 /* INPUT SCALE                   */
*         RCCPUID,                  /* OUTPUT STRING                 */
*         RCDATLEN,                 /* OUTPUT LENGTH                 */
*         RCDATRDP,                 /* PLACES RIGHT OF DEC PT        */
*         RCNOCOMA,                 /* COMMAS FLAG                   */
*         RCNOFLOT                  /* MAX PRECISION FLAG            */
*         );                                                       0038
*                                                                  0038
@RF00031 MVC   @AL00001+4(24),@AL00038                             0038
         LR    @08,RCCPUIDX                                        0038
         SLA   @08,4                                               0038
         L     @15,@PC00001                                        0038
         L     @15,SMF70PTR(,@15)                                  0038
         LA    @14,SMF70SIZ(,@15)                                  0038
         AH    @14,SMF70SIZ(,@15)                                  0038
         LH    @15,SMF70SCC(,@14)                                  0038
         AR    @15,@14                                             0038
         AL    @15,@CF00223                                        0038
         LH    @08,SMF70CID-8(@08,@15)                             0038
         ST    @08,@AFTEMPS                                        0038
         LA    @08,@AFTEMPS                                        0038
         ST    @08,@AL00001                                        0038
         LA    @08,RCCPUID                                         0038
         ST    @08,@AL00001+8                                      0038
         L     @08,@PC00001+4                                      0038
         L     @15,RCVECTAB(,@08)                                  0038
         LA    @01,@AL00001                                        0038
         BALR  @14,@15                                             0038
*     /***************************************************************/
*     /*                                                             */
*     /* MACDATE Y-2 73018                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0039
*     CALL MFISRTXT(                /* INSERT TEXT ROUTINE           */
*         RCCPUID,                  /* TEXT                          */
*         RCDATLEN,                 /* LENGTH                        */
*         RCLINE,                   /* START LINE                    */
*         RCCOLA                    /* START COLUMN                  */
*         );                                                       0039
*                                                                  0039
         LA    @08,RCCPUID                                         0039
         ST    @08,@AL00001                                        0039
         LA    @08,@CF00054                                        0039
         ST    @08,@AL00001+4                                      0039
         LA    @08,RCLINE                                          0039
         ST    @08,@AL00001+8                                      0039
         LA    @08,@CF00071                                        0039
         ST    @08,@AL00001+12                                     0039
         L     @08,@PC00001+4                                      0039
         L     @15,RCVECTAB+8(,@08)                                0039
         LA    @01,@AL00001                                        0039
         BALR  @14,@15                                             0039
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK VARY ACTIVITY AND ONLINE STATUS                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0040
*     IF SMF70VAC(RCCPUIDX)=RCNOACTY&SMF70STA(RCCPUIDX)=RCONLINE THEN
         LR    @08,RCCPUIDX                                        0040
         SLA   @08,4                                               0040
         L     @15,@PC00001                                        0040
         L     @15,SMF70PTR(,@15)                                  0040
         LA    @14,SMF70SIZ(,@15)                                  0040
         AH    @14,SMF70SIZ(,@15)                                  0040
         LH    @15,SMF70SCC(,@14)                                  0040
         AR    @15,@14                                             0040
         ST    @08,@TF00001                                        0040
         ALR   @08,@15                                             0040
         AL    @08,@CF00224                                        0040
         TM    SMF70STA-11(@08),B'00000001'                        0040
         BNO   @RF00040                                            0040
         TM    SMF70VAC-11(@08),B'00000010'                        0040
         BNZ   @RF00040                                            0040
*       DO;                                                        0041
*                                                                  0041
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS WAIT TIME. MACDATE Y-2 73018                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0042
*         RESPECIFY                                                0042
*          (GPR00P,                                                0042
*           GPR01P,                                                0042
*           GPR14P,                                                0042
*           GPR15P)RESTRICTED;                                     0042
*         GPR00P=SMF70WAT(RCCPUIDX,1:4);                           0043
         ST    @15,@TF00002                                        0043
         L     @08,@TF00002                                        0043
         AL    @08,@TF00001                                        0043
         AL    @08,@CF00225                                        0043
         MVC   @TF00003(4),SMF70WAT(@08)                           0043
         L     GPR00P,@TF00003                                     0043
*         GPR01P=SMF70WAT(RCCPUIDX,5:8);/* BIT 51 = 1 MICROSECOND    */
         L     @08,@TF00002                                        0044
         AL    @08,@TF00001                                        0044
         AL    @08,@CF00226                                        0044
         MVC   @TF00001(4),SMF70WAT(@08)                           0044
         L     GPR01P,@TF00001                                     0044
*         GEN;                                                     0045
         SRDL  GPR00P,12               PUT MICROSEC IN BIT 63
         D     GPR00P,RCMILLI
*         GEN DATA;                                                0046
*         RCTEMP=GPR01P/3600000*10000000/* HOURS HH0000000           */
*             +GPR01P//3600000/60000*100000/* MINUTES 00MM00000      */
*             +GPR01P//60000;       /* THOUSANDTHS SECONDS 0000TTTTT */
         L     @08,@CF00200                                        0047
         LR    @05,GPR01P                                          0047
         SR    @04,@04                                             0047
         DR    @04,@08                                             0047
         M     @04,@CF00201                                        0047
         L     @04,@CF00202                                        0047
         LR    @06,GPR01P                                          0047
         SRDA  @06,32                                              0047
         DR    @06,@08                                             0047
         SRDA  @06,32                                              0047
         DR    @06,@04                                             0047
         M     @06,@CF00203                                        0047
         AR    @05,@07                                             0047
         LR    @06,GPR01P                                          0047
         SRDA  @06,32                                              0047
         DR    @06,@04                                             0047
         AR    @05,@06                                             0047
         ST    @05,RCTEMP                                          0047
*         RCSAVWAT=GPR01P;          /* SAVE RESULTS FOR PERCENTAGE 0048
*                                      CALCULATIONS                  */
*                                                                  0048
         ST    GPR01P,RCSAVWAT                                     0048
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0049
*         RESPECIFY                                                0049
*          (GPR00P,                                                0049
*           GPR01P,                                                0049
*           GPR14P,                                                0049
*           GPR15P)UNRESTRICTED;                                   0049
*                                                                  0049
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT TO CHARACTER FORMAT HHMMSS.TTT                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0050
*/*  MACDATE Y-2 73018                                               */
*                                                                  0050
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */
*             RCTEMP,               /* INPUT VALUE                   */
*             RCCCHSCF,             /* INPUT SCALE                   */
*             RCWATIME,             /* OUTPUT STRING                 */
*             RCCCHLEN,             /* OUTPUT LENGTH                 */
*             RCCCHRDP,             /* PLACES RIGHT OF DEC PT        */
*             RCNOCOMA,             /* COMMAS FLAG                   */
*             RCNOFLOT              /* MAX PRECISION FLAG            */
*             );                                                   0050
*                                                                  0050
         MVC   @AL00001+4(24),@AL00050                             0050
         LA    @08,RCTEMP                                          0050
         ST    @08,@AL00001                                        0050
         LA    @08,RCWATIME                                        0050
         ST    @08,@AL00001+8                                      0050
         L     @08,@PC00001+4                                      0050
         L     @15,RCVECTAB(,@08)                                  0050
         LA    @01,@AL00001                                        0050
         BALR  @14,@15                                             0050
*         /***********************************************************/
*         /*                                                         */
*         /* MAKE LEADING BLANKS INTO ZEROS                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0051
*         DO I=1 TO 10 WHILE(RCWATIME(I:I)=' ');                   0051
         LA    I,1                                                 0051
@DL00051 LA    @08,RCWATIME-1(I)                                   0051
         CLI   0(@08),C' '                                         0051
         BNE   @DC00051                                            0051
*           RCWATIME(I:I)='0';                                     0052
         LA    @08,RCWATIME-1(I)                                   0052
         MVI   0(@08),C'0'                                         0052
*         END;                                                     0053
*                                                                  0053
         AH    I,@CH00071                                          0053
         CH    I,@CH00109                                          0053
         BNH   @DL00051                                            0053
@DC00051 DS    0H                                                  0054
*/* INSERT PERIODS FIRST                                             */
*                                                                  0054
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0054
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             IRBMFLCV(LCPART9)->RCTEXT,/* TEXT                      */
*             IRBMFLCV(LCPART9)->RCLENGTH,/* LENGTH                  */
*             RCLINE,               /* START LINE                    */
*             RCCOLB+2              /* START COLUMN                  */
*             );                                                   0054
*                                                                  0054
         L     @08,@CA00125                                        0054
         L     @08,IRBMFLCV-IRBMFLCV+32(,@08)                      0054
         LA    @15,RCTEXT(,@08)                                    0054
         ST    @15,@AL00001                                        0054
         ST    @08,@AL00001+4                                      0054
         LA    @08,RCLINE                                          0054
         ST    @08,@AL00001+8                                      0054
         LA    @08,@CF00211                                        0054
         ST    @08,@AL00001+12                                     0054
         L     @08,@PC00001+4                                      0054
         L     @15,RCVECTAB+8(,@08)                                0054
         LA    @01,@AL00001                                        0054
         BALR  @14,@15                                             0054
*         /***********************************************************/
*         /*                                                         */
*         /* HOURS (HH) MACDATE Y-2 73018                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0055
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             RCWATIME,             /* TEXT                          */
*             RCTXTHRS,             /* LENGTH                        */
*             RCLINE,               /* START LINE                    */
*             RCCOLB                /* START COLUMN                  */
*             );                                                   0055
*                                                                  0055
         LA    @08,RCWATIME                                        0055
         ST    @08,@AL00001                                        0055
         LA    @08,@CF00054                                        0055
         ST    @08,@AL00001+4                                      0055
         LA    @08,RCLINE                                          0055
         ST    @08,@AL00001+8                                      0055
         LA    @08,@CF00133                                        0055
         ST    @08,@AL00001+12                                     0055
         L     @08,@PC00001+4                                      0055
         L     @15,RCVECTAB+8(,@08)                                0055
         LA    @01,@AL00001                                        0055
         BALR  @14,@15                                             0055
*         /***********************************************************/
*         /*                                                         */
*         /* MINUTES (MM) MACDATE Y-2 73018                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0056
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             (ADDR(RCWATIME)+2)->RCDUMTXT,/* TEXT                   */
*             RCTXTMIN,             /* LENGTH                        */
*             RCLINE,               /* START LINE                    */
*             RCCOLB+RCTXTHRS+1     /* START COLUMN                  */
*             );                                                   0056
*                                                                  0056
         LA    @08,RCWATIME                                        0056
         LA    @08,RCDUMTXT+2(,@08)                                0056
         ST    @08,@AL00001                                        0056
         LA    @08,@CF00054                                        0056
         ST    @08,@AL00001+4                                      0056
         LA    @08,RCLINE                                          0056
         ST    @08,@AL00001+8                                      0056
         LA    @08,@CF00212                                        0056
         ST    @08,@AL00001+12                                     0056
         L     @08,@PC00001+4                                      0056
         L     @15,RCVECTAB+8(,@08)                                0056
         LA    @01,@AL00001                                        0056
         BALR  @14,@15                                             0056
*         /***********************************************************/
*         /*                                                         */
*         /* SECONDS (SS.TTT) MACDATE Y-2 73018                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0057
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             (ADDR(RCWATIME)+4)->RCDUMTXT,/* TEXT                   */
*             RCTXTSEC,             /* LENGTH                        */
*             RCLINE,               /* START LINE                    */
*             RCCOLB+RCTXTHRS+RCTXTMIN+2/* START COLUMN              */
*             );                                                   0057
*                                                                  0057
         LA    @08,RCWATIME                                        0057
         LA    @08,RCDUMTXT+4(,@08)                                0057
         ST    @08,@AL00001                                        0057
         LA    @08,@CF00074                                        0057
         ST    @08,@AL00001+4                                      0057
         LA    @08,RCLINE                                          0057
         ST    @08,@AL00001+8                                      0057
         LA    @08,@CF00214                                        0057
         ST    @08,@AL00001+12                                     0057
         L     @08,@PC00001+4                                      0057
         L     @15,RCVECTAB+8(,@08)                                0057
         LA    @01,@AL00001                                        0057
         BALR  @14,@15                                             0057
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS WAIT TIME PERCENTAGE. FIRST CALCULATE INTERVAL  */
*         /* TIME.                                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0058
*         CVB(RCTEMP,SMF70INT);     /* GET BINARY MMTTTTT FROM PACKED
*                                      FORM MMSSTTTF                 */
         L     @08,@PC00001                                        0058
         L     @08,SMF70PTR(,@08)                                  0058
         XC    @TS00001(8),@TS00001                                0058
         MVC   @TS00001+4(4),SMF70INT(@08)                         0058
         CVB   @08,@TS00001                                        0058
         ST    @08,RCTEMP                                          0058
*         RCTEMP=((RCTEMP/100000)   /* THOUSAND THIS SEC=MINUTES (MM)*/
*             *60*1000)             /* CONVERTED TO THOUSANDTHS SEC, */
*             +(RCTEMP//100000);    /* PLUS THOUSANDTHS (TTTTT).     */
*                                                                  0059
         L     @08,RCTEMP                                          0059
         L     @15,@CF00203                                        0059
         LR    @00,@08                                             0059
         SRDA  @00,32                                              0059
         DR    @00,@15                                             0059
         M     @00,@CF00202                                        0059
         LR    @04,@08                                             0059
         SRDA  @04,32                                              0059
         DR    @04,@15                                             0059
         AR    @01,@04                                             0059
         ST    @01,RCTEMP                                          0059
*         /***********************************************************/
*         /*                                                         */
*         /* NOW, CALCULATE WAIT TIME PERCENTAGE                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0060
*         IF RCTEMP^=0 THEN         /* CAN DIVISION BE DONE?         */
         LTR   @01,@01                                             0060
         BZ    @RF00060                                            0060
*           DO;                                                    0061
*             RCWTPRCT=10000*RCSAVWAT/RCTEMP;                      0062
         L     @05,RCSAVWAT                                        0062
         M     @04,@CF00207                                        0062
         DR    @04,@01                                             0062
         ST    @05,RCWTPRCT                                        0062
*             RCWTPTOT=RCWTPTOT+RCWTPRCT;/* ACCUMULATE ALL WAIT TIME
*                                      %                             */
         A     @05,RCWTPTOT                                        0063
         ST    @05,RCWTPTOT                                        0063
*           END;                                                   0064
*         ELSE                                                     0065
*           RCWTPRCT=0;             /* WAIT TIME PERCENTAGE IS 0     */
*                                                                  0065
         B     @RC00060                                            0065
@RF00060 SR    @08,@08                                             0065
         ST    @08,RCWTPRCT                                        0065
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0066
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */
*             RCWTPRCT,             /* INPUT VALUE                   */
*             RCRATSCF,             /* INPUT SCALE                   */
*             RCOUTCHR,             /* OUTPUT STRING                 */
*             RCRATLEN,             /* OUTPUT LENGTH                 */
*             RCRATRDP,             /* PLACES RIGHT OF DEC PT        */
*             RCNOCOMA,             /* COMMAS FLAG                   */
*             RCNOFLOT              /* MAX PRECISION FLAG            */
*             );                                                   0066
*                                                                  0066
@RC00060 MVC   @AL00001+4(24),@AL00066                             0066
         LA    @08,RCWTPRCT                                        0066
         ST    @08,@AL00001                                        0066
         LA    @08,RCOUTCHR                                        0066
         ST    @08,@AL00001+8                                      0066
         L     @08,@PC00001+4                                      0066
         L     @15,RCVECTAB(,@08)                                  0066
         LA    @01,@AL00001                                        0066
         BALR  @14,@15                                             0066
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0067
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             RCOUTCHR,             /* TEXT                          */
*             RCRATLEN,             /* LENGTH                        */
*             RCLINE,               /* START LINE                    */
*             RCCOLC                /* START COLUMN                  */
*             );                                                   0067
*                                                                  0067
         LA    @08,RCOUTCHR                                        0067
         ST    @08,@AL00001                                        0067
         LA    @08,@CF00101                                        0067
         ST    @08,@AL00001+4                                      0067
         LA    @08,RCLINE                                          0067
         ST    @08,@AL00001+8                                      0067
         LA    @08,@CF00135                                        0067
         ST    @08,@AL00001+12                                     0067
         L     @08,@PC00001+4                                      0067
         L     @15,RCVECTAB+8(,@08)                                0067
         LA    @01,@AL00001                                        0067
         BALR  @14,@15                                             0067
*         /***********************************************************/
*         /*                                                         */
*         /* GET CPU SERIAL NUMBER,CONVERT AND INSERT INTO PAGE      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0068
*         RCCPUSER=SMF70SER(RCCPUIDX);/* FORM HHHHHH40               */
         MVI   RCCPUSER+3,C' '                                     0068
         LR    @08,RCCPUIDX                                        0068
         SLA   @08,4                                               0068
         L     @15,@PC00001                                        0068
         L     @15,SMF70PTR(,@15)                                  0068
         LA    @14,SMF70SIZ(,@15)                                  0068
         AH    @14,SMF70SIZ(,@15)                                  0068
         LH    @15,SMF70SCC(,@14)                                  0068
         AR    @15,@14                                             0068
         ALR   @15,@08                                             0068
         AL    @15,@CF00182                                        0068
         MVC   RCCPUSER(3),SMF70SER-13(@15)                        0068
*         UNPK(RCWRKSTR(1:7),RCCPUSER);/* FORM FHFHFHFHFHFH04        */
         UNPK  RCWRKSTR(7),RCCPUSER(4)                             0069
*         TR(RCWRKSTR(1:6),RCTRTAB);/* TRANSLATE CHARACTERS INTO   0070
*                                      EBCDIC                        */
*                                                                  0070
         LA    @08,RCDTRTAB                                        0070
         SH    @08,@CH00150                                        0070
         TR    RCWRKSTR(6),RCTRTAB(@08)                            0070
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0071
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             RCWRKSTR,             /* TEXT                          */
*             RCTXTCPU,             /* LENGTH                        */
*             RCLINE,               /* START LINE                    */
*             RCCOLD                /* START COLUMN                  */
*             );                                                   0071
         LA    @08,RCWRKSTR                                        0071
         ST    @08,@AL00001                                        0071
         LA    @08,@CF00074                                        0071
         ST    @08,@AL00001+4                                      0071
         LA    @08,RCLINE                                          0071
         ST    @08,@AL00001+8                                      0071
         LA    @08,@CF00083                                        0071
         ST    @08,@AL00001+12                                     0071
         L     @08,@PC00001+4                                      0071
         L     @15,RCVECTAB+8(,@08)                                0071
         LA    @01,@AL00001                                        0071
         BALR  @14,@15                                             0071
*         RCCPUTOT=RCCPUTOT+1;      /* INCREMENT ONLINE CPU COUNT    */
         AH    RCCPUTOT,@CH00071                                   0072
*       END;                                                       0073
*     ELSE                                                         0074
*       DO;                                                        0074
*                                                                  0074
         B     @RC00040                                            0074
@RF00040 DS    0H                                                  0075
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR NO VARY ACTIVITY AND OFFLINE                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0075
*         IF SMF70VAC(RCCPUIDX)=RCNOACTY&SMF70STA(RCCPUIDX)=RCOFFLIN
*           THEN                                                   0075
*                                                                  0075
         LR    @08,RCCPUIDX                                        0075
         SLA   @08,4                                               0075
         L     @15,@PC00001                                        0075
         L     @15,SMF70PTR(,@15)                                  0075
         LA    @14,SMF70SIZ(,@15)                                  0075
         AH    @14,SMF70SIZ(,@15)                                  0075
         LH    @15,SMF70SCC(,@14)                                  0075
         AR    @15,@14                                             0075
         ALR   @15,@08                                             0075
         AL    @15,@CF00224                                        0075
         TM    SMF70VAC-11(@15),B'00000011'                        0075
         BNZ   @RF00075                                            0075
*           /*********************************************************/
*           /*                                                       */
*           /* MACDATE Y-2 73018                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0076
*           CALL MFISRTXT(          /* INSERT TEXT ROUTINE           */
*               IRBMFLCV(LCPART10)->RCTEXT,/* TEXT                   */
*               IRBMFLCV(LCPART10)->RCLENGTH,/* LENGTH               */
*               RCLINE,             /* START LINE                    */
*               RCCOLB+5            /* START COLUMN                  */
*               );                  /* INDICATE OFFLINE              */
*                                                                  0076
         L     @08,@CA00125                                        0076
         L     @08,IRBMFLCV-IRBMFLCV+36(,@08)                      0076
         LA    @15,RCTEXT(,@08)                                    0076
         ST    @15,@AL00001                                        0076
         ST    @08,@AL00001+4                                      0076
         LA    @08,RCLINE                                          0076
         ST    @08,@AL00001+8                                      0076
         LA    @08,@CF00216                                        0076
         ST    @08,@AL00001+12                                     0076
         L     @08,@PC00001+4                                      0076
         L     @15,RCVECTAB+8(,@08)                                0076
         LA    @01,@AL00001                                        0076
         BALR  @14,@15                                             0076
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR VARY ACTIVITY AND OFFLINE                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0077
*         IF SMF70VAC(RCCPUIDX)=RCACTVTY&SMF70STA(RCCPUIDX)=RCOFFLIN
*           THEN                                                   0077
*                                                                  0077
@RF00075 LR    @08,RCCPUIDX                                        0077
         SLA   @08,4                                               0077
         L     @15,@PC00001                                        0077
         L     @15,SMF70PTR(,@15)                                  0077
         LA    @14,SMF70SIZ(,@15)                                  0077
         AH    @14,SMF70SIZ(,@15)                                  0077
         LH    @15,SMF70SCC(,@14)                                  0077
         AR    @15,@14                                             0077
         ALR   @15,@08                                             0077
         AL    @15,@CF00224                                        0077
         TM    SMF70VAC-11(@15),B'00000010'                        0077
         BNO   @RF00077                                            0077
         TM    SMF70STA-11(@15),B'00000001'                        0077
         BNZ   @RF00077                                            0077
*           /*********************************************************/
*           /*                                                       */
*           /* MACDATE Y-2 73018                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0078
*           CALL MFISRTXT(          /* INSERT TEXT ROUTINE           */
*               IRBMFLCV(LCPART11)->RCTEXT,/* TEXT                   */
*               IRBMFLCV(LCPART11)->RCLENGTH,/* LENGTH               */
*               RCLINE,             /* START LINE                    */
*               RCCOLB+1            /* START COLUMN                  */
*               );                  /* INDICATE NOW OFFLINE          */
*                                                                  0078
         L     @08,@CA00125                                        0078
         L     @08,IRBMFLCV-IRBMFLCV+40(,@08)                      0078
         LA    @15,RCTEXT(,@08)                                    0078
         ST    @15,@AL00001                                        0078
         ST    @08,@AL00001+4                                      0078
         LA    @08,RCLINE                                          0078
         ST    @08,@AL00001+8                                      0078
         LA    @08,@CF00217                                        0078
         ST    @08,@AL00001+12                                     0078
         L     @08,@PC00001+4                                      0078
         L     @15,RCVECTAB+8(,@08)                                0078
         LA    @01,@AL00001                                        0078
         BALR  @14,@15                                             0078
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR VARY ACTIVITY AND ONLINE                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0079
*         IF SMF70VAC(RCCPUIDX)=RCACTVTY&SMF70STA(RCCPUIDX)=RCONLINE
*           THEN                                                   0079
*                                                                  0079
@RF00077 LR    @08,RCCPUIDX                                        0079
         SLA   @08,4                                               0079
         L     @15,@PC00001                                        0079
         L     @15,SMF70PTR(,@15)                                  0079
         LA    @14,SMF70SIZ(,@15)                                  0079
         AH    @14,SMF70SIZ(,@15)                                  0079
         LH    @15,SMF70SCC(,@14)                                  0079
         AR    @15,@14                                             0079
         ALR   @15,@08                                             0079
         AL    @15,@CF00224                                        0079
         TM    SMF70VAC-11(@15),B'00000011'                        0079
         BNO   @RF00079                                            0079
*           /*********************************************************/
*           /*                                                       */
*           /* MACDATE Y-2 73018                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0080
*           CALL MFISRTXT(          /* INSERT TEXT ROUTINE           */
*               IRBMFLCV(LCPART12)->RCTEXT,/* TEXT                   */
*               IRBMFLCV(LCPART12)->RCLENGTH,/* LENGTH               */
*               RCLINE,             /* START LINE                    */
*               RCCOLB+2            /* START COLUMN                  */
*               );                                                 0080
         L     @08,@CA00125                                        0080
         L     @08,IRBMFLCV-IRBMFLCV+44(,@08)                      0080
         LA    @15,RCTEXT(,@08)                                    0080
         ST    @15,@AL00001                                        0080
         ST    @08,@AL00001+4                                      0080
         LA    @08,RCLINE                                          0080
         ST    @08,@AL00001+8                                      0080
         LA    @08,@CF00211                                        0080
         ST    @08,@AL00001+12                                     0080
         L     @08,@PC00001+4                                      0080
         L     @15,RCVECTAB+8(,@08)                                0080
         LA    @01,@AL00001                                        0080
         BALR  @14,@15                                             0080
*       END;                                                       0081
@RF00079 DS    0H                                                  0082
*   END;                                                           0082
@RC00040 AH    RCCPUIDX,@CH00071                                   0082
@DE00029 L     @08,@PC00001                                        0082
         L     @08,SMF70PTR(,@08)                                  0082
         LA    @08,SMF70SIZ(,@08)                                  0082
         L     @15,@PC00001                                        0082
         L     @01,SMF70PTR(,@15)                                  0082
         AH    @08,SMF70SIZ(,@01)                                  0082
         CH    RCCPUIDX,SMF70CPU(,@08)                             0082
         BNH   @DL00029                                            0082
*                                                                  0083
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE AVERAGE WAIT TIME PERCENTAGE AND INSERT RESULTS INTO*/
*   /* PAGE                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0083
*   IF RCCPUTOT=0                   /* IF UPCOMING DIVISOR IS ZERO,  */
*     THEN                          /* WRITE OUT REPORT WITHOUT    0083
*                                      AVERAGE WAIT TIME.            */
         LTR   RCCPUTOT,RCCPUTOT                                   0083
         BNZ   @RF00083                                            0083
*     DO;                                                          0084
*       CALL MFWRTPAG;              /* WRITE OUT REPORT PAGE.        */
         L     @08,@PC00001+4                                      0085
         L     @15,RCVECTAB+12(,@08)                               0085
         BALR  @14,@15                                             0085
*       RETURN;                     /* TO REPORT GENERATOR MAINLINE. */
@EL00001 L     @13,4(,@13)                                         0086
@EF00001 L     @00,@SIZDATD                                        0086
         LR    @01,@09                                             0086
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0086
         BR    @14                                                 0086
*     END;                                                         0087
*   RCAVRAGE=RCWTPTOT/RCCPUTOT;     /* CALCULATE AVERAGE             */
*                                                                  0088
@RF00083 L     @00,RCWTPTOT                                        0088
         SRDA  @00,32                                              0088
         DR    @00,RCCPUTOT                                        0088
         ST    @01,RCAVRAGE                                        0088
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0089
*   CALL IRBMFCNV(                  /* CONVERSION ROUTINE            */
*       RCAVRAGE,                   /* INPUT VALUE                   */
*       RCRATSCF,                   /* INPUT SCALE                   */
*       RCOUTCHR,                   /* OUTPUT STRING                 */
*       RCRATLEN,                   /* OUTPUT LENGTH                 */
*       RCRATRDP,                   /* PLACES RIGHT OF DEC PT        */
*       RCNOCOMA,                   /* COMMAS FLAG                   */
*       RCNOFLOT                    /* MAX PRECISION FLAG            */
*       );                                                         0089
         MVC   @AL00001+4(24),@AL00089                             0089
         LA    @08,RCAVRAGE                                        0089
         ST    @08,@AL00001                                        0089
         LA    @08,RCOUTCHR                                        0089
         ST    @08,@AL00001+8                                      0089
         L     @08,@PC00001+4                                      0089
         L     @15,RCVECTAB(,@08)                                  0089
         LA    @01,@AL00001                                        0089
         BALR  @14,@15                                             0089
*   RCLINE=RCLINE+3;                /* SKIP 3 LINES                  */
         LA    @08,3                                               0090
         A     @08,RCLINE                                          0090
         ST    @08,RCLINE                                          0090
*   IF RCLINE=RGMAXLN THEN          /* ROOM FOR TOTAL?               */
         CH    @08,@CH00083                                        0091
         BNE   @RF00091                                            0091
*     DO;                                                          0092
*       CALL MFWRTPAG;              /* WRITE OUT PREVIOUS PAGE       */
         L     @08,@PC00001+4                                      0093
         L     @15,RCVECTAB+12(,@08)                               0093
         BALR  @14,@15                                             0093
*       RCPAGE=RCPAGE+1;            /* NEXT PAGE                     */
         LA    @08,1                                               0094
         A     @08,RCPAGE                                          0094
         ST    @08,RCPAGE                                          0094
*       CALL MFRCHEAD;              /* INSERT HEADING                */
         BAL   @14,MFRCHEAD                                        0095
*       RCLINE=RCLINE+RCCON3DT;     /* 1ST DATA LINE                 */
         LA    @08,3                                               0096
         A     @08,RCLINE                                          0096
         ST    @08,RCLINE                                          0096
*     END;                                                         0097
*                                                                  0097
*   /*****************************************************************/
*   /*                                                               */
*   /* REPORT LABEL FOR AVERAGE TIME. MACDATE Y-2 73018              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0098
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       IRBMFLCV(LCPART7)->RCTEXT,  /* TEXT                          */
*       IRBMFLCV(LCPART7)->RCLENGTH,/* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLA                      /* START COLUMN                  */
*       );                                                         0098
*                                                                  0098
@RF00091 L     @08,@CA00125                                        0098
         L     @08,IRBMFLCV-IRBMFLCV+24(,@08)                      0098
         LA    @15,RCTEXT(,@08)                                    0098
         ST    @15,@AL00001                                        0098
         ST    @08,@AL00001+4                                      0098
         LA    @08,RCLINE                                          0098
         ST    @08,@AL00001+8                                      0098
         LA    @08,@CF00071                                        0098
         ST    @08,@AL00001+12                                     0098
         L     @08,@PC00001+4                                      0098
         L     @15,RCVECTAB+8(,@08)                                0098
         LA    @01,@AL00001                                        0098
         BALR  @14,@15                                             0098
*   /*****************************************************************/
*   /*                                                               */
*   /* THE TIME ITSELF. MACDATE Y-2 73018                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0099
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */
*       RCOUTCHR,                   /* TEXT                          */
*       RCRATLEN,                   /* LENGTH                        */
*       RCLINE,                     /* START LINE                    */
*       RCCOLC                      /* START COLUMN                  */
*       );                                                         0099
         LA    @08,RCOUTCHR                                        0099
         ST    @08,@AL00001                                        0099
         LA    @08,@CF00101                                        0099
         ST    @08,@AL00001+4                                      0099
         LA    @08,RCLINE                                          0099
         ST    @08,@AL00001+8                                      0099
         LA    @08,@CF00135                                        0099
         ST    @08,@AL00001+12                                     0099
         L     @08,@PC00001+4                                      0099
         L     @15,RCVECTAB+8(,@08)                                0099
         LA    @01,@AL00001                                        0099
         BALR  @14,@15                                             0099
*   CALL MFWRTPAG;                  /* WRITE OUT ENTIRE REPORT       */
         L     @08,@PC00001+4                                      0100
         L     @15,RCVECTAB+12(,@08)                               0100
         BALR  @14,@15                                             0100
*   END IRBMFRCR                                                   0101
*                                                                  0101
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */
*/*%INCLUDE SYSLIB  (IRBRGCON)                                       */
*/*%INCLUDE SYSLIB  (IRBMFLCM)                                       */
*                                                                  0101
*       ;                                                          0101
         B     @EL00001                                            0101
@DATA    DS    0H
@CH00150 DC    XL1'0'
         DC    C'0'
         DS    0F
@AL00038 DC    A(@CF00185)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00054)
         DC    A(@CF00185)
         DC    A(@CB00139)
         DC    A(@CB00139)
@AL00050 DC    A(@CF00182)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00109)
         DC    A(@CF00079)
         DC    A(@CB00139)
         DC    A(@CB00139)
@AL00066 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL00089 DC    A(@CF00190)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00101)
         DC    A(@CF00054)
         DC    A(@CB00139)
         DC    A(@CB00139)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@SA00002 DS    15F
@AL00001 DS    7A
@TF00001 DS    F
@TF00002 DS    F
@TF00003 DS    F
@AFTEMPS DS    1F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
IRBMFRCR CSECT
         DS    0F
@CF00225 DC    F'-16'
@CF00226 DC    F'-12'
@CF00223 DC    F'-8'
@CF00224 DC    F'-5'
@CF00182 DC    F'-3'
@CF00190 DC    F'-2'
@CF00185 DC    F'0'
@CF00071 DC    F'1'
@CH00071 EQU   @CF00071+2
@CF00054 DC    F'2'
@CF00079 DC    F'3'
@CF00101 DC    F'5'
@CF00074 DC    F'6'
@CF00107 DC    F'9'
@CF00109 DC    F'10'
@CH00109 EQU   @CF00109+2
@CF00133 DC    F'20'
@CF00217 DC    F'21'
@CF00211 DC    F'22'
@CF00212 DC    F'23'
@CF00216 DC    F'25'
@CF00214 DC    F'26'
@CF00135 DC    F'40'
@CF00083 DC    F'60'
@CH00083 EQU   @CF00083+2
@CF00207 DC    F'10000'
@CF00202 DC    F'60000'
@CF00203 DC    F'100000'
@CF00200 DC    F'3600000'
@CF00201 DC    F'10000000'
@DATD    DSECT
         DS    0D
RCPAGE   DS    F
RCLINE   DS    F
RCTEMP   DS    F
RCWTPTOT DS    F
RCWTPRCT DS    F
RCAVRAGE DS    F
RCSAVWAT DS    F
         DS    0D
@TS00001 DS    CL8
RCCPUID  DS    CL2
RCWATIME DS    CL10
RCCPUSER DS    CL4
RCWRKSTR DS    CL7
RCOUTCHR DS    CL5
IRBMFRCR CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA00125 DC    A(IRBMFLCV)
         DS    0D
@CB00139 DC    B'00000000'
RCDTRTAB DC    CL16'0123456789ABCDEF'
RCPATCH  DS    CL100
@DATD    DSECT
IRBMFRCR CSECT
RCMILLI  DC    F'1000'                 THOUSANDTH OF A SECOND
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IRBMFRCR CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RCCPUTOT EQU   @03
RCCPUIDX EQU   @02
I        EQU   @04
GPR11    EQU   @11
GPR12    EQU   @12
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR14P   EQU   @14
GPR15P   EQU   @15
GPR00F   EQU   @00
GPR01F   EQU   @01
GPR14F   EQU   @14
GPR15F   EQU   @15
         EXTRN IRBMFLCV
SMFRCD70 EQU   0
SMF70SIZ EQU   SMFRCD70+18
SMF70INT EQU   SMFRCD70+28
SMF70A   EQU   0
SMF70SCC EQU   SMF70A
SMF70CPU EQU   SMF70A+2
SMF70B   EQU   0
SMF70WAT EQU   SMF70B
SMF70CID EQU   SMF70B+8
SMF70CNF EQU   SMF70B+11
SMF70VAC EQU   SMF70CNF
SMF70STA EQU   SMF70CNF
SMF70SER EQU   SMF70B+13
IRBMFCNV EQU   0
MFHDRISR EQU   0
MFISRTXT EQU   0
MFWRTPAG EQU   0
RCLANGPT EQU   0
RCLENGTH EQU   RCLANGPT
RCTEXT   EQU   RCLANGPT+4
RCTRTAB  EQU   0
RCDUMTXT EQU   0
IKEBC    EQU   0
IKEBF15  EQU   0
IKEBF31  EQU   0
IKEBP15  EQU   0
IKEBP31  EQU   0
IKEBP8   EQU   0
RCDATPTR EQU   0
RCVECTAB EQU   0
SMF70PTR EQU   RCDATPTR
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
SMF70RV4 EQU   SMF70B+12
@NM00001 EQU   SMF70CNF
SMF70RV3 EQU   SMF70B+10
SMF70RV2 EQU   SMF70A+6
SMF70SCD EQU   SMF70A+4
SMF70RLS EQU   SMFRCD70+44
SMF70RV1 EQU   SMFRCD70+42
SMF70MFV EQU   SMFRCD70+40
SMF70SAM EQU   SMFRCD70+36
SMF70SUB EQU   SMFRCD70+34
SMF70CYC EQU   SMFRCD70+32
SMF70DAT EQU   SMFRCD70+24
SMF70IST EQU   SMFRCD70+20
SMF70SID EQU   SMFRCD70+14
SMF70DTE EQU   SMFRCD70+10
SMF70TME EQU   SMFRCD70+6
SMF70RTY EQU   SMFRCD70+5
SMF70FLG EQU   SMFRCD70+4
SMF70SEG EQU   SMFRCD70+2
SMF70LEN EQU   SMFRCD70
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@ENDDATA EQU   *
         END   IRBMFRCR,(C'PL/S-II',0502,74087)

         TITLE '*/* IRBMFRHR - CHANNEL REPORT GENERATOR                *
                       '
IRBMFRHR CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IRBMFRHR  74.087'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@10                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @09,@01                                             0001
         USING @DATD,@09                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @09,8(,@13)                                         0001
         LR    @13,@09                                             0001
         MVC   @PC00001(12),0(@01)                                 0001
*                                                                  0013
*/* BEGIN MAINLINE PROCESSING                                        */
*                                                                  0013
*   /*****************************************************************/
*   /*                                                               */
*   /* BEGIN REPORT GENERATOR PROCESSING. CREATE ONE REPORT ONLY.    */
*   /* FIRST INITIALIZE VARIABLES.                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0013
*   RHPAGE=1;                       /* FIRST PAGE                    */
         LA    @08,1                                               0013
         ST    @08,RHPAGE                                          0013
*   RHLINE=RGMAXLN;                 /* TRIGGER HEADING BY SETTING  0014
*                                      LINE NUMBER ABOVE MAXIMUM     */
         MVC   RHLINE(4),@CF00085                                  0014
*   RHCPUNO=-1;                     /* PRESET CPU NUMBER TO TRIGGER
*                                      NEW CPU                       */
*                                                                  0015
         MVC   RHCPUNO(4),@CF00216                                 0015
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH CHANNEL ENTRIES                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0016
*   DO RHCHAIDX=1 TO SMF73CHA+1;    /* LAST LOOP IS TO PRINT FINAL 0016
*                                      TOTALS                        */
*                                                                  0016
         LR    RHCHAIDX,@08                                        0016
         B     @DE00016                                            0016
@DL00016 DS    0H                                                  0017
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR END OF OLD CPU AND BEGINNING OF NEW CPU OR LAST   */
*     /* TIME THROUGH LOOP                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0017
*     IF RHCHAIDX=SMF73CHA+1×RHCPUNO^=SMF73CID(RHCHAIDX)THEN       0017
         L     @08,@PC00001                                        0017
         L     @08,RHDTAPTR(,@08)                                  0017
         LA    @03,SMF73SIZ(,@08)                                  0017
         AH    @03,SMF73SIZ(,@08)                                  0017
         LA    @08,1                                               0017
         AH    @08,SMF73CHA(,@03)                                  0017
         CR    RHCHAIDX,@08                                        0017
         BE    @RT00017                                            0017
         LR    @08,RHCHAIDX                                        0017
         SLA   @08,4                                               0017
         LH    @15,SMF73SHC(,@03)                                  0017
         AR    @15,@03                                             0017
         L     @03,RHCPUNO                                         0017
         AL    @15,@CF00240                                        0017
         CH    @03,SMF73CID(@08,@15)                               0017
         BE    @RF00017                                            0017
@RT00017 DS    0H                                                  0018
*       DO;                                                        0018
*         IF RHCHAIDX^=1 THEN       /* IF NOT THE FIRST ENTRY        */
         LA    @08,1                                               0019
         CR    RHCHAIDX,@08                                        0019
         BE    @RF00019                                            0019
*           DO;                                                    0020
*                                                                  0020
*             /*******************************************************/
*             /*                                                     */
*             /* PRINT TOTALS                                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0021
*             RHLINE=RHLINE+1;      /* ONE BLANK LINE                */
*                                                                  0021
         A     @08,RHLINE                                          0021
         ST    @08,RHLINE                                          0021
*             /*******************************************************/
*             /*                                                     */
*             /* INSERT 'TOTAL' MACDATE Y-2 73018                    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0022
*             CALL MFISRTXT(        /* INSERT TEXT ROUTINE           */
*                 LNGTPTR(LHPART1)->LNGTXTD,/* TEXT                  */
*                 LNGTPTR(LHPART1)->LNGTXTL,/* LENGTH                */
*                 RHLINE,           /* START LINE                    */
*                 COLA              /* START COLUMN                  */
*                 );                                               0022
*                                                                  0022
         L     @08,@CA00100                                        0022
         L     @08,LNGTPTR-IRBMFLHV(,@08)                          0022
         LA    @03,LNGTXTD(,@08)                                   0022
         ST    @03,@AL00001                                        0022
         ST    @08,@AL00001+4                                      0022
         LA    @08,RHLINE                                          0022
         ST    @08,@AL00001+8                                      0022
         LA    @08,@CF00075                                        0022
         ST    @08,@AL00001+12                                     0022
         L     @08,@PC00001+4                                      0022
         L     @15,RHVECTAB+8(,@08)                                0022
         LA    @01,@AL00001                                        0022
         BALR  @14,@15                                             0022
*             /*******************************************************/
*             /*                                                     */
*             /* INSERT TOTAL SIOS FOR CPU. IF LT 1,000,000,INSERT AS*/
*             /* NNN,NNN. IF GE 1,000,000, INSERT AS N,NNN,NNN.NNNM  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0023
*             IF RHSIOTOT<1000000 THEN                             0023
         L     @08,RHSIOTOT                                        0023
         C     @08,@CF00217                                        0023
         BNL   @RF00023                                            0023
*               DO;                                                0024
*                                                                  0024
*                 /***************************************************/
*                 /*                                                 */
*                 /* MACDATE Y-2 73018                               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0025
*                 CALL IRBMFCNV(    /* CONVERSION ROUTINE            */
*                     RHSIOTOT,     /* INPUT VALUE                   */
*                     RHDATSCF,     /* INPUT SCALE                   */
*                     RHWRKSTR,     /* OUTPUT STRING                 */
*                     RHCOUNTL,     /* OUTPUT LENGTH                 */
*                     RHNOPLCE,     /* PLACES RIGHT OF DEC PT        */
*                     RHCOMMAS,     /* COMMAS FLAG                   */
*                     RHNOFLOT      /* MAX PRECISION FLAG            */
*                     );                                           0025
*                                                                  0025
         MVC   @AL00001+4(24),@AL00025                             0025
         LA    @08,RHSIOTOT                                        0025
         ST    @08,@AL00001                                        0025
         LA    @08,RHWRKSTR                                        0025
         ST    @08,@AL00001+8                                      0025
         L     @08,@PC00001+4                                      0025
         L     @15,RHVECTAB(,@08)                                  0025
         LA    @01,@AL00001                                        0025
         BALR  @14,@15                                             0025
*                 /***************************************************/
*                 /*                                                 */
*                 /* MACDATE Y-2 73018                               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0026
*                 CALL MFISRTXT(    /* INSERT TEXT ROUTINE           */
*                     RHWRKSTR,     /* TEXT                          */
*                     RHCOUNTL,     /* LENGTH                        */
*                     RHLINE,       /* START LINE                    */
*                     COLD          /* START COLUMN                  */
*                     );                                           0026
         LA    @08,RHWRKSTR                                        0026
         ST    @08,@AL00001                                        0026
         LA    @08,@CF00114                                        0026
         ST    @08,@AL00001+4                                      0026
         LA    @08,RHLINE                                          0026
         ST    @08,@AL00001+8                                      0026
         LA    @08,@CF00200                                        0026
         ST    @08,@AL00001+12                                     0026
         L     @08,@PC00001+4                                      0026
         L     @15,RHVECTAB+8(,@08)                                0026
         LA    @01,@AL00001                                        0026
         BALR  @14,@15                                             0026
*               END;                                               0027
*             ELSE                                                 0028
*               DO;                                                0028
*                                                                  0028
         B     @RC00023                                            0028
@RF00023 DS    0H                                                  0029
*                 /***************************************************/
*                 /*                                                 */
*                 /* MACDATE Y-2 73018                               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0029
*                 CALL IRBMFCNV(    /* CONVERSION ROUTINE            */
*                     RHSIOTOT,     /* INPUT VALUE                   */
*                     RHMILSCF,     /* INPUT SCALE                   */
*                     RHWRKSTR,     /* OUTPUT STRING                 */
*                     RHCOUNTM,     /* OUTPUT LENGTH                 */
*                     RHDECMIL,     /* PLACES RIGHT OF DEC PT        */
*                     RHCOMMAS,     /* COMMAS FLAG                   */
*                     RHNOFLOT      /* MAX PRECISION FLAG            */
*                     );                                           0029
         MVC   @AL00001+4(24),@AL00029                             0029
         LA    @08,RHSIOTOT                                        0029
         ST    @08,@AL00001                                        0029
         LA    @08,RHWRKSTR                                        0029
         ST    @08,@AL00001+8                                      0029
         L     @08,@PC00001+4                                      0029
         L     @15,RHVECTAB(,@08)                                  0029
         LA    @01,@AL00001                                        0029
         BALR  @14,@15                                             0029
*                 RHWRKSTR(14)='M'; /* MILLIONS                      */
*                                                                  0030
         MVI   RHWRKSTR+13,C'M'                                    0030
*                 /***************************************************/
*                 /*                                                 */
*                 /* MACDATE Y-2 73018                               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0031
*                 CALL MFISRTXT(    /* INSERT TEXT ROUTINE           */
*                     RHWRKSTR,     /* TEXT                          */
*                     RHCOUNTM+1,   /* LENGTH                        */
*                     RHLINE,       /* START LINE                    */
*                     COLD+RHMILSCF /* START COLUMN                  */
*                     );                                           0031
         LA    @08,RHWRKSTR                                        0031
         ST    @08,@AL00001                                        0031
         LA    @08,@CF00126                                        0031
         ST    @08,@AL00001+4                                      0031
         LA    @08,RHLINE                                          0031
         ST    @08,@AL00001+8                                      0031
         LA    @08,@CF00135                                        0031
         ST    @08,@AL00001+12                                     0031
         L     @08,@PC00001+4                                      0031
         L     @15,RHVECTAB+8(,@08)                                0031
         LA    @01,@AL00001                                        0031
         BALR  @14,@15                                             0031
*               END;                                               0032
*                                                                  0032
*             /*******************************************************/
*             /*                                                     */
*             /* SKIP TWO LINES                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0033
*             RHLINE=RHLINE+2;                                     0033
*                                                                  0033
@RC00023 LA    @08,2                                               0033
         A     @08,RHLINE                                          0033
         ST    @08,RHLINE                                          0033
*             /*******************************************************/
*             /*                                                     */
*             /* DONT CONTINUE IF ON LAST LOOP                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0034
*             IF RHCHAIDX=SMF73CHA+1 THEN                          0034
         L     @08,@PC00001                                        0034
         L     @08,RHDTAPTR(,@08)                                  0034
         LA    @03,SMF73SIZ(,@08)                                  0034
         AH    @03,SMF73SIZ(,@08)                                  0034
         LA    @08,1                                               0034
         AH    @08,SMF73CHA(,@03)                                  0034
         CR    RHCHAIDX,@08                                        0034
         BE    @RT00034                                            0034
*               GO TO RHLAB4;                                      0035
*           END;                                                   0036
*                                                                  0036
*         /***********************************************************/
*         /*                                                         */
*         /* SET NEW CPU ID NUMBER                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0037
*         RHCPUNO=SMF73CID(RHCHAIDX);                              0037
@RF00019 LR    @08,RHCHAIDX                                        0037
         SLA   @08,4                                               0037
         L     @03,@PC00001                                        0037
         L     @03,RHDTAPTR(,@03)                                  0037
         LA    @15,SMF73SIZ(,@03)                                  0037
         AH    @15,SMF73SIZ(,@03)                                  0037
         LH    @03,SMF73SHC(,@15)                                  0037
         AR    @03,@15                                             0037
         AL    @03,@CF00240                                        0037
         LH    @08,SMF73CID(@08,@03)                               0037
         ST    @08,RHCPUNO                                         0037
*         RHNEWCPU='1'B;            /* INDICATE NEW CPU              */
*                                                                  0038
         OI    RHNEWCPU,B'10000000'                                0038
*         /***********************************************************/
*         /*                                                         */
*         /* INITIALIZE TOTALS ACCUMULATORS                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0039
*         RHCHACNT=-1;              /* INITIALIZE NUMBER OF CHANNELS
*                                      ON CPU                        */
         MVC   RHCHACNT(4),@CF00216                                0039
*         RHSIOTOT=0;               /* SIO TOTAL OF CPU              */
         SR    @08,@08                                             0040
         ST    @08,RHSIOTOT                                        0040
*       END;                                                       0041
*                                                                  0041
*     /***************************************************************/
*     /*                                                             */
*     /* IF NO MORE ROOM ON PAGE, GET NEW PAGE AND INSERT HEADER     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0042
*     IF RHLINE>=(RGMAXLN-3)THEN                                   0042
@RF00017 L     @08,RHLINE                                          0042
         CH    @08,@CH00226                                        0042
         BL    @RF00042                                            0042
*       DO;                                                        0043
*         IF RHCHAIDX>1 THEN        /* IF THIS IS NOT FIRST PAGE     */
         CH    RHCHAIDX,@CH00075                                   0044
         BNH   @RF00044                                            0044
*           CALL MFWRTPAG;          /* WRITE OUT PAGE IMAGE          */
*                                                                  0045
         L     @08,@PC00001+4                                      0045
         L     @15,RHVECTAB+12(,@08)                               0045
         BALR  @14,@15                                             0045
*         /***********************************************************/
*         /*                                                         */
*         /* BUILD NEW HEADER. START WITH STANDARD HEADER            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0046
*         CALL MFHDRISR(RHDTAPTR,   /* POINTER TO SMF RECORD         */
*                                                                  0046
*         /***********************************************************/
*         /*                                                         */
*         /* TITLE                                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0046
*             LNGTPTR(LHPART2)->LNGTXTD,                           0046
*                                                                  0046
*         /***********************************************************/
*         /*                                                         */
*         /* LENGTH OF TITLE                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0046
*             LNGTPTR(LHPART2)->LNGTXTL,RHPAGE/* PAGE NUMBER         */
*             );                                                   0046
@RF00044 L     @08,@PC00001                                        0046
         ST    @08,@AL00001                                        0046
         L     @08,@CA00100                                        0046
         L     @08,LNGTPTR-IRBMFLHV+4(,@08)                        0046
         LA    @03,LNGTXTD(,@08)                                   0046
         ST    @03,@AL00001+4                                      0046
         ST    @08,@AL00001+8                                      0046
         LA    @08,RHPAGE                                          0046
         ST    @08,@AL00001+12                                     0046
         L     @08,@PC00001+4                                      0046
         L     @15,RHVECTAB+4(,@08)                                0046
         LA    @01,@AL00001                                        0046
         BALR  @14,@15                                             0046
*         RHPAGE=RHPAGE+1;          /* NEW PAGE NUMBER               */
*                                                                  0047
         LA    @08,1                                               0047
         A     @08,RHPAGE                                          0047
         ST    @08,RHPAGE                                          0047
*         /***********************************************************/
*         /*                                                         */
*         /* BUILD SPECIAL CHANNEL HEADER. FIRST INSERT 'CPU' MACDATE*/
*         /* Y-2 73018                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0048
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART3)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART3)->LNGTXTL,/* LENGTH                    */
*             LINE10,               /* START LINE                    */
*             COLA                  /* START COLUMN                  */
*             );                                                   0048
*                                                                  0048
         L     @08,@CA00100                                        0048
         L     @08,LNGTPTR-IRBMFLHV+8(,@08)                        0048
         LA    @03,LNGTXTD(,@08)                                   0048
         ST    @03,@AL00001                                        0048
         ST    @08,@AL00001+4                                      0048
         LA    @08,@CF00119                                        0048
         ST    @08,@AL00001+8                                      0048
         LA    @08,@CF00075                                        0048
         ST    @08,@AL00001+12                                     0048
         L     @08,@PC00001+4                                      0048
         L     @15,RHVECTAB+8(,@08)                                0048
         LA    @01,@AL00001                                        0048
         BALR  @14,@15                                             0048
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'CHANNEL' MACDATE Y-2 73018                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0049
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART4)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART4)->LNGTXTL,/* LENGTH                    */
*             LINE8,                /* START LINE                    */
*             COLB                  /* START COLUMN                  */
*             );                                                   0049
*                                                                  0049
         L     @08,@CA00100                                        0049
         L     @08,LNGTPTR-IRBMFLHV+12(,@08)                       0049
         LA    @03,LNGTXTD(,@08)                                   0049
         ST    @03,@AL00001                                        0049
         ST    @08,@AL00001+4                                      0049
         LA    @08,@CF00044                                        0049
         ST    @08,@AL00001+8                                      0049
         LA    @08,@CF00112                                        0049
         ST    @08,@AL00001+12                                     0049
         L     @08,@PC00001+4                                      0049
         L     @15,RHVECTAB+8(,@08)                                0049
         LA    @01,@AL00001                                        0049
         BALR  @14,@15                                             0049
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'NUMBER' MACDATE Y-2 73018                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0050
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART5)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART5)->LNGTXTL,/* LENGTH                    */
*             LINE9,                /* START LINE                    */
*             COLB                  /* START COLUMN                  */
*             );                                                   0050
*                                                                  0050
         L     @08,@CA00100                                        0050
         L     @08,LNGTPTR-IRBMFLHV+16(,@08)                       0050
         LA    @03,LNGTXTD(,@08)                                   0050
         ST    @03,@AL00001                                        0050
         ST    @08,@AL00001+4                                      0050
         LA    @08,@CF00117                                        0050
         ST    @08,@AL00001+8                                      0050
         LA    @08,@CF00112                                        0050
         ST    @08,@AL00001+12                                     0050
         L     @08,@PC00001+4                                      0050
         L     @15,RHVECTAB+8(,@08)                                0050
         LA    @01,@AL00001                                        0050
         BALR  @14,@15                                             0050
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'AND TYPE' MACDATE Y-2 73018                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0051
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART6)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART6)->LNGTXTL,/* LENGTH                    */
*             LINE10,               /* START LINE                    */
*             COLB                  /* START COLUMN                  */
*             );                                                   0051
*                                                                  0051
         L     @08,@CA00100                                        0051
         L     @08,LNGTPTR-IRBMFLHV+20(,@08)                       0051
         LA    @03,LNGTXTD(,@08)                                   0051
         ST    @03,@AL00001                                        0051
         ST    @08,@AL00001+4                                      0051
         LA    @08,@CF00119                                        0051
         ST    @08,@AL00001+8                                      0051
         LA    @08,@CF00112                                        0051
         ST    @08,@AL00001+12                                     0051
         L     @08,@PC00001+4                                      0051
         L     @15,RHVECTAB+8(,@08)                                0051
         LA    @01,@AL00001                                        0051
         BALR  @14,@15                                             0051
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'CHANNEL' MACDATE Y-2 73018                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0052
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART4)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART4)->LNGTXTL,/* LENGTH                    */
*             LINE8,                /* START LINE                    */
*             COLD                  /* START COLUMN                  */
*             );                                                   0052
*                                                                  0052
         L     @08,@CA00100                                        0052
         L     @08,LNGTPTR-IRBMFLHV+12(,@08)                       0052
         LA    @03,LNGTXTD(,@08)                                   0052
         ST    @03,@AL00001                                        0052
         ST    @08,@AL00001+4                                      0052
         LA    @08,@CF00044                                        0052
         ST    @08,@AL00001+8                                      0052
         LA    @08,@CF00200                                        0052
         ST    @08,@AL00001+12                                     0052
         L     @08,@PC00001+4                                      0052
         L     @15,RHVECTAB+8(,@08)                                0052
         LA    @01,@AL00001                                        0052
         BALR  @14,@15                                             0052
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'ACTIVITY' MACDATE Y-2 73018                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0053
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART7)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART7)->LNGTXTL,/* LENGTH                    */
*             LINE9,                /* START LINE                    */
*             COLD                  /* START COLUMN                  */
*             );                                                   0053
*                                                                  0053
         L     @08,@CA00100                                        0053
         L     @08,LNGTPTR-IRBMFLHV+24(,@08)                       0053
         LA    @03,LNGTXTD(,@08)                                   0053
         ST    @03,@AL00001                                        0053
         ST    @08,@AL00001+4                                      0053
         LA    @08,@CF00117                                        0053
         ST    @08,@AL00001+8                                      0053
         LA    @08,@CF00200                                        0053
         ST    @08,@AL00001+12                                     0053
         L     @08,@PC00001+4                                      0053
         L     @15,RHVECTAB+8(,@08)                                0053
         LA    @01,@AL00001                                        0053
         BALR  @14,@15                                             0053
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'COUNT' MACDATE Y-2 73018                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0054
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART8)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART8)->LNGTXTL,/* LENGTH                    */
*             LINE10,               /* START LINE                    */
*             COLD                  /* START COLUMN                  */
*             );                                                   0054
*                                                                  0054
         L     @08,@CA00100                                        0054
         L     @08,LNGTPTR-IRBMFLHV+28(,@08)                       0054
         LA    @03,LNGTXTD(,@08)                                   0054
         ST    @03,@AL00001                                        0054
         ST    @08,@AL00001+4                                      0054
         LA    @08,@CF00119                                        0054
         ST    @08,@AL00001+8                                      0054
         LA    @08,@CF00200                                        0054
         ST    @08,@AL00001+12                                     0054
         L     @08,@PC00001+4                                      0054
         L     @15,RHVECTAB+8(,@08)                                0054
         LA    @01,@AL00001                                        0054
         BALR  @14,@15                                             0054
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'PERCENT' MACDATE Y-2 73018                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0055
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART9)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART9)->LNGTXTL,/* LENGTH                    */
*             LINE8,                /* START LINE                    */
*             COLE                  /* START COLUMN                  */
*             );                                                   0055
*                                                                  0055
         L     @08,@CA00100                                        0055
         L     @08,LNGTPTR-IRBMFLHV+32(,@08)                       0055
         LA    @03,LNGTXTD(,@08)                                   0055
         ST    @03,@AL00001                                        0055
         ST    @08,@AL00001+4                                      0055
         LA    @08,@CF00044                                        0055
         ST    @08,@AL00001+8                                      0055
         LA    @08,@CF00202                                        0055
         ST    @08,@AL00001+12                                     0055
         L     @08,@PC00001+4                                      0055
         L     @15,RHVECTAB+8(,@08)                                0055
         LA    @01,@AL00001                                        0055
         BALR  @14,@15                                             0055
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'CHANNEL' MACDATE Y-2 73018                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0056
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART4)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART4)->LNGTXTL,/* LENGTH                    */
*             LINE9,                /* START LINE                    */
*             COLE                  /* START COLUMN                  */
*             );                                                   0056
*                                                                  0056
         L     @08,@CA00100                                        0056
         L     @08,LNGTPTR-IRBMFLHV+12(,@08)                       0056
         LA    @03,LNGTXTD(,@08)                                   0056
         ST    @03,@AL00001                                        0056
         ST    @08,@AL00001+4                                      0056
         LA    @08,@CF00117                                        0056
         ST    @08,@AL00001+8                                      0056
         LA    @08,@CF00202                                        0056
         ST    @08,@AL00001+12                                     0056
         L     @08,@PC00001+4                                      0056
         L     @15,RHVECTAB+8(,@08)                                0056
         LA    @01,@AL00001                                        0056
         BALR  @14,@15                                             0056
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'BUSY' MACDATE Y-2 73018                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0057
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART10)->LNGTXTD,/* TEXT                     */
*             LNGTPTR(LHPART10)->LNGTXTL,/* LENGTH                   */
*             LINE10,               /* START LINE                    */
*             COLE                  /* START COLUMN                  */
*             );                                                   0057
*                                                                  0057
         L     @08,@CA00100                                        0057
         L     @08,LNGTPTR-IRBMFLHV+36(,@08)                       0057
         LA    @03,LNGTXTD(,@08)                                   0057
         ST    @03,@AL00001                                        0057
         ST    @08,@AL00001+4                                      0057
         LA    @08,@CF00119                                        0057
         ST    @08,@AL00001+8                                      0057
         LA    @08,@CF00202                                        0057
         ST    @08,@AL00001+12                                     0057
         L     @08,@PC00001+4                                      0057
         L     @15,RHVECTAB+8(,@08)                                0057
         LA    @01,@AL00001                                        0057
         BALR  @14,@15                                             0057
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'PERCENT' MACDATE Y-2 73018                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0058
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART9)->LNGTXTD,/* TEXT                      */
*             LNGTPTR(LHPART9)->LNGTXTL,/* LENGTH                    */
*             LINE8,                /* START LINE                    */
*             COLF                  /* START COLUMN                  */
*             );                                                   0058
*                                                                  0058
         L     @08,@CA00100                                        0058
         L     @08,LNGTPTR-IRBMFLHV+32(,@08)                       0058
         LA    @03,LNGTXTD(,@08)                                   0058
         ST    @03,@AL00001                                        0058
         ST    @08,@AL00001+4                                      0058
         LA    @08,@CF00044                                        0058
         ST    @08,@AL00001+8                                      0058
         LA    @08,@CF00204                                        0058
         ST    @08,@AL00001+12                                     0058
         L     @08,@PC00001+4                                      0058
         L     @15,RHVECTAB+8(,@08)                                0058
         LA    @01,@AL00001                                        0058
         BALR  @14,@15                                             0058
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'CHAN BUSY' MACDATE Y-2 73018                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0059
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART11)->LNGTXTD,/* TEXT                     */
*             LNGTPTR(LHPART11)->LNGTXTL,/* LENGTH                   */
*             LINE9,                /* START LINE                    */
*             COLF                  /* START COLUMN                  */
*             );                                                   0059
*                                                                  0059
         L     @08,@CA00100                                        0059
         L     @08,LNGTPTR-IRBMFLHV+40(,@08)                       0059
         LA    @03,LNGTXTD(,@08)                                   0059
         ST    @03,@AL00001                                        0059
         ST    @08,@AL00001+4                                      0059
         LA    @08,@CF00117                                        0059
         ST    @08,@AL00001+8                                      0059
         LA    @08,@CF00204                                        0059
         ST    @08,@AL00001+12                                     0059
         L     @08,@PC00001+4                                      0059
         L     @15,RHVECTAB+8(,@08)                                0059
         LA    @01,@AL00001                                        0059
         BALR  @14,@15                                             0059
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT '& CPU BUSY' MACDATE Y-2 73018                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0060
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART12)->LNGTXTD,/* TEXT                     */
*             LNGTPTR(LHPART12)->LNGTXTL,/* LENGTH                   */
*             LINE10,               /* START LINE                    */
*             COLF                  /* START COLUMN                  */
*             );                                                   0060
         L     @08,@CA00100                                        0060
         L     @08,LNGTPTR-IRBMFLHV+44(,@08)                       0060
         LA    @03,LNGTXTD(,@08)                                   0060
         ST    @03,@AL00001                                        0060
         ST    @08,@AL00001+4                                      0060
         LA    @08,@CF00119                                        0060
         ST    @08,@AL00001+8                                      0060
         LA    @08,@CF00204                                        0060
         ST    @08,@AL00001+12                                     0060
         L     @08,@PC00001+4                                      0060
         L     @15,RHVECTAB+8(,@08)                                0060
         LA    @01,@AL00001                                        0060
         BALR  @14,@15                                             0060
*         RHLINE=CDATLINE;          /* INITIALIZE LINE NUMBER FOR  0061
*                                      NEXT ENTRY                    */
         MVC   RHLINE(4),@CF00087                                  0061
*         RHNEWCPU='1'B;            /* TRIGGER NEW CPU SO THAT CPU 0062
*                                      NUMBER WILL BE PRINTED ON   0062
*                                      FIRST LINE OF PAGE.           */
         OI    RHNEWCPU,B'10000000'                                0062
*       END;                                                       0063
*                                                                  0063
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT CHANNELS ON CPU COUNTER. SKIP LINE IF MULTIPLE OF */
*     /* FOUR FOR CHANNEL GROUPING. DONT SKIP IF TOP OF PAGE.        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0064
*     RHCHACNT=RHCHACNT+1;                                         0064
@RF00042 LA    @08,1                                               0064
         L     @03,RHCHACNT                                        0064
         AR    @03,@08                                             0064
         ST    @03,RHCHACNT                                        0064
*     IF RHCHACNT//4=0&RHLINE^=CDATLINE THEN                       0065
         LR    @00,@03                                             0065
         SRDA  @00,32                                              0065
         D     @00,@CF00049                                        0065
         LTR   @00,@00                                             0065
         BNZ   @RF00065                                            0065
         L     @03,RHLINE                                          0065
         CH    @03,@CH00087                                        0065
         BE    @RF00065                                            0065
*       RHLINE=RHLINE+1;                                           0066
*                                                                  0066
         AR    @03,@08                                             0066
         ST    @03,RHLINE                                          0066
*     /***************************************************************/
*     /*                                                             */
*     /* FORMAT AND INSERT DATA FOR THIS CHANNEL. FIRST CHECK TO SEE */
*     /* IF THIS IS A NEW CPU. IF SO, INSERT CPU NUMBER              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0067
*     IF RHNEWCPU='1'B THEN         /* IF THIS IS A NEW CPU          */
@RF00065 TM    RHNEWCPU,B'10000000'                                0067
         BNO   @RF00067                                            0067
*       DO;                                                        0068
*         RHNEWCPU='0'B;            /* RESET FLAG                    */
*                                                                  0069
         NI    RHNEWCPU,B'01111111'                                0069
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT CPU NUMBER MACDATE Y-2 73018                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0070
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */
*             RHCPUNO,              /* INPUT VALUE                   */
*             RHDATSCF,             /* INPUT SCALE                   */
*             RHWRKSTR,             /* OUTPUT STRING                 */
*             RHCPULEN,             /* OUTPUT LENGTH                 */
*             RHNOPLCE,             /* PLACES RIGHT OF DEC PT        */
*             RHNOCOMA,             /* COMMAS FLAG                   */
*             RHNOFLOT              /* MAX PRECISION FLAG            */
*             );                                                   0070
*                                                                  0070
         MVC   @AL00001+4(24),@AL00070                             0070
         LA    @08,RHCPUNO                                         0070
         ST    @08,@AL00001                                        0070
         LA    @08,RHWRKSTR                                        0070
         ST    @08,@AL00001+8                                      0070
         L     @08,@PC00001+4                                      0070
         L     @15,RHVECTAB(,@08)                                  0070
         LA    @01,@AL00001                                        0070
         BALR  @14,@15                                             0070
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0071
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             RHWRKSTR,             /* TEXT                          */
*             RHCPULEN,             /* LENGTH                        */
*             RHLINE,               /* START LINE                    */
*             COLA                  /* START COLUMN                  */
*             );                                                   0071
         LA    @08,RHWRKSTR                                        0071
         ST    @08,@AL00001                                        0071
         LA    @08,@CF00056                                        0071
         ST    @08,@AL00001+4                                      0071
         LA    @08,RHLINE                                          0071
         ST    @08,@AL00001+8                                      0071
         LA    @08,@CF00075                                        0071
         ST    @08,@AL00001+12                                     0071
         L     @08,@PC00001+4                                      0071
         L     @15,RHVECTAB+8(,@08)                                0071
         LA    @01,@AL00001                                        0071
         BALR  @14,@15                                             0071
*       END;                                                       0072
*                                                                  0072
*     /***************************************************************/
*     /*                                                             */
*     /* INSERT REST OF CHANNEL DATA. START WITH CHANNEL NUMBER      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0073
*     RHCHANO(2)=SMF73HID(RHCHAIDX);                               0073
@RF00067 LR    @08,RHCHAIDX                                        0073
         SLA   @08,4                                               0073
         L     @03,@PC00001                                        0073
         L     @03,RHDTAPTR(,@03)                                  0073
         LA    @15,SMF73SIZ(,@03)                                  0073
         AH    @15,SMF73SIZ(,@03)                                  0073
         LH    @03,SMF73SHC(,@15)                                  0073
         AR    @03,@15                                             0073
         AL    @03,@CF00243                                        0073
         SR    @15,@15                                             0073
         IC    @15,SMF73HID-2(@08,@03)                             0073
         STC   @15,RHCHANO+1                                       0073
*     UNPK(RHWRKSTR(1:3),RHCHANO(2:3));/* FORM FCFCXX                */
         UNPK  RHWRKSTR(3),RHCHANO+1(2)                            0074
*     TR(RHWRKSTR(1:2),RHTRTAB);    /* PRINTABLE CHARACTERS          */
*                                                                  0075
         LA    @08,@CC00161                                        0075
         SH    @08,@CH00160                                        0075
         TR    RHWRKSTR(2),RHTRTAB(@08)                            0075
*     /***************************************************************/
*     /*                                                             */
*     /* MACDATE Y-2 73018                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0076
*     CALL MFISRTXT(                /* INSERT TEXT ROUTINE           */
*         RHWRKSTR(2),              /* TEXT                          */
*         1,                        /* LENGTH                        */
*         RHLINE,                   /* START LINE                    */
*         COLB                      /* START COLUMN                  */
*         );                                                       0076
*                                                                  0076
         LA    @08,RHWRKSTR+1                                      0076
         ST    @08,@AL00001                                        0076
         LA    @08,@CF00075                                        0076
         ST    @08,@AL00001+4                                      0076
         LA    @08,RHLINE                                          0076
         ST    @08,@AL00001+8                                      0076
         LA    @08,@CF00112                                        0076
         ST    @08,@AL00001+12                                     0076
         L     @08,@PC00001+4                                      0076
         L     @15,RHVECTAB+8(,@08)                                0076
         LA    @01,@AL00001                                        0076
         BALR  @14,@15                                             0076
*     /***************************************************************/
*     /*                                                             */
*     /* INSERT CHANNEL TYPE                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0077
*     IF SMF73IID(RHCHAIDX)='1'B THEN                              0077
         LR    @08,RHCHAIDX                                        0077
         SLA   @08,4                                               0077
         L     @03,@PC00001                                        0077
         L     @03,RHDTAPTR(,@03)                                  0077
         LA    @15,SMF73SIZ(,@03)                                  0077
         AH    @15,SMF73SIZ(,@03)                                  0077
         LH    @03,SMF73SHC(,@15)                                  0077
         AR    @03,@15                                             0077
         ALR   @03,@08                                             0077
         AL    @03,@CF00244                                        0077
         TM    SMF73IID-3(@03),B'00000100'                         0077
         BNO   @RF00077                                            0077
*       DO;                         /* CHANNEL TYPE FIELD IS INVALID */
*                                                                  0078
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'INVALID' MACDATE Y-2 73018                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0079
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART13)->LNGTXTD,/* TEXT                     */
*             LNGTPTR(LHPART13)->LNGTXTL,/* LENGTH                   */
*             RHLINE,               /* START LINE                    */
*             COLC                  /* START COLUMN                  */
*             );                                                   0079
         L     @08,@CA00100                                        0079
         L     @08,LNGTPTR-IRBMFLHV+48(,@08)                       0079
         LA    @03,LNGTXTD(,@08)                                   0079
         ST    @03,@AL00001                                        0079
         ST    @08,@AL00001+4                                      0079
         LA    @08,RHLINE                                          0079
         ST    @08,@AL00001+8                                      0079
         LA    @08,@CF00117                                        0079
         ST    @08,@AL00001+12                                     0079
         L     @08,@PC00001+4                                      0079
         L     @15,RHVECTAB+8(,@08)                                0079
         LA    @01,@AL00001                                        0079
         BALR  @14,@15                                             0079
*         GO TO RHLAB2;             /* THEN GO TO INSERT CHANNEL   0080
*                                      STATUS                        */
         B     RHLAB2                                              0080
*       END;                                                       0081
*     IF SMF73TYP(RHCHAIDX)=MULTPLEX THEN                          0082
@RF00077 LR    @08,RHCHAIDX                                        0082
         SLA   @08,4                                               0082
         L     @03,@PC00001                                        0082
         L     @03,RHDTAPTR(,@03)                                  0082
         LA    @15,SMF73SIZ(,@03)                                  0082
         AH    @15,SMF73SIZ(,@03)                                  0082
         LH    @03,SMF73SHC(,@15)                                  0082
         AR    @03,@15                                             0082
         ALR   @03,@08                                             0082
         AL    @03,@CF00244                                        0082
         TM    SMF73TYP-3(@03),B'00010000'                         0082
         BNO   @RF00082                                            0082
         TM    SMF73TYP-3(@03),B'11100000'                         0082
         BNZ   @RF00082                                            0082
*       DO;                         /* TEST FOR BYTE MPX CHANNEL     */
*                                                                  0083
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'BYTE MPX' MACDATE Y-2 73018                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0084
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART14)->LNGTXTD,/* TEXT                     */
*             LNGTPTR(LHPART14)->LNGTXTL,/* LENGTH                   */
*             RHLINE,               /* START LINE                    */
*             COLC                  /* START COLUMN                  */
*             );                                                   0084
         L     @08,@CA00100                                        0084
         L     @08,LNGTPTR-IRBMFLHV+52(,@08)                       0084
         LA    @03,LNGTXTD(,@08)                                   0084
         ST    @03,@AL00001                                        0084
         ST    @08,@AL00001+4                                      0084
         LA    @08,RHLINE                                          0084
         ST    @08,@AL00001+8                                      0084
         LA    @08,@CF00117                                        0084
         ST    @08,@AL00001+12                                     0084
         L     @08,@PC00001+4                                      0084
         L     @15,RHVECTAB+8(,@08)                                0084
         LA    @01,@AL00001                                        0084
         BALR  @14,@15                                             0084
*         GO TO RHLAB2;             /* THEN GO TO INSERT CHANNEL   0085
*                                      COUNT OR STATUS               */
         B     RHLAB2                                              0085
*       END;                                                       0086
*     IF SMF73TYP(RHCHAIDX)=SELECTOR THEN                          0087
@RF00082 LR    @08,RHCHAIDX                                        0087
         SLA   @08,4                                               0087
         L     @03,@PC00001                                        0087
         L     @03,RHDTAPTR(,@03)                                  0087
         LA    @15,SMF73SIZ(,@03)                                  0087
         AH    @15,SMF73SIZ(,@03)                                  0087
         LH    @03,SMF73SHC(,@15)                                  0087
         AR    @03,@15                                             0087
         ALR   @03,@08                                             0087
         AL    @03,@CF00244                                        0087
         TM    SMF73TYP-3(@03),B'11110000'                         0087
         BNZ   @RF00087                                            0087
*       DO;                         /* TEST FOR SELECTOR CHANNEL     */
*                                                                  0088
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'SELECTOR' MACDATE Y-2 73018                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0089
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART15)->LNGTXTD,/* TEXT                     */
*             LNGTPTR(LHPART15)->LNGTXTL,/* LENGTH                   */
*             RHLINE,               /* START LINE                    */
*             COLC                  /* START COLUMN                  */
*             );                                                   0089
         L     @08,@CA00100                                        0089
         L     @08,LNGTPTR-IRBMFLHV+56(,@08)                       0089
         LA    @03,LNGTXTD(,@08)                                   0089
         ST    @03,@AL00001                                        0089
         ST    @08,@AL00001+4                                      0089
         LA    @08,RHLINE                                          0089
         ST    @08,@AL00001+8                                      0089
         LA    @08,@CF00117                                        0089
         ST    @08,@AL00001+12                                     0089
         L     @08,@PC00001+4                                      0089
         L     @15,RHVECTAB+8(,@08)                                0089
         LA    @01,@AL00001                                        0089
         BALR  @14,@15                                             0089
*         GO TO RHLAB2;             /* THEN GO TO INSERT CHANNEL   0090
*                                      COUNT OR STATUS               */
         B     RHLAB2                                              0090
*       END;                                                       0091
*     IF SMF73TYP(RHCHAIDX)=BLKMPLEX THEN/* TEST FOR BLOCK MPX     0092
*                                      CHANNEL                       */
*                                                                  0092
@RF00087 LR    @08,RHCHAIDX                                        0092
         SLA   @08,4                                               0092
         L     @03,@PC00001                                        0092
         L     @03,RHDTAPTR(,@03)                                  0092
         LA    @15,SMF73SIZ(,@03)                                  0092
         AH    @15,SMF73SIZ(,@03)                                  0092
         LH    @03,SMF73SHC(,@15)                                  0092
         AR    @03,@15                                             0092
         ALR   @03,@08                                             0092
         AL    @03,@CF00244                                        0092
         TM    SMF73TYP-3(@03),B'00100000'                         0092
         BNO   @RF00092                                            0092
         TM    SMF73TYP-3(@03),B'11010000'                         0092
         BNZ   @RF00092                                            0092
*       /*************************************************************/
*       /*                                                           */
*       /* INSERT 'BLOCK MPX' MACDATE Y-2 73018                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0093
*       CALL MFISRTXT(              /* INSERT TEXT ROUTINE           */
*           LNGTPTR(LHPART16)->LNGTXTD,/* TEXT                       */
*           LNGTPTR(LHPART16)->LNGTXTL,/* LENGTH                     */
*           RHLINE,                 /* START LINE                    */
*           COLC                    /* START COLUMN                  */
*           );                                                     0093
         L     @08,@CA00100                                        0093
         L     @08,LNGTPTR-IRBMFLHV+60(,@08)                       0093
         LA    @03,LNGTXTD(,@08)                                   0093
         ST    @03,@AL00001                                        0093
         ST    @08,@AL00001+4                                      0093
         LA    @08,RHLINE                                          0093
         ST    @08,@AL00001+8                                      0093
         LA    @08,@CF00117                                        0093
         ST    @08,@AL00001+12                                     0093
         L     @08,@PC00001+4                                      0093
         L     @15,RHVECTAB+8(,@08)                                0093
         LA    @01,@AL00001                                        0093
         BALR  @14,@15                                             0093
*RHLAB2:                                                           0094
*                                                                  0094
*     /***************************************************************/
*     /*                                                             */
*     /* INSERT CHANNEL ACTIVITY COUNT OR STATUS                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0094
*     IF SMF73VAC(RHCHAIDX)='1'B THEN                              0094
@RF00092 DS    0H                                                  0094
RHLAB2   LR    @08,RHCHAIDX                                        0094
         SLA   @08,4                                               0094
         L     @03,@PC00001                                        0094
         L     @03,RHDTAPTR(,@03)                                  0094
         LA    @15,SMF73SIZ(,@03)                                  0094
         AH    @15,SMF73SIZ(,@03)                                  0094
         LH    @03,SMF73SHC(,@15)                                  0094
         AR    @03,@15                                             0094
         ST    @08,@TF00001                                        0094
         ALR   @08,@03                                             0094
         AL    @08,@CF00244                                        0094
         TM    SMF73VAC-3(@08),B'00000010'                         0094
         BNO   @RF00094                                            0094
*       DO;                         /* CONFIGURATION CHANGE DETECTED */
*         IF SMF73STA(RHCHAIDX)='1'B THEN                          0096
*                                                                  0096
         AL    @03,@TF00001                                        0096
         AL    @03,@CF00244                                        0096
         TM    SMF73STA-3(@03),B'00000001'                         0096
         BNO   @RF00096                                            0096
*           /*********************************************************/
*           /*                                                       */
*           /* INSERT 'NOW ONLINE' MACDATE Y-2 73018                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0097
*           CALL MFISRTXT(          /* INSERT TEXT ROUTINE           */
*               LNGTPTR(LHPART17)->LNGTXTD,/* TEXT                   */
*               LNGTPTR(LHPART17)->LNGTXTL,/* LENGTH                 */
*               RHLINE,             /* START LINE                    */
*               COLD-3              /* START COLUMN                  */
*               );                                                 0097
         L     @08,@CA00100                                        0097
         L     @08,LNGTPTR-IRBMFLHV+64(,@08)                       0097
         LA    @03,LNGTXTD(,@08)                                   0097
         ST    @03,@AL00001                                        0097
         ST    @08,@AL00001+4                                      0097
         LA    @08,RHLINE                                          0097
         ST    @08,@AL00001+8                                      0097
         LA    @08,@CF00235                                        0097
         ST    @08,@AL00001+12                                     0097
         L     @08,@PC00001+4                                      0097
         L     @15,RHVECTAB+8(,@08)                                0097
         LA    @01,@AL00001                                        0097
         BALR  @14,@15                                             0097
*         ELSE                                                     0098
*                                                                  0098
*           /*********************************************************/
*           /*                                                       */
*           /* INSERT 'NOW OFFLINE' MACDATE Y-2 73018                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0098
*           CALL MFISRTXT(          /* INSERT TEXT ROUTINE           */
*               LNGTPTR(LHPART18)->LNGTXTD,/* TEXT                   */
*               LNGTPTR(LHPART18)->LNGTXTL,/* LENGTH                 */
*               RHLINE,             /* START LINE                    */
*               COLD-4              /* START COLUMN                  */
*               );                                                 0098
         B     @RC00096                                            0098
@RF00096 L     @08,@CA00100                                        0098
         L     @08,LNGTPTR-IRBMFLHV+68(,@08)                       0098
         LA    @03,LNGTXTD(,@08)                                   0098
         ST    @03,@AL00001                                        0098
         ST    @08,@AL00001+4                                      0098
         LA    @08,RHLINE                                          0098
         ST    @08,@AL00001+8                                      0098
         LA    @08,@CF00237                                        0098
         ST    @08,@AL00001+12                                     0098
         L     @08,@PC00001+4                                      0098
         L     @15,RHVECTAB+8(,@08)                                0098
         LA    @01,@AL00001                                        0098
         BALR  @14,@15                                             0098
*         GO TO RHLAB4;             /* THEN PLACE LINE POINTER ON  0099
*                                      NEXT LINE                     */
         B     RHLAB4                                              0099
*       END;                                                       0100
*     IF SMF73STA(RHCHAIDX)='0'B THEN                              0101
@RF00094 LR    @08,RHCHAIDX                                        0101
         SLA   @08,4                                               0101
         L     @03,@PC00001                                        0101
         L     @03,RHDTAPTR(,@03)                                  0101
         LA    @15,SMF73SIZ(,@03)                                  0101
         AH    @15,SMF73SIZ(,@03)                                  0101
         LH    @03,SMF73SHC(,@15)                                  0101
         AR    @03,@15                                             0101
         ALR   @03,@08                                             0101
         AL    @03,@CF00244                                        0101
         TM    SMF73STA-3(@03),B'00000001'                         0101
         BNZ   @RF00101                                            0101
*       DO;                         /* CHANNEL IS OFFLINE            */
*                                                                  0102
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'OFFLINE' MACDATE Y-2 73018                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0103
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LHPART19)->LNGTXTD,/* TEXT                     */
*             LNGTPTR(LHPART19)->LNGTXTL,/* LENGTH                   */
*             RHLINE,               /* START LINE                    */
*             COLD                  /* START COLUMN                  */
*             );                                                   0103
         L     @08,@CA00100                                        0103
         L     @08,LNGTPTR-IRBMFLHV+72(,@08)                       0103
         LA    @03,LNGTXTD(,@08)                                   0103
         ST    @03,@AL00001                                        0103
         ST    @08,@AL00001+4                                      0103
         LA    @08,RHLINE                                          0103
         ST    @08,@AL00001+8                                      0103
         LA    @08,@CF00200                                        0103
         ST    @08,@AL00001+12                                     0103
         L     @08,@PC00001+4                                      0103
         L     @15,RHVECTAB+8(,@08)                                0103
         LA    @01,@AL00001                                        0103
         BALR  @14,@15                                             0103
*         GO TO RHLAB4;             /* THEN PLACE LINE POINTER ON  0104
*                                      NEXT LINE                     */
         B     RHLAB4                                              0104
*       END;                                                       0105
*                                                                  0105
*     /***************************************************************/
*     /*                                                             */
*     /* INSERT COUNT. NO CHANNEL CONFIGURATION CHANGE WAS DETECTED  */
*     /* AND THE CHANNEL IS ONLINE. IF LT 1,000,000, INSERT AS       */
*     /* NNN,NNN. IF GT 1,000,000, INSERT AS NNN.NNNM.               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0106
*     IF SMF73CNT(RHCHAIDX)<1000000 THEN                           0106
@RF00101 LR    @08,RHCHAIDX                                        0106
         SLA   @08,4                                               0106
         L     @03,@PC00001                                        0106
         L     @03,RHDTAPTR(,@03)                                  0106
         LA    @15,SMF73SIZ(,@03)                                  0106
         AH    @15,SMF73SIZ(,@03)                                  0106
         LH    @03,SMF73SHC(,@15)                                  0106
         AR    @03,@15                                             0106
         LA    @01,0(@08,@03)                                      0106
         AL    @01,@CF00245                                        0106
         L     @15,SMF73CNT-4(,@01)                                0106
         CL    @15,@CF00217                                        0106
         BNL   @RF00106                                            0106
*       DO;                                                        0107
*                                                                  0107
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0108
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */
*             SMF73CNT(RHCHAIDX),   /* INPUT VALUE                   */
*             RHDATSCF,             /* INPUT SCALE                   */
*             RHWRKSTR,             /* OUTPUT STRING                 */
*             RHCOUNTL,             /* OUTPUT LENGTH                 */
*             RHNOPLCE,             /* PLACES RIGHT OF DEC PT        */
*             RHCOMMAS,             /* COMMAS FLAG                   */
*             RHNOFLOT              /* MAX PRECISION FLAG            */
*             );                                                   0108
*                                                                  0108
         MVC   @AL00001+4(24),@AL00108                             0108
         AL    @03,@CF00245                                        0108
         LA    @08,SMF73CNT-4(@08,@03)                             0108
         ST    @08,@AL00001                                        0108
         LA    @08,RHWRKSTR                                        0108
         ST    @08,@AL00001+8                                      0108
         L     @08,@PC00001+4                                      0108
         L     @15,RHVECTAB(,@08)                                  0108
         LA    @01,@AL00001                                        0108
         BALR  @14,@15                                             0108
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0109
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             RHWRKSTR,             /* TEXT                          */
*             RHCOUNTL,             /* LENGTH                        */
*             RHLINE,               /* START LINE                    */
*             COLD                  /* START COLUMN                  */
*             );                                                   0109
         LA    @08,RHWRKSTR                                        0109
         ST    @08,@AL00001                                        0109
         LA    @08,@CF00114                                        0109
         ST    @08,@AL00001+4                                      0109
         LA    @08,RHLINE                                          0109
         ST    @08,@AL00001+8                                      0109
         LA    @08,@CF00200                                        0109
         ST    @08,@AL00001+12                                     0109
         L     @08,@PC00001+4                                      0109
         L     @15,RHVECTAB+8(,@08)                                0109
         LA    @01,@AL00001                                        0109
         BALR  @14,@15                                             0109
*       END;                                                       0110
*     ELSE                                                         0111
*       DO;                                                        0111
*                                                                  0111
         B     @RC00106                                            0111
@RF00106 DS    0H                                                  0112
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0112
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */
*             SMF73CNT(RHCHAIDX),   /* INPUT VALUE                   */
*             RHMILSCF,             /* INPUT SCALE                   */
*             RHWRKSTR,             /* OUTPUT STRING                 */
*             RHCOUNTL,             /* OUTPUT LENGTH                 */
*             RHDECMIL,             /* PLACES RIGHT OF DEC PT        */
*             RHNOCOMA,             /* COMMAS FLAG                   */
*             RHNOFLOT              /* MAX PRECISION FLAG            */
*             );                                                   0112
         MVC   @AL00001+4(24),@AL00112                             0112
         LR    @08,RHCHAIDX                                        0112
         SLA   @08,4                                               0112
         L     @03,@PC00001                                        0112
         L     @03,RHDTAPTR(,@03)                                  0112
         LA    @15,SMF73SIZ(,@03)                                  0112
         AH    @15,SMF73SIZ(,@03)                                  0112
         LH    @03,SMF73SHC(,@15)                                  0112
         AR    @03,@15                                             0112
         AL    @03,@CF00245                                        0112
         LA    @08,SMF73CNT-4(@08,@03)                             0112
         ST    @08,@AL00001                                        0112
         LA    @08,RHWRKSTR                                        0112
         ST    @08,@AL00001+8                                      0112
         L     @08,@PC00001+4                                      0112
         L     @15,RHVECTAB(,@08)                                  0112
         LA    @01,@AL00001                                        0112
         BALR  @14,@15                                             0112
*         RHWRKSTR(8)='M';          /* MILLIONS                      */
*                                                                  0113
         MVI   RHWRKSTR+7,C'M'                                     0113
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0114
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             RHWRKSTR,             /* TEXT                          */
*             RHCOUNTL+1,           /* LENGTH                        */
*             RHLINE,               /* START LINE                    */
*             COLD                  /* START COLUMN                  */
*             );                                                   0114
         LA    @08,RHWRKSTR                                        0114
         ST    @08,@AL00001                                        0114
         LA    @08,@CF00044                                        0114
         ST    @08,@AL00001+4                                      0114
         LA    @08,RHLINE                                          0114
         ST    @08,@AL00001+8                                      0114
         LA    @08,@CF00200                                        0114
         ST    @08,@AL00001+12                                     0114
         L     @08,@PC00001+4                                      0114
         L     @15,RHVECTAB+8(,@08)                                0114
         LA    @01,@AL00001                                        0114
         BALR  @14,@15                                             0114
*       END;                                                       0115
*                                                                  0115
*     /***************************************************************/
*     /*                                                             */
*     /* GATHER SIO TOTAL ON CPU                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0116
*     RHSIOTOT=RHSIOTOT+SMF73CNT(RHCHAIDX);                        0116
*                                                                  0116
@RC00106 LR    @08,RHCHAIDX                                        0116
         SLA   @08,4                                               0116
         L     @03,@PC00001                                        0116
         L     @03,RHDTAPTR(,@03)                                  0116
         LA    @15,SMF73SIZ(,@03)                                  0116
         AH    @15,SMF73SIZ(,@03)                                  0116
         LH    @03,SMF73SHC(,@15)                                  0116
         AR    @03,@15                                             0116
         L     @15,RHSIOTOT                                        0116
         LA    @14,0(@08,@03)                                      0116
         AL    @14,@CF00245                                        0116
         AL    @15,SMF73CNT-4(,@14)                                0116
         ST    @15,RHSIOTOT                                        0116
*     /***************************************************************/
*     /*                                                             */
*     /* DONT PRINT CHANNEL BUSY OR CHANNEL BUSY/CPU WAIT IF THE     */
*     /* CHANNEL TYPE IS INVALID OR MULTPLEX                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0117
*     IF SMF73IID(RHCHAIDX)='1'B×SMF73TYP(RHCHAIDX)=MULTPLEX THEN  0117
         ST    @08,@TF00001                                        0117
         ALR   @08,@03                                             0117
         AL    @08,@CF00244                                        0117
         TM    SMF73IID-3(@08),B'00000100'                         0117
         BO    @RT00117                                            0117
         AL    @03,@TF00001                                        0117
         AL    @03,@CF00244                                        0117
         TM    SMF73TYP-3(@03),B'00010000'                         0117
         BNO   @RF00117                                            0117
         TM    SMF73TYP-3(@03),B'11100000'                         0117
         BZ    @RT00117                                            0117
*       GO TO RHLAB4;               /* THEN PLACE LINE POINTER ON  0118
*                                      NEXT LINE                     */
*                                                                  0118
*     /***************************************************************/
*     /*                                                             */
*     /* INSERT PERCENT CHANNEL BUSY IF DIVISOR IS NOT ZERO          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0119
*     IF SMF73SAM^=0 THEN                                          0119
@RF00117 L     @08,@PC00001                                        0119
         L     @08,RHDTAPTR(,@08)                                  0119
         L     @03,SMF73SAM(,@08)                                  0119
         LTR   @03,@03                                             0119
         BZ    @RF00119                                            0119
*       DO;                                                        0120
*                                                                  0120
*         /***********************************************************/
*         /*                                                         */
*         /* CALCULATE (SMF73BSY(RHCHAIDX)*100000)/SMF73SAM MACDATE  */
*         /* Y-2 73018                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0121
*         RESPECIFY                                                0121
*          (GPR00P,                                                0121
*           GPR01P,                                                0121
*           GPR14P,                                                0121
*           GPR15P)RESTRICTED;                                     0121
*         GPR01F=SMF73BSY(RHCHAIDX);/* LARGE VALUE TO REGISTER       */
         LR    @07,RHCHAIDX                                        0122
         SLA   @07,4                                               0122
         LA    @06,SMF73SIZ(,@08)                                  0122
         AH    @06,SMF73SIZ(,@08)                                  0122
         LH    @08,SMF73SHC(,@06)                                  0122
         AR    @08,@06                                             0122
         AL    @08,@CF00246                                        0122
         L     GPR01F,SMF73BSY-8(@07,@08)                          0122
*         GPR15F=SMF73SAM;          /* DENOMINATOR TO REGISTER       */
         LR    GPR15F,@03                                          0123
*         GENERATE REFS(C100000);                                  0124
*                                                                  0124
        M     GPR00F,C100000       MAY SPILL INTO DOUBLE WORD
        DR    GPR00F,GPR15F        RESULT FITS INTO SINGLE WORD
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0125
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */
*             EVAL(GPR01F),         /* INPUT VALUE                   */
*             RHTHOSCF,             /* INPUT SCALE                   */
*             RHWRKSTR,             /* OUTPUT STRING                 */
*             RHPCTLEN,             /* OUTPUT LENGTH                 */
*             RHPCTPLC,             /* PLACES RIGHT OF DEC PT        */
*             RHNOCOMA,             /* COMMAS FLAG                   */
*             RHNOFLOT              /* MAX PRECISION FLAG            */
*             );                                                   0125
*                                                                  0125
         MVC   @AL00001+4(24),@AL00125                             0125
         ST    GPR01F,@AFTEMPS                                     0125
         LA    @08,@AFTEMPS                                        0125
         ST    @08,@AL00001                                        0125
         LA    @08,RHWRKSTR                                        0125
         ST    @08,@AL00001+8                                      0125
         L     @08,@PC00001+4                                      0125
         L     @15,RHVECTAB(,@08)                                  0125
         LA    @01,@AL00001                                        0125
         BALR  @14,@15                                             0125
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0126
*         RESPECIFY                                                0126
*          (GPR00P,                                                0126
*           GPR01P,                                                0126
*           GPR14P,                                                0126
*           GPR15P)UNRESTRICTED;                                   0126
*       END;                                                       0127
*     ELSE                                                         0128
*       RHWRKSTR(1:5)=LNGTPTR(LHPART20)->LNGTXTD(1:LNGTPTR(LHPART20)->
*           LNGTXTL);                                              0128
*                                                                  0128
         B     @RC00119                                            0128
@RF00119 MVI   RHWRKSTR+1,C' '                                     0128
         MVC   RHWRKSTR+2(3),RHWRKSTR+1                            0128
         L     @08,@CA00100                                        0128
         L     @08,LNGTPTR-IRBMFLHV+76(,@08)                       0128
         L     @03,LNGTXTL(,@08)                                   0128
         BCTR  @03,0                                               0128
         EX    @03,@SM00247                                        0128
*     /***************************************************************/
*     /*                                                             */
*     /* MACDATE Y-2 73018                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0129
*     CALL MFISRTXT(                /* INSERT TEXT ROUTINE           */
*         RHWRKSTR,                 /* TEXT                          */
*         RHPCTLEN,                 /* LENGTH                        */
*         RHLINE,                   /* START LINE                    */
*         COLE                      /* START COLUMN                  */
*         );                                                       0129
*                                                                  0129
@RC00119 LA    @08,RHWRKSTR                                        0129
         ST    @08,@AL00001                                        0129
         LA    @08,@CF00110                                        0129
         ST    @08,@AL00001+4                                      0129
         LA    @08,RHLINE                                          0129
         ST    @08,@AL00001+8                                      0129
         LA    @08,@CF00202                                        0129
         ST    @08,@AL00001+12                                     0129
         L     @08,@PC00001+4                                      0129
         L     @15,RHVECTAB+8(,@08)                                0129
         LA    @01,@AL00001                                        0129
         BALR  @14,@15                                             0129
*     /***************************************************************/
*     /*                                                             */
*     /* INSERT PERCENT CHANNEL BUSY/CPU WAIT IF DIVISOR IS NOT ZERO */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0130
*     IF SMF73SAM^=0 THEN                                          0130
         L     @08,@PC00001                                        0130
         L     @08,RHDTAPTR(,@08)                                  0130
         L     @03,SMF73SAM(,@08)                                  0130
         LTR   @03,@03                                             0130
         BZ    @RF00130                                            0130
*       DO;                                                        0131
*                                                                  0131
*         /***********************************************************/
*         /*                                                         */
*         /* CALCULATE (SMF73OLP(RHCHAIDX)*100000)/SMF73SAM MACDATE  */
*         /* Y-2 73018                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0132
*         RESPECIFY                                                0132
*          (GPR00P,                                                0132
*           GPR01P,                                                0132
*           GPR14P,                                                0132
*           GPR15P)RESTRICTED;                                     0132
*         GPR01F=SMF73OLP(RHCHAIDX);/* LARGE VALUE TO REGISTER       */
         LR    @07,RHCHAIDX                                        0133
         SLA   @07,4                                               0133
         LA    @06,SMF73SIZ(,@08)                                  0133
         AH    @06,SMF73SIZ(,@08)                                  0133
         LH    @08,SMF73SHC(,@06)                                  0133
         AR    @08,@06                                             0133
         AL    @08,@CF00249                                        0133
         L     GPR01F,SMF73OLP-12(@07,@08)                         0133
*         GPR15F=SMF73SAM;          /* DENOMINATOR TO REGISTER       */
         LR    GPR15F,@03                                          0134
*         GENERATE REFS(C100000);                                  0135
*                                                                  0135
        M     GPR00F,C100000       MAY SPILL INTO DOUBLE WORD
        DR    GPR00F,GPR15F        RESULT FITS INTO SINGLE WORD
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0136
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */
*             EVAL(GPR01F),         /* INPUT VALUE                   */
*             RHTHOSCF,             /* INPUT SCALE                   */
*             RHWRKSTR,             /* OUTPUT STRING                 */
*             RHPCTLEN,             /* OUTPUT LENGTH                 */
*             RHPCTPLC,             /* PLACES RIGHT OF DEC PT        */
*             RHNOCOMA,             /* COMMAS FLAG                   */
*             RHNOFLOT              /* MAX PRECISION FLAG            */
*             );                                                   0136
*                                                                  0136
         MVC   @AL00001+4(24),@AL00136                             0136
         ST    GPR01F,@AFTEMPS                                     0136
         LA    @08,@AFTEMPS                                        0136
         ST    @08,@AL00001                                        0136
         LA    @08,RHWRKSTR                                        0136
         ST    @08,@AL00001+8                                      0136
         L     @08,@PC00001+4                                      0136
         L     @15,RHVECTAB(,@08)                                  0136
         LA    @01,@AL00001                                        0136
         BALR  @14,@15                                             0136
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0137
*         RESPECIFY                                                0137
*          (GPR00P,                                                0137
*           GPR01P,                                                0137
*           GPR14P,                                                0137
*           GPR15P)UNRESTRICTED;                                   0137
*       END;                                                       0138
*     ELSE                                                         0139
*       RHWRKSTR(1:5)=LNGTPTR(LHPART20)->LNGTXTD(1:LNGTPTR(LHPART20)->
*           LNGTXTL);                                              0139
*                                                                  0139
         B     @RC00130                                            0139
@RF00130 MVI   RHWRKSTR+1,C' '                                     0139
         MVC   RHWRKSTR+2(3),RHWRKSTR+1                            0139
         L     @08,@CA00100                                        0139
         L     @08,LNGTPTR-IRBMFLHV+76(,@08)                       0139
         L     @03,LNGTXTL(,@08)                                   0139
         BCTR  @03,0                                               0139
         EX    @03,@SM00247                                        0139
*     /***************************************************************/
*     /*                                                             */
*     /* MACDATE Y-2 73018                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0140
*     CALL MFISRTXT(                /* INSERT TEXT ROUTINE           */
*         RHWRKSTR,                 /* TEXT                          */
*         5,                        /* LENGTH                        */
*         RHLINE,                   /* START LINE                    */
*         COLF                      /* START COLUMN                  */
*         );                                                       0140
@RC00130 LA    @08,RHWRKSTR                                        0140
         ST    @08,@AL00001                                        0140
         LA    @08,@CF00110                                        0140
         ST    @08,@AL00001+4                                      0140
         LA    @08,RHLINE                                          0140
         ST    @08,@AL00001+8                                      0140
         LA    @08,@CF00204                                        0140
         ST    @08,@AL00001+12                                     0140
         L     @08,@PC00001+4                                      0140
         L     @15,RHVECTAB+8(,@08)                                0140
         LA    @01,@AL00001                                        0140
         BALR  @14,@15                                             0140
*RHLAB4:                                                           0141
*                                                                  0141
*     /***************************************************************/
*     /*                                                             */
*     /* POINT TO NEXT LINE                                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0141
*     RHLINE=RHLINE+1;                                             0141
RHLAB4   LA    @08,1                                               0141
         A     @08,RHLINE                                          0141
         ST    @08,RHLINE                                          0141
*   END;                            /* LOOP ON CHANNEL ENTRIES       */
         AH    RHCHAIDX,@CH00075                                   0142
@DE00016 L     @08,@PC00001                                        0142
         L     @08,RHDTAPTR(,@08)                                  0142
         LA    @08,SMF73SIZ(,@08)                                  0142
         L     @03,@PC00001                                        0142
         L     @03,RHDTAPTR(,@03)                                  0142
         AH    @08,SMF73SIZ(,@03)                                  0142
         LA    @03,1                                               0142
         AH    @03,SMF73CHA(,@08)                                  0142
         CR    RHCHAIDX,@03                                        0142
         BNH   @DL00016                                            0142
*   CALL MFWRTPAG;                  /* WRITE LAST PAGE               */
         L     @08,@PC00001+4                                      0143
         L     @15,RHVECTAB+12(,@08)                               0143
         BALR  @14,@15                                             0143
*   RETURN;                         /* RETURN TO CALLER              */
@EL00001 L     @13,4(,@13)                                         0144
@EF00001 L     @00,@SIZDATD                                        0144
         LR    @01,@09                                             0144
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0144
         BR    @14                                                 0144
*   END                                                            0145
*                                                                  0145
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */
*/*%INCLUDE SYSLIB  (IRBRGCON)                                       */
*/*%INCLUDE SYSLIB  (IRBMFLHM)                                       */
*                                                                  0145
*       ;                                                          0145
@DATA    DS    0H
@CH00226 DC    H'57'
@CH00160 DC    XL1'0'
         DC    C'0'
@SM00247 MVC   RHWRKSTR(0),LNGTXTD(@08)
         DS    0F
@AL00025 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL00108 DC    A(@CF00184)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00114)
         DC    A(@CF00184)
         DC    A(@CB00178)
         DC    A(@CB00180)
@AL00029 DC    A(@CF00189)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00087)
         DC    A(@CF00097)
         DC    A(@CB00178)
         DC    A(@CB00180)
@AL00070 DC    A(@CF00184)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00056)
         DC    A(@CF00184)
         DC    A(@CB00180)
         DC    A(@CB00180)
@AL00112 DC    A(@CF00189)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00114)
         DC    A(@CF00097)
         DC    A(@CB00180)
         DC    A(@CB00180)
@AL00125 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL00136 DC    A(@CF00195)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00110)
         DC    A(@CF00056)
         DC    A(@CB00180)
         DC    A(@CB00180)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@AL00001 DS    7A
@TF00001 DS    F
@AFTEMPS DS    1F
IRBMFRHR CSECT
         DS    0F
@CF00240 DC    F'-16'
@CF00243 DC    F'-14'
@CF00244 DC    F'-13'
@CF00245 DC    F'-12'
@CF00246 DC    F'-8'
@CF00189 DC    F'-6'
@CF00249 DC    F'-4'
@CF00195 DC    F'-3'
@CF00216 DC    F'-1'
@CF00184 DC    F'0'
@CF00075 DC    F'1'
@CH00075 EQU   @CF00075+2
@CF00056 DC    F'2'
@CF00097 DC    F'3'
@CF00049 DC    F'4'
@CF00110 DC    F'5'
@CF00112 DC    F'6'
@CF00114 DC    F'7'
@CF00044 DC    F'8'
@CF00117 DC    F'9'
@CF00119 DC    F'10'
@CF00087 DC    F'13'
@CH00087 EQU   @CF00087+2
@CF00126 DC    F'14'
@CF00135 DC    F'19'
@CF00237 DC    F'21'
@CF00235 DC    F'22'
@CF00200 DC    F'25'
@CF00202 DC    F'40'
@CF00204 DC    F'55'
@CF00085 DC    F'60'
@CF00217 DC    F'1000000'
@DATD    DSECT
         DS    0D
RHCHACNT DS    F
RHCPUNO  DS    F
RHPAGE   DS    F
RHLINE   DS    F
RHSIOTOT DS    F
RHWRKSTR DS    CL14
RHCHANO  DS    CL3
RHNEWCPU DS    BL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IRBMFRHR CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA00100 DC    A(IRBMFLHV)
         DS    0D
C100000  DC    F'100000'
@CC00161 DC    C'0123456789ABCDEF'
@CB00178 DC    B'10000000'
@CB00180 DC    B'00000000'
RHPATCH  DS    CL200
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RHCHAIDX EQU   @02
GPR01F   EQU   @01
GPR15F   EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR14P   EQU   @14
GPR15P   EQU   @15
GPR11P   EQU   @11
GPR12P   EQU   @12
GPR00F   EQU   @00
GPR14F   EQU   @14
         EXTRN IRBMFLHV
SMFRCD73 EQU   0
SMF73SIZ EQU   SMFRCD73+18
SMF73SAM EQU   SMFRCD73+36
SMF73PTR EQU   0
SMF73A   EQU   0
SMF73SHC EQU   SMF73A
SMF73CHA EQU   SMF73A+2
SMF73B   EQU   0
SMF73CID EQU   SMF73B
SMF73HID EQU   SMF73B+2
SMF73FG2 EQU   SMF73B+3
SMF73TYP EQU   SMF73FG2
SMF73IID EQU   SMF73FG2
SMF73VAC EQU   SMF73FG2
SMF73STA EQU   SMF73FG2
SMF73CNT EQU   SMF73B+4
SMF73BSY EQU   SMF73B+8
SMF73OLP EQU   SMF73B+12
LNGTXT   EQU   0
LNGTXTL  EQU   LNGTXT
LNGTXTD  EQU   LNGTXT+4
IRBMFCNV EQU   0
MFHDRISR EQU   0
MFISRTXT EQU   0
MFWRTPAG EQU   0
RHTRTAB  EQU   0
IKEBC    EQU   0
IKEBF15  EQU   0
IKEBF31  EQU   0
IKEBP15  EQU   0
IKEBP31  EQU   0
IKEBP8   EQU   0
RHDTAPTR EQU   0
RHVECTAB EQU   0
RHPMAPTR EQU   0
LNG      EQU   IRBMFLHV
LNGTPTR  EQU   LNG
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00001 EQU   SMF73FG2
SMF73RV2 EQU   SMF73A+6
SMF73SHD EQU   SMF73A+4
SMF73RLS EQU   SMFRCD73+44
SMF73RV1 EQU   SMFRCD73+42
SMF73MFV EQU   SMFRCD73+40
SMF73SUB EQU   SMFRCD73+34
SMF73CYC EQU   SMFRCD73+32
SMF73INT EQU   SMFRCD73+28
SMF73DAT EQU   SMFRCD73+24
SMF73IST EQU   SMFRCD73+20
SMF73SID EQU   SMFRCD73+14
SMF73DTE EQU   SMFRCD73+10
SMF73TME EQU   SMFRCD73+6
SMF73RTY EQU   SMFRCD73+5
SMF73FLG EQU   SMFRCD73+4
SMF73SEG EQU   SMFRCD73+2
SMF73LEN EQU   SMFRCD73
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00034 EQU   RHLAB4
@RC00096 EQU   RHLAB4
@RT00117 EQU   RHLAB4
@ENDDATA EQU   *
         END   IRBMFRHR,(C'PL/S-II',0502,74087)

         TITLE '*/* IRBMFRDR - DEVICE REPORT GENERATOR                 *
                       '
IRBMFRDR CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IRBMFRDR  74.087'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@10                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @09,@01                                             0001
         USING @DATD,@09                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @09,8(,@13)                                         0001
         LR    @13,@09                                             0001
         MVC   @PC00001(12),0(@01)                                 0001
*                                                                  0014
*/* BEGIN MAINLINE PROCESSING                                        */
*                                                                  0014
*   /*****************************************************************/
*   /*                                                               */
*   /* BEGIN REPORT GENERATOR PROCESSING. CREATE ONE REPORT FOR EACH */
*   /* ACTIVE DEVICE CLASS.                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0014
*   DO RDCLSIDX=1 TO DIM(DDDVADD);                                 0014
         LA    @08,1                                               0014
         STH   @08,RDCLSIDX                                        0014
@DL00014 DS    0H                                                  0015
*     IF DDDVADD(RDCLSIDX)^=0 THEN  /* IF DATA EXISTS FOR THIS CLASS */
         SR    @15,@15                                             0015
         SLA   @08,2                                               0015
         L     @14,@PC00001                                        0015
         L     @01,RDDTAPTR(,@14)                                  0015
         AL    @01,@CF00249                                        0015
         C     @15,DDDVADD(@08,@01)                                0015
         BE    @RF00015                                            0015
*       DO;                                                        0016
*                                                                  0016
*         /***********************************************************/
*         /*                                                         */
*         /* INITIALIZE FOR THIS CLASS                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0017
*         RDPAGE=1;                 /* FIRST PAGE                    */
         LA    @08,1                                               0017
         ST    @08,RDPAGE                                          0017
*         RDLINE=RGMAXLN;           /* LINE VARIABLE SET TO CAUSE  0018
*                                      HEADER TO BE INSERTED         */
         MVC   RDLINE(4),@CF00095                                  0018
*         RDSIOTOT=0;               /* TOTAL SIO COUNT               */
*                                                                  0019
         ST    @15,RDSIOTOT                                        0019
*         /***********************************************************/
*         /*                                                         */
*         /* FORMAT DATA FOR EACH DEVICE ENTRY IN THIS CLASS         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0020
*         DO RDDEVIDX=1 TO SMF74DEV;                               0020
*                                                                  0020
         B     @DE00020                                            0020
@DL00020 DS    0H                                                  0021
*           /*********************************************************/
*           /*                                                       */
*           /* PLACE ENTRIES IN GROUPS OF FOUR                       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0021
*           IF RDDEVIDX//4=1 THEN                                  0021
         LA    @15,1                                               0021
         LR    @00,@08                                             0021
         SRDA  @00,32                                              0021
         D     @00,@CF00058                                        0021
         CR    @00,@15                                             0021
         BNE   @RF00021                                            0021
*             RDLINE=RDLINE+1;      /* INCREMENT LINE INDEX          */
*                                                                  0022
         A     @15,RDLINE                                          0022
         ST    @15,RDLINE                                          0022
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO MORE ROOM ON THIS PAGE, GET NEW PAGE            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0023
*           IF RDLINE>=(RGMAXLN-3)THEN                             0023
@RF00021 L     @08,RDLINE                                          0023
         CH    @08,@CH00232                                        0023
         BL    @RF00023                                            0023
*             DO;                                                  0024
*               IF RDDEVIDX>1 THEN  /* IF THIS IS NOT FIRST ENTRY    */
         LH    @08,RDDEVIDX                                        0025
         CH    @08,@CH00081                                        0025
         BNH   @RF00025                                            0025
*                 CALL MFWRTPAG;    /* WRITE OUT PAGE AND CLEAR    0026
*                                      INTERNAL PAGE IMAGE           */
*                                                                  0026
         L     @08,@PC00001+4                                      0026
         L     @15,RDVECTAB+12(,@08)                               0026
         BALR  @14,@15                                             0026
*               /*****************************************************/
*               /*                                                   */
*               /* BUILD NEW HEADER. START WITH STANDARD HEADER      */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0027
*               CALL MFHDRISR(                                     0027
*                                                                  0027
*               /*****************************************************/
*               /*                                                   */
*               /* POINTER TO SMF RECORD                             */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0027
*                   DDDVADD(RDCLSIDX),                             0027
*                                                                  0027
*               /*****************************************************/
*               /*                                                   */
*               /* TITLE                                             */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0027
*                   LNGTPTR(RDTPART(RDCLSIDX))->LNGTXTD,           0027
*                                                                  0027
*               /*****************************************************/
*               /*                                                   */
*               /* TITLE LENGTH                                      */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0027
*                   LNGTPTR(RDTPART(RDCLSIDX))->LNGTXTL,RDPAGE/* PAGE
*                                      NUMBER                        */
*                   );                                             0027
@RF00025 LH    @08,RDCLSIDX                                        0027
         LR    @15,@08                                             0027
         SLA   @15,2                                               0027
         L     @14,@PC00001                                        0027
         L     @01,RDDTAPTR(,@14)                                  0027
         AL    @01,@CF00249                                        0027
         LA    @15,DDDVADD(@15,@01)                                0027
         ST    @15,@AL00001                                        0027
         AR    @08,@08                                             0027
         LH    @08,RDTPART-2(@08)                                  0027
         SLA   @08,2                                               0027
         L     @15,@CA00125                                        0027
         AL    @15,@CF00249                                        0027
         L     @08,LNGTPTR-IRBMFLDV(@08,@15)                       0027
         LA    @15,LNGTXTD(,@08)                                   0027
         ST    @15,@AL00001+4                                      0027
         ST    @08,@AL00001+8                                      0027
         LA    @08,RDPAGE                                          0027
         ST    @08,@AL00001+12                                     0027
         L     @08,@PC00001+4                                      0027
         L     @15,RDVECTAB+4(,@08)                                0027
         LA    @01,@AL00001                                        0027
         BALR  @14,@15                                             0027
*               RDPAGE=RDPAGE+1;    /* NEXT PAGE NUMBER              */
*                                                                  0028
         LA    @08,1                                               0028
         A     @08,RDPAGE                                          0028
         ST    @08,RDPAGE                                          0028
*               /*****************************************************/
*               /*                                                   */
*               /* BUILD SPECIAL DEVICE HEADER. INSERT 'DEVICE'      */
*               /* MACDATE Y-2 73018                                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0029
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   LNGTPTR(LDPART7)->LNGTXTD,/* TEXT                */
*                   LNGTPTR(LDPART7)->LNGTXTL,/* LENGTH              */
*                   LINE8,          /* START LINE                    */
*                   COLA            /* START COLUMN                  */
*                   );                                             0029
*                                                                  0029
         L     @08,@CA00125                                        0029
         L     @08,LNGTPTR-IRBMFLDV+24(,@08)                       0029
         LA    @15,LNGTXTD(,@08)                                   0029
         ST    @15,@AL00001                                        0029
         ST    @08,@AL00001+4                                      0029
         LA    @08,@CF00054                                        0029
         ST    @08,@AL00001+8                                      0029
         LA    @08,@CF00081                                        0029
         ST    @08,@AL00001+12                                     0029
         L     @08,@PC00001+4                                      0029
         L     @15,RDVECTAB+8(,@08)                                0029
         LA    @01,@AL00001                                        0029
         BALR  @14,@15                                             0029
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT 'ADDRESS' MACDATE Y-2 73018                */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0030
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   LNGTPTR(LDPART8)->LNGTXTD,/* TEXT                */
*                   LNGTPTR(LDPART8)->LNGTXTL,/* LENGTH              */
*                   LINE9,          /* START LINE                    */
*                   COLA            /* START COLUMN                  */
*                   );                                             0030
*                                                                  0030
         L     @08,@CA00125                                        0030
         L     @08,LNGTPTR-IRBMFLDV+28(,@08)                       0030
         LA    @15,LNGTXTD(,@08)                                   0030
         ST    @15,@AL00001                                        0030
         ST    @08,@AL00001+4                                      0030
         LA    @08,@CF00141                                        0030
         ST    @08,@AL00001+8                                      0030
         LA    @08,@CF00081                                        0030
         ST    @08,@AL00001+12                                     0030
         L     @08,@PC00001+4                                      0030
         L     @15,RDVECTAB+8(,@08)                                0030
         LA    @01,@AL00001                                        0030
         BALR  @14,@15                                             0030
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT 'VOLUME SERIAL' IF THIS IS THE TAPE OR DASD*/
*               /* REPORT                                            */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0031
*               IF SMF74SUB(2)=TAPE×SMF74SUB(2)=DASD THEN          0031
         LH    @08,RDCLSIDX                                        0031
         SLA   @08,2                                               0031
         L     @15,@PC00001                                        0031
         L     @01,RDDTAPTR(,@15)                                  0031
         AL    @01,@CF00249                                        0031
         L     @08,DDDVADD(@08,@01)                                0031
         CLI   SMF74SUB+1(@08),X'80'                               0031
         BE    @RT00031                                            0031
         CLI   SMF74SUB+1(@08),X'20'                               0031
         BNE   @RF00031                                            0031
@RT00031 DS    0H                                                  0032
*                 DO;                                              0032
*                                                                  0032
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0033
*                   CALL MFISRTXT(  /* INSERT TEXT ROUTINE           */
*                       LNGTPTR(LDPART20)->LNGTXTD,/* TEXT           */
*                       LNGTPTR(LDPART20)->LNGTXTL,/* LENGTH         */
*                       LINE8,      /* START LINE                    */
*                       COLA5       /* START COLUMN                  */
*                       );                                         0033
*                                                                  0033
         L     @08,@CA00125                                        0033
         L     @08,LNGTPTR-IRBMFLDV+76(,@08)                       0033
         LA    @15,LNGTXTD(,@08)                                   0033
         ST    @15,@AL00001                                        0033
         ST    @08,@AL00001+4                                      0033
         LA    @08,@CF00054                                        0033
         ST    @08,@AL00001+8                                      0033
         LA    @08,@CF00051                                        0033
         ST    @08,@AL00001+12                                     0033
         L     @08,@PC00001+4                                      0033
         L     @15,RDVECTAB+8(,@08)                                0033
         LA    @01,@AL00001                                        0033
         BALR  @14,@15                                             0033
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0034
*                   CALL MFISRTXT(  /* INSERT TEXT ROUTINE           */
*                       LNGTPTR(LDPART21)->LNGTXTD,/* TEXT           */
*                       LNGTPTR(LDPART21)->LNGTXTL,/* LENGTH         */
*                       LINE9,      /* START LINE                    */
*                       COLA5       /* START COLUMN                  */
*                       );                                         0034
         L     @08,@CA00125                                        0034
         L     @08,LNGTPTR-IRBMFLDV+80(,@08)                       0034
         LA    @15,LNGTXTD(,@08)                                   0034
         ST    @15,@AL00001                                        0034
         ST    @08,@AL00001+4                                      0034
         LA    @08,@CF00141                                        0034
         ST    @08,@AL00001+8                                      0034
         LA    @08,@CF00051                                        0034
         ST    @08,@AL00001+12                                     0034
         L     @08,@PC00001+4                                      0034
         L     @15,RDVECTAB+8(,@08)                                0034
         LA    @01,@AL00001                                        0034
         BALR  @14,@15                                             0034
*                 END;                                             0035
*                                                                  0035
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT 'DEVICE' MACDATE Y-2 73018                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0036
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   LNGTPTR(LDPART7)->LNGTXTD,/* TEXT                */
*                   LNGTPTR(LDPART7)->LNGTXTL,/* LENGTH              */
*                   LINE7,          /* START LINE                    */
*                   COLB            /* START COLUMN                  */
*                   );                                             0036
*                                                                  0036
@RF00031 L     @08,@CA00125                                        0036
         L     @08,LNGTPTR-IRBMFLDV+24(,@08)                       0036
         LA    @15,LNGTXTD(,@08)                                   0036
         ST    @15,@AL00001                                        0036
         ST    @08,@AL00001+4                                      0036
         LA    @08,@CF00138                                        0036
         ST    @08,@AL00001+8                                      0036
         LA    @08,@CF00211                                        0036
         ST    @08,@AL00001+12                                     0036
         L     @08,@PC00001+4                                      0036
         L     @15,RDVECTAB+8(,@08)                                0036
         LA    @01,@AL00001                                        0036
         BALR  @14,@15                                             0036
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT 'ACTIVITY' MACDATE Y-2 73018               */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0037
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   LNGTPTR(LDPART9)->LNGTXTD,/* TEXT                */
*                   LNGTPTR(LDPART9)->LNGTXTL,/* LENGTH              */
*                   LINE8,          /* START LINE                    */
*                   COLB            /* START COLUMN                  */
*                   );                                             0037
*                                                                  0037
         L     @08,@CA00125                                        0037
         L     @08,LNGTPTR-IRBMFLDV+32(,@08)                       0037
         LA    @15,LNGTXTD(,@08)                                   0037
         ST    @15,@AL00001                                        0037
         ST    @08,@AL00001+4                                      0037
         LA    @08,@CF00054                                        0037
         ST    @08,@AL00001+8                                      0037
         LA    @08,@CF00211                                        0037
         ST    @08,@AL00001+12                                     0037
         L     @08,@PC00001+4                                      0037
         L     @15,RDVECTAB+8(,@08)                                0037
         LA    @01,@AL00001                                        0037
         BALR  @14,@15                                             0037
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT 'COUNT' MACDATE Y-2 73018                  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0038
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   LNGTPTR(LDPART10)->LNGTXTD,/* TEXT               */
*                   LNGTPTR(LDPART10)->LNGTXTL,/* LENGTH             */
*                   LINE9,          /* START LINE                    */
*                   COLB            /* START COLUMN                  */
*                   );                                             0038
*                                                                  0038
         L     @08,@CA00125                                        0038
         L     @08,LNGTPTR-IRBMFLDV+36(,@08)                       0038
         LA    @15,LNGTXTD(,@08)                                   0038
         ST    @15,@AL00001                                        0038
         ST    @08,@AL00001+4                                      0038
         LA    @08,@CF00141                                        0038
         ST    @08,@AL00001+8                                      0038
         LA    @08,@CF00211                                        0038
         ST    @08,@AL00001+12                                     0038
         L     @08,@PC00001+4                                      0038
         L     @15,RDVECTAB+8(,@08)                                0038
         LA    @01,@AL00001                                        0038
         BALR  @14,@15                                             0038
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT 'PERCENT' MACDATE Y-2 73018                */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0039
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   LNGTPTR(LDPART11)->LNGTXTD,/* TEXT               */
*                   LNGTPTR(LDPART11)->LNGTXTL,/* LENGTH             */
*                   LINE8,          /* START LINE                    */
*                   COLC            /* START COLUMN                  */
*                   );                                             0039
*                                                                  0039
         L     @08,@CA00125                                        0039
         L     @08,LNGTPTR-IRBMFLDV+40(,@08)                       0039
         LA    @15,LNGTXTD(,@08)                                   0039
         ST    @15,@AL00001                                        0039
         ST    @08,@AL00001+4                                      0039
         LA    @08,@CF00054                                        0039
         ST    @08,@AL00001+8                                      0039
         LA    @08,@CF00213                                        0039
         ST    @08,@AL00001+12                                     0039
         L     @08,@PC00001+4                                      0039
         L     @15,RDVECTAB+8(,@08)                                0039
         LA    @01,@AL00001                                        0039
         BALR  @14,@15                                             0039
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT 'BUSY' MACDATE Y-2 73018                   */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0040
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   LNGTPTR(LDPART12)->LNGTXTD,/* TEXT               */
*                   LNGTPTR(LDPART12)->LNGTXTL,/* LENGTH             */
*                   LINE9,          /* START LINE                    */
*                   COLC            /* START COLUMN                  */
*                   );                                             0040
*                                                                  0040
         L     @08,@CA00125                                        0040
         L     @08,LNGTPTR-IRBMFLDV+44(,@08)                       0040
         LA    @15,LNGTXTD(,@08)                                   0040
         ST    @15,@AL00001                                        0040
         ST    @08,@AL00001+4                                      0040
         LA    @08,@CF00141                                        0040
         ST    @08,@AL00001+8                                      0040
         LA    @08,@CF00213                                        0040
         ST    @08,@AL00001+12                                     0040
         L     @08,@PC00001+4                                      0040
         L     @15,RDVECTAB+8(,@08)                                0040
         LA    @01,@AL00001                                        0040
         BALR  @14,@15                                             0040
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT 'MEAN' MACDATE Y-2 73018                   */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0041
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   LNGTPTR(LDPART13)->LNGTXTD,/* TEXT               */
*                   LNGTPTR(LDPART13)->LNGTXTL,/* LENGTH             */
*                   LINE8,          /* START LINE                    */
*                   COLD            /* START COLUMN                  */
*                   );                                             0041
*                                                                  0041
         L     @08,@CA00125                                        0041
         L     @08,LNGTPTR-IRBMFLDV+48(,@08)                       0041
         LA    @15,LNGTXTD(,@08)                                   0041
         ST    @15,@AL00001                                        0041
         ST    @08,@AL00001+4                                      0041
         LA    @08,@CF00054                                        0041
         ST    @08,@AL00001+8                                      0041
         LA    @08,@CF00095                                        0041
         ST    @08,@AL00001+12                                     0041
         L     @08,@PC00001+4                                      0041
         L     @15,RDVECTAB+8(,@08)                                0041
         LA    @01,@AL00001                                        0041
         BALR  @14,@15                                             0041
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT 'QLENGTH' MACDATE Y-2 73018                */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0042
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   LNGTPTR(LDPART14)->LNGTXTD,/* TEXT               */
*                   LNGTPTR(LDPART14)->LNGTXTL,/* LENGTH             */
*                   LINE9,          /* START LINE                    */
*                   COLD            /* START COLUMN                  */
*                   );                                             0042
         L     @08,@CA00125                                        0042
         L     @08,LNGTPTR-IRBMFLDV+52(,@08)                       0042
         LA    @15,LNGTXTD(,@08)                                   0042
         ST    @15,@AL00001                                        0042
         ST    @08,@AL00001+4                                      0042
         LA    @08,@CF00141                                        0042
         ST    @08,@AL00001+8                                      0042
         LA    @08,@CF00095                                        0042
         ST    @08,@AL00001+12                                     0042
         L     @08,@PC00001+4                                      0042
         L     @15,RDVECTAB+8(,@08)                                0042
         LA    @01,@AL00001                                        0042
         BALR  @14,@15                                             0042
*               RDLINE=LINE13;      /* INITIALIZE LINE NUMBER FOR  0043
*                                      NEXT ENTRY                    */
         MVC   RDLINE(4),@CF00097                                  0043
*             END;                                                 0044
*                                                                  0044
*           /*********************************************************/
*           /*                                                       */
*           /* FORMAT AND INSERT ENTRY FOR THIS DEVICE. FIRST,       */
*           /* CONVERT AND INSERT UCB EXTERNAL DEVICE ADDRESS. FORM  */
*           /* HHHF TO HHHF40                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0045
*           RDPACKAD=SMF74ADD(RDDEVIDX);                           0045
*                                                                  0045
@RF00023 MVI   RDPACKAD+2,C' '                                     0045
         LH    @08,RDDEVIDX                                        0045
         MH    @08,@CH00234                                        0045
         LH    @15,RDCLSIDX                                        0045
         SLA   @15,2                                               0045
         L     @14,@PC00001                                        0045
         L     @01,RDDTAPTR(,@14)                                  0045
         AL    @01,@CF00249                                        0045
         L     @15,DDDVADD(@15,@01)                                0045
         LA    @14,SMF74SIZ(,@15)                                  0045
         AH    @14,SMF74SIZ(,@15)                                  0045
         LH    @15,SMF74SDC(,@14)                                  0045
         AR    @15,@14                                             0045
         ALR   @15,@08                                             0045
         AL    @15,@CF00250                                        0045
         MVC   RDPACKAD(2),SMF74ADD(@15)                           0045
*           /*********************************************************/
*           /*                                                       */
*           /* FORM FHFHFHFF04                                       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0046
*           UNPK(RDWRKSTR(1:5),RDPACKAD);                          0046
*                                                                  0046
         UNPK  RDWRKSTR(5),RDPACKAD(3)                             0046
*           /*********************************************************/
*           /*                                                       */
*           /* FORM (IN EBCDIC) HHH                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0047
*           TR(RDWRKSTR(1:3),RDTRTAB);                             0047
*                                                                  0047
         LA    @08,RDDTRTAB                                        0047
         SH    @08,@CH00171                                        0047
         TR    RDWRKSTR(3),RDTRTAB(@08)                            0047
*           /*********************************************************/
*           /*                                                       */
*           /* MACDATE Y-2 73018                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0048
*           CALL MFISRTXT(          /* INSERT TEXT ROUTINE           */
*               RDWRKSTR,           /* TEXT                          */
*               3,                  /* LENGTH                        */
*               RDLINE,             /* START LINE                    */
*               COLA                /* START COLUMN                  */
*               );                                                 0048
*                                                                  0048
         LA    @08,RDWRKSTR                                        0048
         ST    @08,@AL00001                                        0048
         LA    @08,@CF00107                                        0048
         ST    @08,@AL00001+4                                      0048
         LA    @08,RDLINE                                          0048
         ST    @08,@AL00001+8                                      0048
         LA    @08,@CF00081                                        0048
         ST    @08,@AL00001+12                                     0048
         L     @08,@PC00001+4                                      0048
         L     @15,RDVECTAB+8(,@08)                                0048
         LA    @01,@AL00001                                        0048
         BALR  @14,@15                                             0048
*           /*********************************************************/
*           /*                                                       */
*           /* INSERT VOLUME SERIAL NUMBER IF THIS IS THE DASD OR    */
*           /* TAPE REPORT                                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0049
*           IF SMF74SUB(2)=TAPE×SMF74SUB(2)=DASD THEN              0049
*                                                                  0049
         LH    @08,RDCLSIDX                                        0049
         SLA   @08,2                                               0049
         L     @15,@PC00001                                        0049
         L     @01,RDDTAPTR(,@15)                                  0049
         AL    @01,@CF00249                                        0049
         L     @08,DDDVADD(@08,@01)                                0049
         CLI   SMF74SUB+1(@08),X'80'                               0049
         BE    @RT00049                                            0049
         CLI   SMF74SUB+1(@08),X'20'                               0049
         BNE   @RF00049                                            0049
@RT00049 DS    0H                                                  0050
*             /*******************************************************/
*             /*                                                     */
*             /* MACDATE Y-2 73018                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0050
*             CALL MFISRTXT(        /* INSERT TEXT ROUTINE           */
*                 SMF74SER(RDDEVIDX),/* TEXT                         */
*                 LENGTH(SMF74SER(RDDEVIDX)),/* LENGTH               */
*                 RDLINE,           /* START LINE                    */
*                 COLA5             /* START COLUMN                  */
*                 );                                               0050
*                                                                  0050
         LH    @08,RDDEVIDX                                        0050
         MH    @08,@CH00234                                        0050
         LH    @15,RDCLSIDX                                        0050
         SLA   @15,2                                               0050
         L     @14,@PC00001                                        0050
         L     @01,RDDTAPTR(,@14)                                  0050
         AL    @01,@CF00249                                        0050
         L     @15,DDDVADD(@15,@01)                                0050
         LA    @14,SMF74SIZ(,@15)                                  0050
         AH    @14,SMF74SIZ(,@15)                                  0050
         LH    @15,SMF74SDC(,@14)                                  0050
         AR    @15,@14                                             0050
         AL    @15,@CF00251                                        0050
         LA    @08,SMF74SER-8(@08,@15)                             0050
         ST    @08,@AL00001                                        0050
         LA    @08,@CF00047                                        0050
         ST    @08,@AL00001+4                                      0050
         LA    @08,RDLINE                                          0050
         ST    @08,@AL00001+8                                      0050
         LA    @08,@CF00051                                        0050
         ST    @08,@AL00001+12                                     0050
         L     @08,@PC00001+4                                      0050
         L     @15,RDVECTAB+8(,@08)                                0050
         LA    @01,@AL00001                                        0050
         BALR  @14,@15                                             0050
*           /*********************************************************/
*           /*                                                       */
*           /* IF CONFIGURATION CHANGE HAS OCCURRED OR IF DEVICE IS  */
*           /* OFFLINE, INSERT PROPER MESSAGE AND NO DATA.           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0051
*           IF SMF74VAC(RDDEVIDX)='1'B×SMF74STA(RDDEVIDX)='0'B THEN
@RF00049 LH    @08,RDDEVIDX                                        0051
         MH    @08,@CH00234                                        0051
         LH    @15,RDCLSIDX                                        0051
         SLA   @15,2                                               0051
         L     @14,@PC00001                                        0051
         L     @01,RDDTAPTR(,@14)                                  0051
         AL    @01,@CF00249                                        0051
         L     @15,DDDVADD(@15,@01)                                0051
         LA    @14,SMF74SIZ(,@15)                                  0051
         AH    @14,SMF74SIZ(,@15)                                  0051
         LH    @15,SMF74SDC(,@14)                                  0051
         AR    @15,@14                                             0051
         ALR   @15,@08                                             0051
         AL    @15,@CF00252                                        0051
         TM    SMF74VAC-3(@15),B'00000010'                         0051
         BNZ   @RT00051                                            0051
         TM    SMF74STA-3(@15),B'00000001'                         0051
         BO    @RF00051                                            0051
@RT00051 DS    0H                                                  0052
*             DO;                                                  0052
*               IF SMF74VAC(RDDEVIDX)='1'B THEN                    0053
         LH    @08,RDDEVIDX                                        0053
         MH    @08,@CH00234                                        0053
         LH    @15,RDCLSIDX                                        0053
         SLA   @15,2                                               0053
         L     @14,@PC00001                                        0053
         L     @01,RDDTAPTR(,@14)                                  0053
         AL    @01,@CF00249                                        0053
         L     @15,DDDVADD(@15,@01)                                0053
         LA    @14,SMF74SIZ(,@15)                                  0053
         AH    @14,SMF74SIZ(,@15)                                  0053
         LH    @15,SMF74SDC(,@14)                                  0053
         AR    @15,@14                                             0053
         ST    @08,@TF00001                                        0053
         ALR   @08,@15                                             0053
         AL    @08,@CF00252                                        0053
         TM    SMF74VAC-3(@08),B'00000010'                         0053
         BNO   @RF00053                                            0053
*                 DO;               /* CONFIGURATION CHANGE HAS BEEN
*                                      DETECTED                      */
*                   IF SMF74STA(RDDEVIDX)='1'B THEN                0055
*                                                                  0055
         AL    @15,@TF00001                                        0055
         AL    @15,@CF00252                                        0055
         TM    SMF74STA-3(@15),B'00000001'                         0055
         BNO   @RF00055                                            0055
*                     /***********************************************/
*                     /*                                             */
*                     /* INSERT 'NOW ONLINE' MACDATE Y-2 73018       */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0056
*                     CALL MFISRTXT(/* INSERT TEXT ROUTINE           */
*                         LNGTPTR(LDPART15)->LNGTXTD,/* TEXT         */
*                         LNGTPTR(LDPART15)->LNGTXTL,/* LENGTH       */
*                         RDLINE,   /* START LINE                    */
*                         COLB-3    /* START COLUMN                  */
*                         );                                       0056
         L     @08,@CA00125                                        0056
         L     @08,LNGTPTR-IRBMFLDV+56(,@08)                       0056
         LA    @15,LNGTXTD(,@08)                                   0056
         ST    @15,@AL00001                                        0056
         ST    @08,@AL00001+4                                      0056
         LA    @08,RDLINE                                          0056
         ST    @08,@AL00001+8                                      0056
         LA    @08,@CF00243                                        0056
         ST    @08,@AL00001+12                                     0056
         L     @08,@PC00001+4                                      0056
         L     @15,RDVECTAB+8(,@08)                                0056
         LA    @01,@AL00001                                        0056
         BALR  @14,@15                                             0056
*                   ELSE                                           0057
*                                                                  0057
*                     /***********************************************/
*                     /*                                             */
*                     /* INSERT 'NOW OFFLINE' MACDATE Y-2 73018      */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0057
*                     CALL MFISRTXT(/* INSERT TEXT ROUTINE           */
*                         LNGTPTR(LDPART16)->LNGTXTD,/* TEXT         */
*                         LNGTPTR(LDPART16)->LNGTXTL,/* LENGTH       */
*                         RDLINE,   /* START LINE                    */
*                         COLB-4    /* START COLUMN                  */
*                         );                                       0057
         B     @RC00055                                            0057
@RF00055 L     @08,@CA00125                                        0057
         L     @08,LNGTPTR-IRBMFLDV+60(,@08)                       0057
         LA    @15,LNGTXTD(,@08)                                   0057
         ST    @15,@AL00001                                        0057
         ST    @08,@AL00001+4                                      0057
         LA    @08,RDLINE                                          0057
         ST    @08,@AL00001+8                                      0057
         LA    @08,@CF00244                                        0057
         ST    @08,@AL00001+12                                     0057
         L     @08,@PC00001+4                                      0057
         L     @15,RDVECTAB+8(,@08)                                0057
         LA    @01,@AL00001                                        0057
         BALR  @14,@15                                             0057
*                 END;                                             0058
*               ELSE                                               0059
*                                                                  0059
*                 /***************************************************/
*                 /*                                                 */
*                 /* NO CONFIGURATION CHANGE HAS BEEN DETECTED.      */
*                 /* INSERT 'OFFLINE' MACDATE Y-2 73018              */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0059
*                 CALL MFISRTXT(    /* INSERT TEXT ROUTINE           */
*                     LNGTPTR(LDPART17)->LNGTXTD,/* TEXT             */
*                     LNGTPTR(LDPART17)->LNGTXTL,/* LENGTH           */
*                     RDLINE,       /* START LINE                    */
*                     COLB          /* START COLUMN                  */
*                     );                                           0059
         B     @RC00053                                            0059
@RF00053 L     @08,@CA00125                                        0059
         L     @08,LNGTPTR-IRBMFLDV+64(,@08)                       0059
         LA    @15,LNGTXTD(,@08)                                   0059
         ST    @15,@AL00001                                        0059
         ST    @08,@AL00001+4                                      0059
         LA    @08,RDLINE                                          0059
         ST    @08,@AL00001+8                                      0059
         LA    @08,@CF00211                                        0059
         ST    @08,@AL00001+12                                     0059
         L     @08,@PC00001+4                                      0059
         L     @15,RDVECTAB+8(,@08)                                0059
         LA    @01,@AL00001                                        0059
         BALR  @14,@15                                             0059
*             END;                                                 0060
*           ELSE                                                   0061
*                                                                  0061
*             /*******************************************************/
*             /*                                                     */
*             /* DEVICE IS ONLINE AND NO CONFIGURATION CHANGE WAS    */
*             /* DETECTED. INSERT DATA                               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0061
*             DO;                                                  0061
*                                                                  0061
         B     @RC00051                                            0061
@RF00051 DS    0H                                                  0062
*               /*****************************************************/
*               /*                                                   */
*               /* INCREMENT TOTAL SIO COUNT                         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0062
*               RDSIOTOT=RDSIOTOT+SMF74CNT(RDDEVIDX);              0062
*                                                                  0062
         LH    @08,RDDEVIDX                                        0062
         MH    @08,@CH00234                                        0062
         LH    @15,RDCLSIDX                                        0062
         SLA   @15,2                                               0062
         L     @14,@PC00001                                        0062
         L     @01,RDDTAPTR(,@14)                                  0062
         AL    @01,@CF00249                                        0062
         L     @15,DDDVADD(@15,@01)                                0062
         LA    @14,SMF74SIZ(,@15)                                  0062
         AH    @14,SMF74SIZ(,@15)                                  0062
         LH    @15,SMF74SDC(,@14)                                  0062
         AR    @15,@14                                             0062
         LA    @01,0(@08,@15)                                      0062
         AL    @01,@CF00253                                        0062
         L     @14,SMF74CNT-16(,@01)                               0062
         L     @07,RDSIOTOT                                        0062
         ALR   @07,@14                                             0062
         ST    @07,RDSIOTOT                                        0062
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT DEVICE ACTIVITY COUNT. IF LT 1,000,000,    */
*               /* INSERT AS NN,NNN. IF GE 1,000,000, INSERT AS      */
*               /* NNN.NNNM                                          */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0063
*               IF SMF74CNT(RDDEVIDX)<1000000 THEN                 0063
         CL    @14,@CF00229                                        0063
         BNL   @RF00063                                            0063
*                 DO;                                              0064
*                                                                  0064
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0065
*                   CALL IRBMFCNV(  /* CONVERSION ROUTINE            */
*                       SMF74CNT(RDDEVIDX),/* INPUT VALUE            */
*                       RDDATSCF,   /* INPUT SCALE                   */
*                       RDWRKSTR,   /* OUTPUT STRING                 */
*                       RDCOUNTL,   /* OUTPUT LENGTH                 */
*                       RDNOPLCE,   /* PLACES RIGHT OF DEC PT        */
*                       RDCOMMAS,   /* COMMAS FLAG                   */
*                       RDNOFLOT    /* MAX PRECISION FLAG            */
*                       );                                         0065
*                                                                  0065
         MVC   @AL00001+4(24),@AL00065                             0065
         AL    @15,@CF00253                                        0065
         LA    @08,SMF74CNT-16(@08,@15)                            0065
         ST    @08,@AL00001                                        0065
         LA    @08,RDWRKSTR                                        0065
         ST    @08,@AL00001+8                                      0065
         L     @08,@PC00001+4                                      0065
         L     @15,RDVECTAB(,@08)                                  0065
         LA    @01,@AL00001                                        0065
         BALR  @14,@15                                             0065
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0066
*                   CALL MFISRTXT(  /* INSERT TEXT ROUTINE           */
*                       RDWRKSTR,   /* TEXT                          */
*                       RDCOUNTL,   /* LENGTH                        */
*                       RDLINE,     /* START LINE                    */
*                       COLB        /* START COLUMN                  */
*                       );                                         0066
         LA    @08,RDWRKSTR                                        0066
         ST    @08,@AL00001                                        0066
         LA    @08,@CF00138                                        0066
         ST    @08,@AL00001+4                                      0066
         LA    @08,RDLINE                                          0066
         ST    @08,@AL00001+8                                      0066
         LA    @08,@CF00211                                        0066
         ST    @08,@AL00001+12                                     0066
         L     @08,@PC00001+4                                      0066
         L     @15,RDVECTAB+8(,@08)                                0066
         LA    @01,@AL00001                                        0066
         BALR  @14,@15                                             0066
*                 END;                                             0067
*               ELSE                                               0068
*                 DO;                                              0068
*                                                                  0068
         B     @RC00063                                            0068
@RF00063 DS    0H                                                  0069
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0069
*                   CALL IRBMFCNV(  /* CONVERSION ROUTINE            */
*                       SMF74CNT(RDDEVIDX),/* INPUT VALUE            */
*                       RDMILSCF,   /* INPUT SCALE                   */
*                       RDWRKSTR,   /* OUTPUT STRING                 */
*                       RDCOUNTL,   /* OUTPUT LENGTH                 */
*                       RDDECMIL,   /* PLACES RIGHT OF DEC PT        */
*                       RDNOCOMA,   /* COMMAS FLAG                   */
*                       RDNOFLOT    /* MAX PRECISION FLAG            */
*                       );                                         0069
         MVC   @AL00001+4(24),@AL00069                             0069
         LH    @08,RDDEVIDX                                        0069
         MH    @08,@CH00234                                        0069
         LH    @15,RDCLSIDX                                        0069
         SLA   @15,2                                               0069
         L     @14,@PC00001                                        0069
         L     @01,RDDTAPTR(,@14)                                  0069
         AL    @01,@CF00249                                        0069
         L     @15,DDDVADD(@15,@01)                                0069
         LA    @14,SMF74SIZ(,@15)                                  0069
         AH    @14,SMF74SIZ(,@15)                                  0069
         LH    @15,SMF74SDC(,@14)                                  0069
         AR    @15,@14                                             0069
         AL    @15,@CF00253                                        0069
         LA    @08,SMF74CNT-16(@08,@15)                            0069
         ST    @08,@AL00001                                        0069
         LA    @08,RDWRKSTR                                        0069
         ST    @08,@AL00001+8                                      0069
         L     @08,@PC00001+4                                      0069
         L     @15,RDVECTAB(,@08)                                  0069
         LA    @01,@AL00001                                        0069
         BALR  @14,@15                                             0069
*                   RDWRKSTR(8)='M';/* MILLIONS                      */
*                                                                  0070
         MVI   RDWRKSTR+7,C'M'                                     0070
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0071
*                   CALL MFISRTXT(  /* INSERT TEXT ROUTINE           */
*                       RDWRKSTR,   /* TEXT                          */
*                       RDCOUNTL+1, /* LENGTH                        */
*                       RDLINE,     /* START LINE                    */
*                       COLB        /* START COLUMN                  */
*                       );                                         0071
         LA    @08,RDWRKSTR                                        0071
         ST    @08,@AL00001                                        0071
         LA    @08,@CF00054                                        0071
         ST    @08,@AL00001+4                                      0071
         LA    @08,RDLINE                                          0071
         ST    @08,@AL00001+8                                      0071
         LA    @08,@CF00211                                        0071
         ST    @08,@AL00001+12                                     0071
         L     @08,@PC00001+4                                      0071
         L     @15,RDVECTAB+8(,@08)                                0071
         LA    @01,@AL00001                                        0071
         BALR  @14,@15                                             0071
*                 END;                                             0072
*                                                                  0072
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT PERCENT BUSY IF DIVISOR IS NOT ZERO        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0073
*               IF SMF74SAM^=RDDVZERO THEN                         0073
@RC00063 LH    @08,RDCLSIDX                                        0073
         SLA   @08,2                                               0073
         L     @15,@PC00001                                        0073
         L     @01,RDDTAPTR(,@15)                                  0073
         AL    @01,@CF00249                                        0073
         L     @08,DDDVADD(@08,@01)                                0073
         L     @15,SMF74SAM(,@08)                                  0073
         LTR   @15,@15                                             0073
         BZ    @RF00073                                            0073
*                 DO;                                              0074
*                                                                  0074
*                   /*************************************************/
*                   /*                                               */
*                   /* CALCULATE (SMF74ACT(RDDEVIDX)*100000)         */
*                   /* /SMF74SAM) MACDATE Y-2 73018                  */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0075
*                   RESPECIFY                                      0075
*                    (GPR00P,                                      0075
*                     GPR01P,                                      0075
*                     GPR14P,                                      0075
*                     GPR15P)RESTRICTED;                           0075
*                   GPR01F=SMF74ACT(RDDEVIDX);/* LARGE VALUE TO REG  */
         ST    @15,@TF00001                                        0076
         LH    @07,RDDEVIDX                                        0076
         MH    @07,@CH00234                                        0076
         LA    @06,SMF74SIZ(,@08)                                  0076
         AH    @06,SMF74SIZ(,@08)                                  0076
         LH    @08,SMF74SDC(,@06)                                  0076
         AR    @08,@06                                             0076
         AL    @08,@CF00254                                        0076
         L     GPR01F,SMF74ACT-20(@07,@08)                         0076
*                   GPR15F=SMF74SAM;/* DENOMINATOR TO REGISTER       */
         L     GPR15F,@TF00001                                     0077
*                   GENERATE REFS(C100000);                        0078
*                                                                  0078
        M     GPR00F,C100000       MAY SPILL TO DOUBLE WORD
        DR    GPR00F,GPR15F        RESULT FITS IN SINGLE WORD
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0079
*                   CALL IRBMFCNV(  /* CONVERSION ROUTINE            */
*                       EVAL(GPR01F),/* INPUT VALUE                  */
*                       RDTHOSCF,   /* INPUT SCALE                   */
*                       RDWRKSTR,   /* OUTPUT STRING                 */
*                       RDPCTLEN,   /* OUTPUT LENGTH                 */
*                       RDPCTPLC,   /* PLACES RIGHT OF DEC PT        */
*                       RDNOCOMA,   /* COMMAS FLAG                   */
*                       RDNOFLOT    /* MAX PRECISION FLAG            */
*                       );                                         0079
*                                                                  0079
         MVC   @AL00001+4(24),@AL00079                             0079
         ST    GPR01F,@AFTEMPS                                     0079
         LA    @08,@AFTEMPS                                        0079
         ST    @08,@AL00001                                        0079
         LA    @08,RDWRKSTR                                        0079
         ST    @08,@AL00001+8                                      0079
         L     @08,@PC00001+4                                      0079
         L     @15,RDVECTAB(,@08)                                  0079
         LA    @01,@AL00001                                        0079
         BALR  @14,@15                                             0079
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0080
*                   RESPECIFY                                      0080
*                    (GPR00P,                                      0080
*                     GPR01P,                                      0080
*                     GPR14P,                                      0080
*                     GPR15P)UNRESTRICTED;                         0080
*                 END;                                             0081
*               ELSE                                               0082
*                 RDWRKSTR(1:5)=LNGTPTR(LDPART19)->LNGTXTD(1:LNGTPTR(
*                     LDPART19)->LNGTXTL);                         0082
*                                                                  0082
         B     @RC00073                                            0082
@RF00073 MVI   RDWRKSTR+1,C' '                                     0082
         MVC   RDWRKSTR+2(3),RDWRKSTR+1                            0082
         L     @08,@CA00125                                        0082
         L     @08,LNGTPTR-IRBMFLDV+72(,@08)                       0082
         L     @15,LNGTXTL(,@08)                                   0082
         BCTR  @15,0                                               0082
         EX    @15,@SM00255                                        0082
*               /*****************************************************/
*               /*                                                   */
*               /* MACDATE Y-2 73018                                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0083
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   RDWRKSTR,       /* TEXT                          */
*                   RDPCTLEN,       /* LENGTH                        */
*                   RDLINE,         /* START LINE                    */
*                   COLC            /* START COLUMN                  */
*                   );                                             0083
*                                                                  0083
@RC00073 LA    @08,RDWRKSTR                                        0083
         ST    @08,@AL00001                                        0083
         LA    @08,@CF00135                                        0083
         ST    @08,@AL00001+4                                      0083
         LA    @08,RDLINE                                          0083
         ST    @08,@AL00001+8                                      0083
         LA    @08,@CF00213                                        0083
         ST    @08,@AL00001+12                                     0083
         L     @08,@PC00001+4                                      0083
         L     @15,RDVECTAB+8(,@08)                                0083
         LA    @01,@AL00001                                        0083
         BALR  @14,@15                                             0083
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT MEAN QLENGTH IF DIVISOR IS NOT ZERO        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0084
*               IF SMF74SAM^=RDDVZERO THEN                         0084
         LH    @08,RDCLSIDX                                        0084
         SLA   @08,2                                               0084
         L     @15,@PC00001                                        0084
         L     @01,RDDTAPTR(,@15)                                  0084
         AL    @01,@CF00249                                        0084
         L     @08,DDDVADD(@08,@01)                                0084
         L     @15,SMF74SAM(,@08)                                  0084
         LTR   @15,@15                                             0084
         BZ    @RF00084                                            0084
*                 DO;                                              0085
*                                                                  0085
*                   /*************************************************/
*                   /*                                               */
*                   /* CALCULATE (SMF74QUE(RDDEVIDX)*1000) /SMF74SAM)*/
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0086
*                   RESPECIFY                                      0086
*                    (GPR00P,                                      0086
*                     GPR01P,                                      0086
*                     GPR14P,                                      0086
*                     GPR15P)RESTRICTED;                           0086
*                   GPR01F=SMF74QUE(RDDEVIDX);/* LARGE VALUE TO REG  */
         ST    @15,@TF00001                                        0087
         LH    @07,RDDEVIDX                                        0087
         MH    @07,@CH00234                                        0087
         LA    @06,SMF74SIZ(,@08)                                  0087
         AH    @06,SMF74SIZ(,@08)                                  0087
         LH    @08,SMF74SDC(,@06)                                  0087
         AR    @08,@06                                             0087
         AL    @08,@CF00249                                        0087
         L     GPR01F,SMF74QUE-24(@07,@08)                         0087
*                   GPR15F=SMF74SAM;/* DENOMINATOR TO REGISTER       */
         L     GPR15F,@TF00001                                     0088
*                   GENERATE REFS(C1000);                          0089
*                                                                  0089
        M     GPR00F,C1000         MAY SPILL TO DOUBLE WORD
        DR    GPR00F,GPR15F        RESULT FITS IN SINGLE WORD
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0090
*                   CALL IRBMFCNV(  /* CONVERSION ROUTINE            */
*                       EVAL(GPR01F),/* INPUT VALUE                  */
*                       RDTHOSCF,   /* INPUT SCALE                   */
*                       RDWRKSTR,   /* OUTPUT STRING                 */
*                       RDPCTLEN,   /* OUTPUT LENGTH                 */
*                       RDPCTPLC,   /* PLACES RIGHT OF DEC PT        */
*                       RDNOCOMA,   /* COMMAS FLAG                   */
*                       RDNOFLOT    /* MAX PRECISION FLAG            */
*                       );                                         0090
*                                                                  0090
         MVC   @AL00001+4(24),@AL00090                             0090
         ST    GPR01F,@AFTEMPS                                     0090
         LA    @08,@AFTEMPS                                        0090
         ST    @08,@AL00001                                        0090
         LA    @08,RDWRKSTR                                        0090
         ST    @08,@AL00001+8                                      0090
         L     @08,@PC00001+4                                      0090
         L     @15,RDVECTAB(,@08)                                  0090
         LA    @01,@AL00001                                        0090
         BALR  @14,@15                                             0090
*                   /*************************************************/
*                   /*                                               */
*                   /* MACDATE Y-2 73018                             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0091
*                   RESPECIFY                                      0091
*                    (GPR00P,                                      0091
*                     GPR01P,                                      0091
*                     GPR14P,                                      0091
*                     GPR15P)UNRESTRICTED;                         0091
*                 END;                                             0092
*               ELSE                                               0093
*                 RDWRKSTR(1:5)=LNGTPTR(LDPART19)->LNGTXTD(1:LNGTPTR(
*                     LDPART19)->LNGTXTL);                         0093
*                                                                  0093
         B     @RC00084                                            0093
@RF00084 MVI   RDWRKSTR+1,C' '                                     0093
         MVC   RDWRKSTR+2(3),RDWRKSTR+1                            0093
         L     @08,@CA00125                                        0093
         L     @08,LNGTPTR-IRBMFLDV+72(,@08)                       0093
         L     @15,LNGTXTL(,@08)                                   0093
         BCTR  @15,0                                               0093
         EX    @15,@SM00255                                        0093
*               /*****************************************************/
*               /*                                                   */
*               /* MACDATE Y-2 73018                                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0094
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */
*                   RDWRKSTR,       /* TEXT                          */
*                   RDPCTLEN,       /* LENGTH                        */
*                   RDLINE,         /* START LINE                    */
*                   COLD            /* START COLUMN                  */
*                   );                                             0094
@RC00084 LA    @08,RDWRKSTR                                        0094
         ST    @08,@AL00001                                        0094
         LA    @08,@CF00135                                        0094
         ST    @08,@AL00001+4                                      0094
         LA    @08,RDLINE                                          0094
         ST    @08,@AL00001+8                                      0094
         LA    @08,@CF00095                                        0094
         ST    @08,@AL00001+12                                     0094
         L     @08,@PC00001+4                                      0094
         L     @15,RDVECTAB+8(,@08)                                0094
         LA    @01,@AL00001                                        0094
         BALR  @14,@15                                             0094
*             END;                                                 0095
*           RDLINE=RDLINE+1;        /* INCREMENT LINE NUMBER         */
@RC00051 LA    @08,1                                               0096
         A     @08,RDLINE                                          0096
         ST    @08,RDLINE                                          0096
*         END;                                                     0097
*                                                                  0097
         LA    @08,1                                               0097
         AH    @08,RDDEVIDX                                        0097
@DE00020 STH   @08,RDDEVIDX                                        0097
         LH    @15,RDCLSIDX                                        0097
         SLA   @15,2                                               0097
         L     @14,@PC00001                                        0097
         L     @01,RDDTAPTR(,@14)                                  0097
         AL    @01,@CF00249                                        0097
         L     @01,DDDVADD(@15,@01)                                0097
         LA    @15,SMF74SIZ(,@01)                                  0097
         LH    @14,RDCLSIDX                                        0097
         SLA   @14,2                                               0097
         L     @07,@PC00001                                        0097
         L     @01,RDDTAPTR(,@07)                                  0097
         AL    @01,@CF00249                                        0097
         L     @01,DDDVADD(@14,@01)                                0097
         AH    @15,SMF74SIZ(,@01)                                  0097
         CH    @08,SMF74DEV(,@15)                                  0097
         BNH   @DL00020                                            0097
*         /***********************************************************/
*         /*                                                         */
*         /* FINISHED WITH ALL DEVICES IN CLASS. INSERT TOTAL SIO AND*/
*         /* WRITE OUT PAGE                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0098
*         RDLINE=RDLINE+1;          /* ONE BLANK LINE                */
*                                                                  0098
         LA    @08,1                                               0098
         A     @08,RDLINE                                          0098
         ST    @08,RDLINE                                          0098
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT 'TOTAL' MACDATE Y-2 73018                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0099
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */
*             LNGTPTR(LDPART18)->LNGTXTD,/* TEXT                     */
*             LNGTPTR(LDPART18)->LNGTXTL,/* LENGTH                   */
*             RDLINE,               /* START LINE                    */
*             COLA                  /* START COLUMN                  */
*             );                                                   0099
*                                                                  0099
         L     @08,@CA00125                                        0099
         L     @08,LNGTPTR-IRBMFLDV+68(,@08)                       0099
         LA    @15,LNGTXTD(,@08)                                   0099
         ST    @15,@AL00001                                        0099
         ST    @08,@AL00001+4                                      0099
         LA    @08,RDLINE                                          0099
         ST    @08,@AL00001+8                                      0099
         LA    @08,@CF00081                                        0099
         ST    @08,@AL00001+12                                     0099
         L     @08,@PC00001+4                                      0099
         L     @15,RDVECTAB+8(,@08)                                0099
         LA    @01,@AL00001                                        0099
         BALR  @14,@15                                             0099
*         /***********************************************************/
*         /*                                                         */
*         /* INSERT TOTAL DEVICE ACTIVITY. IF LT 1,000,000, INSERT AS*/
*         /* NNN,NNN. IF GE 1,000,000, INSERT AS N,NNN,NNN.NNNM      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0100
*         IF RDSIOTOT<1000000 THEN                                 0100
         L     @08,RDSIOTOT                                        0100
         C     @08,@CF00229                                        0100
         BNL   @RF00100                                            0100
*           DO;                                                    0101
*                                                                  0101
*             /*******************************************************/
*             /*                                                     */
*             /* MACDATE Y-2 73018                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0102
*             CALL IRBMFCNV(        /* CONVERSION ROUTINE            */
*                 RDSIOTOT,         /* INPUT VALUE                   */
*                 RDDATSCF,         /* INPUT SCALE                   */
*                 RDWRKSTR,         /* OUTPUT STRING                 */
*                 RDCOUNTL,         /* OUTPUT LENGTH                 */
*                 RDNOPLCE,         /* PLACES RIGHT OF DEC PT        */
*                 RDCOMMAS,         /* COMMAS FLAG                   */
*                 RDNOFLOT          /* MAX PRECISION FLAG            */
*                 );                                               0102
*                                                                  0102
         MVC   @AL00001+4(24),@AL00102                             0102
         LA    @08,RDSIOTOT                                        0102
         ST    @08,@AL00001                                        0102
         LA    @08,RDWRKSTR                                        0102
         ST    @08,@AL00001+8                                      0102
         L     @08,@PC00001+4                                      0102
         L     @15,RDVECTAB(,@08)                                  0102
         LA    @01,@AL00001                                        0102
         BALR  @14,@15                                             0102
*             /*******************************************************/
*             /*                                                     */
*             /* MACDATE Y-2 73018                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0103
*             CALL MFISRTXT(        /* INSERT TEXT ROUTINE           */
*                 RDWRKSTR,         /* TEXT                          */
*                 RDCOUNTL,         /* LENGTH                        */
*                 RDLINE,           /* START LINE                    */
*                 COLB              /* START COLUMN                  */
*                 );                                               0103
         LA    @08,RDWRKSTR                                        0103
         ST    @08,@AL00001                                        0103
         LA    @08,@CF00138                                        0103
         ST    @08,@AL00001+4                                      0103
         LA    @08,RDLINE                                          0103
         ST    @08,@AL00001+8                                      0103
         LA    @08,@CF00211                                        0103
         ST    @08,@AL00001+12                                     0103
         L     @08,@PC00001+4                                      0103
         L     @15,RDVECTAB+8(,@08)                                0103
         LA    @01,@AL00001                                        0103
         BALR  @14,@15                                             0103
*           END;                                                   0104
*         ELSE                                                     0105
*           DO;                                                    0105
*                                                                  0105
         B     @RC00100                                            0105
@RF00100 DS    0H                                                  0106
*             /*******************************************************/
*             /*                                                     */
*             /* MACDATE Y-2 73018                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0106
*             CALL IRBMFCNV(        /* CONVERSION ROUTINE            */
*                 RDSIOTOT,         /* INPUT VALUE                   */
*                 RDMILSCF,         /* INPUT SCALE                   */
*                 RDWRKSTR,         /* OUTPUT STRING                 */
*                 RDCOUNTM,         /* OUTPUT LENGTH                 */
*                 RDDECMIL,         /* PLACES RIGHT OF DEC PT        */
*                 RDCOMMAS,         /* COMMAS FLAG                   */
*                 RDNOFLOT          /* MAX PRECISION FLAG            */
*                 );                                               0106
         MVC   @AL00001+4(24),@AL00106                             0106
         LA    @08,RDSIOTOT                                        0106
         ST    @08,@AL00001                                        0106
         LA    @08,RDWRKSTR                                        0106
         ST    @08,@AL00001+8                                      0106
         L     @08,@PC00001+4                                      0106
         L     @15,RDVECTAB(,@08)                                  0106
         LA    @01,@AL00001                                        0106
         BALR  @14,@15                                             0106
*             RDWRKSTR(14)='M';     /* MILLIONS                      */
*                                                                  0107
         MVI   RDWRKSTR+13,C'M'                                    0107
*             /*******************************************************/
*             /*                                                     */
*             /* MACDATE Y-2 73018                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0108
*             CALL MFISRTXT(        /* INSERT TEXT ROUTINE           */
*                 RDWRKSTR,         /* TEXT                          */
*                 RDCOUNTM+1,       /* LENGTH                        */
*                 RDLINE,           /* START LINE                    */
*                 COLB+RDMILSCF     /* START COLUMN                  */
*                 );                                               0108
         LA    @08,RDWRKSTR                                        0108
         ST    @08,@AL00001                                        0108
         LA    @08,@CF00150                                        0108
         ST    @08,@AL00001+4                                      0108
         LA    @08,RDLINE                                          0108
         ST    @08,@AL00001+8                                      0108
         LA    @08,@CF00233                                        0108
         ST    @08,@AL00001+12                                     0108
         L     @08,@PC00001+4                                      0108
         L     @15,RDVECTAB+8(,@08)                                0108
         LA    @01,@AL00001                                        0108
         BALR  @14,@15                                             0108
*           END;                                                   0109
*                                                                  0109
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE OUT PAGE                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0110
*         CALL MFWRTPAG;                                           0110
@RC00100 L     @08,@PC00001+4                                      0110
         L     @15,RDVECTAB+12(,@08)                               0110
         BALR  @14,@15                                             0110
*       END;                                                       0111
*   END;                                                           0112
@RF00015 LA    @08,1                                               0112
         AH    @08,RDCLSIDX                                        0112
         STH   @08,RDCLSIDX                                        0112
         CH    @08,@CH00047                                        0112
         BNH   @DL00014                                            0112
*   RETURN;                         /* RETURN TO CALLER              */
@EL00001 L     @13,4(,@13)                                         0113
@EF00001 L     @00,@SIZDATD                                        0113
         LR    @01,@09                                             0113
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0113
         BR    @14                                                 0113
*   END                                                            0114
*                                                                  0114
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */
*/*%INCLUDE SYSLIB  (IRBRGCON)                                       */
*/*%INCLUDE SYSLIB  (IRBMFLDM)                                       */
*                                                                  0114
*       ;                                                          0114
@DATA    DS    0H
@CH00234 DC    H'28'
@CH00232 DC    H'57'
@CH00171 DC    XL1'0'
         DC    C'0'
@SM00255 MVC   RDWRKSTR(0),LNGTXTD(@08)
         DS    0F
@AL00065 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL00102 DC    A(@CF00197)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00138)
         DC    A(@CF00197)
         DC    A(@CB00191)
         DC    A(@CB00193)
@AL00069 DC    A(@CF00202)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00138)
         DC    A(@CF00107)
         DC    A(@CB00193)
         DC    A(@CB00193)
@AL00079 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL00090 DC    A(@CF00207)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00135)
         DC    A(@CF00065)
         DC    A(@CB00193)
         DC    A(@CB00193)
@AL00106 DC    A(@CF00202)             LIST WITH   6 ARGUMENT(S)
         DS    F
         DC    A(@CF00097)
         DC    A(@CF00107)
         DC    A(@CB00191)
         DC    A(@CB00193)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@AL00001 DS    7A
@TF00001 DS    F
@AFTEMPS DS    1F
IRBMFRDR CSECT
         DS    0F
@CF00250 DC    F'-28'
@CF00252 DC    F'-25'
@CF00251 DC    F'-20'
@CF00253 DC    F'-12'
@CF00254 DC    F'-8'
@CF00202 DC    F'-6'
@CF00249 DC    F'-4'
@CF00207 DC    F'-3'
@CF00197 DC    F'0'
@CF00081 DC    F'1'
@CH00081 EQU   @CF00081+2
@CF00065 DC    F'2'
@CF00107 DC    F'3'
@CF00058 DC    F'4'
@CF00135 DC    F'5'
@CF00047 DC    F'6'
@CH00047 EQU   @CF00047+2
@CF00138 DC    F'7'
@CF00054 DC    F'8'
@CF00141 DC    F'9'
@CF00097 DC    F'13'
@CF00150 DC    F'14'
@CF00051 DC    F'15'
@CF00233 DC    F'24'
@CF00244 DC    F'26'
@CF00243 DC    F'27'
@CF00211 DC    F'30'
@CF00213 DC    F'45'
@CF00095 DC    F'60'
@CF00229 DC    F'1000000'
@DATD    DSECT
         DS    0D
RDPAGE   DS    F
RDLINE   DS    F
RDSIOTOT DS    F
RDCLSIDX DS    H
RDDEVIDX DS    H
RDPACKAD DS    CL3
RDWRKSTR DS    CL14
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IRBMFRDR CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA00125 DC    A(IRBMFLDV)
         DS    0D
C100000  DC    F'100000'
C1000    DC    F'1000'
@CB00191 DC    B'10000000'
@CB00193 DC    B'00000000'
RDDTRTAB DC    CL16'0123456789ABCDEF'
RDPATCH  DS    CL200
RDTPART  DC    H'1'
         DC    H'2'
         DC    H'3'
         DC    H'4'
         DC    H'5'
         DC    H'6'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
GPR01F   EQU   @01
GPR15F   EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR14P   EQU   @14
GPR15P   EQU   @15
GPR11P   EQU   @11
GPR12P   EQU   @12
GPR00F   EQU   @00
GPR14F   EQU   @14
         EXTRN IRBMFLDV
DDDVT    EQU   0
SMFRCD74 EQU   0
SMF74SIZ EQU   SMFRCD74+18
SMF74SUB EQU   SMFRCD74+34
SMF74SAM EQU   SMFRCD74+36
SMF74PTR EQU   0
SMF74A   EQU   0
SMF74SDC EQU   SMF74A
SMF74DEV EQU   SMF74A+2
SMF74B   EQU   0
SMF74ADD EQU   SMF74B
SMF74CNF EQU   SMF74B+3
SMF74VAC EQU   SMF74CNF
SMF74STA EQU   SMF74CNF
SMF74SER EQU   SMF74B+8
SMF74CNT EQU   SMF74B+16
SMF74ACT EQU   SMF74B+20
SMF74QUE EQU   SMF74B+24
LNGTXT   EQU   0
LNGTXTL  EQU   LNGTXT
LNGTXTD  EQU   LNGTXT+4
IRBMFCNV EQU   0
MFHDRISR EQU   0
MFISRTXT EQU   0
MFWRTPAG EQU   0
RDTRTAB  EQU   0
IKEBC    EQU   0
IKEBF15  EQU   0
IKEBF31  EQU   0
IKEBP15  EQU   0
IKEBP31  EQU   0
IKEBP8   EQU   0
RDDTAPTR EQU   0
RDVECTAB EQU   0
RDPMAPTR EQU   0
DDDVADD  EQU   DDDVT
LNG      EQU   IRBMFLDV
LNGTPTR  EQU   LNG
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
SMF74RV4 EQU   SMF74B+14
SMF74TYP EQU   SMF74B+4
@NM00001 EQU   SMF74CNF
SMF74RV3 EQU   SMF74B+2
SMF74RV2 EQU   SMF74A+6
SMF74SDD EQU   SMF74A+4
SMF74RLS EQU   SMFRCD74+44
SMF74RV1 EQU   SMFRCD74+42
SMF74MFV EQU   SMFRCD74+40
SMF74CYC EQU   SMFRCD74+32
SMF74INT EQU   SMFRCD74+28
SMF74DAT EQU   SMFRCD74+24
SMF74IST EQU   SMFRCD74+20
SMF74SID EQU   SMFRCD74+14
SMF74DTE EQU   SMFRCD74+10
SMF74TME EQU   SMFRCD74+6
SMF74RTY EQU   SMFRCD74+5
SMF74FLG EQU   SMFRCD74+4
SMF74SEG EQU   SMFRCD74+2
SMF74LEN EQU   SMFRCD74
DDDVCRDR EQU   DDDVT+20
DDDVTAPE EQU   DDDVT+16
DDDVTP   EQU   DDDVT+12
DDDVDA   EQU   DDDVT+8
DDDVGRAP EQU   DDDVT+4
DDDVUNIT EQU   DDDVT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00053 EQU   @RC00051
@RC00055 EQU   @RC00053
@ENDDATA EQU   *
         END   IRBMFRDR,(C'PL/S-II',0502,74087)

         TITLE ' /* IRBMFDTA    DATA CONTROL                           *
                        '
IRBMFDTA CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IRBMFDTA  74.339'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MVC   @PC00001(16),0(@01)                                 0001
*                                                                  0020
*   /*****************************************************************/
*   /*                                                               */
*   /* AUTOMATIC STORAGE INITIALIZATION                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0020
*   DTOPSTOP=CLEAR;                 /* CLEAR OPERATOR STOP FLAG.     */
         NI    DTOPSTOP,B'01111111'                                0020
*   DTINTACC=0;                     /* ELAPSED INTERVAL TIME         */
         SLR   DTINTACC,DTINTACC                                   0021
*   DTESTAPL=DTESTSPL;              /* ESTAE MACRO LIST              */
         MVC   DTESTAPL(16),DTESTSPL                               0022
*   DTATTAPL=DTATTSPL;              /* ATTACH MACRO LIST             */
         MVC   DTATTAPL(60),DTATTSPL                               0023
*   DTEXTAPL=DTEXTSPL;              /* EXTRACT MACRO LIST            */
         MVC   DTEXTAPL(16),DTEXTSPL                               0024
*   GEN;                                                           0025
*                                                                  0025
*        PUT POST MACRO IN AUTOMATIC STORAGE, WHERE IT IS EXECUTED
         MVC   DTPOSAPL(DTPOSLPL),DTPOSSPL
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTIONAL CODE ESTABLISH ESTAE ROUTINE                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0026
*   RFY                                                            0026
*    (GPR02P) RSTD;                                                0026
*   GPR02P=ADDR(MFPCT);             /* ESTAE PARAMETER IS PROBLEM  0027
*                                      CONTROL TABLE (MFPCT)         */
         L     GPR02P,@PC00001+12                                  0027
*   RFY                                                            0028
*    (GPR02P) UNRSTD;                                              0028
*                                                                  0028
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0029
*   RESPECIFY                                                      0029
*    (GPR00P,                                                      0029
*     GPR01P,                                                      0029
*     GPR14P,                                                      0029
*     GPR15P) RESTRICTED;                                          0029
*   GEN;                                                           0030
*                                                                  0030
         ESTAE PARAM=(2),MF=(E,DTESTAPL) ESTABLISH ESTAE IRBMFDEA
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0031
*   RESPECIFY                                                      0031
*    (GPR00P,                                                      0031
*     GPR01P,                                                      0031
*     GPR14P,                                                      0031
*     GPR15P) UNRESTRICTED;                                        0031
*                                                                  0031
*   /*****************************************************************/
*   /*                                                               */
*   /* CURRENT TIME IS START OF FIRST MF/1 INTERVAL MACDATE Y-2 73018*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0032
*   RESPECIFY                                                      0032
*    (GPR00P,                                                      0032
*     GPR01P,                                                      0032
*     GPR14P,                                                      0032
*     GPR15P) RESTRICTED;                                          0032
*   GEN REFS(MFPCTDSI,DTDWORD);                                    0033
*                                                                  0033
         TIME  STCK,DTDWORD         SAVE TOD CLOCK.
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0034
*   RESPECIFY                                                      0034
*    (GPR00P,                                                      0034
*     GPR01P,                                                      0034
*     GPR14P,                                                      0034
*     GPR15P) UNRESTRICTED;                                        0034
*   MFPCTDSI=DTDWORD;               /* START OF FIRST INTERVAL.      */
*                                                                  0035
         L     @10,@PC00001+12                                     0035
         MVC   MFPCTDSI(8,@10),DTDWORD                             0035
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE MESSAGE 'MF/1 ACTIVE' MACDATE Y-2 73018                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0036
*   RESPECIFY                                                      0036
*    (GPR00P,                                                      0036
*     GPR01P,                                                      0036
*     GPR14P,                                                      0036
*     GPR15P) RESTRICTED;                                          0036
*   GEN;                                                           0037
         LOAD  EP=IRBMFMPR          LOAD MESSAGE PROCESSOR           */
*   DTMODEPA=GPR00P;                /* SAVE ENTRY POINT ADDRESS      */
*                                                                  0038
         LR    DTMODEPA,GPR00P                                     0038
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0039
*   RESPECIFY                                                      0039
*    (GPR00P,                                                      0039
*     GPR01P,                                                      0039
*     GPR14P,                                                      0039
*     GPR15P) UNRESTRICTED;                                        0039
*   CALL IRBMFMPR(MID100I           /* MESSAGE ID.                   */
*       ,0                          /* NO VARIABLE TEXT              */
*       ,0                          /* NO REPLY AREA                 */
*       ,0                          /* NO MESSAGE DATA SET DCB       */
*       );                                                         0040
*                                                                  0040
         LR    @15,DTMODEPA                                        0040
         LA    @01,@AL00040                                        0040
         BALR  @14,@15                                             0040
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0041
*   RESPECIFY                                                      0041
*    (GPR00P,                                                      0041
*     GPR01P,                                                      0041
*     GPR14P,                                                      0041
*     GPR15P) RESTRICTED;                                          0041
*   GEN;                                                           0042
*                                                                  0042
         DELETE EP=IRBMFMPR         DELETE MESSAGE PROCESSOR         */
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0043
*   RESPECIFY                                                      0043
*    (GPR00P,                                                      0043
*     GPR01P,                                                      0043
*     GPR14P,                                                      0043
*     GPR15P) UNRESTRICTED;                                        0043
*                                                                  0043
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE INTERVAL VALUE IN TIME OF DAY CLOCK FORMAT: BIT 51= 1    */
*   /* MICROSECOND. MACDATE Y-2 73018                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0044
*   RESPECIFY                                                      0044
*    (GPR00P,                                                      0044
*     GPR01P,                                                      0044
*     GPR14P,                                                      0044
*     GPR15P) RESTRICTED;                                          0044
*   GPR01P=MFCOINTV;                /* MINUTES IN INTERVAL.          */
         L     @10,@PC00001+12                                     0045
         L     @10,MFPCCOA(,@10)                                   0045
         LH    GPR01P,MFCOINTV(,@10)                               0045
*   GEN REFS(MFCOINTV) SETS(MFPCMINT,DTDWORD);                     0046
         M     @00,DT60MIL          TIMES MICROSECONDS IN 1 MIN
         SLDL  @00,12               MOVED TO BIT 51 FROM BIT 63
         STM   @00,@01,DTDWORD      SAVED IN TEMP AREA.
*   MFPCMINT=DTDWORD;               /* INTERVAL LENGTH IN TOD FORMAT.*/
         L     @10,@PC00001+12                                     0047
         MVC   MFPCMINT(8,@10),DTDWORD                             0047
*   GEN DATA;                                                      0048
*                                                                  0048
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0049
*   RESPECIFY                                                      0049
*    (GPR00P,                                                      0049
*     GPR01P,                                                      0049
*     GPR14P,                                                      0049
*     GPR15P) UNRESTRICTED;                                        0049
*                                                                  0049
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE THE NUMBER OF INTERVALS REQUIRED                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0050
*   IF MFCOSTPS^=CNEVER THEN        /* IF MF/1 IS REQUESTED TO STOP
*                                      UNDER PROGRAM CONTROL, (AFTER
*                                      THE STOP TIME HAS ELAPSED),DO */
         L     @10,@PC00001+12                                     0050
         L     @10,MFPCCOA(,@10)                                   0050
         TM    MFCOSTPS(@10),B'01000000'                           0050
         BO    @RF00050                                            0050
*     DO;                                                          0051
*       IF MFCOSTPU=CHOURS THEN     /* IF STOP VALUE IS IN HOURS     */
         TM    MFCOSTPU(@10),B'00100000'                           0052
         BNO   @RF00052                                            0052
*         DTEMPF=CMINHOUR*MFCOSTPV; /* NO OF MINUTES = 60 TIMES IT   */
         LH    DTEMPF,MFCOSTPV(,@10)                               0053
         MH    DTEMPF,@CH00333                                     0053
*       ELSE                        /* ELSE                          */
*         DTEMPF=MFCOSTPV;          /* USE MINUTES INPUT.            */
*                                                                  0054
         B     @RC00052                                            0054
@RF00052 L     @10,@PC00001+12                                     0054
         L     @10,MFPCCOA(,@10)                                   0054
         LH    DTEMPF,MFCOSTPV(,@10)                               0054
*       /*************************************************************/
*       /*                                                           */
*       /* NUMBER OF INTERVALS = STOP DURATION (MIN.) / INTERVAL     */
*       /* LENGTH (MIN.).                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0055
*       MFPCNINT=DTEMPF/MFCOINTV;                                  0055
@RC00052 L     @10,@PC00001+12                                     0055
         L     @08,MFPCCOA(,@10)                                   0055
         LR    @01,DTEMPF                                          0055
         SLR   @00,@00                                             0055
         LH    @08,MFCOINTV(,@08)                                  0055
         DR    @00,@08                                             0055
         STH   @01,MFPCNINT(,@10)                                  0055
*     END;                                                         0056
*   ELSE                            /* IF STOP COMMAND WILL BE USED, */
*     MFPCNINT=CNOINTVL;            /* CLEAR INTERVAL COUNT          */
         B     @RC00050                                            0057
@RF00050 L     @10,@PC00001+12                                     0057
         SLR   @08,@08                                             0057
         STH   @08,MFPCNINT(,@10)                                  0057
*                                                                  0058
*   /*****************************************************************/
*   /*                                                               */
*   /* TOP OF LOOP FOR EACH MF/1 INTERVAL. ISSUE STIMER TO DEFINE    */
*   /* INTERVAL AND WAIT FOR FIRST OF THE FOLLOWING: STIMER EXIT ECB,*/
*   /* STOP COMMAND ECB, SUBTASK ECB(S)                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0058
*   MFPCALST=0;                     /* LAST SUBTASK TO ALLOCATE    0058
*                                      SYSOUT SPACE                  */
@RC00050 L     @10,@PC00001+12                                     0058
         SLR   @08,@08                                             0058
         ST    @08,MFPCALST(,@10)                                  0058
*   MFPCSTID=CRGMINCR;              /* NEXT SUBTASK ID               */
         MVC   MFPCSTID(4,@10),@CF00057                            0059
*   DTMASTOP=CLEAR;                 /* CLEAR MACHINE STOPPED FLAG    */
         NI    DTMASTOP,B'01111111'                                0060
*DT000:                             /* TOP OF MF/1 INTERVAL LOOP     */
*DT001:                             /* LABEL FOR 2 INTERVALS IN ONE  */
*   IF MFCOSTPS^=CNEVER             /* IF MF/1 STOPS UNDER PROGRAM 0061
*                                      CONTROL,                      */
*       &MFPCNINT<=CNOINTVL         /* AND IF THE NUMBER OF REMAINING
*                                      INTERVALS IS ZERO             */
*       ×DTOPSTOP=CSET              /* OR STOPPED BY CONSOLE OPERATOR*/
*     THEN                                                         0061
DT000    DS    0H                                                  0061
DT001    L     @10,@PC00001+12                                     0061
         L     @08,MFPCCOA(,@10)                                   0061
         TM    MFCOSTPS(@08),B'01000000'                           0061
         BO    @GL00001                                            0061
         LH    @10,MFPCNINT(,@10)                                  0061
         LTR   @10,@10                                             0061
         BNP   @RT00061                                            0061
@GL00001 TM    DTOPSTOP,B'10000000'                                0061
         BNO   @RF00061                                            0061
@RT00061 DS    0H                                                  0062
*     DO;                                                          0062
*       GEN REFS(DTESTAPL);                                        0063
         ESTAE 0,MF=(E,DTESTAPL)       CANCEL ESTAE IRBMFDEA
*       RETURN;                     /* MF/1 IS DONE MEASURING        */
@EL00001 L     @13,4(,@13)                                         0064
@EF00001 L     @00,@SIZDATD                                        0064
         LR    @01,@11                                             0064
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0064
         BR    @14                                                 0064
*     END;                                                         0065
*                                                                  0065
*   /*****************************************************************/
*   /*                                                               */
*   /* AT LEAST ONE MORE INTERVAL EXISTS.                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0066
*   MFPCNINT=MFPCNINT-1;            /* DECREMENT THE REMAINING INTER-
*                                      VAL COUNT                     */
*                                                                  0066
@RF00061 L     @10,@PC00001+12                                     0066
         LH    @08,MFPCNINT(,@10)                                  0066
         BCTR  @08,0                                               0066
         STH   @08,MFPCNINT(,@10)                                  0066
*   /*****************************************************************/
*   /*                                                               */
*   /* DECREMENT STOP DURATION TOO, IN CASE OF REINSTATEMENT.        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0067
*   IF MFCOSTPU=CHOURS THEN         /* IF STOP VALUE IS IN HOURS     */
         L     @10,MFPCCOA(,@10)                                   0067
         TM    MFCOSTPU(@10),B'00100000'                           0067
         BNO   @RF00067                                            0067
*     DO;                                                          0068
*       DTINTACC=DTINTACC+MFCOINTV; /* ACCUMULATE INTERVAL MINUTES   */
         AH    DTINTACC,MFCOINTV(,@10)                             0069
*       MFCOSTPV=MFCOSTPV-DTINTACC/CMINHOUR;/* REDUCE STOP DURATION
*                                      BY HOURS ACCUMULATED          */
         LA    @08,60                                              0070
         LR    @00,DTINTACC                                        0070
         SRDA  @00,32                                              0070
         DR    @00,@08                                             0070
         LCR   @01,@01                                             0070
         AH    @01,MFCOSTPV(,@10)                                  0070
         STH   @01,MFCOSTPV(,@10)                                  0070
*       DTINTACC=DTINTACC//CMINHOUR;/* KEEP EXTRA MINUTES ACCUMUL'D  */
         LR    @00,DTINTACC                                        0071
         SRDA  @00,32                                              0071
         DR    @00,@08                                             0071
         LR    DTINTACC,@00                                        0071
*     END;                                                         0072
*   ELSE                            /* ELSE                          */
*     MFCOSTPV=MFCOSTPV-MFCOINTV;   /* REDUCE STOP DURATION BY INTER-
*                                      VAL MINUTES                   */
*                                                                  0073
         B     @RC00067                                            0073
@RF00067 L     @10,@PC00001+12                                     0073
         L     @10,MFPCCOA(,@10)                                   0073
         LH    @08,MFCOSTPV(,@10)                                  0073
         SH    @08,MFCOINTV(,@10)                                  0073
         STH   @08,MFCOSTPV(,@10)                                  0073
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE STIMER. FIRST, CALCULATE TOD VALUE FOR END OF INTERVAL, */
*   /* IN DTTODEOI                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0074
*   DTDWORD=MFPCTDSI;               /* START OF INTERVAL.            */
@RC00067 L     @10,@PC00001+12                                     0074
         MVC   DTDWORD(8),MFPCTDSI(@10)                            0074
*   DTDWORD2=MFPCMINT;              /* LENGTH OF INTERVAL.           */
*                                                                  0075
         MVC   DTDWORD2(8),MFPCMINT(@10)                           0075
*   /*****************************************************************/
*   /*                                                               */
*   /* ?DTDWDADD(DTDWORD,DTDWORD2,DTTODEOI), DOUBLE WORD             */
*   /* ARITHMETIC:DTDWORD + DTDWORD2 = DTTODEOI. MACDATE Y-2 73018   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0076
*   RESPECIFY                                                      0076
*    (GPR00P,                                                      0076
*     GPR01P,                                                      0076
*     GPR14P,                                                      0076
*     GPR15P) RESTRICTED;                                          0076
*   GEN REFS(DTDWORD,DTDWORD2) SETS(DTTODEOI);                     0077
*                                                                  0077
         LM    @14,@15,DTDWORD           GET A DOUBLE WORD
         AL    @15,DTDWORD2+4            TREAT LOW ORDER WORDS
         BC    12,DTM0020                CHECK FOR CARRY BIT
         LA    @01,1                     CARRY BIT
         ALR   @14,@01                   TREAT LOW BIT OF HIGH WORD
DTM0020  DS    0H                   AFTER CARRY BIT ARITHMETIC
         AL    @14,DTDWORD2              TREAT HIGH ORDER WORDS
         STM   @14,@15,DTTODEOI          STORE RESULTS
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0078
*   RESPECIFY                                                      0078
*    (GPR00P,                                                      0078
*     GPR01P,                                                      0078
*     GPR14P,                                                      0078
*     GPR15P) UNRESTRICTED;                                        0078
*                                                                  0078
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THIS TIME (OF END OF NEXT INTERVAL) IS LESS THAN THE       */
*   /* CURRENT TIME OF DAY, FLAG 'MACHINE STOPPED' AND GO TO DT001 TO*/
*   /* PRODUCE AN INTERVAL LENGTH GREATER THAN ZERO. OTHERWISE TEST  */
*   /* FOR TOD CLOCK RESET. FIRST, GET CURRENT TOD CLOCK VALUE.      */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0079
*   RESPECIFY                                                      0079
*    (GPR00P,                                                      0079
*     GPR01P,                                                      0079
*     GPR14P,                                                      0079
*     GPR15P) RESTRICTED;                                          0079
*   GEN SETS(DTTODNOW,DT24SI);                                     0080
*                                                                  0080
         TIME  MIC,DT24SI           24 HOUR CURRENT TIME OF DAY.
         TIME  STCK,DTTODNOW        CURRENT TOD CLOCK VALUE.
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0081
*   RESPECIFY                                                      0081
*    (GPR00P,                                                      0081
*     GPR01P,                                                      0081
*     GPR14P,                                                      0081
*     GPR15P) UNRESTRICTED;                                        0081
*                                                                  0081
*   /*****************************************************************/
*   /*                                                               */
*   /* NEXT, CALCULATE REMAINING INTERVAL LENGTH, IN DTMIC .         */
*   /* ?DTDWDSUB(DTTODEOI,DTTODNOW,DTMIC), DOUBLE WORD               */
*   /* ARITHMETIC:DTTODEOI - DTTODNOW = DTMIC. MACDATE Y-2 73018     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0082
*   RESPECIFY                                                      0082
*    (GPR00P,                                                      0082
*     GPR01P,                                                      0082
*     GPR14P,                                                      0082
*     GPR15P) RESTRICTED;                                          0082
*   GEN REFS(DTTODEOI,DTTODNOW) SETS(DTMIC);                       0083
*                                                                  0083
         LM    @14,@15,DTTODEOI           GET A DOUBLE WORD
         SL    @15,DTTODNOW+4            TREAT LOW ORDER WORDS
         BC    03,DTM0025                CHECK FOR BORROW BIT
         LA    @01,1                     BORROW BIT
         SLR   @14,@01                   TREAT LOW BIT OF HIGH WORD
DTM0025  DS    0H                   AFTER BORROW BIT ARITHMETIC
         SL    @14,DTTODNOW              TREAT HIGH ORDER WORDS
         STM   @14,@15,DTMIC          STORE RESULTS
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0084
*   RESPECIFY                                                      0084
*    (GPR00P,                                                      0084
*     GPR01P,                                                      0084
*     GPR14P,                                                      0084
*     GPR15P) UNRESTRICTED;                                        0084
*   IF DTMIC(1)>='80'X THEN         /* IF TIME REMAINING IS NEGATIVE */
         CLI   DTMIC,X'80'                                         0085
         BL    @RF00085                                            0085
*     DO;                                                          0086
*       DTMASTOP=CSET;              /* FLAG 'MACHINE HAS STOPPED'    */
         OI    DTMASTOP,B'10000000'                                0087
*       MFPCTDSI=DTTODEOI;          /* ADVANCE START OF NEXT INTERVAL
*                                      TIME                          */
         L     @10,@PC00001+12                                     0088
         MVC   MFPCTDSI(8,@10),DTTODEOI                            0088
*       GOTO DT001;                 /* TRY TO MEASURE DATA FOR     0089
*                                      ANOTHER INTERVAL.             */
         B     DT001                                               0089
*     END;                                                         0090
*   IF MFPCMINT<DTMIC               /* IF NEXT INTERVAL IS TOO BIG 0091
*                                      (I.E. TOD CLOCK CHANGED SINCE
*                                      LAST INTERVAL S EXECUTION)    */
*       ×DTMASTOP=CSET              /* OR AN INTERVAL HAS BEEN MISSED
*                                      DUE TO 'STOPPED MACHINE'      */
*     THEN                          /* RESET START-OF-INTERVAL BASE  */
@RF00085 L     @10,@PC00001+12                                     0091
         CLC   MFPCMINT(8,@10),DTMIC                               0091
         BL    @RT00091                                            0091
         TM    DTMASTOP,B'10000000'                                0091
         BNO   @RF00091                                            0091
@RT00091 DS    0H                                                  0092
*     DO;                                                          0092
*       DTMASTOP=CLEAR;             /* CLEAR 'MACHINE STOPPED' FLAG  */
         NI    DTMASTOP,B'01111111'                                0093
*       MFPCTDSI=DTTODNOW;          /* START-OF-INTERVAL BASE VALUE
*                                      IS RESET TO NOW, TO         0094
*                                      SYNCHRONIZE INTERVAL START  0094
*                                      TIME TO ACTIVE CPU TIME.      */
         L     @10,@PC00001+12                                     0094
         MVC   MFPCTDSI(8,@10),DTTODNOW                            0094
*       DTMIC=MFPCMINT;             /* TIME TO NEXT INTERVAL.        */
*                                                                  0095
         MVC   DTMIC(8),MFPCMINT(@10)                              0095
*       /*************************************************************/
*       /*                                                           */
*       /* START OF INTERVAL + LENGTH = END OF INTERVAL.             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0096
*       DTDWORD=MFPCTDSI;           /* START OF INTERVAL.            */
         MVC   DTDWORD(8),MFPCTDSI(@10)                            0096
*       DTDWORD2=MFPCMINT;          /* LENGTH OF INTERVAL.           */
*                                                                  0097
         MVC   DTDWORD2(8),MFPCMINT(@10)                           0097
*       /*************************************************************/
*       /*                                                           */
*       /* ?DTDWDADD(DTDWORD,DTDWORD2,DTTODEOI), DOUBLE WORD         */
*       /* ARITHMETIC:DTDWORD + DTDWORD2 = DTTODEOI. MACDATE Y-2     */
*       /* 73018                                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0098
*       RESPECIFY                                                  0098
*        (GPR00P,                                                  0098
*         GPR01P,                                                  0098
*         GPR14P,                                                  0098
*         GPR15P) RESTRICTED;                                      0098
*       GEN REFS(DTDWORD,DTDWORD2) SETS(DTTODEOI);                 0099
*                                                                  0099
         LM    @14,@15,DTDWORD           GET A DOUBLE WORD
         AL    @15,DTDWORD2+4            TREAT LOW ORDER WORDS
         BC    12,DTM0028                CHECK FOR CARRY BIT
         LA    @01,1                     CARRY BIT
         ALR   @14,@01                   TREAT LOW BIT OF HIGH WORD
DTM0028  DS    0H                   AFTER CARRY BIT ARITHMETIC
         AL    @14,DTDWORD2              TREAT HIGH ORDER WORDS
         STM   @14,@15,DTTODEOI          STORE RESULTS
*       /*************************************************************/
*       /*                                                           */
*       /* MACDATE Y-2 73018                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0100
*       RESPECIFY                                                  0100
*        (GPR00P,                                                  0100
*         GPR01P,                                                  0100
*         GPR14P,                                                  0100
*         GPR15P) UNRESTRICTED;                                    0100
*     END;                                                         0101
*   DTSTIECB=CLEARECB;              /* STIMER ECB IS INIT. FOR USE   */
*                                                                  0102
@RF00091 SLR   @10,@10                                             0102
         ST    @10,DTSTIECB                                        0102
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0103
*   RESPECIFY                                                      0103
*    (GPR00P,                                                      0103
*     GPR01P,                                                      0103
*     GPR14P,                                                      0103
*     GPR15P) RESTRICTED;                                          0103
*   GEN REFS(DTMIC);                                               0104
*                                                                  0104
         STIMER REAL,DTPOSAPL,MICVL=DTMIC
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0105
*   RESPECIFY                                                      0105
*    (GPR00P,                                                      0105
*     GPR01P,                                                      0105
*     GPR14P,                                                      0105
*     GPR15P) UNRESTRICTED;                                        0105
*                                                                  0105
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE LAST WAIT-LIST STORAGE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0106
*   IF MFPCELAD^=0 THEN             /* IF AN ECB LIST EXISTS, DO     */
         L     @10,@PC00001+12                                     0106
         L     @08,MFPCELAD(,@10)                                  0106
         LTR   @08,@08                                             0106
         BZ    @RF00106                                            0106
*     DO;                                                          0107
*                                                                  0107
*       /*************************************************************/
*       /*                                                           */
*       /* MACDATE Y-2 73018                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0108
*       RESPECIFY                                                  0108
*        (GPR00P,                                                  0108
*         GPR01P,                                                  0108
*         GPR14P,                                                  0108
*         GPR15P) RESTRICTED;                                      0108
*       GPR00F=MFPCELGM;            /* STORAGE SUBPOOL AND LENGTH    */
         L     GPR00F,MFPCELGM(,@10)                               0109
*       GPR01P=MFPCELAD;            /* STORAGE ADDRESS               */
         LR    GPR01P,@08                                          0110
*       GEN;                                                       0111
*                                                                  0111
         FREEMAIN R,LV=(0),A=(1)    FREE ECB-LIST STORAGE
*       /*************************************************************/
*       /*                                                           */
*       /* MACDATE Y-2 73018                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0112
*       RESPECIFY                                                  0112
*        (GPR00P,                                                  0112
*         GPR01P,                                                  0112
*         GPR14P,                                                  0112
*         GPR15P) UNRESTRICTED;                                    0112
*     END;                                                         0113
*                                                                  0113
*   /*****************************************************************/
*   /*                                                               */
*   /* GET STORAGE FOR WAIT LIST OF ECB ADDRESSES                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0114
*   MFPCELLE=(MFSQNUMB+2)*LENGTH(DTECB);/* SET GETMAINED SIZE FOR ONE
*                                      ECB FOR EACH SUBTASK PLUS ONE
*                                      FOR EACH OF STOP COMMAND AND
*                                      STIMER EXIT                   */
*                                                                  0114
@RF00106 L     @10,@PC00001+12                                     0114
         L     @08,MFPCSQU(,@10)                                   0114
         LA    @15,2                                               0114
         AL    @15,MFSQNUMB(,@08)                                  0114
         SLA   @15,2                                               0114
         STCM  @15,7,MFPCELLE(@10)                                 0114
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0115
*   RESPECIFY                                                      0115
*    (GPR00P,                                                      0115
*     GPR01P,                                                      0115
*     GPR14P,                                                      0115
*     GPR15P) RESTRICTED;                                          0115
*   GPR00F=MFPCELGM;                /* STORAGE SUBPOOL AND LENGTH    */
         L     GPR00F,MFPCELGM(,@10)                               0116
*   GEN;                                                           0117
         GETMAIN R,LV=(0)           GET STORAGE FOR ECB LIST
*   MFPCELAD=GPR01P;                /* SAVE STORAGE AREA             */
*                                                                  0118
         L     @10,@PC00001+12                                     0118
         ST    GPR01P,MFPCELAD(,@10)                               0118
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0119
*   RESPECIFY                                                      0119
*    (GPR00P,                                                      0119
*     GPR01P,                                                      0119
*     GPR14P,                                                      0119
*     GPR15P) UNRESTRICTED;                                        0119
*                                                                  0119
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ECB ADDRESSES IN ECB LIST                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0120
*   DTECBADD(1)=MFPCSEAD;           /* STOP COMMAND ECB ADDRESS      */
         L     @08,@PC00001+12                                     0120
         L     @08,MFPCELAD(,@08)                                  0120
         L     @10,MFPCSEAD(,@10)                                  0120
         ST    @10,DTECBADD(,@08)                                  0120
*   DTECBADD(2)=ADDR(DTSTIECB);     /* STIMER 'POP' ECB ADDRESS      */
         LA    @10,DTSTIECB                                        0121
         ST    @10,DTECBADD+4(,@08)                                0121
*DT050:                             /* SET UP SUBTASK ECB ADDR. LIST */
*   DTSELPTR=MFSQFRST;              /* GET FIRST SUBTASK QUEUE     0122
*                                      ELEMENT FROM THE QUEUE      0122
*                                      DIRECTOR.                     */
DT050    L     @10,@PC00001+12                                     0122
         L     @10,MFPCSQU(,@10)                                   0122
         L     @10,MFSQFRST(,@10)                                  0122
         ST    @10,DTSELPTR                                        0122
*   DO I=3 BY 1 WHILE(DTSELPTR^=0); /* FILL IN SUBTASK ECB ADDRESSES
*                                      NEXT FOR AS MANY SUBTASKS AS
*                                      EXIST.                        */
         LA    I,3                                                 0123
         B     @DE00123                                            0123
@DL00123 DS    0H                                                  0124
*     DTECBADD(I)=ADDR(MFSESECB);   /* SUBTASK TERMINATION ECB ADDR. */
         LR    @10,I                                               0124
         SLA   @10,2                                               0124
         L     @08,@PC00001+12                                     0124
         L     @08,MFPCELAD(,@08)                                  0124
         L     @03,DTSELPTR                                        0124
         LA    @15,MFSESECB(,@03)                                  0124
         AL    @08,@CF00322                                        0124
         ST    @15,DTECBADD(@10,@08)                               0124
*     DTSELPTR=MFSENEXT;            /* GET NEXT SUBTASK QUEUE ELEMENT*/
         L     @10,MFSENEXT(,@03)                                  0125
         ST    @10,DTSELPTR                                        0125
*   END;                                                           0126
         AL    I,@CF00057                                          0126
@DE00123 L     @10,DTSELPTR                                        0126
         LTR   @10,@10                                             0126
         BNZ   @DL00123                                            0126
*   DTECBEOL(I-1)='1'B;             /* SET END OF ECB LIST FLAG      */
*                                                                  0127
         LR    @10,I                                               0127
         SLA   @10,2                                               0127
         L     @08,@PC00001+12                                     0127
         L     @08,MFPCELAD(,@08)                                  0127
         ALR   @10,@08                                             0127
         AL    @10,@CF00375                                        0127
         OI    DTECBEOL(@10),B'10000000'                           0127
*   /*****************************************************************/
*   /*                                                               */
*   /* WAIT FOR ONE OF THESE ECB S TO BE POSTED MACDATE Y-2 73018    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0128
*   RESPECIFY                                                      0128
*    (GPR00P,                                                      0128
*     GPR01P,                                                      0128
*     GPR14P,                                                      0128
*     GPR15P) RESTRICTED;                                          0128
*   GPR01P=MFPCELAD;                /* ECB LIST ADDRESS              */
         LR    GPR01P,@08                                          0129
*   GEN REFS(MFPCELAD);                                            0130
*                                                                  0130
         WAIT  1,ECBLIST=(GPR01P),LONG=YES
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0131
*   RESPECIFY                                                      0131
*    (GPR00P,                                                      0131
*     GPR01P,                                                      0131
*     GPR14P,                                                      0131
*     GPR15P) UNRESTRICTED;                                        0131
*                                                                  0131
*   /*****************************************************************/
*   /*                                                               */
*   /* AN ECB HAS BEEN POSTED. ONE OF 3 CONDITIONS HAS OCCURRED: 1.  */
*   /* OPERATOR HAS ISSUED A STOP COMMAND. 2. A SYSTEM ACTIVITY      */
*   /* REPORT GENERATOR (SARG) SUBTASK HAS TERMINATED. 3. THE STIMER */
*   /* HAS POPPED,THE END OF AN MF/1 MEASUREMENT INTERVAL HAS BEEN   */
*   /* REACHED.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0132
*   IF MFPCSEAD->DTECPOST=CPOSTED THEN/* IF STOP COMMAND ISSUED,     */
         L     @10,@PC00001+12                                     0132
         L     @10,MFPCSEAD(,@10)                                  0132
         TM    DTECPOST(@10),B'01000000'                           0132
         BNO   @RF00132                                            0132
*     DO;                           /* EXTRACT CIB VERB              */
*                                                                  0133
*       /*************************************************************/
*       /*                                                           */
*       /* MACDATE Y-2 73018                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0134
*       RESPECIFY                                                  0134
*        (GPR00P,                                                  0134
*         GPR01P,                                                  0134
*         GPR14P,                                                  0134
*         GPR15P) RESTRICTED;                                      0134
*       GEN REFS(DTEXTAPL) SETS(DTCSCLA);                          0135
*                                                                  0135
         EXTRACT DTCSCLA,MF=(E,DTEXTAPL) GET CIB ADDRESS
*       /*************************************************************/
*       /*                                                           */
*       /* MACDATE Y-2 73018                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0136
*       RESPECIFY                                                  0136
*        (GPR00P,                                                  0136
*         GPR01P,                                                  0136
*         GPR14P,                                                  0136
*         GPR15P) UNRESTRICTED;                                    0136
*       CIBPTR=DTCSCIB;             /* SET POINTER TO FIRST CIB      */
         L     @10,DTCSCLA                                         0137
         L     CIBPTR,DTCSCIB(,@10)                                0137
*DT055:                                                            0138
*       IF CIBVERB=CSTOP THEN       /* IF STOP COMMAND               */
DT055    CLI   CIBVERB(CIBPTR),X'40'                               0138
         BNE   @RF00138                                            0138
*         DO;                                                      0139
*           DTOPSTOP=CSET;          /* STOP AFTER THIS MEASUREMENT.  */
         OI    DTOPSTOP,B'10000000'                                0140
*         END;                                                     0141
*       ELSE                        /* IF THIS COMMAND NOT STOP      */
*         DO;                                                      0142
         B     @RC00138                                            0142
@RF00138 DS    0H                                                  0143
*           IF CIBPTR^=0 THEN       /* IF NOT LAST CIB               */
         LTR   CIBPTR,CIBPTR                                       0143
         BZ    @RF00143                                            0143
*             DO;                                                  0144
*               CIBPTR=CIBNEXT;     /* LOOK FOR ANOTHER CIB          */
         L     CIBPTR,CIBNEXT(,CIBPTR)                             0145
*               GOTO DT055;                                        0146
         B     DT055                                               0146
*             END;                                                 0147
*         END;                                                     0148
@RF00143 DS    0H                                                  0149
*     END;                                                         0149
@RC00138 DS    0H                                                  0150
*                                                                  0150
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOK AT ALL SUBTASKS                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0150
*   DTSELPTR=MFSQFRST;              /* GET FIRST SUBTASK QUEUE     0150
*                                      ELEMENT FROM THE QUEUE      0150
*                                      DIRECTOR.                     */
@RF00132 L     @10,@PC00001+12                                     0150
         L     @10,MFPCSQU(,@10)                                   0150
         L     @08,MFSQFRST(,@10)                                  0150
         ST    @08,DTSELPTR                                        0150
*   DTSELLST=ADDR(MFSQFRST)-MFSELINK;/* SET 'LAST' ELEMENT POINTER 0151
*                                      FOR DEQUEUEING                */
         LA    DTSELLST,MFSQFRST(,@10)                             0151
*DT060:                             /* TOP OF LOOP ON ALL SUBTASKS   */
*   DO WHILE(DTSELPTR^=0);          /* FOR ALL EXISTING SUBTASKS,    */
DT060    B     @DE00152                                            0152
@DL00152 DS    0H                                                  0153
*     RFY                                                          0153
*       DTECB BASED(ADDR(MFSESECB));/* USE ECB FLAG DEFINITION FOR 0153
*                                      SUBTASK ECB                   */
*     IF DTECPOST=CPOSTED THEN      /* IF SUBTASK HAS TERMINATED, DO */
         L     @10,DTSELPTR                                        0154
         LA    @08,20                                              0154
         ALR   @08,@10                                             0154
         TM    DTECPOST(@08),B'01000000'                           0154
         BNO   @RF00154                                            0154
*       DO;                                                        0155
*         IF DTECCODE^=0            /* IF ABNORMAL SUBTASK COMPLETION*/
*             &MFSESTID>MFPCALST    /* AND SYSOUT ALLOCATION NOT   0156
*                                      COMPLETED                     */
*           THEN                                                   0156
         L     @08,DTECCODE-1(,@08)                                0156
         LA    @08,0(,@08)                                         0156
         LTR   @08,@08                                             0156
         BZ    @RF00156                                            0156
         L     @10,MFSESTID(,@10)                                  0156
         L     @08,@PC00001+12                                     0156
         CL    @10,MFPCALST(,@08)                                  0156
         BNH   @RF00156                                            0156
*           MFPCALST=MFSESTID;      /* ALLOW NEXT SUBTASK TO ALLOCATE*/
*                                                                  0157
         ST    @10,MFPCALST(,@08)                                  0157
*         /***********************************************************/
*         /*                                                         */
*         /* DETACH A NORMALLY COMPLETED SARG SUBTASK                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0158
*         DTTEMPAL=MFSESTAD;        /* SUBTASK TCB ADDRESS           */
*                                                                  0158
@RF00156 L     @10,DTSELPTR                                        0158
         L     @10,MFSESTAD(,@10)                                  0158
         ST    @10,DTTEMPAL                                        0158
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0159
*         RESPECIFY                                                0159
*          (GPR00P,                                                0159
*           GPR01P,                                                0159
*           GPR14P,                                                0159
*           GPR15P) RESTRICTED;                                    0159
*         GEN REFS(MFSESTAD,DTTEMPAL)(DETACH DTTEMPAL,STAE=NO);    0160
*                                                                  0160
         DETACH DTTEMPAL,STAE=NO
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0161
*         RESPECIFY                                                0161
*          (GPR00P,                                                0161
*           GPR01P,                                                0161
*           GPR14P,                                                0161
*           GPR15P) UNRESTRICTED;                                  0161
*                                                                  0161
*         /***********************************************************/
*         /*                                                         */
*         /* DEQUEUE THE SUBTASK ELEMENT, LAST ELEMENT-> NEXT ONE.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0162
*         IF DTSELPTR=MFSQLAST THEN /* IF THIS IS LAST ELEMENT IN  0162
*                                      QUEUE                         */
         L     @10,@PC00001+12                                     0162
         L     @10,MFPCSQU(,@10)                                   0162
         CLC   DTSELPTR(4),MFSQLAST(@10)                           0162
         BNE   @RF00162                                            0162
*           MFSQLAST=DTSELLST;      /* END OF QUEUE IS PRECEDING   0163
*                                      ELEMENT                       */
         ST    DTSELLST,MFSQLAST(,@10)                             0163
*         MFSQNUMB=MFSQNUMB-CSELQINC;/* REDUCE Q ELEMENT COUNT       */
@RF00162 L     @10,@PC00001+12                                     0164
         L     @10,MFPCSQU(,@10)                                   0164
         L     @08,MFSQNUMB(,@10)                                  0164
         BCTR  @08,0                                               0164
         ST    @08,MFSQNUMB(,@10)                                  0164
*         DTSELLST->MFSENEXT=DTSELPTR->MFSENEXT;/* REMOVE IT.        */
*                                                                  0165
         L     @08,DTSELPTR                                        0165
         L     @08,MFSENEXT(,@08)                                  0165
         ST    @08,MFSENEXT(,DTSELLST)                             0165
*         /***********************************************************/
*         /*                                                         */
*         /* FREE REMOVED ELEMENT S MAIN STORAGE. MACDATE Y-2 73018  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0166
*         RESPECIFY                                                0166
*          (GPR00P,                                                0166
*           GPR01P,                                                0166
*           GPR14P,                                                0166
*           GPR15P) RESTRICTED;                                    0166
*         GPR00F=MFSQSTOR;          /* MFSEL SUBPOOL NO. & LENGTH    */
         L     GPR00F,MFSQSTOR(,@10)                               0167
*         DTEMPF=MFSENEXT;          /* SAVE NEXT ELEMENT ADDRESS     */
         LR    DTEMPF,@08                                          0168
*         GEN REFS(DTSELPTR);                                      0169
*                                                                  0169
           FREEMAIN R,LV=(0),A=DTSELPTR
*         /***********************************************************/
*         /*                                                         */
*         /* MACDATE Y-2 73018                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0170
*         RESPECIFY                                                0170
*          (GPR00P,                                                0170
*           GPR01P,                                                0170
*           GPR14P,                                                0170
*           GPR15P) UNRESTRICTED;                                  0170
*         DTSELPTR=DTEMPF;          /* KEEP NEXT ELEMENT ADDRESS     */
         ST    DTEMPF,DTSELPTR                                     0171
*       END;                                                       0172
*     ELSE                          /* ELSE                          */
*       DO;                         /* GET NEXT ELEMENT IN QUEUE     */
         B     @RC00154                                            0173
@RF00154 DS    0H                                                  0174
*         DTSELLST=DTSELPTR;        /* REMEMBER THIS ELEMENT         */
         L     @10,DTSELPTR                                        0174
         LR    DTSELLST,@10                                        0174
*         DTSELPTR=MFSENEXT;        /* GET NEXT ELEMENT ADDRESS      */
         L     @10,MFSENEXT(,@10)                                  0175
         ST    @10,DTSELPTR                                        0175
*       END;                                                       0176
*   END DT060;                                                     0177
@RC00154 DS    0H                                                  0177
@DE00152 L     @10,DTSELPTR                                        0177
         LTR   @10,@10                                             0177
         BNZ   @DL00152                                            0177
*                                                                  0178
*   /*****************************************************************/
*   /*                                                               */
*   /* STIMEP 'POP' CHECK                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0178
*   RFY                                                            0178
*     DTECB BASED(ADDR(DTSTIECB));  /* USE ECB FLAG DEFINITION FOR 0178
*                                      STIMER EXIT ECB               */
*   IF DTECPOST=CPOSTED             /* IF STIMER HAS 'POP'ED,        */
*       ×DTOPSTOP=CSET              /* OR STOPPED BY CONSOLE OPERATOR*/
*     THEN                          /* THEN PRODUCE MEASUREMENTS.    */
         LA    @10,DTSTIECB                                        0179
         TM    DTECPOST(@10),B'01000000'                           0179
         BO    @RT00179                                            0179
         TM    DTOPSTOP,B'10000000'                                0179
         BNO   @RF00179                                            0179
@RT00179 DS    0H                                                  0180
*     DO;                                                          0180
*                                                                  0180
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MFDATA SVC. IT COLLECTS MEASUREMENTS ESTABLISHED BY */
*       /* MFSTART SVC (IGX00013), WHICH GAVE CONTROL TO THIS MODULE,*/
*       /* DATA CONTROL (IRBMFDTA), VIA THE SYNCH MACRO. MEASURE-    */
*       /* MENT OF DATA IS FROM TIME OF LAST MFDATA SVC, OR FROM     */
*       /* INITIAL MFDATA CALL JUST BEFORE THE SYNCH WAS DONE.       */
*       /* MACDATE Y-2 73018                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0181
*       RESPECIFY                                                  0181
*        (GPR00P,                                                  0181
*         GPR01P,                                                  0181
*         GPR14P,                                                  0181
*         GPR15P) RESTRICTED;                                      0181
*       GPR15F=14;                  /* MFDATA IS TYPE 3 ESR CODE 14  */
         LA    GPR15F,14                                           0182
*       SVC(109);                   /* EXTENDED SVC ROUTER (ESR),  0183
*                                      TYPE 3 SVC                    */
         SVC   109                                                 0183
*       DTSVCCOD=GPR15F;            /* SAVE SVC MFDATA RETURN CODE   */
         LR    DTSVCCOD,GPR15F                                     0184
*       DTSVCPTR=GPR01P;            /* SAVE MVT PTR OF MEASUREMENTS  */
*                                                                  0185
         LR    DTSVCPTR,GPR01P                                     0185
*       /*************************************************************/
*       /*                                                           */
*       /* MACDATE Y-2 73018                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0186
*       RESPECIFY                                                  0186
*        (GPR00P,                                                  0186
*         GPR01P,                                                  0186
*         GPR14P,                                                  0186
*         GPR15P) UNRESTRICTED;                                    0186
*                                                                  0186
*       /*************************************************************/
*       /*                                                           */
*       /* ATTACH A SARG SUBTASK TO FORMAT REPORTS                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0187
*       IF DTSVCCOD^=0 THEN         /* IF NO MEASUREMENTS MADE, ABEND*/
         LTR   DTSVCCOD,DTSVCCOD                                   0187
         BZ    @RF00187                                            0187
*         DO;                                                      0188
*           DTREASON=DTSVCCOD;      /* ABEND REASON CODE.            */
         LR    DTREASON,DTSVCCOD                                   0189
*           DTABCODE=CNOMEAS;       /* SET ABEND CODE                */
         MVC   DTABCODE(4),@CF00325                                0190
*           GOTO DT900;             /* ABEND                         */
         B     DT900                                               0191
*         END;                                                     0192
*       IF MFCOREPV=CDEFER×         /* IF REPORTS ARE DEFERRED OR    */
*           MFCOREPV=CREALTIM       /* IF REPORTS ARE REALTIME, DO   */
*         THEN                                                     0193
@RF00187 L     @10,@PC00001+12                                     0193
         L     @10,MFPCCOA(,@10)                                   0193
         TM    MFCOREPV(@10),B'00000001'                           0193
         BNO   @GL00006                                            0193
         TM    MFCOREPV(@10),B'00000010'                           0193
         BZ    @RT00193                                            0193
@GL00006 L     @10,@PC00001+12                                     0193
         L     @10,MFPCCOA(,@10)                                   0193
         TM    MFCOREPV(@10),B'00000010'                           0193
         BNO   @RF00193                                            0193
         TM    MFCOREPV(@10),B'00000001'                           0193
         BNZ   @RF00193                                            0193
@RT00193 DS    0H                                                  0194
*         DO;                                                      0194
*                                                                  0194
*           /*********************************************************/
*           /*                                                       */
*           /* BUILD A SUBTASK QUEUE ELEMENT MACDATE Y-2 73018       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0195
*           RESPECIFY                                              0195
*            (GPR00P,                                              0195
*             GPR01P,                                              0195
*             GPR14P,                                              0195
*             GPR15P) RESTRICTED;                                  0195
*           GPR00F=MFSQSTOR;        /* SUBPOOL AND LENGTH OF GETMAIN
*                                      FOR MFSEL                     */
         L     @10,@PC00001+12                                     0196
         L     @10,MFPCSQU(,@10)                                   0196
         L     GPR00F,MFSQSTOR(,@10)                               0196
*           GEN(GETMAIN R,LV=(0));  /* GET MAIN STORAGE FOR MFSEL    */
         GETMAIN R,LV=(0)
*           DTSELPTR=GPR01P;        /* SAVE STORAGE AS NEW MFSEL   0198
*                                      ELEMENT                       */
*                                                                  0198
         ST    GPR01P,DTSELPTR                                     0198
*           /*********************************************************/
*           /*                                                       */
*           /* MACDATE Y-2 73018                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0199
*           RESPECIFY                                              0199
*            (GPR00P,                                              0199
*             GPR01P,                                              0199
*             GPR14P,                                              0199
*             GPR15P) UNRESTRICTED;                                0199
*                                                                  0199
*           /*********************************************************/
*           /*                                                       */
*           /* ATTACHED SUBTASK, IRBMFRGM, HAS FOLLOWING ATTRIBUTES: */
*           /* 1. ITS TERMINATION IS POSTED IN AN ECB, AND IT MUST BE*/
*           /* DETACHED. 2. ITS SP0 IS NOT SHARED WITH THIS TASK. 3. */
*           /* ITS DATA SP IS GIVEN TO IT.                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0200
*           MFSECOA=ADDR(MFCOA);    /* COA IS INPUT TO IRBMFRGM      */
         L     @10,DTSELPTR                                        0200
         L     @15,@PC00001+12                                     0200
         L     @14,MFPCCOA(,@15)                                   0200
         ST    @14,MFSECOA(,@10)                                   0200
*           MFSEDTMV=DTSVCPTR;      /* MEASUREMENTS ARE INPUT TO   0201
*                                      IRBMFRGM                      */
         ST    DTSVCPTR,MFSEDTMV(,@10)                             0201
*           MFSESTID=MFPCSTID;      /* ASSIGN SUBTASK ID             */
         L     @14,MFPCSTID(,@15)                                  0202
         ST    @14,MFSESTID(,@10)                                  0202
*           MFPCSTID=MFPCSTID+CRGMINCR;/* DETERMINE NEXT SUBTASK ID  */
         AL    @14,@CF00057                                        0203
         ST    @14,MFPCSTID(,@15)                                  0203
*           MFSEITOD=DT24SI;        /* INTERVAL START 24 HOUR TIME IS
*                                      INPUT TO IRBMFRGM.            */
         MVC   MFSEITOD(8,@10),DT24SI                              0204
*           MFSEMDCB=MFPCMDCB;      /* MESSAGE-SYSOUT DATA SET DCB IS
*                                      INPUT TO IRBMFRGM             */
         L     @14,MFPCMDCB(,@15)                                  0205
         ST    @14,MFSEMDCB(,@10)                                  0205
*           MFSESECB=CLEARECB;      /* CLEAR ECB FOR USE             */
         SLR   @14,@14                                             0206
         ST    @14,MFSESECB(,@10)                                  0206
*           MFSEFLAG=''B;           /* CLEAR ALL FLAGS               */
*                                                                  0207
         MVI   MFSEFLAG(@10),X'00'                                 0207
*           /*********************************************************/
*           /*                                                       */
*           /* SET ATTACH PROBLEM PROGRAM PARAMETERS                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0208
*           MFSESEL=ADDR(MFSEL);    /* ADDRESS OF SUBTASK QUEUE    0208
*                                      ELEMENT                       */
         ST    @10,MFSESEL(,@10)                                   0208
*           MFSEALST=ADDR(MFPCALST);/* ADDRESS OF NUMBER OF LAST   0209
*                                      SUBTASK ID TO ALLOCATE REPORT
*                                      SYSOUT SPACE                  */
         LA    @14,MFPCALST(,@15)                                  0209
         ST    @14,MFSEALST(,@10)                                  0209
*           MFSEMFMV=MFPCMVT;       /* MVT WITH REPORT GENERATOR   0210
*                                      PROGRAM NAMES                 */
*                                                                  0210
         L     @15,MFPCMVT(,@15)                                   0210
         ST    @15,MFSEMFMV(,@10)                                  0210
*           /*********************************************************/
*           /*                                                       */
*           /* SETUP FOR MACRO CALL: ATTACH                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0211
*           RFY                                                    0211
*            (GPR00P,                                              0211
*             GPR01P,                                              0211
*             GPR02P,                                              0211
*             GPR03P,                                              0211
*             GPR14P,                                              0211
*             GPR15P) RSTD;                                        0211
*           GPR03P=ADDR(MFSESECB);  /* SUBTASK ECB ADDRESS FOR     0212
*                                      GENERATE 'ATTACH'             */
         LA    GPR03P,MFSESECB(,@10)                               0212
*           GPR02F=DTMFSP;          /* SHARE DATA SUBPOOL WITH SARG. */
         LR    @07,DTSVCPTR                                        0213
         AL    @07,@CF00322                                        0213
         SLR   GPR02F,GPR02F                                       0213
         IC    GPR02F,DTMFSP(,@07)                                 0213
*           GPR01P=ADDR(MFSEPARM);  /* PROBLEM PROGRAM PARAM'S       */
         LA    GPR01P,MFSEPARM(,@10)                               0214
*           GPR15P=ADDR(DTATTAPL);  /* CONTROL PROGRAM LIST ADDR.    */
         LA    GPR15P,DTATTAPL                                     0215
*           GEN REFS(DTTEMPAL,DTMFSP,MFSEPARM,DTATTAPL);           0216
         ATTACH EP=IRBMFRGM,ECB=(GPR03P),GSPV=(2),MF=(E,(1)),  @ZA00261X
               SF=(E,(15))
*           MFSESTAD=GPR01P;        /* SAVE SUBTASK TCB ADDRESS FROM
*                                      ATTACH MACRO                  */
         L     @10,DTSELPTR                                        0217
         ST    GPR01P,MFSESTAD(,@10)                               0217
*           RFY                                                    0218
*            (GPR00P,                                              0218
*             GPR01P,                                              0218
*             GPR02P,                                              0218
*             GPR03P,                                              0218
*             GPR14P,                                              0218
*             GPR15P) UNRSTD;                                      0218
*                                                                  0218
*           /*********************************************************/
*           /*                                                       */
*           /* PUT SUBTASK ELEMENT IN QUEUE                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0219
*           MFSENEXT=0;             /* NEW ELEMENT IS AT END OF QUEUE*/
         SLR   @08,@08                                             0219
         ST    @08,MFSENEXT(,@10)                                  0219
*           MFSQLAST->MFSENEXT=ADDR(MFSEL);/* ADD ELEMENT TO Q END   */
         L     @08,@PC00001+12                                     0220
         L     @08,MFPCSQU(,@08)                                   0220
         L     @01,MFSQLAST(,@08)                                  0220
         ST    @10,MFSENEXT(,@01)                                  0220
*           MFSQLAST=ADDR(MFSEL);   /* SET LAST ELEMENT POINTER      */
         ST    @10,MFSQLAST(,@08)                                  0221
*           MFSQNUMB=MFSQNUMB+CSELQINC;/* INCR COUNT OF Q ELEMENTS   */
         LA    @10,1                                               0222
         AL    @10,MFSQNUMB(,@08)                                  0222
         ST    @10,MFSQNUMB(,@08)                                  0222
*         END;                      /* END OF ATTACH CODE            */
*       ELSE                        /* IF NO REPORTS FORMATTED       */
*                                                                  0224
*         /***********************************************************/
*         /*                                                         */
*         /* FREE MEASUREMENT STORAGE                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0224
*         DO;                                                      0224
         B     @RC00193                                            0224
@RF00193 DS    0H                                                  0225
*           RFY                                                    0225
*             DTMVT BASED(DTSVCPTR);/* SVC MVT IS CALLED DTMVT       */
*           DO I=1 TO DTMVNUM;      /* FOR ALL MEASUREMENTS          */
         LA    I,1                                                 0226
         B     @DE00226                                            0226
@DL00226 DS    0H                                                  0227
*             IF DTMVADD(I)^=0 THEN /* IF STORAGE EXISTS, FREE IT    */
         LR    @10,I                                               0227
         SLA   @10,2                                               0227
         L     @10,DTMVADD-4(@10,DTSVCPTR)                         0227
         LTR   @10,@10                                             0227
         BZ    @RF00227                                            0227
*               DO;                                                0228
*                                                                  0228
*                 /***************************************************/
*                 /*                                                 */
*                 /* MACDATE Y-2 73018                               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0229
*                 RESPECIFY                                        0229
*                  (GPR00P,                                        0229
*                   GPR01P,                                        0229
*                   GPR14P,                                        0229
*                   GPR15P) RESTRICTED;                            0229
*                 GPR00F=(DTMVADD(I)+CMEASTOR)->DTMFSTOR;/* SP&LENGTH*/
         AL    @10,@CF00322                                        0230
         L     GPR00F,DTMFSTOR(,@10)                               0230
*                 GPR01P=DTMVADD(I)+CMEASTOR;/* STORAGE ADDRESS      */
         LR    GPR01P,@10                                          0231
*                 GEN(FREEMAIN R,LV=(0),A=(1));/* FREEMAIN           */
*                                                                  0232
         FREEMAIN R,LV=(0),A=(1)
*                 /***************************************************/
*                 /*                                                 */
*                 /* MACDATE Y-2 73018                               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0233
*                 RESPECIFY                                        0233
*                  (GPR00P,                                        0233
*                   GPR01P,                                        0233
*                   GPR14P,                                        0233
*                   GPR15P) UNRESTRICTED;                          0233
*               END;                /* END FREEING MVT STORAGE DO    */
*           END;                    /* END LOOP ON MVADD             */
*                                                                  0235
@RF00227 AL    I,@CF00057                                          0235
@DE00226 C     I,DTMVNUM(,DTSVCPTR)                                0235
         BNH   @DL00226                                            0235
*           /*********************************************************/
*           /*                                                       */
*           /* MACDATE Y-2 73018                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0236
*           RESPECIFY                                              0236
*            (GPR00P,                                              0236
*             GPR01P,                                              0236
*             GPR14P,                                              0236
*             GPR15P) RESTRICTED;                                  0236
*           GPR00F=DTMFSTOR;        /* MVT SUBPOOL AND LENGTH        */
         LR    @10,DTSVCPTR                                        0237
         AL    @10,@CF00322                                        0237
         L     GPR00F,DTMFSTOR(,@10)                               0237
*           GPR01P=ADDR(DTMVT)+CMEASTOR;/* MVT ADDRESS               */
         LR    GPR01P,@10                                          0238
*DT200:                                                            0239
*           GEN(FREEMAIN R,LV=(0),A=(1));/* FREE MVT                 */
*                                                                  0239
DT200    FREEMAIN R,LV=(0),A=(1)
*           /*********************************************************/
*           /*                                                       */
*           /* MACDATE Y-2 73018                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0240
*           RESPECIFY                                              0240
*            (GPR00P,                                              0240
*             GPR01P,                                              0240
*             GPR14P,                                              0240
*             GPR15P) UNRESTRICTED;                                0240
*         END;                      /* END ELSE OF IF REPORTS MADE   */
*       MFPCTDSI=DTTODEOI;          /* START OF THIS NEW INTERVAL IS
*                                      END OF INTERVAL JUST EXPIRED. */
@RC00193 L     @10,@PC00001+12                                     0242
         MVC   MFPCTDSI(8,@10),DTTODEOI                            0242
*       GOTO DT000;                 /* RE-ISSUE STIMER FOR NEW     0243
*                                      INTERVAL                      */
         B     DT000                                               0243
*     END;                          /* END IF STIMER POP'ED          */
*                                                                  0244
*   /*****************************************************************/
*   /*                                                               */
*   /* STIMER HAS NOT POP'ED, BUT A SUBTASK HAS TERMINATED           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0245
*   GOTO DT050;                     /* RE-ESTABLISH WAIT LIST OF   0245
*                                      SUBTASK ECB'S.                */
         B     DT050                                               0245
*                                                                  0246
*/* PROGRAM ERROR: ABEND                                             */
*                                                                  0246
*DT900:                                                            0246
*                                                                  0246
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0246
*   RESPECIFY                                                      0246
*    (GPR00P,                                                      0246
*     GPR01P,                                                      0246
*     GPR14P,                                                      0246
*     GPR15P) RESTRICTED;                                          0246
DT900    DS    0H                                                  0247
*   GPR01P=DTABCODE;                /* ABEND CODE                    */
         ICM   GPR01P,15,DTABCODE                                  0247
*   GPR15P=DTREASON;                /* ABEND REASON CODE.            */
         LR    GPR15P,DTREASON                                     0248
*   GEN;                                                           0249
*                                                                  0249
         ABEND (01),DUMP
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73018                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0250
*   RESPECIFY                                                      0250
*    (GPR00P,                                                      0250
*     GPR01P,                                                      0250
*     GPR14P,                                                      0250
*     GPR15P) UNRESTRICTED;                                        0250
*   END IRBMFDTA                                                   0251
*                                                                  0251
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IRBMFMID)                                       */
*/*%INCLUDE SYSLIB  (IEZCIB  )                                       */
*                                                                  0251
*       ;                                                          0251
         B     @EL00001                                            0251
@DATA    DS    0H
@CH00333 DC    H'60'
         DS    0F
@AL00040 DC    A(@CF00057)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CF00153)
         DC    A(@CF00153)
         DC    A(@CF00153)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    4F
IRBMFDTA CSECT
         DS    0F
@CF00153 DC    F'0'
@CF00057 DC    F'1'
@CF00325 DC    F'1201'
@CF00375 DC    F'-8'
@CF00322 DC    F'-4'
@DATD    DSECT
         DS    0D
DTSELPTR DS    A
DTCSCLA  DS    A
DTTEMPAL DS    F
DTABCODE DS    BL4
DTDWORD  DS    CL8
DTDWORD2 DS    CL8
DTMASTOP DS    BL1
         DS    CL7
DTMIC    DS    CL8
DTOPSTOP DS    BL1
         DS    CL7
DTTODEOI DS    CL8
DTTODNOW DS    CL8
DT24SI   DS    CL8
DTATTAPL DS    CL60
DTESTAPL DS    CL16
DTEXTAPL DS    CL16
IRBMFDTA CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
DTPATCH  DS    CL100
IRBMFDTA CSECT
*                                   /* ESTAE COVERING DATA CONTROL   */
DTESTSPL ESTAE IRBMFDEA,RECORD=YES,MF=L
         EXTRN IRBMFDEA
IRBMFDTA CSECT
DTEXTSPL EXTRACT ,'S',FIELDS=(COMM),MF=L
IRBMFDTA CSECT
DTATTSPL ATTACH EP=IRBMFRGM,SZERO=NO,SF=L
@DATD    DSECT
IRBMFDTA CSECT
DTPOSSPL DS    0H                   POST MACRO STATIC CODE
         STM   @14,@01,12(@13)      TEMPORARY REGISTER SAVE
         BALR  @15,0                BASE REGISTER FOR ECB AT ENTRY
*                                   FROM STIMER EXIT ROUTINE
         USING *,@15
         POST DTSTSECB              POST STIMER ECB
         LM    @14,@01,12(@13)      RESTORE REGISTERS
         BR    @14                  RETURN
DTSTSECB DS    F                    STIMER ECB, FOLLOWS POST EXPANSION
DTPOSEPL EQU   *                    END OF POST
DTPOSLPL EQU   DTPOSEPL-DTPOSSPL    LENGTH OF POST MACRO EXPANSION
         DROP  @15
@DATD    DSECT
@DATD    DSECT
DTPOSAPL DS    0H                   POST MACRO AUTOMATIC STORAGE
         STM   @14,@01,12(@13)
         BALR  @15,0                BASE REGISTER FOR ECB AT ENTRY
         POST  DTSTIECB             POST STIMER EXPIRED ECB
         LM    @14,@01,12(@13)
         BR    @14                  RETURN
DTSTIECB DS    F                    STIMER ECB, FOLLOWS POST EXPANSION
@DATD    DSECT
IRBMFDTA CSECT
DT60MIL  DC    F'60000000'          MICROSECONDS IN 1 MINUTE.
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IRBMFDTA CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
I        EQU   @02
DTSVCCOD EQU   @02
DTSELLST EQU   @03
DTREASON EQU   @03
DTMODEPA EQU   @03
DTSVCPTR EQU   @08
DTINTACC EQU   @09
DTEMPF   EQU   @02
CIBPTR   EQU   @02
GPR00F   EQU   @00
GPR15F   EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR14P   EQU   @14
GPR15P   EQU   @15
GPR02P   EQU   @02
GPR02F   EQU   @02
GPR03P   EQU   @03
GPR01F   EQU   @01
GPR14F   EQU   @14
DTMVT    EQU   0
DTMVNUM  EQU   DTMVT
DTMVOPT  EQU   DTMVT+4
MFCOA    EQU   0
MFCOTCE  EQU   MFCOA
MFCOTCEF EQU   MFCOTCE
MFCOTCEL EQU   MFCOTCE+3
MFCOCYC  EQU   MFCOA+4
MFCOCYCF EQU   MFCOCYC
MFCOOUT  EQU   MFCOA+8
MFCOOUTF EQU   MFCOOUT
MFCOINT  EQU   MFCOA+12
MFCOINTF EQU   MFCOINT
MFCOINTV EQU   MFCOINT+2
MFCOREP  EQU   MFCOA+16
MFCOREPF EQU   MFCOREP
MFCOREPL EQU   MFCOREP+3
MFCOREPV EQU   MFCOREPL
MFCOSTP  EQU   MFCOA+20
MFCOSTPF EQU   MFCOSTP
MFCOSTPS EQU   MFCOSTPF
MFCOSTPU EQU   MFCOSTPF
MFCOSTPV EQU   MFCOSTP+2
MFCOOPI  EQU   MFCOA+24
MFCOOPIF EQU   MFCOOPI
MFCOOPIL EQU   MFCOOPI+3
MFCOMEM  EQU   MFCOA+28
MFCOMEMF EQU   MFCOMEM
MFSEL    EQU   0
MFSENEXT EQU   MFSEL
MFSEPARM EQU   MFSEL+4
MFSESEL  EQU   MFSEPARM
MFSEALST EQU   MFSEPARM+4
MFSEMFMV EQU   MFSEPARM+8
MFSESTAD EQU   MFSEL+16
MFSESECB EQU   MFSEL+20
MFSECOA  EQU   MFSEL+24
MFSEDTMV EQU   MFSEL+28
MFSESTID EQU   MFSEL+32
MFSEITOD EQU   MFSEL+36
MFSEFLAG EQU   MFSEL+47
MFSEMDCB EQU   MFSEL+48
MFSQU    EQU   0
MFSQFRST EQU   MFSQU+4
MFSQLAST EQU   MFSQU+8
MFSQNUMB EQU   MFSQU+12
MFSQSTOR EQU   MFSQU+16
CIBNAME  EQU   0
CIBNEXT  EQU   CIBNAME
CIBVERB  EQU   CIBNAME+4
CIBASID  EQU   CIBNAME+10
DTCSCL   EQU   0
DTCSCIB  EQU   DTCSCL+4
DTECB    EQU   0
DTECFLGS EQU   DTECB
DTECPOST EQU   DTECFLGS
DTECCODE EQU   DTECB+1
DTECBADD EQU   0
DTECBEOL EQU   DTECBADD
DTMFSTOR EQU   0
DTMFSP   EQU   DTMFSTOR
IRBMFMPR EQU   0
IKEBC    EQU   0
IKEBF15  EQU   0
IKEBF31  EQU   0
IKEBP15  EQU   0
IKEBP31  EQU   0
IKEBP8   EQU   0
DUMMY1   EQU   0
DUMMY2   EQU   0
DUMMY3   EQU   0
MFPCT    EQU   0
MFPCMVT  EQU   MFPCT+4
MFPCCOA  EQU   MFPCT+8
MFPCSQU  EQU   MFPCT+12
MFPCMINT EQU   MFPCT+16
MFPCTDSI EQU   MFPCT+24
MFPCELGM EQU   MFPCT+32
MFPCELLE EQU   MFPCELGM+1
MFPCELAD EQU   MFPCT+36
MFPCSEAD EQU   MFPCT+40
MFPCALST EQU   MFPCT+44
MFPCFLAG EQU   MFPCT+48
MFPCNINT EQU   MFPCT+50
MFPCSTID EQU   MFPCT+52
MFPCMDCB EQU   MFPCT+56
DTMVADD  EQU   DTMVOPT
MFCOOPTN EQU   MFCOA
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
MFCOCTRL EQU   MFCOOPTN
MFPCMFR  EQU   MFPCT+60
MFPCREIN EQU   MFPCFLAG+1
@NM00012 EQU   MFPCFLAG
MFPCELSP EQU   MFPCELGM
MFPCNAME EQU   MFPCT
DTMFLEN  EQU   DTMFSTOR+1
@NM00018 EQU   DTECB
DTECWAIT EQU   DTECFLGS
DTCSCECB EQU   DTCSCL
CIBDATA  EQU   CIBNAME+16
CIBDATLN EQU   CIBNAME+14
@NM00017 EQU   CIBNAME+13
CIBCONID EQU   CIBNAME+12
CIBTJID  EQU   CIBASID
@NM00016 EQU   CIBNAME+6
CIBLEN   EQU   CIBNAME+5
MFSQLEN  EQU   MFSQSTOR+1
MFSQSP   EQU   MFSQSTOR
MFSQNAME EQU   MFSQU
MFSERTRY EQU   MFSEFLAG
@NM00015 EQU   MFSEFLAG
@NM00014 EQU   MFSEL+44
MFSESCOD EQU   MFSESECB+1
@NM00013 EQU   MFSESECB
MFCOMEMV EQU   MFCOMEM+2
@NM00011 EQU   MFCOMEM+1
MFCOMEMC EQU   MFCOMEMF
MFCOOPIV EQU   MFCOOPIL
@NM00010 EQU   MFCOOPIL
@NM00009 EQU   MFCOOPI+1
MFCOOPIC EQU   MFCOOPIF
@NM00008 EQU   MFCOSTP+1
MFCOSTPC EQU   MFCOSTPF
@NM00007 EQU   MFCOREPL
@NM00006 EQU   MFCOREP+1
MFCOREPC EQU   MFCOREPF
@NM00005 EQU   MFCOINT+1
MFCOINTC EQU   MFCOINTF
MFCOOUTV EQU   MFCOOUT+3
@NM00004 EQU   MFCOOUT+1
MFCOOUTC EQU   MFCOOUTF
MFCOCYCV EQU   MFCOCYC+2
@NM00003 EQU   MFCOCYC+1
MFCOCYCC EQU   MFCOCYCF
MFCOTCEV EQU   MFCOTCEL
@NM00002 EQU   MFCOTCEL
@NM00001 EQU   MFCOTCE+1
MFCOTCEC EQU   MFCOTCEF
DTMVDEV  EQU   DTMVOPT+16
DTMVCHA  EQU   DTMVOPT+12
DTMVWKL  EQU   DTMVOPT+8
DTMVPAG  EQU   DTMVOPT+4
DTMVCPU  EQU   DTMVOPT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00179 EQU   DT050
@ENDDATA EQU   *
         END   IRBMFDTA,(C'PLS1559',0700,74339)

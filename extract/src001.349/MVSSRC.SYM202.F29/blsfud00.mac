         TITLE 'BLSFUD00-WRITE A RECORD TO THE DSD DATA BASE           *
                        '
*          /*        CHANGE ACTIVITY         */
*  THIS MODULE IS WRITTEN FOR @G57LPRM
BLSFUD00 CSECT ,                                                01S0002
@MAINENT DS    0H                                               01S0002
         USING *,@15                                            01S0002
         B     @PROLOG                                          01S0002
         DC    AL1(16)                                          01S0002
         DC    C'BLSFUD00  78.065'                              01S0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0002
         BALR  @12,0                                            01S0002
@PSTART  DS    0H                                               01S0002
         USING @PSTART,@12                                      01S0002
         L     @00,@SIZDATD                                     01S0002
         BLSUALLS R,LV=(0)
         LR    @11,@01                                          01S0002
         USING @DATD,@11                                        01S0002
         ST    @13,@SA00001+4                                   01S0002
         LM    @00,@01,20(@13)                                  01S0002
         ST    @11,8(,@13)                                      01S0002
         LR    @13,@11                                          01S0002
         MVC   @PC00001(12),0(@01)                              01S0002
*                                                               01S0130
*/* ***********************************************************      */
*/*                                                                  */
*/*               START OF DEFAULT PROCESSING                        */
*/*                                                                  */
*/* ***********************************************************      */
*                                                               01S0130
*   ZZ2PTR=ADDR(ZZ2CB);             /* GET TASK VARIABLE ADDR        */
         L     ZZ2PTR,@PC00001                                  01S0130
*   RETC=ZERO;                      /* INITIALIZE THE RETC           */
         SLR   RETC,RETC                                        01S0131
*   FLAG1=FLAG1&&FLAG1;             /* INITIALIZE THE FLAG INDICATORS*/
         XC    FLAG1(1),FLAG1                                   01S0132
*   ERRORRC=ERRORRC&&ERRORRC;       /* INITIALIZE ERROR INDICATORS   */
         XC    ERRORRC(24),ERRORRC                              01S0133
*/* ***********************************************************      */
*/*                                                                  */
*/*        START OF MODULE PROCESSING                                */
*/*                                                                  */
*/* ***********************************************************      */
*                                                               01S0134
*   DMCBPTR=ZZ1DSDP;                /* COPY THE DMCB                 */
*                                                               01S0134
         L     @10,ZZ2ZZ1P(,ZZ2PTR)                             01S0134
         L     DMCBPTR,ZZ1DSDP(,@10)                            01S0134
*   /*****************************************************************/
*   /*                                                               */
*   /* OPEN THE DSD DATA BASE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0135
*   CALL OPENREC;                   /* OPEN DSD DATA BASE            */
         BAL   @14,OPENREC                                      01S0135
*   IF RETCODE=ZERO THEN            /* OPEN OK?                      */
         LTR   RETCODE,RETCODE                                  01S0136
         BNZ   @RF00136                                         01S0136
*     DO;                           /* YES, CONTINUE WITH READ       */
*                                                               01S0137
*       /*************************************************************/
*       /*                                                           */
*       /* READ THE RECORD FOR UPDATE                                */
*       /*                                                           */
*       /*************************************************************/
*                                                               01S0138
*       CALL READREC;               /* READ A RECORD                 */
         BAL   @14,READREC                                      01S0138
*       IF RETCODE=ZERO THEN        /* READ OK ?                     */
         LTR   RETCODE,RETCODE                                  01S0139
         BNZ   @RF00139                                         01S0139
*         DO;                       /* YES, WRITE IT                 */
*                                                               01S0140
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE THE RECORD                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                               01S0141
*           CALL WRITEREC;          /* WRITE THE RECORD              */
         BAL   @14,WRITEREC                                     01S0141
*           IF RETCODE=ZERO THEN    /* IS WRITE SUCCESSFUL?          */
         LTR   RETCODE,RETCODE                                  01S0142
         BNZ   @RF00142                                         01S0142
*             DO;                   /* YES, CLOSE THE DATA SET       */
*                                                               01S0143
*               /*****************************************************/
*               /*                                                   */
*               /* CLOSE THE DSD DATA BASE                           */
*               /*                                                   */
*               /*****************************************************/
*                                                               01S0144
*               CALL CLOSEREC;      /* CLOSE IT                      */
         BAL   @14,CLOSEREC                                     01S0144
*               IF RETCODE=ZERO THEN/* IS CLOSE SUCCESSFUL?          */
         LTR   RETCODE,RETCODE                                  01S0145
         BNZ   @RF00145                                         01S0145
*                 RETC=ZERO;        /* YES, GOOD WRITE               */
         SLR   RETC,RETC                                        01S0146
*               ELSE                /* NO, TERMINATE THE SUBCOMMAND  */
*                 RETC=TWELVE;                                  01S0147
         B     @RC00145                                         01S0147
@RF00145 LA    RETC,12                                          01S0147
*             END;                  /* END OF CLOSE DATA             */
*           ELSE                    /* NO                            */
*             DO;                   /* ERROR ON WRITE                */
         B     @RC00142                                         01S0149
@RF00142 DS    0H                                               01S0150
*               IF OPENFLG='1'B THEN/* HAS DATA SET BEEN OPEN?       */
         TM    OPENFLG,B'10000000'                              01S0150
         BNO   @RF00150                                         01S0150
*                 DO;               /* CLOSE MUST BE DONE            */
*                                                               01S0151
*                   /*************************************************/
*                   /*                                               */
*                   /* CLOSE OF DATA SET REQUIRED                    */
*                   /*                                               */
*                   /*************************************************/
*                                                               01S0152
*                   CALL CLOSEREC;  /* ATTEMPT TO CLOSE THE DATA SET */
         BAL   @14,CLOSEREC                                     01S0152
*                 END;              /* END OF CLOSE MUST BE DONE
*                                      WRITE                         */
*               RETC=TWELVE;        /* REQ TERMINATION               */
@RF00150 LA    RETC,12                                          01S0154
*             END;                  /* END OF ERROR ON WRITE         */
*         END;                      /* END OF WRITE IT               */
*       ELSE                        /* NO, ERROR ON READ             */
*         DO;                       /* ERROR ON READ                 */
         B     @RC00139                                         01S0157
@RF00139 DS    0H                                               01S0158
*           IF OPENFLG='1'B THEN    /* HAS DATA SET BEEN OPEN?       */
         TM    OPENFLG,B'10000000'                              01S0158
         BNO   @RF00158                                         01S0158
*             DO;                   /* CLOSE MUST BE DONE            */
*                                                               01S0159
*               /*****************************************************/
*               /*                                                   */
*               /* CLOSE OF DATA SET REQUIRED                        */
*               /*                                                   */
*               /*****************************************************/
*                                                               01S0160
*               CALL CLOSEREC;      /* ATTEMPT TO CLOSE THE DATA SET */
         BAL   @14,CLOSEREC                                     01S0160
*             END;                  /* END OF CLOSE MUST BE DONE READ*/
*           RETC=TWELVE;            /* REQUEST TERMINATION           */
@RF00158 LA    RETC,12                                          01S0162
*         END;                      /* END OF ERROR ON READ          */
*     END;                          /* END OF CONTINUE WITH READ     */
*   ELSE                            /* NO, OPEN ERROR PROCESS        */
*     RETC=TWELVE;                  /* REQ TERMINATION OF SUBCOMMAND */
         B     @RC00136                                         01S0165
@RF00136 LA    RETC,12                                          01S0165
*   RETURN CODE(RETC);              /* RETURN TO CALLER              */
@RC00136 L     @13,4(,@13)                                      01S0166
         L     @00,@SIZDATD                                     01S0166
         LR    @01,@11                                          01S0166
         BLSUFRES R,LV=(0),A=(1)
         LR    @15,@02                                          01S0166
         L     @14,12(,@13)                                     01S0166
         LM    @00,@12,20(@13)                                  01S0166
         BR    @14                                              01S0166
         EJECT
*OPENREC:                                                       01S0167
*   PROCEDURE;                      /* OPEN DATA SET FOR UPDATE      */
OPENREC  STM   @14,@06,@SA00002                                 01S0167
         STM   @08,@12,@SA00002+36                              01S0167
*   RETCODE=ZERO;                   /* INIT THE INTERNAL RETURN CODE */
*                                                               01S0168
         SLR   RETCODE,RETCODE                                  01S0168
*   /*****************************************************************/
*   /*                                                               */
*   /* OPEN THE DSD DATA BASE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0169
*   DO;                             /* BLSOPEN(DMCBPTR)OUTPUT        */
*     RFY                                                       01S0170
*       GPR01P RSTD;                                            01S0170
*     GPR01P=DMCBPTR;               /* ADDRESS DMCB                  */
         LR    GPR01P,DMCBPTR                                   01S0171
*     RFY                                                       01S0172
*       DMCB BASED(GPR01P);                                     01S0172
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */
*       THEN                                                    01S0173
         LR    @10,GPR01P                                       01S0173
         N     @10,@CF01000                                     01S0173
         CLR   @10,GPR01P                                       01S0173
         BNE   @RF00173                                         01S0173
         CLC   DMCBID(4,GPR01P),@CC01001                        01S0173
         BNE   @RF00173                                         01S0173
*       DO;                                                     01S0174
*         DMCBRQST=DMCBOPR;         /* INDICATE OPEN REQUEST         */
         MVI   DMCBRQST(GPR01P),X'01'                           01S0175
*         DMCBOUT='1'B;             /* INDICATE OPEN FOR OUTPUR      */
         OI    DMCBOUT(GPR01P),B'10000000'                      01S0176
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                              01S0177
         BALR  @14,@15                                          01S0177
*       END;                                                    01S0178
*     ELSE                                                      01S0179
*       DO;                                                     01S0179
         B     @RC00173                                         01S0179
@RF00173 DS    0H                                               01S0180
*         RFY                                                   01S0180
*          (GPR00F,                                             01S0180
*           GPR15F) RSTD;                                       01S0180
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                    01S0181
*         GPR15F=16;                /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                        01S0182
*         RFY                                                   01S0183
*          (GPR00F,                                             01S0183
*           GPR15F);                                            01S0183
*       END;                                                    01S0184
*     RFY                                                       01S0185
*       DMCB;                                                   01S0185
@RC00173 DS    0H                                               01S0186
*     RFY                                                       01S0186
*       GPR01P;                                                 01S0186
*   END;                            /* BLSOPEN(DMCBPTR)OUTPUT OPEN
*                                      DSD DATA BASE                 */
*   RESPECIFY                                                   01S0188
*     RF RESTRICTED;                /* SAVE REG 15                   */
*   IF RF=ZERO THEN                 /* OPEN OK?                      */
         SLR   @14,@14                                          01S0189
         CR    RF,@14                                           01S0189
         BNE   @RF00189                                         01S0189
*     DO;                           /* YES, CONTINUE WITH READ       */
*                                                               01S0190
*       /*************************************************************/
*       /*                                                           */
*       /* OPEN IS SUCCESSFUL                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                               01S0191
*       OPENFLG='1'B;               /* OPEN SUCCESSFUL               */
         OI    OPENFLG,B'10000000'                              01S0191
*       IF DMCBMSG^=ZERO THEN       /* IS MESSAGE QUEUED?            */
         CL    @14,DMCBMSG(,DMCBPTR)                            01S0192
         BE    @RF00192                                         01S0192
*         CALL MSGPURGE;            /* PURGE MSG QUEUE               */
         BAL   @14,MSGPURGE                                     01S0193
*       RETCODE=ZERO;               /* INDICATE OK TO USER           */
@RF00192 SLR   RETCODE,RETCODE                                  01S0194
*     END;                          /* END OF CONTINUE WITH READ     */
*   ELSE                            /* NO, OPEN ERROR PROCESS        */
*     IF RF=TWELVE×                 /* IS IT DMCB UNRECOVERABLE?     */
*         RF=SIXTEEN THEN           /* IS DMCB INVALID?              */
         B     @RC00189                                         01S0196
@RF00189 C     RF,@CF00035                                      01S0196
         BE    @RT00196                                         01S0196
         C     RF,@CF00057                                      01S0196
         BNE   @RF00196                                         01S0196
@RT00196 DS    0H                                               01S0197
*       DO;                         /* YES, DMCB UNRECOVERABLE       */
*         OPENERR=RF;               /* SAVE RETURN CODE              */
         ST    RF,OPENERR                                       01S0198
*         RESPECIFY                                             01S0199
*           R0 RESTRICTED;          /* SAVE REG 0                    */
*                                                               01S0199
*         /***********************************************************/
*         /*                                                         */
*         /* SEND MESSAGE - LOGIC ERROR IN BLSFUD00, DMCB FOR DSD    */
*         /* INVALID                                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0200
*         MSGPTR=R0;                /* SAVE MSG QUEUE PTR            */
         ST    R0,MSGPTR                                        01S0200
*         DO;                       /* BLSDMSG                  01S0201
*                                      (ZZ2,04052,MSGPTR,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*           CALL BLSDMSG0(ZZ2,04052,MSGPTR,BLSDMSGS,'10010000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                  01S0202
         LA    @14,@CF01005                                     01S0202
         ST    @14,@AL00001+4                                   01S0202
         LA    @14,MSGPTR                                       01S0202
         ST    @14,@AL00001+8                                   01S0202
         L     @01,ZZ2MSGSP(,ZZ2PTR)                            01S0202
         ST    @01,@AL00001+12                                  01S0202
         LA    @14,@CB01006                                     01S0202
         ST    @14,@AL00001+16                                  01S0202
         LA    @14,@CF00051                                     01S0202
         ST    @14,@AL00001+20                                  01S0202
         L     @15,ZZ2MSG0P(,ZZ2PTR)                            01S0202
         LA    @01,@AL00001                                     01S0202
         BALR  @14,@15                                          01S0202
*         END;                      /* BLSDMSG                  01S0203
*                                      (ZZ2,04052,MSGPTR,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*         RESPECIFY                                             01S0204
*           R0 UNRESTRICTED;        /* GIVE REG 0 BACK               */
*                                                               01S0204
*         /***********************************************************/
*         /*                                                         */
*         /* ABEND TO CORRECT THE INVALID DMCB                       */
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0205
*         DO;                       /* ABEND(113) DUMP USER          */
*           RESPECIFY                                           01S0206
*            (GPR01F) RESTRICTED;                               01S0206
*           GPR01F=(113)&'00000FFF'X;/* COMP CODE IN BITS 20-31      */
         LA    GPR01F,113                                       01S0207
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00066                                  01S0208
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                               01S0209
*           RESPECIFY                                           01S0210
*            (GPR01F) UNRESTRICTED;                             01S0210
*         END;                      /* ABEND(113) DUMP USER ABEND FOR
*                                      TEST                          */
*       END;                        /* END DMCB UNRECOVERABLE        */
*     ELSE                          /* NO, DMCB IS RECOVERABLE       */
*       DO;                         /* ERROR WHILE OPEN              */
         B     @RC00196                                         01S0213
@RF00196 DS    0H                                               01S0214
*         OPENERR=RF;               /* SAVE ERROR RETURN CODE        */
         ST    RF,OPENERR                                       01S0214
*         IF RF=FOUR THEN           /* USER REQUESTED TERMINATION    */
         C     RF,@CF00043                                      01S0215
         BNE   @RF00215                                         01S0215
*           DO;                     /* BLSDMSG                  01S0216
*                                      (ZZ2,04082,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*             CALL BLSDMSG0(ZZ2,04082,DMCBMSG,BLSDMSGS,'10010000'B,0);
         ST    ZZ2PTR,@AL00001                                  01S0217
         LA    @14,@CF01011                                     01S0217
         ST    @14,@AL00001+4                                   01S0217
         LA    @14,DMCBMSG(,DMCBPTR)                            01S0217
         ST    @14,@AL00001+8                                   01S0217
         L     @14,ZZ2MSGSP(,ZZ2PTR)                            01S0217
         ST    @14,@AL00001+12                                  01S0217
         LA    @14,@CB01006                                     01S0217
         ST    @14,@AL00001+16                                  01S0217
         LA    @14,@CF00051                                     01S0217
         ST    @14,@AL00001+20                                  01S0217
         L     @15,ZZ2MSG0P(,ZZ2PTR)                            01S0217
         LA    @01,@AL00001                                     01S0217
         BALR  @14,@15                                          01S0217
*                                   /* BUILD MESSAGE                 */
*           END;                    /* BLSDMSG                  01S0218
*                                      (ZZ2,04082,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*         ELSE                      /* RETCODE OTHER THAN RETCODE
*                                      FOUR                          */
*           DO;                     /* BLSDMSG                  01S0219
*                                      (ZZ2,04052,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
         B     @RC00215                                         01S0219
@RF00215 DS    0H                                               01S0220
*             CALL BLSDMSG0(ZZ2,04052,DMCBMSG,BLSDMSGS,'10010000'B,0);
         ST    ZZ2PTR,@AL00001                                  01S0220
         LA    @14,@CF01005                                     01S0220
         ST    @14,@AL00001+4                                   01S0220
         LA    @14,DMCBMSG(,DMCBPTR)                            01S0220
         ST    @14,@AL00001+8                                   01S0220
         L     @14,ZZ2MSGSP(,ZZ2PTR)                            01S0220
         ST    @14,@AL00001+12                                  01S0220
         LA    @14,@CB01006                                     01S0220
         ST    @14,@AL00001+16                                  01S0220
         LA    @14,@CF00051                                     01S0220
         ST    @14,@AL00001+20                                  01S0220
         L     @15,ZZ2MSG0P(,ZZ2PTR)                            01S0220
         LA    @01,@AL00001                                     01S0220
         BALR  @14,@15                                          01S0220
*                                   /* BUILD MESSAGE                 */
*           END;                    /* BLSDMSG                  01S0221
*                                      (ZZ2,04052,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*         RETCODE=TWELVE;           /* REQ TERMINATION OF SUBCOMMAND */
@RC00215 LA    RETCODE,12                                       01S0222
*       END;                        /* END ERROR WHILE OPEN          */
*   RESPECIFY                                                   01S0224
*     RF UNRESTRICTED;              /* RETURN REG 15                 */
*   RETURN;                         /* RETURN TO CALLER              */
@EL00002 DS    0H                                               01S0225
@EF00002 DS    0H                                               01S0225
@ER00002 LM    @14,@06,@SA00002                                 01S0225
         LM    @08,@12,@SA00002+36                              01S0225
         BR    @14                                              01S0225
*   END OPENREC;                    /* END OF OPEN PROCEDURE         */
         B     @EL00002                                         01S0226
         EJECT
*READREC:                                                       01S0227
*   PROCEDURE;                      /* READ A RECORD                 */
*                                                               01S0227
READREC  STM   @14,@06,@SA00003                                 01S0227
         STM   @08,@12,@SA00003+36                              01S0227
*   /*****************************************************************/
*   /*                                                               */
*   /* READ A RECORD FOR UPDATE FROM DATA BASE                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0228
*   RETCODE=ZERO;                   /* INITIALIZE THE RETURN CODE    */
         SLR   RETCODE,RETCODE                                  01S0228
*   RESPECIFY                                                   01S0229
*    (R0,                                                       01S0229
*     R1) RESTRICTED;               /* SAVE REGS FOR GETMAIN         */
*                                                               01S0229
*   /*****************************************************************/
*   /*                                                               */
*   /* OBTAIN AREA FOR READ REQUEST                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0230
*   DO;                             /* GETMAIN (R)              01S0230
*                                      LV(DSDRECL)SP(ZZZSPEXC)       */
*     RESPECIFY                                                 01S0231
*      (GPR01F,                                                 01S0231
*       GPR00F) RESTRICTED;                                     01S0231
*     GPR00F=DSDRECL;               /* LENGTH REQUESTED              */
         L     @10,@PC00001+8                                   01S0232
         L     GPR00F,DSDRECL(,@10)                             01S0232
*     GPR01F=ZZZSPEXC;              /* SP IN REG 1                   */
         LA    GPR01F,1                                         01S0233
*     GEN(SLL   GPR01F,24)                                      01S0234
*     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;              01S0234
         SLL   GPR01F,24
*     GPR00F=GPR00F×GPR01F;         /* SP IN HIGH BYTE               */
         OR    GPR00F,GPR01F                                    01S0235
*     GPR01F=-1;                    /* INDICATE A GETMAIN REQUEST    */
         SLR   GPR01F,GPR01F                                    01S0236
         BCTR  GPR01F,0                                         01S0236
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                               01S0237
*     RESPECIFY                                                 01S0238
*      (GPR01F,                                                 01S0238
*       GPR00F) UNRESTRICTED;                                   01S0238
*   END;                            /* GETMAIN (R)              01S0239
*                                      LV(DSDRECL)SP(ZZZSPEXC) GET
*                                      AREA FOR RECORD               */
*   READPTR=R1;                     /* GET THE ADDRESS OF THE AREA   */
         LR    READPTR,R1                                       01S0240
*   RESPECIFY                                                   01S0241
*    (R0,                                                       01S0241
*     R1) UNRESTRICTED;             /* FREE THE REGS                 */
*                                                               01S0241
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE RECORD FOR UPDATE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0242
*/* BLSGET (DMCBPTR) UPD AREAL(READPTR)AREALEN(DSDRECL)KEYEQ ARG(DSDKEY
*ARGLEN(LENGTH(DSDKEY))                                              */
*                                                               01S0242
*   DO;                             /* BLSGET (DMCBPTR) UPD AREAL(REA
*                                      DPTR)AREALEN(DSDRECL)KEYEQ ARG
*                                      (DSDKEY)ARGLEN(LENGTH(DSDKEY))*/
*     RFY                                                       01S0243
*       GPR01P RSTD;                                            01S0243
*     GPR01P=DMCBPTR;               /* ADDRESS DMCB                  */
         LR    GPR01P,DMCBPTR                                   01S0244
*     RFY                                                       01S0245
*       DMCB BASED(GPR01P);                                     01S0245
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */
*       THEN                                                    01S0246
         LR    @10,GPR01P                                       01S0246
         N     @10,@CF01000                                     01S0246
         CLR   @10,GPR01P                                       01S0246
         BNE   @RF00246                                         01S0246
         CLC   DMCBID(4,GPR01P),@CC01001                        01S0246
         BNE   @RF00246                                         01S0246
*       DO;                                                     01S0247
*         DMCBBUFP=READPTR&'7FFFFFFF'X;/* PLACE BUFFER ADDRESS IN
*                                      DMCB                          */
         L     @10,@CF01016                                     01S0248
         LR    @09,READPTR                                      01S0248
         NR    @09,@10                                          01S0248
         ST    @09,DMCBBUFP(,GPR01P)                            01S0248
*         DMCBBLEN=DSDRECL&'7FFFFFFF'X;/* PLACE BUFFER LENGTH IN DMCB*/
         L     @09,@PC00001+8                                   01S0249
         N     @10,DSDRECL(,@09)                                01S0249
         ST    @10,DMCBBLEN(,GPR01P)                            01S0249
*         DMCBKEYP=ADDR(DSDKEY);    /* PLACE KEY ADDRESS IN DMCB     */
         L     @10,@PC00001+4                                   01S0250
         ST    @10,DMCBKEYP(,GPR01P)                            01S0250
*         DMCBKEYL=(LENGTH(DSDKEY))&'7FFFFFFF'X;/* PLACE KEY LENGTH
*                                      IN DMCB                       */
         MVC   DMCBKEYL(4,GPR01P),@CF00127                      01S0251
*         DMCBKYD='1'B;             /* INDICATE KEYED ACCESS         */
*         DMCBAPX='0'B;             /* INDICATE EXACT KEY MATCH      */
*         DMCBGKY='0'B;             /* INDICATE FULL KEY SEARCH      */
*         DMCBUPD='1'B;             /* INDICATE UPDATE OPTION        */
         OI    DMCBKYD(GPR01P),B'10010000'                      01S0255
         NI    DMCBAPX(GPR01P),B'10011111'                      01S0255
*         DMCBRQST=DMCBGER;         /* INDICATE GET REQUEST          */
         MVI   DMCBRQST(GPR01P),X'04'                           01S0256
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                              01S0257
         BALR  @14,@15                                          01S0257
*       END;                                                    01S0258
*     ELSE                                                      01S0259
*       DO;                                                     01S0259
         B     @RC00246                                         01S0259
@RF00246 DS    0H                                               01S0260
*         RFY                                                   01S0260
*          (GPR00F,                                             01S0260
*           GPR15F) RSTD;                                       01S0260
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                    01S0261
*         GPR15F=16;                /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                        01S0262
*         RFY                                                   01S0263
*          (GPR00F,                                             01S0263
*           GPR15F);                                            01S0263
*       END;                                                    01S0264
*     RFY                                                       01S0265
*       DMCB;                                                   01S0265
@RC00246 DS    0H                                               01S0266
*     RFY                                                       01S0266
*       GPR01P;                                                 01S0266
*   END;                            /* BLSGET (DMCBPTR) UPD AREAL(REA
*                                      DPTR)AREALEN(DSDRECL)KEYEQ ARG
*                                      (DSDKEY)ARGLEN(LENGTH(DSDKEY))*/
*   RESPECIFY                                                   01S0268
*     RF RESTRICTED;                /* SAVE REG 15                   */
*   IF RF=ZERO×                     /* READ SUCCESSFUL?              */
*       RF=EIGHT THEN               /* OR NOT FOUND?                 */
         LTR   RF,RF                                            01S0269
         BZ    @RT00269                                         01S0269
         C     RF,@CF00054                                      01S0269
         BNE   @RF00269                                         01S0269
@RT00269 DS    0H                                               01S0270
*     DO;                           /* YES, READ AS EXPECTED         */
*       READFLG='1'B;               /* SET THE READ SUCCESSFUL ON    */
         OI    READFLG,B'01000000'                              01S0271
*       IF RF=EIGHT THEN            /* REC NOT FOUND?                */
         C     RF,@CF00054                                      01S0272
         BNE   @RF00272                                         01S0272
*         DMCBUPD='0'B;             /* UPDATE NOT NEEDED TURN OFF    */
         NI    DMCBUPD(DMCBPTR),B'11101111'                     01S0273
*       IF DMCBMSG^=ZERO THEN       /* ARE THERE ANY MSG QUEUED ?    */
@RF00272 L     @14,DMCBMSG(,DMCBPTR)                            01S0274
         LTR   @14,@14                                          01S0274
         BZ    @RF00274                                         01S0274
*         CALL MSGPURGE;            /* PURSE THE MESSAGE QUEUE       */
         BAL   @14,MSGPURGE                                     01S0275
*       RETCODE=ZERO;               /* NO ERRORS ON READ             */
@RF00274 SLR   RETCODE,RETCODE                                  01S0276
*     END;                          /* END OF READ AS EXPECTED       */
*   ELSE                            /* NO READ NOT SUCCESSFUL        */
*     DO;                           /* READ ERROR PROCESSING         */
*                                                               01S0278
         B     @RC00269                                         01S0278
@RF00269 DS    0H                                               01S0279
*       /*************************************************************/
*       /*                                                           */
*       /* PUT OUT ERROR WHILE READING DSD DATA BASE                 */
*       /*                                                           */
*       /*************************************************************/
*                                                               01S0279
*       RESPECIFY                                               01S0279
*         R0 RESTRICTED;            /* SAVE R0                       */
*       MSGPTR=R0;                  /* SAVE THE POINTER              */
         ST    R0,MSGPTR                                        01S0280
*       RESPECIFY                                               01S0281
*         R0 UNRESTRICTED;          /* FREE R0                       */
*       READERR=RF;                 /* TRACK THE ERROR RC            */
         ST    RF,READERR                                       01S0282
*       DO;                         /* BLSDMSG                  01S0283
*                                      (ZZ2,04053,MSGPTR,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*         CALL BLSDMSG0(ZZ2,04053,MSGPTR,BLSDMSGS,'10010000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                  01S0284
         LA    @14,@CF01017                                     01S0284
         ST    @14,@AL00001+4                                   01S0284
         LA    @14,MSGPTR                                       01S0284
         ST    @14,@AL00001+8                                   01S0284
         L     @14,ZZ2MSGSP(,ZZ2PTR)                            01S0284
         ST    @14,@AL00001+12                                  01S0284
         LA    @14,@CB01006                                     01S0284
         ST    @14,@AL00001+16                                  01S0284
         LA    @14,@CF00051                                     01S0284
         ST    @14,@AL00001+20                                  01S0284
         L     @15,ZZ2MSG0P(,ZZ2PTR)                            01S0284
         LA    @01,@AL00001                                     01S0284
         BALR  @14,@15                                          01S0284
*       END;                        /* BLSDMSG                  01S0285
*                                      (ZZ2,04053,MSGPTR,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*       IF RF^=SIXTEEN THEN         /* DMCB BAD?                     */
         C     RF,@CF00057                                      01S0286
         BE    @RF00286                                         01S0286
*         DMCBMSG=ZERO;             /* NO, ZERO MSG FIELD            */
         SLR   @14,@14                                          01S0287
         ST    @14,DMCBMSG(,DMCBPTR)                            01S0287
*       RESPECIFY                                               01S0288
*         RF UNRESTRICTED;          /* FINISHED WITH REG 15          */
@RF00286 DS    0H                                               01S0289
*       DO;                         /* ABEND(115) DUMP USER          */
*         RESPECIFY                                             01S0290
*          (GPR01F) RESTRICTED;                                 01S0290
*         GPR01F=(115)&'00000FFF'X; /* COMP CODE IN BITS 20-31       */
         LA    GPR01F,115                                       01S0291
*         GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG       */
         O     GPR01F,@CF00066                                  01S0292
*         SVC(13);                  /* ISSUE ABEND SVC               */
         SVC   13                                               01S0293
*         RESPECIFY                                             01S0294
*          (GPR01F) UNRESTRICTED;                               01S0294
*       END;                        /* ABEND(115) DUMP USER ABEND AT
*                                      THIS TIME                     */
*     END;                          /* END OF READ ERROR PROCESSING  */
*                                                               01S0296
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE THE AREA OBTAINED FOR READ BUFFER                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0297
*   RESPECIFY                                                   01S0297
*    (R0,                                                       01S0297
*     R1) RESTRICTED;               /* SAVE REGS FOR GETMAIN         */
*                                                               01S0297
@RC00269 DS    0H                                               01S0298
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE AREA FOR READ REQUEST                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0298
*   DO;                             /* FREEMAIN(R) LV(DSDRECL)SP(ZZZS
*                                      PEXC)A(RECAREA)               */
*     RESPECIFY                                                 01S0299
*      (GPR01F,                                                 01S0299
*       GPR00F) RESTRICTED;                                     01S0299
*     GPR00F=DSDRECL;               /* LENGTH REQUESTED              */
         L     @10,@PC00001+8                                   01S0300
         L     GPR00F,DSDRECL(,@10)                             01S0300
*     GPR01F=ZZZSPEXC;              /* SP IN REG 1                   */
         LA    GPR01F,1                                         01S0301
*     GEN(SLL   GPR01F,24)                                      01S0302
*     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;              01S0302
         SLL   GPR01F,24
*     GPR00F=GPR00F×GPR01F;         /* SP IN HI BYTE                 */
         OR    GPR00F,GPR01F                                    01S0303
*     GPR01F=ADDR(RECAREA);         /* SET REGISTER ONE              */
         LR    GPR01F,READPTR                                   01S0304
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                               01S0305
*     RESPECIFY                                                 01S0306
*      (GPR01F,                                                 01S0306
*       GPR00F) UNRESTRICTED;                                   01S0306
*   END;                            /* FREEMAIN(R) LV(DSDRECL)SP(ZZZS
*                                      PEXC)A(RECAREA) FREE THE AREA */
*   RESPECIFY                                                   01S0308
*    (R0,                                                       01S0308
*     R1) UNRESTRICTED;             /* FREE THE REGS                 */
*   RETURN;                         /* RETURN TO CALLER              */
@EL00003 DS    0H                                               01S0309
@EF00003 DS    0H                                               01S0309
@ER00003 LM    @14,@06,@SA00003                                 01S0309
         LM    @08,@12,@SA00003+36                              01S0309
         BR    @14                                              01S0309
*   END READREC;                    /* END OF READ REC PROC          */
         EJECT
*WRITEREC:                                                      01S0311
*   PROCEDURE;                      /* WRITE RECORD                  */
*                                                               01S0311
WRITEREC STM   @14,@06,@SA00004                                 01S0311
         STM   @08,@12,@SA00004+36                              01S0311
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE RECORD TO THE DSD DATA BASE                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0312
*   RETCODE=ZERO;                                               01S0312
*                                                               01S0312
         SLR   RETCODE,RETCODE                                  01S0312
*/* BLSPUT (DMCBPTR) AREA(DSDREC)AREALEN(DSDRECL)RECLEN(DSDRECL)     */
*                                                               01S0313
*   DO;                             /* BLSPUT (DMCBPTR) AREA(DSDREC)A
*                                      REALEN(DSDRECL)RECLEN(DSDRECL)*/
*     RFY                                                       01S0314
*       GPR01P RSTD;                                            01S0314
*     GPR01P=DMCBPTR;               /* ADDRESS DMCB                  */
         LR    GPR01P,DMCBPTR                                   01S0315
*     RFY                                                       01S0316
*       DMCB BASED(GPR01P);                                     01S0316
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */
*       THEN                                                    01S0317
         LR    @10,GPR01P                                       01S0317
         N     @10,@CF01000                                     01S0317
         CLR   @10,GPR01P                                       01S0317
         BNE   @RF00317                                         01S0317
         CLC   DMCBID(4,GPR01P),@CC01001                        01S0317
         BNE   @RF00317                                         01S0317
*       DO;                                                     01S0318
*         DMCBBUFP=ADDR(DSDREC);    /* PLACE BUFFER ADDRESS IN DMCB  */
         L     @10,@PC00001+4                                   01S0319
         ST    @10,DMCBBUFP(,GPR01P)                            01S0319
*         DMCBBLEN=DSDRECL&'7FFFFFFF'X;/* PLACE BUFFER LENGTH IN DMCB*/
         L     @10,@PC00001+8                                   01S0320
         L     @10,DSDRECL(,@10)                                01S0320
         N     @10,@CF01016                                     01S0320
         ST    @10,DMCBBLEN(,GPR01P)                            01S0320
*         DMCBORL=(DSDRECL)&'7FFFFFFF'X;/* PLACE RECORD LENGTH IN
*                                      DMCB                          */
         ST    @10,DMCBORL(,GPR01P)                             01S0321
*         DMCBRQST=DMCBPUR;         /* INDICATE PUT REQUEST          */
         MVI   DMCBRQST(GPR01P),X'05'                           01S0322
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                              01S0323
         BALR  @14,@15                                          01S0323
*       END;                                                    01S0324
*     ELSE                                                      01S0325
*       DO;                                                     01S0325
         B     @RC00317                                         01S0325
@RF00317 DS    0H                                               01S0326
*         RFY                                                   01S0326
*          (GPR00F,                                             01S0326
*           GPR15F) RSTD;                                       01S0326
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                    01S0327
*         GPR15F=16;                /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                        01S0328
*         RFY                                                   01S0329
*          (GPR00F,                                             01S0329
*           GPR15F);                                            01S0329
*       END;                                                    01S0330
*     RFY                                                       01S0331
*       DMCB;                                                   01S0331
@RC00317 DS    0H                                               01S0332
*     RFY                                                       01S0332
*       GPR01P;                                                 01S0332
*   END;                            /* BLSPUT (DMCBPTR) AREA(DSDREC)A
*                                      REALEN(DSDRECL)RECLEN(DSDRECL)*/
*   RESPECIFY                                                   01S0334
*     RF RESTRICTED;                /* RESTRICT REG 15               */
*   IF RF=ZERO THEN                 /* WAS WRITE SUCCESSFUL?         */
         SLR   @14,@14                                          01S0335
         CR    RF,@14                                           01S0335
         BNE   @RF00335                                         01S0335
*     DO;                           /* YES, WRITE SUCCESSFUL         */
*       WRITEFLG='1'B;              /* WRITE SUCCESSFUL              */
         OI    WRITEFLG,B'00100000'                             01S0337
*       IF DMCBMSG^=ZERO THEN       /* IS THERE A MESSAGE QUEUE ?    */
         CL    @14,DMCBMSG(,DMCBPTR)                            01S0338
         BE    @RF00338                                         01S0338
*         CALL MSGPURGE;            /* PURGE THE QUEUE               */
         BAL   @14,MSGPURGE                                     01S0339
*       RETCODE=ZERO;               /* SUCCESS WRITE                 */
@RF00338 SLR   RETCODE,RETCODE                                  01S0340
*     END;                          /* END OF WRITE SUCCESSFUL       */
*   ELSE                            /* NO, ERROR DURING WRITE        */
*     IF RF=FOUR×                   /* INVALID REQUEST?              */
*         RF=EIGHT THEN             /* DUPLICATE KEY                 */
         B     @RC00335                                         01S0342
@RF00335 C     RF,@CF00043                                      01S0342
         BE    @RT00342                                         01S0342
         C     RF,@CF00054                                      01S0342
         BNE   @RF00342                                         01S0342
@RT00342 DS    0H                                               01S0343
*       DO;                         /* ERROR INVALID OR DUP KEY REQ  */
*         WRITERR=RF;               /* SAVE ERROR RETURN CODE        */
         ST    RF,WRITERR                                       01S0344
*         ERRDMCB=DMCBPTR;          /* POINTER TO DMCB IN ERROR      */
*                                                               01S0345
         ST    DMCBPTR,ERRDMCB                                  01S0345
*         /***********************************************************/
*         /*                                                         */
*         /* SEND MESSAGE- LOGIC ERROR IN BLSFUD00, INVALID WRITE    */
*         /* REQUEST                                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0346
*         DO;                       /* BLSDMSG                  01S0346
*                                      (ZZ2,04054,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*           CALL BLSDMSG0(ZZ2,04054,DMCBMSG,BLSDMSGS,'10010000'B,0);
         ST    ZZ2PTR,@AL00001                                  01S0347
         LA    @14,@CF01023                                     01S0347
         ST    @14,@AL00001+4                                   01S0347
         LA    @14,DMCBMSG(,DMCBPTR)                            01S0347
         ST    @14,@AL00001+8                                   01S0347
         L     @14,ZZ2MSGSP(,ZZ2PTR)                            01S0347
         ST    @14,@AL00001+12                                  01S0347
         LA    @14,@CB01006                                     01S0347
         ST    @14,@AL00001+16                                  01S0347
         LA    @14,@CF00051                                     01S0347
         ST    @14,@AL00001+20                                  01S0347
         L     @15,ZZ2MSG0P(,ZZ2PTR)                            01S0347
         LA    @01,@AL00001                                     01S0347
         BALR  @14,@15                                          01S0347
*                                   /* BUILD MESSAGE                 */
*         END;                      /* BLSDMSG                  01S0348
*                                      (ZZ2,04054,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*         DO;                       /* ABEND(116) DUMP USER          */
*           RESPECIFY                                           01S0350
*            (GPR01F) RESTRICTED;                               01S0350
*           GPR01F=(116)&'00000FFF'X;/* COMP CODE IN BITS 20-31      */
         LA    GPR01F,116                                       01S0351
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00066                                  01S0352
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                               01S0353
*           RESPECIFY                                           01S0354
*            (GPR01F) UNRESTRICTED;                             01S0354
*         END;                      /* ABEND(116) DUMP USER ABEND    */
*       END;                        /* END OF ERROR INVALID OR DUP
*                                      KEY REQ                       */
*     ELSE                          /* NO NOT INVALID OR DUP KEY REQ */
*       IF RF=TWELVE THEN           /* WAS IT PERMANENT ERROR?       */
         B     @RC00342                                         01S0357
@RF00342 C     RF,@CF00035                                      01S0357
         BNE   @RF00357                                         01S0357
*         DO;                       /* YES, PERM ERROR               */
*           WRITERR=RF;             /* SAVE ERROR RETURN CODE        */
*                                                               01S0359
         ST    RF,WRITERR                                       01S0359
*           /*********************************************************/
*           /*                                                       */
*           /* SEND MESSAGE- PERMANENT ERROR WHILE WRITING DSD RECORD*/
*           /*                                                       */
*           /*********************************************************/
*                                                               01S0360
*           DO;                     /* BLSDMSG                  01S0360
*                                      (ZZ2,04054,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*             CALL BLSDMSG0(ZZ2,04054,DMCBMSG,BLSDMSGS,'10010000'B,0);
         ST    ZZ2PTR,@AL00001                                  01S0361
         LA    @14,@CF01023                                     01S0361
         ST    @14,@AL00001+4                                   01S0361
         LA    @14,DMCBMSG(,DMCBPTR)                            01S0361
         ST    @14,@AL00001+8                                   01S0361
         L     @14,ZZ2MSGSP(,ZZ2PTR)                            01S0361
         ST    @14,@AL00001+12                                  01S0361
         LA    @14,@CB01006                                     01S0361
         ST    @14,@AL00001+16                                  01S0361
         LA    @14,@CF00051                                     01S0361
         ST    @14,@AL00001+20                                  01S0361
         L     @15,ZZ2MSG0P(,ZZ2PTR)                            01S0361
         LA    @01,@AL00001                                     01S0361
         BALR  @14,@15                                          01S0361
*                                   /* BUILD MESSAGE                 */
*           END;                    /* BLSDMSG                  01S0362
*                                      (ZZ2,04054,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*           DO;                     /* ABEND(117) DUMP USER          */
*             RESPECIFY                                         01S0364
*              (GPR01F) RESTRICTED;                             01S0364
*             GPR01F=(117)&'00000FFF'X;/* COMP CODE IN BITS 20-31    */
         LA    GPR01F,117                                       01S0365
*             GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG   */
         O     GPR01F,@CF00066                                  01S0366
*             SVC(13);              /* ISSUE ABEND SVC               */
         SVC   13                                               01S0367
*             RESPECIFY                                         01S0368
*              (GPR01F) UNRESTRICTED;                           01S0368
*           END;                    /* ABEND(117) DUMP USER ABEND    */
*         END;                      /* END PERM ERROR                */
*       ELSE                        /* INVALID DMCB - MUST ABEND     */
*         DO;                       /* INVALID DMCB                  */
         B     @RC00357                                         01S0371
@RF00357 DS    0H                                               01S0372
*           WRITERR=RF;             /* SAVE THE RETURN CODE          */
         ST    RF,WRITERR                                       01S0372
*           ERRDMCB=DMCBPTR;        /* INDICATE ERROR DMCB POINTER   */
         ST    DMCBPTR,ERRDMCB                                  01S0373
*           DO;                     /* ABEND(118) DUMP USER          */
*             RESPECIFY                                         01S0375
*              (GPR01F) RESTRICTED;                             01S0375
*             GPR01F=(118)&'00000FFF'X;/* COMP CODE IN BITS 20-31    */
         LA    GPR01F,118                                       01S0376
*             GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG   */
         O     GPR01F,@CF00066                                  01S0377
*             SVC(13);              /* ISSUE ABEND SVC               */
         SVC   13                                               01S0378
*             RESPECIFY                                         01S0379
*              (GPR01F) UNRESTRICTED;                           01S0379
*           END;                    /* ABEND(118) DUMP USER ABEND THE
*                                      USER                          */
*         END;                      /* END OF INVALID DMCB           */
*   RESPECIFY                                                   01S0382
*     RF UNRESTRICTED;              /* RELEASE REG 15                */
*   RETURN;                         /* RETURN                        */
@EL00004 DS    0H                                               01S0383
@EF00004 DS    0H                                               01S0383
@ER00004 LM    @14,@06,@SA00004                                 01S0383
         LM    @08,@12,@SA00004+36                              01S0383
         BR    @14                                              01S0383
*   END WRITEREC;                   /* END OF WRITE RECORD           */
         B     @EL00004                                         01S0384
         EJECT
*CLOSEREC:                                                      01S0385
*   PROCEDURE;                      /* CLOSE THE DATA SET            */
CLOSEREC STM   @14,@06,@SA00005                                 01S0385
         STM   @08,@12,@SA00005+36                              01S0385
*   DO;                             /* BLSCLOSE(DMCBPTR)             */
*     RFY                                                       01S0387
*       GPR01P RSTD;                                            01S0387
*     GPR01P=DMCBPTR;               /* ADDRESS THE DMCB              */
         LR    GPR01P,DMCBPTR                                   01S0388
*     RFY                                                       01S0389
*       DMCB BASED(GPR01P);                                     01S0389
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */
*       THEN                                                    01S0390
         LR    @10,GPR01P                                       01S0390
         N     @10,@CF01000                                     01S0390
         CLR   @10,GPR01P                                       01S0390
         BNE   @RF00390                                         01S0390
         CLC   DMCBID(4,GPR01P),@CC01001                        01S0390
         BNE   @RF00390                                         01S0390
*       DO;                                                     01S0391
*         DMCBRQST=DMCBCLR;         /* INDICATE CLOSE REQUEST        */
         MVI   DMCBRQST(GPR01P),X'02'                           01S0392
*         DMCBTMP='0'B;             /* INDICATE NON TEMP CLOSE       */
*         DMCBRM6='0'B;             /* INDICATE                      */
*         DMCBRM5='0'B;             /* DISP OPTION                   */
         NI    DMCBTMP(GPR01P),B'00011111'                      01S0395
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                              01S0396
         BALR  @14,@15                                          01S0396
*       END;                                                    01S0397
*     ELSE                                                      01S0398
*       DO;                                                     01S0398
         B     @RC00390                                         01S0398
@RF00390 DS    0H                                               01S0399
*         RFY                                                   01S0399
*          (GPR00F,                                             01S0399
*           GPR15F) RSTD;                                       01S0399
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                    01S0400
*         GPR15F=16;                /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                        01S0401
*         RFY                                                   01S0402
*          (GPR00F,                                             01S0402
*           GPR15F);                                            01S0402
*       END;                                                    01S0403
*     RFY                                                       01S0404
*       DMCB;                                                   01S0404
@RC00390 DS    0H                                               01S0405
*     RFY                                                       01S0405
*       GPR01P;                                                 01S0405
*   END;                            /* BLSCLOSE(DMCBPTR) CLOSE THE
*                                      DATA SET                      */
*   RESPECIFY                                                   01S0407
*     RF RESTRICTED;                /* RESTRICT REG 15               */
*   IF RF=ZERO THEN                 /* IS THE CLOSE SUCCESSFUL ?     */
         SLR   @14,@14                                          01S0408
         CR    RF,@14                                           01S0408
         BNE   @RF00408                                         01S0408
*     DO;                           /* YES, FINISH CLOSE             */
*       CLOSEFLG='1'B;              /* CLOSE SUCCESSFUL              */
         OI    CLOSEFLG,B'00010000'                             01S0410
*       IF DMCBMSG^=ZERO THEN       /* IS THERE MSG QUEUED?          */
         CL    @14,DMCBMSG(,DMCBPTR)                            01S0411
         BE    @RF00411                                         01S0411
*         CALL MSGPURGE;            /* YES, PURGE THE QUEUE          */
         BAL   @14,MSGPURGE                                     01S0412
*       RETCODE=ZERO;               /* CLOSE SUCCESSFUL              */
@RF00411 SLR   RETCODE,RETCODE                                  01S0413
*     END;                          /* END OF FINISH CLOSE           */
*   ELSE                            /* NO, ERROR ON CLOSE            */
*     IF RF=FOUR THEN               /* IS IT PERMANENT ERROR?        */
         B     @RC00408                                         01S0415
@RF00408 C     RF,@CF00043                                      01S0415
         BNE   @RF00415                                         01S0415
*       DO;                         /* YES, PERM ERROR ON CLOSE      */
*         CLOSERR=RF;               /* SAVE THE ERROR RETURN CODE    */
*                                                               01S0417
         ST    RF,CLOSERR                                       01S0417
*         /***********************************************************/
*         /*                                                         */
*         /* SEND MESSAGE - PERMANENT ERROR CLOSING DSD DATA BASE    */
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0418
*         DO;                       /* BLSDMSG                  01S0418
*                                      (ZZ2,04055,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*           CALL BLSDMSG0(ZZ2,04055,DMCBMSG,BLSDMSGS,'10010000'B,0);
         ST    ZZ2PTR,@AL00001                                  01S0419
         LA    @14,@CF01031                                     01S0419
         ST    @14,@AL00001+4                                   01S0419
         LA    @14,DMCBMSG(,DMCBPTR)                            01S0419
         ST    @14,@AL00001+8                                   01S0419
         L     @14,ZZ2MSGSP(,ZZ2PTR)                            01S0419
         ST    @14,@AL00001+12                                  01S0419
         LA    @14,@CB01006                                     01S0419
         ST    @14,@AL00001+16                                  01S0419
         LA    @14,@CF00051                                     01S0419
         ST    @14,@AL00001+20                                  01S0419
         L     @15,ZZ2MSG0P(,ZZ2PTR)                            01S0419
         LA    @01,@AL00001                                     01S0419
         BALR  @14,@15                                          01S0419
*                                   /* BUILD MESSAGE                 */
*         END;                      /* BLSDMSG                  01S0420
*                                      (ZZ2,04055,DMCBMSG,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*                                                               01S0420
*         /***********************************************************/
*         /*                                                         */
*         /* PERMANENT ERROR ON CLOSE - ABEND TO CAUSE CLEANUP       */
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0421
*         DO;                       /* ABEND(119) DUMP USER          */
*           RESPECIFY                                           01S0422
*            (GPR01F) RESTRICTED;                               01S0422
*           GPR01F=(119)&'00000FFF'X;/* COMP CODE IN BITS 20-31      */
         LA    GPR01F,119                                       01S0423
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00066                                  01S0424
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                               01S0425
*           RESPECIFY                                           01S0426
*            (GPR01F) UNRESTRICTED;                             01S0426
*         END;                      /* ABEND(119) DUMP USER YES,
*                                      ABEND WITH ERROR              */
*       END;                        /* END OF PERM ERROR ON CLOSE    */
*     ELSE                          /* NO, LOGIC ERROR               */
*       DO;                         /* LOGIC ERROR                   */
*                                                               01S0429
         B     @RC00415                                         01S0429
@RF00415 DS    0H                                               01S0430
*         /***********************************************************/
*         /*                                                         */
*         /* SEND MSG - LOGIC ERROR IN BLSFUD00, DMCB INVALID        */
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0430
*         CLOSERR=RF;               /* SAVE THE ERROR RETURN CODE    */
         ST    RF,CLOSERR                                       01S0430
*         ERRDMCB=DMCBPTR;          /* SAVE ERROR DMCB PTR           */
         ST    DMCBPTR,ERRDMCB                                  01S0431
*         RESPECIFY                                             01S0432
*           R0 RESTRICTED;          /* SAVE R0                       */
*         MSGPTR=R0;                /* OBTAIN MSG CHAIN PTR          */
         ST    R0,MSGPTR                                        01S0433
*         RESPECIFY                                             01S0434
*           R0 UNRESTRICTED;        /* RELEASE REG 0                 */
*         DO;                       /* BLSDMSG                  01S0435
*                                      (ZZ2,04055,MSGPTR,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*           CALL BLSDMSG0(ZZ2,04055,MSGPTR,BLSDMSGS,'10010000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                  01S0436
         LA    @14,@CF01031                                     01S0436
         ST    @14,@AL00001+4                                   01S0436
         LA    @14,MSGPTR                                       01S0436
         ST    @14,@AL00001+8                                   01S0436
         L     @14,ZZ2MSGSP(,ZZ2PTR)                            01S0436
         ST    @14,@AL00001+12                                  01S0436
         LA    @14,@CB01006                                     01S0436
         ST    @14,@AL00001+16                                  01S0436
         LA    @14,@CF00051                                     01S0436
         ST    @14,@AL00001+20                                  01S0436
         L     @15,ZZ2MSG0P(,ZZ2PTR)                            01S0436
         LA    @01,@AL00001                                     01S0436
         BALR  @14,@15                                          01S0436
*         END;                      /* BLSDMSG                  01S0437
*                                      (ZZ2,04055,MSGPTR,BLSDMSGS)
*                                      LIFO ROUTE(TERM)              */
*                                                               01S0437
*         /***********************************************************/
*         /*                                                         */
*         /* LOGIC ERROR ABEND TO CAUSE CLEANUP AND REFRESH          */
*         /*                                                         */
*         /***********************************************************/
*                                                               01S0438
*         IF RF^=SIXTEEN THEN       /* DCMB BAD?                     */
         C     RF,@CF00057                                      01S0438
         BE    @RF00438                                         01S0438
*           DMCBMSG=ZERO;           /* NO , ZERO MSG FIELD           */
         SLR   @14,@14                                          01S0439
         ST    @14,DMCBMSG(,DMCBPTR)                            01S0439
*         DO;                       /* ABEND(120) DUMP USER          */
@RF00438 DS    0H                                               01S0441
*           RESPECIFY                                           01S0441
*            (GPR01F) RESTRICTED;                               01S0441
*           GPR01F=(120)&'00000FFF'X;/* COMP CODE IN BITS 20-31      */
         LA    GPR01F,120                                       01S0442
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00066                                  01S0443
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                               01S0444
*           RESPECIFY                                           01S0445
*            (GPR01F) UNRESTRICTED;                             01S0445
*         END;                      /* ABEND(120) DUMP USER YES,
*                                      ABEND NOW                     */
*       END;                        /* END OF LOGIC ERROR            */
*   RESPECIFY                                                   01S0448
*     RF UNRESTRICTED;              /* UNRSTRT REG 15                */
*   END CLOSEREC;                   /* END OF CLOSE PROCEDURE        */
@EL00005 DS    0H                                               01S0449
@EF00005 DS    0H                                               01S0449
@ER00005 LM    @14,@06,@SA00005                                 01S0449
         LM    @08,@12,@SA00005+36                              01S0449
         BR    @14                                              01S0449
         EJECT
*MSGPURGE:                                                      01S0450
*   PROCEDURE;                      /* PURSE MESSAGES FROM QUEUE     */
*                                                               01S0450
MSGPURGE STM   @14,@12,@SA00006                                 01S0450
*   /*****************************************************************/
*   /*                                                               */
*   /* PURGE AND FREE MESSAGE AREAS THAT DO NOT NEED TO BE SENT TO   */
*   /* TERMINAL                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0451
*   DO;                             /* YES, FREE THE AREAS, THE MSGS
*                                      WILL NOT BE PUT OUT           */
*     DO;                           /* BLSDMSG                  01S0452
*                                      (ZZ2,MONE,DMCBMSG,BLSDMSGS)   */
*       CALL BLSDMSG0(ZZ2,MONE,DMCBMSG,BLSDMSGS,'00000000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                  01S0453
         LA    @10,@CF00968                                     01S0453
         ST    @10,@AL00001+4                                   01S0453
         LA    @10,DMCBMSG(,DMCBPTR)                            01S0453
         ST    @10,@AL00001+8                                   01S0453
         L     @10,ZZ2MSGSP(,ZZ2PTR)                            01S0453
         ST    @10,@AL00001+12                                  01S0453
         LA    @10,@CB01037                                     01S0453
         ST    @10,@AL00001+16                                  01S0453
         LA    @10,@CF00051                                     01S0453
         ST    @10,@AL00001+20                                  01S0453
         L     @15,ZZ2MSG0P(,ZZ2PTR)                            01S0453
         LA    @01,@AL00001                                     01S0453
         BALR  @14,@15                                          01S0453
*     END;                          /* BLSDMSG                  01S0454
*                                      (ZZ2,MONE,DMCBMSG,BLSDMSGS)
*                                      PURGE MSGS                    */
*   END;                                                        01S0455
*   END MSGPURGE;                   /* END OF MSG PURGE              */
@EL00006 DS    0H                                               01S0456
@EF00006 DS    0H                                               01S0456
@ER00006 LM    @14,@12,@SA00006                                 01S0456
         BR    @14                                              01S0456
*/*BLSUPEND--MVS IPCS MODULE                                         */
*                                                               01S0457
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                  01S0457
*     GPR01F FIXED(31) REG(1),                                  01S0457
*     GPR15F FIXED(31) REG(15),                                 01S0457
*     GPR01P PTR(31) REG(1);                                    01S0457
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                    01S0458
*     I031F FIXED(31) BASED,                                    01S0458
*     I031P PTR(31) BASED,                                      01S0458
*     I015F FIXED(15) BASED,                                    01S0458
*     I015P PTR(15) BASED,                                      01S0458
*     I008P PTR(8) BASED,                                       01S0458
*     I001C CHAR(1) BASED;                                      01S0458
*   GENERATE NODEFS NOREFS DATA;                                01S0459
*   END                             /* BLRPEND END OF PROCESSING     */
*                                                               01S0460
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (BLSDSD  )                                       */
*/*%INCLUDE SYSLIB  (BLSDMSGD)                                       */
*/*%INCLUDE SYSLIB  (BLSUZZZ )                                       */
*/*%INCLUDE SYSLIB  (BLRFULL )                                       */
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */
*/*%INCLUDE SYSLIB  (IKJPSCB )                                       */
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */
*/*%INCLUDE SYSLIB  (BLSUSERV)                                       */
*/*%INCLUDE SYSLIB  (BLRSERV )                                       */
*/*%INCLUDE SYSLIB  (BLRSERVD)                                       */
*/*%INCLUDE SYSLIB  (BLSDSERV)                                       */
*                                                               01S0460
*       ;                                                       01S0460
@EL00001 L     @13,4(,@13)                                      01S0460
@EF00001 L     @00,@SIZDATD                                     01S0460
         LR    @01,@11                                          01S0460
         BLSUFRES R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                  01S0460
         BR    @14                                              01S0460
@DATA    DS    0H
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    14F
@SA00003 DS    14F
@SA00004 DS    14F
@SA00005 DS    14F
@SA00006 DS    15F
@AL00001 DS    6A
BLSFUD00 CSECT
         DS    0F
@CF00051 DC    F'0'
@CF00043 DC    F'4'
@CF00054 DC    F'8'
@CF00035 DC    F'12'
@CF00057 DC    F'16'
@CF00127 DC    F'61'
@CF01005 DC    F'4052'
@CF01017 DC    F'4053'
@CF01023 DC    F'4054'
@CF01031 DC    F'4055'
@CF01011 DC    F'4082'
@CF00968 DC    F'-1'
@CF00066 DC    XL4'80000000'
@CF01000 DC    XL4'FFFFFFF8'
@CF01016 DC    XL4'7FFFFFFF'
@DATD    DSECT
         DS    0D
MSGPTR   DS    A
ERRORRC  DS    CL24
         ORG   ERRORRC
ERRDMCB  DS    FL4
OPENERR  DS    FL4
READERR  DS    FL4
WRITERR  DS    FL4
CLOSERR  DS    FL4
FREEERR  DS    FL4
         ORG   ERRORRC+24
FLAG1    DS    CL1
         ORG   FLAG1
OPENFLG  DS    BL1
READFLG  EQU   FLAG1+0
WRITEFLG EQU   FLAG1+0
CLOSEFLG EQU   FLAG1+0
         ORG   FLAG1+1
BLSFUD00 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC01001 DC    C'DMCB'
@CB01006 DC    B'10010000'
@CB01037 DC    B'00000000'
@DATD    DSECT
         SPACE 2
***********************************************************************
* THE FOLLOWING AREA, BLRPATCH, IS RESERVED FOR PATCH APPLICATION     *
* TO OBTAIN PATCH ROOM IN THE @DATD AUTOMATIC STORAGE AREA, MODIFY    *
* CONSTANT @SIZDATD TO REFLECT THE DESIRED @DATD SIZE                 *
***********************************************************************
         SPACE
BLSFUD00 CSECT
         ORG
         DS    0D
BLRPATCH DC    CL8'ZAPAREA',(((*-BLSFUD00+19)/20+7)/8)CL8'BLSFUD00'
@DATD    DSECT
         SPACE 2
***********************************************************************
* ALIGN END OF DATA ON A DOUBLEWORD BOUNDARY                          *
***********************************************************************
         SPACE
         DS    0D
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
BLSFUD00 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
READPTR  EQU   @08
RETCODE  EQU   @07
RETC     EQU   @02
ZZ2PTR   EQU   @05
DMCBPTR  EQU   @06
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R9       EQU   @09
RB       EQU   @11
RD       EQU   @13
RE       EQU   @14
RF       EQU   @15
GPR01P   EQU   @01
GPR00F   EQU   @00
GPR15F   EQU   @15
GPR01F   EQU   @01
RA       EQU   @10
RC       EQU   @12
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
DSDREC   EQU   0
DSDKEY   EQU   DSDREC
DSDKGRP  EQU   DSDKEY
DSDKDSNM EQU   DSDKGRP+1
DSDKBSID EQU   DSDKEY+53
DSDKPID  EQU   DSDKBSID
DSDINFO  EQU   DSDREC+64
MSGDENT  EQU   0
MSGDPRF  EQU   MSGDENT
MSGDWRT  EQU   MSGDENT+8
MSGDMOV  EQU   MSGDWRT+4
MSGWENT  EQU   0
MSGWMOV  EQU   MSGWENT+4
DMCB     EQU   0
DMCBID   EQU   DMCB
DMCBFTY  EQU   DMCB+20
DMCBOPN  EQU   DMCB+21
DMCBRQST EQU   DMCB+22
DMCBRMOD EQU   DMCB+23
DMCBOUT  EQU   DMCBRMOD
DMCBTMP  EQU   DMCBOUT
DMCBRM6  EQU   DMCBRMOD
DMCBRM5  EQU   DMCBRMOD
DMCBOPTS EQU   DMCB+24
DMCBKYD  EQU   DMCBOPTS
DMCBGKY  EQU   DMCBOPTS
DMCBAPX  EQU   DMCBOPTS
DMCBUPD  EQU   DMCBOPTS
DMCBMFLG EQU   DMCB+28
DMCBBUFP EQU   DMCB+32
DMCBBLEN EQU   DMCB+36
DMCBORL  EQU   DMCB+40
DMCBKEYP EQU   DMCB+44
DMCBKEYL EQU   DMCB+48
DMCBMSG  EQU   DMCB+52
DMCBRI   EQU   DMCB+64
DMCBACBE EQU   DMCB+124
DMCBSPEC EQU   DMCB+380
DMCBAMS  EQU   DMCB+416
DMCBAUDT EQU   DMCB+568
DMCBLSCP EQU   DMCBAUDT+16
DMCBDMGR EQU   0
ZZ1      EQU   0
ZZ1DSDP  EQU   ZZ1+44
ZZ1ATTN  EQU   ZZ1+360
ZZ1EVE   EQU   ZZ1ATTN+4
ZZ1F     EQU   ZZ1+368
ZZ1N     EQU   ZZ1+1116
ZZ2      EQU   0
ZZ2AMD   EQU   ZZ2
@NM00013 EQU   ZZ2AMD+7
ZZ2PRT   EQU   ZZ2+138
ZZ2PRTT  EQU   ZZ2PRT+4
ZZ2PRTT1 EQU   ZZ2PRTT+1
ZZ2A     EQU   ZZ2+272
ZZ2AF    EQU   ZZ2A+16
ZZ2APID  EQU   ZZ2A+64
ZZ2AD    EQU   ZZ2A+74
ZZ2ADD   EQU   ZZ2AD
ZZ2ADDT  EQU   ZZ2ADD+2
ZZ2ADM   EQU   ZZ2AD+46
ZZ2ADMT  EQU   ZZ2ADM+2
ZZ2ADP   EQU   ZZ2AD+56
ZZ2ADPT  EQU   ZZ2ADP+2
ZZ2AQAS  EQU   ZZ2A+144
ZZ2AQD   EQU   ZZ2A+160
ZZ2AQDT  EQU   ZZ2AQD+10
ZZ2AQDF  EQU   ZZ2AQD+52
ZZ2STG   EQU   ZZ2+960
ZZ2ALLOP EQU   ZZ2+992
ZZ2FREEP EQU   ZZ2+996
ZZ2FF19P EQU   ZZ2+1000
ZZ2FRE1P EQU   ZZ2+1004
ZZ2FF18P EQU   ZZ2+1008
ZZ2DYNAP EQU   ZZ2+1012
ZZ2ZZ2CP EQU   ZZ2+1016
ZZ2ZZ2DP EQU   ZZ2+1020
ZZ2STAIP EQU   ZZ2+1024
ZZ2FF02P EQU   ZZ2+1028
ZZ2GETLP EQU   ZZ2+1032
ZZ2PARSP EQU   ZZ2+1036
ZZ2PTGTP EQU   ZZ2+1040
ZZ2PUTLP EQU   ZZ2+1044
ZZ2SCANP EQU   ZZ2+1048
ZZ2STCKP EQU   ZZ2+1052
ZZ2ALOCP EQU   ZZ2+1056
ZZ2MSGSP EQU   ZZ2+1060
ZZ2TRMOP EQU   ZZ2+1064
ZZ2TRMVP EQU   ZZ2+1068
ZZ2MSG0P EQU   ZZ2+1076
ZZ2PUTNP EQU   ZZ2+1084
ZZ2TRMNP EQU   ZZ2+1088
ZZ2ENQ0P EQU   ZZ2+1092
ZZ2ADSDP EQU   ZZ2+1096
ZZ2APDRP EQU   ZZ2+1100
ZZ2FDSDP EQU   ZZ2+1104
ZZ2FPDRP EQU   ZZ2+1108
ZZ2ZZ1P  EQU   ZZ2+1264
ZZ2DVTP  EQU   ZZ2+1276
ZZ2BVTP  EQU   ZZ2+1280
ZZ2CPPL  EQU   ZZ2+1292
ZZ2CPPLC EQU   ZZ2CPPL
ZZ2ITR   EQU   ZZ2+2840
ZZ2ITRE  EQU   ZZ2ITR+16
ZZ2ITSE  EQU   ZZ2+2864
ZZ2ES    EQU   ZZ2+2872
ZZ2AMDX  EQU   ZZ2+7160
ZZ2AXO   EQU   ZZ2+7934
ZZ2AXOT  EQU   ZZ2AXO+2
CMD      EQU   0
CMDT     EQU   CMD+4
PSCB     EQU   0
PSCBATR1 EQU   PSCB+16
ECT      EQU   0
ECTSWS   EQU   ECT+28
ECTSWS2  EQU   ECT+40
ECTSWS21 EQU   ECTSWS2
UPT      EQU   0
UPTSWS   EQU   UPT+12
SA       EQU   0
SA1      EQU   SA
SAR      EQU   SA+12
BVT      EQU   0
BVTPUTLP EQU   BVT+4
BVTPUTOP EQU   BVT+12
BVTPUTTP EQU   BVT+16
BVTPUTVP EQU   BVT+20
BVTPUTAP EQU   BVT+24
BVTPRTTP EQU   BVT+28
BVTPRTAP EQU   BVT+32
BVTPUTDP EQU   BVT+36
BVTMONP  EQU   BVT+40
BVTMON2P EQU   BVT+44
BVTVSARP EQU   BVT+48
BVTVSENP EQU   BVT+64
BVTVSERP EQU   BVT+68
BVTVSGEP EQU   BVT+72
BVTVSGUP EQU   BVT+76
BVTVSPOP EQU   BVT+80
BVTVSPUP EQU   BVT+84
BVTMPKNP EQU   BVT+104
BVTMONLP EQU   BVT+108
BVTPUTCP EQU   BVT+132
BVTMPK1P EQU   BVT+136
BVTZZ2RP EQU   BVT+140
BVTPGMRP EQU   BVT+144
BVTMONAP EQU   BVT+148
BVTBLDDP EQU   BVT+152
BVTBLDLP EQU   BVT+156
BVTPGMCP EQU   BVT+160
BVTPGMDP EQU   BVT+164
BVTPGMLP EQU   BVT+168
BVTMONCP EQU   BVT+180
BVTMONDP EQU   BVT+184
BVTMONTP EQU   BVT+188
BVTPARIP EQU   BVT+192
BVTPARUP EQU   BVT+196
BVTPRTNP EQU   BVT+204
BVTVSCRP EQU   BVT+208
BVTVSMRP EQU   BVT+212
BVTMONXP EQU   BVT+216
BVTTRMAP EQU   BVT+228
BLSDMSGS EQU   0
BLSDMSG0 EQU   0
DVT      EQU   0
DVTDEQPP EQU   DVT+8
DVTENQPP EQU   DVT+12
DVTAUTHP EQU   DVT+20
DVTLPCLP EQU   DVT+24
DVTBP00P EQU   DVT+28
DVTCN00P EQU   DVT+32
DVTDF00P EQU   DVT+36
DVTDS00P EQU   DVT+44
DVTFL00P EQU   DVT+48
DVTFP00P EQU   DVT+52
DVTGD00P EQU   DVT+56
DVTGG00P EQU   DVT+60
DVTGP00P EQU   DVT+64
DVTND00P EQU   DVT+68
DVTND01P EQU   DVT+72
DVTOD00P EQU   DVT+76
DVTPS00P EQU   DVT+80
DVTSD00P EQU   DVT+84
DVTSL00P EQU   DVT+88
DVTTL00P EQU   DVT+92
DVTUP00P EQU   DVT+100
DVTLP00P EQU   DVT+104
DVTLALLP EQU   DVT+108
DVTLPFMP EQU   DVT+112
DVTCLOSP EQU   DVT+116
DVTOPENP EQU   DVT+120
DVTPERAP EQU   DVT+124
DVTDALLP EQU   DVT+128
RECAREA  EQU   0
BLSCALOC EQU   0
BLSDADSD EQU   0
BLSDAPDR EQU   0
BLSDDEQP EQU   0
BLSDENQP EQU   0
BLSDENQ0 EQU   0
BLSDFDSD EQU   0
BLSDFPDR EQU   0
BLSEAUTH EQU   0
BLSELPCL EQU   0
BLSELPFM EQU   0
BLSFBP00 EQU   0
BLSFCLOS EQU   0
BLSFCN00 EQU   0
BLSFDALL EQU   0
BLSFDF00 EQU   0
BLSFDS00 EQU   0
BLSFFL00 EQU   0
BLSFFP00 EQU   0
BLSFGD00 EQU   0
BLSFGG00 EQU   0
BLSFGP00 EQU   0
BLSFLALL EQU   0
BLSFLP00 EQU   0
BLSFND00 EQU   0
BLSFND01 EQU   0
BLSFOD00 EQU   0
BLSFOPEN EQU   0
BLSFPERA EQU   0
BLSFPS00 EQU   0
BLSFSD00 EQU   0
BLSFSL00 EQU   0
BLSFTL00 EQU   0
BLSFUP00 EQU   0
BLSUALLO EQU   0
BLSUBLDD EQU   0
BLSUBLDL EQU   0
BLSUDYNA EQU   0
BLSUFREE EQU   0
BLSUFRE1 EQU   0
BLSUMON  EQU   0
BLSUMONA EQU   0
BLSUMONC EQU   0
BLSUMOND EQU   0
BLSUMONL EQU   0
BLSUMONT EQU   0
BLSUMONX EQU   0
BLSUMON2 EQU   0
BLSUMPKN EQU   0
BLSUMPK1 EQU   0
BLSUPARI EQU   0
BLSUPARU EQU   0
BLSUPGMC EQU   0
BLSUPGMD EQU   0
BLSUPGML EQU   0
BLSUPGMR EQU   0
BLSUPRTA EQU   0
BLSUPRTN EQU   0
BLSUPRTT EQU   0
BLSUPUTA EQU   0
BLSUPUTC EQU   0
BLSUPUTD EQU   0
BLSUPUTL EQU   0
BLSUPUTN EQU   0
BLSUPUTO EQU   0
BLSUPUTT EQU   0
BLSUPUTV EQU   0
BLSUSTAI EQU   0
BLSUTRMA EQU   0
BLSUTRMN EQU   0
BLSUTRMO EQU   0
BLSUTRMV EQU   0
BLSUVSAR EQU   0
BLSUVSCR EQU   0
BLSUVSEN EQU   0
BLSUVSER EQU   0
BLSUVSGE EQU   0
BLSUVSGU EQU   0
BLSUVSMR EQU   0
BLSUVSPO EQU   0
BLSUVSPU EQU   0
BLSUZZ2C EQU   0
BLSUZZ2D EQU   0
BLSUZZ2R EQU   0
DMCBRQC  EQU   0
IKJEFF02 EQU   0
IKJEFF18 EQU   0
IKJEFF19 EQU   0
IKJGETL  EQU   0
IKJPARS  EQU   0
IKJPTGT  EQU   0
IKJPUTL  EQU   0
IKJSCAN  EQU   0
IKJSTCK  EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
ZZ2CB    EQU   0
ADSDREC  EQU   0
DSDRECL  EQU   0
DSDBASRC EQU   DSDINFO
DSDDSATR EQU   DSDBASRC+8
DSDPRASR EQU   DSDINFO
DMCBVSM  EQU   DMCBAMS
DMCBQSM  EQU   DMCBAMS
CPPL     EQU   ZZ2CPPL
CPPLUPT  EQU   CPPL+4
CPPLPSCB EQU   CPPL+8
CPPLECT  EQU   CPPL+12
*                                      START UNREFERENCED COMPONENTS
CPPLCBUF EQU   CPPL
DMCBRES7 EQU   DMCBQSM+96
DMCBDCB  EQU   DMCBQSM
DMCBACB  EQU   DMCBVSM+76
DMCBRPL  EQU   DMCBVSM
DSDPRSQN EQU   DSDPRASR
DSDBRES1 EQU   DSDBASRC+76
DSDDESC  EQU   DSDBASRC+16
DSDSLOWN EQU   DSDDSATR
DSDDSNTY EQU   DSDBASRC
DVT99999 EQU   DVT+256
DVT0064P EQU   DVT+252
DVT0063P EQU   DVT+248
DVT0062P EQU   DVT+244
DVT0061P EQU   DVT+240
DVT0060P EQU   DVT+236
DVT0059P EQU   DVT+232
DVT0058P EQU   DVT+228
DVT0057P EQU   DVT+224
DVT0056P EQU   DVT+220
DVT0055P EQU   DVT+216
DVT0054P EQU   DVT+212
DVT0053P EQU   DVT+208
DVT0052P EQU   DVT+204
DVT0051P EQU   DVT+200
DVT0050P EQU   DVT+196
DVT0049P EQU   DVT+192
DVT0048P EQU   DVT+188
DVT0047P EQU   DVT+184
DVT0046P EQU   DVT+180
DVT0045P EQU   DVT+176
DVT0044P EQU   DVT+172
DVT0043P EQU   DVT+168
DVT0042P EQU   DVT+164
DVT0041P EQU   DVT+160
DVT0040P EQU   DVT+156
DVT0039P EQU   DVT+152
DVT0038P EQU   DVT+148
DVT0037P EQU   DVT+144
DVT0036P EQU   DVT+140
DVT0035P EQU   DVT+136
DVT0034P EQU   DVT+132
DVTUD00P EQU   DVT+96
DVT0011P EQU   DVT+40
DVT0005P EQU   DVT+16
DVT0002P EQU   DVT+4
DVT0001P EQU   DVT
BVT99999 EQU   BVT+256
BVT0064P EQU   BVT+252
BVT0063P EQU   BVT+248
BVT0062P EQU   BVT+244
BVT0061P EQU   BVT+240
BVT0060P EQU   BVT+236
BVT0059P EQU   BVT+232
BVT0057P EQU   BVT+224
BVT0056P EQU   BVT+220
BVTSTBLP EQU   BVT+200
BVT0045P EQU   BVT+176
BVT0044P EQU   BVT+172
BVT0033P EQU   BVT+128
BVT0032P EQU   BVT+124
BVT0031P EQU   BVT+120
BVT0030P EQU   BVT+116
BVT0029P EQU   BVT+112
BVT0026P EQU   BVT+100
BVT0025P EQU   BVT+96
BVT0024P EQU   BVT+92
BVT0023P EQU   BVT+88
BVT0016P EQU   BVT+60
BVT0015P EQU   BVT+56
BVT0014P EQU   BVT+52
BVT0003P EQU   BVT+8
BVT0001P EQU   BVT
SA99     EQU   SA+72
SARC     EQU   SAR+56
SARB     EQU   SAR+52
SARA     EQU   SAR+48
SAR9     EQU   SAR+44
SAR8     EQU   SAR+40
SAR7     EQU   SAR+36
SAR6     EQU   SAR+32
SAR5     EQU   SAR+28
SAR4     EQU   SAR+24
SAR3     EQU   SAR+20
SAR2     EQU   SAR+16
SAR1     EQU   SAR+12
SAR0     EQU   SAR+8
SARF     EQU   SAR+4
SARE     EQU   SAR
SAFWD    EQU   SA+8
SABAK    EQU   SA+4
SA1L     EQU   SA1+1
SA1P     EQU   SA1
UPTPREFL EQU   UPT+23
UPTPREFX EQU   UPT+16
@NM00068 EQU   UPT+15
UPTLDEL  EQU   UPT+14
UPTCDEL  EQU   UPT+13
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTMID   EQU   UPTSWS
UPTNPRM  EQU   UPTSWS
UPTRCVR  EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00067 EQU   UPT
@NM00066 EQU   ECT+52
@NM00065 EQU   ECT+48
@NM00064 EQU   ECT+44
@NM00063 EQU   ECTSWS2+1
@NM00062 EQU   ECTSWS21
ECTTABND EQU   ECTSWS21
ECTDEFCS EQU   ECTSWS21
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTATTN  EQU   ECTSWS
ECTBKGRD EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTNMAL  EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
@NM00061 EQU   ECTSWS
ECTNOPD  EQU   ECTSWS
ECTSCMD  EQU   ECT+20
ECTPCMD  EQU   ECT+12
ECTSMSG  EQU   ECT+9
ECTMSGF  EQU   ECT+8
ECTIOWA  EQU   ECT+4
ECTRTCD  EQU   ECT+1
ECTRCDF  EQU   ECT
PSCBU    EQU   PSCB+64
PSCBRSZ  EQU   PSCB+60
PSCBLINE EQU   PSCB+59
PSCBCHAR EQU   PSCB+58
PSCBUPTL EQU   PSCB+56
PSCBUPT  EQU   PSCB+52
PSCBRLGB EQU   PSCB+48
PSCBDEST EQU   PSCB+40
@NM00060 EQU   PSCB+36
@NM00059 EQU   PSCB+32
@NM00058 EQU   PSCB+28
PSCBLTI2 EQU   PSCB+24
PSCBLTIM EQU   PSCB+20
PSCBATR2 EQU   PSCB+18
@NM00057 EQU   PSCBATR1
@NM00056 EQU   PSCBATR1
@NM00055 EQU   PSCBATR1
PSCBATTN EQU   PSCBATR1
PSCBVMNT EQU   PSCBATR1
PSCBJCL  EQU   PSCBATR1
PSCBACCT EQU   PSCBATR1
PSCBCTRL EQU   PSCBATR1
PSCBGPNM EQU   PSCB+8
PSCBUSRL EQU   PSCB+7
PSCBUSER EQU   PSCB
CMDT1    EQU   CMDT
CMDO     EQU   CMD+2
CMDL     EQU   CMD
ZZ299999 EQU   ZZ2+8192
ZZ2AXOT1 EQU   ZZ2AXOT
ZZ2AXOL  EQU   ZZ2AXO
@NM00054 EQU   ZZ2+7288
@NM00053 EQU   ZZ2AMDX+4
ZZ2AMDXC EQU   ZZ2AMDX
ZZ2HSD   EQU   ZZ2+3056
@NM00052 EQU   ZZ2ES
@NM00051 EQU   ZZ2+2868
ZZ2ITSEC EQU   ZZ2ITSE+1
@NM00050 EQU   ZZ2ITSE
ZZ2ITSEP EQU   ZZ2ITSE
ZZ2ITSEW EQU   ZZ2ITSE
@NM00049 EQU   ZZ2ITR+20
ZZ2ITREC EQU   ZZ2ITRE+1
@NM00048 EQU   ZZ2ITRE
ZZ2ITREP EQU   ZZ2ITRE
ZZ2ITREW EQU   ZZ2ITRE
@NM00047 EQU   ZZ2ITR+9
ZZ2ITRRC EQU   ZZ2ITR+8
ZZ2ITR2P EQU   ZZ2ITR+4
ZZ2ITRPP EQU   ZZ2ITR
@NM00046 EQU   ZZ2+1544
ZZ2PGM   EQU   ZZ2+1536
@NM00045 EQU   ZZ2+1526
ZZ2CW    EQU   ZZ2+1524
@NM00044 EQU   ZZ2+1504
@NM00043 EQU   ZZ2+1352
ZZ2FFSYP EQU   ZZ2+1348
ZZ2SASYP EQU   ZZ2+1344
ZZ2RDSYP EQU   ZZ2+1340
ZZ2RASYP EQU   ZZ2+1336
ZZ2PHSYP EQU   ZZ2+1332
ZZ2ESSYP EQU   ZZ2+1328
ZZ200SYP EQU   ZZ2+1324
ZZ2SCWP  EQU   ZZ2+1320
ZZ2TTLP  EQU   ZZ2+1316
ZZ2LOADP EQU   ZZ2+1312
ZZ2VRESP EQU   ZZ2+1308
ZZ2CPPLE EQU   ZZ2CPPL+12
ZZ2CPPLP EQU   ZZ2CPPL+8
ZZ2CPPLU EQU   ZZ2CPPL+4
ZZ2VRSAP EQU   ZZ2+1288
ZZ2RVTP  EQU   ZZ2+1284
@NM00042 EQU   ZZ2+1272
@NM00041 EQU   ZZ2+1268
ZZ2RPLP  EQU   ZZ2+1260
ZZ2TCBP  EQU   ZZ2+1256
@NM00040 EQU   ZZ2+1252
ZZ2ZZ2P  EQU   ZZ2+1248
@NM00039 EQU   ZZ2+1112
@NM00038 EQU   ZZ2+1080
ZZ2FT25P EQU   ZZ2+1072
@NM00037 EQU   ZZ2+976
ZZ2TOD   EQU   ZZ2+968
ZZ2STGN  EQU   ZZ2STG+4
ZZ2STGP  EQU   ZZ2STG
@NM00036 EQU   ZZ2+952
ZZ2SCMDE EQU   ZZ2+944
ZZ2SCMDN EQU   ZZ2+936
ZZ2IDENT EQU   ZZ2+928
ZZ2A9999 EQU   ZZ2A+656
@NM00035 EQU   ZZ2A+224
@NM00034 EQU   ZZ2A+220
ZZ2AQD99 EQU   ZZ2AQD+60
@NM00033 EQU   ZZ2AQD+56
@NM00032 EQU   ZZ2AQDF
ZZ2AQDFA EQU   ZZ2AQDF
ZZ2AQDIL EQU   ZZ2AQD+48
ZZ2AQDIM EQU   ZZ2AQD+44
ZZ2AQDT9 EQU   ZZ2AQDT+34
ZZ2AQDTE EQU   ZZ2AQDT+33
ZZ2AQDTD EQU   ZZ2AQDT+2
@NM00031 EQU   ZZ2AQDT+1
ZZ2AQDTY EQU   ZZ2AQDT
ZZ2AQDT0 EQU   ZZ2AQDT
ZZ2AQDLB EQU   ZZ2AQD+9
ZZ2AQDOB EQU   ZZ2AQD+8
ZZ2AQDLE EQU   ZZ2AQD+4
ZZ2AQDOF EQU   ZZ2AQD
ZZ2AQD00 EQU   ZZ2AQD
ZZ2AQAS9 EQU   ZZ2AQAS+16
@NM00030 EQU   ZZ2AQAS+12
ZZ2AQAS2 EQU   ZZ2AQAS+8
ZZ2AQAS1 EQU   ZZ2AQAS+4
@NM00029 EQU   ZZ2AQAS+2
ZZ2AQAST EQU   ZZ2AQAS
ZZ2AQAS0 EQU   ZZ2AQAS
ZZ2AZZ6P EQU   ZZ2A+140
ZZ2ADPTA EQU   ZZ2ADPT
ZZ2ADPL  EQU   ZZ2ADP
ZZ2ADMTA EQU   ZZ2ADMT
ZZ2ADML  EQU   ZZ2ADM
ZZ2ADDTA EQU   ZZ2ADDT
ZZ2ADDL  EQU   ZZ2ADD
@NM00028 EQU   ZZ2A+72
ZZ2APIDB EQU   ZZ2APID+3
ZZ2APIDA EQU   ZZ2APID
@NM00027 EQU   ZZ2A+24
@NM00026 EQU   ZZ2AF+5
ZZ2AFX   EQU   ZZ2AF+5
@NM00025 EQU   ZZ2AF+3
ZZ2AFS   EQU   ZZ2AF+2
ZZ2AFD   EQU   ZZ2AF+2
ZZ2AFQ   EQU   ZZ2AF+2
ZZ2AF$   EQU   ZZ2AF+2
@NM00024 EQU   ZZ2AF+2
ZZ2AFM   EQU   ZZ2AF+2
@NM00023 EQU   ZZ2AF+2
@NM00022 EQU   ZZ2AF+1
ZZ2AFV   EQU   ZZ2AF+1
@NM00021 EQU   ZZ2AF+1
ZZ2AFC   EQU   ZZ2AF+1
@NM00020 EQU   ZZ2AF
ZZ2AFFS  EQU   ZZ2AF
ZZ2AFT   EQU   ZZ2AF
ZZ2AFP   EQU   ZZ2AF
@NM00019 EQU   ZZ2A+8
ZZ2ALINE EQU   ZZ2A+4
@NM00018 EQU   ZZ2A+3
ZZ2ASE   EQU   ZZ2A+2
ZZ2ACH   EQU   ZZ2A
@NM00017 EQU   ZZ2+264
@NM00016 EQU   ZZ2+263
ZZ2PRTT0 EQU   ZZ2PRTT
ZZ2PRTO  EQU   ZZ2PRT+2
ZZ2PRTL  EQU   ZZ2PRT
@NM00015 EQU   ZZ2AMD+56
ZZ2AMDXP EQU   ZZ2AMD+52
ZZ2AMDD  EQU   ZZ2AMD+48
ZZ2AMDL  EQU   ZZ2AMD+44
ZZ2AMDU  EQU   ZZ2AMD+28
ZZ2AMDF  EQU   ZZ2AMD+24
ZZ2AMDS  EQU   ZZ2AMD+20
ZZ2AMDC  EQU   ZZ2AMD+16
ZZ2AMDP  EQU   ZZ2AMD+12
ZZ2AMDB  EQU   ZZ2AMD+8
@NM00014 EQU   @NM00013
ZZ2AMD2  EQU   @NM00013
ZZ2AMD1  EQU   @NM00013
ZZ2AMD0  EQU   ZZ2AMD+6
ZZ2AMDA  EQU   ZZ2AMD+4
ZZ2AMDT  EQU   ZZ2AMD
ZZ199999 EQU   ZZ1+3072
@NM00012 EQU   ZZ1+2160
ZZ1TRTAS EQU   ZZ1+1904
ZZ1TRUPC EQU   ZZ1+1648
ZZ1TRCTX EQU   ZZ1+1392
ZZ1NASID EQU   ZZ1N+274
ZZ1NSTRL EQU   ZZ1N+272
ZZ1NOFF  EQU   ZZ1N+268
ZZ1NBDY  EQU   ZZ1N+264
ZZ1NADE  EQU   ZZ1N+260
ZZ1NADB  EQU   ZZ1N+256
ZZ1NSTR  EQU   ZZ1N
@NM00011 EQU   ZZ1+1080
ZZ1TREBC EQU   ZZ1+824
ZZ1TRHEX EQU   ZZ1+568
@NM00010 EQU   ZZ1+377
ZZ1USTAE EQU   ZZ1+376
@NM00009 EQU   ZZ1F+1
@NM00008 EQU   ZZ1F
ZZ1FM    EQU   ZZ1F
ZZ1FX    EQU   ZZ1F
ZZ1FU    EQU   ZZ1F
ZZ1EVEC  EQU   ZZ1EVE+1
@NM00007 EQU   ZZ1EVE
ZZ1EVEP  EQU   ZZ1EVE
ZZ1EVEW  EQU   ZZ1EVE
ZZ1ACMP  EQU   ZZ1ATTN
@NM00006 EQU   ZZ1+144
ZZ1FPP   EQU   ZZ1+140
ZZ1ZZ6P  EQU   ZZ1+136
@NM00005 EQU   ZZ1+84
ZZ1PLINE EQU   ZZ1+80
ZZ1PGSZ  EQU   ZZ1+76
ZZ1PCNT  EQU   ZZ1+72
@NM00004 EQU   ZZ1+68
ZZ1TPAGE EQU   ZZ1+64
ZZ1TLINE EQU   ZZ1+60
@NM00003 EQU   ZZ1+52
ZZ1DMCBP EQU   ZZ1+48
ZZ1PDRP  EQU   ZZ1+40
ZZ1ZZ2P  EQU   ZZ1+36
ZZ1327WP EQU   ZZ1+32
ZZ1ACBP  EQU   ZZ1+28
@NM00002 EQU   ZZ1+24
ZZ1PDCBP EQU   ZZ1+20
ZZ1BLRBL EQU   ZZ1+16
@NM00001 EQU   ZZ1+12
ZZ1PNULL EQU   ZZ1+8
ZZ1NULL  EQU   ZZ1+4
ZZ1IDE   EQU   ZZ1
DMCBWRK  EQU   DMCB+648
DMCBRES8 EQU   DMCB+640
DMCBMODN EQU   DMCB+632
DMCBCARY EQU   DMCBAUDT+20
DMCBCLC  EQU   DMCBAUDT+12
DMCBOPC  EQU   DMCBAUDT+8
DMCBFRC  EQU   DMCBAUDT+4
DMCBALC  EQU   DMCBAUDT
DMCBFR   EQU   DMCB+412
DMCBRES6 EQU   DMCB+410
DMCBIRSC EQU   DMCB+408
DMCBSUBC EQU   DMCB+404
DMCBDRBP EQU   DMCB+400
DMCBRSZM EQU   DMCB+398
DMCBRSZA EQU   DMCB+396
DMCBCISZ EQU   DMCB+394
DMCBDCBL EQU   DMCB+392
DMCBDCLR EQU   DMCB+390
DMCBDCFM EQU   DMCB+389
DMCBRES5 EQU   DMCB+388
DMCBLBRT EQU   DMCB+386
DMCBLBSQ EQU   DMCB+384
DMCBLBPS EQU   DMCB+383
DMCBLBTY EQU   DMCB+382
DMCBRES4 EQU   DMCB+381
DMCBSPRS EQU   DMCBSPEC
DMCBSPRN EQU   DMCBSPEC
DMCBSPCT EQU   DMCBSPEC
DMCBSPRL EQU   DMCBSPEC
DMCBSPSE EQU   DMCB+376
DMCBSPPR EQU   DMCB+372
DMCBSPTY EQU   DMCB+369
DMCBODIS EQU   DMCB+368
DMCBDISP EQU   DMCB+367
DMCBSTAT EQU   DMCB+366
DMCBRES3 EQU   DMCB+364
DMCBMEMB EQU   DMCB+356
DMCBMODL EQU   DMCB+348
DMCBRES9 EQU   DMCB+340
DMCBPID  EQU   DMCB+332
DMCBTYPE EQU   DMCB+328
DMCBDSN  EQU   DMCB+284
DMCBUNIT EQU   DMCB+276
DMCBDSOR EQU   DMCB+274
DMCBVOL  EQU   DMCB+268
DMCBDDNM EQU   DMCB+260
DMCBSYNM EQU   DMCB+132
DMCBRPLF EQU   DMCB+128
DMCBDCBE EQU   DMCBACBE
DMCBARC  EQU   DMCB+120
DMCBCPC  EQU   DMCB+116
DMCBRET  EQU   DMCB+112
DMCBSTL  EQU   DMCB+96
DMCBEOB  EQU   DMCB+92
DMCBFRE  EQU   DMCB+88
DMCBRES2 EQU   DMCB+85
DMCBSPID EQU   DMCB+84
DMCBRESC EQU   DMCB+80
DMCBZZ1P EQU   DMCB+76
DMCBMSGS EQU   DMCB+72
DMCBMSG0 EQU   DMCB+68
DMCBRRL  EQU   DMCB+60
DMCBRBA  EQU   DMCB+56
DMCBKPC  EQU   DMCBKEYP
DMCBBFPC EQU   DMCBBUFP
DMCBRES1 EQU   DMCB+31
DMCBACCM EQU   DMCB+30
DMCBREJ  EQU   DMCB+29
DMCBRESB EQU   DMCBMFLG
DMCBFMOD EQU   DMCBMFLG
DMCBLOPT EQU   DMCB+27
DMCBLRM  EQU   DMCB+26
DMCBLRQ  EQU   DMCB+25
DMCBOPRS EQU   DMCBOPTS
DMCBLRD  EQU   DMCBOPTS
DMCBBWD  EQU   DMCBOPTS
DMCBRNO  EQU   DMCBGKY
DMCBRMRS EQU   DMCBRMOD
DMCBRESA EQU   DMCBOPN
DMCBSOUT EQU   DMCBOPN
DMCBSIN  EQU   DMCBOPN
DMCBVSF  EQU   DMCBFTY
DMCBKSF  EQU   DMCBFTY
DMCBFTRS EQU   DMCBFTY
DMCBSHF  EQU   DMCBFTY
DMCBIRL  EQU   DMCB+16
DMCBRTC  EQU   DMCB+12
DMCBTVP  EQU   DMCB+8
DMCBNEXT EQU   DMCB+4
MSGWTXT  EQU   MSGWMOV+4
MSGWPAD  EQU   MSGWMOV+2
MSGWLEN  EQU   MSGWMOV
MSGWNXT  EQU   MSGWENT
MSGDTXT  EQU   MSGDMOV+4
MSGDPAD  EQU   MSGDMOV+2
MSGDLEN  EQU   MSGDMOV
MSGDNXT  EQU   MSGDWRT
MSGDBAK  EQU   MSGDPRF+4
MSGDFLEN EQU   MSGDPRF+1
MSGDSPID EQU   MSGDPRF
DSDRES1  EQU   DSDREC+61
DSDKPNUM EQU   DSDKPID+3
DSDKPREF EQU   DSDKPID
DSDKMEMN EQU   DSDKDSNM+44
DSDKDSN  EQU   DSDKDSNM
DSDKTYP  EQU   DSDKGRP
*                                      END UNREFERENCED COMPONENTS
@RC00139 EQU   @RC00136
@RC00196 EQU   @EL00002
@RC00189 EQU   @EL00002
@RC00357 EQU   @EL00004
@RC00342 EQU   @EL00004
@RC00335 EQU   @EL00004
@RC00415 EQU   @EL00005
@RC00408 EQU   @EL00005
@RC00142 EQU   @RC00139
@RC00145 EQU   @RC00142
@ENDDATA EQU   *
         END   BLSFUD00,(C'PLS2209',0701,78065)
